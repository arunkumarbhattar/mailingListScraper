<?xml version="1.0" encoding="utf-8"?>
<emails><email><emailId>20210104090740</emailId><senderName>Andrea Bolognani</senderName><senderEmail>abologna@redhat.com</senderEmail><timestampReceived>2021-01-04 09:07:40-0400</timestampReceived><subject>Re: How to open listener of Libvirt ?</subject><body>

On Thu, 2020-12-24 at 13:38 +0800, tommy wrote:
&gt; Hi,every one:
&gt; 
&gt; My Ubuntu is : 20.04 LTS, and I using libvirtd on it to manage KVM vm, but now I \
&gt; can not open listener function of the libvirtd. 
&gt; 
&gt; SYSTEM SOCKET ACTIVATION
&gt; The libvirtd daemon is capable of starting in two modes.
&gt; 
&gt; In the traditional mode, it will create and listen on UNIX sockets itself.  If the \
&gt; --listen parameter is given, it will also listen on TCP/IP socket(s), according to \
&gt; the listen_tcp and listen_tls options in /etc/libvirt/libvirtd.conf 
&gt; In socket activation mode, it will rely on systemd to create and listen on the \
&gt; UNIX, and optionally TCP/IP, sockets and pass them as pre-opened file de- \
&gt; scriptors. In this mode, it is not permitted to pass the --listen parameter, and \
&gt; most of the socket related config options in /etc/libvirt/libvirtd.conf will no \
&gt; longer have any effect. To enable TCP or TLS sockets use either 
&gt; $ systemctl start libvirtd-tls.socket
&gt; 
&gt; Or
&gt; 
&gt; $ systemctl start libvirtd-tcp.socket
&gt; 
&gt; 
&gt; But, on my system, there are no such service like libvirtd-tls.socket or \
&gt; libvirtd-tcp.socket. 
&gt; root@ubts1:~# systemctl  | grep libvirt
&gt; libvirt-guests.service                                                              \
&gt; loaded active exited    Suspend/Resume Running libvirt Guests         \
&gt; libvirtd.service                                                                    \
&gt; loaded active running   Virtualization daemon                         \
&gt; libvirtd-admin.socket                                                               \
&gt; loaded active running   Libvirt admin socket                          \
&gt; libvirtd-ro.socket                                                                  \
&gt; loaded active running   Libvirt local read-only socket                \
&gt; libvirtd.socket                                                                     \
&gt; loaded active running   Libvirt local socket                          
&gt; How can I open the listener ?

On my machine:

  $ systemctl list-unit-files | grep libvirt
  libvirt-guests.service    enabled     enabled
  libvirtd.service          enabled     enabled
  libvirtd-admin.socket     enabled     enabled
  libvirtd-ro.socket        enabled     enabled
  libvirtd-tcp.socket       disabled    enabled
  libvirtd-tls.socket       disabled    enabled
  libvirtd.socket           enabled     enabled

This is Debian, but the Ubuntu package is pretty much identical, so I
don't expect it to behave differently.

So the unit exists on you system, you just need to enable it :)

-- 
Andrea Bolognani / Red Hat / Virtualization


</body></email><email><emailId>20210210012849</emailId><senderName>Brooks Swinnerton</senderName><senderEmail>bswinnerton@gmail.com</senderEmail><timestampReceived>2021-02-10 01:28:49-0400</timestampReceived><subject>Static DHCP lease never distributed</subject><body>

Hi there,

I have a libvirt network defined as so:

&lt;network&gt;
    &lt;name&gt;customers&lt;/name&gt;
    &lt;bridge name='customers' macTableManager='libvirt' /&gt;
    &lt;port isolated='yes' /&gt;
    &lt;dns enable='no' /&gt;
    &lt;ip address='10.0.0.1' prefix='24'&gt;
        &lt;dhcp&gt;
            &lt;host mac='02:99:92:43:eb:b8' name='dhcp-test' ip='10.0.0.10' /&gt;
        &lt;/dhcp&gt;
    &lt;/ip&gt;
&lt;/network&gt;

And that network is attached to a virtual machine:

    &lt;interface type='network'&gt;
      &lt;mac address='02:99:92:43:eb:b8'/&gt;
      &lt;source network='customers'/&gt;
      &lt;model type='virtio'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03'
function='0x0'/&gt;
    &lt;/interface&gt;

But for some reason when the domain starts, it never gets an address. If I
tcpdump the bridge that was created by the network I can see it sending out
discover packets, but dnsmasq never seems to respond:

01:26:25.039987 02:99:92:43:eb:b8 &gt; ff:ff:ff:ff:ff:ff, ethertype IPv4
(0x0800), length 342: (tos 0x0, ttl 64, id 0, offset 0, flags [none], proto
UDP (17), length 328)
    0.0.0.0.68 &gt; 255.255.255.255.67: BOOTP/DHCP, Request from
02:99:92:43:eb:b8, length 300, xid 0xc7283f76, secs 228, Flags [none]
          Client-Ethernet-Address 02:99:92:43:eb:b8
          Vendor-rfc1048 Extensions
            Magic Cookie 0x63825363
            DHCP-Message Option 53, length 1: Discover
            Client-ID Option 61, length 7: ether 02:99:92:43:eb:b8
            MSZ Option 57, length 2: 576
            Parameter-Request Option 55, length 7:
              Subnet-Mask, Default-Gateway, Domain-Name-Server, Hostname
              Domain-Name, BR, NTP
            Vendor-Class Option 60, length 3: "d-i"


Despite that appearing to be the correct mac address.

Looking in /var/lib/libvirt/dnsmasq/customers.hostsfile, it's returning
what I would expect to be there:

02:99:92:43:eb:b8,10.0.0.10,dhcp-test

If I add a &lt;range&gt; stanza to the configuration, that does appear to work,
so it seems this is only related to static addresses.

This is libvirtd 5.8.0.

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hi there,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I have a libvirt network defined as \
so:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font face="monospace"&gt;&lt;network&gt;&lt;br&gt;      \
&lt;name&gt;customers&lt;/name&gt;&lt;br&gt;      &lt;bridge name='customers' \
macTableManager='libvirt' /&gt;&lt;br&gt;      &lt;port isolated='yes' \
/&gt;&lt;br&gt;      &lt;dns enable='no' /&gt;&lt;br&gt;      &lt;ip \
address='10.0.0.1' prefix='24'&gt;&lt;br&gt;            &lt;dhcp&gt;&lt;br&gt;    \
&lt;host mac='02:99:92:43:eb:b8' name='dhcp-test' \
ip='10.0.0.10' /&gt;&lt;br&gt;            &lt;/dhcp&gt;&lt;br&gt;      \
&lt;/ip&gt;&lt;br&gt;&lt;/network&gt;&lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;And that network \
is attached to a virtual machine:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font face="monospace"&gt;    \
&lt;interface type='network'&gt;&lt;br&gt;         &lt;mac \
address='02:99:92:43:eb:b8'/&gt;&lt;br&gt;         &lt;source \
network='customers'/&gt;&lt;br&gt;         &lt;model type='virtio'/&gt;&lt;br&gt; \
&lt;address type='pci' domain='0x0000' bus='0x00' \
slot='0x03' function='0x0'/&gt;&lt;br&gt;      \
&lt;/interface&gt;&lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;But for some reason when the \
domain starts, it never gets an address. If I tcpdump the bridge that was created by \
the network I can see it sending out discover packets, but dnsmasq never seems to \
respond:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font face="monospace"&gt;01:26:25.039987 \
02:99:92:43:eb:b8 &gt; ff:ff:ff:ff:ff:ff, ethertype IPv4 (0x0800), length 342: (tos \
0x0, ttl 64, id 0, offset 0, flags [none], proto UDP (17), length 328)&lt;br&gt;      \
0.0.0.0.68 &gt; 255.255.255.255.67: BOOTP/DHCP, Request from 02:99:92:43:eb:b8, \
length 300, xid 0xc7283f76, secs 228, Flags [none]&lt;br&gt;               \
Client-Ethernet-Address 02:99:92:43:eb:b8&lt;br&gt;               Vendor-rfc1048 \
Extensions&lt;br&gt;                  Magic Cookie 0x63825363&lt;br&gt;                  \
DHCP-Message Option 53, length 1: Discover&lt;br&gt;                  Client-ID Option 61, \
length 7: ether 02:99:92:43:eb:b8&lt;br&gt;                  MSZ Option 57, length 2: \
576&lt;br&gt;                  Parameter-Request Option 55, length 7:&lt;br&gt;                   \
Subnet-Mask, Default-Gateway, Domain-Name-Server, Hostname&lt;br&gt;                     \
Domain-Name, BR, NTP&lt;br&gt;                  Vendor-Class Option 60, length 3: \
"d-i"&lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Despite that \
appearing to be the correct mac address.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Looking in  &lt;font \
face="monospace"&gt;/var/lib/libvirt/dnsmasq/customers.hostsfile&lt;/font&gt;, it's \
returning what I would expect to be there:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
face="monospace"&gt;02:99:92:43:eb:b8,10.0.0.10,dhcp-test&lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If \
I add a &lt;font face="monospace"&gt;&lt;range&gt;&lt;/font&gt; stanza to the configuration, that \
does appear to work, so it seems this is only related to static \
addresses.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;This is libvirtd  5.8.0.&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210304211206</emailId><senderName>David Wells</senderName><senderEmail>dwells@alfavinil.com</senderEmail><timestampReceived>2021-03-04 21:12:06-0400</timestampReceived><subject>virsh snapshot-create-as with quiesce option times out</subject><body>

Hi all!

I'm still working on the live backup of a couple vm's and what happens 
most of the times es that when I execute virsh with the 
snapshot-create-as with the --quiesce option the process finishes with 
an error that reads
&gt; error: Timed out during operation: cannot acquire state change lock

I tried turning up the debug level but found nothing that appears to be 
of interest and I can connect successfully to the qemu guest agent since 
the following command returns the correct value
&gt; sudo /usr/sbin/virsh domfsinfo slackware-current
&gt; Mountpoint Name     Type     Target
&gt; -------------------------------------------------------------------
&gt; /                                    vda1     ext4     vda

I also tried running the qemu-ga agent on the guest with debugging 
enabled and when I issue this last command I can see the agent talking 
to the host but when I issue the quiesce option the guest agent shows 
nothing at all.

Is this by any chance a known bug? Is there something obvious I'm 
missing? What else can I provide to help debug this issue?

Thanks in advance!
Best regards,
David Wells.


</body></email><email><emailId>20210401141302</emailId><senderName>lejeczek</senderName><senderEmail>peljasz@yahoo.co.uk</senderEmail><timestampReceived>2021-04-01 14:13:02-0400</timestampReceived><subject>GlusterFS libgfapi with TLS</subject><body>

Hi guys.

I have KVM guests stored on glusterFS volume and I recently 
added TLS encryption to Gluster.
What changes, tweaks are required at libvirtd/qemu's end?

many thanks, L.

</body></email><email><emailId>20210517183656</emailId><senderName>Simon Fairweather</senderName><senderEmail>simon.n.fairweather@gmail.com</senderEmail><timestampReceived>2021-05-17 18:36:56-0400</timestampReceived><subject>virHostdevIsPCINodeDeviceUsed</subject><body>

I am looking to be able to check if a specific PCI device is allocated to a
guest.

An error is produced if a domain is started and the device is in use within
another domain via this function.

I cannot see a publicly available function to use to get this information,
is there one available or is there another way to check the state of the
PCI device.

Regards
Simon

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;I am looking to be able to check if a specific PCI device is allocated \
to a guest.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;An error is produced if a domain is started and the \
device is in use within another domain via this function.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I \
cannot see a publicly available function to use to get this information, is there one \
available or is there another way to check the state of the PCI \
device.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards&lt;/div&gt;&lt;div&gt;Simon&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;




</body></email><email><emailId>20210601135734</emailId><senderName>Francesc Guasch</senderName><senderEmail>frankie@telecos.upc.edu</senderEmail><timestampReceived>2021-06-01 13:57:34-0400</timestampReceived><subject>virt viewer for Mac</subject><body>

Hi. Please excuse me if this is not the right place to ask.

We are using virt viewer happily from Linux, and though the
Windows release sometimes has issues it seems it is maintained.

There is this Mac client here:

https://people.freedesktop.org/~teuf/spice-gtk-osx/

We have been reported it is outdated and somehow buggy.

Is there another alternative ? Are there plans to port
virt-viewer for Macs ?

Thank you.

</body></email><email><emailId>20210705003115</emailId><senderName>Jiatong Shen</senderName><senderEmail>yshxxsjt715@gmail.com</senderEmail><timestampReceived>2021-07-05 00:31:15-0400</timestampReceived><subject>host identifier</subject><body>

Hello community,

I am using OpenStack nova and realize that nova now uses host fqdn from
libvirt as a uniq identifier for a compute node.  The issue is that host
might need to change its fqdn under some
rare circumstances and lose some usage data due to the nova manages
compute node resources.

My question is: does libvirt already export host uuid identifier to other
applications? I skim through the code base and find there is host uuid
related code which reads /etc/machine-id to obtain a uniq uuid for
migration, but seems this uuid cannot be obtained through virsh interface.

Thank you for you help.

-- 

Best Regards,

Jiatong Shen

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hello community,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I am using OpenStack nova and \
realize that nova now uses host fqdn from libvirt as a uniq identifier for a compute \
node.   The issue is that host might need to change its fqdn under \
some&lt;/div&gt;&lt;div&gt;rare circumstances and lose some usage data due to the nova manages   \
compute node resources.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;My question is: does libvirt already \
export host uuid identifier to other applications? I skim through the code base and \
find there is host uuid related code which reads /etc/machine-id to obtain a uniq \
uuid for migration, but seems this uuid cannot be obtained through virsh \
interface.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thank you for you help.&lt;br \
clear="all"&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- &lt;br&gt;&lt;div dir="ltr" class="gmail_signature" \
data-smartmail="gmail_signature"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;div&gt;Best \
Regards,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Jiatong Shen&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210802122044</emailId><senderName>Vojtech Juranek</senderName><senderEmail>vjuranek@redhat.com</senderEmail><timestampReceived>2021-08-02 12:20:44-0400</timestampReceived><subject>Disk extend during migration</subject><body>


Hi,
as a follow-up of BZ #1883399 [1], we are reviewing vdsm VM migration flows and 
solve few follow-up bugs, e.g. BZ #1981079 [2]. I have couple of questions 
related to libvirt:

* if we run disk extend during migration, it can happen that migration finishes 
sooner than disk extend. In such case we will try to set disk threshold on 
already stopped VM (we handle libvirt event that VM was stopper, but due to 
Python GIL there can be a delay between obtaining appropriate signal from 
libvirt  and handling it). In such case we get libvirt 
VIR_ERR_OPERATION_INVALID when setting disk threshold. Is it safe to 
catch this exception and ignore it or it's thrown for various reasons and the 
root cause can be something else than stopped VM?

* after disk extend, we resume VM if it's stopped (usually due to running out 
of the disk space). Is it safe to do so also when we do the disk extend during 
migration and VM can be stopped because it was already migrated? I.e. can we 
assume that libvirt will handle such situation and won't resume VM in such 
case? We do some checks before resume and try to avoid situation when we 
resume migrated VM, but there can be some corner cases and it would be useful 
to know if we can rely in libvirt to prevent resuming VM in unwanted cases 
like one when VM is stopper after migration.

Thanks
Vojta


[1] https://bugzilla.redhat.com/1883399
[2] https://bugzilla.redhat.com/1981079
["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20210802123005</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-08-02 12:30:05-0400</timestampReceived><subject>Re: Disk extend during migration</subject><body>

On Mon, Aug 02, 2021 at 14:20:44 +0200, Vojtech Juranek wrote:
&gt; Hi,
&gt; as a follow-up of BZ #1883399 [1], we are reviewing vdsm VM migration flows and 
&gt; solve few follow-up bugs, e.g. BZ #1981079 [2]. I have couple of questions 
&gt; related to libvirt:
&gt; 
&gt; * if we run disk extend during migration, it can happen that migration finishes 
&gt; sooner than disk extend. In such case we will try to set disk threshold on 
&gt; already stopped VM (we handle libvirt event that VM was stopper, but due to 
&gt; Python GIL there can be a delay between obtaining appropriate signal from 
&gt; libvirt  and handling it). In such case we get libvirt 
&gt; VIR_ERR_OPERATION_INVALID when setting disk threshold. Is it safe to 
&gt; catch this exception and ignore it or it's thrown for various reasons and the 
&gt; root cause can be something else than stopped VM?

The API to set the block trheshold level can return the following errors
including cases when it can happen:

VIR_ERR_OPERATION_UNSUPPORTED &lt;- unlikely new qemu supports it
VIR_ERR_INVALID_ARG &lt;- disk was not found in VM definition
VIR_ERR_INTERNAL_ERROR &lt;- on error from qemu

Thus VIR_ERR_OPERATION_INVALID seems to be safe to ignore in your
specific case, while not ignoring others can be used to catch problems.

</body></email><email><emailId>20210802133452</emailId><senderName>Vojtech Juranek</senderName><senderEmail>vjuranek@redhat.com</senderEmail><timestampReceived>2021-08-02 13:34:52-0400</timestampReceived><subject>Re: Disk extend during migration</subject><body>


On Monday, 2 August 2021 14:30:05 CEST Peter Krempa wrote:
&gt; On Mon, Aug 02, 2021 at 14:20:44 +0200, Vojtech Juranek wrote:
&gt; &gt; Hi,
&gt; &gt; as a follow-up of BZ #1883399 [1], we are reviewing vdsm VM migration
&gt; &gt; flows and solve few follow-up bugs, e.g. BZ #1981079 [2]. I have couple
&gt; &gt; of questions related to libvirt:
&gt; &gt; 
&gt; &gt; * if we run disk extend during migration, it can happen that migration
&gt; &gt; finishes sooner than disk extend. In such case we will try to set disk
&gt; &gt; threshold on already stopped VM (we handle libvirt event that VM was
&gt; &gt; stopper, but due to Python GIL there can be a delay between obtaining
&gt; &gt; appropriate signal from libvirt  and handling it). In such case we get
&gt; &gt; libvirt
&gt; &gt; VIR_ERR_OPERATION_INVALID when setting disk threshold. 

actually I was wrong here and the issue is actually caused by delay libvirt 
setBlockThreshold() call, form vdsm log:

2021-08-02 09:06:01,918-0400 WARN  (mailbox-hsm/3) [virt.vm] \
(vmId='2dad9038-3e3a-4b5e-8d20-b0da37d9ef79') setting theshold using dom \
&lt;vdsm.virt.virdomain.Notifying object at 0x7fd06610df28&gt; (drivemonitor:122)

[...]

2021-08-02 09:06:03,967-0400 WARN  (libvirt/events) [virt.vm] \
(vmId='2dad9038-3e3a-4b5e-8d20-b0da37d9ef79') libvirt event Stopped detail 3 opaque \
None (vm:5657)

[...]

2021-08-02 09:06:03,969-0400 WARN  (mailbox-hsm/3) [virt.vm] \
(vmId='2dad9038-3e3a-4b5e-8d20-b0da37d9ef79') Domain not connected, skipping set \
block threshold for drive 'sdc' (drivemonitor:133)


so it took about 2 second to libvirt setBlockThreshold() call to return and in \
meantime migration was finished and we get VIR_ERR_OPERATION_INVALID error from \
setBlockThreshold() call.

What is the reason for this delay? Is this operation intentionally delayed until
migration finishes?

I posted relevant libvirt debug log on

https://pastebin.com/YkdKYKM5



&gt; &gt; Is it safe to
&gt; &gt; catch this exception and ignore it or it's thrown for various reasons and
&gt; &gt; the root cause can be something else than stopped VM?
&gt; 
&gt; The API to set the block trheshold level can return the following errors
&gt; including cases when it can happen:
&gt; 
&gt; VIR_ERR_OPERATION_UNSUPPORTED &lt;- unlikely new qemu supports it
&gt; VIR_ERR_INVALID_ARG &lt;- disk was not found in VM definition
&gt; VIR_ERR_INTERNAL_ERROR &lt;- on error from qemu
&gt; 
&gt; Thus VIR_ERR_OPERATION_INVALID seems to be safe to ignore in your
&gt; specific case, while not ignoring others can be used to catch problems.

thanks for your answer


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20210802134515</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-08-02 13:45:15-0400</timestampReceived><subject>Re: Disk extend during migration</subject><body>

On Mon, Aug 02, 2021 at 15:34:52 +0200, Vojtech Juranek wrote:
&gt; On Monday, 2 August 2021 14:30:05 CEST Peter Krempa wrote:
&gt; &gt; On Mon, Aug 02, 2021 at 14:20:44 +0200, Vojtech Juranek wrote:
&gt; &gt; &gt; Hi,
&gt; &gt; &gt; as a follow-up of BZ #1883399 [1], we are reviewing vdsm VM migration
&gt; &gt; &gt; flows and solve few follow-up bugs, e.g. BZ #1981079 [2]. I have couple
&gt; &gt; &gt; of questions related to libvirt:
&gt; &gt; &gt; 
&gt; &gt; &gt; * if we run disk extend during migration, it can happen that migration
&gt; &gt; &gt; finishes sooner than disk extend. In such case we will try to set disk
&gt; &gt; &gt; threshold on already stopped VM (we handle libvirt event that VM was
&gt; &gt; &gt; stopper, but due to Python GIL there can be a delay between obtaining
&gt; &gt; &gt; appropriate signal from libvirt  and handling it). In such case we get
&gt; &gt; &gt; libvirt
&gt; &gt; &gt; VIR_ERR_OPERATION_INVALID when setting disk threshold. 
&gt; 
&gt; actually I was wrong here and the issue is actually caused by delay libvirt 
&gt; setBlockThreshold() call, form vdsm log:
&gt; 
&gt; 2021-08-02 09:06:01,918-0400 WARN  (mailbox-hsm/3) [virt.vm] \
&gt; (vmId='2dad9038-3e3a-4b5e-8d20-b0da37d9ef79') setting theshold using dom \
&gt; &lt;vdsm.virt.virdomain.Notifying object at 0x7fd06610df28&gt; (drivemonitor:122) 
&gt; [...]
&gt; 
&gt; 2021-08-02 09:06:03,967-0400 WARN  (libvirt/events) [virt.vm] \
&gt; (vmId='2dad9038-3e3a-4b5e-8d20-b0da37d9ef79') libvirt event Stopped detail 3 opaque \
&gt; None (vm:5657) 
&gt; [...]
&gt; 
&gt; 2021-08-02 09:06:03,969-0400 WARN  (mailbox-hsm/3) [virt.vm] \
&gt; (vmId='2dad9038-3e3a-4b5e-8d20-b0da37d9ef79') Domain not connected, skipping set \
&gt; block threshold for drive 'sdc' (drivemonitor:133) 
&gt; 
&gt; so it took about 2 second to libvirt setBlockThreshold() call to return and in \
&gt; meantime migration was finished and we get VIR_ERR_OPERATION_INVALID error from \
&gt; setBlockThreshold() call. 
&gt; What is the reason for this delay? Is this operation intentionally delayed until
&gt; migration finishes?

Actually, qemuDomainSetBlockThreshold which is the backend for
virDomainSetBlockThreshold requires a QEMU_JOB_MODIFY job on the domain,
so this actually can't even be set _during_ migration.

In fact what happens is that the API call is waiting to be able to
obtain the MODIFY job and that can happen only after the migration is
finished, thus it always serializes after the migration.


</body></email><email><emailId>20210902024406</emailId><senderName>Jiatong Shen</senderName><senderEmail>yshxxsjt715@gmail.com</senderEmail><timestampReceived>2021-09-02 02:44:06-0400</timestampReceived><subject>vm vcpu uses isolated cores</subject><body>

Hello,

   I am trying to understand why qemu vm CPU threads uses isolated cpus.

  I have a host which isolates some cpus using isolcpu
like isolcpus=1,2,3,4,5,7,8,9,10,11. unfortunately, vcpupin does not mask
out these cpus (vcpupin is still something like ffffffff).
When I log in to the system, seems qemu cpu thread only runs on these
isolcpus. I do not quite understand this behavior, because I think by using
isolcpu, kernel schedule will exclude these cpus and thus vcpu thread
shouldn't use these cores unless taskset explicitly got called.. So my
question is how does cpu thread got scheduled on isolated cpus?

Thank you.

-- 

Best Regards,

Jiatong Shen

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hello,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;     I am trying to understand why qemu vm \
CPU threads uses isolated cpus.  &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;   I have a host which \
isolates some cpus using isolcpu like  isolcpus=1,2,3,4,5,7,8,9,10,11. unfortunately, \
vcpupin does not mask out these cpus (vcpupin is still something like ffffffff).  \
&lt;/div&gt;&lt;div&gt;When I log in to the system, seems qemu cpu thread only runs on these \
isolcpus. I do not quite understand this behavior, because I think by using isolcpu, \
kernel schedule will exclude these cpus and thus vcpu thread shouldn't use these \
cores unless taskset explicitly got called.. So my question is how does cpu thread \
got scheduled  on isolated cpus?  &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thank \
you.&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- &lt;br&gt;&lt;div dir="ltr" class="gmail_signature" \
data-smartmail="gmail_signature"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;div&gt;Best \
Regards,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Jiatong Shen&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210902082408</emailId><senderName>Martin Kletzander</senderName><senderEmail>mkletzan@redhat.com</senderEmail><timestampReceived>2021-09-02 08:24:08-0400</timestampReceived><subject>Re: vm vcpu uses isolated cores</subject><body>


On Thu, Sep 02, 2021 at 10:44:06AM +0800, Jiatong Shen wrote:
&gt;Hello,
&gt;
&gt;   I am trying to understand why qemu vm CPU threads uses isolated cpus.
&gt;
&gt;  I have a host which isolates some cpus using isolcpu
&gt;like isolcpus=1,2,3,4,5,7,8,9,10,11. unfortunately, vcpupin does not mask
&gt;out these cpus (vcpupin is still something like ffffffff).

That is because there are use cases which need this.  They isolate cpus
to be used by VM only (sometimes even moving kernel workload from these
cpus) and automatically removing isolcpus from the set would break this
valid behaviour.

&gt;When I log in to the system, seems qemu cpu thread only runs on these
&gt;isolcpus. I do not quite understand this behavior, because I think by using
&gt;isolcpu, kernel schedule will exclude these cpus and thus vcpu thread
&gt;shouldn't use these cores unless taskset explicitly got called.. So my
&gt;question is how does cpu thread got scheduled on isolated cpus?
&gt;

libvirt sets the affinity for VMs because libvirt itself might not be
running on all cores and qemu being a child process would otherwise
inherit the affinity.  We even have this in the documentation and if you
want to limit the cpus it needs to be defined in the XML.

It begs the question whether we should somehow coordinate with the
kernel based on isolcpus, but I am not sure under what circumstances we
should do that and what is the proper way to do that.  I would suggest
you file an issue to discuss this further unless someone comes up with a
clear decision here.

Thank you,
Martin

&gt;Thank you.
&gt;
&gt;-- 
&gt;
&gt;Best Regards,
&gt;
&gt;Jiatong Shen

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20210705082950</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-07-05 08:29:50-0400</timestampReceived><subject>Re: host identifier</subject><body>

On Mon, Jul 05, 2021 at 08:31:15AM +0800, Jiatong Shen wrote:
&gt; Hello community,
&gt; 
&gt; I am using OpenStack nova and realize that nova now uses host fqdn from
&gt; libvirt as a uniq identifier for a compute node.  The issue is that host
&gt; might need to change its fqdn under some
&gt; rare circumstances and lose some usage data due to the nova manages
&gt; compute node resources.
&gt; 
&gt; My question is: does libvirt already export host uuid identifier to other
&gt; applications? I skim through the code base and find there is host uuid
&gt; related code which reads /etc/machine-id to obtain a uniq uuid for
&gt; migration, but seems this uuid cannot be obtained through virsh interface.

Libvirt has long exposed a host UUID in the capabilities XML

Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20210602052425</emailId><senderName>Tony Brian Albers</senderName><senderEmail>tba@kb.dk</senderEmail><timestampReceived>2021-06-02 05:24:25-0400</timestampReceived><subject>Re: virt viewer for Mac</subject><body>

Francesc Guasch wrote:
&gt; Hi. Please excuse me if this is not the right place to ask.
&gt; 
&gt; We are using virt viewer happily from Linux, and though the
&gt; Windows release sometimes has issues it seems it is maintained.
&gt; 
&gt; There is this Mac client here:
&gt; 
&gt; https://people.freedesktop.org/~teuf/spice-gtk-osx/
&gt; 
&gt; We have been reported it is outdated and somehow buggy.
&gt; 
&gt; Is there another alternative ? Are there plans to port
&gt; virt-viewer for Macs ?
&gt; 
&gt; Thank you.
&gt; 

Have you tried searching github? There seems to be quite a few people 
working on homebrew formulaes for virt-manager and virt-viewer

/tony

-- 
Tony Albers - Systems Architect - IT Development Royal Danish Library, 
Victor Albecks Vej 1, 8000 Aarhus C, Denmark
Tel: +45 2566 2383 - CVR/SE: 2898 8842 - EAN: 5798000792142

</body></email><email><emailId>20210519103823</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-05-19 10:38:23-0400</timestampReceived><subject>Re: virHostdevIsPCINodeDeviceUsed</subject><body>

On 5/17/21 8:36 PM, Simon Fairweather wrote:
&gt; I am looking to be able to check if a specific PCI device is allocated to a
&gt; guest.
&gt; 
&gt; An error is produced if a domain is started and the device is in use within
&gt; another domain via this function.
&gt; 
&gt; I cannot see a publicly available function to use to get this information,
&gt; is there one available or is there another way to check the state of the
&gt; PCI device.
&gt; 

Yeah, there's no public API. So far we recommended mgmt apps to track
the usage themselves, however I don't see why we shouldn't have a new
API, say:

int virNodeDeviceGetUsed(virNodeDevicePtr dev, char **drvname, char
**domname);

Can you please open a gitlab issue for this? Or, are you willing to
submit patches?

Michal

</body></email><email><emailId>20210519113806</emailId><senderName>Simon Fairweather</senderName><senderEmail>simon.n.fairweather@gmail.com</senderEmail><timestampReceived>2021-05-19 11:38:06-0400</timestampReceived><subject>Re: virHostdevIsPCINodeDeviceUsed</subject><body>

Thanks, I will raise an issue and look to see if I can raise a patch.

Regards
Simon

On Wed, May 19, 2021 at 11:38 AM Michal Pr=C3=ADvozn=C3=ADk &lt;mprivozn@redha=
t.com&gt;
wrote:

&gt; On 5/17/21 8:36 PM, Simon Fairweather wrote:
&gt; &gt; I am looking to be able to check if a specific PCI device is allocated
&gt; to a
&gt; &gt; guest.
&gt; &gt;
&gt; &gt; An error is produced if a domain is started and the device is in use
&gt; within
&gt; &gt; another domain via this function.
&gt; &gt;
&gt; &gt; I cannot see a publicly available function to use to get this
&gt; information,
&gt; &gt; is there one available or is there another way to check the state of th=
e
&gt; &gt; PCI device.
&gt; &gt;
&gt;
&gt; Yeah, there's no public API. So far we recommended mgmt apps to track
&gt; the usage themselves, however I don't see why we shouldn't have a new
&gt; API, say:
&gt;
&gt; int virNodeDeviceGetUsed(virNodeDevicePtr dev, char **drvname, char
&gt; **domname);
&gt;
&gt; Can you please open a gitlab issue for this? Or, are you willing to
&gt; submit patches?
&gt;
&gt; Michal
&gt;
&gt;

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Thanks, I will raise an issue and look to see if I can raise a \
patch.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards&lt;/div&gt;&lt;div&gt;Simon&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Wed, May 19, 2021 at 11:38 \
AM Michal Prívozník &lt;&lt;a \
href="mailto:mprivozn@redhat.com"&gt;mprivozn@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;On 5/17/21 8:36 PM, \
Simon Fairweather wrote:&lt;br&gt; &gt; I am looking to be able to check if a specific PCI \
device is allocated to a&lt;br&gt; &gt; guest.&lt;br&gt;
&gt; &lt;br&gt;
&gt; An error is produced if a domain is started and the device is in use within&lt;br&gt;
&gt; another domain via this function.&lt;br&gt;
&gt; &lt;br&gt;
&gt; I cannot see a publicly available function to use to get this information,&lt;br&gt;
&gt; is there one available or is there another way to check the state of the&lt;br&gt;
&gt; PCI device.&lt;br&gt;
&gt; &lt;br&gt;
&lt;br&gt;
Yeah, there's no public API. So far we recommended mgmt apps to track&lt;br&gt;
the usage themselves, however I don't see why we shouldn't have a new&lt;br&gt;
API, say:&lt;br&gt;
&lt;br&gt;
int virNodeDeviceGetUsed(virNodeDevicePtr dev, char **drvname, char&lt;br&gt;
**domname);&lt;br&gt;
&lt;br&gt;
Can you please open a gitlab issue for this? Or, are you willing to&lt;br&gt;
submit patches?&lt;br&gt;
&lt;br&gt;
Michal&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;



</body></email><email><emailId>20210401151327</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-04-01 15:13:27-0400</timestampReceived><subject>Re: GlusterFS libgfapi with TLS</subject><body>

On Thu, Apr 01, 2021 at 15:13:02 +0100, lejeczek wrote:
&gt; Hi guys.
&gt; 
&gt; I have KVM guests stored on glusterFS volume and I recently added TLS
&gt; encryption to Gluster.
&gt; What changes, tweaks are required at libvirtd/qemu's end?

Looking at the definition of the gluster backend object in qemu:

&lt;cite&gt;
##
# @BlockdevOptionsGluster:
#
# Driver specific block device options for Gluster
#
# @volume: name of gluster volume where VM image resides
#
# @path: absolute path to image file in gluster volume
#
# @server: gluster servers description
#
# @debug: libgfapi log level (default '4' which is Error)
#         (Since 2.8)
#
# @logfile: libgfapi log file (default /dev/stderr) (Since 2.8)
#
# Since: 2.9
##
{ 'struct': 'BlockdevOptionsGluster',
  'data': { 'volume': 'str',
            'path': 'str',
            'server': ['SocketAddress'],
            '*debug': 'int',
            '*logfile': 'str' } }

&lt;/cite&gt;

it doesn't seem to yet support TLS encryption of the transport or a way
to set it in a non-implicit way (it still might be possible to trick
libgfapi to support it via a config file or such).

That means you'll probably need to submit qemu patches implementing the
support for configuring TLS for gluster to qemu first, and then do the
same for libvirt.

Libvirt already has some infrastructure for that for NBD and VXHS disks,
so you can then take inspiration there when implementing it in libvirt.

</body></email><email><emailId>20210104092203</emailId><senderName>"tommy"</senderName><senderEmail>sz_cuitao@163.com</senderEmail><timestampReceived>2021-01-04 09:22:03-0400</timestampReceived><subject>RE: How to open listener of Libvirt ?</subject><body>

But there are not such services:

  libvirtd-tcp.socket       
  libvirtd-tls.socket       

I really not understand how to enable them.:)

Should I reinstall libvirtd on my Ubuntu OS, or should I only need install the \
missing packages about the two services ?

Thanks.

 





-----Original Message-----
From: Andrea Bolognani &lt;abologna@redhat.com&gt; 
Sent: Monday, January 4, 2021 5:08 PM
To: tommy &lt;sz_cuitao@163.com&gt;; libvirt-users@redhat.com
Subject: Re: How to open listener of Libvirt ?

On Thu, 2020-12-24 at 13:38 +0800, tommy wrote:
&gt; Hi,every one:
&gt; 
&gt; My Ubuntu is : 20.04 LTS, and I using libvirtd on it to manage KVM vm, but now I \
&gt; can not open listener function of the libvirtd. 
&gt; 
&gt; SYSTEM SOCKET ACTIVATION
&gt; The libvirtd daemon is capable of starting in two modes.
&gt; 
&gt; In the traditional mode, it will create and listen on UNIX sockets itself.  If the \
&gt; --listen parameter is given, it will also listen on TCP/IP socket(s), according to \
&gt;                 the listen_tcp and listen_tls options in 
&gt; /etc/libvirt/libvirtd.conf
&gt; 
&gt; In socket activation mode, it will rely on systemd to create and listen on the \
&gt; UNIX, and optionally TCP/IP, sockets and pass them as pre-opened file de- \
&gt; scriptors. In this mode, it is not permitted to pass the --listen parameter, and \
&gt; most of the socket related config options in /etc/libvirt/libvirtd.conf will no \
&gt; longer have any effect. To enable TCP or TLS sockets  use either
&gt; 
&gt; $ systemctl start libvirtd-tls.socket
&gt; 
&gt; Or
&gt; 
&gt; $ systemctl start libvirtd-tcp.socket
&gt; 
&gt; 
&gt; But, on my system, there are no such service like libvirtd-tls.socket or \
&gt; libvirtd-tcp.socket. 
&gt; root@ubts1:~# systemctl  | grep libvirt
&gt; libvirt-guests.service                                                              \
&gt; loaded active exited    Suspend/Resume Running libvirt Guests         \
&gt; libvirtd.service                                                                    \
&gt; loaded active running   Virtualization daemon                         \
&gt; libvirtd-admin.socket                                                               \
&gt; loaded active running   Libvirt admin socket                          \
&gt; libvirtd-ro.socket                                                                  \
&gt; loaded active running   Libvirt local read-only socket                \
&gt; libvirtd.socket                                                                     \
&gt; loaded active running   Libvirt local socket                          
&gt; How can I open the listener ?

On my machine:

  $ systemctl list-unit-files | grep libvirt
  libvirt-guests.service    enabled     enabled
  libvirtd.service          enabled     enabled
  libvirtd-admin.socket     enabled     enabled
  libvirtd-ro.socket        enabled     enabled
  libvirtd-tcp.socket       disabled    enabled
  libvirtd-tls.socket       disabled    enabled
  libvirtd.socket           enabled     enabled

This is Debian, but the Ubuntu package is pretty much identical, so I don't expect it \
to behave differently.

So the unit exists on you system, you just need to enable it :)

--
Andrea Bolognani / Red Hat / Virtualization


</body></email><email><emailId>20210902090031</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-09-02 09:00:31-0400</timestampReceived><subject>Re: vm vcpu uses isolated cores</subject><body>

On Thu, Sep 02, 2021 at 10:24:08AM +0200, Martin Kletzander wrote:
&gt; On Thu, Sep 02, 2021 at 10:44:06AM +0800, Jiatong Shen wrote:
&gt; &gt; Hello,
&gt; &gt; 
&gt; &gt;   I am trying to understand why qemu vm CPU threads uses isolated cpus.
&gt; &gt; 
&gt; &gt;  I have a host which isolates some cpus using isolcpu
&gt; &gt; like isolcpus=1,2,3,4,5,7,8,9,10,11. unfortunately, vcpupin does not mask
&gt; &gt; out these cpus (vcpupin is still something like ffffffff).
&gt; 
&gt; That is because there are use cases which need this.  They isolate cpus
&gt; to be used by VM only (sometimes even moving kernel workload from these
&gt; cpus) and automatically removing isolcpus from the set would break this
&gt; valid behaviour.
&gt; 
&gt; &gt; When I log in to the system, seems qemu cpu thread only runs on these
&gt; &gt; isolcpus. I do not quite understand this behavior, because I think by using
&gt; &gt; isolcpu, kernel schedule will exclude these cpus and thus vcpu thread
&gt; &gt; shouldn't use these cores unless taskset explicitly got called.. So my
&gt; &gt; question is how does cpu thread got scheduled on isolated cpus?
&gt; &gt; 
&gt; 
&gt; libvirt sets the affinity for VMs because libvirt itself might not be
&gt; running on all cores and qemu being a child process would otherwise
&gt; inherit the affinity.  We even have this in the documentation and if you
&gt; want to limit the cpus it needs to be defined in the XML.
&gt; 
&gt; It begs the question whether we should somehow coordinate with the
&gt; kernel based on isolcpus, but I am not sure under what circumstances we
&gt; should do that and what is the proper way to do that.  I would suggest
&gt; you file an issue to discuss this further unless someone comes up with a
&gt; clear decision here.

Well if someone is using isolcpus, it is because they want to have some
pretty strict control over what runs on what CPUs. The notion of what
a good default placement would be, is then is quite ill-defined. Do you
want to avoid the isolcpus CPUs mask, because it is being used for non-VM
tasks, or do you want to use the isolcpus CPUs becuase it is intended
for VM tasks.  Further more, if we paid any attention to isolcpus mask,
then the VM XML configuration would no longer result in a reproducable
deployment - semantics would vary based on the invisible isolcpus
setting.

Given all that, if someone is using isolcpus, then I'd really expect
that they set explicit affinity for the VMs too. Note this does not
have to be done at the libvirt level at all. On systemd hosts all
VMs will be placed in /machine.slice, so even if the QEMU processes
have an all-1s affinity mask, the CPU affinity on /machine.slice
will take priority.

IOW, if setting isolcpus, you should also always set /machine.slice
CPU affinity.

Which leads into the final point - the need for isolcpus is widely
mis-understood. The only scenario isolcpus is generally required
is for hard real-time workloads, where you absolutely must stop
all kernel threads running on those CPUs. In any non-real-time
scenario, it is sufficient to "isolate" / "reserve" CPUs using
CPU affinity in cgroups alone. For systemd this can be done
globally using CPUAffinity in /etc/systemd/system.conf, to
restrict most OS services to some house keeping CPUs, and then
using /machine.slice to grant access to other CPUs for VMs.

Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20210906065555</emailId><senderName>Guozhonghua</senderName><senderEmail>guozh88@chinatelecom.cn</senderEmail><timestampReceived>2021-09-06 06:55:55-0400</timestampReceived><subject>Re: Re: one qustion about the snapshot of the libvirt, thanks.</subject><body>

[Attachment #2 (text/plain)]


Hi, Peter

I really appreciate it.

Thank you!




 
From: Peter Krempa
Date: 2021-09-06 14:37
To: Guozhonghua
CC: libvirt-users
Subject: Re: one qustion about the snapshot of the libvirt, thanks.
On Tue, Aug 31, 2021 at 16:09:50 +0800, Guozhonghua wrote:
&gt; 
&gt; Hello, 
&gt; 
&gt; When we test snapshot features and review the code of libvirt, there is one \
&gt; question, not an issue.  
&gt; /* do the memory snapshot if necessary */
&gt; if (memory) {
&gt; /* check if migration is possible */
&gt; if (!qemuMigrationSrcIsAllowed(driver, vm, false, 0))
&gt; goto cleanup;
&gt; 
&gt; While making one snapshot with memory on one vm, but it is not allowed while the vm \
&gt; which has some src devices, such as pci devs, with which the vm is not allowed to \
&gt; be migrated. I want to known the reason, why should  it check this conditions? 
 
The reason for this check is that the state of host devices namely PCI
devices can't be serialized by qemu and saved in the snapshot. That
means that when reverting the devices would not be configured properly
and would not work.
 
Internally qemu and libvirt use the migration code to serialize the
state of the VM and that is the reason why 'qemuMigrationSrcIsAllowed'
is called here, because it uses the same implementation.
 
 


[Attachment #3 (text/html)]

&lt;html&gt;&lt;head&gt;&lt;meta http-equiv="content-type" content="text/html; \
charset=utf-8"&gt;&lt;style&gt;body { line-height: 1.5; }blockquote { margin-top: 0px; \
margin-bottom: 0px; margin-left: 0.5em; }body { font-size: 14px; font-family: \
'Microsoft YaHei UI'; color: rgb(0, 0, 0); line-height: 1.5; }&lt;/style&gt;&lt;/head&gt;&lt;body&gt; \
&lt;div&gt;&lt;span&gt;&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Hi, Peter&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="color: rgb(25, 25, 25); font-family: 'PingFang SC', Arial, 微软雅黑, \
宋体, simsun, sans-serif; font-size: 16px; font-variant-ligatures: normal; orphans: \
2; widows: 2;"&gt;I really appreciate it.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style="color: rgb(25, \
25, 25); font-family: 'PingFang SC', Arial, 微软雅黑, 宋体, simsun, sans-serif; \
font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: \
2;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;Thank you!&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;hr \
style="width: 210px; height: 1px; display: none;" color="#b5c4df" size="1" \
align="left"&gt; &lt;div&gt;&lt;span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;blockquote style="margin-Top: 0px; margin-Bottom: 0px; margin-Left: 0.5em; \
margin-Right: inherit"&gt;&lt;div&gt; &lt;/div&gt;&lt;div style="border:none;border-top:solid \
#B5C4DF 1.0pt;padding:3.0pt 0cm 0cm 0cm"&gt;&lt;div style="PADDING-RIGHT: 8px; \
PADDING-LEFT: 8px; FONT-SIZE: 12px;FONT-FAMILY:tahoma;COLOR:#000000; BACKGROUND: \
#efefef; PADDING-BOTTOM: 8px; PADDING-TOP: 8px"&gt;&lt;div&gt;&lt;b&gt;From:&lt;/b&gt; &lt;a \
href="mailto:pkrempa@redhat.com"&gt;Peter \
Krempa&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;Date:&lt;/b&gt; 2021-09-06 14:37&lt;/div&gt;&lt;div&gt;&lt;b&gt;To:&lt;/b&gt; &lt;a \
href="mailto:guozh88@chinatelecom.cn"&gt;Guozhonghua&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;CC:&lt;/b&gt; &lt;a \
href="mailto:libvirt-users@redhat.com"&gt;libvirt-users&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;Subject:&lt;/b&gt; Re: \
one qustion about the snapshot of the libvirt, thanks.&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;On \
Tue, Aug 31, 2021 at 16:09:50 +0800, Guozhonghua wrote:&lt;/div&gt; &lt;div&gt;&gt; &lt;/div&gt;
&lt;div&gt;&gt; Hello, &lt;/div&gt;
&lt;div&gt;&gt; &lt;/div&gt;
&lt;div&gt;&gt; When we test snapshot features and review the code of libvirt, there is one \
question, not an issue. &lt;/div&gt; &lt;div&gt;&gt; &lt;/div&gt;
&lt;div&gt;&gt;     /* do the memory snapshot if necessary */&lt;/div&gt;
&lt;div&gt;&gt;     if (memory) {&lt;/div&gt;
&lt;div&gt;&gt;         /* check if migration is \
possible */&lt;/div&gt; &lt;div&gt;&gt;         if \
(!qemuMigrationSrcIsAllowed(driver, vm, false, 0))&lt;/div&gt; \
&lt;div&gt;&gt;             \
goto cleanup;&lt;/div&gt; &lt;div&gt;&gt; &lt;/div&gt;
&lt;div&gt;&gt; While making one snapshot with memory on one vm, but it is not allowed \
while the vm which has some src devices, such as pci devs, with which the vm is not \
allowed to be migrated.&lt;/div&gt; &lt;div&gt;&gt; I want to known the reason, why should  \
it check this conditions? &lt;/div&gt; &lt;div&gt; &lt;/div&gt;
&lt;div&gt;The reason for this check is that the state of host devices namely PCI&lt;/div&gt;
&lt;div&gt;devices can't be serialized by qemu and saved in the snapshot. That&lt;/div&gt;
&lt;div&gt;means that when reverting the devices would not be configured properly&lt;/div&gt;
&lt;div&gt;and would not work.&lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt;Internally qemu and libvirt use the migration code to serialize the&lt;/div&gt;
&lt;div&gt;state of the VM and that is the reason why 'qemuMigrationSrcIsAllowed'&lt;/div&gt;
&lt;div&gt;is called here, because it uses the same implementation.&lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;/div&gt;&lt;/blockquote&gt;
&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20210909212905</emailId><senderName>Å tÄ›pÃ¡n NÄ›mec</senderName><senderEmail>stepnem@gmail.com</senderEmail><timestampReceived>2021-09-09 21:29:05-0400</timestampReceived><subject>Re: snapshot creation broken recently?</subject><body>

On Thu, 09 Sep 2021 19:28:04 +0100
Daniel P. BerrangÃ© wrote:

&gt; On Thu, Sep 09, 2021 at 02:33:25PM +0200, Å tÄ›pÃ¡n NÄ›mec wrote:
&gt;&gt; libvirt.libvirtError: operation failed: Failed to take snapshot: pre-save failed: qxl
&gt;&gt; Error: Error while writing VM state: Unknown error -1
&gt;&gt; 
&gt;&gt; I am on Arch Linux (x86_64), using the distro packages. Checking my
&gt;&gt; pacman logs, might update of qemu-headless from 6.0.0 to 6.1.0 have
&gt;&gt; something to do with that?
&gt;
&gt; Yes, auite likely related to the QEMU update as
&gt;
&gt;   "pre-save failed: qxl"
&gt;
&gt; is an error message that libvirt is getting back from QEMU.

Thanks!

&gt; There was a change in this code in qemu in 6.1.0, but that was
&gt; replacing an assert() with this graceful error message. So if
&gt; anything your older QEMU ought to have been crashing !

Not only were/is it not crashing; downgrading the package back to 6.0.0
makes the snapshots work again.

&gt; Anyway, I think you need to report this to the QEMU community.

Filed as https://gitlab.com/qemu-project/qemu/-/issues/610

Thank you,

  Å tÄ›pÃ¡n


</body></email><email><emailId>20210910133725</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-09-10 13:37:25-0400</timestampReceived><subject>Re: startupPolicy issue when changing CD</subject><body>

On Fri, Sep 10, 2021 at 15:34:57 +0200, Vojtech Juranek wrote:
&gt; On Friday, 10 September 2021 15:12:07 CEST Peter Krempa wrote:
&gt; &gt; On Fri, Sep 10, 2021 at 14:53:23 +0200, Vojtech Juranek wrote:
&gt; &gt; &gt; Hi,
&gt; &gt; &gt; when adding support for CD disk on block based storage into oVirt,
&gt; &gt; &gt; I spotted following issue. When starting VM without CD, we add
&gt; &gt; &gt; startupPolicy='optional' attribute into &lt;source&gt; element.
&gt; &gt; &gt; 
&gt; &gt; &gt; Whole XML looks like this:
&gt; &gt; &gt;     &lt;disk type='file' device='cdrom'&gt;
&gt; &gt; &gt;     
&gt; &gt; &gt;       &lt;driver name='qemu' error_policy='report'/&gt;
&gt; &gt; &gt;       &lt;source startupPolicy='optional'/&gt;
&gt; &gt; &gt;       &lt;target dev='sdc' bus='sata'/&gt;
&gt; &gt; &gt;       &lt;readonly/&gt;
&gt; &gt; &gt;       &lt;alias name='ua-d7003457-63c3-4c98-80f0-08ab5042c65e'/&gt;
&gt; &gt; &gt;       &lt;address type='drive' controller='0' bus='0' target='0' unit='2'/&gt;
&gt; &gt; &gt;     
&gt; &gt; &gt;     &lt;/disk&gt;
&gt; &gt; &gt; 
&gt; &gt; &gt; To change/insert CD we use libvirt.updateDeviceFlags() with XML which
&gt; &gt; &gt; looks like this (for block based disk):
&gt; &gt; &gt; 
&gt; &gt; &gt; &lt;?xml version='1.0' encoding='utf-8'?&gt;
&gt; &gt; &gt; &lt;disk device="cdrom" type="block"&gt;
&gt; &gt; &gt; 
&gt; &gt; &gt;     &lt;source
&gt; &gt; &gt;     dev="/rhev/data-center/mnt/blockSD/cdac2a0c-b110-456d-a988-7d588626c8
&gt; &gt; &gt;     71/images/638247d7-b4b1-4d98-87fa-c90235fcf4b1/145e7cd2-f92d-4eec-a8fb
&gt; &gt; &gt;     -6835b4b652e1" /&gt; &lt;target bus="sata" dev="sdc" /&gt;

Please note that according to the updateDevice API docs you should
provide a fully-defined XML of the device, and not omit fields you don't
want to change.

This fact was even discussed today on the mailing list:

https://listman.redhat.com/archives/libvir-list/2021-September/msg00246.html

&gt; &gt; &gt; 
&gt; &gt; &gt; &lt;/disk&gt;
&gt; &gt; &gt; 
&gt; &gt; &gt; However, updateDeviceFlags() fails with
&gt; &gt; &gt; 
&gt; &gt; &gt;     libvirt.libvirtError: XML error: 'startupPolicy' is only valid for
&gt; &gt; &gt;     'file' type volume&gt; 
&gt; &gt; &gt; What is the reason for this error? We don't use `startupPolicy` attribute
&gt; &gt; &gt; for block based disks, as shown on example above.
&gt; &gt; 
&gt; &gt; Hmm, the bug is that the disk source change is attempted before the
&gt; &gt; update to startup policy, thus the validator is unhappy.
&gt; 
&gt; is this a libvirt bug or intentional behavior and the CD change should be done 
&gt; in two steps:
&gt; * remove startupPolicy from the disk
&gt; * do actual change of the disk
&gt; ?

Fix proposed:

https://listman.redhat.com/archives/libvir-list/2021-September/msg00283.html

</body></email><email><emailId>20210912074431</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-09-12 07:44:31-0400</timestampReceived><subject>Re: virsh domifaddr domain does not show static IP</subject><body>

On 9/10/21 4:07 AM, Kaushal Shriyan wrote:
&gt; 

&gt; 
&gt; Is there a way to find out the Static IP address if the KVM Guest VM
&gt; instance is shut off? Thanks in advance.  
&gt; 

This strongly depends on where you configure the static IP. If it's a
libvirt managed network then you can just dump the network XML and run
fairly trivial XPATH to learn the IP address. But if you use something
else to assign IP addresses, something that's outside of libvirt's scope
then I guess what Laine wrote in the other reply is your only hope.

Michal

</body></email><email><emailId>20210913104918</emailId><senderName>Pavel Hrdina</senderName><senderEmail>phrdina@redhat.com</senderEmail><timestampReceived>2021-09-13 10:49:18-0400</timestampReceived><subject>Re: Compiling libvirt on ubuntu</subject><body>


On Mon, Sep 13, 2021 at 10:27:38AM +0200, Peter Krempa wrote:
&gt; On Mon, Sep 13, 2021 at 01:36:57 +0000, Or Ozeri wrote:
&gt; &gt; Hi,
&gt; &gt; 
&gt; &gt; 
&gt; &gt; I'm trying to compile libvirt on ubuntu machine.
&gt; &gt; I installed meson 0.59.1 using pip.
&gt; &gt; Then installed a few more packages that were required by meson build:
&gt; &gt; sudo apt-get install libxml2-utils xsltproc libpciaccess-dev ninja-build
&gt; &gt; 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; Finally, I followed the simple instructions over here: \
&gt; &gt; https://libvirt.org/compiling.html 
&gt; &gt; xz -dc libvirt-7.7.0.tar.xz | tar xvf -
&gt; &gt; cd libvirt-7.7.0
&gt; &gt; meson build
&gt; &gt; ninja -C build
&gt; &gt; 
&gt; &gt; The last command fails with:
&gt; &gt; 
&gt; &gt; FAILED: src/libvirt-admin.so.0.7007.0
&gt; &gt; cc  -o src/libvirt-admin.so.0.7007.0 src/libvirt_probes.o \
&gt; &gt; src/libvirt-admin.so.0.7007.0.p/meson-generated_.._admin_admin_protocol.c.o \
&gt; &gt; src/libvirt-admin.so.0.7007.0.p/admin_libvirt-admin.c.o \
&gt; &gt; src/libvirt-admin.so.0.7007.0.p/datatypes.c.o -Wl,--as-needed -Wl,--no-undefined \
&gt; &gt; -shared -fPIC -Wl,--start-group -Wl,-soname,libvirt-admin.so.0 \
&gt; &gt; '-Wl,-rpath,$ORIGIN/:XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' \
&gt; &gt; -Wl,-rpath-link,/home/oro/ozeri/libvirt-7.7.0/build/src src/libvirt.so.0.7007.0 \
&gt; &gt; -Wl,--version-script=/home/oro/ozeri/libvirt-7.7.0/build/src/admin/libvirt_admin.syms \
&gt; &gt; -Wl,-z,nodelete /usr/lib/x86_64-linux-gnu/libcap-ng.so \
&gt; &gt; /usr/lib/gcc/x86_64-linux-gnu/9/../../../x86_64-linux-gnu/libdevmapper.so \
&gt; &gt; /usr/lib/x86_64-linux-gnu/libgnutls.so -Wl,-z,relro -Wl,-z,now \
&gt; &gt; -Wl,--no-copy-dt-needed-entries /usr/lib/x86_64-linux-gnu/libglib-2.0.so \
&gt; &gt; /usr/lib/x86_64-linux-gnu/libgobject-2.0.so \
&gt; &gt; /usr/lib/x86_64-linux-gnu/libgio-2.0.so /usr/lib/x86_64-linux-gnu/libxml2.so \
&gt; &gt; /usr/lib/x86_64-linux-gnu/libyajl.so -Wl,--end-grou
&gt; p
&gt; &gt; /usr/bin/ld: src/libvirt-admin.so.0.7007.0.p/admin_libvirt-admin.c.o: in function \
&gt; &gt;                 `callFull':
&gt; &gt; /home/oro/ozeri/libvirt-7.7.0/build/../src/admin/admin_remote.c:99: undefined \
&gt; &gt;                 reference to `virNetClientProgramCall'
&gt; &gt; /usr/bin/ld: src/libvirt-admin.so.0.7007.0.p/admin_libvirt-admin.c.o: in function \
&gt; &gt;                 `remoteAdminConnectClose':
&gt; &gt; /home/oro/ozeri/libvirt-7.7.0/build/../src/admin/admin_remote.c:197: undefined \
&gt; &gt; reference to `virNetClientSetCloseCallback'
&gt; 
&gt; You've seem to have run into the same issue that is reported as:
&gt; 
&gt; https://gitlab.com/libvirt/libvirt/-/issues/196
&gt; 
&gt; If I read the issue correctly the following should fix it for you:
&gt; 
&gt; meson build -Ddriver_remote=enabled

Not sure if it helps. We now have auto-detection for the remote driver
and it is enabled automatically only if there is XDR library. Your
suggestion would make the `meson build -Ddriver_remote=enabled` fail
with different error and would not solve the issue.

You need to install `libtirpc-dev` to have driver_remote compiled or you
can disable the driver. But I guess that's not what you want as without
driver_remote you will not have libvirtd.

Pavel


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20210917172547</emailId><senderName>Michael_Ströder</senderName><senderEmail>michael@stroeder.com</senderEmail><timestampReceived>2021-09-17 17:25:47-0400</timestampReceived><subject>Re: internal error: Network is already in use by interface virbr0</subject><body>

On 9/17/21 19:04, Jim Fehlig wrote:
&gt; On 9/17/21 10:46, Laine Stump wrote:
&gt;&gt; On 9/17/21 7:11 AM, Michael Ströder wrote:
&gt;&gt;&gt; When restarting libvirtd itself I see the following syslog warning
&gt;&gt;&gt; message:
&gt;&gt;&gt;
&gt;&gt;&gt; libvirtd: 5733: warning : netcfIfaceRegister:1287 : Failed to initialize
&gt;&gt;&gt; libnetcontrol.   Management of interface devices is disabled
&gt;&gt;
&gt;&gt; That's unrelated and unimportant. Most probably the libvirt APIs
&gt;&gt; affected by that have *never* operated properly on openSUSE (it uses a
&gt;&gt; "netcf-lookalike" that, AFAIU, accepts the same XML as netcf and has
&gt;&gt; some of the same functions, but was never really "complete", and is
&gt;&gt; probably just as much abandonware as netcf (which was abandoned, by
&gt;&gt; me, last year)), and it's likely that you never had the libnetcontrol
&gt;&gt; package installed at all, and have always had this warning but just
&gt;&gt; didn't notice it until now.
&gt; 
&gt; On SUSE this generally means NetworkManager is being used on the host
&gt; instead of wicked.

Yes, this host (laptop) uses NetworkManager.

&gt; If the host is using wicked, most of libvirt's
&gt; interface management APIs work, but with some limitations as you note.

Ah, good to know that there are differences. On my other host I'm using
wicked.

Ciao, Michael.


</body></email><email><emailId>20210920130226</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-09-20 13:02:26-0400</timestampReceived><subject>Re: security driver mismatch blocks live migration..</subject><body>

On 9/18/21 4:39 AM, Jiatong Shen wrote:
&gt; Hello community,
&gt; 
&gt; I am seeing following error during performing a live migration
&gt; 
&gt; libvirtError: unsupported configuration: Unable to find security driver for
&gt; model apparmor
&gt; 
&gt; The root cause is the destination libvirtd runs inside a container and
&gt; apparmor profile is not enabled. Right now I am researching how to enable
&gt; apparmor profile for a k8s pod.
&gt; 
&gt; But Is it possible to do a live migrate an instance and disable security
&gt; driver at the same time?

Yes. You can feed libvirt with a new XML at the beginning of migration.
This XML will be transferred to the destination and used to start QEMU -
hence users can use it to adapt to new environment.

Long story short, you should be able to dumpx XML of the guest, remove
apparmor profile and feed it to the migration.

virsh migrate --xml $modified.xml ...

Michal

</body></email><email><emailId>20210924123838</emailId><senderName>Sam Varshavchik</senderName><senderEmail>mrsam@courier-mta.com</senderEmail><timestampReceived>2021-09-24 12:38:38-0400</timestampReceived><subject>Re: How to move emulated SWTPM data to a new VM</subject><body>

This is a MIME-formatted message.  If you see this text it means that your
E-mail software does not support MIME-formatted messages.

Tomáš Golembiovský writes:

&gt; On Thu, Sep 23, 2021 at 08:32:46PM -0400, Sam Varshavchik wrote:
&gt; &gt; I have an existing VM with an emulated TPM module.
&gt; &gt;
&gt; &gt; I'm trying to create a replacement VM, pointing to the same disk image that
&gt; &gt; the existing VM uses, and also migrate the existing TPM module to it.
&gt; &gt;
&gt; &gt; Would just copying everything in /var/lib/libvirt/swtpm/&lt;UUID&gt; work? I did
&gt; &gt; some practice runs, and it seems that virt-manager immediately starts the
&gt; &gt; new VM as soon as it creates one, so I need to quickly turn it off, go look
&gt; &gt; up its new UUID, and copy over the TPM files?
&gt;
&gt; When creating the VM in virt-manager, in the last step you can select a
&gt; checkbox 'Modify configuration before install'. When you do that you
&gt; will see the configuration dialog for the VM and there on the Overview
&gt; tab you can also find the UUID. I haven't tried that but that way you
&gt; may be able to create the TMP directory in advance.
&gt;
&gt; Hope this helps,

Yes, I used "Modify configuration before install" in my trial run, I am  
aware of this setting.

Next time I'll see if that gives me the new VM's UUID, and I'll try making a  
copy of the existing swtpm subdirectory before the VM gets created and  
started.




[Attachment #3 (application/pgp-signature)]

</body></email><email><emailId>20210906063752</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-09-06 06:37:52-0400</timestampReceived><subject>Re: one qustion about the snapshot of the libvirt, thanks.</subject><body>

On Tue, Aug 31, 2021 at 16:09:50 +0800, Guozhonghua wrote:
&gt; 
&gt; Hello, 
&gt; 
&gt; When we test snapshot features and review the code of libvirt, there is one \
&gt; question, not an issue.  
&gt; /* do the memory snapshot if necessary */
&gt; if (memory) {
&gt; /* check if migration is possible */
&gt; if (!qemuMigrationSrcIsAllowed(driver, vm, false, 0))
&gt; goto cleanup;
&gt; 
&gt; While making one snapshot with memory on one vm, but it is not allowed while the vm \
&gt; which has some src devices, such as pci devs, with which the vm is not allowed to \
&gt; be migrated. I want to known the reason, why should  it check this conditions? 

The reason for this check is that the state of host devices namely PCI
devices can't be serialized by qemu and saved in the snapshot. That
means that when reverting the devices would not be configured properly
and would not work.

Internally qemu and libvirt use the migration code to serialize the
state of the VM and that is the reason why 'qemuMigrationSrcIsAllowed'
is called here, because it uses the same implementation.


</body></email><email><emailId>20210909123325</emailId><senderName>Å tÄ›pÃ¡n NÄ›mec</senderName><senderEmail>stepnem@gmail.com</senderEmail><timestampReceived>2021-09-09 12:33:25-0400</timestampReceived><subject>snapshot creation broken recently?</subject><body>


  Hello,

until very recently I had been happily creating snapshots of running VMs
(created using virt-install) simply with

  virsh --connect qemu:///system snapshot-create-as &lt;domain-name&gt; &lt;snapshot-name&gt;

Now when I try to do that I get the following error:

  Error creating snapshot: operation failed: Failed to take snapshot: pre-save failed: qxl

Same thing trying to create a snapshot from virt-manager (which also
used to work). Here's the full backtrace (as displayed in virt-manager):

Error: Error while writing VM state: Unknown error -1


Traceback (most recent call last):
  File "/usr/share/virt-manager/virtManager/asyncjob.py", line 65, in cb_wrapper
    callback(asyncjob, *args, **kwargs)
  File "/usr/share/virt-manager/virtManager/details/snapshots.py", line 237, in _do_create_snapshot
    self.vm.create_snapshot(xml)
  File "/usr/share/virt-manager/virtManager/object/domain.py", line 1124, in create_snapshot
    self._backend.snapshotCreateXML(xml, flags)
  File "/usr/lib/python3.9/site-packages/libvirt.py", line 3059, in snapshotCreateXML
    raise libvirtError('virDomainSnapshotCreateXML() failed')
libvirt.libvirtError: operation failed: Failed to take snapshot: pre-save failed: qxl
Error: Error while writing VM state: Unknown error -1

I am on Arch Linux (x86_64), using the distro packages. Checking my
pacman logs, might update of qemu-headless from 6.0.0 to 6.1.0 have
something to do with that?

(Since then, libvirt has also been updated from 7.6.0 to 7.7.0, but I
see no change WRT the problem described.)

I would appreciate any advice on how to further investigate and/or work
around the problem.

(I checked https://gitlab.com/libvirt/libvirt/-/issues and didn't find
anything that seemed related.)

  Thanks,

  Å tÄ›pÃ¡n


</body></email><email><emailId>20210910125323</emailId><senderName>Vojtech Juranek</senderName><senderEmail>vjuranek@redhat.com</senderEmail><timestampReceived>2021-09-10 12:53:23-0400</timestampReceived><subject>startupPolicy issue when changing CD</subject><body>


Hi,
when adding support for CD disk on block based storage into oVirt, 
I spotted following issue. When starting VM without CD, we add 
startupPolicy='optional' attribute into &lt;source&gt; element. 
Whole XML looks like this:

    &lt;disk type='file' device='cdrom'&gt;
      &lt;driver name='qemu' error_policy='report'/&gt;
      &lt;source startupPolicy='optional'/&gt;
      &lt;target dev='sdc' bus='sata'/&gt;
      &lt;readonly/&gt;
      &lt;alias name='ua-d7003457-63c3-4c98-80f0-08ab5042c65e'/&gt;
      &lt;address type='drive' controller='0' bus='0' target='0' unit='2'/&gt;
    &lt;/disk&gt;

To change/insert CD we use libvirt.updateDeviceFlags() with XML which 
looks like this (for block based disk):

&lt;?xml version='1.0' encoding='utf-8'?&gt;
&lt;disk device="cdrom" type="block"&gt;
    &lt;source dev="/rhev/data-center/mnt/blockSD/cdac2a0c-b110-456d-a988-7d588626c871/images/638247d7-b4b1-4d98-87fa-c90235fcf4b1/145e7cd2-f92d-4eec-a8fb-6835b4b652e1" \
/&gt;  &lt;target bus="sata" dev="sdc" /&gt;
&lt;/disk&gt;

However, updateDeviceFlags() fails with 

    libvirt.libvirtError: XML error: 'startupPolicy' is only valid for 'file' type \
volume

What is the reason for this error? We don't use `startupPolicy` attribute for block
based disks, as shown on example above.

Thanks in advance.
Vojta


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20210909182317</emailId><senderName>Kaushal Shriyan</senderName><senderEmail>kaushalshriyan@gmail.com</senderEmail><timestampReceived>2021-09-09 18:23:17-0400</timestampReceived><subject>virsh domifaddr domain does not show static IP</subject><body>

Hi,

I have assigned static IP for all the below KVM Guest VM's. Is there a way
to find out the IP of the below VM's from virsh utility or any
other utility? virsh domifaddr testdobssbahrainms does not show the static
IP.

# virsh list --all
 Id   Name                      State
-----------------------------------------
 1    testdobssbahrainms         running
 2    testdosstomcatpibms       running
 3    testdobsstomcatkineticms   running
 4    testdobsstomcatmsbms       running
 5    testdobsstomcatfdms        running
 6    testdobsstomcathsbcnetms   running
 7    testdobsstomcatdbbms       running
 8    testdobssapigeedev         running

#
# virt-install --version
2.2.1
# cat /etc/redhat-release
CentOS Stream release 8

#virsh domifaddr testdobssbahrainms
#Name       MAC address          Protocol     Address
-------------------------------------------------------------------------------

Please guide. Thanks in advance.

Best Regards,

Kaushal

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div&gt;Hi,&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I have  assigned static IP for \
all the below KVM Guest VM's. Is there  a way to find out the IP of the below \
VM's from virsh utility or any other  utility? virsh domifaddr testdobssbahrainms \
does not show the static IP.  &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;# virsh list --all&lt;br&gt;  Id    Name \
State&lt;br&gt;-----------------------------------------&lt;br&gt;  1      testdobssbahrainms     \
running&lt;br&gt;  2      testdosstomcatpibms          running&lt;br&gt;  3      \
testdobsstomcatkineticms    running&lt;br&gt;  4      testdobsstomcatmsbms          \
running&lt;br&gt;  5      testdobsstomcatfdms            running&lt;br&gt;  6      \
testdobsstomcathsbcnetms    running&lt;br&gt;  7      testdobsstomcatdbbms          \
running&lt;br&gt;  8      testdobssapigeedev             running&lt;br&gt;&lt;br&gt;#&lt;br&gt;&lt;div&gt;# \
virt-install --version&lt;br&gt;&lt;/div&gt;&lt;div&gt;2.2.1&lt;br&gt;# cat /etc/redhat-release&lt;br&gt;CentOS \
Stream release 8&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#virsh domifaddr \
testdobssbahrainms&lt;br&gt;#Name          MAC address               Protocol       \
Address&lt;br&gt;&lt;/div&gt;-------------------------------------------------------------------------------&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Please \
guide. Thanks  in advance.  &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Best \
Regards,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Kaushal&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;




</body></email><email><emailId>20210913013657</emailId><senderName>"Or Ozeri"</senderName><senderEmail>oro@il.ibm.com</senderEmail><timestampReceived>2021-09-13 01:36:57-0400</timestampReceived><subject>Compiling libvirt on ubuntu</subject><body>

Hi,


I'm trying to compile libvirt on ubuntu machine.
I installed meson 0.59.1 using pip.
Then installed a few more packages that were required by meson build:
sudo apt-get install libxml2-utils xsltproc libpciaccess-dev ninja-build



Finally, I followed the simple instructions over here: \
https://libvirt.org/compiling.html

xz -dc libvirt-7.7.0.tar.xz | tar xvf -
cd libvirt-7.7.0
meson build
ninja -C build

The last command fails with:

FAILED: src/libvirt-admin.so.0.7007.0
cc  -o src/libvirt-admin.so.0.7007.0 src/libvirt_probes.o \
src/libvirt-admin.so.0.7007.0.p/meson-generated_.._admin_admin_protocol.c.o \
src/libvirt-admin.so.0.7007.0.p/admin_libvirt-admin.c.o \
src/libvirt-admin.so.0.7007.0.p/datatypes.c.o -Wl,--as-needed -Wl,--no-undefined \
-shared -fPIC -Wl,--start-group -Wl,-soname,libvirt-admin.so.0 \
'-Wl,-rpath,$ORIGIN/:XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' \
-Wl,-rpath-link,/home/oro/ozeri/libvirt-7.7.0/build/src src/libvirt.so.0.7007.0 \
-Wl,--version-script=/home/oro/ozeri/libvirt-7.7.0/build/src/admin/libvirt_admin.syms \
-Wl,-z,nodelete /usr/lib/x86_64-linux-gnu/libcap-ng.so \
/usr/lib/gcc/x86_64-linux-gnu/9/../../../x86_64-linux-gnu/libdevmapper.so \
/usr/lib/x86_64-linux-gnu/libgnutls.so -Wl,-z,relro -Wl,-z,now \
-Wl,--no-copy-dt-needed-entries /usr/lib/x86_64-linux-gnu/libglib-2.0.so \
/usr/lib/x86_64-linux-gnu/libgobject-2.0.so /usr/lib/x86_64-linux-gnu/libgio-2.0.so \
/usr/lib/x86_64-linux-gnu/libxml2.so /usr/lib/x86_64-linux-gnu/libyajl.so \
                -Wl,--end-group
/usr/bin/ld: src/libvirt-admin.so.0.7007.0.p/admin_libvirt-admin.c.o: in function \
                `callFull':
/home/oro/ozeri/libvirt-7.7.0/build/../src/admin/admin_remote.c:99: undefined \
                reference to `virNetClientProgramCall'
/usr/bin/ld: src/libvirt-admin.so.0.7007.0.p/admin_libvirt-admin.c.o: in function \
                `remoteAdminConnectClose':
/home/oro/ozeri/libvirt-7.7.0/build/../src/admin/admin_remote.c:197: undefined \
                reference to `virNetClientSetCloseCallback'
/usr/bin/ld: /home/oro/ozeri/libvirt-7.7.0/build/../src/admin/admin_remote.c:199: \
                undefined reference to `virNetClientClose'
/usr/bin/ld: src/libvirt-admin.so.0.7007.0.p/admin_libvirt-admin.c.o: in function \
                `remoteAdminPrivNew':
/home/oro/ozeri/libvirt-7.7.0/build/../src/admin/admin_remote.c:225: undefined \
                reference to `virNetClientNewUNIX'
/usr/bin/ld: /home/oro/ozeri/libvirt-7.7.0/build/../src/admin/admin_remote.c:228: \
                undefined reference to `virNetClientProgramNew'
/usr/bin/ld: /home/oro/ozeri/libvirt-7.7.0/build/../src/admin/admin_remote.c:233: \
                undefined reference to `virNetClientAddProgram'
/usr/bin/ld: src/libvirt-admin.so.0.7007.0.p/admin_libvirt-admin.c.o: in function \
                `remoteAdminConnectOpen':
/home/oro/ozeri/libvirt-7.7.0/build/../src/admin/admin_remote.c:159: undefined \
                reference to `virNetClientRegisterAsyncIO'
/usr/bin/ld: /home/oro/ozeri/libvirt-7.7.0/build/../src/admin/admin_remote.c:166: \
                undefined reference to `virNetClientSetCloseCallback'
/usr/bin/ld: src/libvirt-admin.so.0.7007.0.p/admin_libvirt-admin.c.o: in function \
                `virAdmConnectIsAlive':
/home/oro/ozeri/libvirt-7.7.0/build/../src/admin/libvirt-admin.c:397: undefined \
                reference to `virNetClientIsOpen'
collect2: error: ld returned 1 exit status
[2/11] Linking target tests/virsystemdtest
FAILED: tests/virsystemdtest
cc  -o tests/virsystemdtest src/libvirt_probes.o \
tests/virsystemdtest.p/virsystemdtest.c.o -Wl,--as-needed -Wl,--no-undefined \
-Wl,-export-dynamic -pie -Wl,--whole-archive -Wl,--start-group tests/libtest_utils.a \
-Wl,--no-whole-archive '-Wl,-rpath,$ORIGIN/../src' \
-Wl,-rpath-link,/home/oro/ozeri/libvirt-7.7.0/build/src src/libvirt.so.0.7007.0 \
-Wl,--no-copy-dt-needed-entries -Wl,-export-dynamic -ldl \
/usr/lib/x86_64-linux-gnu/libglib-2.0.so /usr/lib/x86_64-linux-gnu/libgobject-2.0.so \
/usr/lib/x86_64-linux-gnu/libgio-2.0.so /usr/lib/x86_64-linux-gnu/libgnutls.so \
/lib/x86_64-linux-gnu/libnl-3.so /usr/lib/x86_64-linux-gnu/libnl-route-3.so \
/usr/lib/x86_64-linux-gnu/libxml2.so \
/usr/lib/gcc/x86_64-linux-gnu/9/../../../x86_64-linux-gnu/libselinux.so \
                /usr/lib/x86_64-linux-gnu/libyajl.so -Wl,--end-group \
                -Wl,-export-dynamic
/usr/bin/ld: tests/virsystemdtest.p/virsystemdtest.c.o: in function \
                `testActivationCreateFDs':
/home/oro/ozeri/libvirt-7.7.0/build/../tests/virsystemdtest.c:506: undefined \
                reference to `virNetSocketNewListenUNIX'
/usr/bin/ld: /home/oro/ozeri/libvirt-7.7.0/build/../tests/virsystemdtest.c:513: \
                undefined reference to `virNetSocketNewListenTCP'
/usr/bin/ld: tests/virsystemdtest.p/virsystemdtest.c.o: in function `testActivation':
/home/oro/ozeri/libvirt-7.7.0/build/../tests/virsystemdtest.c:548: undefined \
                reference to `virNetSocketGetPath'
/usr/bin/ld: /home/oro/ozeri/libvirt-7.7.0/build/../tests/virsystemdtest.c:570: \
                undefined reference to `virNetSocketGetPort'
collect2: error: ld returned 1 exit status
ninja: build stopped: subcommand failed.



I verified that these functions do exist inside libvirt.so.0.7007.0, but for some \
reason the linker fails. What am I doing wrong here?

Thanks,
Or


</body></email><email><emailId>20210917111129</emailId><senderName>Michael_Ströder</senderName><senderEmail>michael@stroeder.com</senderEmail><timestampReceived>2021-09-17 11:11:29-0400</timestampReceived><subject>internal error: Network is already in use by interface virbr0</subject><body>

HI!

I'm using libvirt 7.7.0 on openSUSE Tumbleweed.

Until recently everything just worked. But now my virtual NAT network is
not usable anymore.

Starting a VM I get this error:

# virsh start ae-dir-suse-p1
error: Failed to start domain 'ae-dir-suse-p1'
error: Requested operation is not valid: network 'vnet1' is not active

Manually starting the network does not work either:

# virsh net-start vnet1
error: Failed to start network vnet1
error: internal error: Network is already in use by interface virbr0

In syslog I find:

libvirtd: 6325: error : networkCheckRouteCollision:296 : internal error:
Network is already in use by interface virbr0

What does that mean? Where to look for a config error?

Ciao, Michael.

</body></email><email><emailId>20210918023957</emailId><senderName>Jiatong Shen</senderName><senderEmail>yshxxsjt715@gmail.com</senderEmail><timestampReceived>2021-09-18 02:39:57-0400</timestampReceived><subject>security driver mismatch blocks live migration..</subject><body>

Hello community,

I am seeing following error during performing a live migration

libvirtError: unsupported configuration: Unable to find security driver for
model apparmor

The root cause is the destination libvirtd runs inside a container and
apparmor profile is not enabled. Right now I am researching how to enable
apparmor profile for a k8s pod.

But Is it possible to do a live migrate an instance and disable security
driver at the same time?

Thank you.

-- 

Best Regards,

Jiatong Shen

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hello community,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I am seeing following error during \
performing a live migration&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;libvirtError: unsupported \
configuration: Unable to find security driver for model \
apparmor&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The root cause  is the destination libvirtd runs \
inside a container and apparmor profile is not enabled. Right now I am researching \
how to enable apparmor profile for a k8s pod.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;But Is it \
possible to do a live migrate an instance and disable security driver at the same \
time?  &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thank you.&lt;br clear="all"&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- &lt;br&gt;&lt;div \
dir="ltr" class="gmail_signature" data-smartmail="gmail_signature"&gt;&lt;div \
dir="ltr"&gt;&lt;br&gt;&lt;div&gt;Best Regards,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Jiatong \
Shen&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210917114635</emailId><senderName>Michael_Ströder</senderName><senderEmail>michael@stroeder.com</senderEmail><timestampReceived>2021-09-17 11:46:35-0400</timestampReceived><subject>Re: internal error: Network is already in use by interface virbr0</subject><body>

On 9/17/21 13:11, Michael Ströder wrote:
&gt; HI!
&gt; 
&gt; I'm using libvirt 7.7.0 on openSUSE Tumbleweed.
&gt; 
&gt; Until recently everything just worked. But now my virtual NAT network is
&gt; not usable anymore.
&gt; 
&gt; Starting a VM I get this error:
&gt; 
&gt; # virsh start ae-dir-suse-p1
&gt; error: Failed to start domain 'ae-dir-suse-p1'
&gt; error: Requested operation is not valid: network 'vnet1' is not active
&gt; 
&gt; Manually starting the network does not work either:
&gt; 
&gt; # virsh net-start vnet1
&gt; error: Failed to start network vnet1
&gt; error: internal error: Network is already in use by interface virbr0
&gt; 
&gt; In syslog I find:
&gt; 
&gt; libvirtd: 6325: error : networkCheckRouteCollision:296 : internal error:
&gt; Network is already in use by interface virbr0

When restarting libvirtd itself I see the following syslog warning message:

libvirtd: 5733: warning : netcfIfaceRegister:1287 : Failed to initialize
libnetcontrol.  Management of interface devices is disabled

Ciao, Michael.


</body></email><email><emailId>20210917164629</emailId><senderName>Laine Stump</senderName><senderEmail>laine@redhat.com</senderEmail><timestampReceived>2021-09-17 16:46:29-0400</timestampReceived><subject>Re: internal error: Network is already in use by interface virbr0</subject><body>

On 9/17/21 7:11 AM, Michael Ströder wrote:
&gt; HI!
&gt; 
&gt; I'm using libvirt 7.7.0 on openSUSE Tumbleweed.
&gt; 
&gt; Until recently everything just worked. But now my virtual NAT network is
&gt; not usable anymore.
&gt; 
&gt; Starting a VM I get this error:
&gt; 
&gt; # virsh start ae-dir-suse-p1
&gt; error: Failed to start domain 'ae-dir-suse-p1'
&gt; error: Requested operation is not valid: network 'vnet1' is not active
&gt; 
&gt; Manually starting the network does not work either:
&gt; 
&gt; # virsh net-start vnet1
&gt; error: Failed to start network vnet1
&gt; error: internal error: Network is already in use by interface virbr0
&gt; 
&gt; In syslog I find:
&gt; 
&gt; libvirtd: 6325: error : networkCheckRouteCollision:296 : internal error:
&gt; Network is already in use by interface virbr0
&gt; 
&gt; What does that mean? Where to look for a config error?


Someone else (probably libvirt itself, for libvirt's "default" network) 
has created a bridge device called virbr0, and has set it up on the same 
subnet that you are trying to use for your network, which is confusingly 
called "vnet1".

My first guess is would be that either:

1) you previously did not have the libvirt-daemon-config-network package 
(which adds the default network to the host and sets it to auto-start) 
and now it is installed, and being started before the "vnet1" network.

or

2) you *did* have libvirt-daemon-config-network (and thus the libvirt 
default network) installed, but for whatever reason your libvirtd was 
starting your "vnet1" network first, then failing to start the "default" 
network.

To fix this problem, change the subnet used by one or the other of the 
networks such that they don't conflict (e.g. if both have 
192.168.122.0/24, change one of them to 192.168.123.0/24) using "virsh 
net-edit $networkname", then virsh net-destroy and virsh net-start both 
networks.

Alternately, if you never use libvirt's default network, just 
net-destroy it and set it to not auto-start:

    virsh net-destroy default
    virsh net-autostart default --disable
    virsh net-start vnet1

Or, another alternate possibility - instead of using your own NAT 
network, just edit your guest config to use libvirt's default network 
and set net-autostart disable for your vnet1 network (if you have any 
extra config in that network, like static DHCP addresses, you'll want to 
move it into the default network, then net-destroy/net-start the default 
network so those changes take effect).

Once you've changed the config, it should persist through future reboots 
of your host.

&gt; 
&gt; When restarting libvirtd itself I see the following syslog warning message:
&gt; 
&gt; libvirtd: 5733: warning : netcfIfaceRegister:1287 : Failed to initialize
&gt; libnetcontrol.  Management of interface devices is disabled

That's unrelated and unimportant. Most probably the libvirt APIs 
affected by that have *never* operated properly on openSUSE (it uses a 
"netcf-lookalike" that, AFAIU, accepts the same XML as netcf and has 
some of the same functions, but was never really "complete", and is 
probably just as much abandonware as netcf (which was abandoned, by me, 
last year)), and it's likely that you never had the libnetcontrol 
package installed at all, and have always had this warning but just 
didn't notice it until now.

</body></email><email><emailId>20210917170403</emailId><senderName>Jim Fehlig</senderName><senderEmail>jfehlig@suse.com</senderEmail><timestampReceived>2021-09-17 17:04:03-0400</timestampReceived><subject>Re: internal error: Network is already in use by interface virbr0</subject><body>

On 9/17/21 10:46, Laine Stump wrote:

I was just about to send my reply when I noticed yours, which in typical Laine 
fashion is much more detailed and eloquent than mine :-).

&gt; On 9/17/21 7:11 AM, Michael Ströder wrote:
&gt;&gt; HI!
&gt;&gt;
&gt;&gt; I'm using libvirt 7.7.0 on openSUSE Tumbleweed.
&gt;&gt;
&gt;&gt; Until recently everything just worked. But now my virtual NAT network is
&gt;&gt; not usable anymore.
&gt;&gt;
&gt;&gt; Starting a VM I get this error:
&gt;&gt;
&gt;&gt; # virsh start ae-dir-suse-p1
&gt;&gt; error: Failed to start domain 'ae-dir-suse-p1'
&gt;&gt; error: Requested operation is not valid: network 'vnet1' is not active
&gt;&gt;
&gt;&gt; Manually starting the network does not work either:
&gt;&gt;
&gt;&gt; # virsh net-start vnet1
&gt;&gt; error: Failed to start network vnet1
&gt;&gt; error: internal error: Network is already in use by interface virbr0
&gt;&gt;
&gt;&gt; In syslog I find:
&gt;&gt;
&gt;&gt; libvirtd: 6325: error : networkCheckRouteCollision:296 : internal error:
&gt;&gt; Network is already in use by interface virbr0
&gt;&gt;
&gt;&gt; What does that mean? Where to look for a config error?
&gt; 
&gt; 
&gt; Someone else (probably libvirt itself, for libvirt's "default" network) has 
&gt; created a bridge device called virbr0, and has set it up on the same subnet that 
&gt; you are trying to use for your network, which is confusingly called "vnet1".
&gt; 
&gt; My first guess is would be that either:
&gt; 
&gt; 1) you previously did not have the libvirt-daemon-config-network package (which 
&gt; adds the default network to the host and sets it to auto-start) and now it is 
&gt; installed, and being started before the "vnet1" network.

Yes, I wonder about this scenario too. E.g. a recent Tumbleweed update installed 
libvirt-daemon-config-network. But only the main libvirt package has an explicit 
dependency on libvirt-daemon-config-network.

&gt; or
&gt; 
&gt; 2) you *did* have libvirt-daemon-config-network (and thus the libvirt default 
&gt; network) installed, but for whatever reason your libvirtd was starting your 
&gt; "vnet1" network first, then failing to start the "default" network.
&gt; 
&gt; To fix this problem, change the subnet used by one or the other of the networks 
&gt; such that they don't conflict (e.g. if both have 192.168.122.0/24, change one of 
&gt; them to 192.168.123.0/24) using "virsh net-edit $networkname", then virsh 
&gt; net-destroy and virsh net-start both networks.
&gt; 
&gt; Alternately, if you never use libvirt's default network, just net-destroy it and 
&gt; set it to not auto-start:
&gt; 
&gt;     virsh net-destroy default
&gt;     virsh net-autostart default --disable
&gt;     virsh net-start vnet1
&gt; 
&gt; Or, another alternate possibility - instead of using your own NAT network, just 
&gt; edit your guest config to use libvirt's default network and set net-autostart 
&gt; disable for your vnet1 network (if you have any extra config in that network, 
&gt; like static DHCP addresses, you'll want to move it into the default network, 
&gt; then net-destroy/net-start the default network so those changes take effect).
&gt; 
&gt; Once you've changed the config, it should persist through future reboots of your 
&gt; host.
&gt; 
&gt;&gt;
&gt;&gt; When restarting libvirtd itself I see the following syslog warning message:
&gt;&gt;
&gt;&gt; libvirtd: 5733: warning : netcfIfaceRegister:1287 : Failed to initialize
&gt;&gt; libnetcontrol.  Management of interface devices is disabled
&gt; 
&gt; That's unrelated and unimportant. Most probably the libvirt APIs affected by 
&gt; that have *never* operated properly on openSUSE (it uses a "netcf-lookalike" 
&gt; that, AFAIU, accepts the same XML as netcf and has some of the same functions, 
&gt; but was never really "complete", and is probably just as much abandonware as 
&gt; netcf (which was abandoned, by me, last year)), and it's likely that you never 
&gt; had the libnetcontrol package installed at all, and have always had this warning 
&gt; but just didn't notice it until now.

On SUSE this generally means NetworkManager is being used on the host instead of 
wicked. If the host is using wicked, most of libvirt's interface management APIs 
work, but with some limitations as you note.

Regards,
Jim


</body></email><email><emailId>20210917172217</emailId><senderName>Michael_Ströder</senderName><senderEmail>michael@stroeder.com</senderEmail><timestampReceived>2021-09-17 17:22:17-0400</timestampReceived><subject>Re: internal error: Network is already in use by interface virbr0</subject><body>

On 9/17/21 18:46, Laine Stump wrote:
&gt; On 9/17/21 7:11 AM, Michael Ströder wrote:
&gt;&gt; I'm using libvirt 7.7.0 on openSUSE Tumbleweed.
&gt;&gt;
&gt;&gt; Until recently everything just worked. But now my virtual NAT network is
&gt;&gt; not usable anymore.
&gt;&gt; [..]
&gt;&gt; # virsh net-start vnet1
&gt;&gt; error: Failed to start network vnet1
&gt;&gt; error: internal error: Network is already in use by interface virbr0
&gt; 
&gt; Someone else (probably libvirt itself, for libvirt's "default" network)
&gt; has created a bridge device called virbr0, and has set it up on the same
&gt; subnet that you are trying to use for your network, which is confusingly
&gt; called "vnet1".

Many thanks for pointing me into the right direction. The culprit was an
interface definition in NetworkManager's config. Not sure whether I had
added it myself months/years ago or not.

After removing it and rebooting(!) everything seems to work as expected.

Thanks again!

Ciao, Michael.


</body></email><email><emailId>20210913082738</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-09-13 08:27:38-0400</timestampReceived><subject>Re: Compiling libvirt on ubuntu</subject><body>

On Mon, Sep 13, 2021 at 01:36:57 +0000, Or Ozeri wrote:
&gt; Hi,
&gt; 
&gt; 
&gt; I'm trying to compile libvirt on ubuntu machine.
&gt; I installed meson 0.59.1 using pip.
&gt; Then installed a few more packages that were required by meson build:
&gt; sudo apt-get install libxml2-utils xsltproc libpciaccess-dev ninja-build
&gt; 
&gt; 
&gt; 
&gt; Finally, I followed the simple instructions over here: \
&gt; https://libvirt.org/compiling.html 
&gt; xz -dc libvirt-7.7.0.tar.xz | tar xvf -
&gt; cd libvirt-7.7.0
&gt; meson build
&gt; ninja -C build
&gt; 
&gt; The last command fails with:
&gt; 
&gt; FAILED: src/libvirt-admin.so.0.7007.0
&gt; cc  -o src/libvirt-admin.so.0.7007.0 src/libvirt_probes.o \
&gt; src/libvirt-admin.so.0.7007.0.p/meson-generated_.._admin_admin_protocol.c.o \
&gt; src/libvirt-admin.so.0.7007.0.p/admin_libvirt-admin.c.o \
&gt; src/libvirt-admin.so.0.7007.0.p/datatypes.c.o -Wl,--as-needed -Wl,--no-undefined \
&gt; -shared -fPIC -Wl,--start-group -Wl,-soname,libvirt-admin.so.0 \
&gt; '-Wl,-rpath,$ORIGIN/:XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' \
&gt; -Wl,-rpath-link,/home/oro/ozeri/libvirt-7.7.0/build/src src/libvirt.so.0.7007.0 \
&gt; -Wl,--version-script=/home/oro/ozeri/libvirt-7.7.0/build/src/admin/libvirt_admin.syms \
&gt; -Wl,-z,nodelete /usr/lib/x86_64-linux-gnu/libcap-ng.so \
&gt; /usr/lib/gcc/x86_64-linux-gnu/9/../../../x86_64-linux-gnu/libdevmapper.so \
&gt; /usr/lib/x86_64-linux-gnu/libgnutls.so -Wl,-z,relro -Wl,-z,now \
&gt; -Wl,--no-copy-dt-needed-entries /usr/lib/x86_64-linux-gnu/libglib-2.0.so \
&gt; /usr/lib/x86_64-linux-gnu/libgobject-2.0.so /usr/lib/x86_64-linux-gnu/libgio-2.0.so \
&gt; /usr/lib/x86_64-linux-gnu/libxml2.so /usr/lib/x86_64-linux-gnu/libyajl.so \
&gt; -Wl,--end-grou
 p
&gt; /usr/bin/ld: src/libvirt-admin.so.0.7007.0.p/admin_libvirt-admin.c.o: in function \
&gt;                 `callFull':
&gt; /home/oro/ozeri/libvirt-7.7.0/build/../src/admin/admin_remote.c:99: undefined \
&gt;                 reference to `virNetClientProgramCall'
&gt; /usr/bin/ld: src/libvirt-admin.so.0.7007.0.p/admin_libvirt-admin.c.o: in function \
&gt;                 `remoteAdminConnectClose':
&gt; /home/oro/ozeri/libvirt-7.7.0/build/../src/admin/admin_remote.c:197: undefined \
&gt; reference to `virNetClientSetCloseCallback'

You've seem to have run into the same issue that is reported as:

https://gitlab.com/libvirt/libvirt/-/issues/196

If I read the issue correctly the following should fix it for you:

meson build -Ddriver_remote=enabled


</body></email><email><emailId>20210924003246</emailId><senderName>Sam Varshavchik</senderName><senderEmail>mrsam@courier-mta.com</senderEmail><timestampReceived>2021-09-24 00:32:46-0400</timestampReceived><subject>How to move emulated SWTPM data to a new VM</subject><body>


I have an existing VM with an emulated TPM module.

I'm trying to create a replacement VM, pointing to the same disk image that  
the existing VM uses, and also migrate the existing TPM module to it.

Would just copying everything in /var/lib/libvirt/swtpm/&lt;UUID&gt; work? I did  
some practice runs, and it seems that virt-manager immediately starts the  
new VM as soon as it creates one, so I need to quickly turn it off, go look  
up its new UUID, and copy over the TPM files?

[Attachment #3 (application/pgp-signature)]

</body></email><email><emailId>20210924092206</emailId><senderName>Tomáš Golembiovský</senderName><senderEmail>tgolembi@redhat.com</senderEmail><timestampReceived>2021-09-24 09:22:06-0400</timestampReceived><subject>Re: How to move emulated SWTPM data to a new VM</subject><body>

On Thu, Sep 23, 2021 at 08:32:46PM -0400, Sam Varshavchik wrote:
&gt; I have an existing VM with an emulated TPM module.
&gt; 
&gt; I'm trying to create a replacement VM, pointing to the same disk image that
&gt; the existing VM uses, and also migrate the existing TPM module to it.
&gt; 
&gt; Would just copying everything in /var/lib/libvirt/swtpm/&lt;UUID&gt; work? I did
&gt; some practice runs, and it seems that virt-manager immediately starts the
&gt; new VM as soon as it creates one, so I need to quickly turn it off, go look
&gt; up its new UUID, and copy over the TPM files?

When creating the VM in virt-manager, in the last step you can select a
checkbox 'Modify configuration before install'. When you do that you
will see the configuration dialog for the VM and there on the Overview
tab you can also find the UUID. I haven't tried that but that way you
may be able to create the TMP directory in advance.

Hope this helps,

    Tomas

-- 
Tomáš Golembiovský &lt;tgolembi@redhat.com&gt;

</body></email><email><emailId>20210909183822</emailId><senderName>Laine Stump</senderName><senderEmail>laine@redhat.com</senderEmail><timestampReceived>2021-09-09 18:38:22-0400</timestampReceived><subject>Re: virsh domifaddr domain does not show static IP</subject><body>



On 9/9/21 2:11 PM, Kaushal Shriyan wrote:
&gt; Hi,
&gt; 
&gt; I have assigned static IP for all the below KVM Guest VM's. Is there a 
&gt; way to find out the IP of the below VM's from virsh utility or any 
&gt; other utility? virsh domifaddr testdobssbahrainms does not show the 
&gt; static IP.

By default, "virsh domifaddr" will attempt to lookup the MAC address of 
the guest interface in the table of IP addresses leased from the 
libvirt-managed dhcp server for the network the interface is connected 
to. If the interface has a statically configured IP, or if it isn't 
connected to a libvirt-managed virtual network, then no IP addresses 
will be found. You can change this behavior with the "--source" option:

    '--source arp'  - looks for the MAC address in the host's ARP table
    '--source agent' - queries the guest agent (which must have been
                       installed)

Each of these has varying levels of reliability and success, depending 
on your specific setup. e.g., if the guests don't have the guest agent 
installed, that method will fail, and if the guest can't be trusted, 
then any information it sends also can't be trusted. Alternately, it is 
possible for an external device on the network to poison the ARP table 
with bad information, and it's also possible that the guest simply has 
no entry in the ARP table (if the host has never attempted to 
communicate with it, or if it's connected via a host interface/bridge 
that itself has no IP address.)

Hmm, and I guess --source arp also wouldn't work for guests connected 
via macvtap (&lt;interface type='direct'&gt;) since guest&lt;-&gt;host communication 
isn't supported in that case (and so the guest could never show up in 
the host's ARP table).

Anyway if your guests are connected to a libvirt virtual network or to a 
Linux host bridge that has an IP address on the host, then "--source 
arp" should work for you.

&gt; 
&gt; # virsh list --all
&gt;   Id   Name                      State
&gt; -----------------------------------------
&gt;   1    testdobssbahrainms         running
&gt;   2    testdosstomcatpibms       running
&gt;   3    testdobsstomcatkineticms   running
&gt;   4    testdobsstomcatmsbms       running
&gt;   5    testdobsstomcatfdms        running
&gt;   6    testdobsstomcathsbcnetms   running
&gt;   7    testdobsstomcatdbbms       running
&gt;   8    testdobssapigeedev         running
&gt; 
&gt; #
&gt; # virt-install --version
&gt; 2.2.1
&gt; # cat /etc/redhat-release
&gt; CentOS Stream release 8
&gt; 
&gt; #virsh domifaddr testdobssbahrainms
&gt; #Name       MAC address          Protocol     Address
&gt; -------------------------------------------------------------------------------
&gt; 
&gt; Please guide. Thanks in advance.
&gt; 
&gt; Best Regards,
&gt; 
&gt; Kaushal
&gt; 
&gt; 

</body></email><email><emailId>20210910021910</emailId><senderName>Kaushal Shriyan</senderName><senderEmail>kaushalshriyan@gmail.com</senderEmail><timestampReceived>2021-09-10 02:19:10-0400</timestampReceived><subject>Re: virsh domifaddr domain does not show static IP</subject><body>

On Fri, Sep 10, 2021 at 12:08 AM Laine Stump &lt;laine@redhat.com&gt; wrote:

&gt;
&gt;
&gt; On 9/9/21 2:11 PM, Kaushal Shriyan wrote:
&gt; &gt; Hi,
&gt; &gt;
&gt; &gt; I have assigned static IP for all the below KVM Guest VM's. Is there a
&gt; &gt; way to find out the IP of the below VM's from virsh utility or any
&gt; &gt; other utility? virsh domifaddr testdobssbahrainms does not show the
&gt; &gt; static IP.
&gt;
&gt; By default, "virsh domifaddr" will attempt to lookup the MAC address of
&gt; the guest interface in the table of IP addresses leased from the
&gt; libvirt-managed dhcp server for the network the interface is connected
&gt; to. If the interface has a statically configured IP, or if it isn't
&gt; connected to a libvirt-managed virtual network, then no IP addresses
&gt; will be found. You can change this behavior with the "--source" option:
&gt;
&gt;     '--source arp'  - looks for the MAC address in the host's ARP table
&gt;     '--source agent' - queries the guest agent (which must have been
&gt;                        installed)
&gt;
&gt; Each of these has varying levels of reliability and success, depending
&gt; on your specific setup. e.g., if the guests don't have the guest agent
&gt; installed, that method will fail, and if the guest can't be trusted,
&gt; then any information it sends also can't be trusted. Alternately, it is
&gt; possible for an external device on the network to poison the ARP table
&gt; with bad information, and it's also possible that the guest simply has
&gt; no entry in the ARP table (if the host has never attempted to
&gt; communicate with it, or if it's connected via a host interface/bridge
&gt; that itself has no IP address.)
&gt;
&gt; Hmm, and I guess --source arp also wouldn't work for guests connected
&gt; via macvtap (&lt;interface type='direct'&gt;) since guest&lt;-&gt;host communication
&gt; isn't supported in that case (and so the guest could never show up in
&gt; the host's ARP table).
&gt;
&gt; Anyway if your guests are connected to a libvirt virtual network or to a
&gt; Linux host bridge that has an IP address on the host, then "--source
&gt; arp" should work for you.
&gt;
&gt; &gt;
&gt; &gt; # virsh list --all
&gt; &gt;   Id   Name                      State
&gt; &gt; -----------------------------------------
&gt; &gt;   1    testdobssbahrainms         running
&gt; &gt;   2    testdosstomcatpibms       running
&gt; &gt;   3    testdobsstomcatkineticms   running
&gt; &gt;   4    testdobsstomcatmsbms       running
&gt; &gt;   5    testdobsstomcatfdms        running
&gt; &gt;   6    testdobsstomcathsbcnetms   running
&gt; &gt;   7    testdobsstomcatdbbms       running
&gt; &gt;   8    testdobssapigeedev         running
&gt; &gt;
&gt; &gt; #
&gt; &gt; # virt-install --version
&gt; &gt; 2.2.1
&gt; &gt; # cat /etc/redhat-release
&gt; &gt; CentOS Stream release 8
&gt; &gt;
&gt; &gt; #virsh domifaddr testdobssbahrainms
&gt; &gt; #Name       MAC address          Protocol     Address
&gt; &gt;
&gt; -------------------------------------------------------------------------------
&gt; &gt;
&gt; &gt; Please guide. Thanks in advance.
&gt; &gt;
&gt; &gt; Best Regards,
&gt; &gt;
&gt; &gt; Kaushal
&gt; &gt;
&gt; &gt;


Thanks Laine for the detailed explanation. The below command worked. Thanks
a lot and appreciate it.

virsh domifaddr testdobssbahrainms --source agent

Name       MAC address          Protocol     Address
-------------------------------------------------------------------------------
 lo         00:00:00:00:00:00    ipv4         127.0.0.1/8
 eth0       52:14:00:74:11:14    ipv4         192.168.0.113/24

Is there a way to find out the Static IP address if the KVM Guest VM
instance is shut off? Thanks in advance.

Best Regards,

Kaushal

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" \
class="gmail_attr"&gt;On Fri, Sep 10, 2021 at 12:08 AM Laine Stump &lt;&lt;a \
href="mailto:laine@redhat.com"&gt;laine@redhat.com&lt;/a&gt;&gt; wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote \
class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid \
rgb(204,204,204);padding-left:1ex"&gt;&lt;br&gt; &lt;br&gt;
On 9/9/21 2:11 PM, Kaushal Shriyan wrote:&lt;br&gt;
&gt; Hi,&lt;br&gt;
&gt; &lt;br&gt;
&gt; I have  assigned static IP for all the below KVM Guest VM's. Is there  a \
&lt;br&gt; &gt; way to find out the IP of the below VM's from virsh utility or any &lt;br&gt;
&gt; other  utility? virsh domifaddr testdobssbahrainms does not show the &lt;br&gt;
&gt; static IP.&lt;br&gt;
&lt;br&gt;
By default, "virsh domifaddr" will attempt to lookup the MAC address of \
&lt;br&gt; the guest interface in the table of IP addresses leased from the &lt;br&gt;
libvirt-managed dhcp server for the network the interface is connected &lt;br&gt;
to. If the interface has a statically configured IP, or if it isn't &lt;br&gt;
connected to a libvirt-managed virtual network, then no IP addresses &lt;br&gt;
will be found. You can change this behavior with the "--source" option:&lt;br&gt;
&lt;br&gt;
      '--source arp'   - looks for the MAC address in the host's ARP \
                table&lt;br&gt;
      '--source agent' - queries the guest agent (which must have been&lt;br&gt;
                                   installed)&lt;br&gt;
&lt;br&gt;
Each of these has varying levels of reliability and success, depending &lt;br&gt;
on your specific setup. e.g., if the guests don't have the guest agent &lt;br&gt;
installed, that method will fail, and if the guest can't be trusted, &lt;br&gt;
then any information it sends also can't be trusted. Alternately, it is &lt;br&gt;
possible for an external device on the network to poison the ARP table &lt;br&gt;
with bad information, and it's also possible that the guest simply has &lt;br&gt;
no entry in the ARP table (if the host has never attempted to &lt;br&gt;
communicate with it, or if it's connected via a host interface/bridge &lt;br&gt;
that itself has no IP address.)&lt;br&gt;
&lt;br&gt;
Hmm, and I guess --source arp also wouldn't work for guests connected &lt;br&gt;
via macvtap (&lt;interface type='direct'&gt;) since guest&lt;-&gt;host \
communication &lt;br&gt; isn't supported in that case (and so the guest could never \
show up in &lt;br&gt; the host's ARP table).&lt;br&gt;
&lt;br&gt;
Anyway if your guests are connected to a libvirt virtual network or to a &lt;br&gt;
Linux host bridge that has an IP address on the host, then "--source &lt;br&gt;
arp" should work for you.&lt;br&gt;
&lt;br&gt;
&gt; &lt;br&gt;
&gt; # virsh list --all&lt;br&gt;
&gt;     Id    Name                                 State&lt;br&gt;
&gt; -----------------------------------------&lt;br&gt;
&gt;     1      testdobssbahrainms             running&lt;br&gt;
&gt;     2      testdosstomcatpibms          running&lt;br&gt;
&gt;     3      testdobsstomcatkineticms    running&lt;br&gt;
&gt;     4      testdobsstomcatmsbms          running&lt;br&gt;
&gt;     5      testdobsstomcatfdms            running&lt;br&gt;
&gt;     6      testdobsstomcathsbcnetms    running&lt;br&gt;
&gt;     7      testdobsstomcatdbbms          running&lt;br&gt;
&gt;     8      testdobssapigeedev             running&lt;br&gt;
&gt; &lt;br&gt;
&gt; #&lt;br&gt;
&gt; # virt-install --version&lt;br&gt;
&gt; 2.2.1&lt;br&gt;
&gt; # cat /etc/redhat-release&lt;br&gt;
&gt; CentOS Stream release 8&lt;br&gt;
&gt; &lt;br&gt;
&gt; #virsh domifaddr testdobssbahrainms&lt;br&gt;
&gt; #Name          MAC address               Protocol       Address&lt;br&gt;
&gt; -------------------------------------------------------------------------------&lt;br&gt;
 &gt; &lt;br&gt;
&gt; Please guide. Thanks  in advance.&lt;br&gt;
&gt; &lt;br&gt;
&gt; Best Regards,&lt;br&gt;
&gt; &lt;br&gt;
&gt; Kaushal&lt;br&gt;
&gt; &lt;br&gt;
&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks Laine for the detailed explanation. The \
below command worked. Thanks a lot and appreciate it.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;virsh \
domifaddr testdobssbahrainms  --source agent  &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Name          \
MAC address               Protocol       \
Address&lt;br&gt;-------------------------------------------------------------------------------&lt;br&gt; \
lo             00:00:00:00:00:00      ipv4             &lt;a \
href="http://127.0.0.1/8"&gt;127.0.0.1/8&lt;/a&gt;&lt;br&gt;  eth0          52:14:00:74:11:14      \
ipv4             &lt;a href="http://192.168.0.113/24"&gt;192.168.0.113/24&lt;/a&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is \
there a way to find out the Static IP address if the KVM Guest VM instance is shut \
off? Thanks in advance.  &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Best \
Regards,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Kaushal&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210910154711</emailId><senderName>Laine Stump</senderName><senderEmail>laine@redhat.com</senderEmail><timestampReceived>2021-09-10 15:47:11-0400</timestampReceived><subject>Re: virsh domifaddr domain does not show static IP</subject><body>

On 9/9/21 10:07 PM, Kaushal Shriyan wrote:
&gt; 
&gt; Thanks Laine for the detailed explanation. The below command worked. 
&gt; Thanks a lot and appreciate it.
&gt; 
&gt; virsh domifaddr testdobssbahrainms --source agent
&gt; 
&gt; Name       MAC address          Protocol     Address
&gt; -------------------------------------------------------------------------------
&gt;   lo         00:00:00:00:00:00    ipv4 127.0.0.1/8 &lt;http://127.0.0.1/8&gt;
&gt;   eth0       52:14:00:74:11:14    ipv4 192.168.0.113/24 
&gt; &lt;http://192.168.0.113/24&gt;
&gt; 
&gt; Is there a way to find out the Static IP address if the KVM Guest VM 
&gt; instance is shut off? Thanks in advance.

Maybe?

In the case of --source agent, the guest must be queried, and the guest 
is no longer running so it can't answer. In the other cases, libvirt is 
looking for the name of the tap device used by the guest interface, but 
the tap device no longer exists. So libvirt doesn't provide any method.

However, if the guest was recently running, there may still be an entry 
left in the arp cache, and you would be able to see it by grepping (on 
the host, of course) for the guest's MAC address, like this:

    arp -an | grep 52:14:00:74:11:14

That's not going to work if the guest has been down for longer than the 
timeout of the arp cache though (or if the guest hasn't communicated 
with the host in any manner for that amount of time).

</body></email><email><emailId>20210910131207</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-09-10 13:12:07-0400</timestampReceived><subject>Re: startupPolicy issue when changing CD</subject><body>

On Fri, Sep 10, 2021 at 14:53:23 +0200, Vojtech Juranek wrote:
&gt; Hi,
&gt; when adding support for CD disk on block based storage into oVirt, 
&gt; I spotted following issue. When starting VM without CD, we add 
&gt; startupPolicy='optional' attribute into &lt;source&gt; element. 
&gt; Whole XML looks like this:
&gt; 
&gt; &lt;disk type='file' device='cdrom'&gt;
&gt; &lt;driver name='qemu' error_policy='report'/&gt;
&gt; &lt;source startupPolicy='optional'/&gt;
&gt; &lt;target dev='sdc' bus='sata'/&gt;
&gt; &lt;readonly/&gt;
&gt; &lt;alias name='ua-d7003457-63c3-4c98-80f0-08ab5042c65e'/&gt;
&gt; &lt;address type='drive' controller='0' bus='0' target='0' unit='2'/&gt;
&gt; &lt;/disk&gt;
&gt; 
&gt; To change/insert CD we use libvirt.updateDeviceFlags() with XML which 
&gt; looks like this (for block based disk):
&gt; 
&gt; &lt;?xml version='1.0' encoding='utf-8'?&gt;
&gt; &lt;disk device="cdrom" type="block"&gt;
&gt; &lt;source dev="/rhev/data-center/mnt/blockSD/cdac2a0c-b110-456d-a988-7d588626c871/images/638247d7-b4b1-4d98-87fa-c90235fcf4b1/145e7cd2-f92d-4eec-a8fb-6835b4b652e1" \
&gt; /&gt; &lt;target bus="sata" dev="sdc" /&gt;
&gt; &lt;/disk&gt;
&gt; 
&gt; However, updateDeviceFlags() fails with 
&gt; 
&gt; libvirt.libvirtError: XML error: 'startupPolicy' is only valid for 'file' type \
&gt; volume 
&gt; What is the reason for this error? We don't use `startupPolicy` attribute for block
&gt; based disks, as shown on example above.

Hmm, the bug is that the disk source change is attempted before the
update to startup policy, thus the validator is unhappy.


</body></email><email><emailId>20210910133457</emailId><senderName>Vojtech Juranek</senderName><senderEmail>vjuranek@redhat.com</senderEmail><timestampReceived>2021-09-10 13:34:57-0400</timestampReceived><subject>Re: startupPolicy issue when changing CD</subject><body>


On Friday, 10 September 2021 15:12:07 CEST Peter Krempa wrote:
&gt; On Fri, Sep 10, 2021 at 14:53:23 +0200, Vojtech Juranek wrote:
&gt; &gt; Hi,
&gt; &gt; when adding support for CD disk on block based storage into oVirt,
&gt; &gt; I spotted following issue. When starting VM without CD, we add
&gt; &gt; startupPolicy='optional' attribute into &lt;source&gt; element.
&gt; &gt; 
&gt; &gt; Whole XML looks like this:
&gt; &gt;     &lt;disk type='file' device='cdrom'&gt;
&gt; &gt;     
&gt; &gt;       &lt;driver name='qemu' error_policy='report'/&gt;
&gt; &gt;       &lt;source startupPolicy='optional'/&gt;
&gt; &gt;       &lt;target dev='sdc' bus='sata'/&gt;
&gt; &gt;       &lt;readonly/&gt;
&gt; &gt;       &lt;alias name='ua-d7003457-63c3-4c98-80f0-08ab5042c65e'/&gt;
&gt; &gt;       &lt;address type='drive' controller='0' bus='0' target='0' unit='2'/&gt;
&gt; &gt;     
&gt; &gt;     &lt;/disk&gt;
&gt; &gt; 
&gt; &gt; To change/insert CD we use libvirt.updateDeviceFlags() with XML which
&gt; &gt; looks like this (for block based disk):
&gt; &gt; 
&gt; &gt; &lt;?xml version='1.0' encoding='utf-8'?&gt;
&gt; &gt; &lt;disk device="cdrom" type="block"&gt;
&gt; &gt; 
&gt; &gt;     &lt;source
&gt; &gt;     dev="/rhev/data-center/mnt/blockSD/cdac2a0c-b110-456d-a988-7d588626c8
&gt; &gt;     71/images/638247d7-b4b1-4d98-87fa-c90235fcf4b1/145e7cd2-f92d-4eec-a8fb
&gt; &gt;     -6835b4b652e1" /&gt; &lt;target bus="sata" dev="sdc" /&gt;
&gt; &gt; 
&gt; &gt; &lt;/disk&gt;
&gt; &gt; 
&gt; &gt; However, updateDeviceFlags() fails with
&gt; &gt; 
&gt; &gt;     libvirt.libvirtError: XML error: 'startupPolicy' is only valid for
&gt; &gt;     'file' type volume&gt; 
&gt; &gt; What is the reason for this error? We don't use `startupPolicy` attribute
&gt; &gt; for block based disks, as shown on example above.
&gt; 
&gt; Hmm, the bug is that the disk source change is attempted before the
&gt; update to startup policy, thus the validator is unhappy.

is this a libvirt bug or intentional behavior and the CD change should be done 
in two steps:
* remove startupPolicy from the disk
* do actual change of the disk
?

Thanks
Vojta

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20210909182804</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-09-09 18:28:04-0400</timestampReceived><subject>Re: snapshot creation broken recently?</subject><body>

On Thu, Sep 09, 2021 at 02:33:25PM +0200, Å tÄ›pÃ¡n NÄ›mec wrote:
&gt; 
&gt;   Hello,
&gt; 
&gt; until very recently I had been happily creating snapshots of running VMs
&gt; (created using virt-install) simply with
&gt; 
&gt;   virsh --connect qemu:///system snapshot-create-as &lt;domain-name&gt; &lt;snapshot-name&gt;
&gt; 
&gt; Now when I try to do that I get the following error:
&gt; 
&gt;   Error creating snapshot: operation failed: Failed to take snapshot: pre-save failed: qxl
&gt; 
&gt; Same thing trying to create a snapshot from virt-manager (which also
&gt; used to work). Here's the full backtrace (as displayed in virt-manager):
&gt; 
&gt; Error: Error while writing VM state: Unknown error -1
&gt; 
&gt; 
&gt; Traceback (most recent call last):
&gt;   File "/usr/share/virt-manager/virtManager/asyncjob.py", line 65, in cb_wrapper
&gt;     callback(asyncjob, *args, **kwargs)
&gt;   File "/usr/share/virt-manager/virtManager/details/snapshots.py", line 237, in _do_create_snapshot
&gt;     self.vm.create_snapshot(xml)
&gt;   File "/usr/share/virt-manager/virtManager/object/domain.py", line 1124, in create_snapshot
&gt;     self._backend.snapshotCreateXML(xml, flags)
&gt;   File "/usr/lib/python3.9/site-packages/libvirt.py", line 3059, in snapshotCreateXML
&gt;     raise libvirtError('virDomainSnapshotCreateXML() failed')
&gt; libvirt.libvirtError: operation failed: Failed to take snapshot: pre-save failed: qxl
&gt; Error: Error while writing VM state: Unknown error -1
&gt; 
&gt; I am on Arch Linux (x86_64), using the distro packages. Checking my
&gt; pacman logs, might update of qemu-headless from 6.0.0 to 6.1.0 have
&gt; something to do with that?

Yes, auite likely related to the QEMU update as

  "pre-save failed: qxl"

is an error message that libvirt is getting back from QEMU.

There was a change in this code in qemu in 6.1.0, but that was
replacing an assert() with this graceful error message. So if
anything your older QEMU ought to have been crashing !

Anyway, I think you need to report this to the QEMU community.


Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20210929060244</emailId><senderName>Erik Skultety</senderName><senderEmail>eskultet@redhat.com</senderEmail><timestampReceived>2021-09-29 06:02:44-0400</timestampReceived><subject>Re: Are secrets hidden from admins too - ?</subject><body>

On Tue, Aug 31, 2021 at 12:57:28PM +0100, lejeczek wrote:
...

&gt; &gt; &gt; Last one - would by any chance you/Redhat have a schedule for Libvirt with
&gt; &gt; &gt; SEV to go into RHELs/CentOS Stream?
&gt; &gt; TL;DR
&gt; &gt; 
&gt; &gt; It's been there for a while, we added SEV support in libvirt 6.5.0 and the
&gt; &gt; libvirt version in current RHEL-8 is 7.0.0. I don't remember (even if I could
&gt; &gt; I could not discuss it) the strategy, but CentOS Stream 8 will likely have
&gt; &gt; a libvirt version &gt;7.0.0.
&gt; Any chance you(with/via Redhat) could push in something more on pair with
&gt; what is in RHEL, as you explained?
&gt; At present CentOS Stream seems to have mere 6.0.0.x version.
&gt; 
&gt; many thanks, L.

Sorry, for such a late notice. Well, only the base Stream has libvirt 6.0.0.
Then there's the Advanced Virt "stream" which can be installed with:

centos-release-advanced-virtualization.noarch

The libvirt version available through this channel is 7.6.0

Regards,
Erik

</body></email><email><emailId>20210802182211</emailId><senderName>Vojtech Juranek</senderName><senderEmail>vjuranek@redhat.com</senderEmail><timestampReceived>2021-08-02 18:22:11-0400</timestampReceived><subject>Re: Disk extend during migration</subject><body>


&gt; &gt; so it took about 2 second to libvirt setBlockThreshold() call to return
&gt; &gt; and in meantime migration was finished and we get
&gt; &gt; VIR_ERR_OPERATION_INVALID error from setBlockThreshold() call.
&gt; &gt; 
&gt; &gt; What is the reason for this delay? Is this operation intentionally delayed
&gt; &gt; until migration finishes?
&gt; 
&gt; Actually, qemuDomainSetBlockThreshold which is the backend for
&gt; virDomainSetBlockThreshold requires a QEMU_JOB_MODIFY job on the domain,
&gt; so this actually can't even be set _during_ migration.
&gt; 
&gt; In fact what happens is that the API call is waiting to be able to
&gt; obtain the MODIFY job and that can happen only after the migration is
&gt; finished, thus it always serializes after the migration.

makes sense, thanks for clarification!
["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20210804151848</emailId><senderName>Laine Stump</senderName><senderEmail>laine@redhat.com</senderEmail><timestampReceived>2021-08-04 15:18:48-0400</timestampReceived><subject>Re: Sharing dhcp leases between multiple host systems</subject><body>



On 8/4/21 8:12 AM, Michael Ablassmeier wrote:
&gt; hi,
&gt; 
&gt; assume i have multiple host systems which spin up virtual machines using
&gt; the vagrant/vagrant-libvirt provider. Both host systems have a defined
&gt; network (which has the same name on both hosts) which the first network
&gt; interface of the virtual machine is assigned to.
&gt; 
&gt; During boot of the virtual machine, the first network device is
&gt; configured via DHCP and vagrant uses the mac address table or libvirt
&gt; dhcp leases table to find out about the IP address that was assigned to
&gt; the virtual machine: From that point on, i can reach the virtual machine
&gt; locally on the host system.
&gt; 
&gt; This works nicely if the network is a libvirt NAT network, as the IP
&gt; addresses are unique on both host systems.
&gt; 
&gt; Now i want to change the situation and provide routed addresses, thus i
&gt; want to make sure that an IP that is assigned for a virtual machine on
&gt; host A is not re-used on host B to not have IP address conflicts.

If you are using routed networking rather than NAT, then the routed 
network on each host will have to use a different subnet anyway[*], so 
there is no chance of any conflict in IP addresses.

[*] while you *could* use the same subnet for the routed virtual network 
on both hosts, each host would then only be able to reach the guests on 
its own virtual network, and 3rd parties would need to point their 
routing tables at one host or the other for that single subnet, and so 
would only be able to reach the guests on one of the hosts, but not the 
other.

&gt; 
&gt; What im searching for is the "libvirt" way to have a central lease file
&gt; between multiple hosts for the same network (without having another
&gt; layer like OVS/OVN).
&gt; 
&gt; What i guess would work is:
&gt; 
&gt;   1) share /var/lib/libvirt/dnsmasq between both host systems, of course
&gt;   means the virtual bridge for the network has to have the same
&gt;   name on both systems.
&gt; 
&gt;   2) replace /usr/libexec/libvirt_leaseshelper with my own version, that
&gt;   stores the leases in an central place.
&gt; 
&gt;   3) a way that exists and i dont know about?
&gt; 
&gt; Option 2) sounds the best for me, but i currently dont see a way to
&gt; specify the dhcp-script used for a network on libvirt side .. any
&gt; opinions on this?
&gt; 
&gt; Using libvirt 7.x and alike from the centos 8 advanced virtualization
&gt; stream.
&gt; 
&gt; thanks,
&gt;      - michael
&gt; 

</body></email><email><emailId>20210804153000</emailId><senderName>Jiatong Shen</senderName><senderEmail>yshxxsjt715@gmail.com</senderEmail><timestampReceived>2021-08-04 15:30:00-0400</timestampReceived><subject>Re: attach a pcie root port as hostdev</subject><body>

Thank you very much..

On Wed, Aug 4, 2021 at 10:39 PM Laine Stump &lt;laine@redhat.com&gt; wrote:

&gt;
&gt;
&gt; On 8/4/21 3:21 AM, Jiatong Shen wrote:
&gt; &gt; Hello community,
&gt; &gt;
&gt; &gt; I am working on plugging a xilinx fpga card as a hostdev.  This fpga
&gt; &gt; card has 2 functions, each has a different role, for some reason, I
&gt; &gt; would like to attach both of them but do not want to attach them
&gt; &gt; separately, so I have tried to attach a pci bridge where fpga cards
&gt; &gt; connect to. but got the following  error,
&gt; &gt;
&gt; &gt; error: Failed to attach device from bridge.xml
&gt; &gt;
&gt; error: internal error: Non-endpoint PCI devices cannot be assigned to guests
&gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; so, my question is is it possible to attach a pci-bridge as hostdev?
&gt; &gt; thank you.
&gt;
&gt; No, it isn't possible. VFIO only supports attaching endpoint devices.
&gt;
&gt; You will need to attach each of your endpoint devices separately. (If
&gt; the issue is that you want both devices to show up on the same root port
&gt; in the guest, that is easily accomplished by manually setting the
&gt; guest-side pci address of the devices to have the same same bus/slot,
&gt; but different function; this does mean that you can't hotplug, but will
&gt; deliver the desired topology. Note that although I've heard of people
&gt; who thought that they needed devices to be on the same slot, I've never
&gt; seen any evidence that this was actually required by any OS or driver)
&gt;
&gt;

-- 

Best Regards,

Jiatong Shen

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Thank you very much..&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div \
dir="ltr" class="gmail_attr"&gt;On Wed, Aug 4, 2021 at 10:39 PM Laine Stump &lt;&lt;a \
href="mailto:laine@redhat.com"&gt;laine@redhat.com&lt;/a&gt;&gt; wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote \
class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid \
rgb(204,204,204);padding-left:1ex"&gt;&lt;br&gt; &lt;br&gt;
On 8/4/21 3:21 AM, Jiatong Shen wrote:&lt;br&gt;
&gt; Hello community,&lt;br&gt;
&gt; &lt;br&gt;
&gt; I am working on plugging a xilinx fpga card as a hostdev.   This  fpga &lt;br&gt;
&gt; card has 2 functions, each has a different role, for some reason, I &lt;br&gt;
&gt; would like to attach both of them but do not  want to attach them &lt;br&gt;
&gt; separately, so I have tried to attach a pci bridge where fpga cards &lt;br&gt;
&gt; connect to. but got the following   error,&lt;br&gt;
&gt; &lt;br&gt;
&gt; error:  Failed  to  attach  device  from  bridge.xml&lt;br&gt;
&gt; error:  internal  error:  Non-endpoint  PCI  devices  cannot  be  assigned  to  \
guests &lt;br&gt; &gt; &lt;br&gt;
&gt; &lt;br&gt;
&gt; so, my question is is it possible to attach a pci-bridge as hostdev? &lt;br&gt;
&gt; thank you.&lt;br&gt;
&lt;br&gt;
No, it isn't possible. VFIO only supports attaching endpoint devices.&lt;br&gt;
&lt;br&gt;
You will need to attach each of your endpoint devices separately. (If &lt;br&gt;
the issue is that you want both devices to show up on the same root port &lt;br&gt;
in the guest, that is easily accomplished by manually setting the &lt;br&gt;
guest-side pci address of the devices to have the same same bus/slot, &lt;br&gt;
but different function; this does mean that you can't hotplug, but will &lt;br&gt;
deliver the desired topology. Note that although I've heard of people &lt;br&gt;
who thought that they needed devices to be on the same slot, I've never &lt;br&gt;
seen any evidence that this was actually required by any OS or driver)&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br clear="all"&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- &lt;br&gt;&lt;div dir="ltr" \
class="gmail_signature"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;div&gt;Best \
Regards,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Jiatong Shen&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210805093307</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-08-05 09:33:07-0400</timestampReceived><subject>Re: Usage of virsh commands on guest lxc container are failing</subject><body>

On 8/4/21 8:51 AM, Yuva Raj wrote:
&gt; Hi Team,
&gt; 
&gt; I am new to the Qemu/KVM, libvirt and these technologies.
&gt; Hypervisor is running on linux kernel with libvirtd version 1.3.2.
&gt; I am trying to spawn LXC ubuntu(21.04) container using virsh -c lxc://
&gt; commands on the hypervisor and ubuntu container is running now.
&gt; On the ubuntu 21.04 container, I have installed debian "libvirt-clients"
&gt; package to use the virsh utility.
&gt; 
&gt; Updated the /etc/libvirt/libvirt.conf with to the hypervisor Qemu URI.
&gt; When I run virsh commands without URI, observing below error
&gt; root@host:~# virsh list
&gt; error: failed to connect to the hypervisor
&gt; error: Failed to connect socket to '/var/run/libvirt/libvirt-sock': No such
&gt; file or directory

This means that you have no daemon running, which is not surprising
because IIUC you are running virsh from within the container and it's
not configured to share /var/run/libvirt with the host.

&gt; 
&gt; root@host:~# virsh -c &lt;Qemu URI&gt; list
&gt;  Id   Name      State
&gt; -------------------------
&gt; 2      VM        running
&gt; 
&gt; If I execute the virsh commands without "-c" option, then ubuntu 21.04
&gt; container would display the VM's running as same as hypervisor.
&gt; Could you please help to manage this on the LXC ubuntu container?

So the problem is that plain virsh without any -c argument doesn't
connect to LXC driver? By default, virsh uses UNIX sockets to connect to
daemon. This can be overridden and another transport layer can be used
(e.g. TCP), it's documented here:

  https://libvirt.org/uri.html

For UNIX sockets to work you will need to share the directory with UNIX
sockets between container and the host. Alternatively, you can try some
other transport.

Michal

</body></email><email><emailId>20210805154507</emailId><senderName>Kaushal Shriyan</senderName><senderEmail>kaushalshriyan@gmail.com</senderEmail><timestampReceived>2021-08-05 15:45:07-0400</timestampReceived><subject>Re: ERROR Couldn't find hvm kernel for Ubuntu tree.</subject><body>

Hi Michal,

$virsh console snipeitassetmanagemeubuntu
Connected to domain snipeitassetmanagementubuntu
Escape character is ^]

The screen is frozen. To connect it to the VM guest instance, I need
to configure the static private IP for this VM instance.

Please suggest.

Best Regards,

Kaushal

On Thu, Aug 5, 2021 at 2:56 PM Michal Prívozník &lt;mprivozn@redhat.com&gt; wrote:
&gt;
&gt; On 8/4/21 5:21 PM, Kaushal Shriyan wrote:
&gt; &gt; Hi,
&gt; &gt;
&gt; &gt; #cat /etc/redhat-release
&gt; &gt; CentOS Linux release 7.8.2003 (Core)
&gt; &gt; #virt-install --version
&gt; &gt; 1.5.0
&gt; &gt; #virt-install -n snipeitassetmanagementubuntu --ram 8096 --vcpus 2
&gt; &gt; --virt-type kvm --os-type linux --os-variant ubuntu18.04 --graphics none
&gt; &gt; --location '
&gt; &gt; http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/'
&gt; &gt; --extra-args "console=tty0 console=ttyS0,115200n8" --disk
&gt; &gt; path=/linuxkvmguestosdisk/snipeitassetmanagementubuntu.img,size=30
&gt; &gt;
&gt; &gt; I am unable to connect to the guest VM instance. Any clue and i look
&gt; &gt; forward to hearing from you. Thanks in advance.
&gt; &gt;
&gt;
&gt; Hey, what do you mean by 'connect'? Is it connecting to graphical
&gt; console (e.g. via virt-viewer) or it's serial console or connecting to
&gt; guest's ssh or something else?
&gt;
&gt; Michal
&gt;


</body></email><email><emailId>20210805160021</emailId><senderName>Ivan Teterevkov</senderName><senderEmail>ivan.teterevkov@nutanix.com</senderEmail><timestampReceived>2021-08-05 16:00:21-0400</timestampReceived><subject>RE: RX throttling causes keep-alive timeout</subject><body>

On Wed, Aug 04, 2021 at 17:56:31 +0100, Daniel P. Berrangé wrote:
&gt; There is no way to parse the keepalives, without also pulling all
&gt; the preceeding data off the socket, which defeats the purpose of
&gt; having the limit.

Thanks for the comments, Daniel.

Likewise, I see no easy way to make keep-alive handled regardless
of the request limits, given that the throttling is being applied
on the socket level.

&gt; IMHO this is a tuning problem for your application. If you are expecting
&gt; to have 5 long running operations happening concurrently in normal usage,
&gt; then you should have increased the max_client_requests parameter to a
&gt; value greater than 5 to give yourself more headroom.

While it's down to the application tuning, shall we consider informing
about throttling in the server logs since it's quite an abnormal situation?
I'm thinking about sending this or similar patch to libvir-list:

diff --git a/src/rpc/virnetserverclient.c b/src/rpc/virnetserverclient.c
index 236702ced6..2bed81a82f 100644
--- a/src/rpc/virnetserverclient.c
+++ b/src/rpc/virnetserverclient.c
@@ -1296,6 +1296,8 @@ static virNetMessage *virNetServerClientDispatchRead(virNetServerClient *client)
                 client-&gt;rx-&gt;buffer = g_new0(char, client-&gt;rx-&gt;bufferLength);
                 client-&gt;nrequests++;
             }
+        } else {
+            VIR_WARN("RPC throttling, check max_client_requests");
         }
         virNetServerClientUpdateEvent(client);

Seeing a warning can indicate the misconfiguration and potentially predict
latency-related issues, e.g. keep-alive timeouts in this case.

&gt; The right limit is hard to suggest without knowing more about your mgmt
&gt; application. As an example though, if your application can potentially
&gt; have 2 API calls pending per running VM and your host capacity allows
&gt; for 100 VMs, then you might plan for your max_client_requests value
&gt; to be 200. Having a big value for max_client_requests is not inherantly
&gt; a bad thing - we just want to prevent unbounded growth when things go
&gt; wrong.

Thanks for the example. The management application where I'm observing
the issue is quite conservative and applies the throttling on its own at
the request level on the client-side not to overwhelm the libvirtd daemon.
I'm currently planning to get away with doubling the default limit and am
willing to set the guardrails, e.g. the above warnings, so we could revisit
the configuration should this issue occur again.

Thanks,
Ivan

</body></email><email><emailId>20210811110925</emailId><senderName>Nicholas Hardiman</senderName><senderEmail>nhardima@redhat.com</senderEmail><timestampReceived>2021-08-11 11:09:25-0400</timestampReceived><subject>Re: vmware ESXi in KVM</subject><body>

I made a couple machines like this last year. Why on earth did I add
"os-variantþdora10"? Can't remember.

I had issues mixing libvirt and VMware. I ran into some odd SSL errors, and
the machines couldn't see each other. I didn't get to the bottom of those
problems.

HOST=esxi7-1
OS_DISK=/var/lib/libvirt/images/$HOST.qcow2
DATASTORE_DISK=/var/lib/libvirt/images/$HOST-datastore.qcow2
INSTALL_ISO=/var/lib/libvirt/images/VMware-VMvisor-Installer-7.0U2-17630552.x86_64.iso
IF1_MACR:54:00:00:00:10
IF2_MACR:54:00:00:00:11

HOST=esxi7-2
OS_DISK=/var/lib/libvirt/images/$HOST.qcow2
DATASTORE_DISK=/var/lib/libvirt/images/$HOST-datastore.qcow2
INSTALL_ISO=/var/lib/libvirt/images/VMware-VMvisor-Installer-7.0U2-17630552.x86_64.iso
IF1_MACR:54:00:00:00:12
IF2_MACR:54:00:00:00:13

virt-install \
  --name="$HOST" \
  --vcpus=8 \
  --ram 480 \
  --cpu host-passthrough  \
  --disk path=$OS_DISK,size ,bus=sata \
  --disk path=$DATASTORE_DISK,size 0,bus=sata \
  --os-type linux \
  --os-variantþdora10 \
  --network network=pubbr0,mac=$IF1_MAC,modelá000e   \
  --network network=privbr0,mac=$IF2_MAC,modelá000e   \
  --boot uefi,menu=on,cdrom,hd \
  --graphics vnc \
  --video qxl \
  --cdrom $INSTALL_ISO \
  --noautoconsole \
  --features kvm_hidden=on \
  --machine q35


On Wed, Aug 11, 2021 at 9:58 AM Martin Kletzander &lt;mkletzan@redhat.com&gt;
wrote:

&gt; On Tue, Aug 10, 2021 at 09:45:37PM +0200, Gunnar wrote:
&gt; &gt;I am trying to install esxi7 inside a KVM machine
&gt; &gt;
&gt; &gt;    virt-install --name=esxi7 \
&gt; &gt;    --vcpus=2 \
&gt; &gt;    --memory@96 \
&gt; &gt;
&gt; --cdrom=/home/username/isos/VMware-VMvisor-Installer-7.0U2a-17867351.x86_64.iso
&gt; &gt;    \
&gt; &gt;    --disk size3 \
&gt; &gt;    --os-variant=unknown
&gt; &gt;
&gt; &gt;the installation process starts but does not get fails with a "No
&gt; &gt;network adapters" error. This does not happen with other VM's.
&gt; &gt;What do I have to add to above command in order to attach the default
&gt; &gt;network adapter to the machine?
&gt; &gt;
&gt;
&gt; First look if the machine has any network interface.  If it does, the
&gt; guest OS probably does not support the model, so you can change that.
&gt; If it does not have one, then you probably want to use '--network
&gt; networkÞfault' in your virt-install command and you can always look
&gt; that up in the man page as well (e.g. man virt-install).
&gt;
&gt; &gt;or is there any other trick I have to be aware of when it comes to
&gt; &gt;installing ESXi
&gt; &gt;
&gt;
&gt; No idea as I have never installed anything like that.
&gt;
&gt; &gt;thx ... Gunnar
&gt;
&gt; Hope that helped,
&gt; Martin
&gt;

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div dir="ltr"&gt;I made a couple machines like this last year. Why on \
earth did I add "os-variant=fedora10"? Can't remember.  &lt;br&gt;&lt;br&gt;I had \
issues mixing libvirt and VMware. I ran into some odd  SSL errors,  and the machines \
couldn't see each other. I didn't get to the bottom of those problems.  \
&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;HOST=esxi7-1&lt;br&gt;OS_DISK=/var/lib/libvirt/images/$HOST.qcow2&lt;br \
&gt;DATASTORE_DISK=/var/lib/libvirt/images/$HOST-datastore.qcow2&lt;br&gt;INSTALL_ISO=/var/lib/ \
&gt; libvirt/images/VMware-VMvisor-Installer-7.0U2-17630552.x86_64.iso&lt;br&gt;IF1_MAC=52:54:0 \
&gt; 0:00:00:10&lt;br&gt;IF2_MAC=52:54:00:00:00:11&lt;br&gt;&lt;br&gt;HOST=esxi7-2&lt;br&gt;OS_DISK=/var/lib/libv \
&gt; irt/images/$HOST.qcow2&lt;br&gt;DATASTORE_DISK=/var/lib/libvirt/images/$HOST-datastore.qco \
&gt; w2&lt;br&gt;INSTALL_ISO=/var/lib/libvirt/images/VMware-VMvisor-Installer-7.0U2-17630552.x8 \
&gt; 6_64.iso&lt;br&gt;IF1_MAC=52:54:00:00:00:12&lt;br&gt;IF2_MAC=52:54:00:00:00:13&lt;br&gt;&lt;br&gt;virt-install \
&gt; \&lt;br&gt;   --name="$HOST" \&lt;br&gt;   --vcpus=8 \&lt;br&gt;   --ram=20480 \&lt;br&gt;   \
&gt; --cpu host-passthrough   \&lt;br&gt;   --disk path=$OS_DISK,size=20,bus=sata \&lt;br&gt;   \
&gt; --disk path=$DATASTORE_DISK,size=200,bus=sata \&lt;br&gt;   --os-type linux \&lt;br&gt;   \
&gt; --os-variant=fedora10 \&lt;br&gt;   --network network=pubbr0,mac=$IF1_MAC,model=e1000e    \
&gt; \&lt;br&gt;   --network network=privbr0,mac=$IF2_MAC,model=e1000e    \&lt;br&gt;   --boot \
&gt; uefi,menu=on,cdrom,hd \&lt;br&gt;   --graphics vnc \&lt;br&gt;   --video qxl \&lt;br&gt;   --cdrom \
&gt; $INSTALL_ISO \&lt;br&gt;   --noautoconsole \&lt;br&gt;   --features kvm_hidden=on \&lt;br&gt;   \
&gt; --machine q35&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" \
&gt; class="gmail_attr"&gt;On Wed, Aug 11, 2021 at 9:58 AM Martin Kletzander &lt;&lt;a \
&gt; href="mailto:mkletzan@redhat.com"&gt;mkletzan@redhat.com&lt;/a&gt;&gt; \
&gt; wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
&gt; 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;On Tue, Aug 10, 2021 \
&gt; at 09:45:37PM +0200, Gunnar wrote:&lt;br&gt;
&gt;I am trying to install esxi7 inside a KVM machine&lt;br&gt;
&gt;&lt;br&gt;
&gt;      virt-install --name=esxi7 \&lt;br&gt;
&gt;      --vcpus=2 \&lt;br&gt;
&gt;      --memory=4096 \&lt;br&gt;
&gt;      --cdrom=/home/username/isos/VMware-VMvisor-Installer-7.0U2a-17867351.x86_64.iso&lt;br&gt;
 &gt;      \&lt;br&gt;
&gt;      --disk size=33 \&lt;br&gt;
&gt;      --os-variant=unknown&lt;br&gt;
&gt;&lt;br&gt;
&gt;the installation process starts but does not get fails with a "No&lt;br&gt;
&gt;network adapters" error. This does not happen with other VM's.&lt;br&gt;
&gt;What do I have to add to above command in order to attach the default&lt;br&gt;
&gt;network adapter to the machine?&lt;br&gt;
&gt;&lt;br&gt;
&lt;br&gt;
First look if the machine has any network interface.   If it does, the&lt;br&gt;
guest OS probably does not support the model, so you can change that.&lt;br&gt;
If it does not have one, then you probably want to use '--network&lt;br&gt;
network=default' in your virt-install command and you can always look&lt;br&gt;
that up in the man page as well (e.g. man virt-install).&lt;br&gt;
&lt;br&gt;
&gt;or is there any other trick I have to be aware of when it comes to&lt;br&gt;
&gt;installing ESXi&lt;br&gt;
&gt;&lt;br&gt;
&lt;br&gt;
No idea as I have never installed anything like that.&lt;br&gt;
&lt;br&gt;
&gt;thx ... Gunnar&lt;br&gt;
&lt;br&gt;
Hope that helped,&lt;br&gt;
Martin&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br clear="all"&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="ltr" \
class="gmail_signature"&gt;&lt;div dir="ltr"&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210804121209</emailId><senderName>Michael Ablassmeier</senderName><senderEmail>abi@grinser.de</senderEmail><timestampReceived>2021-08-04 12:12:09-0400</timestampReceived><subject>Sharing dhcp leases between multiple host systems</subject><body>

hi,

assume i have multiple host systems which spin up virtual machines using
the vagrant/vagrant-libvirt provider. Both host systems have a defined
network (which has the same name on both hosts) which the first network
interface of the virtual machine is assigned to.

During boot of the virtual machine, the first network device is
configured via DHCP and vagrant uses the mac address table or libvirt
dhcp leases table to find out about the IP address that was assigned to
the virtual machine: From that point on, i can reach the virtual machine
locally on the host system.

This works nicely if the network is a libvirt NAT network, as the IP
addresses are unique on both host systems.

Now i want to change the situation and provide routed addresses, thus i
want to make sure that an IP that is assigned for a virtual machine on
host A is not re-used on host B to not have IP address conflicts.

What im searching for is the "libvirt" way to have a central lease file
between multiple hosts for the same network (without having another
layer like OVS/OVN).

What i guess would work is:

 1) share /var/lib/libvirt/dnsmasq between both host systems, of course
 means the virtual bridge for the network has to have the same
 name on both systems.

 2) replace /usr/libexec/libvirt_leaseshelper with my own version, that
 stores the leases in an central place.

 3) a way that exists and i dont know about?

Option 2) sounds the best for me, but i currently dont see a way to
specify the dhcp-script used for a network on libvirt side .. any
opinions on this?

Using libvirt 7.x and alike from the centos 8 advanced virtualization
stream.

thanks,
    - michael

</body></email><email><emailId>20210804072132</emailId><senderName>Jiatong Shen</senderName><senderEmail>yshxxsjt715@gmail.com</senderEmail><timestampReceived>2021-08-04 07:21:32-0400</timestampReceived><subject>attach a pcie root port as hostdev</subject><body>

Hello community,

I am working on plugging a xilinx fpga card as a hostdev.  This fpga card
has 2 functions, each has a different role, for some reason, I would like
to attach both of them but do not want to attach them separately, so I have
tried to attach a pci bridge where fpga cards connect to. but got the
following  error,

error: Failed to attach device from bridge.xml
error: internal error: Non-endpoint PCI devices cannot be assigned to guests

so, my question is is it possible to attach a pci-bridge as hostdev? thank
you.

-- 

Best Regards,

Jiatong Shen

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hello community,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I am working on plugging a xilinx \
fpga card as a hostdev.   This  fpga card has 2 functions, each has a different role, \
for some reason, I would like to attach both of them but do not  want to attach them \
separately, so I have tried to attach a pci bridge where fpga cards connect to. but \
got the following   error,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;error:  Failed  to  attach  \
device  from  bridge.xml&lt;br&gt;error:  internal  error:  Non-endpoint  PCI  devices  \
cannot  be  assigned  to  guests    &lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;so, my question is \
is it possible to attach a pci-bridge as hostdev? thank \
you.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-- &lt;br&gt;&lt;div dir="ltr" class="gmail_signature" \
data-smartmail="gmail_signature"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;div&gt;Best \
Regards,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Jiatong Shen&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210804070359</emailId><senderName>Yuva Raj</senderName><senderEmail>yuvaraj301294@gmail.com</senderEmail><timestampReceived>2021-08-04 07:03:59-0400</timestampReceived><subject>Usage of virsh commands on guest lxc container are failing</subject><body>

Hi Team,

I am new to the Qemu/KVM, libvirt and these technologies.
Hypervisor is running on linux kernel with libvirtd version 1.3.2.
I am trying to spawn LXC ubuntu(21.04) container using virsh -c lxc://
commands on the hypervisor and ubuntu container is running now.
On the ubuntu 21.04 container, I have installed debian "libvirt-clients"
package to use the virsh utility.

Updated the /etc/libvirt/libvirt.conf with to the hypervisor Qemu URI.
When I run virsh commands without URI, observing below error
root@host:~# virsh list
error: failed to connect to the hypervisor
error: Failed to connect socket to '/var/run/libvirt/libvirt-sock': No such
file or directory

root@host:~# virsh -c &lt;Qemu URI&gt; list
 Id   Name      State
-------------------------
2      VM        running

If I execute the virsh commands without "-c" option, then ubuntu 21.04
container would display the VM's running as same as hypervisor.
Could you please help to manage this on the LXC ubuntu container?

LIBVIRT xml used to spawn LXC ubuntu 21.04 container:
&lt;domain type='lxc'&gt;
  &lt;name&gt;host&lt;/name&gt;
  &lt;uuid&gt;096f46bf-80bb-4441-a512-043a9c7a64d4&lt;/uuid&gt;
  &lt;memory unit='KiB'&gt;1048576&lt;/memory&gt;
  &lt;currentMemory unit='KiB'&gt;1048576&lt;/currentMemory&gt;
  &lt;vcpu placement='static' cpuset='7'&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='x86_64'&gt;exe&lt;/type&gt;
    &lt;init&gt;/sbin/init&lt;/init&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;capabilities policy='allow'&gt;
      &lt;audit_control state='on'/&gt;
      &lt;audit_write state='on'/&gt;
      &lt;block_suspend state='on'/&gt;
      &lt;chown state='on'/&gt;
      &lt;ipc_lock state='on'/&gt;
      &lt;ipc_owner state='on'/&gt;
      &lt;kill state='on'/&gt;
      &lt;mac_admin state='on'/&gt;
      &lt;mac_override state='on'/&gt;
      &lt;mknod state='on'/&gt;
      &lt;net_admin state='on'/&gt;
      &lt;net_bind_service state='on'/&gt;
      &lt;net_broadcast state='on'/&gt;
      &lt;net_raw state='on'/&gt;
      &lt;sys_admin state='on'/&gt;
      &lt;sys_boot state='on'/&gt;
      &lt;sys_ptrace state='on'/&gt;
      &lt;sys_rawio state='on'/&gt;
      &lt;sys_resource state='on'/&gt;
      &lt;sys_time state='on'/&gt;
      &lt;syslog state='on'/&gt;
    &lt;/capabilities&gt;
  &lt;/features&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;destroy&lt;/on_reboot&gt;
  &lt;on_crash&gt;destroy&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/lib64/libvirt/libvirt_lxc&lt;/emulator&gt;
    &lt;filesystem type='mount' accessmode='passthrough'&gt;
      &lt;source dir='/junos/lxc/jdm/jdm1/rootfs'/&gt;
      &lt;target dir='/'/&gt;
    &lt;/filesystem&gt;
  &lt;/devices&gt;
&lt;/domain&gt;

Thanks,
Yuvaraj.

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hi Team,&lt;br&gt;&lt;br&gt;I am new to the Qemu/KVM, libvirt and these \
technologies.&lt;div&gt;Hypervisor is running on linux kernel with libvirtd version \
1.3.2.&lt;/div&gt;&lt;div&gt;I am trying to spawn LXC ubuntu(21.04) container using virsh -c \
lxc:// commands on the hypervisor and ubuntu container is running now.  &lt;/div&gt;&lt;div&gt;On \
the ubuntu 21.04 container, I have installed debian "libvirt-clients" \
package to use the virsh utility.&lt;br&gt;&lt;br&gt;Updated the /etc/libvirt/libvirt.conf with \
to the hypervisor Qemu URI.&lt;br&gt;When I run virsh commands without URI, observing  \
below error&lt;br&gt;root@host:~# virsh list&lt;br&gt;error: failed to connect to the \
hypervisor&lt;br&gt;error: Failed to connect socket to \
'/var/run/libvirt/libvirt-sock': No such file or \
directory&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;root@host:~# virsh -c &lt;Qemu URI&gt; \
list&lt;br&gt;  Id    Name         State&lt;br&gt;-------------------------&lt;br&gt;2         VM       \
running&lt;br&gt;&lt;br&gt;If I execute the virsh commands without "-c" option, then \
ubuntu 21.04 container would  display the VM's running as same as \
hypervisor.&lt;br&gt;Could you please help to manage this on the LXC ubuntu \
container?&lt;br&gt;&lt;br&gt;LIBVIRT xml used to spawn LXC ubuntu 21.04 container:&lt;br&gt;&lt;domain \
type='lxc'&gt;&lt;br&gt;   &lt;name&gt;host&lt;/name&gt;&lt;br&gt;   \
&lt;uuid&gt;096f46bf-80bb-4441-a512-043a9c7a64d4&lt;/uuid&gt;&lt;br&gt;   &lt;memory \
unit='KiB'&gt;1048576&lt;/memory&gt;&lt;br&gt;   &lt;currentMemory \
unit='KiB'&gt;1048576&lt;/currentMemory&gt;&lt;br&gt;   &lt;vcpu \
placement='static' cpuset='7'&gt;1&lt;/vcpu&gt;&lt;br&gt;   &lt;os&gt;&lt;br&gt;  \
&lt;type arch='x86_64'&gt;exe&lt;/type&gt;&lt;br&gt;      \
&lt;init&gt;/sbin/init&lt;/init&gt;&lt;br&gt;   &lt;/os&gt;&lt;br&gt;   &lt;features&gt;&lt;br&gt;      \
&lt;capabilities policy='allow'&gt;&lt;br&gt;         &lt;audit_control \
state='on'/&gt;&lt;br&gt;         &lt;audit_write state='on'/&gt;&lt;br&gt;       \
&lt;block_suspend state='on'/&gt;&lt;br&gt;         &lt;chown \
state='on'/&gt;&lt;br&gt;         &lt;ipc_lock state='on'/&gt;&lt;br&gt;         \
&lt;ipc_owner state='on'/&gt;&lt;br&gt;         &lt;kill \
state='on'/&gt;&lt;br&gt;         &lt;mac_admin state='on'/&gt;&lt;br&gt;         \
&lt;mac_override state='on'/&gt;&lt;br&gt;         &lt;mknod \
state='on'/&gt;&lt;br&gt;         &lt;net_admin state='on'/&gt;&lt;br&gt;         \
&lt;net_bind_service state='on'/&gt;&lt;br&gt;         &lt;net_broadcast \
state='on'/&gt;&lt;br&gt;         &lt;net_raw state='on'/&gt;&lt;br&gt;         \
&lt;sys_admin state='on'/&gt;&lt;br&gt;         &lt;sys_boot \
state='on'/&gt;&lt;br&gt;         &lt;sys_ptrace state='on'/&gt;&lt;br&gt;&lt;div&gt;   \
&lt;sys_rawio state='on'/&gt;&lt;br&gt;         &lt;sys_resource \
state='on'/&gt;&lt;br&gt;         &lt;sys_time state='on'/&gt;&lt;br&gt;         \
&lt;syslog state='on'/&gt;&lt;br&gt;      &lt;/capabilities&gt;&lt;br&gt;   \
&lt;/features&gt;&lt;br&gt;   &lt;clock offset='utc'/&gt;&lt;br&gt;   \
&lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;&lt;br&gt;   \
&lt;on_reboot&gt;destroy&lt;/on_reboot&gt;&lt;br&gt;   \
&lt;on_crash&gt;destroy&lt;/on_crash&gt;&lt;br&gt;   &lt;devices&gt;&lt;br&gt;      \
&lt;emulator&gt;/usr/lib64/libvirt/libvirt_lxc&lt;/emulator&gt;&lt;br&gt;      \
&lt;filesystem type='mount' accessmode='passthrough'&gt;&lt;br&gt;         \
&lt;source dir='/junos/lxc/jdm/jdm1/rootfs'/&gt;&lt;br&gt;         &lt;target \
dir='/'/&gt;&lt;br&gt;      &lt;/filesystem&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;   \
&lt;/devices&gt;&lt;br&gt;&lt;/domain&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;Thanks,&lt;/div&gt;&lt;div&gt;Yuvaraj.&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;/div&gt;




</body></email><email><emailId>20210804153341</emailId><senderName>Kaushal Shriyan</senderName><senderEmail>kaushalshriyan@gmail.com</senderEmail><timestampReceived>2021-08-04 15:33:41-0400</timestampReceived><subject>Re: ERROR Couldn't find hvm kernel for Ubuntu tree.</subject><body>

On Thu, Jul 29, 2021 at 8:19 PM Kaushal Shriyan &lt;kaushalshriyan@gmail.com&gt;
wrote:

&gt; Hi,
&gt;
&gt; I am running the below command to spawn Ubuntu 18.04 based Virtual Machine
&gt; using KVM based technology.
&gt;
&gt; #virt-install --version
&gt; 1.5.0
&gt; #
&gt;
&gt; virt-install --name=snipeitassetmanagement
&gt;&gt; --file=/linuxkvmguestosdisk/snipeitassetmanagement.img --file-size=40
&gt;&gt; --nonsparse --vcpus=2 --ram=8096 --network=bridge:br0 --os-type=linux
&gt;&gt; --os-variant=ubuntu18.04 --graphics none
&gt;&gt; --location=/linuxkvmguestosdisk/var/lib/libvirt/isos/ubuntu-18.04.5-live-server-amd64.iso
&gt;&gt; --extra-args="console=ttyS0"
&gt;&gt;
&gt;&gt; Starting install...
&gt;&gt; Retrieving file .treeinfo...
&gt;&gt;
&gt;&gt;                                 |    0 B  00:00:00
&gt;&gt; Retrieving file content...
&gt;&gt;
&gt;&gt;                                 |    0 B  00:00:00
&gt;&gt; Retrieving file info...
&gt;&gt;
&gt;&gt;                                |   70 B  00:00:00
&gt;&gt; ERROR    Couldn't find hvm kernel for Ubuntu tree.
&gt;&gt; Domain installation does not appear to have been successful.
&gt;&gt; If it was, you can restart your domain by running:
&gt;&gt;   virsh --connect qemu:///system start snipeitassetmanagement
&gt;&gt; otherwise, please restart your installation.
&gt;&gt;
&gt;&gt;
&gt; Any clue and i look forward to hearing from you. Thanks in advance.
&gt;
&gt; Best Regards,
&gt;

Hi,

#cat /etc/redhat-release
CentOS Linux release 7.8.2003 (Core)
#virt-install --version
1.5.0
#virt-install -n snipeitassetmanagementubuntu --ram 8096 --vcpus 2
--virt-type kvm --os-type linux --os-variant ubuntu18.04 --graphics none
--location '
http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/'
--extra-args "console=tty0 console=ttyS0,115200n8" --disk
path=/linuxkvmguestosdisk/snipeitassetmanagementubuntu.img,size=30

I am unable to connect to the guest VM instance. Any clue and i look
forward to hearing from you. Thanks in advance.

Best Regards,

Kaushal

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Thu, \
Jul 29, 2021 at 8:19 PM Kaushal Shriyan &lt;&lt;a \
href="mailto:kaushalshriyan@gmail.com"&gt;kaushalshriyan@gmail.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;&lt;div \
dir="ltr"&gt;Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I am running the below command to spawn Ubuntu 18.04 \
based Virtual Machine using KVM based technology.  \
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#virt-install --version  \
&lt;br&gt;&lt;/div&gt;&lt;div&gt;1.5.0&lt;br&gt;&lt;/div&gt;&lt;div&gt;#&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote \
class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid \
rgb(204,204,204);padding-left:1ex"&gt;virt-install --name=snipeitassetmanagement \
--file=/linuxkvmguestosdisk/snipeitassetmanagement.img --file-size=40 --nonsparse \
--vcpus=2 --ram=8096 --network=bridge:br0 --os-type=linux --os-variant=ubuntu18.04 \
--graphics none --location=/linuxkvmguestosdisk/var/lib/libvirt/isos/ubuntu-18.04.5-live-server-amd64.iso \
--extra-args="console=ttyS0"&lt;br&gt;&lt;br&gt;Starting install...&lt;br&gt;Retrieving file \
.treeinfo...                                                                          \
|      0 B   00:00:00&lt;br&gt;Retrieving file content...                                   \
|      0 B   00:00:00&lt;br&gt;Retrieving file info...                                      \
|    70 B   00:00:00&lt;br&gt;&lt;font color="#ff0000"&gt;ERROR      Couldn't find hvm kernel \
for Ubuntu tree&lt;/font&gt;.&lt;br&gt;Domain installation does not appear to have been \
successful.&lt;br&gt;If it was, you can restart your domain by running:&lt;br&gt;   virsh \
--connect qemu:///system start snipeitassetmanagement&lt;br&gt;otherwise, please restart \
your installation.&lt;br&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Any clue and i look \
forward to hearing from you. Thanks in  advance.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Best \
Regards,&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
dir="ltr"&gt;Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#cat /etc/redhat-release&lt;br&gt;&lt;/div&gt;&lt;div&gt;CentOS Linux \
release 7.8.2003 (Core)&lt;br&gt;&lt;/div&gt;&lt;div&gt;#virt-install \
--version&lt;br&gt;1.5.0&lt;br&gt;&lt;/div&gt;&lt;div&gt;#virt-install -n snipeitassetmanagementubuntu --ram \
8096 --vcpus 2 --virt-type kvm --os-type linux --os-variant ubuntu18.04 --graphics \
none --location '&lt;a \
href="http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/"&gt;http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/&lt;/a&gt;' \
--extra-args "console=tty0 console=ttyS0,115200n8" --disk \
path=/linuxkvmguestosdisk/snipeitassetmanagementubuntu.img,size=30&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I \
am unable  to connect to the guest VM instance. Any clue and i look forward to \
hearing from you. Thanks in  advance.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Best \
Regards,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Kaushal  &lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210804161610</emailId><senderName>Ivan Teterevkov</senderName><senderEmail>ivan.teterevkov@nutanix.com</senderEmail><timestampReceived>2021-08-04 16:16:10-0400</timestampReceived><subject>RX throttling causes keep-alive timeout</subject><body>

Hello folks,

I recently discovered that the max_client_requests configuration option
affects the keep-alive RPC and can cause the connection timeout, and I
wanted to verify if my understanding is correct.

Let me outline the context. Under certain circumstances, one of the
connected clients in my setup issued multiple concurrent long-standing
live-migration requests and reached the default limit of five concurrent
requests. Consequently, it triggered the RX throttling, so the server
stopped reading the incoming data from this client's file descriptor.
Meanwhile, the server issued the keepalive "ping" requests but ignored
the "pong" responses from the client due to the RX throttling. As a result,
the server concluded the client was dead and closed the connection with the
"connection closed due to keepalive timeout" message after the default five
"ping" attempts with five seconds timeout each.

The idea of throttling makes perfect sense: the server prevents hogging
of the worker thread pool (or would prevent the unbounded growth of the
memory footprint if the libvirtd server continued parsing the incoming
data and queued the requests). What concerns me is that the server drops
the connection for the alive clients when they're throttled.

One approach to this problem is implementing the EAGAIN-like handling:
parse the incoming data above the limit and respond with the error response,
but handle the keep-alive RPCs gracefully. However, I see two problems here:
either it's a backwards-compatibility concern if implemented unconditionally
or polluting the configuration space if implemented conditionally.

What is the community's opinion on the above issue?

Kind regards,
Ivan


</body></email><email><emailId>20210810194537</emailId><senderName>Gunnar</senderName><senderEmail>tongji@netcologne.de</senderEmail><timestampReceived>2021-08-10 19:45:37-0400</timestampReceived><subject>vmware ESXi in KVM</subject><body>

I am trying to install esxi7 inside a KVM machine

    virt-install --name=esxi7 \
    --vcpus=2 \
    --memory=4096 \
    --cdrom=/home/username/isos/VMware-VMvisor-Installer-7.0U2a-17867351.x86_64.iso
    \
    --disk size=33 \
    --os-variant=unknown

the installation process starts but does not get fails with a "No
network adapters" error. This does not happen with other VM's.
What do I have to add to above command in order to attach the default
network adapter to the machine?

or is there any other trick I have to be aware of when it comes to
installing ESXi

thx ... Gunnar

[Attachment #3 (text/html)]

&lt;html&gt;
  &lt;head&gt;

    &lt;meta http-equiv="content-type" content="text/html; charset=windows-1252"&gt;
  &lt;/head&gt;
  &lt;body&gt;
    I am trying to install esxi7 inside a KVM machine&lt;br&gt;
    &lt;div class="moz-forward-container"&gt;
      &lt;blockquote&gt;&lt;font size="+1" face="monospace"&gt;virt-install
          --name=esxi7 \&lt;br&gt;
          --vcpus=2 \&lt;br&gt;
          --memory=4096 \&lt;br&gt;
--cdrom=/home/username/isos/VMware-VMvisor-Installer-7.0U2a-17867351.x86_64.iso
          \&lt;br&gt;
          --disk size=33 \&lt;br&gt;
          --os-variant=unknown&lt;/font&gt;&lt;font size="+1"&gt;&lt;br&gt;
        &lt;/font&gt;&lt;/blockquote&gt;
      the installation process starts but does not get fails with a "No
      network adapters" error. This does not happen with other VM's.&lt;br&gt;
      What do I have to add to above command in order to attach the
      default network adapter to the machine?&lt;br&gt;
      &lt;br&gt;
      or is there any other trick I have to be aware of when it comes to
      installing ESXi&lt;br&gt;
      &lt;br&gt;
      thx ... Gunnar&lt;br&gt;
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;


</body></email><email><emailId>20210814083850</emailId><senderName>lejeczek</senderName><senderEmail>peljasz@yahoo.co.uk</senderEmail><timestampReceived>2021-08-14 08:38:50-0400</timestampReceived><subject>a test email (&amp; dmarc) @admins</subject><body>

hi guys.
I sent email a while ago and I wonder, also having not 
received a single reply, because I did not get that own 
email - is there are problem I'm having here or DMARC(yahoo 
&amp; others?) are not fixed in by this mailing list - would an 
admin(anybody) know?

many thanks, L.

</body></email><email><emailId>20210823111932</emailId><senderName>"liuyd.fnst () fujitsu ! com"</senderName><senderEmail>liuyd.fnst@fujitsu.com</senderEmail><timestampReceived>2021-08-23 11:19:32-0400</timestampReceived><subject>Question The order of the output of virsh guestinfo --filesystem</subject><body>

Hi all.

I'm curious about the output order of virsh guestinfo --filesystem.
Is the output random?

E.g
Guest info
```

[root@localhost ~]# lsblk -Jp -o KNAME,FSTYPE,TYPE,MOUNTPOINT,PKNAME,SERIAL
{
    "blockdevices": [
       {"kname": "/dev/sr0", "fstype": null, "type": "rom", 
"mountpoint": null, "pkname": null, "serial": "drive-scsi0-0-0-0"},
       {"kname": "/dev/vda", "fstype": null, "type": "disk", 
"mountpoint": null, "pkname": null, "serial": null},
       {"kname": "/dev/vda1", "fstype": "vfat", "type": "part", 
"mountpoint": "/boot/efi", "pkname": "/dev/vda", "serial": null},
       {"kname": "/dev/vda2", "fstype": "xfs", "type": "part", 
"mountpoint": "/boot", "pkname": "/dev/vda", "serial": null},
       {"kname": "/dev/vda3", "fstype": "LVM2_member", "type": "part", 
"mountpoint": null, "pkname": "/dev/vda", "serial": null},
       {"kname": "/dev/vdb", "fstype": null, "type": "disk", 
"mountpoint": null, "pkname": null, "serial": null},
       {"kname": "/dev/vdb1", "fstype": "xfs", "type": "part", 
"mountpoint": "/mnt/test1", "pkname": "/dev/vdb", "serial": null},
       {"kname": "/dev/vdb2", "fstype": "xfs", "type": "part", 
"mountpoint": "/mnt/test2", "pkname": "/dev/vdb", "serial": null},
       {"kname": "/dev/vdb3", "fstype": "xfs", "type": "part", 
"mountpoint": "/mnt/test3", "pkname": "/dev/vdb", "serial": null},
       {"kname": "/dev/dm-0", "fstype": "xfs", "type": "lvm", 
"mountpoint": "/", "pkname": "/dev/vda3", "serial": null},
       {"kname": "/dev/dm-1", "fstype": "swap", "type": "lvm", 
"mountpoint": "[SWAP]", "pkname": "/dev/vda3", "serial": null}
    ]
}

```

virsh guestinfo output.
It is not sorted by  name or total-bytes/used-bytes
```
[root@hpe-apollo80-01-n00 ~]# virsh guestinfo fj-kvm-vm --filesystem
fs.count            : 6
fs.0.name           : dm-0
fs.0.mountpoint     : /
fs.0.fstype         : xfs
fs.0.total-bytes    : 7946108928
fs.0.used-bytes     : 3202314240
fs.0.disk.count     : 1
fs.0.disk.0.alias   : vda
fs.0.disk.0.device  : /dev/vda3
fs.1.name           : vda2
fs.1.mountpoint     : /boot
fs.1.fstype         : xfs
fs.1.total-bytes    : 1063256064
fs.1.used-bytes     : 180252672
fs.1.disk.count     : 1
fs.1.disk.0.alias   : vda
fs.1.disk.0.device  : /dev/vda2
fs.2.name           : vda1
fs.2.mountpoint     : /boot/efi
fs.2.fstype         : vfat
fs.2.total-bytes    : 627900416
fs.2.used-bytes     : 7065600
fs.2.disk.count     : 1
fs.2.disk.0.alias   : vda
fs.2.disk.0.device  : /dev/vda1
fs.3.name           : vdb2
fs.3.mountpoint     : /mnt/test2
fs.3.fstype         : xfs
fs.3.total-bytes    : 204111872
fs.3.used-bytes     : 12185600
fs.3.disk.count     : 1
fs.3.disk.0.alias   : vdb
fs.3.disk.0.device  : /dev/vdb2
fs.4.name           : vdb3
fs.4.mountpoint     : /mnt/test3
fs.4.fstype         : xfs
fs.4.total-bytes    : 751706112
fs.4.used-bytes     : 39084032
fs.4.disk.count     : 1
fs.4.disk.0.alias   : vdb
fs.4.disk.0.device  : /dev/vdb3
fs.5.name           : vdb1
fs.5.mountpoint     : /mnt/test1
fs.5.fstype         : xfs
fs.5.total-bytes    : 99254272
fs.5.used-bytes     : 6213632
fs.5.disk.count     : 1
fs.5.disk.0.alias   : vdb
fs.5.disk.0.device  : /dev/vdb1
```

-- 
Best Regards.
Yiding Liu

</body></email><email><emailId>20210809104811</emailId><senderName>lejeczek</senderName><senderEmail>peljasz@yahoo.co.uk</senderEmail><timestampReceived>2021-08-09 10:48:11-0400</timestampReceived><subject>Are secrets hidden from admins too - ?</subject><body>

Hi guys.

On a remote &amp; "shared" systems - are private secrets 
completely 100% safe? Can root get to those?
(naturally excluding hacking of unknown bugs &amp; exploits and 
theories such as "no computer system is ultimately safe")

And if answer is yes then - do you have any best practices 
for storing &amp; managing of those secrets?

many thanks, L.

</body></email><email><emailId>20210816093256</emailId><senderName>Martin Kletzander</senderName><senderEmail>mkletzan@redhat.com</senderEmail><timestampReceived>2021-08-16 09:32:56-0400</timestampReceived><subject>Re: Are secrets hidden from admins too - ?</subject><body>


On Mon, Aug 09, 2021 at 11:48:11AM +0100, lejeczek wrote:
&gt;Hi guys.
&gt;
&gt;On a remote &amp; "shared" systems - are private secrets
&gt;completely 100% safe? Can root get to those?
&gt;(naturally excluding hacking of unknown bugs &amp; exploits and
&gt;theories such as "no computer system is ultimately safe")
&gt;

Well, the secret needs to be kept somewhere.  The most secure you can
get with secrets is the ephemeral ones, but those still need to be kept
in memory.  You could encrypt them, but then you would need to provide
the decryption passphrase or key when you want to use them and that
would be like providing the secret itself anyway.  Even thought there
are some limitations to unlimited memory access in Linux when someone
has root access you have to assume they have access to what the system
has access too.

The best you can do to mitigate that is using something like Intel SGX,
AMD SEV and such like.  There is Launch Security [0] in libvirt, but I
think it only supports SEV and something on s390.  But I do not have any
experience with those.

[0] https://libvirt.org/formatdomain.html#id113

&gt;And if answer is yes then - do you have any best practices
&gt;for storing &amp; managing of those secrets?
&gt;
&gt;many thanks, L.
&gt;

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20210816183228</emailId><senderName>lejeczek</senderName><senderEmail>peljasz@yahoo.co.uk</senderEmail><timestampReceived>2021-08-16 18:32:28-0400</timestampReceived><subject>Re: Are secrets hidden from admins too - ?</subject><body>



On 16/08/2021 10:32, Martin Kletzander wrote:
&gt; On Mon, Aug 09, 2021 at 11:48:11AM +0100, lejeczek wrote:
&gt;&gt; Hi guys.
&gt;&gt;
&gt;&gt; On a remote &amp; "shared" systems - are private secrets
&gt;&gt; completely 100% safe? Can root get to those?
&gt;&gt; (naturally excluding hacking of unknown bugs &amp; exploits and
&gt;&gt; theories such as "no computer system is ultimately safe")
&gt;&gt;
&gt;
&gt; Well, the secret needs to be kept somewhere.  The most 
&gt; secure you can
&gt; get with secrets is the ephemeral ones, but those still 
&gt; need to be kept
&gt; in memory.  You could encrypt them, but then you would 
&gt; need to provide
&gt; the decryption passphrase or key when you want to use them 
&gt; and that
&gt; would be like providing the secret itself anyway.  Even 
&gt; thought there
&gt; are some limitations to unlimited memory access in Linux 
&gt; when someone
&gt; has root access you have to assume they have access to 
&gt; what the system
&gt; has access too.
&gt;
yes, my bad I was not clear on that - yes private &amp; ephemeral.
Those 'secrets' virsh says cannot "get" back to me, even to 
me root, so that's good. So here, I wonder', if there is a 
technique which a malicious root could use to a secret.

&gt; The best you can do to mitigate that is using something 
&gt; like Intel SGX,
&gt; AMD SEV and such like.  There is Launch Security [0] in 
&gt; libvirt, but I
&gt; think it only supports SEV and something on s390.  But I 
&gt; do not have any
&gt; experience with those.
&gt;
&gt; [0] https://libvirt.org/formatdomain.html#id113
&gt;
"Launch Security" - I was not even aware of. Busy with admin 
stuff and not checking changelogs, bad me again. Thanks for 
that.

&gt;&gt; And if answer is yes then - do you have any best practices
&gt;&gt; for storing &amp; managing of those secrets?
&gt;&gt;
&gt;&gt; many thanks, L.
&gt;&gt;

</body></email><email><emailId>20210816190127</emailId><senderName>lejeczek</senderName><senderEmail>peljasz@yahoo.co.uk</senderEmail><timestampReceived>2021-08-16 19:01:27-0400</timestampReceived><subject>Re: Are secrets hidden from admins too - ?</subject><body>



On 16/08/2021 10:32, Martin Kletzander wrote:
&gt; On Mon, Aug 09, 2021 at 11:48:11AM +0100, lejeczek wrote:
&gt;&gt; Hi guys.
&gt;&gt;
&gt;&gt; On a remote &amp; "shared" systems - are private secrets
&gt;&gt; completely 100% safe? Can root get to those?
&gt;&gt; (naturally excluding hacking of unknown bugs &amp; exploits and
&gt;&gt; theories such as "no computer system is ultimately safe")
&gt;&gt;
&gt;
&gt; Well, the secret needs to be kept somewhere.  The most 
&gt; secure you can
&gt; get with secrets is the ephemeral ones, but those still 
&gt; need to be kept
&gt; in memory.  You could encrypt them, but then you would 
&gt; need to provide
&gt; the decryption passphrase or key when you want to use them 
&gt; and that
&gt; would be like providing the secret itself anyway.  Even 
&gt; thought there
&gt; are some limitations to unlimited memory access in Linux 
&gt; when someone
&gt; has root access you have to assume they have access to 
&gt; what the system
&gt; has access too.
&gt;
&gt; The best you can do to mitigate that is using something 
&gt; like Intel SGX,
&gt; AMD SEV and such like.  There is Launch Security [0] in 
&gt; libvirt, but I
&gt; think it only supports SEV and something on s390.  But I 
&gt; do not have any
&gt; experience with those.
&gt;
&gt; [0] https://libvirt.org/formatdomain.html#id113
&gt;
Last one - would by any chance you/Redhat have a schedule 
for Libvirt with SEV to go into RHELs/CentOS Stream?
I know one can get that via/from oVirt repos, but that for 
me would not work.
thanks, L.
&gt;&gt; And if answer is yes then - do you have any best practices
&gt;&gt; for storing &amp; managing of those secrets?
&gt;&gt;
&gt;&gt; many thanks, L.
&gt;&gt;

</body></email><email><emailId>20210824070658</emailId><senderName>Erik Skultety</senderName><senderEmail>eskultet@redhat.com</senderEmail><timestampReceived>2021-08-24 07:06:58-0400</timestampReceived><subject>Re: Are secrets hidden from admins too - ?</subject><body>

On Mon, Aug 16, 2021 at 08:01:27PM +0100, lejeczek wrote:
&gt; 
&gt; 
&gt; On 16/08/2021 10:32, Martin Kletzander wrote:
&gt; &gt; On Mon, Aug 09, 2021 at 11:48:11AM +0100, lejeczek wrote:
&gt; &gt; &gt; Hi guys.
&gt; &gt; &gt; 
&gt; &gt; &gt; On a remote &amp; "shared" systems - are private secrets
&gt; &gt; &gt; completely 100% safe? Can root get to those?
&gt; &gt; &gt; (naturally excluding hacking of unknown bugs &amp; exploits and
&gt; &gt; &gt; theories such as "no computer system is ultimately safe")
&gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; Well, the secret needs to be kept somewhere.  The most secure you can
&gt; &gt; get with secrets is the ephemeral ones, but those still need to be kept
&gt; &gt; in memory.  You could encrypt them, but then you would need to provide
&gt; &gt; the decryption passphrase or key when you want to use them and that
&gt; &gt; would be like providing the secret itself anyway.  Even thought there
&gt; &gt; are some limitations to unlimited memory access in Linux when someone
&gt; &gt; has root access you have to assume they have access to what the system
&gt; &gt; has access too.
&gt; &gt; 
&gt; &gt; The best you can do to mitigate that is using something like Intel SGX,
&gt; &gt; AMD SEV and such like.  There is Launch Security [0] in libvirt, but I
&gt; &gt; think it only supports SEV and something on s390.  But I do not have any
&gt; &gt; experience with those.
&gt; &gt; 
&gt; &gt; [0] https://libvirt.org/formatdomain.html#id113
&gt; &gt; 
&gt; Last one - would by any chance you/Redhat have a schedule for Libvirt with
&gt; SEV to go into RHELs/CentOS Stream?

TL;DR

It's been there for a while, we added SEV support in libvirt 6.5.0 and the
libvirt version in current RHEL-8 is 7.0.0. I don't remember (even if I could
I could not discuss it) the strategy, but CentOS Stream 8 will likely have
a libvirt version &gt;7.0.0.

Note that there are essentially 3 "flavours" of SEV:
SEV, SEV-ES, SEV-SNP. The main difference is in the underlying HW changes; from
libvirt's POV SEV and SEV-ES are identical, but neither QEMU nor libvirt
support SEV-SNP fully yet - the problem here is the secure state attestation
process which is still under development. What that means for end users is that
they can create memory encrypted guests the same way as with the other SEV
flavours, but they're still unable to verify that the guest hasn't been tampered
with by a malicious QEMU or platform owner or whatnot just before it was
launched.

Erik

&gt; I know one can get that via/from oVirt repos, but that for me would not
&gt; work.
&gt; thanks, L.
&gt; &gt; &gt; And if answer is yes then - do you have any best practices
&gt; &gt; &gt; for storing &amp; managing of those secrets?
&gt; &gt; &gt; 
&gt; &gt; &gt; many thanks, L.
&gt; &gt; &gt; 
&gt; 

</body></email><email><emailId>20210802091748</emailId><senderName>Martin Kletzander</senderName><senderEmail>mkletzan@redhat.com</senderEmail><timestampReceived>2021-08-02 09:17:48-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>


On Sat, Jul 31, 2021 at 12:19:59PM +0200, daggs wrote:
&gt; Greetings,
&gt; 
&gt; a few weeks ago I've upgraded my system, this resulted with qemu and libvirt being \
&gt; upgraded to 6.0.0 and ~7.5.0 respectfully. I have two vms running on my system, \
&gt; router and streamer. the router vm works great, the streamer vm doesn't.
&gt; after the streamer vm start, the monitor screen gets black and thats it. no \
&gt; relevant error are found in the log, see: http://dpaste.com/ERWDEJQPC the xml ca be \
&gt; found at https://dpaste.com/FQDN6NTN2 in contrast the following oneliner works: \
&gt;                 qemu-system-x86_64 \
&gt; -machine pc-q35-5.0,accel=kvm,usb=off,smm=on,dump-guest-core=off \
&gt; -cpu host,migratable=on \
&gt; -m 15360 \
&gt; -smp 4,sockets=1,dies=1,cores=2,threads=2 \
&gt; -drive file=/home/streamer/streamer.img.qcow2.new,if=virtio,format=qcow2 \
&gt; -device vfio-pci,host=0000:00:02.0,romfile=/home/streamer/gpu-8086:5912-uefi.rom,multifunction=on \
&gt;                 \
&gt; -device vfio-pci,host=0000:00:1f.3,multifunction=on \
&gt; -usb \
&gt; -device usb-host,vendorid=0x046d,productid=0xc52e \
&gt; -device usb-host,vendorid=0x2548,productid=0x1002 \
&gt; -display none \
&gt; -netdev tap,id=hostnet0,ifname=virtsw-streamer,script=no,downscript=no \
&gt; -device e1000e,netdev=hostnet0,id=net0,mac=52:54:00:5a:4c:8c \
&gt; -blockdev '{"driver":"file","filename":"/usr/share/edk2-ovmf/OVMF_CODE.secboot.fd","node-name":"libvirt-pflash0-storage","auto-read-only":true,"discard":"unmap"}' \
&gt;                 \
&gt; -blockdev '{"driver":"file","filename":"/var/lib/libvirt/qemu/nvram/streamer-vm-q35_ \
&gt; VARS.fd","node-name":"libvirt-pflash1-storage","auto-read-only":true,"discard":"unmap"}'
&gt;  
&gt; another issue encountered caused by this param: "-audiodev id=audio1,driver=none" \
&gt; which is auto added to the qemu line. if I add the line to the above oneliner, the \
&gt; guest doesn't detects the pt sound card. without it it does and it works. 

The links have expired, so I cannot look at the XML.  However do you
have any &lt;audio/&gt; in the XML at all?  I believe that without it we are
disabling any audio backends since no audio HW was requested.

&gt; help on solving both issues will be appreciated.
&gt; 
&gt; Thanks,
&gt; 
&gt; Dagg
&gt; 
&gt; 


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20210802143320</emailId><senderName>daggs</senderName><senderEmail>daggs@gmx.com</senderEmail><timestampReceived>2021-08-02 14:33:20-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>

Greetings Martin,

&gt; Sent: Monday, August 02, 2021 at 12:17 PM
&gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; Cc: libvirt-users@redhat.com
&gt; Subject: Re: issues with vm after upgrade
&gt; 
&gt; On Sat, Jul 31, 2021 at 12:19:59PM +0200, daggs wrote:
&gt; &gt; Greetings,
&gt; &gt; 
&gt; &gt; a few weeks ago I've upgraded my system, this resulted with qemu and libvirt \
&gt; &gt; being upgraded to 6.0.0 and ~7.5.0 respectfully. I have two vms running on my \
&gt; &gt; system, router and streamer. the router vm works great, the streamer vm doesn't.
&gt; &gt; after the streamer vm start, the monitor screen gets black and thats it. no \
&gt; &gt; relevant error are found in the log, see: http://dpaste.com/ERWDEJQPC the xml ca \
&gt; &gt; be found at https://dpaste.com/FQDN6NTN2 in contrast the following oneliner \
&gt; &gt;                 works: qemu-system-x86_64 \
&gt; &gt; -machine pc-q35-5.0,accel=kvm,usb=off,smm=on,dump-guest-core=off \
&gt; &gt; -cpu host,migratable=on \
&gt; &gt; -m 15360 \
&gt; &gt; -smp 4,sockets=1,dies=1,cores=2,threads=2 \
&gt; &gt; -drive file=/home/streamer/streamer.img.qcow2.new,if=virtio,format=qcow2 \
&gt; &gt; -device vfio-pci,host=0000:00:02.0,romfile=/home/streamer/gpu-8086:5912-uefi.rom,multifunction=on \
&gt; &gt;                 \
&gt; &gt; -device vfio-pci,host=0000:00:1f.3,multifunction=on \
&gt; &gt; -usb \
&gt; &gt; -device usb-host,vendorid=0x046d,productid=0xc52e \
&gt; &gt; -device usb-host,vendorid=0x2548,productid=0x1002 \
&gt; &gt; -display none \
&gt; &gt; -netdev tap,id=hostnet0,ifname=virtsw-streamer,script=no,downscript=no \
&gt; &gt; -device e1000e,netdev=hostnet0,id=net0,mac=52:54:00:5a:4c:8c \
&gt; &gt; -blockdev '{"driver":"file","filename":"/usr/share/edk2-ovmf/OVMF_CODE.secboot.fd","node-name":"libvirt-pflash0-storage","auto-read-only":true,"discard":"unmap"}' \
&gt; &gt;                 \
&gt; &gt; -blockdev '{"driver":"file","filename":"/var/lib/libvirt/qemu/nvram/streamer-vm-q3 \
&gt; &gt; 5_VARS.fd","node-name":"libvirt-pflash1-storage","auto-read-only":true,"discard":"unmap"}'
&gt; &gt;  
&gt; &gt; another issue encountered caused by this param: "-audiodev id=audio1,driver=none" \
&gt; &gt; which is auto added to the qemu line. if I add the line to the above oneliner, \
&gt; &gt; the guest doesn't detects the pt sound card. without it it does and it works. 
&gt; 
&gt; The links have expired, so I cannot look at the XML.  However do you
&gt; have any &lt;audio/&gt; in the XML at all?  I believe that without it we are
&gt; disabling any audio backends since no audio HW was requested.
&gt; 

here are the links:
1. xml: https://dpaste.com/D6JANX3Z3
2. log: https://dpaste.com/FMUDZY9PD

as for the audio entry, "    &lt;audio id='1' type='none'/&gt;" is in the xml
I didn't added it

Thanks,

Dagg


</body></email><email><emailId>20210803083720</emailId><senderName>Martin Kletzander</senderName><senderEmail>mkletzan@redhat.com</senderEmail><timestampReceived>2021-08-03 08:37:20-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>


On Mon, Aug 02, 2021 at 04:33:20PM +0200, daggs wrote:
&gt; Greetings Martin,
&gt; 
&gt; &gt; Sent: Monday, August 02, 2021 at 12:17 PM
&gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; Cc: libvirt-users@redhat.com
&gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; 
&gt; &gt; On Sat, Jul 31, 2021 at 12:19:59PM +0200, daggs wrote:
&gt; &gt; &gt; Greetings,
&gt; &gt; &gt; 
&gt; &gt; &gt; a few weeks ago I've upgraded my system, this resulted with qemu and libvirt \
&gt; &gt; &gt; being upgraded to 6.0.0 and ~7.5.0 respectfully. I have two vms running on my \
&gt; &gt; &gt; system, router and streamer. the router vm works great, the streamer vm \
&gt; &gt; &gt; doesn't. after the streamer vm start, the monitor screen gets black and thats \
&gt; &gt; &gt; it. no relevant error are found in the log, see: http://dpaste.com/ERWDEJQPC \
&gt; &gt; &gt; the xml ca be found at https://dpaste.com/FQDN6NTN2 in contrast the following \
&gt; &gt; &gt;                 oneliner works: qemu-system-x86_64 \
&gt; &gt; &gt; -machine pc-q35-5.0,accel=kvm,usb=off,smm=on,dump-guest-core=off \
&gt; &gt; &gt; -cpu host,migratable=on \
&gt; &gt; &gt; -m 15360 \
&gt; &gt; &gt; -smp 4,sockets=1,dies=1,cores=2,threads=2 \
&gt; &gt; &gt; -drive file=/home/streamer/streamer.img.qcow2.new,if=virtio,format=qcow2 \
&gt; &gt; &gt; -device vfio-pci,host=0000:00:02.0,romfile=/home/streamer/gpu-8086:5912-uefi.rom,multifunction=on \
&gt; &gt; &gt;                 \
&gt; &gt; &gt; -device vfio-pci,host=0000:00:1f.3,multifunction=on \
&gt; &gt; &gt; -usb \
&gt; &gt; &gt; -device usb-host,vendorid=0x046d,productid=0xc52e \
&gt; &gt; &gt; -device usb-host,vendorid=0x2548,productid=0x1002 \
&gt; &gt; &gt; -display none \
&gt; &gt; &gt; -netdev tap,id=hostnet0,ifname=virtsw-streamer,script=no,downscript=no \
&gt; &gt; &gt; -device e1000e,netdev=hostnet0,id=net0,mac=52:54:00:5a:4c:8c \
&gt; &gt; &gt; -blockdev '{"driver":"file","filename":"/usr/share/edk2-ovmf/OVMF_CODE.secboot.f \
&gt; &gt; &gt; d","node-name":"libvirt-pflash0-storage","auto-read-only":true,"discard":"unmap"}' \
&gt; &gt; &gt;                 \
&gt; &gt; &gt; -blockdev '{"driver":"file","filename":"/var/lib/libvirt/qemu/nvram/streamer-vm- \
&gt; &gt; &gt; q35_VARS.fd","node-name":"libvirt-pflash1-storage","auto-read-only":true,"discard":"unmap"}'
&gt; &gt; &gt;  
&gt; &gt; &gt; another issue encountered caused by this param: "-audiodev \
&gt; &gt; &gt; id=audio1,driver=none" which is auto added to the qemu line. if I add the line \
&gt; &gt; &gt; to the above oneliner, the guest doesn't detects the pt sound card. without it \
&gt; &gt; &gt; it does and it works. 
&gt; &gt; 
&gt; &gt; The links have expired, so I cannot look at the XML.  However do you
&gt; &gt; have any &lt;audio/&gt; in the XML at all?  I believe that without it we are
&gt; &gt; disabling any audio backends since no audio HW was requested.
&gt; &gt; 
&gt; 
&gt; here are the links:
&gt; 1. xml: https://dpaste.com/D6JANX3Z3
&gt; 2. log: https://dpaste.com/FMUDZY9PD
&gt; 
&gt; as for the audio entry, "    &lt;audio id='1' type='none'/&gt;" is in the xml
&gt; I didn't added it
&gt; 

So let get this straight.  You want the VM to use the HW GPU that you
assigned to it and also use the audio on that GPU (e.g. HDMI or DP
output).  When you add the "-audiodev driver=none" the VM cannot see the
audio device on that GPU card?  Or is that unrelated?

There were some strict definitions added for audio devices lately, I
presume to make sure that no data gets leaked in/out the VM and in order
to get audio anywhere else than from/to VNC/spice you'd need to
configure that.  It should not affect device assignment as far as I
understand it, although there might be some misunderstanding.

&gt; Thanks,
&gt; 
&gt; Dagg
&gt; 


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20210803125439</emailId><senderName>daggs</senderName><senderEmail>daggs@gmx.com</senderEmail><timestampReceived>2021-08-03 12:54:39-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>

Greetings Martin,

&gt; Sent: Tuesday, August 03, 2021 at 11:37 AM
&gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; Cc: libvirt-users@redhat.com
&gt; Subject: Re: issues with vm after upgrade
&gt; 
&gt; On Mon, Aug 02, 2021 at 04:33:20PM +0200, daggs wrote:
&gt; &gt; Greetings Martin,
&gt; &gt; 
&gt; &gt; &gt; Sent: Monday, August 02, 2021 at 12:17 PM
&gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; Cc: libvirt-users@redhat.com
&gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; 
&gt; &gt; &gt; On Sat, Jul 31, 2021 at 12:19:59PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; Greetings,
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; a few weeks ago I've upgraded my system, this resulted with qemu and libvirt \
&gt; &gt; &gt; &gt; being upgraded to 6.0.0 and ~7.5.0 respectfully. I have two vms running on my \
&gt; &gt; &gt; &gt; system, router and streamer. the router vm works great, the streamer vm \
&gt; &gt; &gt; &gt; doesn't. after the streamer vm start, the monitor screen gets black and thats \
&gt; &gt; &gt; &gt; it. no relevant error are found in the log, see: http://dpaste.com/ERWDEJQPC \
&gt; &gt; &gt; &gt; the xml ca be found at https://dpaste.com/FQDN6NTN2 in contrast the following \
&gt; &gt; &gt; &gt;                 oneliner works: qemu-system-x86_64 \
&gt; &gt; &gt; &gt; -machine pc-q35-5.0,accel=kvm,usb=off,smm=on,dump-guest-core=off \
&gt; &gt; &gt; &gt; -cpu host,migratable=on \
&gt; &gt; &gt; &gt; -m 15360 \
&gt; &gt; &gt; &gt; -smp 4,sockets=1,dies=1,cores=2,threads=2 \
&gt; &gt; &gt; &gt; -drive file=/home/streamer/streamer.img.qcow2.new,if=virtio,format=qcow2 \
&gt; &gt; &gt; &gt; -device vfio-pci,host=0000:00:02.0,romfile=/home/streamer/gpu-8086:5912-uefi.rom,multifunction=on \
&gt; &gt; &gt; &gt;                 \
&gt; &gt; &gt; &gt; -device vfio-pci,host=0000:00:1f.3,multifunction=on \
&gt; &gt; &gt; &gt; -usb \
&gt; &gt; &gt; &gt; -device usb-host,vendorid=0x046d,productid=0xc52e \
&gt; &gt; &gt; &gt; -device usb-host,vendorid=0x2548,productid=0x1002 \
&gt; &gt; &gt; &gt; -display none \
&gt; &gt; &gt; &gt; -netdev tap,id=hostnet0,ifname=virtsw-streamer,script=no,downscript=no \
&gt; &gt; &gt; &gt; -device e1000e,netdev=hostnet0,id=net0,mac=52:54:00:5a:4c:8c \
&gt; &gt; &gt; &gt; -blockdev '{"driver":"file","filename":"/usr/share/edk2-ovmf/OVMF_CODE.secboot \
&gt; &gt; &gt; &gt; .fd","node-name":"libvirt-pflash0-storage","auto-read-only":true,"discard":"unmap"}' \
&gt; &gt; &gt; &gt;                 \
&gt; &gt; &gt; &gt; -blockdev '{"driver":"file","filename":"/var/lib/libvirt/qemu/nvram/streamer-v \
&gt; &gt; &gt; &gt; m-q35_VARS.fd","node-name":"libvirt-pflash1-storage","auto-read-only":true,"discard":"unmap"}'
&gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt; another issue encountered caused by this param: "-audiodev \
&gt; &gt; &gt; &gt; id=audio1,driver=none" which is auto added to the qemu line. if I add the \
&gt; &gt; &gt; &gt; line to the above oneliner, the guest doesn't detects the pt sound card. \
&gt; &gt; &gt; &gt; without it it does and it works. 
&gt; &gt; &gt; 
&gt; &gt; &gt; The links have expired, so I cannot look at the XML.  However do you
&gt; &gt; &gt; have any &lt;audio/&gt; in the XML at all?  I believe that without it we are
&gt; &gt; &gt; disabling any audio backends since no audio HW was requested.
&gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; here are the links:
&gt; &gt; 1. xml: https://dpaste.com/D6JANX3Z3
&gt; &gt; 2. log: https://dpaste.com/FMUDZY9PD
&gt; &gt; 
&gt; &gt; as for the audio entry, "    &lt;audio id='1' type='none'/&gt;" is in the xml
&gt; &gt; I didn't added it
&gt; &gt; 
&gt; 
&gt; So let get this straight.  You want the VM to use the HW GPU that you
&gt; assigned to it and also use the audio on that GPU (e.g. HDMI or DP
&gt; output).  When you add the "-audiodev driver=none" the VM cannot see the
&gt; audio device on that GPU card?  Or is that unrelated?
&gt; 
&gt; There were some strict definitions added for audio devices lately, I
&gt; presume to make sure that no data gets leaked in/out the VM and in order
&gt; to get audio anywhere else than from/to VNC/spice you'd need to
&gt; configure that.  It should not affect device assignment as far as I
&gt; understand it, although there might be some misunderstanding.
&gt; 

I'll try to explain, I'm passing the computer's O/B gpu and O/B sound card to the vm \
so I can use them inside the vm which serves as streamer. all was working well until \
I've upgraded both qemu and libvirt (target versions are started in the original \
mail) since then, the vm doesn't boot at all.
I was able to bisect the qemu cmd libvirt generates partially and go the vm up. this \
points to a config issue. as part of the testing I've found out that when the vm \
boots, it has no sound card. following your suggestion, I've found that the xml has \
this: &lt;audio id='1' type='none'/&gt; I have never added it to the xml so I assume that \
it was added as part of the upgrade. based on this I assume that there is another \
config which prevents my vm from booting. unfortunately, I don't have the xml prior \
to the upgrade to diff them.

Dagg.


</body></email><email><emailId>20210803131206</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>dan@berrange.com</senderEmail><timestampReceived>2021-08-03 13:12:06-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>

On Tue, Aug 03, 2021 at 02:54:39PM +0200, daggs wrote:
&gt; Greetings Martin,
&gt; 
&gt; &gt; Sent: Tuesday, August 03, 2021 at 11:37 AM
&gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; Cc: libvirt-users@redhat.com
&gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; 
&gt; &gt; On Mon, Aug 02, 2021 at 04:33:20PM +0200, daggs wrote:
&gt; &gt; &gt; Greetings Martin,
&gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Sent: Monday, August 02, 2021 at 12:17 PM
&gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; Cc: libvirt-users@redhat.com
&gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; On Sat, Jul 31, 2021 at 12:19:59PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; Greetings,
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; a few weeks ago I've upgraded my system, this resulted with qemu and \
&gt; &gt; &gt; &gt; &gt; libvirt being upgraded to 6.0.0 and ~7.5.0 respectfully. I have two vms \
&gt; &gt; &gt; &gt; &gt; running on my system, router and streamer. the router vm works great, the \
&gt; &gt; &gt; &gt; &gt; streamer vm doesn't. after the streamer vm start, the monitor screen gets \
&gt; &gt; &gt; &gt; &gt; black and thats it. no relevant error are found in the log, see: \
&gt; &gt; &gt; &gt; &gt; http://dpaste.com/ERWDEJQPC the xml ca be found at \
&gt; &gt; &gt; &gt; &gt; https://dpaste.com/FQDN6NTN2 in contrast the following oneliner works: \
&gt; &gt; &gt; &gt; &gt;                 qemu-system-x86_64 \
&gt; &gt; &gt; &gt; &gt; -machine pc-q35-5.0,accel=kvm,usb=off,smm=on,dump-guest-core=off \
&gt; &gt; &gt; &gt; &gt; -cpu host,migratable=on \
&gt; &gt; &gt; &gt; &gt; -m 15360 \
&gt; &gt; &gt; &gt; &gt; -smp 4,sockets=1,dies=1,cores=2,threads=2 \
&gt; &gt; &gt; &gt; &gt; -drive file=/home/streamer/streamer.img.qcow2.new,if=virtio,format=qcow2 \
&gt; &gt; &gt; &gt; &gt; -device vfio-pci,host=0000:00:02.0,romfile=/home/streamer/gpu-8086:5912-uefi.rom,multifunction=on \
&gt; &gt; &gt; &gt; &gt;                 \
&gt; &gt; &gt; &gt; &gt; -device vfio-pci,host=0000:00:1f.3,multifunction=on \
&gt; &gt; &gt; &gt; &gt; -usb \
&gt; &gt; &gt; &gt; &gt; -device usb-host,vendorid=0x046d,productid=0xc52e \
&gt; &gt; &gt; &gt; &gt; -device usb-host,vendorid=0x2548,productid=0x1002 \
&gt; &gt; &gt; &gt; &gt; -display none \
&gt; &gt; &gt; &gt; &gt; -netdev tap,id=hostnet0,ifname=virtsw-streamer,script=no,downscript=no \
&gt; &gt; &gt; &gt; &gt; -device e1000e,netdev=hostnet0,id=net0,mac=52:54:00:5a:4c:8c \
&gt; &gt; &gt; &gt; &gt; -blockdev '{"driver":"file","filename":"/usr/share/edk2-ovmf/OVMF_CODE.secbo \
&gt; &gt; &gt; &gt; &gt; ot.fd","node-name":"libvirt-pflash0-storage","auto-read-only":true,"discard":"unmap"}' \
&gt; &gt; &gt; &gt; &gt;                 \
&gt; &gt; &gt; &gt; &gt; -blockdev '{"driver":"file","filename":"/var/lib/libvirt/qemu/nvram/streamer \
&gt; &gt; &gt; &gt; &gt; -vm-q35_VARS.fd","node-name":"libvirt-pflash1-storage","auto-read-only":true,"discard":"unmap"}'
&gt; &gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt; &gt; another issue encountered caused by this param: "-audiodev \
&gt; &gt; &gt; &gt; &gt; id=audio1,driver=none" which is auto added to the qemu line. if I add the \
&gt; &gt; &gt; &gt; &gt; line to the above oneliner, the guest doesn't detects the pt sound card. \
&gt; &gt; &gt; &gt; &gt; without it it does and it works. 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; The links have expired, so I cannot look at the XML.  However do you
&gt; &gt; &gt; &gt; have any &lt;audio/&gt; in the XML at all?  I believe that without it we are
&gt; &gt; &gt; &gt; disabling any audio backends since no audio HW was requested.
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; here are the links:
&gt; &gt; &gt; 1. xml: https://dpaste.com/D6JANX3Z3
&gt; &gt; &gt; 2. log: https://dpaste.com/FMUDZY9PD
&gt; &gt; &gt; 
&gt; &gt; &gt; as for the audio entry, "    &lt;audio id='1' type='none'/&gt;" is in the xml
&gt; &gt; &gt; I didn't added it
&gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; So let get this straight.  You want the VM to use the HW GPU that you
&gt; &gt; assigned to it and also use the audio on that GPU (e.g. HDMI or DP
&gt; &gt; output).  When you add the "-audiodev driver=none" the VM cannot see the
&gt; &gt; audio device on that GPU card?  Or is that unrelated?
&gt; &gt; 
&gt; &gt; There were some strict definitions added for audio devices lately, I
&gt; &gt; presume to make sure that no data gets leaked in/out the VM and in order
&gt; &gt; to get audio anywhere else than from/to VNC/spice you'd need to
&gt; &gt; configure that.  It should not affect device assignment as far as I
&gt; &gt; understand it, although there might be some misunderstanding.
&gt; &gt; 
&gt; 
&gt; I'll try to explain, I'm passing the computer's O/B gpu and O/B sound card to the \
&gt; vm so I can use them inside the vm which serves as streamer. all was working well \
&gt; until I've upgraded both qemu and libvirt (target versions are started in the \
&gt; original mail) since then, the vm doesn't boot at all.
&gt; I was able to bisect the qemu cmd libvirt generates partially and go the vm up. \
&gt; this points to a config issue. as part of the testing I've found out that when the \
&gt; vm boots, it has no sound card. following your suggestion, I've found that the xml \
&gt; has this: &lt;audio id='1' type='none'/&gt; I have never added it to the xml so I assume \
&gt; that it was added as part of the upgrade. based on this I assume that there is \
&gt; another config which prevents my vm from booting. unfortunately, I don't have the \
&gt; xml prior to the upgrade to diff them.

The &lt;audio&gt; element just refers to the *host* backend used for audio
playback. It would not affect guest hardware. Further, this has always
existed - it just wasn't exposed in the XML previously.


With regards,
Daniel
--
&gt; &gt; https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
&gt; &gt; https://libvirt.org         -o-            https://fstop138.berrange.com :|
&gt; &gt; https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|


</body></email><email><emailId>20210803152152</emailId><senderName>daggs</senderName><senderEmail>daggs@gmx.com</senderEmail><timestampReceived>2021-08-03 15:21:52-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>

Greetings Daniel,

&gt; Sent: Tuesday, August 03, 2021 at 4:12 PM
&gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; Subject: Re: issues with vm after upgrade
&gt; 
&gt; On Tue, Aug 03, 2021 at 02:54:39PM +0200, daggs wrote:
&gt; &gt; Greetings Martin,
&gt; &gt; 
&gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 11:37 AM
&gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; Cc: libvirt-users@redhat.com
&gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; 
&gt; &gt; &gt; On Mon, Aug 02, 2021 at 04:33:20PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; Greetings Martin,
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; Sent: Monday, August 02, 2021 at 12:17 PM
&gt; &gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; Cc: libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; On Sat, Jul 31, 2021 at 12:19:59PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; Greetings,
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; a few weeks ago I've upgraded my system, this resulted with qemu and \
&gt; &gt; &gt; &gt; &gt; &gt; libvirt being upgraded to 6.0.0 and ~7.5.0 respectfully. I have two vms \
&gt; &gt; &gt; &gt; &gt; &gt; running on my system, router and streamer. the router vm works great, the \
&gt; &gt; &gt; &gt; &gt; &gt; streamer vm doesn't. after the streamer vm start, the monitor screen gets \
&gt; &gt; &gt; &gt; &gt; &gt; black and thats it. no relevant error are found in the log, see: \
&gt; &gt; &gt; &gt; &gt; &gt; http://dpaste.com/ERWDEJQPC the xml ca be found at \
&gt; &gt; &gt; &gt; &gt; &gt; https://dpaste.com/FQDN6NTN2 in contrast the following oneliner works: \
&gt; &gt; &gt; &gt; &gt; &gt;                 qemu-system-x86_64 \
&gt; &gt; &gt; &gt; &gt; &gt; -machine pc-q35-5.0,accel=kvm,usb=off,smm=on,dump-guest-core=off \
&gt; &gt; &gt; &gt; &gt; &gt; -cpu host,migratable=on \
&gt; &gt; &gt; &gt; &gt; &gt; -m 15360 \
&gt; &gt; &gt; &gt; &gt; &gt; -smp 4,sockets=1,dies=1,cores=2,threads=2 \
&gt; &gt; &gt; &gt; &gt; &gt; -drive file=/home/streamer/streamer.img.qcow2.new,if=virtio,format=qcow2 \
&gt; &gt; &gt; &gt; &gt; &gt;                 \
&gt; &gt; &gt; &gt; &gt; &gt; -device vfio-pci,host=0000:00:02.0,romfile=/home/streamer/gpu-8086:5912-uefi.rom,multifunction=on \
&gt; &gt; &gt; &gt; &gt; &gt;                 \
&gt; &gt; &gt; &gt; &gt; &gt; -device vfio-pci,host=0000:00:1f.3,multifunction=on \
&gt; &gt; &gt; &gt; &gt; &gt; -usb \
&gt; &gt; &gt; &gt; &gt; &gt; -device usb-host,vendorid=0x046d,productid=0xc52e \
&gt; &gt; &gt; &gt; &gt; &gt; -device usb-host,vendorid=0x2548,productid=0x1002 \
&gt; &gt; &gt; &gt; &gt; &gt; -display none \
&gt; &gt; &gt; &gt; &gt; &gt; -netdev tap,id=hostnet0,ifname=virtsw-streamer,script=no,downscript=no \
&gt; &gt; &gt; &gt; &gt; &gt; -device e1000e,netdev=hostnet0,id=net0,mac=52:54:00:5a:4c:8c \
&gt; &gt; &gt; &gt; &gt; &gt; -blockdev \
&gt; &gt; &gt; &gt; &gt; &gt; '{"driver":"file","filename":"/usr/share/edk2-ovmf/OVMF_CODE.secboot.fd","node-name":"libvirt-pflash0-storage","auto-read-only":true,"discard":"unmap"}' \
&gt; &gt; &gt; &gt; &gt; &gt;                 \
&gt; &gt; &gt; &gt; &gt; &gt; -blockdev \
&gt; &gt; &gt; &gt; &gt; &gt; '{"driver":"file","filename":"/var/lib/libvirt/qemu/nvram/streamer-vm-q35_ \
&gt; &gt; &gt; &gt; &gt; &gt; VARS.fd","node-name":"libvirt-pflash1-storage","auto-read-only":true,"discard":"unmap"}'
&gt; &gt; &gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt; &gt; &gt; another issue encountered caused by this param: "-audiodev \
&gt; &gt; &gt; &gt; &gt; &gt; id=audio1,driver=none" which is auto added to the qemu line. if I add the \
&gt; &gt; &gt; &gt; &gt; &gt; line to the above oneliner, the guest doesn't detects the pt sound card. \
&gt; &gt; &gt; &gt; &gt; &gt; without it it does and it works. 
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; The links have expired, so I cannot look at the XML.  However do you
&gt; &gt; &gt; &gt; &gt; have any &lt;audio/&gt; in the XML at all?  I believe that without it we are
&gt; &gt; &gt; &gt; &gt; disabling any audio backends since no audio HW was requested.
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; here are the links:
&gt; &gt; &gt; &gt; 1. xml: https://dpaste.com/D6JANX3Z3
&gt; &gt; &gt; &gt; 2. log: https://dpaste.com/FMUDZY9PD
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; as for the audio entry, "    &lt;audio id='1' type='none'/&gt;" is in the xml
&gt; &gt; &gt; &gt; I didn't added it
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; So let get this straight.  You want the VM to use the HW GPU that you
&gt; &gt; &gt; assigned to it and also use the audio on that GPU (e.g. HDMI or DP
&gt; &gt; &gt; output).  When you add the "-audiodev driver=none" the VM cannot see the
&gt; &gt; &gt; audio device on that GPU card?  Or is that unrelated?
&gt; &gt; &gt; 
&gt; &gt; &gt; There were some strict definitions added for audio devices lately, I
&gt; &gt; &gt; presume to make sure that no data gets leaked in/out the VM and in order
&gt; &gt; &gt; to get audio anywhere else than from/to VNC/spice you'd need to
&gt; &gt; &gt; configure that.  It should not affect device assignment as far as I
&gt; &gt; &gt; understand it, although there might be some misunderstanding.
&gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; I'll try to explain, I'm passing the computer's O/B gpu and O/B sound card to the \
&gt; &gt; vm so I can use them inside the vm which serves as streamer. all was working well \
&gt; &gt; until I've upgraded both qemu and libvirt (target versions are started in the \
&gt; &gt; original mail) since then, the vm doesn't boot at all.
&gt; &gt; I was able to bisect the qemu cmd libvirt generates partially and go the vm up. \
&gt; &gt; this points to a config issue. as part of the testing I've found out that when \
&gt; &gt; the vm boots, it has no sound card. following your suggestion, I've found that \
&gt; &gt; the xml has this: &lt;audio id='1' type='none'/&gt; I have never added it to the xml so \
&gt; &gt; I assume that it was added as part of the upgrade. based on this I assume that \
&gt; &gt; there is another config which prevents my vm from booting. unfortunately, I don't \
&gt; &gt; have the xml prior to the upgrade to diff them.
&gt; 
&gt; The &lt;audio&gt; element just refers to the *host* backend used for audio
&gt; playback. It would not affect guest hardware. Further, this has always
&gt; existed - it just wasn't exposed in the XML previously.
&gt; 
&gt; 

the upgrade changed something, here is the qemu cmd before the upgrade: \
https://dpaste.com/F2N5T8CT8 here is after https://dpaste.com/F2N5T8CT8

notice diff in audio.
btw, can the efi fw file change prevent the vm from booting? I din't change that too

Dagg


</body></email><email><emailId>20210803152927</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>dan@berrange.com</senderEmail><timestampReceived>2021-08-03 15:29:27-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>

On Tue, Aug 03, 2021 at 05:21:52PM +0200, daggs wrote:
&gt; Greetings Daniel,
&gt; 
&gt; &gt; Sent: Tuesday, August 03, 2021 at 4:12 PM
&gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt;
&gt; &gt; The &lt;audio&gt; element just refers to the *host* backend used for audio
&gt; &gt; playback. It would not affect guest hardware. Further, this has always
&gt; &gt; existed - it just wasn't exposed in the XML previously.
&gt; &gt;
&gt; &gt;
&gt; 
&gt; the upgrade changed something, here is the qemu cmd before the upgrade: https://dpaste.com/F2N5T8CT8
&gt; here is after https://dpaste.com/F2N5T8CT8

Those links are both the same I'm afraid

With regards,
Daniel
--
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20210803153453</emailId><senderName>daggs</senderName><senderEmail>daggs@gmx.com</senderEmail><timestampReceived>2021-08-03 15:34:53-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>

&gt; Sent: Tuesday, August 03, 2021 at 6:29 PM
&gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; Subject: Re: issues with vm after upgrade
&gt;
&gt; On Tue, Aug 03, 2021 at 05:21:52PM +0200, daggs wrote:
&gt; &gt; Greetings Daniel,
&gt; &gt;
&gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 4:12 PM
&gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt;
&gt; &gt; &gt; The &lt;audio&gt; element just refers to the *host* backend used for audio
&gt; &gt; &gt; playback. It would not affect guest hardware. Further, this has always
&gt; &gt; &gt; existed - it just wasn't exposed in the XML previously.
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt;
&gt; &gt; the upgrade changed something, here is the qemu cmd before the upgrade: https://dpaste.com/F2N5T8CT8
&gt; &gt; here is after https://dpaste.com/F2N5T8CT8
&gt;
&gt; Those links are both the same I'm afraid
&gt;

Duh! my bad!
good log: http://dpaste.com/F2N5T8CT8
bad log: http://dpaste.com/6ECUHD2J8


</body></email><email><emailId>20210803153921</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>dan@berrange.com</senderEmail><timestampReceived>2021-08-03 15:39:21-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>

On Tue, Aug 03, 2021 at 05:34:53PM +0200, daggs wrote:
&gt; &gt; Sent: Tuesday, August 03, 2021 at 6:29 PM
&gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; 
&gt; &gt; On Tue, Aug 03, 2021 at 05:21:52PM +0200, daggs wrote:
&gt; &gt; &gt; Greetings Daniel,
&gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 4:12 PM
&gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; The &lt;audio&gt; element just refers to the *host* backend used for audio
&gt; &gt; &gt; &gt; playback. It would not affect guest hardware. Further, this has always
&gt; &gt; &gt; &gt; existed - it just wasn't exposed in the XML previously.
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; the upgrade changed something, here is the qemu cmd before the upgrade: \
&gt; &gt; &gt; https://dpaste.com/F2N5T8CT8 here is after https://dpaste.com/F2N5T8CT8
&gt; &gt; 
&gt; &gt; Those links are both the same I'm afraid
&gt; &gt; 
&gt; 
&gt; Duh! my bad!
&gt; good log: http://dpaste.com/F2N5T8CT8
&gt; bad log: http://dpaste.com/6ECUHD2J8

The new log has a CLI flag

 -audiodev id=audio1,driver=none

but the old log has an env variable

  QEMU_AUDIO_DRV=none

which should be functionally identical, as QEMU will parse them both
to the same internal config.

The obvious difference in the logs which can cause your guest to fail
is the different QEMU version. The old log shows QEMU 5.2.0, while the
new log shows QEMU 6.0.0

With regards,
Daniel
--
&gt; &gt; https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
&gt; &gt; https://libvirt.org         -o-            https://fstop138.berrange.com :|
&gt; &gt; https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|


</body></email><email><emailId>20210803155109</emailId><senderName>daggs</senderName><senderEmail>daggs@gmx.com</senderEmail><timestampReceived>2021-08-03 15:51:09-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>

Greetings Daniel,

&gt; Sent: Tuesday, August 03, 2021 at 6:39 PM
&gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; Subject: Re: issues with vm after upgrade
&gt; 
&gt; On Tue, Aug 03, 2021 at 05:34:53PM +0200, daggs wrote:
&gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:29 PM
&gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; 
&gt; &gt; &gt; On Tue, Aug 03, 2021 at 05:21:52PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; Greetings Daniel,
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 4:12 PM
&gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; The &lt;audio&gt; element just refers to the *host* backend used for audio
&gt; &gt; &gt; &gt; &gt; playback. It would not affect guest hardware. Further, this has always
&gt; &gt; &gt; &gt; &gt; existed - it just wasn't exposed in the XML previously.
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; the upgrade changed something, here is the qemu cmd before the upgrade: \
&gt; &gt; &gt; &gt; https://dpaste.com/F2N5T8CT8 here is after https://dpaste.com/F2N5T8CT8
&gt; &gt; &gt; 
&gt; &gt; &gt; Those links are both the same I'm afraid
&gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; Duh! my bad!
&gt; &gt; good log: http://dpaste.com/F2N5T8CT8
&gt; &gt; bad log: http://dpaste.com/6ECUHD2J8
&gt; 
&gt; The new log has a CLI flag
&gt; 
&gt; -audiodev id=audio1,driver=none
&gt; 
&gt; but the old log has an env variable
&gt; 
&gt; QEMU_AUDIO_DRV=none
&gt; 
&gt; which should be functionally identical, as QEMU will parse them both
&gt; to the same internal config.
&gt; 
&gt; The obvious difference in the logs which can cause your guest to fail
&gt; is the different QEMU version. The old log shows QEMU 5.2.0, while the
&gt; new log shows QEMU 6.0.0
&gt; 

thanks for the help, I went to look why the efi fw and found out that the nvram entry \
in /etc/libvirt/eqmu.conf was deleted upon update. I'm sure fixing this will solve he \
boot issue, hopefully audio issue too.

Thanks,

Dagg.


</body></email><email><emailId>20210803184720</emailId><senderName>daggs</senderName><senderEmail>daggs@gmx.com</senderEmail><timestampReceived>2021-08-03 18:47:20-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>

&gt; Sent: Tuesday, August 03, 2021 at 6:51 PM
&gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; To: dan@berrange.com
&gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; Subject: Re: issues with vm after upgrade
&gt; 
&gt; Greetings Daniel,
&gt; 
&gt; &gt; Sent: Tuesday, August 03, 2021 at 6:39 PM
&gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; 
&gt; &gt; On Tue, Aug 03, 2021 at 05:34:53PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:29 PM
&gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; On Tue, Aug 03, 2021 at 05:21:52PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; Greetings Daniel,
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 4:12 PM
&gt; &gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; The &lt;audio&gt; element just refers to the *host* backend used for audio
&gt; &gt; &gt; &gt; &gt; &gt; playback. It would not affect guest hardware. Further, this has always
&gt; &gt; &gt; &gt; &gt; &gt; existed - it just wasn't exposed in the XML previously.
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; the upgrade changed something, here is the qemu cmd before the upgrade: \
&gt; &gt; &gt; &gt; &gt; https://dpaste.com/F2N5T8CT8 here is after https://dpaste.com/F2N5T8CT8
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Those links are both the same I'm afraid
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; Duh! my bad!
&gt; &gt; &gt; good log: http://dpaste.com/F2N5T8CT8
&gt; &gt; &gt; bad log: http://dpaste.com/6ECUHD2J8
&gt; &gt; 
&gt; &gt; The new log has a CLI flag
&gt; &gt; 
&gt; &gt; -audiodev id=audio1,driver=none
&gt; &gt; 
&gt; &gt; but the old log has an env variable
&gt; &gt; 
&gt; &gt; QEMU_AUDIO_DRV=none
&gt; &gt; 
&gt; &gt; which should be functionally identical, as QEMU will parse them both
&gt; &gt; to the same internal config.
&gt; &gt; 
&gt; &gt; The obvious difference in the logs which can cause your guest to fail
&gt; &gt; is the different QEMU version. The old log shows QEMU 5.2.0, while the
&gt; &gt; new log shows QEMU 6.0.0
&gt; &gt; 
&gt; 
&gt; thanks for the help, I went to look why the efi fw and found out that the nvram \
&gt; entry in /etc/libvirt/eqmu.conf was deleted upon update. I'm sure fixing this will \
&gt; solve he boot issue, hopefully audio issue too. 
&gt; Thanks,
&gt; 
&gt; Dagg.
&gt; 

unfortunately, that didn't helped, vm still wont come up, latest log at \
http://dpaste.com/2XZA4VQZA any ideas?

Dagg


</body></email><email><emailId>20210804081130</emailId><senderName>Martin Kletzander</senderName><senderEmail>mkletzan@redhat.com</senderEmail><timestampReceived>2021-08-04 08:11:30-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>


On Tue, Aug 03, 2021 at 08:47:20PM +0200, daggs wrote:
&gt; &gt; Sent: Tuesday, August 03, 2021 at 6:51 PM
&gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; To: dan@berrange.com
&gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; 
&gt; &gt; Greetings Daniel,
&gt; &gt; 
&gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:39 PM
&gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; 
&gt; &gt; &gt; On Tue, Aug 03, 2021 at 05:34:53PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:29 PM
&gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; On Tue, Aug 03, 2021 at 05:21:52PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; Greetings Daniel,
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 4:12 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; The &lt;audio&gt; element just refers to the *host* backend used for audio
&gt; &gt; &gt; &gt; &gt; &gt; &gt; playback. It would not affect guest hardware. Further, this has always
&gt; &gt; &gt; &gt; &gt; &gt; &gt; existed - it just wasn't exposed in the XML previously.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; the upgrade changed something, here is the qemu cmd before the upgrade: \
&gt; &gt; &gt; &gt; &gt; &gt; https://dpaste.com/F2N5T8CT8 here is after https://dpaste.com/F2N5T8CT8
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; Those links are both the same I'm afraid
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Duh! my bad!
&gt; &gt; &gt; &gt; good log: http://dpaste.com/F2N5T8CT8
&gt; &gt; &gt; &gt; bad log: http://dpaste.com/6ECUHD2J8
&gt; &gt; &gt; 
&gt; &gt; &gt; The new log has a CLI flag
&gt; &gt; &gt; 
&gt; &gt; &gt; -audiodev id=audio1,driver=none
&gt; &gt; &gt; 
&gt; &gt; &gt; but the old log has an env variable
&gt; &gt; &gt; 
&gt; &gt; &gt; QEMU_AUDIO_DRV=none
&gt; &gt; &gt; 
&gt; &gt; &gt; which should be functionally identical, as QEMU will parse them both
&gt; &gt; &gt; to the same internal config.
&gt; &gt; &gt; 
&gt; &gt; &gt; The obvious difference in the logs which can cause your guest to fail
&gt; &gt; &gt; is the different QEMU version. The old log shows QEMU 5.2.0, while the
&gt; &gt; &gt; new log shows QEMU 6.0.0
&gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; thanks for the help, I went to look why the efi fw and found out that the nvram \
&gt; &gt; entry in /etc/libvirt/eqmu.conf was deleted upon update. I'm sure fixing this \
&gt; &gt; will solve he boot issue, hopefully audio issue too. 
&gt; &gt; Thanks,
&gt; &gt; 
&gt; &gt; Dagg.
&gt; &gt; 
&gt; 
&gt; unfortunately, that didn't helped, vm still wont come up, latest log at \
&gt; http://dpaste.com/2XZA4VQZA any ideas?
&gt; 

Seems like the issue is:

2021-07-16T10:29:19.259409Z qemu-system-x86_64: vfio: Cannot reset device \
0000:00:1f.3, no available reset mechanism. 2021-07-16T10:29:19.369391Z \
qemu-system-x86_64: vfio: Cannot reset device 0000:00:1f.3, no available reset \
mechanism.

did you upgrade anything else?

&gt; Dagg
&gt; 


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20210804083029</emailId><senderName>daggs</senderName><senderEmail>daggs@gmx.com</senderEmail><timestampReceived>2021-08-04 08:30:29-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>

Greetings Martin ,

&gt; Sent: Wednesday, August 04, 2021 at 11:11 AM
&gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; Cc: libvirt-users@redhat.com, dan@berrange.com
&gt; Subject: Re: issues with vm after upgrade
&gt; 
&gt; On Tue, Aug 03, 2021 at 08:47:20PM +0200, daggs wrote:
&gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:51 PM
&gt; &gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; To: dan@berrange.com
&gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; 
&gt; &gt; &gt; Greetings Daniel,
&gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:39 PM
&gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; On Tue, Aug 03, 2021 at 05:34:53PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:29 PM
&gt; &gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; On Tue, Aug 03, 2021 at 05:21:52PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Greetings Daniel,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 4:12 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;                 libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; The &lt;audio&gt; element just refers to the *host* backend used for audio
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; playback. It would not affect guest hardware. Further, this has \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; always existed - it just wasn't exposed in the XML previously.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; the upgrade changed something, here is the qemu cmd before the upgrade: \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; https://dpaste.com/F2N5T8CT8 here is after https://dpaste.com/F2N5T8CT8
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; Those links are both the same I'm afraid
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; Duh! my bad!
&gt; &gt; &gt; &gt; &gt; good log: http://dpaste.com/F2N5T8CT8
&gt; &gt; &gt; &gt; &gt; bad log: http://dpaste.com/6ECUHD2J8
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; The new log has a CLI flag
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; -audiodev id=audio1,driver=none
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; but the old log has an env variable
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; QEMU_AUDIO_DRV=none
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; which should be functionally identical, as QEMU will parse them both
&gt; &gt; &gt; &gt; to the same internal config.
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; The obvious difference in the logs which can cause your guest to fail
&gt; &gt; &gt; &gt; is the different QEMU version. The old log shows QEMU 5.2.0, while the
&gt; &gt; &gt; &gt; new log shows QEMU 6.0.0
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; thanks for the help, I went to look why the efi fw and found out that the nvram \
&gt; &gt; &gt; entry in /etc/libvirt/eqmu.conf was deleted upon update. I'm sure fixing this \
&gt; &gt; &gt; will solve he boot issue, hopefully audio issue too. 
&gt; &gt; &gt; Thanks,
&gt; &gt; &gt; 
&gt; &gt; &gt; Dagg.
&gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; unfortunately, that didn't helped, vm still wont come up, latest log at \
&gt; &gt; http://dpaste.com/2XZA4VQZA any ideas?
&gt; &gt; 
&gt; 
&gt; Seems like the issue is:
&gt; 
&gt; 2021-07-16T10:29:19.259409Z qemu-system-x86_64: vfio: Cannot reset device \
&gt; 0000:00:1f.3, no available reset mechanism. 2021-07-16T10:29:19.369391Z \
&gt; qemu-system-x86_64: vfio: Cannot reset device 0000:00:1f.3, no available reset \
&gt; mechanism. 
&gt; did you upgrade anything else?
&gt; 

are you sure? you can see the same prints in the good log at \
http://dpaste.com/F2N5T8CT8

Dagg


</body></email><email><emailId>20210804085211</emailId><senderName>Martin Kletzander</senderName><senderEmail>mkletzan@redhat.com</senderEmail><timestampReceived>2021-08-04 08:52:11-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>


On Wed, Aug 04, 2021 at 10:30:29AM +0200, daggs wrote:
&gt; Greetings Martin ,
&gt; 
&gt; &gt; Sent: Wednesday, August 04, 2021 at 11:11 AM
&gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; Cc: libvirt-users@redhat.com, dan@berrange.com
&gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; 
&gt; &gt; On Tue, Aug 03, 2021 at 08:47:20PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:51 PM
&gt; &gt; &gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; To: dan@berrange.com
&gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Greetings Daniel,
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:39 PM
&gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; On Tue, Aug 03, 2021 at 05:34:53PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:29 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; On Tue, Aug 03, 2021 at 05:21:52PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Greetings Daniel,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 4:12 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;                 libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; The &lt;audio&gt; element just refers to the *host* backend used for \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; audio playback. It would not affect guest hardware. Further, this \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; has always existed - it just wasn't exposed in the XML previously.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; the upgrade changed something, here is the qemu cmd before the \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; upgrade: https://dpaste.com/F2N5T8CT8 here is after \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; https://dpaste.com/F2N5T8CT8
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Those links are both the same I'm afraid
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; Duh! my bad!
&gt; &gt; &gt; &gt; &gt; &gt; good log: http://dpaste.com/F2N5T8CT8
&gt; &gt; &gt; &gt; &gt; &gt; bad log: http://dpaste.com/6ECUHD2J8
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; The new log has a CLI flag
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; -audiodev id=audio1,driver=none
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; but the old log has an env variable
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; QEMU_AUDIO_DRV=none
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; which should be functionally identical, as QEMU will parse them both
&gt; &gt; &gt; &gt; &gt; to the same internal config.
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; The obvious difference in the logs which can cause your guest to fail
&gt; &gt; &gt; &gt; &gt; is the different QEMU version. The old log shows QEMU 5.2.0, while the
&gt; &gt; &gt; &gt; &gt; new log shows QEMU 6.0.0
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; thanks for the help, I went to look why the efi fw and found out that the \
&gt; &gt; &gt; &gt; nvram entry in /etc/libvirt/eqmu.conf was deleted upon update. I'm sure \
&gt; &gt; &gt; &gt; fixing this will solve he boot issue, hopefully audio issue too. 
&gt; &gt; &gt; &gt; Thanks,
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Dagg.
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; unfortunately, that didn't helped, vm still wont come up, latest log at \
&gt; &gt; &gt; http://dpaste.com/2XZA4VQZA any ideas?
&gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; Seems like the issue is:
&gt; &gt; 
&gt; &gt; 2021-07-16T10:29:19.259409Z qemu-system-x86_64: vfio: Cannot reset device \
&gt; &gt; 0000:00:1f.3, no available reset mechanism. 2021-07-16T10:29:19.369391Z \
&gt; &gt; qemu-system-x86_64: vfio: Cannot reset device 0000:00:1f.3, no available reset \
&gt; &gt; mechanism. 
&gt; &gt; did you upgrade anything else?
&gt; &gt; 
&gt; 
&gt; are you sure? you can see the same prints in the good log at \
&gt; http://dpaste.com/F2N5T8CT8 

Oh, sorry, my bad.  Then I do not see why it would not start.  You said
you managed to make the VM start on your own, what was the change that
made it boot?  Maybe there's a bug somewhere in qemu...


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20210804105447</emailId><senderName>daggs</senderName><senderEmail>daggs@gmx.com</senderEmail><timestampReceived>2021-08-04 10:54:47-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>

Greetings Martin,

&gt; Sent: Wednesday, August 04, 2021 at 11:52 AM
&gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; Cc: libvirt-users@redhat.com, dan@berrange.com
&gt; Subject: Re: issues with vm after upgrade
&gt; 
&gt; On Wed, Aug 04, 2021 at 10:30:29AM +0200, daggs wrote:
&gt; &gt; Greetings Martin ,
&gt; &gt; 
&gt; &gt; &gt; Sent: Wednesday, August 04, 2021 at 11:11 AM
&gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; Cc: libvirt-users@redhat.com, dan@berrange.com
&gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; 
&gt; &gt; &gt; On Tue, Aug 03, 2021 at 08:47:20PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:51 PM
&gt; &gt; &gt; &gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; To: dan@berrange.com
&gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; Greetings Daniel,
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:39 PM
&gt; &gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; On Tue, Aug 03, 2021 at 05:34:53PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:29 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;                 libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; On Tue, Aug 03, 2021 at 05:21:52PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Greetings Daniel,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 4:12 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;                 libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; The &lt;audio&gt; element just refers to the *host* backend used for \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; audio playback. It would not affect guest hardware. Further, this \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; has always existed - it just wasn't exposed in the XML \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; previously. 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; the upgrade changed something, here is the qemu cmd before the \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; upgrade: https://dpaste.com/F2N5T8CT8 here is after \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; https://dpaste.com/F2N5T8CT8
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Those links are both the same I'm afraid
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Duh! my bad!
&gt; &gt; &gt; &gt; &gt; &gt; &gt; good log: http://dpaste.com/F2N5T8CT8
&gt; &gt; &gt; &gt; &gt; &gt; &gt; bad log: http://dpaste.com/6ECUHD2J8
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; The new log has a CLI flag
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; -audiodev id=audio1,driver=none
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; but the old log has an env variable
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; QEMU_AUDIO_DRV=none
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; which should be functionally identical, as QEMU will parse them both
&gt; &gt; &gt; &gt; &gt; &gt; to the same internal config.
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; The obvious difference in the logs which can cause your guest to fail
&gt; &gt; &gt; &gt; &gt; &gt; is the different QEMU version. The old log shows QEMU 5.2.0, while the
&gt; &gt; &gt; &gt; &gt; &gt; new log shows QEMU 6.0.0
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; thanks for the help, I went to look why the efi fw and found out that the \
&gt; &gt; &gt; &gt; &gt; nvram entry in /etc/libvirt/eqmu.conf was deleted upon update. I'm sure \
&gt; &gt; &gt; &gt; &gt; fixing this will solve he boot issue, hopefully audio issue too. 
&gt; &gt; &gt; &gt; &gt; Thanks,
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; Dagg.
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; unfortunately, that didn't helped, vm still wont come up, latest log at \
&gt; &gt; &gt; &gt; http://dpaste.com/2XZA4VQZA any ideas?
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; Seems like the issue is:
&gt; &gt; &gt; 
&gt; &gt; &gt; 2021-07-16T10:29:19.259409Z qemu-system-x86_64: vfio: Cannot reset device \
&gt; &gt; &gt; 0000:00:1f.3, no available reset mechanism. 2021-07-16T10:29:19.369391Z \
&gt; &gt; &gt; qemu-system-x86_64: vfio: Cannot reset device 0000:00:1f.3, no available reset \
&gt; &gt; &gt; mechanism. 
&gt; &gt; &gt; did you upgrade anything else?
&gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; are you sure? you can see the same prints in the good log at \
&gt; &gt; http://dpaste.com/F2N5T8CT8 
&gt; 
&gt; Oh, sorry, my bad.  Then I do not see why it would not start.  You said
&gt; you managed to make the VM start on your own, what was the change that
&gt; made it boot?  Maybe there's a bug somewhere in qemu...
&gt; 

since the upgrade I wasn't able to boot it using libvirt. however the following \
qemucmd works: qemu-system-x86_64 \
    -machine pc-q35-5.0,accel=kvm,usb=off,smm=on,dump-guest-core=off \
    -cpu host,migratable=on \
    -m 15360 \
    -smp 4,sockets=1,dies=1,cores=2,threads=2 \
    -drive file=/home/streamer/streamer.img.qcow2.new,if=virtio,format=qcow2 \
    -device vfio-pci,host=0000:00:02.0,romfile=/home/streamer/gpu-8086:5912-uefi.rom,multifunction=on \
                \
    -device vfio-pci,host=0000:00:1f.3,multifunction=on \
    -usb \
    -device usb-host,vendorid=0x046d,productid=0xc52e \
    -device usb-host,vendorid=0x2548,productid=0x1002 \
    -display none \
    -netdev tap,id=hostnet0,ifname=virtsw-streamer,script=no,downscript=no \
    -device e1000e,netdev=hostnet0,id=net0,mac=52:54:00:5a:4c:8c \
    -blockdev '{"driver":"file","filename":"/usr/share/edk2-ovmf/OVMF_CODE.secboot.fd","node-name":"libvirt-pflash0-storage","auto-read-only":true,"discard":"unmap"}' \
                \
    -blockdev '{"driver":"file","filename":"/var/lib/libvirt/qemu/nvram/streamer-vm-q3 \
5_VARS.fd","node-name":"libvirt-pflash1-storage","auto-readonly":true,"discard":"unmap"}'


Dagg


</body></email><email><emailId>20210810192100</emailId><senderName>daggs</senderName><senderEmail>daggs@gmx.com</senderEmail><timestampReceived>2021-08-10 19:21:00-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>

Greetings Martin, Dan

&gt; Sent: Wednesday, August 04, 2021 at 1:54 PM
&gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; To: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; Cc: libvirt-users@redhat.com, dan@berrange.com
&gt; Subject: Re: issues with vm after upgrade
&gt; 
&gt; Greetings Martin,
&gt; 
&gt; &gt; Sent: Wednesday, August 04, 2021 at 11:52 AM
&gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; Cc: libvirt-users@redhat.com, dan@berrange.com
&gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; 
&gt; &gt; On Wed, Aug 04, 2021 at 10:30:29AM +0200, daggs wrote:
&gt; &gt; &gt; Greetings Martin ,
&gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Sent: Wednesday, August 04, 2021 at 11:11 AM
&gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; Cc: libvirt-users@redhat.com, dan@berrange.com
&gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; On Tue, Aug 03, 2021 at 08:47:20PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:51 PM
&gt; &gt; &gt; &gt; &gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; To: dan@berrange.com
&gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; Greetings Daniel,
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:39 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; On Tue, Aug 03, 2021 at 05:34:53PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:29 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;                 libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; On Tue, Aug 03, 2021 at 05:21:52PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Greetings Daniel,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 4:12 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;                 libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; The &lt;audio&gt; element just refers to the *host* backend used for \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; audio playback. It would not affect guest hardware. Further, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; this has always existed - it just wasn't exposed in the XML \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; previously. 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; the upgrade changed something, here is the qemu cmd before the \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; upgrade: https://dpaste.com/F2N5T8CT8 here is after \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; https://dpaste.com/F2N5T8CT8
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Those links are both the same I'm afraid
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Duh! my bad!
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; good log: http://dpaste.com/F2N5T8CT8
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; bad log: http://dpaste.com/6ECUHD2J8
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; The new log has a CLI flag
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; -audiodev id=audio1,driver=none
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; but the old log has an env variable
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; QEMU_AUDIO_DRV=none
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; which should be functionally identical, as QEMU will parse them both
&gt; &gt; &gt; &gt; &gt; &gt; &gt; to the same internal config.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; The obvious difference in the logs which can cause your guest to fail
&gt; &gt; &gt; &gt; &gt; &gt; &gt; is the different QEMU version. The old log shows QEMU 5.2.0, while the
&gt; &gt; &gt; &gt; &gt; &gt; &gt; new log shows QEMU 6.0.0
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; thanks for the help, I went to look why the efi fw and found out that the \
&gt; &gt; &gt; &gt; &gt; &gt; nvram entry in /etc/libvirt/eqmu.conf was deleted upon update. I'm sure \
&gt; &gt; &gt; &gt; &gt; &gt; fixing this will solve he boot issue, hopefully audio issue too. 
&gt; &gt; &gt; &gt; &gt; &gt; Thanks,
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; Dagg.
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; unfortunately, that didn't helped, vm still wont come up, latest log at \
&gt; &gt; &gt; &gt; &gt; http://dpaste.com/2XZA4VQZA any ideas?
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Seems like the issue is:
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 2021-07-16T10:29:19.259409Z qemu-system-x86_64: vfio: Cannot reset device \
&gt; &gt; &gt; &gt; 0000:00:1f.3, no available reset mechanism. 2021-07-16T10:29:19.369391Z \
&gt; &gt; &gt; &gt; qemu-system-x86_64: vfio: Cannot reset device 0000:00:1f.3, no available \
&gt; &gt; &gt; &gt; reset mechanism. 
&gt; &gt; &gt; &gt; did you upgrade anything else?
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; are you sure? you can see the same prints in the good log at \
&gt; &gt; &gt; http://dpaste.com/F2N5T8CT8 
&gt; &gt; 
&gt; &gt; Oh, sorry, my bad.  Then I do not see why it would not start.  You said
&gt; &gt; you managed to make the VM start on your own, what was the change that
&gt; &gt; made it boot?  Maybe there's a bug somewhere in qemu...
&gt; &gt; 
&gt; 
&gt; since the upgrade I wasn't able to boot it using libvirt. however the following \
&gt; qemucmd works: qemu-system-x86_64 \
&gt; -machine pc-q35-5.0,accel=kvm,usb=off,smm=on,dump-guest-core=off \
&gt; -cpu host,migratable=on \
&gt; -m 15360 \
&gt; -smp 4,sockets=1,dies=1,cores=2,threads=2 \
&gt; -drive file=/home/streamer/streamer.img.qcow2.new,if=virtio,format=qcow2 \
&gt; -device vfio-pci,host=0000:00:02.0,romfile=/home/streamer/gpu-8086:5912-uefi.rom,multifunction=on \
&gt;                 \
&gt; -device vfio-pci,host=0000:00:1f.3,multifunction=on \
&gt; -usb \
&gt; -device usb-host,vendorid=0x046d,productid=0xc52e \
&gt; -device usb-host,vendorid=0x2548,productid=0x1002 \
&gt; -display none \
&gt; -netdev tap,id=hostnet0,ifname=virtsw-streamer,script=no,downscript=no \
&gt; -device e1000e,netdev=hostnet0,id=net0,mac=52:54:00:5a:4c:8c \
&gt; -blockdev '{"driver":"file","filename":"/usr/share/edk2-ovmf/OVMF_CODE.secboot.fd","node-name":"libvirt-pflash0-storage","auto-read-only":true,"discard":"unmap"}' \
&gt;                 \
&gt; -blockdev '{"driver":"file","filename":"/var/lib/libvirt/qemu/nvram/streamer-vm-q35_ \
&gt; VARS.fd","node-name":"libvirt-pflash1-storage","auto-readonly":true,"discard":"unmap"}'
&gt;  
&gt; Dagg
&gt; 

I was able to get the vm running again by creating the xml again. the only issue I'm \
                facing is the fact that only the one playback device is visible:
**** List of PLAYBACK Hardware Devices ****
card 0: PCH [HDA Intel PCH], device 0: ALC892 Analog [ALC892 Analog]
  Subdevices: 1/1
  Subdevice #0: subdevice #0
prior to the upgrade I had hdmi entries too.
I've check with two different oses and the issue persists.
as mentioned before, if I drop this line: -audiodev id=audio1,driver=none from the \
cmd, I see all the playback channels.

any idea?


</body></email><email><emailId>20210811071451</emailId><senderName>Martin Kletzander</senderName><senderEmail>mkletzan@redhat.com</senderEmail><timestampReceived>2021-08-11 07:14:51-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>


On Tue, Aug 10, 2021 at 09:21:00PM +0200, daggs wrote:
&gt; Greetings Martin, Dan
&gt; 
&gt; &gt; Sent: Wednesday, August 04, 2021 at 1:54 PM
&gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; To: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; Cc: libvirt-users@redhat.com, dan@berrange.com
&gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; 
&gt; &gt; Greetings Martin,
&gt; &gt; 
&gt; &gt; &gt; Sent: Wednesday, August 04, 2021 at 11:52 AM
&gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; Cc: libvirt-users@redhat.com, dan@berrange.com
&gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; 
&gt; &gt; &gt; On Wed, Aug 04, 2021 at 10:30:29AM +0200, daggs wrote:
&gt; &gt; &gt; &gt; Greetings Martin ,
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; Sent: Wednesday, August 04, 2021 at 11:11 AM
&gt; &gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; Cc: libvirt-users@redhat.com, dan@berrange.com
&gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; On Tue, Aug 03, 2021 at 08:47:20PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:51 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; To: dan@berrange.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Greetings Daniel,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:39 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;                 libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; On Tue, Aug 03, 2021 at 05:34:53PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:29 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;                 libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; On Tue, Aug 03, 2021 at 05:21:52PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Greetings Daniel,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 4:12 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;                 libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; The &lt;audio&gt; element just refers to the *host* backend used \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; for audio playback. It would not affect guest hardware. \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Further, this has always existed - it just wasn't exposed in \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; the XML previously. 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; the upgrade changed something, here is the qemu cmd before the \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; upgrade: https://dpaste.com/F2N5T8CT8 here is after \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; https://dpaste.com/F2N5T8CT8
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Those links are both the same I'm afraid
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Duh! my bad!
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; good log: http://dpaste.com/F2N5T8CT8
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; bad log: http://dpaste.com/6ECUHD2J8
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; The new log has a CLI flag
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; -audiodev id=audio1,driver=none
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; but the old log has an env variable
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; QEMU_AUDIO_DRV=none
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; which should be functionally identical, as QEMU will parse them both
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; to the same internal config.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; The obvious difference in the logs which can cause your guest to fail
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; is the different QEMU version. The old log shows QEMU 5.2.0, while \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; the new log shows QEMU 6.0.0
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; thanks for the help, I went to look why the efi fw and found out that \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; the nvram entry in /etc/libvirt/eqmu.conf was deleted upon update. I'm \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; sure fixing this will solve he boot issue, hopefully audio issue too. 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Thanks,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Dagg.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; unfortunately, that didn't helped, vm still wont come up, latest log at \
&gt; &gt; &gt; &gt; &gt; &gt; http://dpaste.com/2XZA4VQZA any ideas?
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; Seems like the issue is:
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; 2021-07-16T10:29:19.259409Z qemu-system-x86_64: vfio: Cannot reset device \
&gt; &gt; &gt; &gt; &gt; 0000:00:1f.3, no available reset mechanism. 2021-07-16T10:29:19.369391Z \
&gt; &gt; &gt; &gt; &gt; qemu-system-x86_64: vfio: Cannot reset device 0000:00:1f.3, no available \
&gt; &gt; &gt; &gt; &gt; reset mechanism. 
&gt; &gt; &gt; &gt; &gt; did you upgrade anything else?
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; are you sure? you can see the same prints in the good log at \
&gt; &gt; &gt; &gt; http://dpaste.com/F2N5T8CT8 
&gt; &gt; &gt; 
&gt; &gt; &gt; Oh, sorry, my bad.  Then I do not see why it would not start.  You said
&gt; &gt; &gt; you managed to make the VM start on your own, what was the change that
&gt; &gt; &gt; made it boot?  Maybe there's a bug somewhere in qemu...
&gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; since the upgrade I wasn't able to boot it using libvirt. however the following \
&gt; &gt; qemucmd works: qemu-system-x86_64 \
&gt; &gt; -machine pc-q35-5.0,accel=kvm,usb=off,smm=on,dump-guest-core=off \
&gt; &gt; -cpu host,migratable=on \
&gt; &gt; -m 15360 \
&gt; &gt; -smp 4,sockets=1,dies=1,cores=2,threads=2 \
&gt; &gt; -drive file=/home/streamer/streamer.img.qcow2.new,if=virtio,format=qcow2 \
&gt; &gt; -device vfio-pci,host=0000:00:02.0,romfile=/home/streamer/gpu-8086:5912-uefi.rom,multifunction=on \
&gt; &gt;                 \
&gt; &gt; -device vfio-pci,host=0000:00:1f.3,multifunction=on \
&gt; &gt; -usb \
&gt; &gt; -device usb-host,vendorid=0x046d,productid=0xc52e \
&gt; &gt; -device usb-host,vendorid=0x2548,productid=0x1002 \
&gt; &gt; -display none \
&gt; &gt; -netdev tap,id=hostnet0,ifname=virtsw-streamer,script=no,downscript=no \
&gt; &gt; -device e1000e,netdev=hostnet0,id=net0,mac=52:54:00:5a:4c:8c \
&gt; &gt; -blockdev '{"driver":"file","filename":"/usr/share/edk2-ovmf/OVMF_CODE.secboot.fd","node-name":"libvirt-pflash0-storage","auto-read-only":true,"discard":"unmap"}' \
&gt; &gt;                 \
&gt; &gt; -blockdev '{"driver":"file","filename":"/var/lib/libvirt/qemu/nvram/streamer-vm-q3 \
&gt; &gt; 5_VARS.fd","node-name":"libvirt-pflash1-storage","auto-readonly":true,"discard":"unmap"}'
&gt; &gt;  
&gt; &gt; Dagg
&gt; &gt; 
&gt; 
&gt; I was able to get the vm running again by creating the xml again. the only issue \
&gt;                 I'm facing is the fact that only the one playback device is \
&gt;                 visible:
&gt; **** List of PLAYBACK Hardware Devices ****
&gt; card 0: PCH [HDA Intel PCH], device 0: ALC892 Analog [ALC892 Analog]
&gt; Subdevices: 1/1
&gt; Subdevice #0: subdevice #0
&gt; prior to the upgrade I had hdmi entries too.
&gt; I've check with two different oses and the issue persists.
&gt; as mentioned before, if I drop this line: -audiodev id=audio1,driver=none from the \
&gt; cmd, I see all the playback channels. 
&gt; any idea?
&gt; 

So to clean up this thread let me reply to the two issues separately.

1) if your device-assigned audio is not visible with '-audiodev
    id=audio1,driver=none', but *is* visible with QEMU_AUDIO_DRV=none,
    then that is a bug in QEMU and needs to be dealt with there.

2) To your issue with starting the domain it would be good to know what
    is the error you get from virsh (or however you are starting the
    domain) and the debug logs of libvirtd, ideally just for the part of
    the domain starting.

Martin


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20210811130934</emailId><senderName>daggs</senderName><senderEmail>daggs@gmx.com</senderEmail><timestampReceived>2021-08-11 13:09:34-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>

Greetings Martin,

&gt; Sent: Wednesday, August 11, 2021 at 10:14 AM
&gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; Subject: Re: issues with vm after upgrade
&gt; 
&gt; On Tue, Aug 10, 2021 at 09:21:00PM +0200, daggs wrote:
&gt; &gt; Greetings Martin, Dan
&gt; &gt; 
&gt; &gt; &gt; Sent: Wednesday, August 04, 2021 at 1:54 PM
&gt; &gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; To: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; Cc: libvirt-users@redhat.com, dan@berrange.com
&gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; 
&gt; &gt; &gt; Greetings Martin,
&gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Sent: Wednesday, August 04, 2021 at 11:52 AM
&gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; Cc: libvirt-users@redhat.com, dan@berrange.com
&gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; On Wed, Aug 04, 2021 at 10:30:29AM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; Greetings Martin ,
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; Sent: Wednesday, August 04, 2021 at 11:11 AM
&gt; &gt; &gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; Cc: libvirt-users@redhat.com, dan@berrange.com
&gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; On Tue, Aug 03, 2021 at 08:47:20PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:51 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: dan@berrange.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;                 libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Greetings Daniel,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:39 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;                 libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; On Tue, Aug 03, 2021 at 05:34:53PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:29 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;                 libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; On Tue, Aug 03, 2021 at 05:21:52PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Greetings Daniel,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 4:12 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;                 libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; The &lt;audio&gt; element just refers to the *host* backend used \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; for audio playback. It would not affect guest hardware. \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Further, this has always existed - it just wasn't exposed \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; in the XML previously. 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; the upgrade changed something, here is the qemu cmd before \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; the upgrade: https://dpaste.com/F2N5T8CT8 here is after \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; https://dpaste.com/F2N5T8CT8
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Those links are both the same I'm afraid
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Duh! my bad!
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; good log: http://dpaste.com/F2N5T8CT8
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; bad log: http://dpaste.com/6ECUHD2J8
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; The new log has a CLI flag
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; -audiodev id=audio1,driver=none
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; but the old log has an env variable
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; QEMU_AUDIO_DRV=none
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; which should be functionally identical, as QEMU will parse them \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; both to the same internal config.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; The obvious difference in the logs which can cause your guest to \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; fail is the different QEMU version. The old log shows QEMU 5.2.0, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; while the new log shows QEMU 6.0.0
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; thanks for the help, I went to look why the efi fw and found out that \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; the nvram entry in /etc/libvirt/eqmu.conf was deleted upon update. \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; I'm sure fixing this will solve he boot issue, hopefully audio issue \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; too. 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Thanks,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Dagg.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; unfortunately, that didn't helped, vm still wont come up, latest log at \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; http://dpaste.com/2XZA4VQZA any ideas?
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; Seems like the issue is:
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; 2021-07-16T10:29:19.259409Z qemu-system-x86_64: vfio: Cannot reset device \
&gt; &gt; &gt; &gt; &gt; &gt; 0000:00:1f.3, no available reset mechanism. 2021-07-16T10:29:19.369391Z \
&gt; &gt; &gt; &gt; &gt; &gt; qemu-system-x86_64: vfio: Cannot reset device 0000:00:1f.3, no available \
&gt; &gt; &gt; &gt; &gt; &gt; reset mechanism. 
&gt; &gt; &gt; &gt; &gt; &gt; did you upgrade anything else?
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; are you sure? you can see the same prints in the good log at \
&gt; &gt; &gt; &gt; &gt; http://dpaste.com/F2N5T8CT8 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Oh, sorry, my bad.  Then I do not see why it would not start.  You said
&gt; &gt; &gt; &gt; you managed to make the VM start on your own, what was the change that
&gt; &gt; &gt; &gt; made it boot?  Maybe there's a bug somewhere in qemu...
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; since the upgrade I wasn't able to boot it using libvirt. however the following \
&gt; &gt; &gt; qemucmd works: qemu-system-x86_64 \
&gt; &gt; &gt; -machine pc-q35-5.0,accel=kvm,usb=off,smm=on,dump-guest-core=off \
&gt; &gt; &gt; -cpu host,migratable=on \
&gt; &gt; &gt; -m 15360 \
&gt; &gt; &gt; -smp 4,sockets=1,dies=1,cores=2,threads=2 \
&gt; &gt; &gt; -drive file=/home/streamer/streamer.img.qcow2.new,if=virtio,format=qcow2 \
&gt; &gt; &gt; -device vfio-pci,host=0000:00:02.0,romfile=/home/streamer/gpu-8086:5912-uefi.rom,multifunction=on \
&gt; &gt; &gt;                 \
&gt; &gt; &gt; -device vfio-pci,host=0000:00:1f.3,multifunction=on \
&gt; &gt; &gt; -usb \
&gt; &gt; &gt; -device usb-host,vendorid=0x046d,productid=0xc52e \
&gt; &gt; &gt; -device usb-host,vendorid=0x2548,productid=0x1002 \
&gt; &gt; &gt; -display none \
&gt; &gt; &gt; -netdev tap,id=hostnet0,ifname=virtsw-streamer,script=no,downscript=no \
&gt; &gt; &gt; -device e1000e,netdev=hostnet0,id=net0,mac=52:54:00:5a:4c:8c \
&gt; &gt; &gt; -blockdev '{"driver":"file","filename":"/usr/share/edk2-ovmf/OVMF_CODE.secboot.f \
&gt; &gt; &gt; d","node-name":"libvirt-pflash0-storage","auto-read-only":true,"discard":"unmap"}' \
&gt; &gt; &gt;                 \
&gt; &gt; &gt; -blockdev '{"driver":"file","filename":"/var/lib/libvirt/qemu/nvram/streamer-vm- \
&gt; &gt; &gt; q35_VARS.fd","node-name":"libvirt-pflash1-storage","auto-readonly":true,"discard":"unmap"}'
&gt; &gt; &gt;  
&gt; &gt; &gt; Dagg
&gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; I was able to get the vm running again by creating the xml again. the only issue \
&gt; &gt;                 I'm facing is the fact that only the one playback device is \
&gt; &gt;                 visible:
&gt; &gt; **** List of PLAYBACK Hardware Devices ****
&gt; &gt; card 0: PCH [HDA Intel PCH], device 0: ALC892 Analog [ALC892 Analog]
&gt; &gt; Subdevices: 1/1
&gt; &gt; Subdevice #0: subdevice #0
&gt; &gt; prior to the upgrade I had hdmi entries too.
&gt; &gt; I've check with two different oses and the issue persists.
&gt; &gt; as mentioned before, if I drop this line: -audiodev id=audio1,driver=none from \
&gt; &gt; the cmd, I see all the playback channels. 
&gt; &gt; any idea?
&gt; &gt; 
&gt; 
&gt; So to clean up this thread let me reply to the two issues separately.
&gt; 
&gt; 1) if your device-assigned audio is not visible with '-audiodev
&gt; id=audio1,driver=none', but *is* visible with QEMU_AUDIO_DRV=none,
&gt; then that is a bug in QEMU and needs to be dealt with there.
I'll ping the eqmu devs on this.

&gt; 
&gt; 2) To your issue with starting the domain it would be good to know what
&gt; is the error you get from virsh (or however you are starting the
&gt; domain) and the debug logs of libvirtd, ideally just for the part of
&gt; the domain starting.
that is the issue, there wasn't any error. the vm just didn't booted.
I can diff the original xml with the new one to see the diffs and post them here if \
you wish

Dagg.


</body></email><email><emailId>20210811131344</emailId><senderName>Martin Kletzander</senderName><senderEmail>mkletzan@redhat.com</senderEmail><timestampReceived>2021-08-11 13:13:44-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>


On Wed, Aug 11, 2021 at 03:09:34PM +0200, daggs wrote:
&gt; Greetings Martin,
&gt; 
&gt; &gt; Sent: Wednesday, August 11, 2021 at 10:14 AM
&gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; 
&gt; &gt; On Tue, Aug 10, 2021 at 09:21:00PM +0200, daggs wrote:
&gt; &gt; &gt; Greetings Martin, Dan
&gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Sent: Wednesday, August 04, 2021 at 1:54 PM
&gt; &gt; &gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; To: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; Cc: libvirt-users@redhat.com, dan@berrange.com
&gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Greetings Martin,
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; Sent: Wednesday, August 04, 2021 at 11:52 AM
&gt; &gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; Cc: libvirt-users@redhat.com, dan@berrange.com
&gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; On Wed, Aug 04, 2021 at 10:30:29AM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; Greetings Martin ,
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Wednesday, August 04, 2021 at 11:11 AM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: libvirt-users@redhat.com, dan@berrange.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; On Tue, Aug 03, 2021 at 08:47:20PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:51 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: dan@berrange.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;                 libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Greetings Daniel,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:39 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;                 libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; On Tue, Aug 03, 2021 at 05:34:53PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:29 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;                 libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; On Tue, Aug 03, 2021 at 05:21:52PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Greetings Daniel,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 4:12 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;                 libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; The &lt;audio&gt; element just refers to the *host* backend \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; used for audio playback. It would not affect guest \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; hardware. Further, this has always existed - it just \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; wasn't exposed in the XML previously. 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; the upgrade changed something, here is the qemu cmd before \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; the upgrade: https://dpaste.com/F2N5T8CT8 here is after \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; https://dpaste.com/F2N5T8CT8
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Those links are both the same I'm afraid
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Duh! my bad!
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; good log: http://dpaste.com/F2N5T8CT8
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; bad log: http://dpaste.com/6ECUHD2J8
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; The new log has a CLI flag
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; -audiodev id=audio1,driver=none
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; but the old log has an env variable
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; QEMU_AUDIO_DRV=none
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; which should be functionally identical, as QEMU will parse them \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; both to the same internal config.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; The obvious difference in the logs which can cause your guest to \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; fail is the different QEMU version. The old log shows QEMU 5.2.0, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; while the new log shows QEMU 6.0.0
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; thanks for the help, I went to look why the efi fw and found out \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; that the nvram entry in /etc/libvirt/eqmu.conf was deleted upon \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; update. I'm sure fixing this will solve he boot issue, hopefully \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; audio issue too. 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Thanks,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Dagg.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; unfortunately, that didn't helped, vm still wont come up, latest log \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; at http://dpaste.com/2XZA4VQZA any ideas?
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Seems like the issue is:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 2021-07-16T10:29:19.259409Z qemu-system-x86_64: vfio: Cannot reset \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; device 0000:00:1f.3, no available reset mechanism. \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 2021-07-16T10:29:19.369391Z qemu-system-x86_64: vfio: Cannot reset \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; device 0000:00:1f.3, no available reset mechanism. 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; did you upgrade anything else?
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; are you sure? you can see the same prints in the good log at \
&gt; &gt; &gt; &gt; &gt; &gt; http://dpaste.com/F2N5T8CT8 
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; Oh, sorry, my bad.  Then I do not see why it would not start.  You said
&gt; &gt; &gt; &gt; &gt; you managed to make the VM start on your own, what was the change that
&gt; &gt; &gt; &gt; &gt; made it boot?  Maybe there's a bug somewhere in qemu...
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; since the upgrade I wasn't able to boot it using libvirt. however the \
&gt; &gt; &gt; &gt; following qemucmd works: qemu-system-x86_64 \
&gt; &gt; &gt; &gt; -machine pc-q35-5.0,accel=kvm,usb=off,smm=on,dump-guest-core=off \
&gt; &gt; &gt; &gt; -cpu host,migratable=on \
&gt; &gt; &gt; &gt; -m 15360 \
&gt; &gt; &gt; &gt; -smp 4,sockets=1,dies=1,cores=2,threads=2 \
&gt; &gt; &gt; &gt; -drive file=/home/streamer/streamer.img.qcow2.new,if=virtio,format=qcow2 \
&gt; &gt; &gt; &gt; -device vfio-pci,host=0000:00:02.0,romfile=/home/streamer/gpu-8086:5912-uefi.rom,multifunction=on \
&gt; &gt; &gt; &gt;                 \
&gt; &gt; &gt; &gt; -device vfio-pci,host=0000:00:1f.3,multifunction=on \
&gt; &gt; &gt; &gt; -usb \
&gt; &gt; &gt; &gt; -device usb-host,vendorid=0x046d,productid=0xc52e \
&gt; &gt; &gt; &gt; -device usb-host,vendorid=0x2548,productid=0x1002 \
&gt; &gt; &gt; &gt; -display none \
&gt; &gt; &gt; &gt; -netdev tap,id=hostnet0,ifname=virtsw-streamer,script=no,downscript=no \
&gt; &gt; &gt; &gt; -device e1000e,netdev=hostnet0,id=net0,mac=52:54:00:5a:4c:8c \
&gt; &gt; &gt; &gt; -blockdev '{"driver":"file","filename":"/usr/share/edk2-ovmf/OVMF_CODE.secboot \
&gt; &gt; &gt; &gt; .fd","node-name":"libvirt-pflash0-storage","auto-read-only":true,"discard":"unmap"}' \
&gt; &gt; &gt; &gt;                 \
&gt; &gt; &gt; &gt; -blockdev '{"driver":"file","filename":"/var/lib/libvirt/qemu/nvram/streamer-v \
&gt; &gt; &gt; &gt; m-q35_VARS.fd","node-name":"libvirt-pflash1-storage","auto-readonly":true,"discard":"unmap"}'
&gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt; Dagg
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; I was able to get the vm running again by creating the xml again. the only \
&gt; &gt; &gt;                 issue I'm facing is the fact that only the one playback device \
&gt; &gt; &gt;                 is visible:
&gt; &gt; &gt; **** List of PLAYBACK Hardware Devices ****
&gt; &gt; &gt; card 0: PCH [HDA Intel PCH], device 0: ALC892 Analog [ALC892 Analog]
&gt; &gt; &gt; Subdevices: 1/1
&gt; &gt; &gt; Subdevice #0: subdevice #0
&gt; &gt; &gt; prior to the upgrade I had hdmi entries too.
&gt; &gt; &gt; I've check with two different oses and the issue persists.
&gt; &gt; &gt; as mentioned before, if I drop this line: -audiodev id=audio1,driver=none from \
&gt; &gt; &gt; the cmd, I see all the playback channels. 
&gt; &gt; &gt; any idea?
&gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; So to clean up this thread let me reply to the two issues separately.
&gt; &gt; 
&gt; &gt; 1) if your device-assigned audio is not visible with '-audiodev
&gt; &gt; id=audio1,driver=none', but *is* visible with QEMU_AUDIO_DRV=none,
&gt; &gt; then that is a bug in QEMU and needs to be dealt with there.
&gt; I'll ping the eqmu devs on this.
&gt; 
&gt; &gt; 
&gt; &gt; 2) To your issue with starting the domain it would be good to know what
&gt; &gt; is the error you get from virsh (or however you are starting the
&gt; &gt; domain) and the debug logs of libvirtd, ideally just for the part of
&gt; &gt; the domain starting.
&gt; that is the issue, there wasn't any error. the vm just didn't booted.

Oh, so I misunderstood.  What was the state of the VM in libvirt?
"paused" or "running"?  Was there serial console working?

&gt; I can diff the original xml with the new one to see the diffs and post them here if \
&gt; you wish 

Would be nice to see if there are any differences.  The newly created
one works then?

&gt; Dagg.
&gt; 


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20210811150825</emailId><senderName>daggs</senderName><senderEmail>daggs@gmx.com</senderEmail><timestampReceived>2021-08-11 15:08:25-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>

Greetings Martin,

&gt; Sent: Wednesday, August 11, 2021 at 4:13 PM
&gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; Subject: Re: issues with vm after upgrade
&gt; 
&gt; On Wed, Aug 11, 2021 at 03:09:34PM +0200, daggs wrote:
&gt; &gt; Greetings Martin,
&gt; &gt; 
&gt; &gt; &gt; Sent: Wednesday, August 11, 2021 at 10:14 AM
&gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; 
&gt; &gt; &gt; On Tue, Aug 10, 2021 at 09:21:00PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; Greetings Martin, Dan
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; Sent: Wednesday, August 04, 2021 at 1:54 PM
&gt; &gt; &gt; &gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; To: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; Cc: libvirt-users@redhat.com, dan@berrange.com
&gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; Greetings Martin,
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; Sent: Wednesday, August 04, 2021 at 11:52 AM
&gt; &gt; &gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; Cc: libvirt-users@redhat.com, dan@berrange.com
&gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; On Wed, Aug 04, 2021 at 10:30:29AM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Greetings Martin ,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Wednesday, August 04, 2021 at 11:11 AM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: libvirt-users@redhat.com, dan@berrange.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; On Tue, Aug 03, 2021 at 08:47:20PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:51 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: dan@berrange.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;                 libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Greetings Daniel,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:39 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;                 libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; On Tue, Aug 03, 2021 at 05:34:53PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:29 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;                 libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; On Tue, Aug 03, 2021 at 05:21:52PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Greetings Daniel,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 4:12 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;                 libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; The &lt;audio&gt; element just refers to the *host* backend \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; used for audio playback. It would not affect guest \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; hardware. Further, this has always existed - it just \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; wasn't exposed in the XML previously. 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; the upgrade changed something, here is the qemu cmd \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; before the upgrade: https://dpaste.com/F2N5T8CT8 here is \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; after https://dpaste.com/F2N5T8CT8
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Those links are both the same I'm afraid
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Duh! my bad!
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; good log: http://dpaste.com/F2N5T8CT8
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; bad log: http://dpaste.com/6ECUHD2J8
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; The new log has a CLI flag
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; -audiodev id=audio1,driver=none
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; but the old log has an env variable
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; QEMU_AUDIO_DRV=none
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; which should be functionally identical, as QEMU will parse them \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; both to the same internal config.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; The obvious difference in the logs which can cause your guest \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; to fail is the different QEMU version. The old log shows QEMU \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 5.2.0, while the new log shows QEMU 6.0.0
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; thanks for the help, I went to look why the efi fw and found out \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; that the nvram entry in /etc/libvirt/eqmu.conf was deleted upon \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; update. I'm sure fixing this will solve he boot issue, hopefully \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; audio issue too. 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Thanks,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Dagg.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; unfortunately, that didn't helped, vm still wont come up, latest \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; log at http://dpaste.com/2XZA4VQZA any ideas?
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Seems like the issue is:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 2021-07-16T10:29:19.259409Z qemu-system-x86_64: vfio: Cannot reset \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; device 0000:00:1f.3, no available reset mechanism. \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 2021-07-16T10:29:19.369391Z qemu-system-x86_64: vfio: Cannot reset \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; device 0000:00:1f.3, no available reset mechanism. 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; did you upgrade anything else?
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; are you sure? you can see the same prints in the good log at \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; http://dpaste.com/F2N5T8CT8 
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; Oh, sorry, my bad.  Then I do not see why it would not start.  You said
&gt; &gt; &gt; &gt; &gt; &gt; you managed to make the VM start on your own, what was the change that
&gt; &gt; &gt; &gt; &gt; &gt; made it boot?  Maybe there's a bug somewhere in qemu...
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; since the upgrade I wasn't able to boot it using libvirt. however the \
&gt; &gt; &gt; &gt; &gt; following qemucmd works: qemu-system-x86_64 \
&gt; &gt; &gt; &gt; &gt; -machine pc-q35-5.0,accel=kvm,usb=off,smm=on,dump-guest-core=off \
&gt; &gt; &gt; &gt; &gt; -cpu host,migratable=on \
&gt; &gt; &gt; &gt; &gt; -m 15360 \
&gt; &gt; &gt; &gt; &gt; -smp 4,sockets=1,dies=1,cores=2,threads=2 \
&gt; &gt; &gt; &gt; &gt; -drive file=/home/streamer/streamer.img.qcow2.new,if=virtio,format=qcow2 \
&gt; &gt; &gt; &gt; &gt; -device vfio-pci,host=0000:00:02.0,romfile=/home/streamer/gpu-8086:5912-uefi.rom,multifunction=on \
&gt; &gt; &gt; &gt; &gt;                 \
&gt; &gt; &gt; &gt; &gt; -device vfio-pci,host=0000:00:1f.3,multifunction=on \
&gt; &gt; &gt; &gt; &gt; -usb \
&gt; &gt; &gt; &gt; &gt; -device usb-host,vendorid=0x046d,productid=0xc52e \
&gt; &gt; &gt; &gt; &gt; -device usb-host,vendorid=0x2548,productid=0x1002 \
&gt; &gt; &gt; &gt; &gt; -display none \
&gt; &gt; &gt; &gt; &gt; -netdev tap,id=hostnet0,ifname=virtsw-streamer,script=no,downscript=no \
&gt; &gt; &gt; &gt; &gt; -device e1000e,netdev=hostnet0,id=net0,mac=52:54:00:5a:4c:8c \
&gt; &gt; &gt; &gt; &gt; -blockdev '{"driver":"file","filename":"/usr/share/edk2-ovmf/OVMF_CODE.secbo \
&gt; &gt; &gt; &gt; &gt; ot.fd","node-name":"libvirt-pflash0-storage","auto-read-only":true,"discard":"unmap"}' \
&gt; &gt; &gt; &gt; &gt;                 \
&gt; &gt; &gt; &gt; &gt; -blockdev '{"driver":"file","filename":"/var/lib/libvirt/qemu/nvram/streamer \
&gt; &gt; &gt; &gt; &gt; -vm-q35_VARS.fd","node-name":"libvirt-pflash1-storage","auto-readonly":true,"discard":"unmap"}'
&gt; &gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt; &gt; Dagg
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; I was able to get the vm running again by creating the xml again. the only \
&gt; &gt; &gt; &gt;                 issue I'm facing is the fact that only the one playback \
&gt; &gt; &gt; &gt;                 device is visible:
&gt; &gt; &gt; &gt; **** List of PLAYBACK Hardware Devices ****
&gt; &gt; &gt; &gt; card 0: PCH [HDA Intel PCH], device 0: ALC892 Analog [ALC892 Analog]
&gt; &gt; &gt; &gt; Subdevices: 1/1
&gt; &gt; &gt; &gt; Subdevice #0: subdevice #0
&gt; &gt; &gt; &gt; prior to the upgrade I had hdmi entries too.
&gt; &gt; &gt; &gt; I've check with two different oses and the issue persists.
&gt; &gt; &gt; &gt; as mentioned before, if I drop this line: -audiodev id=audio1,driver=none \
&gt; &gt; &gt; &gt; from the cmd, I see all the playback channels. 
&gt; &gt; &gt; &gt; any idea?
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; So to clean up this thread let me reply to the two issues separately.
&gt; &gt; &gt; 
&gt; &gt; &gt; 1) if your device-assigned audio is not visible with '-audiodev
&gt; &gt; &gt; id=audio1,driver=none', but *is* visible with QEMU_AUDIO_DRV=none,
&gt; &gt; &gt; then that is a bug in QEMU and needs to be dealt with there.
&gt; &gt; I'll ping the eqmu devs on this.
&gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; 2) To your issue with starting the domain it would be good to know what
&gt; &gt; &gt; is the error you get from virsh (or however you are starting the
&gt; &gt; &gt; domain) and the debug logs of libvirtd, ideally just for the part of
&gt; &gt; &gt; the domain starting.
&gt; &gt; that is the issue, there wasn't any error. the vm just didn't booted.
&gt; 
&gt; Oh, so I misunderstood.  What was the state of the VM in libvirt?
&gt; "paused" or "running"?  Was there serial console working?
it was marked as running and there was no serial

&gt; 
&gt; &gt; I can diff the original xml with the new one to see the diffs and post them here \
&gt; &gt; if you wish 
&gt; 
&gt; Would be nice to see if there are any differences.  The newly created
&gt; one works then?
&gt; 

I'll sent it later today


</body></email><email><emailId>20210811185310</emailId><senderName>daggs</senderName><senderEmail>daggs@gmx.com</senderEmail><timestampReceived>2021-08-11 18:53:10-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>

Greetings Martin,


&gt; Sent: Wednesday, August 11, 2021 at 6:08 PM
&gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; To: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; Subject: Re: issues with vm after upgrade
&gt; 
&gt; Greetings Martin,
&gt; 
&gt; &gt; Sent: Wednesday, August 11, 2021 at 4:13 PM
&gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; 
&gt; &gt; On Wed, Aug 11, 2021 at 03:09:34PM +0200, daggs wrote:
&gt; &gt; &gt; Greetings Martin,
&gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Sent: Wednesday, August 11, 2021 at 10:14 AM
&gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; On Tue, Aug 10, 2021 at 09:21:00PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; Greetings Martin, Dan
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; Sent: Wednesday, August 04, 2021 at 1:54 PM
&gt; &gt; &gt; &gt; &gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; To: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; Cc: libvirt-users@redhat.com, dan@berrange.com
&gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; Greetings Martin,
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Wednesday, August 04, 2021 at 11:52 AM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: libvirt-users@redhat.com, dan@berrange.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; On Wed, Aug 04, 2021 at 10:30:29AM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Greetings Martin ,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Wednesday, August 04, 2021 at 11:11 AM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: libvirt-users@redhat.com, dan@berrange.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; On Tue, Aug 03, 2021 at 08:47:20PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:51 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: dan@berrange.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;                 libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Greetings Daniel,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:39 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;                 libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; On Tue, Aug 03, 2021 at 05:34:53PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 6:29 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;                 libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; On Tue, Aug 03, 2021 at 05:21:52PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Greetings Daniel,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Tuesday, August 03, 2021 at 4:12 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;                 libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; The &lt;audio&gt; element just refers to the *host* backend \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; used for audio playback. It would not affect guest \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; hardware. Further, this has always existed - it just \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; wasn't exposed in the XML previously. 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; the upgrade changed something, here is the qemu cmd \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; before the upgrade: https://dpaste.com/F2N5T8CT8 here \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; is after https://dpaste.com/F2N5T8CT8
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Those links are both the same I'm afraid
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Duh! my bad!
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; good log: http://dpaste.com/F2N5T8CT8
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; bad log: http://dpaste.com/6ECUHD2J8
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; The new log has a CLI flag
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; -audiodev id=audio1,driver=none
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; but the old log has an env variable
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; QEMU_AUDIO_DRV=none
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; which should be functionally identical, as QEMU will parse \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; them both to the same internal config.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; The obvious difference in the logs which can cause your guest \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; to fail is the different QEMU version. The old log shows QEMU \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 5.2.0, while the new log shows QEMU 6.0.0
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; thanks for the help, I went to look why the efi fw and found \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; out that the nvram entry in /etc/libvirt/eqmu.conf was deleted \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; upon update. I'm sure fixing this will solve he boot issue, \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; hopefully audio issue too. 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Thanks,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Dagg.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; unfortunately, that didn't helped, vm still wont come up, latest \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; log at http://dpaste.com/2XZA4VQZA any ideas?
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Seems like the issue is:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 2021-07-16T10:29:19.259409Z qemu-system-x86_64: vfio: Cannot reset \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; device 0000:00:1f.3, no available reset mechanism. \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 2021-07-16T10:29:19.369391Z qemu-system-x86_64: vfio: Cannot reset \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; device 0000:00:1f.3, no available reset mechanism. 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; did you upgrade anything else?
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; are you sure? you can see the same prints in the good log at \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; http://dpaste.com/F2N5T8CT8 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Oh, sorry, my bad.  Then I do not see why it would not start.  You said
&gt; &gt; &gt; &gt; &gt; &gt; &gt; you managed to make the VM start on your own, what was the change that
&gt; &gt; &gt; &gt; &gt; &gt; &gt; made it boot?  Maybe there's a bug somewhere in qemu...
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; since the upgrade I wasn't able to boot it using libvirt. however the \
&gt; &gt; &gt; &gt; &gt; &gt; following qemucmd works: qemu-system-x86_64 \
&gt; &gt; &gt; &gt; &gt; &gt; -machine pc-q35-5.0,accel=kvm,usb=off,smm=on,dump-guest-core=off \
&gt; &gt; &gt; &gt; &gt; &gt; -cpu host,migratable=on \
&gt; &gt; &gt; &gt; &gt; &gt; -m 15360 \
&gt; &gt; &gt; &gt; &gt; &gt; -smp 4,sockets=1,dies=1,cores=2,threads=2 \
&gt; &gt; &gt; &gt; &gt; &gt; -drive file=/home/streamer/streamer.img.qcow2.new,if=virtio,format=qcow2 \
&gt; &gt; &gt; &gt; &gt; &gt;                 \
&gt; &gt; &gt; &gt; &gt; &gt; -device vfio-pci,host=0000:00:02.0,romfile=/home/streamer/gpu-8086:5912-uefi.rom,multifunction=on \
&gt; &gt; &gt; &gt; &gt; &gt;                 \
&gt; &gt; &gt; &gt; &gt; &gt; -device vfio-pci,host=0000:00:1f.3,multifunction=on \
&gt; &gt; &gt; &gt; &gt; &gt; -usb \
&gt; &gt; &gt; &gt; &gt; &gt; -device usb-host,vendorid=0x046d,productid=0xc52e \
&gt; &gt; &gt; &gt; &gt; &gt; -device usb-host,vendorid=0x2548,productid=0x1002 \
&gt; &gt; &gt; &gt; &gt; &gt; -display none \
&gt; &gt; &gt; &gt; &gt; &gt; -netdev tap,id=hostnet0,ifname=virtsw-streamer,script=no,downscript=no \
&gt; &gt; &gt; &gt; &gt; &gt; -device e1000e,netdev=hostnet0,id=net0,mac=52:54:00:5a:4c:8c \
&gt; &gt; &gt; &gt; &gt; &gt; -blockdev \
&gt; &gt; &gt; &gt; &gt; &gt; '{"driver":"file","filename":"/usr/share/edk2-ovmf/OVMF_CODE.secboot.fd","node-name":"libvirt-pflash0-storage","auto-read-only":true,"discard":"unmap"}' \
&gt; &gt; &gt; &gt; &gt; &gt;                 \
&gt; &gt; &gt; &gt; &gt; &gt; -blockdev \
&gt; &gt; &gt; &gt; &gt; &gt; '{"driver":"file","filename":"/var/lib/libvirt/qemu/nvram/streamer-vm-q35_ \
&gt; &gt; &gt; &gt; &gt; &gt; VARS.fd","node-name":"libvirt-pflash1-storage","auto-readonly":true,"discard":"unmap"}'
&gt; &gt; &gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt; &gt; &gt; Dagg
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; I was able to get the vm running again by creating the xml again. the only \
&gt; &gt; &gt; &gt; &gt;                 issue I'm facing is the fact that only the one playback \
&gt; &gt; &gt; &gt; &gt;                 device is visible:
&gt; &gt; &gt; &gt; &gt; **** List of PLAYBACK Hardware Devices ****
&gt; &gt; &gt; &gt; &gt; card 0: PCH [HDA Intel PCH], device 0: ALC892 Analog [ALC892 Analog]
&gt; &gt; &gt; &gt; &gt; Subdevices: 1/1
&gt; &gt; &gt; &gt; &gt; Subdevice #0: subdevice #0
&gt; &gt; &gt; &gt; &gt; prior to the upgrade I had hdmi entries too.
&gt; &gt; &gt; &gt; &gt; I've check with two different oses and the issue persists.
&gt; &gt; &gt; &gt; &gt; as mentioned before, if I drop this line: -audiodev id=audio1,driver=none \
&gt; &gt; &gt; &gt; &gt; from the cmd, I see all the playback channels. 
&gt; &gt; &gt; &gt; &gt; any idea?
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; So to clean up this thread let me reply to the two issues separately.
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 1) if your device-assigned audio is not visible with '-audiodev
&gt; &gt; &gt; &gt; id=audio1,driver=none', but *is* visible with QEMU_AUDIO_DRV=none,
&gt; &gt; &gt; &gt; then that is a bug in QEMU and needs to be dealt with there.
&gt; &gt; &gt; I'll ping the eqmu devs on this.
&gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 2) To your issue with starting the domain it would be good to know what
&gt; &gt; &gt; &gt; is the error you get from virsh (or however you are starting the
&gt; &gt; &gt; &gt; domain) and the debug logs of libvirtd, ideally just for the part of
&gt; &gt; &gt; &gt; the domain starting.
&gt; &gt; &gt; that is the issue, there wasn't any error. the vm just didn't booted.
&gt; &gt; 
&gt; &gt; Oh, so I misunderstood.  What was the state of the VM in libvirt?
&gt; &gt; "paused" or "running"?  Was there serial console working?
&gt; it was marked as running and there was no serial
&gt; 
&gt; &gt; 
&gt; &gt; &gt; I can diff the original xml with the new one to see the diffs and post them \
&gt; &gt; &gt; here if you wish 
&gt; &gt; 
&gt; &gt; Would be nice to see if there are any differences.  The newly created
&gt; &gt; one works then?
&gt; &gt; 
&gt; 
&gt; I'll sent it later today
&gt; 

here: https://dpaste.com/5VBUU8Z9W


</body></email><email><emailId>20210812084940</emailId><senderName>Martin Kletzander</senderName><senderEmail>mkletzan@redhat.com</senderEmail><timestampReceived>2021-08-12 08:49:40-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>


On Wed, Aug 11, 2021 at 08:53:10PM +0200, daggs wrote:
&gt;Greetings Martin,
&gt;
&gt;
&gt;&gt; Sent: Wednesday, August 11, 2021 at 6:08 PM
&gt;&gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt;&gt; To: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt;&gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt;&gt; Subject: Re: issues with vm after upgrade
&gt;&gt;
&gt;&gt; Greetings Martin,
&gt;&gt;
&gt;&gt; &gt; Sent: Wednesday, August 11, 2021 at 4:13 PM
&gt;&gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt;&gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt;&gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt;&gt; &gt; Subject: Re: issues with vm after upgrade
&gt;&gt; &gt;
&gt;&gt; &gt; On Wed, Aug 11, 2021 at 03:09:34PM +0200, daggs wrote:
&gt;&gt; &gt; &gt;Greetings Martin,
&gt;&gt; &gt; &gt;
&gt;&gt; &gt; &gt;&gt; Sent: Wednesday, August 11, 2021 at 10:14 AM
&gt;&gt; &gt; &gt;&gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt;&gt; &gt; &gt;&gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt;&gt; &gt; &gt;&gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt;&gt; &gt; &gt;&gt; Subject: Re: issues with vm after upgrade
&gt;&gt; &gt; &gt;&gt;

[...]

&gt;&gt; &gt; &gt;&gt;
&gt;&gt; &gt; &gt;&gt; 2) To your issue with starting the domain it would be good to know what
&gt;&gt; &gt; &gt;&gt;     is the error you get from virsh (or however you are starting the
&gt;&gt; &gt; &gt;&gt;     domain) and the debug logs of libvirtd, ideally just for the part of
&gt;&gt; &gt; &gt;&gt;     the domain starting.
&gt;&gt; &gt; &gt;that is the issue, there wasn't any error. the vm just didn't booted.
&gt;&gt; &gt;
&gt;&gt; &gt; Oh, so I misunderstood.  What was the state of the VM in libvirt?
&gt;&gt; &gt; "paused" or "running"?  Was there serial console working?
&gt;&gt; it was marked as running and there was no serial
&gt;&gt;

That's a pity we could not examine what was actually happening.

&gt;&gt; &gt;
&gt;&gt; &gt; &gt;I can diff the original xml with the new one to see the diffs and post them here if you wish
&gt;&gt; &gt; &gt;
&gt;&gt; &gt;
&gt;&gt; &gt; Would be nice to see if there are any differences.  The newly created
&gt;&gt; &gt; one works then?
&gt;&gt; &gt;
&gt;&gt;
&gt;&gt; I'll sent it later today
&gt;&gt;
&gt;
&gt;here: https://dpaste.com/5VBUU8Z9W
&gt;

Unfortunately there are many differences there.  The machine type
changes _something_ in qemu, there is different PCI(e) topology, and I
do not think I will be able to figure this out without the non-working
machine.

So if your current setup works for you right now I'd leave figuring out
the previous issue to others, if there is anyone wanting to figure out
if there is some libvirt issue.

Have a nice day

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20210812110731</emailId><senderName>daggs</senderName><senderEmail>daggs@gmx.com</senderEmail><timestampReceived>2021-08-12 11:07:31-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>

&gt; Sent: Thursday, August 12, 2021 at 11:49 AM
&gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; Subject: Re: issues with vm after upgrade
&gt;
&gt; On Wed, Aug 11, 2021 at 08:53:10PM +0200, daggs wrote:
&gt; &gt;Greetings Martin,
&gt; &gt;
&gt; &gt;
&gt; &gt;&gt; Sent: Wednesday, August 11, 2021 at 6:08 PM
&gt; &gt;&gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt;&gt; To: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt;&gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt;&gt; Subject: Re: issues with vm after upgrade
&gt; &gt;&gt;
&gt; &gt;&gt; Greetings Martin,
&gt; &gt;&gt;
&gt; &gt;&gt; &gt; Sent: Wednesday, August 11, 2021 at 4:13 PM
&gt; &gt;&gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt;&gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt;&gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt;&gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; On Wed, Aug 11, 2021 at 03:09:34PM +0200, daggs wrote:
&gt; &gt;&gt; &gt; &gt;Greetings Martin,
&gt; &gt;&gt; &gt; &gt;
&gt; &gt;&gt; &gt; &gt;&gt; Sent: Wednesday, August 11, 2021 at 10:14 AM
&gt; &gt;&gt; &gt; &gt;&gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt;&gt; &gt; &gt;&gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt;&gt; &gt; &gt;&gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt;&gt; &gt; &gt;&gt; Subject: Re: issues with vm after upgrade
&gt; &gt;&gt; &gt; &gt;&gt;
&gt;
&gt; [...]
&gt;
&gt; &gt;&gt; &gt; &gt;&gt;
&gt; &gt;&gt; &gt; &gt;&gt; 2) To your issue with starting the domain it would be good to know what
&gt; &gt;&gt; &gt; &gt;&gt;     is the error you get from virsh (or however you are starting the
&gt; &gt;&gt; &gt; &gt;&gt;     domain) and the debug logs of libvirtd, ideally just for the part of
&gt; &gt;&gt; &gt; &gt;&gt;     the domain starting.
&gt; &gt;&gt; &gt; &gt;that is the issue, there wasn't any error. the vm just didn't booted.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; Oh, so I misunderstood.  What was the state of the VM in libvirt?
&gt; &gt;&gt; &gt; "paused" or "running"?  Was there serial console working?
&gt; &gt;&gt; it was marked as running and there was no serial
&gt; &gt;&gt;
&gt;
&gt; That's a pity we could not examine what was actually happening.
&gt;
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; &gt;I can diff the original xml with the new one to see the diffs and post them here if you wish
&gt; &gt;&gt; &gt; &gt;
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; Would be nice to see if there are any differences.  The newly created
&gt; &gt;&gt; &gt; one works then?
&gt; &gt;&gt; &gt;
&gt; &gt;&gt;
&gt; &gt;&gt; I'll sent it later today
&gt; &gt;&gt;
&gt; &gt;
&gt; &gt;here: https://dpaste.com/5VBUU8Z9W
&gt; &gt;
&gt;
&gt; Unfortunately there are many differences there.  The machine type
&gt; changes _something_ in qemu, there is different PCI(e) topology, and I
&gt; do not think I will be able to figure this out without the non-working
&gt; machine.
&gt;
&gt; So if your current setup works for you right now I'd leave figuring out
&gt; the previous issue to others, if there is anyone wanting to figure out
&gt; if there is some libvirt issue.
&gt;
&gt; Have a nice day
&gt;

my current setup works beside the hdmi audio, this I still need to investigate.

thanks for your help.

Dagg


</body></email><email><emailId>20210814100505</emailId><senderName>daggs</senderName><senderEmail>daggs@gmx.com</senderEmail><timestampReceived>2021-08-14 10:05:05-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>

Greetings Martin,

&gt; Sent: Thursday, August 12, 2021 at 2:07 PM
&gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; To: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; Subject: Re: issues with vm after upgrade
&gt; 
&gt; &gt; Sent: Thursday, August 12, 2021 at 11:49 AM
&gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; 
&gt; &gt; On Wed, Aug 11, 2021 at 08:53:10PM +0200, daggs wrote:
&gt; &gt; &gt; Greetings Martin,
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Sent: Wednesday, August 11, 2021 at 6:08 PM
&gt; &gt; &gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; To: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Greetings Martin,
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; Sent: Wednesday, August 11, 2021 at 4:13 PM
&gt; &gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; On Wed, Aug 11, 2021 at 03:09:34PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; Greetings Martin,
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Wednesday, August 11, 2021 at 10:14 AM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; [...]
&gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 2) To your issue with starting the domain it would be good to know what
&gt; &gt; &gt; &gt; &gt; &gt; &gt; is the error you get from virsh (or however you are starting the
&gt; &gt; &gt; &gt; &gt; &gt; &gt; domain) and the debug logs of libvirtd, ideally just for the part of
&gt; &gt; &gt; &gt; &gt; &gt; &gt; the domain starting.
&gt; &gt; &gt; &gt; &gt; &gt; that is the issue, there wasn't any error. the vm just didn't booted.
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; Oh, so I misunderstood.  What was the state of the VM in libvirt?
&gt; &gt; &gt; &gt; &gt; "paused" or "running"?  Was there serial console working?
&gt; &gt; &gt; &gt; it was marked as running and there was no serial
&gt; &gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; That's a pity we could not examine what was actually happening.
&gt; &gt; 
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; I can diff the original xml with the new one to see the diffs and post \
&gt; &gt; &gt; &gt; &gt; &gt; them here if you wish 
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; Would be nice to see if there are any differences.  The newly created
&gt; &gt; &gt; &gt; &gt; one works then?
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; I'll sent it later today
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; here: https://dpaste.com/5VBUU8Z9W
&gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; Unfortunately there are many differences there.  The machine type
&gt; &gt; changes _something_ in qemu, there is different PCI(e) topology, and I
&gt; &gt; do not think I will be able to figure this out without the non-working
&gt; &gt; machine.
&gt; &gt; 
&gt; &gt; So if your current setup works for you right now I'd leave figuring out
&gt; &gt; the previous issue to others, if there is anyone wanting to figure out
&gt; &gt; if there is some libvirt issue.
&gt; &gt; 
&gt; &gt; Have a nice day
&gt; &gt; 
&gt; 
&gt; my current setup works beside the hdmi audio, this I still need to investigate.
&gt; 
&gt; thanks for your help.
&gt; 
&gt; Dagg
&gt; 

just to update, I've solved the sound issue, frankly, I don't understand how the \
guest showed a soundcard in the first place. from what I gather, libvirt sets the \
-nodefaults flag to prepare the vm's properties from scratch. in this situation, the \
sound card is a function in the host machine's pci tree. when libvirt created the pci \
tree for the guest, it placed the card as a function of a device as well, in my case \
02:00.2 however it didn't created a device at 02:00.0.
my fix was to move the device to 00:1f.4 in the guest.
I won't be surprised this was the issue why the vm didn't booted after the upgrade \
with the old xml.

Dagg.


</body></email><email><emailId>20210815215755</emailId><senderName>Laine Stump</senderName><senderEmail>laine@redhat.com</senderEmail><timestampReceived>2021-08-15 21:57:55-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>



On 8/14/21 6:05 AM, daggs wrote:
&gt; Greetings Martin,
&gt; 
&gt; &gt; Sent: Thursday, August 12, 2021 at 2:07 PM
&gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; To: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; 
&gt; &gt; &gt; Sent: Thursday, August 12, 2021 at 11:49 AM
&gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; 
&gt; &gt; &gt; On Wed, Aug 11, 2021 at 08:53:10PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; Greetings Martin,
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; Sent: Wednesday, August 11, 2021 at 6:08 PM
&gt; &gt; &gt; &gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; To: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; Greetings Martin,
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; Sent: Wednesday, August 11, 2021 at 4:13 PM
&gt; &gt; &gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; On Wed, Aug 11, 2021 at 03:09:34PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Greetings Martin,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Wednesday, August 11, 2021 at 10:14 AM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; [...]
&gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 2) To your issue with starting the domain it would be good to know \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; what is the error you get from virsh (or however you are starting the
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; domain) and the debug logs of libvirtd, ideally just for the part of
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; the domain starting.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; that is the issue, there wasn't any error. the vm just didn't booted.
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; Oh, so I misunderstood.  What was the state of the VM in libvirt?
&gt; &gt; &gt; &gt; &gt; &gt; "paused" or "running"?  Was there serial console working?
&gt; &gt; &gt; &gt; &gt; it was marked as running and there was no serial
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; That's a pity we could not examine what was actually happening.
&gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; I can diff the original xml with the new one to see the diffs and post \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; them here if you wish 
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; Would be nice to see if there are any differences.  The newly created
&gt; &gt; &gt; &gt; &gt; &gt; one works then?
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; I'll sent it later today
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; here: https://dpaste.com/5VBUU8Z9W
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; Unfortunately there are many differences there.  The machine type
&gt; &gt; &gt; changes _something_ in qemu, there is different PCI(e) topology, and I
&gt; &gt; &gt; do not think I will be able to figure this out without the non-working
&gt; &gt; &gt; machine.
&gt; &gt; &gt; 
&gt; &gt; &gt; So if your current setup works for you right now I'd leave figuring out
&gt; &gt; &gt; the previous issue to others, if there is anyone wanting to figure out
&gt; &gt; &gt; if there is some libvirt issue.
&gt; &gt; &gt; 
&gt; &gt; &gt; Have a nice day
&gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; my current setup works beside the hdmi audio, this I still need to investigate.
&gt; &gt; 
&gt; &gt; thanks for your help.
&gt; &gt; 
&gt; &gt; Dagg
&gt; &gt; 
&gt; 
&gt; just to update, I've solved the sound issue, frankly, I don't understand how the \
&gt; guest showed a soundcard in the first place. from what I gather, libvirt sets the \
&gt; -nodefaults flag to prepare the vm's properties from scratch. in this situation, \
&gt; the sound card is a function in the host machine's pci tree. when libvirt created \
&gt; the pci tree for the guest, it placed the card as a function of a device as well, \
&gt; in my case 02:00.2 however it didn't created a device at 02:00.0.

Are you basing this claim on the libvirt XML? Or on what you see with 
lspci in the guest?

When libvirt is assigning PCI addresses to devices in a guest, it will 
never auto-assign a non-0 function. This will only happen if the user 
explicitly requests it (and even then, iirc, libvirt should generate an 
error if function 0 of the same slot has no device - something to the 
effect of "no device on function 0 of a multifunction device").

Anyway, when I looked back at the XML diff you posted earlier (see 
below), I didn't see any hostdev device assigned to 02:00.2. What I 
*did* see was that in both the old and the new version of the diff, the 
hostdev devices were assigned to function 0 of different *slots* on a 
dmi-to-pci-bridge controller, which should cause no problems (unless 
there is a bug in QEMU's dmi-to-pci-bridge). (The important thing, 
though, is that there is no hostdev device on a non-0 function, and when 
it is on a non-0 slot, that's because it's on a dmi-to-pci-bridge (which 
has 32 slots).


On the topic of having a dmi-to-pci-bridge show up in your XML: I don't 
remember what versions the changes were in (it was at least a year or 
two ago), but only a fairly old version of libvirt woud do that - 1) 
recent libvirt will assume that any hostdev PCI device is a PCIe device, 
so it will add a pcie-root-port and assign the hostdev device to slot 0 
of that root-port, and even before that 2) we switched from using 
dmi-to-pci-bridge to using pcie-to-pci-bridge quite some time ago as well.

So if you're generating new XML based on config that doesn't have pci 
controllers already in it, and you're seeing hostdevs (or any other PCI 
devices) assigned to an automatically-added dmi-to-pci-bridge, then your 
libvirt version is severely out of date.


On 8/11/21 2:53 PM, daggs wrote:
 &gt;&gt; From: "daggs" &lt;daggs@gmx.com&gt;
 &gt;&gt;&gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
 &gt;&gt;&gt; On Wed, Aug 11, 2021 at 03:09:34PM +0200, daggs wrote:
 &gt;&gt;&gt;&gt; I can diff the original xml with the new one to see the diffs and 
post them here if you wish
 &gt;&gt;&gt;&gt;
 &gt;&gt;&gt;
 &gt;&gt;&gt; Would be nice to see if there are any differences.  The newly created
 &gt;&gt;&gt; one works then?
 &gt;&gt;
 &gt;&gt; I'll sent it later today
 &gt;&gt;
 &gt;
 &gt; here: https://dpaste.com/5VBUU8Z9W


&gt; my fix was to move the device to 00:1f.4 in the guest.

That's an interesting choice :-). You could have just put it on function 
0 of some other unused slot (or a non-0 function of the slot the GPU is 
assigned to). 00:1f is used for integrated devices on the Q35 chipset - 
it's nice that QEMU's emulation code was written to allowing adding more 
devices on that slot, but I wouldn't have been surprised if it had 
caused problems...


&gt; I won't be surprised this was the issue why the vm didn't booted after the upgrade \
&gt; with the old xml.

Well, if your XML had a device assigned to a non-0 function of a slot 
and no device in function 0 of that slot, it would have failed to work 
previously as well (my recollection is that in this case it's more a 
problem of the guest OS not probing non-0 functions when there is 
nothing on function 0, and not with anything done by QEMU).


</body></email><email><emailId>20210820160754</emailId><senderName>daggs</senderName><senderEmail>daggs@gmx.com</senderEmail><timestampReceived>2021-08-20 16:07:54-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>

Greetings Laine,

&gt; Sent: Monday, August 16, 2021 at 12:57 AM
&gt; From: "Laine Stump" &lt;laine@redhat.com&gt;
&gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; Subject: Re: issues with vm after upgrade
&gt; 
&gt; 
&gt; 
&gt; On 8/14/21 6:05 AM, daggs wrote:
&gt; &gt; Greetings Martin,
&gt; &gt; 
&gt; &gt; &gt; Sent: Thursday, August 12, 2021 at 2:07 PM
&gt; &gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; To: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Sent: Thursday, August 12, 2021 at 11:49 AM
&gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; On Wed, Aug 11, 2021 at 08:53:10PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; Greetings Martin,
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; Sent: Wednesday, August 11, 2021 at 6:08 PM
&gt; &gt; &gt; &gt; &gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; To: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; Greetings Martin,
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Wednesday, August 11, 2021 at 4:13 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; On Wed, Aug 11, 2021 at 03:09:34PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Greetings Martin,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Wednesday, August 11, 2021 at 10:14 AM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; [...]
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 2) To your issue with starting the domain it would be good to know \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; what is the error you get from virsh (or however you are starting \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; the domain) and the debug logs of libvirtd, ideally just for the \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; part of the domain starting.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; that is the issue, there wasn't any error. the vm just didn't booted.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Oh, so I misunderstood.  What was the state of the VM in libvirt?
&gt; &gt; &gt; &gt; &gt; &gt; &gt; "paused" or "running"?  Was there serial console working?
&gt; &gt; &gt; &gt; &gt; &gt; it was marked as running and there was no serial
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; That's a pity we could not examine what was actually happening.
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; I can diff the original xml with the new one to see the diffs and \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; post them here if you wish 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Would be nice to see if there are any differences.  The newly created
&gt; &gt; &gt; &gt; &gt; &gt; &gt; one works then?
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; I'll sent it later today
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; here: https://dpaste.com/5VBUU8Z9W
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Unfortunately there are many differences there.  The machine type
&gt; &gt; &gt; &gt; changes _something_ in qemu, there is different PCI(e) topology, and I
&gt; &gt; &gt; &gt; do not think I will be able to figure this out without the non-working
&gt; &gt; &gt; &gt; machine.
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; So if your current setup works for you right now I'd leave figuring out
&gt; &gt; &gt; &gt; the previous issue to others, if there is anyone wanting to figure out
&gt; &gt; &gt; &gt; if there is some libvirt issue.
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Have a nice day
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; my current setup works beside the hdmi audio, this I still need to investigate.
&gt; &gt; &gt; 
&gt; &gt; &gt; thanks for your help.
&gt; &gt; &gt; 
&gt; &gt; &gt; Dagg
&gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; just to update, I've solved the sound issue, frankly, I don't understand how the \
&gt; &gt; guest showed a soundcard in the first place. from what I gather, libvirt sets the \
&gt; &gt; -nodefaults flag to prepare the vm's properties from scratch. in this situation, \
&gt; &gt; the sound card is a function in the host machine's pci tree. when libvirt created \
&gt; &gt; the pci tree for the guest, it placed the card as a function of a device as well, \
&gt; &gt; in my case 02:00.2 however it didn't created a device at 02:00.0.
&gt; 
&gt; Are you basing this claim on the libvirt XML? Or on what you see with
&gt; lspci in the guest?
&gt; 
&gt; When libvirt is assigning PCI addresses to devices in a guest, it will
&gt; never auto-assign a non-0 function. This will only happen if the user
&gt; explicitly requests it (and even then, iirc, libvirt should generate an
&gt; error if function 0 of the same slot has no device - something to the
&gt; effect of "no device on function 0 of a multifunction device").
&gt; 
&gt; Anyway, when I looked back at the XML diff you posted earlier (see
&gt; below), I didn't see any hostdev device assigned to 02:00.2. What I
&gt; *did* see was that in both the old and the new version of the diff, the
&gt; hostdev devices were assigned to function 0 of different *slots* on a
&gt; dmi-to-pci-bridge controller, which should cause no problems (unless
&gt; there is a bug in QEMU's dmi-to-pci-bridge). (The important thing,
&gt; though, is that there is no hostdev device on a non-0 function, and when
&gt; it is on a non-0 slot, that's because it's on a dmi-to-pci-bridge (which
&gt; has 32 slots).
I saw it in guest, I'd assume that if libvirt defines a device on a specific bdf, the \
guest will not change it. infact, over the last 10 years I've booted thousand of \
systems both bare metal and visualized and never encountered such scenario. that \
said, it might be a bug in qemu.

what I did saw is that on the old vm in guest, after the upgrade the sound card was \
defined as a function of the scsi virtblk controller and the new vm placed it as a \
function of non existent device.

&gt; 
&gt; 
&gt; On the topic of having a dmi-to-pci-bridge show up in your XML: I don't
&gt; remember what versions the changes were in (it was at least a year or
&gt; two ago), but only a fairly old version of libvirt woud do that - 1)
&gt; recent libvirt will assume that any hostdev PCI device is a PCIe device,
&gt; so it will add a pcie-root-port and assign the hostdev device to slot 0
&gt; of that root-port, and even before that 2) we switched from using
&gt; dmi-to-pci-bridge to using pcie-to-pci-bridge quite some time ago as well.
as stated in the original mail, the issue started after a major version upgrade of \
both libvirt and qemu, I'm currently using latest stable afaik.

&gt; 
&gt; So if you're generating new XML based on config that doesn't have pci
&gt; controllers already in it, and you're seeing hostdevs (or any other PCI
&gt; devices) assigned to an automatically-added dmi-to-pci-bridge, then your
&gt; libvirt version is severely out of date.
here are the version I'm using:
# emerge --search app-emulation/libvirt app-emulation/qemu

[ Results for search key : app-emulation/libvirt ]
Searching...

*  app-emulation/libvirt
      Latest version available: 7.5.0
      Latest version installed: 7.5.0
      Size of files: 9749 KiB
      Homepage:      https://www.libvirt.org/ https://gitlab.com/libvirt/libvirt/
      Description:   C toolkit to manipulate virtual machines
      License:       LGPL-2.1

[ Applications found : 1 ]


[ Results for search key : app-emulation/qemu ]
Searching...

*  app-emulation/qemu
      Latest version available: 6.0.0-r52
      Latest version installed: 6.0.0-r52
      Size of files: 22724 KiB
      Homepage:      http://www.qemu.org http://www.linux-kvm.org
      Description:   QEMU + Kernel-based Virtual Machine userland tools
      License:       GPL-2 LGPL-2 BSD-2

[ Applications found : 1 ]

&gt; 
&gt; 
&gt; On 8/11/21 2:53 PM, daggs wrote:
&gt; &gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; On Wed, Aug 11, 2021 at 03:09:34PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; I can diff the original xml with the new one to see the diffs and
&gt; post them here if you wish
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Would be nice to see if there are any differences.  The newly created
&gt; &gt; &gt; &gt; one works then?
&gt; &gt; &gt; 
&gt; &gt; &gt; I'll sent it later today
&gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; here: https://dpaste.com/5VBUU8Z9W
&gt; 
&gt; 
&gt; &gt; my fix was to move the device to 00:1f.4 in the guest.
&gt; 
&gt; That's an interesting choice :-). You could have just put it on function
&gt; 0 of some other unused slot (or a non-0 function of the slot the GPU is
&gt; assigned to). 00:1f is used for integrated devices on the Q35 chipset -
&gt; it's nice that QEMU's emulation code was written to allowing adding more
&gt; devices on that slot, but I wouldn't have been surprised if it had
&gt; caused problems...
10 years of working in a virtualization company has taught me that somethings, \
keeping the pci structure close as much as possible to the original is the best way \
to go. that is why I chose it a s func, it is a func on the host mahcine.

&gt; 
&gt; 
&gt; &gt; I won't be surprised this was the issue why the vm didn't booted after the \
&gt; &gt; upgrade with the old xml.
&gt; 
&gt; Well, if your XML had a device assigned to a non-0 function of a slot
&gt; and no device in function 0 of that slot, it would have failed to work
&gt; previously as well (my recollection is that in this case it's more a
&gt; problem of the guest OS not probing non-0 functions when there is
&gt; nothing on function 0, and not with anything done by QEMU).
&gt; 
&gt; 
here is the xml of the machine after I've recreated it, it worked but no sound: \
https://dpaste.com/BB9EDY6BK I used virt-manager. note that the sound card pt is \
placed as a func in bus 0x8 which doesn't exists.

Dagg.


</body></email><email><emailId>20210825165353</emailId><senderName>Laine Stump</senderName><senderEmail>laine@redhat.com</senderEmail><timestampReceived>2021-08-25 16:53:53-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>

On 8/20/21 12:07 PM, daggs wrote:
&gt; Greetings Laine,
&gt; 
&gt; &gt; Sent: Monday, August 16, 2021 at 12:57 AM
&gt; &gt; From: "Laine Stump" &lt;laine@redhat.com&gt;
&gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; On 8/14/21 6:05 AM, daggs wrote:
&gt; &gt; &gt; Greetings Martin,
&gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Sent: Thursday, August 12, 2021 at 2:07 PM
&gt; &gt; &gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; To: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; Sent: Thursday, August 12, 2021 at 11:49 AM
&gt; &gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; On Wed, Aug 11, 2021 at 08:53:10PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; Greetings Martin,
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Wednesday, August 11, 2021 at 6:08 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Greetings Martin,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Wednesday, August 11, 2021 at 4:13 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; On Wed, Aug 11, 2021 at 03:09:34PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Greetings Martin,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Wednesday, August 11, 2021 at 10:14 AM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; [...]
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 2) To your issue with starting the domain it would be good to \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; know what is the error you get from virsh (or however you are \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; starting the domain) and the debug logs of libvirtd, ideally just \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; for the part of the domain starting.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; that is the issue, there wasn't any error. the vm just didn't \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; booted.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Oh, so I misunderstood.  What was the state of the VM in libvirt?
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; "paused" or "running"?  Was there serial console working?
&gt; &gt; &gt; &gt; &gt; &gt; &gt; it was marked as running and there was no serial
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; That's a pity we could not examine what was actually happening.
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; I can diff the original xml with the new one to see the diffs and \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; post them here if you wish 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Would be nice to see if there are any differences.  The newly created
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; one works then?
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; I'll sent it later today
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; here: https://dpaste.com/5VBUU8Z9W
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; Unfortunately there are many differences there.  The machine type
&gt; &gt; &gt; &gt; &gt; changes _something_ in qemu, there is different PCI(e) topology, and I
&gt; &gt; &gt; &gt; &gt; do not think I will be able to figure this out without the non-working
&gt; &gt; &gt; &gt; &gt; machine.
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; So if your current setup works for you right now I'd leave figuring out
&gt; &gt; &gt; &gt; &gt; the previous issue to others, if there is anyone wanting to figure out
&gt; &gt; &gt; &gt; &gt; if there is some libvirt issue.
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; Have a nice day
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; my current setup works beside the hdmi audio, this I still need to \
&gt; &gt; &gt; &gt; investigate. 
&gt; &gt; &gt; &gt; thanks for your help.
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Dagg
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; just to update, I've solved the sound issue, frankly, I don't understand how \
&gt; &gt; &gt; the guest showed a soundcard in the first place. from what I gather, libvirt \
&gt; &gt; &gt; sets the -nodefaults flag to prepare the vm's properties from scratch. in this \
&gt; &gt; &gt; situation, the sound card is a function in the host machine's pci tree. when \
&gt; &gt; &gt; libvirt created the pci tree for the guest, it placed the card as a function of \
&gt; &gt; &gt; a device as well, in my case 02:00.2 however it didn't created a device at \
&gt; &gt; &gt; 02:00.0.
&gt; &gt; 
&gt; &gt; Are you basing this claim on the libvirt XML? Or on what you see with
&gt; &gt; lspci in the guest?
&gt; &gt; 
&gt; &gt; When libvirt is assigning PCI addresses to devices in a guest, it will
&gt; &gt; never auto-assign a non-0 function. This will only happen if the user
&gt; &gt; explicitly requests it (and even then, iirc, libvirt should generate an
&gt; &gt; error if function 0 of the same slot has no device - something to the
&gt; &gt; effect of "no device on function 0 of a multifunction device").
&gt; &gt; 
&gt; &gt; Anyway, when I looked back at the XML diff you posted earlier (see
&gt; &gt; below), I didn't see any hostdev device assigned to 02:00.2. What I
&gt; &gt; *did* see was that in both the old and the new version of the diff, the
&gt; &gt; hostdev devices were assigned to function 0 of different *slots* on a
&gt; &gt; dmi-to-pci-bridge controller, which should cause no problems (unless
&gt; &gt; there is a bug in QEMU's dmi-to-pci-bridge). (The important thing,
&gt; &gt; though, is that there is no hostdev device on a non-0 function, and when
&gt; &gt; it is on a non-0 slot, that's because it's on a dmi-to-pci-bridge (which
&gt; &gt; has 32 slots).

&gt; I saw it in guest,

But I didn't see it in the XML diffs that you had posted.

&gt; I'd assume that if libvirt defines a device on a specific bdf, the guest will not \
&gt; change it.

That's not exactly true - the bus "number" in libvirt isn't given to 
qemu as an actual number, but as an alphanumeric device id (called 
"alias name" in libvirt XML). QEMU doesn't have any concept of "bus 
number", because (afaiu) there is no way to convey such info to the 
guest firmware/OS; instead, QEMU creates a topology of interconnected 
controllers, the firmware and/or OS traverses this topology and assigns 
numbers to the encountered controllers as it sees fit.

So you may have PCI controllers with indexes 1, 2, and 3 in your libvirt 
config, but those will be described on the QEMU commandline as 
controllers "pcie.1", "pcie.2", and "pcie.3":

-device 
pcie-root-port,port=0x8,chassis=1,id=pci.1,bus=pcie.0,multifunction=on,addr=0x1 
\
-device pcie-root-port,port=0x9,chassis=2,id=pci.2,bus=pcie.0,addr=0x1.0x1 \
-device pcie-root-port,port=0xa,chassis=3,id=pci.3,bus=pcie.0,addr=0x1.0x2 \

and when a PCI device is attached to one of these controllers, the QEMU 
commandline uses the id name of the controller, not a bus number:

-device vfio-pci,host=0000:05:00.0,bus=pci.1,multifunction=on,addr=0x0 \
-device vfio-pci,host=0000:05:00.1,id=hostdev1,bus=pci.1,addr=0x0.0x1 \

It is a nice coincidence that the OSes I've seen happen to traverse the 
PCI topology in a manner that results in the guest OS numbering the 
buses the same as they are numbered in libvirt XML that has had PCI 
addresses auto-assigned by libvirt, but it is trivial to make this *not* 
happen. For example, if you changed the config so that the bus with 
index='2' (pcie.2) was attached to pcie.0, addr=0x1.0x1 (i.e. change its 
PCI address to &lt;address type='pci' bus='0' slot='1' function='1'/&gt;" , 
and the bus with index='3' was attached to pcie.0, addr=0x1.0x2, then 
the guest would number "pcie.2" as bus 1, and "pcie.1" as bus 2.

And of course the guest OS is free to traverse the controller topology 
in any manner it wants, so the bus numbering in the guest could be 
different even if the libvirt-generated QEMU commandline was the same.

*HOWEVER*, slot (device) and function number are specified on the QEMU 
commandline numerically, and they will appear in the guest exactly as 
they are in the libvirt XML.



&gt; infact, over the last 10 years I've booted thousand of systems both bare metal and \
&gt; visualized and never encountered such scenario. that said, it might be a bug in \
&gt; qemu. &gt; what I did saw is that on the old vm in guest, after the upgrade the sound \
&gt; card was defined as a function of the scsi virtblk controller and the new vm placed \
&gt; it as a function of non existent device.

I would be very interested in seeing the libvirt XML, QEMU commandline, 
and guest-side output of "lspci" for this. I can't think of any way this 
could happen without a serious bug *somewhere* (or manual intervention 
in the PCI addresses in the guest).

&gt; 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; On the topic of having a dmi-to-pci-bridge show up in your XML: I don't
&gt; &gt; remember what versions the changes were in (it was at least a year or
&gt; &gt; two ago), but only a fairly old version of libvirt woud do that - 1)
&gt; &gt; recent libvirt will assume that any hostdev PCI device is a PCIe device,
&gt; &gt; so it will add a pcie-root-port and assign the hostdev device to slot 0
&gt; &gt; of that root-port, and even before that 2) we switched from using
&gt; &gt; dmi-to-pci-bridge to using pcie-to-pci-bridge quite some time ago as well.
&gt; as stated in the original mail, the issue started after a major version upgrade of \
&gt; both libvirt and qemu, I'm currently using latest stable afaik.

Right. If your guest was defined the first time using a much older 
libvirt, then devices would have been assigned to an auto-created 
dmi-to-pci-bridge at that time, and if you don't change (or remove) the 
PCI addresses of the devices or the bridge, then that will all be 
maintained whenever you restart the guest, ragardless of libvirt 
upgrades. But this again points out that the guest-side PCI addresses 
(which are determined by the PCI addresses in the libvirt config) should 
not change when upgrading libvirt (NOTE: 1) libvirt will only 
auto-assign a new PCI address to a device if it doesn't already have a 
PCI address assigned to it, and 2) libvirt *never* auto-assigns a non-0 
function except when adding a pcie-root-port (and in that case it will 
always first assign something to function 0))


&gt; 
&gt; &gt; 
&gt; &gt; So if you're generating new XML based on config that doesn't have pci
&gt; &gt; controllers already in it, and you're seeing hostdevs (or any other PCI
&gt; &gt; devices) assigned to an automatically-added dmi-to-pci-bridge, then your
&gt; &gt; libvirt version is severely out of date.
&gt; here are the version I'm using:
&gt; # emerge --search app-emulation/libvirt app-emulation/qemu
&gt; 
&gt; [ Results for search key : app-emulation/libvirt ]
&gt; Searching...
&gt; 
&gt; *  app-emulation/libvirt
&gt; Latest version available: 7.5.0
&gt; Latest version installed: 7.5.0
&gt; Size of files: 9749 KiB
&gt; Homepage:      https://www.libvirt.org/ https://gitlab.com/libvirt/libvirt/
&gt; Description:   C toolkit to manipulate virtual machines
&gt; License:       LGPL-2.1
&gt; 
&gt; [ Applications found : 1 ]
&gt; 
&gt; 
&gt; [ Results for search key : app-emulation/qemu ]
&gt; Searching...
&gt; 
&gt; *  app-emulation/qemu
&gt; Latest version available: 6.0.0-r52
&gt; Latest version installed: 6.0.0-r52
&gt; Size of files: 22724 KiB
&gt; Homepage:      http://www.qemu.org http://www.linux-kvm.org
&gt; Description:   QEMU + Kernel-based Virtual Machine userland tools
&gt; License:       GPL-2 LGPL-2 BSD-2
&gt; 
&gt; [ Applications found : 1 ]
&gt; 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; On 8/11/21 2:53 PM, daggs wrote:
&gt; &gt; &gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; On Wed, Aug 11, 2021 at 03:09:34PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; I can diff the original xml with the new one to see the diffs and
&gt; &gt; post them here if you wish
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; Would be nice to see if there are any differences.  The newly created
&gt; &gt; &gt; &gt; &gt; one works then?
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; I'll sent it later today
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; here: https://dpaste.com/5VBUU8Z9W
&gt; &gt; 
&gt; &gt; 
&gt; &gt; &gt; my fix was to move the device to 00:1f.4 in the guest.
&gt; &gt; 
&gt; &gt; That's an interesting choice :-). You could have just put it on function
&gt; &gt; 0 of some other unused slot (or a non-0 function of the slot the GPU is
&gt; &gt; assigned to). 00:1f is used for integrated devices on the Q35 chipset -
&gt; &gt; it's nice that QEMU's emulation code was written to allowing adding more
&gt; &gt; devices on that slot, but I wouldn't have been surprised if it had
&gt; &gt; caused problems...
&gt; 10 years of working in a virtualization company has taught me that somethings, \
&gt; keeping the pci structure close as much as possible to the original is the best way \
&gt; to go. that is why I chose it a s func, it is a func on the host mahcine.

It wasn't a function of a slot that also contains integrated chipset 
devices though.... Oh, wait. According to the XML you reference down 
below, it looks like the audio device you're assigning to the guest *is 
itself* integrated on the chipset of the host, is that right?

(It's interesting that this function of slot 1F is apparently in a 
different IOMMU group than the other functions of slot 1F. I would have 
guessed they would all be in the same IOMMU group, resulting in an 
inability to assign this one function to the guest without at least 
disabling the other devices on slot 1F (by binding them to the vfio-pci 
driver)

&gt; 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; &gt; I won't be surprised this was the issue why the vm didn't booted after the \
&gt; &gt; &gt; upgrade with the old xml.
&gt; &gt; 
&gt; &gt; Well, if your XML had a device assigned to a non-0 function of a slot
&gt; &gt; and no device in function 0 of that slot, it would have failed to work
&gt; &gt; previously as well (my recollection is that in this case it's more a
&gt; &gt; problem of the guest OS not probing non-0 functions when there is
&gt; &gt; nothing on function 0, and not with anything done by QEMU).
&gt; &gt; 
&gt; &gt; 
&gt; here is the xml of the machine after I've recreated it, it worked but no sound: \
&gt; https://dpaste.com/BB9EDY6BK I used virt-manager. note that the sound card pt is \
&gt; placed as a func in bus 0x8 which doesn't exists.

This doesn't show any devices assigned to non-0 functions in the guest 
(which is the part of what you said in previous messages that sounded 
wrong to me). (except for the SATA controller, which is listed in the 
libvirt config only for informational purposes, as it is hardcoded into 
the basic q35 virtual machine and can't be removed).

What is does show is that there is a device a 00:1F.3 *on the host* that 
is being assigned to 08:01.00 (slot 1, function 0 of the 
pcie-pci-bridge) in the guest. I'm guessing this is the audio device? 
Also in this version of the XML, there is no longer a dmi-to-pci-bridge, 
but there is instead a pcie-to-pci-bridge, implying that you've 
redefined the guest config, resulting in PCI address auto-assignment 
being re-run (at least relative to the config you referenced last week 
that had a dmi-to-pci-bridge).

It's possible that the audio device's driver just doesn't like the 
device being on a standard PCI (i.e. non-PCIe) slot in the guest 
somehow, since it's a chipset-integrated PCIe device on the host. I 
haven't heard of that being the case in the past, but it's possible.


Anyway, at this point I've lost track of all the changes that have 
happened (your update entailed much more than just updating the libvirt 
package - your guest config was also changed/redefined) so I don't know 
how much more effort should be expended with post-mortem, especially 
since you now have it working. One thing that I would note is that we 
should probably be auto-assigning integrated chipset devices to 
pcie-root-ports rather than to a pci-bridge (I thought we already did 
that, but I can see how we might not).


</body></email><email><emailId>20210828105649</emailId><senderName>daggs</senderName><senderEmail>daggs@gmx.com</senderEmail><timestampReceived>2021-08-28 10:56:49-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>

Greetings Laine,

&gt; Sent: Wednesday, August 25, 2021 at 7:53 PM
&gt; From: "Laine Stump" &lt;laine@redhat.com&gt;
&gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; Subject: Re: issues with vm after upgrade
&gt; 
&gt; On 8/20/21 12:07 PM, daggs wrote:
&gt; &gt; Greetings Laine,
&gt; &gt; 
&gt; &gt; &gt; Sent: Monday, August 16, 2021 at 12:57 AM
&gt; &gt; &gt; From: "Laine Stump" &lt;laine@redhat.com&gt;
&gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; On 8/14/21 6:05 AM, daggs wrote:
&gt; &gt; &gt; &gt; Greetings Martin,
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; Sent: Thursday, August 12, 2021 at 2:07 PM
&gt; &gt; &gt; &gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; To: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; Sent: Thursday, August 12, 2021 at 11:49 AM
&gt; &gt; &gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; On Wed, Aug 11, 2021 at 08:53:10PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Greetings Martin,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Wednesday, August 11, 2021 at 6:08 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Greetings Martin,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Wednesday, August 11, 2021 at 4:13 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; On Wed, Aug 11, 2021 at 03:09:34PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Greetings Martin,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Wednesday, August 11, 2021 at 10:14 AM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; [...]
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 2) To your issue with starting the domain it would be good to \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; know what is the error you get from virsh (or however you are \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; starting the domain) and the debug logs of libvirtd, ideally \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; just for the part of the domain starting.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; that is the issue, there wasn't any error. the vm just didn't \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; booted.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Oh, so I misunderstood.  What was the state of the VM in libvirt?
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; "paused" or "running"?  Was there serial console working?
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; it was marked as running and there was no serial
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; That's a pity we could not examine what was actually happening.
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; I can diff the original xml with the new one to see the diffs and \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; post them here if you wish 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Would be nice to see if there are any differences.  The newly \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; created one works then?
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; I'll sent it later today
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; here: https://dpaste.com/5VBUU8Z9W
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; Unfortunately there are many differences there.  The machine type
&gt; &gt; &gt; &gt; &gt; &gt; changes _something_ in qemu, there is different PCI(e) topology, and I
&gt; &gt; &gt; &gt; &gt; &gt; do not think I will be able to figure this out without the non-working
&gt; &gt; &gt; &gt; &gt; &gt; machine.
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; So if your current setup works for you right now I'd leave figuring out
&gt; &gt; &gt; &gt; &gt; &gt; the previous issue to others, if there is anyone wanting to figure out
&gt; &gt; &gt; &gt; &gt; &gt; if there is some libvirt issue.
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; Have a nice day
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; my current setup works beside the hdmi audio, this I still need to \
&gt; &gt; &gt; &gt; &gt; investigate. 
&gt; &gt; &gt; &gt; &gt; thanks for your help.
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; Dagg
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; just to update, I've solved the sound issue, frankly, I don't understand how \
&gt; &gt; &gt; &gt; the guest showed a soundcard in the first place. from what I gather, libvirt \
&gt; &gt; &gt; &gt; sets the -nodefaults flag to prepare the vm's properties from scratch. in \
&gt; &gt; &gt; &gt; this situation, the sound card is a function in the host machine's pci tree. \
&gt; &gt; &gt; &gt; when libvirt created the pci tree for the guest, it placed the card as a \
&gt; &gt; &gt; &gt; function of a device as well, in my case 02:00.2 however it didn't created a \
&gt; &gt; &gt; &gt; device at 02:00.0.
&gt; &gt; &gt; 
&gt; &gt; &gt; Are you basing this claim on the libvirt XML? Or on what you see with
&gt; &gt; &gt; lspci in the guest?
&gt; &gt; &gt; 
&gt; &gt; &gt; When libvirt is assigning PCI addresses to devices in a guest, it will
&gt; &gt; &gt; never auto-assign a non-0 function. This will only happen if the user
&gt; &gt; &gt; explicitly requests it (and even then, iirc, libvirt should generate an
&gt; &gt; &gt; error if function 0 of the same slot has no device - something to the
&gt; &gt; &gt; effect of "no device on function 0 of a multifunction device").
&gt; &gt; &gt; 
&gt; &gt; &gt; Anyway, when I looked back at the XML diff you posted earlier (see
&gt; &gt; &gt; below), I didn't see any hostdev device assigned to 02:00.2. What I
&gt; &gt; &gt; *did* see was that in both the old and the new version of the diff, the
&gt; &gt; &gt; hostdev devices were assigned to function 0 of different *slots* on a
&gt; &gt; &gt; dmi-to-pci-bridge controller, which should cause no problems (unless
&gt; &gt; &gt; there is a bug in QEMU's dmi-to-pci-bridge). (The important thing,
&gt; &gt; &gt; though, is that there is no hostdev device on a non-0 function, and when
&gt; &gt; &gt; it is on a non-0 slot, that's because it's on a dmi-to-pci-bridge (which
&gt; &gt; &gt; has 32 slots).
&gt; 
&gt; &gt; I saw it in guest,
&gt; 
&gt; But I didn't see it in the XML diffs that you had posted.
as mentioned below, here is the xml of the new vm but with the sound problem: \
https://dpaste.com/BB9EDY6BK the relevant entry is at \
https://dpaste.com/BB9EDY6BK#line-130 you can see that the bdf is 08:01.0, note that \
there is no device defined at 08:00.0. I may be wrong and there is no need for such \
device but if I run lspci on both my linux system, I don't see device with such \
scenario. note that the new vm was created using virt-manager, so the address wasn't \
allocated by me

&gt; 
&gt; &gt; I'd assume that if libvirt defines a device on a specific bdf, the guest will not \
&gt; &gt; change it.
&gt; 
&gt; That's not exactly true - the bus "number" in libvirt isn't given to
&gt; qemu as an actual number, but as an alphanumeric device id (called
&gt; "alias name" in libvirt XML). QEMU doesn't have any concept of "bus
&gt; number", because (afaiu) there is no way to convey such info to the
&gt; guest firmware/OS; instead, QEMU creates a topology of interconnected
&gt; controllers, the firmware and/or OS traverses this topology and assigns
&gt; numbers to the encountered controllers as it sees fit.
so bottom line, libvirt defines the "order" of he device and qemu creates however he \
wants but maintains libvirt's "order"?

&gt; 
&gt; So you may have PCI controllers with indexes 1, 2, and 3 in your libvirt
&gt; config, but those will be described on the QEMU commandline as
&gt; controllers "pcie.1", "pcie.2", and "pcie.3":
&gt; 
&gt; -device
&gt; pcie-root-port,port=0x8,chassis=1,id=pci.1,bus=pcie.0,multifunction=on,addr=0x1
&gt; \
&gt; -device pcie-root-port,port=0x9,chassis=2,id=pci.2,bus=pcie.0,addr=0x1.0x1 \
&gt; -device pcie-root-port,port=0xa,chassis=3,id=pci.3,bus=pcie.0,addr=0x1.0x2 \
&gt; 
&gt; and when a PCI device is attached to one of these controllers, the QEMU
&gt; commandline uses the id name of the controller, not a bus number:
&gt; 
&gt; -device vfio-pci,host=0000:05:00.0,bus=pci.1,multifunction=on,addr=0x0 \
&gt; -device vfio-pci,host=0000:05:00.1,id=hostdev1,bus=pci.1,addr=0x0.0x1 \
&gt; 
&gt; It is a nice coincidence that the OSes I've seen happen to traverse the
&gt; PCI topology in a manner that results in the guest OS numbering the
&gt; buses the same as they are numbered in libvirt XML that has had PCI
&gt; addresses auto-assigned by libvirt, but it is trivial to make this *not*
&gt; happen. For example, if you changed the config so that the bus with
&gt; index='2' (pcie.2) was attached to pcie.0, addr=0x1.0x1 (i.e. change its
&gt; PCI address to &lt;address type='pci' bus='0' slot='1' function='1'/&gt;" ,
&gt; and the bus with index='3' was attached to pcie.0, addr=0x1.0x2, then
&gt; the guest would number "pcie.2" as bus 1, and "pcie.1" as bus 2.
&gt; 
&gt; And of course the guest OS is free to traverse the controller topology
&gt; in any manner it wants, so the bus numbering in the guest could be
&gt; different even if the libvirt-generated QEMU commandline was the same.
&gt; 
&gt; *HOWEVER*, slot (device) and function number are specified on the QEMU
&gt; commandline numerically, and they will appear in the guest exactly as
&gt; they are in the libvirt XML.
&gt; 
&gt; 
&gt; 
&gt; &gt; infact, over the last 10 years I've booted thousand of systems both bare metal \
&gt; &gt; and visualized and never encountered such scenario. that said, it might be a bug \
&gt; &gt; in qemu. &gt; what I did saw is that on the old vm in guest, after the upgrade the \
&gt; &gt; sound card was defined as a function of the scsi virtblk controller and the new \
&gt; &gt; vm placed it as a function of non existent device.
&gt; 
&gt; I would be very interested in seeing the libvirt XML, QEMU commandline,
&gt; and guest-side output of "lspci" for this. I can't think of any way this
&gt; could happen without a serious bug *somewhere* (or manual intervention
&gt; in the PCI addresses in the guest).
of the system with the sound issue? if so, I'll need to digg in my logs, the most \
problematic part is the guest lspci


&gt; 
&gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; On the topic of having a dmi-to-pci-bridge show up in your XML: I don't
&gt; &gt; &gt; remember what versions the changes were in (it was at least a year or
&gt; &gt; &gt; two ago), but only a fairly old version of libvirt woud do that - 1)
&gt; &gt; &gt; recent libvirt will assume that any hostdev PCI device is a PCIe device,
&gt; &gt; &gt; so it will add a pcie-root-port and assign the hostdev device to slot 0
&gt; &gt; &gt; of that root-port, and even before that 2) we switched from using
&gt; &gt; &gt; dmi-to-pci-bridge to using pcie-to-pci-bridge quite some time ago as well.
&gt; &gt; as stated in the original mail, the issue started after a major version upgrade \
&gt; &gt; of both libvirt and qemu, I'm currently using latest stable afaik.
&gt; 
&gt; Right. If your guest was defined the first time using a much older
&gt; libvirt, then devices would have been assigned to an auto-created
&gt; dmi-to-pci-bridge at that time, and if you don't change (or remove) the
&gt; PCI addresses of the devices or the bridge, then that will all be
&gt; maintained whenever you restart the guest, ragardless of libvirt
&gt; upgrades. But this again points out that the guest-side PCI addresses
&gt; (which are determined by the PCI addresses in the libvirt config) should
&gt; not change when upgrading libvirt (NOTE: 1) libvirt will only
&gt; auto-assign a new PCI address to a device if it doesn't already have a
&gt; PCI address assigned to it, and 2) libvirt *never* auto-assigns a non-0
&gt; function except when adding a pcie-root-port (and in that case it will
&gt; always first assign something to function 0))
then I wonder how the upgrade broke the system, in contrast, the other vm I'm running \
(router with 5 nics in pt) worked out of the box

&gt; 
&gt; 
&gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; So if you're generating new XML based on config that doesn't have pci
&gt; &gt; &gt; controllers already in it, and you're seeing hostdevs (or any other PCI
&gt; &gt; &gt; devices) assigned to an automatically-added dmi-to-pci-bridge, then your
&gt; &gt; &gt; libvirt version is severely out of date.
&gt; &gt; here are the version I'm using:
&gt; &gt; # emerge --search app-emulation/libvirt app-emulation/qemu
&gt; &gt; 
&gt; &gt; [ Results for search key : app-emulation/libvirt ]
&gt; &gt; Searching...
&gt; &gt; 
&gt; &gt; *  app-emulation/libvirt
&gt; &gt; Latest version available: 7.5.0
&gt; &gt; Latest version installed: 7.5.0
&gt; &gt; Size of files: 9749 KiB
&gt; &gt; Homepage:      https://www.libvirt.org/ https://gitlab.com/libvirt/libvirt/
&gt; &gt; Description:   C toolkit to manipulate virtual machines
&gt; &gt; License:       LGPL-2.1
&gt; &gt; 
&gt; &gt; [ Applications found : 1 ]
&gt; &gt; 
&gt; &gt; 
&gt; &gt; [ Results for search key : app-emulation/qemu ]
&gt; &gt; Searching...
&gt; &gt; 
&gt; &gt; *  app-emulation/qemu
&gt; &gt; Latest version available: 6.0.0-r52
&gt; &gt; Latest version installed: 6.0.0-r52
&gt; &gt; Size of files: 22724 KiB
&gt; &gt; Homepage:      http://www.qemu.org http://www.linux-kvm.org
&gt; &gt; Description:   QEMU + Kernel-based Virtual Machine userland tools
&gt; &gt; License:       GPL-2 LGPL-2 BSD-2
&gt; &gt; 
&gt; &gt; [ Applications found : 1 ]
&gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; On 8/11/21 2:53 PM, daggs wrote:
&gt; &gt; &gt; &gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; On Wed, Aug 11, 2021 at 03:09:34PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; I can diff the original xml with the new one to see the diffs and
&gt; &gt; &gt; post them here if you wish
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; Would be nice to see if there are any differences.  The newly created
&gt; &gt; &gt; &gt; &gt; &gt; one works then?
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; I'll sent it later today
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; here: https://dpaste.com/5VBUU8Z9W
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; &gt; my fix was to move the device to 00:1f.4 in the guest.
&gt; &gt; &gt; 
&gt; &gt; &gt; That's an interesting choice :-). You could have just put it on function
&gt; &gt; &gt; 0 of some other unused slot (or a non-0 function of the slot the GPU is
&gt; &gt; &gt; assigned to). 00:1f is used for integrated devices on the Q35 chipset -
&gt; &gt; &gt; it's nice that QEMU's emulation code was written to allowing adding more
&gt; &gt; &gt; devices on that slot, but I wouldn't have been surprised if it had
&gt; &gt; &gt; caused problems...
&gt; &gt; 10 years of working in a virtualization company has taught me that somethings, \
&gt; &gt; keeping the pci structure close as much as possible to the original is the best \
&gt; &gt; way to go. that is why I chose it a s func, it is a func on the host mahcine.
&gt; 
&gt; It wasn't a function of a slot that also contains integrated chipset
&gt; devices though.... Oh, wait. According to the XML you reference down
&gt; below, it looks like the audio device you're assigning to the guest *is
&gt; itself* integrated on the chipset of the host, is that right?
&gt; 
&gt; (It's interesting that this function of slot 1F is apparently in a
&gt; different IOMMU group than the other functions of slot 1F. I would have
&gt; guessed they would all be in the same IOMMU group, resulting in an
&gt; inability to assign this one function to the guest without at least
&gt; disabling the other devices on slot 1F (by binding them to the vfio-pci
&gt; driver)
I'm using the pcie acs override patch to split the soundcard and the nic as they \
belong in different vms.

&gt; 
&gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; &gt; I won't be surprised this was the issue why the vm didn't booted after the \
&gt; &gt; &gt; &gt; upgrade with the old xml.
&gt; &gt; &gt; 
&gt; &gt; &gt; Well, if your XML had a device assigned to a non-0 function of a slot
&gt; &gt; &gt; and no device in function 0 of that slot, it would have failed to work
&gt; &gt; &gt; previously as well (my recollection is that in this case it's more a
&gt; &gt; &gt; problem of the guest OS not probing non-0 functions when there is
&gt; &gt; &gt; nothing on function 0, and not with anything done by QEMU).
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; here is the xml of the machine after I've recreated it, it worked but no sound: \
&gt; &gt; https://dpaste.com/BB9EDY6BK I used virt-manager. note that the sound card pt is \
&gt; &gt; placed as a func in bus 0x8 which doesn't exists.
&gt; 
&gt; This doesn't show any devices assigned to non-0 functions in the guest
&gt; (which is the part of what you said in previous messages that sounded
&gt; wrong to me). (except for the SATA controller, which is listed in the
&gt; libvirt config only for informational purposes, as it is hardcoded into
&gt; the basic q35 virtual machine and can't be removed).
&gt; 
&gt; What is does show is that there is a device a 00:1F.3 *on the host* that
&gt; is being assigned to 08:01.00 (slot 1, function 0 of the
&gt; pcie-pci-bridge) in the guest. I'm guessing this is the audio device?
&gt; Also in this version of the XML, there is no longer a dmi-to-pci-bridge,
&gt; but there is instead a pcie-to-pci-bridge, implying that you've
&gt; redefined the guest config, resulting in PCI address auto-assignment
&gt; being re-run (at least relative to the config you referenced last week
&gt; that had a dmi-to-pci-bridge).
&gt; 
&gt; It's possible that the audio device's driver just doesn't like the
&gt; device being on a standard PCI (i.e. non-PCIe) slot in the guest
&gt; somehow, since it's a chipset-integrated PCIe device on the host. I
&gt; haven't heard of that being the case in the past, but it's possible.
&gt; 
&gt; 
&gt; Anyway, at this point I've lost track of all the changes that have
&gt; happened (your update entailed much more than just updating the libvirt
&gt; package - your guest config was also changed/redefined) so I don't know
&gt; how much more effort should be expended with post-mortem, especially
&gt; since you now have it working. One thing that I would note is that we
&gt; should probably be auto-assigning integrated chipset devices to
&gt; pcie-root-ports rather than to a pci-bridge (I thought we already did
&gt; that, but I can see how we might not).
&gt; 
&gt; 
I'll try to sum it up, prior to upgrade, both vms worked.
after the upgrade, only the router vm worked, the streamer one started and never ran,
I've started experimenting with qemu cmdline invocation, I've got to a situation \
where the vm was up and running with every thing defined beside the nic link active. \
this lead me to believe that the issue is with my config. I've tried to downgrade to \
previous versions however the vm still didn't booted. I've then reached the \
assumption that following the upgrade, the vm's xml was changed. because I didn't had \
the previous xml, I cannot verify. my next step was to recreate the vm's xml using \
virt-manager under the assumption that new config defined by virt-manager will work. \
that was partially correct, after the recreation was completed, the vm booted however \
the hdmi sound wasn't found. this sent me back to the qemu cmdline as I had a working \
cmd line invocation. I've started adding and removing entries from the generated qemu \
line to the working cmd and found out that the issue was caused because of the \
-nodefaults switch in qemu. this lead me to inspect the pci tree created and found \
out that in my working scenario, the sound card was placed in 00:02.0 and in the \
malfunctioning scenario, the sound card was placed at 02:01.0 (got screen shots of \
it) this lead me to the conclusion that the pci config might cause it, moving it to \
1f.x worked

Thanks,

Dagg


</body></email><email><emailId>20210829202553</emailId><senderName>Laine Stump</senderName><senderEmail>laine@redhat.com</senderEmail><timestampReceived>2021-08-29 20:25:53-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>

(Alex - search for your name down in the middle of this - there is one 
question for you. You can probably save your neurons the trouble of 
reading the rest)

On 8/28/21 6:56 AM, daggs wrote:
&gt; Greetings Laine,
&gt; 
&gt; &gt; Sent: Wednesday, August 25, 2021 at 7:53 PM
&gt; &gt; From: "Laine Stump" &lt;laine@redhat.com&gt;
&gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; 
&gt; &gt; On 8/20/21 12:07 PM, daggs wrote:
&gt; &gt; &gt; Greetings Laine,
&gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Sent: Monday, August 16, 2021 at 12:57 AM
&gt; &gt; &gt; &gt; From: "Laine Stump" &lt;laine@redhat.com&gt;
&gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; Cc: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; On 8/14/21 6:05 AM, daggs wrote:
&gt; &gt; &gt; &gt; &gt; Greetings Martin,
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; Sent: Thursday, August 12, 2021 at 2:07 PM
&gt; &gt; &gt; &gt; &gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; To: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Thursday, August 12, 2021 at 11:49 AM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; On Wed, Aug 11, 2021 at 08:53:10PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Greetings Martin,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Wednesday, August 11, 2021 at 6:08 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Greetings Martin,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Wednesday, August 11, 2021 at 4:13 PM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; On Wed, Aug 11, 2021 at 03:09:34PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Greetings Martin,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sent: Wednesday, August 11, 2021 at 10:14 AM
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Cc: dan@berrange.com, libvirt-users@redhat.com
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Subject: Re: issues with vm after upgrade
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; [...]
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 2) To your issue with starting the domain it would be good to \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; know what is the error you get from virsh (or however you are \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; starting the domain) and the debug logs of libvirtd, ideally \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; just for the part of the domain starting.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; that is the issue, there wasn't any error. the vm just didn't \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; booted.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Oh, so I misunderstood.  What was the state of the VM in libvirt?
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; "paused" or "running"?  Was there serial console working?
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; it was marked as running and there was no serial
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; That's a pity we could not examine what was actually happening.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; I can diff the original xml with the new one to see the diffs \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; and post them here if you wish 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Would be nice to see if there are any differences.  The newly \
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; created one works then?
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; I'll sent it later today
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; here: https://dpaste.com/5VBUU8Z9W
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Unfortunately there are many differences there.  The machine type
&gt; &gt; &gt; &gt; &gt; &gt; &gt; changes _something_ in qemu, there is different PCI(e) topology, and I
&gt; &gt; &gt; &gt; &gt; &gt; &gt; do not think I will be able to figure this out without the non-working
&gt; &gt; &gt; &gt; &gt; &gt; &gt; machine.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; So if your current setup works for you right now I'd leave figuring out
&gt; &gt; &gt; &gt; &gt; &gt; &gt; the previous issue to others, if there is anyone wanting to figure out
&gt; &gt; &gt; &gt; &gt; &gt; &gt; if there is some libvirt issue.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Have a nice day
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; my current setup works beside the hdmi audio, this I still need to \
&gt; &gt; &gt; &gt; &gt; &gt; investigate. 
&gt; &gt; &gt; &gt; &gt; &gt; thanks for your help.
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; Dagg
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; just to update, I've solved the sound issue, frankly, I don't understand \
&gt; &gt; &gt; &gt; &gt; how the guest showed a soundcard in the first place. from what I gather, \
&gt; &gt; &gt; &gt; &gt; libvirt sets the -nodefaults flag to prepare the vm's properties from \
&gt; &gt; &gt; &gt; &gt; scratch. in this situation, the sound card is a function in the host \
&gt; &gt; &gt; &gt; &gt; machine's pci tree. when libvirt created the pci tree for the guest, it \
&gt; &gt; &gt; &gt; &gt; placed the card as a function of a device as well, in my case 02:00.2 \
&gt; &gt; &gt; &gt; &gt; however it didn't created a device at 02:00.0.
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Are you basing this claim on the libvirt XML? Or on what you see with
&gt; &gt; &gt; &gt; lspci in the guest?
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; When libvirt is assigning PCI addresses to devices in a guest, it will
&gt; &gt; &gt; &gt; never auto-assign a non-0 function. This will only happen if the user
&gt; &gt; &gt; &gt; explicitly requests it (and even then, iirc, libvirt should generate an
&gt; &gt; &gt; &gt; error if function 0 of the same slot has no device - something to the
&gt; &gt; &gt; &gt; effect of "no device on function 0 of a multifunction device").
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Anyway, when I looked back at the XML diff you posted earlier (see
&gt; &gt; &gt; &gt; below), I didn't see any hostdev device assigned to 02:00.2. What I
&gt; &gt; &gt; &gt; *did* see was that in both the old and the new version of the diff, the
&gt; &gt; &gt; &gt; hostdev devices were assigned to function 0 of different *slots* on a
&gt; &gt; &gt; &gt; dmi-to-pci-bridge controller, which should cause no problems (unless
&gt; &gt; &gt; &gt; there is a bug in QEMU's dmi-to-pci-bridge). (The important thing,
&gt; &gt; &gt; &gt; though, is that there is no hostdev device on a non-0 function, and when
&gt; &gt; &gt; &gt; it is on a non-0 slot, that's because it's on a dmi-to-pci-bridge (which
&gt; &gt; &gt; &gt; has 32 slots).
&gt; &gt; 
&gt; &gt; &gt; I saw it in guest,
&gt; &gt; 
&gt; &gt; But I didn't see it in the XML diffs that you had posted.
&gt; as mentioned below, here is the xml of the new vm but with the sound problem: \
&gt; https://dpaste.com/BB9EDY6BK the relevant entry is at \
&gt; https://dpaste.com/BB9EDY6BK#line-130 you can see that the bdf is 08:01.0, note \
&gt; that there is no device defined at 08:00.0. I may be wrong and there is no need for \
&gt; such device but if I run lspci on both my linux system, I don't see device with \
&gt; such scenario.

Ah, that is a device at a non-0 *slot*, not a non-zero function - that 
is bus 8, slot 1, function 0. You would never see that on a 
*pcie-root-port* (where only slot 0 is usable), but your bus 8 is a 
pcie-to-pci-bridge, where it is normal - they have 32 slots like the 
root bus, and slot 0 is reserved for SHPC hotplug. Making slot 0 usable 
requires disabling SHPC hotplug as it is enabled by default, and libvirt 
doesn't even have a way to turn it on/off (since the only advantage is 
that you have 32 slots instead of 31). So this config is correct (at 
least if the device is to be put on a conventional PCI slot rather than 
PCIe). It's possible that there is a bug in the pcie-to-pci-bridge in 
QEMU, or in the guest's handling of devices on such a bridge though. 
Since you say it worked before the upgrade, I'm inclined to think it's 
the former.

(the thing about requiring something on "0" in order to have something 
on a "non-0" is for functions, not slots - most (all?) OSes will not 
scan the non-0 functions of a slot if they see no device on function 0. 
That's not the case for the 32 (31 usable) slots on a conventional PCI 
bus though; they are all scanned regardless of any empty gaps).


&gt; note that the new vm was created using virt-manager, so the address wasn't \
&gt; allocated by me 
&gt; &gt; 
&gt; &gt; &gt; I'd assume that if libvirt defines a device on a specific bdf, the guest will \
&gt; &gt; &gt; not change it.
&gt; &gt; 
&gt; &gt; That's not exactly true - the bus "number" in libvirt isn't given to
&gt; &gt; qemu as an actual number, but as an alphanumeric device id (called
&gt; &gt; "alias name" in libvirt XML). QEMU doesn't have any concept of "bus
&gt; &gt; number", because (afaiu) there is no way to convey such info to the
&gt; &gt; guest firmware/OS; instead, QEMU creates a topology of interconnected
&gt; &gt; controllers, the firmware and/or OS traverses this topology and assigns
&gt; &gt; numbers to the encountered controllers as it sees fit.
&gt; so bottom line, libvirt defines the "order" of he device and qemu creates however \
&gt; he wants but maintains libvirt's "order"?

Well, libvirt does put them on the qemu commandline in a specific order, 
but AFAIU that ordering can't be propagated to the guest - the guest is 
presented with the "root" of the PCI topology ("pci-root" on 440fx and 
"pcie-root" on Q35), and discovers all the other buses by traversing the 
entire tree in whatever order it chooses (I would guest that it would 
start looking in the 1st slot of pcie-root, but don't know if it does a 
depth-first traversal, or breadth-first traversal).

&gt; 
&gt; &gt; 
&gt; &gt; So you may have PCI controllers with indexes 1, 2, and 3 in your libvirt
&gt; &gt; config, but those will be described on the QEMU commandline as
&gt; &gt; controllers "pcie.1", "pcie.2", and "pcie.3":
&gt; &gt; 
&gt; &gt; -device
&gt; &gt; pcie-root-port,port=0x8,chassis=1,id=pci.1,bus=pcie.0,multifunction=on,addr=0x1
&gt; &gt; \
&gt; &gt; -device pcie-root-port,port=0x9,chassis=2,id=pci.2,bus=pcie.0,addr=0x1.0x1 \
&gt; &gt; -device pcie-root-port,port=0xa,chassis=3,id=pci.3,bus=pcie.0,addr=0x1.0x2 \
&gt; &gt; 
&gt; &gt; and when a PCI device is attached to one of these controllers, the QEMU
&gt; &gt; commandline uses the id name of the controller, not a bus number:
&gt; &gt; 
&gt; &gt; -device vfio-pci,host=0000:05:00.0,bus=pci.1,multifunction=on,addr=0x0 \
&gt; &gt; -device vfio-pci,host=0000:05:00.1,id=hostdev1,bus=pci.1,addr=0x0.0x1 \
&gt; &gt; 
&gt; &gt; It is a nice coincidence that the OSes I've seen happen to traverse the
&gt; &gt; PCI topology in a manner that results in the guest OS numbering the
&gt; &gt; buses the same as they are numbered in libvirt XML that has had PCI
&gt; &gt; addresses auto-assigned by libvirt, but it is trivial to make this *not*
&gt; &gt; happen. For example, if you changed the config so that the bus with
&gt; &gt; index='2' (pcie.2) was attached to pcie.0, addr=0x1.0x1 (i.e. change its
&gt; &gt; PCI address to &lt;address type='pci' bus='0' slot='1' function='1'/&gt;" ,
&gt; &gt; and the bus with index='3' was attached to pcie.0, addr=0x1.0x2, then
&gt; &gt; the guest would number "pcie.2" as bus 1, and "pcie.1" as bus 2.
&gt; &gt; 
&gt; &gt; And of course the guest OS is free to traverse the controller topology
&gt; &gt; in any manner it wants, so the bus numbering in the guest could be
&gt; &gt; different even if the libvirt-generated QEMU commandline was the same.
&gt; &gt; 
&gt; &gt; *HOWEVER*, slot (device) and function number are specified on the QEMU
&gt; &gt; commandline numerically, and they will appear in the guest exactly as
&gt; &gt; they are in the libvirt XML.
&gt; &gt; 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; &gt; infact, over the last 10 years I've booted thousand of systems both bare metal \
&gt; &gt; &gt; and visualized and never encountered such scenario. that said, it might be a \
&gt; &gt; &gt; bug in qemu. &gt; what I did saw is that on the old vm in guest, after the upgrade \
&gt; &gt; &gt; the sound card was defined as a function of the scsi virtblk controller and the \
&gt; &gt; &gt; new vm placed it as a function of non existent device.
&gt; &gt; 
&gt; &gt; I would be very interested in seeing the libvirt XML, QEMU commandline,
&gt; &gt; and guest-side output of "lspci" for this. I can't think of any way this
&gt; &gt; could happen without a serious bug *somewhere* (or manual intervention
&gt; &gt; in the PCI addresses in the guest).
&gt; of the system with the sound issue? if so, I'll need to digg in my logs, the most \
&gt; problematic part is the guest lspci

Now that we've determined the device was assigned to function 0 of a 
non-zero slot on a standard PCI bridge, it all makes sense, so that is 
no longer necessary.

&gt; 
&gt; 
&gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; On the topic of having a dmi-to-pci-bridge show up in your XML: I don't
&gt; &gt; &gt; &gt; remember what versions the changes were in (it was at least a year or
&gt; &gt; &gt; &gt; two ago), but only a fairly old version of libvirt woud do that - 1)
&gt; &gt; &gt; &gt; recent libvirt will assume that any hostdev PCI device is a PCIe device,
&gt; &gt; &gt; &gt; so it will add a pcie-root-port and assign the hostdev device to slot 0
&gt; &gt; &gt; &gt; of that root-port, and even before that 2) we switched from using
&gt; &gt; &gt; &gt; dmi-to-pci-bridge to using pcie-to-pci-bridge quite some time ago as well.
&gt; &gt; &gt; as stated in the original mail, the issue started after a major version upgrade \
&gt; &gt; &gt; of both libvirt and qemu, I'm currently using latest stable afaik.
&gt; &gt; 
&gt; &gt; Right. If your guest was defined the first time using a much older
&gt; &gt; libvirt, then devices would have been assigned to an auto-created
&gt; &gt; dmi-to-pci-bridge at that time, and if you don't change (or remove) the
&gt; &gt; PCI addresses of the devices or the bridge, then that will all be
&gt; &gt; maintained whenever you restart the guest, ragardless of libvirt
&gt; &gt; upgrades. But this again points out that the guest-side PCI addresses
&gt; &gt; (which are determined by the PCI addresses in the libvirt config) should
&gt; &gt; not change when upgrading libvirt (NOTE: 1) libvirt will only
&gt; &gt; auto-assign a new PCI address to a device if it doesn't already have a
&gt; &gt; PCI address assigned to it, and 2) libvirt *never* auto-assigns a non-0
&gt; &gt; function except when adding a pcie-root-port (and in that case it will
&gt; &gt; always first assign something to function 0))
&gt; then I wonder how the upgrade broke the system, in contrast, the other vm I'm \
&gt; running (router with 5 nics in pt) worked out of the box

If I'm remembering correctly, you got it to work by manually putting the 
audio device on 00:1F.3 (functions 0-2 of that slot are used by 
integrated chipset devices, e.g. the SATA controller). I'd be curious if 
it worked properly if the audio card was manually assigned to:

1) function 0 of an otherwise unused slot on bus 0. (reading further, it 
looks like your tried that (00:02.0) and it did work)

2) slot 0, function 0 of a new pcie-root-port

I'm guessing that both of these would work properly.

I also wonder if other devices manually assigned to different slots on 
bus 8 (the pcie-to-pci-bridge) would work properly. My top suspicions 
are that 1) there is some sort of bug wrt the pcie-to-pci-bridge in 
general, or 2) there is some sort of bug wrt doing vfio assignment of a 
device onto a pcie-to-pci-bridge (or maybe it's even specific to 
assigning an integrated chipset device from the host onto the 
pcie-to-pci-bridge).

I just looked back at the code that decides whether a device is 
conventional PCI or PCIe for the first time in a few years 
(virPCIDeviceInit) and it looks like it might consider integrated 
chipset devices to be conventional PCI (since they don't have any 
"Express Capabilities Data"); this would explain why it's wanting to 
assign it to a pcie-to-pci-bridge. Maybe we should just always assign 
devices to PCIe slots when the guest is Q35 though. Alex - what's your 
opinion about this?

&gt; 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; So if you're generating new XML based on config that doesn't have pci
&gt; &gt; &gt; &gt; controllers already in it, and you're seeing hostdevs (or any other PCI
&gt; &gt; &gt; &gt; devices) assigned to an automatically-added dmi-to-pci-bridge, then your
&gt; &gt; &gt; &gt; libvirt version is severely out of date.
&gt; &gt; &gt; here are the version I'm using:
&gt; &gt; &gt; # emerge --search app-emulation/libvirt app-emulation/qemu
&gt; &gt; &gt; 
&gt; &gt; &gt; [ Results for search key : app-emulation/libvirt ]
&gt; &gt; &gt; Searching...
&gt; &gt; &gt; 
&gt; &gt; &gt; *  app-emulation/libvirt
&gt; &gt; &gt; Latest version available: 7.5.0
&gt; &gt; &gt; Latest version installed: 7.5.0
&gt; &gt; &gt; Size of files: 9749 KiB
&gt; &gt; &gt; Homepage:      https://www.libvirt.org/ https://gitlab.com/libvirt/libvirt/
&gt; &gt; &gt; Description:   C toolkit to manipulate virtual machines
&gt; &gt; &gt; License:       LGPL-2.1
&gt; &gt; &gt; 
&gt; &gt; &gt; [ Applications found : 1 ]
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; [ Results for search key : app-emulation/qemu ]
&gt; &gt; &gt; Searching...
&gt; &gt; &gt; 
&gt; &gt; &gt; *  app-emulation/qemu
&gt; &gt; &gt; Latest version available: 6.0.0-r52
&gt; &gt; &gt; Latest version installed: 6.0.0-r52
&gt; &gt; &gt; Size of files: 22724 KiB
&gt; &gt; &gt; Homepage:      http://www.qemu.org http://www.linux-kvm.org
&gt; &gt; &gt; Description:   QEMU + Kernel-based Virtual Machine userland tools
&gt; &gt; &gt; License:       GPL-2 LGPL-2 BSD-2
&gt; &gt; &gt; 
&gt; &gt; &gt; [ Applications found : 1 ]
&gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; On 8/11/21 2:53 PM, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; From: "daggs" &lt;daggs@gmx.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; From: "Martin Kletzander" &lt;mkletzan@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; On Wed, Aug 11, 2021 at 03:09:34PM +0200, daggs wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; I can diff the original xml with the new one to see the diffs and
&gt; &gt; &gt; &gt; post them here if you wish
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Would be nice to see if there are any differences.  The newly created
&gt; &gt; &gt; &gt; &gt; &gt; &gt; one works then?
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; I'll sent it later today
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; here: https://dpaste.com/5VBUU8Z9W
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; my fix was to move the device to 00:1f.4 in the guest.
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; That's an interesting choice :-). You could have just put it on function
&gt; &gt; &gt; &gt; 0 of some other unused slot (or a non-0 function of the slot the GPU is
&gt; &gt; &gt; &gt; assigned to). 00:1f is used for integrated devices on the Q35 chipset -
&gt; &gt; &gt; &gt; it's nice that QEMU's emulation code was written to allowing adding more
&gt; &gt; &gt; &gt; devices on that slot, but I wouldn't have been surprised if it had
&gt; &gt; &gt; &gt; caused problems...
&gt; &gt; &gt; 10 years of working in a virtualization company has taught me that somethings, \
&gt; &gt; &gt; keeping the pci structure close as much as possible to the original is the best \
&gt; &gt; &gt; way to go. that is why I chose it a s func, it is a func on the host mahcine.
&gt; &gt; 
&gt; &gt; It wasn't a function of a slot that also contains integrated chipset
&gt; &gt; devices though.... Oh, wait. According to the XML you reference down
&gt; &gt; below, it looks like the audio device you're assigning to the guest *is
&gt; &gt; itself* integrated on the chipset of the host, is that right?
&gt; &gt; 
&gt; &gt; (It's interesting that this function of slot 1F is apparently in a
&gt; &gt; different IOMMU group than the other functions of slot 1F. I would have
&gt; &gt; guessed they would all be in the same IOMMU group, resulting in an
&gt; &gt; inability to assign this one function to the guest without at least
&gt; &gt; disabling the other devices on slot 1F (by binding them to the vfio-pci
&gt; &gt; driver)
&gt; I'm using the pcie acs override patch to split the soundcard and the nic as they \
&gt; belong in different vms.

Is the NIC in the other guest assigned to a pcie-to-pci-bridge? Or is it 
assigned to a pcie-root-port?

&gt; 
&gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; I won't be surprised this was the issue why the vm didn't booted after the \
&gt; &gt; &gt; &gt; &gt; upgrade with the old xml.
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Well, if your XML had a device assigned to a non-0 function of a slot
&gt; &gt; &gt; &gt; and no device in function 0 of that slot, it would have failed to work
&gt; &gt; &gt; &gt; previously as well (my recollection is that in this case it's more a
&gt; &gt; &gt; &gt; problem of the guest OS not probing non-0 functions when there is
&gt; &gt; &gt; &gt; nothing on function 0, and not with anything done by QEMU).
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; here is the xml of the machine after I've recreated it, it worked but no sound: \
&gt; &gt; &gt; https://dpaste.com/BB9EDY6BK I used virt-manager. note that the sound card pt \
&gt; &gt; &gt; is placed as a func in bus 0x8 which doesn't exists.
&gt; &gt; 
&gt; &gt; This doesn't show any devices assigned to non-0 functions in the guest
&gt; &gt; (which is the part of what you said in previous messages that sounded
&gt; &gt; wrong to me). (except for the SATA controller, which is listed in the
&gt; &gt; libvirt config only for informational purposes, as it is hardcoded into
&gt; &gt; the basic q35 virtual machine and can't be removed).
&gt; &gt; 
&gt; &gt; What is does show is that there is a device a 00:1F.3 *on the host* that
&gt; &gt; is being assigned to 08:01.00 (slot 1, function 0 of the
&gt; &gt; pcie-pci-bridge) in the guest. I'm guessing this is the audio device?
&gt; &gt; Also in this version of the XML, there is no longer a dmi-to-pci-bridge,
&gt; &gt; but there is instead a pcie-to-pci-bridge, implying that you've
&gt; &gt; redefined the guest config, resulting in PCI address auto-assignment
&gt; &gt; being re-run (at least relative to the config you referenced last week
&gt; &gt; that had a dmi-to-pci-bridge).
&gt; &gt; 
&gt; &gt; It's possible that the audio device's driver just doesn't like the
&gt; &gt; device being on a standard PCI (i.e. non-PCIe) slot in the guest
&gt; &gt; somehow, since it's a chipset-integrated PCIe device on the host. I
&gt; &gt; haven't heard of that being the case in the past, but it's possible.
&gt; &gt; 
&gt; &gt; 
&gt; &gt; Anyway, at this point I've lost track of all the changes that have
&gt; &gt; happened (your update entailed much more than just updating the libvirt
&gt; &gt; package - your guest config was also changed/redefined) so I don't know
&gt; &gt; how much more effort should be expended with post-mortem, especially
&gt; &gt; since you now have it working. One thing that I would note is that we
&gt; &gt; should probably be auto-assigning integrated chipset devices to
&gt; &gt; pcie-root-ports rather than to a pci-bridge (I thought we already did
&gt; &gt; that, but I can see how we might not).
&gt; &gt; 
&gt; &gt; 
&gt; I'll try to sum it up, prior to upgrade, both vms worked.
&gt; after the upgrade, only the router vm worked, the streamer one started and never \
&gt; ran, I've started experimenting with qemu cmdline invocation, I've got to a \
&gt; situation where the vm was up and running with every thing defined beside the nic \
&gt; link active. this lead me to believe that the issue is with my config.
&gt; I've tried to downgrade to previous versions however the vm still didn't booted.
&gt; I've then reached the assumption that following the upgrade, the vm's xml was \
&gt; changed. because I didn't had the previous xml, I cannot verify. my next step was \
&gt; to recreate the vm's xml using virt-manager under the assumption that new config \
&gt; defined by virt-manager will work. that was partially correct, after the recreation \
&gt; was completed, the vm booted however the hdmi sound wasn't found. this sent me back \
&gt; to the qemu cmdline as I had a working cmd line invocation. I've started adding and \
&gt; removing entries from the generated qemu line to the working cmd and found out that \
&gt; the issue was caused because of the -nodefaults switch in qemu. this lead me to \
&gt; inspect the pci tree created and found out that in my working scenario, the sound \
&gt; card was placed in 00:02.0 and in the malfunctioning scenario,

How did this happen? Was it a case where you created the qemu 
commandline yourself and didn't provide a PCI address for the soundcard 
on the commandline? (that must be what happened since, with only a few 
specific exceptions with emulated devices that are part of the Q35 
chipset, libvirt wouldn't auto-assign a device to anywhere on bus 0 of a 
Q35 guest).

&gt; the sound card was placed at 02:01.0 (got screen shots of it)
&gt; this lead me to the conclusion that the pci config might cause it, moving it to \
&gt; 1f.x worked

I remember there being some trouble with the pcie-to-pci-bridge in the 
past (seems like it was devices being automatically unplugged after a 
short time). I thought that was long ago fixed (in QEMU) but maybe I'm 
wrong. In the end I think it's best to avoid pci-to-pcie-bridges (which 
is why I asked Alex above if he thought it would be okay to just assign 
host integrated devices to pcie-root-ports rather than treating them 
like conventional PCI)


</body></email><email><emailId>20210823154443</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-08-23 15:44:43-0400</timestampReceived><subject>Re: Question The order of the output of virsh guestinfo --filesystem</subject><body>

On 8/23/21 1:19 PM, liuyd.fnst@fujitsu.com wrote:
&gt; Hi all.
&gt; 
&gt; I'm curious about the output order of virsh guestinfo --filesystem.
&gt; Is the output random?


&gt; virsh guestinfo output.
&gt; It is not sorted by   name or total-bytes/used-bytes

It's in whatever order the guest agent reported. And looking into the
guest agent source code it's parsing /proc/self/mountinfo. So there's no
order guaranteed.

Michal

</body></email><email><emailId>20210816083516</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-08-16 08:35:16-0400</timestampReceived><subject>Re: a test email (&amp; dmarc) @admins</subject><body>

On Sat, Aug 14, 2021 at 09:38:50AM +0100, lejeczek wrote:
&gt; hi guys.
&gt; I sent email a while ago and I wonder, also having not received a single
&gt; reply, because I did not get that own email - is there are problem I'm
&gt; having here or DMARC(yahoo &amp; others?) are not fixed in by this mailing list
&gt; - would an admin(anybody) know?

This mailing list (and all hosted on redhat.com) are seriously broken
when senders have strict DMARC settings. This hits everyone posting
from @yahoo.* addresses - mail still gets sent out by the list, but
a large number of receipients mail servers will throw it away due to
DMARC violation.  I've had tickets open with our mail provider for
a year &amp; a half now but progress fixing it is painfully slow.

Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20210816182325</emailId><senderName>lejeczek</senderName><senderEmail>peljasz@yahoo.co.uk</senderEmail><timestampReceived>2021-08-16 18:23:25-0400</timestampReceived><subject>Re: a test email (&amp; dmarc) @admins</subject><body>



On 16/08/2021 09:35, Daniel P. Berrangé wrote:
&gt; On Sat, Aug 14, 2021 at 09:38:50AM +0100, lejeczek wrote:
&gt;&gt; hi guys.
&gt;&gt; I sent email a while ago and I wonder, also having not received a single
&gt;&gt; reply, because I did not get that own email - is there are problem I'm
&gt;&gt; having here or DMARC(yahoo &amp; others?) are not fixed in by this mailing list
&gt;&gt; - would an admin(anybody) know?
&gt; This mailing list (and all hosted on redhat.com) are seriously broken
&gt; when senders have strict DMARC settings. This hits everyone posting
&gt; from @yahoo.* addresses - mail still gets sent out by the list, but
&gt; a large number of receipients mail servers will throw it away due to
&gt; DMARC violation.  I've had tickets open with our mail provider for
&gt; a year &amp; a half now but progress fixing it is painfully slow.
&gt;
&gt; Regards,
&gt; Daniel
not all, which fact is most intriguing to me - as if there 
were no communication on some fundamental level and each 
mailman(s) admin(s) lived in a separate closet.
One such example where guys had it for very long (if not 
always) fixed in is freeIPA mailing list, but there is a few 
more I'm subscribed to "owned" by Redhat which work.

many thanks, L.

</body></email><email><emailId>20211210120057</emailId><senderName>lejeczek</senderName><senderEmail>peljasz@yahoo.co.uk</senderEmail><timestampReceived>2021-12-10 12:00:57-0400</timestampReceived><subject>Re: a test email (&amp; dmarc) @admins</subject><body>



On 16/08/2021 19:36, Daniel P. Berrangé wrote:
&gt; On Mon, Aug 16, 2021 at 07:23:25PM +0100, lejeczek wrote:
&gt;&gt;
&gt;&gt; On 16/08/2021 09:35, Daniel P. Berrangé wrote:
&gt;&gt;&gt; On Sat, Aug 14, 2021 at 09:38:50AM +0100, lejeczek wrote:
&gt;&gt;&gt;&gt; hi guys.
&gt;&gt;&gt;&gt; I sent email a while ago and I wonder, also having not received a single
&gt;&gt;&gt;&gt; reply, because I did not get that own email - is there are problem I'm
&gt;&gt;&gt;&gt; having here or DMARC(yahoo &amp; others?) are not fixed in by this mailing list
&gt;&gt;&gt;&gt; - would an admin(anybody) know?
&gt;&gt;&gt; This mailing list (and all hosted on redhat.com) are seriously broken
&gt;&gt;&gt; when senders have strict DMARC settings. This hits everyone posting
&gt;&gt;&gt; from @yahoo.* addresses - mail still gets sent out by the list, but
&gt;&gt;&gt; a large number of receipients mail servers will throw it away due to
&gt;&gt;&gt; DMARC violation.  I've had tickets open with our mail provider for
&gt;&gt;&gt; a year &amp; a half now but progress fixing it is painfully slow.
&gt;&gt;&gt;
&gt;&gt;&gt; Regards,
&gt;&gt;&gt; Daniel
&gt;&gt; not all, which fact is most intriguing to me - as if there were no
&gt;&gt; communication on some fundamental level and each mailman(s) admin(s) lived
&gt;&gt; in a separate closet.
&gt;&gt; One such example where guys had it for very long (if not always) fixed in is
&gt;&gt; freeIPA mailing list, but there is a few more I'm subscribed to "owned" by
&gt;&gt; Redhat which work.
&gt; The freeIPA mailing lists are hosted on fedoraproject.org, which is
&gt; handled by different mail infrastructure than redhat.com. NB the
&gt; problem isn't in mailman, it is the backend mail infra that is
&gt; causing the trouble.
This mustn't be a difficult task to undertake - oVirt has 
done it right, recently also clusterlabs admins fixed their 
list.
I'd be nice &amp; many I have no doubts will be grateful for 
being able to see/get own emails - just as mailing lists 
should be.

many thanks, L

</body></email><email><emailId>20210811084646</emailId><senderName>Martin Kletzander</senderName><senderEmail>mkletzan@redhat.com</senderEmail><timestampReceived>2021-08-11 08:46:46-0400</timestampReceived><subject>Re: vmware ESXi in KVM</subject><body>


On Tue, Aug 10, 2021 at 09:45:37PM +0200, Gunnar wrote:
&gt;I am trying to install esxi7 inside a KVM machine
&gt;
&gt;    virt-install --name=esxi7 \
&gt;    --vcpus=2 \
&gt;    --memory=4096 \
&gt;    --cdrom=/home/username/isos/VMware-VMvisor-Installer-7.0U2a-17867351.x86_64.iso
&gt;    \
&gt;    --disk size=33 \
&gt;    --os-variant=unknown
&gt;
&gt;the installation process starts but does not get fails with a "No
&gt;network adapters" error. This does not happen with other VM's.
&gt;What do I have to add to above command in order to attach the default
&gt;network adapter to the machine?
&gt;

First look if the machine has any network interface.  If it does, the
guest OS probably does not support the model, so you can change that.
If it does not have one, then you probably want to use '--network
network=default' in your virt-install command and you can always look
that up in the man page as well (e.g. man virt-install).

&gt;or is there any other trick I have to be aware of when it comes to
&gt;installing ESXi
&gt;

No idea as I have never installed anything like that.

&gt;thx ... Gunnar

Hope that helped,
Martin

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20210804165631</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-08-04 16:56:31-0400</timestampReceived><subject>Re: RX throttling causes keep-alive timeout</subject><body>

On Wed, Aug 04, 2021 at 04:16:10PM +0000, Ivan Teterevkov wrote:
&gt; Hello folks,
&gt; 
&gt; I recently discovered that the max_client_requests configuration option
&gt; affects the keep-alive RPC and can cause the connection timeout, and I
&gt; wanted to verify if my understanding is correct.
&gt; 
&gt; Let me outline the context. Under certain circumstances, one of the
&gt; connected clients in my setup issued multiple concurrent long-standing
&gt; live-migration requests and reached the default limit of five concurrent
&gt; requests. Consequently, it triggered the RX throttling, so the server
&gt; stopped reading the incoming data from this client's file descriptor.
&gt; Meanwhile, the server issued the keepalive "ping" requests but ignored
&gt; the "pong" responses from the client due to the RX throttling. As a result,
&gt; the server concluded the client was dead and closed the connection with the
&gt; "connection closed due to keepalive timeout" message after the default five
&gt; "ping" attempts with five seconds timeout each.
&gt; 
&gt; The idea of throttling makes perfect sense: the server prevents hogging
&gt; of the worker thread pool (or would prevent the unbounded growth of the
&gt; memory footprint if the libvirtd server continued parsing the incoming
&gt; data and queued the requests). What concerns me is that the server drops
&gt; the connection for the alive clients when they're throttled.

Note the limiting happens before the parsing - we don't even read
the data off the socket when we are rate limited, as we don't want
our in memory pending queue growing unbounded.

&gt; One approach to this problem is implementing the EAGAIN-like handling:
&gt; parse the incoming data above the limit and respond with the error response,
&gt; but handle the keep-alive RPCs gracefully. However, I see two problems here:
&gt; either it's a backwards-compatibility concern if implemented unconditionally
&gt; or polluting the configuration space if implemented conditionally.

There is no way to parse the keepalives, without also pulling all
the preceeding data off the socket, which defeats the purpose of
having the limit.

&gt; What is the community's opinion on the above issue?

IMHO this is a tuning problem for your application. If you are expecting
to have 5 long running operations happening concurrently in normal usage,
then you should have increased the max_client_requests parameter to a
value greater than 5 to give yourself more headroom.

The right limit is hard to suggest without knowing more about your mgmt
application. As an example though, if your application can potentially
have 2 API calls pending per running VM and your host capacity allows
for 100 VMs, then you might plan for your max_client_requests value
to be 200. Having a big value for max_client_requests is not inherantly
a bad thing - we just want to prevent unbounded growth when things go
wrong.

Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20210805092650</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-08-05 09:26:50-0400</timestampReceived><subject>Re: ERROR Couldn't find hvm kernel for Ubuntu tree.</subject><body>

On 8/4/21 5:21 PM, Kaushal Shriyan wrote:
&gt; Hi,
&gt; 
&gt; #cat /etc/redhat-release
&gt; CentOS Linux release 7.8.2003 (Core)
&gt; #virt-install --version
&gt; 1.5.0
&gt; #virt-install -n snipeitassetmanagementubuntu --ram 8096 --vcpus 2
&gt; --virt-type kvm --os-type linux --os-variant ubuntu18.04 --graphics none
&gt; --location '
&gt; http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/'
&gt; --extra-args "console=tty0 console=ttyS0,115200n8" --disk
&gt; path=/linuxkvmguestosdisk/snipeitassetmanagementubuntu.img,size=30
&gt; 
&gt; I am unable to connect to the guest VM instance. Any clue and i look
&gt; forward to hearing from you. Thanks in advance.
&gt; 

Hey, what do you mean by 'connect'? Is it connecting to graphical
console (e.g. via virt-viewer) or it's serial console or connecting to
guest's ssh or something else?

Michal

</body></email><email><emailId>20210804143933</emailId><senderName>Laine Stump</senderName><senderEmail>laine@redhat.com</senderEmail><timestampReceived>2021-08-04 14:39:33-0400</timestampReceived><subject>Re: attach a pcie root port as hostdev</subject><body>



On 8/4/21 3:21 AM, Jiatong Shen wrote:
&gt; Hello community,
&gt; 
&gt; I am working on plugging a xilinx fpga card as a hostdev.  This fpga 
&gt; card has 2 functions, each has a different role, for some reason, I 
&gt; would like to attach both of them but do not want to attach them 
&gt; separately, so I have tried to attach a pci bridge where fpga cards 
&gt; connect to. but got the following  error,
&gt; 
&gt; error: Failed to attach device from bridge.xml
&gt; error: internal error: Non-endpoint PCI devices cannot be assigned to guests 
&gt; 
&gt; 
&gt; so, my question is is it possible to attach a pci-bridge as hostdev? 
&gt; thank you.

No, it isn't possible. VFIO only supports attaching endpoint devices.

You will need to attach each of your endpoint devices separately. (If 
the issue is that you want both devices to show up on the same root port 
in the guest, that is easily accomplished by manually setting the 
guest-side pci address of the devices to have the same same bus/slot, 
but different function; this does mean that you can't hotplug, but will 
deliver the desired topology. Note that although I've heard of people 
who thought that they needed devices to be on the same slot, I've never 
seen any evidence that this was actually required by any OS or driver)

</body></email><email><emailId>20210816183608</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-08-16 18:36:08-0400</timestampReceived><subject>Re: a test email (&amp; dmarc) @admins</subject><body>

On Mon, Aug 16, 2021 at 07:23:25PM +0100, lejeczek wrote:
&gt; 
&gt; 
&gt; On 16/08/2021 09:35, Daniel P. Berrangé wrote:
&gt; &gt; On Sat, Aug 14, 2021 at 09:38:50AM +0100, lejeczek wrote:
&gt; &gt; &gt; hi guys.
&gt; &gt; &gt; I sent email a while ago and I wonder, also having not received a single
&gt; &gt; &gt; reply, because I did not get that own email - is there are problem I'm
&gt; &gt; &gt; having here or DMARC(yahoo &amp; others?) are not fixed in by this mailing list
&gt; &gt; &gt; - would an admin(anybody) know?
&gt; &gt; This mailing list (and all hosted on redhat.com) are seriously broken
&gt; &gt; when senders have strict DMARC settings. This hits everyone posting
&gt; &gt; from @yahoo.* addresses - mail still gets sent out by the list, but
&gt; &gt; a large number of receipients mail servers will throw it away due to
&gt; &gt; DMARC violation.  I've had tickets open with our mail provider for
&gt; &gt; a year &amp; a half now but progress fixing it is painfully slow.
&gt; &gt; 
&gt; &gt; Regards,
&gt; &gt; Daniel
&gt; not all, which fact is most intriguing to me - as if there were no
&gt; communication on some fundamental level and each mailman(s) admin(s) lived
&gt; in a separate closet.
&gt; One such example where guys had it for very long (if not always) fixed in is
&gt; freeIPA mailing list, but there is a few more I'm subscribed to "owned" by
&gt; Redhat which work.

The freeIPA mailing lists are hosted on fedoraproject.org, which is
handled by different mail infrastructure than redhat.com. NB the
problem isn't in mailman, it is the backend mail infra that is
causing the trouble.

Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20210824002509</emailId><senderName>"liuyd.fnst () fujitsu ! com"</senderName><senderEmail>liuyd.fnst@fujitsu.com</senderEmail><timestampReceived>2021-08-24 00:25:09-0400</timestampReceived><subject>Re: Question The order of the output of virsh guestinfo --filesystem</subject><body>

Appreciate it !

On 8/23/21 11:44 PM, Michal Prívozník wrote:
&gt; On 8/23/21 1:19 PM, liuyd.fnst@fujitsu.com wrote:
&gt;&gt; Hi all.
&gt;&gt;
&gt;&gt; I'm curious about the output order of virsh guestinfo --filesystem.
&gt;&gt; Is the output random?
&gt;
&gt;&gt; virsh guestinfo output.
&gt;&gt; It is not sorted by   name or total-bytes/used-bytes
&gt; It's in whatever order the guest agent reported. And looking into the
&gt; guest agent source code it's parsing /proc/self/mountinfo. So there's no
&gt; order guaranteed.
&gt;
&gt; Michal
&gt;
-- 
Best Regards.
Yiding Liu

</body></email><email><emailId>20210830173040</emailId><senderName>Alex Williamson</senderName><senderEmail>alex.williamson@redhat.com</senderEmail><timestampReceived>2021-08-30 17:30:40-0400</timestampReceived><subject>Re: issues with vm after upgrade</subject><body>

On Sun, 29 Aug 2021 16:25:53 -0400
Laine Stump &lt;laine@redhat.com&gt; wrote:
&gt; I just looked back at the code that decides whether a device is 
&gt; conventional PCI or PCIe for the first time in a few years 
&gt; (virPCIDeviceInit) and it looks like it might consider integrated 
&gt; chipset devices to be conventional PCI (since they don't have any 
&gt; "Express Capabilities Data"); this would explain why it's wanting to 
&gt; assign it to a pcie-to-pci-bridge. Maybe we should just always assign 
&gt; devices to PCIe slots when the guest is Q35 though. Alex - what's your 
&gt; opinion about this?

The only certainty is that you're going to be wrong sometimes.
Technically all PCIe devices should have a PCIe capability, but that's
commonly not the case for Root Complex Integrated Endpoints, presumably
because the PCIe capability also describes PCIe links but integrated
endpoints don't expose such aspects of how they're connected to the RC.
So, if you assume these are conventional PCI devices, you're probably
wrong and if you assume they're PCIe devices, well they don't have a
PCIe capability like they really ought to if they're under a downstream
port.  We just hope that software doesn't care in that case.

Would libvirt want a special rule for hostdev devices on the host root
bus?  If you were to set the default location for any such device to
the guest root bus then your rules about config space size for
determining conventional vs express become more consistent for the
remaining devices.  But then, do we have root bus hotplug on q35?
Thanks,

Alex

</body></email><email><emailId>20210831080950</emailId><senderName>Guozhonghua</senderName><senderEmail>guozh88@chinatelecom.cn</senderEmail><timestampReceived>2021-08-31 08:09:50-0400</timestampReceived><subject>one qustion about the snapshot of the libvirt, thanks.</subject><body>

[Attachment #2 (text/plain)]


Hello, 

When we test snapshot features and review the code of libvirt, there is one question, \
not an issue. 

    /* do the memory snapshot if necessary */
    if (memory) {
        /* check if migration is possible */
        if (!qemuMigrationSrcIsAllowed(driver, vm, false, 0))
            goto cleanup;

While making one snapshot with memory on one vm, but it is not allowed while the vm \
which has some src devices, such as pci devs, with which the vm is not allowed to be \
migrated. I want to known the reason, why should  it check this conditions? 


Thank You!


[Attachment #3 (text/html)]

&lt;html&gt;&lt;head&gt;&lt;meta http-equiv="content-type" content="text/html; \
charset=us-ascii"&gt;&lt;style&gt;body { line-height: 1.5; }body { font-size: 14px; \
font-family: 'Microsoft YaHei UI'; color: rgb(0, 0, 0); line-height: 1.5; \
}&lt;/style&gt;&lt;/head&gt;&lt;body&gt; \
&lt;div&gt;&lt;span&gt;&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Hello, &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt; \
&lt;div&gt;&lt;div&gt;&lt;div&gt;When we test snapshot features and review the code of libvirt, there \
is one question, not an issue. &lt;/div&gt;&lt;div&gt;&lt;span style="line-height: 1.5; \
background-color: transparent;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style="background-color: \
transparent;"&gt;&lt;div&gt;    /* do the memory snapshot if necessary \
*/&lt;/div&gt;&lt;div&gt;    if (memory) {&lt;/div&gt;&lt;div&gt;        /* \
check if migration is possible */&lt;/div&gt;&lt;div&gt;        if \
(!qemuMigrationSrcIsAllowed(driver, vm, false, 0))&lt;/div&gt;&lt;div&gt;      \
      goto cleanup;&lt;/div&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style="line-height: \
1.5; background-color: transparent;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style="line-height: \
1.5; background-color: transparent;"&gt;While making one snapshot with memory on one vm, \
but it is not allowed while the vm which has some src devices, such as pci devs, with \
which the vm is not allowed to be migrated.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="line-height: 1.5; background-color: transparent;"&gt;I want to known the reason, \
why should  it check this \
conditions? &lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="line-height: 1.5; background-color: transparent;"&gt;Thank \
You!&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;hr style="width: 210px; \
height: 1px; display: none;" color="#b5c4df" size="1" align="left"&gt; \
&lt;div&gt;&lt;span&gt;&lt;/span&gt;&lt;/div&gt; &lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20210831115728</emailId><senderName>lejeczek</senderName><senderEmail>peljasz@yahoo.co.uk</senderEmail><timestampReceived>2021-08-31 11:57:28-0400</timestampReceived><subject>Re: Are secrets hidden from admins too - ?</subject><body>



On 24/08/2021 08:06, Erik Skultety wrote:
&gt; On Mon, Aug 16, 2021 at 08:01:27PM +0100, lejeczek wrote:
&gt;&gt;
&gt;&gt; On 16/08/2021 10:32, Martin Kletzander wrote:
&gt;&gt;&gt; On Mon, Aug 09, 2021 at 11:48:11AM +0100, lejeczek wrote:
&gt;&gt;&gt;&gt; Hi guys.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; On a remote &amp; "shared" systems - are private secrets
&gt;&gt;&gt;&gt; completely 100% safe? Can root get to those?
&gt;&gt;&gt;&gt; (naturally excluding hacking of unknown bugs &amp; exploits and
&gt;&gt;&gt;&gt; theories such as "no computer system is ultimately safe")
&gt;&gt;&gt;&gt;
&gt;&gt;&gt; Well, the secret needs to be kept somewhere.  The most secure you can
&gt;&gt;&gt; get with secrets is the ephemeral ones, but those still need to be kept
&gt;&gt;&gt; in memory.  You could encrypt them, but then you would need to provide
&gt;&gt;&gt; the decryption passphrase or key when you want to use them and that
&gt;&gt;&gt; would be like providing the secret itself anyway.  Even thought there
&gt;&gt;&gt; are some limitations to unlimited memory access in Linux when someone
&gt;&gt;&gt; has root access you have to assume they have access to what the system
&gt;&gt;&gt; has access too.
&gt;&gt;&gt;
&gt;&gt;&gt; The best you can do to mitigate that is using something like Intel SGX,
&gt;&gt;&gt; AMD SEV and such like.  There is Launch Security [0] in libvirt, but I
&gt;&gt;&gt; think it only supports SEV and something on s390.  But I do not have any
&gt;&gt;&gt; experience with those.
&gt;&gt;&gt;
&gt;&gt;&gt; [0] https://libvirt.org/formatdomain.html#id113
&gt;&gt;&gt;
&gt;&gt; Last one - would by any chance you/Redhat have a schedule for Libvirt with
&gt;&gt; SEV to go into RHELs/CentOS Stream?
&gt; TL;DR
&gt;
&gt; It's been there for a while, we added SEV support in libvirt 6.5.0 and the
&gt; libvirt version in current RHEL-8 is 7.0.0. I don't remember (even if I could
&gt; I could not discuss it) the strategy, but CentOS Stream 8 will likely have
&gt; a libvirt version &gt;7.0.0.
Any chance you(with/via Redhat) could push in something more 
on pair with what is in RHEL, as you explained?
At present CentOS Stream seems to have mere 6.0.0.x version.

many thanks, L.
&gt; Note that there are essentially 3 "flavours" of SEV:
&gt; SEV, SEV-ES, SEV-SNP. The main difference is in the underlying HW changes; from
&gt; libvirt's POV SEV and SEV-ES are identical, but neither QEMU nor libvirt
&gt; support SEV-SNP fully yet - the problem here is the secure state attestation
&gt; process which is still under development. What that means for end users is that
&gt; they can create memory encrypted guests the same way as with the other SEV
&gt; flavours, but they're still unable to verify that the guest hasn't been tampered
&gt; with by a malicious QEMU or platform owner or whatnot just before it was
&gt; launched.
&gt;
&gt; Erik
&gt;
&gt;&gt; I know one can get that via/from oVirt repos, but that for me would not
&gt;&gt; work.
&gt;&gt; thanks, L.
&gt;&gt;&gt;&gt; And if answer is yes then - do you have any best practices
&gt;&gt;&gt;&gt; for storing &amp; managing of those secrets?
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; many thanks, L.
&gt;&gt;&gt;&gt;

</body></email><email><emailId>20210831131845</emailId><senderName>Turritopsis Dohrnii Teo En Ming</senderName><senderEmail>ceo.teo.en.ming@gmail.com</senderEmail><timestampReceived>2021-08-31 13:18:45-0400</timestampReceived><subject>We need excellent and well-written documentation for setting up open source NAS software</subject><body>

Subject: We need excellent and well-written documentation for setting
up open source NAS software

Good day from Singapore,

Our company, which is a Systems Integrator (SI) in Singapore, is
evaluating more than 30 different open source Network Attached Storage
(NAS) software.

We need excellent and well-written documentation for your open source
NAS software. Please provide us with links on how to setup your open
source NAS software.

We are looking forward to your replies. Thank you very much for your
kind assistance.

Mr. Turritopsis Dohrnii Teo En Ming, 43 years old as of 31 August
2021, is a TARGETED INDIVIDUAL living in Singapore. He is an IT
Consultant with a System Integrator (SI)/computer firm in Singapore.
He is an IT enthusiast.




-----BEGIN EMAIL SIGNATURE-----

The Gospel for all Targeted Individuals (TIs):

[The New York Times] Microwave Weapons Are Prime Suspect in Ills of
U.S. Embassy Workers

Link:
https://www.nytimes.com/2018/09/01/science/sonic-attack-cuba-microwave.html

********************************************************************************************

Singaporean Targeted Individual Mr. Turritopsis Dohrnii Teo En Ming's
Academic Qualifications as at 14 Feb 2019 and refugee seeking attempts
at the United Nations Refugee Agency Bangkok (21 Mar 2017), in Taiwan
(5 Aug 2019) and Australia (25 Dec 2019 to 9 Jan 2020):

[1] https://tdtemcerts.wordpress.com/

[2] https://tdtemcerts.blogspot.sg/

[3] https://www.scribd.com/user/270125049/Teo-En-Ming

-----END EMAIL SIGNATURE-----

</body></email><email><emailId>20210705143222</emailId><senderName>Jiatong Shen</senderName><senderEmail>yshxxsjt715@gmail.com</senderEmail><timestampReceived>2021-07-05 14:32:22-0400</timestampReceived><subject>Re: host identifier</subject><body>

Thanks, I'll check it out.

On Mon, Jul 5, 2021 at 4:30 PM Daniel P. Berrangé &lt;berrange@redhat.com&gt;
wrote:

&gt; On Mon, Jul 05, 2021 at 08:31:15AM +0800, Jiatong Shen wrote:
&gt; &gt; Hello community,
&gt; &gt;
&gt; &gt; I am using OpenStack nova and realize that nova now uses host fqdn from
&gt; &gt; libvirt as a uniq identifier for a compute node.  The issue is that host
&gt; &gt; might need to change its fqdn under some
&gt; &gt; rare circumstances and lose some usage data due to the nova manages
&gt; &gt; compute node resources.
&gt; &gt;
&gt; &gt; My question is: does libvirt already export host uuid identifier to other
&gt; &gt; applications? I skim through the code base and find there is host uuid
&gt; &gt; related code which reads /etc/machine-id to obtain a uniq uuid for
&gt; &gt; migration, but seems this uuid cannot be obtained through virsh
&gt; interface.
&gt;
&gt; Libvirt has long exposed a host UUID in the capabilities XML
&gt;
&gt; Regards,
&gt; Daniel
&gt; --
&gt; |: https://berrange.com      -o-
&gt; https://www.flickr.com/photos/dberrange :|
&gt; |: https://libvirt.org         -o-
&gt; https://fstop138.berrange.com :|
&gt; |: https://entangle-photo.org    -o-
&gt; https://www.instagram.com/dberrange :|
&gt;
&gt;

-- 

Best Regards,

Jiatong Shen

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Thanks, I'll check it out.  &lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Mon, Jul 5, 2021 at 4:30 PM \
Daniel P. Berrangé &lt;&lt;a \
href="mailto:berrange@redhat.com"&gt;berrange@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;On Mon, Jul 05, 2021 \
at 08:31:15AM +0800, Jiatong Shen wrote:&lt;br&gt; &gt; Hello community,&lt;br&gt;
&gt; &lt;br&gt;
&gt; I am using OpenStack nova and realize that nova now uses host fqdn from&lt;br&gt;
&gt; libvirt as a uniq identifier for a compute node.   The issue is that host&lt;br&gt;
&gt; might need to change its fqdn under some&lt;br&gt;
&gt; rare circumstances and lose some usage data due to the nova manages&lt;br&gt;
&gt; compute node resources.&lt;br&gt;
&gt; &lt;br&gt;
&gt; My question is: does libvirt already export host uuid identifier to other&lt;br&gt;
&gt; applications? I skim through the code base and find there is host uuid&lt;br&gt;
&gt; related code which reads /etc/machine-id to obtain a uniq uuid for&lt;br&gt;
&gt; migration, but seems this uuid cannot be obtained through virsh interface.&lt;br&gt;
&lt;br&gt;
Libvirt has long exposed a host UUID in the capabilities XML&lt;br&gt;
&lt;br&gt;
Regards,&lt;br&gt;
Daniel&lt;br&gt;
-- &lt;br&gt;
&gt; &gt; &lt;a href="https://berrange.com" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://berrange.com&lt;/a&gt;         -o-      &lt;a \
&gt; &gt; href="https://www.flickr.com/photos/dberrange" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://www.flickr.com/photos/dberrange&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="https://libvirt.org" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://libvirt.org&lt;/a&gt;              -o-                  &lt;a \
&gt; &gt; href="https://fstop138.berrange.com" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://fstop138.berrange.com&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="https://entangle-photo.org" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://entangle-photo.org&lt;/a&gt;      -o-      &lt;a \
&gt; &gt; href="https://www.instagram.com/dberrange" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://www.instagram.com/dberrange&lt;/a&gt; :|&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br clear="all"&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- &lt;br&gt;&lt;div dir="ltr" \
class="gmail_signature"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;div&gt;Best \
Regards,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Jiatong Shen&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210709195119</emailId><senderName>vrms</senderName><senderEmail>vrms@netcologne.de</senderEmail><timestampReceived>2021-07-09 19:51:19-0400</timestampReceived><subject>Re: self-study material sought</subject><body>

hi Tony

On 09.07.21 15:10, Tony Brian Albers wrote:
&gt; I'd recommend reading the oVirt/RHEV documentation:
&gt; https://access.redhat.com/documentation/en-us/red_hat_virtualization/4.4/
&gt; Start with 'Planning' and go on from there. 
thx, I'll check that out. Eventhough I am not so interested getting into
oVirt but more basic cli libvirt, etc. (which oVirt is based upon I assume).
Anyway the hint is hightly appreciated

</body></email><email><emailId>20210714091237</emailId><senderName></senderName><senderEmail>arjen-libvirt</senderEmail><timestampReceived>2021-07-14 09:12:37-0400</timestampReceived><subject>Re: virsh qemu-monitor-command block_resize not working</subject><body>





On Wed, 14 Jul 2021 09:34:22 +0100
Daniel P. Berrangé &lt;berrange@redhat.com&gt; wrote:

&gt; On Wed, Jul 14, 2021 at 10:10:35AM +0200, arjen-libvirt@gugu.be wrote:
&gt; &gt; Hi List,
&gt; &gt; 

[sNap]

&gt; &gt; 
&gt; &gt; In a previous qemu version this worked (EL 7). Can someone help me
&gt; &gt; out?  
&gt; 
&gt; Libvirt has changed the way it configures disks with QEMU to use the
&gt; modern -blockdev argument. I expect this impacts your usage, but I
&gt; dont know what the correct naming should be.
&gt; 
&gt; Ignoring that though, why are you even using qemu-monitor-command in
&gt; the first place ?  Libvirt directly supports live block resizing
&gt; via the 'virsh blockresize' command

Hah, didn't know that live resizing was implemented in virsh. Great!

Thanks,
Arjen.



</body></email><email><emailId>20210714155101</emailId><senderName>lejeczek</senderName><senderEmail>peljasz@yahoo.co.uk</senderEmail><timestampReceived>2021-07-14 15:51:01-0400</timestampReceived><subject>Re: DAC &amp; glusterFS - errors</subject><body>



On 08/07/2021 10:34, Michal Prívozník wrote:
&gt; On 7/5/21 11:28 PM, lejeczek wrote:
&gt;&gt; Hi guys
&gt;&gt;
&gt;&gt; I'm trying to spin up a VM whose image is on a GlusterFS vol, and I fail:
&gt;&gt;
&gt;&gt; -&gt; $ virsh create /var/lib/pacemaker/conf.d/win10Pro.xml
&gt;&gt; error: Failed to create domain from /var/lib/pacemaker/conf.d/win10Pro.xml
&gt;&gt; error: failed to initialize gluster connection (src=0x7f0af807b410
&gt;&gt; priv=0x7f0af8090070): Invalid argument
&gt;&gt;
&gt;&gt; In logs:
&gt;&gt; ...
&gt;&gt; 2021-07-05 21:13:12.950+0000: 141524: warning :
&gt;&gt; virSecurityDACSetOwnership:828 : Unable to restore label on
&gt;&gt; 'win10Pro.qcow2'. XATTRs might have been left in inconsistent state.
&gt;&gt; internal error: child reported (status=125): failed to initialize
&gt;&gt; gluster connection (src=0x7f0b00097030 priv=0x7f0b000956c0): Invalid
&gt;&gt; argument
&gt;&gt;
&gt;&gt; Any ideas &amp; suggestions greatly appreciated.
&gt;&gt; thanks, L.
&gt;&gt;
&gt; Hey, since this is gluster I wonder if it is related to this bug:
&gt;
&gt;    https://bugzilla.redhat.com/show_bug.cgi?id=1786301
&gt;
&gt; That one is a deadlock scenario, but nevertheless might be worth turning
&gt; off seclabel remembering to see if that's the root cause. Just set
&gt; remember_owner=0 in /etc/libvirt/qemu.conf, restart libvirtd and see if
&gt; the problem persists.
&gt;
&gt; Michal
&gt;
This error is, well, in my opinion quite misleading, as the 
problem turns out was - a non-existent GlusterFS Vol to 
which storage path pointed to in my guest/domain definition.
Whether there were any other underlying problems I cannot 
say, don't know, but if you guys get those or similar to 
aforementioned errors, then I suggest check that 'obvious' bit.

many thanks, L.

</body></email><email><emailId>20210714160450</emailId><senderName>lejeczek</senderName><senderEmail>peljasz@yahoo.co.uk</senderEmail><timestampReceived>2021-07-14 16:04:50-0400</timestampReceived><subject>Re: openVswitch won't get to a virtual IP</subject><body>



On 14/07/2021 16:12, Michal Prívozník wrote:
&gt; On 7/14/21 3:54 PM, lejeczek wrote:
&gt;&gt; Hi guys.
&gt;&gt;
&gt;&gt; Among all the mailing lists I'm subscriber of this one I thought, would
&gt;&gt; where chances to find 'openvswitch'+'libvirtd' experts to share thoughts
&gt;&gt; &amp; suggestions should be grater.
&gt;&gt;
&gt;&gt; A case:
&gt;&gt; a) all guests are KVM.
&gt;&gt; b) I have NM managed OVS bridge and libvirtd network to/on that bridge
&gt;&gt; c) "regular" NM bridge and network off it in libvirt
&gt;&gt;
&gt;&gt; problem is - guests on OVS network can _not_ ping a virtual IP of a
&gt;&gt; guest(s) on 'regular' bridge network, but..   can ping "actual" IP of
&gt;&gt; that same guest(s) okey.
&gt; I'm not sure what you mean by: "actual" IP of that same guest.
&gt;
&gt; But in general, if you have two bridges you also have two separate
&gt; subnets. So you want to set up routing between them. And also inspect
&gt; rules that libvirt adds to its default network, because those might
&gt; clash with your setup.
&gt;
&gt; Michal
&gt;
No need to complicate..
guestOVSa &lt;-&gt; guestBRa 10.3.3.1 =&gt; pings OK
guestOVSa &lt;-&gt; guestBRa 10.3.3.2 virtual IP = cannot ping, 
"Destination Host Unreachable"
The host on which guestOVSa resides pings both those IPs OKey.

thanks for response Michal.
L

</body></email><email><emailId>20210715081616</emailId><senderName>Andrea Bolognani</senderName><senderEmail>abologna@redhat.com</senderEmail><timestampReceived>2021-07-15 08:16:16-0400</timestampReceived><subject>Re: how to build a github release tarball</subject><body>

[re-adding the list]

On Thu, Jul 15, 2021 at 01:25:02PM +0800, Jiatong Shen wrote:
&gt; On Thu, Jul 15, 2021 at 5:54 AM Jiatong Shen &lt;yshxxsjt715@gmail.com&gt; wrote:
&gt; &gt; thank you very much for reply. but what should I do if I want to
&gt; &gt; build release tarball myself (for 6.0.0..)? I would like to backport some
&gt; &gt; features
&gt; &gt; to 6.0.0..
&gt;
&gt; hmm. it looks like `make -j3 dist` could produce a tarball for 6.0.0.. Is
&gt; it the right
&gt; approach?

Yes, if your goal is to create a release archive for libvirt 6.0.0
with some patches on top[1] then the best way to go about it is to
clone the repo, branch off the v6.0.0 tag, cherry-pick the changes
you're interested in and then generate the archive using 'make
distcheck'.


[1] You could have told us this in the first place instead of asking
    a more generic question for which a different answer was more
    appropriate ;)
-- 
Andrea Bolognani / Red Hat / Virtualization

</body></email><email><emailId>20210719164752</emailId><senderName></senderName><senderEmail>jesonliang040705@hotmail.com</senderEmail><timestampReceived>2021-07-19 16:47:52-0400</timestampReceived><subject>Failed to terminate process 1901409 with SIGKILL: Device or resource busy</subject><body>

Hi All,

I hit another issue that libvirt sometimes throw exception like 'Failed to =
terminate process 1901409 with SIGKILL: Device or resource busy=A1=AF once =
we try to destroy vm through 'conn.lookupByID(id_).destroy()=A1=AF.
After this issue occur, it will caused the socket fd and pipe increased and=
 finally caused fd leak.

Who know the root cause of this issue or give some cues?  Any comments are =
appreciated


Thanks !
[Attachment #3 (unknown)]

&lt;html&gt;&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=gb2312"&gt;&lt;/head&gt;&lt;body \
style="word-wrap: break-word; -webkit-nbsp-mode: space; line-break: \
after-white-space;" class=""&gt;Hi All,&lt;div class=""&gt;&lt;br class=""&gt;&lt;/div&gt;&lt;div class=""&gt;I \
hit another issue that libvirt sometimes throw exception like 'Failed to terminate \
process 1901409 with SIGKILL: Device or resource busy¡¯ once we try to destroy vm \
through '&lt;span style="color: rgb(212, 212, 212); font-family: Menlo, Monaco, \
"Courier New", monospace; white-space: pre; background-color: rgb(30, 30, \
30);" class=""&gt;conn.lookupByID(id_).destroy()&lt;/span&gt;¡¯.&lt;/div&gt;&lt;div class=""&gt;After this \
issue occur, it will caused the socket fd and pipe increased and finally caused fd \
leak.&lt;/div&gt;&lt;div class=""&gt;&lt;br class=""&gt;&lt;/div&gt;&lt;div class=""&gt;Who know the root cause of \
this issue or give some cues?  Any comments are appreciated&lt;/div&gt;&lt;div \
class=""&gt;&lt;br class=""&gt;&lt;/div&gt;&lt;div class=""&gt;&lt;br class=""&gt;&lt;/div&gt;&lt;div class=""&gt;Thanks \
!&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20210720104725</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-07-20 10:47:25-0400</timestampReceived><subject>Re: investigate locks on a domain</subject><body>

On 7/20/21 11:17 AM, Peter Krempa wrote:
&gt; On Tue, Jul 20, 2021 at 15:52:58 +0800, Jiatong Shen wrote:
&gt;&gt; Hello community,
&gt;&gt;
&gt;&gt; I am seeing following log in production,
&gt;&gt;
&gt;&gt; 2021-07-20 07:43:49.417+0000: 3918294: error :
&gt;&gt; qemuDomainObjBeginJobInternal:4945 : Timed out during operation: cannot
&gt;&gt; acquire state change lock (held by qemuProcessReconnect)
&gt;&gt; 2021-07-20 07:44:19.424+0000: 3918296: warning :
&gt;&gt; qemuDomainObjBeginJobInternal:4933 : Cannot start job (modify, none) for
&gt;&gt; domain instance-0000074e; current job is (modify, none) owned by (3919429
&gt;&gt; qemuProcessReconnect, 0 &lt;null&gt;) for (2183193s, 0s)
&gt;&gt; 2021-07-20 07:44:19.424+0000: 3918296: error :
&gt;&gt; qemuDomainObjBeginJobInternal:4945 : Timed out during operation: cannot
&gt;&gt; acquire state change lock (held by qemuProcessReconnect)
&gt;&gt; 2021-07-20 07:44:49.428+0000: 3918296: warning :
&gt;&gt; qemuDomainObjBeginJobInternal:4933 : Cannot start job (query, none) for
&gt;&gt; domain instance-0000074e; current job is (modify, none) owned by (3919429
&gt;&gt; qemuProcessReconnect, 0 &lt;null&gt;) for (2183223s, 0s)
&gt;&gt; 2021-07-20 07:44:49.428+0000: 3918296: error :
&gt;&gt; qemuDomainObjBeginJobInternal:4945 : Timed out during operation: cannot
&gt;&gt; acquire state change lock (held by qemuProcessReconnect)
&gt;&gt; 2021-07-20 07:45:19.429+0000: 3918298: warning :
&gt;&gt; qemuDomainObjBeginJobInternal:4933 :
&gt;&gt;
&gt;&gt; I am confused about what is qemuProcessReconnect and why it acquires a
&gt;&gt; domain state lock..
&gt; 
&gt; qemuProcessReconnect is an operation that is executed in a separate
&gt; thread which re-establishes connection to a qemu process once you
&gt; restart libvirtd.
&gt; 
&gt; This usually means that the reconnection process got stuck for some
&gt; reason. Unfortunately your log doesn't show why and unless you've got a
&gt; debug log prior to that happening it won't be possible.
&gt; 
&gt; Theoretically seeing which function the thread doing the reconnect is
&gt; stuck at could perhaps show why.

This should be pretty easy to see though. All that's needed is attaching
gdb an running backtrace. Ideally over all threads as you don't know
which one is stuck trying to reconnect. Something like the following:

gdb -q -p $(pgrep libvirtd) -ex 't a a bt' -ex 'q'

Just make sure you have debuginfo installed for libvirt otherwise the
stacktrace won't be useful.

Michal

</body></email><email><emailId>20210728135146</emailId><senderName>Francesc Guasch</senderName><senderEmail>frankie@telecos.upc.edu</senderEmail><timestampReceived>2021-07-28 13:51:46-0400</timestampReceived><subject>Re: Passthrough PCI GPU device fails on reboot</subject><body>

El 27/7/21 a les 12:29, Erik Skultety ha escrit:
&gt; On Tue, Jul 27, 2021 at 11:22:25AM +0200, Francesc Guasch wrote:
&gt;&gt; Hello.
&gt;&gt;
&gt;&gt; I have a host with an NVIDIA RTX 3090. I configured PCI passthrough
&gt;&gt; and it works fine. We are using it for CUA and Matlab on Ubuntu 20.04.
&gt;&gt;
&gt;&gt; The problem comes sometimes on rebooting the virtual machine. It doesn't
&gt;&gt; happen 100% of the times but eventually after 3 or 4 reboots the PCI
&gt;&gt; device stops working. The only solution is to reboot the host.
&gt;

While reviewing the system I noticed that, though I had
run dist-upgrade, the host didn't had the latest kernel.

Upgrading from kernel 5.8 fixed the problem. So it seems
it was a vfio problem as Erik pointed.

Thanks !

</body></email><email><emailId>20210729145020</emailId><senderName>Kaushal Shriyan</senderName><senderEmail>kaushalshriyan@gmail.com</senderEmail><timestampReceived>2021-07-29 14:50:20-0400</timestampReceived><subject>ERROR Couldn't find hvm kernel for Ubuntu tree.</subject><body>

Hi,

I am running the below command to spawn Ubuntu 18.04 based Virtual Machine
using KVM based technology.

#virt-install --version
1.5.0
#

virt-install --name=snipeitassetmanagement
&gt; --file=/linuxkvmguestosdisk/snipeitassetmanagement.img --file-size=40
&gt; --nonsparse --vcpus=2 --ram=8096 --network=bridge:br0 --os-type=linux
&gt; --os-variant=ubuntu18.04 --graphics none
&gt; --location=/linuxkvmguestosdisk/var/lib/libvirt/isos/ubuntu-18.04.5-live-server-amd64.iso
&gt; --extra-args="console=ttyS0"
&gt;
&gt; Starting install...
&gt; Retrieving file .treeinfo...
&gt;
&gt;                               |    0 B  00:00:00
&gt; Retrieving file content...
&gt;
&gt;                               |    0 B  00:00:00
&gt; Retrieving file info...
&gt;
&gt;                                |   70 B  00:00:00
&gt; ERROR    Couldn't find hvm kernel for Ubuntu tree.
&gt; Domain installation does not appear to have been successful.
&gt; If it was, you can restart your domain by running:
&gt;   virsh --connect qemu:///system start snipeitassetmanagement
&gt; otherwise, please restart your installation.
&gt;
&gt;
Any clue and i look forward to hearing from you. Thanks in advance.

Best Regards,

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I am running the below command to spawn Ubuntu \
18.04 based Virtual Machine using KVM based technology. \
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#virt-install --version \
&lt;br&gt;&lt;/div&gt;&lt;div&gt;1.5.0&lt;br&gt;&lt;/div&gt;&lt;div&gt;#&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote \
class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid \
rgb(204,204,204);padding-left:1ex"&gt;virt-install --name=snipeitassetmanagement \
--file=/linuxkvmguestosdisk/snipeitassetmanagement.img --file-size=40 --nonsparse \
--vcpus=2 --ram=8096 --network=bridge:br0 --os-type=linux --os-variant=ubuntu18.04 \
--graphics none --location=/linuxkvmguestosdisk/var/lib/libvirt/isos/ubuntu-18.04.5-live-server-amd64.iso \
--extra-args="console=ttyS0"&lt;br&gt;&lt;br&gt;Starting install...&lt;br&gt;Retrieving file \
.treeinfo...                                                                          \
|    0 B  00:00:00&lt;br&gt;Retrieving file content...                                      \
|    0 B  00:00:00&lt;br&gt;Retrieving file info...                                         \
|   70 B  00:00:00&lt;br&gt;&lt;font color="#ff0000"&gt;ERROR    Couldn't find hvm kernel for \
Ubuntu tree&lt;/font&gt;.&lt;br&gt;Domain installation does not appear to have been \
successful.&lt;br&gt;If it was, you can restart your domain by running:&lt;br&gt;  virsh \
--connect qemu:///system start snipeitassetmanagement&lt;br&gt;otherwise, please restart \
your installation.&lt;br&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Any clue and i look \
forward to hearing from you. Thanks in advance.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Best \
Regards,&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210709102335</emailId><senderName>Gunnar</senderName><senderEmail>tongji@netcologne.de</senderEmail><timestampReceived>2021-07-09 10:23:35-0400</timestampReceived><subject>self-study material sought</subject><body>

I am doing a retraining as IT-specialist atm and have 2 weeks full time
ahead to dive into virtualization.
The main training will we looking at Hyper-V which I have not interest
whatsoever in.

Now I want to get a good grip on the libvirt/kvm/qemu side of things and
am looking for good learning resource to dive into for this.
Can anybody recommend anything?

  * I like video but am able to read
  * "just google around a bit"/"search on youtube" is not the kind of
    recommendations I am up for (I will do this if noting else comes out
    of this anyway)
  * I'd like to go from 0 to hero (even though I am a bit above 0
    already, but like to start from the ground)
  * alternatively proxmox would be a topic worth considering for me

looking forward to any recommendation in this.

thx and best

Gunnar


[Attachment #3 (text/html)]

&lt;html&gt;
  &lt;head&gt;
    &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
  &lt;/head&gt;
  &lt;body&gt;
    I am doing a retraining as IT-specialist atm and have 2 weeks full
    time ahead to dive into virtualization.&lt;br&gt;
    The main training will we looking at Hyper-V which I have not
    interest whatsoever in.&lt;br&gt;
    &lt;br&gt;
    Now I want to get a good grip on the libvirt/kvm/qemu side of things
    and am looking for good learning resource to dive into for this.&lt;br&gt;
    Can anybody recommend anything?&lt;br&gt;
    &lt;ul&gt;
      &lt;li&gt;I like video but am able to read&lt;/li&gt;
      &lt;li&gt;"just google around a bit"/"search on youtube" is not the kind
        of recommendations I am up for (I will do this if noting else
        comes out of this anyway)&lt;/li&gt;
      &lt;li&gt;I'd like to go from 0 to hero (even though I am a bit above 0
        already, but like to start from the ground)&lt;/li&gt;
      &lt;li&gt;alternatively proxmox would be a topic worth considering for
        me&lt;/li&gt;
    &lt;/ul&gt;
    &lt;p&gt;looking forward to any recommendation in this.&lt;/p&gt;
    &lt;p&gt;thx and best&lt;/p&gt;
    &lt;p&gt;Gunnar&lt;br&gt;
    &lt;/p&gt;
  &lt;/body&gt;
&lt;/html&gt;


</body></email><email><emailId>20210714081035</emailId><senderName></senderName><senderEmail>arjen-libvirt</senderEmail><timestampReceived>2021-07-14 08:10:35-0400</timestampReceived><subject>virsh qemu-monitor-command block_resize not working</subject><body>

Hi List,

some version info:
]# /usr/libexec/qemu-kvm -version
QEMU emulator version 4.2.0
(qemu-kvm-4.2.0-48.module+el8.4.0+534+4680a14e) Copyright (c) 2003-2019
Fabrice Bellard and the QEMU Project developers

]# virsh version
Compiled against library: libvirt 6.0.0
Using library: libvirt 6.0.0
Using API: QEMU 6.0.0
Running hypervisor: QEMU 4.2.0

information about block devices for one specific guest:
]# virsh qemu-monitor-command uat-win201202.uat.gugu.be --hmp info block
libvirt-2-format:
/data/kvm/storage/diskimages01/uat-win201202_disk1_C.qcow2 (qcow2)
Attached to:      /machine/peripheral/virtio-disk0/virtio-backend Cache
mode:       writeback

ide0-0-0: [not inserted]
    Attached to:      ide0-0-0
    Removable device: not locked, tray closed


But then, when I want to resize the block device, I just cannot seem to
find the correct device. I tried all of these:

virsh qemu-monitor-command uat-win201202.uat.gugu.be --hmp block_resize
libvirt-2-storage 48G
Error: Cannot find device=libvirt-2-storage nor node_name=

virsh qemu-monitor-command uat-win201202.uat.gugu.be --hmp block_resize
drive-libvirt-2-storage 48G
Error: Cannot find device=drive-libvirt-2-storage nor node_name=

virsh qemu-monitor-command uat-win201202.uat.gugu.be --hmp block_resize
virtio-disk0 48G
Error: Cannot find device=virtio-disk0 nor node_name=

virsh qemu-monitor-command uat-win201202.uat.gugu.be --hmp block_resize
drive-virtio-disk0 48G
Error: Cannot find device=drive-virtio-disk0 nor node_name=

In a previous qemu version this worked (EL 7). Can someone help me out?

Best regards,
Arjen Van Drie,
Antwerp

</body></email><email><emailId>20210705212838</emailId><senderName>lejeczek</senderName><senderEmail>peljasz@yahoo.co.uk</senderEmail><timestampReceived>2021-07-05 21:28:38-0400</timestampReceived><subject>DAC &amp; glusterFS - errors</subject><body>

Hi guys

I'm trying to spin up a VM whose image is on a GlusterFS 
vol, and I fail:

-&gt; $ virsh create /var/lib/pacemaker/conf.d/win10Pro.xml
error: Failed to create domain from 
/var/lib/pacemaker/conf.d/win10Pro.xml
error: failed to initialize gluster connection 
(src=0x7f0af807b410 priv=0x7f0af8090070): Invalid argument

In logs:
...
2021-07-05 21:13:12.950+0000: 141524: warning : 
virSecurityDACSetOwnership:828 : Unable to restore label on 
'win10Pro.qcow2'. XATTRs might have been left in 
inconsistent state.
internal error: child reported (status=125): failed to 
initialize gluster connection (src=0x7f0b00097030 
priv=0x7f0b000956c0): Invalid argument

Any ideas &amp; suggestions greatly appreciated.
thanks, L.

</body></email><email><emailId>20210714135443</emailId><senderName>lejeczek</senderName><senderEmail>peljasz@yahoo.co.uk</senderEmail><timestampReceived>2021-07-14 13:54:43-0400</timestampReceived><subject>openVswitch won't get to a virtual IP</subject><body>

Hi guys.

Among all the mailing lists I'm subscriber of this one I 
thought, would where chances to find 
'openvswitch'+'libvirtd' experts to share thoughts &amp; 
suggestions should be grater.

A case:
a) all guests are KVM.
b) I have NM managed OVS bridge and libvirtd network to/on 
that bridge
c) "regular" NM bridge and network off it in libvirt

problem is - guests on OVS network can _not_ ping a virtual 
IP of a guest(s) on 'regular' bridge network, but..   can 
ping "actual" IP of that same guest(s) okey.

any thoughts and ideas on how &amp; what to investigate are very 
appreciated.
many thanks, L.

</body></email><email><emailId>20210714124452</emailId><senderName>Jiatong Shen</senderName><senderEmail>yshxxsjt715@gmail.com</senderEmail><timestampReceived>2021-07-14 12:44:52-0400</timestampReceived><subject>how to build a github release tarball</subject><body>

Hello community,

      I am trying to figure out a way to build a release tarball like
https://github.com/libvirt/libvirt/releases?after=v6.2.0, for libvirt
6.0.0, but don't know how.
Could anyone teach me how to package it? thank you.

-- 

Best Regards,

Jiatong Shen

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hello community,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;         I am trying to figure out \
a way to build a release tarball like  &lt;a \
href="https://github.com/libvirt/libvirt/releases?after=v6.2.0"&gt;https://github.com/libvirt/libvirt/releases?after=v6.2.0&lt;/a&gt;, \
for libvirt 6.0.0, but don't know how.&lt;/div&gt;&lt;div&gt;Could anyone teach me how to \
package it? thank you.&lt;/div&gt;&lt;div&gt;  &lt;br&gt;&lt;div&gt;-- &lt;br&gt;&lt;div dir="ltr" \
class="gmail_signature" data-smartmail="gmail_signature"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;div&gt;Best \
Regards,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Jiatong Shen&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210720075258</emailId><senderName>Jiatong Shen</senderName><senderEmail>yshxxsjt715@gmail.com</senderEmail><timestampReceived>2021-07-20 07:52:58-0400</timestampReceived><subject>investigate locks on a domain</subject><body>

Hello community,

I am seeing following log in production,

2021-07-20 07:43:49.417+0000: 3918294: error :
qemuDomainObjBeginJobInternal:4945 : Timed out during operation: cannot
acquire state change lock (held by qemuProcessReconnect)
2021-07-20 07:44:19.424+0000: 3918296: warning :
qemuDomainObjBeginJobInternal:4933 : Cannot start job (modify, none) for
domain instance-0000074e; current job is (modify, none) owned by (3919429
qemuProcessReconnect, 0 &lt;null&gt;) for (2183193s, 0s)
2021-07-20 07:44:19.424+0000: 3918296: error :
qemuDomainObjBeginJobInternal:4945 : Timed out during operation: cannot
acquire state change lock (held by qemuProcessReconnect)
2021-07-20 07:44:49.428+0000: 3918296: warning :
qemuDomainObjBeginJobInternal:4933 : Cannot start job (query, none) for
domain instance-0000074e; current job is (modify, none) owned by (3919429
qemuProcessReconnect, 0 &lt;null&gt;) for (2183223s, 0s)
2021-07-20 07:44:49.428+0000: 3918296: error :
qemuDomainObjBeginJobInternal:4945 : Timed out during operation: cannot
acquire state change lock (held by qemuProcessReconnect)
2021-07-20 07:45:19.429+0000: 3918298: warning :
qemuDomainObjBeginJobInternal:4933 :

I am confused about what is qemuProcessReconnect and why it acquires a
domain state lock..

-- 

Best Regards,

Jiatong Shen

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hello community,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I am seeing following log in \
production,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;2021-07-20 07:43:49.417+0000: 3918294: error : \
qemuDomainObjBeginJobInternal:4945 : Timed out during operation: cannot acquire state \
change lock (held by qemuProcessReconnect)&lt;br&gt;2021-07-20 07:44:19.424+0000: 3918296: \
warning : qemuDomainObjBeginJobInternal:4933 : Cannot start job (modify, none) for \
domain instance-0000074e; current job is (modify, none) owned by (3919429 \
qemuProcessReconnect, 0 &lt;null&gt;) for (2183193s, 0s)&lt;br&gt;2021-07-20 \
07:44:19.424+0000: 3918296: error : qemuDomainObjBeginJobInternal:4945 : Timed out \
during operation: cannot acquire state change lock (held by \
qemuProcessReconnect)&lt;br&gt;2021-07-20 07:44:49.428+0000: 3918296: warning : \
qemuDomainObjBeginJobInternal:4933 : Cannot start job (query, none) for domain \
instance-0000074e; current job is (modify, none) owned by (3919429 \
qemuProcessReconnect, 0 &lt;null&gt;) for (2183223s, 0s)&lt;br&gt;2021-07-20 \
07:44:49.428+0000: 3918296: error : qemuDomainObjBeginJobInternal:4945 : Timed out \
during operation: cannot acquire state change lock (held by \
qemuProcessReconnect)&lt;br&gt;2021-07-20 07:45:19.429+0000: 3918298: warning : \
qemuDomainObjBeginJobInternal:4933 :  &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I am confused about \
what is qemuProcessReconnect and why it acquires a domain state lock..&lt;br \
clear="all"&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- &lt;br&gt;&lt;div dir="ltr" class="gmail_signature" \
data-smartmail="gmail_signature"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;div&gt;Best \
Regards,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Jiatong Shen&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210720091759</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-07-20 09:17:59-0400</timestampReceived><subject>Re: investigate locks on a domain</subject><body>

On Tue, Jul 20, 2021 at 15:52:58 +0800, Jiatong Shen wrote:
&gt; Hello community,
&gt; 
&gt; I am seeing following log in production,
&gt; 
&gt; 2021-07-20 07:43:49.417+0000: 3918294: error :
&gt; qemuDomainObjBeginJobInternal:4945 : Timed out during operation: cannot
&gt; acquire state change lock (held by qemuProcessReconnect)
&gt; 2021-07-20 07:44:19.424+0000: 3918296: warning :
&gt; qemuDomainObjBeginJobInternal:4933 : Cannot start job (modify, none) for
&gt; domain instance-0000074e; current job is (modify, none) owned by (3919429
&gt; qemuProcessReconnect, 0 &lt;null&gt;) for (2183193s, 0s)
&gt; 2021-07-20 07:44:19.424+0000: 3918296: error :
&gt; qemuDomainObjBeginJobInternal:4945 : Timed out during operation: cannot
&gt; acquire state change lock (held by qemuProcessReconnect)
&gt; 2021-07-20 07:44:49.428+0000: 3918296: warning :
&gt; qemuDomainObjBeginJobInternal:4933 : Cannot start job (query, none) for
&gt; domain instance-0000074e; current job is (modify, none) owned by (3919429
&gt; qemuProcessReconnect, 0 &lt;null&gt;) for (2183223s, 0s)
&gt; 2021-07-20 07:44:49.428+0000: 3918296: error :
&gt; qemuDomainObjBeginJobInternal:4945 : Timed out during operation: cannot
&gt; acquire state change lock (held by qemuProcessReconnect)
&gt; 2021-07-20 07:45:19.429+0000: 3918298: warning :
&gt; qemuDomainObjBeginJobInternal:4933 :
&gt; 
&gt; I am confused about what is qemuProcessReconnect and why it acquires a
&gt; domain state lock..

qemuProcessReconnect is an operation that is executed in a separate
thread which re-establishes connection to a qemu process once you
restart libvirtd.

This usually means that the reconnection process got stuck for some
reason. Unfortunately your log doesn't show why and unless you've got a
debug log prior to that happening it won't be possible.

Theoretically seeing which function the thread doing the reconnect is
stuck at could perhaps show why.

Usually the only fix for this is to destroy the VM which is stuck.

</body></email><email><emailId>20210714144443</emailId><senderName>Martin Kletzander</senderName><senderEmail>mkletzan@redhat.com</senderEmail><timestampReceived>2021-07-14 14:44:43-0400</timestampReceived><subject>Re: how to build a github release tarball</subject><body>


On Wed, Jul 14, 2021 at 08:44:52PM +0800, Jiatong Shen wrote:
&gt;Hello community,
&gt;
&gt;      I am trying to figure out a way to build a release tarball like
&gt;https://github.com/libvirt/libvirt/releases?after=v6.2.0, for libvirt
&gt;6.0.0, but don't know how.
&gt;Could anyone teach me how to package it? thank you.
&gt;

If you look at https://libvirt.org/downloads.html then there is a link
to release tarballs: https://libvirt.org/sources/

If you want to build it yourself, then something along the lines of
`meson build &amp;&amp; ninja -C build dist` should do, but it should not be
needed.

Otherwise the tarball provided by github is just a snapshot of the git
tree at the point in time of the tag and build needs to be done the same
way as building from git.

Did that answer your question?

Martin

&gt;--
&gt;
&gt;Best Regards,
&gt;
&gt;Jiatong Shen

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20210714155644</emailId><senderName>Andrea Bolognani</senderName><senderEmail>abologna@redhat.com</senderEmail><timestampReceived>2021-07-14 15:56:44-0400</timestampReceived><subject>Re: how to build a github release tarball</subject><body>

On Wed, Jul 14, 2021 at 04:44:43PM +0200, Martin Kletzander wrote:
&gt; On Wed, Jul 14, 2021 at 08:44:52PM +0800, Jiatong Shen wrote:
&gt; &gt; Hello community,
&gt; &gt;
&gt; &gt;      I am trying to figure out a way to build a release tarball like
&gt; &gt; https://github.com/libvirt/libvirt/releases?after=v6.2.0, for libvirt
&gt; &gt; 6.0.0, but don't know how.
&gt; &gt; Could anyone teach me how to package it? thank you.
&gt;
&gt; If you look at https://libvirt.org/downloads.html then there is a link
&gt; to release tarballs: https://libvirt.org/sources/

This is definitely the way to go.

&gt; If you want to build it yourself, then something along the lines of
&gt; `meson build &amp;&amp; ninja -C build dist` should do, but it should not be
&gt; needed.

libvirt 6.0.0 was still using autotools ;)

&gt; Otherwise the tarball provided by github is just a snapshot of the git
&gt; tree at the point in time of the tag and build needs to be done the same
&gt; way as building from git.

GitHub / GitLab "releases" are somewhere between git snapshots and
proper release tarballs in terms of contents, and for projects such
as libvirt they are basically unusable - the build process will break
in interesting ways very quickly. Pretend they don't exist and grab a
proper, signed source tarball from the location Martin pointed you to
instead.

-- 
Andrea Bolognani / Red Hat / Virtualization

</body></email><email><emailId>20210714151230</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-07-14 15:12:30-0400</timestampReceived><subject>Re: openVswitch won't get to a virtual IP</subject><body>

On 7/14/21 3:54 PM, lejeczek wrote:
&gt; Hi guys.
&gt; 
&gt; Among all the mailing lists I'm subscriber of this one I thought, would
&gt; where chances to find 'openvswitch'+'libvirtd' experts to share thoughts
&gt; &amp; suggestions should be grater.
&gt; 
&gt; A case:
&gt; a) all guests are KVM.
&gt; b) I have NM managed OVS bridge and libvirtd network to/on that bridge
&gt; c) "regular" NM bridge and network off it in libvirt
&gt; 
&gt; problem is - guests on OVS network can _not_ ping a virtual IP of a
&gt; guest(s) on 'regular' bridge network, but..   can ping "actual" IP of
&gt; that same guest(s) okey.

I'm not sure what you mean by: "actual" IP of that same guest.

But in general, if you have two bridges you also have two separate
subnets. So you want to set up routing between them. And also inspect
rules that libvirt adds to its default network, because those might
clash with your setup.

Michal

</body></email><email><emailId>20210708093459</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-07-08 09:34:59-0400</timestampReceived><subject>Re: DAC &amp; glusterFS - errors</subject><body>

On 7/5/21 11:28 PM, lejeczek wrote:
&gt; Hi guys
&gt; 
&gt; I'm trying to spin up a VM whose image is on a GlusterFS vol, and I fail:
&gt; 
&gt; -&gt; $ virsh create /var/lib/pacemaker/conf.d/win10Pro.xml
&gt; error: Failed to create domain from /var/lib/pacemaker/conf.d/win10Pro.xml
&gt; error: failed to initialize gluster connection (src=0x7f0af807b410
&gt; priv=0x7f0af8090070): Invalid argument
&gt; 
&gt; In logs:
&gt; ...
&gt; 2021-07-05 21:13:12.950+0000: 141524: warning :
&gt; virSecurityDACSetOwnership:828 : Unable to restore label on
&gt; 'win10Pro.qcow2'. XATTRs might have been left in inconsistent state.
&gt; internal error: child reported (status=125): failed to initialize
&gt; gluster connection (src=0x7f0b00097030 priv=0x7f0b000956c0): Invalid
&gt; argument
&gt; 
&gt; Any ideas &amp; suggestions greatly appreciated.
&gt; thanks, L.
&gt; 

Hey, since this is gluster I wonder if it is related to this bug:

  https://bugzilla.redhat.com/show_bug.cgi?id=1786301

That one is a deadlock scenario, but nevertheless might be worth turning
off seclabel remembering to see if that's the root cause. Just set
remember_owner=0 in /etc/libvirt/qemu.conf, restart libvirtd and see if
the problem persists.

Michal

</body></email><email><emailId>20210714083422</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-07-14 08:34:22-0400</timestampReceived><subject>Re: virsh qemu-monitor-command block_resize not working</subject><body>

On Wed, Jul 14, 2021 at 10:10:35AM +0200, arjen-libvirt@gugu.be wrote:
&gt; Hi List,
&gt; 
&gt; some version info:
&gt; ]# /usr/libexec/qemu-kvm -version
&gt; QEMU emulator version 4.2.0
&gt; (qemu-kvm-4.2.0-48.module+el8.4.0+534+4680a14e) Copyright (c) 2003-2019
&gt; Fabrice Bellard and the QEMU Project developers
&gt; 
&gt; ]# virsh version
&gt; Compiled against library: libvirt 6.0.0
&gt; Using library: libvirt 6.0.0
&gt; Using API: QEMU 6.0.0
&gt; Running hypervisor: QEMU 4.2.0
&gt; 
&gt; information about block devices for one specific guest:
&gt; ]# virsh qemu-monitor-command uat-win201202.uat.gugu.be --hmp info block
&gt; libvirt-2-format:
&gt; /data/kvm/storage/diskimages01/uat-win201202_disk1_C.qcow2 (qcow2)
&gt; Attached to:      /machine/peripheral/virtio-disk0/virtio-backend Cache
&gt; mode:       writeback
&gt; 
&gt; ide0-0-0: [not inserted]
&gt;     Attached to:      ide0-0-0
&gt;     Removable device: not locked, tray closed
&gt; 
&gt; 
&gt; But then, when I want to resize the block device, I just cannot seem to
&gt; find the correct device. I tried all of these:
&gt; 
&gt; virsh qemu-monitor-command uat-win201202.uat.gugu.be --hmp block_resize
&gt; libvirt-2-storage 48G
&gt; Error: Cannot find device=libvirt-2-storage nor node_name=
&gt; 
&gt; virsh qemu-monitor-command uat-win201202.uat.gugu.be --hmp block_resize
&gt; drive-libvirt-2-storage 48G
&gt; Error: Cannot find device=drive-libvirt-2-storage nor node_name=
&gt; 
&gt; virsh qemu-monitor-command uat-win201202.uat.gugu.be --hmp block_resize
&gt; virtio-disk0 48G
&gt; Error: Cannot find device=virtio-disk0 nor node_name=
&gt; 
&gt; virsh qemu-monitor-command uat-win201202.uat.gugu.be --hmp block_resize
&gt; drive-virtio-disk0 48G
&gt; Error: Cannot find device=drive-virtio-disk0 nor node_name=
&gt; 
&gt; In a previous qemu version this worked (EL 7). Can someone help me out?

Libvirt has changed the way it configures disks with QEMU to use the
modern -blockdev argument. I expect this impacts your usage, but I
dont know what the correct naming should be.

Ignoring that though, why are you even using qemu-monitor-command in
the first place ?  Libvirt directly supports live block resizing
via the 'virsh blockresize' command


Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20210709131053</emailId><senderName>Tony Brian Albers</senderName><senderEmail>tba@kb.dk</senderEmail><timestampReceived>2021-07-09 13:10:53-0400</timestampReceived><subject>Re: self-study material sought</subject><body>

Gunnar wrote:
&gt; I am doing a retraining as IT-specialist atm and have 2 weeks full time
&gt; ahead to dive into virtualization.
&gt; The main training will we looking at Hyper-V which I have not interest
&gt; whatsoever in.
&gt; 
&gt; Now I want to get a good grip on the libvirt/kvm/qemu side of things and
&gt; am looking for good learning resource to dive into for this.
&gt; Can anybody recommend anything?
&gt; 
&gt;    * I like video but am able to read
&gt;    * "just google around a bit"/"search on youtube" is not the kind of
&gt;      recommendations I am up for (I will do this if noting else comes out
&gt;      of this anyway)
&gt;    * I'd like to go from 0 to hero (even though I am a bit above 0
&gt;      already, but like to start from the ground)
&gt;    * alternatively proxmox would be a topic worth considering for me
&gt; 
&gt; looking forward to any recommendation in this.
&gt; 
&gt; thx and best
&gt; 
&gt; Gunnar
&gt; 
&gt; 

Hiya,

I'd recommend reading the oVirt/RHEV documentation:

https://access.redhat.com/documentation/en-us/red_hat_virtualization/4.4/

Start with 'Planning' and go on from there.

I also recommend that you build a test environment, if you have a 
reasonably powerful workstation or small server, you can build a virtual 
oVirt environment using qemu-kvm or VirtualBox. You could also just use 
a few spare PC's if you have any.

HTH

/tony

-- 
Tony Albers - Systems Architect - Data Department, Royal Danish Library, 
Victor Albecks Vej 1, 8000 Aarhus C, Denmark
Tel: +45 2566 2383 - CVR/SE: 2898 8842 - EAN: 5798000792142

</body></email><email><emailId>20210731101959</emailId><senderName>daggs</senderName><senderEmail>daggs@gmx.com</senderEmail><timestampReceived>2021-07-31 10:19:59-0400</timestampReceived><subject>issues with vm after upgrade</subject><body>

Greetings,

a few weeks ago I've upgraded my system, this resulted with qemu and libvirt being \
upgraded to 6.0.0 and ~7.5.0 respectfully. I have two vms running on my system, \
router and streamer. the router vm works great, the streamer vm doesn't.
after the streamer vm start, the monitor screen gets black and thats it. no relevant \
error are found in the log, see: http://dpaste.com/ERWDEJQPC the xml ca be found at \
https://dpaste.com/FQDN6NTN2 in contrast the following oneliner works: \
                qemu-system-x86_64 \
-machine pc-q35-5.0,accel=kvm,usb=off,smm=on,dump-guest-core=off \
-cpu host,migratable=on \
-m 15360 \
-smp 4,sockets=1,dies=1,cores=2,threads=2 \
-drive file=/home/streamer/streamer.img.qcow2.new,if=virtio,format=qcow2 \
-device vfio-pci,host=0000:00:02.0,romfile=/home/streamer/gpu-8086:5912-uefi.rom,multifunction=on \
                \
-device vfio-pci,host=0000:00:1f.3,multifunction=on \
-usb \
-device usb-host,vendorid=0x046d,productid=0xc52e \
-device usb-host,vendorid=0x2548,productid=0x1002 \
-display none \
-netdev tap,id=hostnet0,ifname=virtsw-streamer,script=no,downscript=no \
-device e1000e,netdev=hostnet0,id=net0,mac=52:54:00:5a:4c:8c \
-blockdev '{"driver":"file","filename":"/usr/share/edk2-ovmf/OVMF_CODE.secboot.fd","node-name":"libvirt-pflash0-storage","auto-read-only":true,"discard":"unmap"}' \
                \
-blockdev '{"driver":"file","filename":"/var/lib/libvirt/qemu/nvram/streamer-vm-q35_VA \
RS.fd","node-name":"libvirt-pflash1-storage","auto-read-only":true,"discard":"unmap"}'


another issue encountered caused by this param: "-audiodev id=audio1,driver=none" \
which is auto added to the qemu line. if I add the line to the above oneliner, the \
guest doesn't detects the pt sound card. without it it does and it works.

help on solving both issues will be appreciated.

Thanks,

Dagg


</body></email><email><emailId>20210727092225</emailId><senderName>Francesc Guasch</senderName><senderEmail>frankie@telecos.upc.edu</senderEmail><timestampReceived>2021-07-27 09:22:25-0400</timestampReceived><subject>Passthrough PCI GPU device fails on reboot</subject><body>

Hello.

I have a host with an NVIDIA RTX 3090. I configured PCI passthrough
and it works fine. We are using it for CUA and Matlab on Ubuntu 20.04.

The problem comes sometimes on rebooting the virtual machine. It doesn't
happen 100% of the times but eventually after 3 or 4 reboots the PCI
device stops working. The only solution is to reboot the host.

Weird thing is this only happens when rebooting the VM. After a host
reboot if we shutdown the virtual machine and we start it again,
it works fine. I wrote a small script that does that a hundred times
just to make sure. Only a reboot triggers the problem.

When it fails I run "nvidia-smi" in the virtual machine and I get:

     No devices were found

Also I spotted some errors in syslog

    NVRM: installed in this system is not supported by the
    NVIDIA 460.91.03 driver release.
    NVRM: GPU 0000:01:01.0: GPU has fallen off the bus
    NVRM: the NVIDIA kernel module is unloaded.
    NVRM: GPU 0000:01:01.0: RmInitAdapter failed! (0x23:0x65:1204)
    NVRM: GPU 0000:01:01.0: rm_init_adapter failed, device minor number 0

The device is there because typing lspci I can see information:

     0000:01:01.0 VGA compatible controller [0300]: NVIDIA Corporation
     Device [10de:2204] (rev a1)
	Subsystem: Gigabyte Technology Co., Ltd Device [1458:403b]
	Kernel driver in use: nvidia
	Kernel modules: nvidiafb, nouveau, nvidia_drm, nvidia

I tried different Nvidia drivers and Linux kernels in the host and
the virtual machine with the same results.

I wonder if some process is keeping hold of the PCI device but every
thing I tried failed. I made sure the virtual machines are down. Then
I start it again. I also tried restarting libvirtd.

I was thinking about a hardware problem but we 3 different GPUs
of the same model and it happens with all of them.

I know this is hard but I wonder if anyone here has any idea of
what can I do to fix this.

thank you for your time

</body></email><email><emailId>20210727102936</emailId><senderName>Erik Skultety</senderName><senderEmail>eskultet@redhat.com</senderEmail><timestampReceived>2021-07-27 10:29:36-0400</timestampReceived><subject>Re: Passthrough PCI GPU device fails on reboot</subject><body>

On Tue, Jul 27, 2021 at 11:22:25AM +0200, Francesc Guasch wrote:
&gt; Hello.
&gt; 
&gt; I have a host with an NVIDIA RTX 3090. I configured PCI passthrough
&gt; and it works fine. We are using it for CUA and Matlab on Ubuntu 20.04.
&gt; 
&gt; The problem comes sometimes on rebooting the virtual machine. It doesn't
&gt; happen 100% of the times but eventually after 3 or 4 reboots the PCI
&gt; device stops working. The only solution is to reboot the host.
&gt; 
&gt; Weird thing is this only happens when rebooting the VM. After a host
&gt; reboot if we shutdown the virtual machine and we start it again,
&gt; it works fine. I wrote a small script that does that a hundred times
&gt; just to make sure. Only a reboot triggers the problem.
&gt; 
&gt; When it fails I run "nvidia-smi" in the virtual machine and I get:
&gt; 
&gt;     No devices were found
&gt; 
&gt; Also I spotted some errors in syslog
&gt; 
&gt;    NVRM: installed in this system is not supported by the
&gt;    NVIDIA 460.91.03 driver release.
&gt;    NVRM: GPU 0000:01:01.0: GPU has fallen off the bus
&gt;    NVRM: the NVIDIA kernel module is unloaded.
&gt;    NVRM: GPU 0000:01:01.0: RmInitAdapter failed! (0x23:0x65:1204)
&gt;    NVRM: GPU 0000:01:01.0: rm_init_adapter failed, device minor number 0
&gt; 
&gt; The device is there because typing lspci I can see information:
&gt; 
&gt;     0000:01:01.0 VGA compatible controller [0300]: NVIDIA Corporation
&gt;     Device [10de:2204] (rev a1)
&gt; 	Subsystem: Gigabyte Technology Co., Ltd Device [1458:403b]
&gt; 	Kernel driver in use: nvidia
&gt; 	Kernel modules: nvidiafb, nouveau, nvidia_drm, nvidia
&gt; 
&gt; I tried different Nvidia drivers and Linux kernels in the host and
&gt; the virtual machine with the same results.

Hi,
this question is better suited for vfio-users@redhat.com. Once the GPU is bound
to the vfio-pci driver, it's out of libvirt's hands.
AFAIR Nvidia only enabled PCI device assignment on GeForce cards on Windows 10
VMs, but you claim to run a Linux VM. Back when I worked on the vGPU stuff that
is supported only on the Tesla cards, I remember being told that the host and
guest driver communicated with each other. Applying the same to GeForce, I
would not be surprised if NVIDIA detected in the host driver that the
corresponding guest driver is not a Windows 10 one and didn't do a proper GPU
reset in between VM reboots - hence the need to reboot the host. There used to
be a similar bus reset bug in the AMD host driver not so long ago which
affected every single VM shutdown/reboot in a way that the host had to be
rebooted in order for the card to be usable again. Be it as it may, I can only
speculate and since your scenario is officially not supported by NVIDIA I wish
you the best of luck :)

Regards,
Erik

</body></email><email><emailId>20210603164159</emailId><senderName>Francesc Guasch</senderName><senderEmail>frankie@telecos.upc.edu</senderEmail><timestampReceived>2021-06-03 16:41:59-0400</timestampReceived><subject>Re: virt viewer for Mac</subject><body>

El 2/6/21 a les 7:24, Tony Brian Albers ha escrit:
&gt; Francesc Guasch wrote:

&gt;&gt; Is there another alternative ? Are there plans to port
&gt;&gt; virt-viewer for Macs ?

&gt; Have you tried searching github? There seems to be quite a few people
&gt; working on homebrew formulaes for virt-manager and virt-viewer
&gt; 

ok, I found this one.

https://github.com/jeffreywildman/homebrew-virt-manager

It has 800 stars so it looks promising, as I don't have
a Mac I can't test it though.

I wonder if anyone around here has experience with it ?

</body></email><email><emailId>20210603182618</emailId><senderName>Mario Marietto</senderName><senderEmail>marietto2008@gmail.com</senderEmail><timestampReceived>2021-06-03 18:26:18-0400</timestampReceived><subject>Re: Error: --boot uefi=RPI_EFI.fd : Did not find any UEFI binary path for arch 'aarch64' emulating r</subject><body>

UPDATE : I've installed the qemu-efi package and the error is changed :

Starting install...
ERROR internal error: Unexpected enum value 0 for virDomainDeviceAddressType
Domain installation does not appear to have been successful

Il giorno gio 3 giu 2021 alle ore 19:31 Mario Marietto &lt;
marietto2008@gmail.com&gt; ha scritto:

&gt; Hello.
&gt; 
&gt; it's more of a challenge,to be able to emulate the raspberry pi 3 on my
&gt; Jetson nano (aarch64) using virt-install. I'm learning how to do that by
&gt; reading heavily here :
&gt; 
&gt; 
&gt; https://github.com/dhruvvyas90/qemu-rpi-kernel
&gt; 
&gt; 
&gt; I tried to do something like this :
&gt; 
&gt; 
&gt; virt-install \
&gt; --name pi \
&gt; --machine raspi3 \
&gt; --cpu arm1176 \
&gt; --memory 1024 \
&gt; --import \    --disk \
&gt; /root/Desktop/zi/Work/Android/Raspy/Debian/2019-09-26-raspbian-buster-lite.img,format=raw,bus=virtio \
&gt;                 \
&gt; --network user,model=virtio \
&gt; --video vga \
&gt; --graphics spice \
&gt; --rng device=/dev/urandom,model=virtio \
&gt; --boot 'uefi=RPI_EFI.fd,dtb=bcm2710-rpi-3-b-plus.dtb,kernel=kernel8.img,kernel_args=root=/dev/vda2 \
&gt;                 rootwait panic=1 dwc_otg.fiq_fsm_enable=0' \
&gt; --events on_reboot=destroy
&gt; 
&gt; 
&gt; But I get this error :
&gt; 
&gt; 
&gt; ERROR Error: --boot uefi=RPI_EFI.fd,dtb=bcm2710-rpi-3-b-plus.dtb,kernel=
&gt; kernel8.img,kernel_args=root=/dev/vda2 rootwait panic=1
&gt; dwc_otg.fiq_fsm_enable=0: Did not find any UEFI binary path for arch
&gt; 'aarch64'
&gt; 
&gt; 
&gt; I've got the UEFI BIOS file from here :
&gt; 
&gt; 
&gt; 
&gt; https://github.com/andreiw/RaspberryPiPkg/blob/master/Binary/prebuilt/2019Jan16-GCC5/RELEASE/RPI_EFI.fd
&gt;  
&gt; 
&gt; I'm not sure if it isn't the right efi file to use in this specific
&gt; configuration or if it is,but I'm passing the parameter badly. What do you
&gt; suggest me to do ?
&gt; 
&gt; --
&gt; Mario.
&gt; 


-- 
Mario.


[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;p style="margin-top:0px;margin-right:0px;margin-left:0px;padding:0px;b \
order:0px;font-variant-numeric:inherit;font-variant-east-asian:inherit;font-stretch:in \
herit;line-height:inherit;font-family:-apple-system,BlinkMacSystemFont,"Segoe \
UI","Liberation \
Sans",sans-serif;font-size:15px;vertical-align:baseline;box-sizing:inherit;clear:both;color:rgb(36,39,41)"&gt;UPDATE \
: I've installed the qemu-efi package and the error is changed :&lt;/p&gt;&lt;p \
style="margin:0px;padding:0px;border:0px;font-variant-numeric:inherit;font-variant-eas \
t-asian:inherit;font-stretch:inherit;line-height:inherit;font-family:-apple-system,BlinkMacSystemFont,"Segoe \
UI","Liberation \
Sans",sans-serif;font-size:15px;vertical-align:baseline;box-sizing:inherit;clear:both;color:rgb(36,39,41)"&gt;Starting \
install...&lt;br style="box-sizing:inherit"&gt;ERROR internal error: Unexpected enum value \
0 for virDomainDeviceAddressType&lt;br style="box-sizing:inherit"&gt;Domain installation \
does not appear to have been successful&lt;/p&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div \
dir="ltr" class="gmail_attr"&gt;Il giorno gio 3 giu 2021 alle ore 19:31 Mario Marietto \
&lt;&lt;a href="mailto:marietto2008@gmail.com"&gt;marietto2008@gmail.com&lt;/a&gt;&gt; ha \
scritto:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;&lt;div dir="ltr"&gt;&lt;div \
style="margin:12px 0px 0px 8px;padding:5px 16px 5px \
0px;border:0px;font-variant-numeric:inherit;font-variant-east-asian:inherit;font-stret \
ch:inherit;font-size:medium;line-height:inherit;font-family:IBMPlexSans,Arial,sans-ser \
if;vertical-align:baseline;max-width:800px;color:rgb(129,131,132);background-color:rgb(26,26,27)"&gt;&lt;div \
style="padding:0px 0px \
1px;border:0px;font-style:inherit;font-variant:inherit;font-stretch:inherit;font-size:14px;line-height:21px;font-family:"Noto \
Sans",Arial,sans-serif;vertical-align:baseline;word-break:break-word;overflow:auto;color:rgb(215,218,220)"&gt;&lt;p \
style="margin:0px;padding:0px 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;Hello.&lt;/p&gt;&lt;p \
style="margin:0px;padding:0.8em 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;it's more of a \
challenge,to be able to emulate the raspberry pi 3 on my Jetson nano (aarch64) using \
virt-install. I'm learning how to do that by reading heavily here :&lt;/p&gt;&lt;p \
style="margin:0px;padding:0.8em 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;&lt;br&gt;&lt;/p&gt;&lt;p \
style="margin:0px;padding:0.8em 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;&lt;a \
href="https://github.com/dhruvvyas90/qemu-rpi-kernel" rel="noopener nofollow ugc" \
style="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline" \
target="_blank"&gt;https://github.com/dhruvvyas90/qemu-rpi-kernel&lt;/a&gt;&lt;/p&gt;&lt;p \
style="margin:0px;padding:0.8em 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;&lt;br&gt;&lt;/p&gt;&lt;p \
style="margin:0px;padding:0.8em 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;I tried to do something like \
this :&lt;/p&gt;&lt;p style="margin:0px;padding:0.8em 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;&lt;br&gt;&lt;/p&gt;&lt;pre \
style="margin-top:4px;margin-bottom:4px;padding:8px;border:0px;font-style:inherit;font \
-variant:inherit;font-weight:inherit;font-stretch:inherit;font-size:inherit;line-heigh \
t:1.4;font-family:inherit;vertical-align:baseline;max-width:100%;overflow:auto;display:grid"&gt;&lt;code \
style="margin:0px;padding:0px;border:0px;font-style:inherit;font-variant:inherit;font-stretch:inherit;font-size:13px;line-height:20px;font-family:"Noto \
Mono",Menlo,Monaco,Consolas,monospace;vertical-align:baseline;background-color:transparent;max-width:100%;overflow:auto"&gt;virt-install \
                \
    --name pi \
    --machine raspi3 \
    --cpu arm1176 \
    --memory 1024 \
    --import \    --disk \
/root/Desktop/zi/Work/Android/Raspy/Debian/2019-09-26-raspbian-buster-lite.img,format=raw,bus=virtio \
                \
    --network user,model=virtio \
    --video vga \
    --graphics spice \
    --rng device=/dev/urandom,model=virtio \
    --boot 'uefi=RPI_EFI.fd,dtb=bcm2710-rpi-3-b-plus.dtb,kernel=kernel8.img,kernel_args=root=/dev/vda2 \
                rootwait panic=1 dwc_otg.fiq_fsm_enable=0' \
    --events on_reboot=destroy 
&lt;/code&gt;&lt;/pre&gt;&lt;p style="margin:0px;padding:0.8em 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;&lt;br&gt;&lt;/p&gt;&lt;p \
style="margin:0px;padding:0.8em 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;But I get this error :&lt;/p&gt;&lt;p \
style="margin:0px;padding:0.8em 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;&lt;br&gt;&lt;/p&gt;&lt;p \
style="margin:0px;padding:0.8em 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;&lt;span \
style="margin:0px;padding:0px;border:0px;font-style:inherit;font-variant:inherit;font- \
weight:700;font-stretch:inherit;font-size:inherit;line-height:inherit;font-family:inherit;vertical-align:baseline"&gt;ERROR \
Error: --boot uefi=RPI_EFI.fd,dtb=bcm2710-rpi-3-b-plus.dtb,kernel= \
kernel8.img,kernel_args=root=/dev/vda2 rootwait panic=1 dwc_otg.fiq_fsm_enable=0: Did \
not find any UEFI binary path for arch 'aarch64'&lt;/span&gt;&lt;/p&gt;&lt;p \
style="margin:0px;padding:0.8em 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;&lt;br&gt;&lt;/p&gt;&lt;p \
style="margin:0px;padding:0.8em 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;I've got the UEFI BIOS \
file from here :&lt;/p&gt;&lt;p style="margin:0px;padding:0.8em 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;&lt;br&gt;&lt;/p&gt;&lt;p \
style="margin:0px;padding:0.8em 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;&lt;a \
href="https://github.com/andreiw/RaspberryPiPkg/blob/master/Binary/prebuilt/2019Jan16-GCC5/RELEASE/RPI_EFI.fd" \
rel="noopener nofollow ugc" \
style="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline" \
target="_blank"&gt;https://github.com/andreiw/RaspberryPiPkg/blob/master/Binary/prebuilt/2019Jan16-GCC5/RELEASE/RPI_EFI.fd&lt;/a&gt;&lt;/p&gt;&lt;p \
style="margin:0px;padding:0.8em 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;&lt;br&gt;&lt;/p&gt;&lt;p \
style="margin:0px;padding:0.8em 0px \
0px;border:0px;font:inherit;vertical-align:baseline"&gt;I'm not sure if it isn't \
the right efi file to use in this specific configuration or if it is,but I'm \
passing the parameter badly. What do you suggest me to do \
?&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- &lt;br&gt;&lt;div dir="ltr"&gt;Mario.&lt;br&gt;&lt;/div&gt;&lt;/div&gt; \
&lt;/blockquote&gt;&lt;/div&gt;&lt;br clear="all"&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- &lt;br&gt;&lt;div dir="ltr" \
class="gmail_signature"&gt;Mario.&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20210603184809</emailId><senderName>Link Dupont</senderName><senderEmail>link@sub-pop.net</senderEmail><timestampReceived>2021-06-03 18:48:09-0400</timestampReceived><subject>Re: virtiofs mounted filesystems &amp; SELinux</subject><body>

Adding the &lt;binary xattr='on'&gt; element to the &lt;filesystem&gt; device does 
seem to spawn virtiofsd with the option string "source=/home,xattr". My 
guest can no longer mount the device though.

It errors with:

[ 170.225553] 9pnet_virtio: no channels available
mount: mount(2) failed: No such file or directory

I think what this is doing is causing libvirt to create the device as a 
virtiofs device instead of a 9p device. The EL7 kernel doesn't have a 
virtiofs driver, so it can't mount virtiofs devices.

My knowledge is unfortunately limited about the nuances between 9p and 
virtiofs. So I'm mostly experimenting by trial-and-error here.

On Wed, Jun 2 2021 at 03:55:40 PM -0500, Connor Kuehl 
&lt;ckuehl@redhat.com&gt; wrote:
&gt; On 5/21/21 11:59 AM, Link Dupont wrote:
&gt; 
&gt; Adding the virtio-fs mailing list.
&gt; 
&gt;&gt;  I am mounting a filesystem into a domain using the virtiofs driver.
&gt;&gt; 
&gt;&gt;  &lt;filesystem accessmode="passthrough" type="mount"&gt;
&gt;&gt;        &lt;source dir="/home"/&gt;
&gt;&gt;        &lt;target dir="/home"/&gt;
&gt;&gt;        &lt;driver type="virtiofs"/&gt;
&gt;&gt;  &lt;/filesystem&gt;
&gt;&gt; 
&gt;&gt;  Both my host (Fedora 34) and guest (CentOS 8.4) are running with 
&gt;&gt; SELinux
&gt;&gt;  enforcing. From my host, I can see that the SELinux context type is 
&gt;&gt; set to
&gt;&gt;  user_home_dir_t.
&gt;&gt; 
&gt;&gt;  $ ls -ldZ /home/link
&gt;&gt;  drwxr-xr-x. 61 link link system_u:object_r:user_home_dir_t:s0 8192 
&gt;&gt; May 21
&gt;&gt;  12:41 /home/link
&gt;&gt; 
&gt;&gt;&gt; From within the guest however, the volume is unlabeled_t
&gt;&gt; 
&gt;&gt;  $ ls -lZd /home/link
&gt;&gt;  drwxr-xr-x. 61 link link system_u:object_r:unlabeled_t:s0 8192 May 
&gt;&gt; 21 12:53 /
&gt;&gt;  home/link
&gt;&gt; 
&gt;&gt;  Is there a way to pass the SELinux context through to the guest? Or 
&gt;&gt; mount the
&gt;&gt;  volume with the correct options to map SELinux contexts?
&gt;&gt; 
&gt;&gt; 
&gt; 
&gt; Hi,
&gt; 
&gt; I'm afraid I actually don't know that much about SELinux but I read
&gt; that it relies on using extended attributes in the file system to
&gt; accomplish its labeling.
&gt; 
&gt; Do you still experience this issue when you enable extended attribute
&gt; support[1] in virtiofsd? The example in the optional parameters 
&gt; snippet
&gt; enables extended attributes with the xattr='on' element.
&gt; 
&gt; Connor
&gt; 
&gt; [1] https://libvirt.org/kbase/virtiofs.html#optional-parameters
&gt; 


</body></email><email><emailId>20210603173148</emailId><senderName>Mario Marietto</senderName><senderEmail>marietto2008@gmail.com</senderEmail><timestampReceived>2021-06-03 17:31:48-0400</timestampReceived><subject>Error: --boot uefi=RPI_EFI.fd : Did not find any UEFI binary path for arch 'aarch64' emulating raspi</subject><body>

Hello.

it's more of a challenge,to be able to emulate the raspberry pi 3 on my
Jetson nano (aarch64) using virt-install. I'm learning how to do that by
reading heavily here :


https://github.com/dhruvvyas90/qemu-rpi-kernel


I tried to do something like this :


virt-install \
    --name pi \
    --machine raspi3 \
    --cpu arm1176 \
    --memory 1024 \
    --import \    --disk
/root/Desktop/zi/Work/Android/Raspy/Debian/2019-09-26-raspbian-buster-lite.img,format=raw,bus=virtio
\
    --network user,model=virtio \
    --video vga \
    --graphics spice \
    --rng device=/dev/urandom,model=virtio \
    --boot 'uefi=RPI_EFI.fd,dtb=bcm2710-rpi-3-b-plus.dtb,kernel=kernel8.img,kernel_args=root=/dev/vda2
rootwait panic=1 dwc_otg.fiq_fsm_enable=0' \
    --events on_reboot=destroy


But I get this error :


ERROR Error: --boot uefi=RPI_EFI.fd,dtb=bcm2710-rpi-3-b-plus.dtb,kernel=
kernel8.img,kernel_args=root=/dev/vda2 rootwait panic=1
dwc_otg.fiq_fsm_enable=0: Did not find any UEFI binary path for arch
'aarch64'


I've got the UEFI BIOS file from here :


https://github.com/andreiw/RaspberryPiPkg/blob/master/Binary/prebuilt/2019Jan16-GCC5/RELEASE/RPI_EFI.fd


I'm not sure if it isn't the right efi file to use in this specific
configuration or if it is,but I'm passing the parameter badly. What do you
suggest me to do ?

-- 
Mario.

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div class="gmail-_3xX726aBn29LDbsDtzr_6E \
gmail-_1Ap4F5maDtT1E1YuCiaO0r gmail-D3IL3FD0RFy_mkKLPwL4" style="margin:12px 0px 0px \
8px;padding:5px 16px 5px \
0px;border:0px;font-variant-numeric:inherit;font-variant-east-asian:inherit;font-stret \
ch:inherit;font-size:medium;line-height:inherit;font-family:IBMPlexSans,Arial,sans-ser \
if;vertical-align:baseline;max-width:800px;color:rgb(129,131,132);background-color:rgb(26,26,27)"&gt;&lt;div \
class="gmail-_292iotee39Lmt0MkQZ2hPV gmail-RichTextJSON-root" style="padding:0px 0px \
1px;border:0px;font-style:inherit;font-variant:inherit;font-stretch:inherit;font-size:14px;line-height:21px;font-family:"Noto \
Sans",Arial,sans-serif;vertical-align:baseline;word-break:break-word;overflow:auto;color:rgb(215,218,220)"&gt;&lt;p \
class="gmail-_1qeIAgB0cPwnLhDF9XSiJM" style="margin:0px;padding:0px 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;Hello.&lt;/p&gt;&lt;p \
class="gmail-_1qeIAgB0cPwnLhDF9XSiJM" style="margin:0px;padding:0.8em 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;it's more of a \
challenge,to be able to emulate the raspberry pi 3 on my Jetson nano (aarch64) using \
virt-install. I'm learning how to do that by reading heavily here :&lt;/p&gt;&lt;p \
class="gmail-_1qeIAgB0cPwnLhDF9XSiJM" style="margin:0px;padding:0.8em 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;&lt;br&gt;&lt;/p&gt;&lt;p \
class="gmail-_1qeIAgB0cPwnLhDF9XSiJM" style="margin:0px;padding:0.8em 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;&lt;a \
href="https://github.com/dhruvvyas90/qemu-rpi-kernel" \
class="gmail-_3t5uN8xUmg0TOwRCOGQEcU" rel="noopener nofollow ugc" target="_blank" \
style="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline"&gt;https://github.com/dhruvvyas90/qemu-rpi-kernel&lt;/a&gt;&lt;/p&gt;&lt;p \
class="gmail-_1qeIAgB0cPwnLhDF9XSiJM" style="margin:0px;padding:0.8em 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;&lt;br&gt;&lt;/p&gt;&lt;p \
class="gmail-_1qeIAgB0cPwnLhDF9XSiJM" style="margin:0px;padding:0.8em 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;I tried to do something like \
this :&lt;/p&gt;&lt;p class="gmail-_1qeIAgB0cPwnLhDF9XSiJM" style="margin:0px;padding:0.8em \
0px 0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;&lt;br&gt;&lt;/p&gt;&lt;pre \
class="gmail-_3GnarIQX9tD_qsgXkfSDz1" \
style="margin-top:4px;margin-bottom:4px;padding:8px;border:0px;font-style:inherit;font \
-variant:inherit;font-weight:inherit;font-stretch:inherit;font-size:inherit;line-heigh \
t:1.4;font-family:inherit;vertical-align:baseline;max-width:100%;overflow:auto;display:grid"&gt;&lt;code \
class="gmail-_34q3PgLsx9zIU5BiSOjFoM" \
style="margin:0px;padding:0px;border:0px;font-style:inherit;font-variant:inherit;font-stretch:inherit;font-size:13px;line-height:20px;font-family:"Noto \
Mono",Menlo,Monaco,Consolas,monospace;vertical-align:baseline;background-color:transparent;max-width:100%;overflow:auto"&gt;virt-install \
                \
    --name pi \
    --machine raspi3 \
    --cpu arm1176 \
    --memory 1024 \
    --import \    --disk \
/root/Desktop/zi/Work/Android/Raspy/Debian/2019-09-26-raspbian-buster-lite.img,format=raw,bus=virtio \
                \
    --network user,model=virtio \
    --video vga \
    --graphics spice \
    --rng device=/dev/urandom,model=virtio \
    --boot 'uefi=RPI_EFI.fd,dtb=bcm2710-rpi-3-b-plus.dtb,kernel=kernel8.img,kernel_args=root=/dev/vda2 \
                rootwait panic=1 dwc_otg.fiq_fsm_enable=0' \
    --events on_reboot=destroy 
&lt;/code&gt;&lt;/pre&gt;&lt;p class="gmail-_1qeIAgB0cPwnLhDF9XSiJM" style="margin:0px;padding:0.8em \
0px 0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;&lt;br&gt;&lt;/p&gt;&lt;p \
class="gmail-_1qeIAgB0cPwnLhDF9XSiJM" style="margin:0px;padding:0.8em 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;But I get this error :&lt;/p&gt;&lt;p \
class="gmail-_1qeIAgB0cPwnLhDF9XSiJM" style="margin:0px;padding:0.8em 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;&lt;br&gt;&lt;/p&gt;&lt;p \
class="gmail-_1qeIAgB0cPwnLhDF9XSiJM" style="margin:0px;padding:0.8em 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;&lt;span \
class="gmail-_12FoOEddL7j_RgMQN0SNeU" \
style="margin:0px;padding:0px;border:0px;font-style:inherit;font-variant:inherit;font- \
weight:700;font-stretch:inherit;font-size:inherit;line-height:inherit;font-family:inherit;vertical-align:baseline"&gt;ERROR \
Error: --boot uefi=RPI_EFI.fd,dtb=bcm2710-rpi-3-b-plus.dtb,kernel= \
kernel8.img,kernel_args=root=/dev/vda2 rootwait panic=1 dwc_otg.fiq_fsm_enable=0: Did \
not find any UEFI binary path for arch 'aarch64'&lt;/span&gt;&lt;/p&gt;&lt;p \
class="gmail-_1qeIAgB0cPwnLhDF9XSiJM" style="margin:0px;padding:0.8em 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;&lt;br&gt;&lt;/p&gt;&lt;p \
class="gmail-_1qeIAgB0cPwnLhDF9XSiJM" style="margin:0px;padding:0.8em 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;I've got the UEFI BIOS \
file from here :&lt;/p&gt;&lt;p class="gmail-_1qeIAgB0cPwnLhDF9XSiJM" \
style="margin:0px;padding:0.8em 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;&lt;br&gt;&lt;/p&gt;&lt;p \
class="gmail-_1qeIAgB0cPwnLhDF9XSiJM" style="margin:0px;padding:0.8em 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;&lt;a \
href="https://github.com/andreiw/RaspberryPiPkg/blob/master/Binary/prebuilt/2019Jan16-GCC5/RELEASE/RPI_EFI.fd" \
class="gmail-_3t5uN8xUmg0TOwRCOGQEcU" rel="noopener nofollow ugc" target="_blank" \
style="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline"&gt;https:/ \
/github.com/andreiw/RaspberryPiPkg/blob/master/Binary/prebuilt/2019Jan16-GCC5/RELEASE/RPI_EFI.fd&lt;/a&gt;&lt;/p&gt;&lt;p \
class="gmail-_1qeIAgB0cPwnLhDF9XSiJM" style="margin:0px;padding:0.8em 0px \
0.25em;border:0px;font:inherit;vertical-align:baseline"&gt;&lt;br&gt;&lt;/p&gt;&lt;p \
class="gmail-_1qeIAgB0cPwnLhDF9XSiJM" style="margin:0px;padding:0.8em 0px \
0px;border:0px;font:inherit;vertical-align:baseline"&gt;I'm not sure if it isn't \
the right efi file to use in this specific configuration or if it is,but I'm \
passing the parameter badly. What do you suggest me to do \
?&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- &lt;br&gt;&lt;div dir="ltr" class="gmail_signature" \
data-smartmail="gmail_signature"&gt;Mario.&lt;br&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210602205540</emailId><senderName>Connor Kuehl</senderName><senderEmail>ckuehl@redhat.com</senderEmail><timestampReceived>2021-06-02 20:55:40-0400</timestampReceived><subject>Re: virtiofs mounted filesystems &amp; SELinux</subject><body>

On 5/21/21 11:59 AM, Link Dupont wrote:

Adding the virtio-fs mailing list.

&gt; I am mounting a filesystem into a domain using the virtiofs driver.
&gt; 
&gt; &lt;filesystem accessmode="passthrough" type="mount"&gt;
&gt;       &lt;source dir="/home"/&gt;
&gt;       &lt;target dir="/home"/&gt;
&gt;       &lt;driver type="virtiofs"/&gt;
&gt; &lt;/filesystem&gt;
&gt; 
&gt; Both my host (Fedora 34) and guest (CentOS 8.4) are running with SELinux 
&gt; enforcing. From my host, I can see that the SELinux context type is set to 
&gt; user_home_dir_t.
&gt; 
&gt; $ ls -ldZ /home/link
&gt; drwxr-xr-x. 61 link link system_u:object_r:user_home_dir_t:s0 8192 May 21 
&gt; 12:41 /home/link
&gt; 
&gt;&gt;From within the guest however, the volume is unlabeled_t
&gt; 
&gt; $ ls -lZd /home/link
&gt; drwxr-xr-x. 61 link link system_u:object_r:unlabeled_t:s0 8192 May 21 12:53 /
&gt; home/link
&gt; 
&gt; Is there a way to pass the SELinux context through to the guest? Or mount the 
&gt; volume with the correct options to map SELinux contexts?
&gt; 
&gt; 

Hi,

I'm afraid I actually don't know that much about SELinux but I read
that it relies on using extended attributes in the file system to
accomplish its labeling.

Do you still experience this issue when you enable extended attribute
support[1] in virtiofsd? The example in the optional parameters snippet
enables extended attributes with the xattr='on' element.

Connor

[1] https://libvirt.org/kbase/virtiofs.html#optional-parameters

</body></email><email><emailId>20210603232159</emailId><senderName>Jiatong Shen</senderName><senderEmail>yshxxsjt715@gmail.com</senderEmail><timestampReceived>2021-06-03 23:21:59-0400</timestampReceived><subject>error when building from git checkout</subject><body>

Hello community,

I am trying to compile libvirt from source but being trapped with following
error message when running ninja -C build

ninja -C build
ninja: Entering directory `build'
[1/12] Generating virkeyname-osx.html with a meson_exe.py custom command
FAILED: docs/manpages/virkeyname-osx.html
/home/sjt/.local/bin/meson --internal exe --capture
docs/manpages/virkeyname-osx.html -- /usr/bin/xsltproc --stringparam
pagesrc docs/manpages/virkeyname-osx.rst --stringparam builddir
/home/sjt/src/c/libvirt/build --stringparam timestamp 'Thu Jun  3 23:11:25
2021 UTC' --nonet ../docs/subsite.xsl docs/manpages/virkeyname-osx.html.in
docs/manpages/virkeyname-osx.html.in:17: parser error : Double hyphen
within comment: &lt;!-- This file is auto-generated from keymaps.csv
Data
  keymap-gen --lang=rst --title=virkeyname-osx --subtitle=Key name values
for os
             ^
docs/manpages/virkeyname-osx.html.in:17: parser error : Double hyphen
within comment: &lt;!-- This file is auto-generated from keymaps.csv
Data
  keymap-gen --lang=rst --title=virkeyname-osx --subtitle=Key name values
for os
                        ^
docs/manpages/virkeyname-osx.html.in:17: parser error : Double hyphen
within comment: &lt;!-- This file is auto-generated from keymaps.csv
Data
  keymap-gen --lang=rst --title=virkeyname-osx --subtitle=Key name values
for os
                                               ^
unable to parse docs/manpages/virkeyname-osx.html.in
[2/12] Generating virkeycode-usb.html with a meson_exe.py custom command
FAILED: docs/manpages/virkeycode-usb.html
/home/sjt/.local/bin/meson --internal exe --capture
docs/manpages/virkeycode-usb.html -- /usr/bin/xsltproc --stringparam
pagesrc docs/manpages/virkeycode-usb.rst --stringparam builddir
/home/sjt/src/c/libvirt/build --stringparam timestamp 'Thu Jun  3 23:11:25
2021 UTC' --nonet ../docs/subsite.xsl docs/manpages/virkeycode-usb.html.in
docs/manpages/virkeycode-usb.html.in:17: parser error : Double hyphen
within comment: &lt;!-- This file is auto-generated from keymaps.csv
Data
  keymap-gen --lang=rst --title=virkeycode-usb --subtitle=Key code values
for us
             ^
docs/manpages/virkeycode-usb.html.in:17: parser error : Double hyphen
within comment: &lt;!-- This file is auto-generated from keymaps.csv
Data
  keymap-gen --lang=rst --title=virkeycode-usb --subtitle=Key code values
for us
                        ^
docs/manpages/virkeycode-usb.html.in:17: parser error : Double hyphen
within comment: &lt;!-- This file is auto-generated from keymaps.csv
Data
  keymap-gen --lang=rst --title=virkeycode-usb --subtitle=Key code values
for us
                                               ^
unable to parse docs/manpages/virkeycode-usb.html.in
[3/12] Generating virkeycode-atset1.html with a meson_exe.py custom command
FAILED: docs/manpages/virkeycode-atset1.html
/home/sjt/.local/bin/meson --internal exe --capture
docs/manpages/virkeycode-atset1.html -- /usr/bin/xsltproc --stringparam
pagesrc docs/manpages/virkeycode-atset1.rst --stringparam builddir
/home/sjt/src/c/libvirt/build --stringparam timestamp 'Thu Jun  3 23:11:25
2021 UTC' --nonet ../docs/subsite.xsl docs/manpages/
virkeycode-atset1.html.in
docs/manpages/virkeycode-atset1.html.in:17: parser error : Double hyphen
within comment: &lt;!-- This file is auto-generated from keymaps.csv
Data
  keymap-gen --lang=rst --title=virkeycode-atset1 --subtitle=Key code
values for
             ^
docs/manpages/virkeycode-atset1.html.in:17: parser error : Double hyphen
within comment: &lt;!-- This file is auto-generated from keymaps.csv
Data
  keymap-gen --lang=rst --title=virkeycode-atset1 --subtitle=Key code
values for
                        ^
docs/manpages/virkeycode-atset1.html.in:17: parser error : Double hyphen
within comment: &lt;!-- This file is auto-generated from keymaps.csv
Data
  keymap-gen --lang=rst --title=virkeycode-atset1 --subtitle=Key code
values for
                                                  ^
unable to parse docs/manpages/virkeycode-atset1.html.in
[4/12] Generating virkeycode-xtkbd.html with a meson_exe.py custom command
FAILED: docs/manpages/virkeycode-xtkbd.html

any advice on how to fix it? thank you very much
-- 

Best Regards,

Jiatong Shen

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hello community,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I am trying to compile libvirt \
from source but being trapped with following error message when running ninja -C \
build&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;ninja -C build&lt;br&gt;ninja: Entering directory \
`build'&lt;br&gt;[1/12] Generating virkeyname-osx.html with a meson_exe.py custom \
command&lt;br&gt;FAILED: docs/manpages/virkeyname-osx.html &lt;br&gt;/home/sjt/.local/bin/meson \
--internal exe --capture docs/manpages/virkeyname-osx.html -- /usr/bin/xsltproc \
--stringparam pagesrc docs/manpages/virkeyname-osx.rst --stringparam builddir \
/home/sjt/src/c/libvirt/build --stringparam timestamp 'Thu Jun   3 23:11:25 2021 \
UTC' --nonet ../docs/subsite.xsl docs/manpages/&lt;a \
href="http://virkeyname-osx.html.in"&gt;virkeyname-osx.html.in&lt;/a&gt;&lt;br&gt;docs/manpages/&lt;a \
href="http://virkeyname-osx.html.in:17"&gt;virkeyname-osx.html.in:17&lt;/a&gt;: parser error : \
Double hyphen within comment: &lt;!-- This file is auto-generated from \
keymaps.csv&lt;br&gt;Data&lt;br&gt;   keymap-gen --lang=rst --title=virkeyname-osx --subtitle=Key \
name values for os&lt;br&gt;                    ^&lt;br&gt;docs/manpages/&lt;a \
href="http://virkeyname-osx.html.in:17"&gt;virkeyname-osx.html.in:17&lt;/a&gt;: parser error : \
Double hyphen within comment: &lt;!-- This file is auto-generated from \
keymaps.csv&lt;br&gt;Data&lt;br&gt;   keymap-gen --lang=rst --title=virkeyname-osx --subtitle=Key \
name values for os&lt;br&gt;                                    ^&lt;br&gt;docs/manpages/&lt;a \
href="http://virkeyname-osx.html.in:17"&gt;virkeyname-osx.html.in:17&lt;/a&gt;: parser error : \
Double hyphen within comment: &lt;!-- This file is auto-generated from \
keymaps.csv&lt;br&gt;Data&lt;br&gt;   keymap-gen --lang=rst --title=virkeyname-osx --subtitle=Key \
name values for os&lt;br&gt;                                                                \
^&lt;br&gt;unable to parse docs/manpages/&lt;a \
href="http://virkeyname-osx.html.in"&gt;virkeyname-osx.html.in&lt;/a&gt;&lt;br&gt;[2/12] Generating \
virkeycode-usb.html with a meson_exe.py custom command&lt;br&gt;FAILED: \
docs/manpages/virkeycode-usb.html &lt;br&gt;/home/sjt/.local/bin/meson --internal exe \
--capture docs/manpages/virkeycode-usb.html -- /usr/bin/xsltproc --stringparam \
pagesrc docs/manpages/virkeycode-usb.rst --stringparam builddir \
/home/sjt/src/c/libvirt/build --stringparam timestamp 'Thu Jun   3 23:11:25 2021 \
UTC' --nonet ../docs/subsite.xsl docs/manpages/&lt;a \
href="http://virkeycode-usb.html.in"&gt;virkeycode-usb.html.in&lt;/a&gt;&lt;br&gt;docs/manpages/&lt;a \
href="http://virkeycode-usb.html.in:17"&gt;virkeycode-usb.html.in:17&lt;/a&gt;: parser error : \
Double hyphen within comment: &lt;!-- This file is auto-generated from \
keymaps.csv&lt;br&gt;Data&lt;br&gt;   keymap-gen --lang=rst --title=virkeycode-usb --subtitle=Key \
code values for us&lt;br&gt;                    ^&lt;br&gt;docs/manpages/&lt;a \
href="http://virkeycode-usb.html.in:17"&gt;virkeycode-usb.html.in:17&lt;/a&gt;: parser error : \
Double hyphen within comment: &lt;!-- This file is auto-generated from \
keymaps.csv&lt;br&gt;Data&lt;br&gt;   keymap-gen --lang=rst --title=virkeycode-usb --subtitle=Key \
code values for us&lt;br&gt;                                    ^&lt;br&gt;docs/manpages/&lt;a \
href="http://virkeycode-usb.html.in:17"&gt;virkeycode-usb.html.in:17&lt;/a&gt;: parser error : \
Double hyphen within comment: &lt;!-- This file is auto-generated from \
keymaps.csv&lt;br&gt;Data&lt;br&gt;   keymap-gen --lang=rst --title=virkeycode-usb --subtitle=Key \
code values for us&lt;br&gt;                                                                \
^&lt;br&gt;unable to parse docs/manpages/&lt;a \
href="http://virkeycode-usb.html.in"&gt;virkeycode-usb.html.in&lt;/a&gt;&lt;br&gt;[3/12] Generating \
virkeycode-atset1.html with a meson_exe.py custom command&lt;br&gt;FAILED: \
docs/manpages/virkeycode-atset1.html &lt;br&gt;/home/sjt/.local/bin/meson --internal exe \
--capture docs/manpages/virkeycode-atset1.html -- /usr/bin/xsltproc --stringparam \
pagesrc docs/manpages/virkeycode-atset1.rst --stringparam builddir \
/home/sjt/src/c/libvirt/build --stringparam timestamp 'Thu Jun   3 23:11:25 2021 \
UTC' --nonet ../docs/subsite.xsl docs/manpages/&lt;a \
href="http://virkeycode-atset1.html.in"&gt;virkeycode-atset1.html.in&lt;/a&gt;&lt;br&gt;docs/manpages/&lt;a \
href="http://virkeycode-atset1.html.in:17"&gt;virkeycode-atset1.html.in:17&lt;/a&gt;: parser \
error : Double hyphen within comment: &lt;!-- This file is auto-generated from \
keymaps.csv&lt;br&gt;Data&lt;br&gt;   keymap-gen --lang=rst --title=virkeycode-atset1 \
--subtitle=Key code values for&lt;br&gt;                    ^&lt;br&gt;docs/manpages/&lt;a \
href="http://virkeycode-atset1.html.in:17"&gt;virkeycode-atset1.html.in:17&lt;/a&gt;: parser \
error : Double hyphen within comment: &lt;!-- This file is auto-generated from \
keymaps.csv&lt;br&gt;Data&lt;br&gt;   keymap-gen --lang=rst --title=virkeycode-atset1 \
--subtitle=Key code values for&lt;br&gt;                                    \
^&lt;br&gt;docs/manpages/&lt;a \
href="http://virkeycode-atset1.html.in:17"&gt;virkeycode-atset1.html.in:17&lt;/a&gt;: parser \
error : Double hyphen within comment: &lt;!-- This file is auto-generated from \
keymaps.csv&lt;br&gt;Data&lt;br&gt;   keymap-gen --lang=rst --title=virkeycode-atset1 \
--subtitle=Key code values for&lt;br&gt;                                                    \
^&lt;br&gt;unable to parse docs/manpages/&lt;a \
href="http://virkeycode-atset1.html.in"&gt;virkeycode-atset1.html.in&lt;/a&gt;&lt;br&gt;[4/12] \
Generating virkeycode-xtkbd.html with a meson_exe.py custom command&lt;br&gt;FAILED: \
docs/manpages/virkeycode-xtkbd.html &lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;any advice on how to fix \
it? thank you very much&lt;/div&gt;-- &lt;br&gt;&lt;div dir="ltr" class="gmail_signature" \
data-smartmail="gmail_signature"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;div&gt;Best \
Regards,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Jiatong Shen&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210603192402</emailId><senderName>"Dr. David Alan Gilbert"</senderName><senderEmail>dgilbert@redhat.com</senderEmail><timestampReceived>2021-06-03 19:24:02-0400</timestampReceived><subject>Re: [Virtio-fs] virtiofs mounted filesystems &amp; SELinux</subject><body>

* Link Dupont (link@sub-pop.net) wrote:
&gt; Adding the &lt;binary xattr='on'&gt; element to the &lt;filesystem&gt; device does seem
&gt; to spawn virtiofsd with the option string "source=/home,xattr". My guest can
&gt; no longer mount the device though.
&gt; 
&gt; It errors with:
&gt; 
&gt; [ 170.225553] 9pnet_virtio: no channels available
&gt; mount: mount(2) failed: No such file or directory
&gt; 
&gt; I think what this is doing is causing libvirt to create the device as a
&gt; virtiofs device instead of a 9p device. The EL7 kernel doesn't have a
&gt; virtiofs driver, so it can't mount virtiofs devices.
&gt; 
&gt; My knowledge is unfortunately limited about the nuances between 9p and
&gt; virtiofs. So I'm mostly experimenting by trial-and-error here.

They're almost entirely different implementations; if you have a
virtiofsd then you're running virtiofs, not 9p, and yes RHEL7 won't like
that.

(I'm not sure el7 had 9p either??)

Dave


&gt; On Wed, Jun 2 2021 at 03:55:40 PM -0500, Connor Kuehl &lt;ckuehl@redhat.com&gt;
&gt; wrote:
&gt; &gt; On 5/21/21 11:59 AM, Link Dupont wrote:
&gt; &gt; 
&gt; &gt; Adding the virtio-fs mailing list.
&gt; &gt; 
&gt; &gt; &gt;  I am mounting a filesystem into a domain using the virtiofs driver.
&gt; &gt; &gt; 
&gt; &gt; &gt;  &lt;filesystem accessmode="passthrough" type="mount"&gt;
&gt; &gt; &gt;        &lt;source dir="/home"/&gt;
&gt; &gt; &gt;        &lt;target dir="/home"/&gt;
&gt; &gt; &gt;        &lt;driver type="virtiofs"/&gt;
&gt; &gt; &gt;  &lt;/filesystem&gt;
&gt; &gt; &gt; 
&gt; &gt; &gt;  Both my host (Fedora 34) and guest (CentOS 8.4) are running with
&gt; &gt; &gt; SELinux
&gt; &gt; &gt;  enforcing. From my host, I can see that the SELinux context type is
&gt; &gt; &gt; set to
&gt; &gt; &gt;  user_home_dir_t.
&gt; &gt; &gt; 
&gt; &gt; &gt;  $ ls -ldZ /home/link
&gt; &gt; &gt;  drwxr-xr-x. 61 link link system_u:object_r:user_home_dir_t:s0 8192
&gt; &gt; &gt; May 21
&gt; &gt; &gt;  12:41 /home/link
&gt; &gt; &gt; 
&gt; &gt; &gt; &gt; From within the guest however, the volume is unlabeled_t
&gt; &gt; &gt; 
&gt; &gt; &gt;  $ ls -lZd /home/link
&gt; &gt; &gt;  drwxr-xr-x. 61 link link system_u:object_r:unlabeled_t:s0 8192 May
&gt; &gt; &gt; 21 12:53 /
&gt; &gt; &gt;  home/link
&gt; &gt; &gt; 
&gt; &gt; &gt;  Is there a way to pass the SELinux context through to the guest? Or
&gt; &gt; &gt; mount the
&gt; &gt; &gt;  volume with the correct options to map SELinux contexts?
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; Hi,
&gt; &gt; 
&gt; &gt; I'm afraid I actually don't know that much about SELinux but I read
&gt; &gt; that it relies on using extended attributes in the file system to
&gt; &gt; accomplish its labeling.
&gt; &gt; 
&gt; &gt; Do you still experience this issue when you enable extended attribute
&gt; &gt; support[1] in virtiofsd? The example in the optional parameters snippet
&gt; &gt; enables extended attributes with the xattr='on' element.
&gt; &gt; 
&gt; &gt; Connor
&gt; &gt; 
&gt; &gt; [1] https://libvirt.org/kbase/virtiofs.html#optional-parameters
&gt; &gt; 
&gt; 
&gt; 
&gt; _______________________________________________
&gt; Virtio-fs mailing list
&gt; Virtio-fs@redhat.com
&gt; https://listman.redhat.com/mailman/listinfo/virtio-fs
-- 
Dr. David Alan Gilbert / dgilbert@redhat.com / Manchester, UK

</body></email><email><emailId>20210610093743</emailId><senderName>"tommy"</senderName><senderEmail>sz_cuitao@163.com</senderEmail><timestampReceived>2021-06-10 09:37:43-0400</timestampReceived><subject>why cannot connect to libvirtd using virsh ???</subject><body>

This is a multipart message in MIME format.

[root@test2 ~]# virsh -c quem+ssh://root@192.168.10.175/system

root@192.168.10.175's &lt;mailto:root@192.168.10.175's&gt;  password:

error: failed to connect to the hypervisor

error: no connection driver available for quem:///system

 

But, on the same terminal using virt-manager to connect to 192.168.10.175 is
successful.

 

Why ?

 

 

 

 


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;&lt;head&gt;&lt;META HTTP-EQUIV="Content-Type" \
CONTENT="text/html; charset=us-ascii"&gt;&lt;meta name=Generator content="Microsoft Word 15 \
(filtered medium)"&gt;&lt;style&gt;&lt;!-- /* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:\7B49\7EBF;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"\@\7B49\7EBF";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:\7B49\7EBF;}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:#0563C1;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:\7B49\7EBF;
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;
	font-family:\7B49\7EBF;}
/* Page Definitions */
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;}
div.WordSection1
	{page:WordSection1;}
--&gt;&lt;/style&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapelayout v:ext="edit"&gt;
&lt;o:idmap v:ext="edit" data="1" /&gt;
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;&lt;/head&gt;&lt;body lang=ZH-CN link="#0563C1" \
vlink="#954F72" style='word-wrap:break-word;text-justify-trim:punctuation'&gt;&lt;div \
class=WordSection1&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;[root@test2 ~]# virsh -c \
quem+ssh://root@192.168.10.175/system&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;a href="mailto:root@192.168.10.175's"&gt;root@192.168.10.175's&lt;/a&gt; \
password:&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;error: failed to \
connect to the hypervisor&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;error: no connection driver available for \
quem:///system&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;But, on \
the same terminal using virt-manager to connect to 192.168.10.175 is \
successful.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;Why \
?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20210610075411</emailId><senderName>Priyanka Gupta</senderName><senderEmail>priygupt@gmail.com</senderEmail><timestampReceived>2021-06-10 07:54:11-0400</timestampReceived><subject>lxcContainerMountFSBind - Failed to bind mount directory</subject><body>

Hi Everyone,

I am looking to understand this piece of code and error.

2021-06-09 06:52:55.548+0000: 1: debug : lxcContainerMountAllFS:1612 :
Mounting all non-root filesystems

2021-06-09 06:52:55.548+0000: 1: debug : lxcContainerMountAllFS:1619 :
Mounting '/bootflash/SHARED-IOX' -&gt; '/bootflash/SHARED-IOX'

2021-06-09 06:52:55.548+0000: 1: debug : lxcContainerResolveSymlinks:630 :
Resolving '/bootflash/SHARED-IOX'

2021-06-09 06:52:55.548+0000: 1: debug : lxcContainerResolveSymlinks:646 :
Resolved '/bootflash/SHARED-IOX' to /bootflash/SHARED-IOX

2021-06-09 06:52:55.548+0000: 1: debug : lxcContainerMountFSBind:1176 :
src=/bootflash/SHARED-IOX dst=/bootflash/SHARED-IOX

2021-06-09 06:52:55.548+0000: 1: error : lxcContainerMountFSBind:1223 :
Failed to bind mount directory /.oldroot/bootflash/SHARED-IOX to
/bootflash/SHARED-IOX: No such file or directory


I am on Libvirt 5.5.0


Any pointers?


Thanks

Priyanka

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hi Everyone,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I am looking to understand this piece \
of code and error.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;





&lt;p class="gmail-p1" style="margin:0px;font-variant-numeric:normal;font-variant-east-as \
ian:normal;font-stretch:normal;font-size:14px;line-height:normal;font-family:Helvetica"&gt;2021-06-09 \
06:52:55.548+0000: 1: debug : lxcContainerMountAllFS:1612 : Mounting all non-root \
filesystems&lt;/p&gt; &lt;p class="gmail-p1" \
style="margin:0px;font-variant-numeric:normal;font-variant-east-asian:normal;font-stretch:normal;font-size:14px;line-height:normal;font-family:Helvetica"&gt;2021-06-09 \
06:52:55.548+0000: 1: debug : lxcContainerMountAllFS:1619 : Mounting \
'/bootflash/SHARED-IOX' -&gt; '/bootflash/SHARED-IOX'&lt;/p&gt; &lt;p \
class="gmail-p1" style="margin:0px;font-variant-numeric:normal;font-variant-east-asian \
:normal;font-stretch:normal;font-size:14px;line-height:normal;font-family:Helvetica"&gt;2021-06-09 \
06:52:55.548+0000: 1: debug : lxcContainerResolveSymlinks:630 : Resolving \
'/bootflash/SHARED-IOX'&lt;/p&gt; &lt;p class="gmail-p1" \
style="margin:0px;font-variant-numeric:normal;font-variant-east-asian:normal;font-stretch:normal;font-size:14px;line-height:normal;font-family:Helvetica"&gt;2021-06-09 \
06:52:55.548+0000: 1: debug : lxcContainerResolveSymlinks:646 : Resolved \
'/bootflash/SHARED-IOX' to /bootflash/SHARED-IOX&lt;/p&gt; &lt;p class="gmail-p1" \
style="margin:0px;font-variant-numeric:normal;font-variant-east-asian:normal;font-stretch:normal;font-size:14px;line-height:normal;font-family:Helvetica"&gt;2021-06-09 \
06:52:55.548+0000: 1: debug : lxcContainerMountFSBind:1176 : \
src=/bootflash/SHARED-IOX dst=/bootflash/SHARED-IOX&lt;/p&gt; &lt;p class="gmail-p1" \
style="margin:0px;font-variant-numeric:normal;font-variant-east-asian:normal;font-stretch:normal;font-size:14px;line-height:normal;font-family:Helvetica"&gt;2021-06-09 \
06:52:55.548+0000: 1: error : lxcContainerMountFSBind:1223 : Failed to bind mount \
directory /.oldroot/bootflash/SHARED-IOX to /bootflash/SHARED-IOX: No such file or \
directory&lt;/p&gt;&lt;p class="gmail-p1" \
style="margin:0px;font-variant-numeric:normal;font-variant-east-asian:normal;font-stretch:normal;font-size:14px;line-height:normal;font-family:Helvetica"&gt;&lt;br&gt;&lt;/p&gt;&lt;p \
class="gmail-p1" style="margin:0px;font-variant-numeric:normal;font-variant-east-asian \
:normal;font-stretch:normal;font-size:14px;line-height:normal;font-family:Helvetica"&gt;I \
am on Libvirt 5.5.0&lt;/p&gt;&lt;p class="gmail-p1" \
style="margin:0px;font-variant-numeric:normal;font-variant-east-asian:normal;font-stretch:normal;font-size:14px;line-height:normal;font-family:Helvetica"&gt;&lt;br&gt;&lt;/p&gt;&lt;p \
class="gmail-p1" style="margin:0px;font-variant-numeric:normal;font-variant-east-asian \
:normal;font-stretch:normal;font-size:14px;line-height:normal;font-family:Helvetica"&gt;Any \
pointers?  &lt;br&gt;&lt;/p&gt;&lt;p class="gmail-p1" \
style="margin:0px;font-variant-numeric:normal;font-variant-east-asian:normal;font-stretch:normal;font-size:14px;line-height:normal;font-family:Helvetica"&gt;&lt;br&gt;&lt;/p&gt;&lt;p \
class="gmail-p1" style="margin:0px;font-variant-numeric:normal;font-variant-east-asian \
:normal;font-stretch:normal;font-size:14px;line-height:normal;font-family:Helvetica"&gt;Thanks&lt;/p&gt;&lt;p \
class="gmail-p1" style="margin:0px;font-variant-numeric:normal;font-variant-east-asian \
:normal;font-stretch:normal;font-size:14px;line-height:normal;font-family:Helvetica"&gt;Priyanka&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;




</body></email><email><emailId>20210611000259</emailId><senderName>Jiatong Shen</senderName><senderEmail>yshxxsjt715@gmail.com</senderEmail><timestampReceived>2021-06-11 00:02:59-0400</timestampReceived><subject>interface qos conflicts with ovs</subject><body>

Hello community,

We found a strange situation where interface qos is being cleared up. After
some search, looks like ovs will clear tc setting at least on ingress.

related code is
https://github.com/openvswitch/ovs/blob/91cb55bc8aad7fe17060778482dc7ad18dc0d9a8/lib/netdev-linux.c#L2727

so I would like to know if it is more ideal to set ovs port qos and replace
current tc when ovs port is used? thank you

-- 

Best Regards,

Jiatong Shen

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hello community,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;We found a strange situation where \
interface qos is being cleared up. After some search, looks like ovs will clear tc \
setting at least on ingress.  &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;related code is   &lt;a \
href="https://github.com/openvswitch/ovs/blob/91cb55bc8aad7fe17060778482dc7ad18dc0d9a8 \
/lib/netdev-linux.c#L2727"&gt;https://github.com/openvswitch/ovs/blob/91cb55bc8aad7fe17060778482dc7ad18dc0d9a8/lib/netdev-linux.c#L2727&lt;/a&gt;&lt;br \
clear="all"&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;so I would like to know if it is more ideal to set \
ovs port qos and replace current tc when ovs port is used? thank \
you&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- &lt;br&gt;&lt;div dir="ltr" class="gmail_signature" \
data-smartmail="gmail_signature"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;div&gt;Best \
Regards,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Jiatong Shen&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210614061432</emailId><senderName>����</senderName><senderEmail>chong.wu.xiangfan@gmail.com</senderEmail><timestampReceived>2021-06-14 06:14:32-0400</timestampReceived><subject>the SSL cert of libvirt.org is outdated</subject><body>

hi, there,

the SSL cert of libvirt.org is outdated, could anyone replace it as new one?

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;hi, there,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;the SSL cert of &lt;a \
href="http://libvirt.org"&gt;libvirt.org&lt;/a&gt; is outdated, could anyone replace it as new \
one?&lt;br&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210611232217</emailId><senderName>Eduardo_Lúcio_Amorim_Costa</senderName><senderEmail>eduardolucioac@gmail.com</senderEmail><timestampReceived>2021-06-11 23:22:17-0400</timestampReceived><subject>KVM Virtual Machine Network - Guest-guest/VM-VM only network (no host/hypervisor access, no outbound</subject><body>

I know that with the *virsh* command I can create several types of networks
(a "NAT network", for example) as we can see in these URLs...

KVM network management &lt;https://programmersought.com/article/52213715009/&gt;
KVM default NAT-based networking
&lt;https://www.ibm.com/downloads/cas/ZVJGQX8E&gt; (page 33)

*QUESTION:* How can I create a network (*lan_n*) where only guests/VMs have
connectivity, with no outbound connectivity and no host/hypervisor
connectivity?

*NOTE:* The connectivity to other resources will be provided by a
*pfSense* firewall
server that will have access to another network (*wan_n*) with outbound
connectivity and other resources.

Network layout...

                [N]wan_n
                 ↕
                [I]wan_n
            [V]pfsense_vm
                [I]lan_n
                 ↕
                [N]lan_n
                 ↕
   .............................
   ↕             ↕             ↕
  [V]some_vm_0  [V]some_vm_1  [V]some_vm_4
                [V]some_vm_2  [V]some_vm_5
                [V]some_vm_3

 _ [N] - Network;
 _ [I] - Network Interface;
 _ [V] - Virtual Machine.

*Thanks! =D*


*ORIGINAL QUESTION: *https://serverfault.com/q/1066478/276753
&lt;https://programmersought.com/article/52213715009/&gt;

-- 

*Eduardo Lúcio*

Tecnologia, Desenvolvimento e Software Livre

LightBase Consultoria em Software Público

eduardo.lucio@lightbase.com.br &lt;eduardo.lucio@LightBase.com.br&gt;

*+55-61-3347-1949* - http://brlight.org &lt;eduardo.lucio@LightBase.com.br&gt; -
*Brasil-DF*


*Software livre! Abrace essa idéia!*

*"Aqueles que negam liberdade aos outros não a merecem para si mesmos."*

*Abraham Lincoln*

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;p style="margin-top:0px;margin-right:0px;margin-left:0px;padding:0px;b \
order:0px;font-variant-numeric:inherit;font-variant-east-asian:inherit;font-stretch:in \
herit;line-height:inherit;font-family:-apple-system,BlinkMacSystemFont,"Segoe \
UI","Liberation \
Sans",sans-serif;font-size:15px;vertical-align:baseline;box-sizing:inherit;clear:both;color:rgb(36,39,41)"&gt;I \
know that with the  &lt;strong \
style="margin:0px;padding:0px;border:0px;font-style:inherit;font-variant:inherit;font- \
stretch:inherit;line-height:inherit;font-family:inherit;vertical-align:baseline;box-sizing:inherit"&gt;virsh&lt;/strong&gt; \
command I can create several types of networks (a "NAT network", for \
example) as we can see in these URLs...&lt;/p&gt;&lt;p \
style="margin-top:0px;margin-right:0px;margin-left:0px;padding:0px;border:0px;font-var \
iant-numeric:inherit;font-variant-east-asian:inherit;font-stretch:inherit;line-height:inherit;font-family:-apple-system,BlinkMacSystemFont,"Segoe \
UI","Liberation \
Sans",sans-serif;font-size:15px;vertical-align:baseline;box-sizing:inherit;clear:both;color:rgb(36,39,41)"&gt;&lt;a \
href="https://programmersought.com/article/52213715009/" rel="nofollow noreferrer" \
style="margin:0px;padding:0px;border:0px;font-style:inherit;font-variant:inherit;font- \
weight:inherit;font-stretch:inherit;line-height:inherit;font-family:inherit;vertical-align:baseline;box-sizing:inherit"&gt;KVM \
network management&lt;/a&gt;&lt;br style="box-sizing:inherit"&gt;&lt;a \
href="https://www.ibm.com/downloads/cas/ZVJGQX8E" rel="nofollow noreferrer" \
style="margin:0px;padding:0px;border:0px;font-style:inherit;font-variant:inherit;font- \
weight:inherit;font-stretch:inherit;line-height:inherit;font-family:inherit;vertical-align:baseline;box-sizing:inherit"&gt;KVM \
default NAT-based networking&lt;/a&gt;  (page 33)&lt;/p&gt;&lt;p \
style="margin-top:0px;margin-right:0px;margin-left:0px;padding:0px;border:0px;font-var \
iant-numeric:inherit;font-variant-east-asian:inherit;font-stretch:inherit;line-height:inherit;font-family:-apple-system,BlinkMacSystemFont,"Segoe \
UI","Liberation \
Sans",sans-serif;font-size:15px;vertical-align:baseline;box-sizing:inherit;clear:both;color:rgb(36,39,41)"&gt;&lt;strong \
style="margin:0px;padding:0px;border:0px;font-style:inherit;font-variant:inherit;font- \
stretch:inherit;line-height:inherit;font-family:inherit;vertical-align:baseline;box-sizing:inherit"&gt;QUESTION:&lt;/strong&gt; \
How can I create a network (&lt;strong \
style="margin:0px;padding:0px;border:0px;font-style:inherit;font-variant:inherit;font- \
stretch:inherit;line-height:inherit;font-family:inherit;vertical-align:baseline;box-sizing:inherit"&gt;lan_n&lt;/strong&gt;) \
where only guests/VMs have connectivity, with no outbound connectivity and no \
host/hypervisor connectivity?&lt;/p&gt;&lt;p \
style="margin-top:0px;margin-right:0px;margin-left:0px;padding:0px;border:0px;font-var \
iant-numeric:inherit;font-variant-east-asian:inherit;font-stretch:inherit;line-height:inherit;font-family:-apple-system,BlinkMacSystemFont,"Segoe \
UI","Liberation \
Sans",sans-serif;font-size:15px;vertical-align:baseline;box-sizing:inherit;clear:both;color:rgb(36,39,41)"&gt;&lt;strong \
style="margin:0px;padding:0px;border:0px;font-style:inherit;font-variant:inherit;font- \
stretch:inherit;line-height:inherit;font-family:inherit;vertical-align:baseline;box-sizing:inherit"&gt;NOTE:&lt;/strong&gt; \
The connectivity to other resources will be provided by a  &lt;strong \
style="margin:0px;padding:0px;border:0px;font-style:inherit;font-variant:inherit;font- \
stretch:inherit;line-height:inherit;font-family:inherit;vertical-align:baseline;box-sizing:inherit"&gt;pfSense&lt;/strong&gt; \
firewall server that will have access to another network (&lt;strong \
style="margin:0px;padding:0px;border:0px;font-style:inherit;font-variant:inherit;font- \
stretch:inherit;line-height:inherit;font-family:inherit;vertical-align:baseline;box-sizing:inherit"&gt;wan_n&lt;/strong&gt;) \
with outbound connectivity and other resources.&lt;/p&gt;&lt;pre \
style="margin-top:0px;padding:12px;border:0px;font-variant-numeric:inherit;font-varian \
t-east-asian:inherit;font-stretch:inherit;line-height:1.30769;font-size:13px;vertical- \
align:baseline;box-sizing:inherit;width:auto;max-height:600px;overflow:auto;border-radius:5px"&gt;&lt;code \
style="margin:0px;padding:0px;border:0px;font-style:inherit;font-variant:inherit;font- \
weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;box-si \
zing:inherit;background-color:transparent;white-space:inherit;border-radius:0px"&gt;Network \
layout...

                [N]wan_n
                 ↕
                [I]wan_n
            [V]pfsense_vm
                [I]lan_n
                 ↕
                [N]lan_n
                 ↕
   .............................
   ↕             ↕             ↕
  [V]some_vm_0  [V]some_vm_1  [V]some_vm_4
                [V]some_vm_2  [V]some_vm_5
                [V]some_vm_3

 _ [N] - Network;
 _ [I] - Network Interface;
 _ [V] - Virtual Machine.
&lt;/code&gt;&lt;/pre&gt;&lt;p style="margin:0px;padding:0px;border:0px;font-variant-numeric:inherit; \
font-variant-east-asian:inherit;font-stretch:inherit;line-height:inherit;font-family:-apple-system,BlinkMacSystemFont,"Segoe \
UI","Liberation \
Sans",sans-serif;font-size:15px;vertical-align:baseline;box-sizing:inherit;clear:both;color:rgb(36,39,41)"&gt;&lt;strong \
style="margin:0px;padding:0px;border:0px;font-style:inherit;font-variant:inherit;font- \
stretch:inherit;line-height:inherit;font-family:inherit;vertical-align:baseline;box-sizing:inherit"&gt;Thanks! \
=D&lt;/strong&gt;&lt;/p&gt;&lt;p style="margin:0px;padding:0px;border:0px;font-variant-numeric:inheri \
t;font-variant-east-asian:inherit;font-stretch:inherit;line-height:inherit;font-family:-apple-system,BlinkMacSystemFont,"Segoe \
UI","Liberation \
Sans",sans-serif;font-size:15px;vertical-align:baseline;box-sizing:inherit;clear:both;color:rgb(36,39,41)"&gt;&lt;strong \
style="font-family:inherit;font-style:inherit;font-variant:inherit;margin:0px;padding: \
0px;border:0px;font-stretch:inherit;line-height:inherit;vertical-align:baseline;box-sizing:inherit"&gt;&lt;br&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p \
style="margin:0px;padding:0px;border:0px;font-variant-numeric:inherit;font-variant-eas \
t-asian:inherit;font-stretch:inherit;line-height:inherit;font-family:-apple-system,BlinkMacSystemFont,"Segoe \
UI","Liberation \
Sans",sans-serif;font-size:15px;vertical-align:baseline;box-sizing:inherit;clear:both;color:rgb(36,39,41)"&gt;&lt;strong \
style="font-family:inherit;font-style:inherit;font-variant:inherit;margin:0px;padding: \
0px;border:0px;font-stretch:inherit;line-height:inherit;vertical-align:baseline;box-sizing:inherit"&gt;ORIGINAL \
QUESTION:  &lt;/strong&gt;&lt;a href="https://programmersought.com/article/52213715009/" \
rel="nofollow noreferrer" \
style="font-family:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit \
;margin:0px;padding:0px;border:0px;font-stretch:inherit;line-height:inherit;vertical-a \
lign:baseline;box-sizing:inherit"&gt;https://serverfault.com/q/1066478/276753&lt;/a&gt;&lt;/p&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- \
&lt;br&gt;&lt;div dir="ltr" class="gmail_signature" data-smartmail="gmail_signature"&gt;&lt;div \
dir="ltr"&gt;&lt;div dir="ltr"&gt;&lt;div dir="ltr"&gt;&lt;div dir="ltr"&gt;&lt;div dir="ltr"&gt;&lt;div \
dir="ltr"&gt;&lt;div dir="ltr"&gt;&lt;p \
style="margin-bottom:0in;line-height:1px;background:transparent;color:rgb(0,0,0);font-size:medium"&gt;&lt;font \
color="#2a6099"&gt;&lt;font face="Tahoma"&gt;&lt;font style="font-size:14pt"&gt;&lt;b&gt;Eduardo \
Lúcio&lt;/b&gt;&lt;/font&gt;&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;&lt;p \
style="margin-bottom:0in;line-height:1px;background:transparent;color:rgb(0,0,0);font-size:medium"&gt;&lt;font \
color="#2a6099"&gt;&lt;font face="Tahoma"&gt;&lt;font style="font-size:9pt"&gt;Tecnologia, \
Desenvolvimento e Software Livre&lt;/font&gt;&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;&lt;p \
style="margin-bottom:0in;line-height:1px;background:transparent;color:rgb(0,0,0);font-size:medium"&gt;&lt;font \
color="#2a6099"&gt;&lt;font face="Tahoma"&gt;&lt;font style="font-size:10pt"&gt;LightBase \
Consultoria em Software Público&lt;/font&gt;&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;&lt;p \
style="margin-bottom:0in;line-height:1px;background:transparent;color:rgb(0,0,0);font-size:medium"&gt;&lt;a \
href="mailto:eduardo.lucio@LightBase.com.br" style="color:rgb(0,0,128)" \
target="_blank"&gt;&lt;span&gt;&lt;font color="#1155cc"&gt;&lt;font face="Tahoma"&gt;&lt;font \
style="font-size:10pt"&gt;eduardo.lucio@lightbase.com.br&lt;/font&gt;&lt;/font&gt;&lt;/font&gt;&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;p \
style="margin-bottom:0in;line-height:1px;background:transparent;color:rgb(0,0,0);font-size:medium"&gt;&lt;font \
color="#000000"&gt;&lt;font face="Tahoma"&gt;&lt;font style="font-size:10pt"&gt;&lt;font \
color="#2a6099"&gt;&lt;b&gt;+55-61-3347-1949&lt;/b&gt;&lt;/font&gt;&lt;font color="#2a6099"&gt; - &lt;/font&gt;&lt;a \
href="mailto:eduardo.lucio@LightBase.com.br" style="color:rgb(0,0,128)" \
target="_blank"&gt;&lt;font color="#1155cc"&gt;http://brlight.org&lt;/font&gt;&lt;/a&gt;&lt;font \
color="#2a6099"&gt; - &lt;/font&gt;&lt;font \
color="#2a6099"&gt;&lt;b&gt;Brasil-DF&lt;/b&gt;&lt;/font&gt;&lt;/font&gt;&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;&lt;p \
style="margin-bottom:0in;line-height:1px;background:transparent;color:rgb(0,0,0);font-size:medium"&gt;&lt;img \
src="https://drive.google.com/uc?id=1rsDoByN4ocWOsgsibakrWO9W-sGYxN2w&amp;export=download" \
width="200" height="31"&gt;&lt;br&gt;&lt;/p&gt;&lt;p \
style="margin-bottom:0in;line-height:1px;background:transparent;color:rgb(0,0,0);font-size:medium"&gt;&lt;i \
style="font-size:10pt;font-family:Tahoma;color:rgb(42,96,153);background-color:transparent"&gt;Software \
livre! Abrace essa idéia!&lt;/i&gt;&lt;font face="Tahoma"&gt;&lt;font \
style="font-size:10pt"&gt;&lt;i&gt;&lt;b&gt;&lt;img \
src="https://drive.google.com/uc?id=1P6nZIIa-z0KsldX7xTSkIJgJy7ntBTXR&amp;export=download"&gt;&lt;/b&gt;&lt;/i&gt;&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;&lt;p \
style="margin-bottom:0in;line-height:1px;background:transparent;color:rgb(0,0,0);font-size:medium"&gt;&lt;font \
color="#2a6099"&gt;&lt;font face="Tahoma"&gt;&lt;font style="font-size:10pt"&gt;&lt;i&gt;"Aqueles que \
negam liberdade aos outros não a merecem para si \
mesmos."&lt;/i&gt;&lt;/font&gt;&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;&lt;p \
style="margin-bottom:0in;line-height:1px;background:transparent;color:rgb(0,0,0);font-size:medium"&gt;&lt;font \
color="#2a6099"&gt;&lt;font face="Tahoma"&gt;&lt;font style="font-size:8pt"&gt;&lt;i&gt;Abraham \
Lincoln&lt;/i&gt;&lt;/font&gt;&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;




</body></email><email><emailId>20210620091040</emailId><senderName>Jiatong Shen</senderName><senderEmail>yshxxsjt715@gmail.com</senderEmail><timestampReceived>2021-06-20 09:10:40-0400</timestampReceived><subject>driver_remote option defaults to auto</subject><body>

Hello community,

I am looking at building and packaging libvirt source code. I am seeing
from commit
https://github.com/libvirt/libvirt/commit/83ff55b5a2618d32f623d7ca0b6f9c28b7253972
`driver_remote` is defaulting to auto which is different from enabled
before. I am curious what does auto mean? does it mean that meson will take
over and determine if driver_remote should be enabled or we have to write
more logic in meson.build? currently it seems there is no effort to auto
determine driver_remote. I think it is interesting because
https://github.com/libvirt/libvirt/blob/54b602019d7dfa94a6c52ef7aa3abdfaa93ed233/meson.build#L1178
sasl seems required remote_driver to have a value of enabled...

-- 

Best Regards,

Jiatong Shen

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hello community,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I am looking at building and \
packaging libvirt source code. I am seeing from commit  &lt;a \
href="https://github.com/libvirt/libvirt/commit/83ff55b5a2618d32f623d7ca0b6f9c28b72539 \
72"&gt;https://github.com/libvirt/libvirt/commit/83ff55b5a2618d32f623d7ca0b6f9c28b7253972&lt;/a&gt; \
`driver_remote` is defaulting to auto which is different from enabled before. I am \
curious what does auto mean? does it mean that meson will take over and determine if \
driver_remote should  be enabled  or we have to write more logic in meson.build? \
currently it seems there is no effort to auto determine driver_remote. I think it is \
interesting because  &lt;a \
href="https://github.com/libvirt/libvirt/blob/54b602019d7dfa94a6c52ef7aa3abdfaa93ed233 \
/meson.build#L1178"&gt;https://github.com/libvirt/libvirt/blob/54b602019d7dfa94a6c52ef7aa3abdfaa93ed233/meson.build#L1178&lt;/a&gt; \
sasl seems required remote_driver to have a value of \
enabled...&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- &lt;br&gt;&lt;div dir="ltr" class="gmail_signature" \
data-smartmail="gmail_signature"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;div&gt;Best \
Regards,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Jiatong Shen&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210622162912</emailId><senderName>Priyanka Gupta</senderName><senderEmail>priygupt@gmail.com</senderEmail><timestampReceived>2021-06-22 16:29:12-0400</timestampReceived><subject>unaccessible directory in lxcContainerResolveSymlinks</subject><body>

Hi,

Could someone pls let me know when this condition could possibly arise?
lxcContainerResolveSymlinks:621 : Skipped unaccessible '/flash/dir'

The code seems to call access('/flash/dir', F_OK) which shall only check
for existence of this directory '/flash/dir'. I have this directory created
on my host. Is there anything that I am missing?

Thanks
Priyanka

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Could someone pls let me know when this \
condition could possibly arise?&lt;/div&gt;&lt;div&gt;&lt;span \
style="font-family:Helvetica;font-size:14px"&gt;lxcContainerResolveSymlinks:621 : \
Skipped &lt;/span&gt;unaccessible&lt;span style="font-family:Helvetica;font-size:14px"&gt;  \
'/flash/dir'&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="font-family:Helvetica;font-size:14px"&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="font-family:Helvetica;font-size:14px"&gt;The code seems to call \
access(&lt;/span&gt;'/flash/dir', F_OK) which shall only check for existence  of \
this directory  '/flash/dir'.  &lt;span \
style="font-family:Helvetica;font-size:14px"&gt;I have this directory created on my \
host. Is there anything that I am missing?&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="font-family:Helvetica;font-size:14px"&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="font-family:Helvetica;font-size:14px"&gt;Thanks&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="font-family:Helvetica;font-size:14px"&gt;Priyanka&lt;/span&gt;&lt;/div&gt;





&lt;/div&gt;



</body></email><email><emailId>20210617085242</emailId><senderName></senderName><senderEmail>jesonliang040705@hotmail.com</senderEmail><timestampReceived>2021-06-17 08:52:42-0400</timestampReceived><subject>Libvirt hit a issue when do VM migration</subject><body>

Hi All,

Who can give me a help? I hit another issue when do vm migration?  Libvirt throw out \
the error like below

"libvirt: Domain Config error : unsupported configuration: vcpu enable order of vCPU \
'0' differs between source and destination definitions¡±

 
The cup information is defined VM domain on source host is like: 
&lt;vcpu placement='static'&gt;2&lt;/vcpu&gt;
  &lt;vcpus&gt;
    &lt;vcpu id='0' enabled='yes' hotpluggable='no' order='1'/&gt;
    &lt;vcpu id='1' enabled='yes' hotpluggable='no' order='2'/&gt;
  &lt;/vcpus&gt;
  &lt;cputune&gt;
    &lt;vcpupin vcpu='0' cpuset='42'/&gt;
    &lt;vcpupin vcpu='1' cpuset='43'/&gt;
  &lt;/cputune&gt;

The distinction host previews generate xml for VM like:

&lt;vcpu placement='static'&gt;2&lt;/vcpu&gt;
  &lt;vcpus&gt;
    &lt;vcpu id='0' enabled='yes' hotpluggable='no' order='1'/&gt;
    &lt;vcpu id='1' enabled='yes' hotpluggable='no' order='2'/&gt;
  &lt;/vcpus&gt;
  &lt;cputune&gt;
    &lt;vcpupin vcpu='0' cpuset='42'/&gt;
    &lt;vcpupin vcpu='1' cpuset='43'/&gt;
  &lt;/cputune&gt;

What¡¯t wrong with it? Or I missing some actions in configurations regarding the \
migration

Thanks a lot !


</body></email><email><emailId>20210623164912</emailId><senderName>Riccardo Ravaioli</senderName><senderEmail>riccardoravaioli@gmail.com</senderEmail><timestampReceived>2021-06-23 16:49:12-0400</timestampReceived><subject>issue when not using acpi indices in libvirt 7.4.0 and qemu 6.0.0</subject><body>

Hi everyone,

We have an issue with how network interfaces are presented in the VM with
the latest libvirt 7.4.0 and qemu 6.0.0.

Previously, we were on libvirt 7.0.0 and qemu 5.2.0, and we used increasing
virtual PCI addresses for any type of network interface (virtio, PCI
passthrough, SRIOV) in order to decide the interface order inside the VM.
For instance the following snippet yields ens1, ens2 and ens3 in a Debian
Buster VM:

  &lt;interface type="ethernet"&gt;
     &lt;target dev="0.vSrv"/&gt;
     &lt;mac address="52:54:00:aa:cc:05"/&gt;
     &lt;address bus="0x01" domain="0x0000" function="0x0" slot="0x01"
type="pci"/&gt;
     &lt;model type="virtio"/&gt;
     &lt;driver&gt;
        &lt;host csum="off"/&gt;
     &lt;/driver&gt;
  &lt;/interface&gt;
  &lt;interface type="ethernet"&gt;
     &lt;target dev="1.vSrv"/&gt;
     &lt;mac address="52:54:00:aa:bb:81"/&gt;
     &lt;address bus="0x01" domain="0x0000" function="0x0" slot="0x02"
type="pci"/&gt;
     &lt;model type="virtio"/&gt;
     &lt;driver&gt;
        &lt;host csum="off"/&gt;
     &lt;/driver&gt;
  &lt;/interface&gt;
  &lt;hostdev managed="yes" mode="subsystem" type="pci"&gt;
     &lt;source&gt;
        &lt;address bus="0x0d" domain="0x0000" function="0x0" slot="0x00"/&gt;
     &lt;/source&gt;
     &lt;address bus="0x01" domain="0x0000" function="0x0" slot="0x03"
type="pci"/&gt;
  &lt;/hostdev&gt;

After upgrading to libvirt 7.4.0 and qemu 6.0.0, the XML snippet above
yielded:
- ens1 for the first virtio interface =&gt; OK
- rename4 for the second virtio interface =&gt; **KO**
- ens3 for the PCI passthrough interface  =&gt; OK

Argh! What happened to ens2? By running udev inside the VM, I see that
"rename4" is the result of a conflict between the ID_NET_NAME_SLOT of the
second and the third interface, both appearing as ID_NET_NAME_SLOT=ens3. In
theory rename4 should show ID_NET_NAME_SLOT=ens2. What happened?

#  udevadm info -q all /sys/class/net/rename4
P: /devices/pci0000:00/0000:00:03.0/0000:01:02.0/virtio4/net/rename4
L: 0
E: DEVPATH=/devices/pci0000:00/0000:00:03.0/0000:01:02.0/virtio4/net/rename4
E: INTERFACE=rename4
E: IFINDEX=4
E: SUBSYSTEM=net
E: USEC_INITIALIZED=94191911
E: ID_NET_NAMING_SCHEME=v240
E: ID_NET_NAME_MAC=enx525400aabba1
E: ID_NET_NAME_PATH=enp1s2
E: ID_NET_NAME_SLOT=ens3
E: ID_BUS=pci
E: ID_VENDOR_ID=0x1af4
E: ID_MODEL_ID=0x1000
E: ID_PCI_CLASS_FROM_DATABASE=Network controller
E: ID_PCI_SUBCLASS_FROM_DATABASE=Ethernet controller
E: ID_VENDOR_FROM_DATABASE=Red Hat, Inc.
E: ID_MODEL_FROM_DATABASE=Virtio network device
E: ID_PATH=pci-0000:01:02.0
E: ID_PATH_TAG=pci-0000_01_02_0
E: ID_NET_DRIVER=virtio_net
E: ID_NET_LINK_FILE=/usr/lib/systemd/network/99-default.link
E: SYSTEMD_ALIAS=/sys/subsystem/net/devices/rename4
E: TAGS=:systemd:

#  udevadm info -q all /sys/class/net/ens3
P: /devices/pci0000:00/0000:00:03.0/0000:01:03.0/net/ens3
L: 0
E: DEVPATH=/devices/pci0000:00/0000:00:03.0/0000:01:03.0/net/ens3
E: INTERFACE=ens3
E: IFINDEX=2
E: SUBSYSTEM=net
E: USEC_INITIALIZED=3600940
E: ID_NET_NAMING_SCHEME=v240
E: ID_NET_NAME_MAC=enx00900b621235
E: ID_OUI_FROM_DATABASE=LANNER ELECTRONICS, INC.
E: ID_NET_NAME_PATH=enp1s3
E: ID_NET_NAME_SLOT=ens3
E: ID_BUS=pci
E: ID_VENDOR_ID=0x8086
E: ID_MODEL_ID=0x1533
E: ID_PCI_CLASS_FROM_DATABASE=Network controller
E: ID_PCI_SUBCLASS_FROM_DATABASE=Ethernet controller
E: ID_VENDOR_FROM_DATABASE=Intel Corporation
E: ID_MODEL_FROM_DATABASE=I210 Gigabit Network Connection
E: ID_PATH=pci-0000:01:03.0
E: ID_PATH_TAG=pci-0000_01_03_0
E: ID_NET_DRIVER=igb
E: ID_NET_LINK_FILE=/usr/lib/systemd/network/99-default.link
E: SYSTEMD_ALIAS=/sys/subsystem/net/devices/ens3
E: TAGS=:systemd:


Is there anything we can do in the XML definition of the VM to fix this?

The PCI tree from within the VM is the following, if it helps:
(with libvirt 7.0.0 and qemu 5.2.0 it was the same)

# lspci -tv
-[0000:00]-+-00.0  Intel Corporation 440FX - 82441FX PMC [Natoma]
           +-01.0  Intel Corporation 82371SB PIIX3 ISA [Natoma/Triton II]
           +-01.1  Intel Corporation 82371SB PIIX3 IDE [Natoma/Triton II]
           +-01.2  Intel Corporation 82371SB PIIX3 USB [Natoma/Triton II]
           +-01.3  Intel Corporation 82371AB/EB/MB PIIX4 ACPI
           +-02.0  Cirrus Logic GD 5446
           +-03.0-[01]--+-01.0  Red Hat, Inc. Virtio network device
           |            +-02.0  Red Hat, Inc. Virtio network device
           |            \-03.0  Intel Corporation I210 Gigabit Network
Connection
           +-04.0-[02]--
           +-05.0-[03]--
           +-06.0-[04]--
           +-07.0-[05]--
           +-08.0-[06]----01.0  Red Hat, Inc. Virtio block device
           +-09.0  Intel Corporation 82801IR/IO/IH (ICH9R/DO/DH) 6 port
SATA Controller [AHCI mode]
           +-0a.0  Red Hat, Inc. Virtio console
           +-0b.0  Red Hat, Inc. Virtio memory balloon
           \-0c.0  Red Hat, Inc. Virtio RNG


I see that a new feature in qemu and libvirt is to add ACPI indices in
order to have network interfaces appear as *onboard* and sort them through
this index as opposed to virtual PCI addresses. This is great. I see that
in this case, interfaces appear as eno1, eno2, etc.

However, for the sake of backward compatibility, is there a way to have the
previous behaviour where interfaces were called by their PCI slot number
(ens1, ens2, etc.)?

If I move to the new naming yielded by ACPI indices, I am mostly worried
about any possible change in interface names that might occur across VMs
running different OS's, with respect to what we had before with libvirt
7.0.0 and qemu 5.2.0.

Thanks!

Best,
Riccardo Ravaioli

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;p&gt;Hi everyone,&lt;br&gt;
  &lt;br&gt;
We have an issue with how network interfaces are presented in the VM with the latest \
libvirt 7.4.0 and qemu 6.0.0. &lt;br&gt;  
  &lt;br&gt;
Previously, we were on libvirt 7.0.0 and qemu 5.2.0, and we used 
increasing virtual PCI addresses for any type of network interface 
(virtio, PCI passthrough, SRIOV) in order to decide the interface order 
inside the VM. For instance the following snippet yields ens1, ens2 and 
ens3 in a Debian Buster VM:&lt;br&gt;
  &lt;br&gt;
   &lt;interface type="ethernet"&gt;&lt;br&gt;
         &lt;target dev="0.vSrv"/&gt;&lt;br&gt;
         &lt;mac address="52:54:00:aa:cc:05"/&gt;&lt;br&gt;
         &lt;address bus="0x01" domain="0x0000" \
function="0x0" slot="0x01" type="pci"/&gt;&lt;br&gt;  \
&lt;model type="virtio"/&gt;&lt;br&gt;  &lt;driver&gt;&lt;br&gt;
               &lt;host csum="off"/&gt;&lt;br&gt;
         &lt;/driver&gt;&lt;br&gt;
   &lt;/interface&gt;&lt;br&gt;
   &lt;interface type="ethernet"&gt;&lt;br&gt;
         &lt;target dev="1.vSrv"/&gt;&lt;br&gt;
         &lt;mac address="52:54:00:aa:bb:81"/&gt;&lt;br&gt;
         &lt;address bus="0x01" domain="0x0000" \
function="0x0" slot="0x02" type="pci"/&gt;&lt;br&gt;  \
&lt;model type="virtio"/&gt;&lt;br&gt;  &lt;driver&gt;&lt;br&gt;
               &lt;host csum="off"/&gt;&lt;br&gt;
         &lt;/driver&gt;&lt;br&gt;
   &lt;/interface&gt;&lt;br&gt;
   &lt;hostdev managed="yes" mode="subsystem" \
type="pci"&gt;&lt;br&gt;  &lt;source&gt;&lt;br&gt;
               &lt;address bus="0x0d" domain="0x0000" \
function="0x0" slot="0x00"/&gt;&lt;br&gt;  &lt;/source&gt;&lt;br&gt;
         &lt;address bus="0x01" domain="0x0000" \
function="0x0" slot="0x03" type="pci"/&gt;&lt;br&gt;  \
&lt;/hostdev&gt;&lt;br&gt;  &lt;br&gt;
After upgrading to libvirt 7.4.0 and qemu 6.0.0, the XML snippet above yielded:&lt;br&gt;
- ens1 for the first virtio interface =&gt; OK&lt;br&gt;
- rename4 for the second virtio interface =&gt; **KO**&lt;br&gt;
- ens3 for the PCI passthrough interface   =&gt; OK&lt;br&gt;
  &lt;br&gt;
Argh! What happened to ens2? By running udev inside the VM, I see that \
"rename4" is the  result of a conflict between the ID_NET_NAME_SLOT of the \
second and the  third interface, both appearing as ID_NET_NAME_SLOT=ens3. In theory 
rename4 should show ID_NET_NAME_SLOT=ens2. What happened?&lt;br&gt;
  &lt;br&gt;
#   udevadm info -q all /sys/class/net/rename4&lt;br&gt;
P: /devices/pci0000:00/0000:00:03.0/0000:01:02.0/virtio4/net/rename4&lt;br&gt;
L: 0&lt;br&gt;
E: DEVPATH=/devices/pci0000:00/0000:00:03.0/0000:01:02.0/virtio4/net/rename4&lt;br&gt;
E: INTERFACE=rename4&lt;br&gt;
E: IFINDEX=4&lt;br&gt;
E: SUBSYSTEM=net&lt;br&gt;
E: USEC_INITIALIZED=94191911&lt;br&gt;
E: ID_NET_NAMING_SCHEME=v240&lt;br&gt;
E: ID_NET_NAME_MAC=enx525400aabba1&lt;br&gt;
E: ID_NET_NAME_PATH=enp1s2&lt;br&gt;
E: ID_NET_NAME_SLOT=ens3&lt;br&gt;
E: ID_BUS=pci&lt;br&gt;
E: ID_VENDOR_ID=0x1af4&lt;br&gt;
E: ID_MODEL_ID=0x1000&lt;br&gt;
E: ID_PCI_CLASS_FROM_DATABASE=Network controller&lt;br&gt;
E: ID_PCI_SUBCLASS_FROM_DATABASE=Ethernet controller&lt;br&gt;
E: ID_VENDOR_FROM_DATABASE=Red Hat, Inc.&lt;br&gt;
E: ID_MODEL_FROM_DATABASE=Virtio network device&lt;br&gt;
E: ID_PATH=pci-0000:01:02.0&lt;br&gt;
E: ID_PATH_TAG=pci-0000_01_02_0&lt;br&gt;
E: ID_NET_DRIVER=virtio_net&lt;br&gt;
E: ID_NET_LINK_FILE=/usr/lib/systemd/network/99-default.link&lt;br&gt;
E: SYSTEMD_ALIAS=/sys/subsystem/net/devices/rename4&lt;br&gt;
E: TAGS=:systemd:&lt;br&gt;
  &lt;br&gt;
#   udevadm info -q all /sys/class/net/ens3&lt;br&gt;
P: /devices/pci0000:00/0000:00:03.0/0000:01:03.0/net/ens3&lt;br&gt;
L: 0&lt;br&gt;
E: DEVPATH=/devices/pci0000:00/0000:00:03.0/0000:01:03.0/net/ens3&lt;br&gt;
E: INTERFACE=ens3&lt;br&gt;
E: IFINDEX=2&lt;br&gt;
E: SUBSYSTEM=net&lt;br&gt;
E: USEC_INITIALIZED=3600940&lt;br&gt;
E: ID_NET_NAMING_SCHEME=v240&lt;br&gt;
E: ID_NET_NAME_MAC=enx00900b621235&lt;br&gt;
E: ID_OUI_FROM_DATABASE=LANNER ELECTRONICS, INC.&lt;br&gt;
E: ID_NET_NAME_PATH=enp1s3&lt;br&gt;
E: ID_NET_NAME_SLOT=ens3&lt;br&gt;
E: ID_BUS=pci&lt;br&gt;
E: ID_VENDOR_ID=0x8086&lt;br&gt;
E: ID_MODEL_ID=0x1533&lt;br&gt;
E: ID_PCI_CLASS_FROM_DATABASE=Network controller&lt;br&gt;
E: ID_PCI_SUBCLASS_FROM_DATABASE=Ethernet controller&lt;br&gt;
E: ID_VENDOR_FROM_DATABASE=Intel Corporation&lt;br&gt;
E: ID_MODEL_FROM_DATABASE=I210 Gigabit Network Connection&lt;br&gt;
E: ID_PATH=pci-0000:01:03.0&lt;br&gt;
E: ID_PATH_TAG=pci-0000_01_03_0&lt;br&gt;
E: ID_NET_DRIVER=igb&lt;br&gt;
E: ID_NET_LINK_FILE=/usr/lib/systemd/network/99-default.link&lt;br&gt;
E: SYSTEMD_ALIAS=/sys/subsystem/net/devices/ens3&lt;br&gt;
E: TAGS=:systemd:&lt;br&gt;
  &lt;br&gt;
  &lt;br&gt;
Is there anything we can do in the XML definition of the VM to fix this?&lt;br&gt;
  &lt;br&gt;
The PCI tree from within the VM is the following, if it helps:&lt;br&gt;
(with libvirt 7.0.0 and qemu 5.2.0 it was the same)&lt;br&gt;
  &lt;br&gt;
# lspci -tv&lt;br&gt;
-[0000:00]-+-00.0   Intel Corporation 440FX - 82441FX PMC [Natoma]&lt;br&gt;
                     +-01.0   Intel Corporation 82371SB PIIX3 ISA [Natoma/Triton \
                II]&lt;br&gt;
                     +-01.1   Intel Corporation 82371SB PIIX3 IDE [Natoma/Triton \
                II]&lt;br&gt;
                     +-01.2   Intel Corporation 82371SB PIIX3 USB [Natoma/Triton \
                II]&lt;br&gt;
                     +-01.3   Intel Corporation 82371AB/EB/MB PIIX4 ACPI&lt;br&gt;
                     +-02.0   Cirrus Logic GD 5446&lt;br&gt;
                     +-03.0-[01]--+-01.0   Red Hat, Inc. Virtio network device&lt;br&gt;
                     |                       +-02.0   Red Hat, Inc. Virtio network \
                device&lt;br&gt;
                     |                       \-03.0   Intel Corporation I210 Gigabit \
Network Connection&lt;br&gt;  +-04.0-[02]--&lt;br&gt;
                     +-05.0-[03]--&lt;br&gt;
                     +-06.0-[04]--&lt;br&gt;
                     +-07.0-[05]--&lt;br&gt;
                     +-08.0-[06]----01.0   Red Hat, Inc. Virtio block device&lt;br&gt;
                     +-09.0   Intel Corporation 82801IR/IO/IH (ICH9R/DO/DH) 6 port \
SATA Controller [AHCI mode]&lt;br&gt;  +-0a.0   Red Hat, Inc. Virtio console&lt;br&gt;
                     +-0b.0   Red Hat, Inc. Virtio memory balloon&lt;br&gt;
                     \-0c.0   Red Hat, Inc. Virtio RNG&lt;br&gt;
                     &lt;br&gt;
  
  &lt;br&gt;
I see that a new feature in qemu and libvirt is to add ACPI indices in 
order to have network interfaces appear as *onboard* and sort them 
through this index as opposed to virtual PCI addresses. This is great. I
 see that in this case, interfaces appear as eno1, eno2, etc.&lt;br&gt;
  &lt;br&gt;
However, for the sake of backward compatibility, is there a way to have 
the previous behaviour where interfaces were called by their PCI slot 
number (ens1, ens2, etc.)?&lt;br&gt;
  &lt;br&gt;
If I move to the new naming yielded by ACPI indices, I am mostly worried
 about any possible change in interface names that might occur across 
VMs running different OS's, with respect to what we had before with 
libvirt 7.0.0 and qemu 5.2.0.&lt;br&gt;
  &lt;br&gt;
Thanks!&lt;br&gt;
  &lt;br&gt;
Best,&lt;br&gt;
Riccardo Ravaioli&lt;/p&gt;
&lt;/div&gt;



</body></email><email><emailId>20210623165934</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-06-23 16:59:34-0400</timestampReceived><subject>Re: issue when not using acpi indices in libvirt 7.4.0 and qemu 6.0.0</subject><body>

On Wed, Jun 23, 2021 at 06:49:12PM +0200, Riccardo Ravaioli wrote:
&gt; Hi everyone,
&gt; 
&gt; We have an issue with how network interfaces are presented in the VM with
&gt; the latest libvirt 7.4.0 and qemu 6.0.0.
&gt; 
&gt; Previously, we were on libvirt 7.0.0 and qemu 5.2.0, and we used increasing
&gt; virtual PCI addresses for any type of network interface (virtio, PCI
&gt; passthrough, SRIOV) in order to decide the interface order inside the VM.
&gt; For instance the following snippet yields ens1, ens2 and ens3 in a Debian
&gt; Buster VM:
&gt; 
&gt;   &lt;interface type="ethernet"&gt;
&gt;      &lt;target dev="0.vSrv"/&gt;
&gt;      &lt;mac address="52:54:00:aa:cc:05"/&gt;
&gt;      &lt;address bus="0x01" domain="0x0000" function="0x0" slot="0x01"
&gt; type="pci"/&gt;
&gt;      &lt;model type="virtio"/&gt;
&gt;      &lt;driver&gt;
&gt;         &lt;host csum="off"/&gt;
&gt;      &lt;/driver&gt;
&gt;   &lt;/interface&gt;
&gt;   &lt;interface type="ethernet"&gt;
&gt;      &lt;target dev="1.vSrv"/&gt;
&gt;      &lt;mac address="52:54:00:aa:bb:81"/&gt;
&gt;      &lt;address bus="0x01" domain="0x0000" function="0x0" slot="0x02"
&gt; type="pci"/&gt;
&gt;      &lt;model type="virtio"/&gt;
&gt;      &lt;driver&gt;
&gt;         &lt;host csum="off"/&gt;
&gt;      &lt;/driver&gt;
&gt;   &lt;/interface&gt;
&gt;   &lt;hostdev managed="yes" mode="subsystem" type="pci"&gt;
&gt;      &lt;source&gt;
&gt;         &lt;address bus="0x0d" domain="0x0000" function="0x0" slot="0x00"/&gt;
&gt;      &lt;/source&gt;
&gt;      &lt;address bus="0x01" domain="0x0000" function="0x0" slot="0x03"
&gt; type="pci"/&gt;
&gt;   &lt;/hostdev&gt;

So your config here does NOT list any ACPI indexes

&gt; After upgrading to libvirt 7.4.0 and qemu 6.0.0, the XML snippet above
&gt; yielded:
&gt; - ens1 for the first virtio interface =&gt; OK
&gt; - rename4 for the second virtio interface =&gt; **KO**
&gt; - ens3 for the PCI passthrough interface  =&gt; OK

So from libvirt's POV, nothing should have changed upon upgrade,
as we wouldn't be setting any ACPI indexes by default.

Can you show the QEMU command line from /var/log/libvirt/qemu/$GUEST.log
both before and after the libvirt upgrade.


Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20210623233712</emailId><senderName>Riccardo Ravaioli</senderName><senderEmail>riccardoravaioli@gmail.com</senderEmail><timestampReceived>2021-06-23 23:37:12-0400</timestampReceived><subject>Re: issue when not using acpi indices in libvirt 7.4.0 and qemu 6.0.0</subject><body>

On Wed, 23 Jun 2021 at 18:59, Daniel P. Berrangé &lt;berrange@redhat.com&gt;
wrote:

&gt; [...]
&gt; So your config here does NOT list any ACPI indexes
&gt;

Exactly, I don't list any ACPI indices.


&gt; &gt; After upgrading to libvirt 7.4.0 and qemu 6.0.0, the XML snippet above
&gt; &gt; yielded:
&gt; &gt; - ens1 for the first virtio interface =&gt; OK
&gt; &gt; - rename4 for the second virtio interface =&gt; **KO**
&gt; &gt; - ens3 for the PCI passthrough interface  =&gt; OK
&gt;
&gt; So from libvirt's POV, nothing should have changed upon upgrade,
&gt; as we wouldn't be setting any ACPI indexes by default.
&gt;
&gt; Can you show the QEMU command line from /var/log/libvirt/qemu/$GUEST.log
&gt; both before and after the libvirt upgrade.
&gt;

Sure, here it is before the upgrade: https://pastebin.com/ZzKd2uRJ
And here after the upgrade: https://pastebin.com/EMu6Jgat
(there is a minor difference in the disks which shouldn't be related to
this issue)

Thanks!

Riccardo

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Wed, 23 \
Jun 2021 at 18:59, Daniel P. Berrangé &lt;&lt;a \
href="mailto:berrange@redhat.com"&gt;berrange@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;[...]&lt;br&gt;

So your config here does NOT list any ACPI \
indexes&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Exactly, I don't list any ACPI \
indices. &lt;/div&gt;&lt;div&gt;  &lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;

&gt; After upgrading to libvirt 7.4.0 and qemu 6.0.0, the XML snippet above&lt;br&gt;
&gt; yielded:&lt;br&gt;
&gt; - ens1 for the first virtio interface =&gt; OK&lt;br&gt;
&gt; - rename4 for the second virtio interface =&gt; **KO**&lt;br&gt;
&gt; - ens3 for the PCI passthrough interface   =&gt; OK&lt;br&gt;
&lt;br&gt;
So from libvirt's POV, nothing should have changed upon upgrade,&lt;br&gt;
as we wouldn't be setting any ACPI indexes by default.&lt;br&gt;
&lt;br&gt;
Can you show the QEMU command line from /var/log/libvirt/qemu/$GUEST.log&lt;br&gt;
both before and after the libvirt upgrade.&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Sure, \
here it is before the upgrade: &lt;a \
href="https://pastebin.com/ZzKd2uRJ"&gt;https://pastebin.com/ZzKd2uRJ&lt;/a&gt;&lt;/div&gt;&lt;div&gt;And \
here after the upgrade: &lt;a \
href="https://pastebin.com/EMu6Jgat"&gt;https://pastebin.com/EMu6Jgat&lt;/a&gt;&lt;/div&gt;&lt;div&gt;(there \
is a minor difference in the disks which shouldn't be related to this \
issue)&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks!&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Riccardo&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt; \
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210624021144</emailId><senderName>Laine Stump</senderName><senderEmail>laine@redhat.com</senderEmail><timestampReceived>2021-06-24 02:11:44-0400</timestampReceived><subject>Re: issue when not using acpi indices in libvirt 7.4.0 and qemu 6.0.0</subject><body>



On 6/23/21 7:37 PM, Riccardo Ravaioli wrote:
&gt; On Wed, 23 Jun 2021 at 18:59, Daniel P. Berrangé &lt;berrange@redhat.com 
&gt; &lt;mailto:berrange@redhat.com&gt;&gt; wrote:
&gt; 
&gt;     [...]
&gt;     So your config here does NOT list any ACPI indexes
&gt; 
&gt; 
&gt; Exactly, I don't list any ACPI indices.
&gt; 
&gt;      &gt; After upgrading to libvirt 7.4.0 and qemu 6.0.0, the XML snippet
&gt;     above
&gt;      &gt; yielded:
&gt;      &gt; - ens1 for the first virtio interface =&gt; OK
&gt;      &gt; - rename4 for the second virtio interface =&gt; **KO**

(this is reminiscent of what would sometimes happen back in the "bad old 
days" of ethN NIC naming.)

&gt;      &gt; - ens3 for the PCI passthrough interface   =&gt; OK

With the older libvirt + qemu, the guest (Debian) was setting the device 
names to ens1, ens2, and ens3 (through some sort of renaming, apparently 
by udev. The names that these interfaces would normally get (e.g. in 
Fedora or RHEL8) would be enp1s1, enp1s2, and enp1s3.

With the newer libvirt + qemu, the guest still has the names set by 
systemd (?) to enp1s1, enp1s2, and enp1s3.

&gt;     So from libvirt's POV, nothing should have changed upon upgrade,
&gt;     as we wouldn't be setting any ACPI indexes by default.

Right. If ACPI indexes had been turned on, I would have expected the 
names to be, e.g., eno1, eno2, eno3. But that would require explicitly 
adding the option to the qemu commandline, but it isn't there (see below).

&gt; 
&gt;     Can you show the QEMU command line from /var/log/libvirt/qemu/$GUEST.log
&gt;     both before and after the libvirt upgrade.
&gt; 
&gt; 
&gt; Sure, here it is before the upgrade: https://pastebin.com/ZzKd2uRJ 
&gt; &lt;https://pastebin.com/ZzKd2uRJ&gt;

-netdev tap,fd=50,id=hostnet0 \
-device 
virtio-net-pci,csum=off,netdev=hostnet0,id=net0,mac=52:54:00:aa:cc:05,bus=pci.1,addr=0x1 
\
-netdev tap,fd=51,id=hostnet1 \
-device 
virtio-net-pci,csum=off,netdev=hostnet1,id=net1,mac=52:54:00:aa:bb:81,bus=pci.1,addr=0x2 
\
[...]
-device vfio-pci,host=0000:0d:00.0,id=hostdev0,bus=pci.1,addr=0x3 \

&gt; And here after the upgrade: https://pastebin.com/EMu6Jgat 
&gt; &lt;https://pastebin.com/EMu6Jgat&gt;

-netdev tap,fd=55,id=hostnet0 \
-device 
virtio-net-pci,csum=off,netdev=hostnet0,id=net0,mac=52:54:00:aa:cc:a0,bus=pci.1,addr=0x1 
\
-netdev tap,fd=56,id=hostnet1 \
-device 
virtio-net-pci,csum=off,netdev=hostnet1,id=net1,mac=52:54:00:aa:bb:a1,bus=pci.1,addr=0x2 
\
[...]


So there is no change in the qemu commandline for the virtio-net 
devices, nor for the hostdev.

(BTW, you say that your vfio-assigned device is SRIOV, but it isn't - 
it's a standard ethernet device - "Intel Corporation I210 Gigabit 
Network Connection" - this has no effect on the current conversation, 
just FYI).

Since the name of the devices hasn't changed to "enoBLAH", I think the 
whole ACPI index thing is a red herring - ACPI indexes aren't being set 
and the device names aren't being set based on the non-existent ACPI 
indexes. There is something else going on (seemingly tied to the device 
renaming that udev (?) is doing from enpXsY to ensZ).

I notice that you're apparently redefining this domain from scratch each 
time it is started.

1) The machinetype changes from pc-i440fx-5.2 to pc-i440fx-6.0, implying 
that each time the domain is started, it is being told to use the 
generic machinetype "pc", which is then canonicalized to "the newest 
pci-i440fx-based machinetype" before starting the guest.

2) The MAC address has been changed for the two virtio-net cards, but 
not to some random number as would happen if you were allowing libvirt.

It's common for OSes to notice a new MAC address and attempt to give the 
interface a new name. Perhaps this is happening and whoever/whatever is 
doing that is screwing things up. Or it's possible there is some minor 
change in the machinetype from pc-i440fx-5.2 to pc-i440fx-6.0 that is 
causing this renaming to behave differently.

If you really need your guests to be stable, you shouldn't just use "pc" 
as the machinetype every time the guest is started, but instead save the 
canonicalized machinetype listed in the XML when you initially define 
the domain, and use that canonicalized machinetype on all future starts 
of the domain. Likewise, you should retain the exact MAC addresses that 
are used for all the NICs when the domain is originally defined and 
started for the first time, and use those exact same MAC addresses in 
subsequent starts. That way you are guaranteed (modulo any bugs) that 
the guest is presented with the exact same hardware each time it boots. 
If you use "virsh define" and "virsh start" (rather than "virsh create" 
- I can't be certain this is what you're doing, but there are clues 
indicating it might be the case) then all these details are 
automatically preserved for you within libvirt's persistent domain 
configuration.

One other comment - I don't remember the exact location, but I recall 
from a long long time ago that udev saves the information about names 
that it gives to NICs "somewhere". You may want to find and clear out 
that cache of info in the guest to get "clean" NIC names with this 
particular guest. You may continue to get odd results until you do this.

</body></email><email><emailId>20210617122122</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-06-17 12:21:22-0400</timestampReceived><subject>Re: Libvirt hit a issue when do VM migration</subject><body>

Firstly please don't CC random people who are subscribed to the list.

Additionally this is a user-question so it's not entirely appropriate
for libvir-list@redhat.com only for libvirt-users@redhat.com.

On Thu, Jun 17, 2021 at 16:52:42 +0800, 梁朝军 wrote:
&gt; Hi All,
&gt; 
&gt; Who can give me a help? I hit another issue when do vm migration?  Libvirt throw \
&gt; out the error like below 
&gt; "libvirt: Domain Config error : unsupported configuration: vcpu enable order of \
&gt; vCPU '0' differs between source and destination definitions"

This error happens when the 'order' attribute ...

&gt; 
&gt; 
&gt; The cup information is defined VM domain on source host is like: 
&gt; &lt;vcpu placement='static'&gt;2&lt;/vcpu&gt;
&gt; &lt;vcpus&gt;
&gt; &lt;vcpu id='0' enabled='yes' hotpluggable='no' order='1'/&gt;
&gt; &lt;vcpu id='1' enabled='yes' hotpluggable='no' order='2'/&gt;

... such you can see here doesn't match for a vcpu of a particular ID.

&gt; &lt;/vcpus&gt;
&gt; &lt;cputune&gt;
&gt; &lt;vcpupin vcpu='0' cpuset='42'/&gt;
&gt; &lt;vcpupin vcpu='1' cpuset='43'/&gt;
&gt; &lt;/cputune&gt;
&gt; 
&gt; The distinction host previews generate xml for VM like:
&gt; 
&gt; &lt;vcpu placement='static'&gt;2&lt;/vcpu&gt;
&gt; &lt;vcpus&gt;
&gt; &lt;vcpu id='0' enabled='yes' hotpluggable='no' order='1'/&gt;
&gt; &lt;vcpu id='1' enabled='yes' hotpluggable='no' order='2'/&gt;

Yours do match though. Did you post the correct XMLs?

&gt; &lt;/vcpus&gt;
&gt; &lt;cputune&gt;
&gt; &lt;vcpupin vcpu='0' cpuset='42'/&gt;
&gt; &lt;vcpupin vcpu='1' cpuset='43'/&gt;
&gt; &lt;/cputune&gt;
&gt; 
&gt; What't wrong with it? Or I missing some actions in configurations regarding the \
&gt; migration

It's unfortunately impossible to tell, your report doesn't descirbe what
steps you took to do the migration nor does contain debug logs.


</body></email><email><emailId>20210623122537</emailId><senderName>liang chaojun</senderName><senderEmail>jesonliang040705@hotmail.com</senderEmail><timestampReceived>2021-06-23 12:25:37-0400</timestampReceived><subject>Re: Libvirt hit a issue when do VM migration</subject><body>

[Attachment #2 (multipart/related)]

[Attachment #4 (multipart/alternative)]

[Attachment #6 (text/plain)]

Thanks Peter for your help as well as your suggestion. I have got the cues of this \
issue.

Current there still exist another issue that confuse me that we random hit VM can't \
boot and  stuck in black screen show as "Guest has not initialized the display \
(yet)."

The attachment is the Libvirt debug log but I'm not able to find any useful cues.  \
Any comments regarding this issue will be appreciated.



[cid:463f2b37-202e-49a2-a82e-ff224e9a9eac@jpnprd01.prod.outlook.com]


&gt; 在 2021年6月17日，下午8:21，Peter Krempa &lt;pkrempa@redhat.com&gt; 写道：
&gt; 
&gt; Firstly please don't CC random people who are subscribed to the list.
&gt; 
&gt; Additionally this is a user-question so it's not entirely appropriate
&gt; for libvir-list@redhat.com only for libvirt-users@redhat.com.
&gt; 
&gt; On Thu, Jun 17, 2021 at 16:52:42 +0800, 梁朝军 wrote:
&gt; &gt; Hi All,
&gt; &gt; 
&gt; &gt; Who can give me a help? I hit another issue when do vm migration?  Libvirt throw \
&gt; &gt; out the error like below 
&gt; &gt; "libvirt: Domain Config error : unsupported configuration: vcpu enable order of \
&gt; &gt; vCPU '0' differs between source and destination definitions"
&gt; 
&gt; This error happens when the 'order' attribute ...
&gt; 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; The cup information is defined VM domain on source host is like:
&gt; &gt; &lt;vcpu placement='static'&gt;2&lt;/vcpu&gt;
&gt; &gt; &lt;vcpus&gt;
&gt; &gt; &lt;vcpu id='0' enabled='yes' hotpluggable='no' order='1'/&gt;
&gt; &gt; &lt;vcpu id='1' enabled='yes' hotpluggable='no' order='2'/&gt;
&gt; 
&gt; ... such you can see here doesn't match for a vcpu of a particular ID.
&gt; 
&gt; &gt; &lt;/vcpus&gt;
&gt; &gt; &lt;cputune&gt;
&gt; &gt; &lt;vcpupin vcpu='0' cpuset='42'/&gt;
&gt; &gt; &lt;vcpupin vcpu='1' cpuset='43'/&gt;
&gt; &gt; &lt;/cputune&gt;
&gt; &gt; 
&gt; &gt; The distinction host previews generate xml for VM like:
&gt; &gt; 
&gt; &gt; &lt;vcpu placement='static'&gt;2&lt;/vcpu&gt;
&gt; &gt; &lt;vcpus&gt;
&gt; &gt; &lt;vcpu id='0' enabled='yes' hotpluggable='no' order='1'/&gt;
&gt; &gt; &lt;vcpu id='1' enabled='yes' hotpluggable='no' order='2'/&gt;
&gt; 
&gt; Yours do match though. Did you post the correct XMLs?
&gt; 
&gt; &gt; &lt;/vcpus&gt;
&gt; &gt; &lt;cputune&gt;
&gt; &gt; &lt;vcpupin vcpu='0' cpuset='42'/&gt;
&gt; &gt; &lt;vcpupin vcpu='1' cpuset='43'/&gt;
&gt; &gt; &lt;/cputune&gt;
&gt; &gt; 
&gt; &gt; What't wrong with it? Or I missing some actions in configurations regarding the \
&gt; &gt; migration
&gt; 
&gt; It's unfortunately impossible to tell, your report doesn't descirbe what
&gt; steps you took to do the migration nor does contain debug logs.
&gt; 


[Attachment #7 (text/html)]

&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div class="BodyFragment"&gt;&lt;font size="2"&gt;&lt;span style="font-size:11pt;"&gt;
&lt;div class="PlainText"&gt;Thanks Peter for your help as well as your suggestion. I have \
got the cues of this issue.&lt;br&gt; &lt;br&gt;
Current there still exist another issue that confuse me that we random hit VM can't \
boot and  stuck in black screen show as "Guest has not initialized the display \
(yet)." &lt;br&gt;
&lt;br&gt;
The attachment is the Libvirt debug log but I'm not able to find any useful \
cues.  Any comments regarding this issue will be appreciated.&lt;/div&gt; \
&lt;/span&gt;&lt;/font&gt;&lt;/div&gt; &lt;div class="BodyFragment"&gt;&lt;font size="2"&gt;&lt;span \
style="font-size:11pt;"&gt; &lt;div class="PlainText"&gt;&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;
&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;img src="cid:463f2b37-202e-49a2-a82e-ff224e9a9eac@jpnprd01.prod.outlook.com"&gt;
&lt;/div&gt;
&lt;div class="BodyFragment"&gt;&lt;font size="2"&gt;&lt;span style="font-size:11pt;"&gt;
&lt;div class="PlainText"&gt;&lt;br&gt;
&lt;br&gt;
&gt; 在 2021年6月17日，下午8:21，Peter Krempa &lt;pkrempa@redhat.com&gt; \
写道：&lt;br&gt; &gt; &lt;br&gt;
&gt; Firstly please don't CC random people who are subscribed to the list.&lt;br&gt;
&gt; &lt;br&gt;
&gt; Additionally this is a user-question so it's not entirely appropriate&lt;br&gt;
&gt; for libvir-list@redhat.com only for libvirt-users@redhat.com.&lt;br&gt;
&gt; &lt;br&gt;
&gt; On Thu, Jun 17, 2021 at 16:52:42 +0800, 梁朝军 wrote:&lt;br&gt;
&gt;&gt; Hi All,&lt;br&gt;
&gt;&gt; &lt;br&gt;
&gt;&gt; Who can give me a help? I hit another issue when do vm migration?  \
Libvirt throw out the error like below&lt;br&gt; &gt;&gt; &lt;br&gt;
&gt;&gt; "libvirt: Domain Config error : unsupported configuration: vcpu enable \
order of vCPU '0' differs between source and destination definitions"&lt;br&gt; &gt; &lt;br&gt;
&gt; This error happens when the 'order' attribute ...&lt;br&gt;
&gt; &lt;br&gt;
&gt;&gt; &lt;br&gt;
&gt;&gt; &lt;br&gt;
&gt;&gt; The cup information is defined VM domain on source host is like: &lt;br&gt;
&gt;&gt; &lt;vcpu placement='static'&gt;2&lt;/vcpu&gt;&lt;br&gt;
&gt;&gt; &lt;vcpus&gt;&lt;br&gt;
&gt;&gt; &lt;vcpu id='0' enabled='yes' hotpluggable='no' order='1'/&gt;&lt;br&gt;
&gt;&gt; &lt;vcpu id='1' enabled='yes' hotpluggable='no' order='2'/&gt;&lt;br&gt;
&gt; &lt;br&gt;
&gt; ... such you can see here doesn't match for a vcpu of a particular ID.&lt;br&gt;
&gt; &lt;br&gt;
&gt;&gt; &lt;/vcpus&gt;&lt;br&gt;
&gt;&gt; &lt;cputune&gt;&lt;br&gt;
&gt;&gt; &lt;vcpupin vcpu='0' cpuset='42'/&gt;&lt;br&gt;
&gt;&gt; &lt;vcpupin vcpu='1' cpuset='43'/&gt;&lt;br&gt;
&gt;&gt; &lt;/cputune&gt;&lt;br&gt;
&gt;&gt; &lt;br&gt;
&gt;&gt; The distinction host previews generate xml for VM like:&lt;br&gt;
&gt;&gt; &lt;br&gt;
&gt;&gt; &lt;vcpu placement='static'&gt;2&lt;/vcpu&gt;&lt;br&gt;
&gt;&gt; &lt;vcpus&gt;&lt;br&gt;
&gt;&gt; &lt;vcpu id='0' enabled='yes' hotpluggable='no' order='1'/&gt;&lt;br&gt;
&gt;&gt; &lt;vcpu id='1' enabled='yes' hotpluggable='no' order='2'/&gt;&lt;br&gt;
&gt; &lt;br&gt;
&gt; Yours do match though. Did you post the correct XMLs?&lt;br&gt;
&gt; &lt;br&gt;
&gt;&gt; &lt;/vcpus&gt;&lt;br&gt;
&gt;&gt; &lt;cputune&gt;&lt;br&gt;
&gt;&gt; &lt;vcpupin vcpu='0' cpuset='42'/&gt;&lt;br&gt;
&gt;&gt; &lt;vcpupin vcpu='1' cpuset='43'/&gt;&lt;br&gt;
&gt;&gt; &lt;/cputune&gt;&lt;br&gt;
&gt;&gt; &lt;br&gt;
&gt;&gt; What't wrong with it? Or I missing some actions in configurations regarding \
the migration&lt;br&gt; &gt; &lt;br&gt;
&gt; It's unfortunately impossible to tell, your report doesn't descirbe what&lt;br&gt;
&gt; steps you took to do the migration nor does contain debug logs.&lt;br&gt;
&gt; &lt;br&gt;
&lt;br&gt;
&lt;/div&gt;
&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;


["PastedGraphic-1.png" (image/png)]
["testvm_cuhv7a54.log" (application/octet-stream)]

</body></email><email><emailId>20210623122546</emailId><senderName>liang chaojun</senderName><senderEmail>jesonliang040705@hotmail.com</senderEmail><timestampReceived>2021-06-23 12:25:46-0400</timestampReceived><subject>Re: Libvirt hit a issue when do VM migration</subject><body>

[Attachment #2 (multipart/related)]

[Attachment #4 (multipart/alternative)]

[Attachment #6 (text/plain)]

Thanks Peter for your help as well as your suggestion. I have got the cues of this \
issue.

Current there still exist another issue that confuse me that we random hit VM can't \
boot and  stuck in black screen show as "Guest has not initialized the display \
(yet)."

The attachment is the Libvirt debug log but I'm not able to find any useful cues.  \
Any comments regarding this issue will be appreciated.



[cid:47159081-a674-46ac-937d-c578768a82f9@jpnprd01.prod.outlook.com]


&gt; 在 2021年6月17日，下午8:21，Peter Krempa &lt;pkrempa@redhat.com&gt; 写道：
&gt; 
&gt; Firstly please don't CC random people who are subscribed to the list.
&gt; 
&gt; Additionally this is a user-question so it's not entirely appropriate
&gt; for libvir-list@redhat.com only for libvirt-users@redhat.com.
&gt; 
&gt; On Thu, Jun 17, 2021 at 16:52:42 +0800, 梁朝军 wrote:
&gt; &gt; Hi All,
&gt; &gt; 
&gt; &gt; Who can give me a help? I hit another issue when do vm migration?  Libvirt throw \
&gt; &gt; out the error like below 
&gt; &gt; "libvirt: Domain Config error : unsupported configuration: vcpu enable order of \
&gt; &gt; vCPU '0' differs between source and destination definitions"
&gt; 
&gt; This error happens when the 'order' attribute ...
&gt; 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; The cup information is defined VM domain on source host is like:
&gt; &gt; &lt;vcpu placement='static'&gt;2&lt;/vcpu&gt;
&gt; &gt; &lt;vcpus&gt;
&gt; &gt; &lt;vcpu id='0' enabled='yes' hotpluggable='no' order='1'/&gt;
&gt; &gt; &lt;vcpu id='1' enabled='yes' hotpluggable='no' order='2'/&gt;
&gt; 
&gt; ... such you can see here doesn't match for a vcpu of a particular ID.
&gt; 
&gt; &gt; &lt;/vcpus&gt;
&gt; &gt; &lt;cputune&gt;
&gt; &gt; &lt;vcpupin vcpu='0' cpuset='42'/&gt;
&gt; &gt; &lt;vcpupin vcpu='1' cpuset='43'/&gt;
&gt; &gt; &lt;/cputune&gt;
&gt; &gt; 
&gt; &gt; The distinction host previews generate xml for VM like:
&gt; &gt; 
&gt; &gt; &lt;vcpu placement='static'&gt;2&lt;/vcpu&gt;
&gt; &gt; &lt;vcpus&gt;
&gt; &gt; &lt;vcpu id='0' enabled='yes' hotpluggable='no' order='1'/&gt;
&gt; &gt; &lt;vcpu id='1' enabled='yes' hotpluggable='no' order='2'/&gt;
&gt; 
&gt; Yours do match though. Did you post the correct XMLs?
&gt; 
&gt; &gt; &lt;/vcpus&gt;
&gt; &gt; &lt;cputune&gt;
&gt; &gt; &lt;vcpupin vcpu='0' cpuset='42'/&gt;
&gt; &gt; &lt;vcpupin vcpu='1' cpuset='43'/&gt;
&gt; &gt; &lt;/cputune&gt;
&gt; &gt; 
&gt; &gt; What't wrong with it? Or I missing some actions in configurations regarding the \
&gt; &gt; migration
&gt; 
&gt; It's unfortunately impossible to tell, your report doesn't descirbe what
&gt; steps you took to do the migration nor does contain debug logs.
&gt; 


[Attachment #7 (text/html)]

&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div class="BodyFragment"&gt;&lt;font size="2"&gt;&lt;span style="font-size:11pt;"&gt;
&lt;div class="PlainText"&gt;Thanks Peter for your help as well as your suggestion. I have \
got the cues of this issue.&lt;br&gt; &lt;br&gt;
Current there still exist another issue that confuse me that we random hit VM can't \
boot and  stuck in black screen show as "Guest has not initialized the display \
(yet)." &lt;br&gt;
&lt;br&gt;
The attachment is the Libvirt debug log but I'm not able to find any useful \
cues.  Any comments regarding this issue will be appreciated.&lt;/div&gt; \
&lt;/span&gt;&lt;/font&gt;&lt;/div&gt; &lt;div class="BodyFragment"&gt;&lt;font size="2"&gt;&lt;span \
style="font-size:11pt;"&gt; &lt;div class="PlainText"&gt;&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;
&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;img src="cid:47159081-a674-46ac-937d-c578768a82f9@jpnprd01.prod.outlook.com"&gt;
&lt;/div&gt;
&lt;div class="BodyFragment"&gt;&lt;font size="2"&gt;&lt;span style="font-size:11pt;"&gt;
&lt;div class="PlainText"&gt;&lt;br&gt;
&lt;br&gt;
&gt; 在 2021年6月17日，下午8:21，Peter Krempa &lt;pkrempa@redhat.com&gt; \
写道：&lt;br&gt; &gt; &lt;br&gt;
&gt; Firstly please don't CC random people who are subscribed to the list.&lt;br&gt;
&gt; &lt;br&gt;
&gt; Additionally this is a user-question so it's not entirely appropriate&lt;br&gt;
&gt; for libvir-list@redhat.com only for libvirt-users@redhat.com.&lt;br&gt;
&gt; &lt;br&gt;
&gt; On Thu, Jun 17, 2021 at 16:52:42 +0800, 梁朝军 wrote:&lt;br&gt;
&gt;&gt; Hi All,&lt;br&gt;
&gt;&gt; &lt;br&gt;
&gt;&gt; Who can give me a help? I hit another issue when do vm migration?  \
Libvirt throw out the error like below&lt;br&gt; &gt;&gt; &lt;br&gt;
&gt;&gt; "libvirt: Domain Config error : unsupported configuration: vcpu enable \
order of vCPU '0' differs between source and destination definitions"&lt;br&gt; &gt; &lt;br&gt;
&gt; This error happens when the 'order' attribute ...&lt;br&gt;
&gt; &lt;br&gt;
&gt;&gt; &lt;br&gt;
&gt;&gt; &lt;br&gt;
&gt;&gt; The cup information is defined VM domain on source host is like: &lt;br&gt;
&gt;&gt; &lt;vcpu placement='static'&gt;2&lt;/vcpu&gt;&lt;br&gt;
&gt;&gt; &lt;vcpus&gt;&lt;br&gt;
&gt;&gt; &lt;vcpu id='0' enabled='yes' hotpluggable='no' order='1'/&gt;&lt;br&gt;
&gt;&gt; &lt;vcpu id='1' enabled='yes' hotpluggable='no' order='2'/&gt;&lt;br&gt;
&gt; &lt;br&gt;
&gt; ... such you can see here doesn't match for a vcpu of a particular ID.&lt;br&gt;
&gt; &lt;br&gt;
&gt;&gt; &lt;/vcpus&gt;&lt;br&gt;
&gt;&gt; &lt;cputune&gt;&lt;br&gt;
&gt;&gt; &lt;vcpupin vcpu='0' cpuset='42'/&gt;&lt;br&gt;
&gt;&gt; &lt;vcpupin vcpu='1' cpuset='43'/&gt;&lt;br&gt;
&gt;&gt; &lt;/cputune&gt;&lt;br&gt;
&gt;&gt; &lt;br&gt;
&gt;&gt; The distinction host previews generate xml for VM like:&lt;br&gt;
&gt;&gt; &lt;br&gt;
&gt;&gt; &lt;vcpu placement='static'&gt;2&lt;/vcpu&gt;&lt;br&gt;
&gt;&gt; &lt;vcpus&gt;&lt;br&gt;
&gt;&gt; &lt;vcpu id='0' enabled='yes' hotpluggable='no' order='1'/&gt;&lt;br&gt;
&gt;&gt; &lt;vcpu id='1' enabled='yes' hotpluggable='no' order='2'/&gt;&lt;br&gt;
&gt; &lt;br&gt;
&gt; Yours do match though. Did you post the correct XMLs?&lt;br&gt;
&gt; &lt;br&gt;
&gt;&gt; &lt;/vcpus&gt;&lt;br&gt;
&gt;&gt; &lt;cputune&gt;&lt;br&gt;
&gt;&gt; &lt;vcpupin vcpu='0' cpuset='42'/&gt;&lt;br&gt;
&gt;&gt; &lt;vcpupin vcpu='1' cpuset='43'/&gt;&lt;br&gt;
&gt;&gt; &lt;/cputune&gt;&lt;br&gt;
&gt;&gt; &lt;br&gt;
&gt;&gt; What't wrong with it? Or I missing some actions in configurations regarding \
the migration&lt;br&gt; &gt; &lt;br&gt;
&gt; It's unfortunately impossible to tell, your report doesn't descirbe what&lt;br&gt;
&gt; steps you took to do the migration nor does contain debug logs.&lt;br&gt;
&gt; &lt;br&gt;
&lt;br&gt;
&lt;/div&gt;
&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;


["PastedGraphic-1.png" (image/png)]
["testvm_cuhv7a54.log" (application/octet-stream)]

</body></email><email><emailId>20210513072523</emailId><senderName></senderName><senderEmail>jesonliang040705@hotmail.com</senderEmail><timestampReceived>2021-05-13 07:25:23-0400</timestampReceived><subject>How to hot plugin a new vhost-user-blk-pci device to running VM?</subject><body>

&lt;html&gt;&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=gb2312"&gt;&lt;/head&gt;&lt;body \
dir="auto" style="word-wrap: break-word; -webkit-nbsp-mode: space; line-break: \
after-white-space;"&gt;&lt;div dir="auto" style="word-wrap: break-word; -webkit-nbsp-mode: \
space; line-break: after-white-space;"&gt;&lt;div dir="auto" style="word-wrap: break-word; \
-webkit-nbsp-mode: space; line-break: after-white-space;"&gt;&lt;div \
class="ApplePlainTextBody"&gt;Hi Guy,&lt;br&gt;&lt;br&gt;Does  anyone clear how to hot plugin a \
new vhost-user-blk-pci device to a running VM?&lt;br&gt;&lt;br&gt;Before staring vm , I pass the \
disk through QEMU command line  like below.&lt;br&gt;&lt;br&gt;&lt;qemu:commandline&gt;&lt;br&gt; \
 &lt;qemu:arg value='-object'/&gt;&lt;br&gt;  &lt;qemu:arg \
value='memory-backend-file,id=mem0,size=4G,mem-path=/dev/hugepages,share=on'/&gt;&lt;br&gt; \
 &lt;qemu:arg value='-numa'/&gt;&lt;br&gt;  &lt;qemu:arg \
value='node,memdev=mem0'/&gt;&lt;br&gt;  &lt;qemu:arg value='-chardev'/&gt;&lt;br&gt; \
 &lt;qemu:arg value='socket,id=spdk_vhost_blk721ea46a-b306-11eb-a280-525400a98761,path=/var/tmp/vhost.721ea46a-b306-11eb-a280-525400a98761,reconnect=1'/&gt;&lt;br&gt; \
 &lt;qemu:arg value='-device'/&gt;&lt;br&gt;  &lt;qemu:arg \
value='vhost-user-blk-pci,chardev=spdk_vhost_blk721ea46a-b306-11eb-a280-525400a98761,bootindex=1,num-queues=4'/&gt;&lt;br&gt; \
 &lt;qemu:arg value='-chardev'/&gt;&lt;br&gt;  &lt;qemu:arg \
value='socket,id=spdk_vhost_blk2f699c58-d222-4629-9fdc-400c3aadc55e,path=/var/tmp/vhost.2f699c58-d222-4629-9fdc-400c3aadc55e,reconnect=1'/&gt;&lt;br&gt; \
 &lt;qemu:arg value='-device'/&gt;&lt;br&gt;  &lt;qemu:arg \
value='vhost-user-blk-pci,chardev=spdk_vhost_blk2f699c58-d222-4629-9fdc-400c3aadc55e,num-queues=4'/&gt;&lt;br&gt;&lt;/qemu:commandline&gt;&lt;br&gt;&lt;br&gt;But \
I don¡¯t know how to live add a vhost-user-blk-pci device on running VM even with \
calling attachDevice API now.&lt;br&gt;&lt;br&gt;OS: redhat 7.4 Libvirt version: 3.4&lt;br&gt;&lt;br&gt;Your \
help will be appreciated.&lt;br&gt;&lt;br&gt;&lt;br&gt;Thanks!&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20210513073448</emailId><senderName>Liang Chaojun</senderName><senderEmail>jesonliang040705@hotmail.com</senderEmail><timestampReceived>2021-05-13 07:34:48-0400</timestampReceived><subject>How to hot plugin a new vhost-user-blk-pci device to running VM?</subject><body>

Hi Guy,

Does  anyone clear how to hot plugin a new vhost-user-blk-pci device to a running VM?

Before staring vm , I pass the disk through QEMU command line  like below.

&lt;qemu:commandline&gt;
 &lt;qemu:arg value='-object'/&gt;
 &lt;qemu:arg value='memory-backend-file,id=mem0,size=4G,mem-path=/dev/hugepages,share=on'/&gt;
  &lt;qemu:arg value='-numa'/&gt;
 &lt;qemu:arg value='node,memdev=mem0'/&gt;
 &lt;qemu:arg value='-chardev'/&gt;
 &lt;qemu:arg value='socket,id=spdk_vhost_blk721ea46a-b306-11eb-a280-525400a98761,path=/var/tmp/vhost.721ea46a-b306-11eb-a280-525400a98761,reconnect=1'/&gt;
  &lt;qemu:arg value='-device'/&gt;
 &lt;qemu:arg value='vhost-user-blk-pci,chardev=spdk_vhost_blk721ea46a-b306-11eb-a280-525400a98761,bootindex=1,num-queues=4'/&gt;
  &lt;qemu:arg value='-chardev'/&gt;
 &lt;qemu:arg value='socket,id=spdk_vhost_blk2f699c58-d222-4629-9fdc-400c3aadc55e,path=/var/tmp/vhost.2f699c58-d222-4629-9fdc-400c3aadc55e,reconnect=1'/&gt;
  &lt;qemu:arg value='-device'/&gt;
 &lt;qemu:arg value='vhost-user-blk-pci,chardev=spdk_vhost_blk2f699c58-d222-4629-9fdc-400c3aadc55e,num-queues=4'/&gt;
 &lt;/qemu:commandline&gt;

But I don't know how to live add a vhost-user-blk-pci device on running VM even with \
calling attachDevice API now.

OS: redhat 7.4 Libvirt version: 3.4

Your help will be appreciated.


Thanks!


</body></email><email><emailId>20210623081609</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-06-23 08:16:09-0400</timestampReceived><subject>Re: unaccessible directory in lxcContainerResolveSymlinks</subject><body>

On 6/22/21 6:17 PM, Priyanka Gupta wrote:
&gt; Hi,
&gt; 
&gt; Could someone pls let me know when this condition could possibly arise?
&gt; lxcContainerResolveSymlinks:621 : Skipped unaccessible '/flash/dir'
&gt; 
&gt; The code seems to call access('/flash/dir', F_OK) which shall only check
&gt; for existence of this directory '/flash/dir'. I have this directory
&gt; created on my host. Is there anything that I am missing?
&gt; 

Hey, looking into the code the function is ran from a mount namespace
thus the path may not exist. But is there a problem you are seeing? If
so, can you share your LXC XML and describe the problem? I mean, the
message you mention is just a debug printing, harmless.

Michal

</body></email><email><emailId>20210623091637</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-06-23 09:16:37-0400</timestampReceived><subject>Re: unaccessible directory in lxcContainerResolveSymlinks</subject><body>

On 6/23/21 11:08 AM, Priyanka Gupta wrote:
&gt; Hi Michal,
&gt; 
&gt; This is how snippets from my XML looks like. Full XML at the end of the
&gt; mail.. 
&gt;     &lt;emulator&gt;/usr/sbin/libvirt_lxc&lt;/emulator&gt;
&gt;     &lt;filesystem type='mount' accessmode='passthrough'&gt;
&gt;       &lt;source dir='/vol/usb1/iox/repo-lxc/utd/rootfs_mnt'/&gt;
&gt;       &lt;target dir='/'/&gt;
&gt;     &lt;/filesystem&gt;
&gt;     &lt;filesystem type='mount' accessmode='passthrough'&gt;
&gt;       &lt;source dir='/flash/dir'/&gt;
&gt;       &lt;target dir='/flash/dir'/&gt;
&gt;     &lt;/filesystem&gt;
&gt; 
&gt; The issue I am facing is, my container doesnt start. Fails at mounting
&gt; this /flash/dir  with below message.
&gt; 
&gt; 2021-06-09 06:52:55.548+0000: 1: error : lxcContainerMountFSBind:1223 :
&gt; Failed to bind mount directory /.oldroot/flash/dir to /flash/dir: No
&gt; such file or directory

Yeah, the lxc driver thinks that /flash/dir doesn't exist.
Unfortunately, I am unable to reproduce - when I mkdir -p /flash/dir
and add corresponding &lt;filesystem/&gt; to one of my containers it boots up
just fine. What's your libvirt version?

Michal

</body></email><email><emailId>20210623092057</emailId><senderName>Priyanka Gupta</senderName><senderEmail>priygupt@gmail.com</senderEmail><timestampReceived>2021-06-23 09:20:57-0400</timestampReceived><subject>Re: unaccessible directory in lxcContainerResolveSymlinks</subject><body>

Hi Michal,

This is how snippets from my XML looks like. Full XML at the end of the
mail..
    &lt;emulator&gt;/usr/sbin/libvirt_lxc&lt;/emulator&gt;
    &lt;filesystem type='mount' accessmode='passthrough'&gt;
      &lt;source dir='/vol/usb1/iox/repo-lxc/utd/rootfs_mnt'/&gt;
      &lt;target dir='/'/&gt;
    &lt;/filesystem&gt;
    &lt;filesystem type='mount' accessmode='passthrough'&gt;
      &lt;source dir='/flash/dir'/&gt;
      &lt;target dir='/flash/dir'/&gt;
    &lt;/filesystem&gt;

The issue I am facing is, my container doesnt start. Fails at mounting this
/flash/dir  with below message.

2021-06-09 06:52:55.548+0000: 1: error : lxcContainerMountFSBind:1223 :
Failed to bind mount directory /.oldroot/flash/dir to /flash/dir: No such
file or directory

I see that .oldroot is added to this path and figured out
that lxcContainerPivotRoot is creating and mounting all folders under
rootfs to rootfs/.oldroot
But durig pivot root, this path /flash/dir is unaccessible and hence we
don't seem to create this .oldroot/flash/dir.
Later on, during lxcContainerMountFSBind(), /.oldroot/flash/dir bind mount
fails.

Any thoughts?

Thanks
Priyanka

====
Full XML
====

&lt;domain type='lxc'&gt;
  &lt;name&gt;try&lt;/name&gt;
  &lt;memory&gt;1048576&lt;/memory&gt;
  &lt;currentMemory&gt;1048576&lt;/currentMemory&gt;
  &lt;vcpu placement='static'&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='x86_64'&gt;exe&lt;/type&gt;
    &lt;init&gt;/sbin/init&lt;/init&gt;
  &lt;/os&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/sbin/libvirt_lxc&lt;/emulator&gt;
    &lt;filesystem type='mount' accessmode='passthrough'&gt;
      &lt;source dir='/vol/usb1/iox/repo-lxc/utd/rootfs_mnt'/&gt;
      &lt;target dir='/'/&gt;
    &lt;/filesystem&gt;
    &lt;filesystem type='mount' accessmode='passthrough'&gt;
      &lt;source dir='/flash/dir'/&gt;
      &lt;target dir='/flash/dir'/&gt;
    &lt;/filesystem&gt;
    &lt;console type='pty'&gt;
      &lt;target type='lxc' port='2'/&gt;
    &lt;/console&gt;
  &lt;/devices&gt;
&lt;/domain&gt;

On Wed, Jun 23, 2021 at 1:46 PM Michal Prívozník &lt;mprivozn@redhat.com&gt;
wrote:

&gt; On 6/22/21 6:17 PM, Priyanka Gupta wrote:
&gt; &gt; Hi,
&gt; &gt;
&gt; &gt; Could someone pls let me know when this condition could possibly arise?
&gt; &gt; lxcContainerResolveSymlinks:621 : Skipped unaccessible '/flash/dir'
&gt; &gt;
&gt; &gt; The code seems to call access('/flash/dir', F_OK) which shall only check
&gt; &gt; for existence of this directory '/flash/dir'. I have this directory
&gt; &gt; created on my host. Is there anything that I am missing?
&gt; &gt;
&gt;
&gt; Hey, looking into the code the function is ran from a mount namespace
&gt; thus the path may not exist. But is there a problem you are seeing? If
&gt; so, can you share your LXC XML and describe the problem? I mean, the
&gt; message you mention is just a debug printing, harmless.
&gt;
&gt; Michal
&gt;
&gt;

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hi Michal,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;This is how snippets from my XML looks \
like. Full XML at the end of the mail..  &lt;/div&gt;&lt;div&gt;      \
&lt;emulator&gt;/usr/sbin/libvirt_lxc&lt;/emulator&gt;&lt;br&gt;      &lt;filesystem \
type='mount' accessmode='passthrough'&gt;&lt;br&gt;         &lt;source \
dir='/vol/usb1/iox/repo-lxc/utd/rootfs_mnt'/&gt;&lt;br&gt;         &lt;target \
dir='/'/&gt;&lt;br&gt;      &lt;/filesystem&gt;&lt;br&gt;      &lt;filesystem \
type='mount' accessmode='passthrough'&gt;&lt;br&gt;         &lt;source \
dir='/flash/dir'/&gt;&lt;/div&gt;&lt;div&gt;         &lt;target \
dir='/flash/dir'/&gt;&lt;br&gt;      \
&lt;/filesystem&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The issue I am facing is, my \
container doesnt start. Fails at mounting this /flash/dir   with below \
message.&lt;/div&gt;&lt;div&gt;&lt;p \
style="margin:0px;font-variant-numeric:normal;font-variant-east-asian:normal;font-stretch:normal;font-size:14px;line-height:normal;font-family:Helvetica"&gt;2021-06-09 \
06:52:55.548+0000: 1: error : lxcContainerMountFSBind:1223 : Failed to bind mount \
directory /.oldroot/flash/dir to /flash/dir: No such file or \
directory&lt;/p&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I see that .oldroot is added to this path and \
figured out that  lxcContainerPivotRoot  is creating  and mounting all folders under \
rootfs to rootfs/.oldroot&lt;/div&gt;&lt;div&gt;But durig pivot root, this path /flash/dir is \
unaccessible and hence we don't  seem to create this .oldroot/flash/dir.  \
&lt;/div&gt;&lt;div&gt;Later on, during lxcContainerMountFSBind(), /.oldroot/flash/dir bind mount \
fails.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Any \
thoughts?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&lt;/div&gt;&lt;div&gt;Priyanka&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;====&lt;/div&gt;&lt;div&gt;Full \
XML&lt;/div&gt;&lt;div&gt;====&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;domain type='lxc'&gt;&lt;br&gt;   \
&lt;name&gt;try&lt;/name&gt;&lt;br&gt;   &lt;memory&gt;1048576&lt;/memory&gt;&lt;br&gt;   \
&lt;currentMemory&gt;1048576&lt;/currentMemory&gt;&lt;br&gt;   &lt;vcpu \
placement='static'&gt;1&lt;/vcpu&gt;&lt;br&gt;   &lt;os&gt;&lt;br&gt;      &lt;type \
arch='x86_64'&gt;exe&lt;/type&gt;&lt;br&gt;      \
&lt;init&gt;/sbin/init&lt;/init&gt;&lt;br&gt;   &lt;/os&gt;&lt;br&gt;   &lt;devices&gt;&lt;br&gt;      \
&lt;emulator&gt;/usr/sbin/libvirt_lxc&lt;/emulator&gt;&lt;br&gt;      &lt;filesystem \
type='mount' accessmode='passthrough'&gt;&lt;br&gt;         &lt;source \
dir='/vol/usb1/iox/repo-lxc/utd/rootfs_mnt'/&gt;&lt;br&gt;         &lt;target \
dir='/'/&gt;&lt;br&gt;      &lt;/filesystem&gt;&lt;br&gt;      &lt;filesystem \
type='mount' accessmode='passthrough'&gt;&lt;br&gt;         &lt;source \
dir='/flash/dir'/&gt;&lt;br&gt;         &lt;target \
dir='/flash/dir'/&gt;&lt;br&gt;      &lt;/filesystem&gt;&lt;br&gt;      &lt;console \
type='pty'&gt;&lt;br&gt;         &lt;target type='lxc' \
port='2'/&gt;&lt;br&gt;      &lt;/console&gt;&lt;br&gt;   \
&lt;/devices&gt;&lt;br&gt;&lt;/domain&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div \
dir="ltr" class="gmail_attr"&gt;On Wed, Jun 23, 2021 at 1:46 PM Michal Prívozník \
&lt;&lt;a href="mailto:mprivozn@redhat.com"&gt;mprivozn@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;On 6/22/21 6:17 PM, \
Priyanka Gupta wrote:&lt;br&gt; &gt; Hi,&lt;br&gt;
&gt; &lt;br&gt;
&gt; Could someone pls let me know when this condition could possibly arise?&lt;br&gt;
&gt; lxcContainerResolveSymlinks:621 : Skipped unaccessible  '/flash/dir'&lt;br&gt;
&gt; &lt;br&gt;
&gt; The code seems to call access('/flash/dir', F_OK) which shall only \
check&lt;br&gt; &gt; for existence  of this directory  '/flash/dir'.  I have this \
directory&lt;br&gt; &gt; created on my host. Is there anything that I am missing?&lt;br&gt;
&gt; &lt;br&gt;
&lt;br&gt;
Hey, looking into the code the function is ran from a mount namespace&lt;br&gt;
thus the path may not exist. But is there a problem you are seeing? If&lt;br&gt;
so, can you share your LXC XML and describe the problem? I mean, the&lt;br&gt;
message you mention is just a debug printing, harmless.&lt;br&gt;
&lt;br&gt;
Michal&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;



</body></email><email><emailId>20210623093456</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-06-23 09:34:56-0400</timestampReceived><subject>Re: unaccessible directory in lxcContainerResolveSymlinks</subject><body>

On 6/23/21 11:28 AM, Priyanka Gupta wrote:
&gt; Hi,
&gt; 
&gt; If I try to add only /flash (without dir subdirerctory) into the XML, it
&gt; works fine for me.
&gt; Does it matter what sort of permissions(user/grp) /flash/dir has? 

A-ha! It can happen that root can't access some directories even though
a regular user can. Typically, fuse mounts (unless explicitly allowed
when mounting). So it does matter, yeah.

Michal

</body></email><email><emailId>20210621093524</emailId><senderName>Pavel Hrdina</senderName><senderEmail>phrdina@redhat.com</senderEmail><timestampReceived>2021-06-21 09:35:24-0400</timestampReceived><subject>Re: driver_remote option defaults to auto</subject><body>


On Sun, Jun 20, 2021 at 05:10:40PM +0800, Jiatong Shen wrote:
&gt; Hello community,
&gt; 
&gt; I am looking at building and packaging libvirt source code. I am seeing
&gt; from commit
&gt; https://github.com/libvirt/libvirt/commit/83ff55b5a2618d32f623d7ca0b6f9c28b7253972
&gt; `driver_remote` is defaulting to auto which is different from enabled
&gt; before. I am curious what does auto mean? does it mean that meson will take
&gt; over and determine if driver_remote should be enabled or we have to write
&gt; more logic in meson.build? currently it seems there is no effort to auto
&gt; determine driver_remote. I think it is interesting because
&gt; https://github.com/libvirt/libvirt/blob/54b602019d7dfa94a6c52ef7aa3abdfaa93ed233/meson.build#L1178
&gt; sasl seems required remote_driver to have a value of enabled...

Hi,

I see how this may be confusing. The current code is correct and there
is no need to change anything as this one way how it can be done with
meson.

If some option is 'feature' type and the default value is set to 'auto'
this is what meson returns:

    get_option('opt').disabled()  -&gt;  false
    get_option('opt').auto()      -&gt;  true
    get_option('opt').enabled()   -&gt;  false

In the case of 'driver_remote' option we have the following check:

    if not get_option('driver_remote').disabled()

which means that it will disable 'driver_remote' only if user calls
meson with `-Ddriver_remote=disabled`.

If you look closer to the following lines you will see that we also
check for xdr_dep. If xdr_dep is missing and 'driver_remote' is set
to 'auto' it will not be enabled as XDR is required, but if
'driver_remote' is set to 'enabled' but user calling meson with
`-Ddriver_remote=enabled` meson will fail with proper error message.

Before the changes done by the first commit you mentioned the
'driver_remote' was always enabled and if XDR was missing it always
failed and user had to explicitly use `-Ddriver_remote=disabled` on
systems where XDR is not available or if the user was not interested
in having 'driver_remote' available.

Pavel

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20210614082148</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-06-14 08:21:48-0400</timestampReceived><subject>Re: the SSL cert of libvirt.org is outdated</subject><body>

On Mon, Jun 14, 2021 at 02:14:32PM +0800, 伍翀 wrote:
&gt; hi, there,
&gt; 
&gt; the SSL cert of libvirt.org is outdated, could anyone replace it as new one?

Unfortunately the auto-renew process has broken, and it appears to not
be quickly fixable because LetsEncrypt have disabled the v1 ACME API
that our script. I'll need to figure out and deploy a new tool for
acquiring certs.

Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20210611093349</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-06-11 09:33:49-0400</timestampReceived><subject>Re: interface qos conflicts with ovs</subject><body>

On 6/11/21 2:02 AM, Jiatong Shen wrote:
&gt; Hello community,
&gt; 
&gt; We found a strange situation where interface qos is being cleared up. After
&gt; some search, looks like ovs will clear tc setting at least on ingress.
&gt; 
&gt; related code is
&gt; https://github.com/openvswitch/ovs/blob/91cb55bc8aad7fe17060778482dc7ad18dc0d9a8/lib/netdev-linux.c#L2727
&gt;  
&gt; so I would like to know if it is more ideal to set ovs port qos and replace
&gt; current tc when ovs port is used? thank you
&gt; 

Yes, this is known bug:

https://bugzilla.redhat.com/show_bug.cgi?id=1510237

Unfortunately, it hasn't gotten much attention. Libvirt should use ovs
to set up QoS instead of TC because ovs keeps the desired state of TAP
and will clear out anything that goes against it.

Michal


</body></email><email><emailId>20210610095552</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>dan@berrange.com</senderEmail><timestampReceived>2021-06-10 09:55:52-0400</timestampReceived><subject>Re: why cannot connect to libvirtd using virsh ???</subject><body>

On Thu, Jun 10, 2021 at 05:37:43PM +0800, tommy wrote:
&gt; [root@test2 ~]# virsh -c quem+ssh://root@192.168.10.175/system
&gt; 
&gt; root@192.168.10.175's &lt;mailto:root@192.168.10.175's&gt;  password:
&gt; 
&gt; error: failed to connect to the hypervisor
&gt; 
&gt; error: no connection driver available for quem:///system

You've typod -   'quem' should be 'qemu'

Regards,
Daniel
--
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20210610095952</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-06-10 09:59:52-0400</timestampReceived><subject>Re: why cannot connect to libvirtd using virsh ???</subject><body>

On Thu, Jun 10, 2021 at 17:37:43 +0800, tommy wrote:
&gt; [root@test2 ~]# virsh -c quem+ssh://root@192.168.10.175/system
&gt; 
&gt; root@192.168.10.175's &lt;mailto:root@192.168.10.175's&gt;  password:
&gt; 
&gt; error: failed to connect to the hypervisor
&gt; 
&gt; error: no connection driver available for quem:///system

You've got a typo here, you wrote "quem" but it's "qemu".

</body></email><email><emailId>20210604005646</emailId><senderName>Link Dupont</senderName><senderEmail>link@sub-pop.net</senderEmail><timestampReceived>2021-06-04 00:56:46-0400</timestampReceived><subject>Re: [Virtio-fs] virtiofs mounted filesystems &amp; SELinux</subject><body>

On Thu, Jun 3 2021 at 08:24:02 PM +0100, Dr. David Alan Gilbert 
&lt;dgilbert@redhat.com&gt; wrote:
&gt; (I'm not sure el7 had 9p either??)

Oh drat. I'm conflating my issues. I have an EL7 guest that is having a 
similar problem, except the guest sees the files as type nfs_t. I guess 
the symptoms are the same, but the solutions won't necessarily. Let me 
try and scale these down to reproducible scenarios.


</body></email><email><emailId>20210604021424</emailId><senderName>Link Dupont</senderName><senderEmail>link@sub-pop.net</senderEmail><timestampReceived>2021-06-04 02:14:24-0400</timestampReceived><subject>Re: [Virtio-fs] virtiofs mounted filesystems &amp; SELinux</subject><body>

On Thu, Jun 3 2021 at 08:56:46 PM -0400, Link Dupont &lt;link@sub-pop.net&gt; 
wrote:
&gt;  reproducible scenarios

Alright. I reran my tests with a CentOS 8 guest. On CentOS 8 (with a 
virtiofs filesystem and with xattr on), the type of files in the 
mounted hierarchy are unlabeled_t. I can work around that by switching 
SELinux in the guest to permissive or disabled.

With a CentOS 7 guest, things get less usable. I digested this to a 
reproducible scenario.

Build a disk image with `virt-builder`, configuring the CentOS Plus 
kernel to get 9p support.

virt-builder centos-7.8 \
 --root-password password:centos \
 --output centos-7.8.qcow2 \
 --install yum-utils \
 --run-command 'yum-config-manager --enable centosplus' \
 --run-command 'sed -ie 
"s/DEFAULTKERNEL=kernel/DEFAULTKERNEL=kernel-plus/" 
/etc/sysconfig/kernel' \
 --append-line 
'/etc/dracut.conf.d/virtio.conf:add_drivers+="virtio_scsi virtio_pci 
virtio_console"' \
 --append-line '/etc/modules-load.d/9pnet_virtio.conf:9pnet_virtio' \
 --install kernel-plus \
 --append-line '/etc/fstab:home /home 9p trans=virtio,version=9p2000.L 
0 0'

Install the volume into the `default` pool.

sudo install -m644 centos-7.8.qcow2 /var/lib/libvirt/images

Next, define a domain using the disk image (using `virt-install` here 
for "easy mode").

virt-install \
 --import \
 --os-variant centos7.0 \
 --name centos \
 --ram 2048 \
 --disk path=/var/lib/libvirt/images/centos-7.8.qcow2 \
 --memorybacking access.mode=shared \
 --filesystem source=/home,target=home,accessmode=passthrough \
 --autoconsole none

Now with SELinux enforcing, I cannot list the contents of the 
directories in the mounted hierarchy.

[root@localhost ~]# ls -lZ /home/link
ls: cannot open directory /home/link: Permission denied



</body></email><email><emailId>20210604134439</emailId><senderName>Vivek Goyal</senderName><senderEmail>vgoyal@redhat.com</senderEmail><timestampReceived>2021-06-04 13:44:39-0400</timestampReceived><subject>Re: [Virtio-fs] virtiofs mounted filesystems &amp; SELinux</subject><body>

On Thu, Jun 03, 2021 at 10:14:24PM -0400, Link Dupont wrote:
&gt; On Thu, Jun 3 2021 at 08:56:46 PM -0400, Link Dupont &lt;link@sub-pop.net&gt;
&gt; wrote:
&gt; &gt;  reproducible scenarios
&gt; 
&gt; Alright. I reran my tests with a CentOS 8 guest. On CentOS 8 (with a
&gt; virtiofs filesystem and with xattr on), the type of files in the mounted
&gt; hierarchy are unlabeled_t. I can work around that by switching SELinux in
&gt; the guest to permissive or disabled.

cc Dan Walsh. I was discussing this with Dan Walsh yesterday in general.

In general, if we want to enable SELinux both on host and guest, then
both host and guest should have same SELinux policy. Otherwise there
will be lot of different kind of conflicts because both host and
guest will try to work with same selinux label. I guess that in
practice this will be very hard to achieve as people will run
different host and guest flavors and these might have different
policies.

So another option is to rename selinux xattr in virtiofs so that
any selinux xattr coming from guest is saved as
user.virtiofs.security.selinux xattr on host. That way host and guest
can have their separate labels without interfering with each other.
David Gilbert already has added support for this. I can't remember
the exact syntax but you can figure it out from documentation here
in xattr remappig section.

https://github.com/qemu/qemu/blob/master/docs/tools/virtiofsd.rst

But I have question with selinux xattr remapping. What will happen
to initial labels when fs is exported. I mean until and unless
some process in guest labels all the exported files, they all
with either be unlabeled or pick some generic label for all the
files.

Another option is, can we use a single label for whole of the
virtiofs (using context=&lt;label&gt;) option in guest. That way nothing
is saved in files as such. But this means that processes in guest
can't have different selinux labels on different virtiofs dir/files.

Dan, what do you think?

Thanks
Vivek


&gt; 
&gt; With a CentOS 7 guest, things get less usable. I digested this to a
&gt; reproducible scenario.
&gt; 
&gt; Build a disk image with `virt-builder`, configuring the CentOS Plus kernel
&gt; to get 9p support.
&gt; 
&gt; virt-builder centos-7.8 \
&gt; --root-password password:centos \
&gt; --output centos-7.8.qcow2 \
&gt; --install yum-utils \
&gt; --run-command 'yum-config-manager --enable centosplus' \
&gt; --run-command 'sed -ie "s/DEFAULTKERNEL=kernel/DEFAULTKERNEL=kernel-plus/"
&gt; /etc/sysconfig/kernel' \
&gt; --append-line '/etc/dracut.conf.d/virtio.conf:add_drivers+="virtio_scsi
&gt; virtio_pci virtio_console"' \
&gt; --append-line '/etc/modules-load.d/9pnet_virtio.conf:9pnet_virtio' \
&gt; --install kernel-plus \
&gt; --append-line '/etc/fstab:home /home 9p trans=virtio,version=9p2000.L 0 0'
&gt; 
&gt; Install the volume into the `default` pool.
&gt; 
&gt; sudo install -m644 centos-7.8.qcow2 /var/lib/libvirt/images
&gt; 
&gt; Next, define a domain using the disk image (using `virt-install` here for
&gt; "easy mode").
&gt; 
&gt; virt-install \
&gt; --import \
&gt; --os-variant centos7.0 \
&gt; --name centos \
&gt; --ram 2048 \
&gt; --disk path=/var/lib/libvirt/images/centos-7.8.qcow2 \
&gt; --memorybacking access.mode=shared \
&gt; --filesystem source=/home,target=home,accessmode=passthrough \
&gt; --autoconsole none
&gt; 
&gt; Now with SELinux enforcing, I cannot list the contents of the directories in
&gt; the mounted hierarchy.
&gt; 
&gt; [root@localhost ~]# ls -lZ /home/link
&gt; ls: cannot open directory /home/link: Permission denied
&gt; 
&gt; 
&gt; 
&gt; _______________________________________________
&gt; Virtio-fs mailing list
&gt; Virtio-fs@redhat.com
&gt; https://listman.redhat.com/mailman/listinfo/virtio-fs
&gt; 

</body></email><email><emailId>20210604135929</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-06-04 13:59:29-0400</timestampReceived><subject>Re: [Virtio-fs] virtiofs mounted filesystems &amp; SELinux</subject><body>

On Fri, Jun 04, 2021 at 09:44:39AM -0400, Vivek Goyal wrote:
&gt; On Thu, Jun 03, 2021 at 10:14:24PM -0400, Link Dupont wrote:
&gt; &gt; On Thu, Jun 3 2021 at 08:56:46 PM -0400, Link Dupont &lt;link@sub-pop.net&gt;
&gt; &gt; wrote:
&gt; &gt; &gt;  reproducible scenarios
&gt; &gt; 
&gt; &gt; Alright. I reran my tests with a CentOS 8 guest. On CentOS 8 (with a
&gt; &gt; virtiofs filesystem and with xattr on), the type of files in the mounted
&gt; &gt; hierarchy are unlabeled_t. I can work around that by switching SELinux in
&gt; &gt; the guest to permissive or disabled.
&gt; 
&gt; cc Dan Walsh. I was discussing this with Dan Walsh yesterday in general.
&gt; 
&gt; In general, if we want to enable SELinux both on host and guest, then
&gt; both host and guest should have same SELinux policy. Otherwise there
&gt; will be lot of different kind of conflicts because both host and
&gt; guest will try to work with same selinux label. I guess that in
&gt; practice this will be very hard to achieve as people will run
&gt; different host and guest flavors and these might have different
&gt; policies.

Yeah, I think there's little to no chance of people keeping the
same SELinux policy in host/guest, except in very tightly controlled
narrow use cases where the host admin exerts direct control over
the precise guest config.


&gt; So another option is to rename selinux xattr in virtiofs so that
&gt; any selinux xattr coming from guest is saved as
&gt; user.virtiofs.security.selinux xattr on host. That way host and guest
&gt; can have their separate labels without interfering with each other.
&gt; David Gilbert already has added support for this. I can't remember
&gt; the exact syntax but you can figure it out from documentation here
&gt; in xattr remappig section.

For general purpose virt usage, I think remapping in some way is
likely to be needed as the default strategy.

&gt; https://github.com/qemu/qemu/blob/master/docs/tools/virtiofsd.rst
&gt; 
&gt; But I have question with selinux xattr remapping. What will happen
&gt; to initial labels when fs is exported. I mean until and unless
&gt; some process in guest labels all the exported files, they all
&gt; with either be unlabeled or pick some generic label for all the
&gt; files.

I'd say you need some mechanism to force a re-label inside the
guest. Normally a relabel will be done in /.autorelabel file
is present, or in certain other scenarios like selinux policy
RPM updates.

We wouldn't want to force a relabel neccesarily for the entire
FS if we're just hotplugging a new virtiofs export though. So
perhaps there's scope for supporting usage of a per-mount
point relabel trigger. eg Host creates $VIRTIOFS-ROOT/.autorelabel
and whenever the guest sees a new virtiofs export arriving, it
can look for $VIRTIOFS-MOUNT-POINT/.autorelabel

&gt; Another option is, can we use a single label for whole of the
&gt; virtiofs (using context=&lt;label&gt;) option in guest. That way nothing
&gt; is saved in files as such. But this means that processes in guest
&gt; can't have different selinux labels on different virtiofs dir/files.

Forcing a single label for the entire export is passable as a
fallback plan. This is what people have done for years with
NFS v3 mounts. It has annoying usage limitations though, so
if at all possible remapping is a preferrable approach.

&gt; 
&gt; Dan, what do you think?
&gt; 
&gt; Thanks
&gt; Vivek
&gt; 
&gt; 
&gt; &gt; 
&gt; &gt; With a CentOS 7 guest, things get less usable. I digested this to a
&gt; &gt; reproducible scenario.
&gt; &gt; 
&gt; &gt; Build a disk image with `virt-builder`, configuring the CentOS Plus kernel
&gt; &gt; to get 9p support.
&gt; &gt; 
&gt; &gt; virt-builder centos-7.8 \
&gt; &gt; --root-password password:centos \
&gt; &gt; --output centos-7.8.qcow2 \
&gt; &gt; --install yum-utils \
&gt; &gt; --run-command 'yum-config-manager --enable centosplus' \
&gt; &gt; --run-command 'sed -ie "s/DEFAULTKERNEL=kernel/DEFAULTKERNEL=kernel-plus/"
&gt; &gt; /etc/sysconfig/kernel' \
&gt; &gt; --append-line '/etc/dracut.conf.d/virtio.conf:add_drivers+="virtio_scsi
&gt; &gt; virtio_pci virtio_console"' \
&gt; &gt; --append-line '/etc/modules-load.d/9pnet_virtio.conf:9pnet_virtio' \
&gt; &gt; --install kernel-plus \
&gt; &gt; --append-line '/etc/fstab:home /home 9p trans=virtio,version=9p2000.L 0 0'
&gt; &gt; 
&gt; &gt; Install the volume into the `default` pool.
&gt; &gt; 
&gt; &gt; sudo install -m644 centos-7.8.qcow2 /var/lib/libvirt/images
&gt; &gt; 
&gt; &gt; Next, define a domain using the disk image (using `virt-install` here for
&gt; &gt; "easy mode").
&gt; &gt; 
&gt; &gt; virt-install \
&gt; &gt; --import \
&gt; &gt; --os-variant centos7.0 \
&gt; &gt; --name centos \
&gt; &gt; --ram 2048 \
&gt; &gt; --disk path=/var/lib/libvirt/images/centos-7.8.qcow2 \
&gt; &gt; --memorybacking access.mode=shared \
&gt; &gt; --filesystem source=/home,target=home,accessmode=passthrough \
&gt; &gt; --autoconsole none
&gt; &gt; 
&gt; &gt; Now with SELinux enforcing, I cannot list the contents of the directories in
&gt; &gt; the mounted hierarchy.
&gt; &gt; 
&gt; &gt; [root@localhost ~]# ls -lZ /home/link
&gt; &gt; ls: cannot open directory /home/link: Permission denied
&gt; &gt; 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; _______________________________________________
&gt; &gt; Virtio-fs mailing list
&gt; &gt; Virtio-fs@redhat.com
&gt; &gt; https://listman.redhat.com/mailman/listinfo/virtio-fs
&gt; &gt; 
&gt; 

Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20210604144313</emailId><senderName>Vivek Goyal</senderName><senderEmail>vgoyal@redhat.com</senderEmail><timestampReceived>2021-06-04 14:43:13-0400</timestampReceived><subject>Re: [Virtio-fs] virtiofs mounted filesystems &amp; SELinux</subject><body>

On Fri, Jun 04, 2021 at 02:59:29PM +0100, Daniel P. Berrangé wrote:
&gt; On Fri, Jun 04, 2021 at 09:44:39AM -0400, Vivek Goyal wrote:
&gt; &gt; On Thu, Jun 03, 2021 at 10:14:24PM -0400, Link Dupont wrote:
&gt; &gt; &gt; On Thu, Jun 3 2021 at 08:56:46 PM -0400, Link Dupont &lt;link@sub-pop.net&gt;
&gt; &gt; &gt; wrote:
&gt; &gt; &gt; &gt;  reproducible scenarios
&gt; &gt; &gt; 
&gt; &gt; &gt; Alright. I reran my tests with a CentOS 8 guest. On CentOS 8 (with a
&gt; &gt; &gt; virtiofs filesystem and with xattr on), the type of files in the mounted
&gt; &gt; &gt; hierarchy are unlabeled_t. I can work around that by switching SELinux in
&gt; &gt; &gt; the guest to permissive or disabled.
&gt; &gt; 
&gt; &gt; cc Dan Walsh. I was discussing this with Dan Walsh yesterday in general.
&gt; &gt; 
&gt; &gt; In general, if we want to enable SELinux both on host and guest, then
&gt; &gt; both host and guest should have same SELinux policy. Otherwise there
&gt; &gt; will be lot of different kind of conflicts because both host and
&gt; &gt; guest will try to work with same selinux label. I guess that in
&gt; &gt; practice this will be very hard to achieve as people will run
&gt; &gt; different host and guest flavors and these might have different
&gt; &gt; policies.
&gt; 
&gt; Yeah, I think there's little to no chance of people keeping the
&gt; same SELinux policy in host/guest, except in very tightly controlled
&gt; narrow use cases where the host admin exerts direct control over
&gt; the precise guest config.
&gt; 
&gt; 
&gt; &gt; So another option is to rename selinux xattr in virtiofs so that
&gt; &gt; any selinux xattr coming from guest is saved as
&gt; &gt; user.virtiofs.security.selinux xattr on host. That way host and guest
&gt; &gt; can have their separate labels without interfering with each other.
&gt; &gt; David Gilbert already has added support for this. I can't remember
&gt; &gt; the exact syntax but you can figure it out from documentation here
&gt; &gt; in xattr remappig section.
&gt; 
&gt; For general purpose virt usage, I think remapping in some way is
&gt; likely to be needed as the default strategy.
&gt; 
&gt; &gt; https://github.com/qemu/qemu/blob/master/docs/tools/virtiofsd.rst
&gt; &gt; 
&gt; &gt; But I have question with selinux xattr remapping. What will happen
&gt; &gt; to initial labels when fs is exported. I mean until and unless
&gt; &gt; some process in guest labels all the exported files, they all
&gt; &gt; with either be unlabeled or pick some generic label for all the
&gt; &gt; files.
&gt; 
&gt; I'd say you need some mechanism to force a re-label inside the
&gt; guest. Normally a relabel will be done in /.autorelabel file
&gt; is present, or in certain other scenarios like selinux policy
&gt; RPM updates.
&gt; 
&gt; We wouldn't want to force a relabel neccesarily for the entire
&gt; FS if we're just hotplugging a new virtiofs export though. So
&gt; perhaps there's scope for supporting usage of a per-mount
&gt; point relabel trigger. eg Host creates $VIRTIOFS-ROOT/.autorelabel
&gt; and whenever the guest sees a new virtiofs export arriving, it
&gt; can look for $VIRTIOFS-MOUNT-POINT/.autorelabel

Per mount point auto relabel seems interesting. Will it relabel
everytime virtiofs export shows up. Or it will intelligence to
figure out exported fs is already labeled (say from previous boot)
and no need to relabel again.

&gt; 
&gt; &gt; Another option is, can we use a single label for whole of the
&gt; &gt; virtiofs (using context=&lt;label&gt;) option in guest. That way nothing
&gt; &gt; is saved in files as such. But this means that processes in guest
&gt; &gt; can't have different selinux labels on different virtiofs dir/files.
&gt; 
&gt; Forcing a single label for the entire export is passable as a
&gt; fallback plan. This is what people have done for years with
&gt; NFS v3 mounts.

Aha, good to know.

&gt; It has annoying usage limitations though, so
&gt; if at all possible remapping is a preferrable approach.

Agreed that this appraoch will have more limitations as comapred to
selinux xattr remapping + autorelabel. At the same time, this is the
simplest approach to begin with. And one does not pay the penalty
of relabeling files.

Maybe this can be the default and we document that how to enable
proper selinux support by using xattr remapping + autorelabel.

Thanks
Vivek

&gt; 
&gt; &gt; 
&gt; &gt; Dan, what do you think?
&gt; &gt; 
&gt; &gt; Thanks
&gt; &gt; Vivek
&gt; &gt; 
&gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; With a CentOS 7 guest, things get less usable. I digested this to a
&gt; &gt; &gt; reproducible scenario.
&gt; &gt; &gt; 
&gt; &gt; &gt; Build a disk image with `virt-builder`, configuring the CentOS Plus kernel
&gt; &gt; &gt; to get 9p support.
&gt; &gt; &gt; 
&gt; &gt; &gt; virt-builder centos-7.8 \
&gt; &gt; &gt; --root-password password:centos \
&gt; &gt; &gt; --output centos-7.8.qcow2 \
&gt; &gt; &gt; --install yum-utils \
&gt; &gt; &gt; --run-command 'yum-config-manager --enable centosplus' \
&gt; &gt; &gt; --run-command 'sed -ie "s/DEFAULTKERNEL=kernel/DEFAULTKERNEL=kernel-plus/"
&gt; &gt; &gt; /etc/sysconfig/kernel' \
&gt; &gt; &gt; --append-line '/etc/dracut.conf.d/virtio.conf:add_drivers+="virtio_scsi
&gt; &gt; &gt; virtio_pci virtio_console"' \
&gt; &gt; &gt; --append-line '/etc/modules-load.d/9pnet_virtio.conf:9pnet_virtio' \
&gt; &gt; &gt; --install kernel-plus \
&gt; &gt; &gt; --append-line '/etc/fstab:home /home 9p trans=virtio,version=9p2000.L 0 0'
&gt; &gt; &gt; 
&gt; &gt; &gt; Install the volume into the `default` pool.
&gt; &gt; &gt; 
&gt; &gt; &gt; sudo install -m644 centos-7.8.qcow2 /var/lib/libvirt/images
&gt; &gt; &gt; 
&gt; &gt; &gt; Next, define a domain using the disk image (using `virt-install` here for
&gt; &gt; &gt; "easy mode").
&gt; &gt; &gt; 
&gt; &gt; &gt; virt-install \
&gt; &gt; &gt; --import \
&gt; &gt; &gt; --os-variant centos7.0 \
&gt; &gt; &gt; --name centos \
&gt; &gt; &gt; --ram 2048 \
&gt; &gt; &gt; --disk path=/var/lib/libvirt/images/centos-7.8.qcow2 \
&gt; &gt; &gt; --memorybacking access.mode=shared \
&gt; &gt; &gt; --filesystem source=/home,target=home,accessmode=passthrough \
&gt; &gt; &gt; --autoconsole none
&gt; &gt; &gt; 
&gt; &gt; &gt; Now with SELinux enforcing, I cannot list the contents of the directories in
&gt; &gt; &gt; the mounted hierarchy.
&gt; &gt; &gt; 
&gt; &gt; &gt; [root@localhost ~]# ls -lZ /home/link
&gt; &gt; &gt; ls: cannot open directory /home/link: Permission denied
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; _______________________________________________
&gt; &gt; &gt; Virtio-fs mailing list
&gt; &gt; &gt; Virtio-fs@redhat.com
&gt; &gt; &gt; https://listman.redhat.com/mailman/listinfo/virtio-fs
&gt; &gt; &gt; 
&gt; &gt; 
&gt; 
&gt; Regards,
&gt; Daniel
&gt; -- 
&gt; |: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
&gt; |: https://libvirt.org         -o-            https://fstop138.berrange.com :|
&gt; |: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|
&gt; 

</body></email><email><emailId>20210604145201</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-06-04 14:52:01-0400</timestampReceived><subject>Re: [Virtio-fs] virtiofs mounted filesystems &amp; SELinux</subject><body>

On Fri, Jun 04, 2021 at 10:43:13AM -0400, Vivek Goyal wrote:
&gt; On Fri, Jun 04, 2021 at 02:59:29PM +0100, Daniel P. Berrangé wrote:
&gt; &gt; On Fri, Jun 04, 2021 at 09:44:39AM -0400, Vivek Goyal wrote:
&gt; &gt; &gt; On Thu, Jun 03, 2021 at 10:14:24PM -0400, Link Dupont wrote:
&gt; &gt; &gt; &gt; On Thu, Jun 3 2021 at 08:56:46 PM -0400, Link Dupont &lt;link@sub-pop.net&gt;
&gt; &gt; &gt; &gt; wrote:
&gt; &gt; &gt; &gt; &gt;  reproducible scenarios
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Alright. I reran my tests with a CentOS 8 guest. On CentOS 8 (with a
&gt; &gt; &gt; &gt; virtiofs filesystem and with xattr on), the type of files in the mounted
&gt; &gt; &gt; &gt; hierarchy are unlabeled_t. I can work around that by switching SELinux in
&gt; &gt; &gt; &gt; the guest to permissive or disabled.
&gt; &gt; &gt; 
&gt; &gt; &gt; cc Dan Walsh. I was discussing this with Dan Walsh yesterday in general.
&gt; &gt; &gt; 
&gt; &gt; &gt; In general, if we want to enable SELinux both on host and guest, then
&gt; &gt; &gt; both host and guest should have same SELinux policy. Otherwise there
&gt; &gt; &gt; will be lot of different kind of conflicts because both host and
&gt; &gt; &gt; guest will try to work with same selinux label. I guess that in
&gt; &gt; &gt; practice this will be very hard to achieve as people will run
&gt; &gt; &gt; different host and guest flavors and these might have different
&gt; &gt; &gt; policies.
&gt; &gt; 
&gt; &gt; Yeah, I think there's little to no chance of people keeping the
&gt; &gt; same SELinux policy in host/guest, except in very tightly controlled
&gt; &gt; narrow use cases where the host admin exerts direct control over
&gt; &gt; the precise guest config.
&gt; &gt; 
&gt; &gt; 
&gt; &gt; &gt; So another option is to rename selinux xattr in virtiofs so that
&gt; &gt; &gt; any selinux xattr coming from guest is saved as
&gt; &gt; &gt; user.virtiofs.security.selinux xattr on host. That way host and guest
&gt; &gt; &gt; can have their separate labels without interfering with each other.
&gt; &gt; &gt; David Gilbert already has added support for this. I can't remember
&gt; &gt; &gt; the exact syntax but you can figure it out from documentation here
&gt; &gt; &gt; in xattr remappig section.
&gt; &gt; 
&gt; &gt; For general purpose virt usage, I think remapping in some way is
&gt; &gt; likely to be needed as the default strategy.
&gt; &gt; 
&gt; &gt; &gt; https://github.com/qemu/qemu/blob/master/docs/tools/virtiofsd.rst
&gt; &gt; &gt; 
&gt; &gt; &gt; But I have question with selinux xattr remapping. What will happen
&gt; &gt; &gt; to initial labels when fs is exported. I mean until and unless
&gt; &gt; &gt; some process in guest labels all the exported files, they all
&gt; &gt; &gt; with either be unlabeled or pick some generic label for all the
&gt; &gt; &gt; files.
&gt; &gt; 
&gt; &gt; I'd say you need some mechanism to force a re-label inside the
&gt; &gt; guest. Normally a relabel will be done in /.autorelabel file
&gt; &gt; is present, or in certain other scenarios like selinux policy
&gt; &gt; RPM updates.
&gt; &gt; 
&gt; &gt; We wouldn't want to force a relabel neccesarily for the entire
&gt; &gt; FS if we're just hotplugging a new virtiofs export though. So
&gt; &gt; perhaps there's scope for supporting usage of a per-mount
&gt; &gt; point relabel trigger. eg Host creates $VIRTIOFS-ROOT/.autorelabel
&gt; &gt; and whenever the guest sees a new virtiofs export arriving, it
&gt; &gt; can look for $VIRTIOFS-MOUNT-POINT/.autorelabel
&gt; 
&gt; Per mount point auto relabel seems interesting. Will it relabel
&gt; everytime virtiofs export shows up. Or it will intelligence to
&gt; figure out exported fs is already labeled (say from previous boot)
&gt; and no need to relabel again.

Normal behaviour with the existing global /.autorelabel is that
selinux deletes the file once the relabel is complete, so it is
a one-time thing.

Essentially anytime you need to force[1] a one-time only relabel you
just do

   "touch /.autorelabel &amp;&amp; reboot"


DanW does however recommend that you configure your system such
that the labels are always correct and thus don't need the global
relabel. https://danwalsh.livejournal.com/38157.html

None the less I think the virtiofs situation is slightly different
and justifies a way to force relabel, provided it can be scoped
to just that one filesystem mount.

Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20210607130108</emailId><senderName>Daniel Walsh</senderName><senderEmail>dwalsh@redhat.com</senderEmail><timestampReceived>2021-06-07 13:01:08-0400</timestampReceived><subject>Re: [Virtio-fs] virtiofs mounted filesystems &amp; SELinux</subject><body>

On 6/4/21 09:59, Daniel P. Berrangé wrote:
&gt; On Fri, Jun 04, 2021 at 09:44:39AM -0400, Vivek Goyal wrote:
&gt;&gt; On Thu, Jun 03, 2021 at 10:14:24PM -0400, Link Dupont wrote:
&gt;&gt;&gt; On Thu, Jun 3 2021 at 08:56:46 PM -0400, Link Dupont &lt;link@sub-pop.net&gt;
&gt;&gt;&gt; wrote:
&gt;&gt;&gt;&gt;   reproducible scenarios
&gt;&gt;&gt; Alright. I reran my tests with a CentOS 8 guest. On CentOS 8 (with a
&gt;&gt;&gt; virtiofs filesystem and with xattr on), the type of files in the mounted
&gt;&gt;&gt; hierarchy are unlabeled_t. I can work around that by switching SELinux in
&gt;&gt;&gt; the guest to permissive or disabled.
&gt;&gt; cc Dan Walsh. I was discussing this with Dan Walsh yesterday in general.
&gt;&gt;
&gt;&gt; In general, if we want to enable SELinux both on host and guest, then
&gt;&gt; both host and guest should have same SELinux policy. Otherwise there
&gt;&gt; will be lot of different kind of conflicts because both host and
&gt;&gt; guest will try to work with same selinux label. I guess that in
&gt;&gt; practice this will be very hard to achieve as people will run
&gt;&gt; different host and guest flavors and these might have different
&gt;&gt; policies.
&gt; Yeah, I think there's little to no chance of people keeping the
&gt; same SELinux policy in host/guest, except in very tightly controlled
&gt; narrow use cases where the host admin exerts direct control over
&gt; the precise guest config.
&gt;
&gt;
&gt;&gt; So another option is to rename selinux xattr in virtiofs so that
&gt;&gt; any selinux xattr coming from guest is saved as
&gt;&gt; user.virtiofs.security.selinux xattr on host. That way host and guest
&gt;&gt; can have their separate labels without interfering with each other.
&gt;&gt; David Gilbert already has added support for this. I can't remember
&gt;&gt; the exact syntax but you can figure it out from documentation here
&gt;&gt; in xattr remappig section.
&gt; For general purpose virt usage, I think remapping in some way is
&gt; likely to be needed as the default strategy.
&gt;
&gt;&gt; https://github.com/qemu/qemu/blob/master/docs/tools/virtiofsd.rst
&gt;&gt;
&gt;&gt; But I have question with selinux xattr remapping. What will happen
&gt;&gt; to initial labels when fs is exported. I mean until and unless
&gt;&gt; some process in guest labels all the exported files, they all
&gt;&gt; with either be unlabeled or pick some generic label for all the
&gt;&gt; files.
&gt; I'd say you need some mechanism to force a re-label inside the
&gt; guest. Normally a relabel will be done in /.autorelabel file
&gt; is present, or in certain other scenarios like selinux policy
&gt; RPM updates.
&gt;
&gt; We wouldn't want to force a relabel neccesarily for the entire
&gt; FS if we're just hotplugging a new virtiofs export though. So
&gt; perhaps there's scope for supporting usage of a per-mount
&gt; point relabel trigger. eg Host creates $VIRTIOFS-ROOT/.autorelabel
&gt; and whenever the guest sees a new virtiofs export arriving, it
&gt; can look for $VIRTIOFS-MOUNT-POINT/.autorelabel
&gt;
&gt;&gt; Another option is, can we use a single label for whole of the
&gt;&gt; virtiofs (using context=&lt;label&gt;) option in guest. That way nothing
&gt;&gt; is saved in files as such. But this means that processes in guest
&gt;&gt; can't have different selinux labels on different virtiofs dir/files.
&gt; Forcing a single label for the entire export is passable as a
&gt; fallback plan. This is what people have done for years with
&gt; NFS v3 mounts. It has annoying usage limitations though, so
&gt; if at all possible remapping is a preferrable approach.
&gt;
&gt;&gt; Dan, what do you think?
&gt;&gt;
&gt;&gt; Thanks
&gt;&gt; Vivek
&gt;&gt;
&gt;&gt;
&gt;&gt;&gt; With a CentOS 7 guest, things get less usable. I digested this to a
&gt;&gt;&gt; reproducible scenario.
&gt;&gt;&gt;
&gt;&gt;&gt; Build a disk image with `virt-builder`, configuring the CentOS Plus kernel
&gt;&gt;&gt; to get 9p support.
&gt;&gt;&gt;
&gt;&gt;&gt; virt-builder centos-7.8 \
&gt;&gt;&gt; --root-password password:centos \
&gt;&gt;&gt; --output centos-7.8.qcow2 \
&gt;&gt;&gt; --install yum-utils \
&gt;&gt;&gt; --run-command 'yum-config-manager --enable centosplus' \
&gt;&gt;&gt; --run-command 'sed -ie "s/DEFAULTKERNEL=kernel/DEFAULTKERNEL=kernel-plus/"
&gt;&gt;&gt; /etc/sysconfig/kernel' \
&gt;&gt;&gt; --append-line '/etc/dracut.conf.d/virtio.conf:add_drivers+="virtio_scsi
&gt;&gt;&gt; virtio_pci virtio_console"' \
&gt;&gt;&gt; --append-line '/etc/modules-load.d/9pnet_virtio.conf:9pnet_virtio' \
&gt;&gt;&gt; --install kernel-plus \
&gt;&gt;&gt; --append-line '/etc/fstab:home /home 9p trans=virtio,version=9p2000.L 0 0'
&gt;&gt;&gt;
&gt;&gt;&gt; Install the volume into the `default` pool.
&gt;&gt;&gt;
&gt;&gt;&gt; sudo install -m644 centos-7.8.qcow2 /var/lib/libvirt/images
&gt;&gt;&gt;
&gt;&gt;&gt; Next, define a domain using the disk image (using `virt-install` here for
&gt;&gt;&gt; "easy mode").
&gt;&gt;&gt;
&gt;&gt;&gt; virt-install \
&gt;&gt;&gt; --import \
&gt;&gt;&gt; --os-variant centos7.0 \
&gt;&gt;&gt; --name centos \
&gt;&gt;&gt; --ram 2048 \
&gt;&gt;&gt; --disk path=/var/lib/libvirt/images/centos-7.8.qcow2 \
&gt;&gt;&gt; --memorybacking access.mode=shared \
&gt;&gt;&gt; --filesystem source=/home,target=home,accessmode=passthrough \
&gt;&gt;&gt; --autoconsole none
&gt;&gt;&gt;
&gt;&gt;&gt; Now with SELinux enforcing, I cannot list the contents of the directories in
&gt;&gt;&gt; the mounted hierarchy.
&gt;&gt;&gt;
&gt;&gt;&gt; [root@localhost ~]# ls -lZ /home/link
&gt;&gt;&gt; ls: cannot open directory /home/link: Permission denied
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt; Virtio-fs mailing list
&gt;&gt;&gt; Virtio-fs@redhat.com
&gt;&gt;&gt; https://listman.redhat.com/mailman/listinfo/virtio-fs
&gt;&gt;&gt;
&gt; Regards,
&gt; Daniel

The separate XAttr support would also allow virtiofsd to work with 
labels inside of the container when the virtiofsd is confined on the host.


I would guess/hope virtiofsd on the host will be confined and only able 
to write certain labels like container_file_t or svirt_image_t.   If you 
want to allow virt file systems within the "VM" to be able to set 
labels, these labels will have to be something other then SELinux labels 
on the host, or SELinux will prevent them from being set.

</body></email><email><emailId>20210607140509</emailId><senderName>Link Dupont</senderName><senderEmail>link@sub-pop.net</senderEmail><timestampReceived>2021-06-07 14:05:09-0400</timestampReceived><subject>Re: [Virtio-fs] virtiofs mounted filesystems &amp; SELinux</subject><body>



On Mon, Jun 7 2021 at 09:01:08 AM -0400, Daniel Walsh 
&lt;dwalsh@redhat.com&gt; wrote:
&gt; On 6/4/21 09:59, Daniel P. Berrangé wrote:
&gt;&gt; On Fri, Jun 04, 2021 at 09:44:39AM -0400, Vivek Goyal wrote:
&gt;&gt;&gt; On Thu, Jun 03, 2021 at 10:14:24PM -0400, Link Dupont wrote:
&gt;&gt;&gt;&gt; On Thu, Jun 3 2021 at 08:56:46 PM -0400, Link Dupont 
&gt;&gt;&gt;&gt; &lt;link@sub-pop.net&gt;
&gt;&gt;&gt;&gt; wrote:
&gt;&gt;&gt;&gt;&gt;   reproducible scenarios
&gt;&gt;&gt;&gt; Alright. I reran my tests with a CentOS 8 guest. On CentOS 8 (with 
&gt;&gt;&gt;&gt; a
&gt;&gt;&gt;&gt; virtiofs filesystem and with xattr on), the type of files in the 
&gt;&gt;&gt;&gt; mounted
&gt;&gt;&gt;&gt; hierarchy are unlabeled_t. I can work around that by switching 
&gt;&gt;&gt;&gt; SELinux in
&gt;&gt;&gt;&gt; the guest to permissive or disabled.
&gt;&gt;&gt; cc Dan Walsh. I was discussing this with Dan Walsh yesterday in 
&gt;&gt;&gt; general.
&gt;&gt;&gt; 
&gt;&gt;&gt; In general, if we want to enable SELinux both on host and guest, 
&gt;&gt;&gt; then
&gt;&gt;&gt; both host and guest should have same SELinux policy. Otherwise there
&gt;&gt;&gt; will be lot of different kind of conflicts because both host and
&gt;&gt;&gt; guest will try to work with same selinux label. I guess that in
&gt;&gt;&gt; practice this will be very hard to achieve as people will run
&gt;&gt;&gt; different host and guest flavors and these might have different
&gt;&gt;&gt; policies.
&gt;&gt; Yeah, I think there's little to no chance of people keeping the
&gt;&gt; same SELinux policy in host/guest, except in very tightly controlled
&gt;&gt; narrow use cases where the host admin exerts direct control over
&gt;&gt; the precise guest config.
&gt;&gt; 
&gt;&gt; 
&gt;&gt;&gt; So another option is to rename selinux xattr in virtiofs so that
&gt;&gt;&gt; any selinux xattr coming from guest is saved as
&gt;&gt;&gt; user.virtiofs.security.selinux xattr on host. That way host and 
&gt;&gt;&gt; guest
&gt;&gt;&gt; can have their separate labels without interfering with each other.
&gt;&gt;&gt; David Gilbert already has added support for this. I can't remember
&gt;&gt;&gt; the exact syntax but you can figure it out from documentation here
&gt;&gt;&gt; in xattr remappig section.
&gt;&gt; For general purpose virt usage, I think remapping in some way is
&gt;&gt; likely to be needed as the default strategy.
&gt;&gt; 
&gt;&gt;&gt; https://github.com/qemu/qemu/blob/master/docs/tools/virtiofsd.rst
&gt;&gt;&gt; 
&gt;&gt;&gt; But I have question with selinux xattr remapping. What will happen
&gt;&gt;&gt; to initial labels when fs is exported. I mean until and unless
&gt;&gt;&gt; some process in guest labels all the exported files, they all
&gt;&gt;&gt; with either be unlabeled or pick some generic label for all the
&gt;&gt;&gt; files.
&gt;&gt; I'd say you need some mechanism to force a re-label inside the
&gt;&gt; guest. Normally a relabel will be done in /.autorelabel file
&gt;&gt; is present, or in certain other scenarios like selinux policy
&gt;&gt; RPM updates.
&gt;&gt; 
&gt;&gt; We wouldn't want to force a relabel neccesarily for the entire
&gt;&gt; FS if we're just hotplugging a new virtiofs export though. So
&gt;&gt; perhaps there's scope for supporting usage of a per-mount
&gt;&gt; point relabel trigger. eg Host creates $VIRTIOFS-ROOT/.autorelabel
&gt;&gt; and whenever the guest sees a new virtiofs export arriving, it
&gt;&gt; can look for $VIRTIOFS-MOUNT-POINT/.autorelabel
&gt;&gt; 
&gt;&gt;&gt; Another option is, can we use a single label for whole of the
&gt;&gt;&gt; virtiofs (using context=&lt;label&gt;) option in guest. That way nothing
&gt;&gt;&gt; is saved in files as such. But this means that processes in guest
&gt;&gt;&gt; can't have different selinux labels on different virtiofs dir/files.
&gt;&gt; Forcing a single label for the entire export is passable as a
&gt;&gt; fallback plan. This is what people have done for years with
&gt;&gt; NFS v3 mounts. It has annoying usage limitations though, so
&gt;&gt; if at all possible remapping is a preferrable approach.
&gt;&gt; 
&gt;&gt;&gt; Dan, what do you think?
&gt;&gt;&gt; 
&gt;&gt;&gt; Thanks
&gt;&gt;&gt; Vivek
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; With a CentOS 7 guest, things get less usable. I digested this to a
&gt;&gt;&gt;&gt; reproducible scenario.
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Build a disk image with `virt-builder`, configuring the CentOS 
&gt;&gt;&gt;&gt; Plus kernel
&gt;&gt;&gt;&gt; to get 9p support.
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; virt-builder centos-7.8 \
&gt;&gt;&gt;&gt; --root-password password:centos \
&gt;&gt;&gt;&gt; --output centos-7.8.qcow2 \
&gt;&gt;&gt;&gt; --install yum-utils \
&gt;&gt;&gt;&gt; --run-command 'yum-config-manager --enable centosplus' \
&gt;&gt;&gt;&gt; --run-command 'sed -ie 
&gt;&gt;&gt;&gt; "s/DEFAULTKERNEL=kernel/DEFAULTKERNEL=kernel-plus/"
&gt;&gt;&gt;&gt; /etc/sysconfig/kernel' \
&gt;&gt;&gt;&gt; --append-line 
&gt;&gt;&gt;&gt; '/etc/dracut.conf.d/virtio.conf:add_drivers+="virtio_scsi
&gt;&gt;&gt;&gt; virtio_pci virtio_console"' \
&gt;&gt;&gt;&gt; --append-line '/etc/modules-load.d/9pnet_virtio.conf:9pnet_virtio' 
&gt;&gt;&gt;&gt; \
&gt;&gt;&gt;&gt; --install kernel-plus \
&gt;&gt;&gt;&gt; --append-line '/etc/fstab:home /home 9p 
&gt;&gt;&gt;&gt; trans=virtio,version=9p2000.L 0 0'
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Install the volume into the `default` pool.
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; sudo install -m644 centos-7.8.qcow2 /var/lib/libvirt/images
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Next, define a domain using the disk image (using `virt-install` 
&gt;&gt;&gt;&gt; here for
&gt;&gt;&gt;&gt; "easy mode").
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; virt-install \
&gt;&gt;&gt;&gt; --import \
&gt;&gt;&gt;&gt; --os-variant centos7.0 \
&gt;&gt;&gt;&gt; --name centos \
&gt;&gt;&gt;&gt; --ram 2048 \
&gt;&gt;&gt;&gt; --disk path=/var/lib/libvirt/images/centos-7.8.qcow2 \
&gt;&gt;&gt;&gt; --memorybacking access.mode=shared \
&gt;&gt;&gt;&gt; --filesystem source=/home,target=home,accessmode=passthrough \
&gt;&gt;&gt;&gt; --autoconsole none
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Now with SELinux enforcing, I cannot list the contents of the 
&gt;&gt;&gt;&gt; directories in
&gt;&gt;&gt;&gt; the mounted hierarchy.
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; [root@localhost ~]# ls -lZ /home/link
&gt;&gt;&gt;&gt; ls: cannot open directory /home/link: Permission denied
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt;&gt; Virtio-fs mailing list
&gt;&gt;&gt;&gt; Virtio-fs@redhat.com
&gt;&gt;&gt;&gt; https://listman.redhat.com/mailman/listinfo/virtio-fs
&gt;&gt;&gt;&gt; 
&gt;&gt; Regards,
&gt;&gt; Daniel
&gt; 
&gt; The separate XAttr support would also allow virtiofsd to work with 
&gt; labels inside of the container when the virtiofsd is confined on the 
&gt; host.
&gt; 
&gt; 
&gt; I would guess/hope virtiofsd on the host will be confined and only 
&gt; able to write certain labels like container_file_t or svirt_image_t.  
&gt; If you want to allow virt file systems within the "VM" to be able to 
&gt; set labels, these labels will have to be something other then SELinux 
&gt; labels on the host, or SELinux will prevent them from being set.
&gt; 

I don't think the guest needs to be able to set labels on the virtiofs 
filesystems; as long as it can read labels that grant read and write 
access as the guest user, I'd call it a success. The way I use this 
feature, I'm treating my host filesystem as the "source", and really 
only mounting it into the guest as a zero-delay synchronization. (I 
previously did this using sync solutions like rsync or lsyncd, but 
those have a slight delay before files sync over.)

If the labels as seen by the guest allow for reading and writing files 
from the guest to the host filesystem, I'd be happy. Doing any 
relabeling from the host is totally fine.



</body></email><email><emailId>20210513142532</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-05-13 14:25:32-0400</timestampReceived><subject>Re: How to hot plugin a new vhost-user-blk-pci device to running VM?</subject><body>

On Thu, May 13, 2021 at 15:25:23 +0800, 梁朝军 wrote:
&gt; Hi Guy,
&gt; 
&gt; Does  anyone clear how to hot plugin a new vhost-user-blk-pci device to a
&gt; running VM?
&gt; 
&gt; Before staring vm , I pass the disk through QEMU command line  like below.
&gt; 
&gt; &lt;qemu:commandline&gt;
&gt; &lt;qemu:arg value='-object'/&gt;
&gt; &lt;qemu:arg
&gt; value='memory-backend-file,id=mem0,size=4G,mem-path=/dev/hugepages,share=on'/&gt;
&gt; &lt;qemu:arg value='-numa'/&gt;
&gt; &lt;qemu:arg value='node,memdev=mem0'/&gt;
&gt; &lt;qemu:arg value='-chardev'/&gt;
&gt; &lt;qemu:arg
&gt; value='socket,id=spdk_vhost_blk721ea46a-b306-11eb-a280-525400a98761,path=/var/tmp/vhost.721ea46a-b306-11eb-a280-525400a98761,reconnect=1'/&gt;
&gt;  &lt;qemu:arg value='-device'/&gt;
&gt; &lt;qemu:arg
&gt; value='vhost-user-blk-pci,chardev=spdk_vhost_blk721ea46a-b306-11eb-a280-525400a98761,bootindex=1,num-queues=4'/&gt;
&gt;  &lt;qemu:arg value='-chardev'/&gt;
&gt; &lt;qemu:arg
&gt; value='socket,id=spdk_vhost_blk2f699c58-d222-4629-9fdc-400c3aadc55e,path=/var/tmp/vhost.2f699c58-d222-4629-9fdc-400c3aadc55e,reconnect=1'/&gt;
&gt;  &lt;qemu:arg value='-device'/&gt;
&gt; &lt;qemu:arg
&gt; value='vhost-user-blk-pci,chardev=spdk_vhost_blk2f699c58-d222-4629-9fdc-400c3aadc55e,num-queues=4'/&gt;
&gt;  &lt;/qemu:commandline&gt;
&gt; 
&gt; But I don**t know how to live add a vhost-user-blk-pci device on running
&gt; VM even with calling attachDevice API now.

You need to use the proper and supported way to use vhost-user-blk:

  &lt;disk type='vhostuser' device='disk'&gt;
    &lt;driver name='qemu' type='raw'/&gt;
    &lt;source type='unix' path='/tmp/vhost-blk.sock'&gt;
      &lt;reconnect enabled='yes' timeout='10'/&gt;
    &lt;/source&gt;
    &lt;target dev='vdf' bus='virtio'/&gt;
  &lt;/disk&gt;

That works also with attachDevice.


&gt; OS: redhat 7.4 Libvirt version: 3.4

This is obviously way too old for it. You'll need at least libvirt-7.1
for that.


</body></email><email><emailId>20210513151136</emailId><senderName>Liang Chaojun</senderName><senderEmail>jesonliang040705@hotmail.com</senderEmail><timestampReceived>2021-05-13 15:11:36-0400</timestampReceived><subject>Re: How to hot plugin a new vhost-user-blk-pci device to running VM?</subject><body>



Thanks Peter for your quickly response. Is there any workaround to do that？As you \
know we must take care the risk of using latest version in product environment.


Thanks a lot!

&gt; 在 2021年5月13日，22:25，Peter Krempa &lt;pkrempa@redhat.com&gt; 写道：
&gt; 
&gt; ﻿On Thu, May 13, 2021 at 15:25:23 +0800, 梁朝军 wrote:
&gt; &gt; Hi Guy,
&gt; &gt; 
&gt; &gt; Does  anyone clear how to hot plugin a new vhost-user-blk-pci device to a
&gt; &gt; running VM?
&gt; &gt; 
&gt; &gt; Before staring vm , I pass the disk through QEMU command line  like below.
&gt; &gt; 
&gt; &gt; &lt;qemu:commandline&gt;
&gt; &gt; &lt;qemu:arg value='-object'/&gt;
&gt; &gt; &lt;qemu:arg
&gt; &gt; value='memory-backend-file,id=mem0,size=4G,mem-path=/dev/hugepages,share=on'/&gt;
&gt; &gt; &lt;qemu:arg value='-numa'/&gt;
&gt; &gt; &lt;qemu:arg value='node,memdev=mem0'/&gt;
&gt; &gt; &lt;qemu:arg value='-chardev'/&gt;
&gt; &gt; &lt;qemu:arg
&gt; &gt; value='socket,id=spdk_vhost_blk721ea46a-b306-11eb-a280-525400a98761,path=/var/tmp/vhost.721ea46a-b306-11eb-a280-525400a98761,reconnect=1'/&gt;
&gt; &gt;  &lt;qemu:arg value='-device'/&gt;
&gt; &gt; &lt;qemu:arg
&gt; &gt; value='vhost-user-blk-pci,chardev=spdk_vhost_blk721ea46a-b306-11eb-a280-525400a98761,bootindex=1,num-queues=4'/&gt;
&gt; &gt;  &lt;qemu:arg value='-chardev'/&gt;
&gt; &gt; &lt;qemu:arg
&gt; &gt; value='socket,id=spdk_vhost_blk2f699c58-d222-4629-9fdc-400c3aadc55e,path=/var/tmp/vhost.2f699c58-d222-4629-9fdc-400c3aadc55e,reconnect=1'/&gt;
&gt; &gt;  &lt;qemu:arg value='-device'/&gt;
&gt; &gt; &lt;qemu:arg
&gt; &gt; value='vhost-user-blk-pci,chardev=spdk_vhost_blk2f699c58-d222-4629-9fdc-400c3aadc55e,num-queues=4'/&gt;
&gt; &gt;  &lt;/qemu:commandline&gt;
&gt; &gt; 
&gt; &gt; But I don**t know how to live add a vhost-user-blk-pci device on running
&gt; &gt; VM even with calling attachDevice API now.
&gt; 
&gt; You need to use the proper and supported way to use vhost-user-blk:
&gt; 
&gt; &lt;disk type='vhostuser' device='disk'&gt;
&gt; &lt;driver name='qemu' type='raw'/&gt;
&gt; &lt;source type='unix' path='/tmp/vhost-blk.sock'&gt;
&gt; &lt;reconnect enabled='yes' timeout='10'/&gt;
&gt; &lt;/source&gt;
&gt; &lt;target dev='vdf' bus='virtio'/&gt;
&gt; &lt;/disk&gt;
&gt; 
&gt; That works also with attachDevice.
&gt; 
&gt; 
&gt; &gt; OS: redhat 7.4 Libvirt version: 3.4
&gt; 
&gt; This is obviously way too old for it. You'll need at least libvirt-7.1
&gt; for that.
&gt; 


</body></email><email><emailId>20210513164729</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-05-13 16:47:29-0400</timestampReceived><subject>Re: How to hot plugin a new vhost-user-blk-pci device to running VM?</subject><body>

On Thu, May 13, 2021 at 23:11:36 +0800, Liang Chaojun wrote:
&gt; 
&gt; 
&gt; Thanks Peter for your quickly response. Is there any workaround to do that？As you \
&gt; know we must take care the risk of using latest version in product environment.

Manual approach is to use 'virsh qemu-monitor-command' or the equivalent
to attach the appropriate backends and frontends manually.

Obviously that is very far from anything I'd recommend to use in any
production environment.


</body></email><email><emailId>20210514063337</emailId><senderName>Liang Chaojun</senderName><senderEmail>jesonliang040705@hotmail.com</senderEmail><timestampReceived>2021-05-14 06:33:37-0400</timestampReceived><subject>Re: How to hot plugin a new vhost-user-blk-pci device to running VM?</subject><body>



Thanks，I have tried qemu monitor as below. I used chardev_add to add a chardev and \
used device_add it to running vm. But i often hit a issue and cause the vm crash. \
qemu-system-x86_64: ../hw/virtio/vhost.c:1566: vhost_dev_get_config: Assertion \
`hdev-&gt;vhost_ops' failed.

virsh qemu-monitor-command spdk1 --hmp --cmd "chardev-add \
socket,id=spdk_vhost_blk0,path=/var/tmp/vhost.0,reconnect=1"  virsh \
qemu-monitor-command spdk1 --hmp --cmd "device_add \
vhost-user-blk-pci,chardev=spdk_vhost_blk0,num-queues=4"

&gt; 在 2021年5月14日，00:47，Peter Krempa &lt;pkrempa@redhat.com&gt; 写道：
&gt; 
&gt; ﻿On Thu, May 13, 2021 at 23:11:36 +0800, Liang Chaojun wrote:
&gt; &gt; 
&gt; &gt; 
&gt; &gt; Thanks Peter for your quickly response. Is there any workaround to do that？As \
&gt; &gt; you know we must take care the risk of using latest version in product \
&gt; &gt; environment.
&gt; 
&gt; Manual approach is to use 'virsh qemu-monitor-command' or the equivalent
&gt; to attach the appropriate backends and frontends manually.
&gt; 
&gt; Obviously that is very far from anything I'd recommend to use in any
&gt; production environment.
&gt; 


</body></email><email><emailId>202105140633370</emailId><senderName>Liang Chaojun</senderName><senderEmail>jesonliang040705@hotmail.com</senderEmail><timestampReceived>2021-05-14 06:33:37-0400</timestampReceived><subject>Re: How to hot plugin a new vhost-user-blk-pci device to running VM?</subject><body>



Thanks，I have tried qemu monitor as below. I used chardev_add to add a chardev and \
used device_add it to running vm. But i often hit a issue and cause the vm crash. \
qemu-system-x86_64: ../hw/virtio/vhost.c:1566: vhost_dev_get_config: Assertion \
`hdev-&gt;vhost_ops' failed.

virsh qemu-monitor-command spdk1 --hmp --cmd "chardev-add \
socket,id=spdk_vhost_blk0,path=/var/tmp/vhost.0,reconnect=1"  virsh \
qemu-monitor-command spdk1 --hmp --cmd "device_add \
vhost-user-blk-pci,chardev=spdk_vhost_blk0,num-queues=4"

&gt; 在 2021年5月14日，00:47，Peter Krempa &lt;pkrempa@redhat.com&gt; 写道：
&gt; 
&gt; ﻿On Thu, May 13, 2021 at 23:11:36 +0800, Liang Chaojun wrote:
&gt; &gt; 
&gt; &gt; 
&gt; &gt; Thanks Peter for your quickly response. Is there any workaround to do that？As \
&gt; &gt; you know we must take care the risk of using latest version in product \
&gt; &gt; environment.
&gt; 
&gt; Manual approach is to use 'virsh qemu-monitor-command' or the equivalent
&gt; to attach the appropriate backends and frontends manually.
&gt; 
&gt; Obviously that is very far from anything I'd recommend to use in any
&gt; production environment.
&gt; 


</body></email><email><emailId>20210514071233</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-05-14 07:12:33-0400</timestampReceived><subject>Re: How to hot plugin a new vhost-user-blk-pci device to running VM?</subject><body>

On Fri, May 14, 2021 at 14:33:37 +0800, Liang Chaojun wrote:
&gt; 
&gt; 
&gt; Thanks，I have tried qemu monitor as below. I used chardev_add to add a chardev \
&gt; and used device_add it to running vm. But i often hit a issue and cause the vm \
&gt; crash. qemu-system-x86_64: ../hw/virtio/vhost.c:1566: vhost_dev_get_config: \
&gt; Assertion `hdev-&gt;vhost_ops' failed. 
&gt; virsh qemu-monitor-command spdk1 --hmp --cmd "chardev-add \
&gt; socket,id=spdk_vhost_blk0,path=/var/tmp/vhost.0,reconnect=1"  virsh \
&gt; qemu-monitor-command spdk1 --hmp --cmd "device_add \
&gt; vhost-user-blk-pci,chardev=spdk_vhost_blk0,num-queues=4"

As noted, this is not an interface we'd provide support for. Please
upgrade both libvirt and qemu and try the supported interface if you
want us to deal with any problems you might have.


</body></email><email><emailId>20210514131545</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-05-14 13:15:45-0400</timestampReceived><subject>Re: How to hot plugin a new vhost-user-blk-pci device to running VM?</subject><body>

On 5/14/21 8:33 AM, Liang Chaojun wrote:
&gt; 
&gt; 
&gt; Thanks，I have tried qemu monitor as below. I used chardev_add to add a chardev \
&gt; and used device_add it to running vm. But i often hit a issue and cause the vm \
&gt; crash. qemu-system-x86_64: ../hw/virtio/vhost.c:1566: vhost_dev_get_config: \
&gt; Assertion `hdev-&gt;vhost_ops' failed. 
&gt; virsh qemu-monitor-command spdk1 --hmp --cmd "chardev-add \
&gt; socket,id=spdk_vhost_blk0,path=/var/tmp/vhost.0,reconnect=1"  virsh \
&gt; qemu-monitor-command spdk1 --hmp --cmd "device_add \
&gt; vhost-user-blk-pci,chardev=spdk_vhost_blk0,num-queues=4"

Smells like problem described here:

https://gitlab.com/qemu-project/qemu/-/commit/bc79c87bcde6587a37347f81332fbb0cd6b14b85


But that's pretty fresh commit (part of qemu 6.0.0 release). And also
the commit it references is not that old (qemu 5.1.0 release). What
version of qemu are you running?

Michal


</body></email><email><emailId>20210521152808</emailId><senderName></senderName><senderEmail>jesonliang040705@hotmail.com</senderEmail><timestampReceived>2021-05-21 15:28:08-0400</timestampReceived><subject>Re: How to hot plugin a new vhost-user-blk-pci device to running VM?</subject><body>

Thanks all of you for your help.
One more question regarding  vhost-user-blk-pci type device,  how to identify a \
vhost-blk disk in QEUM VM ?  for example, disk name looks like vda,vdb,..., but that \
some application in VM want to detect  that a certain entry is really the device it \
is waiting for. Specific for windows , they always show as disk 0, 1, 2¡­.etc Is \
there any way to identify those disk with each other in VM?

thanks


&gt; ÔÚ 2021Äê5Ô 17ÈÕ£¬Ï Îç3:13£¬Michal Pr¨ªvozn¨ªk &lt;mprivozn@redhat.com&gt; Ð´µÀ£º
&gt; 
&gt; On 5/17/21 7:08 AM, Liang Chaojun wrote:
&gt; &gt; 
&gt; &gt; Thanks Michal and Peter for your response. I¡® m running it on qemu 5.1 build by \
&gt; &gt; myself. BTW, follow Peter¡¯s suggestion, where I can get the latest rpms if I \
&gt; &gt; want to upgrade to Libvirt 7.1? As I know it seems need more than twenty related \
&gt; &gt; rpms not include dependency.
&gt; 
&gt; Well, since you're building qemu yourself you could also build libvirt.
&gt; Just be aware that the v7.3.0 release was the last one that supports
&gt; RHEL-7. Newer releases might still work, but upstream does not aim to
&gt; make everything work.
&gt; 
&gt; https://libvirt.org/platforms.html
&gt; 
&gt; Michal
&gt; 


[Attachment #3 (unknown)]

&lt;html&gt;&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=gb2312"&gt;&lt;/head&gt;&lt;body \
style="word-wrap: break-word; -webkit-nbsp-mode: space; line-break: \
after-white-space;" class=""&gt;Thanks all of you for your help.&lt;div style="orphans: 2; \
widows: 2;" class=""&gt;One more question regarding  vhost-user-blk-pci type \
device,  how to identify a vhost-blk disk in QEUM VM ? &lt;span style="color: \
rgb(29, 28, 29); font-family: Slack-Lato, appleLogo, sans-serif; font-size: 15px; \
orphans: 2; widows: 2; background-color: rgb(248, 248, 248);" class=""&gt; for \
example, disk name looks like vda,vdb,..., but that some application in VM want to \
detect  that a certain entry is really the device it is waiting \
for. &lt;/span&gt;&lt;font color="#1d1c1d" face="Slack-Lato, appleLogo, sans-serif" \
class=""&gt;&lt;span style="font-size: 15px;" class=""&gt;Specific for windows , they always \
show as disk 0, 1, 2¡­.etc&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style="orphans: 2; widows: 2;" \
class=""&gt;&lt;font color="#1d1c1d" face="Slack-Lato, appleLogo, sans-serif" \
class=""&gt;&lt;span style="font-size: 15px;" class=""&gt;Is there any way \
to identify those disk with each other in VM?&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div \
style="orphans: 2; widows: 2;" class=""&gt;&lt;font color="#1d1c1d" face="Slack-Lato, \
appleLogo, sans-serif" class=""&gt;&lt;span style="font-size: 15px;" class=""&gt;&lt;br \
class=""&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style="orphans: 2; widows: 2;" class=""&gt;&lt;font \
color="#1d1c1d" face="Slack-Lato, appleLogo, sans-serif" class=""&gt;&lt;span \
style="font-size: 15px;" class=""&gt;thanks&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div class=""&gt;&lt;br \
class=""&gt;&lt;/div&gt;&lt;div&gt;&lt;br class=""&gt;&lt;blockquote type="cite" class=""&gt;&lt;div class=""&gt;ÔÚ \
2021Äê5Ô 17ÈÕ£¬Ï Îç3:13£¬Michal Pr¨ªvozn¨ªk &lt;&lt;a href="mailto:mprivozn@redhat.com" \
class=""&gt;mprivozn@redhat.com&lt;/a&gt;&gt; Ð´µÀ£º&lt;/div&gt;&lt;br \
class="Apple-interchange-newline"&gt;&lt;div class=""&gt;&lt;div class=""&gt;On 5/17/21 7:08 AM, \
Liang Chaojun wrote:&lt;br class=""&gt;&lt;blockquote type="cite" class=""&gt;&lt;br class=""&gt;Thanks \
Michal and Peter for your response. I¡® m running it on qemu 5.1 build by myself. \
BTW, follow Peter¡¯s suggestion, where I can get the latest rpms if I want to upgrade \
to Libvirt 7.1? As I know it seems need more than twenty related rpms not include \
dependency.&lt;br class=""&gt;&lt;/blockquote&gt;&lt;br class=""&gt;Well, since you're building qemu \
yourself you could also build libvirt.&lt;br class=""&gt;Just be aware that the v7.3.0 \
release was the last one that supports&lt;br class=""&gt;RHEL-7. Newer releases might still \
work, but upstream does not aim to&lt;br class=""&gt;make everything work.&lt;br class=""&gt;&lt;br \
class=""&gt;&lt;a href="https://libvirt.org/platforms.html" \
class=""&gt;https://libvirt.org/platforms.html&lt;/a&gt;&lt;br class=""&gt;&lt;br class=""&gt;Michal&lt;br \
class=""&gt;&lt;br class=""&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br class=""&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20210524110444</emailId><senderName>Michal PrÃ­voznÃ­k</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-05-24 11:04:44-0400</timestampReceived><subject>Re: How to hot plugin a new vhost-user-blk-pci device to running VM?</subject><body>

On 5/21/21 5:28 PM, Áº³¯¾ü wrote:
&gt; Thanks all of you for your help.
&gt; One more question regarding  vhost-user-blk-pci type device,  how to identify a \
&gt; vhost-blk disk in QEUM VM ?  for example, disk name looks like vda,vdb,..., but \
&gt; that some application in VM want to detect  that a certain entry is really the \
&gt; device it is waiting for. Specific for windows , they always show as disk 0, 1, \
&gt; 2¡­.etc Is there any way to identify those disk with each other in VM?

In general no. Usually disks will be enumerated sequentially - thus the
first disk on a sata/scsi/usb/.. bus will be sda, the second will be
sdb, and so on. But libvirt can't guarantee it - the same way you can't
guarantee how a disk is going to be called with real HW.

Michal


</body></email><email><emailId>20210604112231</emailId><senderName></senderName><senderEmail>jesonliang040705@hotmail.com</senderEmail><timestampReceived>2021-06-04 11:22:31-0400</timestampReceived><subject>Re: How to hot plugin a new vhost-user-blk-pci device to running VM?</subject><body>

Hi Guys:

Who can help me ? What does this issue mean?  When I attach a network I hit this \
issue.

libvirt: QEMU Driver error : internal error: unable to execute QEMU command \
'netdev_add': Invalid parameter type for 'vhost', expected: boolean

Thanks!

&gt; ÔÚ 2021Äê5Ô 24ÈÕ£¬Ï Îç7:08£¬Daniel P. Berrang¨¦ &lt;berrange@redhat.com&gt; Ð´µÀ£º
&gt; 
&gt; On Mon, May 24, 2021 at 01:04:44PM +0200, Michal Pr¨ªvozn¨ªk wrote:
&gt; &gt; On 5/21/21 5:28 PM, Áº³¯¾ü wrote:
&gt; &gt; &gt; Thanks all of you for your help.
&gt; &gt; &gt; One more question regarding  vhost-user-blk-pci type device,  how to identify a \
&gt; &gt; &gt; vhost-blk disk in QEUM VM ?  for example, disk name looks like vda,vdb,..., but \
&gt; &gt; &gt; that some application in VM want to detect  that a certain entry is really the \
&gt; &gt; &gt; device it is waiting for. Specific for windows , they always show as disk 0, 1, \
&gt; &gt; &gt; 2¡­.etc Is there any way to identify those disk with each other in VM?
&gt; &gt; 
&gt; &gt; In general no. Usually disks will be enumerated sequentially - thus the
&gt; &gt; first disk on a sata/scsi/usb/.. bus will be sda, the second will be
&gt; &gt; sdb, and so on. But libvirt can't guarantee it - the same way you can't
&gt; &gt; guarantee how a disk is going to be called with real HW.
&gt; 
&gt; You can set the 'serial' property in the disk in libvirt, and then match
&gt; that in the guest. For Linux guests that's used in /dev/disk/by-id
&gt; symlinks.
&gt; 
&gt; Regards,
&gt; Daniel
&gt; -- 
&gt; &gt; &gt; https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
&gt; &gt; &gt; https://libvirt.org         -o-            https://fstop138.berrange.com :|
&gt; &gt; &gt; https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|
&gt; 


</body></email><email><emailId>20210604113130</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-06-04 11:31:30-0400</timestampReceived><subject>Re: How to hot plugin a new vhost-user-blk-pci device to running VM?</subject><body>

On Fri, Jun 04, 2021 at 19:22:31 +0800, 梁朝军 wrote:
&gt; Hi Guys:
&gt; 
&gt; Who can help me ? What does this issue mean?  When I attach a network I hit this \
&gt; issue. 
&gt; libvirt: QEMU Driver error : internal error: unable to execute QEMU command \
&gt; 'netdev_add': Invalid parameter type for 'vhost', expected: boolean

Your qemu is too-new for libvirt. the 'netdev_add' command was converted
to a strict description by QMP schema and libvirt wasn't ready for that.

commit b6738ffc9f8be5a2a61236cd9bef7fd317982f01
Author: Peter Krempa &lt;pkrempa@redhat.com&gt;
Date:   Thu May 14 22:50:59 2020 +0200

    qemu: command: Generate -netdev command line via JSON-&gt;cmdline conversion

    The 'netdev_add' command was recently formally described in qemu via the
    QMP schema. This means that it also requires the arguments to be
    properly formatted. Our current approach is to generate the command line
    and then use qemuMonitorJSONKeywordStringToJSON to get the JSON
    properties for the monitor. This will not work if we need to pass some
    fields as numbers or booleans.

    In this step we re-do internals of qemuBuildHostNetStr to format a JSON
    object which is converted back via virQEMUBuildNetdevCommandlineFromJSON
    to the equivalent command line. This will later allow fixing of the
    monitor code to use the JSON object directly rather than rely on the
    conversion.

v6.3.0-139-gb6738ffc9f

Thus you need at least libvirt 6.4.0 with that qemu.


</body></email><email><emailId>20210604082457</emailId><senderName>Andrea Bolognani</senderName><senderEmail>abologna@redhat.com</senderEmail><timestampReceived>2021-06-04 08:24:57-0400</timestampReceived><subject>Re: error when building from git checkout</subject><body>

On Fri, Jun 04, 2021 at 07:21:59AM +0800, Jiatong Shen wrote:
&gt; Hello community,
&gt;
&gt; I am trying to compile libvirt from source but being trapped with following
&gt; error message when running ninja -C build
&gt;
&gt; ninja -C build
&gt; ninja: Entering directory `build'
&gt; [1/12] Generating virkeyname-osx.html with a meson_exe.py custom command
&gt; FAILED: docs/manpages/virkeyname-osx.html
&gt; /home/sjt/.local/bin/meson --internal exe --capture
&gt; docs/manpages/virkeyname-osx.html -- /usr/bin/xsltproc --stringparam
&gt; pagesrc docs/manpages/virkeyname-osx.rst --stringparam builddir
&gt; /home/sjt/src/c/libvirt/build --stringparam timestamp 'Thu Jun  3 23:11:25
&gt; 2021 UTC' --nonet ../docs/subsite.xsl docs/manpages/virkeyname-osx.html.in
&gt; docs/manpages/virkeyname-osx.html.in:17: parser error : Double hyphen
&gt; within comment: &lt;!-- This file is auto-generated from keymaps.csv
&gt; Data
&gt;   keymap-gen --lang=rst --title=virkeyname-osx --subtitle=Key name values
&gt; for os
&gt;              ^
&gt;
&gt; any advice on how to fix it? thank you very much

Can you please apply

  https://gitlab.com/abologna/libvirt/-/commit/678634eb12247b291dacef7a678fa4c50c52f99f

and try again?

If that works for you, I'll submit the patch to the mailing list.
Feel free to provide a Tested-By tag.

-- 
Andrea Bolognani / Red Hat / Virtualization

</body></email><email><emailId>20210604123336</emailId><senderName>Andrea Bolognani</senderName><senderEmail>abologna@redhat.com</senderEmail><timestampReceived>2021-06-04 12:33:36-0400</timestampReceived><subject>Re: error when building from git checkout</subject><body>

[re-adding libvirt-users]

On Fri, Jun 04, 2021 at 04:49:49PM +0800, Jiatong Shen wrote:
&gt; Thank you very much for the reply. after applying this ps, the error is
&gt; gone.

Glad to hear that! I've sent the patch to the mailing list now :)

&gt; also curious to know if there is a way to skip building docs? thank you.

Passing -Ddocs=disabled to Meson should do the trick.

-- 
Andrea Bolognani / Red Hat / Virtualization

</body></email><email><emailId>20210604135653</emailId><senderName>Jiatong Shen</senderName><senderEmail>yshxxsjt715@gmail.com</senderEmail><timestampReceived>2021-06-04 13:56:53-0400</timestampReceived><subject>Re: error when building from git checkout</subject><body>

Awesome, thanks!

On Fri, Jun 4, 2021 at 8:33 PM Andrea Bolognani &lt;abologna@redhat.com&gt; wrote:

&gt; [re-adding libvirt-users]
&gt;
&gt; On Fri, Jun 04, 2021 at 04:49:49PM +0800, Jiatong Shen wrote:
&gt; &gt; Thank you very much for the reply. after applying this ps, the error is
&gt; &gt; gone.
&gt;
&gt; Glad to hear that! I've sent the patch to the mailing list now :)
&gt;
&gt; &gt; also curious to know if there is a way to skip building docs? thank you.
&gt;
&gt; Passing -Ddocs=disabled to Meson should do the trick.
&gt;
&gt; --
&gt; Andrea Bolognani / Red Hat / Virtualization
&gt;
&gt;

-- 

Best Regards,

Jiatong Shen

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Awesome, thanks!  &lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div \
dir="ltr" class="gmail_attr"&gt;On Fri, Jun 4, 2021 at 8:33 PM Andrea Bolognani &lt;&lt;a \
href="mailto:abologna@redhat.com"&gt;abologna@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;[re-adding \
libvirt-users]&lt;br&gt; &lt;br&gt;
On Fri, Jun 04, 2021 at 04:49:49PM +0800, Jiatong Shen wrote:&lt;br&gt;
&gt; Thank you very much for the reply. after applying this ps, the error is&lt;br&gt;
&gt; gone.&lt;br&gt;
&lt;br&gt;
Glad to hear that! I've sent the patch to the mailing list now :)&lt;br&gt;
&lt;br&gt;
&gt; also curious to know if there is a way to skip building docs? thank you.&lt;br&gt;
&lt;br&gt;
Passing -Ddocs=disabled to Meson should do the trick.&lt;br&gt;
&lt;br&gt;
-- &lt;br&gt;
Andrea Bolognani / Red Hat / Virtualization&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br clear="all"&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- &lt;br&gt;&lt;div dir="ltr" \
class="gmail_signature"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;div&gt;Best \
Regards,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Jiatong Shen&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210605083029</emailId><senderName></senderName><senderEmail>jesonliang040705@hotmail.com</senderEmail><timestampReceived>2021-06-05 08:30:29-0400</timestampReceived><subject>Re: How to hot plugin a new vhost-user-blk-pci device to running VM?</subject><body>

Thanks a lot.  Peter . BTW, one more question, recently sometimes we often hit \
another issue that vm can¡¯t boot from disk stuck in black screen show ¡°Guest has \
not initialized the display (yet).¡± Our QEMU command line parameter like below.

/usr/bin/qemu-system-x86_64 -name guest=testvm_j5ei9x2a,debug-threads=on -S \
-object secret,id=masterKey0,format=raw,file=/var/lib/libvirt/qemu/domain-46-testvm_j5ei9x2a/master-key.aes \
                \
-machine pc-i440fx-5.1,accel=kvm,usb=off,dump-guest-core=off,mem-merge=off \
-m 8192 -mem-prealloc -realtime mlock=off -smp 2,sockets=2,cores=1,threads=1 \
-uuid 44b984dd-e1c7-45c8-b235-6c9ce3a8b86c -smbios type=0,vendor=phegda -smbios \
                type=1,manufacturer=phegda.com,product=hippo -no-user-config \
-nodefaults -chardev \
socket,id=charmonitor,path=/var/lib/libvirt/qemu/domain-46-testvm_j5ei9x2a/monitor.sock,server,nowait \
                \
-mon chardev=charmonitor,id=monitor,mode=control -rtc base=utc,driftfix=slew \
-global kvm-pit.lost_tick_policy=delay -no-hpet -no-shutdown -boot strict=on \
-device piix3-usb-uhci,id=usb,bus=pci.0,addr=0x1.0x2 \
-device virtio-scsi-pci,id=scsi0,bus=pci.0,addr=0x3 \
-device virtio-serial-pci,id=virtio-serial0,bus=pci.0,addr=0x4 \
-drive if=none,id=drive-ide0-0-0,readonly=on \
-device ide-cd,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0 \
-drive file=/dev/disk/by-id/pbdx-vol-88663c6a-c5cb-11eb-9c3b-001b21bc1e4e,format=raw,if=none,id=drive-scsi0-0-0-0,cache=writethrough,werror=report,rerror=report \
                \
-device scsi-hd,bus=scsi0.0,channel=0,scsi-id=0,lun=0,drive=drive-scsi0-0-0-0,id=scsi0-0-0-0,bootindex=1 \
                \
-drive file=/dev/disk/by-id/pbdx-vol-d8596026-862c-47cf-9fa5-8a16f337d02a,format=raw,if=none,id=drive-scsi0-0-0-1,cache=none,werror=report,rerror=report \
                \
-device scsi-hd,bus=scsi0.0,channel=0,scsi-id=0,lun=1,drive=drive-scsi0-0-0-1,id=scsi0-0-0-1 \
                \
-netdev tap,fd=29,id=hostnet0,vhost=on,vhostfd=32 \
-device virtio-net-pci,netdev=hostnet0,id=net0,mac=e6:8e:42:c8:47:dd,bus=pci.0,addr=0x8 \
                \
-netdev tap,fd=33,id=hostnet1,vhost=on,vhostfd=34 \
-device virtio-net-pci,netdev=hostnet1,id=net1,mac=e6:8e:fe:99:0f:63,bus=pci.0,addr=0x9 \
                \
-chardev pty,id=charserial0 -device isa-serial,chardev=charserial0,id=serial0 \
-chardev socket,id=charchannel0,path=/var/hippo/channel/44b984dd-e1c7-45c8-b235-6c9ce3a8b86c.channel,server,nowait \
                \
-device virtserialport,bus=virtio-serial0.0,nr=1,chardev=charchannel0,id=channel0,name=cn.com.pbdata.hippo.0 \
                \
-chardev socket,id=charchannel1,path=/var/hippo/channel/testvm_j5ei9x2a.44b984dd-e1c7-45c8-b235-6c9ce3a8b86c.channel,server,nowait \
                \
-device virtserialport,bus=virtio-serial0.0,nr=2,chardev=charchannel1,id=channel1,name=cn.com.pbdata.hippo.1 \
                \
-vnc 0.0.0.0:2 -device \
qxl-vga,id=video0,ram_size=67108864,vram_size=67108864,vram64_size_mb=0,vgamem_mb=16,max_outputs=1,bus=pci.0,addr=0x2 \
                \
-device virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x5 \
-msg timestamp=on

Is it related with that QEMU vesion higher for libvirt? 

Thanks 


&gt; ÔÚ 2021Äê6Ô 4ÈÕ£¬Ï Îç7:31£¬Peter Krempa &lt;pkrempa@redhat.com&gt; Ð´µÀ£º
&gt; 
&gt; On Fri, Jun 04, 2021 at 19:22:31 +0800, Áº³¯¾ü wrote:
&gt; &gt; Hi Guys:
&gt; &gt; 
&gt; &gt; Who can help me ? What does this issue mean?  When I attach a network I hit this \
&gt; &gt; issue. 
&gt; &gt; libvirt: QEMU Driver error : internal error: unable to execute QEMU command \
&gt; &gt; 'netdev_add': Invalid parameter type for 'vhost', expected: boolean
&gt; 
&gt; Your qemu is too-new for libvirt. the 'netdev_add' command was converted
&gt; to a strict description by QMP schema and libvirt wasn't ready for that.
&gt; 
&gt; commit b6738ffc9f8be5a2a61236cd9bef7fd317982f01
&gt; Author: Peter Krempa &lt;pkrempa@redhat.com&gt;
&gt; Date:   Thu May 14 22:50:59 2020 +0200
&gt; 
&gt; qemu: command: Generate -netdev command line via JSON-&gt;cmdline conversion
&gt; 
&gt; The 'netdev_add' command was recently formally described in qemu via the
&gt; QMP schema. This means that it also requires the arguments to be
&gt; properly formatted. Our current approach is to generate the command line
&gt; and then use qemuMonitorJSONKeywordStringToJSON to get the JSON
&gt; properties for the monitor. This will not work if we need to pass some
&gt; fields as numbers or booleans.
&gt; 
&gt; In this step we re-do internals of qemuBuildHostNetStr to format a JSON
&gt; object which is converted back via virQEMUBuildNetdevCommandlineFromJSON
&gt; to the equivalent command line. This will later allow fixing of the
&gt; monitor code to use the JSON object directly rather than rely on the
&gt; conversion.
&gt; 
&gt; v6.3.0-139-gb6738ffc9f
&gt; 
&gt; Thus you need at least libvirt 6.4.0 with that qemu.
&gt; 


</body></email><email><emailId>20210607141507</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-06-07 14:15:07-0400</timestampReceived><subject>Re: [Virtio-fs] virtiofs mounted filesystems &amp; SELinux</subject><body>

On Fri, Jun 04, 2021 at 02:59:29PM +0100, Daniel P. Berrangé wrote:
&gt; On Fri, Jun 04, 2021 at 09:44:39AM -0400, Vivek Goyal wrote:
&gt; &gt; On Thu, Jun 03, 2021 at 10:14:24PM -0400, Link Dupont wrote:
&gt; &gt; &gt; On Thu, Jun 3 2021 at 08:56:46 PM -0400, Link Dupont &lt;link@sub-pop.net&gt;
&gt; &gt; &gt; wrote:
&gt; &gt; &gt; &gt;  reproducible scenarios
&gt; &gt; &gt; 
&gt; &gt; &gt; Alright. I reran my tests with a CentOS 8 guest. On CentOS 8 (with a
&gt; &gt; &gt; virtiofs filesystem and with xattr on), the type of files in the mounted
&gt; &gt; &gt; hierarchy are unlabeled_t. I can work around that by switching SELinux in
&gt; &gt; &gt; the guest to permissive or disabled.
&gt; &gt; 
&gt; &gt; cc Dan Walsh. I was discussing this with Dan Walsh yesterday in general.
&gt; &gt; 
&gt; &gt; In general, if we want to enable SELinux both on host and guest, then
&gt; &gt; both host and guest should have same SELinux policy. Otherwise there
&gt; &gt; will be lot of different kind of conflicts because both host and
&gt; &gt; guest will try to work with same selinux label. I guess that in
&gt; &gt; practice this will be very hard to achieve as people will run
&gt; &gt; different host and guest flavors and these might have different
&gt; &gt; policies.
&gt; 
&gt; Yeah, I think there's little to no chance of people keeping the
&gt; same SELinux policy in host/guest, except in very tightly controlled
&gt; narrow use cases where the host admin exerts direct control over
&gt; the precise guest config.
&gt; 
&gt; 
&gt; &gt; So another option is to rename selinux xattr in virtiofs so that
&gt; &gt; any selinux xattr coming from guest is saved as
&gt; &gt; user.virtiofs.security.selinux xattr on host. That way host and guest
&gt; &gt; can have their separate labels without interfering with each other.
&gt; &gt; David Gilbert already has added support for this. I can't remember
&gt; &gt; the exact syntax but you can figure it out from documentation here
&gt; &gt; in xattr remappig section.
&gt; 
&gt; For general purpose virt usage, I think remapping in some way is
&gt; likely to be needed as the default strategy.
&gt; 
&gt; &gt; https://github.com/qemu/qemu/blob/master/docs/tools/virtiofsd.rst
&gt; &gt; 
&gt; &gt; But I have question with selinux xattr remapping. What will happen
&gt; &gt; to initial labels when fs is exported. I mean until and unless
&gt; &gt; some process in guest labels all the exported files, they all
&gt; &gt; with either be unlabeled or pick some generic label for all the
&gt; &gt; files.
&gt; 
&gt; I'd say you need some mechanism to force a re-label inside the
&gt; guest. Normally a relabel will be done in /.autorelabel file
&gt; is present, or in certain other scenarios like selinux policy
&gt; RPM updates.
&gt; 
&gt; We wouldn't want to force a relabel neccesarily for the entire
&gt; FS if we're just hotplugging a new virtiofs export though. So
&gt; perhaps there's scope for supporting usage of a per-mount
&gt; point relabel trigger. eg Host creates $VIRTIOFS-ROOT/.autorelabel
&gt; and whenever the guest sees a new virtiofs export arriving, it
&gt; can look for $VIRTIOFS-MOUNT-POINT/.autorelabel
&gt; 
&gt; &gt; Another option is, can we use a single label for whole of the
&gt; &gt; virtiofs (using context=&lt;label&gt;) option in guest. That way nothing
&gt; &gt; is saved in files as such. But this means that processes in guest
&gt; &gt; can't have different selinux labels on different virtiofs dir/files.
&gt; 
&gt; Forcing a single label for the entire export is passable as a
&gt; fallback plan. This is what people have done for years with
&gt; NFS v3 mounts. It has annoying usage limitations though, so
&gt; if at all possible remapping is a preferrable approach.

Another thing we should bear in mind is that it is entirely plausible for
users to want SELinux in their guest, wihle the host is not using SELinux
at all. eg running a RHEL guest, on a cloud running Ubuntu hosts.

In such a case SELinux essentially won't exist from the POV of the
host OS / admin using. Anything related to labelling will have to be
exclusively done by the guest. If we provide a general purpose way
to remap XAttrs, then this ought to be viable by having a generic
remap rule for anything the guest does.

Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20210610114104</emailId><senderName>"tommy"</senderName><senderEmail>sz_cuitao@163.com</senderEmail><timestampReceived>2021-06-10 11:41:04-0400</timestampReceived><subject>RE: why cannot connect to libvirtd using virsh ???</subject><body>

Haha, thanks!




-----Original Message-----
From: Daniel P. Berrange &lt;dan@berrange.com&gt; 
Sent: Thursday, June 10, 2021 5:56 PM
To: tommy &lt;sz_cuitao@163.com&gt;
Cc: libvirt-users@redhat.com
Subject: Re: why cannot connect to libvirtd using virsh ???

On Thu, Jun 10, 2021 at 05:37:43PM +0800, tommy wrote:
&gt; [root@test2 ~]# virsh -c quem+ssh://root@192.168.10.175/system
&gt; 
&gt; root@192.168.10.175's &lt;mailto:root@192.168.10.175's&gt;  password:
&gt; 
&gt; error: failed to connect to the hypervisor
&gt; 
&gt; error: no connection driver available for quem:///system

You've typod -   'quem' should be 'qemu'

Regards,
Daniel
--
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange
:|
|: https://libvirt.org         -o-            https://fstop138.berrange.com
:|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange
:|


</body></email><email><emailId>20210610145101</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-06-10 14:51:01-0400</timestampReceived><subject>Re: lxcContainerMountFSBind - Failed to bind mount directory</subject><body>

On 6/10/21 9:42 AM, Priyanka Gupta wrote:
&gt; Hi Everyone,
&gt; 
&gt; I am looking to understand this piece of code and error.
&gt; 
&gt; 2021-06-09 06:52:55.548+0000: 1: debug : lxcContainerMountAllFS:1612 :
&gt; Mounting all non-root filesystems
&gt; 
&gt; 2021-06-09 06:52:55.548+0000: 1: debug : lxcContainerMountAllFS:1619 :
&gt; Mounting '/bootflash/SHARED-IOX' -&gt; '/bootflash/SHARED-IOX'
&gt; 
&gt; 2021-06-09 06:52:55.548+0000: 1: debug : lxcContainerResolveSymlinks:630 :
&gt; Resolving '/bootflash/SHARED-IOX'
&gt; 
&gt; 2021-06-09 06:52:55.548+0000: 1: debug : lxcContainerResolveSymlinks:646 :
&gt; Resolved '/bootflash/SHARED-IOX' to /bootflash/SHARED-IOX
&gt; 
&gt; 2021-06-09 06:52:55.548+0000: 1: debug : lxcContainerMountFSBind:1176 :
&gt; src=/bootflash/SHARED-IOX dst=/bootflash/SHARED-IOX
&gt; 
&gt; 2021-06-09 06:52:55.548+0000: 1: error : lxcContainerMountFSBind:1223 :
&gt; Failed to bind mount directory /.oldroot/bootflash/SHARED-IOX to
&gt; /bootflash/SHARED-IOX: No such file or directory
&gt; 
&gt; 
&gt; I am on Libvirt 5.5.0
&gt; 
&gt; 
&gt; Any pointers?
&gt; 
&gt; 

Not really. Other than try to upgrade to the latest release. 5.5.0 is
kind of old.

Michal

</body></email><email><emailId>20210611150144</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-06-11 15:01:44-0400</timestampReceived><subject>Re: interface qos conflicts with ovs</subject><body>

[please keep the list CC'ed]

On 6/11/21 4:42 PM, Jiatong Shen wrote:
&gt; ah, OK. we are hitting this one when transfering to neutron ovs firewall
&gt; and would like to fix
&gt; it before moving to production.. does this bug still exist? If yes, can we
&gt; take it and try
&gt; submitting a fix? Thank you.

Sure you can! I'm happy to review patches.

Michal

</body></email><email><emailId>20210614084349</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-06-14 08:43:49-0400</timestampReceived><subject>Re: the SSL cert of libvirt.org is outdated</subject><body>

On Mon, Jun 14, 2021 at 09:21:48AM +0100, Daniel P. Berrangé wrote:
&gt; On Mon, Jun 14, 2021 at 02:14:32PM +0800, 伍翀 wrote:
&gt; &gt; hi, there,
&gt; &gt; 
&gt; &gt; the SSL cert of libvirt.org is outdated, could anyone replace it as new one?
&gt; 
&gt; Unfortunately the auto-renew process has broken, and it appears to not
&gt; be quickly fixable because LetsEncrypt have disabled the v1 ACME API
&gt; that our script. I'll need to figure out and deploy a new tool for
&gt; acquiring certs.

Wasn't as bad as first feared. Managed to find a new version of the
software we're using that actually works with v2 ACME APIs, so the
certs should be fine again now.


Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20210614155126</emailId><senderName>Laine Stump</senderName><senderEmail>laine@redhat.com</senderEmail><timestampReceived>2021-06-14 15:51:26-0400</timestampReceived><subject>Re: KVM Virtual Machine Network - Guest-guest/VM-VM only network (no host/hypervisor access, no outb</subject><body>



On 6/11/21 7:22 PM, Eduardo Lúcio Amorim Costa wrote:
&gt; I know that with the *virsh* command I can create several types of 
&gt; networks (a "NAT network", for example) as we can see in these URLs...
&gt; 
&gt; KVM network management &lt;https://programmersought.com/article/52213715009/&gt;
&gt; KVM default NAT-based networking 
&gt; &lt;https://www.ibm.com/downloads/cas/ZVJGQX8E&gt; (page 33)
&gt; 
&gt; *QUESTION:* How can I create a network (*lan_n*) where only guests/VMs 
&gt; have connectivity, with no outbound connectivity and no host/hypervisor 
&gt; connectivity?

(Just to be sure I'm understanding correctly - you want the guests on 
this network to have connectivity to each other, but not guest&lt;-&gt;host, 
and nothing beyond the host, correct?)

Normally the guests would get their DHCP-assigned IP address from the 
host, and use the host for DNS, but since you want to forbid 
guest&lt;-&gt;host communication, that implies that either one of the guests 
on the network will act as DHCP/DNS server, or that the guests will have 
statically configured IP addresses.

That being the case, all you really need is to define a libvirt virtual 
network that has no IP address on the host, e.g.:

    &lt;network&gt;
      &lt;name&gt;super-isolated&lt;/name&gt;
    &lt;/network&gt;

(It *might* be necessary to add "ipv6='yes'" immediately after "network" 
in order for IPv6 connectivity to work, but I'm not sure  and don't have 
a setup to try it right now).

&gt; 
&gt; *NOTE:* The connectivity to other resources will be provided by a 
&gt; *pfSense* firewall server that will have access to another network 
&gt; (*wan_n*) with outbound connectivity and other resources.

Yes, this is a common config - have a "super-isolated" network for all 
the guests + the firewall VM, and then the firewall VM has a 2nd 
interface that connects everyone to the outside.

&gt; 
&gt; |Network layout... [N]wan_n ↕ [I]wan_n [V]pfsense_vm [I]lan_n ↕ [N]lan_n 
&gt; ↕ ............................. ↕ ↕ ↕ [V]some_vm_0 [V]some_vm_1 
&gt; [V]some_vm_4 [V]some_vm_2 [V]some_vm_5 [V]some_vm_3 _ [N] - Network; _ 
&gt; [I] - Network Interface; _ [V] - Virtual Machine. |

Sigh. Stupid email client formatting - your original ASCII diagram 
looked nice, but just look at what Thunderbird did to it when I hit 
reply :-/ (fortunately I didn't need to refer to it)

</body></email><email><emailId>20210621095740</emailId><senderName>Andrea Bolognani</senderName><senderEmail>abologna@redhat.com</senderEmail><timestampReceived>2021-06-21 09:57:40-0400</timestampReceived><subject>Re: driver_remote option defaults to auto</subject><body>

On Mon, Jun 21, 2021 at 11:35:24AM +0200, Pavel Hrdina wrote:
&gt; On Sun, Jun 20, 2021 at 05:10:40PM +0800, Jiatong Shen wrote:
&gt; &gt; Hello community,
&gt; &gt;
&gt; &gt; I am looking at building and packaging libvirt source code. I am seeing
&gt; &gt; from commit
&gt; &gt; https://github.com/libvirt/libvirt/commit/83ff55b5a2618d32f623d7ca0b6f9c28b7253972
&gt; &gt; `driver_remote` is defaulting to auto which is different from enabled
&gt; &gt; before. I am curious what does auto mean? does it mean that meson will take
&gt; &gt; over and determine if driver_remote should be enabled or we have to write
&gt; &gt; more logic in meson.build? currently it seems there is no effort to auto
&gt; &gt; determine driver_remote. I think it is interesting because
&gt; &gt; https://github.com/libvirt/libvirt/blob/54b602019d7dfa94a6c52ef7aa3abdfaa93ed233/meson.build#L1178
&gt; &gt; sasl seems required remote_driver to have a value of enabled...
&gt;
&gt; Hi,
&gt;
&gt; I see how this may be confusing. The current code is correct and there
&gt; is no need to change anything as this one way how it can be done with
&gt; meson.
&gt;
&gt; If some option is 'feature' type and the default value is set to 'auto'
&gt; this is what meson returns:
&gt;
&gt;     get_option('opt').disabled()  -&gt;  false
&gt;     get_option('opt').auto()      -&gt;  true
&gt;     get_option('opt').enabled()   -&gt;  false
&gt;
&gt; In the case of 'driver_remote' option we have the following check:
&gt;
&gt;     if not get_option('driver_remote').disabled()
&gt;
&gt; which means that it will disable 'driver_remote' only if user calls
&gt; meson with `-Ddriver_remote=disabled`.
&gt;
&gt; If you look closer to the following lines you will see that we also
&gt; check for xdr_dep. If xdr_dep is missing and 'driver_remote' is set
&gt; to 'auto' it will not be enabled as XDR is required, but if
&gt; 'driver_remote' is set to 'enabled' but user calling meson with
&gt; `-Ddriver_remote=enabled` meson will fail with proper error message.
&gt;
&gt; Before the changes done by the first commit you mentioned the
&gt; 'driver_remote' was always enabled and if XDR was missing it always
&gt; failed and user had to explicitly use `-Ddriver_remote=disabled` on
&gt; systems where XDR is not available or if the user was not interested
&gt; in having 'driver_remote' available.

I will add that, when packaging libvirt, it's recommended to
explicitly pass -Dfeature=enabled/disabled for each and every feature
instead of relying on libvirt's autodetection getting things right:
this ensures that the build either exactly matches your expectations
or fails with a useful error message.

-- 
Andrea Bolognani / Red Hat / Virtualization

</body></email><email><emailId>20210622134855</emailId><senderName>"dberrange () yahoo ! com"</senderName><senderEmail>dberrange@yahoo.com</senderEmail><timestampReceived>2021-06-22 13:48:55-0400</timestampReceived><subject>Testing DKIM handling</subject><body>

Testing whether DKIM signatures still get mangled....

[Attachment #3 (text/html)]

&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="yahoo-style-wrap" style="font-family:Helvetica \
Neue, Helvetica, Arial, sans-serif;font-size:16px;"&gt;&lt;div dir="ltr" \
data-setdir="false"&gt;Testing whether DKIM signatures still get \
mangled....&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20210623094008</emailId><senderName>Priyanka Gupta</senderName><senderEmail>priygupt@gmail.com</senderEmail><timestampReceived>2021-06-23 09:40:08-0400</timestampReceived><subject>Re: unaccessible directory in lxcContainerResolveSymlinks</subject><body>

Hi,

If I try to add only /flash (without dir subdirerctory) into the XML, it
works fine for me.
Does it matter what sort of permissions(user/grp) /flash/dir has?

Thanks
Priyanka

On Wed, Jun 23, 2021 at 2:46 PM Michal Prívozník &lt;mprivozn@redhat.com&gt;
wrote:

&gt; On 6/23/21 11:08 AM, Priyanka Gupta wrote:
&gt; &gt; Hi Michal,
&gt; &gt;
&gt; &gt; This is how snippets from my XML looks like. Full XML at the end of the
&gt; &gt; mail..
&gt; &gt;     &lt;emulator&gt;/usr/sbin/libvirt_lxc&lt;/emulator&gt;
&gt; &gt;     &lt;filesystem type='mount' accessmode='passthrough'&gt;
&gt; &gt;       &lt;source dir='/vol/usb1/iox/repo-lxc/utd/rootfs_mnt'/&gt;
&gt; &gt;       &lt;target dir='/'/&gt;
&gt; &gt;     &lt;/filesystem&gt;
&gt; &gt;     &lt;filesystem type='mount' accessmode='passthrough'&gt;
&gt; &gt;       &lt;source dir='/flash/dir'/&gt;
&gt; &gt;       &lt;target dir='/flash/dir'/&gt;
&gt; &gt;     &lt;/filesystem&gt;
&gt; &gt;
&gt; &gt; The issue I am facing is, my container doesnt start. Fails at mounting
&gt; &gt; this /flash/dir  with below message.
&gt; &gt;
&gt; &gt; 2021-06-09 06:52:55.548+0000: 1: error : lxcContainerMountFSBind:1223 :
&gt; &gt; Failed to bind mount directory /.oldroot/flash/dir to /flash/dir: No
&gt; &gt; such file or directory
&gt;
&gt; Yeah, the lxc driver thinks that /flash/dir doesn't exist.
&gt; Unfortunately, I am unable to reproduce - when I mkdir -p /flash/dir
&gt; and add corresponding &lt;filesystem/&gt; to one of my containers it boots up
&gt; just fine. What's your libvirt version?
&gt;
&gt; Michal
&gt;
&gt;

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If I try to add only /flash (without dir \
subdirerctory) into the XML, it works fine for me.&lt;/div&gt;&lt;div&gt;Does it matter what sort \
of permissions(user/grp) /flash/dir has?  \
&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&lt;/div&gt;&lt;div&gt;Priyanka&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Wed, Jun 23, 2021 at 2:46 PM \
Michal Prívozník &lt;&lt;a \
href="mailto:mprivozn@redhat.com"&gt;mprivozn@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;On 6/23/21 11:08 AM, \
Priyanka Gupta wrote:&lt;br&gt; &gt; Hi Michal,&lt;br&gt;
&gt; &lt;br&gt;
&gt; This is how snippets from my XML looks like. Full XML at the end of the&lt;br&gt;
&gt; mail..  &lt;br&gt;
&gt;       &lt;emulator&gt;/usr/sbin/libvirt_lxc&lt;/emulator&gt;&lt;br&gt;
&gt;       &lt;filesystem type='mount' \
accessmode='passthrough'&gt;&lt;br&gt; &gt;          &lt;source \
dir='/vol/usb1/iox/repo-lxc/utd/rootfs_mnt'/&gt;&lt;br&gt; &gt;          &lt;target \
dir='/'/&gt;&lt;br&gt; &gt;       &lt;/filesystem&gt;&lt;br&gt;
&gt;       &lt;filesystem type='mount' \
accessmode='passthrough'&gt;&lt;br&gt; &gt;          &lt;source \
dir='/flash/dir'/&gt;&lt;br&gt; &gt;          &lt;target \
dir='/flash/dir'/&gt;&lt;br&gt; &gt;       &lt;/filesystem&gt;&lt;br&gt;
&gt; &lt;br&gt;
&gt; The issue I am facing is, my container doesnt start. Fails at mounting&lt;br&gt;
&gt; this /flash/dir   with below message.&lt;br&gt;
&gt; &lt;br&gt;
&gt; 2021-06-09 06:52:55.548+0000: 1: error : lxcContainerMountFSBind:1223 :&lt;br&gt;
&gt; Failed to bind mount directory /.oldroot/flash/dir to /flash/dir: No&lt;br&gt;
&gt; such file or directory&lt;br&gt;
&lt;br&gt;
Yeah, the lxc driver thinks that /flash/dir doesn't exist.&lt;br&gt;
Unfortunately, I am unable to reproduce - when I mkdir -p /flash/dir&lt;br&gt;
and add corresponding &lt;filesystem/&gt; to one of my containers it boots up&lt;br&gt;
just fine. What's your libvirt version?&lt;br&gt;
&lt;br&gt;
Michal&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;



</body></email><email><emailId>20210623123124</emailId><senderName>liang chaojun</senderName><senderEmail>jesonliang040705@hotmail.com</senderEmail><timestampReceived>2021-06-23 12:31:24-0400</timestampReceived><subject>Re: Libvirt hit a issue when do VM migration</subject><body>

[Attachment #2 (multipart/related)]

[Attachment #4 (multipart/alternative)]

[Attachment #6 (text/plain)]

Thanks Peter for your help as well as your suggestion. I have got the cues of this \
issue.

Current there still exist another issue that confuse me that we random hit VM can't \
boot and  stuck in black screen show as "Guest has not initialized the display \
(yet)."

The attachment is the Libvirt debug log but I'm not able to find any useful cues.  \
Any comments regarding this issue will be appreciated.



[cid:a29599f6-5c30-4804-a2f1-65b1027a7e10@jpnprd01.prod.outlook.com]


&gt; 在 2021年6月17日，下午8:21，Peter Krempa &lt;pkrempa@redhat.com&gt; 写道：
&gt; 
&gt; Firstly please don't CC random people who are subscribed to the list.
&gt; 
&gt; Additionally this is a user-question so it's not entirely appropriate
&gt; for libvir-list@redhat.com only for libvirt-users@redhat.com.
&gt; 
&gt; On Thu, Jun 17, 2021 at 16:52:42 +0800, 梁朝军 wrote:
&gt; &gt; Hi All,
&gt; &gt; 
&gt; &gt; Who can give me a help? I hit another issue when do vm migration?  Libvirt throw \
&gt; &gt; out the error like below 
&gt; &gt; "libvirt: Domain Config error : unsupported configuration: vcpu enable order of \
&gt; &gt; vCPU '0' differs between source and destination definitions"
&gt; 
&gt; This error happens when the 'order' attribute ...
&gt; 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; The cup information is defined VM domain on source host is like:
&gt; &gt; &lt;vcpu placement='static'&gt;2&lt;/vcpu&gt;
&gt; &gt; &lt;vcpus&gt;
&gt; &gt; &lt;vcpu id='0' enabled='yes' hotpluggable='no' order='1'/&gt;
&gt; &gt; &lt;vcpu id='1' enabled='yes' hotpluggable='no' order='2'/&gt;
&gt; 
&gt; ... such you can see here doesn't match for a vcpu of a particular ID.
&gt; 
&gt; &gt; &lt;/vcpus&gt;
&gt; &gt; &lt;cputune&gt;
&gt; &gt; &lt;vcpupin vcpu='0' cpuset='42'/&gt;
&gt; &gt; &lt;vcpupin vcpu='1' cpuset='43'/&gt;
&gt; &gt; &lt;/cputune&gt;
&gt; &gt; 
&gt; &gt; The distinction host previews generate xml for VM like:
&gt; &gt; 
&gt; &gt; &lt;vcpu placement='static'&gt;2&lt;/vcpu&gt;
&gt; &gt; &lt;vcpus&gt;
&gt; &gt; &lt;vcpu id='0' enabled='yes' hotpluggable='no' order='1'/&gt;
&gt; &gt; &lt;vcpu id='1' enabled='yes' hotpluggable='no' order='2'/&gt;
&gt; 
&gt; Yours do match though. Did you post the correct XMLs?
&gt; 
&gt; &gt; &lt;/vcpus&gt;
&gt; &gt; &lt;cputune&gt;
&gt; &gt; &lt;vcpupin vcpu='0' cpuset='42'/&gt;
&gt; &gt; &lt;vcpupin vcpu='1' cpuset='43'/&gt;
&gt; &gt; &lt;/cputune&gt;
&gt; &gt; 
&gt; &gt; What't wrong with it? Or I missing some actions in configurations regarding the \
&gt; &gt; migration
&gt; 
&gt; It's unfortunately impossible to tell, your report doesn't descirbe what
&gt; steps you took to do the migration nor does contain debug logs.
&gt; 


[Attachment #7 (text/html)]

&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div class="BodyFragment"&gt;&lt;font size="2"&gt;&lt;span style="font-size:11pt;"&gt;
&lt;div class="PlainText"&gt;Thanks Peter for your help as well as your suggestion. I have \
got the cues of this issue.&lt;br&gt; &lt;br&gt;
Current there still exist another issue that confuse me that we random hit VM can't \
boot and  stuck in black screen show as "Guest has not initialized the display \
(yet)." &lt;br&gt;
&lt;br&gt;
The attachment is the Libvirt debug log but I'm not able to find any useful \
cues.  Any comments regarding this issue will be appreciated.&lt;/div&gt; \
&lt;/span&gt;&lt;/font&gt;&lt;/div&gt; &lt;div class="BodyFragment"&gt;&lt;font size="2"&gt;&lt;span \
style="font-size:11pt;"&gt; &lt;div class="PlainText"&gt;&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;
&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;img src="cid:a29599f6-5c30-4804-a2f1-65b1027a7e10@jpnprd01.prod.outlook.com"&gt;
&lt;/div&gt;
&lt;div class="BodyFragment"&gt;&lt;font size="2"&gt;&lt;span style="font-size:11pt;"&gt;
&lt;div class="PlainText"&gt;&lt;br&gt;
&lt;br&gt;
&gt; 在 2021年6月17日，下午8:21，Peter Krempa &lt;pkrempa@redhat.com&gt; \
写道：&lt;br&gt; &gt; &lt;br&gt;
&gt; Firstly please don't CC random people who are subscribed to the list.&lt;br&gt;
&gt; &lt;br&gt;
&gt; Additionally this is a user-question so it's not entirely appropriate&lt;br&gt;
&gt; for libvir-list@redhat.com only for libvirt-users@redhat.com.&lt;br&gt;
&gt; &lt;br&gt;
&gt; On Thu, Jun 17, 2021 at 16:52:42 +0800, 梁朝军 wrote:&lt;br&gt;
&gt;&gt; Hi All,&lt;br&gt;
&gt;&gt; &lt;br&gt;
&gt;&gt; Who can give me a help? I hit another issue when do vm migration?  \
Libvirt throw out the error like below&lt;br&gt; &gt;&gt; &lt;br&gt;
&gt;&gt; "libvirt: Domain Config error : unsupported configuration: vcpu enable \
order of vCPU '0' differs between source and destination definitions"&lt;br&gt; &gt; &lt;br&gt;
&gt; This error happens when the 'order' attribute ...&lt;br&gt;
&gt; &lt;br&gt;
&gt;&gt; &lt;br&gt;
&gt;&gt; &lt;br&gt;
&gt;&gt; The cup information is defined VM domain on source host is like: &lt;br&gt;
&gt;&gt; &lt;vcpu placement='static'&gt;2&lt;/vcpu&gt;&lt;br&gt;
&gt;&gt; &lt;vcpus&gt;&lt;br&gt;
&gt;&gt; &lt;vcpu id='0' enabled='yes' hotpluggable='no' order='1'/&gt;&lt;br&gt;
&gt;&gt; &lt;vcpu id='1' enabled='yes' hotpluggable='no' order='2'/&gt;&lt;br&gt;
&gt; &lt;br&gt;
&gt; ... such you can see here doesn't match for a vcpu of a particular ID.&lt;br&gt;
&gt; &lt;br&gt;
&gt;&gt; &lt;/vcpus&gt;&lt;br&gt;
&gt;&gt; &lt;cputune&gt;&lt;br&gt;
&gt;&gt; &lt;vcpupin vcpu='0' cpuset='42'/&gt;&lt;br&gt;
&gt;&gt; &lt;vcpupin vcpu='1' cpuset='43'/&gt;&lt;br&gt;
&gt;&gt; &lt;/cputune&gt;&lt;br&gt;
&gt;&gt; &lt;br&gt;
&gt;&gt; The distinction host previews generate xml for VM like:&lt;br&gt;
&gt;&gt; &lt;br&gt;
&gt;&gt; &lt;vcpu placement='static'&gt;2&lt;/vcpu&gt;&lt;br&gt;
&gt;&gt; &lt;vcpus&gt;&lt;br&gt;
&gt;&gt; &lt;vcpu id='0' enabled='yes' hotpluggable='no' order='1'/&gt;&lt;br&gt;
&gt;&gt; &lt;vcpu id='1' enabled='yes' hotpluggable='no' order='2'/&gt;&lt;br&gt;
&gt; &lt;br&gt;
&gt; Yours do match though. Did you post the correct XMLs?&lt;br&gt;
&gt; &lt;br&gt;
&gt;&gt; &lt;/vcpus&gt;&lt;br&gt;
&gt;&gt; &lt;cputune&gt;&lt;br&gt;
&gt;&gt; &lt;vcpupin vcpu='0' cpuset='42'/&gt;&lt;br&gt;
&gt;&gt; &lt;vcpupin vcpu='1' cpuset='43'/&gt;&lt;br&gt;
&gt;&gt; &lt;/cputune&gt;&lt;br&gt;
&gt;&gt; &lt;br&gt;
&gt;&gt; What't wrong with it? Or I missing some actions in configurations regarding \
the migration&lt;br&gt; &gt; &lt;br&gt;
&gt; It's unfortunately impossible to tell, your report doesn't descirbe what&lt;br&gt;
&gt; steps you took to do the migration nor does contain debug logs.&lt;br&gt;
&gt; &lt;br&gt;
&lt;br&gt;
&lt;/div&gt;
&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;


["PastedGraphic-1.png" (image/png)]
["testvm_cuhv7a54.log" (application/octet-stream)]

</body></email><email><emailId>20210625160102</emailId><senderName>Riccardo Ravaioli</senderName><senderEmail>riccardoravaioli@gmail.com</senderEmail><timestampReceived>2021-06-25 16:01:02-0400</timestampReceived><subject>Re: issue when not using acpi indices in libvirt 7.4.0 and qemu 6.0.0</subject><body>

On Thu, 24 Jun 2021 at 04:11, Laine Stump &lt;laine@redhat.com&gt; wrote:

&gt; [...]
&gt;

Hi Laine,

Thank you so much for your analysis and thoughtful insights. As you noticed
straight away, there were indeed some minor differences in the two VM
definitions that I didn't see before posting. The interface naming was not
biased by this in the end.

Anyway, we found out that the problem actually lay in qemu 6.0.0, which was
promptly patched by its maintainers after we contacted them:
https://lists.nongnu.org/archive/html/qemu-stable/2021-06/msg00058.html

Thanks again!

Riccardo

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Thu, 24 \
Jun 2021 at 04:11, Laine Stump &lt;&lt;a \
href="mailto:laine@redhat.com"&gt;laine@redhat.com&lt;/a&gt;&gt; wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote \
class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid \
rgb(204,204,204);padding-left:1ex"&gt;[...]&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Hi \
Laine,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thank you so much for your analysis and thoughtful \
insights. As you noticed straight away, there were indeed some minor differences in \
the two VM definitions that I didn't see before posting. The interface naming was \
not biased by this in the end.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Anyway, we found out that \
the problem actually lay in qemu 6.0.0, which was promptly patched by its maintainers \
after we contacted them:&lt;/div&gt;&lt;div&gt;&lt;a \
href="https://lists.nongnu.org/archive/html/qemu-stable/2021-06/msg00058.html"&gt;https:/ \
/lists.nongnu.org/archive/html/qemu-stable/2021-06/msg00058.html&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks \
again!&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Riccardo&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210628040002</emailId><senderName>Han Han</senderName><senderEmail>hhan@redhat.com</senderEmail><timestampReceived>2021-06-28 04:00:02-0400</timestampReceived><subject>Fail to do blockcopy to network dest xml with --reuse-external</subject><body>

Hello, libvirt developers,
Recently I find an issue of libvirt blockcopy:
Versions:
libvirt-7.4.0
qemu-kvm-6.0.0

Steps:
1. Create a nbd server
# qemu-img create -f qcow2 /var/lib/libvirt/images/fedora-1.qcow2 10G -o
preallocation=full

# qemu-nbd -e 10 /var/lib/libvirt/images/fedora-1.qcow2 -p 10001

2. Prepare a running VM
# virsh list
 Id   Name     State
------------------------
 3    fedora   running

# virsh dumpxml 3|xmllint --xpath //disk -
&lt;disk type="file" device="disk"&gt;
      &lt;driver name="qemu" type="qcow2"/&gt;
      &lt;source file="/var/lib/libvirt/images/fedora.qcow2" index="1"/&gt;
      &lt;backingStore/&gt;
      &lt;target dev="hda" bus="ide"/&gt;
      &lt;alias name="ide0-0-0"/&gt;
      &lt;address type="drive" controller="0" bus="0" target="0" unit="0"/&gt;
    &lt;/disk&gt;

3. Blockcopy to a nbd dest xml with --reuse-external
# cat /tmp/copy.xml
    &lt;disk type='network' device='disk'&gt;
      &lt;driver name='qemu' type='qcow2'/&gt;
      &lt;source protocol="nbd"&gt;
        &lt;host name="localhost" port="10001" /&gt;
      &lt;/source&gt;
      &lt;backingStore/&gt;
      &lt;target dev='hda' bus='ide'/&gt;
    &lt;/disk&gt;

# virsh blockcopy fedora hda --xml /tmp/copy.xml --transient-job --wait
--verbose --finish  --reuse-external
error: unsupported configuration: reused mirror destination format must be
specified

But it works without --reuse-external
# virsh blockcopy fedora hda --xml /tmp/copy.xml --transient-job --wait
--verbose --finish
Block Copy: [100 %]
Successfully copied


Since it is clear that the format of dest image is qcow2, the error message
"reused mirror destination format must be specified" is wrong. The
blockcopy with network disk + --reuse-external should either be supported
or post a better error message.

I am not sure if --reuse-external flag is only for file type disk. It seems
the description of VIR_DOMAIN_BLOCK_COPY_REUSE_EXT(
https://github.com/libvirt/libvirt/blob/7c08141f906e20e730c4b6407bc638e743deea48/src/libvirt-domain.c#L10479)
 indicates this flag is for file only:
 * VIR_DOMAIN_BLOCK_COPY_REUSE_EXT flag is present stating that the file
 * was pre-created with the correct format and metadata and sufficient
 * size to hold the copy. In case the VIR_DOMAIN_BLOCK_COPY_SHALLOW flag
 * is used the pre-created file has to exhibit the same guest visible
contents
 * as the backing file of the original image. This allows a management app
to
 * pre-create files with relative backing file names, rather than the
default
 * of absolute backing file names.

Please help to confirm if it is a bug here.


[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div&gt;Hello, libvirt developers,&lt;/div&gt;&lt;div&gt;Recently I find an issue of \
libvirt blockcopy:&lt;/div&gt;&lt;div&gt;Versions:&lt;/div&gt;&lt;div&gt;libvirt-7.4.0&lt;/div&gt;&lt;div&gt;qemu-kvm-6.0.0&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Steps:&lt;/div&gt;&lt;div&gt;1. \
Create a nbd server&lt;/div&gt;&lt;div&gt;# qemu-img create -f qcow2 \
/var/lib/libvirt/images/fedora-1.qcow2 10G -o \
preallocation=full&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;# qemu-nbd -e 10 \
/var/lib/libvirt/images/fedora-1.qcow2 -p 10001&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;2. Prepare a \
running VM&lt;/div&gt;&lt;div&gt;# virsh list &lt;br&gt;  Id    Name       \
State&lt;br&gt;------------------------&lt;br&gt;  3      fedora    \
running&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;# virsh dumpxml 3|xmllint --xpath //disk \
-&lt;br&gt;&lt;disk type="file" device="disk"&gt;&lt;br&gt;         \
&lt;driver name="qemu" type="qcow2"/&gt;&lt;br&gt;         &lt;source \
file="/var/lib/libvirt/images/fedora.qcow2" index="1"/&gt;&lt;br&gt;    \
&lt;backingStore/&gt;&lt;br&gt;         &lt;target dev="hda" \
bus="ide"/&gt;&lt;br&gt;         &lt;alias name="ide0-0-0"/&gt;&lt;br&gt;     \
&lt;address type="drive" controller="0" bus="0" \
target="0" unit="0"/&gt;&lt;br&gt;      \
&lt;/disk&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;3. Blockcopy to a nbd dest xml with \
--reuse-external&lt;/div&gt;&lt;div&gt;# cat /tmp/copy.xml&lt;br&gt;      &lt;disk \
type='network' device='disk'&gt;&lt;br&gt;         &lt;driver \
name='qemu' type='qcow2'/&gt;&lt;br&gt;         &lt;source \
protocol="nbd"&gt;&lt;br&gt;            &lt;host name="localhost" \
port="10001" /&gt;&lt;br&gt;         &lt;/source&gt;&lt;br&gt;         \
&lt;backingStore/&gt;&lt;br&gt;         &lt;target dev='hda' \
bus='ide'/&gt;&lt;br&gt;      &lt;/disk&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;# virsh \
blockcopy fedora hda --xml /tmp/copy.xml --transient-job --wait --verbose --finish   \
--reuse-external &lt;br&gt;error: unsupported configuration: reused mirror destination \
format must be specified&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;But it works without \
--reuse-external&lt;/div&gt;&lt;div&gt;# virsh blockcopy fedora hda --xml /tmp/copy.xml \
--transient-job --wait --verbose --finish &lt;br&gt;Block Copy: [100 %]&lt;br&gt;Successfully \
copied&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span class="gmail-pl-c"&gt;Since it is \
clear that the format of dest image is qcow2, the error message "reused mirror \
destination format must be specified" is wrong. The blockcopy with network disk \
+ --reuse-external should either be supported or post a better error \
message.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I am not sure if --reuse-external flag is \
only for file type disk. It seems the description of &lt;span \
class="gmail-pl-c"&gt;VIR_DOMAIN_BLOCK_COPY_REUSE_EXT(&lt;a \
href="https://github.com/libvirt/libvirt/blob/7c08141f906e20e730c4b6407bc638e743deea48 \
/src/libvirt-domain.c#L10479"&gt;https://github.com/libvirt/libvirt/blob/7c08141f906e20e730c4b6407bc638e743deea48/src/libvirt-domain.c#L10479&lt;/a&gt;) \
indicates this flag is for file only:&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span class="gmail-pl-c"&gt;  * \
VIR_DOMAIN_BLOCK_COPY_REUSE_EXT flag is present stating that the file&lt;br&gt;  * was \
pre-created with the correct format and metadata and sufficient&lt;br&gt;  * size to hold \
the copy. In case the VIR_DOMAIN_BLOCK_COPY_SHALLOW flag&lt;br&gt;  * is used the \
pre-created file has to exhibit the same guest visible contents&lt;br&gt;  * as the backing \
file of the original image. This allows a management app to&lt;br&gt;  * pre-create files \
with relative backing file names, rather than the default&lt;br&gt;  * of absolute backing \
file names.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span class="gmail-pl-c"&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
class="gmail-pl-c"&gt;Please help to confirm if it is a bug \
here.&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span class="gmail-pl-c"&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210511071557</emailId><senderName>Jiatong Shen</senderName><senderEmail>yshxxsjt715@gmail.com</senderEmail><timestampReceived>2021-05-11 07:15:57-0400</timestampReceived><subject>boot arm64 guest stuck</subject><body>

hello community,

I am stuck at a problem where a virtual machine stuck at "guest has not
initialized the display" on a arm64 (FT2000+) server and the relevant qemu
process will continue to have a cpu usage of 100%.

I do try with different qemu and qemu-efi combined and found out that if I
use qemu build qemu-system-arm/now 1:2.11+dfsg-1ubuntu7.15~cloud1 arm64
with qemu-efi/now 0~20160408.ffea0a2c-2 all and set gic-version to 2, the
vm could boot.

the virtual machine uses a kylink 4.0 image. I am scrubbing my head to
debug the bug and find out the reason...

any idea or advice will be appreciated. thank you very much for the help

-- 

Best Regards,

Jiatong Shen

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;hello community,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I am stuck at a problem where a \
virtual machine stuck at "guest has not initialized the display" on a arm64 \
(FT2000+) server and the relevant qemu process will continue to have a cpu usage of \
100%.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I do try with different qemu and qemu-efi combined and \
found out that if I use qemu build qemu-system-arm/now 1:2.11+dfsg-1ubuntu7.15~cloud1 \
arm64 with  qemu-efi/now 0~20160408.ffea0a2c-2 all and set gic-version to 2, the vm \
could boot.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;the virtual machine uses a kylink 4.0 image. I \
am scrubbing my head to debug the bug and find out the \
reason...&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;any idea or advice  will be  appreciated. thank \
you very much for the help&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- &lt;br&gt;&lt;div dir="ltr" \
class="gmail_signature" data-smartmail="gmail_signature"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;div&gt;Best \
Regards,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Jiatong Shen&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210519115147</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-05-19 11:51:47-0400</timestampReceived><subject>Re: virHostdevIsPCINodeDeviceUsed</subject><body>

On 5/19/21 1:38 PM, Simon Fairweather wrote:
&gt; Thanks, I will raise an issue and look to see if I can raise a patch.
&gt; 
&gt; Regards
&gt; Simon
&gt; 
&gt; On Wed, May 19, 2021 at 11:38 AM Michal Prívozník &lt;mprivozn@redhat.com&gt;
&gt; wrote:
&gt; 
&gt;&gt; On 5/17/21 8:36 PM, Simon Fairweather wrote:
&gt;&gt;&gt; I am looking to be able to check if a specific PCI device is allocated
&gt;&gt; to a
&gt;&gt;&gt; guest.
&gt;&gt;&gt;
&gt;&gt;&gt; An error is produced if a domain is started and the device is in use
&gt;&gt; within
&gt;&gt;&gt; another domain via this function.
&gt;&gt;&gt;
&gt;&gt;&gt; I cannot see a publicly available function to use to get this
&gt;&gt; information,
&gt;&gt;&gt; is there one available or is there another way to check the state of the
&gt;&gt;&gt; PCI device.
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt; Yeah, there's no public API. So far we recommended mgmt apps to track
&gt;&gt; the usage themselves, however I don't see why we shouldn't have a new
&gt;&gt; API, say:
&gt;&gt;
&gt;&gt; int virNodeDeviceGetUsed(virNodeDevicePtr dev, char **drvname, char
&gt;&gt; **domname);

Just a note - of course I forgot the mandatory flags argument, so this
can be:

int virNodeDeviceGetUsed(virNodeDevicePtr dev, char **drvname, char
**domname, unsigned int flags);

Even though we don't have any flags to pass yet the argument needs to be
there as it ensures future extension.

In general this is a good start: https://libvirt.org/api_extension.html

Michal

</body></email><email><emailId>20210521165926</emailId><senderName>Link Dupont</senderName><senderEmail>link@sub-pop.net</senderEmail><timestampReceived>2021-05-21 16:59:26-0400</timestampReceived><subject>virtiofs mounted filesystems &amp; SELinux</subject><body>

I am mounting a filesystem into a domain using the virtiofs driver.

&lt;filesystem accessmode="passthrough" type="mount"&gt;
      &lt;source dir="/home"/&gt;
      &lt;target dir="/home"/&gt;
      &lt;driver type="virtiofs"/&gt;
&lt;/filesystem&gt;

Both my host (Fedora 34) and guest (CentOS 8.4) are running with SELinux 
enforcing. From my host, I can see that the SELinux context type is set to 
user_home_dir_t.

$ ls -ldZ /home/link
drwxr-xr-x. 61 link link system_u:object_r:user_home_dir_t:s0 8192 May 21 
12:41 /home/link

&gt;From within the guest however, the volume is unlabeled_t

$ ls -lZd /home/link
drwxr-xr-x. 61 link link system_u:object_r:unlabeled_t:s0 8192 May 21 12:53 /
home/link

Is there a way to pass the SELinux context through to the guest? Or mount the 
volume with the correct options to map SELinux contexts?


</body></email><email><emailId>20210524110828</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-05-24 11:08:28-0400</timestampReceived><subject>Re: How to hot plugin a new vhost-user-blk-pci device to running VM?</subject><body>

On Mon, May 24, 2021 at 01:04:44PM +0200, Michal Prívozník wrote:
&gt; On 5/21/21 5:28 PM, 梁朝军 wrote:
&gt; &gt; Thanks all of you for your help.
&gt; &gt; One more question regarding  vhost-user-blk-pci type device,  how to identify a \
&gt; &gt; vhost-blk disk in QEUM VM ?  for example, disk name looks like vda,vdb,..., but \
&gt; &gt; that some application in VM want to detect  that a certain entry is really the \
&gt; &gt; device it is waiting for. Specific for windows , they always show as disk 0, 1, \
&gt; &gt; 2….etc Is there any way to identify those disk with each other in VM?
&gt; 
&gt; In general no. Usually disks will be enumerated sequentially - thus the
&gt; first disk on a sata/scsi/usb/.. bus will be sda, the second will be
&gt; sdb, and so on. But libvirt can't guarantee it - the same way you can't
&gt; guarantee how a disk is going to be called with real HW.

You can set the 'serial' property in the disk in libvirt, and then match
that in the guest. For Linux guests that's used in /dev/disk/by-id
symlinks.

Regards,
Daniel
-- 
&gt; &gt; https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
&gt; &gt; https://libvirt.org         -o-            https://fstop138.berrange.com :|
&gt; &gt; https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|


</body></email><email><emailId>20210524162834</emailId><senderName>William Kern</senderName><senderEmail>wkern@pixelgate.net</senderEmail><timestampReceived>2021-05-24 16:28:34-0400</timestampReceived><subject>Re: Console of P2V?</subject><body>

On 5/24/21 3:22 AM, vrms wrote:
&gt;
&gt;
&gt; On 24.05.21 03:12, W wrote:
&gt;&gt; well libvirt has to know about the serial port and attach it to the 
&gt;&gt; console.
&gt;&gt;
&gt;&gt; do you have something like this in your XML file?
&gt;&gt;
&gt;&gt;
&gt;&gt; &lt;serial type='pty'&gt;
&gt;&gt;       &lt;source path='/dev/pts/0'/&gt;
&gt;&gt;       &lt;target type='isa-serial' port='0'&gt;
&gt;&gt;         &lt;model name='isa-serial'/&gt;
&gt;&gt;       &lt;/target&gt;
&gt;&gt;       &lt;alias name='serial0'/&gt;
&gt;&gt;     &lt;/serial&gt;
&gt;&gt;     &lt;console type='pty' tty='/dev/pts/0'&gt;
&gt;&gt;       &lt;source path='/dev/pts/0'/&gt;
&gt;&gt;       &lt;target type='serial' port='0'/&gt;
&gt;&gt;       &lt;alias name='serial0'/&gt;
&gt;&gt;     &lt;/console&gt;
&gt;
&gt; no, I have:
&gt;
&gt;     &lt;serial type='pty'&gt;
&gt;       &lt;target type='isa-serial' port='0'&gt;
&gt;         &lt;model name='isa-serial'/&gt;
&gt;       &lt;/target&gt;
&gt;     &lt;/serial&gt;
&gt;     &lt;console type='pty'&gt;
&gt;       &lt;target type='serial' port='0'/&gt;
&gt;     &lt;/console&gt;
&gt;
&gt; I can edit this with *virsh edit [domain]* but the get the same 
&gt; results as before.
&gt; When I look into the file thereafter, all edits are gone even though I 
&gt; got a success message with the editing
&gt;
&gt;
&gt;
well i typically undefine , edit and then define.  Look at the docs.

It is likely that you have to stop and start the VM any for your system 
to see the new config. I doubt you can hotplug a serial interface.

With that in mind you could simpy dumpxml, stop the VM, edit the XML and 
restart the VM with the edited XML.

Also as a point of reference, a coworker just mentioned the virsh 
ttyconsole command

If the console is there it will tell you which one is configured.


# virsh ttyconsole vm137
/dev/pts/1

otherwise it just exits(1).




&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; On 5/23/2021 12:52 AM, vrms wrote:
&gt;&gt;
&gt;&gt;&gt; hi William
&gt;&gt;&gt;
&gt;&gt;&gt; On 22.05.21 23:59, William wrote:
&gt;&gt;&gt;&gt; I generally use
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; GRUB_CMDLINE_LINUX_DEFAULT="console=tty0 console=ttyS0,115200n8"
&gt;&gt;&gt;&gt; and redo grub.cfg (i.e. update-grub, grub2-mkconfig)
&gt;&gt;&gt; thanks for the pointer.
&gt;&gt;&gt;
&gt;&gt;&gt; I literally ran in the guests commandline
&gt;&gt;&gt;
&gt;&gt;&gt;      GRUB_CMDLINE_LINUX_DEFAULT="console=tty0 console=ttyS0,115200n8"
&gt;&gt;&gt;      sudo update-grub
&gt;&gt;&gt;
&gt;&gt;&gt; which did change anything to the behavior on the hosts cli
&gt;&gt;&gt;
&gt;&gt;&gt;     Connected to domain '[domain]'
&gt;&gt;&gt;     Escape character is ^] (Ctrl + ])
&gt;&gt;&gt;
&gt;&gt;&gt; and then nothing
&gt;&gt;&gt;
&gt;&gt;&gt; so ... what is the error I am making?
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; On 5/22/2021 2:49 PM, Ken D'Ambrosio wrote:
&gt;&gt;&gt;&gt;&gt;&gt; On 22.05.21 18:52, Ken D'Ambrosio wrote:
&gt;&gt;&gt;&gt;&gt;&gt; ... apologies if this isn't quite the right list, I tried to get the
&gt;&gt;&gt;&gt;&gt;&gt; right one.
&gt;&gt;&gt;&gt;&gt;&gt; But, my problem: I'm firing up a Centos 6.5 box &gt; with virt-install,
&gt;&gt;&gt;&gt;&gt;&gt; [...] and
&gt;&gt;&gt;&gt;&gt;&gt; it boots fine, etc., etc., but I can't get to the console except
&gt;&gt;&gt;&gt;&gt;&gt; through vnc;
&gt;&gt;&gt;&gt;&gt;&gt; "virsh console" just shows a blank screen.
&gt;&gt;&gt;&gt;&gt;&gt; 1. I think this is absolutely the right list for your issue
&gt;&gt;&gt;&gt;&gt; Yay. :-)
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; 2. is it really blank? or something like
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;     Connected to domain '[domain]'
&gt;&gt;&gt;&gt;&gt;&gt;     Escape character is ^] (Ctrl + ])
&gt;&gt;&gt;&gt;&gt; Okay, it *does* say those things -- but that's all it says. &lt;CR&gt; gets
&gt;&gt;&gt;&gt;&gt; me nowhere, as opposed to the other KVM hosts we have running.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; 3. If I am not mistaken the guest needs to be configured in a
&gt;&gt;&gt;&gt;&gt;&gt; certain way for
&gt;&gt;&gt;&gt;&gt;&gt; virsh console [domain] to work. I can't say how though
&gt;&gt;&gt;&gt;&gt; Hmmm... well, if anyone knows, I'm all ears.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Thanks for the reply!
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;


[Attachment #3 (text/html)]

&lt;html&gt;
  &lt;head&gt;
    &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;div class="moz-cite-prefix"&gt;On 5/24/21 3:22 AM, vrms wrote:&lt;br&gt;
    &lt;/div&gt;
    &lt;blockquote type="cite"
      cite="mid:a8ecd56c-3d42-7952-2676-623f70c7a646@netcologne.de"&gt;
      &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
      &lt;br&gt;
      &lt;br&gt;
      &lt;div class="moz-cite-prefix"&gt;On 24.05.21 03:12, W wrote:&lt;br&gt;
      &lt;/div&gt;
      &lt;blockquote type="cite"
        cite="mid:f6e0a7a6-679d-da5a-be50-ddc3df2cc2bb@pixelgate.net"&gt;well
        libvirt has to know about the serial port and attach it to the
        console. &lt;br&gt;
        &lt;br&gt;
        do you have something like this in your XML file? &lt;br&gt;
        &lt;br&gt;
        &lt;br&gt;
          &lt;font color="#a01414"&gt;&lt;serial type='pty'&gt; &lt;br&gt;
                &lt;source path='/dev/pts/0'/&gt; &lt;br&gt;
                &lt;target type='isa-serial' port='0'&gt; &lt;br&gt;
                  &lt;model name='isa-serial'/&gt; &lt;br&gt;
                &lt;/target&gt; &lt;br&gt;
                &lt;alias name='serial0'/&gt; &lt;br&gt;
              &lt;/serial&gt; &lt;/font&gt;&lt;br&gt;
            &lt;console type='pty' tty='/dev/pts/0'&gt; &lt;br&gt;
              &lt;source path='/dev/pts/0'/&gt; &lt;br&gt;
              &lt;target type='serial' port='0'/&gt; &lt;br&gt;
              &lt;alias name='serial0'/&gt; &lt;br&gt;
            &lt;/console&gt; &lt;br&gt;
      &lt;/blockquote&gt;
      &lt;br&gt;
      no, I have:&lt;br&gt;
      &lt;br&gt;
          &lt;serial type='pty'&gt;&lt;br&gt;
            &lt;target type='isa-serial' port='0'&gt;&lt;br&gt;
              &lt;model name='isa-serial'/&gt;&lt;br&gt;
            &lt;/target&gt;&lt;br&gt;
          &lt;/serial&gt;&lt;br&gt;
          &lt;console type='pty'&gt;&lt;br&gt;
            &lt;target type='serial' port='0'/&gt;&lt;br&gt;
          &lt;/console&gt;&lt;br&gt;
      &lt;br&gt;
      I can edit this with &lt;b&gt;virsh edit [domain]&lt;/b&gt; but the get the
      same results as before. &lt;br&gt;
      When I look into the file thereafter, all edits are gone even
      though I got a success message with the editing &lt;br&gt;
      &lt;br&gt;
      &lt;br&gt;
      &lt;br&gt;
    &lt;/blockquote&gt;
    &lt;p&gt;well i typically undefine , edit and then define.  Look at the
      docs.&lt;br&gt;
    &lt;/p&gt;
    &lt;p&gt;It is likely that you have to stop and start the VM any for your
      system to see the new config. I doubt you can hotplug a serial
      interface.&lt;br&gt;
    &lt;/p&gt;
    &lt;p&gt;With that in mind you could simpy dumpxml, stop the VM, edit the
      XML and restart the VM with the edited XML.&lt;/p&gt;
    &lt;p&gt;Also as a point of reference, a coworker just mentioned the virsh
      ttyconsole command&lt;/p&gt;
    &lt;p&gt;If the console is there it will tell you which one is configured.&lt;br&gt;
    &lt;/p&gt;
    &lt;p&gt;&lt;br&gt;
      # virsh ttyconsole vm137&lt;br&gt;
      /dev/pts/1&lt;br&gt;
      &lt;br&gt;
      otherwise it just exits(1).&lt;/p&gt;
    &lt;p&gt;&lt;br&gt;
    &lt;/p&gt;
    &lt;p&gt;&lt;br&gt;
    &lt;/p&gt;
    &lt;p&gt;&lt;br&gt;
    &lt;/p&gt;
    &lt;blockquote type="cite"
      cite="mid:a8ecd56c-3d42-7952-2676-623f70c7a646@netcologne.de"&gt; &lt;br&gt;
      &lt;blockquote type="cite"
        cite="mid:f6e0a7a6-679d-da5a-be50-ddc3df2cc2bb@pixelgate.net"&gt; &lt;br&gt;
        &lt;br&gt;
        &lt;br&gt;
        On 5/23/2021 12:52 AM, vrms wrote: &lt;br&gt;
        &lt;br&gt;
        &lt;blockquote type="cite"&gt;hi William &lt;br&gt;
          &lt;br&gt;
          On 22.05.21 23:59, William wrote: &lt;br&gt;
          &lt;blockquote type="cite"&gt;I generally use &lt;br&gt;
            &lt;br&gt;
            GRUB_CMDLINE_LINUX_DEFAULT="console=tty0
            console=ttyS0,115200n8" &lt;br&gt;
            and redo grub.cfg (i.e. update-grub, grub2-mkconfig) &lt;br&gt;
          &lt;/blockquote&gt;
          thanks for the pointer. &lt;br&gt;
          &lt;br&gt;
          I literally ran in the guests commandline &lt;br&gt;
          &lt;br&gt;
               GRUB_CMDLINE_LINUX_DEFAULT="console=tty0
          console=ttyS0,115200n8" &lt;br&gt;
               sudo update-grub &lt;br&gt;
          &lt;br&gt;
          which did change anything to the behavior on the hosts cli &lt;br&gt;
          &lt;br&gt;
              Connected to domain '[domain]' &lt;br&gt;
              Escape character is ^] (Ctrl + ]) &lt;br&gt;
          &lt;br&gt;
          and then nothing &lt;br&gt;
          &lt;br&gt;
          so ... what is the error I am making? &lt;br&gt;
          &lt;br&gt;
          &lt;br&gt;
          &lt;br&gt;
          &lt;br&gt;
          &lt;br&gt;
          &lt;br&gt;
          &lt;blockquote type="cite"&gt;On 5/22/2021 2:49 PM, Ken D'Ambrosio
            wrote: &lt;br&gt;
            &lt;blockquote type="cite"&gt;
              &lt;blockquote type="cite"&gt;On 22.05.21 18:52, Ken D'Ambrosio
                wrote: &lt;br&gt;
                ... apologies if this isn't quite the right list, I
                tried to get the &lt;br&gt;
                right one. &lt;br&gt;
                But, my problem: I'm firing up a Centos 6.5 box &gt;
                with virt-install, &lt;br&gt;
                [...] and &lt;br&gt;
                it boots fine, etc., etc., but I can't get to the
                console except &lt;br&gt;
                through vnc; &lt;br&gt;
                "virsh console" just shows a blank screen. &lt;br&gt;
                1. I think this is absolutely the right list for your
                issue &lt;br&gt;
              &lt;/blockquote&gt;
              Yay. :-) &lt;br&gt;
              &lt;br&gt;
              &lt;blockquote type="cite"&gt;2. is it really blank? or
                something like &lt;br&gt;
                &lt;br&gt;
                    Connected to domain '[domain]' &lt;br&gt;
                    Escape character is ^] (Ctrl + ]) &lt;br&gt;
              &lt;/blockquote&gt;
              Okay, it *does* say those things -- but that's all it
              says. &lt;CR&gt; gets &lt;br&gt;
              me nowhere, as opposed to the other KVM hosts we have
              running. &lt;br&gt;
              &lt;br&gt;
              &lt;blockquote type="cite"&gt;3. If I am not mistaken the guest
                needs to be configured in a &lt;br&gt;
                certain way for &lt;br&gt;
                virsh console [domain] to work. I can't say how though &lt;br&gt;
              &lt;/blockquote&gt;
              Hmmm... well, if anyone knows, I'm all ears. &lt;br&gt;
              &lt;br&gt;
              Thanks for the reply! &lt;br&gt;
              &lt;br&gt;
            &lt;/blockquote&gt;
          &lt;/blockquote&gt;
          &lt;br&gt;
        &lt;/blockquote&gt;
        &lt;br&gt;
      &lt;/blockquote&gt;
    &lt;/blockquote&gt;
    &lt;p&gt;&lt;br&gt;
    &lt;/p&gt;
  &lt;/body&gt;
&lt;/html&gt;


</body></email><email><emailId>20210527103910</emailId><senderName>Han Han</senderName><senderEmail>hhan@redhat.com</senderEmail><timestampReceived>2021-05-27 10:39:10-0400</timestampReceived><subject>Re: how to increase vram in windows guest?</subject><body>

On Sat, May 22, 2021 at 9:09 PM gansteed &lt;gansteed@gmail.com&gt; wrote:

&gt; Hello:
&gt;     I'm using kvm to host a windows 7 guest vm, I've install the latest
&gt; spice guest tools from
&gt; https://spice-space.org/download/windows/spice-guest-tools/spice-guest-tools-latest.exe,
&gt; and I've set video section like this:
&gt;
&gt; &lt;video&gt;
&gt;   &lt;model type="qxl" ram="262144" vram="262144" vram64="262144"
&gt; vgamem="131072" heads="1" primary="yes"/&gt;
&gt;   &lt;alias name="video0"/&gt;
&gt;   &lt;address type="pci" domain="0x0000" bus="0x00" slot="0x01"
&gt; function="0x0"/&gt;
&gt; &lt;/video&gt;
&gt;
&gt; but the graphics in windows guest is laggy, I' found that the guest have
&gt; only use 16MB as vram:
&gt;
&gt; How can I increase the real usage of vram in the windows guest vm?
&gt;
There is no libvirt API or QEMU qmp to update video devices when a VM is
live.
You should shut off the VM and then edit the VM xml to update the values of ram
or vram in the qxl video element.
For the meaning of ram or vram, see
https://libvirt.org/formatdomain.html#video-devices

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" \
class="gmail_attr"&gt;On Sat, May 22, 2021 at 9:09 PM gansteed &lt;&lt;a \
href="mailto:gansteed@gmail.com"&gt;gansteed@gmail.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;&lt;div \
dir="ltr"&gt;Hello:&lt;div&gt;      I'm using kvm to host a windows 7 guest vm, I've \
install the latest spice guest tools from  &lt;a \
href="https://spice-space.org/download/windows/spice-guest-tools/spice-guest-tools-latest.exe" \
target="_blank"&gt;https://spice-space.org/download/windows/spice-guest-tools/spice-guest-tools-latest.exe&lt;/a&gt;, \
and I've set video section like this:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;video&gt;&lt;br&gt;  \
&lt;model type="qxl" ram="262144" vram="262144" \
vram64="262144" vgamem="131072" heads="1" \
primary="yes"/&gt;&lt;br&gt;   &lt;alias name="video0"/&gt;&lt;br&gt;   \
&lt;address type="pci" domain="0x0000" bus="0x00" \
slot="0x01" \
function="0x0"/&gt;&lt;br&gt;&lt;/video&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;but the \
graphics in windows guest is laggy, I' found that the guest have only use 16MB as \
vram:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote class="gmail_quote" \
style="margin:0px 0px 0px 0.8ex;border-left:1px solid \
rgb(204,204,204);padding-left:1ex"&gt;&lt;div dir="ltr"&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;How can I increase \
the real usage of vram in the windows guest \
vm?&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;div&gt;There is no libvirt API or QEMU qmp to update \
video devices when a VM is live. &lt;br&gt;&lt;/div&gt;&lt;div&gt;You should shut off the VM and then \
edit the VM xml to update the values of &lt;span class="gmail-docutils \
gmail-literal"&gt;ram or v&lt;span class="gmail-docutils gmail-literal"&gt;ram in the qxl \
video element.&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span class="gmail-docutils \
gmail-literal"&gt;&lt;span class="gmail-docutils gmail-literal"&gt;For the meaning of ram or \
vram, see &lt;span class="gmail-docutils gmail-literal"&gt;&lt;a \
href="https://libvirt.org/formatdomain.html#video-devices"&gt;https://libvirt.org/formatdomain.html#video-devices&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt; \
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210401152830</emailId><senderName>lejeczek</senderName><senderEmail>peljasz@yahoo.co.uk</senderEmail><timestampReceived>2021-04-01 15:28:30-0400</timestampReceived><subject>Re: GlusterFS libgfapi with TLS</subject><body>



On 01/04/2021 16:13, Peter Krempa wrote:
&gt; On Thu, Apr 01, 2021 at 15:13:02 +0100, lejeczek wrote:
&gt;&gt; Hi guys.
&gt;&gt;
&gt;&gt; I have KVM guests stored on glusterFS volume and I recently added TLS
&gt;&gt; encryption to Gluster.
&gt;&gt; What changes, tweaks are required at libvirtd/qemu's end?
&gt; Looking at the definition of the gluster backend object in qemu:
&gt;
&gt; &lt;cite&gt;
&gt; ##
&gt; # @BlockdevOptionsGluster:
&gt; #
&gt; # Driver specific block device options for Gluster
&gt; #
&gt; # @volume: name of gluster volume where VM image resides
&gt; #
&gt; # @path: absolute path to image file in gluster volume
&gt; #
&gt; # @server: gluster servers description
&gt; #
&gt; # @debug: libgfapi log level (default '4' which is Error)
&gt; #         (Since 2.8)
&gt; #
&gt; # @logfile: libgfapi log file (default /dev/stderr) (Since 2.8)
&gt; #
&gt; # Since: 2.9
&gt; ##
&gt; { 'struct': 'BlockdevOptionsGluster',
&gt;    'data': { 'volume': 'str',
&gt;              'path': 'str',
&gt;              'server': ['SocketAddress'],
&gt;              '*debug': 'int',
&gt;              '*logfile': 'str' } }
&gt;
&gt; &lt;/cite&gt;
&gt;
&gt; it doesn't seem to yet support TLS encryption of the transport or a way
&gt; to set it in a non-implicit way (it still might be possible to trick
&gt; libgfapi to support it via a config file or such).
&gt;
&gt; That means you'll probably need to submit qemu patches implementing the
&gt; support for configuring TLS for gluster to qemu first, and then do the
&gt; same for libvirt.
&gt;
&gt; Libvirt already has some infrastructure for that for NBD and VXHS disks,
&gt; so you can then take inspiration there when implementing it in libvirt.
&gt;
Ah, not me, no chance, I wish I could help but being a 
regular admin I'd have to change profession.
I think, looking at it now, I should rephrase the issue to - 
GlusterFS with TLS &amp; libvirt/qemu with libgfapi'
I'll keep my fingers crossed devel will give this parts of 
security higher priority and needed improvements, 
enhancements will land in soon.
many thanks, L.

</body></email><email><emailId>20210403204334</emailId><senderName>Radek Simko</senderName><senderEmail>radek.simko@gmail.com</senderEmail><timestampReceived>2021-04-03 20:43:34-0400</timestampReceived><subject>Re: Virtual Network API for QEMU</subject><body>

I eventually managed to spin up all the processes (libvirtd, virtlogd,
virtlockd) individually and under root, which also helped exposing the
read-only socket. I gathered from reading through the libvirt source code
that the read-only socket is only activated under privileged mode which has
led me down that path.

With all this running, I went back to my automation efforts with Vagrant
libvirt and realized that it wants to make a call that doesn't seem
supported on macOS (yet):

Call to virDomainCreateWithFlags failed: Unable to create TAP devices on
this platform: Function not implemented

^ which I suppose confirms the mentioned worries of Michal

So I can say that while running libvirt on macOS isn't super smooth it's
possible. :)
The sharp edges around permissions and launchd plist files is something
that can be smoothed out eventually and that is probably something
to resolve on the distribution side (e.g. Homebrew) anyway, not necessarily
on libvirt's.

Radek Simko


On Fri, Apr 2, 2021 at 5:47 PM Radek Simko &lt;radek.simko@gmail.com&gt; wrote:

&gt; Recompiling with these few changes helped and the networking drivers
&gt; _seems_ to be working on macOS.
&gt; At least I got past the error I was getting initially.
&gt;
&gt; I'm just now dealing with a slightly different set of problems related to
&gt; libvirt sockets on macOS.
&gt; The Homebrew formula ships a launchd plist which doesn't seem to do socket
&gt; activation, unlike systemd.
&gt; I worked around that by setting the socket dir path manually in the config:
&gt;
&gt; unix_sock_dir = "/usr/local/var/run/libvirt"
&gt;
&gt; which did make libvirtd create "libvirt-sock" in that directory as
&gt; expected, but per docs there should also be a secondary read-only socket
&gt; "libvirt-sock-ro" https://libvirt.org/daemons.html#monolithic-sockets and
&gt; it's not there for some reason. Is there any additional configuration
&gt; needed to activate that secondary socket?
&gt;
&gt; Feel free to tell me if this is getting too off-topic btw. - The big
&gt; picture is that I'm trying to get libvirt working on darwin and automate
&gt; RPi virtualization via Vagrant (vagrant-libvirt) and taking it step by step.
&gt;
&gt; Radek Simko
&gt;
&gt;
&gt; On Thu, Apr 1, 2021 at 2:54 PM Andrea Bolognani &lt;abologna@redhat.com&gt;
&gt; wrote:
&gt;
&gt;&gt; On Wed, 2021-03-31 at 21:39 +0100, Radek Simko wrote:
&gt;&gt; &gt; I was attempting to virtualize Raspberry Pi on qemu via libvirt,
&gt;&gt; &gt; where my host machine is macOS (both qemu and libvirt installed via
&gt;&gt; &gt; Homebrew) and I while trying to set up the network I stumbled upon
&gt;&gt; &gt; this:
&gt;&gt; &gt;
&gt;&gt; &gt; $ virsh -c
&gt;&gt; qemu:///system?socket=/usr/local/var/run/libvirt/libvirt-sock net-list --all
&gt;&gt;
&gt;&gt; Aside: if you have libvirt &gt;= 6.9.0, which at this point is very
&gt;&gt; likely, you shouldn't need to include the 'socket' parameter in the
&gt;&gt; connection URI; in fact, for local connections, it should have worked
&gt;&gt; without the parameter even before that.
&gt;&gt;
&gt;&gt; --
&gt;&gt; Andrea Bolognani / Red Hat / Virtualization
&gt;&gt;
&gt;&gt;

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;I eventually managed to spin up all the processes (libvirtd, virtlogd, \
virtlockd) individually and under root, which also helped exposing the read-only \
socket. I gathered from reading through the libvirt source code that the read-only \
socket is only activated under privileged mode which has led me down that \
path.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;With all this running, I went back to my automation efforts \
with Vagrant libvirt and realized that it wants to make a call that doesn't seem \
supported on macOS (yet):&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Call to virDomainCreateWithFlags \
failed: Unable to create TAP devices on this platform: Function not \
implemented&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;^ which I suppose confirms the mentioned worries \
of Michal&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So I can say that while running libvirt on macOS \
isn't super smooth it's possible. :)&lt;/div&gt;&lt;div&gt;The sharp edges around \
permissions and launchd plist files is something that can be smoothed out eventually \
and that is probably something to  resolve on  the distribution side (e.g. Homebrew) \
anyway,  not necessarily on libvirt's.&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div dir="ltr" \
class="gmail_signature" data-smartmail="gmail_signature"&gt;&lt;div dir="ltr"&gt;&lt;div&gt;&lt;div \
dir="ltr"&gt;&lt;div&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="ltr"&gt;Radek \
Simko&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Fri, Apr 2, 2021 at 5:47 PM \
Radek Simko &lt;&lt;a href="mailto:radek.simko@gmail.com"&gt;radek.simko@gmail.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;&lt;div \
dir="ltr"&gt;Recompiling with these few changes helped and the networking drivers \
_seems_ to be working on macOS.&lt;div&gt;At least I got past the error I was getting \
initially.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I'm just now dealing with a slightly \
different set of problems related to libvirt sockets on macOS.&lt;/div&gt;&lt;div&gt;The Homebrew \
formula ships a launchd plist which doesn't seem to do socket activation, unlike \
systemd.&lt;/div&gt;&lt;div&gt;I worked around that by setting the socket dir path manually in \
the config:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;unix_sock_dir = \
"/usr/local/var/run/libvirt"&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;which did make \
libvirtd create "libvirt-sock" in that directory as expected, but per docs \
there should also be a secondary read-only socket "libvirt-sock-ro" &lt;a \
href="https://libvirt.org/daemons.html#monolithic-sockets" \
target="_blank"&gt;https://libvirt.org/daemons.html#monolithic-sockets&lt;/a&gt; and it's \
not there for some reason. Is there any additional configuration needed to activate \
that secondary socket?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Feel free to tell me if this is \
getting too off-topic btw. - The big picture is that I'm trying to get libvirt \
working on darwin and automate RPi virtualization via Vagrant (vagrant-libvirt) and \
taking it step by step.&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;div dir="ltr"&gt;&lt;div dir="ltr"&gt;&lt;div&gt;&lt;div \
dir="ltr"&gt;&lt;div&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="ltr"&gt;Radek \
Simko&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Thu, Apr 1, 2021 at 2:54 PM \
Andrea Bolognani &lt;&lt;a href="mailto:abologna@redhat.com" \
target="_blank"&gt;abologna@redhat.com&lt;/a&gt;&gt; wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote \
class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid \
rgb(204,204,204);padding-left:1ex"&gt;On Wed, 2021-03-31 at 21:39 +0100, Radek Simko \
wrote:&lt;br&gt; &gt; I was attempting to virtualize Raspberry Pi on qemu via libvirt,&lt;br&gt;
&gt; where my host machine is macOS (both qemu and libvirt installed via&lt;br&gt;
&gt; Homebrew) and I while trying to set up the network I stumbled upon&lt;br&gt;
&gt; this:&lt;br&gt;
&gt; &lt;br&gt;
&gt; $ virsh -c qemu:///system?socket=/usr/local/var/run/libvirt/libvirt-sock \
net-list --all&lt;br&gt; &lt;br&gt;
Aside: if you have libvirt &gt;= 6.9.0, which at this point is very&lt;br&gt;
likely, you shouldn't need to include the 'socket' parameter in the&lt;br&gt;
connection URI; in fact, for local connections, it should have worked&lt;br&gt;
without the parameter even before that.&lt;br&gt;
&lt;br&gt;
-- &lt;br&gt;
Andrea Bolognani / Red Hat / Virtualization&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;
&lt;/blockquote&gt;&lt;/div&gt;



</body></email><email><emailId>20210407165519</emailId><senderName>Dariusz Smigiel</senderName><senderEmail>dariusz.smigiel@canonical.com</senderEmail><timestampReceived>2021-04-07 16:55:19-0400</timestampReceived><subject>Re: Live migration with change to setmaxmem</subject><body>

On Wed, Apr 7, 2021 at 9:07 AM Daniel P. Berrangé &lt;berrange@redhat.com&gt; wrote:
&gt;
&gt; On Wed, Apr 07, 2021 at 07:45:47AM -0700, Dariusz Smigiel wrote:
&gt; &gt; Hi Team,
&gt; &gt;
&gt; &gt; I need to migrate beefy instance between two different hosts which is
&gt; &gt; running out of resources.
&gt; &gt;
&gt; &gt; I was wondering, if there is a way to change maximum memory value during
&gt; &gt; live migration, without shutting down the instance.
&gt;
&gt; The maximum memory value controls the RAM mapping exposed to the guest,
&gt; and as such is part of the guest ABI.   Guest ABI is never permitted
&gt; to change during a live migration, as that will almost always have
&gt; seriously bad effects on the guest OS, and possibly the QEMU migration
&gt; data stream format.
&gt;
&gt; IOW, no, you can't change max memory during migration, only a cold
&gt; boot.

Thanks,
That explains a lot.

&gt;
&gt; Libvirt will enforces that preservation of ABI during migration by
&gt; validating the 2 XML configs for the src+dst host, and only permits
&gt; changes to the backend host OS integration, never frontend.
&gt;
&gt;
&gt; Regards,
&gt; Daniel

Best regards,
Dariusz


</body></email><email><emailId>20210522165231</emailId><senderName>"Ken D'Ambrosio"</senderName><senderEmail>ken@jots.org</senderEmail><timestampReceived>2021-05-22 16:52:31-0400</timestampReceived><subject>Console of P2V?</subject><body>

Hey, all. For one, apologies if this isn't quite the right list, I tried 
to get the right one.  But, my problem: I'm firing up a Centos 6.5 box 
with virt-install, recently converted from a physical (I did a 'dd' to a 
raw image, and converted it to qcow2), and it boots fine, etc., etc., 
but I can't get to the console except through vnc; "virsh console" just 
shows a blank screen.  Do I need to tell the kernel to boot in ASCII 
mode or somesuch?

Thanks!

-Ken

</body></email><email><emailId>20210522130740</emailId><senderName>gansteed</senderName><senderEmail>gansteed@gmail.com</senderEmail><timestampReceived>2021-05-22 13:07:40-0400</timestampReceived><subject>how to increase vram in windows guest?</subject><body>

Hello:
    I'm using kvm to host a windows 7 guest vm, I've install the latest
spice guest tools from
https://spice-space.org/download/windows/spice-guest-tools/spice-guest-tools-latest.exe,
and I've set video section like this:

&lt;video&gt;
  &lt;model type="qxl" ram="262144" vram="262144" vram64="262144"
vgamem="131072" heads="1" primary="yes"/&gt;
  &lt;alias name="video0"/&gt;
  &lt;address type="pci" domain="0x0000" bus="0x00" slot="0x01"
function="0x0"/&gt;
&lt;/video&gt;

but the graphics in windows guest is laggy, I' found that the guest have
only use 16MB as vram:

How can I increase the real usage of vram in the windows guest vm?

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hello:&lt;div&gt;      I'm using kvm to host a windows 7 guest vm, \
I've install the latest spice guest tools from  &lt;a \
href="https://spice-space.org/download/windows/spice-guest-tools/spice-guest-tools-lat \
est.exe"&gt;https://spice-space.org/download/windows/spice-guest-tools/spice-guest-tools-latest.exe&lt;/a&gt;, \
and I've set video section like this:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;video&gt;&lt;br&gt;  \
&lt;model type="qxl" ram="262144" vram="262144" \
vram64="262144" vgamem="131072" heads="1" \
primary="yes"/&gt;&lt;br&gt;   &lt;alias name="video0"/&gt;&lt;br&gt;   \
&lt;address type="pci" domain="0x0000" bus="0x00" \
slot="0x01" \
function="0x0"/&gt;&lt;br&gt;&lt;/video&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;but the \
graphics in windows guest is laggy, I' found that the guest have only use 16MB as \
vram:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;How can I increase the real usage of vram in the \
windows guest vm?&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210327123933</emailId><senderName>Radek Simko</senderName><senderEmail>radek.simko@gmail.com</senderEmail><timestampReceived>2021-03-27 12:39:33-0400</timestampReceived><subject>Virtual Network API for QEMU</subject><body>

Hi,
According to this support matrix
https://libvirt.org/hvsupport.html#virNetworkDriver
there is no support for any APIs other than hypervisor ones for qemu.
For example virConnectNumOfNetworks is not supported.

Is there any particular reason this is not supported? Has any development
in that area been attempted in the past? Would contributions adding support
be welcomed?

Thanks,

Radek Simko

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hi,&lt;div&gt;According to this support matrix  &lt;a \
href="https://libvirt.org/hvsupport.html#virNetworkDriver"&gt;https://libvirt.org/hvsupport.html#virNetworkDriver&lt;/a&gt;&lt;/div&gt;&lt;div&gt;there \
is no support for any APIs other than hypervisor ones for qemu.&lt;br&gt;&lt;/div&gt;&lt;div&gt;For \
example virConnectNumOfNetworks is not supported.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is there \
any particular reason this is not supported? Has any development in that area been \
attempted in the past? Would contributions adding support be welcomed?&lt;br \
clear="all"&gt;&lt;div&gt;&lt;div dir="ltr" class="gmail_signature" \
data-smartmail="gmail_signature"&gt;&lt;div dir="ltr"&gt;&lt;div&gt;&lt;div dir="ltr"&gt;&lt;div&gt;&lt;div \
dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="ltr"&gt;Radek \
Simko&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210407144547</emailId><senderName>Dariusz Smigiel</senderName><senderEmail>dariusz.smigiel@canonical.com</senderEmail><timestampReceived>2021-04-07 14:45:47-0400</timestampReceived><subject>Live migration with change to setmaxmem</subject><body>

Hi Team,

I need to migrate beefy instance between two different hosts which is
running out of resources.

I was wondering, if there is a way to change maximum memory value during
live migration, without shutting down the instance.

Thanks,
Dariusz

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hi Team,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I need to migrate beefy instance between \
two different hosts which is running out of resources.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I was \
wondering, if there is a way to change maximum memory value during live migration, \
without shutting down the \
instance.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;Dariusz&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210407081410</emailId><senderName>Mathieu Tarral</senderName><senderEmail>mathieu.tarral@protonmail.com</senderEmail><timestampReceived>2021-04-07 08:14:10-0400</timestampReceived><subject>Xen: libvirt.libvirtError: An error occurred, but the cause is unknown</subject><body>

[Attachment #2 (text/plain)]

Hi,

I'm facing a strange issue with libvirt and the Xen driver.

Whenever I try to define or start a domain, I always get this error:
"libvirt.libvirtError: An error occurred, but the cause is unknown" (in Python virt-manager interface)

Which is not very helpful.
Trying to use virsh directly leads to the same error message:

virsh # start win10_xen
error: Failed to start domain win10_xen
error: An error occurred, but the cause is unknown

I checked /var/log/libvirt/libxl/libxl-driver.log, but the log file is empty.

However, using the xl toolstack directly to start a new domain works fine,
so the issue doesn't seem to come from Xen.

My environment:
- Ubuntu 20.04 LTS
- xen-hypervisor-4.11-amd64 (4.11.3+24-g14b62ab3e5-1ubuntu2)
- libvirt0 (6.0.0-0ubuntu8.8)

I really like libvirt and virt-manager to manage my VMs.

Any clue how I could dig deeper and find the root cause ?

Thanks.
[Attachment #3 (text/html)]

&lt;div&gt;Hi,&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I'm facing a strange issue with libvirt and the \
Xen driver.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Whenever I try to define or start a domain, \
I always get this error:&lt;br&gt;&lt;/div&gt;&lt;div&gt;"libvirt.libvirtError: An error occurred, but \
the cause is unknown" (in Python virt-manager \
interface)&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Which is not very \
helpful.&lt;br&gt;&lt;/div&gt;&lt;div&gt;Trying to use virsh directly leads to the same error \
message:&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;virsh # start win10_xen&lt;br&gt;&lt;/div&gt;&lt;div&gt;error: \
Failed to start domain win10_xen&lt;br&gt;&lt;/div&gt;&lt;div&gt;error: An error occurred, but the \
cause is unknown&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I checked \
/var/log/libvirt/libxl/libxl-driver.log, but the log file is \
empty.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;However, using the xl toolstack directly to start \
a new domain works fine,&lt;br&gt;&lt;/div&gt;&lt;div&gt;so the issue doesn't seem to come from \
Xen.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;My environment:&lt;br&gt;&lt;/div&gt;&lt;div&gt;- Ubuntu 20.04 \
LTS&lt;br&gt;&lt;/div&gt;&lt;div&gt;- xen-hypervisor-4.11-amd64 \
(4.11.3+24-g14b62ab3e5-1ubuntu2)&lt;br&gt;&lt;/div&gt;&lt;div&gt;- libvirt0 \
(6.0.0-0ubuntu8.8)&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I really like libvirt and \
virt-manager to manage my VMs.&lt;br&gt;&lt;/div&gt;&lt;div class="protonmail_signature_block"&gt;&lt;div \
class="protonmail_signature_block-user \
protonmail_signature_block-empty"&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
class="protonmail_signature_block-proton"&gt;Any clue how I could dig deeper and find \
the root cause ?&lt;br&gt;&lt;/div&gt;&lt;div \
class="protonmail_signature_block-proton"&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
class="protonmail_signature_block-proton"&gt;Thanks.&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20210408215154</emailId><senderName>Ajay Kumar</senderName><senderEmail>ajaykumar.ak99@gmail.com</senderEmail><timestampReceived>2021-04-08 21:51:54-0400</timestampReceived><subject>Creating Virtual machine with .OVF format</subject><body>

Hello members,

I would like to create virtual machine images with some pre-installed
software in a .*OVF/OVA* format. So that I can use these* OVF *images/templates
for any hypervisor to create a VM.
Do you have any suggestions or some available web scripts/links to do
this..?

Thanks,
Ajay

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div&gt;Hello members,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I would like to create \
virtual machine images with some pre-installed software in a .&lt;b&gt;OVF/OVA&lt;/b&gt; format. \
So that I can use these&lt;b&gt; OVF &lt;/b&gt;images/templates for any hypervisor to create a \
VM.&lt;/div&gt;&lt;div&gt;Do you have any suggestions  or some available web scripts/links  to do \
this..?&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="ltr" class="gmail_signature" \
data-smartmail="gmail_signature"&gt;&lt;div dir="ltr"&gt;&lt;div&gt;&lt;div dir="ltr"&gt;&lt;div \
dir="ltr"&gt;&lt;div dir="ltr"&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;Ajay&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;




</body></email><email><emailId>20210409051636</emailId><senderName>Tom Ammon</senderName><senderEmail>thomasammon@gmail.com</senderEmail><timestampReceived>2021-04-09 05:16:36-0400</timestampReceived><subject>submitting a patch to fix documentation errors</subject><body>

Hello,

While using the libvirt application development guide for python (
https://libvirt.org/docs/libvirt-appdev-guide-python/en-US/html/index.html)
I found a couple of errors in the example code that I'd like to fix. I've
created a branch and committed the fixes locally, and I'm ready to push
them. I plan to use git send-email to submit the patch. Which list should I
use in the --to= ? Should it be libvirt-users@redhat.com?

This is my first contribution to this project. I've read the best practices
and contributing guidelines on libvirt.org, but if I make mistakes in the
workflow I'd appreciate your help to correct them.

Thanks!
Tom

-- 
-----------------------------------------------------------------------------
Tom Ammon
M: (737) 400-9042
thomasammon@gmail.com
-----------------------------------------------------------------------------

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hello,  &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;While using the libvirt application \
development guide for python (&lt;a \
href="https://libvirt.org/docs/libvirt-appdev-guide-python/en-US/html/index.html"&gt;https://libvirt.org/docs/libvirt-appdev-guide-python/en-US/html/index.html&lt;/a&gt;) \
I found a couple of errors in the example code that I'd like to fix. I've \
created a branch and committed the fixes locally, and I'm ready to push them. I \
plan to use git send-email to submit the patch. Which list should I use in the --to= \
? Should it be &lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;This \
is my first contribution to this project. I've read the best practices and \
contributing guidelines on &lt;a href="http://libvirt.org"&gt;libvirt.org&lt;/a&gt;, but if I \
make mistakes in the workflow I'd appreciate your help to correct them.  \
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks!&lt;/div&gt;&lt;div&gt;Tom&lt;br clear="all"&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- \
&lt;br&gt;&lt;div dir="ltr" class="gmail_signature" data-smartmail="gmail_signature"&gt;&lt;div \
dir="ltr"&gt;&lt;div&gt;&lt;div dir="ltr"&gt;-----------------------------------------------------------------------------&lt;br&gt;Tom \
Ammon&lt;br&gt;M: (737) 400-9042&lt;br&gt;&lt;a href="mailto:thomasammon@gmail.com" \
target="_blank"&gt;thomasammon@gmail.com&lt;/a&gt;&lt;br&gt;-----------------------------------------------------------------------------&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;




</body></email><email><emailId>20210409082617</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-04-09 08:26:17-0400</timestampReceived><subject>Re: submitting a patch to fix documentation errors</subject><body>

On Fri, Apr 09, 2021 at 12:16:36AM -0500, Tom Ammon wrote:
&gt; Hello,
&gt; 
&gt; While using the libvirt application development guide for python (
&gt; https://libvirt.org/docs/libvirt-appdev-guide-python/en-US/html/index.html)
&gt; I found a couple of errors in the example code that I'd like to fix. I've
&gt; created a branch and committed the fixes locally, and I'm ready to push
&gt; them. I plan to use git send-email to submit the patch. Which list should I
&gt; use in the --to= ? Should it be libvirt-users@redhat.com?
&gt; 
&gt; This is my first contribution to this project. I've read the best practices
&gt; and contributing guidelines on libvirt.org, but if I make mistakes in the
&gt; workflow I'd appreciate your help to correct them.

For everything except the main libvirt.git repo, we have switched to
using gitlab merge requests, so you don't need to worry about using
email to send changes

Create your own fork of:

  https://gitlab.com/libvirt/libvirt-appdev-guide-python/

push your local branch to your gitlab fork, and then open a merge
request to submit the fixes.

Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20210409063443</emailId><senderName>Erik Skultety</senderName><senderEmail>eskultet@redhat.com</senderEmail><timestampReceived>2021-04-09 06:34:43-0400</timestampReceived><subject>Re: Creating Virtual machine with .OVF format</subject><body>

On Thu, Apr 08, 2021 at 05:51:54PM -0400, Ajay Kumar wrote:
&gt; Hello members,
&gt; 
&gt; I would like to create virtual machine images with some pre-installed
&gt; software in a .*OVF/OVA* format. So that I can use these* OVF *images/templates
&gt; for any hypervisor to create a VM.
&gt; Do you have any suggestions or some available web scripts/links to do
&gt; this..?

Hi,
no, I'm not aware of any such online tools (let alone unlicensed). But if I
were to script this, I'd do it this way:

Prerequisites:
1) create your VM image with a disk type RAW (can be QCOW2 as well, but you'd
then have to use different steps for conversion) for example you could download
one of them cloud images and use libguestfs tools to remove the cloud-init part

2) get a fedora machine (I tried it on Fedora only) - a VM is fine

On ^that Fedora machine:
3) install RPM fusion repo
4) install the VirtualBox-server package
5) upload your RAW disk image created in step 1) to this machine
6) convert the RAW image to VDI which virtualbox understands:
    $ VBoxManage convertfromraw &lt;yourimage&gt;.raw &lt;outputpath&gt; --format VDI
7) create a dummy VM object
    $ VBoxManage createvm --name dummy --register
8) attach a storage controller to ^this dummy VM
    $ VBoxManage storagectl dummy --name dummycontroller --add scsi
9) attach the converted VDI disk to the dummy VM object
    $ VBoxManage storageattach dummy --storagectl dummycontroller \
                                     --medium &lt;path_to_VDI&gt; \
                                     --port 1 \   # this can be arbitrary number
                                     --type hdd
10) export the dummy machine as OVA
    $ VBoxManage export dummy --output &lt;filename&gt;.ova


I mean, quite a few hoops to jump, but like I said, I have no knowledge of
opensource tools that could do it in one step, but at least the ^above can
all be automated (you'll have to look for more sensible settings to VBoxManage
though) and I myself would most likely going with something like that.
If you don't need automation, just use the virtualbox GUI to import the raw
disk and export the machine in OVA.

Regards,
Erik

</body></email><email><emailId>20210407170321</emailId><senderName>Thomas Stein</senderName><senderEmail>himbeere@meine-oma.de</senderEmail><timestampReceived>2021-04-07 17:03:21-0400</timestampReceived><subject>libvirt 7.2.0 domainbackup</subject><body>

Hello one and all.

Just wanted to check out the new feature domainbackup but having trouble 
to configure it. I thought I just have to put

&lt;domainbackup&gt;
   &lt;disks&gt;
     &lt;disk name='vda' type='file'&gt;
       &lt;target file='/var/lib/libvirt/jitsi'/&gt;
       &lt;driver type='raw'/&gt;
     &lt;/disk&gt;
   &lt;/disks&gt;
&lt;/domainbackup&gt;

at the top level of my domain xml file but that does not seem to work. I 
get:

error: XML document failed to validate against schema: Unable to 
validate doc against /usr/share/libvirt/schemas/domain.rng
Element domain has extra content: domainbackup

Can someone please push me in the right direction?

cheers, t.

</body></email><email><emailId>20210409170531</emailId><senderName>Jing-Wei Su</senderName><senderEmail>jwsu1986@gmail.com</senderEmail><timestampReceived>2021-04-09 17:05:31-0400</timestampReceived><subject>live migrate storage to different volume on the same host</subject><body>

Hello experts,

I would like to move the qcow2 disk images of a running VM to a
different storage because of the maintenance of the underlying storage
on the same host.

I found the live migration is not allowable on the same host using
virsh. Is there any suggestion or better practices for this?

Thank you,
Derek

</body></email><email><emailId>20210101180555</emailId><senderName>Riccardo Ravaioli</senderName><senderEmail>riccardoravaioli@gmail.com</senderEmail><timestampReceived>2021-01-01 18:05:55-0400</timestampReceived><subject>how to use external snapshots with memory state</subject><body>

Hi all,

Best wishes for 2021! :)

So I've been reading and playing around with live snapshots and still
haven't figured out how to use an external memory snapshot. My goal is to
take a disk+memory snapshot of a running VM and, if possible, save it in
external files.

As far as I understand, I can run:
$ virsh snapshot-create $VM
... and that'll take an *internal* live snapshot of a given VM, consisting
of its disks and memory state, which will be stored in the qcow2 disk(s) of
the VM. In particular, the memory state will be stored in the first disk of
the VM. I can then use the full range of snapshot commands available:
revert, list, current, delete.

Now, an external snapshot can be taken with:
$ virsh snapshot-create-as --domain $VM  mysnapshot --diskspec
vda,file=/home/riccardo/disk_mysnapshot.qcow2,snapshot=external --memspec
file=/home/riccardo/mem_mysnapshot.qcow2,snapshot=external
... with as many "--diskspec" as there are disks in the VM.

I've read the virsh manual and the libvirt API documentation, but it's not
clear to me what exactly I can do then with an external snapshot, in
particular with the file containing the memory state. In articles from 7-8
years ago people state that external memory snapshots cannot be reverted...
is it still the case today? If so, what's a typical usage for such files?
If not with libvirt, is it possible to revert to an external memory + disk
state in other ways, for instance through qemu commands?

Thanks!

Riccardo

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div&gt;Hi all,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Best wishes for 2021! :) \
&lt;br&gt;&lt;br&gt;So I've been reading and playing around with live snapshots and still \
haven't figured out how to use an external memory snapshot. My goal is to take a \
disk+memory snapshot of a running VM and, if possible, save it in external \
files.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;As far as I understand, I can run:&lt;/div&gt;&lt;div&gt;$ \
virsh snapshot-create $VM&lt;/div&gt;&lt;div&gt;... and that'll take an *internal* live \
snapshot of a given VM, consisting of its disks and memory state, which will be \
stored in the qcow2 disk(s) of the VM. In particular, the memory state will be stored \
in the first disk of the VM. I can then use the full range of snapshot commands \
available: revert, list, current, delete. &lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Now, an \
external snapshot can be taken with:&lt;/div&gt;&lt;div&gt;$ virsh snapshot-create-as --domain \
$VM   mysnapshot --diskspec \
vda,file=/home/riccardo/disk_mysnapshot.qcow2,snapshot=external --memspec \
file=/home/riccardo/mem_mysnapshot.qcow2,snapshot=external&lt;/div&gt;&lt;div&gt;... with as many \
"--diskspec" as there are disks in the \
VM.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I've read the virsh manual and the libvirt API \
documentation, but it's not clear to me what exactly I can do then with an \
external snapshot, in particular with the file containing the memory state. In \
articles from 7-8 years ago people state that external memory snapshots cannot be \
reverted... is it still the case today? If so, what's a typical usage for such \
files? If not with libvirt, is it possible to revert to an external memory + disk \
state in other ways, for instance through qemu \
commands?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks!&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Riccardo&lt;br&gt;&lt;/div&gt;&lt;/div&gt;




</body></email><email><emailId>20210103142955</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-01-03 14:29:55-0400</timestampReceived><subject>Re: how to use external snapshots with memory state</subject><body>

On Fri, Jan 01, 2021 at 19:05:55 +0100, Riccardo Ravaioli wrote:
&gt; Hi all,

Hi,

&gt; 
&gt; Best wishes for 2021! :)
&gt; 
&gt; So I've been reading and playing around with live snapshots and still
&gt; haven't figured out how to use an external memory snapshot. My goal is to
&gt; take a disk+memory snapshot of a running VM and, if possible, save it in
&gt; external files.
&gt; 
&gt; As far as I understand, I can run:
&gt; $ virsh snapshot-create $VM
&gt; ... and that'll take an *internal* live snapshot of a given VM, consisting
&gt; of its disks and memory state, which will be stored in the qcow2 disk(s) of
&gt; the VM. In particular, the memory state will be stored in the first disk of
&gt; the VM. I can then use the full range of snapshot commands available:
&gt; revert, list, current, delete.
&gt; 
&gt; Now, an external snapshot can be taken with:
&gt; $ virsh snapshot-create-as --domain $VM  mysnapshot --diskspec
&gt; vda,file=/home/riccardo/disk_mysnapshot.qcow2,snapshot=external --memspec
&gt; file=/home/riccardo/mem_mysnapshot.qcow2,snapshot=external
&gt; ... with as many "--diskspec" as there are disks in the VM.
&gt; 
&gt; I've read the virsh manual and the libvirt API documentation, but it's not
&gt; clear to me what exactly I can do then with an external snapshot, in
&gt; particular with the file containing the memory state. In articles from 7-8
&gt; years ago people state that external memory snapshots cannot be reverted...

Unfortunately that's still true. The external snapshot code provides
enough functionality that you are able to use them, but reverting and
deleting needs to be done manually. There are a few manuals floating
online but it always depends on what you want to achieve.

The unfortunate situation of the implementation not being finished (I've
certainly stated it here already, since this question happens from time
to time (which also means you should look through the archives and
you'll find some pointers how to do certain specific steps)) comes from
the fact that it provides enough functionality for higher level
management projects to control snapshots (oVirt, openstack) and too much
higher priority work.

&gt; is it still the case today? If so, what's a typical usage for such files?
&gt; If not with libvirt, is it possible to revert to an external memory + disk

The memory image created by libvirt this way is actually in the same
image format as 'virsh save' and 'virsh restore' uses. This actually
does allow you to restore such a snapshot, although manual steps are
necessary. The most naive scenario, where you want to return to the
past state and you don't require returning back (alternate future is not
created) can be reverted simply by simply using 'virsh restore $IMG' and
then fixing the persistent definition of the VM to use the same disk
images as the memory image recorded.

Note that the overlay images which were created as part of the snapshot
are invalid after that point and must no longer be used.

Similarly, for non-active VMs or vms without memory snapshot you can
alter the image locations to use the old images and that effectively
reverts the snapshot.

Other operations are possible too, but please look through the archives
first.

&gt; state in other ways, for instance through qemu commands?
&gt; 
&gt; Thanks!
&gt; 
&gt; Riccardo

</body></email><email><emailId>20210409170041</emailId><senderName>Riccardo Ravaioli</senderName><senderEmail>riccardoravaioli@gmail.com</senderEmail><timestampReceived>2021-04-09 17:00:41-0400</timestampReceived><subject>Re: how to use external snapshots with memory state</subject><body>

Hi all,

Can I get some feedback on these two questions I posted a while back,
concerning external snapshots:

 On Tue, 26 Jan 2021 at 00:15, Riccardo Ravaioli &lt;riccardoravaioli@gmail.com&gt;
wrote:
[...]

&gt; 1) When creating an external online snapshot (disks+memory) of a qemu-KVM
&gt; VM, I'd like to store the backing files in a separate folder and rename the
&gt; newly-created delta files with the respective names of the original disks
&gt; (now the backing files). Is this possible at all? Say a VM has a disk
&gt; vm/disk1.qcow2 and I take an external snapshot, I'd like the backing file
&gt; to appear in snap/disk1.qcow2 and the new delta disk to appear as
&gt; vm/disk1.qcow2. Currently I wait for the VM to be shutdown by the user
&gt; before I move around disks as desired and run qemu-img rebase in unsafe
&gt; mode to update the delta disks. Can I accomplish the same result while the
&gt; VNF is running?
&gt;
&gt; 2) As you suggested, I now use "virsh restore" to launch a VM with the
&gt; memory state I had previously backed up. The "virsh restore" API applies to
&gt; a VM that is not running. However, I see that for internal snapshots,
&gt; libvirt also supports a snapshot-revert operation on a /live/ VM. Is this
&gt; possible at all with an external snapshot? If so, what are the commands
&gt; needed? My current way of automating a snapshot-revert with an external
&gt; online snapshot only applies to a shutdown VM. It consists in:
&gt; - shutting down the VM;
&gt; - erasing all its delta disks, replacing them with new ones;
&gt; - executing "virsh restore" on the memory state, making sure that the disk
&gt; paths referenced in the embedded XML file are correct.
&gt; Does this seem reasonable? Can I do the same while the VNF is running?
&gt; I suppose that for a snapshot-delete operation on a live VM I just need to
&gt; run "virsh blockpull" on each disk, but I couldn't figure out how to do a
&gt; revert.
&gt;


Thanks a lot!

Riccardo

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div&gt;Hi all,&lt;/div&gt;&lt;div&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" \
class="gmail_attr"&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Can I get some feedback on these two \
questions I posted a while back, concerning external \
snapshots:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;  On Tue, 26 Jan 2021 at 00:15, Riccardo Ravaioli \
&lt;&lt;a href="mailto:riccardoravaioli@gmail.com"&gt;riccardoravaioli@gmail.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;[...]&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;&lt;div dir="ltr"&gt;&lt;div \
dir="ltr"&gt;&lt;div class="gmail_quote"&gt;&lt;div&gt;&lt;div&gt;1) When creating an external online \
snapshot (disks+memory) of a qemu-KVM VM, I'd like to store the backing files in \
a separate folder and rename the newly-created delta files with the respective names \
of the original disks (now the backing files). Is this possible at all? Say a VM has \
a disk vm/disk1.qcow2 and I take an external snapshot, I'd like the backing file \
to appear in snap/disk1.qcow2 and the new delta disk to appear as vm/disk1.qcow2. \
Currently I wait for the VM to be shutdown by the user before I move around disks as \
desired and run qemu-img rebase in unsafe mode to update the delta disks. Can I \
accomplish the same result while the VNF is running?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;2) As \
you suggested, I now use "virsh restore" to launch a VM with the memory \
state I had previously backed up. The "virsh restore" API applies to a VM \
that is not running. However, I see that for internal snapshots, libvirt also \
supports a snapshot-revert operation on a /live/ VM. Is this possible at all with an \
external snapshot? If so, what are the commands needed? My current way of automating \
a snapshot-revert with an external online snapshot only applies to a shutdown VM. It \
consists in:&lt;/div&gt;&lt;div&gt;- shutting down the VM;&lt;/div&gt;&lt;div&gt;- erasing all its delta \
disks, replacing them with new ones;&lt;/div&gt;&lt;div&gt;- executing "virsh restore" \
on the memory state, making sure that the disk paths referenced in the embedded XML \
file are correct.&lt;br&gt;&lt;/div&gt;&lt;div&gt;Does this seem reasonable? Can I do the same while \
the VNF is running?&lt;br&gt;&lt;/div&gt;&lt;div&gt;I suppose that for a snapshot-delete operation on a \
live VM I just need to run "virsh blockpull" on each disk, but I \
couldn't figure out how to do a \
revert.&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks \
a lot!&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Riccardo&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210410151224</emailId><senderName>Ed B</senderName><senderEmail>hyper-nova@live.co.uk</senderEmail><timestampReceived>2021-04-10 15:12:24-0400</timestampReceived><subject>Confusion over networking configuration - I might be able to do some documentation</subject><body>

[Attachment #2 (multipart/alternative)]


Hi libvirt users,

I have been using libvirt on Debian Linux for a few months. (Mostly with \
virt-manager. I haven't yet learned all of the command line commands.)

I'm currently confused by bridge mode networking, which I think is what I require to \
address the particular use case, which I will describe:

My use case:

Prior to this I have been using routed mode to organize my VMs. Most of the VMs I \
deploy are for services (web servers, mail servers, etc) so I require them to have \
static IP addresses on my local network.

==== An aside / comment: I *can* set those static IPs using the command line virsh \
net-edit (from memory) command and then change the settings in the xml files. \
However, since this seems like something that many users would require regularly it \
would be nice to be able to set static IP in the GUI when configuring with \
virt-manager. I assume that the same people who maintain libvirt also maintain \
virt-manager? If I'm wrong please re-direct me.

Returning to the main discussion: It would be more convenient for me personally if I \
were able to set the IP addresses of these VMs using static addresses configured via \
an external DHCP server. I believe I can do this if my network is in "bridge" mode \
instead of NAT or Routed. I know this should be possible from reading information \
online but there doesn't seem to be any option for this in the virt-manager GUI.

==== To give more details on my setup: My network has a pfsense instance which is \
able to provide IP addresses to local machines. I would like to use the same pfsense \
machine to provide IP addresses to virtual machines. If I am not mistaken, the only \
way to do this would be to bridge the network on which the VMs reside to the network \
on which the pfsense machine resides.

I will provide some screenshots to illustrate my confusion. When creating a new \
virtual network, I assume that I do not want to enable DHCPv4, because I want the \
pfsense system to allocate IP addresses. I do not know whether I should leave "Enable \
ipv4 network address space definition" or what the value should be. See image below.

[cid:4e926d97-7a58-4350-93cc-0db7c401c075]


Further in the setup (step 4), I assume I need to choose "Forward to physical \
network" rather than "Isolated virtual network".

For the destination option, I do not know what should be chosen. I don't fully \
understand how this option works.

For "Mode" there are three options: NAT, Routed and finally "Open". I cannot find any \
documentation which indicates what "Open" means. NAT and Routed are clearly not the \
correct options here - by a process of elimination that would imply that "Open" means \
"bridged" but I have a feeling that this is incorrect and I don't understand \
something else. Again, see screengrab below.

[cid:f2ea4e34-c418-48d3-86b2-d7ff1002990a]

I am quite keen to contribute something to documentation. At the moment I don't \
understand enough about how libvirt works to be able to do this.

Apologies if my questions have been directed to the wrong people. If this is the case \
could you please re-direct me to the right place to ask such questions?

Best regards


[Attachment #5 (text/html)]

&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"&gt;
&lt;style type="text/css" style="display:none;"&gt; P {margin-top:0;margin-bottom:0;} \
&lt;/style&gt; &lt;/head&gt;
&lt;body dir="ltr"&gt;
&lt;div style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; color: \
rgb(0, 0, 0);"&gt; Hi libvirt users,&lt;/div&gt;
&lt;div style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; color: \
rgb(0, 0, 0);"&gt; &lt;br&gt;
&lt;/div&gt;
&lt;div style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; color: \
rgb(0, 0, 0);"&gt; I have been using libvirt on Debian Linux for a few months. (Mostly \
with virt-manager. I haven't yet learned all of the command line commands.)&lt;/div&gt; \
&lt;div style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; color: \
rgb(0, 0, 0);"&gt; &lt;br&gt;
&lt;/div&gt;
&lt;div style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; color: \
rgb(0, 0, 0);"&gt; I'm currently confused by bridge mode networking, which I think is \
what I require to address the particular use case, which I will describe:&lt;/div&gt; &lt;div \
style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, \
0);"&gt; &lt;br&gt;
&lt;/div&gt;
&lt;div style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; color: \
rgb(0, 0, 0);"&gt; My use case:&lt;/div&gt;
&lt;div style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; color: \
rgb(0, 0, 0);"&gt; &lt;br&gt;
&lt;/div&gt;
&lt;div style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; color: \
rgb(0, 0, 0);"&gt; Prior to this I have been using routed mode to organize my VMs. Most \
of the VMs I deploy are for services (web servers, mail servers, etc) so I require \
them to have static IP addresses on my local network.&lt;/div&gt; &lt;div style="font-family: \
Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);"&gt; &lt;br&gt;
&lt;/div&gt;
&lt;div style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; color: \
rgb(0, 0, 0);"&gt; ==== An aside / comment: I *can* set those static IPs using the \
command line virsh net-edit (from memory) command and then change the settings in the \
xml files. However, s&lt;span style="color: rgb(0, 0, 0); font-family: Calibri, \
Helvetica, sans-serif; font-size: 12pt;"&gt;ince  this seems like something that many \
users would require regularly it would be nice to be able to set static IP in the GUI \
when configuring with virt-manager. I assume that the same people who maintain \
libvirt also maintain virt-manager? If I'm wrong please  re-direct me.&lt;/span&gt;&lt;/div&gt;
&lt;div style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; color: \
rgb(0, 0, 0);"&gt; &lt;br&gt;
&lt;/div&gt;
&lt;div style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; color: \
rgb(0, 0, 0);"&gt; Returning to the main discussion: It would be more convenient for me \
personally if I were able to set the IP addresses of these VMs using static addresses \
configured via an external DHCP server. I believe I can do this if my network is in \
"bridge" mode instead  of NAT or Routed. I know this should be possible \
from reading information online but there doesn't seem to be any option for this in \
the virt-manager GUI.&lt;/div&gt; &lt;div style="font-family: Calibri, Helvetica, sans-serif; \
font-size: 12pt; color: rgb(0, 0, 0);"&gt; &lt;br&gt;
&lt;/div&gt;
&lt;div style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; color: \
rgb(0, 0, 0);"&gt; ==== To give more details on my setup: My network has a pfsense \
instance which is able to provide IP addresses to local machines. I would like to use \
the same pfsense machine to provide IP addresses to virtual machines. If I am not \
mistaken, the only way to  do this would be to bridge the network on which the VMs \
reside to the network on which the pfsense machine resides.&lt;/div&gt; &lt;div \
style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, \
0);"&gt; &lt;br&gt;
&lt;/div&gt;
&lt;div style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; color: \
rgb(0, 0, 0);"&gt; I will provide some screenshots to illustrate my confusion. When \
creating a new virtual network, I assume that I do not want to enable DHCPv4, because \
I want the pfsense system to allocate IP addresses. I do not know whether I should \
leave "Enable ipv4 network  address space definition" or what the value \
should be. See image below.&lt;/div&gt; &lt;div style="font-family: Calibri, Helvetica, \
sans-serif; font-size: 12pt; color: rgb(0, 0, 0);"&gt; &lt;br&gt;
&lt;/div&gt;
&lt;div style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; color: \
rgb(0, 0, 0);"&gt; &lt;img size="51867" contenttype="image/png" unselectable="on" \
tabindex="-1" style="max-width: 100%; user-select: none;" \
data-outlook-trace="F:1|T:1" src="cid:4e926d97-7a58-4350-93cc-0db7c401c075"&gt;&lt;br&gt; \
&lt;/div&gt; &lt;div style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; \
color: rgb(0, 0, 0);"&gt; &lt;br&gt;
&lt;/div&gt;
&lt;div style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; color: \
rgb(0, 0, 0);"&gt; &lt;br&gt;
&lt;/div&gt;
&lt;div style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; color: \
rgb(0, 0, 0);"&gt; Further in the setup (step 4), I assume I need to choose \
"Forward to physical network" rather than "Isolated virtual \
network".&lt;/div&gt; &lt;div style="font-family: Calibri, Helvetica, sans-serif; \
font-size: 12pt; color: rgb(0, 0, 0);"&gt; &lt;br&gt;
&lt;/div&gt;
&lt;div style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; color: \
rgb(0, 0, 0);"&gt; For the destination option, I do not know what should be chosen. I \
don't fully understand how this option works.&lt;/div&gt; &lt;div style="font-family: Calibri, \
Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);"&gt; &lt;br&gt;
&lt;/div&gt;
&lt;div style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; color: \
rgb(0, 0, 0);"&gt; For "Mode" there are three options: NAT, Routed and finally \
"Open". I cannot find any documentation which indicates what \
"Open" means. NAT and Routed are clearly not the correct options here - by \
a process of elimination that would imply that "Open" means \
"bridged"  but I have a feeling that this is incorrect and I don't \
understand something else. Again, see screengrab below.&lt;/div&gt; &lt;div \
style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, \
0);"&gt; &lt;br&gt;
&lt;/div&gt;
&lt;div style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; color: \
rgb(0, 0, 0);"&gt; &lt;img size="58888" contenttype="image/png" unselectable="on" \
tabindex="-1" style="max-width: 100%; user-select: none;" \
data-outlook-trace="F:1|T:1" src="cid:f2ea4e34-c418-48d3-86b2-d7ff1002990a"&gt;&lt;br&gt; \
&lt;/div&gt; &lt;div style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; \
color: rgb(0, 0, 0);"&gt; &lt;br&gt;
&lt;/div&gt;
&lt;div style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; color: \
rgb(0, 0, 0);"&gt; I am quite keen to contribute something to documentation. At the \
moment I don't understand enough about how libvirt works to be able to do this.&lt;/div&gt; \
&lt;div style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; color: \
rgb(0, 0, 0);"&gt; &lt;br&gt;
&lt;/div&gt;
&lt;div style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; color: \
rgb(0, 0, 0);"&gt; Apologies if my questions have been directed to the wrong people. If \
this is the case could you please re-direct me to the right place to ask such \
questions?&lt;/div&gt; &lt;div style="font-family: Calibri, Helvetica, sans-serif; font-size: \
12pt; color: rgb(0, 0, 0);"&gt; &lt;br&gt;
&lt;/div&gt;
&lt;div style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; color: \
rgb(0, 0, 0);"&gt; Best regards&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;


["image.png" (image/png)]
["image.png" (image/png)]

</body></email><email><emailId>20210413103857</emailId><senderName>shafnamol N</senderName><senderEmail>shafnamol29@gmail.com</senderEmail><timestampReceived>2021-04-13 10:38:57-0400</timestampReceived><subject>could not start libvirt service</subject><body>

Hi,

I am using *CentOS 8*. I have built *libvirt* with the following method:

$ meson build -Dsystem=true
$ ninja -C build
$ ninja -C build install

But the problem is when i started it

# systemctl start libvirtd
Job for libvirtd.service failed because the control process exited
with error code.
See "systemctl status libvirtd.service" and "journalctl -xe" for details.

i tried to get the status of libvirt

# systemctl status libvirtd

libvirtd.service - Virtualization daemon
   Loaded: loaded (/usr/lib/systemd/system/libvirtd.service; enabled;
vendor preset: enabled)
   Active: failed (Result: exit-code)

What will be the problem?

Thanks for the help in advanc....

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div&gt;Hi,&lt;/div&gt;&lt;div&gt;&lt;p&gt;I am using &lt;strong&gt;CentOS 8&lt;/strong&gt;.
I have built &lt;strong&gt;libvirt&lt;/strong&gt; with the following method:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&lt;span style="background-color:rgb(238,238,238)"&gt;$ meson build \
-Dsystem=true $ ninja -C build
$ ninja -C build install&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;But the problem is when i started it&lt;/p&gt;
&lt;pre&gt;&lt;span style="background-color:rgb(238,238,238)"&gt;&lt;code&gt;# systemctl start libvirtd
Job for libvirtd.service failed because the control process exited with error code.
See "systemctl status libvirtd.service" and "journalctl -xe" for \
details. &lt;/code&gt;&lt;/span&gt;&lt;/pre&gt;
&lt;p&gt;i tried to get the status of libvirt&lt;/p&gt;&lt;p&gt;&lt;span \
style="font-family:monospace"&gt;#&lt;span style="background-color:rgb(238,238,238)"&gt; \
systemctl status libvirtd&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span \
style="background-color:rgb(238,238,238)"&gt;&lt;span \
style="font-family:monospace"&gt;libvirtd.service - Virtualization daemon&lt;br&gt;     \
Loaded: loaded (/usr/lib/systemd/system/libvirtd.service; enabled; vendor preset: \
enabled)&lt;br&gt;     Active: failed (Result: exit-code) &lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span \
style="background-color:rgb(238,238,238)"&gt;&lt;span style="font-family:monospace"&gt;&lt;span \
style="background-color:rgb(255,255,255)"&gt;What w&lt;/span&gt;ill be the \
problem?&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style="background-color:rgb(238,238,238)"&gt;&lt;span \
style="font-family:monospace"&gt;&lt;span style="background-color:rgb(255,255,255)"&gt;Thanks \
for the help in advanc&lt;/span&gt;....&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210420011931</emailId><senderName>Eyüp_Hakan_Duran</senderName><senderEmail>ehakanduran@gmail.com</senderEmail><timestampReceived>2021-04-20 01:19:31-0400</timestampReceived><subject>external snapshot create error</subject><body>

Dear all,

I have been creating external snapshots of my KVM/QEMU VMs for more than a
year on a host machine that runs Manjaro Linux. The current version of
libvirt I am using is 1:7.1.0-3. I just noticed that the script I am using
for this purpose has been failing. More specifically the command below
returns with the error message indicated underneath the command:

sudo virsh snapshot-create-as --no-metadata --domain myVM myVM-state
--diskspec hda,file=overlay.qcow2 --disk-only --atomic
error: XML document failed to validate against schema: Unable to validate
doc against /usr/share/libvirt/schemas/domainsnapshot.rng
Extra element disks in interleave
Element domainsnapshot failed to validate content

I also tried different versions of the command above with similar results,
such as:
sudo virsh snapshot-create-as mvVM --no-metadata myVM-state --diskspec
hda,snapshot=external,file=overlay.qcow2 --disk-only --atomic

Any pointers will be greatly appreciated!

Hakan Duran

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div&gt;Dear all,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I have been creating external \
snapshots of my KVM/QEMU VMs for more than a year on a host machine that runs Manjaro \
Linux. The current version of libvirt I am using is 1:7.1.0-3. I just noticed that \
the script I am using for this purpose has been failing. More specifically the \
command below returns with the error message indicated underneath the \
command:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style="font-family:monospace"&gt;&lt;span \
style="color:rgb(0,0,0);background-color:rgb(255,255,255)"&gt;&lt;span \
style="font-family:monospace"&gt;&lt;span \
style="color:rgb(0,0,0);background-color:rgb(255,255,255)"&gt;sudo virsh \
snapshot-create-as --no-metadata --domain myVM myVM-state --diskspec \
hda,file=overlay.q&lt;/span&gt;cow2 --disk-only \
--atomic&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style="font-family:monospace"&gt;&lt;span \
style="color:rgb(0,0,0);background-color:rgb(255,255,255)"&gt;error: XML document failed \
to validate against schema: Unable to validate doc against \
/usr/share/libvirt/schemas/domainsnapshot.rng&lt;/span&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="font-family:monospace"&gt;&lt;span style="font-family:monospace"&gt;&lt;span \
style="color:rgb(0,0,0);background-color:rgb(255,255,255)"&gt;Extra element disks in \
interleave &lt;/span&gt;&lt;br&gt;Element domainsnapshot failed to validate \
content&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style="font-family:monospace"&gt;&lt;span \
style="font-family:monospace"&gt;&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="font-family:monospace"&gt;&lt;span style="font-family:monospace"&gt;&lt;font \
face="arial,sans-serif"&gt;I also tried different versions of the command above with \
similar results, such as:&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="font-family:monospace"&gt;&lt;span style="font-family:monospace"&gt;&lt;span \
style="font-family:monospace"&gt;&lt;span \
style="color:rgb(0,0,0);background-color:rgb(255,255,255)"&gt;sudo virsh \
snapshot-create-as mvVM --no-metadata myVM-state --diskspec \
hda,snapshot=external,file=&lt;/span&gt;overlay.qcow2 --disk-only \
--atomic&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style="font-family:monospace"&gt;&lt;span \
style="font-family:monospace"&gt;&lt;span \
style="font-family:monospace"&gt;&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="font-family:monospace"&gt;&lt;span style="font-family:monospace"&gt;&lt;span \
style="font-family:monospace"&gt;&lt;font face="arial,sans-serif"&gt;Any pointers will be \
greatly appreciated!&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="font-family:monospace"&gt;&lt;span style="font-family:monospace"&gt;&lt;span \
style="font-family:monospace"&gt;&lt;font \
face="arial,sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="font-family:monospace"&gt;&lt;span style="font-family:monospace"&gt;&lt;span \
style="font-family:monospace"&gt;&lt;font face="arial,sans-serif"&gt;Hakan \
Duran&lt;/font&gt;&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210421105349</emailId><senderName>Roman Mohr</senderName><senderEmail>rmohr@redhat.com</senderEmail><timestampReceived>2021-04-21 10:53:49-0400</timestampReceived><subject>l3 cache and cpu pinning</subject><body>

Hi,

I have a question regarding enabling l3 cache emulation on Domains. Can
this also be enabled without cpu-pinning, or does it need cpu pinning to
emulate the l3 caches according to the cpus where the guest is pinned to?

Thank you and best regards,
Roman

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I have a question regarding enabling l3 cache \
emulation on Domains. Can this also be enabled without cpu-pinning, or does it need \
cpu pinning to emulate the l3 caches according to the cpus where the guest is pinned \
to?&lt;br&gt;&lt;br&gt;Thank you and best regards,&lt;/div&gt;&lt;div&gt;Roman&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210421110942</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-04-21 11:09:42-0400</timestampReceived><subject>Re: l3 cache and cpu pinning</subject><body>

On Wed, Apr 21, 2021 at 12:53:49PM +0200, Roman Mohr wrote:
&gt; Hi,
&gt; 
&gt; I have a question regarding enabling l3 cache emulation on Domains. Can
&gt; this also be enabled without cpu-pinning, or does it need cpu pinning to
&gt; emulate the l3 caches according to the cpus where the guest is pinned to?

I presume you're referring to

  &lt;cpu&gt;
    &lt;cache level='3' mode='emulate|passthrough|none'/&gt;
  &lt;/cpu&gt;

There is no hard restriction placed on usage of these modes by QEMU.

Conceptually though, you only want to use "passthrough" mode if you
have configured the sockets/cores/threads topology to match the host
CPUs. In turn you only ever want to set sockets/cores/threads to
match the host if you have done CPU pinning such that the topology
actually matches the host CPUs that have been pinned to.

As a rule of thumb

 - If letting CPUs float
 
     -&gt; Always uses sockets=1, cores=num-vCPUs, threads=1
     -&gt; cache==emulate
     -&gt; Always use 1 guest NUMA node (ie the default)


 - If strictly pinning CPUs 1:1

     -&gt; Use sockets=N, cores=M, threads=0 to match the topology
        of the CPUs that have been pinned to
     -&gt; cache==passthrough
     -&gt; Configure virtual NUMA nodes if the CPU pinning or guest
        RAM needs cross host NUMA nodes.



Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20210421120231</emailId><senderName>Roman Mohr</senderName><senderEmail>rmohr@redhat.com</senderEmail><timestampReceived>2021-04-21 12:02:31-0400</timestampReceived><subject>Re: l3 cache and cpu pinning</subject><body>

On Wed, Apr 21, 2021 at 1:09 PM Daniel P. Berrangé &lt;berrange@redhat.com&gt;
wrote:

&gt; On Wed, Apr 21, 2021 at 12:53:49PM +0200, Roman Mohr wrote:
&gt; &gt; Hi,
&gt; &gt;
&gt; &gt; I have a question regarding enabling l3 cache emulation on Domains. Can
&gt; &gt; this also be enabled without cpu-pinning, or does it need cpu pinning to
&gt; &gt; emulate the l3 caches according to the cpus where the guest is pinned to?
&gt;
&gt; I presume you're referring to
&gt;
&gt;   &lt;cpu&gt;
&gt;     &lt;cache level='3' mode='emulate|passthrough|none'/&gt;
&gt;   &lt;/cpu&gt;
&gt;

Exactly.


&gt;
&gt; There is no hard restriction placed on usage of these modes by QEMU.
&gt;
&gt; Conceptually though, you only want to use "passthrough" mode if you
&gt; have configured the sockets/cores/threads topology to match the host
&gt; CPUs. In turn you only ever want to set sockets/cores/threads to
&gt; match the host if you have done CPU pinning such that the topology
&gt; actually matches the host CPUs that have been pinned to.
&gt;
&gt; As a rule of thumb
&gt;
&gt;  - If letting CPUs float
&gt;
&gt;      -&gt; Always uses sockets=1, cores=num-vCPUs, threads=1
&gt;      -&gt; cache==emulate
&gt;      -&gt; Always use 1 guest NUMA node (ie the default)
&gt;
&gt;
&gt;  - If strictly pinning CPUs 1:1
&gt;
&gt;      -&gt; Use sockets=N, cores=M, threads=0 to match the topology
&gt;         of the CPUs that have been pinned to
&gt;      -&gt; cache==passthrough
&gt;      -&gt; Configure virtual NUMA nodes if the CPU pinning or guest
&gt;         RAM needs cross host NUMA nodes.
&gt;
&gt;
&gt;
Thanks, that answers my questions.

Best regards,
Roman


&gt;
&gt; Regards,
&gt; Daniel
&gt; --
&gt; |: https://berrange.com      -o-
&gt; https://www.flickr.com/photos/dberrange :|
&gt; |: https://libvirt.org         -o-
&gt; https://fstop138.berrange.com :|
&gt; |: https://entangle-photo.org    -o-
&gt; https://www.instagram.com/dberrange :|
&gt;
&gt;

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" \
class="gmail_attr"&gt;On Wed, Apr 21, 2021 at 1:09 PM Daniel P. Berrangé &lt;&lt;a \
href="mailto:berrange@redhat.com"&gt;berrange@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;On Wed, Apr 21, 2021 \
at 12:53:49PM +0200, Roman Mohr wrote:&lt;br&gt; &gt; Hi,&lt;br&gt;
&gt; &lt;br&gt;
&gt; I have a question regarding enabling l3 cache emulation on Domains. Can&lt;br&gt;
&gt; this also be enabled without cpu-pinning, or does it need cpu pinning to&lt;br&gt;
&gt; emulate the l3 caches according to the cpus where the guest is pinned to?&lt;br&gt;
&lt;br&gt;
I presume you're referring to&lt;br&gt;
&lt;br&gt;
   &lt;cpu&gt;&lt;br&gt;
      &lt;cache level='3' mode='emulate|passthrough|none'/&gt;&lt;br&gt;
   &lt;/cpu&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Exactly.&lt;/div&gt;&lt;div&gt;  \
&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px \
solid rgb(204,204,204);padding-left:1ex"&gt; &lt;br&gt;
There is no hard restriction placed on usage of these modes by QEMU.&lt;br&gt;
&lt;br&gt;
Conceptually though, you only want to use "passthrough" mode if you&lt;br&gt;
have configured the sockets/cores/threads topology to match the host&lt;br&gt;
CPUs. In turn you only ever want to set sockets/cores/threads to&lt;br&gt;
match the host if you have done CPU pinning such that the topology&lt;br&gt;
actually matches the host CPUs that have been pinned to.&lt;br&gt;
&lt;br&gt;
As a rule of thumb&lt;br&gt;
&lt;br&gt;
  - If letting CPUs float&lt;br&gt;
&lt;br&gt;
        -&gt; Always uses sockets=1, cores=num-vCPUs, threads=1&lt;br&gt;
        -&gt; cache==emulate&lt;br&gt;
        -&gt; Always use 1 guest NUMA node (ie the default)&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
  - If strictly pinning CPUs 1:1&lt;br&gt;
&lt;br&gt;
        -&gt; Use sockets=N, cores=M, threads=0 to match the topology&lt;br&gt;
            of the CPUs that have been pinned to&lt;br&gt;
        -&gt; cache==passthrough&lt;br&gt;
        -&gt; Configure virtual NUMA nodes if the CPU pinning or guest&lt;br&gt;
            RAM needs cross host NUMA nodes.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks, that answers my \
questions.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Best regards,&lt;/div&gt;&lt;div&gt;Roman&lt;/div&gt;&lt;div&gt;  \
&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px \
solid rgb(204,204,204);padding-left:1ex"&gt; &lt;br&gt;
Regards,&lt;br&gt;
Daniel&lt;br&gt;
-- &lt;br&gt;
&gt; &gt; &lt;a href="https://berrange.com" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://berrange.com&lt;/a&gt;         -o-      &lt;a \
&gt; &gt; href="https://www.flickr.com/photos/dberrange" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://www.flickr.com/photos/dberrange&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="https://libvirt.org" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://libvirt.org&lt;/a&gt;              -o-                  &lt;a \
&gt; &gt; href="https://fstop138.berrange.com" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://fstop138.berrange.com&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="https://entangle-photo.org" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://entangle-photo.org&lt;/a&gt;      -o-      &lt;a \
&gt; &gt; href="https://www.instagram.com/dberrange" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://www.instagram.com/dberrange&lt;/a&gt; :|&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210421121339</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-04-21 12:13:39-0400</timestampReceived><subject>Re: l3 cache and cpu pinning</subject><body>

On Wed, Apr 21, 2021 at 12:09:42PM +0100, Daniel P. Berrangé wrote:
&gt; On Wed, Apr 21, 2021 at 12:53:49PM +0200, Roman Mohr wrote:
&gt; &gt; Hi,
&gt; &gt; 
&gt; &gt; I have a question regarding enabling l3 cache emulation on Domains. Can
&gt; &gt; this also be enabled without cpu-pinning, or does it need cpu pinning to
&gt; &gt; emulate the l3 caches according to the cpus where the guest is pinned to?
&gt; 
&gt; I presume you're referring to
&gt; 
&gt;   &lt;cpu&gt;
&gt;     &lt;cache level='3' mode='emulate|passthrough|none'/&gt;
&gt;   &lt;/cpu&gt;
&gt; 
&gt; There is no hard restriction placed on usage of these modes by QEMU.
&gt; 
&gt; Conceptually though, you only want to use "passthrough" mode if you
&gt; have configured the sockets/cores/threads topology to match the host
&gt; CPUs. In turn you only ever want to set sockets/cores/threads to
&gt; match the host if you have done CPU pinning such that the topology
&gt; actually matches the host CPUs that have been pinned to.
&gt; 
&gt; As a rule of thumb
&gt; 
&gt;  - If letting CPUs float
&gt;  
&gt;      -&gt; Always uses sockets=1, cores=num-vCPUs, threads=1
&gt;      -&gt; cache==emulate
&gt;      -&gt; Always use 1 guest NUMA node (ie the default)
&gt; 
&gt; 
&gt;  - If strictly pinning CPUs 1:1
&gt; 
&gt;      -&gt; Use sockets=N, cores=M, threads=0 to match the topology
&gt;         of the CPUs that have been pinned to

Opps, I meant  threads=P there, not 0 - ie match host threads.

With recentish libvirt+QEMU there is also a "dies=NNN" parameter for
topology which may be relevant for some host CPUs (very recent Intel
ones)

&gt;      -&gt; cache==passthrough
&gt;      -&gt; Configure virtual NUMA nodes if the CPU pinning or guest
&gt;         RAM needs cross host NUMA nodes.

Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20210422111926</emailId><senderName>Roman Mohr</senderName><senderEmail>rmohr@redhat.com</senderEmail><timestampReceived>2021-04-22 11:19:26-0400</timestampReceived><subject>Re: l3 cache and cpu pinning</subject><body>

On Wed, Apr 21, 2021 at 1:09 PM Daniel P. Berrangé &lt;berrange@redhat.com&gt;
wrote:

&gt; On Wed, Apr 21, 2021 at 12:53:49PM +0200, Roman Mohr wrote:
&gt; &gt; Hi,
&gt; &gt;
&gt; &gt; I have a question regarding enabling l3 cache emulation on Domains. Can
&gt; &gt; this also be enabled without cpu-pinning, or does it need cpu pinning to
&gt; &gt; emulate the l3 caches according to the cpus where the guest is pinned to?
&gt;
&gt; I presume you're referring to
&gt;
&gt;   &lt;cpu&gt;
&gt;     &lt;cache level='3' mode='emulate|passthrough|none'/&gt;
&gt;   &lt;/cpu&gt;
&gt;
&gt; There is no hard restriction placed on usage of these modes by QEMU.
&gt;
&gt; Conceptually though, you only want to use "passthrough" mode if you
&gt; have configured the sockets/cores/threads topology to match the host
&gt; CPUs. In turn you only ever want to set sockets/cores/threads to
&gt; match the host if you have done CPU pinning such that the topology
&gt; actually matches the host CPUs that have been pinned to.
&gt;
&gt; As a rule of thumb
&gt;
&gt;  - If letting CPUs float
&gt;
&gt;      -&gt; Always uses sockets=1, cores=num-vCPUs, threads=1
&gt;      -&gt; cache==emulate
&gt;      -&gt; Always use 1 guest NUMA node (ie the default)
&gt;
&gt;
Is `emulate` also the default in libvirt? If not, would you see any reason,
e.g. thinking about migrations, to not set it always if no cpu pinning is
done?


&gt;
&gt;  - If strictly pinning CPUs 1:1
&gt;
&gt;      -&gt; Use sockets=N, cores=M, threads=0 to match the topology
&gt;         of the CPUs that have been pinned to
&gt;      -&gt; cache==passthrough
&gt;      -&gt; Configure virtual NUMA nodes if the CPU pinning or guest
&gt;         RAM needs cross host NUMA nodes.
&gt;
&gt;
&gt;
&gt; Regards,
&gt; Daniel
&gt; --
&gt; |: https://berrange.com      -o-
&gt; https://www.flickr.com/photos/dberrange :|
&gt; |: https://libvirt.org         -o-
&gt; https://fstop138.berrange.com :|
&gt; |: https://entangle-photo.org    -o-
&gt; https://www.instagram.com/dberrange :|
&gt;
&gt;

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" \
class="gmail_attr"&gt;On Wed, Apr 21, 2021 at 1:09 PM Daniel P. Berrangé &lt;&lt;a \
href="mailto:berrange@redhat.com"&gt;berrange@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;On Wed, Apr 21, 2021 \
at 12:53:49PM +0200, Roman Mohr wrote:&lt;br&gt; &gt; Hi,&lt;br&gt;
&gt; &lt;br&gt;
&gt; I have a question regarding enabling l3 cache emulation on Domains. Can&lt;br&gt;
&gt; this also be enabled without cpu-pinning, or does it need cpu pinning to&lt;br&gt;
&gt; emulate the l3 caches according to the cpus where the guest is pinned to?&lt;br&gt;
&lt;br&gt;
I presume you're referring to&lt;br&gt;
&lt;br&gt;
   &lt;cpu&gt;&lt;br&gt;
      &lt;cache level='3' mode='emulate|passthrough|none'/&gt;&lt;br&gt;
   &lt;/cpu&gt;&lt;br&gt;
&lt;br&gt;
There is no hard restriction placed on usage of these modes by QEMU.&lt;br&gt;
&lt;br&gt;
Conceptually though, you only want to use "passthrough" mode if you&lt;br&gt;
have configured the sockets/cores/threads topology to match the host&lt;br&gt;
CPUs. In turn you only ever want to set sockets/cores/threads to&lt;br&gt;
match the host if you have done CPU pinning such that the topology&lt;br&gt;
actually matches the host CPUs that have been pinned to.&lt;br&gt;
&lt;br&gt;
As a rule of thumb&lt;br&gt;
&lt;br&gt;
  - If letting CPUs float&lt;br&gt;
&lt;br&gt;
        -&gt; Always uses sockets=1, cores=num-vCPUs, threads=1&lt;br&gt;
        -&gt; cache==emulate&lt;br&gt;
        -&gt; Always use 1 guest NUMA node (ie the default)&lt;br&gt;
&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is `emulate` also the default in libvirt? If \
not, would you see any reason, e.g. thinking about migrations, to not set it always \
if no cpu pinning is done?&lt;/div&gt;&lt;div&gt;  &lt;/div&gt;&lt;blockquote class="gmail_quote" \
style="margin:0px 0px 0px 0.8ex;border-left:1px solid \
rgb(204,204,204);padding-left:1ex"&gt; &lt;br&gt;
  - If strictly pinning CPUs 1:1&lt;br&gt;
&lt;br&gt;
        -&gt; Use sockets=N, cores=M, threads=0 to match the topology&lt;br&gt;
            of the CPUs that have been pinned to&lt;br&gt;
        -&gt; cache==passthrough&lt;br&gt;
        -&gt; Configure virtual NUMA nodes if the CPU pinning or guest&lt;br&gt;
            RAM needs cross host NUMA nodes.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Regards,&lt;br&gt;
Daniel&lt;br&gt;
-- &lt;br&gt;
&gt; &gt; &lt;a href="https://berrange.com" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://berrange.com&lt;/a&gt;         -o-      &lt;a \
&gt; &gt; href="https://www.flickr.com/photos/dberrange" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://www.flickr.com/photos/dberrange&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="https://libvirt.org" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://libvirt.org&lt;/a&gt;              -o-                  &lt;a \
&gt; &gt; href="https://fstop138.berrange.com" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://fstop138.berrange.com&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="https://entangle-photo.org" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://entangle-photo.org&lt;/a&gt;      -o-      &lt;a \
&gt; &gt; href="https://www.instagram.com/dberrange" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://www.instagram.com/dberrange&lt;/a&gt; :|&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210422112454</emailId><senderName>Roman Mohr</senderName><senderEmail>rmohr@redhat.com</senderEmail><timestampReceived>2021-04-22 11:24:54-0400</timestampReceived><subject>Re: l3 cache and cpu pinning</subject><body>

On Thu, Apr 22, 2021 at 1:19 PM Roman Mohr &lt;rmohr@redhat.com&gt; wrote:

&gt;
&gt;
&gt; On Wed, Apr 21, 2021 at 1:09 PM Daniel P. Berrangé &lt;berrange@redhat.com&gt;
&gt; wrote:
&gt;
&gt;&gt; On Wed, Apr 21, 2021 at 12:53:49PM +0200, Roman Mohr wrote:
&gt;&gt; &gt; Hi,
&gt;&gt; &gt;
&gt;&gt; &gt; I have a question regarding enabling l3 cache emulation on Domains. Can
&gt;&gt; &gt; this also be enabled without cpu-pinning, or does it need cpu pinning to
&gt;&gt; &gt; emulate the l3 caches according to the cpus where the guest is pinned
&gt;&gt; to?
&gt;&gt;
&gt;&gt; I presume you're referring to
&gt;&gt;
&gt;&gt;   &lt;cpu&gt;
&gt;&gt;     &lt;cache level='3' mode='emulate|passthrough|none'/&gt;
&gt;&gt;   &lt;/cpu&gt;
&gt;&gt;
&gt;&gt; There is no hard restriction placed on usage of these modes by QEMU.
&gt;&gt;
&gt;&gt; Conceptually though, you only want to use "passthrough" mode if you
&gt;&gt; have configured the sockets/cores/threads topology to match the host
&gt;&gt; CPUs. In turn you only ever want to set sockets/cores/threads to
&gt;&gt; match the host if you have done CPU pinning such that the topology
&gt;&gt; actually matches the host CPUs that have been pinned to.
&gt;&gt;
&gt;&gt; As a rule of thumb
&gt;&gt;
&gt;&gt;  - If letting CPUs float
&gt;&gt;
&gt;&gt;      -&gt; Always uses sockets=1, cores=num-vCPUs, threads=1
&gt;&gt;      -&gt; cache==emulate
&gt;&gt;      -&gt; Always use 1 guest NUMA node (ie the default)
&gt;&gt;
&gt;&gt;
&gt; Is `emulate` also the default in libvirt? If not, would you see any
&gt; reason, e.g. thinking about migrations, to not set it always if no cpu
&gt; pinning is done?
&gt;

To answer my own question: I guess something like [1] is a good reason to
not enable l3-cache by default, since it seems to have an impact on VM
density on nodes.


&gt;
&gt;
&gt;&gt;
&gt;&gt;  - If strictly pinning CPUs 1:1
&gt;&gt;
&gt;&gt;      -&gt; Use sockets=N, cores=M, threads=0 to match the topology
&gt;&gt;         of the CPUs that have been pinned to
&gt;&gt;      -&gt; cache==passthrough
&gt;&gt;      -&gt; Configure virtual NUMA nodes if the CPU pinning or guest
&gt;&gt;         RAM needs cross host NUMA nodes.
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; Regards,
&gt;&gt; Daniel
&gt;&gt; --
&gt;&gt; |: https://berrange.com      -o-
&gt;&gt; https://www.flickr.com/photos/dberrange :|
&gt;&gt; |: https://libvirt.org         -o-
&gt;&gt; https://fstop138.berrange.com :|
&gt;&gt; |: https://entangle-photo.org    -o-
&gt;&gt; https://www.instagram.com/dberrange :|
&gt;&gt;
&gt;&gt;

[1] https://lists.gnu.org/archive/html/qemu-devel/2017-11/msg04592.html

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" \
class="gmail_attr"&gt;On Thu, Apr 22, 2021 at 1:19 PM Roman Mohr &lt;&lt;a \
href="mailto:rmohr@redhat.com"&gt;rmohr@redhat.com&lt;/a&gt;&gt; wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote \
class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid \
rgb(204,204,204);padding-left:1ex"&gt;&lt;div dir="ltr"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Wed, Apr 21, 2021 at 1:09 PM \
Daniel P. Berrangé &lt;&lt;a href="mailto:berrange@redhat.com" \
target="_blank"&gt;berrange@redhat.com&lt;/a&gt;&gt; wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote \
class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid \
rgb(204,204,204);padding-left:1ex"&gt;On Wed, Apr 21, 2021 at 12:53:49PM +0200, Roman \
Mohr wrote:&lt;br&gt; &gt; Hi,&lt;br&gt;
&gt; &lt;br&gt;
&gt; I have a question regarding enabling l3 cache emulation on Domains. Can&lt;br&gt;
&gt; this also be enabled without cpu-pinning, or does it need cpu pinning to&lt;br&gt;
&gt; emulate the l3 caches according to the cpus where the guest is pinned to?&lt;br&gt;
&lt;br&gt;
I presume you're referring to&lt;br&gt;
&lt;br&gt;
   &lt;cpu&gt;&lt;br&gt;
      &lt;cache level='3' mode='emulate|passthrough|none'/&gt;&lt;br&gt;
   &lt;/cpu&gt;&lt;br&gt;
&lt;br&gt;
There is no hard restriction placed on usage of these modes by QEMU.&lt;br&gt;
&lt;br&gt;
Conceptually though, you only want to use "passthrough" mode if you&lt;br&gt;
have configured the sockets/cores/threads topology to match the host&lt;br&gt;
CPUs. In turn you only ever want to set sockets/cores/threads to&lt;br&gt;
match the host if you have done CPU pinning such that the topology&lt;br&gt;
actually matches the host CPUs that have been pinned to.&lt;br&gt;
&lt;br&gt;
As a rule of thumb&lt;br&gt;
&lt;br&gt;
  - If letting CPUs float&lt;br&gt;
&lt;br&gt;
        -&gt; Always uses sockets=1, cores=num-vCPUs, threads=1&lt;br&gt;
        -&gt; cache==emulate&lt;br&gt;
        -&gt; Always use 1 guest NUMA node (ie the default)&lt;br&gt;
&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is `emulate` also the default in libvirt? If \
not, would you see any reason, e.g. thinking about migrations, to not set it always \
if no cpu pinning is done?&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;To \
answer my own question: I guess something like [1] is a good reason to not enable \
l3-cache by default, since it seems to have an impact on VM density on \
nodes.&lt;/div&gt;&lt;div&gt;  &lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;&lt;div dir="ltr"&gt;&lt;div \
class="gmail_quote"&gt;&lt;div&gt;  &lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px \
0px 0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt; &lt;br&gt;
  - If strictly pinning CPUs 1:1&lt;br&gt;
&lt;br&gt;
        -&gt; Use sockets=N, cores=M, threads=0 to match the topology&lt;br&gt;
            of the CPUs that have been pinned to&lt;br&gt;
        -&gt; cache==passthrough&lt;br&gt;
        -&gt; Configure virtual NUMA nodes if the CPU pinning or guest&lt;br&gt;
            RAM needs cross host NUMA nodes.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Regards,&lt;br&gt;
Daniel&lt;br&gt;
-- &lt;br&gt;
&gt; &gt; &lt;a href="https://berrange.com" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://berrange.com&lt;/a&gt;         -o-      &lt;a \
&gt; &gt; href="https://www.flickr.com/photos/dberrange" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://www.flickr.com/photos/dberrange&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="https://libvirt.org" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://libvirt.org&lt;/a&gt;              -o-                  &lt;a \
&gt; &gt; href="https://fstop138.berrange.com" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://fstop138.berrange.com&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="https://entangle-photo.org" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://entangle-photo.org&lt;/a&gt;      -o-      &lt;a \
&gt; &gt; href="https://www.instagram.com/dberrange" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://www.instagram.com/dberrange&lt;/a&gt; :|&lt;br&gt;
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;[1]  &lt;a \
href="https://lists.gnu.org/archive/html/qemu-devel/2017-11/msg04592.html"&gt;https://lists.gnu.org/archive/html/qemu-devel/2017-11/msg04592.html&lt;/a&gt; \
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210422113418</emailId><senderName>Roman Mohr</senderName><senderEmail>rmohr@redhat.com</senderEmail><timestampReceived>2021-04-22 11:34:18-0400</timestampReceived><subject>Re: l3 cache and cpu pinning</subject><body>

On Thu, Apr 22, 2021 at 1:24 PM Roman Mohr &lt;rmohr@redhat.com&gt; wrote:

&gt;
&gt;
&gt; On Thu, Apr 22, 2021 at 1:19 PM Roman Mohr &lt;rmohr@redhat.com&gt; wrote:
&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; On Wed, Apr 21, 2021 at 1:09 PM Daniel P. Berrangé &lt;berrange@redhat.com&gt;
&gt;&gt; wrote:
&gt;&gt;
&gt;&gt;&gt; On Wed, Apr 21, 2021 at 12:53:49PM +0200, Roman Mohr wrote:
&gt;&gt;&gt; &gt; Hi,
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; I have a question regarding enabling l3 cache emulation on Domains. Can
&gt;&gt;&gt; &gt; this also be enabled without cpu-pinning, or does it need cpu pinning
&gt;&gt;&gt; to
&gt;&gt;&gt; &gt; emulate the l3 caches according to the cpus where the guest is pinned
&gt;&gt;&gt; to?
&gt;&gt;&gt;
&gt;&gt;&gt; I presume you're referring to
&gt;&gt;&gt;
&gt;&gt;&gt;   &lt;cpu&gt;
&gt;&gt;&gt;     &lt;cache level='3' mode='emulate|passthrough|none'/&gt;
&gt;&gt;&gt;   &lt;/cpu&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; There is no hard restriction placed on usage of these modes by QEMU.
&gt;&gt;&gt;
&gt;&gt;&gt; Conceptually though, you only want to use "passthrough" mode if you
&gt;&gt;&gt; have configured the sockets/cores/threads topology to match the host
&gt;&gt;&gt; CPUs. In turn you only ever want to set sockets/cores/threads to
&gt;&gt;&gt; match the host if you have done CPU pinning such that the topology
&gt;&gt;&gt; actually matches the host CPUs that have been pinned to.
&gt;&gt;&gt;
&gt;&gt;&gt; As a rule of thumb
&gt;&gt;&gt;
&gt;&gt;&gt;  - If letting CPUs float
&gt;&gt;&gt;
&gt;&gt;&gt;      -&gt; Always uses sockets=1, cores=num-vCPUs, threads=1
&gt;&gt;&gt;      -&gt; cache==emulate
&gt;&gt;&gt;      -&gt; Always use 1 guest NUMA node (ie the default)
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt; Is `emulate` also the default in libvirt? If not, would you see any
&gt;&gt; reason, e.g. thinking about migrations, to not set it always if no cpu
&gt;&gt; pinning is done?
&gt;&gt;
&gt;
&gt; To answer my own question: I guess something like [1] is a good reason to
&gt; not enable l3-cache by default, since it seems to have an impact on VM
&gt; density on nodes.
&gt;

Hm, seems like this change got only merged for older machine types. So
according to the libvirt doc (not setting it means hypervisor default), it
is probably set to emulation?

&gt;
&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;  - If strictly pinning CPUs 1:1
&gt;&gt;&gt;
&gt;&gt;&gt;      -&gt; Use sockets=N, cores=M, threads=0 to match the topology
&gt;&gt;&gt;         of the CPUs that have been pinned to
&gt;&gt;&gt;      -&gt; cache==passthrough
&gt;&gt;&gt;      -&gt; Configure virtual NUMA nodes if the CPU pinning or guest
&gt;&gt;&gt;         RAM needs cross host NUMA nodes.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Regards,
&gt;&gt;&gt; Daniel
&gt;&gt;&gt; --
&gt;&gt;&gt; |: https://berrange.com      -o-
&gt;&gt;&gt; https://www.flickr.com/photos/dberrange :|
&gt;&gt;&gt; |: https://libvirt.org         -o-
&gt;&gt;&gt; https://fstop138.berrange.com :|
&gt;&gt;&gt; |: https://entangle-photo.org    -o-
&gt;&gt;&gt; https://www.instagram.com/dberrange :|
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;
&gt; [1] https://lists.gnu.org/archive/html/qemu-devel/2017-11/msg04592.html
&gt;

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" \
class="gmail_attr"&gt;On Thu, Apr 22, 2021 at 1:24 PM Roman Mohr &lt;&lt;a \
href="mailto:rmohr@redhat.com"&gt;rmohr@redhat.com&lt;/a&gt;&gt; wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote \
class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid \
rgb(204,204,204);padding-left:1ex"&gt;&lt;div dir="ltr"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Thu, Apr 22, 2021 at 1:19 PM \
Roman Mohr &lt;&lt;a href="mailto:rmohr@redhat.com" \
target="_blank"&gt;rmohr@redhat.com&lt;/a&gt;&gt; wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote \
class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid \
rgb(204,204,204);padding-left:1ex"&gt;&lt;div dir="ltr"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Wed, Apr 21, 2021 at 1:09 PM \
Daniel P. Berrangé &lt;&lt;a href="mailto:berrange@redhat.com" \
target="_blank"&gt;berrange@redhat.com&lt;/a&gt;&gt; wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote \
class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid \
rgb(204,204,204);padding-left:1ex"&gt;On Wed, Apr 21, 2021 at 12:53:49PM +0200, Roman \
Mohr wrote:&lt;br&gt; &gt; Hi,&lt;br&gt;
&gt; &lt;br&gt;
&gt; I have a question regarding enabling l3 cache emulation on Domains. Can&lt;br&gt;
&gt; this also be enabled without cpu-pinning, or does it need cpu pinning to&lt;br&gt;
&gt; emulate the l3 caches according to the cpus where the guest is pinned to?&lt;br&gt;
&lt;br&gt;
I presume you're referring to&lt;br&gt;
&lt;br&gt;
   &lt;cpu&gt;&lt;br&gt;
      &lt;cache level='3' mode='emulate|passthrough|none'/&gt;&lt;br&gt;
   &lt;/cpu&gt;&lt;br&gt;
&lt;br&gt;
There is no hard restriction placed on usage of these modes by QEMU.&lt;br&gt;
&lt;br&gt;
Conceptually though, you only want to use "passthrough" mode if you&lt;br&gt;
have configured the sockets/cores/threads topology to match the host&lt;br&gt;
CPUs. In turn you only ever want to set sockets/cores/threads to&lt;br&gt;
match the host if you have done CPU pinning such that the topology&lt;br&gt;
actually matches the host CPUs that have been pinned to.&lt;br&gt;
&lt;br&gt;
As a rule of thumb&lt;br&gt;
&lt;br&gt;
  - If letting CPUs float&lt;br&gt;
&lt;br&gt;
        -&gt; Always uses sockets=1, cores=num-vCPUs, threads=1&lt;br&gt;
        -&gt; cache==emulate&lt;br&gt;
        -&gt; Always use 1 guest NUMA node (ie the default)&lt;br&gt;
&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is `emulate` also the default in libvirt? If \
not, would you see any reason, e.g. thinking about migrations, to not set it always \
if no cpu pinning is done?&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;To \
answer my own question: I guess something like [1] is a good reason to not enable \
l3-cache by default, since it seems to have an impact on VM density on \
nodes.&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Hm, seems like this change \
got only  merged for older machine types. So according to the libvirt doc (not \
setting it means hypervisor default), it is probably set to \
emulation?&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;&lt;div dir="ltr"&gt;&lt;div \
class="gmail_quote"&gt;&lt;div&gt;  &lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px \
0px 0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;&lt;div \
dir="ltr"&gt;&lt;div class="gmail_quote"&gt;&lt;div&gt;  &lt;/div&gt;&lt;blockquote class="gmail_quote" \
style="margin:0px 0px 0px 0.8ex;border-left:1px solid \
rgb(204,204,204);padding-left:1ex"&gt; &lt;br&gt;
  - If strictly pinning CPUs 1:1&lt;br&gt;
&lt;br&gt;
        -&gt; Use sockets=N, cores=M, threads=0 to match the topology&lt;br&gt;
            of the CPUs that have been pinned to&lt;br&gt;
        -&gt; cache==passthrough&lt;br&gt;
        -&gt; Configure virtual NUMA nodes if the CPU pinning or guest&lt;br&gt;
            RAM needs cross host NUMA nodes.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Regards,&lt;br&gt;
Daniel&lt;br&gt;
-- &lt;br&gt;
&gt; &gt; &lt;a href="https://berrange.com" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://berrange.com&lt;/a&gt;         -o-      &lt;a \
&gt; &gt; href="https://www.flickr.com/photos/dberrange" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://www.flickr.com/photos/dberrange&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="https://libvirt.org" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://libvirt.org&lt;/a&gt;              -o-                  &lt;a \
&gt; &gt; href="https://fstop138.berrange.com" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://fstop138.berrange.com&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="https://entangle-photo.org" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://entangle-photo.org&lt;/a&gt;      -o-      &lt;a \
&gt; &gt; href="https://www.instagram.com/dberrange" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://www.instagram.com/dberrange&lt;/a&gt; :|&lt;br&gt;
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;[1]  &lt;a \
href="https://lists.gnu.org/archive/html/qemu-devel/2017-11/msg04592.html" \
target="_blank"&gt;https://lists.gnu.org/archive/html/qemu-devel/2017-11/msg04592.html&lt;/a&gt; \
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt; &lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210420071409</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-04-20 07:14:09-0400</timestampReceived><subject>Re: external snapshot create error</subject><body>

On Mon, Apr 19, 2021 at 20:19:31 -0500, Eyüp Hakan Duran wrote:
&gt; Dear all,
&gt; 
&gt; I have been creating external snapshots of my KVM/QEMU VMs for more than a
&gt; year on a host machine that runs Manjaro Linux. The current version of
&gt; libvirt I am using is 1:7.1.0-3. I just noticed that the script I am using
&gt; for this purpose has been failing. More specifically the command below
&gt; returns with the error message indicated underneath the command:
&gt; 
&gt; sudo virsh snapshot-create-as --no-metadata --domain myVM myVM-state
&gt; --diskspec hda,file=overlay.qcow2 --disk-only --atomic
&gt; error: XML document failed to validate against schema: Unable to validate
&gt; doc against /usr/share/libvirt/schemas/domainsnapshot.rng

The problem is that file=overlay.qcow2 points to a relative path (not
starting with a leading '/'). Libvirt enforces that the path must be a
full path.

&gt; Extra element disks in interleave
&gt; Element domainsnapshot failed to validate content

I've recently pushed a commit which removes the XML validation in this
case as it's counter-productive and the XML parser provides a more
understandable error:

https://gitlab.com/libvirt/libvirt/-/commit/f1c9fed2ca8f2509495f46b355dab019604f7475

(note that this commit will be in the upcomming libvirt-7.3 release)

&gt; I also tried different versions of the command above with similar results,
&gt; such as:
&gt; sudo virsh snapshot-create-as mvVM --no-metadata myVM-state --diskspec
&gt; hda,snapshot=external,file=overlay.qcow2 --disk-only --atomic
&gt; 
&gt; Any pointers will be greatly appreciated!
&gt; 
&gt; Hakan Duran

</body></email><email><emailId>20210413105506</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-04-13 10:55:06-0400</timestampReceived><subject>Re: could not start libvirt service</subject><body>

On Tue, Apr 13, 2021 at 15:56:57 +0530, shafnamol N wrote:
&gt; Hi,
&gt; 
&gt; I am using *CentOS 8*. I have built *libvirt* with the following method:
&gt; 
&gt; $ meson build -Dsystem=true
&gt; $ ninja -C build
&gt; $ ninja -C build install
&gt; 
&gt; But the problem is when i started it
&gt; 
&gt; # systemctl start libvirtd
&gt; Job for libvirtd.service failed because the control process exited
&gt; with error code.
&gt; See "systemctl status libvirtd.service" and "journalctl -xe" for details.
&gt; 
&gt; i tried to get the status of libvirt
&gt; 
&gt; # systemctl status libvirtd
&gt; 
&gt; libvirtd.service - Virtualization daemon
&gt;    Loaded: loaded (/usr/lib/systemd/system/libvirtd.service; enabled;
&gt; vendor preset: enabled)
&gt;    Active: failed (Result: exit-code)
&gt; 
&gt; What will be the problem?

Well, what does the log say?

https://www.libvirt.org/kbase/debuglogs.html

</body></email><email><emailId>20210413105903</emailId><senderName>Pavel Hrdina</senderName><senderEmail>phrdina@redhat.com</senderEmail><timestampReceived>2021-04-13 10:59:03-0400</timestampReceived><subject>Re: could not start libvirt service</subject><body>


On Tue, Apr 13, 2021 at 03:56:57PM +0530, shafnamol N wrote:
&gt; Hi,
&gt; 
&gt; I am using *CentOS 8*. I have built *libvirt* with the following method:
&gt; 
&gt; $ meson build -Dsystem=true
&gt; $ ninja -C build
&gt; $ ninja -C build install

I would recommend to never to this again. In general installing upstream
projects into any distribution like this is asking for a lot of trouble.
The upstream project can change files owned by other packages and break
them and running yum update can override anything the upstream project
installed.

Ideally you want to create in case of CentOS RPM package and install
that instead. If that's not possible you should install upstream project
into /usr/local/ directory which distribution packages usually don't
touch at all.

In case of libvirt you can do the following steps:

    meson build
    ninja -C build dist
    rpmbuild -tb build/meson-dist/libvirt-{version}.tar.xz

The resulting RPMs will be in ~/rpmbuild/RPMS/{arch}/

you can install all of them but you can also install only what you are
interested in.

&gt; But the problem is when i started it
&gt; 
&gt; # systemctl start libvirtd
&gt; Job for libvirtd.service failed because the control process exited
&gt; with error code.
&gt; See "systemctl status libvirtd.service" and "journalctl -xe" for details.
&gt; 
&gt; i tried to get the status of libvirt
&gt; 
&gt; # systemctl status libvirtd
&gt; 
&gt; libvirtd.service - Virtualization daemon
&gt;    Loaded: loaded (/usr/lib/systemd/system/libvirtd.service; enabled;
&gt; vendor preset: enabled)
&gt;    Active: failed (Result: exit-code)
&gt; 
&gt; What will be the problem?
&gt; 
&gt; Thanks for the help in advanc....

There is not enough info to figure out what the problem is. Including
the output of 'journalctl -xe' as suggested would be useful.

Pavel

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20210412122847</emailId><senderName>Gianluca Cecchi</senderName><senderEmail>gianluca.cecchi@gmail.com</senderEmail><timestampReceived>2021-04-12 12:28:47-0400</timestampReceived><subject>Re: Confusion over networking configuration - I might be able to do some documentation</subject><body>

On Mon, Apr 12, 2021 at 2:02 PM Ed B &lt;HYPER-NOVA@live.co.uk&gt; wrote:

&gt;
&gt; ==== To give more details on my setup: My network has a pfsense instance
&gt; which is able to provide IP addresses to local machines. I would like to
&gt; use the same pfsense machine to provide IP addresses to virtual machines.
&gt; If I am not mistaken, the only way to do this would be to bridge the
&gt; network on which the VMs reside to the network on which the pfsense machine
&gt; resides.
&gt;
&gt;
If I compare with my Fedora 33 configuration (libvirt 3.0.0 and
virt-manager 3.2.0) when you want bridged mode, you don't have to add a
network, but when you add a vnic or customize an existing vnic, in network
source you can put it on one of the existing virtual networks or you have
two additional options:
. Macvtap device
. Bridge device

So you should choose the last one
HIH,
Gianluca

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Mon, Apr \
12, 2021 at 2:02 PM Ed B &lt;&lt;a \
href="mailto:HYPER-NOVA@live.co.uk"&gt;HYPER-NOVA@live.co.uk&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;




&lt;div dir="ltr"&gt;&lt;br&gt;&lt;div \
style="font-family:Calibri,Helvetica,sans-serif;font-size:12pt;color:rgb(0,0,0)"&gt; \
==== To give more details on my setup: My network has a pfsense instance which is \
able to provide IP addresses to local machines. I would like to use the same pfsense \
machine to provide IP addresses to virtual machines. If I am not mistaken, the only \
way to  do this would be to bridge the network on which the VMs reside to the network \
on which the pfsense machine \
resides.&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If I compare with my Fedora \
33 configuration (libvirt 3.0.0 and virt-manager 3.2.0) when you want bridged mode, \
you don't have to add a network, but when you add a vnic or customize an existing \
vnic, in network source you can put it on one of the existing virtual networks or you \
have two additional options:&lt;/div&gt;&lt;div&gt;. Macvtap device&lt;/div&gt;&lt;div&gt;. Bridge \
device&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So you should choose the last \
one&lt;/div&gt;&lt;div&gt;HIH,&lt;/div&gt;&lt;div&gt;Gianluca&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210407174654</emailId><senderName>Thomas Stein</senderName><senderEmail>himbeere@meine-oma.de</senderEmail><timestampReceived>2021-04-07 17:46:54-0400</timestampReceived><subject>Re: libvirt 7.2.0 domainbackup</subject><body>


Got a little bit further. "virsh backup-begin jitsi jitsi-backup.xml" 
works and I have a backup file now. VM was running all the time. 
Question. Is it save to use this function this way? Currently I do:

virsh snapshot-create-as --domain jitsi weekly --diskspec 
vda,file=/var/lib/libvirt/jitsi/jitsi_weekly.qcow2-$(date +%Y-%m-%d) 
--disk-only --atomic --no-metadata

ncftpput -V -F -d ...

virsh blockcommit jitsi vda --active --verbose --pivot

So while the backup is being written there is no write operation 
happening to the file.

Any thoughts?

cheers, t.

On 2021-04-07 19:03, Thomas Stein wrote:
&gt; Hello one and all.
&gt; 
&gt; Just wanted to check out the new feature domainbackup but having
&gt; trouble to configure it. I thought I just have to put
&gt; 
&gt; &lt;domainbackup&gt;
&gt;   &lt;disks&gt;
&gt;     &lt;disk name='vda' type='file'&gt;
&gt;       &lt;target file='/var/lib/libvirt/jitsi'/&gt;
&gt;       &lt;driver type='raw'/&gt;
&gt;     &lt;/disk&gt;
&gt;   &lt;/disks&gt;
&gt; &lt;/domainbackup&gt;
&gt; 
&gt; at the top level of my domain xml file but that does not seem to work. 
&gt; I get:
&gt; 
&gt; error: XML document failed to validate against schema: Unable to
&gt; validate doc against /usr/share/libvirt/schemas/domain.rng
&gt; Element domain has extra content: domainbackup
&gt; 
&gt; Can someone please push me in the right direction?
&gt; 
&gt; cheers, t.

</body></email><email><emailId>20210408134537</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-04-08 13:45:37-0400</timestampReceived><subject>Re: libvirt 7.2.0 domainbackup</subject><body>

On Wed, Apr 07, 2021 at 19:03:21 +0200, Thomas Stein wrote:
&gt; Hello one and all.
&gt; 
&gt; Just wanted to check out the new feature domainbackup but having trouble to
&gt; configure it. I thought I just have to put
&gt; 
&gt; &lt;domainbackup&gt;
&gt;   &lt;disks&gt;
&gt;     &lt;disk name='vda' type='file'&gt;
&gt;       &lt;target file='/var/lib/libvirt/jitsi'/&gt;
&gt;       &lt;driver type='raw'/&gt;
&gt;     &lt;/disk&gt;
&gt;   &lt;/disks&gt;
&gt; &lt;/domainbackup&gt;
&gt; 
&gt; at the top level of my domain xml file but that does not seem to work. I
&gt; get:
&gt; 
&gt; error: XML document failed to validate against schema: Unable to validate
&gt; doc against /usr/share/libvirt/schemas/domain.rng
&gt; Element domain has extra content: domainbackup

That's not how it's used, if you want to create a backup you have to use
the virDomainBackupBegin API e.g. via `virsh backup-begin
VMNAME /path/to/backup.xml`.

Your backup xml file seems to look correct.

</body></email><email><emailId>20210408134656</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-04-08 13:46:56-0400</timestampReceived><subject>Re: libvirt 7.2.0 domainbackup</subject><body>

On Wed, Apr 07, 2021 at 19:46:54 +0200, Thomas Stein wrote:
&gt; 
&gt; Got a little bit further. "virsh backup-begin jitsi jitsi-backup.xml" works
&gt; and I have a backup file now. VM was running all the time. Question. Is it
&gt; save to use this function this way? Currently I do:

The backup file you'll get will represent the state of the VM at the
time the backup operation has started, but should contain a full copy of
the image from that time.

</body></email><email><emailId>20210408135314</emailId><senderName>Thomas Stein</senderName><senderEmail>himbeere@meine-oma.de</senderEmail><timestampReceived>2021-04-08 13:53:14-0400</timestampReceived><subject>Re: libvirt 7.2.0 domainbackup</subject><body>

Cool! So just to be clear, if I start the backup at 1400 and it's finished at 1410, changes to the image at 1405 are not included? It's the same quality as my current backup solution then. Thank you for your answer Peter.

cheers, t.

Am 8. April 2021 15:46:56 MESZ schrieb Peter Krempa &lt;pkrempa@redhat.com&gt;:
&gt;On Wed, Apr 07, 2021 at 19:46:54 +0200, Thomas Stein wrote:
&gt;&gt; 
&gt;&gt; Got a little bit further. "virsh backup-begin jitsi jitsi-backup.xml"
&gt;works
&gt;&gt; and I have a backup file now. VM was running all the time. Question.
&gt;Is it
&gt;&gt; save to use this function this way? Currently I do:
&gt;
&gt;The backup file you'll get will represent the state of the VM at the
&gt;time the backup operation has started, but should contain a full copy
&gt;of
&gt;the image from that time.


</body></email><email><emailId>20210407085633</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-04-07 08:56:33-0400</timestampReceived><subject>Re: Xen: libvirt.libvirtError: An error occurred, but the cause is unknown</subject><body>

On Wed, Apr 07, 2021 at 08:14:10 +0000, Mathieu Tarral wrote:
&gt; Hi,
&gt; 
&gt; I'm facing a strange issue with libvirt and the Xen driver.
&gt; 
&gt; Whenever I try to define or start a domain, I always get this error:
&gt; "libvirt.libvirtError: An error occurred, but the cause is unknown" (in Python virt-manager interface)
&gt; 
&gt; Which is not very helpful.
&gt; Trying to use virsh directly leads to the same error message:
&gt; 
&gt; virsh # start win10_xen
&gt; error: Failed to start domain win10_xen
&gt; error: An error occurred, but the cause is unknown

This is reported when we fail to set an error message

&gt; 
&gt; I checked /var/log/libvirt/libxl/libxl-driver.log, but the log file is empty.

Please try enabling full debug logging, it may at least show what the
last thing we were doing is.


https://www.libvirt.org/kbase/debuglogs.html#persistent-setting

</body></email><email><emailId>20210407092530</emailId><senderName>Mathieu Tarral</senderName><senderEmail>mathieu.tarral@protonmail.com</senderEmail><timestampReceived>2021-04-07 09:25:30-0400</timestampReceived><subject>Re: Xen: libvirt.libvirtError: An error occurred, but the cause is unknown</subject><body>

Hi Peter,

------- Original Message -------

Le mercredi 7 avril 2021 Ã  10:56, Peter Krempa &lt;pkrempa@redhat.com&gt; a Ã©crit :

&gt; On Wed, Apr 07, 2021 at 08:14:10 +0000, Mathieu Tarral wrote:
&gt; 
&gt; &gt; Hi,
&gt; &gt; 
&gt; &gt; I'm facing a strange issue with libvirt and the Xen driver.
&gt; &gt; 
&gt; &gt; Whenever I try to define or start a domain, I always get this error:
&gt; &gt; 
&gt; &gt; "libvirt.libvirtError: An error occurred, but the cause is unknown" (in Python \
&gt; &gt; virt-manager interface) 
&gt; &gt; Which is not very helpful.
&gt; &gt; 
&gt; &gt; Trying to use virsh directly leads to the same error message:
&gt; &gt; 
&gt; &gt; virsh # start win10_xen
&gt; &gt; 
&gt; &gt; error: Failed to start domain win10_xen
&gt; &gt; 
&gt; &gt; error: An error occurred, but the cause is unknown
&gt; 
&gt; This is reported when we fail to set an error message
&gt; 
&gt; &gt; I checked /var/log/libvirt/libxl/libxl-driver.log, but the log file is empty.
&gt; 
&gt; Please try enabling full debug logging, it may at least show what the
&gt; 
&gt; last thing we were doing is.
&gt; 
&gt; https://www.libvirt.org/kbase/debuglogs.html#persistent-setting

I enabled the log output in libvirt daemon, and there was one error message that \
appeared:

error : libxlMakeDomBuildInfo:553 : unsupported configuration: emulator \
'/usr/lib/xen-4.11/bin/qemu-system-i386' not found

When searching the path with apt-file, there are no packages providing this file.

I have qemu-system-x86-xen however:
https://ubuntu.pkgs.org/20.04/ubuntu-universe-amd64/qemu-system-x86-xen_4.2-3ubuntu6_amd64.deb.html


which provides /usr/bin/qemu-system-i386

Creating a symlink solved my issue:
cd /usr/lib/xen-4.11/bin
sudo ln -s /usr/bin/qemu-system-i386 .

-&gt; This seems to be an opened bug report on the libvirt Debian package (since 2016 !)
https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=830307

-&gt; Is there a way for libvirt to actually report meaningful errors in this case ?

Thanks !


</body></email><email><emailId>20210407160651</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-04-07 16:06:51-0400</timestampReceived><subject>Re: Live migration with change to setmaxmem</subject><body>

On Wed, Apr 07, 2021 at 07:45:47AM -0700, Dariusz Smigiel wrote:
&gt; Hi Team,
&gt; 
&gt; I need to migrate beefy instance between two different hosts which is
&gt; running out of resources.
&gt; 
&gt; I was wondering, if there is a way to change maximum memory value during
&gt; live migration, without shutting down the instance.

The maximum memory value controls the RAM mapping exposed to the guest,
and as such is part of the guest ABI.   Guest ABI is never permitted
to change during a live migration, as that will almost always have
seriously bad effects on the guest OS, and possibly the QEMU migration
data stream format.

IOW, no, you can't change max memory during migration, only a cold
boot.

Libvirt will enforces that preservation of ABI during migration by
validating the 2 XML configs for the src+dst host, and only permits
changes to the backend host OS integration, never frontend.


Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20210328201448</emailId><senderName>Laine Stump</senderName><senderEmail>laine@redhat.com</senderEmail><timestampReceived>2021-03-28 20:14:48-0400</timestampReceived><subject>Re: Virtual Network API for QEMU</subject><body>

On 3/27/21 8:39 AM, Radek Simko wrote:
&gt; Hi,
&gt; According to this support matrix 
&gt; https://libvirt.org/hvsupport.html#virNetworkDriver 
&gt; &lt;https://libvirt.org/hvsupport.html#virNetworkDriver&gt;
&gt; there is no support for any APIs other than hypervisor ones for qemu.
&gt; For example virConnectNumOfNetworks is not supported.

I'm afraid I don't understand your question. Which hypervisor are you 
using that you think virConnectNumOfNetworks isn't supported. The only 
possible meaning I can get from the above sentences is that you think 
virConnectNumOfNetworks isn't supported when qemu is the hypervisor, 
which is definitely *not* true.

As a matter of fact, essentiall *all* of the functions in the matrix are 
supported when qemu is the hypervisor, pretty much every one of them 
ever since their original introduction (e.g., the function you reference 
has been supported since libvirt 0.2.0, which was released in February 
2007).

Are you possibly misinterpreting the contents of the support matrix?

&gt; Is there any particular reason this is not supported? Has any 
&gt; development in that area been attempted in the past? Would contributions 
&gt; adding support be welcomed?
&gt; 
&gt; Thanks,
&gt; 
&gt; Radek Simko

</body></email><email><emailId>20210329092858</emailId><senderName>Michal Privoznik</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-03-29 09:28:58-0400</timestampReceived><subject>Re: Virtual Network API for QEMU</subject><body>

On 3/27/21 1:39 PM, Radek Simko wrote:
&gt; Hi,
&gt; According to this support matrix 
&gt; https://libvirt.org/hvsupport.html#virNetworkDriver 
&gt; &lt;https://libvirt.org/hvsupport.html#virNetworkDriver&gt;
&gt; there is no support for any APIs other than hypervisor ones for qemu.
&gt; For example virConnectNumOfNetworks is not supported.
&gt; 
&gt; Is there any particular reason this is not supported? Has any 
&gt; development in that area been attempted in the past? Would contributions 
&gt; adding support be welcomed?

To extend Laine's reply:

Libvirt has two set of drivers: statefull (where libvirt keeps the state 
of resources like domains, networks, ...) and stateless (where libvirt 
merely translates from/to APIs exposed by hypervisor).

QEMU can be an example of a statefull driver, ESX or hyperv are examples 
of stateless drivers. Stateless drivers also implement network APIs 
(again, by translating from/to APIs exposed by the underlying hypervisor 
- ESX or hypverv in this example), whereas statefull drivers use bridge 
driver. Therefore, QEMU doesn't implement any network APIs.


This is even more visible with split daemons (where monolithic libvirtd 
is broken into smaller daemons) - if virnetworkd is not running then 
things like 'virsh net-list' return an error [*].


Is there any particular problem you're facing?

Michal


* - except not really, because these split daemons are socket activated, 
so virnetworkd is stared automatically when needed.

</body></email><email><emailId>20210401100902</emailId><senderName>Michal Privoznik</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-04-01 10:09:02-0400</timestampReceived><subject>Re: Virtual Network API for QEMU</subject><body>

On 3/31/21 10:39 PM, Radek Simko wrote:
&gt; Thank you Laine and thanks Michal for the detailed explanation.
&gt; 
&gt; To add some (missing) context from my side:
&gt; 
&gt; I was attempting to virtualize Raspberry Pi on qemu via libvirt, where 
&gt; my host machine is macOS (both qemu and libvirt installed via Homebrew) 
&gt; and I while trying to set up the network I stumbled upon this:
&gt; 
&gt; |$ virsh -c 
&gt; qemu:///system?socket=/usr/local/var/run/libvirt/libvirt-sock net-list 
&gt; --all error: Failed to get the number of active networks error: this 
&gt; function is not supported by the connection driver: virConnectNumOfNetworks|
&gt; 
&gt; This error in combination with the compatibility matrix made me think 
&gt; it's just not supported.
&gt; What is the right way of interpreting this error/state? Does the host OS 
&gt; play a role in the compatibility?

Yes it does.

&gt; 
&gt; Are there any known limitations on macOS, or is this likely just a 
&gt; broken/misconfigured installation on my side?

Oh, now I get it. You are not building the network (bridge) driver. And 
looking into meson.build I can see why:


# there's no use compiling the network driver without the libvirt
# daemon, nor compiling it for macOS, where it breaks the compile
if not get_option('driver_network').disabled() and 
conf.has('WITH_LIBVIRTD') and host_machine.system() != 'darwin'
   conf.set('WITH_NETWORK', 1)
endif

https://gitlab.com/libvirt/libvirt/-/blob/master/meson.build#L1649

But I'm not sure whether the comment is still true. I don't have any 
access to macOS so I can't confirm nor deny. But since you can, you can 
try changing that condition so that WITH_NETWORK is enabled and see 
whether compilation fails. On the other hand, I'm not sure whether our 
code would be able to talk to macOS and create briges/TAP devices/...

But unless you need something specific for RasPI (i.e. generic 
HTTP/HTTPS) is enough, then you don't need libvirt network - you can use 
&lt;interface type='user'/&gt;. You can even configure it's IP address should 
you need to do so:

https://libvirt.org/formatdomain.html#userspace-slirp-stack

Michal

</body></email><email><emailId>20210401110603</emailId><senderName>Radek Simko</senderName><senderEmail>radek.simko@gmail.com</senderEmail><timestampReceived>2021-04-01 11:06:03-0400</timestampReceived><subject>Re: Virtual Network API for QEMU</subject><body>

I see, thank you for the extra context and quick response Michal.

I wasn't aware of the userspace SLIRP stack nor the darwin limitation -
will give either a try.

My main requirement is basically getting SSH to work, so I can do some
provisioning, anything else would be a bonus for me.

Radek Simko


On Thu, Apr 1, 2021 at 11:09 AM Michal Privoznik &lt;mprivozn@redhat.com&gt;
wrote:

&gt; On 3/31/21 10:39 PM, Radek Simko wrote:
&gt; &gt; Thank you Laine and thanks Michal for the detailed explanation.
&gt; &gt;
&gt; &gt; To add some (missing) context from my side:
&gt; &gt;
&gt; &gt; I was attempting to virtualize Raspberry Pi on qemu via libvirt, where
&gt; &gt; my host machine is macOS (both qemu and libvirt installed via Homebrew)
&gt; &gt; and I while trying to set up the network I stumbled upon this:
&gt; &gt;
&gt; &gt; |$ virsh -c
&gt; &gt; qemu:///system?socket=/usr/local/var/run/libvirt/libvirt-sock net-list
&gt; &gt; --all error: Failed to get the number of active networks error: this
&gt; &gt; function is not supported by the connection driver:
&gt; virConnectNumOfNetworks|
&gt; &gt;
&gt; &gt; This error in combination with the compatibility matrix made me think
&gt; &gt; it's just not supported.
&gt; &gt; What is the right way of interpreting this error/state? Does the host OS
&gt; &gt; play a role in the compatibility?
&gt;
&gt; Yes it does.
&gt;
&gt; &gt;
&gt; &gt; Are there any known limitations on macOS, or is this likely just a
&gt; &gt; broken/misconfigured installation on my side?
&gt;
&gt; Oh, now I get it. You are not building the network (bridge) driver. And
&gt; looking into meson.build I can see why:
&gt;
&gt;
&gt; # there's no use compiling the network driver without the libvirt
&gt; # daemon, nor compiling it for macOS, where it breaks the compile
&gt; if not get_option('driver_network').disabled() and
&gt; conf.has('WITH_LIBVIRTD') and host_machine.system() != 'darwin'
&gt;    conf.set('WITH_NETWORK', 1)
&gt; endif
&gt;
&gt; https://gitlab.com/libvirt/libvirt/-/blob/master/meson.build#L1649
&gt;
&gt; But I'm not sure whether the comment is still true. I don't have any
&gt; access to macOS so I can't confirm nor deny. But since you can, you can
&gt; try changing that condition so that WITH_NETWORK is enabled and see
&gt; whether compilation fails. On the other hand, I'm not sure whether our
&gt; code would be able to talk to macOS and create briges/TAP devices/...
&gt;
&gt; But unless you need something specific for RasPI (i.e. generic
&gt; HTTP/HTTPS) is enough, then you don't need libvirt network - you can use
&gt; &lt;interface type='user'/&gt;. You can even configure it's IP address should
&gt; you need to do so:
&gt;
&gt; https://libvirt.org/formatdomain.html#userspace-slirp-stack
&gt;
&gt; Michal
&gt;
&gt;

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;I see, thank you for the extra context and quick response \
Michal.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I wasn't aware of the userspace SLIRP stack nor the \
darwin limitation - will give either a try.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;My main \
requirement is basically getting SSH to work, so I can do some provisioning, anything \
else would be a bonus for me.&lt;br clear="all"&gt;&lt;div&gt;&lt;div dir="ltr" \
class="gmail_signature" data-smartmail="gmail_signature"&gt;&lt;div dir="ltr"&gt;&lt;div&gt;&lt;div \
dir="ltr"&gt;&lt;div&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="ltr"&gt;Radek \
Simko&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Thu, Apr 1, 2021 at 11:09 AM \
Michal Privoznik &lt;&lt;a href="mailto:mprivozn@redhat.com"&gt;mprivozn@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;On 3/31/21 10:39 PM, \
Radek Simko wrote:&lt;br&gt; &gt; Thank you Laine and thanks Michal for the detailed  \
explanation.&lt;br&gt; &gt; &lt;br&gt;
&gt; To add some (missing) context from my side:&lt;br&gt;
&gt; &lt;br&gt;
&gt; I was attempting to virtualize Raspberry Pi on qemu via libvirt, where &lt;br&gt;
&gt; my host machine is macOS (both qemu and libvirt installed via Homebrew) &lt;br&gt;
&gt; and I while trying to set up the network I stumbled upon this:&lt;br&gt;
&gt; &lt;br&gt;
&gt; |$ virsh -c &lt;br&gt;
&gt; qemu:///system?socket=/usr/local/var/run/libvirt/libvirt-sock net-list &lt;br&gt;
&gt; --all error: Failed to get the number of active networks error: this &lt;br&gt;
&gt; function is not supported by the connection driver: virConnectNumOfNetworks|&lt;br&gt;
&gt; &lt;br&gt;
&gt; This error in combination with the compatibility matrix made me think &lt;br&gt;
&gt; it's just not supported.&lt;br&gt;
&gt; What is the right way of interpreting this error/state? Does the host OS &lt;br&gt;
&gt; play a role in the compatibility?&lt;br&gt;
&lt;br&gt;
Yes it does.&lt;br&gt;
&lt;br&gt;
&gt; &lt;br&gt;
&gt; Are there any known limitations on macOS,  or is this likely just a &lt;br&gt;
&gt; broken/misconfigured installation on my side?&lt;br&gt;
&lt;br&gt;
Oh, now I get it. You are not building the network (bridge) driver. And &lt;br&gt;
looking into meson.build I can see why:&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
# there's no use compiling the network driver without the libvirt&lt;br&gt;
# daemon, nor compiling it for macOS, where it breaks the compile&lt;br&gt;
if not get_option('driver_network').disabled() and &lt;br&gt;
conf.has('WITH_LIBVIRTD') and host_machine.system() != 'darwin'&lt;br&gt;
     conf.set('WITH_NETWORK', 1)&lt;br&gt;
endif&lt;br&gt;
&lt;br&gt;
&lt;a href="https://gitlab.com/libvirt/libvirt/-/blob/master/meson.build#L1649" \
rel="noreferrer" target="_blank"&gt;https://gitlab.com/libvirt/libvirt/-/blob/master/meson.build#L1649&lt;/a&gt;&lt;br&gt;
 &lt;br&gt;
But I'm not sure whether the comment is still true. I don't have any &lt;br&gt;
access to macOS so I can't confirm nor deny. But since you can, you can &lt;br&gt;
try changing that condition so that WITH_NETWORK is enabled and see &lt;br&gt;
whether compilation fails. On the other hand, I'm not sure whether our &lt;br&gt;
code would be able to talk to macOS and create briges/TAP devices/...&lt;br&gt;
&lt;br&gt;
But unless you need something specific for RasPI (i.e. generic &lt;br&gt;
HTTP/HTTPS) is enough, then you don't need libvirt network - you can use &lt;br&gt;
&lt;interface type='user'/&gt;. You can even configure it's IP address \
should &lt;br&gt; you need to do so:&lt;br&gt;
&lt;br&gt;
&lt;a href="https://libvirt.org/formatdomain.html#userspace-slirp-stack" \
rel="noreferrer" target="_blank"&gt;https://libvirt.org/formatdomain.html#userspace-slirp-stack&lt;/a&gt;&lt;br&gt;
 &lt;br&gt;
Michal&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;



</body></email><email><emailId>20210401135342</emailId><senderName>Andrea Bolognani</senderName><senderEmail>abologna@redhat.com</senderEmail><timestampReceived>2021-04-01 13:53:42-0400</timestampReceived><subject>Re: Virtual Network API for QEMU</subject><body>

On Wed, 2021-03-31 at 21:39 +0100, Radek Simko wrote:
&gt; I was attempting to virtualize Raspberry Pi on qemu via libvirt,
&gt; where my host machine is macOS (both qemu and libvirt installed via
&gt; Homebrew) and I while trying to set up the network I stumbled upon
&gt; this:
&gt; 
&gt; $ virsh -c qemu:///system?socket=/usr/local/var/run/libvirt/libvirt-sock net-list --all

Aside: if you have libvirt &gt;= 6.9.0, which at this point is very
likely, you shouldn't need to include the 'socket' parameter in the
connection URI; in fact, for local connections, it should have worked
without the parameter even before that.

-- 
Andrea Bolognani / Red Hat / Virtualization

</body></email><email><emailId>20210402164751</emailId><senderName>Radek Simko</senderName><senderEmail>radek.simko@gmail.com</senderEmail><timestampReceived>2021-04-02 16:47:51-0400</timestampReceived><subject>Re: Virtual Network API for QEMU</subject><body>

Recompiling with these few changes helped and the networking drivers
_seems_ to be working on macOS.
At least I got past the error I was getting initially.

I'm just now dealing with a slightly different set of problems related to
libvirt sockets on macOS.
The Homebrew formula ships a launchd plist which doesn't seem to do socket
activation, unlike systemd.
I worked around that by setting the socket dir path manually in the config:

unix_sock_dir = "/usr/local/var/run/libvirt"

which did make libvirtd create "libvirt-sock" in that directory as
expected, but per docs there should also be a secondary read-only socket
"libvirt-sock-ro" https://libvirt.org/daemons.html#monolithic-sockets and
it's not there for some reason. Is there any additional configuration
needed to activate that secondary socket?

Feel free to tell me if this is getting too off-topic btw. - The big
picture is that I'm trying to get libvirt working on darwin and automate
RPi virtualization via Vagrant (vagrant-libvirt) and taking it step by step.

Radek Simko


On Thu, Apr 1, 2021 at 2:54 PM Andrea Bolognani &lt;abologna@redhat.com&gt; wrote:

&gt; On Wed, 2021-03-31 at 21:39 +0100, Radek Simko wrote:
&gt; &gt; I was attempting to virtualize Raspberry Pi on qemu via libvirt,
&gt; &gt; where my host machine is macOS (both qemu and libvirt installed via
&gt; &gt; Homebrew) and I while trying to set up the network I stumbled upon
&gt; &gt; this:
&gt; &gt;
&gt; &gt; $ virsh -c qemu:///system?socket=/usr/local/var/run/libvirt/libvirt-sock
&gt; net-list --all
&gt;
&gt; Aside: if you have libvirt &gt;= 6.9.0, which at this point is very
&gt; likely, you shouldn't need to include the 'socket' parameter in the
&gt; connection URI; in fact, for local connections, it should have worked
&gt; without the parameter even before that.
&gt;
&gt; --
&gt; Andrea Bolognani / Red Hat / Virtualization
&gt;
&gt;

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Recompiling with these few changes helped and the networking drivers \
_seems_ to be working on macOS.&lt;div&gt;At least I got past the error I was getting \
initially.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I'm just now dealing with a slightly \
different set of problems related to libvirt sockets on macOS.&lt;/div&gt;&lt;div&gt;The Homebrew \
formula ships a launchd plist which doesn't seem to do socket activation, unlike \
systemd.&lt;/div&gt;&lt;div&gt;I worked around that by setting the socket dir path manually in \
the config:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;unix_sock_dir = \
"/usr/local/var/run/libvirt"&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;which did make \
libvirtd create "libvirt-sock" in that directory as expected, but per docs \
there should also be a secondary read-only socket "libvirt-sock-ro" &lt;a \
href="https://libvirt.org/daemons.html#monolithic-sockets"&gt;https://libvirt.org/daemons.html#monolithic-sockets&lt;/a&gt; \
and it's not there for some reason. Is there any additional configuration needed \
to activate that secondary socket?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Feel free to tell me if \
this is getting too off-topic btw. - The big picture is that I'm trying to get \
libvirt working on darwin and automate RPi virtualization via Vagrant \
(vagrant-libvirt) and taking it step by step.&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;div dir="ltr" \
class="gmail_signature" data-smartmail="gmail_signature"&gt;&lt;div dir="ltr"&gt;&lt;div&gt;&lt;div \
dir="ltr"&gt;&lt;div&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="ltr"&gt;Radek \
Simko&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Thu, Apr 1, 2021 at 2:54 PM \
Andrea Bolognani &lt;&lt;a href="mailto:abologna@redhat.com"&gt;abologna@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;On Wed, 2021-03-31 at \
21:39 +0100, Radek Simko wrote:&lt;br&gt; &gt; I was attempting to virtualize Raspberry Pi \
on qemu via libvirt,&lt;br&gt; &gt; where my host machine is macOS (both qemu and libvirt \
installed via&lt;br&gt; &gt; Homebrew) and I while trying to set up the network I stumbled \
upon&lt;br&gt; &gt; this:&lt;br&gt;
&gt; &lt;br&gt;
&gt; $ virsh -c qemu:///system?socket=/usr/local/var/run/libvirt/libvirt-sock \
net-list --all&lt;br&gt; &lt;br&gt;
Aside: if you have libvirt &gt;= 6.9.0, which at this point is very&lt;br&gt;
likely, you shouldn't need to include the 'socket' parameter in the&lt;br&gt;
connection URI; in fact, for local connections, it should have worked&lt;br&gt;
without the parameter even before that.&lt;br&gt;
&lt;br&gt;
-- &lt;br&gt;
Andrea Bolognani / Red Hat / Virtualization&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;



</body></email><email><emailId>20210522194125</emailId><senderName>vrms</senderName><senderEmail>vrms@netcologne.de</senderEmail><timestampReceived>2021-05-22 19:41:25-0400</timestampReceived><subject>Re: Console of P2V?</subject><body>

On 22.05.21 18:52, Ken D'Ambrosio wrote:
&gt; ... apologies if this isn't quite the right list, I tried to get the
&gt; right one.=C2=A0 But, my problem: I'm firing up a Centos 6.5 box with
&gt; virt-install, [...] and it boots fine, etc., etc., but I can't get to
&gt; the console except through vnc; "virsh console" just shows a blank
&gt; screen.=C2=A0
1. I think this is absolutely the right list for your issue

2. is it really blank? or something like

=C2=A0=C2=A0=C2=A0 Connected to domain '[domain]'
=C2=A0=C2=A0=C2=A0 Escape character is ^] (Ctrl + ])

3. If I am not mistaken the guest needs to be configured in a certain
way for virsh console [domain] to work. I can't say how though

[Attachment #3 (text/html)]

&lt;html&gt;
  &lt;head&gt;
    &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;div class="moz-cite-prefix"&gt;On 22.05.21 18:52, Ken D'Ambrosio
      wrote:&lt;br&gt;
    &lt;/div&gt;
    &lt;blockquote type="cite"
      cite="mid:e8bf4f321c9ac118bb87d9d2f08ee0b6@jots.org"&gt;... apologies
      if this isn't quite the right list, I tried to get the right one.  
      But, my problem: I'm firing up a Centos 6.5 box with virt-install,
      [...] and it boots fine, etc., etc., but I can't get to the
      console except through vnc; "virsh console" just shows a blank
      screen.   &lt;br&gt;
    &lt;/blockquote&gt;
    1. I think this is absolutely the right list for your issue&lt;br&gt;
    &lt;br&gt;
    2. is it really blank? or something like &lt;br&gt;
    &lt;br&gt;
    &lt;font face="monospace"&gt;&lt;font size="+2"&gt;       Connected to domain
        '[domain]'&lt;br&gt;
               Escape character is ^] (Ctrl + ])&lt;/font&gt;&lt;/font&gt;&lt;br&gt;
    &lt;br&gt;
    3. If I am not mistaken the guest needs to be configured in a
    certain way for &lt;font size="+1" face="monospace"&gt;virsh console
      [domain]&lt;/font&gt; to work. I can't say how though&lt;br&gt;
  &lt;/body&gt;
&lt;/html&gt;


</body></email><email><emailId>20210522214932</emailId><senderName>"Ken D'Ambrosio"</senderName><senderEmail>ken@jots.org</senderEmail><timestampReceived>2021-05-22 21:49:32-0400</timestampReceived><subject>Re: Console of P2V?</subject><body>

&gt; On 22.05.21 18:52, Ken D'Ambrosio wrote:
&gt; ... apologies if this isn't quite the right list, I tried to get the 
&gt; right one.
&gt; But, my problem: I'm firing up a Centos 6.5 box &gt; with virt-install, 
&gt; [...] and
&gt; it boots fine, etc., etc., but I can't get to the console except 
&gt; through vnc;
&gt; "virsh console" just shows a blank screen.
&gt; 1. I think this is absolutely the right list for your issue

Yay. :-)

&gt; 2. is it really blank? or something like
&gt; 
&gt;    Connected to domain '[domain]'
&gt;    Escape character is ^] (Ctrl + ])

Okay, it *does* say those things -- but that's all it says.  &lt;CR&gt; gets 
me nowhere, as opposed to the other KVM hosts we have running.

&gt; 3. If I am not mistaken the guest needs to be configured in a certain 
&gt; way for
&gt; virsh console [domain] to work. I can't say how though

Hmmm... well, if anyone knows, I'm all ears.

Thanks for the reply!


</body></email><email><emailId>20210522215916</emailId><senderName>William</senderName><senderEmail>wkern@pixelgate.net</senderEmail><timestampReceived>2021-05-22 21:59:16-0400</timestampReceived><subject>Re: Console of P2V?</subject><body>

I generally use

GRUB_CMDLINE_LINUX_DEFAULT="console=tty0 console=ttyS0,115200n8"

and redo grub.cfg (i.e. update-grub, grub2-mkconfig)


-wk

On 5/22/2021 2:49 PM, Ken D'Ambrosio wrote:
&gt;&gt; On 22.05.21 18:52, Ken D'Ambrosio wrote:
&gt;&gt; ... apologies if this isn't quite the right list, I tried to get the 
&gt;&gt; right one.
&gt;&gt; But, my problem: I'm firing up a Centos 6.5 box &gt; with virt-install, 
&gt;&gt; [...] and
&gt;&gt; it boots fine, etc., etc., but I can't get to the console except 
&gt;&gt; through vnc;
&gt;&gt; "virsh console" just shows a blank screen.
&gt;&gt; 1. I think this is absolutely the right list for your issue
&gt;
&gt; Yay. :-)
&gt;
&gt;&gt; 2. is it really blank? or something like
&gt;&gt;
&gt;&gt;    Connected to domain '[domain]'
&gt;&gt;    Escape character is ^] (Ctrl + ])
&gt;
&gt; Okay, it *does* say those things -- but that's all it says. &lt;CR&gt; gets 
&gt; me nowhere, as opposed to the other KVM hosts we have running.
&gt;
&gt;&gt; 3. If I am not mistaken the guest needs to be configured in a certain 
&gt;&gt; way for
&gt;&gt; virsh console [domain] to work. I can't say how though
&gt;
&gt; Hmmm... well, if anyone knows, I'm all ears.
&gt;
&gt; Thanks for the reply!
&gt;


</body></email><email><emailId>20210523075223</emailId><senderName>vrms</senderName><senderEmail>vrms@netcologne.de</senderEmail><timestampReceived>2021-05-23 07:52:23-0400</timestampReceived><subject>Re: Console of P2V?</subject><body>

hi William

On 22.05.21 23:59, William wrote:
&gt; I generally use
&gt;
&gt; GRUB_CMDLINE_LINUX_DEFAULT="console=tty0 console=ttyS0,115200n8"
&gt; and redo grub.cfg (i.e. update-grub, grub2-mkconfig)

thanks for the pointer.

I literally ran in the guests commandline

    GRUB_CMDLINE_LINUX_DEFAULT="console=tty0 console=ttyS0,115200n8"
    sudo update-grub

which did change anything to the behavior on the hosts cli

   Connected to domain '[domain]'
   Escape character is ^] (Ctrl + ])

and then nothing

so ... what is the error I am making?






&gt; On 5/22/2021 2:49 PM, Ken D'Ambrosio wrote:
&gt;&gt;&gt; On 22.05.21 18:52, Ken D'Ambrosio wrote:
&gt;&gt;&gt; ... apologies if this isn't quite the right list, I tried to get the
&gt;&gt;&gt; right one.
&gt;&gt;&gt; But, my problem: I'm firing up a Centos 6.5 box &gt; with virt-install,
&gt;&gt;&gt; [...] and
&gt;&gt;&gt; it boots fine, etc., etc., but I can't get to the console except
&gt;&gt;&gt; through vnc;
&gt;&gt;&gt; "virsh console" just shows a blank screen.
&gt;&gt;&gt; 1. I think this is absolutely the right list for your issue
&gt;&gt;
&gt;&gt; Yay. :-)
&gt;&gt;
&gt;&gt;&gt; 2. is it really blank? or something like
&gt;&gt;&gt;
&gt;&gt;&gt;    Connected to domain '[domain]'
&gt;&gt;&gt;    Escape character is ^] (Ctrl + ])
&gt;&gt;
&gt;&gt; Okay, it *does* say those things -- but that's all it says. &lt;CR&gt; gets
&gt;&gt; me nowhere, as opposed to the other KVM hosts we have running.
&gt;&gt;
&gt;&gt;&gt; 3. If I am not mistaken the guest needs to be configured in a
&gt;&gt;&gt; certain way for
&gt;&gt;&gt; virsh console [domain] to work. I can't say how though
&gt;&gt;
&gt;&gt; Hmmm... well, if anyone knows, I'm all ears.
&gt;&gt;
&gt;&gt; Thanks for the reply!
&gt;&gt;
&gt;


</body></email><email><emailId>20210523082800</emailId><senderName>Natxo Asenjo</senderName><senderEmail>natxo.asenjo@gmail.com</senderEmail><timestampReceived>2021-05-23 08:28:00-0400</timestampReceived><subject>Re: Console of P2V?</subject><body>

hi,

long time ago, but I remember you needed to modify something in upstart as
well, grub is just bootrapping the operating system, after that the system
needs to have a serial console running to connect to.

Maybe here you will find the golden tip:

https://support.hpe.com/hpesc/public/docDisplay?docId=c03595461&amp;docLocale=en_US

hth,
regards,
Natxo

On Sun, May 23, 2021 at 9:53 AM vrms &lt;vrms@netcologne.de&gt; wrote:

&gt; hi William
&gt;
&gt; On 22.05.21 23:59, William wrote:
&gt; &gt; I generally use
&gt; &gt;
&gt; &gt; GRUB_CMDLINE_LINUX_DEFAULT="console=tty0 console=ttyS0,115200n8"
&gt; &gt; and redo grub.cfg (i.e. update-grub, grub2-mkconfig)
&gt;
&gt; thanks for the pointer.
&gt;
&gt; I literally ran in the guests commandline
&gt;
&gt;     GRUB_CMDLINE_LINUX_DEFAULT="console=tty0 console=ttyS0,115200n8"
&gt;     sudo update-grub
&gt;
&gt; which did change anything to the behavior on the hosts cli
&gt;
&gt;    Connected to domain '[domain]'
&gt;    Escape character is ^] (Ctrl + ])
&gt;
&gt; and then nothing
&gt;
&gt; so ... what is the error I am making?
&gt;
&gt;
&gt;
&gt;
&gt;
&gt;
&gt; &gt; On 5/22/2021 2:49 PM, Ken D'Ambrosio wrote:
&gt; &gt;&gt;&gt; On 22.05.21 18:52, Ken D'Ambrosio wrote:
&gt; &gt;&gt;&gt; ... apologies if this isn't quite the right list, I tried to get the
&gt; &gt;&gt;&gt; right one.
&gt; &gt;&gt;&gt; But, my problem: I'm firing up a Centos 6.5 box &gt; with virt-install,
&gt; &gt;&gt;&gt; [...] and
&gt; &gt;&gt;&gt; it boots fine, etc., etc., but I can't get to the console except
&gt; &gt;&gt;&gt; through vnc;
&gt; &gt;&gt;&gt; "virsh console" just shows a blank screen.
&gt; &gt;&gt;&gt; 1. I think this is absolutely the right list for your issue
&gt; &gt;&gt;
&gt; &gt;&gt; Yay. :-)
&gt; &gt;&gt;
&gt; &gt;&gt;&gt; 2. is it really blank? or something like
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;    Connected to domain '[domain]'
&gt; &gt;&gt;&gt;    Escape character is ^] (Ctrl + ])
&gt; &gt;&gt;
&gt; &gt;&gt; Okay, it *does* say those things -- but that's all it says. &lt;CR&gt; gets
&gt; &gt;&gt; me nowhere, as opposed to the other KVM hosts we have running.
&gt; &gt;&gt;
&gt; &gt;&gt;&gt; 3. If I am not mistaken the guest needs to be configured in a
&gt; &gt;&gt;&gt; certain way for
&gt; &gt;&gt;&gt; virsh console [domain] to work. I can't say how though
&gt; &gt;&gt;
&gt; &gt;&gt; Hmmm... well, if anyone knows, I'm all ears.
&gt; &gt;&gt;
&gt; &gt;&gt; Thanks for the reply!
&gt; &gt;&gt;
&gt; &gt;
&gt;
&gt;
&gt;

-- 
--
Groeten,
natxo

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div&gt;hi,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;long time ago, but I remember you \
needed to modify something in upstart as well, grub is just bootrapping the operating \
system, after that the system needs to have a serial console running to connect \
to.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Maybe here you will find the golden \
tip:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;a \
href="https://support.hpe.com/hpesc/public/docDisplay?docId=c03595461&amp;docLocale=en \
_US"&gt;https://support.hpe.com/hpesc/public/docDisplay?docId=c03595461&amp;docLocale=en_ \
US&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;hth,&lt;/div&gt;&lt;div&gt;regards,&lt;/div&gt;&lt;div&gt;Natxo&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Sun, May 23, 2021 at 9:53 AM \
vrms &lt;&lt;a href="mailto:vrms@netcologne.de"&gt;vrms@netcologne.de&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;hi William&lt;br&gt; &lt;br&gt;
On 22.05.21 23:59, William wrote:&lt;br&gt;
&gt; I generally use&lt;br&gt;
&gt;&lt;br&gt;
&gt; GRUB_CMDLINE_LINUX_DEFAULT="console=tty0 console=ttyS0,115200n8"&lt;br&gt;
&gt; and redo grub.cfg (i.e. update-grub, grub2-mkconfig)&lt;br&gt;
&lt;br&gt;
thanks for the pointer.&lt;br&gt;
&lt;br&gt;
I literally ran in the guests commandline&lt;br&gt;
&lt;br&gt;
       GRUB_CMDLINE_LINUX_DEFAULT="console=tty0 console=ttyS0,115200n8"&lt;br&gt;
       sudo update-grub&lt;br&gt;
&lt;br&gt;
which did change anything to the behavior on the hosts cli&lt;br&gt;
&lt;br&gt;
     Connected to domain '[domain]'&lt;br&gt;
     Escape character is ^] (Ctrl + ])&lt;br&gt;
&lt;br&gt;
and then nothing&lt;br&gt;
&lt;br&gt;
so ... what is the error I am making?&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&gt; On 5/22/2021 2:49 PM, Ken D'Ambrosio wrote:&lt;br&gt;
&gt;&gt;&gt; On 22.05.21 18:52, Ken D'Ambrosio wrote:&lt;br&gt;
&gt;&gt;&gt; ... apologies if this isn't quite the right list, I tried to get \
the&lt;br&gt; &gt;&gt;&gt; right one.&lt;br&gt;
&gt;&gt;&gt; But, my problem: I'm firing up a Centos 6.5 box &gt; with \
virt-install,&lt;br&gt; &gt;&gt;&gt; [...] and&lt;br&gt;
&gt;&gt;&gt; it boots fine, etc., etc., but I can't get to the console except&lt;br&gt;
&gt;&gt;&gt; through vnc;&lt;br&gt;
&gt;&gt;&gt; "virsh console" just shows a blank screen.&lt;br&gt;
&gt;&gt;&gt; 1. I think this is absolutely the right list for your issue&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; Yay. :-)&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;&gt; 2. is it really blank? or something like&lt;br&gt;
&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt;      Connected to domain '[domain]'&lt;br&gt;
&gt;&gt;&gt;      Escape character is ^] (Ctrl + ])&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; Okay, it *does* say those things -- but that's all it says. &lt;CR&gt; \
gets&lt;br&gt; &gt;&gt; me nowhere, as opposed to the other KVM hosts we have running.&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;&gt; 3. If I am not mistaken the guest needs to be configured in a&lt;br&gt;
&gt;&gt;&gt; certain way for&lt;br&gt;
&gt;&gt;&gt; virsh console [domain] to work. I can't say how though&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; Hmmm... well, if anyone knows, I'm all ears.&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; Thanks for the reply!&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;&lt;div dir="ltr" \
class="gmail_signature"&gt;--&lt;br&gt;Groeten,&lt;br&gt;natxo&lt;/div&gt;



</body></email><email><emailId>20210524011215</emailId><senderName>W</senderName><senderEmail>wkern@pixelgate.net</senderEmail><timestampReceived>2021-05-24 01:12:15-0400</timestampReceived><subject>Re: Console of P2V?</subject><body>

well libvirt has to know about the serial port and attach it to the 
console.

do you have something like this in your XML file?


   &lt;serial type='pty'&gt;
       &lt;source path='/dev/pts/0'/&gt;
       &lt;target type='isa-serial' port='0'&gt;
         &lt;model name='isa-serial'/&gt;
       &lt;/target&gt;
       &lt;alias name='serial0'/&gt;
     &lt;/serial&gt;
     &lt;console type='pty' tty='/dev/pts/0'&gt;
       &lt;source path='/dev/pts/0'/&gt;
       &lt;target type='serial' port='0'/&gt;
       &lt;alias name='serial0'/&gt;
     &lt;/console&gt;

at that point I just type in "virsh console $DOM" in the command line

# virsh console XXXX
Connected to domain XXXX
Escape character is ^]

XXXX4 login:

I often have to hit the enter key a once or twice to get the login 
prompt once connected.



On 5/23/2021 12:52 AM, vrms wrote:

&gt; hi William
&gt;
&gt; On 22.05.21 23:59, William wrote:
&gt;&gt; I generally use
&gt;&gt;
&gt;&gt; GRUB_CMDLINE_LINUX_DEFAULT="console=tty0 console=ttyS0,115200n8"
&gt;&gt; and redo grub.cfg (i.e. update-grub, grub2-mkconfig)
&gt; thanks for the pointer.
&gt;
&gt; I literally ran in the guests commandline
&gt;
&gt;      GRUB_CMDLINE_LINUX_DEFAULT="console=tty0 console=ttyS0,115200n8"
&gt;      sudo update-grub
&gt;
&gt; which did change anything to the behavior on the hosts cli
&gt;
&gt;     Connected to domain '[domain]'
&gt;     Escape character is ^] (Ctrl + ])
&gt;
&gt; and then nothing
&gt;
&gt; so ... what is the error I am making?
&gt;
&gt;
&gt;
&gt;
&gt;
&gt;
&gt;&gt; On 5/22/2021 2:49 PM, Ken D'Ambrosio wrote:
&gt;&gt;&gt;&gt; On 22.05.21 18:52, Ken D'Ambrosio wrote:
&gt;&gt;&gt;&gt; ... apologies if this isn't quite the right list, I tried to get the
&gt;&gt;&gt;&gt; right one.
&gt;&gt;&gt;&gt; But, my problem: I'm firing up a Centos 6.5 box &gt; with virt-install,
&gt;&gt;&gt;&gt; [...] and
&gt;&gt;&gt;&gt; it boots fine, etc., etc., but I can't get to the console except
&gt;&gt;&gt;&gt; through vnc;
&gt;&gt;&gt;&gt; "virsh console" just shows a blank screen.
&gt;&gt;&gt;&gt; 1. I think this is absolutely the right list for your issue
&gt;&gt;&gt; Yay. :-)
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; 2. is it really blank? or something like
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;     Connected to domain '[domain]'
&gt;&gt;&gt;&gt;     Escape character is ^] (Ctrl + ])
&gt;&gt;&gt; Okay, it *does* say those things -- but that's all it says. &lt;CR&gt; gets
&gt;&gt;&gt; me nowhere, as opposed to the other KVM hosts we have running.
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; 3. If I am not mistaken the guest needs to be configured in a
&gt;&gt;&gt;&gt; certain way for
&gt;&gt;&gt;&gt; virsh console [domain] to work. I can't say how though
&gt;&gt;&gt; Hmmm... well, if anyone knows, I'm all ears.
&gt;&gt;&gt;
&gt;&gt;&gt; Thanks for the reply!
&gt;&gt;&gt;
&gt;

</body></email><email><emailId>20210524102229</emailId><senderName>vrms</senderName><senderEmail>vrms@netcologne.de</senderEmail><timestampReceived>2021-05-24 10:22:29-0400</timestampReceived><subject>Re: Console of P2V?</subject><body>

On 24.05.21 03:12, W wrote:
&gt; well libvirt has to know about the serial port and attach it to the
&gt; console.
&gt;
&gt; do you have something like this in your XML file?
&gt;
&gt;
&gt;    &lt;serial type='pty'&gt;
&gt;            &lt;source path='/dev/pts/0'/&gt;
&gt;            &lt;target type='isa-serial' port='0'&gt;
&gt;                &lt;model name='isa-serial'/&gt;
&gt;            &lt;/target&gt;
&gt;            &lt;alias name='serial0'/&gt;
&gt;        &lt;/serial&gt;
&gt;        &lt;console type='pty' tty='/dev/pts/0'&gt;
&gt;            &lt;source path='/dev/pts/0'/&gt;
&gt;            &lt;target type='serial' port='0'/&gt;
&gt;            &lt;alias name='serial0'/&gt;
&gt;        &lt;/console&gt;

no, I have:

       &lt;serial type='pty'&gt;
           &lt;target type='isa-serial' port='0'&gt;
               &lt;model name='isa-serial'/&gt;
           &lt;/target&gt;
       &lt;/serial&gt;
       &lt;console type='pty'&gt;
           &lt;target type='serial' port='0'/&gt;
       &lt;/console&gt;

I can edit this with *virsh edit [domain]* but the get the same results
as before.
When I look into the file thereafter, all edits are gone even though I
got a success message with the editing




&gt;
&gt;
&gt;
&gt; On 5/23/2021 12:52 AM, vrms wrote:
&gt;
&gt;&gt; hi William
&gt;&gt;
&gt;&gt; On 22.05.21 23:59, William wrote:
&gt;&gt;&gt; I generally use
&gt;&gt;&gt;
&gt;&gt;&gt; GRUB_CMDLINE_LINUX_DEFAULT="console=tty0 console=ttyS0,115200n8"
&gt;&gt;&gt; and redo grub.cfg (i.e. update-grub, grub2-mkconfig)
&gt;&gt; thanks for the pointer.
&gt;&gt;
&gt;&gt; I literally ran in the guests commandline
&gt;&gt;
&gt;&gt;          GRUB_CMDLINE_LINUX_DEFAULT="console=tty0 console=ttyS0,115200n8"
&gt;&gt;          sudo update-grub
&gt;&gt;
&gt;&gt; which did change anything to the behavior on the hosts cli
&gt;&gt;
&gt;&gt;        Connected to domain '[domain]'
&gt;&gt;        Escape character is ^] (Ctrl + ])
&gt;&gt;
&gt;&gt; and then nothing
&gt;&gt;
&gt;&gt; so ... what is the error I am making?
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;&gt; On 5/22/2021 2:49 PM, Ken D'Ambrosio wrote:
&gt;&gt;&gt;&gt;&gt; On 22.05.21 18:52, Ken D'Ambrosio wrote:
&gt;&gt;&gt;&gt;&gt; ... apologies if this isn't quite the right list, I tried to get the
&gt;&gt;&gt;&gt;&gt; right one.
&gt;&gt;&gt;&gt;&gt; But, my problem: I'm firing up a Centos 6.5 box &gt; with virt-install,
&gt;&gt;&gt;&gt;&gt; [...] and
&gt;&gt;&gt;&gt;&gt; it boots fine, etc., etc., but I can't get to the console except
&gt;&gt;&gt;&gt;&gt; through vnc;
&gt;&gt;&gt;&gt;&gt; "virsh console" just shows a blank screen.
&gt;&gt;&gt;&gt;&gt; 1. I think this is absolutely the right list for your issue
&gt;&gt;&gt;&gt; Yay. :-)
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; 2. is it really blank? or something like
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;        Connected to domain '[domain]'
&gt;&gt;&gt;&gt;&gt;        Escape character is ^] (Ctrl + ])
&gt;&gt;&gt;&gt; Okay, it *does* say those things -- but that's all it says. &lt;CR&gt; gets
&gt;&gt;&gt;&gt; me nowhere, as opposed to the other KVM hosts we have running.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; 3. If I am not mistaken the guest needs to be configured in a
&gt;&gt;&gt;&gt;&gt; certain way for
&gt;&gt;&gt;&gt;&gt; virsh console [domain] to work. I can't say how though
&gt;&gt;&gt;&gt; Hmmm... well, if anyone knows, I'm all ears.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Thanks for the reply!
&gt;&gt;&gt;&gt;
&gt;&gt;
&gt;

[Attachment #3 (text/html)]

&lt;html&gt;
  &lt;head&gt;
    &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;div class="moz-cite-prefix"&gt;On 24.05.21 03:12, W wrote:&lt;br&gt;
    &lt;/div&gt;
    &lt;blockquote type="cite"
      cite="mid:f6e0a7a6-679d-da5a-be50-ddc3df2cc2bb@pixelgate.net"&gt;well
      libvirt has to know about the serial port and attach it to the
      console.
      &lt;br&gt;
      &lt;br&gt;
      do you have something like this in your XML file?
      &lt;br&gt;
      &lt;br&gt;
      &lt;br&gt;
         &lt;font color="#a01414"&gt;&lt;serial type='pty'&gt;
        &lt;br&gt;
                   &lt;source path='/dev/pts/0'/&gt;
        &lt;br&gt;
                   &lt;target type='isa-serial' port='0'&gt;
        &lt;br&gt;
                       &lt;model name='isa-serial'/&gt;
        &lt;br&gt;
                   &lt;/target&gt;
        &lt;br&gt;
                   &lt;alias name='serial0'/&gt;
        &lt;br&gt;
               &lt;/serial&gt;
      &lt;/font&gt;&lt;br&gt;
             &lt;console type='pty' tty='/dev/pts/0'&gt;
      &lt;br&gt;
                 &lt;source path='/dev/pts/0'/&gt;
      &lt;br&gt;
                 &lt;target type='serial' port='0'/&gt;
      &lt;br&gt;
                 &lt;alias name='serial0'/&gt;
      &lt;br&gt;
             &lt;/console&gt;
      &lt;br&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
    no, I have:&lt;br&gt;
    &lt;br&gt;
           &lt;serial type='pty'&gt;&lt;br&gt;
               &lt;target type='isa-serial' port='0'&gt;&lt;br&gt;
                   &lt;model name='isa-serial'/&gt;&lt;br&gt;
               &lt;/target&gt;&lt;br&gt;
           &lt;/serial&gt;&lt;br&gt;
           &lt;console type='pty'&gt;&lt;br&gt;
               &lt;target type='serial' port='0'/&gt;&lt;br&gt;
           &lt;/console&gt;&lt;br&gt;
    &lt;br&gt;
    I can edit this with &lt;b&gt;virsh edit [domain]&lt;/b&gt; but the get the
    same results as before. &lt;br&gt;
    When I look into the file thereafter, all edits are gone even though
    I got a success message with the editing &lt;br&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;blockquote type="cite"
      cite="mid:f6e0a7a6-679d-da5a-be50-ddc3df2cc2bb@pixelgate.net"&gt;
      &lt;br&gt;
      &lt;br&gt;
      &lt;br&gt;
      On 5/23/2021 12:52 AM, vrms wrote:
      &lt;br&gt;
      &lt;br&gt;
      &lt;blockquote type="cite"&gt;hi William
        &lt;br&gt;
        &lt;br&gt;
        On 22.05.21 23:59, William wrote:
        &lt;br&gt;
        &lt;blockquote type="cite"&gt;I generally use
          &lt;br&gt;
          &lt;br&gt;
          GRUB_CMDLINE_LINUX_DEFAULT="console=tty0
          console=ttyS0,115200n8"
          &lt;br&gt;
          and redo grub.cfg (i.e. update-grub, grub2-mkconfig)
          &lt;br&gt;
        &lt;/blockquote&gt;
        thanks for the pointer.
        &lt;br&gt;
        &lt;br&gt;
        I literally ran in the guests commandline
        &lt;br&gt;
        &lt;br&gt;
                 GRUB_CMDLINE_LINUX_DEFAULT="console=tty0
        console=ttyS0,115200n8"
        &lt;br&gt;
                 sudo update-grub
        &lt;br&gt;
        &lt;br&gt;
        which did change anything to the behavior on the hosts cli
        &lt;br&gt;
        &lt;br&gt;
               Connected to domain '[domain]'
        &lt;br&gt;
               Escape character is ^] (Ctrl + ])
        &lt;br&gt;
        &lt;br&gt;
        and then nothing
        &lt;br&gt;
        &lt;br&gt;
        so ... what is the error I am making?
        &lt;br&gt;
        &lt;br&gt;
        &lt;br&gt;
        &lt;br&gt;
        &lt;br&gt;
        &lt;br&gt;
        &lt;br&gt;
        &lt;blockquote type="cite"&gt;On 5/22/2021 2:49 PM, Ken D'Ambrosio
          wrote:
          &lt;br&gt;
          &lt;blockquote type="cite"&gt;
            &lt;blockquote type="cite"&gt;On 22.05.21 18:52, Ken D'Ambrosio
              wrote:
              &lt;br&gt;
              ... apologies if this isn't quite the right list, I tried
              to get the
              &lt;br&gt;
              right one.
              &lt;br&gt;
              But, my problem: I'm firing up a Centos 6.5 box &gt; with
              virt-install,
              &lt;br&gt;
              [...] and
              &lt;br&gt;
              it boots fine, etc., etc., but I can't get to the console
              except
              &lt;br&gt;
              through vnc;
              &lt;br&gt;
              "virsh console" just shows a blank screen.
              &lt;br&gt;
              1. I think this is absolutely the right list for your
              issue
              &lt;br&gt;
            &lt;/blockquote&gt;
            Yay. :-)
            &lt;br&gt;
            &lt;br&gt;
            &lt;blockquote type="cite"&gt;2. is it really blank? or something
              like
              &lt;br&gt;
              &lt;br&gt;
                     Connected to domain '[domain]'
              &lt;br&gt;
                     Escape character is ^] (Ctrl + ])
              &lt;br&gt;
            &lt;/blockquote&gt;
            Okay, it *does* say those things -- but that's all it says.
            &lt;CR&gt; gets
            &lt;br&gt;
            me nowhere, as opposed to the other KVM hosts we have
            running.
            &lt;br&gt;
            &lt;br&gt;
            &lt;blockquote type="cite"&gt;3. If I am not mistaken the guest
              needs to be configured in a
              &lt;br&gt;
              certain way for
              &lt;br&gt;
              virsh console [domain] to work. I can't say how though
              &lt;br&gt;
            &lt;/blockquote&gt;
            Hmmm... well, if anyone knows, I'm all ears.
            &lt;br&gt;
            &lt;br&gt;
            Thanks for the reply!
            &lt;br&gt;
            &lt;br&gt;
          &lt;/blockquote&gt;
        &lt;/blockquote&gt;
        &lt;br&gt;
      &lt;/blockquote&gt;
      &lt;br&gt;
    &lt;/blockquote&gt;
  &lt;/body&gt;
&lt;/html&gt;


</body></email><email><emailId>20210407192427</emailId><senderName>Jim Fehlig</senderName><senderEmail>jfehlig@suse.com</senderEmail><timestampReceived>2021-04-07 19:24:27-0400</timestampReceived><subject>Re: Xen: libvirt.libvirtError: An error occurred, but the cause is unknown</subject><body>

On 4/7/21 3:25 AM, Mathieu Tarral wrote:
&gt; I enabled the log output in libvirt daemon, and there was one error message that \
&gt; appeared: 
&gt; error : libxlMakeDomBuildInfo:553 : unsupported configuration: emulator \
&gt; '/usr/lib/xen-4.11/bin/qemu-system-i386' not found

libxlMakeDomBuildInfo reports the error via virReportError

https://gitlab.com/libvirt/libvirt/-/blob/master/src/libxl/libxl_conf.c#L592

&gt; When searching the path with apt-file, there are no packages providing this file.
&gt; 
&gt; I have qemu-system-x86-xen however:
&gt; https://ubuntu.pkgs.org/20.04/ubuntu-universe-amd64/qemu-system-x86-xen_4.2-3ubuntu6_amd64.deb.html
&gt;  
&gt; which provides /usr/bin/qemu-system-i386
&gt; 
&gt; Creating a symlink solved my issue:
&gt; cd /usr/lib/xen-4.11/bin
&gt; sudo ln -s /usr/bin/qemu-system-i386 .
&gt; 
&gt; -&gt; This seems to be an opened bug report on the libvirt Debian package (since 2016 \
&gt; !) https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=830307
&gt; 
&gt; -&gt; Is there a way for libvirt to actually report meaningful errors in this case ?

A meaningful error is reported, it's just not making it back to the client. And 
I don't spot anywhere along the failure path of libxlDomainCreateWithFlags -&gt; 
libxlDomainStartNew -&gt; libxlDomainStart -&gt; libxlMakeDomBuildInfo where that 
helpful error would be unset/overwritten.

Regards,
Jim


</body></email><email><emailId>20210408053113</emailId><senderName>shafnamol N</senderName><senderEmail>shafnamol29@gmail.com</senderEmail><timestampReceived>2021-04-08 05:31:13-0400</timestampReceived><subject>Re: Regarding location of Libvirt library</subject><body>

Hi,

&gt;&gt;libvirtd.service_backup should not be there, but I don't think that's
&gt;&gt;what causing your problem. I would still recommend deleting it just
&gt;&gt;in case.

I have deleted that file.But still the problem exists...

&gt;&gt;Hopefully someone else on the list will be able to help you!

Anyway thanks for the time...
Hoping help from other members on this list
.....

On Wed, Apr 7, 2021 at 1:58 PM Andrea Bolognani &lt;abologna@redhat.com&gt; wrote:

&gt; [once again, please keep replies on-list]
&gt;
&gt; On Wed, 2021-04-07 at 10:46 +0530, shafnamol N wrote:
&gt; &gt; &gt; What does running
&gt; &gt; &gt;
&gt; &gt; &gt;   $ ls /usr/lib/systemd/system/*virt*
&gt; &gt; &gt;
&gt; &gt; &gt; output?
&gt; &gt;
&gt; &gt; The output is as shown below:
&gt; &gt;
&gt; &gt; # ls /usr/lib/systemd/system/*virt*
&gt; &gt; /usr/lib/systemd/system/libvirtd-admin.socket
&gt; /usr/lib/systemd/system/virtnodedevd.service
&gt; &gt; /usr/lib/systemd/system/libvirtd-ro.socket
&gt;  /usr/lib/systemd/system/virtnodedevd.socket
&gt; &gt; /usr/lib/systemd/system/libvirtd.service
&gt;  /usr/lib/systemd/system/virtnwfilterd-admin.socket
&gt; &gt; /usr/lib/systemd/system/libvirtd.service_backup
&gt; /usr/lib/systemd/system/virtnwfilterd-ro.socket
&gt; &gt; /usr/lib/systemd/system/libvirtd.socket
&gt; /usr/lib/systemd/system/virtnwfilterd.service
&gt; &gt; /usr/lib/systemd/system/libvirtd-tcp.socket
&gt; /usr/lib/systemd/system/virtnwfilterd.socket
&gt; &gt; /usr/lib/systemd/system/libvirtd-tls.socket
&gt; /usr/lib/systemd/system/virtproxyd-admin.socket
&gt; &gt; /usr/lib/systemd/system/libvirt-guests.service
&gt;  /usr/lib/systemd/system/virtproxyd-ro.socket
&gt; &gt; /usr/lib/systemd/system/virt-guest-shutdown.target
&gt;  /usr/lib/systemd/system/virtproxyd.service
&gt; &gt; /usr/lib/systemd/system/virtinterfaced-admin.socket
&gt; /usr/lib/systemd/system/virtproxyd.socket
&gt; &gt; /usr/lib/systemd/system/virtinterfaced-ro.socket
&gt;  /usr/lib/systemd/system/virtproxyd-tcp.socket
&gt; &gt; /usr/lib/systemd/system/virtinterfaced.service
&gt;  /usr/lib/systemd/system/virtproxyd-tls.socket
&gt; &gt; /usr/lib/systemd/system/virtinterfaced.socket
&gt; /usr/lib/systemd/system/virtqemud-admin.socket
&gt; &gt; /usr/lib/systemd/system/virtlockd-admin.socket
&gt;  /usr/lib/systemd/system/virtqemud-ro.socket
&gt; &gt; /usr/lib/systemd/system/virtlockd.service
&gt; /usr/lib/systemd/system/virtqemud.service
&gt; &gt; /usr/lib/systemd/system/virtlockd.socket
&gt;  /usr/lib/systemd/system/virtqemud.socket
&gt; &gt; /usr/lib/systemd/system/virtlogd-admin.socket
&gt; /usr/lib/systemd/system/virtsecretd-admin.socket
&gt; &gt; /usr/lib/systemd/system/virtlogd.service
&gt;  /usr/lib/systemd/system/virtsecretd-ro.socket
&gt; &gt; /usr/lib/systemd/system/virtlogd.socket
&gt; /usr/lib/systemd/system/virtsecretd.service
&gt; &gt; /usr/lib/systemd/system/virtlxcd-admin.socket
&gt; /usr/lib/systemd/system/virtsecretd.socket
&gt; &gt; /usr/lib/systemd/system/virtlxcd-ro.socket
&gt;  /usr/lib/systemd/system/virtstoraged-admin.socket
&gt; &gt; /usr/lib/systemd/system/virtlxcd.service
&gt;  /usr/lib/systemd/system/virtstoraged-ro.socket
&gt; &gt; /usr/lib/systemd/system/virtlxcd.socket
&gt; /usr/lib/systemd/system/virtstoraged.service
&gt; &gt; /usr/lib/systemd/system/virtnetworkd-admin.socket
&gt; /usr/lib/systemd/system/virtstoraged.socket
&gt; &gt; /usr/lib/systemd/system/virtnetworkd-ro.socket
&gt;  /usr/lib/systemd/system/virtvboxd-admin.socket
&gt; &gt; /usr/lib/systemd/system/virtnetworkd.service
&gt;  /usr/lib/systemd/system/virtvboxd-ro.socket
&gt; &gt; /usr/lib/systemd/system/virtnetworkd.socket
&gt; /usr/lib/systemd/system/virtvboxd.service
&gt; &gt; /usr/lib/systemd/system/virtnodedevd-admin.socket
&gt; /usr/lib/systemd/system/virtvboxd.socket
&gt; &gt; /usr/lib/systemd/system/virtnodedevd-ro.socket
&gt;
&gt; libvirtd.service_backup should not be there, but I don't think that's
&gt; what causing your problem. I would still recommend deleting it just
&gt; in case.
&gt;
&gt; &gt; &gt; What OS are you using?
&gt; &gt;
&gt; &gt; Centos 8
&gt; &gt;
&gt; &gt; &gt; What does the
&gt; &gt; &gt;
&gt; &gt; &gt;     Miscellaneous
&gt; &gt; &gt;             ...
&gt; &gt; &gt;             Init script: XXX
&gt; &gt; &gt;
&gt; &gt; &gt; entry look like in the summary that's displayed when you run Meson?
&gt; &gt;
&gt; &gt; Miscellaneous
&gt; &gt;     Init script        : systemd
&gt;
&gt; These all look good, so I really have no idea what's going on.
&gt; Hopefully someone else on the list will be able to help you!
&gt; Good luck :)
&gt;
&gt; --
&gt; Andrea Bolognani / Red Hat / Virtualization
&gt;
&gt;

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div&gt;Hi,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="color:rgb(153,0,255)"&gt;&gt;&gt;libvirtd.service_backup should not be there, but \
I don't think that's&lt;br&gt; &gt;&gt;what causing your problem. I would still \
recommend deleting it just&lt;br&gt; &gt;&gt;in case.&lt;/span&gt;&lt;span \
class="gmail-im"&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
class="gmail-im"&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span class="gmail-im"&gt;I have deleted that \
file.But still the problem exists...&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
class="gmail-im"&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style="color:rgb(153,0,255)"&gt;&lt;span \
class="gmail-im"&gt;&gt;&gt;Hopefully someone else on the list will be able to help \
you!&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style="color:rgb(153,0,255)"&gt;&lt;span \
class="gmail-im"&gt;&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="color:rgb(153,0,255)"&gt;&lt;span class="gmail-im"&gt;&lt;font color="#000000"&gt;Anyway \
thanks for the time...&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="color:rgb(153,0,255)"&gt;&lt;span class="gmail-im"&gt;&lt;font color="#000000"&gt;Hoping help \
from other members on this list&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="color:rgb(153,0,255)"&gt;&lt;span class="gmail-im"&gt;&lt;font \
color="#000000"&gt;.....&lt;/font&gt;&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Wed, Apr 7, 2021 at 1:58 PM \
Andrea Bolognani &lt;&lt;a href="mailto:abologna@redhat.com"&gt;abologna@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;[once again, please \
keep replies on-list]&lt;br&gt; &lt;br&gt;
On Wed, 2021-04-07 at 10:46 +0530, shafnamol N wrote:&lt;br&gt;
&gt; &gt; What does running&lt;br&gt;
&gt; &gt; &lt;br&gt;
&gt; &gt;     $ ls /usr/lib/systemd/system/*virt*&lt;br&gt;
&gt; &gt; &lt;br&gt;
&gt; &gt; output?&lt;br&gt;
&gt; &lt;br&gt;
&gt; The output is as shown below:&lt;br&gt;
&gt; &lt;br&gt;
&gt; # ls /usr/lib/systemd/system/*virt*&lt;br&gt;
&gt; /usr/lib/systemd/system/libvirtd-admin.socket            \
/usr/lib/systemd/system/virtnodedevd.service&lt;br&gt; &gt; \
/usr/lib/systemd/system/libvirtd-ro.socket                 \
/usr/lib/systemd/system/virtnodedevd.socket&lt;br&gt; &gt; \
/usr/lib/systemd/system/libvirtd.service                    \
/usr/lib/systemd/system/virtnwfilterd-admin.socket&lt;br&gt; &gt; \
/usr/lib/systemd/system/libvirtd.service_backup         \
/usr/lib/systemd/system/virtnwfilterd-ro.socket&lt;br&gt; &gt; \
/usr/lib/systemd/system/libvirtd.socket                     \
/usr/lib/systemd/system/virtnwfilterd.service&lt;br&gt; &gt; \
/usr/lib/systemd/system/libvirtd-tcp.socket               \
/usr/lib/systemd/system/virtnwfilterd.socket&lt;br&gt; &gt; \
/usr/lib/systemd/system/libvirtd-tls.socket               \
/usr/lib/systemd/system/virtproxyd-admin.socket&lt;br&gt; &gt; \
/usr/lib/systemd/system/libvirt-guests.service           \
/usr/lib/systemd/system/virtproxyd-ro.socket&lt;br&gt; &gt; \
/usr/lib/systemd/system/virt-guest-shutdown.target     \
/usr/lib/systemd/system/virtproxyd.service&lt;br&gt; &gt; \
/usr/lib/systemd/system/virtinterfaced-admin.socket   \
/usr/lib/systemd/system/virtproxyd.socket&lt;br&gt; &gt; \
/usr/lib/systemd/system/virtinterfaced-ro.socket        \
/usr/lib/systemd/system/virtproxyd-tcp.socket&lt;br&gt; &gt; \
/usr/lib/systemd/system/virtinterfaced.service           \
/usr/lib/systemd/system/virtproxyd-tls.socket&lt;br&gt; &gt; \
/usr/lib/systemd/system/virtinterfaced.socket            \
/usr/lib/systemd/system/virtqemud-admin.socket&lt;br&gt; &gt; \
/usr/lib/systemd/system/virtlockd-admin.socket           \
/usr/lib/systemd/system/virtqemud-ro.socket&lt;br&gt; &gt; \
/usr/lib/systemd/system/virtlockd.service                  \
/usr/lib/systemd/system/virtqemud.service&lt;br&gt; &gt; \
/usr/lib/systemd/system/virtlockd.socket                    \
/usr/lib/systemd/system/virtqemud.socket&lt;br&gt; &gt; \
/usr/lib/systemd/system/virtlogd-admin.socket            \
/usr/lib/systemd/system/virtsecretd-admin.socket&lt;br&gt; &gt; \
/usr/lib/systemd/system/virtlogd.service                    \
/usr/lib/systemd/system/virtsecretd-ro.socket&lt;br&gt; &gt; \
/usr/lib/systemd/system/virtlogd.socket                     \
/usr/lib/systemd/system/virtsecretd.service&lt;br&gt; &gt; \
/usr/lib/systemd/system/virtlxcd-admin.socket            \
/usr/lib/systemd/system/virtsecretd.socket&lt;br&gt; &gt; \
/usr/lib/systemd/system/virtlxcd-ro.socket                 \
/usr/lib/systemd/system/virtstoraged-admin.socket&lt;br&gt; &gt; \
/usr/lib/systemd/system/virtlxcd.service                    \
/usr/lib/systemd/system/virtstoraged-ro.socket&lt;br&gt; &gt; \
/usr/lib/systemd/system/virtlxcd.socket                     \
/usr/lib/systemd/system/virtstoraged.service&lt;br&gt; &gt; \
/usr/lib/systemd/system/virtnetworkd-admin.socket      \
/usr/lib/systemd/system/virtstoraged.socket&lt;br&gt; &gt; \
/usr/lib/systemd/system/virtnetworkd-ro.socket           \
/usr/lib/systemd/system/virtvboxd-admin.socket&lt;br&gt; &gt; \
/usr/lib/systemd/system/virtnetworkd.service              \
/usr/lib/systemd/system/virtvboxd-ro.socket&lt;br&gt; &gt; \
/usr/lib/systemd/system/virtnetworkd.socket               \
/usr/lib/systemd/system/virtvboxd.service&lt;br&gt; &gt; \
/usr/lib/systemd/system/virtnodedevd-admin.socket      \
/usr/lib/systemd/system/virtvboxd.socket&lt;br&gt; &gt; \
/usr/lib/systemd/system/virtnodedevd-ro.socket&lt;br&gt; &lt;br&gt;
libvirtd.service_backup should not be there, but I don't think that's&lt;br&gt;
what causing your problem. I would still recommend deleting it just&lt;br&gt;
in case.&lt;br&gt;
&lt;br&gt;
&gt; &gt; What OS are you using?&lt;br&gt;
&gt; &lt;br&gt;
&gt; Centos 8&lt;br&gt;
&gt; &lt;br&gt;
&gt; &gt; What does the&lt;br&gt;
&gt; &gt; &lt;br&gt;
&gt; &gt;        Miscellaneous&lt;br&gt;
&gt; &gt;                    ...&lt;br&gt;
&gt; &gt;                    Init script: XXX&lt;br&gt;
&gt; &gt; &lt;br&gt;
&gt; &gt; entry look like in the summary that's displayed when you run Meson?&lt;br&gt;
&gt; &lt;br&gt;
&gt; Miscellaneous&lt;br&gt;
&gt;        Init script            : systemd&lt;br&gt;
&lt;br&gt;
These all look good, so I really have no idea what's going on.&lt;br&gt;
Hopefully someone else on the list will be able to help you!&lt;br&gt;
Good luck :)&lt;br&gt;
&lt;br&gt;
-- &lt;br&gt;
Andrea Bolognani / Red Hat / Virtualization&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;



</body></email><email><emailId>20210408090653</emailId><senderName>Skyler_Mäntysaari</senderName><senderEmail>sm+lists@samip.fi</senderEmail><timestampReceived>2021-04-08 09:06:53-0400</timestampReceived><subject>XML for working mips64el guest</subject><body>

Hi there,

How do I get a working xml for mips64el guest when using virt-manager?

The host system is running Ubuntu, but I believe that this is the right 
list for things relating to libvirt.

It errors with:
---------------------------------------------
Unable to complete install: 'this function is not supported by the 
connection driver: 'mips64el' architecture is not supported by CPU driver'

Traceback (most recent call last):
   File "/usr/share/virt-manager/virtManager/asyncjob.py", line 75, in 
cb_wrapper
     callback(asyncjob, *args, **kwargs)
   File "/usr/share/virt-manager/virtManager/createvm.py", line 2089, in 
_do_async_install
     guest.installer_instance.start_install(guest, meter=meter)
   File "/usr/share/virt-manager/virtinst/install/installer.py", line 
542, in start_install
     domain = self._create_guest(
   File "/usr/share/virt-manager/virtinst/install/installer.py", line 
491, in _create_guest
     domain = self.conn.createXML(install_xml or final_xml, 0)
   File "/usr/lib/python3/dist-packages/libvirt.py", line 4034, in createXML
     if ret is None:raise libvirtError('virDomainCreateXML() failed', 
conn=self)
libvirt.libvirtError: this function is not supported by the connection 
driver: 'mips64el' architecture is not supported by CPU driver
---------------------------------------------

This is what I'm trying to use:
---------------------------------------------
&lt;domain type="qemu"&gt;
   &lt;name&gt;debian9-mips64el&lt;/name&gt;
   &lt;metadata&gt;
     &lt;libosinfo:libosinfo 
xmlns:libosinfo="http://libosinfo.org/xmlns/libvirt/domain/1.0"&gt;
       &lt;libosinfo:os id="http://debian.org/debian/9"/&gt;
     &lt;/libosinfo:libosinfo&gt;
   &lt;/metadata&gt;
   &lt;memory&gt;1048576&lt;/memory&gt;
   &lt;currentMemory&gt;1048576&lt;/currentMemory&gt;
   &lt;vcpu&gt;2&lt;/vcpu&gt;
   &lt;os&gt;
     &lt;type arch="mips64el" machine="malta"&gt;hvm&lt;/type&gt;
     &lt;cmdline&gt;nokaslr root=/dev/sda1 console=ttyS0&lt;/cmdline&gt;
     &lt;boot dev="hd"/&gt;
   &lt;/os&gt;
   &lt;clock offset="utc"/&gt;
   &lt;devices&gt;
     &lt;emulator&gt;/usr/bin/qemu-system-mips64el&lt;/emulator&gt;
     &lt;controller type="pci" index="0" model="pci-root"/&gt;
     &lt;disk type="file" device="disk"&gt;
       &lt;driver name="qemu" type="qcow2"/&gt;
       &lt;source file="/var/lib/libvirt/images/mip64el/stretch/disk.qcow2"/&gt;
       &lt;target dev="hda" bus="ide"/&gt;
     &lt;/disk&gt;
     &lt;interface type="network"&gt;
       &lt;source network="default"/&gt;
       &lt;mac address="52:54:00:c5:63:f5"/&gt;
     &lt;/interface&gt;
     &lt;console type="pty"/&gt;
   &lt;/devices&gt;
&lt;/domain&gt;
---------------------------------------------------------------------------------------------------------------



</body></email><email><emailId>20210409085056</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-04-09 08:50:56-0400</timestampReceived><subject>Re: Creating Virtual machine with .OVF format</subject><body>

On Thu, Apr 08, 2021 at 05:51:54PM -0400, Ajay Kumar wrote:
&gt; Hello members,
&gt; 
&gt; I would like to create virtual machine images with some pre-installed
&gt; software in a .*OVF/OVA* format. So that I can use these* OVF *images/templates
&gt; for any hypervisor to create a VM.

Big caveat: OVF/OVA only really ensures a portable packaging / description
format, and does /not/ actually provide hypervisor execution portability.

ie any hypervisor can have tools to consume an OVF/OVA, but that doesn't
mean the disk image inside can actually be run on any hypervisor.

Each hypervisor has its own set of virtual hardware that it emulates, and
there is little overlap between the different options (VMware, Hyperv, KVM).

eg if a disk image is built to use virtio-blk for its storage, then you can
run that on KVM, but not on VMware/HyperV. Likewise if you pick the HyperV
paravirtualized storage driver, then you're unlikely to have to easily run
on VMware/KVM.

If you work hard you might be able to create disk images that really
are portable across hypervisors by ensuring the OS can automagically
detect the drivers based on hardware it sees, but this is really
unrelated to any use of OVF/OVA.

Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20210410053202</emailId><senderName>Tom Ammon</senderName><senderEmail>thomasammon@gmail.com</senderEmail><timestampReceived>2021-04-10 05:32:02-0400</timestampReceived><subject>Re: submitting a patch to fix documentation errors</subject><body>

On Fri, Apr 9, 2021 at 3:26 AM Daniel P. Berrangé &lt;berrange@redhat.com&gt;
wrote:

&gt; On Fri, Apr 09, 2021 at 12:16:36AM -0500, Tom Ammon wrote:
&gt; &gt; Hello,
&gt; &gt;
&gt; &gt; While using the libvirt application development guide for python (
&gt; &gt;
&gt; https://libvirt.org/docs/libvirt-appdev-guide-python/en-US/html/index.html
&gt; )
&gt; &gt; I found a couple of errors in the example code that I'd like to fix. I've
&gt; &gt; created a branch and committed the fixes locally, and I'm ready to push
&gt; &gt; them. I plan to use git send-email to submit the patch. Which list
&gt; should I
&gt; &gt; use in the --to= ? Should it be libvirt-users@redhat.com?
&gt; &gt;
&gt; &gt; This is my first contribution to this project. I've read the best
&gt; practices
&gt; &gt; and contributing guidelines on libvirt.org, but if I make mistakes in
&gt; the
&gt; &gt; workflow I'd appreciate your help to correct them.
&gt;
&gt; For everything except the main libvirt.git repo, we have switched to
&gt; using gitlab merge requests, so you don't need to worry about using
&gt; email to send changes
&gt;
&gt; Create your own fork of:
&gt;
&gt;   https://gitlab.com/libvirt/libvirt-appdev-guide-python/
&gt;
&gt; push your local branch to your gitlab fork, and then open a merge
&gt; request to submit the fixes.
&gt;
&gt; Regards,
&gt; Daniel
&gt; --
&gt; |: https://berrange.com      -o-
&gt; https://www.flickr.com/photos/dberrange :|
&gt; |: https://libvirt.org         -o-
&gt; https://fstop138.berrange.com :|
&gt; |: https://entangle-photo.org    -o-
&gt; https://www.instagram.com/dberrange :|
&gt;
&gt;
Thank you. I submitted my merge request,
https://gitlab.com/libvirt/libvirt-appdev-guide-python/-/merge_requests/8

Tom



-- 
-----------------------------------------------------------------------------
Tom Ammon
M: (737) 400-9042
thomasammon@gmail.com
-----------------------------------------------------------------------------

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" \
class="gmail_attr"&gt;On Fri, Apr 9, 2021 at 3:26 AM Daniel P. Berrangé &lt;&lt;a \
href="mailto:berrange@redhat.com"&gt;berrange@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;On Fri, Apr 09, 2021 \
at 12:16:36AM -0500, Tom Ammon wrote:&lt;br&gt; &gt; Hello,&lt;br&gt;
&gt; &lt;br&gt;
&gt; While using the libvirt application development guide for python (&lt;br&gt;
&gt; &lt;a href="https://libvirt.org/docs/libvirt-appdev-guide-python/en-US/html/index.html" \
rel="noreferrer" target="_blank"&gt;https://libvirt.org/docs/libvirt-appdev-guide-python/en-US/html/index.html&lt;/a&gt;)&lt;br&gt;
 &gt; I found a couple of errors in the example code that I'd like to fix. \
I've&lt;br&gt; &gt; created a branch and committed the fixes locally, and I'm ready \
to push&lt;br&gt; &gt; them. I plan to use git send-email to submit the patch. Which list \
should I&lt;br&gt; &gt; use in the --to= ? Should it be &lt;a \
href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;?&lt;br&gt; &gt; &lt;br&gt;
&gt; This is my first contribution to this project. I've read the best \
practices&lt;br&gt; &gt; and contributing guidelines on &lt;a href="http://libvirt.org" \
rel="noreferrer" target="_blank"&gt;libvirt.org&lt;/a&gt;, but if I make mistakes in the&lt;br&gt; \
&gt; workflow I'd appreciate your help to correct them.&lt;br&gt; &lt;br&gt;
For everything except the main libvirt.git repo, we have switched to&lt;br&gt;
using gitlab merge requests, so you don't need to worry about using&lt;br&gt;
email to send changes&lt;br&gt;
&lt;br&gt;
Create your own fork of:&lt;br&gt;
&lt;br&gt;
   &lt;a href="https://gitlab.com/libvirt/libvirt-appdev-guide-python/" rel="noreferrer" \
target="_blank"&gt;https://gitlab.com/libvirt/libvirt-appdev-guide-python/&lt;/a&gt;&lt;br&gt; &lt;br&gt;
push your local branch to your gitlab fork, and then open a merge&lt;br&gt;
request to submit the fixes.&lt;br&gt;
&lt;br&gt;
Regards,&lt;br&gt;
Daniel&lt;br&gt;
-- &lt;br&gt;
&gt; &gt; &lt;a href="https://berrange.com" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://berrange.com&lt;/a&gt;         -o-      &lt;a \
&gt; &gt; href="https://www.flickr.com/photos/dberrange" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://www.flickr.com/photos/dberrange&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="https://libvirt.org" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://libvirt.org&lt;/a&gt;              -o-                  &lt;a \
&gt; &gt; href="https://fstop138.berrange.com" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://fstop138.berrange.com&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="https://entangle-photo.org" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://entangle-photo.org&lt;/a&gt;      -o-      &lt;a \
&gt; &gt; href="https://www.instagram.com/dberrange" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://www.instagram.com/dberrange&lt;/a&gt; :|&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thank you. I submitted my merge request,  &lt;a \
href="https://gitlab.com/libvirt/libvirt-appdev-guide-python/-/merge_requests/8"&gt;https \
://gitlab.com/libvirt/libvirt-appdev-guide-python/-/merge_requests/8&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Tom&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;br \
clear="all"&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- &lt;br&gt;&lt;div dir="ltr" class="gmail_signature"&gt;&lt;div \
dir="ltr"&gt;&lt;div&gt;&lt;div dir="ltr"&gt;-----------------------------------------------------------------------------&lt;br&gt;Tom \
Ammon&lt;br&gt;M: (737) 400-9042&lt;br&gt;&lt;a href="mailto:thomasammon@gmail.com" \
target="_blank"&gt;thomasammon@gmail.com&lt;/a&gt;&lt;br&gt;-----------------------------------------------------------------------------&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;




</body></email><email><emailId>20210412062815</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-04-12 06:28:15-0400</timestampReceived><subject>Re: libvirt 7.2.0 domainbackup</subject><body>

On Thu, Apr 08, 2021 at 15:53:14 +0200, Thomas Stein wrote:
&gt; Cool! So just to be clear, if I start the backup at 1400 and it's finished at 1410, \
&gt; changes to the image at 1405 are not included?

Yes, exactly.

&gt; It's the same quality as my current backup solution then. Thank you for your answer \
&gt; Peter.

If you do full backups (create just 1 overlay, copy over the full
original image, merge the 1 overlay back) then yes. If you were doing an
"incremental" backup (2 overlays when backing up, 1 overlay in normal
use) then that is not yet supported. The code for incremental backups
via 'virsh backup-begin' exists in libvirt but qemu doesn't yet support
the 'blockdev-reopen' command which is used by the incremental backup
code.

&gt; 
&gt; cheers, t.
&gt; 
&gt; Am 8. April 2021 15:46:56 MESZ schrieb Peter Krempa &lt;pkrempa@redhat.com&gt;:
&gt; &gt; On Wed, Apr 07, 2021 at 19:46:54 +0200, Thomas Stein wrote:
&gt; &gt; &gt; 
&gt; &gt; &gt; Got a little bit further. "virsh backup-begin jitsi jitsi-backup.xml"
&gt; &gt; works
&gt; &gt; &gt; and I have a backup file now. VM was running all the time. Question.
&gt; &gt; Is it
&gt; &gt; &gt; save to use this function this way? Currently I do:
&gt; &gt; 
&gt; &gt; The backup file you'll get will represent the state of the VM at the
&gt; &gt; time the backup operation has started, but should contain a full copy
&gt; &gt; of
&gt; &gt; the image from that time.
&gt; 
&gt; 


</body></email><email><emailId>20210412063254</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-04-12 06:32:54-0400</timestampReceived><subject>Re: live migrate storage to different volume on the same host</subject><body>

On Sat, Apr 10, 2021 at 01:05:31 +0800, Jing-Wei Su wrote:
&gt; Hello experts,
&gt; 
&gt; I would like to move the qcow2 disk images of a running VM to a
&gt; different storage because of the maintenance of the underlying storage
&gt; on the same host.

You can use the 'virDomainBlockCopy' API to achieve this.

To use it via virsh, the simplest way would be to:

virsh blockcopy $VMNAME $DISKTARGET --dest /path/to/destination
--transient-job --pivot (--verbose)

($DISKTARGET is 'vda' for example)

In case you need a more complicated description of the target of the
copy such as a network storage target you can also use the --xml option
to use a XML description of the target.

&gt; I found the live migration is not allowable on the same host using
&gt; virsh. Is there any suggestion or better practices for this?

Full migration would also try to move the qemu process which is not
required in your case.

</body></email><email><emailId>20210412064759</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-04-12 06:47:59-0400</timestampReceived><subject>Re: how to use external snapshots with memory state</subject><body>

On Fri, Apr 09, 2021 at 19:00:41 +0200, Riccardo Ravaioli wrote:
&gt; Hi all,
&gt; 
&gt; Can I get some feedback on these two questions I posted a while back,
&gt; concerning external snapshots:
&gt; 
&gt;  On Tue, 26 Jan 2021 at 00:15, Riccardo Ravaioli &lt;riccardoravaioli@gmail.com&gt;
&gt; wrote:
&gt; [...]
&gt; 
&gt; &gt; 1) When creating an external online snapshot (disks+memory) of a qemu-KVM
&gt; &gt; VM, I'd like to store the backing files in a separate folder and rename the
&gt; &gt; newly-created delta files with the respective names of the original disks
&gt; &gt; (now the backing files). Is this possible at all? Say a VM has a disk
&gt; &gt; vm/disk1.qcow2 and I take an external snapshot, I'd like the backing file
&gt; &gt; to appear in snap/disk1.qcow2 and the new delta disk to appear as

No, this is not possible during the snapshot operation, you can control
only the name of the new overlay image.

&gt; &gt; vm/disk1.qcow2. Currently I wait for the VM to be shutdown by the user
&gt; &gt; before I move around disks as desired and run qemu-img rebase in unsafe
&gt; &gt; mode to update the delta disks. Can I accomplish the same result while the
&gt; &gt; VNF is running?

Very theoretically you can achieve the same during the lifetime of the
VM by using 'virsh blockcopy' with the following algorithm:

1) ensure you have a overlay image that is small enough (but that's what
the snapshot operation does if you do it right after snapshot).

Note that the snapshot target should be something temporary, you'll see
why below.

2) symlink/hardlink the original backing image (vm/disk1.qcow2) to the
new locaton

3) create an empty qcow2 overlay file with the desired name of the disk
_after_ snapshot, pointing to the hardlink of the new backing file
destination

4) use shallow 'blockcopy' with --reuse-external operation to move the
temp overlay to the file created in 3), this ensures that it's backing
image as described in the metadata is used

The above has IMO too many moving parts that can go wrong. I'd suggest
adapting to the "backwards" naming of the images which happens with
external snapshots.

&gt; &gt; 2) As you suggested, I now use "virsh restore" to launch a VM with the
&gt; &gt; memory state I had previously backed up. The "virsh restore" API applies to
&gt; &gt; a VM that is not running. However, I see that for internal snapshots,
&gt; &gt; libvirt also supports a snapshot-revert operation on a /live/ VM. Is this
&gt; &gt; possible at all with an external snapshot? If so, what are the commands

No the operation is not implemented for external snapshots yet. The use
of 'virsh restore' is a workaround, which requires manual steps to
preserve images in certain scenarios.

&gt; &gt; needed? My current way of automating a snapshot-revert with an external
&gt; &gt; online snapshot only applies to a shutdown VM. It consists in:
&gt; &gt; - shutting down the VM;
&gt; &gt; - erasing all its delta disks, replacing them with new ones;
&gt; &gt; - executing "virsh restore" on the memory state, making sure that the disk
&gt; &gt; paths referenced in the embedded XML file are correct.

Yes that will sounds reasonable. Note that the XML embedded in the
saveimage points to the original base file so you'll always need to
modify it to use the new deltas.

&gt; &gt; Does this seem reasonable? Can I do the same while the VNF is running?
&gt; &gt; I suppose that for a snapshot-delete operation on a live VM I just need to
&gt; &gt; run "virsh blockpull" on each disk, but I couldn't figure out how to do a
&gt; &gt; revert.

No to use 'virsh restore' you must shutdown the VM, but note that in
many cases with internal snapshots libvirt will also need to terminate
and restart the QEMU process so this situation doesn't really differ.

In the internal snapshot code is way more complicated in order to
preserve the running process needlessly and I'd probably elect to always
restart qemu when reverting them nowadays.

The only drawback is that the remote video connection needs to be
reopened.

</body></email><email><emailId>20210412110150</emailId><senderName>Martin Kletzander</senderName><senderEmail>mkletzan@redhat.com</senderEmail><timestampReceived>2021-04-12 11:01:50-0400</timestampReceived><subject>Re: move mount permission denied</subject><body>


On Wed, Mar 31, 2021 at 05:20:34PM +0800, Jiatong Shen wrote:
&gt;Hello community!
&gt;
&gt;  I am faced with a mysterious [error](
&gt;https://gist.github.com/jshen28/5f29eed51e0a1308684214b35f009478) which
&gt;says move mount is not permissioned.
&gt;
&gt;We are using libvirt with openstack-helm which running libvirt in a docker
&gt;based k8s environment. /dev/termination-log is a device created and
&gt;attached by k8s and mount looks like `/dev/mapper/ubuntu--vg-root on
&gt;/var/log/termination-log type ext4
&gt;(rw,relatime,errors=remount-ro,data=ordered)`
&gt;
&gt;Any idea why this happens? appreciate the help!
&gt;

Because libvirt is shielding the VMs inside containers and it needs to
move some files in there (bind mount to be precise).  You can turn this
off in the config file.  But to be brutally honest I think you will have
some other issues as well and you will have to change few more things
here and there.  If you want to run libvirt inside a container, then I
would suggest you work together with the KubeVirt community [0] who are
already doing that and have some knowledge about what is needed and what
are the requirements.  Don't reinvent the wheel ;-)

Of course if there are some things that we can make better, then we'll
be happy to know about them, so that we can make your experience nicer.
In that case let us know!

[0] https://kubevirt.io/community/

&gt;--
&gt;
&gt;Best Regards,
&gt;
&gt;Jiatong Shen

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20210412190404</emailId><senderName>Pavel Hrdina</senderName><senderEmail>phrdina@redhat.com</senderEmail><timestampReceived>2021-04-12 19:04:04-0400</timestampReceived><subject>Re: Confusion over networking configuration - I might be able to do some documentation</subject><body>


On Sat, Apr 10, 2021 at 03:12:24PM +0000, Ed B wrote:
&gt; Hi libvirt users,
&gt; 
&gt; I have been using libvirt on Debian Linux for a few months. (Mostly with \
&gt; virt-manager. I haven't yet learned all of the command line commands.) 
&gt; I'm currently confused by bridge mode networking, which I think is what I require \
&gt; to address the particular use case, which I will describe: 
&gt; My use case:
&gt; 
&gt; Prior to this I have been using routed mode to organize my VMs. Most of the VMs I \
&gt; deploy are for services (web servers, mail servers, etc) so I require them to have \
&gt; static IP addresses on my local network. 
&gt; ==== An aside / comment: I *can* set those static IPs using the command line virsh \
&gt; net-edit (from memory) command and then change the settings in the xml files. \
&gt; However, since this seems like something that many users would require regularly it \
&gt; would be nice to be able to set static IP in the GUI when configuring with \
&gt; virt-manager. I assume that the same people who maintain libvirt also maintain \
&gt; virt-manager? If I'm wrong please re-direct me. 
&gt; Returning to the main discussion: It would be more convenient for me personally if \
&gt; I were able to set the IP addresses of these VMs using static addresses configured \
&gt; via an external DHCP server. I believe I can do this if my network is in "bridge" \
&gt; mode instead of NAT or Routed. I know this should be possible from reading \
&gt; information online but there doesn't seem to be any option for this in the \
&gt; virt-manager GUI. 
&gt; ==== To give more details on my setup: My network has a pfsense instance which is \
&gt; able to provide IP addresses to local machines. I would like to use the same \
&gt; pfsense machine to provide IP addresses to virtual machines. If I am not mistaken, \
&gt; the only way to do this would be to bridge the network on which the VMs reside to \
&gt; the network on which the pfsense machine resides. 
&gt; I will provide some screenshots to illustrate my confusion. When creating a new \
&gt; virtual network, I assume that I do not want to enable DHCPv4, because I want the \
&gt; pfsense system to allocate IP addresses. I do not know whether I should leave \
&gt; "Enable ipv4 network address space definition" or what the value should be. See \
&gt; image below. 
&gt; [cid:4e926d97-7a58-4350-93cc-0db7c401c075]
&gt; 
&gt; 
&gt; Further in the setup (step 4), I assume I need to choose "Forward to physical \
&gt; network" rather than "Isolated virtual network". 
&gt; For the destination option, I do not know what should be chosen. I don't fully \
&gt; understand how this option works. 
&gt; For "Mode" there are three options: NAT, Routed and finally "Open". I cannot find \
&gt; any documentation which indicates what "Open" means. NAT and Routed are clearly not \
&gt; the correct options here - by a process of elimination that would imply that "Open" \
&gt; means "bridged" but I have a feeling that this is incorrect and I don't understand \
&gt; something else. Again, see screengrab below. 
&gt; [cid:f2ea4e34-c418-48d3-86b2-d7ff1002990a]
&gt; 
&gt; I am quite keen to contribute something to documentation. At the moment I don't \
&gt; understand enough about how libvirt works to be able to do this. 
&gt; Apologies if my questions have been directed to the wrong people. If this is the \
&gt; case could you please re-direct me to the right place to ask such questions? 
&gt; Best regards

Hi,

what you are looking for is no longer available using virt-manager. The
functionality to create host network interfaces like bridge was removed
in virt-manager 2.0.0. Looking at Debian packages the current stable
release uses virt-manager 2.0.0.

In order to create a bridge interface on your host you need to use other
means. For example Debian has its own wiki [1] that describes the
process. You will need to edit /etc/network/interfaces to create a
permanent bridge configuration.

Once you have the bridge created, you would be able to see it in
virt-manager when installing new VMs or editing network interface for
existing VMs where you simply pick your bridge. More details in
`Debian/Ubuntu Bridging` here [2].

Pavel

[1] &lt;https://wiki.debian.org/BridgeNetworkConnections&gt;
[2] &lt;https://wiki.libvirt.org/page/Networking#Debian.2FUbuntu_Bridging&gt;


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20210415035133</emailId><senderName>shafnamol N</senderName><senderEmail>shafnamol29@gmail.com</senderEmail><timestampReceived>2021-04-15 03:51:33-0400</timestampReceived><subject>Re: could not start libvirt service</subject><body>

On Tue, Apr 13, 2021 at 15:56:57 +0530, shafnamol N wrote:
&gt;&gt; Hi,
&gt;&gt;
&gt;&gt; I am using *CentOS 8*. I have built *libvirt* with the following method:
&gt;&gt;
&gt;&gt; $ meson build -Dsystem=true
&gt; &gt;$ ninja -C build
&gt; &gt;$ ninja -C build install
&gt;&gt;
&gt; &gt;But the problem is when i started it
&gt; &gt;
&gt;&gt; # systemctl start libvirtd
&gt; .Job for libvirtd.service failed because the control process exited
&gt; .with error code.
&gt; &gt;See "systemctl status libvirtd.service" and "journalctl -xe" for details.
&gt; .&gt;
&gt;&gt;i tried to get the status of libvirt
&gt; &gt;
&gt; &gt;# systemctl status libvirtd
&gt; &gt;
&gt; &gt;libvirtd.service - Virtualization daemon
&gt;  &gt;  Loaded: loaded (/usr/lib/systemd/system/libvirtd.service; enabled;
&gt; &gt;vendor preset: enabled)
&gt;  &gt;  Active: failed (Result: exit-code)
&gt; &gt;
&gt;&gt; What will be the problem?

&gt;Well, what does the log say?

&gt;https://www.libvirt.org/kbase/debuglogs.html
&lt;https://www.libvirt.org/kbase/debuglogs.html&gt;



I have edited /etc/libvirt/libvirtd.conf file based on
https://www.libvirt.org/kbase/debuglogs.html

Then restarted libvirt
# systemctl restart libvirtd.service
Job for libvirtd.service failed because the control process exited with
error code.
See "systemctl status libvirtd.service" and "journalctl -xe" for details.

&gt;There is not enough info to figure out what the problem is. Including
&gt;the output of 'journalctl -xe' as suggested would be useful.

# journalctl -xe
-- Unit libvirtd.service has failed.
-- 
-- The result is failed.
Apr 15 09:12:33 csg-dellemcsvr0 systemd[1]: libvirtd-ro.socket: Failed with
result 'service-start-limit-hit'.
-- Subject: Unit failed
-- Defined-By: systemd
-- Support: https://access.redhat.com/support
-- 
-- The unit libvirtd-ro.socket has entered the 'failed' state with result
'service-start-limit-hit'.
Apr 15 09:12:33 csg-dellemcsvr0 systemd[1]: libvirtd-admin.socket: Failed
with result 'service-start-limit-hit'.
-- Subject: Unit failed
-- Defined-By: systemd
-- Support: https://access.redhat.com/support
-- 
-- The unit libvirtd-admin.socket has entered the 'failed' state with
result 'service-start-limit-hit'.
Apr 15 09:12:33 csg-dellemcsvr0 systemd[1]: libvirtd.socket: Failed with
result 'service-start-limit-hit'.
-- Subject: Unit failed
-- Defined-By: systemd
-- Support: https://access.redhat.com/support
-- 
-- The unit libvirtd.socket has entered the 'failed' state with result
'service-start-limit-hit'.

On Tue, Apr 13, 2021 at 4:29 PM Pavel Hrdina &lt;phrdina@redhat.com&gt; wrote:

&gt; On Tue, Apr 13, 2021 at 03:56:57PM +0530, shafnamol N wrote:
&gt; &gt; Hi,
&gt; &gt;
&gt; &gt; I am using *CentOS 8*. I have built *libvirt* with the following method:
&gt; &gt;
&gt; &gt; $ meson build -Dsystem=true
&gt; &gt; $ ninja -C build
&gt; &gt; $ ninja -C build install
&gt;
&gt; I would recommend to never to this again. In general installing upstream
&gt; projects into any distribution like this is asking for a lot of trouble.
&gt; The upstream project can change files owned by other packages and break
&gt; them and running yum update can override anything the upstream project
&gt; installed.
&gt;
&gt; Ideally you want to create in case of CentOS RPM package and install
&gt; that instead. If that's not possible you should install upstream project
&gt; into /usr/local/ directory which distribution packages usually don't
&gt; touch at all.
&gt;
&gt; In case of libvirt you can do the following steps:
&gt;
&gt;     meson build
&gt;     ninja -C build dist
&gt;     rpmbuild -tb build/meson-dist/libvirt-{version}.tar.xz
&gt;
&gt; The resulting RPMs will be in ~/rpmbuild/RPMS/{arch}/
&gt;
&gt; you can install all of them but you can also install only what you are
&gt; interested in.
&gt;
&gt; &gt; But the problem is when i started it
&gt; &gt;
&gt; &gt; # systemctl start libvirtd
&gt; &gt; Job for libvirtd.service failed because the control process exited
&gt; &gt; with error code.
&gt; &gt; See "systemctl status libvirtd.service" and "journalctl -xe" for details.
&gt; &gt;
&gt; &gt; i tried to get the status of libvirt
&gt; &gt;
&gt; &gt; # systemctl status libvirtd
&gt; &gt;
&gt; &gt; libvirtd.service - Virtualization daemon
&gt; &gt;    Loaded: loaded (/usr/lib/systemd/system/libvirtd.service; enabled;
&gt; &gt; vendor preset: enabled)
&gt; &gt;    Active: failed (Result: exit-code)
&gt; &gt;
&gt; &gt; What will be the problem?
&gt; &gt;
&gt; &gt; Thanks for the help in advanc....
&gt;
&gt; There is not enough info to figure out what the problem is. Including
&gt; the output of 'journalctl -xe' as suggested would be useful.
&gt;
&gt; Pavel
&gt;

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div&gt;&lt;span style="color:rgb(153,0,255)"&gt;On Tue, Apr 13, 2021 at \
15:56:57 +0530, shafnamol N wrote:&lt;br&gt; &gt;&gt; Hi,&lt;br&gt;
&gt;&gt; &lt;br&gt;
&gt;&gt; I am using *CentOS 8*. I have built *libvirt* with the following \
method:&lt;span class="gmail-im"&gt;&lt;br&gt; &gt;&gt; &lt;br&gt;
&gt;&gt; $ meson build -Dsystem=true&lt;br&gt;
&gt; &gt;$ ninja -C build&lt;br&gt;
&gt; &gt;$ ninja -C build install&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt; &gt;But the problem is when i started it&lt;br&gt;
&gt; &gt;&lt;br&gt;
&gt;&gt; # systemctl start libvirtd&lt;br&gt;
&gt; .Job for libvirtd.service failed because the control process exited&lt;br&gt;
&gt; .with error code.&lt;br&gt;
&gt; &gt;See "systemctl status libvirtd.service" and "journalctl \
-xe" for details.&lt;br&gt; &gt; .&gt;&lt;br&gt;
&gt;&gt;i tried to get the status of libvirt&lt;br&gt;
&gt; &gt;&lt;br&gt;
&gt; &gt;# systemctl status libvirtd&lt;br&gt;
&gt; &gt;&lt;br&gt;
&gt; &gt;libvirtd.service - Virtualization daemon&lt;br&gt;
&gt;   &gt;   Loaded: loaded (/usr/lib/systemd/system/libvirtd.service; enabled;&lt;br&gt;
&gt; &gt;vendor preset: enabled)&lt;br&gt;
&gt;   &gt;   Active: failed (Result: exit-code)&lt;br&gt;
&gt; &gt;&lt;br&gt;
&gt;&gt; What will be the problem?&lt;br&gt;
&lt;br&gt;&lt;/span&gt;
&gt;Well, what does the log say?&lt;br&gt;
&lt;br&gt;
&lt;a href="https://www.libvirt.org/kbase/debuglogs.html" rel="noreferrer" \
target="_blank"&gt;&gt;https://www.libvirt.org/kbase/debuglogs.html&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="color:rgb(153,0,255)"&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I \
have edited &lt;span&gt;/etc/libvirt/libvirtd.conf&lt;/span&gt; file based on &lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;a \
href="https://www.libvirt.org/kbase/debuglogs.html" \
target="_blank"&gt;https://www.libvirt.org/kbase/debuglogs.html&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Then \
restarted libvirt&lt;/div&gt;&lt;div&gt;# systemctl restart libvirtd.service&lt;br&gt;Job for \
libvirtd.service failed because the control process exited with error code.&lt;br&gt;See \
"systemctl status libvirtd.service" and "journalctl -xe" for \
details.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style="color:rgb(153,0,255)"&gt;&gt;There is not \
enough info to figure out what the problem is. Including&lt;br&gt; &gt;the output of \
'journalctl -xe' as suggested would be useful.&lt;/span&gt;&lt;font \
color="#888888"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;# journalctl -xe&lt;/div&gt;&lt;div&gt;-- \
Unit libvirtd.service has failed.&lt;br&gt;-- &lt;br&gt;-- The result is failed.&lt;br&gt;Apr 15 \
09:12:33 csg-dellemcsvr0 systemd[1]: libvirtd-ro.socket: Failed with result \
'service-start-limit-hit'.&lt;br&gt;-- Subject: Unit failed&lt;br&gt;-- Defined-By: \
systemd&lt;br&gt;-- Support: &lt;a \
href="https://access.redhat.com/support"&gt;https://access.redhat.com/support&lt;/a&gt;&lt;br&gt;-- \
&lt;br&gt;-- The unit libvirtd-ro.socket has entered the 'failed' state with result \
'service-start-limit-hit'.&lt;br&gt;Apr 15 09:12:33 csg-dellemcsvr0 systemd[1]: \
libvirtd-admin.socket: Failed with result 'service-start-limit-hit'.&lt;br&gt;-- \
Subject: Unit failed&lt;br&gt;-- Defined-By: systemd&lt;br&gt;-- Support: &lt;a \
href="https://access.redhat.com/support"&gt;https://access.redhat.com/support&lt;/a&gt;&lt;br&gt;-- \
&lt;br&gt;-- The unit libvirtd-admin.socket has entered the 'failed' state with \
result 'service-start-limit-hit'.&lt;br&gt;Apr 15 09:12:33 csg-dellemcsvr0 \
systemd[1]: libvirtd.socket: Failed with result \
'service-start-limit-hit'.&lt;br&gt;-- Subject: Unit failed&lt;br&gt;-- Defined-By: \
systemd&lt;br&gt;-- Support: &lt;a \
href="https://access.redhat.com/support"&gt;https://access.redhat.com/support&lt;/a&gt;&lt;br&gt;-- \
&lt;br&gt;-- The unit libvirtd.socket has entered the 'failed' state with result \
'service-start-limit-hit'.&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div \
dir="ltr" class="gmail_attr"&gt;On Tue, Apr 13, 2021 at 4:29 PM Pavel Hrdina &lt;&lt;a \
href="mailto:phrdina@redhat.com"&gt;phrdina@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;On Tue, Apr 13, 2021 \
at 03:56:57PM +0530, shafnamol N wrote:&lt;br&gt; &gt; Hi,&lt;br&gt;
&gt; &lt;br&gt;
&gt; I am using *CentOS 8*. I have built *libvirt* with the following method:&lt;br&gt;
&gt; &lt;br&gt;
&gt; $ meson build -Dsystem=true&lt;br&gt;
&gt; $ ninja -C build&lt;br&gt;
&gt; $ ninja -C build install&lt;br&gt;
&lt;br&gt;
I would recommend to never to this again. In general installing upstream&lt;br&gt;
projects into any distribution like this is asking for a lot of trouble.&lt;br&gt;
The upstream project can change files owned by other packages and break&lt;br&gt;
them and running yum update can override anything the upstream project&lt;br&gt;
installed.&lt;br&gt;
&lt;br&gt;
Ideally you want to create in case of CentOS RPM package and install&lt;br&gt;
that instead. If that's not possible you should install upstream project&lt;br&gt;
into /usr/local/ directory which distribution packages usually don't&lt;br&gt;
touch at all.&lt;br&gt;
&lt;br&gt;
In case of libvirt you can do the following steps:&lt;br&gt;
&lt;br&gt;
      meson build&lt;br&gt;
      ninja -C build dist&lt;br&gt;
      rpmbuild -tb build/meson-dist/libvirt-{version}.tar.xz&lt;br&gt;
&lt;br&gt;
The resulting RPMs will be in ~/rpmbuild/RPMS/{arch}/&lt;br&gt;
&lt;br&gt;
you can install all of them but you can also install only what you are&lt;br&gt;
interested in.&lt;br&gt;
&lt;br&gt;
&gt; But the problem is when i started it&lt;br&gt;
&gt; &lt;br&gt;
&gt; # systemctl start libvirtd&lt;br&gt;
&gt; Job for libvirtd.service failed because the control process exited&lt;br&gt;
&gt; with error code.&lt;br&gt;
&gt; See "systemctl status libvirtd.service" and "journalctl -xe" \
for details.&lt;br&gt; &gt; &lt;br&gt;
&gt; i tried to get the status of libvirt&lt;br&gt;
&gt; &lt;br&gt;
&gt; # systemctl status libvirtd&lt;br&gt;
&gt; &lt;br&gt;
&gt; libvirtd.service - Virtualization daemon&lt;br&gt;
&gt;      Loaded: loaded (/usr/lib/systemd/system/libvirtd.service; enabled;&lt;br&gt;
&gt; vendor preset: enabled)&lt;br&gt;
&gt;      Active: failed (Result: exit-code)&lt;br&gt;
&gt; &lt;br&gt;
&gt; What will be the problem?&lt;br&gt;
&gt; &lt;br&gt;
&gt; Thanks for the help in advanc....&lt;br&gt;
&lt;br&gt;
There is not enough info to figure out what the problem is. Including&lt;br&gt;
the output of 'journalctl -xe' as suggested would be useful.&lt;br&gt;
&lt;br&gt;
Pavel&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;



</body></email><email><emailId>20210421012514</emailId><senderName>Eyüp Hakan Duran</senderName><senderEmail>ehakanduran@gmail.com</senderEmail><timestampReceived>2021-04-21 01:25:14-0400</timestampReceived><subject>Re: external snapshot create error</subject><body>


Hi Peter,

On 21/04/20 09:14AM, Peter Krempa wrote:
&gt; The problem is that file=overlay.qcow2 points to a relative path (not
&gt; starting with a leading '/'). Libvirt enforces that the path must be a
&gt; full path.

Thank you! I confirm that it is working following your correction.

&gt; I've recently pushed a commit which removes the XML validation in this
&gt; case as it's counter-productive and the XML parser provides a more
&gt; understandable error:
&gt;
&gt; https://gitlab.com/libvirt/libvirt/-/commit/f1c9fed2ca8f2509495f46b355dab019604f7475
&gt;
&gt; (note that this commit will be in the upcomming libvirt-7.3 release)

Thank you for the great software and all you do!

Hakan

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20210421154147</emailId><senderName>lejeczek</senderName><senderEmail>peljasz@yahoo.co.uk</senderEmail><timestampReceived>2021-04-21 15:41:47-0400</timestampReceived><subject>GlusterFS pools - do they work?</subject><body>

Hi guys.

I've been a consumer of libvirt for a while but this is 
first time I'm trying this:

-&gt; $ virsh vol-create-as glusterfs-VMs2 fcos-node1.qcow2 20G 
--format qcow2
error: Failed to create vol fcos-node1.qcow2
error: this function is not supported by the connection 
driver: storage pool does not support volume creation

I'm on CentOS Stream with glusterfs-8.4, libvirt-7 and 
qemu-kvm-5.2.0
What might be the issue here?
many thanks, L.

</body></email><email><emailId>20210422091715</emailId><senderName>Guy Godfroy</senderName><senderEmail>guy.godfroy@gugod.fr</senderEmail><timestampReceived>2021-04-22 09:17:15-0400</timestampReceived><subject>Need more doc for libvirt-console-proxy</subject><body>

Hello,

I'm making a web app for my company that will enable different teams to
manage their own VMs. I wish to make possible to interact with each VM
console, so I plan to use some xterm.js with websockets.

So I discovered libvirt-console-proxy [1] when I looked for something to
put a libvirt console into a websocket. That seems like the right tool
for the job.

The only doc I found is this article from 2017 [2]. After trying to
understand from this article and from --help, I still have many
questions. I am really bad at reading code so I can't even get answers
from the sources.

My main concern is: How a client is supposed to talk to the proxy? It is
said that a security token must be provided. How? HTTP header? Which
header? Am I missing something in websocket protocol? I think an example
client implementation would help a lot.

Also, I tried to use virtconsoleresolveradm to set up metadata on my
domains like explained in the article [1] :

./virtconsoleresolveradm enable milou
Enabled access to domain 'milou'

But that doesn't seem to do anything (except defining the metadata
namespace in the XML):

    virsh metadata milou http://libvirt.org/schemas/console-proxy/1.0
    &lt;consoles/&gt;

I precise that I have already this in my XML:

    &lt;serial type='pty'&gt;
      &lt;target type='isa-serial' port='0'&gt;
        &lt;model name='isa-serial'/&gt;
      &lt;/target&gt;
    &lt;/serial&gt;
    &lt;console type='pty'&gt;
      &lt;target type='serial' port='0'/&gt;
    &lt;/console&gt;

Should I remove that? Should I edit that?

Thanks for your help.

Guy Godfroy

[1] https://gitlab.com/libvirt/libvirt-console-proxy
[2]
https://www.berrange.com/posts/2017/01/26/announce-new-libvirt-console-proxy-project/

</body></email><email><emailId>20210423141819</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-04-23 14:18:19-0400</timestampReceived><subject>Re: l3 cache and cpu pinning</subject><body>

On Thu, Apr 22, 2021 at 01:34:18PM +0200, Roman Mohr wrote:
&gt; On Thu, Apr 22, 2021 at 1:24 PM Roman Mohr &lt;rmohr@redhat.com&gt; wrote:
&gt; 
&gt; &gt;
&gt; &gt;
&gt; &gt; On Thu, Apr 22, 2021 at 1:19 PM Roman Mohr &lt;rmohr@redhat.com&gt; wrote:
&gt; &gt;
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; On Wed, Apr 21, 2021 at 1:09 PM Daniel P. Berrangé &lt;berrange@redhat.com&gt;
&gt; &gt;&gt; wrote:
&gt; &gt;&gt;
&gt; &gt;&gt;&gt; On Wed, Apr 21, 2021 at 12:53:49PM +0200, Roman Mohr wrote:
&gt; &gt;&gt;&gt; &gt; Hi,
&gt; &gt;&gt;&gt; &gt;
&gt; &gt;&gt;&gt; &gt; I have a question regarding enabling l3 cache emulation on Domains. Can
&gt; &gt;&gt;&gt; &gt; this also be enabled without cpu-pinning, or does it need cpu pinning
&gt; &gt;&gt;&gt; to
&gt; &gt;&gt;&gt; &gt; emulate the l3 caches according to the cpus where the guest is pinned
&gt; &gt;&gt;&gt; to?
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; I presume you're referring to
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;   &lt;cpu&gt;
&gt; &gt;&gt;&gt;     &lt;cache level='3' mode='emulate|passthrough|none'/&gt;
&gt; &gt;&gt;&gt;   &lt;/cpu&gt;
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; There is no hard restriction placed on usage of these modes by QEMU.
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; Conceptually though, you only want to use "passthrough" mode if you
&gt; &gt;&gt;&gt; have configured the sockets/cores/threads topology to match the host
&gt; &gt;&gt;&gt; CPUs. In turn you only ever want to set sockets/cores/threads to
&gt; &gt;&gt;&gt; match the host if you have done CPU pinning such that the topology
&gt; &gt;&gt;&gt; actually matches the host CPUs that have been pinned to.
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; As a rule of thumb
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;  - If letting CPUs float
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;      -&gt; Always uses sockets=1, cores=num-vCPUs, threads=1
&gt; &gt;&gt;&gt;      -&gt; cache==emulate
&gt; &gt;&gt;&gt;      -&gt; Always use 1 guest NUMA node (ie the default)
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;
&gt; &gt;&gt; Is `emulate` also the default in libvirt? If not, would you see any
&gt; &gt;&gt; reason, e.g. thinking about migrations, to not set it always if no cpu
&gt; &gt;&gt; pinning is done?
&gt; &gt;&gt;
&gt; &gt;
&gt; &gt; To answer my own question: I guess something like [1] is a good reason to
&gt; &gt; not enable l3-cache by default, since it seems to have an impact on VM
&gt; &gt; density on nodes.
&gt; &gt;
&gt; 
&gt; Hm, seems like this change got only merged for older machine types. So
&gt; according to the libvirt doc (not setting it means hypervisor default), it
&gt; is probably set to emulation?

Actually that patch didn't get merged at all afaict.

The support for l3-cache was introduced in QEMU 2.8.0, defaulting to
enabled. The code you see that disables it in older machine types dates
from this time, because we had to preserve ABI for machine tpyes &lt; 2.8.0


So in practice today you'll be getting "emulate" mode already with any
non-ancient QEMU.

Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20210430113033</emailId><senderName>Felix Schwarz</senderName><senderEmail>felix.schwarz@oss.schwarz.eu</senderEmail><timestampReceived>2021-04-30 11:30:33-0400</timestampReceived><subject>trying to understand how libvirt uses firewalld</subject><body>

Hi,

I recently installed a test box using CentOS 8 and installed a CentOS 8 guest
via libvirt (KVM).
I need to use "routed" forwarding as the datacenter only gives me individual IPs
which are routed to the physical interface and the switch only accepts packets
with a well-known MAC address.

On the host I enabled firewalld and moved the guest to a specific firewalld 
zone. I verified that libvirt is detecting firewalld.

My idea was that I could use this to create somewhat fine-grained filters on the
host for traffic from the internet to the guest (and possibly vice-versa).

However it seems like that does not work the way I wanted:
It seems as if nothing changes when I allow/disallow SSH for that zone. I can
still ssh from the internet to the guest.

After several reads on the documentation I have a guess of what might be going
on but I'd like to confirm that:
https://libvirt.org/firewall.html#fw-firewalld-and-virtual-network-driver

&gt; If firewalld is active on the host, libvirt will attempt to place the bridge
&gt;  interface of a libvirt virtual network into the firewalld zone named 
&gt; "libvirt" (thus making all guest-&gt;host traffic on that network subject to
&gt; the rules of the "libvirt" zone).
Does that mean libvirt's firewalld usage is ONLY for traffic guest-&gt;host and 
does not affect all other traffic (e.g. host-&gt;guest, guest&lt;-&gt;internet)?
That sounds incredibly narrow (and not very useful for me) but it would explain 
why I don't see any effects in my experiment...


---
In a related note it would be nice if there was a way to make routed setups with 
individual IPs easier. This problem hunts me for more than 10 years (I think I 
posted something in 2009 - still the same problem basically) and it would be 
nice if libvirt could somehow support this use case better:

I want to allow traffic guest &lt;-&gt; internet in a routed setup. libvirt generates 
iptables rules like these:

Chain LIBVIRT_FWO (1 references)

  pkts bytes target     prot opt in     out     source               destination 

     0     0 ACCEPT     all  --  br-private *       10.11.0.0/24 
0.0.0.0/0
     0     0 REJECT     all  --  br-private *       0.0.0.0/0 
0.0.0.0/0            reject-with icmp-port-unreachable
     0     0 ACCEPT     all  --  br-public *       (NETWORK IP ) 
0.0.0.0/0
    43  3232 REJECT     all  --  br-public *       0.0.0.0/0 
0.0.0.0/0            reject-with icmp-port-unreachable

I my case "NETWORK IP" is a /32 IPv4 and AFAIK I have to put the host's IPv4 
here (which is basically the router) so I can assign the guest IP inside the VM.
What I need is basically a rule like ACCEPT one above but with the GUEST IP. I 
have some elaborate Python script which I can use as a "network" hook but that 
requires parsing output of "iptables" due to libvirt's events (e.g. libvirtd 
restart triggers one "plugged" event per VM).

Thank you very much,
Felix

</body></email><email><emailId>20210301121505</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-03-01 12:15:05-0400</timestampReceived><subject>Re: Live backups create-snapshot-as and memspec</subject><body>

On Fri, Feb 26, 2021 at 15:29:45 -0300, David Wells wrote:
&gt; 
&gt; El 25/2/2021 a las 11:37, Peter Krempa escribió:
&gt; &gt; On Wed, Feb 24, 2021 at 14:49:19 -0300, David Wells wrote:
&gt; &gt; &gt; Hi all!
&gt; &gt; &gt; 
&gt; &gt; &gt; I've been using libvirt for some time and until now I have treated backups
&gt; &gt; &gt; of virtual computers as if they where physical computers installing the
&gt; &gt; &gt; backup client on the guest. I am now however facing the need to backup a
&gt; &gt; &gt; couple a couple of guest at the host level so I've been trying to catch up
&gt; &gt; &gt; by reading, googling and by trial and error too. Up to now I've been able to
&gt; &gt; &gt; backup a live machine whith a command like the following
&gt; &gt; &gt; 
&gt; &gt; &gt; &gt; virsh snapshot-create-as --domain test --name backup --atomic --diskspec
&gt; &gt; &gt; &gt; vda,snapshot=external --disk-only
&gt; &gt; &gt; This command creates a file test.backup and in the meantime I can backup the
&gt; &gt; &gt; original test.qcow2 but for what I saw this disk image is in a "dirty"
&gt; &gt; &gt; state, as if the machine I could restore from this file had been turned off
&gt; &gt; &gt; whithout a proper shutdown.
&gt; &gt; &gt; 
&gt; &gt; &gt; I know that I can later restore the machine to its original state by issuing
&gt; &gt; &gt; a command like this
&gt; &gt; &gt; 
&gt; &gt; &gt; &gt; virsh blockcommit --domain test vda --active --pivot
&gt; &gt; &gt; &gt; virsh snapshot-delete test --metadata backup
&gt; &gt; &gt; I have seen that it is possible to create the snapshot using a memspec
&gt; &gt; &gt; parameter which would make the backup of the guest as if it where in a clean
&gt; &gt; &gt; state, however I haven't found the equivalent of the blockcommit for the
&gt; &gt; &gt; memory file, in a sort of speak, to be able to restore the guest to it's
&gt; &gt; &gt; original state.
&gt; &gt; The memory image file doesn't depend on any other state nor does the VM
&gt; &gt; use it after the snapshot is taken, if you don't need it you can delete
&gt; &gt; it.
&gt; &gt; 
&gt; &gt; The disk overlay you create by  'virsh snapshot-create-as' records only
&gt; &gt; differences to the original image, but for memory state it doesn't make
&gt; &gt; much sense as the memory is small and changes a lot, so we take a
&gt; &gt; snapshot of the whole memory.
&gt; &gt; 
&gt; &gt; Now to restore the state of a VM to a snapshot taken with memory,
&gt; &gt; libvirt's native APIs for reverting don't work on external snapshots
&gt; &gt; yet.
&gt; &gt; 
&gt; &gt; You can use 'virsh restore memimg' to load VM's state as the memory
&gt; &gt; snaphsot images have the same format as images created by 'virsh save'.
&gt; &gt; 
&gt; &gt; Please note though that the configuration of the VM is taken from the
&gt; &gt; save image if you do so, which includes paths to disk images, which may
&gt; &gt; no longer be correct or desired, but virsh save-image-edit can be used
&gt; &gt; to modify the XML if needed.
&gt; &gt; 
&gt; Hi all!
&gt; 
&gt; Peter, thank you very much for your reply! So if I understood correctly
&gt; there is no way, at this time, to backup a live guest in a way that I can
&gt; restore it to a "clean" state. Also, if I understood correctly, the

No you misunderstood. Creating an external snaphsot with --memspec in
fact creates a state capture which can be completely restored in terms
of consistency of filesystems and in-memory data.

What currently isn't possible is to use the virDomainRevertToSnapshot
API to do so, but there are manual steps which can be taken to do so.

Obviously state beyond the VM can't be restored, so network connections
existing at the time of the snapshot will be broken.

&gt; probability of a corrupt system on restore of the vm is minimized having the
&gt; qemu guest agent installed on the guest and issue the virsh
&gt; create-snapshot-as with the --quiesce parameter, is this correct?

Yes that is correct, the filesystem is still mounted but the guest agent
ensures that caches were flushed before. AFAIK the guest agent even
provides guest-OS side hooks which allow to flush databases and others
which are not filesystem bound to have the on-disk state as clean as
possible.

</body></email><email><emailId>20210303015420</emailId><senderName>xingchaochao</senderName><senderEmail>xingchaochao@huawei.com</senderEmail><timestampReceived>2021-03-03 01:54:20-0400</timestampReceived><subject>=?utf-8?B?562U5aSNOiBTb21lIGNvbmZ1c2lvbiBhYm91dCBsc2lsb2dpYyBjb250cm9s?= =?utf-8?Q?ler?=</subject><body>

Thank you for your kind reply. This issue involves a qemu bug, 
and the patch has been queued by the qemu community on March 2. 
https://patchwork.kernel.org/project/qemu-devel/patch/20210302133016.1221081-1-liangpeng10@huawei.com/


Regards,
Xingchaochao

-----邮件原件-----
发件人: Daniel P. Berrangé [mailto:berrange@redhat.com] 
发送时间: 2021年2月24日 19:07
收件人: xingchaochao &lt;xingchaochao@huawei.com&gt;
抄送: libvir-list@redhat.com; libvirt-users@redhat.com; liangpeng (H) \
&lt;liangpeng10@huawei.com&gt;; Zhangbo (Oscar) &lt;oscar.zhangbo@huawei.com&gt;; Xiexiangyou \
&lt;xiexiangyou@huawei.com&gt; 主题: Re: Some confusion about lsilogic controller

On Wed, Feb 24, 2021 at 09:11:03AM +0000, xingchaochao wrote:
&gt; 
&gt; Hello,
&gt; I have been confused by such a phenomenon recently.
&gt; Libvirt is the master branch , and the VM is centos8.2(kernel is \
&gt; 4.18.0-193.el8.aarch64). When I hot-plug the scsi disk for a virtual machine \
&gt; without a virtio-scsi controller, libvirt will automatically generate an lsilogic \
&gt; controller for the scsi disk.

snip

&gt; I am confused, why libvirt chooses to generate an lsilogic controller 
&gt; for the scsi disk when there is no scsi controller, instead of 
&gt; directly reporting an error and exiting the hot plug operation. After 
&gt; all, the scsi disk based on the lsilogic controller is not perceived 
&gt; inside the virtual machine, and lsilogic will remain in the XML file 
&gt; of the virtual machine.

libvirt has no knowledge of what devices the guest OS is able to support. In this \
case RHEL8 doesn't support lsilogic, but libvirt doesn't know this.

Generally a libvirt mgmt application will not rely on the defaults for choosing \
devices, and instead use libosinfo to figure out what devices are likely to be \
supported and explicitly use those.


Regards,
Daniel
-- 
&gt; &gt; https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
&gt; &gt; https://libvirt.org         -o-            https://fstop138.berrange.com :|
&gt; &gt; https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|


</body></email><email><emailId>20210304142929</emailId><senderName>Brad Jennings</senderName><senderEmail>d741242793@gmail.com</senderEmail><timestampReceived>2021-03-04 14:29:29-0400</timestampReceived><subject>virtio model type and netfilter masquerade not being applied</subject><body>

Quick question for anyone in the know, I have a fairly basic setup (at
least I think it is?)  with an openvswitch, and the br0 port has an IP
assigned in the same subnet as the VM to act as a gateway.
              |------ovs-------|
eno2 &lt;-- |--br0             |
              |--vnet0 - VM  |
              |------------------|


I would like the VM (vnet0) to use br0 as a gateway which local
connectivity wise seems fine but the internet is a bit odd. I can ping for
example 1.1.1.1 dns without any issues but anying udp/tcp is a no go.

I checked the physical hosts interface(eno2) and br0 to find that the VM's
packets were successfully heading to br0 but when leaving the physical
host(eno2) the tcp/udp packets weren't being masqueraded. The rule is
pretty straightforward and to test I plugged another device into the eno1
afxdp port and had no connectivity issues and packets were being
masqueraded fine.

I tried to set trustGuestRxFilters='yes' but that didn't work and the same
state remained, the only thing that worked was using the "rtl8139" model
type.

I always remember using 'virtio' in the past and I must be missing
something crucial in the somewhat lengthy libvirt documentation.

Would be super helpful if someone can shed some light on this ? and
possibly if I should be using virtio or the realtek driver ?

Thanks ! (config below)

Iptables:


sudo iptables -t nat -A POSTROUTING -o eno2 -j MASQUERADE



ovs-vsctl show

ec13c3e2-6159-4019-984e-36cc90c59075

    Bridge br0

        fail_mode: standalone

        datapath_type: netdev

        Port vnet0

            Interface vnet0

        Port eno1

            Interface eno1

                type: afxdp

        Port br0

            Interface br0
                type: internal

instance domain xml
&lt;interface type='bridge'&gt;
      &lt;mac address='52:54:00:77:fc:70'/&gt;
      &lt;source bridge='br0'/&gt;
      &lt;virtualport type='openvswitch'&gt;
        &lt;parameters interfaceid='2124ef39-e244-434c-8339-d2aa04d0d888'/&gt;
      &lt;/virtualport&gt;
      &lt;model type='virtio'/&gt; #rtl8139 works.
      &lt;address type='pci' domain='0x0000' bus='0x02' slot='0x01'
function='0x0'/&gt;
    &lt;/interface&gt;

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Quick question for anyone in the know, I have a fairly basic setup (at \
least I think it is?)   with an openvswitch, and the br0 port has an IP assigned in \
the same subnet as the VM to act as a gateway.  &lt;div&gt;                     \
|------ovs-------|&lt;/div&gt;&lt;div&gt;eno2 &lt;-- |--br0                    |&lt;/div&gt;&lt;div&gt;       \
|--vnet0 - VM   |&lt;/div&gt;&lt;div&gt;                     \
|------------------|&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I would like the VM (vnet0) to \
use br0 as a gateway which local connectivity wise seems fine but the internet is a \
bit odd. I can ping for example 1.1.1.1 dns without any issues but anying udp/tcp is \
a no go.  &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I checked the physical hosts interface(eno2) and \
br0 to find that the VM's packets were successfully heading to br0 but when \
leaving the physical host(eno2) the tcp/udp packets weren't being masqueraded. \
The rule is pretty straightforward and to test I plugged another device into the eno1 \
afxdp port and had no connectivity issues and packets were being masqueraded \
fine.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I tried to set  &lt;span \
style="background-color:rgb(238,238,238);color:rgb(0,0,0);font-family:LibvirtOverpassMono;font-size:14.4px"&gt;trustGuestRxFilters='yes&lt;/span&gt;' \
but that didn't work and the same state remained, the only thing that worked was \
using the "rtl8139" model type.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I always remember  \
using 'virtio' in the past and I must be missing something crucial  in the \
somewhat lengthy libvirt documentation.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Would be super \
helpful if someone can shed some light on this ? and possibly if I should be using \
virtio or the realtek driver ?  &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks ! (config \
below)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;





&lt;p class="gmail-p1" style="margin:0px;font-variant-numeric:normal;font-variant-east-as \
ian:normal;font-stretch:normal;font-size:11px;line-height:normal;font-family:Menlo;color:rgb(0,0,0)"&gt;&lt;span \
class="gmail-s1" style="font-variant-ligatures:no-common-ligatures"&gt;Iptables:&lt;/span&gt;&lt;/p&gt;&lt;p \
class="gmail-p1" style="margin:0px;font-variant-numeric:normal;font-variant-east-asian \
:normal;font-stretch:normal;font-size:11px;line-height:normal;font-family:Menlo;color:rgb(0,0,0)"&gt;&lt;span \
class="gmail-s1" style="font-variant-ligatures:no-common-ligatures"&gt;&lt;br&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class="gmail-p1" style="margin:0px;font-variant-numeric:normal;font-variant-east-asian \
:normal;font-stretch:normal;font-size:11px;line-height:normal;font-family:Menlo;color:rgb(0,0,0)"&gt;&lt;span \
class="gmail-s1" style="font-variant-ligatures:no-common-ligatures"&gt;sudo iptables -t \
nat -A POSTROUTING -o eno2 -j MASQUERADE&lt;/span&gt;&lt;/p&gt;&lt;p class="gmail-p1" \
style="margin:0px;font-variant-numeric:normal;font-variant-east-asian:normal;font-stre \
tch:normal;font-size:11px;line-height:normal;font-family:Menlo;color:rgb(0,0,0)"&gt;&lt;span \
class="gmail-s1" style="font-variant-ligatures:no-common-ligatures"&gt;&lt;br&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class="gmail-p1" style="margin:0px;font-variant-numeric:normal;font-variant-east-asian \
:normal;font-stretch:normal;font-size:11px;line-height:normal;font-family:Menlo;color:rgb(0,0,0)"&gt;&lt;br&gt;&lt;/p&gt;&lt;div&gt;ovs-vsctl \
show&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;





&lt;p class="gmail-p1" style="margin:0px;font-variant-numeric:normal;font-variant-east-as \
ian:normal;font-stretch:normal;font-size:11px;line-height:normal;font-family:Menlo;color:rgb(0,0,0)"&gt;&lt;span \
class="gmail-s1" style="font-variant-ligatures:no-common-ligatures"&gt;ec13c3e2-6159-4019-984e-36cc90c59075&lt;/span&gt;&lt;/p&gt;
 &lt;p class="gmail-p1" \
style="margin:0px;font-variant-numeric:normal;font-variant-east-asian:normal;font-stre \
tch:normal;font-size:11px;line-height:normal;font-family:Menlo;color:rgb(0,0,0)"&gt;&lt;span \
class="gmail-s1" style="font-variant-ligatures:no-common-ligatures"&gt;&lt;span \
class="gmail-Apple-converted-space"&gt;      &lt;/span&gt;Bridge br0&lt;/span&gt;&lt;/p&gt; &lt;p \
class="gmail-p1" style="margin:0px;font-variant-numeric:normal;font-variant-east-asian \
:normal;font-stretch:normal;font-size:11px;line-height:normal;font-family:Menlo;color:rgb(0,0,0)"&gt;&lt;span \
class="gmail-s1" style="font-variant-ligatures:no-common-ligatures"&gt;&lt;span \
class="gmail-Apple-converted-space"&gt;            &lt;/span&gt;fail_mode: \
standalone&lt;/span&gt;&lt;/p&gt; &lt;p class="gmail-p1" \
style="margin:0px;font-variant-numeric:normal;font-variant-east-asian:normal;font-stre \
tch:normal;font-size:11px;line-height:normal;font-family:Menlo;color:rgb(0,0,0)"&gt;&lt;span \
class="gmail-s1" style="font-variant-ligatures:no-common-ligatures"&gt;&lt;span \
class="gmail-Apple-converted-space"&gt;            &lt;/span&gt;datapath_type: \
netdev&lt;/span&gt;&lt;/p&gt; &lt;p class="gmail-p1" \
style="margin:0px;font-variant-numeric:normal;font-variant-east-asian:normal;font-stre \
tch:normal;font-size:11px;line-height:normal;font-family:Menlo;color:rgb(0,0,0)"&gt;&lt;span \
class="gmail-s1" style="font-variant-ligatures:no-common-ligatures"&gt;&lt;span \
class="gmail-Apple-converted-space"&gt;            &lt;/span&gt;Port vnet0&lt;/span&gt;&lt;/p&gt; &lt;p \
class="gmail-p1" style="margin:0px;font-variant-numeric:normal;font-variant-east-asian \
:normal;font-stretch:normal;font-size:11px;line-height:normal;font-family:Menlo;color:rgb(0,0,0)"&gt;&lt;span \
class="gmail-s1" style="font-variant-ligatures:no-common-ligatures"&gt;&lt;span \
class="gmail-Apple-converted-space"&gt;                  &lt;/span&gt;Interface \
vnet0&lt;/span&gt;&lt;/p&gt; &lt;p class="gmail-p1" \
style="margin:0px;font-variant-numeric:normal;font-variant-east-asian:normal;font-stre \
tch:normal;font-size:11px;line-height:normal;font-family:Menlo;color:rgb(0,0,0)"&gt;&lt;span \
class="gmail-s1" style="font-variant-ligatures:no-common-ligatures"&gt;&lt;span \
class="gmail-Apple-converted-space"&gt;            &lt;/span&gt;Port eno1&lt;/span&gt;&lt;/p&gt; &lt;p \
class="gmail-p1" style="margin:0px;font-variant-numeric:normal;font-variant-east-asian \
:normal;font-stretch:normal;font-size:11px;line-height:normal;font-family:Menlo;color:rgb(0,0,0)"&gt;&lt;span \
class="gmail-s1" style="font-variant-ligatures:no-common-ligatures"&gt;&lt;span \
class="gmail-Apple-converted-space"&gt;                  &lt;/span&gt;Interface \
eno1&lt;/span&gt;&lt;/p&gt; &lt;p class="gmail-p1" \
style="margin:0px;font-variant-numeric:normal;font-variant-east-asian:normal;font-stre \
tch:normal;font-size:11px;line-height:normal;font-family:Menlo;color:rgb(0,0,0)"&gt;&lt;span \
class="gmail-s1" style="font-variant-ligatures:no-common-ligatures"&gt;&lt;span \
class="gmail-Apple-converted-space"&gt;                        &lt;/span&gt;type: \
afxdp&lt;/span&gt;&lt;/p&gt; &lt;p class="gmail-p1" \
style="margin:0px;font-variant-numeric:normal;font-variant-east-asian:normal;font-stre \
tch:normal;font-size:11px;line-height:normal;font-family:Menlo;color:rgb(0,0,0)"&gt;&lt;span \
class="gmail-s1" style="font-variant-ligatures:no-common-ligatures"&gt;&lt;span \
class="gmail-Apple-converted-space"&gt;            &lt;/span&gt;Port br0&lt;/span&gt;&lt;/p&gt; &lt;p \
class="gmail-p1" style="margin:0px;font-variant-numeric:normal;font-variant-east-asian \
:normal;font-stretch:normal;font-size:11px;line-height:normal;font-family:Menlo;color:rgb(0,0,0)"&gt;&lt;span \
class="gmail-s1" style="font-variant-ligatures:no-common-ligatures"&gt;&lt;span \
class="gmail-Apple-converted-space"&gt;                  &lt;/span&gt;Interface br0&lt;/span&gt;&lt;/p&gt; \
&lt;div&gt;&lt;span class="gmail-Apple-converted-space" \
style="font-variant-ligatures:no-common-ligatures;color:rgb(0,0,0);font-family:Menlo;font-size:11px"&gt; \
&lt;/span&gt;&lt;span style="font-variant-ligatures:no-common-ligatures;color:rgb(0,0,0);font-family:Menlo;font-size:11px"&gt;type: \
internal&lt;/span&gt;    &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;instance domain xml&lt;/div&gt;&lt;div&gt;&lt;interface \
type='bridge'&gt;&lt;br&gt;         &lt;mac \
address='52:54:00:77:fc:70'/&gt;&lt;br&gt;         &lt;source \
bridge='br0'/&gt;&lt;br&gt;         &lt;virtualport \
type='openvswitch'&gt;&lt;br&gt;            &lt;parameters \
interfaceid='2124ef39-e244-434c-8339-d2aa04d0d888'/&gt;&lt;br&gt;         \
&lt;/virtualport&gt;&lt;br&gt;         &lt;model type='virtio'/&gt; #rtl8139 \
works.&lt;br&gt;         &lt;address type='pci' domain='0x0000' \
bus='0x02' slot='0x01' function='0x0'/&gt;&lt;br&gt;      \
&lt;/interface&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210305084216</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-03-05 08:42:16-0400</timestampReceived><subject>Re: virsh snapshot-create-as with quiesce option times out</subject><body>

On Thu, Mar 04, 2021 at 18:12:06 -0300, David Wells wrote:
&gt; Hi all!
&gt; 
&gt; I'm still working on the live backup of a couple vm's and what happens most
&gt; of the times es that when I execute virsh with the snapshot-create-as with
&gt; the --quiesce option the process finishes with an error that reads
&gt; &gt; error: Timed out during operation: cannot acquire state change lock
&gt; 
&gt; I tried turning up the debug level but found nothing that appears to be of
&gt; interest and I can connect successfully to the qemu guest agent since the
&gt; following command returns the correct value
&gt; &gt; sudo /usr/sbin/virsh domfsinfo slackware-current
&gt; &gt; Mountpoint Name     Type     Target
&gt; &gt; -------------------------------------------------------------------
&gt; &gt; /                                    vda1     ext4     vda
&gt; 
&gt; I also tried running the qemu-ga agent on the guest with debugging enabled
&gt; and when I issue this last command I can see the agent talking to the host
&gt; but when I issue the quiesce option the guest agent shows nothing at all.
&gt; 
&gt; Is this by any chance a known bug? Is there something obvious I'm missing?
&gt; What else can I provide to help debug this issue?

It's not a known bug. Ideally post the libvirtd debug log. Make sure you
are starting the VM fresh when doing so to clear out any prior state.

Post the log either here or file an issue:

https://gitlab.com/libvirt/libvirt/-/issues/new?issue%5Bassignee_id%5D=&amp;issue%5Bmilestone_id%5D=

Please observe our guideline on filing proper bug reports:

 https://libvirt.org/bugs.html#quality
 https://libvirt.org/kbase/debuglogs.htm

</body></email><email><emailId>20210311085113</emailId><senderName>Liran Rotenberg</senderName><senderEmail>lrotenbe@redhat.com</senderEmail><timestampReceived>2021-03-11 08:51:13-0400</timestampReceived><subject>Snapshot operation aborted and volume usage</subject><body>

We recently had this bug[1]. The thought that came from it is the handling
of error code after running virDomainSnapshotCreateXML, we encountered
VIR_ERR_OPERATION_ABORTED(78).
Apparently, the new volume is in use. Are there cases where this will
happen and the new volume won't appear in the volumes chain? Can we detect
/ know when?
Thinking aloud, if we can detect such cases we can prevent rolling back by
reporting it back from VDSM to ovirt. Or, if it can't be detected to go on
the safe side in order to save data corruption and prevent the rollback as
well.

Currently, in ovirt, if the job is aborted, we will look into the chain to
decide whether to rollback or not.

Regards,
Liran.

[1] - https://bugzilla.redhat.com/show_bug.cgi?id=1916122

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;We recently had this bug[1]. The thought that came from it is the \
handling of error code after running virDomainSnapshotCreateXML, we encountered \
VIR_ERR_OPERATION_ABORTED(78).&lt;div&gt;Apparently, the new volume is in use. Are there \
cases where this will happen and the new volume won't appear in the volumes \
chain? Can we detect / know when?&lt;div&gt;Thinking aloud, if we can detect such cases we \
can prevent rolling back by reporting it back from VDSM to ovirt. Or, if it can't \
be detected to go on the safe side in order to save data corruption and prevent the \
rollback as well.&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Currently, in ovirt, if the job is \
aborted, we will look into the chain to decide whether to rollback or \
not.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;Liran.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;[1] \
-  &lt;a href="https://bugzilla.redhat.com/show_bug.cgi?id=1916122" \
target="_blank"&gt;https://bugzilla.redhat.com/show_bug.cgi?id=1916122&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210311105331</emailId><senderName>Gionatan Danti</senderName><senderEmail>g.danti@assyoma.it</senderEmail><timestampReceived>2021-03-11 10:53:31-0400</timestampReceived><subject>Bridge and VLAN trunk</subject><body>

Dear list,
I am a question about the best use of bridge, vlan trunk and libvirt.

When dealing with virtual machies bound to specific vlan, I generally 
use a straightforward approach:
eth -&gt; bridge -&gt; vm (for untagged traffic)
eth -&gt; eth.10 -&gt; bridge -&gt; vm
eth -&gt; eth.nn -&gt; bridge -&gt; vm

Now I am faced with enabling vlan trunking for a specific vm (a 
virtualized firewall). The simpler approach would be:
eth -&gt; bridge -&gt; vm (for the vm needing trunk)
eth -&gt; bridge.10 -&gt; macvtap -&gt; vm

The issue with the above method is that any VM on the main untagged vlan 
needs to be bound to the "plain" bridge, having access to *any* traffic 
of *any* other vlan. If this is ok (and the desired behavior) for the 
firewall, it is clearly wrong for the other VMs.

A simple fix would be to use ebtables to block/drop vlan tagged traffic 
on the main bridge for any virtual adapter except the required one (ie: 
the firewall virtual interface). It works, but I wounder if other 
preferred approaches exists.

For example, I tested another more convoluted setup:
eth -&gt; bridge -&gt; firewall vm
eth -&gt; bridge.10 -&gt; macvtap -&gt; vm
eth -&gt; bridge -&gt; veth0 -&gt; veth1 -&gt; other bridge with vlan filtering on 
-&gt; vm

The last row show the use of veth virtual interface, configurable via ip 
link. Enabling vlan filtering on the second bridge (rather than on the 
first) is to keep vlan filtering simple: rathen than enabling all 
required vlan on the first bridge, I simply enable only untagged traffic 
on the second one.

Does libvirt support bridge vlan filtering natively? Reading the docs, 
it seems to the supported only on OpenVSwitch or SRV-IO based adapter.

Thanks.

-- 
Danti Gionatan
Supporto Tecnico
Assyoma S.r.l. - www.assyoma.it
email: g.danti@assyoma.it - info@assyoma.it
GPG public key ID: FF5F32A8

</body></email><email><emailId>20210305100439</emailId><senderName>Samuel Thampy</senderName><senderEmail>samjiks@hotmail.com</senderEmail><timestampReceived>2021-03-05 10:04:39-0400</timestampReceived><subject>Re: Issue</subject><body>

Is there any additional info anyone who needs?

________________________________
From: Samuel Thampy &lt;samjiks@hotmail.com&gt;
Sent: 03 March 2021 22:11
To: libvirt-users@redhat.com &lt;libvirt-users@redhat.com&gt;
Subject: Issue

I have a storage backend san disks, I have five servers which is KVM hosted guests.

I am looking to clone an image of a guest machine, so I can use a new VM form the \
image on a different server..

I am not sure what the best way. But when I do that, I get a memory error, and need \
to xfs_repair and damages the original machine.


My steps are

One vm machine on the same server

  *   dd create original vm to template.img
  *   lvcreate -L 9G -n &lt;vol-name&gt; &lt;pool&gt;
  *   dd template.img to /dev/&lt;pool&gt;/&lt;vol-name&gt;
  *   virsh define &lt;vm_name&gt;.xml

another vm machine on the secondary server

  *   copy template.img to another server
  *   lvcreate -L 9G -n &lt;vol-name&gt; &lt;pool&gt;
  *   dd if=template.img  of=/dev/&lt;pool&gt;/&lt;vol-name&gt;
  *   virsh define &lt;vm_name&gt;.xml

May I know the steps are missing something because both are getting corrupted. Thanks \
for your help.

Regards
Samuel Thampy


[Attachment #3 (text/html)]

&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"&gt;
&lt;style type="text/css" style="display:none;"&gt; P {margin-top:0;margin-bottom:0;} \
&lt;/style&gt; &lt;/head&gt;
&lt;body dir="ltr"&gt;
&lt;div style="font-family: Calibri, Helvetica, sans-serif; font-size: 12pt; color: \
rgb(0, 0, 0);"&gt; Is there any additional info anyone who needs?&lt;/div&gt;
&lt;div&gt;
&lt;div id="appendonsend"&gt;&lt;/div&gt;
&lt;div style="font-family:Calibri,Helvetica,sans-serif; font-size:12pt; \
color:rgb(0,0,0)"&gt; &lt;br&gt;
&lt;/div&gt;
&lt;hr tabindex="-1" style="display:inline-block; width:98%"&gt;
&lt;div id="divRplyFwdMsg" dir="ltr"&gt;&lt;font face="Calibri, sans-serif" color="#000000" \
style="font-size:11pt"&gt;&lt;b&gt;From:&lt;/b&gt; Samuel Thampy &lt;samjiks@hotmail.com&gt;&lt;br&gt; \
&lt;b&gt;Sent:&lt;/b&gt; 03 March 2021 22:11&lt;br&gt; &lt;b&gt;To:&lt;/b&gt; libvirt-users@redhat.com \
&lt;libvirt-users@redhat.com&gt;&lt;br&gt; &lt;b&gt;Subject:&lt;/b&gt; Issue&lt;/font&gt;
&lt;div&gt; &lt;/div&gt;
&lt;/div&gt;
&lt;div dir="ltr"&gt;
&lt;div style="font-family:Calibri,Helvetica,sans-serif; font-size:12pt; \
color:rgb(0,0,0)"&gt; I have a storage backend san disks, I have five servers which is \
KVM hosted guests.&lt;/div&gt; &lt;div style="font-family:Calibri,Helvetica,sans-serif; \
font-size:12pt; color:rgb(0,0,0)"&gt; &lt;br&gt;
&lt;/div&gt;
&lt;div style="font-family:Calibri,Helvetica,sans-serif; font-size:12pt; \
color:rgb(0,0,0)"&gt; I am looking to clone an image of a guest machine, so I can use a \
new VM form the image on a different server.. &lt;/div&gt; &lt;div \
style="font-family:Calibri,Helvetica,sans-serif; font-size:12pt; color:rgb(0,0,0)"&gt; \
&lt;br&gt; &lt;/div&gt;
&lt;div style="font-family:Calibri,Helvetica,sans-serif; font-size:12pt; \
color:rgb(0,0,0)"&gt; I am not sure what the best way. But when I do that, I get a \
memory error, and need to xfs_repair and damages the original machine.&lt;/div&gt; &lt;div \
style="font-family:Calibri,Helvetica,sans-serif; font-size:12pt; color:rgb(0,0,0)"&gt; \
&lt;br&gt; &lt;/div&gt;
&lt;div style="font-family:Calibri,Helvetica,sans-serif; font-size:12pt; \
color:rgb(0,0,0)"&gt; &lt;br&gt;
&lt;/div&gt;
&lt;div style="font-family:Calibri,Helvetica,sans-serif; font-size:12pt; \
color:rgb(0,0,0)"&gt; My steps are &lt;/div&gt;
&lt;div style="font-family:Calibri,Helvetica,sans-serif; font-size:12pt; \
color:rgb(0,0,0)"&gt; &lt;br&gt;
&lt;/div&gt;
&lt;div style="font-family:Calibri,Helvetica,sans-serif; font-size:12pt; \
color:rgb(0,0,0)"&gt; One vm machine on the same server&lt;/div&gt;
&lt;div style="font-family:Calibri,Helvetica,sans-serif; font-size:12pt; \
color:rgb(0,0,0)"&gt; &lt;ul&gt;
&lt;li&gt;dd create original vm to template.img&lt;/li&gt;&lt;li&gt;lvcreate -L 9G -n &lt;vol-name&gt; \
&lt;pool&gt;&lt;/li&gt;&lt;li&gt;dd template.img to \
/dev/&lt;pool&gt;/&lt;vol-name&gt;&lt;/li&gt;&lt;li&gt;virsh define &lt;vm_name&gt;.xml&lt;/li&gt;&lt;/ul&gt; \
&lt;/div&gt; &lt;div style="font-family:Calibri,Helvetica,sans-serif; font-size:12pt; \
color:rgb(0,0,0)"&gt; another vm machine on the secondary server&lt;/div&gt;
&lt;div style="font-family:Calibri,Helvetica,sans-serif; font-size:12pt; \
color:rgb(0,0,0)"&gt; &lt;ul style="background-color:rgb(255,255,255)"&gt;
&lt;li&gt;copy template.img to another server&lt;/li&gt;&lt;li&gt;lvcreate -L 9G -n &lt;vol-name&gt; \
&lt;pool&gt;&lt;/li&gt;&lt;li&gt;dd if=template.img  \
of=/dev/&lt;pool&gt;/&lt;vol-name&gt;&lt;/li&gt;&lt;li&gt;virsh define \
&lt;vm_name&gt;.xml&lt;/li&gt;&lt;/ul&gt; &lt;div&gt;&lt;br&gt;
&lt;/div&gt;
&lt;div&gt;May I know the steps are missing something because both are getting corrupted. \
Thanks for your help.&lt;/div&gt; &lt;div&gt;&lt;br&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div style="font-family:Calibri,Helvetica,sans-serif; font-size:12pt; \
color:rgb(0,0,0)"&gt; &lt;span style="color:rgb(0,0,0); \
font-family:Calibri,Helvetica,sans-serif; font-size:12pt"&gt;Regards&lt;/span&gt;&lt;br&gt; &lt;/div&gt;
&lt;div style="font-family:Calibri,Helvetica,sans-serif; font-size:12pt; \
color:rgb(0,0,0)"&gt; Samuel Thampy&lt;/div&gt;
&lt;div style="font-family:Calibri,Helvetica,sans-serif; font-size:12pt; \
color:rgb(0,0,0)"&gt; &lt;br&gt;
&lt;/div&gt;
&lt;div style="font-family:Calibri,Helvetica,sans-serif; font-size:12pt; \
color:rgb(0,0,0)"&gt; &lt;br&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20210317044513</emailId><senderName>Melissa_Nuño</senderName><senderEmail>melissa.nuno@gmail.com</senderEmail><timestampReceived>2021-03-17 04:45:13-0400</timestampReceived><subject>Using cgroups in QEMU hooks</subject><body>

Hi all,

I'm creating a device during the prepare hook, and would like to add it to
the device.allow file for the VM. The cgroup doesn't exist during the
prepare hook or the start hook and will fail with an "Operation not
permitted" error. I can add the expected path to qemu.conf and restart
libvirtd, but this isn't very flexible since I'd have to do it for each
device for each VM I create. All of the other libvirt cgroups seem to allow
all devices, so I'm not seeing where the VM cgroup is getting its initial
list.

Is there a way to access the cgroup for a VM before it has started? I can't
even predict where it should be since it contains the domain ID.

Thanks!

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hi all,&lt;br&gt;&lt;br&gt;I'm creating a device during the prepare hook, and \
would like to add it to the device.allow file for the VM. The cgroup doesn't \
exist during the prepare hook or the start hook and will fail with an "Operation \
not permitted" error. I can add the expected path to qemu.conf and restart \
libvirtd, but this isn't very flexible since I'd have to do it for each \
device for each VM I create. All of the other libvirt cgroups seem to allow all \
devices, so I'm not seeing where the VM cgroup is getting its initial \
list.&lt;br&gt;&lt;br&gt;Is there a way to access the cgroup for a VM before it has started? I \
can't even predict where it should be since it contains the domain \
ID.&lt;br&gt;&lt;br&gt;Thanks!&lt;/div&gt;



</body></email><email><emailId>20210317171902</emailId><senderName>Alex Crawford</senderName><senderEmail>crawford@redhat.com</senderEmail><timestampReceived>2021-03-17 17:19:02-0400</timestampReceived><subject>Updating dnsmasq options with virsh net-update</subject><body>

I'm trying to take advantage of libvirt's support for passing through
options to dnsmasq
&lt;https://libvirt.org/formatnetwork.html#elementsNamespaces&gt;, but I'm having
trouble getting it to take effect. I have a network already created and I'm
trying to use net-update to add the options, but it's not clear to me what
section I should specify. By the way, is there a good way to list the
available sections? I've been resorting to reading the code
&lt;https://gitlab.com/libvirt/libvirt/-/blob/18d0f2f9569edf3c26d912a7d8974a54bb32eee9/include/libvirt/libvirt-network.h#L158-175&gt;.
 Working in a different direction, I tried using net-edit to make the
changes but they seem to have been silently discarded:

    $ virsh -c qemu:///system net-edit crawford-libvirt-67v2h
    Network crawford-libvirt-67v2h XML configuration edited.
    $ virsh -c qemu:///system net-dumpxml crawford-libvirt-67v2h | grep
--count &lt;my changes&gt;
    0

Can anyone tell me what I'm doing wrong or how this feature was intended to
be used? Thank you.

-Alex


[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div&gt;I'm trying to take advantage of libvirt's support for &lt;a \
href="https://libvirt.org/formatnetwork.html#elementsNamespaces"&gt;passing through \
options to dnsmasq&lt;/a&gt;, but I'm having trouble getting it to take effect. I have \
a network already created and I'm trying to use net-update to add the options, \
but it's not clear to me what section I should specify. By the way, is there a \
good way to list the available sections? I've been resorting to &lt;a \
href="https://gitlab.com/libvirt/libvirt/-/blob/18d0f2f9569edf3c26d912a7d8974a54bb32eee9/include/libvirt/libvirt-network.h#L158-175"&gt;reading \
the code&lt;/a&gt;. Working in a different direction, I tried using net-edit to make the \
changes but they seem to have been silently discarded:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;      \
$ virsh -c qemu:///system net-edit crawford-libvirt-67v2h&lt;br&gt;       Network \
crawford-libvirt-67v2h XML configuration edited.&lt;/div&gt;&lt;div&gt;       $ virsh -c \
qemu:///system net-dumpxml crawford-libvirt-67v2h | grep --count &lt;my \
changes&gt;&lt;/div&gt;&lt;div&gt;       0&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Can anyone tell me what \
I'm doing wrong or how this feature was intended to be used? Thank \
you.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-Alex&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210322042910</emailId><senderName>shafnamol N</senderName><senderEmail>shafnamol29@gmail.com</senderEmail><timestampReceived>2021-03-22 04:29:10-0400</timestampReceived><subject>virsh capabilities does not include qemu</subject><body>

Hi,
I am new  to Libvirt and Qemu.I have installed Libvirt 7.1.0 and qemu-kvm
4.2.0.
I configured and built libvirt based on instructions from
https://libvirt.org/compiling.html.
But when i tried to create a VM using virsh it shows the following error:
# virsh create /home/abc.xml
error: Failed to create domain from /home/abc.xml
error: invalid argument: could not find capabilities for arch=x86_64
domaintype=kvm

When i check the hypervisor capabilities ,it doest show qemu in guest
domain type.
# virsh capabilities
....................................
.....................................
 &lt;/host&gt;

  &lt;guest&gt;
    &lt;os_type&gt;exe&lt;/os_type&gt;
    &lt;arch name='x86_64'&gt;
      &lt;wordsize&gt;64&lt;/wordsize&gt;
      &lt;emulator&gt;/usr/local/libexec/libvirt_lxc&lt;/emulator&gt;
      &lt;domain type='lxc'/&gt;
    &lt;/arch&gt;
  &lt;/guest&gt;

  &lt;guest&gt;
    &lt;os_type&gt;exe&lt;/os_type&gt;
    &lt;arch name='i686'&gt;
      &lt;wordsize&gt;32&lt;/wordsize&gt;
      &lt;emulator&gt;/usr/local/libexec/libvirt_lxc&lt;/emulator&gt;
      &lt;domain type='lxc'/&gt;
    &lt;/arch&gt;
  &lt;/guest&gt;

&lt;/capabilities&gt;

I have restarted libvirt to get the qemu support,but  it is not shown in
capabilities list.What will be the problem?
Thanks for the help in advance....

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div&gt;Hi,&lt;/div&gt;&lt;div&gt;I am new   to Libvirt and Qemu.I have installed \
Libvirt 7.1.0 and qemu-kvm 4.2.0.&lt;/div&gt;&lt;div&gt;I configured and built libvirt based on \
instructions from&lt;/div&gt;&lt;div&gt;&lt;a \
href="https://libvirt.org/compiling.html"&gt;https://libvirt.org/compiling.html&lt;/a&gt;.&lt;/div&gt;&lt;div&gt;But \
when i tried to create a VM using virsh it shows the following error:&lt;/div&gt;&lt;div&gt;# \
virsh create /home/abc.xml&lt;br&gt;error: Failed to create domain from \
/home/abc.xml&lt;br&gt;error: invalid argument: could not find capabilities for arch=x86_64 \
domaintype=kvm &lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;When i check the hypervisor capabilities \
,it doest show qemu in guest domain type.&lt;/div&gt;&lt;div&gt;# virsh \
capabilities&lt;/div&gt;&lt;div&gt;....................................&lt;/div&gt;&lt;div&gt;.....................................&lt;br&gt;&lt;/div&gt;&lt;div&gt; \
&lt;/host&gt;&lt;br&gt;&lt;br&gt;   &lt;guest&gt;&lt;br&gt;      &lt;os_type&gt;exe&lt;/os_type&gt;&lt;br&gt; \
&lt;arch name='x86_64'&gt;&lt;br&gt;         \
&lt;wordsize&gt;64&lt;/wordsize&gt;&lt;br&gt;         \
&lt;emulator&gt;/usr/local/libexec/libvirt_lxc&lt;/emulator&gt;&lt;br&gt;         \
&lt;domain type='lxc'/&gt;&lt;br&gt;      &lt;/arch&gt;&lt;br&gt;   \
&lt;/guest&gt;&lt;br&gt;&lt;br&gt;   &lt;guest&gt;&lt;br&gt;      \
&lt;os_type&gt;exe&lt;/os_type&gt;&lt;br&gt;      &lt;arch name='i686'&gt;&lt;br&gt;      \
&lt;wordsize&gt;32&lt;/wordsize&gt;&lt;br&gt;         \
&lt;emulator&gt;/usr/local/libexec/libvirt_lxc&lt;/emulator&gt;&lt;br&gt;         \
&lt;domain type='lxc'/&gt;&lt;br&gt;      &lt;/arch&gt;&lt;br&gt;   \
&lt;/guest&gt;&lt;br&gt;&lt;br&gt;&lt;/capabilities&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I have restarted \
libvirt to get the qemu support,but   it is not shown in capabilities list.What will \
be the problem?&lt;/div&gt;&lt;div&gt;Thanks for the help in \
advance....&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210322125724</emailId><senderName>Michal Privoznik</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-03-22 12:57:24-0400</timestampReceived><subject>Re: virsh capabilities does not include qemu</subject><body>

On 3/22/21 5:17 AM, shafnamol N wrote:
&gt; Hi,
&gt; I am new  to Libvirt and Qemu.I have installed Libvirt 7.1.0 and 
&gt; qemu-kvm 4.2.0.
&gt; I configured and built libvirt based on instructions from
&gt; https://libvirt.org/compiling.html &lt;https://libvirt.org/compiling.html&gt;.
&gt; But when i tried to create a VM using virsh it shows the following error:
&gt; # virsh create /home/abc.xml
&gt; error: Failed to create domain from /home/abc.xml
&gt; error: invalid argument: could not find capabilities for arch=x86_64 
&gt; domaintype=kvm
&gt; 
&gt; When i check the hypervisor capabilities ,it doest show qemu in guest 
&gt; domain type.
&gt; # virsh capabilities
&gt; ....................................
&gt; .....................................
&gt;   &lt;/host&gt;
&gt; 
&gt;    &lt;guest&gt;
&gt;      &lt;os_type&gt;exe&lt;/os_type&gt;
&gt;      &lt;arch name='x86_64'&gt;
&gt;        &lt;wordsize&gt;64&lt;/wordsize&gt;
&gt;        &lt;emulator&gt;/usr/local/libexec/libvirt_lxc&lt;/emulator&gt;
&gt;        &lt;domain type='lxc'/&gt;
&gt;      &lt;/arch&gt;
&gt;    &lt;/guest&gt;
&gt; 
&gt;    &lt;guest&gt;
&gt;      &lt;os_type&gt;exe&lt;/os_type&gt;
&gt;      &lt;arch name='i686'&gt;
&gt;        &lt;wordsize&gt;32&lt;/wordsize&gt;
&gt;        &lt;emulator&gt;/usr/local/libexec/libvirt_lxc&lt;/emulator&gt;

This smells suspicious. Perhaps you did not pass proper prefix (meson 
-Dsystem=true)?

Anyway, libvirt tries to find qemu-system-$arch in $PATH and falls back 
to /usr/libexec/qemu-kvm if no binary was found. So I suspect that maybe 
the directory you installed QEMU into is not in $PATH?

Michal

</body></email><email><emailId>20210322131006</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-03-22 13:10:06-0400</timestampReceived><subject>Re: virsh capabilities does not include qemu</subject><body>

On Mon, Mar 22, 2021 at 01:57:24PM +0100, Michal Privoznik wrote:
&gt; On 3/22/21 5:17 AM, shafnamol N wrote:
&gt; &gt; Hi,
&gt; &gt; I am new  to Libvirt and Qemu.I have installed Libvirt 7.1.0 and
&gt; &gt; qemu-kvm 4.2.0.
&gt; &gt; I configured and built libvirt based on instructions from
&gt; &gt; https://libvirt.org/compiling.html &lt;https://libvirt.org/compiling.html&gt;.
&gt; &gt; But when i tried to create a VM using virsh it shows the following error:
&gt; &gt; # virsh create /home/abc.xml
&gt; &gt; error: Failed to create domain from /home/abc.xml
&gt; &gt; error: invalid argument: could not find capabilities for arch=x86_64
&gt; &gt; domaintype=kvm
&gt; &gt; 
&gt; &gt; When i check the hypervisor capabilities ,it doest show qemu in guest
&gt; &gt; domain type.
&gt; &gt; # virsh capabilities
&gt; &gt; ....................................
&gt; &gt; .....................................
&gt; &gt;   &lt;/host&gt;
&gt; &gt; 
&gt; &gt;    &lt;guest&gt;
&gt; &gt;      &lt;os_type&gt;exe&lt;/os_type&gt;
&gt; &gt;      &lt;arch name='x86_64'&gt;
&gt; &gt;        &lt;wordsize&gt;64&lt;/wordsize&gt;
&gt; &gt;        &lt;emulator&gt;/usr/local/libexec/libvirt_lxc&lt;/emulator&gt;
&gt; &gt;        &lt;domain type='lxc'/&gt;
&gt; &gt;      &lt;/arch&gt;
&gt; &gt;    &lt;/guest&gt;
&gt; &gt; 
&gt; &gt;    &lt;guest&gt;
&gt; &gt;      &lt;os_type&gt;exe&lt;/os_type&gt;
&gt; &gt;      &lt;arch name='i686'&gt;
&gt; &gt;        &lt;wordsize&gt;32&lt;/wordsize&gt;
&gt; &gt;        &lt;emulator&gt;/usr/local/libexec/libvirt_lxc&lt;/emulator&gt;
&gt; 
&gt; This smells suspicious. Perhaps you did not pass proper prefix (meson
&gt; -Dsystem=true)?
&gt; 
&gt; Anyway, libvirt tries to find qemu-system-$arch in $PATH and falls back to
&gt; /usr/libexec/qemu-kvm if no binary was found. So I suspect that maybe the
&gt; directory you installed QEMU into is not in $PATH?

This capabiliities output is showing an lxc:///system driver connection
too, not QEMU. So I suspect libvirt was perhaps built without QEMU
support ?


Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20210317175133</emailId><senderName>"brent s."</senderName><senderEmail>bts@square-r00t.net</senderEmail><timestampReceived>2021-03-17 17:51:33-0400</timestampReceived><subject>Re: Updating dnsmasq options with virsh net-update</subject><body>

On 3/17/21 13:19, Alex Crawford wrote:
&gt; I'm trying to take advantage of libvirt's support for passing through
&gt; options to dnsmasq
&gt; &lt;https://libvirt.org/formatnetwork.html#elementsNamespaces&gt;, but I'm
&gt; having trouble getting it to take effect. I have a network already
&gt; created and I'm trying to use net-update to add the options, but it's
&gt; not clear to me what section I should specify. By the way, is there a
&gt; good way to list the available sections? I've been resorting to reading
&gt; the code
&gt; &lt;https://gitlab.com/libvirt/libvirt/-/blob/18d0f2f9569edf3c26d912a7d8974a54bb32eee9/include/libvirt/libvirt-network.h#L158-175&gt;.
&gt;  Working in a different direction, I tried using net-edit to make the
&gt; changes but they seem to have been silently discarded:
&gt; 
&gt; $ virsh -c qemu:///system net-edit crawford-libvirt-67v2h
&gt; Network crawford-libvirt-67v2h XML configuration edited.
&gt; $ virsh -c qemu:///system net-dumpxml crawford-libvirt-67v2h | grep
&gt; --count &lt;my changes&gt;
&gt; 0
&gt; 
&gt; Can anyone tell me what I'm doing wrong or how this feature was intended
&gt; to be used? Thank you.
&gt; 
&gt; -Alex

The last time I tried using net-update, if I recall it didn't support
full editing. I had to net-edit the network in question and restart it
(to do exactly what you're tryint to do, I should note!). I don't think
net-update lets you edit the root element's namespace (which is what you
need to do for e.g. &lt;dnsmasq:options&gt; to not be eaten).

For reference, the modified root element looks like this:

&lt;network xmlns:dnsmasq="http://libvirt.org/schemas/network/dnsmasq/1.0"&gt;
  &lt;!-- Normal network definition here... --&gt;
  &lt;dnsmasq:options&gt;
    &lt;dnsmasq:option value="log-dhcp"/&gt;
  &lt;/dnsmasq:options&gt;
&lt;/network&gt;

-- 
brent saner
https://square-r00t.net/
GPG info: https://square-r00t.net/gpg-info


</body></email><email><emailId>20210311150531</emailId><senderName>Laine Stump</senderName><senderEmail>laine@redhat.com</senderEmail><timestampReceived>2021-03-11 15:05:31-0400</timestampReceived><subject>Re: Bridge and VLAN trunk</subject><body>

On 3/11/21 5:53 AM, Gionatan Danti wrote:
&gt; Dear list,
&gt; I am a question about the best use of bridge, vlan trunk and libvirt.
&gt; 
&gt; When dealing with virtual machies bound to specific vlan, I generally 
&gt; use a straightforward approach:
&gt; eth -&gt; bridge -&gt; vm (for untagged traffic)
&gt; eth -&gt; eth.10 -&gt; bridge -&gt; vm
&gt; eth -&gt; eth.nn -&gt; bridge -&gt; vm
&gt; 
&gt; Now I am faced with enabling vlan trunking for a specific vm (a 
&gt; virtualized firewall). The simpler approach would be:
&gt; eth -&gt; bridge -&gt; vm (for the vm needing trunk)
&gt; eth -&gt; bridge.10 -&gt; macvtap -&gt; vm
&gt; 
&gt; The issue with the above method is that any VM on the main untagged vlan 
&gt; needs to be bound to the "plain" bridge, having access to *any* traffic 
&gt; of *any* other vlan. If this is ok (and the desired behavior) for the 
&gt; firewall, it is clearly wrong for the other VMs.
&gt; 
&gt; A simple fix would be to use ebtables to block/drop vlan tagged traffic 
&gt; on the main bridge for any virtual adapter except the required one (ie: 
&gt; the firewall virtual interface). It works, but I wounder if other 
&gt; preferred approaches exists.
&gt; 
&gt; For example, I tested another more convoluted setup:
&gt; eth -&gt; bridge -&gt; firewall vm
&gt; eth -&gt; bridge.10 -&gt; macvtap -&gt; vm
&gt; eth -&gt; bridge -&gt; veth0 -&gt; veth1 -&gt; other bridge with vlan filtering on 
&gt; -&gt; vm
&gt; 
&gt; The last row show the use of veth virtual interface, configurable via ip 
&gt; link. Enabling vlan filtering on the second bridge (rather than on the 
&gt; first) is to keep vlan filtering simple: rathen than enabling all 
&gt; required vlan on the first bridge, I simply enable only untagged traffic 
&gt; on the second one.
&gt; 
&gt; Does libvirt support bridge vlan filtering natively? Reading the docs, 
&gt; it seems to the supported only on OpenVSwitch or SRV-IO based adapter.

That's correct. Support was added to the Linux host-bridge device a few 
years ago for per-port VLAN tagging/filtering, but there hasn't been 
anyone sufficiently compelled (by their own needs or by their altruistic 
instincts) to support that. It likely would be fairly straightforward to 
do once someone dove into it - all the necessary config attributes are 
already there, so it would just involve recognizing and acting on them 
when a guest interface connected to a bridge that was a standard Linux 
host bridge (of course in reality there will likely be some unexpected 
incompatibility that will make it more difficult, but at least *in 
theory* it would be simple).

So, if you can program in C and are willing to dig into the online docs 
for setting per-port attributes for Linux host bridges and implementing 
them (iirc via sending netlink messages) then feel free to start 
hacking, and check in on irc.oftc.net in the #virt channel if you have 
questions. Otherwise, I would recommend installing Open vSwitch. I don't 
have a link handy, but I've seen a few HOWTOs floating around, and 
followed one of them a few years ago to set it up on Fedora and RHEL 
test machines.

</body></email><email><emailId>20210322150145</emailId><senderName>Francesc Guasch</senderName><senderEmail>frankie@telecos.upc.edu</senderEmail><timestampReceived>2021-03-22 15:01:45-0400</timestampReceived><subject>infinite lease time</subject><body>

Hi. First of all thanks for this great project and specially
for keeping the Perl library.

I need to keep the IP address of the virtual machines the same
as long as possible. dnsmasq provides a setting for lease time.
It can be set to infinite, but not from within libvirt.

I found this patch from 2016.
 &gt; 
https://listman.redhat.com/archives/libvir-list/2016-October/msg00561.html

But it looks like it never made to libvirt.

Some time ago I made it work changing dnsmasq/default.conf.
Then we made it immutable with chattr. This no longer works
because libvirt refuses to start dnsmasq unless it can write
to it. Fair enough.

I've seen I can add manual IP addresses as stated here:

   https://wiki.libvirt.org/page/Networking

This is ok, but it would be a considerable amount of work,
requiring lots of manual labour.

Is there a way to set the lease time from libvirt ?

Thank you !

</body></email><email><emailId>20210326113103</emailId><senderName>Yalan Zhang</senderName><senderEmail>yalzhang@redhat.com</senderEmail><timestampReceived>2021-03-26 11:31:03-0400</timestampReceived><subject>Question about the Qos support status for different type interfaces</subject><body>

Hi there,

I have a question about the Qos support status for different type
interfaces.
Some types of interface do not support Qos, such as hostdev, user type,
mcast type, but the behavior are different, for hostdev, the guest can not
start with a meaningful error message, but for other types, vm can start
successfully with a warning message in the libvirtd log. I doubt that if it
is necessary to keep the behavior consistent for these different types?

There are 2 history bugs for them, I should have thought further and asked
early when testing the bugs.
Bug 1319044 &lt;https://bugzilla.redhat.com/show_bug.cgi?id=1319044&gt; - log
error when &lt;bandwidth&gt; requested on a &lt;interface type='hostdev'&gt;
Bug 1524230 &lt;https://bugzilla.redhat.com/show_bug.cgi?id=1524230&gt; - vhostuser
type interface do not support bandwidth, but no warning message

Thank you for looking into this and very appreciate your feedback!

1. start vm with user type interface set with Qos:
 &lt;interface type='user'&gt;
      &lt;mac address='52:54:00:3e:ec:14'/&gt;
      &lt;bandwidth&gt;
        &lt;inbound average='1000' peak='5000' burst='5120'/&gt;
        &lt;outbound average='128' peak='256' burst='256'/&gt;
      &lt;/bandwidth&gt;
      &lt;model type='rtl8139'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x07' slot='0x01'
function='0x0'/&gt;
    &lt;/interface&gt;

# cat /var/log/libvirt/libvirtd.log | grep bandwidth
2021-03-26 10:47:11.452+0000: 20185: warning :
qemuBuildInterfaceCommandLine:8223 : setting bandwidth on interfaces of
type 'user' is not implemented yet

2. start with hostdev type interface with Qos setting:
&lt;interface type='hostdev' managed='yes'&gt;
      &lt;mac address='52:54:00:07:27:b0'/&gt;
      &lt;source&gt;
        &lt;address type='pci' domain='0x0000' bus='0x82' slot='0x10'
function='0x6'/&gt;
      &lt;/source&gt;
      &lt;bandwidth&gt;
        &lt;inbound average='1000' peak='5000' burst='5120'/&gt;
        &lt;outbound average='128' peak='256' burst='256'/&gt;
      &lt;/bandwidth&gt;
      &lt;address type='pci' domain='0x0000' bus='0x01' slot='0x00'
function='0x0'/&gt;
    &lt;/interface&gt;

# virsh start rh
error: Failed to start domain 'rh'
error: unsupported configuration: interface 52:54:00:07:27:b0 - bandwidth
settings are not supported for hostdev interfaces


-------
Best Regards,
Yalan Zhang
IRC: yalzhang

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div&gt;Hi there,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;I have a question about  the Qos \
support status for different type interfaces.  &lt;div&gt;Some types  of interface do not \
support  Qos, such as hostdev, user type, mcast type, but the behavior are different, \
for hostdev, the guest can not start with a meaningful error message, but for other \
types, vm can start successfully with a warning message  in the libvirtd log. I doubt \
that if it is necessary to keep the behavior consistent  for these different  \
types?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;There are 2 history bugs for them, I should have \
thought further and asked early when testing the bugs.  &lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;a \
href="https://bugzilla.redhat.com/show_bug.cgi?id=1319044" \
style="color:rgb(0,136,206);text-decoration-line:none;font-family:"Open \
Sans",Helvetica,sans-serif;outline:none"&gt;Bug  1319044&lt;/a&gt;&lt;span \
style="color:rgb(0,0,0);font-family:"Open \
Sans",Helvetica,sans-serif;background-color:rgb(208,208,208)"&gt;  &lt;/span&gt;&lt;span \
id="gmail-summary_container" style="color:rgb(0,0,0);font-family:"Open \
Sans",Helvetica,sans-serif"&gt;-  &lt;span id="gmail-short_desc_nonedit_display"&gt;log \
error when &lt;bandwidth&gt; requested on a &lt;interface \
type='hostdev'&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;a \
href="https://bugzilla.redhat.com/show_bug.cgi?id=1524230" \
style="color:rgb(0,136,206);text-decoration-line:none;font-family:"Open \
Sans",Helvetica,sans-serif;outline:none"&gt;Bug  1524230&lt;/a&gt;&lt;span \
style="color:rgb(0,0,0);font-family:"Open \
Sans",Helvetica,sans-serif;background-color:rgb(208,208,208)"&gt;  &lt;/span&gt;&lt;span \
id="gmail-summary_container" style="color:rgb(0,0,0);font-family:"Open \
Sans",Helvetica,sans-serif"&gt;-  &lt;span \
id="gmail-short_desc_nonedit_display"&gt;vhostuser type interface do not support \
bandwidth, but no warning message&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="color:rgb(0,0,0);font-family:"Open \
Sans",Helvetica,sans-serif"&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="color:rgb(0,0,0);font-family:"Open \
Sans",Helvetica,sans-serif"&gt;&lt;span&gt;Thank you for looking into this and very \
appreciate your feedback!&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="color:rgb(0,0,0);font-family:"Open \
Sans",Helvetica,sans-serif"&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div \
dir="ltr" class="gmail_signature" data-smartmail="gmail_signature"&gt;&lt;div \
dir="ltr"&gt;&lt;div&gt;1. start vm with user type interface set with Qos:&lt;/div&gt;&lt;div&gt;  \
&lt;interface type='user'&gt;&lt;br&gt;         &lt;mac \
address='52:54:00:3e:ec:14'/&gt;&lt;br&gt;         &lt;bandwidth&gt;&lt;br&gt;            \
&lt;inbound average='1000' peak='5000' burst='5120'/&gt;&lt;br&gt;  \
&lt;outbound average='128' peak='256' burst='256'/&gt;&lt;br&gt;    \
&lt;/bandwidth&gt;&lt;br&gt;         &lt;model type='rtl8139'/&gt;&lt;br&gt;         \
&lt;address type='pci' domain='0x0000' bus='0x07' \
slot='0x01' function='0x0'/&gt;&lt;br&gt;      \
&lt;/interface&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;# cat /var/log/libvirt/libvirtd.log | grep \
bandwidth&lt;br&gt;2021-03-26 10:47:11.452+0000: 20185: warning : \
qemuBuildInterfaceCommandLine:8223 : setting bandwidth on interfaces of type \
'user' is not implemented yet&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;2. start with hostdev \
type interface with Qos setting:&lt;/div&gt;&lt;div&gt;&lt;interface type='hostdev' \
managed='yes'&gt;&lt;br&gt;         &lt;mac \
address='52:54:00:07:27:b0'/&gt;&lt;br&gt;         &lt;source&gt;&lt;br&gt;            \
&lt;address type='pci' domain='0x0000' bus='0x82' \
slot='0x10' function='0x6'/&gt;&lt;br&gt;         &lt;/source&gt;&lt;br&gt;       \
&lt;bandwidth&gt;&lt;br&gt;            &lt;inbound average='1000' \
peak='5000' burst='5120'/&gt;&lt;br&gt;            &lt;outbound \
average='128' peak='256' burst='256'/&gt;&lt;br&gt;         \
&lt;/bandwidth&gt;&lt;br&gt;         &lt;address type='pci' domain='0x0000' \
bus='0x01' slot='0x00' function='0x0'/&gt;&lt;br&gt;      \
&lt;/interface&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;# virsh start rh &lt;br&gt;error: Failed to \
start domain 'rh'&lt;br&gt;error: unsupported configuration: interface \
52:54:00:07:27:b0 - bandwidth settings are not supported for hostdev \
interfaces&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font color="#000000" face="Open Sans, Helvetica, \
sans-serif"&gt;&lt;span style="font-size:16.25px"&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;/font&gt;-------&lt;br&gt;Best \
Regards,&lt;br&gt;Yalan Zhang&lt;br&gt;IRC: \
yalzhang&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210327135321</emailId><senderName>Silvia Fichera</senderName><senderEmail>fichera.sil@gmail.com</senderEmail><timestampReceived>2021-03-27 13:53:21-0400</timestampReceived><subject>Packets dropped by virtual NICs</subject><body>

Hi all,
I want to use tc qdisc settings in a network coposed of several qemu VMs,
connected through bridges and tap interfaces.
I generate traffic with a spirent. Everything is fine when the scheduling
discipline is not installed but when I run the command to set taprio queues
traffic on the VM's NIC the traffic is dropped, i can send max 1mbps.
I think that there is something missing in the virtual NIC configuration or
setup. With ethtool i can see that queues are configured. I've also noticed
the BQL equals to 0, that is different than the physical machine
(BQL=18600) where everything works correctly.
I've read that it could be because NIC drivers do not support that setting.

Do you have any suggestions?

Thanks you all

Silvia

[Attachment #3 (text/html)]

&lt;div dir="auto"&gt;Hi all,&lt;div dir="auto"&gt;I want to use tc qdisc settings in a network \
coposed of several qemu VMs, connected through bridges and tap interfaces.  \
&lt;/div&gt;&lt;div dir="auto"&gt;I generate traffic with a spirent. Everything is fine when the \
scheduling discipline is not installed but when I run the command to set taprio \
queues traffic on the VM's NIC the traffic is dropped, i can send max 1mbps.  \
&lt;/div&gt;&lt;div dir="auto"&gt;I think that there is something missing in the virtual NIC \
configuration or setup. With ethtool i can see that queues are configured. I've \
also noticed the BQL equals to 0, that is different than the physical machine \
(BQL=18600) where everything works correctly.  &lt;/div&gt;&lt;div dir="auto"&gt;I've read \
that it could be because NIC drivers do not support that setting.  &lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;Do you have any suggestions?&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;Thanks you all&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;Silvia  &lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210329105837</emailId><senderName>"Lentes, Bernd"</senderName><senderEmail>bernd.lentes@helmholtz-muenchen.de</senderEmail><timestampReceived>2021-03-29 10:58:37-0400</timestampReceived><subject>how to check a virtual disk</subject><body>


Hi,

we have a two-node cluster with pacemaker a SAN.
The resources are inside virtual domains.
The images of the virtual disks reside on the SAN.
On one domain i have errors from the hd in my log:

2021-03-24T21:02:28.416504+01:00 geneious kernel: [2159685.909613] JBD2: Detected IO \
errors while flushing file data on dm-1-8 2021-03-24T21:02:46.505323+01:00 geneious \
kernel: [2159704.012213] JBD2: Detected IO errors while flushing file data on dm-1-8 \
2021-03-24T21:02:55.573149+01:00 geneious kernel: [2159713.078560] JBD2: Detected IO \
errors while flushing file data on dm-1-8 2021-03-24T21:03:23.702946+01:00 geneious \
kernel: [2159741.202546] JBD2: Detected IO errors while flushing file data on dm-1-8 \
2021-03-24T21:03:30.289606+01:00 geneious kernel: [2159747.796192] ------------[ cut \
here ]------------ 2021-03-24T21:03:30.289635+01:00 geneious kernel: [2159747.796207] \
WARNING: CPU: 0 PID: 457 at ../fs/buffer.c:1108 mark_buffer_dirty+0xe8/0x100 \
2021-03-24T21:03:30.289637+01:00 geneious kernel: [2159747.796208] Modules linked in: \
st sr_mod cdrom lp parport_pc ppdev parport xfrm_user xfrm_algo binfmt_misc uinput \
nf_log_ipv6 xt_comme nt nf_log_ipv4 nf_log_common xt_LOG xt_limit af_packet \
iscsi_ibft iscsi_boot_sysfs ip6t_REJECT nf_conntrack_ipv6 nf_defrag_ipv6 ipt_REJECT \
xt_pkttype xt_tcpudp iptable_filter ip6table_mangl e nf_conntrack_netbios_ns \
nf_conntrack_broadcast nf_conntrack_ipv4 nf_defrag_ipv4 ip_tables xt_conntrack \
nf_conntrack libcrc32c ip6table_filter ip6_tables x_tables joydev virtio_net net_fai \
lover failover virtio_balloon i2c_piix4 qemu_fw_cfg pcspkr button ext4 crc16 jbd2 \
mbcache ata_generic hid_generic usbhid ata_piix sd_mod virtio_rng ahci floppy libahci \
serio_raw ehci_pci bo chs_drm drm_kms_helper syscopyarea sysfillrect sysimgblt \
fb_sys_fops ttm drm uhci_hcd ehci_hcd usbcore virtio_pci \
2021-03-24T21:03:30.289637+01:00 geneious kernel: [2159747.796374]  \
drm_panel_orientation_quirks libata dm_mirror dm_region_hash dm_log sg dm_multipath \
dm_mod scsi_dh_rdac scsi_dh_emc scsi_ dh_alua scsi_mod autofs4 [last unloaded: \
parport_pc] 2021-03-24T21:03:30.289643+01:00 geneious kernel: [2159747.796400] \
Supported: Yes 2021-03-24T21:03:30.289644+01:00 geneious kernel: [2159747.796405] \
CPU: 0 PID: 457 Comm: jbd2/dm-0-8 Not tainted 4.12.14-122.57-default #1 SLE12-SP5 \
2021-03-24T21:03:30.289644+01:00 geneious kernel: [2159747.796406] Hardware name: \
QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.12.0-0-ga698c89-rebuilt.suse.com \
04/01/2014 2021-03-24T21:03:30.289645+01:00 geneious kernel: [2159747.796407] task: \
ffff8ba32766c380 task.stack: ffff99954124c000 2021-03-24T21:03:30.289645+01:00 \
geneious kernel: [2159747.796409] RIP: 0010:mark_buffer_dirty+0xe8/0x100 \
2021-03-24T21:03:30.289646+01:00 geneious kernel: [2159747.796409] RSP: \
0018:ffff99954124fcf0 EFLAGS: 00010246 2021-03-24T21:03:30.289650+01:00 geneious \
kernel: [2159747.796413] RAX: 0000000000a20828 RBX: ffff8ba209a58d90 RCX: \
ffff8ba3292d7958 2021-03-24T21:03:30.289651+01:00 geneious kernel: [2159747.796413] \
RDX: ffff8ba209a585b0 RSI: ffff8ba24270b690 RDI: ffff8ba3292d7958 \
2021-03-24T21:03:30.289652+01:00 geneious kernel: [2159747.796414] RBP: \
ffff8ba3292d7958 R08: ffff8ba209a585b0 R09: 0000000000000001 \
2021-03-24T21:03:30.289652+01:00 geneious kernel: [2159747.796415] R10: \
ffff8ba328c1c0b0 R11: ffff8ba287805380 R12: ffff8ba3292d795a \
2021-03-24T21:03:30.289653+01:00 geneious kernel: [2159747.796415] R13: \
0000000000000000 R14: ffff8ba3292d7958 R15: ffff8ba209a58d90 \
2021-03-24T21:03:30.289653+01:00 geneious kernel: [2159747.796417] FS:  \
0000000000000000(0000) GS:ffff8ba333c00000(0000) knlGS:0000000000000000 \
2021-03-24T21:03:30.289654+01:00 geneious kernel: [2159747.796417] CS:  0010 DS: 0000 \
ES: 0000 CR0: 0000000080050033 2021-03-24T21:03:30.289654+01:00 geneious kernel: \
[2159747.796418] CR2: 0000000099bff000 CR3: 0000000101b06000 CR4: 00000000000006f0 \
2021-03-24T21:03:30.289655+01:00 geneious kernel: [2159747.796424] Call Trace: \
2021-03-24T21:03:30.289656+01:00 geneious kernel: [2159747.796470]  \
__jbd2_journal_refile_buffer+0xbb/0xe0 [jbd2] 2021-03-24T21:03:30.289656+01:00 \
geneious kernel: [2159747.796479]  jbd2_journal_commit_transaction+0xf1a/0x1870 \
[jbd2] 2021-03-24T21:03:30.289657+01:00 geneious kernel: [2159747.796489]  ? \
__switch_to_asm+0x41/0x70 2021-03-24T21:03:30.289658+01:00 geneious kernel: \
[2159747.796490]  ? __switch_to_asm+0x35/0x70 2021-03-24T21:03:30.289662+01:00 \
geneious kernel: [2159747.796493]  kjournald2+0xbb/0x230 [jbd2] \
2021-03-24T21:03:30.289663+01:00 geneious kernel: [2159747.796499]  ? \
wait_woken+0x80/0x80 2021-03-24T21:03:30.289663+01:00 geneious kernel: \
[2159747.796503]  kthread+0xf6/0x130 2021-03-24T21:03:30.289664+01:00 geneious \
kernel: [2159747.796508]  ? commit_timeout+0x10/0x10 [jbd2] \
2021-03-24T21:03:30.289664+01:00 geneious kernel: [2159747.796510]  ? \
kthread_bind+0x10/0x10 2021-03-24T21:03:30.289665+01:00 geneious kernel: \
[2159747.796511]  ret_from_fork+0x35/0x40 2021-03-24T21:03:30.289665+01:00 geneious \
kernel: [2159747.796517] Code: 1b 48 8b 03 48 8b 7b 08 48 83 c3 18 48 89 ee e8 bf 42 \
76 00 48 8b 03 48 85 c0 75 e8 e9 3c ff ff ff 48 89 df 5b 5d e9  c8 35 fb ff &lt;0f&gt; 0b \
e9 26 ff ff ff 48 83 e8 01 e9 5b ff ff ff 0f 1f 84 00 00 \
2021-03-24T21:03:30.289670+01:00 geneious kernel: [2159747.796533] ---[ end trace \
db796891c8ff94af ]--- 2021-03-24T21:03:46.593225+01:00 geneious kernel: \
[2159764.100145] JBD2: Detected IO errors while flushing file data on dm-1-8 \
2021-03-24T21:05:09.372772+01:00 geneious kernel: [2159846.877201] JBD2: Detected IO \
errors while flushing file data on dm-1-8 2021-03-24T21:06:39.943519+01:00 geneious \
kernel: [2159937.381068] JBD2: Detected IO errors while flushing file data on dm-1-8 \
2021-03-24T21:07:42.364311+01:00 geneious kernel: [2159999.793805] JBD2: Detected IO \
errors while flushing file data on dm-1-8 2021-03-24T21:07:57.822133+01:00 geneious \
kernel: [2160015.291776] JBD2: Detected IO errors while flushing file data on dm-1-8

First i'm wondering: what is dm-1-8 ?
I don't have a device like that.

geneious:~ # find /dev -iname '*dm*'
/dev/dm-1
/dev/dm-0
/dev/disk/by-id/dm-uuid-LVM-a9Cy1cweHgXlAEECqZL5KZBfnuigUG6lq0ntdZJxxLIIp5G8XihsuYrTbx7Rs0vc
                
/dev/disk/by-id/dm-name-vg_local-lv_var
/dev/disk/by-id/dm-uuid-LVM-a9Cy1cweHgXlAEECqZL5KZBfnuigUG6l3fdsOpBFoDWral3Fa7c6ZeYECmLd6FFj
                
/dev/disk/by-id/dm-name-vg_local-lv_root
/dev/cpu_dma_latency

I just find /proc/fs/jbd2/dm-1-8.
There is a file /proc/fs/jbd2/dm-1-8/info:
453005 transactions (319055 requested), each up to 8192 blocks
average:
  0ms waiting for transaction
  12ms request delay
  5124ms running transaction
  0ms transaction was being locked
  0ms flushing data (in ordered mode)
  44ms logging transaction
  8031us average transaction commit time
  64 handles per transaction
  5 blocks per transaction
  6 logged blocks per transaction

What is that ?

The logfile says also something about dm-0-8:
2021-03-24T21:03:30.289644+01:00 geneious kernel: [2159747.796405] CPU: 0 PID: 457 \
Comm: jbd2/dm-0-8 Not tainted 4.12.14-122.57-default #1 SLE12-SP5

geneious:~ # find / -iname dm-0-8
/proc/fs/jbd2/dm-0-8
geneious:~ # ll /proc/fs/jbd2/dm-0-8
total 0
-r--r--r-- 1 root root 0 Mar 29 12:56 info
geneious:~ # cat /proc/fs/jbd2/dm-0-8/info
7356 transactions (556 requested), each up to 8192 blocks
average:
  0ms waiting for transaction
  20ms request delay
  5628ms running transaction
  4ms transaction was being locked
  0ms flushing data (in ordered mode)
  132ms logging transaction
  134769us average transaction commit time
  52 handles per transaction
  18 blocks per transaction
  19 logged blocks per transaction
geneious:~ #


I assume i have a harddisk problem. I'm checking currently the SAN with its own \
tools, via a web interface. Afterwards i want to stop the domain, boot it with a live \
cd and run badblocks and fsck.ext3. What else can i do ?

Bernd





-- 

Bernd Lentes 
System Administrator 
Institute for Metabolism and Cell Death (MCD) 
Building 25 - office 122 
HelmholtzZentrum München 
bernd.lentes@helmholtz-muenchen.de 
phone: +49 89 3187 1241 
phone: +49 89 3187 3827 
fax: +49 89 3187 2294 
http://www.helmholtz-muenchen.de/mcd 


Public key: 

30 82 01 0a 02 82 01 01 00 b3 72 3e ce 2c 0a 6f 58 49 2c 92 23 c7 b9 c1 ff 6c 3a 53 \
be f7 9e e9 24 b7 49 fa 3c e8 de 28 85 2c d3 ed f7 70 03 3f 4d 82 fc cc 96 4f 18 27 \
1f df 25 b3 13 00 db 4b 1d ec 7f 1b cf f9 cd e8 5b 1f 11 b3 a7 48 f8 c8 37 ed 41 ff \
18 9f d7 83 51 a9 bd 86 c2 32 b3 d6 2d 77 ff 32 83 92 67 9e ae ae 9c 99 ce 42 27 6f \
bf d8 c2 a1 54 fd 2b 6b 12 65 0e 8a 79 56 be 53 89 70 51 02 6a eb 76 b8 92 25 2d 88 \
aa 57 08 42 ef 57 fb fe 00 71 8e 90 ef b2 e3 22 f3 34 4f 7b f1 c4 b1 7c 2f 1d 6f bd \
c8 a6 a1 1f 25 f3 e4 4b 6a 23 d3 d2 fa 27 ae 97 80 a3 f0 5a c4 50 4a 45 e3 45 4d 82 \
9f 8b 87 90 d0 f9 92 2d a7 d2 67 53 e6 ae 1e 72 3e e9 e0 c9 d3 1c 23 e0 75 78 4a 45 \
60 94 f8 e3 03 0b 09 85 08 d0 6c f3 ff ce fa 50 25 d9 da 81 7b 2a dc 9e 28 8b 83 04 \
b4 0a 9f 37 b8 ac 58 f1 38 43 0e 72 af 02 03 01 00 01


["smime.p7s" (application/pkcs7-signature)]

</body></email><email><emailId>20210329140029</emailId><senderName>"Lentes, Bernd"</senderName><senderEmail>bernd.lentes@helmholtz-muenchen.de</senderEmail><timestampReceived>2021-03-29 14:00:29-0400</timestampReceived><subject>virsh dommemstat doesn't update its information</subject><body>


Hi,

i'm playing a bit around with my domains and the balloon driver.
To get information about ballooning i use virsh dommemstat.
But i only get very few information:

virsh # dommemstat vm_idcc_devel
actual 1044480
last_update 0
rss 1030144

Also configuring "dommemstat --domain vm_idcc_devel --period 5 --live"
or "dommemstat --domain vm_idcc_devel --period 5 --current" does neither update nor \
extend the information.

In vm_idcc_devel virtio_balloon is loaded:
idcc-devel:~ # lsmod|grep balloon
virtio_balloon         22788  0

Guest OS is SLES 10 SP4. Is that too old ?
Host OS is SLES 12 SP5.
There are other domains in which the information is updated.
Here is the config from vm_idcc_devel:

virsh # dumpxml vm_idcc_devel
&lt;domain type='kvm' id='7'&gt;
  &lt;name&gt;vm_idcc_devel&lt;/name&gt;
  &lt;uuid&gt;4993009b-42ff-45d9-b1e0-145b8c0c8f82&lt;/uuid&gt;
  &lt;memory unit='KiB'&gt;2044928&lt;/memory&gt;
  &lt;currentMemory unit='KiB'&gt;1044480&lt;/currentMemory&gt;
  &lt;vcpu placement='static'&gt;1&lt;/vcpu&gt;
  &lt;resource&gt;
    &lt;partition&gt;/machine&lt;/partition&gt;
  &lt;/resource&gt;
  &lt;os&gt;
    &lt;type arch='x86_64' machine='pc-i440fx-1.4'&gt;hvm&lt;/type&gt;
    &lt;boot dev='hd'/&gt;
    &lt;boot dev='cdrom'/&gt;
    &lt;bootmenu enable='yes'/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
    &lt;apic/&gt;
  &lt;/features&gt;
  &lt;clock offset='localtime'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;destroy&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/bin/qemu-kvm&lt;/emulator&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;driver name='qemu' type='raw' cache='none'/&gt;
      &lt;source file='/mnt/ocfs2/vm_idcc_devel.raw'/&gt;
      &lt;backingStore/&gt;
      &lt;target dev='vdb' bus='ide'/&gt;
      &lt;alias name='ide0-0-0'/&gt;
      &lt;address type='drive' controller='0' bus='0' target='0' unit='0'/&gt;
    &lt;/disk&gt;
    &lt;disk type='file' device='cdrom'&gt;
      &lt;driver name='qemu'/&gt;
      &lt;target dev='hdc' bus='ide'/&gt;
      &lt;readonly/&gt;
      &lt;alias name='ide0-1-0'/&gt;
      &lt;address type='drive' controller='0' bus='1' target='0' unit='0'/&gt;
    &lt;/disk&gt;
    &lt;controller type='usb' index='0' model='piix3-uhci'&gt;
      &lt;alias name='usb'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x01' function='0x2'/&gt;
    &lt;/controller&gt;
    &lt;controller type='pci' index='0' model='pci-root'&gt;
      &lt;alias name='pci.0'/&gt;
    &lt;/controller&gt;
    &lt;controller type='ide' index='0'&gt;
      &lt;alias name='ide'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x01' function='0x1'/&gt;
    &lt;/controller&gt;
    &lt;interface type='bridge'&gt;
      &lt;mac address='52:54:00:37:92:05'/&gt;
      &lt;source bridge='br0'/&gt;
      &lt;target dev='vnet6'/&gt;
      &lt;model type='rtl8139'/&gt;
      &lt;alias name='net0'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03' function='0x0'/&gt;
    &lt;/interface&gt;
    &lt;serial type='pty'&gt;
      &lt;source path='/dev/pts/6'/&gt;
      &lt;target type='isa-serial' port='0'&gt;
        &lt;model name='isa-serial'/&gt;
      &lt;/target&gt;
      &lt;alias name='serial0'/&gt;
    &lt;/serial&gt;
    &lt;console type='pty' tty='/dev/pts/6'&gt;
      &lt;source path='/dev/pts/6'/&gt;
      &lt;target type='serial' port='0'/&gt;
      &lt;alias name='serial0'/&gt;
    &lt;/console&gt;
    &lt;input type='mouse' bus='ps2'&gt;
      &lt;alias name='input0'/&gt;
    &lt;/input&gt;
    &lt;input type='keyboard' bus='ps2'&gt;
      &lt;alias name='input1'/&gt;
    &lt;/input&gt;
    &lt;graphics type='vnc' port='5902' autoport='no' listen='127.0.0.1'&gt;
      &lt;listen type='address' address='127.0.0.1'/&gt;
    &lt;/graphics&gt;
    &lt;video&gt;
      &lt;model type='cirrus' vram='16384' heads='1' primary='yes'/&gt;
      &lt;alias name='video0'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x02' function='0x0'/&gt;
    &lt;/video&gt;
    &lt;memballoon model='virtio'&gt;
      &lt;stats period='5'/&gt;
      &lt;alias name='balloon0'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x04' function='0x0'/&gt;
    &lt;/memballoon&gt;
  &lt;/devices&gt;
&lt;/domain&gt;



Bernd


-- 

Bernd Lentes 
System Administrator 
Institute for Metabolism and Cell Death (MCD) 
Building 25 - office 122 
HelmholtzZentrum München 
bernd.lentes@helmholtz-muenchen.de 
phone: +49 89 3187 1241 
phone: +49 89 3187 3827 
fax: +49 89 3187 2294 
http://www.helmholtz-muenchen.de/mcd 


Public key: 

30 82 01 0a 02 82 01 01 00 b3 72 3e ce 2c 0a 6f 58 49 2c 92 23 c7 b9 c1 ff 6c 3a 53 \
be f7 9e e9 24 b7 49 fa 3c e8 de 28 85 2c d3 ed f7 70 03 3f 4d 82 fc cc 96 4f 18 27 \
1f df 25 b3 13 00 db 4b 1d ec 7f 1b cf f9 cd e8 5b 1f 11 b3 a7 48 f8 c8 37 ed 41 ff \
18 9f d7 83 51 a9 bd 86 c2 32 b3 d6 2d 77 ff 32 83 92 67 9e ae ae 9c 99 ce 42 27 6f \
bf d8 c2 a1 54 fd 2b 6b 12 65 0e 8a 79 56 be 53 89 70 51 02 6a eb 76 b8 92 25 2d 88 \
aa 57 08 42 ef 57 fb fe 00 71 8e 90 ef b2 e3 22 f3 34 4f 7b f1 c4 b1 7c 2f 1d 6f bd \
c8 a6 a1 1f 25 f3 e4 4b 6a 23 d3 d2 fa 27 ae 97 80 a3 f0 5a c4 50 4a 45 e3 45 4d 82 \
9f 8b 87 90 d0 f9 92 2d a7 d2 67 53 e6 ae 1e 72 3e e9 e0 c9 d3 1c 23 e0 75 78 4a 45 \
60 94 f8 e3 03 0b 09 85 08 d0 6c f3 ff ce fa 50 25 d9 da 81 7b 2a dc 9e 28 8b 83 04 \
b4 0a 9f 37 b8 ac 58 f1 38 43 0e 72 af 02 03 01 00 01


["smime.p7s" (application/pkcs7-signature)]

</body></email><email><emailId>20210331055005</emailId><senderName>shafnamol N</senderName><senderEmail>shafnamol29@gmail.com</senderEmail><timestampReceived>2021-03-31 05:50:05-0400</timestampReceived><subject>Regarding location of Libvirt library</subject><body>

Hi,
I have installed Libvirt 7.1.0.
I configured and built libvirt based on instructions from
https://libvirt.org/compiling.html.
Now I developed a client program to create a VM using an XML file.As the
API for it is *virDomainCreateXML,* called this API by passing XML file .It
shows the following error.
undefined reference to `virDomainCreateXML'.
I included the header files containing the said API declaration.But need to
include the library also.
My question is where do the libvirt library located after building it.
Thanks for the help in advance.

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div&gt;Hi,&lt;/div&gt;&lt;div&gt;&lt;div&gt;I have installed Libvirt 7.1.0.&lt;/div&gt;&lt;div&gt;I \
configured and built libvirt based on instructions from&lt;/div&gt;&lt;div&gt;&lt;a \
href="https://libvirt.org/compiling.html" \
target="_blank"&gt;https://libvirt.org/compiling.html&lt;/a&gt;.&lt;/div&gt;&lt;div&gt;Now I developed a \
client program to create a VM using an XML file.As the API for it is \
&lt;b&gt;virDomainCreateXML,&lt;/b&gt; called this API by passing XML file .It shows the \
following error.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style="font-family:comic sans \
ms,sans-serif"&gt;&lt;font size="2"&gt;undefined reference to \
`virDomainCreateXML'.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;I included the header files \
containing the said API declaration.But need to include the library \
also.&lt;br&gt;&lt;/div&gt;&lt;div&gt;My question is where do the libvirt library located after \
building it.&lt;/div&gt;&lt;div&gt;Thanks for the help in advance.&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210331150129</emailId><senderName>Michal Privoznik</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-03-31 15:01:29-0400</timestampReceived><subject>Re: Regarding location of Libvirt library</subject><body>

On 3/31/21 7:38 AM, shafnamol N wrote:
&gt; Hi,
&gt; I have installed Libvirt 7.1.0.
&gt; I configured and built libvirt based on instructions from
&gt; https://libvirt.org/compiling.html &lt;https://libvirt.org/compiling.html&gt;.
&gt; Now I developed a client program to create a VM using an XML file.As the 
&gt; API for it is *virDomainCreateXML,* called this API by passing XML file 
&gt; .It shows the following error.
&gt; undefined reference to `virDomainCreateXML'.
&gt; I included the header files containing the said API declaration.But need 
&gt; to include the library also.
&gt; My question is where do the libvirt library located after building it.

Yes, you need to pass -lvirt when linking. The library is installed 
wherever you told it to install. If you ran plain meson with no extra 
arguments, then 'meson install' installs library under /usr/local/lib/ 
or /usr/local/lib64/. So you will need to pass -L/usr/local/lib or 
-L/usr/local/lib64 too to the linker.

But there is this switch -Dsystem=true which tells meson to install into 
system directories:

   meson -Dsystem=true build
   meson install -C build

with this you will not need to pass any extra -L arguments to the linker.

Michal

</body></email><email><emailId>20210406082422</emailId><senderName>Andrea Bolognani</senderName><senderEmail>abologna@redhat.com</senderEmail><timestampReceived>2021-04-06 08:24:22-0400</timestampReceived><subject>Re: Regarding location of Libvirt library</subject><body>

[please keep replies on-list]

On Mon, 2021-04-05 at 12:03 +0530, shafnamol N wrote:
&gt; Hi,
&gt; I have build libvirt in the following method:
&gt; $ meson build -Dsystem=true
&gt; $ ninja -C build
&gt; When i tried to get the information via
&gt; 
&gt; $pkg-config --cflags --libs libvirt
&gt; 
&gt; it doesnt show anything.
&gt; 
&gt; But I tried
&gt; $ninja -C build install
&gt; 
&gt; and then
&gt; $pkg-config --cflags --libs libvirt
&gt; It shows like:
&gt; libvirt-7.1.0]# pkg-config --cflags --libs libvirt
&gt; -lvirt 

This is expected: pkg-config can't find the libvirt.pc file until
you've installed it :)

&gt; But the problem is when i tried to get the status of libvirt
&gt; 
&gt; # systemctl status libvirtd
&gt; ● libvirtd.service
&gt;    Loaded: not-found (Reason: Unit libvirtd.service not found.)
&gt;    Active: failed (Result: exit-code) 
&gt; 
&gt; I tried with 
&gt; # systemctl daemon-reload
&gt; But the problem persists.. 
&gt; what will be the problem...

What does running

  $ ls /usr/lib/systemd/system/*virt*

output?

What does the

    Miscellaneous
            ...
            Init script: XXX

entry look like in the summary that's displayed when you run Meson?

What OS are you using?

-- 
Andrea Bolognani / Red Hat / Virtualization

</body></email><email><emailId>20210407082756</emailId><senderName>Andrea Bolognani</senderName><senderEmail>abologna@redhat.com</senderEmail><timestampReceived>2021-04-07 08:27:56-0400</timestampReceived><subject>Re: Regarding location of Libvirt library</subject><body>

[once again, please keep replies on-list]

On Wed, 2021-04-07 at 10:46 +0530, shafnamol N wrote:
&gt; &gt; What does running
&gt; &gt; 
&gt; &gt;   $ ls /usr/lib/systemd/system/*virt*
&gt; &gt; 
&gt; &gt; output?
&gt; 
&gt; The output is as shown below:
&gt; 
&gt; # ls /usr/lib/systemd/system/*virt*
&gt; /usr/lib/systemd/system/libvirtd-admin.socket        /usr/lib/systemd/system/virtnodedevd.service
&gt; /usr/lib/systemd/system/libvirtd-ro.socket           /usr/lib/systemd/system/virtnodedevd.socket
&gt; /usr/lib/systemd/system/libvirtd.service             /usr/lib/systemd/system/virtnwfilterd-admin.socket
&gt; /usr/lib/systemd/system/libvirtd.service_backup      /usr/lib/systemd/system/virtnwfilterd-ro.socket
&gt; /usr/lib/systemd/system/libvirtd.socket              /usr/lib/systemd/system/virtnwfilterd.service
&gt; /usr/lib/systemd/system/libvirtd-tcp.socket          /usr/lib/systemd/system/virtnwfilterd.socket
&gt; /usr/lib/systemd/system/libvirtd-tls.socket          /usr/lib/systemd/system/virtproxyd-admin.socket
&gt; /usr/lib/systemd/system/libvirt-guests.service       /usr/lib/systemd/system/virtproxyd-ro.socket
&gt; /usr/lib/systemd/system/virt-guest-shutdown.target   /usr/lib/systemd/system/virtproxyd.service
&gt; /usr/lib/systemd/system/virtinterfaced-admin.socket  /usr/lib/systemd/system/virtproxyd.socket
&gt; /usr/lib/systemd/system/virtinterfaced-ro.socket     /usr/lib/systemd/system/virtproxyd-tcp.socket
&gt; /usr/lib/systemd/system/virtinterfaced.service       /usr/lib/systemd/system/virtproxyd-tls.socket
&gt; /usr/lib/systemd/system/virtinterfaced.socket        /usr/lib/systemd/system/virtqemud-admin.socket
&gt; /usr/lib/systemd/system/virtlockd-admin.socket       /usr/lib/systemd/system/virtqemud-ro.socket
&gt; /usr/lib/systemd/system/virtlockd.service            /usr/lib/systemd/system/virtqemud.service
&gt; /usr/lib/systemd/system/virtlockd.socket             /usr/lib/systemd/system/virtqemud.socket
&gt; /usr/lib/systemd/system/virtlogd-admin.socket        /usr/lib/systemd/system/virtsecretd-admin.socket
&gt; /usr/lib/systemd/system/virtlogd.service             /usr/lib/systemd/system/virtsecretd-ro.socket
&gt; /usr/lib/systemd/system/virtlogd.socket              /usr/lib/systemd/system/virtsecretd.service
&gt; /usr/lib/systemd/system/virtlxcd-admin.socket        /usr/lib/systemd/system/virtsecretd.socket
&gt; /usr/lib/systemd/system/virtlxcd-ro.socket           /usr/lib/systemd/system/virtstoraged-admin.socket
&gt; /usr/lib/systemd/system/virtlxcd.service             /usr/lib/systemd/system/virtstoraged-ro.socket
&gt; /usr/lib/systemd/system/virtlxcd.socket              /usr/lib/systemd/system/virtstoraged.service
&gt; /usr/lib/systemd/system/virtnetworkd-admin.socket    /usr/lib/systemd/system/virtstoraged.socket
&gt; /usr/lib/systemd/system/virtnetworkd-ro.socket       /usr/lib/systemd/system/virtvboxd-admin.socket
&gt; /usr/lib/systemd/system/virtnetworkd.service         /usr/lib/systemd/system/virtvboxd-ro.socket
&gt; /usr/lib/systemd/system/virtnetworkd.socket          /usr/lib/systemd/system/virtvboxd.service
&gt; /usr/lib/systemd/system/virtnodedevd-admin.socket    /usr/lib/systemd/system/virtvboxd.socket
&gt; /usr/lib/systemd/system/virtnodedevd-ro.socket

libvirtd.service_backup should not be there, but I don't think that's
what causing your problem. I would still recommend deleting it just
in case.

&gt; &gt; What OS are you using?
&gt; 
&gt; Centos 8
&gt; 
&gt; &gt; What does the
&gt; &gt; 
&gt; &gt;     Miscellaneous
&gt; &gt;             ...
&gt; &gt;             Init script: XXX
&gt; &gt; 
&gt; &gt; entry look like in the summary that's displayed when you run Meson?
&gt; 
&gt; Miscellaneous
&gt;     Init script        : systemd

These all look good, so I really have no idea what's going on.
Hopefully someone else on the list will be able to help you!
Good luck :)

-- 
Andrea Bolognani / Red Hat / Virtualization

</body></email><email><emailId>20210329115911</emailId><senderName>"Lentes, Bernd"</senderName><senderEmail>bernd.lentes@helmholtz-muenchen.de</senderEmail><timestampReceived>2021-03-29 11:59:11-0400</timestampReceived><subject>Re: how to check a virtual disk</subject><body>


----- On Mar 29, 2021, at 12:58 PM, Bernd Lentes bernd.lentes@helmholtz-muenchen.de wrote:

&gt; Hi,
&gt; 
&gt; we have a two-node cluster with pacemaker a SAN.
&gt; The resources are inside virtual domains.
&gt; The images of the virtual disks reside on the SAN.
&gt; On one domain i have errors from the hd in my log:
&gt; 
&gt; 2021-03-24T21:02:28.416504+01:00 geneious kernel: [2159685.909613] JBD2:
&gt; Detected IO errors while flushing file data on dm-1-8
&gt; 2021-03-24T21:02:46.505323+01:00 geneious kernel: [2159704.012213] JBD2:
&gt; Detected IO errors while flushing file data on dm-1-8
&gt; 2021-03-24T21:02:55.573149+01:00 geneious kernel: [2159713.078560] JBD2:
&gt; Detected IO errors while flushing file data on dm-1-8
&gt; 2021-03-24T21:03:23.702946+01:00 geneious kernel: [2159741.202546] JBD2:
&gt; Detected IO errors while flushing file data on dm-1-8
&gt; 2021-03-24T21:03:30.289606+01:00 geneious kernel: [2159747.796192] ------------[
&gt; cut here ]------------
&gt; 2021-03-24T21:03:30.289635+01:00 geneious kernel: [2159747.796207] WARNING: CPU:
&gt; 0 PID: 457 at ../fs/buffer.c:1108 mark_buffer_dirty+0xe8/0x100
&gt; 2021-03-24T21:03:30.289637+01:00 geneious kernel: [2159747.796208] Modules
&gt; linked in: st sr_mod cdrom lp parport_pc ppdev parport xfrm_user xfrm_algo
&gt; binfmt_misc uinput nf_log_ipv6 xt_comme
&gt; nt nf_log_ipv4 nf_log_common xt_LOG xt_limit af_packet iscsi_ibft
&gt; iscsi_boot_sysfs ip6t_REJECT nf_conntrack_ipv6 nf_defrag_ipv6 ipt_REJECT
&gt; xt_pkttype xt_tcpudp iptable_filter ip6table_mangl
&gt; e nf_conntrack_netbios_ns nf_conntrack_broadcast nf_conntrack_ipv4
&gt; nf_defrag_ipv4 ip_tables xt_conntrack nf_conntrack libcrc32c ip6table_filter
&gt; ip6_tables x_tables joydev virtio_net net_fai
&gt; lover failover virtio_balloon i2c_piix4 qemu_fw_cfg pcspkr button ext4 crc16
&gt; jbd2 mbcache ata_generic hid_generic usbhid ata_piix sd_mod virtio_rng ahci
&gt; floppy libahci serio_raw ehci_pci bo
&gt; chs_drm drm_kms_helper syscopyarea sysfillrect sysimgblt fb_sys_fops ttm drm
&gt; uhci_hcd ehci_hcd usbcore virtio_pci
&gt; 2021-03-24T21:03:30.289637+01:00 geneious kernel: [2159747.796374]
&gt; drm_panel_orientation_quirks libata dm_mirror dm_region_hash dm_log sg
&gt; dm_multipath dm_mod scsi_dh_rdac scsi_dh_emc scsi_
&gt; dh_alua scsi_mod autofs4 [last unloaded: parport_pc]
&gt; 2021-03-24T21:03:30.289643+01:00 geneious kernel: [2159747.796400] Supported:
&gt; Yes
&gt; 2021-03-24T21:03:30.289644+01:00 geneious kernel: [2159747.796405] CPU: 0 PID:
&gt; 457 Comm: jbd2/dm-0-8 Not tainted 4.12.14-122.57-default #1 SLE12-SP5
&gt; 2021-03-24T21:03:30.289644+01:00 geneious kernel: [2159747.796406] Hardware
&gt; name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS
&gt; rel-1.12.0-0-ga698c89-rebuilt.suse.com 04/01/2014
&gt; 2021-03-24T21:03:30.289645+01:00 geneious kernel: [2159747.796407] task:
&gt; ffff8ba32766c380 task.stack: ffff99954124c000
&gt; 2021-03-24T21:03:30.289645+01:00 geneious kernel: [2159747.796409] RIP:
&gt; 0010:mark_buffer_dirty+0xe8/0x100
&gt; 2021-03-24T21:03:30.289646+01:00 geneious kernel: [2159747.796409] RSP:
&gt; 0018:ffff99954124fcf0 EFLAGS: 00010246
&gt; 2021-03-24T21:03:30.289650+01:00 geneious kernel: [2159747.796413] RAX:
&gt; 0000000000a20828 RBX: ffff8ba209a58d90 RCX: ffff8ba3292d7958
&gt; 2021-03-24T21:03:30.289651+01:00 geneious kernel: [2159747.796413] RDX:
&gt; ffff8ba209a585b0 RSI: ffff8ba24270b690 RDI: ffff8ba3292d7958
&gt; 2021-03-24T21:03:30.289652+01:00 geneious kernel: [2159747.796414] RBP:
&gt; ffff8ba3292d7958 R08: ffff8ba209a585b0 R09: 0000000000000001
&gt; 2021-03-24T21:03:30.289652+01:00 geneious kernel: [2159747.796415] R10:
&gt; ffff8ba328c1c0b0 R11: ffff8ba287805380 R12: ffff8ba3292d795a
&gt; 2021-03-24T21:03:30.289653+01:00 geneious kernel: [2159747.796415] R13:
&gt; 0000000000000000 R14: ffff8ba3292d7958 R15: ffff8ba209a58d90
&gt; 2021-03-24T21:03:30.289653+01:00 geneious kernel: [2159747.796417] FS:
&gt; 0000000000000000(0000) GS:ffff8ba333c00000(0000) knlGS:0000000000000000
&gt; 2021-03-24T21:03:30.289654+01:00 geneious kernel: [2159747.796417] CS:  0010 DS:
&gt; 0000 ES: 0000 CR0: 0000000080050033
&gt; 2021-03-24T21:03:30.289654+01:00 geneious kernel: [2159747.796418] CR2:
&gt; 0000000099bff000 CR3: 0000000101b06000 CR4: 00000000000006f0
&gt; 2021-03-24T21:03:30.289655+01:00 geneious kernel: [2159747.796424] Call Trace:
&gt; 2021-03-24T21:03:30.289656+01:00 geneious kernel: [2159747.796470]
&gt; __jbd2_journal_refile_buffer+0xbb/0xe0 [jbd2]
&gt; 2021-03-24T21:03:30.289656+01:00 geneious kernel: [2159747.796479]
&gt; jbd2_journal_commit_transaction+0xf1a/0x1870 [jbd2]
&gt; 2021-03-24T21:03:30.289657+01:00 geneious kernel: [2159747.796489]  ?
&gt; __switch_to_asm+0x41/0x70
&gt; 2021-03-24T21:03:30.289658+01:00 geneious kernel: [2159747.796490]  ?
&gt; __switch_to_asm+0x35/0x70
&gt; 2021-03-24T21:03:30.289662+01:00 geneious kernel: [2159747.796493]
&gt; kjournald2+0xbb/0x230 [jbd2]
&gt; 2021-03-24T21:03:30.289663+01:00 geneious kernel: [2159747.796499]  ?
&gt; wait_woken+0x80/0x80
&gt; 2021-03-24T21:03:30.289663+01:00 geneious kernel: [2159747.796503]
&gt; kthread+0xf6/0x130
&gt; 2021-03-24T21:03:30.289664+01:00 geneious kernel: [2159747.796508]  ?
&gt; commit_timeout+0x10/0x10 [jbd2]
&gt; 2021-03-24T21:03:30.289664+01:00 geneious kernel: [2159747.796510]  ?
&gt; kthread_bind+0x10/0x10
&gt; 2021-03-24T21:03:30.289665+01:00 geneious kernel: [2159747.796511]
&gt; ret_from_fork+0x35/0x40
&gt; 2021-03-24T21:03:30.289665+01:00 geneious kernel: [2159747.796517] Code: 1b 48
&gt; 8b 03 48 8b 7b 08 48 83 c3 18 48 89 ee e8 bf 42 76 00 48 8b 03 48 85 c0 75 e8
&gt; e9 3c ff ff ff 48 89 df 5b 5d e9
&gt; c8 35 fb ff &lt;0f&gt; 0b e9 26 ff ff ff 48 83 e8 01 e9 5b ff ff ff 0f 1f 84 00 00
&gt; 2021-03-24T21:03:30.289670+01:00 geneious kernel: [2159747.796533] ---[ end
&gt; trace db796891c8ff94af ]---
&gt; 2021-03-24T21:03:46.593225+01:00 geneious kernel: [2159764.100145] JBD2:
&gt; Detected IO errors while flushing file data on dm-1-8
&gt; 2021-03-24T21:05:09.372772+01:00 geneious kernel: [2159846.877201] JBD2:
&gt; Detected IO errors while flushing file data on dm-1-8
&gt; 2021-03-24T21:06:39.943519+01:00 geneious kernel: [2159937.381068] JBD2:
&gt; Detected IO errors while flushing file data on dm-1-8
&gt; 2021-03-24T21:07:42.364311+01:00 geneious kernel: [2159999.793805] JBD2:
&gt; Detected IO errors while flushing file data on dm-1-8
&gt; 2021-03-24T21:07:57.822133+01:00 geneious kernel: [2160015.291776] JBD2:
&gt; Detected IO errors while flushing file data on dm-1-8
&gt; 
&gt; First i'm wondering: what is dm-1-8 ?
&gt; I don't have a device like that.
&gt; 
&gt; geneious:~ # find /dev -iname '*dm*'
&gt; /dev/dm-1
&gt; /dev/dm-0
&gt; /dev/disk/by-id/dm-uuid-LVM-a9Cy1cweHgXlAEECqZL5KZBfnuigUG6lq0ntdZJxxLIIp5G8XihsuYrTbx7Rs0vc
&gt; /dev/disk/by-id/dm-name-vg_local-lv_var
&gt; /dev/disk/by-id/dm-uuid-LVM-a9Cy1cweHgXlAEECqZL5KZBfnuigUG6l3fdsOpBFoDWral3Fa7c6ZeYECmLd6FFj
&gt; /dev/disk/by-id/dm-name-vg_local-lv_root
&gt; /dev/cpu_dma_latency
&gt; 
&gt; I just find /proc/fs/jbd2/dm-1-8.
&gt; There is a file /proc/fs/jbd2/dm-1-8/info:
&gt; 453005 transactions (319055 requested), each up to 8192 blocks
&gt; average:
&gt;  0ms waiting for transaction
&gt;  12ms request delay
&gt;  5124ms running transaction
&gt;  0ms transaction was being locked
&gt;  0ms flushing data (in ordered mode)
&gt;  44ms logging transaction
&gt;  8031us average transaction commit time
&gt;  64 handles per transaction
&gt;  5 blocks per transaction
&gt;  6 logged blocks per transaction
&gt; 
&gt; What is that ?
&gt; 
&gt; The logfile says also something about dm-0-8:
&gt; 2021-03-24T21:03:30.289644+01:00 geneious kernel: [2159747.796405] CPU: 0 PID:
&gt; 457 Comm: jbd2/dm-0-8 Not tainted 4.12.14-122.57-default #1 SLE12-SP5
&gt; 
&gt; geneious:~ # find / -iname dm-0-8
&gt; /proc/fs/jbd2/dm-0-8
&gt; geneious:~ # ll /proc/fs/jbd2/dm-0-8
&gt; total 0
&gt; -r--r--r-- 1 root root 0 Mar 29 12:56 info
&gt; geneious:~ # cat /proc/fs/jbd2/dm-0-8/info
&gt; 7356 transactions (556 requested), each up to 8192 blocks
&gt; average:
&gt;  0ms waiting for transaction
&gt;  20ms request delay
&gt;  5628ms running transaction
&gt;  4ms transaction was being locked
&gt;  0ms flushing data (in ordered mode)
&gt;  132ms logging transaction
&gt;  134769us average transaction commit time
&gt;  52 handles per transaction
&gt;  18 blocks per transaction
&gt;  19 logged blocks per transaction
&gt; geneious:~ #
&gt; 
&gt; 
&gt; I assume i have a harddisk problem. I'm checking currently the SAN with its own
&gt; tools, via a web interface.
&gt; Afterwards i want to stop the domain, boot it with a live cd and run badblocks
&gt; and fsck.ext3.
&gt; What else can i do ?
&gt; 
&gt; Bernd
&gt; 
&gt; 

I forgot:
host is SLES 12 SP5, virtual domain too.
The image file is in raw format.

["smime.p7s" (application/pkcs7-signature)]

</body></email><email><emailId>20210329120915</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-03-29 12:09:15-0400</timestampReceived><subject>Re: how to check a virtual disk</subject><body>

On Mon, Mar 29, 2021 at 13:59:11 +0200, Lentes, Bernd wrote:
&gt; 
&gt; ----- On Mar 29, 2021, at 12:58 PM, Bernd Lentes bernd.lentes@helmholtz-muenchen.de wrote:

[...]

&gt; 
&gt; &gt; 
&gt; 
&gt; I forgot:
&gt; host is SLES 12 SP5, virtual domain too.
&gt; The image file is in raw format.

Please always attach the VM config XMLs, so that we don't have to guess
how your disks are configured.

</body></email><email><emailId>20210329091346</emailId><senderName>Michal Privoznik</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-03-29 09:13:46-0400</timestampReceived><subject>Re: Packets dropped by virtual NICs</subject><body>

On 3/27/21 2:53 PM, Silvia Fichera wrote:
&gt; Hi all,
&gt; I want to use tc qdisc settings in a network coposed of several qemu 
&gt; VMs, connected through bridges and tap interfaces.
&gt; I generate traffic with a spirent. Everything is fine when the 
&gt; scheduling discipline is not installed but when I run the command to set 
&gt; taprio queues traffic on the VM's NIC the traffic is dropped, i can send 
&gt; max 1mbps.
&gt; I think that there is something missing in the virtual NIC configuration 
&gt; or setup. With ethtool i can see that queues are configured. I've also 
&gt; noticed the BQL equals to 0, that is different than the physical machine 
&gt; (BQL=18600) where everything works correctly.
&gt; I've read that it could be because NIC drivers do not support that setting.
&gt; 
&gt; Do you have any suggestions?

Hey,

I'm not familiar with taprio, but what's implemented in libvirt is htb 
and sfq and that works well. Are you setting qdisc-s yourself or 
modifying libvirt created structure?

Are you setting these qdiscs from the host, right?
I know that when changing QoS settings (when libvirt changes qdics/class 
layout) for a brief moment packets are not transmitted from/to guest. I 
suspect that kernel is freeing up queues or something. But this does not 
look like your case, does it?

Michal

</body></email><email><emailId>20210329093835</emailId><senderName>Silvia Fichera</senderName><senderEmail>fichera.sil@gmail.com</senderEmail><timestampReceived>2021-03-29 09:38:35-0400</timestampReceived><subject>Re: Packets dropped by virtual NICs</subject><body>

Hi Michal,
these are the steps:
- start the vm with qemu
sudo qemu-system-x86_64-spice -m 2048 -enable-kvm -smp 3 -cdrom
/home/machine_A/ubuntu.iso -netdev
tap,ifname=tap0,vhost=on,id=n1,vhostforce=on,queues=3,script=/etc/tap0_ifup.sh,downscript=/etc/tap0_ifdown.sh
                
-device virtio-net-pci,netdev=n1,mac=9E:58:00:d2:53:03,mq=on,vectors=8
-netdev
tap,ifname=tap1,vhost=on,id=n2,vhostforce=on,queues=3,script=/etc/tap1_ifup.sh,downscript=/etc/tap1_ifdown.sh
                
-device virtio-net-pci,netdev=n2,mac=7A:53:00:d1:59:04,mq=on,vectors=8
-device virtio-net,netdev=network2 -netdev user,id=network2 -hda
switch_A.img

- attach the tap to the bridges in the host machine (to have the traffic
coming from the outsider traffic generator injected in the vm)
- in the VM:
    - enable ip_forward
    - enable promiscuous mode for the interface
    - send the "tc qdisc" command to configure the output NIC with 2
traffic classes (TC) assigned to 2 different queues
    - add the iptables mangle rules to the POSTROUTING chain to assign TC1
to the traffic with dport 7777 and TC0 to the traffic with dport 8888
I'm sending 2 UDP flows, I have no loss under 3Mbps each.
If I capture traffic with tcpdump on the ingress and on the egress nic (of
the VM), I see a difference of 50% of packets

When I did a test on the host machine, to check if it has the same problem,
I've reached an aggregated traffic of 90Mbps with no loss.

That's why I think that there is some misconfiguration on the virtual NIC.

Thanks
Silvia



On Mon, Mar 29, 2021 at 11:13 AM Michal Privoznik &lt;mprivozn@redhat.com&gt;
wrote:

&gt; On 3/27/21 2:53 PM, Silvia Fichera wrote:
&gt; &gt; Hi all,
&gt; &gt; I want to use tc qdisc settings in a network coposed of several qemu
&gt; &gt; VMs, connected through bridges and tap interfaces.
&gt; &gt; I generate traffic with a spirent. Everything is fine when the
&gt; &gt; scheduling discipline is not installed but when I run the command to set
&gt; &gt; taprio queues traffic on the VM's NIC the traffic is dropped, i can send
&gt; &gt; max 1mbps.
&gt; &gt; I think that there is something missing in the virtual NIC configuration
&gt; &gt; or setup. With ethtool i can see that queues are configured. I've also
&gt; &gt; noticed the BQL equals to 0, that is different than the physical machine
&gt; &gt; (BQL=18600) where everything works correctly.
&gt; &gt; I've read that it could be because NIC drivers do not support that
&gt; setting.
&gt; &gt; 
&gt; &gt; Do you have any suggestions?
&gt; 
&gt; Hey,
&gt; 
&gt; I'm not familiar with taprio, but what's implemented in libvirt is htb
&gt; and sfq and that works well. Are you setting qdisc-s yourself or
&gt; modifying libvirt created structure?
&gt; 
&gt; Are you setting these qdiscs from the host, right?
&gt; I know that when changing QoS settings (when libvirt changes qdics/class
&gt; layout) for a brief moment packets are not transmitted from/to guest. I
&gt; suspect that kernel is freeing up queues or something. But this does not
&gt; look like your case, does it?
&gt; 
&gt; Michal
&gt; 
&gt; 

-- 
Silvia Fichera


[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hi Michal,&lt;div&gt;these are the steps:&lt;/div&gt;&lt;div&gt;- start the vm with qemu \
&lt;/div&gt;&lt;div&gt;sudo qemu-system-x86_64-spice -m 2048 -enable-kvm -smp 3 -cdrom \
/home/machine_A/ubuntu.iso -netdev \
tap,ifname=tap0,vhost=on,id=n1,vhostforce=on,queues=3,script=/etc/tap0_ifup.sh,downscript=/etc/tap0_ifdown.sh \
-device virtio-net-pci,netdev=n1,mac=9E:58:00:d2:53:03,mq=on,vectors=8 -netdev \
tap,ifname=tap1,vhost=on,id=n2,vhostforce=on,queues=3,script=/etc/tap1_ifup.sh,downscript=/etc/tap1_ifdown.sh \
-device virtio-net-pci,netdev=n2,mac=7A:53:00:d1:59:04,mq=on,vectors=8   -device \
virtio-net,netdev=network2 -netdev user,id=network2 -hda \
switch_A.img&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;- attach the tap to the bridges in the host \
machine (to have the traffic coming from the outsider traffic generator injected in \
the vm)&lt;/div&gt;&lt;div&gt;- in the VM:  &lt;/div&gt;&lt;div&gt;      - enable ip_forward&lt;/div&gt;&lt;div&gt;      \
- enable promiscuous  mode for the interface&lt;/div&gt;&lt;div&gt;      - send the "tc \
qdisc" command to configure the output NIC with 2 traffic classes (TC) assigned \
to 2 different queues&lt;/div&gt;&lt;div&gt;      - add the iptables mangle rules to the \
POSTROUTING chain to assign TC1 to the traffic with dport  7777 and TC0 to the \
traffic with dport  8888&lt;/div&gt;&lt;div&gt;I'm sending 2 UDP flows, I have no loss under \
3Mbps each.&lt;/div&gt;&lt;div&gt;If I capture traffic with tcpdump on the ingress and on the \
egress nic (of the VM), I see a difference of 50% of packets  \
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;When I did a test on the host machine, to check if it has \
the same problem, I've reached an aggregated traffic of 90Mbps with no \
loss.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;That's why I think that there is some \
misconfiguration on the virtual \
NIC.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&lt;/div&gt;&lt;div&gt;Silvia&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;    \
&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Mon, \
Mar 29, 2021 at 11:13 AM Michal Privoznik &lt;&lt;a \
href="mailto:mprivozn@redhat.com"&gt;mprivozn@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;On 3/27/21 2:53 PM, \
Silvia Fichera wrote:&lt;br&gt; &gt; Hi all,&lt;br&gt;
&gt; I want to use tc qdisc settings in a network coposed of several qemu &lt;br&gt;
&gt; VMs, connected through bridges and tap interfaces.&lt;br&gt;
&gt; I generate traffic with a spirent. Everything is fine when the &lt;br&gt;
&gt; scheduling discipline is not installed but when I run the command to set &lt;br&gt;
&gt; taprio queues traffic on the VM's NIC the traffic is dropped, i can send \
&lt;br&gt; &gt; max 1mbps.&lt;br&gt;
&gt; I think that there is something missing in the virtual NIC configuration &lt;br&gt;
&gt; or setup. With ethtool i can see that queues are configured. I've also &lt;br&gt;
&gt; noticed the BQL equals to 0, that is different than the physical machine &lt;br&gt;
&gt; (BQL=18600) where everything works correctly.&lt;br&gt;
&gt; I've read that it could be because NIC drivers do not support that \
setting.&lt;br&gt; &gt; &lt;br&gt;
&gt; Do you have any suggestions?&lt;br&gt;
&lt;br&gt;
Hey,&lt;br&gt;
&lt;br&gt;
I'm not familiar with taprio, but what's implemented in libvirt is htb &lt;br&gt;
and sfq and that works well. Are you setting qdisc-s yourself or &lt;br&gt;
modifying libvirt created structure?&lt;br&gt;
&lt;br&gt;
Are you setting these qdiscs from the host, right?&lt;br&gt;
I know that when changing QoS settings (when libvirt changes qdics/class &lt;br&gt;
layout) for a brief moment packets are not transmitted from/to guest. I &lt;br&gt;
suspect that kernel is freeing up queues or something. But this does not &lt;br&gt;
look like your case, does it?&lt;br&gt;
&lt;br&gt;
Michal&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br clear="all"&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- &lt;br&gt;&lt;div dir="ltr" \
class="gmail_signature"&gt;Silvia Fichera&lt;/div&gt;



</body></email><email><emailId>20210326121911</emailId><senderName>Michal Privoznik</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-03-26 12:19:11-0400</timestampReceived><subject>Re: Question about the Qos support status for different type interfaces</subject><body>

On 3/26/21 12:31 PM, Yalan Zhang wrote:
&gt; Hi there,
&gt; 
&gt; I have a question about the Qos support status for different type 
&gt; interfaces.
&gt; Some types of interface do not support Qos, such as hostdev, user type, 
&gt; mcast type, but the behavior are different, for hostdev, the guest can 
&gt; not start with a meaningful error message, but for other types, vm can 
&gt; start successfully with a warning message in the libvirtd log. I 
&gt; doubt that if it is necessary to keep the behavior consistent for these 
&gt; different types?
&gt; 
&gt; There are 2 history bugs for them, I should have thought further and 
&gt; asked early when testing the bugs.
&gt; Bug 1319044 &lt;https://bugzilla.redhat.com/show_bug.cgi?id=1319044&gt;- log 
&gt; error when &lt;bandwidth&gt; requested on a &lt;interface type='hostdev'&gt;
&gt; Bug 1524230 &lt;https://bugzilla.redhat.com/show_bug.cgi?id=1524230&gt;- 
&gt; vhostuser type interface do not support bandwidth, but no warning message
&gt; 
&gt; Thank you for looking into this and very appreciate your feedback!
&gt; 

The reason is historical baggage - as usual. When QoS was fist 
introduced it supported only a very few interface types. Soon we've 
learned that users put XML snippets in for other types too. Back then we 
had no validation callbacks =&gt; we could not reject such XMLs because we 
did not do it from the beginning. So there might be some domain XMLs 
still that contain QoS for unsupported type and those would be lost if 
libvirt started rejecting such XMLs.

With validation callbacks things are a bit better - the domain would not 
be lost on libvirtd upgrade; though it would still be unable to start. 
I'm not sure that's much better.

Hence, we're keeping status quo. I'm open for ideas though.

Michal

</body></email><email><emailId>20210323125454</emailId><senderName>Michal Privoznik</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-03-23 12:54:54-0400</timestampReceived><subject>Re: infinite lease time</subject><body>

On 3/22/21 4:01 PM, Francesc Guasch wrote:
&gt; Hi. First of all thanks for this great project and specially
&gt; for keeping the Perl library.
&gt; 
&gt; I need to keep the IP address of the virtual machines the same
&gt; as long as possible. dnsmasq provides a setting for lease time.
&gt; It can be set to infinite, but not from within libvirt.
&gt; 
&gt; I found this patch from 2016.
&gt;  &gt; 
&gt; https://listman.redhat.com/archives/libvir-list/2016-October/msg00561.html
&gt; 
&gt; But it looks like it never made to libvirt.

That particular patch no, but another approach did:

https://gitlab.com/libvirt/libvirt/-/commit/97a0aa246799c97d0a9ca9ecd6b4fd932ae4756c

It's part of the v6.3.0 release.

&gt; 
&gt; Some time ago I made it work changing dnsmasq/default.conf.
&gt; Then we made it immutable with chattr. This no longer works
&gt; because libvirt refuses to start dnsmasq unless it can write
&gt; to it. Fair enough.
&gt; 
&gt; I've seen I can add manual IP addresses as stated here:
&gt; 
&gt;     https://wiki.libvirt.org/page/Networking
&gt; 
&gt; This is ok, but it would be a considerable amount of work,
&gt; requiring lots of manual labour.
&gt; 
&gt; Is there a way to set the lease time from libvirt ?

Well, if you don't really need static IPs but a stable way to address 
guests, then NSS plugin might help:

   https://libvirt.org/nss.html

Michal

</body></email><email><emailId>20210323134311</emailId><senderName>Michal Privoznik</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-03-23 13:43:11-0400</timestampReceived><subject>Re: infinite lease time</subject><body>

On 3/23/21 1:54 PM, Michal Privoznik wrote:
&gt; On 3/22/21 4:01 PM, Francesc Guasch wrote:
&gt;&gt; Hi. First of all thanks for this great project and specially
&gt;&gt; for keeping the Perl library.
&gt;&gt;
&gt;&gt; I need to keep the IP address of the virtual machines the same
&gt;&gt; as long as possible. dnsmasq provides a setting for lease time.
&gt;&gt; It can be set to infinite, but not from within libvirt.
&gt;&gt;
&gt;&gt; I found this patch from 2016.
&gt;&gt;   &gt; 
&gt;&gt; https://listman.redhat.com/archives/libvir-list/2016-October/msg00561.html 
&gt;&gt;
&gt;&gt;
&gt;&gt; But it looks like it never made to libvirt.
&gt; 
&gt; That particular patch no, but another approach did:
&gt; 
&gt; https://gitlab.com/libvirt/libvirt/-/commit/97a0aa246799c97d0a9ca9ecd6b4fd932ae4756c 
&gt; 
&gt; 
&gt; It's part of the v6.3.0 release.

Forgot to point out that there were couple of fixes for infinite leases:

https://gitlab.com/libvirt/libvirt/-/commit/49869e8d57f2dcba44b2cb56aaa27d101efa22ed

https://gitlab.com/libvirt/libvirt/-/commit/c14bd64f3eba9838af8ab1cac369d51abfeb21b9

https://gitlab.com/libvirt/libvirt/-/commit/8e5659ed12d1f181297ed6d4e201bb1d6b6322b6

https://gitlab.com/libvirt/libvirt/-/commit/003fff38e753d2d7cacaa3afd3f942f938408334

https://gitlab.com/libvirt/libvirt/-/commit/6f1ae57129f28444d14bd4b6dbcbf4158b95431b

https://gitlab.com/libvirt/libvirt/-/commit/9c65363a4089bb5a2bf91db45bb9531a20784c5f

https://gitlab.com/libvirt/libvirt/-/commit/ee93656c40467fa614e999a146a56011a9c500e3

https://gitlab.com/libvirt/libvirt/-/commit/5fb6d98c881c42ab41ca72060217b846949a438f

https://gitlab.com/libvirt/libvirt/-/commit/5dd53684e18c9ed3d73ab889e4c24cf8b45fa46c

https://gitlab.com/libvirt/libvirt/-/commit/7f93905e45f0ec3d28082adbcc061f6cc94aa489


They are all part of the v7.0.0 release.

Michal

</body></email><email><emailId>20210311132440</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-03-11 13:24:40-0400</timestampReceived><subject>Re: Snapshot operation aborted and volume usage</subject><body>

On Thu, Mar 11, 2021 at 10:51:13 +0200, Liran Rotenberg wrote:
&gt; We recently had this bug[1]. The thought that came from it is the handling
&gt; of error code after running virDomainSnapshotCreateXML, we encountered
&gt; VIR_ERR_OPERATION_ABORTED(78).

VIR_ERR_OPERATION_ABORTED is an error code which is emitted by the
migration code only. That means that the error comes from the failure to
take a memory image/snapshot of the VM.

Quick skim through the bugreport seems to mention timeout, so your code
probably aborted the snapshot if it was taking too long.

&gt; Apparently, the new volume is in use. Are there cases where this will
&gt; happen and the new volume won't appear in the volumes chain? Can we detect
&gt; / know when?

In the vast majority of cases if virDomainSnapshotCreateXML returns
failure the new disk volumes are NOT used at that point.

Libvirt tries very hard to ensure that everything is atomic. The memory
snapshot is taken before installing volumes into the backing chain, so
if that one fails we don't even attempt to do anything with the disks.

There are three extremely unlikely reasons where the snapshot API returns
failure and new images were already installed into the backing chain:

1) resuming of the VM failed after snapshot
2) thawing (domfsthaw) of filesystems has failed
    (easily avoided by not using the _QUIESCE flag, but freezing
    manually)
3) saving of the internal VM state XML failed

Any error except those above can happen only if the images werent
installed or the VM died while installing the images.

In addition if resuming the cpus after the snapshot fails, the cpus
didn't run so the guest couldn't have written anything to the image.
Since snapshot is supposed to flush qemu caches, in case you destroy the
VM without running the vcpus it's safe to discard the overlays as guest
didn't write anything into them yet.

&gt; Thinking aloud, if we can detect such cases we can prevent rolling back by
&gt; reporting it back from VDSM to ovirt. Or, if it can't be detected to go on
&gt; the safe side in order to save data corruption and prevent the rollback as
&gt; well.

In general, except for the case when saving of the guest XML has failed,
the new disk images will not be used by the VM so it's safe to delete
them.

&gt; Currently, in ovirt, if the job is aborted, we will look into the chain to
&gt; decide whether to rollback or not.

This is okay, we update the XML only if qemu successfully installed the
overlays.

</body></email><email><emailId>20210311155311</emailId><senderName>Liran Rotenberg</senderName><senderEmail>lrotenbe@redhat.com</senderEmail><timestampReceived>2021-03-11 15:53:11-0400</timestampReceived><subject>Re: Snapshot operation aborted and volume usage</subject><body>

On Thu, Mar 11, 2021 at 3:24 PM Peter Krempa &lt;pkrempa@redhat.com&gt; wrote:
&gt;
&gt; On Thu, Mar 11, 2021 at 10:51:13 +0200, Liran Rotenberg wrote:
&gt; &gt; We recently had this bug[1]. The thought that came from it is the handling
&gt; &gt; of error code after running virDomainSnapshotCreateXML, we encountered
&gt; &gt; VIR_ERR_OPERATION_ABORTED(78).
&gt;
&gt; VIR_ERR_OPERATION_ABORTED is an error code which is emitted by the
&gt; migration code only. That means that the error comes from the failure to
&gt; take a memory image/snapshot of the VM.
&gt;
&gt; Quick skim through the bugreport seems to mention timeout, so your code
&gt; probably aborted the snapshot if it was taking too long.
&gt;
&gt; &gt; Apparently, the new volume is in use. Are there cases where this will
&gt; &gt; happen and the new volume won't appear in the volumes chain? Can we detect
&gt; &gt; / know when?
&gt;
&gt; In the vast majority of cases if virDomainSnapshotCreateXML returns
&gt; failure the new disk volumes are NOT used at that point.
&gt;
&gt; Libvirt tries very hard to ensure that everything is atomic. The memory
&gt; snapshot is taken before installing volumes into the backing chain, so
&gt; if that one fails we don't even attempt to do anything with the disks.
&gt;
&gt; There are three extremely unlikely reasons where the snapshot API returns
&gt; failure and new images were already installed into the backing chain:
&gt;
&gt; 1) resuming of the VM failed after snapshot
&gt; 2) thawing (domfsthaw) of filesystems has failed
&gt;     (easily avoided by not using the _QUIESCE flag, but freezing
&gt;     manually)
&gt; 3) saving of the internal VM state XML failed
&gt;
&gt; Any error except those above can happen only if the images werent
&gt; installed or the VM died while installing the images.
&gt;
&gt; In addition if resuming the cpus after the snapshot fails, the cpus
&gt; didn't run so the guest couldn't have written anything to the image.
&gt; Since snapshot is supposed to flush qemu caches, in case you destroy the
&gt; VM without running the vcpus it's safe to discard the overlays as guest
&gt; didn't write anything into them yet.
&gt;
&gt; &gt; Thinking aloud, if we can detect such cases we can prevent rolling back by
&gt; &gt; reporting it back from VDSM to ovirt. Or, if it can't be detected to go on
&gt; &gt; the safe side in order to save data corruption and prevent the rollback as
&gt; &gt; well.
&gt;
&gt; In general, except for the case when saving of the guest XML has failed,
&gt; the new disk images will not be used by the VM so it's safe to delete
&gt; them.
&gt;
&gt; &gt; Currently, in ovirt, if the job is aborted, we will look into the chain to
&gt; &gt; decide whether to rollback or not.
&gt;
&gt; This is okay, we update the XML only if qemu successfully installed the
&gt; overlays.

Thanks Peter!

</body></email><email><emailId>20210311162818</emailId><senderName>Gionatan Danti</senderName><senderEmail>g.danti@assyoma.it</senderEmail><timestampReceived>2021-03-11 16:28:18-0400</timestampReceived><subject>Re: Bridge and VLAN trunk</subject><body>

Il 2021-03-11 16:05 Laine Stump ha scritto:
&gt; That's correct. Support was added to the Linux host-bridge device a
&gt; few years ago for per-port VLAN tagging/filtering, but there hasn't
&gt; been anyone sufficiently compelled (by their own needs or by their
&gt; altruistic instincts) to support that. It likely would be fairly
&gt; straightforward to do once someone dove into it - all the necessary
&gt; config attributes are already there, so it would just involve
&gt; recognizing and acting on them when a guest interface connected to a
&gt; bridge that was a standard Linux host bridge (of course in reality
&gt; there will likely be some unexpected incompatibility that will make it
&gt; more difficult, but at least *in theory* it would be simple).

Thank you for the direct reply - very appreciated.

&gt; So, if you can program in C and are willing to dig into the online
&gt; docs for setting per-port attributes for Linux host bridges and
&gt; implementing them (iirc via sending netlink messages) then feel free
&gt; to start hacking, and check in on irc.oftc.net in the #virt channel if
&gt; you have questions. Otherwise, I would recommend installing Open
&gt; vSwitch. I don't have a link handy, but I've seen a few HOWTOs
&gt; floating around, and followed one of them a few years ago to set it up
&gt; on Fedora and RHEL test machines.

The last time I wrote something interesting in C was over 5 years ago, 
but I remember the basics. I'll surely give a look at the relevant 
source files.

Regarding OpenVSwitch, I looked at it some years ago but it was somewhat 
complicated for what I needed; so I decided to remain on classical linux 
bridges. This seems a good case to reconsider that decision, even if I 
would strongly prefer to continue using normal bridges.

Thanks.

-- 
Danti Gionatan
Supporto Tecnico
Assyoma S.r.l. - www.assyoma.it
email: g.danti@assyoma.it - info@assyoma.it
GPG public key ID: FF5F32A8

</body></email><email><emailId>20210312091537</emailId><senderName>Michal Privoznik</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-03-12 09:15:37-0400</timestampReceived><subject>Re: Issue</subject><body>

On 3/5/21 11:04 AM, Samuel Thampy wrote:
&gt; Is there any additional info anyone who needs?
&gt; 
&gt; ------------------------------------------------------------------------
&gt; *From:* Samuel Thampy &lt;samjiks@hotmail.com&gt;
&gt; *Sent:* 03 March 2021 22:11
&gt; *To:* libvirt-users@redhat.com &lt;libvirt-users@redhat.com&gt;
&gt; *Subject:* Issue
&gt; I have a storage backend san disks, I have five servers which is KVM 
&gt; hosted guests.
&gt; 
&gt; I am looking to clone an image of a guest machine, so I can use a new VM 
&gt; form the image on a different server..
&gt; 
&gt; I am not sure what the best way. But when I do that, I get a memory 
&gt; error, and need to xfs_repair and damages the original machine.
&gt; 
&gt; 
&gt; My steps are
&gt; 
&gt; One vm machine on the same server
&gt; 
&gt;   * dd create original vm to template.img
&gt;   * lvcreate -L 9G -n &lt;vol-name&gt; &lt;pool&gt;
&gt;   * dd template.img to /dev/&lt;pool&gt;/&lt;vol-name&gt;
&gt;   * virsh define &lt;vm_name&gt;.xml
&gt; 
&gt; another vm machine on the secondary server
&gt; 
&gt;   * copy template.img to another server
&gt;   * lvcreate -L 9G -n &lt;vol-name&gt; &lt;pool&gt;
&gt;   * dd if=template.img  of=/dev/&lt;pool&gt;/&lt;vol-name&gt;
&gt;   * virsh define &lt;vm_name&gt;.xml
&gt; 

Nothing suspicious about these steps. So I'm suspecting that either 
template.img is corrupt, or it does not fit into LV, or maybe it's in 
use? I mean, if template.img is an image that's in use by a running 
domain it doesn't necessarily contain valid state.

Michal

</body></email><email><emailId>20210317113359</emailId><senderName>Michal Privoznik</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-03-17 11:33:59-0400</timestampReceived><subject>Re: Using cgroups in QEMU hooks</subject><body>

On 3/17/21 5:45 AM, Melissa Nuño wrote:
&gt; Hi all,
&gt; 
&gt; I'm creating a device during the prepare hook, and would like to add it 
&gt; to the device.allow file for the VM. The cgroup doesn't exist during the 
&gt; prepare hook or the start hook and will fail with an "Operation not 
&gt; permitted" error. I can add the expected path to qemu.conf and restart 
&gt; libvirtd, but this isn't very flexible since I'd have to do it for each 
&gt; device for each VM I create. All of the other libvirt cgroups seem to 
&gt; allow all devices, so I'm not seeing where the VM cgroup is getting its 
&gt; initial list.
&gt; 
&gt; Is there a way to access the cgroup for a VM before it has started? I 
&gt; can't even predict where it should be since it contains the domain ID.
&gt; 

We've already sorted this out through IRC, but for future reference, the 
device in question was /dev/input device that was passed through via 
qemu:arg.

Anything that's under qemu:arg is opaque to libvirt, it's not inspected 
by libvirt in any way and thus if it happens to be a device that needs 
to be allowed in CGroups, well bad luck. What should be used is proper 
XML representation. If there is none, please do open an RFE as 
documented in command line passhtrough:

   https://libvirt.org/drvqemu.html#qemucommand

In this specific case, the following XML can be used:

   &lt;input type='passthrough' bus='virtio'&gt;
     &lt;source evdev='/dev/input/XXX'/&gt;
   &lt;/input&gt;

However, what might be missing is that currently libvirt does not 
support 'grab_all=on,repeat=on'. But we should file an RFE for that.

Michal

</body></email><email><emailId>20210317113858</emailId><senderName>Kashyap Chamarthy</senderName><senderEmail>kchamart@redhat.com</senderEmail><timestampReceived>2021-03-17 11:38:58-0400</timestampReceived><subject>Re: Question about migrate the vm with host-passthrough cpu</subject><body>

[Catching up with libvirt-users list after a long while ... hence the
delay in my response.]

On Fri, Feb 26, 2021 at 03:58:21PM +0800, Guoyi Tu wrote:
&gt; Thanks for you reply.
&gt; 
&gt; I checked the qemu code, the destination qemu instance actually exposed
&gt; the cpu feature of new host , and if execute the cpuid instruction in
&gt; Guest OS after migration the family/model/stepping is the same as new
&gt; host.

Just to reinforce Daniel's point below: 'host-passthrough' and live
migration is tricky ... so the safest suggestion is to go with identical
physical CPUs on source and destination hosts, along with identical
kernel, _and_ CPU microcode versions (see the performance counters point
below; and also thanks to Meltdown/Spectre).

Or else live migration is very much likely to fail.

&gt; On Thu, 2021-02-25 at 14:10 +0000, Daniel P. Berrangé wrote:
&gt; &gt; On Wed, Feb 24, 2021 at 09:42:37PM +0800, Guoyi Tu wrote:

[...]

&gt; &gt; The CPUID features are the biggest compatibility issue that is likely
&gt; &gt; to cause problems generally, but I believe there can be others.
&gt; &gt; 
&gt; &gt; For example if performance counters are exposed to the guest, these
&gt; &gt; are likely to vary between different CPU models. Even different BIOS
&gt; &gt; settings can change performance counters exposed by a CPU (HT vs no-
&gt; &gt; HT)
&gt; &gt; 
&gt; &gt; There might also be problems with CPU TSC frequency differences
&gt; &gt; between
&gt; &gt; the hosts.
&gt; &gt; 
&gt; &gt; &gt; I've test the case in my environment, and the migration succeeds,
&gt; &gt; &gt; the cpu
&gt; &gt; &gt; family/model/stepping and features of lscpu in Guest OS is the
&gt; &gt; &gt; same.
&gt; &gt; 
&gt; &gt; Right, the issue is that the migration appears to succeed from QEMU's
&gt; &gt; POV, but the guest may none the less see incompatibilities which
&gt; &gt; result in a crash or incorrect behaviour an arbitrary amount of time
&gt; &gt; later. It is really hard to guarantee that behaviour is going to be
&gt; &gt; correct in all scenarios.
&gt; &gt; 
&gt; &gt; Personally I would consider the use of host-passthrough to be
&gt; &gt; unsupportable
&gt; &gt; in production environment, unless the CPUs are all homogeneous.
&gt; &gt; 
&gt; &gt; Regards,
&gt; &gt; Daniel
&gt; 
&gt; 

-- 
/kashyap

</body></email><email><emailId>20210318014530</emailId><senderName>Laine Stump</senderName><senderEmail>laine@redhat.com</senderEmail><timestampReceived>2021-03-18 01:45:30-0400</timestampReceived><subject>Re: Updating dnsmasq options with virsh net-update</subject><body>

On 3/17/21 1:51 PM, brent s. wrote:
&gt; On 3/17/21 13:19, Alex Crawford wrote:
&gt; &gt; I'm trying to take advantage of libvirt's support for passing through
&gt; &gt; options to dnsmasq
&gt; &gt; &lt;https://libvirt.org/formatnetwork.html#elementsNamespaces&gt;, but I'm
&gt; &gt; having trouble getting it to take effect. I have a network already
&gt; &gt; created and I'm trying to use net-update to add the options, but it's
&gt; &gt; not clear to me what section I should specify. By the way, is there a
&gt; &gt; good way to list the available sections? I've been resorting to reading
&gt; &gt; the code
&gt; &gt; &lt;https://gitlab.com/libvirt/libvirt/-/blob/18d0f2f9569edf3c26d912a7d8974a54bb32eee9/include/libvirt/libvirt-network.h#L158-175&gt;.
&gt; &gt;  Working in a different direction, I tried using net-edit to make the
&gt; &gt; changes but they seem to have been silently discarded:
&gt; &gt; 
&gt; &gt; $ virsh -c qemu:///system net-edit crawford-libvirt-67v2h
&gt; &gt; Network crawford-libvirt-67v2h XML configuration edited.
&gt; &gt; $ virsh -c qemu:///system net-dumpxml crawford-libvirt-67v2h | grep
&gt; &gt; --count &lt;my changes&gt;
&gt; &gt; 0
&gt; &gt; 
&gt; &gt; Can anyone tell me what I'm doing wrong or how this feature was intended
&gt; &gt; to be used? Thank you.

https://wiki.libvirt.org/page/Networking#Applying_modifications_to_the_network

&gt; &gt; 
&gt; &gt; -Alex
&gt; 
&gt; The last time I tried using net-update, if I recall it didn't support
&gt; full editing.

That is correct, and it is by design. When I added the virNetworkUpdate 
API I started with exactly that idea, but during discussions we decided 
against allowing such freeform changing of anything and everything in 
the network's config (I don't remember the arguments in either direction 
now, but I definitely remember the discussion happening :-))

&gt; I had to net-edit the network in question and restart it
&gt; (to do exactly what you're trying to do, I should note!). I don't think
&gt; net-update lets you edit the root element's namespace (which is what you
&gt; need to do for e.g. &lt;dnsmasq:options&gt; to not be eaten).

&lt;dnsmasq:options&gt; is in some ways even beyond just "editing the root 
element's namespace" - it is adding opaque stuff into the dnsmasq 
commandline that will have effects that can't be comprehended by 
libvirt's network driver - it could do something that completely 
counteracts what libvirt has purposefully added.

But I digress. You are correct that &lt;dnsmasq:options&gt; can't be changed 
with virsh net-update.

The good news, though, is that you can safely net-destroy and then 
net-start the network, and get full connectivity of all your guests 
(whose tap devices have just been disconnected from the network's bridge 
by the restart) back by just restarting libvirtd.service (at least if 
you have a libvirt that is newer than a couple years old). This means 
that, aside from the short disruption in connectivity during the time 
between "virsh net-destroy $net" and "systemctl restart 
libvirtd.service", the effect will be the same as if you had been able 
to do the modification with virsh net-update.

&gt; 
&gt; For reference, the modified root element looks like this:
&gt; 
&gt; &lt;network xmlns:dnsmasq="http://libvirt.org/schemas/network/dnsmasq/1.0"&gt;
&gt; &lt;!-- Normal network definition here... --&gt;
&gt; &lt;dnsmasq:options&gt;
&gt; &lt;dnsmasq:option value="log-dhcp"/&gt;
&gt; &lt;/dnsmasq:options&gt;
&gt; &lt;/network&gt;
&gt; 


</body></email><email><emailId>20210318184636</emailId><senderName>"Lentes, Bernd"</senderName><senderEmail>bernd.lentes@helmholtz-muenchen.de</senderEmail><timestampReceived>2021-03-18 18:46:36-0400</timestampReceived><subject>Access to an OCFS2 Partition outside the VM</subject><body>

Hi,

i'm thinking about installing two Ubuntu versions on one pc, one as a host system \
with KVM, the other in a virtual domain. I need access from both to several OCFS2 \
partitions with big amount of data. The partitions are on harddisks attached to that \
pc. Is it possible to access an OCFS2 partition which is outside the domain ?
And if yes how can i do that ?
I know that i have to configure OCFS2 and that i need DLM.
Buth systems have network, that shouldn't be the problem.


Bernd

-- 

Bernd Lentes 
System Administrator 
Institute for Metabolism and Cell Death (MCD) 
Building 25 - office 122 
HelmholtzZentrum MÃ¼nchen 
bernd.lentes@helmholtz-muenchen.de 
phone: +49 89 3187 1241 
phone: +49 89 3187 3827 
fax: +49 89 3187 2294 
http://www.helmholtz-muenchen.de/mcd
Helmholtz Zentrum MÃƒ ¼nchen

Helmholtz Zentrum Muenchen
Deutsches Forschungszentrum fuer Gesundheit und Umwelt (GmbH)
Ingolstaedter Landstr. 1
85764 Neuherberg
www.helmholtz-muenchen.de
Aufsichtsratsvorsitzende: MinDir.in Prof. Dr. Veronika von Messling
Geschaeftsfuehrung: Prof. Dr. med. Dr. h.c. Matthias Tschoep, Kerstin Guenther
Registergericht: Amtsgericht Muenchen HRB 6466
USt-IdNr: DE 129521671


</body></email><email><emailId>20210323051236</emailId><senderName>shafnamol N</senderName><senderEmail>shafnamol29@gmail.com</senderEmail><timestampReceived>2021-03-23 05:12:36-0400</timestampReceived><subject>Re: virsh capabilities does not include qemu</subject><body>

Hi,
I didnt pass prefix while building.
So I tried

*meson build -Dsystem=true*

It worked for me.Now virsh shows kvm and qemu in its capabilities and
could create a new VM using virsh create.
Thanks for your valuable time.

Thanks,

Shafnamol.N



On Mon, Mar 22, 2021 at 6:40 PM Daniel P. Berrangé &lt;berrange@redhat.com&gt;
wrote:

&gt; On Mon, Mar 22, 2021 at 01:57:24PM +0100, Michal Privoznik wrote:
&gt; &gt; On 3/22/21 5:17 AM, shafnamol N wrote:
&gt; &gt; &gt; Hi,
&gt; &gt; &gt; I am new  to Libvirt and Qemu.I have installed Libvirt 7.1.0 and
&gt; &gt; &gt; qemu-kvm 4.2.0.
&gt; &gt; &gt; I configured and built libvirt based on instructions from
&gt; &gt; &gt; https://libvirt.org/compiling.html &lt;https://libvirt.org/compiling.html
&gt; &gt;.
&gt; &gt; &gt; But when i tried to create a VM using virsh it shows the following
&gt; error:
&gt; &gt; &gt; # virsh create /home/abc.xml
&gt; &gt; &gt; error: Failed to create domain from /home/abc.xml
&gt; &gt; &gt; error: invalid argument: could not find capabilities for arch=x86_64
&gt; &gt; &gt; domaintype=kvm
&gt; &gt; &gt;
&gt; &gt; &gt; When i check the hypervisor capabilities ,it doest show qemu in guest
&gt; &gt; &gt; domain type.
&gt; &gt; &gt; # virsh capabilities
&gt; &gt; &gt; ....................................
&gt; &gt; &gt; .....................................
&gt; &gt; &gt;   &lt;/host&gt;
&gt; &gt; &gt;
&gt; &gt; &gt;    &lt;guest&gt;
&gt; &gt; &gt;      &lt;os_type&gt;exe&lt;/os_type&gt;
&gt; &gt; &gt;      &lt;arch name='x86_64'&gt;
&gt; &gt; &gt;        &lt;wordsize&gt;64&lt;/wordsize&gt;
&gt; &gt; &gt;        &lt;emulator&gt;/usr/local/libexec/libvirt_lxc&lt;/emulator&gt;
&gt; &gt; &gt;        &lt;domain type='lxc'/&gt;
&gt; &gt; &gt;      &lt;/arch&gt;
&gt; &gt; &gt;    &lt;/guest&gt;
&gt; &gt; &gt;
&gt; &gt; &gt;    &lt;guest&gt;
&gt; &gt; &gt;      &lt;os_type&gt;exe&lt;/os_type&gt;
&gt; &gt; &gt;      &lt;arch name='i686'&gt;
&gt; &gt; &gt;        &lt;wordsize&gt;32&lt;/wordsize&gt;
&gt; &gt; &gt;        &lt;emulator&gt;/usr/local/libexec/libvirt_lxc&lt;/emulator&gt;
&gt; &gt;
&gt; &gt; This smells suspicious. Perhaps you did not pass proper prefix (meson
&gt; &gt; -Dsystem=true)?
&gt; &gt;
&gt; &gt; Anyway, libvirt tries to find qemu-system-$arch in $PATH and falls back
&gt; to
&gt; &gt; /usr/libexec/qemu-kvm if no binary was found. So I suspect that maybe the
&gt; &gt; directory you installed QEMU into is not in $PATH?
&gt;
&gt; This capabiliities output is showing an lxc:///system driver connection
&gt; too, not QEMU. So I suspect libvirt was perhaps built without QEMU
&gt; support ?
&gt;
&gt;
&gt; Regards,
&gt; Daniel
&gt; --
&gt; |: https://berrange.com      -o-
&gt; https://www.flickr.com/photos/dberrange :|
&gt; |: https://libvirt.org         -o-
&gt; https://fstop138.berrange.com :|
&gt; |: https://entangle-photo.org    -o-
&gt; https://www.instagram.com/dberrange :|
&gt;
&gt;

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div&gt;Hi,&lt;/div&gt;&lt;div&gt;I didnt pass prefix while building.&lt;/div&gt;&lt;div&gt;So I \
tried &lt;br&gt;&lt;pre class="gmail-literal-block"&gt;&lt;b&gt;meson build \
-Dsystem=true&lt;/b&gt;&lt;br&gt;&lt;/pre&gt;&lt;pre class="gmail-literal-block"&gt;&lt;span \
style="font-family:arial,sans-serif"&gt;It worked for me.Now virsh shows kvm and qemu in \
its capabilities and could create a new VM using virsh create.&lt;br&gt;Thanks for your \
valuable time.&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;&lt;pre class="gmail-literal-block"&gt;&lt;span \
style="font-family:arial,sans-serif"&gt;Thanks,&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;&lt;pre \
class="gmail-literal-block"&gt;&lt;span \
style="font-family:arial,sans-serif"&gt;Shafnamol.N&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;&lt;pre \
class="gmail-literal-block"&gt;&lt;br&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div \
dir="ltr" class="gmail_attr"&gt;On Mon, Mar 22, 2021 at 6:40 PM Daniel P. Berrangé \
&lt;&lt;a href="mailto:berrange@redhat.com"&gt;berrange@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;On Mon, Mar 22, 2021 \
at 01:57:24PM +0100, Michal Privoznik wrote:&lt;br&gt; &gt; On 3/22/21 5:17 AM, shafnamol N \
wrote:&lt;br&gt; &gt; &gt; Hi,&lt;br&gt;
&gt; &gt; I am new   to Libvirt and Qemu.I have installed Libvirt 7.1.0 and&lt;br&gt;
&gt; &gt; qemu-kvm 4.2.0.&lt;br&gt;
&gt; &gt; I configured and built libvirt based on instructions from&lt;br&gt;
&gt; &gt; &lt;a href="https://libvirt.org/compiling.html" rel="noreferrer" \
target="_blank"&gt;https://libvirt.org/compiling.html&lt;/a&gt; &lt;&lt;a \
href="https://libvirt.org/compiling.html" rel="noreferrer" \
target="_blank"&gt;https://libvirt.org/compiling.html&lt;/a&gt;&gt;.&lt;br&gt; &gt; &gt; But when i \
tried to create a VM using virsh it shows the following error:&lt;br&gt; &gt; &gt; # virsh \
create /home/abc.xml&lt;br&gt; &gt; &gt; error: Failed to create domain from \
/home/abc.xml&lt;br&gt; &gt; &gt; error: invalid argument: could not find capabilities for \
arch=x86_64&lt;br&gt; &gt; &gt; domaintype=kvm&lt;br&gt;
&gt; &gt; &lt;br&gt;
&gt; &gt; When i check the hypervisor capabilities ,it doest show qemu in guest&lt;br&gt;
&gt; &gt; domain type.&lt;br&gt;
&gt; &gt; # virsh capabilities&lt;br&gt;
&gt; &gt; ....................................&lt;br&gt;
&gt; &gt; .....................................&lt;br&gt;
&gt; &gt;     &lt;/host&gt;&lt;br&gt;
&gt; &gt; &lt;br&gt;
&gt; &gt;      &lt;guest&gt;&lt;br&gt;
&gt; &gt;         &lt;os_type&gt;exe&lt;/os_type&gt;&lt;br&gt;
&gt; &gt;         &lt;arch name='x86_64'&gt;&lt;br&gt;
&gt; &gt;            &lt;wordsize&gt;64&lt;/wordsize&gt;&lt;br&gt;
&gt; &gt;            \
&lt;emulator&gt;/usr/local/libexec/libvirt_lxc&lt;/emulator&gt;&lt;br&gt; &gt; &gt;         \
&lt;domain type='lxc'/&gt;&lt;br&gt; &gt; &gt;         &lt;/arch&gt;&lt;br&gt;
&gt; &gt;      &lt;/guest&gt;&lt;br&gt;
&gt; &gt; &lt;br&gt;
&gt; &gt;      &lt;guest&gt;&lt;br&gt;
&gt; &gt;         &lt;os_type&gt;exe&lt;/os_type&gt;&lt;br&gt;
&gt; &gt;         &lt;arch name='i686'&gt;&lt;br&gt;
&gt; &gt;            &lt;wordsize&gt;32&lt;/wordsize&gt;&lt;br&gt;
&gt; &gt;            \
&lt;emulator&gt;/usr/local/libexec/libvirt_lxc&lt;/emulator&gt;&lt;br&gt; &gt; &lt;br&gt;
&gt; This smells suspicious. Perhaps you did not pass proper prefix (meson&lt;br&gt;
&gt; -Dsystem=true)?&lt;br&gt;
&gt; &lt;br&gt;
&gt; Anyway, libvirt tries to find qemu-system-$arch in $PATH and falls back to&lt;br&gt;
&gt; /usr/libexec/qemu-kvm if no binary was found. So I suspect that maybe the&lt;br&gt;
&gt; directory you installed QEMU into is not in $PATH?&lt;br&gt;
&lt;br&gt;
This capabiliities output is showing an lxc:///system driver connection&lt;br&gt;
too, not QEMU. So I suspect libvirt was perhaps built without QEMU&lt;br&gt;
support ?&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Regards,&lt;br&gt;
Daniel&lt;br&gt;
-- &lt;br&gt;
&gt; &gt; &lt;a href="https://berrange.com" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://berrange.com&lt;/a&gt;         -o-      &lt;a \
&gt; &gt; href="https://www.flickr.com/photos/dberrange" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://www.flickr.com/photos/dberrange&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="https://libvirt.org" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://libvirt.org&lt;/a&gt;              -o-                  &lt;a \
&gt; &gt; href="https://fstop138.berrange.com" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://fstop138.berrange.com&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="https://entangle-photo.org" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://entangle-photo.org&lt;/a&gt;      -o-      &lt;a \
&gt; &gt; href="https://www.instagram.com/dberrange" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://www.instagram.com/dberrange&lt;/a&gt; :|&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;



</body></email><email><emailId>20210323143455</emailId><senderName>Francesc Guasch</senderName><senderEmail>frankie@telecos.upc.edu</senderEmail><timestampReceived>2021-03-23 14:34:55-0400</timestampReceived><subject>Re: infinite lease time</subject><body>

On 23/03/2021 14:43, Michal Privoznik wrote:
&gt; On 3/23/21 1:54 PM, Michal Privoznik wrote:
&gt;&gt; On 3/22/21 4:01 PM, Francesc Guasch wrote:
 &gt;&gt;&gt;
&gt;&gt;&gt; But it looks like it never made to libvirt.
&gt;&gt;
&gt;&gt; That particular patch no, but another approach did:
&gt;&gt;
&gt;&gt; It's part of the v6.3.0 release.
&gt; 

Michal, this is great ! Thank your for that information.
We need to upgrade the server but eventually it will be
fixed for us.

Thanks !

</body></email><email><emailId>20210328070246</emailId><senderName>Michael Ablassmeier</senderName><senderEmail>abi@grinser.de</senderEmail><timestampReceived>2021-03-28 07:02:46-0400</timestampReceived><subject>Incremental backup utility</subject><body>

hi users,

i have started a project on github that aims to create a small backup
utility, supporting the new changed block tracking features.

If anyone wants to give it a try and has some suggestions, here
is the link:

 https://github.com/abbbi/virtnbdbackup

bye,
    - michael

</body></email><email><emailId>20210329011518</emailId><senderName>Yalan Zhang</senderName><senderEmail>yalzhang@redhat.com</senderEmail><timestampReceived>2021-03-29 01:15:18-0400</timestampReceived><subject>Re: Question about the Qos support status for different type interfaces</subject><body>

Hi Michal,

Thank you for the clarification.


-------
Best Regards,
Yalan Zhang
IRC: yalzhang


On Fri, Mar 26, 2021 at 8:19 PM Michal Privoznik &lt;mprivozn@redhat.com&gt;
wrote:

&gt; On 3/26/21 12:31 PM, Yalan Zhang wrote:
&gt; &gt; Hi there,
&gt; &gt;
&gt; &gt; I have a question about the Qos support status for different type
&gt; &gt; interfaces.
&gt; &gt; Some types of interface do not support Qos, such as hostdev, user type,
&gt; &gt; mcast type, but the behavior are different, for hostdev, the guest can
&gt; &gt; not start with a meaningful error message, but for other types, vm can
&gt; &gt; start successfully with a warning message in the libvirtd log. I
&gt; &gt; doubt that if it is necessary to keep the behavior consistent for these
&gt; &gt; different types?
&gt; &gt;
&gt; &gt; There are 2 history bugs for them, I should have thought further and
&gt; &gt; asked early when testing the bugs.
&gt; &gt; Bug 1319044 &lt;https://bugzilla.redhat.com/show_bug.cgi?id=1319044&gt;- log
&gt; &gt; error when &lt;bandwidth&gt; requested on a &lt;interface type='hostdev'&gt;
&gt; &gt; Bug 1524230 &lt;https://bugzilla.redhat.com/show_bug.cgi?id=1524230&gt;-
&gt; &gt; vhostuser type interface do not support bandwidth, but no warning message
&gt; &gt;
&gt; &gt; Thank you for looking into this and very appreciate your feedback!
&gt; &gt;
&gt;
&gt; The reason is historical baggage - as usual. When QoS was fist
&gt; introduced it supported only a very few interface types. Soon we've
&gt; learned that users put XML snippets in for other types too. Back then we
&gt; had no validation callbacks =&gt; we could not reject such XMLs because we
&gt; did not do it from the beginning. So there might be some domain XMLs
&gt; still that contain QoS for unsupported type and those would be lost if
&gt; libvirt started rejecting such XMLs.
&gt;
&gt; With validation callbacks things are a bit better - the domain would not
&gt; be lost on libvirtd upgrade; though it would still be unable to start.
&gt; I'm not sure that's much better.
&gt;
&gt; Hence, we're keeping status quo. I'm open for ideas though.
&gt;
&gt; Michal
&gt;
&gt;

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div&gt;Hi Michal,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;Thank you for the clarification.  \
&lt;br clear="all"&gt;&lt;div&gt;&lt;div dir="ltr" class="gmail_signature" \
data-smartmail="gmail_signature"&gt;&lt;div dir="ltr"&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;-------&lt;br&gt;Best \
Regards,&lt;br&gt;Yalan Zhang&lt;br&gt;IRC: \
yalzhang&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div \
dir="ltr" class="gmail_attr"&gt;On Fri, Mar 26, 2021 at 8:19 PM Michal Privoznik &lt;&lt;a \
href="mailto:mprivozn@redhat.com"&gt;mprivozn@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;On 3/26/21 12:31 PM, \
Yalan Zhang wrote:&lt;br&gt; &gt; Hi there,&lt;br&gt;
&gt; &lt;br&gt;
&gt; I have a question about  the Qos support status for different type &lt;br&gt;
&gt; interfaces.&lt;br&gt;
&gt; Some types  of interface do not support  Qos, such as hostdev, user type, &lt;br&gt;
&gt; mcast type, but the behavior are different, for hostdev, the guest can &lt;br&gt;
&gt; not start with a meaningful error message, but for other types, vm can &lt;br&gt;
&gt; start successfully with a warning message  in the libvirtd log. I &lt;br&gt;
&gt; doubt  that if it is necessary to keep the behavior consistent  for these &lt;br&gt;
&gt; different  types?&lt;br&gt;
&gt; &lt;br&gt;
&gt; There are 2 history bugs for them, I should have thought further and &lt;br&gt;
&gt; asked early when testing the bugs.&lt;br&gt;
&gt; Bug  1319044 &lt;&lt;a href="https://bugzilla.redhat.com/show_bug.cgi?id=1319044" \
rel="noreferrer" target="_blank"&gt;https://bugzilla.redhat.com/show_bug.cgi?id=1319044&lt;/a&gt;&gt;- \
log &lt;br&gt; &gt; error when &lt;bandwidth&gt; requested on a &lt;interface \
type='hostdev'&gt;&lt;br&gt; &gt; Bug  1524230 &lt;&lt;a \
href="https://bugzilla.redhat.com/show_bug.cgi?id=1524230" rel="noreferrer" \
target="_blank"&gt;https://bugzilla.redhat.com/show_bug.cgi?id=1524230&lt;/a&gt;&gt;- &lt;br&gt; \
&gt; vhostuser type interface do not support bandwidth, but no warning message&lt;br&gt; \
&gt; &lt;br&gt; &gt; Thank you for looking into this and very appreciate your feedback!&lt;br&gt;
&gt; &lt;br&gt;
&lt;br&gt;
The reason is historical baggage - as usual. When QoS was fist &lt;br&gt;
introduced it supported only a very few interface types. Soon we've &lt;br&gt;
learned that users put XML snippets in for other types too. Back then we &lt;br&gt;
had no validation callbacks =&gt; we could not reject such XMLs because we &lt;br&gt;
did not do it from the beginning. So there might be some domain XMLs &lt;br&gt;
still that contain QoS for unsupported type and those would be lost if &lt;br&gt;
libvirt started rejecting such XMLs.&lt;br&gt;
&lt;br&gt;
With validation callbacks things are a bit better - the domain would not &lt;br&gt;
be lost on libvirtd upgrade; though it would still be unable to start. &lt;br&gt;
I'm not sure that's much better.&lt;br&gt;
&lt;br&gt;
Hence, we're keeping status quo. I'm open for ideas though.&lt;br&gt;
&lt;br&gt;
Michal&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;



</body></email><email><emailId>20210329100416</emailId><senderName>Michal Privoznik</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-03-29 10:04:16-0400</timestampReceived><subject>Re: Packets dropped by virtual NICs</subject><body>

On 3/29/21 11:38 AM, Silvia Fichera wrote:
&gt; Hi Michal,
&gt; these are the steps:
&gt; - start the vm with qemu
&gt; sudo qemu-system-x86_64-spice -m 2048 -enable-kvm -smp 3 -cdrom 
&gt; /home/machine_A/ubuntu.iso -netdev 
&gt; tap,ifname=tap0,vhost=on,id=n1,vhostforce=on,queues=3,script=/etc/tap0_ifup.sh,downscript=/etc/tap0_ifdown.sh \
&gt;                 
&gt; -device virtio-net-pci,netdev=n1,mac=9E:58:00:d2:53:03,mq=on,vectors=8 
&gt; -netdev 
&gt; tap,ifname=tap1,vhost=on,id=n2,vhostforce=on,queues=3,script=/etc/tap1_ifup.sh,downscript=/etc/tap1_ifdown.sh \
&gt;                 
&gt; -device virtio-net-pci,netdev=n2,mac=7A:53:00:d1:59:04,mq=on,vectors=8  
&gt; -device virtio-net,netdev=network2 -netdev user,id=network2 -hda 
&gt; switch_A.img
&gt; 
&gt; - attach the tap to the bridges in the host machine (to have the traffic 
&gt; coming from the outsider traffic generator injected in the vm)
&gt; - in the VM:
&gt; - enable ip_forward
&gt; - enable promiscuous mode for the interface

This sounds fishy. Why is this needed?

&gt; - send the "tc qdisc" command to configure the output NIC with 2 
&gt; traffic classes (TC) assigned to 2 different queues
&gt; - add the iptables mangle rules to the POSTROUTING chain to assign 
&gt; TC1 to the traffic with dport 7777 and TC0 to the traffic with dport 8888
&gt; I'm sending 2 UDP flows, I have no loss under 3Mbps each.
&gt; If I capture traffic with tcpdump on the ingress and on the egress nic 
&gt; (of the VM), I see a difference of 50% of packets
&gt; 
&gt; When I did a test on the host machine, to check if it has the same 
&gt; problem, I've reached an aggregated traffic of 90Mbps with no loss.
&gt; 
&gt; That's why I think that there is some misconfiguration on the virtual NIC.

Well, that's fairly easy to test - create those two TAPs, do the setup 
you're doing and instad of spawning qemu, run iperf or spirent and tell 
it to use those TAPs. I think you'll find the problem elsewhere.

Anyway, this problem is not libvirt related really and I guess you can 
find more elaborate replies on a list where TC developers hang out. 
Looks like they're using latrc: https://lartc.org/#mailinglist

Michal


</body></email><email><emailId>20210329111533</emailId><senderName>Nicholas Hardiman</senderName><senderEmail>nhardima@redhat.com</senderEmail><timestampReceived>2021-03-29 11:15:33-0400</timestampReceived><subject>vcenter on esxi on KVM on RHEL8</subject><body>

I tried something new at the weekend - I created a lab for ansible
experiments.
One PC, two ESXi VMs, some nested guests.

Is this a sensible thing to attempt?

vcenter  ubuntu1   ubuntu2
-------  -------   -------
ESXi1              ESXI2
----------------   -------------
KVM
--------------------------------
RHEL 8
--------------------------------
ASUS PN50

Everything within ESXi1 works fine, but communication with the outside
world is not fine.  Before I get into troubleshooting details, I thought
I'd just check if this is a reasonable thing to do, or if I'm heading in
the wrong direction.

Thanks, Nick


-- 

Nick Hardiman, RHCA

Senior Consultant

Red Hat &lt;https://www.redhat.com/&gt;

nhardima@redhat.com
M: 07585-206195


Upcoming PTO: -

Upcoming Training: Mon 8 - Fri 12 March
&lt;https://www.redhat.com/&gt;

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;I tried something new at the weekend - I created a lab for ansible \
experiments.  &lt;div&gt;One PC, two ESXi VMs, some nested guests.  \
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is this a sensible thing to attempt?  \
&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font face="monospace"&gt;vcenter   ubuntu1     \
ubuntu2&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face="monospace"&gt;-------   -------     &lt;/font&gt;&lt;span \
style="font-family:monospace"&gt;-------&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
face="monospace"&gt;ESXi1                     ESXI2&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
face="monospace"&gt;----------------     -------------&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
face="monospace"&gt;KVM&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
face="monospace"&gt;--------------------------------&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
face="monospace"&gt;RHEL 8&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
face="monospace"&gt;--------------------------------&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
face="monospace"&gt;ASUS PN50&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Everything within ESXi1 \
works fine, but communication with the  outside world is not fine.   Before I get \
into troubleshooting details, I thought I'd just check if this is a reasonable \
thing to do, or if I'm heading in the wrong direction.  \
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks, Nick  &lt;/div&gt;&lt;div&gt;&lt;br clear="all"&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- \
&lt;br&gt;&lt;div dir="ltr" class="gmail_signature" data-smartmail="gmail_signature"&gt;&lt;div \
dir="ltr"&gt;&lt;p style="color:rgb(0,0,0);font-family:RedHatText,sans-serif;font-weight:bold;margin:0px;padding:0px;font-size:14px"&gt;&lt;span&gt;Nick&lt;/span&gt; \
&lt;span&gt;Hardiman&lt;/span&gt;&lt;span \
style="text-transform:uppercase;color:rgb(170,170,170);margin:0px"&gt;, \
RHCA&lt;/span&gt;&lt;/p&gt;&lt;p style="color:rgb(0,0,0);font-family:RedHatText,sans-serif;font-size:12px;margin:0px"&gt;&lt;span&gt;Senior \
Consultant&lt;/span&gt;&lt;/p&gt;&lt;p \
style="color:rgb(0,0,0);font-family:RedHatText,sans-serif;margin:0px 0px \
4px;font-size:12px"&gt;&lt;a href="https://www.redhat.com/" \
style="color:rgb(0,136,206);margin:0px" target="_blank"&gt;Red \
Hat&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;div \
style="color:rgb(0,0,0);font-family:RedHatText,sans-serif;font-size:medium;margin-bottom:4px"&gt;&lt;/div&gt;&lt;p \
style="color:rgb(0,0,0);font-family:RedHatText,sans-serif;margin:0px;font-size:12px"&gt;&lt;span \
style="margin:0px;padding:0px"&gt;&lt;a href="mailto:nhardima@redhat.com" \
style="color:rgb(0,0,0);margin:0px" target="_blank"&gt;nhardima@redhat.com&lt;/a&gt;     \
&lt;/span&gt;&lt;span&gt;&lt;br&gt;M:  &lt;a href="tel:07585-206195" style="color:rgb(0,0,0);margin:0px" \
target="_blank"&gt;07585-206195&lt;/a&gt;       &lt;/span&gt;&lt;/p&gt;&lt;p \
style="color:rgb(0,0,0);font-family:RedHatText,sans-serif;margin:0px;font-size:12px"&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
style="color:rgb(34,34,34);margin:0in"&gt;&lt;font color="#ff0000" face="times new roman, \
serif"&gt;Upcoming PTO: -&lt;/font&gt;&lt;/p&gt;&lt;p style="color:rgb(34,34,34);margin:0in"&gt;&lt;font \
color="#ff0000" face="times new roman, serif"&gt;Upcoming Training: Mon 8 - Fri 12 \
March&lt;/font&gt;&lt;/p&gt;&lt;div \
style="color:rgb(0,0,0);font-family:RedHatText,sans-serif;font-size:medium;margin-top:12px"&gt;&lt;table \
border="0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td width="100px"&gt;&lt;a href="https://www.redhat.com/" \
target="_blank"&gt;&lt;img \
src="https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--200.png" \
width="90" height="auto"&gt;&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;




</body></email><email><emailId>20210329124557</emailId><senderName>"Lentes, Bernd"</senderName><senderEmail>bernd.lentes@helmholtz-muenchen.de</senderEmail><timestampReceived>2021-03-29 12:45:57-0400</timestampReceived><subject>Re: how to check a virtual disk</subject><body>


----- On Mar 29, 2021, at 2:09 PM, Peter Krempa pkrempa@redhat.com wrote:

&gt; On Mon, Mar 29, 2021 at 13:59:11 +0200, Lentes, Bernd wrote:
&gt; &gt; 
&gt; &gt; ----- On Mar 29, 2021, at 12:58 PM, Bernd Lentes
&gt; &gt; bernd.lentes@helmholtz-muenchen.de wrote:
&gt; 
&gt; [...]
&gt; 
&gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; I forgot:
&gt; &gt; host is SLES 12 SP5, virtual domain too.
&gt; &gt; The image file is in raw format.
&gt; 
&gt; Please always attach the VM config XMLs, so that we don't have to guess
&gt; how your disks are configured.

&lt;!--
WARNING: THIS IS AN AUTO-GENERATED FILE. CHANGES TO IT ARE LIKELY TO BE
OVERWRITTEN AND LOST. Changes to this xml configuration should be made using:
  virsh edit vm_geneious
or other application using the libvirt API.
--&gt;

&lt;domain type='kvm'&gt;
  &lt;name&gt;vm_geneious&lt;/name&gt;
  &lt;uuid&gt;7337ee89-1699-470f-95c4-05ee19203847&lt;/uuid&gt;
  &lt;memory unit='KiB'&gt;8192000&lt;/memory&gt;
  &lt;currentMemory unit='KiB'&gt;8192000&lt;/currentMemory&gt;
  &lt;vcpu placement='static'&gt;2&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='x86_64' machine='pc-i440fx-2.9'&gt;hvm&lt;/type&gt;
    &lt;bootmenu enable='yes'/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
    &lt;apic/&gt;
    &lt;vmport state='off'/&gt;
  &lt;/features&gt;
  &lt;clock offset='utc'&gt;
    &lt;timer name='rtc' tickpolicy='catchup'/&gt;
    &lt;timer name='pit' tickpolicy='delay'/&gt;
    &lt;timer name='hpet' present='no'/&gt;
  &lt;/clock&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;destroy&lt;/on_crash&gt;
  &lt;pm&gt;
    &lt;suspend-to-mem enabled='no'/&gt;
    &lt;suspend-to-disk enabled='no'/&gt;
  &lt;/pm&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/bin/qemu-kvm&lt;/emulator&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;driver name='qemu' type='raw' cache='none'/&gt;
      &lt;source file='/mnt/ocfs2/vm_geneious.raw'/&gt;
      &lt;target dev='sda' bus='sata'/&gt;
      &lt;boot order='1'/&gt;
      &lt;address type='drive' controller='0' bus='0' target='0' unit='0'/&gt;
    &lt;/disk&gt;
    &lt;!-- disk type='file' device='cdrom'&gt;
      &lt;driver name='qemu' type='raw'/&gt;
      &lt;source file='/mnt/mcd/AG_BioInformatik/Technik/software_und_treiber/linux/knoppix/KNOPPIX_V8.1-2017-09-05-DE.iso'/&gt;
  &lt;target dev='hda' bus='ide'/&gt;
      &lt;readonly/&gt;
      &lt;boot order='1'/&gt;
      &lt;address type='drive' controller='0' bus='0' target='0' unit='0'/&gt;
    &lt;/disk --&gt;
    &lt;controller type='usb' index='0' model='ich9-ehci1'&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x05' function='0x7'/&gt;
    &lt;/controller&gt;
    &lt;controller type='usb' index='0' model='ich9-uhci1'&gt;
      &lt;master startport='0'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x05' function='0x0' \
multifunction='on'/&gt;  &lt;/controller&gt;
    &lt;controller type='usb' index='0' model='ich9-uhci2'&gt;
      &lt;master startport='2'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x05' function='0x1'/&gt;
    &lt;/controller&gt;
    &lt;controller type='usb' index='0' model='ich9-uhci3'&gt;
      &lt;master startport='4'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x05' function='0x2'/&gt;
    &lt;/controller&gt;
    &lt;controller type='pci' index='0' model='pci-root'/&gt;
    &lt;controller type='ide' index='0'&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x01' function='0x1'/&gt;
    &lt;/controller&gt;
    &lt;controller type='sata' index='0'&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x06' function='0x0'/&gt;
    &lt;/controller&gt;
    &lt;controller type='virtio-serial' index='0'&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x07' function='0x0'/&gt;
    &lt;/controller&gt;
    &lt;interface type='bridge'&gt;
      &lt;mac address='52:54:00:37:92:ad'/&gt;
      &lt;source bridge='br0'/&gt;
      &lt;model type='virtio'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03' function='0x0'/&gt;
    &lt;/interface&gt;
    &lt;serial type='pty'&gt;
      &lt;target type='isa-serial' port='0'&gt;
        &lt;model name='isa-serial'/&gt;
      &lt;/target&gt;
    &lt;/serial&gt;
    &lt;console type='pty'&gt;
      &lt;target type='serial' port='0'/&gt;
    &lt;/console&gt;
    &lt;channel type='unix'&gt;
      &lt;target type='virtio' name='org.qemu.guest_agent.0'/&gt;
      &lt;address type='virtio-serial' controller='0' bus='0' port='1'/&gt;
    &lt;/channel&gt;
    &lt;channel type='spicevmc'&gt;
      &lt;target type='virtio' name='com.redhat.spice.0'/&gt;
      &lt;address type='virtio-serial' controller='0' bus='0' port='2'/&gt;
    &lt;/channel&gt;
    &lt;input type='tablet' bus='usb'&gt;
      &lt;address type='usb' bus='0' port='1'/&gt;
    &lt;/input&gt;
    &lt;input type='mouse' bus='ps2'/&gt;
    &lt;input type='keyboard' bus='ps2'/&gt;
    &lt;graphics type='vnc' port='5906' autoport='no' listen='127.0.0.1'&gt;
      &lt;listen type='address' address='127.0.0.1'/&gt;
    &lt;/graphics&gt;
    &lt;video&gt;
      &lt;model type='vga' vram='16384' heads='1' primary='yes'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x02' function='0x0'/&gt;
    &lt;/video&gt;
    &lt;redirdev bus='usb' type='spicevmc'&gt;
      &lt;address type='usb' bus='0' port='2'/&gt;
    &lt;/redirdev&gt;
    &lt;redirdev bus='usb' type='spicevmc'&gt;
      &lt;address type='usb' bus='0' port='3'/&gt;
    &lt;/redirdev&gt;
    &lt;memballoon model='virtio'&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x08' function='0x0'/&gt;
    &lt;/memballoon&gt;
    &lt;rng model='virtio'&gt;
      &lt;backend model='random'&gt;/dev/urandom&lt;/backend&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x09' function='0x0'/&gt;
    &lt;/rng&gt;
  &lt;/devices&gt;
&lt;/domain&gt;


["smime.p7s" (application/pkcs7-signature)]

</body></email><email><emailId>20210329145339</emailId><senderName>Michal Privoznik</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-03-29 14:53:39-0400</timestampReceived><subject>Re: virsh dommemstat doesn't update its information</subject><body>

On 3/29/21 4:00 PM, Lentes, Bernd wrote:
&gt; Hi,
&gt; 
&gt; i'm playing a bit around with my domains and the balloon driver.
&gt; To get information about ballooning i use virsh dommemstat.
&gt; But i only get very few information:
&gt; 
&gt; virsh # dommemstat vm_idcc_devel
&gt; actual 1044480
&gt; last_update 0
&gt; rss 1030144
&gt; 
&gt; Also configuring "dommemstat --domain vm_idcc_devel --period 5 --live"
&gt; or "dommemstat --domain vm_idcc_devel --period 5 --current" does neither update nor \
&gt; extend the information. 
&gt; In vm_idcc_devel virtio_balloon is loaded:
&gt; idcc-devel:~ # lsmod|grep balloon
&gt; virtio_balloon         22788  0
&gt; 
&gt; Guest OS is SLES 10 SP4. Is that too old ?

Yeah, that is ~10 years old and I believe that virtio_balloon module is 
lacking feature that enable QEMU (and subsequently libvirt) report more 
info.

Michal


</body></email><email><emailId>20210331092034</emailId><senderName>Jiatong Shen</senderName><senderEmail>yshxxsjt715@gmail.com</senderEmail><timestampReceived>2021-03-31 09:20:34-0400</timestampReceived><subject>move mount permission denied</subject><body>

Hello community!

  I am faced with a mysterious [error](
https://gist.github.com/jshen28/5f29eed51e0a1308684214b35f009478) which
says move mount is not permissioned.

We are using libvirt with openstack-helm which running libvirt in a docker
based k8s environment. /dev/termination-log is a device created and
attached by k8s and mount looks like `/dev/mapper/ubuntu--vg-root on
/var/log/termination-log type ext4
(rw,relatime,errors=remount-ro,data=ordered)`

Any idea why this happens? appreciate the help!

-- 

Best Regards,

Jiatong Shen

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hello  community!&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;   I am faced with a mysterious \
[error](&lt;a href="https://gist.github.com/jshen28/5f29eed51e0a1308684214b35f009478"&gt;https://gist.github.com/jshen28/5f29eed51e0a1308684214b35f009478&lt;/a&gt;) \
which says move mount is not permissioned.  &lt;br clear="all"&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;We \
are using libvirt with openstack-helm which running libvirt in a docker based k8s \
environment. /dev/termination-log is a device created and attached by k8s and mount \
looks like `/dev/mapper/ubuntu--vg-root on /var/log/termination-log type ext4 \
(rw,relatime,errors=remount-ro,data=ordered)`&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Any idea why \
this happens? appreciate the help!&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- &lt;br&gt;&lt;div dir="ltr" \
class="gmail_signature" data-smartmail="gmail_signature"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;div&gt;Best \
Regards,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Jiatong Shen&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210331171930</emailId><senderName>Andrea Bolognani</senderName><senderEmail>abologna@redhat.com</senderEmail><timestampReceived>2021-03-31 17:19:30-0400</timestampReceived><subject>Re: Regarding location of Libvirt library</subject><body>

On Wed, 2021-03-31 at 17:01 +0200, Michal Privoznik wrote:
&gt; On 3/31/21 7:38 AM, shafnamol N wrote:
&gt; &gt; Hi,
&gt; &gt; I have installed Libvirt 7.1.0.
&gt; &gt; I configured and built libvirt based on instructions from
&gt; &gt; https://libvirt.org/compiling.html &lt;https://libvirt.org/compiling.html&gt;;;.
&gt; &gt; Now I developed a client program to create a VM using an XML file.As the 
&gt; &gt; API for it is *virDomainCreateXML,* called this API by passing XML file 
&gt; &gt; .It shows the following error.
&gt; &gt; undefined reference to `virDomainCreateXML'.
&gt; &gt; I included the header files containing the said API declaration.But need 
&gt; &gt; to include the library also.
&gt; &gt; My question is where do the libvirt library located after building it.
&gt; 
&gt; Yes, you need to pass -lvirt when linking. The library is installed 
&gt; wherever you told it to install. If you ran plain meson with no extra 
&gt; arguments, then 'meson install' installs library under /usr/local/lib/ 
&gt; or /usr/local/lib64/. So you will need to pass -L/usr/local/lib or 
&gt; -L/usr/local/lib64 too to the linker.
&gt; 
&gt; But there is this switch -Dsystem=true which tells meson to install into 
&gt; system directories:
&gt; 
&gt;    meson -Dsystem=true build
&gt;    meson install -C build
&gt; 
&gt; with this you will not need to pass any extra -L arguments to the linker.

Note that the recommended way to obtain this information is via
pkg-config, using something like

  $ pkg-config --cflags --libs libvirt

If you get an error about libvirt not being found, you probably need
to run

  $ export PKG_CONFIG_PATH=/usr/local/lib/pkgconfig

or something along those lines beforehand.

-- 
Andrea Bolognani / Red Hat / Virtualization

</body></email><email><emailId>20210331203950</emailId><senderName>Radek Simko</senderName><senderEmail>radek.simko@gmail.com</senderEmail><timestampReceived>2021-03-31 20:39:50-0400</timestampReceived><subject>Re: Virtual Network API for QEMU</subject><body>

Thank you Laine and thanks Michal for the detailed explanation.

To add some (missing) context from my side:

I was attempting to virtualize Raspberry Pi on qemu via libvirt, where my
host machine is macOS (both qemu and libvirt installed via Homebrew) and I
while trying to set up the network I stumbled upon this:

$ virsh -c qemu:///system?socket=/usr/local/var/run/libvirt/libvirt-sock
net-list --all
error: Failed to get the number of active networks
error: this function is not supported by the connection driver:
virConnectNumOfNetworks

This error in combination with the compatibility matrix made me think it's
just not supported.
What is the right way of interpreting this error/state? Does the host OS
play a role in the compatibility?

Are there any known limitations on macOS, or is this likely just a
broken/misconfigured installation on my side?

Radek Simko


On Mon, Mar 29, 2021 at 10:29 AM Michal Privoznik &lt;mprivozn@redhat.com&gt;
wrote:

&gt; On 3/27/21 1:39 PM, Radek Simko wrote:
&gt; &gt; Hi,
&gt; &gt; According to this support matrix
&gt; &gt; https://libvirt.org/hvsupport.html#virNetworkDriver
&gt; &gt; &lt;https://libvirt.org/hvsupport.html#virNetworkDriver&gt;
&gt; &gt; there is no support for any APIs other than hypervisor ones for qemu.
&gt; &gt; For example virConnectNumOfNetworks is not supported.
&gt; &gt;
&gt; &gt; Is there any particular reason this is not supported? Has any
&gt; &gt; development in that area been attempted in the past? Would contributions
&gt; &gt; adding support be welcomed?
&gt;
&gt; To extend Laine's reply:
&gt;
&gt; Libvirt has two set of drivers: statefull (where libvirt keeps the state
&gt; of resources like domains, networks, ...) and stateless (where libvirt
&gt; merely translates from/to APIs exposed by hypervisor).
&gt;
&gt; QEMU can be an example of a statefull driver, ESX or hyperv are examples
&gt; of stateless drivers. Stateless drivers also implement network APIs
&gt; (again, by translating from/to APIs exposed by the underlying hypervisor
&gt; - ESX or hypverv in this example), whereas statefull drivers use bridge
&gt; driver. Therefore, QEMU doesn't implement any network APIs.
&gt;
&gt;
&gt; This is even more visible with split daemons (where monolithic libvirtd
&gt; is broken into smaller daemons) - if virnetworkd is not running then
&gt; things like 'virsh net-list' return an error [*].
&gt;
&gt;
&gt; Is there any particular problem you're facing?
&gt;
&gt; Michal
&gt;
&gt;
&gt; * - except not really, because these split daemons are socket activated,
&gt; so virnetworkd is stared automatically when needed.
&gt;
&gt;

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div&gt;Thank you Laine and thanks Michal for the detailed  \
explanation.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;To add some (missing) context from my \
side:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I was attempting to virtualize Raspberry Pi on qemu \
via libvirt, where my host machine is macOS (both qemu and libvirt installed via \
Homebrew) and I while trying to set up the network I stumbled upon \
this:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;pre \
style="box-sizing:border-box;font-family:SFMono-Regular,Consolas,"Liberation \
Mono",Menlo,monospace;font-size:11.9px;margin-top:0px;margin-bottom:16px;padding:16px;overflow:auto;line-height:1.45;border-radius:6px;color:rgb(36,41,46)"&gt;&lt;code \
style="box-sizing:border-box;font-family:SFMono-Regular,Consolas,"Liberation \
Mono",Menlo,monospace;font-size:11.9px;padding:0px;margin:0px;background:initial; \
border-radius:6px;word-break:normal;border:0px;display:inline;overflow:visible;line-height:inherit"&gt;$ \
                virsh -c \
                qemu:///system?socket=/usr/local/var/run/libvirt/libvirt-sock \
                net-list --all
error: Failed to get the number of active networks
error: this function is not supported by the connection driver: \
virConnectNumOfNetworks&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;div dir="ltr" \
class="gmail_signature" data-smartmail="gmail_signature"&gt;&lt;div dir="ltr"&gt;&lt;div \
dir="ltr"&gt;&lt;div&gt;This error in combination with the compatibility matrix made me think \
it's just not supported.&lt;/div&gt;&lt;div&gt;What is the right way of interpreting this \
error/state? Does the host OS play a role in the \
compatibility?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Are there any known limitations on macOS,  or \
is this likely just a broken/misconfigured installation on my \
side?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="ltr"&gt;Radek \
Simko&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div \
dir="ltr" class="gmail_attr"&gt;On Mon, Mar 29, 2021 at 10:29 AM Michal Privoznik &lt;&lt;a \
href="mailto:mprivozn@redhat.com"&gt;mprivozn@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;On 3/27/21 1:39 PM, \
Radek Simko wrote:&lt;br&gt; &gt; Hi,&lt;br&gt;
&gt; According to this support matrix &lt;br&gt;
&gt; &lt;a href="https://libvirt.org/hvsupport.html#virNetworkDriver" rel="noreferrer" \
target="_blank"&gt;https://libvirt.org/hvsupport.html#virNetworkDriver&lt;/a&gt; &lt;br&gt; &gt; \
&lt;&lt;a href="https://libvirt.org/hvsupport.html#virNetworkDriver" rel="noreferrer" \
target="_blank"&gt;https://libvirt.org/hvsupport.html#virNetworkDriver&lt;/a&gt;&gt;&lt;br&gt; &gt; \
there is no support for any APIs other than hypervisor ones for qemu.&lt;br&gt; &gt; For \
example virConnectNumOfNetworks is not supported.&lt;br&gt; &gt; &lt;br&gt;
&gt; Is there any particular reason this is not supported? Has any &lt;br&gt;
&gt; development in that area been attempted in the past? Would contributions &lt;br&gt;
&gt; adding support be welcomed?&lt;br&gt;
&lt;br&gt;
To extend Laine's reply:&lt;br&gt;
&lt;br&gt;
Libvirt has two set of drivers: statefull (where libvirt keeps the state &lt;br&gt;
of resources like domains, networks, ...) and stateless (where libvirt &lt;br&gt;
merely translates from/to APIs exposed by hypervisor).&lt;br&gt;
&lt;br&gt;
QEMU can be an example of a statefull driver, ESX or hyperv are examples &lt;br&gt;
of stateless drivers. Stateless drivers also implement network APIs &lt;br&gt;
(again, by translating from/to APIs exposed by the underlying hypervisor &lt;br&gt;
- ESX or hypverv in this example), whereas statefull drivers use bridge &lt;br&gt;
driver. Therefore, QEMU doesn't implement any network APIs.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
This is even more visible with split daemons (where monolithic libvirtd &lt;br&gt;
is broken into smaller daemons) - if virnetworkd is not running then &lt;br&gt;
things like 'virsh net-list' return an error [*].&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Is there any particular problem you're facing?&lt;br&gt;
&lt;br&gt;
Michal&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
* - except not really, because these split daemons are socket activated, &lt;br&gt;
so virnetworkd is stared automatically when needed.&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;



</body></email><email><emailId>20210202102827</emailId><senderName>Sebastian Mitterle</senderName><senderEmail>smitterl@redhat.com</senderEmail><timestampReceived>2021-02-02 10:28:27-0400</timestampReceived><subject>Re: learning materials kvm/qemu/libvirt</subject><body>

Libvirt wiki has good stuff https://wiki.libvirt.org/page/Main_Page, esp. a
book recommendation. State of libvirt video 2019
https://www.youtube.com/watch?v=XTXE-A49-DU

On Thu, Jan 21, 2021 at 9:48 PM vrms &lt;vrms@netcologne.de&gt; wrote:

&gt;
&gt;
&gt; On 21.01.21 19:23, Thing wrote:
&gt;
&gt; *Do both....*
&gt;
&gt; even though I wasn't exactly looking for advice of such sort ... thx for
&gt; your suggestion.
&gt;
&gt;
&gt;
&gt; On Fri, 22 Jan 2021 at 05:45, vrms &lt;vrms@netcologne.de&gt; wrote:
&gt;
&gt;&gt; I am doing a 2 year retraining at the moment to become a system admin.
&gt;&gt;
&gt;&gt; There are 2 weeks of HyperV on the schedule (sadly the only
&gt;&gt; virtualization that will be taught in that course) in august and plan to
&gt;&gt; sneak out of class during that time to to something useful and get a
&gt;&gt; grip on the kvm/qemu/libvirt side of the VM cake (class is completely
&gt;&gt; online, so the sneaking out is doable).
&gt;&gt;
&gt;&gt; Can anybody recommend good online learning resources for someone with
&gt;&gt; yet quite foggy basic understanding of things?
&gt;&gt;
&gt;&gt; thanks and best
&gt;&gt; Gunnar
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Libvirt wiki has good stuff  &lt;a \
href="https://wiki.libvirt.org/page/Main_Page"&gt;https://wiki.libvirt.org/page/Main_Page&lt;/a&gt;, \
esp. a book recommendation. State of libvirt video 2019 &lt;a \
href="https://www.youtube.com/watch?v=XTXE-A49-DU"&gt;https://www.youtube.com/watch?v=XTXE-A49-DU&lt;/a&gt; \
&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Thu, Jan 21, \
2021 at 9:48 PM vrms &lt;&lt;a \
href="mailto:vrms@netcologne.de"&gt;vrms@netcologne.de&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;  
    
  
  &lt;div&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;div&gt;On 21.01.21 19:23, Thing wrote:&lt;font color="#852b2b"&gt;&lt;br&gt;
      &lt;/font&gt;&lt;/div&gt;
    &lt;blockquote type="cite"&gt;
      
      &lt;div dir="ltr"&gt;&lt;i&gt;&lt;font color="#852b2b"&gt;Do both....&lt;/font&gt;&lt;/i&gt;&lt;/div&gt;
    &lt;/blockquote&gt;
    even though I wasn't exactly looking for advice of such sort ... thx
    for your suggestion.&lt;br&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;blockquote type="cite"&gt;&lt;br&gt;
      &lt;div class="gmail_quote"&gt;
        &lt;div dir="ltr" class="gmail_attr"&gt;On Fri, 22 Jan 2021 at 05:45,
          vrms &lt;&lt;a href="mailto:vrms@netcologne.de" \
target="_blank"&gt;vrms@netcologne.de&lt;/a&gt;&gt; wrote:&lt;br&gt;  &lt;/div&gt;
        &lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;I  am doing a 2 year \
retraining at the moment to become a system  admin.&lt;br&gt;
          &lt;br&gt;
          There are 2 weeks of HyperV on the schedule (sadly the only&lt;br&gt;
          virtualization that will be taught in that course) in august
          and plan to&lt;br&gt;
          sneak out of class during that time to to something useful and
          get a&lt;br&gt;
          grip on the kvm/qemu/libvirt side of the VM cake (class is
          completely&lt;br&gt;
          online, so the sneaking out is doable).&lt;br&gt;
          &lt;br&gt;
          Can anybody recommend good online learning resources for
          someone with&lt;br&gt;
          yet quite foggy basic understanding of things?&lt;br&gt;
          &lt;br&gt;
          thanks and best&lt;br&gt;
          Gunnar&lt;br&gt;
          &lt;br&gt;
          &lt;br&gt;
        &lt;/blockquote&gt;
      &lt;/div&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
  &lt;/div&gt;

&lt;/blockquote&gt;&lt;/div&gt;



</body></email><email><emailId>20210210234947</emailId><senderName>Laine Stump</senderName><senderEmail>laine@redhat.com</senderEmail><timestampReceived>2021-02-10 23:49:47-0400</timestampReceived><subject>Re: Static DHCP lease never distributed</subject><body>

On 2/9/21 8:28 PM, Brooks Swinnerton wrote:
&gt; Hi there,
&gt; 
&gt; I have a libvirt network defined as so:
&gt; 
&gt; &lt;network&gt;
&gt;      &lt;name&gt;customers&lt;/name&gt;
&gt;      &lt;bridge name='customers' macTableManager='libvirt' /&gt;
&gt;      &lt;port isolated='yes' /&gt;

At first I was suspicious that your problem could be related to the 
&lt;port isolated='yes'/&gt; (because not many people use it), but I added 
that to my own test, and it still worked.

Same for macTableManager='libvirt' - this has been around a few years 
longer, but I suspect that also nobody uses it (in spite of the promise 
of performance gains, it turns out that if something isn't the default, 
most people just never know that it exists).


&gt;      &lt;dns enable='no' /&gt;
&gt;      &lt;ip address='10.0.0.1' prefix='24'&gt;
&gt;          &lt;dhcp&gt;
&gt;              &lt;host mac='02:99:92:43:eb:b8' name='dhcp-test' 
&gt; ip='10.0.0.10' /&gt;

After reading a bit, I thought maybe we were missing the statement for 
and "empty" range that dnsmasq requires when there are only static 
addresses, but then I tried out a test and it worked. Just out of 
curiousity I looked back through libvirt's history and found that bug 
was fixed in September 2010! (and has remained fixed since then)

(going back up) Then I noticed you have &lt;dns enable='no'/&gt;, which is 
also very uncommonly used. So I tried adding that to my config and 
restarting the net. I am *still* unable to get it to fail.


&gt;          &lt;/dhcp&gt;
&gt;      &lt;/ip&gt;
&gt; &lt;/network&gt;
&gt; 
&gt; And that network is attached to a virtual machine:
&gt; 
&gt;      &lt;interface type='network'&gt;
&gt;        &lt;mac address='02:99:92:43:eb:b8'/&gt;
&gt;        &lt;source network='customers'/&gt;
&gt;        &lt;model type='virtio'/&gt;
&gt;        &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03' 
&gt; function='0x0'/&gt;
&gt;      &lt;/interface&gt;
&gt; 
&gt; But for some reason when the domain starts, it never gets an address. If 
&gt; I tcpdump the bridge that was created by the network I can see it 
&gt; sending out discover packets, but dnsmasq never seems to respond:
&gt; 
&gt; 01:26:25.039987 02:99:92:43:eb:b8 &gt; ff:ff:ff:ff:ff:ff, ethertype IPv4 
&gt; (0x0800), length 342: (tos 0x0, ttl 64, id 0, offset 0, flags [none], 
&gt; proto UDP (17), length 328)
&gt;      0.0.0.0.68 &gt; 255.255.255.255.67: BOOTP/DHCP, Request from 
&gt; 02:99:92:43:eb:b8, length 300, xid 0xc7283f76, secs 228, Flags [none]
&gt;            Client-Ethernet-Address 02:99:92:43:eb:b8
&gt;            Vendor-rfc1048 Extensions
&gt;              Magic Cookie 0x63825363
&gt;              DHCP-Message Option 53, length 1: Discover
&gt;              Client-ID Option 61, length 7: ether 02:99:92:43:eb:b8
&gt;              MSZ Option 57, length 2: 576
&gt;              Parameter-Request Option 55, length 7:
&gt;                Subnet-Mask, Default-Gateway, Domain-Name-Server, Hostname
&gt;                Domain-Name, BR, NTP
&gt;              Vendor-Class Option 60, length 3: "d-i"
&gt; 
&gt; 
&gt; Despite that appearing to be the correct mac address.
&gt; 
&gt; Looking in /var/lib/libvirt/dnsmasq/customers.hostsfile, it's returning 
&gt; what I would expect to be there:
&gt; 
&gt; 02:99:92:43:eb:b8,10.0.0.10,dhcp-test
&gt; 
&gt; If I add a &lt;range&gt; stanza to the configuration, that does appear to 
&gt; work, so it seems this is only related to static addresses.

Do you mean that if you add a &lt;range&gt; that the guests can then get their 
static addresses? Or are they given different (dynamic) addresses within 
the range?

&gt; 
&gt; This is libvirtd 5.8.0.

That's a year and a half old, but nothing in this area of the code has 
changed in a way that should affect this behavior.

Of course it could be that your specific kernel isn't properly dealing 
with one of the above "unusual" options I mentioned. If I were in your 
position, I would try removing mactableManager='libvirt', &lt;port 
isolated='yes'/&gt;, and &lt;dns enable='no'/&gt; (remember you need to destroy 
and restart the network after any change.

If none of those helps, you may want to start looking into iptables 
rules (although the fact that it works with a range enabled implies that 
there are no iptables issues.

</body></email><email><emailId>20210219223632</emailId><senderName>Jiri Denemark</senderName><senderEmail>jdenemar@redhat.com</senderEmail><timestampReceived>2021-02-19 22:36:32-0400</timestampReceived><subject>Re: Upgrading the host</subject><body>

On Wed, Feb 17, 2021 at 07:15:03 -0800, Marcin Struzak wrote:
&gt; On 2/17/2021 12:23 AM, Michal Privoznik wrote:
&gt; &gt; On 2/17/21 2:45 AM, Marcin Struzak wrote:
&gt; &gt;&gt; On 2/16/2021 12:51 AM, Michal Privoznik wrote:
&gt; &gt;&gt;&gt; On 2/12/21 2:10 AM, Marcin Struzak wrote:
&gt; &gt;&gt;&gt; [...]
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;  3. Anything else I should worry about or prepare ahead?
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; Not strictly related to libvirt, but machine types might be problem. 
&gt; &gt;&gt;&gt; I guess qemu will be upgraded too and in general the machine type 
&gt; &gt;&gt;&gt; you're using for a domain might not be available in upgraded qemu.
&gt; &gt;&gt; Correct, it looks like qemu will go from 1.6.2 to 4.2.1...
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; You can view supported machine types by running 'virsh capabilities' 
&gt; &gt;&gt;&gt; with upgraded qemu.
&gt; &gt;&gt; machine is pc-i440fx-1.6 in all my domains.  Is there a simple way to 
&gt; &gt;&gt; figure out if that's supported in libvirt 6.1.0 (without installing it)?
&gt; &gt;
&gt; &gt; It's not libvirt who has say in machine types. Libvirt treats machine 
&gt; &gt; type as an opaque string. But I can see that pc-i440fx-1.6 is still 
&gt; &gt; available even with the latest QEMU release:
&gt; &gt;
&gt; &gt; # /usr/bin/qemu-system-x86_64 -version
&gt; &gt; QEMU emulator version 5.2.0
&gt; &gt;
&gt; &gt; # virsh capabilities | grep pc-i440fx-1.6
&gt; &gt;       &lt;machine maxCpus='255'&gt;pc-i440fx-1.6&lt;/machine&gt;
&gt; &gt;       &lt;machine maxCpus='255'&gt;pc-i440fx-1.6&lt;/machine&gt;
&gt; &gt;
&gt; &gt; So you are safe on that front.
&gt; 
&gt; Excellent, thank you for checking.
&gt; 
&gt; Out of curiosity: what would have been my course of action if that 
&gt; particular machine were no longer defined?  I assume: substitute with a 
&gt; close match (after figuring out how do determine what counts as "close") 
&gt; &amp; hope that the VMs (all Fedoras &amp; Ubuntus) cope &amp; adjust?

All pc-i440fs-* machine types are pretty close and based on the same
chipset. There are some differences between them (e.g., in migration
format, enabled CPU features for a given CPU model), but nothing an OS
installed in the VM couldn't cope with. Even Windows can deal with it,
but reactivation may be needed after changing the machine type.

So unless you would need to stick with a specific (or old enough)
machine type for migration compatibility with hosts that were not
upgraded yet, you would likely end up replacing "pc-i440fx-1.6" with
plain "pc", which would be expanded to the default machine type, i.e.,
the most recent pc-i440fx machine type supported by the installed
version of QEMU.

Jirka

</body></email><email><emailId>20210224110728</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-02-24 11:07:28-0400</timestampReceived><subject>Re: Some confusion about lsilogic controller</subject><body>

On Wed, Feb 24, 2021 at 09:11:03AM +0000, xingchaochao wrote:
&gt; 
&gt; Hello,
&gt; I have been confused by such a phenomenon recently.
&gt; Libvirt is the master branch , and the VM is centos8.2(kernel is \
&gt; 4.18.0-193.el8.aarch64). When I hot-plug the scsi disk for a virtual machine \
&gt; without a virtio-scsi controller, libvirt will automatically generate an lsilogic \
&gt; controller for the scsi disk.

snip

&gt; I am confused, why libvirt chooses to generate an lsilogic controller
&gt; for the scsi disk when there is no scsi controller, instead of directly
&gt; reporting an error and exiting the hot plug operation. After all, the
&gt; scsi disk based on the lsilogic controller is not perceived inside
&gt; the virtual machine, and lsilogic will remain in the XML file of the
&gt; virtual machine.

libvirt has no knowledge of what devices the guest OS is able to
support. In this case RHEL8 doesn't support lsilogic, but libvirt
doesn't know this.

Generally a libvirt mgmt application will not rely on the defaults
for choosing devices, and instead use libosinfo to figure out
what devices are likely to be supported and explicitly use those.


Regards,
Daniel
-- 
&gt; &gt; https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
&gt; &gt; https://libvirt.org         -o-            https://fstop138.berrange.com :|
&gt; &gt; https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|


</body></email><email><emailId>20210226075821</emailId><senderName>Guoyi Tu</senderName><senderEmail>tugy@chinatelecom.cn</senderEmail><timestampReceived>2021-02-26 07:58:21-0400</timestampReceived><subject>Re: Question about migrate the vm with host-passthrough cpu</subject><body>

Thanks for you reply.

I checked the qemu code, the destination qemu instance actually exposed
the cpu feature of new host , and if execute the cpuid instruction in
Guest OS after migration the family/model/stepping is the same as new
host.

On Thu, 2021-02-25 at 14:10 +0000, Daniel P. Berrangé wrote:
&gt; On Wed, Feb 24, 2021 at 09:42:37PM +0800, Guoyi Tu wrote:
&gt; &gt; Hi there,
&gt; &gt; 
&gt; &gt; Sorry to bother you, but could I ask you a question about the live
&gt; &gt; migration
&gt; &gt; of virtual machine configured with host-passthough cpu, it confuse
&gt; &gt; me a lot.
&gt; &gt; 
&gt; &gt; Here i have two hosts with different cpu, and the cpu feature set
&gt; &gt; of old
&gt; &gt; host is subset of the new one (by virsh cpu-compare). If the vm was
&gt; &gt; first
&gt; &gt; started on the old host,is it safe to migrate the vm between the
&gt; &gt; two hosts
&gt; &gt; back and forth with the vm always keep running?
&gt; 
&gt; The CPUID features are the biggest compatibility issue that is likely
&gt; to cause problems generally, but I believe there can be others.
&gt; 
&gt; For example if performance counters are exposed to the guest, these
&gt; are likely to vary between different CPU models. Even different BIOS
&gt; settings can change performance counters exposed by a CPU (HT vs no-
&gt; HT)
&gt; 
&gt; There might also be problems with CPU TSC frequency differences
&gt; between
&gt; the hosts.
&gt; 
&gt; &gt; I've test the case in my environment, and the migration succeeds,
&gt; &gt; the cpu
&gt; &gt; family/model/stepping and features of lscpu in Guest OS is the
&gt; &gt; same.
&gt; 
&gt; Right, the issue is that the migration appears to succeed from QEMU's
&gt; POV, but the guest may none the less see incompatibilities which
&gt; result in a crash or incorrect behaviour an arbitrary amount of time
&gt; later. It is really hard to guarantee that behaviour is going to be
&gt; correct in all scenarios.
&gt; 
&gt; Personally I would consider the use of host-passthrough to be
&gt; unsupportable
&gt; in production environment, unless the CPUs are all homogeneous.
&gt; 
&gt; Regards,
&gt; Daniel


</body></email><email><emailId>20210226190426</emailId><senderName>Marc</senderName><senderEmail>marc@f1-outsourcing.eu</senderEmail><timestampReceived>2021-02-26 19:04:26-0400</timestampReceived><subject>RE: Live backups create-snapshot-as and memspec</subject><body>

&gt; the qemu guest agent installed on the guest and issue the virsh
&gt; create-snapshot-as with the --quiesce parameter, is this correct?
&gt; 


I am doing a "guest-fsfreeze-freeze" and then create the external snapshot. And for \
vm's that have databases, do a database dump to local dir, before the snapshot.


</body></email><email><emailId>20210227132750</emailId><senderName>�������������</senderName><senderEmail>zhanrzh_xt@teamsun.com.cn</senderEmail><timestampReceived>2021-02-27 13:27:50-0400</timestampReceived><subject>help,virsh start vm failed</subject><body>

 Hello,all
    I start vm failed as show below:

()[root@com1 tmp]# virsh start centos
error: Failed to start domain centos
error: Start job for unit machine-qemu\x2d1\x2dcentos.scope failed with 'failed'

as the same time error "2021-02-27 08:58:31.688+0000: 22: error : \
virSystemdCreateMachine:361 : Start job for unit machine-qemu\x2d4\x2dcentos.scope \
failed with 'failed' " in libvirt.log.

How I dig into this question.thanks 


</body></email><email><emailId>20210212011017</emailId><senderName>Marcin Struzak</senderName><senderEmail>kunci@struzak.com</senderEmail><timestampReceived>2021-02-12 01:10:17-0400</timestampReceived><subject>Upgrading the host</subject><body>

Hello--

I'm planning on upgrading the OS on my host machine by doing manual 
re-installation, which will trigger an upgrade of libvirt from 1.1.3 to 
6.1.0.  Hardware, storage volumes &amp; paths, etc., will be the same after 
upgrade.

I was going to redefine &amp; start everything from .xml files, starting 
with the network

     virsh net-define &lt;network XML&gt;
     virsh net-autostart &lt;network&gt;
     virsh net-start &lt;network&gt;

and following with all the guests

     virsh define &lt;domain XML&gt;
     virsh autostart &lt;domain&gt;
     virsh start &lt;domain&gt;

I have the following questions:

 1. Do I need to generate XML dumps manually, or is it ok to use the
    ones from host's /etc/libvirt?
 2. Do I need to define &amp; start storage pools &amp; volumes explicitly, or
    will they be picked up from domain definitions?
 3. Anything else I should worry about or prepare ahead?

--Marcin


[Attachment #3 (text/html)]

&lt;html&gt;
  &lt;head&gt;

    &lt;meta http-equiv="content-type" content="text/html; charset=UTF-8"&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;p&gt;Hello--&lt;/p&gt;
    &lt;p&gt;I'm planning on upgrading the OS on my host machine by doing
      manual re-installation, which will trigger an upgrade of libvirt
      from 1.1.3 to 6.1.0.  Hardware, storage volumes &amp; paths, etc.,
      will be the same after upgrade. &lt;br&gt;
    &lt;/p&gt;
    &lt;p&gt;I was going to redefine &amp; start everything from .xml files,
      starting with the network&lt;br&gt;
    &lt;/p&gt;
    &lt;p&gt;    virsh net-define &lt;network XML&gt;&lt;br&gt;
          virsh net-autostart &lt;network&gt;&lt;br&gt;
          virsh net-start &lt;network&gt;&lt;/p&gt;
    &lt;p&gt;and following with all the guests&lt;br&gt;
    &lt;/p&gt;
    &lt;p&gt;    virsh define &lt;domain XML&gt;&lt;br&gt;
          virsh autostart &lt;domain&gt;&lt;br&gt;
          virsh start &lt;domain&gt;&lt;/p&gt;
    I have the following questions:
    &lt;ol&gt;
      &lt;li&gt;Do I need to generate XML dumps manually, or is it ok to use
        the ones from host's /etc/libvirt? &lt;br&gt;
      &lt;/li&gt;
      &lt;li&gt;Do I need to define &amp; start storage pools &amp; volumes
        explicitly, or will they be picked up from domain definitions? &lt;br&gt;
      &lt;/li&gt;
      &lt;li&gt;Anything else I should worry about or prepare ahead?  &lt;br&gt;
      &lt;/li&gt;
    &lt;/ol&gt;
    &lt;p&gt;--Marcin&lt;br&gt;
    &lt;/p&gt;
  &lt;/body&gt;
&lt;/html&gt;


</body></email><email><emailId>20210224091103</emailId><senderName>xingchaochao</senderName><senderEmail>xingchaochao@huawei.com</senderEmail><timestampReceived>2021-02-24 09:11:03-0400</timestampReceived><subject>Some confusion about lsilogic controller</subject><body>

Hello,
I have been confused by such a phenomenon recently.
Libvirt is the master branch , and the VM is centos8.2(kernel is \
4.18.0-193.el8.aarch64). When I hot-plug the scsi disk for a virtual machine without \
a virtio-scsi controller, libvirt will automatically generate an lsilogic controller \
for the scsi disk.

&lt;disk type='file' device='disk'&gt;
  &lt;driver name='qemu' type='qcow2' cache='none' io='native'/&gt;
  &lt;source file='/Images/xcc/tmp.img'/&gt;
  &lt;backingStore/&gt;
  &lt;target dev='sdt' bus='scsi'/&gt;
&lt;address type='drive' controller='0' bus='0' target='0' unit='0'/&gt;
&lt;/disk&gt;

linux-upcHIq:/Images/xcc # virsh list
Id   Name   State
----------------------
12   g1     running

linux-upcHIq:/Images/xcc # virsh attach-device g1 disk.xml
Device attached successfully
linux-upcHIq:/Images/xcc # virsh dumpxml g1 | grep scsi
      &lt;target dev='sdt' bus='scsi'/&gt;
      &lt;alias name='scsi0-0-0'/&gt;
    &lt;controller type='scsi' index='0' model='lsilogic'&gt;
      &lt;alias name='scsi0'/&gt;

But this scsi disk cannot be found through the lsblk command inside the virtual \
machine. [root@localhost ~]# lsblk
NAME        MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
vda         252:0    0   20G  0 disk
†€vda1      252:1    0  600M  0 part /boot/efi
†€vda2      252:2    0    1G  0 part /boot
„€vda3      252:3    0 18.4G  0 part
  †€cl-root 253:0    0 16.4G  0 lvm  /
  „€cl-swap 253:1    0    2G  0 lvm  [SWAP]
After hot unplugging the scsi disk, I performed the hot unplug operation of the \
lsilogic controller. libvirt shows "Device detached successfully", but in fact, the \
lsilogic controller is not removed from the live XML and persistent XML. Through \
"virsh dumpxml vmname" and "virsh edit vmname", I can see &lt;controller type='scsi' \
index='0' model='lsilogic'&gt; is always there.

linux-upcHIq:/Images/xcc # virsh detach-device g1 disk.xml
Device detached successfully
linux-upcHIq:/Images/xcc # virsh dumpxml g1 | grep scsi
    &lt;controller type='scsi' index='0' model='lsilogic'&gt;
      &lt;alias name='scsi0'/&gt;
linux-upcHIq:/Images/xcc #
linux-upcHIq:/Images/xcc # cat lsi.xml
&lt;controller type='scsi' index='0' model='lsilogic'&gt;
  &lt;alias name='scsi0'/&gt;
  &lt;address type='pci' domain='0x0000' bus='0x03' slot='0x05' function='0x0'/&gt;
&lt;/controller&gt;
linux-upcHIq:/Images/xcc # virsh detach-device g1 lsi.xml
Device detached successfully

linux-upcHIq:/Images/xcc # virsh dumpxml g1 | grep scsi
    &lt;controller type='scsi' index='0' model='lsilogic'&gt;
      &lt;alias name='scsi0'/&gt;

I am confused, why libvirt chooses to generate an lsilogic controller for the scsi \
disk when there is no scsi controller, instead of directly reporting an error and \
exiting the hot plug operation. After all, the scsi disk based on the lsilogic \
controller is not perceived inside the virtual machine, and lsilogic will remain in \
the XML file of the virtual machine.


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt; &lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=koi8-r"&gt;
&lt;meta name="Generator" content="Microsoft Word 15 (filtered medium)"&gt;
&lt;style&gt;&lt;!--
/* Font Definitions */
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:"Calibri",sans-serif;}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:#0563C1;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:#954F72;
	text-decoration:underline;}
pre
	{mso-style-priority:99;
	mso-style-link:"HTML \9884\8BBE\683C\5F0F Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:SimSun;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri",sans-serif;
	color:windowtext;}
span.HTMLChar
	{mso-style-name:"HTML \9884\8BBE\683C\5F0F Char";
	mso-style-priority:99;
	mso-style-link:"HTML \9884\8BBE\683C\5F0F";
	font-family:SimSun;}
.MsoChpDefault
	{mso-style-type:export-only;}
/* Page Definitions */
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;}
div.WordSection1
	{page:WordSection1;}
--&gt;&lt;/style&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapelayout v:ext="edit"&gt;
&lt;o:idmap v:ext="edit" data="1" /&gt;
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
&lt;/head&gt;
&lt;body lang="ZH-CN" link="#0563C1" vlink="#954F72" \
style="text-justify-trim:punctuation"&gt; &lt;div class="WordSection1"&gt;
&lt;p class="MsoNormal"&gt;&lt;span lang="EN-US"&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal"&gt;&lt;span lang="EN-US"&gt;Hello, &lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal"&gt;&lt;span lang="EN-US"&gt;I have been confused by such a phenomenon \
recently. &lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal"&gt;&lt;span lang="EN-US"&gt;Libvirt is the master branch , and the VM is \
centos8.2(kernel is 4.18.0-193.el8.aarch64).&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p \
class="MsoNormal"&gt;&lt;span lang="EN-US"&gt;When I hot-plug the scsi disk for a virtual \
machine without a virtio-scsi controller, libvirt will automatically generate an \
lsilogic controller for the scsi disk.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;&lt;disk type='file' device='disk'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; \
&lt;p class="MsoNormal" style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span \
lang="EN-US" style="font-size:9.0pt"&gt;  &lt;driver name='qemu' type='qcow2' \
cache='none' io='native'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;  &lt;/span&gt;&lt;span lang="FR" \
style="font-size:9.0pt"&gt;&lt;source \
file='/Images/xcc/tmp.img'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span lang="FR" \
style="font-size:9.0pt"&gt;  &lt;/span&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;&lt;backingStore/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p \
class="MsoNormal" style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span \
lang="EN-US" style="font-size:9.0pt"&gt;  &lt;target dev='sdt' \
bus='scsi'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;&lt;address type='drive' controller='0' bus='0' target='0' \
unit='0'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;&lt;/disk&gt;&lt;/span&gt;&lt;span lang="EN-US"&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; \
&lt;p class="MsoNormal" style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span \
lang="EN-US"&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt;color:#C00000"&gt;linux-upcHIq:/Images/xcc #&lt;/span&gt;&lt;span \
lang="EN-US" style="font-size:9.0pt"&gt; virsh list&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p \
class="MsoNormal" style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span \
lang="EN-US" style="font-size:9.0pt"&gt;Id   Name   \
State&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;----------------------&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p \
class="MsoNormal" style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span \
lang="EN-US" style="font-size:9.0pt"&gt;12   g1     \
running&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt;color:#C00000"&gt;linux-upcHIq:/Images/xcc #&lt;/span&gt;&lt;span \
lang="EN-US" style="font-size:9.0pt"&gt; virsh attach-device g1 \
disk.xml&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;b&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;Device attached successfully&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/b&gt;&lt;/p&gt; &lt;p \
class="MsoNormal" style="text-indent:9.0pt"&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt;color:#C00000"&gt;linux-upcHIq:/Images/xcc #&lt;/span&gt;&lt;span \
lang="EN-US" style="font-size:9.0pt"&gt; virsh dumpxml g1 | grep \
scsi&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:21.0pt;mso-para-margin-left:2.0gd"&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;      &lt;target dev='sdt' \
bus='scsi'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:21.0pt;mso-para-margin-left:2.0gd"&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;      &lt;alias \
name='scsi0-0-0'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:21.0pt;mso-para-margin-left:2.0gd"&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;    &lt;controller type='scsi' index='0' \
model='lsilogic'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:21.0pt;mso-para-margin-left:2.0gd"&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;      &lt;alias \
name='scsi0'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:21.0pt;mso-para-margin-left:2.0gd"&gt;&lt;span \
lang="EN-US"&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span lang="EN-US"&gt;But \
this scsi disk cannot be found through the lsblk command inside the virtual \
machine.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:31.5pt;mso-para-margin-left:3.0gd"&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;[root@localhost ~]# lsblk&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p \
class="MsoNormal" style="margin-left:31.5pt;mso-para-margin-left:3.0gd"&gt;&lt;span \
lang="EN-US" style="font-size:9.0pt"&gt;NAME        \
MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:31.5pt;mso-para-margin-left:3.0gd"&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;vda         \
252:0    0   20G  0 disk&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p \
class="MsoNormal" style="margin-left:31.5pt;mso-para-margin-left:3.0gd"&gt;&lt;span \
style="font-size:9.0pt;font-family:SimSun"&gt;†€&lt;/span&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;vda1      252:1    \
0  600M  0 part /boot/efi&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:31.5pt;mso-para-margin-left:3.0gd"&gt;&lt;span \
style="font-size:9.0pt;font-family:SimSun"&gt;†€&lt;/span&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;vda2      252:2    \
0    1G  0 part /boot&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:31.5pt;mso-para-margin-left:3.0gd"&gt;&lt;span \
style="font-size:9.0pt;font-family:SimSun"&gt;„€&lt;/span&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;vda3      252:3    0 \
18.4G  0 part&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:31.5pt;mso-para-margin-left:3.0gd"&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;  &lt;/span&gt;&lt;span \
style="font-size:9.0pt;font-family:SimSun"&gt;†€&lt;/span&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;cl-root 253:0    0 16.4G  0 lvm  \
/&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:31.5pt;mso-para-margin-left:3.0gd"&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;  &lt;/span&gt;&lt;span \
style="font-size:9.0pt;font-family:SimSun"&gt;„€&lt;/span&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;cl-swap 253:1    0    2G  \
0 lvm  [SWAP]&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span \
lang="EN-US"&gt;After hot unplugging the scsi disk, I performed the hot unplug operation \
of the lsilogic controller. libvirt shows "Device detached successfully", \
but in fact, the lsilogic controller is not removed from the live XML  and persistent \
XML. Through "virsh dumpxml vmname" and "virsh edit vmname", I \
can see &lt;controller type='scsi' index='0' model='lsilogic'&gt; is always \
there.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span \
lang="EN-US"&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt;color:#C00000"&gt;linux-upcHIq:/Images/xcc #&lt;/span&gt;&lt;span \
lang="EN-US" style="font-size:9.0pt"&gt; virsh detach-device g1 \
disk.xml&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;b&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;Device detached successfully&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/b&gt;&lt;/p&gt; &lt;p \
class="MsoNormal" style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span \
lang="EN-US" style="font-size:9.0pt;color:#C00000"&gt;linux-upcHIq:/Images/xcc # \
&lt;/span&gt;&lt;span lang="EN-US" style="font-size:9.0pt"&gt;virsh dumpxml g1 | grep \
scsi&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;    &lt;controller type='scsi' index='0' \
model='lsilogic'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;      &lt;alias \
name='scsi0'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt;color:#C00000"&gt;linux-upcHIq:/Images/xcc \
#&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt;color:#C00000"&gt;linux-upcHIq:/Images/xcc #&lt;/span&gt;&lt;span \
lang="EN-US" style="font-size:9.0pt"&gt; cat lsi.xml&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p \
class="MsoNormal" style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span \
lang="EN-US" style="font-size:9.0pt"&gt;&lt;controller type='scsi' index='0' \
model='lsilogic'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;  &lt;alias name='scsi0'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p \
class="MsoNormal" style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span \
lang="EN-US" style="font-size:9.0pt"&gt;  &lt;address type='pci' domain='0x0000' \
bus='0x03' slot='0x05' function='0x0'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;&lt;/controller&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p \
class="MsoNormal" style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span \
lang="EN-US" style="font-size:9.0pt;color:#C00000"&gt;linux-upcHIq:/Images/xcc \
#&lt;/span&gt;&lt;span lang="EN-US" style="font-size:9.0pt"&gt; virsh detach-device g1 \
lsi.xml&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;Device detached successfully&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p \
class="MsoNormal" style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span \
lang="EN-US" style="font-size:9.0pt"&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p \
class="MsoNormal" style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span \
lang="EN-US" style="font-size:9.0pt;color:#C00000"&gt;linux-upcHIq:/Images/xcc \
#&lt;/span&gt;&lt;span lang="EN-US" style="font-size:9.0pt"&gt; virsh dumpxml g1 | grep \
scsi&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;    &lt;controller type='scsi' index='0' \
model='lsilogic'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal" \
style="margin-left:10.5pt;mso-para-margin-left:1.0gd"&gt;&lt;span lang="EN-US" \
style="font-size:9.0pt"&gt;      &lt;alias \
name='scsi0'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span \
lang="EN-US"&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span lang="EN-US"&gt;I \
am confused, why libvirt chooses to generate an lsilogic controller for the scsi disk \
when there is no scsi controller, instead of directly reporting an error and exiting \
the hot plug operation. After all, the scsi  disk based on the lsilogic controller is \
not perceived inside the virtual machine, and lsilogic will remain in the XML file of \
the virtual machine.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span \
lang="EN-US"&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20210216085152</emailId><senderName>Michal Privoznik</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-02-16 08:51:52-0400</timestampReceived><subject>Re: Upgrading the host</subject><body>

On 2/12/21 2:10 AM, Marcin Struzak wrote:
&gt; Hello--
&gt; 
&gt; I'm planning on upgrading the OS on my host machine by doing manual 
&gt; re-installation, which will trigger an upgrade of libvirt from 1.1.3 to 
&gt; 6.1.0.  Hardware, storage volumes &amp; paths, etc., will be the same after 
&gt; upgrade.
&gt; 
&gt; I was going to redefine &amp; start everything from .xml files, starting 
&gt; with the network
&gt; 
&gt;      virsh net-define &lt;network XML&gt;
&gt;      virsh net-autostart &lt;network&gt;
&gt;      virsh net-start &lt;network&gt;
&gt; 
&gt; and following with all the guests
&gt; 
&gt;      virsh define &lt;domain XML&gt;
&gt;      virsh autostart &lt;domain&gt;
&gt;      virsh start &lt;domain&gt;

If you are just upgrading the libvirt package then you do not need to do 
any of this. Libvirt picks everything up after it's restarted. But if 
you are installing host from scratch then ..

&gt; 
&gt; I have the following questions:
&gt; 
&gt;  1. Do I need to generate XML dumps manually, or is it ok to use the
&gt;     ones from host's /etc/libvirt?

.. yes, back up XMls here and use define &amp; start as you suggested.

&gt;  2. Do I need to define &amp; start storage pools &amp; volumes explicitly, or
&gt;     will they be picked up from domain definitions?

Storage pools won't be defined automatically. You need to save their 
XMLs too. You can find them under /etc/libvirt/storage/. Don't forget on 
secrets if you use them too.

&gt;  3. Anything else I should worry about or prepare ahead?

Not strictly related to libvirt, but machine types might be problem. I 
guess qemu will be upgraded too and in general the machine type you're 
using for a domain might not be available in upgraded qemu.

You can view supported machine types by running 'virsh capabilities' 
with upgraded qemu.

Good luck!

Michal

</body></email><email><emailId>20210216090233</emailId><senderName>Erik Skultety</senderName><senderEmail>eskultet@redhat.com</senderEmail><timestampReceived>2021-02-16 09:02:33-0400</timestampReceived><subject>Re: Upgrading the host</subject><body>

On Tue, Feb 16, 2021 at 09:51:52AM +0100, Michal Privoznik wrote:
&gt; On 2/12/21 2:10 AM, Marcin Struzak wrote:
&gt; &gt; Hello--
&gt; &gt; 
&gt; &gt; I'm planning on upgrading the OS on my host machine by doing manual
&gt; &gt; re-installation, which will trigger an upgrade of libvirt from 1.1.3 to
&gt; &gt; 6.1.0.  Hardware, storage volumes &amp; paths, etc., will be the same after
&gt; &gt; upgrade.
&gt; &gt; 
&gt; &gt; I was going to redefine &amp; start everything from .xml files, starting
&gt; &gt; with the network
&gt; &gt; 
&gt; &gt;      virsh net-define &lt;network XML&gt;
&gt; &gt;      virsh net-autostart &lt;network&gt;
&gt; &gt;      virsh net-start &lt;network&gt;
&gt; &gt; 
&gt; &gt; and following with all the guests
&gt; &gt; 
&gt; &gt;      virsh define &lt;domain XML&gt;
&gt; &gt;      virsh autostart &lt;domain&gt;
&gt; &gt;      virsh start &lt;domain&gt;
&gt; 
&gt; If you are just upgrading the libvirt package then you do not need to do any
&gt; of this. Libvirt picks everything up after it's restarted. But if you are
&gt; installing host from scratch then ..
&gt; 
&gt; &gt; 
&gt; &gt; I have the following questions:
&gt; &gt; 
&gt; &gt;  1. Do I need to generate XML dumps manually, or is it ok to use the
&gt; &gt;     ones from host's /etc/libvirt?
&gt; 
&gt; .. yes, back up XMls here and use define &amp; start as you suggested.
&gt; 
&gt; &gt;  2. Do I need to define &amp; start storage pools &amp; volumes explicitly, or
&gt; &gt;     will they be picked up from domain definitions?
&gt; 
&gt; Storage pools won't be defined automatically. You need to save their XMLs
&gt; too. You can find them under /etc/libvirt/storage/. Don't forget on secrets
&gt; if you use them too.

Needless to say, if you're backing up /etc/libvirt/&lt;whatever&gt; make sure
libvirtd is down first, so that all the settings are properly dumped by the
daemon to the respective XMLs.

Erik

</body></email><email><emailId>20210217014555</emailId><senderName>Marcin Struzak</senderName><senderEmail>kunci@struzak.com</senderEmail><timestampReceived>2021-02-17 01:45:55-0400</timestampReceived><subject>Re: Upgrading the host</subject><body>

On 2/16/2021 12:51 AM, Michal Privoznik wrote:
&gt; On 2/12/21 2:10 AM, Marcin Struzak wrote:
&gt; [...]
&gt;
&gt;&gt;   3. Anything else I should worry about or prepare ahead?
&gt;
&gt; Not strictly related to libvirt, but machine types might be problem. I 
&gt; guess qemu will be upgraded too and in general the machine type you're 
&gt; using for a domain might not be available in upgraded qemu.
Correct, it looks like qemu will go from 1.6.2 to 4.2.1...
&gt;
&gt; You can view supported machine types by running 'virsh capabilities' 
&gt; with upgraded qemu.
machine is pc-i440fx-1.6 in all my domains.   Is there a simple way to 
figure out if that's supported in libvirt 6.1.0 (without installing it)?
&gt;
&gt; Good luck!
&gt;
&gt; Michal
&gt;
Thank you for a quick &amp; detailed answer.

--Marcin

</body></email><email><emailId>20210217015934</emailId><senderName>Marcin Struzak</senderName><senderEmail>kunci@struzak.com</senderEmail><timestampReceived>2021-02-17 01:59:34-0400</timestampReceived><subject>Re: Upgrading the host</subject><body>

On 2/16/2021 1:02 AM, Erik Skultety wrote:
&gt; [...]
&gt; Needless to say, if you're backing up /etc/libvirt/&lt;whatever&gt; make sure
&gt; libvirtd is down first, so that all the settings are properly dumped by the
&gt; daemon to the respective XMLs.
&gt;
&gt; Erik

Absolutely!   Not concerned about downtime here, just that after the 
upgrade everything comes back up like before.

Speaking of settings dumped into XMLs, why are the files in 
/etc/libvirt/qemu ever so slightly different from a manual dump using 
virsh dumpxml &amp; friends?   E.g., for a domain I have a section

&lt;resource&gt;
    &lt;partition&gt;/machine&lt;/partition&gt;
&lt;/resource&gt;

&lt;alias ... /&gt; entries for all devices, a tty attribute &amp; &lt;source ... /&gt; 
for console, etc., in the manual dump only?

--Marcin

</body></email><email><emailId>20210224134237</emailId><senderName>Guoyi Tu</senderName><senderEmail>tugy@chinatelecom.cn</senderEmail><timestampReceived>2021-02-24 13:42:37-0400</timestampReceived><subject>Question about migrate the vm with host-passthrough cpu</subject><body>

Hi there,

Sorry to bother you, but could I ask you a question about the live 
migration of virtual machine configured with host-passthough cpu, it 
confuse me a lot.

Here i have two hosts with different cpu, and the cpu feature set of old
host is subset of the new one (by virsh cpu-compare). If the vm was 
first started on the old host,is it safe to migrate the vm between the 
two hosts back and forth with the vm always keep running?

I've test the case in my environment, and the migration succeeds, the 
cpu family/model/stepping and features of lscpu in Guest OS is the same.


-- 
Best Regards,
Guoyi Tu

</body></email><email><emailId>20210224174919</emailId><senderName>David Wells</senderName><senderEmail>dwells@alfavinil.com</senderEmail><timestampReceived>2021-02-24 17:49:19-0400</timestampReceived><subject>Live backups create-snapshot-as and memspec</subject><body>

Hi all!

I've been using libvirt for some time and until now I have treated 
backups of virtual computers as if they where physical computers 
installing the backup client on the guest. I am now however facing the 
need to backup a couple a couple of guest at the host level so I've been 
trying to catch up by reading, googling and by trial and error too. Up 
to now I've been able to backup a live machine whith a command like the 
following

&gt; virsh snapshot-create-as --domain test --name backup --atomic 
&gt; --diskspec vda,snapshot=external --disk-only

This command creates a file test.backup and in the meantime I can backup 
the original test.qcow2 but for what I saw this disk image is in a 
"dirty" state, as if the machine I could restore from this file had been 
turned off whithout a proper shutdown.

I know that I can later restore the machine to its original state by 
issuing a command like this

&gt; virsh blockcommit --domain test vda --active --pivot
&gt; virsh snapshot-delete test --metadata backup

I have seen that it is possible to create the snapshot using a memspec 
parameter which would make the backup of the guest as if it where in a 
clean state, however I haven't found the equivalent of the blockcommit 
for the memory file, in a sort of speak, to be able to restore the guest 
to it's original state.

Thank you very much!
Best regards.
David Wells.

</body></email><email><emailId>20210101092441</emailId><senderName>vrms</senderName><senderEmail>vrms@netcologne.de</senderEmail><timestampReceived>2021-01-01 09:24:41-0400</timestampReceived><subject>relation between "virbr0" / "virbr0-nic" network interfaces</subject><body>

I am trying to understand KVM networking a little better and have noted
that the "virbr0" network interface (the default KVM bridge) comes with
another device named "virbr0-nic".
The same kind of pair comes with each new bridge you may create via the
"virtual machine manager" (and assumingly other KVM tools alike)
Like "virbr1" comes in a pair with "virbr1-nic" (the *-nic interface is
being created automatically (and I assume will disapear automatically if
you remove the parent interface)

Can anybody kindly explain how these pairs are related to each other
and/or work together?

thanks ... Gunnar



</body></email><email><emailId>20210105050541</emailId><senderName>Yalan Zhang</senderName><senderEmail>yalzhang@redhat.com</senderEmail><timestampReceived>2021-01-05 05:05:41-0400</timestampReceived><subject>Re: about the script /etc/qemu-ifup with nmcli command</subject><body>

Hi,

Could anyone familiar with NetworkManager help with this?
This question has been bothering me for a long time.
Thank you very much!

-------
Best Regards,
Yalan Zhang
IRC: yalzhang


On Wed, Oct 21, 2020 at 6:31 PM Yalan Zhang &lt;yalzhang@redhat.com&gt; wrote:

&gt; Hi,
&gt;
&gt; I have tried the qemu-ifup script as below with nmcli command as brctl is
&gt; deprecated on rhel8, but the guest network can not work.
&gt; I think the script needs update. Could you please help to have a look?
&gt; Thank you in advance.
&gt;
&gt; 1. prepare a linux bridge on the host named br0;
&gt;
&gt; 2. prepare the qemu-ifup script as below:
&gt; # cat /etc/qemu-ifup
&gt; #!/bin/bash
&gt; # A br0 bridge should be already set up.
&gt; # Compare with:
&gt; # http://en.wikibooks.org/wiki/QEMU/Networking#qemu-ifup
&gt; #
&gt; # For the bridge setup, see:
&gt; # http://wiki.libvirt.org/page/Networking#Fedora.2FRHEL_Bridging
&gt; # http://gist.github.com/393525
&gt; ip link set "$1" up
&gt; nmcli c add type bridge-slave ifname $1 con-name $1 master br0 autoconnect
&gt; yes
&gt;
&gt; 3. start vm with below interface setting:
&gt; # virsh dumpxml rh | grep /interface -B5
&gt;     &lt;interface type='ethernet'&gt;
&gt;       &lt;mac address='52:54:00:79:ba:dd'/&gt;
&gt;       &lt;script path='/etc/qemu-ifup'/&gt;
&gt;       &lt;model type='virtio'/&gt;
&gt;       &lt;address type='pci' domain='0x0000' bus='0x04' slot='0x00'
&gt; function='0x0'/&gt;
&gt;     &lt;/interface&gt;
&gt; # virsh start rh
&gt; Domain rh started
&gt;
&gt; 4.check on guest, the interface can not get dhcp ip address;
&gt;
&gt; 5. check on host,
&gt; # nmcli con
&gt; NAME    UUID                                  TYPE      DEVICE
&gt; br0     f68f73c7-10ee-40c1-bb09-3366d11ac896  bridge    br0
&gt; ...
&gt; vnet0   90a48d77-dccc-4b59-98f5-09f8cbd62458  ethernet  --
&gt;
&gt; # nmcli dev
&gt; DEVICE      TYPE      STATE                   CONNECTION
&gt; br0         bridge    connected               br0
&gt; ...
&gt; vnet0       tun       unmanaged               --
&gt;
&gt; 6. hotplug a bridge type interface and compare the tap devices:
&gt; # virsh attach-interface rh bridge br0 --model virtio
&gt; Interface attached successfully
&gt;
&gt; # nmcli con
&gt; NAME    UUID                                  TYPE      DEVICE
&gt; br0     f68f73c7-10ee-40c1-bb09-3366d11ac896  bridge    br0
&gt; vnet1   07c2a1f8-396f-4d5f-b61f-ef2ddb42ed93  tun       vnet1    ---&gt;the
&gt; hot-plugged one
&gt; ...
&gt; vnet0   90a48d77-dccc-4b59-98f5-09f8cbd62458  ethernet  --       ----&gt; the
&gt; ethernet one
&gt;
&gt; # nmcli dev
&gt; DEVICE      TYPE      STATE                   CONNECTION
&gt; vnet1       tun       connected (externally)  vnet1         ---&gt;the
&gt; hot-plugged one
&gt; vnet0       tun       unmanaged               --     ----&gt; the ethernet one
&gt; ...
&gt;
&gt; 7. from the outputs above, the back-end tun device for ethernet type
&gt; interface is unmanaged.
&gt; I don't know how to update the script to fix it. Could you please help?
&gt;
&gt;
&gt; -------
&gt; Best Regards,
&gt; Yalan Zhang
&gt; IRC: yalzhang
&gt;

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div&gt;Hi,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Could anyone familiar with \
NetworkManager help with this?&lt;/div&gt;&lt;div&gt;This question has been bothering me for a \
long time.&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thank you very much!&lt;/div&gt;&lt;div&gt;&lt;div dir="ltr" \
class="gmail_signature" data-smartmail="gmail_signature"&gt;&lt;div \
dir="ltr"&gt;&lt;div&gt;&lt;br&gt;-------&lt;br&gt;Best Regards,&lt;br&gt;Yalan Zhang&lt;br&gt;IRC: \
yalzhang&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div \
dir="ltr" class="gmail_attr"&gt;On Wed, Oct 21, 2020 at 6:31 PM Yalan Zhang &lt;&lt;a \
href="mailto:yalzhang@redhat.com"&gt;yalzhang@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;&lt;div \
dir="ltr"&gt;Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I have tried the qemu-ifup script as below with \
nmcli command as brctl is deprecated on rhel8, but the guest network can not \
work.&lt;/div&gt;&lt;div&gt;I think the script needs update. Could you please help to have a \
look?  &lt;/div&gt;&lt;div&gt;Thank you in advance.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;1. prepare a linux \
bridge on the host named br0;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;2. prepare the qemu-ifup \
script as below:&lt;/div&gt;&lt;div&gt;# cat /etc/qemu-ifup&lt;br&gt;#!/bin/bash&lt;br&gt;# A br0 bridge \
should be already set up.&lt;br&gt;# Compare with:&lt;br&gt;# &lt;a \
href="http://en.wikibooks.org/wiki/QEMU/Networking#qemu-ifup" \
target="_blank"&gt;http://en.wikibooks.org/wiki/QEMU/Networking#qemu-ifup&lt;/a&gt;&lt;br&gt;#&lt;br&gt;# \
For the bridge setup, see:&lt;br&gt;# &lt;a \
href="http://wiki.libvirt.org/page/Networking#Fedora.2FRHEL_Bridging" \
target="_blank"&gt;http://wiki.libvirt.org/page/Networking#Fedora.2FRHEL_Bridging&lt;/a&gt;&lt;br&gt;# \
&lt;a href="http://gist.github.com/393525" \
target="_blank"&gt;http://gist.github.com/393525&lt;/a&gt;&lt;br&gt;ip link set "$1" \
up&lt;br&gt;nmcli c add type bridge-slave ifname $1 con-name $1 master br0 autoconnect \
yes&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;3. start vm with below interface \
setting:&lt;/div&gt;&lt;div&gt;# virsh dumpxml rh | grep /interface -B5&lt;br&gt;      &lt;interface \
type='ethernet'&gt;&lt;br&gt;         &lt;mac \
address='52:54:00:79:ba:dd'/&gt;&lt;br&gt;         &lt;script \
path='/etc/qemu-ifup'/&gt;&lt;br&gt;         &lt;model \
type='virtio'/&gt;&lt;br&gt;         &lt;address type='pci' \
domain='0x0000' bus='0x04' slot='0x00' \
function='0x0'/&gt;&lt;br&gt;      &lt;/interface&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;# virsh start \
rh&lt;br&gt;Domain rh started&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;4.check on guest, the interface \
can not get dhcp ip address;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;5. check on host,  &lt;/div&gt;&lt;div&gt;# \
nmcli con&lt;br&gt;&lt;/div&gt;&lt;div&gt;NAME      UUID                                                \
TYPE         DEVICE &lt;br&gt;br0       f68f73c7-10ee-40c1-bb09-3366d11ac896   bridge      \
br0    &lt;br&gt;&lt;/div&gt;&lt;div&gt;...&lt;/div&gt;&lt;div&gt;vnet0    90a48d77-dccc-4b59-98f5-09f8cbd62458   \
ethernet   --     &lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;# nmcli dev&lt;br&gt;DEVICE         TYPE    \
STATE                            CONNECTION &lt;br&gt;br0             bridge      connected \
br0            &lt;br&gt;...     &lt;br&gt;vnet0          tun          unmanaged                  \
--     &lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;6. hotplug a bridge type interface and compare \
the tap devices:&lt;/div&gt;&lt;div&gt;# virsh attach-interface rh bridge br0 --model \
virtio&lt;br&gt;Interface attached successfully&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;# nmcli con \
&lt;br&gt;NAME      UUID                                                   TYPE         \
DEVICE &lt;br&gt;br0       f68f73c7-10ee-40c1-bb09-3366d11ac896   bridge      br0      \
&lt;br&gt;vnet1    07c2a1f8-396f-4d5f-b61f-ef2ddb42ed93   tun          vnet1      \
---&gt;the hot-plugged one&lt;/div&gt;&lt;div&gt;...&lt;br&gt;vnet0    \
90a48d77-dccc-4b59-98f5-09f8cbd62458   ethernet   --           ----&gt; the ethernet \
one&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;# nmcli dev&lt;br&gt;DEVICE         TYPE         STATE     \
CONNECTION &lt;br&gt;vnet1          tun          connected (externally)   vnet1             \
---&gt;the hot-plugged one&lt;br&gt;vnet0          tun          unmanaged                   \
--         ----&gt; the ethernet one&lt;br&gt;&lt;/div&gt;&lt;div&gt;...&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;7. \
from the outputs above, the back-end tun device for ethernet type interface is \
unmanaged.  &lt;/div&gt;&lt;div&gt;I don't know how to update the script to fix it. Could you \
please help?&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div dir="ltr"&gt;&lt;div \
dir="ltr"&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;-------&lt;br&gt;Best Regards,&lt;br&gt;Yalan Zhang&lt;br&gt;IRC: \
yalzhang&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt; &lt;/blockquote&gt;&lt;/div&gt;



</body></email><email><emailId>20210102132532</emailId><senderName>Oliver Dzombic</senderName><senderEmail>info@layer7.net</senderEmail><timestampReceived>2021-01-02 13:25:32-0400</timestampReceived><subject>Migration via qemu+ssh using a given private ssh key possible ?</subject><body>

Hi,

happy new year!

Is there a way to tell libvirt to migrate an instance via qemu+ssh using
a specific ssh key ?

It seems libvirt will always try to use the .ssh/id_rsa private key.

But i would like to somehow tell libvirt to use a specific private ssh
key. ( At best via command line argument ).

Is that possible somehow ? Or something else similar ?

Thank you!

-- 
Mit freundlichen Gruessen / Best regards

Oliver Dzombic
Layer7 Networks

mailto:info@layer7.net

Anschrift:

Layer7 Networks GmbH
Zum Sonnenberg 1-3
63571 Gelnhausen

HRB 96293 beim Amtsgericht Hanau
Geschäftsführung: Oliver Dzombic
UST ID: DE259845632


</body></email><email><emailId>20210106151624</emailId><senderName>Nir Soffer</senderName><senderEmail>nsoffer@redhat.com</senderEmail><timestampReceived>2021-01-06 15:16:24-0400</timestampReceived><subject>Re: [ovirt-devel] Issue: Device path changed after adding disks to guest VM</subject><body>

On Wed, Dec 2, 2020 at 4:57 PM Joy Li &lt;joooy.li@gmail.com&gt; wrote:
&gt; 
&gt; Thanks a lot Nir! Good to know that oVirt cannot guarantee the disk names so that I \
&gt; don't need to spend more time trying to enable such a feature. 
&gt; I can always reproduce the problem via my application, basically, the procedure is \
&gt; as following: 
&gt; 1. create a VM

Which guest OS? Can you share the guest disk image or ISO image used
to instal it?

&gt; 2. add disks to the VM (e.g.: disk names: disk1, disk3)
&gt; 3. check the disk mappings via `virsh domblklist `

Please shared the libvirt domain xml (virsh dumpxml vm-name)

&gt; 4. add another disk (let's say, disk2, give a name alphabetically before some \
&gt; existing disks)

Add disk while the vm is running (hotplug)?

&gt; 5. shutdown the VM via hypervisor and start it again (reboot won't work)

What do you mean by "reboot does not work?"

&gt; 6. `virsh domblklist` again, then you might see the problem I mentioned before

Mapping is different compared with state before the reboot?

&gt; There are no virtio devices inside /dev/disk/by-id/xxx of my guest VM.

Maybe you don't have systemd-udev installed?

The links in /dev/disk/... are created by udev during startup, and
when detecting a new disk.

&gt; And I just noticed that the disks mapping information given by hypervisor (from VM \
&gt; configuration or virsh command) is different from the reality inside the VM. The \
&gt; disk name inside the VM was actually not changed. 
&gt; So now my issue is that given a disk name (/dev/vdb) of a VM, how can I get its \
&gt; wwid? Before I got it from the hypervisor, but now the hypervisor's information is \
&gt; not reliable, and since the disk is unformatted, I cannot use UUID.

You can use:

# udevadm info /dev/vda
P: /devices/pci0000:00/0000:00:02.5/0000:06:00.0/virtio4/block/vda
N: vda
L: 0
S: disk/by-path/pci-0000:06:00.0
S: disk/by-id/virtio-b97e68b2-87ea-45ca-9
S: disk/by-path/virtio-pci-0000:06:00.0
E: DEVPATH=/devices/pci0000:00/0000:00:02.5/0000:06:00.0/virtio4/block/vda
E: DEVNAME=/dev/vda
E: DEVTYPE=disk
E: MAJOR=252
E: MINOR=0
E: SUBSYSTEM=block
E: USEC_INITIALIZED=10518442
E: ID_SERIAL=b97e68b2-87ea-45ca-9
E: ID_PATH=pci-0000:06:00.0
E: ID_PATH_TAG=pci-0000_06_00_0
E: DEVLINKS=/dev/disk/by-path/pci-0000:06:00.0
/dev/disk/by-id/virtio-b97e68b2-87ea-45ca-9
/dev/disk/by-path/virtio-pci-0000:06:00.0
E: TAGS=:systemd:

I tried to reproduce you issue 4.4.5 development build:

Starting vm with 2 direct LUN disks:

# virsh -r dumpxml disk-mapping
...
    &lt;disk type='block' device='disk' snapshot='no'&gt;
      &lt;driver name='qemu' type='qcow2' cache='none'
error_policy='stop' io='native' discard='unmap'/&gt;
      &lt;source dev='/rhev/data-center/mnt/blockSD/84dc4e3c-00fd-4263-84e8-fc246eeee6e9/ \
images/40018b33-2b11-4d10-82e4-604a5b135fb2/40f455c4-8c92-4f8f-91c2-991b0ddfc2f5' \
index='3'&gt;  &lt;seclabel model='dac' relabel='no'/&gt;
      &lt;/source&gt;
      &lt;backingStore type='block' index='5'&gt;
        &lt;format type='qcow2'/&gt;
        &lt;source
dev='/rhev/data-center/mnt/blockSD/84dc4e3c-00fd-4263-84e8-fc246eeee6e9/images/40018b33-2b11-4d10-82e4-604a5b135fb2/ad891316-b80a-4ab5-895b-400108bd0ca1'&gt;
  &lt;seclabel model='dac' relabel='no'/&gt;
        &lt;/source&gt;
        &lt;backingStore/&gt;
      &lt;/backingStore&gt;
      &lt;target dev='sda' bus='scsi'/&gt;
      &lt;serial&gt;40018b33-2b11-4d10-82e4-604a5b135fb2&lt;/serial&gt;
      &lt;boot order='1'/&gt;
      &lt;alias name='ua-40018b33-2b11-4d10-82e4-604a5b135fb2'/&gt;
      &lt;address type='drive' controller='0' bus='0' target='0' unit='0'/&gt;
    &lt;/disk&gt;
    &lt;disk type='block' device='disk' snapshot='no'&gt;
      &lt;driver name='qemu' type='raw' cache='none' error_policy='stop'
io='native' iothread='1'/&gt;
      &lt;source dev='/dev/mapper/3600140594af345ed76d42058f2b1a454' index='2'&gt;
        &lt;seclabel model='dac' relabel='no'/&gt;
      &lt;/source&gt;
      &lt;backingStore/&gt;
      &lt;target dev='vda' bus='virtio'/&gt;
      &lt;serial&gt;b97e68b2-87ea-45ca-94fb-277d5b30baa2&lt;/serial&gt;
      &lt;alias name='ua-b97e68b2-87ea-45ca-94fb-277d5b30baa2'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x06' slot='0x00'
function='0x0'/&gt;
    &lt;/disk&gt;
    &lt;disk type='block' device='disk' snapshot='no'&gt;
      &lt;driver name='qemu' type='raw' cache='none' error_policy='stop'
io='native' iothread='1'/&gt;
      &lt;source dev='/dev/mapper/360014050058f2f8a0474dc7a8a7cc6a5' index='1'&gt;
        &lt;seclabel model='dac' relabel='no'/&gt;
      &lt;/source&gt;
      &lt;backingStore/&gt;
      &lt;target dev='vdb' bus='virtio'/&gt;
      &lt;serial&gt;d9a29187-f492-4a0d-aea2-7d5216c957d7&lt;/serial&gt;
      &lt;alias name='ua-d9a29187-f492-4a0d-aea2-7d5216c957d7'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x07' slot='0x00'
function='0x0'/&gt;
    &lt;/disk&gt;
...

# virsh -r domblklist disk-mapping
 Target   Source
---------------------------------------------------------------------------------------------------------------------------------------------------------------
  sdc      -
 sda      /rhev/data-center/mnt/blockSD/84dc4e3c-00fd-4263-84e8-fc246eeee6e9/images/40018b33-2b11-4d10-82e4-604a5b135fb2/40f455c4-8c92-4f8f-91c2-991b0ddfc2f5
  vda      /dev/mapper/3600140594af345ed76d42058f2b1a454
 vdb      /dev/mapper/360014050058f2f8a0474dc7a8a7cc6a5

In guest:

# ls -lh /dev/disk/by-id/virtio-*
lrwxrwxrwx. 1 root root 9 Jan  6 09:42
/dev/disk/by-id/virtio-b97e68b2-87ea-45ca-9 -&gt; ../../vda
lrwxrwxrwx. 1 root root 9 Jan  6 09:42
/dev/disk/by-id/virtio-d9a29187-f492-4a0d-a -&gt; ../../vdb

NOTE: "d9a29187-f492-4a0d-a" are the first characters of the disk id:
"d9a29187-f492-4a0d-aea2-7d5216c957d7"
seen in oVirt:
https://my-engine/ovirt-engine/webadmin/?locale=en_US#disks-general;id=d9a29187-f492-4a0d-aea2-7d5216c957d7



Adding another disk in sorted in the middle (while the vm is running):

# virsh -r dumpxml disk-mapping
...
    &lt;disk type='block' device='disk' snapshot='no'&gt;
      &lt;driver name='qemu' type='qcow2' cache='none'
error_policy='stop' io='native' discard='unmap'/&gt;
      &lt;source dev='/rhev/data-center/mnt/blockSD/84dc4e3c-00fd-4263-84e8-fc246eeee6e9/ \
images/40018b33-2b11-4d10-82e4-604a5b135fb2/40f455c4-8c92-4f8f-91c2-991b0ddfc2f5' \
index='3'&gt;  &lt;seclabel model='dac' relabel='no'/&gt;
      &lt;/source&gt;
      &lt;backingStore type='block' index='5'&gt;
        &lt;format type='qcow2'/&gt;
        &lt;source
dev='/rhev/data-center/mnt/blockSD/84dc4e3c-00fd-4263-84e8-fc246eeee6e9/images/40018b33-2b11-4d10-82e4-604a5b135fb2/ad891316-b80a-4ab5-895b-400108bd0ca1'&gt;
  &lt;seclabel model='dac' relabel='no'/&gt;
        &lt;/source&gt;
        &lt;backingStore/&gt;
      &lt;/backingStore&gt;
      &lt;target dev='sda' bus='scsi'/&gt;
      &lt;serial&gt;40018b33-2b11-4d10-82e4-604a5b135fb2&lt;/serial&gt;
      &lt;boot order='1'/&gt;
      &lt;alias name='ua-40018b33-2b11-4d10-82e4-604a5b135fb2'/&gt;
      &lt;address type='drive' controller='0' bus='0' target='0' unit='0'/&gt;
    &lt;/disk&gt;
    &lt;disk type='block' device='disk' snapshot='no'&gt;
      &lt;driver name='qemu' type='raw' cache='none' error_policy='stop'
io='native' iothread='1'/&gt;
      &lt;source dev='/dev/mapper/3600140594af345ed76d42058f2b1a454' index='2'&gt;
        &lt;seclabel model='dac' relabel='no'/&gt;
      &lt;/source&gt;
      &lt;backingStore/&gt;
      &lt;target dev='vda' bus='virtio'/&gt;
      &lt;serial&gt;b97e68b2-87ea-45ca-94fb-277d5b30baa2&lt;/serial&gt;
      &lt;alias name='ua-b97e68b2-87ea-45ca-94fb-277d5b30baa2'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x06' slot='0x00'
function='0x0'/&gt;
    &lt;/disk&gt;
    &lt;disk type='block' device='disk' snapshot='no'&gt;
      &lt;driver name='qemu' type='raw' cache='none' error_policy='stop'
io='native' iothread='1'/&gt;
      &lt;source dev='/dev/mapper/360014050058f2f8a0474dc7a8a7cc6a5' index='1'&gt;
        &lt;seclabel model='dac' relabel='no'/&gt;
      &lt;/source&gt;
      &lt;backingStore/&gt;
      &lt;target dev='vdb' bus='virtio'/&gt;
      &lt;serial&gt;d9a29187-f492-4a0d-aea2-7d5216c957d7&lt;/serial&gt;
      &lt;alias name='ua-d9a29187-f492-4a0d-aea2-7d5216c957d7'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x07' slot='0x00'
function='0x0'/&gt;
    &lt;/disk&gt;
    &lt;disk type='block' device='disk' snapshot='no'&gt;
      &lt;driver name='qemu' type='raw' cache='none' error_policy='stop'
io='native' iothread='1'/&gt;
      &lt;source dev='/dev/mapper/36001405b4d0c0b7544d47438b21296ef' index='7'&gt;
        &lt;seclabel model='dac' relabel='no'/&gt;
      &lt;/source&gt;
      &lt;backingStore/&gt;
      &lt;target dev='vdc' bus='virtio'/&gt;
      &lt;serial&gt;e801c2e4-dc2e-4c53-b17b-bf6de99f16ed&lt;/serial&gt;
      &lt;alias name='ua-e801c2e4-dc2e-4c53-b17b-bf6de99f16ed'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x09' slot='0x00'
function='0x0'/&gt;
    &lt;/disk&gt;
...


# virsh -r domblklist disk-mapping
 Target   Source
---------------------------------------------------------------------------------------------------------------------------------------------------------------
  sdc      -
 sda      /rhev/data-center/mnt/blockSD/84dc4e3c-00fd-4263-84e8-fc246eeee6e9/images/40018b33-2b11-4d10-82e4-604a5b135fb2/40f455c4-8c92-4f8f-91c2-991b0ddfc2f5
  vda      /dev/mapper/3600140594af345ed76d42058f2b1a454
 vdb      /dev/mapper/360014050058f2f8a0474dc7a8a7cc6a5
 vdc      /dev/mapper/36001405b4d0c0b7544d47438b21296ef

In the guest:

# ls -lh /dev/disk/by-id/virtio-*
lrwxrwxrwx. 1 root root 9 Jan  6 09:42
/dev/disk/by-id/virtio-b97e68b2-87ea-45ca-9 -&gt; ../../vda
lrwxrwxrwx. 1 root root 9 Jan  6 09:42
/dev/disk/by-id/virtio-d9a29187-f492-4a0d-a -&gt; ../../vdb
lrwxrwxrwx. 1 root root 9 Jan  6 09:51
/dev/disk/by-id/virtio-e801c2e4-dc2e-4c53-b -&gt; ../../vdc


Shutdown VM and start it again

# virsh -r dumpxml disk-mapping
...
    &lt;disk type='block' device='disk' snapshot='no'&gt;
      &lt;driver name='qemu' type='qcow2' cache='none'
error_policy='stop' io='native' discard='unmap'/&gt;
      &lt;source dev='/rhev/data-center/mnt/blockSD/84dc4e3c-00fd-4263-84e8-fc246eeee6e9/ \
images/40018b33-2b11-4d10-82e4-604a5b135fb2/40f455c4-8c92-4f8f-91c2-991b0ddfc2f5' \
index='4'&gt;  &lt;seclabel model='dac' relabel='no'/&gt;
      &lt;/source&gt;
      &lt;backingStore type='block' index='6'&gt;
        &lt;format type='qcow2'/&gt;
        &lt;source
dev='/rhev/data-center/mnt/blockSD/84dc4e3c-00fd-4263-84e8-fc246eeee6e9/images/40018b33-2b11-4d10-82e4-604a5b135fb2/ad891316-b80a-4ab5-895b-400108bd0ca1'&gt;
  &lt;seclabel model='dac' relabel='no'/&gt;
        &lt;/source&gt;
        &lt;backingStore/&gt;
      &lt;/backingStore&gt;
      &lt;target dev='sda' bus='scsi'/&gt;
      &lt;serial&gt;40018b33-2b11-4d10-82e4-604a5b135fb2&lt;/serial&gt;
      &lt;boot order='1'/&gt;
      &lt;alias name='ua-40018b33-2b11-4d10-82e4-604a5b135fb2'/&gt;
      &lt;address type='drive' controller='0' bus='0' target='0' unit='0'/&gt;
    &lt;/disk&gt;
    &lt;disk type='block' device='disk' snapshot='no'&gt;
      &lt;driver name='qemu' type='raw' cache='none' error_policy='stop'
io='native' iothread='1'/&gt;
      &lt;source dev='/dev/mapper/3600140594af345ed76d42058f2b1a454' index='3'&gt;
        &lt;seclabel model='dac' relabel='no'/&gt;
      &lt;/source&gt;
      &lt;backingStore/&gt;
      &lt;target dev='vda' bus='virtio'/&gt;
      &lt;serial&gt;b97e68b2-87ea-45ca-94fb-277d5b30baa2&lt;/serial&gt;
      &lt;alias name='ua-b97e68b2-87ea-45ca-94fb-277d5b30baa2'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x06' slot='0x00'
function='0x0'/&gt;
    &lt;/disk&gt;
    &lt;disk type='block' device='disk' snapshot='no'&gt;
      &lt;driver name='qemu' type='raw' cache='none' error_policy='stop'
io='native' iothread='1'/&gt;
      &lt;source dev='/dev/mapper/36001405b4d0c0b7544d47438b21296ef' index='2'&gt;
        &lt;seclabel model='dac' relabel='no'/&gt;
      &lt;/source&gt;
      &lt;backingStore/&gt;
      &lt;target dev='vdb' bus='virtio'/&gt;
      &lt;serial&gt;e801c2e4-dc2e-4c53-b17b-bf6de99f16ed&lt;/serial&gt;
      &lt;alias name='ua-e801c2e4-dc2e-4c53-b17b-bf6de99f16ed'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x09' slot='0x00'
function='0x0'/&gt;
    &lt;/disk&gt;
    &lt;disk type='block' device='disk' snapshot='no'&gt;
      &lt;driver name='qemu' type='raw' cache='none' error_policy='stop'
io='native' iothread='1'/&gt;
      &lt;source dev='/dev/mapper/360014050058f2f8a0474dc7a8a7cc6a5' index='1'&gt;
        &lt;seclabel model='dac' relabel='no'/&gt;
      &lt;/source&gt;
      &lt;backingStore/&gt;
      &lt;target dev='vdc' bus='virtio'/&gt;
      &lt;serial&gt;d9a29187-f492-4a0d-aea2-7d5216c957d7&lt;/serial&gt;
      &lt;alias name='ua-d9a29187-f492-4a0d-aea2-7d5216c957d7'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x07' slot='0x00'
function='0x0'/&gt;
    &lt;/disk&gt;
...

# virsh -r domblklist disk-mapping
 Target   Source
---------------------------------------------------------------------------------------------------------------------------------------------------------------
  sdc      -
 sda      /rhev/data-center/mnt/blockSD/84dc4e3c-00fd-4263-84e8-fc246eeee6e9/images/40018b33-2b11-4d10-82e4-604a5b135fb2/40f455c4-8c92-4f8f-91c2-991b0ddfc2f5
  vda      /dev/mapper/3600140594af345ed76d42058f2b1a454
 vdb      /dev/mapper/36001405b4d0c0b7544d47438b21296ef
 vdc      /dev/mapper/360014050058f2f8a0474dc7a8a7cc6a5


In the guest:

# ls -lh /dev/disk/by-id/virtio-*
lrwxrwxrwx. 1 root root 9 Jan  6 09:55
/dev/disk/by-id/virtio-b97e68b2-87ea-45ca-9 -&gt; ../../vda
lrwxrwxrwx. 1 root root 9 Jan  6 09:55
/dev/disk/by-id/virtio-d9a29187-f492-4a0d-a -&gt; ../../vdb
lrwxrwxrwx. 1 root root 9 Jan  6 09:55
/dev/disk/by-id/virtio-e801c2e4-dc2e-4c53-b -&gt; ../../vdc

Comparing to state before reboot:

# virsh -r domblklist disk-mapping
 Target   Source
---------------------------------------------------------------------------------------------------------------------------------------------------------------
  sdc      -
 sda      /rhev/data-center/mnt/blockSD/84dc4e3c-00fd-4263-84e8-fc246eeee6e9/images/40018b33-2b11-4d10-82e4-604a5b135fb2/40f455c4-8c92-4f8f-91c2-991b0ddfc2f5
  vda      /dev/mapper/3600140594af345ed76d42058f2b1a454
 vdb      /dev/mapper/360014050058f2f8a0474dc7a8a7cc6a5
 vdc      /dev/mapper/36001405b4d0c0b7544d47438b21296ef

# ls -lh /dev/disk/by-id/virtio-*
lrwxrwxrwx. 1 root root 9 Jan  6 09:42
/dev/disk/by-id/virtio-b97e68b2-87ea-45ca-9 -&gt; ../../vda
lrwxrwxrwx. 1 root root 9 Jan  6 09:42
/dev/disk/by-id/virtio-d9a29187-f492-4a0d-a -&gt; ../../vdb
lrwxrwxrwx. 1 root root 9 Jan  6 09:51
/dev/disk/by-id/virtio-e801c2e4-dc2e-4c53-b -&gt; ../../vdc

In the guest disks are mapped to the same device name.

It looks like libivrt domblklist is not correct - vdb and vdc are switched.
Peter, this expected?

Nir

&gt; 
&gt; Joy
&gt; 
&gt; On Wed, Dec 2, 2020 at 1:28 PM Nir Soffer &lt;nsoffer@redhat.com&gt; wrote:
&gt; &gt; 
&gt; &gt; On Wed, Dec 2, 2020 at 10:27 AM Joy Li &lt;joooy.li@gmail.com&gt; wrote:
&gt; &gt; &gt; 
&gt; &gt; &gt; Hi All,
&gt; &gt; &gt; 
&gt; &gt; &gt; I'm facing the problem that after adding disks to guest VM, the device target \
&gt; &gt; &gt; path changed (My ovirt version is 4.3). For example: 
&gt; &gt; &gt; Before adding a disk:
&gt; &gt; &gt; 
&gt; &gt; &gt; virsh # domblklist &lt;vmname&gt;
&gt; &gt; &gt; Target   Source
&gt; &gt; &gt; ---------------------------------------------------------
&gt; &gt; &gt; hdc      -
&gt; &gt; &gt; vda      /dev/mapper/3600a09803830386546244a546d494f53
&gt; &gt; &gt; vdb      /dev/mapper/3600a09803830386546244a546d494f54
&gt; &gt; &gt; vdc      /dev/mapper/3600a09803830386546244a546d494f55
&gt; &gt; &gt; vdd      /dev/mapper/3600a09803830386546244a546d494f56
&gt; &gt; &gt; vde      /dev/mapper/3600a09803830386546244a546d494f57
&gt; &gt; &gt; vdf      /dev/mapper/3600a09803830386546244a546d494f58
&gt; &gt; &gt; 
&gt; &gt; &gt; After adding a disk, and then shutdown and start the VM:
&gt; &gt; &gt; 
&gt; &gt; &gt; virsh # domblklist &lt;vmname&gt;
&gt; &gt; &gt; Target   Source
&gt; &gt; &gt; ---------------------------------------------------------
&gt; &gt; &gt; hdc      -
&gt; &gt; &gt; vda      /dev/mapper/3600a09803830386546244a546d494f53
&gt; &gt; &gt; vdb      /dev/mapper/3600a09803830386546244a546d494f54
&gt; &gt; &gt; vdc      /dev/mapper/3600a09803830386546244a546d494f6c
&gt; &gt; &gt; vdd      /dev/mapper/3600a09803830386546244a546d494f55
&gt; &gt; &gt; vde      /dev/mapper/3600a09803830386546244a546d494f56
&gt; &gt; &gt; vdf      /dev/mapper/3600a09803830386546244a546d494f57
&gt; &gt; &gt; vdg      /dev/mapper/3600a09803830386546244a546d494f58
&gt; &gt; &gt; 
&gt; &gt; &gt; The devices' multipath doesn't map to the same target path as before, so in my \
&gt; &gt; &gt; VM the /dev/vdc doesn't point to the old \
&gt; &gt; &gt; /dev/mapper/3600a09803830386546244a546d494f55 anymore. 
&gt; &gt; &gt; Anybody knows how can I make the device path mapping fixed without being \
&gt; &gt; &gt; changed after adding or removing disks.
&gt; &gt; 
&gt; &gt; Device nodes are not stable, and oVirt cannot guarantee that you will
&gt; &gt; get the same
&gt; &gt; node in the guest in all runs.
&gt; &gt; 
&gt; &gt; You should use /dev/disk/by-id/xxx links to located devices, and blkid to create
&gt; &gt; fstab mounts that do not depend on node names.
&gt; &gt; 
&gt; &gt; Regardless, oVirt try to keep devices stable as possible. Do you know
&gt; &gt; how to reproduce
&gt; &gt; this issue reliably?
&gt; &gt; 
&gt; &gt; Nir
&gt; &gt; 


</body></email><email><emailId>20210108002838</emailId><senderName>Jim Fehlig</senderName><senderEmail>jfehlig@suse.com</senderEmail><timestampReceived>2021-01-08 00:28:38-0400</timestampReceived><subject>Re: Problem with xen hvm DomU</subject><body>

While doing some new year mail cleaning I noticed this unanswered mail. It is 
quite old so perhaps you've figured something out in the meantime.

On 9/10/20 7:31 AM, Christoph wrote:
&gt; I think its again a translate error of domxml-from-native...
&gt; 
&gt; This is the line in xl config:
&gt; 
&gt; vif = [
&gt; "mac=00:16:3e:05:30:04,bridge=xenbr5,script=vif-bridge,type=vif",
&gt; "mac=00:16:3e:04:30:04,bridge=xenbr4,script=vif-bridge,type=vif",
&gt; "mac=00:16:3e:15:30:04,bridge=xenbr15,script=vif-bridge,type=vif",
&gt; "mac=00:16:3e:14:30:04,bridge=xenbr14,script=vif-bridge,type=vif" ]
&gt; 
&gt; in xen if I want to use more than 3 nic's I need to define the
&gt; "type=vif". With default or e1000 as type it doesnt work for &gt;3 nic's
&gt; 
&gt; The translated config is:
&gt; 
&gt; &lt;interface type='bridge'&gt;
&gt;        &lt;mac address='00:16:3e:05:30:04'/&gt;
&gt;        &lt;source bridge='xenbr5'/&gt;
&gt;        &lt;script path='vif-bridge'/&gt;
&gt;        &lt;model type='netfront'/&gt;
&gt; &lt;/interface&gt;
&gt; ...

This translation is correct.

&gt; there is the type "netfront" and nothing about type=vif. I've tried to
&gt; set it to model type='vif' but it doesnt work to...

Long ago the Xen PV NIC model was known as "netfront", and for better or worse 
the name was exposed in the libvirt domXML schema. When the Xen community 
ditched xend in favor of libxl, the specification of emulated 
(LIBXL_NIC_TYPE_VIF_IOEMU) vs PV (LIBXL_NIC_TYPE_VIF) NIC was moved to the 
'nictype' field of the NIC definition. Compatibility guarantees of libvirt 
schema prevent changing the model from "netfront" to "vif". The latter could be 
added to the schema as another way of specifying a PV NIC model, but we already 
have "netfront" and another would only add more confusion IMO :-).

Regardless of the name used in the libvirt schema, the libxl driver should be 
doing the right thing and mapping &lt;model type='netfront'/&gt; to 
LIBXL_NIC_TYPE_VIF. I tested an HVM guest with 4 "netfront" interfaces and 
didn't notice any problems. What version of libvirt are you using?

Regards,
Jim

&gt; Am 09.09.2020 05:12, schrieb Jim Fehlig:
&gt;&gt; On 9/8/20 7:55 AM, Christoph wrote:
&gt;&gt;&gt; It seems there is a problem with more than 3 NIC's... If I delete one
&gt;&gt;&gt; nick from the config then it starts without problems...
&gt;&gt;
&gt;&gt; Wow, that's not good :-). I took a quick peek at the code but didn't
&gt;&gt; spot anything obvious. Since I don't have time to investigate further
&gt;&gt; now, perhaps it would be best to track this in the gitlab issue
&gt;&gt; tracker
&gt;&gt;
&gt;&gt; https://gitlab.com/libvirt/libvirt/-/issues
&gt;&gt;
&gt;&gt; Can you create a new issue there? Thanks!
&gt;&gt;
&gt;&gt; Regards,
&gt;&gt; Jim
&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; ---
&gt;&gt;&gt; ------
&gt;&gt;&gt; Greetz
&gt;&gt;&gt;
&gt;&gt;&gt; Am 03.09.2020 14:28, schrieb Christoph:
&gt;&gt;&gt;&gt; Hi
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; can someone say me whats wrong in this config:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; &lt;domain type='xen'&gt;
&gt;&gt;&gt;&gt;   &lt;name&gt;fenrir.chao5.int&lt;/name&gt;
&gt;&gt;&gt;&gt;   &lt;uuid&gt;7aedcd03-54e8-4055-8d1b-37dd34194859&lt;/uuid&gt;
&gt;&gt;&gt;&gt;   &lt;memory unit='KiB'&gt;2097152&lt;/memory&gt;
&gt;&gt;&gt;&gt;   &lt;currentMemory unit='KiB'&gt;2097152&lt;/currentMemory&gt;
&gt;&gt;&gt;&gt;   &lt;vcpu placement='static'&gt;2&lt;/vcpu&gt;
&gt;&gt;&gt;&gt;   &lt;os&gt;
&gt;&gt;&gt;&gt;     &lt;type arch='x86_64' machine='xenfv'&gt;hvm&lt;/type&gt;
&gt;&gt;&gt;&gt;     &lt;loader type='rom'&gt;/usr/lib/xen/boot/hvmloader&lt;/loader&gt;
&gt;&gt;&gt;&gt;     &lt;kernel&gt;/usr/lib64/xen/boot/hvmloader&lt;/kernel&gt;
&gt;&gt;&gt;&gt;     &lt;boot dev='hd'/&gt;
&gt;&gt;&gt;&gt;   &lt;/os&gt;
&gt;&gt;&gt;&gt;   &lt;features&gt;
&gt;&gt;&gt;&gt;     &lt;acpi/&gt;
&gt;&gt;&gt;&gt;     &lt;apic/&gt;
&gt;&gt;&gt;&gt;     &lt;pae/&gt;
&gt;&gt;&gt;&gt;   &lt;/features&gt;
&gt;&gt;&gt;&gt;   &lt;clock offset='variable' adjustment='0' basis='localtime'/&gt;
&gt;&gt;&gt;&gt;   &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
&gt;&gt;&gt;&gt;   &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
&gt;&gt;&gt;&gt;   &lt;on_crash&gt;restart&lt;/on_crash&gt;
&gt;&gt;&gt;&gt;   &lt;devices&gt;
&gt;&gt;&gt;&gt;     &lt;disk type='file' device='disk'&gt;
&gt;&gt;&gt;&gt;       &lt;driver name='qemu' type='raw'/&gt;
&gt;&gt;&gt;&gt;       &lt;source file='/dev/vg_astarte/lv_fenrir_root'/&gt;
&gt;&gt;&gt;&gt;       &lt;target dev='hda' bus='ide'/&gt;
&gt;&gt;&gt;&gt;       &lt;address type='drive' controller='0' bus='0' target='0'
&gt;&gt;&gt;&gt; unit='0'/&gt;
&gt;&gt;&gt;&gt;     &lt;/disk&gt;
&gt;&gt;&gt;&gt;     &lt;disk type='file' device='disk'&gt;
&gt;&gt;&gt;&gt;       &lt;driver name='qemu' type='raw'/&gt;
&gt;&gt;&gt;&gt;       &lt;source file='/dev/vg_astarte/lv_fenrir_swap'/&gt;
&gt;&gt;&gt;&gt;       &lt;target dev='hdb' bus='ide'/&gt;
&gt;&gt;&gt;&gt;       &lt;address type='drive' controller='0' bus='0' target='0'
&gt;&gt;&gt;&gt; unit='1'/&gt;
&gt;&gt;&gt;&gt;     &lt;/disk&gt;
&gt;&gt;&gt;&gt;     &lt;controller type='xenbus' index='0'/&gt;
&gt;&gt;&gt;&gt;     &lt;controller type='ide' index='0'/&gt;
&gt;&gt;&gt;&gt;     &lt;interface type='bridge'&gt;
&gt;&gt;&gt;&gt;       &lt;mac address='00:16:3e:05:30:04'/&gt;
&gt;&gt;&gt;&gt;       &lt;source bridge='xenbr5'/&gt;
&gt;&gt;&gt;&gt;       &lt;script path='vif-bridge'/&gt;
&gt;&gt;&gt;&gt;       &lt;model type='netfront'/&gt;
&gt;&gt;&gt;&gt;     &lt;/interface&gt;
&gt;&gt;&gt;&gt;     &lt;interface type='bridge'&gt;
&gt;&gt;&gt;&gt;       &lt;mac address='00:16:3e:04:30:04'/&gt;
&gt;&gt;&gt;&gt;       &lt;source bridge='xenbr4'/&gt;
&gt;&gt;&gt;&gt;       &lt;script path='vif-bridge'/&gt;
&gt;&gt;&gt;&gt;       &lt;model type='netfront'/&gt;
&gt;&gt;&gt;&gt;     &lt;/interface&gt;
&gt;&gt;&gt;&gt;     &lt;interface type='bridge'&gt;
&gt;&gt;&gt;&gt;       &lt;mac address='00:16:3e:15:30:04'/&gt;
&gt;&gt;&gt;&gt;       &lt;source bridge='xenbr15'/&gt;
&gt;&gt;&gt;&gt;       &lt;script path='vif-bridge'/&gt;
&gt;&gt;&gt;&gt;       &lt;model type='netfront'/&gt;
&gt;&gt;&gt;&gt;     &lt;/interface&gt;
&gt;&gt;&gt;&gt;     &lt;interface type='bridge'&gt;
&gt;&gt;&gt;&gt;       &lt;mac address='00:16:3e:14:30:04'/&gt;
&gt;&gt;&gt;&gt;       &lt;source bridge='xenbr14'/&gt;
&gt;&gt;&gt;&gt;       &lt;script path='vif-bridge'/&gt;
&gt;&gt;&gt;&gt;       &lt;model type='netfront'/&gt;
&gt;&gt;&gt;&gt;     &lt;/interface&gt;
&gt;&gt;&gt;&gt;     &lt;input type='mouse' bus='ps2'/&gt;
&gt;&gt;&gt;&gt;     &lt;input type='keyboard' bus='ps2'/&gt;
&gt;&gt;&gt;&gt;     &lt;graphics type='vnc' port='6000' autoport='no' listen='0.0.0.0'&gt;
&gt;&gt;&gt;&gt;       &lt;listen type='address' address='0.0.0.0'/&gt;
&gt;&gt;&gt;&gt;     &lt;/graphics&gt;
&gt;&gt;&gt;&gt;     &lt;video&gt;
&gt;&gt;&gt;&gt;       &lt;model type='cirrus' vram='8192' heads='1' primary='yes'/&gt;
&gt;&gt;&gt;&gt;     &lt;/video&gt;
&gt;&gt;&gt;&gt;     &lt;memballoon model='xen'/&gt;
&gt;&gt;&gt;&gt;   &lt;/devices&gt;
&gt;&gt;&gt;&gt; &lt;/domain&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; If I try to start it with virsh create... then I see only:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; error: Failed to create domain from
&gt;&gt;&gt;&gt; /etc/libvirt/libxl/fenrir.chao5.int.xml
&gt;&gt;&gt;&gt; error: internal error: libxenlight failed to create new domain
&gt;&gt;&gt;&gt; 'fenrir.chao5.int'
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; ------
&gt;&gt;&gt;&gt; Greetz
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt; 


</body></email><email><emailId>20210106153646</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-01-06 15:36:46-0400</timestampReceived><subject>Re: [ovirt-devel] Issue: Device path changed after adding disks to guest VM</subject><body>

On Wed, Jan 06, 2021 at 17:16:24 +0200, Nir Soffer wrote:
&gt; On Wed, Dec 2, 2020 at 4:57 PM Joy Li &lt;joooy.li@gmail.com&gt; wrote:

[...]

&gt; Comparing to state before reboot:
&gt; 
&gt; # virsh -r domblklist disk-mapping
&gt; Target   Source
&gt; ---------------------------------------------------------------------------------------------------------------------------------------------------------------
&gt;  sdc      -
&gt; sda      /rhev/data-center/mnt/blockSD/84dc4e3c-00fd-4263-84e8-fc246eeee6e9/images/40018b33-2b11-4d10-82e4-604a5b135fb2/40f455c4-8c92-4f8f-91c2-991b0ddfc2f5
&gt;  vda      /dev/mapper/3600140594af345ed76d42058f2b1a454
&gt; vdb      /dev/mapper/360014050058f2f8a0474dc7a8a7cc6a5
&gt; vdc      /dev/mapper/36001405b4d0c0b7544d47438b21296ef
&gt; 
&gt; # ls -lh /dev/disk/by-id/virtio-*
&gt; lrwxrwxrwx. 1 root root 9 Jan  6 09:42
&gt; /dev/disk/by-id/virtio-b97e68b2-87ea-45ca-9 -&gt; ../../vda
&gt; lrwxrwxrwx. 1 root root 9 Jan  6 09:42
&gt; /dev/disk/by-id/virtio-d9a29187-f492-4a0d-a -&gt; ../../vdb
&gt; lrwxrwxrwx. 1 root root 9 Jan  6 09:51
&gt; /dev/disk/by-id/virtio-e801c2e4-dc2e-4c53-b -&gt; ../../vdc
&gt; 
&gt; In the guest disks are mapped to the same device name.
&gt; 
&gt; It looks like libivrt domblklist is not correct - vdb and vdc are switched.
&gt; Peter, this expected?

The names in 'virsh domblklist' are unfortunately and confusingly chosen
to match the expected /dev/ device node name, but it's at kernel's
discretion to name /dev/ nodes.

This means that it's not guaranteed that what you see in 'virsh
domblklist' will match the state in the guest.

In this case I think the reorder happens as the PCI address of vdb is
larger than the address of vdc.

A partial workaround can be to use the data provided by the qemu guest
agent, for exampe via 'virsh domfsinfo':

$ virsh domfsinfo fedora32
 Mountpoint   Name   Type   Target
------------------------------------
 /            dm-0   xfs    vda
 /boot        vda1   xfs    vda

Here the guest-host matching is established via the PCI address so the
'Target' field accurately refers to the target in the VM XML.

Similarly the linux kernel recently changed enumeration of SCSI devices
so they are not guaranteed to match either. Libguestfs for example
needed a workaround.

https://github.com/libguestfs/libguestfs/commit/bca9b94fc593771b3801b09b95e477f160517909



</body></email><email><emailId>20210103123343</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-01-03 12:33:43-0400</timestampReceived><subject>Re: Migration via qemu+ssh using a given private ssh key possible ?</subject><body>

On Sat, Jan 02, 2021 at 14:25:32 +0100, Oliver Dzombic wrote:
&gt; Hi,
&gt; 
&gt; happy new year!
&gt; 
&gt; Is there a way to tell libvirt to migrate an instance via qemu+ssh using
&gt; a specific ssh key ?
&gt; 
&gt; It seems libvirt will always try to use the .ssh/id_rsa private key.
&gt; 
&gt; But i would like to somehow tell libvirt to use a specific private ssh
&gt; key. ( At best via command line argument ).

This can be achieved via the 'keyfile' URI parameter.

See: https://libvirt.org/uri.html#Remote_URI_parameters

</body></email><email><emailId>20210105183949</emailId><senderName>Oliver Dzombic</senderName><senderEmail>info@layer7.net</senderEmail><timestampReceived>2021-01-05 18:39:49-0400</timestampReceived><subject>Re: Migration via qemu+ssh using a given private ssh key possible ?</subject><body>

Hi Peter,

thank you very much for this hint. Seems to work! :)

But i also tried another switch: no_verify=1

The whole call:

virsh -K0 -k0 migrate --copy-storage-inc --verbose --persistent --live
testInstance
qemu+ssh://testnode4:22/system?keyfile=/tmp/key-5ff4b02ca966c?no_verify=1?no_tty=1

So as you can see

no_verify=1
no_tty=1

has been added.

But still i receive


The authenticity of host '[testnode4]:22 ([10.0.1.4]:22)' can't be
established.
ECDSA key fingerprint is SHA256:tcF31bWN6Gg8O5bMTkkusbcariPBWjGdLAP7WnfdqsM.
Are you sure you want to continue connecting (yes/no/[fingerprint])?


Should it not accept automatically this unknown fingerprint ?

-- 
Mit freundlichen Gruessen / Best regards

Oliver Dzombic
Layer7 Networks

mailto:info@layer7.net

Anschrift:

Layer7 Networks GmbH
Zum Sonnenberg 1-3
63571 Gelnhausen

HRB 96293 beim Amtsgericht Hanau
Geschäftsführung: Oliver Dzombic
UST ID: DE259845632

Am 03.01.21 um 13:33 schrieb Peter Krempa:
&gt; On Sat, Jan 02, 2021 at 14:25:32 +0100, Oliver Dzombic wrote:
&gt;&gt; Hi,
&gt;&gt;
&gt;&gt; happy new year!
&gt;&gt;
&gt;&gt; Is there a way to tell libvirt to migrate an instance via qemu+ssh using
&gt;&gt; a specific ssh key ?
&gt;&gt;
&gt;&gt; It seems libvirt will always try to use the .ssh/id_rsa private key.
&gt;&gt;
&gt;&gt; But i would like to somehow tell libvirt to use a specific private ssh
&gt;&gt; key. ( At best via command line argument ).
&gt; 
&gt; This can be achieved via the 'keyfile' URI parameter.
&gt; 
&gt; See: https://libvirt.org/uri.html#Remote_URI_parameters
&gt; 


</body></email><email><emailId>20210104093129</emailId><senderName>Michal Privoznik</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-01-04 09:31:29-0400</timestampReceived><subject>Re: Get Host Capabilities failed: Internal JSON-RPC error: {'reason': 'internal error: Duplicate key</subject><body>

On 12/24/20 4:06 AM, tommy wrote:
&gt; Hi,everyone:
&gt; 
&gt;   
&gt; 
&gt; I got this error in my ovirt env:
&gt; 
&gt;   
&gt; 
&gt; VDSM ooengh1.tltd.com command Get Host Capabilities failed: Internal
&gt; JSON-RPC error: {'reason': 'internal error: Duplicate key'}

I think you're hitting this bug:

https://bugzilla.redhat.com/show_bug.cgi?id=1791790

It's fixed in libvirt-6.1.0.

Michal

</body></email><email><emailId>20210112063110</emailId><senderName>PRAJWAL BENEDICT A</senderName><senderEmail>benedict.prajwal@gmail.com</senderEmail><timestampReceived>2021-01-12 06:31:10-0400</timestampReceived><subject>I would like to contribute to libvirt</subject><body>

&lt;html xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;&lt;head&gt;&lt;meta http-equiv=Content-Type \
content="text/html; charset=utf-8"&gt;&lt;meta name=Generator content="Microsoft Word 15 \
(filtered medium)"&gt;&lt;style&gt;&lt;!-- /* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
h3
	{mso-style-priority:9;
	mso-style-link:"Heading 3 Char";
	margin-top:2.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#1F3763;
	font-weight:normal;}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-priority:9;
	mso-style-link:"Heading 3";
	font-family:"Calibri Light",sans-serif;
	color:#1F3763;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;}
div.WordSection1
	{page:WordSection1;}
--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body lang=EN-IN link=blue vlink="#954F72" \
style='word-wrap:break-word'&gt;&lt;div class=WordSection1&gt;&lt;div&gt;&lt;h3 \
style='mso-margin-top-alt:0cm;margin-right:243.75pt;margin-bottom:18.75pt;margin-left:0cm;background:#1A253B'&gt;&lt;b&gt;&lt;span \
style='font-family:"Arial",sans-serif;color:white'&gt;libvirt&lt;/span&gt;&lt;/b&gt;&lt;span \
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:white'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/h3&gt;&lt;/div&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;Hi my name is Prajwal \
benedict A&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;Persuing my btech in The National \
Institute of Engineering Mysore&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;I'd love to work on your \
project! Can you please suggest me how to proceed?'&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;I am actively looking for some good GSOC organisations to contribute \
. I actively contribute to open source projects.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;Something about me:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;Completed \
#30daysofgooglecloud&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;Have good experience on cloud , \
machine learning and automation&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;and cloud \
components&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;I'm a digital creative currently majoring \
in Information Technology (with minor in Human-Computer Interaction). My interest \
lies in product&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;design and user research but I don't \
mind banging lines of code to build stuff.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;Have \
knowledge in web dev &lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;Also well experienced in \
coding with C++&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;Portfolio: &lt;a \
href="https://benzbloz.blogspot.com/"&gt;https://benzbloz.blogspot.com&lt;/a&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;LinkedIn: &lt;a \
href="https://www.linkedin.com/in/prajwal-benedict-a-048511186/"&gt;https://www.linkedin.com/in/prajwal-benedict-a-048511186/&lt;/a&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;Also my YT channel: &lt;a \
href="https://www.youtube.com/channel/UCckbWp8ugTuH2DJd_t1KcfQ"&gt;https://www.youtube.com/channel/UCckbWp8ugTuH2DJd_t1KcfQ&lt;/a&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;I'm interested to learn more \
about contributing to Boost C++ and to speak with you further.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;Best,&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;Prajwal Benedict A&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;Sent from &lt;a \
href="https://go.microsoft.com/fwlink/?LinkId=550986"&gt;Mail&lt;/a&gt; for Windows 10&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;


</body></email><email><emailId>20210118073222</emailId><senderName>"tommy"</senderName><senderEmail>sz_cuitao@163.com</senderEmail><timestampReceived>2021-01-18 07:32:22-0400</timestampReceived><subject>How to enable libvirtd auth just like oVirt ?</subject><body>

This is a multipart message in MIME format.

Hi everyone:

 

In my libvirtd test env, there's no auth when using virsh:

 

root@ubts2:~# virsh

Welcome to virsh, the virtualization interactive terminal.

 

Type:  'help' for help with commands

       'quit' to quit

 

virsh #

virsh #

virsh # list

Id   Name       State

--------------------------

26   3.ohost1   running

27   3.ohost2   running

28   3.ohost3   running

 

virsh #

virsh #

virsh #

virsh #

 

 

 

But, in oVirt env, there's auth when using virsh:

 

[root@ohost1 ~]# virsh

Welcome to virsh, the virtualization interactive terminal.

 

Type:  'help' for help with commands

       'quit' to quit

 

virsh #

virsh #

virsh #

virsh #

virsh # list

Please enter your authentication name:

 

 

How can I enable auth in my libvirtd env just like oVirt ?

 

Thanks.

 

 

 

 

 

 

 


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;&lt;head&gt;&lt;META HTTP-EQUIV="Content-Type" \
CONTENT="text/html; charset=us-ascii"&gt;&lt;meta name=Generator content="Microsoft Word 15 \
(filtered medium)"&gt;&lt;style&gt;&lt;!-- /* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:\7B49\7EBF;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"\@\7B49\7EBF";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:\7B49\7EBF;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:\7B49\7EBF;
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;
	font-family:\7B49\7EBF;}
/* Page Definitions */
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;}
div.WordSection1
	{page:WordSection1;}
--&gt;&lt;/style&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapelayout v:ext="edit"&gt;
&lt;o:idmap v:ext="edit" data="1" /&gt;
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;&lt;/head&gt;&lt;body lang=ZH-CN link="#0563C1" \
vlink="#954F72" style='word-wrap:break-word;text-justify-trim:punctuation'&gt;&lt;div \
class=WordSection1&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;Hi \
everyone:&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;b&gt;&lt;span lang=EN-US&gt;In my \
libvirtd test env, there’s no auth when using \
virsh:&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;root@ubts2:~# virsh&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;Welcome to virsh, the virtualization interactive \
terminal.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;Type:  'help' for help with commands&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span lang=EN-US&gt;       'quit' to \
quit&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;virsh \
#&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;virsh \
#&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;virsh # \
list&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt; Id   \
Name       State&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span lang=EN-US&gt;--------------------------&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span lang=EN-US&gt; 26   3.ohost1   \
running&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt; 27   \
3.ohost2   running&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt; 28   3.ohost3   running&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;virsh #&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;virsh \
#&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;virsh \
#&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;virsh \
#&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;b&gt;&lt;span lang=EN-US&gt;But, in \
oVirt env, there’s auth when using virsh:&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;[root@ohost1 ~]# virsh&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;Welcome to virsh, the virtualization interactive \
terminal.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;Type:  'help' for help with commands&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span lang=EN-US&gt;       'quit' to \
quit&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;virsh \
#&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;virsh \
#&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;virsh \
#&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;virsh \
#&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;virsh # \
list&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;Please enter your \
authentication name:&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;b&gt;&lt;span lang=EN-US&gt;How can \
I enable auth in my libvirtd env just like oVirt ?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;Thanks.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20210104094740</emailId><senderName>"tommy"</senderName><senderEmail>sz_cuitao@163.com</senderEmail><timestampReceived>2021-01-04 09:47:40-0400</timestampReceived><subject>RE: Get Host Capabilities failed: Internal JSON-RPC error: {'reason': 'internal error: Duplicate key</subject><body>

Thank you!

I reinstalled it, now it's fine.






-----Original Message-----
From: Michal Privoznik &lt;mprivozn@redhat.com&gt; 
Sent: Monday, January 4, 2021 5:31 PM
To: tommy &lt;sz_cuitao@163.com&gt;; libvirt-users@redhat.com
Subject: Re: Get Host Capabilities failed: Internal JSON-RPC error:
{'reason': 'internal error: Duplicate key'}

On 12/24/20 4:06 AM, tommy wrote:
&gt; Hi,everyone:
&gt; 
&gt;   
&gt; 
&gt; I got this error in my ovirt env:
&gt; 
&gt;   
&gt; 
&gt; VDSM ooengh1.tltd.com command Get Host Capabilities failed: Internal 
&gt; JSON-RPC error: {'reason': 'internal error: Duplicate key'}

I think you're hitting this bug:

https://bugzilla.redhat.com/show_bug.cgi?id=1791790

It's fixed in libvirt-6.1.0.

Michal


</body></email><email><emailId>20210113074803</emailId><senderName>"tommy"</senderName><senderEmail>sz_cuitao@163.com</senderEmail><timestampReceived>2021-01-13 07:48:03-0400</timestampReceived><subject>RE: Get Host Capabilities failed: Internal JSON-RPC error: {'reason': 'internal error: Duplicate key</subject><body>

I should upgrade my libvirt from 5.7 to 6.1 to resole this question ?






-----Original Message-----
From: Michal Privoznik &lt;mprivozn@redhat.com&gt; 
Sent: Monday, January 4, 2021 5:31 PM
To: tommy &lt;sz_cuitao@163.com&gt;; libvirt-users@redhat.com
Subject: Re: Get Host Capabilities failed: Internal JSON-RPC error:
{'reason': 'internal error: Duplicate key'}

On 12/24/20 4:06 AM, tommy wrote:
&gt; Hi,everyone:
&gt; 
&gt;   
&gt; 
&gt; I got this error in my ovirt env:
&gt; 
&gt;   
&gt; 
&gt; VDSM ooengh1.tltd.com command Get Host Capabilities failed: Internal 
&gt; JSON-RPC error: {'reason': 'internal error: Duplicate key'}

I think you're hitting this bug:

https://bugzilla.redhat.com/show_bug.cgi?id=1791790

It's fixed in libvirt-6.1.0.

Michal


</body></email><email><emailId>20210104194400</emailId><senderName>Michal Privoznik</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-01-04 19:44:00-0400</timestampReceived><subject>Re: virt-manager connection fails with 'qemu unexpectedly closed the monitor'</subject><body>

On 12/19/20 10:22 PM, John Paul Adrian Glaubitz wrote:
&gt; Hi!
&gt; 
&gt; I recently ran into a problem when connecting to libvirtd 6.9.0 on Debian unstable
&gt; and trying to import an existing image with Windows 7.
&gt; 
&gt; Upon finishing the wizard and starting the instance, the import process fails
&gt; with the following error message:
&gt; 
&gt; Unable to complete install: 'internal error: qemu unexpectedly closed the monitor'
&gt; 
&gt; Traceback (most recent call last):
&gt;    File "/usr/share/virt-manager/virtManager/asyncjob.py", line 65, in cb_wrapper
&gt;      callback(asyncjob, *args, **kwargs)
&gt;    File "/usr/share/virt-manager/virtManager/createvm.py", line 2081, in _do_async_install
&gt;      installer.start_install(guest, meter=meter)
&gt;    File "/usr/share/virt-manager/virtinst/install/installer.py", line 731, in start_install
&gt;      domain = self._create_guest(
&gt;    File "/usr/share/virt-manager/virtinst/install/installer.py", line 679, in _create_guest
&gt;      domain = self.conn.createXML(install_xml or final_xml, 0)
&gt;    File "/usr/lib64/python3.8/site-packages/libvirt.py", line 4366, in createXML
&gt;      raise libvirtError('virDomainCreateXML() failed')
&gt; libvirt.libvirtError: internal error: qemu unexpectedly closed the monitor
&gt; 
&gt; Since this error message is rather generic, I don't know where to start debugging.
&gt; 
&gt; Does anyone know how to increase verbosity here to get an error message that might be
&gt; more helpful?

There should be a more verbose message in /var/log/libvirt/qemu/$domain.log.

Michal

</body></email><email><emailId>20210106100908</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-01-06 10:09:08-0400</timestampReceived><subject>Re: Migration via qemu+ssh using a given private ssh key possible ?</subject><body>

On Tue, Jan 05, 2021 at 19:39:49 +0100, Oliver Dzombic wrote:
&gt; Hi Peter,

[...]

&gt; So as you can see
&gt; 
&gt; no_verify=1
&gt; no_tty=1
&gt; 
&gt; has been added.
&gt; 
&gt; But still i receive
&gt; 
&gt; 
&gt; The authenticity of host '[testnode4]:22 ([10.0.1.4]:22)' can't be
&gt; established.
&gt; ECDSA key fingerprint is SHA256:tcF31bWN6Gg8O5bMTkkusbcariPBWjGdLAP7WnfdqsM.
&gt; Are you sure you want to continue connecting (yes/no/[fingerprint])?

I've looked at the code briefly and it seems to be implemented by adding:

-o StrictHostKeyChecking=no

to the command line of the 'ssh' binary, so it should work, but maybe
there's some snag.

Could you please file this as a bug/issue:

https://gitlab.com/libvirt/libvirt/-/issues/new

</body></email><email><emailId>20210104112041</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-01-04 11:20:41-0400</timestampReceived><subject>Re: relation between "virbr0" / "virbr0-nic" network interfaces</subject><body>

On Fri, Jan 01, 2021 at 10:24:41AM +0100, vrms wrote:
&gt; I am trying to understand KVM networking a little better and have noted
&gt; that the "virbr0" network interface (the default KVM bridge) comes with
&gt; another device named "virbr0-nic".
&gt; The same kind of pair comes with each new bridge you may create via the
&gt; "virtual machine manager" (and assumingly other KVM tools alike)
&gt; Like "virbr1" comes in a pair with "virbr1-nic" (the *-nic interface is
&gt; being created automatically (and I assume will disapear automatically if
&gt; you remove the parent interface)
&gt; 
&gt; Can anybody kindly explain how these pairs are related to each other
&gt; and/or work together?

The "$FOO-nic"  device is a tap device created as a hack to force a
stable MAC address on the main bridge device due to bad kernel impl
of bridge device MAC address assignment.

We stopped creating the "$FOO-nic" device in libvirt 6.8.0 since the
kernel was long ago fixed.

Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20210225143724</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-02-25 14:37:24-0400</timestampReceived><subject>Re: Live backups create-snapshot-as and memspec</subject><body>

On Wed, Feb 24, 2021 at 14:49:19 -0300, David Wells wrote:
&gt; Hi all!
&gt; 
&gt; I've been using libvirt for some time and until now I have treated backups
&gt; of virtual computers as if they where physical computers installing the
&gt; backup client on the guest. I am now however facing the need to backup a
&gt; couple a couple of guest at the host level so I've been trying to catch up
&gt; by reading, googling and by trial and error too. Up to now I've been able to
&gt; backup a live machine whith a command like the following
&gt; 
&gt; &gt; virsh snapshot-create-as --domain test --name backup --atomic --diskspec
&gt; &gt; vda,snapshot=external --disk-only
&gt; 
&gt; This command creates a file test.backup and in the meantime I can backup the
&gt; original test.qcow2 but for what I saw this disk image is in a "dirty"
&gt; state, as if the machine I could restore from this file had been turned off
&gt; whithout a proper shutdown.
&gt; 
&gt; I know that I can later restore the machine to its original state by issuing
&gt; a command like this
&gt; 
&gt; &gt; virsh blockcommit --domain test vda --active --pivot
&gt; &gt; virsh snapshot-delete test --metadata backup
&gt; 
&gt; I have seen that it is possible to create the snapshot using a memspec
&gt; parameter which would make the backup of the guest as if it where in a clean
&gt; state, however I haven't found the equivalent of the blockcommit for the
&gt; memory file, in a sort of speak, to be able to restore the guest to it's
&gt; original state.

The memory image file doesn't depend on any other state nor does the VM
use it after the snapshot is taken, if you don't need it you can delete
it.

The disk overlay you create by  'virsh snapshot-create-as' records only
differences to the original image, but for memory state it doesn't make
much sense as the memory is small and changes a lot, so we take a
snapshot of the whole memory.

Now to restore the state of a VM to a snapshot taken with memory,
libvirt's native APIs for reverting don't work on external snapshots
yet.

You can use 'virsh restore memimg' to load VM's state as the memory
snaphsot images have the same format as images created by 'virsh save'.

Please note though that the configuration of the VM is taken from the
save image if you do so, which includes paths to disk images, which may
no longer be correct or desired, but virsh save-image-edit can be used
to modify the XML if needed.

</body></email><email><emailId>20210226182945</emailId><senderName>David Wells</senderName><senderEmail>dwells@alfavinil.com</senderEmail><timestampReceived>2021-02-26 18:29:45-0400</timestampReceived><subject>Re: Live backups create-snapshot-as and memspec</subject><body>


El 25/2/2021 a las 11:37, Peter Krempa escribió:
&gt; On Wed, Feb 24, 2021 at 14:49:19 -0300, David Wells wrote:
&gt;&gt; Hi all!
&gt;&gt;
&gt;&gt; I've been using libvirt for some time and until now I have treated backups
&gt;&gt; of virtual computers as if they where physical computers installing the
&gt;&gt; backup client on the guest. I am now however facing the need to backup a
&gt;&gt; couple a couple of guest at the host level so I've been trying to catch up
&gt;&gt; by reading, googling and by trial and error too. Up to now I've been able to
&gt;&gt; backup a live machine whith a command like the following
&gt;&gt;
&gt;&gt;&gt; virsh snapshot-create-as --domain test --name backup --atomic --diskspec
&gt;&gt;&gt; vda,snapshot=external --disk-only
&gt;&gt; This command creates a file test.backup and in the meantime I can backup the
&gt;&gt; original test.qcow2 but for what I saw this disk image is in a "dirty"
&gt;&gt; state, as if the machine I could restore from this file had been turned off
&gt;&gt; whithout a proper shutdown.
&gt;&gt;
&gt;&gt; I know that I can later restore the machine to its original state by issuing
&gt;&gt; a command like this
&gt;&gt;
&gt;&gt;&gt; virsh blockcommit --domain test vda --active --pivot
&gt;&gt;&gt; virsh snapshot-delete test --metadata backup
&gt;&gt; I have seen that it is possible to create the snapshot using a memspec
&gt;&gt; parameter which would make the backup of the guest as if it where in a clean
&gt;&gt; state, however I haven't found the equivalent of the blockcommit for the
&gt;&gt; memory file, in a sort of speak, to be able to restore the guest to it's
&gt;&gt; original state.
&gt; The memory image file doesn't depend on any other state nor does the VM
&gt; use it after the snapshot is taken, if you don't need it you can delete
&gt; it.
&gt;
&gt; The disk overlay you create by  'virsh snapshot-create-as' records only
&gt; differences to the original image, but for memory state it doesn't make
&gt; much sense as the memory is small and changes a lot, so we take a
&gt; snapshot of the whole memory.
&gt;
&gt; Now to restore the state of a VM to a snapshot taken with memory,
&gt; libvirt's native APIs for reverting don't work on external snapshots
&gt; yet.
&gt;
&gt; You can use 'virsh restore memimg' to load VM's state as the memory
&gt; snaphsot images have the same format as images created by 'virsh save'.
&gt;
&gt; Please note though that the configuration of the VM is taken from the
&gt; save image if you do so, which includes paths to disk images, which may
&gt; no longer be correct or desired, but virsh save-image-edit can be used
&gt; to modify the XML if needed.
&gt;
Hi all!

Peter, thank you very much for your reply! So if I understood correctly 
there is no way, at this time, to backup a live guest in a way that I 
can restore it to a "clean" state. Also, if I understood correctly, the 
probability of a corrupt system on restore of the vm is minimized having 
the qemu guest agent installed on the guest and issue the virsh 
create-snapshot-as with the --quiesce parameter, is this correct?

Thanks in advance!
Best regards,
David Wells.


</body></email><email><emailId>20210225141020</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-02-25 14:10:20-0400</timestampReceived><subject>Re: Question about migrate the vm with host-passthrough cpu</subject><body>

On Wed, Feb 24, 2021 at 09:42:37PM +0800, Guoyi Tu wrote:
&gt; Hi there,
&gt; 
&gt; Sorry to bother you, but could I ask you a question about the live migration
&gt; of virtual machine configured with host-passthough cpu, it confuse me a lot.
&gt; 
&gt; Here i have two hosts with different cpu, and the cpu feature set of old
&gt; host is subset of the new one (by virsh cpu-compare). If the vm was first
&gt; started on the old host,is it safe to migrate the vm between the two hosts
&gt; back and forth with the vm always keep running?

The CPUID features are the biggest compatibility issue that is likely
to cause problems generally, but I believe there can be others.

For example if performance counters are exposed to the guest, these
are likely to vary between different CPU models. Even different BIOS
settings can change performance counters exposed by a CPU (HT vs no-HT)

There might also be problems with CPU TSC frequency differences between
the hosts.

&gt; I've test the case in my environment, and the migration succeeds, the cpu
&gt; family/model/stepping and features of lscpu in Guest OS is the same.

Right, the issue is that the migration appears to succeed from QEMU's
POV, but the guest may none the less see incompatibilities which
result in a crash or incorrect behaviour an arbitrary amount of time
later. It is really hard to guarantee that behaviour is going to be
correct in all scenarios.

Personally I would consider the use of host-passthrough to be unsupportable
in production environment, unless the CPUs are all homogeneous.

Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20210217081151</emailId><senderName>Michal Privoznik</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-02-17 08:11:51-0400</timestampReceived><subject>Re: Upgrading the host</subject><body>

On 2/17/21 2:59 AM, Marcin Struzak wrote:
&gt; On 2/16/2021 1:02 AM, Erik Skultety wrote:
&gt;&gt; [...]
&gt;&gt; Needless to say, if you're backing up /etc/libvirt/&lt;whatever&gt; make sure
&gt;&gt; libvirtd is down first, so that all the settings are properly dumped 
&gt;&gt; by the
&gt;&gt; daemon to the respective XMLs.

I'm not convinced this is the case - we go great lengths to make sure 
XMLs are saved onto disk safely and as soon as possible. Not only 
because users might kill libvirtd, it may also crash.

But doesn't hurt to shut the daemon off.

&gt;&gt;
&gt;&gt; Erik
&gt; 
&gt; Absolutely!   Not concerned about downtime here, just that after the 
&gt; upgrade everything comes back up like before.
&gt; 
&gt; Speaking of settings dumped into XMLs, why are the files in 
&gt; /etc/libvirt/qemu ever so slightly different from a manual dump using 
&gt; virsh dumpxml &amp; friends?   E.g., for a domain I have a section
&gt; 
&gt; &lt;resource&gt;
&gt;     &lt;partition&gt;/machine&lt;/partition&gt;
&gt; &lt;/resource&gt;
&gt; 
&gt; &lt;alias ... /&gt; entries for all devices, a tty attribute &amp; &lt;source ... /&gt; 
&gt; for console, etc., in the manual dump only?

Because 'virsh dumpxml' prints so called live XML if guest is running; 
or inactive XML if guest is not running. If the guest is running but you 
want to print the inactive XML you can do 'virsh dumpxml --inactive'.

The difference between live and inactive XML is that the former contains 
runtime information (like CGroup placement, device aliases generated 
when guest is created, domain ID, etc.). If you dump inactive XML then 
the output should be the same as under /etc/libvirt.

Michal

</body></email><email><emailId>20210217082310</emailId><senderName>Michal Privoznik</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-02-17 08:23:10-0400</timestampReceived><subject>Re: Upgrading the host</subject><body>

On 2/17/21 2:45 AM, Marcin Struzak wrote:
&gt; On 2/16/2021 12:51 AM, Michal Privoznik wrote:
&gt;&gt; On 2/12/21 2:10 AM, Marcin Struzak wrote:
&gt;&gt; [...]
&gt;&gt;
&gt;&gt;&gt;   3. Anything else I should worry about or prepare ahead?
&gt;&gt;
&gt;&gt; Not strictly related to libvirt, but machine types might be problem. I 
&gt;&gt; guess qemu will be upgraded too and in general the machine type you're 
&gt;&gt; using for a domain might not be available in upgraded qemu.
&gt; Correct, it looks like qemu will go from 1.6.2 to 4.2.1...
&gt;&gt;
&gt;&gt; You can view supported machine types by running 'virsh capabilities' 
&gt;&gt; with upgraded qemu.
&gt; machine is pc-i440fx-1.6 in all my domains.   Is there a simple way to 
&gt; figure out if that's supported in libvirt 6.1.0 (without installing it)?

It's not libvirt who has say in machine types. Libvirt treats machine 
type as an opaque string. But I can see that pc-i440fx-1.6 is still 
available even with the latest QEMU release:

# /usr/bin/qemu-system-x86_64 -version
QEMU emulator version 5.2.0

# virsh capabilities | grep pc-i440fx-1.6
       &lt;machine maxCpus='255'&gt;pc-i440fx-1.6&lt;/machine&gt;
       &lt;machine maxCpus='255'&gt;pc-i440fx-1.6&lt;/machine&gt;

So you are safe on that front.

Michal

</body></email><email><emailId>20210217132732</emailId><senderName>Laine Stump</senderName><senderEmail>laine@redhat.com</senderEmail><timestampReceived>2021-02-17 13:27:32-0400</timestampReceived><subject>Re: Upgrading the host</subject><body>

On 2/17/21 3:11 AM, Michal Privoznik wrote:
&gt; On 2/17/21 2:59 AM, Marcin Struzak wrote:
&gt;&gt; On 2/16/2021 1:02 AM, Erik Skultety wrote:
&gt;&gt;&gt; [...]
&gt;&gt;&gt; Needless to say, if you're backing up /etc/libvirt/&lt;whatever&gt; make sure
&gt;&gt;&gt; libvirtd is down first, so that all the settings are properly dumped 
&gt;&gt;&gt; by the
&gt;&gt;&gt; daemon to the respective XMLs.
&gt; 
&gt; I'm not convinced this is the case - we go great lengths to make sure 
&gt; XMLs are saved onto disk safely and as soon as possible. Not only 
&gt; because users might kill libvirtd, it may also crash.
&gt; 
&gt; But doesn't hurt to shut the daemon off.
&gt; 
&gt;&gt;&gt;
&gt;&gt;&gt; Erik
&gt;&gt;
&gt;&gt; Absolutely!   Not concerned about downtime here, just that after the 
&gt;&gt; upgrade everything comes back up like before.
&gt;&gt;
&gt;&gt; Speaking of settings dumped into XMLs, why are the files in 
&gt;&gt; /etc/libvirt/qemu ever so slightly different from a manual dump using 
&gt;&gt; virsh dumpxml &amp; friends?   E.g., for a domain I have a section
&gt;&gt;
&gt;&gt; &lt;resource&gt;
&gt;&gt;      &lt;partition&gt;/machine&lt;/partition&gt;
&gt;&gt; &lt;/resource&gt;
&gt;&gt;
&gt;&gt; &lt;alias ... /&gt; entries for all devices, a tty attribute &amp; &lt;source ... 
&gt;&gt; /&gt; for console, etc., in the manual dump only?
&gt; 
&gt; Because 'virsh dumpxml' prints so called live XML if guest is running; 
&gt; or inactive XML if guest is not running. If the guest is running but you 
&gt; want to print the inactive XML you can do 'virsh dumpxml --inactive'.

And by the way, if you're dumping the xml in order to redefine it later, 
you really should us "--inactive" because otherwise the result will be 
more than "slightly" different. In particular, if you have certain types 
of networks that are pools of hostdev or macvtap devices, the 
&lt;interface&gt; elements for those will be &lt;interface type='hostdev|direct'&gt; 
in the status output rather than the &lt;interface type='network'&gt; that you 
would need to properly re-define the domain.

&gt; 
&gt; The difference between live and inactive XML is that the former contains 
&gt; runtime information (like CGroup placement, device aliases generated 
&gt; when guest is created, domain ID, etc.). If you dump inactive XML then 
&gt; the output should be the same as under /etc/libvirt.
&gt; 
&gt; Michal
&gt; 

</body></email><email><emailId>20210217151503</emailId><senderName>Marcin Struzak</senderName><senderEmail>kunci@struzak.com</senderEmail><timestampReceived>2021-02-17 15:15:03-0400</timestampReceived><subject>Re: Upgrading the host</subject><body>

On 2/17/2021 12:23 AM, Michal Privoznik wrote:
&gt; On 2/17/21 2:45 AM, Marcin Struzak wrote:
&gt;&gt; On 2/16/2021 12:51 AM, Michal Privoznik wrote:
&gt;&gt;&gt; On 2/12/21 2:10 AM, Marcin Struzak wrote:
&gt;&gt;&gt; [...]
&gt;&gt;&gt;
&gt;&gt;&gt;&gt;  3. Anything else I should worry about or prepare ahead?
&gt;&gt;&gt;
&gt;&gt;&gt; Not strictly related to libvirt, but machine types might be problem. 
&gt;&gt;&gt; I guess qemu will be upgraded too and in general the machine type 
&gt;&gt;&gt; you're using for a domain might not be available in upgraded qemu.
&gt;&gt; Correct, it looks like qemu will go from 1.6.2 to 4.2.1...
&gt;&gt;&gt;
&gt;&gt;&gt; You can view supported machine types by running 'virsh capabilities' 
&gt;&gt;&gt; with upgraded qemu.
&gt;&gt; machine is pc-i440fx-1.6 in all my domains.  Is there a simple way to 
&gt;&gt; figure out if that's supported in libvirt 6.1.0 (without installing it)?
&gt;
&gt; It's not libvirt who has say in machine types. Libvirt treats machine 
&gt; type as an opaque string. But I can see that pc-i440fx-1.6 is still 
&gt; available even with the latest QEMU release:
&gt;
&gt; # /usr/bin/qemu-system-x86_64 -version
&gt; QEMU emulator version 5.2.0
&gt;
&gt; # virsh capabilities | grep pc-i440fx-1.6
&gt;       &lt;machine maxCpus='255'&gt;pc-i440fx-1.6&lt;/machine&gt;
&gt;       &lt;machine maxCpus='255'&gt;pc-i440fx-1.6&lt;/machine&gt;
&gt;
&gt; So you are safe on that front.

Excellent, thank you for checking.

Out of curiosity: what would have been my course of action if that 
particular machine were no longer defined?  I assume: substitute with a 
close match (after figuring out how do determine what counts as "close") 
&amp; hope that the VMs (all Fedoras &amp; Ubuntus) cope &amp; adjust?

--Marcin

</body></email><email><emailId>20210104100422</emailId><senderName>Andrea Bolognani</senderName><senderEmail>abologna@redhat.com</senderEmail><timestampReceived>2021-01-04 10:04:22-0400</timestampReceived><subject>Re: How to open listener of Libvirt ?</subject><body>

On Mon, 2021-01-04 at 17:22 +0800, tommy wrote:
&gt; Andrea Bolognani wrote:
&gt; &gt; On Thu, 2020-12-24 at 13:38 +0800, tommy wrote:
&gt; &gt; &gt; But, on my system, there are no such service like libvirtd-tls.socket or \
&gt; &gt; &gt; libvirtd-tcp.socket. 
&gt; &gt; &gt; root@ubts1:~# systemctl  | grep libvirt
&gt; &gt; &gt; libvirt-guests.service                                                          \
&gt; &gt; &gt; loaded active exited    Suspend/Resume Running libvirt Guests         \
&gt; &gt; &gt; libvirtd.service                                                                \
&gt; &gt; &gt; loaded active running   Virtualization daemon                         \
&gt; &gt; &gt; libvirtd-admin.socket                                                           \
&gt; &gt; &gt; loaded active running   Libvirt admin socket                          \
&gt; &gt; &gt; libvirtd-ro.socket                                                              \
&gt; &gt; &gt; loaded active running   Libvirt local read-only socket                \
&gt; &gt; &gt; libvirtd.socket                                                                 \
&gt; &gt; &gt; loaded active running   Libvirt local socket                          
&gt; &gt; &gt; How can I open the listener ?
&gt; &gt; 
&gt; &gt; On my machine:
&gt; &gt; 
&gt; &gt; $ systemctl list-unit-files | grep libvirt
&gt; &gt; libvirt-guests.service    enabled     enabled
&gt; &gt; libvirtd.service          enabled     enabled
&gt; &gt; libvirtd-admin.socket     enabled     enabled
&gt; &gt; libvirtd-ro.socket        enabled     enabled
&gt; &gt; libvirtd-tcp.socket       disabled    enabled
&gt; &gt; libvirtd-tls.socket       disabled    enabled
&gt; &gt; libvirtd.socket           enabled     enabled
&gt; &gt; 
&gt; &gt; This is Debian, but the Ubuntu package is pretty much identical, so I don't \
&gt; &gt; expect it to behave differently. 
&gt; &gt; So the unit exists on you system, you just need to enable it :)

&gt; But there are not such services:
&gt; 
&gt; libvirtd-tcp.socket       
&gt; libvirtd-tls.socket       
&gt; 
&gt; I really not understand how to enable them.:)
&gt; 
&gt; Should I reinstall libvirtd on my Ubuntu OS, or should I only need install the \
&gt; missing packages about the two services ?

Please don't top post on libvirt mailing lists.

libvirtd.socket exists on your system, and libvirtd-{tcp,tls}.socket
are part of the same package (libvirt-daemon-system):

  https://packages.ubuntu.com/focal/amd64/libvirt-daemon-system/filelist

So, unless you've gone out of your way to delete the corresponding
files, they will be there.

What does

  $ systemctl status libvirtd-{tcp,tls}.socket

tell you? And what the output of

  $ ls -l /lib/systemd/system/libvirtd-{tcp,tls}.socket

look like?

-- 
Andrea Bolognani / Red Hat / Virtualization


</body></email><email><emailId>20210104174038</emailId><senderName>vrms</senderName><senderEmail>vrms@netcologne.de</senderEmail><timestampReceived>2021-01-04 17:40:38-0400</timestampReceived><subject>Re: relation between "virbr0" / "virbr0-nic" network interfaces</subject><body>

ok, thanks for the explainer.

On 04.01.21 12:20, Daniel P. Berrang=C3=A9 wrote:
&gt; On Fri, Jan 01, 2021 at 10:24:41AM +0100, vrms wrote:
&gt;&gt; I am trying to understand KVM networking a little better and have noted
&gt;&gt; that the "virbr0" network interface (the default KVM bridge) comes with
&gt;&gt; another device named "virbr0-nic".
&gt;&gt; The same kind of pair comes with each new bridge you may create via the
&gt;&gt; "virtual machine manager" (and assumingly other KVM tools alike)
&gt;&gt; Like "virbr1" comes in a pair with "virbr1-nic" (the *-nic interface is
&gt;&gt; being created automatically (and I assume will disapear automatically if
&gt;&gt; you remove the parent interface)
&gt;&gt;
&gt;&gt; Can anybody kindly explain how these pairs are related to each other
&gt;&gt; and/or work together?
&gt; The "$FOO-nic"  device is a tap device created as a hack to force a
&gt; stable MAC address on the main bridge device due to bad kernel impl
&gt; of bridge device MAC address assignment.
&gt;
&gt; We stopped creating the "$FOO-nic" device in libvirt 6.8.0 since the
&gt; kernel was long ago fixed.
&gt;
&gt; Regards,
&gt; Daniel


[Attachment #3 (text/html)]

&lt;html&gt;
  &lt;head&gt;
    &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;font face="Helvetica, Arial, sans-serif"&gt;&lt;br&gt;
      ok, thanks for the explainer.&lt;/font&gt;&lt;br&gt;
    &lt;br&gt;
    &lt;div class="moz-cite-prefix"&gt;On 04.01.21 12:20, Daniel P. Berrangé
      wrote:&lt;br&gt;
    &lt;/div&gt;
    &lt;blockquote type="cite"
      cite="mid:20210104112041.GC640208@redhat.com"&gt;
      &lt;pre class="moz-quote-pre" wrap=""&gt;On Fri, Jan 01, 2021 at 10:24:41AM +0100, \
vrms wrote: &lt;/pre&gt;
      &lt;blockquote type="cite"&gt;
        &lt;pre class="moz-quote-pre" wrap=""&gt;I am trying to understand KVM networking a \
little better and have noted that the "virbr0" network interface (the default KVM \
bridge) comes with another device named "virbr0-nic".
The same kind of pair comes with each new bridge you may create via the
"virtual machine manager" (and assumingly other KVM tools alike)
Like "virbr1" comes in a pair with "virbr1-nic" (the *-nic interface is
being created automatically (and I assume will disapear automatically if
you remove the parent interface)

Can anybody kindly explain how these pairs are related to each other
and/or work together?
&lt;/pre&gt;
      &lt;/blockquote&gt;
      &lt;pre class="moz-quote-pre" wrap=""&gt;
The "$FOO-nic"  device is a tap device created as a hack to force a
stable MAC address on the main bridge device due to bad kernel impl
of bridge device MAC address assignment.

We stopped creating the "$FOO-nic" device in libvirt 6.8.0 since the
kernel was long ago fixed.

Regards,
Daniel
&lt;/pre&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
  &lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20210104190753</emailId><senderName>Michal Privoznik</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-01-04 19:07:53-0400</timestampReceived><subject>Re: Unexplicable permission error when trying to read a qemu firmware file</subject><body>

On 12/29/20 6:09 PM, Emmanuel Kasper wrote:
&gt; Hi
&gt; 
&gt; I want to create a CoreOS VM following the steps mentioned at
&gt; https://docs.fedoraproject.org/en-US/fedora-coreos/getting-started,
&gt; using a Debian 11 (bullseye) system.
&gt; I am thus creating a VM with the following virt-install command:
&gt; 
&gt; virt-install --connect="qemu:///system" --name=coreos \
&gt;      --vcpus=2 --memory=2048 \
&gt;      --os-variant=fedora29 --import --graphics=none \
&gt; 
&gt; --disk="size=10,backing_store=$PWD/fedora-coreos-33.20201201.3.0-qemu.x86_64.qcow2"
&gt; \
&gt;      --qemu-commandline="-fw_cfg
&gt; name=opt/com.coreos/config,file=/tmp/example.ign"

1: this ^^

&gt; 
&gt; which spits some warnings and this mysterious error
&gt; 
&gt; 2020-12-29T16:52:03.858938Z qemu-system-x86_64: warning: host doesn't
&gt; support requested feature: MSR(48FH).vmx-exit-load-perf-global-ctrl [bit 12]
&gt; 2020-12-29T16:52:03.858941Z qemu-system-x86_64: warning: host doesn't
&gt; support requested feature: MSR(490H).vmx-entry-load-perf-global-ctrl
&gt; [bit 13]

I don't know what are these, sorry.

&gt; 
&gt; 2020-12-29T16:52:03.864778Z qemu-system-x86_64: -fw_cfg
&gt; name=opt/com.coreos/config,file=/tmp/example.ign: can't load
&gt; /tmp/example.ign: Failed to open file "/tmp/example.ign": Permission denied

But this is expected.

&gt; 
&gt; the file /tmp/example.ign is perfectly world readable,
&gt; -rw-rw-rw- 1 manu manu 1130 Dec 29 17:23 /tmp/example.ign

This doesn't matter. It's SELinux what's giving you the error (as you've 
found out).

The problem here is [1]. If you bypass libvirt and put something right 
onto qemu's command line then libvirt blindly puts it there. No checks, 
no DAC/SELinux relabel, nothing. But I've implemented support for 
ignition files here:

https://gitlab.com/libvirt/libvirt/-/commit/3dda889a4426bb3555b1d8861d8314f82d8e1ef9

So what you need instead is:

   &lt;sysinfo type='fwcfg'&gt;
     &lt;entry name='opt/com.coreos/config' file='/tmp/example.ign'/&gt;
   &lt;/sysinfo&gt;

This will make libvirt set correct labels and everything. I'm not sure 
whether virt-install supports that though, sorry.

Michal

</body></email><email><emailId>20210105183117</emailId><senderName>Eduardo Habkost</senderName><senderEmail>ehabkost@redhat.com</senderEmail><timestampReceived>2021-01-05 18:31:17-0400</timestampReceived><subject>Re: about the script /etc/qemu-ifup with nmcli command</subject><body>

On Wed, Oct 21, 2020 at 06:31:50PM +0800, Yalan Zhang wrote:
&gt; Hi,
&gt; 
&gt; I have tried the qemu-ifup script as below with nmcli command as brctl is
&gt; deprecated on rhel8, but the guest network can not work.
&gt; I think the script needs update. Could you please help to have a look?
&gt; Thank you in advance.
&gt; 
&gt; 1. prepare a linux bridge on the host named br0;
&gt; 
&gt; 2. prepare the qemu-ifup script as below:
&gt; # cat /etc/qemu-ifup
&gt; #!/bin/bash
&gt; # A br0 bridge should be already set up.
&gt; # Compare with:
&gt; # http://en.wikibooks.org/wiki/QEMU/Networking#qemu-ifup
&gt; #
&gt; # For the bridge setup, see:
&gt; # http://wiki.libvirt.org/page/Networking#Fedora.2FRHEL_Bridging
&gt; # http://gist.github.com/393525
&gt; ip link set "$1" up
&gt; nmcli c add type bridge-slave ifname $1 con-name $1 master br0 autoconnect
&gt; yes
&gt; 
&gt; 3. start vm with below interface setting:
&gt; # virsh dumpxml rh | grep /interface -B5
&gt;     &lt;interface type='ethernet'&gt;
&gt;       &lt;mac address='52:54:00:79:ba:dd'/&gt;
&gt;       &lt;script path='/etc/qemu-ifup'/&gt;

I don't know how to make the script work, but I don't understand
why you are using &lt;script&gt; instead of &lt;source bridge='...'&gt; as
documented at
http://wiki.libvirt.org/page/Networking#Fedora.2FRHEL_Bridging


&gt;       &lt;model type='virtio'/&gt;
&gt;       &lt;address type='pci' domain='0x0000' bus='0x04' slot='0x00'
&gt; function='0x0'/&gt;
&gt;     &lt;/interface&gt;
&gt; # virsh start rh
&gt; Domain rh started
&gt; 
&gt; 4.check on guest, the interface can not get dhcp ip address;
&gt; 
&gt; 5. check on host,
&gt; # nmcli con
&gt; NAME    UUID                                  TYPE      DEVICE
&gt; br0     f68f73c7-10ee-40c1-bb09-3366d11ac896  bridge    br0
&gt; ...
&gt; vnet0   90a48d77-dccc-4b59-98f5-09f8cbd62458  ethernet  --
&gt; 
&gt; # nmcli dev
&gt; DEVICE      TYPE      STATE                   CONNECTION
&gt; br0         bridge    connected               br0
&gt; ...
&gt; vnet0       tun       unmanaged               --
&gt; 
&gt; 6. hotplug a bridge type interface and compare the tap devices:
&gt; # virsh attach-interface rh bridge br0 --model virtio
&gt; Interface attached successfully
&gt; 
&gt; # nmcli con
&gt; NAME    UUID                                  TYPE      DEVICE
&gt; br0     f68f73c7-10ee-40c1-bb09-3366d11ac896  bridge    br0
&gt; vnet1   07c2a1f8-396f-4d5f-b61f-ef2ddb42ed93  tun       vnet1    ---&gt;the
&gt; hot-plugged one
&gt; ...
&gt; vnet0   90a48d77-dccc-4b59-98f5-09f8cbd62458  ethernet  --       ----&gt; the
&gt; ethernet one
&gt; 
&gt; # nmcli dev
&gt; DEVICE      TYPE      STATE                   CONNECTION
&gt; vnet1       tun       connected (externally)  vnet1         ---&gt;the
&gt; hot-plugged one
&gt; vnet0       tun       unmanaged               --     ----&gt; the ethernet one
&gt; ...
&gt; 
&gt; 7. from the outputs above, the back-end tun device for ethernet type
&gt; interface is unmanaged.
&gt; I don't know how to update the script to fix it. Could you please help?
&gt; 
&gt; 
&gt; -------
&gt; Best Regards,
&gt; Yalan Zhang
&gt; IRC: yalzhang

-- 
Eduardo

</body></email><email><emailId>20210106101933</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-01-06 10:19:33-0400</timestampReceived><subject>Re: Migration via qemu+ssh using a given private ssh key possible ?</subject><body>

On Tue, Jan 05, 2021 at 07:39:49PM +0100, Oliver Dzombic wrote:
&gt; Hi Peter,
&gt; 
&gt; thank you very much for this hint. Seems to work! :)
&gt; 
&gt; But i also tried another switch: no_verify=1
&gt; 
&gt; The whole call:
&gt; 
&gt; virsh -K0 -k0 migrate --copy-storage-inc --verbose --persistent --live
&gt; testInstance
&gt; qemu+ssh://testnode4:22/system?keyfile=/tmp/key-5ff4b02ca966c?no_verify=1?no_tty=1
&gt; 
&gt; So as you can see
&gt; 
&gt; no_verify=1
&gt; no_tty=1
&gt; 
&gt; has been added.

You have incorrect URL syntax here. You need to use "&amp;" to separate
parameters, not "?". The "?" is only valid to separate the path from
the start of the parameter list.

qemu+ssh://testnode4:22/system?keyfile=/tmp/key-5ff4b02ca966c&amp;no_verify=1&amp;no_tty=1


Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20210106154855</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-01-06 15:48:55-0400</timestampReceived><subject>Re: [ovirt-devel] Issue: Device path changed after adding disks to guest VM</subject><body>

On Wed, Jan 06, 2021 at 04:36:46PM +0100, Peter Krempa wrote:
&gt; On Wed, Jan 06, 2021 at 17:16:24 +0200, Nir Soffer wrote:
&gt; &gt; On Wed, Dec 2, 2020 at 4:57 PM Joy Li &lt;joooy.li@gmail.com&gt; wrote:
&gt; 
&gt; [...]
&gt; 
&gt; &gt; Comparing to state before reboot:
&gt; &gt; 
&gt; &gt; # virsh -r domblklist disk-mapping
&gt; &gt; Target   Source
&gt; &gt; ---------------------------------------------------------------------------------------------------------------------------------------------------------------
&gt; &gt;  sdc      -
&gt; &gt; sda      /rhev/data-center/mnt/blockSD/84dc4e3c-00fd-4263-84e8-fc246eeee6e9/images/40018b33-2b11-4d10-82e4-604a5b135fb2/40f455c4-8c92-4f8f-91c2-991b0ddfc2f5
&gt; &gt;  vda      /dev/mapper/3600140594af345ed76d42058f2b1a454
&gt; &gt; vdb      /dev/mapper/360014050058f2f8a0474dc7a8a7cc6a5
&gt; &gt; vdc      /dev/mapper/36001405b4d0c0b7544d47438b21296ef
&gt; &gt; 
&gt; &gt; # ls -lh /dev/disk/by-id/virtio-*
&gt; &gt; lrwxrwxrwx. 1 root root 9 Jan  6 09:42
&gt; &gt; /dev/disk/by-id/virtio-b97e68b2-87ea-45ca-9 -&gt; ../../vda
&gt; &gt; lrwxrwxrwx. 1 root root 9 Jan  6 09:42
&gt; &gt; /dev/disk/by-id/virtio-d9a29187-f492-4a0d-a -&gt; ../../vdb
&gt; &gt; lrwxrwxrwx. 1 root root 9 Jan  6 09:51
&gt; &gt; /dev/disk/by-id/virtio-e801c2e4-dc2e-4c53-b -&gt; ../../vdc
&gt; &gt; 
&gt; &gt; In the guest disks are mapped to the same device name.
&gt; &gt; 
&gt; &gt; It looks like libivrt domblklist is not correct - vdb and vdc are switched.
&gt; &gt; Peter, this expected?
&gt; 
&gt; The names in 'virsh domblklist' are unfortunately and confusingly chosen
&gt; to match the expected /dev/ device node name, but it's at kernel's
&gt; discretion to name /dev/ nodes.
&gt; 
&gt; This means that it's not guaranteed that what you see in 'virsh
&gt; domblklist' will match the state in the guest.

Essentially the only thing the disk device name is used for is
sorting the &lt;disk&gt; elements within the XML document. This in
turn affects what order PCI addresses (virtio-blk) or SCSI
LUNS (virtio-scsi) are assigned in. This influences/hints as
to what order the guest OS *might* assign device names in.

The device name from the XML is not exposed to the guest
directly though.

Certainly when hotplugging/unplugging is involved all bets are
off wrt what disk names you'll see in the guest vs the XML. Dont
expect them to match except by luck.


Regards,
Daniel
-- 
&gt; &gt; https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
&gt; &gt; https://libvirt.org         -o-            https://fstop138.berrange.com :|
&gt; &gt; https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|


</body></email><email><emailId>20210108080017</emailId><senderName>Christoph</senderName><senderEmail>mangel@gmx.de</senderEmail><timestampReceived>2021-01-08 08:00:17-0400</timestampReceived><subject>Re: Problem with xen hvm DomU</subject><body>

Hi

Unfortunately not... I use still the xen config with this domU, I didnt
find out how to make it with xml libvirt config :(

---
------
Greetz

Am 08.01.2021 01:28, schrieb Jim Fehlig:
&gt; While doing some new year mail cleaning I noticed this unanswered
&gt; mail. It is quite old so perhaps you've figured something out in the
&gt; meantime.
&gt;
&gt; On 9/10/20 7:31 AM, Christoph wrote:
&gt;&gt; I think its again a translate error of domxml-from-native...
&gt;&gt;
&gt;&gt; This is the line in xl config:
&gt;&gt;
&gt;&gt; vif = [
&gt;&gt; "mac=00:16:3e:05:30:04,bridge=xenbr5,script=vif-bridge,type=vif",
&gt;&gt; "mac=00:16:3e:04:30:04,bridge=xenbr4,script=vif-bridge,type=vif",
&gt;&gt; "mac=00:16:3e:15:30:04,bridge=xenbr15,script=vif-bridge,type=vif",
&gt;&gt; "mac=00:16:3e:14:30:04,bridge=xenbr14,script=vif-bridge,type=vif" ]
&gt;&gt;
&gt;&gt; in xen if I want to use more than 3 nic's I need to define the
&gt;&gt; "type=vif". With default or e1000 as type it doesnt work for &gt;3 nic's
&gt;&gt;
&gt;&gt; The translated config is:
&gt;&gt;
&gt;&gt; &lt;interface type='bridge'&gt;
&gt;&gt;        &lt;mac address='00:16:3e:05:30:04'/&gt;
&gt;&gt;        &lt;source bridge='xenbr5'/&gt;
&gt;&gt;        &lt;script path='vif-bridge'/&gt;
&gt;&gt;        &lt;model type='netfront'/&gt;
&gt;&gt; &lt;/interface&gt;
&gt;&gt; ...
&gt;
&gt; This translation is correct.
&gt;
&gt;&gt; there is the type "netfront" and nothing about type=vif. I've tried to
&gt;&gt; set it to model type='vif' but it doesnt work to...
&gt;
&gt; Long ago the Xen PV NIC model was known as "netfront", and for better
&gt; or worse the name was exposed in the libvirt domXML schema. When the
&gt; Xen community ditched xend in favor of libxl, the specification of
&gt; emulated (LIBXL_NIC_TYPE_VIF_IOEMU) vs PV (LIBXL_NIC_TYPE_VIF) NIC was
&gt; moved to the 'nictype' field of the NIC definition. Compatibility
&gt; guarantees of libvirt schema prevent changing the model from
&gt; "netfront" to "vif". The latter could be added to the schema as
&gt; another way of specifying a PV NIC model, but we already have
&gt; "netfront" and another would only add more confusion IMO :-).
&gt;
&gt; Regardless of the name used in the libvirt schema, the libxl driver
&gt; should be doing the right thing and mapping &lt;model type='netfront'/&gt;
&gt; to LIBXL_NIC_TYPE_VIF. I tested an HVM guest with 4 "netfront"
&gt; interfaces and didn't notice any problems. What version of libvirt are
&gt; you using?
&gt;
&gt; Regards,
&gt; Jim
&gt;
&gt;&gt; Am 09.09.2020 05:12, schrieb Jim Fehlig:
&gt;&gt;&gt; On 9/8/20 7:55 AM, Christoph wrote:
&gt;&gt;&gt;&gt; It seems there is a problem with more than 3 NIC's... If I delete
&gt;&gt;&gt;&gt; one
&gt;&gt;&gt;&gt; nick from the config then it starts without problems...
&gt;&gt;&gt;
&gt;&gt;&gt; Wow, that's not good :-). I took a quick peek at the code but didn't
&gt;&gt;&gt; spot anything obvious. Since I don't have time to investigate further
&gt;&gt;&gt; now, perhaps it would be best to track this in the gitlab issue
&gt;&gt;&gt; tracker
&gt;&gt;&gt;
&gt;&gt;&gt; https://gitlab.com/libvirt/libvirt/-/issues
&gt;&gt;&gt;
&gt;&gt;&gt; Can you create a new issue there? Thanks!
&gt;&gt;&gt;
&gt;&gt;&gt; Regards,
&gt;&gt;&gt; Jim
&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; ---
&gt;&gt;&gt;&gt; ------
&gt;&gt;&gt;&gt; Greetz
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Am 03.09.2020 14:28, schrieb Christoph:
&gt;&gt;&gt;&gt;&gt; Hi
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; can someone say me whats wrong in this config:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; &lt;domain type='xen'&gt;
&gt;&gt;&gt;&gt;&gt;   &lt;name&gt;fenrir.chao5.int&lt;/name&gt;
&gt;&gt;&gt;&gt;&gt;   &lt;uuid&gt;7aedcd03-54e8-4055-8d1b-37dd34194859&lt;/uuid&gt;
&gt;&gt;&gt;&gt;&gt;   &lt;memory unit='KiB'&gt;2097152&lt;/memory&gt;
&gt;&gt;&gt;&gt;&gt;   &lt;currentMemory unit='KiB'&gt;2097152&lt;/currentMemory&gt;
&gt;&gt;&gt;&gt;&gt;   &lt;vcpu placement='static'&gt;2&lt;/vcpu&gt;
&gt;&gt;&gt;&gt;&gt;   &lt;os&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;type arch='x86_64' machine='xenfv'&gt;hvm&lt;/type&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;loader type='rom'&gt;/usr/lib/xen/boot/hvmloader&lt;/loader&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;kernel&gt;/usr/lib64/xen/boot/hvmloader&lt;/kernel&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;boot dev='hd'/&gt;
&gt;&gt;&gt;&gt;&gt;   &lt;/os&gt;
&gt;&gt;&gt;&gt;&gt;   &lt;features&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;acpi/&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;apic/&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;pae/&gt;
&gt;&gt;&gt;&gt;&gt;   &lt;/features&gt;
&gt;&gt;&gt;&gt;&gt;   &lt;clock offset='variable' adjustment='0' basis='localtime'/&gt;
&gt;&gt;&gt;&gt;&gt;   &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
&gt;&gt;&gt;&gt;&gt;   &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
&gt;&gt;&gt;&gt;&gt;   &lt;on_crash&gt;restart&lt;/on_crash&gt;
&gt;&gt;&gt;&gt;&gt;   &lt;devices&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;disk type='file' device='disk'&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;driver name='qemu' type='raw'/&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;source file='/dev/vg_astarte/lv_fenrir_root'/&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;target dev='hda' bus='ide'/&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;address type='drive' controller='0' bus='0' target='0'
&gt;&gt;&gt;&gt;&gt; unit='0'/&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;/disk&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;disk type='file' device='disk'&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;driver name='qemu' type='raw'/&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;source file='/dev/vg_astarte/lv_fenrir_swap'/&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;target dev='hdb' bus='ide'/&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;address type='drive' controller='0' bus='0' target='0'
&gt;&gt;&gt;&gt;&gt; unit='1'/&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;/disk&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;controller type='xenbus' index='0'/&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;controller type='ide' index='0'/&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;interface type='bridge'&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;mac address='00:16:3e:05:30:04'/&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;source bridge='xenbr5'/&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;script path='vif-bridge'/&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;model type='netfront'/&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;/interface&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;interface type='bridge'&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;mac address='00:16:3e:04:30:04'/&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;source bridge='xenbr4'/&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;script path='vif-bridge'/&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;model type='netfront'/&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;/interface&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;interface type='bridge'&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;mac address='00:16:3e:15:30:04'/&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;source bridge='xenbr15'/&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;script path='vif-bridge'/&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;model type='netfront'/&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;/interface&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;interface type='bridge'&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;mac address='00:16:3e:14:30:04'/&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;source bridge='xenbr14'/&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;script path='vif-bridge'/&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;model type='netfront'/&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;/interface&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;input type='mouse' bus='ps2'/&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;input type='keyboard' bus='ps2'/&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;graphics type='vnc' port='6000' autoport='no'
&gt;&gt;&gt;&gt;&gt; listen='0.0.0.0'&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;listen type='address' address='0.0.0.0'/&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;/graphics&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;video&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;model type='cirrus' vram='8192' heads='1' primary='yes'/&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;/video&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;memballoon model='xen'/&gt;
&gt;&gt;&gt;&gt;&gt;   &lt;/devices&gt;
&gt;&gt;&gt;&gt;&gt; &lt;/domain&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; If I try to start it with virsh create... then I see only:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; error: Failed to create domain from
&gt;&gt;&gt;&gt;&gt; /etc/libvirt/libxl/fenrir.chao5.int.xml
&gt;&gt;&gt;&gt;&gt; error: internal error: libxenlight failed to create new domain
&gt;&gt;&gt;&gt;&gt; 'fenrir.chao5.int'
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; ------
&gt;&gt;&gt;&gt;&gt; Greetz
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;


</body></email><email><emailId>20210112092754</emailId><senderName>John Paul Adrian Glaubitz</senderName><senderEmail>glaubitz@physik.fu-berlin.de</senderEmail><timestampReceived>2021-01-12 09:27:54-0400</timestampReceived><subject>Re: [resent] virt-manager connection fails with 'qemu unexpectedly closed the monitor'</subject><body>

Hello!

On 12/20/20 12:53 PM, John Paul Adrian Glaubitz wrote:
&gt; I recently ran into a problem when connecting to libvirtd 6.9.0 on Debian unstable
&gt; and trying to import an existing image with Windows 7.
&gt; 
&gt; Upon finishing the wizard and starting the instance, the import process fails
&gt; with the following error message:
&gt; 
&gt; Unable to complete install: 'internal error: qemu unexpectedly closed the monitor'
&gt; (...)
&gt; Does anyone know how to increase verbosity here to get an error message that might be
&gt; more helpful?

Just as a heads-up: This problem got resolved after a dist-upgrade which didn't upgrade
libvirt but some Python packages so I assume that one or more Python packages needed
an update or rebuild with Python 3.9.

Thanks,
Adrian

-- 
 .''`.  John Paul Adrian Glaubitz
: :' :  Debian Developer - glaubitz@debian.org
`. `'   Freie Universitaet Berlin - glaubitz@physik.fu-berlin.de
  `-    GPG: 62FF 8A75 84E0 2956 9546  0006 7426 3B37 F5B5 F913

</body></email><email><emailId>20210113081325</emailId><senderName>Michal Privoznik</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-01-13 08:13:25-0400</timestampReceived><subject>Re: Get Host Capabilities failed: Internal JSON-RPC error: {'reason': 'internal error: Duplicate key</subject><body>

On 1/13/21 8:48 AM, tommy wrote:
&gt; I should upgrade my libvirt from 5.7 to 6.1 to resole this question ?

Yes. You want to upgrade to at least 6.1.0 or newer.

Michal

</body></email><email><emailId>20210113164318</emailId><senderName>Michal Privoznik</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-01-13 16:43:18-0400</timestampReceived><subject>Re: I would like to contribute to libvirt</subject><body>

On 1/12/21 7:19 AM, PRAJWAL BENEDICT A wrote:
&gt; 

Hey,

it's nice to see people interested in libvirt. You mention machine 
learning, but libvirt is more about controlling virtual machines.

For GSoC - yes, we do that. I plan to apply this year too on behalf of 
libvirt, but looking at the schedule the org applications are not open yet:

https://summerofcode.withgoogle.com/how-it-works/#timeline

However, if you are still interested then we have some easy enough 
issues for beginners here:

https://gitlab.com/libvirt/libvirt/-/issues?label_name%5B%5D=bitesizedtask

Feel free to pick one. Just mention it in the commit message, e.g. like 
this:

   Resolves: https://gitlab.com/libvirt/libvirt/-/issues/XXX

Here's also something for newbies worth reading:

   https://libvirt.org/contribute.html

Michal

</body></email><email><emailId>20210118090121</emailId><senderName>Gianluca Cecchi</senderName><senderEmail>gianluca.cecchi@gmail.com</senderEmail><timestampReceived>2021-01-18 09:01:21-0400</timestampReceived><subject>Re: How to enable libvirtd auth just like oVirt ?</subject><body>

On Mon, Jan 18, 2021 at 8:33 AM tommy &lt;sz_cuitao@163.com&gt; wrote:

&gt;
&gt;
&gt;
&gt;
&gt; *How can I enable auth in my libvirtd env just like oVirt ?*
&gt;
&gt;
&gt;
&gt; Thanks.
&gt;
&gt;
&gt;
&gt;
&gt;

The main howto file for doing this in general with libvirt is here:
https://libvirt.org/auth.html

Based on what oVirt 4.3 and 4.4 configure inside the files:
/etc/libvirt/libvirtd.conf
/etc/sasl2/libvirt.conf

you can map the howto above possible choices with what you want and so
mimic oVirt behavior.
If I read correctly the above files, it should be sasl authentication
mechanism with DIGEST-MD5 plugin and SCRAM mechanism for both oVirt 4.3 and
4.4

HIH,
Gianluca

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Mon, \
Jan 18, 2021 at 8:33 AM tommy &lt;&lt;a \
href="mailto:sz_cuitao@163.com"&gt;sz_cuitao@163.com&lt;/a&gt;&gt; wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote \
class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid \
rgb(204,204,204);padding-left:1ex"&gt;&lt;div style="overflow-wrap: break-word;" \
lang="ZH-CN"&gt;&lt;div&gt;&lt;span lang="EN-US"&gt;&lt;/span&gt;&lt;p class="MsoNormal"&gt;&lt;span \
lang="EN-US"&gt;&lt;u&gt;&lt;/u&gt;  &lt;u&gt;&lt;/u&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class="MsoNormal"&gt;&lt;span \
lang="EN-US"&gt;&lt;u&gt;&lt;/u&gt;  &lt;u&gt;&lt;/u&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class="MsoNormal"&gt;&lt;b&gt;&lt;span \
lang="EN-US"&gt;How can I enable auth in my libvirtd env just like oVirt \
?&lt;u&gt;&lt;/u&gt;&lt;u&gt;&lt;/u&gt;&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p class="MsoNormal"&gt;&lt;span lang="EN-US"&gt;&lt;u&gt;&lt;/u&gt;  \
&lt;u&gt;&lt;/u&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class="MsoNormal"&gt;&lt;span \
lang="EN-US"&gt;Thanks.&lt;u&gt;&lt;/u&gt;&lt;u&gt;&lt;/u&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class="MsoNormal"&gt;&lt;span \
lang="EN-US"&gt;&lt;u&gt;&lt;/u&gt;  &lt;u&gt;&lt;/u&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class="MsoNormal"&gt;&lt;span lang="EN-US"&gt;  \
&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;br&gt;&lt;div&gt;The main howto file for doing this in \
general with libvirt is here:&lt;/div&gt;&lt;div&gt;&lt;a \
href="https://libvirt.org/auth.html"&gt;https://libvirt.org/auth.html&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt; \
&lt;/div&gt;&lt;div&gt;Based on what oVirt 4.3 and 4.4 configure inside the files: \
&lt;br&gt;&lt;/div&gt;&lt;div&gt;/etc/libvirt/libvirtd.conf&lt;/div&gt;&lt;div&gt; \
/etc/sasl2/libvirt.conf&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;you can map the howto above possible \
choices with what you want and so mimic oVirt behavior.&lt;/div&gt;&lt;div&gt;If I read correctly \
the above files, it should be sasl authentication mechanism with DIGEST-MD5 plugin \
and SCRAM mechanism for both oVirt 4.3 and \
4.4&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;HIH,&lt;br&gt;&lt;/div&gt;&lt;div&gt;Gianluca&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;




</body></email><email><emailId>20210121104002</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-01-21 10:40:02-0400</timestampReceived><subject>Re: virsh backup-begin problem</subject><body>

On Thu, Jan 21, 2021 at 13:31:03 +0300, Andrey Fokin wrote:
&gt; Thanks Peter!
&gt; But is possible change XML configuration towards will be possible to do
&gt; full (push) backup?

Yes, I've included links to the documentation to do so in my previous
reply, so I'd suggest you follow it. See ...

&gt; On Wed, Jan 20, 2021 at 9:08 PM Peter Krempa &lt;pkrempa@redhat.com&gt; wrote:
&gt; 
&gt; &gt; On Wed, Jan 20, 2021 at 20:49:49 +0300, Andrey Fokin wrote:
&gt; &gt; &gt; Colleagues, could you please advise what a problem could be in XML file
&gt; &gt; in
&gt; &gt; &gt; case of:
&gt; &gt; &gt; virsh backup-begin lubuntu2 ./backup.xml
&gt; &gt; &gt;
&gt; &gt; &gt; where backup.xml -
&gt; &gt; &gt; &lt;domainbackup&gt;
&gt; &gt; &gt;     &lt;disk name='/var/lib/libvirt/images/lubuntu2.qcow2' type='file'&gt;
&gt; &gt; &gt;     &lt;target file='$PWD/scratch1.img'/&gt;
&gt; &gt; &gt;     &lt;driver type='raw'/&gt;
&gt; &gt; &gt;     &lt;/disk&gt;
&gt; &gt; &gt;     &lt;disk name='/var/lib/libvirt/images/lubuntu2-1.qcow2' type='file'&gt;
&gt; &gt; &gt;       &lt;target file='$PWD/scratch2.img'/&gt;
&gt; &gt; &gt;       &lt;driver type='raw'/&gt;
&gt; &gt; &gt;     &lt;/disk&gt;
&gt; &gt; &gt; &lt;/domainbackup&gt;
&gt; &gt;
&gt; &gt; snip ...
&gt; &gt;
&gt; &gt; You forgot to add what you are observing, but I presume:
&gt; &gt;
&gt; &gt; 'operation unsupported: incremental backup is not supported yet'
&gt; &gt;
&gt; &gt; Unfortunately it's what it says on the tin. The implementation of the
&gt; &gt; incremental backup code is not finished yet, thus the feature is
&gt; &gt; disabled.
&gt; &gt;
&gt; &gt; If you want to test-drive incremental backup APIs, you can enable the
&gt; &gt; experimental feature by using the XML documented in:
&gt; &gt;
&gt; &gt; https://libvirt.org/drvqemu.html#xmlnsfeatures

... here. I specifically avoided giving exact steps so that you read the
documentation including the description of caveats of enabling this
_experimental_ feature.

So please make sure to read it. This is NOT meant for production use.

Anyways:

You need to add the 'qemu' namespace to your domain XML:

&lt;domain type='kvm' xmlns:qemu='http://libvirt.org/schemas/domain/qemu/1.0'&gt;

And force-on the incremental backup capability:

  &lt;qemu:capabilities&gt;
    &lt;qemu:add capability='incremental-backup'/&gt;
  &lt;/qemu:capabilities&gt;


This enables backups, but as I've wrote previously ...

&gt; &gt;
&gt; &gt; to enable a feature named 'incremental-backup'. Please make sure to read
&gt; &gt; the caveats of doing so thoroughly.

.. observe the following:

&gt; &gt; I also advise not to combine incremental backups with snapshots
&gt; &gt; (virDomainSnapshot* APIs) and blockjobs (virDomainBlock* APIs) as that
&gt; &gt; will not work properly without a patch enabling also experimental qemu
&gt; &gt; features.

If you use them, backups will break. You get to keep the pieces, as
you've been warned.

Also this:

&gt; &gt; I also suggest you use the latest qemu for this.

</body></email><email><emailId>20210121151952</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-01-21 15:19:52-0400</timestampReceived><subject>Re: Fwd: virsh backup-begin problem</subject><body>

On Thu, Jan 21, 2021 at 18:12:54 +0300, Andrey Fokin wrote:
&gt; Do you mean "experimental" feature to enable incremental backup? No, didn't
&gt; because I try to implement full buckup (not an incremental one). Or am I
&gt; missing something and it is the same?

It's the same. Implementing lockouts for every single sub-feature which
is actually complete would be too much of a hassle.

If you don't do incrementals (don't create checkpoints) the
snapshot/blockjob APIs will work as expected.

And yes, it's still considered experimental.

</body></email><email><emailId>20210121204812</emailId><senderName>vrms</senderName><senderEmail>vrms@netcologne.de</senderEmail><timestampReceived>2021-01-21 20:48:12-0400</timestampReceived><subject>Re: learning materials kvm/qemu/libvirt</subject><body>

On 21.01.21 19:23, Thing wrote:
&gt; /Do both..../
even though I wasn't exactly looking for advice of such sort ... thx for
your suggestion.


&gt;
&gt; On Fri, 22 Jan 2021 at 05:45, vrms &lt;vrms@netcologne.de
&gt; &lt;mailto:vrms@netcologne.de&gt;&gt; wrote:
&gt;
&gt;     I am doing a 2 year retraining at the moment to become a system admin.
&gt;
&gt;     There are 2 weeks of HyperV on the schedule (sadly the only
&gt;     virtualization that will be taught in that course) in august and
&gt;     plan to
&gt;     sneak out of class during that time to to something useful and get a
&gt;     grip on the kvm/qemu/libvirt side of the VM cake (class is completely
&gt;     online, so the sneaking out is doable).
&gt;
&gt;     Can anybody recommend good online learning resources for someone with
&gt;     yet quite foggy basic understanding of things?
&gt;
&gt;     thanks and best
&gt;     Gunnar
&gt;
&gt;


[Attachment #3 (text/html)]

&lt;html&gt;
  &lt;head&gt;
    &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;div class="moz-cite-prefix"&gt;On 21.01.21 19:23, Thing wrote:&lt;font
        color="#852b2b"&gt;&lt;br&gt;
      &lt;/font&gt;&lt;/div&gt;
    &lt;blockquote type="cite"
cite="mid:CAJDAmYES2nBqysfsvKFW19Me5UpPoY3rc1T-y6R2Lajb0gcmmQ@mail.gmail.com"&gt;
      &lt;meta http-equiv="content-type" content="text/html; charset=UTF-8"&gt;
      &lt;div dir="ltr"&gt;&lt;i&gt;&lt;font color="#852b2b"&gt;Do both....&lt;/font&gt;&lt;/i&gt;&lt;/div&gt;
    &lt;/blockquote&gt;
    even though I wasn't exactly looking for advice of such sort ... thx
    for your suggestion.&lt;br&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;blockquote type="cite"
cite="mid:CAJDAmYES2nBqysfsvKFW19Me5UpPoY3rc1T-y6R2Lajb0gcmmQ@mail.gmail.com"&gt;&lt;br&gt;
      &lt;div class="gmail_quote"&gt;
        &lt;div dir="ltr" class="gmail_attr"&gt;On Fri, 22 Jan 2021 at 05:45,
          vrms &lt;&lt;a href="mailto:vrms@netcologne.de"
            moz-do-not-send="true"&gt;vrms@netcologne.de&lt;/a&gt;&gt; wrote:&lt;br&gt;
        &lt;/div&gt;
        &lt;blockquote class="gmail_quote" style="margin:0px 0px 0px
          0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;I
          am doing a 2 year retraining at the moment to become a system
          admin.&lt;br&gt;
          &lt;br&gt;
          There are 2 weeks of HyperV on the schedule (sadly the only&lt;br&gt;
          virtualization that will be taught in that course) in august
          and plan to&lt;br&gt;
          sneak out of class during that time to to something useful and
          get a&lt;br&gt;
          grip on the kvm/qemu/libvirt side of the VM cake (class is
          completely&lt;br&gt;
          online, so the sneaking out is doable).&lt;br&gt;
          &lt;br&gt;
          Can anybody recommend good online learning resources for
          someone with&lt;br&gt;
          yet quite foggy basic understanding of things?&lt;br&gt;
          &lt;br&gt;
          thanks and best&lt;br&gt;
          Gunnar&lt;br&gt;
          &lt;br&gt;
          &lt;br&gt;
        &lt;/blockquote&gt;
      &lt;/div&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
  &lt;/body&gt;
&lt;/html&gt;


</body></email><email><emailId>20210125231538</emailId><senderName>Riccardo Ravaioli</senderName><senderEmail>riccardoravaioli@gmail.com</senderEmail><timestampReceived>2021-01-25 23:15:38-0400</timestampReceived><subject>Re: how to use external snapshots with memory state</subject><body>

On Sun, 3 Jan 2021 at 15:30, Peter Krempa &lt;pkrempa@redhat.com&gt; wrote:

&gt;
&gt; Hi,
&gt;


Hi Peter,

Thanks a lot for the prompt reply and for pointing me to the direction
("virsh restore" among all) and apologies for my very late reply.
In the past couple of weeks I had a thorough look at past messages in the
mailing list as well as linked tutorials, notes and slides.

The memory image created by libvirt this way is actually in the same
&gt; image format as 'virsh save' and 'virsh restore' uses.
&gt; [...]
&gt;

 I think I bumped into two limitations for my particular use case, but I'd
like to double check with you, just in case I'm again missing something.

1) When creating an external online snapshot (disks+memory) of a qemu-KVM
VM, I'd like to store the backing files in a separate folder and rename the
newly-created delta files with the respective names of the original disks
(now the backing files). Is this possible at all? Say a VM has a disk
vm/disk1.qcow2 and I take an external snapshot, I'd like the backing file
to appear in snap/disk1.qcow2 and the new delta disk to appear as
vm/disk1.qcow2. Currently I wait for the VM to be shutdown by the user
before I move around disks as desired and run qemu-img rebase in unsafe
mode to update the delta disks. Can I accomplish the same result while the
VNF is running?

2) As you suggested, I now use "virsh restore" to launch a VM with the
memory state I had previously backed up. The "virsh restore" API applies to
a VM that is not running. However, I see that for internal snapshots,
libvirt also supports a snapshot-revert operation on a /live/ VM. Is this
possible at all with an external snapshot? If so, what are the commands
needed? My current way of automating a snapshot-revert with an external
online snapshot only applies to a shutdown VM. It consists in:
- shutting down the VM;
- erasing all its delta disks, replacing them with new ones;
- executing "virsh restore" on the memory state, making sure that the disk
paths referenced in the embedded XML file are correct.
Does this seem reasonable? Can I do the same while the VNF is running?
I suppose that for a snapshot-delete operation on a live VM I just need to
run "virsh blockpull" on each disk, but I couldn't figure out how to do a
revert.

Thanks again!

Riccardo

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div dir="ltr"&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" \
class="gmail_attr"&gt;On Sun, 3 Jan 2021 at 15:30, Peter Krempa &lt;&lt;a \
href="mailto:pkrempa@redhat.com" target="_blank"&gt;pkrempa@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;&lt;br&gt; \
Hi,&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;Hi \
Peter,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks a lot for the prompt reply and for pointing me \
to the direction ("virsh restore" among all) and apologies for my very late \
reply. &lt;br&gt;&lt;/div&gt;&lt;div&gt;In the past couple of weeks I had a thorough look at past \
messages in the mailing list as well as linked tutorials, notes and slides.   \
&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" \
style="margin:0px 0px 0px 0.8ex;border-left:1px solid \
rgb(204,204,204);padding-left:1ex"&gt; The memory image created by libvirt this way is \
actually in the same&lt;br&gt; image format as 'virsh save' and 'virsh \
restore' uses. &lt;br&gt; [...]&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;  I think I bumped \
into two limitations for my particular use case, but I'd like to double check \
with you, just in case I'm again missing \
something.&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;1) When creating an external online snapshot \
(disks+memory) of a qemu-KVM VM, I'd like to store the backing files in a \
separate folder and rename the newly-created delta files with the respective names of \
the original disks (now the backing files). Is this possible at all? Say a VM has a \
disk vm/disk1.qcow2 and I take an external snapshot, I'd like the backing file to \
appear in snap/disk1.qcow2 and the new delta disk to appear as vm/disk1.qcow2. \
Currently I wait for the VM to be shutdown by the user before I move around disks as \
desired and run qemu-img rebase in unsafe mode to update the delta disks. Can I \
accomplish the same result while the VNF is running?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;2) As \
you suggested, I now use "virsh restore" to launch a VM with the memory \
state I had previously backed up. The "virsh restore" API applies to a VM \
that is not running. However, I see that for internal snapshots, libvirt also \
supports a snapshot-revert operation on a /live/ VM. Is this possible at all with an \
external snapshot? If so, what are the commands needed? My current way of automating \
a snapshot-revert with an external online snapshot only applies to a shutdown VM. It \
consists in:&lt;/div&gt;&lt;div&gt;- shutting down the VM;&lt;/div&gt;&lt;div&gt;- erasing all its delta \
disks, replacing them with new ones;&lt;/div&gt;&lt;div&gt;- executing "virsh restore" \
on the memory state, making sure that the disk paths referenced in the embedded XML \
file are correct.&lt;br&gt;&lt;/div&gt;&lt;div&gt;Does this seem reasonable? Can I do the same while \
the VNF is running?&lt;br&gt;&lt;/div&gt;&lt;div&gt;I suppose that for a snapshot-delete operation on a \
live VM I just need to run "virsh blockpull" on each disk, but I \
couldn't figure out how to do a \
revert.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;Thanks \
again!&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Riccardo&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt; &lt;/div&gt;



</body></email><email><emailId>20210120174949</emailId><senderName>Andrey Fokin</senderName><senderEmail>lazzyfox@gmail.com</senderEmail><timestampReceived>2021-01-20 17:49:49-0400</timestampReceived><subject>virsh backup-begin problem</subject><body>

Colleagues, could you please advise what a problem could be in XML file in
case of:
virsh backup-begin lubuntu2 ./backup.xml

where backup.xml -
&lt;domainbackup&gt;
    &lt;disk name='/var/lib/libvirt/images/lubuntu2.qcow2' type='file'&gt;
    &lt;target file='$PWD/scratch1.img'/&gt;
    &lt;driver type='raw'/&gt;
    &lt;/disk&gt;
    &lt;disk name='/var/lib/libvirt/images/lubuntu2-1.qcow2' type='file'&gt;
      &lt;target file='$PWD/scratch2.img'/&gt;
      &lt;driver type='raw'/&gt;
    &lt;/disk&gt;
&lt;/domainbackup&gt;

and domain config is-
&lt;domain type="kvm"&gt;
  &lt;name&gt;lubuntu2&lt;/name&gt;
  &lt;uuid&gt;c466086e-4570-4fb5-8cb6-bfe104791381&lt;/uuid&gt;
  &lt;memory unit="KiB"&gt;1048576&lt;/memory&gt;
  &lt;currentMemory unit="KiB"&gt;1048576&lt;/currentMemory&gt;
  &lt;vcpu placement="static"&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch="x86_64" machine="pc-i440fx-focal"&gt;hvm&lt;/type&gt;
    &lt;boot dev="hd"/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
    &lt;apic/&gt;
    &lt;vmport state="off"/&gt;
  &lt;/features&gt;
  &lt;cpu mode="host-model" check="partial"/&gt;
  &lt;clock offset="utc"&gt;
    &lt;timer name="rtc" tickpolicy="catchup"/&gt;
    &lt;timer name="pit" tickpolicy="delay"/&gt;
    &lt;timer name="hpet" present="no"/&gt;
  &lt;/clock&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;destroy&lt;/on_crash&gt;
  &lt;pm&gt;
    &lt;suspend-to-mem enabled="no"/&gt;
    &lt;suspend-to-disk enabled="no"/&gt;
  &lt;/pm&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/bin/qemu-system-x86_64&lt;/emulator&gt;
    &lt;disk type="file" device="disk"&gt;
      &lt;driver name="qemu" type="qcow2"/&gt;
      &lt;source file="/var/lib/libvirt/images/lubuntu2.qcow2"/&gt;
      &lt;target dev="hda" bus="ide"/&gt;
      &lt;address type="drive" controller="0" bus="0" target="0" unit="0"/&gt;
    &lt;/disk&gt;
    &lt;disk type="file" device="cdrom"&gt;
      &lt;driver name="qemu" type="raw"/&gt;
      &lt;target dev="hdb" bus="ide"/&gt;
      &lt;readonly/&gt;
      &lt;address type="drive" controller="0" bus="0" target="0" unit="1"/&gt;
    &lt;/disk&gt;
    &lt;disk type="file" device="disk"&gt;
      &lt;driver name="qemu" type="qcow2"/&gt;
      &lt;source file="/var/lib/libvirt/images/lubuntu2-1.qcow2"/&gt;
      &lt;target dev="hdc" bus="ide"/&gt;
      &lt;address type="drive" controller="0" bus="1" target="0" unit="0"/&gt;
    &lt;/disk&gt;
    &lt;controller type="usb" index="0" model="ich9-ehci1"&gt;
      &lt;address type="pci" domain="0x0000" bus="0x00" slot="0x05"
function="0x7"/&gt;
    &lt;/controller&gt;
    &lt;controller type="usb" index="0" model="ich9-uhci1"&gt;
      &lt;master startport="0"/&gt;
      &lt;address type="pci" domain="0x0000" bus="0x00" slot="0x05"
function="0x0" multifunction="on"/&gt;
    &lt;/controller&gt;
    &lt;controller type="usb" index="0" model="ich9-uhci2"&gt;
      &lt;master startport="2"/&gt;
      &lt;address type="pci" domain="0x0000" bus="0x00" slot="0x05"
function="0x1"/&gt;
    &lt;/controller&gt;
    &lt;controller type="usb" index="0" model="ich9-uhci3"&gt;
      &lt;master startport="4"/&gt;
      &lt;address type="pci" domain="0x0000" bus="0x00" slot="0x05"
function="0x2"/&gt;
    &lt;/controller&gt;
    &lt;controller type="pci" index="0" model="pci-root"/&gt;
    &lt;controller type="ide" index="0"&gt;
      &lt;address type="pci" domain="0x0000" bus="0x00" slot="0x01"
function="0x1"/&gt;
    &lt;/controller&gt;
    &lt;controller type="virtio-serial" index="0"&gt;
      &lt;address type="pci" domain="0x0000" bus="0x00" slot="0x06"
function="0x0"/&gt;
    &lt;/controller&gt;
    &lt;interface type="network"&gt;
      &lt;mac address="52:54:00:90:d7:29"/&gt;
      &lt;source network="default"/&gt;
      &lt;model type="e1000"/&gt;
      &lt;address type="pci" domain="0x0000" bus="0x00" slot="0x03"
function="0x0"/&gt;
    &lt;/interface&gt;
    &lt;serial type="pty"&gt;
      &lt;target type="isa-serial" port="0"&gt;
        &lt;model name="isa-serial"/&gt;
      &lt;/target&gt;
    &lt;/serial&gt;
    &lt;console type="pty"&gt;
      &lt;target type="serial" port="0"/&gt;
    &lt;/console&gt;
    &lt;channel type="spicevmc"&gt;
      &lt;target type="virtio" name="com.redhat.spice.0"/&gt;
      &lt;address type="virtio-serial" controller="0" bus="0" port="1"/&gt;
    &lt;/channel&gt;
    &lt;input type="tablet" bus="usb"&gt;
      &lt;address type="usb" bus="0" port="1"/&gt;
    &lt;/input&gt;
    &lt;input type="mouse" bus="ps2"/&gt;
    &lt;input type="keyboard" bus="ps2"/&gt;
    &lt;graphics type="spice" autoport="yes"&gt;
      &lt;listen type="address"/&gt;
      &lt;image compression="off"/&gt;
    &lt;/graphics&gt;
    &lt;sound model="ich6"&gt;
      &lt;address type="pci" domain="0x0000" bus="0x00" slot="0x04"
function="0x0"/&gt;
    &lt;/sound&gt;
    &lt;video&gt;
      &lt;model type="qxl" ram="65536" vram="65536" vgamem="16384" heads="1"
primary="yes"/&gt;
      &lt;address type="pci" domain="0x0000" bus="0x00" slot="0x02"
function="0x0"/&gt;
    &lt;/video&gt;
    &lt;redirdev bus="usb" type="spicevmc"&gt;
      &lt;address type="usb" bus="0" port="2"/&gt;
    &lt;/redirdev&gt;
    &lt;redirdev bus="usb" type="spicevmc"&gt;
      &lt;address type="usb" bus="0" port="3"/&gt;
    &lt;/redirdev&gt;
    &lt;memballoon model="virtio"&gt;
      &lt;address type="pci" domain="0x0000" bus="0x00" slot="0x07"
function="0x0"/&gt;
    &lt;/memballoon&gt;
  &lt;/devices&gt;
&lt;/domain&gt;


-- 
BRG,
      Andrey

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div&gt;Colleagues, could you please advise what a problem could be in \
XML file in case of:&lt;/div&gt;&lt;div&gt;virsh backup-begin lubuntu2 \
./backup.xml&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;where backup.xml - \
&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;domainbackup&gt;&lt;br&gt;      &lt;disk \
name='/var/lib/libvirt/images/lubuntu2.qcow2' type='file'&gt;&lt;br&gt;     \
&lt;target file='$PWD/scratch1.img'/&gt;&lt;br&gt;      	&lt;driver \
type='raw'/&gt;&lt;br&gt;      &lt;/disk&gt;&lt;br&gt;      &lt;disk \
name='/var/lib/libvirt/images/lubuntu2-1.qcow2' type='file'&gt;&lt;br&gt;   \
&lt;target file='$PWD/scratch2.img'/&gt;&lt;br&gt;         &lt;driver \
type='raw'/&gt;&lt;br&gt;      \
&lt;/disk&gt;&lt;br&gt;&lt;/domainbackup&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;and domain config \
is-&lt;/div&gt;&lt;div&gt;&lt;domain type="kvm"&gt;&lt;br&gt;   \
&lt;name&gt;lubuntu2&lt;/name&gt;&lt;br&gt;   \
&lt;uuid&gt;c466086e-4570-4fb5-8cb6-bfe104791381&lt;/uuid&gt;&lt;br&gt;   &lt;memory \
unit="KiB"&gt;1048576&lt;/memory&gt;&lt;br&gt;   &lt;currentMemory \
unit="KiB"&gt;1048576&lt;/currentMemory&gt;&lt;br&gt;   &lt;vcpu \
placement="static"&gt;1&lt;/vcpu&gt;&lt;br&gt;   &lt;os&gt;&lt;br&gt;      &lt;type \
arch="x86_64" machine="pc-i440fx-focal"&gt;hvm&lt;/type&gt;&lt;br&gt;   \
&lt;boot dev="hd"/&gt;&lt;br&gt;   &lt;/os&gt;&lt;br&gt;   &lt;features&gt;&lt;br&gt;      \
&lt;acpi/&gt;&lt;br&gt;      &lt;apic/&gt;&lt;br&gt;      &lt;vmport \
state="off"/&gt;&lt;br&gt;   &lt;/features&gt;&lt;br&gt;   &lt;cpu \
mode="host-model" check="partial"/&gt;&lt;br&gt;   &lt;clock \
offset="utc"&gt;&lt;br&gt;      &lt;timer name="rtc" \
tickpolicy="catchup"/&gt;&lt;br&gt;      &lt;timer name="pit" \
tickpolicy="delay"/&gt;&lt;br&gt;      &lt;timer name="hpet" \
present="no"/&gt;&lt;br&gt;   &lt;/clock&gt;&lt;br&gt;   \
&lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;&lt;br&gt;   \
&lt;on_reboot&gt;restart&lt;/on_reboot&gt;&lt;br&gt;   \
&lt;on_crash&gt;destroy&lt;/on_crash&gt;&lt;br&gt;   &lt;pm&gt;&lt;br&gt;      &lt;suspend-to-mem \
enabled="no"/&gt;&lt;br&gt;      &lt;suspend-to-disk \
enabled="no"/&gt;&lt;br&gt;   &lt;/pm&gt;&lt;br&gt;   &lt;devices&gt;&lt;br&gt;      \
&lt;emulator&gt;/usr/bin/qemu-system-x86_64&lt;/emulator&gt;&lt;br&gt;      &lt;disk \
type="file" device="disk"&gt;&lt;br&gt;         &lt;driver \
name="qemu" type="qcow2"/&gt;&lt;br&gt;         &lt;source \
file="/var/lib/libvirt/images/lubuntu2.qcow2"/&gt;&lt;br&gt;         &lt;target \
dev="hda" bus="ide"/&gt;&lt;br&gt;         &lt;address \
type="drive" controller="0" bus="0" \
target="0" unit="0"/&gt;&lt;br&gt;      &lt;/disk&gt;&lt;br&gt;      &lt;disk \
type="file" device="cdrom"&gt;&lt;br&gt;         &lt;driver \
name="qemu" type="raw"/&gt;&lt;br&gt;         &lt;target \
dev="hdb" bus="ide"/&gt;&lt;br&gt;         &lt;readonly/&gt;&lt;br&gt;        \
&lt;address type="drive" controller="0" bus="0" \
target="0" unit="1"/&gt;&lt;br&gt;      &lt;/disk&gt;&lt;br&gt;      &lt;disk \
type="file" device="disk"&gt;&lt;br&gt;         &lt;driver \
name="qemu" type="qcow2"/&gt;&lt;br&gt;         &lt;source \
file="/var/lib/libvirt/images/lubuntu2-1.qcow2"/&gt;&lt;br&gt;         &lt;target \
dev="hdc" bus="ide"/&gt;&lt;br&gt;         &lt;address \
type="drive" controller="0" bus="1" \
target="0" unit="0"/&gt;&lt;br&gt;      &lt;/disk&gt;&lt;br&gt;      \
&lt;controller type="usb" index="0" \
model="ich9-ehci1"&gt;&lt;br&gt;         &lt;address type="pci" \
domain="0x0000" bus="0x00" slot="0x05" \
function="0x7"/&gt;&lt;br&gt;      &lt;/controller&gt;&lt;br&gt;      &lt;controller \
type="usb" index="0" model="ich9-uhci1"&gt;&lt;br&gt;         \
&lt;master startport="0"/&gt;&lt;br&gt;         &lt;address type="pci" \
domain="0x0000" bus="0x00" slot="0x05" \
function="0x0" multifunction="on"/&gt;&lt;br&gt;      \
&lt;/controller&gt;&lt;br&gt;      &lt;controller type="usb" index="0" \
model="ich9-uhci2"&gt;&lt;br&gt;         &lt;master \
startport="2"/&gt;&lt;br&gt;         &lt;address type="pci" \
domain="0x0000" bus="0x00" slot="0x05" \
function="0x1"/&gt;&lt;br&gt;      &lt;/controller&gt;&lt;br&gt;      &lt;controller \
type="usb" index="0" model="ich9-uhci3"&gt;&lt;br&gt;         \
&lt;master startport="4"/&gt;&lt;br&gt;         &lt;address type="pci" \
domain="0x0000" bus="0x00" slot="0x05" \
function="0x2"/&gt;&lt;br&gt;      &lt;/controller&gt;&lt;br&gt;      &lt;controller \
type="pci" index="0" model="pci-root"/&gt;&lt;br&gt;      \
&lt;controller type="ide" index="0"&gt;&lt;br&gt;         &lt;address \
type="pci" domain="0x0000" bus="0x00" \
slot="0x01" function="0x1"/&gt;&lt;br&gt;      &lt;/controller&gt;&lt;br&gt;  \
&lt;controller type="virtio-serial" index="0"&gt;&lt;br&gt;         \
&lt;address type="pci" domain="0x0000" bus="0x00" \
slot="0x06" function="0x0"/&gt;&lt;br&gt;      &lt;/controller&gt;&lt;br&gt;  \
&lt;interface type="network"&gt;&lt;br&gt;         &lt;mac \
address="52:54:00:90:d7:29"/&gt;&lt;br&gt;         &lt;source \
network="default"/&gt;&lt;br&gt;         &lt;model \
type="e1000"/&gt;&lt;br&gt;         &lt;address type="pci" \
domain="0x0000" bus="0x00" slot="0x03" \
function="0x0"/&gt;&lt;br&gt;      &lt;/interface&gt;&lt;br&gt;      &lt;serial \
type="pty"&gt;&lt;br&gt;         &lt;target type="isa-serial" \
port="0"&gt;&lt;br&gt;            &lt;model name="isa-serial"/&gt;&lt;br&gt;  \
&lt;/target&gt;&lt;br&gt;      &lt;/serial&gt;&lt;br&gt;      &lt;console \
type="pty"&gt;&lt;br&gt;         &lt;target type="serial" \
port="0"/&gt;&lt;br&gt;      &lt;/console&gt;&lt;br&gt;      &lt;channel \
type="spicevmc"&gt;&lt;br&gt;         &lt;target type="virtio" \
name="com.redhat.spice.0"/&gt;&lt;br&gt;         &lt;address \
type="virtio-serial" controller="0" bus="0" \
port="1"/&gt;&lt;br&gt;      &lt;/channel&gt;&lt;br&gt;      &lt;input \
type="tablet" bus="usb"&gt;&lt;br&gt;         &lt;address \
type="usb" bus="0" port="1"/&gt;&lt;br&gt;      \
&lt;/input&gt;&lt;br&gt;      &lt;input type="mouse" bus="ps2"/&gt;&lt;br&gt; \
&lt;input type="keyboard" bus="ps2"/&gt;&lt;br&gt;      &lt;graphics \
type="spice" autoport="yes"&gt;&lt;br&gt;         &lt;listen \
type="address"/&gt;&lt;br&gt;         &lt;image \
compression="off"/&gt;&lt;br&gt;      &lt;/graphics&gt;&lt;br&gt;      &lt;sound \
model="ich6"&gt;&lt;br&gt;         &lt;address type="pci" \
domain="0x0000" bus="0x00" slot="0x04" \
function="0x0"/&gt;&lt;br&gt;      &lt;/sound&gt;&lt;br&gt;      &lt;video&gt;&lt;br&gt;      \
&lt;model type="qxl" ram="65536" vram="65536" \
vgamem="16384" heads="1" primary="yes"/&gt;&lt;br&gt;         \
&lt;address type="pci" domain="0x0000" bus="0x00" \
slot="0x02" function="0x0"/&gt;&lt;br&gt;      &lt;/video&gt;&lt;br&gt;      \
&lt;redirdev bus="usb" type="spicevmc"&gt;&lt;br&gt;         \
&lt;address type="usb" bus="0" port="2"/&gt;&lt;br&gt;      \
&lt;/redirdev&gt;&lt;br&gt;      &lt;redirdev bus="usb" \
type="spicevmc"&gt;&lt;br&gt;         &lt;address type="usb" \
bus="0" port="3"/&gt;&lt;br&gt;      &lt;/redirdev&gt;&lt;br&gt;      \
&lt;memballoon model="virtio"&gt;&lt;br&gt;         &lt;address \
type="pci" domain="0x0000" bus="0x00" \
slot="0x07" function="0x0"/&gt;&lt;br&gt;      &lt;/memballoon&gt;&lt;br&gt;  \
&lt;/devices&gt;&lt;br&gt;&lt;/domain&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;-- &lt;br&gt;&lt;div \
dir="ltr" class="gmail_signature" data-smartmail="gmail_signature"&gt;BRG,&lt;br&gt;          \
Andrey&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210120180759</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-01-20 18:07:59-0400</timestampReceived><subject>Re: virsh backup-begin problem</subject><body>

On Wed, Jan 20, 2021 at 20:49:49 +0300, Andrey Fokin wrote:
&gt; Colleagues, could you please advise what a problem could be in XML file in
&gt; case of:
&gt; virsh backup-begin lubuntu2 ./backup.xml
&gt; 
&gt; where backup.xml -
&gt; &lt;domainbackup&gt;
&gt;     &lt;disk name='/var/lib/libvirt/images/lubuntu2.qcow2' type='file'&gt;
&gt;     &lt;target file='$PWD/scratch1.img'/&gt;
&gt;     &lt;driver type='raw'/&gt;
&gt;     &lt;/disk&gt;
&gt;     &lt;disk name='/var/lib/libvirt/images/lubuntu2-1.qcow2' type='file'&gt;
&gt;       &lt;target file='$PWD/scratch2.img'/&gt;
&gt;       &lt;driver type='raw'/&gt;
&gt;     &lt;/disk&gt;
&gt; &lt;/domainbackup&gt;

snip ...

You forgot to add what you are observing, but I presume:

'operation unsupported: incremental backup is not supported yet'

Unfortunately it's what it says on the tin. The implementation of the
incremental backup code is not finished yet, thus the feature is
disabled.

If you want to test-drive incremental backup APIs, you can enable the
experimental feature by using the XML documented in:

https://libvirt.org/drvqemu.html#xmlnsfeatures

to enable a feature named 'incremental-backup'. Please make sure to read
the caveats of doing so thoroughly.

I also advise not to combine incremental backups with snapshots
(virDomainSnapshot* APIs) and blockjobs (virDomainBlock* APIs) as that
will not work properly without a patch enabling also experimental qemu
features.

I also suggest you use the latest qemu for this.

</body></email><email><emailId>20210121124221</emailId><senderName>Andrey Fokin</senderName><senderEmail>lazzyfox@gmail.com</senderEmail><timestampReceived>2021-01-21 12:42:21-0400</timestampReceived><subject>Fwd: virsh backup-begin problem</subject><body>

Ok. Sorry.

On Thu, Jan 21, 2021 at 3:38 PM Peter Krempa &lt;pkrempa@redhat.com&gt; wrote:

&gt; On Thu, Jan 21, 2021 at 15:16:44 +0300, Andrey Fokin wrote:
&gt; &gt; Yes, there is an error message.
&gt; &gt; sudo virsh backup-begin lubuntu2 ./backup.xml
&gt; &gt; error: XML document failed to validate against schema: Unable to validate
&gt; &gt; doc against /usr/share/libvirt/schemas/domainbackup.rng
&gt; &gt; Element domainbackup has extra content: disk
&gt;
&gt; As I've noted in the exact mail you are replying to, I will not offer
&gt; any further assistance unless you post the question also on
&gt; libvirt-users@redhat.com list as you did with your original question.
&gt; This is to archive any discussions for future reference.
&gt;
&gt; &gt; On Thu, Jan 21, 2021 at 2:40 PM Peter Krempa &lt;pkrempa@redhat.com&gt; wrote:
&gt; &gt;
&gt; &gt; &gt; On Thu, Jan 21, 2021 at 12:34:43 +0100, Peter Krempa wrote:
&gt; &gt; &gt; &gt; On Thu, Jan 21, 2021 at 14:31:18 +0300, Andrey Fokin wrote:
&gt; &gt; &gt; &gt; &gt; Peter, thanks. I understood you message about additional
&gt; configuration
&gt; &gt; &gt; in
&gt; &gt; &gt; &gt; &gt; domen settings. It's really interesting, and I'll going to test it
&gt; as
&gt; &gt; &gt; well.
&gt; &gt; &gt; &gt; &gt; But could you please advise how change backup-begin command XML
&gt; &gt; &gt; parameters
&gt; &gt; &gt; &gt; &gt; file to start full backup process? What is wrong in my case and
&gt; how to
&gt; &gt; &gt; fix
&gt; &gt; &gt; &gt; &gt; it? My config below.
&gt; &gt; &gt; &gt; &gt; Thanks a lot!
&gt; &gt; &gt; &gt; &gt; &lt;domainbackup&gt;
&gt; &gt; &gt; &gt; &gt;     &lt;disk name='/var/lib/libvirt/images/lubuntu2.qcow2'
&gt; type='file'&gt;
&gt; &gt; &gt; &gt; &gt;     &lt;target file='$PWD/scratch1.img'/&gt;
&gt; &gt; &gt; &gt; &gt;     &lt;driver type='raw'/&gt;
&gt; &gt; &gt; &gt; &gt;     &lt;/disk&gt;
&gt; &gt; &gt; &gt; &gt;     &lt;disk name='/var/lib/libvirt/images/lubuntu2-1.qcow2'
&gt; type='file'&gt;
&gt; &gt; &gt; &gt; &gt;       &lt;target file='$PWD/scratch2.img'/&gt;
&gt; &gt; &gt; &gt; &gt;       &lt;driver type='raw'/&gt;
&gt; &gt; &gt; &gt; &gt;     &lt;/disk&gt;
&gt; &gt; &gt; &gt; &gt; &lt;/domainbackup&gt;
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; Could you please describe what the problem is? You are getting an
&gt; error?
&gt; &gt; &gt; &gt; If so why didn't you paste it?
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; I'm not going to setup a backup just to try your configuration.
&gt; Please
&gt; &gt; &gt; &gt; provide all information you have and describe the problem as best as
&gt; &gt; &gt; &gt; possible.
&gt;
&gt; Here:
&gt;
&gt; &gt; &gt;
&gt; &gt; &gt; Oh, and don't drop libvirt-users from the CC-list! That way my advice
&gt; &gt; &gt; would not be recorded in the mailing list archives and browsable by
&gt; &gt; &gt; others with a possibly same problem.
&gt; &gt; &gt;
&gt; &gt; &gt; Please Re-post your query to the list AND include any information you
&gt; &gt; &gt; have to get a reply from me.
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt;
&gt; &gt; --
&gt; &gt; BRG,
&gt; &gt;       Andrey
&gt;
&gt;

-- 
BRG,
      Andrey

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Ok. Sorry.&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" \
class="gmail_attr"&gt;On Thu, Jan 21, 2021 at 3:38 PM Peter Krempa &lt;&lt;a \
href="mailto:pkrempa@redhat.com" target="_blank"&gt;pkrempa@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;On Thu, Jan 21, 2021 \
at 15:16:44 +0300, Andrey Fokin wrote:&lt;br&gt; &gt; Yes, there is an error message.&lt;br&gt;
&gt; sudo virsh backup-begin lubuntu2 ./backup.xml&lt;br&gt;
&gt; error: XML document failed to validate against schema: Unable to validate&lt;br&gt;
&gt; doc against /usr/share/libvirt/schemas/domainbackup.rng&lt;br&gt;
&gt; Element domainbackup has extra content: disk&lt;br&gt;
&lt;br&gt;
As I've noted in the exact mail you are replying to, I will not offer&lt;br&gt;
any further assistance unless you post the question also on&lt;br&gt;
&lt;a href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt; list as you did with your original \
question.&lt;br&gt; This is to archive any discussions for future reference.&lt;br&gt;
&lt;br&gt;
&gt; On Thu, Jan 21, 2021 at 2:40 PM Peter Krempa &lt;&lt;a \
href="mailto:pkrempa@redhat.com" target="_blank"&gt;pkrempa@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt; &gt; &lt;br&gt;
&gt; &gt; On Thu, Jan 21, 2021 at 12:34:43 +0100, Peter Krempa wrote:&lt;br&gt;
&gt; &gt; &gt; On Thu, Jan 21, 2021 at 14:31:18 +0300, Andrey Fokin wrote:&lt;br&gt;
&gt; &gt; &gt; &gt; Peter, thanks. I understood you message about additional \
configuration&lt;br&gt; &gt; &gt; in&lt;br&gt;
&gt; &gt; &gt; &gt; domen settings. It's really interesting, and I'll going \
to test it as&lt;br&gt; &gt; &gt; well.&lt;br&gt;
&gt; &gt; &gt; &gt; But could you please advise how change backup-begin command \
XML&lt;br&gt; &gt; &gt; parameters&lt;br&gt;
&gt; &gt; &gt; &gt; file to start full backup process? What is wrong in my case and \
how to&lt;br&gt; &gt; &gt; fix&lt;br&gt;
&gt; &gt; &gt; &gt; it? My config below.&lt;br&gt;
&gt; &gt; &gt; &gt; Thanks a lot!&lt;br&gt;
&gt; &gt; &gt; &gt; &lt;domainbackup&gt;&lt;br&gt;
&gt; &gt; &gt; &gt;        &lt;disk \
name='/var/lib/libvirt/images/lubuntu2.qcow2' type='file'&gt;&lt;br&gt; \
&gt; &gt; &gt; &gt;        &lt;target file='$PWD/scratch1.img'/&gt;&lt;br&gt; &gt; \
&gt; &gt; &gt;        &lt;driver type='raw'/&gt;&lt;br&gt; &gt; &gt; &gt; &gt;      \
&lt;/disk&gt;&lt;br&gt; &gt; &gt; &gt; &gt;        &lt;disk \
name='/var/lib/libvirt/images/lubuntu2-1.qcow2' type='file'&gt;&lt;br&gt; \
&gt; &gt; &gt; &gt;           &lt;target file='$PWD/scratch2.img'/&gt;&lt;br&gt; \
&gt; &gt; &gt; &gt;           &lt;driver type='raw'/&gt;&lt;br&gt; &gt; &gt; &gt; \
&gt;        &lt;/disk&gt;&lt;br&gt; &gt; &gt; &gt; &gt; &lt;/domainbackup&gt;&lt;br&gt;
&gt; &gt; &gt;&lt;br&gt;
&gt; &gt; &gt; Could you please describe what the problem is? You are getting an \
error?&lt;br&gt; &gt; &gt; &gt; If so why didn't you paste it?&lt;br&gt;
&gt; &gt; &gt;&lt;br&gt;
&gt; &gt; &gt; I'm not going to setup a backup just to try your configuration. \
Please&lt;br&gt; &gt; &gt; &gt; provide all information you have and describe the problem \
as best as&lt;br&gt; &gt; &gt; &gt; possible.&lt;br&gt;
&lt;br&gt;
Here:&lt;br&gt;
&lt;br&gt;
&gt; &gt;&lt;br&gt;
&gt; &gt; Oh, and don't drop libvirt-users from the CC-list! That way my \
advice&lt;br&gt; &gt; &gt; would not be recorded in the mailing list archives and browsable \
by&lt;br&gt; &gt; &gt; others with a possibly same problem.&lt;br&gt;
&gt; &gt;&lt;br&gt;
&gt; &gt; Please Re-post your query to the list AND include any information you&lt;br&gt;
&gt; &gt; have to get a reply from me.&lt;br&gt;
&gt; &gt;&lt;br&gt;
&gt; &gt;&lt;br&gt;
&gt; &lt;br&gt;
&gt; -- &lt;br&gt;
&gt; BRG,&lt;br&gt;
&gt;           Andrey&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;&lt;div dir="ltr"&gt;BRG,&lt;br&gt;          \
Andrey&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20210121164508</emailId><senderName>vrms</senderName><senderEmail>vrms@netcologne.de</senderEmail><timestampReceived>2021-01-21 16:45:08-0400</timestampReceived><subject>learning materials kvm/qemu/libvirt</subject><body>

I am doing a 2 year retraining at the moment to become a system admin.

There are 2 weeks of HyperV on the schedule (sadly the only
virtualization that will be taught in that course) in august and plan to
sneak out of class during that time to to something useful and get a
grip on the kvm/qemu/libvirt side of the VM cake (class is completely
online, so the sneaking out is doable).

Can anybody recommend good online learning resources for someone with
yet quite foggy basic understanding of things?

thanks and best
Gunnar


</body></email><email><emailId>20210121182313</emailId><senderName>Thing</senderName><senderEmail>thing.thing@gmail.com</senderEmail><timestampReceived>2021-01-21 18:23:13-0400</timestampReceived><subject>Re: learning materials kvm/qemu/libvirt</subject><body>

Do both....

On Fri, 22 Jan 2021 at 05:45, vrms &lt;vrms@netcologne.de&gt; wrote:

&gt; I am doing a 2 year retraining at the moment to become a system admin.
&gt;
&gt; There are 2 weeks of HyperV on the schedule (sadly the only
&gt; virtualization that will be taught in that course) in august and plan to
&gt; sneak out of class during that time to to something useful and get a
&gt; grip on the kvm/qemu/libvirt side of the VM cake (class is completely
&gt; online, so the sneaking out is doable).
&gt;
&gt; Can anybody recommend good online learning resources for someone with
&gt; yet quite foggy basic understanding of things?
&gt;
&gt; thanks and best
&gt; Gunnar
&gt;
&gt;
&gt;

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Do both....&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" \
class="gmail_attr"&gt;On Fri, 22 Jan 2021 at 05:45, vrms &lt;&lt;a \
href="mailto:vrms@netcologne.de"&gt;vrms@netcologne.de&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;I am doing a 2 year \
retraining at the moment to become a system admin.&lt;br&gt; &lt;br&gt;
There are 2 weeks of HyperV on the schedule (sadly the only&lt;br&gt;
virtualization that will be taught in that course) in august and plan to&lt;br&gt;
sneak out of class during that time to to something useful and get a&lt;br&gt;
grip on the kvm/qemu/libvirt side of the VM cake (class is completely&lt;br&gt;
online, so the sneaking out is doable).&lt;br&gt;
&lt;br&gt;
Can anybody recommend good online learning resources for someone with&lt;br&gt;
yet quite foggy basic understanding of things?&lt;br&gt;
&lt;br&gt;
thanks and best&lt;br&gt;
Gunnar&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;



</body></email><email><emailId>20210121133312</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-01-21 13:33:12-0400</timestampReceived><subject>Re: Fwd: virsh backup-begin problem</subject><body>

On Thu, Jan 21, 2021 at 15:42:21 +0300, Andrey Fokin wrote:
&gt; Ok. Sorry.
&gt; 
&gt; On Thu, Jan 21, 2021 at 3:38 PM Peter Krempa &lt;pkrempa@redhat.com&gt; wrote:
&gt; 
&gt; &gt; On Thu, Jan 21, 2021 at 15:16:44 +0300, Andrey Fokin wrote:
&gt; &gt; &gt; Yes, there is an error message.
&gt; &gt; &gt; sudo virsh backup-begin lubuntu2 ./backup.xml
&gt; &gt; &gt; error: XML document failed to validate against schema: Unable to validate
&gt; &gt; &gt; doc against /usr/share/libvirt/schemas/domainbackup.rng
&gt; &gt; &gt; Element domainbackup has extra content: disk
&gt; &gt;
&gt; &gt; As I've noted in the exact mail you are replying to, I will not offer
&gt; &gt; any further assistance unless you post the question also on
&gt; &gt; libvirt-users@redhat.com list as you did with your original question.
&gt; &gt; This is to archive any discussions for future reference.
&gt; &gt;
&gt; &gt; &gt; On Thu, Jan 21, 2021 at 2:40 PM Peter Krempa &lt;pkrempa@redhat.com&gt; wrote:
&gt; &gt; &gt;
&gt; &gt; &gt; &gt; On Thu, Jan 21, 2021 at 12:34:43 +0100, Peter Krempa wrote:
&gt; &gt; &gt; &gt; &gt; On Thu, Jan 21, 2021 at 14:31:18 +0300, Andrey Fokin wrote:
&gt; &gt; &gt; &gt; &gt; &gt; Peter, thanks. I understood you message about additional
&gt; &gt; configuration
&gt; &gt; &gt; &gt; in
&gt; &gt; &gt; &gt; &gt; &gt; domen settings. It's really interesting, and I'll going to test it
&gt; &gt; as
&gt; &gt; &gt; &gt; well.
&gt; &gt; &gt; &gt; &gt; &gt; But could you please advise how change backup-begin command XML
&gt; &gt; &gt; &gt; parameters
&gt; &gt; &gt; &gt; &gt; &gt; file to start full backup process? What is wrong in my case and
&gt; &gt; how to
&gt; &gt; &gt; &gt; fix
&gt; &gt; &gt; &gt; &gt; &gt; it? My config below.
&gt; &gt; &gt; &gt; &gt; &gt; Thanks a lot!

Let me rescue the XML as you've posted it.

&lt;domainbackup&gt;
    &lt;disk name='/var/lib/libvirt/images/lubuntu2.qcow2' type='file'&gt;
    &lt;target file='$PWD/scratch1.img'/&gt;
    &lt;driver type='raw'/&gt;
    &lt;/disk&gt;
    &lt;disk name='/var/lib/libvirt/images/lubuntu2-1.qcow2' type='file'&gt;
      &lt;target file='$PWD/scratch2.img'/&gt;
      &lt;driver type='raw'/&gt;
    &lt;/disk&gt;
&lt;/domainbackup&gt;


So there are multiple issues here.

Firstly please refer to the XML documentation, because the mistakes you
have in your are actually documented properly:

https://libvirt.org/formatbackup.html

Problems:

1) Missing &lt;disks&gt; container around the individual &lt;disk&gt; elements
2) &lt;disk name=' attribute must contain the disk target (such as 'vda',
   'vdb' refering to the disk in the domain definition, paths are not
   allowed. This fact is mentioned in the docs.
3) If the &lt;target file=' paths are not examples, but you really have
   $PWD in there, note that neither virsh nor libvirt will replace it
   with the working directory. The XML is used as-is. This then violates
   the rule that paths must start with a /.

So the proper XML then is. Obviously you need to make sure that it's
what you actually meant ...

&lt;domainbackup&gt;
  &lt;disks&gt;
    &lt;disk name='hda' type='file'&gt;
      &lt;target file='/path/scratch1.img'/&gt;
      &lt;driver type='raw'/&gt;
    &lt;/disk&gt;
    &lt;disk name='hdc' type='file'&gt;
      &lt;target file='/path/scratch2.img'/&gt;
      &lt;driver type='raw'/&gt;
    &lt;/disk&gt;
  &lt;/disks&gt;
&lt;/domainbackup&gt;


e.g. the output files will be raw and not qcow2.

</body></email><email><emailId>20210121143425</emailId><senderName>Andrey Fokin</senderName><senderEmail>lazzyfox@gmail.com</senderEmail><timestampReceived>2021-01-21 14:34:25-0400</timestampReceived><subject>Re: Fwd: virsh backup-begin problem</subject><body>

Peters, thanks! It was a lot of XML errors. You are right about. But it
doesn't work... I've an error about backup type-
Operation not supported: incremental backup is not supported yet
How is possible describe full backup operation?

On Thu, Jan 21, 2021 at 4:33 PM Peter Krempa &lt;pkrempa@redhat.com&gt; wrote:

&gt; On Thu, Jan 21, 2021 at 15:42:21 +0300, Andrey Fokin wrote:
&gt; &gt; Ok. Sorry.
&gt; &gt;
&gt; &gt; On Thu, Jan 21, 2021 at 3:38 PM Peter Krempa &lt;pkrempa@redhat.com&gt; wrote:
&gt; &gt;
&gt; &gt; &gt; On Thu, Jan 21, 2021 at 15:16:44 +0300, Andrey Fokin wrote:
&gt; &gt; &gt; &gt; Yes, there is an error message.
&gt; &gt; &gt; &gt; sudo virsh backup-begin lubuntu2 ./backup.xml
&gt; &gt; &gt; &gt; error: XML document failed to validate against schema: Unable to
&gt; validate
&gt; &gt; &gt; &gt; doc against /usr/share/libvirt/schemas/domainbackup.rng
&gt; &gt; &gt; &gt; Element domainbackup has extra content: disk
&gt; &gt; &gt;
&gt; &gt; &gt; As I've noted in the exact mail you are replying to, I will not offer
&gt; &gt; &gt; any further assistance unless you post the question also on
&gt; &gt; &gt; libvirt-users@redhat.com list as you did with your original question.
&gt; &gt; &gt; This is to archive any discussions for future reference.
&gt; &gt; &gt;
&gt; &gt; &gt; &gt; On Thu, Jan 21, 2021 at 2:40 PM Peter Krempa &lt;pkrempa@redhat.com&gt;
&gt; wrote:
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; On Thu, Jan 21, 2021 at 12:34:43 +0100, Peter Krempa wrote:
&gt; &gt; &gt; &gt; &gt; &gt; On Thu, Jan 21, 2021 at 14:31:18 +0300, Andrey Fokin wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Peter, thanks. I understood you message about additional
&gt; &gt; &gt; configuration
&gt; &gt; &gt; &gt; &gt; in
&gt; &gt; &gt; &gt; &gt; &gt; &gt; domen settings. It's really interesting, and I'll going to
&gt; test it
&gt; &gt; &gt; as
&gt; &gt; &gt; &gt; &gt; well.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; But could you please advise how change backup-begin command XML
&gt; &gt; &gt; &gt; &gt; parameters
&gt; &gt; &gt; &gt; &gt; &gt; &gt; file to start full backup process? What is wrong in my case and
&gt; &gt; &gt; how to
&gt; &gt; &gt; &gt; &gt; fix
&gt; &gt; &gt; &gt; &gt; &gt; &gt; it? My config below.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Thanks a lot!
&gt;
&gt; Let me rescue the XML as you've posted it.
&gt;
&gt; &lt;domainbackup&gt;
&gt;     &lt;disk name='/var/lib/libvirt/images/lubuntu2.qcow2' type='file'&gt;
&gt;     &lt;target file='$PWD/scratch1.img'/&gt;
&gt;     &lt;driver type='raw'/&gt;
&gt;     &lt;/disk&gt;
&gt;     &lt;disk name='/var/lib/libvirt/images/lubuntu2-1.qcow2' type='file'&gt;
&gt;       &lt;target file='$PWD/scratch2.img'/&gt;
&gt;       &lt;driver type='raw'/&gt;
&gt;     &lt;/disk&gt;
&gt; &lt;/domainbackup&gt;
&gt;
&gt;
&gt; So there are multiple issues here.
&gt;
&gt; Firstly please refer to the XML documentation, because the mistakes you
&gt; have in your are actually documented properly:
&gt;
&gt; https://libvirt.org/formatbackup.html
&gt;
&gt; Problems:
&gt;
&gt; 1) Missing &lt;disks&gt; container around the individual &lt;disk&gt; elements
&gt; 2) &lt;disk name=' attribute must contain the disk target (such as 'vda',
&gt;    'vdb' refering to the disk in the domain definition, paths are not
&gt;    allowed. This fact is mentioned in the docs.
&gt; 3) If the &lt;target file=' paths are not examples, but you really have
&gt;    $PWD in there, note that neither virsh nor libvirt will replace it
&gt;    with the working directory. The XML is used as-is. This then violates
&gt;    the rule that paths must start with a /.
&gt;
&gt; So the proper XML then is. Obviously you need to make sure that it's
&gt; what you actually meant ...
&gt;
&gt; &lt;domainbackup&gt;
&gt;   &lt;disks&gt;
&gt;     &lt;disk name='hda' type='file'&gt;
&gt;       &lt;target file='/path/scratch1.img'/&gt;
&gt;       &lt;driver type='raw'/&gt;
&gt;     &lt;/disk&gt;
&gt;     &lt;disk name='hdc' type='file'&gt;
&gt;       &lt;target file='/path/scratch2.img'/&gt;
&gt;       &lt;driver type='raw'/&gt;
&gt;     &lt;/disk&gt;
&gt;   &lt;/disks&gt;
&gt; &lt;/domainbackup&gt;
&gt;
&gt;
&gt; e.g. the output files will be raw and not qcow2.
&gt;
&gt;

-- 
BRG,
      Andrey

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div&gt;Peters, thanks! It was a lot of XML errors. You are right about. \
But it doesn't work... I've an error about backup \
type-&lt;br&gt;&lt;/div&gt;&lt;div&gt;Operation not supported: incremental backup is not supported \
yet&lt;/div&gt;&lt;div&gt;How is possible describe full backup operation?&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Thu, Jan 21, 2021 at 4:33 PM \
Peter Krempa &lt;&lt;a href="mailto:pkrempa@redhat.com"&gt;pkrempa@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;On Thu, Jan 21, 2021 \
at 15:42:21 +0300, Andrey Fokin wrote:&lt;br&gt; &gt; Ok. Sorry.&lt;br&gt;
&gt; &lt;br&gt;
&gt; On Thu, Jan 21, 2021 at 3:38 PM Peter Krempa &lt;&lt;a \
href="mailto:pkrempa@redhat.com" target="_blank"&gt;pkrempa@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt; &gt; &lt;br&gt;
&gt; &gt; On Thu, Jan 21, 2021 at 15:16:44 +0300, Andrey Fokin wrote:&lt;br&gt;
&gt; &gt; &gt; Yes, there is an error message.&lt;br&gt;
&gt; &gt; &gt; sudo virsh backup-begin lubuntu2 ./backup.xml&lt;br&gt;
&gt; &gt; &gt; error: XML document failed to validate against schema: Unable to \
validate&lt;br&gt; &gt; &gt; &gt; doc against \
/usr/share/libvirt/schemas/domainbackup.rng&lt;br&gt; &gt; &gt; &gt; Element domainbackup \
has extra content: disk&lt;br&gt; &gt; &gt;&lt;br&gt;
&gt; &gt; As I've noted in the exact mail you are replying to, I will not \
offer&lt;br&gt; &gt; &gt; any further assistance unless you post the question also on&lt;br&gt;
&gt; &gt; &lt;a href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt; list as you did with your original \
question.&lt;br&gt; &gt; &gt; This is to archive any discussions for future reference.&lt;br&gt;
&gt; &gt;&lt;br&gt;
&gt; &gt; &gt; On Thu, Jan 21, 2021 at 2:40 PM Peter Krempa &lt;&lt;a \
href="mailto:pkrempa@redhat.com" target="_blank"&gt;pkrempa@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt; &gt; &gt; &gt;&lt;br&gt;
&gt; &gt; &gt; &gt; On Thu, Jan 21, 2021 at 12:34:43 +0100, Peter Krempa wrote:&lt;br&gt;
&gt; &gt; &gt; &gt; &gt; On Thu, Jan 21, 2021 at 14:31:18 +0300, Andrey Fokin \
wrote:&lt;br&gt; &gt; &gt; &gt; &gt; &gt; &gt; Peter, thanks. I understood you message \
about additional&lt;br&gt; &gt; &gt; configuration&lt;br&gt;
&gt; &gt; &gt; &gt; in&lt;br&gt;
&gt; &gt; &gt; &gt; &gt; &gt; domen settings. It's really interesting, and \
I'll going to test it&lt;br&gt; &gt; &gt; as&lt;br&gt;
&gt; &gt; &gt; &gt; well.&lt;br&gt;
&gt; &gt; &gt; &gt; &gt; &gt; But could you please advise how change backup-begin \
command XML&lt;br&gt; &gt; &gt; &gt; &gt; parameters&lt;br&gt;
&gt; &gt; &gt; &gt; &gt; &gt; file to start full backup process? What is wrong in my \
case and&lt;br&gt; &gt; &gt; how to&lt;br&gt;
&gt; &gt; &gt; &gt; fix&lt;br&gt;
&gt; &gt; &gt; &gt; &gt; &gt; it? My config below.&lt;br&gt;
&gt; &gt; &gt; &gt; &gt; &gt; Thanks a lot!&lt;br&gt;
&lt;br&gt;
Let me rescue the XML as you've posted it.&lt;br&gt;
&lt;br&gt;
&lt;domainbackup&gt;&lt;br&gt;
      &lt;disk name='/var/lib/libvirt/images/lubuntu2.qcow2' \
type='file'&gt;&lt;br&gt;  &lt;target file='$PWD/scratch1.img'/&gt;&lt;br&gt;
      &lt;driver type='raw'/&gt;&lt;br&gt;
      &lt;/disk&gt;&lt;br&gt;
      &lt;disk name='/var/lib/libvirt/images/lubuntu2-1.qcow2' \
type='file'&gt;&lt;br&gt;  &lt;target file='$PWD/scratch2.img'/&gt;&lt;br&gt;
         &lt;driver type='raw'/&gt;&lt;br&gt;
      &lt;/disk&gt;&lt;br&gt;
&lt;/domainbackup&gt;&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
So there are multiple issues here.&lt;br&gt;
&lt;br&gt;
Firstly please refer to the XML documentation, because the mistakes you&lt;br&gt;
have in your are actually documented properly:&lt;br&gt;
&lt;br&gt;
&lt;a href="https://libvirt.org/formatbackup.html" rel="noreferrer" \
target="_blank"&gt;https://libvirt.org/formatbackup.html&lt;/a&gt;&lt;br&gt; &lt;br&gt;
Problems:&lt;br&gt;
&lt;br&gt;
1) Missing &lt;disks&gt; container around the individual &lt;disk&gt; elements&lt;br&gt;
2) &lt;disk name=' attribute must contain the disk target (such as \
                'vda',&lt;br&gt;
     'vdb' refering to the disk in the domain definition, paths are not&lt;br&gt;
     allowed. This fact is mentioned in the docs.&lt;br&gt;
3) If the &lt;target file=' paths are not examples, but you really have&lt;br&gt;
     $PWD in there, note that neither virsh nor libvirt will replace it&lt;br&gt;
     with the working directory. The XML is used as-is. This then violates&lt;br&gt;
     the rule that paths must start with a /.&lt;br&gt;
&lt;br&gt;
So the proper XML then is. Obviously you need to make sure that it's&lt;br&gt;
what you actually meant ...&lt;br&gt;
&lt;br&gt;
&lt;domainbackup&gt;&lt;br&gt;
   &lt;disks&gt;&lt;br&gt;
      &lt;disk name='hda' type='file'&gt;&lt;br&gt;
         &lt;target file='/path/scratch1.img'/&gt;&lt;br&gt;
         &lt;driver type='raw'/&gt;&lt;br&gt;
      &lt;/disk&gt;&lt;br&gt;
      &lt;disk name='hdc' type='file'&gt;&lt;br&gt;
         &lt;target file='/path/scratch2.img'/&gt;&lt;br&gt;
         &lt;driver type='raw'/&gt;&lt;br&gt;
      &lt;/disk&gt;&lt;br&gt;
   &lt;/disks&gt;&lt;br&gt;
&lt;/domainbackup&gt;&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
e.g. the output files will be raw and not qcow2.&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;&lt;div dir="ltr" \
class="gmail_signature"&gt;BRG,&lt;br&gt;          Andrey&lt;/div&gt;



</body></email><email><emailId>20210121150405</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-01-21 15:04:05-0400</timestampReceived><subject>Re: Fwd: virsh backup-begin problem</subject><body>

On Thu, Jan 21, 2021 at 17:34:25 +0300, Andrey Fokin wrote:
&gt; Peters, thanks! It was a lot of XML errors. You are right about. But it
&gt; doesn't work... I've an error about backup type-
&gt; Operation not supported: incremental backup is not supported yet
&gt; How is possible describe full backup operation?

Did you apply the VM XML workaround that I've pointed out twice already:

https://www.redhat.com/archives/libvirt-users/2021-January/msg00034.html

And if yes, did you restart your VM after adding the XML to enable the
feature?

</body></email><email><emailId>20210121151254</emailId><senderName>Andrey Fokin</senderName><senderEmail>lazzyfox@gmail.com</senderEmail><timestampReceived>2021-01-21 15:12:54-0400</timestampReceived><subject>Re: Fwd: virsh backup-begin problem</subject><body>

Do you mean "experimental" feature to enable incremental backup? No, didn't
because I try to implement full buckup (not an incremental one). Or am I
missing something and it is the same?

On Thu, Jan 21, 2021 at 6:04 PM Peter Krempa &lt;pkrempa@redhat.com&gt; wrote:

&gt; On Thu, Jan 21, 2021 at 17:34:25 +0300, Andrey Fokin wrote:
&gt; &gt; Peters, thanks! It was a lot of XML errors. You are right about. But it
&gt; &gt; doesn't work... I've an error about backup type-
&gt; &gt; Operation not supported: incremental backup is not supported yet
&gt; &gt; How is possible describe full backup operation?
&gt;
&gt; Did you apply the VM XML workaround that I've pointed out twice already:
&gt;
&gt; https://www.redhat.com/archives/libvirt-users/2021-January/msg00034.html
&gt;
&gt; And if yes, did you restart your VM after adding the XML to enable the
&gt; feature?
&gt;
&gt;

-- 
BRG,
      Andrey

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Do you mean "experimental" feature to enable incremental \
backup? No, didn't because I try to implement full buckup (not an incremental \
one). Or am I missing something and it is the same?&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Thu, Jan 21, 2021 at 6:04 PM \
Peter Krempa &lt;&lt;a href="mailto:pkrempa@redhat.com"&gt;pkrempa@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;On Thu, Jan 21, 2021 \
at 17:34:25 +0300, Andrey Fokin wrote:&lt;br&gt; &gt; Peters, thanks! It was a lot of XML \
errors. You are right about. But it&lt;br&gt; &gt; doesn't work... I've an error \
about backup type-&lt;br&gt; &gt; Operation not supported: incremental backup is not \
supported yet&lt;br&gt; &gt; How is possible describe full backup operation?&lt;br&gt;
&lt;br&gt;
Did you apply the VM XML workaround that I've pointed out twice already:&lt;br&gt;
&lt;br&gt;
&lt;a href="https://www.redhat.com/archives/libvirt-users/2021-January/msg00034.html" \
rel="noreferrer" target="_blank"&gt;https://www.redhat.com/archives/libvirt-users/2021-January/msg00034.html&lt;/a&gt;&lt;br&gt;
 &lt;br&gt;
And if yes, did you restart your VM after adding the XML to enable the&lt;br&gt;
feature?&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;&lt;div dir="ltr" \
class="gmail_signature"&gt;BRG,&lt;br&gt;          Andrey&lt;/div&gt;



</body></email><email><emailId>20210121103103</emailId><senderName>Andrey Fokin</senderName><senderEmail>lazzyfox@gmail.com</senderEmail><timestampReceived>2021-01-21 10:31:03-0400</timestampReceived><subject>Re: virsh backup-begin problem</subject><body>

Thanks Peter!
But is possible change XML configuration towards will be possible to do
full (push) backup?

On Wed, Jan 20, 2021 at 9:08 PM Peter Krempa &lt;pkrempa@redhat.com&gt; wrote:

&gt; On Wed, Jan 20, 2021 at 20:49:49 +0300, Andrey Fokin wrote:
&gt; &gt; Colleagues, could you please advise what a problem could be in XML file
&gt; in
&gt; &gt; case of:
&gt; &gt; virsh backup-begin lubuntu2 ./backup.xml
&gt; &gt;
&gt; &gt; where backup.xml -
&gt; &gt; &lt;domainbackup&gt;
&gt; &gt;     &lt;disk name='/var/lib/libvirt/images/lubuntu2.qcow2' type='file'&gt;
&gt; &gt;     &lt;target file='$PWD/scratch1.img'/&gt;
&gt; &gt;     &lt;driver type='raw'/&gt;
&gt; &gt;     &lt;/disk&gt;
&gt; &gt;     &lt;disk name='/var/lib/libvirt/images/lubuntu2-1.qcow2' type='file'&gt;
&gt; &gt;       &lt;target file='$PWD/scratch2.img'/&gt;
&gt; &gt;       &lt;driver type='raw'/&gt;
&gt; &gt;     &lt;/disk&gt;
&gt; &gt; &lt;/domainbackup&gt;
&gt;
&gt; snip ...
&gt;
&gt; You forgot to add what you are observing, but I presume:
&gt;
&gt; 'operation unsupported: incremental backup is not supported yet'
&gt;
&gt; Unfortunately it's what it says on the tin. The implementation of the
&gt; incremental backup code is not finished yet, thus the feature is
&gt; disabled.
&gt;
&gt; If you want to test-drive incremental backup APIs, you can enable the
&gt; experimental feature by using the XML documented in:
&gt;
&gt; https://libvirt.org/drvqemu.html#xmlnsfeatures
&gt;
&gt; to enable a feature named 'incremental-backup'. Please make sure to read
&gt; the caveats of doing so thoroughly.
&gt;
&gt; I also advise not to combine incremental backups with snapshots
&gt; (virDomainSnapshot* APIs) and blockjobs (virDomainBlock* APIs) as that
&gt; will not work properly without a patch enabling also experimental qemu
&gt; features.
&gt;
&gt; I also suggest you use the latest qemu for this.
&gt;
&gt;

-- 
BRG,
      Andrey

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div&gt;Thanks Peter!&lt;br&gt;&lt;/div&gt;&lt;div&gt;But is possible change XML \
configuration towards will be possible to do full (push) \
backup?&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" \
class="gmail_attr"&gt;On Wed, Jan 20, 2021 at 9:08 PM Peter Krempa &lt;&lt;a \
href="mailto:pkrempa@redhat.com"&gt;pkrempa@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;On Wed, Jan 20, 2021 \
at 20:49:49 +0300, Andrey Fokin wrote:&lt;br&gt; &gt; Colleagues, could you please advise \
what a problem could be in XML file in&lt;br&gt; &gt; case of:&lt;br&gt;
&gt; virsh backup-begin lubuntu2 ./backup.xml&lt;br&gt;
&gt; &lt;br&gt;
&gt; where backup.xml -&lt;br&gt;
&gt; &lt;domainbackup&gt;&lt;br&gt;
&gt;        &lt;disk name='/var/lib/libvirt/images/lubuntu2.qcow2' \
type='file'&gt;&lt;br&gt; &gt;        &lt;target \
file='$PWD/scratch1.img'/&gt;&lt;br&gt; &gt;        &lt;driver \
type='raw'/&gt;&lt;br&gt; &gt;        &lt;/disk&gt;&lt;br&gt;
&gt;        &lt;disk name='/var/lib/libvirt/images/lubuntu2-1.qcow2' \
type='file'&gt;&lt;br&gt; &gt;           &lt;target \
file='$PWD/scratch2.img'/&gt;&lt;br&gt; &gt;           &lt;driver \
type='raw'/&gt;&lt;br&gt; &gt;        &lt;/disk&gt;&lt;br&gt;
&gt; &lt;/domainbackup&gt;&lt;br&gt;
&lt;br&gt;
snip ...&lt;br&gt;
&lt;br&gt;
You forgot to add what you are observing, but I presume:&lt;br&gt;
&lt;br&gt;
'operation unsupported: incremental backup is not supported yet'&lt;br&gt;
&lt;br&gt;
Unfortunately it's what it says on the tin. The implementation of the&lt;br&gt;
incremental backup code is not finished yet, thus the feature is&lt;br&gt;
disabled.&lt;br&gt;
&lt;br&gt;
If you want to test-drive incremental backup APIs, you can enable the&lt;br&gt;
experimental feature by using the XML documented in:&lt;br&gt;
&lt;br&gt;
&lt;a href="https://libvirt.org/drvqemu.html#xmlnsfeatures" rel="noreferrer" \
target="_blank"&gt;https://libvirt.org/drvqemu.html#xmlnsfeatures&lt;/a&gt;&lt;br&gt; &lt;br&gt;
to enable a feature named 'incremental-backup'. Please make sure to read&lt;br&gt;
the caveats of doing so thoroughly.&lt;br&gt;
&lt;br&gt;
I also advise not to combine incremental backups with snapshots&lt;br&gt;
(virDomainSnapshot* APIs) and blockjobs (virDomainBlock* APIs) as that&lt;br&gt;
will not work properly without a patch enabling also experimental qemu&lt;br&gt;
features.&lt;br&gt;
&lt;br&gt;
I also suggest you use the latest qemu for this.&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;&lt;div dir="ltr" \
class="gmail_signature"&gt;BRG,&lt;br&gt;          Andrey&lt;/div&gt;



</body></email><email><emailId>20211011014336</emailId><senderName>Han Han</senderName><senderEmail>hhan@redhat.com</senderEmail><timestampReceived>2021-10-11 01:43:36-0400</timestampReceived><subject>Re: how to get enabled features</subject><body>

On Fri, Oct 1, 2021 at 10:00 AM Jiatong Shen &lt;yshxxsjt715@gmail.com&gt; wrote:

&gt; Hello community,
&gt;
&gt;   I am trying to learn how to use dtrace and systemtap for libvirt, as the
&gt; documentation says it seems to enable `--with-dtrace` when compiling. I am
&gt; installing libvirt using apt install and is it possible to determine if
&gt; dtrace is built by
&gt;
If your libvirt is built yourself, you should enable dtrace by
`--with-dtrace`(version&lt;6.7.0) or `-Ddtrace=enabled`(version&gt;=6.7.0). See
https://libvirt.org/kbase/systemtap.html

Since you mentioned your libvirt is installed by apt, the dtrace is enabled
or not depending on whether the package builder enables dtrace or not when
building the libvirt package. For debian, you can check the libvirt build
result of your libvirt version(
https://buildd.debian.org/status/logs.php?pkg=libvirt). If there is
`--with-dtrace` or `-Ddtrace=enabled` in the build result, it usually means
the libvirt dtrace is enabled.

&gt; running some libvirt commands?
&gt;
&gt; Thank you.
&gt;
&gt; --
&gt;
&gt; Best Regards,
&gt;
&gt; Jiatong Shen
&gt;

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" \
class="gmail_attr"&gt;On Fri, Oct 1, 2021 at 10:00 AM Jiatong Shen &lt;&lt;a \
href="mailto:yshxxsjt715@gmail.com"&gt;yshxxsjt715@gmail.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;&lt;div dir="ltr"&gt;Hello \
community,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;   I am trying to learn how to use dtrace and systemtap \
for libvirt, as the documentation says it seems to enable `--with-dtrace` when \
compiling. I am installing libvirt using apt install and is it possible to determine \
if dtrace is built by &lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;If your libvirt is built \
yourself, you should enable dtrace by   `--with-dtrace`(version&lt;6.7.0) or \
`-Ddtrace=enabled`(version&gt;=6.7.0). See &lt;a \
href="https://libvirt.org/kbase/systemtap.html"&gt;https://libvirt.org/kbase/systemtap.html&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Since \
you mentioned your libvirt is installed by apt, the dtrace is enabled or not \
depending on whether the package builder enables dtrace or not when building the \
libvirt package. For debian, you can check the libvirt build result of your libvirt \
version(&lt;a href="https://buildd.debian.org/status/logs.php?pkg=libvirt"&gt;https://buildd.debian.org/status/logs.php?pkg=libvirt&lt;/a&gt;). \
If there is `--with-dtrace` or `-Ddtrace=enabled` in the build result, it usually \
means the libvirt dtrace is enabled.&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" \
style="margin:0px 0px 0px 0.8ex;border-left:1px solid \
rgb(204,204,204);padding-left:1ex"&gt;&lt;div dir="ltr"&gt;&lt;div&gt;running some libvirt \
commands?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thank you.&lt;br clear="all"&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- \
&lt;br&gt;&lt;div dir="ltr"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;div&gt;Best \
Regards,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Jiatong Shen&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt; \
&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20211011150235</emailId><senderName>"Jason Pyeron"</senderName><senderEmail>jpyeron@pdinc.us</senderEmail><timestampReceived>2021-10-11 15:02:35-0400</timestampReceived><subject>re: nwfilter direction not being used when protocol all</subject><body>

&gt; -----Original Message-----
&gt; From: Jason Pyeron
&gt; Sent: Monday, October 11, 2021 8:49 AM
&gt; To: Kyle Marek; Michael Watson Jr
&gt; Cc: libvirt-users
&gt; 
&gt; Watson / Kyle:
&gt; 
&gt; (note I coped the list)
&gt; 
&gt; While I read https://libvirt.org/formatnwfilter.html#nwfelemsRulesProtoMisc , it is \
&gt; not clear that it is intended to add the iptables action without regard to the \
&gt; rule's direction.
&gt; 
&gt; Take the following rule scenarios:
&gt; 
&gt; &lt;rule action='accept' direction='in' priority='500' statematch='false'&gt;
&gt; &lt;tcp dstportstart='22'/&gt;
&gt; &lt;/rule&gt;
&gt; &lt;rule action='drop' direction='in' priority='1000'&gt;
&gt; &lt;all/&gt;
&gt; &lt;/rule&gt;
&gt; 
&gt; # iptables-save  | grep vnet5 | tee in
&gt; &gt; FI-vnet5 - [0:0]
&gt; &gt; FO-vnet5 - [0:0]
&gt; &gt; HI-vnet5 - [0:0]
&gt; -A FI-vnet5 -p tcp -m tcp --sport 22 -j RETURN
&gt; -A FI-vnet5 -j DROP
&gt; -A FO-vnet5 -p tcp -m tcp --dport 22 -j ACCEPT
&gt; -A FO-vnet5 -j DROP
&gt; -A HI-vnet5 -p tcp -m tcp --sport 22 -j RETURN
&gt; -A HI-vnet5 -j DROP
&gt; -A libvirt-host-in -m physdev --physdev-in vnet5 -g HI-vnet5
&gt; -A libvirt-in -m physdev --physdev-in vnet5 -g FI-vnet5
&gt; -A libvirt-in-post -m physdev --physdev-in vnet5 -j ACCEPT
&gt; -A libvirt-out -m physdev --physdev-out vnet5 --physdev-is-bridged -g FO-vnet5
&gt; 
&gt; &lt;rule action='accept' direction='in' priority='500' statematch='false'&gt;
&gt; &lt;tcp dstportstart='22'/&gt;
&gt; &lt;/rule&gt;
&gt; &lt;rule action='drop' direction='out' priority='1000'&gt;
&gt; &lt;all/&gt;
&gt; &lt;/rule&gt;
&gt; 
&gt; # iptables-save  | grep vnet5 | tee out
&gt; &gt; FI-vnet5 - [0:0]
&gt; &gt; FO-vnet5 - [0:0]
&gt; &gt; HI-vnet5 - [0:0]
&gt; -A FI-vnet5 -p tcp -m tcp --sport 22 -j RETURN
&gt; -A FI-vnet5 -j DROP
&gt; -A FO-vnet5 -p tcp -m tcp --dport 22 -j ACCEPT
&gt; -A FO-vnet5 -j DROP
&gt; -A HI-vnet5 -p tcp -m tcp --sport 22 -j RETURN
&gt; -A HI-vnet5 -j DROP
&gt; -A libvirt-host-in -m physdev --physdev-in vnet5 -g HI-vnet5
&gt; -A libvirt-in -m physdev --physdev-in vnet5 -g FI-vnet5
&gt; -A libvirt-in-post -m physdev --physdev-in vnet5 -j ACCEPT
&gt; -A libvirt-out -m physdev --physdev-out vnet5 --physdev-is-bridged -g FO-vnet5
&gt; 
&gt; &lt;rule action='accept' direction='in' priority='500' statematch='false'&gt;
&gt; &lt;tcp dstportstart='22'/&gt;
&gt; &lt;/rule&gt;
&gt; &lt;rule action='drop' direction='inout' priority='1000'&gt;
&gt; &lt;all/&gt;
&gt; &lt;/rule&gt;
&gt; 
&gt; # iptables-save  | grep vnet5 | tee inout
&gt; &gt; FI-vnet5 - [0:0]
&gt; &gt; FO-vnet5 - [0:0]
&gt; &gt; HI-vnet5 - [0:0]
&gt; -A FI-vnet5 -p tcp -m tcp --sport 22 -j RETURN
&gt; -A FI-vnet5 -j DROP
&gt; -A FO-vnet5 -p tcp -m tcp --dport 22 -j ACCEPT
&gt; -A FO-vnet5 -j DROP
&gt; -A HI-vnet5 -p tcp -m tcp --sport 22 -j RETURN
&gt; -A HI-vnet5 -j DROP
&gt; -A libvirt-host-in -m physdev --physdev-in vnet5 -g HI-vnet5
&gt; -A libvirt-in -m physdev --physdev-in vnet5 -g FI-vnet5
&gt; -A libvirt-in-post -m physdev --physdev-in vnet5 -j ACCEPT
&gt; -A libvirt-out -m physdev --physdev-out vnet5 --physdev-is-bridged -g FO-vnet5
&gt; 
&gt; We note that the
&gt; 
&gt; -A HI-vnet5 -j DROP
&gt; -A FI-vnet5 -j DROP
&gt; -A FO-vnet5 -j DROP
&gt; 
&gt; Is present without regards to the state of the direction attribute on the "default" \
&gt; drop rule.
&gt; 
&gt; If the direction is "in" then the "-A FI-vnet5 -j DROP" should not exists.
&gt; 
&gt; What does the source code say? I worry that either the docs are imprecise and this \
&gt; is desired, or there is a bug and I can end up like

After looking at libvirt-4.5.0/src/nwfilter/nwfilter_ebiptables_driver.c's \
_iptablesCreateRuleInstance and iptablesCreateRuleInstanceStateCtrl, I saw the if \
statements like the below.

  1598      if (directionIn &amp;&amp; !inout) {
  1599          if ((rule-&gt;flags &amp; IPTABLES_STATE_FLAGS))
  1600              create = false;
  1601      }

  1629      if (!directionIn) {
  1630          if ((rule-&gt;flags &amp; IPTABLES_STATE_FLAGS))
  1631              create = false;
  1632      }

Is the only way to respect the direction is to have &lt;all state='something...'/&gt; ?

If that is the case the docs, really need an update to note this.

For others, my deny inbound, allow outbound was accomplished by:

  &lt;rule action='accept' direction='in' priority='999'&gt;
    &lt;all state='ESTABLISHED,RELATED'/&gt;
  &lt;/rule&gt;
  &lt;rule action='drop' direction='in' priority='1000'&gt;
    &lt;all state='NONE'/&gt;
  &lt;/rule&gt;

-Jason


</body></email><email><emailId>20211013122555</emailId><senderName>shafnamol N</senderName><senderEmail>shafnamol29@gmail.com</senderEmail><timestampReceived>2021-10-13 12:25:55-0400</timestampReceived><subject>could not find capabilities for arch=x86_64 domaintype=kvm</subject><body>

Hi,
I am new  to Libvirt and Qemu.I have installed Libvirt 6.10 and qemu-kvm
4.2.0 on CentOS8.
I configured and built libvirt based on instructions from
https://libvirt.org/compiling.html.
But when i tried to create a VM using virsh it shows the following error:
*# virsh create /home/abc.xml*

*error: Failed to create domain from /home/abc.xmlerror: invalid argument:
could not find capabilities for arch=x86_64 domaintype=kvm *
When i check the hypervisor capabilities ,it doest show qemu in guest
domain type.
# virsh capabilities
As per the reply from this mailing-list i passed an option while building
the libvirt.
ie.,

*meson build -Dsystem=true*

It worked for me.

But Now, i tried to migrate my work on a new machine with same os and
same version as above.

As part of,I configured and built libvirt.Also passed *meson build
-Dsystem=true *while building libvirt.

After installation I tried with

*# virsh create /home/abc.xml*

It results in the same error shown below.



*error: Failed to create domain from /home/abc.xmlerror: invalid argument:
could not find capabilities for arch=x86_64 domaintype=kvm *
I stuck here.
Thanks for the help in advance.

Shafnamol.N

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div&gt;  Hi,&lt;/div&gt;&lt;div&gt;&lt;div&gt;I am new   to Libvirt and Qemu.I have \
installed Libvirt 6.10 and qemu-kvm 4.2.0 on CentOS8.&lt;/div&gt;&lt;div&gt;I configured and \
built libvirt based on instructions from&lt;/div&gt;&lt;div&gt;&lt;a \
href="https://libvirt.org/compiling.html" \
target="_blank"&gt;https://libvirt.org/compiling.html&lt;/a&gt;.&lt;/div&gt;&lt;div&gt;But when i tried to \
create a VM using virsh it shows the following error:&lt;/div&gt;&lt;div&gt;&lt;b&gt;# virsh create \
/home/abc.xml&lt;/b&gt;&lt;br&gt;&lt;b&gt;error: Failed to create domain from /home/abc.xml&lt;br&gt;error: \
invalid argument: could not find capabilities for arch=x86_64 domaintype=kvm \
&lt;/b&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;When i check the hypervisor capabilities ,it doest show qemu \
in guest domain type.&lt;/div&gt;&lt;div&gt;# virsh capabilities&lt;/div&gt;&lt;/div&gt;&lt;div&gt;As per the reply \
from this mailing-list i passed an option while building the \
libvirt.&lt;/div&gt;&lt;div&gt;ie.,&lt;/div&gt;&lt;div&gt;&lt;pre&gt;&lt;b&gt;meson build \
-Dsystem=true&lt;/b&gt;&lt;br&gt;&lt;/pre&gt;&lt;pre&gt;&lt;span style="font-family:arial,sans-serif"&gt;It worked \
for me.&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;&lt;pre&gt;&lt;span style="font-family:arial,sans-serif"&gt;But Now, i \
tried to migrate my work on a new machine with same os and same version as \
above.&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;&lt;pre&gt;&lt;span style="font-family:arial,sans-serif"&gt;As part of,I \
configured and built libvirt.Also passed &lt;b&gt;meson build -Dsystem=true &lt;/b&gt;while \
building libvirt.&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;&lt;pre&gt;&lt;span \
style="font-family:arial,sans-serif"&gt;After installation I tried with &lt;br&gt;&lt;b&gt;# virsh \
create /home/abc.xml&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;/pre&gt;&lt;pre&gt;&lt;span \
style="font-family:arial,sans-serif"&gt;It results in the same error shown \
below.&lt;br&gt;&lt;b&gt;&lt;/b&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;error: Failed to create domain from \
/home/abc.xml&lt;br&gt;error: invalid argument: could not find capabilities for arch=x86_64 \
domaintype=kvm &lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;I stuck here.&lt;/div&gt;&lt;div&gt;Thanks for the help in \
advance.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Shafnamol.N&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;




</body></email><email><emailId>20211014101136</emailId><senderName>Vojtech Juranek</senderName><senderEmail>vjuranek@redhat.com</senderEmail><timestampReceived>2021-10-14 10:11:36-0400</timestampReceived><subject>Re: VM paused during multipath iSCSI reservation</subject><body>


On Thursday, 14 October 2021 09:28:12 CEST Michal Prívozník wrote:
&gt; On 10/13/21 2:54 PM, Vojtech Juranek wrote:
&gt; &gt; Hi,
&gt; &gt; I'm trying to find the root cause for BZ #1898049 [1]. When setting up
&gt; &gt; Windows HA cluster on Windows Server VMs run on top of oVirt, Windows
&gt; &gt; cluster validator runs couple of tests and fails during test "Validate
&gt; &gt; SCSI-3 Persistent Reservation" and one of the VMs of&gt; 
&gt; &gt; the cluster is paused with IO error. Disk definition is as follows:
&gt; &gt; &lt;disk type='block' device='lun' sgio='unfiltered' snapshot='no'&gt;
&gt; &gt; 
&gt; &gt; &lt;driver name='qemu' type='raw' cache='none' error_policy='stop'
&gt; &gt; io='native'/&gt; &lt;source
&gt; &gt; dev='/dev/mapper/3600a09803830447a4f244c4657616f6f' index='1'&gt;&gt;       
&gt; &gt; &lt;seclabel model='dac' relabel='no'/&gt;
&gt; &gt; &lt;reservations managed='yes'&gt;
&gt; &gt; 
&gt; &gt; &lt;source type='unix'
&gt; &gt; path='/var/lib/libvirt/qemu/domain-1-Windows-2016-2/pr-helper0.
&gt; &gt; sock' mode='client'/&gt;&gt;         
&gt; &gt; &lt;/reservations&gt;
&gt; &gt; 
&gt; &gt; &lt;/source&gt;
&gt; &gt; &lt;backingStore/&gt;
&gt; &gt; &lt;target dev='sdb' bus='scsi'/&gt;
&gt; &gt; &lt;shareable/&gt;
&gt; &gt; &lt;alias name='ua-26b4975e-e1d4-4e27-b2c6-2ea0894a571b'/&gt;
&gt; &gt; &lt;address type='drive' controller='0' bus='0' target='0' unit='1'/&gt;
&gt; &gt; 
&gt; &gt; &lt;/disk&gt;
&gt; &gt; 
&gt; &gt; and libvirt error I get is bellow [2].
&gt; &gt; 
&gt; &gt; When I try to create reservation from Windows VM manually, I get following
&gt; &gt; error (but not sure I do it whole process correctly):
&gt; &gt; 
&gt; &gt; .\sg_persist --out --register --param-sark=123abc e:
&gt; &gt; QEMU   QEMU HARDDISK               2.5+
&gt; &gt; Peripheral device type: disk
&gt; &gt; 
&gt; &gt; PR out (Register): command not supported
&gt; &gt; sg_persist failed: Illegal request, Invalid opcode
&gt; &gt; 
&gt; &gt; 
&gt; &gt; Do you have any ideas what could be wrong or how to determine
&gt; &gt; the root cause of this this issue?
&gt; &gt; 
&gt; &gt; Thanks in advance.
&gt; &gt; Vojta
&gt; &gt; 
&gt; &gt; 
&gt; &gt; [1] https://bugzilla.redhat.com/1898049
&gt; &gt; [2] libvirt debug log:
&gt; &gt; 
&gt; &gt; 2021-10-12 11:43:25.148+0000: 2006427: debug : qemuMonitorEmitIOError:1243
&gt; &gt; &gt; mon=0x7fb02006a020 2021-10-12 11:43:25.148+0000: 2006427: info :
&gt; &gt; virObjectRef:402 : OBJECT_REF: obj=0x7fb02006a020 2021-10-12
&gt; &gt; 11:43:25.148+0000: 2006427: info : virObjectRef:402 : OBJECT_REF:
&gt; &gt; obj=0x7fafd0130020 2021-10-12 11:43:25.148+0000: 2000208: info :
&gt; &gt; virObjectRef:402 : OBJECT_REF: obj=0x7fafd010d340 2021-10-12
&gt; &gt; 11:43:25.148+0000: 2006427: info : virObjectNew:258 : OBJECT_NEW:
&gt; &gt; obj=0x7fb020082590 classname=virDomainEventIOError 2021-10-12
&gt; &gt; 11:43:25.148+0000: 2000208: info : vir_object_finalize:321 :
&gt; &gt; OBJECT_DISPOSE: obj=0x7fb020082500 2021-10-12 11:43:25.148+0000: 2006427:
&gt; &gt; info : virObjectNew:258 : OBJECT_NEW: obj=0x7fb020082620
&gt; &gt; classname=virDomainEventIOError 2021-10-12 11:43:25.148+0000: 2000208:
&gt; &gt; info : virObjectUnref:380 : OBJECT_UNREF: obj=0x7fb020082500 2021-10-12
&gt; &gt; 11:43:25.148+0000: 2006427: debug : qemuProcessHandleIOError:907 :
&gt; &gt; Transitioned guest Windows-2016-2 to paused state due to IO error
&gt; &gt; 2021-10-12 11:43:25.148+0000: 2000208: info : virObjectUnref:380 :
&gt; &gt; OBJECT_UNREF: obj=0x7fafd010d340 2021-10-12 11:43:25.148+0000: 2006427:
&gt; &gt; info : virObjectNew:258 : OBJECT_NEW: obj=0x7fafbc1fb8c0
&gt; &gt; classname=virDomainEventLifecycle 2021-10-12 11:43:25.148+0000: 2006427:
&gt; &gt; debug : virDomainLockProcessPause:204 : plugin=0x7fafd01272a0
&gt; &gt; dom=0x7fb01400f5e0 state=0x7fb02401d768 2021-10-12 11:43:25.148+0000:
&gt; &gt; 2006427: debug : virDomainLockManagerNew:134 : plugin=0x7fafd01272a0
&gt; &gt; dom=0x7fb01400f5e0 withResources=1 2021-10-12 11:43:25.148+0000: 2006427:
&gt; &gt; debug : virLockManagerPluginGetDriver:276 : plugin=0x7fafd01272a0
&gt; &gt; 2021-10-12 11:43:25.148+0000: 2006427: debug : virLockManagerNew:300 :
&gt; &gt; driver=0x7fafd444a000 type=0 nparams=5 params=0x7fafd77de640 flags=0x0
&gt; &gt; 2021-10-12 11:43:25.148+0000: 2006427: debug : virLockManagerLogParams:97
&gt; &gt; &gt; key=uuid type=uuid value=70eee88c-ba2c-4c6c-bd51-c2b663db27f8
&gt; &gt; 2021-10-12 11:43:25.148+0000: 2006427: debug : virLockManagerLogParams:90
&gt; &gt; &gt; key=name type=string value=Windows-2016-2 2021-10-12
&gt; &gt; 11:43:25.148+0000: 2006427: debug : virLockManagerLogParams:78 :   key=id
&gt; &gt; type=uint value=1 2021-10-12 11:43:25.148+0000: 2006427: debug :
&gt; &gt; virLockManagerLogParams:78 :   key=pid type=uint value=2006418 2021-10-12
&gt; &gt; 11:43:25.148+0000: 2006427: debug : virLockManagerLogParams:93 :  
&gt; &gt; key=uri type=cstring value=(null) 2021-10-12 11:43:25.148+0000: 2006427:
&gt; &gt; debug : virDomainLockManagerNew:146 : Adding leases 2021-10-12
&gt; &gt; 11:43:25.148+0000: 2006427: debug : virDomainLockManagerNew:151 : Adding
&gt; &gt; disks 2021-10-12 11:43:25.149+0000: 2006427: debug :
&gt; &gt; virDomainLockManagerAddImage:90 : Add disk
&gt; &gt; /rhev/data-center/mnt/blockSD/7c4f09b6-9e87-436f-bda9-22d1f0b50955/images
&gt; &gt; /f5d6e074-dfe9-462d-8cfd-3e14b0eb5aea/766e36b2-84a6-43e7-a48b-a5f47e669860
&gt; &gt; 2021-10-12 11:43:25.149+0000: 2006427: debug :
&gt; &gt; virLockManagerAddResource:326 : lock=0x7fafbc19e250 type=0
&gt; &gt; name=/rhev/data-center/mnt/blockSD/7c4f09b6-9e87-436f-bda9-22d1f0b50955/i
&gt; &gt; mages/f5d6e074-dfe9-462d-8cfd-3e14b0eb5aea/766e36b2-84a6-43e7-a48b-a5f47e6
&gt; &gt; 69860 nparams=0 params=(nil) flags=0x0 2021-10-12 11:43:25.149+0000:
&gt; &gt; 2006427: debug : virDomainLockManagerAddImage:90 : Add disk
&gt; &gt; /dev/mapper/3600a09803830447a4f244c4657616f6f 2021-10-12
&gt; &gt; 11:43:25.149+0000: 2006427: debug : virLockManagerAddResource:326 :
&gt; &gt; lock=0x7fafbc19e250 type=0
&gt; &gt; name=/dev/mapper/3600a09803830447a4f244c4657616f6f nparams=0 params=(nil)
&gt; &gt; flags=0x2 2021-10-12 11:43:25.149+0000: 2006427: debug :
&gt; &gt; virLockManagerRelease:359 : lock=0x7fafbc19e250 state=0x7fb02401d768
&gt; &gt; flags=0x0 2021-10-12 11:43:25.149+0000: 2006427: debug :
&gt; &gt; virLockManagerFree:381 : lock=0x7fafbc19e250 2021-10-12
&gt; &gt; 11:43:25.149+0000: 2006427: debug : qemuProcessHandleIOError:920 :
&gt; &gt; Preserving lock state '&lt;null&gt;' 2021-10-12 11:43:25.150+0000: 2006427:
&gt; &gt; info : virObjectUnref:380 : OBJECT_UNREF: obj=0x7fafd0130020 2021-10-12
&gt; &gt; 11:43:25.150+0000: 2006427: info : virObjectUnref:380 : OBJECT_UNREF:
&gt; &gt; obj=0x7fb02006a020 2021-10-12 11:43:25.150+0000: 2000208: info :
&gt; &gt; virObjectRef:402 : OBJECT_REF: obj=0x7fafd010d340 2021-10-12
&gt; &gt; 11:43:25.150+0000: 2000208: info : vir_object_finalize:321 :
&gt; &gt; OBJECT_DISPOSE: obj=0x7fb020082590 2021-10-12 11:43:25.150+0000: 2006427:
&gt; &gt; info : virObjectRef:402 : OBJECT_REF: obj=0x7fb02006a020 2021-10-12
&gt; &gt; 11:43:25.150+0000: 2000208: info : virObjectUnref:380 : OBJECT_UNREF:
&gt; &gt; obj=0x7fb020082590 2021-10-12 11:43:25.150+0000: 2006427: info :
&gt; &gt; virObjectUnref:380 : OBJECT_UNREF: obj=0x7fb02006a020 2021-10-12
&gt; &gt; 11:43:25.150+0000: 2000208: info : virObjectNew:258 : OBJECT_NEW:
&gt; &gt; obj=0x564a89a4cc60 classname=virDomain 2021-10-12 11:43:25.150+0000:
&gt; &gt; 2006427: info : virObjectUnref:380 : OBJECT_UNREF: obj=0x7fb02006a020
&gt; &gt; 2021-10-12 11:43:25.150+0000: 2000208: info : virObjectRef:402 :
&gt; &gt; OBJECT_REF: obj=0x7fafd0018ca0 2021-10-12 11:43:25.150+0000: 2000208:
&gt; &gt; info : virObjectRef:402 : OBJECT_REF: obj=0x564a89978df0 2021-10-12
&gt; &gt; 11:43:25.150+0000: 2000208: debug : virAccessManagerCheckDomain:238 :
&gt; &gt; manager=0x564a89978df0(name=stack) driver=QEMU domain=0x7ffd2c677010
&gt; &gt; perm=0 2021-10-12 11:43:25.150+0000: 2000208: debug :
&gt; &gt; virAccessManagerCheckDomain:238 : manager=0x564a89978e50(name=none)
&gt; &gt; driver=QEMU domain=0x7ffd2c677010 perm=0 2021-10-12 11:43:25.150+0000:
&gt; &gt; 2000208: info : virObjectUnref:380 : OBJECT_UNREF: obj=0x564a89978df0
&gt; &gt; 2021-10-12 11:43:25.150+0000: 2000208: debug :
&gt; &gt; remoteRelayDomainEventIOErrorReason:529 : Relaying domain io error
&gt; &gt; Windows-2016-2 1 /dev/mapper/3600a09803830447a4f244c4657616f6f
&gt; &gt; ua-26b4975e-e1d4-4e27-b2c6-2ea0894a571b 1 , callback 3
&gt; Unfortunately, you cut off the log a bit early/late; there should be a
&gt; message from qemu's monitor mentioning BLOCK_IO_ERROR; Can you check
&gt; your logs please?

yes, it's few lines earlier:

2021-10-12 11:43:22.297+0000: 2000213: info : virObjectUnref:380 : OBJECT_UNREF: \
obj=0x564a89a1d010 2021-10-12 11:43:22.297+0000: 2000213: info : virObjectUnref:380 : \
OBJECT_UNREF: obj=0x564a89a46360 2021-10-12 11:43:22.297+0000: 2000208: debug : \
virNetMessageFree:85 : msg=0x564a89a3d510 nfds=0 cb=(nil) 2021-10-12 \
11:43:22.297+0000: 2000208: debug : virNetServerClientCalculateHandleMode:154 : \
tls=(nil) hs=-1, rx=0x564a89a48620 tx=(nil) 2021-10-12 11:43:22.297+0000: 2000208: \
debug : virNetServerClientCalculateHandleMode:185 : mode=01 2021-10-12 \
11:43:25.148+0000: 2006427: info : virObjectRef:402 : OBJECT_REF: obj=0x7fb02006a020 \
2021-10-12 11:43:25.148+0000: 2006427: debug : qemuMonitorEmitEvent:1166 : \
mon=0x7fb02006a020 event=BLOCK_IO_ERROR 2021-10-12 11:43:25.148+0000: 2006427: info : \
virObjectRef:402 : OBJECT_REF: obj=0x7fb02006a020 2021-10-12 11:43:25.148+0000: \
2006427: debug : qemuProcessHandleEvent:574 : vm=0x7fb01400f5e0 2021-10-12 \
11:43:25.148+0000: 2006427: info : virObjectNew:258 : OBJECT_NEW: obj=0x7fb020082500 \
classname=virDomainQemuMonitorEvent 2021-10-12 11:43:25.148+0000: 2006427: info : \
virObjectUnref:380 : OBJECT_UNREF: obj=0x7fb02006a020 2021-10-12 11:43:25.148+0000: \
2006427: debug : qemuMonitorEmitIOError:1243 : mon=0x7fb02006a020

However, it seem the issue was caused by using error_policy='stop' in

&lt;driver name='qemu' type='raw' cache='none' error_policy='stop' io='native'/&gt;

I need to double check, but switching to error_policy='report' seems to fix the issue
and HA validator succeeds (probably one of the test is testing concurrent \
reservations and validating that one reservation fails?).

Thanks
Vojta


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20211020083821</emailId><senderName>Andrea Bolognani</senderName><senderEmail>abologna@redhat.com</senderEmail><timestampReceived>2021-10-20 08:38:21-0400</timestampReceived><subject>Re: about pcie-hot-plug on aarch64</subject><body>

Forwarding to libvirt-users for visibility.

On Wed, Oct 20, 2021 at 03:51:10PM +0800, Jaze Lee wrote:
&gt; For someone who meets the same problem.
&gt;
&gt; I upgrade stein to w, use one centos stream 8 vm as ctrl, and one
&gt; centos stream 8 server as cn,
&gt; then test it. There is no problem with attaching disks. All disks are
&gt; attached correctly.
&gt; But we do not know what's the problem with stein. If someone meets the
&gt; problem, you can update your openstack.
&gt;
&gt; Jaze Lee &lt;jazeltq@gmail.com&gt; 于2021年10月12日周二 上午9:20写道：
&gt; &gt; Andrea Bolognani &lt;abologna@redhat.com&gt; 于2021年10月12日周二 上午12:07写道：
&gt; &gt; &gt; On Fri, Oct 08, 2021 at 04:54:37PM +0800, Jaze Lee wrote:
&gt; &gt; &gt; &gt; Hello,
&gt; &gt; &gt; &gt;     We run Openstack Stein on arm. It  runs nova-compute(use libvirt
&gt; &gt; &gt; &gt; as virt driver) on arm host. We found when built with disks (use ceph
&gt; &gt; &gt; &gt; rbd) on arm hosts, the vm can not attach all disk correctly. For
&gt; &gt; &gt; &gt; example, built with six disks, the vm may attach three disks. No
&gt; &gt; &gt; &gt; obvious error can be fond in nova-compute, libvirt. We compare aarch64
&gt; &gt; &gt; &gt; and x86, find when detach disk, the dmesg of the vm's os is different.
&gt; &gt; &gt; &gt; May be the pciehg parameter is different?
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; Did anyone met the problem?  Or some suggestions?
&gt; &gt; &gt;
&gt; &gt; &gt; I think you might have just ran out of PCI ports available for
&gt; &gt; &gt; hotplug. Please try setting
&gt; &gt; &gt;
&gt; &gt; &gt;   https://docs.openstack.org/nova/stein/configuration/config.html#libvirt.num_pcie_ports
&gt; &gt; &gt;
&gt; &gt; &gt; to a reasonable value and see whether that helps.
&gt; &gt;
&gt; &gt; Thanks.
&gt; &gt; I already set the value to a reasonable value. It is 15 in our environment.
&gt; &gt; If the value is not set correctly, the nova-compute will complain no
&gt; &gt; available slot for pci device.
&gt; &gt; But it is not the case I talked about here.

-- 
Andrea Bolognani / Red Hat / Virtualization


</body></email><email><emailId>20211021193225</emailId><senderName>John Morris</senderName><senderEmail>jmorris@beau.org</senderEmail><timestampReceived>2021-10-21 19:32:25-0400</timestampReceived><subject>Re: is there a way to stop a domain in 'D' process state (uninterruptible) ?</subject><body>


On Thu, 2021-10-21 at 18:08 +0200, Lentes, Bernd wrote:
&gt; Hi,
&gt; 
&gt; how can i stop/shutdown a domain which is in process state 'D' ?
&gt; 'D' means uninterruptible and a process in 'D' can't be terminated by
&gt; kill, even not with kill -9.

D means it is dead, the process will never be scheduled to execute
again, but there is still pending I/O waiting to settle.  Use fuser
and/or look in /proc/{pid}/fd to see what could be holding up the final 
termination.  Network mounts and sockets are a likely suspect.  Think it
can also happen if the parent process won't accept the SIGCHLD signal
since that also counts as I/O that has to finish before the final
reaping of process resources.

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20211022103512</emailId><senderName>Marc</senderName><senderEmail>marc@f1-outsourcing.eu</senderEmail><timestampReceived>2021-10-22 10:35:12-0400</timestampReceived><subject>load monitoring differences</subject><body>


I was wondering if it is normal that the load reported from within the guest differs \
a lot from the guest load monitored on the host?

Eg. currently I have guest that reports a load of 12-17 (uptime) while on the host \
top shows 70% cpu usage, I would expect this to be also around 12-17%.


</body></email><email><emailId>20211025120625</emailId><senderName>"Lentes, Bernd"</senderName><senderEmail>bernd.lentes@helmholtz-muenchen.de</senderEmail><timestampReceived>2021-10-25 12:06:25-0400</timestampReceived><subject>how can i measure reliably the speed of a virtual disk ?</subject><body>


Hi,

we have some domains running on a two-node pacemaker cluster. The disks for the \
domains are raw files which reside on a SAN.
I measured the speed of one domain inside the guest and got completely weird results:
between 18MB/s and 750MB/s !?!

I measured with hdparm -t.
I think this is related because, from the host point of view, some data is on the \
disk and some data is on chache. The -t i used for hdparm does not influence the \
host, just the guest.

Measures on the host give reliable and reasonable results about 350 MByte/s.

How can i measure reliably the speed of a virtual disk ?

Bernd

-- 

Bernd Lentes 
System Administrator 
Institute for Metabolism and Cell Death (MCD) 
Building 25 - office 122 
HelmholtzZentrum München 
bernd.lentes@helmholtz-muenchen.de 
phone: +49 89 3187 1241 
phone: +49 89 3187 3827 
fax: +49 89 3187 2294 
http://www.helmholtz-muenchen.de/mcd 


Public key: 

30 82 01 0a 02 82 01 01 00 b3 72 3e ce 2c 0a 6f 58 49 2c 92 23 c7 b9 c1 ff 6c 3a 53 \
be f7 9e e9 24 b7 49 fa 3c e8 de 28 85 2c d3 ed f7 70 03 3f 4d 82 fc cc 96 4f 18 27 \
1f df 25 b3 13 00 db 4b 1d ec 7f 1b cf f9 cd e8 5b 1f 11 b3 a7 48 f8 c8 37 ed 41 ff \
18 9f d7 83 51 a9 bd 86 c2 32 b3 d6 2d 77 ff 32 83 92 67 9e ae ae 9c 99 ce 42 27 6f \
bf d8 c2 a1 54 fd 2b 6b 12 65 0e 8a 79 56 be 53 89 70 51 02 6a eb 76 b8 92 25 2d 88 \
aa 57 08 42 ef 57 fb fe 00 71 8e 90 ef b2 e3 22 f3 34 4f 7b f1 c4 b1 7c 2f 1d 6f bd \
c8 a6 a1 1f 25 f3 e4 4b 6a 23 d3 d2 fa 27 ae 97 80 a3 f0 5a c4 50 4a 45 e3 45 4d 82 \
9f 8b 87 90 d0 f9 92 2d a7 d2 67 53 e6 ae 1e 72 3e e9 e0 c9 d3 1c 23 e0 75 78 4a 45 \
60 94 f8 e3 03 0b 09 85 08 d0 6c f3 ff ce fa 50 25 d9 da 81 7b 2a dc 9e 28 8b 83 04 \
b4 0a 9f 37 b8 ac 58 f1 38 43 0e 72 af 02 03 01 00 01


["smime.p7s" (application/pkcs7-signature)]

</body></email><email><emailId>20211003210619</emailId><senderName>Marc</senderName><senderEmail>marc@f1-outsourcing.eu</senderEmail><timestampReceived>2021-10-03 21:06:19-0400</timestampReceived><subject>how/where to configure access to libvirt-sock-ro</subject><body>

I wanted to create a monitoring user that can do some reporting like this:

runuser -u xxxxx  -- prometheus-libvirt-exporter -libvirt.uri /var/run/libvirt/libvirt-sock-ro

But I am getting the 
failed to connect: authentication required

</body></email><email><emailId>20211114215243</emailId><senderName>Toolybird</senderName><senderEmail>toolybird@tuta.io</senderEmail><timestampReceived>2021-11-14 21:52:43-0400</timestampReceived><subject>CPU vendor_id handling</subject><body>

Hello,

There are times when spoofing the CPU vendor_id is convenient. For example, some x86 \
guest OS's only run on Intel and refuse to run on an AMD host. Libvirt does support \
this in the "host-model" case, but it doesn't work for CPU "host-passthrough". On the \
QEMU command line it's as easy as:

$ qemu-system-x86_64 -cpu host,vendor=GenuineIntel

This works fine in libvirt XML:

&lt;cpu mode='host-model'&gt;
   &lt;model vendor_id='GenuineIntel'/&gt;
&lt;/cpu&gt;

This doesn't:

&lt;cpu mode='host-passthrough'&gt;
   &lt;model vendor_id='GenuineIntel'/&gt;
&lt;/cpu&gt;

Libvirt silently strips out the model line after saving "virsh edit ..."

Is there any reason why libvirt cannot support this in the host-passthrough case? The \
status quo means that some folks end up resorting to &lt;qemu:arg value='-cpu'/&gt; hacks \
which of course causes all sorts of confusion with multiple -cpu lines getting passed \
to QEMU.

Thanks


[Attachment #3 (text/html)]

&lt;html&gt;
  &lt;head&gt;
    &lt;meta http-equiv="content-type" content="text/html; charset=UTF-8"&gt;
  &lt;/head&gt;
  &lt;body&gt;
&lt;div&gt;Hello,&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;There are times when \
spoofing the CPU vendor_id is convenient. For example, some x86 guest OS's only run \
on Intel and refuse to run on an AMD host. Libvirt does support this in the \
"host-model" case, but it doesn't work for CPU "host-passthrough". On the QEMU \
command line it's as easy as:&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;$ \
qemu-system-x86_64 -cpu host,vendor=GenuineIntel&lt;br&gt;&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;This works fine in libvirt XML:&lt;br&gt;&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;cpu mode='host-model'&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
dir="auto"&gt;  &lt;model vendor_id='GenuineIntel'/&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;/cpu&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;This \
doesn't:&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;cpu \
mode='host-passthrough'&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;  &lt;model \
vendor_id='GenuineIntel'/&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;/cpu&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;Libvirt silently strips out the model line after \
saving "virsh edit ..."&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;Is there \
any reason why libvirt cannot support this in the host-passthrough case? The status \
quo means that some folks end up resorting to &lt;qemu:arg value='-cpu'/&gt; hacks \
which of course causes all sorts of confusion with multiple -cpu lines getting passed \
to QEMU.&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;Thanks&lt;br&gt;&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;br&gt;&lt;/div&gt;  &lt;/body&gt; &lt;/html&gt;



</body></email><email><emailId>20211129120540</emailId><senderName>Elias Mobery</senderName><senderEmail>eliasmobery@gmail.com</senderEmail><timestampReceived>2021-11-29 12:05:40-0400</timestampReceived><subject>Libvirt Snapshot Question</subject><body>

Hi everybody!

I'm using a snapshot purely for writes and was wondering if it's possible
to clear/empty the snapshot after it reaches a certain size?

Created with:
 virsh snapshot-create-as  --disk-only

I tried deleting and recreating it but get an error at deletion:

virsh snapshot-delete

Error: source for disk 'vda' is not a regular file

I also tried virsh snapshot-create-as --no-metadata --disk-only

But the same error as above pops up when trying to delete.

Any ideas?

[Attachment #3 (text/html)]

&lt;div dir="auto"&gt;Hi everybody!&lt;div dir="auto"&gt;&lt;br&gt;&lt;div dir="auto"&gt;I'm using a \
snapshot purely for writes and was wondering if it's possible to clear/empty the \
snapshot after it reaches a certain size?&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
dir="auto"&gt;Created with:&lt;/div&gt;&lt;div dir="auto"&gt;  virsh snapshot-create-as   \
--disk-only&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;I tried deleting and \
recreating it but get an error at deletion:&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
dir="auto"&gt;virsh snapshot-delete&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
dir="auto"&gt;Error:  source for disk 'vda' is not a regular file&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;I also tried virsh snapshot-create-as \
--no-metadata --disk-only&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;But the same \
error as above pops up when trying to delete.&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
dir="auto"&gt;Any ideas?&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20211130084201</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-11-30 08:42:01-0400</timestampReceived><subject>Re: Libvirt Snapshot Question</subject><body>

On Mon, Nov 29, 2021 at 13:05:40 +0100, Elias Mobery wrote:
&gt; Hi everybody!
&gt; 
&gt; I'm using a snapshot purely for writes and was wondering if it's possible
&gt; to clear/empty the snapshot after it reaches a certain size?
&gt; 
&gt; Created with:
&gt;  virsh snapshot-create-as  --disk-only

So this creates a so-called external snapshot, which for disks means an
overlay image.

&gt; 
&gt; I tried deleting and recreating it but get an error at deletion:
&gt; 
&gt; virsh snapshot-delete

but unfortunately deleting external snapshots is not yet implemented.

The usual approach is to do a block commit operation to merge the
overlay images back into the backing image manually.

The basic syntax via virsh is:

  virsh blockcommit --active --pivot --verbose $VM $DISK

This merges any overlay images into the backing image. Backing image is
the most deepest nested image when you look at &lt;backingStore&gt; in the
XML.

&gt; Error: source for disk 'vda' is not a regular file

This error doesn't make much sense though. The error should state that
deletion of external snapshots is nto supported. 

&gt; 
&gt; I also tried virsh snapshot-create-as --no-metadata --disk-only

This creates a snapshot without libvirt metadata. This means that
libvirt just creates the overlay, but doesn't create any internal state
related to it.

It saves you the step of deleting metadata, but you still need to
manually merge the image.

&gt; 
&gt; But the same error as above pops up when trying to delete.

This makes absolutely no sense though. Are you sure you are copying the
correct error message? 'virsh snapshot-delete' works _only_ with
snapshots which do have metadata, so if you create a snapshot without
there's nothing to delete.

</body></email><email><emailId>20211130135154</emailId><senderName>Elias Mobery</senderName><senderEmail>eliasmobery@gmail.com</senderEmail><timestampReceived>2021-11-30 13:51:54-0400</timestampReceived><subject>Re: Libvirt Snapshot Question</subject><body>

Hello Peter, thank you so much for that detailed info!

Sorry, you were right, when trying to delete my external snapshot via
snapshot-delete, the error says "deletion of external snapshots unsupported"

I can't merge the snapshot because the VM image is in a read-only
filesystem. Sorry I should've said, it's a live system. So the image is in
the read-only squashfs and external snapshot in overlay is used for writing.

Now I would like the snapshot emptied or deleted/recreated when it reaches
4GB.

Is there even a way to do this with the image being read-only?

Thanks again for your advice, I really love this community.


On Tue, Nov 30, 2021, 9:42 AM Peter Krempa &lt;pkrempa@redhat.com&gt; wrote:

&gt; On Mon, Nov 29, 2021 at 13:05:40 +0100, Elias Mobery wrote:
&gt; &gt; Hi everybody!
&gt; &gt;
&gt; &gt; I'm using a snapshot purely for writes and was wondering if it's possible
&gt; &gt; to clear/empty the snapshot after it reaches a certain size?
&gt; &gt;
&gt; &gt; Created with:
&gt; &gt;  virsh snapshot-create-as  --disk-only
&gt;
&gt; So this creates a so-called external snapshot, which for disks means an
&gt; overlay image.
&gt;
&gt; &gt;
&gt; &gt; I tried deleting and recreating it but get an error at deletion:
&gt; &gt;
&gt; &gt; virsh snapshot-delete
&gt;
&gt; but unfortunately deleting external snapshots is not yet implemented.
&gt;
&gt; The usual approach is to do a block commit operation to merge the
&gt; overlay images back into the backing image manually.
&gt;
&gt; The basic syntax via virsh is:
&gt;
&gt;   virsh blockcommit --active --pivot --verbose $VM $DISK
&gt;
&gt; This merges any overlay images into the backing image. Backing image is
&gt; the most deepest nested image when you look at &lt;backingStore&gt; in the
&gt; XML.
&gt;
&gt; &gt; Error: source for disk 'vda' is not a regular file
&gt;
&gt; This error doesn't make much sense though. The error should state that
&gt; deletion of external snapshots is nto supported.
&gt;
&gt; &gt;
&gt; &gt; I also tried virsh snapshot-create-as --no-metadata --disk-only
&gt;
&gt; This creates a snapshot without libvirt metadata. This means that
&gt; libvirt just creates the overlay, but doesn't create any internal state
&gt; related to it.
&gt;
&gt; It saves you the step of deleting metadata, but you still need to
&gt; manually merge the image.
&gt;
&gt; &gt;
&gt; &gt; But the same error as above pops up when trying to delete.
&gt;
&gt; This makes absolutely no sense though. Are you sure you are copying the
&gt; correct error message? 'virsh snapshot-delete' works _only_ with
&gt; snapshots which do have metadata, so if you create a snapshot without
&gt; there's nothing to delete.
&gt;
&gt;

[Attachment #3 (text/html)]

&lt;div dir="auto"&gt;Hello Peter, thank you so much for that detailed info!&lt;div \
dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;Sorry, you were right, when trying to delete my \
external snapshot via snapshot-delete, the error says "deletion of external \
snapshots unsupported"&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;I \
can't merge the snapshot because the VM image is in a read-only filesystem. Sorry \
I should've said, it's a live system. So the image is in the read-only \
squashfs and external snapshot in overlay is used for writing.&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;Now I would like the snapshot emptied or \
deleted/recreated when it reaches 4GB.&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
dir="auto"&gt;Is there even a way to do this with the image being read-only?&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;Thanks again for your advice, I really love this \
community.&lt;/div&gt;&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote" dir="auto"&gt;&lt;div dir="ltr" \
class="gmail_attr"&gt;On Tue, Nov 30, 2021, 9:42 AM Peter Krempa &lt;&lt;a \
href="mailto:pkrempa@redhat.com"&gt;pkrempa@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 \
.8ex;border-left:1px #ccc solid;padding-left:1ex"&gt;On Mon, Nov 29, 2021 at 13:05:40 \
+0100, Elias Mobery wrote:&lt;br&gt; &gt; Hi everybody!&lt;br&gt;
&gt; &lt;br&gt;
&gt; I'm using a snapshot purely for writes and was wondering if it's \
possible&lt;br&gt; &gt; to clear/empty the snapshot after it reaches a certain size?&lt;br&gt;
&gt; &lt;br&gt;
&gt; Created with:&lt;br&gt;
&gt;   virsh snapshot-create-as   --disk-only&lt;br&gt;
&lt;br&gt;
So this creates a so-called external snapshot, which for disks means an&lt;br&gt;
overlay image.&lt;br&gt;
&lt;br&gt;
&gt; &lt;br&gt;
&gt; I tried deleting and recreating it but get an error at deletion:&lt;br&gt;
&gt; &lt;br&gt;
&gt; virsh snapshot-delete&lt;br&gt;
&lt;br&gt;
but unfortunately deleting external snapshots is not yet implemented.&lt;br&gt;
&lt;br&gt;
The usual approach is to do a block commit operation to merge the&lt;br&gt;
overlay images back into the backing image manually.&lt;br&gt;
&lt;br&gt;
The basic syntax via virsh is:&lt;br&gt;
&lt;br&gt;
   virsh blockcommit --active --pivot --verbose $VM $DISK&lt;br&gt;
&lt;br&gt;
This merges any overlay images into the backing image. Backing image is&lt;br&gt;
the most deepest nested image when you look at &lt;backingStore&gt; in the&lt;br&gt;
XML.&lt;br&gt;
&lt;br&gt;
&gt; Error: source for disk 'vda' is not a regular file&lt;br&gt;
&lt;br&gt;
This error doesn't make much sense though. The error should state that&lt;br&gt;
deletion of external snapshots is nto supported. &lt;br&gt;
&lt;br&gt;
&gt; &lt;br&gt;
&gt; I also tried virsh snapshot-create-as --no-metadata --disk-only&lt;br&gt;
&lt;br&gt;
This creates a snapshot without libvirt metadata. This means that&lt;br&gt;
libvirt just creates the overlay, but doesn't create any internal state&lt;br&gt;
related to it.&lt;br&gt;
&lt;br&gt;
It saves you the step of deleting metadata, but you still need to&lt;br&gt;
manually merge the image.&lt;br&gt;
&lt;br&gt;
&gt; &lt;br&gt;
&gt; But the same error as above pops up when trying to delete.&lt;br&gt;
&lt;br&gt;
This makes absolutely no sense though. Are you sure you are copying the&lt;br&gt;
correct error message? 'virsh snapshot-delete' works _only_ with&lt;br&gt;
snapshots which do have metadata, so if you create a snapshot without&lt;br&gt;
there's nothing to delete.&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20211130142520</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-11-30 14:25:20-0400</timestampReceived><subject>Re: Libvirt Snapshot Question</subject><body>

On Tue, Nov 30, 2021 at 14:51:54 +0100, Elias Mobery wrote:
&gt; Hello Peter, thank you so much for that detailed info!
&gt; 
&gt; Sorry, you were right, when trying to delete my external snapshot via
&gt; snapshot-delete, the error says "deletion of external snapshots unsupported"
&gt; 
&gt; I can't merge the snapshot because the VM image is in a read-only
&gt; filesystem. Sorry I should've said, it's a live system. So the image is in
&gt; the read-only squashfs and external snapshot in overlay is used for writing.

Okay, that changes the situation quite a bit:

&gt; 
&gt; Now I would like the snapshot emptied or deleted/recreated when it reaches
&gt; 4GB.
&gt; 
&gt; Is there even a way to do this with the image being read-only?

If the base image is on a read-only filesystem you obviously can't
commit to it.

Now the question is what should happen to the data in the overlay.

Discarding/recreating the overlay image is possible only once you turn
off the VM because it basically rolls back the state of the disk back to
the time when the overlay was created. This means that everything
written to the disk will be lost.

Filesystems obviously can't handle that so that's why it simply won't be
possible to do live with the root image.

You can have a second disk, which you hot-unplug, wipe the overlay and
plug it back.

Another possibility is to enable trim/discard and just simply delete the
data in the VM which was added after the overlay was created. When
trim/discard is enabled on all layers incluging the guest filesystem,
then deleting stuff inside the VM will also mean that the overlay will
shrink again.

</body></email><email><emailId>20211201173544</emailId><senderName>Elias Mobery</senderName><senderEmail>eliasmobery@gmail.com</senderEmail><timestampReceived>2021-12-01 17:35:44-0400</timestampReceived><subject>Re: Libvirt Snapshot Question</subject><body>

Hey man, I tried both suggestions, thanks again.

Option 1.) Create/attach a second qcow2 disk &amp; unplug when wiping.
This did not work unfortunately. After wiping the overlay filesystem on the
host (where the snapshots are sitting), I cannot create another snapshot, a
similar error message like before appears.

Option 2.) Enabling Discard

Now I think this worked, but I'm not sure. I read all the docs, and enabled
discard like so on the VM domain:

&lt;driver name='qemu' type='qcow2' discard='unmap'&gt;

I tried both discard=unmap and discard=on (same thing)

Then I enabled fstrim in the guest like this:
(Not entirely sure if I am missing smth)

sudo fstrim -av

Or permanently

sudo systemctl enable --now fstrim.timer


On Tue, Nov 30, 2021, 4:08 PM Elias Mobery &lt;eliasmobery@gmail.com&gt; wrote:

&gt; Hey Peter, thanks for the super quick reply, you're awesome!
&gt;
&gt; So you mean the first option would be to create a second disk instead of
&gt; using snapshot for write, when it gets too big I can then unplug the disk,
&gt; delete it (or wipe entire overlay fs) and recreate it to start fresh?
&gt;
&gt; OK I will try that, thanks for the tip!
&gt;
&gt; Option 2 with trim/discard I have to do some research, this seems a bit
&gt; more challenging.
&gt;
&gt; Thank you SO much for the great advice. I will try everything out and
&gt; report back. :-)
&gt;
&gt;
&gt; On Tue, Nov 30, 2021, 3:25 PM Peter Krempa &lt;pkrempa@redhat.com&gt; wrote:
&gt;
&gt;&gt; On Tue, Nov 30, 2021 at 14:51:54 +0100, Elias Mobery wrote:
&gt;&gt; &gt; Hello Peter, thank you so much for that detailed info!
&gt;&gt; &gt;
&gt;&gt; &gt; Sorry, you were right, when trying to delete my external snapshot via
&gt;&gt; &gt; snapshot-delete, the error says "deletion of external snapshots
&gt;&gt; unsupported"
&gt;&gt; &gt;
&gt;&gt; &gt; I can't merge the snapshot because the VM image is in a read-only
&gt;&gt; &gt; filesystem. Sorry I should've said, it's a live system. So the image is
&gt;&gt; in
&gt;&gt; &gt; the read-only squashfs and external snapshot in overlay is used for
&gt;&gt; writing.
&gt;&gt;
&gt;&gt; Okay, that changes the situation quite a bit:
&gt;&gt;
&gt;&gt; &gt;
&gt;&gt; &gt; Now I would like the snapshot emptied or deleted/recreated when it
&gt;&gt; reaches
&gt;&gt; &gt; 4GB.
&gt;&gt; &gt;
&gt;&gt; &gt; Is there even a way to do this with the image being read-only?
&gt;&gt;
&gt;&gt; If the base image is on a read-only filesystem you obviously can't
&gt;&gt; commit to it.
&gt;&gt;
&gt;&gt; Now the question is what should happen to the data in the overlay.
&gt;&gt;
&gt;&gt; Discarding/recreating the overlay image is possible only once you turn
&gt;&gt; off the VM because it basically rolls back the state of the disk back to
&gt;&gt; the time when the overlay was created. This means that everything
&gt;&gt; written to the disk will be lost.
&gt;&gt;
&gt;&gt; Filesystems obviously can't handle that so that's why it simply won't be
&gt;&gt; possible to do live with the root image.
&gt;&gt;
&gt;&gt; You can have a second disk, which you hot-unplug, wipe the overlay and
&gt;&gt; plug it back.
&gt;&gt;
&gt;&gt; Another possibility is to enable trim/discard and just simply delete the
&gt;&gt; data in the VM which was added after the overlay was created. When
&gt;&gt; trim/discard is enabled on all layers incluging the guest filesystem,
&gt;&gt; then deleting stuff inside the VM will also mean that the overlay will
&gt;&gt; shrink again.
&gt;&gt;
&gt;&gt;

[Attachment #3 (text/html)]

&lt;div dir="auto"&gt;Hey man, I tried both suggestions, thanks again.&lt;div \
dir="auto"&gt;&lt;br&gt;&lt;div dir="auto"&gt;Option 1.) Create/attach a second qcow2 disk &amp; \
unplug when wiping.&lt;/div&gt;&lt;div dir="auto"&gt;This did not work unfortunately. After \
wiping the overlay filesystem on the host (where the snapshots are sitting), I cannot \
create another snapshot, a similar error message like before appears.&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;Option 2.) Enabling Discard&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;Now I think this worked, but I'm not sure. I \
read all the docs, and enabled discard like so on the VM domain:&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;driver name='qemu' \
type='qcow2' discard='unmap'&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
dir="auto"&gt;I tried both discard=unmap and discard=on (same thing)&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;Then I enabled fstrim in the guest like \
this:&lt;/div&gt;&lt;div dir="auto"&gt;(Not entirely sure if I am missing smth)&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;pre style="font-family:sfmono-regular,menlo,monaco,consolas,"liberation \
mono","courier \
new",monospace;font-size:14px;background-color:rgb(39,40,34);border:1px solid \
rgb(235,235,235);padding:1.25rem;margin-bottom:1.25rem;color:rgb(248,248,242)"&gt;&lt;code \
style="font-family:'sfmono-regular','menlo','monaco','consolas','liberation \
mono','courier \
new',monospace;font-size:inherit;background:inherit;border:0px;padding:0px;color:inherit;white-space:inherit"&gt;sudo \
fstrim -av&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div dir="auto"&gt;Or permanently&lt;/div&gt;&lt;div dir="auto"&gt;&lt;pre \
style="font-family:sfmono-regular,menlo,monaco,consolas,"liberation \
mono","courier \
new",monospace;font-size:14px;background-color:rgb(39,40,34);border:1px solid \
rgb(235,235,235);padding:1.25rem;margin-bottom:1.25rem;color:rgb(248,248,242)"&gt;&lt;code \
style="font-family:'sfmono-regular','menlo','monaco','consolas','liberation \
mono','courier \
new',monospace;font-size:inherit;background:inherit;border:0px;padding:0px;color:inherit;white-space:inherit"&gt;sudo \
systemctl enable --now fstrim.timer&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Tue, Nov 30, 2021, 4:08 PM \
Elias Mobery &lt;&lt;a href="mailto:eliasmobery@gmail.com"&gt;eliasmobery@gmail.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 \
.8ex;border-left:1px #ccc solid;padding-left:1ex"&gt;&lt;div dir="auto"&gt;Hey Peter, thanks \
for the super quick reply, you're awesome!&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
dir="auto"&gt;So you mean the first option would be to create a second disk instead of \
using snapshot for write, when it gets too big I can then unplug the disk, delete it \
(or wipe entire overlay fs) and recreate it to start fresh?&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;OK I will try that, thanks for the \
tip!&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;Option 2 with trim/discard I have \
to do some research, this seems a bit more challenging.&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;Thank you SO much for the great advice. I will \
try everything out and report back. :-)&lt;/div&gt;&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote" \
dir="auto"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Tue, Nov 30, 2021, 3:25 PM Peter \
Krempa &lt;&lt;a href="mailto:pkrempa@redhat.com" target="_blank" \
rel="noreferrer"&gt;pkrempa@redhat.com&lt;/a&gt;&gt; wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex"&gt;On Tue, Nov 30, 2021 at 14:51:54 +0100, Elias Mobery \
wrote:&lt;br&gt; &gt; Hello Peter, thank you so much for that detailed info!&lt;br&gt;
&gt; &lt;br&gt;
&gt; Sorry, you were right, when trying to delete my external snapshot via&lt;br&gt;
&gt; snapshot-delete, the error says "deletion of external snapshots \
unsupported"&lt;br&gt; &gt; &lt;br&gt;
&gt; I can't merge the snapshot because the VM image is in a read-only&lt;br&gt;
&gt; filesystem. Sorry I should've said, it's a live system. So the image is \
in&lt;br&gt; &gt; the read-only squashfs and external snapshot in overlay is used for \
writing.&lt;br&gt; &lt;br&gt;
Okay, that changes the situation quite a bit:&lt;br&gt;
&lt;br&gt;
&gt; &lt;br&gt;
&gt; Now I would like the snapshot emptied or deleted/recreated when it reaches&lt;br&gt;
&gt; 4GB.&lt;br&gt;
&gt; &lt;br&gt;
&gt; Is there even a way to do this with the image being read-only?&lt;br&gt;
&lt;br&gt;
If the base image is on a read-only filesystem you obviously can't&lt;br&gt;
commit to it.&lt;br&gt;
&lt;br&gt;
Now the question is what should happen to the data in the overlay.&lt;br&gt;
&lt;br&gt;
Discarding/recreating the overlay image is possible only once you turn&lt;br&gt;
off the VM because it basically rolls back the state of the disk back to&lt;br&gt;
the time when the overlay was created. This means that everything&lt;br&gt;
written to the disk will be lost.&lt;br&gt;
&lt;br&gt;
Filesystems obviously can't handle that so that's why it simply won't \
be&lt;br&gt; possible to do live with the root image.&lt;br&gt;
&lt;br&gt;
You can have a second disk, which you hot-unplug, wipe the overlay and&lt;br&gt;
plug it back.&lt;br&gt;
&lt;br&gt;
Another possibility is to enable trim/discard and just simply delete the&lt;br&gt;
data in the VM which was added after the overlay was created. When&lt;br&gt;
trim/discard is enabled on all layers incluging the guest filesystem,&lt;br&gt;
then deleting stuff inside the VM will also mean that the overlay will&lt;br&gt;
shrink again.&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/blockquote&gt;&lt;/div&gt;



</body></email><email><emailId>20211202083047</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-12-02 08:30:47-0400</timestampReceived><subject>Re: Libvirt Snapshot Question</subject><body>

On Wed, Dec 01, 2021 at 18:35:44 +0100, Elias Mobery wrote:
&gt; Hey man, I tried both suggestions, thanks again.
&gt; 
&gt; Option 1.) Create/attach a second qcow2 disk &amp; unplug when wiping.
&gt; This did not work unfortunately. After wiping the overlay filesystem on the
&gt; host (where the snapshots are sitting), I cannot create another snapshot, a
&gt; similar error message like before appears.

Okay, that's weird. Could you please post your exact steps?

Additionally if you have a new enough libvirt you can actually possibly
even try using a disk with &lt;transient/&gt;. This transparently creates a
overlay (in the same path as the image though, not sure if it suits your
setup) and automatically discards it when unplugging or shutting down
the VM.

In such case you could simply unplug and replug the disk, but note that
this feature was implemented only this year IIRC, so you need a fairly
recent libvirt to do so.

&gt; 
&gt; Option 2.) Enabling Discard
&gt; 
&gt; Now I think this worked, but I'm not sure. I read all the docs, and enabled
&gt; discard like so on the VM domain:
&gt; 
&gt; &lt;driver name='qemu' type='qcow2' discard='unmap'&gt;

This is the correct setting. Unmap means that the qcow2 image should
unmap the blocks which were discarded.

&gt; 
&gt; I tried both discard=unmap and discard=on (same thing)
&gt; 
&gt; Then I enabled fstrim in the guest like this:
&gt; (Not entirely sure if I am missing smth)
&gt; 
&gt; sudo fstrim -av
&gt; 
&gt; Or permanently
&gt; 
&gt; sudo systemctl enable --now fstrim.timer

Yup, both should do fine. Now if you delete something in the VM (which
would result in freeing blocks in the overlay; deleting something from
the base image won't help obviously) the overlay image should shrink.

</body></email><email><emailId>20211202152700</emailId><senderName>Elias Mobery</senderName><senderEmail>eliasmobery@gmail.com</senderEmail><timestampReceived>2021-12-02 15:27:00-0400</timestampReceived><subject>Re: Libvirt Snapshot Question</subject><body>

OK, so I tried both ways. (The VM image is in the read-only squashfs.)

1.) Editing VM domain XML:
    &lt;disk&gt;

    &lt;transient/&gt;
    &lt;/disk&gt;

Error:  Internal Error - Could not open
/var/lib/libvirt/images/vm.snapshot1 : Permission Denied

I chowned everything to libvirt but no changes. Maybe a read-only conflict?

2.) Adding second disk to VM domain XML
(shortened )

 &lt;disk&gt;
    source /var/lib..../images/vm.qcow2
    target dev=vda
 &lt;/disk&gt;


 &lt;disk&gt;
     source /var/lib...../images/vm.qcow2
     target dev=vdb
    &lt;transient/&gt;
 &lt;/disk&gt;

Error: unsupported configuration: cannot create external snapshot for disk
vdb - collision with disk vdb.

After googling I found that a lot of people get permission denied errors
using transient. I will keep looking, really not sure.

On Thu, Dec 2, 2021, 9:30 AM Peter Krempa &lt;pkrempa@redhat.com&gt; wrote:

&gt; On Wed, Dec 01, 2021 at 18:35:44 +0100, Elias Mobery wrote:
&gt; &gt; Hey man, I tried both suggestions, thanks again.
&gt; &gt;
&gt; &gt; Option 1.) Create/attach a second qcow2 disk &amp; unplug when wiping.
&gt; &gt; This did not work unfortunately. After wiping the overlay filesystem on
&gt; the
&gt; &gt; host (where the snapshots are sitting), I cannot create another
&gt; snapshot, a
&gt; &gt; similar error message like before appears.
&gt;
&gt; Okay, that's weird. Could you please post your exact steps?
&gt;
&gt; Additionally if you have a new enough libvirt you can actually possibly
&gt; even try using a disk with &lt;transient/&gt;. This transparently creates a
&gt; overlay (in the same path as the image though, not sure if it suits your
&gt; setup) and automatically discards it when unplugging or shutting down
&gt; the VM.
&gt;
&gt; In such case you could simply unplug and replug the disk, but note that
&gt; this feature was implemented only this year IIRC, so you need a fairly
&gt; recent libvirt to do so.
&gt;
&gt; &gt;
&gt; &gt; Option 2.) Enabling Discard
&gt; &gt;
&gt; &gt; Now I think this worked, but I'm not sure. I read all the docs, and
&gt; enabled
&gt; &gt; discard like so on the VM domain:
&gt; &gt;
&gt; &gt; &lt;driver name='qemu' type='qcow2' discard='unmap'&gt;
&gt;
&gt; This is the correct setting. Unmap means that the qcow2 image should
&gt; unmap the blocks which were discarded.
&gt;
&gt; &gt;
&gt; &gt; I tried both discard=unmap and discard=on (same thing)
&gt; &gt;
&gt; &gt; Then I enabled fstrim in the guest like this:
&gt; &gt; (Not entirely sure if I am missing smth)
&gt; &gt;
&gt; &gt; sudo fstrim -av
&gt; &gt;
&gt; &gt; Or permanently
&gt; &gt;
&gt; &gt; sudo systemctl enable --now fstrim.timer
&gt;
&gt; Yup, both should do fine. Now if you delete something in the VM (which
&gt; would result in freeing blocks in the overlay; deleting something from
&gt; the base image won't help obviously) the overlay image should shrink.
&gt;
&gt;

[Attachment #3 (text/html)]

&lt;div dir="auto"&gt;OK, so I tried both ways. (The VM image is in the read-only \
squashfs.)&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;1.) Editing VM domain \
XML:&lt;/div&gt;&lt;div dir="auto"&gt;      &lt;disk&gt;&lt;/div&gt;&lt;div dir="auto"&gt;              \
&lt;/div&gt;&lt;div dir="auto"&gt;      &lt;transient/&gt;&lt;/div&gt;&lt;div dir="auto"&gt;      \
&lt;/disk&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;Error:   Internal Error \
- Could not open /var/lib/libvirt/images/vm.snapshot1 : Permission Denied&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;I chowned everything to libvirt but no changes. \
Maybe a read-only conflict?&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;2.) Adding \
second disk to VM domain XML&lt;/div&gt;&lt;div dir="auto"&gt;(shortened )&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;div dir="auto" style="font-family:sans-serif"&gt;  \
&lt;disk&gt;&lt;/div&gt;&lt;div dir="auto" style="font-family:sans-serif"&gt;      source \
/var/lib..../images/vm.qcow2&lt;/div&gt;&lt;div dir="auto" style="font-family:sans-serif"&gt;     \
target dev=vda&lt;/div&gt;&lt;div dir="auto" style="font-family:sans-serif"&gt;  \
&lt;/disk&gt;&lt;/div&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;div dir="auto" style="font-family:sans-serif"&gt;  &lt;disk&gt;&lt;/div&gt;&lt;div \
dir="auto" style="font-family:sans-serif"&gt;        source \
/var/lib...../images/vm.qcow2&lt;/div&gt;&lt;div dir="auto" style="font-family:sans-serif"&gt;    \
target dev=vdb&lt;/div&gt;&lt;div dir="auto" style="font-family:sans-serif"&gt;      \
&lt;transient/&gt;&lt;/div&gt;&lt;div dir="auto" style="font-family:sans-serif"&gt;  \
&lt;/disk&gt;&lt;/div&gt;&lt;div dir="auto" style="font-family:sans-serif"&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
dir="auto" style="font-family:sans-serif"&gt;Error: unsupported configuration: cannot \
create external snapshot for disk vdb - collision with disk vdb.&lt;/div&gt;&lt;div dir="auto" \
style="font-family:sans-serif"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto" \
style="font-family:sans-serif"&gt;After googling I found that a lot of people get \
permission denied errors using transient. I will keep looking, really not \
sure.&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" \
class="gmail_attr"&gt;On Thu, Dec 2, 2021, 9:30 AM Peter Krempa &lt;&lt;a \
href="mailto:pkrempa@redhat.com" target="_blank" \
rel="noreferrer"&gt;pkrempa@redhat.com&lt;/a&gt;&gt; wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex"&gt;On Wed, Dec 01, 2021 at 18:35:44 +0100, Elias Mobery \
wrote:&lt;br&gt; &gt; Hey man, I tried both suggestions, thanks again.&lt;br&gt;
&gt; &lt;br&gt;
&gt; Option 1.) Create/attach a second qcow2 disk &amp; unplug when wiping.&lt;br&gt;
&gt; This did not work unfortunately. After wiping the overlay filesystem on the&lt;br&gt;
&gt; host (where the snapshots are sitting), I cannot create another snapshot, a&lt;br&gt;
&gt; similar error message like before appears.&lt;br&gt;
&lt;br&gt;
Okay, that's weird. Could you please post your exact steps?&lt;br&gt;
&lt;br&gt;
Additionally if you have a new enough libvirt you can actually possibly&lt;br&gt;
even try using a disk with &lt;transient/&gt;. This transparently creates a&lt;br&gt;
overlay (in the same path as the image though, not sure if it suits your&lt;br&gt;
setup) and automatically discards it when unplugging or shutting down&lt;br&gt;
the VM.&lt;br&gt;
&lt;br&gt;
In such case you could simply unplug and replug the disk, but note that&lt;br&gt;
this feature was implemented only this year IIRC, so you need a fairly&lt;br&gt;
recent libvirt to do so.&lt;br&gt;
&lt;br&gt;
&gt; &lt;br&gt;
&gt; Option 2.) Enabling Discard&lt;br&gt;
&gt; &lt;br&gt;
&gt; Now I think this worked, but I'm not sure. I read all the docs, and \
enabled&lt;br&gt; &gt; discard like so on the VM domain:&lt;br&gt;
&gt; &lt;br&gt;
&gt; &lt;driver name='qemu' type='qcow2' \
discard='unmap'&gt;&lt;br&gt; &lt;br&gt;
This is the correct setting. Unmap means that the qcow2 image should&lt;br&gt;
unmap the blocks which were discarded.&lt;br&gt;
&lt;br&gt;
&gt; &lt;br&gt;
&gt; I tried both discard=unmap and discard=on (same thing)&lt;br&gt;
&gt; &lt;br&gt;
&gt; Then I enabled fstrim in the guest like this:&lt;br&gt;
&gt; (Not entirely sure if I am missing smth)&lt;br&gt;
&gt; &lt;br&gt;
&gt; sudo fstrim -av&lt;br&gt;
&gt; &lt;br&gt;
&gt; Or permanently&lt;br&gt;
&gt; &lt;br&gt;
&gt; sudo systemctl enable --now fstrim.timer&lt;br&gt;
&lt;br&gt;
Yup, both should do fine. Now if you delete something in the VM (which&lt;br&gt;
would result in freeing blocks in the overlay; deleting something from&lt;br&gt;
the base image won't help obviously) the overlay image should shrink.&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;



</body></email><email><emailId>20211003220510</emailId><senderName>Marc</senderName><senderEmail>marc@f1-outsourcing.eu</senderEmail><timestampReceived>2021-10-03 22:05:10-0400</timestampReceived><subject>how/where to configure access to libvirt-sock-ro</subject><body>


I wanted to create a monitoring user that can do some reporting like this:

runuser -u xxxxx  -- prometheus-libvirt-exporter -libvirt.uri /var/run/libvirt/libvirt-sock-ro

But I am getting the 
failed to connect: authentication required

</body></email><email><emailId>20211220103455</emailId><senderName>Dana Elfassy</senderName><senderEmail>delfassy@redhat.com</senderEmail><timestampReceived>2021-12-20 10:34:55-0400</timestampReceived><subject>error during host deploy</subject><body>

[Attachment #2 (multipart/alternative)]


Hi,
While running a test case of adding hosts on ovirt system tests there was a
failure while the following command was executed:
vdsm-tool configure --force

On libvirtd log I found this error:

2021-12-17 00:11:41.753+0000: 28031: error : virNetTLSContextNew:732 :
Unable to generate diffie-hellman parameters: Error in public key
generation.

How would you suggest to debug this failure?
attaching libvirtd &amp; journalctl logs
libvirt version: 7.10.0, package: 1.module_el8.6.0+1046+bd8eec5e

Thanks,
Dana

The error from host deploy log:

"2021-12-17 01":"11":"45 CET - fatal":[
   ost-basic-suite-master-host-0
]:"FAILED! =&gt;"{
   "changed":true,
   "cmd":[
      "vdsm-tool",
      "configure",
      "--force"
   ],
   "delta":"0:00:06.908971",
   "end":"2021-12-17 01:11:42.815057",
   "msg":"non-zero return code",
   "rc":1,
   "start":"2021-12-17 01:11:35.906086",
   "stderr":"Error:  ServiceOperationError: _systemctlStart
failed\nb'Job for libvirtd.service failed because a fatal signal was
delivered causing the control process to dump core.\\nSee \"systemctl
status libvirtd.service\" and \"journalctl -xe\" for details.\\n' ",
   "stderr_lines":[
      "Error:  ServiceOperationError: _systemctlStart failed",
      "b'Job for libvirtd.service failed because a fatal signal was
delivered causing the control process to dump core.\\nSee \"systemctl
status libvirtd.service\" and \"journalctl -xe\" for details.\\n' "
   ],
   "stdout":"\nChecking configuration status...\n\nlvm is configured
for vdsm\nCurrent revision of multipath.conf detected,
preserving\nlibvirt is already configured for vdsm\nSUCCESS: ssl
configured to true. No conflicts\nsanlock is configured for
vdsm\nManaged volume database is already configured\n\nRunning
configure...\nReconfiguration of libvirt is done.\nReconfiguration of
passwd is done.",
   "stdout_lines":[
      "",
      "Checking configuration status...",
      "",
      "lvm is configured for vdsm",
      "Current revision of multipath.conf detected, preserving",
      "libvirt is already configured for vdsm",
      "SUCCESS: ssl configured to true. No conflicts",
      "sanlock is configured for vdsm",
      "Managed volume database is already configured",
      "",
      "Running configure...",
      "Reconfiguration of libvirt is done.",
      "Reconfiguration of passwd is done."
   ]
}

[Attachment #5 (text/html)]

&lt;div dir="ltr"&gt;Hi,&lt;div&gt;While running a test case of adding hosts on ovirt system \
tests there was a failure while the following command was executed:&lt;br&gt;vdsm-tool \
configure --force&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;On libvirtd log I found this \
error:&lt;/div&gt;&lt;div&gt;&lt;pre style=""&gt;&lt;font color="#000000" \
style="white-space:pre-wrap"&gt;2021-12-17 00:11:41.753+0000: 28031: error : \
virNetTLSContextNew:732 : Unable to generate diffie-hellman parameters: Error in \
public key generation.&lt;/font&gt; &lt;/pre&gt;&lt;font face="arial, sans-serif"&gt;How would you \
suggest to debug this failure?&lt;br&gt;attaching libvirtd &amp; journalctl \
logs&lt;/font&gt;&lt;/div&gt;&lt;div&gt;libvirt version: 7.10.0, package: \
1.module_el8.6.0+1046+bd8eec5e&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;Dana&lt;br&gt;&lt;pre \
style=""&gt;&lt;span style="white-space:pre-wrap;font-family:Arial,Helvetica,sans-serif"&gt;The \
error from host deploy log:&lt;/span&gt;&lt;span \
style="white-space:pre-wrap"&gt;&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div&gt;&lt;pre \
style="white-space:pre-wrap;color:rgb(0,0,0)"&gt;"2021-12-17 \
01":"11":"45 CET - fatal":[&lt;br&gt;     \
ost-basic-suite-master-host-0&lt;br&gt;]:"FAILED! =&gt;"{&lt;br&gt;     \
"changed":true,&lt;br&gt;     "cmd":[&lt;br&gt;         \
"vdsm-tool",&lt;br&gt;         "configure",&lt;br&gt;         \
"--force"&lt;br&gt;     ],&lt;br&gt;     \
"delta":"0:00:06.908971",&lt;br&gt;     \
"end":"2021-12-17 01:11:42.815057",&lt;br&gt;     \
"msg":"non-zero return code",&lt;br&gt;     "rc":1,&lt;br&gt;     \
"start":"2021-12-17 01:11:35.906086",&lt;br&gt;     \
"stderr":"Error:   ServiceOperationError: _systemctlStart \
failed\nb'Job for libvirtd.service failed because a fatal signal was delivered \
causing the control process to dump core.\\nSee \"systemctl status \
libvirtd.service\" and \"journalctl -xe\" for details.\\n' \
",&lt;br&gt;     "stderr_lines":[&lt;br&gt;         "Error:   \
ServiceOperationError: _systemctlStart failed",&lt;br&gt;         "b'Job for \
libvirtd.service failed because a fatal signal was delivered causing the control \
process to dump core.\\nSee \"systemctl status libvirtd.service\" and \
\"journalctl -xe\" for details.\\n' "&lt;br&gt;     ],&lt;br&gt;     \
"stdout":"\nChecking configuration status...\n\nlvm is configured for \
vdsm\nCurrent revision of multipath.conf detected, preserving\nlibvirt is already \
configured for vdsm\nSUCCESS: ssl configured to true. No conflicts\nsanlock is \
configured for vdsm\nManaged volume database is already configured\n\nRunning \
configure...\nReconfiguration of libvirt is done.\nReconfiguration of passwd is \
done.",&lt;br&gt;     "stdout_lines":[&lt;br&gt;         "",&lt;br&gt;         \
"Checking configuration status...",&lt;br&gt;         "",&lt;br&gt;         \
"lvm is configured for vdsm",&lt;br&gt;         "Current revision of \
multipath.conf detected, preserving",&lt;br&gt;         "libvirt is already \
configured for vdsm",&lt;br&gt;         "SUCCESS: ssl configured to true. No \
conflicts",&lt;br&gt;         "sanlock is configured for vdsm",&lt;br&gt;         \
"Managed volume database is already configured",&lt;br&gt;         \
"",&lt;br&gt;         "Running configure...",&lt;br&gt;         \
"Reconfiguration of libvirt is done.",&lt;br&gt;         "Reconfiguration of \
passwd is done."&lt;br&gt;     ]&lt;br&gt;}&lt;br&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;


["libvirt.log" (text/x-log)]

2021-12-17 00:11:41.668+0000: 28031: info : libvirt version: 7.10.0, package: \
1.module_el8.6.0+1046+bd8eec5e (CentOS Buildsys &lt;bugs@centos.org&gt;, \
2021-12-13-15:33:57, ) 2021-12-17 00:11:41.668+0000: 28031: info : hostname: \
ost-basic-suite-master-host-0 2021-12-17 00:11:41.668+0000: 28031: debug : main:966 : \
Decided on pid file path '/run/libvirtd.pid' 2021-12-17 00:11:41.668+0000: 28031: \
debug : main:980 : Decided on socket paths '/run/libvirt/libvirt-sock', \
'/run/libvirt/libvirt-sock-ro' and '/run/libvirt/libvirt-admin-sock' 2021-12-17 \
00:11:41.668+0000: 28031: debug : main:1012 : Ensuring run dir '/run/libvirt' exists \
2021-12-17 00:11:41.668+0000: 28031: debug : virNetlinkStartup:175 : Running global \
netlink initialization 2021-12-17 00:11:41.668+0000: 28031: debug : \
virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/connection-driver/libvirt_driver_network.so' 2021-12-17 \
00:11:41.668+0000: 28031: debug : virUpdateSelfLastChanged:1507 : Setting self last \
changed to 1639621441 for \
'/usr/lib64/libvirt/connection-driver/libvirt_driver_network.so' 2021-12-17 \
00:11:41.669+0000: 28031: debug : virModuleLoadFunc:69 : Lookup function \
'networkRegister' 2021-12-17 00:11:41.669+0000: 28031: debug : \
virRegisterConnectDriver:522 : driver=0x7f139574c0c0 name=network 2021-12-17 \
00:11:41.669+0000: 28031: debug : virRegisterConnectDriver:533 : registering network \
as driver 3 2021-12-17 00:11:41.669+0000: 28031: debug : \
virSetSharedNetworkDriver:370 : registering bridge as network driver 2021-12-17 \
00:11:41.669+0000: 28031: debug : virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/connection-driver/libvirt_driver_interface.so' 2021-12-17 \
00:11:41.670+0000: 28033: debug : virThreadJobSetWorker:75 : Thread 28033 is running \
worker rpc-worker 2021-12-17 00:11:41.671+0000: 28034: debug : \
virThreadJobSetWorker:75 : Thread 28034 is running worker rpc-worker 2021-12-17 \
00:11:41.672+0000: 28038: debug : virThreadJobSetWorker:75 : Thread 28038 is running \
worker prio-rpc-worker 2021-12-17 00:11:41.673+0000: 28040: debug : \
virThreadJobSetWorker:75 : Thread 28040 is running worker prio-rpc-worker 2021-12-17 \
00:11:41.673+0000: 28035: debug : virThreadJobSetWorker:75 : Thread 28035 is running \
worker rpc-worker 2021-12-17 00:11:41.674+0000: 28032: debug : \
virThreadJobSetWorker:75 : Thread 28032 is running worker rpc-worker 2021-12-17 \
00:11:41.674+0000: 28036: debug : virThreadJobSetWorker:75 : Thread 28036 is running \
worker rpc-worker 2021-12-17 00:11:41.675+0000: 28037: debug : \
virThreadJobSetWorker:75 : Thread 28037 is running worker prio-rpc-worker 2021-12-17 \
00:11:41.676+0000: 28039: debug : virThreadJobSetWorker:75 : Thread 28039 is running \
worker prio-rpc-worker 2021-12-17 00:11:41.677+0000: 28041: debug : \
virThreadJobSetWorker:75 : Thread 28041 is running worker prio-rpc-worker 2021-12-17 \
00:11:41.719+0000: 28031: debug : virModuleLoadFunc:69 : Lookup function \
'interfaceRegister' 2021-12-17 00:11:41.719+0000: 28031: debug : \
virRegisterConnectDriver:522 : driver=0x7f139552d040 name=interface 2021-12-17 \
00:11:41.719+0000: 28031: debug : virRegisterConnectDriver:533 : registering \
interface as driver 4 2021-12-17 00:11:41.719+0000: 28031: debug : \
virSetSharedInterfaceDriver:396 : registering netcf as interface driver 2021-12-17 \
00:11:41.719+0000: 28031: debug : virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/connection-driver/libvirt_driver_secret.so' 2021-12-17 \
00:11:41.720+0000: 28031: debug : virModuleLoadFunc:69 : Lookup function \
'secretRegister' 2021-12-17 00:11:41.720+0000: 28031: debug : \
virRegisterConnectDriver:522 : driver=0x7f1393dce040 name=secret 2021-12-17 \
00:11:41.720+0000: 28031: debug : virRegisterConnectDriver:533 : registering secret \
as driver 5 2021-12-17 00:11:41.720+0000: 28031: debug : virSetSharedSecretDriver:474 \
: registering secret as secret driver 2021-12-17 00:11:41.720+0000: 28031: debug : \
virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/connection-driver/libvirt_driver_storage.so' 2021-12-17 \
00:11:41.720+0000: 28031: debug : virModuleLoadFunc:69 : Lookup function \
'storageRegister' 2021-12-17 00:11:41.720+0000: 28031: debug : \
virRegisterConnectDriver:522 : driver=0x7f1393bc8040 name=storage 2021-12-17 \
00:11:41.720+0000: 28031: debug : virRegisterConnectDriver:533 : registering storage \
as driver 6 2021-12-17 00:11:41.720+0000: 28031: debug : virModuleLoadFile:48 : Load \
module file '/usr/lib64/libvirt/storage-backend/libvirt_storage_backend_fs.so' \
2021-12-17 00:11:41.720+0000: 28031: debug : virModuleLoadFunc:69 : Lookup function \
'virStorageBackendFsRegister' 2021-12-17 00:11:41.720+0000: 28031: debug : \
virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/storage-backend/libvirt_storage_backend_logical.so' 2021-12-17 \
00:11:41.721+0000: 28031: debug : virModuleLoadFunc:69 : Lookup function \
'virStorageBackendLogicalRegister' 2021-12-17 00:11:41.721+0000: 28031: debug : \
virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/storage-backend/libvirt_storage_backend_iscsi.so' 2021-12-17 \
00:11:41.721+0000: 28031: debug : virModuleLoadFunc:69 : Lookup function \
'virStorageBackendISCSIRegister' 2021-12-17 00:11:41.721+0000: 28031: debug : \
virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/storage-backend/libvirt_storage_backend_iscsi-direct.so' \
2021-12-17 00:11:41.722+0000: 28031: debug : virModuleLoadFunc:69 : Lookup function \
'virStorageBackendISCSIDirectRegister' 2021-12-17 00:11:41.722+0000: 28031: debug : \
virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/storage-backend/libvirt_storage_backend_scsi.so' 2021-12-17 \
00:11:41.722+0000: 28031: debug : virModuleLoadFunc:69 : Lookup function \
'virStorageBackendSCSIRegister' 2021-12-17 00:11:41.722+0000: 28031: debug : \
virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/storage-backend/libvirt_storage_backend_mpath.so' 2021-12-17 \
00:11:41.723+0000: 28031: debug : virModuleLoadFunc:69 : Lookup function \
'virStorageBackendMpathRegister' 2021-12-17 00:11:41.723+0000: 28031: debug : \
virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/storage-backend/libvirt_storage_backend_disk.so' 2021-12-17 \
00:11:41.723+0000: 28031: debug : virModuleLoadFunc:69 : Lookup function \
'virStorageBackendDiskRegister' 2021-12-17 00:11:41.723+0000: 28031: debug : \
virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/storage-backend/libvirt_storage_backend_rbd.so' 2021-12-17 \
00:11:41.740+0000: 28031: debug : virModuleLoadFunc:69 : Lookup function \
'virStorageBackendRBDRegister' 2021-12-17 00:11:41.740+0000: 28031: debug : \
virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/storage-backend/libvirt_storage_backend_gluster.so' 2021-12-17 \
00:11:41.746+0000: 28031: debug : virModuleLoadFunc:69 : Lookup function \
'virStorageBackendGlusterRegister' 2021-12-17 00:11:41.746+0000: 28031: debug : \
virSetSharedStorageDriver:422 : registering storage as storage driver 2021-12-17 \
00:11:41.746+0000: 28031: debug : virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/connection-driver/libvirt_driver_nodedev.so' 2021-12-17 \
00:11:41.746+0000: 28031: debug : virModuleLoadFunc:69 : Lookup function \
'nodedevRegister' 2021-12-17 00:11:41.746+0000: 28031: debug : \
virRegisterConnectDriver:522 : driver=0x7f138a1e7060 name=nodedev 2021-12-17 \
00:11:41.746+0000: 28031: debug : virRegisterConnectDriver:533 : registering nodedev \
as driver 7 2021-12-17 00:11:41.746+0000: 28031: debug : \
virSetSharedNodeDeviceDriver:448 : registering udev as device driver 2021-12-17 \
00:11:41.746+0000: 28031: debug : virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/connection-driver/libvirt_driver_nwfilter.so' 2021-12-17 \
00:11:41.747+0000: 28031: debug : virModuleLoadFunc:69 : Lookup function \
'nwfilterRegister' 2021-12-17 00:11:41.747+0000: 28031: debug : \
virRegisterConnectDriver:522 : driver=0x7f1389dc7040 name=nwfilter 2021-12-17 \
00:11:41.747+0000: 28031: debug : virRegisterConnectDriver:533 : registering nwfilter \
as driver 8 2021-12-17 00:11:41.747+0000: 28031: debug : \
virSetSharedNWFilterDriver:500 : registering nwfilter as network filter driver \
2021-12-17 00:11:41.747+0000: 28031: debug : virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/connection-driver/libvirt_driver_qemu.so' 2021-12-17 \
00:11:41.749+0000: 28031: debug : virModuleLoadFunc:69 : Lookup function \
'qemuRegister' 2021-12-17 00:11:41.749+0000: 28031: debug : \
virRegisterConnectDriver:522 : driver=0x7f138995f000 name=QEMU 2021-12-17 \
00:11:41.749+0000: 28031: debug : virRegisterConnectDriver:533 : registering QEMU as \
driver 9 2021-12-17 00:11:41.750+0000: 28031: debug : main:1142 : Attempting to \
configure auditing subsystem 2021-12-17 00:11:41.750+0000: 28042: debug : \
virThreadJobSetWorker:75 : Thread 28042 is running worker rpc-worker 2021-12-17 \
00:11:41.750+0000: 28031: debug : virHookCheck:161 : No hook script \
/etc/libvirt/hooks/daemon 2021-12-17 00:11:41.750+0000: 28031: debug : \
virHookCheck:172 : Hook dir /etc/libvirt/hooks/daemon.d is not accessible 2021-12-17 \
00:11:41.750+0000: 28031: debug : virHookCheck:165 : Found hook script \
/etc/libvirt/hooks/qemu 2021-12-17 00:11:41.750+0000: 28031: debug : virHookCheck:161 \
: No hook script /etc/libvirt/hooks/lxc 2021-12-17 00:11:41.750+0000: 28031: debug : \
virHookCheck:172 : Hook dir /etc/libvirt/hooks/lxc.d is not accessible 2021-12-17 \
00:11:41.750+0000: 28031: debug : virHookCheck:161 : No hook script \
/etc/libvirt/hooks/network 2021-12-17 00:11:41.750+0000: 28031: debug : \
virHookCheck:172 : Hook dir /etc/libvirt/hooks/network.d is not accessible 2021-12-17 \
00:11:41.750+0000: 28031: debug : virHookCheck:161 : No hook script \
/etc/libvirt/hooks/libxl 2021-12-17 00:11:41.750+0000: 28031: debug : \
virHookCheck:172 : Hook dir /etc/libvirt/hooks/libxl.d is not accessible 2021-12-17 \
00:11:41.750+0000: 28031: debug : virHookCheck:161 : No hook script \
/etc/libvirt/hooks/bhyve 2021-12-17 00:11:41.750+0000: 28031: debug : \
virHookCheck:172 : Hook dir /etc/libvirt/hooks/bhyve.d is not accessible 2021-12-17 \
00:11:41.751+0000: 28031: debug : virSystemdGetListenFDs:901 : Setting up networking \
from caller 2021-12-17 00:11:41.751+0000: 28031: debug : virSystemdGetListenFDs:932 : \
Got 4 file descriptors 2021-12-17 00:11:41.751+0000: 28031: debug : \
virSystemdGetListenFDs:937 : Disabling inheritance of passed FD 3 2021-12-17 \
00:11:41.751+0000: 28031: debug : virSystemdGetListenFDs:937 : Disabling inheritance \
of passed FD 4 2021-12-17 00:11:41.751+0000: 28031: debug : \
virSystemdGetListenFDs:937 : Disabling inheritance of passed FD 5 2021-12-17 \
00:11:41.751+0000: 28031: debug : virSystemdGetListenFDs:937 : Disabling inheritance \
of passed FD 6 2021-12-17 00:11:41.751+0000: 28031: debug : \
virSystemdActivationNew:964 : Activated with 4 FDs 2021-12-17 00:11:41.751+0000: \
28031: debug : virSystemdActivationInitFromNames:758 : FD names \
libvirtd-admin.socket:libvirtd-ro.socket:libvirtd.socket:libvirtd-tls.socket \
2021-12-17 00:11:41.751+0000: 28031: debug : virSystemdActivationAddFD:730 : Record \
first FD 3 with name libvirtd-admin.socket 2021-12-17 00:11:41.751+0000: 28031: debug \
: virSystemdActivationAddFD:730 : Record first FD 4 with name libvirtd-ro.socket \
2021-12-17 00:11:41.751+0000: 28031: debug : virSystemdActivationAddFD:730 : Record \
first FD 5 with name libvirtd.socket 2021-12-17 00:11:41.751+0000: 28031: debug : \
virSystemdActivationAddFD:730 : Record first FD 6 with name libvirtd-tls.socket \
2021-12-17 00:11:41.751+0000: 28031: debug : virSystemdActivationNew:977 : Created \
activation object for 4 FDs 2021-12-17 00:11:41.751+0000: 28031: debug : \
virSystemdActivationClaimFDs:1090 : Found 1 FDs with name libvirtd.socket 2021-12-17 \
00:11:41.751+0000: 28031: debug : virSystemdActivationClaimFDs:1090 : Found 1 FDs \
with name libvirtd-ro.socket 2021-12-17 00:11:41.751+0000: 28031: debug : \
virSystemdActivationClaimFDs:1090 : Found 1 FDs with name libvirtd-admin.socket \
2021-12-17 00:11:41.751+0000: 28031: debug : virSystemdActivationClaimFDs:1086 : No \
FD with name libvirtd-tcp.socket 2021-12-17 00:11:41.751+0000: 28031: debug : \
daemonSetupNetworking:364 : Using CA='/etc/pki/vdsm/certs/cacert.pem' \
cert='/etc/pki/vdsm/certs/vdsmcert.pem' key='/etc/pki/vdsm/keys/vdsmkey.pem' \
2021-12-17 00:11:41.751+0000: 28043: debug : virThreadJobSetWorker:75 : Thread 28043 \
is running worker rpc-worker 2021-12-17 00:11:41.751+0000: 28045: debug : \
virThreadJobSetWorker:75 : Thread 28045 is running worker rpc-worker 2021-12-17 \
00:11:41.752+0000: 28044: debug : virThreadJobSetWorker:75 : Thread 28044 is running \
worker rpc-worker 2021-12-17 00:11:41.753+0000: 28046: debug : \
virThreadJobSetWorker:75 : Thread 28046 is running worker rpc-worker 2021-12-17 \
00:11:41.753+0000: 28031: error : virNetTLSContextNew:732 : Unable to generate \
diffie-hellman parameters: Error in public key generation. 2021-12-17 \
00:11:42.949+0000: 28055: info : libvirt version: 7.10.0, package: \
1.module_el8.6.0+1046+bd8eec5e (CentOS Buildsys &lt;bugs@centos.org&gt;, \
2021-12-13-15:33:57, ) 2021-12-17 00:11:42.949+0000: 28055: info : hostname: \
ost-basic-suite-master-host-0 2021-12-17 00:11:42.949+0000: 28055: debug : main:966 : \
Decided on pid file path '/run/libvirtd.pid' 2021-12-17 00:11:42.949+0000: 28055: \
debug : main:980 : Decided on socket paths '/run/libvirt/libvirt-sock', \
'/run/libvirt/libvirt-sock-ro' and '/run/libvirt/libvirt-admin-sock' 2021-12-17 \
00:11:42.949+0000: 28055: debug : main:1012 : Ensuring run dir '/run/libvirt' exists \
2021-12-17 00:11:42.949+0000: 28055: debug : virNetlinkStartup:175 : Running global \
netlink initialization 2021-12-17 00:11:42.950+0000: 28055: debug : \
virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/connection-driver/libvirt_driver_network.so' 2021-12-17 \
00:11:42.950+0000: 28055: debug : virUpdateSelfLastChanged:1507 : Setting self last \
changed to 1639621441 for \
'/usr/lib64/libvirt/connection-driver/libvirt_driver_network.so' 2021-12-17 \
00:11:42.950+0000: 28055: debug : virModuleLoadFunc:69 : Lookup function \
'networkRegister' 2021-12-17 00:11:42.950+0000: 28055: debug : \
virRegisterConnectDriver:522 : driver=0x7f49966950c0 name=network 2021-12-17 \
00:11:42.950+0000: 28055: debug : virRegisterConnectDriver:533 : registering network \
as driver 3 2021-12-17 00:11:42.950+0000: 28055: debug : \
virSetSharedNetworkDriver:370 : registering bridge as network driver 2021-12-17 \
00:11:42.950+0000: 28055: debug : virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/connection-driver/libvirt_driver_interface.so' 2021-12-17 \
00:11:42.951+0000: 28061: debug : virThreadJobSetWorker:75 : Thread 28061 is running \
worker prio-rpc-worker 2021-12-17 00:11:42.951+0000: 28056: debug : \
virThreadJobSetWorker:75 : Thread 28056 is running worker rpc-worker 2021-12-17 \
00:11:42.952+0000: 28057: debug : virThreadJobSetWorker:75 : Thread 28057 is running \
worker rpc-worker 2021-12-17 00:11:42.952+0000: 28058: debug : \
virThreadJobSetWorker:75 : Thread 28058 is running worker rpc-worker 2021-12-17 \
00:11:42.952+0000: 28062: debug : virThreadJobSetWorker:75 : Thread 28062 is running \
2021-12-17 00:11:42.952+0000: 28059: debug : virThreadJobSetWorker:75 : Thread 28059 \
is running worker rpc-worker 2021-12-17 00:11:42.952+0000: 28065: debug : \
virThreadJobSetWorker:75 : Thread 28065 is running worker prio-rpc-worker 2021-12-17 \
00:11:42.953+0000: 28064: debug : virThreadJobSetWorker:75 : Thread 28064 is running \
worker prio-rpc-worker 2021-12-17 00:11:42.953+0000: 28063: debug : \
virThreadJobSetWorker:75 : Thread 28063 is running worker prio-rpc-worker 2021-12-17 \
00:11:43.006+0000: 28055: debug : virModuleLoadFunc:69 : Lookup function \
'interfaceRegister' 2021-12-17 00:11:43.006+0000: 28055: debug : \
virRegisterConnectDriver:522 : driver=0x7f4996476040 name=interface 2021-12-17 \
00:11:43.006+0000: 28055: debug : virRegisterConnectDriver:533 : registering \
interface as driver 4 2021-12-17 00:11:43.006+0000: 28055: debug : \
virSetSharedInterfaceDriver:396 : registering netcf as interface driver 2021-12-17 \
00:11:43.007+0000: 28055: debug : virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/connection-driver/libvirt_driver_secret.so' 2021-12-17 \
00:11:43.007+0000: 28055: debug : virModuleLoadFunc:69 : Lookup function \
'secretRegister' 2021-12-17 00:11:43.007+0000: 28055: debug : \
virRegisterConnectDriver:522 : driver=0x7f49a0699040 name=secret 2021-12-17 \
00:11:43.007+0000: 28055: debug : virRegisterConnectDriver:533 : registering secret \
as driver 5 2021-12-17 00:11:43.007+0000: 28055: debug : virSetSharedSecretDriver:474 \
: registering secret as secret driver 2021-12-17 00:11:43.007+0000: 28055: debug : \
virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/connection-driver/libvirt_driver_storage.so' 2021-12-17 \
00:11:43.007+0000: 28055: debug : virModuleLoadFunc:69 : Lookup function \
'storageRegister' 2021-12-17 00:11:43.007+0000: 28055: debug : \
virRegisterConnectDriver:522 : driver=0x7f49a0493040 name=storage 2021-12-17 \
00:11:43.007+0000: 28055: debug : virRegisterConnectDriver:533 : registering storage \
as driver 6 2021-12-17 00:11:43.007+0000: 28055: debug : virModuleLoadFile:48 : Load \
module file '/usr/lib64/libvirt/storage-backend/libvirt_storage_backend_fs.so' \
2021-12-17 00:11:43.008+0000: 28055: debug : virModuleLoadFunc:69 : Lookup function \
'virStorageBackendFsRegister' 2021-12-17 00:11:43.008+0000: 28055: debug : \
virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/storage-backend/libvirt_storage_backend_logical.so' 2021-12-17 \
00:11:43.008+0000: 28055: debug : virModuleLoadFunc:69 : Lookup function \
'virStorageBackendLogicalRegister' 2021-12-17 00:11:43.008+0000: 28055: debug : \
virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/storage-backend/libvirt_storage_backend_iscsi.so' 2021-12-17 \
00:11:43.008+0000: 28055: debug : virModuleLoadFunc:69 : Lookup function \
'virStorageBackendISCSIRegister' 2021-12-17 00:11:43.008+0000: 28055: debug : \
virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/storage-backend/libvirt_storage_backend_iscsi-direct.so' \
2021-12-17 00:11:43.009+0000: 28055: debug : virModuleLoadFunc:69 : Lookup function \
'virStorageBackendISCSIDirectRegister' 2021-12-17 00:11:43.009+0000: 28055: debug : \
virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/storage-backend/libvirt_storage_backend_scsi.so' 2021-12-17 \
00:11:43.010+0000: 28055: debug : virModuleLoadFunc:69 : Lookup function \
'virStorageBackendSCSIRegister' 2021-12-17 00:11:43.010+0000: 28055: debug : \
virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/storage-backend/libvirt_storage_backend_mpath.so' 2021-12-17 \
00:11:43.010+0000: 28055: debug : virModuleLoadFunc:69 : Lookup function \
'virStorageBackendMpathRegister' 2021-12-17 00:11:43.010+0000: 28055: debug : \
virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/storage-backend/libvirt_storage_backend_disk.so' 2021-12-17 \
00:11:43.011+0000: 28055: debug : virModuleLoadFunc:69 : Lookup function \
'virStorageBackendDiskRegister' 2021-12-17 00:11:43.011+0000: 28055: debug : \
virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/storage-backend/libvirt_storage_backend_rbd.so' 2021-12-17 \
00:11:43.027+0000: 28055: debug : virModuleLoadFunc:69 : Lookup function \
'virStorageBackendRBDRegister' 2021-12-17 00:11:43.027+0000: 28055: debug : \
virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/storage-backend/libvirt_storage_backend_gluster.so' 2021-12-17 \
00:11:43.033+0000: 28055: debug : virModuleLoadFunc:69 : Lookup function \
'virStorageBackendGlusterRegister' 2021-12-17 00:11:43.033+0000: 28055: debug : \
virSetSharedStorageDriver:422 : registering storage as storage driver 2021-12-17 \
00:11:43.033+0000: 28055: debug : virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/connection-driver/libvirt_driver_nodedev.so' 2021-12-17 \
00:11:43.033+0000: 28055: debug : virModuleLoadFunc:69 : Lookup function \
'nodedevRegister' 2021-12-17 00:11:43.034+0000: 28055: debug : \
virRegisterConnectDriver:522 : driver=0x7f4987046060 name=nodedev 2021-12-17 \
00:11:43.034+0000: 28055: debug : virRegisterConnectDriver:533 : registering nodedev \
as driver 7 2021-12-17 00:11:43.034+0000: 28055: debug : \
virSetSharedNodeDeviceDriver:448 : registering udev as device driver 2021-12-17 \
00:11:43.034+0000: 28055: debug : virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/connection-driver/libvirt_driver_nwfilter.so' 2021-12-17 \
00:11:43.034+0000: 28055: debug : virModuleLoadFunc:69 : Lookup function \
'nwfilterRegister' 2021-12-17 00:11:43.034+0000: 28055: debug : \
virRegisterConnectDriver:522 : driver=0x7f4986c26040 name=nwfilter 2021-12-17 \
00:11:43.034+0000: 28055: debug : virRegisterConnectDriver:533 : registering nwfilter \
as driver 8 2021-12-17 00:11:43.034+0000: 28055: debug : \
virSetSharedNWFilterDriver:500 : registering nwfilter as network filter driver \
2021-12-17 00:11:43.034+0000: 28055: debug : virModuleLoadFile:48 : Load module file \
'/usr/lib64/libvirt/connection-driver/libvirt_driver_qemu.so' 2021-12-17 \
00:11:43.037+0000: 28055: debug : virModuleLoadFunc:69 : Lookup function \
'qemuRegister' 2021-12-17 00:11:43.037+0000: 28055: debug : \
virRegisterConnectDriver:522 : driver=0x7f49867be000 name=QEMU 2021-12-17 \
00:11:43.037+0000: 28055: debug : virRegisterConnectDriver:533 : registering QEMU as \
driver 9 2021-12-17 00:11:43.037+0000: 28055: debug : main:1142 : Attempting to \
configure auditing subsystem 2021-12-17 00:11:43.037+0000: 28066: debug : \
virThreadJobSetWorker:75 : Thread 28066 is running worker rpc-worker 2021-12-17 \
00:11:43.037+0000: 28055: debug : virHookCheck:161 : No hook script \
/etc/libvirt/hooks/daemon 2021-12-17 00:11:43.037+0000: 28055: debug : \
virHookCheck:172 : Hook dir /etc/libvirt/hooks/daemon.d is not accessible 2021-12-17 \
00:11:43.038+0000: 28055: debug : virHookCheck:165 : Found hook script \
/etc/libvirt/hooks/qemu 2021-12-17 00:11:43.038+0000: 28055: debug : virHookCheck:161 \
: No hook script /etc/libvirt/hooks/lxc 2021-12-17 00:11:43.038+0000: 28055: debug : \
virHookCheck:172 : Hook dir /etc/libvirt/hooks/lxc.d is not accessible 2021-12-17 \
00:11:43.038+0000: 28055: debug : virHookCheck:161 : No hook script \
/etc/libvirt/hooks/network 2021-12-17 00:11:43.038+0000: 28055: debug : \
virHookCheck:172 : Hook dir /etc/libvirt/hooks/network.d is not accessible 2021-12-17 \
00:11:43.038+0000: 28055: debug : virHookCheck:161 : No hook script \
/etc/libvirt/hooks/libxl 2021-12-17 00:11:43.038+0000: 28055: debug : \
virHookCheck:172 : Hook dir /etc/libvirt/hooks/libxl.d is not accessible 2021-12-17 \
00:11:43.038+0000: 28055: debug : virHookCheck:161 : No hook script \
/etc/libvirt/hooks/bhyve 2021-12-17 00:11:43.038+0000: 28055: debug : \
virHookCheck:172 : Hook dir /etc/libvirt/hooks/bhyve.d is not accessible 2021-12-17 \
00:11:43.038+0000: 28055: debug : virSystemdGetListenFDs:901 : Setting up networking \
from caller 2021-12-17 00:11:43.038+0000: 28055: debug : virSystemdGetListenFDs:932 : \
Got 4 file descriptors 2021-12-17 00:11:43.038+0000: 28055: debug : \
virSystemdGetListenFDs:937 : Disabling inheritance of passed FD 3 2021-12-17 \
00:11:43.038+0000: 28055: debug : virSystemdGetListenFDs:937 : Disabling inheritance \
of passed FD 4 2021-12-17 00:11:43.038+0000: 28055: debug : \
virSystemdGetListenFDs:937 : Disabling inheritance of passed FD 5 2021-12-17 \
00:11:43.038+0000: 28055: debug : virSystemdGetListenFDs:937 : Disabling inheritance \
of passed FD 6 2021-12-17 00:11:43.038+0000: 28055: debug : \
virSystemdActivationNew:964 : Activated with 4 FDs 2021-12-17 00:11:43.038+0000: \
28055: debug : virSystemdActivationInitFromNames:758 : FD names \
libvirtd-admin.socket:libvirtd-ro.socket:libvirtd.socket:libvirtd-tls.socket \
2021-12-17 00:11:43.038+0000: 28055: debug : virSystemdActivationAddFD:730 : Record \
first FD 3 with name libvirtd-admin.socket 2021-12-17 00:11:43.038+0000: 28055: debug \
: virSystemdActivationAddFD:730 : Record first FD 4 with name libvirtd-ro.socket \
2021-12-17 00:11:43.038+0000: 28055: debug : virSystemdActivationAddFD:730 : Record \
first FD 5 with name libvirtd.socket 2021-12-17 00:11:43.038+0000: 28055: debug : \
virSystemdActivationAddFD:730 : Record first FD 6 with name libvirtd-tls.socket \
2021-12-17 00:11:43.038+0000: 28055: debug : virSystemdActivationNew:977 : Created \
activation object for 4 FDs 2021-12-17 00:11:43.038+0000: 28055: debug : \
virSystemdActivationClaimFDs:1090 : Found 1 FDs with name libvirtd.socket 2021-12-17 \
00:11:43.038+0000: 28055: debug : virSystemdActivationClaimFDs:1090 : Found 1 FDs \
with name libvirtd-ro.socket 2021-12-17 00:11:43.038+0000: 28055: debug : \
virSystemdActivationClaimFDs:1090 : Found 1 FDs with name libvirtd-admin.socket \
2021-12-17 00:11:43.038+0000: 28055: debug : virSystemdActivationClaimFDs:1086 : No \
FD with name libvirtd-tcp.socket 2021-12-17 00:11:43.038+0000: 28055: debug : \
daemonSetupNetworking:364 : Using CA='/etc/pki/vdsm/certs/cacert.pem' \
cert='/etc/pki/vdsm/certs/vdsmcert.pem' key='/etc/pki/vdsm/keys/vdsmkey.pem' \
2021-12-17 00:11:43.038+0000: 28067: debug : virThreadJobSetWorker:75 : Thread 28067 \
is running worker rpc-worker 2021-12-17 00:11:43.038+0000: 28068: debug : \
virThreadJobSetWorker:75 : Thread 28068 is running worker rpc-worker 2021-12-17 \
00:11:43.039+0000: 28069: debug : virThreadJobSetWorker:75 : Thread 28069 is running \
worker rpc-worker 2021-12-17 00:11:43.040+0000: 28070: debug : \
virThreadJobSetWorker:75 : Thread 28070 is running worker rpc-worker 2021-12-17 \
00:11:43.999+0000: 28055: debug : daemonSetupNetworking:385 : Registering TLS socket \
(null):16514 2021-12-17 00:11:43.999+0000: 28055: debug : \
virSystemdActivationClaimFDs:1090 : Found 1 FDs with name libvirtd-tls.socket \
2021-12-17 00:11:44.003+0000: 28055: info : virNetlinkEventServiceStart:1031 : \
starting netlink event service with protocol 0 2021-12-17 00:11:44.003+0000: 28055: \
debug : virNetlinkEventServiceStart:1075 : netlink event listener on fd: 15 running \
2021-12-17 00:11:44.003+0000: 28055: info : virNetlinkEventServiceStart:1031 : \
starting netlink event service with protocol 15 2021-12-17 00:11:44.003+0000: 28071: \
debug : virThreadJobSet:97 : Thread 28071 is now running job daemon-init 2021-12-17 \
00:11:44.003+0000: 28055: debug : virNetlinkEventServiceStart:1075 : netlink event \
listener on fd: 16 running 2021-12-17 00:11:44.015+0000: 28071: debug : \
virGDBusIsServiceEnabled:387 : Service org.freedesktop.login1 is available 2021-12-17 \
00:11:44.016+0000: 28071: debug : virGDBusIsServiceRegistered:404 : Service \
org.freedesktop.login1 is registered 2021-12-17 00:11:44.019+0000: 28071: debug : \
virStateInitialize:654 : Running global init for Remote state driver 2021-12-17 \
00:11:44.019+0000: 28071: debug : virStateInitialize:660 : State init result 1 \
(mandatory=0) 2021-12-17 00:11:44.019+0000: 28071: debug : virStateInitialize:654 : \
Running global init for bridge state driver 2021-12-17 00:11:44.020+0000: 28071: \
debug : virCommandRunAsync:2629 : About to run LC_ALL=C \
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin /usr/sbin/dnsmasq --version \
2021-12-17 00:11:44.022+0000: 28071: debug : virCommandRunAsync:2632 : Command result \
0, with PID 28074 2021-12-17 00:11:44.094+0000: 28071: debug : virCommandRun:2478 : \
Result status 0, stdout: 'Dnsmasq version 2.79  Copyright (c) 2000-2018 Simon Kelley \
Compile time options: IPv6 GNU-getopt DBus no-i18n IDN2 DHCP DHCPv6 no-Lua TFTP \
no-conntrack ipset auth DNSSEC loop-detect inotify

This software comes with ABSOLUTELY NO WARRANTY.
Dnsmasq is free software, and you are welcome to redistribute it
under the terms of the GNU General Public License, version 2 or 3.
' stderr: ''
2021-12-17 00:11:44.094+0000: 28071: debug : virCommandRunAsync:2629 : About to run \
LC_ALL=C PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin /usr/sbin/dnsmasq \
--help 2021-12-17 00:11:44.097+0000: 28071: debug : virCommandRunAsync:2632 : Command \
result 0, with PID 28075 2021-12-17 00:11:44.168+0000: 28071: debug : \
virCommandRun:2478 : Result status 0, stdout: 'Usage: dnsmasq [options]

Valid options are:
-a, --listen-address=&lt;ipaddr&gt;                          Specify local address(es) to \
                listen on.
-A, --address=/&lt;domain&gt;/&lt;ipaddr&gt;                       Return ipaddr for all hosts in \
                specified domains.
-b, --bogus-priv                                       Fake reverse lookups for \
                RFC1918 private address ranges.
-B, --bogus-nxdomain=&lt;ipaddr&gt;                          Treat ipaddr as NXDOMAIN \
                (defeats Verisign wildcard).
-c, --cache-size=&lt;integer&gt;                             Specify the size of the cache \
                in entries (defaults to 150).
-C, --conf-file=&lt;path&gt;                                 Specify configuration file \
                (defaults to /etc/dnsmasq.conf).
-d, --no-daemon                                        Do NOT fork into the \
                background: run in debug mode.
-D, --domain-needed                                    Do NOT forward queries with no \
                domain part.
-e, --selfmx                                           Return self-pointing MX \
                records for local hosts.
-E, --expand-hosts                                     Expand simple names in \
                /etc/hosts with domain-suffix.
-f, --filterwin2k                                      Don't forward spurious DNS \
                requests from Windows hosts.
-F, --dhcp-range=&lt;ipaddr&gt;,...                          Enable DHCP in the range given \
                with lease duration.
-g, --group=&lt;groupname&gt;                                Change to this group after \
                startup (defaults to dnsmasq).
-G, --dhcp-host=&lt;hostspec&gt;                             Set address or hostname for a \
                specified machine.
    --dhcp-hostsfile=&lt;path&gt;                            Read DHCP host specs from \
                file.
    --dhcp-optsfile=&lt;path&gt;                             Read DHCP option specs from \
                file.
    --dhcp-hostsdir=&lt;path&gt;                             Read DHCP host specs from a \
                directory.
    --dhcp-optsdir=&lt;path&gt;                              Read DHCP options from a \
                directory.
    --tag-if=tag-expression                            Evaluate conditional tag \
                expression.
-h, --no-hosts                                         Do NOT load /etc/hosts file.
-H, --addn-hosts=&lt;path&gt;                                Specify a hosts file to be \
                read in addition to /etc/hosts.
    --hostsdir=&lt;path&gt;                                  Read hosts files from a \
                directory.
-i, --interface=&lt;interface&gt;                            Specify interface(s) to listen \
                on.
-I, --except-interface=&lt;interface&gt;                     Specify interface(s) NOT to \
                listen on.
-j, --dhcp-userclass=set:&lt;tag&gt;,&lt;class&gt;                 Map DHCP user class to tag.
    --dhcp-circuitid=set:&lt;tag&gt;,&lt;circuit&gt;               Map RFC3046 circuit-id to tag.
    --dhcp-remoteid=set:&lt;tag&gt;,&lt;remote&gt;                 Map RFC3046 remote-id to tag.
    --dhcp-subscrid=set:&lt;tag&gt;,&lt;remote&gt;                 Map RFC3993 subscriber-id to \
                tag.
-J, --dhcp-ignore=tag:&lt;tag&gt;...                         Don't do DHCP for hosts with \
                tag set.
    --dhcp-broadcast[=tag:&lt;tag&gt;...]                    Force broadcast replies for \
                hosts with tag set.
-k, --keep-in-foreground                               Do NOT fork into the \
                background, do NOT run in debug mode.
-K, --dhcp-authoritative                               Assume we are the only DHCP \
                server on the local network.
-l, --dhcp-leasefile=&lt;path&gt;                            Specify where to store DHCP \
                leases (defaults to /var/lib/dnsmasq/dnsmasq.leases).
-L, --localmx                                          Return MX records for local \
                hosts.
-m, --mx-host=&lt;host_name&gt;,&lt;target&gt;,&lt;pref&gt;              Specify an MX record.
-M, --dhcp-boot=&lt;bootp opts&gt;                           Specify BOOTP options to DHCP \
                server.
-n, --no-poll                                          Do NOT poll /etc/resolv.conf \
                file, reload only on SIGHUP.
-N, --no-negcache                                      Do NOT cache failed search \
                results.
-o, --strict-order                                     Use nameservers strictly in \
                the order given in /etc/resolv.conf.
-O, --dhcp-option=&lt;optspec&gt;                            Specify options to be sent to \
                DHCP clients.
    --dhcp-option-force=&lt;optspec&gt;                      DHCP option sent even if the \
                client does not request it.
-p, --port=&lt;integer&gt;                                   Specify port to listen for DNS \
                requests on (defaults to 53).
-P, --edns-packet-max=&lt;integer&gt;                        Maximum supported UDP packet \
                size for EDNS.0 (defaults to 4096).
-q, --log-queries                                      Log DNS queries.
-Q, --query-port=&lt;integer&gt;                             Force the originating port for \
                upstream DNS queries.
-R, --no-resolv                                        Do NOT read resolv.conf.
-r, --resolv-file=&lt;path&gt;                               Specify path to resolv.conf \
                (defaults to /etc/resolv.conf).
    --servers-file=&lt;path&gt;                              Specify path to file with \
                server= options
-S, --server=/&lt;domain&gt;/&lt;ipaddr&gt;                        Specify address(es) of \
                upstream servers with optional domains.
    --rev-server=&lt;addr&gt;/&lt;prefix&gt;,&lt;ipaddr&gt;              Specify address of upstream \
                servers for reverse address queries
    --local=/&lt;domain&gt;/                                 Never forward queries to \
                specified domains.
-s, --domain=&lt;domain&gt;[,&lt;range&gt;]                        Specify the domain to be \
                assigned in DHCP leases.
-t, --mx-target=&lt;host_name&gt;                            Specify default target in an \
                MX record.
-T, --local-ttl=&lt;integer&gt;                              Specify time-to-live in \
                seconds for replies from /etc/hosts.
    --neg-ttl=&lt;integer&gt;                                Specify time-to-live in \
                seconds for negative caching.
    --max-ttl=&lt;integer&gt;                                Specify time-to-live in \
                seconds for maximum TTL to send to clients.
    --max-cache-ttl=&lt;integer&gt;                          Specify time-to-live ceiling \
                for cache.
    --min-cache-ttl=&lt;integer&gt;                          Specify time-to-live floor for \
                cache.
-u, --user=&lt;username&gt;                                  Change to this user after \
                startup. (defaults to dnsmasq).
-U, --dhcp-vendorclass=set:&lt;tag&gt;,&lt;class&gt;               Map DHCP vendor class to tag.
-v, --version                                          Display dnsmasq version and \
                copyright information.
-V, --alias=&lt;ipaddr&gt;,&lt;ipaddr&gt;,&lt;netmask&gt;                Translate IPv4 addresses from \
                upstream servers.
-W, --srv-host=&lt;name&gt;,&lt;target&gt;,...                     Specify a SRV record.
-w, --help                                             Display this message. Use \
                --help dhcp or --help dhcp6 for known DHCP options.
-x, --pid-file=&lt;path&gt;                                  Specify path of PID file \
                (defaults to /var/run/dnsmasq.pid).
-X, --dhcp-lease-max=&lt;integer&gt;                         Specify maximum number of DHCP \
                leases (defaults to 1000).
-y, --localise-queries                                 Answer DNS queries based on \
                the interface a query was sent to.
-Y, --txt-record=&lt;name&gt;,&lt;txt&gt;[,&lt;txt]                   Specify TXT DNS record.
    --ptr-record=&lt;name&gt;,&lt;target&gt;                       Specify PTR DNS record.
    --interface-name=&lt;name&gt;,&lt;interface&gt;                Give DNS name to IPv4 address \
                of interface.
-z, --bind-interfaces                                  Bind only to interfaces in \
                use.
-Z, --read-ethers                                      Read DHCP static host \
                information from /etc/ethers.
-1, --enable-dbus[=&lt;busname&gt;]                          Enable the DBus interface for \
                setting upstream servers, etc.
-2, --no-dhcp-interface=&lt;interface&gt;                    Do not provide DHCP on this \
                interface, only provide DNS.
-3, --bootp-dynamic[=tag:&lt;tag&gt;]...                     Enable dynamic address \
                allocation for bootp.
-4, --dhcp-mac=set:&lt;tag&gt;,&lt;mac address&gt;                 Map MAC address (with \
                wildcards) to option set.
    --bridge-interface=&lt;iface&gt;,&lt;alias&gt;..               Treat DHCP requests on aliases \
                as arriving from interface.
-5, --no-ping                                          Disable ICMP echo address \
                checking in the DHCP server.
-6, --dhcp-script=&lt;path&gt;                               Shell script to run on DHCP \
                lease creation and destruction.
    --dhcp-luascript=path                              Lua script to run on DHCP \
                lease creation and destruction.
    --dhcp-scriptuser=&lt;username&gt;                       Run lease-change scripts as \
                this user.
    --script-arp                                       Call dhcp-script with changes \
                to local ARP table.
-7, --conf-dir=&lt;path&gt;                                  Read configuration from all \
                the files in this directory.
-8, --log-facility=&lt;facility&gt;|&lt;file&gt;                   Log to this syslog facility or \
                file. (defaults to DAEMON)
-9, --leasefile-ro                                     Do not use leasefile.
-0, --dns-forward-max=&lt;integer&gt;                        Maximum number of concurrent \
                DNS queries. (defaults to 150)
    --clear-on-reload                                  Clear DNS cache when reloading \
                /etc/resolv.conf.
    --dhcp-ignore-names[=tag:&lt;tag&gt;]...                 Ignore hostnames provided by \
                DHCP clients.
    --dhcp-no-override                                 Do NOT reuse filename and \
                server fields for extra DHCP options.
    --enable-tftp[=&lt;intr&gt;[,&lt;intr&gt;]]                    Enable integrated read-only \
                TFTP server.
    --tftp-root=&lt;dir&gt;[,&lt;iface&gt;]                        Export files by TFTP only from \
                the specified subtree.
    --tftp-unique-root[=ip|mac]                        Add client IP or hardware \
                address to tftp-root.
    --tftp-secure                                      Allow access only to files \
                owned by the user running dnsmasq.
    --tftp-no-fail                                     Do not terminate the service \
                if TFTP directories are inaccessible.
    --tftp-max=&lt;integer&gt;                               Maximum number of concurrent \
                TFTP transfers (defaults to 50).
    --tftp-mtu=&lt;integer&gt;                               Maximum MTU to use for TFTP \
                transfers.
    --tftp-no-blocksize                                Disable the TFTP blocksize \
                extension.
    --tftp-lowercase                                   Convert TFTP filenames to \
                lowercase
    --tftp-port-range=&lt;start&gt;,&lt;end&gt;                    Ephemeral port range for use \
                by TFTP transfers.
    --log-dhcp                                         Extra logging for DHCP.
    --log-async[=&lt;integer&gt;]                            Enable async. logging; \
                optionally set queue length.
    --stop-dns-rebind                                  Stop DNS rebinding. Filter \
                private IP ranges when resolving.
    --rebind-localhost-ok                              Allow rebinding of \
                127.0.0.0/8, for RBL servers.
    --rebind-domain-ok=/&lt;domain&gt;/                      Inhibit DNS-rebind protection \
                on this domain.
    --all-servers                                      Always perform DNS queries to \
                all servers.
    --dhcp-match=set:&lt;tag&gt;,&lt;optspec&gt;                   Set tag if client includes \
                matching option in request.
    --dhcp-alternate-port[=&lt;ports&gt;]                    Use alternative ports for \
                DHCP.
    --naptr-record=&lt;name&gt;,&lt;naptr&gt;                      Specify NAPTR DNS record.
    --min-port=&lt;port&gt;                                  Specify lowest port available \
                for DNS query transmission.
    --max-port=&lt;port&gt;                                  Specify highest port available \
                for DNS query transmission.
    --dhcp-fqdn                                        Use only fully qualified \
                domain names for DHCP clients.
    --dhcp-generate-names[=tag:&lt;tag&gt;]                  Generate hostnames based on \
                MAC address for nameless clients.
    --dhcp-proxy[=&lt;ipaddr&gt;]...                         Use these DHCP relays as full \
                proxies.
    --dhcp-relay=&lt;local-addr&gt;,&lt;server&gt;[,&lt;iface&gt;]       Relay DHCP requests to a \
                remote server
    --cname=&lt;alias&gt;,&lt;target&gt;[,&lt;ttl&gt;]                   Specify alias name for LOCAL \
                DNS name.
    --pxe-prompt=&lt;prompt&gt;,[&lt;timeout&gt;]                  Prompt to send to PXE clients.
    --pxe-service=&lt;service&gt;                            Boot service for PXE menu.
    --test                                             Check configuration syntax.
    --add-mac[=base64|text]                            Add requestor's MAC address to \
                forwarded DNS queries.
    --add-subnet=&lt;v4 pref&gt;[,&lt;v6 pref&gt;]                 Add specified IP subnet to \
                forwarded DNS queries.
    --add-cpe-id=&lt;text&gt;                                Add client identification to \
                forwarded DNS queries.
    --proxy-dnssec                                     Proxy DNSSEC validation \
                results from upstream nameservers.
    --dhcp-sequential-ip                               Attempt to allocate sequential \
                IP addresses to DHCP clients.
    --conntrack                                        Copy connection-track mark \
                from queries to upstream connections.
    --dhcp-client-update                               Allow DHCP clients to do their \
                own DDNS updates.
    --enable-ra                                        Send router-advertisements for \
                interfaces doing DHCPv6
    --dhcp-duid=&lt;enterprise&gt;,&lt;duid&gt;                    Specify DUID_EN-type DHCPv6 \
                server DUID
    --host-record=&lt;name&gt;,&lt;address&gt;[,&lt;ttl&gt;]             Specify host (A/AAAA and PTR) \
                records
    --dns-rr=&lt;name&gt;,&lt;RR-number&gt;,[&lt;data&gt;]               Specify arbitrary DNS resource \
                record
    --bind-dynamic                                     Bind to interfaces in use - \
                check for new interfaces
    --auth-server=&lt;NS&gt;,&lt;interface&gt;                     Export local names to global \
                DNS
    --auth-zone=&lt;domain&gt;,[&lt;subnet&gt;...]                 Domain to export to global DNS
    --auth-ttl=&lt;integer&gt;                               Set TTL for authoritative \
                replies
    --auth-soa=&lt;serial&gt;[,...]                          Set authoritative zone \
                information
    --auth-sec-servers=&lt;NS&gt;[,&lt;NS&gt;...]                  Secondary authoritative \
                nameservers for forward domains
    --auth-peer=&lt;ipaddr&gt;[,&lt;ipaddr&gt;...]                 Peers which are allowed to do \
                zone transfer
    --ipset=/&lt;domain&gt;[/&lt;domain&gt;...]/&lt;ipset&gt;...         Specify ipsets to which \
                matching domains should be added
    --synth-domain=&lt;domain&gt;,&lt;range&gt;,[&lt;prefix&gt;]         Specify a domain and address \
                range for synthesised names
    --dnssec                                           Activate DNSSEC validation
    --trust-anchor=&lt;domain&gt;,[&lt;class&gt;],...              Specify trust anchor key \
                digest.
    --dnssec-debug                                     Disable upstream checking for \
                DNSSEC debugging.
    --dnssec-check-unsigned                            Ensure answers without DNSSEC \
                are in unsigned zones.
    --dnssec-no-timecheck                              Don't check DNSSEC signature \
                timestamps until first cache-reload
    --dnssec-timestamp=&lt;path&gt;                          Timestamp file to verify \
                system clock for DNSSEC
    --ra-param=&lt;iface&gt;,[mtu:&lt;value&gt;|&lt;interface&gt;|off,][&lt;Set MTU, priority, \
                resend-interval and router-lifetime
    --quiet-dhcp                                       Do not log routine DHCP.
    --quiet-dhcp6                                      Do not log routine DHCPv6.
    --quiet-ra                                         Do not log RA.
    --local-service                                    Accept queries only from \
                directly-connected networks.
    --dns-loop-detect                                  Detect and remove DNS \
                forwarding loops.
    --ignore-address=&lt;ipaddr&gt;                          Ignore DNS responses \
                containing ipaddr.
    --dhcp-ttl=&lt;ttl&gt;                                   Set TTL in DNS responses with \
                DHCP-derived addresses.
    --dhcp-reply-delay=&lt;integer&gt;                       Delay DHCP replies for at \
least number of seconds. ' stderr: ''
2021-12-17 00:11:44.168+0000: 28071: info : dnsmasqCapsSetFromBuffer:650 : dnsmasq \
version is 2.79, --bind-dynamic is present, SO_BINDTODEVICE is NOT in use, --ra-param \
is present 2021-12-17 00:11:44.171+0000: 28071: debug : \
virFirewallValidateBackend:116 : found iptables/ip6tables/ebtables 2021-12-17 \
00:11:44.173+0000: 28071: debug : virGDBusIsServiceRegistered:404 : Service \
org.fedoraproject.FirewallD1 is registered 2021-12-17 00:11:44.173+0000: 28071: debug \
: virFirewallValidateBackend:122 : Firewalld is registered ? 0 2021-12-17 \
00:11:44.173+0000: 28071: debug : virFirewallValidateBackend:137 : firewalld service \
running, using firewalld backend 2021-12-17 00:11:44.183+0000: 28071: debug : \
virFirewallBackendSynchronize:634 : Result of 'iptables -V' via firewalld: iptables \
v1.8.4 (nf_tables)

2021-12-17 00:11:44.183+0000: 28071: debug : virFirewallApply:767 : Applying groups \
for 0x557670123790 2021-12-17 00:11:44.183+0000: 28071: info : \
virFirewallApplyGroup:710 : Starting transaction for firewall=0x557670123790 \
group=0x557670123750 flags=0x0 2021-12-17 00:11:44.183+0000: 28071: info : \
virFirewallApplyRule:651 : Applying rule '/usr/sbin/iptables -w --table filter \
--list-rules' 2021-12-17 00:11:44.183+0000: 28071: debug : virCommandRunAsync:2629 : \
About to run /usr/sbin/iptables -w --table filter --list-rules 2021-12-17 \
00:11:44.185+0000: 28071: debug : virCommandRunAsync:2632 : Command result 0, with \
PID 28077 2021-12-17 00:11:44.189+0000: 28071: debug : virCommandRun:2478 : Result \
                exit status 0, stdout: '-P INPUT ACCEPT
-P FORWARD ACCEPT
-P OUTPUT ACCEPT
-N LIBVIRT_INP
-N LIBVIRT_OUT
-N LIBVIRT_FWO
-N LIBVIRT_FWI
-N LIBVIRT_FWX
-A INPUT -j LIBVIRT_INP
-A FORWARD -j LIBVIRT_FWX
-A FORWARD -j LIBVIRT_FWI
-A FORWARD -j LIBVIRT_FWO
-A OUTPUT -j LIBVIRT_OUT
-A LIBVIRT_INP -i virbr0 -p udp -m udp --dport 53 -j ACCEPT
-A LIBVIRT_INP -i virbr0 -p tcp -m tcp --dport 53 -j ACCEPT
-A LIBVIRT_INP -i virbr0 -p udp -m udp --dport 67 -j ACCEPT
-A LIBVIRT_INP -i virbr0 -p tcp -m tcp --dport 67 -j ACCEPT
-A LIBVIRT_OUT -o virbr0 -p udp -m udp --dport 53 -j ACCEPT
-A LIBVIRT_OUT -o virbr0 -p tcp -m tcp --dport 53 -j ACCEPT
-A LIBVIRT_OUT -o virbr0 -p udp -m udp --dport 68 -j ACCEPT
-A LIBVIRT_OUT -o virbr0 -p tcp -m tcp --dport 68 -j ACCEPT
-A LIBVIRT_FWO -s 192.168.122.0/24 -i virbr0 -j ACCEPT
-A LIBVIRT_FWO -i virbr0 -j REJECT --reject-with icmp-port-unreachable
-A LIBVIRT_FWI -d 192.168.122.0/24 -o virbr0 -m conntrack --ctstate \
                RELATED,ESTABLISHED -j ACCEPT
-A LIBVIRT_FWI -o virbr0 -j REJECT --reject-with icmp-port-unreachable
-A LIBVIRT_FWX -i virbr0 -o virbr0 -j ACCEPT
' stderr: ''
2021-12-17 00:11:44.189+0000: 28071: debug : virFirewallApplyRule:686 : Invoking \
                query 0x7f49ac5c1ce0 with '-P INPUT ACCEPT
-P FORWARD ACCEPT
-P OUTPUT ACCEPT
-N LIBVIRT_INP
-N LIBVIRT_OUT
-N LIBVIRT_FWO
-N LIBVIRT_FWI
-N LIBVIRT_FWX
-A INPUT -j LIBVIRT_INP
-A FORWARD -j LIBVIRT_FWX
-A FORWARD -j LIBVIRT_FWI
-A FORWARD -j LIBVIRT_FWO
-A OUTPUT -j LIBVIRT_OUT
-A LIBVIRT_INP -i virbr0 -p udp -m udp --dport 53 -j ACCEPT
-A LIBVIRT_INP -i virbr0 -p tcp -m tcp --dport 53 -j ACCEPT
-A LIBVIRT_INP -i virbr0 -p udp -m udp --dport 67 -j ACCEPT
-A LIBVIRT_INP -i virbr0 -p tcp -m tcp --dport 67 -j ACCEPT
-A LIBVIRT_OUT -o virbr0 -p udp -m udp --dport 53 -j ACCEPT
-A LIBVIRT_OUT -o virbr0 -p tcp -m tcp --dport 53 -j ACCEPT
-A LIBVIRT_OUT -o virbr0 -p udp -m udp --dport 68 -j ACCEPT
-A LIBVIRT_OUT -o virbr0 -p tcp -m tcp --dport 68 -j ACCEPT
-A LIBVIRT_FWO -s 192.168.122.0/24 -i virbr0 -j ACCEPT
-A LIBVIRT_FWO -i virbr0 -j REJECT --reject-with icmp-port-unreachable
-A LIBVIRT_FWI -d 192.168.122.0/24 -o virbr0 -m conntrack --ctstate \
                RELATED,ESTABLISHED -j ACCEPT
-A LIBVIRT_FWI -o virbr0 -j REJECT --reject-with icmp-port-unreachable
-A LIBVIRT_FWX -i virbr0 -o virbr0 -j ACCEPT
'
2021-12-17 00:11:44.189+0000: 28071: info : virFirewallApplyRule:651 : Applying rule \
'/usr/sbin/iptables -w --table nat --list-rules' 2021-12-17 00:11:44.189+0000: 28071: \
debug : virCommandRunAsync:2629 : About to run /usr/sbin/iptables -w --table nat \
--list-rules 2021-12-17 00:11:44.191+0000: 28071: debug : virCommandRunAsync:2632 : \
Command result 0, with PID 28078 2021-12-17 00:11:44.194+0000: 28071: debug : \
                virCommandRun:2478 : Result exit status 0, stdout: '-P PREROUTING \
                ACCEPT
-P INPUT ACCEPT
-P POSTROUTING ACCEPT
-P OUTPUT ACCEPT
-N LIBVIRT_PRT
-A POSTROUTING -j LIBVIRT_PRT
-A LIBVIRT_PRT -s 192.168.122.0/24 -d 224.0.0.0/24 -j RETURN
-A LIBVIRT_PRT -s 192.168.122.0/24 -d 255.255.255.255/32 -j RETURN
-A LIBVIRT_PRT -s 192.168.122.0/24 ! -d 192.168.122.0/24 -p tcp -j MASQUERADE \
                --to-ports 1024-65535
-A LIBVIRT_PRT -s 192.168.122.0/24 ! -d 192.168.122.0/24 -p udp -j MASQUERADE \
                --to-ports 1024-65535
-A LIBVIRT_PRT -s 192.168.122.0/24 ! -d 192.168.122.0/24 -j MASQUERADE
' stderr: ''
2021-12-17 00:11:44.194+0000: 28071: debug : virFirewallApplyRule:686 : Invoking \
                query 0x7f49ac5c1ce0 with '-P PREROUTING ACCEPT
-P INPUT ACCEPT
-P POSTROUTING ACCEPT
-P OUTPUT ACCEPT
-N LIBVIRT_PRT
-A POSTROUTING -j LIBVIRT_PRT
-A LIBVIRT_PRT -s 192.168.122.0/24 -d 224.0.0.0/24 -j RETURN
-A LIBVIRT_PRT -s 192.168.122.0/24 -d 255.255.255.255/32 -j RETURN
-A LIBVIRT_PRT -s 192.168.122.0/24 ! -d 192.168.122.0/24 -p tcp -j MASQUERADE \
                --to-ports 1024-65535
-A LIBVIRT_PRT -s 192.168.122.0/24 ! -d 192.168.122.0/24 -p udp -j MASQUERADE \
                --to-ports 1024-65535
-A LIBVIRT_PRT -s 192.168.122.0/24 ! -d 192.168.122.0/24 -j MASQUERADE
'
2021-12-17 00:11:44.194+0000: 28071: info : virFirewallApplyRule:651 : Applying rule \
'/usr/sbin/iptables -w --table mangle --list-rules' 2021-12-17 00:11:44.194+0000: \
28071: debug : virCommandRunAsync:2629 : About to run /usr/sbin/iptables -w --table \
mangle --list-rules 2021-12-17 00:11:44.195+0000: 28071: debug : \
virCommandRunAsync:2632 : Command result 0, with PID 28079 2021-12-17 \
00:11:44.198+0000: 28071: debug : virCommandRun:2478 : Result exit status 0, stdout: \
                '-P PREROUTING ACCEPT
-P INPUT ACCEPT
-P FORWARD ACCEPT
-P OUTPUT ACCEPT
-P POSTROUTING ACCEPT
-N LIBVIRT_PRT
-A POSTROUTING -j LIBVIRT_PRT
-A LIBVIRT_PRT -o virbr0 -p udp -m udp --dport 68 -j CHECKSUM --checksum-fill
' stderr: ''
2021-12-17 00:11:44.198+0000: 28071: debug : virFirewallApplyRule:686 : Invoking \
                query 0x7f49ac5c1ce0 with '-P PREROUTING ACCEPT
-P INPUT ACCEPT
-P FORWARD ACCEPT
-P OUTPUT ACCEPT
-P POSTROUTING ACCEPT
-N LIBVIRT_PRT
-A POSTROUTING -j LIBVIRT_PRT
-A LIBVIRT_PRT -o virbr0 -p udp -m udp --dport 68 -j CHECKSUM --checksum-fill
'
2021-12-17 00:11:44.198+0000: 28071: debug : virFirewallApply:800 : Done applying \
groups for 0x557670123790 2021-12-17 00:11:44.206+0000: 28071: debug : \
virFirewallBackendSynchronize:634 : Result of 'iptables -V' via firewalld: iptables \
v1.8.4 (nf_tables)

2021-12-17 00:11:44.206+0000: 28071: debug : virFirewallApply:767 : Applying groups \
for 0x557670123790 2021-12-17 00:11:44.206+0000: 28071: info : \
virFirewallApplyGroup:710 : Starting transaction for firewall=0x557670123790 \
group=0x557670123750 flags=0x0 2021-12-17 00:11:44.206+0000: 28071: info : \
virFirewallApplyRule:651 : Applying rule '/usr/sbin/ip6tables -w --table filter \
--list-rules' 2021-12-17 00:11:44.206+0000: 28071: debug : virCommandRunAsync:2629 : \
About to run /usr/sbin/ip6tables -w --table filter --list-rules 2021-12-17 \
00:11:44.207+0000: 28071: debug : virCommandRunAsync:2632 : Command result 0, with \
PID 28081 2021-12-17 00:11:44.209+0000: 28071: debug : virCommandRun:2478 : Result \
                exit status 0, stdout: '-P INPUT ACCEPT
-P FORWARD ACCEPT
-P OUTPUT ACCEPT
-N LIBVIRT_INP
-N LIBVIRT_OUT
-N LIBVIRT_FWO
-N LIBVIRT_FWI
-N LIBVIRT_FWX
-A INPUT -j LIBVIRT_INP
-A FORWARD -j LIBVIRT_FWX
-A FORWARD -j LIBVIRT_FWI
-A FORWARD -j LIBVIRT_FWO
-A OUTPUT -j LIBVIRT_OUT
' stderr: ''
2021-12-17 00:11:44.209+0000: 28071: debug : virFirewallApplyRule:686 : Invoking \
                query 0x7f49ac5c1ce0 with '-P INPUT ACCEPT
-P FORWARD ACCEPT
-P OUTPUT ACCEPT
-N LIBVIRT_INP
-N LIBVIRT_OUT
-N LIBVIRT_FWO
-N LIBVIRT_FWI
-N LIBVIRT_FWX
-A INPUT -j LIBVIRT_INP
-A FORWARD -j LIBVIRT_FWX
-A FORWARD -j LIBVIRT_FWI
-A FORWARD -j LIBVIRT_FWO
-A OUTPUT -j LIBVIRT_OUT
'
2021-12-17 00:11:44.209+0000: 28071: info : virFirewallApplyRule:651 : Applying rule \
'/usr/sbin/ip6tables -w --table nat --list-rules' 2021-12-17 00:11:44.209+0000: \
28071: debug : virCommandRunAsync:2629 : About to run /usr/sbin/ip6tables -w --table \
nat --list-rules 2021-12-17 00:11:44.211+0000: 28071: debug : virCommandRunAsync:2632 \
: Command result 0, with PID 28082 2021-12-17 00:11:44.221+0000: 28071: debug : \
                virCommandRun:2478 : Result exit status 0, stdout: '-P PREROUTING \
                ACCEPT
-P INPUT ACCEPT
-P POSTROUTING ACCEPT
-P OUTPUT ACCEPT
-N LIBVIRT_PRT
-A POSTROUTING -j LIBVIRT_PRT
' stderr: ''
2021-12-17 00:11:44.221+0000: 28071: debug : virFirewallApplyRule:686 : Invoking \
                query 0x7f49ac5c1ce0 with '-P PREROUTING ACCEPT
-P INPUT ACCEPT
-P POSTROUTING ACCEPT
-P OUTPUT ACCEPT
-N LIBVIRT_PRT
-A POSTROUTING -j LIBVIRT_PRT
'
2021-12-17 00:11:44.221+0000: 28071: info : virFirewallApplyRule:651 : Applying rule \
'/usr/sbin/ip6tables -w --table mangle --list-rules' 2021-12-17 00:11:44.221+0000: \
28071: debug : virCommandRunAsync:2629 : About to run /usr/sbin/ip6tables -w --table \
mangle --list-rules 2021-12-17 00:11:44.222+0000: 28071: debug : \
virCommandRunAsync:2632 : Command result 0, with PID 28083 2021-12-17 \
00:11:44.226+0000: 28071: debug : virCommandRun:2478 : Result exit status 0, stdout: \
                '-P PREROUTING ACCEPT
-P INPUT ACCEPT
-P FORWARD ACCEPT
-P OUTPUT ACCEPT
-P POSTROUTING ACCEPT
-N LIBVIRT_PRT
-A POSTROUTING -j LIBVIRT_PRT
' stderr: ''
2021-12-17 00:11:44.226+0000: 28071: debug : virFirewallApplyRule:686 : Invoking \
                query 0x7f49ac5c1ce0 with '-P PREROUTING ACCEPT
-P INPUT ACCEPT
-P FORWARD ACCEPT
-P OUTPUT ACCEPT
-P POSTROUTING ACCEPT
-N LIBVIRT_PRT
-A POSTROUTING -j LIBVIRT_PRT
'
2021-12-17 00:11:44.226+0000: 28071: debug : virFirewallApply:800 : Done applying \
groups for 0x557670123790 2021-12-17 00:11:44.226+0000: 28071: debug : \
virFirewallApply:767 : Applying groups for 0x557670125770 2021-12-17 \
00:11:44.226+0000: 28071: info : virFirewallApplyGroup:710 : Starting transaction for \
firewall=0x557670125770 group=0x557670123750 flags=0x1 2021-12-17 00:11:44.226+0000: \
28071: info : virFirewallApplyRule:651 : Applying rule '/usr/sbin/iptables -w --table \
mangle --delete LIBVIRT_PRT --out-interface virbr0 --protocol udp --destination-port \
68 --jump CHECKSUM --checksum-fill' 2021-12-17 00:11:44.226+0000: 28071: debug : \
virCommandRunAsync:2629 : About to run /usr/sbin/iptables -w --table mangle --delete \
LIBVIRT_PRT --out-interface virbr0 --protocol udp --destination-port 68 --jump \
CHECKSUM --checksum-fill 2021-12-17 00:11:44.227+0000: 28071: debug : \
virCommandRunAsync:2632 : Command result 0, with PID 28084 2021-12-17 \
00:11:44.231+0000: 28071: debug : virCommandRun:2478 : Result exit status 0, stdout: \
'' stderr: '' 2021-12-17 00:11:44.231+0000: 28071: info : virFirewallApplyGroup:710 : \
Starting transaction for firewall=0x557670125770 group=0x557670128810 flags=0x1 \
2021-12-17 00:11:44.231+0000: 28071: info : virFirewallApplyRule:651 : Applying rule \
'/usr/sbin/iptables -w --table nat --delete LIBVIRT_PRT --source 192.168.122.0/24 \
--destination 224.0.0.0/24 --jump RETURN' 2021-12-17 00:11:44.231+0000: 28071: debug \
: virCommandRunAsync:2629 : About to run /usr/sbin/iptables -w --table nat --delete \
LIBVIRT_PRT --source 192.168.122.0/24 --destination 224.0.0.0/24 --jump RETURN \
2021-12-17 00:11:44.232+0000: 28071: debug : virCommandRunAsync:2632 : Command result \
0, with PID 28085 2021-12-17 00:11:44.234+0000: 28071: debug : virCommandRun:2478 : \
Result exit status 0, stdout: '' stderr: '' 2021-12-17 00:11:44.234+0000: 28071: info \
: virFirewallApplyRule:651 : Applying rule '/usr/sbin/iptables -w --table nat \
--delete LIBVIRT_PRT --source 192.168.122.0/24 --destination 255.255.255.255/32 \
--jump RETURN' 2021-12-17 00:11:44.234+0000: 28071: debug : virCommandRunAsync:2629 : \
About to run /usr/sbin/iptables -w --table nat --delete LIBVIRT_PRT --source \
192.168.122.0/24 --destination 255.255.255.255/32 --jump RETURN 2021-12-17 \
00:11:44.235+0000: 28071: debug : virCommandRunAsync:2632 : Command result 0, with \
PID 28086 2021-12-17 00:11:44.238+0000: 28071: debug : virCommandRun:2478 : Result \
exit status 0, stdout: '' stderr: '' 2021-12-17 00:11:44.238+0000: 28071: info : \
virFirewallApplyRule:651 : Applying rule '/usr/sbin/iptables -w --table nat --delete \
LIBVIRT_PRT --source 192.168.122.0/24 -p tcp ! --destination 192.168.122.0/24 --jump \
MASQUERADE --to-ports 1024-65535' 2021-12-17 00:11:44.238+0000: 28071: debug : \
virCommandRunAsync:2629 : About to run /usr/sbin/iptables -w --table nat --delete \
LIBVIRT_PRT --source 192.168.122.0/24 -p tcp '!' --destination 192.168.122.0/24 \
--jump MASQUERADE --to-ports 1024-65535 2021-12-17 00:11:44.239+0000: 28071: debug : \
virCommandRunAsync:2632 : Command result 0, with PID 28087 2021-12-17 \
00:11:44.242+0000: 28071: debug : virCommandRun:2478 : Result exit status 0, stdout: \
'' stderr: '' 2021-12-17 00:11:44.242+0000: 28071: info : virFirewallApplyRule:651 : \
Applying rule '/usr/sbin/iptables -w --table nat --delete LIBVIRT_PRT --source \
192.168.122.0/24 -p udp ! --destination 192.168.122.0/24 --jump MASQUERADE --to-ports \
1024-65535' 2021-12-17 00:11:44.242+0000: 28071: debug : virCommandRunAsync:2629 : \
About to run /usr/sbin/iptables -w --table nat --delete LIBVIRT_PRT --source \
192.168.122.0/24 -p udp '!' --destination 192.168.122.0/24 --jump MASQUERADE \
--to-ports 1024-65535 2021-12-17 00:11:44.243+0000: 28071: debug : \
virCommandRunAsync:2632 : Command result 0, with PID 28088 2021-12-17 \
00:11:44.245+0000: 28071: debug : virCommandRun:2478 : Result exit status 0, stdout: \
'' stderr: '' 2021-12-17 00:11:44.245+0000: 28071: info : virFirewallApplyRule:651 : \
Applying rule '/usr/sbin/iptables -w --table nat --delete LIBVIRT_PRT --source \
192.168.122.0/24 ! --destination 192.168.122.0/24 --jump MASQUERADE' 2021-12-17 \
00:11:44.245+0000: 28071: debug : virCommandRunAsync:2629 : About to run \
/usr/sbin/iptables -w --table nat --delete LIBVIRT_PRT --source 192.168.122.0/24 '!' \
--destination 192.168.122.0/24 --jump MASQUERADE 2021-12-17 00:11:44.246+0000: 28071: \
debug : virCommandRunAsync:2632 : Command result 0, with PID 28089 2021-12-17 \
00:11:44.248+0000: 28071: debug : virCommandRun:2478 : Result exit status 0, stdout: \
'' stderr: '' 2021-12-17 00:11:44.248+0000: 28071: info : virFirewallApplyRule:651 : \
Applying rule '/usr/sbin/iptables -w --table filter --delete LIBVIRT_FWI \
--destination 192.168.122.0/24 --out-interface virbr0 --match conntrack --ctstate \
ESTABLISHED,RELATED --jump ACCEPT' 2021-12-17 00:11:44.248+0000: 28071: debug : \
virCommandRunAsync:2629 : About to run /usr/sbin/iptables -w --table filter --delete \
LIBVIRT_FWI --destination 192.168.122.0/24 --out-interface virbr0 --match conntrack \
--ctstate ESTABLISHED,RELATED --jump ACCEPT 2021-12-17 00:11:44.249+0000: 28071: \
debug : virCommandRunAsync:2632 : Command result 0, with PID 28090 2021-12-17 \
00:11:44.251+0000: 28071: debug : virCommandRun:2478 : Result exit status 0, stdout: \
'' stderr: '' 2021-12-17 00:11:44.251+0000: 28071: info : virFirewallApplyRule:651 : \
Applying rule '/usr/sbin/iptables -w --table filter --delete LIBVIRT_FWO --source \
192.168.122.0/24 --in-interface virbr0 --jump ACCEPT' 2021-12-17 00:11:44.251+0000: \
28071: debug : virCommandRunAsync:2629 : About to run /usr/sbin/iptables -w --table \
filter --delete LIBVIRT_FWO --source 192.168.122.0/24 --in-interface virbr0 --jump \
ACCEPT 2021-12-17 00:11:44.252+0000: 28071: debug : virCommandRunAsync:2632 : Command \
result 0, with PID 28091 2021-12-17 00:11:44.254+0000: 28071: debug : \
virCommandRun:2478 : Result exit status 0, stdout: '' stderr: '' 2021-12-17 \
00:11:44.254+0000: 28071: info : virFirewallApplyRule:651 : Applying rule \
'/usr/sbin/iptables -w --table filter --delete LIBVIRT_FWX --in-interface virbr0 \
--out-interface virbr0 --jump ACCEPT' 2021-12-17 00:11:44.254+0000: 28071: debug : \
virCommandRunAsync:2629 : About to run /usr/sbin/iptables -w --table filter --delete \
LIBVIRT_FWX --in-interface virbr0 --out-interface virbr0 --jump ACCEPT 2021-12-17 \
00:11:44.255+0000: 28071: debug : virCommandRunAsync:2632 : Command result 0, with \
PID 28092 2021-12-17 00:11:44.257+0000: 28071: debug : virCommandRun:2478 : Result \
exit status 0, stdout: '' stderr: '' 2021-12-17 00:11:44.257+0000: 28071: info : \
virFirewallApplyRule:651 : Applying rule '/usr/sbin/iptables -w --table filter \
--delete LIBVIRT_FWI --out-interface virbr0 --jump REJECT' 2021-12-17 \
00:11:44.257+0000: 28071: debug : virCommandRunAsync:2629 : About to run \
/usr/sbin/iptables -w --table filter --delete LIBVIRT_FWI --out-interface virbr0 \
--jump REJECT 2021-12-17 00:11:44.258+0000: 28071: debug : virCommandRunAsync:2632 : \
Command result 0, with PID 28093 2021-12-17 00:11:44.260+0000: 28071: debug : \
virCommandRun:2478 : Result exit status 0, stdout: '' stderr: '' 2021-12-17 \
00:11:44.260+0000: 28071: info : virFirewallApplyRule:651 : Applying rule \
'/usr/sbin/iptables -w --table filter --delete LIBVIRT_FWO --in-interface virbr0 \
--jump REJECT' 2021-12-17 00:11:44.260+0000: 28071: debug : virCommandRunAsync:2629 : \
About to run /usr/sbin/iptables -w --table filter --delete LIBVIRT_FWO --in-interface \
virbr0 --jump REJECT 2021-12-17 00:11:44.261+0000: 28071: debug : \
virCommandRunAsync:2632 : Command result 0, with PID 28094 2021-12-17 \
00:11:44.263+0000: 28071: debug : virCommandRun:2478 : Result exit status 0, stdout: \
'' stderr: '' 2021-12-17 00:11:44.263+0000: 28071: info : virFirewallApplyRule:651 : \
Applying rule '/usr/sbin/iptables -w --table filter --delete LIBVIRT_INP \
--in-interface virbr0 --protocol udp --destination-port 53 --jump ACCEPT' 2021-12-17 \
00:11:44.263+0000: 28071: debug : virCommandRunAsync:2629 : About to run \
/usr/sbin/iptables -w --table filter --delete LIBVIRT_INP --in-interface virbr0 \
--protocol udp --destination-port 53 --jump ACCEPT 2021-12-17 00:11:44.264+0000: \
28071: debug : virCommandRunAsync:2632 : Command result 0, with PID 28095 2021-12-17 \
00:11:44.266+0000: 28071: debug : virCommandRun:2478 : Result exit status 0, stdout: \
'' stderr: '' 2021-12-17 00:11:44.266+0000: 28071: info : virFirewallApplyRule:651 : \
Applying rule '/usr/sbin/iptables -w --table filter --delete LIBVIRT_INP \
--in-interface virbr0 --protocol tcp --destination-port 53 --jump ACCEPT' 2021-12-17 \
00:11:44.266+0000: 28071: debug : virCommandRunAsync:2629 : About to run \
/usr/sbin/iptables -w --table filter --delete LIBVIRT_INP --in-interface virbr0 \
--protocol tcp --destination-port 53 --jump ACCEPT 2021-12-17 00:11:44.266+0000: \
28071: debug : virCommandRunAsync:2632 : Command result 0, with PID 28096 2021-12-17 \
00:11:44.269+0000: 28071: debug : virCommandRun:2478 : Result exit status 0, stdout: \
'' stderr: '' 2021-12-17 00:11:44.269+0000: 28071: info : virFirewallApplyRule:651 : \
Applying rule '/usr/sbin/iptables -w --table filter --delete LIBVIRT_OUT \
--out-interface virbr0 --protocol udp --destination-port 53 --jump ACCEPT' 2021-12-17 \
00:11:44.269+0000: 28071: debug : virCommandRunAsync:2629 : About to run \
/usr/sbin/iptables -w --table filter --delete LIBVIRT_OUT --out-interface virbr0 \
--protocol udp --destination-port 53 --jump ACCEPT 2021-12-17 00:11:44.270+0000: \
28071: debug : virCommandRunAsync:2632 : Command result 0, with PID 28097 2021-12-17 \
00:11:44.272+0000: 28071: debug : virCommandRun:2478 : Result exit status 0, stdout: \
'' stderr: '' 2021-12-17 00:11:44.272+0000: 28071: info : virFirewallApplyRule:651 : \
Applying rule '/usr/sbin/iptables -w --table filter --delete LIBVIRT_OUT \
--out-interface virbr0 --protocol tcp --destination-port 53 --jump ACCEPT' 2021-12-17 \
00:11:44.272+0000: 28071: debug : virCommandRunAsync:2629 : About to run \
/usr/sbin/iptables -w --table filter --delete LIBVIRT_OUT --out-interface virbr0 \
--protocol tcp --destination-port 53 --jump ACCEPT 2021-12-17 00:11:44.273+0000: \
28071: debug : virCommandRunAsync:2632 : Command result 0, with PID 28098 2021-12-17 \
00:11:44.275+0000: 28071: debug : virCommandRun:2478 : Result exit status 0, stdout: \
'' stderr: '' 2021-12-17 00:11:44.275+0000: 28071: info : virFirewallApplyRule:651 : \
Applying rule '/usr/sbin/iptables -w --table filter --delete LIBVIRT_OUT \
--out-interface virbr0 --protocol udp --destination-port 68 --jump ACCEPT' 2021-12-17 \
00:11:44.275+0000: 28071: debug : virCommandRunAsync:2629 : About to run \
/usr/sbin/iptables -w --table filter --delete LIBVIRT_OUT --out-interface virbr0 \
--protocol udp --destination-port 68 --jump ACCEPT 2021-12-17 00:11:44.275+0000: \
28071: debug : virCommandRunAsync:2632 : Command result 0, with PID 28099 2021-12-17 \
00:11:44.278+0000: 28071: debug : virCommandRun:2478 : Result exit status 0, stdout: \
'' stderr: '' 2021-12-17 00:11:44.278+0000: 28071: info : virFirewallApplyRule:651 : \
Applying rule '/usr/sbin/iptables -w --table filter --delete LIBVIRT_OUT \
--out-interface virbr0 --protocol tcp --destination-port 68 --jump ACCEPT' 2021-12-17 \
00:11:44.278+0000: 28071: debug : virCommandRunAsync:2629 : About to run \
/usr/sbin/iptables -w --table filter --delete LIBVIRT_OUT --out-interface virbr0 \
--protocol tcp --destination-port 68 --jump ACCEPT 2021-12-17 00:11:44.279+0000: \
28071: debug : virCommandRunAsync:2632 : Command result 0, with PID 28100 2021-12-17 \
00:11:44.281+0000: 28071: debug : virCommandRun:2478 : Result exit status 0, stdout: \
'' stderr: '' 2021-12-17 00:11:44.281+0000: 28071: info : virFirewallApplyRule:651 : \
Applying rule '/usr/sbin/iptables -w --table filter --delete LIBVIRT_INP \
--in-interface virbr0 --protocol udp --destination-port 67 --jump ACCEPT' 2021-12-17 \
00:11:44.281+0000: 28071: debug : virCommandRunAsync:2629 : About to run \
/usr/sbin/iptables -w --table filter --delete LIBVIRT_INP --in-interface virbr0 \
--protocol udp --destination-port 67 --jump ACCEPT 2021-12-17 00:11:44.281+0000: \
28071: debug : virCommandRunAsync:2632 : Command result 0, with PID 28101 2021-12-17 \
00:11:44.284+0000: 28071: debug : virCommandRun:2478 : Result exit status 0, stdout: \
'' stderr: '' 2021-12-17 00:11:44.284+0000: 28071: info : virFirewallApplyRule:651 : \
Applying rule '/usr/sbin/iptables -w --table filter --delete LIBVIRT_INP \
--in-interface virbr0 --protocol tcp --destination-port 67 --jump ACCEPT' 2021-12-17 \
00:11:44.284+0000: 28071: debug : virCommandRunAsync:2629 : About to run \
/usr/sbin/iptables -w --table filter --delete LIBVIRT_INP --in-interface virbr0 \
--protocol tcp --destination-port 67 --jump ACCEPT 2021-12-17 00:11:44.284+0000: \
28071: debug : virCommandRunAsync:2632 : Command result 0, with PID 28102 2021-12-17 \
00:11:44.287+0000: 28071: debug : virCommandRun:2478 : Result exit status 0, stdout: \
'' stderr: '' 2021-12-17 00:11:44.287+0000: 28071: debug : virFirewallApply:800 : \
Done applying groups for 0x557670125770 2021-12-17 00:11:44.287+0000: 28071: debug : \
virGDBusIsServiceRegistered:404 : Service org.fedoraproject.FirewallD1 is registered \
2021-12-17 00:11:44.289+0000: 28071: debug : virFirewallDZoneExists:250 : Requested \
zone 'libvirt' does exist 2021-12-17 00:11:44.291+0000: 28071: debug : \
virFirewallApply:767 : Applying groups for 0x557670125770 2021-12-17 \
00:11:44.291+0000: 28071: info : virFirewallApplyGroup:710 : Starting transaction for \
firewall=0x557670125770 group=0x557670139680 flags=0x0 2021-12-17 00:11:44.291+0000: \
28071: info : virFirewallApplyRule:651 : Applying rule '/usr/sbin/iptables -w --table \
filter --insert LIBVIRT_INP --in-interface virbr0 --protocol tcp --destination-port \
67 --jump ACCEPT' 2021-12-17 00:11:44.291+0000: 28071: debug : \
virCommandRunAsync:2629 : About to run /usr/sbin/iptables -w --table filter --insert \
LIBVIRT_INP --in-interface virbr0 --protocol tcp --destination-port 67 --jump ACCEPT \
2021-12-17 00:11:44.292+0000: 28071: debug : virCommandRunAsync:2632 : Command result \
0, with PID 28103 2021-12-17 00:11:44.294+0000: 28071: debug : virCommandRun:2478 : \
Result exit status 0, stdout: '' stderr: '' 2021-12-17 00:11:44.294+0000: 28071: info \
: virFirewallApplyRule:651 : Applying rule '/usr/sbin/iptables -w --table filter \
--insert LIBVIRT_INP --in-interface virbr0 --protocol udp --destination-port 67 \
--jump ACCEPT' 2021-12-17 00:11:44.294+0000: 28071: debug : virCommandRunAsync:2629 : \
About to run /usr/sbin/iptables -w --table filter --insert LIBVIRT_INP --in-interface \
virbr0 --protocol udp --destination-port 67 --jump ACCEPT 2021-12-17 \
00:11:44.295+0000: 28071: debug : virCommandRunAsync:2632 : Command result 0, with \
PID 28104 2021-12-17 00:11:44.298+0000: 28071: debug : virCommandRun:2478 : Result \
exit status 0, stdout: '' stderr: '' 2021-12-17 00:11:44.298+0000: 28071: info : \
virFirewallApplyRule:651 : Applying rule '/usr/sbin/iptables -w --table filter \
--insert LIBVIRT_OUT --out-interface virbr0 --protocol tcp --destination-port 68 \
--jump ACCEPT' 2021-12-17 00:11:44.298+0000: 28071: debug : virCommandRunAsync:2629 : \
About to run /usr/sbin/iptables -w --table filter --insert LIBVIRT_OUT \
--out-interface virbr0 --protocol tcp --destination-port 68 --jump ACCEPT 2021-12-17 \
00:11:44.298+0000: 28071: debug : virCommandRunAsync:2632 : Command result 0, with \
PID 28105 2021-12-17 00:11:44.301+0000: 28071: debug : virCommandRun:2478 : Result \
exit status 0, stdout: '' stderr: '' 2021-12-17 00:11:44.301+0000: 28071: info : \
virFirewallApplyRule:651 : Applying rule '/usr/sbin/iptables -w --table filter \
--insert LIBVIRT_OUT --out-interface virbr0 --protocol udp --destination-port 68 \
--jump ACCEPT' 2021-12-17 00:11:44.301+0000: 28071: debug : virCommandRunAsync:2629 : \
About to run /usr/sbin/iptables -w --table filter --insert LIBVIRT_OUT \
--out-interface virbr0 --protocol udp --destination-port 68 --jump ACCEPT 2021-12-17 \
00:11:44.301+0000: 28071: debug : virCommandRunAsync:2632 : Command result 0, with \
PID 28106 2021-12-17 00:11:44.304+0000: 28071: debug : virCommandRun:2478 : Result \
exit status 0, stdout: '' stderr: '' 2021-12-17 00:11:44.304+0000: 28071: info : \
virFirewallApplyRule:651 : Applying rule '/usr/sbin/iptables -w --table filter \
--insert LIBVIRT_INP --in-interface virbr0 --protocol tcp --destination-port 53 \
--jump ACCEPT' 2021-12-17 00:11:44.304+0000: 28071: debug : virCommandRunAsync:2629 : \
2021-12-17 00:11:44.304+0000: 28071: debug : virCommandRunAsync:2632 : Command result \
0, with PID 28107 2021-12-17 00:11:44.307+0000: 28071: debug : virCommandRun:2478 : \
Result exit status 0, stdout: '' stderr: '' 2021-12-17 00:11:44.307+0000: 28071: info \
: virFirewallApplyRule:651 : Applying rule '/usr/sbin/iptables -w --table filter \
--insert LIBVIRT_INP --in-interface virbr0 --protocol udp --destination-port 53 \
--jump ACCEPT' 2021-12-17 00:11:44.307+0000: 28071: debug : virCommandRunAsync:2629 : \
About to run /usr/sbin/iptables -w --table filter --insert LIBVIRT_INP --in-interface \
virbr0 --protocol udp --destination-port 53 --jump ACCEPT 2021-12-17 \
00:11:44.307+0000: 28071: debug : virCommandRunAsync:2632 : Command result 0, with \
PID 28108 2021-12-17 00:11:44.310+0000: 28071: debug : virCommandRun:2478 : Result \
exit status 0, stdout: '' stderr: '' 2021-12-17 00:11:44.310+0000: 28071: info : \
virFirewallApplyRule:651 : Applying rule '/usr/sbin/iptables -w --table filter \
--insert LIBVIRT_OUT --out-interface virbr0 --protocol tcp --destination-port 53 \
--jump ACCEPT' 2021-12-17 00:11:44.310+0000: 28071: debug : virCommandRunAsync:2629 : \
About to run /usr/sbin/iptables -w --table filter --insert LIBVIRT_OUT \
--out-interface virbr0 --protocol tcp --destination-port 53 --jump ACCEPT 2021-12-17 \
00:11:44.310+0000: 28071: debug : virCommandRunAsync:2632 : Command result 0, with \
PID 28109 2021-12-17 00:11:44.313+0000: 28071: debug : virCommandRun:2478 : Result \
exit status 0, stdout: '' stderr: '' 2021-12-17 00:11:44.313+0000: 28071: info : \
virFirewallApplyRule:651 : Applying rule '/usr/sbin/iptables -w --table filter \
--insert LIBVIRT_OUT --out-interface virbr0 --protocol udp --destination-port 53 \
--jump ACCEPT' 2021-12-17 00:11:44.313+0000: 28071: debug : virCommandRunAsync:2629 : \
About to run /usr/sbin/iptables -w --table filter --insert LIBVIRT_OUT \
--out-interface virbr0 --protocol udp --destination-port 53 --jump ACCEPT 2021-12-17 \
00:11:44.314+0000: 28071: debug : virCommandRunAsync:2632 : Command result 0, with \
PID 28110 2021-12-17 00:11:44.316+0000: 28071: debug : virCommandRun:2478 : Result \
exit status 0, stdout: '' stderr: '' 2021-12-17 00:11:44.316+0000: 28071: info : \
virFirewallApplyRule:651 : Applying rule '/usr/sbin/iptables -w --table filter \
--insert LIBVIRT_FWO --in-interface virbr0 --jump REJECT' 2021-12-17 \
00:11:44.316+0000: 28071: debug : virCommandRunAsync:2629 : About to run \
/usr/sbin/iptables -w --table filter --insert LIBVIRT_FWO --in-interface virbr0 \
--jump REJECT 2021-12-17 00:11:44.317+0000: 28071: debug : virCommandRunAsync:2632 : \
Command result 0, with PID 28111 2021-12-17 00:11:44.319+0000: 28071: debug : \
virCommandRun:2478 : Result exit status 0, stdout: '' stderr: '' 2021-12-17 \
00:11:44.319+0000: 28071: info : virFirewallApplyRule:651 : Applying rule \
'/usr/sbin/iptables -w --table filter --insert LIBVIRT_FWI --out-interface virbr0 \
--jump REJECT' 2021-12-17 00:11:44.319+0000: 28071: debug : virCommandRunAsync:2629 : \
About to run /usr/sbin/iptables -w --table filter --insert LIBVIRT_FWI \
--out-interface virbr0 --jump REJECT 2021-12-17 00:11:44.320+0000: 28071: debug : \
virCommandRunAsync:2632 : Command result 0, with PID 28112 2021-12-17 \
00:11:44.322+0000: 28071: debug : virCommandRun:2478 : Result exit status 0, stdout: \
'' stderr: '' 2021-12-17 00:11:44.322+0000: 28071: info : virFirewallApplyRule:651 : \
Applying rule '/usr/sbin/iptables -w --table filter --insert LIBVIRT_FWX \
--in-interface virbr0 --out-interface virbr0 --jump ACCEPT' 2021-12-17 \
00:11:44.322+0000: 28071: debug : virCommandRunAsync:2629 : About to run \
/usr/sbin/iptables -w --table filter --insert LIBVIRT_FWX --in-interface virbr0 \
--out-interface virbr0 --jump ACCEPT 2021-12-17 00:11:44.323+0000: 28071: debug : \
virCommandRunAsync:2632 : Command result 0, with PID 28113 2021-12-17 \
00:11:44.325+0000: 28071: debug : virCommandRun:2478 : Result exit status 0, stdout: \
'' stderr: '' 2021-12-17 00:11:44.325+0000: 28071: info : virFirewallApplyRule:651 : \
Applying rule '/usr/sbin/iptables -w --table filter --insert LIBVIRT_FWO --source \
192.168.122.0/24 --in-interface virbr0 --jump ACCEPT' 2021-12-17 00:11:44.325+0000: \
28071: debug : virCommandRunAsync:2629 : About to run /usr/sbin/iptables -w --table \
filter --insert LIBVIRT_FWO --source 192.168.122.0/24 --in-interface virbr0 --jump \
ACCEPT 2021-12-17 00:11:44.326+0000: 28071: debug : virCommandRunAsync:2632 : Command \
result 0, with PID 28114 2021-12-17 00:11:44.328+0000: 28071: debug : \
virCommandRun:2478 : Result exit status 0, stdout: '' stderr: '' 2021-12-17 \
00:11:44.328+0000: 28071: info : virFirewallApplyRule:651 : Applying rule \
'/usr/sbin/iptables -w --table filter --insert LIBVIRT_FWI --destination \
192.168.122.0/24 --out-interface virbr0 --match conntrack --ctstate \
ESTABLISHED,RELATED --jump ACCEPT' 2021-12-17 00:11:44.328+0000: 28071: debug : \
virCommandRunAsync:2629 : About to run /usr/sbin/iptables -w --table filter --insert \
LIBVIRT_FWI --destination 192.168.122.0/24 --out-interface virbr0 --match conntrack \
--ctstate ESTABLISHED,RELATED --jump ACCEPT 2021-12-17 00:11:44.329+0000: 28071: \
debug : virCommandRunAsync:2632 : Command result 0, with PID 28115 2021-12-17 \
00:11:44.331+0000: 28071: debug : virCommandRun:2478 : Result exit status 0, stdout: \
'' stderr: '' 2021-12-17 00:11:44.331+0000: 28071: info : virFirewallApplyRule:651 : \
Applying rule '/usr/sbin/iptables -w --table nat --insert LIBVIRT_PRT --source \
192.168.122.0/24 ! --destination 192.168.122.0/24 --jump MASQUERADE' 2021-12-17 \
00:11:44.331+0000: 28071: debug : virCommandRunAsync:2629 : About to run \
/usr/sbin/iptables -w --table nat --insert LIBVIRT_PRT --source 192.168.122.0/24 '!' \
--destination 192.168.122.0/24 --jump MASQUERADE 2021-12-17 00:11:44.332+0000: 28071: \
debug : virCommandRunAsync:2632 : Command result 0, with PID 28116 2021-12-17 \
00:11:44.334+0000: 28071: debug : virCommandRun:2478 : Result exit status 0, stdout: \
'' stderr: '' 2021-12-17 00:11:44.334+0000: 28071: info : virFirewallApplyRule:651 : \
Applying rule '/usr/sbin/iptables -w --table nat --insert LIBVIRT_PRT --source \
192.168.122.0/24 -p udp ! --destination 192.168.122.0/24 --jump MASQUERADE --to-ports \
1024-65535' 2021-12-17 00:11:44.334+0000: 28071: debug : virCommandRunAsync:2629 : \
About to run /usr/sbin/iptables -w --table nat --insert LIBVIRT_PRT --source \
192.168.122.0/24 -p udp '!' --destination 192.168.122.0/24 --jump MASQUERADE \
--to-ports 1024-65535 2021-12-17 00:11:44.335+0000: 28071: debug : \
virCommandRunAsync:2632 : Command result 0, with PID 28117 2021-12-17 \
00:11:44.337+0000: 28071: debug : virCommandRun:2478 : Result exit status 0, stdout: \
'' stderr: '' 2021-12-17 00:11:44.337+0000: 28071: info : virFirewallApplyRule:651 : \
Applying rule '/usr/sbin/iptables -w --table nat --insert LIBVIRT_PRT --source \
192.168.122.0/24 -p tcp ! --destination 192.168.122.0/24 --jump MASQUERADE --to-ports \
1024-65535' 2021-12-17 00:11:44.337+0000: 28071: debug : virCommandRunAsync:2629 : \
About to run /usr/sbin/iptables -w --table nat --insert LIBVIRT_PRT --source \
192.168.122.0/24 -p tcp '!' --destination 192.168.122.0/24 --jump MASQUERADE \
--to-ports 1024-65535 2021-12-17 00:11:44.338+0000: 28071: debug : \
virCommandRunAsync:2632 : Command result 0, with PID 28118 2021-12-17 \
00:11:44.340+0000: 28071: debug : virCommandRun:2478 : Result exit status 0, stdout: \
'' stderr: '' 2021-12-17 00:11:44.340+0000: 28071: info : virFirewallApplyRule:651 : \
Applying rule '/usr/sbin/iptables -w --table nat --insert LIBVIRT_PRT --source \
192.168.122.0/24 --destination 255.255.255.255/32 --jump RETURN' 2021-12-17 \
00:11:44.340+0000: 28071: debug : virCommandRunAsync:2629 : About to run \
/usr/sbin/iptables -w --table nat --insert LIBVIRT_PRT --source 192.168.122.0/24 \
--destination 255.255.255.255/32 --jump RETURN 2021-12-17 00:11:44.341+0000: 28071: \
debug : virCommandRunAsync:2632 : Command result 0, with PID 28119 2021-12-17 \
00:11:44.343+0000: 28071: debug : virCommandRun:2478 : Result exit status 0, stdout: \
'' stderr: '' 2021-12-17 00:11:44.343+0000: 28071: info : virFirewallApplyRule:651 : \
Applying rule '/usr/sbin/iptables -w --table nat --insert LIBVIRT_PRT --source \
192.168.122.0/24 --destination 224.0.0.0/24 --jump RETURN' 2021-12-17 \
00:11:44.343+0000: 28071: debug : virCommandRunAsync:2629 : About to run \
/usr/sbin/iptables -w --table nat --insert LIBVIRT_PRT --source 192.168.122.0/24 \
--destination 224.0.0.0/24 --jump RETURN 2021-12-17 00:11:44.344+0000: 28071: debug : \
virCommandRunAsync:2632 : Command result 0, with PID 28120 2021-12-17 \
00:11:44.346+0000: 28071: debug : virCommandRun:2478 : Result exit status 0, stdout: \
'' stderr: '' 2021-12-17 00:11:44.346+0000: 28071: info : virFirewallApplyGroup:710 : \
Starting transaction for firewall=0x557670125770 group=0x55767012c2f0 flags=0x1 \
2021-12-17 00:11:44.346+0000: 28071: info : virFirewallApplyRule:651 : Applying rule \
'/usr/sbin/iptables -w --table mangle --insert LIBVIRT_PRT --out-interface virbr0 \
--protocol udp --destination-port 68 --jump CHECKSUM --checksum-fill' 2021-12-17 \
00:11:44.346+0000: 28071: debug : virCommandRunAsync:2629 : About to run \
/usr/sbin/iptables -w --table mangle --insert LIBVIRT_PRT --out-interface virbr0 \
--protocol udp --destination-port 68 --jump CHECKSUM --checksum-fill 2021-12-17 \
00:11:44.347+0000: 28071: debug : virCommandRunAsync:2632 : Command result 0, with \
PID 28121 2021-12-17 00:11:44.350+0000: 28071: debug : virCommandRun:2478 : Result \
exit status 0, stdout: '' stderr: '' 2021-12-17 00:11:44.351+0000: 28071: debug : \
virFirewallApply:800 : Done applying groups for 0x557670125770 2021-12-17 \
00:11:44.351+0000: 28071: debug : virStateInitialize:660 : State init result 1 \
(mandatory=0) 2021-12-17 00:11:44.351+0000: 28071: debug : virStateInitialize:654 : \
Running global init for netcf state driver 2021-12-17 00:11:44.355+0000: 28071: debug \
: virStateInitialize:660 : State init result 1 (mandatory=0) 2021-12-17 \
00:11:44.355+0000: 28071: debug : virStateInitialize:654 : Running global init for \
secret state driver 2021-12-17 00:11:44.355+0000: 28071: debug : \
virStateInitialize:660 : State init result 1 (mandatory=0) 2021-12-17 \
00:11:44.355+0000: 28071: debug : virStateInitialize:654 : Running global init for \
storage state driver 2021-12-17 00:11:44.355+0000: 28071: debug : \
virStateInitialize:660 : State init result 1 (mandatory=0) 2021-12-17 \
00:11:44.355+0000: 28071: debug : virStateInitialize:654 : Running global init for \
udev state driver 2021-12-17 00:11:44.356+0000: 28122: debug : virThreadJobSet:97 : \
Thread 28122 is now running job udev-event 2021-12-17 00:11:44.361+0000: 28071: debug \
: virStateInitialize:660 : State init result 1 (mandatory=0) 2021-12-17 \
00:11:44.361+0000: 28071: debug : virStateInitialize:654 : Running global init for \
NWFilter state driver 2021-12-17 00:11:44.361+0000: 28123: debug : virThreadJobSet:97 \
: Thread 28123 is now running job nodedev-init 2021-12-17 00:11:44.361+0000: 28071: \
debug : virFirewallApply:767 : Applying groups for 0x557670c490e0 2021-12-17 \
00:11:44.361+0000: 28071: info : virFirewallApplyGroup:710 : Starting transaction for \
firewall=0x557670c490e0 group=0x557670c49110 flags=0x0 2021-12-17 00:11:44.361+0000: \
28071: info : virFirewallApplyRule:651 : Applying rule '/usr/sbin/iptables -w \
--version' 2021-12-17 00:11:44.361+0000: 28071: debug : virCommandRunAsync:2629 : \
About to run /usr/sbin/iptables -w --version 2021-12-17 00:11:44.362+0000: 28071: \
debug : virCommandRunAsync:2632 : Command result 0, with PID 28124 2021-12-17 \
00:11:44.364+0000: 28071: debug : virCommandRun:2478 : Result exit status 0, stdout: \
'iptables v1.8.4 (nf_tables) ' stderr: ''
2021-12-17 00:11:44.364+0000: 28071: debug : virFirewallApplyRule:686 : Invoking \
query 0x7f4986a1db00 with 'iptables v1.8.4 (nf_tables) '
2021-12-17 00:11:44.364+0000: 28071: debug : virFirewallApply:800 : Done applying \
groups for 0x557670c490e0 2021-12-17 00:11:44.365+0000: 28071: info : \
virNWFilterBindingObjListLoadAllConfigs:302 : Scanning for configs in \
/run/libvirt/nwfilter-binding 2021-12-17 00:11:44.365+0000: 28071: debug : \
virStateInitialize:660 : State init result 1 (mandatory=0) 2021-12-17 \
00:11:44.365+0000: 28071: debug : virStateInitialize:654 : Running global init for \
QEMU state driver 2021-12-17 00:11:44.365+0000: 28071: debug : virArchFromHost:234 : \
Mapped x86_64 to 34 (x86_64) 2021-12-17 00:11:44.365+0000: 28071: debug : \
virCommandRunAsync:2629 : About to run dmidecode -q -t 0,1,2,3,4,11,17 2021-12-17 \
00:11:44.366+0000: 28071: debug : virCommandRunAsync:2632 : Command result 0, with \
PID 28125 2021-12-17 00:11:44.368+0000: 28071: debug : virCommandRun:2478 : Result \
status 0, stdout: 'BIOS Information  Vendor: SeaBIOS
	Version: 1.13.0-2.module+el8.3.0+7353+9de0a3cc
	Release Date: 04/01/2014
	Address: 0xE8000
	Runtime Size: 96 kB
	ROM Size: 64 kB
	Characteristics:
		BIOS characteristics not supported
		Targeted content distribution is supported
	BIOS Revision: 0.0

System Information
	Manufacturer: Red Hat
	Product Name: KVM
	Version: RHEL-8.2.0 PC (Q35 + ICH9, 2009)
	Serial Number: Not Specified
	UUID: d77aebdb-2dae-4e44-9e3d-f9d1ed158d68
	Wake-up Type: Power Switch
	SKU Number: 8.2.0
	Family: Red Hat Enterprise Linux

Base Board Information
	Manufacturer: Red Hat
	Product Name: RHEL-AV
	Version: RHEL-8.2.0 PC (Q35 + ICH9, 2009)
	Serial Number: Not Specified
	Asset Tag: Not Specified
	Features:
		Board is a hosting board
	Location In Chassis: Not Specified
	Type: Motherboard

Chassis Information
	Manufacturer: Red Hat
	Type: Other
	Lock: Not Present
	Version: RHEL-8.2.0 PC (Q35 + ICH9, 2009)
	Serial Number: Not Specified
	Asset Tag: Not Specified
	Boot-up State: Safe
	Power Supply State: Safe
	Thermal State: Safe
	Security Status: Unknown
	OEM Information: 0x00000000
	Height: Unspecified
	Number Of Power Cords: Unspecified
	Contained Elements: 0
	SKU Number: Not Specified

Processor Information
	Socket Designation: CPU 0
	Type: Central Processor
	Family: Other
	Manufacturer: Red Hat
	ID: 57 06 05 00 FF FB 8B 0F
	Version: RHEL-8.2.0 PC (Q35 + ICH9, 2009)
	Voltage: Unknown
	External Clock: Unknown
	Max Speed: 2000 MHz
	Current Speed: 2000 MHz
	Status: Populated, Enabled
	Upgrade: Other
	Serial Number: Not Specified
	Asset Tag: Not Specified
	Part Number: Not Specified
	Core Count: 1
	Core Enabled: 1
	Thread Count: 1
	Characteristics: None

Processor Information
	Socket Designation: CPU 1
	Type: Central Processor
	Family: Other
	Manufacturer: Red Hat
	ID: 57 06 05 00 FF FB 8B 0F
	Version: RHEL-8.2.0 PC (Q35 + ICH9, 2009)
	Voltage: Unknown
	External Clock: Unknown
	Max Speed: 2000 MHz
	Current Speed: 2000 MHz
	Status: Populated, Enabled
	Upgrade: Other
	Serial Number: Not Specified
	Asset Tag: Not Specified
	Part Number: Not Specified
	Core Count: 1
	Core Enabled: 1
	Thread Count: 1
	Characteristics: None

Memory Device
	Total Width: Unknown
	Data Width: Unknown
	Size: 1792 MB
	Form Factor: DIMM
	Set: None
	Locator: DIMM 0
	Bank Locator: Not Specified
	Type: RAM
	Type Detail: Other
	Speed: Unknown
	Manufacturer: Red Hat
	Serial Number: Not Specified
	Asset Tag: Not Specified
	Part Number: Not Specified
	Rank: Unknown
	Configured Memory Speed: Unknown
	Minimum Voltage: Unknown
	Maximum Voltage: Unknown
	Configured Voltage: Unknown

' stderr: ''
2021-12-17 00:11:44.378+0000: 28071: debug : virProcessNamespaceAvailable:1512 : All \
namespaces (2) are enabled 2021-12-17 00:11:44.378+0000: 28071: debug : \
virConfReadFile:724 : filename=/etc/libvirt/qemu.conf 2021-12-17 00:11:44.378+0000: \
28071: debug : virConfAddEntry:215 : Add entry vnc_sasl 0x557670c46570 2021-12-17 \
00:11:44.379+0000: 28071: debug : virConfAddEntry:215 : Add entry dynamic_ownership \
0x557670c948f0 2021-12-17 00:11:44.379+0000: 28071: debug : virConfAddEntry:215 : Add \
entry group 0x557670c949d0 2021-12-17 00:11:44.379+0000: 28071: debug : \
virConfAddEntry:215 : Add entry lock_manager 0x557670c94a80 2021-12-17 \
00:11:44.379+0000: 28071: debug : virConfAddEntry:215 : Add entry max_core \
0x557670c94b20 2021-12-17 00:11:44.379+0000: 28071: debug : virConfAddEntry:215 : Add \
entry migrate_tls_x509_cert_dir 0x557670c94bb0 2021-12-17 00:11:44.379+0000: 28071: \
debug : virConfAddEntry:215 : Add entry remote_display_port_max 0x557670c94c80 \
2021-12-17 00:11:44.379+0000: 28071: debug : virConfAddEntry:215 : Add entry \
remote_display_port_min 0x557670c94d00 2021-12-17 00:11:44.379+0000: 28071: debug : \
virConfAddEntry:215 : Add entry save_image_format 0x557670c94da0 2021-12-17 \
00:11:44.379+0000: 28071: debug : virConfAddEntry:215 : Add entry spice_tls \
0x557670c94e20 2021-12-17 00:11:44.379+0000: 28071: debug : virConfAddEntry:215 : Add \
entry spice_tls_x509_cert_dir 0x557670c94ea0 2021-12-17 00:11:44.379+0000: 28071: \
debug : virConfAddEntry:215 : Add entry user 0x557670c94f40 2021-12-17 \
00:11:44.380+0000: 28071: debug : virConfGetValueString:869 : Get value string (nil) \
0 2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueBool:994 : Get value \
bool (nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueString:869 : \
Get value string (nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : \
virConfGetValueBool:994 : Get value bool (nil) 0 2021-12-17 00:11:44.380+0000: 28071: \
debug : virConfGetValueBool:994 : Get value bool (nil) 0 2021-12-17 \
00:11:44.380+0000: 28071: debug : virConfGetValueBool:994 : Get value bool (nil) 0 \
2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueString:869 : Get value \
string (nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueString:869 \
: Get value string (nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : \
virConfGetValueString:869 : Get value string (nil) 0 2021-12-17 00:11:44.380+0000: \
28071: debug : virConfGetValueString:869 : Get value string (nil) 0 2021-12-17 \
00:11:44.380+0000: 28071: debug : virConfGetValueBool:994 : Get value bool \
0x557670c46570 2 2021-12-17 00:11:44.380+0000: 28071: debug : \
virConfGetValueString:869 : Get value string (nil) 0 2021-12-17 00:11:44.380+0000: \
28071: debug : virConfGetValueBool:994 : Get value bool (nil) 0 2021-12-17 \
00:11:44.380+0000: 28071: debug : virConfGetValueBool:994 : Get value bool (nil) 0 \
2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueBool:994 : Get value bool \
0x557670c94e20 2 2021-12-17 00:11:44.380+0000: 28071: debug : \
virConfGetValueString:869 : Get value string 0x557670c94ea0 3 2021-12-17 \
00:11:44.380+0000: 28071: debug : virConfGetValueBool:994 : Get value bool (nil) 0 \
2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueString:869 : Get value \
string (nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueString:869 \
: Get value string (nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : \
virConfGetValueString:869 : Get value string (nil) 0 2021-12-17 00:11:44.380+0000: \
28071: debug : virConfGetValueBool:994 : Get value bool (nil) 0 2021-12-17 \
00:11:44.380+0000: 28071: debug : virConfGetValueBool:994 : Get value bool (nil) 0 \
2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueBool:994 : Get value bool \
(nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueBool:994 : Get \
value bool (nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : \
virConfGetValueBool:994 : Get value bool (nil) 0 2021-12-17 00:11:44.380+0000: 28071: \
debug : virConfGetValueString:869 : Get value string (nil) 0 2021-12-17 \
00:11:44.380+0000: 28071: debug : virConfGetValueString:869 : Get value string (nil) \
0 2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueBool:994 : Get value \
bool (nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueString:869 : \
Get value string 0x557670c94bb0 3 2021-12-17 00:11:44.380+0000: 28071: debug : \
virConfGetValueString:869 : Get value string (nil) 0 2021-12-17 00:11:44.380+0000: \
28071: debug : virConfGetValueBool:994 : Get value bool (nil) 0 2021-12-17 \
00:11:44.380+0000: 28071: debug : virConfGetValueString:869 : Get value string (nil) \
0 2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueString:869 : Get value \
string (nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueBool:994 : \
Get value bool (nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : \
virConfGetValueString:869 : Get value string (nil) 0 2021-12-17 00:11:44.380+0000: \
28071: debug : virConfGetValueString:869 : Get value string (nil) 0 2021-12-17 \
00:11:44.380+0000: 28071: debug : virConfGetValueString:869 : Get value string (nil) \
0 2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueString:869 : Get value \
string (nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueUInt:1091 \
: Get value uint (nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : \
virConfGetValueUInt:1091 : Get value uint (nil) 0 2021-12-17 00:11:44.380+0000: \
28071: debug : virConfGetValueUInt:1091 : Get value uint 0x557670c94d00 2 2021-12-17 \
00:11:44.380+0000: 28071: debug : virConfGetValueUInt:1091 : Get value uint \
0x557670c94c80 2 2021-12-17 00:11:44.380+0000: 28071: debug : \
virConfGetValueString:869 : Get value string 0x557670c94da0 3 2021-12-17 \
00:11:44.380+0000: 28071: debug : virConfGetValueString:869 : Get value string (nil) \
0 2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueString:869 : Get value \
string (nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueString:869 \
: Get value string (nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : \
virConfGetValueBool:994 : Get value bool (nil) 0 2021-12-17 00:11:44.380+0000: 28071: \
debug : virConfGetValueBool:994 : Get value bool (nil) 0 2021-12-17 \
00:11:44.380+0000: 28071: debug : virConfGetValueStringList:917 : Get value string \
list (nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueString:869 : \
Get value string (nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : \
virConfGetValueString:869 : Get value string (nil) 0 2021-12-17 00:11:44.380+0000: \
28071: debug : virConfGetValueString:869 : Get value string (nil) 0 2021-12-17 \
00:11:44.380+0000: 28071: debug : virConfGetValueString:869 : Get value string (nil) \
0 2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueBool:994 : Get value \
bool (nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueUInt:1091 : \
Get value uint (nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : \
virConfGetValueUInt:1091 : Get value uint (nil) 0 2021-12-17 00:11:44.380+0000: \
28071: debug : virConfGetValueUInt:1091 : Get value uint (nil) 0 2021-12-17 \
00:11:44.380+0000: 28071: debug : virConfGetValueString:869 : Get value string \
0x557670c94b20 3 2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueBool:994 \
: Get value bool (nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : \
virConfGetValueString:869 : Get value string (nil) 0 2021-12-17 00:11:44.380+0000: \
28071: debug : virConfGetValueBool:994 : Get value bool (nil) 0 2021-12-17 \
00:11:44.380+0000: 28071: debug : virConfGetValueBool:994 : Get value bool (nil) 0 \
2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueString:869 : Get value \
string 0x557670c94a80 3 2021-12-17 00:11:44.380+0000: 28071: debug : \
virConfGetValueBool:994 : Get value bool (nil) 0 2021-12-17 00:11:44.380+0000: 28071: \
debug : virConfGetValueUInt:1091 : Get value uint (nil) 0 2021-12-17 \
00:11:44.380+0000: 28071: debug : virConfGetValueInt:1042 : Get value int (nil) 0 \
2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueUInt:1091 : Get value \
uint (nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueUInt:1091 : \
Get value uint (nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : \
virConfGetValueUInt:1091 : Get value uint (nil) 0 2021-12-17 00:11:44.380+0000: \
28071: debug : virConfGetValueString:869 : Get value string (nil) 0 2021-12-17 \
00:11:44.380+0000: 28071: debug : virConfGetValueString:869 : Get value string (nil) \
0 2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueBool:994 : Get value \
bool (nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : \
virConfGetValueStringList:917 : Get value string list (nil) 0 2021-12-17 \
00:11:44.380+0000: 28071: debug : virConfGetValueUInt:1091 : Get value uint (nil) 0 \
2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueBool:994 : Get value bool \
(nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueString:869 : Get \
value string (nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : \
virConfGetValueStringList:917 : Get value string list (nil) 0 2021-12-17 \
00:11:44.380+0000: 28071: debug : virConfGetValueBool:994 : Get value bool (nil) 0 \
2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueBool:994 : Get value bool \
(nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueString:869 : Get \
value string 0x557670c94f40 3 2021-12-17 00:11:44.380+0000: 28071: debug : \
virConfGetValueString:869 : Get value string 0x557670c949d0 3 2021-12-17 \
00:11:44.380+0000: 28071: debug : virConfGetValueBool:994 : Get value bool \
0x557670c948f0 2 2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueBool:994 \
: Get value bool (nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : \
virConfGetValueStringList:917 : Get value string list (nil) 0 2021-12-17 \
00:11:44.380+0000: 28071: debug : virConfGetValueStringList:917 : Get value string \
list (nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueInt:1042 : \
Get value int (nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : \
virConfGetValueStringList:917 : Get value string list (nil) 0 2021-12-17 \
00:11:44.380+0000: 28071: debug : virConfGetValueString:869 : Get value string (nil) \
0 2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueString:869 : Get value \
string (nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : virConfGetValueString:869 \
: Get value string (nil) 0 2021-12-17 00:11:44.380+0000: 28071: debug : \
virConfGetValueStringList:917 : Get value string list (nil) 0 2021-12-17 \
00:11:44.381+0000: 28071: debug : virConfReadFile:724 : \
filename=/etc/libvirt/qemu-sanlock.conf 2021-12-17 00:11:44.381+0000: 28071: debug : \
virConfAddEntry:215 : Add entry auto_disk_leases 0x557670c94080 2021-12-17 \
00:11:44.381+0000: 28071: debug : virConfAddEntry:215 : Add entry \
require_lease_for_disks 0x557670c94140 2021-12-17 00:11:44.381+0000: 28071: debug : \
virConfGetValueBool:994 : Get value bool 0x557670c94080 2 2021-12-17 \
00:11:44.381+0000: 28071: debug : virConfGetValueString:869 : Get value string (nil) \
0 2021-12-17 00:11:44.381+0000: 28071: debug : virConfGetValueUInt:1091 : Get value \
uint (nil) 0 2021-12-17 00:11:44.381+0000: 28071: debug : virConfGetValueBool:994 : \
Get value bool 0x557670c94140 2 2021-12-17 00:11:44.381+0000: 28071: debug : \
virConfGetValueUInt:1091 : Get value uint (nil) 0 2021-12-17 00:11:44.381+0000: \
28071: debug : virConfGetValueString:869 : Get value string (nil) 0 2021-12-17 \
00:11:44.381+0000: 28071: debug : virConfGetValueString:869 : Get value string (nil) \
0 2021-12-17 00:11:44.381+0000: 28071: debug : virSecurityDriverLookup:54 : \
name=&lt;null&gt; 2021-12-17 00:11:44.381+0000: 28071: debug : virSecurityDriverLookup:65 : \
Probed name=selinux 2021-12-17 00:11:44.381+0000: 28071: debug : \
virSecurityManagerNewDriver:86 : drv=0x7f49acb4b3a0 (selinux) virtDriver=QEMU \
flags=0xa 2021-12-17 00:11:44.381+0000: 28071: debug : \
virSecuritySELinuxInitialize:775 : SELinuxInitialize QEMU 2021-12-17 \
00:11:44.383+0000: 28071: debug : virSecuritySELinuxQEMUInitialize:734 : Loaded \
domain context 'system_u:system_r:svirt_t:s0', alt domain context \
'system_u:system_r:svirt_tcg_t:s0' 2021-12-17 00:11:44.383+0000: 28071: debug : \
virSecuritySELinuxQEMUInitialize:754 : Loaded file context \
'system_u:object_r:svirt_image_t:s0', content context \
'system_u:object_r:virt_content_t:s0' 2021-12-17 00:11:44.383+0000: 28071: debug : \
virSecurityManagerNewDriver:86 : drv=0x7f49acb4b200 (stack) virtDriver=QEMU flags=0xa \
2021-12-17 00:11:44.383+0000: 28071: debug : virSecurityManagerNewDriver:86 : \
drv=0x7f49acb4aec0 (dac) virtDriver=QEMU flags=0xa 2021-12-17 00:11:44.384+0000: \
28071: debug : virArchFromHost:234 : Mapped x86_64 to 34 (x86_64) 2021-12-17 \
00:11:44.384+0000: 28071: debug : virArchFromHost:234 : Mapped x86_64 to 34 (x86_64) \
2021-12-17 00:11:44.384+0000: 28071: debug : virArchFromHost:234 : Mapped x86_64 to \
34 (x86_64) 2021-12-17 00:11:44.384+0000: 28123: debug : \
virPCIGetDeviceAddressFromSysfsLink:2280 : \
'/sys/devices/pci0000:00/0000:00:00.0/physfn' does not exist 2021-12-17 \
00:11:44.384+0000: 28123: debug : virPCIGetVirtualFunctionsFull:2403 : Found 0 \
virtual functions for /sys/devices/pci0000:00/0000:00:00.0 2021-12-17 \
00:11:44.384+0000: 28071: debug : virArchFromHost:234 : Mapped x86_64 to 34 (x86_64) \
2021-12-17 00:11:44.384+0000: 28123: debug : virPCIDeviceNew:1496 : 8086 29c0 \
0000:00:00.0: initialized 2021-12-17 00:11:44.384+0000: 28123: info : \
virPCIDeviceHasVPD:2646 : Device VPD file does not exist \
/sys/bus/pci/devices/0000:00:00.0/vpd 2021-12-17 00:11:44.384+0000: 28123: debug : \
virPCIDeviceFree:1526 : 8086 29c0 0000:00:00.0: freeing 2021-12-17 00:11:44.384+0000: \
28123: debug : virPCIDeviceNew:1496 : 8086 29c0 0000:00:00.0: initialized 2021-12-17 \
00:11:44.384+0000: 28123: debug : virPCIDeviceConfigOpenInternal:300 : 8086 29c0 \
0000:00:00.0: opened /sys/bus/pci/devices/0000:00:00.0/config 2021-12-17 \
00:11:44.384+0000: 28071: info : virDomainObjListLoadAllConfigs:588 : Scanning for \
configs in /run/libvirt/qemu 2021-12-17 00:11:44.384+0000: 28071: info : \
virDomainObjListLoadAllConfigs:588 : Scanning for configs in /etc/libvirt/qemu \
2021-12-17 00:11:44.384+0000: 28071: debug : virStateInitialize:660 : State init \
result 1 (mandatory=0) 2021-12-17 00:11:44.384+0000: 28071: debug : \
virThreadJobClear:122 : Thread 28071 finished job daemon-init with ret=0 2021-12-17 \
00:11:44.385+0000: 28123: debug : virPCIDeviceConfigOpenInternal:300 : 8086 29c0 \
0000:00:00.0: opened /sys/bus/pci/devices/0000:00:00.0/config 2021-12-17 \
00:11:44.385+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : 8086 29c0 \
0000:00:00.0: failed to find cap 0x10 (Success) 2021-12-17 00:11:44.385+0000: 28123: \
debug : virPCIDeviceFindCapabilityOffset:575 : 8086 29c0 0000:00:00.0: failed to find \
cap 0x01 (Success) 2021-12-17 00:11:44.385+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:575 : 8086 29c0 0000:00:00.0: failed to find cap \
0x13 (Success) 2021-12-17 00:11:44.385+0000: 28123: debug : \
virPCIDeviceDetectFunctionLevelReset:667 : 8086 29c0 0000:00:00.0: no FLR capability \
found 2021-12-17 00:11:44.385+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:689 : 8086 29c0 0000:00:00.0: no PM reset \
capability found 2021-12-17 00:11:44.385+0000: 28123: debug : virPCIDeviceFree:1526 : \
8086 29c0 0000:00:00.0: freeing 2021-12-17 00:11:44.385+0000: 28123: debug : \
virObjectEventNew:621 : obj=0x557670115420 2021-12-17 00:11:44.385+0000: 28123: debug \
: virNodeDeviceEventLifecycleDispose:92 : obj=0x557670115420 2021-12-17 \
00:11:44.385+0000: 28123: debug : virNodeDeviceEventDispose:84 : obj=0x557670115420 \
2021-12-17 00:11:44.385+0000: 28123: debug : virObjectEventDispose:122 : \
obj=0x557670115420 2021-12-17 00:11:44.387+0000: 28123: debug : \
virPCIGetDeviceAddressFromSysfsLink:2280 : \
2021-12-17 00:11:44.387+0000: 28123: debug : virPCIDeviceNew:1496 : 1b36 000c \
0000:00:01.0: initialized 2021-12-17 00:11:44.387+0000: 28123: info : \
virPCIDeviceHasVPD:2646 : Device VPD file does not exist \
/sys/bus/pci/devices/0000:00:01.0/vpd 2021-12-17 00:11:44.387+0000: 28123: debug : \
virPCIDeviceFree:1526 : 1b36 000c 0000:00:01.0: freeing 2021-12-17 00:11:44.387+0000: \
28123: debug : virPCIDeviceNew:1496 : 1b36 000c 0000:00:01.0: initialized 2021-12-17 \
00:11:44.387+0000: 28123: debug : virPCIDeviceConfigOpenInternal:300 : 1b36 000c \
0000:00:01.0: opened /sys/bus/pci/devices/0000:00:01.0/config 2021-12-17 \
00:11:44.388+0000: 28123: debug : virPCIDeviceConfigOpenInternal:300 : 1b36 000c \
0000:00:01.0: opened /sys/bus/pci/devices/0000:00:01.0/config 2021-12-17 \
00:11:44.388+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:563 : 1b36 000c \
0000:00:01.0: found cap 0x10 at 0x54 2021-12-17 00:11:44.388+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:575 : 1b36 000c 0000:00:01.0: failed to find cap \
0x01 (Success) 2021-12-17 00:11:44.388+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:575 : 1b36 000c 0000:00:01.0: failed to find cap \
0x13 (Success) 2021-12-17 00:11:44.388+0000: 28123: debug : \
virPCIDeviceDetectFunctionLevelReset:667 : 1b36 000c 0000:00:01.0: no FLR capability \
found 2021-12-17 00:11:44.388+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:689 : 1b36 000c 0000:00:01.0: no PM reset \
capability found 2021-12-17 00:11:44.388+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1b36 000c 0000:00:01.0: opened \
/sys/bus/pci/devices/0000:00:01.0/config 2021-12-17 00:11:44.388+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1b36 000c 0000:00:01.0: found cap 0x10 at 0x54 \
2021-12-17 00:11:44.388+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : \
1b36 000c 0000:00:01.0: failed to find cap 0x01 (Success) 2021-12-17 \
00:11:44.388+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : 1b36 000c \
0000:00:01.0: failed to find cap 0x13 (Success) 2021-12-17 00:11:44.388+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:667 : 1b36 000c 0000:00:01.0: no FLR \
capability found 2021-12-17 00:11:44.388+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:689 : 1b36 000c 0000:00:01.0: no PM reset \
capability found 2021-12-17 00:11:44.388+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1b36 000c 0000:00:01.0: opened \
/sys/bus/pci/devices/0000:00:01.0/config 2021-12-17 00:11:44.388+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1b36 000c 0000:00:01.0: found cap 0x10 at 0x54 \
2021-12-17 00:11:44.388+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : \
1b36 000c 0000:00:01.0: failed to find cap 0x01 (Success) 2021-12-17 \
00:11:44.388+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : 1b36 000c \
0000:00:01.0: failed to find cap 0x13 (Success) 2021-12-17 00:11:44.388+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:667 : 1b36 000c 0000:00:01.0: no FLR \
capability found 2021-12-17 00:11:44.388+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:689 : 1b36 000c 0000:00:01.0: no PM reset \
capability found 2021-12-17 00:11:44.388+0000: 28123: debug : virPCIDeviceFree:1526 : \
1b36 000c 0000:00:01.0: freeing 2021-12-17 00:11:44.388+0000: 28123: debug : \
virObjectEventNew:621 : obj=0x5576701154a0 2021-12-17 00:11:44.388+0000: 28123: debug \
: virNodeDeviceEventLifecycleDispose:92 : obj=0x5576701154a0 2021-12-17 \
00:11:44.388+0000: 28123: debug : virNodeDeviceEventDispose:84 : obj=0x5576701154a0 \
2021-12-17 00:11:44.388+0000: 28123: debug : virObjectEventDispose:122 : \
obj=0x5576701154a0 2021-12-17 00:11:44.391+0000: 28123: debug : \
virPCIGetDeviceAddressFromSysfsLink:2280 : \
'/sys/devices/pci0000:00/0000:00:01.0/0000:01:00.0/physfn' does not exist 2021-12-17 \
00:11:44.391+0000: 28123: debug : virPCIGetVirtualFunctionsFull:2403 : Found 0 \
virtual functions for /sys/devices/pci0000:00/0000:00:01.0/0000:01:00.0 2021-12-17 \
00:11:44.391+0000: 28123: debug : virPCIDeviceNew:1496 : 1af4 1041 0000:01:00.0: \
initialized 2021-12-17 00:11:44.391+0000: 28123: info : virPCIDeviceHasVPD:2646 : \
Device VPD file does not exist /sys/bus/pci/devices/0000:01:00.0/vpd 2021-12-17 \
00:11:44.391+0000: 28123: debug : virPCIDeviceFree:1526 : 1af4 1041 0000:01:00.0: \
freeing 2021-12-17 00:11:44.391+0000: 28123: debug : virPCIDeviceNew:1496 : 1af4 1041 \
0000:01:00.0: initialized 2021-12-17 00:11:44.391+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1af4 1041 0000:01:00.0: opened \
/sys/bus/pci/devices/0000:01:00.0/config 2021-12-17 00:11:44.391+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1af4 1041 0000:01:00.0: opened \
/sys/bus/pci/devices/0000:01:00.0/config 2021-12-17 00:11:44.391+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1af4 1041 0000:01:00.0: found cap 0x10 at 0x40 \
2021-12-17 00:11:44.391+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:563 : \
1af4 1041 0000:01:00.0: found cap 0x01 at 0x7c 2021-12-17 00:11:44.391+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:631 : 1af4 1041 0000:01:00.0: detected \
PCIe FLR capability 2021-12-17 00:11:44.391+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:684 : 1af4 1041 0000:01:00.0: detected PM \
reset capability 2021-12-17 00:11:44.391+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1af4 1041 0000:01:00.0: opened \
/sys/bus/pci/devices/0000:01:00.0/config 2021-12-17 00:11:44.391+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1af4 1041 0000:01:00.0: found cap 0x10 at 0x40 \
2021-12-17 00:11:44.392+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:563 : \
1af4 1041 0000:01:00.0: found cap 0x01 at 0x7c 2021-12-17 00:11:44.392+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:631 : 1af4 1041 0000:01:00.0: detected \
PCIe FLR capability 2021-12-17 00:11:44.392+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:684 : 1af4 1041 0000:01:00.0: detected PM \
reset capability 2021-12-17 00:11:44.392+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1af4 1041 0000:01:00.0: opened \
/sys/bus/pci/devices/0000:01:00.0/config 2021-12-17 00:11:44.392+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1af4 1041 0000:01:00.0: found cap 0x10 at 0x40 \
2021-12-17 00:11:44.392+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:563 : \
1af4 1041 0000:01:00.0: found cap 0x01 at 0x7c 2021-12-17 00:11:44.392+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:631 : 1af4 1041 0000:01:00.0: detected \
PCIe FLR capability 2021-12-17 00:11:44.392+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:684 : 1af4 1041 0000:01:00.0: detected PM \
reset capability 2021-12-17 00:11:44.392+0000: 28123: debug : virPCIDeviceFree:1526 : \
1af4 1041 0000:01:00.0: freeing 2021-12-17 00:11:44.392+0000: 28123: debug : \
virObjectEventNew:621 : obj=0x557670115520 2021-12-17 00:11:44.392+0000: 28123: debug \
: virNodeDeviceEventLifecycleDispose:92 : obj=0x557670115520 2021-12-17 \
00:11:44.392+0000: 28123: debug : virNodeDeviceEventDispose:84 : obj=0x557670115520 \
2021-12-17 00:11:44.392+0000: 28123: debug : virObjectEventDispose:122 : \
obj=0x557670115520 2021-12-17 00:11:44.392+0000: 28123: debug : virObjectEventNew:621 \
: obj=0x5576701155a0 2021-12-17 00:11:44.392+0000: 28123: debug : \
virNodeDeviceEventLifecycleDispose:92 : obj=0x5576701155a0 2021-12-17 \
00:11:44.392+0000: 28123: debug : virNodeDeviceEventDispose:84 : obj=0x5576701155a0 \
2021-12-17 00:11:44.392+0000: 28123: debug : virObjectEventDispose:122 : \
obj=0x5576701155a0 2021-12-17 00:11:44.392+0000: 28123: debug : \
virPCIGetDeviceAddressFromSysfsLink:2280 : \
'/sys/devices/pci0000:00/0000:00:01.1/physfn' does not exist 2021-12-17 \
00:11:44.392+0000: 28123: debug : virPCIGetVirtualFunctionsFull:2403 : Found 0 \
virtual functions for /sys/devices/pci0000:00/0000:00:01.1 2021-12-17 \
00:11:44.392+0000: 28123: debug : virPCIDeviceNew:1496 : 1b36 000c 0000:00:01.1: \
initialized 2021-12-17 00:11:44.392+0000: 28123: info : virPCIDeviceHasVPD:2646 : \
Device VPD file does not exist /sys/bus/pci/devices/0000:00:01.1/vpd 2021-12-17 \
00:11:44.392+0000: 28123: debug : virPCIDeviceFree:1526 : 1b36 000c 0000:00:01.1: \
freeing 2021-12-17 00:11:44.392+0000: 28123: debug : virPCIDeviceNew:1496 : 1b36 000c \
0000:00:01.1: initialized 2021-12-17 00:11:44.392+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1b36 000c 0000:00:01.1: opened \
/sys/bus/pci/devices/0000:00:01.1/config 2021-12-17 00:11:44.392+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1b36 000c 0000:00:01.1: opened \
/sys/bus/pci/devices/0000:00:01.1/config 2021-12-17 00:11:44.392+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1b36 000c 0000:00:01.1: found cap 0x10 at 0x54 \
2021-12-17 00:11:44.392+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : \
1b36 000c 0000:00:01.1: failed to find cap 0x01 (Success) 2021-12-17 \
00:11:44.393+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : 1b36 000c \
0000:00:01.1: failed to find cap 0x13 (Success) 2021-12-17 00:11:44.393+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:667 : 1b36 000c 0000:00:01.1: no FLR \
capability found 2021-12-17 00:11:44.393+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:689 : 1b36 000c 0000:00:01.1: no PM reset \
capability found 2021-12-17 00:11:44.393+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1b36 000c 0000:00:01.1: opened \
/sys/bus/pci/devices/0000:00:01.1/config 2021-12-17 00:11:44.393+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1b36 000c 0000:00:01.1: found cap 0x10 at 0x54 \
2021-12-17 00:11:44.393+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : \
1b36 000c 0000:00:01.1: failed to find cap 0x01 (Success) 2021-12-17 \
00:11:44.393+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : 1b36 000c \
0000:00:01.1: failed to find cap 0x13 (Success) 2021-12-17 00:11:44.393+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:667 : 1b36 000c 0000:00:01.1: no FLR \
capability found 2021-12-17 00:11:44.393+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:689 : 1b36 000c 0000:00:01.1: no PM reset \
capability found 2021-12-17 00:11:44.393+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1b36 000c 0000:00:01.1: opened \
/sys/bus/pci/devices/0000:00:01.1/config 2021-12-17 00:11:44.393+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1b36 000c 0000:00:01.1: found cap 0x10 at 0x54 \
2021-12-17 00:11:44.393+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : \
1b36 000c 0000:00:01.1: failed to find cap 0x01 (Success) 2021-12-17 \
00:11:44.393+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : 1b36 000c \
0000:00:01.1: failed to find cap 0x13 (Success) 2021-12-17 00:11:44.393+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:667 : 1b36 000c 0000:00:01.1: no FLR \
capability found 2021-12-17 00:11:44.393+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:689 : 1b36 000c 0000:00:01.1: no PM reset \
capability found 2021-12-17 00:11:44.393+0000: 28123: debug : virPCIDeviceFree:1526 : \
1b36 000c 0000:00:01.1: freeing 2021-12-17 00:11:44.393+0000: 28123: debug : \
virObjectEventNew:621 : obj=0x557670115620 2021-12-17 00:11:44.393+0000: 28123: debug \
: virNodeDeviceEventLifecycleDispose:92 : obj=0x557670115620 2021-12-17 \
00:11:44.393+0000: 28123: debug : virNodeDeviceEventDispose:84 : obj=0x557670115620 \
2021-12-17 00:11:44.393+0000: 28123: debug : virObjectEventDispose:122 : \
obj=0x557670115620 2021-12-17 00:11:44.393+0000: 28123: debug : \
virPCIGetDeviceAddressFromSysfsLink:2280 : \
'/sys/devices/pci0000:00/0000:00:01.1/0000:02:00.0/physfn' does not exist 2021-12-17 \
00:11:44.393+0000: 28123: debug : virPCIGetVirtualFunctionsFull:2403 : Found 0 \
virtual functions for /sys/devices/pci0000:00/0000:00:01.1/0000:02:00.0 2021-12-17 \
00:11:44.393+0000: 28123: debug : virPCIDeviceNew:1496 : 1af4 1041 0000:02:00.0: \
initialized 2021-12-17 00:11:44.393+0000: 28123: info : virPCIDeviceHasVPD:2646 : \
Device VPD file does not exist /sys/bus/pci/devices/0000:02:00.0/vpd 2021-12-17 \
00:11:44.393+0000: 28123: debug : virPCIDeviceFree:1526 : 1af4 1041 0000:02:00.0: \
freeing 2021-12-17 00:11:44.393+0000: 28123: debug : virPCIDeviceNew:1496 : 1af4 1041 \
0000:02:00.0: initialized 2021-12-17 00:11:44.393+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1af4 1041 0000:02:00.0: opened \
/sys/bus/pci/devices/0000:02:00.0/config 2021-12-17 00:11:44.393+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1af4 1041 0000:02:00.0: opened \
/sys/bus/pci/devices/0000:02:00.0/config 2021-12-17 00:11:44.393+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1af4 1041 0000:02:00.0: found cap 0x10 at 0x40 \
2021-12-17 00:11:44.393+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:563 : \
1af4 1041 0000:02:00.0: found cap 0x01 at 0x7c 2021-12-17 00:11:44.393+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:631 : 1af4 1041 0000:02:00.0: detected \
PCIe FLR capability 2021-12-17 00:11:44.393+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:684 : 1af4 1041 0000:02:00.0: detected PM \
reset capability 2021-12-17 00:11:44.393+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1af4 1041 0000:02:00.0: opened \
/sys/bus/pci/devices/0000:02:00.0/config 2021-12-17 00:11:44.394+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1af4 1041 0000:02:00.0: found cap 0x10 at 0x40 \
2021-12-17 00:11:44.394+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:563 : \
1af4 1041 0000:02:00.0: found cap 0x01 at 0x7c 2021-12-17 00:11:44.394+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:631 : 1af4 1041 0000:02:00.0: detected \
PCIe FLR capability 2021-12-17 00:11:44.394+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:684 : 1af4 1041 0000:02:00.0: detected PM \
reset capability 2021-12-17 00:11:44.394+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1af4 1041 0000:02:00.0: opened \
/sys/bus/pci/devices/0000:02:00.0/config 2021-12-17 00:11:44.394+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1af4 1041 0000:02:00.0: found cap 0x10 at 0x40 \
2021-12-17 00:11:44.394+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:563 : \
1af4 1041 0000:02:00.0: found cap 0x01 at 0x7c 2021-12-17 00:11:44.394+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:631 : 1af4 1041 0000:02:00.0: detected \
PCIe FLR capability 2021-12-17 00:11:44.394+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:684 : 1af4 1041 0000:02:00.0: detected PM \
reset capability 2021-12-17 00:11:44.394+0000: 28123: debug : virPCIDeviceFree:1526 : \
1af4 1041 0000:02:00.0: freeing 2021-12-17 00:11:44.394+0000: 28123: debug : \
virObjectEventNew:621 : obj=0x5576701156a0 2021-12-17 00:11:44.394+0000: 28123: debug \
: virNodeDeviceEventLifecycleDispose:92 : obj=0x5576701156a0 2021-12-17 \
00:11:44.394+0000: 28123: debug : virNodeDeviceEventDispose:84 : obj=0x5576701156a0 \
2021-12-17 00:11:44.394+0000: 28123: debug : virObjectEventDispose:122 : \
obj=0x5576701156a0 2021-12-17 00:11:44.394+0000: 28123: debug : virObjectEventNew:621 \
: obj=0x557670115720 2021-12-17 00:11:44.394+0000: 28123: debug : \
virNodeDeviceEventLifecycleDispose:92 : obj=0x557670115720 2021-12-17 \
00:11:44.394+0000: 28123: debug : virNodeDeviceEventDispose:84 : obj=0x557670115720 \
2021-12-17 00:11:44.394+0000: 28123: debug : virObjectEventDispose:122 : \
obj=0x557670115720 2021-12-17 00:11:44.395+0000: 28123: debug : \
virPCIGetDeviceAddressFromSysfsLink:2280 : \
'/sys/devices/pci0000:00/0000:00:01.2/physfn' does not exist 2021-12-17 \
00:11:44.395+0000: 28123: debug : virPCIGetVirtualFunctionsFull:2403 : Found 0 \
2021-12-17 00:11:44.395+0000: 28123: info : virPCIDeviceHasVPD:2646 : Device VPD file \
does not exist /sys/bus/pci/devices/0000:00:01.2/vpd 2021-12-17 00:11:44.395+0000: \
28123: debug : virPCIDeviceFree:1526 : 1b36 000c 0000:00:01.2: freeing 2021-12-17 \
00:11:44.395+0000: 28123: debug : virPCIDeviceNew:1496 : 1b36 000c 0000:00:01.2: \
initialized 2021-12-17 00:11:44.395+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1b36 000c 0000:00:01.2: opened \
/sys/bus/pci/devices/0000:00:01.2/config 2021-12-17 00:11:44.395+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1b36 000c 0000:00:01.2: opened \
/sys/bus/pci/devices/0000:00:01.2/config 2021-12-17 00:11:44.395+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1b36 000c 0000:00:01.2: found cap 0x10 at 0x54 \
2021-12-17 00:11:44.395+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : \
1b36 000c 0000:00:01.2: failed to find cap 0x01 (Success) 2021-12-17 \
00:11:44.395+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : 1b36 000c \
0000:00:01.2: failed to find cap 0x13 (Success) 2021-12-17 00:11:44.395+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:667 : 1b36 000c 0000:00:01.2: no FLR \
capability found 2021-12-17 00:11:44.395+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:689 : 1b36 000c 0000:00:01.2: no PM reset \
capability found 2021-12-17 00:11:44.395+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1b36 000c 0000:00:01.2: opened \
/sys/bus/pci/devices/0000:00:01.2/config 2021-12-17 00:11:44.395+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1b36 000c 0000:00:01.2: found cap 0x10 at 0x54 \
2021-12-17 00:11:44.395+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : \
1b36 000c 0000:00:01.2: failed to find cap 0x01 (Success) 2021-12-17 \
00:11:44.395+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : 1b36 000c \
0000:00:01.2: failed to find cap 0x13 (Success) 2021-12-17 00:11:44.395+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:667 : 1b36 000c 0000:00:01.2: no FLR \
capability found 2021-12-17 00:11:44.395+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:689 : 1b36 000c 0000:00:01.2: no PM reset \
capability found 2021-12-17 00:11:44.395+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1b36 000c 0000:00:01.2: opened \
/sys/bus/pci/devices/0000:00:01.2/config 2021-12-17 00:11:44.395+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1b36 000c 0000:00:01.2: found cap 0x10 at 0x54 \
2021-12-17 00:11:44.395+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : \
1b36 000c 0000:00:01.2: failed to find cap 0x01 (Success) 2021-12-17 \
00:11:44.395+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : 1b36 000c \
0000:00:01.2: failed to find cap 0x13 (Success) 2021-12-17 00:11:44.395+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:667 : 1b36 000c 0000:00:01.2: no FLR \
capability found 2021-12-17 00:11:44.395+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:689 : 1b36 000c 0000:00:01.2: no PM reset \
capability found 2021-12-17 00:11:44.395+0000: 28123: debug : virPCIDeviceFree:1526 : \
1b36 000c 0000:00:01.2: freeing 2021-12-17 00:11:44.395+0000: 28123: debug : \
virObjectEventNew:621 : obj=0x557670124010 2021-12-17 00:11:44.395+0000: 28123: debug \
: virNodeDeviceEventLifecycleDispose:92 : obj=0x557670124010 2021-12-17 \
00:11:44.395+0000: 28123: debug : virNodeDeviceEventDispose:84 : obj=0x557670124010 \
2021-12-17 00:11:44.395+0000: 28123: debug : virObjectEventDispose:122 : \
obj=0x557670124010 2021-12-17 00:11:44.396+0000: 28123: debug : \
virPCIGetDeviceAddressFromSysfsLink:2280 : \
'/sys/devices/pci0000:00/0000:00:01.2/0000:03:00.0/physfn' does not exist 2021-12-17 \
00:11:44.396+0000: 28123: debug : virPCIGetVirtualFunctionsFull:2403 : Found 0 \
virtual functions for /sys/devices/pci0000:00/0000:00:01.2/0000:03:00.0 2021-12-17 \
00:11:44.396+0000: 28123: debug : virPCIDeviceNew:1496 : 1af4 1041 0000:03:00.0: \
initialized 2021-12-17 00:11:44.396+0000: 28123: info : virPCIDeviceHasVPD:2646 : \
Device VPD file does not exist /sys/bus/pci/devices/0000:03:00.0/vpd 2021-12-17 \
00:11:44.396+0000: 28123: debug : virPCIDeviceFree:1526 : 1af4 1041 0000:03:00.0: \
freeing 2021-12-17 00:11:44.396+0000: 28123: debug : virPCIDeviceNew:1496 : 1af4 1041 \
0000:03:00.0: initialized 2021-12-17 00:11:44.396+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1af4 1041 0000:03:00.0: opened \
/sys/bus/pci/devices/0000:03:00.0/config 2021-12-17 00:11:44.396+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1af4 1041 0000:03:00.0: opened \
/sys/bus/pci/devices/0000:03:00.0/config 2021-12-17 00:11:44.396+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1af4 1041 0000:03:00.0: found cap 0x10 at 0x40 \
2021-12-17 00:11:44.396+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:563 : \
1af4 1041 0000:03:00.0: found cap 0x01 at 0x7c 2021-12-17 00:11:44.396+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:631 : 1af4 1041 0000:03:00.0: detected \
PCIe FLR capability 2021-12-17 00:11:44.396+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:684 : 1af4 1041 0000:03:00.0: detected PM \
reset capability 2021-12-17 00:11:44.396+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1af4 1041 0000:03:00.0: opened \
/sys/bus/pci/devices/0000:03:00.0/config 2021-12-17 00:11:44.396+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1af4 1041 0000:03:00.0: found cap 0x10 at 0x40 \
2021-12-17 00:11:44.396+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:563 : \
1af4 1041 0000:03:00.0: found cap 0x01 at 0x7c 2021-12-17 00:11:44.396+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:631 : 1af4 1041 0000:03:00.0: detected \
PCIe FLR capability 2021-12-17 00:11:44.396+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:684 : 1af4 1041 0000:03:00.0: detected PM \
reset capability 2021-12-17 00:11:44.396+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1af4 1041 0000:03:00.0: opened \
/sys/bus/pci/devices/0000:03:00.0/config 2021-12-17 00:11:44.396+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1af4 1041 0000:03:00.0: found cap 0x10 at 0x40 \
2021-12-17 00:11:44.397+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:563 : \
1af4 1041 0000:03:00.0: found cap 0x01 at 0x7c 2021-12-17 00:11:44.397+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:631 : 1af4 1041 0000:03:00.0: detected \
PCIe FLR capability 2021-12-17 00:11:44.397+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:684 : 1af4 1041 0000:03:00.0: detected PM \
reset capability 2021-12-17 00:11:44.397+0000: 28123: debug : virPCIDeviceFree:1526 : \
1af4 1041 0000:03:00.0: freeing 2021-12-17 00:11:44.397+0000: 28123: debug : \
virObjectEventNew:621 : obj=0x557670124090 2021-12-17 00:11:44.397+0000: 28123: debug \
: virNodeDeviceEventLifecycleDispose:92 : obj=0x557670124090 2021-12-17 \
00:11:44.397+0000: 28123: debug : virNodeDeviceEventDispose:84 : obj=0x557670124090 \
2021-12-17 00:11:44.397+0000: 28123: debug : virObjectEventDispose:122 : \
obj=0x557670124090 2021-12-17 00:11:44.397+0000: 28123: debug : virObjectEventNew:621 \
: obj=0x557670124110 2021-12-17 00:11:44.397+0000: 28123: debug : \
virNodeDeviceEventLifecycleDispose:92 : obj=0x557670124110 2021-12-17 \
00:11:44.397+0000: 28123: debug : virNodeDeviceEventDispose:84 : obj=0x557670124110 \
2021-12-17 00:11:44.397+0000: 28123: debug : virObjectEventDispose:122 : \
obj=0x557670124110 2021-12-17 00:11:44.397+0000: 28123: debug : \
virPCIGetDeviceAddressFromSysfsLink:2280 : \
'/sys/devices/pci0000:00/0000:00:01.3/physfn' does not exist 2021-12-17 \
00:11:44.397+0000: 28123: debug : virPCIGetVirtualFunctionsFull:2403 : Found 0 \
virtual functions for /sys/devices/pci0000:00/0000:00:01.3 2021-12-17 \
00:11:44.397+0000: 28123: debug : virPCIDeviceNew:1496 : 1b36 000c 0000:00:01.3: \
initialized 2021-12-17 00:11:44.397+0000: 28123: info : virPCIDeviceHasVPD:2646 : \
Device VPD file does not exist /sys/bus/pci/devices/0000:00:01.3/vpd 2021-12-17 \
00:11:44.397+0000: 28123: debug : virPCIDeviceFree:1526 : 1b36 000c 0000:00:01.3: \
freeing 2021-12-17 00:11:44.397+0000: 28123: debug : virPCIDeviceNew:1496 : 1b36 000c \
0000:00:01.3: initialized 2021-12-17 00:11:44.397+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1b36 000c 0000:00:01.3: opened \
/sys/bus/pci/devices/0000:00:01.3/config 2021-12-17 00:11:44.397+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1b36 000c 0000:00:01.3: opened \
/sys/bus/pci/devices/0000:00:01.3/config 2021-12-17 00:11:44.397+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1b36 000c 0000:00:01.3: found cap 0x10 at 0x54 \
2021-12-17 00:11:44.397+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : \
1b36 000c 0000:00:01.3: failed to find cap 0x01 (Success) 2021-12-17 \
00:11:44.398+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : 1b36 000c \
0000:00:01.3: failed to find cap 0x13 (Success) 2021-12-17 00:11:44.398+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:667 : 1b36 000c 0000:00:01.3: no FLR \
capability found 2021-12-17 00:11:44.398+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:689 : 1b36 000c 0000:00:01.3: no PM reset \
capability found 2021-12-17 00:11:44.398+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1b36 000c 0000:00:01.3: opened \
/sys/bus/pci/devices/0000:00:01.3/config 2021-12-17 00:11:44.398+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1b36 000c 0000:00:01.3: found cap 0x10 at 0x54 \
2021-12-17 00:11:44.398+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : \
1b36 000c 0000:00:01.3: failed to find cap 0x01 (Success) 2021-12-17 \
00:11:44.398+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : 1b36 000c \
0000:00:01.3: failed to find cap 0x13 (Success) 2021-12-17 00:11:44.398+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:667 : 1b36 000c 0000:00:01.3: no FLR \
capability found 2021-12-17 00:11:44.398+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:689 : 1b36 000c 0000:00:01.3: no PM reset \
capability found 2021-12-17 00:11:44.398+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1b36 000c 0000:00:01.3: opened \
/sys/bus/pci/devices/0000:00:01.3/config 2021-12-17 00:11:44.398+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1b36 000c 0000:00:01.3: found cap 0x10 at 0x54 \
2021-12-17 00:11:44.398+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : \
1b36 000c 0000:00:01.3: failed to find cap 0x01 (Success) 2021-12-17 \
00:11:44.398+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : 1b36 000c \
0000:00:01.3: failed to find cap 0x13 (Success) 2021-12-17 00:11:44.398+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:667 : 1b36 000c 0000:00:01.3: no FLR \
capability found 2021-12-17 00:11:44.398+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:689 : 1b36 000c 0000:00:01.3: no PM reset \
capability found 2021-12-17 00:11:44.398+0000: 28123: debug : virPCIDeviceFree:1526 : \
1b36 000c 0000:00:01.3: freeing 2021-12-17 00:11:44.398+0000: 28123: debug : \
virObjectEventNew:621 : obj=0x557670124110 2021-12-17 00:11:44.398+0000: 28123: debug \
: virNodeDeviceEventLifecycleDispose:92 : obj=0x557670124110 2021-12-17 \
00:11:44.398+0000: 28123: debug : virNodeDeviceEventDispose:84 : obj=0x557670124110 \
2021-12-17 00:11:44.398+0000: 28123: debug : virObjectEventDispose:122 : \
obj=0x557670124110 2021-12-17 00:11:44.398+0000: 28123: debug : \
virPCIGetDeviceAddressFromSysfsLink:2280 : \
'/sys/devices/pci0000:00/0000:00:01.3/0000:04:00.0/physfn' does not exist 2021-12-17 \
00:11:44.398+0000: 28123: debug : virPCIGetVirtualFunctionsFull:2403 : Found 0 \
virtual functions for /sys/devices/pci0000:00/0000:00:01.3/0000:04:00.0 2021-12-17 \
00:11:44.398+0000: 28123: debug : virPCIDeviceNew:1496 : 1af4 1041 0000:04:00.0: \
initialized 2021-12-17 00:11:44.398+0000: 28123: info : virPCIDeviceHasVPD:2646 : \
Device VPD file does not exist /sys/bus/pci/devices/0000:04:00.0/vpd 2021-12-17 \
00:11:44.398+0000: 28123: debug : virPCIDeviceFree:1526 : 1af4 1041 0000:04:00.0: \
freeing 2021-12-17 00:11:44.398+0000: 28123: debug : virPCIDeviceNew:1496 : 1af4 1041 \
0000:04:00.0: initialized 2021-12-17 00:11:44.398+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1af4 1041 0000:04:00.0: opened \
/sys/bus/pci/devices/0000:04:00.0/config 2021-12-17 00:11:44.398+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1af4 1041 0000:04:00.0: opened \
/sys/bus/pci/devices/0000:04:00.0/config 2021-12-17 00:11:44.399+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1af4 1041 0000:04:00.0: found cap 0x10 at 0x40 \
2021-12-17 00:11:44.399+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:563 : \
1af4 1041 0000:04:00.0: found cap 0x01 at 0x7c 2021-12-17 00:11:44.399+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:631 : 1af4 1041 0000:04:00.0: detected \
PCIe FLR capability 2021-12-17 00:11:44.399+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:684 : 1af4 1041 0000:04:00.0: detected PM \
reset capability 2021-12-17 00:11:44.399+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1af4 1041 0000:04:00.0: opened \
/sys/bus/pci/devices/0000:04:00.0/config 2021-12-17 00:11:44.399+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1af4 1041 0000:04:00.0: found cap 0x10 at 0x40 \
2021-12-17 00:11:44.399+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:563 : \
1af4 1041 0000:04:00.0: found cap 0x01 at 0x7c 2021-12-17 00:11:44.399+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:631 : 1af4 1041 0000:04:00.0: detected \
PCIe FLR capability 2021-12-17 00:11:44.399+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:684 : 1af4 1041 0000:04:00.0: detected PM \
reset capability 2021-12-17 00:11:44.399+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1af4 1041 0000:04:00.0: opened \
/sys/bus/pci/devices/0000:04:00.0/config 2021-12-17 00:11:44.399+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1af4 1041 0000:04:00.0: found cap 0x10 at 0x40 \
2021-12-17 00:11:44.399+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:563 : \
1af4 1041 0000:04:00.0: found cap 0x01 at 0x7c 2021-12-17 00:11:44.399+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:631 : 1af4 1041 0000:04:00.0: detected \
PCIe FLR capability 2021-12-17 00:11:44.399+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:684 : 1af4 1041 0000:04:00.0: detected PM \
reset capability 2021-12-17 00:11:44.399+0000: 28123: debug : virPCIDeviceFree:1526 : \
1af4 1041 0000:04:00.0: freeing 2021-12-17 00:11:44.399+0000: 28123: debug : \
virObjectEventNew:621 : obj=0x557670124090 2021-12-17 00:11:44.399+0000: 28123: debug \
: virNodeDeviceEventLifecycleDispose:92 : obj=0x557670124090 2021-12-17 \
00:11:44.399+0000: 28123: debug : virNodeDeviceEventDispose:84 : obj=0x557670124090 \
2021-12-17 00:11:44.399+0000: 28123: debug : virObjectEventDispose:122 : \
obj=0x557670124090 2021-12-17 00:11:44.400+0000: 28123: debug : virObjectEventNew:621 \
: obj=0x557670124010 2021-12-17 00:11:44.400+0000: 28123: debug : \
virNodeDeviceEventLifecycleDispose:92 : obj=0x557670124010 2021-12-17 \
00:11:44.400+0000: 28123: debug : virNodeDeviceEventDispose:84 : obj=0x557670124010 \
2021-12-17 00:11:44.400+0000: 28123: debug : virObjectEventDispose:122 : \
obj=0x557670124010 2021-12-17 00:11:44.400+0000: 28123: debug : \
virPCIGetDeviceAddressFromSysfsLink:2280 : \
'/sys/devices/pci0000:00/0000:00:01.4/physfn' does not exist 2021-12-17 \
00:11:44.400+0000: 28123: debug : virPCIGetVirtualFunctionsFull:2403 : Found 0 \
virtual functions for /sys/devices/pci0000:00/0000:00:01.4 2021-12-17 \
00:11:44.400+0000: 28123: debug : virPCIDeviceNew:1496 : 1b36 000c 0000:00:01.4: \
2021-12-17 00:11:44.400+0000: 28123: debug : virPCIDeviceFree:1526 : 1b36 000c \
0000:00:01.4: freeing 2021-12-17 00:11:44.400+0000: 28123: debug : \
virPCIDeviceNew:1496 : 1b36 000c 0000:00:01.4: initialized 2021-12-17 \
00:11:44.400+0000: 28123: debug : virPCIDeviceConfigOpenInternal:300 : 1b36 000c \
0000:00:01.4: opened /sys/bus/pci/devices/0000:00:01.4/config 2021-12-17 \
00:11:44.400+0000: 28123: debug : virPCIDeviceConfigOpenInternal:300 : 1b36 000c \
0000:00:01.4: opened /sys/bus/pci/devices/0000:00:01.4/config 2021-12-17 \
00:11:44.400+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:563 : 1b36 000c \
0000:00:01.4: found cap 0x10 at 0x54 2021-12-17 00:11:44.400+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:575 : 1b36 000c 0000:00:01.4: failed to find cap \
0x01 (Success) 2021-12-17 00:11:44.400+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:575 : 1b36 000c 0000:00:01.4: failed to find cap \
0x13 (Success) 2021-12-17 00:11:44.400+0000: 28123: debug : \
virPCIDeviceDetectFunctionLevelReset:667 : 1b36 000c 0000:00:01.4: no FLR capability \
found 2021-12-17 00:11:44.400+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:689 : 1b36 000c 0000:00:01.4: no PM reset \
capability found 2021-12-17 00:11:44.400+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1b36 000c 0000:00:01.4: opened \
/sys/bus/pci/devices/0000:00:01.4/config 2021-12-17 00:11:44.400+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1b36 000c 0000:00:01.4: found cap 0x10 at 0x54 \
2021-12-17 00:11:44.400+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : \
1b36 000c 0000:00:01.4: failed to find cap 0x01 (Success) 2021-12-17 \
00:11:44.400+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : 1b36 000c \
0000:00:01.4: failed to find cap 0x13 (Success) 2021-12-17 00:11:44.400+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:667 : 1b36 000c 0000:00:01.4: no FLR \
capability found 2021-12-17 00:11:44.400+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:689 : 1b36 000c 0000:00:01.4: no PM reset \
capability found 2021-12-17 00:11:44.400+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1b36 000c 0000:00:01.4: opened \
/sys/bus/pci/devices/0000:00:01.4/config 2021-12-17 00:11:44.400+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1b36 000c 0000:00:01.4: found cap 0x10 at 0x54 \
2021-12-17 00:11:44.401+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : \
1b36 000c 0000:00:01.4: failed to find cap 0x01 (Success) 2021-12-17 \
00:11:44.401+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : 1b36 000c \
0000:00:01.4: failed to find cap 0x13 (Success) 2021-12-17 00:11:44.401+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:667 : 1b36 000c 0000:00:01.4: no FLR \
capability found 2021-12-17 00:11:44.401+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:689 : 1b36 000c 0000:00:01.4: no PM reset \
capability found 2021-12-17 00:11:44.401+0000: 28123: debug : virPCIDeviceFree:1526 : \
1b36 000c 0000:00:01.4: freeing 2021-12-17 00:11:44.401+0000: 28123: debug : \
virObjectEventNew:621 : obj=0x557670115720 2021-12-17 00:11:44.401+0000: 28123: debug \
: virNodeDeviceEventLifecycleDispose:92 : obj=0x557670115720 2021-12-17 \
00:11:44.401+0000: 28123: debug : virNodeDeviceEventDispose:84 : obj=0x557670115720 \
2021-12-17 00:11:44.401+0000: 28123: debug : virObjectEventDispose:122 : \
obj=0x557670115720 2021-12-17 00:11:44.401+0000: 28123: debug : \
virPCIGetDeviceAddressFromSysfsLink:2280 : \
'/sys/devices/pci0000:00/0000:00:01.4/0000:05:00.0/physfn' does not exist 2021-12-17 \
00:11:44.401+0000: 28123: debug : virPCIGetVirtualFunctionsFull:2403 : Found 0 \
virtual functions for /sys/devices/pci0000:00/0000:00:01.4/0000:05:00.0 2021-12-17 \
00:11:44.401+0000: 28123: debug : virPCIDeviceNew:1496 : 1af4 1043 0000:05:00.0: \
initialized 2021-12-17 00:11:44.401+0000: 28123: info : virPCIDeviceHasVPD:2646 : \
Device VPD file does not exist /sys/bus/pci/devices/0000:05:00.0/vpd 2021-12-17 \
00:11:44.401+0000: 28123: debug : virPCIDeviceFree:1526 : 1af4 1043 0000:05:00.0: \
freeing 2021-12-17 00:11:44.401+0000: 28123: debug : virPCIDeviceNew:1496 : 1af4 1043 \
0000:05:00.0: initialized 2021-12-17 00:11:44.401+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1af4 1043 0000:05:00.0: opened \
/sys/bus/pci/devices/0000:05:00.0/config 2021-12-17 00:11:44.401+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1af4 1043 0000:05:00.0: opened \
/sys/bus/pci/devices/0000:05:00.0/config 2021-12-17 00:11:44.401+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1af4 1043 0000:05:00.0: found cap 0x10 at 0x40 \
2021-12-17 00:11:44.401+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:563 : \
1af4 1043 0000:05:00.0: found cap 0x01 at 0x7c 2021-12-17 00:11:44.401+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:631 : 1af4 1043 0000:05:00.0: detected \
PCIe FLR capability 2021-12-17 00:11:44.401+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:684 : 1af4 1043 0000:05:00.0: detected PM \
reset capability 2021-12-17 00:11:44.401+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1af4 1043 0000:05:00.0: opened \
/sys/bus/pci/devices/0000:05:00.0/config 2021-12-17 00:11:44.402+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1af4 1043 0000:05:00.0: found cap 0x10 at 0x40 \
2021-12-17 00:11:44.402+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:563 : \
1af4 1043 0000:05:00.0: found cap 0x01 at 0x7c 2021-12-17 00:11:44.402+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:631 : 1af4 1043 0000:05:00.0: detected \
PCIe FLR capability 2021-12-17 00:11:44.402+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:684 : 1af4 1043 0000:05:00.0: detected PM \
reset capability 2021-12-17 00:11:44.402+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1af4 1043 0000:05:00.0: opened \
/sys/bus/pci/devices/0000:05:00.0/config 2021-12-17 00:11:44.402+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1af4 1043 0000:05:00.0: found cap 0x10 at 0x40 \
2021-12-17 00:11:44.402+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:563 : \
1af4 1043 0000:05:00.0: found cap 0x01 at 0x7c 2021-12-17 00:11:44.402+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:631 : 1af4 1043 0000:05:00.0: detected \
PCIe FLR capability 2021-12-17 00:11:44.402+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:684 : 1af4 1043 0000:05:00.0: detected PM \
reset capability 2021-12-17 00:11:44.402+0000: 28123: debug : virPCIDeviceFree:1526 : \
1af4 1043 0000:05:00.0: freeing 2021-12-17 00:11:44.402+0000: 28123: debug : \
virObjectEventNew:621 : obj=0x5576701156a0 2021-12-17 00:11:44.402+0000: 28123: debug \
: virNodeDeviceEventLifecycleDispose:92 : obj=0x5576701156a0 2021-12-17 \
00:11:44.402+0000: 28123: debug : virNodeDeviceEventDispose:84 : obj=0x5576701156a0 \
2021-12-17 00:11:44.402+0000: 28123: debug : virObjectEventDispose:122 : \
obj=0x5576701156a0 2021-12-17 00:11:44.402+0000: 28123: debug : \
virPCIGetDeviceAddressFromSysfsLink:2280 : \
'/sys/devices/pci0000:00/0000:00:01.5/physfn' does not exist 2021-12-17 \
00:11:44.402+0000: 28123: debug : virPCIGetVirtualFunctionsFull:2403 : Found 0 \
virtual functions for /sys/devices/pci0000:00/0000:00:01.5 2021-12-17 \
00:11:44.402+0000: 28123: debug : virPCIDeviceNew:1496 : 1b36 000c 0000:00:01.5: \
initialized 2021-12-17 00:11:44.402+0000: 28123: info : virPCIDeviceHasVPD:2646 : \
Device VPD file does not exist /sys/bus/pci/devices/0000:00:01.5/vpd 2021-12-17 \
00:11:44.402+0000: 28123: debug : virPCIDeviceFree:1526 : 1b36 000c 0000:00:01.5: \
freeing 2021-12-17 00:11:44.402+0000: 28123: debug : virPCIDeviceNew:1496 : 1b36 000c \
0000:00:01.5: initialized 2021-12-17 00:11:44.402+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1b36 000c 0000:00:01.5: opened \
/sys/bus/pci/devices/0000:00:01.5/config 2021-12-17 00:11:44.402+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1b36 000c 0000:00:01.5: opened \
/sys/bus/pci/devices/0000:00:01.5/config 2021-12-17 00:11:44.403+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1b36 000c 0000:00:01.5: found cap 0x10 at 0x54 \
2021-12-17 00:11:44.403+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : \
1b36 000c 0000:00:01.5: failed to find cap 0x01 (Success) 2021-12-17 \
00:11:44.403+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : 1b36 000c \
0000:00:01.5: failed to find cap 0x13 (Success) 2021-12-17 00:11:44.403+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:667 : 1b36 000c 0000:00:01.5: no FLR \
capability found 2021-12-17 00:11:44.403+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:689 : 1b36 000c 0000:00:01.5: no PM reset \
capability found 2021-12-17 00:11:44.403+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1b36 000c 0000:00:01.5: opened \
/sys/bus/pci/devices/0000:00:01.5/config 2021-12-17 00:11:44.403+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1b36 000c 0000:00:01.5: found cap 0x10 at 0x54 \
2021-12-17 00:11:44.403+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : \
1b36 000c 0000:00:01.5: failed to find cap 0x01 (Success) 2021-12-17 \
00:11:44.403+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : 1b36 000c \
0000:00:01.5: failed to find cap 0x13 (Success) 2021-12-17 00:11:44.403+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:667 : 1b36 000c 0000:00:01.5: no FLR \
capability found 2021-12-17 00:11:44.403+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:689 : 1b36 000c 0000:00:01.5: no PM reset \
capability found 2021-12-17 00:11:44.403+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1b36 000c 0000:00:01.5: opened \
/sys/bus/pci/devices/0000:00:01.5/config 2021-12-17 00:11:44.403+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1b36 000c 0000:00:01.5: found cap 0x10 at 0x54 \
2021-12-17 00:11:44.403+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : \
1b36 000c 0000:00:01.5: failed to find cap 0x01 (Success) 2021-12-17 \
00:11:44.403+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : 1b36 000c \
0000:00:01.5: failed to find cap 0x13 (Success) 2021-12-17 00:11:44.403+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:667 : 1b36 000c 0000:00:01.5: no FLR \
capability found 2021-12-17 00:11:44.403+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:689 : 1b36 000c 0000:00:01.5: no PM reset \
capability found 2021-12-17 00:11:44.403+0000: 28123: debug : virPCIDeviceFree:1526 : \
1b36 000c 0000:00:01.5: freeing 2021-12-17 00:11:44.403+0000: 28123: debug : \
virObjectEventNew:621 : obj=0x557670115620 2021-12-17 00:11:44.403+0000: 28123: debug \
: virNodeDeviceEventLifecycleDispose:92 : obj=0x557670115620 2021-12-17 \
00:11:44.403+0000: 28123: debug : virNodeDeviceEventDispose:84 : obj=0x557670115620 \
2021-12-17 00:11:44.403+0000: 28123: debug : virObjectEventDispose:122 : \
obj=0x557670115620 2021-12-17 00:11:44.403+0000: 28123: debug : \
virPCIGetDeviceAddressFromSysfsLink:2280 : \
'/sys/devices/pci0000:00/0000:00:01.5/0000:06:00.0/physfn' does not exist 2021-12-17 \
00:11:44.403+0000: 28123: debug : virPCIGetVirtualFunctionsFull:2403 : Found 0 \
virtual functions for /sys/devices/pci0000:00/0000:00:01.5/0000:06:00.0 2021-12-17 \
00:11:44.403+0000: 28123: debug : virPCIDeviceNew:1496 : 1af4 1042 0000:06:00.0: \
initialized 2021-12-17 00:11:44.403+0000: 28123: info : virPCIDeviceHasVPD:2646 : \
Device VPD file does not exist /sys/bus/pci/devices/0000:06:00.0/vpd 2021-12-17 \
00:11:44.403+0000: 28123: debug : virPCIDeviceFree:1526 : 1af4 1042 0000:06:00.0: \
freeing 2021-12-17 00:11:44.403+0000: 28123: debug : virPCIDeviceNew:1496 : 1af4 1042 \
0000:06:00.0: initialized 2021-12-17 00:11:44.403+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1af4 1042 0000:06:00.0: opened \
/sys/bus/pci/devices/0000:06:00.0/config 2021-12-17 00:11:44.404+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1af4 1042 0000:06:00.0: opened \
/sys/bus/pci/devices/0000:06:00.0/config 2021-12-17 00:11:44.404+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1af4 1042 0000:06:00.0: found cap 0x10 at 0x40 \
2021-12-17 00:11:44.404+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:563 : \
1af4 1042 0000:06:00.0: found cap 0x01 at 0x7c 2021-12-17 00:11:44.404+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:631 : 1af4 1042 0000:06:00.0: detected \
PCIe FLR capability 2021-12-17 00:11:44.404+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:684 : 1af4 1042 0000:06:00.0: detected PM \
reset capability 2021-12-17 00:11:44.404+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1af4 1042 0000:06:00.0: opened \
/sys/bus/pci/devices/0000:06:00.0/config 2021-12-17 00:11:44.404+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1af4 1042 0000:06:00.0: found cap 0x10 at 0x40 \
2021-12-17 00:11:44.404+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:563 : \
1af4 1042 0000:06:00.0: found cap 0x01 at 0x7c 2021-12-17 00:11:44.404+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:631 : 1af4 1042 0000:06:00.0: detected \
PCIe FLR capability 2021-12-17 00:11:44.404+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:684 : 1af4 1042 0000:06:00.0: detected PM \
reset capability 2021-12-17 00:11:44.404+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1af4 1042 0000:06:00.0: opened \
/sys/bus/pci/devices/0000:06:00.0/config 2021-12-17 00:11:44.404+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1af4 1042 0000:06:00.0: found cap 0x10 at 0x40 \
2021-12-17 00:11:44.404+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:563 : \
1af4 1042 0000:06:00.0: found cap 0x01 at 0x7c 2021-12-17 00:11:44.404+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:631 : 1af4 1042 0000:06:00.0: detected \
PCIe FLR capability 2021-12-17 00:11:44.404+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:684 : 1af4 1042 0000:06:00.0: detected PM \
reset capability 2021-12-17 00:11:44.404+0000: 28123: debug : virPCIDeviceFree:1526 : \
1af4 1042 0000:06:00.0: freeing 2021-12-17 00:11:44.405+0000: 28123: debug : \
virObjectEventNew:621 : obj=0x5576701155a0 2021-12-17 00:11:44.405+0000: 28123: debug \
: virNodeDeviceEventLifecycleDispose:92 : obj=0x5576701155a0 2021-12-17 \
00:11:44.405+0000: 28123: debug : virNodeDeviceEventDispose:84 : obj=0x5576701155a0 \
2021-12-17 00:11:44.405+0000: 28123: debug : virObjectEventDispose:122 : \
obj=0x5576701155a0 2021-12-17 00:11:44.405+0000: 28123: debug : virObjectEventNew:621 \
: obj=0x557670115520 2021-12-17 00:11:44.405+0000: 28123: debug : \
virNodeDeviceEventLifecycleDispose:92 : obj=0x557670115520 2021-12-17 \
00:11:44.405+0000: 28123: debug : virNodeDeviceEventDispose:84 : obj=0x557670115520 \
2021-12-17 00:11:44.405+0000: 28123: debug : virObjectEventDispose:122 : \
obj=0x557670115520 2021-12-17 00:11:44.406+0000: 28123: debug : \
virPCIGetDeviceAddressFromSysfsLink:2280 : \
'/sys/devices/pci0000:00/0000:00:01.6/physfn' does not exist 2021-12-17 \
00:11:44.406+0000: 28123: debug : virPCIGetVirtualFunctionsFull:2403 : Found 0 \
virtual functions for /sys/devices/pci0000:00/0000:00:01.6 2021-12-17 \
00:11:44.406+0000: 28123: debug : virPCIDeviceNew:1496 : 1b36 000c 0000:00:01.6: \
initialized 2021-12-17 00:11:44.406+0000: 28123: info : virPCIDeviceHasVPD:2646 : \
Device VPD file does not exist /sys/bus/pci/devices/0000:00:01.6/vpd 2021-12-17 \
00:11:44.406+0000: 28123: debug : virPCIDeviceFree:1526 : 1b36 000c 0000:00:01.6: \
freeing 2021-12-17 00:11:44.406+0000: 28123: debug : virPCIDeviceNew:1496 : 1b36 000c \
0000:00:01.6: initialized 2021-12-17 00:11:44.406+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1b36 000c 0000:00:01.6: opened \
2021-12-17 00:11:44.406+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:563 : \
1b36 000c 0000:00:01.6: found cap 0x10 at 0x54 2021-12-17 00:11:44.406+0000: 28123: \
debug : virPCIDeviceFindCapabilityOffset:575 : 1b36 000c 0000:00:01.6: failed to find \
cap 0x01 (Success) 2021-12-17 00:11:44.406+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:575 : 1b36 000c 0000:00:01.6: failed to find cap \
0x13 (Success) 2021-12-17 00:11:44.406+0000: 28123: debug : \
virPCIDeviceDetectFunctionLevelReset:667 : 1b36 000c 0000:00:01.6: no FLR capability \
found 2021-12-17 00:11:44.406+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:689 : 1b36 000c 0000:00:01.6: no PM reset \
capability found 2021-12-17 00:11:44.406+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1b36 000c 0000:00:01.6: opened \
/sys/bus/pci/devices/0000:00:01.6/config 2021-12-17 00:11:44.406+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1b36 000c 0000:00:01.6: found cap 0x10 at 0x54 \
2021-12-17 00:11:44.406+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : \
1b36 000c 0000:00:01.6: failed to find cap 0x01 (Success) 2021-12-17 \
00:11:44.406+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : 1b36 000c \
0000:00:01.6: failed to find cap 0x13 (Success) 2021-12-17 00:11:44.406+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:667 : 1b36 000c 0000:00:01.6: no FLR \
capability found 2021-12-17 00:11:44.406+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:689 : 1b36 000c 0000:00:01.6: no PM reset \
capability found 2021-12-17 00:11:44.406+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1b36 000c 0000:00:01.6: opened \
/sys/bus/pci/devices/0000:00:01.6/config 2021-12-17 00:11:44.406+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1b36 000c 0000:00:01.6: found cap 0x10 at 0x54 \
2021-12-17 00:11:44.406+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : \
1b36 000c 0000:00:01.6: failed to find cap 0x01 (Success) 2021-12-17 \
00:11:44.406+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : 1b36 000c \
0000:00:01.6: failed to find cap 0x13 (Success) 2021-12-17 00:11:44.406+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:667 : 1b36 000c 0000:00:01.6: no FLR \
capability found 2021-12-17 00:11:44.406+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:689 : 1b36 000c 0000:00:01.6: no PM reset \
capability found 2021-12-17 00:11:44.406+0000: 28123: debug : virPCIDeviceFree:1526 : \
1b36 000c 0000:00:01.6: freeing 2021-12-17 00:11:44.406+0000: 28123: debug : \
virObjectEventNew:621 : obj=0x5576701154a0 2021-12-17 00:11:44.406+0000: 28123: debug \
: virNodeDeviceEventLifecycleDispose:92 : obj=0x5576701154a0 2021-12-17 \
00:11:44.406+0000: 28123: debug : virNodeDeviceEventDispose:84 : obj=0x5576701154a0 \
2021-12-17 00:11:44.406+0000: 28123: debug : virObjectEventDispose:122 : \
obj=0x5576701154a0 2021-12-17 00:11:44.407+0000: 28123: debug : \
virPCIGetDeviceAddressFromSysfsLink:2280 : \
'/sys/devices/pci0000:00/0000:00:01.6/0000:07:00.0/physfn' does not exist 2021-12-17 \
00:11:44.407+0000: 28123: debug : virPCIGetVirtualFunctionsFull:2403 : Found 0 \
virtual functions for /sys/devices/pci0000:00/0000:00:01.6/0000:07:00.0 2021-12-17 \
00:11:44.407+0000: 28123: debug : virPCIDeviceNew:1496 : 1af4 1044 0000:07:00.0: \
initialized 2021-12-17 00:11:44.407+0000: 28123: info : virPCIDeviceHasVPD:2646 : \
Device VPD file does not exist /sys/bus/pci/devices/0000:07:00.0/vpd 2021-12-17 \
00:11:44.407+0000: 28123: debug : virPCIDeviceFree:1526 : 1af4 1044 0000:07:00.0: \
freeing 2021-12-17 00:11:44.407+0000: 28123: debug : virPCIDeviceNew:1496 : 1af4 1044 \
0000:07:00.0: initialized 2021-12-17 00:11:44.407+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1af4 1044 0000:07:00.0: opened \
/sys/bus/pci/devices/0000:07:00.0/config 2021-12-17 00:11:44.407+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1af4 1044 0000:07:00.0: opened \
/sys/bus/pci/devices/0000:07:00.0/config 2021-12-17 00:11:44.407+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1af4 1044 0000:07:00.0: found cap 0x10 at 0x40 \
2021-12-17 00:11:44.407+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:563 : \
1af4 1044 0000:07:00.0: found cap 0x01 at 0x7c 2021-12-17 00:11:44.407+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:631 : 1af4 1044 0000:07:00.0: detected \
PCIe FLR capability 2021-12-17 00:11:44.407+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:684 : 1af4 1044 0000:07:00.0: detected PM \
reset capability 2021-12-17 00:11:44.407+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1af4 1044 0000:07:00.0: opened \
/sys/bus/pci/devices/0000:07:00.0/config 2021-12-17 00:11:44.407+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1af4 1044 0000:07:00.0: found cap 0x10 at 0x40 \
2021-12-17 00:11:44.407+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:563 : \
1af4 1044 0000:07:00.0: found cap 0x01 at 0x7c 2021-12-17 00:11:44.407+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:631 : 1af4 1044 0000:07:00.0: detected \
PCIe FLR capability 2021-12-17 00:11:44.407+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:684 : 1af4 1044 0000:07:00.0: detected PM \
reset capability 2021-12-17 00:11:44.407+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1af4 1044 0000:07:00.0: opened \
/sys/bus/pci/devices/0000:07:00.0/config 2021-12-17 00:11:44.407+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1af4 1044 0000:07:00.0: found cap 0x10 at 0x40 \
2021-12-17 00:11:44.407+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:563 : \
1af4 1044 0000:07:00.0: found cap 0x01 at 0x7c 2021-12-17 00:11:44.407+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:631 : 1af4 1044 0000:07:00.0: detected \
PCIe FLR capability 2021-12-17 00:11:44.407+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:684 : 1af4 1044 0000:07:00.0: detected PM \
reset capability 2021-12-17 00:11:44.407+0000: 28123: debug : virPCIDeviceFree:1526 : \
1af4 1044 0000:07:00.0: freeing 2021-12-17 00:11:44.407+0000: 28123: debug : \
virObjectEventNew:621 : obj=0x557670115420 2021-12-17 00:11:44.407+0000: 28123: debug \
: virNodeDeviceEventLifecycleDispose:92 : obj=0x557670115420 2021-12-17 \
00:11:44.407+0000: 28123: debug : virNodeDeviceEventDispose:84 : obj=0x557670115420 \
2021-12-17 00:11:44.407+0000: 28123: debug : virObjectEventDispose:122 : \
obj=0x557670115420 2021-12-17 00:11:44.407+0000: 28123: debug : \
virPCIGetDeviceAddressFromSysfsLink:2280 : \
'/sys/devices/pci0000:00/0000:00:01.7/physfn' does not exist 2021-12-17 \
00:11:44.407+0000: 28123: debug : virPCIGetVirtualFunctionsFull:2403 : Found 0 \
virtual functions for /sys/devices/pci0000:00/0000:00:01.7 2021-12-17 \
00:11:44.407+0000: 28123: debug : virPCIDeviceNew:1496 : 1b36 000c 0000:00:01.7: \
initialized 2021-12-17 00:11:44.407+0000: 28123: info : virPCIDeviceHasVPD:2646 : \
Device VPD file does not exist /sys/bus/pci/devices/0000:00:01.7/vpd 2021-12-17 \
00:11:44.407+0000: 28123: debug : virPCIDeviceFree:1526 : 1b36 000c 0000:00:01.7: \
freeing 2021-12-17 00:11:44.407+0000: 28123: debug : virPCIDeviceNew:1496 : 1b36 000c \
0000:00:01.7: initialized 2021-12-17 00:11:44.408+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1b36 000c 0000:00:01.7: opened \
/sys/bus/pci/devices/0000:00:01.7/config 2021-12-17 00:11:44.408+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1b36 000c 0000:00:01.7: opened \
/sys/bus/pci/devices/0000:00:01.7/config 2021-12-17 00:11:44.408+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1b36 000c 0000:00:01.7: found cap 0x10 at 0x54 \
2021-12-17 00:11:44.408+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : \
1b36 000c 0000:00:01.7: failed to find cap 0x01 (Success) 2021-12-17 \
00:11:44.408+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : 1b36 000c \
0000:00:01.7: failed to find cap 0x13 (Success) 2021-12-17 00:11:44.408+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:667 : 1b36 000c 0000:00:01.7: no FLR \
capability found 2021-12-17 00:11:44.408+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:689 : 1b36 000c 0000:00:01.7: no PM reset \
capability found 2021-12-17 00:11:44.408+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1b36 000c 0000:00:01.7: opened \
/sys/bus/pci/devices/0000:00:01.7/config 2021-12-17 00:11:44.408+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1b36 000c 0000:00:01.7: found cap 0x10 at 0x54 \
2021-12-17 00:11:44.408+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : \
1b36 000c 0000:00:01.7: failed to find cap 0x01 (Success) 2021-12-17 \
00:11:44.408+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : 1b36 000c \
0000:00:01.7: failed to find cap 0x13 (Success) 2021-12-17 00:11:44.408+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:667 : 1b36 000c 0000:00:01.7: no FLR \
capability found 2021-12-17 00:11:44.408+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:689 : 1b36 000c 0000:00:01.7: no PM reset \
capability found 2021-12-17 00:11:44.408+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 1b36 000c 0000:00:01.7: opened \
/sys/bus/pci/devices/0000:00:01.7/config 2021-12-17 00:11:44.408+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:563 : 1b36 000c 0000:00:01.7: found cap 0x10 at 0x54 \
2021-12-17 00:11:44.408+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : \
1b36 000c 0000:00:01.7: failed to find cap 0x01 (Success) 2021-12-17 \
00:11:44.408+0000: 28123: debug : virPCIDeviceFindCapabilityOffset:575 : 1b36 000c \
0000:00:01.7: failed to find cap 0x13 (Success) 2021-12-17 00:11:44.408+0000: 28123: \
debug : virPCIDeviceDetectFunctionLevelReset:667 : 1b36 000c 0000:00:01.7: no FLR \
capability found 2021-12-17 00:11:44.408+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:689 : 1b36 000c 0000:00:01.7: no PM reset \
capability found 2021-12-17 00:11:44.408+0000: 28123: debug : virPCIDeviceFree:1526 : \
1b36 000c 0000:00:01.7: freeing 2021-12-17 00:11:44.408+0000: 28123: debug : \
virObjectEventNew:621 : obj=0x557670115420 2021-12-17 00:11:44.408+0000: 28123: debug \
: virNodeDeviceEventLifecycleDispose:92 : obj=0x557670115420 2021-12-17 \
00:11:44.408+0000: 28123: debug : virNodeDeviceEventDispose:84 : obj=0x557670115420 \
2021-12-17 00:11:44.408+0000: 28123: debug : virObjectEventDispose:122 : \
obj=0x557670115420 2021-12-17 00:11:44.408+0000: 28123: debug : \
virPCIGetDeviceAddressFromSysfsLink:2280 : \
'/sys/devices/pci0000:00/0000:00:1f.0/physfn' does not exist 2021-12-17 \
00:11:44.408+0000: 28123: debug : virPCIGetVirtualFunctionsFull:2403 : Found 0 \
virtual functions for /sys/devices/pci0000:00/0000:00:1f.0 2021-12-17 \
00:11:44.408+0000: 28123: debug : virPCIDeviceNew:1496 : 8086 2918 0000:00:1f.0: \
initialized 2021-12-17 00:11:44.408+0000: 28123: info : virPCIDeviceHasVPD:2646 : \
Device VPD file does not exist /sys/bus/pci/devices/0000:00:1f.0/vpd 2021-12-17 \
00:11:44.408+0000: 28123: debug : virPCIDeviceFree:1526 : 8086 2918 0000:00:1f.0: \
freeing 2021-12-17 00:11:44.408+0000: 28123: debug : virPCIDeviceNew:1496 : 8086 2918 \
0000:00:1f.0: initialized 2021-12-17 00:11:44.408+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 8086 2918 0000:00:1f.0: opened \
/sys/bus/pci/devices/0000:00:1f.0/config 2021-12-17 00:11:44.408+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 8086 2918 0000:00:1f.0: opened \
/sys/bus/pci/devices/0000:00:1f.0/config 2021-12-17 00:11:44.408+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:575 : 8086 2918 0000:00:1f.0: failed to find cap \
0x10 (Success) 2021-12-17 00:11:44.408+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:575 : 8086 2918 0000:00:1f.0: failed to find cap \
0x01 (Success) 2021-12-17 00:11:44.408+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:575 : 8086 2918 0000:00:1f.0: failed to find cap \
0x13 (Success) 2021-12-17 00:11:44.408+0000: 28123: debug : \
virPCIDeviceDetectFunctionLevelReset:667 : 8086 2918 0000:00:1f.0: no FLR capability \
found 2021-12-17 00:11:44.408+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:689 : 8086 2918 0000:00:1f.0: no PM reset \
capability found 2021-12-17 00:11:44.408+0000: 28123: debug : virPCIDeviceFree:1526 : \
8086 2918 0000:00:1f.0: freeing 2021-12-17 00:11:44.408+0000: 28123: debug : \
virObjectEventNew:621 : obj=0x5576701154a0 2021-12-17 00:11:44.408+0000: 28123: debug \
: virNodeDeviceEventLifecycleDispose:92 : obj=0x5576701154a0 2021-12-17 \
00:11:44.408+0000: 28123: debug : virNodeDeviceEventDispose:84 : obj=0x5576701154a0 \
2021-12-17 00:11:44.408+0000: 28123: debug : virObjectEventDispose:122 : \
obj=0x5576701154a0 2021-12-17 00:11:44.409+0000: 28123: debug : \
virPCIGetDeviceAddressFromSysfsLink:2280 : \
'/sys/devices/pci0000:00/0000:00:1f.2/physfn' does not exist 2021-12-17 \
00:11:44.409+0000: 28123: debug : virPCIGetVirtualFunctionsFull:2403 : Found 0 \
virtual functions for /sys/devices/pci0000:00/0000:00:1f.2 2021-12-17 \
00:11:44.409+0000: 28123: debug : virPCIDeviceNew:1496 : 8086 2922 0000:00:1f.2: \
initialized 2021-12-17 00:11:44.409+0000: 28123: info : virPCIDeviceHasVPD:2646 : \
Device VPD file does not exist /sys/bus/pci/devices/0000:00:1f.2/vpd 2021-12-17 \
00:11:44.409+0000: 28123: debug : virPCIDeviceFree:1526 : 8086 2922 0000:00:1f.2: \
freeing 2021-12-17 00:11:44.409+0000: 28123: debug : virPCIDeviceNew:1496 : 8086 2922 \
0000:00:1f.2: initialized 2021-12-17 00:11:44.409+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 8086 2922 0000:00:1f.2: opened \
/sys/bus/pci/devices/0000:00:1f.2/config 2021-12-17 00:11:44.409+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 8086 2922 0000:00:1f.2: opened \
/sys/bus/pci/devices/0000:00:1f.2/config 2021-12-17 00:11:44.409+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:575 : 8086 2922 0000:00:1f.2: failed to find cap \
0x10 (Success) 2021-12-17 00:11:44.409+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:575 : 8086 2922 0000:00:1f.2: failed to find cap \
0x01 (Success) 2021-12-17 00:11:44.409+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:575 : 8086 2922 0000:00:1f.2: failed to find cap \
0x13 (Success) 2021-12-17 00:11:44.409+0000: 28123: debug : \
virPCIDeviceDetectFunctionLevelReset:667 : 8086 2922 0000:00:1f.2: no FLR capability \
found 2021-12-17 00:11:44.409+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:689 : 8086 2922 0000:00:1f.2: no PM reset \
capability found 2021-12-17 00:11:44.409+0000: 28123: debug : virPCIDeviceFree:1526 : \
8086 2922 0000:00:1f.2: freeing 2021-12-17 00:11:44.409+0000: 28123: debug : \
virObjectEventNew:621 : obj=0x557670115520 2021-12-17 00:11:44.409+0000: 28123: debug \
: virNodeDeviceEventLifecycleDispose:92 : obj=0x557670115520 2021-12-17 \
00:11:44.409+0000: 28123: debug : virNodeDeviceEventDispose:84 : obj=0x557670115520 \
2021-12-17 00:11:44.409+0000: 28123: debug : virObjectEventDispose:122 : \
obj=0x557670115520 2021-12-17 00:11:44.409+0000: 28123: debug : \
virNodeDeviceGetSCSIHostCaps:2789 : Checking if host0 is an FC HBA 2021-12-17 \
00:11:44.409+0000: 28123: debug : virObjectEventNew:621 : obj=0x5576701155a0 \
2021-12-17 00:11:44.409+0000: 28123: debug : virNodeDeviceEventLifecycleDispose:92 : \
obj=0x5576701155a0 2021-12-17 00:11:44.409+0000: 28123: debug : \
virNodeDeviceEventDispose:84 : obj=0x5576701155a0 2021-12-17 00:11:44.409+0000: \
28123: debug : virObjectEventDispose:122 : obj=0x5576701155a0 2021-12-17 \
00:11:44.409+0000: 28123: debug : virNodeDeviceGetSCSIHostCaps:2789 : Checking if \
host1 is an FC HBA 2021-12-17 00:11:44.409+0000: 28123: debug : virObjectEventNew:621 \
2021-12-17 00:11:44.409+0000: 28123: debug : virNodeDeviceEventDispose:84 : \
obj=0x557670115620 2021-12-17 00:11:44.409+0000: 28123: debug : \
virObjectEventDispose:122 : obj=0x557670115620 2021-12-17 00:11:44.410+0000: 28123: \
debug : virNodeDeviceGetSCSIHostCaps:2789 : Checking if host2 is an FC HBA 2021-12-17 \
00:11:44.410+0000: 28123: debug : virObjectEventNew:621 : obj=0x5576701156a0 \
2021-12-17 00:11:44.410+0000: 28123: debug : virNodeDeviceEventLifecycleDispose:92 : \
obj=0x5576701156a0 2021-12-17 00:11:44.410+0000: 28123: debug : \
virNodeDeviceEventDispose:84 : obj=0x5576701156a0 2021-12-17 00:11:44.410+0000: \
28123: debug : virObjectEventDispose:122 : obj=0x5576701156a0 2021-12-17 \
00:11:44.410+0000: 28123: debug : virNodeDeviceGetSCSIHostCaps:2789 : Checking if \
host3 is an FC HBA 2021-12-17 00:11:44.410+0000: 28123: debug : virObjectEventNew:621 \
: obj=0x557670115720 2021-12-17 00:11:44.410+0000: 28123: debug : \
virNodeDeviceEventLifecycleDispose:92 : obj=0x557670115720 2021-12-17 \
00:11:44.410+0000: 28123: debug : virNodeDeviceEventDispose:84 : obj=0x557670115720 \
2021-12-17 00:11:44.410+0000: 28123: debug : virObjectEventDispose:122 : \
obj=0x557670115720 2021-12-17 00:11:44.410+0000: 28123: debug : \
virNodeDeviceGetSCSIHostCaps:2789 : Checking if host4 is an FC HBA 2021-12-17 \
00:11:44.410+0000: 28123: debug : virObjectEventNew:621 : obj=0x557670124010 \
2021-12-17 00:11:44.410+0000: 28123: debug : virNodeDeviceEventLifecycleDispose:92 : \
obj=0x557670124010 2021-12-17 00:11:44.410+0000: 28123: debug : \
virNodeDeviceEventDispose:84 : obj=0x557670124010 2021-12-17 00:11:44.410+0000: \
28123: debug : virObjectEventDispose:122 : obj=0x557670124010 2021-12-17 \
00:11:44.410+0000: 28123: debug : virNodeDeviceGetSCSIHostCaps:2789 : Checking if \
host5 is an FC HBA 2021-12-17 00:11:44.410+0000: 28123: debug : virObjectEventNew:621 \
: obj=0x557670124090 2021-12-17 00:11:44.410+0000: 28123: debug : \
virNodeDeviceEventLifecycleDispose:92 : obj=0x557670124090 2021-12-17 \
00:11:44.410+0000: 28123: debug : virNodeDeviceEventDispose:84 : obj=0x557670124090 \
2021-12-17 00:11:44.410+0000: 28123: debug : virObjectEventDispose:122 : \
obj=0x557670124090 2021-12-17 00:11:44.411+0000: 28123: debug : \
virPCIGetDeviceAddressFromSysfsLink:2280 : \
'/sys/devices/pci0000:00/0000:00:1f.3/physfn' does not exist 2021-12-17 \
00:11:44.411+0000: 28123: debug : virPCIGetVirtualFunctionsFull:2403 : Found 0 \
virtual functions for /sys/devices/pci0000:00/0000:00:1f.3 2021-12-17 \
00:11:44.411+0000: 28123: debug : virPCIDeviceNew:1496 : 8086 2930 0000:00:1f.3: \
initialized 2021-12-17 00:11:44.411+0000: 28123: info : virPCIDeviceHasVPD:2646 : \
Device VPD file does not exist /sys/bus/pci/devices/0000:00:1f.3/vpd 2021-12-17 \
00:11:44.411+0000: 28123: debug : virPCIDeviceFree:1526 : 8086 2930 0000:00:1f.3: \
freeing 2021-12-17 00:11:44.411+0000: 28123: debug : virPCIDeviceNew:1496 : 8086 2930 \
0000:00:1f.3: initialized 2021-12-17 00:11:44.411+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 8086 2930 0000:00:1f.3: opened \
/sys/bus/pci/devices/0000:00:1f.3/config 2021-12-17 00:11:44.411+0000: 28123: debug : \
virPCIDeviceConfigOpenInternal:300 : 8086 2930 0000:00:1f.3: opened \
/sys/bus/pci/devices/0000:00:1f.3/config 2021-12-17 00:11:44.411+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:575 : 8086 2930 0000:00:1f.3: failed to find cap \
0x10 (Success) 2021-12-17 00:11:44.411+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:575 : 8086 2930 0000:00:1f.3: failed to find cap \
0x01 (Success) 2021-12-17 00:11:44.411+0000: 28123: debug : \
virPCIDeviceFindCapabilityOffset:575 : 8086 2930 0000:00:1f.3: failed to find cap \
0x13 (Success) 2021-12-17 00:11:44.411+0000: 28123: debug : \
virPCIDeviceDetectFunctionLevelReset:667 : 8086 2930 0000:00:1f.3: no FLR capability \
found 2021-12-17 00:11:44.411+0000: 28123: debug : \
virPCIDeviceDetectPowerManagementReset:689 : 8086 2930 0000:00:1f.3: no PM reset \
capability found 2021-12-17 00:11:44.411+0000: 28123: debug : virPCIDeviceFree:1526 : \
8086 2930 0000:00:1f.3: freeing 2021-12-17 00:11:44.411+0000: 28123: debug : \
virObjectEventNew:621 : obj=0x557670124110 2021-12-17 00:11:44.411+0000: 28123: debug \
: virNodeDeviceEventLifecycleDispose:92 : obj=0x557670124110 2021-12-17 \
00:11:44.411+0000: 28123: debug : virNodeDeviceEventDispose:84 : obj=0x557670124110 \
2021-12-17 00:11:44.411+0000: 28123: debug : virObjectEventDispose:122 : \
obj=0x557670124110 2021-12-17 00:11:44.414+0000: 28123: debug : virObjectEventNew:621 \
: obj=0x557670124110 2021-12-17 00:11:44.414+0000: 28123: debug : \
virNodeDeviceEventLifecycleDispose:92 : obj=0x557670124110 2021-12-17 \
00:11:44.414+0000: 28123: debug : virNodeDeviceEventDispose:84 : obj=0x557670124110 \
2021-12-17 00:11:44.414+0000: 28123: debug : virObjectEventDispose:122 : \
obj=0x557670124110 2021-12-17 00:11:44.415+0000: 28123: debug : \
virCommandRunAsync:2629 : About to run mdevctl list --dumpjson --defined 2021-12-17 \
00:11:44.416+0000: 28123: debug : virCommandRunAsync:2632 : Command result 0, with \
PID 28127 2021-12-17 00:11:44.506+0000: 28123: debug : virCommandRun:2478 : Result \
exit status 0, stdout: '[] ' stderr: ''
2021-12-17 00:11:44.506+0000: 28123: debug : virThreadJobClear:122 : Thread 28123 \
finished job nodedev-init with ret=0


["journalctl.log" (text/x-log)]

-- Logs begin at Fri 2021-12-17 01:02:01 CET, end at Fri 2021-12-17 01:12:17 CET. --
2021-12-17T01:02:01.225151+0100 localhost.localdomain kernel: Linux version \
4.18.0-348.2.1.el8_5.x86_64 (mockbuild@kbuilder.bsys.centos.org) (gcc version 8.5.0 \
20210514 (Red Hat 8.5.0-4) (GCC)) #1 SMP Tue Nov 16 14:42:35 UTC 2021 \
2021-12-17T01:02:01.225172+0100 localhost.localdomain kernel: Command line: \
BOOT_IMAGE=(hd0,msdos1)/vmlinuz-4.18.0-348.2.1.el8_5.x86_64 \
root=UUID=215f27b1-6a5c-4125-a7af-a21ed88e255a ro consoleblank=0 net.ifnames=0 \
console=hvc0 crashkernel=auto boot=UUID=4e0b2bcf-357f-43dd-b4fc-7f5a1891842c \
resume=UUID=6ce1924f-1ce5-4245-a388-212ff15a384c fips=1 console=ttyS0,115200 \
2021-12-17T01:02:01.225179+0100 localhost.localdomain kernel: x86/fpu: Supporting \
XSAVE feature 0x001: 'x87 floating point registers' 2021-12-17T01:02:01.225184+0100 \
localhost.localdomain kernel: x86/fpu: Supporting XSAVE feature 0x002: 'SSE \
registers' 2021-12-17T01:02:01.225189+0100 localhost.localdomain kernel: x86/fpu: \
Supporting XSAVE feature 0x004: 'AVX registers' 2021-12-17T01:02:01.225193+0100 \
localhost.localdomain kernel: x86/fpu: Supporting XSAVE feature 0x008: 'MPX bounds \
registers' 2021-12-17T01:02:01.225207+0100 localhost.localdomain kernel: x86/fpu: \
Supporting XSAVE feature 0x010: 'MPX CSR' 2021-12-17T01:02:01.225211+0100 \
localhost.localdomain kernel: x86/fpu: Supporting XSAVE feature 0x020: 'AVX-512 \
opmask' 2021-12-17T01:02:01.225216+0100 localhost.localdomain kernel: x86/fpu: \
Supporting XSAVE feature 0x040: 'AVX-512 Hi256' 2021-12-17T01:02:01.225220+0100 \
localhost.localdomain kernel: x86/fpu: Supporting XSAVE feature 0x080: 'AVX-512 \
ZMM_Hi256' 2021-12-17T01:02:01.225224+0100 localhost.localdomain kernel: x86/fpu: \
Supporting XSAVE feature 0x200: 'Protection Keys User registers' \
2021-12-17T01:02:01.225229+0100 localhost.localdomain kernel: x86/fpu: \
xstate_offset[2]:  576, xstate_sizes[2]:  256 2021-12-17T01:02:01.225234+0100 \
localhost.localdomain kernel: x86/fpu: xstate_offset[3]:  832, xstate_sizes[3]:   64 \
2021-12-17T01:02:01.225250+0100 localhost.localdomain kernel: x86/fpu: \
xstate_offset[4]:  896, xstate_sizes[4]:   64 2021-12-17T01:02:01.225257+0100 \
localhost.localdomain kernel: x86/fpu: xstate_offset[5]:  960, xstate_sizes[5]:   64 \
2021-12-17T01:02:01.225262+0100 localhost.localdomain kernel: x86/fpu: \
xstate_offset[6]: 1024, xstate_sizes[6]:  512 2021-12-17T01:02:01.225266+0100 \
localhost.localdomain kernel: x86/fpu: xstate_offset[7]: 1536, xstate_sizes[7]: 1024 \
2021-12-17T01:02:01.225270+0100 localhost.localdomain kernel: x86/fpu: \
xstate_offset[9]: 2560, xstate_sizes[9]:    8 2021-12-17T01:02:01.225275+0100 \
localhost.localdomain kernel: x86/fpu: Enabled xstate features 0x2ff, context size is \
2568 bytes, using 'compacted' format. 2021-12-17T01:02:01.225279+0100 \
localhost.localdomain kernel: BIOS-provided physical RAM map: \
2021-12-17T01:02:01.225284+0100 localhost.localdomain kernel: BIOS-e820: [mem \
0x0000000000000000-0x000000000009f7ff] usable 2021-12-17T01:02:01.225288+0100 \
localhost.localdomain kernel: BIOS-e820: [mem 0x000000000009f800-0x000000000009ffff] \
reserved 2021-12-17T01:02:01.225292+0100 localhost.localdomain kernel: BIOS-e820: \
[mem 0x00000000000f0000-0x00000000000fffff] reserved 2021-12-17T01:02:01.225298+0100 \
localhost.localdomain kernel: BIOS-e820: [mem 0x0000000000100000-0x000000006ffdcfff] \
usable 2021-12-17T01:02:01.225302+0100 localhost.localdomain kernel: BIOS-e820: [mem \
0x000000006ffdd000-0x000000006fffffff] reserved 2021-12-17T01:02:01.225307+0100 \
localhost.localdomain kernel: BIOS-e820: [mem 0x00000000b0000000-0x00000000bfffffff] \
reserved 2021-12-17T01:02:01.225311+0100 localhost.localdomain kernel: BIOS-e820: \
[mem 0x00000000fed1c000-0x00000000fed1ffff] reserved 2021-12-17T01:02:01.225316+0100 \
localhost.localdomain kernel: BIOS-e820: [mem 0x00000000feffc000-0x00000000feffffff] \
reserved 2021-12-17T01:02:01.225320+0100 localhost.localdomain kernel: BIOS-e820: \
[mem 0x00000000fffc0000-0x00000000ffffffff] reserved 2021-12-17T01:02:01.225324+0100 \
localhost.localdomain kernel: NX (Execute Disable) protection: active \
2021-12-17T01:02:01.225335+0100 localhost.localdomain kernel: SMBIOS 2.8 present. \
2021-12-17T01:02:01.225339+0100 localhost.localdomain kernel: DMI: Red Hat \
KVM/RHEL-AV, BIOS 1.13.0-2.module+el8.3.0+7353+9de0a3cc 04/01/2014 \
2021-12-17T01:02:01.225344+0100 localhost.localdomain kernel: Hypervisor detected: \
KVM 2021-12-17T01:02:01.225348+0100 localhost.localdomain kernel: kvm-clock: Using \
msrs 4b564d01 and 4b564d00 2021-12-17T01:02:01.225353+0100 localhost.localdomain \
kernel: kvm-clock: cpu 0, msr 3de01001, primary cpu clock \
2021-12-17T01:02:01.225359+0100 localhost.localdomain kernel: kvm-clock: using sched \
offset of 6483806991 cycles 2021-12-17T01:02:01.225364+0100 localhost.localdomain \
kernel: clocksource: kvm-clock: mask: 0xffffffffffffffff max_cycles: 0x1cd42e4dffb, \
max_idle_ns: 881590591483 ns 2021-12-17T01:02:01.225368+0100 localhost.localdomain \
kernel: tsc: Detected 2095.076 MHz processor 2021-12-17T01:02:01.225372+0100 \
localhost.localdomain kernel: e820: update [mem 0x00000000-0x00000fff] usable ==&gt; \
reserved 2021-12-17T01:02:01.225377+0100 localhost.localdomain kernel: e820: remove \
[mem 0x000a0000-0x000fffff] usable 2021-12-17T01:02:01.225385+0100 \
localhost.localdomain kernel: last_pfn = 0x6ffdd max_arch_pfn = 0x400000000 \
2021-12-17T01:02:01.225389+0100 localhost.localdomain kernel: MTRR default type: \
write-back 2021-12-17T01:02:01.225393+0100 localhost.localdomain kernel: MTRR fixed \
ranges enabled: 2021-12-17T01:02:01.225399+0100 localhost.localdomain kernel:   \
00000-9FFFF write-back 2021-12-17T01:02:01.225404+0100 localhost.localdomain kernel:  \
A0000-BFFFF uncachable 2021-12-17T01:02:01.225409+0100 localhost.localdomain kernel:  \
C0000-FFFFF write-protect 2021-12-17T01:02:01.225413+0100 localhost.localdomain \
kernel: MTRR variable ranges enabled: 2021-12-17T01:02:01.225418+0100 \
localhost.localdomain kernel:   0 base 0000C0000000 mask 3FFFC0000000 uncachable \
2021-12-17T01:02:01.225423+0100 localhost.localdomain kernel:   1 disabled \
2021-12-17T01:02:01.225427+0100 localhost.localdomain kernel:   2 disabled \
2021-12-17T01:02:01.225431+0100 localhost.localdomain kernel:   3 disabled \
2021-12-17T01:02:01.225435+0100 localhost.localdomain kernel:   4 disabled \
2021-12-17T01:02:01.225439+0100 localhost.localdomain kernel:   5 disabled \
2021-12-17T01:02:01.225444+0100 localhost.localdomain kernel:   6 disabled \
2021-12-17T01:02:01.225449+0100 localhost.localdomain kernel:   7 disabled \
2021-12-17T01:02:01.225453+0100 localhost.localdomain kernel: x86/PAT: Configuration \
[0-7]: WB  WC  UC- UC  WB  WP  UC- WT   2021-12-17T01:02:01.225460+0100 \
localhost.localdomain kernel: found SMP MP-table at [mem 0x000f5c00-0x000f5c0f] \
2021-12-17T01:02:01.225465+0100 localhost.localdomain kernel: Using GB pages for \
direct mapping 2021-12-17T01:02:01.225469+0100 localhost.localdomain kernel: BRK \
[0x3e001000, 0x3e001fff] PGTABLE 2021-12-17T01:02:01.225473+0100 \
localhost.localdomain kernel: BRK [0x3e002000, 0x3e002fff] PGTABLE \
2021-12-17T01:02:01.225478+0100 localhost.localdomain kernel: BRK [0x3e003000, \
0x3e003fff] PGTABLE 2021-12-17T01:02:01.225483+0100 localhost.localdomain kernel: BRK \
[0x3e004000, 0x3e004fff] PGTABLE 2021-12-17T01:02:01.225487+0100 \
localhost.localdomain kernel: BRK [0x3e005000, 0x3e005fff] PGTABLE \
2021-12-17T01:02:01.225491+0100 localhost.localdomain kernel: BRK [0x3e006000, \
0x3e006fff] PGTABLE 2021-12-17T01:02:01.225495+0100 localhost.localdomain kernel: \
RAMDISK: [mem 0x34813000-0x36401fff] 2021-12-17T01:02:01.225500+0100 \
localhost.localdomain kernel: ACPI: Early table checksum verification disabled \
2021-12-17T01:02:01.225506+0100 localhost.localdomain kernel: ACPI: RSDP \
0x00000000000F5BC0 000014 (v00 BOCHS ) 2021-12-17T01:02:01.225511+0100 \
localhost.localdomain kernel: ACPI: RSDT 0x000000006FFE1F4E 000034 (v01 BOCHS  \
BXPCRSDT 00000001 BXPC 00000001) 2021-12-17T01:02:01.225516+0100 \
localhost.localdomain kernel: ACPI: FACP 0x000000006FFE1CAE 0000F4 (v03 BOCHS  \
BXPCFACP 00000001 BXPC 00000001) 2021-12-17T01:02:01.225521+0100 \
localhost.localdomain kernel: ACPI: DSDT 0x000000006FFDFDC0 001EEE (v01 BOCHS  \
BXPCDSDT 00000001 BXPC 00000001) 2021-12-17T01:02:01.225525+0100 \
localhost.localdomain kernel: ACPI: FACS 0x000000006FFDFD80 000040 \
2021-12-17T01:02:01.225530+0100 localhost.localdomain kernel: ACPI: APIC \
0x000000006FFE1DA2 000080 (v01 BOCHS  BXPCAPIC 00000001 BXPC 00000001) \
2021-12-17T01:02:01.225534+0100 localhost.localdomain kernel: ACPI: SRAT \
0x000000006FFE1E22 0000F0 (v01 BOCHS  BXPCSRAT 00000001 BXPC 00000001) \
2021-12-17T01:02:01.225538+0100 localhost.localdomain kernel: ACPI: MCFG \
0x000000006FFE1F12 00003C (v01 BOCHS  BXPCMCFG 00000001 BXPC 00000001) \
2021-12-17T01:02:01.225543+0100 localhost.localdomain kernel: ACPI: Reserving FACP \
table memory at [mem 0x6ffe1cae-0x6ffe1da1] 2021-12-17T01:02:01.225548+0100 \
localhost.localdomain kernel: ACPI: Reserving DSDT table memory at [mem \
0x6ffdfdc0-0x6ffe1cad] 2021-12-17T01:02:01.225553+0100 localhost.localdomain kernel: \
ACPI: Reserving FACS table memory at [mem 0x6ffdfd80-0x6ffdfdbf] \
2021-12-17T01:02:01.225557+0100 localhost.localdomain kernel: ACPI: Reserving APIC \
table memory at [mem 0x6ffe1da2-0x6ffe1e21] 2021-12-17T01:02:01.225564+0100 \
localhost.localdomain kernel: ACPI: Reserving SRAT table memory at [mem \
0x6ffe1e22-0x6ffe1f11] 2021-12-17T01:02:01.225568+0100 localhost.localdomain kernel: \
ACPI: Reserving MCFG table memory at [mem 0x6ffe1f12-0x6ffe1f4d] \
2021-12-17T01:02:01.225572+0100 localhost.localdomain kernel: ACPI: Local APIC \
address 0xfee00000 2021-12-17T01:02:01.225577+0100 localhost.localdomain kernel: \
SRAT: PXM 0 -&gt; APIC 0x00 -&gt; Node 0 2021-12-17T01:02:01.225582+0100 \
localhost.localdomain kernel: SRAT: PXM 1 -&gt; APIC 0x01 -&gt; Node 1 \
2021-12-17T01:02:01.225586+0100 localhost.localdomain kernel: ACPI: SRAT: Node 0 PXM \
0 [mem 0x00000000-0x0009ffff] 2021-12-17T01:02:01.225591+0100 localhost.localdomain \
kernel: ACPI: SRAT: Node 0 PXM 0 [mem 0x00100000-0x37ffffff] \
2021-12-17T01:02:01.225595+0100 localhost.localdomain kernel: ACPI: SRAT: Node 1 PXM \
1 [mem 0x38000000-0x6fffffff] 2021-12-17T01:02:01.225600+0100 localhost.localdomain \
kernel: NUMA: Node 0 [mem 0x00000000-0x0009ffff] + [mem 0x00100000-0x37ffffff] -&gt; \
[mem 0x00000000-0x37ffffff] 2021-12-17T01:02:01.225604+0100 localhost.localdomain \
kernel: NODE_DATA(0) allocated [mem 0x37fd5000-0x37ffffff] \
2021-12-17T01:02:01.225608+0100 localhost.localdomain kernel: NODE_DATA(1) allocated \
[mem 0x6ffb2000-0x6ffdcfff] 2021-12-17T01:02:01.225613+0100 localhost.localdomain \
kernel: Using crashkernel=auto, the size chosen is a best effort estimation. \
2021-12-17T01:02:01.225620+0100 localhost.localdomain kernel: Reserving 160MB of \
memory at 1616MB for crashkernel (System RAM: 1791MB) 2021-12-17T01:02:01.225624+0100 \
localhost.localdomain kernel: Zone ranges: 2021-12-17T01:02:01.225629+0100 \
localhost.localdomain kernel:   DMA      [mem 0x0000000000001000-0x0000000000ffffff] \
2021-12-17T01:02:01.225633+0100 localhost.localdomain kernel:   DMA32    [mem \
0x0000000001000000-0x000000006ffdcfff] 2021-12-17T01:02:01.225637+0100 \
localhost.localdomain kernel:   Normal   empty 2021-12-17T01:02:01.225642+0100 \
localhost.localdomain kernel:   Device   empty 2021-12-17T01:02:01.225646+0100 \
localhost.localdomain kernel: Movable zone start for each node \
2021-12-17T01:02:01.225651+0100 localhost.localdomain kernel: Early memory node \
ranges 2021-12-17T01:02:01.225656+0100 localhost.localdomain kernel:   node   0: [mem \
0x0000000000001000-0x000000000009efff] 2021-12-17T01:02:01.225660+0100 \
localhost.localdomain kernel:   node   0: [mem 0x0000000000100000-0x0000000037ffffff] \
2021-12-17T01:02:01.225665+0100 localhost.localdomain kernel:   node   1: [mem \
0x0000000038000000-0x000000006ffdcfff] 2021-12-17T01:02:01.225670+0100 \
localhost.localdomain kernel: Zeroed struct page in unavailable ranges: 133 pages \
2021-12-17T01:02:01.225674+0100 localhost.localdomain kernel: Initmem setup node 0 \
[mem 0x0000000000001000-0x0000000037ffffff] 2021-12-17T01:02:01.225680+0100 \
localhost.localdomain kernel: On node 0 totalpages: 229278 \
2021-12-17T01:02:01.225685+0100 localhost.localdomain kernel:   DMA zone: 64 pages \
used for memmap 2021-12-17T01:02:01.225690+0100 localhost.localdomain kernel:   DMA \
zone: 158 pages reserved 2021-12-17T01:02:01.225694+0100 localhost.localdomain \
kernel:   DMA zone: 3998 pages, LIFO batch:0 2021-12-17T01:02:01.225699+0100 \
localhost.localdomain kernel:   DMA32 zone: 3520 pages used for memmap \
2021-12-17T01:02:01.225703+0100 localhost.localdomain kernel:   DMA32 zone: 225280 \
pages, LIFO batch:63 2021-12-17T01:02:01.225707+0100 localhost.localdomain kernel: \
Initmem setup node 1 [mem 0x0000000038000000-0x000000006ffdcfff] \
2021-12-17T01:02:01.225711+0100 localhost.localdomain kernel: On node 1 totalpages: \
229341 2021-12-17T01:02:01.225716+0100 localhost.localdomain kernel:   DMA32 zone: \
3584 pages used for memmap 2021-12-17T01:02:01.225720+0100 localhost.localdomain \
kernel:   DMA32 zone: 229341 pages, LIFO batch:63 2021-12-17T01:02:01.225725+0100 \
localhost.localdomain kernel: ACPI: PM-Timer IO Port: 0x608 \
2021-12-17T01:02:01.225730+0100 localhost.localdomain kernel: ACPI: Local APIC \
address 0xfee00000 2021-12-17T01:02:01.225734+0100 localhost.localdomain kernel: \
ACPI: LAPIC_NMI (acpi_id[0xff] dfl dfl lint[0x1]) 2021-12-17T01:02:01.225740+0100 \
localhost.localdomain kernel: IOAPIC[0]: apic_id 0, version 17, address 0xfec00000, \
GSI 0-23 2021-12-17T01:02:01.225745+0100 localhost.localdomain kernel: ACPI: \
INT_SRC_OVR (bus 0 bus_irq 0 global_irq 2 dfl dfl) 2021-12-17T01:02:01.225756+0100 \
localhost.localdomain kernel: ACPI: INT_SRC_OVR (bus 0 bus_irq 5 global_irq 5 high \
level) 2021-12-17T01:02:01.225763+0100 localhost.localdomain kernel: ACPI: \
INT_SRC_OVR (bus 0 bus_irq 9 global_irq 9 high level) 2021-12-17T01:02:01.225767+0100 \
localhost.localdomain kernel: ACPI: INT_SRC_OVR (bus 0 bus_irq 10 global_irq 10 high \
level) 2021-12-17T01:02:01.225772+0100 localhost.localdomain kernel: ACPI: \
INT_SRC_OVR (bus 0 bus_irq 11 global_irq 11 high level) \
2021-12-17T01:02:01.225777+0100 localhost.localdomain kernel: ACPI: IRQ0 used by \
override. 2021-12-17T01:02:01.225781+0100 localhost.localdomain kernel: ACPI: IRQ5 \
used by override. 2021-12-17T01:02:01.225786+0100 localhost.localdomain kernel: ACPI: \
IRQ9 used by override. 2021-12-17T01:02:01.225791+0100 localhost.localdomain kernel: \
ACPI: IRQ10 used by override. 2021-12-17T01:02:01.225796+0100 localhost.localdomain \
kernel: ACPI: IRQ11 used by override. 2021-12-17T01:02:01.225801+0100 \
localhost.localdomain kernel: Using ACPI (MADT) for SMP configuration information \
2021-12-17T01:02:01.225805+0100 localhost.localdomain kernel: smpboot: Allowing 2 \
CPUs, 0 hotplug CPUs 2021-12-17T01:02:01.225809+0100 localhost.localdomain kernel: \
kvm-guest: KVM setup pv remote TLB flush 2021-12-17T01:02:01.225814+0100 \
localhost.localdomain kernel: kvm-guest: setup PV sched yield \
2021-12-17T01:02:01.225819+0100 localhost.localdomain kernel: PM: Registered nosave \
memory: [mem 0x00000000-0x00000fff] 2021-12-17T01:02:01.225826+0100 \
localhost.localdomain kernel: PM: Registered nosave memory: [mem \
0x0009f000-0x0009ffff] 2021-12-17T01:02:01.225831+0100 localhost.localdomain kernel: \
PM: Registered nosave memory: [mem 0x000a0000-0x000effff] \
2021-12-17T01:02:01.225836+0100 localhost.localdomain kernel: PM: Registered nosave \
memory: [mem 0x000f0000-0x000fffff] 2021-12-17T01:02:01.225840+0100 \
localhost.localdomain kernel: [mem 0x70000000-0xafffffff] available for PCI devices \
2021-12-17T01:02:01.225845+0100 localhost.localdomain kernel: Booting paravirtualized \
kernel on KVM 2021-12-17T01:02:01.225850+0100 localhost.localdomain kernel: \
2021-12-17T01:02:01.225855+0100 localhost.localdomain kernel: setup_percpu: \
NR_CPUS:8192 nr_cpumask_bits:2 nr_cpu_ids:2 nr_node_ids:2 \
2021-12-17T01:02:01.225860+0100 localhost.localdomain kernel: percpu: Embedded 54 \
pages/cpu s184320 r8192 d28672 u2097152 2021-12-17T01:02:01.225864+0100 \
localhost.localdomain kernel: pcpu-alloc: s184320 r8192 d28672 u2097152 \
alloc=1*2097152 2021-12-17T01:02:01.225869+0100 localhost.localdomain kernel: \
pcpu-alloc: [0] 0 [1] 1  2021-12-17T01:02:01.225873+0100 localhost.localdomain \
kernel: kvm-guest: stealtime: cpu 0, msr 36e2c080 2021-12-17T01:02:01.225880+0100 \
localhost.localdomain kernel: kvm-guest: PV spinlocks enabled \
2021-12-17T01:02:01.225884+0100 localhost.localdomain kernel: PV qspinlock hash table \
entries: 256 (order: 0, 4096 bytes, linear) 2021-12-17T01:02:01.225889+0100 \
localhost.localdomain kernel: Built 2 zonelists, mobility grouping on.  Total pages: \
451293 2021-12-17T01:02:01.225894+0100 localhost.localdomain kernel: Policy zone: \
DMA32 2021-12-17T01:02:01.225900+0100 localhost.localdomain kernel: Kernel command \
line: BOOT_IMAGE=(hd0,msdos1)/vmlinuz-4.18.0-348.2.1.el8_5.x86_64 \
root=UUID=215f27b1-6a5c-4125-a7af-a21ed88e255a ro consoleblank=0 net.ifnames=0 \
console=hvc0 crashkernel=auto boot=UUID=4e0b2bcf-357f-43dd-b4fc-7f5a1891842c \
resume=UUID=6ce1924f-1ce5-4245-a388-212ff15a384c fips=1 console=ttyS0,115200 \
2021-12-17T01:02:01.225906+0100 localhost.localdomain kernel: Specific versions of \
hardware are certified with Red Hat Enterprise Linux 8. Please see the list of \
hardware certified with Red Hat Enterprise Linux 8 at https://catalog.redhat.com. \
2021-12-17T01:02:01.225911+0100 localhost.localdomain kernel: fips mode: enabled \
2021-12-17T01:02:01.225915+0100 localhost.localdomain kernel: Memory: \
347084K/1834476K available (12293K kernel code, 2261K rwdata, 7872K rodata, 2492K \
init, 13944K bss, 267712K reserved, 0K cma-reserved) 2021-12-17T01:02:01.225920+0100 \
localhost.localdomain kernel: SLUB: HWalign=64, Order=0-3, MinObjects=0, CPUs=2, \
Nodes=2 2021-12-17T01:02:01.225925+0100 localhost.localdomain kernel: ftrace: \
allocating 39491 entries in 155 pages 2021-12-17T01:02:01.225932+0100 \
localhost.localdomain kernel: ftrace: allocated 155 pages with 5 groups \
2021-12-17T01:02:01.225937+0100 localhost.localdomain kernel: rcu: Hierarchical RCU \
implementation. 2021-12-17T01:02:01.225944+0100 localhost.localdomain kernel: rcu: \
RCU restricting CPUs from NR_CPUS=8192 to nr_cpu_ids=2. \
2021-12-17T01:02:01.225949+0100 localhost.localdomain kernel: 	Rude variant of Tasks \
RCU enabled. 2021-12-17T01:02:01.225954+0100 localhost.localdomain kernel: 	Tracing \
variant of Tasks RCU enabled. 2021-12-17T01:02:01.225958+0100 localhost.localdomain \
kernel: rcu: RCU calculated value of scheduler-enlistment delay is 100 jiffies. \
2021-12-17T01:02:01.225963+0100 localhost.localdomain kernel: rcu: Adjusting geometry \
for rcu_fanout_leaf=16, nr_cpu_ids=2 2021-12-17T01:02:01.225968+0100 \
localhost.localdomain kernel: NR_IRQS: 524544, nr_irqs: 440, preallocated irqs: 16 \
2021-12-17T01:02:01.225973+0100 localhost.localdomain kernel: random: crng done \
(trusting CPU's manufacturer) 2021-12-17T01:02:01.225980+0100 localhost.localdomain \
kernel: Console: colour *CGA 80x25 2021-12-17T01:02:01.225984+0100 \
localhost.localdomain kernel: printk: console [ttyS0] enabled \
2021-12-17T01:02:01.225989+0100 localhost.localdomain kernel: mempolicy: Enabling \
automatic NUMA balancing. Configure with numa_balancing= or the kernel.numa_balancing \
sysctl 2021-12-17T01:02:01.225994+0100 localhost.localdomain kernel: ACPI: Core \
revision 20210105 2021-12-17T01:02:01.225998+0100 localhost.localdomain kernel: APIC: \
Switch to symmetric I/O mode setup 2021-12-17T01:02:01.226003+0100 \
localhost.localdomain kernel: x2apic enabled 2021-12-17T01:02:01.226008+0100 \
localhost.localdomain kernel: Switched APIC routing to physical x2apic. \
2021-12-17T01:02:01.226013+0100 localhost.localdomain kernel: kvm-guest: setup PV \
IPIs 2021-12-17T01:02:01.226018+0100 localhost.localdomain kernel: clocksource: \
tsc-early: mask: 0xffffffffffffffff max_cycles: 0x1e33052aadd, max_idle_ns: \
440795310221 ns 2021-12-17T01:02:01.226024+0100 localhost.localdomain kernel: \
Calibrating delay loop (skipped) preset value.. 4190.15 BogoMIPS (lpj=2095076) \
2021-12-17T01:02:01.226029+0100 localhost.localdomain kernel: pid_max: default: 32768 \
minimum: 301 2021-12-17T01:02:01.226033+0100 localhost.localdomain kernel: LSM: \
Security Framework initializing 2021-12-17T01:02:01.226038+0100 localhost.localdomain \
kernel: Yama: becoming mindful. 2021-12-17T01:02:01.226043+0100 localhost.localdomain \
kernel: SELinux:  Initializing. 2021-12-17T01:02:01.226048+0100 localhost.localdomain \
kernel: LSM support for eBPF active 2021-12-17T01:02:01.226053+0100 \
localhost.localdomain kernel: Dentry cache hash table entries: 262144 (order: 9, \
2097152 bytes, vmalloc) 2021-12-17T01:02:01.226058+0100 localhost.localdomain kernel: \
Inode-cache hash table entries: 131072 (order: 8, 1048576 bytes, vmalloc) \
2021-12-17T01:02:01.226062+0100 localhost.localdomain kernel: Mount-cache hash table \
entries: 4096 (order: 3, 32768 bytes, vmalloc) 2021-12-17T01:02:01.226067+0100 \
localhost.localdomain kernel: Mountpoint-cache hash table entries: 4096 (order: 3, \
32768 bytes, vmalloc) 2021-12-17T01:02:01.226071+0100 localhost.localdomain kernel: \
x86/cpu: User Mode Instruction Prevention (UMIP) activated \
2021-12-17T01:02:01.226076+0100 localhost.localdomain kernel: Last level iTLB \
entries: 4KB 0, 2MB 0, 4MB 0 2021-12-17T01:02:01.226083+0100 localhost.localdomain \
kernel: Last level dTLB entries: 4KB 0, 2MB 0, 4MB 0, 1GB 0 \
2021-12-17T01:02:01.226088+0100 localhost.localdomain kernel: FEATURE SPEC_CTRL \
Present 2021-12-17T01:02:01.226093+0100 localhost.localdomain kernel: FEATURE \
IBPB_SUPPORT Present 2021-12-17T01:02:01.226098+0100 localhost.localdomain kernel: \
Spectre V1 : Mitigation: usercopy/swapgs barriers and __user pointer sanitization \
2021-12-17T01:02:01.226102+0100 localhost.localdomain kernel: Spectre V2 : \
Mitigation: Enhanced IBRS 2021-12-17T01:02:01.226107+0100 localhost.localdomain \
kernel: Spectre V2 : Spectre v2 / SpectreRSB mitigation: Filling RSB on context \
switch 2021-12-17T01:02:01.226112+0100 localhost.localdomain kernel: Spectre V2 : \
mitigation: Enabling conditional Indirect Branch Prediction Barrier \
2021-12-17T01:02:01.226118+0100 localhost.localdomain kernel: Speculative Store \
Bypass: Mitigation: Speculative Store Bypass disabled via prctl and seccomp \
2021-12-17T01:02:01.226123+0100 localhost.localdomain kernel: TAA: Mitigation: TSX \
disabled 2021-12-17T01:02:01.226127+0100 localhost.localdomain kernel: Freeing SMP \
alternatives memory: 32K 2021-12-17T01:02:01.226132+0100 localhost.localdomain \
kernel: TSC deadline timer enabled 2021-12-17T01:02:01.226136+0100 \
localhost.localdomain kernel: smpboot: CPU0: Intel(R) Xeon(R) Gold 5218R CPU @ \
2.10GHz (family: 0x6, model: 0x55, stepping: 0x7) 2021-12-17T01:02:01.226143+0100 \
localhost.localdomain kernel: Performance Events: Skylake events, 32-deep LBR, \
full-width counters, Intel PMU driver. 2021-12-17T01:02:01.226148+0100 \
localhost.localdomain kernel: ... version:                2 \
2021-12-17T01:02:01.226153+0100 localhost.localdomain kernel: ... bit width:          \
48 2021-12-17T01:02:01.226158+0100 localhost.localdomain kernel: ... generic \
registers:      4 2021-12-17T01:02:01.226163+0100 localhost.localdomain kernel: ... \
value mask:             0000ffffffffffff 2021-12-17T01:02:01.226168+0100 \
localhost.localdomain kernel: ... max period:             00007fffffffffff \
2021-12-17T01:02:01.226173+0100 localhost.localdomain kernel: ... fixed-purpose \
events:   3 2021-12-17T01:02:01.226177+0100 localhost.localdomain kernel: ... event \
mask:             000000070000000f 2021-12-17T01:02:01.226185+0100 \
localhost.localdomain kernel: rcu: Hierarchical SRCU implementation. \
2021-12-17T01:02:01.226190+0100 localhost.localdomain kernel: smp: Bringing up \
secondary CPUs ... 2021-12-17T01:02:01.226200+0100 localhost.localdomain kernel: x86: \
Booting SMP configuration: 2021-12-17T01:02:01.226205+0100 localhost.localdomain \
kernel: .... node  #1, CPUs:      #1 2021-12-17T01:02:01.226210+0100 \
localhost.localdomain kernel: kvm-clock: cpu 1, msr 3de01041, secondary cpu clock \
2021-12-17T01:02:01.226215+0100 localhost.localdomain kernel: smpboot: CPU 1 \
Converting physical 0 to logical die 1 2021-12-17T01:02:01.226220+0100 \
localhost.localdomain kernel: kvm-guest: stealtime: cpu 1, msr 64e2c080 \
2021-12-17T01:02:01.226225+0100 localhost.localdomain kernel: smp: Brought up 2 \
nodes, 2 CPUs 2021-12-17T01:02:01.226230+0100 localhost.localdomain kernel: smpboot: \
Max logical packages: 2 2021-12-17T01:02:01.226235+0100 localhost.localdomain kernel: \
smpboot: Total of 2 processors activated (8380.30 BogoMIPS) \
2021-12-17T01:02:01.226242+0100 localhost.localdomain kernel: node 1 deferred pages \
initialised in 2ms 2021-12-17T01:02:01.226247+0100 localhost.localdomain kernel: node \
0 deferred pages initialised in 4ms 2021-12-17T01:02:01.226252+0100 \
localhost.localdomain kernel: devtmpfs: initialized 2021-12-17T01:02:01.226257+0100 \
localhost.localdomain kernel: x86/mm: Memory block size: 128MB \
2021-12-17T01:02:01.226262+0100 localhost.localdomain kernel: clocksource: jiffies: \
mask: 0xffffffff max_cycles: 0xffffffff, max_idle_ns: 1911260446275000 ns \
2021-12-17T01:02:01.226268+0100 localhost.localdomain kernel: futex hash table \
entries: 512 (order: 3, 32768 bytes, vmalloc) 2021-12-17T01:02:01.226273+0100 \
localhost.localdomain kernel: pinctrl core: initialized pinctrl subsystem \
2021-12-17T01:02:01.226278+0100 localhost.localdomain kernel: NET: Registered \
protocol family 16 2021-12-17T01:02:01.226282+0100 localhost.localdomain kernel: DMA: \
preallocated 256 KiB GFP_KERNEL pool for atomic allocations \
2021-12-17T01:02:01.226287+0100 localhost.localdomain kernel: DMA: preallocated 256 \
KiB GFP_KERNEL|GFP_DMA pool for atomic allocations 2021-12-17T01:02:01.226294+0100 \
localhost.localdomain kernel: DMA: preallocated 256 KiB GFP_KERNEL|GFP_DMA32 pool for \
atomic allocations 2021-12-17T01:02:01.226300+0100 localhost.localdomain kernel: \
audit: initializing netlink subsys (disabled) 2021-12-17T01:02:01.226305+0100 \
localhost.localdomain kernel: audit: type=2000 audit(1639699317.235:1): \
state=initialized audit_enabled=0 res=1 2021-12-17T01:02:01.226310+0100 \
localhost.localdomain kernel: cpuidle: using governor menu \
2021-12-17T01:02:01.226335+0100 localhost.localdomain kernel: ACPI: bus type PCI \
registered 2021-12-17T01:02:01.226341+0100 localhost.localdomain kernel: acpiphp: \
ACPI Hot Plug PCI Controller Driver version: 0.5 2021-12-17T01:02:01.226345+0100 \
localhost.localdomain kernel: PCI: MMCONFIG for domain 0000 [bus 00-ff] at [mem \
0xb0000000-0xbfffffff] (base 0xb0000000) 2021-12-17T01:02:01.226351+0100 \
localhost.localdomain kernel: PCI: MMCONFIG at [mem 0xb0000000-0xbfffffff] reserved \
in E820 2021-12-17T01:02:01.226356+0100 localhost.localdomain kernel: PCI: Using \
configuration type 1 for base access 2021-12-17T01:02:01.226364+0100 \
localhost.localdomain kernel: HugeTLB registered 1.00 GiB page size, pre-allocated 0 \
pages 2021-12-17T01:02:01.226369+0100 localhost.localdomain kernel: HugeTLB \
registered 2.00 MiB page size, pre-allocated 0 pages 2021-12-17T01:02:01.226373+0100 \
localhost.localdomain kernel: cryptd: max_cpu_qlen set to 1000 \
2021-12-17T01:02:01.226378+0100 localhost.localdomain kernel: ACPI: Added _OSI(Module \
Device) 2021-12-17T01:02:01.226383+0100 localhost.localdomain kernel: ACPI: Added \
_OSI(Processor Device) 2021-12-17T01:02:01.226388+0100 localhost.localdomain kernel: \
ACPI: Added _OSI(3.0 _SCP Extensions) 2021-12-17T01:02:01.226393+0100 \
localhost.localdomain kernel: ACPI: Added _OSI(Processor Aggregator Device) \
2021-12-17T01:02:01.226398+0100 localhost.localdomain kernel: ACPI: Added \
_OSI(Linux-Dell-Video) 2021-12-17T01:02:01.226403+0100 localhost.localdomain kernel: \
ACPI: Added _OSI(Linux-Lenovo-NV-HDMI-Audio) 2021-12-17T01:02:01.226410+0100 \
localhost.localdomain kernel: ACPI: Added _OSI(Linux-HPI-Hybrid-Graphics) \
2021-12-17T01:02:01.226415+0100 localhost.localdomain kernel: ACPI: 1 ACPI AML tables \
successfully acquired and loaded 2021-12-17T01:02:01.226419+0100 \
localhost.localdomain kernel: ACPI: Interpreter enabled \
2021-12-17T01:02:01.226425+0100 localhost.localdomain kernel: ACPI: (supports S0 S5) \
2021-12-17T01:02:01.226430+0100 localhost.localdomain kernel: ACPI: Using IOAPIC for \
interrupt routing 2021-12-17T01:02:01.226435+0100 localhost.localdomain kernel: PCI: \
Using host bridge windows from ACPI; if necessary, use "pci=nocrs" and report a bug \
2021-12-17T01:02:01.226440+0100 localhost.localdomain kernel: ACPI: Enabled 1 GPEs in \
block 00 to 3F 2021-12-17T01:02:01.226445+0100 localhost.localdomain kernel: ACPI: \
PCI Root Bridge [PCI0] (domain 0000 [bus 00-ff]) 2021-12-17T01:02:01.226593+0100 \
localhost.localdomain kernel: acpi PNP0A08:00: _OSC: OS supports [ExtendedConfig ASPM \
ClockPM Segments MSI EDR HPX-Type3] 2021-12-17T01:02:01.226671+0100 \
localhost.localdomain kernel: acpi PNP0A08:00: _OSC: platform does not support [LTR \
DPC] 2021-12-17T01:02:01.226740+0100 localhost.localdomain kernel: acpi PNP0A08:00: \
_OSC: OS now controls [PCIeHotplug SHPCHotplug PME AER PCIeCapability] \
2021-12-17T01:02:01.226747+0100 localhost.localdomain kernel: PCI host bridge to bus \
0000:00 2021-12-17T01:02:01.226829+0100 localhost.localdomain kernel: pci_bus \
0000:00: Unknown NUMA node; performance will be reduced \
2021-12-17T01:02:01.226892+0100 localhost.localdomain kernel: pci_bus 0000:00: root \
bus resource [io  0x0000-0x0cf7 window] 2021-12-17T01:02:01.226957+0100 \
localhost.localdomain kernel: pci_bus 0000:00: root bus resource [io  0x0d00-0xffff \
window] 2021-12-17T01:02:01.227019+0100 localhost.localdomain kernel: pci_bus \
0000:00: root bus resource [mem 0x000a0000-0x000bffff window] \
2021-12-17T01:02:01.227083+0100 localhost.localdomain kernel: pci_bus 0000:00: root \
bus resource [mem 0x70000000-0xafffffff window] 2021-12-17T01:02:01.227145+0100 \
localhost.localdomain kernel: pci_bus 0000:00: root bus resource [mem \
0xc0000000-0xfebfffff window] 2021-12-17T01:02:01.227217+0100 localhost.localdomain \
kernel: pci_bus 0000:00: root bus resource [mem 0x100000000-0x8ffffffff window] \
2021-12-17T01:02:01.227279+0100 localhost.localdomain kernel: pci_bus 0000:00: root \
bus resource [bus 00-ff] 2021-12-17T01:02:01.227380+0100 localhost.localdomain \
kernel: pci 0000:00:00.0: [8086:29c0] type 00 class 0x060000 \
2021-12-17T01:02:01.227468+0100 localhost.localdomain kernel: pci 0000:00:01.0: \
[1b36:000c] type 01 class 0x060400 2021-12-17T01:02:01.227550+0100 \
localhost.localdomain kernel: pci 0000:00:01.0: reg 0x10: [mem 0xfda00000-0xfda00fff] \
2021-12-17T01:02:01.227630+0100 localhost.localdomain kernel: pci 0000:00:01.1: \
[1b36:000c] type 01 class 0x060400 2021-12-17T01:02:01.227705+0100 \
localhost.localdomain kernel: pci 0000:00:01.1: reg 0x10: [mem 0xfda01000-0xfda01fff] \
2021-12-17T01:02:01.227783+0100 localhost.localdomain kernel: pci 0000:00:01.2: \
[1b36:000c] type 01 class 0x060400 2021-12-17T01:02:01.227860+0100 \
localhost.localdomain kernel: pci 0000:00:01.2: reg 0x10: [mem 0xfda02000-0xfda02fff] \
2021-12-17T01:02:01.227938+0100 localhost.localdomain kernel: pci 0000:00:01.3: \
[1b36:000c] type 01 class 0x060400 2021-12-17T01:02:01.228014+0100 \
localhost.localdomain kernel: pci 0000:00:01.3: reg 0x10: [mem 0xfda03000-0xfda03fff] \
2021-12-17T01:02:01.228102+0100 localhost.localdomain kernel: pci 0000:00:01.4: \
[1b36:000c] type 01 class 0x060400 2021-12-17T01:02:01.228178+0100 \
localhost.localdomain kernel: pci 0000:00:01.4: reg 0x10: [mem 0xfda04000-0xfda04fff] \
2021-12-17T01:02:01.228267+0100 localhost.localdomain kernel: pci 0000:00:01.5: \
2021-12-17T01:02:01.228449+0100 localhost.localdomain kernel: pci 0000:00:01.6: \
[1b36:000c] type 01 class 0x060400 2021-12-17T01:02:01.228523+0100 \
localhost.localdomain kernel: pci 0000:00:01.6: reg 0x10: [mem 0xfda06000-0xfda06fff] \
2021-12-17T01:02:01.228604+0100 localhost.localdomain kernel: pci 0000:00:01.7: \
[1b36:000c] type 01 class 0x060400 2021-12-17T01:02:01.228700+0100 \
localhost.localdomain kernel: pci 0000:00:01.7: reg 0x10: [mem 0xfda07000-0xfda07fff] \
2021-12-17T01:02:01.228783+0100 localhost.localdomain kernel: pci 0000:00:1f.0: \
[8086:2918] type 00 class 0x060100 2021-12-17T01:02:01.228864+0100 \
localhost.localdomain kernel: pci 0000:00:1f.0: quirk: [io  0x0600-0x067f] claimed by \
ICH6 ACPI/GPIO/TCO 2021-12-17T01:02:01.228948+0100 localhost.localdomain kernel: pci \
0000:00:1f.2: [8086:2922] type 00 class 0x010601 2021-12-17T01:02:01.229029+0100 \
localhost.localdomain kernel: pci 0000:00:1f.2: reg 0x20: [io  0xc040-0xc05f] \
2021-12-17T01:02:01.229110+0100 localhost.localdomain kernel: pci 0000:00:1f.2: reg \
0x24: [mem 0xfda08000-0xfda08fff] 2021-12-17T01:02:01.229206+0100 \
localhost.localdomain kernel: pci 0000:00:1f.3: [8086:2930] type 00 class 0x0c0500 \
2021-12-17T01:02:01.229286+0100 localhost.localdomain kernel: pci 0000:00:1f.3: reg \
0x20: [io  0x0700-0x073f] 2021-12-17T01:02:01.229395+0100 localhost.localdomain \
kernel: pci 0000:01:00.0: [1af4:1041] type 00 class 0x020000 \
2021-12-17T01:02:01.229475+0100 localhost.localdomain kernel: pci 0000:01:00.0: reg \
0x14: [mem 0xfd840000-0xfd840fff] 2021-12-17T01:02:01.229554+0100 \
localhost.localdomain kernel: pci 0000:01:00.0: reg 0x20: [mem 0xfea00000-0xfea03fff \
64bit pref] 2021-12-17T01:02:01.229633+0100 localhost.localdomain kernel: pci \
0000:01:00.0: reg 0x30: [mem 0xfd800000-0xfd83ffff pref] \
2021-12-17T01:02:01.229712+0100 localhost.localdomain kernel: pci 0000:00:01.0: PCI \
bridge to [bus 01] 2021-12-17T01:02:01.229786+0100 localhost.localdomain kernel: pci \
0000:00:01.0:   bridge window [mem 0xfd800000-0xfd9fffff] \
2021-12-17T01:02:01.229859+0100 localhost.localdomain kernel: pci 0000:00:01.0:   \
bridge window [mem 0xfea00000-0xfebfffff 64bit pref] 2021-12-17T01:02:01.229942+0100 \
localhost.localdomain kernel: pci 0000:02:00.0: [1af4:1041] type 00 class 0x020000 \
2021-12-17T01:02:01.230021+0100 localhost.localdomain kernel: pci 0000:02:00.0: reg \
0x14: [mem 0xfd640000-0xfd640fff] 2021-12-17T01:02:01.230100+0100 \
localhost.localdomain kernel: pci 0000:02:00.0: reg 0x20: [mem 0xfe800000-0xfe803fff \
64bit pref] 2021-12-17T01:02:01.230178+0100 localhost.localdomain kernel: pci \
0000:02:00.0: reg 0x30: [mem 0xfd600000-0xfd63ffff pref] \
2021-12-17T01:02:01.230260+0100 localhost.localdomain kernel: pci 0000:00:01.1: PCI \
bridge to [bus 02] 2021-12-17T01:02:01.230344+0100 localhost.localdomain kernel: pci \
0000:00:01.1:   bridge window [mem 0xfd600000-0xfd7fffff] \
2021-12-17T01:02:01.230419+0100 localhost.localdomain kernel: pci 0000:00:01.1:   \
bridge window [mem 0xfe800000-0xfe9fffff 64bit pref] 2021-12-17T01:02:01.230503+0100 \
localhost.localdomain kernel: pci 0000:03:00.0: [1af4:1041] type 00 class 0x020000 \
2021-12-17T01:02:01.230581+0100 localhost.localdomain kernel: pci 0000:03:00.0: reg \
0x14: [mem 0xfd440000-0xfd440fff] 2021-12-17T01:02:01.230659+0100 \
localhost.localdomain kernel: pci 0000:03:00.0: reg 0x20: [mem 0xfe600000-0xfe603fff \
64bit pref] 2021-12-17T01:02:01.230736+0100 localhost.localdomain kernel: pci \
0000:03:00.0: reg 0x30: [mem 0xfd400000-0xfd43ffff pref] \
2021-12-17T01:02:01.230814+0100 localhost.localdomain kernel: pci 0000:00:01.2: PCI \
bridge to [bus 03] 2021-12-17T01:02:01.230887+0100 localhost.localdomain kernel: pci \
0000:00:01.2:   bridge window [mem 0xfd400000-0xfd5fffff] \
2021-12-17T01:02:01.230960+0100 localhost.localdomain kernel: pci 0000:00:01.2:   \
bridge window [mem 0xfe600000-0xfe7fffff 64bit pref] 2021-12-17T01:02:01.231044+0100 \
localhost.localdomain kernel: pci 0000:04:00.0: [1af4:1041] type 00 class 0x020000 \
2021-12-17T01:02:01.231122+0100 localhost.localdomain kernel: pci 0000:04:00.0: reg \
0x14: [mem 0xfd240000-0xfd240fff] 2021-12-17T01:02:01.231206+0100 \
localhost.localdomain kernel: pci 0000:04:00.0: reg 0x20: [mem 0xfe400000-0xfe403fff \
64bit pref] 2021-12-17T01:02:01.231285+0100 localhost.localdomain kernel: pci \
0000:04:00.0: reg 0x30: [mem 0xfd200000-0xfd23ffff pref] \
2021-12-17T01:02:01.231371+0100 localhost.localdomain kernel: pci 0000:00:01.3: PCI \
bridge to [bus 04] 2021-12-17T01:02:01.231449+0100 localhost.localdomain kernel: pci \
0000:00:01.3:   bridge window [mem 0xfd200000-0xfd3fffff] \
2021-12-17T01:02:01.231522+0100 localhost.localdomain kernel: pci 0000:00:01.3:   \
bridge window [mem 0xfe400000-0xfe5fffff 64bit pref] 2021-12-17T01:02:01.231610+0100 \
localhost.localdomain kernel: pci 0000:05:00.0: [1af4:1043] type 00 class 0x078000 \
2021-12-17T01:02:01.231690+0100 localhost.localdomain kernel: pci 0000:05:00.0: reg \
0x14: [mem 0xfd000000-0xfd000fff] 2021-12-17T01:02:01.231769+0100 \
localhost.localdomain kernel: pci 0000:05:00.0: reg 0x20: [mem 0xfe200000-0xfe203fff \
64bit pref] 2021-12-17T01:02:01.231845+0100 localhost.localdomain kernel: pci \
0000:00:01.4: PCI bridge to [bus 05] 2021-12-17T01:02:01.231919+0100 \
localhost.localdomain kernel: pci 0000:00:01.4:   bridge window [mem \
0xfd000000-0xfd1fffff] 2021-12-17T01:02:01.232011+0100 localhost.localdomain kernel: \
pci 0000:00:01.4:   bridge window [mem 0xfe200000-0xfe3fffff 64bit pref] \
2021-12-17T01:02:01.232101+0100 localhost.localdomain kernel: pci 0000:06:00.0: \
[1af4:1042] type 00 class 0x010000 2021-12-17T01:02:01.232185+0100 \
localhost.localdomain kernel: pci 0000:06:00.0: reg 0x14: [mem 0xfce00000-0xfce00fff] \
2021-12-17T01:02:01.232278+0100 localhost.localdomain kernel: pci 0000:06:00.0: reg \
0x20: [mem 0xfe000000-0xfe003fff 64bit pref] 2021-12-17T01:02:01.240471+0100 \
localhost.localdomain kernel: pci 0000:00:01.5: PCI bridge to [bus 06] \
2021-12-17T01:02:01.240570+0100 localhost.localdomain kernel: pci 0000:00:01.5:   \
bridge window [mem 0xfce00000-0xfcffffff] 2021-12-17T01:02:01.240687+0100 \
localhost.localdomain kernel: pci 0000:00:01.5:   bridge window [mem \
0xfe000000-0xfe1fffff 64bit pref] 2021-12-17T01:02:01.240775+0100 \
localhost.localdomain kernel: pci 0000:07:00.0: [1af4:1044] type 00 class 0x00ff00 \
2021-12-17T01:02:01.240860+0100 localhost.localdomain kernel: pci 0000:07:00.0: reg \
0x20: [mem 0xfde00000-0xfde03fff 64bit pref] 2021-12-17T01:02:01.240938+0100 \
localhost.localdomain kernel: pci 0000:00:01.6: PCI bridge to [bus 07] \
2021-12-17T01:02:01.241013+0100 localhost.localdomain kernel: pci 0000:00:01.6:   \
bridge window [mem 0xfcc00000-0xfcdfffff] 2021-12-17T01:02:01.241087+0100 \
localhost.localdomain kernel: pci 0000:00:01.6:   bridge window [mem \
0xfde00000-0xfdffffff 64bit pref] 2021-12-17T01:02:01.241164+0100 \
localhost.localdomain kernel: pci 0000:00:01.7: PCI bridge to [bus 08] \
2021-12-17T01:02:01.241249+0100 localhost.localdomain kernel: pci 0000:00:01.7:   \
bridge window [mem 0xfca00000-0xfcbfffff] 2021-12-17T01:02:01.241333+0100 \
localhost.localdomain kernel: pci 0000:00:01.7:   bridge window [mem \
0xfdc00000-0xfddfffff 64bit pref] 2021-12-17T01:02:01.241340+0100 \
localhost.localdomain kernel: ACPI: PCI Interrupt Link [LNKA] (IRQs 5 *10 11) \
2021-12-17T01:02:01.241349+0100 localhost.localdomain kernel: ACPI: PCI Interrupt \
Link [LNKB] (IRQs 5 *10 11) 2021-12-17T01:02:01.241354+0100 localhost.localdomain \
kernel: ACPI: PCI Interrupt Link [LNKC] (IRQs 5 10 *11) \
2021-12-17T01:02:01.241359+0100 localhost.localdomain kernel: ACPI: PCI Interrupt \
Link [LNKD] (IRQs 5 10 *11) 2021-12-17T01:02:01.241365+0100 localhost.localdomain \
kernel: ACPI: PCI Interrupt Link [LNKE] (IRQs 5 *10 11) \
2021-12-17T01:02:01.241369+0100 localhost.localdomain kernel: ACPI: PCI Interrupt \
Link [LNKF] (IRQs 5 *10 11) 2021-12-17T01:02:01.241375+0100 localhost.localdomain \
kernel: ACPI: PCI Interrupt Link [LNKG] (IRQs 5 10 *11) \
2021-12-17T01:02:01.241380+0100 localhost.localdomain kernel: ACPI: PCI Interrupt \
Link [LNKH] (IRQs 5 10 *11) 2021-12-17T01:02:01.241386+0100 localhost.localdomain \
kernel: ACPI: PCI Interrupt Link [GSIA] (IRQs *16) 2021-12-17T01:02:01.241390+0100 \
localhost.localdomain kernel: ACPI: PCI Interrupt Link [GSIB] (IRQs *17) \
2021-12-17T01:02:01.241395+0100 localhost.localdomain kernel: ACPI: PCI Interrupt \
Link [GSIC] (IRQs *18) 2021-12-17T01:02:01.241402+0100 localhost.localdomain kernel: \
ACPI: PCI Interrupt Link [GSID] (IRQs *19) 2021-12-17T01:02:01.241407+0100 \
localhost.localdomain kernel: ACPI: PCI Interrupt Link [GSIE] (IRQs *20) \
2021-12-17T01:02:01.241412+0100 localhost.localdomain kernel: ACPI: PCI Interrupt \
Link [GSIF] (IRQs *21) 2021-12-17T01:02:01.241418+0100 localhost.localdomain kernel: \
ACPI: PCI Interrupt Link [GSIG] (IRQs *22) 2021-12-17T01:02:01.241422+0100 \
localhost.localdomain kernel: ACPI: PCI Interrupt Link [GSIH] (IRQs *23) \
2021-12-17T01:02:01.241427+0100 localhost.localdomain kernel: iommu: Default domain \
type: Passthrough  2021-12-17T01:02:01.241432+0100 localhost.localdomain kernel: \
vgaarb: loaded 2021-12-17T01:02:01.241437+0100 localhost.localdomain kernel: SCSI \
subsystem initialized 2021-12-17T01:02:01.241454+0100 localhost.localdomain kernel: \
ACPI: bus type USB registered 2021-12-17T01:02:01.241462+0100 localhost.localdomain \
kernel: usbcore: registered new interface driver usbfs \
2021-12-17T01:02:01.241468+0100 localhost.localdomain kernel: usbcore: registered new \
interface driver hub 2021-12-17T01:02:01.241473+0100 localhost.localdomain kernel: \
usbcore: registered new device driver usb 2021-12-17T01:02:01.241480+0100 \
localhost.localdomain kernel: pps_core: LinuxPPS API ver. 1 registered \
2021-12-17T01:02:01.241486+0100 localhost.localdomain kernel: pps_core: Software ver. \
5.3.6 - Copyright 2005-2007 Rodolfo Giometti &lt;giometti@linux.it&gt; \
2021-12-17T01:02:01.241491+0100 localhost.localdomain kernel: PTP clock support \
registered 2021-12-17T01:02:01.241496+0100 localhost.localdomain kernel: EDAC MC: \
Ver: 3.0.0 2021-12-17T01:02:01.241501+0100 localhost.localdomain kernel: PCI: Using \
ACPI for IRQ routing 2021-12-17T01:02:01.241506+0100 localhost.localdomain kernel: \
PCI: pci_cache_line_size set to 64 bytes 2021-12-17T01:02:01.241512+0100 \
localhost.localdomain kernel: e820: reserve RAM buffer [mem 0x0009f800-0x0009ffff] \
2021-12-17T01:02:01.241518+0100 localhost.localdomain kernel: e820: reserve RAM \
buffer [mem 0x6ffdd000-0x6fffffff] 2021-12-17T01:02:01.241524+0100 \
localhost.localdomain kernel: NetLabel: Initializing 2021-12-17T01:02:01.241529+0100 \
localhost.localdomain kernel: NetLabel:  domain hash size = 128 \
2021-12-17T01:02:01.241536+0100 localhost.localdomain kernel: NetLabel:  protocols = \
UNLABELED CIPSOv4 CALIPSO 2021-12-17T01:02:01.241541+0100 localhost.localdomain \
kernel: NetLabel:  unlabeled traffic allowed by default \
2021-12-17T01:02:01.241547+0100 localhost.localdomain kernel: clocksource: Switched \
to clocksource kvm-clock 2021-12-17T01:02:01.241552+0100 localhost.localdomain \
kernel: VFS: Disk quotas dquot_6.6.0 2021-12-17T01:02:01.241558+0100 \
localhost.localdomain kernel: VFS: Dquot-cache hash table entries: 512 (order 0, 4096 \
bytes) 2021-12-17T01:02:01.241564+0100 localhost.localdomain kernel: pnp: PnP ACPI \
init 2021-12-17T01:02:01.241646+0100 localhost.localdomain kernel: pnp 00:00: Plug \
and Play ACPI device, IDs PNP0b00 (active) 2021-12-17T01:02:01.241726+0100 \
localhost.localdomain kernel: pnp 00:01: Plug and Play ACPI device, IDs PNP0303 \
(active) 2021-12-17T01:02:01.241799+0100 localhost.localdomain kernel: pnp 00:02: \
Plug and Play ACPI device, IDs PNP0f13 (active) 2021-12-17T01:02:01.241872+0100 \
localhost.localdomain kernel: pnp 00:03: Plug and Play ACPI device, IDs PNP0501 \
(active) 2021-12-17T01:02:01.241880+0100 localhost.localdomain kernel: pnp: PnP ACPI: \
found 4 devices 2021-12-17T01:02:01.241886+0100 localhost.localdomain kernel: \
clocksource: acpi_pm: mask: 0xffffff max_cycles: 0xffffff, max_idle_ns: 2085701024 ns \
2021-12-17T01:02:01.241962+0100 localhost.localdomain kernel: pci 0000:00:01.0: \
bridge window [io  0x1000-0x0fff] to [bus 01] add_size 1000 \
2021-12-17T01:02:01.242039+0100 localhost.localdomain kernel: pci 0000:00:01.1: \
bridge window [io  0x1000-0x0fff] to [bus 02] add_size 1000 \
2021-12-17T01:02:01.242117+0100 localhost.localdomain kernel: pci 0000:00:01.2: \
bridge window [io  0x1000-0x0fff] to [bus 03] add_size 1000 \
2021-12-17T01:02:01.242203+0100 localhost.localdomain kernel: pci 0000:00:01.3: \
bridge window [io  0x1000-0x0fff] to [bus 04] add_size 1000 \
2021-12-17T01:02:01.242281+0100 localhost.localdomain kernel: pci 0000:00:01.4: \
bridge window [io  0x1000-0x0fff] to [bus 05] add_size 1000 \
2021-12-17T01:02:01.242364+0100 localhost.localdomain kernel: pci 0000:00:01.5: \
bridge window [io  0x1000-0x0fff] to [bus 06] add_size 1000 \
2021-12-17T01:02:01.242459+0100 localhost.localdomain kernel: pci 0000:00:01.6: \
bridge window [io  0x1000-0x0fff] to [bus 07] add_size 1000 \
2021-12-17T01:02:01.242539+0100 localhost.localdomain kernel: pci 0000:00:01.7: \
bridge window [io  0x1000-0x0fff] to [bus 08] add_size 1000 \
2021-12-17T01:02:01.242618+0100 localhost.localdomain kernel: pci 0000:00:01.0: BAR \
13: assigned [io  0x1000-0x1fff] 2021-12-17T01:02:01.242701+0100 \
localhost.localdomain kernel: pci 0000:00:01.1: BAR 13: assigned [io  0x2000-0x2fff] \
2021-12-17T01:02:01.242780+0100 localhost.localdomain kernel: pci 0000:00:01.2: BAR \
13: assigned [io  0x3000-0x3fff] 2021-12-17T01:02:01.242859+0100 \
localhost.localdomain kernel: pci 0000:00:01.3: BAR 13: assigned [io  0x4000-0x4fff] \
2021-12-17T01:02:01.242939+0100 localhost.localdomain kernel: pci 0000:00:01.4: BAR \
13: assigned [io  0x5000-0x5fff] 2021-12-17T01:02:01.243017+0100 \
localhost.localdomain kernel: pci 0000:00:01.5: BAR 13: assigned [io  0x6000-0x6fff] \
2021-12-17T01:02:01.243095+0100 localhost.localdomain kernel: pci 0000:00:01.6: BAR \
13: assigned [io  0x7000-0x7fff] 2021-12-17T01:02:01.243174+0100 \
localhost.localdomain kernel: pci 0000:00:01.7: BAR 13: assigned [io  0x8000-0x8fff] \
2021-12-17T01:02:01.243259+0100 localhost.localdomain kernel: pci 0000:00:01.0: PCI \
bridge to [bus 01] 2021-12-17T01:02:01.243344+0100 localhost.localdomain kernel: pci \
0000:00:01.0:   bridge window [io  0x1000-0x1fff] 2021-12-17T01:02:01.243426+0100 \
localhost.localdomain kernel: pci 0000:00:01.0:   bridge window [mem \
0xfd800000-0xfd9fffff] 2021-12-17T01:02:01.243506+0100 localhost.localdomain kernel: \
pci 0000:00:01.0:   bridge window [mem 0xfea00000-0xfebfffff 64bit pref] \
2021-12-17T01:02:01.243585+0100 localhost.localdomain kernel: pci 0000:00:01.1: PCI \
bridge to [bus 02] 2021-12-17T01:02:01.243663+0100 localhost.localdomain kernel: pci \
0000:00:01.1:   bridge window [io  0x2000-0x2fff] 2021-12-17T01:02:01.243742+0100 \
localhost.localdomain kernel: pci 0000:00:01.1:   bridge window [mem \
0xfd600000-0xfd7fffff] 2021-12-17T01:02:01.243820+0100 localhost.localdomain kernel: \
pci 0000:00:01.1:   bridge window [mem 0xfe800000-0xfe9fffff 64bit pref] \
2021-12-17T01:02:01.243899+0100 localhost.localdomain kernel: pci 0000:00:01.2: PCI \
bridge to [bus 03] 2021-12-17T01:02:01.243978+0100 localhost.localdomain kernel: pci \
0000:00:01.2:   bridge window [io  0x3000-0x3fff] 2021-12-17T01:02:01.244057+0100 \
localhost.localdomain kernel: pci 0000:00:01.2:   bridge window [mem \
0xfd400000-0xfd5fffff] 2021-12-17T01:02:01.244139+0100 localhost.localdomain kernel: \
pci 0000:00:01.2:   bridge window [mem 0xfe600000-0xfe7fffff 64bit pref] \
2021-12-17T01:02:01.244226+0100 localhost.localdomain kernel: pci 0000:00:01.3: PCI \
bridge to [bus 04] 2021-12-17T01:02:01.244307+0100 localhost.localdomain kernel: pci \
2021-12-17T01:02:01.244477+0100 localhost.localdomain kernel: pci 0000:00:01.3:   \
bridge window [mem 0xfe400000-0xfe5fffff 64bit pref] 2021-12-17T01:02:01.244551+0100 \
localhost.localdomain kernel: pci 0000:00:01.4: PCI bridge to [bus 05] \
2021-12-17T01:02:01.244644+0100 localhost.localdomain kernel: pci 0000:00:01.4:   \
bridge window [io  0x5000-0x5fff] 2021-12-17T01:02:01.244724+0100 \
localhost.localdomain kernel: pci 0000:00:01.4:   bridge window [mem \
0xfd000000-0xfd1fffff] 2021-12-17T01:02:01.244811+0100 localhost.localdomain kernel: \
pci 0000:00:01.4:   bridge window [mem 0xfe200000-0xfe3fffff 64bit pref] \
2021-12-17T01:02:01.244884+0100 localhost.localdomain kernel: pci 0000:00:01.5: PCI \
bridge to [bus 06] 2021-12-17T01:02:01.244957+0100 localhost.localdomain kernel: pci \
0000:00:01.5:   bridge window [io  0x6000-0x6fff] 2021-12-17T01:02:01.245030+0100 \
localhost.localdomain kernel: pci 0000:00:01.5:   bridge window [mem \
0xfce00000-0xfcffffff] 2021-12-17T01:02:01.245105+0100 localhost.localdomain kernel: \
pci 0000:00:01.5:   bridge window [mem 0xfe000000-0xfe1fffff 64bit pref] \
2021-12-17T01:02:01.245178+0100 localhost.localdomain kernel: pci 0000:00:01.6: PCI \
bridge to [bus 07] 2021-12-17T01:02:01.245259+0100 localhost.localdomain kernel: pci \
0000:00:01.6:   bridge window [io  0x7000-0x7fff] 2021-12-17T01:02:01.245342+0100 \
localhost.localdomain kernel: pci 0000:00:01.6:   bridge window [mem \
0xfcc00000-0xfcdfffff] 2021-12-17T01:02:01.245416+0100 localhost.localdomain kernel: \
pci 0000:00:01.6:   bridge window [mem 0xfde00000-0xfdffffff 64bit pref] \
2021-12-17T01:02:01.245490+0100 localhost.localdomain kernel: pci 0000:00:01.7: PCI \
bridge to [bus 08] 2021-12-17T01:02:01.245564+0100 localhost.localdomain kernel: pci \
0000:00:01.7:   bridge window [io  0x8000-0x8fff] 2021-12-17T01:02:01.245638+0100 \
localhost.localdomain kernel: pci 0000:00:01.7:   bridge window [mem \
0xfca00000-0xfcbfffff] 2021-12-17T01:02:01.245716+0100 localhost.localdomain kernel: \
pci 0000:00:01.7:   bridge window [mem 0xfdc00000-0xfddfffff 64bit pref] \
2021-12-17T01:02:01.245785+0100 localhost.localdomain kernel: pci_bus 0000:00: \
resource 4 [io  0x0000-0x0cf7 window] 2021-12-17T01:02:01.245848+0100 \
localhost.localdomain kernel: pci_bus 0000:00: resource 5 [io  0x0d00-0xffff window] \
2021-12-17T01:02:01.245912+0100 localhost.localdomain kernel: pci_bus 0000:00: \
resource 6 [mem 0x000a0000-0x000bffff window] 2021-12-17T01:02:01.245977+0100 \
localhost.localdomain kernel: pci_bus 0000:00: resource 7 [mem 0x70000000-0xafffffff \
window] 2021-12-17T01:02:01.246038+0100 localhost.localdomain kernel: pci_bus \
0000:00: resource 8 [mem 0xc0000000-0xfebfffff window] \
2021-12-17T01:02:01.246104+0100 localhost.localdomain kernel: pci_bus 0000:00: \
resource 9 [mem 0x100000000-0x8ffffffff window] 2021-12-17T01:02:01.246178+0100 \
localhost.localdomain kernel: pci_bus 0000:01: resource 0 [io  0x1000-0x1fff] \
2021-12-17T01:02:01.246255+0100 localhost.localdomain kernel: pci_bus 0000:01: \
resource 1 [mem 0xfd800000-0xfd9fffff] 2021-12-17T01:02:01.246335+0100 \
localhost.localdomain kernel: pci_bus 0000:01: resource 2 [mem 0xfea00000-0xfebfffff \
64bit pref] 2021-12-17T01:02:01.246410+0100 localhost.localdomain kernel: pci_bus \
0000:02: resource 0 [io  0x2000-0x2fff] 2021-12-17T01:02:01.246477+0100 \
localhost.localdomain kernel: pci_bus 0000:02: resource 1 [mem 0xfd600000-0xfd7fffff] \
2021-12-17T01:02:01.246542+0100 localhost.localdomain kernel: pci_bus 0000:02: \
resource 2 [mem 0xfe800000-0xfe9fffff 64bit pref] 2021-12-17T01:02:01.246613+0100 \
localhost.localdomain kernel: pci_bus 0000:03: resource 0 [io  0x3000-0x3fff] \
2021-12-17T01:02:01.246683+0100 localhost.localdomain kernel: pci_bus 0000:03: \
resource 1 [mem 0xfd400000-0xfd5fffff] 2021-12-17T01:02:01.246751+0100 \
localhost.localdomain kernel: pci_bus 0000:03: resource 2 [mem 0xfe600000-0xfe7fffff \
64bit pref] 2021-12-17T01:02:01.246829+0100 localhost.localdomain kernel: pci_bus \
0000:04: resource 0 [io  0x4000-0x4fff] 2021-12-17T01:02:01.246897+0100 \
localhost.localdomain kernel: pci_bus 0000:04: resource 1 [mem 0xfd200000-0xfd3fffff] \
2021-12-17T01:02:01.246962+0100 localhost.localdomain kernel: pci_bus 0000:04: \
resource 2 [mem 0xfe400000-0xfe5fffff 64bit pref] 2021-12-17T01:02:01.247055+0100 \
localhost.localdomain kernel: pci_bus 0000:05: resource 0 [io  0x5000-0x5fff] \
2021-12-17T01:02:01.247127+0100 localhost.localdomain kernel: pci_bus 0000:05: \
resource 1 [mem 0xfd000000-0xfd1fffff] 2021-12-17T01:02:01.247207+0100 \
localhost.localdomain kernel: pci_bus 0000:05: resource 2 [mem 0xfe200000-0xfe3fffff \
64bit pref] 2021-12-17T01:02:01.247282+0100 localhost.localdomain kernel: pci_bus \
0000:06: resource 0 [io  0x6000-0x6fff] 2021-12-17T01:02:01.251417+0100 \
localhost.localdomain kernel: pci_bus 0000:06: resource 1 [mem 0xfce00000-0xfcffffff] \
2021-12-17T01:02:01.251500+0100 localhost.localdomain kernel: pci_bus 0000:06: \
resource 2 [mem 0xfe000000-0xfe1fffff 64bit pref] 2021-12-17T01:02:01.251580+0100 \
localhost.localdomain kernel: pci_bus 0000:07: resource 0 [io  0x7000-0x7fff] \
2021-12-17T01:02:01.251648+0100 localhost.localdomain kernel: pci_bus 0000:07: \
resource 1 [mem 0xfcc00000-0xfcdfffff] 2021-12-17T01:02:01.251714+0100 \
localhost.localdomain kernel: pci_bus 0000:07: resource 2 [mem 0xfde00000-0xfdffffff \
64bit pref] 2021-12-17T01:02:01.251790+0100 localhost.localdomain kernel: pci_bus \
0000:08: resource 0 [io  0x8000-0x8fff] 2021-12-17T01:02:01.251855+0100 \
localhost.localdomain kernel: pci_bus 0000:08: resource 1 [mem 0xfca00000-0xfcbfffff] \
2021-12-17T01:02:01.251920+0100 localhost.localdomain kernel: pci_bus 0000:08: \
resource 2 [mem 0xfdc00000-0xfddfffff 64bit pref] 2021-12-17T01:02:01.251927+0100 \
localhost.localdomain kernel: NET: Registered protocol family 2 \
2021-12-17T01:02:01.251934+0100 localhost.localdomain kernel: \
tcp_listen_portaddr_hash hash table entries: 1024 (order: 2, 16384 bytes, vmalloc) \
2021-12-17T01:02:01.251940+0100 localhost.localdomain kernel: TCP established hash \
table entries: 16384 (order: 5, 131072 bytes, vmalloc) \
2021-12-17T01:02:01.251945+0100 localhost.localdomain kernel: TCP bind hash table \
entries: 16384 (order: 6, 262144 bytes, vmalloc) 2021-12-17T01:02:01.251950+0100 \
localhost.localdomain kernel: TCP: Hash tables configured (established 16384 bind \
16384) 2021-12-17T01:02:01.251958+0100 localhost.localdomain kernel: MPTCP token hash \
table entries: 2048 (order: 3, 49152 bytes, vmalloc) 2021-12-17T01:02:01.251964+0100 \
localhost.localdomain kernel: UDP hash table entries: 1024 (order: 3, 32768 bytes, \
vmalloc) 2021-12-17T01:02:01.251969+0100 localhost.localdomain kernel: UDP-Lite hash \
table entries: 1024 (order: 3, 32768 bytes, vmalloc) 2021-12-17T01:02:01.251975+0100 \
localhost.localdomain kernel: NET: Registered protocol family 1 \
2021-12-17T01:02:01.251981+0100 localhost.localdomain kernel: NET: Registered \
protocol family 44 2021-12-17T01:02:01.251986+0100 localhost.localdomain kernel: PCI: \
CLS 0 bytes, default 64 2021-12-17T01:02:01.251991+0100 localhost.localdomain kernel: \
Unpacking initramfs... 2021-12-17T01:02:01.251996+0100 localhost.localdomain kernel: \
Freeing initrd memory: 28604K 2021-12-17T01:02:01.252002+0100 localhost.localdomain \
kernel: clocksource: tsc: mask: 0xffffffffffffffff max_cycles: 0x1e33052aadd, \
max_idle_ns: 440795310221 ns 2021-12-17T01:02:01.252007+0100 localhost.localdomain \
kernel: alg: self-tests for aes-asm (aes) passed 2021-12-17T01:02:01.252015+0100 \
localhost.localdomain kernel: alg: self-tests for sha1-ssse3 (sha1) passed \
2021-12-17T01:02:01.252020+0100 localhost.localdomain kernel: alg: self-tests for \
sha1-avx (sha1) passed 2021-12-17T01:02:01.252026+0100 localhost.localdomain kernel: \
alg: self-tests for sha1-avx2 (sha1) passed 2021-12-17T01:02:01.252032+0100 \
localhost.localdomain kernel: alg: self-tests for sha256-ssse3 (sha256) passed \
2021-12-17T01:02:01.252037+0100 localhost.localdomain kernel: alg: self-tests for \
sha224-ssse3 (sha224) passed 2021-12-17T01:02:01.252042+0100 localhost.localdomain \
kernel: alg: self-tests for sha256-avx (sha256) passed \
2021-12-17T01:02:01.252047+0100 localhost.localdomain kernel: alg: self-tests for \
sha224-avx (sha224) passed 2021-12-17T01:02:01.252052+0100 localhost.localdomain \
kernel: alg: self-tests for sha256-avx2 (sha256) passed \
2021-12-17T01:02:01.252058+0100 localhost.localdomain kernel: alg: self-tests for \
sha224-avx2 (sha224) passed 2021-12-17T01:02:01.252066+0100 localhost.localdomain \
kernel: alg: self-tests for sha512-ssse3 (sha512) passed \
2021-12-17T01:02:01.252072+0100 localhost.localdomain kernel: alg: self-tests for \
sha384-ssse3 (sha384) passed 2021-12-17T01:02:01.252077+0100 localhost.localdomain \
kernel: alg: self-tests for sha512-avx (sha512) passed \
2021-12-17T01:02:01.252083+0100 localhost.localdomain kernel: alg: self-tests for \
sha384-avx (sha384) passed 2021-12-17T01:02:01.252088+0100 localhost.localdomain \
kernel: alg: self-tests for sha512-avx2 (sha512) passed \
2021-12-17T01:02:01.252093+0100 localhost.localdomain kernel: alg: self-tests for \
sha384-avx2 (sha384) passed 2021-12-17T01:02:01.252099+0100 localhost.localdomain \
kernel: Initialise system trusted keyrings 2021-12-17T01:02:01.252105+0100 \
localhost.localdomain kernel: Key type blacklist registered \
2021-12-17T01:02:01.252110+0100 localhost.localdomain kernel: workingset: \
timestamp_bits=36 max_order=19 bucket_order=0 2021-12-17T01:02:01.252116+0100 \
localhost.localdomain kernel: zbud: loaded 2021-12-17T01:02:01.252123+0100 \
localhost.localdomain kernel: pstore: using deflate compression \
2021-12-17T01:02:01.252128+0100 localhost.localdomain kernel: Platform Keyring \
initialized 2021-12-17T01:02:01.252133+0100 localhost.localdomain kernel: alg: \
self-tests for rsa-generic (rsa) passed 2021-12-17T01:02:01.252139+0100 \
localhost.localdomain kernel: alg: self-tests for cipher_null-generic (cipher_null) \
passed 2021-12-17T01:02:01.252145+0100 localhost.localdomain kernel: alg: self-tests \
for ecb-cipher_null (ecb(cipher_null)) passed 2021-12-17T01:02:01.252151+0100 \
localhost.localdomain kernel: alg: self-tests for sha1-generic (sha1) passed \
2021-12-17T01:02:01.252156+0100 localhost.localdomain kernel: alg: self-tests for \
sha256-generic (sha256) passed 2021-12-17T01:02:01.252161+0100 localhost.localdomain \
kernel: alg: self-tests for sha224-generic (sha224) passed \
2021-12-17T01:02:01.252169+0100 localhost.localdomain kernel: alg: self-tests for \
sha512-generic (sha512) passed 2021-12-17T01:02:01.252176+0100 localhost.localdomain \
kernel: alg: self-tests for sha384-generic (sha384) passed \
2021-12-17T01:02:01.252182+0100 localhost.localdomain kernel: alg: self-tests for \
aes-generic (aes) passed 2021-12-17T01:02:01.252187+0100 localhost.localdomain \
kernel: alg: self-tests for deflate-generic (deflate) passed \
2021-12-17T01:02:01.252193+0100 localhost.localdomain kernel: alg: self-tests for \
deflate-scomp (deflate) passed 2021-12-17T01:02:01.252208+0100 localhost.localdomain \
kernel: alg: self-tests for zlib-deflate-scomp (zlib-deflate) passed \
2021-12-17T01:02:01.252213+0100 localhost.localdomain kernel: alg: self-tests for \
crc32c-generic (crc32c) passed 2021-12-17T01:02:01.252219+0100 localhost.localdomain \
kernel: alg: self-tests for crct10dif-generic (crct10dif) passed \
2021-12-17T01:02:01.252224+0100 localhost.localdomain kernel: alg: self-tests for \
lzo-generic (lzo) passed 2021-12-17T01:02:01.252229+0100 localhost.localdomain \
kernel: alg: self-tests for lzo-scomp (lzo) passed 2021-12-17T01:02:01.252237+0100 \
localhost.localdomain kernel: alg: self-tests for ctr(aes-asm) (ctr(aes)) passed \
2021-12-17T01:02:01.252243+0100 localhost.localdomain kernel: alg: self-tests for \
drbg_pr_ctr_aes128 (stdrng) passed 2021-12-17T01:02:01.252249+0100 \
localhost.localdomain kernel: alg: self-tests for drbg_pr_ctr_aes192 (stdrng) passed \
2021-12-17T01:02:01.252254+0100 localhost.localdomain kernel: alg: self-tests for \
drbg_pr_ctr_aes256 (stdrng) passed 2021-12-17T01:02:01.252259+0100 \
localhost.localdomain kernel: alg: self-tests for drbg_pr_sha1 (stdrng) passed \
2021-12-17T01:02:01.252264+0100 localhost.localdomain kernel: alg: self-tests for \
drbg_pr_sha384 (stdrng) passed 2021-12-17T01:02:01.252270+0100 localhost.localdomain \
kernel: alg: self-tests for drbg_pr_sha512 (stdrng) passed \
2021-12-17T01:02:01.252276+0100 localhost.localdomain kernel: alg: self-tests for \
drbg_pr_sha256 (stdrng) passed 2021-12-17T01:02:01.252281+0100 localhost.localdomain \
kernel: alg: self-tests for drbg_pr_hmac_sha1 (stdrng) passed \
2021-12-17T01:02:01.252287+0100 localhost.localdomain kernel: alg: self-tests for \
drbg_pr_hmac_sha384 (stdrng) passed 2021-12-17T01:02:01.252294+0100 \
localhost.localdomain kernel: alg: self-tests for hmac(sha256-avx2) (hmac(sha256)) \
passed 2021-12-17T01:02:01.252299+0100 localhost.localdomain kernel: alg: self-tests \
for drbg_pr_hmac_sha256 (stdrng) passed 2021-12-17T01:02:01.252305+0100 \
localhost.localdomain kernel: alg: self-tests for drbg_pr_hmac_sha512 (stdrng) passed \
2021-12-17T01:02:01.252310+0100 localhost.localdomain kernel: alg: self-tests for \
drbg_nopr_ctr_aes128 (stdrng) passed 2021-12-17T01:02:01.252324+0100 \
localhost.localdomain kernel: alg: self-tests for drbg_nopr_ctr_aes192 (stdrng) \
passed 2021-12-17T01:02:01.252330+0100 localhost.localdomain kernel: alg: self-tests \
for drbg_nopr_ctr_aes256 (stdrng) passed 2021-12-17T01:02:01.252335+0100 \
localhost.localdomain kernel: alg: self-tests for drbg_nopr_sha1 (stdrng) passed \
2021-12-17T01:02:01.252340+0100 localhost.localdomain kernel: alg: self-tests for \
drbg_nopr_sha384 (stdrng) passed 2021-12-17T01:02:01.252346+0100 \
localhost.localdomain kernel: alg: self-tests for drbg_nopr_sha512 (stdrng) passed \
2021-12-17T01:02:01.252353+0100 localhost.localdomain kernel: alg: self-tests for \
drbg_nopr_sha256 (stdrng) passed 2021-12-17T01:02:01.252359+0100 \
localhost.localdomain kernel: alg: self-tests for drbg_nopr_hmac_sha1 (stdrng) passed \
2021-12-17T01:02:01.252365+0100 localhost.localdomain kernel: alg: self-tests for \
drbg_nopr_hmac_sha384 (stdrng) passed 2021-12-17T01:02:01.252370+0100 \
localhost.localdomain kernel: alg: self-tests for drbg_nopr_hmac_sha256 (stdrng) \
passed 2021-12-17T01:02:01.252375+0100 localhost.localdomain kernel: alg: self-tests \
for hmac(sha512-avx2) (hmac(sha512)) passed 2021-12-17T01:02:01.252380+0100 \
localhost.localdomain kernel: alg: self-tests for drbg_nopr_hmac_sha512 (stdrng) \
passed 2021-12-17T01:02:01.252385+0100 localhost.localdomain kernel: alg: self-tests \
for jitterentropy_rng (jitterentropy_rng) passed 2021-12-17T01:02:01.252391+0100 \
localhost.localdomain kernel: alg: self-tests for ghash-generic (ghash) passed \
2021-12-17T01:02:01.252396+0100 localhost.localdomain kernel: NET: Registered \
protocol family 38 2021-12-17T01:02:01.252404+0100 localhost.localdomain kernel: Key \
type asymmetric registered 2021-12-17T01:02:01.252409+0100 localhost.localdomain \
kernel: Asymmetric key parser 'x509' registered 2021-12-17T01:02:01.252414+0100 \
localhost.localdomain kernel: Block layer SCSI generic (bsg) driver version 0.4 \
loaded (major 247) 2021-12-17T01:02:01.252420+0100 localhost.localdomain kernel: io \
scheduler mq-deadline registered 2021-12-17T01:02:01.252425+0100 \
localhost.localdomain kernel: io scheduler kyber registered \
2021-12-17T01:02:01.252430+0100 localhost.localdomain kernel: io scheduler bfq \
registered 2021-12-17T01:02:01.252436+0100 localhost.localdomain kernel: \
atomic64_test: passed for x86-64 platform with CX8 and with SSE \
2021-12-17T01:02:01.252441+0100 localhost.localdomain kernel: PCI Interrupt Link \
[GSIF] enabled at IRQ 21 2021-12-17T01:02:01.252525+0100 localhost.localdomain \
kernel: pcieport 0000:00:01.0: Signaling with IRQ 24 2021-12-17T01:02:01.252603+0100 \
localhost.localdomain kernel: pcieport 0000:00:01.0: enabled with IRQ 24 \
2021-12-17T01:02:01.252760+0100 localhost.localdomain kernel: pcieport 0000:00:01.1: \
Signaling with IRQ 25 2021-12-17T01:02:01.252835+0100 localhost.localdomain kernel: \
pcieport 0000:00:01.1: enabled with IRQ 25 2021-12-17T01:02:01.252910+0100 \
localhost.localdomain kernel: pcieport 0000:00:01.1: Slot #0 AttnBtn+ PwrCtrl+ MRL- \
AttnInd+ PwrInd+ HotPlug+ Surprise+ Interlock+ NoCompl- IbPresDis- LLActRep+ \
2021-12-17T01:02:01.252985+0100 localhost.localdomain kernel: pcieport 0000:00:01.2: \
Signaling with IRQ 26 2021-12-17T01:02:01.253059+0100 localhost.localdomain kernel: \
pcieport 0000:00:01.2: enabled with IRQ 26 2021-12-17T01:02:01.253136+0100 \
localhost.localdomain kernel: pcieport 0000:00:01.2: Slot #0 AttnBtn+ PwrCtrl+ MRL- \
AttnInd+ PwrInd+ HotPlug+ Surprise+ Interlock+ NoCompl- IbPresDis- LLActRep+ \
2021-12-17T01:02:01.253222+0100 localhost.localdomain kernel: pcieport 0000:00:01.3: \
Signaling with IRQ 27 2021-12-17T01:02:01.253297+0100 localhost.localdomain kernel: \
pcieport 0000:00:01.3: enabled with IRQ 27 2021-12-17T01:02:01.253380+0100 \
localhost.localdomain kernel: pcieport 0000:00:01.3: Slot #0 AttnBtn+ PwrCtrl+ MRL- \
AttnInd+ PwrInd+ HotPlug+ Surprise+ Interlock+ NoCompl- IbPresDis- LLActRep+ \
2021-12-17T01:02:01.253457+0100 localhost.localdomain kernel: pcieport 0000:00:01.4: \
Signaling with IRQ 28 2021-12-17T01:02:01.253531+0100 localhost.localdomain kernel: \
pcieport 0000:00:01.4: enabled with IRQ 28 2021-12-17T01:02:01.253609+0100 \
localhost.localdomain kernel: pcieport 0000:00:01.4: Slot #0 AttnBtn+ PwrCtrl+ MRL- \
AttnInd+ PwrInd+ HotPlug+ Surprise+ Interlock+ NoCompl- IbPresDis- LLActRep+ \
2021-12-17T01:02:01.253685+0100 localhost.localdomain kernel: pcieport 0000:00:01.5: \
Signaling with IRQ 29 2021-12-17T01:02:01.253760+0100 localhost.localdomain kernel: \
pcieport 0000:00:01.5: enabled with IRQ 29 2021-12-17T01:02:01.253833+0100 \
localhost.localdomain kernel: pcieport 0000:00:01.5: Slot #0 AttnBtn+ PwrCtrl+ MRL- \
AttnInd+ PwrInd+ HotPlug+ Surprise+ Interlock+ NoCompl- IbPresDis- LLActRep+ \
2021-12-17T01:02:01.253908+0100 localhost.localdomain kernel: pcieport 0000:00:01.6: \
Signaling with IRQ 30 2021-12-17T01:02:01.253983+0100 localhost.localdomain kernel: \
pcieport 0000:00:01.6: enabled with IRQ 30 2021-12-17T01:02:01.254059+0100 \
localhost.localdomain kernel: pcieport 0000:00:01.6: Slot #0 AttnBtn+ PwrCtrl+ MRL- \
AttnInd+ PwrInd+ HotPlug+ Surprise+ Interlock+ NoCompl- IbPresDis- LLActRep+ \
2021-12-17T01:02:01.254134+0100 localhost.localdomain kernel: pcieport 0000:00:01.7: \
Signaling with IRQ 31 2021-12-17T01:02:01.254212+0100 localhost.localdomain kernel: \
pcieport 0000:00:01.7: enabled with IRQ 31 2021-12-17T01:02:01.254287+0100 \
localhost.localdomain kernel: pcieport 0000:00:01.7: Slot #0 AttnBtn+ PwrCtrl+ MRL- \
AttnInd+ PwrInd+ HotPlug+ Surprise+ Interlock+ NoCompl- IbPresDis- LLActRep+ \
2021-12-17T01:02:01.254368+0100 localhost.localdomain kernel: pcieport 0000:00:01.7: \
Slot(0-7): Link Up 2021-12-17T01:02:01.254375+0100 localhost.localdomain kernel: \
shpchp: Standard Hot Plug PCI Controller Driver version: 0.4 \
2021-12-17T01:02:01.254381+0100 localhost.localdomain kernel: input: Power Button as \
/devices/LNXSYSTM:00/LNXPWRBN:00/input/input0 2021-12-17T01:02:01.254390+0100 \
localhost.localdomain kernel: ACPI: Power Button [PWRF] \
2021-12-17T01:02:01.254395+0100 localhost.localdomain kernel: Serial: 8250/16550 \
driver, 4 ports, IRQ sharing enabled 2021-12-17T01:02:01.254400+0100 \
localhost.localdomain kernel: 00:03: ttyS0 at I/O 0x3f8 (irq = 4, base_baud = 115200) \
is a 16550A 2021-12-17T01:02:01.254406+0100 localhost.localdomain kernel: \
Non-volatile memory driver v1.3 2021-12-17T01:02:01.254411+0100 localhost.localdomain \
kernel: rdac: device handler registered 2021-12-17T01:02:01.254416+0100 \
localhost.localdomain kernel: hp_sw: device handler registered \
2021-12-17T01:02:01.254422+0100 localhost.localdomain kernel: emc: device handler \
registered 2021-12-17T01:02:01.254428+0100 localhost.localdomain kernel: alua: device \
handler registered 2021-12-17T01:02:01.254433+0100 localhost.localdomain kernel: \
libphy: Fixed MDIO Bus: probed 2021-12-17T01:02:01.254440+0100 localhost.localdomain \
kernel: ehci_hcd: USB 2.0 'Enhanced' Host Controller (EHCI) Driver \
2021-12-17T01:02:01.254446+0100 localhost.localdomain kernel: ehci-pci: EHCI PCI \
platform driver 2021-12-17T01:02:01.254451+0100 localhost.localdomain kernel: \
ohci_hcd: USB 1.1 'Open' Host Controller (OHCI) Driver \
2021-12-17T01:02:01.254456+0100 localhost.localdomain kernel: ohci-pci: OHCI PCI \
platform driver 2021-12-17T01:02:01.254462+0100 localhost.localdomain kernel: \
uhci_hcd: USB Universal Host Controller Interface driver \
2021-12-17T01:02:01.254468+0100 localhost.localdomain kernel: usbcore: registered new \
interface driver usbserial_generic 2021-12-17T01:02:01.254474+0100 \
localhost.localdomain kernel: usbserial: USB Serial support registered for generic \
2021-12-17T01:02:01.254479+0100 localhost.localdomain kernel: i8042: PNP: PS/2 \
Controller [PNP0303:KBD,PNP0f13:MOU] at 0x60,0x64 irq 1,12 \
2021-12-17T01:02:01.254485+0100 localhost.localdomain kernel: serio: i8042 KBD port \
at 0x60,0x64 irq 1 2021-12-17T01:02:01.254490+0100 localhost.localdomain kernel: \
serio: i8042 AUX port at 0x60,0x64 irq 12 2021-12-17T01:02:01.254497+0100 \
localhost.localdomain kernel: mousedev: PS/2 mouse device common for all mice \
2021-12-17T01:02:01.254503+0100 localhost.localdomain kernel: input: AT Translated \
Set 2 keyboard as /devices/platform/i8042/serio0/input/input1 \
2021-12-17T01:02:01.254509+0100 localhost.localdomain kernel: input: VirtualPS/2 \
VMware VMMouse as /devices/platform/i8042/serio1/input/input4 \
2021-12-17T01:02:01.254577+0100 localhost.localdomain kernel: rtc_cmos 00:00: RTC can \
wake from S4 2021-12-17T01:02:01.254585+0100 localhost.localdomain kernel: input: \
VirtualPS/2 VMware VMMouse as /devices/platform/i8042/serio1/input/input3 \
2021-12-17T01:02:01.254649+0100 localhost.localdomain kernel: rtc_cmos 00:00: \
registered as rtc0 2021-12-17T01:02:01.254713+0100 localhost.localdomain kernel: \
rtc_cmos 00:00: alarms up to one day, y3k, 114 bytes nvram \
2021-12-17T01:02:01.254720+0100 localhost.localdomain kernel: intel_pstate: CPU model \
not supported 2021-12-17T01:02:01.254728+0100 localhost.localdomain kernel: hid: raw \
HID events driver (C) Jiri Kosina 2021-12-17T01:02:01.254734+0100 \
localhost.localdomain kernel: usbcore: registered new interface driver usbhid \
2021-12-17T01:02:01.254739+0100 localhost.localdomain kernel: usbhid: USB HID core \
driver 2021-12-17T01:02:01.254745+0100 localhost.localdomain kernel: drop_monitor: \
Initializing network drop monitor service 2021-12-17T01:02:01.254750+0100 \
localhost.localdomain kernel: Initializing XFRM netlink socket \
2021-12-17T01:02:01.254756+0100 localhost.localdomain kernel: NET: Registered \
protocol family 10 2021-12-17T01:02:01.254761+0100 localhost.localdomain kernel: \
Segment Routing with IPv6 2021-12-17T01:02:01.254767+0100 localhost.localdomain \
kernel: NET: Registered protocol family 17 2021-12-17T01:02:01.254772+0100 \
localhost.localdomain kernel: mpls_gso: MPLS GSO support \
2021-12-17T01:02:01.254778+0100 localhost.localdomain kernel: AVX2 version of \
gcm_enc/dec engaged. 2021-12-17T01:02:01.254785+0100 localhost.localdomain kernel: \
AES CTR mode by8 optimization enabled 2021-12-17T01:02:01.254790+0100 \
localhost.localdomain kernel: alg: self-tests for aes-aesni (aes) passed \
2021-12-17T01:02:01.254796+0100 localhost.localdomain kernel: alg: self-tests for \
rfc4106-gcm-aesni (rfc4106(gcm(aes))) passed 2021-12-17T01:02:01.254802+0100 \
localhost.localdomain kernel: alg: self-tests for generic-gcm-aesni (gcm(aes)) passed \
2021-12-17T01:02:01.254808+0100 localhost.localdomain kernel: alg: self-tests for \
ecb-aes-aesni (ecb(aes)) passed 2021-12-17T01:02:01.254813+0100 localhost.localdomain \
kernel: alg: self-tests for cbc-aes-aesni (cbc(aes)) passed \
2021-12-17T01:02:01.254818+0100 localhost.localdomain kernel: alg: self-tests for \
ctr-aes-aesni (ctr(aes)) passed 2021-12-17T01:02:01.254823+0100 localhost.localdomain \
kernel: alg: self-tests for xts-aes-aesni (xts(aes)) passed \
2021-12-17T01:02:01.254828+0100 localhost.localdomain kernel: sched_clock: Marking \
stable (3257003172, 0)-&gt;(3598874502, -341871330) 2021-12-17T01:02:01.254836+0100 \
localhost.localdomain kernel: registered taskstats version 1 \
2021-12-17T01:02:01.254841+0100 localhost.localdomain kernel: Loading compiled-in \
X.509 certificates 2021-12-17T01:02:01.254848+0100 localhost.localdomain kernel: alg: \
self-tests for pkcs1pad(rsa-generic,sha256) (pkcs1pad(rsa,sha256)) passed \
2021-12-17T01:02:01.254853+0100 localhost.localdomain kernel: Loaded X.509 cert \
'CentOS kernel signing key: c979c57c4286b944add2f2b4bddf18fc84a3647f' \
2021-12-17T01:02:01.254859+0100 localhost.localdomain kernel: Loaded X.509 cert \
'CentOS Linux Driver update signing key: 7f421ee0ab69461574bb358861dbe77762a4201b' \
2021-12-17T01:02:01.254864+0100 localhost.localdomain kernel: Loaded X.509 cert \
'CentOS Linux kpatch signing key: ea0413152cde1d98ebdca3fe6f0230904c9ef717' \
2021-12-17T01:02:01.254870+0100 localhost.localdomain kernel: zswap: loaded using \
pool lzo/zbud 2021-12-17T01:02:01.254875+0100 localhost.localdomain kernel: \
page_owner is disabled 2021-12-17T01:02:01.254881+0100 localhost.localdomain kernel: \
alg: self-tests for ctr(aes-aesni) (ctr(aes)) passed 2021-12-17T01:02:01.254889+0100 \
localhost.localdomain kernel: alg: self-tests for \
gcm_base(ctr(aes-aesni),ghash-generic) (gcm(aes)) passed \
2021-12-17T01:02:01.254894+0100 localhost.localdomain kernel: Key type big_key \
registered 2021-12-17T01:02:01.254899+0100 localhost.localdomain kernel: alg: \
self-tests for cbc(aes-aesni) (cbc(aes)) passed 2021-12-17T01:02:01.254904+0100 \
localhost.localdomain kernel: Key type encrypted registered \
2021-12-17T01:02:01.254910+0100 localhost.localdomain kernel: ima: No TPM chip found, \
activating TPM-bypass! 2021-12-17T01:02:01.254915+0100 localhost.localdomain kernel: \
ima: Allocated hash algorithm: sha256 2021-12-17T01:02:01.254921+0100 \
localhost.localdomain kernel: ima: No architecture policies found \
2021-12-17T01:02:01.254926+0100 localhost.localdomain kernel: evm: Initialising EVM \
extended attributes: 2021-12-17T01:02:01.254932+0100 localhost.localdomain kernel: \
evm: security.selinux 2021-12-17T01:02:01.254939+0100 localhost.localdomain kernel: \
evm: security.ima 2021-12-17T01:02:01.254945+0100 localhost.localdomain kernel: evm: \
security.capability 2021-12-17T01:02:01.254950+0100 localhost.localdomain kernel: \
evm: HMAC attrs: 0x1 2021-12-17T01:02:01.255031+0100 localhost.localdomain kernel: \
rtc_cmos 00:00: setting system clock to 2021-12-17 00:02:00 UTC (1639699320) \
2021-12-17T01:02:01.255039+0100 localhost.localdomain kernel: Freeing unused \
decrypted memory: 2036K 2021-12-17T01:02:01.255045+0100 localhost.localdomain kernel: \
Freeing unused kernel memory: 2492K 2021-12-17T01:02:01.255050+0100 \
localhost.localdomain kernel: Write protecting the kernel read-only data: 22528k \
2021-12-17T01:02:01.255057+0100 localhost.localdomain kernel: Freeing unused kernel \
memory: 2012K 2021-12-17T01:02:01.255062+0100 localhost.localdomain kernel: Freeing \
unused kernel memory: 320K 2021-12-17T01:02:01.255071+0100 localhost.localdomain \
systemd[1]: systemd 239 (239-51.el8) running in system mode. (+PAM +AUDIT +SELINUX \
+IMA -APPARMOR +SMACK +SYSVINIT +UTMP +LIBCRYPTSETUP +GCRYPT +GNUTLS +ACL +XZ +LZ4 \
+SECCOMP +BLKID +ELFUTILS +KMOD +IDN2 -IDN +PCRE2 default-hierarchy=legacy) \
2021-12-17T01:02:01.255081+0100 localhost.localdomain systemd[1]: Detected \
virtualization kvm. 2021-12-17T01:02:01.255088+0100 localhost.localdomain systemd[1]: \
Detected architecture x86-64. 2021-12-17T01:02:01.255094+0100 localhost.localdomain \
systemd[1]: Running in initial RAM disk. 2021-12-17T01:02:01.255100+0100 \
localhost.localdomain systemd[1]: Set hostname to &lt;localhost.localdomain&gt;. \
2021-12-17T01:02:01.255180+0100 localhost.localdomain kernel: pcieport 0000:00:01.7: \
Slot(0-7): No device found 2021-12-17T01:02:01.255188+0100 localhost.localdomain \
systemd[1]: Listening on udev Kernel Socket. 2021-12-17T01:02:01.255202+0100 \
localhost.localdomain systemd[1]: Created slice \
system-systemd\x2dhibernate\x2dresume.slice. 2021-12-17T01:02:01.255211+0100 \
localhost.localdomain systemd[1]: Listening on Journal Socket (/dev/log). \
2021-12-17T01:02:01.255217+0100 localhost.localdomain systemd[1]: Listening on \
Journal Socket. 2021-12-17T01:02:01.255223+0100 localhost.localdomain systemd[1]: \
Started Memstrack Anylazing Service. 2021-12-17T01:02:01.255233+0100 \
localhost.localdomain systemd-journald[321]: Journal started \
2021-12-17T01:02:01.255282+0100 localhost.localdomain systemd-journald[321]: Runtime \
journal (/run/log/journal/ed30ef6d6cf744bbb09f5af56f57c3dd) is 8.0M, max 78.2M, 70.2M \
free. 2021-12-17T01:02:01.217725+0100 localhost.localdomain \
systemd-vconsole-setup[323]: /usr/bin/setfont failed with exit status 71. \
2021-12-17T01:02:01.255754+0100 localhost.localdomain systemd-vconsole-setup[323]: \
setfont: putfont: 512,8x16:  failed: -1 2021-12-17T01:02:01.255754+0100 \
localhost.localdomain systemd-vconsole-setup[323]: putfont: PIO_FONT: Invalid \
argument 2021-12-17T01:02:01.262174+0100 localhost.localdomain \
systemd-vconsole-setup[323]: Setting fonts failed with a "system error", ignoring. \
2021-12-17T01:02:01.262939+0100 localhost.localdomain systemd[1]: \
systemd-vconsole-setup.service: Succeeded. 2021-12-17T01:02:01.263143+0100 \
localhost.localdomain systemd[1]: Started Setup Virtual Console. \
2021-12-17T01:02:01.264475+0100 localhost.localdomain systemd[1]: Starting dracut \
cmdline hook... 2021-12-17T01:02:01.281309+0100 localhost.localdomain \
dracut-cmdline[348]: dracut-8 dracut-049-191.git20210920.el8 \
2021-12-17T01:02:01.283442+0100 localhost.localdomain dracut-cmdline[348]: Using \
kernel command line parameters: \
BOOT_IMAGE=(hd0,msdos1)/vmlinuz-4.18.0-348.2.1.el8_5.x86_64 \
root=UUID=215f27b1-6a5c-4125-a7af-a21ed88e255a ro consoleblank=0 net.ifnames=0 \
console=hvc0 crashkernel=auto boot=UUID=4e0b2bcf-357f-43dd-b4fc-7f5a1891842c \
resume=UUID=6ce1924f-1ce5-4245-a388-212ff15a384c fips=1 console=ttyS0,115200 \
2021-12-17T01:02:01.500739+0100 localhost.localdomain systemd[1]: Started dracut \
cmdline hook. 2021-12-17T01:02:01.502171+0100 localhost.localdomain systemd[1]: \
Starting dracut pre-udev hook... 2021-12-17T01:02:01.523464+0100 \
localhost.localdomain dracut-pre-udev[389]: Loading and integrity checking all crypto \
modules 2021-12-17T01:02:01.691442+0100 localhost.localdomain kernel: alg: self-tests \
for sha1_mb (sha1) passed 2021-12-17T01:02:01.886373+0100 localhost.localdomain \
kernel: alg: self-tests for sha256_mb (sha256) passed 2021-12-17T01:02:02.074377+0100 \
localhost.localdomain kernel: alg: self-tests for sha512_mb (sha512) passed \
2021-12-17T01:02:02.125358+0100 localhost.localdomain kernel: alg: self-tests for \
sha3-224-generic (sha3-224) passed 2021-12-17T01:02:02.146362+0100 \
localhost.localdomain kernel: alg: self-tests for sha3-256-generic (sha3-256) passed \
2021-12-17T01:02:02.167361+0100 localhost.localdomain kernel: alg: self-tests for \
sha3-384-generic (sha3-384) passed 2021-12-17T01:02:02.187363+0100 \
localhost.localdomain kernel: alg: self-tests for sha3-512-generic (sha3-512) passed \
2021-12-17T01:02:02.282359+0100 localhost.localdomain kernel: alg: self-tests for \
crc32c-intel (crc32c) passed 2021-12-17T01:02:02.322346+0100 localhost.localdomain \
kernel: alg: self-tests for crct10dif-pclmul (crct10dif) passed \
2021-12-17T01:02:02.481421+0100 localhost.localdomain kernel: alg: self-tests for \
ghash-clmulni (ghash) passed 2021-12-17T01:02:02.554364+0100 localhost.localdomain \
2021-12-17T01:02:02.598357+0100 localhost.localdomain kernel: alg: self-tests for \
ecb-des3_ede-asm (ecb(des3_ede)) passed 2021-12-17T01:02:02.619360+0100 \
localhost.localdomain kernel: alg: self-tests for cbc-des3_ede-asm (cbc(des3_ede)) \
passed 2021-12-17T01:02:02.640359+0100 localhost.localdomain kernel: alg: self-tests \
for ctr-des3_ede-asm (ctr(des3_ede)) passed 2021-12-17T01:02:02.698417+0100 \
localhost.localdomain dracut-pre-udev[389]: modprobe: ERROR: could not insert \
'padlock_aes': No such device 2021-12-17T01:02:02.859367+0100 localhost.localdomain \
kernel: alg: self-tests for dh-generic (dh) passed 2021-12-17T01:02:02.922339+0100 \
localhost.localdomain kernel: alg: self-tests for ecdh-generic (ecdh) passed \
2021-12-17T01:02:03.047337+0100 localhost.localdomain kernel: alg: No test for \
fips(ansi_cprng) (fips_ansi_cprng) 2021-12-17T01:02:03.088280+0100 \
localhost.localdomain dracut-pre-udev[389]: Self testing crypto algorithms \
2021-12-17T01:02:03.175390+0100 localhost.localdomain kernel: alg: self-tests for \
sha1 (sha1) passed 2021-12-17T01:02:03.178433+0100 localhost.localdomain kernel: alg: \
self-tests for ecb(des3_ede) (ecb(des3_ede)) passed 2021-12-17T01:02:03.181424+0100 \
localhost.localdomain kernel: alg: self-tests for cbc(des3_ede) (cbc(des3_ede)) \
passed 2021-12-17T01:02:03.181538+0100 localhost.localdomain kernel: alg: self-tests \
for ctr(des3_ede) (ctr(des3_ede)) passed 2021-12-17T01:02:03.233468+0100 \
localhost.localdomain kernel: alg: self-tests for sha256 (sha256) passed \
2021-12-17T01:02:03.233583+0100 localhost.localdomain kernel: alg: self-tests for \
ecb(aes) (ecb(aes)) passed 2021-12-17T01:02:03.237074+0100 localhost.localdomain \
kernel: alg: self-tests for cbc(aes) (cbc(aes)) passed \
2021-12-17T01:02:03.237168+0100 localhost.localdomain kernel: alg: self-tests for \
xts(aes) (xts(aes)) passed 2021-12-17T01:02:03.237199+0100 localhost.localdomain \
kernel: alg: self-tests for ctr(aes) (ctr(aes)) passed \
2021-12-17T01:02:03.283376+0100 localhost.localdomain kernel: alg: self-tests for \
rfc3686(ctr-aes-aesni) (rfc3686(ctr(aes))) passed 2021-12-17T01:02:03.313347+0100 \
localhost.localdomain kernel: alg: self-tests for rfc3686(ctr(aes)) \
(rfc3686(ctr(aes))) passed 2021-12-17T01:02:03.361353+0100 localhost.localdomain \
kernel: alg: self-tests for cfb(aes-aesni) (cfb(aes)) passed \
2021-12-17T01:02:03.391983+0100 localhost.localdomain kernel: alg: self-tests for \
cfb(aes) (cfb(aes)) passed 2021-12-17T01:02:03.392067+0100 localhost.localdomain \
kernel: alg: self-tests for sha384 (sha384) passed 2021-12-17T01:02:03.447764+0100 \
localhost.localdomain kernel: alg: self-tests for sha512 (sha512) passed \
2021-12-17T01:02:03.447890+0100 localhost.localdomain kernel: alg: self-tests for \
deflate (deflate) passed 2021-12-17T01:02:03.449721+0100 localhost.localdomain \
kernel: alg: self-tests for crc32c (crc32c) passed 2021-12-17T01:02:03.451542+0100 \
localhost.localdomain kernel: alg: self-tests for sha224 (sha224) passed \
2021-12-17T01:02:03.453595+0100 localhost.localdomain kernel: alg: self-tests for \
gcm(aes) (gcm(aes)) passed 2021-12-17T01:02:03.455139+0100 localhost.localdomain \
kernel: alg: self-tests for lzo (lzo) passed 2021-12-17T01:02:03.539355+0100 \
localhost.localdomain kernel: alg: self-tests for cbcmac(aes-aesni) (cbcmac(aes)) \
passed 2021-12-17T01:02:03.578348+0100 localhost.localdomain kernel: alg: self-tests \
for ccm_base(ctr-aes-aesni,cbcmac(aes-aesni)) (ccm(aes)) passed \
2021-12-17T01:02:03.608341+0100 localhost.localdomain kernel: alg: self-tests for \
ccm(aes) (ccm(aes)) passed 2021-12-17T01:02:03.649353+0100 localhost.localdomain \
kernel: alg: self-tests for cts(cbc-aes-aesni) (cts(cbc(aes))) passed \
2021-12-17T01:02:03.681829+0100 localhost.localdomain kernel: alg: self-tests for \
cts(cbc(aes)) (cts(cbc(aes))) passed 2021-12-17T01:02:03.682069+0100 \
localhost.localdomain kernel: alg: No test for zlib (zlib) \
2021-12-17T01:02:03.733353+0100 localhost.localdomain kernel: alg: self-tests for \
rfc4309(ccm_base(ctr-aes-aesni,cbcmac(aes-aesni))) (rfc4309(ccm(aes))) passed \
2021-12-17T01:02:03.764261+0100 localhost.localdomain kernel: alg: self-tests for \
rfc4309(ccm(aes)) (rfc4309(ccm(aes))) passed 2021-12-17T01:02:03.764373+0100 \
localhost.localdomain kernel: alg: self-tests for ghash (ghash) passed \
2021-12-17T01:02:03.767034+0100 localhost.localdomain kernel: alg: self-tests for \
crct10dif (crct10dif) passed 2021-12-17T01:02:03.767105+0100 localhost.localdomain \
kernel: alg: self-tests for sha3-224 (sha3-224) passed \
2021-12-17T01:02:03.768488+0100 localhost.localdomain kernel: alg: self-tests for \
sha3-256 (sha3-256) passed 2021-12-17T01:02:03.769874+0100 localhost.localdomain \
kernel: alg: self-tests for sha3-384 (sha3-384) passed \
2021-12-17T01:02:03.771286+0100 localhost.localdomain kernel: alg: self-tests for \
sha3-512 (sha3-512) passed 2021-12-17T01:02:03.813350+0100 localhost.localdomain \
kernel: alg: self-tests for hmac(sha1-avx2) (hmac(sha1)) passed \
2021-12-17T01:02:03.845132+0100 localhost.localdomain kernel: alg: self-tests for \
hmac(sha1) (hmac(sha1)) passed 2021-12-17T01:02:03.845231+0100 localhost.localdomain \
kernel: alg: self-tests for hmac(sha256) (hmac(sha256)) passed \
2021-12-17T01:02:03.892383+0100 localhost.localdomain kernel: alg: self-tests for \
hmac(sha384-avx2) (hmac(sha384)) passed 2021-12-17T01:02:03.927978+0100 \
localhost.localdomain kernel: alg: self-tests for hmac(sha384) (hmac(sha384)) passed \
2021-12-17T01:02:03.928090+0100 localhost.localdomain kernel: alg: self-tests for \
hmac(sha512) (hmac(sha512)) passed 2021-12-17T01:02:03.978405+0100 \
localhost.localdomain kernel: alg: self-tests for hmac(sha224-avx2) (hmac(sha224)) \
passed 2021-12-17T01:02:04.002338+0100 localhost.localdomain kernel: alg: self-tests \
for hmac(sha224) (hmac(sha224)) passed 2021-12-17T01:02:04.049406+0100 \
localhost.localdomain kernel: alg: self-tests for hmac(sha3-224-generic) \
(hmac(sha3-224)) passed 2021-12-17T01:02:04.081357+0100 localhost.localdomain kernel: \
alg: self-tests for hmac(sha3-224) (hmac(sha3-224)) passed \
2021-12-17T01:02:04.132357+0100 localhost.localdomain kernel: alg: self-tests for \
hmac(sha3-256-generic) (hmac(sha3-256)) passed 2021-12-17T01:02:04.162347+0100 \
localhost.localdomain kernel: alg: self-tests for hmac(sha3-256) (hmac(sha3-256)) \
passed 2021-12-17T01:02:04.207335+0100 localhost.localdomain kernel: alg: self-tests \
for hmac(sha3-384-generic) (hmac(sha3-384)) passed 2021-12-17T01:02:04.239349+0100 \
localhost.localdomain kernel: alg: self-tests for hmac(sha3-384) (hmac(sha3-384)) \
passed 2021-12-17T01:02:04.289351+0100 localhost.localdomain kernel: alg: self-tests \
for hmac(sha3-512-generic) (hmac(sha3-512)) passed 2021-12-17T01:02:04.322336+0100 \
localhost.localdomain kernel: alg: self-tests for hmac(sha3-512) (hmac(sha3-512)) \
passed 2021-12-17T01:02:04.322431+0100 localhost.localdomain kernel: alg: self-tests \
for rfc4106(gcm(aes)) (rfc4106(gcm(aes))) passed 2021-12-17T01:02:04.369353+0100 \
localhost.localdomain kernel: alg: self-tests for cmac(aes-aesni) (cmac(aes)) passed \
2021-12-17T01:02:04.401351+0100 localhost.localdomain kernel: alg: self-tests for \
cmac(aes) (cmac(aes)) passed 2021-12-17T01:02:04.450380+0100 localhost.localdomain \
kernel: alg: self-tests for cmac(des3_ede-asm) (cmac(des3_ede)) passed \
2021-12-17T01:02:04.483365+0100 localhost.localdomain kernel: alg: self-tests for \
cmac(des3_ede) (cmac(des3_ede)) passed 2021-12-17T01:02:04.534352+0100 \
localhost.localdomain kernel: alg: self-tests for \
authenc(hmac(sha1-avx2),cbc-aes-aesni) (authenc(hmac(sha1),cbc(aes))) passed \
2021-12-17T01:02:04.560343+0100 localhost.localdomain kernel: alg: self-tests for \
authenc(hmac(sha1),cbc(aes)) (authenc(hmac(sha1),cbc(aes))) passed \
2021-12-17T01:02:04.607378+0100 localhost.localdomain kernel: alg: self-tests for \
authenc(hmac(sha1-avx2),cbc-des3_ede-asm) (authenc(hmac(sha1),cbc(des3_ede))) passed \
2021-12-17T01:02:04.636366+0100 localhost.localdomain kernel: alg: self-tests for \
authenc(hmac(sha1),cbc(des3_ede)) (authenc(hmac(sha1),cbc(des3_ede))) passed \
2021-12-17T01:02:04.687382+0100 localhost.localdomain kernel: alg: self-tests for \
authenc(hmac(sha224-avx2),cbc-des3_ede-asm) (authenc(hmac(sha224),cbc(des3_ede))) \
passed 2021-12-17T01:02:04.721536+0100 localhost.localdomain kernel: alg: self-tests \
for authenc(hmac(sha224),cbc(des3_ede)) (authenc(hmac(sha224),cbc(des3_ede))) passed \
2021-12-17T01:02:04.772354+0100 localhost.localdomain kernel: alg: self-tests for \
authenc(hmac(sha256-avx2),cbc-des3_ede-asm) (authenc(hmac(sha256),cbc(des3_ede))) \
passed 2021-12-17T01:02:04.801346+0100 localhost.localdomain kernel: alg: self-tests \
for authenc(hmac(sha256),cbc(des3_ede)) (authenc(hmac(sha256),cbc(des3_ede))) passed \
2021-12-17T01:02:04.847341+0100 localhost.localdomain kernel: alg: self-tests for \
authenc(hmac(sha384-avx2),cbc-des3_ede-asm) (authenc(hmac(sha384),cbc(des3_ede))) \
passed 2021-12-17T01:02:04.879348+0100 localhost.localdomain kernel: alg: self-tests \
for authenc(hmac(sha384),cbc(des3_ede)) (authenc(hmac(sha384),cbc(des3_ede))) passed \
2021-12-17T01:02:04.928368+0100 localhost.localdomain kernel: alg: self-tests for \
authenc(hmac(sha512-avx2),cbc-des3_ede-asm) (authenc(hmac(sha512),cbc(des3_ede))) \
passed 2021-12-17T01:02:04.959350+0100 localhost.localdomain kernel: alg: self-tests \
for authenc(hmac(sha512),cbc(des3_ede)) (authenc(hmac(sha512),cbc(des3_ede))) passed \
2021-12-17T01:02:05.019359+0100 localhost.localdomain systemd[1]: Started dracut \
pre-udev hook. 2021-12-17T01:02:05.021261+0100 localhost.localdomain systemd[1]: \
Starting udev Kernel Device Manager... 2021-12-17T01:02:05.121657+0100 \
localhost.localdomain systemd-udevd[610]: Network interface NamePolicy= disabled on \
kernel command line, ignoring. 2021-12-17T01:02:05.123487+0100 localhost.localdomain \
systemd[1]: Started udev Kernel Device Manager. 2021-12-17T01:02:05.125070+0100 \
localhost.localdomain systemd[1]: Starting dracut pre-trigger hook... \
2021-12-17T01:02:05.282845+0100 localhost.localdomain kernel: virtio_blk virtio5: \
[vda] 46137344 512-byte logical blocks (23.6 GB/22.0 GiB) \
2021-12-17T01:02:05.283030+0100 localhost.localdomain kernel: vda: detected capacity \
change from 0 to 23622320128 2021-12-17T01:02:05.303333+0100 localhost.localdomain \
kernel:  vda: vda1 vda2 vda3 vda4 &lt; vda5 vda6 vda7 vda8 vda9 vda10 &gt; \
2021-12-17T01:02:05.328486+0100 localhost.localdomain systemd-udevd[640]: \
link_config: autonegotiation is unset or enabled, the speed and duplex are not \
writable. 2021-12-17T01:02:05.337394+0100 localhost.localdomain kernel: libata \
version 3.00 loaded. 2021-12-17T01:02:05.372515+0100 localhost.localdomain kernel: \
ahci 0000:00:1f.2: version 3.0 2021-12-17T01:02:05.372686+0100 localhost.localdomain \
kernel: PCI Interrupt Link [GSIA] enabled at IRQ 16 2021-12-17T01:02:05.379330+0100 \
localhost.localdomain kernel: ahci 0000:00:1f.2: AHCI 0001.0000 32 slots 6 ports 1.5 \
Gbps 0x3f impl SATA mode 2021-12-17T01:02:05.379489+0100 localhost.localdomain \
kernel: ahci 0000:00:1f.2: flags: 64bit ncq only  2021-12-17T01:02:05.385963+0100 \
localhost.localdomain systemd-udevd[630]: Using default interface naming scheme \
'rhel-8.0'. 2021-12-17T01:02:05.386467+0100 localhost.localdomain systemd-udevd[630]: \
link_config: autonegotiation is unset or enabled, the speed and duplex are not \
writable. 2021-12-17T01:02:05.386648+0100 localhost.localdomain systemd-udevd[633]: \
Using default interface naming scheme 'rhel-8.0'. 2021-12-17T01:02:05.387085+0100 \
localhost.localdomain systemd-udevd[633]: link_config: autonegotiation is unset or \
enabled, the speed and duplex are not writable. 2021-12-17T01:02:05.387869+0100 \
localhost.localdomain systemd-udevd[639]: Using default interface naming scheme \
'rhel-8.0'. 2021-12-17T01:02:05.388298+0100 localhost.localdomain systemd-udevd[639]: \
link_config: autonegotiation is unset or enabled, the speed and duplex are not \
writable. 2021-12-17T01:02:05.389805+0100 localhost.localdomain systemd-udevd[636]: \
Using default interface naming scheme 'rhel-8.0'. 2021-12-17T01:02:05.390421+0100 \
localhost.localdomain systemd-udevd[636]: link_config: autonegotiation is unset or \
enabled, the speed and duplex are not writable. 2021-12-17T01:02:05.398870+0100 \
localhost.localdomain systemd[1]: Found device \
/dev/disk/by-uuid/6ce1924f-1ce5-4245-a388-212ff15a384c. \
2021-12-17T01:02:05.419329+0100 localhost.localdomain kernel: scsi host0: ahci \
2021-12-17T01:02:05.428722+0100 localhost.localdomain systemd[1]: Found device \
/dev/disk/by-uuid/215f27b1-6a5c-4125-a7af-a21ed88e255a. \
2021-12-17T01:02:05.441650+0100 localhost.localdomain systemd[1]: Reached target \
Initrd Root Device. 2021-12-17T01:02:05.443327+0100 localhost.localdomain kernel: \
scsi host1: ahci 2021-12-17T01:02:05.443350+0100 localhost.localdomain systemd[1]: \
Starting Resume from hibernation using device \
/dev/disk/by-uuid/6ce1924f-1ce5-4245-a388-212ff15a384c... \
2021-12-17T01:02:05.491333+0100 localhost.localdomain kernel: scsi host2: ahci \
2021-12-17T01:02:05.518329+0100 localhost.localdomain kernel: scsi host3: ahci \
2021-12-17T01:02:05.535330+0100 localhost.localdomain kernel: scsi host4: ahci \
2021-12-17T01:02:05.552325+0100 localhost.localdomain kernel: scsi host5: ahci \
2021-12-17T01:02:05.552458+0100 localhost.localdomain kernel: ata1: SATA max UDMA/133 \
abar m4096@0xfda08000 port 0xfda08100 irq 56 2021-12-17T01:02:05.552474+0100 \
localhost.localdomain kernel: ata2: SATA max UDMA/133 abar m4096@0xfda08000 port \
0xfda08180 irq 56 2021-12-17T01:02:05.552482+0100 localhost.localdomain kernel: ata3: \
SATA max UDMA/133 abar m4096@0xfda08000 port 0xfda08200 irq 56 \
2021-12-17T01:02:05.552489+0100 localhost.localdomain kernel: ata4: SATA max UDMA/133 \
abar m4096@0xfda08000 port 0xfda08280 irq 56 2021-12-17T01:02:05.552497+0100 \
localhost.localdomain kernel: ata5: SATA max UDMA/133 abar m4096@0xfda08000 port \
0xfda08300 irq 56 2021-12-17T01:02:05.552504+0100 localhost.localdomain kernel: ata6: \
SATA max UDMA/133 abar m4096@0xfda08000 port 0xfda08380 irq 56 \
2021-12-17T01:02:05.611002+0100 localhost.localdomain dracut-pre-trigger[611]: \
Mounting /dev/disk/by-uuid/4e0b2bcf-357f-43dd-b4fc-7f5a1891842c as /boot \
2021-12-17T01:02:05.722827+0100 localhost.localdomain kernel: PM: Image not found \
(code -22) 2021-12-17T01:02:05.717955+0100 localhost.localdomain \
systemd-hibernate-resume[656]: Could not resume from \
'/dev/disk/by-uuid/6ce1924f-1ce5-4245-a388-212ff15a384c' (253:3). \
2021-12-17T01:02:05.718799+0100 localhost.localdomain systemd[1]: \
systemd-hibernate-resume@dev-disk-by\x2duuid-6ce1924f\x2d1ce5\x2d4245\x2da388\x2d212ff15a384c.service: \
Succeeded. 2021-12-17T01:02:05.719031+0100 localhost.localdomain systemd[1]: Started \
Resume from hibernation using device \
/dev/disk/by-uuid/6ce1924f-1ce5-4245-a388-212ff15a384c. \
2021-12-17T01:02:05.719993+0100 localhost.localdomain systemd[1]: Reached target \
Local File Systems (Pre). 2021-12-17T01:02:05.720638+0100 localhost.localdomain \
systemd[1]: Reached target Local File Systems. 2021-12-17T01:02:05.721941+0100 \
localhost.localdomain systemd[1]: Starting Create Volatile Files and Directories... \
2021-12-17T01:02:05.744359+0100 localhost.localdomain kernel: SGI XFS with ACLs, \
security attributes, quota, no debug enabled 2021-12-17T01:02:05.793478+0100 \
localhost.localdomain kernel: XFS (vda1): Mounting V5 Filesystem \
2021-12-17T01:02:05.856513+0100 localhost.localdomain systemd[1]: Started Create \
Volatile Files and Directories. 2021-12-17T01:02:05.862336+0100 localhost.localdomain \
kernel: ata1: SATA link down (SStatus 0 SControl 300) 2021-12-17T01:02:05.878330+0100 \
localhost.localdomain kernel: ata3: SATA link down (SStatus 0 SControl 300) \
2021-12-17T01:02:05.878398+0100 localhost.localdomain kernel: ata2: SATA link down \
(SStatus 0 SControl 300) 2021-12-17T01:02:05.886330+0100 localhost.localdomain \
2021-12-17T01:02:05.902671+0100 localhost.localdomain kernel: ata6: SATA link down \
(SStatus 0 SControl 300) 2021-12-17T01:02:05.933336+0100 localhost.localdomain \
kernel: XFS (vda1): Ending clean mount 2021-12-17T01:02:05.939066+0100 \
localhost.localdomain dracut-pre-trigger[611]: Checking integrity of kernel \
2021-12-17T01:02:05.974509+0100 localhost.localdomain dracut-pre-trigger[611]: \
/boot/vmlinuz-4.18.0-348.2.1.el8_5.x86_64: OK 2021-12-17T01:02:05.975114+0100 \
localhost.localdomain dracut-pre-trigger[611]: All initrd crypto checks done \
2021-12-17T01:02:05.976531+0100 localhost.localdomain systemd[1]: boot.mount: \
Succeeded. 2021-12-17T01:02:05.980746+0100 localhost.localdomain kernel: XFS (vda1): \
Unmounting Filesystem 2021-12-17T01:02:06.064404+0100 localhost.localdomain \
systemd[1]: Started dracut pre-trigger hook. 2021-12-17T01:02:06.067963+0100 \
localhost.localdomain systemd[1]: Starting udev Coldplug all Devices... \
2021-12-17T01:02:06.147840+0100 localhost.localdomain systemd-udevd[610]: Network \
interface NamePolicy= disabled on kernel command line, ignoring. \
2021-12-17T01:02:06.181762+0100 localhost.localdomain systemd[1]: Mounting Kernel \
Configuration File System... 2021-12-17T01:02:06.184995+0100 localhost.localdomain \
systemd[1]: Mounted Kernel Configuration File System. 2021-12-17T01:02:06.309278+0100 \
localhost.localdomain systemd[1]: Started udev Coldplug all Devices. \
2021-12-17T01:02:06.311327+0100 localhost.localdomain systemd[1]: Starting dracut \
initqueue hook... 2021-12-17T01:02:06.312385+0100 localhost.localdomain systemd[1]: \
Reached target System Initialization. 2021-12-17T01:02:06.313711+0100 \
localhost.localdomain systemd[1]: Reached target Basic System. \
2021-12-17T01:02:06.338532+0100 localhost.localdomain systemd-udevd[729]: Using \
default interface naming scheme 'rhel-8.0'. 2021-12-17T01:02:06.338977+0100 \
localhost.localdomain systemd-udevd[729]: link_config: autonegotiation is unset or \
enabled, the speed and duplex are not writable. 2021-12-17T01:02:06.339057+0100 \
localhost.localdomain systemd-udevd[729]: Could not set AlternativeName= or apply \
AlternativeNamesPolicy= on eth1: File exists 2021-12-17T01:02:06.339064+0100 \
localhost.localdomain systemd-udevd[729]: Could not apply link config to eth1, \
ignoring: File exists 2021-12-17T01:02:06.339825+0100 localhost.localdomain \
systemd-udevd[726]: Using default interface naming scheme 'rhel-8.0'. \
2021-12-17T01:02:06.340590+0100 localhost.localdomain systemd-udevd[726]: \
link_config: autonegotiation is unset or enabled, the speed and duplex are not \
writable. 2021-12-17T01:02:06.340990+0100 localhost.localdomain systemd-udevd[726]: \
Could not set AlternativeName= or apply AlternativeNamesPolicy= on eth0: File exists \
2021-12-17T01:02:06.341034+0100 localhost.localdomain systemd-udevd[726]: Could not \
apply link config to eth0, ignoring: File exists 2021-12-17T01:02:06.341787+0100 \
localhost.localdomain systemd-udevd[730]: Using default interface naming scheme \
'rhel-8.0'. 2021-12-17T01:02:06.341882+0100 localhost.localdomain systemd-udevd[731]: \
Using default interface naming scheme 'rhel-8.0'. 2021-12-17T01:02:06.342325+0100 \
localhost.localdomain systemd-udevd[731]: link_config: autonegotiation is unset or \
enabled, the speed and duplex are not writable. 2021-12-17T01:02:06.342577+0100 \
localhost.localdomain systemd-udevd[731]: Could not set AlternativeName= or apply \
AlternativeNamesPolicy= on eth3: File exists 2021-12-17T01:02:06.342586+0100 \
localhost.localdomain systemd-udevd[731]: Could not apply link config to eth3, \
ignoring: File exists 2021-12-17T01:02:06.342649+0100 localhost.localdomain \
systemd-udevd[730]: link_config: autonegotiation is unset or enabled, the speed and \
duplex are not writable. 2021-12-17T01:02:06.342752+0100 localhost.localdomain \
systemd-udevd[730]: Could not set AlternativeName= or apply AlternativeNamesPolicy= \
on eth2: File exists 2021-12-17T01:02:06.342784+0100 localhost.localdomain \
systemd-udevd[730]: Could not apply link config to eth2, ignoring: File exists \
2021-12-17T01:02:06.387012+0100 localhost.localdomain systemd-udevd[732]: \
link_config: autonegotiation is unset or enabled, the speed and duplex are not \
writable. 2021-12-17T01:02:06.416096+0100 localhost.localdomain systemd[1]: Started \
dracut initqueue hook. 2021-12-17T01:02:06.416634+0100 localhost.localdomain \
systemd[1]: Reached target Remote File Systems (Pre). 2021-12-17T01:02:06.417030+0100 \
localhost.localdomain systemd[1]: Reached target Remote File Systems. \
2021-12-17T01:02:06.417997+0100 localhost.localdomain systemd[1]: Starting File \
System Check on /dev/disk/by-uuid/215f27b1-6a5c-4125-a7af-a21ed88e255a... \
2021-12-17T01:02:06.684140+0100 localhost.localdomain systemd-fsck[749]: \
/usr/sbin/fsck.xfs: XFS file system. 2021-12-17T01:02:06.685679+0100 \
localhost.localdomain systemd[1]: Started File System Check on \
/dev/disk/by-uuid/215f27b1-6a5c-4125-a7af-a21ed88e255a. \
2021-12-17T01:02:06.687084+0100 localhost.localdomain systemd[1]: Mounting \
/sysroot... 2021-12-17T01:02:06.738331+0100 localhost.localdomain kernel: XFS \
(vda10): Mounting V5 Filesystem 2021-12-17T01:02:06.758340+0100 localhost.localdomain \
kernel: XFS (vda10): Ending clean mount 2021-12-17T01:02:06.763306+0100 \
localhost.localdomain systemd[1]: Mounted /sysroot. 2021-12-17T01:02:06.763850+0100 \
localhost.localdomain systemd[1]: Reached target Initrd Root File System. \
2021-12-17T01:02:06.765021+0100 localhost.localdomain systemd[1]: Starting Reload \
Configuration from the Real Root... 2021-12-17T01:02:06.842141+0100 \
localhost.localdomain systemd[1]: Reloading. 2021-12-17T01:02:07.337088+0100 \
localhost.localdomain systemd[1]: initrd-parse-etc.service: Succeeded. \
2021-12-17T01:02:07.337356+0100 localhost.localdomain systemd[1]: Started Reload \
Configuration from the Real Root. 2021-12-17T01:02:07.338040+0100 \
localhost.localdomain systemd[1]: Reached target Initrd File Systems. \
2021-12-17T01:02:07.338450+0100 localhost.localdomain systemd[1]: Reached target \
Initrd Default Target. 2021-12-17T01:02:07.339634+0100 localhost.localdomain \
systemd[1]: Starting dracut pre-pivot and cleanup hook... \
2021-12-17T01:02:07.498402+0100 localhost.localdomain systemd[1]: Started dracut \
pre-pivot and cleanup hook. 2021-12-17T01:02:07.500030+0100 localhost.localdomain \
systemd[1]: Starting Cleaning Up and Shutting Down Daemons... \
2021-12-17T01:02:07.583487+0100 localhost.localdomain systemd[1]: \
dracut-pre-pivot.service: Succeeded. 2021-12-17T01:02:07.583719+0100 \
localhost.localdomain systemd[1]: Stopped dracut pre-pivot and cleanup hook. \
2021-12-17T01:02:07.584270+0100 localhost.localdomain systemd[1]: Stopped target \
Remote File Systems. 2021-12-17T01:02:07.584662+0100 localhost.localdomain \
systemd[1]: Stopped target Initrd Default Target. 2021-12-17T01:02:07.585086+0100 \
localhost.localdomain systemd[1]: Stopped target Initrd Root Device. \
2021-12-17T01:02:07.585467+0100 localhost.localdomain systemd[1]: Stopped target \
Remote File Systems (Pre). 2021-12-17T01:02:07.585920+0100 localhost.localdomain \
systemd[1]: dracut-initqueue.service: Succeeded. 2021-12-17T01:02:07.586147+0100 \
localhost.localdomain systemd[1]: Stopped dracut initqueue hook. \
2021-12-17T01:02:07.586578+0100 localhost.localdomain systemd[1]: Stopped target \
Timers. 2021-12-17T01:02:07.586883+0100 localhost.localdomain systemd[1]: Stopped \
target Basic System. 2021-12-17T01:02:07.587248+0100 localhost.localdomain \
systemd[1]: Stopped target Paths. 2021-12-17T01:02:07.587544+0100 \
localhost.localdomain systemd[1]: systemd-ask-password-console.path: Succeeded. \
2021-12-17T01:02:07.591348+0100 localhost.localdomain systemd[1]: Stopped Dispatch \
Password Requests to Console Directory Watch. 2021-12-17T01:02:07.591928+0100 \
localhost.localdomain systemd[1]: Stopped target System Initialization. \
2021-12-17T01:02:07.592329+0100 localhost.localdomain systemd[1]: Stopped target \
Swap. 2021-12-17T01:02:07.592747+0100 localhost.localdomain systemd[1]: \
systemd-udev-trigger.service: Succeeded. 2021-12-17T01:02:07.592964+0100 \
localhost.localdomain systemd[1]: Stopped udev Coldplug all Devices. \
2021-12-17T01:02:07.593436+0100 localhost.localdomain systemd[1]: \
dracut-pre-trigger.service: Succeeded. 2021-12-17T01:02:07.593646+0100 \
localhost.localdomain systemd[1]: Stopped dracut pre-trigger hook. \
2021-12-17T01:02:07.594182+0100 localhost.localdomain systemd[1]: Stopping udev \
Kernel Device Manager... 2021-12-17T01:02:07.594634+0100 localhost.localdomain \
systemd[1]: systemd-tmpfiles-setup.service: Succeeded. \
2021-12-17T01:02:07.594836+0100 localhost.localdomain systemd[1]: Stopped Create \
Volatile Files and Directories. 2021-12-17T01:02:07.595296+0100 localhost.localdomain \
systemd[1]: Stopped target Local File Systems. 2021-12-17T01:02:07.596556+0100 \
localhost.localdomain systemd[1]: Stopped target Local File Systems (Pre). \
2021-12-17T01:02:07.597090+0100 localhost.localdomain systemd[1]: \
systemd-sysctl.service: Succeeded. 2021-12-17T01:02:07.597314+0100 \
localhost.localdomain systemd[1]: Stopped Apply Kernel Variables. \
2021-12-17T01:02:07.597724+0100 localhost.localdomain systemd[1]: Stopped target \
Slices. 2021-12-17T01:02:07.598030+0100 localhost.localdomain systemd[1]: Stopped \
target Sockets. 2021-12-17T01:02:07.600332+0100 localhost.localdomain systemd[1]: \
initrd-cleanup.service: Succeeded. 2021-12-17T01:02:07.600528+0100 \
localhost.localdomain systemd[1]: Started Cleaning Up and Shutting Down Daemons. \
2021-12-17T01:02:07.601538+0100 localhost.localdomain systemd[1]: \
systemd-udevd.service: Succeeded. 2021-12-17T01:02:07.601743+0100 \
localhost.localdomain systemd[1]: Stopped udev Kernel Device Manager. \
2021-12-17T01:02:07.602402+0100 localhost.localdomain systemd[1]: \
systemd-tmpfiles-setup-dev.service: Succeeded. 2021-12-17T01:02:07.602642+0100 \
localhost.localdomain systemd[1]: Stopped Create Static Device Nodes in /dev. \
2021-12-17T01:02:07.603233+0100 localhost.localdomain systemd[1]: \
kmod-static-nodes.service: Succeeded. 2021-12-17T01:02:07.604024+0100 \
localhost.localdomain systemd[1]: Stopped Create list of required static device nodes \
for the current kernel. 2021-12-17T01:02:07.604743+0100 localhost.localdomain \
systemd[1]: dracut-pre-udev.service: Succeeded. 2021-12-17T01:02:07.604952+0100 \
localhost.localdomain systemd[1]: Stopped dracut pre-udev hook. \
2021-12-17T01:02:07.605418+0100 localhost.localdomain systemd[1]: \
dracut-cmdline.service: Succeeded. 2021-12-17T01:02:07.605623+0100 \
localhost.localdomain systemd[1]: Stopped dracut cmdline hook. \
2021-12-17T01:02:07.606033+0100 localhost.localdomain systemd[1]: \
systemd-udevd-kernel.socket: Succeeded. 2021-12-17T01:02:07.606251+0100 \
localhost.localdomain systemd[1]: Closed udev Kernel Socket. \
2021-12-17T01:02:07.606646+0100 localhost.localdomain systemd[1]: \
systemd-udevd-control.socket: Succeeded. 2021-12-17T01:02:07.606857+0100 \
localhost.localdomain systemd[1]: Closed udev Control Socket. \
2021-12-17T01:02:07.607906+0100 localhost.localdomain systemd[1]: Starting Cleanup \
udevd DB... 2021-12-17T01:02:07.734020+0100 localhost.localdomain systemd[1]: \
initrd-udevadm-cleanup-db.service: Succeeded. 2021-12-17T01:02:07.734262+0100 \
localhost.localdomain systemd[1]: Started Cleanup udevd DB. \
2021-12-17T01:02:07.734771+0100 localhost.localdomain systemd[1]: Reached target \
Switch Root. 2021-12-17T01:02:07.735796+0100 localhost.localdomain systemd[1]: \
Starting Switch Root... 2021-12-17T01:02:07.818597+0100 localhost.localdomain \
systemd[1]: Switching root. 2021-12-17T01:02:07.833956+0100 localhost.localdomain \
systemd-journald[321]: Journal stopped 2021-12-17T00:02:09.179260+0100 \
localhost.localdomain kernel: printk: systemd: 17 output lines suppressed due to \
ratelimiting 2021-12-17T00:02:09.179290+0100 localhost.localdomain kernel: audit: \
type=1404 audit(1639699327.944:2): enforcing=1 old_enforcing=0 auid=4294967295 \
ses=4294967295 enabled=1 old-enabled=1 lsm=selinux res=1 \
2021-12-17T00:02:09.179299+0100 localhost.localdomain kernel: SELinux:  policy \
capability network_peer_controls=1 2021-12-17T00:02:09.179306+0100 \
localhost.localdomain kernel: SELinux:  policy capability open_perms=1 \
2021-12-17T00:02:09.179313+0100 localhost.localdomain kernel: SELinux:  policy \
capability extended_socket_class=1 2021-12-17T00:02:09.180341+0100 \
localhost.localdomain kernel: SELinux:  policy capability always_check_network=0 \
2021-12-17T00:02:09.180353+0100 localhost.localdomain kernel: SELinux:  policy \
capability cgroup_seclabel=1 2021-12-17T00:02:09.180360+0100 localhost.localdomain \
kernel: SELinux:  policy capability nnp_nosuid_transition=1 \
2021-12-17T00:02:09.180367+0100 localhost.localdomain kernel: audit: type=1403 \
audit(1639699328.066:3): auid=4294967295 ses=4294967295 lsm=selinux res=1 \
2021-12-17T00:02:09.180375+0100 localhost.localdomain systemd[1]: Successfully loaded \
SELinux policy in 125.380ms. 2021-12-17T00:02:09.180385+0100 localhost.localdomain \
systemd[1]: RTC configured in localtime, applying delta of 60 minutes to system time. \
2021-12-17T00:02:09.180393+0100 localhost.localdomain systemd[1]: Relabelled /dev, \
/run and /sys/fs/cgroup in 16.947ms. 2021-12-17T00:02:09.180401+0100 \
localhost.localdomain systemd[1]: systemd 239 (239-51.el8) running in system mode. \
(+PAM +AUDIT +SELINUX +IMA -APPARMOR +SMACK +SYSVINIT +UTMP +LIBCRYPTSETUP +GCRYPT \
+GNUTLS +ACL +XZ +LZ4 +SECCOMP +BLKID +ELFUTILS +KMOD +IDN2 -IDN +PCRE2 \
default-hierarchy=legacy) 2021-12-17T00:02:09.180412+0100 localhost.localdomain \
systemd[1]: Detected virtualization kvm. 2021-12-17T00:02:09.180419+0100 \
localhost.localdomain systemd[1]: Detected architecture x86-64. \
2021-12-17T00:02:09.180427+0100 localhost.localdomain systemd[1]: Set hostname to \
&lt;localhost.localdomain&gt;. 2021-12-17T00:02:09.180435+0100 localhost.localdomain \
systemd[1]: systemd-journald.service: Succeeded. 2021-12-17T00:02:09.180443+0100 \
localhost.localdomain systemd[1]: initrd-switch-root.service: Succeeded. \
2021-12-17T00:02:09.180452+0100 localhost.localdomain systemd[1]: Stopped Switch \
Root. 2021-12-17T00:02:09.180461+0100 localhost.localdomain systemd[1]: \
systemd-journald.service: Service has no hold-off time (RestartSec=0), scheduling \
restart. 2021-12-17T00:02:09.180469+0100 localhost.localdomain systemd[1]: \
systemd-journald.service: Scheduled restart job, restart counter is at 1. \
2021-12-17T00:02:09.180476+0100 localhost.localdomain systemd[1]: Stopped Journal \
Service. 2021-12-17T00:02:09.180484+0100 localhost.localdomain kernel: Adding \
4194300k swap on /dev/vda3.  Priority:-2 extents:1 across:4194300k FS \
2021-12-17T00:02:09.180494+0100 localhost.localdomain systemd-journald[854]: Journal \
started 2021-12-17T00:02:09.180536+0100 localhost.localdomain systemd-journald[854]: \
Runtime journal (/run/log/journal/ed30ef6d6cf744bbb09f5af56f57c3dd) is 16.0M, max \
78.2M, 62.2M free. 2021-12-17T00:02:09.195043+0100 localhost.localdomain systemd[1]: \
Started Monitoring of LVM2 mirrors, snapshots etc. using dmeventd or progress \
polling. 2021-12-17T00:02:09.252346+0100 localhost.localdomain kernel: Ethernet \
Channel Bonding Driver: v3.7.1 (April 27, 2011) 2021-12-17T00:02:09.260395+0100 \
localhost.localdomain systemd-modules-load[861]: Inserted module 'bonding' \
2021-12-17T00:02:09.297332+0100 localhost.localdomain kernel: bridge: filtering via \
arp/ip/ip6tables is no longer available by default. Update your scripts to load \
br_netfilter if you need this. 2021-12-17T00:02:09.304344+0100 localhost.localdomain \
2021-12-17T00:02:09.319350+0100 localhost.localdomain systemd-modules-load[861]: \
Inserted module '8021q' 2021-12-17T00:02:09.327907+0100 localhost.localdomain \
systemd[1]: Started Load Kernel Modules. 2021-12-17T00:02:09.329395+0100 \
localhost.localdomain systemd[1]: Starting Apply Kernel Variables... \
2021-12-17T00:02:09.508782+0100 localhost.localdomain systemd[1]: Started Create \
System Users. 2021-12-17T00:02:09.512109+0100 localhost.localdomain systemd[1]: \
Starting Create Static Device Nodes in /dev... 2021-12-17T00:02:09.552514+0100 \
localhost.localdomain systemd[1]: Started udev Coldplug all Devices. \
2021-12-17T00:02:09.553926+0100 localhost.localdomain systemd[1]: Starting udev Wait \
for Complete Device Initialization... 2021-12-17T00:02:09.584130+0100 \
localhost.localdomain systemd[1]: Started Apply Kernel Variables. \
2021-12-17T00:02:09.786025+0100 localhost.localdomain systemd[1]: Started Create \
Static Device Nodes in /dev. 2021-12-17T00:02:09.962784+0100 localhost.localdomain \
systemd[1]: Started Rebuild Hardware Database. 2021-12-17T00:02:09.965796+0100 \
localhost.localdomain systemd[1]: Starting udev Kernel Device Manager... \
2021-12-17T00:02:10.078832+0100 localhost.localdomain systemd-udevd[887]: Network \
interface NamePolicy= disabled on kernel command line, ignoring. \
2021-12-17T00:02:10.095654+0100 localhost.localdomain systemd[1]: Started udev Kernel \
Device Manager. 2021-12-17T00:02:10.192340+0100 localhost.localdomain kernel: lpc_ich \
0000:00:1f.0: I/O space for GPIO uninitialized 2021-12-17T00:02:10.203610+0100 \
localhost.localdomain kernel: i801_smbus 0000:00:1f.3: SMBus using PCI interrupt \
2021-12-17T00:02:10.223139+0100 localhost.localdomain kernel: input: PC Speaker as \
/devices/platform/pcspkr/input/input5 2021-12-17T00:02:10.259805+0100 \
localhost.localdomain systemd-udevd[895]: link_config: autonegotiation is unset or \
enabled, the speed and duplex are not writable. 2021-12-17T00:02:10.276335+0100 \
localhost.localdomain kernel: RAPL PMU: API unit is 2^-32 Joules, 0 fixed counters, \
10737418240 ms ovfl timer 2021-12-17T00:02:10.301333+0100 localhost.localdomain \
kernel: alg: self-tests for crc32-pclmul (crc32) passed \
2021-12-17T00:02:10.316331+0100 localhost.localdomain kernel: iTCO_vendor_support: \
vendor-support=0 2021-12-17T00:02:10.318336+0100 localhost.localdomain kernel: \
iTCO_wdt: Intel TCO WatchDog Timer Driver v1.11 2021-12-17T00:02:10.318358+0100 \
localhost.localdomain kernel: iTCO_wdt: Found a ICH9 TCO device (Version=2, \
TCOBASE=0x0660) 2021-12-17T00:02:10.319327+0100 localhost.localdomain kernel: \
iTCO_wdt: initialized. heartbeat=30 sec (nowayout=0) 2021-12-17T00:02:10.746562+0100 \
localhost.localdomain systemd-udevd[887]: No TPM handle discovered. \
2021-12-17T00:02:10.746562+0100 localhost.localdomain systemd-udevd[887]: failed to \
open file /etc/ndctl/keys/nvdimm-master.blob: No such file or directory \
2021-12-17T00:02:10.747310+0100 localhost.localdomain systemd-udevd[887]: No TPM \
handle discovered. 2021-12-17T00:02:10.747310+0100 localhost.localdomain \
systemd-udevd[887]: failed to open file /etc/ndctl/keys/nvdimm-master.blob: No such \
file or directory 2021-12-17T00:02:10.771630+0100 localhost.localdomain \
systemd-udevd[889]: Using default interface naming scheme 'rhel-8.0'. \
2021-12-17T00:02:10.772571+0100 localhost.localdomain systemd-udevd[889]: \
link_config: autonegotiation is unset or enabled, the speed and duplex are not \
writable. 2021-12-17T00:02:10.773234+0100 localhost.localdomain systemd-udevd[889]: \
Could not set AlternativeName= or apply AlternativeNamesPolicy= on eth1: File exists \
2021-12-17T00:02:10.773242+0100 localhost.localdomain systemd-udevd[889]: Could not \
apply link config to eth1, ignoring: File exists 2021-12-17T00:02:10.870171+0100 \
localhost.localdomain systemd-udevd[899]: Using default interface naming scheme \
'rhel-8.0'. 2021-12-17T00:02:10.870753+0100 localhost.localdomain systemd-udevd[899]: \
link_config: autonegotiation is unset or enabled, the speed and duplex are not \
writable. 2021-12-17T00:02:10.870862+0100 localhost.localdomain systemd-udevd[899]: \
Could not set AlternativeName= or apply AlternativeNamesPolicy= on eth0: File exists \
2021-12-17T00:02:10.870869+0100 localhost.localdomain systemd-udevd[899]: Could not \
apply link config to eth0, ignoring: File exists 2021-12-17T00:02:10.888738+0100 \
localhost.localdomain systemd-udevd[896]: Using default interface naming scheme \
'rhel-8.0'. 2021-12-17T00:02:10.889309+0100 localhost.localdomain systemd-udevd[896]: \
link_config: autonegotiation is unset or enabled, the speed and duplex are not \
writable. 2021-12-17T00:02:10.889436+0100 localhost.localdomain systemd-udevd[896]: \
Could not set AlternativeName= or apply AlternativeNamesPolicy= on eth2: File exists \
2021-12-17T00:02:10.889441+0100 localhost.localdomain systemd-udevd[896]: Could not \
apply link config to eth2, ignoring: File exists 2021-12-17T00:02:10.895740+0100 \
localhost.localdomain systemd-udevd[891]: Using default interface naming scheme \
'rhel-8.0'. 2021-12-17T00:02:10.896301+0100 localhost.localdomain systemd-udevd[891]: \
link_config: autonegotiation is unset or enabled, the speed and duplex are not \
writable. 2021-12-17T00:02:10.896401+0100 localhost.localdomain systemd-udevd[891]: \
Could not set AlternativeName= or apply AlternativeNamesPolicy= on eth3: File exists \
2021-12-17T00:02:10.896405+0100 localhost.localdomain systemd-udevd[891]: Could not \
apply link config to eth3, ignoring: File exists 2021-12-17T00:02:11.135338+0100 \
localhost.localdomain systemd[1]: Started udev Wait for Complete Device \
Initialization. 2021-12-17T00:02:11.136117+0100 localhost.localdomain systemd[1]: \
Reached target Local File Systems (Pre). 2021-12-17T00:02:11.137451+0100 \
localhost.localdomain systemd[1]: Mounting /home... 2021-12-17T00:02:11.138772+0100 \
localhost.localdomain systemd[1]: Mounting /boot... 2021-12-17T00:02:11.139860+0100 \
localhost.localdomain systemd[1]: Mounting /var... 2021-12-17T00:02:11.141063+0100 \
localhost.localdomain systemd[1]: Mounting /tmp... 2021-12-17T00:02:11.147787+0100 \
localhost.localdomain kernel: XFS (vda8): Mounting V5 Filesystem \
2021-12-17T00:02:11.148775+0100 localhost.localdomain kernel: XFS (vda9): Mounting V5 \
Filesystem 2021-12-17T00:02:11.158097+0100 localhost.localdomain kernel: XFS (vda1): \
Mounting V5 Filesystem 2021-12-17T00:02:11.158147+0100 localhost.localdomain kernel: \
XFS (vda8): Ending clean mount 2021-12-17T00:02:11.160883+0100 localhost.localdomain \
systemd[1]: Mounted /home. 2021-12-17T00:02:11.166200+0100 localhost.localdomain \
kernel: XFS (vda5): Mounting V5 Filesystem 2021-12-17T00:02:11.167014+0100 \
localhost.localdomain kernel: XFS (vda9): Ending clean mount \
2021-12-17T00:02:11.169041+0100 localhost.localdomain systemd[1]: Mounted /tmp. \
2021-12-17T00:02:11.287336+0100 localhost.localdomain kernel: XFS (vda1): Ending \
clean mount 2021-12-17T00:02:11.289113+0100 localhost.localdomain systemd[1]: Mounted \
/boot. 2021-12-17T00:02:11.314832+0100 localhost.localdomain kernel: XFS (vda5): \
Ending clean mount 2021-12-17T00:02:11.317338+0100 localhost.localdomain systemd[1]: \
Mounted /var. 2021-12-17T00:02:11.319139+0100 localhost.localdomain systemd[1]: \
Mounting /var/log... 2021-12-17T00:02:11.320512+0100 localhost.localdomain \
systemd[1]: Mounting /var/tmp... 2021-12-17T00:02:11.321606+0100 \
localhost.localdomain systemd[1]: Starting Load/Save Random Seed... \
2021-12-17T00:02:11.366632+0100 localhost.localdomain kernel: XFS (vda6): Mounting V5 \
Filesystem 2021-12-17T00:02:11.366700+0100 localhost.localdomain kernel: XFS (vda2): \
Mounting V5 Filesystem 2021-12-17T00:02:11.394342+0100 localhost.localdomain kernel: \
XFS (vda2): Ending clean mount 2021-12-17T00:02:11.396707+0100 localhost.localdomain \
systemd[1]: Mounted /var/tmp. 2021-12-17T00:02:11.407330+0100 localhost.localdomain \
kernel: XFS (vda6): Ending clean mount 2021-12-17T00:02:11.409691+0100 \
localhost.localdomain systemd[1]: Mounted /var/log. 2021-12-17T00:02:11.410931+0100 \
localhost.localdomain systemd[1]: Starting Flush Journal to Persistent Storage... \
2021-12-17T00:02:11.413646+0100 localhost.localdomain systemd[1]: Mounting \
/var/log/audit... 2021-12-17T00:02:11.468333+0100 localhost.localdomain kernel: XFS \
(vda7): Mounting V5 Filesystem 2021-12-17T00:02:11.492340+0100 localhost.localdomain \
kernel: XFS (vda7): Ending clean mount 2021-12-17T00:02:11.495092+0100 \
localhost.localdomain systemd[1]: Mounted /var/log/audit. \
2021-12-17T00:02:11.495575+0100 localhost.localdomain systemd[1]: Reached target \
Local File Systems. 2021-12-17T00:02:11.496953+0100 localhost.localdomain systemd[1]: \
Starting Rebuild Dynamic Linker Cache... 2021-12-17T00:02:11.498223+0100 \
localhost.localdomain systemd[1]: Starting Rebuild Journal Catalog... \
2021-12-17T00:02:11.499389+0100 localhost.localdomain systemd[1]: Starting Restore \
/run/initramfs on shutdown... 2021-12-17T00:02:11.502137+0100 localhost.localdomain \
systemd[1]: Starting Import network configuration from initramfs... \
2021-12-17T00:02:11.521552+0100 localhost.localdomain systemd[1]: Started Restore \
/run/initramfs on shutdown. 2021-12-17T00:02:11.573059+0100 localhost.localdomain \
systemd-journald[854]: Time spent on flushing to /var is 12.465ms for 1026 entries. \
2021-12-17T00:02:11.573059+0100 localhost.localdomain systemd-journald[854]: System \
journal (/var/log/journal/ed30ef6d6cf744bbb09f5af56f57c3dd) is 6.3M, max 50.6M, 44.3M \
free. 2021-12-17T00:02:11.595475+0100 localhost.localdomain systemd[1]: Started Flush \
Journal to Persistent Storage. 2021-12-17T00:02:11.630791+0100 localhost.localdomain \
systemd[1]: Started Load/Save Random Seed. 2021-12-17T00:02:11.705107+0100 \
localhost.localdomain systemd[1]: Started Import network configuration from \
initramfs. 2021-12-17T00:02:11.706686+0100 localhost.localdomain systemd[1]: Starting \
Create Volatile Files and Directories... 2021-12-17T00:02:11.711080+0100 \
localhost.localdomain systemd[1]: Started Rebuild Dynamic Linker Cache. \
2021-12-17T00:02:11.928944+0100 localhost.localdomain systemd[1]: Started Rebuild \
Journal Catalog. 2021-12-17T00:02:11.930648+0100 localhost.localdomain systemd[1]: \
Starting Update is Completed... 2021-12-17T00:02:12.060914+0100 localhost.localdomain \
systemd[1]: Started Create Volatile Files and Directories. \
2021-12-17T00:02:12.062543+0100 localhost.localdomain systemd[1]: Mounting RPC Pipe \
File System... 2021-12-17T00:02:12.064188+0100 localhost.localdomain systemd[1]: \
Starting RPC Bind... 2021-12-17T00:02:12.065228+0100 localhost.localdomain \
systemd[1]: Starting Security Auditing Service... 2021-12-17T00:02:12.101767+0100 \
localhost.localdomain systemd[1]: Started Update is Completed. \
2021-12-17T00:02:12.124530+0100 localhost.localdomain auditd[1029]: audit dispatcher \
initialized with q_depth=400 and 1 active plugins 2021-12-17T00:02:12.128734+0100 \
localhost.localdomain auditd[1029]: Init complete, auditd 3.0 listening for events \
(startup state enable) 2021-12-17T00:02:12.248305+0100 localhost.localdomain \
augenrules[1034]: /sbin/augenrules: No change 2021-12-17T00:02:12.263860+0100 \
localhost.localdomain kernel: RPC: Registered named UNIX socket transport module. \
2021-12-17T00:02:12.263938+0100 localhost.localdomain kernel: RPC: Registered udp \
transport module. 2021-12-17T00:02:12.263953+0100 localhost.localdomain kernel: RPC: \
Registered tcp transport module. 2021-12-17T00:02:12.263964+0100 \
localhost.localdomain kernel: RPC: Registered tcp NFSv4.1 backchannel transport \
module. 2021-12-17T00:02:12.267367+0100 localhost.localdomain systemd[1]: Mounted RPC \
Pipe File System. 2021-12-17T00:02:12.267995+0100 localhost.localdomain systemd[1]: \
Reached target rpc_pipefs.target. 2021-12-17T00:02:12.280222+0100 \
localhost.localdomain augenrules[1034]: No rules 2021-12-17T00:02:12.280222+0100 \
localhost.localdomain augenrules[1034]: enabled 1 2021-12-17T00:02:12.280222+0100 \
localhost.localdomain augenrules[1034]: failure 1 2021-12-17T00:02:12.280222+0100 \
localhost.localdomain augenrules[1034]: pid 1029 2021-12-17T00:02:12.280222+0100 \
localhost.localdomain augenrules[1034]: rate_limit 0 2021-12-17T00:02:12.280222+0100 \
localhost.localdomain augenrules[1034]: backlog_limit 8192 \
2021-12-17T00:02:12.280222+0100 localhost.localdomain augenrules[1034]: lost 0 \
2021-12-17T00:02:12.280222+0100 localhost.localdomain augenrules[1034]: backlog 0 \
2021-12-17T00:02:12.280222+0100 localhost.localdomain augenrules[1034]: \
backlog_wait_time 60000 2021-12-17T00:02:12.280222+0100 localhost.localdomain \
augenrules[1034]: enabled 1 2021-12-17T00:02:12.280222+0100 localhost.localdomain \
augenrules[1034]: failure 1 2021-12-17T00:02:12.280222+0100 localhost.localdomain \
augenrules[1034]: pid 1029 2021-12-17T00:02:12.280222+0100 localhost.localdomain \
augenrules[1034]: rate_limit 0 2021-12-17T00:02:12.280222+0100 localhost.localdomain \
augenrules[1034]: backlog_limit 8192 2021-12-17T00:02:12.280222+0100 \
localhost.localdomain augenrules[1034]: lost 0 2021-12-17T00:02:12.280222+0100 \
localhost.localdomain augenrules[1034]: backlog 3 2021-12-17T00:02:12.280222+0100 \
localhost.localdomain augenrules[1034]: backlog_wait_time 60000 \
2021-12-17T00:02:12.280222+0100 localhost.localdomain augenrules[1034]: enabled 1 \
2021-12-17T00:02:12.280222+0100 localhost.localdomain augenrules[1034]: failure 1 \
2021-12-17T00:02:12.280222+0100 localhost.localdomain augenrules[1034]: pid 1029 \
2021-12-17T00:02:12.280222+0100 localhost.localdomain augenrules[1034]: rate_limit 0 \
2021-12-17T00:02:12.280222+0100 localhost.localdomain augenrules[1034]: backlog_limit \
8192 2021-12-17T00:02:12.280222+0100 localhost.localdomain augenrules[1034]: lost 0
2021-12-17T00:02:12.280222+0100 localhost.localdomain augenrules[1034]: backlog 3
2021-12-17T00:02:12.280222+0100 localhost.localdomain augenrules[1034]: \
backlog_wait_time 60000 2021-12-17T00:02:12.283859+0100 localhost.localdomain \
systemd[1]: Started Security Auditing Service. 2021-12-17T00:02:12.286358+0100 \
localhost.localdomain systemd[1]: Starting Update UTMP about System Boot/Shutdown... \
2021-12-17T00:02:12.342919+0100 localhost.localdomain systemd[1]: Started RPC Bind. \
2021-12-17T00:02:12.401210+0100 localhost.localdomain systemd[1]: Started Update UTMP \
about System Boot/Shutdown. 2021-12-17T00:02:12.401955+0100 localhost.localdomain \
systemd[1]: Reached target System Initialization. 2021-12-17T00:02:12.402726+0100 \
localhost.localdomain systemd[1]: Listening on Open-iSCSI iscsid Socket. \
2021-12-17T00:02:12.403871+0100 localhost.localdomain systemd[1]: Listening on \
Virtual machine log manager socket. 2021-12-17T00:02:12.404994+0100 \
localhost.localdomain systemd[1]: Started daily update of the root trust anchor for \
DNSSEC. 2021-12-17T00:02:12.405889+0100 localhost.localdomain systemd[1]: Listening \
on Virtual machine lock manager socket. 2021-12-17T00:02:12.406390+0100 \
localhost.localdomain systemd[1]: Started Daily Cleanup of Temporary Directories. \
2021-12-17T00:02:12.407779+0100 localhost.localdomain systemd[1]: Listening on PC/SC \
Smart Card Daemon Activation Socket. 2021-12-17T00:02:12.408784+0100 \
localhost.localdomain systemd[1]: Listening on Libvirt local socket. \
2021-12-17T00:02:12.409446+0100 localhost.localdomain systemd[1]: Listening on \
Libvirt local read-only socket. 2021-12-17T00:02:12.410105+0100 localhost.localdomain \
systemd[1]: Listening on Libvirt admin socket. 2021-12-17T00:02:12.410582+0100 \
localhost.localdomain systemd[1]: Listening on Open-iSCSI iscsiuio Socket. \
2021-12-17T00:02:12.411714+0100 localhost.localdomain systemd[1]: Listening on SSSD \
Kerberos Cache Manager responder socket. 2021-12-17T00:02:12.412293+0100 \
localhost.localdomain systemd[1]: Started Run system activity accounting tool every \
10 minutes. 2021-12-17T00:02:12.413552+0100 localhost.localdomain systemd[1]: \
Listening on D-Bus System Message Bus Socket. 2021-12-17T00:02:12.413998+0100 \
localhost.localdomain systemd[1]: Reached target Sockets. \
2021-12-17T00:02:12.414304+0100 localhost.localdomain systemd[1]: Reached target \
Basic System. 2021-12-17T00:02:12.416033+0100 localhost.localdomain systemd[1]: \
Starting Self Monitoring and Reporting Technology (SMART) Daemon... \
2021-12-17T00:02:12.417993+0100 localhost.localdomain systemd[1]: Started QEMU Guest \
Agent. 2021-12-17T00:02:12.419863+0100 localhost.localdomain systemd[1]: Starting \
Kernel Samepage Merging... 2021-12-17T00:02:12.421203+0100 localhost.localdomain \
systemd[1]: Starting System Security Services Daemon... \
2021-12-17T00:02:12.424652+0100 localhost.localdomain systemd[1]: Started irqbalance \
daemon. 2021-12-17T00:02:12.428793+0100 localhost.localdomain systemd[1]: Starting \
OpenSSH rsa Server Key Generation... 2021-12-17T00:02:12.430413+0100 \
localhost.localdomain systemd[1]: Starting Resets System Activity Logs... \
2021-12-17T00:02:12.435742+0100 localhost.localdomain systemd[1]: Starting NTP \
client/server... 2021-12-17T00:02:12.437200+0100 localhost.localdomain systemd[1]: \
Starting Virtual Machine and Container Registration Service... \
2021-12-17T00:02:12.439458+0100 localhost.localdomain systemd[1]: Started dnf \
makecache --timer. 2021-12-17T00:02:12.441231+0100 localhost.localdomain systemd[1]: \
Starting Hardware RNG Entropy Gatherer Wake threshold service... \
2021-12-17T00:02:12.442611+0100 localhost.localdomain systemd[1]: Starting Rollback \
uncommitted netcf network config change transactions... \
2021-12-17T00:02:12.450238+0100 localhost.localdomain systemd[1]: Starting \
Authorization Manager... 2021-12-17T00:02:12.460677+0100 localhost.localdomain \
systemd[1]: Started D-Bus System Message Bus. 2021-12-17T00:02:12.484880+0100 \
localhost.localdomain systemd[1]: Starting OpenSSH ecdsa Server Key Generation... \
2021-12-17T00:02:12.492544+0100 localhost.localdomain systemd[1]: Started Generate \
summary of yesterday's process accounting. 2021-12-17T00:02:12.494426+0100 \
localhost.localdomain systemd[1]: Reached target Timers. \
2021-12-17T00:02:12.497460+0100 localhost.localdomain systemd[1]: Starting OpenSSH \
ed25519 Server Key Generation... 2021-12-17T00:02:12.516289+0100 \
localhost.localdomain netcf-transaction.sh[1070]: Running  start: No pending \
transaction to rollback 2021-12-17T00:02:12.527699+0100 localhost.localdomain \
systemd[1]: Started Kernel Samepage Merging. 2021-12-17T00:02:12.529773+0100 \
localhost.localdomain systemd[1]: Started Resets System Activity Logs. \
2021-12-17T00:02:12.553670+0100 localhost.localdomain systemd[1]: Started Rollback \
uncommitted netcf network config change transactions. 2021-12-17T00:02:12.555400+0100 \
localhost.localdomain systemd[1]: sshd-keygen@ed25519.service: Succeeded. \
2021-12-17T00:02:12.555769+0100 localhost.localdomain systemd[1]: Started OpenSSH \
ed25519 Server Key Generation. 2021-12-17T00:02:12.557959+0100 localhost.localdomain \
systemd[1]: Starting Kernel Samepage Merging (KSM) Tuning Daemon... \
2021-12-17T00:02:13.046706+0100 localhost.localdomain smartd[1060]: smartd 7.1 \
2020-04-05 r5049 [x86_64-linux-4.18.0-348.2.1.el8_5.x86_64] (local build) \
2021-12-17T00:02:13.046717+0100 localhost.localdomain smartd[1060]: Copyright (C) \
2002-19, Bruce Allen, Christian Franke, www.smartmontools.org \
2021-12-17T00:02:13.046860+0100 localhost.localdomain smartd[1060]: Opened \
configuration file /etc/smartmontools/smartd.conf 2021-12-17T00:02:13.047127+0100 \
localhost.localdomain smartd[1060]: Configuration file /etc/smartmontools/smartd.conf \
was parsed, found DEVICESCAN, scanning devices 2021-12-17T00:02:13.047460+0100 \
localhost.localdomain smartd[1060]: In the system's table of devices NO devices found \
to scan 2021-12-17T00:02:13.047491+0100 localhost.localdomain smartd[1060]: \
Monitoring 0 ATA/SATA, 0 SCSI/SAS and 0 NVMe devices 2021-12-17T00:02:13.087585+0100 \
localhost.localdomain systemd[1]: Started Self Monitoring and Reporting Technology \
(SMART) Daemon. 2021-12-17T00:02:13.088924+0100 localhost.localdomain systemd[1]: \
sshd-keygen@ecdsa.service: Succeeded. 2021-12-17T00:02:13.089253+0100 \
localhost.localdomain systemd[1]: Started OpenSSH ecdsa Server Key Generation. \
2021-12-17T00:02:13.090200+0100 localhost.localdomain systemd[1]: Started Kernel \
Samepage Merging (KSM) Tuning Daemon. 2021-12-17T00:02:13.203734+0100 \
localhost.localdomain systemd[1]: Started Hardware RNG Entropy Gatherer Wake \
threshold service. 2021-12-17T00:02:13.206606+0100 localhost.localdomain systemd[1]: \
Started Hardware RNG Entropy Gatherer Daemon. 2021-12-17T00:02:13.221045+0100 \
localhost.localdomain systemd[1]: Started Virtual Machine and Container Registration \
Service. 2021-12-17T00:02:13.357468+0100 localhost.localdomain rngd[1105]: Disabling \
7: PKCS11 Entropy generator (pkcs11) 2021-12-17T00:02:13.357468+0100 \
localhost.localdomain rngd[1105]: Disabling 5: NIST Network Entropy Beacon (nist) \
2021-12-17T00:02:13.357468+0100 localhost.localdomain rngd[1105]: Initializing \
available sources 2021-12-17T00:02:13.359336+0100 localhost.localdomain rngd[1105]: \
[hwrng ]: Initialized 2021-12-17T00:02:13.359379+0100 localhost.localdomain \
rngd[1105]: [rdrand]: Enabling RDSEED rng support 2021-12-17T00:02:13.359379+0100 \
localhost.localdomain rngd[1105]: [rdrand]: Initialized \
2021-12-17T00:02:13.455834+0100 localhost.localdomain chronyd[1111]: chronyd version \
4.1 starting (+CMDMON +NTP +REFCLOCK +RTC +PRIVDROP +SCFILTER +SIGND +ASYNCDNS +NTS \
+SECHASH +IPV6 +DEBUG) 2021-12-17T00:02:13.458383+0100 localhost.localdomain \
rngd[1105]: [jitter]: Initializing AES buffer 2021-12-17T00:02:13.465385+0100 \
localhost.localdomain chronyd[1111]: Using right/UTC timezone to obtain leap second \
data 2021-12-17T00:02:13.533580+0100 localhost.localdomain systemd[1]: Started NTP \
client/server. 2021-12-17T00:02:13.611764+0100 localhost.localdomain polkitd[1071]: \
Started polkitd version 0.115 2021-12-17T00:02:13.671530+0100 localhost.localdomain \
sssd[1063]: Starting up 2021-12-17T00:02:13.697826+0100 localhost.localdomain \
polkitd[1071]: Loading rules from directory /etc/polkit-1/rules.d \
2021-12-17T00:02:13.697867+0100 localhost.localdomain polkitd[1071]: Loading rules \
from directory /usr/share/polkit-1/rules.d 2021-12-17T00:02:13.703128+0100 \
localhost.localdomain polkitd[1071]: Finished loading, compiling and executing 4 \
rules 2021-12-17T00:02:13.712838+0100 localhost.localdomain polkitd[1071]: Acquired \
the name org.freedesktop.PolicyKit1 on the system bus 2021-12-17T00:02:13.712931+0100 \
localhost.localdomain systemd[1]: Started Authorization Manager. \
2021-12-17T00:02:13.715223+0100 localhost.localdomain systemd[1]: Starting firewalld \
- dynamic firewall daemon... 2021-12-17T00:02:14.230017+0100 localhost.localdomain \
sssd_be[1120]: Starting up 2021-12-17T00:02:14.810632+0100 localhost.localdomain \
sssd_nss[1124]: Starting up 2021-12-17T00:02:14.900868+0100 localhost.localdomain \
systemd[1]: Started System Security Services Daemon. 2021-12-17T00:02:14.901883+0100 \
localhost.localdomain systemd[1]: Reached target User and Group Name Lookups. \
2021-12-17T00:02:14.904783+0100 localhost.localdomain systemd[1]: Starting Login \
Service... 2021-12-17T00:02:15.200367+0100 localhost.localdomain \
systemd-logind[1125]: Watching system buttons on /dev/input/event0 (Power Button) \
2021-12-17T00:02:15.203523+0100 localhost.localdomain systemd-logind[1125]: Watching \
system buttons on /dev/input/event1 (AT Translated Set 2 keyboard) \
2021-12-17T00:02:15.206922+0100 localhost.localdomain systemd-logind[1125]: New seat \
seat0. 2021-12-17T00:02:15.211401+0100 localhost.localdomain systemd[1]: Started \
Login Service. 2021-12-17T00:02:15.313489+0100 localhost.localdomain systemd[1]: \
Started firewalld - dynamic firewall daemon. 2021-12-17T00:02:15.314532+0100 \
localhost.localdomain systemd[1]: Reached target Network (Pre). \
2021-12-17T00:02:15.316222+0100 localhost.localdomain systemd[1]: Starting Network \
Manager... 2021-12-17T00:02:15.558001+0100 localhost.localdomain firewalld[1123]: \
WARNING: AllowZoneDrifting is enabled. This is considered an insecure configuration \
option. It will be removed in a future release. Please consider disabling it now. \
2021-12-17T00:02:15.969684+0100 localhost.localdomain NetworkManager[1137]: &lt;info&gt;  \
[1639695735.9693] NetworkManager (version 1.36.0-0.2.el8) is starting... (for the \
first time) 2021-12-17T00:02:15.969703+0100 localhost.localdomain \
NetworkManager[1137]: &lt;info&gt;  [1639695735.9696] Read config: \
/etc/NetworkManager/NetworkManager.conf (etc: 10-stable-ipv6-addr.conf, vdsm.conf) \
2021-12-17T00:02:15.969709+0100 localhost.localdomain NetworkManager[1137]: &lt;warn&gt;  \
[1639695735.9697] config: unknown key 'ipv6.addr-gen-mode' in section [connection] of \
file '/etc/NetworkManager/conf.d/10-stable-ipv6-addr.conf' \
2021-12-17T00:02:15.981792+0100 localhost.localdomain NetworkManager[1137]: &lt;info&gt;  \
[1639695735.9817] bus-manager: acquired D-Bus service \
"org.freedesktop.NetworkManager" 2021-12-17T00:02:15.981908+0100 \
localhost.localdomain systemd[1]: Started Network Manager. \
2021-12-17T00:02:15.982902+0100 localhost.localdomain systemd[1]: Reached target \
Network. 2021-12-17T00:02:15.985165+0100 localhost.localdomain systemd[1]: Starting \
GSSAPI Proxy Daemon... 2021-12-17T00:02:15.987183+0100 localhost.localdomain \
NetworkManager[1137]: &lt;info&gt;  [1639695735.9871] manager[0x55a6a94c8000]: monitoring \
kernel firmware directory '/lib/firmware'. 2021-12-17T00:02:15.987580+0100 \
localhost.localdomain systemd[1]: Starting Logout off all iSCSI sessions on \
shutdown... 2021-12-17T00:02:15.988309+0100 localhost.localdomain dbus-daemon[1073]: \
[system] Activating via systemd: service name='org.freedesktop.hostname1' \
unit='dbus-org.freedesktop.hostname1.service' requested by ':1.9' (uid=0 pid=1137 \
comm="/usr/sbin/NetworkManager --no-daemon " \
label="system_u:system_r:NetworkManager_t:s0") 2021-12-17T00:02:15.989728+0100 \
localhost.localdomain systemd[1]: Starting Dynamic System Tuning Daemon... \
2021-12-17T00:02:15.991349+0100 localhost.localdomain systemd[1]: Starting Network \
Manager Wait Online... 2021-12-17T00:02:16.012749+0100 localhost.localdomain \
systemd[1]: Starting Hostname Service... 2021-12-17T00:02:16.024127+0100 \
localhost.localdomain systemd[1]: Started Logout off all iSCSI sessions on shutdown. \
2021-12-17T00:02:16.146702+0100 localhost.localdomain systemd[1]: Started GSSAPI \
Proxy Daemon. 2021-12-17T00:02:16.147680+0100 localhost.localdomain systemd[1]: \
Reached target NFS client services. 2021-12-17T00:02:16.487627+0100 \
localhost.localdomain dbus-daemon[1073]: [system] Successfully activated service \
'org.freedesktop.hostname1' 2021-12-17T00:02:16.487992+0100 localhost.localdomain \
systemd[1]: Started Hostname Service. 2021-12-17T00:02:16.492829+0100 \
localhost.localdomain NetworkManager[1137]: &lt;info&gt;  [1639695736.4927] hostname: \
hostname: using hostnamed 2021-12-17T00:02:16.492844+0100 localhost.localdomain \
NetworkManager[1137]: &lt;info&gt;  [1639695736.4928] hostname: hostname changed from \
(none) to "localhost.localdomain" 2021-12-17T00:02:16.493197+0100 \
localhost.localdomain NetworkManager[1137]: &lt;info&gt;  [1639695736.4931] \
dns-mgr[0x55a6a94a9250]: init: dns=default,systemd-resolved rc-manager=symlink \
2021-12-17T00:02:16.497739+0100 localhost.localdomain NetworkManager[1137]: &lt;info&gt;  \
[1639695736.4977] Loaded device plugin: NMOvsFactory \
(/usr/lib64/NetworkManager/1.36.0-0.2.el8/libnm-device-plugin-ovs.so) \
2021-12-17T00:02:16.499055+0100 localhost.localdomain NetworkManager[1137]: &lt;info&gt;  \
[1639695736.4990] Loaded device plugin: NMTeamFactory \
(/usr/lib64/NetworkManager/1.36.0-0.2.el8/libnm-device-plugin-team.so) \
2021-12-17T00:02:16.499094+0100 localhost.localdomain NetworkManager[1137]: &lt;info&gt;  \
[1639695736.4990] manager: rfkill: Wi-Fi enabled by radio killswitch; enabled by \
state file 2021-12-17T00:02:16.499171+0100 localhost.localdomain \
NetworkManager[1137]: &lt;info&gt;  [1639695736.4991] manager: rfkill: WWAN enabled by \
radio killswitch; enabled by state file 2021-12-17T00:02:16.499253+0100 \
localhost.localdomain NetworkManager[1137]: &lt;info&gt;  [1639695736.4992] manager: \
Networking is enabled by state file 2021-12-17T00:02:16.499500+0100 \
localhost.localdomain dbus-daemon[1073]: [system] Activating via systemd: service \
name='org.freedesktop.nm_dispatcher' \
unit='dbus-org.freedesktop.nm-dispatcher.service' requested by ':1.9' (uid=0 pid=1137 \
comm="/usr/sbin/NetworkManager --no-daemon " \
label="system_u:system_r:NetworkManager_t:s0") 2021-12-17T00:02:16.501693+0100 \
localhost.localdomain NetworkManager[1137]: &lt;info&gt;  [1639695736.5016] settings: \
Loaded settings plugin: ifcfg-rh \
("/usr/lib64/NetworkManager/1.36.0-0.2.el8/libnm-settings-plugin-ifcfg-rh.so") \
2021-12-17T00:02:16.501742+0100 localhost.localdomain NetworkManager[1137]: &lt;info&gt;  \
[1639695736.5017] settings: Loaded settings plugin: keyfile (internal) \
2021-12-17T00:02:16.502681+0100 localhost.localdomain systemd[1]: Starting Network \
Manager Script Dispatcher Service... 2021-12-17T00:02:16.508522+0100 \
localhost.localdomain NetworkManager[1137]: &lt;info&gt;  [1639695736.5085] dhcp-init: \
Using DHCP client 'internal' 2021-12-17T00:02:16.508544+0100 localhost.localdomain \
NetworkManager[1137]: &lt;info&gt;  [1639695736.5085] device (lo): carrier: link connected \
2021-12-17T00:02:16.508774+0100 localhost.localdomain NetworkManager[1137]: &lt;info&gt;  \
[1639695736.5087] manager: (lo): new Generic device \
(/org/freedesktop/NetworkManager/Devices/1) 2021-12-17T00:02:16.509820+0100 \
2021-12-17T00:02:16.513034+0100 localhost.localdomain NetworkManager[1137]: &lt;info&gt;  \
[1639695736.5130] settings: (eth0): created default wired connection 'Wired \
connection 1' 2021-12-17T00:02:16.513078+0100 localhost.localdomain \
NetworkManager[1137]: &lt;info&gt;  [1639695736.5130] device (eth0): state change: \
unmanaged -&gt; unavailable (reason 'managed', sys-iface-state: 'external') \
2021-12-17T00:02:16.514691+0100 localhost.localdomain kernel: IPv6: \
ADDRCONF(NETDEV_UP): eth0: link is not ready 2021-12-17T00:02:16.525328+0100 \
localhost.localdomain kernel: 8021q: adding VLAN 0 to HW filter on device eth0 \
2021-12-17T00:02:16.525338+0100 localhost.localdomain NetworkManager[1137]: &lt;info&gt;  \
[1639695736.5253] device (eth0): carrier: link connected \
2021-12-17T00:02:16.530906+0100 localhost.localdomain NetworkManager[1137]: &lt;info&gt;  \
[1639695736.5308] manager: (eth1): new Ethernet device \
(/org/freedesktop/NetworkManager/Devices/3) 2021-12-17T00:02:16.532964+0100 \
localhost.localdomain NetworkManager[1137]: &lt;info&gt;  [1639695736.5329] settings: \
(eth1): created default wired connection 'Wired connection 2' \
2021-12-17T00:02:16.533002+0100 localhost.localdomain NetworkManager[1137]: &lt;info&gt;  \
[1639695736.5329] device (eth1): state change: unmanaged -&gt; unavailable (reason \
'managed', sys-iface-state: 'external') 2021-12-17T00:02:16.534325+0100 \
localhost.localdomain kernel: IPv6: ADDRCONF(NETDEV_UP): eth1: link is not ready \
2021-12-17T00:02:16.541118+0100 localhost.localdomain NetworkManager[1137]: &lt;info&gt;  \
[1639695736.5411] device (eth1): carrier: link connected \
2021-12-17T00:02:16.541324+0100 localhost.localdomain kernel: 8021q: adding VLAN 0 to \
HW filter on device eth1 2021-12-17T00:02:16.548638+0100 localhost.localdomain \
NetworkManager[1137]: &lt;info&gt;  [1639695736.5486] manager: (eth2): new Ethernet device \
(/org/freedesktop/NetworkManager/Devices/4) 2021-12-17T00:02:16.551180+0100 \
localhost.localdomain NetworkManager[1137]: &lt;info&gt;  [1639695736.5511] settings: \
(eth2): created default wired connection 'Wired connection 3' \
2021-12-17T00:02:16.551217+0100 localhost.localdomain NetworkManager[1137]: &lt;info&gt;  \
[1639695736.5512] device (eth2): state change: unmanaged -&gt; unavailable (reason \
'managed', sys-iface-state: 'external') 2021-12-17T00:02:16.552329+0100 \
localhost.localdomain kernel: IPv6: ADDRCONF(NETDEV_UP): eth2: link is not ready \
2021-12-17T00:02:16.554324+0100 localhost.localdomain kernel: 8021q: adding VLAN 0 to \
HW filter on device eth2 2021-12-17T00:02:16.560561+0100 localhost.localdomain \
NetworkManager[1137]: &lt;info&gt;  [1639695736.5605] device (eth2): carrier: link \
connected 2021-12-17T00:02:16.567498+0100 localhost.localdomain NetworkManager[1137]: \
&lt;info&gt;  [1639695736.5674] manager: (eth3): new Ethernet device \
(/org/freedesktop/NetworkManager/Devices/5) 2021-12-17T00:02:16.568624+0100 \
localhost.localdomain NetworkManager[1137]: &lt;info&gt;  [1639695736.5686] settings: \
(eth3): created default wired connection 'Wired connection 4' \
2021-12-17T00:02:16.568658+0100 localhost.localdomain NetworkManager[1137]: &lt;info&gt;  \
[1639695736.5686] device (eth3): state change: unmanaged -&gt; unavailable (reason \
'managed', sys-iface-state: 'external') 2021-12-17T00:02:16.570325+0100 \
localhost.localdomain kernel: IPv6: ADDRCONF(NETDEV_UP): eth3: link is not ready \
2021-12-17T00:02:16.579326+0100 localhost.localdomain kernel: 8021q: adding VLAN 0 to \
HW filter on device eth3 2021-12-17T00:02:16.583631+0100 localhost.localdomain \
NetworkManager[1137]: &lt;info&gt;  [1639695736.5836] device (eth3): carrier: link \
connected 2021-12-17T00:02:16.586728+0100 localhost.localdomain NetworkManager[1137]: \
&lt;info&gt;  [1639695736.5867] ovsdb: disconnected from ovsdb \
2021-12-17T00:02:16.587437+0100 localhost.localdomain NetworkManager[1137]: &lt;info&gt;  \
[1639695736.5874] device (eth0): state change: unavailable -&gt; disconnected (reason \
'none', sys-iface-state: 'managed') 2021-12-17T00:02:16.588454+0100 \
localhost.localdomain NetworkManager[1137]: &lt;info&gt;  [1639695736.5884] device (eth1): \
state change: unavailable -&gt; disconnected (reason 'none', sys-iface-state: 'managed') \
2021-12-17T00:02:16.592466+0100 localhost.localdomain NetworkManager[1137]: &lt;info&gt;  \
[1639695736.5924] device (eth2): state change: unavailable -&gt; disconnected (reason \
'none', sys-iface-state: 'managed') 2021-12-17T00:02:16.592991+0100 \
localhost.localdomain NetworkManager[1137]: &lt;info&gt;  [1639695736.5929] device (eth3): \
state change: unavailable -&gt; disconnected (reason 'none', sys-iface-state: 'managed') \
2021-12-17T00:02:16.593578+0100 localhost.localdomain NetworkManager[1137]: &lt;info&gt;  \
[1639695736.5935] policy: auto-activating connection 'Wired connection 1' \
(acfc89c7-6712-3d07-9da5-22437059cac9) 2021-12-17T00:02:16.593824+0100 \
localhost.localdomain NetworkManager[1137]: &lt;info&gt;  [1639695736.5938] policy: \
auto-activating connection 'Wired connection 2' \
(1a9d1e4e-1ec4-35d0-b44b-4d87b5e2c0f8) 2021-12-17T00:02:16.593941+0100 \
localhost.localdomain NetworkManager[1137]: &lt;info&gt;  [1639695736.5939] policy: \
auto-activating connection 'Wired connection 3' \
(13156056-6de1-3f94-9699-8dc98cca368f) 2021-12-17T00:02:16.594051+0100 \
localhost.localdomain NetworkManager[1137]: &lt;info&gt;  [1639695736.5940] policy: \
auto-activating connection 'Wired connection 4' \
(9fe6f170-8b57-3944-8f8d-a470491f504b) 2021-12-17T00:02:16.597513+0100 \
localhost.localdomain NetworkManager[1137]: &lt;info&gt;  [1639695736.5975] device (eth0): \
Activation: starting connection 'Wired connection 1' \
(acfc89c7-6712-3d07-9da5-22437059cac9) 2021-12-17T00:02:16.603372+0100 \
localhost.localdomain NetworkManager[1137]: &lt;info&gt;  [1639695736.5981] device (eth1): \
Activation: starting connection 'Wired connection 2' \
(1a9d1e4e-1ec4-35d0-b44b-4d87b5e2c0f8) 2021-12-17T00:02:16.603604+0100 \
localhost.localdomain NetworkManager[1137]: &lt;info&gt;  [1639695736.6035] device (eth2): \
Activation: starting connection 'Wired connection 3' \
(13156056-6de1-3f94-9699-8dc98cca368f) 2021-12-17T00:02:16.603775+0100 \
localhost.localdomain NetworkManager[1137]: &lt;info&gt;  [1639695736.6037] device (eth3): \
Activation: starting connection 'Wired connection 4' \
(9fe6f170-8b57-3944-8f8d-a470491f504b) 2021-12-17T00:02:16.603880+0100 \
localhost.localdomain NetworkManager[1137]: &lt;info&gt;  [1639695736.6038] device (eth0): \
state change: disconnected -&gt; prepare (reason 'none', sys-iface-state: 'managed') \
2021-12-17T00:02:16.604095+0100 localhost.localdomain NetworkManager[1137]: &lt;info&gt;  \
[1639695736.6040] manager: NetworkManager state is now CONNECTING \
2021-12-17T00:02:16.604243+0100 localhost.localdomain NetworkManager[1137]: &lt;info&gt;  \
[1639695736.6042] device (eth0): state change: prepare -&gt; config (reason 'none', \
sys-iface-state: 'managed') 2021-12-17T00:02:16.604862+0100 localhost.localdomain \
NetworkManager[1137]: &lt;info&gt;  [1639695736.6048] device (eth1): state change: \
disconnected -&gt; prepare (reason 'none', sys-iface-state: 'managed') \
2021-12-17T00:02:16.608517+0100 localhost.localdomain NetworkManager[1137]: &lt;info&gt;  \
[1639695736.6085] device (eth1): state change: prepare -&gt; config (reason 'none', \
sys-iface-state: 'managed') 2021-12-17T00:02:16.608916+0100 localhost.localdomain \
NetworkManager[1137]: &lt;info&gt;  [1639695736.6089] device (eth2): state change: \
disconnected -&gt; prepare (reason 'none', sys-iface-state: 'managed') \
2021-12-17T00:02:16.609185+0100 localhost.localdomain NetworkManager[1137]: &lt;info&gt;  \
[1639695736.6091] device (eth2): state change: prepare -&gt; config (reason 'none', \
sys-iface-state: 'managed') 2021-12-17T00:02:16.610621+0100 localhost.localdomain \
NetworkManager[1137]: &lt;info&gt;  [1639695736.6106] device (eth3): state change: \
disconnected -&gt; prepare (reason 'none', sys-iface-state: 'managed') \
2021-12-17T00:02:16.610886+0100 localhost.localdomain NetworkManager[1137]: &lt;info&gt;  \
[1639695736.6108] device (eth3): state change: prepare -&gt; config (reason 'none', \
sys-iface-state: 'managed') 2021-12-17T00:02:16.972473+0100 localhost.localdomain \
dbus-daemon[1073]: [system] Successfully activated service \
'org.freedesktop.nm_dispatcher' 2021-12-17T00:02:16.972859+0100 localhost.localdomain \
systemd[1]: Started Network Manager Script Dispatcher Service. \
2021-12-17T00:02:17.291616+0100 localhost.localdomain systemd[1]: \
sshd-keygen@rsa.service: Succeeded. 2021-12-17T00:02:17.291967+0100 \
localhost.localdomain systemd[1]: Started OpenSSH rsa Server Key Generation. \
2021-12-17T00:02:17.293099+0100 localhost.localdomain systemd[1]: Reached target \
sshd-keygen.target. 2021-12-17T00:02:17.296074+0100 localhost.localdomain systemd[1]: \
Starting OpenSSH server daemon... 2021-12-17T00:02:17.574015+0100 \
localhost.localdomain sshd[1258]: Unable to load host key: \
/etc/ssh/ssh_host_ed25519_key 2021-12-17T00:02:17.575117+0100 localhost.localdomain \
sshd[1258]: Server listening on 0.0.0.0 port 22. 2021-12-17T00:02:17.575440+0100 \
localhost.localdomain sshd[1258]: Server listening on :: port 22. \
2021-12-17T00:02:17.575801+0100 localhost.localdomain systemd[1]: Started OpenSSH \
server daemon. 2021-12-17T00:02:17.740712+0100 localhost.localdomain \
NetworkManager[1137]: &lt;info&gt;  [1639695737.7405] device (eth0): state change: config \
-&gt; ip-config (reason 'none', sys-iface-state: 'managed') \
2021-12-17T00:02:17.741248+0100 localhost.localdomain NetworkManager[1137]: &lt;info&gt;  \
[1639695737.7412] dhcp4 (eth0): activation: beginning transaction (timeout in 45 \
seconds) 2021-12-17T00:02:17.743953+0100 localhost.localdomain NetworkManager[1137]: \
&lt;info&gt;  [1639695737.7439] dhcp4 (eth0): state changed new lease, \
address=192.168.210.3 2021-12-17T00:02:17.744158+0100 localhost.localdomain \
NetworkManager[1137]: &lt;info&gt;  [1639695737.7441] policy: set 'Wired connection 1' \
(eth0) as default for IPv4 routing and DNS 2021-12-17T00:02:17.744235+0100 \
localhost.localdomain NetworkManager[1137]: &lt;info&gt;  [1639695737.7442] policy: \
set-hostname: set hostname to 'ost-basic-suite-master-host-0' (from DHCPv4) \
2021-12-17T00:02:17.744927+0100 localhost.localdomain dbus-daemon[1073]: [system] \
Activating via systemd: service name='org.freedesktop.resolve1' \
unit='dbus-org.freedesktop.resolve1.service' requested by ':1.9' (uid=0 pid=1137 \
comm="/usr/sbin/NetworkManager --no-daemon " \
label="system_u:system_r:NetworkManager_t:s0") 2021-12-17T00:02:17.745529+0100 \
ost-basic-suite-master-host-0 systemd-hostnamed[1169]: Changed host name to \
'ost-basic-suite-master-host-0' 2021-12-17T00:02:17.745711+0100 \
ost-basic-suite-master-host-0 dbus-daemon[1073]: [system] Activation via systemd \
failed for unit 'dbus-org.freedesktop.resolve1.service': Unit \
dbus-org.freedesktop.resolve1.service not found. 2021-12-17T00:02:17.747344+0100 \
ost-basic-suite-master-host-0 NetworkManager[1137]: &lt;info&gt;  [1639695737.7473] device \
(eth0): state change: ip-config -&gt; ip-check (reason 'none', sys-iface-state: \
'managed') 2021-12-17T00:02:17.756253+0100 ost-basic-suite-master-host-0 \
NetworkManager[1137]: &lt;info&gt;  [1639695737.7562] device (eth0): state change: ip-check \
-&gt; secondaries (reason 'none', sys-iface-state: 'managed') \
2021-12-17T00:02:17.756400+0100 ost-basic-suite-master-host-0 NetworkManager[1137]: \
&lt;info&gt;  [1639695737.7563] device (eth0): state change: secondaries -&gt; activated \
(reason 'none', sys-iface-state: 'managed') 2021-12-17T00:02:17.756686+0100 \
ost-basic-suite-master-host-0 NetworkManager[1137]: &lt;info&gt;  [1639695737.7566] device \
(eth0): Activation: successful, device activated. 2021-12-17T00:02:17.757030+0100 \
ost-basic-suite-master-host-0 NetworkManager[1137]: &lt;info&gt;  [1639695737.7570] \
manager: NetworkManager state is now CONNECTED_GLOBAL 2021-12-17T00:02:17.759257+0100 \
ost-basic-suite-master-host-0 NetworkManager[1137]: &lt;info&gt;  [1639695737.7592] device \
(eth1): state change: config -&gt; ip-config (reason 'none', sys-iface-state: 'managed') \
2021-12-17T00:02:17.759657+0100 ost-basic-suite-master-host-0 NetworkManager[1137]: \
&lt;info&gt;  [1639695737.7596] dhcp4 (eth1): activation: beginning transaction (timeout in \
45 seconds) 2021-12-17T00:02:17.761392+0100 ost-basic-suite-master-host-0 \
NetworkManager[1137]: &lt;info&gt;  [1639695737.7613] dhcp4 (eth1): state changed new \
lease, address=192.168.209.2 2021-12-17T00:02:17.765482+0100 \
ost-basic-suite-master-host-0 NetworkManager[1137]: &lt;info&gt;  [1639695737.7654] device \
(eth1): state change: ip-config -&gt; ip-check (reason 'none', sys-iface-state: \
'managed') 2021-12-17T00:02:17.767118+0100 ost-basic-suite-master-host-0 \
NetworkManager[1137]: &lt;info&gt;  [1639695737.7671] device (eth1): state change: ip-check \
-&gt; secondaries (reason 'none', sys-iface-state: 'managed') \
2021-12-17T00:02:17.767374+0100 ost-basic-suite-master-host-0 NetworkManager[1137]: \
&lt;info&gt;  [1639695737.7673] device (eth1): state change: secondaries -&gt; activated \
(reason 'none', sys-iface-state: 'managed') 2021-12-17T00:02:17.767759+0100 \
ost-basic-suite-master-host-0 NetworkManager[1137]: &lt;info&gt;  [1639695737.7677] device \
(eth1): Activation: successful, device activated. 2021-12-17T00:02:17.779648+0100 \
ost-basic-suite-master-host-0 NetworkManager[1137]: &lt;info&gt;  [1639695737.7796] device \
(eth2): state change: config -&gt; ip-config (reason 'none', sys-iface-state: 'managed') \
2021-12-17T00:02:17.779968+0100 ost-basic-suite-master-host-0 NetworkManager[1137]: \
&lt;info&gt;  [1639695737.7799] dhcp4 (eth2): activation: beginning transaction (timeout in \
45 seconds) 2021-12-17T00:02:17.781268+0100 ost-basic-suite-master-host-0 \
NetworkManager[1137]: &lt;info&gt;  [1639695737.7812] dhcp4 (eth2): state changed new \
lease, address=192.168.209.3 2021-12-17T00:02:17.783721+0100 \
ost-basic-suite-master-host-0 NetworkManager[1137]: &lt;info&gt;  [1639695737.7837] device \
(eth2): state change: ip-config -&gt; ip-check (reason 'none', sys-iface-state: \
'managed') 2021-12-17T00:02:17.792582+0100 ost-basic-suite-master-host-0 \
NetworkManager[1137]: &lt;info&gt;  [1639695737.7925] device (eth2): state change: ip-check \
-&gt; secondaries (reason 'none', sys-iface-state: 'managed') \
2021-12-17T00:02:17.792728+0100 ost-basic-suite-master-host-0 NetworkManager[1137]: \
&lt;info&gt;  [1639695737.7927] device (eth2): state change: secondaries -&gt; activated \
(reason 'none', sys-iface-state: 'managed') 2021-12-17T00:02:17.793021+0100 \
ost-basic-suite-master-host-0 NetworkManager[1137]: &lt;info&gt;  [1639695737.7930] device \
(eth2): Activation: successful, device activated. 2021-12-17T00:02:17.795576+0100 \
ost-basic-suite-master-host-0 NetworkManager[1137]: &lt;info&gt;  [1639695737.7955] device \
(eth3): state change: config -&gt; ip-config (reason 'none', sys-iface-state: 'managed') \
2021-12-17T00:02:17.795882+0100 ost-basic-suite-master-host-0 NetworkManager[1137]: \
&lt;info&gt;  [1639695737.7958] dhcp4 (eth3): activation: beginning transaction (timeout in \
45 seconds) 2021-12-17T00:02:17.797998+0100 ost-basic-suite-master-host-0 \
NetworkManager[1137]: &lt;info&gt;  [1639695737.7979] dhcp4 (eth3): state changed new \
lease, address=192.168.208.3 2021-12-17T00:02:17.801036+0100 \
ost-basic-suite-master-host-0 NetworkManager[1137]: &lt;info&gt;  [1639695737.8010] device \
(eth3): state change: ip-config -&gt; ip-check (reason 'none', sys-iface-state: \
'managed') 2021-12-17T00:02:17.802659+0100 ost-basic-suite-master-host-0 \
NetworkManager[1137]: &lt;info&gt;  [1639695737.8026] device (eth3): state change: ip-check \
-&gt; secondaries (reason 'none', sys-iface-state: 'managed') \
2021-12-17T00:02:17.802780+0100 ost-basic-suite-master-host-0 NetworkManager[1137]: \
&lt;info&gt;  [1639695737.8027] device (eth3): state change: secondaries -&gt; activated \
(reason 'none', sys-iface-state: 'managed') 2021-12-17T00:02:17.803049+0100 \
ost-basic-suite-master-host-0 NetworkManager[1137]: &lt;info&gt;  [1639695737.8030] device \
2021-12-17T00:02:17.806523+0100 ost-basic-suite-master-host-0 systemd[1]: Started \
Network Manager Wait Online. 2021-12-17T00:02:17.807497+0100 \
ost-basic-suite-master-host-0 systemd[1]: Reached target Network is Online. \
2021-12-17T00:02:17.809882+0100 ost-basic-suite-master-host-0 systemd[1]: Starting \
System Logging Service... 2021-12-17T00:02:17.811357+0100 \
ost-basic-suite-master-host-0 systemd[1]: Starting Notify NFS peers of a restart... \
2021-12-17T00:02:17.812130+0100 ost-basic-suite-master-host-0 systemd[1]: Reached \
target Remote File Systems (Pre). 2021-12-17T00:02:17.813165+0100 \
ost-basic-suite-master-host-0 systemd[1]: Reached target Remote File Systems. \
2021-12-17T00:02:17.814903+0100 ost-basic-suite-master-host-0 systemd[1]: Starting \
Crash recovery kernel arming... 2021-12-17T00:02:17.816426+0100 \
ost-basic-suite-master-host-0 systemd[1]: Starting Permit User Sessions... \
2021-12-17T00:02:17.822806+0100 ost-basic-suite-master-host-0 systemd[1]: Starting \
Virtualization daemon... 2021-12-17T00:02:17.930565+0100 \
ost-basic-suite-master-host-0 sm-notify[1356]: Version 2.3.3 starting \
2021-12-17T00:02:17.932786+0100 ost-basic-suite-master-host-0 systemd[1]: Started \
Notify NFS peers of a restart. 2021-12-17T00:02:18.207774+0100 \
ost-basic-suite-master-host-0 systemd[1]: Started Permit User Sessions. \
2021-12-17T00:02:18.214449+0100 ost-basic-suite-master-host-0 systemd[1]: Started \
Getty on tty1. 2021-12-17T00:02:18.216028+0100 ost-basic-suite-master-host-0 \
systemd[1]: Started Serial Getty on ttyS0. 2021-12-17T00:02:18.216760+0100 \
ost-basic-suite-master-host-0 systemd[1]: Reached target Login Prompts. \
2021-12-17T00:02:18.220298+0100 ost-basic-suite-master-host-0 rsyslogd[1355]: [origin \
software="rsyslogd" swVersion="8.2102.0-6.el8" x-pid="1355" \
x-info="https://www.rsyslog.com"] start 2021-12-17T00:02:18.231938+0100 \
ost-basic-suite-master-host-0 systemd[1]: Started Command Scheduler. \
2021-12-17T00:02:18.233571+0100 ost-basic-suite-master-host-0 systemd[1]: Started \
System Logging Service. 2021-12-17T00:02:18.242394+0100 ost-basic-suite-master-host-0 \
systemd[1]: Started Dynamic System Tuning Daemon. 2021-12-17T00:02:18.243712+0100 \
ost-basic-suite-master-host-0 rsyslogd[1355]: imjournal: No statefile exists, \
/var/lib/rsyslog/imjournal.state will be created (ignore if this is first run): No \
such file or directory [v8.2102.0-6.el8 try https://www.rsyslog.com/e/2040 ] \
2021-12-17T00:02:18.274143+0100 ost-basic-suite-master-host-0 crond[1423]: (CRON) \
STARTUP (1.5.2) 2021-12-17T00:02:18.285630+0100 ost-basic-suite-master-host-0 \
crond[1423]: (CRON) INFO (RANDOM_DELAY will be scaled with factor 49% if used.) \
2021-12-17T00:02:18.292297+0100 ost-basic-suite-master-host-0 rsyslogd[1355]: \
imjournal: journal files changed, reloading...  [v8.2102.0-6.el8 try \
https://www.rsyslog.com/e/0 ] 2021-12-17T00:02:18.295458+0100 \
ost-basic-suite-master-host-0 crond[1423]: (CRON) INFO (running with inotify support) \
2021-12-17T00:02:18.371850+0100 ost-basic-suite-master-host-0 systemd[1]: \
iscsi.service: Unit cannot be reloaded because it is inactive. \
2021-12-17T00:02:18.973701+0100 ost-basic-suite-master-host-0 kdumpctl[1357]: kdump: \
No kdump initial ramdisk found. 2021-12-17T00:02:18.973701+0100 \
ost-basic-suite-master-host-0 kdumpctl[1357]: kdump: Rebuilding \
/boot/initramfs-4.18.0-348.2.1.el8_5.x86_64kdump.img 2021-12-17T00:02:19.121406+0100 \
ost-basic-suite-master-host-0 systemd[1]: Started Virtualization daemon. \
2021-12-17T00:02:19.122725+0100 ost-basic-suite-master-host-0 systemd[1]: Reached \
target Multi-User System. 2021-12-17T00:02:19.124585+0100 \
ost-basic-suite-master-host-0 systemd[1]: Starting Update UTMP about System Runlevel \
Changes... 2021-12-17T00:02:19.232485+0100 ost-basic-suite-master-host-0 \
chronyd[1111]: Received KoD RATE from 94.198.159.10 2021-12-17T00:02:19.308811+0100 \
ost-basic-suite-master-host-0 systemd[1]: systemd-update-utmp-runlevel.service: \
Succeeded. 2021-12-17T00:02:19.309113+0100 ost-basic-suite-master-host-0 systemd[1]: \
Started Update UTMP about System Runlevel Changes. 2021-12-17T00:02:19.425207+0100 \
ost-basic-suite-master-host-0 NetworkManager[1137]: &lt;info&gt;  [1639695739.4249] dhcp6 \
(eth2): activation: beginning transaction (timeout in 45 seconds) \
2021-12-17T00:02:19.425974+0100 ost-basic-suite-master-host-0 NetworkManager[1137]: \
&lt;info&gt;  [1639695739.4259] policy: set 'Wired connection 3' (eth2) as default for IPv6 \
routing and DNS 2021-12-17T00:02:19.426503+0100 ost-basic-suite-master-host-0 \
NetworkManager[1137]: &lt;info&gt;  [1639695739.4264] dhcp6 (eth2): state changed new \
lease, address=fd8f:1391:3a82:209::c0a8:d103 2021-12-17T00:02:19.590472+0100 \
ost-basic-suite-master-host-0 NetworkManager[1137]: &lt;info&gt;  [1639695739.5904] dhcp6 \
(eth3): activation: beginning transaction (timeout in 45 seconds) \
2021-12-17T00:02:19.592045+0100 ost-basic-suite-master-host-0 NetworkManager[1137]: \
&lt;info&gt;  [1639695739.5920] dhcp6 (eth3): state changed new lease, \
address=fd8f:1391:3a82:208::c0a8:d003 2021-12-17T00:02:19.712922+0100 \
ost-basic-suite-master-host-0 NetworkManager[1137]: &lt;info&gt;  [1639695739.7129] \
manager: (virbr0): new Bridge device (/org/freedesktop/NetworkManager/Devices/6) \
2021-12-17T00:02:19.713458+0100 ost-basic-suite-master-host-0 systemd[1]: \
iscsi.service: Unit cannot be reloaded because it is inactive. \
2021-12-17T00:02:19.718662+0100 ost-basic-suite-master-host-0 systemd-udevd[1561]: \
Using default interface naming scheme 'rhel-8.0'. 2021-12-17T00:02:19.748987+0100 \
ost-basic-suite-master-host-0 systemd-udevd[1561]: link_config: autonegotiation is \
unset or enabled, the speed and duplex are not writable. \
2021-12-17T00:02:19.800694+0100 ost-basic-suite-master-host-0 NetworkManager[1137]: \
&lt;info&gt;  [1639695739.8005] dhcp6 (eth0): activation: beginning transaction (timeout in \
45 seconds) 2021-12-17T00:02:19.801144+0100 ost-basic-suite-master-host-0 \
NetworkManager[1137]: &lt;info&gt;  [1639695739.8011] policy: set 'Wired connection 1' \
(eth0) as default for IPv6 routing and DNS 2021-12-17T00:02:19.816570+0100 \
ost-basic-suite-master-host-0 NetworkManager[1137]: &lt;info&gt;  [1639695739.8165] dhcp6 \
(eth0): state changed new lease, address=fd8f:1391:3a82:210::c0a8:d203 \
2021-12-17T00:02:19.940706+0100 ost-basic-suite-master-host-0 NetworkManager[1137]: \
&lt;info&gt;  [1639695739.9406] dhcp6 (eth1): activation: beginning transaction (timeout in \
45 seconds) 2021-12-17T00:02:19.941637+0100 ost-basic-suite-master-host-0 \
NetworkManager[1137]: &lt;info&gt;  [1639695739.9416] dhcp6 (eth1): state changed new \
lease, address=fd8f:1391:3a82:209::c0a8:d102 2021-12-17T00:02:20.614337+0100 \
ost-basic-suite-master-host-0 rngd[1105]: [jitter]: Enabling JITTER rng support \
2021-12-17T00:02:20.614337+0100 ost-basic-suite-master-host-0 rngd[1105]: [jitter]: \
Initialized 2021-12-17T00:02:20.878856+0100 ost-basic-suite-master-host-0 systemd[1]: \
iscsi.service: Unit cannot be reloaded because it is inactive. \
2021-12-17T00:02:21.820780+0100 ost-basic-suite-master-host-0 NetworkManager[1137]: \
&lt;info&gt;  [1639695741.8206] device (virbr0): state change: unmanaged -&gt; unavailable \
(reason 'connection-assumed', sys-iface-state: 'external') \
2021-12-17T00:02:21.822421+0100 ost-basic-suite-master-host-0 NetworkManager[1137]: \
&lt;info&gt;  [1639695741.8224] device (virbr0): state change: unavailable -&gt; disconnected \
(reason 'connection-assumed', sys-iface-state: 'external') \
2021-12-17T00:02:21.822879+0100 ost-basic-suite-master-host-0 NetworkManager[1137]: \
&lt;info&gt;  [1639695741.8228] device (virbr0): Activation: starting connection 'virbr0' \
(1fb16a91-e1ec-4fd9-8054-c940ed6331c5) 2021-12-17T00:02:21.822936+0100 \
ost-basic-suite-master-host-0 NetworkManager[1137]: &lt;info&gt;  [1639695741.8229] device \
(virbr0): state change: disconnected -&gt; prepare (reason 'none', sys-iface-state: \
'external') 2021-12-17T00:02:21.823059+0100 ost-basic-suite-master-host-0 \
NetworkManager[1137]: &lt;info&gt;  [1639695741.8230] device (virbr0): state change: \
prepare -&gt; config (reason 'none', sys-iface-state: 'external') \
2021-12-17T00:02:21.823147+0100 ost-basic-suite-master-host-0 NetworkManager[1137]: \
&lt;info&gt;  [1639695741.8231] device (virbr0): state change: config -&gt; ip-config (reason \
'none', sys-iface-state: 'external') 2021-12-17T00:02:21.823244+0100 \
ost-basic-suite-master-host-0 NetworkManager[1137]: &lt;info&gt;  [1639695741.8232] device \
(virbr0): state change: ip-config -&gt; ip-check (reason 'none', sys-iface-state: \
'external') 2021-12-17T00:02:21.835858+0100 ost-basic-suite-master-host-0 \
NetworkManager[1137]: &lt;info&gt;  [1639695741.8358] device (virbr0): state change: \
ip-check -&gt; secondaries (reason 'none', sys-iface-state: 'external') \
2021-12-17T00:02:21.835995+0100 ost-basic-suite-master-host-0 NetworkManager[1137]: \
&lt;info&gt;  [1639695741.8359] device (virbr0): state change: secondaries -&gt; activated \
(reason 'none', sys-iface-state: 'external') 2021-12-17T00:02:21.836273+0100 \
ost-basic-suite-master-host-0 NetworkManager[1137]: &lt;info&gt;  [1639695741.8362] device \
(virbr0): Activation: successful, device activated. 2021-12-17T00:02:21.966396+0100 \
ost-basic-suite-master-host-0 systemd[1]: iscsi.service: Unit cannot be reloaded \
because it is inactive. 2021-12-17T00:02:22.487966+0100 ost-basic-suite-master-host-0 \
kdumpctl[1357]: kdump: Warning: There might not be enough space to save a vmcore. \
2021-12-17T00:02:22.487966+0100 ost-basic-suite-master-host-0 kdumpctl[1357]: kdump:  \
The size of /dev/vda5 should be greater than 1602260 kilo bytes. \
2021-12-17T00:02:22.545867+0100 ost-basic-suite-master-host-0 dnsmasq[1830]: \
listening on virbr0(#6): 192.168.122.1 2021-12-17T00:02:22.621908+0100 \
ost-basic-suite-master-host-0 dnsmasq[1883]: started, version 2.79 cachesize 150 \
2021-12-17T00:02:22.621919+0100 ost-basic-suite-master-host-0 dnsmasq[1883]: compile \
time options: IPv6 GNU-getopt DBus no-i18n IDN2 DHCP DHCPv6 no-Lua TFTP no-conntrack \
ipset auth DNSSEC loop-detect inotify 2021-12-17T00:02:22.621937+0100 \
ost-basic-suite-master-host-0 dnsmasq-dhcp[1883]: DHCP, IP range 192.168.122.2 -- \
192.168.122.254, lease time 1h 2021-12-17T00:02:22.621942+0100 \
ost-basic-suite-master-host-0 dnsmasq-dhcp[1883]: DHCP, sockets bound exclusively to \
interface virbr0 2021-12-17T00:02:22.622101+0100 ost-basic-suite-master-host-0 \
dnsmasq[1883]: reading /etc/resolv.conf 2021-12-17T00:02:22.622107+0100 \
ost-basic-suite-master-host-0 dnsmasq[1883]: using nameserver 192.168.210.1#53 \
2021-12-17T00:02:22.622120+0100 ost-basic-suite-master-host-0 dnsmasq[1883]: using \
nameserver fe80::5054:ff:fe3b:5d92%eth0#53 2021-12-17T00:02:22.622125+0100 \
ost-basic-suite-master-host-0 dnsmasq[1883]: using nameserver \
fd8f:1391:3a82:210::1#53 2021-12-17T00:02:22.623456+0100 \
ost-basic-suite-master-host-0 dnsmasq[1883]: read /etc/hosts - 2 addresses \
2021-12-17T00:02:22.623483+0100 ost-basic-suite-master-host-0 dnsmasq[1883]: read \
/var/lib/libvirt/dnsmasq/default.addnhosts - 0 addresses \
2021-12-17T00:02:22.623506+0100 ost-basic-suite-master-host-0 dnsmasq-dhcp[1883]: \
read /var/lib/libvirt/dnsmasq/default.hostsfile 2021-12-17T00:02:22.969523+0100 \
ost-basic-suite-master-host-0 sshd[1897]: error: Unable to load host key: \
/etc/ssh/ssh_host_ed25519_key 2021-12-17T00:02:23.003669+0100 \
ost-basic-suite-master-host-0 systemd[1]: iscsi.service: Unit cannot be reloaded \
because it is inactive. 2021-12-17T00:02:23.328491+0100 ost-basic-suite-master-host-0 \
dracut[1927]: dracut-049-191.git20210920.el8 2021-12-17T00:02:23.422061+0100 \
ost-basic-suite-master-host-0 sshd[1897]: Accepted publickey for root from \
fd8f:1391:3a82:210::1 port 39910 ssh2: RSA \
SHA256:P5xCNqbXoHPcOI4WCD9zlIFH0cP8MZZT4FZD25dsot0 2021-12-17T00:02:23.648975+0100 \
ost-basic-suite-master-host-0 systemd[1]: Created slice User Slice of UID 0. \
2021-12-17T00:02:23.649825+0100 ost-basic-suite-master-host-0 systemd[1]: Starting \
User runtime directory /run/user/0... 2021-12-17T00:02:23.655198+0100 \
ost-basic-suite-master-host-0 systemd-logind[1125]: New session 1 of user root. \
2021-12-17T00:02:23.822197+0100 ost-basic-suite-master-host-0 systemd[1]: Started \
User runtime directory /run/user/0. 2021-12-17T00:02:23.823263+0100 \
ost-basic-suite-master-host-0 systemd[1]: Starting User Manager for UID 0... \
2021-12-17T00:02:23.880588+0100 ost-basic-suite-master-host-0 systemd[1957]: \
pam_unix(systemd-user:session): session opened for user root by (uid=0) \
2021-12-17T00:02:23.986451+0100 ost-basic-suite-master-host-0 chronyd[1111]: Selected \
source 84.245.9.254 (2.centos.pool.ntp.org) 2021-12-17T00:02:23.986504+0100 \
ost-basic-suite-master-host-0 chronyd[1111]: System clock wrong by 3600.482928 \
seconds 2021-12-17T01:02:24.469451+0100 ost-basic-suite-master-host-0 chronyd[1111]: \
System clock was stepped by 3600.482928 seconds 2021-12-17T01:02:24.469551+0100 \
ost-basic-suite-master-host-0 chronyd[1111]: System clock TAI offset set to 37 \
seconds 2021-12-17T01:02:24.472272+0100 ost-basic-suite-master-host-0 systemd[1]: \
Starting system activity accounting tool... 2021-12-17T01:02:24.473053+0100 \
ost-basic-suite-master-host-0 systemd[1]: Starting Generate a daily summary of \
process accounting... 2021-12-17T01:02:24.515372+0100 ost-basic-suite-master-host-0 \
systemd[1]: sysstat-collect.service: Succeeded. 2021-12-17T01:02:24.515666+0100 \
ost-basic-suite-master-host-0 systemd[1]: Started system activity accounting tool. \
2021-12-17T01:02:24.551785+0100 ost-basic-suite-master-host-0 systemd[1]: \
sysstat-summary.service: Succeeded. 2021-12-17T01:02:24.552070+0100 \
ost-basic-suite-master-host-0 systemd[1]: Started Generate a daily summary of process \
accounting. 2021-12-17T01:02:24.835459+0100 ost-basic-suite-master-host-0 \
systemd[1957]: Starting D-Bus User Message Bus Socket. \
2021-12-17T01:02:24.835510+0100 ost-basic-suite-master-host-0 systemd[1957]: Reached \
target Timers. 2021-12-17T01:02:24.835527+0100 ost-basic-suite-master-host-0 \
systemd[1957]: Reached target Paths. 2021-12-17T01:02:24.855422+0100 \
ost-basic-suite-master-host-0 dracut[1939]: Executing: /usr/bin/dracut --add \
kdumpbase --quiet --hostonly --hostonly-cmdline --hostonly-i18n --hostonly-mode \
strict -o "plymouth dash resume ifcfg earlykdump" --compress=xz --mount \
"/dev/disk/by-uuid/7623e232-4094-4e52-8105-2f75fb0c3231 /kdumproot/var xfs \
rw,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota,nofail,x-systemd.before=initrd-fs.target" \
--no-hostonly-default-device -f /boot/initramfs-4.18.0-348.2.1.el8_5.x86_64kdump.img \
4.18.0-348.2.1.el8_5.x86_64 2021-12-17T01:02:25.029514+0100 \
ost-basic-suite-master-host-0 systemd[1957]: Listening on D-Bus User Message Bus \
Socket. 2021-12-17T01:02:25.029971+0100 ost-basic-suite-master-host-0 systemd[1957]: \
Reached target Sockets. 2021-12-17T01:02:25.029985+0100 ost-basic-suite-master-host-0 \
systemd[1957]: Reached target Basic System. 2021-12-17T01:02:25.030095+0100 \
ost-basic-suite-master-host-0 systemd[1957]: Reached target Default. \
2021-12-17T01:02:25.030111+0100 ost-basic-suite-master-host-0 systemd[1957]: Startup \
finished in 524ms. 2021-12-17T01:02:25.040817+0100 ost-basic-suite-master-host-0 \
systemd[1]: Started User Manager for UID 0. 2021-12-17T01:02:25.041482+0100 \
ost-basic-suite-master-host-0 systemd[1]: Started Session 1 of user root. \
2021-12-17T01:02:25.080818+0100 ost-basic-suite-master-host-0 sshd[1897]: \
pam_unix(sshd:session): session opened for user root by (uid=0) \
2021-12-17T01:02:26.982293+0100 ost-basic-suite-master-host-0 dracut[1939]: dracut \
module 'busybox' will not be installed, because command 'busybox' could not be found! \
2021-12-17T01:02:27.738260+0100 ost-basic-suite-master-host-0 dracut[1939]: dracut \
module 'ifcfg' will not be installed, because it's in the list to be omitted! \
2021-12-17T01:02:28.355482+0100 ost-basic-suite-master-host-0 platform-python[2329]: \
ansible-ping Invoked with data=pong 2021-12-17T01:02:29.752207+0100 \
ost-basic-suite-master-host-0 dracut[1939]: dracut module 'btrfs' will not be \
installed, because command 'btrfs' could not be found! \
2021-12-17T01:02:29.763885+0100 ost-basic-suite-master-host-0 dracut[1939]: dracut \
module 'dmraid' will not be installed, because command 'dmraid' could not be found! \
2021-12-17T01:02:29.990179+0100 ost-basic-suite-master-host-0 dracut[1939]: dracut \
module 'cifs' will not be installed, because command 'mount.cifs' could not be found! \
2021-12-17T01:02:30.109016+0100 ost-basic-suite-master-host-0 dracut[1939]: dracut \
module 'resume' will not be installed, because it's in the list to be omitted! \
2021-12-17T01:02:30.209803+0100 ost-basic-suite-master-host-0 dracut[1939]: dracut \
module 'earlykdump' will not be installed, because it's in the list to be omitted! \
2021-12-17T01:02:30.343841+0100 ost-basic-suite-master-host-0 dracut[1939]: memstrack \
is available 2021-12-17T01:02:30.395073+0100 ost-basic-suite-master-host-0 \
dracut[1939]: dracut module 'busybox' will not be installed, because command \
'busybox' could not be found! 2021-12-17T01:02:30.445769+0100 \
ost-basic-suite-master-host-0 dracut[1939]: dracut module 'btrfs' will not be \
installed, because command 'btrfs' could not be found! \
2021-12-17T01:02:30.454666+0100 ost-basic-suite-master-host-0 dracut[1939]: dracut \
module 'dmraid' will not be installed, because command 'dmraid' could not be found! \
2021-12-17T01:02:30.581409+0100 ost-basic-suite-master-host-0 dracut[1939]: dracut \
module 'cifs' will not be installed, because command 'mount.cifs' could not be found! \
2021-12-17T01:02:30.863993+0100 ost-basic-suite-master-host-0 dracut[1939]: *** \
Including module: bash *** 2021-12-17T01:02:30.899940+0100 \
ost-basic-suite-master-host-0 dracut[1939]: *** Including module: systemd *** \
2021-12-17T01:02:31.875736+0100 ost-basic-suite-master-host-0 dracut[1939]: *** \
Including module: fips *** 2021-12-17T01:02:32.860341+0100 \
ost-basic-suite-master-host-0 dracut[1939]: *** Including module: systemd-initrd *** \
2021-12-17T01:02:32.990342+0100 ost-basic-suite-master-host-0 dracut[1939]: *** \
Including module: watchdog-modules *** 2021-12-17T01:02:33.098776+0100 \
ost-basic-suite-master-host-0 dracut[1939]: *** Including module: nss-softokn *** \
2021-12-17T01:02:33.127882+0100 ost-basic-suite-master-host-0 dracut[1939]: *** \
Including module: rngd *** 2021-12-17T01:02:33.259347+0100 \
ost-basic-suite-master-host-0 dracut[1939]: *** Including module: i18n *** \
2021-12-17T01:02:33.766849+0100 ost-basic-suite-master-host-0 dracut[1939]: *** \
Including module: network-manager *** 2021-12-17T01:02:34.083818+0100 \
ost-basic-suite-master-host-0 systemd[1]: NetworkManager-dispatcher.service: \
Succeeded. 2021-12-17T01:02:34.262289+0100 ost-basic-suite-master-host-0 \
dracut[1939]: *** Including module: network *** 2021-12-17T01:02:34.368916+0100 \
ost-basic-suite-master-host-0 dracut[1939]: *** Including module: clevis *** \
2021-12-17T01:02:34.502364+0100 ost-basic-suite-master-host-0 dracut[1939]: *** \
Including module: clevis-pin-sss *** 2021-12-17T01:02:34.528231+0100 \
ost-basic-suite-master-host-0 dracut[1939]: *** Including module: clevis-pin-tang *** \
2021-12-17T01:02:34.561108+0100 ost-basic-suite-master-host-0 dracut[1939]: *** \
Including module: clevis-pin-tpm2 *** 2021-12-17T01:02:34.689307+0100 \
ost-basic-suite-master-host-0 dracut[1939]: *** Including module: prefixdevname *** \
2021-12-17T01:02:34.720167+0100 ost-basic-suite-master-host-0 dracut[1939]: *** \
Including module: crypt *** 2021-12-17T01:02:34.886303+0100 \
ost-basic-suite-master-host-0 dracut[1939]: *** Including module: dm *** \
2021-12-17T01:02:35.172862+0100 ost-basic-suite-master-host-0 dracut[1939]: Skipping \
udev rule: 64-device-mapper.rules 2021-12-17T01:02:35.175299+0100 \
ost-basic-suite-master-host-0 dracut[1939]: Skipping udev rule: \
60-persistent-storage-dm.rules 2021-12-17T01:02:35.177677+0100 \
ost-basic-suite-master-host-0 dracut[1939]: Skipping udev rule: 55-dm.rules \
2021-12-17T01:02:35.383054+0100 ost-basic-suite-master-host-0 dracut[1939]: *** \
Including module: kernel-modules *** 2021-12-17T01:02:35.904638+0100 \
ost-basic-suite-master-host-0 dracut[1939]: *** Including module: \
kernel-modules-extra *** 2021-12-17T01:02:35.921994+0100 \
ost-basic-suite-master-host-0 dracut[1939]:   kernel-modules-extra: configuration \
source "/run/depmod.d/" does not exist 2021-12-17T01:02:35.925903+0100 \
ost-basic-suite-master-host-0 dracut[1939]:   kernel-modules-extra: configuration \
source "/lib/depmod.d/" does not exist 2021-12-17T01:02:35.951731+0100 \
ost-basic-suite-master-host-0 dracut[1939]:   kernel-modules-extra: parsing \
configuration file "/etc/depmod.d//dist.conf" 2021-12-17T01:02:35.956395+0100 \
ost-basic-suite-master-host-0 dracut[1939]:   kernel-modules-extra: \
/etc/depmod.d//dist.conf: added "updates extra built-in weak-updates" to the list of \
search directories 2021-12-17T01:02:35.977793+0100 ost-basic-suite-master-host-0 \
dracut[1939]: *** Including module: kernel-network-modules *** \
2021-12-17T01:02:36.109304+0100 ost-basic-suite-master-host-0 dracut[1939]: *** \
Including module: qemu *** 2021-12-17T01:02:36.174347+0100 \
ost-basic-suite-master-host-0 dracut[1939]: *** Including module: fstab-sys *** \
2021-12-17T01:02:36.211337+0100 ost-basic-suite-master-host-0 dracut[1939]: *** \
Including module: rootfs-block *** 2021-12-17T01:02:36.312430+0100 \
ost-basic-suite-master-host-0 dracut[1939]: *** Including module: terminfo *** \
2021-12-17T01:02:36.379385+0100 ost-basic-suite-master-host-0 dracut[1939]: *** \
Including module: udev-rules *** 2021-12-17T01:02:37.029207+0100 \
ost-basic-suite-master-host-0 dracut[1939]: Skipping udev rule: 91-permissions.rules \
2021-12-17T01:02:37.032014+0100 ost-basic-suite-master-host-0 dracut[1939]: Skipping \
udev rule: 80-drivers-modprobe.rules 2021-12-17T01:02:37.158983+0100 \
ost-basic-suite-master-host-0 dracut[1939]: *** Including module: biosdevname *** \
2021-12-17T01:02:37.253309+0100 ost-basic-suite-master-host-0 dracut[1939]: *** \
Including module: dracut-systemd *** 2021-12-17T01:02:38.439155+0100 \
ost-basic-suite-master-host-0 dracut[1939]: *** Including module: usrmount *** \
2021-12-17T01:02:38.451286+0100 ost-basic-suite-master-host-0 dracut[1939]: *** \
Including module: base *** 2021-12-17T01:02:38.795831+0100 \
ost-basic-suite-master-host-0 dracut[1939]: *** Including module: fs-lib *** \
2021-12-17T01:02:38.913573+0100 ost-basic-suite-master-host-0 dracut[1939]: *** \
Including module: kdumpbase *** 2021-12-17T01:02:39.661360+0100 \
ost-basic-suite-master-host-0 dracut[1939]: *** Including module: memstrack *** \
2021-12-17T01:02:39.859206+0100 ost-basic-suite-master-host-0 dracut[1939]: *** \
Including module: microcode_ctl-fw_dir_override *** 2021-12-17T01:02:39.866569+0100 \
ost-basic-suite-master-host-0 dracut[1939]:   microcode_ctl module: mangling fw_dir \
2021-12-17T01:02:39.868860+0100 ost-basic-suite-master-host-0 dracut[1939]:     \
microcode_ctl: reset fw_dir to "/lib/firmware/updates /lib/firmware" \
2021-12-17T01:02:39.895383+0100 ost-basic-suite-master-host-0 dracut[1939]:     \
microcode_ctl: processing data directory  \
"/usr/share/microcode_ctl/ucode_with_caveats/intel"... \
2021-12-17T01:02:39.926354+0100 ost-basic-suite-master-host-0 dracut[1939]:       \
microcode_ctl: intel: caveats check for kernel version "4.18.0-348.2.1.el8_5.x86_64" \
passed, adding "/usr/share/microcode_ctl/ucode_with_caveats/intel" to fw_dir variable \
2021-12-17T01:02:39.928526+0100 ost-basic-suite-master-host-0 dracut[1939]:     \
microcode_ctl: processing data directory  \
"/usr/share/microcode_ctl/ucode_with_caveats/intel-06-2d-07"... \
2021-12-17T01:02:39.953296+0100 ost-basic-suite-master-host-0 dracut[1939]:     \
microcode_ctl: configuration "intel-06-2d-07" is ignored \
2021-12-17T01:02:39.956032+0100 ost-basic-suite-master-host-0 dracut[1939]:     \
microcode_ctl: processing data directory  \
"/usr/share/microcode_ctl/ucode_with_caveats/intel-06-4e-03"... \
2021-12-17T01:02:39.980361+0100 ost-basic-suite-master-host-0 dracut[1939]:     \
microcode_ctl: configuration "intel-06-4e-03" is ignored \
2021-12-17T01:02:39.982222+0100 ost-basic-suite-master-host-0 dracut[1939]:     \
microcode_ctl: processing data directory  \
"/usr/share/microcode_ctl/ucode_with_caveats/intel-06-4f-01"... \
2021-12-17T01:02:40.011231+0100 ost-basic-suite-master-host-0 dracut[1939]:     \
microcode_ctl: configuration "intel-06-4f-01" is ignored \
2021-12-17T01:02:40.012957+0100 ost-basic-suite-master-host-0 dracut[1939]:     \
microcode_ctl: processing data directory  \
"/usr/share/microcode_ctl/ucode_with_caveats/intel-06-55-04"... \
2021-12-17T01:02:40.039216+0100 ost-basic-suite-master-host-0 dracut[1939]:     \
microcode_ctl: configuration "intel-06-55-04" is ignored \
2021-12-17T01:02:40.040880+0100 ost-basic-suite-master-host-0 dracut[1939]:     \
microcode_ctl: processing data directory  \
"/usr/share/microcode_ctl/ucode_with_caveats/intel-06-5e-03"... \
2021-12-17T01:02:40.065616+0100 ost-basic-suite-master-host-0 dracut[1939]:     \
microcode_ctl: configuration "intel-06-5e-03" is ignored \
2021-12-17T01:02:40.067371+0100 ost-basic-suite-master-host-0 dracut[1939]:     \
microcode_ctl: processing data directory  \
"/usr/share/microcode_ctl/ucode_with_caveats/intel-06-8c-01"... \
2021-12-17T01:02:40.089738+0100 ost-basic-suite-master-host-0 dracut[1939]:     \
microcode_ctl: configuration "intel-06-8c-01" is ignored \
2021-12-17T01:02:40.091481+0100 ost-basic-suite-master-host-0 dracut[1939]:     \
microcode_ctl: processing data directory  \
"/usr/share/microcode_ctl/ucode_with_caveats/intel-06-8e-9e-0x-0xca"... \
2021-12-17T01:02:40.118202+0100 ost-basic-suite-master-host-0 dracut[1939]:     \
microcode_ctl: configuration "intel-06-8e-9e-0x-0xca" is ignored \
2021-12-17T01:02:40.119888+0100 ost-basic-suite-master-host-0 dracut[1939]:     \
microcode_ctl: processing data directory  \
"/usr/share/microcode_ctl/ucode_with_caveats/intel-06-8e-9e-0x-dell"... \
2021-12-17T01:02:40.144584+0100 ost-basic-suite-master-host-0 dracut[1939]:     \
microcode_ctl: configuration "intel-06-8e-9e-0x-dell" is ignored \
2021-12-17T01:02:40.146781+0100 ost-basic-suite-master-host-0 dracut[1939]:     \
microcode_ctl: final fw_dir: "/usr/share/microcode_ctl/ucode_with_caveats/intel \
/lib/firmware/updates /lib/firmware" 2021-12-17T01:02:40.151306+0100 \
ost-basic-suite-master-host-0 dracut[1939]: *** Including module: shutdown *** \
2021-12-17T01:02:40.260316+0100 ost-basic-suite-master-host-0 dracut[1939]: *** \
Including module: squash *** 2021-12-17T01:02:40.317303+0100 \
ost-basic-suite-master-host-0 dracut[1939]: *** Including modules done *** \
2021-12-17T01:02:40.366445+0100 ost-basic-suite-master-host-0 dracut[1939]: *** \
Installing kernel module dependencies *** 2021-12-17T01:02:40.579351+0100 \
ost-basic-suite-master-host-0 dracut[1939]: *** Installing kernel module dependencies \
done *** 2021-12-17T01:02:40.625841+0100 ost-basic-suite-master-host-0 dracut[1939]: \
*** Resolving executable dependencies *** 2021-12-17T01:02:41.756618+0100 \
ost-basic-suite-master-host-0 dracut[1939]: *** Resolving executable dependencies \
done*** 2021-12-17T01:02:41.865892+0100 ost-basic-suite-master-host-0 dracut[1939]: \
*** Hardlinking files *** 2021-12-17T01:02:41.878284+0100 \
ost-basic-suite-master-host-0 dracut[1939]: *** Hardlinking files done *** \
2021-12-17T01:02:41.915285+0100 ost-basic-suite-master-host-0 dracut[1939]: *** \
Generating early-microcode cpio image *** 2021-12-17T01:02:41.927256+0100 \
ost-basic-suite-master-host-0 dracut[1939]: *** Constructing GenuineIntel.bin *** \
2021-12-17T01:02:41.948538+0100 ost-basic-suite-master-host-0 dracut[1939]: *** \
Constructing GenuineIntel.bin *** 2021-12-17T01:02:41.968658+0100 \
ost-basic-suite-master-host-0 dracut[1939]: *** Store current command line parameters \
*** 2021-12-17T01:02:41.972157+0100 ost-basic-suite-master-host-0 dracut[1939]: \
Stored kernel commandline: 2021-12-17T01:02:41.976273+0100 \
ost-basic-suite-master-host-0 dracut[1939]: rd.driver.pre=iTCO_wdt,lpc_ich \
2021-12-17T01:02:42.057407+0100 ost-basic-suite-master-host-0 dracut[1939]: *** \
Install squash loader *** 2021-12-17T01:02:42.507302+0100 \
ost-basic-suite-master-host-0 dracut[1939]: *** Squashing the files inside the \
initramfs *** 2021-12-17T01:02:48.287217+0100 ost-basic-suite-master-host-0 \
systemd[1]: systemd-hostnamed.service: Succeeded. 2021-12-17T01:02:52.218026+0100 \
ost-basic-suite-master-host-0 dracut[1939]: *** Squashing the files inside the \
initramfs done *** 2021-12-17T01:02:52.221565+0100 ost-basic-suite-master-host-0 \
dracut[1939]: *** Creating image file \
'/boot/initramfs-4.18.0-348.2.1.el8_5.x86_64kdump.img' *** \
2021-12-17T01:02:52.405018+0100 ost-basic-suite-master-host-0 platform-python[6830]: \
ansible-command Invoked with _raw_params=hostnamectl set-hostname $(hostname) \
_uses_shell=True warn=True stdin_add_newline=True strip_empty_ends=True argv=None \
chdir=None executable=None creates=None removes=None stdin=None \
2021-12-17T01:02:52.412360+0100 ost-basic-suite-master-host-0 dracut[1939]: *** \
Creating initramfs image file '/boot/initramfs-4.18.0-348.2.1.el8_5.x86_64kdump.img' \
done *** 2021-12-17T01:02:52.488056+0100 ost-basic-suite-master-host-0 \
dbus-daemon[1073]: [system] Activating via systemd: service \
name='org.freedesktop.hostname1' unit='dbus-org.freedesktop.hostname1.service' \
requested by ':1.20' (uid=0 pid=6853 comm="hostnamectl set-hostname \
ost-basic-suite-master-ho" \
label="unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023") \
2021-12-17T01:02:52.492124+0100 ost-basic-suite-master-host-0 systemd[1]: Starting \
Hostname Service... 2021-12-17T01:02:52.656861+0100 ost-basic-suite-master-host-0 \
dbus-daemon[1073]: [system] Successfully activated service \
'org.freedesktop.hostname1' 2021-12-17T01:02:52.657418+0100 \
ost-basic-suite-master-host-0 systemd[1]: Started Hostname Service. \
2021-12-17T01:02:52.660693+0100 ost-basic-suite-master-host-0 \
systemd-hostnamed[6865]: Changed static host name to 'ost-basic-suite-master-host-0' \
2021-12-17T01:02:52.662437+0100 ost-basic-suite-master-host-0 NetworkManager[1137]: \
&lt;info&gt;  [1639699372.6622] hostname: hostname changed from "localhost.localdomain" to \
"ost-basic-suite-master-host-0" 2021-12-17T01:02:52.665852+0100 \
ost-basic-suite-master-host-0 dbus-daemon[1073]: [system] Activating via systemd: \
service name='org.freedesktop.nm_dispatcher' \
unit='dbus-org.freedesktop.nm-dispatcher.service' requested by ':1.9' (uid=0 pid=1137 \
comm="/usr/sbin/NetworkManager --no-daemon " \
label="system_u:system_r:NetworkManager_t:s0") 2021-12-17T01:02:52.668621+0100 \
ost-basic-suite-master-host-0 systemd[1]: Starting Network Manager Script Dispatcher \
2021-12-17T01:02:52.846549+0100 ost-basic-suite-master-host-0 systemd[1]: Started \
Network Manager Script Dispatcher Service. 2021-12-17T01:02:53.015544+0100 \
ost-basic-suite-master-host-0 kdumpctl[1357]: kdump: kexec: loaded kdump kernel \
2021-12-17T01:02:53.015544+0100 ost-basic-suite-master-host-0 kdumpctl[1357]: kdump: \
Starting kdump: [OK] 2021-12-17T01:02:53.017944+0100 ost-basic-suite-master-host-0 \
systemd[1]: Started Crash recovery kernel arming. 2021-12-17T01:02:53.020803+0100 \
ost-basic-suite-master-host-0 systemd[1]: Startup finished in 3.654s (kernel) + \
7.368s (initrd) + 44.595s (userspace) = 55.618s. 2021-12-17T01:03:00.433890+0100 \
ost-basic-suite-master-host-0 platform-python[7097]: ansible-command Invoked with \
_raw_params=dnf config-manager --disable '*';dnf config-manager --enable dummy;: \
_uses_shell=True warn=True stdin_add_newline=True strip_empty_ends=True argv=None \
chdir=None executable=None creates=None removes=None stdin=None \
2021-12-17T01:03:00.433993+0100 ost-basic-suite-master-host-0 platform-python[7097]: \
ansible-command [WARNING] Consider using the dnf module rather than running 'dnf'.  \
If you need to use command because dnf is insufficient you can add 'warn: false' to \
this command task or set 'command_warnings=False' in ansible.cfg to get rid of this \
message. 2021-12-17T01:03:02.876657+0100 ost-basic-suite-master-host-0 systemd[1]: \
NetworkManager-dispatcher.service: Succeeded. 2021-12-17T01:03:19.813508+0100 \
ost-basic-suite-master-host-0 platform-python[7247]: ansible-yum_repository Invoked \
with name=extra-src-1 description=extra-src-1 \
baseurl=['https://download.copr.fedorainfracloud.org/results/ovirt/ovirt-master-snapshot/centos-stream-8-x86_64'] \
gpgcheck=False sslverify=False reposdir=/etc/yum.repos.d state=present follow=False \
unsafe_writes=False bandwidth=None cost=None deltarpm_metadata_percentage=None \
deltarpm_percentage=None enabled=None enablegroups=None exclude=None \
failovermethod=None file=None gpgcakey=None gpgkey=None http_caching=None \
include=None includepkgs=None ip_resolve=None keepalive=None keepcache=None \
metadata_expire=None metadata_expire_filter=None metalink=None mirrorlist=None \
mirrorlist_expire=None params=None password=NOT_LOGGING_PARAMETER priority=None \
protect=None proxy=None proxy_password=NOT_LOGGING_PARAMETER proxy_username=None \
repo_gpgcheck=None retries=None s3_enabled=None skip_if_unavailable=None \
sslcacert=None ssl_check_cert_permissions=None sslclientcert=None sslclientkey=None \
throttle=None timeout=None ui_repoid_vars=None username=None async=None mode=None \
owner=None group=None seuser=None serole=None selevel=None setype=None \
attributes=None src=None force=None content=NOT_LOGGING_PARAMETER backup=None \
remote_src=None regexp=None delimiter=None directory_mode=None \
2021-12-17T01:03:22.693812+0100 ost-basic-suite-master-host-0 systemd[1]: \
systemd-hostnamed.service: Succeeded. 2021-12-17T01:03:29.554775+0100 \
ost-basic-suite-master-host-0 platform-python[7388]: ansible-ini_file Invoked with \
path=/etc/yum.repos.d/extra-src-1.repo section=extra-src-1 option=module_hotfixes \
value=1 backup=False state=present no_extra_spaces=False allow_no_value=False \
create=True follow=False unsafe_writes=False mode=None owner=None group=None \
seuser=None serole=None selevel=None setype=None attributes=None src=None force=None \
content=NOT_LOGGING_PARAMETER remote_src=None regexp=None delimiter=None \
directory_mode=None 2021-12-17T01:03:39.106482+0100 ost-basic-suite-master-host-0 \
platform-python[7526]: ansible-command Invoked with _raw_params=dnf upgrade \
--nogpgcheck -y --disableplugin versionlock -x \
ovirt-release-master,ovirt-release-master-tested,ovirt-engine-appliance,rhvm-appliance,ovirt-node-ng-image-update,redhat-virtualization-host-image-update \
_uses_shell=True warn=True stdin_add_newline=True strip_empty_ends=True argv=None \
chdir=None executable=None creates=None removes=None stdin=None \
2021-12-17T01:03:39.106614+0100 ost-basic-suite-master-host-0 platform-python[7526]: \
ansible-command [WARNING] Consider using the dnf module rather than running 'dnf'.  \
If you need to use command because dnf is insufficient you can add 'warn: false' to \
this command task or set 'command_warnings=False' in ansible.cfg to get rid of this \
message. 2021-12-17T01:03:44.250969+0100 ost-basic-suite-master-host-0 systemd[1]: \
systemd-modules-load.service: Succeeded. 2021-12-17T01:03:44.252089+0100 \
ost-basic-suite-master-host-0 systemd[1]: Stopped Load Kernel Modules. \
2021-12-17T01:03:44.252480+0100 ost-basic-suite-master-host-0 systemd[1]: Stopping \
Load Kernel Modules... 2021-12-17T01:03:44.254777+0100 ost-basic-suite-master-host-0 \
systemd[1]: Starting Load Kernel Modules... 2021-12-17T01:03:44.344495+0100 \
ost-basic-suite-master-host-0 systemd[1]: Started Load Kernel Modules. \
2021-12-17T01:03:44.443770+0100 ost-basic-suite-master-host-0 systemd[1]: Reloading. \
2021-12-17T01:03:47.112392+0100 ost-basic-suite-master-host-0 sasldblistusers2[7598]: \
_sasldb_getkeyhandle has failed 2021-12-17T01:03:47.112411+0100 \
ost-basic-suite-master-host-0 sasldblistusers2[7598]: DIGEST-MD5 common mech free \
2021-12-17T01:03:47.215446+0100 ost-basic-suite-master-host-0 sssd_nss[1124]: \
Enumeration requested but not enabled 2021-12-17T01:03:48.692062+0100 \
ost-basic-suite-master-host-0 sasldblistusers2[7610]: _sasldb_getkeyhandle has failed \
2021-12-17T01:03:48.692084+0100 ost-basic-suite-master-host-0 sasldblistusers2[7610]: \
DIGEST-MD5 common mech free 2021-12-17T01:03:51.942237+0100 \
ost-basic-suite-master-host-0 systemd[1]: Stopping Virtualization daemon... \
2021-12-17T01:03:51.958167+0100 ost-basic-suite-master-host-0 systemd[1]: \
libvirtd.service: Succeeded. 2021-12-17T01:03:51.958237+0100 \
ost-basic-suite-master-host-0 systemd[1]: Stopped Virtualization daemon. \
2021-12-17T01:03:53.316499+0100 ost-basic-suite-master-host-0 systemd[1]: Starting \
Device-Mapper Multipath Device Controller... 2021-12-17T01:03:53.361772+0100 \
ost-basic-suite-master-host-0 kernel: device-mapper: uevent: version 1.0.3 \
2021-12-17T01:03:53.362093+0100 ost-basic-suite-master-host-0 kernel: device-mapper: \
ioctl: 4.43.0-ioctl (2020-10-01) initialised: dm-devel@redhat.com \
2021-12-17T01:03:53.363640+0100 ost-basic-suite-master-host-0 systemd-udevd[887]: \
Network interface NamePolicy= disabled on kernel command line, ignoring. \
2021-12-17T01:03:53.532068+0100 ost-basic-suite-master-host-0 multipathd[7648]: \
--------start up-------- 2021-12-17T01:03:53.532068+0100 \
ost-basic-suite-master-host-0 multipathd[7648]: read /etc/multipath.conf \
2021-12-17T01:03:53.537063+0100 ost-basic-suite-master-host-0 multipathd[7648]: path \
checkers start up 2021-12-17T01:03:53.542669+0100 ost-basic-suite-master-host-0 \
systemd[1]: Started Device-Mapper Multipath Device Controller. \
2021-12-17T01:03:53.609129+0100 ost-basic-suite-master-host-0 multipathd[7648]: \
reconfigure (operator) 2021-12-17T01:03:53.706394+0100 ost-basic-suite-master-host-0 \
systemd[1]: Reloading. 2021-12-17T01:03:54.810223+0100 ost-basic-suite-master-host-0 \
systemd[1]: Mounting Huge Pages 1G File System... 2021-12-17T01:03:54.822162+0100 \
ost-basic-suite-master-host-0 systemd[1]: Mounted Huge Pages 1G File System. \
2021-12-17T01:03:54.909401+0100 ost-basic-suite-master-host-0 systemd[1]: Reloading. \
2021-12-17T01:03:55.859208+0100 ost-basic-suite-master-host-0 dbus-daemon[1073]: \
[system] Reloaded configuration 2021-12-17T01:03:56.320321+0100 \
ost-basic-suite-master-host-0 kernel: SELinux:  Converting 454 SID table entries... \
2021-12-17T01:03:56.324027+0100 ost-basic-suite-master-host-0 kernel: SELinux:  \
policy capability network_peer_controls=1 2021-12-17T01:03:56.324210+0100 \
ost-basic-suite-master-host-0 kernel: SELinux:  policy capability open_perms=1 \
2021-12-17T01:03:56.324301+0100 ost-basic-suite-master-host-0 kernel: SELinux:  \
policy capability extended_socket_class=1 2021-12-17T01:03:56.324362+0100 \
ost-basic-suite-master-host-0 kernel: SELinux:  policy capability \
always_check_network=0 2021-12-17T01:03:56.324410+0100 ost-basic-suite-master-host-0 \
kernel: SELinux:  policy capability cgroup_seclabel=1 2021-12-17T01:03:56.324465+0100 \
ost-basic-suite-master-host-0 kernel: SELinux:  policy capability \
nnp_nosuid_transition=1 2021-12-17T01:03:56.351880+0100 ost-basic-suite-master-host-0 \
dbus-daemon[1073]: [system] Reloaded configuration 2021-12-17T01:03:56.400164+0100 \
ost-basic-suite-master-host-0 kernel: bonding: bondscan-lciTmX is being created... \
2021-12-17T01:03:56.400271+0100 ost-basic-suite-master-host-0 kernel: bonding: \
bondscan-lciTmX is being deleted... 2021-12-17T01:03:56.404952+0100 \
ost-basic-suite-master-host-0 systemd-udevd[7708]: Using default interface naming \
scheme 'rhel-8.0'. 2021-12-17T01:03:56.407736+0100 ost-basic-suite-master-host-0 \
kernel: bondscan-lciTmX (unregistering): Released all slaves \
2021-12-17T01:03:56.407735+0100 ost-basic-suite-master-host-0 NetworkManager[1137]: \
&lt;info&gt;  [1639699436.4075] manager: (bondscan-lciTmX): new Bond device \
(/org/freedesktop/NetworkManager/Devices/7) 2021-12-17T01:03:56.408194+0100 \
ost-basic-suite-master-host-0 systemd-udevd[7708]: link_config: autonegotiation is \
unset or enabled, the speed and duplex are not writable. \
2021-12-17T01:03:56.414984+0100 ost-basic-suite-master-host-0 kernel: bonding: \
bondscan-lciTmX is being created... 2021-12-17T01:03:56.428301+0100 \
ost-basic-suite-master-host-0 kernel: bonding: bondscan-lciTmX is being deleted... \
2021-12-17T01:03:56.429289+0100 ost-basic-suite-master-host-0 kernel: bondscan-lciTmX \
(unregistering): Released all slaves 2021-12-17T01:03:56.429607+0100 \
ost-basic-suite-master-host-0 NetworkManager[1137]: &lt;info&gt;  [1639699436.4295] \
manager: (bondscan-lciTmX): new Bond device \
(/org/freedesktop/NetworkManager/Devices/8) 2021-12-17T01:03:56.433857+0100 \
ost-basic-suite-master-host-0 kernel: bonding: bondscan-lciTmX is being created... \
2021-12-17T01:03:56.436700+0100 ost-basic-suite-master-host-0 kernel: bonding: \
bondscan-lciTmX is being deleted... 2021-12-17T01:03:56.436472+0100 \
ost-basic-suite-master-host-0 NetworkManager[1137]: &lt;info&gt;  [1639699436.4364] \
manager: (bondscan-lciTmX): new Bond device \
(/org/freedesktop/NetworkManager/Devices/9) 2021-12-17T01:03:56.438259+0100 \
ost-basic-suite-master-host-0 kernel: bondscan-lciTmX (unregistering): Released all \
slaves 2021-12-17T01:03:56.441822+0100 ost-basic-suite-master-host-0 kernel: bonding: \
bondscan-lciTmX is being created... 2021-12-17T01:03:56.444357+0100 \
ost-basic-suite-master-host-0 kernel: bonding: bondscan-lciTmX is being deleted... \
2021-12-17T01:03:56.445329+0100 ost-basic-suite-master-host-0 kernel: bondscan-lciTmX \
(unregistering): Released all slaves 2021-12-17T01:03:56.448809+0100 \
ost-basic-suite-master-host-0 kernel: bonding: bondscan-lciTmX is being created... \
2021-12-17T01:03:56.451313+0100 ost-basic-suite-master-host-0 kernel: bonding: \
bondscan-lciTmX is being deleted... 2021-12-17T01:03:56.451352+0100 \
ost-basic-suite-master-host-0 kernel: bondscan-lciTmX (unregistering): Released all \
slaves 2021-12-17T01:03:56.451493+0100 ost-basic-suite-master-host-0 \
systemd-udevd[7708]: link_config: could not get ethtool features for bondscan-lciTmX \
2021-12-17T01:03:56.451502+0100 ost-basic-suite-master-host-0 systemd-udevd[7708]: \
Could not set offload features of bondscan-lciTmX: No such device \
2021-12-17T01:03:56.451557+0100 ost-basic-suite-master-host-0 systemd-udevd[7708]: \
Could not generate persistent MAC address for bondscan-lciTmX: No such file or \
directory 2021-12-17T01:03:56.464255+0100 ost-basic-suite-master-host-0 kernel: \
bonding: bondscan-lciTmX is being created... 2021-12-17T01:03:56.473864+0100 \
ost-basic-suite-master-host-0 kernel: bonding: bondscan-lciTmX is being deleted... \
2021-12-17T01:03:56.486262+0100 ost-basic-suite-master-host-0 kernel: bondscan-lciTmX \
(unregistering): Released all slaves 2021-12-17T01:03:56.486566+0100 \
ost-basic-suite-master-host-0 NetworkManager[1137]: &lt;info&gt;  [1639699436.4865] \
manager: (bondscan-lciTmX): new Bond device \
(/org/freedesktop/NetworkManager/Devices/10) 2021-12-17T01:03:56.492257+0100 \
ost-basic-suite-master-host-0 kernel: bonding: bondscan-lciTmX is being created... \
2021-12-17T01:03:56.504260+0100 ost-basic-suite-master-host-0 kernel: bonding: \
bondscan-lciTmX is being deleted... 2021-12-17T01:03:56.505524+0100 \
ost-basic-suite-master-host-0 kernel: bondscan-lciTmX (unregistering): Released all \
slaves 2021-12-17T01:03:56.505324+0100 ost-basic-suite-master-host-0 \
NetworkManager[1137]: &lt;info&gt;  [1639699436.5052] manager: (bondscan-lciTmX): new Bond \
device (/org/freedesktop/NetworkManager/Devices/11) 2021-12-17T01:03:56.510903+0100 \
ost-basic-suite-master-host-0 kernel: bonding: bondscan-lciTmX is being created... \
2021-12-17T01:03:56.517377+0100 ost-basic-suite-master-host-0 kernel: bonding: \
bondscan-lciTmX is being deleted... 2021-12-17T01:03:56.532146+0100 \
ost-basic-suite-master-host-0 kernel: bondscan-lciTmX (unregistering): Released all \
slaves 2021-12-17T01:03:56.531314+0100 ost-basic-suite-master-host-0 \
NetworkManager[1137]: &lt;info&gt;  [1639699436.5312] manager: (bondscan-lciTmX): new Bond \
device (/org/freedesktop/NetworkManager/Devices/12) 2021-12-17T01:03:56.536955+0100 \
ost-basic-suite-master-host-0 kernel: bonding: bondscan-iVLihL is being created... \
2021-12-17T01:03:56.542627+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option arp_validate: invalid value (7) \
2021-12-17T01:03:56.557543+0100 ost-basic-suite-master-host-0 NetworkManager[1137]: \
&lt;info&gt;  [1639699436.5575] manager: (bondscan-iVLihL): new Bond device \
(/org/freedesktop/NetworkManager/Devices/13) 2021-12-17T01:03:56.561341+0100 \
ost-basic-suite-master-host-0 kernel: bondscan-iVLihL: option xmit_hash_policy: \
invalid value (6) 2021-12-17T01:03:56.561382+0100 ost-basic-suite-master-host-0 \
kernel: bondscan-iVLihL: option lacp_rate: mode dependency failed, not supported in \
mode balance-rr(0) 2021-12-17T01:03:56.561395+0100 ost-basic-suite-master-host-0 \
kernel: bondscan-iVLihL: option ad_select: invalid value (3) \
2021-12-17T01:03:56.561406+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option primary_reselect: invalid value (3) \
2021-12-17T01:03:56.561416+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option fail_over_mac: invalid value (3) \
2021-12-17T01:03:56.561426+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option arp_all_targets: invalid value (2) \
2021-12-17T01:03:56.561289+0100 ost-basic-suite-master-host-0 systemd-udevd[7724]: \
Using default interface naming scheme 'rhel-8.0'. 2021-12-17T01:03:56.562269+0100 \
ost-basic-suite-master-host-0 kernel: bonding: bondscan-iVLihL is being deleted... \
2021-12-17T01:03:56.562322+0100 ost-basic-suite-master-host-0 kernel: bondscan-iVLihL \
(unregistering): Released all slaves 2021-12-17T01:03:56.570770+0100 \
ost-basic-suite-master-host-0 systemd-udevd[7724]: link_config: autonegotiation is \
unset or enabled, the speed and duplex are not writable. \
2021-12-17T01:03:56.586367+0100 ost-basic-suite-master-host-0 kernel: bonding: \
bondscan-iVLihL is being created... 2021-12-17T01:03:56.607254+0100 \
ost-basic-suite-master-host-0 kernel: bondscan-iVLihL: option arp_validate: invalid \
value (7) 2021-12-17T01:03:56.633950+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option xmit_hash_policy: invalid value (6) \
2021-12-17T01:03:56.634095+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option lacp_rate: mode dependency failed, not supported in mode \
active-backup(1) 2021-12-17T01:03:56.634170+0100 ost-basic-suite-master-host-0 \
kernel: bondscan-iVLihL: option ad_select: invalid value (3) \
2021-12-17T01:03:56.634195+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option fail_over_mac: invalid value (3) \
2021-12-17T01:03:56.634207+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option arp_all_targets: invalid value (2) \
2021-12-17T01:03:56.634224+0100 ost-basic-suite-master-host-0 kernel: bonding: \
bondscan-iVLihL is being deleted... 2021-12-17T01:03:56.638311+0100 \
ost-basic-suite-master-host-0 kernel: bondscan-iVLihL (unregistering): Released all \
slaves 2021-12-17T01:03:56.646323+0100 ost-basic-suite-master-host-0 \
systemd-udevd[7724]: link_config: could not get ethtool features for bondscan-iVLihL \
2021-12-17T01:03:56.646333+0100 ost-basic-suite-master-host-0 systemd-udevd[7724]: \
Could not set offload features of bondscan-iVLihL: No such device \
2021-12-17T01:03:56.646401+0100 ost-basic-suite-master-host-0 systemd-udevd[7724]: \
Could not generate persistent MAC address for bondscan-iVLihL: No such file or \
directory 2021-12-17T01:03:56.648730+0100 ost-basic-suite-master-host-0 \
NetworkManager[1137]: &lt;info&gt;  [1639699436.6487] manager: (bondscan-iVLihL): new Bond \
device (/org/freedesktop/NetworkManager/Devices/14) 2021-12-17T01:03:56.660450+0100 \
ost-basic-suite-master-host-0 kernel: bonding: bondscan-iVLihL is being created... \
2021-12-17T01:03:56.673269+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option arp_validate: invalid value (7) \
2021-12-17T01:03:56.681187+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option xmit_hash_policy: invalid value (6) \
2021-12-17T01:03:56.681237+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option lacp_rate: mode dependency failed, not supported in mode \
balance-xor(2) 2021-12-17T01:03:56.681266+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option ad_select: invalid value (3) 2021-12-17T01:03:56.681277+0100 \
ost-basic-suite-master-host-0 kernel: bondscan-iVLihL: option primary_reselect: \
invalid value (3) 2021-12-17T01:03:56.681288+0100 ost-basic-suite-master-host-0 \
kernel: bondscan-iVLihL: option fail_over_mac: invalid value (3) \
2021-12-17T01:03:56.681298+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option arp_all_targets: invalid value (2) \
2021-12-17T01:03:56.681308+0100 ost-basic-suite-master-host-0 kernel: bonding: \
bondscan-iVLihL is being deleted... 2021-12-17T01:03:56.696251+0100 \
ost-basic-suite-master-host-0 kernel: bondscan-iVLihL (unregistering): Released all \
slaves 2021-12-17T01:03:56.691191+0100 ost-basic-suite-master-host-0 \
systemd-udevd[7734]: link_config: autonegotiation is unset or enabled, the speed and \
duplex are not writable. 2021-12-17T01:03:56.706699+0100 \
ost-basic-suite-master-host-0 kernel: bonding: bondscan-iVLihL is being created... \
2021-12-17T01:03:56.729270+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option arp_validate: invalid value (7) \
2021-12-17T01:03:56.740250+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option xmit_hash_policy: invalid value (6) \
2021-12-17T01:03:56.740285+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option lacp_rate: mode dependency failed, not supported in mode \
broadcast(3) 2021-12-17T01:03:56.740315+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option ad_select: invalid value (3) 2021-12-17T01:03:56.740337+0100 \
ost-basic-suite-master-host-0 kernel: bondscan-iVLihL: option primary_reselect: \
invalid value (3) 2021-12-17T01:03:56.742489+0100 ost-basic-suite-master-host-0 \
kernel: bondscan-iVLihL: option fail_over_mac: invalid value (3) \
2021-12-17T01:03:56.742519+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option arp_all_targets: invalid value (2) \
2021-12-17T01:03:56.742530+0100 ost-basic-suite-master-host-0 kernel: bonding: \
bondscan-iVLihL is being deleted... 2021-12-17T01:03:56.755257+0100 \
ost-basic-suite-master-host-0 kernel: bondscan-iVLihL (unregistering): Released all \
slaves 2021-12-17T01:03:56.755651+0100 ost-basic-suite-master-host-0 \
NetworkManager[1137]: &lt;info&gt;  [1639699436.7556] manager: (bondscan-iVLihL): new Bond \
device (/org/freedesktop/NetworkManager/Devices/15) 2021-12-17T01:03:56.756279+0100 \
ost-basic-suite-master-host-0 systemd-udevd[7734]: link_config: could not get ethtool \
features for bondscan-lciTmX 2021-12-17T01:03:56.756289+0100 \
ost-basic-suite-master-host-0 systemd-udevd[7734]: Could not set offload features of \
bondscan-lciTmX: No such device 2021-12-17T01:03:56.777013+0100 \
ost-basic-suite-master-host-0 kernel: bonding: bondscan-iVLihL is being created... \
2021-12-17T01:03:56.790595+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option arp_validate: mode dependency failed, not supported in mode \
802.3ad(4) 2021-12-17T01:03:56.790665+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option xmit_hash_policy: invalid value (6) \
2021-12-17T01:03:56.790683+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option lacp_rate: invalid value (2) 2021-12-17T01:03:56.790694+0100 \
ost-basic-suite-master-host-0 kernel: bondscan-iVLihL: option ad_select: invalid \
value (3) 2021-12-17T01:03:56.790340+0100 ost-basic-suite-master-host-0 \
NetworkManager[1137]: &lt;info&gt;  [1639699436.7903] manager: (bondscan-iVLihL): new Bond \
device (/org/freedesktop/NetworkManager/Devices/16) 2021-12-17T01:03:56.793562+0100 \
ost-basic-suite-master-host-0 kernel: bondscan-iVLihL: option primary_reselect: \
invalid value (3) 2021-12-17T01:03:56.793600+0100 ost-basic-suite-master-host-0 \
kernel: bondscan-iVLihL: option fail_over_mac: invalid value (3) \
2021-12-17T01:03:56.793626+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option arp_all_targets: invalid value (2) \
2021-12-17T01:03:56.793637+0100 ost-basic-suite-master-host-0 kernel: bonding: \
bondscan-iVLihL is being deleted... 2021-12-17T01:03:56.816835+0100 \
ost-basic-suite-master-host-0 kernel: bondscan-iVLihL (unregistering): Released all \
slaves 2021-12-17T01:03:56.851252+0100 ost-basic-suite-master-host-0 kernel: bonding: \
bondscan-iVLihL is being created... 2021-12-17T01:03:56.851311+0100 \
ost-basic-suite-master-host-0 kernel: bondscan-iVLihL: option arp_validate: mode \
dependency failed, not supported in mode balance-tlb(5) \
2021-12-17T01:03:56.851342+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option xmit_hash_policy: invalid value (6) \
2021-12-17T01:03:56.851363+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option lacp_rate: mode dependency failed, not supported in mode \
balance-tlb(5) 2021-12-17T01:03:56.851382+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option ad_select: invalid value (3) 2021-12-17T01:03:56.855258+0100 \
ost-basic-suite-master-host-0 NetworkManager[1137]: &lt;info&gt;  [1639699436.8552] \
manager: (bondscan-iVLihL): new Bond device \
(/org/freedesktop/NetworkManager/Devices/17) 2021-12-17T01:03:56.857656+0100 \
ost-basic-suite-master-host-0 kernel: bondscan-iVLihL: option primary_reselect: \
invalid value (3) 2021-12-17T01:03:56.857690+0100 ost-basic-suite-master-host-0 \
kernel: bondscan-iVLihL: option fail_over_mac: invalid value (3) \
2021-12-17T01:03:56.857701+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option arp_all_targets: invalid value (2) \
2021-12-17T01:03:56.857721+0100 ost-basic-suite-master-host-0 kernel: bonding: \
bondscan-iVLihL is being deleted... 2021-12-17T01:03:56.861350+0100 \
ost-basic-suite-master-host-0 kernel: bondscan-iVLihL (unregistering): Released all \
slaves 2021-12-17T01:03:56.887705+0100 ost-basic-suite-master-host-0 kernel: bonding: \
bondscan-iVLihL is being created... 2021-12-17T01:03:56.910657+0100 \
ost-basic-suite-master-host-0 kernel: bondscan-iVLihL: option arp_validate: mode \
dependency failed, not supported in mode balance-alb(6) \
2021-12-17T01:03:56.910752+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option xmit_hash_policy: invalid value (6) \
2021-12-17T01:03:56.916092+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option lacp_rate: mode dependency failed, not supported in mode \
balance-alb(6) 2021-12-17T01:03:56.916240+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option ad_select: invalid value (3) 2021-12-17T01:03:56.916281+0100 \
ost-basic-suite-master-host-0 kernel: bondscan-iVLihL: option primary_reselect: \
invalid value (3) 2021-12-17T01:03:56.916292+0100 ost-basic-suite-master-host-0 \
kernel: bondscan-iVLihL: option fail_over_mac: invalid value (3) \
2021-12-17T01:03:56.916303+0100 ost-basic-suite-master-host-0 kernel: \
bondscan-iVLihL: option arp_all_targets: invalid value (2) \
2021-12-17T01:03:56.916315+0100 ost-basic-suite-master-host-0 kernel: bonding: \
bondscan-iVLihL is being deleted... 2021-12-17T01:03:56.937252+0100 \
ost-basic-suite-master-host-0 kernel: bondscan-iVLihL (unregistering): Released all \
slaves 2021-12-17T01:03:56.964120+0100 ost-basic-suite-master-host-0 \
systemd-udevd[7728]: link_config: autonegotiation is unset or enabled, the speed and \
duplex are not writable. 2021-12-17T01:03:57.012296+0100 \
ost-basic-suite-master-host-0 systemd-udevd[7728]: link_config: could not get ethtool \
features for bondscan-iVLihL 2021-12-17T01:03:57.012305+0100 \
ost-basic-suite-master-host-0 systemd-udevd[7728]: Could not set offload features of \
bondscan-iVLihL: No such device 2021-12-17T01:03:57.014308+0100 \
ost-basic-suite-master-host-0 usermod[7760]: add 'sanlock' to group 'kvm' \
2021-12-17T01:03:57.014341+0100 ost-basic-suite-master-host-0 usermod[7760]: add \
'sanlock' to group 'qemu' 2021-12-17T01:03:57.014360+0100 \
ost-basic-suite-master-host-0 usermod[7760]: add 'sanlock' to shadow group 'kvm' \
2021-12-17T01:03:57.014378+0100 ost-basic-suite-master-host-0 usermod[7760]: add \
'sanlock' to shadow group 'qemu' 2021-12-17T01:03:57.081694+0100 \
ost-basic-suite-master-host-0 systemd-udevd[7734]: link_config: autonegotiation is \
unset or enabled, the speed and duplex are not writable. \
2021-12-17T01:03:57.150598+0100 ost-basic-suite-master-host-0 systemd-udevd[7734]: \
link_config: could not get ethtool features for bondscan-lciTmX \
2021-12-17T01:03:57.150609+0100 ost-basic-suite-master-host-0 systemd-udevd[7734]: \
Could not set offload features of bondscan-lciTmX: No such device \
2021-12-17T01:03:57.294340+0100 ost-basic-suite-master-host-0 systemd-udevd[7728]: \
link_config: autonegotiation is unset or enabled, the speed and duplex are not \
writable. 2021-12-17T01:03:57.327980+0100 ost-basic-suite-master-host-0 \
systemd-udevd[7728]: link_config: could not get ethtool features for bondscan-iVLihL \
2021-12-17T01:03:57.327990+0100 ost-basic-suite-master-host-0 systemd-udevd[7728]: \
Could not set offload features of bondscan-iVLihL: No such device \
2021-12-17T01:03:57.388088+0100 ost-basic-suite-master-host-0 systemd-udevd[7734]: \
link_config: autonegotiation is unset or enabled, the speed and duplex are not \
writable. 2021-12-17T01:03:57.456549+0100 ost-basic-suite-master-host-0 \
systemd-udevd[7734]: link_config: could not get ethtool features for bondscan-lciTmX \
2021-12-17T01:03:57.456558+0100 ost-basic-suite-master-host-0 systemd-udevd[7734]: \
Could not set offload features of bondscan-lciTmX: No such device \
2021-12-17T01:03:57.483916+0100 ost-basic-suite-master-host-0 systemd-udevd[7728]: \
link_config: autonegotiation is unset or enabled, the speed and duplex are not \
writable. 2021-12-17T01:03:57.518408+0100 ost-basic-suite-master-host-0 \
systemd-udevd[7728]: link_config: could not get ethtool features for bondscan-iVLihL \
2021-12-17T01:03:57.518420+0100 ost-basic-suite-master-host-0 systemd-udevd[7728]: \
Could not set offload features of bondscan-iVLihL: No such device \
2021-12-17T01:03:57.606300+0100 ost-basic-suite-master-host-0 systemd-udevd[7734]: \
link_config: autonegotiation is unset or enabled, the speed and duplex are not \
writable. 2021-12-17T01:03:57.642269+0100 ost-basic-suite-master-host-0 \
systemd-udevd[7734]: link_config: could not get ethtool features for bondscan-lciTmX \
2021-12-17T01:03:57.642281+0100 ost-basic-suite-master-host-0 systemd-udevd[7734]: \
Could not set offload features of bondscan-lciTmX: No such device \
2021-12-17T01:03:57.751159+0100 ost-basic-suite-master-host-0 systemd-udevd[7728]: \
link_config: autonegotiation is unset or enabled, the speed and duplex are not \
writable. 2021-12-17T01:03:57.832974+0100 ost-basic-suite-master-host-0 \
systemd-udevd[7728]: link_config: could not get ethtool features for bondscan-iVLihL \
2021-12-17T01:03:57.832985+0100 ost-basic-suite-master-host-0 systemd-udevd[7728]: \
Could not set offload features of bondscan-iVLihL: No such device \
2021-12-17T01:03:57.871313+0100 ost-basic-suite-master-host-0 systemd-udevd[7734]: \
link_config: autonegotiation is unset or enabled, the speed and duplex are not \
writable. 2021-12-17T01:03:57.905425+0100 ost-basic-suite-master-host-0 \
systemd-udevd[7734]: link_config: could not get ethtool features for bondscan-lciTmX \
2021-12-17T01:03:57.905435+0100 ost-basic-suite-master-host-0 systemd-udevd[7734]: \
Could not set offload features of bondscan-lciTmX: No such device \
2021-12-17T01:03:58.037755+0100 ost-basic-suite-master-host-0 systemd-udevd[7728]: \
link_config: autonegotiation is unset or enabled, the speed and duplex are not \
writable. 2021-12-17T01:03:58.063780+0100 ost-basic-suite-master-host-0 \
systemd-udevd[7734]: link_config: autonegotiation is unset or enabled, the speed and \
duplex are not writable. 2021-12-17T01:03:58.097334+0100 \
ost-basic-suite-master-host-0 systemd-udevd[7728]: link_config: could not get ethtool \
features for bondscan-iVLihL 2021-12-17T01:03:58.097344+0100 \
ost-basic-suite-master-host-0 systemd-udevd[7728]: Could not set offload features of \
bondscan-iVLihL: No such device 2021-12-17T01:03:58.106450+0100 \
ost-basic-suite-master-host-0 systemd-udevd[7734]: link_config: could not get ethtool \
features for bondscan-lciTmX 2021-12-17T01:03:58.106459+0100 \
ost-basic-suite-master-host-0 systemd-udevd[7734]: Could not set offload features of \
bondscan-lciTmX: No such device 2021-12-17T01:03:58.175915+0100 \
ost-basic-suite-master-host-0 saslpasswd2[7851]: error deleting entry from sasldb: \
BDB0073 DB_NOTFOUND: No matching key/data pair found 2021-12-17T01:03:58.175969+0100 \
ost-basic-suite-master-host-0 saslpasswd2[7851]: error deleting entry from sasldb: \
BDB0073 DB_NOTFOUND: No matching key/data pair found 2021-12-17T01:03:58.175994+0100 \
ost-basic-suite-master-host-0 saslpasswd2[7851]: error deleting entry from sasldb: \
BDB0073 DB_NOTFOUND: No matching key/data pair found 2021-12-17T01:03:58.176002+0100 \
ost-basic-suite-master-host-0 saslpasswd2[7851]: DIGEST-MD5 common mech free \
2021-12-17T01:03:58.322642+0100 ost-basic-suite-master-host-0 systemd-udevd[7728]: \
link_config: autonegotiation is unset or enabled, the speed and duplex are not \
writable. 2021-12-17T01:03:58.348046+0100 ost-basic-suite-master-host-0 \
systemd-udevd[7734]: link_config: autonegotiation is unset or enabled, the speed and \
duplex are not writable. 2021-12-17T01:03:58.355350+0100 \
ost-basic-suite-master-host-0 systemd-udevd[7728]: link_config: could not get ethtool \
features for bondscan-iVLihL 2021-12-17T01:03:58.355358+0100 \
ost-basic-suite-master-host-0 systemd-udevd[7728]: Could not set offload features of \
bondscan-iVLihL: No such device 2021-12-17T01:03:58.419192+0100 \
2021-12-17T01:03:58.419202+0100 ost-basic-suite-master-host-0 systemd-udevd[7734]: \
Could not set offload features of bondscan-lciTmX: No such device \
2021-12-17T01:03:58.818433+0100 ost-basic-suite-master-host-0 systemd[1]: Listening \
on Libvirt TLS IP socket. 2021-12-17T01:03:58.818704+0100 \
ost-basic-suite-master-host-0 systemd[1]: libvirtd.service: Found left-over process \
1883 (dnsmasq) in control group while starting unit. Ignoring. \
2021-12-17T01:03:58.818709+0100 ost-basic-suite-master-host-0 systemd[1]: This \
usually indicates unclean termination of a previous run, or service implementation \
deficiencies. 2021-12-17T01:03:58.818800+0100 ost-basic-suite-master-host-0 \
systemd[1]: libvirtd.service: Found left-over process 1884 (dnsmasq) in control group \
while starting unit. Ignoring. 2021-12-17T01:03:58.818804+0100 \
ost-basic-suite-master-host-0 systemd[1]: This usually indicates unclean termination \
of a previous run, or service implementation deficiencies. \
2021-12-17T01:03:58.822523+0100 ost-basic-suite-master-host-0 systemd[1]: Starting \
Virtualization daemon... 2021-12-17T01:04:00.883339+0100 \
ost-basic-suite-master-host-0 systemd[1]: Started Virtualization daemon. \
2021-12-17T01:04:01.227094+0100 ost-basic-suite-master-host-0 systemd[1]: Started \
/usr/bin/systemctl start man-db-cache-update. 2021-12-17T01:04:01.259641+0100 \
ost-basic-suite-master-host-0 dnsmasq[1883]: read /etc/hosts - 2 addresses \
2021-12-17T01:04:01.259693+0100 ost-basic-suite-master-host-0 dnsmasq[1883]: read \
/var/lib/libvirt/dnsmasq/default.addnhosts - 0 addresses \
2021-12-17T01:04:01.259707+0100 ost-basic-suite-master-host-0 dnsmasq-dhcp[1883]: \
read /var/lib/libvirt/dnsmasq/default.hostsfile 2021-12-17T01:04:01.364005+0100 \
ost-basic-suite-master-host-0 systemd[1]: cgroup compatibility translation between \
legacy and unified hierarchy settings activated. See cgroup-compat debug messages for \
details. 2021-12-17T01:04:01.365697+0100 ost-basic-suite-master-host-0 systemd[1]: \
Starting man-db-cache-update.service... 2021-12-17T01:04:01.431054+0100 \
ost-basic-suite-master-host-0 systemd[1]: Reloading. 2021-12-17T01:04:02.192898+0100 \
ost-basic-suite-master-host-0 systemd[1]: Started /usr/bin/systemctl start \
man-db-cache-update. 2021-12-17T01:04:11.144094+0100 ost-basic-suite-master-host-0 \
systemd[1]: man-db-cache-update.service: Succeeded. 2021-12-17T01:04:11.144488+0100 \
ost-basic-suite-master-host-0 systemd[1]: Started man-db-cache-update.service. \
2021-12-17T01:04:11.147662+0100 ost-basic-suite-master-host-0 systemd[1]: \
run-rd8dfc54aa39c4a03ac50bd3f32d3038f.service: Succeeded. \
2021-12-17T01:04:11.148463+0100 ost-basic-suite-master-host-0 systemd[1]: \
run-rd047f29d32384fdd83d0f67f0a1df0cf.service: Succeeded. \
2021-12-17T01:04:30.235485+0100 ost-basic-suite-master-host-0 platform-python[24705]: \
ansible-command Invoked with _raw_params=rpm -qa _uses_shell=True warn=True \
stdin_add_newline=True strip_empty_ends=True argv=None chdir=None executable=None \
creates=None removes=None stdin=None 2021-12-17T01:04:30.235633+0100 \
ost-basic-suite-master-host-0 platform-python[24705]: ansible-command [WARNING] \
Consider using the yum, dnf or zypper module rather than running 'rpm'.  If you need \
to use command because yum, dnf or zypper is insufficient you can add 'warn: false' \
to this command task or set 'command_warnings=False' in ansible.cfg to get rid of \
this message. 2021-12-17T01:04:40.238340+0100 ost-basic-suite-master-host-0 \
saslpasswd2[24824]: error deleting entry from sasldb: BDB0073 DB_NOTFOUND: No \
matching key/data pair found 2021-12-17T01:04:40.238383+0100 \
ost-basic-suite-master-host-0 saslpasswd2[24824]: error deleting entry from sasldb: \
BDB0073 DB_NOTFOUND: No matching key/data pair found 2021-12-17T01:04:40.238407+0100 \
ost-basic-suite-master-host-0 saslpasswd2[24824]: error deleting entry from sasldb: \
BDB0073 DB_NOTFOUND: No matching key/data pair found 2021-12-17T01:04:40.238416+0100 \
ost-basic-suite-master-host-0 saslpasswd2[24824]: DIGEST-MD5 common mech free \
2021-12-17T01:04:40.326161+0100 ost-basic-suite-master-host-0 systemd[1]: Reloading. \
2021-12-17T01:04:40.841035+0100 ost-basic-suite-master-host-0 systemd[1]: Starting \
coredump-kill.service... 2021-12-17T01:04:40.915911+0100 \
ost-basic-suite-master-host-0 systemd[1]: Started coredump-kill.service. \
2021-12-17T01:05:10.211742+0100 ost-basic-suite-master-host-0 platform-python[24990]: \
ansible-file Invoked with path=/etc/systemd/system/sysstat-collect.timer.d \
state=directory recurse=False force=False follow=True \
modification_time_format=%Y%m%d%H%M.%S access_time_format=%Y%m%d%H%M.%S \
unsafe_writes=False _original_basename=None _diff_peek=None src=None \
modification_time=None access_time=None mode=None owner=None group=None seuser=None \
serole=None selevel=None setype=None attributes=None content=NOT_LOGGING_PARAMETER \
backup=None remote_src=None regexp=None delimiter=None directory_mode=None \
2021-12-17T01:05:19.570163+0100 ost-basic-suite-master-host-0 platform-python[25136]: \
ansible-stat Invoked with path=/etc/systemd/system/sysstat-collect.timer.d \
follow=False get_checksum=True checksum_algorithm=sha1 get_md5=False get_mime=True \
get_attributes=True 2021-12-17T01:05:19.983713+0100 ost-basic-suite-master-host-0 \
platform-python[25191]: ansible-stat Invoked with \
path=/etc/systemd/system/sysstat-collect.timer.d/override.conf follow=False \
get_checksum=True checksum_algorithm=sha1 get_md5=False get_mime=True \
get_attributes=True 2021-12-17T01:05:20.585698+0100 ost-basic-suite-master-host-0 \
platform-python[25275]: ansible-copy Invoked with \
src=/root/.ansible/tmp/ansible-tmp-1639699518.8694477-3090213-281371816166145/source \
dest=/etc/systemd/system/sysstat-collect.timer.d _original_basename=override.conf \
follow=False checksum=fbb22f086251cda15bba5ae6464d7b8ab13b8ead backup=False \
force=True unsafe_writes=False content=NOT_LOGGING_PARAMETER validate=None \
directory_mode=None remote_src=None local_follow=None mode=None owner=None group=None \
seuser=None serole=None selevel=None setype=None attributes=None regexp=None \
delimiter=None 2021-12-17T01:05:39.078019+0100 ost-basic-suite-master-host-0 \
platform-python[25415]: ansible-systemd Invoked with daemon_reload=True \
name=sysstat-collect.timer state=started enabled=True daemon_reexec=False \
no_block=False force=None masked=None user=None scope=None \
2021-12-17T01:05:39.157880+0100 ost-basic-suite-master-host-0 systemd[1]: Reloading. \
2021-12-17T01:05:39.690660+0100 ost-basic-suite-master-host-0 systemd[1]: Starting \
system activity accounting tool... 2021-12-17T01:05:39.759964+0100 \
ost-basic-suite-master-host-0 systemd[1]: sysstat-collect.service: Succeeded. \
2021-12-17T01:05:39.760205+0100 ost-basic-suite-master-host-0 systemd[1]: Started \
system activity accounting tool. 2021-12-17T01:06:02.742735+0100 \
ost-basic-suite-master-host-0 systemd[1]: Starting system activity accounting tool... \
2021-12-17T01:06:02.750792+0100 ost-basic-suite-master-host-0 systemd[1]: \
sysstat-collect.service: Succeeded. 2021-12-17T01:06:02.751135+0100 \
ost-basic-suite-master-host-0 systemd[1]: Started system activity accounting tool. \
2021-12-17T01:06:25.335566+0100 ost-basic-suite-master-host-0 systemd[1]: Starting \
system activity accounting tool... 2021-12-17T01:06:25.351860+0100 \
ost-basic-suite-master-host-0 systemd[1]: sysstat-collect.service: Succeeded. \
2021-12-17T01:06:25.352475+0100 ost-basic-suite-master-host-0 systemd[1]: Started \
system activity accounting tool. 2021-12-17T01:06:39.961947+0100 \
ost-basic-suite-master-host-0 sshd[2002]: Received disconnect from \
fd8f:1391:3a82:210::1 port 39910:11: disconnected by user \
2021-12-17T01:06:39.964516+0100 ost-basic-suite-master-host-0 sshd[2002]: \
Disconnected from user root fd8f:1391:3a82:210::1 port 39910 \
2021-12-17T01:06:39.970329+0100 ost-basic-suite-master-host-0 systemd[1]: Starting \
system activity accounting tool... 2021-12-17T01:06:39.977819+0100 \
ost-basic-suite-master-host-0 sshd[1897]: pam_unix(sshd:session): session closed for \
user root 2021-12-17T01:06:39.983780+0100 ost-basic-suite-master-host-0 systemd[1]: \
sysstat-collect.service: Succeeded. 2021-12-17T01:06:39.984193+0100 \
ost-basic-suite-master-host-0 systemd[1]: Started system activity accounting tool. \
2021-12-17T01:06:39.985325+0100 ost-basic-suite-master-host-0 systemd[1]: \
session-1.scope: Succeeded. 2021-12-17T01:06:40.008846+0100 \
ost-basic-suite-master-host-0 systemd-logind[1125]: Session 1 logged out. Waiting for \
processes to exit. 2021-12-17T01:06:40.032422+0100 ost-basic-suite-master-host-0 \
systemd[1]: Starting system activity accounting tool... \
2021-12-17T01:06:40.059083+0100 ost-basic-suite-master-host-0 systemd-logind[1125]: \
Removed session 1. 2021-12-17T01:06:40.059367+0100 ost-basic-suite-master-host-0 \
systemd[1]: sysstat-collect.service: Succeeded. 2021-12-17T01:06:40.059635+0100 \
ost-basic-suite-master-host-0 systemd[1]: Started system activity accounting tool. \
2021-12-17T01:06:50.241998+0100 ost-basic-suite-master-host-0 systemd[1]: Starting \
system activity accounting tool... 2021-12-17T01:06:50.244470+0100 \
ost-basic-suite-master-host-0 systemd[1]: Stopping User Manager for UID 0... \
2021-12-17T01:06:50.249236+0100 ost-basic-suite-master-host-0 systemd[1957]: Stopped \
target Default. 2021-12-17T01:06:50.249278+0100 ost-basic-suite-master-host-0 \
systemd[1957]: Stopped target Basic System. 2021-12-17T01:06:50.249291+0100 \
ost-basic-suite-master-host-0 systemd[1957]: Stopped target Sockets. \
2021-12-17T01:06:50.250095+0100 ost-basic-suite-master-host-0 systemd[1957]: Closed \
D-Bus User Message Bus Socket. 2021-12-17T01:06:50.250114+0100 \
ost-basic-suite-master-host-0 systemd[1957]: Stopped target Timers. \
2021-12-17T01:06:50.250125+0100 ost-basic-suite-master-host-0 systemd[1957]: Stopped \
target Paths. 2021-12-17T01:06:50.250149+0100 ost-basic-suite-master-host-0 \
systemd[1957]: Reached target Shutdown. 2021-12-17T01:06:50.251440+0100 \
ost-basic-suite-master-host-0 systemd[1957]: Starting Exit the Session... \
2021-12-17T01:06:50.265196+0100 ost-basic-suite-master-host-0 systemd[1]: \
sysstat-collect.service: Succeeded. 2021-12-17T01:06:50.265471+0100 \
ost-basic-suite-master-host-0 systemd[1]: Started system activity accounting tool. \
2021-12-17T01:06:50.404599+0100 ost-basic-suite-master-host-0 systemd[1]: \
user@0.service: Succeeded. 2021-12-17T01:06:50.408490+0100 \
ost-basic-suite-master-host-0 systemd[1]: Stopped User Manager for UID 0. \
2021-12-17T01:06:50.409481+0100 ost-basic-suite-master-host-0 systemd[1]: Stopping \
User runtime directory /run/user/0... 2021-12-17T01:06:50.482428+0100 \
ost-basic-suite-master-host-0 systemd[1]: run-user-0.mount: Succeeded. \
2021-12-17T01:06:50.486493+0100 ost-basic-suite-master-host-0 systemd[1]: \
user-runtime-dir@0.service: Succeeded. 2021-12-17T01:06:50.486736+0100 \
ost-basic-suite-master-host-0 systemd[1]: Stopped User runtime directory /run/user/0. \
2021-12-17T01:06:50.487264+0100 ost-basic-suite-master-host-0 systemd[1]: Removed \
slice User Slice of UID 0. 2021-12-17T01:07:25.334444+0100 \
ost-basic-suite-master-host-0 systemd[1]: Starting system activity accounting tool... \
2021-12-17T01:07:25.346074+0100 ost-basic-suite-master-host-0 systemd[1]: \
sysstat-collect.service: Succeeded. 2021-12-17T01:07:25.346487+0100 \
ost-basic-suite-master-host-0 systemd[1]: Started system activity accounting tool. \
2021-12-17T01:08:12.738702+0100 ost-basic-suite-master-host-0 systemd[1]: Starting \
system activity accounting tool... 2021-12-17T01:08:12.757378+0100 \
ost-basic-suite-master-host-0 systemd[1]: sysstat-collect.service: Succeeded. \
2021-12-17T01:08:12.758265+0100 ost-basic-suite-master-host-0 systemd[1]: Started \
system activity accounting tool. 2021-12-17T01:08:25.335485+0100 \
ost-basic-suite-master-host-0 systemd[1]: Starting system activity accounting tool... \
2021-12-17T01:08:25.347767+0100 ost-basic-suite-master-host-0 systemd[1]: \
sysstat-collect.service: Succeeded. 2021-12-17T01:08:25.348103+0100 \
ost-basic-suite-master-host-0 systemd[1]: Started system activity accounting tool. \
2021-12-17T01:09:25.335127+0100 ost-basic-suite-master-host-0 systemd[1]: Starting \
system activity accounting tool... 2021-12-17T01:09:25.350729+0100 \
ost-basic-suite-master-host-0 systemd[1]: sysstat-collect.service: Succeeded. \
2021-12-17T01:09:25.351187+0100 ost-basic-suite-master-host-0 systemd[1]: Started \
system activity accounting tool. 2021-12-17T01:10:22.738730+0100 \
ost-basic-suite-master-host-0 systemd[1]: Starting system activity accounting tool... \
2021-12-17T01:10:22.747109+0100 ost-basic-suite-master-host-0 systemd[1]: \
sysstat-collect.service: Succeeded. 2021-12-17T01:10:22.747624+0100 \
ost-basic-suite-master-host-0 systemd[1]: Started system activity accounting tool. \
2021-12-17T01:10:49.930096+0100 ost-basic-suite-master-host-0 sshd[25539]: error: \
Unable to load host key: /etc/ssh/ssh_host_ed25519_key \
2021-12-17T01:10:50.169984+0100 ost-basic-suite-master-host-0 sshd[25539]: Accepted \
password for root from 192.168.210.2 port 56672 ssh2 2021-12-17T01:10:50.183754+0100 \
ost-basic-suite-master-host-0 systemd[1]: Starting system activity accounting tool... \
2021-12-17T01:10:50.184104+0100 ost-basic-suite-master-host-0 systemd[1]: Created \
slice User Slice of UID 0. 2021-12-17T01:10:50.185151+0100 \
ost-basic-suite-master-host-0 systemd[1]: Starting User runtime directory \
/run/user/0... 2021-12-17T01:10:50.193039+0100 ost-basic-suite-master-host-0 \
systemd[1]: sysstat-collect.service: Succeeded. 2021-12-17T01:10:50.193290+0100 \
ost-basic-suite-master-host-0 systemd[1]: Started system activity accounting tool. \
2021-12-17T01:10:50.255649+0100 ost-basic-suite-master-host-0 systemd-logind[1125]: \
New session 3 of user root. 2021-12-17T01:10:50.286142+0100 \
ost-basic-suite-master-host-0 systemd[1]: Started User runtime directory /run/user/0. \
2021-12-17T01:10:50.287339+0100 ost-basic-suite-master-host-0 systemd[1]: Starting \
User Manager for UID 0... 2021-12-17T01:10:50.363933+0100 \
ost-basic-suite-master-host-0 systemd[25548]: pam_unix(systemd-user:session): session \
opened for user root by (uid=0) 2021-12-17T01:10:50.534653+0100 \
ost-basic-suite-master-host-0 systemd[25548]: Starting D-Bus User Message Bus Socket. \
2021-12-17T01:10:50.534689+0100 ost-basic-suite-master-host-0 systemd[25548]: Reached \
target Paths. 2021-12-17T01:10:50.534740+0100 ost-basic-suite-master-host-0 \
systemd[25548]: Reached target Timers. 2021-12-17T01:10:50.622638+0100 \
ost-basic-suite-master-host-0 systemd[25548]: Listening on D-Bus User Message Bus \
Socket. 2021-12-17T01:10:50.622760+0100 ost-basic-suite-master-host-0 systemd[25548]: \
Reached target Sockets. 2021-12-17T01:10:50.622789+0100 ost-basic-suite-master-host-0 \
systemd[25548]: Reached target Basic System. 2021-12-17T01:10:50.622939+0100 \
ost-basic-suite-master-host-0 systemd[25548]: Reached target Default. \
2021-12-17T01:10:50.622969+0100 ost-basic-suite-master-host-0 systemd[25548]: Startup \
finished in 187ms. 2021-12-17T01:10:50.631439+0100 ost-basic-suite-master-host-0 \
systemd[1]: Started User Manager for UID 0. 2021-12-17T01:10:50.633199+0100 \
ost-basic-suite-master-host-0 systemd[1]: Started Session 3 of user root. \
2021-12-17T01:10:50.638735+0100 ost-basic-suite-master-host-0 sshd[25539]: \
pam_unix(sshd:session): session opened for user root by (uid=0) \
2021-12-17T01:10:51.410887+0100 ost-basic-suite-master-host-0 sshd[25539]: \
pam_unix(sshd:session): session closed for user root 2021-12-17T01:10:51.418129+0100 \
2021-12-17T01:10:51.424758+0100 ost-basic-suite-master-host-0 systemd-logind[1125]: \
Removed session 3. 2021-12-17T01:10:52.092605+0100 ost-basic-suite-master-host-0 \
sshd[25579]: error: Unable to load host key: /etc/ssh/ssh_host_ed25519_key \
2021-12-17T01:10:52.269522+0100 ost-basic-suite-master-host-0 sshd[25579]: Accepted \
password for root from 192.168.210.2 port 56674 ssh2 2021-12-17T01:10:52.285649+0100 \
ost-basic-suite-master-host-0 systemd[1]: Started Session 5 of user root. \
2021-12-17T01:10:52.286157+0100 ost-basic-suite-master-host-0 systemd-logind[1125]: \
New session 5 of user root. 2021-12-17T01:10:52.288605+0100 \
ost-basic-suite-master-host-0 sshd[25579]: pam_unix(sshd:session): session opened for \
user root by (uid=0) 2021-12-17T01:10:52.401280+0100 ost-basic-suite-master-host-0 \
sshd[25579]: pam_unix(sshd:session): session closed for user root \
2021-12-17T01:10:52.403985+0100 ost-basic-suite-master-host-0 systemd[1]: \
session-5.scope: Succeeded. 2021-12-17T01:10:52.404545+0100 \
ost-basic-suite-master-host-0 systemd-logind[1125]: Session 5 logged out. Waiting for \
processes to exit. 2021-12-17T01:10:52.405861+0100 ost-basic-suite-master-host-0 \
systemd-logind[1125]: Removed session 5. 2021-12-17T01:10:54.398453+0100 \
ost-basic-suite-master-host-0 sshd[25605]: error: Unable to load host key: \
/etc/ssh/ssh_host_ed25519_key 2021-12-17T01:10:54.464981+0100 \
ost-basic-suite-master-host-0 sshd[25605]: Accepted publickey for root from \
fd8f:1391:3a82:210::c0a8:d202 port 41838 ssh2: RSA \
SHA256:4KyfVjoeHwFp91JE4/DefyF0vKJxdcpvjiXxKGBelDs 2021-12-17T01:10:54.473416+0100 \
ost-basic-suite-master-host-0 systemd[1]: Started Session 6 of user root. \
2021-12-17T01:10:54.474155+0100 ost-basic-suite-master-host-0 systemd-logind[1125]: \
New session 6 of user root. 2021-12-17T01:10:54.476351+0100 \
ost-basic-suite-master-host-0 sshd[25605]: pam_unix(sshd:session): session opened for \
user root by (uid=0) 2021-12-17T01:10:55.034039+0100 ost-basic-suite-master-host-0 \
platform-python[25657]: ansible-setup Invoked with gather_subset=['all'] \
gather_timeout=10 filter=* fact_path=/etc/ansible/facts.d \
2021-12-17T01:10:55.744850+0100 ost-basic-suite-master-host-0 sshd[25681]: error: \
Unable to load host key: /etc/ssh/ssh_host_ed25519_key \
2021-12-17T01:10:55.820508+0100 ost-basic-suite-master-host-0 sshd[25681]: Accepted \
publickey for root from fd8f:1391:3a82:210::1 port 40070 ssh2: RSA \
SHA256:P5xCNqbXoHPcOI4WCD9zlIFH0cP8MZZT4FZD25dsot0 2021-12-17T01:10:55.829094+0100 \
ost-basic-suite-master-host-0 systemd[1]: Started Session 7 of user root. \
2021-12-17T01:10:55.829949+0100 ost-basic-suite-master-host-0 systemd-logind[1125]: \
New session 7 of user root. 2021-12-17T01:10:55.831086+0100 \
ost-basic-suite-master-host-0 sshd[25681]: pam_unix(sshd:session): session opened for \
user root by (uid=0) 2021-12-17T01:10:56.637797+0100 ost-basic-suite-master-host-0 \
platform-python[25834]: ansible-command Invoked with _raw_params=chronyc add server \
ost-basic-suite-master-engine _uses_shell=True warn=True stdin_add_newline=True \
strip_empty_ends=True argv=None chdir=None executable=None creates=None removes=None \
stdin=None 2021-12-17T01:10:56.776177+0100 ost-basic-suite-master-host-0 \
platform-python[25850]: ansible-package_facts Invoked with manager=['auto'] \
strategy=first 2021-12-17T01:10:58.531458+0100 ost-basic-suite-master-host-0 \
platform-python[25888]: ansible-lineinfile Invoked with path=/etc/os-release \
line=VARIANT_ID="ovirt-node" state=present backrefs=False create=False backup=False \
firstmatch=False follow=False unsafe_writes=False regexp=None insertafter=None \
insertbefore=None validate=None mode=None owner=None group=None seuser=None \
serole=None selevel=None setype=None attributes=None src=None force=None \
content=NOT_LOGGING_PARAMETER remote_src=None delimiter=None directory_mode=None \
2021-12-17T01:11:01.277069+0100 ost-basic-suite-master-host-0 platform-python[25905]: \
ansible-dnf Invoked with name=['python3'] state=present allow_downgrade=False \
autoremove=False bugfix=False disable_gpg_check=False disable_plugin=[] \
disablerepo=[] download_only=False enable_plugin=[] enablerepo=[] exclude=[] \
installroot=/ install_repoquery=True install_weak_deps=True security=False \
skip_broken=False update_cache=False update_only=False validate_certs=True \
lock_timeout=30 conf_file=None disable_excludes=None download_dir=None list=None \
releasever=None 2021-12-17T01:11:02.760461+0100 ost-basic-suite-master-host-0 \
python3[25925]: ansible-dnf Invoked with name=['ovirt-hosted-engine-setup'] \
state=present allow_downgrade=False autoremove=False bugfix=False \
disable_gpg_check=False disable_plugin=[] disablerepo=[] download_only=False \
enable_plugin=[] enablerepo=[] exclude=[] installroot=/ install_repoquery=True \
install_weak_deps=True security=False skip_broken=False update_cache=False \
update_only=False validate_certs=True lock_timeout=30 conf_file=None \
disable_excludes=None download_dir=None list=None releasever=None \
2021-12-17T01:11:03.715282+0100 ost-basic-suite-master-host-0 python3[25942]: \
ansible-dnf Invoked with name=['ovirt-host'] state=present allow_downgrade=False \
autoremove=False bugfix=False disable_gpg_check=False disable_plugin=[] \
disablerepo=[] download_only=False enable_plugin=[] enablerepo=[] exclude=[] \
installroot=/ install_repoquery=True install_weak_deps=True security=False \
skip_broken=False update_cache=False update_only=False validate_certs=True \
lock_timeout=30 conf_file=None disable_excludes=None download_dir=None list=None \
releasever=None 2021-12-17T01:11:04.429825+0100 ost-basic-suite-master-host-0 \
python3[25959]: ansible-package_facts Invoked with manager=['auto'] strategy=first \
2021-12-17T01:11:06.296524+0100 ost-basic-suite-master-host-0 python3[26038]: \
ansible-stat Invoked with path=/etc/vdsm/vdsm.id follow=False get_md5=False \
get_checksum=True get_mime=True get_attributes=True checksum_algorithm=sha1 \
2021-12-17T01:11:06.539520+0100 ost-basic-suite-master-host-0 platform-python[26100]: \
ansible-command Invoked with _raw_params=chronyc makestep _uses_shell=True warn=True \
stdin_add_newline=True strip_empty_ends=True argv=None chdir=None executable=None \
creates=None removes=None stdin=None 2021-12-17T01:11:06.678627+0100 \
ost-basic-suite-master-host-0 chronyd[1111]: System clock was stepped by 0.000111 \
seconds 2021-12-17T01:11:07.380574+0100 ost-basic-suite-master-host-0 python3[26134]: \
ansible-dnf Invoked with name=['dmidecode'] state=present allow_downgrade=False \
autoremove=False bugfix=False disable_gpg_check=False disable_plugin=[] \
disablerepo=[] download_only=False enable_plugin=[] enablerepo=[] exclude=[] \
installroot=/ install_repoquery=True install_weak_deps=True security=False \
skip_broken=False update_cache=False update_only=False validate_certs=True \
lock_timeout=30 conf_file=None disable_excludes=None download_dir=None list=None \
releasever=None 2021-12-17T01:11:08.127733+0100 ost-basic-suite-master-host-0 \
python3[26151]: ansible-command Invoked with _raw_params=dmidecode -s system-uuid \
_uses_shell=True warn=True stdin_add_newline=True strip_empty_ends=True argv=None \
chdir=None executable=None creates=None removes=None stdin=None \
2021-12-17T01:11:09.832093+0100 ost-basic-suite-master-host-0 python3[26205]: \
ansible-stat Invoked with path=/etc/vdsm/vdsm.id follow=False get_checksum=True \
checksum_algorithm=sha1 get_md5=False get_mime=True get_attributes=True \
2021-12-17T01:11:09.838092+0100 ost-basic-suite-master-host-0 systemd[1]: Starting \
system activity accounting tool... 2021-12-17T01:11:09.850830+0100 \
ost-basic-suite-master-host-0 systemd[1]: sysstat-collect.service: Succeeded. \
2021-12-17T01:11:09.851202+0100 ost-basic-suite-master-host-0 systemd[1]: Started \
system activity accounting tool. 2021-12-17T01:11:10.436739+0100 \
ost-basic-suite-master-host-0 python3[26255]: ansible-copy Invoked with \
dest=/etc/vdsm/vdsm.id owner=root mode=420 \
src=/root/.ansible/tmp/ansible-tmp-1639699869.5210207-53061-102125153259888/source \
_original_basename=tmp_1bcyw83 follow=False \
checksum=a5454695ee9fadcbac7f33df78a447f23307a3d9 backup=False force=True \
unsafe_writes=False content=NOT_LOGGING_PARAMETER validate=None directory_mode=None \
remote_src=None local_follow=None group=None seuser=None serole=None selevel=None \
setype=None attributes=None regexp=None delimiter=None \
2021-12-17T01:11:11.007873+0100 ost-basic-suite-master-host-0 python3[26290]: \
ansible-slurp Invoked with src=/etc/vdsm/vdsm.id 2021-12-17T01:11:11.982092+0100 \
ost-basic-suite-master-host-0 python3[26343]: ansible-stat Invoked with \
path=/etc/vdsm/vdsm.conf follow=False get_checksum=True checksum_algorithm=sha1 \
get_md5=False get_mime=True get_attributes=True 2021-12-17T01:11:12.477354+0100 \
ost-basic-suite-master-host-0 python3[26393]: ansible-copy Invoked with \
dest=/etc/vdsm/vdsm.conf owner=root mode=420 \
src=/root/.ansible/tmp/ansible-tmp-1639699871.6537814-53081-189344990661756/source \
_original_basename=tmphkn11gs4 follow=False \
checksum=01c4588721d288464896162d1019e8f666c5211e backup=False force=True \
unsafe_writes=False content=NOT_LOGGING_PARAMETER validate=None directory_mode=None \
remote_src=None local_follow=None group=None seuser=None serole=None selevel=None \
setype=None attributes=None regexp=None delimiter=None \
2021-12-17T01:11:13.236384+0100 ost-basic-suite-master-host-0 python3[26428]: \
ansible-tempfile Invoked with state=file suffix=vdsm prefix=ansible. path=None \
2021-12-17T01:11:13.518432+0100 ost-basic-suite-master-host-0 python3[26445]: \
ansible-tempfile Invoked with state=file suffix=qemu prefix=ansible. path=None \
2021-12-17T01:11:13.931343+0100 ost-basic-suite-master-host-0 python3[26462]: \
                ansible-command Invoked with _raw_params='/usr/bin/openssl'
                                                                              'req'
                                                                              '-new'
                                                                              \
                '-newkey'
                                                                              \
                'rsa:2048'
                                                                              \
                '-nodes'
                                                                              '-subj'
                                                                              '/'
                                                                              \
                '-keyout'
                                                                              \
'/tmp/ansible.whn6d71tvdsm'  warn=True _uses_shell=False stdin_add_newline=True \
strip_empty_ends=True argv=None chdir=None executable=None creates=None removes=None \
stdin=None 2021-12-17T01:11:14.800087+0100 ost-basic-suite-master-host-0 \
                python3[26488]: ansible-command Invoked with \
                _raw_params='/usr/bin/openssl'
                                                                              'req'
                                                                              '-new'
                                                                              \
                '-newkey'
                                                                              \
                'rsa:2048'
                                                                              \
                '-nodes'
                                                                              '-subj'
                                                                              '/'
                                                                              \
                '-keyout'
                                                                              \
'/tmp/ansible.3os6jzxuqemu'  warn=True _uses_shell=False stdin_add_newline=True \
strip_empty_ends=True argv=None chdir=None executable=None creates=None removes=None \
stdin=None 2021-12-17T01:11:20.774239+0100 ost-basic-suite-master-host-0 \
python3[26507]: ansible-file Invoked with dest=/etc/pki/vdsm/certs state=directory \
owner=vdsm group=kvm path=/etc/pki/vdsm/certs recurse=False force=False follow=True \
modification_time_format=%Y%m%d%H%M.%S access_time_format=%Y%m%d%H%M.%S \
unsafe_writes=False _original_basename=None _diff_peek=None src=None \
modification_time=None access_time=None mode=None seuser=None serole=None \
selevel=None setype=None attributes=None content=NOT_LOGGING_PARAMETER backup=None \
remote_src=None regexp=None delimiter=None directory_mode=None \
2021-12-17T01:11:21.067752+0100 ost-basic-suite-master-host-0 python3[26524]: \
ansible-file Invoked with dest=/etc/pki/vdsm/keys state=directory owner=vdsm \
group=kvm path=/etc/pki/vdsm/keys recurse=False force=False follow=True \
modification_time_format=%Y%m%d%H%M.%S access_time_format=%Y%m%d%H%M.%S \
unsafe_writes=False _original_basename=None _diff_peek=None src=None \
modification_time=None access_time=None mode=None seuser=None serole=None \
selevel=None setype=None attributes=None content=NOT_LOGGING_PARAMETER backup=None \
remote_src=None regexp=None delimiter=None directory_mode=None \
2021-12-17T01:11:21.396289+0100 ost-basic-suite-master-host-0 python3[26541]: \
ansible-file Invoked with dest=/etc/pki/vdsm/libvirt-migrate state=directory \
owner=vdsm group=kvm path=/etc/pki/vdsm/libvirt-migrate recurse=False force=False \
follow=True modification_time_format=%Y%m%d%H%M.%S access_time_format=%Y%m%d%H%M.%S \
unsafe_writes=False _original_basename=None _diff_peek=None src=None \
modification_time=None access_time=None mode=None seuser=None serole=None \
selevel=None setype=None attributes=None content=NOT_LOGGING_PARAMETER backup=None \
remote_src=None regexp=None delimiter=None directory_mode=None \
2021-12-17T01:11:21.660425+0100 ost-basic-suite-master-host-0 python3[26558]: \
ansible-file Invoked with dest=/etc/pki/vdsm/libvirt-migrate state=directory \
owner=vdsm group=kvm path=/etc/pki/vdsm/libvirt-migrate recurse=False force=False \
follow=True modification_time_format=%Y%m%d%H%M.%S access_time_format=%Y%m%d%H%M.%S \
unsafe_writes=False _original_basename=None _diff_peek=None src=None \
modification_time=None access_time=None mode=None seuser=None serole=None \
selevel=None setype=None attributes=None content=NOT_LOGGING_PARAMETER backup=None \
remote_src=None regexp=None delimiter=None directory_mode=None \
2021-12-17T01:11:21.923614+0100 ost-basic-suite-master-host-0 python3[26575]: \
ansible-file Invoked with dest=/etc/pki/vdsm/libvirt-spice state=directory owner=vdsm \
group=kvm path=/etc/pki/vdsm/libvirt-spice recurse=False force=False follow=True \
modification_time_format=%Y%m%d%H%M.%S access_time_format=%Y%m%d%H%M.%S \
unsafe_writes=False _original_basename=None _diff_peek=None src=None \
modification_time=None access_time=None mode=None seuser=None serole=None \
selevel=None setype=None attributes=None content=NOT_LOGGING_PARAMETER backup=None \
remote_src=None regexp=None delimiter=None directory_mode=None \
2021-12-17T01:11:22.209958+0100 ost-basic-suite-master-host-0 python3[26592]: \
ansible-file Invoked with dest=/etc/pki/libvirt/private state=directory owner=vdsm \
group=kvm path=/etc/pki/libvirt/private recurse=False force=False follow=True \
modification_time_format=%Y%m%d%H%M.%S access_time_format=%Y%m%d%H%M.%S \
unsafe_writes=False _original_basename=None _diff_peek=None src=None \
modification_time=None access_time=None mode=None seuser=None serole=None \
selevel=None setype=None attributes=None content=NOT_LOGGING_PARAMETER backup=None \
remote_src=None regexp=None delimiter=None directory_mode=None \
2021-12-17T01:11:22.496198+0100 ost-basic-suite-master-host-0 python3[26609]: \
ansible-file Invoked with dest=/etc/pki/libvirt/../CA state=directory owner=vdsm \
group=kvm path=/etc/pki/libvirt/../CA recurse=False force=False follow=True \
modification_time_format=%Y%m%d%H%M.%S access_time_format=%Y%m%d%H%M.%S \
unsafe_writes=False _original_basename=None _diff_peek=None src=None \
modification_time=None access_time=None mode=None seuser=None serole=None \
selevel=None setype=None attributes=None content=NOT_LOGGING_PARAMETER backup=None \
remote_src=None regexp=None delimiter=None directory_mode=None \
2021-12-17T01:11:23.006810+0100 ost-basic-suite-master-host-0 python3[26662]: \
ansible-stat Invoked with path=/etc/pki/vdsm/certs/cacert.pem follow=False \
get_checksum=True checksum_algorithm=sha1 get_md5=False get_mime=True \
get_attributes=True 2021-12-17T01:11:23.450451+0100 ost-basic-suite-master-host-0 \
python3[26712]: ansible-copy Invoked with dest=/etc/pki/vdsm/certs/cacert.pem \
owner=root group=kvm mode=420 \
src=/root/.ansible/tmp/ansible-tmp-1639699882.6765356-53228-22565229978581/source \
_original_basename=tmpf90ncrqo follow=False \
checksum=5bc7eca619b5d73e80252392b8b978a0616604f1 backup=False force=True \
unsafe_writes=False content=NOT_LOGGING_PARAMETER validate=None directory_mode=None \
remote_src=None local_follow=None seuser=None serole=None selevel=None setype=None \
attributes=None regexp=None delimiter=None 2021-12-17T01:11:23.921633+0100 \
ost-basic-suite-master-host-0 python3[26783]: ansible-stat Invoked with \
path=/etc/pki/vdsm/libvirt-spice/ca-cert.pem follow=False get_checksum=True \
checksum_algorithm=sha1 get_md5=False get_mime=True get_attributes=True \
2021-12-17T01:11:24.359778+0100 ost-basic-suite-master-host-0 python3[26831]: \
ansible-copy Invoked with dest=/etc/pki/vdsm/libvirt-spice/ca-cert.pem owner=root \
group=kvm mode=420 src=/root/.ansible/tmp/ansible-tmp-1639699883.5962253-53228-145078932261625/source \
_original_basename=tmp_vx3qja8 follow=False \
checksum=5bc7eca619b5d73e80252392b8b978a0616604f1 backup=False force=True \
unsafe_writes=False content=NOT_LOGGING_PARAMETER validate=None directory_mode=None \
remote_src=None local_follow=None seuser=None serole=None selevel=None setype=None \
attributes=None regexp=None delimiter=None 2021-12-17T01:11:24.829021+0100 \
ost-basic-suite-master-host-0 python3[26902]: ansible-stat Invoked with \
path=/etc/pki/libvirt/../CA/cacert.pem follow=False get_checksum=True \
checksum_algorithm=sha1 get_md5=False get_mime=True get_attributes=True \
2021-12-17T01:11:25.336135+0100 ost-basic-suite-master-host-0 systemd[1]: Starting \
system activity accounting tool... 2021-12-17T01:11:25.352229+0100 \
ost-basic-suite-master-host-0 systemd[1]: sysstat-collect.service: Succeeded. \
2021-12-17T01:11:25.352692+0100 ost-basic-suite-master-host-0 systemd[1]: Started \
system activity accounting tool. 2021-12-17T01:11:25.353908+0100 \
ost-basic-suite-master-host-0 python3[26950]: ansible-copy Invoked with \
dest=/etc/pki/libvirt/../CA/cacert.pem owner=root group=kvm mode=420 \
src=/root/.ansible/tmp/ansible-tmp-1639699884.5247514-53228-26963346119510/source \
_original_basename=tmpxciogrzf follow=False \
checksum=5bc7eca619b5d73e80252392b8b978a0616604f1 backup=False force=True \
unsafe_writes=False content=NOT_LOGGING_PARAMETER validate=None directory_mode=None \
remote_src=None local_follow=None seuser=None serole=None selevel=None setype=None \
attributes=None regexp=None delimiter=None 2021-12-17T01:11:25.971506+0100 \
ost-basic-suite-master-host-0 python3[27023]: ansible-stat Invoked with \
path=/etc/pki/vdsm/libvirt-migrate/ca-cert.pem follow=False get_checksum=True \
checksum_algorithm=sha1 get_md5=False get_mime=True get_attributes=True \
2021-12-17T01:11:26.432927+0100 ost-basic-suite-master-host-0 python3[27071]: \
ansible-copy Invoked with dest=/etc/pki/vdsm/libvirt-migrate/ca-cert.pem owner=root \
group=kvm mode=420 src=/root/.ansible/tmp/ansible-tmp-1639699885.6578836-53271-237489777304337/source \
_original_basename=tmpl04ea2e1 follow=False \
checksum=812ee9548b1773a2c69d63c7486edc2a19422d1a backup=False force=True \
unsafe_writes=False content=NOT_LOGGING_PARAMETER validate=None directory_mode=None \
remote_src=None local_follow=None seuser=None serole=None selevel=None setype=None \
attributes=None regexp=None delimiter=None 2021-12-17T01:11:26.986435+0100 \
ost-basic-suite-master-host-0 python3[27142]: ansible-stat Invoked with \
path=/etc/pki/vdsm/certs/vdsmcert.pem follow=False get_checksum=True \
checksum_algorithm=sha1 get_md5=False get_mime=True get_attributes=True \
2021-12-17T01:11:27.460829+0100 ost-basic-suite-master-host-0 python3[27192]: \
ansible-copy Invoked with \
src=/root/.ansible/tmp/ansible-tmp-1639699886.6892529-53282-19659728535643/source \
dest=/etc/pki/vdsm/certs/vdsmcert.pem owner=root group=kvm mode=420 remote_src=False \
_original_basename=ost-basic-suite-master-host-0.cer follow=False \
checksum=a2577dcdbd9044901d6fbf6976ace4bebfd4e22d backup=False force=True \
unsafe_writes=False content=NOT_LOGGING_PARAMETER validate=None directory_mode=None \
local_follow=None seuser=None serole=None selevel=None setype=None attributes=None \
regexp=None delimiter=None 2021-12-17T01:11:27.964231+0100 \
ost-basic-suite-master-host-0 python3[27263]: ansible-stat Invoked with \
path=/etc/pki/vdsm/libvirt-spice/server-cert.pem follow=False get_checksum=True \
checksum_algorithm=sha1 get_md5=False get_mime=True get_attributes=True \
2021-12-17T01:11:28.374514+0100 ost-basic-suite-master-host-0 python3[27311]: \
ansible-copy Invoked with \
src=/root/.ansible/tmp/ansible-tmp-1639699887.6410706-53282-250790792666784/source \
dest=/etc/pki/vdsm/libvirt-spice/server-cert.pem owner=root group=kvm mode=420 \
remote_src=False _original_basename=ost-basic-suite-master-host-0.cer follow=False \
checksum=a2577dcdbd9044901d6fbf6976ace4bebfd4e22d backup=False force=True \
unsafe_writes=False content=NOT_LOGGING_PARAMETER validate=None directory_mode=None \
local_follow=None seuser=None serole=None selevel=None setype=None attributes=None \
regexp=None delimiter=None 2021-12-17T01:11:28.854471+0100 \
ost-basic-suite-master-host-0 python3[27382]: ansible-stat Invoked with \
path=/etc/pki/libvirt/clientcert.pem follow=False get_checksum=True \
checksum_algorithm=sha1 get_md5=False get_mime=True get_attributes=True \
2021-12-17T01:11:29.296797+0100 ost-basic-suite-master-host-0 python3[27430]: \
ansible-copy Invoked with \
src=/root/.ansible/tmp/ansible-tmp-1639699888.545461-53282-227704074992157/source \
dest=/etc/pki/libvirt/clientcert.pem owner=root group=kvm mode=420 remote_src=False \
_original_basename=ost-basic-suite-master-host-0.cer follow=False \
checksum=a2577dcdbd9044901d6fbf6976ace4bebfd4e22d backup=False force=True \
unsafe_writes=False content=NOT_LOGGING_PARAMETER validate=None directory_mode=None \
local_follow=None seuser=None serole=None selevel=None setype=None attributes=None \
regexp=None delimiter=None 2021-12-17T01:11:29.883771+0100 \
ost-basic-suite-master-host-0 python3[27501]: ansible-stat Invoked with \
path=/etc/pki/vdsm/libvirt-migrate/server-cert.pem follow=False get_checksum=True \
checksum_algorithm=sha1 get_md5=False get_mime=True get_attributes=True \
2021-12-17T01:11:30.342920+0100 ost-basic-suite-master-host-0 python3[27549]: \
ansible-copy Invoked with \
src=/root/.ansible/tmp/ansible-tmp-1639699889.5683546-53312-1269113343358/source \
dest=/etc/pki/vdsm/libvirt-migrate/server-cert.pem owner=root group=kvm \
remote_src=False mode=0644 _original_basename=ost-basic-suite-master-host-0.cer \
follow=False checksum=9d8d58f1f6666822ca4543f6550c24d2306c2c94 backup=False \
force=True unsafe_writes=False content=NOT_LOGGING_PARAMETER validate=None \
directory_mode=None local_follow=None seuser=None serole=None selevel=None \
setype=None attributes=None regexp=None delimiter=None \
2021-12-17T01:11:30.771749+0100 ost-basic-suite-master-host-0 python3[27584]: \
ansible-file Invoked with src=server-cert.pem \
dest=/etc/pki/vdsm/libvirt-migrate/client-cert.pem state=link \
path=/etc/pki/vdsm/libvirt-migrate/client-cert.pem recurse=False force=False \
follow=True modification_time_format=%Y%m%d%H%M.%S access_time_format=%Y%m%d%H%M.%S \
unsafe_writes=False _original_basename=None _diff_peek=None modification_time=None \
access_time=None mode=None owner=None group=None seuser=None serole=None selevel=None \
setype=None attributes=None content=NOT_LOGGING_PARAMETER backup=None remote_src=None \
regexp=None delimiter=None directory_mode=None 2021-12-17T01:11:31.470745+0100 \
ost-basic-suite-master-host-0 python3[27637]: ansible-copy Invoked with \
src=/tmp/ansible.whn6d71tvdsm dest=/etc/pki/vdsm/keys/vdsmkey.pem owner=vdsm \
group=kvm mode=288 remote_src=True backup=False force=True follow=False \
unsafe_writes=False _original_basename=None content=NOT_LOGGING_PARAMETER \
validate=None directory_mode=None local_follow=None checksum=None seuser=None \
serole=None selevel=None setype=None attributes=None regexp=None delimiter=None \
2021-12-17T01:11:31.962977+0100 ost-basic-suite-master-host-0 python3[27708]: \
ansible-copy Invoked with src=/tmp/ansible.whn6d71tvdsm \
dest=/etc/pki/vdsm/libvirt-spice/server-key.pem owner=vdsm group=kvm mode=288 \
remote_src=True backup=False force=True follow=False unsafe_writes=False \
_original_basename=None content=NOT_LOGGING_PARAMETER validate=None \
directory_mode=None local_follow=None checksum=None seuser=None serole=None \
selevel=None setype=None attributes=None regexp=None delimiter=None \
2021-12-17T01:11:32.479149+0100 ost-basic-suite-master-host-0 python3[27779]: \
ansible-copy Invoked with src=/tmp/ansible.whn6d71tvdsm \
dest=/etc/pki/libvirt/private/clientkey.pem owner=vdsm group=kvm mode=288 \
remote_src=True backup=False force=True follow=False unsafe_writes=False \
_original_basename=None content=NOT_LOGGING_PARAMETER validate=None \
directory_mode=None local_follow=None checksum=None seuser=None serole=None \
selevel=None setype=None attributes=None regexp=None delimiter=None \
2021-12-17T01:11:33.175248+0100 ost-basic-suite-master-host-0 python3[27850]: \
ansible-copy Invoked with src=/tmp/ansible.3os6jzxuqemu \
dest=/etc/pki/vdsm/libvirt-migrate/server-key.pem owner=root group=qemu mode=288 \
remote_src=True backup=False force=True follow=False unsafe_writes=False \
_original_basename=None content=NOT_LOGGING_PARAMETER validate=None \
directory_mode=None local_follow=None checksum=None seuser=None serole=None \
selevel=None setype=None attributes=None regexp=None delimiter=None \
2021-12-17T01:11:33.620969+0100 ost-basic-suite-master-host-0 python3[27885]: \
ansible-file Invoked with src=server-key.pem \
dest=/etc/pki/vdsm/libvirt-migrate/client-key.pem state=link \
path=/etc/pki/vdsm/libvirt-migrate/client-key.pem recurse=False force=False \
follow=True modification_time_format=%Y%m%d%H%M.%S access_time_format=%Y%m%d%H%M.%S \
unsafe_writes=False _original_basename=None _diff_peek=None modification_time=None \
access_time=None mode=None owner=None group=None seuser=None serole=None selevel=None \
setype=None attributes=None content=NOT_LOGGING_PARAMETER backup=None remote_src=None \
regexp=None delimiter=None directory_mode=None 2021-12-17T01:11:34.008969+0100 \
2021-12-17T01:11:34.321305+0100 ost-basic-suite-master-host-0 python3[27919]: \
ansible-file Invoked with state=absent path=/tmp/ansible.3os6jzxuqemu recurse=False \
force=False follow=True modification_time_format=%Y%m%d%H%M.%S \
access_time_format=%Y%m%d%H%M.%S unsafe_writes=False _original_basename=None \
_diff_peek=None src=None modification_time=None access_time=None mode=None owner=None \
group=None seuser=None serole=None selevel=None setype=None attributes=None \
content=NOT_LOGGING_PARAMETER backup=None remote_src=None regexp=None delimiter=None \
directory_mode=None 2021-12-17T01:11:34.726848+0100 ost-basic-suite-master-host-0 \
python3[27936]: ansible-command Invoked with _raw_params=vdsm-tool config-lvm-filter \
-y warn=True _uses_shell=False stdin_add_newline=True strip_empty_ends=True argv=None \
chdir=None executable=None creates=None removes=None stdin=None \
2021-12-17T01:11:35.905977+0100 ost-basic-suite-master-host-0 python3[27959]: \
ansible-command Invoked with _raw_params=vdsm-tool configure --force warn=True \
_uses_shell=False stdin_add_newline=True strip_empty_ends=True argv=None chdir=None \
executable=None creates=None removes=None stdin=None 2021-12-17T01:11:36.521754+0100 \
ost-basic-suite-master-host-0 systemd[1]: Starting system activity accounting tool... \
2021-12-17T01:11:36.526826+0100 ost-basic-suite-master-host-0 systemd[1]: \
sysstat-collect.service: Succeeded. 2021-12-17T01:11:36.527169+0100 \
ost-basic-suite-master-host-0 systemd[1]: Started system activity accounting tool. \
2021-12-17T01:11:36.627618+0100 ost-basic-suite-master-host-0 \
sasldblistusers2[27971]: DIGEST-MD5 common mech free 2021-12-17T01:11:39.653963+0100 \
ost-basic-suite-master-host-0 systemd[1]: Stopping Virtualization daemon... \
2021-12-17T01:11:39.667826+0100 ost-basic-suite-master-host-0 systemd[1]: \
libvirtd.service: Succeeded. 2021-12-17T01:11:39.667864+0100 \
ost-basic-suite-master-host-0 systemd[1]: Stopped Virtualization daemon. \
2021-12-17T01:11:39.762025+0100 ost-basic-suite-master-host-0 systemd[1]: Reloading. \
2021-12-17T01:11:40.307389+0100 ost-basic-suite-master-host-0 systemd[1]: Starting \
system activity accounting tool... 2021-12-17T01:11:40.374741+0100 \
ost-basic-suite-master-host-0 systemd[1]: sysstat-collect.service: Succeeded. \
2021-12-17T01:11:40.375016+0100 ost-basic-suite-master-host-0 systemd[1]: Started \
system activity accounting tool. 2021-12-17T01:11:40.396519+0100 \
ost-basic-suite-master-host-0 systemd[1]: Reloading. 2021-12-17T01:11:40.943154+0100 \
ost-basic-suite-master-host-0 saslpasswd2[28028]: error deleting entry from sasldb: \
BDB0073 DB_NOTFOUND: No matching key/data pair found 2021-12-17T01:11:40.943239+0100 \
ost-basic-suite-master-host-0 saslpasswd2[28028]: error deleting entry from sasldb: \
BDB0073 DB_NOTFOUND: No matching key/data pair found 2021-12-17T01:11:40.943283+0100 \
ost-basic-suite-master-host-0 saslpasswd2[28028]: error deleting entry from sasldb: \
BDB0073 DB_NOTFOUND: No matching key/data pair found 2021-12-17T01:11:40.943296+0100 \
ost-basic-suite-master-host-0 saslpasswd2[28028]: DIGEST-MD5 common mech free \
2021-12-17T01:11:41.517456+0100 ost-basic-suite-master-host-0 systemd[1]: \
libvirtd.service: Found left-over process 1883 (dnsmasq) in control group while \
starting unit. Ignoring. 2021-12-17T01:11:41.517463+0100 \
ost-basic-suite-master-host-0 systemd[1]: This usually indicates unclean termination \
of a previous run, or service implementation deficiencies. \
2021-12-17T01:11:41.517541+0100 ost-basic-suite-master-host-0 systemd[1]: \
libvirtd.service: Found left-over process 1884 (dnsmasq) in control group while \
starting unit. Ignoring. 2021-12-17T01:11:41.517543+0100 \
ost-basic-suite-master-host-0 systemd[1]: This usually indicates unclean termination \
of a previous run, or service implementation deficiencies. \
2021-12-17T01:11:41.518801+0100 ost-basic-suite-master-host-0 systemd[1]: Starting \
Virtualization daemon... 2021-12-17T01:11:41.667811+0100 \
ost-basic-suite-master-host-0 libvirtd[28031]: 2021-12-17 00:11:41.667+0000: 28031: \
info : libvirt version: 7.10.0, package: 1.module_el8.6.0+1046+bd8eec5e (CentOS \
Buildsys &lt;bugs@centos.org&gt;, 2021-12-13-15:33:57, ) 2021-12-17T01:11:41.667811+0100 \
ost-basic-suite-master-host-0 libvirtd[28031]: 2021-12-17 00:11:41.667+0000: 28031: \
info : hostname: ost-basic-suite-master-host-0 2021-12-17T01:11:41.667811+0100 \
ost-basic-suite-master-host-0 libvirtd[28031]: 2021-12-17 00:11:41.667+0000: 28031: \
debug : virLogParseOutputs:1621 : outputs=1:file:/var/log/libvirt.log \
2021-12-17T01:11:41.667811+0100 ost-basic-suite-master-host-0 libvirtd[28031]: \
2021-12-17 00:11:41.667+0000: 28031: debug : virLogParseOutput:1468 : \
output=1:file:/var/log/libvirt.log 2021-12-17T01:11:41.757125+0100 \
ost-basic-suite-master-host-0 kernel: libvirtd[28031]: segfault at 29 ip \
00007f13a20f7cd1 sp 00007ffc9bd356f0 error 4 in libc-2.28.so[7f13a205b000+1bc000] \
2021-12-17T01:11:41.758334+0100 ost-basic-suite-master-host-0 kernel: Code: 1f 84 00 \
00 00 00 00 66 90 f3 0f 1e fa 53 48 83 ec 10 48 8b 05 30 22 32 00 48 8b 00 48 85 c0 \
0f 85 84 00 00 00 48 85 ff 74 6f &lt;48&gt; 8b 47 f8 48 8d 77 f0 a8 02 75 3b 48 8b 15 84 20 \
32 00 64 48 83 2021-12-17T01:11:41.837631+0100 ost-basic-suite-master-host-0 \
systemd[1]: Created slice system-systemd\x2dcoredump.slice. \
2021-12-17T01:11:41.839093+0100 ost-basic-suite-master-host-0 systemd[1]: Started \
Process Core Dump (PID 28047/UID 0). 2021-12-17T01:11:42.617966+0100 \
ost-basic-suite-master-host-0 systemd-coredump[28048]: Process 28031 (libvirtd) of \
                user 0 dumped core.
                                                                                      \
                
                                                                                      \
                Stack trace of thread 28031:
                                                                                      \
                #0  0x00007f13a20f7cd1 __libc_free (libc.so.6)
                                                                                      \
                #1  0x00007f13a14194cd wrap_nettle_mpi_release (libgnutls.so.30)
                                                                                      \
                #2  0x00007f13a131948f gnutls_dh_params_deinit (libgnutls.so.30)
                                                                                      \
                #3  0x00007f13a3765e6b virNetTLSContextDispose (libvirt.so.0)
                                                                                      \
                #4  0x00007f13a369b38e vir_object_finalize (libvirt.so.0)
                                                                                      \
                #5  0x00007f13a2c2a8a9 g_object_unref (libgobject-2.0.so.0)
                                                                                      \
                #6  0x00007f13a369b808 virObjectUnref (libvirt.so.0)
                                                                                      \
                #7  0x00007f13a3767b4a virNetTLSContextNew (libvirt.so.0)
                                                                                      \
                #8  0x00007f13a3767e0b virNetTLSContextNewServer (libvirt.so.0)
                                                                                      \
                #9  0x000056400aedf4b0 main (libvirtd)
                                                                                      \
                #10 0x00007f13a2095ca3 __libc_start_main (libc.so.6)
                                                                                      \
                #11 0x000056400aedffce _start (libvirtd)
                                                                                      \
                
                                                                                      \
                Stack trace of thread 28045:
                                                                                      \
                #0  0x00007f139f9af51e pthread_cond_wait@@GLIBC_2.3.2 \
                (libpthread.so.0)
                                                                                      \
                #1  0x00007f13a36b802a virCondWait (libvirt.so.0)
                                                                                      \
                #2  0x00007f13a36b8bc3 virThreadPoolWorker (libvirt.so.0)
                                                                                      \
                #3  0x00007f13a36b817b virThreadHelper (libvirt.so.0)
                                                                                      \
                #4  0x00007f139f9a917a start_thread (libpthread.so.0)
                                                                                      \
                #5  0x00007f13a2094d83 __clone (libc.so.6)
                                                                                      \
                
                                                                                      \
                Stack trace of thread 28036:
                                                                                      \
                #0  0x00007f139f9af51e pthread_cond_wait@@GLIBC_2.3.2 \
                (libpthread.so.0)
                                                                                      \
                #1  0x00007f13a36b802a virCondWait (libvirt.so.0)
                                                                                      \
                #2  0x00007f13a36b8bc3 virThreadPoolWorker (libvirt.so.0)
                                                                                      \
                #3  0x00007f13a36b817b virThreadHelper (libvirt.so.0)
                                                                                      \
                #4  0x00007f139f9a917a start_thread (libpthread.so.0)
                                                                                      \
                #5  0x00007f13a2094d83 __clone (libc.so.6)
                                                                                      \
                
                                                                                      \
                Stack trace of thread 28037:
                                                                                      \
                #0  0x00007f139f9af51e pthread_cond_wait@@GLIBC_2.3.2 \
                (libpthread.so.0)
                                                                                      \
                #1  0x00007f13a36b802a virCondWait (libvirt.so.0)
                                                                                      \
                #2  0x00007f13a36b8b4f virThreadPoolWorker (libvirt.so.0)
                                                                                      \
                #3  0x00007f13a36b817b virThreadHelper (libvirt.so.0)
                                                                                      \
                #4  0x00007f139f9a917a start_thread (libpthread.so.0)
                                                                                      \
                #5  0x00007f13a2094d83 __clone (libc.so.6)
                                                                                      \
                
                                                                                      \
                Stack trace of thread 28039:
                                                                                      \
                #0  0x00007f139f9af51e pthread_cond_wait@@GLIBC_2.3.2 \
                (libpthread.so.0)
                                                                                      \
                #1  0x00007f13a36b802a virCondWait (libvirt.so.0)
                                                                                      \
                #2  0x00007f13a36b8b4f virThreadPoolWorker (libvirt.so.0)
                                                                                      \
                #3  0x00007f13a36b817b virThreadHelper (libvirt.so.0)
                                                                                      \
                #4  0x00007f139f9a917a start_thread (libpthread.so.0)
                                                                                      \
                #5  0x00007f13a2094d83 __clone (libc.so.6)
                                                                                      \
                
                                                                                      \
                Stack trace of thread 28041:
                                                                                      \
                #0  0x00007f139f9af51e pthread_cond_wait@@GLIBC_2.3.2 \
                (libpthread.so.0)
                                                                                      \
                #1  0x00007f13a36b802a virCondWait (libvirt.so.0)
                                                                                      \
                #2  0x00007f13a36b8b4f virThreadPoolWorker (libvirt.so.0)
                                                                                      \
                #3  0x00007f13a36b817b virThreadHelper (libvirt.so.0)
                                                                                      \
                #4  0x00007f139f9a917a start_thread (libpthread.so.0)
                                                                                      \
                #5  0x00007f13a2094d83 __clone (libc.so.6)
                                                                                      \
                
                                                                                      \
                Stack trace of thread 28046:
                                                                                      \
                #0  0x00007f139f9af51e pthread_cond_wait@@GLIBC_2.3.2 \
                (libpthread.so.0)
                                                                                      \
                #1  0x00007f13a36b802a virCondWait (libvirt.so.0)
                                                                                      \
                #2  0x00007f13a36b8bc3 virThreadPoolWorker (libvirt.so.0)
                                                                                      \
                #3  0x00007f13a36b817b virThreadHelper (libvirt.so.0)
                                                                                      \
                #4  0x00007f139f9a917a start_thread (libpthread.so.0)
                                                                                      \
                #5  0x00007f13a2094d83 __clone (libc.so.6)
                                                                                      \
                
                                                                                      \
                Stack trace of thread 28043:
                                                                                      \
                #0  0x00007f139f9af51e pthread_cond_wait@@GLIBC_2.3.2 \
                (libpthread.so.0)
                                                                                      \
                #1  0x00007f13a36b802a virCondWait (libvirt.so.0)
                                                                                      \
                #2  0x00007f13a36b8bc3 virThreadPoolWorker (libvirt.so.0)
                                                                                      \
                #3  0x00007f13a36b817b virThreadHelper (libvirt.so.0)
                                                                                      \
                #4  0x00007f139f9a917a start_thread (libpthread.so.0)
                                                                                      \
                #5  0x00007f13a2094d83 __clone (libc.so.6)
                                                                                      \
                
                                                                                      \
                Stack trace of thread 28042:
                                                                                      \
                #0  0x00007f139f9af51e pthread_cond_wait@@GLIBC_2.3.2 \
                (libpthread.so.0)
                                                                                      \
                #1  0x00007f13a36b802a virCondWait (libvirt.so.0)
                                                                                      \
                #2  0x00007f13a36b8bc3 virThreadPoolWorker (libvirt.so.0)
                                                                                      \
                #3  0x00007f13a36b817b virThreadHelper (libvirt.so.0)
                                                                                      \
                #4  0x00007f139f9a917a start_thread (libpthread.so.0)
                                                                                      \
                #5  0x00007f13a2094d83 __clone (libc.so.6)
                                                                                      \
                
                                                                                      \
                Stack trace of thread 28040:
                                                                                      \
                #0  0x00007f139f9af51e pthread_cond_wait@@GLIBC_2.3.2 \
                (libpthread.so.0)
                                                                                      \
                #1  0x00007f13a36b802a virCondWait (libvirt.so.0)
                                                                                      \
                #2  0x00007f13a36b8b4f virThreadPoolWorker (libvirt.so.0)
                                                                                      \
                #3  0x00007f13a36b817b virThreadHelper (libvirt.so.0)
                                                                                      \
                #4  0x00007f139f9a917a start_thread (libpthread.so.0)
                                                                                      \
                #5  0x00007f13a2094d83 __clone (libc.so.6)
                                                                                      \
                
                                                                                      \
                Stack trace of thread 28038:
                                                                                      \
                #0  0x00007f139f9af51e pthread_cond_wait@@GLIBC_2.3.2 \
                (libpthread.so.0)
                                                                                      \
                #1  0x00007f13a36b802a virCondWait (libvirt.so.0)
                                                                                      \
                #2  0x00007f13a36b8b4f virThreadPoolWorker (libvirt.so.0)
                                                                                      \
                #3  0x00007f13a36b817b virThreadHelper (libvirt.so.0)
                                                                                      \
                #4  0x00007f139f9a917a start_thread (libpthread.so.0)
                                                                                      \
                #5  0x00007f13a2094d83 __clone (libc.so.6)
                                                                                      \
                
                                                                                      \
                Stack trace of thread 28035:
                                                                                      \
                #0  0x00007f139f9af51e pthread_cond_wait@@GLIBC_2.3.2 \
                (libpthread.so.0)
                                                                                      \
                #1  0x00007f13a36b802a virCondWait (libvirt.so.0)
                                                                                      \
                #2  0x00007f13a36b8bc3 virThreadPoolWorker (libvirt.so.0)
                                                                                      \
                #3  0x00007f13a36b817b virThreadHelper (libvirt.so.0)
                                                                                      \
                #4  0x00007f139f9a917a start_thread (libpthread.so.0)
                                                                                      \
                #5  0x00007f13a2094d83 __clone (libc.so.6)
                                                                                      \
                
                                                                                      \
                Stack trace of thread 28034:
                                                                                      \
                #0  0x00007f139f9af51e pthread_cond_wait@@GLIBC_2.3.2 \
                (libpthread.so.0)
                                                                                      \
                #1  0x00007f13a36b802a virCondWait (libvirt.so.0)
                                                                                      \
                #2  0x00007f13a36b8bc3 virThreadPoolWorker (libvirt.so.0)
                                                                                      \
                #3  0x00007f13a36b817b virThreadHelper (libvirt.so.0)
                                                                                      \
                #4  0x00007f139f9a917a start_thread (libpthread.so.0)
                                                                                      \
                #5  0x00007f13a2094d83 __clone (libc.so.6)
                                                                                      \
                
                                                                                      \
                Stack trace of thread 28033:
                                                                                      \
                #0  0x00007f139f9af51e pthread_cond_wait@@GLIBC_2.3.2 \
                (libpthread.so.0)
                                                                                      \
                #1  0x00007f13a36b802a virCondWait (libvirt.so.0)
                                                                                      \
                #2  0x00007f13a36b8bc3 virThreadPoolWorker (libvirt.so.0)
                                                                                      \
                #3  0x00007f13a36b817b virThreadHelper (libvirt.so.0)
                                                                                      \
                #4  0x00007f139f9a917a start_thread (libpthread.so.0)
                                                                                      \
                #5  0x00007f13a2094d83 __clone (libc.so.6)
                                                                                      \
                
                                                                                      \
                Stack trace of thread 28032:
                                                                                      \
                #0  0x00007f139f9af51e pthread_cond_wait@@GLIBC_2.3.2 \
                (libpthread.so.0)
                                                                                      \
                #1  0x00007f13a36b802a virCondWait (libvirt.so.0)
                                                                                      \
                #2  0x00007f13a36b8bc3 virThreadPoolWorker (libvirt.so.0)
                                                                                      \
                #3  0x00007f13a36b817b virThreadHelper (libvirt.so.0)
                                                                                      \
                #4  0x00007f139f9a917a start_thread (libpthread.so.0)
                                                                                      \
                #5  0x00007f13a2094d83 __clone (libc.so.6)
                                                                                      \
                
                                                                                      \
                Stack trace of thread 28044:
                                                                                      \
                #0  0x00007f139f9af51e pthread_cond_wait@@GLIBC_2.3.2 \
                (libpthread.so.0)
                                                                                      \
                #1  0x00007f13a36b802a virCondWait (libvirt.so.0)
                                                                                      \
                #2  0x00007f13a36b8bc3 virThreadPoolWorker (libvirt.so.0)
                                                                                      \
                #3  0x00007f13a36b817b virThreadHelper (libvirt.so.0)
                                                                                      \
                #4  0x00007f139f9a917a start_thread (libpthread.so.0)
                                                                                      \
#5  0x00007f13a2094d83 __clone (libc.so.6) 2021-12-17T01:11:42.651614+0100 \
ost-basic-suite-master-host-0 systemd[1]: libvirtd.service: Main process exited, \
code=dumped, status=11/SEGV 2021-12-17T01:11:42.651722+0100 \
ost-basic-suite-master-host-0 systemd[1]: libvirtd.service: Failed with result \
'core-dump'. 2021-12-17T01:11:42.651826+0100 ost-basic-suite-master-host-0 \
systemd[1]: Failed to start Virtualization daemon. 2021-12-17T01:11:42.666235+0100 \
ost-basic-suite-master-host-0 systemd[1]: systemd-coredump@0-28047-0.service: \
Succeeded. 2021-12-17T01:11:42.769566+0100 ost-basic-suite-master-host-0 systemd[1]: \
libvirtd.service: Service RestartSec=100ms expired, scheduling restart. \
2021-12-17T01:11:42.770054+0100 ost-basic-suite-master-host-0 systemd[1]: \
libvirtd.service: Scheduled restart job, restart counter is at 1. \
2021-12-17T01:11:42.770198+0100 ost-basic-suite-master-host-0 systemd[1]: Stopped \
Virtualization daemon. 2021-12-17T01:11:42.770329+0100 ost-basic-suite-master-host-0 \
systemd[1]: libvirtd.service: Found left-over process 1883 (dnsmasq) in control group \
while starting unit. Ignoring. 2021-12-17T01:11:42.770331+0100 \
ost-basic-suite-master-host-0 systemd[1]: This usually indicates unclean termination \
of a previous run, or service implementation deficiencies. \
2021-12-17T01:11:42.770409+0100 ost-basic-suite-master-host-0 systemd[1]: \
libvirtd.service: Found left-over process 1884 (dnsmasq) in control group while \
starting unit. Ignoring. 2021-12-17T01:11:42.770411+0100 \
ost-basic-suite-master-host-0 systemd[1]: This usually indicates unclean termination \
of a previous run, or service implementation deficiencies. \
2021-12-17T01:11:42.771222+0100 ost-basic-suite-master-host-0 systemd[1]: Starting \
Virtualization daemon... 2021-12-17T01:11:42.949983+0100 \
ost-basic-suite-master-host-0 libvirtd[28055]: 2021-12-17 00:11:42.949+0000: 28055: \
info : libvirt version: 7.10.0, package: 1.module_el8.6.0+1046+bd8eec5e (CentOS \
Buildsys &lt;bugs@centos.org&gt;, 2021-12-13-15:33:57, ) 2021-12-17T01:11:42.949983+0100 \
ost-basic-suite-master-host-0 libvirtd[28055]: 2021-12-17 00:11:42.949+0000: 28055: \
info : hostname: ost-basic-suite-master-host-0 2021-12-17T01:11:42.949983+0100 \
ost-basic-suite-master-host-0 libvirtd[28055]: 2021-12-17 00:11:42.949+0000: 28055: \
debug : virLogParseOutputs:1621 : outputs=1:file:/var/log/libvirt.log \
2021-12-17T01:11:42.949983+0100 ost-basic-suite-master-host-0 libvirtd[28055]: \
2021-12-17 00:11:42.949+0000: 28055: debug : virLogParseOutput:1468 : \
output=1:file:/var/log/libvirt.log 2021-12-17T01:11:44.004174+0100 \
ost-basic-suite-master-host-0 systemd[1]: Started Virtualization daemon. \
2021-12-17T01:11:44.351680+0100 ost-basic-suite-master-host-0 dnsmasq[1883]: read \
/etc/hosts - 2 addresses 2021-12-17T01:11:44.351740+0100 \
ost-basic-suite-master-host-0 dnsmasq[1883]: read \
/var/lib/libvirt/dnsmasq/default.addnhosts - 0 addresses \
2021-12-17T01:11:44.351758+0100 ost-basic-suite-master-host-0 dnsmasq-dhcp[1883]: \
read /var/lib/libvirt/dnsmasq/default.hostsfile 2021-12-17T01:11:48.123665+0100 \
ost-basic-suite-master-host-0 platform-python[28261]: ansible-command Invoked with \
_raw_params=hostname _uses_shell=True warn=True stdin_add_newline=True \
strip_empty_ends=True argv=None chdir=None executable=None creates=None removes=None \
stdin=None 2021-12-17T01:11:57.791311+0100 ost-basic-suite-master-host-0 \
platform-python[28400]: ansible-command Invoked with _raw_params=sadf -g -- \
-bBdFHqSuvwWy -I SUM -I ALL -m ALL -n \
NFS,NFSD,SOCK,IP,EIP,ICMP,EICMP,TCP,ETCP,UDP,SOCK6,IP6,EIP6,ICMP6,EICMP6,UDP6 -r ALL \
-u ALL -P ALL &gt; /tmp/sarstat.svg _uses_shell=True warn=True stdin_add_newline=True \
strip_empty_ends=True argv=None chdir=None executable=None creates=None removes=None \
stdin=None 2021-12-17T01:11:59.354715+0100 ost-basic-suite-master-host-0 \
platform-python[28540]: ansible-stat Invoked with path=/tmp/sarstat.svg follow=True \
get_checksum=True checksum_algorithm=sha1 get_md5=False get_mime=True \
get_attributes=True 2021-12-17T01:12:17.759701+0100 ost-basic-suite-master-host-0 \
platform-python[28703]: ansible-command Invoked with _raw_params=journalctl -a \
--no-pager -o short-iso-precise &gt; /var/log/journalctl.log _uses_shell=True warn=True \
stdin_add_newline=True strip_empty_ends=True argv=None chdir=None executable=None \
creates=None removes=None stdin=None



</body></email><email><emailId>20211221090242</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-12-21 09:02:42-0400</timestampReceived><subject>Re: error during host deploy</subject><body>

On 12/20/21 11:34, Dana Elfassy wrote:
&gt; Hi,
&gt; While running a test case of adding hosts on ovirt system tests there
&gt; was a failure while the following command was executed:
&gt; vdsm-tool configure --force
&gt; 
&gt; On libvirtd log I found this error:
&gt; 
&gt; 2021-12-17 00:11:41.753+0000: 28031: error : virNetTLSContextNew:732 :
&gt; Unable to generate diffie-hellman parameters: Error in public key
&gt; generation.


This is the code on that line:

  err = gnutls_dh_params_init(&amp;ctxt-&gt;dhParams);
  if (err &lt; 0) {
      virReportError(VIR_ERR_SYSTEM_ERROR,
                     _("Unable to initialize diffie-hellman parameters: %s"),
                     gnutls_strerror(err));
      goto error;
  }
  err = gnutls_dh_params_generate2(ctxt-&gt;dhParams, DH_BITS);
  if (err &lt; 0) {
      virReportError(VIR_ERR_SYSTEM_ERROR,
                     _("Unable to generate diffie-hellman parameters: %s"),
                     gnutls_strerror(err));
      goto error;
  }
  
  gnutls_certificate_set_dh_params(ctxt-&gt;x509cred,
                                         ctxt-&gt;dhParams);


More specific, it's gnutls_dh_params_generate2() that fails. I suspect
it's because DH_BITS is defined as following:

  #define DH_BITS 2048

which might be too short for system policy. If you're able, you can try
the following patch:

diff --git i/src/rpc/virnettlscontext.c w/src/rpc/virnettlscontext.c
index 1a3dd92676..3ab9f6c4ce 100644
--- i/src/rpc/virnettlscontext.c
+++ w/src/rpc/virnettlscontext.c
@@ -717,16 +717,20 @@ static virNetTLSContext *virNetTLSContextNew(const char *cacert,
      * once a day, once a week or once a month. Depending on the
      * security requirements.
      */
     if (isServer) {
+        unsigned int bits = 0;
+
+        bits = gnutls_sec_param_to_pk_bits(GNUTLS_PK_DH, GNUTLS_SEC_PARAM_HIGH);
+
         err = gnutls_dh_params_init(&amp;ctxt-&gt;dhParams);
         if (err &lt; 0) {
             virReportError(VIR_ERR_SYSTEM_ERROR,
                            _("Unable to initialize diffie-hellman parameters: %s"),
                            gnutls_strerror(err));
             goto error;
         }
-        err = gnutls_dh_params_generate2(ctxt-&gt;dhParams, DH_BITS);
+        err = gnutls_dh_params_generate2(ctxt-&gt;dhParams, bits);
         if (err &lt; 0) {
             virReportError(VIR_ERR_SYSTEM_ERROR,
                            _("Unable to generate diffie-hellman parameters: %s"),
                            gnutls_strerror(err));


If it helps, I can post it for review.

Michal

</body></email><email><emailId>20211222074455</emailId><senderName>Dana Elfassy</senderName><senderEmail>delfassy@redhat.com</senderEmail><timestampReceived>2021-12-22 07:44:55-0400</timestampReceived><subject>Re: error during host deploy</subject><body>

Thanks,
Is it possible that you create an rpm with this fix so I can use it on the
test runs and try to reproduce?

On Tue, Dec 21, 2021 at 11:02 AM Michal Prívozník &lt;mprivozn@redhat.com&gt;
wrote:

&gt; On 12/20/21 11:34, Dana Elfassy wrote:
&gt; &gt; Hi,
&gt; &gt; While running a test case of adding hosts on ovirt system tests there
&gt; &gt; was a failure while the following command was executed:
&gt; &gt; vdsm-tool configure --force
&gt; &gt;
&gt; &gt; On libvirtd log I found this error:
&gt; &gt;
&gt; &gt; 2021-12-17 00:11:41.753+0000: 28031: error : virNetTLSContextNew:732 :
&gt; &gt; Unable to generate diffie-hellman parameters: Error in public key
&gt; &gt; generation.
&gt;
&gt;
&gt; This is the code on that line:
&gt;
&gt;   err = gnutls_dh_params_init(&amp;ctxt-&gt;dhParams);
&gt;   if (err &lt; 0) {
&gt;       virReportError(VIR_ERR_SYSTEM_ERROR,
&gt;                      _("Unable to initialize diffie-hellman parameters:
&gt; %s"),
&gt;                      gnutls_strerror(err));
&gt;       goto error;
&gt;   }
&gt;   err = gnutls_dh_params_generate2(ctxt-&gt;dhParams, DH_BITS);
&gt;   if (err &lt; 0) {
&gt;       virReportError(VIR_ERR_SYSTEM_ERROR,
&gt;                      _("Unable to generate diffie-hellman parameters: %s"),
&gt;                      gnutls_strerror(err));
&gt;       goto error;
&gt;   }
&gt;
&gt;   gnutls_certificate_set_dh_params(ctxt-&gt;x509cred,
&gt;                                          ctxt-&gt;dhParams);
&gt;
&gt;
&gt; More specific, it's gnutls_dh_params_generate2() that fails. I suspect
&gt; it's because DH_BITS is defined as following:
&gt;
&gt;   #define DH_BITS 2048
&gt;
&gt; which might be too short for system policy. If you're able, you can try
&gt; the following patch:
&gt;
&gt; diff --git i/src/rpc/virnettlscontext.c w/src/rpc/virnettlscontext.c
&gt; index 1a3dd92676..3ab9f6c4ce 100644
&gt; --- i/src/rpc/virnettlscontext.c
&gt; +++ w/src/rpc/virnettlscontext.c
&gt; @@ -717,16 +717,20 @@ static virNetTLSContext *virNetTLSContextNew(const
&gt; char *cacert,
&gt;       * once a day, once a week or once a month. Depending on the
&gt;       * security requirements.
&gt;       */
&gt;      if (isServer) {
&gt; +        unsigned int bits = 0;
&gt; +
&gt; +        bits = gnutls_sec_param_to_pk_bits(GNUTLS_PK_DH,
&gt; GNUTLS_SEC_PARAM_HIGH);
&gt; +
&gt;          err = gnutls_dh_params_init(&amp;ctxt-&gt;dhParams);
&gt;          if (err &lt; 0) {
&gt;              virReportError(VIR_ERR_SYSTEM_ERROR,
&gt;                             _("Unable to initialize diffie-hellman
&gt; parameters: %s"),
&gt;                             gnutls_strerror(err));
&gt;              goto error;
&gt;          }
&gt; -        err = gnutls_dh_params_generate2(ctxt-&gt;dhParams, DH_BITS);
&gt; +        err = gnutls_dh_params_generate2(ctxt-&gt;dhParams, bits);
&gt;          if (err &lt; 0) {
&gt;              virReportError(VIR_ERR_SYSTEM_ERROR,
&gt;                             _("Unable to generate diffie-hellman
&gt; parameters: %s"),
&gt;                             gnutls_strerror(err));
&gt;
&gt;
&gt; If it helps, I can post it for review.
&gt;
&gt; Michal
&gt;
&gt;

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Thanks,&lt;div&gt;Is it possible that you create an rpm with this fix so I \
can use it on the test runs and try to reproduce?&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Tue, Dec 21, 2021 at 11:02 \
AM Michal Prívozník &lt;&lt;a \
href="mailto:mprivozn@redhat.com"&gt;mprivozn@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;On 12/20/21 11:34, \
Dana Elfassy wrote:&lt;br&gt; &gt; Hi,&lt;br&gt;
&gt; While running a test case of adding hosts on ovirt system tests there&lt;br&gt;
&gt; was a failure while the following command was executed:&lt;br&gt;
&gt; vdsm-tool configure --force&lt;br&gt;
&gt; &lt;br&gt;
&gt; On libvirtd log I found this error:&lt;br&gt;
&gt; &lt;br&gt;
&gt; 2021-12-17 00:11:41.753+0000: 28031: error : virNetTLSContextNew:732 :&lt;br&gt;
&gt; Unable to generate diffie-hellman parameters: Error in public key&lt;br&gt;
&gt; generation.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
This is the code on that line:&lt;br&gt;
&lt;br&gt;
   err = gnutls_dh_params_init(&amp;ctxt-&gt;dhParams);&lt;br&gt;
   if (err &lt; 0) {&lt;br&gt;
         virReportError(VIR_ERR_SYSTEM_ERROR,&lt;br&gt;
                                _("Unable to initialize diffie-hellman \
parameters: %s"),&lt;br&gt;  gnutls_strerror(err));&lt;br&gt;
         goto error;&lt;br&gt;
   }&lt;br&gt;
   err = gnutls_dh_params_generate2(ctxt-&gt;dhParams, DH_BITS);&lt;br&gt;
   if (err &lt; 0) {&lt;br&gt;
         virReportError(VIR_ERR_SYSTEM_ERROR,&lt;br&gt;
                                _("Unable to generate diffie-hellman parameters: \
%s"),&lt;br&gt;  gnutls_strerror(err));&lt;br&gt;
         goto error;&lt;br&gt;
   }&lt;br&gt;
&lt;br&gt;
   gnutls_certificate_set_dh_params(ctxt-&gt;x509cred,&lt;br&gt;
                                                              ctxt-&gt;dhParams);&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
More specific, it's gnutls_dh_params_generate2() that fails. I suspect&lt;br&gt;
it's because DH_BITS is defined as following:&lt;br&gt;
&lt;br&gt;
   #define DH_BITS 2048&lt;br&gt;
&lt;br&gt;
which might be too short for system policy. If you're able, you can try&lt;br&gt;
the following patch:&lt;br&gt;
&lt;br&gt;
diff --git i/src/rpc/virnettlscontext.c w/src/rpc/virnettlscontext.c&lt;br&gt;
index 1a3dd92676..3ab9f6c4ce 100644&lt;br&gt;
--- i/src/rpc/virnettlscontext.c&lt;br&gt;
+++ w/src/rpc/virnettlscontext.c&lt;br&gt;
@@ -717,16 +717,20 @@ static virNetTLSContext *virNetTLSContextNew(const char \
                *cacert,&lt;br&gt;
         * once a day, once a week or once a month. Depending on the&lt;br&gt;
         * security requirements.&lt;br&gt;
         */&lt;br&gt;
        if (isServer) {&lt;br&gt;
+            unsigned int bits = 0;&lt;br&gt;
+&lt;br&gt;
+            bits = gnutls_sec_param_to_pk_bits(GNUTLS_PK_DH, \
GNUTLS_SEC_PARAM_HIGH);&lt;br&gt; +&lt;br&gt;
              err = gnutls_dh_params_init(&amp;ctxt-&gt;dhParams);&lt;br&gt;
              if (err &lt; 0) {&lt;br&gt;
                    virReportError(VIR_ERR_SYSTEM_ERROR,&lt;br&gt;
                                          _("Unable to initialize diffie-hellman \
parameters: %s"),&lt;br&gt;  gnutls_strerror(err));&lt;br&gt;
                    goto error;&lt;br&gt;
              }&lt;br&gt;
-            err = gnutls_dh_params_generate2(ctxt-&gt;dhParams, DH_BITS);&lt;br&gt;
+            err = gnutls_dh_params_generate2(ctxt-&gt;dhParams, bits);&lt;br&gt;
              if (err &lt; 0) {&lt;br&gt;
                    virReportError(VIR_ERR_SYSTEM_ERROR,&lt;br&gt;
                                          _("Unable to generate diffie-hellman \
parameters: %s"),&lt;br&gt;  gnutls_strerror(err));&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
If it helps, I can post it for review.&lt;br&gt;
&lt;br&gt;
Michal&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;



</body></email><email><emailId>20211201164418</emailId><senderName>Richard Taubo</senderName><senderEmail>ort_libvirt@bergersen.no</senderEmail><timestampReceived>2021-12-01 16:44:18-0400</timestampReceived><subject>qemu-img create with extended_l2=on, followed by virt-install</subject><body>

Hi!


I have read the following blog post: \
https://blogs.igalia.com/berto/2020/12/03/subcluster-allocation-for-qcow2-images/ and \
watched the video displayed there.

1) To make qcow2 as fast as possible, does it make sense to do the following:

[#] qemu-img create -f qcow2 -o extended_l2=on,cluster_size=128k my_image.qcow2 \
1000GB

And then:
[#] virt-install —name=MyVM --disk path=my_image.qcow2,size=1000 . . .

Will this overwrite the qcow2 file already created or will it keep its \
characteristics?

Does it make sense?


2) I wont't be moving the VM around much and have the space I need, so I wonder if it \
will be faster to do the following: [#] qemu-img create -o preallocation=full -f \
qcow2 my_image.qcow2 1000GB

And then:
[#] ] virt-install —name=MyVM --disk \
path=my_image.qcow2,size=1000,bus=scsi,sparse=false . . .  (Running bus=scsi so I can \
trim the image ).

I could use a dedicated disk for the VM instead of using qcow2, but I like the \
flexibility of qcow2.

Thanks a lot for any information about this! :-)

Best regards,
Richard Taubo


</body></email><email><emailId>20211202153227</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-12-02 15:32:27-0400</timestampReceived><subject>Re: Libvirt Snapshot Question</subject><body>

On Thu, Dec 02, 2021 at 16:27:00 +0100, Elias Mobery wrote:
&gt; OK, so I tried both ways. (The VM image is in the read-only squashfs.)
&gt; 
&gt; 1.) Editing VM domain XML:
&gt;     &lt;disk&gt;
&gt; 
&gt;     &lt;transient/&gt;
&gt;     &lt;/disk&gt;
&gt; 
&gt; Error:  Internal Error - Could not open
&gt; /var/lib/libvirt/images/vm.snapshot1 : Permission Denied
&gt; 
&gt; I chowned everything to libvirt but no changes. Maybe a read-only conflict?

Yes, the overlay is created in the same path as the original image, just
with a suffix, so if that is a read-only FS it will not work.

I've thought about adding a possibility to specify the location for the
overlay but didn't ever get to implementing it actually.

&gt; 2.) Adding second disk to VM domain XML
&gt; (shortened )
&gt; 
&gt;  &lt;disk&gt;
&gt;     source /var/lib..../images/vm.qcow2
&gt;     target dev=vda
&gt;  &lt;/disk&gt;
&gt; 
&gt; 
&gt;  &lt;disk&gt;
&gt;      source /var/lib...../images/vm.qcow2
&gt;      target dev=vdb
&gt;     &lt;transient/&gt;
&gt;  &lt;/disk&gt;
&gt; 
&gt; Error: unsupported configuration: cannot create external snapshot for disk
&gt; vdb - collision with disk vdb.

Could you please post the unabbreviated steps? I don't really know
what's going on based on this.

&gt; After googling I found that a lot of people get permission denied errors
&gt; using transient. I will keep looking, really not sure.

</body></email><email><emailId>20211207085815</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-12-07 08:58:15-0400</timestampReceived><subject>Re: No QXL in CentOS 9 Stream?</subject><body>

On Mon, Dec 06, 2021 at 06:50:36PM +0000, lejeczek wrote:
&gt; Hi.
&gt; 
&gt; There seems to be no QXL (and Spice?) support in versions from CentOS 9
&gt; repos.
&gt; Would anybody know if that intended, because something else replaces qxl
&gt; perhaps?

SPICE is discontinued in RHEL, and thus CentOS too.  It remains in Fedora
and other distros, but is unlikely to get further development upstream.

If you haved a Red Hat account there is more info here - sorry it is
annoyingly behind a login

  https://access.redhat.com/solutions/5414901

This page gives accurate recommendations (if you ignore QXL mentions):

  https://www.kraxel.org/blog/2019/09/display-devices-in-qemu/#tldr

Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20211208152655</emailId><senderName>Philipp Klocke</senderName><senderEmail>philipp.klocke@motius.de</senderEmail><timestampReceived>2021-12-08 15:26:55-0400</timestampReceived><subject>Re: Qemu monitor info tlb gives unable to encode message payload</subject><body>



On 12/8/21 14:15, Daniel P. Berrangé wrote:
&gt; CAUTION: This email originated from outside of the organization. Do not click links \
&gt; or open attachments unless you recognize the sender and know the content is safe. 
&gt; 
&gt; On Wed, Dec 08, 2021 at 01:32:48PM +0100, Philipp Klocke wrote:
&gt; &gt; On 12/8/21 12:09, Peter Krempa wrote:
&gt; &gt; &gt; CAUTION: This email originated from outside of the organization. Do not click \
&gt; &gt; &gt; links or open attachments unless you recognize the sender and know the content \
&gt; &gt; &gt; is safe. 
&gt; &gt; &gt; 
&gt; &gt; &gt; On Wed, Dec 08, 2021 at 10:30:27 +0000, Philipp Klocke wrote:
&gt; &gt; &gt; &gt; Hi,
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; the command
&gt; &gt; &gt; &gt; virsh qemu-monitor-command ubuntu_vm --hmp --cmd "info tlb"
&gt; &gt; &gt; &gt; fails with "error: Unable to encode message payload".
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; I found a bugtracker entry for a similiar error [1], but I don't if this is \
&gt; &gt; &gt; &gt; the same error (message too large). I also don't know how large an info tlb \
&gt; &gt; &gt; &gt; message is. Preferably I would not have to recompile libvirt just to issue \
&gt; &gt; &gt; &gt; this monitor command..
&gt; &gt; &gt; Libvirt unfortunately limits strings to 4MiB:
&gt; &gt; &gt; 
&gt; &gt; &gt; const REMOTE_STRING_MAX = 4194304;
&gt; &gt; &gt; 
&gt; &gt; &gt; And the reply from qemu-monitor-command is a single string. Now
&gt; &gt; &gt; internally we process JSON messages up to 10 MiB so one could argue that
&gt; &gt; &gt; we should increase the size for the 'qemu-monitor-command' reply up to
&gt; &gt; &gt; 10MiB. This could be straightforward but it's questionable whether it's
&gt; &gt; &gt; worth it.
&gt; &gt; Thanks for the clarification! I will try to go for the 2nd monitor then.
&gt; &gt; &gt; &gt; Then I thought about circumventing the error by connecting directly to the \
&gt; &gt; &gt; &gt; qemu monitor via netcat, but I found a thread [2] that says I cannot add my \
&gt; &gt; &gt; &gt; own "-monitor tcp:..." to the Qemu commandline arguments.
&gt; &gt; &gt; IIRC at that point qemu wasn't able to handle two monitor connections.
&gt; &gt; &gt; At this point it is possible to have two concurrent connections to the
&gt; &gt; &gt; montitor. Obviously things may break and you get to keep the pieces if
&gt; &gt; &gt; it breaks.
&gt; &gt; &gt; 
&gt; &gt; &gt; By adding:
&gt; &gt; &gt; 
&gt; &gt; &gt; &lt;qemu:commandline&gt;
&gt; &gt; &gt; &lt;qemu:arg value='-qmp'/&gt;
&gt; &gt; &gt; &lt;qemu:arg value='tcp:127.0.0.1:1235'/&gt;
&gt; &gt; &gt; &lt;/qemu:commandline&gt;
&gt; &gt; 
&gt; &gt; When I add this to the config via virsh edit and then do a shutdown +
&gt; &gt; reboot, I get a kernel panic.
&gt; &gt; I put the corresponding dmesg log on gist:
&gt; &gt; https://gist.github.com/klockeph/323f3e0d23a3254ef98a65fd7c8f5a1c
&gt; 
&gt; I can't see how that is related to adding an extra -qmp parameter,
&gt; since it doesn't affect the guest ABI
&gt; 

Thanks, it seems that the panic was unrelated and something else that I need to fix.

&gt; FWIW, exposing -qmp over a tcp socket is totally insecure - any
&gt; local process can connect to that.
&gt; 

For some reason the tcp connection didn't work, but unix socket does the trick.
I can now issue "info tlb" JSON commands through this socket and get a reply.

  &lt;qemu:commandline&gt;
    &lt;qemu:arg value='-qmp'/&gt;
    &lt;qemu:arg value='unix:/path-to/ubuntu_vm.sock,server,nowait'/&gt;
  &lt;/qemu:commandline&gt;

Thanks everybody for the help!

Best,
Philipp


</body></email><email><emailId>20211212053010</emailId><senderName>Dmitry Melekhov</senderName><senderEmail>dm@belkam.com</senderEmail><timestampReceived>2021-12-12 05:30:10-0400</timestampReceived><subject>Re: Libgfapi gone too?</subject><body>


12.12.2021 02:46, Nir Soffer пишет:
&gt;
&gt; Even in RHV (RHEV was renamed to RHV a few years ago) native Gluster
&gt; disk was never fully supported...


very interesting, thank you.

it is supported in centos 7 build of qemu from RHEV, though,

this is why I did this mistake :-(

anyway, as I said before, we had some problems with fuse glusterfs 
client including memory leaks, don't remember about performance, so 
we'll stick with rhel 8 derivatives for several years.

being optimistic I hope this will be for our life time ;-)

&gt;


</body></email><email><emailId>20211213124755</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-12-13 12:47:55-0400</timestampReceived><subject>Re: internal error - invalid characters</subject><body>

On Mon, Dec 13, 2021 at 09:39:20AM +0000, lejeczek wrote:
&gt; 
&gt; 
&gt; On 07/12/2021 11:28, Ján Tomko wrote:
&gt; &gt; On a Monday in 2021, lejeczek wrote:
&gt; &gt; &gt; Hi guys.
&gt; &gt; &gt; 
&gt; &gt; &gt; Have you seen something like this below?
&gt; &gt; &gt; ...
&gt; &gt; &gt; internal error: The string resource has invalid characters in its
&gt; &gt; &gt; value
&gt; &gt; &gt; internal error: The provided value contains invalid characters:
&gt; &gt; &gt; Solarstorm SFN5162F SFP+ Server Adapter
&gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; This error message was only present in libvirt v7.9.0. Since v7.10.0
&gt; &gt; libvirt should ignore non-printable characters.
&gt; &gt; https://bugzilla.redhat.com/show_bug.cgi?id=2022589
&gt; &gt; 
&gt; &gt; Jano
&gt; &gt; 
&gt; Would that "bug" be a reason why my libvirtd fails?

It shouldn't have a negative impact - it just means that VPD info
would not be reported against that particular host device. Everything
else should be unaffected.

&gt; I have libvirtd.service started and see that in the logs, then suffices I
&gt; do:
&gt; -&gt; $ virsh list --all
&gt; (having no VMs started)
&gt; I next thing in the logs is:
&gt; ...
&gt; internal error: The provided value contains invalid characters: Solarstorm
&gt; SFN5162F SFP+ Server Adapter
&gt; internal error: The string resource has invalid characters in its value
&gt; Stopping Virtualization daemon...
&gt; libvirtd.service: Deactivated successfully.
&gt; Stopped Virtualization daemon.
&gt; 
&gt; I'm on Centos 9 with libvirt-daemon-7.9.0-1.el9.x86_64.
&gt; With .service failed I still can start a VM.
&gt; -&gt; $ systemctl status -l libvirtd.service
&gt; ○ libvirtd.service - Virtualization daemon
&gt;      Loaded: loaded (/usr/lib/systemd/system/libvirtd.service; disabled;
&gt; vendor preset: dis&gt;
&gt;      Active: inactive (dead) since Mon 2021-12-13 09:32:04 GMT; 5min ago
&gt; TriggeredBy: ○ libvirtd-tcp.socket
&gt;              ● libvirtd-ro.socket
&gt;              ● libvirtd-admin.socket
&gt;              ● libvirtd.socket
&gt;              ○ libvirtd-tls.socket
&gt; 
&gt; Is it that these versions and/or Centos 9 have introduced new (different
&gt; defaults) ways to use/mange 'libvirtd', with .socket and no .service?

In RHEL-9 and therefore CentOS 9 we're switching to using modular
daemons, so libvirtd is no longer expected to be used.

  https://fedoraproject.org/wiki/Changes/LibvirtModularDaemons
  https://libvirt.org/daemons.html

a current fresh install should setup the modular daemons automatically
and leave libvirtd (and its .sockets) entirely disabled. Older installs 
would remain with libvirtd.

Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20211214090736</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-12-14 09:07:36-0400</timestampReceived><subject>Re: Guest vm doesn't recover after the nfs connection resume</subject><body>

On Tue, Dec 14, 2021 at 03:35:42PM +0800, Liang Cong wrote:
&gt; Hi Daniel,
&gt; 
&gt; Thanks for your reply. I tried the nfs hard mount, and got the same
&gt; behavior of the soft mount.
&gt; But in the /var/log/message, got nfs server recovery message which is not
&gt; printed when mounting as soft mode.
&gt; 
&gt; Dec 14 02:12:47 test-1 kernel: nfs: server ip not responding, still trying
&gt; Dec 14 02:13:39 test-1 kernel: nfs: server ip not responding, timed out
&gt; *Dec 14 02:14:34 test-1 kernel: nfs: server ip OK*
&gt; Dec 14 02:14:34 test-1 kernel: NFS: __nfs4_reclaim_open_state: Lock reclaim
&gt; failed!
&gt; 
&gt; 
&gt; According to my understanding the vm boot process will not recover(the vm
&gt; is still in running state, never paused) to normal until restarting the vm
&gt; guest.
&gt; And it is not the issue of libvirt or qemu, it is just the correct behavior
&gt; with the nfs connection timeout, right?

With 'hard' mount I would not expect QEMU/guest to see any errors
at all, though your messages here about 'Lock reclaim failed' are
a little concerning as it suggests something is not working right
wth NFS. This is beyond my knowledge of NFS though.

Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20211214110515</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-12-14 11:05:15-0400</timestampReceived><subject>Re: Libvirt on little.BIG ARM systems unable to start guest if no cpuset is provided</subject><body>

On Tue, Dec 14, 2021 at 06:59:12PM +0800, Qu Wenruo wrote:
&gt; 
&gt; 
&gt; On 2021/12/14 18:36, Daniel P. Berrangé wrote:
&gt; &gt; On Tue, Dec 14, 2021 at 09:34:18AM +0000, Marc Zyngier wrote:
&gt; &gt; &gt; On Tue, 14 Dec 2021 00:41:01 +0000,
&gt; &gt; &gt; Qu Wenruo &lt;quwenruo.btrfs@gmx.com&gt; wrote:
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; On 2021/12/14 00:49, Marc Zyngier wrote:
&gt; &gt; &gt; &gt; &gt; On Mon, 13 Dec 2021 16:06:14 +0000,
&gt; &gt; &gt; &gt; &gt; Peter Maydell &lt;peter.maydell@linaro.org&gt; wrote:
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; KVM on big.little setups is a kernel-level question really; I've
&gt; &gt; &gt; &gt; &gt; &gt; cc'd the kvmarm list.
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; Thanks Peter for throwing us under the big-little bus! ;-)
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; On Mon, 13 Dec 2021 at 15:02, Qu Wenruo &lt;quwenruo.btrfs@gmx.com&gt; wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; On 2021/12/13 21:17, Michal Prívozník wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; On 12/11/21 02:58, Qu Wenruo wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Hi,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Recently I got my libvirt setup on both RK3399 (RockPro64) and RPI CM4,
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; with upstream kernels.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; For RPI CM4 its mostly smooth sail, but on RK3399 due to its little.BIG
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; setup (core 0-3 are 4x A55 cores, and core 4-5 are 2x A72 cores), it
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; brings quite some troubles for VMs.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; In short, without proper cpuset to bind the VM to either all A72 cores
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; or all A55 cores, the VM will mostly fail to boot.
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; s/A55/A53/. There were thankfully no A72+A55 ever produced (just the
&gt; &gt; &gt; &gt; &gt; though of it makes me sick).
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Currently the working xml is:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;      &lt;vcpu placement='static' cpuset='4-5'&gt;2&lt;/vcpu&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;      &lt;cpu mode='host-passthrough' check='none'/&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; But even with vcpupin, pinning each vcpu to each physical core, VM will
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; mostly fail to start up due to vcpu initialization failed with -EINVAL.
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; Disclaimer: I know nothing about libvirt (and no, I don't want to
&gt; &gt; &gt; &gt; &gt; know! ;-).
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; However, for things to be reliable, you need to taskset the whole QEMU
&gt; &gt; &gt; &gt; &gt; process to the CPU type you intend to use.
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Yep, that's what I'm doing.
&gt; &gt; &gt; 
&gt; &gt; &gt; Are you sure? The xml directive above seem to only apply to the vcpus,
&gt; &gt; &gt; and no other QEMU thread.
&gt; &gt; 
&gt; &gt; For historical reasons this XML element is a bit misleadingly named.
&gt; &gt; 
&gt; &gt; With the config
&gt; &gt; 
&gt; &gt;     &lt;vcpu placement='static' cpuset='4-5'&gt;2&lt;/vcpu&gt;
&gt; &gt; 
&gt; &gt; the 'cpuset' applies to the QEMU process as a whole - its vCPUs,
&gt; &gt; I/O threads and any other emulator threads.
&gt; &gt; 
&gt; &gt; There is a separate config for setting per-VCPU binding which was
&gt; &gt; illustrated elsewhere in this thread.
&gt; 
&gt; Which also means, I can put the io threads to A53 cores freeing up the
&gt; A72 cores more.
&gt; 
&gt; And is there any plan to deprecate the old "cpuset" key of vcpu element,
&gt; and recommend to use "vcpupin" element?

No, they're complementary as they're operating at different levels
and not every scenario needs this fine grained level.
In fact if you just use 'vcpupin' and don't provide 'cpuset', then
internally treats it as if 'cpuset' was the union of all 'vcpupin'
bitsets.

Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20211215161638</emailId><senderName>Piotr Kliczewski</senderName><senderEmail>pkliczew@redhat.com</senderEmail><timestampReceived>2021-12-15 16:16:38-0400</timestampReceived><subject>Re: [FOSDEM][CFP] Virtualization &amp; IaaS Devroom</subject><body>

All,

A friendly reminder that the submission deadline is in 5 days.

Thanks,
Piotr

On Tue, Nov 30, 2021 at 2:44 PM Piotr Kliczewski &lt;pkliczew@redhat.com&gt;
wrote:

&gt; We are excited to announce that the call for proposals is now open for the
&gt; Virtualization &amp; IaaS devroom at the upcoming FOSDEM 2022, to be hosted
&gt; virtually on February 5th 2022.
&gt;
&gt; This year will mark FOSDEM's 22nd anniversary as one of the
&gt; longest-running free and open source software developer events, attracting
&gt; thousands of developers and users from all over the world. Due to Covid-19,
&gt; FOSDEM will be held virtually this year on February 5th &amp; 6th, 2022.
&gt;
&gt; About the Devroom
&gt;
&gt; The Virtualization &amp; IaaS devroom will feature session topics such as open
&gt; source hypervisors and virtual machine managers such as Xen Project, KVM,
&gt; bhyve, and VirtualBox, and Infrastructure-as-a-Service projects such as
&gt; KubeVirt, Apache CloudStack, Foreman, OpenStack, oVirt, QEMU and OpenNebula.
&gt;
&gt; This devroom will host presentations that focus on topics of shared
&gt; interest, such as KVM; libvirt; shared storage; virtualized networking;
&gt; cloud security; clustering and high availability; interfacing with multiple
&gt; hypervisors; hyperconverged deployments; and scaling across hundreds or
&gt; thousands of servers.
&gt;
&gt; Presentations in this devroom will be aimed at users or developers working
&gt; on these platforms who are looking to collaborate and improve shared
&gt; infrastructure or solve common problems. We seek topics that encourage
&gt; dialog between projects and continued work post-FOSDEM.
&gt;
&gt; Important Dates
&gt;
&gt; Submission deadline: 20th of December
&gt;
&gt; Acceptance notifications: 25th of December
&gt;
&gt; Final schedule announcement: 31st of December
&gt;
&gt; Recorded presentations upload deadline: 15th of January
&gt;
&gt; Devroom: 6th February 2022
&gt;
&gt; Submit Your Proposal
&gt;
&gt; All submissions must be made via the Pentabarf event planning site[1]. If
&gt; you have not used Pentabarf before, you will need to create an account. If
&gt; you submitted proposals for FOSDEM in previous years, you can use your
&gt; existing account.
&gt;
&gt; After creating the account, select Create Event to start the submission
&gt; process. Make sure to select Virtualization and IaaS devroom from the Track
&gt; list. Please fill out all the required fields, and provide a meaningful
&gt; abstract and description of your proposed session.
&gt;
&gt; Submission Guidelines
&gt;
&gt; We expect more proposals than we can possibly accept, so it is vitally
&gt; important that you submit your proposal on or before the deadline. Late
&gt; submissions are unlikely to be considered.
&gt;
&gt; All presentation slots are 30 minutes, with 20 minutes planned for
&gt; presentations, and 10 minutes for Q&amp;A.
&gt;
&gt; All presentations will need to be pre-recorded and put into our system at
&gt; least a couple of weeks before the event.
&gt;
&gt; The presentations should be uploaded by 15th of January and made
&gt; available under Creative
&gt;
&gt; Commons licenses. In the Submission notes field, please indicate that you
&gt; agree that your presentation will be licensed under the CC-By-SA-4.0 or
&gt; CC-By-4.0 license and that you agree to have your presentation recorded.
&gt; For example:
&gt;
&gt; "If my presentation is accepted for FOSDEM, I hereby agree to license all
&gt; recordings, slides, and other associated materials under the Creative
&gt; Commons Attribution Share-Alike 4.0 International License. Sincerely,
&gt; &lt;NAME&gt;."
&gt;
&gt; In the Submission notes field, please also confirm that if your talk is
&gt; accepted, you will be able to attend the virtual FOSDEM event for the Q&amp;A.
&gt; We will not consider proposals from prospective speakers who are unsure
&gt; whether they will be able to attend the FOSDEM virtual event.
&gt;
&gt; If you are experiencing problems with Pentabarf, the proposal submission
&gt; interface, or have other questions, you can email our devroom mailing
&gt; list[2] and we will try to help you.
&gt;
&gt;
&gt; Code of Conduct
&gt;
&gt; Following the release of the updated code of conduct for FOSDEM, we'd like
&gt; to remind all speakers and attendees that all of the presentations and
&gt; discussions in our devroom are held under the guidelines set in the CoC and
&gt; we expect attendees, speakers, and volunteers to follow the CoC at all
&gt; times.
&gt;
&gt; If you submit a proposal and it is accepted, you will be required to
&gt; confirm that you accept the FOSDEM CoC. If you have any questions about the
&gt; CoC or wish to have one of the devroom organizers review your presentation
&gt; slides or any other content for CoC compliance, please email us and we will
&gt; do our best to assist you.
&gt;
&gt; Call for Volunteers
&gt;
&gt; We are also looking for volunteers to help run the devroom. We need
&gt; assistance with helping speakers to record the presentation as well as
&gt; helping with streaming and chat moderation for the devroom. Please contact
&gt; devroom mailing list [2] for more information.
&gt;
&gt; Questions?
&gt;
&gt; If you have any questions about this devroom, please send your questions
&gt; to our devroom mailing list. You can also subscribe to the list to receive
&gt; updates about important dates, session announcements, and to connect with
&gt; other attendees.
&gt;
&gt; See you all at FOSDEM!
&gt;
&gt; [1] https://penta.fosdem.org/submission/FOSDEM22
&gt;
&gt; [2] iaas-virt-devroom at lists.fosdem.org
&gt;

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div&gt;All,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;A friendly reminder that the \
submission deadline is in 5 \
days.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;Piotr&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Tue, Nov 30, 2021 at 2:44 PM \
Piotr Kliczewski &lt;&lt;a href="mailto:pkliczew@redhat.com"&gt;pkliczew@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;&lt;div dir="ltr"&gt;&lt;p \
dir="ltr" style="line-height:1.656;margin-top:0pt;margin-bottom:0pt" \
id="gmail-m_3557533125222057404gmail-docs-internal-guid-1dabff4d-7fff-f2d7-5c15-17d494f16136"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;We \
are excited to announce that the call for proposals is now open for the \
Virtualization &amp; IaaS devroom at the upcoming FOSDEM 2022, to be hosted virtually \
on February 5th 2022.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;This \
year will mark FOSDEM's 22nd anniversary as one of the longest-running free and open \
source software developer events, attracting thousands of developers and users from \
all over the world. Due to Covid-19, FOSDEM will be held virtually this year on \
February 5th &amp; 6th, 2022.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;About \
the Devroom&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;The \
Virtualization &amp; IaaS devroom will feature session topics such as open source \
hypervisors and virtual machine managers such as Xen Project, KVM, bhyve, and \
VirtualBox, and Infrastructure-as-a-Service projects such as KubeVirt, Apache \
CloudStack, Foreman, OpenStack, oVirt, QEMU and OpenNebula.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p \
dir="ltr" style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;This \
devroom will host presentations that focus on topics of shared interest, such as KVM; \
libvirt; shared storage; virtualized networking; cloud security; clustering and high \
availability; interfacing with multiple hypervisors; hyperconverged deployments; and \
scaling across hundreds or thousands of servers.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;Presentations \
in this devroom will be aimed at users or developers working on these platforms who \
are looking to collaborate and improve shared infrastructure or solve common \
problems. We seek topics that encourage dialog between projects and continued work \
post-FOSDEM.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;Important \
Dates&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;Submission \
deadline: 20th of December&lt;/span&gt;&lt;/p&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;Acceptance \
notifications: 25th of December&lt;/span&gt;&lt;/p&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;Final \
schedule announcement: 31st of December&lt;/span&gt;&lt;/p&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;Recorded \
presentations upload deadline: 15th of January&lt;/span&gt;&lt;/p&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;Devroom: \
6th February 2022&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;Submit \
Your Proposal&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;All \
submissions must be made via the Pentabarf event planning site[1]. If you have not \
used Pentabarf before, you will need to create an account. If you submitted proposals \
for FOSDEM in previous years, you can use your existing account.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p \
dir="ltr" style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;After \
creating the account, select Create Event to start the submission process. Make sure \
to select Virtualization and IaaS devroom from the Track list. Please fill out all \
the required fields, and provide a meaningful abstract and description of your \
proposed session.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;Submission \
Guidelines&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;We \
expect more proposals than we can possibly accept, so it is vitally important that \
you submit your proposal on or before the deadline. Late submissions are unlikely to \
be considered.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;All \
presentation slots are 30 minutes, with 20 minutes planned for presentations, and 10 \
minutes for Q&amp;A.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:700;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;All \
presentations will need to be pre-recorded and put into our system at least a couple \
of weeks before the event.&lt;/span&gt;&lt;/p&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;The \
presentations should be uploaded by 15th of January&lt;/span&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(255,0,0);background-color:transparen \
t;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt; \
&lt;/span&gt;&lt;span style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color \
:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;and \
made available under Creative&lt;/span&gt;&lt;/p&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;Commons \
licenses. In the Submission notes field, please indicate that you agree that your \
presentation will be licensed under the CC-By-SA-4.0 or CC-By-4.0 license and that \
you agree to have your presentation recorded. For example:&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;"If \
my presentation is accepted for FOSDEM, I hereby agree to license all recordings, \
slides, and other associated materials under the Creative Commons Attribution \
Share-Alike 4.0 International License. Sincerely, \
&lt;NAME&gt;."&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;In \
the Submission notes field, please also confirm that if your talk is accepted, you \
will be able to attend the virtual FOSDEM event for the Q&amp;A. We will not consider \
proposals from prospective speakers who are unsure whether they will be able to \
attend the FOSDEM virtual event.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;If \
you are experiencing problems with Pentabarf, the proposal submission interface, or \
have other questions, you can email our devroom mailing list[2] and we will try to \
help you.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;Code \
of Conduct&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;Following \
the release of the updated code of conduct for FOSDEM, we'd like to remind all \
speakers and attendees that all of the presentations and discussions in our devroom \
are held under the guidelines set in the CoC and we expect attendees, speakers, and \
volunteers to follow the CoC at all times.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;If \
you submit a proposal and it is accepted, you will be required to confirm that you \
accept the FOSDEM CoC. If you have any questions about the CoC or wish to have one of \
the devroom organizers review your presentation slides or any other content for CoC \
compliance, please email us and we will do our best to assist you.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p \
dir="ltr" style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;Call \
for Volunteers&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;We \
are also looking for volunteers to help run the devroom. We need assistance with \
helping speakers to record the presentation as well as helping with streaming and \
chat moderation for the devroom. Please contact devroom mailing list [2] for more \
information.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;Questions?&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p \
dir="ltr" style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;If \
you have any questions about this devroom, please send your questions to our devroom \
mailing list. You can also subscribe to the list to receive updates about important \
dates, session announcements, and to connect with other attendees.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p \
dir="ltr" style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;See \
you all at FOSDEM!&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.9872;background-color:rgb(255,255,255);margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;[1]&lt;/span&gt;&lt;a \
href="https://penta.fosdem.org/submission/FOSDEM22" style="text-decoration:none" \
target="_blank"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(17,85,204);background-color:transpar \
ent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:underline;vertical-align:baseline;white-space:pre-wrap"&gt; \
https://penta.fosdem.org/submission/FOSDEM22&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;p dir="ltr" \
style="line-height:1.9872;background-color:rgb(255,255,255);margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;[2] \
iaas-virt-devroom at&lt;/span&gt;&lt;a href="http://lists.fosdem.org" \
style="text-decoration:none" target="_blank"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt; \
&lt;/span&gt;&lt;span style="font-size:11pt;font-family:Arial;color:rgb(17,85,204);background-c \
olor:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration \
:underline;vertical-align:baseline;white-space:pre-wrap"&gt;lists.fosdem.org&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;



</body></email><email><emailId>20211221131950</emailId><senderName>john doe</senderName><senderEmail>johndoe65534@mail.com</senderEmail><timestampReceived>2021-12-21 13:19:50-0400</timestampReceived><subject>Re: Best way to install guest when it is not listed in output of osinfo-query os</subject><body>

On 12/21/2021 10:41 AM, Andrea Bolognani wrote:
&gt; On Mon, Dec 20, 2021 at 10:59:15PM +0100, Martin Kletzander wrote:
&gt;&gt; Any reason for debian not having an -unknown version like lot of the
&gt;&gt; other distros?
&gt;
&gt; I don't think there's a specific reason for that, it's probably just
&gt; a matter of nobody thinking of it until now :)
&gt;
&gt; In addition to that, considering that there already entries for
&gt; Debian testing and Fedora Rawhide, adding one for Debian unstable
&gt; might make sense too.
&gt;

That would be lovely if 'debian-unknown' and 'debian11' could be
available on Bullseye!!! :)

Is it intentional that the Debian URLs in the output of 'osinfo-query
os' point to 'debian.org/debian/VERSION_ID' instead of
'debian.org/releases/VERSION_ID|VERSION_CODENAME'?

--
John Doe


</body></email><email><emailId>20211223050428</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-12-23 05:04:28-0400</timestampReceived><subject>Re: error during host deploy</subject><body>

On 12/22/21 08:44, Dana Elfassy wrote:
&gt; Thanks,
&gt; Is it possible that you create an rpm with this fix so I can use it on
&gt; the test runs and try to reproduce?

Oh, sure. Is fedora rpm fine?

Michal

</body></email><email><emailId>20211206185036</emailId><senderName>lejeczek</senderName><senderEmail>peljasz@yahoo.co.uk</senderEmail><timestampReceived>2021-12-06 18:50:36-0400</timestampReceived><subject>No QXL in CentOS 9 Stream?</subject><body>

Hi.

There seems to be no QXL (and Spice?) support in versions 
from CentOS 9 repos.
Would anybody know if that intended, because something else 
replaces qxl perhaps?

thanks, L

</body></email><email><emailId>20211208103027</emailId><senderName>Philipp Klocke</senderName><senderEmail>philipp.klocke@motius.de</senderEmail><timestampReceived>2021-12-08 10:30:27-0400</timestampReceived><subject>Qemu monitor info tlb gives unable to encode message payload</subject><body>

Hi,

the command
    virsh qemu-monitor-command ubuntu_vm --hmp --cmd "info tlb"
fails with "error: Unable to encode message payload".

I found a bugtracker entry for a similiar error [1], but I don't if this is the same \
error (message too large). I also don't know how large an info tlb message is. \
Preferably I would not have to recompile libvirt just to issue this monitor command..

Then I thought about circumventing the error by connecting directly to the qemu \
monitor via netcat, but I found a thread [2] that says I cannot add my own "-monitor \
tcp:..." to the Qemu commandline arguments.

Could someone help me with this?

Best,
Philipp

[1] https://bugzilla.redhat.com/show_bug.cgi?id=1440683
[2] https://libvirt-users.redhat.narkive.com/E0UTmdhU/is-there-a-way-to-disable-libvirt-qemu-monitor-while-creating-kvm-vm-using-virsh



</body></email><email><emailId>20211209204552</emailId><senderName>lejeczek</senderName><senderEmail>peljasz@yahoo.co.uk</senderEmail><timestampReceived>2021-12-09 20:45:52-0400</timestampReceived><subject>Libgfapi gone too?</subject><body>

Hi guys.

Is glusterFS/libgfapi support removed (permanently) too? In 
CentOS 9 Stream.

thanks, L.

</body></email><email><emailId>20211206162700</emailId><senderName>lejeczek</senderName><senderEmail>peljasz@yahoo.co.uk</senderEmail><timestampReceived>2021-12-06 16:27:00-0400</timestampReceived><subject>internal error - invalid characters</subject><body>

Hi guys.

Have you seen something like this below?
...
internal error: The string resource has invalid characters 
in its value
internal error: The provided value contains invalid 
characters: Solarstorm SFN5162F SFP+ Server Adapter

this if from journal logs.
This hardware model of the NICs which comprise make up a 
team/bridge which libvirt net use, but what would 'libvirtd' 
bother with that?

many thanks, L.

</body></email><email><emailId>20211207112815</emailId><senderName>Ján Tomko</senderName><senderEmail>jtomko@redhat.com</senderEmail><timestampReceived>2021-12-07 11:28:15-0400</timestampReceived><subject>Re: internal error - invalid characters</subject><body>


On a Monday in 2021, lejeczek wrote:
&gt;Hi guys.
&gt;
&gt;Have you seen something like this below?
&gt;...
&gt;internal error: The string resource has invalid characters in its 
&gt;value
&gt;internal error: The provided value contains invalid characters: 
&gt;Solarstorm SFN5162F SFP+ Server Adapter
&gt;

This error message was only present in libvirt v7.9.0. Since v7.10.0
libvirt should ignore non-printable characters.
https://bugzilla.redhat.com/show_bug.cgi?id=2022589

Jano

&gt;this if from journal logs.
&gt;This hardware model of the NICs which comprise make up a team/bridge 
&gt;which libvirt net use, but what would 'libvirtd' bother with that?
&gt;
&gt;many thanks, L.
&gt;

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20211213093920</emailId><senderName>lejeczek</senderName><senderEmail>peljasz@yahoo.co.uk</senderEmail><timestampReceived>2021-12-13 09:39:20-0400</timestampReceived><subject>Re: internal error - invalid characters</subject><body>



On 07/12/2021 11:28, Ján Tomko wrote:
&gt; On a Monday in 2021, lejeczek wrote:
&gt;&gt; Hi guys.
&gt;&gt;
&gt;&gt; Have you seen something like this below?
&gt;&gt; ...
&gt;&gt; internal error: The string resource has invalid 
&gt;&gt; characters in its value
&gt;&gt; internal error: The provided value contains invalid 
&gt;&gt; characters: Solarstorm SFN5162F SFP+ Server Adapter
&gt;&gt;
&gt;
&gt; This error message was only present in libvirt v7.9.0. 
&gt; Since v7.10.0
&gt; libvirt should ignore non-printable characters.
&gt; https://bugzilla.redhat.com/show_bug.cgi?id=2022589
&gt;
&gt; Jano
&gt;
Would that "bug" be a reason why my libvirtd fails?
I have libvirtd.service started and see that in the logs, 
then suffices I do:
-&gt; $ virsh list --all
(having no VMs started)
I next thing in the logs is:
...
internal error: The provided value contains invalid 
characters: Solarstorm SFN5162F SFP+ Server Adapter
internal error: The string resource has invalid characters 
in its value
Stopping Virtualization daemon...
libvirtd.service: Deactivated successfully.
Stopped Virtualization daemon.

I'm on Centos 9 with libvirt-daemon-7.9.0-1.el9.x86_64.
With .service failed I still can start a VM.
-&gt; $ systemctl status -l libvirtd.service
○ libvirtd.service - Virtualization daemon
      Loaded: loaded 
(/usr/lib/systemd/system/libvirtd.service; disabled; vendor 
preset: dis&gt;
      Active: inactive (dead) since Mon 2021-12-13 09:32:04 
GMT; 5min ago
TriggeredBy: ○ libvirtd-tcp.socket
              ● libvirtd-ro.socket
              ● libvirtd-admin.socket
              ● libvirtd.socket
              ○ libvirtd-tls.socket

Is it that these versions and/or Centos 9 have introduced 
new (different defaults) ways to use/mange 'libvirtd', with 
.socket and no .service?

many thanks, L

</body></email><email><emailId>20211209095415</emailId><senderName>Liang Cong</senderName><senderEmail>lcong@redhat.com</senderEmail><timestampReceived>2021-12-09 09:54:15-0400</timestampReceived><subject>Guest vm doesn't recover after the nfs connection resume</subject><body>

Dear developers：

I found one issue during regular test and I could not confirm whether it is
a libvirt|qemu issue or it is a nfs client issue or it is not an issue, so
could you help to check it?
Below is the issue reproduce steps:

1.there is a nfs server with exports file like:
/nfs *(async,rw,no_root_squash)
2. host machine soft mount nfs:
mount nfs_server_ip:/nfs /var/lib/libvirt/images/nfs -o v4,soft
3. start a guest vm with disk tag xml like below:
&lt;disk type='file' device='disk'&gt;
&lt;driver name='qemu' type='qcow2'/&gt;
&lt;source
file='/var/lib/libvirt/images/nfs/RHEL-8.6.0-20211102.1-x86_64.qcow2'
index='1'/&gt;
&lt;backingStore/&gt;
&lt;target dev='vda' bus='virtio'/&gt;
&lt;alias name='virtio-disk0'/&gt;
&lt;/disk&gt;
4.Start the vm and during the guest vm boot, apply the iptables rule to
drop the nfs connection to nfs server
iptables -A OUTPUT -d nfs_server_ip -p tcp --dport 2049 -j DROP
5. Wait until the error log appear in /var/log/message
kernel: nfs: server nfs_server_ip not responding, timed out
6. delete the iptables rule to retain the connection to nfs server
iptables -D OUTPUT -d nfs_server_ip -p tcp --dport 2049 -j DROP
7. check the guest vm, found the boot process with error and can not
recover.
rror: ../../grub-core/disk/i386/pc/biosdisk.c:546:failure reading sector

0x7ab8 from `hd0'.

error: ../../grub-core/disk/i386/pc/biosdisk.c:546:failure reading sector

0x9190 from `hd0'.

error: ../../grub-core/disk/i386/pc/biosdisk.c:546:failure reading sector
8. found there is error message in /var/log/message
kernel: NFS: __nfs4_reclaim_open_state: Lock reclaim failed!

Thanks
Liang Cong

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Dear developers：&lt;br&gt;&lt;br&gt;I found one issue during regular test and I \
could not confirm whether it is a libvirt|qemu issue or it is a nfs client issue or \
it is not an issue, so could you help to check it?&lt;br&gt;Below is the issue reproduce \
steps:&lt;br&gt;&lt;br&gt;1.there is a nfs server with exports file like:&lt;br&gt;/nfs \
*(async,rw,no_root_squash)&lt;br&gt;2. host machine soft mount nfs:&lt;br&gt;mount \
nfs_server_ip:/nfs /var/lib/libvirt/images/nfs -o v4,soft&lt;br&gt;3. start a guest vm with \
disk tag xml like below:&lt;br&gt;&lt;disk type='file' \
device='disk'&gt;&lt;br&gt;&lt;driver name='qemu' \
type='qcow2'/&gt;&lt;br&gt;&lt;source \
file='/var/lib/libvirt/images/nfs/RHEL-8.6.0-20211102.1-x86_64.qcow2' \
index='1'/&gt;&lt;br&gt;&lt;backingStore/&gt;&lt;br&gt;&lt;target dev='vda' \
bus='virtio'/&gt;&lt;br&gt;&lt;alias \
name='virtio-disk0'/&gt;&lt;br&gt;&lt;/disk&gt;&lt;br&gt;4.Start the vm and during the \
guest vm boot, apply the iptables rule to drop the nfs connection to nfs \
server&lt;br&gt;iptables -A OUTPUT -d nfs_server_ip -p tcp --dport 2049 -j DROP&lt;br&gt;5. Wait \
until the error log appear in /var/log/message&lt;br&gt;kernel: nfs: server nfs_server_ip \
not responding, timed out&lt;br&gt;6. delete the iptables rule to retain the connection to \
nfs server&lt;br&gt;iptables -D OUTPUT -d nfs_server_ip -p tcp --dport 2049 -j DROP&lt;br&gt;7. \
check the guest vm, found the boot process with error and can not recover.&lt;br&gt;rror: \
../../grub-core/disk/i386/pc/biosdisk.c:546:failure reading sector&lt;br&gt;&lt;br&gt;0x7ab8 from \
`hd0'.&lt;br&gt;&lt;br&gt;error: ../../grub-core/disk/i386/pc/biosdisk.c:546:failure reading \
sector&lt;br&gt;&lt;br&gt;0x9190 from `hd0'.&lt;br&gt;&lt;br&gt;error: \
../../grub-core/disk/i386/pc/biosdisk.c:546:failure reading sector&lt;br&gt;8. found there \
is error message in /var/log/message&lt;br&gt;kernel: NFS: __nfs4_reclaim_open_state: Lock \
reclaim failed!&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&lt;/div&gt;&lt;div&gt;Liang Cong&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20211220055246</emailId><senderName>john doe</senderName><senderEmail>johndoe65534@mail.com</senderEmail><timestampReceived>2021-12-20 05:52:46-0400</timestampReceived><subject>Best way to install guest when it is not listed in output of osinfo-query os</subject><body>

Hello all,

I would like to install Debian Bullseye using virt-install, as part of
the command I usually specify the OS used with the option '--os-variant'.
This works great untill Buster ('debian10'), but now the guest is
Bullseye ('debian11') and is not listed in the output of 'osinfo-query
os' (1).

If I don't use the '--os-variant' flag I get the following warning:

"WARNING  No operating system detected, VM performance may suffer.
Specify an OS with --os-variant for optimal results."


Should I ignore the warning or what is the best way forward to install a
Debian Bullseye guest?

Both the host and the guest are  Debian 11.

1)  https://lists.debian.org/debian-user/2021/12/msg00742.html

--
John Doe


</body></email><email><emailId>20211220102232</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-12-20 10:22:32-0400</timestampReceived><subject>Re: Best way to install guest when it is not listed in output of osinfo-query os</subject><body>

On 12/20/21 06:52, john doe wrote:
&gt; Hello all,
&gt; 
&gt; I would like to install Debian Bullseye using virt-install, as part of
&gt; the command I usually specify the OS used with the option '--os-variant'.
&gt; This works great untill Buster ('debian10'), but now the guest is
&gt; Bullseye ('debian11') and is not listed in the output of 'osinfo-query
&gt; os' (1).
&gt; 
&gt; If I don't use the '--os-variant' flag I get the following warning:
&gt; 
&gt; "WARNING  No operating system detected, VM performance may suffer.
&gt; Specify an OS with --os-variant for optimal results."
&gt; 
&gt; 
&gt; Should I ignore the warning or what is the best way forward to install a
&gt; Debian Bullseye guest?
&gt; 
&gt; Both the host and the guest are  Debian 11.
&gt; 
&gt; 1)  https://lists.debian.org/debian-user/2021/12/msg00742.html

Debian 11 was added into the osinfo-db roughly 4 months ago:

https://gitlab.com/libosinfo/osinfo-db/-/commit/d729bd193947cc377c5ffc054222eef12a82e414

I'm not sure who maintains the package in debian, but I'd ask them to
refresh the package. Meanwhile, as a workaround I think it's safe to use
debian10 as --os-variant.

Michal

</body></email><email><emailId>20211220112609</emailId><senderName>Andrea Bolognani</senderName><senderEmail>abologna@redhat.com</senderEmail><timestampReceived>2021-12-20 11:26:09-0400</timestampReceived><subject>Re: Best way to install guest when it is not listed in output of osinfo-query os</subject><body>

On Mon, Dec 20, 2021 at 06:52:46AM +0100, john doe wrote:
&gt; Hello all,
&gt;
&gt; I would like to install Debian Bullseye using virt-install, as part of
&gt; the command I usually specify the OS used with the option '--os-variant'.
&gt; This works great untill Buster ('debian10'), but now the guest is
&gt; Bullseye ('debian11') and is not listed in the output of 'osinfo-query
&gt; os' (1).
&gt;
&gt; If I don't use the '--os-variant' flag I get the following warning:
&gt;
&gt; "WARNING  No operating system detected, VM performance may suffer.
&gt; Specify an OS with --os-variant for optimal results."
&gt;
&gt;
&gt; Should I ignore the warning or what is the best way forward to install a
&gt; Debian Bullseye guest?
&gt;
&gt; Both the host and the guest are  Debian 11.
&gt;
&gt; 1)  https://lists.debian.org/debian-user/2021/12/msg00742.html

You can just use '--os-variant debian10', it will work fine.

Alternatively, you can install a newer version of the osinfo database
by using osinfo-db-import. Doing so is probably overkill for your use
case.


Pino, do you think it would make sense to rebase osinfo-db in the
next Debian 11 update? Or at least cherry-pick the debian11 entry so
that things work as expected when creating a Debian 11 VM on a Debian
11 host? https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=980744 was
AFAICT intended to achieve just that.

-- 
Andrea Bolognani / Red Hat / Virtualization

</body></email><email><emailId>20211220215915</emailId><senderName>Martin Kletzander</senderName><senderEmail>mkletzan@redhat.com</senderEmail><timestampReceived>2021-12-20 21:59:15-0400</timestampReceived><subject>Re: Best way to install guest when it is not listed in output of osinfo-query os</subject><body>


On Mon, Dec 20, 2021 at 03:26:09AM -0800, Andrea Bolognani wrote:
&gt;On Mon, Dec 20, 2021 at 06:52:46AM +0100, john doe wrote:
&gt;&gt; Hello all,
&gt;&gt;
&gt;&gt; I would like to install Debian Bullseye using virt-install, as part of
&gt;&gt; the command I usually specify the OS used with the option '--os-variant'.
&gt;&gt; This works great untill Buster ('debian10'), but now the guest is
&gt;&gt; Bullseye ('debian11') and is not listed in the output of 'osinfo-query
&gt;&gt; os' (1).
&gt;&gt;
&gt;&gt; If I don't use the '--os-variant' flag I get the following warning:
&gt;&gt;
&gt;&gt; "WARNING  No operating system detected, VM performance may suffer.
&gt;&gt; Specify an OS with --os-variant for optimal results."
&gt;&gt;
&gt;&gt;
&gt;&gt; Should I ignore the warning or what is the best way forward to install a
&gt;&gt; Debian Bullseye guest?
&gt;&gt;
&gt;&gt; Both the host and the guest are  Debian 11.
&gt;&gt;
&gt;&gt; 1)  https://lists.debian.org/debian-user/2021/12/msg00742.html
&gt;
&gt;You can just use '--os-variant debian10', it will work fine.
&gt;
&gt;Alternatively, you can install a newer version of the osinfo database
&gt;by using osinfo-db-import. Doing so is probably overkill for your use
&gt;case.
&gt;
&gt;
&gt;Pino, do you think it would make sense to rebase osinfo-db in the
&gt;next Debian 11 update? Or at least cherry-pick the debian11 entry so
&gt;that things work as expected when creating a Debian 11 VM on a Debian
&gt;11 host? https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=980744 was
&gt;AFAICT intended to achieve just that.
&gt;

Any reason for debian not having an -unknown version like lot of the
other distros?

&gt;--
&gt;Andrea Bolognani / Red Hat / Virtualization
&gt;

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20211221094138</emailId><senderName>Andrea Bolognani</senderName><senderEmail>abologna@redhat.com</senderEmail><timestampReceived>2021-12-21 09:41:38-0400</timestampReceived><subject>Re: Best way to install guest when it is not listed in output of osinfo-query os</subject><body>

On Mon, Dec 20, 2021 at 10:59:15PM +0100, Martin Kletzander wrote:
&gt; Any reason for debian not having an -unknown version like lot of the
&gt; other distros?

I don't think there's a specific reason for that, it's probably just
a matter of nobody thinking of it until now :)

In addition to that, considering that there already entries for
Debian testing and Fedora Rawhide, adding one for Debian unstable
might make sense too.

-- 
Andrea Bolognani / Red Hat / Virtualization

</body></email><email><emailId>20211214095206</emailId><senderName>Marc Zyngier</senderName><senderEmail>maz@kernel.org</senderEmail><timestampReceived>2021-12-14 09:52:06-0400</timestampReceived><subject>Re: Libvirt on little.BIG ARM systems unable to start guest if no cpuset is provided</subject><body>

On Tue, 14 Dec 2021 08:16:40 +0000,
Qu Wenruo &lt;quwenruo.btrfs@gmx.com&gt; wrote:
&gt; 
&gt; 
&gt; 
&gt; On 2021/12/14 15:53, Michal Prívozník wrote:
&gt; &gt; On 12/14/21 01:41, Qu Wenruo wrote:
&gt; &gt;&gt; 
&gt; &gt;&gt; 
&gt; &gt;&gt; On 2021/12/14 00:49, Marc Zyngier wrote:
&gt; &gt;&gt;&gt; On Mon, 13 Dec 2021 16:06:14 +0000,
&gt; &gt;&gt;&gt; Peter Maydell &lt;peter.maydell@linaro.org&gt; wrote:
&gt; &gt;&gt;&gt;&gt; 
&gt; &gt;&gt;&gt;&gt; KVM on big.little setups is a kernel-level question really; I've
&gt; &gt;&gt;&gt;&gt; cc'd the kvmarm list.
&gt; &gt;&gt;&gt; 
&gt; &gt;&gt;&gt; Thanks Peter for throwing us under the big-little bus! ;-)
&gt; &gt;&gt;&gt; 
&gt; &gt;&gt;&gt;&gt; 
&gt; &gt;&gt;&gt;&gt; On Mon, 13 Dec 2021 at 15:02, Qu Wenruo &lt;quwenruo.btrfs@gmx.com&gt; wrote:
&gt; &gt;&gt;&gt;&gt;&gt; 
&gt; &gt;&gt;&gt;&gt;&gt; 
&gt; &gt;&gt;&gt;&gt;&gt; 
&gt; &gt;&gt;&gt;&gt;&gt; On 2021/12/13 21:17, Michal Prívozník wrote:
&gt; &gt;&gt;&gt;&gt;&gt;&gt; On 12/11/21 02:58, Qu Wenruo wrote:
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; Hi,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; Recently I got my libvirt setup on both RK3399 (RockPro64) and RPI
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; CM4,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; with upstream kernels.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; For RPI CM4 its mostly smooth sail, but on RK3399 due to its
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; little.BIG
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; setup (core 0-3 are 4x A55 cores, and core 4-5 are 2x A72 cores), it
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; brings quite some troubles for VMs.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; In short, without proper cpuset to bind the VM to either all A72
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; cores
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; or all A55 cores, the VM will mostly fail to boot.
&gt; &gt;&gt;&gt; 
&gt; &gt;&gt;&gt; s/A55/A53/. There were thankfully no A72+A55 ever produced (just the
&gt; &gt;&gt;&gt; though of it makes me sick).
&gt; &gt;&gt;&gt; 
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; Currently the working xml is:
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;      &lt;vcpu placement='static' cpuset='4-5'&gt;2&lt;/vcpu&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;      &lt;cpu mode='host-passthrough' check='none'/&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; But even with vcpupin, pinning each vcpu to each physical core, VM
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; will
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; mostly fail to start up due to vcpu initialization failed with
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; -EINVAL.
&gt; &gt;&gt;&gt; 
&gt; &gt;&gt;&gt; Disclaimer: I know nothing about libvirt (and no, I don't want to
&gt; &gt;&gt;&gt; know! ;-).
&gt; &gt;&gt;&gt; 
&gt; &gt;&gt;&gt; However, for things to be reliable, you need to taskset the whole QEMU
&gt; &gt;&gt;&gt; process to the CPU type you intend to use.
&gt; &gt;&gt; 
&gt; &gt;&gt; Yep, that's what I'm doing.
&gt; &gt;&gt; 
&gt; &gt;&gt;&gt; That's because, AFAICT,
&gt; &gt;&gt;&gt; QEMU will snapshot the system registers outside of the vcpu threads,
&gt; &gt;&gt;&gt; and attempt to use the result to configure the actual vcpu threads. If
&gt; &gt;&gt;&gt; they happen to run on different CPU types, the sysregs will differ in
&gt; &gt;&gt;&gt; incompatible ways and an error will be returned. This may or may not
&gt; &gt;&gt;&gt; be a bug, I don't know (I see it as a feature).
&gt; &gt;&gt; 
&gt; &gt;&gt; Then this brings another question.
&gt; &gt;&gt; 
&gt; &gt;&gt; If we can pin each vCPU to each physical core (both little and big),
&gt; &gt;&gt; then as long as the registers are per-vCPU based, it should be able to
&gt; &gt;&gt; pass both big and little cores to the VM.
&gt; &gt;&gt; 
&gt; &gt;&gt; Yeah, I totally understand this screw up the scheduling, but that's at
&gt; &gt;&gt; least what (some insane) users want (just like me).
&gt; &gt;&gt; 
&gt; &gt;&gt;&gt; 
&gt; &gt;&gt;&gt; If you are annoyed with this behaviour, you can always use a different
&gt; &gt;&gt;&gt; VMM that won't care about such difference (crosvm or kvmtool, to name
&gt; &gt;&gt;&gt; a few).
&gt; &gt;&gt; 
&gt; &gt;&gt; Sounds pretty interesting, a new world but without libvirt...
&gt; &gt;&gt; 
&gt; &gt;&gt;&gt; However, the guest will be able to observe the migration from
&gt; &gt;&gt;&gt; one cpu type to another. This may or may not affect your guest's
&gt; &gt;&gt;&gt; behaviour.
&gt; &gt;&gt; 
&gt; &gt;&gt; Not sure if it's possible to pin each vCPU thread to each core, but let
&gt; &gt;&gt; me try.
&gt; &gt;&gt; 
&gt; &gt; 
&gt; &gt; Sure it is, for instance:
&gt; &gt; 
&gt; &gt; &lt;cputune&gt;
&gt; &gt;      &lt;vcpupin vcpu="0" cpuset="1-4,^2"/&gt;
&gt; &gt;      &lt;vcpupin vcpu="1" cpuset="0,1"/&gt;
&gt; &gt;      &lt;vcpupin vcpu="2" cpuset="2,3"/&gt;
&gt; &gt;      &lt;vcpupin vcpu="3" cpuset="0,4"/&gt;
&gt; &gt;      &lt;emulatorpin cpuset="1-3"/&gt;
&gt; &gt;      &lt;iothreadpin iothread="1" cpuset="5,6"/&gt;
&gt; &gt;      &lt;iothreadpin iothread="2" cpuset="7,8"/&gt;
&gt; &gt; &lt;/cputune&gt;
&gt; 
&gt; That's what I have already tried before.
&gt; I pinned vcpu 0-6 to physical core 0-6, and still no reliable boot up.
&gt; 
&gt; And that's why I'm asking here.

You are still missing the point of how QEMU works:

- QEMU creates a dummy VM with a single vcpu. This can happen on *any*
  CPU.
- It snapshots the sysregs for this vcpu, and keep them for later
- It then destroy this VM
- QEMU then creates the full VM, with all the vcpus
- Each vcpu gets initialised with the state saved earlier. If any vcpu
  is initialised on a physical CPU of a different type from the one
  that has been used for the dummy VM, you lose, as we cannot restore
  some of the registers such as MIDR_EL1 (and other registers that KVM
  considers as invariant).

To fix this, you need to change QEMU's notion of a template VM, or
change KVM's notion of invariant registers. The former is quite hard,
and the later breaks a ton of things for guests, such as errata
workarounds.

The best workaround is to taskset the QEMU process (and I really mean
the process, not individual threads) to an homogeneous set of CPUs and
be done with it.

	M.

-- 
Without deviation from the norm, progress is not possible.


</body></email><email><emailId>20211214100829</emailId><senderName>Peter Maydell</senderName><senderEmail>peter.maydell@linaro.org</senderEmail><timestampReceived>2021-12-14 10:08:29-0400</timestampReceived><subject>Re: Libvirt on little.BIG ARM systems unable to start guest if no cpuset is provided</subject><body>

On Tue, 14 Dec 2021 at 09:52, Marc Zyngier &lt;maz@kernel.org&gt; wrote:
&gt; You are still missing the point of how QEMU works:
&gt;
&gt; - QEMU creates a dummy VM with a single vcpu. This can happen on *any*
&gt;   CPU.
&gt; - It snapshots the sysregs for this vcpu, and keep them for later
&gt; - It then destroy this VM
&gt; - QEMU then creates the full VM, with all the vcpus
&gt; - Each vcpu gets initialised with the state saved earlier. If any vcpu
&gt;   is initialised on a physical CPU of a different type from the one
&gt;   that has been used for the dummy VM, you lose, as we cannot restore
&gt;   some of the registers such as MIDR_EL1 (and other registers that KVM
&gt;   considers as invariant).

Put another way, QEMU's "-cpu host" is exactly one thing
(the "create a dummy VM and snapshot" steps above are where
QEMU defines what "-cpu host" means), and we have an implicit
assumption that the VM must only have one kind of guest CPU,
and not be heterogenous.

&gt; The best workaround is to taskset the QEMU process (and I really mean
&gt; the process, not individual threads) to an homogeneous set of CPUs and
&gt; be done with it.

Agreed. I suspect that often the 'little' CPUs are sufficiently
low-power to probably not be worth giving to the VM anyway.

Side note: if you *do* give a guest both big and little CPUs
using kvmtool or something similar, does the guest kernel get
enough information to schedule tasks properly to both kinds of
CPU, or does it just assume they're all the same and happily
put performance-requiring tasks on the little CPUs ?

-- PMM

</body></email><email><emailId>20211214102140</emailId><senderName>Qu Wenruo</senderName><senderEmail>quwenruo.btrfs@gmx.com</senderEmail><timestampReceived>2021-12-14 10:21:40-0400</timestampReceived><subject>Re: Libvirt on little.BIG ARM systems unable to start guest if no cpuset is provided</subject><body>



On 2021/12/14 17:52, Marc Zyngier wrote:
&gt; On Tue, 14 Dec 2021 08:16:40 +0000,
&gt; Qu Wenruo &lt;quwenruo.btrfs@gmx.com&gt; wrote:
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; On 2021/12/14 15:53, Michal Prívozník wrote:
&gt;&gt;&gt; On 12/14/21 01:41, Qu Wenruo wrote:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; On 2021/12/14 00:49, Marc Zyngier wrote:
&gt;&gt;&gt;&gt;&gt; On Mon, 13 Dec 2021 16:06:14 +0000,
&gt;&gt;&gt;&gt;&gt; Peter Maydell &lt;peter.maydell@linaro.org&gt; wrote:
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; KVM on big.little setups is a kernel-level question really; I've
&gt;&gt;&gt;&gt;&gt;&gt; cc'd the kvmarm list.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Thanks Peter for throwing us under the big-little bus! ;-)
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; On Mon, 13 Dec 2021 at 15:02, Qu Wenruo &lt;quwenruo.btrfs@gmx.com&gt; wrote:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; On 2021/12/13 21:17, Michal Prívozník wrote:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; On 12/11/21 02:58, Qu Wenruo wrote:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Hi,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Recently I got my libvirt setup on both RK3399 (RockPro64) and RPI
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; CM4,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; with upstream kernels.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; For RPI CM4 its mostly smooth sail, but on RK3399 due to its
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; little.BIG
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; setup (core 0-3 are 4x A55 cores, and core 4-5 are 2x A72 cores), it
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; brings quite some troubles for VMs.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; In short, without proper cpuset to bind the VM to either all A72
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; cores
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; or all A55 cores, the VM will mostly fail to boot.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; s/A55/A53/. There were thankfully no A72+A55 ever produced (just the
&gt;&gt;&gt;&gt;&gt; though of it makes me sick).
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Currently the working xml is:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;       &lt;vcpu placement='static' cpuset='4-5'&gt;2&lt;/vcpu&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;       &lt;cpu mode='host-passthrough' check='none'/&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; But even with vcpupin, pinning each vcpu to each physical core, VM
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; will
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; mostly fail to start up due to vcpu initialization failed with
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; -EINVAL.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Disclaimer: I know nothing about libvirt (and no, I don't want to
&gt;&gt;&gt;&gt;&gt; know! ;-).
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; However, for things to be reliable, you need to taskset the whole QEMU
&gt;&gt;&gt;&gt;&gt; process to the CPU type you intend to use.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Yep, that's what I'm doing.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; That's because, AFAICT,
&gt;&gt;&gt;&gt;&gt; QEMU will snapshot the system registers outside of the vcpu threads,
&gt;&gt;&gt;&gt;&gt; and attempt to use the result to configure the actual vcpu threads. If
&gt;&gt;&gt;&gt;&gt; they happen to run on different CPU types, the sysregs will differ in
&gt;&gt;&gt;&gt;&gt; incompatible ways and an error will be returned. This may or may not
&gt;&gt;&gt;&gt;&gt; be a bug, I don't know (I see it as a feature).
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Then this brings another question.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; If we can pin each vCPU to each physical core (both little and big),
&gt;&gt;&gt;&gt; then as long as the registers are per-vCPU based, it should be able to
&gt;&gt;&gt;&gt; pass both big and little cores to the VM.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Yeah, I totally understand this screw up the scheduling, but that's at
&gt;&gt;&gt;&gt; least what (some insane) users want (just like me).
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; If you are annoyed with this behaviour, you can always use a different
&gt;&gt;&gt;&gt;&gt; VMM that won't care about such difference (crosvm or kvmtool, to name
&gt;&gt;&gt;&gt;&gt; a few).
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Sounds pretty interesting, a new world but without libvirt...
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; However, the guest will be able to observe the migration from
&gt;&gt;&gt;&gt;&gt; one cpu type to another. This may or may not affect your guest's
&gt;&gt;&gt;&gt;&gt; behaviour.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Not sure if it's possible to pin each vCPU thread to each core, but let
&gt;&gt;&gt;&gt; me try.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Sure it is, for instance:
&gt;&gt;&gt;
&gt;&gt;&gt; &lt;cputune&gt;
&gt;&gt;&gt;       &lt;vcpupin vcpu="0" cpuset="1-4,^2"/&gt;
&gt;&gt;&gt;       &lt;vcpupin vcpu="1" cpuset="0,1"/&gt;
&gt;&gt;&gt;       &lt;vcpupin vcpu="2" cpuset="2,3"/&gt;
&gt;&gt;&gt;       &lt;vcpupin vcpu="3" cpuset="0,4"/&gt;
&gt;&gt;&gt;       &lt;emulatorpin cpuset="1-3"/&gt;
&gt;&gt;&gt;       &lt;iothreadpin iothread="1" cpuset="5,6"/&gt;
&gt;&gt;&gt;       &lt;iothreadpin iothread="2" cpuset="7,8"/&gt;
&gt;&gt;&gt; &lt;/cputune&gt;
&gt;&gt;
&gt;&gt; That's what I have already tried before.
&gt;&gt; I pinned vcpu 0-6 to physical core 0-6, and still no reliable boot up.
&gt;&gt;
&gt;&gt; And that's why I'm asking here.
&gt;
&gt; You are still missing the point of how QEMU works:
&gt;
&gt; - QEMU creates a dummy VM with a single vcpu. This can happen on *any*
&gt;    CPU.

This is the main point that I missed.

Thanks very much for point this out.

&gt; - It snapshots the sysregs for this vcpu, and keep them for later
&gt; - It then destroy this VM
&gt; - QEMU then creates the full VM, with all the vcpus
&gt; - Each vcpu gets initialised with the state saved earlier. If any vcpu
&gt;    is initialised on a physical CPU of a different type from the one
&gt;    that has been used for the dummy VM, you lose, as we cannot restore
&gt;    some of the registers such as MIDR_EL1 (and other registers that KVM
&gt;    considers as invariant).
&gt;
&gt; To fix this, you need to change QEMU's notion of a template VM, or
&gt; change KVM's notion of invariant registers. The former is quite hard,
&gt; and the later breaks a ton of things for guests, such as errata
&gt; workarounds.

&gt; The best workaround is to taskset the QEMU process (and I really mean
&gt; the process, not individual threads) to an homogeneous set of CPUs and
&gt; be done with it.

Yeah, that's why the cpuset way is working, as it seems also limiting
the initial "temporary" VM creating to specified CPUs.

Just curious, is there some defined common VM related registers that can
be restore on all cores? (At least for A53 + A72 case).

If completely no, then virtualization is really not even targeted for
BIG.little designs I guess.

Thanks,
Qu

&gt;
&gt; 	M.
&gt;


</body></email><email><emailId>20211214103353</emailId><senderName>Marc Zyngier</senderName><senderEmail>maz@kernel.org</senderEmail><timestampReceived>2021-12-14 10:33:53-0400</timestampReceived><subject>Re: Libvirt on little.BIG ARM systems unable to start guest if no cpuset is provided</subject><body>

On Tue, 14 Dec 2021 10:08:29 +0000,
Peter Maydell &lt;peter.maydell@linaro.org&gt; wrote:
&gt; 
&gt; On Tue, 14 Dec 2021 at 09:52, Marc Zyngier &lt;maz@kernel.org&gt; wrote:
&gt; &gt; The best workaround is to taskset the QEMU process (and I really mean
&gt; &gt; the process, not individual threads) to an homogeneous set of CPUs and
&gt; &gt; be done with it.
&gt; 
&gt; Agreed. I suspect that often the 'little' CPUs are sufficiently
&gt; low-power to probably not be worth giving to the VM anyway.

They are actually pretty beefy, in most cases. If you are I/O bound,
the small cores are the right target. This email is brought to you via
a couple of A55 CPUs running a VM and acting as my home gateway. If
'the internet' was getting slow, I'd have heard about it! ;-)

&gt; Side note: if you *do* give a guest both big and little CPUs
&gt; using kvmtool or something similar, does the guest kernel get
&gt; enough information to schedule tasks properly to both kinds of
&gt; CPU, or does it just assume they're all the same and happily
&gt; put performance-requiring tasks on the little CPUs ?

Upstream kvmtool doesn't make any effort to do this, but I had a
series to perform such placement in the past. Once you know which
physical CPUs you are placing the vcpus on, you can extract the
individual CPU capacity[1] and expose it in the guest's DT as a
cpu-specific 'capacity-dmips-mhz' property. A Linux guest will take
the hint and do the right thing.

	M.

[1] /sys/devices/system/cpu/cpu*/cpu_capacity

-- 
Without deviation from the norm, progress is not possible.

</body></email><email><emailId>20211214103640</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-12-14 10:36:40-0400</timestampReceived><subject>Re: Libvirt on little.BIG ARM systems unable to start guest if no cpuset is provided</subject><body>

On Tue, Dec 14, 2021 at 09:34:18AM +0000, Marc Zyngier wrote:
&gt; On Tue, 14 Dec 2021 00:41:01 +0000,
&gt; Qu Wenruo &lt;quwenruo.btrfs@gmx.com&gt; wrote:
&gt; &gt; 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; On 2021/12/14 00:49, Marc Zyngier wrote:
&gt; &gt; &gt; On Mon, 13 Dec 2021 16:06:14 +0000,
&gt; &gt; &gt; Peter Maydell &lt;peter.maydell@linaro.org&gt; wrote:
&gt; &gt; &gt;&gt; 
&gt; &gt; &gt;&gt; KVM on big.little setups is a kernel-level question really; I've
&gt; &gt; &gt;&gt; cc'd the kvmarm list.
&gt; &gt; &gt; 
&gt; &gt; &gt; Thanks Peter for throwing us under the big-little bus! ;-)
&gt; &gt; &gt; 
&gt; &gt; &gt;&gt; 
&gt; &gt; &gt;&gt; On Mon, 13 Dec 2021 at 15:02, Qu Wenruo &lt;quwenruo.btrfs@gmx.com&gt; wrote:
&gt; &gt; &gt;&gt;&gt; 
&gt; &gt; &gt;&gt;&gt; 
&gt; &gt; &gt;&gt;&gt; 
&gt; &gt; &gt;&gt;&gt; On 2021/12/13 21:17, Michal Prívozník wrote:
&gt; &gt; &gt;&gt;&gt;&gt; On 12/11/21 02:58, Qu Wenruo wrote:
&gt; &gt; &gt;&gt;&gt;&gt;&gt; Hi,
&gt; &gt; &gt;&gt;&gt;&gt;&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;&gt; Recently I got my libvirt setup on both RK3399 (RockPro64) and RPI CM4,
&gt; &gt; &gt;&gt;&gt;&gt;&gt; with upstream kernels.
&gt; &gt; &gt;&gt;&gt;&gt;&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;&gt; For RPI CM4 its mostly smooth sail, but on RK3399 due to its little.BIG
&gt; &gt; &gt;&gt;&gt;&gt;&gt; setup (core 0-3 are 4x A55 cores, and core 4-5 are 2x A72 cores), it
&gt; &gt; &gt;&gt;&gt;&gt;&gt; brings quite some troubles for VMs.
&gt; &gt; &gt;&gt;&gt;&gt;&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;&gt; In short, without proper cpuset to bind the VM to either all A72 cores
&gt; &gt; &gt;&gt;&gt;&gt;&gt; or all A55 cores, the VM will mostly fail to boot.
&gt; &gt; &gt; 
&gt; &gt; &gt; s/A55/A53/. There were thankfully no A72+A55 ever produced (just the
&gt; &gt; &gt; though of it makes me sick).
&gt; &gt; &gt; 
&gt; &gt; &gt;&gt;&gt;&gt;&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;&gt; Currently the working xml is:
&gt; &gt; &gt;&gt;&gt;&gt;&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;&gt;     &lt;vcpu placement='static' cpuset='4-5'&gt;2&lt;/vcpu&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;     &lt;cpu mode='host-passthrough' check='none'/&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;&gt; But even with vcpupin, pinning each vcpu to each physical core, VM will
&gt; &gt; &gt;&gt;&gt;&gt;&gt; mostly fail to start up due to vcpu initialization failed with -EINVAL.
&gt; &gt; &gt; 
&gt; &gt; &gt; Disclaimer: I know nothing about libvirt (and no, I don't want to
&gt; &gt; &gt; know! ;-).
&gt; &gt; &gt; 
&gt; &gt; &gt; However, for things to be reliable, you need to taskset the whole QEMU
&gt; &gt; &gt; process to the CPU type you intend to use.
&gt; &gt; 
&gt; &gt; Yep, that's what I'm doing.
&gt; 
&gt; Are you sure? The xml directive above seem to only apply to the vcpus,
&gt; and no other QEMU thread.

For historical reasons this XML element is a bit misleadingly named.

With the config

   &lt;vcpu placement='static' cpuset='4-5'&gt;2&lt;/vcpu&gt;

the 'cpuset' applies to the QEMU process as a whole - its vCPUs,
I/O threads and any other emulator threads.

There is a separate config for setting per-VCPU binding which was
illustrated elsewhere in this thread.

Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20211214105912</emailId><senderName>Qu Wenruo</senderName><senderEmail>quwenruo.btrfs@gmx.com</senderEmail><timestampReceived>2021-12-14 10:59:12-0400</timestampReceived><subject>Re: Libvirt on little.BIG ARM systems unable to start guest if no cpuset is provided</subject><body>



On 2021/12/14 18:36, Daniel P. Berrangé wrote:
&gt; On Tue, Dec 14, 2021 at 09:34:18AM +0000, Marc Zyngier wrote:
&gt;&gt; On Tue, 14 Dec 2021 00:41:01 +0000,
&gt;&gt; Qu Wenruo &lt;quwenruo.btrfs@gmx.com&gt; wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; On 2021/12/14 00:49, Marc Zyngier wrote:
&gt;&gt;&gt;&gt; On Mon, 13 Dec 2021 16:06:14 +0000,
&gt;&gt;&gt;&gt; Peter Maydell &lt;peter.maydell@linaro.org&gt; wrote:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; KVM on big.little setups is a kernel-level question really; I've
&gt;&gt;&gt;&gt;&gt; cc'd the kvmarm list.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Thanks Peter for throwing us under the big-little bus! ;-)
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; On Mon, 13 Dec 2021 at 15:02, Qu Wenruo &lt;quwenruo.btrfs@gmx.com&gt; wrote:
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; On 2021/12/13 21:17, Michal Prívozník wrote:
&gt;&gt;&gt;&gt;&gt;&gt;&gt; On 12/11/21 02:58, Qu Wenruo wrote:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Hi,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Recently I got my libvirt setup on both RK3399 (RockPro64) and RPI CM4,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; with upstream kernels.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; For RPI CM4 its mostly smooth sail, but on RK3399 due to its little.BIG
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; setup (core 0-3 are 4x A55 cores, and core 4-5 are 2x A72 cores), it
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; brings quite some troubles for VMs.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; In short, without proper cpuset to bind the VM to either all A72 cores
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; or all A55 cores, the VM will mostly fail to boot.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; s/A55/A53/. There were thankfully no A72+A55 ever produced (just the
&gt;&gt;&gt;&gt; though of it makes me sick).
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Currently the working xml is:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;      &lt;vcpu placement='static' cpuset='4-5'&gt;2&lt;/vcpu&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;      &lt;cpu mode='host-passthrough' check='none'/&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; But even with vcpupin, pinning each vcpu to each physical core, VM will
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; mostly fail to start up due to vcpu initialization failed with -EINVAL.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Disclaimer: I know nothing about libvirt (and no, I don't want to
&gt;&gt;&gt;&gt; know! ;-).
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; However, for things to be reliable, you need to taskset the whole QEMU
&gt;&gt;&gt;&gt; process to the CPU type you intend to use.
&gt;&gt;&gt;
&gt;&gt;&gt; Yep, that's what I'm doing.
&gt;&gt;
&gt;&gt; Are you sure? The xml directive above seem to only apply to the vcpus,
&gt;&gt; and no other QEMU thread.
&gt;
&gt; For historical reasons this XML element is a bit misleadingly named.
&gt;
&gt; With the config
&gt;
&gt;     &lt;vcpu placement='static' cpuset='4-5'&gt;2&lt;/vcpu&gt;
&gt;
&gt; the 'cpuset' applies to the QEMU process as a whole - its vCPUs,
&gt; I/O threads and any other emulator threads.
&gt;
&gt; There is a separate config for setting per-VCPU binding which was
&gt; illustrated elsewhere in this thread.

Which also means, I can put the io threads to A53 cores freeing up the
A72 cores more.

And is there any plan to deprecate the old "cpuset" key of vcpu element,
and recommend to use "vcpupin" element?

Thanks,
Qu

&gt;
&gt; Regards,
&gt; Daniel


</body></email><email><emailId>20211214110010</emailId><senderName>Marc Zyngier</senderName><senderEmail>maz@kernel.org</senderEmail><timestampReceived>2021-12-14 11:00:10-0400</timestampReceived><subject>Re: Libvirt on little.BIG ARM systems unable to start guest if no cpuset is provided</subject><body>

On Tue, 14 Dec 2021 10:21:40 +0000,
Qu Wenruo &lt;quwenruo.btrfs@gmx.com&gt; wrote:
&gt; On 2021/12/14 17:52, Marc Zyngier wrote:
&gt; &gt; The best workaround is to taskset the QEMU process (and I really mean
&gt; &gt; the process, not individual threads) to an homogeneous set of CPUs and
&gt; &gt; be done with it.
&gt; 
&gt; Yeah, that's why the cpuset way is working, as it seems also limiting
&gt; the initial "temporary" VM creating to specified CPUs.
&gt; 
&gt; Just curious, is there some defined common VM related registers that can
&gt; be restore on all cores? (At least for A53 + A72 case).

Most of the registers are common, and most of the feature registers
are actually massaged by KVM to make them look homogeneous if even the
HW isn't. There are however a few registers that need to be exposed to
the guest verbatim, and MIDR_EL1 is the most important one, as it
carries the core 'identity', which an operating system will absolutely
need to implement critical workarounds (and there are no shortage of
them on both A53 and A72).

&gt; If completely no, then virtualization is really not even targeted for
&gt; BIG.little designs I guess.

If your use of virtualisation is to be completely abstracted from the
underlying HW, then you are right, that doesn't really work at all.
Not by design, but because all implementations have embarrassing warts
that need some sort of workarounds.

	M.

-- 
Without deviation from the norm, progress is not possible.

</body></email><email><emailId>20211209100253</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-12-09 10:02:53-0400</timestampReceived><subject>Re: Guest vm doesn't recover after the nfs connection resume</subject><body>

On Thu, Dec 09, 2021 at 05:54:15PM +0800, Liang Cong wrote:
&gt; Dear developers：
&gt; 
&gt; I found one issue during regular test and I could not confirm whether it is
&gt; a libvirt|qemu issue or it is a nfs client issue or it is not an issue, so
&gt; could you help to check it?
&gt; Below is the issue reproduce steps:
&gt; 
&gt; 1.there is a nfs server with exports file like:
&gt; /nfs *(async,rw,no_root_squash)
&gt; 2. host machine soft mount nfs:
&gt; mount nfs_server_ip:/nfs /var/lib/libvirt/images/nfs -o v4,soft
&gt; 3. start a guest vm with disk tag xml like below:
&gt; &lt;disk type='file' device='disk'&gt;
&gt; &lt;driver name='qemu' type='qcow2'/&gt;
&gt; &lt;source
&gt; file='/var/lib/libvirt/images/nfs/RHEL-8.6.0-20211102.1-x86_64.qcow2'
&gt; index='1'/&gt;
&gt; &lt;backingStore/&gt;
&gt; &lt;target dev='vda' bus='virtio'/&gt;
&gt; &lt;alias name='virtio-disk0'/&gt;
&gt; &lt;/disk&gt;
&gt; 4.Start the vm and during the guest vm boot, apply the iptables rule to
&gt; drop the nfs connection to nfs server
&gt; iptables -A OUTPUT -d nfs_server_ip -p tcp --dport 2049 -j DROP
&gt; 5. Wait until the error log appear in /var/log/message
&gt; kernel: nfs: server nfs_server_ip not responding, timed out
&gt; 6. delete the iptables rule to retain the connection to nfs server
&gt; iptables -D OUTPUT -d nfs_server_ip -p tcp --dport 2049 -j DROP
&gt; 7. check the guest vm, found the boot process with error and can not
&gt; recover.
&gt; rror: ../../grub-core/disk/i386/pc/biosdisk.c:546:failure reading sector
&gt; 
&gt; 0x7ab8 from `hd0'.
&gt; 
&gt; error: ../../grub-core/disk/i386/pc/biosdisk.c:546:failure reading sector
&gt; 
&gt; 0x9190 from `hd0'.
&gt; 
&gt; error: ../../grub-core/disk/i386/pc/biosdisk.c:546:failure reading sector


So this shows that I/O errors have been sent from the host to the guest.

This means two things:

 - The host has reported I/O errors to QEMU
 - QEMU is confjigured to reporte I/O errors to the guest
   (rerror/werror attributes for disk config)

I expect the first point there is a result of you using 'soft' for
the NFS mount - try it again with 'hard'.

The alternative for 'rerror/werror' is to pause the guest, allowing
the host problem to be solved whereupon you unpause the guest.

Overall this behaviour just looks like a result of your config
choices.

Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20211214073542</emailId><senderName>Liang Cong</senderName><senderEmail>lcong@redhat.com</senderEmail><timestampReceived>2021-12-14 07:35:42-0400</timestampReceived><subject>Re: Guest vm doesn't recover after the nfs connection resume</subject><body>

Hi Daniel,

Thanks for your reply. I tried the nfs hard mount, and got the same
behavior of the soft mount.
But in the /var/log/message, got nfs server recovery message which is not
printed when mounting as soft mode.

Dec 14 02:12:47 test-1 kernel: nfs: server ip not responding, still trying
Dec 14 02:13:39 test-1 kernel: nfs: server ip not responding, timed out
*Dec 14 02:14:34 test-1 kernel: nfs: server ip OK*
Dec 14 02:14:34 test-1 kernel: NFS: __nfs4_reclaim_open_state: Lock reclaim
failed!


According to my understanding the vm boot process will not recover(the vm
is still in running state, never paused) to normal until restarting the vm
guest.
And it is not the issue of libvirt or qemu, it is just the correct behavior
with the nfs connection timeout, right?

Thanks,
Liang Cong

On Thu, Dec 9, 2021 at 6:03 PM Daniel P. Berrangé &lt;berrange@redhat.com&gt;
wrote:

&gt; On Thu, Dec 09, 2021 at 05:54:15PM +0800, Liang Cong wrote:
&gt; &gt; Dear developers：
&gt; &gt;
&gt; &gt; I found one issue during regular test and I could not confirm whether it
&gt; is
&gt; &gt; a libvirt|qemu issue or it is a nfs client issue or it is not an issue,
&gt; so
&gt; &gt; could you help to check it?
&gt; &gt; Below is the issue reproduce steps:
&gt; &gt;
&gt; &gt; 1.there is a nfs server with exports file like:
&gt; &gt; /nfs *(async,rw,no_root_squash)
&gt; &gt; 2. host machine soft mount nfs:
&gt; &gt; mount nfs_server_ip:/nfs /var/lib/libvirt/images/nfs -o v4,soft
&gt; &gt; 3. start a guest vm with disk tag xml like below:
&gt; &gt; &lt;disk type='file' device='disk'&gt;
&gt; &gt; &lt;driver name='qemu' type='qcow2'/&gt;
&gt; &gt; &lt;source
&gt; &gt; file='/var/lib/libvirt/images/nfs/RHEL-8.6.0-20211102.1-x86_64.qcow2'
&gt; &gt; index='1'/&gt;
&gt; &gt; &lt;backingStore/&gt;
&gt; &gt; &lt;target dev='vda' bus='virtio'/&gt;
&gt; &gt; &lt;alias name='virtio-disk0'/&gt;
&gt; &gt; &lt;/disk&gt;
&gt; &gt; 4.Start the vm and during the guest vm boot, apply the iptables rule to
&gt; &gt; drop the nfs connection to nfs server
&gt; &gt; iptables -A OUTPUT -d nfs_server_ip -p tcp --dport 2049 -j DROP
&gt; &gt; 5. Wait until the error log appear in /var/log/message
&gt; &gt; kernel: nfs: server nfs_server_ip not responding, timed out
&gt; &gt; 6. delete the iptables rule to retain the connection to nfs server
&gt; &gt; iptables -D OUTPUT -d nfs_server_ip -p tcp --dport 2049 -j DROP
&gt; &gt; 7. check the guest vm, found the boot process with error and can not
&gt; &gt; recover.
&gt; &gt; rror: ../../grub-core/disk/i386/pc/biosdisk.c:546:failure reading sector
&gt; &gt;
&gt; &gt; 0x7ab8 from `hd0'.
&gt; &gt;
&gt; &gt; error: ../../grub-core/disk/i386/pc/biosdisk.c:546:failure reading sector
&gt; &gt;
&gt; &gt; 0x9190 from `hd0'.
&gt; &gt;
&gt; &gt; error: ../../grub-core/disk/i386/pc/biosdisk.c:546:failure reading sector
&gt;
&gt;
&gt; So this shows that I/O errors have been sent from the host to the guest.
&gt;
&gt; This means two things:
&gt;
&gt;  - The host has reported I/O errors to QEMU
&gt;  - QEMU is confjigured to reporte I/O errors to the guest
&gt;    (rerror/werror attributes for disk config)
&gt;
&gt; I expect the first point there is a result of you using 'soft' for
&gt; the NFS mount - try it again with 'hard'.
&gt;
&gt; The alternative for 'rerror/werror' is to pause the guest, allowing
&gt; the host problem to be solved whereupon you unpause the guest.
&gt;
&gt; Overall this behaviour just looks like a result of your config
&gt; choices.
&gt;
&gt; Regards,
&gt; Daniel
&gt; --
&gt; |: https://berrange.com      -o-
&gt; https://www.flickr.com/photos/dberrange :|
&gt; |: https://libvirt.org         -o-
&gt; https://fstop138.berrange.com :|
&gt; |: https://entangle-photo.org    -o-
&gt; https://www.instagram.com/dberrange :|
&gt;
&gt;

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hi  Daniel,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks for your reply. I tried the nfs \
hard mount, and got the same behavior of the soft mount.&lt;/div&gt;&lt;div&gt;But in the \
/var/log/message, got nfs server recovery message which is not printed when mounting \
as soft mode.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Dec 14 02:12:47 test-1 kernel: nfs: server ip \
not responding, still trying&lt;br&gt;Dec 14 02:13:39 test-1 kernel: nfs: server ip  not \
responding, timed out&lt;br&gt;&lt;font color="#0000ff"&gt;&lt;b&gt;Dec 14 02:14:34 test-1 kernel: nfs: \
server ip  OK&lt;/b&gt;&lt;/font&gt;&lt;br&gt;Dec 14 02:14:34 test-1 kernel: NFS: \
__nfs4_reclaim_open_state: Lock reclaim \
failed!&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;According to my understanding the \
vm boot process will not recover(the vm is still in running state, never paused) to \
normal until restarting the  vm guest.&lt;/div&gt;&lt;div&gt;And it is not the issue of libvirt \
or qemu, it is just the correct behavior with the nfs connection timeout, right?  \
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;Liang Cong&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Thu, Dec 9, 2021 at 6:03 PM \
Daniel P. Berrangé &lt;&lt;a \
href="mailto:berrange@redhat.com"&gt;berrange@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;On Thu, Dec 09, 2021 \
at 05:54:15PM +0800, Liang Cong wrote:&lt;br&gt; &gt; Dear developers：&lt;br&gt;
&gt; &lt;br&gt;
&gt; I found one issue during regular test and I could not confirm whether it is&lt;br&gt;
&gt; a libvirt|qemu issue or it is a nfs client issue or it is not an issue, so&lt;br&gt;
&gt; could you help to check it?&lt;br&gt;
&gt; Below is the issue reproduce steps:&lt;br&gt;
&gt; &lt;br&gt;
&gt; 1.there is a nfs server with exports file like:&lt;br&gt;
&gt; /nfs *(async,rw,no_root_squash)&lt;br&gt;
&gt; 2. host machine soft mount nfs:&lt;br&gt;
&gt; mount nfs_server_ip:/nfs /var/lib/libvirt/images/nfs -o v4,soft&lt;br&gt;
&gt; 3. start a guest vm with disk tag xml like below:&lt;br&gt;
&gt; &lt;disk type='file' device='disk'&gt;&lt;br&gt;
&gt; &lt;driver name='qemu' type='qcow2'/&gt;&lt;br&gt;
&gt; &lt;source&lt;br&gt;
&gt; file='/var/lib/libvirt/images/nfs/RHEL-8.6.0-20211102.1-x86_64.qcow2'&lt;br&gt;
 &gt; index='1'/&gt;&lt;br&gt;
&gt; &lt;backingStore/&gt;&lt;br&gt;
&gt; &lt;target dev='vda' bus='virtio'/&gt;&lt;br&gt;
&gt; &lt;alias name='virtio-disk0'/&gt;&lt;br&gt;
&gt; &lt;/disk&gt;&lt;br&gt;
&gt; 4.Start the vm and during the guest vm boot, apply the iptables rule to&lt;br&gt;
&gt; drop the nfs connection to nfs server&lt;br&gt;
&gt; iptables -A OUTPUT -d nfs_server_ip -p tcp --dport 2049 -j DROP&lt;br&gt;
&gt; 5. Wait until the error log appear in /var/log/message&lt;br&gt;
&gt; kernel: nfs: server nfs_server_ip not responding, timed out&lt;br&gt;
&gt; 6. delete the iptables rule to retain the connection to nfs server&lt;br&gt;
&gt; iptables -D OUTPUT -d nfs_server_ip -p tcp --dport 2049 -j DROP&lt;br&gt;
&gt; 7. check the guest vm, found the boot process with error and can not&lt;br&gt;
&gt; recover.&lt;br&gt;
&gt; rror: ../../grub-core/disk/i386/pc/biosdisk.c:546:failure reading sector&lt;br&gt;
&gt; &lt;br&gt;
&gt; 0x7ab8 from `hd0'.&lt;br&gt;
&gt; &lt;br&gt;
&gt; error: ../../grub-core/disk/i386/pc/biosdisk.c:546:failure reading sector&lt;br&gt;
&gt; &lt;br&gt;
&gt; 0x9190 from `hd0'.&lt;br&gt;
&gt; &lt;br&gt;
&gt; error: ../../grub-core/disk/i386/pc/biosdisk.c:546:failure reading sector&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
So this shows that I/O errors have been sent from the host to the guest.&lt;br&gt;
&lt;br&gt;
This means two things:&lt;br&gt;
&lt;br&gt;
  - The host has reported I/O errors to QEMU&lt;br&gt;
  - QEMU is confjigured to reporte I/O errors to the guest&lt;br&gt;
     (rerror/werror attributes for disk config)&lt;br&gt;
&lt;br&gt;
I expect the first point there is a result of you using 'soft' for&lt;br&gt;
the NFS mount - try it again with 'hard'.&lt;br&gt;
&lt;br&gt;
The alternative for 'rerror/werror' is to pause the guest, allowing&lt;br&gt;
the host problem to be solved whereupon you unpause the guest.&lt;br&gt;
&lt;br&gt;
Overall this behaviour just looks like a result of your config&lt;br&gt;
choices.&lt;br&gt;
&lt;br&gt;
Regards,&lt;br&gt;
Daniel&lt;br&gt;
-- &lt;br&gt;
&gt; &gt; &lt;a href="https://berrange.com" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://berrange.com&lt;/a&gt;         -o-      &lt;a \
&gt; &gt; href="https://www.flickr.com/photos/dberrange" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://www.flickr.com/photos/dberrange&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="https://libvirt.org" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://libvirt.org&lt;/a&gt;              -o-                  &lt;a \
&gt; &gt; href="https://fstop138.berrange.com" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://fstop138.berrange.com&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="https://entangle-photo.org" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://entangle-photo.org&lt;/a&gt;      -o-      &lt;a \
&gt; &gt; href="https://www.instagram.com/dberrange" rel="noreferrer" \
&gt; &gt; target="_blank"&gt;https://www.instagram.com/dberrange&lt;/a&gt; :|&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;



</body></email><email><emailId>20211210110826</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-12-10 11:08:26-0400</timestampReceived><subject>Re: Libgfapi gone too?</subject><body>

On Thu, Dec 09, 2021 at 08:45:52PM +0000, lejeczek wrote:
&gt; Hi guys.
&gt; 
&gt; Is glusterFS/libgfapi support removed (permanently) too? In CentOS 9 Stream.

Correct, the in-QEMU glusterfs client has been removed from builds
of the qemu-kvm RPM in CentOS-9 / RHEL-9.

If storing VM disk on gluster you will have to resort to using the
in-kernel glusterfs client to mount the disks locally, whereupon
QEMU can access them as plain files


Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20211210111816</emailId><senderName>lejeczek</senderName><senderEmail>peljasz@yahoo.co.uk</senderEmail><timestampReceived>2021-12-10 11:18:16-0400</timestampReceived><subject>Re: Libgfapi gone too?</subject><body>



On 10/12/2021 11:08, Daniel P. Berrangé wrote:
&gt; On Thu, Dec 09, 2021 at 08:45:52PM +0000, lejeczek wrote:
&gt;&gt; Hi guys.
&gt;&gt;
&gt;&gt; Is glusterFS/libgfapi support removed (permanently) too? In CentOS 9 Stream.
&gt; Correct, the in-QEMU glusterfs client has been removed from builds
&gt; of the qemu-kvm RPM in CentOS-9 / RHEL-9.
&gt;
&gt; If storing VM disk on gluster you will have to resort to using the
&gt; in-kernel glusterfs client to mount the disks locally, whereupon
&gt; QEMU can access them as plain files
&gt;
&gt;
&gt;
Guys, @redhat and all the others responsible - Official (but 
also blogs, changelogs, man pages, etc) docs have begun to 
form - 
https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9-beta
Please put all those _critical_ changes everywhere and admin 
might go first to read for what's new &amp; different, make it 
underscored + in-bold I'd suggest.

many thanks, L.


</body></email><email><emailId>20211213160614</emailId><senderName>Peter Maydell</senderName><senderEmail>peter.maydell@linaro.org</senderEmail><timestampReceived>2021-12-13 16:06:14-0400</timestampReceived><subject>Re: Libvirt on little.BIG ARM systems unable to start guest if no cpuset is provided</subject><body>

KVM on big.little setups is a kernel-level question really; I've
cc'd the kvmarm list.

On Mon, 13 Dec 2021 at 15:02, Qu Wenruo &lt;quwenruo.btrfs@gmx.com&gt; wrote:
&gt;
&gt;
&gt;
&gt; On 2021/12/13 21:17, Michal Prívozník wrote:
&gt; &gt; On 12/11/21 02:58, Qu Wenruo wrote:
&gt; &gt;&gt; Hi,
&gt; &gt;&gt;
&gt; &gt;&gt; Recently I got my libvirt setup on both RK3399 (RockPro64) and RPI CM4,
&gt; &gt;&gt; with upstream kernels.
&gt; &gt;&gt;
&gt; &gt;&gt; For RPI CM4 its mostly smooth sail, but on RK3399 due to its little.BIG
&gt; &gt;&gt; setup (core 0-3 are 4x A55 cores, and core 4-5 are 2x A72 cores), it
&gt; &gt;&gt; brings quite some troubles for VMs.
&gt; &gt;&gt;
&gt; &gt;&gt; In short, without proper cpuset to bind the VM to either all A72 cores
&gt; &gt;&gt; or all A55 cores, the VM will mostly fail to boot.
&gt; &gt;&gt;
&gt; &gt;&gt; Currently the working xml is:
&gt; &gt;&gt;
&gt; &gt;&gt;    &lt;vcpu placement='static' cpuset='4-5'&gt;2&lt;/vcpu&gt;
&gt; &gt;&gt;    &lt;cpu mode='host-passthrough' check='none'/&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; But even with vcpupin, pinning each vcpu to each physical core, VM will
&gt; &gt;&gt; mostly fail to start up due to vcpu initialization failed with -EINVAL.
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; This brings a problem, in theory RK3399 SoC should out-perform BCM2711
&gt; &gt;&gt; in multi-core performance, but if a VM can only be bind to either A72 or
&gt; &gt;&gt; A55 cores, then the performance is no longer competitive against
&gt; &gt;&gt; BCM2711, wasting the PCIE 2.0 x4 capacity.
&gt; &gt;&gt;
&gt; &gt;&gt; I guess with projects like Asahi Linux making progress, there will be
&gt; &gt;&gt; more and more such problems.
&gt; &gt;&gt;
&gt; &gt;&gt; Any clue on how to properly pass all physical CPU cores to VM for
&gt; &gt;&gt; little.BIG setup?
&gt; &gt;&gt;
&gt; &gt;
&gt; &gt; I have never met big.LITTLE but my understanding was that those big
&gt; &gt; cores are compatible with little ones and the only difference is that
&gt; &gt; the big ones are shut off if there's no demand (to save energy) leaving
&gt; &gt; only the little ones running.
&gt;
&gt; The big ones are not disabled AFAIK.
&gt;
&gt; And even changing the CPU model to A53 (the little ones), it still fails
&gt; to boot, thus it looks like A72 is not really able to emulate A53 cores?
&gt;
&gt; &gt;
&gt; &gt; Anyway, this is likely too high level forum and I'd ask QEMU developers:
&gt; &gt;
&gt; &gt; https://www.qemu.org/support/
&gt;
&gt; That's indeed the case, adding qemu to the CC list.
&gt;
&gt; And I found an existing bug report:
&gt; https://bugs.linaro.org/show_bug.cgi?id=1443

(This bug tracking system was essentially abandoned years ago; the
status of leftover bugs within it isn't indicative of anything.)

&gt; But I still didn't get the point why the 1:1 CPU-to-vcpu mapping still
&gt; doesn't work.

-- PMM


</body></email><email><emailId>20211213164941</emailId><senderName>Marc Zyngier</senderName><senderEmail>maz@kernel.org</senderEmail><timestampReceived>2021-12-13 16:49:41-0400</timestampReceived><subject>Re: Libvirt on little.BIG ARM systems unable to start guest if no cpuset is provided</subject><body>

On Mon, 13 Dec 2021 16:06:14 +0000,
Peter Maydell &lt;peter.maydell@linaro.org&gt; wrote:
&gt; 
&gt; KVM on big.little setups is a kernel-level question really; I've
&gt; cc'd the kvmarm list.

Thanks Peter for throwing us under the big-little bus! ;-)

&gt; 
&gt; On Mon, 13 Dec 2021 at 15:02, Qu Wenruo &lt;quwenruo.btrfs@gmx.com&gt; wrote:
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; On 2021/12/13 21:17, Michal Prívozník wrote:
&gt; &gt; &gt; On 12/11/21 02:58, Qu Wenruo wrote:
&gt; &gt; &gt;&gt; Hi,
&gt; &gt; &gt;&gt;
&gt; &gt; &gt;&gt; Recently I got my libvirt setup on both RK3399 (RockPro64) and RPI CM4,
&gt; &gt; &gt;&gt; with upstream kernels.
&gt; &gt; &gt;&gt;
&gt; &gt; &gt;&gt; For RPI CM4 its mostly smooth sail, but on RK3399 due to its little.BIG
&gt; &gt; &gt;&gt; setup (core 0-3 are 4x A55 cores, and core 4-5 are 2x A72 cores), it
&gt; &gt; &gt;&gt; brings quite some troubles for VMs.
&gt; &gt; &gt;&gt;
&gt; &gt; &gt;&gt; In short, without proper cpuset to bind the VM to either all A72 cores
&gt; &gt; &gt;&gt; or all A55 cores, the VM will mostly fail to boot.

s/A55/A53/. There were thankfully no A72+A55 ever produced (just the
though of it makes me sick).

&gt; &gt; &gt;&gt;
&gt; &gt; &gt;&gt; Currently the working xml is:
&gt; &gt; &gt;&gt;
&gt; &gt; &gt;&gt;    &lt;vcpu placement='static' cpuset='4-5'&gt;2&lt;/vcpu&gt;
&gt; &gt; &gt;&gt;    &lt;cpu mode='host-passthrough' check='none'/&gt;
&gt; &gt; &gt;&gt;
&gt; &gt; &gt;&gt; But even with vcpupin, pinning each vcpu to each physical core, VM will
&gt; &gt; &gt;&gt; mostly fail to start up due to vcpu initialization failed with -EINVAL.

Disclaimer: I know nothing about libvirt (and no, I don't want to
know! ;-).

However, for things to be reliable, you need to taskset the whole QEMU
process to the CPU type you intend to use. That's because, AFAICT,
QEMU will snapshot the system registers outside of the vcpu threads,
and attempt to use the result to configure the actual vcpu threads. If
they happen to run on different CPU types, the sysregs will differ in
incompatible ways and an error will be returned. This may or may not
be a bug, I don't know (I see it as a feature).

If you are annoyed with this behaviour, you can always use a different
VMM that won't care about such difference (crosvm or kvmtool, to name
a few). However, the guest will be able to observe the migration from
one cpu type to another. This may or may not affect your guest's
behaviour.

I personally find the QEMU behaviour reasonable. KVM/arm64 make little
effort to support BL virtualisation as design choice (I value my
sanity), and userspace is still in control of the placement.

&gt; &gt; &gt;&gt; This brings a problem, in theory RK3399 SoC should out-perform BCM2711
&gt; &gt; &gt;&gt; in multi-core performance, but if a VM can only be bind to either A72 or
&gt; &gt; &gt;&gt; A55 cores, then the performance is no longer competitive against
&gt; &gt; &gt;&gt; BCM2711, wasting the PCIE 2.0 x4 capacity.

Vote with your money. If you too think that BL systems are utter crap,
do not buy them! Or treat them as 'two systems in one', which is what
I do. From that angle, this is of great value! ;-)

&gt; &gt; &gt;&gt; I guess with projects like Asahi Linux making progress, there will be
&gt; &gt; &gt;&gt; more and more such problems.

Well, not more than any other big-little system. They suffer from
similar issues, plus those resulting from not fully implementing the
ARM architecture. They are however more consistent in their feature
set than the ARM implementations ever were.

&gt; &gt; &gt;&gt;
&gt; &gt; &gt;&gt; Any clue on how to properly pass all physical CPU cores to VM for
&gt; &gt; &gt;&gt; little.BIG setup?
&gt; &gt; &gt;&gt;
&gt; &gt; &gt;
&gt; &gt; &gt; I have never met big.LITTLE but my understanding was that those big
&gt; &gt; &gt; cores are compatible with little ones and the only difference is that
&gt; &gt; &gt; the big ones are shut off if there's no demand (to save energy) leaving
&gt; &gt; &gt; only the little ones running.

No. They are all notionally running. It is the scheduler that places
tasks (such as a vcpu) on a 'convenient' core, where 'convenient'
depends on the scheduling policy.

HTH,

	M.

-- 
Without deviation from the norm, progress is not possible.


</body></email><email><emailId>20211214004101</emailId><senderName>Qu Wenruo</senderName><senderEmail>quwenruo.btrfs@gmx.com</senderEmail><timestampReceived>2021-12-14 00:41:01-0400</timestampReceived><subject>Re: Libvirt on little.BIG ARM systems unable to start guest if no cpuset is provided</subject><body>



On 2021/12/14 00:49, Marc Zyngier wrote:
&gt; On Mon, 13 Dec 2021 16:06:14 +0000,
&gt; Peter Maydell &lt;peter.maydell@linaro.org&gt; wrote:
&gt;&gt;
&gt;&gt; KVM on big.little setups is a kernel-level question really; I've
&gt;&gt; cc'd the kvmarm list.
&gt;
&gt; Thanks Peter for throwing us under the big-little bus! ;-)
&gt;
&gt;&gt;
&gt;&gt; On Mon, 13 Dec 2021 at 15:02, Qu Wenruo &lt;quwenruo.btrfs@gmx.com&gt; wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; On 2021/12/13 21:17, Michal Prívozník wrote:
&gt;&gt;&gt;&gt; On 12/11/21 02:58, Qu Wenruo wrote:
&gt;&gt;&gt;&gt;&gt; Hi,
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Recently I got my libvirt setup on both RK3399 (RockPro64) and RPI CM4,
&gt;&gt;&gt;&gt;&gt; with upstream kernels.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; For RPI CM4 its mostly smooth sail, but on RK3399 due to its little.BIG
&gt;&gt;&gt;&gt;&gt; setup (core 0-3 are 4x A55 cores, and core 4-5 are 2x A72 cores), it
&gt;&gt;&gt;&gt;&gt; brings quite some troubles for VMs.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; In short, without proper cpuset to bind the VM to either all A72 cores
&gt;&gt;&gt;&gt;&gt; or all A55 cores, the VM will mostly fail to boot.
&gt;
&gt; s/A55/A53/. There were thankfully no A72+A55 ever produced (just the
&gt; though of it makes me sick).
&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Currently the working xml is:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;vcpu placement='static' cpuset='4-5'&gt;2&lt;/vcpu&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;cpu mode='host-passthrough' check='none'/&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; But even with vcpupin, pinning each vcpu to each physical core, VM will
&gt;&gt;&gt;&gt;&gt; mostly fail to start up due to vcpu initialization failed with -EINVAL.
&gt;
&gt; Disclaimer: I know nothing about libvirt (and no, I don't want to
&gt; know! ;-).
&gt;
&gt; However, for things to be reliable, you need to taskset the whole QEMU
&gt; process to the CPU type you intend to use.

Yep, that's what I'm doing.

&gt; That's because, AFAICT,
&gt; QEMU will snapshot the system registers outside of the vcpu threads,
&gt; and attempt to use the result to configure the actual vcpu threads. If
&gt; they happen to run on different CPU types, the sysregs will differ in
&gt; incompatible ways and an error will be returned. This may or may not
&gt; be a bug, I don't know (I see it as a feature).

Then this brings another question.

If we can pin each vCPU to each physical core (both little and big),
then as long as the registers are per-vCPU based, it should be able to
pass both big and little cores to the VM.

Yeah, I totally understand this screw up the scheduling, but that's at
least what (some insane) users want (just like me).

&gt;
&gt; If you are annoyed with this behaviour, you can always use a different
&gt; VMM that won't care about such difference (crosvm or kvmtool, to name
&gt; a few).

Sounds pretty interesting, a new world but without libvirt...

&gt; However, the guest will be able to observe the migration from
&gt; one cpu type to another. This may or may not affect your guest's
&gt; behaviour.

Not sure if it's possible to pin each vCPU thread to each core, but let
me try.

&gt;
&gt; I personally find the QEMU behaviour reasonable. KVM/arm64 make little
&gt; effort to support BL virtualisation as design choice (I value my
&gt; sanity), and userspace is still in control of the placement.
&gt;
&gt;&gt;&gt;&gt;&gt; This brings a problem, in theory RK3399 SoC should out-perform BCM2711
&gt;&gt;&gt;&gt;&gt; in multi-core performance, but if a VM can only be bind to either A72 or
&gt;&gt;&gt;&gt;&gt; A55 cores, then the performance is no longer competitive against
&gt;&gt;&gt;&gt;&gt; BCM2711, wasting the PCIE 2.0 x4 capacity.
&gt;
&gt; Vote with your money. If you too think that BL systems are utter crap,
&gt; do not buy them! Or treat them as 'two systems in one', which is what
&gt; I do. From that angle, this is of great value! ;-)

I guess I'm setting my expectation too high for rk3399, just seeing its
multi-thread perf beating RPI4 and has better IO doesn't mean it's a
perfect fit for VM.

Hopes rk3588 could change it.

For now I guess overclocking the big core to 2.2G is what I can do to
grab more performance from the board.

Thanks for your detailed reason and new advices!
Qu

&gt;
&gt;&gt;&gt;&gt;&gt; I guess with projects like Asahi Linux making progress, there will be
&gt;&gt;&gt;&gt;&gt; more and more such problems.
&gt;
&gt; Well, not more than any other big-little system. They suffer from
&gt; similar issues, plus those resulting from not fully implementing the
&gt; ARM architecture. They are however more consistent in their feature
&gt; set than the ARM implementations ever were.
&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Any clue on how to properly pass all physical CPU cores to VM for
&gt;&gt;&gt;&gt;&gt; little.BIG setup?
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; I have never met big.LITTLE but my understanding was that those big
&gt;&gt;&gt;&gt; cores are compatible with little ones and the only difference is that
&gt;&gt;&gt;&gt; the big ones are shut off if there's no demand (to save energy) leaving
&gt;&gt;&gt;&gt; only the little ones running.
&gt;
&gt; No. They are all notionally running. It is the scheduler that places
&gt; tasks (such as a vcpu) on a 'convenient' core, where 'convenient'
&gt; depends on the scheduling policy.
&gt;
&gt; HTH,
&gt;
&gt; 	M.
&gt;


</body></email><email><emailId>20211214075329</emailId><senderName>Michal PrÃ­voznÃ­k</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-12-14 07:53:29-0400</timestampReceived><subject>Re: Libvirt on little.BIG ARM systems unable to start guest if no cpuset is provided</subject><body>

On 12/14/21 01:41, Qu Wenruo wrote:
&gt; 
&gt; 
&gt; On 2021/12/14 00:49, Marc Zyngier wrote:
&gt;&gt; On Mon, 13 Dec 2021 16:06:14 +0000,
&gt;&gt; Peter Maydell &lt;peter.maydell@linaro.org&gt; wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; KVM on big.little setups is a kernel-level question really; I've
&gt;&gt;&gt; cc'd the kvmarm list.
&gt;&gt;
&gt;&gt; Thanks Peter for throwing us under the big-little bus! ;-)
&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; On Mon, 13 Dec 2021 at 15:02, Qu Wenruo &lt;quwenruo.btrfs@gmx.com&gt; wrote:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; On 2021/12/13 21:17, Michal Prívozník wrote:
&gt;&gt;&gt;&gt;&gt; On 12/11/21 02:58, Qu Wenruo wrote:
&gt;&gt;&gt;&gt;&gt;&gt; Hi,
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Recently I got my libvirt setup on both RK3399 (RockPro64) and RPI
&gt;&gt;&gt;&gt;&gt;&gt; CM4,
&gt;&gt;&gt;&gt;&gt;&gt; with upstream kernels.
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; For RPI CM4 its mostly smooth sail, but on RK3399 due to its
&gt;&gt;&gt;&gt;&gt;&gt; little.BIG
&gt;&gt;&gt;&gt;&gt;&gt; setup (core 0-3 are 4x A55 cores, and core 4-5 are 2x A72 cores), it
&gt;&gt;&gt;&gt;&gt;&gt; brings quite some troubles for VMs.
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; In short, without proper cpuset to bind the VM to either all A72
&gt;&gt;&gt;&gt;&gt;&gt; cores
&gt;&gt;&gt;&gt;&gt;&gt; or all A55 cores, the VM will mostly fail to boot.
&gt;&gt;
&gt;&gt; s/A55/A53/. There were thankfully no A72+A55 ever produced (just the
&gt;&gt; though of it makes me sick).
&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Currently the working xml is:
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;     &lt;vcpu placement='static' cpuset='4-5'&gt;2&lt;/vcpu&gt;
&gt;&gt;&gt;&gt;&gt;&gt;     &lt;cpu mode='host-passthrough' check='none'/&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; But even with vcpupin, pinning each vcpu to each physical core, VM
&gt;&gt;&gt;&gt;&gt;&gt; will
&gt;&gt;&gt;&gt;&gt;&gt; mostly fail to start up due to vcpu initialization failed with
&gt;&gt;&gt;&gt;&gt;&gt; -EINVAL.
&gt;&gt;
&gt;&gt; Disclaimer: I know nothing about libvirt (and no, I don't want to
&gt;&gt; know! ;-).
&gt;&gt;
&gt;&gt; However, for things to be reliable, you need to taskset the whole QEMU
&gt;&gt; process to the CPU type you intend to use.
&gt; 
&gt; Yep, that's what I'm doing.
&gt; 
&gt;&gt; That's because, AFAICT,
&gt;&gt; QEMU will snapshot the system registers outside of the vcpu threads,
&gt;&gt; and attempt to use the result to configure the actual vcpu threads. If
&gt;&gt; they happen to run on different CPU types, the sysregs will differ in
&gt;&gt; incompatible ways and an error will be returned. This may or may not
&gt;&gt; be a bug, I don't know (I see it as a feature).
&gt; 
&gt; Then this brings another question.
&gt; 
&gt; If we can pin each vCPU to each physical core (both little and big),
&gt; then as long as the registers are per-vCPU based, it should be able to
&gt; pass both big and little cores to the VM.
&gt; 
&gt; Yeah, I totally understand this screw up the scheduling, but that's at
&gt; least what (some insane) users want (just like me).
&gt; 
&gt;&gt;
&gt;&gt; If you are annoyed with this behaviour, you can always use a different
&gt;&gt; VMM that won't care about such difference (crosvm or kvmtool, to name
&gt;&gt; a few).
&gt; 
&gt; Sounds pretty interesting, a new world but without libvirt...
&gt; 
&gt;&gt; However, the guest will be able to observe the migration from
&gt;&gt; one cpu type to another. This may or may not affect your guest's
&gt;&gt; behaviour.
&gt; 
&gt; Not sure if it's possible to pin each vCPU thread to each core, but let
&gt; me try.
&gt; 

Sure it is, for instance:

&lt;cputune&gt;
    &lt;vcpupin vcpu="0" cpuset="1-4,^2"/&gt;
    &lt;vcpupin vcpu="1" cpuset="0,1"/&gt;
    &lt;vcpupin vcpu="2" cpuset="2,3"/&gt;
    &lt;vcpupin vcpu="3" cpuset="0,4"/&gt;
    &lt;emulatorpin cpuset="1-3"/&gt;
    &lt;iothreadpin iothread="1" cpuset="5,6"/&gt;
    &lt;iothreadpin iothread="2" cpuset="7,8"/&gt;
&lt;/cputune&gt;

pins vCPU#0 onto host CPUs 1-4, excluding 2; vCPU#1 onto host CPUs 0-1
and so on. You can also pin emulator (QEMU) and its iothreads. It's
documented here:

https://libvirt.org/formatdomain.html#cpu-tuning

Michal

</body></email><email><emailId>20211214075817</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-12-14 07:58:17-0400</timestampReceived><subject>Re: Libvirt on little.BIG ARM systems unable to start guest if no cpuset is provided</subject><body>

On 12/13/21 17:49, Marc Zyngier wrote:
&gt; On Mon, 13 Dec 2021 16:06:14 +0000,
&gt; Peter Maydell &lt;peter.maydell@linaro.org&gt; wrote:
&gt;&gt;
&gt;&gt; KVM on big.little setups is a kernel-level question really; I've
&gt;&gt; cc'd the kvmarm list.
&gt; 
&gt; Thanks Peter for throwing us under the big-little bus! ;-)
&gt; 
&gt;&gt;
&gt;&gt; On Mon, 13 Dec 2021 at 15:02, Qu Wenruo &lt;quwenruo.btrfs@gmx.com&gt; wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; On 2021/12/13 21:17, Michal Prívozník wrote:
&gt;&gt;&gt;&gt; On 12/11/21 02:58, Qu Wenruo wrote:
&gt;&gt;&gt;&gt;&gt; Hi,
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Recently I got my libvirt setup on both RK3399 (RockPro64) and RPI CM4,
&gt;&gt;&gt;&gt;&gt; with upstream kernels.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; For RPI CM4 its mostly smooth sail, but on RK3399 due to its little.BIG
&gt;&gt;&gt;&gt;&gt; setup (core 0-3 are 4x A55 cores, and core 4-5 are 2x A72 cores), it
&gt;&gt;&gt;&gt;&gt; brings quite some troubles for VMs.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; In short, without proper cpuset to bind the VM to either all A72 cores
&gt;&gt;&gt;&gt;&gt; or all A55 cores, the VM will mostly fail to boot.
&gt; 
&gt; s/A55/A53/. There were thankfully no A72+A55 ever produced (just the
&gt; though of it makes me sick).
&gt; 
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Currently the working xml is:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;    &lt;vcpu placement='static' cpuset='4-5'&gt;2&lt;/vcpu&gt;
&gt;&gt;&gt;&gt;&gt;    &lt;cpu mode='host-passthrough' check='none'/&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; But even with vcpupin, pinning each vcpu to each physical core, VM will
&gt;&gt;&gt;&gt;&gt; mostly fail to start up due to vcpu initialization failed with -EINVAL.
&gt; 
&gt; Disclaimer: I know nothing about libvirt (and no, I don't want to
&gt; know! ;-).
&gt; 
&gt; However, for things to be reliable, you need to taskset the whole QEMU
&gt; process to the CPU type you intend to use. That's because, AFAICT,
&gt; QEMU will snapshot the system registers outside of the vcpu threads,
&gt; and attempt to use the result to configure the actual vcpu threads. If
&gt; they happen to run on different CPU types, the sysregs will differ in
&gt; incompatible ways and an error will be returned. This may or may not
&gt; be a bug, I don't know (I see it as a feature).
&gt; 

Oh, I had no idea that QEMU does this. Anyway, QEMU spawns a thread for
each vCPU which is perfect, because then libvirt can use CGroups to
restrict each vCPU individually onto a subset of physical CPU(s). And in
fact, libvirt has this feature for many years. I always viewed it as a
performance tuning, but TIL.

Michal

</body></email><email><emailId>20211214081640</emailId><senderName>Qu Wenruo</senderName><senderEmail>quwenruo.btrfs@gmx.com</senderEmail><timestampReceived>2021-12-14 08:16:40-0400</timestampReceived><subject>Re: Libvirt on little.BIG ARM systems unable to start guest if no cpuset is provided</subject><body>



On 2021/12/14 15:53, Michal Prívozník wrote:
&gt; On 12/14/21 01:41, Qu Wenruo wrote:
&gt;&gt;
&gt;&gt;
&gt;&gt; On 2021/12/14 00:49, Marc Zyngier wrote:
&gt;&gt;&gt; On Mon, 13 Dec 2021 16:06:14 +0000,
&gt;&gt;&gt; Peter Maydell &lt;peter.maydell@linaro.org&gt; wrote:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; KVM on big.little setups is a kernel-level question really; I've
&gt;&gt;&gt;&gt; cc'd the kvmarm list.
&gt;&gt;&gt;
&gt;&gt;&gt; Thanks Peter for throwing us under the big-little bus! ;-)
&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; On Mon, 13 Dec 2021 at 15:02, Qu Wenruo &lt;quwenruo.btrfs@gmx.com&gt; wrote:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; On 2021/12/13 21:17, Michal Prívozník wrote:
&gt;&gt;&gt;&gt;&gt;&gt; On 12/11/21 02:58, Qu Wenruo wrote:
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Hi,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Recently I got my libvirt setup on both RK3399 (RockPro64) and RPI
&gt;&gt;&gt;&gt;&gt;&gt;&gt; CM4,
&gt;&gt;&gt;&gt;&gt;&gt;&gt; with upstream kernels.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; For RPI CM4 its mostly smooth sail, but on RK3399 due to its
&gt;&gt;&gt;&gt;&gt;&gt;&gt; little.BIG
&gt;&gt;&gt;&gt;&gt;&gt;&gt; setup (core 0-3 are 4x A55 cores, and core 4-5 are 2x A72 cores), it
&gt;&gt;&gt;&gt;&gt;&gt;&gt; brings quite some troubles for VMs.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; In short, without proper cpuset to bind the VM to either all A72
&gt;&gt;&gt;&gt;&gt;&gt;&gt; cores
&gt;&gt;&gt;&gt;&gt;&gt;&gt; or all A55 cores, the VM will mostly fail to boot.
&gt;&gt;&gt;
&gt;&gt;&gt; s/A55/A53/. There were thankfully no A72+A55 ever produced (just the
&gt;&gt;&gt; though of it makes me sick).
&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Currently the working xml is:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;      &lt;vcpu placement='static' cpuset='4-5'&gt;2&lt;/vcpu&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;      &lt;cpu mode='host-passthrough' check='none'/&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; But even with vcpupin, pinning each vcpu to each physical core, VM
&gt;&gt;&gt;&gt;&gt;&gt;&gt; will
&gt;&gt;&gt;&gt;&gt;&gt;&gt; mostly fail to start up due to vcpu initialization failed with
&gt;&gt;&gt;&gt;&gt;&gt;&gt; -EINVAL.
&gt;&gt;&gt;
&gt;&gt;&gt; Disclaimer: I know nothing about libvirt (and no, I don't want to
&gt;&gt;&gt; know! ;-).
&gt;&gt;&gt;
&gt;&gt;&gt; However, for things to be reliable, you need to taskset the whole QEMU
&gt;&gt;&gt; process to the CPU type you intend to use.
&gt;&gt;
&gt;&gt; Yep, that's what I'm doing.
&gt;&gt;
&gt;&gt;&gt; That's because, AFAICT,
&gt;&gt;&gt; QEMU will snapshot the system registers outside of the vcpu threads,
&gt;&gt;&gt; and attempt to use the result to configure the actual vcpu threads. If
&gt;&gt;&gt; they happen to run on different CPU types, the sysregs will differ in
&gt;&gt;&gt; incompatible ways and an error will be returned. This may or may not
&gt;&gt;&gt; be a bug, I don't know (I see it as a feature).
&gt;&gt;
&gt;&gt; Then this brings another question.
&gt;&gt;
&gt;&gt; If we can pin each vCPU to each physical core (both little and big),
&gt;&gt; then as long as the registers are per-vCPU based, it should be able to
&gt;&gt; pass both big and little cores to the VM.
&gt;&gt;
&gt;&gt; Yeah, I totally understand this screw up the scheduling, but that's at
&gt;&gt; least what (some insane) users want (just like me).
&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; If you are annoyed with this behaviour, you can always use a different
&gt;&gt;&gt; VMM that won't care about such difference (crosvm or kvmtool, to name
&gt;&gt;&gt; a few).
&gt;&gt;
&gt;&gt; Sounds pretty interesting, a new world but without libvirt...
&gt;&gt;
&gt;&gt;&gt; However, the guest will be able to observe the migration from
&gt;&gt;&gt; one cpu type to another. This may or may not affect your guest's
&gt;&gt;&gt; behaviour.
&gt;&gt;
&gt;&gt; Not sure if it's possible to pin each vCPU thread to each core, but let
&gt;&gt; me try.
&gt;&gt;
&gt;
&gt; Sure it is, for instance:
&gt;
&gt; &lt;cputune&gt;
&gt;      &lt;vcpupin vcpu="0" cpuset="1-4,^2"/&gt;
&gt;      &lt;vcpupin vcpu="1" cpuset="0,1"/&gt;
&gt;      &lt;vcpupin vcpu="2" cpuset="2,3"/&gt;
&gt;      &lt;vcpupin vcpu="3" cpuset="0,4"/&gt;
&gt;      &lt;emulatorpin cpuset="1-3"/&gt;
&gt;      &lt;iothreadpin iothread="1" cpuset="5,6"/&gt;
&gt;      &lt;iothreadpin iothread="2" cpuset="7,8"/&gt;
&gt; &lt;/cputune&gt;

That's what I have already tried before.
I pinned vcpu 0-6 to physical core 0-6, and still no reliable boot up.

And that's why I'm asking here.

Thanks,
Qu

&gt;
&gt; pins vCPU#0 onto host CPUs 1-4, excluding 2; vCPU#1 onto host CPUs 0-1
&gt; and so on. You can also pin emulator (QEMU) and its iothreads. It's
&gt; documented here:
&gt;
&gt; https://libvirt.org/formatdomain.html#cpu-tuning
&gt;
&gt; Michal
&gt;


</body></email><email><emailId>20211214093418</emailId><senderName>Marc Zyngier</senderName><senderEmail>maz@kernel.org</senderEmail><timestampReceived>2021-12-14 09:34:18-0400</timestampReceived><subject>Re: Libvirt on little.BIG ARM systems unable to start guest if no cpuset is provided</subject><body>

On Tue, 14 Dec 2021 00:41:01 +0000,
Qu Wenruo &lt;quwenruo.btrfs@gmx.com&gt; wrote:
&gt; 
&gt; 
&gt; 
&gt; On 2021/12/14 00:49, Marc Zyngier wrote:
&gt; &gt; On Mon, 13 Dec 2021 16:06:14 +0000,
&gt; &gt; Peter Maydell &lt;peter.maydell@linaro.org&gt; wrote:
&gt; &gt;&gt; 
&gt; &gt;&gt; KVM on big.little setups is a kernel-level question really; I've
&gt; &gt;&gt; cc'd the kvmarm list.
&gt; &gt; 
&gt; &gt; Thanks Peter for throwing us under the big-little bus! ;-)
&gt; &gt; 
&gt; &gt;&gt; 
&gt; &gt;&gt; On Mon, 13 Dec 2021 at 15:02, Qu Wenruo &lt;quwenruo.btrfs@gmx.com&gt; wrote:
&gt; &gt;&gt;&gt; 
&gt; &gt;&gt;&gt; 
&gt; &gt;&gt;&gt; 
&gt; &gt;&gt;&gt; On 2021/12/13 21:17, Michal Prívozník wrote:
&gt; &gt;&gt;&gt;&gt; On 12/11/21 02:58, Qu Wenruo wrote:
&gt; &gt;&gt;&gt;&gt;&gt; Hi,
&gt; &gt;&gt;&gt;&gt;&gt; 
&gt; &gt;&gt;&gt;&gt;&gt; Recently I got my libvirt setup on both RK3399 (RockPro64) and RPI CM4,
&gt; &gt;&gt;&gt;&gt;&gt; with upstream kernels.
&gt; &gt;&gt;&gt;&gt;&gt; 
&gt; &gt;&gt;&gt;&gt;&gt; For RPI CM4 its mostly smooth sail, but on RK3399 due to its little.BIG
&gt; &gt;&gt;&gt;&gt;&gt; setup (core 0-3 are 4x A55 cores, and core 4-5 are 2x A72 cores), it
&gt; &gt;&gt;&gt;&gt;&gt; brings quite some troubles for VMs.
&gt; &gt;&gt;&gt;&gt;&gt; 
&gt; &gt;&gt;&gt;&gt;&gt; In short, without proper cpuset to bind the VM to either all A72 cores
&gt; &gt;&gt;&gt;&gt;&gt; or all A55 cores, the VM will mostly fail to boot.
&gt; &gt; 
&gt; &gt; s/A55/A53/. There were thankfully no A72+A55 ever produced (just the
&gt; &gt; though of it makes me sick).
&gt; &gt; 
&gt; &gt;&gt;&gt;&gt;&gt; 
&gt; &gt;&gt;&gt;&gt;&gt; Currently the working xml is:
&gt; &gt;&gt;&gt;&gt;&gt; 
&gt; &gt;&gt;&gt;&gt;&gt;     &lt;vcpu placement='static' cpuset='4-5'&gt;2&lt;/vcpu&gt;
&gt; &gt;&gt;&gt;&gt;&gt;     &lt;cpu mode='host-passthrough' check='none'/&gt;
&gt; &gt;&gt;&gt;&gt;&gt; 
&gt; &gt;&gt;&gt;&gt;&gt; But even with vcpupin, pinning each vcpu to each physical core, VM will
&gt; &gt;&gt;&gt;&gt;&gt; mostly fail to start up due to vcpu initialization failed with -EINVAL.
&gt; &gt; 
&gt; &gt; Disclaimer: I know nothing about libvirt (and no, I don't want to
&gt; &gt; know! ;-).
&gt; &gt; 
&gt; &gt; However, for things to be reliable, you need to taskset the whole QEMU
&gt; &gt; process to the CPU type you intend to use.
&gt; 
&gt; Yep, that's what I'm doing.

Are you sure? The xml directive above seem to only apply to the vcpus,
and no other QEMU thread.

&gt; &gt; That's because, AFAICT,
&gt; &gt; QEMU will snapshot the system registers outside of the vcpu threads,
&gt; &gt; and attempt to use the result to configure the actual vcpu threads. If
&gt; &gt; they happen to run on different CPU types, the sysregs will differ in
&gt; &gt; incompatible ways and an error will be returned. This may or may not
&gt; &gt; be a bug, I don't know (I see it as a feature).
&gt; 
&gt; Then this brings another question.
&gt; 
&gt; If we can pin each vCPU to each physical core (both little and big),
&gt; then as long as the registers are per-vCPU based, it should be able to
&gt; pass both big and little cores to the VM.

Absolutely. But that's not how QEMU works. It assumes that it can
restore the *same* registers to all the vcpus. Which of course doesn't
work (we don't allow you to change MIDR_EL1, for a start).

&gt; Yeah, I totally understand this screw up the scheduling, but that's at
&gt; least what (some insane) users want (just like me).

That's fine, we all have our own use cases.

&gt; 
&gt; &gt; 
&gt; &gt; If you are annoyed with this behaviour, you can always use a different
&gt; &gt; VMM that won't care about such difference (crosvm or kvmtool, to name
&gt; &gt; a few).
&gt; 
&gt; Sounds pretty interesting, a new world but without libvirt...
&gt;
&gt; &gt; However, the guest will be able to observe the migration from
&gt; &gt; one cpu type to another. This may or may not affect your guest's
&gt; &gt; behaviour.
&gt; 
&gt; Not sure if it's possible to pin each vCPU thread to each core, but let
&gt; me try.

Again: the problem isn't the vcpu threads, but the dummy VM that QEMU
creates to snapshot the vcpu registers.

&gt; &gt; I personally find the QEMU behaviour reasonable. KVM/arm64 make little
&gt; &gt; effort to support BL virtualisation as design choice (I value my
&gt; &gt; sanity), and userspace is still in control of the placement.
&gt; &gt; 
&gt; &gt;&gt;&gt;&gt;&gt; This brings a problem, in theory RK3399 SoC should out-perform BCM2711
&gt; &gt;&gt;&gt;&gt;&gt; in multi-core performance, but if a VM can only be bind to either A72 or
&gt; &gt;&gt;&gt;&gt;&gt; A55 cores, then the performance is no longer competitive against
&gt; &gt;&gt;&gt;&gt;&gt; BCM2711, wasting the PCIE 2.0 x4 capacity.
&gt; &gt; 
&gt; &gt; Vote with your money. If you too think that BL systems are utter crap,
&gt; &gt; do not buy them! Or treat them as 'two systems in one', which is what
&gt; &gt; I do. From that angle, this is of great value! ;-)
&gt; 
&gt; I guess I'm setting my expectation too high for rk3399, just seeing its
&gt; multi-thread perf beating RPI4 and has better IO doesn't mean it's a
&gt; perfect fit for VM.

I find my own rk3399 perfectly adequate with QEMU.

HTH,

	M.

-- 
Without deviation from the norm, progress is not possible.


</body></email><email><emailId>20211210112829</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-12-10 11:28:29-0400</timestampReceived><subject>Re: Libgfapi gone too?</subject><body>

On Fri, Dec 10, 2021 at 11:18:16AM +0000, lejeczek wrote:
&gt; 
&gt; 
&gt; On 10/12/2021 11:08, Daniel P. Berrangé wrote:
&gt; &gt; On Thu, Dec 09, 2021 at 08:45:52PM +0000, lejeczek wrote:
&gt; &gt; &gt; Hi guys.
&gt; &gt; &gt; 
&gt; &gt; &gt; Is glusterFS/libgfapi support removed (permanently) too? In CentOS 9 Stream.
&gt; &gt; Correct, the in-QEMU glusterfs client has been removed from builds
&gt; &gt; of the qemu-kvm RPM in CentOS-9 / RHEL-9.
&gt; &gt; 
&gt; &gt; If storing VM disk on gluster you will have to resort to using the
&gt; &gt; in-kernel glusterfs client to mount the disks locally, whereupon
&gt; &gt; QEMU can access them as plain files
&gt; &gt; 
&gt; &gt; 
&gt; &gt; 
&gt; Guys, @redhat and all the others responsible - Official (but also blogs,
&gt; changelogs, man pages, etc) docs have begun to form -
&gt; https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9-beta
&gt; Please put all those _critical_ changes everywhere and admin might go first
&gt; to read for what's new &amp; different, make it underscored + in-bold I'd
&gt; suggest.

I would ultimately expect this kind of thing to be documented in the
release notes, under some kind of heading like "incompatible changes"
or similar.  We're only at 9.0-beta though, so docs are not all
fully fleshed out yet.


Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20211210131322</emailId><senderName>Andrea Bolognani</senderName><senderEmail>abologna@redhat.com</senderEmail><timestampReceived>2021-12-10 13:13:22-0400</timestampReceived><subject>Re: Libgfapi gone too?</subject><body>

On Fri, Dec 10, 2021 at 11:28:29AM +0000, Daniel P. Berrangé wrote:
&gt; On Fri, Dec 10, 2021 at 11:18:16AM +0000, lejeczek wrote:
&gt; &gt; Guys, @redhat and all the others responsible - Official (but also blogs,
&gt; &gt; changelogs, man pages, etc) docs have begun to form -
&gt; &gt; https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9-beta
&gt; &gt; Please put all those _critical_ changes everywhere and admin might go first
&gt; &gt; to read for what's new &amp; different, make it underscored + in-bold I'd
&gt; &gt; suggest.
&gt; 
&gt; I would ultimately expect this kind of thing to be documented in the
&gt; release notes, under some kind of heading like "incompatible changes"
&gt; or similar.  We're only at 9.0-beta though, so docs are not all
&gt; fully fleshed out yet.

The document you're looking for is

  https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9-beta/html-single/considerations_in_adopting_rhel_9/index


and the part specific to virtualization is

  https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9-beta/html-s \
ingle/considerations_in_adopting_rhel_9/index#ref_changes-to-virtualization_assembly_virtualization


The removal of SPICE is mentioned, but that of glusterfs isn't. If
you look at

  https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9-beta/html-s \
ingle/considerations_in_adopting_rhel_9/index#removed-packages_assembly_changes-to-packages


you'll see that the qemu-kvm-block-gluster and
libvirt-daemon-driver-storage-gluster packages have been dropped, but
it's questionable whether this is prominent enough for people to
actually notice.

-- 
Andrea Bolognani / Red Hat / Virtualization


</body></email><email><emailId>20211210142709</emailId><senderName>lejeczek</senderName><senderEmail>peljasz@yahoo.co.uk</senderEmail><timestampReceived>2021-12-10 14:27:09-0400</timestampReceived><subject>Re: Libgfapi gone too?</subject><body>



On 10/12/2021 13:13, Andrea Bolognani wrote:
&gt; On Fri, Dec 10, 2021 at 11:28:29AM +0000, Daniel P. Berrangé wrote:
&gt; &gt; On Fri, Dec 10, 2021 at 11:18:16AM +0000, lejeczek wrote:
&gt; &gt; &gt; Guys, @redhat and all the others responsible - Official (but also blogs,
&gt; &gt; &gt; changelogs, man pages, etc) docs have begun to form -
&gt; &gt; &gt; https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9-beta
&gt; &gt; &gt; Please put all those _critical_ changes everywhere and admin might go first
&gt; &gt; &gt; to read for what's new &amp; different, make it underscored + in-bold I'd
&gt; &gt; &gt; suggest.
&gt; &gt; I would ultimately expect this kind of thing to be documented in the
&gt; &gt; release notes, under some kind of heading like "incompatible changes"
&gt; &gt; or similar.  We're only at 9.0-beta though, so docs are not all
&gt; &gt; fully fleshed out yet.
&gt; The document you're looking for is
&gt; 
&gt; https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9-beta/html-single/considerations_in_adopting_rhel_9/index
&gt;  
&gt; and the part specific to virtualization is
&gt; 
&gt; https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9-beta/html-s \
&gt; ingle/considerations_in_adopting_rhel_9/index#ref_changes-to-virtualization_assembly_virtualization
&gt;  
&gt; The removal of SPICE is mentioned, but that of glusterfs isn't. If
&gt; you look at
&gt; 
&gt; https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9-beta/html-s \
&gt; ingle/considerations_in_adopting_rhel_9/index#removed-packages_assembly_changes-to-packages
&gt;  
&gt; you'll see that the qemu-kvm-block-gluster and
&gt; libvirt-daemon-driver-storage-gluster packages have been dropped, but
&gt; it's questionable whether this is prominent enough for people to
&gt; actually notice.
&gt; 
really??
That was one of the most useful &amp; practical bits - having 
libvirt&amp;qemu to make use of GlusterFS without having to 
"expose" GF volumes to the filesystem. (everybody who do 
virt+glusterfs I know, do have it that way)

thanks, L.


</body></email><email><emailId>20211210170355</emailId><senderName>Dmitry Melekhov</senderName><senderEmail>dm@belkam.com</senderEmail><timestampReceived>2021-12-10 17:03:55-0400</timestampReceived><subject>Re: Libgfapi gone too?</subject><body>


10.12.2021 18:27, lejeczek пишет:
&gt; really??
&gt; That was one of the most useful &amp; practical bits - having libvirt&amp;qemu 
&gt; to make use of GlusterFS without having to "expose" GF volumes to the 
&gt; filesystem. (everybody who do virt+glusterfs I know, do have it that way)
&gt;
&gt;
I guess this will be available only in RHEV :-)

or

in-kernel glusterfs client... what is it? I know only about fuse.




</body></email><email><emailId>20211210171000</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-12-10 17:10:00-0400</timestampReceived><subject>Re: Libgfapi gone too?</subject><body>

On Fri, Dec 10, 2021 at 09:03:55PM +0400, Dmitry Melekhov wrote:
&gt; 
&gt; 10.12.2021 18:27, lejeczek пишет:
&gt; &gt; really??
&gt; &gt; That was one of the most useful &amp; practical bits - having libvirt&amp;qemu
&gt; &gt; to make use of GlusterFS without having to "expose" GF volumes to the
&gt; &gt; filesystem. (everybody who do virt+glusterfs I know, do have it that
&gt; &gt; way)
&gt; &gt; 
&gt; &gt; 
&gt; I guess this will be available only in RHEV :-)

RHEV is based on RHEL-8, so changes in RHEL-9 don't impact it.

Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20211210171841</emailId><senderName>Dmitry Melekhov</senderName><senderEmail>dm@belkam.com</senderEmail><timestampReceived>2021-12-10 17:18:41-0400</timestampReceived><subject>Re: Libgfapi gone too?</subject><body>


10.12.2021 21:10, Daniel P. Berrangé пишет:
&gt; On Fri, Dec 10, 2021 at 09:03:55PM +0400, Dmitry Melekhov wrote:
&gt;&gt; 10.12.2021 18:27, lejeczek пишет:
&gt;&gt;&gt; really??
&gt;&gt;&gt; That was one of the most useful &amp; practical bits - having libvirt&amp;qemu
&gt;&gt;&gt; to make use of GlusterFS without having to "expose" GF volumes to the
&gt;&gt;&gt; filesystem. (everybody who do virt+glusterfs I know, do have it that
&gt;&gt;&gt; way)
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt; I guess this will be available only in RHEV :-)
&gt; RHEV is based on RHEL-8, so changes in RHEL-9 don't impact it.
&gt;
I'm sure next RHEV will be based on 9 :-)



</body></email><email><emailId>20211211224624</emailId><senderName>Nir Soffer</senderName><senderEmail>nsoffer@redhat.com</senderEmail><timestampReceived>2021-12-11 22:46:24-0400</timestampReceived><subject>Re: Libgfapi gone too?</subject><body>

On Fri, Dec 10, 2021 at 7:07 PM Dmitry Melekhov &lt;dm@belkam.com&gt; wrote:
&gt;
&gt;
&gt; 10.12.2021 18:27, lejeczek пишет:
&gt; &gt; really??
&gt; &gt; That was one of the most useful &amp; practical bits - having libvirt&amp;qemu
&gt; &gt; to make use of GlusterFS without having to "expose" GF volumes to the
&gt; &gt; filesystem. (everybody who do virt+glusterfs I know, do have it that way)
&gt; &gt;
&gt; &gt;
&gt; I guess this will be available only in RHEV :-)

Even in RHV (RHEV was renamed to RHV a few years ago) native Gluster
disk was never fully supported...

&gt;
&gt; or
&gt;
&gt; in-kernel glusterfs client... what is it? I know only about fuse.

... and fuse is the only fully supported way in RHV.

Nir


</body></email><email><emailId>20211211225128</emailId><senderName>Nir Soffer</senderName><senderEmail>nsoffer@redhat.com</senderEmail><timestampReceived>2021-12-11 22:51:28-0400</timestampReceived><subject>Re: Libgfapi gone too?</subject><body>

On Fri, Dec 10, 2021 at 7:18 PM Dmitry Melekhov &lt;dm@belkam.com&gt; wrote:
&gt;
&gt;
&gt; 10.12.2021 21:10, Daniel P. Berrangé пишет:
&gt; &gt; On Fri, Dec 10, 2021 at 09:03:55PM +0400, Dmitry Melekhov wrote:
&gt; &gt;&gt; 10.12.2021 18:27, lejeczek пишет:
&gt; &gt;&gt;&gt; really??
&gt; &gt;&gt;&gt; That was one of the most useful &amp; practical bits - having libvirt&amp;qemu
&gt; &gt;&gt;&gt; to make use of GlusterFS without having to "expose" GF volumes to the
&gt; &gt;&gt;&gt; filesystem. (everybody who do virt+glusterfs I know, do have it that
&gt; &gt;&gt;&gt; way)
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;
&gt; &gt;&gt; I guess this will be available only in RHEV :-)
&gt; &gt; RHEV is based on RHEL-8, so changes in RHEL-9 don't impact it.
&gt; &gt;
&gt; I'm sure next RHEV will be based on 9 :-)

There will be no RHV on RHEL 9, but we work on porting oVirt to Centos
Stream 9, so it should work on RHEL 9. Since native Gluster support was
removed in qemu and libvirt, oVirt will not be able to support it in 9.

You can ask on devel@ovirt.org if you need more info.

Nir


</body></email><email><emailId>20211211230710</emailId><senderName>Nir Soffer</senderName><senderEmail>nsoffer@redhat.com</senderEmail><timestampReceived>2021-12-11 23:07:10-0400</timestampReceived><subject>Re: Libgfapi gone too?</subject><body>

On Sun, Dec 12, 2021 at 12:51 AM Nir Soffer &lt;nsoffer@redhat.com&gt; wrote:
&gt;
&gt; On Fri, Dec 10, 2021 at 7:18 PM Dmitry Melekhov &lt;dm@belkam.com&gt; wrote:
&gt; &gt;
&gt; &gt;
&gt; &gt; 10.12.2021 21:10, Daniel P. Berrangé пишет:
&gt; &gt; &gt; On Fri, Dec 10, 2021 at 09:03:55PM +0400, Dmitry Melekhov wrote:
&gt; &gt; &gt;&gt; 10.12.2021 18:27, lejeczek пишет:
&gt; &gt; &gt;&gt;&gt; really??
&gt; &gt; &gt;&gt;&gt; That was one of the most useful &amp; practical bits - having libvirt&amp;qemu
&gt; &gt; &gt;&gt;&gt; to make use of GlusterFS without having to "expose" GF volumes to the
&gt; &gt; &gt;&gt;&gt; filesystem. (everybody who do virt+glusterfs I know, do have it that
&gt; &gt; &gt;&gt;&gt; way)
&gt; &gt; &gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;
&gt; &gt; &gt;&gt; I guess this will be available only in RHEV :-)
&gt; &gt; &gt; RHEV is based on RHEL-8, so changes in RHEL-9 don't impact it.
&gt; &gt; &gt;
&gt; &gt; I'm sure next RHEV will be based on 9 :-)
&gt;
&gt; There will be no RHV on RHEL 9, but we work on porting oVirt to Centos
&gt; Stream 9, so it should work on RHEL 9. Since native Gluster support was
&gt; removed in qemu and libvirt, oVirt will not be able to support it in 9.
&gt;
&gt; You can ask on devel@ovirt.org if you need more info.

Please see
https://access.redhat.com/support/policy/updates/rhev


</body></email><email><emailId>20211211015812</emailId><senderName>Qu Wenruo</senderName><senderEmail>quwenruo.btrfs@gmx.com</senderEmail><timestampReceived>2021-12-11 01:58:12-0400</timestampReceived><subject>Libvirt on little.BIG ARM systems unable to start guest if no cpuset is provided</subject><body>

Hi,

Recently I got my libvirt setup on both RK3399 (RockPro64) and RPI CM4,
with upstream kernels.

For RPI CM4 its mostly smooth sail, but on RK3399 due to its little.BIG
setup (core 0-3 are 4x A55 cores, and core 4-5 are 2x A72 cores), it
brings quite some troubles for VMs.

In short, without proper cpuset to bind the VM to either all A72 cores
or all A55 cores, the VM will mostly fail to boot.

Currently the working xml is:

   &lt;vcpu placement='static' cpuset='4-5'&gt;2&lt;/vcpu&gt;
   &lt;cpu mode='host-passthrough' check='none'/&gt;

But even with vcpupin, pinning each vcpu to each physical core, VM will
mostly fail to start up due to vcpu initialization failed with -EINVAL.


This brings a problem, in theory RK3399 SoC should out-perform BCM2711
in multi-core performance, but if a VM can only be bind to either A72 or
A55 cores, then the performance is no longer competitive against
BCM2711, wasting the PCIE 2.0 x4 capacity.

I guess with projects like Asahi Linux making progress, there will be
more and more such problems.

Any clue on how to properly pass all physical CPU cores to VM for
little.BIG setup?

Thanks,
Qu


</body></email><email><emailId>20211213131722</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-12-13 13:17:22-0400</timestampReceived><subject>Re: Libvirt on little.BIG ARM systems unable to start guest if no cpuset is provided</subject><body>

On 12/11/21 02:58, Qu Wenruo wrote:
&gt; Hi,
&gt; 
&gt; Recently I got my libvirt setup on both RK3399 (RockPro64) and RPI CM4,
&gt; with upstream kernels.
&gt; 
&gt; For RPI CM4 its mostly smooth sail, but on RK3399 due to its little.BIG
&gt; setup (core 0-3 are 4x A55 cores, and core 4-5 are 2x A72 cores), it
&gt; brings quite some troubles for VMs.
&gt; 
&gt; In short, without proper cpuset to bind the VM to either all A72 cores
&gt; or all A55 cores, the VM will mostly fail to boot.
&gt; 
&gt; Currently the working xml is:
&gt; 
&gt;   &lt;vcpu placement='static' cpuset='4-5'&gt;2&lt;/vcpu&gt;
&gt;   &lt;cpu mode='host-passthrough' check='none'/&gt;
&gt; 
&gt; But even with vcpupin, pinning each vcpu to each physical core, VM will
&gt; mostly fail to start up due to vcpu initialization failed with -EINVAL.
&gt; 
&gt; 
&gt; This brings a problem, in theory RK3399 SoC should out-perform BCM2711
&gt; in multi-core performance, but if a VM can only be bind to either A72 or
&gt; A55 cores, then the performance is no longer competitive against
&gt; BCM2711, wasting the PCIE 2.0 x4 capacity.
&gt; 
&gt; I guess with projects like Asahi Linux making progress, there will be
&gt; more and more such problems.
&gt; 
&gt; Any clue on how to properly pass all physical CPU cores to VM for
&gt; little.BIG setup?
&gt; 

I have never met big.LITTLE but my understanding was that those big
cores are compatible with little ones and the only difference is that
the big ones are shut off if there's no demand (to save energy) leaving
only the little ones running.

Anyway, this is likely too high level forum and I'd ask QEMU developers:

https://www.qemu.org/support/

Michal

</body></email><email><emailId>20211213140125</emailId><senderName>Qu Wenruo</senderName><senderEmail>quwenruo.btrfs@gmx.com</senderEmail><timestampReceived>2021-12-13 14:01:25-0400</timestampReceived><subject>Re: Libvirt on little.BIG ARM systems unable to start guest if no cpuset is provided</subject><body>



On 2021/12/13 21:17, Michal Prívozník wrote:
&gt; On 12/11/21 02:58, Qu Wenruo wrote:
&gt;&gt; Hi,
&gt;&gt;
&gt;&gt; Recently I got my libvirt setup on both RK3399 (RockPro64) and RPI CM4,
&gt;&gt; with upstream kernels.
&gt;&gt;
&gt;&gt; For RPI CM4 its mostly smooth sail, but on RK3399 due to its little.BIG
&gt;&gt; setup (core 0-3 are 4x A55 cores, and core 4-5 are 2x A72 cores), it
&gt;&gt; brings quite some troubles for VMs.
&gt;&gt;
&gt;&gt; In short, without proper cpuset to bind the VM to either all A72 cores
&gt;&gt; or all A55 cores, the VM will mostly fail to boot.
&gt;&gt;
&gt;&gt; Currently the working xml is:
&gt;&gt;
&gt;&gt;    &lt;vcpu placement='static' cpuset='4-5'&gt;2&lt;/vcpu&gt;
&gt;&gt;    &lt;cpu mode='host-passthrough' check='none'/&gt;
&gt;&gt;
&gt;&gt; But even with vcpupin, pinning each vcpu to each physical core, VM will
&gt;&gt; mostly fail to start up due to vcpu initialization failed with -EINVAL.
&gt;&gt;
&gt;&gt;
&gt;&gt; This brings a problem, in theory RK3399 SoC should out-perform BCM2711
&gt;&gt; in multi-core performance, but if a VM can only be bind to either A72 or
&gt;&gt; A55 cores, then the performance is no longer competitive against
&gt;&gt; BCM2711, wasting the PCIE 2.0 x4 capacity.
&gt;&gt;
&gt;&gt; I guess with projects like Asahi Linux making progress, there will be
&gt;&gt; more and more such problems.
&gt;&gt;
&gt;&gt; Any clue on how to properly pass all physical CPU cores to VM for
&gt;&gt; little.BIG setup?
&gt;&gt;
&gt;
&gt; I have never met big.LITTLE but my understanding was that those big
&gt; cores are compatible with little ones and the only difference is that
&gt; the big ones are shut off if there's no demand (to save energy) leaving
&gt; only the little ones running.

The big ones are not disabled AFAIK.

And even changing the CPU model to A53 (the little ones), it still fails
to boot, thus it looks like A72 is not really able to emulate A53 cores?

&gt;
&gt; Anyway, this is likely too high level forum and I'd ask QEMU developers:
&gt;
&gt; https://www.qemu.org/support/

That's indeed the case, adding qemu to the CC list.

And I found an existing bug report:
https://bugs.linaro.org/show_bug.cgi?id=1443

But I still didn't get the point why the 1:1 CPU-to-vcpu mapping still
doesn't work.

Thanks,
Qu

&gt;
&gt; Michal
&gt;


</body></email><email><emailId>20211212045445</emailId><senderName>Dmitry Melekhov</senderName><senderEmail>dm@belkam.com</senderEmail><timestampReceived>2021-12-12 04:54:45-0400</timestampReceived><subject>Re: Libgfapi gone too?</subject><body>


12.12.2021 02:51, Nir Soffer пишет:
&gt;
&gt; There will be no RHV on RHEL 9, but we work on porting oVirt to Centos
&gt; Stream 9, so it should work on RHEL 9. Since native Gluster support was
&gt; removed in qemu and libvirt, oVirt will not be able to support it in 9.


well, ok, thank you.

so, we need to move to somewhere else after end of 8 :-)

fuse is not an option...



</body></email><email><emailId>20211208110950</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-12-08 11:09:50-0400</timestampReceived><subject>Re: Qemu monitor info tlb gives unable to encode message payload</subject><body>

On Wed, Dec 08, 2021 at 10:30:27 +0000, Philipp Klocke wrote:
&gt; Hi,
&gt; 
&gt; the command
&gt; virsh qemu-monitor-command ubuntu_vm --hmp --cmd "info tlb"
&gt; fails with "error: Unable to encode message payload".
&gt; 
&gt; I found a bugtracker entry for a similiar error [1], but I don't if this is the \
&gt; same error (message too large). I also don't know how large an info tlb message is. \
&gt; Preferably I would not have to recompile libvirt just to issue this monitor \
&gt; command..

Libvirt unfortunately limits strings to 4MiB:

const REMOTE_STRING_MAX = 4194304;

And the reply from qemu-monitor-command is a single string. Now
internally we process JSON messages up to 10 MiB so one could argue that
we should increase the size for the 'qemu-monitor-command' reply up to
10MiB. This could be straightforward but it's questionable whether it's
worth it.

&gt; Then I thought about circumventing the error by connecting directly to the qemu \
&gt; monitor via netcat, but I found a thread [2] that says I cannot add my own \
&gt; "-monitor tcp:..." to the Qemu commandline arguments.

IIRC at that point qemu wasn't able to handle two monitor connections.
At this point it is possible to have two concurrent connections to the
montitor. Obviously things may break and you get to keep the pieces if
it breaks.

By adding:

  &lt;qemu:commandline&gt;
    &lt;qemu:arg value='-qmp'/&gt;
    &lt;qemu:arg value='tcp:127.0.0.1:1235'/&gt;
  &lt;/qemu:commandline&gt;


I then get a connection from qemu on the socket when starting the VM:

  $ nc -l -p 1235
  {"QMP": {"version": {"qemu": {"micro": 93, "minor": 1, "major": 6}, "package": \
"v6.2.0-rc3"}, "capabilities": ["oob"]}}

I can then start conversing with the monitor:

  {"execute":"qmp_capabilities"}
  {"return": {}}
  {"execute":"human-monitor-command","arguments":{"command-line":"info"}}
  {"return": "info balloon  - ....


Out of curiousity, what do you specifically need 'info tlb' for?


</body></email><email><emailId>20211208123248</emailId><senderName>Philipp Klocke</senderName><senderEmail>philipp.klocke@motius.de</senderEmail><timestampReceived>2021-12-08 12:32:48-0400</timestampReceived><subject>Re: Qemu monitor info tlb gives unable to encode message payload</subject><body>

On 12/8/21 12:09, Peter Krempa wrote:
&gt; CAUTION: This email originated from outside of the organization. Do not click links \
&gt; or open attachments unless you recognize the sender and know the content is safe. 
&gt; 
&gt; On Wed, Dec 08, 2021 at 10:30:27 +0000, Philipp Klocke wrote:
&gt; &gt; Hi,
&gt; &gt; 
&gt; &gt; the command
&gt; &gt; virsh qemu-monitor-command ubuntu_vm --hmp --cmd "info tlb"
&gt; &gt; fails with "error: Unable to encode message payload".
&gt; &gt; 
&gt; &gt; I found a bugtracker entry for a similiar error [1], but I don't if this is the \
&gt; &gt; same error (message too large). I also don't know how large an info tlb message \
&gt; &gt; is. Preferably I would not have to recompile libvirt just to issue this monitor \
&gt; &gt; command..
&gt; Libvirt unfortunately limits strings to 4MiB:
&gt; 
&gt; const REMOTE_STRING_MAX = 4194304;
&gt; 
&gt; And the reply from qemu-monitor-command is a single string. Now
&gt; internally we process JSON messages up to 10 MiB so one could argue that
&gt; we should increase the size for the 'qemu-monitor-command' reply up to
&gt; 10MiB. This could be straightforward but it's questionable whether it's
&gt; worth it.
Thanks for the clarification! I will try to go for the 2nd monitor then.
&gt; &gt; Then I thought about circumventing the error by connecting directly to the qemu \
&gt; &gt; monitor via netcat, but I found a thread [2] that says I cannot add my own \
&gt; &gt; "-monitor tcp:..." to the Qemu commandline arguments.
&gt; IIRC at that point qemu wasn't able to handle two monitor connections.
&gt; At this point it is possible to have two concurrent connections to the
&gt; montitor. Obviously things may break and you get to keep the pieces if
&gt; it breaks.
&gt; 
&gt; By adding:
&gt; 
&gt; &lt;qemu:commandline&gt;
&gt; &lt;qemu:arg value='-qmp'/&gt;
&gt; &lt;qemu:arg value='tcp:127.0.0.1:1235'/&gt;
&gt; &lt;/qemu:commandline&gt;

When I add this to the config via virsh edit and then do a shutdown + 
reboot, I get a kernel panic.
I put the corresponding dmesg log on gist: 
https://gist.github.com/klockeph/323f3e0d23a3254ef98a65fd7c8f5a1c

&gt; 
&gt; I then get a connection from qemu on the socket when starting the VM:
&gt; 
&gt; $ nc -l -p 1235
&gt; {"QMP": {"version": {"qemu": {"micro": 93, "minor": 1, "major": 6}, "package": \
&gt; "v6.2.0-rc3"}, "capabilities": ["oob"]}} 
&gt; I can then start conversing with the monitor:
&gt; 
&gt; {"execute":"qmp_capabilities"}
&gt; {"return": {}}
&gt; {"execute":"human-monitor-command","arguments":{"command-line":"info"}}
&gt; {"return": "info balloon  - ....
&gt; 
&gt; 
&gt; Out of curiousity, what do you specifically need 'info tlb' for?
&gt; 
I am currently investigating a performance issue where a Windows VM is 
very slow in accessing qemu ivshmem.
So I want to get some better understanding how this memory is mapped 
into the VM (if it's paginated or continuous etc.), and hoped that info 
tlb could help me there. But I don't know what the output of the command 
is because it never ran. :D

I would prefer using a "real" profiler for this but the only one I tried 
so far (AMD uProf) crashed the VM with a bluescreen...


</body></email><email><emailId>20211208124211</emailId><senderName>Philipp Klocke</senderName><senderEmail>philipp.klocke@motius.de</senderEmail><timestampReceived>2021-12-08 12:42:11-0400</timestampReceived><subject>Re: Qemu monitor info tlb gives unable to encode message payload</subject><body>



On 12/8/21 12:09, Peter Krempa wrote
&gt; 
&gt; On Wed, Dec 08, 2021 at 10:30:27 +0000, Philipp Klocke wrote:
&gt; &gt; Hi,
&gt; &gt; 
&gt; &gt; the command
&gt; &gt; virsh qemu-monitor-command ubuntu_vm --hmp --cmd "info tlb"
&gt; &gt; fails with "error: Unable to encode message payload".
&gt; &gt; 
&gt; &gt; I found a bugtracker entry for a similiar error [1], but I don't if this is the \
&gt; &gt; same error (message too large). I also don't know how large an info tlb message \
&gt; &gt; is. Preferably I would not have to recompile libvirt just to issue this monitor \
&gt; &gt; command..
&gt; 
&gt; Libvirt unfortunately limits strings to 4MiB:
&gt; 
&gt; const REMOTE_STRING_MAX = 4194304;
&gt; 
&gt; And the reply from qemu-monitor-command is a single string. Now
&gt; internally we process JSON messages up to 10 MiB so one could argue that
&gt; we should increase the size for the 'qemu-monitor-command' reply up to
&gt; 10MiB. This could be straightforward but it's questionable whether it's
&gt; worth it.
&gt; 

Thanks for the clarification! I will try to go for the 2nd monitor then.

&gt; &gt; Then I thought about circumventing the error by connecting directly to the qemu \
&gt; &gt; monitor via netcat, but I found a thread [2] that says I cannot add my own \
&gt; &gt; "-monitor tcp:..." to the Qemu commandline arguments.
&gt; 
&gt; IIRC at that point qemu wasn't able to handle two monitor connections.
&gt; At this point it is possible to have two concurrent connections to the
&gt; montitor. Obviously things may break and you get to keep the pieces if
&gt; it breaks.
&gt; 
&gt; By adding:
&gt; 
&gt; &lt;qemu:commandline&gt;
&gt; &lt;qemu:arg value='-qmp'/&gt;
&gt; &lt;qemu:arg value='tcp:127.0.0.1:1235'/&gt;
&gt; &lt;/qemu:commandline&gt;
&gt; 

When I add this to the config via virsh edit and then do a shutdown + 
reboot, I get a kernel panic.
I put the corresponding dmesg log on gist: 
https://gist.github.com/klockeph/323f3e0d23a3254ef98a65fd7c8f5a1c

&gt; 
&gt; 
&gt; Out of curiousity, what do you specifically need 'info tlb' for?
&gt; 

I am currently investigating a performance issue where a Windows VM is 
very slow in accessing qemu ivshmem.
So I want to get some better understanding how this memory is mapped 
into the VM (if it's paginated or continuous etc.), and hoped that info 
tlb could help me there. But I don't know what the output of the command 
is because it never ran. :D

I would prefer using a "real" profiler for this but the only one I tried 
so far (AMD uProf) crashed the VM with a bluescreen...


</body></email><email><emailId>20211208131506</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-12-08 13:15:06-0400</timestampReceived><subject>Re: Qemu monitor info tlb gives unable to encode message payload</subject><body>

On Wed, Dec 08, 2021 at 01:32:48PM +0100, Philipp Klocke wrote:
&gt; On 12/8/21 12:09, Peter Krempa wrote:
&gt; &gt; CAUTION: This email originated from outside of the organization. Do not click \
&gt; &gt; links or open attachments unless you recognize the sender and know the content is \
&gt; &gt; safe. 
&gt; &gt; 
&gt; &gt; On Wed, Dec 08, 2021 at 10:30:27 +0000, Philipp Klocke wrote:
&gt; &gt; &gt; Hi,
&gt; &gt; &gt; 
&gt; &gt; &gt; the command
&gt; &gt; &gt; virsh qemu-monitor-command ubuntu_vm --hmp --cmd "info tlb"
&gt; &gt; &gt; fails with "error: Unable to encode message payload".
&gt; &gt; &gt; 
&gt; &gt; &gt; I found a bugtracker entry for a similiar error [1], but I don't if this is the \
&gt; &gt; &gt; same error (message too large). I also don't know how large an info tlb message \
&gt; &gt; &gt; is. Preferably I would not have to recompile libvirt just to issue this monitor \
&gt; &gt; &gt; command..
&gt; &gt; Libvirt unfortunately limits strings to 4MiB:
&gt; &gt; 
&gt; &gt; const REMOTE_STRING_MAX = 4194304;
&gt; &gt; 
&gt; &gt; And the reply from qemu-monitor-command is a single string. Now
&gt; &gt; internally we process JSON messages up to 10 MiB so one could argue that
&gt; &gt; we should increase the size for the 'qemu-monitor-command' reply up to
&gt; &gt; 10MiB. This could be straightforward but it's questionable whether it's
&gt; &gt; worth it.
&gt; Thanks for the clarification! I will try to go for the 2nd monitor then.
&gt; &gt; &gt; Then I thought about circumventing the error by connecting directly to the qemu \
&gt; &gt; &gt; monitor via netcat, but I found a thread [2] that says I cannot add my own \
&gt; &gt; &gt; "-monitor tcp:..." to the Qemu commandline arguments.
&gt; &gt; IIRC at that point qemu wasn't able to handle two monitor connections.
&gt; &gt; At this point it is possible to have two concurrent connections to the
&gt; &gt; montitor. Obviously things may break and you get to keep the pieces if
&gt; &gt; it breaks.
&gt; &gt; 
&gt; &gt; By adding:
&gt; &gt; 
&gt; &gt; &lt;qemu:commandline&gt;
&gt; &gt; &lt;qemu:arg value='-qmp'/&gt;
&gt; &gt; &lt;qemu:arg value='tcp:127.0.0.1:1235'/&gt;
&gt; &gt; &lt;/qemu:commandline&gt;
&gt; 
&gt; When I add this to the config via virsh edit and then do a shutdown +
&gt; reboot, I get a kernel panic.
&gt; I put the corresponding dmesg log on gist:
&gt; https://gist.github.com/klockeph/323f3e0d23a3254ef98a65fd7c8f5a1c

I can't see how that is related to adding an extra -qmp parameter,
since it doesn't affect the guest ABI

FWIW, exposing -qmp over a tcp socket is totally insecure - any
local process can connect to that.


Regards,
Daniel
-- 
&gt; &gt; https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
&gt; &gt; https://libvirt.org         -o-            https://fstop138.berrange.com :|
&gt; &gt; https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|


</body></email><email><emailId>20211229175657</emailId><senderName>lejeczek</senderName><senderEmail>peljasz@yahoo.co.uk</senderEmail><timestampReceived>2021-12-29 17:56:57-0400</timestampReceived><subject>Allow unsafe migration - ?</subject><body>

Hi guys.

Is it possible to allow 'unsafe' migration globally?

many thanks, L.

</body></email><email><emailId>20211113100912</emailId><senderName>daggs</senderName><senderEmail>daggs@gmx.com</senderEmail><timestampReceived>2021-11-13 10:09:12-0400</timestampReceived><subject>creating specific cpu model</subject><body>

Greetings,

I want to create a new cpu model which is a cross section of cpu flags of 2 different \
cpus and libvirt capabilites.

I've extracted the supported cpu flags of each cpu using lscpu.
I've created a cross section of both.
I've pulled the suppored cpu flags from libvirt and created a cross section of it \
with the subset from above.

now I want to create a new cpu model out of it.
I assume that creating a xml file at /usr/share/libvirt/cpu_map/ with the x86_ prefix \
that matches the format listed there will suffice for libvirt and later for qemu?

Thanks,

Dagg.


</body></email><email><emailId>20211115213115</emailId><senderName>daggs</senderName><senderEmail>daggs@gmx.com</senderEmail><timestampReceived>2021-11-15 21:31:15-0400</timestampReceived><subject>Re: CPU vendor_id handling</subject><body>

&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;div style="font-family: Verdana;font-size: \
12.0px;"&gt;&lt;div&gt;Greetings,&lt;br/&gt; &lt;br/&gt;
passthrough means you pass the device as is with minimal or no change at all.&lt;/div&gt;

&lt;div&gt;for example, if you passthrough a pci device, the pci address might change but \
the rest won't.&lt;/div&gt;

&lt;div&gt;
&lt;div&gt; &lt;/div&gt;

&lt;div&gt;hope this helps&lt;/div&gt;

&lt;div&gt; &lt;/div&gt;

&lt;div&gt;Dagg&lt;/div&gt;

&lt;div&gt; 
&lt;div name="quote" style="margin:10px 5px 5px 10px; padding: 10px 0 10px 10px; \
border-left:2px solid #C3D9E5; word-wrap: break-word; -webkit-nbsp-mode: space; \
-webkit-line-break: after-white-space;"&gt; &lt;div style="margin:0 0 10px \
0;"&gt;&lt;b&gt;Sent:&lt;/b&gt; Sunday, November 14, 2021 at 11:52 PM&lt;br/&gt; \
&lt;b&gt;From:&lt;/b&gt; "Toolybird" &lt;toolybird@tuta.io&gt;&lt;br/&gt; \
&lt;b&gt;To:&lt;/b&gt; "Libvirt Users" &lt;libvirt-users@redhat.com&gt;&lt;br/&gt; \
&lt;b&gt;Subject:&lt;/b&gt; CPU vendor_id handling&lt;/div&gt;

&lt;div name="quoted-content"&gt;
&lt;div&gt;Hello,&lt;/div&gt;

&lt;div&gt; &lt;/div&gt;

&lt;div&gt;There are times when spoofing the CPU vendor_id is convenient. For example, some \
x86 guest OS's only run on Intel and refuse to run on an AMD host. Libvirt does \
support this in the "host-model" case, but it doesn't work for CPU \
"host-passthrough". On the QEMU command line it's as easy as:&lt;/div&gt;

&lt;div&gt; &lt;/div&gt;

&lt;div&gt;$ qemu-system-x86_64 -cpu host,vendor=GenuineIntel&lt;/div&gt;

&lt;div&gt; &lt;/div&gt;

&lt;div&gt;This works fine in libvirt XML:&lt;/div&gt;

&lt;div&gt; &lt;/div&gt;

&lt;div&gt;&lt;cpu mode='host-model'&gt;&lt;/div&gt;

&lt;div&gt;  &lt;model vendor_id='GenuineIntel'/&gt;&lt;/div&gt;

&lt;div&gt;&lt;/cpu&gt;&lt;/div&gt;

&lt;div&gt; &lt;/div&gt;

&lt;div&gt;This doesn't:&lt;/div&gt;

&lt;div&gt; &lt;/div&gt;

&lt;div&gt;&lt;cpu mode='host-passthrough'&gt;&lt;/div&gt;

&lt;div&gt;  &lt;model vendor_id='GenuineIntel'/&gt;&lt;/div&gt;

&lt;div&gt;&lt;/cpu&gt;&lt;/div&gt;

&lt;div&gt; &lt;/div&gt;

&lt;div&gt;Libvirt silently strips out the model line after saving "virsh edit \
..."&lt;/div&gt;

&lt;div&gt; &lt;/div&gt;

&lt;div&gt;Is there any reason why libvirt cannot support this in the host-passthrough \
case? The status quo means that some folks end up resorting to &lt;qemu:arg \
value='-cpu'/&gt; hacks which of course causes all sorts of confusion with \
multiple -cpu lines getting passed to QEMU.&lt;/div&gt;

&lt;div&gt; &lt;/div&gt;

&lt;div&gt;Thanks&lt;/div&gt;

&lt;div&gt; &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;


</body></email><email><emailId>20211116022438</emailId><senderName>Han Han</senderName><senderEmail>hhan@redhat.com</senderEmail><timestampReceived>2021-11-16 02:24:38-0400</timestampReceived><subject>Re: can't connect to virtlogd: Unable to open system token /run/libvirt/common/system.token: Permiss</subject><body>

On Mon, Nov 15, 2021 at 10:49 PM 梁朝军 &lt;jesonliang040705@hotmail.com&gt; wrote:

&gt; Hi all,
&gt;
&gt; I have encountered a new issue when start a VM with new builded libvirt.
&gt; I failed to start VM from defined xml and hit the error like "can't
&gt; connect to virtlogd: Unable to open system token
&gt; /run/libvirt/common/system.token: Permission denied"
&gt;
&gt; Known bug https://bugzilla.redhat.com/show_bug.cgi?id=1966842

Update selinux-policy + clean up /run/libvirt/common/ + restart libvirtd &amp;
virtlogd will resolve this issue.

&gt; Any inputs are appreciated.
&gt;
&gt; The libvit version:
&gt; libvirtd -V
&gt; setlocale: No such file or directory
&gt; libvirtd (libvirt) 7.6.0
&gt;
&gt; Os : cat /etc/redhat-release
&gt; Red Hat Enterprise Linux release 8.4 (Ootpa)
&gt;
&gt; Linux kernel:
&gt; uname -a
&gt; Linux localhost.localdomain 4.18.0-305.el8.x86_64 #1 SMP Thu Apr 29
&gt; 08:54:30 EDT 2021 x86_64 x86_64 x86_64 GNU/Linux
&gt;
&gt; QEMU version:
&gt; usr/libexec/qemu-kvm --help
&gt; QEMU emulator version 5.1.0 (qemu-kvm-5.1.0-1.el8)
&gt; Copyright (c) 2003-2020 Fabrice Bellard and the QEMU Project developers
&gt;
&gt; Thanks!
&gt;
&gt;

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" \
class="gmail_attr"&gt;On Mon, Nov 15, 2021 at 10:49 PM 梁朝军 &lt;&lt;a \
href="mailto:jesonliang040705@hotmail.com"&gt;jesonliang040705@hotmail.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;Hi all,&lt;br&gt; &lt;br&gt;
I have encountered a new issue when start a VM with new builded libvirt.&lt;br&gt;
I failed to start VM from defined xml and hit the error like "can't connect \
to virtlogd: Unable to open system token /run/libvirt/common/system.token: Permission \
denied"&lt;br&gt; &lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;Known bug &lt;a \
href="https://bugzilla.redhat.com/show_bug.cgi?id=1966842"&gt;https://bugzilla.redhat.com/show_bug.cgi?id=1966842&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Update \
selinux-policy + clean up /run/libvirt/common/  + restart libvirtd &amp; virtlogd \
will resolve this issue. &lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px \
0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt; Any inputs are \
appreciated. &lt;br&gt; &lt;br&gt;
The libvit version:&lt;br&gt;
libvirtd -V&lt;br&gt;
setlocale: No such file or directory&lt;br&gt;
libvirtd (libvirt) 7.6.0&lt;br&gt;
&lt;br&gt;
Os : cat /etc/redhat-release&lt;br&gt;
Red Hat Enterprise Linux release 8.4 (Ootpa)&lt;br&gt;
&lt;br&gt;
Linux kernel:&lt;br&gt;
uname -a&lt;br&gt;
Linux localhost.localdomain 4.18.0-305.el8.x86_64 #1 SMP Thu Apr 29 08:54:30 EDT 2021 \
x86_64 x86_64 x86_64 GNU/Linux&lt;br&gt; &lt;br&gt;
QEMU version:&lt;br&gt;
usr/libexec/qemu-kvm --help&lt;br&gt;
QEMU emulator version 5.1.0 (qemu-kvm-5.1.0-1.el8)&lt;br&gt;
Copyright (c) 2003-2020 Fabrice Bellard and the QEMU Project developers&lt;br&gt;
&lt;br&gt;
Thanks!&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20211116092702</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-11-16 09:27:02-0400</timestampReceived><subject>Re: Cannot access KVM using virsh console after KVM rebooted or shut off</subject><body>

On Mon, Nov 15, 2021 at 06:13:22PM -0500, Yifei Liu wrote:
&gt; Dear all,
&gt; 
&gt; I used ssh with -X option to connect to an Ubuntu remote server where I applied virsh 
&gt; (libvirt) to manage my KVM virtual machines, and my local machine is MacOS. Then, 
&gt; I used virt-install to install a Tiny Core Linux VM, and I got a pop-up Virt Viewer window 
&gt; (via XQuartz) which is the console for my Tiny Core VM. However, if I rebooted my VM, 
&gt; then I checked the VM state by virsh list --all which was running. Then, I tried 
&gt; `virsh console my_vm_domain` but this command got stuck on:
&gt; &gt; Connected to domain my_vm_domain
&gt; &gt; Escape character is ^]
&gt; 
&gt; The `virsh console` command hung without any response. This issue also happened when 
&gt; I used virsh console after I shut down and later started the VM. Even the VM was already 
&gt; started, I cannot return to the VM console by `virsh console`.

This isn't a hang, this is simply indicating that your guest OS is
not running anything on the serial console.  If you configure
the guest to launch a login prompt on the serial port, then
you'll see something on virsh console.

&gt; I can get the VM console in Virt Viewer at the first boot (using virt-install). 
&gt; But, if I shutdown the VM once, I can never access the VM console by virsh console even 
&gt; the VM state is running. Any idea about how to use virsh console?

You're comparing two different things. Virt Viewer connects to the
*graphical* console exposed by the VGA card (or whatever graphics
devce is configure).  virsh console connect to the primary serial
port.

Most OS will only display on the graphical console by default and
require extra steps to activate the serial console.

Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20211117223901</emailId><senderName>Laine Stump</senderName><senderEmail>laine@redhat.com</senderEmail><timestampReceived>2021-11-17 22:39:01-0400</timestampReceived><subject>Re: configure path name of ebtables executable</subject><body>



On 11/17/21 4:52 PM, Michael Ströder wrote:
&gt; On 11/17/21 20:28, Laine Stump wrote:
&gt;&gt; On 11/17/21 1:39 PM, Michael Ströder wrote:
&gt;&gt;&gt; Is it possible to configure the full path name of the ebtables 
&gt;&gt;&gt; executable used somewhere in libvirt's config?
&gt;&gt;
&gt;&gt; That's done in meson.build when you're building from source. Look for 
&gt;&gt; "optional_programs".
&gt; 
&gt; Noted. Thanks.
&gt; 
&gt;&gt;&gt; Background: I'd like to avoid automatic alternatives implementation 
&gt;&gt;&gt; to mess up libvirt installation.
&gt;&gt;&gt;
&gt;&gt;&gt; See also:
&gt;&gt;&gt; https://bugzilla.opensuse.org/show_bug.cgi?id=1192799
&gt;&gt;
&gt;&gt; I don't think the problem is what is being suggested in that bug.
&gt; 
&gt; Yes, it is.

The suggestion in that bug is that the problem is because "libvirt need 
/sbin/ebtables point to ebtables-legacy", which is definitely not the 
case. libvirt only requires that /sbin/ebtables point to a binary that 
correctly understands and acts on any valid ebtables command. If the 
binary pointed to by /sbin/ebtables doesn't do that, then it shouldn't 
be pointed to by /sbin/ebtables.

&gt;&gt; follow the symlink from /sbin/ebtables to (probably)
&gt;&gt; /etc/alternatives/ebtables &gt; [..]
&gt;&gt; This sounds more like SUSE has some sort of special off-brand
&gt;&gt; alternative that doesn't understand all valid ebtables commands
&gt; openSUSE Tumbleweed now uses libalternatives for ebtables (see my 
&gt; comment#2) and thus
&gt; /sbin/ebtables was linked to /usr/bin/alts. Yes, something's broken 
&gt; there and I was looking for a work-around.
&gt; 
&gt;&gt; Anyway, I think you'd be better off fixing the problem at the source
&gt;&gt; rather than trying to make some special local build of libvirt to
&gt;&gt; work around the problem.
&gt; IMHO a libvirtd.conf option would be great to avoid relying on this 
&gt; alternatives stuff.

There are many things within libvirt that we could do ourselves in order 
to avoid relying on some other package (or add a config knob to point at 
something different to do the work), but that just makes more code that 
must be maintained forever. Working around bugs in other packages with 
package-local fixes and config knobs is a never-ending unwinnable battle 
once you start, and leads to unnecessarily complicated code and 
technical debt (I say this from painful experience - although it's a bit 
of a whatabout-ism, if I had the time (I unfortunately don't :-)) I 
would tell the story of iptablesAddOutputFixUdpChecksum, just as one 
example).

I think a better road in this case (and most other cases) would be to 
fix the package that is broken (sounds like libalternatives). If it is 
breaking libvirt, it's likely breaking other things as well.

</body></email><email><emailId>20211123082129</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-11-23 08:21:29-0400</timestampReceived><subject>Re: how to use vhost-user-vsock</subject><body>

On 11/16/21 14:54, Jiatong Shen wrote:
&gt; Hello community,
&gt; 
&gt;    I am looking for a way to configure vhost-user-vsock using libvirt,
&gt; but looks like it is not written in doc. How can I use vhost-user-vsock
&gt; using libvirt? Thank you.
&gt; 

Libvirt has basic support for vsock:

https://libvirt.org/formatdomain.html#vsock

For instance the following:

    &lt;vsock model='virtio'&gt;
      &lt;cid auto='no' address='4'/&gt;
    &lt;/vsock&gt;


will get you:

-device
'{"driver":"vhost-vsock-pci","id":"vsock0","guest-cid":4,"vhostfd":"6789","bus":"pci.0","addr":"0x7"}'

But, I don't think we have vhost-*user*-vsock implemented yet.

Michal

</body></email><email><emailId>20211115144926</emailId><senderName></senderName><senderEmail>jesonliang040705@hotmail.com</senderEmail><timestampReceived>2021-11-15 14:49:26-0400</timestampReceived><subject>can't connect to virtlogd: Unable to open system token /run/libvirt/common/system.token: Permission </subject><body>

Hi all,

I have encountered a new issue when start a VM with new builded libvirt.
I failed to start VM from defined xml and hit the error like "can't connect to \
virtlogd: Unable to open system token /run/libvirt/common/system.token: Permission \
denied¡±

Any inputs are appreciated. 

The libvit version:
libvirtd -V
setlocale: No such file or directory
libvirtd (libvirt) 7.6.0

Os : cat /etc/redhat-release
Red Hat Enterprise Linux release 8.4 (Ootpa)

Linux kernel:
uname -a
Linux localhost.localdomain 4.18.0-305.el8.x86_64 #1 SMP Thu Apr 29 08:54:30 EDT 2021 \
x86_64 x86_64 x86_64 GNU/Linux

QEMU version:
usr/libexec/qemu-kvm --help
QEMU emulator version 5.1.0 (qemu-kvm-5.1.0-1.el8)
Copyright (c) 2003-2020 Fabrice Bellard and the QEMU Project developers

Thanks!


</body></email><email><emailId>20211115231322</emailId><senderName>Yifei Liu</senderName><senderEmail>yifeliu@cs.stonybrook.edu</senderEmail><timestampReceived>2021-11-15 23:13:22-0400</timestampReceived><subject>Cannot access KVM using virsh console after KVM rebooted or shut off</subject><body>

Dear all,

I used ssh with -X option to connect to an Ubuntu remote server where I applied virsh 
(libvirt) to manage my KVM virtual machines, and my local machine is MacOS. Then, 
I used virt-install to install a Tiny Core Linux VM, and I got a pop-up Virt Viewer window 
(via XQuartz) which is the console for my Tiny Core VM. However, if I rebooted my VM, 
then I checked the VM state by virsh list --all which was running. Then, I tried 
`virsh console my_vm_domain` but this command got stuck on:
&gt; Connected to domain my_vm_domain
&gt; Escape character is ^]

The `virsh console` command hung without any response. This issue also happened when 
I used virsh console after I shut down and later started the VM. Even the VM was already 
started, I cannot return to the VM console by `virsh console`.

I can get the VM console in Virt Viewer at the first boot (using virt-install). 
But, if I shutdown the VM once, I can never access the VM console by virsh console even 
the VM state is running. Any idea about how to use virsh console? 

Thanks,
Yifei


</body></email><email><emailId>20211117183915</emailId><senderName>Michael_Ströder</senderName><senderEmail>michael@stroeder.com</senderEmail><timestampReceived>2021-11-17 18:39:15-0400</timestampReceived><subject>configure path name of ebtables executable</subject><body>

HI!

Is it possible to configure the full path name of the ebtables 
executable used somewhere in libvirt's config?

Background: I'd like to avoid automatic alternatives implementation to 
mess up libvirt installation.

See also:
https://bugzilla.opensuse.org/show_bug.cgi?id=1192799

Ciao, Michael.

</body></email><email><emailId>20211116135428</emailId><senderName>Jiatong Shen</senderName><senderEmail>yshxxsjt715@gmail.com</senderEmail><timestampReceived>2021-11-16 13:54:28-0400</timestampReceived><subject>how to use vhost-user-vsock</subject><body>

Hello community,

  I am looking for a way to configure vhost-user-vsock using libvirt, but
looks like it is not written in doc. How can I use vhost-user-vsock using
libvirt? Thank you.

-- 

Best Regards,

Jiatong Shen

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hello community,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;   I am looking for a way to \
configure vhost-user-vsock using libvirt, but looks like it is not written in doc. \
How can I use vhost-user-vsock using libvirt? Thank you.&lt;br \
clear="all"&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- &lt;br&gt;&lt;div dir="ltr" class="gmail_signature" \
data-smartmail="gmail_signature"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;div&gt;Best \
Regards,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Jiatong Shen&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20211118063732</emailId><senderName>Han Han</senderName><senderEmail>hhan@redhat.com</senderEmail><timestampReceived>2021-11-18 06:37:32-0400</timestampReceived><subject>Questions on device-added and device-removed events</subject><body>

Hi developers,
When the guest OS is booting, the event for live attachment could be caught
by libvirt, while the event for live detachment could not.
Version:
libvirt-7.9
qemu-kvm-6.1

Steps:
Terminal 1:
=E2=9E=9C  ~ virsh event --loop --all

Terminal 2:
=E2=9E=9C  ~ virsh start avocado-vt-vm1; qemu-img create /tmp/vdb 10M; virs=
h
attach-disk avocado-vt-vm1 /tmp/vdb vdb; virsh detach-disk avocado-vt-vm1
vdb

The outputs from terminal 1:
event 'agent-lifecycle' for domain 'avocado-vt-vm1': state: 'disconnected'
reason: 'domain started'
event 'lifecycle' for domain 'avocado-vt-vm1': Resumed Unpaused
event 'lifecycle' for domain 'avocado-vt-vm1': Started Booted
event 'device-added' for domain 'avocado-vt-vm1': virtio-disk1
event 'agent-lifecycle' for domain 'avocado-vt-vm1': state: 'connected'
reason: 'channel event'

As you can see, the device live attachment and the device detachment are
both executed when the guest OS is booting, but there is only the event
'device-added' is recorded.
So my questions are:
1. Is it the expected results for the results above?
2. If so, what is the internal difference between 'device-added' and
'device-removed'?
3. I notice there is the DEVICE_DELETED event in qmp? Any relation between
the 'device-removed' of libvirt and the DEVICE_DELETED of qmp?

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div&gt;Hi developers,&lt;/div&gt;&lt;div&gt;When the guest OS is booting, the event \
for live attachment could be caught by libvirt, while the event for live detachment \
could not.&lt;/div&gt;&lt;div&gt;Version:&lt;/div&gt;&lt;div&gt;libvirt-7.9&lt;/div&gt;&lt;div&gt;qemu-kvm-6.1&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Steps:&lt;/div&gt;&lt;div&gt;Terminal \
1:&lt;br&gt;➜   ~ virsh event --loop --all&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Terminal \
2:&lt;/div&gt;&lt;div&gt;➜   ~ virsh start avocado-vt-vm1; qemu-img create /tmp/vdb 10M; virsh \
attach-disk avocado-vt-vm1 /tmp/vdb vdb; virsh detach-disk avocado-vt-vm1 \
vdb&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The outputs from terminal 1: &lt;br&gt;&lt;/div&gt;&lt;div&gt;event \
'agent-lifecycle' for domain 'avocado-vt-vm1': state: \
'disconnected' reason: 'domain started'           &lt;br&gt;event \
'lifecycle' for domain 'avocado-vt-vm1': Resumed Unpaused&lt;br&gt;event \
'lifecycle' for domain 'avocado-vt-vm1': Started Booted&lt;br&gt;event \
'device-added' for domain 'avocado-vt-vm1': virtio-disk1&lt;br&gt;event \
'agent-lifecycle' for domain 'avocado-vt-vm1': state: \
'connected' reason: 'channel event'&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;As you \
can see, the device live attachment and the device detachment are both executed when \
the guest OS is booting, but there is only the event 'device-added' is \
recorded.&lt;/div&gt;&lt;div&gt;So my questions are:&lt;/div&gt;&lt;div&gt;1. Is it the expected results for \
the results above?&lt;/div&gt;&lt;div&gt;2. If so, what is the internal difference between \
'device-added' and 'device-removed'?&lt;/div&gt;&lt;div&gt;3. I notice there is \
the DEVICE_DELETED event in qmp? Any relation between the 'device-removed' of \
libvirt and the DEVICE_DELETED of qmp?&lt;br&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20211123162510</emailId><senderName>Elias Mobery</senderName><senderEmail>eliasmobery@gmail.com</senderEmail><timestampReceived>2021-11-23 16:25:10-0400</timestampReceived><subject>Libvirt + Debian Live = Heart Attack</subject><body>

Hi everyone!

I've built a Debian Live ISO with packages qemu and libvirt to run a VM in
the live environment.

The guest images are placed in  /var/lib/libvirt/images and 2GB each.

Everything works great, except for one issue.

When starting a VM, libvirt automatically issues a chown command to the
images, changing ownership.

This results in a copy of the images being created in
/run/live/overlay/rw/var/lib/libvirt/images

I don't want these copies to be made but can't stop it.

I've tried editing qemu.conf user/group, dynamic ownership etc. without any
luck.

Is there a way to STOP libvirt from changing the ownership of these images?

[Attachment #3 (text/html)]

&lt;div dir="auto"&gt;&lt;div style="" dir="auto"&gt;&lt;div style="width:517.333px;margin:16px \
0px"&gt;&lt;div style=""&gt;&lt;div dir="auto" style=""&gt;&lt;div dir="auto" style=""&gt;&lt;div dir="auto" \
style=""&gt;&lt;div style="" dir="auto"&gt;&lt;div style="width:517.333px;margin:16px 0px"&gt;&lt;div \
style=""&gt;&lt;div dir="auto" style=""&gt;&lt;div dir="auto" style=""&gt;&lt;div dir="auto" \
style=""&gt;&lt;font face="sans-serif"&gt;&lt;span \
style="font-size:12.8px"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div dir="auto" style=""&gt;&lt;font \
face="sans-serif"&gt;&lt;span style="font-size:12.8px"&gt;Hi everyone!&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div \
dir="auto" style=""&gt;&lt;font face="sans-serif"&gt;&lt;span \
style="font-size:12.8px"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div dir="auto" style=""&gt;&lt;font \
face="sans-serif"&gt;&lt;span style="font-size:12.8px"&gt;I've built a Debian Live ISO \
with packages qemu and libvirt to run a VM in the live \
environment.&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div dir="auto" style=""&gt;&lt;font \
face="sans-serif"&gt;&lt;span style="font-size:12.8px"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div \
dir="auto" style=""&gt;&lt;font face="sans-serif"&gt;&lt;span style="font-size:12.8px"&gt;The guest \
images are placed in   /var/lib/libvirt/images and 2GB each.&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div \
dir="auto" style=""&gt;&lt;font face="sans-serif"&gt;&lt;span \
style="font-size:12.8px"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div dir="auto" style=""&gt;&lt;font \
face="sans-serif"&gt;&lt;span style="font-size:12.8px"&gt;Everything works great, except for \
one issue.&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div dir="auto" style=""&gt;&lt;font face="sans-serif"&gt;&lt;span \
style="font-size:12.8px"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div dir="auto" style=""&gt;&lt;font \
face="sans-serif"&gt;&lt;span style="font-size:12.8px"&gt;When starting a VM, libvirt \
automatically issues a chown command to the images, changing \
ownership.&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div dir="auto" style=""&gt;&lt;font face="sans-serif"&gt;&lt;span \
style="font-size:12.8px"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div dir="auto" style=""&gt;&lt;font \
face="sans-serif"&gt;&lt;span style="font-size:12.8px"&gt;This results in a copy of the images \
being created in&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div dir="auto" style=""&gt;&lt;font \
face="sans-serif"&gt;&lt;span \
style="font-size:12.8px"&gt;/run/live/overlay/rw/var/lib/libvirt/images&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div \
dir="auto" style=""&gt;&lt;font face="sans-serif"&gt;&lt;span \
style="font-size:12.8px"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div dir="auto" style=""&gt;&lt;font \
face="sans-serif"&gt;&lt;span style="font-size:12.8px"&gt;I don't want these copies to be \
made but can't stop it.&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div dir="auto" style=""&gt;&lt;font \
face="sans-serif"&gt;&lt;span style="font-size:12.8px"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div \
dir="auto" style=""&gt;&lt;font face="sans-serif"&gt;&lt;span style="font-size:12.8px"&gt;I've \
tried editing qemu.conf user/group, dynamic ownership etc. without any \
luck.&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div dir="auto" style=""&gt;&lt;font face="sans-serif"&gt;&lt;span \
style="font-size:12.8px"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div dir="auto" style=""&gt;&lt;font \
face="sans-serif"&gt;&lt;span style="font-size:12.8px"&gt;Is there a way to STOP libvirt from \
changing the ownership of these images?&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div dir="auto" \
style=""&gt;&lt;font face="sans-serif"&gt;&lt;span \
style="font-size:12.8px"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div dir="auto" \
style="font-family:sans-serif;font-size:12.8px"&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;




</body></email><email><emailId>20211123204327</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-11-23 20:43:27-0400</timestampReceived><subject>Re: Libvirt + Debian Live = Heart Attack</subject><body>

On 11/23/21 17:25, Elias Mobery wrote:
&gt; 
&gt; Hi everyone!
&gt; 
&gt; I've built a Debian Live ISO with packages qemu and libvirt to run a VM
&gt; in the live environment.
&gt; 
&gt; The guest images are placed in   /var/lib/libvirt/images and 2GB each.
&gt; 
&gt; Everything works great, except for one issue.
&gt; 
&gt; When starting a VM, libvirt automatically issues a chown command to the
&gt; images, changing ownership.
&gt; 
&gt; This results in a copy of the images being created in
&gt; /run/live/overlay/rw/var/lib/libvirt/images
&gt; 
&gt; I don't want these copies to be made but can't stop it.
&gt; 
&gt; I've tried editing qemu.conf user/group, dynamic ownership etc. without
&gt; any luck.
&gt; 
&gt; Is there a way to STOP libvirt from changing the ownership of these images?
&gt; 
&gt; 

Setting dynamic_ownership=0 in qemu.conf is the way to go (don't forget
to restart the daemon after you made the change).

Alternatively, you can set &lt;seclabel/&gt; either for whole domain or
individual disks, e.g. like this:

  &lt;disk type='file' device='disk'&gt;
    &lt;driver name='qemu' type='qcow2'/&gt;
    &lt;source file='/var/lib/libvirt/images/vm1.qcow2'&gt;
      &lt;seclabel relabel='no'/&gt;
    &lt;/source&gt;
  &lt;/disk&gt;

or for whole domain:

    ...
    &lt;/devices&gt;
    &lt;seclabel type='none'/&gt;
  &lt;/domain&gt;

I'm not sure what your setup is, but if chown() is a problem then what
if guest tries to write onto its disk? Wouldn't that create a copy in
overlay?

Michal

</body></email><email><emailId>20211130061530</emailId><senderName>Jeff Brown</senderName><senderEmail>jeff@ff.co.za</senderEmail><timestampReceived>2021-11-30 06:15:30-0400</timestampReceived><subject>virsh blockjob $domain --abort</subject><body>

Please advise:

After a scheduled crontab snapshot backup of a VM it failed to do a 
blockcommit, and is currently writing to both the snapshot and the 
original QCOW2 images.

(I don't think it's a bug, and suspect that I caused it by running the 
backup script manually while the snapshot was already running.)

$ virsh blockcommit VM sda --active --pivot --shallow --verbose
error: block copy still active: disk 'sda' already in active block job

$ virsh blockjob VM sda --info
Active Block Commit: [100 %]

$ virsh domblkerror VM
No errors found

Running on Debian 9 (Stretch).

$ virsh version
Compiled against library: libvirt 3.0.0
Using library: libvirt 3.0.0
Using API: QEMU 3.0.0
Running hypervisor: QEMU 2.8.1

Now, I've read up on the probable solution, somewhat, but running $ 
virsh blockjob $domain --abort on this production server scares me; and 
I'm just asking whether it would be advisable to stop services and make 
a full data backup prior to doing so? It would entail taking the 
services offline for at least an hour. The snapshot is currently at 
12GB,   and according to blockjob --info the VM image is 100% in synch.

Will appreciate any advice. Thank you.

Best regards,

Jeff

</body></email><email><emailId>20211129171540</emailId><senderName>Mario Marietto</senderName><senderEmail>marietto2008@gmail.com</senderEmail><timestampReceived>2021-11-29 17:15:40-0400</timestampReceived><subject>Fwd: Installing virtiofs drivers on Windows 11....</subject><body>

Hello to everyone.

I'm testing Windows 11 with bhyve and I've found an annoying problem that
prevents me from completing some tasks that I'm working on.

It seems that the virtio-9p driver does not work inside the Windows 11 os
emulated with bhyve and maybe also with qemu-kvm. When Windows 11 is
launched,I don't see the folder "mnt" mounted on the root folder of Windows
11. Below you can see which bhyve parameters I've used :

bhyve -S -c 4 -m 8G -w -H \
-s 0,hostbridge \
-s 1,ahci-cd,/home/marietto/Downloads/virtio/virtio-win-0.1.208.iso \
-s 2,ahci-hd,/mnt/da0p1/Backups/OS/bhyve/Windows/win11.img \
-s 3,fbuf,tcp=0.0.0.0:5900,w=1440,h=900,wait \
-s 8,virtio-net,tap0 \
----&gt; -s 9,virtio-9p,sharename=/mnt \
-s 30,xhci,tablet \
-s 31,lpc \
-l bootrom,/usr/local/share/uefi-firmware/BHYVE_UEFI.fd \
vm0

Investigating a little bit more and reading from this tutorial :

https://virtio-fs.gitlab.io/howto-windows.html

I've realized that there should be some problem with the WinFsp
&lt;http://www.secfs.net/winfsp&gt; - Windows File System Proxy and or with the
virtiofs PCI device driver because I'm not able to enable the virtiofs
service with the command used on the tutorial :

C:\&gt; sc start VirtioFsSvc

it gives the error : "the dependency service does not exist or it has
been marked for the elimination.

I've attached some screenshots to help you to understand what's happening.


Please help me,thanks.

Attached screenshots :

https://ibb.co/m5vm1hd
https://ibb.co/Qd6TS5d
https://ibb.co/3018SGd

-- 
Mario.

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr"&gt;&lt;div class="gmail_quote"&gt;&lt;div \
dir="ltr"&gt;&lt;div&gt;Hello to everyone.&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I'm  \
testing Windows 11 with bhyve and I've found an annoying problem that  prevents \
me from completing some tasks that I'm working on.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;It  \
seems that the virtio-9p driver does not work inside the Windows 11 os emulated with \
bhyve and maybe also with qemu-kvm. When Windows 11 is  launched,I don't see the \
folder "mnt" mounted on the root folder of  Windows 11. Below you can see \
which bhyve parameters I've used :&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;bhyve -S -c 4 -m \
8G -w -H \&lt;br&gt;-s 0,hostbridge \&lt;br&gt;-s \
1,ahci-cd,/home/marietto/Downloads/virtio/virtio-win-0.1.208.iso \&lt;br&gt;-s \
2,ahci-hd,/mnt/da0p1/Backups/OS/bhyve/Windows/win11.img \&lt;br&gt;-s 3,fbuf,tcp=&lt;a \
href="http://0.0.0.0:5900" target="_blank"&gt;0.0.0.0:5900&lt;/a&gt;,w=1440,h=900,wait \&lt;br&gt;-s \
8,virtio-net,tap0 \&lt;br&gt;----&gt; -s 9,virtio-9p,sharename=/mnt \&lt;br&gt;-s 30,xhci,tablet \
\&lt;br&gt;-s 31,lpc \&lt;br&gt;-l bootrom,/usr/local/share/uefi-firmware/BHYVE_UEFI.fd \
\&lt;br&gt;vm0&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Investigating a little bit more and reading from \
this tutorial :&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;a \
href="https://virtio-fs.gitlab.io/howto-windows.html" \
target="_blank"&gt;https://virtio-fs.gitlab.io/howto-windows.html&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I've \
realized that there should be some problem with the &lt;a \
href="http://www.secfs.net/winfsp" target="_blank"&gt;WinFsp&lt;/a&gt; - Windows File System \
Proxy and or with the virtiofs PCI device driver because I'm not able to enable \
the virtiofs service with the command used on the tutorial \
:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;pre&gt;C:\&gt; sc start VirtioFsSvc&lt;br&gt;&lt;br&gt;&lt;/pre&gt;&lt;pre&gt;it \
gives the error : "the dependency service does not exist or it has been marked \
for the elimination.&lt;br&gt;&lt;/pre&gt;&lt;pre&gt;I've attached some screenshots to help you to \
understand what's happening.&lt;br&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Please help \
me,thanks.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Attached screenshots \
:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;a \
href="https://ibb.co/m5vm1hd"&gt;https://ibb.co/m5vm1hd&lt;/a&gt;&lt;br&gt;&lt;a \
href="https://ibb.co/Qd6TS5d"&gt;https://ibb.co/Qd6TS5d&lt;/a&gt;&lt;br&gt;&lt;a \
href="https://ibb.co/3018SGd"&gt;https://ibb.co/3018SGd&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-- \
&lt;/div&gt;&lt;div dir="ltr" class="gmail_signature" \
data-smartmail="gmail_signature"&gt;Mario.&lt;br&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20211126230823</emailId><senderName>Nathan Vander Wilt</senderName><senderEmail>nate-lists@calftrail.com</senderEmail><timestampReceived>2021-11-26 23:08:23-0400</timestampReceived><subject>virsh create fails with "Unable to find any firmware to satisfy 'efi'" for aarch64 guest on macOS</subject><body>

I am having trouble when I `virsh create test.xml` with an aarch64
guest on a macOS (Apple Silicon) host. I've wrestled with a variety of
issues but the one I simply haven't been able to get past is this
regarding the UEFI firmware:

error: Failed to create domain from test.xml
error: operation failed: Unable to find any firmware to satisfy 'efi'

This is with `virsh --version` of 7.9.0 and `qemu-system-aarch64
--version` of 6.1.0, both installed via the common `brew` tool from
its main 'homebrew/core' tap. I have confirmed that the loader/nvram
files referenced do exist.

Running `qemu-system-aarch64 -L help` outputs two lines:

/opt/homebrew/Cellar/qemu/6.1.0_1/bin/../share/qemu-firmware
/opt/homebrew/Cellar/qemu/6.1.0_1/bin/../share/qemu

The …/share/qemu-firmware folder does NOT exist, but symlinking it to
a …/share/qemu/firmware folder which does exist does not improve the
situation.

I have also tried renaming the …/share/qemu/firmware folder (e.g. `mv
firmware zzz-firmware`) as some notes I found led me to believe that
libvirst might ignore my loader/nvram settings entirely if QEMU had
the "new" firmware JSON configuration stuff there? But again no
improvement….


How can I debug this further? What should I try next?

thanks,
-natevw


--- the test.xml domain configuration I am trying ---

&lt;domain type="qemu" xmlns:qemu="http://libvirt.org/schemas/domain/qemu/1.0"&gt;
  &lt;name&gt;test1&lt;/name&gt;
  &lt;uuid&gt;D45FCA3E-B873-4608-A0B8-3D8529E7CFB7&lt;/uuid&gt;
  &lt;memory unit="MiB"&gt;2048&lt;/memory&gt;
  &lt;cpu mode="host-model" check="partial" /&gt;
  &lt;vcpu&gt;2&lt;/vcpu&gt;
  &lt;clock offset="utc"/&gt;
  &lt;qemu:commandline&gt;
    &lt;qemu:arg value='-accel'/&gt;
    &lt;qemu:arg value='hvf'/&gt;
  &lt;/qemu:commandline&gt;
  &lt;os firmware="efi"&gt;
    &lt;type arch="aarch64" machine="virt"&gt;hvm&lt;/type&gt;
    &lt;loader readonly="yes" secure="no"
type="pflash"&gt;/opt/homebrew/share/qemu/edk2-aarch64-code.fd&lt;/loader&gt;
    &lt;nvram template="/opt/homebrew/share/qemu/edk2-arm-vars.fd"&gt;/Users/me/vm_testing/vm-test1.efi.fd&lt;/nvram&gt;
  &lt;bootmenu enable="no"/&gt;
    &lt;boot dev="hd"/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
    &lt;gic version="3"/&gt;
    &lt;pae/&gt;
  &lt;/features&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/opt/homebrew/bin/qemu-system-aarch64&lt;/emulator&gt;
    &lt;disk type="file" device="disk"&gt;
      &lt;driver name="qemu" type="qcow2"/&gt;
      &lt;source file="/Users/me/vm_testing/vm-test1.qcow2"/&gt;
      &lt;target dev="vda" bus="virtio"/&gt;
    &lt;/disk&gt;
    &lt;interface type="network"&gt;
      &lt;source network="default"/&gt;
      &lt;model type="virtio"/&gt;
    &lt;/interface&gt;
    &lt;console type="pty"&gt;
      &lt;target type="serial" port="0"/&gt;
    &lt;/console&gt;
    &lt;rng model="virtio"&gt;
      &lt;backend model="random"&gt;/dev/urandom&lt;/backend&gt;
    &lt;/rng&gt;
  &lt;/devices&gt;
&lt;/domain&gt;


</body></email><email><emailId>20211130135122</emailId><senderName>Richard Taubo</senderName><senderEmail>ort_libvirt@bergersen.no</senderEmail><timestampReceived>2021-11-30 13:51:22-0400</timestampReceived><subject>qemu-img create with preallocation=full and compression_type=zlib</subject><body>

Hi!

When running this command on Fedora 35 I get:
[#] qemu-img create -o preallocation=full -f qcow2 /var/vm_mail/mytest.qcow2 10GB
=&gt; Formatting '/var/vm_mail//mytest.qcow2', fmt=qcow2 . . . preallocation=full \
compression_type=zlib . . . ."

Question:
When using 'preallocation=full' I was surprised that the resulting qcow2 image \
includes the 'compression_type=zlib' part. Why/when is this compression used when the \
qcow2 image is fully preallocated?

Thanks for input on this! :-)

Best regards
Richard Taubo


</body></email><email><emailId>20211130142732</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-11-30 14:27:32-0400</timestampReceived><subject>Re: qemu-img create with preallocation=full and compression_type=zlib</subject><body>

On Tue, Nov 30, 2021 at 02:51:22PM +0100, Richard Taubo wrote:
&gt; Hi!
&gt; 
&gt; When running this command on Fedora 35 I get:
&gt; [#] qemu-img create -o preallocation=full -f qcow2 /var/vm_mail/mytest.qcow2 10GB
&gt; =&gt; Formatting '/var/vm_mail//mytest.qcow2', fmt=qcow2 . . . preallocation=full \
&gt; compression_type=zlib . . . ." 
&gt; Question:
&gt; When using 'preallocation=full' I was surprised that the resulting qcow2 image \
&gt; includes the 'compression_type=zlib' part. Why/when is this compression used when \
&gt; the qcow2 image is fully preallocated?

It doesn't mean the image is currently compressed.

Rather it just records the desired compression algorithm for this image,
if any future writes were to be told to use compression.

Regards,
Daniel
-- 
&gt; &gt; https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
&gt; &gt; https://libvirt.org         -o-            https://fstop138.berrange.com :|
&gt; &gt; https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|


</body></email><email><emailId>20211127070804</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-11-27 07:08:04-0400</timestampReceived><subject>Re: virsh create fails with "Unable to find any firmware to satisfy 'efi'" for aarch64 guest on macO</subject><body>

On 11/27/21 00:08, Nathan Vander Wilt wrote:
&gt; I am having trouble when I `virsh create test.xml` with an aarch64
&gt; guest on a macOS (Apple Silicon) host. I've wrestled with a variety of
&gt; issues but the one I simply haven't been able to get past is this
&gt; regarding the UEFI firmware:
&gt; 
&gt; error: Failed to create domain from test.xml
&gt; error: operation failed: Unable to find any firmware to satisfy 'efi'
&gt; &lt;
&gt; This is with `virsh --version` of 7.9.0 and `qemu-system-aarch64
&gt; --version` of 6.1.0, both installed via the common `brew` tool from
&gt; its main 'homebrew/core' tap. I have confirmed that the loader/nvram
&gt; files referenced do exist.
&gt; 
&gt; Running `qemu-system-aarch64 -L help` outputs two lines:
&gt; 
&gt; /opt/homebrew/Cellar/qemu/6.1.0_1/bin/../share/qemu-firmware
&gt; /opt/homebrew/Cellar/qemu/6.1.0_1/bin/../share/qemu
&gt; 
&gt; The …/share/qemu-firmware folder does NOT exist, but symlinking it to
&gt; a …/share/qemu/firmware folder which does exist does not improve the
&gt; situation.
&gt; 
&gt; I have also tried renaming the …/share/qemu/firmware folder (e.g. `mv
&gt; firmware zzz-firmware`) as some notes I found led me to believe that
&gt; libvirst might ignore my loader/nvram settings entirely if QEMU had
&gt; the "new" firmware JSON configuration stuff there? But again no
&gt; improvement….
&gt; 
&gt; 
&gt; How can I debug this further? What should I try next?
&gt; 
&gt; thanks,
&gt; -natevw
&gt; 
&gt; 
&gt; --- the test.xml domain configuration I am trying ---
&gt; 
&gt; &lt;domain type="qemu" xmlns:qemu="http://libvirt.org/schemas/domain/qemu/1.0"&gt;
&gt; &lt;name&gt;test1&lt;/name&gt;
&gt; &lt;uuid&gt;D45FCA3E-B873-4608-A0B8-3D8529E7CFB7&lt;/uuid&gt;
&gt; &lt;memory unit="MiB"&gt;2048&lt;/memory&gt;
&gt; &lt;cpu mode="host-model" check="partial" /&gt;
&gt; &lt;vcpu&gt;2&lt;/vcpu&gt;
&gt; &lt;clock offset="utc"/&gt;
&gt; &lt;qemu:commandline&gt;
&gt; &lt;qemu:arg value='-accel'/&gt;
&gt; &lt;qemu:arg value='hvf'/&gt;
&gt; &lt;/qemu:commandline&gt;
&gt; &lt;os firmware="efi"&gt;

Since you are providing the path to both UEFI image and varstore you can
drop this 'firmware="efi"' attribute. It's what's causing troubles here.

A short trip into not so distant past. UEFI was introduced to QEMU, so
libvirt came up with &lt;loader type="pflash&gt;/path/to/uefi&lt;/loader&gt; and
&lt;nvram/&gt; combo. This was suboptimal, because now users had to guess
which FW to select (because it depends on guest arch, secure boot
enabled, SMM mode, ...). So QEMU started shipping small, machine
readable files to each BIOS/UEFI image, which libvirt would parse and
pick the best one for given domain XML. And this is what firmware='efi'
controls. IOW, using firmware='efi' is incompatible with specifying
paths in &lt;loader/&gt; and &lt;nvram/&gt; and if you define this XML you'd see
that the paths are not formatted back (e.g. in virsh dumpxml).

&gt; &lt;type arch="aarch64" machine="virt"&gt;hvm&lt;/type&gt;
&gt; &lt;loader readonly="yes" secure="no"
&gt; type="pflash"&gt;/opt/homebrew/share/qemu/edk2-aarch64-code.fd&lt;/loader&gt;
&gt; &lt;nvram template="/opt/homebrew/share/qemu/edk2-arm-vars.fd"&gt;/Users/me/vm_testing/vm-test1.efi.fd&lt;/nvram&gt;
&gt;  &lt;bootmenu enable="no"/&gt;
&gt; &lt;boot dev="hd"/&gt;
&gt; &lt;/os&gt;
&gt; &lt;features&gt;
&gt; &lt;acpi/&gt;
&gt; &lt;gic version="3"/&gt;
&gt; &lt;pae/&gt;
&gt; &lt;/features&gt;
&gt; &lt;devices&gt;
&gt; &lt;emulator&gt;/opt/homebrew/bin/qemu-system-aarch64&lt;/emulator&gt;
&gt; &lt;disk type="file" device="disk"&gt;
&gt; &lt;driver name="qemu" type="qcow2"/&gt;
&gt; &lt;source file="/Users/me/vm_testing/vm-test1.qcow2"/&gt;
&gt; &lt;target dev="vda" bus="virtio"/&gt;
&gt; &lt;/disk&gt;
&gt; &lt;interface type="network"&gt;
&gt; &lt;source network="default"/&gt;
&gt; &lt;model type="virtio"/&gt;
&gt; &lt;/interface&gt;
&gt; &lt;console type="pty"&gt;
&gt; &lt;target type="serial" port="0"/&gt;
&gt; &lt;/console&gt;
&gt; &lt;rng model="virtio"&gt;
&gt; &lt;backend model="random"&gt;/dev/urandom&lt;/backend&gt;
&gt; &lt;/rng&gt;
&gt; &lt;/devices&gt;
&gt; &lt;/domain&gt;
&gt; 
&gt; 

Michal


</body></email><email><emailId>20211129102754</emailId><senderName>Ján Tomko</senderName><senderEmail>jtomko@redhat.com</senderEmail><timestampReceived>2021-11-29 10:27:54-0400</timestampReceived><subject>Re: virsh create fails with "Unable to find any firmware to satisfy 'efi'" for aarch64 guest on macO</subject><body>


On a Friday in 2021, Nathan Vander Wilt wrote:
&gt;I am having trouble when I `virsh create test.xml` with an aarch64
&gt;guest on a macOS (Apple Silicon) host. I've wrestled with a variety of
&gt;issues but the one I simply haven't been able to get past is this
&gt;regarding the UEFI firmware:
&gt;
&gt;error: Failed to create domain from test.xml
&gt;error: operation failed: Unable to find any firmware to satisfy 'efi'
&gt;
&gt;This is with `virsh --version` of 7.9.0 and `qemu-system-aarch64
&gt;--version` of 6.1.0, both installed via the common `brew` tool from
&gt;its main 'homebrew/core' tap. I have confirmed that the loader/nvram
&gt;files referenced do exist.
&gt;
&gt;Running `qemu-system-aarch64 -L help` outputs two lines:
&gt;
&gt;/opt/homebrew/Cellar/qemu/6.1.0_1/bin/../share/qemu-firmware
&gt;/opt/homebrew/Cellar/qemu/6.1.0_1/bin/../share/qemu
&gt;
&gt;The â€¦/share/qemu-firmware folder does NOT exist, but symlinking it to
&gt;a â€¦/share/qemu/firmware folder which does exist does not improve the
&gt;situation.
&gt;
&gt;I have also tried renaming the â€¦/share/qemu/firmware folder (e.g. `mv
&gt;firmware zzz-firmware`) as some notes I found led me to believe that
&gt;libvirst might ignore my loader/nvram settings entirely if QEMU had
&gt;the "new" firmware JSON configuration stuff there? But again no
&gt;improvementâ€¦.
&gt;
&gt;
&gt;How can I debug this further? What should I try next?
&gt;
&gt;thanks,
&gt;-natevw

Can you try with the latest libvirt?
7.10.0-rc2 was just tagged today and should be out this week:
https://listman.redhat.com/archives/libvirt-announce/2021-November/msg00002.html

Andrea did some fixes that are supposed to help with Apple Silicon:
https://gitlab.com/libvirt/libvirt/-/issues/168

Jano

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20211129163733</emailId><senderName>daggs</senderName><senderEmail>daggs@gmx.com</senderEmail><timestampReceived>2021-11-29 16:37:33-0400</timestampReceived><subject>migrate libvirt config between machines</subject><body>

Greetings,

I'd like to migrate my current libvirt config from one machine to another, what is the best way to do so?

Thanks

</body></email><email><emailId>20211130082836</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-11-30 08:28:36-0400</timestampReceived><subject>Re: migrate libvirt config between machines</subject><body>

On 11/29/21 17:37, daggs wrote:
&gt; Greetings,
&gt; 
&gt; I'd like to migrate my current libvirt config from one machine to another, what is \
&gt; the best way to do so? 
&gt; Thanks
&gt; 

Do you mean domain/network/... XMLs or {libvirtd,qemu,...}.config files?

For the former I suggest 'virsh dumpxml $dom &gt; dom.xml' and copying over
the file onto new machine and defining the domain again 'virsh define
dom.xml' (s/dumpxml/net-dumpxml/ and s/define/net-define/ for networks
and so on).

If you run new enough libvirt there's even 'virsh migrate --offline'
that encapsulates steps from above.

For the latter just copy over the files onto new machine.

In theory, copying over XMLs should work too, but we don't really like
seeing users touching those behind libvirt's back as 'virsh define' does
more than just saving the XML file.

Michal


</body></email><email><emailId>20211130115703</emailId><senderName>daggs</senderName><senderEmail>daggs@gmx.com</senderEmail><timestampReceived>2021-11-30 11:57:03-0400</timestampReceived><subject>Re: migrate libvirt config between machines</subject><body>

Greetings Michal,

&gt; Sent: Tuesday, November 30, 2021 at 10:28 AM
&gt; From: "Michal Prívozník" &lt;mprivozn@redhat.com&gt;
&gt; To: "daggs" &lt;daggs@gmx.com&gt;, libvirt-users@redhat.com
&gt; Subject: Re: migrate libvirt config between machines
&gt; 
&gt; On 11/29/21 17:37, daggs wrote:
&gt; &gt; Greetings,
&gt; &gt; 
&gt; &gt; I'd like to migrate my current libvirt config from one machine to another, what \
&gt; &gt; is the best way to do so? 
&gt; &gt; Thanks
&gt; &gt; 
&gt; 
&gt; Do you mean domain/network/... XMLs or {libvirtd,qemu,...}.config files?
&gt; 
&gt; For the former I suggest 'virsh dumpxml $dom &gt; dom.xml' and copying over
&gt; the file onto new machine and defining the domain again 'virsh define
&gt; dom.xml' (s/dumpxml/net-dumpxml/ and s/define/net-define/ for networks
&gt; and so on).
&gt; 
&gt; If you run new enough libvirt there's even 'virsh migrate --offline'
&gt; that encapsulates steps from above.
&gt; 
&gt; For the latter just copy over the files onto new machine.
&gt; 
&gt; In theory, copying over XMLs should work too, but we don't really like
&gt; seeing users touching those behind libvirt's back as 'virsh define' does
&gt; more than just saving the XML file.
&gt; 
&gt; Michal
&gt; 
&gt; 

I meant both.
the src machine runs libvirt 7.8.0, the dest runs 7.9.0

so virsh migrate --offline + copy /etc/libvirt?

Thanks,

Dagg


</body></email><email><emailId>20211130121100</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-11-30 12:11:00-0400</timestampReceived><subject>Re: migrate libvirt config between machines</subject><body>

On Tue, Nov 30, 2021 at 09:28:36AM +0100, Michal Prívozník wrote:
&gt; On 11/29/21 17:37, daggs wrote:
&gt; &gt; Greetings,
&gt; &gt; 
&gt; &gt; I'd like to migrate my current libvirt config from one machine to another, what \
&gt; &gt; is the best way to do so? 
&gt; &gt; Thanks
&gt; &gt; 
&gt; 
&gt; Do you mean domain/network/... XMLs or {libvirtd,qemu,...}.config files?
&gt; 
&gt; For the former I suggest 'virsh dumpxml $dom &gt; dom.xml' and copying over
&gt; the file onto new machine and defining the domain again 'virsh define
&gt; dom.xml' (s/dumpxml/net-dumpxml/ and s/define/net-define/ for networks
&gt; and so on).
&gt; 
&gt; If you run new enough libvirt there's even 'virsh migrate --offline'
&gt; that encapsulates steps from above.

NB, i'm not sure this is clever enough to copy across the TPM state or
the EDK variables state, if you're using such feature.


Regards,
Daniel
-- 
&gt; &gt; https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
&gt; &gt; https://libvirt.org         -o-            https://fstop138.berrange.com :|
&gt; &gt; https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|


</body></email><email><emailId>20211130053334</emailId><senderName>Nathan Vander Wilt</senderName><senderEmail>nate-lists@calftrail.com</senderEmail><timestampReceived>2021-11-30 05:33:34-0400</timestampReceived><subject>Re: virsh create fails with "Unable to find any firmware to satisfy 'efi'" for aarch64 guest on macO</subject><body>

On Fri, Nov 26, 2021 at 11:08 PM Michal Prívozník &lt;mprivozn@redhat.com&gt; wrote:
&gt; Since you are providing the path to both UEFI image and varstore you can
&gt; drop this 'firmware="efi"' attribute. It's what's causing troubles here.

Thank you, yes!

&gt; A short trip into not so distant past. UEFI was introduced to QEMU, so
&gt; libvirt came up with &lt;loader type="pflash&gt;/path/to/uefi&lt;/loader&gt; and
&gt; &lt;nvram/&gt; combo. This was suboptimal, because now users had to guess
&gt; which FW to select (because it depends on guest arch, secure boot
&gt; enabled, SMM mode, ...). So QEMU started shipping small, machine
&gt; readable files to each BIOS/UEFI image, which libvirt would parse and
&gt; pick the best one for given domain XML. And this is what firmware='efi'
&gt; controls. IOW, using firmware='efi' is incompatible with specifying
&gt; paths in &lt;loader/&gt; and &lt;nvram/&gt; and if you define this XML you'd see
&gt; that the paths are not formatted back (e.g. in virsh dumpxml).

Okay, yes this was unclear. It's not in the documentation afaict and I
saw some threads making it sound like it was the mere presence of the
JSON config files that made libvirt ignore any loader/nvram
configuration. But dropping the firmware attribute on the os element
was indeed the trick to get rid of the EFI error. Thanks for the
clarification!

regards,
-natevw


</body></email><email><emailId>20211130054943</emailId><senderName>Nathan Vander Wilt</senderName><senderEmail>nate-lists@calftrail.com</senderEmail><timestampReceived>2021-11-30 05:49:43-0400</timestampReceived><subject>Re: virsh create fails with "Unable to find any firmware to satisfy 'efi'" for aarch64 guest on macO</subject><body>

On Mon, Nov 29, 2021 at 2:28 AM Ján Tomko &lt;jtomko@redhat.com&gt; wrote:
&gt; Can you try with the latest libvirt?
&gt; 7.10.0-rc2 was just tagged today and should be out this week:
&gt; https://listman.redhat.com/archives/libvirt-announce/2021-November/msg00002.html

Ah, but it looks like the arm64 -&gt; VIR_ARCH_AARCH64 patch
(https://github.com/ihsakashi/libvirt/commit/0f062221ae23e6ea0ed5e6ba65d47395581cb143.patch)
is still in limbo? AFAICT that's the main issue I'm hitting now.

&gt; Andrea did some fixes that are supposed to help with Apple Silicon:
&gt; https://gitlab.com/libvirt/libvirt/-/issues/168

Yes, I happened to find that thread a little while after posting here
and it has lots of tips but didn't directly address my confusion
regarding how to manually specify the files. But based on the
"internal error: undefined hardware architecture" I'm now getting I
think I will need some of the patches.

For now I've just wrestled through direct usage of QEMU from the
command line as ironically this whole exercise was to try keeping
random build chains off my main "shiny new" macOS install itself.
Thanks for the pointers and glad these issues are gradually getting
worked out. I think I just must still be in the early adopters on the
M1 platform and hit some growing pains!

thanks again,
-natevw


</body></email><email><emailId>20211130083221</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-11-30 08:32:21-0400</timestampReceived><subject>Re: virsh create fails with "Unable to find any firmware to satisfy 'efi'" for aarch64 guest on macO</subject><body>

On 11/30/21 06:33, Nathan Vander Wilt wrote:
&gt; On Fri, Nov 26, 2021 at 11:08 PM Michal Prívozník &lt;mprivozn@redhat.com&gt; wrote:
&gt;&gt; Since you are providing the path to both UEFI image and varstore you can
&gt;&gt; drop this 'firmware="efi"' attribute. It's what's causing troubles here.
&gt; 
&gt; Thank you, yes!
&gt; 
&gt;&gt; A short trip into not so distant past. UEFI was introduced to QEMU, so
&gt;&gt; libvirt came up with &lt;loader type="pflash&gt;/path/to/uefi&lt;/loader&gt; and
&gt;&gt; &lt;nvram/&gt; combo. This was suboptimal, because now users had to guess
&gt;&gt; which FW to select (because it depends on guest arch, secure boot
&gt;&gt; enabled, SMM mode, ...). So QEMU started shipping small, machine
&gt;&gt; readable files to each BIOS/UEFI image, which libvirt would parse and
&gt;&gt; pick the best one for given domain XML. And this is what firmware='efi'
&gt;&gt; controls. IOW, using firmware='efi' is incompatible with specifying
&gt;&gt; paths in &lt;loader/&gt; and &lt;nvram/&gt; and if you define this XML you'd see
&gt;&gt; that the paths are not formatted back (e.g. in virsh dumpxml).
&gt; 
&gt; Okay, yes this was unclear. It's not in the documentation afaict and I
&gt; saw some threads making it sound like it was the mere presence of the
&gt; JSON config files that made libvirt ignore any loader/nvram
&gt; configuration. But dropping the firmware attribute on the os element
&gt; was indeed the trick to get rid of the EFI error. Thanks for the
&gt; clarification!

Yeah, writing documentation is hard. When doing so I tend to put myself
into shoes of an user, but in fact I can never escape my developer
mindset. What is obvious to me is not obvious to users, but at the same
time - I'm unable to realize that.

Having said that, if you have any suggestion, I'm more than happy to
work it in.

Michal

</body></email><email><emailId>20211130085438</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-11-30 08:54:38-0400</timestampReceived><subject>Re: virsh create fails with "Unable to find any firmware to satisfy 'efi'" for aarch64 guest on macO</subject><body>

On 11/30/21 06:49, Nathan Vander Wilt wrote:
&gt; On Mon, Nov 29, 2021 at 2:28 AM Ján Tomko &lt;jtomko@redhat.com&gt; wrote:
&gt;&gt; Can you try with the latest libvirt?
&gt;&gt; 7.10.0-rc2 was just tagged today and should be out this week:
&gt;&gt; https://listman.redhat.com/archives/libvirt-announce/2021-November/msg00002.html
&gt; 
&gt; Ah, but it looks like the arm64 -&gt; VIR_ARCH_AARCH64 patch
&gt; (https://github.com/ihsakashi/libvirt/commit/0f062221ae23e6ea0ed5e6ba65d47395581cb143.patch)
&gt; is still in limbo? AFAICT that's the main issue I'm hitting now.

Looking into virArchFromHost() I can see uname() called which is then
passed to virArchFromString(). In here, uname machine (which is
equivalent to 'uname -m' from shell) is compared against virArchData array:

https://gitlab.com/libvirt/libvirt/-/blob/master/src/util/virarch.c#L42

So what you are saying is that 'uname -m' reports arm64 and not aarch64?
If that's the case then we should revisit the patch you mention.

&gt; 
&gt;&gt; Andrea did some fixes that are supposed to help with Apple Silicon:
&gt;&gt; https://gitlab.com/libvirt/libvirt/-/issues/168
&gt; 
&gt; Yes, I happened to find that thread a little while after posting here
&gt; and it has lots of tips but didn't directly address my confusion
&gt; regarding how to manually specify the files. But based on the
&gt; "internal error: undefined hardware architecture" I'm now getting I
&gt; think I will need some of the patches.
&gt; 
&gt; For now I've just wrestled through direct usage of QEMU from the
&gt; command line as ironically this whole exercise was to try keeping
&gt; random build chains off my main "shiny new" macOS install itself.
&gt; Thanks for the pointers and glad these issues are gradually getting
&gt; worked out. I think I just must still be in the early adopters on the
&gt; M1 platform and hit some growing pains!

Yeah, unfortunately I don't have access to M1 yet so all I can give is
suggestions.

Michal

</body></email><email><emailId>20211130104007</emailId><senderName>Andrea Bolognani</senderName><senderEmail>abologna@redhat.com</senderEmail><timestampReceived>2021-11-30 10:40:07-0400</timestampReceived><subject>Re: virsh create fails with "Unable to find any firmware to satisfy 'efi'" for aarch64 guest on macO</subject><body>

On Tue, Nov 30, 2021 at 09:54:38AM +0100, Michal Prívozník wrote:
&gt; On 11/30/21 06:49, Nathan Vander Wilt wrote:
&gt; &gt; Ah, but it looks like the arm64 -&gt; VIR_ARCH_AARCH64 patch
&gt; &gt; is still in limbo? AFAICT that's the main issue I'm hitting now.

Unfortunately that's the case.

&gt; Looking into virArchFromHost() I can see uname() called which is then
&gt; passed to virArchFromString(). In here, uname machine (which is
&gt; equivalent to 'uname -m' from shell) is compared against virArchData array:
&gt;
&gt; https://gitlab.com/libvirt/libvirt/-/blob/master/src/util/virarch.c#L42
&gt;
&gt; So what you are saying is that 'uname -m' reports arm64 and not aarch64?
&gt; If that's the case then we should revisit the patch you mention.

Correct: on Apple Silicon Macs the architecture name is reported as
"arm64", but our code expects it to be "aarch64" because that's what
we get on Linux.

Michal, have you actually looked at the patch mentioned earlier? If
not, you can perhaps do a clean room implementation of the fix based
on the information provided above and get us out of this stalemate?

It's quite a simple change, but having seen the original patch I feel
like I couldn't possibly submit it myself and still be in the clear.

-- 
Andrea Bolognani / Red Hat / Virtualization


</body></email><email><emailId>20211130105743</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-11-30 10:57:43-0400</timestampReceived><subject>Re: virsh create fails with "Unable to find any firmware to satisfy 'efi'" for aarch64 guest on macO</subject><body>

On 11/30/21 11:40, Andrea Bolognani wrote:
&gt; On Tue, Nov 30, 2021 at 09:54:38AM +0100, Michal Prívozník wrote:
&gt;&gt; On 11/30/21 06:49, Nathan Vander Wilt wrote:
&gt;&gt;&gt; Ah, but it looks like the arm64 -&gt; VIR_ARCH_AARCH64 patch
&gt;&gt;&gt; is still in limbo? AFAICT that's the main issue I'm hitting now.
&gt; 
&gt; Unfortunately that's the case.
&gt; 
&gt;&gt; Looking into virArchFromHost() I can see uname() called which is then
&gt;&gt; passed to virArchFromString(). In here, uname machine (which is
&gt;&gt; equivalent to 'uname -m' from shell) is compared against virArchData array:
&gt;&gt;
&gt;&gt; https://gitlab.com/libvirt/libvirt/-/blob/master/src/util/virarch.c#L42
&gt;&gt;
&gt;&gt; So what you are saying is that 'uname -m' reports arm64 and not aarch64?
&gt;&gt; If that's the case then we should revisit the patch you mention.
&gt; 
&gt; Correct: on Apple Silicon Macs the architecture name is reported as
&gt; "arm64", but our code expects it to be "aarch64" because that's what
&gt; we get on Linux.
&gt; 
&gt; Michal, have you actually looked at the patch mentioned earlier? If
&gt; not, you can perhaps do a clean room implementation of the fix based
&gt; on the information provided above and get us out of this stalemate?
&gt; 
&gt; It's quite a simple change, but having seen the original patch I feel
&gt; like I couldn't possibly submit it myself and still be in the clear.
&gt; 

Unfortunately I did. But I think the whole area can be reworked a bit so
that we would detect both arm64 and aarch64 but in a different way than
the original patch.

Michal

</body></email><email><emailId>20211130110627</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-11-30 11:06:27-0400</timestampReceived><subject>Re: virsh create fails with "Unable to find any firmware to satisfy 'efi'" for aarch64 guest on macO</subject><body>

On Tue, Nov 30, 2021 at 02:40:07AM -0800, Andrea Bolognani wrote:
&gt; On Tue, Nov 30, 2021 at 09:54:38AM +0100, Michal Prívozník wrote:
&gt; &gt; On 11/30/21 06:49, Nathan Vander Wilt wrote:
&gt; &gt; &gt; Ah, but it looks like the arm64 -&gt; VIR_ARCH_AARCH64 patch
&gt; &gt; &gt; is still in limbo? AFAICT that's the main issue I'm hitting now.
&gt; 
&gt; Unfortunately that's the case.
&gt; 
&gt; &gt; Looking into virArchFromHost() I can see uname() called which is then
&gt; &gt; passed to virArchFromString(). In here, uname machine (which is
&gt; &gt; equivalent to 'uname -m' from shell) is compared against virArchData array:
&gt; &gt;
&gt; &gt; https://gitlab.com/libvirt/libvirt/-/blob/master/src/util/virarch.c#L42
&gt; &gt;
&gt; &gt; So what you are saying is that 'uname -m' reports arm64 and not aarch64?
&gt; &gt; If that's the case then we should revisit the patch you mention.
&gt; 
&gt; Correct: on Apple Silicon Macs the architecture name is reported as
&gt; "arm64", but our code expects it to be "aarch64" because that's what
&gt; we get on Linux.
&gt; 
&gt; Michal, have you actually looked at the patch mentioned earlier? If
&gt; not, you can perhaps do a clean room implementation of the fix based
&gt; on the information provided above and get us out of this stalemate?
&gt; 
&gt; It's quite a simple change, but having seen the original patch I feel
&gt; like I couldn't possibly submit it myself and still be in the clear.

We're over thinking things here. The way this change is implemented
is the only way anyone would write this code, and is a simple cut+paste
from the code pattern in the lines above so arguably already a derived
work. This is not a bit of code that meets the criteria to taint you
from a copyright POV.

I just implemented &amp; posted the obvious fix in virArch and it is
identical to the patch referenced earlier in this thread, rather
proving my point.

Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20211129182100</emailId><senderName>Andrea Bolognani</senderName><senderEmail>abologna@redhat.com</senderEmail><timestampReceived>2021-11-29 18:21:00-0400</timestampReceived><subject>Re: Fwd: Installing virtiofs drivers on Windows 11....</subject><body>

On Mon, Nov 29, 2021 at 06:15:40PM +0100, Mario Marietto wrote:
&gt; Hello to everyone.
&gt;
&gt; I'm testing Windows 11 with bhyve and I've found an annoying problem that
&gt; prevents me from completing some tasks that I'm working on.
&gt;
&gt; It seems that the virtio-9p driver does not work inside the Windows 11 os
&gt; emulated with bhyve and maybe also with qemu-kvm. When Windows 11 is
&gt; launched,I don't see the folder "mnt" mounted on the root folder of Windows
&gt; 11. Below you can see which bhyve parameters I've used :
&gt;
&gt; bhyve -S -c 4 -m 8G -w -H \
&gt; -s 0,hostbridge \
&gt; -s 1,ahci-cd,/home/marietto/Downloads/virtio/virtio-win-0.1.208.iso \
&gt; -s 2,ahci-hd,/mnt/da0p1/Backups/OS/bhyve/Windows/win11.img \
&gt; -s 3,fbuf,tcp=0.0.0.0:5900,w=1440,h=900,wait \
&gt; -s 8,virtio-net,tap0 \
&gt; ----&gt; -s 9,virtio-9p,sharename=/mnt \
&gt; -s 30,xhci,tablet \
&gt; -s 31,lpc \
&gt; -l bootrom,/usr/local/share/uefi-firmware/BHYVE_UEFI.fd \
&gt; vm0

You're cross-posting this to the libvirt users and virt-tools
developers list, and yet you seem to be running bhyve directly so
neither libvirt nor virt-manager are involved.

I assume that a support list for bhyve users exists. That would be
the appropriate forum to ask for help.

Anyway, since I'm already replying...

&gt; Investigating a little bit more and reading from this tutorial :
&gt;
&gt; https://virtio-fs.gitlab.io/howto-windows.html
&gt;
&gt; I've realized that there should be some problem with the WinFsp
&gt; &lt;http://www.secfs.net/winfsp&gt; - Windows File System Proxy and or with the
&gt; virtiofs PCI device driver because I'm not able to enable the virtiofs
&gt; service with the command used on the tutorial :
&gt;
&gt; C:\&gt; sc start VirtioFsSvc
&gt;
&gt; it gives the error : "the dependency service does not exist or it has
&gt; been marked for the elimination.

... I will point out that virtio-9p and virtiofs are two completely
different things. You've configured the former in the host, and are
trying to access data using the latter in the guest. That's not going
to work.

I could not find confirmation that either bhyve supports virtiofs or
that 9p can be used from Windows from a quick search. I'm afraid you
might be wading into entirely uncharted territory.

&gt; I've attached some screenshots to help you to understand what's happening.
&gt;
&gt; https://ibb.co/m5vm1hd
&gt; https://ibb.co/Qd6TS5d
&gt; https://ibb.co/3018SGd

I highly recommend changing your OS' language to English before
grabbing screenshots. Limiting the pool of people who might be able
to help you to those who can understand Italian is unlikely to make
things any easier for you ;)

-- 
Andrea Bolognani / Red Hat / Virtualization

</body></email><email><emailId>20211129190015</emailId><senderName>Mario Marietto</senderName><senderEmail>marietto2008@gmail.com</senderEmail><timestampReceived>2021-11-29 19:00:15-0400</timestampReceived><subject>Re: Fwd: Installing virtiofs drivers on Windows 11....</subject><body>

I've been lucky to find a compatriot :) Sometimes time happens and it makes
me feel happy. You are right. I got confused. I've thought virtio-9p
working depended on virtiofs working. Anyway, neither of those functions
works :( Anyway I'm not sure that the right place to ask this question is
the bhyve ML. It seems more a problem of Device drivers and Windows 11.



Il giorno lun 29 nov 2021 alle ore 19:21 Andrea Bolognani &lt;
abologna@redhat.com&gt; ha scritto:

&gt; On Mon, Nov 29, 2021 at 06:15:40PM +0100, Mario Marietto wrote:
&gt; &gt; Hello to everyone.
&gt; &gt;
&gt; &gt; I'm testing Windows 11 with bhyve and I've found an annoying problem that
&gt; &gt; prevents me from completing some tasks that I'm working on.
&gt; &gt;
&gt; &gt; It seems that the virtio-9p driver does not work inside the Windows 11 os
&gt; &gt; emulated with bhyve and maybe also with qemu-kvm. When Windows 11 is
&gt; &gt; launched,I don't see the folder "mnt" mounted on the root folder of
&gt; Windows
&gt; &gt; 11. Below you can see which bhyve parameters I've used :
&gt; &gt;
&gt; &gt; bhyve -S -c 4 -m 8G -w -H \
&gt; &gt; -s 0,hostbridge \
&gt; &gt; -s 1,ahci-cd,/home/marietto/Downloads/virtio/virtio-win-0.1.208.iso \
&gt; &gt; -s 2,ahci-hd,/mnt/da0p1/Backups/OS/bhyve/Windows/win11.img \
&gt; &gt; -s 3,fbuf,tcp=0.0.0.0:5900,w=1440,h=900,wait \
&gt; &gt; -s 8,virtio-net,tap0 \
&gt; &gt; ----&gt; -s 9,virtio-9p,sharename=/mnt \
&gt; &gt; -s 30,xhci,tablet \
&gt; &gt; -s 31,lpc \
&gt; &gt; -l bootrom,/usr/local/share/uefi-firmware/BHYVE_UEFI.fd \
&gt; &gt; vm0
&gt;
&gt; You're cross-posting this to the libvirt users and virt-tools
&gt; developers list, and yet you seem to be running bhyve directly so
&gt; neither libvirt nor virt-manager are involved.
&gt;
&gt; I assume that a support list for bhyve users exists. That would be
&gt; the appropriate forum to ask for help.
&gt;
&gt; Anyway, since I'm already replying...
&gt;
&gt; &gt; Investigating a little bit more and reading from this tutorial :
&gt; &gt;
&gt; &gt; https://virtio-fs.gitlab.io/howto-windows.html
&gt; &gt;
&gt; &gt; I've realized that there should be some problem with the WinFsp
&gt; &gt; &lt;http://www.secfs.net/winfsp&gt; - Windows File System Proxy and or with
&gt; the
&gt; &gt; virtiofs PCI device driver because I'm not able to enable the virtiofs
&gt; &gt; service with the command used on the tutorial :
&gt; &gt;
&gt; &gt; C:\&gt; sc start VirtioFsSvc
&gt; &gt;
&gt; &gt; it gives the error : "the dependency service does not exist or it has
&gt; &gt; been marked for the elimination.
&gt;
&gt; ... I will point out that virtio-9p and virtiofs are two completely
&gt; different things. You've configured the former in the host, and are
&gt; trying to access data using the latter in the guest. That's not going
&gt; to work.
&gt;
&gt; I could not find confirmation that either bhyve supports virtiofs or
&gt; that 9p can be used from Windows from a quick search. I'm afraid you
&gt; might be wading into entirely uncharted territory.
&gt;
&gt; &gt; I've attached some screenshots to help you to understand what's
&gt; happening.
&gt; &gt;
&gt; &gt; https://ibb.co/m5vm1hd
&gt; &gt; https://ibb.co/Qd6TS5d
&gt; &gt; https://ibb.co/3018SGd
&gt;
&gt; I highly recommend changing your OS' language to English before
&gt; grabbing screenshots. Limiting the pool of people who might be able
&gt; to help you to those who can understand Italian is unlikely to make
&gt; things any easier for you ;)
&gt;
&gt; --
&gt; Andrea Bolognani / Red Hat / Virtualization
&gt;
&gt;

-- 
Mario.

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;I've been lucky to find a &lt;span lang="en"&gt;compatriot :) Sometimes \
time happens and it makes me feel happy. You are right. I got confused. &lt;/span&gt;&lt;span \
lang="en"&gt;I've thought virtio-9p working depended on virtiofs working. \
Anyway,&lt;/span&gt;&lt;span lang="en"&gt; neither of those functions works :( Anyway I'm not \
sure that the right place to ask this question is the bhyve ML. It seems more a \
problem of Device drivers and Windows 11.&lt;/span&gt;&lt;span lang="en"&gt;&lt;/span&gt;&lt;span \
lang="en"&gt;&lt;/span&gt;&lt;span lang="en"&gt;&lt;/span&gt;&lt;div \
id="m_5926315520075304178gmail-tw-target-text-container"&gt;&lt;pre \
id="m_5926315520075304178gmail-tw-target-text" style="text-align:left" \
dir="ltr"&gt;&lt;span lang="en"&gt;&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;Il giorno lun 29 nov 2021 alle \
ore 19:21 Andrea Bolognani &lt;&lt;a href="mailto:abologna@redhat.com" \
target="_blank"&gt;abologna@redhat.com&lt;/a&gt;&gt; ha scritto:&lt;br&gt;&lt;/div&gt;&lt;blockquote \
class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid \
rgb(204,204,204);padding-left:1ex"&gt;On Mon, Nov 29, 2021 at 06:15:40PM +0100, Mario \
Marietto wrote:&lt;br&gt; &gt; Hello to everyone.&lt;br&gt;
&gt;&lt;br&gt;
&gt; I'm testing Windows 11 with bhyve and I've found an annoying problem \
that&lt;br&gt; &gt; prevents me from completing some tasks that I'm working on.&lt;br&gt;
&gt;&lt;br&gt;
&gt; It seems that the virtio-9p driver does not work inside the Windows 11 os&lt;br&gt;
&gt; emulated with bhyve and maybe also with qemu-kvm. When Windows 11 is&lt;br&gt;
&gt; launched,I don't see the folder "mnt" mounted on the root folder \
of Windows&lt;br&gt; &gt; 11. Below you can see which bhyve parameters I've used :&lt;br&gt;
&gt;&lt;br&gt;
&gt; bhyve -S -c 4 -m 8G -w -H \&lt;br&gt;
&gt; -s 0,hostbridge \&lt;br&gt;
&gt; -s 1,ahci-cd,/home/marietto/Downloads/virtio/virtio-win-0.1.208.iso \&lt;br&gt;
&gt; -s 2,ahci-hd,/mnt/da0p1/Backups/OS/bhyve/Windows/win11.img \&lt;br&gt;
&gt; -s 3,fbuf,tcp=&lt;a href="http://0.0.0.0:5900" rel="noreferrer" \
target="_blank"&gt;0.0.0.0:5900&lt;/a&gt;,w=1440,h=900,wait \&lt;br&gt; &gt; -s 8,virtio-net,tap0 \
\&lt;br&gt; &gt; ----&gt; -s 9,virtio-9p,sharename=/mnt \&lt;br&gt;
&gt; -s 30,xhci,tablet \&lt;br&gt;
&gt; -s 31,lpc \&lt;br&gt;
&gt; -l bootrom,/usr/local/share/uefi-firmware/BHYVE_UEFI.fd \&lt;br&gt;
&gt; vm0&lt;br&gt;
&lt;br&gt;
You're cross-posting this to the libvirt users and virt-tools&lt;br&gt;
developers list, and yet you seem to be running bhyve directly so&lt;br&gt;
neither libvirt nor virt-manager are involved.&lt;br&gt;
&lt;br&gt;
I assume that a support list for bhyve users exists. That would be&lt;br&gt;
the appropriate forum to ask for help.&lt;br&gt;
&lt;br&gt;
Anyway, since I'm already replying...&lt;br&gt;
&lt;br&gt;
&gt; Investigating a little bit more and reading from this tutorial :&lt;br&gt;
&gt;&lt;br&gt;
&gt; &lt;a href="https://virtio-fs.gitlab.io/howto-windows.html" rel="noreferrer" \
target="_blank"&gt;https://virtio-fs.gitlab.io/howto-windows.html&lt;/a&gt;&lt;br&gt; &gt;&lt;br&gt;
&gt; I've realized that there should be some problem with the WinFsp&lt;br&gt;
&gt; &lt;&lt;a href="http://www.secfs.net/winfsp" rel="noreferrer" \
target="_blank"&gt;http://www.secfs.net/winfsp&lt;/a&gt;&gt; - Windows File System Proxy and \
or with the&lt;br&gt; &gt; virtiofs PCI device driver because I'm not able to enable \
the virtiofs&lt;br&gt; &gt; service with the command used on the tutorial :&lt;br&gt;
&gt;&lt;br&gt;
&gt; C:\&gt; sc start VirtioFsSvc&lt;br&gt;
&gt;&lt;br&gt;
&gt; it gives the error : "the dependency service does not exist or it has&lt;br&gt;
&gt; been marked for the elimination.&lt;br&gt;
&lt;br&gt;
... I will point out that virtio-9p and virtiofs are two completely&lt;br&gt;
different things. You've configured the former in the host, and are&lt;br&gt;
trying to access data using the latter in the guest. That's not going&lt;br&gt;
to work.&lt;br&gt;
&lt;br&gt;
I could not find confirmation that either bhyve supports virtiofs or&lt;br&gt;
that 9p can be used from Windows from a quick search. I'm afraid you&lt;br&gt;
might be wading into entirely uncharted territory.&lt;br&gt;
&lt;br&gt;
&gt; I've attached some screenshots to help you to understand what's \
happening.&lt;br&gt; &gt;&lt;br&gt;
&gt; &lt;a href="https://ibb.co/m5vm1hd" rel="noreferrer" \
target="_blank"&gt;https://ibb.co/m5vm1hd&lt;/a&gt;&lt;br&gt; &gt; &lt;a href="https://ibb.co/Qd6TS5d" \
rel="noreferrer" target="_blank"&gt;https://ibb.co/Qd6TS5d&lt;/a&gt;&lt;br&gt; &gt; &lt;a \
href="https://ibb.co/3018SGd" rel="noreferrer" \
target="_blank"&gt;https://ibb.co/3018SGd&lt;/a&gt;&lt;br&gt; &lt;br&gt;
I highly recommend changing your OS' language to English before&lt;br&gt;
grabbing screenshots. Limiting the pool of people who might be able&lt;br&gt;
to help you to those who can understand Italian is unlikely to make&lt;br&gt;
things any easier for you ;)&lt;br&gt;
&lt;br&gt;
-- &lt;br&gt;
Andrea Bolognani / Red Hat / Virtualization&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;&lt;div dir="ltr"&gt;Mario.&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20211130085027</emailId><senderName>Andrea Bolognani</senderName><senderEmail>abologna@redhat.com</senderEmail><timestampReceived>2021-11-30 08:50:27-0400</timestampReceived><subject>Re: Fwd: Installing virtiofs drivers on Windows 11....</subject><body>

On Mon, Nov 29, 2021 at 08:00:15PM +0100, Mario Marietto wrote:
&gt; I've been lucky to find a compatriot :) Sometimes time happens and it makes
&gt; me feel happy. You are right. I got confused. I've thought virtio-9p
&gt; working depended on virtiofs working. Anyway, neither of those functions
&gt; works :( Anyway I'm not sure that the right place to ask this question is
&gt; the bhyve ML. It seems more a problem of Device drivers and Windows 11.

I think it might be worth a shot. Hopefully FreeBSD is planning to
implement virtiofs support in bhyve at some point in the not too
distant future, but in the meantime other users might be able to
suggest alternative ways to implement host/guest file sharing.

Good luck!

-- 
Andrea Bolognani / Red Hat / Virtualization

</body></email><email><emailId>20211130090904</emailId><senderName>Mario Marietto</senderName><senderEmail>marietto2008@gmail.com</senderEmail><timestampReceived>2021-11-30 09:09:04-0400</timestampReceived><subject>Re: Fwd: Installing virtiofs drivers on Windows 11....</subject><body>

I'm confused. Anyway,since I don't know how it works virtiofs,I'm using
virtio-9p every day. So I can say that bhyve already supports virtio-9p.
This is how I make it work under Linux :

-s 8,virtio-9p,sharename=&lt;host-dir-path&gt;

In the guest I need something like :

mount -t 9p -o trans=virtio,version=9p2000.L,rw sharename /mnt

I assume that what's missing on Windows 10 is only the ability to mount the
shared folder. Since mount is a linux command and windows 10 / 11 supports
linux with it's proper kernel,a good idea could be to try to mount the
shared resource within the WSL2  :)


Il giorno mar 30 nov 2021 alle ore 09:50 Andrea Bolognani &lt;
abologna@redhat.com&gt; ha scritto:

&gt; On Mon, Nov 29, 2021 at 08:00:15PM +0100, Mario Marietto wrote:
&gt; &gt; I've been lucky to find a compatriot :) Sometimes time happens and it
&gt; makes
&gt; &gt; me feel happy. You are right. I got confused. I've thought virtio-9p
&gt; &gt; working depended on virtiofs working. Anyway, neither of those functions
&gt; &gt; works :( Anyway I'm not sure that the right place to ask this question is
&gt; &gt; the bhyve ML. It seems more a problem of Device drivers and Windows 11.
&gt;
&gt; I think it might be worth a shot. Hopefully FreeBSD is planning to
&gt; implement virtiofs support in bhyve at some point in the not too
&gt; distant future, but in the meantime other users might be able to
&gt; suggest alternative ways to implement host/guest file sharing.
&gt;
&gt; Good luck!
&gt;
&gt; --
&gt; Andrea Bolognani / Red Hat / Virtualization
&gt;
&gt;

-- 
Mario.

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div&gt;I'm confused. Anyway,since I don't know how it works \
virtiofs,I'm using virtio-9p every day. So I can say that bhyve already supports \
virtio-9p. This is how I make it work under Linux :&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-s \
8,virtio-9p,sharename=&lt;host-dir-path&gt;&lt;/div&gt;&lt;br&gt;In the guest I need something \
like :&lt;br&gt;&lt;br&gt;&lt;div&gt;mount -t 9p -o &lt;span \
class="gmail-il"&gt;trans&lt;/span&gt;=virtio,version=9p2000.L,rw sharename \
/mnt&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I assume that what's missing on Windows 10 is only \
the ability to mount the shared folder. Since mount is a linux command and windows 10 \
/ 11 supports linux with it's proper kernel,a good idea could be to try to mount \
the shared resource within the WSL2   :) \
&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" \
class="gmail_attr"&gt;Il giorno mar 30 nov 2021 alle ore 09:50 Andrea Bolognani &lt;&lt;a \
href="mailto:abologna@redhat.com" target="_blank"&gt;abologna@redhat.com&lt;/a&gt;&gt; ha \
scritto:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;On Mon, Nov 29, 2021 \
at 08:00:15PM +0100, Mario Marietto wrote:&lt;br&gt; &gt; I've been lucky to find a \
compatriot :) Sometimes time happens and it makes&lt;br&gt; &gt; me feel happy. You are \
right. I got confused. I've thought virtio-9p&lt;br&gt; &gt; working depended on \
virtiofs working. Anyway, neither of those functions&lt;br&gt; &gt; works :( Anyway I'm \
not sure that the right place to ask this question is&lt;br&gt; &gt; the bhyve ML. It seems \
more a problem of Device drivers and Windows 11.&lt;br&gt; &lt;br&gt;
I think it might be worth a shot. Hopefully FreeBSD is planning to&lt;br&gt;
implement virtiofs support in bhyve at some point in the not too&lt;br&gt;
distant future, but in the meantime other users might be able to&lt;br&gt;
suggest alternative ways to implement host/guest file sharing.&lt;br&gt;
&lt;br&gt;
Good luck!&lt;br&gt;
&lt;br&gt;
-- &lt;br&gt;
Andrea Bolognani / Red Hat / Virtualization&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;&lt;div dir="ltr"&gt;Mario.&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20211130091532</emailId><senderName>Mario Marietto</senderName><senderEmail>marietto2008@gmail.com</senderEmail><timestampReceived>2021-11-30 09:15:32-0400</timestampReceived><subject>Re: Fwd: Installing virtiofs drivers on Windows 11....</subject><body>

ok I can't because bhyve does not support nested virtualization. sorry for
the mistake.

Il giorno mar 30 nov 2021 alle ore 10:09 Mario Marietto &lt;
marietto2008@gmail.com&gt; ha scritto:

&gt; I'm confused. Anyway,since I don't know how it works virtiofs,I'm using
&gt; virtio-9p every day. So I can say that bhyve already supports virtio-9p.
&gt; This is how I make it work under Linux :
&gt;
&gt; -s 8,virtio-9p,sharename=&lt;host-dir-path&gt;
&gt;
&gt; In the guest I need something like :
&gt;
&gt; mount -t 9p -o trans=virtio,version=9p2000.L,rw sharename /mnt
&gt;
&gt; I assume that what's missing on Windows 10 is only the ability to mount
&gt; the shared folder. Since mount is a linux command and windows 10 / 11
&gt; supports linux with it's proper kernel,a good idea could be to try to mount
&gt; the shared resource within the WSL2  :)
&gt;
&gt;
&gt; Il giorno mar 30 nov 2021 alle ore 09:50 Andrea Bolognani &lt;
&gt; abologna@redhat.com&gt; ha scritto:
&gt;
&gt;&gt; On Mon, Nov 29, 2021 at 08:00:15PM +0100, Mario Marietto wrote:
&gt;&gt; &gt; I've been lucky to find a compatriot :) Sometimes time happens and it
&gt;&gt; makes
&gt;&gt; &gt; me feel happy. You are right. I got confused. I've thought virtio-9p
&gt;&gt; &gt; working depended on virtiofs working. Anyway, neither of those functions
&gt;&gt; &gt; works :( Anyway I'm not sure that the right place to ask this question
&gt;&gt; is
&gt;&gt; &gt; the bhyve ML. It seems more a problem of Device drivers and Windows 11.
&gt;&gt;
&gt;&gt; I think it might be worth a shot. Hopefully FreeBSD is planning to
&gt;&gt; implement virtiofs support in bhyve at some point in the not too
&gt;&gt; distant future, but in the meantime other users might be able to
&gt;&gt; suggest alternative ways to implement host/guest file sharing.
&gt;&gt;
&gt;&gt; Good luck!
&gt;&gt;
&gt;&gt; --
&gt;&gt; Andrea Bolognani / Red Hat / Virtualization
&gt;&gt;
&gt;&gt;
&gt;
&gt; --
&gt; Mario.
&gt;


-- 
Mario.

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;ok I can't because bhyve does not support nested virtualization. \
sorry for the mistake.&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" \
class="gmail_attr"&gt;Il giorno mar 30 nov 2021 alle ore 10:09 Mario Marietto &lt;&lt;a \
href="mailto:marietto2008@gmail.com"&gt;marietto2008@gmail.com&lt;/a&gt;&gt; ha \
scritto:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;&lt;div \
dir="ltr"&gt;&lt;div&gt;I'm confused. Anyway,since I don't know how it works \
virtiofs,I'm using virtio-9p every day. So I can say that bhyve already supports \
virtio-9p. This is how I make it work under Linux :&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-s \
8,virtio-9p,sharename=&lt;host-dir-path&gt;&lt;/div&gt;&lt;br&gt;In the guest I need something \
like :&lt;br&gt;&lt;br&gt;&lt;div&gt;mount -t 9p -o &lt;span&gt;trans&lt;/span&gt;=virtio,version=9p2000.L,rw \
sharename /mnt&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I assume that what's missing on Windows \
10 is only the ability to mount the shared folder. Since mount is a linux command and \
windows 10 / 11 supports linux with it's proper kernel,a good idea could be to \
try to mount the shared resource within the WSL2   :) \
&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" \
class="gmail_attr"&gt;Il giorno mar 30 nov 2021 alle ore 09:50 Andrea Bolognani &lt;&lt;a \
href="mailto:abologna@redhat.com" target="_blank"&gt;abologna@redhat.com&lt;/a&gt;&gt; ha \
scritto:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;On Mon, Nov 29, 2021 \
at 08:00:15PM +0100, Mario Marietto wrote:&lt;br&gt; &gt; I've been lucky to find a \
compatriot :) Sometimes time happens and it makes&lt;br&gt; &gt; me feel happy. You are \
right. I got confused. I've thought virtio-9p&lt;br&gt; &gt; working depended on \
virtiofs working. Anyway, neither of those functions&lt;br&gt; &gt; works :( Anyway I'm \
not sure that the right place to ask this question is&lt;br&gt; &gt; the bhyve ML. It seems \
more a problem of Device drivers and Windows 11.&lt;br&gt; &lt;br&gt;
I think it might be worth a shot. Hopefully FreeBSD is planning to&lt;br&gt;
implement virtiofs support in bhyve at some point in the not too&lt;br&gt;
distant future, but in the meantime other users might be able to&lt;br&gt;
suggest alternative ways to implement host/guest file sharing.&lt;br&gt;
&lt;br&gt;
Good luck!&lt;br&gt;
&lt;br&gt;
-- &lt;br&gt;
Andrea Bolognani / Red Hat / Virtualization&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;&lt;div dir="ltr"&gt;Mario.&lt;br&gt;&lt;/div&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;&lt;div dir="ltr" \
class="gmail_signature"&gt;Mario.&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20211130093147</emailId><senderName>Mario Marietto</senderName><senderEmail>marietto2008@gmail.com</senderEmail><timestampReceived>2021-11-30 09:31:47-0400</timestampReceived><subject>Re: Fwd: Installing virtiofs drivers on Windows 11....</subject><body>

It seems that it can work on Windows guest. Did you miss this thread ?

https://github.com/virtio-win/kvm-guest-drivers-windows/issues/126#

Il giorno mar 30 nov 2021 alle ore 10:15 Mario Marietto &lt;
marietto2008@gmail.com&gt; ha scritto:

&gt; ok I can't because bhyve does not support nested virtualization. sorry for
&gt; the mistake.
&gt;
&gt; Il giorno mar 30 nov 2021 alle ore 10:09 Mario Marietto &lt;
&gt; marietto2008@gmail.com&gt; ha scritto:
&gt;
&gt;&gt; I'm confused. Anyway,since I don't know how it works virtiofs,I'm using
&gt;&gt; virtio-9p every day. So I can say that bhyve already supports virtio-9p.
&gt;&gt; This is how I make it work under Linux :
&gt;&gt;
&gt;&gt; -s 8,virtio-9p,sharename=&lt;host-dir-path&gt;
&gt;&gt;
&gt;&gt; In the guest I need something like :
&gt;&gt;
&gt;&gt; mount -t 9p -o trans=virtio,version=9p2000.L,rw sharename /mnt
&gt;&gt;
&gt;&gt; I assume that what's missing on Windows 10 is only the ability to mount
&gt;&gt; the shared folder. Since mount is a linux command and windows 10 / 11
&gt;&gt; supports linux with it's proper kernel,a good idea could be to try to mount
&gt;&gt; the shared resource within the WSL2  :)
&gt;&gt;
&gt;&gt;
&gt;&gt; Il giorno mar 30 nov 2021 alle ore 09:50 Andrea Bolognani &lt;
&gt;&gt; abologna@redhat.com&gt; ha scritto:
&gt;&gt;
&gt;&gt;&gt; On Mon, Nov 29, 2021 at 08:00:15PM +0100, Mario Marietto wrote:
&gt;&gt;&gt; &gt; I've been lucky to find a compatriot :) Sometimes time happens and it
&gt;&gt;&gt; makes
&gt;&gt;&gt; &gt; me feel happy. You are right. I got confused. I've thought virtio-9p
&gt;&gt;&gt; &gt; working depended on virtiofs working. Anyway, neither of those
&gt;&gt;&gt; functions
&gt;&gt;&gt; &gt; works :( Anyway I'm not sure that the right place to ask this question
&gt;&gt;&gt; is
&gt;&gt;&gt; &gt; the bhyve ML. It seems more a problem of Device drivers and Windows 11.
&gt;&gt;&gt;
&gt;&gt;&gt; I think it might be worth a shot. Hopefully FreeBSD is planning to
&gt;&gt;&gt; implement virtiofs support in bhyve at some point in the not too
&gt;&gt;&gt; distant future, but in the meantime other users might be able to
&gt;&gt;&gt; suggest alternative ways to implement host/guest file sharing.
&gt;&gt;&gt;
&gt;&gt;&gt; Good luck!
&gt;&gt;&gt;
&gt;&gt;&gt; --
&gt;&gt;&gt; Andrea Bolognani / Red Hat / Virtualization
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt; --
&gt;&gt; Mario.
&gt;&gt;
&gt;
&gt;
&gt; --
&gt; Mario.
&gt;


-- 
Mario.

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div&gt;It seems that it can work on Windows guest. Did you miss this \
thread ?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;a \
href="https://github.com/virtio-win/kvm-guest-drivers-windows/issues/126#"&gt;https://github.com/virtio-win/kvm-guest-drivers-windows/issues/126#&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;Il giorno mar 30 nov 2021 alle \
ore 10:15 Mario Marietto &lt;&lt;a \
href="mailto:marietto2008@gmail.com"&gt;marietto2008@gmail.com&lt;/a&gt;&gt; ha \
scritto:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;&lt;div dir="ltr"&gt;ok I \
can't because bhyve does not support nested virtualization. sorry for the \
mistake.&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;Il \
giorno mar 30 nov 2021 alle ore 10:09 Mario Marietto &lt;&lt;a \
href="mailto:marietto2008@gmail.com" target="_blank"&gt;marietto2008@gmail.com&lt;/a&gt;&gt; \
ha scritto:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;&lt;div \
dir="ltr"&gt;&lt;div&gt;I'm confused. Anyway,since I don't know how it works \
virtiofs,I'm using virtio-9p every day. So I can say that bhyve already supports \
virtio-9p. This is how I make it work under Linux :&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-s \
8,virtio-9p,sharename=&lt;host-dir-path&gt;&lt;/div&gt;&lt;br&gt;In the guest I need something \
like :&lt;br&gt;&lt;br&gt;&lt;div&gt;mount -t 9p -o &lt;span&gt;trans&lt;/span&gt;=virtio,version=9p2000.L,rw \
sharename /mnt&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I assume that what's missing on Windows \
10 is only the ability to mount the shared folder. Since mount is a linux command and \
windows 10 / 11 supports linux with it's proper kernel,a good idea could be to \
try to mount the shared resource within the WSL2   :) \
&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" \
class="gmail_attr"&gt;Il giorno mar 30 nov 2021 alle ore 09:50 Andrea Bolognani &lt;&lt;a \
href="mailto:abologna@redhat.com" target="_blank"&gt;abologna@redhat.com&lt;/a&gt;&gt; ha \
scritto:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;On Mon, Nov 29, 2021 \
at 08:00:15PM +0100, Mario Marietto wrote:&lt;br&gt; &gt; I've been lucky to find a \
compatriot :) Sometimes time happens and it makes&lt;br&gt; &gt; me feel happy. You are \
right. I got confused. I've thought virtio-9p&lt;br&gt; &gt; working depended on \
virtiofs working. Anyway, neither of those functions&lt;br&gt; &gt; works :( Anyway I'm \
not sure that the right place to ask this question is&lt;br&gt; &gt; the bhyve ML. It seems \
more a problem of Device drivers and Windows 11.&lt;br&gt; &lt;br&gt;
I think it might be worth a shot. Hopefully FreeBSD is planning to&lt;br&gt;
implement virtiofs support in bhyve at some point in the not too&lt;br&gt;
distant future, but in the meantime other users might be able to&lt;br&gt;
suggest alternative ways to implement host/guest file sharing.&lt;br&gt;
&lt;br&gt;
Good luck!&lt;br&gt;
&lt;br&gt;
-- &lt;br&gt;
Andrea Bolognani / Red Hat / Virtualization&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;&lt;div dir="ltr"&gt;Mario.&lt;br&gt;&lt;/div&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;&lt;div dir="ltr"&gt;Mario.&lt;br&gt;&lt;/div&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;&lt;div dir="ltr" \
class="gmail_signature"&gt;Mario.&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20211124150134</emailId><senderName>Elias Mobery</senderName><senderEmail>eliasmobery@gmail.com</senderEmail><timestampReceived>2021-11-24 15:01:34-0400</timestampReceived><subject>Re: Libvirt + Debian Live = Heart Attack</subject><body>

Hello Michal, thank you for the reply!

I've carefully tested everything you suggested, thanks.

I set dynamic_ownership=0 and use these hooks during the live build for
permissions. (I googled a lot, and apparently libvirt needs the images to
be executable too)

chown -R libvirt-qemu:kvm  /var/lib/libvirt/images
chmod -R g+rwx /var/lib/libvirt/images

Booting the live debian iso everything works in virt-manager, but again,
after clicking "run", a copy of the vm image is created in
/run/live/overlay/rw/var/lib/libvirt/images and only then does the VM start.

Either it's still being chowned or chmodded somehow, or it's something
else, but I can't stop this copy being made.

Interestingly, when I boot the Live debian iso and then copy the images
into /var/lib/libvirt/images from my USB stick, the VM starts immediately
without creating any copies in the /run/live.... directory. So my guess is
that maybe the squashfs could be the issue?

Editing the XML

&lt;source file='/var/lib/libvirt/images/vm1.qcow2'&gt;
      &lt;seclabel relabel='no'/&gt;
    &lt;/source&gt;

This results in an error:
Unsupported Configuration:
Security driver model 'null' not available

Here I tried setting security_driver=none in qemu.conf but same error after.

&lt;/devices&gt;
    &lt;seclabel type='none'/&gt;
  &lt;/domain&gt;

This also returns an Error but I'm still googling to understand it properly.

XML document failed to validate against schema
Unable to validate doc against /usr/share/libvirt/schemas/domain.rng
Invalid element relabel  for element seclabel
Extra element seclabel in interleave
Element domain failed to validate content

Thanks again so much for your helo, I've been messing with this for weeks
now and it's killing me.

On Tue, Nov 23, 2021, 9:43 PM Michal Prívozník &lt;mprivozn@redhat.com&gt; wrote:

&gt; On 11/23/21 17:25, Elias Mobery wrote:
&gt; &gt;
&gt; &gt; Hi everyone!
&gt; &gt;
&gt; &gt; I've built a Debian Live ISO with packages qemu and libvirt to run a VM
&gt; &gt; in the live environment.
&gt; &gt;
&gt; &gt; The guest images are placed in  /var/lib/libvirt/images and 2GB each.
&gt; &gt;
&gt; &gt; Everything works great, except for one issue.
&gt; &gt;
&gt; &gt; When starting a VM, libvirt automatically issues a chown command to the
&gt; &gt; images, changing ownership.
&gt; &gt;
&gt; &gt; This results in a copy of the images being created in
&gt; &gt; /run/live/overlay/rw/var/lib/libvirt/images
&gt; &gt;
&gt; &gt; I don't want these copies to be made but can't stop it.
&gt; &gt;
&gt; &gt; I've tried editing qemu.conf user/group, dynamic ownership etc. without
&gt; &gt; any luck.
&gt; &gt;
&gt; &gt; Is there a way to STOP libvirt from changing the ownership of these
&gt; images?
&gt; &gt;
&gt; &gt;
&gt;
&gt; Setting dynamic_ownership=0 in qemu.conf is the way to go (don't forget
&gt; to restart the daemon after you made the change).
&gt;
&gt; Alternatively, you can set &lt;seclabel/&gt; either for whole domain or
&gt; individual disks, e.g. like this:
&gt;
&gt;   &lt;disk type='file' device='disk'&gt;
&gt;     &lt;driver name='qemu' type='qcow2'/&gt;
&gt;     &lt;source file='/var/lib/libvirt/images/vm1.qcow2'&gt;
&gt;       &lt;seclabel relabel='no'/&gt;
&gt;     &lt;/source&gt;
&gt;   &lt;/disk&gt;
&gt;
&gt; or for whole domain:
&gt;
&gt;     ...
&gt;     &lt;/devices&gt;
&gt;     &lt;seclabel type='none'/&gt;
&gt;   &lt;/domain&gt;
&gt;
&gt; I'm not sure what your setup is, but if chown() is a problem then what
&gt; if guest tries to write onto its disk? Wouldn't that create a copy in
&gt; overlay?
&gt;
&gt; Michal
&gt;
&gt;

[Attachment #3 (text/html)]

&lt;div dir="auto"&gt;Hello Michal, thank you for the reply!&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
dir="auto"&gt;I've carefully tested everything you suggested, thanks.&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;I set dynamic_ownership=0 and use these hooks \
during the live build for permissions. (I googled a lot, and apparently libvirt needs \
the images to be executable too)&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;span style="background-color:rgb(255,255,255)"&gt;chown -R libvirt-qemu:kvm  \
/var/lib/libvirt/images&lt;/span&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;span \
style="background-color:rgb(255,255,255)"&gt;chmod -R g+rwx \
/var/lib/libvirt/images&lt;/span&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;Booting the live debian \
iso everything works in virt-manager, but again, after clicking "run", a \
copy of the vm image is created in /run/live/overlay/rw/var/lib/libvirt/images and \
only then does the VM start.&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;Either it's \
still being chowned or chmodded somehow, or it's something else, but I can't \
stop this copy being made.&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
dir="auto"&gt;Interestingly, when I boot the Live debian iso and then copy the images \
into /var/lib/libvirt/images from my USB stick, the VM starts immediately without \
creating any copies in the /run/live.... directory. So my guess is that maybe the \
squashfs could be the issue?&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;Editing \
the XML&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;span \
style="font-family:sans-serif"&gt;&lt;source \
file='/var/lib/libvirt/images/&lt;/span&gt;&lt;span \
style="font-family:sans-serif"&gt;vm1.qcow2'&gt;&lt;/span&gt;&lt;br \
style="font-family:sans-serif"&gt;&lt;span style="font-family:sans-serif"&gt;         \
&lt;seclabel relabel='no'/&gt;&lt;/span&gt;&lt;br style="font-family:sans-serif"&gt;&lt;span \
style="font-family:sans-serif"&gt;      &lt;/source&gt;&lt;/span&gt;&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;font face="sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;font \
face="sans-serif"&gt;This results in an error:&lt;/font&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;font \
face="sans-serif"&gt;Unsupported Configuration:&lt;/font&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;font \
face="sans-serif"&gt;Security driver model 'null' not available&lt;/font&gt;&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;font face="sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;font \
face="sans-serif"&gt;Here I tried setting security_driver=none in qemu.conf but same \
error after.&lt;/font&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;font \
face="sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;div \
dir="auto"&gt;&lt;/devices&gt;&lt;/div&gt;&lt;div dir="auto"&gt;      &lt;seclabel \
type='none'/&gt;&lt;/div&gt;&lt;div dir="auto"&gt;   &lt;/domain&gt;&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;This also returns an Error but I'm still \
googling to understand it properly.&lt;/div&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;font face="sans-serif"&gt;XML document failed to validate against \
schema&lt;/font&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;font face="sans-serif"&gt;Unable to validate doc \
against /usr/share/libvirt/schemas/domain.rng&lt;/font&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;font \
face="sans-serif"&gt;Invalid element relabel   for element seclabel&lt;/font&gt;&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;font face="sans-serif"&gt;Extra element seclabel in \
interleave&lt;/font&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;font face="sans-serif"&gt;Element domain failed \
to validate content&lt;/font&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;font \
face="sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;font face="sans-serif"&gt;Thanks \
again so much for your helo, I've been messing with this for weeks now and \
it's killing me.&lt;br&gt;&lt;/font&gt;&lt;br&gt;&lt;div class="gmail_quote" dir="auto"&gt;&lt;div dir="ltr" \
class="gmail_attr"&gt;On Tue, Nov 23, 2021, 9:43 PM Michal Prívozník &lt;&lt;a \
href="mailto:mprivozn@redhat.com"&gt;mprivozn@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 \
.8ex;border-left:1px #ccc solid;padding-left:1ex"&gt;On 11/23/21 17:25, Elias Mobery \
wrote:&lt;br&gt; &gt; &lt;br&gt;
&gt; Hi everyone!&lt;br&gt;
&gt; &lt;br&gt;
&gt; I've built a Debian Live ISO with packages qemu and libvirt to run a VM&lt;br&gt;
&gt; in the live environment.&lt;br&gt;
&gt; &lt;br&gt;
&gt; The guest images are placed in   /var/lib/libvirt/images and 2GB each.&lt;br&gt;
&gt; &lt;br&gt;
&gt; Everything works great, except for one issue.&lt;br&gt;
&gt; &lt;br&gt;
&gt; When starting a VM, libvirt automatically issues a chown command to the&lt;br&gt;
&gt; images, changing ownership.&lt;br&gt;
&gt; &lt;br&gt;
&gt; This results in a copy of the images being created in&lt;br&gt;
&gt; /run/live/overlay/rw/var/lib/libvirt/images&lt;br&gt;
&gt; &lt;br&gt;
&gt; I don't want these copies to be made but can't stop it.&lt;br&gt;
&gt; &lt;br&gt;
&gt; I've tried editing qemu.conf user/group, dynamic ownership etc. without&lt;br&gt;
&gt; any luck.&lt;br&gt;
&gt; &lt;br&gt;
&gt; Is there a way to STOP libvirt from changing the ownership of these images?&lt;br&gt;
&gt; &lt;br&gt;
&gt; &lt;br&gt;
&lt;br&gt;
Setting dynamic_ownership=0 in qemu.conf is the way to go (don't forget&lt;br&gt;
to restart the daemon after you made the change).&lt;br&gt;
&lt;br&gt;
Alternatively, you can set &lt;seclabel/&gt; either for whole domain or&lt;br&gt;
individual disks, e.g. like this:&lt;br&gt;
&lt;br&gt;
   &lt;disk type='file' device='disk'&gt;&lt;br&gt;
      &lt;driver name='qemu' type='qcow2'/&gt;&lt;br&gt;
      &lt;source file='/var/lib/libvirt/images/vm1.qcow2'&gt;&lt;br&gt;
         &lt;seclabel relabel='no'/&gt;&lt;br&gt;
      &lt;/source&gt;&lt;br&gt;
   &lt;/disk&gt;&lt;br&gt;
&lt;br&gt;
or for whole domain:&lt;br&gt;
&lt;br&gt;
      ...&lt;br&gt;
      &lt;/devices&gt;&lt;br&gt;
      &lt;seclabel type='none'/&gt;&lt;br&gt;
   &lt;/domain&gt;&lt;br&gt;
&lt;br&gt;
I'm not sure what your setup is, but if chown() is a problem then what&lt;br&gt;
if guest tries to write onto its disk? Wouldn't that create a copy in&lt;br&gt;
overlay?&lt;br&gt;
&lt;br&gt;
Michal&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20211124160415</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-11-24 16:04:15-0400</timestampReceived><subject>Re: Libvirt + Debian Live = Heart Attack</subject><body>

On 11/24/21 16:01, Elias Mobery wrote:
&gt; Hello Michal, thank you for the reply!
&gt; 
&gt; I've carefully tested everything you suggested, thanks.
&gt; 
&gt; I set dynamic_ownership=0 and use these hooks during the live build for
&gt; permissions. (I googled a lot, and apparently libvirt needs the images
&gt; to be executable too)
&gt; 
&gt; chown -R libvirt-qemu:kvm  /var/lib/libvirt/images
&gt; chmod -R g+rwx /var/lib/libvirt/images

I don't think this is correct. I don't have any of my images executable
and still run VMs happily.

&gt; 
&gt; Booting the live debian iso everything works in virt-manager, but again,
&gt; after clicking "run", a copy of the vm image is created in
&gt; /run/live/overlay/rw/var/lib/libvirt/images and only then does the VM start.

So who/what creates this copy? Is this a feature of underlying FS or
what exactly? It's definitely not libvirt who creates those copies.

&gt; 
&gt; Either it's still being chowned or chmodded somehow, or it's something
&gt; else, but I can't stop this copy being made.
&gt; 
&gt; Interestingly, when I boot the Live debian iso and then copy the images
&gt; into /var/lib/libvirt/images from my USB stick, the VM starts
&gt; immediately without creating any copies in the /run/live.... directory.
&gt; So my guess is that maybe the squashfs could be the issue?
&gt; 
&gt; Editing the XML
&gt; 
&gt; &lt;source file='/var/lib/libvirt/images/vm1.qcow2'&gt;
&gt;       &lt;seclabel relabel='no'/&gt;
&gt;     &lt;/source&gt;
&gt; 
&gt; This results in an error:
&gt; Unsupported Configuration:
&gt; Security driver model 'null' not available&gt;
&gt; Here I tried setting security_driver=none in qemu.conf but same error after.
&gt; 
&gt; &lt;/devices&gt;
&gt;     &lt;seclabel type='none'/&gt;
&gt;   &lt;/domain&gt;

This should have been:

  &lt;seclabel type='none' model='dac'/&gt;

and if you are running with SELinux you want to repeat that for
model='selinux' too.

Michal

</body></email><email><emailId>20211124161031</emailId><senderName>Martin Kletzander</senderName><senderEmail>mkletzan@redhat.com</senderEmail><timestampReceived>2021-11-24 16:10:31-0400</timestampReceived><subject>Re: Libvirt + Debian Live = Heart Attack</subject><body>


On Wed, Nov 24, 2021 at 04:01:34PM +0100, Elias Mobery wrote:
&gt;Hello Michal, thank you for the reply!
&gt;
&gt;I've carefully tested everything you suggested, thanks.
&gt;
&gt;I set dynamic_ownership=0 and use these hooks during the live build for
&gt;permissions. (I googled a lot, and apparently libvirt needs the images to
&gt;be executable too)
&gt;
&gt;chown -R libvirt-qemu:kvm  /var/lib/libvirt/images
&gt;chmod -R g+rwx /var/lib/libvirt/images
&gt;

I do not see why would the images need to be executable, you might need
an executable bit set on the directory so that your and qemu user can
browse it.

&gt;Booting the live debian iso everything works in virt-manager, but again,
&gt;after clicking "run", a copy of the vm image is created in
&gt;/run/live/overlay/rw/var/lib/libvirt/images and only then does the VM start.
&gt;

Does that happen when you try to run it with virsh instead of
virt-manager?  Are you connected to the system daemon?

&gt;Either it's still being chowned or chmodded somehow, or it's something
&gt;else, but I can't stop this copy being made.
&gt;
&gt;Interestingly, when I boot the Live debian iso and then copy the images
&gt;into /var/lib/libvirt/images from my USB stick, the VM starts immediately
&gt;without creating any copies in the /run/live.... directory. So my guess is
&gt;that maybe the squashfs could be the issue?
&gt;

Oh, interesting, is the USB stick filesystem mounted R/W and the live
ISO filesystem mounted read-only?  How is the overlay mounted?

&gt;Editing the XML
&gt;
&gt;&lt;source file='/var/lib/libvirt/images/vm1.qcow2'&gt;
&gt;      &lt;seclabel relabel='no'/&gt;
&gt;    &lt;/source&gt;
&gt;
&gt;This results in an error:
&gt;Unsupported Configuration:
&gt;Security driver model 'null' not available
&gt;

For issues like this it is most helpful to check the documentation:

   https://libvirt.org/formatdomain.html

where you can see it is just a missing attribute `model`, in this case
model="dac".

&gt;Here I tried setting security_driver=none in qemu.conf but same error after.
&gt;
&gt;&lt;/devices&gt;
&gt;    &lt;seclabel type='none'/&gt;
&gt;  &lt;/domain&gt;
&gt;

Same here.

&gt;This also returns an Error but I'm still googling to understand it properly.
&gt;
&gt;XML document failed to validate against schema
&gt;Unable to validate doc against /usr/share/libvirt/schemas/domain.rng
&gt;Invalid element relabel  for element seclabel
&gt;Extra element seclabel in interleave
&gt;Element domain failed to validate content
&gt;
&gt;Thanks again so much for your helo, I've been messing with this for weeks
&gt;now and it's killing me.
&gt;
&gt;On Tue, Nov 23, 2021, 9:43 PM Michal Prívozník &lt;mprivozn@redhat.com&gt; wrote:
&gt;
&gt;&gt; On 11/23/21 17:25, Elias Mobery wrote:
&gt;&gt; &gt;
&gt;&gt; &gt; Hi everyone!
&gt;&gt; &gt;
&gt;&gt; &gt; I've built a Debian Live ISO with packages qemu and libvirt to run a VM
&gt;&gt; &gt; in the live environment.
&gt;&gt; &gt;
&gt;&gt; &gt; The guest images are placed in  /var/lib/libvirt/images and 2GB each.
&gt;&gt; &gt;
&gt;&gt; &gt; Everything works great, except for one issue.
&gt;&gt; &gt;
&gt;&gt; &gt; When starting a VM, libvirt automatically issues a chown command to the
&gt;&gt; &gt; images, changing ownership.
&gt;&gt; &gt;
&gt;&gt; &gt; This results in a copy of the images being created in
&gt;&gt; &gt; /run/live/overlay/rw/var/lib/libvirt/images
&gt;&gt; &gt;
&gt;&gt; &gt; I don't want these copies to be made but can't stop it.
&gt;&gt; &gt;
&gt;&gt; &gt; I've tried editing qemu.conf user/group, dynamic ownership etc. without
&gt;&gt; &gt; any luck.
&gt;&gt; &gt;
&gt;&gt; &gt; Is there a way to STOP libvirt from changing the ownership of these
&gt;&gt; images?
&gt;&gt; &gt;
&gt;&gt; &gt;
&gt;&gt;
&gt;&gt; Setting dynamic_ownership=0 in qemu.conf is the way to go (don't forget
&gt;&gt; to restart the daemon after you made the change).
&gt;&gt;
&gt;&gt; Alternatively, you can set &lt;seclabel/&gt; either for whole domain or
&gt;&gt; individual disks, e.g. like this:
&gt;&gt;
&gt;&gt;   &lt;disk type='file' device='disk'&gt;
&gt;&gt;     &lt;driver name='qemu' type='qcow2'/&gt;
&gt;&gt;     &lt;source file='/var/lib/libvirt/images/vm1.qcow2'&gt;
&gt;&gt;       &lt;seclabel relabel='no'/&gt;
&gt;&gt;     &lt;/source&gt;
&gt;&gt;   &lt;/disk&gt;
&gt;&gt;
&gt;&gt; or for whole domain:
&gt;&gt;
&gt;&gt;     ...
&gt;&gt;     &lt;/devices&gt;
&gt;&gt;     &lt;seclabel type='none'/&gt;
&gt;&gt;   &lt;/domain&gt;
&gt;&gt;
&gt;&gt; I'm not sure what your setup is, but if chown() is a problem then what
&gt;&gt; if guest tries to write onto its disk? Wouldn't that create a copy in
&gt;&gt; overlay?
&gt;&gt;
&gt;&gt; Michal
&gt;&gt;
&gt;&gt;

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20211124172122</emailId><senderName>Elias Mobery</senderName><senderEmail>eliasmobery@gmail.com</senderEmail><timestampReceived>2021-11-24 17:21:22-0400</timestampReceived><subject>Re: Libvirt + Debian Live = Heart Attack</subject><body>

Hey Martin &amp; Michal, thank you both for the replies!

Yes, sorry I messed up that seclabel entry, thanks. I fixed it and there is
no more error, but the images are still copied unfortunately.

@Michal yes, I have been reading the Debian Live Manual like a contract,
after messing with qemu.conf and permissions for days, I think its
something in the live build and not libvirt.

@Martin yeah both virsh start and virt-manager cause the images to be
copied to /run..... first.

Yes, when I boot the Debian Live ISO, plug in the USB (mounted rw), copy
the images to the live system from the USB and click run in virt-manager,
the VM starts instantly and no copies are made in /run....

I use ISO loopback and toram to load the system directly into ram via tmpfs
mount. That's my grub.cfg

menuentry "debian-live.iso" { set iso="/ISO/debian-live.iso" set
root=(hd0,5) loopback loop $iso linux (loop)/live/vmlinuz-4.19.0-6-amd64
boot=live components toram findiso=$iso initrd
(loop)/live/initrd.img-4.19.0-6-amd64 }

So, the squashfs is mounted read-only in
/run/live/rootfs/filesystem.squashfs and its /dev/loop1

/proc/mounts says:

tmpfs /run/live/overlay rw
overlay rw  lowerdir=/run/live/rootfs/filesystem.squashfs
upperdir=/run/live/overlay/rw  (same place where the images are copied)

So you think that because the images are part of the squashfs which is
read-only, they are first copied to /run/live/overlay/rw... to be written
to?

I always thought that tmpfs is mounted on top of squash, so it's as if the
squashfs were writable, without having to literally copy between the two
filesystems.

Also I made the same build with Virtualbox and there is no copying of the
images to /run/live/overlay.

I will do some serious research into squashfs and tmpfs rn.




On Wed, Nov 24, 2021, 5:10 PM Martin Kletzander &lt;mkletzan@redhat.com&gt; wrote:

&gt; On Wed, Nov 24, 2021 at 04:01:34PM +0100, Elias Mobery wrote:
&gt; &gt;Hello Michal, thank you for the reply!
&gt; &gt;
&gt; &gt;I've carefully tested everything you suggested, thanks.
&gt; &gt;
&gt; &gt;I set dynamic_ownership=0 and use these hooks during the live build for
&gt; &gt;permissions. (I googled a lot, and apparently libvirt needs the images to
&gt; &gt;be executable too)
&gt; &gt;
&gt; &gt;chown -R libvirt-qemu:kvm  /var/lib/libvirt/images
&gt; &gt;chmod -R g+rwx /var/lib/libvirt/images
&gt; &gt;
&gt;
&gt; I do not see why would the images need to be executable, you might need
&gt; an executable bit set on the directory so that your and qemu user can
&gt; browse it.
&gt;
&gt; &gt;Booting the live debian iso everything works in virt-manager, but again,
&gt; &gt;after clicking "run", a copy of the vm image is created in
&gt; &gt;/run/live/overlay/rw/var/lib/libvirt/images and only then does the VM
&gt; start.
&gt; &gt;
&gt;
&gt; Does that happen when you try to run it with virsh instead of
&gt; virt-manager?  Are you connected to the system daemon?
&gt;
&gt; &gt;Either it's still being chowned or chmodded somehow, or it's something
&gt; &gt;else, but I can't stop this copy being made.
&gt; &gt;
&gt; &gt;Interestingly, when I boot the Live debian iso and then copy the images
&gt; &gt;into /var/lib/libvirt/images from my USB stick, the VM starts immediately
&gt; &gt;without creating any copies in the /run/live.... directory. So my guess is
&gt; &gt;that maybe the squashfs could be the issue?
&gt; &gt;
&gt;
&gt; Oh, interesting, is the USB stick filesystem mounted R/W and the live
&gt; ISO filesystem mounted read-only?  How is the overlay mounted?
&gt;
&gt; &gt;Editing the XML
&gt; &gt;
&gt; &gt;&lt;source file='/var/lib/libvirt/images/vm1.qcow2'&gt;
&gt; &gt;      &lt;seclabel relabel='no'/&gt;
&gt; &gt;    &lt;/source&gt;
&gt; &gt;
&gt; &gt;This results in an error:
&gt; &gt;Unsupported Configuration:
&gt; &gt;Security driver model 'null' not available
&gt; &gt;
&gt;
&gt; For issues like this it is most helpful to check the documentation:
&gt;
&gt;    https://libvirt.org/formatdomain.html
&gt;
&gt; where you can see it is just a missing attribute `model`, in this case
&gt; model="dac".
&gt;
&gt; &gt;Here I tried setting security_driver=none in qemu.conf but same error
&gt; after.
&gt; &gt;
&gt; &gt;&lt;/devices&gt;
&gt; &gt;    &lt;seclabel type='none'/&gt;
&gt; &gt;  &lt;/domain&gt;
&gt; &gt;
&gt;
&gt; Same here.
&gt;
&gt; &gt;This also returns an Error but I'm still googling to understand it
&gt; properly.
&gt; &gt;
&gt; &gt;XML document failed to validate against schema
&gt; &gt;Unable to validate doc against /usr/share/libvirt/schemas/domain.rng
&gt; &gt;Invalid element relabel  for element seclabel
&gt; &gt;Extra element seclabel in interleave
&gt; &gt;Element domain failed to validate content
&gt; &gt;
&gt; &gt;Thanks again so much for your helo, I've been messing with this for weeks
&gt; &gt;now and it's killing me.
&gt; &gt;
&gt; &gt;On Tue, Nov 23, 2021, 9:43 PM Michal Prívozník &lt;mprivozn@redhat.com&gt;
&gt; wrote:
&gt; &gt;
&gt; &gt;&gt; On 11/23/21 17:25, Elias Mobery wrote:
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; Hi everyone!
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; I've built a Debian Live ISO with packages qemu and libvirt to run a
&gt; VM
&gt; &gt;&gt; &gt; in the live environment.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; The guest images are placed in  /var/lib/libvirt/images and 2GB each.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; Everything works great, except for one issue.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; When starting a VM, libvirt automatically issues a chown command to
&gt; the
&gt; &gt;&gt; &gt; images, changing ownership.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; This results in a copy of the images being created in
&gt; &gt;&gt; &gt; /run/live/overlay/rw/var/lib/libvirt/images
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; I don't want these copies to be made but can't stop it.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; I've tried editing qemu.conf user/group, dynamic ownership etc.
&gt; without
&gt; &gt;&gt; &gt; any luck.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; Is there a way to STOP libvirt from changing the ownership of these
&gt; &gt;&gt; images?
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;
&gt; &gt;&gt;
&gt; &gt;&gt; Setting dynamic_ownership=0 in qemu.conf is the way to go (don't forget
&gt; &gt;&gt; to restart the daemon after you made the change).
&gt; &gt;&gt;
&gt; &gt;&gt; Alternatively, you can set &lt;seclabel/&gt; either for whole domain or
&gt; &gt;&gt; individual disks, e.g. like this:
&gt; &gt;&gt;
&gt; &gt;&gt;   &lt;disk type='file' device='disk'&gt;
&gt; &gt;&gt;     &lt;driver name='qemu' type='qcow2'/&gt;
&gt; &gt;&gt;     &lt;source file='/var/lib/libvirt/images/vm1.qcow2'&gt;
&gt; &gt;&gt;       &lt;seclabel relabel='no'/&gt;
&gt; &gt;&gt;     &lt;/source&gt;
&gt; &gt;&gt;   &lt;/disk&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; or for whole domain:
&gt; &gt;&gt;
&gt; &gt;&gt;     ...
&gt; &gt;&gt;     &lt;/devices&gt;
&gt; &gt;&gt;     &lt;seclabel type='none'/&gt;
&gt; &gt;&gt;   &lt;/domain&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; I'm not sure what your setup is, but if chown() is a problem then what
&gt; &gt;&gt; if guest tries to write onto its disk? Wouldn't that create a copy in
&gt; &gt;&gt; overlay?
&gt; &gt;&gt;
&gt; &gt;&gt; Michal
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt;

[Attachment #3 (text/html)]

&lt;div dir="auto"&gt;Hey Martin &amp; Michal, thank you both for the replies!&lt;div \
dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;Yes, sorry I messed up that seclabel entry, \
thanks. I fixed it and there is no more error, but the images are still copied \
unfortunately.&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;span \
style="background-color:rgb(239,154,154)"&gt;@Michal&lt;/span&gt; yes, I have been reading the \
Debian Live Manual like a contract, after messing with qemu.conf and permissions for \
days, I think its something in the live build and not libvirt.&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;span style="background-color:rgb(144,202,249)"&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;span style="background-color:rgb(144,202,249)"&gt;@Martin&lt;/span&gt; yeah both \
virsh start and virt-manager cause the images to be copied to /run..... \
first.&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;Yes, when I boot the Debian \
Live ISO, plug in the USB (mounted rw), copy the images to the live system from the \
USB and click run in virt-manager, the VM starts instantly and no copies are made in \
/run....&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;I use ISO loopback and toram \
to load the system directly into ram via tmpfs mount. That's my \
grub.cfg&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;span \
style="color:rgb(46,139,87);font-family:monaco,"andale mono","courier \
new",courier,monospace;font-size:11.7px;white-space:pre-wrap;background-color:rgb(255,255,255)"&gt;menuentry \
"debian-live.iso" {  set iso="/ISO/debian-live.iso"
  set root=(hd0,5)
  loopback loop $iso
  linux (loop)/live/vmlinuz-4.19.0-6-&lt;/span&gt;&lt;span \
style="color:rgb(46,139,87);font-family:monaco,"andale mono","courier \
new",courier,monospace;font-size:11.7px;white-space:pre-wrap;background-color:rgb(255,255,255)"&gt;amd64 \
boot=live components toram findiso=$iso  initrd \
(loop)/live/initrd.img-4.19.0-&lt;/span&gt;&lt;span \
style="color:rgb(46,139,87);font-family:monaco,"andale mono","courier \
new",courier,monospace;font-size:11.7px;white-space:pre-wrap;background-color:rgb(255,255,255)"&gt;6-amd64
 }&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;So, the squashfs is \
mounted read-only in /run/live/rootfs/filesystem.squashfs and its \
/dev/loop1&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;/proc/mounts \
says:&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;tmpfs /run/live/overlay \
rw&lt;/div&gt;&lt;div dir="auto"&gt;overlay rw   lowerdir=/run/live/rootfs/filesystem.squashfs  \
&lt;/div&gt;&lt;div dir="auto"&gt;upperdir=/run/live/overlay/rw   (same place where the images \
are copied)&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;So you think that because \
the images are part of the squashfs which is read-only, they are first copied to \
/run/live/overlay/rw... to be written to?&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
dir="auto"&gt;I always thought that tmpfs is mounted on top of squash, so it's as if \
the squashfs were writable, without having to literally copy between the two \
filesystems.&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;Also I made the same \
build with Virtualbox and there is no copying of the images to \
/run/live/overlay.&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;I will do some \
serious research into squashfs and tmpfs rn.&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote" dir="auto"&gt;&lt;div dir="ltr" \
class="gmail_attr"&gt;On Wed, Nov 24, 2021, 5:10 PM Martin Kletzander &lt;&lt;a \
href="mailto:mkletzan@redhat.com" target="_blank" \
rel="noreferrer"&gt;mkletzan@redhat.com&lt;/a&gt;&gt; wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex"&gt;On Wed, Nov 24, 2021 at 04:01:34PM +0100, Elias Mobery \
wrote:&lt;br&gt; &gt;Hello Michal, thank you for the reply!&lt;br&gt;
&gt;&lt;br&gt;
&gt;I've carefully tested everything you suggested, thanks.&lt;br&gt;
&gt;&lt;br&gt;
&gt;I set dynamic_ownership=0 and use these hooks during the live build for&lt;br&gt;
&gt;permissions. (I googled a lot, and apparently libvirt needs the images to&lt;br&gt;
&gt;be executable too)&lt;br&gt;
&gt;&lt;br&gt;
&gt;chown -R libvirt-qemu:kvm   /var/lib/libvirt/images&lt;br&gt;
&gt;chmod -R g+rwx /var/lib/libvirt/images&lt;br&gt;
&gt;&lt;br&gt;
&lt;br&gt;
I do not see why would the images need to be executable, you might need&lt;br&gt;
an executable bit set on the directory so that your and qemu user can&lt;br&gt;
browse it.&lt;br&gt;
&lt;br&gt;
&gt;Booting the live debian iso everything works in virt-manager, but again,&lt;br&gt;
&gt;after clicking "run", a copy of the vm image is created in&lt;br&gt;
&gt;/run/live/overlay/rw/var/lib/libvirt/images and only then does the VM start.&lt;br&gt;
&gt;&lt;br&gt;
&lt;br&gt;
Does that happen when you try to run it with virsh instead of&lt;br&gt;
virt-manager?   Are you connected to the system daemon?&lt;br&gt;
&lt;br&gt;
&gt;Either it's still being chowned or chmodded somehow, or it's \
something&lt;br&gt; &gt;else, but I can't stop this copy being made.&lt;br&gt;
&gt;&lt;br&gt;
&gt;Interestingly, when I boot the Live debian iso and then copy the images&lt;br&gt;
&gt;into /var/lib/libvirt/images from my USB stick, the VM starts immediately&lt;br&gt;
&gt;without creating any copies in the /run/live.... directory. So my guess is&lt;br&gt;
&gt;that maybe the squashfs could be the issue?&lt;br&gt;
&gt;&lt;br&gt;
&lt;br&gt;
Oh, interesting, is the USB stick filesystem mounted R/W and the live&lt;br&gt;
ISO filesystem mounted read-only?   How is the overlay mounted?&lt;br&gt;
&lt;br&gt;
&gt;Editing the XML&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;source file='/var/lib/libvirt/images/vm1.qcow2'&gt;&lt;br&gt;
&gt;         &lt;seclabel relabel='no'/&gt;&lt;br&gt;
&gt;      &lt;/source&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt;This results in an error:&lt;br&gt;
&gt;Unsupported Configuration:&lt;br&gt;
&gt;Security driver model 'null' not available&lt;br&gt;
&gt;&lt;br&gt;
&lt;br&gt;
For issues like this it is most helpful to check the documentation:&lt;br&gt;
&lt;br&gt;
     &lt;a href="https://libvirt.org/formatdomain.html" rel="noreferrer noreferrer \
noreferrer" target="_blank"&gt;https://libvirt.org/formatdomain.html&lt;/a&gt;&lt;br&gt; &lt;br&gt;
where you can see it is just a missing attribute `model`, in this case&lt;br&gt;
model="dac".&lt;br&gt;
&lt;br&gt;
&gt;Here I tried setting security_driver=none in qemu.conf but same error after.&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;/devices&gt;&lt;br&gt;
&gt;      &lt;seclabel type='none'/&gt;&lt;br&gt;
&gt;   &lt;/domain&gt;&lt;br&gt;
&gt;&lt;br&gt;
&lt;br&gt;
Same here.&lt;br&gt;
&lt;br&gt;
&gt;This also returns an Error but I'm still googling to understand it \
properly.&lt;br&gt; &gt;&lt;br&gt;
&gt;XML document failed to validate against schema&lt;br&gt;
&gt;Unable to validate doc against /usr/share/libvirt/schemas/domain.rng&lt;br&gt;
&gt;Invalid element relabel   for element seclabel&lt;br&gt;
&gt;Extra element seclabel in interleave&lt;br&gt;
&gt;Element domain failed to validate content&lt;br&gt;
&gt;&lt;br&gt;
&gt;Thanks again so much for your helo, I've been messing with this for weeks&lt;br&gt;
&gt;now and it's killing me.&lt;br&gt;
&gt;&lt;br&gt;
&gt;On Tue, Nov 23, 2021, 9:43 PM Michal Prívozník &lt;&lt;a \
href="mailto:mprivozn@redhat.com" rel="noreferrer noreferrer" \
target="_blank"&gt;mprivozn@redhat.com&lt;/a&gt;&gt; wrote:&lt;br&gt; &gt;&lt;br&gt;
&gt;&gt; On 11/23/21 17:25, Elias Mobery wrote:&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt; Hi everyone!&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt; I've built a Debian Live ISO with packages qemu and libvirt to run \
a VM&lt;br&gt; &gt;&gt; &gt; in the live environment.&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt; The guest images are placed in   /var/lib/libvirt/images and 2GB \
each.&lt;br&gt; &gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt; Everything works great, except for one issue.&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt; When starting a VM, libvirt automatically issues a chown command to \
the&lt;br&gt; &gt;&gt; &gt; images, changing ownership.&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt; This results in a copy of the images being created in&lt;br&gt;
&gt;&gt; &gt; /run/live/overlay/rw/var/lib/libvirt/images&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt; I don't want these copies to be made but can't stop it.&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt; I've tried editing qemu.conf user/group, dynamic ownership etc. \
without&lt;br&gt; &gt;&gt; &gt; any luck.&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt; Is there a way to STOP libvirt from changing the ownership of these&lt;br&gt;
&gt;&gt; images?&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; Setting dynamic_ownership=0 in qemu.conf is the way to go (don't \
forget&lt;br&gt; &gt;&gt; to restart the daemon after you made the change).&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; Alternatively, you can set &lt;seclabel/&gt; either for whole domain or&lt;br&gt;
&gt;&gt; individual disks, e.g. like this:&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;     &lt;disk type='file' device='disk'&gt;&lt;br&gt;
&gt;&gt;        &lt;driver name='qemu' type='qcow2'/&gt;&lt;br&gt;
&gt;&gt;        &lt;source file='/var/lib/libvirt/images/vm1.qcow2'&gt;&lt;br&gt;
&gt;&gt;           &lt;seclabel relabel='no'/&gt;&lt;br&gt;
&gt;&gt;        &lt;/source&gt;&lt;br&gt;
&gt;&gt;     &lt;/disk&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; or for whole domain:&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;        ...&lt;br&gt;
&gt;&gt;        &lt;/devices&gt;&lt;br&gt;
&gt;&gt;        &lt;seclabel type='none'/&gt;&lt;br&gt;
&gt;&gt;     &lt;/domain&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; I'm not sure what your setup is, but if chown() is a problem then \
what&lt;br&gt; &gt;&gt; if guest tries to write onto its disk? Wouldn't that create a \
copy in&lt;br&gt; &gt;&gt; overlay?&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; Michal&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20211125104018</emailId><senderName>Martin Kletzander</senderName><senderEmail>mkletzan@redhat.com</senderEmail><timestampReceived>2021-11-25 10:40:18-0400</timestampReceived><subject>Re: Libvirt + Debian Live = Heart Attack</subject><body>


On Wed, Nov 24, 2021 at 06:21:22PM +0100, Elias Mobery wrote:
&gt;Hey Martin &amp; Michal, thank you both for the replies!
&gt;
&gt;Yes, sorry I messed up that seclabel entry, thanks. I fixed it and there is
&gt;no more error, but the images are still copied unfortunately.
&gt;
&gt;@Michal yes, I have been reading the Debian Live Manual like a contract,
&gt;after messing with qemu.conf and permissions for days, I think its
&gt;something in the live build and not libvirt.
&gt;
&gt;@Martin yeah both virsh start and virt-manager cause the images to be
&gt;copied to /run..... first.
&gt;
&gt;Yes, when I boot the Debian Live ISO, plug in the USB (mounted rw), copy
&gt;the images to the live system from the USB and click run in virt-manager,
&gt;the VM starts instantly and no copies are made in /run....
&gt;
&gt;I use ISO loopback and toram to load the system directly into ram via tmpfs
&gt;mount. That's my grub.cfg
&gt;
&gt;menuentry "debian-live.iso" { set iso="/ISO/debian-live.iso" set
&gt;root=(hd0,5) loopback loop $iso linux (loop)/live/vmlinuz-4.19.0-6-amd64
&gt;boot=live components toram findiso=$iso initrd
&gt;(loop)/live/initrd.img-4.19.0-6-amd64 }
&gt;
&gt;So, the squashfs is mounted read-only in
&gt;/run/live/rootfs/filesystem.squashfs and its /dev/loop1
&gt;
&gt;/proc/mounts says:
&gt;
&gt;tmpfs /run/live/overlay rw
&gt;overlay rw  lowerdir=/run/live/rootfs/filesystem.squashfs
&gt;upperdir=/run/live/overlay/rw  (same place where the images are copied)
&gt;

I do not think this is relevant, but sometimes overlayfs wants to have a
workdir as well.

&gt;So you think that because the images are part of the squashfs which is
&gt;read-only, they are first copied to /run/live/overlay/rw... to be written
&gt;to?
&gt;

Are they really copied?  I can't think of many more things why this
would happen.  Maybe some locking code does that in the backend (both
libvirt and qemu lock parts of the disks).

&gt;I always thought that tmpfs is mounted on top of squash, so it's as if the
&gt;squashfs were writable, without having to literally copy between the two
&gt;filesystems.
&gt;

It is not mounted over, if you mount over something you lose the
lowerdir, that's why it needs to be done with overlayfs which does the
copy-on-write.

That leads me to another idea.  Since you want copy-on-write for the
images, I presume, the image will get copied anyway once the guest
writes even a single byte to the image.  Unfortunately overlayfs is not
the best way for this scenario due to the granularity it offers
(per-file, not per-block or anything smaller).  What I think you
actually want in this case is to have a qcow image with the original
image used as backing.  You can create those with libvirt or even
without it, just using qemu-img, for example like this:

   qemu-img create -b /path/to/non-modified.image -f qcow2 -F
   format_of_backing_file /path/to/new-image.qcow2

For more information please read the qemu-img manual page to make sure
you use it properly, I just wrote the above from the top of my head, not
tested it.  The backing file path can also be relative.

If you specify the new image for the machines then the granularity
changes to way smaller blocks than the whole file making it occupy
less space in case of changes.

&gt;Also I made the same build with Virtualbox and there is no copying of the
&gt;images to /run/live/overlay.
&gt;
&gt;I will do some serious research into squashfs and tmpfs rn.
&gt;

If you want to figure out when it happens I would suggest enabling debug
logs for libvirt, starting the qemu VM with --paused, but maybe it will
need some more debugging on lower layers.  Anyway I really believe the
approach suggested above is what will lead to better results for you.

Have a nice day
Martin

&gt;
&gt;
&gt;
&gt;On Wed, Nov 24, 2021, 5:10 PM Martin Kletzander &lt;mkletzan@redhat.com&gt; wrote:
&gt;
&gt;&gt; On Wed, Nov 24, 2021 at 04:01:34PM +0100, Elias Mobery wrote:
&gt;&gt; &gt;Hello Michal, thank you for the reply!
&gt;&gt; &gt;
&gt;&gt; &gt;I've carefully tested everything you suggested, thanks.
&gt;&gt; &gt;
&gt;&gt; &gt;I set dynamic_ownership=0 and use these hooks during the live build for
&gt;&gt; &gt;permissions. (I googled a lot, and apparently libvirt needs the images to
&gt;&gt; &gt;be executable too)
&gt;&gt; &gt;
&gt;&gt; &gt;chown -R libvirt-qemu:kvm  /var/lib/libvirt/images
&gt;&gt; &gt;chmod -R g+rwx /var/lib/libvirt/images
&gt;&gt; &gt;
&gt;&gt;
&gt;&gt; I do not see why would the images need to be executable, you might need
&gt;&gt; an executable bit set on the directory so that your and qemu user can
&gt;&gt; browse it.
&gt;&gt;
&gt;&gt; &gt;Booting the live debian iso everything works in virt-manager, but again,
&gt;&gt; &gt;after clicking "run", a copy of the vm image is created in
&gt;&gt; &gt;/run/live/overlay/rw/var/lib/libvirt/images and only then does the VM
&gt;&gt; start.
&gt;&gt; &gt;
&gt;&gt;
&gt;&gt; Does that happen when you try to run it with virsh instead of
&gt;&gt; virt-manager?  Are you connected to the system daemon?
&gt;&gt;
&gt;&gt; &gt;Either it's still being chowned or chmodded somehow, or it's something
&gt;&gt; &gt;else, but I can't stop this copy being made.
&gt;&gt; &gt;
&gt;&gt; &gt;Interestingly, when I boot the Live debian iso and then copy the images
&gt;&gt; &gt;into /var/lib/libvirt/images from my USB stick, the VM starts immediately
&gt;&gt; &gt;without creating any copies in the /run/live.... directory. So my guess is
&gt;&gt; &gt;that maybe the squashfs could be the issue?
&gt;&gt; &gt;
&gt;&gt;
&gt;&gt; Oh, interesting, is the USB stick filesystem mounted R/W and the live
&gt;&gt; ISO filesystem mounted read-only?  How is the overlay mounted?
&gt;&gt;
&gt;&gt; &gt;Editing the XML
&gt;&gt; &gt;
&gt;&gt; &gt;&lt;source file='/var/lib/libvirt/images/vm1.qcow2'&gt;
&gt;&gt; &gt;      &lt;seclabel relabel='no'/&gt;
&gt;&gt; &gt;    &lt;/source&gt;
&gt;&gt; &gt;
&gt;&gt; &gt;This results in an error:
&gt;&gt; &gt;Unsupported Configuration:
&gt;&gt; &gt;Security driver model 'null' not available
&gt;&gt; &gt;
&gt;&gt;
&gt;&gt; For issues like this it is most helpful to check the documentation:
&gt;&gt;
&gt;&gt;    https://libvirt.org/formatdomain.html
&gt;&gt;
&gt;&gt; where you can see it is just a missing attribute `model`, in this case
&gt;&gt; model="dac".
&gt;&gt;
&gt;&gt; &gt;Here I tried setting security_driver=none in qemu.conf but same error
&gt;&gt; after.
&gt;&gt; &gt;
&gt;&gt; &gt;&lt;/devices&gt;
&gt;&gt; &gt;    &lt;seclabel type='none'/&gt;
&gt;&gt; &gt;  &lt;/domain&gt;
&gt;&gt; &gt;
&gt;&gt;
&gt;&gt; Same here.
&gt;&gt;
&gt;&gt; &gt;This also returns an Error but I'm still googling to understand it
&gt;&gt; properly.
&gt;&gt; &gt;
&gt;&gt; &gt;XML document failed to validate against schema
&gt;&gt; &gt;Unable to validate doc against /usr/share/libvirt/schemas/domain.rng
&gt;&gt; &gt;Invalid element relabel  for element seclabel
&gt;&gt; &gt;Extra element seclabel in interleave
&gt;&gt; &gt;Element domain failed to validate content
&gt;&gt; &gt;
&gt;&gt; &gt;Thanks again so much for your helo, I've been messing with this for weeks
&gt;&gt; &gt;now and it's killing me.
&gt;&gt; &gt;
&gt;&gt; &gt;On Tue, Nov 23, 2021, 9:43 PM Michal Prívozník &lt;mprivozn@redhat.com&gt;
&gt;&gt; wrote:
&gt;&gt; &gt;
&gt;&gt; &gt;&gt; On 11/23/21 17:25, Elias Mobery wrote:
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt; Hi everyone!
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt; I've built a Debian Live ISO with packages qemu and libvirt to run a
&gt;&gt; VM
&gt;&gt; &gt;&gt; &gt; in the live environment.
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt; The guest images are placed in  /var/lib/libvirt/images and 2GB each.
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt; Everything works great, except for one issue.
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt; When starting a VM, libvirt automatically issues a chown command to
&gt;&gt; the
&gt;&gt; &gt;&gt; &gt; images, changing ownership.
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt; This results in a copy of the images being created in
&gt;&gt; &gt;&gt; &gt; /run/live/overlay/rw/var/lib/libvirt/images
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt; I don't want these copies to be made but can't stop it.
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt; I've tried editing qemu.conf user/group, dynamic ownership etc.
&gt;&gt; without
&gt;&gt; &gt;&gt; &gt; any luck.
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt; Is there a way to STOP libvirt from changing the ownership of these
&gt;&gt; &gt;&gt; images?
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Setting dynamic_ownership=0 in qemu.conf is the way to go (don't forget
&gt;&gt; &gt;&gt; to restart the daemon after you made the change).
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Alternatively, you can set &lt;seclabel/&gt; either for whole domain or
&gt;&gt; &gt;&gt; individual disks, e.g. like this:
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt;   &lt;disk type='file' device='disk'&gt;
&gt;&gt; &gt;&gt;     &lt;driver name='qemu' type='qcow2'/&gt;
&gt;&gt; &gt;&gt;     &lt;source file='/var/lib/libvirt/images/vm1.qcow2'&gt;
&gt;&gt; &gt;&gt;       &lt;seclabel relabel='no'/&gt;
&gt;&gt; &gt;&gt;     &lt;/source&gt;
&gt;&gt; &gt;&gt;   &lt;/disk&gt;
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; or for whole domain:
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt;     ...
&gt;&gt; &gt;&gt;     &lt;/devices&gt;
&gt;&gt; &gt;&gt;     &lt;seclabel type='none'/&gt;
&gt;&gt; &gt;&gt;   &lt;/domain&gt;
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; I'm not sure what your setup is, but if chown() is a problem then what
&gt;&gt; &gt;&gt; if guest tries to write onto its disk? Wouldn't that create a copy in
&gt;&gt; &gt;&gt; overlay?
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Michal
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt;
&gt;&gt;

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20211125122123</emailId><senderName>Elias Mobery</senderName><senderEmail>eliasmobery@gmail.com</senderEmail><timestampReceived>2021-11-25 12:21:23-0400</timestampReceived><subject>Re: Libvirt + Debian Live = Heart Attack</subject><body>

Hey Martin, wow thanks for the detailed info!

I'll definitely look into this, but I kind of figured it out, I believe.

So, I keep the images in the read-only squashfs, boot the live system and
use snapshot writeback:
virsh snapshot-create-as with options --disk-only --diskspec

This pretty much fixes my problem, and only disk writes occur in tmpfs,
instead of the entire image being copied.

BUT, now I have to reduce the disk space within the  VM to almost 0 to save
space.

I'm reading up on qemu-img convert and virt-sparsify to accomplish this,
but I will also try your method now, it seems more professional.

Thank you for your amazing input and patience, I love this community.
Sharing this information is the literal definition of freedom IMO, thank
you all!

On Thu, Nov 25, 2021, 11:40 AM Martin Kletzander &lt;mkletzan@redhat.com&gt;
wrote:

&gt; On Wed, Nov 24, 2021 at 06:21:22PM +0100, Elias Mobery wrote:
&gt; &gt;Hey Martin &amp; Michal, thank you both for the replies!
&gt; &gt;
&gt; &gt;Yes, sorry I messed up that seclabel entry, thanks. I fixed it and there
&gt; is
&gt; &gt;no more error, but the images are still copied unfortunately.
&gt; &gt;
&gt; &gt;@Michal yes, I have been reading the Debian Live Manual like a contract,
&gt; &gt;after messing with qemu.conf and permissions for days, I think its
&gt; &gt;something in the live build and not libvirt.
&gt; &gt;
&gt; &gt;@Martin yeah both virsh start and virt-manager cause the images to be
&gt; &gt;copied to /run..... first.
&gt; &gt;
&gt; &gt;Yes, when I boot the Debian Live ISO, plug in the USB (mounted rw), copy
&gt; &gt;the images to the live system from the USB and click run in virt-manager,
&gt; &gt;the VM starts instantly and no copies are made in /run....
&gt; &gt;
&gt; &gt;I use ISO loopback and toram to load the system directly into ram via
&gt; tmpfs
&gt; &gt;mount. That's my grub.cfg
&gt; &gt;
&gt; &gt;menuentry "debian-live.iso" { set iso="/ISO/debian-live.iso" set
&gt; &gt;root=(hd0,5) loopback loop $iso linux (loop)/live/vmlinuz-4.19.0-6-amd64
&gt; &gt;boot=live components toram findiso=$iso initrd
&gt; &gt;(loop)/live/initrd.img-4.19.0-6-amd64 }
&gt; &gt;
&gt; &gt;So, the squashfs is mounted read-only in
&gt; &gt;/run/live/rootfs/filesystem.squashfs and its /dev/loop1
&gt; &gt;
&gt; &gt;/proc/mounts says:
&gt; &gt;
&gt; &gt;tmpfs /run/live/overlay rw
&gt; &gt;overlay rw  lowerdir=/run/live/rootfs/filesystem.squashfs
&gt; &gt;upperdir=/run/live/overlay/rw  (same place where the images are copied)
&gt; &gt;
&gt;
&gt; I do not think this is relevant, but sometimes overlayfs wants to have a
&gt; workdir as well.
&gt;
&gt; &gt;So you think that because the images are part of the squashfs which is
&gt; &gt;read-only, they are first copied to /run/live/overlay/rw... to be written
&gt; &gt;to?
&gt; &gt;
&gt;
&gt; Are they really copied?  I can't think of many more things why this
&gt; would happen.  Maybe some locking code does that in the backend (both
&gt; libvirt and qemu lock parts of the disks).
&gt;
&gt; &gt;I always thought that tmpfs is mounted on top of squash, so it's as if the
&gt; &gt;squashfs were writable, without having to literally copy between the two
&gt; &gt;filesystems.
&gt; &gt;
&gt;
&gt; It is not mounted over, if you mount over something you lose the
&gt; lowerdir, that's why it needs to be done with overlayfs which does the
&gt; copy-on-write.
&gt;
&gt; That leads me to another idea.  Since you want copy-on-write for the
&gt; images, I presume, the image will get copied anyway once the guest
&gt; writes even a single byte to the image.  Unfortunately overlayfs is not
&gt; the best way for this scenario due to the granularity it offers
&gt; (per-file, not per-block or anything smaller).  What I think you
&gt; actually want in this case is to have a qcow image with the original
&gt; image used as backing.  You can create those with libvirt or even
&gt; without it, just using qemu-img, for example like this:
&gt;
&gt;    qemu-img create -b /path/to/non-modified.image -f qcow2 -F
&gt;    format_of_backing_file /path/to/new-image.qcow2
&gt;
&gt; For more information please read the qemu-img manual page to make sure
&gt; you use it properly, I just wrote the above from the top of my head, not
&gt; tested it.  The backing file path can also be relative.
&gt;
&gt; If you specify the new image for the machines then the granularity
&gt; changes to way smaller blocks than the whole file making it occupy
&gt; less space in case of changes.
&gt;
&gt; &gt;Also I made the same build with Virtualbox and there is no copying of the
&gt; &gt;images to /run/live/overlay.
&gt; &gt;
&gt; &gt;I will do some serious research into squashfs and tmpfs rn.
&gt; &gt;
&gt;
&gt; If you want to figure out when it happens I would suggest enabling debug
&gt; logs for libvirt, starting the qemu VM with --paused, but maybe it will
&gt; need some more debugging on lower layers.  Anyway I really believe the
&gt; approach suggested above is what will lead to better results for you.
&gt;
&gt; Have a nice day
&gt; Martin
&gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;On Wed, Nov 24, 2021, 5:10 PM Martin Kletzander &lt;mkletzan@redhat.com&gt;
&gt; wrote:
&gt; &gt;
&gt; &gt;&gt; On Wed, Nov 24, 2021 at 04:01:34PM +0100, Elias Mobery wrote:
&gt; &gt;&gt; &gt;Hello Michal, thank you for the reply!
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;I've carefully tested everything you suggested, thanks.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;I set dynamic_ownership=0 and use these hooks during the live build for
&gt; &gt;&gt; &gt;permissions. (I googled a lot, and apparently libvirt needs the images
&gt; to
&gt; &gt;&gt; &gt;be executable too)
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;chown -R libvirt-qemu:kvm  /var/lib/libvirt/images
&gt; &gt;&gt; &gt;chmod -R g+rwx /var/lib/libvirt/images
&gt; &gt;&gt; &gt;
&gt; &gt;&gt;
&gt; &gt;&gt; I do not see why would the images need to be executable, you might need
&gt; &gt;&gt; an executable bit set on the directory so that your and qemu user can
&gt; &gt;&gt; browse it.
&gt; &gt;&gt;
&gt; &gt;&gt; &gt;Booting the live debian iso everything works in virt-manager, but
&gt; again,
&gt; &gt;&gt; &gt;after clicking "run", a copy of the vm image is created in
&gt; &gt;&gt; &gt;/run/live/overlay/rw/var/lib/libvirt/images and only then does the VM
&gt; &gt;&gt; start.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt;
&gt; &gt;&gt; Does that happen when you try to run it with virsh instead of
&gt; &gt;&gt; virt-manager?  Are you connected to the system daemon?
&gt; &gt;&gt;
&gt; &gt;&gt; &gt;Either it's still being chowned or chmodded somehow, or it's something
&gt; &gt;&gt; &gt;else, but I can't stop this copy being made.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;Interestingly, when I boot the Live debian iso and then copy the images
&gt; &gt;&gt; &gt;into /var/lib/libvirt/images from my USB stick, the VM starts
&gt; immediately
&gt; &gt;&gt; &gt;without creating any copies in the /run/live.... directory. So my
&gt; guess is
&gt; &gt;&gt; &gt;that maybe the squashfs could be the issue?
&gt; &gt;&gt; &gt;
&gt; &gt;&gt;
&gt; &gt;&gt; Oh, interesting, is the USB stick filesystem mounted R/W and the live
&gt; &gt;&gt; ISO filesystem mounted read-only?  How is the overlay mounted?
&gt; &gt;&gt;
&gt; &gt;&gt; &gt;Editing the XML
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;&lt;source file='/var/lib/libvirt/images/vm1.qcow2'&gt;
&gt; &gt;&gt; &gt;      &lt;seclabel relabel='no'/&gt;
&gt; &gt;&gt; &gt;    &lt;/source&gt;
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;This results in an error:
&gt; &gt;&gt; &gt;Unsupported Configuration:
&gt; &gt;&gt; &gt;Security driver model 'null' not available
&gt; &gt;&gt; &gt;
&gt; &gt;&gt;
&gt; &gt;&gt; For issues like this it is most helpful to check the documentation:
&gt; &gt;&gt;
&gt; &gt;&gt;    https://libvirt.org/formatdomain.html
&gt; &gt;&gt;
&gt; &gt;&gt; where you can see it is just a missing attribute `model`, in this case
&gt; &gt;&gt; model="dac".
&gt; &gt;&gt;
&gt; &gt;&gt; &gt;Here I tried setting security_driver=none in qemu.conf but same error
&gt; &gt;&gt; after.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;&lt;/devices&gt;
&gt; &gt;&gt; &gt;    &lt;seclabel type='none'/&gt;
&gt; &gt;&gt; &gt;  &lt;/domain&gt;
&gt; &gt;&gt; &gt;
&gt; &gt;&gt;
&gt; &gt;&gt; Same here.
&gt; &gt;&gt;
&gt; &gt;&gt; &gt;This also returns an Error but I'm still googling to understand it
&gt; &gt;&gt; properly.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;XML document failed to validate against schema
&gt; &gt;&gt; &gt;Unable to validate doc against /usr/share/libvirt/schemas/domain.rng
&gt; &gt;&gt; &gt;Invalid element relabel  for element seclabel
&gt; &gt;&gt; &gt;Extra element seclabel in interleave
&gt; &gt;&gt; &gt;Element domain failed to validate content
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;Thanks again so much for your helo, I've been messing with this for
&gt; weeks
&gt; &gt;&gt; &gt;now and it's killing me.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;On Tue, Nov 23, 2021, 9:43 PM Michal Prívozník &lt;mprivozn@redhat.com&gt;
&gt; &gt;&gt; wrote:
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;&gt; On 11/23/21 17:25, Elias Mobery wrote:
&gt; &gt;&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;&gt; &gt; Hi everyone!
&gt; &gt;&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;&gt; &gt; I've built a Debian Live ISO with packages qemu and libvirt to run
&gt; a
&gt; &gt;&gt; VM
&gt; &gt;&gt; &gt;&gt; &gt; in the live environment.
&gt; &gt;&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;&gt; &gt; The guest images are placed in  /var/lib/libvirt/images and 2GB
&gt; each.
&gt; &gt;&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;&gt; &gt; Everything works great, except for one issue.
&gt; &gt;&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;&gt; &gt; When starting a VM, libvirt automatically issues a chown command to
&gt; &gt;&gt; the
&gt; &gt;&gt; &gt;&gt; &gt; images, changing ownership.
&gt; &gt;&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;&gt; &gt; This results in a copy of the images being created in
&gt; &gt;&gt; &gt;&gt; &gt; /run/live/overlay/rw/var/lib/libvirt/images
&gt; &gt;&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;&gt; &gt; I don't want these copies to be made but can't stop it.
&gt; &gt;&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;&gt; &gt; I've tried editing qemu.conf user/group, dynamic ownership etc.
&gt; &gt;&gt; without
&gt; &gt;&gt; &gt;&gt; &gt; any luck.
&gt; &gt;&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;&gt; &gt; Is there a way to STOP libvirt from changing the ownership of these
&gt; &gt;&gt; &gt;&gt; images?
&gt; &gt;&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; Setting dynamic_ownership=0 in qemu.conf is the way to go (don't
&gt; forget
&gt; &gt;&gt; &gt;&gt; to restart the daemon after you made the change).
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; Alternatively, you can set &lt;seclabel/&gt; either for whole domain or
&gt; &gt;&gt; &gt;&gt; individual disks, e.g. like this:
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt;   &lt;disk type='file' device='disk'&gt;
&gt; &gt;&gt; &gt;&gt;     &lt;driver name='qemu' type='qcow2'/&gt;
&gt; &gt;&gt; &gt;&gt;     &lt;source file='/var/lib/libvirt/images/vm1.qcow2'&gt;
&gt; &gt;&gt; &gt;&gt;       &lt;seclabel relabel='no'/&gt;
&gt; &gt;&gt; &gt;&gt;     &lt;/source&gt;
&gt; &gt;&gt; &gt;&gt;   &lt;/disk&gt;
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; or for whole domain:
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt;     ...
&gt; &gt;&gt; &gt;&gt;     &lt;/devices&gt;
&gt; &gt;&gt; &gt;&gt;     &lt;seclabel type='none'/&gt;
&gt; &gt;&gt; &gt;&gt;   &lt;/domain&gt;
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; I'm not sure what your setup is, but if chown() is a problem then
&gt; what
&gt; &gt;&gt; &gt;&gt; if guest tries to write onto its disk? Wouldn't that create a copy in
&gt; &gt;&gt; &gt;&gt; overlay?
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; Michal
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt;
&gt;

[Attachment #3 (text/html)]

&lt;div dir="auto"&gt;&lt;div&gt;Hey Martin, wow thanks for the detailed info!&lt;div \
dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;I'll definitely look into this, but I kind \
of figured it out, I believe.&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;So, I \
keep the images in the read-only squashfs, boot the live system and use snapshot \
writeback:&lt;/div&gt;&lt;div dir="auto"&gt;virsh snapshot-create-as with options --disk-only \
--diskspec&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;This pretty much fixes my \
problem, and only disk writes occur in tmpfs, instead of the entire image being \
copied.&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;BUT, now I have to reduce the \
disk space within the   VM to almost 0 to save space.  &lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;I'm reading up on qemu-img convert and \
virt-sparsify to accomplish this, but I will also try your method now, it seems more \
professional.&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;Thank you for your \
amazing input and patience, I love this community. Sharing this information is the \
literal definition of freedom IMO, thank you all!&lt;/div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Thu, Nov 25, 2021, 11:40 AM \
Martin Kletzander &lt;&lt;a href="mailto:mkletzan@redhat.com" target="_blank" \
rel="noreferrer"&gt;mkletzan@redhat.com&lt;/a&gt;&gt; wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex"&gt;On Wed, Nov 24, 2021 at 06:21:22PM +0100, Elias Mobery \
wrote:&lt;br&gt; &gt;Hey Martin &amp; Michal, thank you both for the replies!&lt;br&gt;
&gt;&lt;br&gt;
&gt;Yes, sorry I messed up that seclabel entry, thanks. I fixed it and there is&lt;br&gt;
&gt;no more error, but the images are still copied unfortunately.&lt;br&gt;
&gt;&lt;br&gt;
&gt;@Michal yes, I have been reading the Debian Live Manual like a contract,&lt;br&gt;
&gt;after messing with qemu.conf and permissions for days, I think its&lt;br&gt;
&gt;something in the live build and not libvirt.&lt;br&gt;
&gt;&lt;br&gt;
&gt;@Martin yeah both virsh start and virt-manager cause the images to be&lt;br&gt;
&gt;copied to /run..... first.&lt;br&gt;
&gt;&lt;br&gt;
&gt;Yes, when I boot the Debian Live ISO, plug in the USB (mounted rw), copy&lt;br&gt;
&gt;the images to the live system from the USB and click run in virt-manager,&lt;br&gt;
&gt;the VM starts instantly and no copies are made in /run....&lt;br&gt;
&gt;&lt;br&gt;
&gt;I use ISO loopback and toram to load the system directly into ram via tmpfs&lt;br&gt;
&gt;mount. That's my grub.cfg&lt;br&gt;
&gt;&lt;br&gt;
&gt;menuentry "debian-live.iso" { set iso="/ISO/debian-live.iso" \
set&lt;br&gt; &gt;root=(hd0,5) loopback loop $iso linux \
(loop)/live/vmlinuz-4.19.0-6-amd64&lt;br&gt; &gt;boot=live components toram findiso=$iso \
initrd&lt;br&gt; &gt;(loop)/live/initrd.img-4.19.0-6-amd64 }&lt;br&gt;
&gt;&lt;br&gt;
&gt;So, the squashfs is mounted read-only in&lt;br&gt;
&gt;/run/live/rootfs/filesystem.squashfs and its /dev/loop1&lt;br&gt;
&gt;&lt;br&gt;
&gt;/proc/mounts says:&lt;br&gt;
&gt;&lt;br&gt;
&gt;tmpfs /run/live/overlay rw&lt;br&gt;
&gt;overlay rw   lowerdir=/run/live/rootfs/filesystem.squashfs&lt;br&gt;
&gt;upperdir=/run/live/overlay/rw   (same place where the images are copied)&lt;br&gt;
&gt;&lt;br&gt;
&lt;br&gt;
I do not think this is relevant, but sometimes overlayfs wants to have a&lt;br&gt;
workdir as well.&lt;br&gt;
&lt;br&gt;
&gt;So you think that because the images are part of the squashfs which is&lt;br&gt;
&gt;read-only, they are first copied to /run/live/overlay/rw... to be written&lt;br&gt;
&gt;to?&lt;br&gt;
&gt;&lt;br&gt;
&lt;br&gt;
Are they really copied?   I can't think of many more things why this&lt;br&gt;
would happen.   Maybe some locking code does that in the backend (both&lt;br&gt;
libvirt and qemu lock parts of the disks).&lt;br&gt;
&lt;br&gt;
&gt;I always thought that tmpfs is mounted on top of squash, so it's as if \
the&lt;br&gt; &gt;squashfs were writable, without having to literally copy between the \
two&lt;br&gt; &gt;filesystems.&lt;br&gt;
&gt;&lt;br&gt;
&lt;br&gt;
It is not mounted over, if you mount over something you lose the&lt;br&gt;
lowerdir, that's why it needs to be done with overlayfs which does the&lt;br&gt;
copy-on-write.&lt;br&gt;
&lt;br&gt;
That leads me to another idea.   Since you want copy-on-write for the&lt;br&gt;
images, I presume, the image will get copied anyway once the guest&lt;br&gt;
writes even a single byte to the image.   Unfortunately overlayfs is not&lt;br&gt;
the best way for this scenario due to the granularity it offers&lt;br&gt;
(per-file, not per-block or anything smaller).   What I think you&lt;br&gt;
actually want in this case is to have a qcow image with the original&lt;br&gt;
image used as backing.   You can create those with libvirt or even&lt;br&gt;
without it, just using qemu-img, for example like this:&lt;br&gt;
&lt;br&gt;
     qemu-img create -b /path/to/non-modified.image -f qcow2 -F&lt;br&gt;
     format_of_backing_file /path/to/new-image.qcow2&lt;br&gt;
&lt;br&gt;
For more information please read the qemu-img manual page to make sure&lt;br&gt;
you use it properly, I just wrote the above from the top of my head, not&lt;br&gt;
tested it.   The backing file path can also be relative.&lt;br&gt;
&lt;br&gt;
If you specify the new image for the machines then the granularity&lt;br&gt;
changes to way smaller blocks than the whole file making it occupy&lt;br&gt;
less space in case of changes.&lt;br&gt;
&lt;br&gt;
&gt;Also I made the same build with Virtualbox and there is no copying of the&lt;br&gt;
&gt;images to /run/live/overlay.&lt;br&gt;
&gt;&lt;br&gt;
&gt;I will do some serious research into squashfs and tmpfs rn.&lt;br&gt;
&gt;&lt;br&gt;
&lt;br&gt;
If you want to figure out when it happens I would suggest enabling debug&lt;br&gt;
logs for libvirt, starting the qemu VM with --paused, but maybe it will&lt;br&gt;
need some more debugging on lower layers.   Anyway I really believe the&lt;br&gt;
approach suggested above is what will lead to better results for you.&lt;br&gt;
&lt;br&gt;
Have a nice day&lt;br&gt;
Martin&lt;br&gt;
&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt;On Wed, Nov 24, 2021, 5:10 PM Martin Kletzander &lt;&lt;a \
href="mailto:mkletzan@redhat.com" rel="noreferrer noreferrer" \
target="_blank"&gt;mkletzan@redhat.com&lt;/a&gt;&gt; wrote:&lt;br&gt; &gt;&lt;br&gt;
&gt;&gt; On Wed, Nov 24, 2021 at 04:01:34PM +0100, Elias Mobery wrote:&lt;br&gt;
&gt;&gt; &gt;Hello Michal, thank you for the reply!&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;I've carefully tested everything you suggested, thanks.&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;I set dynamic_ownership=0 and use these hooks during the live build \
for&lt;br&gt; &gt;&gt; &gt;permissions. (I googled a lot, and apparently libvirt needs the \
images to&lt;br&gt; &gt;&gt; &gt;be executable too)&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;chown -R libvirt-qemu:kvm   /var/lib/libvirt/images&lt;br&gt;
&gt;&gt; &gt;chmod -R g+rwx /var/lib/libvirt/images&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; I do not see why would the images need to be executable, you might need&lt;br&gt;
&gt;&gt; an executable bit set on the directory so that your and qemu user can&lt;br&gt;
&gt;&gt; browse it.&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; &gt;Booting the live debian iso everything works in virt-manager, but \
again,&lt;br&gt; &gt;&gt; &gt;after clicking "run", a copy of the vm image is \
created in&lt;br&gt; &gt;&gt; &gt;/run/live/overlay/rw/var/lib/libvirt/images and only then \
does the VM&lt;br&gt; &gt;&gt; start.&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; Does that happen when you try to run it with virsh instead of&lt;br&gt;
&gt;&gt; virt-manager?   Are you connected to the system daemon?&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; &gt;Either it's still being chowned or chmodded somehow, or it's \
something&lt;br&gt; &gt;&gt; &gt;else, but I can't stop this copy being made.&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;Interestingly, when I boot the Live debian iso and then copy the \
images&lt;br&gt; &gt;&gt; &gt;into /var/lib/libvirt/images from my USB stick, the VM starts \
immediately&lt;br&gt; &gt;&gt; &gt;without creating any copies in the /run/live.... \
directory. So my guess is&lt;br&gt; &gt;&gt; &gt;that maybe the squashfs could be the \
issue?&lt;br&gt; &gt;&gt; &gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; Oh, interesting, is the USB stick filesystem mounted R/W and the live&lt;br&gt;
&gt;&gt; ISO filesystem mounted read-only?   How is the overlay mounted?&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; &gt;Editing the XML&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;&lt;source file='/var/lib/libvirt/images/vm1.qcow2'&gt;&lt;br&gt;
&gt;&gt; &gt;         &lt;seclabel relabel='no'/&gt;&lt;br&gt;
&gt;&gt; &gt;      &lt;/source&gt;&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;This results in an error:&lt;br&gt;
&gt;&gt; &gt;Unsupported Configuration:&lt;br&gt;
&gt;&gt; &gt;Security driver model 'null' not available&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; For issues like this it is most helpful to check the documentation:&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;      &lt;a href="https://libvirt.org/formatdomain.html" rel="noreferrer \
noreferrer noreferrer" target="_blank"&gt;https://libvirt.org/formatdomain.html&lt;/a&gt;&lt;br&gt; \
&gt;&gt;&lt;br&gt; &gt;&gt; where you can see it is just a missing attribute `model`, in \
this case&lt;br&gt; &gt;&gt; model="dac".&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; &gt;Here I tried setting security_driver=none in qemu.conf but same \
error&lt;br&gt; &gt;&gt; after.&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;&lt;/devices&gt;&lt;br&gt;
&gt;&gt; &gt;      &lt;seclabel type='none'/&gt;&lt;br&gt;
&gt;&gt; &gt;   &lt;/domain&gt;&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; Same here.&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; &gt;This also returns an Error but I'm still googling to understand \
it&lt;br&gt; &gt;&gt; properly.&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;XML document failed to validate against schema&lt;br&gt;
&gt;&gt; &gt;Unable to validate doc against /usr/share/libvirt/schemas/domain.rng&lt;br&gt;
&gt;&gt; &gt;Invalid element relabel   for element seclabel&lt;br&gt;
&gt;&gt; &gt;Extra element seclabel in interleave&lt;br&gt;
&gt;&gt; &gt;Element domain failed to validate content&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;Thanks again so much for your helo, I've been messing with this for \
weeks&lt;br&gt; &gt;&gt; &gt;now and it's killing me.&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;On Tue, Nov 23, 2021, 9:43 PM Michal Prívozník &lt;&lt;a \
href="mailto:mprivozn@redhat.com" rel="noreferrer noreferrer" \
target="_blank"&gt;mprivozn@redhat.com&lt;/a&gt;&gt;&lt;br&gt; &gt;&gt; wrote:&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;&gt; On 11/23/21 17:25, Elias Mobery wrote:&lt;br&gt;
&gt;&gt; &gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;&gt; &gt; Hi everyone!&lt;br&gt;
&gt;&gt; &gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;&gt; &gt; I've built a Debian Live ISO with packages qemu and \
libvirt to run a&lt;br&gt; &gt;&gt; VM&lt;br&gt;
&gt;&gt; &gt;&gt; &gt; in the live environment.&lt;br&gt;
&gt;&gt; &gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;&gt; &gt; The guest images are placed in   /var/lib/libvirt/images and \
2GB each.&lt;br&gt; &gt;&gt; &gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;&gt; &gt; Everything works great, except for one issue.&lt;br&gt;
&gt;&gt; &gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;&gt; &gt; When starting a VM, libvirt automatically issues a chown \
command to&lt;br&gt; &gt;&gt; the&lt;br&gt;
&gt;&gt; &gt;&gt; &gt; images, changing ownership.&lt;br&gt;
&gt;&gt; &gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;&gt; &gt; This results in a copy of the images being created in&lt;br&gt;
&gt;&gt; &gt;&gt; &gt; /run/live/overlay/rw/var/lib/libvirt/images&lt;br&gt;
&gt;&gt; &gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;&gt; &gt; I don't want these copies to be made but can't stop \
it.&lt;br&gt; &gt;&gt; &gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;&gt; &gt; I've tried editing qemu.conf user/group, dynamic ownership \
etc.&lt;br&gt; &gt;&gt; without&lt;br&gt;
&gt;&gt; &gt;&gt; &gt; any luck.&lt;br&gt;
&gt;&gt; &gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;&gt; &gt; Is there a way to STOP libvirt from changing the ownership of \
these&lt;br&gt; &gt;&gt; &gt;&gt; images?&lt;br&gt;
&gt;&gt; &gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; &gt;&gt; Setting dynamic_ownership=0 in qemu.conf is the way to go \
(don't forget&lt;br&gt; &gt;&gt; &gt;&gt; to restart the daemon after you made the \
change).&lt;br&gt; &gt;&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; &gt;&gt; Alternatively, you can set &lt;seclabel/&gt; either for whole \
domain or&lt;br&gt; &gt;&gt; &gt;&gt; individual disks, e.g. like this:&lt;br&gt;
&gt;&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; &gt;&gt;     &lt;disk type='file' device='disk'&gt;&lt;br&gt;
&gt;&gt; &gt;&gt;        &lt;driver name='qemu' type='qcow2'/&gt;&lt;br&gt;
&gt;&gt; &gt;&gt;        &lt;source \
file='/var/lib/libvirt/images/vm1.qcow2'&gt;&lt;br&gt; &gt;&gt; &gt;&gt;           \
&lt;seclabel relabel='no'/&gt;&lt;br&gt; &gt;&gt; &gt;&gt;        \
&lt;/source&gt;&lt;br&gt; &gt;&gt; &gt;&gt;     &lt;/disk&gt;&lt;br&gt;
&gt;&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; &gt;&gt; or for whole domain:&lt;br&gt;
&gt;&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; &gt;&gt;        ...&lt;br&gt;
&gt;&gt; &gt;&gt;        &lt;/devices&gt;&lt;br&gt;
&gt;&gt; &gt;&gt;        &lt;seclabel type='none'/&gt;&lt;br&gt;
&gt;&gt; &gt;&gt;     &lt;/domain&gt;&lt;br&gt;
&gt;&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; &gt;&gt; I'm not sure what your setup is, but if chown() is a problem \
then what&lt;br&gt; &gt;&gt; &gt;&gt; if guest tries to write onto its disk? Wouldn't \
that create a copy in&lt;br&gt; &gt;&gt; &gt;&gt; overlay?&lt;br&gt;
&gt;&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; &gt;&gt; Michal&lt;br&gt;
&gt;&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; &gt;&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20211117192815</emailId><senderName>Laine Stump</senderName><senderEmail>laine@redhat.com</senderEmail><timestampReceived>2021-11-17 19:28:15-0400</timestampReceived><subject>Re: configure path name of ebtables executable</subject><body>



On 11/17/21 1:39 PM, Michael Ströder wrote:
&gt; HI!
&gt; 
&gt; Is it possible to configure the full path name of the ebtables 
&gt; executable used somewhere in libvirt's config?

That's done in meson.build when you're building from source. Look for 
"optional_programs".

&gt; 
&gt; Background: I'd like to avoid automatic alternatives implementation to 
&gt; mess up libvirt installation.
&gt; 
&gt; See also:
&gt; https://bugzilla.opensuse.org/show_bug.cgi?id=1192799

I don't think the problem is what is being suggested in that bug.
Your claim about /etc/alternatives in comment 3 doesn't make any sense - 
I have ebtables-2.0.11 installed on my Fedora machine, and it is using 
/etc/alternatives, and I don't get that error message.

Try running this command:


    /sbin/ebtables -t nat -N xyzzy

and see if it gives you the same error. If it does, then follow the 
symlink from /sbin/ebtables to (probably) /etc/alternatives/ebtables and 
to the final destination from there - you should either end up with 
/usr/sbin/ebtables-legacy or /usr/sbin/ebtables-nft. If you don't, then 
your "alternatives" stuff is messed up, and you need to fix that.

I just checked the current source code for ebtables and the word 
"subcommand" doesn't appear anywhere in it. This sounds more like SUSE 
has some sort of special off-brand alternative that doesn't understand 
all valid ebtables commands (because the command being complained about 
in the error message in the bug *is* a valid ebtables commandline); 
maybe something that put's a shell script wrapper around calling 
ebtables or something?. If so, you need to switch away from that 
alternative, or somebody needs to fix the alternative.

Anyway, I think you'd be better off fixing the problem at the source 
rather than trying to make some special local build of libvirt to work 
around the problem.

</body></email><email><emailId>20211117215244</emailId><senderName>Michael_Ströder</senderName><senderEmail>michael@stroeder.com</senderEmail><timestampReceived>2021-11-17 21:52:44-0400</timestampReceived><subject>Re: configure path name of ebtables executable</subject><body>

On 11/17/21 20:28, Laine Stump wrote:
&gt; On 11/17/21 1:39 PM, Michael Ströder wrote:
&gt;&gt; Is it possible to configure the full path name of the ebtables 
&gt;&gt; executable used somewhere in libvirt's config?
&gt; 
&gt; That's done in meson.build when you're building from source. Look for 
&gt; "optional_programs".

Noted. Thanks.

&gt;&gt; Background: I'd like to avoid automatic alternatives implementation to 
&gt;&gt; mess up libvirt installation.
&gt;&gt;
&gt;&gt; See also:
&gt;&gt; https://bugzilla.opensuse.org/show_bug.cgi?id=1192799
&gt; 
&gt; I don't think the problem is what is being suggested in that bug.

Yes, it is.

&gt; follow the symlink from /sbin/ebtables to (probably)
&gt; /etc/alternatives/ebtables &gt; [..]
&gt; This sounds more like SUSE has some sort of special off-brand
&gt; alternative that doesn't understand all valid ebtables commands
openSUSE Tumbleweed now uses libalternatives for ebtables (see my 
comment#2) and thus
/sbin/ebtables was linked to /usr/bin/alts. Yes, something's broken 
there and I was looking for a work-around.

&gt; Anyway, I think you'd be better off fixing the problem at the source
&gt; rather than trying to make some special local build of libvirt to
&gt; work around the problem.
IMHO a libvirtd.conf option would be great to avoid relying on this 
alternatives stuff.

Ciao, Michael.


</body></email><email><emailId>20211116012841</emailId><senderName>Daniel Romero</senderName><senderEmail>romero.cl@gmail.com</senderEmail><timestampReceived>2021-11-16 01:28:41-0400</timestampReceived><subject>Re: Cannot access KVM using virsh console after KVM rebooted or shut off</subject><body>

Hi,

Try to enable vnc on your vm, then try to connect using that protocol and see what \
happens. 

You can use chicken of the vnc os x client to connect and be sure your host machine \
have the right ports open for incoming vnc connections (start at 5900). 

Best regards,
DR

Sent from my Atari 800 XL

&gt; On 15-11-2021, at 20:13, Yifei Liu &lt;yifeliu@cs.stonybrook.edu&gt; wrote:
&gt; 
&gt; ﻿Dear all,
&gt; 
&gt; I used ssh with -X option to connect to an Ubuntu remote server where I applied \
&gt; virsh  (libvirt) to manage my KVM virtual machines, and my local machine is MacOS. \
&gt; Then,  I used virt-install to install a Tiny Core Linux VM, and I got a pop-up Virt \
&gt; Viewer window  (via XQuartz) which is the console for my Tiny Core VM. However, if \
&gt; I rebooted my VM,  then I checked the VM state by virsh list --all which was \
&gt; running. Then, I tried  `virsh console my_vm_domain` but this command got stuck on:
&gt; &gt; Connected to domain my_vm_domain
&gt; &gt; Escape character is ^]
&gt; 
&gt; The `virsh console` command hung without any response. This issue also happened \
&gt; when  I used virsh console after I shut down and later started the VM. Even the VM \
&gt; was already  started, I cannot return to the VM console by `virsh console`.
&gt; 
&gt; I can get the VM console in Virt Viewer at the first boot (using virt-install). 
&gt; But, if I shutdown the VM once, I can never access the VM console by virsh console \
&gt; even  the VM state is running. Any idea about how to use virsh console? 
&gt; 
&gt; Thanks,
&gt; Yifei
&gt; 
&gt; 


</body></email><email><emailId>20211123082800</emailId><senderName>Michal PrÃ­voznÃ­k</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-11-23 08:28:00-0400</timestampReceived><subject>Re: Questions on device-added and device-removed events</subject><body>

On 11/18/21 07:37, Han Han wrote:
&gt; Hi developers,
&gt; When the guest OS is booting, the event for live attachment could be
&gt; caught by libvirt, while the event for live detachment could not.
&gt; Version:
&gt; libvirt-7.9
&gt; qemu-kvm-6.1
&gt; 
&gt; Steps:
&gt; Terminal 1:
&gt; ➜  ~ virsh event --loop --all
&gt; 
&gt; Terminal 2:
&gt; ➜  ~ virsh start avocado-vt-vm1; qemu-img create /tmp/vdb 10M; virsh
&gt; attach-disk avocado-vt-vm1 /tmp/vdb vdb; virsh detach-disk
&gt; avocado-vt-vm1 vdb
&gt; 
&gt; The outputs from terminal 1:
&gt; event 'agent-lifecycle' for domain 'avocado-vt-vm1': state:
&gt; 'disconnected' reason: 'domain started'      
&gt; event 'lifecycle' for domain 'avocado-vt-vm1': Resumed Unpaused
&gt; event 'lifecycle' for domain 'avocado-vt-vm1': Started Booted
&gt; event 'device-added' for domain 'avocado-vt-vm1': virtio-disk1
&gt; event 'agent-lifecycle' for domain 'avocado-vt-vm1': state: 'connected'
&gt; reason: 'channel event'
&gt; 
&gt; As you can see, the device live attachment and the device detachment are
&gt; both executed when the guest OS is booting, but there is only the event
&gt; 'device-added' is recorded.
&gt; So my questions are:
&gt; 1. Is it the expected results for the results above?
&gt; 2. If so, what is the internal difference between 'device-added' and
&gt; 'device-removed'?
&gt; 3. I notice there is the DEVICE_DELETED event in qmp? Any relation
&gt; between the 'device-removed' of libvirt and the DEVICE_DELETED of qmp?

Detaching a device requires the guest cooperation, while in contrast the
device attach does not. So I'm guessing that your guest isn't in a state
where it can satisfy the detach request.

The DEVICE_REMOVED event is emitted whenever DEVICE_DELETED event
appears on the monitor (may be delayed for a couple of microseconds,
because libvirt needs to update its internal state first).

Hope this helps.

Michal

</body></email><email><emailId>20211125123911</emailId><senderName>Martin Kletzander</senderName><senderEmail>mkletzan@redhat.com</senderEmail><timestampReceived>2021-11-25 12:39:11-0400</timestampReceived><subject>Re: Libvirt + Debian Live = Heart Attack</subject><body>


On Thu, Nov 25, 2021 at 01:21:23PM +0100, Elias Mobery wrote:
&gt;Hey Martin, wow thanks for the detailed info!
&gt;
&gt;I'll definitely look into this, but I kind of figured it out, I believe.
&gt;
&gt;So, I keep the images in the read-only squashfs, boot the live system and
&gt;use snapshot writeback:
&gt;virsh snapshot-create-as with options --disk-only --diskspec
&gt;

Well, this basically does a very similar thing, only in a way that
libvirt keeps more metadata about the fact.

&gt;This pretty much fixes my problem, and only disk writes occur in tmpfs,
&gt;instead of the entire image being copied.
&gt;
&gt;BUT, now I have to reduce the disk space within the  VM to almost 0 to save
&gt;space.
&gt;

Not sure which space you mean.  If that is inside the VM, then
uninstalling unneeded stuff is the way to go, if it is the image file in
the ISO, then virt-sparsify before creating the ISO will punch holes
where there is no usable data.  If you mean in the overlay/snapshot,
then it only records the changes.

&gt;I'm reading up on qemu-img convert and virt-sparsify to accomplish this,
&gt;but I will also try your method now, it seems more professional.
&gt;
&gt;Thank you for your amazing input and patience, I love this community.
&gt;Sharing this information is the literal definition of freedom IMO, thank
&gt;you all!
&gt;

Thanks ;)

&gt;On Thu, Nov 25, 2021, 11:40 AM Martin Kletzander &lt;mkletzan@redhat.com&gt;
&gt;wrote:
&gt;
&gt;&gt; On Wed, Nov 24, 2021 at 06:21:22PM +0100, Elias Mobery wrote:
&gt;&gt; &gt;Hey Martin &amp; Michal, thank you both for the replies!
&gt;&gt; &gt;
&gt;&gt; &gt;Yes, sorry I messed up that seclabel entry, thanks. I fixed it and there
&gt;&gt; is
&gt;&gt; &gt;no more error, but the images are still copied unfortunately.
&gt;&gt; &gt;
&gt;&gt; &gt;@Michal yes, I have been reading the Debian Live Manual like a contract,
&gt;&gt; &gt;after messing with qemu.conf and permissions for days, I think its
&gt;&gt; &gt;something in the live build and not libvirt.
&gt;&gt; &gt;
&gt;&gt; &gt;@Martin yeah both virsh start and virt-manager cause the images to be
&gt;&gt; &gt;copied to /run..... first.
&gt;&gt; &gt;
&gt;&gt; &gt;Yes, when I boot the Debian Live ISO, plug in the USB (mounted rw), copy
&gt;&gt; &gt;the images to the live system from the USB and click run in virt-manager,
&gt;&gt; &gt;the VM starts instantly and no copies are made in /run....
&gt;&gt; &gt;
&gt;&gt; &gt;I use ISO loopback and toram to load the system directly into ram via
&gt;&gt; tmpfs
&gt;&gt; &gt;mount. That's my grub.cfg
&gt;&gt; &gt;
&gt;&gt; &gt;menuentry "debian-live.iso" { set iso="/ISO/debian-live.iso" set
&gt;&gt; &gt;root=(hd0,5) loopback loop $iso linux (loop)/live/vmlinuz-4.19.0-6-amd64
&gt;&gt; &gt;boot=live components toram findiso=$iso initrd
&gt;&gt; &gt;(loop)/live/initrd.img-4.19.0-6-amd64 }
&gt;&gt; &gt;
&gt;&gt; &gt;So, the squashfs is mounted read-only in
&gt;&gt; &gt;/run/live/rootfs/filesystem.squashfs and its /dev/loop1
&gt;&gt; &gt;
&gt;&gt; &gt;/proc/mounts says:
&gt;&gt; &gt;
&gt;&gt; &gt;tmpfs /run/live/overlay rw
&gt;&gt; &gt;overlay rw  lowerdir=/run/live/rootfs/filesystem.squashfs
&gt;&gt; &gt;upperdir=/run/live/overlay/rw  (same place where the images are copied)
&gt;&gt; &gt;
&gt;&gt;
&gt;&gt; I do not think this is relevant, but sometimes overlayfs wants to have a
&gt;&gt; workdir as well.
&gt;&gt;
&gt;&gt; &gt;So you think that because the images are part of the squashfs which is
&gt;&gt; &gt;read-only, they are first copied to /run/live/overlay/rw... to be written
&gt;&gt; &gt;to?
&gt;&gt; &gt;
&gt;&gt;
&gt;&gt; Are they really copied?  I can't think of many more things why this
&gt;&gt; would happen.  Maybe some locking code does that in the backend (both
&gt;&gt; libvirt and qemu lock parts of the disks).
&gt;&gt;
&gt;&gt; &gt;I always thought that tmpfs is mounted on top of squash, so it's as if the
&gt;&gt; &gt;squashfs were writable, without having to literally copy between the two
&gt;&gt; &gt;filesystems.
&gt;&gt; &gt;
&gt;&gt;
&gt;&gt; It is not mounted over, if you mount over something you lose the
&gt;&gt; lowerdir, that's why it needs to be done with overlayfs which does the
&gt;&gt; copy-on-write.
&gt;&gt;
&gt;&gt; That leads me to another idea.  Since you want copy-on-write for the
&gt;&gt; images, I presume, the image will get copied anyway once the guest
&gt;&gt; writes even a single byte to the image.  Unfortunately overlayfs is not
&gt;&gt; the best way for this scenario due to the granularity it offers
&gt;&gt; (per-file, not per-block or anything smaller).  What I think you
&gt;&gt; actually want in this case is to have a qcow image with the original
&gt;&gt; image used as backing.  You can create those with libvirt or even
&gt;&gt; without it, just using qemu-img, for example like this:
&gt;&gt;
&gt;&gt;    qemu-img create -b /path/to/non-modified.image -f qcow2 -F
&gt;&gt;    format_of_backing_file /path/to/new-image.qcow2
&gt;&gt;
&gt;&gt; For more information please read the qemu-img manual page to make sure
&gt;&gt; you use it properly, I just wrote the above from the top of my head, not
&gt;&gt; tested it.  The backing file path can also be relative.
&gt;&gt;
&gt;&gt; If you specify the new image for the machines then the granularity
&gt;&gt; changes to way smaller blocks than the whole file making it occupy
&gt;&gt; less space in case of changes.
&gt;&gt;
&gt;&gt; &gt;Also I made the same build with Virtualbox and there is no copying of the
&gt;&gt; &gt;images to /run/live/overlay.
&gt;&gt; &gt;
&gt;&gt; &gt;I will do some serious research into squashfs and tmpfs rn.
&gt;&gt; &gt;
&gt;&gt;
&gt;&gt; If you want to figure out when it happens I would suggest enabling debug
&gt;&gt; logs for libvirt, starting the qemu VM with --paused, but maybe it will
&gt;&gt; need some more debugging on lower layers.  Anyway I really believe the
&gt;&gt; approach suggested above is what will lead to better results for you.
&gt;&gt;
&gt;&gt; Have a nice day
&gt;&gt; Martin
&gt;&gt;
&gt;&gt; &gt;
&gt;&gt; &gt;
&gt;&gt; &gt;
&gt;&gt; &gt;On Wed, Nov 24, 2021, 5:10 PM Martin Kletzander &lt;mkletzan@redhat.com&gt;
&gt;&gt; wrote:
&gt;&gt; &gt;
&gt;&gt; &gt;&gt; On Wed, Nov 24, 2021 at 04:01:34PM +0100, Elias Mobery wrote:
&gt;&gt; &gt;&gt; &gt;Hello Michal, thank you for the reply!
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt;I've carefully tested everything you suggested, thanks.
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt;I set dynamic_ownership=0 and use these hooks during the live build for
&gt;&gt; &gt;&gt; &gt;permissions. (I googled a lot, and apparently libvirt needs the images
&gt;&gt; to
&gt;&gt; &gt;&gt; &gt;be executable too)
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt;chown -R libvirt-qemu:kvm  /var/lib/libvirt/images
&gt;&gt; &gt;&gt; &gt;chmod -R g+rwx /var/lib/libvirt/images
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; I do not see why would the images need to be executable, you might need
&gt;&gt; &gt;&gt; an executable bit set on the directory so that your and qemu user can
&gt;&gt; &gt;&gt; browse it.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; &gt;Booting the live debian iso everything works in virt-manager, but
&gt;&gt; again,
&gt;&gt; &gt;&gt; &gt;after clicking "run", a copy of the vm image is created in
&gt;&gt; &gt;&gt; &gt;/run/live/overlay/rw/var/lib/libvirt/images and only then does the VM
&gt;&gt; &gt;&gt; start.
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Does that happen when you try to run it with virsh instead of
&gt;&gt; &gt;&gt; virt-manager?  Are you connected to the system daemon?
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; &gt;Either it's still being chowned or chmodded somehow, or it's something
&gt;&gt; &gt;&gt; &gt;else, but I can't stop this copy being made.
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt;Interestingly, when I boot the Live debian iso and then copy the images
&gt;&gt; &gt;&gt; &gt;into /var/lib/libvirt/images from my USB stick, the VM starts
&gt;&gt; immediately
&gt;&gt; &gt;&gt; &gt;without creating any copies in the /run/live.... directory. So my
&gt;&gt; guess is
&gt;&gt; &gt;&gt; &gt;that maybe the squashfs could be the issue?
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Oh, interesting, is the USB stick filesystem mounted R/W and the live
&gt;&gt; &gt;&gt; ISO filesystem mounted read-only?  How is the overlay mounted?
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; &gt;Editing the XML
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt;&lt;source file='/var/lib/libvirt/images/vm1.qcow2'&gt;
&gt;&gt; &gt;&gt; &gt;      &lt;seclabel relabel='no'/&gt;
&gt;&gt; &gt;&gt; &gt;    &lt;/source&gt;
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt;This results in an error:
&gt;&gt; &gt;&gt; &gt;Unsupported Configuration:
&gt;&gt; &gt;&gt; &gt;Security driver model 'null' not available
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; For issues like this it is most helpful to check the documentation:
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt;    https://libvirt.org/formatdomain.html
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; where you can see it is just a missing attribute `model`, in this case
&gt;&gt; &gt;&gt; model="dac".
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; &gt;Here I tried setting security_driver=none in qemu.conf but same error
&gt;&gt; &gt;&gt; after.
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt;&lt;/devices&gt;
&gt;&gt; &gt;&gt; &gt;    &lt;seclabel type='none'/&gt;
&gt;&gt; &gt;&gt; &gt;  &lt;/domain&gt;
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Same here.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; &gt;This also returns an Error but I'm still googling to understand it
&gt;&gt; &gt;&gt; properly.
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt;XML document failed to validate against schema
&gt;&gt; &gt;&gt; &gt;Unable to validate doc against /usr/share/libvirt/schemas/domain.rng
&gt;&gt; &gt;&gt; &gt;Invalid element relabel  for element seclabel
&gt;&gt; &gt;&gt; &gt;Extra element seclabel in interleave
&gt;&gt; &gt;&gt; &gt;Element domain failed to validate content
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt;Thanks again so much for your helo, I've been messing with this for
&gt;&gt; weeks
&gt;&gt; &gt;&gt; &gt;now and it's killing me.
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt;On Tue, Nov 23, 2021, 9:43 PM Michal Prívozník &lt;mprivozn@redhat.com&gt;
&gt;&gt; &gt;&gt; wrote:
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt;&gt; On 11/23/21 17:25, Elias Mobery wrote:
&gt;&gt; &gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt;&gt; &gt; Hi everyone!
&gt;&gt; &gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt;&gt; &gt; I've built a Debian Live ISO with packages qemu and libvirt to run
&gt;&gt; a
&gt;&gt; &gt;&gt; VM
&gt;&gt; &gt;&gt; &gt;&gt; &gt; in the live environment.
&gt;&gt; &gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt;&gt; &gt; The guest images are placed in  /var/lib/libvirt/images and 2GB
&gt;&gt; each.
&gt;&gt; &gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt;&gt; &gt; Everything works great, except for one issue.
&gt;&gt; &gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt;&gt; &gt; When starting a VM, libvirt automatically issues a chown command to
&gt;&gt; &gt;&gt; the
&gt;&gt; &gt;&gt; &gt;&gt; &gt; images, changing ownership.
&gt;&gt; &gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt;&gt; &gt; This results in a copy of the images being created in
&gt;&gt; &gt;&gt; &gt;&gt; &gt; /run/live/overlay/rw/var/lib/libvirt/images
&gt;&gt; &gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt;&gt; &gt; I don't want these copies to be made but can't stop it.
&gt;&gt; &gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt;&gt; &gt; I've tried editing qemu.conf user/group, dynamic ownership etc.
&gt;&gt; &gt;&gt; without
&gt;&gt; &gt;&gt; &gt;&gt; &gt; any luck.
&gt;&gt; &gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt;&gt; &gt; Is there a way to STOP libvirt from changing the ownership of these
&gt;&gt; &gt;&gt; &gt;&gt; images?
&gt;&gt; &gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; &gt;&gt; Setting dynamic_ownership=0 in qemu.conf is the way to go (don't
&gt;&gt; forget
&gt;&gt; &gt;&gt; &gt;&gt; to restart the daemon after you made the change).
&gt;&gt; &gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; &gt;&gt; Alternatively, you can set &lt;seclabel/&gt; either for whole domain or
&gt;&gt; &gt;&gt; &gt;&gt; individual disks, e.g. like this:
&gt;&gt; &gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; &gt;&gt;   &lt;disk type='file' device='disk'&gt;
&gt;&gt; &gt;&gt; &gt;&gt;     &lt;driver name='qemu' type='qcow2'/&gt;
&gt;&gt; &gt;&gt; &gt;&gt;     &lt;source file='/var/lib/libvirt/images/vm1.qcow2'&gt;
&gt;&gt; &gt;&gt; &gt;&gt;       &lt;seclabel relabel='no'/&gt;
&gt;&gt; &gt;&gt; &gt;&gt;     &lt;/source&gt;
&gt;&gt; &gt;&gt; &gt;&gt;   &lt;/disk&gt;
&gt;&gt; &gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; &gt;&gt; or for whole domain:
&gt;&gt; &gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; &gt;&gt;     ...
&gt;&gt; &gt;&gt; &gt;&gt;     &lt;/devices&gt;
&gt;&gt; &gt;&gt; &gt;&gt;     &lt;seclabel type='none'/&gt;
&gt;&gt; &gt;&gt; &gt;&gt;   &lt;/domain&gt;
&gt;&gt; &gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; &gt;&gt; I'm not sure what your setup is, but if chown() is a problem then
&gt;&gt; what
&gt;&gt; &gt;&gt; &gt;&gt; if guest tries to write onto its disk? Wouldn't that create a copy in
&gt;&gt; &gt;&gt; &gt;&gt; overlay?
&gt;&gt; &gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; &gt;&gt; Michal
&gt;&gt; &gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt;
&gt;&gt;

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20211130075838</emailId><senderName>Peter Krempa</senderName><senderEmail>pkrempa@redhat.com</senderEmail><timestampReceived>2021-11-30 07:58:38-0400</timestampReceived><subject>Re: virsh blockjob $domain --abort</subject><body>

On Tue, Nov 30, 2021 at 08:15:30 +0200, Jeff Brown wrote:
&gt; Please advise:
&gt; 
&gt; After a scheduled crontab snapshot backup of a VM it failed to do a
&gt; blockcommit, and is currently writing to both the snapshot and the original
&gt; QCOW2 images.
&gt; 
&gt; (I don't think it's a bug, and suspect that I caused it by running the
&gt; backup script manually while the snapshot was already running.)
&gt; 
&gt; $ virsh blockcommit VM sda --active --pivot --shallow --verbose
&gt; error: block copy still active: disk 'sda' already in active block job

The '--pivot' switch here ...

&gt; 
&gt; $ virsh blockjob VM sda --info
&gt; Active Block Commit: [100 %]
&gt; 
&gt; $ virsh domblkerror VM
&gt; No errors found
&gt; 
&gt; Running on Debian 9 (Stretch).
&gt; 
&gt; $ virsh version
&gt; Compiled against library: libvirt 3.0.0
&gt; Using library: libvirt 3.0.0
&gt; Using API: QEMU 3.0.0
&gt; Running hypervisor: QEMU 2.8.1

(this is a rather old libvirt version, but what I suggest below should
work)

&gt; 
&gt; Now, I've read up on the probable solution, somewhat, but running $ virsh
&gt; blockjob $domain --abort on this production server scares me; and I'm just
&gt; asking whether it would be advisable to stop services and make a full data
&gt; backup prior to doing so? It would entail taking the services offline for at
&gt; least an hour. The snapshot is currently at 12GB,  and according to blockjob
&gt; --info the VM image is 100% in synch.

... is equivalent to do a 'virsh blockjob $VM $DISK --pivot' after the
blockjob is complete. In your case, the original virsh invocation was
probably killed or missed the finishing event and thus didn't finalize
the blockjob.

</body></email><email><emailId>20211130102502</emailId><senderName>Andrea Bolognani</senderName><senderEmail>abologna@redhat.com</senderEmail><timestampReceived>2021-11-30 10:25:02-0400</timestampReceived><subject>Re: Fwd: Installing virtiofs drivers on Windows 11....</subject><body>

Please don't top post on technical lists.

On Tue, Nov 30, 2021 at 10:31:47AM +0100, Mario Marietto wrote:
&gt; &gt; &gt; I'm confused. Anyway,since I don't know how it works virtiofs,I'm using
&gt; &gt; &gt; virtio-9p every day. So I can say that bhyve already supports virtio-9p.
&gt; &gt; &gt; This is how I make it work under Linux :
&gt; &gt; &gt;
&gt; &gt; &gt; -s 8,virtio-9p,sharename=&lt;host-dir-path&gt;
&gt; &gt; &gt;
&gt; &gt; &gt; In the guest I need something like :
&gt; &gt; &gt;
&gt; &gt; &gt; mount -t 9p -o trans=virtio,version=9p2000.L,rw sharename /mnt
&gt; &gt; &gt;
&gt; &gt; &gt; I assume that what's missing on Windows 10 is only the ability to mount
&gt; &gt; &gt; the shared folder.

Correct. FreeBSD as a host supports virtio-9p, but Windows as a guest
doesn't have the necessary drivers as far as I can tell.

&gt; &gt; &gt; Since mount is a linux command and windows 10 / 11
&gt; &gt; &gt; supports linux with it's proper kernel,a good idea could be to try to mount
&gt; &gt; &gt; the shared resource within the WSL2  :)

&gt;From what I understand, 9p is used by Windows to make its files
available to Linux in WSL2. In that scenario, Windows acts as the
server; what you would need is for Windows to be a 9p client.

I don't think there's a way you can simply forward the 9p server
created by bhyve to WSL2, but even if you could do that you'd only be
able to access the host's file from within WSL2, which is probably
not what you were looking for.

&gt; &gt; ok I can't because bhyve does not support nested virtualization. sorry for
&gt; &gt; the mistake.

Right, this makes the above idea even less feasible.

&gt; It seems that it can work on Windows guest. Did you miss this thread ?
&gt;
&gt; https://github.com/virtio-win/kvm-guest-drivers-windows/issues/126

I've skimmed the thread, and I've seen no indication in it that a
virtio-9p driver for Windows has been produced.

Once again, virtio-9p and virtiofs are two completely different
things, and the fact that a Windows driver for the latter exists
doesn't mean that the former will work. You'd need a separate driver,
and to the best of my knowledge one doesn't currently exist.

Yes, the fact that virtio-9p is sometimes also referred to as
"VirtFS" is extremely confusing :(

All reports of success in that thread seem to come from people who
are using virtiofs, not virtio-9p. You could certainly do the same if
you were using QEMU, but bhyve doesn't have virtiofs support yet.

-- 
Andrea Bolognani / Red Hat / Virtualization

</body></email><email><emailId>20211130111408</emailId><senderName>Andrea Bolognani</senderName><senderEmail>abologna@redhat.com</senderEmail><timestampReceived>2021-11-30 11:14:08-0400</timestampReceived><subject>Re: virsh create fails with "Unable to find any firmware to satisfy 'efi'" for aarch64 guest on macO</subject><body>

On Tue, Nov 30, 2021 at 11:06:27AM +0000, Daniel P. Berrangé wrote:
&gt; On Tue, Nov 30, 2021 at 02:40:07AM -0800, Andrea Bolognani wrote:
&gt; &gt; Michal, have you actually looked at the patch mentioned earlier? If
&gt; &gt; not, you can perhaps do a clean room implementation of the fix based
&gt; &gt; on the information provided above and get us out of this stalemate?
&gt; &gt;
&gt; &gt; It's quite a simple change, but having seen the original patch I feel
&gt; &gt; like I couldn't possibly submit it myself and still be in the clear.
&gt;
&gt; We're over thinking things here. The way this change is implemented
&gt; is the only way anyone would write this code, and is a simple cut+paste
&gt; from the code pattern in the lines above so arguably already a derived
&gt; work. This is not a bit of code that meets the criteria to taint you
&gt; from a copyright POV.
&gt;
&gt; I just implemented &amp; posted the obvious fix in virArch and it is
&gt; identical to the patch referenced earlier in this thread, rather
&gt; proving my point.

I trust your judgement on this, hence my R-b :) Thanks!

-- 
Andrea Bolognani / Red Hat / Virtualization


</body></email><email><emailId>20211130134450</emailId><senderName>Piotr Kliczewski</senderName><senderEmail>pkliczew@redhat.com</senderEmail><timestampReceived>2021-11-30 13:44:50-0400</timestampReceived><subject>[FOSDEM][CFP] Virtualization &amp; IaaS Devroom</subject><body>

We are excited to announce that the call for proposals is now open for the
Virtualization &amp; IaaS devroom at the upcoming FOSDEM 2022, to be hosted
virtually on February 5th 2022.

This year will mark FOSDEM's 22nd anniversary as one of the longest-running
free and open source software developer events, attracting thousands of
developers and users from all over the world. Due to Covid-19, FOSDEM will
be held virtually this year on February 5th &amp; 6th, 2022.

About the Devroom

The Virtualization &amp; IaaS devroom will feature session topics such as open
source hypervisors and virtual machine managers such as Xen Project, KVM,
bhyve, and VirtualBox, and Infrastructure-as-a-Service projects such as
KubeVirt, Apache CloudStack, Foreman, OpenStack, oVirt, QEMU and OpenNebula.

This devroom will host presentations that focus on topics of shared
interest, such as KVM; libvirt; shared storage; virtualized networking;
cloud security; clustering and high availability; interfacing with multiple
hypervisors; hyperconverged deployments; and scaling across hundreds or
thousands of servers.

Presentations in this devroom will be aimed at users or developers working
on these platforms who are looking to collaborate and improve shared
infrastructure or solve common problems. We seek topics that encourage
dialog between projects and continued work post-FOSDEM.

Important Dates

Submission deadline: 20th of December

Acceptance notifications: 25th of December

Final schedule announcement: 31st of December

Recorded presentations upload deadline: 15th of January

Devroom: 6th February 2022

Submit Your Proposal

All submissions must be made via the Pentabarf event planning site[1]. If
you have not used Pentabarf before, you will need to create an account. If
you submitted proposals for FOSDEM in previous years, you can use your
existing account.

After creating the account, select Create Event to start the submission
process. Make sure to select Virtualization and IaaS devroom from the Track
list. Please fill out all the required fields, and provide a meaningful
abstract and description of your proposed session.

Submission Guidelines

We expect more proposals than we can possibly accept, so it is vitally
important that you submit your proposal on or before the deadline. Late
submissions are unlikely to be considered.

All presentation slots are 30 minutes, with 20 minutes planned for
presentations, and 10 minutes for Q&amp;A.

All presentations will need to be pre-recorded and put into our system at
least a couple of weeks before the event.

The presentations should be uploaded by 15th of January and made available
under Creative

Commons licenses. In the Submission notes field, please indicate that you
agree that your presentation will be licensed under the CC-By-SA-4.0 or
CC-By-4.0 license and that you agree to have your presentation recorded.
For example:

"If my presentation is accepted for FOSDEM, I hereby agree to license all
recordings, slides, and other associated materials under the Creative
Commons Attribution Share-Alike 4.0 International License. Sincerely,
&lt;NAME&gt;."

In the Submission notes field, please also confirm that if your talk is
accepted, you will be able to attend the virtual FOSDEM event for the Q&amp;A.
We will not consider proposals from prospective speakers who are unsure
whether they will be able to attend the FOSDEM virtual event.

If you are experiencing problems with Pentabarf, the proposal submission
interface, or have other questions, you can email our devroom mailing
list[2] and we will try to help you.


Code of Conduct

Following the release of the updated code of conduct for FOSDEM, we'd like
to remind all speakers and attendees that all of the presentations and
discussions in our devroom are held under the guidelines set in the CoC and
we expect attendees, speakers, and volunteers to follow the CoC at all
times.

If you submit a proposal and it is accepted, you will be required to
confirm that you accept the FOSDEM CoC. If you have any questions about the
CoC or wish to have one of the devroom organizers review your presentation
slides or any other content for CoC compliance, please email us and we will
do our best to assist you.

Call for Volunteers

We are also looking for volunteers to help run the devroom. We need
assistance with helping speakers to record the presentation as well as
helping with streaming and chat moderation for the devroom. Please contact
devroom mailing list [2] for more information.

Questions?

If you have any questions about this devroom, please send your questions to
our devroom mailing list. You can also subscribe to the list to receive
updates about important dates, session announcements, and to connect with
other attendees.

See you all at FOSDEM!

[1] https://penta.fosdem.org/submission/FOSDEM22

[2] iaas-virt-devroom at lists.fosdem.org

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt" \
id="gmail-docs-internal-guid-1dabff4d-7fff-f2d7-5c15-17d494f16136"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;We \
are excited to announce that the call for proposals is now open for the \
Virtualization &amp; IaaS devroom at the upcoming FOSDEM 2022, to be hosted virtually \
on February 5th 2022.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;This \
year will mark FOSDEM's 22nd anniversary as one of the longest-running free and open \
source software developer events, attracting thousands of developers and users from \
all over the world. Due to Covid-19, FOSDEM will be held virtually this year on \
February 5th &amp; 6th, 2022.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;About \
the Devroom&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;The \
Virtualization &amp; IaaS devroom will feature session topics such as open source \
hypervisors and virtual machine managers such as Xen Project, KVM, bhyve, and \
VirtualBox, and Infrastructure-as-a-Service projects such as KubeVirt, Apache \
CloudStack, Foreman, OpenStack, oVirt, QEMU and OpenNebula.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p \
dir="ltr" style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;This \
devroom will host presentations that focus on topics of shared interest, such as KVM; \
libvirt; shared storage; virtualized networking; cloud security; clustering and high \
availability; interfacing with multiple hypervisors; hyperconverged deployments; and \
scaling across hundreds or thousands of servers.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;Presentations \
in this devroom will be aimed at users or developers working on these platforms who \
are looking to collaborate and improve shared infrastructure or solve common \
problems. We seek topics that encourage dialog between projects and continued work \
post-FOSDEM.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;Important \
Dates&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;Submission \
deadline: 20th of December&lt;/span&gt;&lt;/p&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;Acceptance \
notifications: 25th of December&lt;/span&gt;&lt;/p&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;Final \
schedule announcement: 31st of December&lt;/span&gt;&lt;/p&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;Recorded \
presentations upload deadline: 15th of January&lt;/span&gt;&lt;/p&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;Devroom: \
6th February 2022&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;Submit \
Your Proposal&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;All \
submissions must be made via the Pentabarf event planning site[1]. If you have not \
used Pentabarf before, you will need to create an account. If you submitted proposals \
for FOSDEM in previous years, you can use your existing account.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p \
dir="ltr" style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;After \
creating the account, select Create Event to start the submission process. Make sure \
to select Virtualization and IaaS devroom from the Track list. Please fill out all \
the required fields, and provide a meaningful abstract and description of your \
proposed session.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;Submission \
Guidelines&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;We \
expect more proposals than we can possibly accept, so it is vitally important that \
you submit your proposal on or before the deadline. Late submissions are unlikely to \
be considered.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;All \
presentation slots are 30 minutes, with 20 minutes planned for presentations, and 10 \
minutes for Q&amp;A.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:700;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;All \
presentations will need to be pre-recorded and put into our system at least a couple \
of weeks before the event.&lt;/span&gt;&lt;/p&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;The \
presentations should be uploaded by 15th of January&lt;/span&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(255,0,0);background-color:transparen \
t;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt; \
&lt;/span&gt;&lt;span style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color \
:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;and \
made available under Creative&lt;/span&gt;&lt;/p&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;Commons \
licenses. In the Submission notes field, please indicate that you agree that your \
presentation will be licensed under the CC-By-SA-4.0 or CC-By-4.0 license and that \
you agree to have your presentation recorded. For example:&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;"If \
my presentation is accepted for FOSDEM, I hereby agree to license all recordings, \
slides, and other associated materials under the Creative Commons Attribution \
Share-Alike 4.0 International License. Sincerely, \
&lt;NAME&gt;."&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;In \
the Submission notes field, please also confirm that if your talk is accepted, you \
will be able to attend the virtual FOSDEM event for the Q&amp;A. We will not consider \
proposals from prospective speakers who are unsure whether they will be able to \
attend the FOSDEM virtual event.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;If \
you are experiencing problems with Pentabarf, the proposal submission interface, or \
have other questions, you can email our devroom mailing list[2] and we will try to \
help you.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;Code \
of Conduct&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;Following \
the release of the updated code of conduct for FOSDEM, we'd like to remind all \
speakers and attendees that all of the presentations and discussions in our devroom \
are held under the guidelines set in the CoC and we expect attendees, speakers, and \
volunteers to follow the CoC at all times.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;If \
you submit a proposal and it is accepted, you will be required to confirm that you \
accept the FOSDEM CoC. If you have any questions about the CoC or wish to have one of \
the devroom organizers review your presentation slides or any other content for CoC \
compliance, please email us and we will do our best to assist you.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p \
dir="ltr" style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;Call \
for Volunteers&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;We \
are also looking for volunteers to help run the devroom. We need assistance with \
helping speakers to record the presentation as well as helping with streaming and \
chat moderation for the devroom. Please contact devroom mailing list [2] for more \
information.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;Questions?&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p \
dir="ltr" style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;If \
you have any questions about this devroom, please send your questions to our devroom \
mailing list. You can also subscribe to the list to receive updates about important \
dates, session announcements, and to connect with other attendees.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p \
dir="ltr" style="line-height:1.656;margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;See \
you all at FOSDEM!&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir="ltr" \
style="line-height:1.9872;background-color:rgb(255,255,255);margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;[1]&lt;/span&gt;&lt;a \
href="https://penta.fosdem.org/submission/FOSDEM22" \
style="text-decoration:none"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(17,85,204);background-color:transpar \
ent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:underline;vertical-align:baseline;white-space:pre-wrap"&gt; \
https://penta.fosdem.org/submission/FOSDEM22&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;p dir="ltr" \
style="line-height:1.9872;background-color:rgb(255,255,255);margin-top:0pt;margin-bottom:0pt"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt;[2] \
iaas-virt-devroom at&lt;/span&gt;&lt;a href="http://lists.fosdem.org" \
style="text-decoration:none"&gt;&lt;span \
style="font-size:11pt;font-family:Arial;color:rgb(0,0,0);background-color:transparent; \
font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"&gt; \
&lt;/span&gt;&lt;span style="font-size:11pt;font-family:Arial;color:rgb(17,85,204);background-c \
olor:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration \
:underline;vertical-align:baseline;white-space:pre-wrap"&gt;lists.fosdem.org&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;




</body></email><email><emailId>20211130143423</emailId><senderName>Richard Taubo</senderName><senderEmail>ort_libvirt@bergersen.no</senderEmail><timestampReceived>2021-11-30 14:34:23-0400</timestampReceived><subject>Re: qemu-img create with preallocation=full and compression_type=zlib</subject><body>

On 30 Nov 2021, at 15:27, Daniel P. Berrangé &lt;berrange@redhat.com&gt; wrote:
&gt; 
&gt; On Tue, Nov 30, 2021 at 02:51:22PM +0100, Richard Taubo wrote:
&gt; &gt; Hi!
&gt; &gt; 
&gt; &gt; When running this command on Fedora 35 I get:
&gt; &gt; [#] qemu-img create -o preallocation=full -f qcow2 /var/vm_mail/mytest.qcow2 10GB
&gt; &gt; =&gt; Formatting '/var/vm_mail//mytest.qcow2', fmt=qcow2 . . . preallocation=full \
&gt; &gt; compression_type=zlib . . . ." 
&gt; &gt; Question:
&gt; &gt; When using 'preallocation=full' I was surprised that the resulting qcow2 image \
&gt; &gt; includes the 'compression_type=zlib' part. Why/when is this compression used when \
&gt; &gt; the qcow2 image is fully preallocated?
&gt; 
&gt; It doesn't mean the image is currently compressed.
&gt; 
&gt; Rather it just records the desired compression algorithm for this image,
&gt; if any future writes were to be told to use compression.

Okay, good to know.

Thanks a lot! :-)

Best regards
Richard Taubo


</body></email><email><emailId>20211130150852</emailId><senderName>Elias Mobery</senderName><senderEmail>eliasmobery@gmail.com</senderEmail><timestampReceived>2021-11-30 15:08:52-0400</timestampReceived><subject>Re: Libvirt Snapshot Question</subject><body>

Hey Peter, thanks for the super quick reply, you're awesome!

So you mean the first option would be to create a second disk instead of
using snapshot for write, when it gets too big I can then unplug the disk,
delete it (or wipe entire overlay fs) and recreate it to start fresh?

OK I will try that, thanks for the tip!

Option 2 with trim/discard I have to do some research, this seems a bit
more challenging.

Thank you SO much for the great advice. I will try everything out and
report back. :-)


On Tue, Nov 30, 2021, 3:25 PM Peter Krempa &lt;pkrempa@redhat.com&gt; wrote:

&gt; On Tue, Nov 30, 2021 at 14:51:54 +0100, Elias Mobery wrote:
&gt; &gt; Hello Peter, thank you so much for that detailed info!
&gt; &gt;
&gt; &gt; Sorry, you were right, when trying to delete my external snapshot via
&gt; &gt; snapshot-delete, the error says "deletion of external snapshots
&gt; unsupported"
&gt; &gt;
&gt; &gt; I can't merge the snapshot because the VM image is in a read-only
&gt; &gt; filesystem. Sorry I should've said, it's a live system. So the image is
&gt; in
&gt; &gt; the read-only squashfs and external snapshot in overlay is used for
&gt; writing.
&gt;
&gt; Okay, that changes the situation quite a bit:
&gt;
&gt; &gt;
&gt; &gt; Now I would like the snapshot emptied or deleted/recreated when it
&gt; reaches
&gt; &gt; 4GB.
&gt; &gt;
&gt; &gt; Is there even a way to do this with the image being read-only?
&gt;
&gt; If the base image is on a read-only filesystem you obviously can't
&gt; commit to it.
&gt;
&gt; Now the question is what should happen to the data in the overlay.
&gt;
&gt; Discarding/recreating the overlay image is possible only once you turn
&gt; off the VM because it basically rolls back the state of the disk back to
&gt; the time when the overlay was created. This means that everything
&gt; written to the disk will be lost.
&gt;
&gt; Filesystems obviously can't handle that so that's why it simply won't be
&gt; possible to do live with the root image.
&gt;
&gt; You can have a second disk, which you hot-unplug, wipe the overlay and
&gt; plug it back.
&gt;
&gt; Another possibility is to enable trim/discard and just simply delete the
&gt; data in the VM which was added after the overlay was created. When
&gt; trim/discard is enabled on all layers incluging the guest filesystem,
&gt; then deleting stuff inside the VM will also mean that the overlay will
&gt; shrink again.
&gt;
&gt;

[Attachment #3 (text/html)]

&lt;div dir="auto"&gt;Hey Peter, thanks for the super quick reply, you're awesome!&lt;div \
dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;So you mean the first option would be to create \
a second disk instead of using snapshot for write, when it gets too big I can then \
unplug the disk, delete it (or wipe entire overlay fs) and recreate it to start \
fresh?&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;OK I will try that, thanks for \
the tip!&lt;/div&gt;&lt;div dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;Option 2 with trim/discard I \
have to do some research, this seems a bit more challenging.&lt;/div&gt;&lt;div \
dir="auto"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="auto"&gt;Thank you SO much for the great advice. I will \
try everything out and report back. :-)&lt;/div&gt;&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote" \
dir="auto"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Tue, Nov 30, 2021, 3:25 PM Peter \
Krempa &lt;&lt;a href="mailto:pkrempa@redhat.com"&gt;pkrempa@redhat.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 \
.8ex;border-left:1px #ccc solid;padding-left:1ex"&gt;On Tue, Nov 30, 2021 at 14:51:54 \
+0100, Elias Mobery wrote:&lt;br&gt; &gt; Hello Peter, thank you so much for that detailed \
info!&lt;br&gt; &gt; &lt;br&gt;
&gt; Sorry, you were right, when trying to delete my external snapshot via&lt;br&gt;
&gt; snapshot-delete, the error says "deletion of external snapshots \
unsupported"&lt;br&gt; &gt; &lt;br&gt;
&gt; I can't merge the snapshot because the VM image is in a read-only&lt;br&gt;
&gt; filesystem. Sorry I should've said, it's a live system. So the image is \
in&lt;br&gt; &gt; the read-only squashfs and external snapshot in overlay is used for \
writing.&lt;br&gt; &lt;br&gt;
Okay, that changes the situation quite a bit:&lt;br&gt;
&lt;br&gt;
&gt; &lt;br&gt;
&gt; Now I would like the snapshot emptied or deleted/recreated when it reaches&lt;br&gt;
&gt; 4GB.&lt;br&gt;
&gt; &lt;br&gt;
&gt; Is there even a way to do this with the image being read-only?&lt;br&gt;
&lt;br&gt;
If the base image is on a read-only filesystem you obviously can't&lt;br&gt;
commit to it.&lt;br&gt;
&lt;br&gt;
Now the question is what should happen to the data in the overlay.&lt;br&gt;
&lt;br&gt;
Discarding/recreating the overlay image is possible only once you turn&lt;br&gt;
off the VM because it basically rolls back the state of the disk back to&lt;br&gt;
the time when the overlay was created. This means that everything&lt;br&gt;
written to the disk will be lost.&lt;br&gt;
&lt;br&gt;
Filesystems obviously can't handle that so that's why it simply won't \
be&lt;br&gt; possible to do live with the root image.&lt;br&gt;
&lt;br&gt;
You can have a second disk, which you hot-unplug, wipe the overlay and&lt;br&gt;
plug it back.&lt;br&gt;
&lt;br&gt;
Another possibility is to enable trim/discard and just simply delete the&lt;br&gt;
data in the VM which was added after the overlay was created. When&lt;br&gt;
trim/discard is enabled on all layers incluging the guest filesystem,&lt;br&gt;
then deleting stuff inside the VM will also mean that the overlay will&lt;br&gt;
shrink again.&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20211130182127</emailId><senderName>daggs</senderName><senderEmail>daggs@gmx.com</senderEmail><timestampReceived>2021-11-30 18:21:27-0400</timestampReceived><subject>Re: migrate libvirt config between machines</subject><body>

Greetings Daniel,

&gt; Sent: Tuesday, November 30, 2021 at 2:11 PM
&gt; From: "Daniel P. Berrangé" &lt;berrange@redhat.com&gt;
&gt; To: "Michal Prívozník" &lt;mprivozn@redhat.com&gt;
&gt; Cc: "daggs" &lt;daggs@gmx.com&gt;, libvirt-users@redhat.com
&gt; Subject: Re: migrate libvirt config between machines
&gt; 
&gt; On Tue, Nov 30, 2021 at 09:28:36AM +0100, Michal Prívozník wrote:
&gt; &gt; On 11/29/21 17:37, daggs wrote:
&gt; &gt; &gt; Greetings,
&gt; &gt; &gt; 
&gt; &gt; &gt; I'd like to migrate my current libvirt config from one machine to another, what \
&gt; &gt; &gt; is the best way to do so? 
&gt; &gt; &gt; Thanks
&gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; Do you mean domain/network/... XMLs or {libvirtd,qemu,...}.config files?
&gt; &gt; 
&gt; &gt; For the former I suggest 'virsh dumpxml $dom &gt; dom.xml' and copying over
&gt; &gt; the file onto new machine and defining the domain again 'virsh define
&gt; &gt; dom.xml' (s/dumpxml/net-dumpxml/ and s/define/net-define/ for networks
&gt; &gt; and so on).
&gt; &gt; 
&gt; &gt; If you run new enough libvirt there's even 'virsh migrate --offline'
&gt; &gt; that encapsulates steps from above.
&gt; 
&gt; NB, i'm not sure this is clever enough to copy across the TPM state or
&gt; the EDK variables state, if you're using such feature.
&gt; 
&gt; 
&gt; Regards,
&gt; Daniel

it is the same system, different os, I'm trying to validate if the new os is better \
for what I need

Thanks,

Dagg


</body></email><email><emailId>20211004122626</emailId><senderName>Andrea Bolognani</senderName><senderEmail>abologna@redhat.com</senderEmail><timestampReceived>2021-10-04 12:26:26-0400</timestampReceived><subject>Re: how/where to configure access to libvirt-sock-ro</subject><body>

On Sun, Oct 03, 2021 at 10:05:10PM +0000, Marc wrote:
&gt;
&gt; I wanted to create a monitoring user that can do some reporting like this:
&gt;
&gt; runuser -u xxxxx  -- prometheus-libvirt-exporter -libvirt.uri /var/run/libvirt/libvirt-sock-ro

I assume you're using prometheus-libvirt-exporter from

  https://github.com/zhangjianweibj/prometheus-libvirt-exporter/

right?

If so, I don't think you need to pass the (poorly named) libvirt.uri
option explicitly, as /var/run/libvirt/libvirt-sock-ro is already the
default value.

&gt; But I am getting the
&gt; failed to connect: authentication required

What do the following commands return?

  $ runuser -u xxx -- virsh -c qemu:///system -r list --all
  $ runuser -u xxx -- virsh -c
qemu:///system?socket=/var/run/libvirt/libvirt-sock-ro list --all

What are the permissions on the socket? Is SELinux possibly getting
in the way?

Access to the read-only socket is usually not very restrictive, since
a read-only connection can only be used to collect data anyway.

-- 
Andrea Bolognani / Red Hat / Virtualization

</body></email><email><emailId>20211005065432</emailId><senderName>Guy Godfroy</senderName><senderEmail>guy.godfroy@gugod.fr</senderEmail><timestampReceived>2021-10-05 06:54:32-0400</timestampReceived><subject>Re: Need more doc for libvirt-console-proxy</subject><body>

Hello,

Friendly ping about this info request.

I tried again and all my questions remain.

Thanks.

Guy Godfroy

Le 22/04/2021 Ã  11:17, Guy Godfroy a Ã©crit  :
&gt; Hello,
&gt; 
&gt; I'm making a web app for my company that will enable different teams to
&gt; manage their own VMs. I wish to make possible to interact with each VM
&gt; console, so I plan to use some xterm.js with websockets.
&gt; 
&gt; So I discovered libvirt-console-proxy [1] when I looked for something to
&gt; put a libvirt console into a websocket. That seems like the right tool
&gt; for the job.
&gt; 
&gt; The only doc I found is this article from 2017 [2]. After trying to
&gt; understand from this article and from --help, I still have many
&gt; questions. I am really bad at reading code so I can't even get answers
&gt; from the sources.
&gt; 
&gt; My main concern is: How a client is supposed to talk to the proxy? It is
&gt; said that a security token must be provided. How? HTTP header? Which
&gt; header? Am I missing something in websocket protocol? I think an example
&gt; client implementation would help a lot.
&gt; 
&gt; Also, I tried to use virtconsoleresolveradm to set up metadata on my
&gt; domains like explained in the article [1] :
&gt; 
&gt; ./virtconsoleresolveradm enable milou
&gt; Enabled access to domain 'milou'
&gt; 
&gt; But that doesn't seem to do anything (except defining the metadata
&gt; namespace in the XML):
&gt; 
&gt;      virsh metadata milou http://libvirt.org/schemas/console-proxy/1.0
&gt;      &lt;consoles/&gt;
&gt; 
&gt; I precise that I have already this in my XML:
&gt; 
&gt;      &lt;serial type='pty'&gt;
&gt;        &lt;target type='isa-serial' port='0'&gt;
&gt;          &lt;model name='isa-serial'/&gt;
&gt;        &lt;/target&gt;
&gt;      &lt;/serial&gt;
&gt;      &lt;console type='pty'&gt;
&gt;        &lt;target type='serial' port='0'/&gt;
&gt;      &lt;/console&gt;
&gt; 
&gt; Should I remove that? Should I edit that?
&gt; 
&gt; Thanks for your help.
&gt; 
&gt; Guy Godfroy
&gt; 
&gt; [1] https://gitlab.com/libvirt/libvirt-console-proxy
&gt; [2]
&gt; https://www.berrange.com/posts/2017/01/26/announce-new-libvirt-console-proxy-project/
&gt; 

</body></email><email><emailId>20211026090714</emailId><senderName>Andrea Bolognani</senderName><senderEmail>abologna@redhat.com</senderEmail><timestampReceived>2021-10-26 09:07:14-0400</timestampReceived><subject>Re: apt libvirt package</subject><body>

Please do not send HTML messages or top-post when using mailing
lists. It makes it more difficult to reply while keeping context.

On Mon, Oct 25, 2021 at 09:49:27AM -0700, admin@foundryserver.com wrote:
&gt; On October 24, 2021 2:38 PM, Peter Crowther wrote:
&gt; &gt; Do you want this on CentOS 8, Ubuntu 20.04, or something else?
&gt; &gt; The help we can give you will vary quite considerably depending
&gt; &gt; on the distro you use; and, as you point out, RedHat-derived and
&gt; &gt; Debian-derived distributions are very different.
&gt;
&gt; &gt; For CentOS, do you have the advanced virtualization repo enabled?

Using CentOS Stream 8 with Advanced Virtualization, as Peter
suggested, is a good way to get access to relatively fresh packages.

Right now, that would net you libvirt 7.6.0 and QEMU 6.0.0, which are
just a few months old and should allow you to set up virtiofs.

&gt; I would prefer the ubuntu packages. I am most familiar with that
&gt; distro.  I can make centos8 work if I have to but I prefer not.

If at all possible, I recommend using binary packages instead of
building libvirt from scratch. It just makes everything so much
easier.

If you really want to build from source, have a look at the
Dockerfiles in ci/containers: there's one for Ubuntu 20.04, and it
includes the full list of packages you need to install in order to
satisfy all build dependencies.

-- 
Andrea Bolognani / Red Hat / Virtualization

</body></email><email><emailId>20211031082821</emailId><senderName>daggs</senderName><senderEmail>daggs@gmx.com</senderEmail><timestampReceived>2021-10-31 08:28:21-0400</timestampReceived><subject>Re: another upgrade another vm issue</subject><body>

Greetings Laine,

&gt; Sent: Saturday, October 30, 2021 at 5:40 PM
&gt; From: "Laine Stump" &lt;laine@redhat.com&gt;
&gt; To: "libvirt-users@redhat.com" &lt;libvirt-users@redhat.com&gt;
&gt; Cc: "daggs" &lt;daggs@gmx.com&gt;
&gt; Subject: Re: another upgrade another vm issue
&gt; 
&gt; 
&gt; 
&gt; On 10/30/21 6:57 AM, daggs wrote:
&gt; &gt; Greetings Michal,
&gt; &gt; 
&gt; &gt; &gt; Sent: Friday, October 29, 2021 at 11:36 AM
&gt; &gt; &gt; From: "Michal Prívozník" &lt;mprivozn@redhat.com&gt;
&gt; &gt; &gt; To: "daggs" &lt;daggs@gmx.com&gt;, libvirt-users@redhat.com
&gt; &gt; &gt; Subject: Re: another upgrade another vm issue
&gt; &gt; &gt; 
&gt; &gt; &gt; On 10/28/21 8:40 PM, daggs wrote:
&gt; &gt; &gt; &gt; Greetings,
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; so I've upgraded my server and yet again, one of my vm lost a functionally.
&gt; &gt; &gt; &gt; there is no usable sound card.
&gt; &gt; &gt; &gt; xml: https://dpaste.com/CVR5M75VH
&gt; &gt; &gt; &gt; in vm: https://snipboard.io/aZ7Dcf.jpg
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; outputs:
&gt; &gt; &gt; &gt; utils_server /home/igor # qemu-system-x86_64 --version
&gt; &gt; &gt; &gt; QEMU emulator version 6.0.0
&gt; &gt; &gt; &gt; Copyright (c) 2003-2021 Fabrice Bellard and the QEMU Project developers
&gt; &gt; &gt; &gt; utils_server /home/igor # libvirtd --version
&gt; &gt; &gt; &gt; libvirtd (libvirt) 7.8.0
&gt; &gt; &gt; &gt; utils_server /home/igor #
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; any ideas?
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Thanks.
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; I suspect it's related to:
&gt; &gt; &gt; 
&gt; &gt; &gt; &lt;audio id='1' type='none'/&gt;
&gt; &gt; &gt; 
&gt; &gt; &gt; in the domain XML. Selecting a backend might help.
&gt; &gt; &gt; 
&gt; &gt; &gt; https://libvirt.org/formatdomain.html#audio-backends
&gt; &gt; &gt; 
&gt; &gt; &gt; Michal
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; I've diffed the current xml with the one last known to work, they both have the \
&gt; &gt; same entry
&gt; 
&gt; Can you possibly downgrade QEMU, libvirt, and the host kernel 
&gt; independently to see if downgrading just one (or two) of them fixes the 
&gt; problem?
&gt; 
&gt; (I would normally have suggested diffing the qemu commandline from the 
&gt; logs in /var/log/libvirt/qemu/${guestname}.log to see if the VFIO 
&gt; portion was unchanged (and thus counting out libvirt from the possible 
&gt; causes of the problem), but the commandlines have recently switched to 
&gt; using JSON syntax, so they will probably be different anyway).
&gt; 
&gt; Since your audio device is assigned with VFIO, and libvirt has nothing 
&gt; more to do with that than just unbinding the host driver and binding the 
&gt; vfio-pci driver, then putting the info on the commandline for QEMU, I'd 
&gt; put money on the problem being either in QEMU or the kernel, in which 
&gt; case you'd probably get more useful advice from the 
&gt; vfio-users@redhat.com mailing list than here.
&gt; 
&gt; 

the kernel didn't changed.
downgrading both libvirt and eqmu was the first thing I did when the issue was \
encountered. the problem persisted. I've isolated the last good execution of the vm \
prior to the upgrade, diffed the command line, it is the same one. I'll verify that \
the working one is the the right one and will test again. I'll go to vfio-users after \
I've make sure that nothing differs with the env.

thanks, for the help.

Dagg.


</body></email><email><emailId>20211031200050</emailId><senderName>Marc</senderName><senderEmail>marc@f1-outsourcing.eu</senderEmail><timestampReceived>2021-10-31 20:00:50-0400</timestampReceived><subject>RE: Iptables, et al best practices for protecting KVM host sharing "hostdev" (ixgbe-vf) interfaces w</subject><body>

&gt; 
&gt; My question is this: what's best practices for making sure that a switch
&gt; VLAN misconfiguration issue, a cabling to the wrong port, etc. doesn't
&gt; compromise the KVM server itself?

Not sure about best practice. But what about using a macvtap. That by default does \
not allow host communication and only allows the guests connected to the same master \
to communicate with each other.

&gt; How do I allow my KVM server to *not* be on "external", but some of its
&gt; guests to be, without compromising security?

Do not configure the interface with an ip address on the host, and make sure you do \
not have daemons binding to 0.0.0.0 on the host.


 


</body></email><email><emailId>20211001015602</emailId><senderName>Jiatong Shen</senderName><senderEmail>yshxxsjt715@gmail.com</senderEmail><timestampReceived>2021-10-01 01:56:02-0400</timestampReceived><subject>how to get enabled features</subject><body>

Hello community,

  I am trying to learn how to use dtrace and systemtap for libvirt, as the
documentation says it seems to enable `--with-dtrace` when compiling. I am
installing libvirt using apt install and is it possible to determine if
dtrace is built by running some libvirt commands?

Thank you.

-- 

Best Regards,

Jiatong Shen

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hello community,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;   I am trying to learn how to use \
dtrace and systemtap for libvirt, as the documentation says it seems to enable \
`--with-dtrace` when compiling. I am installing libvirt using apt install and is it \
possible to determine if dtrace is built by running some libvirt \
commands?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thank you.&lt;br clear="all"&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- \
&lt;br&gt;&lt;div dir="ltr" data-smartmail="gmail_signature"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;div&gt;Best \
Regards,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Jiatong Shen&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20211011124925</emailId><senderName>"Jason Pyeron"</senderName><senderEmail>jpyeron@pdinc.us</senderEmail><timestampReceived>2021-10-11 12:49:25-0400</timestampReceived><subject>nwfilter direction not being used when protocol all</subject><body>

This is a multipart message in MIME format.

Watson / Kyle:

 

(note I coped the list)

 

While I read https://libvirt.org/formatnwfilter.html#nwfelemsRulesProtoMisc , it is \
not clear that it is intended to add the iptables action without regard to the rule's \
direction.

 

Take the following rule scenarios:

 

  &lt;rule action='accept' direction='in' priority='500' statematch='false'&gt;

    &lt;tcp dstportstart='22'/&gt;

  &lt;/rule&gt;

  &lt;rule action='drop' direction='in' priority='1000'&gt;

    &lt;all/&gt;

  &lt;/rule&gt;

 

# iptables-save  | grep vnet5 | tee in

&gt; FI-vnet5 - [0:0]

&gt; FO-vnet5 - [0:0]

&gt; HI-vnet5 - [0:0]

-A FI-vnet5 -p tcp -m tcp --sport 22 -j RETURN

-A FI-vnet5 -j DROP

-A FO-vnet5 -p tcp -m tcp --dport 22 -j ACCEPT

-A FO-vnet5 -j DROP

-A HI-vnet5 -p tcp -m tcp --sport 22 -j RETURN

-A HI-vnet5 -j DROP

-A libvirt-host-in -m physdev --physdev-in vnet5 -g HI-vnet5

-A libvirt-in -m physdev --physdev-in vnet5 -g FI-vnet5

-A libvirt-in-post -m physdev --physdev-in vnet5 -j ACCEPT

-A libvirt-out -m physdev --physdev-out vnet5 --physdev-is-bridged -g FO-vnet5

 

  &lt;rule action='accept' direction='in' priority='500' statematch='false'&gt;

    &lt;tcp dstportstart='22'/&gt;

  &lt;/rule&gt;

  &lt;rule action='drop' direction='out' priority='1000'&gt;

    &lt;all/&gt;

  &lt;/rule&gt;

 

# iptables-save  | grep vnet5 | tee out

&gt; FI-vnet5 - [0:0]

&gt; FO-vnet5 - [0:0]

&gt; HI-vnet5 - [0:0]

-A FI-vnet5 -p tcp -m tcp --sport 22 -j RETURN

-A FI-vnet5 -j DROP

-A FO-vnet5 -p tcp -m tcp --dport 22 -j ACCEPT

-A FO-vnet5 -j DROP

-A HI-vnet5 -p tcp -m tcp --sport 22 -j RETURN

-A HI-vnet5 -j DROP

-A libvirt-host-in -m physdev --physdev-in vnet5 -g HI-vnet5

-A libvirt-in -m physdev --physdev-in vnet5 -g FI-vnet5

-A libvirt-in-post -m physdev --physdev-in vnet5 -j ACCEPT

-A libvirt-out -m physdev --physdev-out vnet5 --physdev-is-bridged -g FO-vnet5

 

  &lt;rule action='accept' direction='in' priority='500' statematch='false'&gt;

    &lt;tcp dstportstart='22'/&gt;

  &lt;/rule&gt;

  &lt;rule action='drop' direction='inout' priority='1000'&gt;

    &lt;all/&gt;

  &lt;/rule&gt;

 

# iptables-save  | grep vnet5 | tee inout

&gt; FI-vnet5 - [0:0]

&gt; FO-vnet5 - [0:0]

&gt; HI-vnet5 - [0:0]

-A FI-vnet5 -p tcp -m tcp --sport 22 -j RETURN

-A FI-vnet5 -j DROP

-A FO-vnet5 -p tcp -m tcp --dport 22 -j ACCEPT

-A FO-vnet5 -j DROP

-A HI-vnet5 -p tcp -m tcp --sport 22 -j RETURN

-A HI-vnet5 -j DROP

-A libvirt-host-in -m physdev --physdev-in vnet5 -g HI-vnet5

-A libvirt-in -m physdev --physdev-in vnet5 -g FI-vnet5

-A libvirt-in-post -m physdev --physdev-in vnet5 -j ACCEPT

-A libvirt-out -m physdev --physdev-out vnet5 --physdev-is-bridged -g FO-vnet5

 

We note that the 

 

-A HI-vnet5 -j DROP

-A FI-vnet5 -j DROP

-A FO-vnet5 -j DROP

 

Is present without regards to the state of the direction attribute on the "default" \
drop rule.

 

If the direction is "in" then the "-A FI-vnet5 -j DROP" should not exists.

 

What does the source code say? I worry that either the docs are imprecise and this is \
desired, or there is a bug and I can end up like \
https://superuser.com/questions/1660080/in-libvirt-network-filters-nwfilter-what-does-the-all-protocol-type-indicat \


 

As this is going to be a generic rule, applied many times – I would prefer not to \
have mac based source allow rules.

 

-Jason


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;&lt;head&gt;&lt;meta http-equiv=Content-Type \
content="text/html; charset=utf-8"&gt;&lt;meta name=Generator content="Microsoft Word 15 \
(filtered medium)"&gt;&lt;style&gt;&lt;!-- /* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Lucida Console";
	panose-1:2 11 6 9 4 5 4 2 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:#0563C1;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:#954F72;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri",sans-serif;
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;
	font-family:"Calibri",sans-serif;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
--&gt;&lt;/style&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapelayout v:ext="edit"&gt;
&lt;o:idmap v:ext="edit" data="1" /&gt;
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;&lt;/head&gt;&lt;body lang=EN-US link="#0563C1" \
vlink="#954F72"&gt;&lt;div class=WordSection1&gt;&lt;p class=MsoNormal&gt;Watson / \
Kyle:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;(note \
I coped the list)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;While I read &lt;a \
href="https://libvirt.org/formatnwfilter.html#nwfelemsRulesProtoMisc"&gt;https://libvirt.org/formatnwfilter.html#nwfelemsRulesProtoMisc&lt;/a&gt; \
, it is not clear that it is intended to add the iptables action without regard to \
the rule's direction.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;Take the following rule scenarios:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;   &lt;rule action='accept' direction='in' priority='500' \
statematch='false'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;       &lt;tcp dstportstart='22'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;   \
&lt;/rule&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;   &lt;rule action='drop' direction='in' \
priority='1000'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;       &lt;all/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;   &lt;/rule&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;# iptables-save   | grep vnet5 | tee in&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;:FI-vnet5 - \
[0:0]&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;:FO-vnet5 - \
[0:0]&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;:HI-vnet5 - \
[0:0]&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;-A FI-vnet5 -p tcp -m tcp \
--sport 22 -j RETURN&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;-A FI-vnet5 -j DROP&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;-A FO-vnet5 -p tcp -m tcp --dport 22 -j ACCEPT&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;-A FO-vnet5 -j \
DROP&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;-A HI-vnet5 -p tcp -m tcp \
--sport 22 -j RETURN&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;-A HI-vnet5 -j DROP&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;-A libvirt-host-in -m physdev --physdev-in vnet5 -g \
HI-vnet5&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;-A libvirt-in -m physdev \
--physdev-in vnet5 -g FI-vnet5&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;-A libvirt-in-post -m physdev --physdev-in vnet5 -j \
ACCEPT&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;-A libvirt-out -m physdev \
--physdev-out vnet5 --physdev-is-bridged -g FO-vnet5&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;   &lt;rule action='accept' direction='in' priority='500' \
statematch='false'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;       &lt;tcp dstportstart='22'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;   \
&lt;/rule&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;   &lt;rule action='drop' direction='out' \
priority='1000'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;       &lt;all/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;   &lt;/rule&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;# iptables-save   | grep vnet5 | tee out&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;:FI-vnet5 - \
[0:0]&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;:FO-vnet5 - \
[0:0]&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;:HI-vnet5 - \
[0:0]&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;-A FI-vnet5 -p tcp -m tcp \
--sport 22 -j RETURN&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;-A FI-vnet5 -j DROP&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;-A FO-vnet5 -p tcp -m tcp --dport 22 -j ACCEPT&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;-A FO-vnet5 -j \
DROP&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;-A HI-vnet5 -p tcp -m tcp \
--sport 22 -j RETURN&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;-A HI-vnet5 -j DROP&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;-A libvirt-host-in -m physdev --physdev-in vnet5 -g \
HI-vnet5&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;-A libvirt-in -m physdev \
--physdev-in vnet5 -g FI-vnet5&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;-A libvirt-in-post -m physdev --physdev-in vnet5 -j \
ACCEPT&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;-A libvirt-out -m physdev \
--physdev-out vnet5 --physdev-is-bridged -g FO-vnet5&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;   &lt;rule action='accept' direction='in' priority='500' \
statematch='false'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;       &lt;tcp dstportstart='22'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;   \
&lt;/rule&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;   &lt;rule action='drop' direction='inout' \
priority='1000'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;       &lt;all/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;   &lt;/rule&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;# iptables-save   | grep vnet5 | tee inout&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;:FI-vnet5 - \
[0:0]&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;:FO-vnet5 - \
[0:0]&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;:HI-vnet5 - \
[0:0]&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;-A FI-vnet5 -p tcp -m tcp \
--sport 22 -j RETURN&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;-A FI-vnet5 -j DROP&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;-A FO-vnet5 -p tcp -m tcp --dport 22 -j ACCEPT&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;-A FO-vnet5 -j \
DROP&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;-A HI-vnet5 -p tcp -m tcp \
--sport 22 -j RETURN&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;-A HI-vnet5 -j DROP&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;-A libvirt-host-in -m physdev --physdev-in vnet5 -g \
HI-vnet5&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;-A libvirt-in -m physdev \
--physdev-in vnet5 -g FI-vnet5&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;-A libvirt-in-post -m physdev --physdev-in vnet5 -j \
ACCEPT&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;-A libvirt-out -m physdev \
--physdev-out vnet5 --physdev-is-bridged -g FO-vnet5&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;We note that the &lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;-A HI-vnet5 -j DROP&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;-A FI-vnet5 -j DROP&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;-A FO-vnet5 -j DROP&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;Is present without regards \
to the state of the direction attribute on the "default" drop rule.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='text-autospace:none'&gt;If the direction is "in" then the "&lt;span \
style='font-size:9.0pt;font-family:"Lucida Console"'&gt;-A FI-vnet5 -j DROP&lt;/span&gt;" \
should not exists.&lt;span style='font-size:9.0pt;font-family:"Lucida \
Console"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;What does the source code say? I worry that either the docs are \
imprecise and this is desired, or there is a bug and I can end up like &lt;a \
href="https://superuser.com/questions/1660080/in-libvirt-network-filters-nwfilter-what \
-does-the-all-protocol-type-indicat"&gt;https://superuser.com/questions/1660080/in-libvirt-network-filters-nwfilter-what-does-the-all-protocol-type-indicat&lt;/a&gt; \
&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;As this is \
going to be a generic rule, applied many times – I would prefer not to have mac \
based source allow rules.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;-Jason&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20211013125440</emailId><senderName>Vojtech Juranek</senderName><senderEmail>vjuranek@redhat.com</senderEmail><timestampReceived>2021-10-13 12:54:40-0400</timestampReceived><subject>VM paused during multipath iSCSI reservation</subject><body>


Hi,
I'm trying to find the root cause for BZ #1898049 [1]. When setting up Windows HA 
cluster on Windows Server VMs run on top of oVirt, Windows cluster validator runs \
couple of tests  and fails during test "Validate SCSI-3 Persistent Reservation" and \
one of the VMs of  the cluster is paused with IO error. Disk definition is as \
follows:


    &lt;disk type='block' device='lun' sgio='unfiltered' snapshot='no'&gt;
      &lt;driver name='qemu' type='raw' cache='none' error_policy='stop' io='native'/&gt;
      &lt;source dev='/dev/mapper/3600a09803830447a4f244c4657616f6f' index='1'&gt;
        &lt;seclabel model='dac' relabel='no'/&gt;
        &lt;reservations managed='yes'&gt;
          &lt;source type='unix' \
path='/var/lib/libvirt/qemu/domain-1-Windows-2016-2/pr-helper0.sock' mode='client'/&gt;  \
&lt;/reservations&gt;  &lt;/source&gt;
      &lt;backingStore/&gt;
      &lt;target dev='sdb' bus='scsi'/&gt;
      &lt;shareable/&gt;
      &lt;alias name='ua-26b4975e-e1d4-4e27-b2c6-2ea0894a571b'/&gt;
      &lt;address type='drive' controller='0' bus='0' target='0' unit='1'/&gt;
    &lt;/disk&gt;

and libvirt error I get is bellow [2].

When I try to create reservation from Windows VM manually, I get following error
(but not sure I do it whole process correctly):

.\sg_persist --out --register --param-sark=123abc e:
    QEMU   QEMU HARDDISK               2.5+
    Peripheral device type: disk
PR out (Register): command not supported
sg_persist failed: Illegal request, Invalid opcode


Do you have any ideas what could be wrong or how to determine
the root cause of this this issue?

Thanks in advance.
Vojta


[1] https://bugzilla.redhat.com/1898049
[2] libvirt debug log:

2021-10-12 11:43:25.148+0000: 2006427: debug : qemuMonitorEmitIOError:1243 : \
mon=0x7fb02006a020 2021-10-12 11:43:25.148+0000: 2006427: info : virObjectRef:402 : \
OBJECT_REF: obj=0x7fb02006a020 2021-10-12 11:43:25.148+0000: 2006427: info : \
virObjectRef:402 : OBJECT_REF: obj=0x7fafd0130020 2021-10-12 11:43:25.148+0000: \
2000208: info : virObjectRef:402 : OBJECT_REF: obj=0x7fafd010d340 2021-10-12 \
11:43:25.148+0000: 2006427: info : virObjectNew:258 : OBJECT_NEW: obj=0x7fb020082590 \
classname=virDomainEventIOError 2021-10-12 11:43:25.148+0000: 2000208: info : \
vir_object_finalize:321 : OBJECT_DISPOSE: obj=0x7fb020082500 2021-10-12 \
11:43:25.148+0000: 2006427: info : virObjectNew:258 : OBJECT_NEW: obj=0x7fb020082620 \
classname=virDomainEventIOError 2021-10-12 11:43:25.148+0000: 2000208: info : \
virObjectUnref:380 : OBJECT_UNREF: obj=0x7fb020082500 2021-10-12 11:43:25.148+0000: \
2006427: debug : qemuProcessHandleIOError:907 : Transitioned guest Windows-2016-2 to \
paused state due to IO error 2021-10-12 11:43:25.148+0000: 2000208: info : \
virObjectUnref:380 : OBJECT_UNREF: obj=0x7fafd010d340 2021-10-12 11:43:25.148+0000: \
2006427: info : virObjectNew:258 : OBJECT_NEW: obj=0x7fafbc1fb8c0 \
classname=virDomainEventLifecycle 2021-10-12 11:43:25.148+0000: 2006427: debug : \
virDomainLockProcessPause:204 : plugin=0x7fafd01272a0 dom=0x7fb01400f5e0 \
state=0x7fb02401d768 2021-10-12 11:43:25.148+0000: 2006427: debug : \
virDomainLockManagerNew:134 : plugin=0x7fafd01272a0 dom=0x7fb01400f5e0 \
withResources=1 2021-10-12 11:43:25.148+0000: 2006427: debug : \
virLockManagerPluginGetDriver:276 : plugin=0x7fafd01272a0 2021-10-12 \
11:43:25.148+0000: 2006427: debug : virLockManagerNew:300 : driver=0x7fafd444a000 \
type=0 nparams=5 params=0x7fafd77de640 flags=0x0 2021-10-12 11:43:25.148+0000: \
2006427: debug : virLockManagerLogParams:97 :   key=uuid type=uuid \
value=70eee88c-ba2c-4c6c-bd51-c2b663db27f8 2021-10-12 11:43:25.148+0000: 2006427: \
debug : virLockManagerLogParams:90 :   key=name type=string value=Windows-2016-2 \
2021-10-12 11:43:25.148+0000: 2006427: debug : virLockManagerLogParams:78 :   key=id \
type=uint value=1 2021-10-12 11:43:25.148+0000: 2006427: debug : \
virLockManagerLogParams:78 :   key=pid type=uint value=2006418 2021-10-12 \
11:43:25.148+0000: 2006427: debug : virLockManagerLogParams:93 :   key=uri \
type=cstring value=(null) 2021-10-12 11:43:25.148+0000: 2006427: debug : \
virDomainLockManagerNew:146 : Adding leases 2021-10-12 11:43:25.148+0000: 2006427: \
debug : virDomainLockManagerNew:151 : Adding disks 2021-10-12 11:43:25.149+0000: \
2006427: debug : virDomainLockManagerAddImage:90 : Add disk \
/rhev/data-center/mnt/blockSD/7c4f09b6-9e87-436f-bda9-22d1f0b50955/images/f5d6e074-dfe9-462d-8cfd-3e14b0eb5aea/766e36b2-84a6-43e7-a48b-a5f47e669860
 2021-10-12 11:43:25.149+0000: 2006427: debug : virLockManagerAddResource:326 : \
lock=0x7fafbc19e250 type=0 \
name=/rhev/data-center/mnt/blockSD/7c4f09b6-9e87-436f-bda9-22d1f0b50955/images/f5d6e074-dfe9-462d-8cfd-3e14b0eb5aea/766e36b2-84a6-43e7-a48b-a5f47e669860 \
nparams=0 params=(nil) flags=0x0 2021-10-12 11:43:25.149+0000: 2006427: debug : \
virDomainLockManagerAddImage:90 : Add disk \
/dev/mapper/3600a09803830447a4f244c4657616f6f 2021-10-12 11:43:25.149+0000: 2006427: \
debug : virLockManagerAddResource:326 : lock=0x7fafbc19e250 type=0 \
name=/dev/mapper/3600a09803830447a4f244c4657616f6f nparams=0 params=(nil) flags=0x2 \
2021-10-12 11:43:25.149+0000: 2006427: debug : virLockManagerRelease:359 : \
lock=0x7fafbc19e250 state=0x7fb02401d768 flags=0x0 2021-10-12 11:43:25.149+0000: \
2006427: debug : virLockManagerFree:381 : lock=0x7fafbc19e250 2021-10-12 \
11:43:25.149+0000: 2006427: debug : qemuProcessHandleIOError:920 : Preserving lock \
state '&lt;null&gt;' 2021-10-12 11:43:25.150+0000: 2006427: info : virObjectUnref:380 : \
OBJECT_UNREF: obj=0x7fafd0130020 2021-10-12 11:43:25.150+0000: 2006427: info : \
virObjectUnref:380 : OBJECT_UNREF: obj=0x7fb02006a020 2021-10-12 11:43:25.150+0000: \
2000208: info : virObjectRef:402 : OBJECT_REF: obj=0x7fafd010d340 2021-10-12 \
11:43:25.150+0000: 2000208: info : vir_object_finalize:321 : OBJECT_DISPOSE: \
obj=0x7fb020082590 2021-10-12 11:43:25.150+0000: 2006427: info : virObjectRef:402 : \
OBJECT_REF: obj=0x7fb02006a020 2021-10-12 11:43:25.150+0000: 2000208: info : \
virObjectUnref:380 : OBJECT_UNREF: obj=0x7fb020082590 2021-10-12 11:43:25.150+0000: \
2006427: info : virObjectUnref:380 : OBJECT_UNREF: obj=0x7fb02006a020 2021-10-12 \
11:43:25.150+0000: 2000208: info : virObjectNew:258 : OBJECT_NEW: obj=0x564a89a4cc60 \
classname=virDomain 2021-10-12 11:43:25.150+0000: 2006427: info : virObjectUnref:380 \
: OBJECT_UNREF: obj=0x7fb02006a020 2021-10-12 11:43:25.150+0000: 2000208: info : \
virObjectRef:402 : OBJECT_REF: obj=0x7fafd0018ca0 2021-10-12 11:43:25.150+0000: \
2000208: info : virObjectRef:402 : OBJECT_REF: obj=0x564a89978df0 2021-10-12 \
11:43:25.150+0000: 2000208: debug : virAccessManagerCheckDomain:238 : \
manager=0x564a89978df0(name=stack) driver=QEMU domain=0x7ffd2c677010 perm=0 \
2021-10-12 11:43:25.150+0000: 2000208: debug : virAccessManagerCheckDomain:238 : \
manager=0x564a89978e50(name=none) driver=QEMU domain=0x7ffd2c677010 perm=0 2021-10-12 \
11:43:25.150+0000: 2000208: info : virObjectUnref:380 : OBJECT_UNREF: \
obj=0x564a89978df0 2021-10-12 11:43:25.150+0000: 2000208: debug : \
remoteRelayDomainEventIOErrorReason:529 : Relaying domain io error Windows-2016-2 1 \
/dev/mapper/3600a09803830447a4f244c4657616f6f ua-26b4975e-e1d4-4e27-b2c6-2ea0894a571b \
1 , callback 3


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20211014072812</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-10-14 07:28:12-0400</timestampReceived><subject>Re: VM paused during multipath iSCSI reservation</subject><body>

On 10/13/21 2:54 PM, Vojtech Juranek wrote:
&gt; Hi,
&gt; I'm trying to find the root cause for BZ #1898049 [1]. When setting up Windows HA 
&gt; cluster on Windows Server VMs run on top of oVirt, Windows cluster validator runs \
&gt; couple of tests  and fails during test "Validate SCSI-3 Persistent Reservation" and \
&gt; one of the VMs of  the cluster is paused with IO error. Disk definition is as \
&gt; follows: 
&gt; 
&gt; &lt;disk type='block' device='lun' sgio='unfiltered' snapshot='no'&gt;
&gt; &lt;driver name='qemu' type='raw' cache='none' error_policy='stop' io='native'/&gt;
&gt; &lt;source dev='/dev/mapper/3600a09803830447a4f244c4657616f6f' index='1'&gt;
&gt; &lt;seclabel model='dac' relabel='no'/&gt;
&gt; &lt;reservations managed='yes'&gt;
&gt; &lt;source type='unix' \
&gt; path='/var/lib/libvirt/qemu/domain-1-Windows-2016-2/pr-helper0.sock' \
&gt; mode='client'/&gt; &lt;/reservations&gt;
&gt; &lt;/source&gt;
&gt; &lt;backingStore/&gt;
&gt; &lt;target dev='sdb' bus='scsi'/&gt;
&gt; &lt;shareable/&gt;
&gt; &lt;alias name='ua-26b4975e-e1d4-4e27-b2c6-2ea0894a571b'/&gt;
&gt; &lt;address type='drive' controller='0' bus='0' target='0' unit='1'/&gt;
&gt; &lt;/disk&gt;
&gt; 
&gt; and libvirt error I get is bellow [2].
&gt; 
&gt; When I try to create reservation from Windows VM manually, I get following error
&gt; (but not sure I do it whole process correctly):
&gt; 
&gt; .\sg_persist --out --register --param-sark=123abc e:
&gt; QEMU   QEMU HARDDISK               2.5+
&gt; Peripheral device type: disk
&gt; PR out (Register): command not supported
&gt; sg_persist failed: Illegal request, Invalid opcode
&gt; 
&gt; 
&gt; Do you have any ideas what could be wrong or how to determine
&gt; the root cause of this this issue?
&gt; 
&gt; Thanks in advance.
&gt; Vojta
&gt; 
&gt; 
&gt; [1] https://bugzilla.redhat.com/1898049
&gt; [2] libvirt debug log:
&gt; 
&gt; 2021-10-12 11:43:25.148+0000: 2006427: debug : qemuMonitorEmitIOError:1243 : \
&gt; mon=0x7fb02006a020 2021-10-12 11:43:25.148+0000: 2006427: info : virObjectRef:402 : \
&gt; OBJECT_REF: obj=0x7fb02006a020 2021-10-12 11:43:25.148+0000: 2006427: info : \
&gt; virObjectRef:402 : OBJECT_REF: obj=0x7fafd0130020 2021-10-12 11:43:25.148+0000: \
&gt; 2000208: info : virObjectRef:402 : OBJECT_REF: obj=0x7fafd010d340 2021-10-12 \
&gt; 11:43:25.148+0000: 2006427: info : virObjectNew:258 : OBJECT_NEW: \
&gt; obj=0x7fb020082590 classname=virDomainEventIOError 2021-10-12 11:43:25.148+0000: \
&gt; 2000208: info : vir_object_finalize:321 : OBJECT_DISPOSE: obj=0x7fb020082500 \
&gt; 2021-10-12 11:43:25.148+0000: 2006427: info : virObjectNew:258 : OBJECT_NEW: \
&gt; obj=0x7fb020082620 classname=virDomainEventIOError 2021-10-12 11:43:25.148+0000: \
&gt; 2000208: info : virObjectUnref:380 : OBJECT_UNREF: obj=0x7fb020082500 2021-10-12 \
&gt; 11:43:25.148+0000: 2006427: debug : qemuProcessHandleIOError:907 : Transitioned \
&gt; guest Windows-2016-2 to paused state due to IO error 2021-10-12 11:43:25.148+0000: \
&gt; 2000208: info : virObjectUnref:380 : OBJECT_UNREF: obj=0x7fafd010d340 2021-10-12 \
&gt; 11:43:25.148+0000: 2006427: info : virObjectNew:258 : OBJECT_NEW: \
&gt; obj=0x7fafbc1fb8c0 classname=virDomainEventLifecycle 2021-10-12 11:43:25.148+0000: \
&gt; 2006427: debug : virDomainLockProcessPause:204 : plugin=0x7fafd01272a0 \
&gt; dom=0x7fb01400f5e0 state=0x7fb02401d768 2021-10-12 11:43:25.148+0000: 2006427: \
&gt; debug : virDomainLockManagerNew:134 : plugin=0x7fafd01272a0 dom=0x7fb01400f5e0 \
&gt; withResources=1 2021-10-12 11:43:25.148+0000: 2006427: debug : \
&gt; virLockManagerPluginGetDriver:276 : plugin=0x7fafd01272a0 2021-10-12 \
&gt; 11:43:25.148+0000: 2006427: debug : virLockManagerNew:300 : driver=0x7fafd444a000 \
&gt; type=0 nparams=5 params=0x7fafd77de640 flags=0x0 2021-10-12 11:43:25.148+0000: \
&gt; 2006427: debug : virLockManagerLogParams:97 :   key=uuid type=uuid \
&gt; value=70eee88c-ba2c-4c6c-bd51-c2b663db27f8 2021-10-12 11:43:25.148+0000: 2006427: \
&gt; debug : virLockManagerLogParams:90 :   key=name type=string value=Windows-2016-2 \
&gt; 2021-10-12 11:43:25.148+0000: 2006427: debug : virLockManagerLogParams:78 :   \
&gt; key=id type=uint value=1 2021-10-12 11:43:25.148+0000: 2006427: debug : \
&gt; virLockManagerLogParams:78 :   key=pid type=uint value=2006418 2021-10-12 \
&gt; 11:43:25.148+0000: 2006427: debug : virLockManagerLogParams:93 :   key=uri \
&gt; type=cstring value=(null) 2021-10-12 11:43:25.148+0000: 2006427: debug : \
&gt; virDomainLockManagerNew:146 : Adding leases 2021-10-12 11:43:25.148+0000: 2006427: \
&gt; debug : virDomainLockManagerNew:151 : Adding disks 2021-10-12 11:43:25.149+0000: \
&gt; 2006427: debug : virDomainLockManagerAddImage:90 : Add disk \
&gt; /rhev/data-center/mnt/blockSD/7c4f09b6-9e87-436f-bda9-22d1f0b50955/images/f5d6e074-dfe9-462d-8cfd-3e14b0eb5aea/766e36b2-84a6-43e7-a48b-a5f47e669860
&gt;  2021-10-12 11:43:25.149+0000: 2006427: debug : virLockManagerAddResource:326 : \
&gt; lock=0x7fafbc19e250 type=0 \
&gt; name=/rhev/data-center/mnt/blockSD/7c4f09b6-9e87-436f-bda9-22d1f0b50955/images/f5d6e074-dfe9-462d-8cfd-3e14b0eb5aea/766e36b2-84a6-43e7-a48b-a5f47e669860 \
&gt; nparams=0 params=(nil) flags=0x0 2021-10-12 11:43:25.149+0000: 2006427: debug : \
&gt; virDomainLockManagerAddImage:90 : Add disk \
&gt; /dev/mapper/3600a09803830447a4f244c4657616f6f 2021-10-12 11:43:25.149+0000: \
&gt; 2006427: debug : virLockManagerAddResource:326 : lock=0x7fafbc19e250 type=0 \
&gt; name=/dev/mapper/3600a09803830447a4f244c4657616f6f nparams=0 params=(nil) flags=0x2 \
&gt; 2021-10-12 11:43:25.149+0000: 2006427: debug : virLockManagerRelease:359 : \
&gt; lock=0x7fafbc19e250 state=0x7fb02401d768 flags=0x0 2021-10-12 11:43:25.149+0000: \
&gt; 2006427: debug : virLockManagerFree:381 : lock=0x7fafbc19e250 2021-10-12 \
&gt; 11:43:25.149+0000: 2006427: debug : qemuProcessHandleIOError:920 : Preserving lock \
&gt; state '&lt;null&gt;' 2021-10-12 11:43:25.150+0000: 2006427: info : virObjectUnref:380 : \
&gt; OBJECT_UNREF: obj=0x7fafd0130020 2021-10-12 11:43:25.150+0000: 2006427: info : \
&gt; virObjectUnref:380 : OBJECT_UNREF: obj=0x7fb02006a020 2021-10-12 11:43:25.150+0000: \
&gt; 2000208: info : virObjectRef:402 : OBJECT_REF: obj=0x7fafd010d340 2021-10-12 \
&gt; 11:43:25.150+0000: 2000208: info : vir_object_finalize:321 : OBJECT_DISPOSE: \
&gt; obj=0x7fb020082590 2021-10-12 11:43:25.150+0000: 2006427: info : virObjectRef:402 : \
&gt; OBJECT_REF: obj=0x7fb02006a020 2021-10-12 11:43:25.150+0000: 2000208: info : \
&gt; virObjectUnref:380 : OBJECT_UNREF: obj=0x7fb020082590 2021-10-12 11:43:25.150+0000: \
&gt; 2006427: info : virObjectUnref:380 : OBJECT_UNREF: obj=0x7fb02006a020 2021-10-12 \
&gt; 11:43:25.150+0000: 2000208: info : virObjectNew:258 : OBJECT_NEW: \
&gt; obj=0x564a89a4cc60 classname=virDomain 2021-10-12 11:43:25.150+0000: 2006427: info \
&gt; : virObjectUnref:380 : OBJECT_UNREF: obj=0x7fb02006a020 2021-10-12 \
&gt; 11:43:25.150+0000: 2000208: info : virObjectRef:402 : OBJECT_REF: \
&gt; obj=0x7fafd0018ca0 2021-10-12 11:43:25.150+0000: 2000208: info : virObjectRef:402 : \
&gt; OBJECT_REF: obj=0x564a89978df0 2021-10-12 11:43:25.150+0000: 2000208: debug : \
&gt; virAccessManagerCheckDomain:238 : manager=0x564a89978df0(name=stack) driver=QEMU \
&gt; domain=0x7ffd2c677010 perm=0 2021-10-12 11:43:25.150+0000: 2000208: debug : \
&gt; virAccessManagerCheckDomain:238 : manager=0x564a89978e50(name=none) driver=QEMU \
&gt; domain=0x7ffd2c677010 perm=0 2021-10-12 11:43:25.150+0000: 2000208: info : \
&gt; virObjectUnref:380 : OBJECT_UNREF: obj=0x564a89978df0 2021-10-12 11:43:25.150+0000: \
&gt; 2000208: debug : remoteRelayDomainEventIOErrorReason:529 : Relaying domain io error \
&gt; Windows-2016-2 1 /dev/mapper/3600a09803830447a4f244c4657616f6f \
&gt; ua-26b4975e-e1d4-4e27-b2c6-2ea0894a571b 1 , callback 3 

Unfortunately, you cut off the log a bit early/late; there should be a
message from qemu's monitor mentioning BLOCK_IO_ERROR; Can you check
your logs please?

Michal


</body></email><email><emailId>20211008085437</emailId><senderName>Jaze Lee</senderName><senderEmail>jazeltq@gmail.com</senderEmail><timestampReceived>2021-10-08 08:54:37-0400</timestampReceived><subject>about pcie-hot-plug on aarch64</subject><body>

Hello,
    We run Openstack Stein on arm. It  runs nova-compute(use libvirt
as virt driver) on arm host. We found when built with disks (use ceph
rbd) on arm hosts, the vm can not attach all disk correctly. For
example, built with six disks, the vm may attach three disks. No
obvious error can be fond in nova-compute, libvirt. We compare aarch64
and x86, find when detach disk, the dmesg of the vm's os is different.
May be the pciehg parameter is different?

Did anyone met the problem?  Or some suggestions?


x86:
Nothing at all

aarch64:
Sep 29 15:28:55 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5):
Attention button pressed
Sep 29 15:28:55 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5):
Powering off due to button press
Sep 29 15:29:00 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5):
Attention button pressed
Sep 29 15:29:00 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5): Button cancel
Sep 29 15:29:00 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5):
Action canceled due to button press
Sep 29 15:29:07 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5):
Attention button pressed
Sep 29 15:29:07 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5):
Powering off due to button press
Sep 29 15:29:13 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5): Link Up
Sep 29 15:29:16 * kernel: pciehp 0000:00:01.5:pcie004: Failed to check
link status
Sep 29 15:29:18 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6):
Attention button pressed
Sep 29 15:29:18 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6):
Powering off due to button press
Sep 29 15:29:23 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6):
Attention button pressed
Sep 29 15:29:23 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6): Button cancel
Sep 29 15:29:23 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6):
Action canceled due to button press
Sep 29 15:29:30 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6):
Attention button pressed
Sep 29 15:29:30 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6):
Powering off due to button press
Sep 29 15:29:36 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6): Link Up
Sep 29 15:29:39 * kernel: pciehp 0000:00:01.6:pcie004: Failed to check
link status
Sep 29 15:29:39 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7):
Attention button pressed
Sep 29 15:29:39 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7):
Powering off due to button press
Sep 29 15:29:45 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7):
Attention button pressed
Sep 29 15:29:45 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7): Button cancel
Sep 29 15:29:45 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7):
Action canceled due to button press
Sep 29 15:29:52 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7):
Attention button pressed
Sep 29 15:29:52 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7):
Powering off due to button press
Sep 29 15:29:58 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7): Link Up
Sep 29 15:30:01 * kernel: pciehp 0000:00:02.0:pcie004: Slot(0-8):
Attention button pressed
Sep 29 15:30:01 * kernel: pciehp 0000:00:02.0:pcie004: Slot(0-8):
Powering off due to button press

</body></email><email><emailId>20211011014117</emailId><senderName>Jaze Lee</senderName><senderEmail>jazeltq@gmail.com</senderEmail><timestampReceived>2021-10-11 01:41:17-0400</timestampReceived><subject>Re: about pcie-hot-plug on aarch64</subject><body>

Hello?

Jaze Lee &lt;jazeltq@gmail.com&gt; 于2021年10月8日周五 下午4:54写道：
&gt;
&gt; Hello,
&gt;     We run Openstack Stein on arm. It  runs nova-compute(use libvirt
&gt; as virt driver) on arm host. We found when built with disks (use ceph
&gt; rbd) on arm hosts, the vm can not attach all disk correctly. For
&gt; example, built with six disks, the vm may attach three disks. No
&gt; obvious error can be fond in nova-compute, libvirt. We compare aarch64
&gt; and x86, find when detach disk, the dmesg of the vm's os is different.
&gt; May be the pciehg parameter is different?
&gt;
&gt; Did anyone met the problem?  Or some suggestions?
&gt;
&gt;
&gt; x86:
&gt; Nothing at all
&gt;
&gt; aarch64:
&gt; Sep 29 15:28:55 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5):
&gt; Attention button pressed
&gt; Sep 29 15:28:55 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5):
&gt; Powering off due to button press
&gt; Sep 29 15:29:00 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5):
&gt; Attention button pressed
&gt; Sep 29 15:29:00 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5): Button cancel
&gt; Sep 29 15:29:00 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5):
&gt; Action canceled due to button press
&gt; Sep 29 15:29:07 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5):
&gt; Attention button pressed
&gt; Sep 29 15:29:07 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5):
&gt; Powering off due to button press
&gt; Sep 29 15:29:13 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5): Link Up
&gt; Sep 29 15:29:16 * kernel: pciehp 0000:00:01.5:pcie004: Failed to check
&gt; link status
&gt; Sep 29 15:29:18 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6):
&gt; Attention button pressed
&gt; Sep 29 15:29:18 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6):
&gt; Powering off due to button press
&gt; Sep 29 15:29:23 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6):
&gt; Attention button pressed
&gt; Sep 29 15:29:23 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6): Button cancel
&gt; Sep 29 15:29:23 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6):
&gt; Action canceled due to button press
&gt; Sep 29 15:29:30 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6):
&gt; Attention button pressed
&gt; Sep 29 15:29:30 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6):
&gt; Powering off due to button press
&gt; Sep 29 15:29:36 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6): Link Up
&gt; Sep 29 15:29:39 * kernel: pciehp 0000:00:01.6:pcie004: Failed to check
&gt; link status
&gt; Sep 29 15:29:39 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7):
&gt; Attention button pressed
&gt; Sep 29 15:29:39 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7):
&gt; Powering off due to button press
&gt; Sep 29 15:29:45 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7):
&gt; Attention button pressed
&gt; Sep 29 15:29:45 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7): Button cancel
&gt; Sep 29 15:29:45 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7):
&gt; Action canceled due to button press
&gt; Sep 29 15:29:52 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7):
&gt; Attention button pressed
&gt; Sep 29 15:29:52 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7):
&gt; Powering off due to button press
&gt; Sep 29 15:29:58 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7): Link Up
&gt; Sep 29 15:30:01 * kernel: pciehp 0000:00:02.0:pcie004: Slot(0-8):
&gt; Attention button pressed
&gt; Sep 29 15:30:01 * kernel: pciehp 0000:00:02.0:pcie004: Slot(0-8):
&gt; Powering off due to button press



-- 
谦谦君子


</body></email><email><emailId>20211011014627</emailId><senderName>Han Han</senderName><senderEmail>hhan@redhat.com</senderEmail><timestampReceived>2021-10-11 01:46:27-0400</timestampReceived><subject>Re: about pcie-hot-plug on aarch64</subject><body>

On Fri, Oct 8, 2021 at 5:16 PM Jaze Lee &lt;jazeltq@gmail.com&gt; wrote:

&gt; Hello,
&gt;     We run Openstack Stein on arm. It  runs nova-compute(use libvirt
&gt; as virt driver) on arm host. We found when built with disks (use ceph
&gt; rbd) on arm hosts, the vm can not attach all disk correctly. For
&gt; example, built with six disks, the vm may attach three disks. No
&gt; obvious error can be fond in nova-compute, libvirt. We compare aarch64
&gt; and x86, find when detach disk, the dmesg of the vm's os is different.
&gt; May be the pciehg parameter is different?
&gt;
&gt; Please provide the version of libvirt, qemu,  openstack-nova and librbd1.

&gt; Did anyone met the problem?  Or some suggestions?
&gt;
&gt;
&gt; x86:
&gt; Nothing at all
&gt;
&gt; aarch64:
&gt; Sep 29 15:28:55 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5):
&gt; Attention button pressed
&gt; Sep 29 15:28:55 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5):
&gt; Powering off due to button press
&gt; Sep 29 15:29:00 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5):
&gt; Attention button pressed
&gt; Sep 29 15:29:00 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5): Button
&gt; cancel
&gt; Sep 29 15:29:00 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5):
&gt; Action canceled due to button press
&gt; Sep 29 15:29:07 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5):
&gt; Attention button pressed
&gt; Sep 29 15:29:07 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5):
&gt; Powering off due to button press
&gt; Sep 29 15:29:13 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5): Link Up
&gt; Sep 29 15:29:16 * kernel: pciehp 0000:00:01.5:pcie004: Failed to check
&gt; link status
&gt; Sep 29 15:29:18 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6):
&gt; Attention button pressed
&gt; Sep 29 15:29:18 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6):
&gt; Powering off due to button press
&gt; Sep 29 15:29:23 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6):
&gt; Attention button pressed
&gt; Sep 29 15:29:23 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6): Button
&gt; cancel
&gt; Sep 29 15:29:23 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6):
&gt; Action canceled due to button press
&gt; Sep 29 15:29:30 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6):
&gt; Attention button pressed
&gt; Sep 29 15:29:30 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6):
&gt; Powering off due to button press
&gt; Sep 29 15:29:36 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6): Link Up
&gt; Sep 29 15:29:39 * kernel: pciehp 0000:00:01.6:pcie004: Failed to check
&gt; link status
&gt; Sep 29 15:29:39 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7):
&gt; Attention button pressed
&gt; Sep 29 15:29:39 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7):
&gt; Powering off due to button press
&gt; Sep 29 15:29:45 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7):
&gt; Attention button pressed
&gt; Sep 29 15:29:45 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7): Button
&gt; cancel
&gt; Sep 29 15:29:45 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7):
&gt; Action canceled due to button press
&gt; Sep 29 15:29:52 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7):
&gt; Attention button pressed
&gt; Sep 29 15:29:52 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7):
&gt; Powering off due to button press
&gt; Sep 29 15:29:58 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7): Link Up
&gt; Sep 29 15:30:01 * kernel: pciehp 0000:00:02.0:pcie004: Slot(0-8):
&gt; Attention button pressed
&gt; Sep 29 15:30:01 * kernel: pciehp 0000:00:02.0:pcie004: Slot(0-8):
&gt; Powering off due to button press
&gt;
&gt;

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div dir="ltr" \
class="gmail_attr"&gt;On Fri, Oct 8, 2021 at 5:16 PM Jaze Lee &lt;&lt;a \
href="mailto:jazeltq@gmail.com"&gt;jazeltq@gmail.com&lt;/a&gt;&gt; wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote \
class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid \
                rgb(204,204,204);padding-left:1ex"&gt;Hello,&lt;br&gt;
      We run Openstack Stein on arm. It   runs nova-compute(use libvirt&lt;br&gt;
as virt driver) on arm host. We found when built with disks (use ceph&lt;br&gt;
rbd) on arm hosts, the vm can not attach all disk correctly. For&lt;br&gt;
example, built with six disks, the vm may attach three disks. No&lt;br&gt;
obvious error can be fond in nova-compute, libvirt. We compare aarch64&lt;br&gt;
and x86, find when detach disk, the dmesg of the vm's os is different.&lt;br&gt;
May be the pciehg parameter is different?&lt;br&gt;
&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;Please provide the version of libvirt, qemu,   openstack-nova \
and librbd1.&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt; Did anyone met the \
problem?   Or some suggestions?&lt;br&gt; &lt;br&gt;
&lt;br&gt;
x86:&lt;br&gt;
Nothing at all&lt;br&gt;
&lt;br&gt;
aarch64:&lt;br&gt;
Sep 29 15:28:55 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5):&lt;br&gt;
Attention button pressed&lt;br&gt;
Sep 29 15:28:55 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5):&lt;br&gt;
Powering off due to button press&lt;br&gt;
Sep 29 15:29:00 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5):&lt;br&gt;
Attention button pressed&lt;br&gt;
Sep 29 15:29:00 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5): Button cancel&lt;br&gt;
Sep 29 15:29:00 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5):&lt;br&gt;
Action canceled due to button press&lt;br&gt;
Sep 29 15:29:07 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5):&lt;br&gt;
Attention button pressed&lt;br&gt;
Sep 29 15:29:07 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5):&lt;br&gt;
Powering off due to button press&lt;br&gt;
Sep 29 15:29:13 * kernel: pciehp 0000:00:01.5:pcie004: Slot(0-5): Link Up&lt;br&gt;
Sep 29 15:29:16 * kernel: pciehp 0000:00:01.5:pcie004: Failed to check&lt;br&gt;
link status&lt;br&gt;
Sep 29 15:29:18 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6):&lt;br&gt;
Attention button pressed&lt;br&gt;
Sep 29 15:29:18 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6):&lt;br&gt;
Powering off due to button press&lt;br&gt;
Sep 29 15:29:23 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6):&lt;br&gt;
Attention button pressed&lt;br&gt;
Sep 29 15:29:23 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6): Button cancel&lt;br&gt;
Sep 29 15:29:23 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6):&lt;br&gt;
Action canceled due to button press&lt;br&gt;
Sep 29 15:29:30 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6):&lt;br&gt;
Attention button pressed&lt;br&gt;
Sep 29 15:29:30 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6):&lt;br&gt;
Powering off due to button press&lt;br&gt;
Sep 29 15:29:36 * kernel: pciehp 0000:00:01.6:pcie004: Slot(0-6): Link Up&lt;br&gt;
Sep 29 15:29:39 * kernel: pciehp 0000:00:01.6:pcie004: Failed to check&lt;br&gt;
link status&lt;br&gt;
Sep 29 15:29:39 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7):&lt;br&gt;
Attention button pressed&lt;br&gt;
Sep 29 15:29:39 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7):&lt;br&gt;
Powering off due to button press&lt;br&gt;
Sep 29 15:29:45 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7):&lt;br&gt;
Attention button pressed&lt;br&gt;
Sep 29 15:29:45 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7): Button cancel&lt;br&gt;
Sep 29 15:29:45 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7):&lt;br&gt;
Action canceled due to button press&lt;br&gt;
Sep 29 15:29:52 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7):&lt;br&gt;
Attention button pressed&lt;br&gt;
Sep 29 15:29:52 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7):&lt;br&gt;
Powering off due to button press&lt;br&gt;
Sep 29 15:29:58 * kernel: pciehp 0000:00:01.7:pcie004: Slot(0-7): Link Up&lt;br&gt;
Sep 29 15:30:01 * kernel: pciehp 0000:00:02.0:pcie004: Slot(0-8):&lt;br&gt;
Attention button pressed&lt;br&gt;
Sep 29 15:30:01 * kernel: pciehp 0000:00:02.0:pcie004: Slot(0-8):&lt;br&gt;
Powering off due to button press&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20211011160659</emailId><senderName>Andrea Bolognani</senderName><senderEmail>abologna@redhat.com</senderEmail><timestampReceived>2021-10-11 16:06:59-0400</timestampReceived><subject>Re: about pcie-hot-plug on aarch64</subject><body>

On Fri, Oct 08, 2021 at 04:54:37PM +0800, Jaze Lee wrote:
&gt; Hello,
&gt;     We run Openstack Stein on arm. It  runs nova-compute(use libvirt
&gt; as virt driver) on arm host. We found when built with disks (use ceph
&gt; rbd) on arm hosts, the vm can not attach all disk correctly. For
&gt; example, built with six disks, the vm may attach three disks. No
&gt; obvious error can be fond in nova-compute, libvirt. We compare aarch64
&gt; and x86, find when detach disk, the dmesg of the vm's os is different.
&gt; May be the pciehg parameter is different?
&gt;
&gt; Did anyone met the problem?  Or some suggestions?

I think you might have just ran out of PCI ports available for
hotplug. Please try setting

  https://docs.openstack.org/nova/stein/configuration/config.html#libvirt.num_pcie_ports

to a reasonable value and see whether that helps.

Note that, since you're using libvirt through OpenStack and not
directly, you're more likely to find someone who's able to help you
out if you use the OpenStack support channels.

-- 
Andrea Bolognani / Red Hat / Virtualization

</body></email><email><emailId>20211021160858</emailId><senderName>"Lentes, Bernd"</senderName><senderEmail>bernd.lentes@helmholtz-muenchen.de</senderEmail><timestampReceived>2021-10-21 16:08:58-0400</timestampReceived><subject>is there a way to stop a domain in 'D' process state (uninterruptible) ?</subject><body>


Hi,

how can i stop/shutdown a domain which is in process state 'D' ?
'D' means uninterruptible and a process in 'D' can't be terminated by kill, even not \
with kill -9.

Bernd

-- 

Bernd Lentes 
System Administrator 
Institute for Metabolism and Cell Death (MCD) 
Building 25 - office 122 
HelmholtzZentrum München 
bernd.lentes@helmholtz-muenchen.de 
phone: +49 89 3187 1241 
phone: +49 89 3187 3827 
fax: +49 89 3187 2294 
http://www.helmholtz-muenchen.de/mcd 


Public key: 

30 82 01 0a 02 82 01 01 00 b3 72 3e ce 2c 0a 6f 58 49 2c 92 23 c7 b9 c1 ff 6c 3a 53 \
be f7 9e e9 24 b7 49 fa 3c e8 de 28 85 2c d3 ed f7 70 03 3f 4d 82 fc cc 96 4f 18 27 \
1f df 25 b3 13 00 db 4b 1d ec 7f 1b cf f9 cd e8 5b 1f 11 b3 a7 48 f8 c8 37 ed 41 ff \
18 9f d7 83 51 a9 bd 86 c2 32 b3 d6 2d 77 ff 32 83 92 67 9e ae ae 9c 99 ce 42 27 6f \
bf d8 c2 a1 54 fd 2b 6b 12 65 0e 8a 79 56 be 53 89 70 51 02 6a eb 76 b8 92 25 2d 88 \
aa 57 08 42 ef 57 fb fe 00 71 8e 90 ef b2 e3 22 f3 34 4f 7b f1 c4 b1 7c 2f 1d 6f bd \
c8 a6 a1 1f 25 f3 e4 4b 6a 23 d3 d2 fa 27 ae 97 80 a3 f0 5a c4 50 4a 45 e3 45 4d 82 \
9f 8b 87 90 d0 f9 92 2d a7 d2 67 53 e6 ae 1e 72 3e e9 e0 c9 d3 1c 23 e0 75 78 4a 45 \
60 94 f8 e3 03 0b 09 85 08 d0 6c f3 ff ce fa 50 25 d9 da 81 7b 2a dc 9e 28 8b 83 04 \
b4 0a 9f 37 b8 ac 58 f1 38 43 0e 72 af 02 03 01 00 01


["smime.p7s" (application/pkcs7-signature)]

</body></email><email><emailId>20211021162017</emailId><senderName>Daniel =?utf-8?B?UC4gQmVycmFuZ8Op?=</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2021-10-21 16:20:17-0400</timestampReceived><subject>Re: is there a way to stop a domain in 'D' process state (uninterruptible) ?</subject><body>

On Thu, Oct 21, 2021 at 06:08:58PM +0200, Lentes, Bernd wrote:
&gt; Hi,
&gt; 
&gt; how can i stop/shutdown a domain which is in process state 'D' ?
&gt; 'D' means uninterruptible and a process in 'D' can't be terminated by kill, even not with kill -9.

Yeah, this is tricky. Usually this is a result of an I/O problem of
some kind and so the approach would be to diagnose what that root
cause is and try to solve it, to then unblock the VM.

Regards,
Daniel
-- 
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|

</body></email><email><emailId>20211022102742</emailId><senderName>Marc</senderName><senderEmail>marc@f1-outsourcing.eu</senderEmail><timestampReceived>2021-10-22 10:27:42-0400</timestampReceived><subject>load monitoring differences</subject><body>

I was wondering if it is normal that the load reported from within the guest differs \
a lot from the guest load monitored on the host?

Eg. currently I have guest that reports a load of 12-17 (uptime) while on the host \
top shows 70% cpu usage, I would expect this to be also around 12-17%.


</body></email><email><emailId>20211023195416</emailId><senderName></senderName><senderEmail>admin@foundryserver.com</senderEmail><timestampReceived>2021-10-23 19:54:16-0400</timestampReceived><subject>apt libvirt package</subject><body>

This is a multipart message in MIME format.

Hello, 

 

I am new to kvm/qemu/libvirt.  I am loving it.  I am working on setting my
first vm with shared file system with virtio-fs.  I got an error, and google
foo said, my version was too old.  When I checked it said.

 

libvirt version: 6.0.0, package: 0ubuntu8.14 (Matthew Ruffell
matthew.ruffell@canonical.com &lt;mailto:matthew.ruffell@canonical.com&gt;  Tue,
14 Sep 2021 14:00:49 +1200)

 

I used apt package manager to install libvirt. I am running on ubuntu 20.04.
I have tried apt update libvirt and I get..no updates available.  What do I
do at this point?  Do I have to build it from source?

 

Any help would be greatly appreciated.

 

Brad


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;&lt;head&gt;&lt;META HTTP-EQUIV="Content-Type" \
CONTENT="text/html; charset=us-ascii"&gt;&lt;meta name=Generator content="Microsoft Word 15 \
(filtered medium)"&gt;&lt;style&gt;&lt;!-- /* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-fareast-language:EN-US;}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:#0563C1;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri",sans-serif;
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;
	font-family:"Calibri",sans-serif;
	mso-fareast-language:EN-US;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;}
div.WordSection1
	{page:WordSection1;}
--&gt;&lt;/style&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapelayout v:ext="edit"&gt;
&lt;o:idmap v:ext="edit" data="1" /&gt;
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;&lt;/head&gt;&lt;body lang=EN-CA link="#0563C1" \
vlink="#954F72" style='word-wrap:break-word'&gt;&lt;div class=WordSection1&gt;&lt;p \
class=MsoNormal&gt;&lt;span lang=EN-US&gt;Hello, &lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;I am new to kvm/qemu/libvirt.  I am loving it.  I am working on \
setting my first vm with shared file system with virtio-fs.  I got an error, and \
google foo said, my version was too old.  When I checked it \
said.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;libvirt \
version: 6.0.0, package: 0ubuntu8.14 (Matthew Ruffell &lt;a \
href="mailto:matthew.ruffell@canonical.com"&gt;matthew.ruffell@canonical.com&lt;/a&gt; Tue, 14 \
Sep 2021 14:00:49 +1200)&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;I used apt \
package manager to install libvirt. I am running on ubuntu 20.04.  I have tried \
apt update libvirt and I get..no updates available.  What do I do at this \
point?  Do I have to build it from source?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;Any help would be greatly appreciated.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;Brad&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20211024193026</emailId><senderName></senderName><senderEmail>admin@foundryserver.com</senderEmail><timestampReceived>2021-10-24 19:30:26-0400</timestampReceived><subject>RE: apt libvirt package</subject><body>

This is a multipart message in MIME format.

Hello again,

 

So I have been struggling to compile the libvirt newest version  7.8.0.  I
am running CentOS 8 and during the meson build process I am getting non stop
dependency fails.  I keep installing the necessary packages and slowly
progressing.  Now the last one that stopped was gnutls.  When I go to
install that package   via  yum install gnutls -y it says that it is already
complete and installed.   Sigh...

 

I am very surprised that there is no package for libvirt via rpm,yum etc.
the lastest one installed via yum was 6.0.0.

 

Can someone help by pointing to some where that has these latest packages?
Or how best to compile this from source.  It is amazing how much is missing
from this distro.

 

Thanks again.

Brad

 

From: admin@foundryserver.com &lt;admin@foundryserver.com&gt; 
Sent: October 23, 2021 12:54 PM
To: 'libvirt-users@redhat.com' &lt;libvirt-users@redhat.com&gt;
Subject: apt libvirt package

 

Hello, 

 

I am new to kvm/qemu/libvirt.  I am loving it.  I am working on setting my
first vm with shared file system with virtio-fs.  I got an error, and google
foo said, my version was too old.  When I checked it said.

 

libvirt version: 6.0.0, package: 0ubuntu8.14 (Matthew Ruffell
matthew.ruffell@canonical.com &lt;mailto:matthew.ruffell@canonical.com&gt;  Tue,
14 Sep 2021 14:00:49 +1200)

 

I used apt package manager to install libvirt. I am running on ubuntu 20.04.
I have tried apt update libvirt and I get..no updates available.  What do I
do at this point?  Do I have to build it from source?

 

Any help would be greatly appreciated.

 

Brad


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;&lt;head&gt;&lt;meta http-equiv=Content-Type \
content="text/html; charset=us-ascii"&gt;&lt;meta name=Generator content="Microsoft Word 15 \
(filtered medium)"&gt;&lt;style&gt;&lt;!-- /* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-fareast-language:EN-US;}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:#0563C1;
	text-decoration:underline;}
span.EmailStyle19
	{mso-style-type:personal-reply;
	font-family:"Calibri",sans-serif;
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;
	font-size:10.0pt;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;}
div.WordSection1
	{page:WordSection1;}
--&gt;&lt;/style&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapelayout v:ext="edit"&gt;
&lt;o:idmap v:ext="edit" data="1" /&gt;
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;&lt;/head&gt;&lt;body lang=EN-CA link="#0563C1" \
vlink="#954F72" style='word-wrap:break-word'&gt;&lt;div class=WordSection1&gt;&lt;p \
class=MsoNormal&gt;Hello again,&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;So I have been struggling to compile the libvirt newest version  \
7.8.0.  I am running CentOS 8 and during the meson build process I am getting \
non stop dependency fails.  I keep installing the necessary packages and slowly \
progressing.  Now the last one that stopped was gnutls.  When I go to \
install that package   via  yum install gnutls -y it says that it is \
already complete and installed.   Sigh…….&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;I am very surprised that \
there is no package for libvirt via rpm,yum etc… the lastest one installed via \
yum was 6.0.0.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;Can someone help by pointing to some where that has these latest \
packages?  Or how best to compile this from source.  It is amazing how much \
is missing from this distro.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;Thanks again.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;Brad&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;div&gt;&lt;div style='border:none;border-top:solid \
#E1E1E1 1.0pt;padding:3.0pt 0cm 0cm 0cm'&gt;&lt;p class=MsoNormal&gt;&lt;b&gt;&lt;span lang=EN-US \
style='mso-fareast-language:EN-CA'&gt;From:&lt;/span&gt;&lt;/b&gt;&lt;span lang=EN-US \
style='mso-fareast-language:EN-CA'&gt; admin@foundryserver.com \
&lt;admin@foundryserver.com&gt; &lt;br&gt;&lt;b&gt;Sent:&lt;/b&gt; October 23, 2021 12:54 \
PM&lt;br&gt;&lt;b&gt;To:&lt;/b&gt; 'libvirt-users@redhat.com' \
&lt;libvirt-users@redhat.com&gt;&lt;br&gt;&lt;b&gt;Subject:&lt;/b&gt; apt libvirt \
package&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span lang=EN-US&gt;Hello, &lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;I am new to kvm/qemu/libvirt.  I am loving it.  I am working on \
setting my first vm with shared file system with virtio-fs.  I got an error, and \
google foo said, my version was too old.  When I checked it \
said.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;libvirt \
version: 6.0.0, package: 0ubuntu8.14 (Matthew Ruffell &lt;a \
href="mailto:matthew.ruffell@canonical.com"&gt;matthew.ruffell@canonical.com&lt;/a&gt; Tue, 14 \
Sep 2021 14:00:49 +1200)&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;I used apt \
package manager to install libvirt. I am running on ubuntu 20.04.  I have tried \
apt update libvirt and I get..no updates available.  What do I do at this \
point?  Do I have to build it from source?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;Any help would be greatly appreciated.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;Brad&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20211024213742</emailId><senderName>Peter Crowther</senderName><senderEmail>peter.crowther@melandra.com</senderEmail><timestampReceived>2021-10-24 21:37:42-0400</timestampReceived><subject>Re: apt libvirt package</subject><body>

Do you want this on CentOS 8, Ubuntu 20.04, or something else?  The help we
can give you will vary quite considerably depending on the distro you use;
and, as you point out, RedHat-derived and Debian-derived distributions are
very different.

For CentOS, do you have the advanced virtualization repo enabled?
https://centos.pkgs.org/8-stream/centos-extras-x86_64/centos-release-advanced-virtualization-1.0-3.el8.noarch.rpm.html


Cheers,

Peter

On Sun, 24 Oct 2021 at 20:31, &lt;admin@foundryserver.com&gt; wrote:

&gt; Hello again,
&gt; 
&gt; 
&gt; 
&gt; So I have been struggling to compile the libvirt newest version  7.8.0.  I
&gt; am running CentOS 8 and during the meson build process I am getting non
&gt; stop dependency fails.  I keep installing the necessary packages and slowly
&gt; progressing.  Now the last one that stopped was gnutls.  When I go to
&gt; install that package   via  yum install gnutls -y it says that it is
&gt; already complete and installed.   Sigh…….
&gt; 
&gt; 
&gt; 
&gt; I am very surprised that there is no package for libvirt via rpm,yum etc…
&gt; the lastest one installed via yum was 6.0.0.
&gt; 
&gt; 
&gt; 
&gt; Can someone help by pointing to some where that has these latest
&gt; packages?  Or how best to compile this from source.  It is amazing how much
&gt; is missing from this distro.
&gt; 
&gt; 
&gt; 
&gt; Thanks again.
&gt; 
&gt; Brad
&gt; 
&gt; 
&gt; 
&gt; *From:* admin@foundryserver.com &lt;admin@foundryserver.com&gt;
&gt; *Sent:* October 23, 2021 12:54 PM
&gt; *To:* 'libvirt-users@redhat.com' &lt;libvirt-users@redhat.com&gt;
&gt; *Subject:* apt libvirt package
&gt; 
&gt; 
&gt; 
&gt; Hello,
&gt; 
&gt; 
&gt; 
&gt; I am new to kvm/qemu/libvirt.  I am loving it.  I am working on setting my
&gt; first vm with shared file system with virtio-fs.  I got an error, and
&gt; google foo said, my version was too old.  When I checked it said.
&gt; 
&gt; 
&gt; 
&gt; libvirt version: 6.0.0, package: 0ubuntu8.14 (Matthew Ruffell
&gt; matthew.ruffell@canonical.com Tue, 14 Sep 2021 14:00:49 +1200)
&gt; 
&gt; 
&gt; 
&gt; I used apt package manager to install libvirt. I am running on ubuntu
&gt; 20.04.  I have tried apt update libvirt and I get..no updates available.
&gt; What do I do at this point?  Do I have to build it from source?
&gt; 
&gt; 
&gt; 
&gt; Any help would be greatly appreciated.
&gt; 
&gt; 
&gt; 
&gt; Brad
&gt; 


[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div&gt;Do you want this on CentOS 8, Ubuntu 20.04, or something else?   \
The help we can give you will vary quite considerably depending on the distro you \
use; and, as you point out, RedHat-derived and Debian-derived distributions are very \
different.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;For CentOS, do you have the advanced \
virtualization repo enabled?   &lt;a \
href="https://centos.pkgs.org/8-stream/centos-extras-x86_64/centos-release-advanced-vi \
rtualization-1.0-3.el8.noarch.rpm.html"&gt;https://centos.pkgs.org/8-stream/centos-extras \
-x86_64/centos-release-advanced-virtualization-1.0-3.el8.noarch.rpm.html&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Cheers,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Peter&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;&lt;div dir="ltr" class="gmail_attr"&gt;On Sun, 24 Oct 2021 at 20:31, \
&lt;&lt;a href="mailto:admin@foundryserver.com"&gt;admin@foundryserver.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0px 0px 0px \
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"&gt;&lt;div \
style="overflow-wrap: break-word;" lang="EN-CA"&gt;&lt;div \
class="gmail-m_-5226117585313802610WordSection1"&gt;&lt;p class="MsoNormal"&gt;Hello \
again,&lt;u&gt;&lt;/u&gt;&lt;u&gt;&lt;/u&gt;&lt;/p&gt;&lt;p class="MsoNormal"&gt;&lt;u&gt;&lt;/u&gt;  &lt;u&gt;&lt;/u&gt;&lt;/p&gt;&lt;p \
class="MsoNormal"&gt;So I have been struggling to compile the libvirt newest version   \
7.8.0.   I am running CentOS 8 and during the meson build process I am getting non \
stop dependency fails.   I keep installing the necessary packages and slowly \
progressing.   Now the last one that stopped was gnutls.   When I go to install that \
package     via   yum install gnutls -y it says that it is already complete and \
installed.     Sigh…….&lt;u&gt;&lt;/u&gt;&lt;u&gt;&lt;/u&gt;&lt;/p&gt;&lt;p class="MsoNormal"&gt;&lt;u&gt;&lt;/u&gt;  \
&lt;u&gt;&lt;/u&gt;&lt;/p&gt;&lt;p class="MsoNormal"&gt;I am very surprised that there is no package for \
libvirt via rpm,yum etc… the lastest one installed via yum was \
6.0.0.&lt;u&gt;&lt;/u&gt;&lt;u&gt;&lt;/u&gt;&lt;/p&gt;&lt;p class="MsoNormal"&gt;&lt;u&gt;&lt;/u&gt;  &lt;u&gt;&lt;/u&gt;&lt;/p&gt;&lt;p \
class="MsoNormal"&gt;Can someone help by pointing to some where that has these latest \
packages?   Or how best to compile this from source.   It is amazing how much is \
missing from this distro.&lt;u&gt;&lt;/u&gt;&lt;u&gt;&lt;/u&gt;&lt;/p&gt;&lt;p class="MsoNormal"&gt;&lt;u&gt;&lt;/u&gt;  \
&lt;u&gt;&lt;/u&gt;&lt;/p&gt;&lt;p class="MsoNormal"&gt;Thanks again.&lt;u&gt;&lt;/u&gt;&lt;u&gt;&lt;/u&gt;&lt;/p&gt;&lt;p \
class="MsoNormal"&gt;Brad&lt;u&gt;&lt;/u&gt;&lt;u&gt;&lt;/u&gt;&lt;/p&gt;&lt;p class="MsoNormal"&gt;&lt;u&gt;&lt;/u&gt;  \
&lt;u&gt;&lt;/u&gt;&lt;/p&gt;&lt;div&gt;&lt;div style="border-color:rgb(225,225,225) currentcolor \
currentcolor;border-style:solid none none;border-width:1pt medium medium;padding:3pt \
0cm 0cm"&gt;&lt;p class="MsoNormal"&gt;&lt;b&gt;&lt;span lang="EN-US"&gt;From:&lt;/span&gt;&lt;/b&gt;&lt;span \
lang="EN-US"&gt; &lt;a href="mailto:admin@foundryserver.com" \
target="_blank"&gt;admin@foundryserver.com&lt;/a&gt; &lt;&lt;a \
href="mailto:admin@foundryserver.com" target="_blank"&gt;admin@foundryserver.com&lt;/a&gt;&gt; \
&lt;br&gt;&lt;b&gt;Sent:&lt;/b&gt; October 23, 2021 12:54 PM&lt;br&gt;&lt;b&gt;To:&lt;/b&gt; '&lt;a \
href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;' &lt;&lt;a \
href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;&gt;&lt;br&gt;&lt;b&gt;Subject:&lt;/b&gt; apt libvirt \
package&lt;u&gt;&lt;/u&gt;&lt;u&gt;&lt;/u&gt;&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;p class="MsoNormal"&gt;&lt;u&gt;&lt;/u&gt;  \
&lt;u&gt;&lt;/u&gt;&lt;/p&gt;&lt;p class="MsoNormal"&gt;&lt;span lang="EN-US"&gt;Hello, &lt;u&gt;&lt;/u&gt;&lt;u&gt;&lt;/u&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class="MsoNormal"&gt;&lt;span lang="EN-US"&gt;&lt;u&gt;&lt;/u&gt;  &lt;u&gt;&lt;/u&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class="MsoNormal"&gt;&lt;span lang="EN-US"&gt;I am new to kvm/qemu/libvirt.   I am loving it.  \
I am working on setting my first vm with shared file system with virtio-fs.   I got \
an error, and google foo said, my version was too old.   When I checked it \
said.&lt;u&gt;&lt;/u&gt;&lt;u&gt;&lt;/u&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class="MsoNormal"&gt;&lt;span lang="EN-US"&gt;&lt;u&gt;&lt;/u&gt;  \
&lt;u&gt;&lt;/u&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class="MsoNormal"&gt;&lt;span lang="EN-US"&gt;libvirt version: 6.0.0, \
package: 0ubuntu8.14 (Matthew Ruffell &lt;a href="mailto:matthew.ruffell@canonical.com" \
target="_blank"&gt;matthew.ruffell@canonical.com&lt;/a&gt; Tue, 14 Sep 2021 14:00:49 \
+1200)&lt;u&gt;&lt;/u&gt;&lt;u&gt;&lt;/u&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class="MsoNormal"&gt;&lt;span lang="EN-US"&gt;&lt;u&gt;&lt;/u&gt;  \
&lt;u&gt;&lt;/u&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class="MsoNormal"&gt;&lt;span lang="EN-US"&gt;I used apt package manager \
to install libvirt. I am running on ubuntu 20.04.   I have tried apt update libvirt \
and I get..no updates available.   What do I do at this point?   Do I have to build \
it from source?&lt;u&gt;&lt;/u&gt;&lt;u&gt;&lt;/u&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class="MsoNormal"&gt;&lt;span \
lang="EN-US"&gt;&lt;u&gt;&lt;/u&gt;  &lt;u&gt;&lt;/u&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class="MsoNormal"&gt;&lt;span lang="EN-US"&gt;Any \
help would be greatly appreciated.&lt;u&gt;&lt;/u&gt;&lt;u&gt;&lt;/u&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class="MsoNormal"&gt;&lt;span \
lang="EN-US"&gt;&lt;u&gt;&lt;/u&gt;  &lt;u&gt;&lt;/u&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class="MsoNormal"&gt;&lt;span \
lang="EN-US"&gt;Brad&lt;u&gt;&lt;/u&gt;&lt;u&gt;&lt;/u&gt;&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;



</body></email><email><emailId>20211028184038</emailId><senderName>daggs</senderName><senderEmail>daggs@gmx.com</senderEmail><timestampReceived>2021-10-28 18:40:38-0400</timestampReceived><subject>another upgrade another vm issue</subject><body>

Greetings,

so I've upgraded my server and yet again, one of my vm lost a functionally.
there is no usable sound card.
xml: https://dpaste.com/CVR5M75VH
in vm: https://snipboard.io/aZ7Dcf.jpg

outputs:
utils_server /home/igor # qemu-system-x86_64 --version
QEMU emulator version 6.0.0
Copyright (c) 2003-2021 Fabrice Bellard and the QEMU Project developers
utils_server /home/igor # libvirtd --version
libvirtd (libvirt) 7.8.0
utils_server /home/igor #

any ideas?

Thanks.


</body></email><email><emailId>20211029003105</emailId><senderName>Philip Prindeville</senderName><senderEmail>philipp_subx@redfish-solutions.com</senderEmail><timestampReceived>2021-10-29 00:31:05-0400</timestampReceived><subject>Iptables, et al best practices for protecting KVM host sharing "hostdev" (ixgbe-vf) interfaces with </subject><body>

Hi,

I'm a developer and I use VM's for testing patches before submitting them (for \
various linux-* projects, as well as downstream things like OpenWrt, EPEL, etc).

I have a trunked 10Gb/s Ethernet connection coming into my KVM servers (all of which \
are Supermicro x86_servers running CentOS 8) that have igb and ixgbe NIC's, so SR-IOV \
capable.

Here's the situation:

* the host is on a secured internal network, called "sandbox", which is VLAN 4.

* the "external" network (i.e. public facing on my ISP) is "dirty", and is VLAN 66.

* the main subnet that laptops, WAPs, desktops, etc. sit on is "main", and is VLAN 1.

The KVM hosts sit wholly inside "sandbox".

They host, however, several guests some of which sit on "main", and some of which sit \
on "main" and "external" (for instance, if I'm testing an OpenWrt firewall \
configuration with patches and it needs to be publicly accessible so that my testers \
can peer with it via IPsec).  Oh, and one production guest which hosts "git" and sits \
only on "sandbox".

Guests can be CentOS 8S, Windows 11, Ubuntu 20, Debian whatever, Fedora 33 or 34, \
OpenWrt, etc.

My question is this: what's best practices for making sure that a switch VLAN \
misconfiguration issue, a cabling to the wrong port, etc. doesn't compromise the KVM \
server itself?

How do I allow my KVM server to *not* be on "external", but some of its guests to be, \
without compromising security?

Being the paranoid sort, I'd like to use defense-in-depth so I'm not counting on any \
single step to protect me.

For instance, I might use ebtables or iptables rules to block VLAN traffic on \
hosts/guests that I don't want to see certain VLAN's under any circumstances.

But I might also add interfaces to the list of things that NetworkManager ignores as \
/etc/NetworkManager/NetworkManager.conf lines like:

[keyfile]
unmanaged-devices=interface-name:eno*,except:interface-name:eno1
unmanaged-devices=interface-name:enp*

Thinking about that, I'm wondering what the notation is for telling NetworkManager to \
ignore all interfaces except those on VLAN 3, for instance.  Would that be:

unmanaged-devices=interface-name:eno*.*,except:interface-name:eno*.3

Or something else?

And what else can I do to further secure my KVM host?

I thought about using one untagged (non VLAN'd) Ethernet for the host, and another \
tagged Ethernet for the guests, but that just seemed like a false sense of \
security...

Apologies for the cross posting... these questions seems to touch on iptables, \
libvirt, and NetworkManager all at the same time...

Thanks,

-Philip


</body></email><email><emailId>20211029072224</emailId><senderName>Benno</senderName><senderEmail>b.ohnsorg@freenet.de</senderEmail><timestampReceived>2021-10-29 07:22:24-0400</timestampReceived><subject>Re: Iptables, et al best practices for protecting KVM host sharing "hostdev" (ixgbe-vf) interfaces w</subject><body>

Am 29.10.21 um 02:31 schrieb Philip Prindeville:
&gt; Hi,
&gt; 
&gt; […]
&gt; 
&gt; 
&gt; Here's the situation:
&gt; 
&gt; * the host is on a secured internal network, called "sandbox", which is VLAN 4.
&gt; 
&gt; * the "external" network (i.e. public facing on my ISP) is "dirty", and is VLAN 66.
&gt; 
&gt; * the main subnet that laptops, WAPs, desktops, etc. sit on is "main", and is VLAN \
&gt; 1. 
&gt; The KVM hosts sit wholly inside "sandbox".
&gt; 
&gt; They host, however, several guests some of which sit on "main", and some of which \
&gt; sit on "main" and "external" (for instance, if I'm testing an OpenWrt firewall \
&gt; configuration with patches and it needs to be publicly accessible so that my \
&gt; testers can peer with it via IPsec).  Oh, and one production guest which hosts \
&gt; "git" and sits only on "sandbox". 
&gt; Guests can be CentOS 8S, Windows 11, Ubuntu 20, Debian whatever, Fedora 33 or 34, \
&gt; OpenWrt, etc. 
&gt; My question is this: what's best practices for making sure that a switch VLAN \
&gt; misconfiguration issue, a cabling to the wrong port, etc. doesn't compromise the \
&gt; KVM server itself? 
&gt; How do I allow my KVM server to *not* be on "external", but some of its guests to \
&gt; be, without compromising security? 

How is this supposed to work? How does the server present network
connectivity to the guests? If the guests would directly bind to the
hardware jumping over the VM server what's the use of the VM then? (If
any of the systems in this stack does not bind services to the
particular network device it is not reachable through this network. As
soon as for example sshd is configured to bind to all network devices it
is accessible through any of them available to the VM.)

Regarding the switch: think of port duplication on the switch routing
all the traffic to a masked hoody wearing laptop owner. How can the
guest or host find out?

Wrong patching of the cables running virtual LANs (VLAN, multiple
networks over the same cable) leaves them intact (from your VMs point of
view)? I assume VLAN-configuration is per physical port? Adapting this
to VLAN misconfiguration puts your VLAN onto a different port that is
not yours? If it is instead of per port a tagging variant and link
aggregation is possible than how should you detect – except through
bandwidth measurement/ service monitoring (connection reset/ congestion
control) – that 4 planned links were reduced to 2?

It is very likely I got your scenario wrong. But unless you cannot trace
the hops and latency between origin of traffic and endpoint in your VMs
you cannot detect configuration changes/ wrong configuration. (If it is
the latter no connection at all is very likely.)

&gt; I have a trunked 10Gb/s Ethernet connection coming into my KVM servers (all of \
&gt; which are Supermicro x86_servers running CentOS 8) that have igb and ixgbe NIC's, \
&gt; so SR-IOV capable. […]
&gt; Being the paranoid sort, …
Just as a side and purely my personal opinion: CentOS seems not the best
choice to cure paranoia of the IT type. I also read NetworkManager as
your tool of choice. I am concerned with systems favoring an end user
targeted abstraction layer over hardened configuration. BSD flavors rely
on text files. From this basic layer you stack additional configuration
on each layer to connect VMs, workloads and so on being aware of the
necessary and possible routes. (I sometimes include dead-man-switches
when changing configs so if my ssh session is blocked by
misconfiguration it reverts to the previous state after a certain time
period.)


</body></email><email><emailId>20211029083624</emailId><senderName>Michal Prívozník</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2021-10-29 08:36:24-0400</timestampReceived><subject>Re: another upgrade another vm issue</subject><body>

On 10/28/21 8:40 PM, daggs wrote:
&gt; Greetings,
&gt; 
&gt; so I've upgraded my server and yet again, one of my vm lost a functionally.
&gt; there is no usable sound card.
&gt; xml: https://dpaste.com/CVR5M75VH
&gt; in vm: https://snipboard.io/aZ7Dcf.jpg
&gt; 
&gt; outputs:
&gt; utils_server /home/igor # qemu-system-x86_64 --version
&gt; QEMU emulator version 6.0.0
&gt; Copyright (c) 2003-2021 Fabrice Bellard and the QEMU Project developers
&gt; utils_server /home/igor # libvirtd --version
&gt; libvirtd (libvirt) 7.8.0
&gt; utils_server /home/igor #
&gt; 
&gt; any ideas?
&gt; 
&gt; Thanks.
&gt; 
&gt; 

I suspect it's related to:

  &lt;audio id='1' type='none'/&gt;

in the domain XML. Selecting a backend might help.

  https://libvirt.org/formatdomain.html#audio-backends

Michal

</body></email><email><emailId>20211029085758</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>dan@berrange.com</senderEmail><timestampReceived>2021-10-29 08:57:58-0400</timestampReceived><subject>Re: another upgrade another vm issue</subject><body>

On Fri, Oct 29, 2021 at 10:36:24AM +0200, Michal Prívozník wrote:
&gt; On 10/28/21 8:40 PM, daggs wrote:
&gt; &gt; Greetings,
&gt; &gt; 
&gt; &gt; so I've upgraded my server and yet again, one of my vm lost a functionally.
&gt; &gt; there is no usable sound card.
&gt; &gt; xml: https://dpaste.com/CVR5M75VH
&gt; &gt; in vm: https://snipboard.io/aZ7Dcf.jpg
&gt; &gt; 
&gt; &gt; outputs:
&gt; &gt; utils_server /home/igor # qemu-system-x86_64 --version
&gt; &gt; QEMU emulator version 6.0.0
&gt; &gt; Copyright (c) 2003-2021 Fabrice Bellard and the QEMU Project developers
&gt; &gt; utils_server /home/igor # libvirtd --version
&gt; &gt; libvirtd (libvirt) 7.8.0
&gt; &gt; utils_server /home/igor #
&gt; &gt; 
&gt; &gt; any ideas?
&gt; &gt; 
&gt; &gt; Thanks.
&gt; &gt; 
&gt; &gt; 
&gt; 
&gt; I suspect it's related to:
&gt; 
&gt;   &lt;audio id='1' type='none'/&gt;
&gt; 
&gt; in the domain XML. Selecting a backend might help.

That just sets the host OS backend. I see no &lt;sound&gt; device frontend
present in the guest OS. So unless one of the &lt;hostdev&gt; is a sound
card that explains the lack of sound in the guest.

If the &lt;hostdev&gt; is a sound card, then the &lt;audio&gt; backend is 
unrelated anyway.

With regards,
Daniel
--
|: https://berrange.com      -o-    https://www.flickr.com/photos/dberrange :|
|: https://libvirt.org         -o-            https://fstop138.berrange.com :|
|: https://entangle-photo.org    -o-    https://www.instagram.com/dberrange :|


</body></email><email><emailId>20211030105721</emailId><senderName>daggs</senderName><senderEmail>daggs@gmx.com</senderEmail><timestampReceived>2021-10-30 10:57:21-0400</timestampReceived><subject>Re: another upgrade another vm issue</subject><body>

Greetings Michal,

&gt; Sent: Friday, October 29, 2021 at 11:36 AM
&gt; From: "Michal Prívozník" &lt;mprivozn@redhat.com&gt;
&gt; To: "daggs" &lt;daggs@gmx.com&gt;, libvirt-users@redhat.com
&gt; Subject: Re: another upgrade another vm issue
&gt;
&gt; On 10/28/21 8:40 PM, daggs wrote:
&gt; &gt; Greetings,
&gt; &gt; 
&gt; &gt; so I've upgraded my server and yet again, one of my vm lost a functionally.
&gt; &gt; there is no usable sound card.
&gt; &gt; xml: https://dpaste.com/CVR5M75VH
&gt; &gt; in vm: https://snipboard.io/aZ7Dcf.jpg
&gt; &gt; 
&gt; &gt; outputs:
&gt; &gt; utils_server /home/igor # qemu-system-x86_64 --version
&gt; &gt; QEMU emulator version 6.0.0
&gt; &gt; Copyright (c) 2003-2021 Fabrice Bellard and the QEMU Project developers
&gt; &gt; utils_server /home/igor # libvirtd --version
&gt; &gt; libvirtd (libvirt) 7.8.0
&gt; &gt; utils_server /home/igor #
&gt; &gt; 
&gt; &gt; any ideas?
&gt; &gt; 
&gt; &gt; Thanks.
&gt; &gt; 
&gt; &gt; 
&gt; 
&gt; I suspect it's related to:
&gt; 
&gt;   &lt;audio id='1' type='none'/&gt;
&gt; 
&gt; in the domain XML. Selecting a backend might help.
&gt; 
&gt;   https://libvirt.org/formatdomain.html#audio-backends
&gt; 
&gt; Michal
&gt; 
&gt; 

I've diffed the current xml with the one last known to work, they both have the same entry

Thanks,

Dagg


</body></email><email><emailId>20211030110545</emailId><senderName>daggs</senderName><senderEmail>daggs@gmx.com</senderEmail><timestampReceived>2021-10-30 11:05:45-0400</timestampReceived><subject>Re: another upgrade another vm issue</subject><body>

Greetings Daniel,

&gt; Sent: Friday, October 29, 2021 at 11:57 AM
&gt; From: "Daniel P. Berrange" &lt;dan@berrange.com&gt;
&gt; To: "Michal Prívozník" &lt;mprivozn@redhat.com&gt;
&gt; Cc: "daggs" &lt;daggs@gmx.com&gt;, libvirt-users@redhat.com
&gt; Subject: Re: another upgrade another vm issue
&gt; 
&gt; On Fri, Oct 29, 2021 at 10:36:24AM +0200, Michal Prívozník wrote:
&gt; &gt; On 10/28/21 8:40 PM, daggs wrote:
&gt; &gt; &gt; Greetings,
&gt; &gt; &gt; 
&gt; &gt; &gt; so I've upgraded my server and yet again, one of my vm lost a functionally.
&gt; &gt; &gt; there is no usable sound card.
&gt; &gt; &gt; xml: https://dpaste.com/CVR5M75VH
&gt; &gt; &gt; in vm: https://snipboard.io/aZ7Dcf.jpg
&gt; &gt; &gt; 
&gt; &gt; &gt; outputs:
&gt; &gt; &gt; utils_server /home/igor # qemu-system-x86_64 --version
&gt; &gt; &gt; QEMU emulator version 6.0.0
&gt; &gt; &gt; Copyright (c) 2003-2021 Fabrice Bellard and the QEMU Project developers
&gt; &gt; &gt; utils_server /home/igor # libvirtd --version
&gt; &gt; &gt; libvirtd (libvirt) 7.8.0
&gt; &gt; &gt; utils_server /home/igor #
&gt; &gt; &gt; 
&gt; &gt; &gt; any ideas?
&gt; &gt; &gt; 
&gt; &gt; &gt; Thanks.
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; I suspect it's related to:
&gt; &gt; 
&gt; &gt; &lt;audio id='1' type='none'/&gt;
&gt; &gt; 
&gt; &gt; in the domain XML. Selecting a backend might help.
&gt; 
&gt; That just sets the host OS backend. I see no &lt;sound&gt; device frontend
&gt; present in the guest OS. So unless one of the &lt;hostdev&gt; is a sound
&gt; card that explains the lack of sound in the guest.
&gt; 
&gt; If the &lt;hostdev&gt; is a sound card, then the &lt;audio&gt; backend is 
&gt; unrelated anyway.
&gt; 
&gt; With regards,
&gt; Daniel

you are correct, my apologies, I've forgot to point out that it is a pt soundcard, \
the sound card is located at 00:1f.3 in the host and at 07:00.0 in the guest

Thanks,

Dagg


</body></email><email><emailId>20211030154021</emailId><senderName>Laine Stump</senderName><senderEmail>laine@redhat.com</senderEmail><timestampReceived>2021-10-30 15:40:21-0400</timestampReceived><subject>Re: another upgrade another vm issue</subject><body>



On 10/30/21 6:57 AM, daggs wrote:
&gt; Greetings Michal,
&gt; 
&gt;&gt; Sent: Friday, October 29, 2021 at 11:36 AM
&gt;&gt; From: "Michal Prívozník" &lt;mprivozn@redhat.com&gt;
&gt;&gt; To: "daggs" &lt;daggs@gmx.com&gt;, libvirt-users@redhat.com
&gt;&gt; Subject: Re: another upgrade another vm issue
&gt;&gt;
&gt;&gt; On 10/28/21 8:40 PM, daggs wrote:
&gt;&gt;&gt; Greetings,
&gt;&gt;&gt;
&gt;&gt;&gt; so I've upgraded my server and yet again, one of my vm lost a functionally.
&gt;&gt;&gt; there is no usable sound card.
&gt;&gt;&gt; xml: https://dpaste.com/CVR5M75VH
&gt;&gt;&gt; in vm: https://snipboard.io/aZ7Dcf.jpg
&gt;&gt;&gt;
&gt;&gt;&gt; outputs:
&gt;&gt;&gt; utils_server /home/igor # qemu-system-x86_64 --version
&gt;&gt;&gt; QEMU emulator version 6.0.0
&gt;&gt;&gt; Copyright (c) 2003-2021 Fabrice Bellard and the QEMU Project developers
&gt;&gt;&gt; utils_server /home/igor # libvirtd --version
&gt;&gt;&gt; libvirtd (libvirt) 7.8.0
&gt;&gt;&gt; utils_server /home/igor #
&gt;&gt;&gt;
&gt;&gt;&gt; any ideas?
&gt;&gt;&gt;
&gt;&gt;&gt; Thanks.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt; I suspect it's related to:
&gt;&gt;
&gt;&gt;    &lt;audio id='1' type='none'/&gt;
&gt;&gt;
&gt;&gt; in the domain XML. Selecting a backend might help.
&gt;&gt;
&gt;&gt;    https://libvirt.org/formatdomain.html#audio-backends
&gt;&gt;
&gt;&gt; Michal
&gt;&gt;
&gt;&gt;
&gt; 
&gt; I've diffed the current xml with the one last known to work, they both have the same entry

Can you possibly downgrade QEMU, libvirt, and the host kernel 
independently to see if downgrading just one (or two) of them fixes the 
problem?

(I would normally have suggested diffing the qemu commandline from the 
logs in /var/log/libvirt/qemu/${guestname}.log to see if the VFIO 
portion was unchanged (and thus counting out libvirt from the possible 
causes of the problem), but the commandlines have recently switched to 
using JSON syntax, so they will probably be different anyway).

Since your audio device is assigned with VFIO, and libvirt has nothing 
more to do with that than just unbinding the host driver and binding the 
vfio-pci driver, then putting the info on the commandline for QEMU, I'd 
put money on the problem being either in QEMU or the kernel, in which 
case you'd probably get more useful advice from the 
vfio-users@redhat.com mailing list than here.

</body></email><email><emailId>20211025164927</emailId><senderName></senderName><senderEmail>admin@foundryserver.com</senderEmail><timestampReceived>2021-10-25 16:49:27-0400</timestampReceived><subject>RE: apt libvirt package</subject><body>

This is a multipart message in MIME format.

I would prefer the ubuntu packages. I am most familiar with that distro.  I can make \
centos8 work if I have to but I prefer not.

 

Thanks

Brad

 

From: Peter Crowther &lt;peter.crowther@melandra.com&gt; 
Sent: October 24, 2021 2:38 PM
To: admin@foundryserver.com
Cc: libvirt-ML &lt;libvirt-users@redhat.com&gt;
Subject: Re: apt libvirt package

 

Do you want this on CentOS 8, Ubuntu 20.04, or something else?  The help we can give \
you will vary quite considerably depending on the distro you use; and, as you point \
out, RedHat-derived and Debian-derived distributions are very different.

 

For CentOS, do you have the advanced virtualization repo enabled?  \
https://centos.pkgs.org/8-stream/centos-extras-x86_64/centos-release-advanced-virtualization-1.0-3.el8.noarch.rpm.html


 

Cheers,

 

Peter

 

On Sun, 24 Oct 2021 at 20:31, &lt;admin@foundryserver.com \
&lt;mailto:admin@foundryserver.com&gt; &gt; wrote:

Hello again,

 

So I have been struggling to compile the libvirt newest version  7.8.0.  I am running \
CentOS 8 and during the meson build process I am getting non stop dependency fails.  \
I keep installing the necessary packages and slowly progressing.  Now the last one \
that stopped was gnutls.  When I go to install that package   via  yum install gnutls \
-y it says that it is already complete and installed.   Sigh…….

 

I am very surprised that there is no package for libvirt via rpm,yum etc… the \
lastest one installed via yum was 6.0.0.

 

Can someone help by pointing to some where that has these latest packages?  Or how \
best to compile this from source.  It is amazing how much is missing from this \
distro.

 

Thanks again.

Brad

 

From: admin@foundryserver.com &lt;mailto:admin@foundryserver.com&gt;  \
                &lt;admin@foundryserver.com &lt;mailto:admin@foundryserver.com&gt; &gt; 
Sent: October 23, 2021 12:54 PM
To: 'libvirt-users@redhat.com &lt;mailto:libvirt-users@redhat.com&gt; ' \
                &lt;libvirt-users@redhat.com &lt;mailto:libvirt-users@redhat.com&gt; &gt;
Subject: apt libvirt package

 

Hello, 

 

I am new to kvm/qemu/libvirt.  I am loving it.  I am working on setting my first vm \
with shared file system with virtio-fs.  I got an error, and google foo said, my \
version was too old.  When I checked it said.

 

libvirt version: 6.0.0, package: 0ubuntu8.14 (Matthew Ruffell \
matthew.ruffell@canonical.com &lt;mailto:matthew.ruffell@canonical.com&gt;  Tue, 14 Sep \
2021 14:00:49 +1200)

 

I used apt package manager to install libvirt. I am running on ubuntu 20.04.  I have \
tried apt update libvirt and I get..no updates available.  What do I do at this \
point?  Do I have to build it from source?

 

Any help would be greatly appreciated.

 

Brad


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;&lt;head&gt;&lt;meta http-equiv=Content-Type \
content="text/html; charset=utf-8"&gt;&lt;meta name=Generator content="Microsoft Word 15 \
(filtered medium)"&gt;&lt;style&gt;&lt;!-- /* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
span.EmailStyle18
	{mso-style-type:personal-reply;
	font-family:"Calibri",sans-serif;
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;
	font-family:"Calibri",sans-serif;
	mso-fareast-language:EN-US;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;}
div.WordSection1
	{page:WordSection1;}
--&gt;&lt;/style&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapelayout v:ext="edit"&gt;
&lt;o:idmap v:ext="edit" data="1" /&gt;
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;&lt;/head&gt;&lt;body lang=EN-CA link=blue vlink=purple \
style='word-wrap:break-word'&gt;&lt;div class=WordSection1&gt;&lt;p class=MsoNormal&gt;&lt;span \
style='mso-fareast-language:EN-US'&gt;I would prefer the ubuntu packages. I am most \
familiar with that distro.   I can make centos8 work if I have to but I prefer \
not.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
style='mso-fareast-language:EN-US'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span \
style='mso-fareast-language:EN-US'&gt;Thanks&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span style='mso-fareast-language:EN-US'&gt;Brad&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span \
style='mso-fareast-language:EN-US'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;div \
style='border:none;border-top:solid #E1E1E1 1.0pt;padding:3.0pt 0cm 0cm 0cm'&gt;&lt;p \
class=MsoNormal&gt;&lt;b&gt;&lt;span lang=EN-US&gt;From:&lt;/span&gt;&lt;/b&gt;&lt;span lang=EN-US&gt; Peter Crowther \
&lt;peter.crowther@melandra.com&gt; &lt;br&gt;&lt;b&gt;Sent:&lt;/b&gt; October 24, 2021 2:38 \
PM&lt;br&gt;&lt;b&gt;To:&lt;/b&gt; admin@foundryserver.com&lt;br&gt;&lt;b&gt;Cc:&lt;/b&gt; libvirt-ML \
&lt;libvirt-users@redhat.com&gt;&lt;br&gt;&lt;b&gt;Subject:&lt;/b&gt; Re: apt libvirt \
package&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;div&gt;&lt;div&gt;&lt;p class=MsoNormal&gt;Do you want this on \
CentOS 8, Ubuntu 20.04, or something else?  The help we can give you will vary \
quite considerably depending on the distro you use; and, as you point out, \
RedHat-derived and Debian-derived distributions are very \
different.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;/div&gt;&lt;div&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;/div&gt;&lt;div&gt;&lt;p class=MsoNormal&gt;For CentOS, do you \
have the advanced virtualization repo enabled?  &lt;a \
href="https://centos.pkgs.org/8-stream/centos-extras-x86_64/centos-release-advanced-vi \
rtualization-1.0-3.el8.noarch.rpm.html"&gt;https://centos.pkgs.org/8-stream/centos-extras \
-x86_64/centos-release-advanced-virtualization-1.0-3.el8.noarch.rpm.html&lt;/a&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;/div&gt;&lt;div&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;/div&gt;&lt;div&gt;&lt;p \
class=MsoNormal&gt;Cheers,&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;/div&gt;&lt;div&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;/div&gt;&lt;div&gt;&lt;p \
class=MsoNormal&gt;Peter&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;div&gt;&lt;div&gt;&lt;p class=MsoNormal&gt;On Sun, 24 Oct 2021 \
at 20:31, &lt;&lt;a href="mailto:admin@foundryserver.com"&gt;admin@foundryserver.com&lt;/a&gt;&gt; \
wrote:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;/div&gt;&lt;blockquote style='border:none;border-left:solid #CCCCCC \
1.0pt;padding:0cm 0cm 0cm 6.0pt;margin-left:4.8pt;margin-right:0cm'&gt;&lt;div&gt;&lt;div&gt;&lt;p \
class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'&gt;Hello \
again,&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'&gt; &lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'&gt;So I have \
been struggling to compile the libvirt newest version  7.8.0.  I am running \
CentOS 8 and during the meson build process I am getting non stop dependency \
fails.  I keep installing the necessary packages and slowly progressing.  \
Now the last one that stopped was gnutls.  When I go to install that \
package   via  yum install gnutls -y it says that it is already \
complete and installed.   Sigh…….&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'&gt; &lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'&gt;I am very \
surprised that there is no package for libvirt via rpm,yum etc… the lastest one \
installed via yum was 6.0.0.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'&gt; &lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'&gt;Can \
someone help by pointing to some where that has these latest packages?  Or how \
best to compile this from source.  It is amazing how much is missing from this \
distro.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'&gt; &lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'&gt;Thanks \
again.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'&gt;Brad&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'&gt; &lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;div&gt;&lt;div \
style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0cm 0cm \
0cm;border-color:currentcolor currentcolor'&gt;&lt;p class=MsoNormal \
style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'&gt;&lt;b&gt;&lt;span \
lang=EN-US&gt;From:&lt;/span&gt;&lt;/b&gt;&lt;span lang=EN-US&gt; &lt;a href="mailto:admin@foundryserver.com" \
target="_blank"&gt;admin@foundryserver.com&lt;/a&gt; &lt;&lt;a \
href="mailto:admin@foundryserver.com" target="_blank"&gt;admin@foundryserver.com&lt;/a&gt;&gt; \
&lt;br&gt;&lt;b&gt;Sent:&lt;/b&gt; October 23, 2021 12:54 PM&lt;br&gt;&lt;b&gt;To:&lt;/b&gt; '&lt;a \
href="mailto:libvirt-users@redhat.com" target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;' \
&lt;&lt;a href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;&gt;&lt;br&gt;&lt;b&gt;Subject:&lt;/b&gt; apt libvirt \
package&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;p class=MsoNormal \
style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'&gt; &lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'&gt;&lt;span \
lang=EN-US&gt;Hello, &lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'&gt;&lt;span \
lang=EN-US&gt; &lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'&gt;&lt;span lang=EN-US&gt;I am new \
to kvm/qemu/libvirt.  I am loving it.  I am working on setting my first vm \
with shared file system with virtio-fs.  I got an error, and google foo said, my \
version was too old.  When I checked it said.&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'&gt;&lt;span \
lang=EN-US&gt; &lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'&gt;&lt;span lang=EN-US&gt;libvirt \
version: 6.0.0, package: 0ubuntu8.14 (Matthew Ruffell &lt;a \
href="mailto:matthew.ruffell@canonical.com" \
target="_blank"&gt;matthew.ruffell@canonical.com&lt;/a&gt; Tue, 14 Sep 2021 14:00:49 \
+1200)&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'&gt;&lt;span \
lang=EN-US&gt; &lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'&gt;&lt;span lang=EN-US&gt;I used \
apt package manager to install libvirt. I am running on ubuntu 20.04.  I have \
tried apt update libvirt and I get..no updates available.  What do I do at this \
point?  Do I have to build it from source?&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'&gt;&lt;span \
lang=EN-US&gt; &lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'&gt;&lt;span lang=EN-US&gt;Any help \
would be greatly appreciated.&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'&gt;&lt;span \
lang=EN-US&gt; &lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal \
style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'&gt;&lt;span \
lang=EN-US&gt;Brad&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;




</body></email><email><emailId>20211025165926</emailId><senderName>"Paul D. O'Rorke"</senderName><senderEmail>paul@tracker-software.com</senderEmail><timestampReceived>2021-10-25 16:59:26-0400</timestampReceived><subject>Re: apt libvirt package</subject><body>

Hi Brad,

For Ubuntu add the Linbit PPA.  From this page: 
https://linbit.com/drbd-user-guide/drbd-guide-9_0-en/#s-from-source


            3.3.3. Ubuntu Linux

    For Ubuntu LTS, LINBIT offers a PPA repository
    athttps://launchpad.net/~linbit/+archive/ubuntu/linbit-drbd9-stack
    &lt;https://launchpad.net/~linbit/+archive/ubuntu/linbit-drbd9-stack&gt;.
    SeeAdding Launchpad PPA Repositories
    &lt;https://help.ubuntu.com/community/Repositories/CommandLine#Adding_Launchpad_PPA_Repositories&gt;for
  more information

20.04 LTS then has DRBD9 from apt.

* Paul O'Rorke*

On 2021-10-25 9:49 a.m., admin@foundryserver.com wrote:

&gt; I would prefer the ubuntu packages. I am most familiar with that 
&gt; distro.  I can make centos8 work if I have to but I prefer not.
&gt; 
&gt; Thanks
&gt; 
&gt; Brad
&gt; 
&gt; *From:*Peter Crowther &lt;peter.crowther@melandra.com&gt;
&gt; *Sent:* October 24, 2021 2:38 PM
&gt; *To:* admin@foundryserver.com
&gt; *Cc:* libvirt-ML &lt;libvirt-users@redhat.com&gt;
&gt; *Subject:* Re: apt libvirt package
&gt; 
&gt; Do you want this on CentOS 8, Ubuntu 20.04, or something else?  The 
&gt; help we can give you will vary quite considerably depending on the 
&gt; distro you use; and, as you point out, RedHat-derived and 
&gt; Debian-derived distributions are very different.
&gt; 
&gt; For CentOS, do you have the advanced virtualization repo enabled? 
&gt; https://centos.pkgs.org/8-stream/centos-extras-x86_64/centos-release-advanced-virtualization-1.0-3.el8.noarch.rpm.html
&gt;  
&gt; Cheers,
&gt; 
&gt; Peter
&gt; 
&gt; On Sun, 24 Oct 2021 at 20:31, &lt;admin@foundryserver.com&gt; wrote:
&gt; 
&gt; Hello again,
&gt; 
&gt; So I have been struggling to compile the libvirt newest version 
&gt; 7.8.0.  I am running CentOS 8 and during the meson build process I
&gt; am getting non stop dependency fails.  I keep installing the
&gt; necessary packages and slowly progressing.  Now the last one that
&gt; stopped was gnutls.  When I go to install that package   via  yum
&gt; install gnutls -y it says that it is already complete and
&gt; installed.   Sigh…….
&gt; 
&gt; I am very surprised that there is no package for libvirt via
&gt; rpm,yum etc… the lastest one installed via yum was 6.0.0.
&gt; 
&gt; Can someone help by pointing to some where that has these latest
&gt; packages?  Or how best to compile this from source.  It is amazing
&gt; how much is missing from this distro.
&gt; 
&gt; Thanks again.
&gt; 
&gt; Brad
&gt; 
&gt; *From:*admin@foundryserver.com &lt;admin@foundryserver.com&gt;
&gt; *Sent:* October 23, 2021 12:54 PM
&gt; *To:* 'libvirt-users@redhat.com' &lt;libvirt-users@redhat.com&gt;
&gt; *Subject:* apt libvirt package
&gt; 
&gt; Hello,
&gt; 
&gt; I am new to kvm/qemu/libvirt.  I am loving it.  I am working on
&gt; setting my first vm with shared file system with virtio-fs.  I got
&gt; an error, and google foo said, my version was too old.  When I
&gt; checked it said.
&gt; 
&gt; libvirt version: 6.0.0, package: 0ubuntu8.14 (Matthew Ruffell
&gt; matthew.ruffell@canonical.com Tue, 14 Sep 2021 14:00:49 +1200)
&gt; 
&gt; I used apt package manager to install libvirt. I am running on
&gt; ubuntu 20.04.  I have tried apt update libvirt and I get..no
&gt; updates available. What do I do at this point?  Do I have to build
&gt; it from source?
&gt; 
&gt; Any help would be greatly appreciated.
&gt; 
&gt; Brad
&gt; 


[Attachment #3 (text/html)]

&lt;html&gt;
  &lt;head&gt;
    &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;p&gt;Hi Brad,&lt;/p&gt;
    &lt;p&gt;For Ubuntu add the Linbit PPA.  From this page: &lt;a
        moz-do-not-send="true"
href="https://linbit.com/drbd-user-guide/drbd-guide-9_0-en/#s-from-source"
        class="moz-txt-link-freetext"&gt;https://linbit.com/drbd-user-guide/drbd-guide-9_0-en/#s-from-source&lt;/a&gt;&lt;/p&gt;
  &lt;blockquote&gt;
      &lt;h4 id="s-install-pkgs-ubuntu_linux" style="box-sizing:
        border-box; margin-top: -130px; margin-bottom: 1rem;
        font-family: Roboto, sans-serif; font-weight: 500; line-height:
        1.2; color: rgb(0, 0, 0); font-size: 1.5rem; padding-top: 130px;
        font-style: normal; font-variant-ligatures: normal;
        font-variant-caps: normal; letter-spacing: normal; orphans: 2;
        text-align: start; text-indent: 0px; text-transform: none;
        white-space: normal; widows: 2; word-spacing: 0px;
        -webkit-text-stroke-width: 0px; background-color: rgb(255, 255,
        255); text-decoration-thickness: initial; text-decoration-style:
        initial; text-decoration-color: initial;"&gt;3.3.3. Ubuntu Linux&lt;/h4&gt;
      &lt;div class="paragraph" style="box-sizing: border-box; color:
        rgb(0, 0, 0); font-family: Roboto, sans-serif; font-size: 16px;
        font-style: normal; font-variant-ligatures: normal;
        font-variant-caps: normal; font-weight: 400; letter-spacing:
        normal; orphans: 2; text-align: start; text-indent: 0px;
        text-transform: none; white-space: normal; widows: 2;
        word-spacing: 0px; -webkit-text-stroke-width: 0px;
        background-color: rgb(255, 255, 255); text-decoration-thickness:
        initial; text-decoration-style: initial; text-decoration-color:
        initial;"&gt;
        &lt;p style="box-sizing: border-box; margin-top: 0px;
          margin-bottom: 0.9rem;"&gt;For Ubuntu LTS, LINBIT offers a PPA
          repository at&lt;span&gt; &lt;/span&gt;&lt;a
            href="https://launchpad.net/~linbit/+archive/ubuntu/linbit-drbd9-stack"
            class="bare moz-txt-link-freetext" style="box-sizing:
            border-box; background-color: transparent; text-decoration:
            none; color: rgb(247, 145, 51); box-shadow: none;
            word-break: \
break-word;"&gt;https://launchpad.net/~linbit/+archive/ubuntu/linbit-drbd9-stack&lt;/a&gt;.  \
See&lt;span&gt; &lt;/span&gt;&lt;a href="https://help.ubuntu.com/community/Repositories/CommandLine#Adding_Launchpad_PPA_Repositories"
  style="box-sizing: border-box; background-color:
            transparent; text-decoration: none; color: rgb(247, 145,
            51); box-shadow: none;"&gt;Adding Launchpad PPA Repositories&lt;/a&gt;&lt;span&gt; \
&lt;/span&gt;for  more information&lt;/p&gt;
      &lt;/div&gt;
    &lt;/blockquote&gt;
    &lt;p&gt;20.04 LTS then has DRBD9 from apt.&lt;br&gt;
    &lt;/p&gt;
    &lt;div class="moz-signature"&gt;
      &lt;meta http-equiv="content-type" content="text/html; charset=UTF-8"&gt;
      &lt;title&gt;&lt;/title&gt;
      &lt;p&gt;&lt;b&gt; Paul O'Rorke&lt;/b&gt;&lt;/p&gt;
      &lt;p&gt;On 2021-10-25 9:49 a.m., &lt;a class="moz-txt-link-abbreviated" \
href="mailto:admin@foundryserver.com"&gt;admin@foundryserver.com&lt;/a&gt; wrote:&lt;br&gt;  &lt;/p&gt;
    &lt;/div&gt;
    &lt;blockquote type="cite"
      cite="mid:01bc01d7c9c0$46e3b170$d4ab1450$@foundryserver.com"&gt;
      &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
      &lt;meta name="Generator" content="Microsoft Word 15 (filtered
        medium)"&gt;
      &lt;style&gt;@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}span.EmailStyle18
	{mso-style-type:personal-reply;
	font-family:"Calibri",sans-serif;
	color:windowtext;}.MsoChpDefault
	{mso-style-type:export-only;
	font-family:"Calibri",sans-serif;
	mso-fareast-language:EN-US;}div.WordSection1
	{page:WordSection1;}&lt;/style&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapelayout v:ext="edit"&gt;
&lt;o:idmap v:ext="edit" data="1" /&gt;
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
      &lt;div class="WordSection1"&gt;
        &lt;p class="MsoNormal"&gt;&lt;span style="mso-fareast-language:EN-US"&gt;I
            would prefer the ubuntu packages. I am most familiar with
            that distro.  I can make centos8 work if I have to but I
            prefer not.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
        &lt;p class="MsoNormal"&gt;&lt;span style="mso-fareast-language:EN-US"&gt;&lt;o:p&gt; \
                &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
        &lt;p class="MsoNormal"&gt;&lt;span \
                style="mso-fareast-language:EN-US"&gt;Thanks&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
        &lt;p class="MsoNormal"&gt;&lt;span \
                style="mso-fareast-language:EN-US"&gt;Brad&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
        &lt;p class="MsoNormal"&gt;&lt;span style="mso-fareast-language:EN-US"&gt;&lt;o:p&gt; \
&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;  &lt;div style="border:none;border-top:solid #E1E1E1
          1.0pt;padding:3.0pt 0cm 0cm 0cm"&gt;
          &lt;p class="MsoNormal"&gt;&lt;b&gt;&lt;span lang="EN-US"&gt;From:&lt;/span&gt;&lt;/b&gt;&lt;span
              lang="EN-US"&gt; Peter Crowther
              &lt;a class="moz-txt-link-rfc2396E" \
href="mailto:peter.crowther@melandra.com"&gt;&lt;peter.crowther@melandra.com&gt;&lt;/a&gt; \
&lt;br&gt;  &lt;b&gt;Sent:&lt;/b&gt; October 24, 2021 2:38 PM&lt;br&gt;
              &lt;b&gt;To:&lt;/b&gt; &lt;a class="moz-txt-link-abbreviated" \
                href="mailto:admin@foundryserver.com"&gt;admin@foundryserver.com&lt;/a&gt;&lt;br&gt;
              &lt;b&gt;Cc:&lt;/b&gt; libvirt-ML &lt;a class="moz-txt-link-rfc2396E" \
                href="mailto:libvirt-users@redhat.com"&gt;&lt;libvirt-users@redhat.com&gt;&lt;/a&gt;&lt;br&gt;
                
              &lt;b&gt;Subject:&lt;/b&gt; Re: apt libvirt package&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
        &lt;/div&gt;
        &lt;p class="MsoNormal"&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;
        &lt;div&gt;
          &lt;div&gt;
            &lt;p class="MsoNormal"&gt;Do you want this on CentOS 8, Ubuntu
              20.04, or something else?  The help we can give you will
              vary quite considerably depending on the distro you use;
              and, as you point out, RedHat-derived and Debian-derived
              distributions are very different.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
          &lt;/div&gt;
          &lt;div&gt;
            &lt;p class="MsoNormal"&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;
          &lt;/div&gt;
          &lt;div&gt;
            &lt;p class="MsoNormal"&gt;For CentOS, do you have the advanced
              virtualization repo enabled?  &lt;a
href="https://centos.pkgs.org/8-stream/centos-extras-x86_64/centos-release-advanced-virtualization-1.0-3.el8.noarch.rpm.html"
  moz-do-not-send="true" \
class="moz-txt-link-freetext"&gt;https://centos.pkgs.org/8-stream/centos-extras-x86_64/ce \
ntos-release-advanced-virtualization-1.0-3.el8.noarch.rpm.html&lt;/a&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;  \
&lt;/div&gt;  &lt;div&gt;
            &lt;p class="MsoNormal"&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;
          &lt;/div&gt;
          &lt;div&gt;
            &lt;p class="MsoNormal"&gt;Cheers,&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
          &lt;/div&gt;
          &lt;div&gt;
            &lt;p class="MsoNormal"&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;
          &lt;/div&gt;
          &lt;div&gt;
            &lt;p class="MsoNormal"&gt;Peter&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
          &lt;/div&gt;
        &lt;/div&gt;
        &lt;p class="MsoNormal"&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;
        &lt;div&gt;
          &lt;div&gt;
            &lt;p class="MsoNormal"&gt;On Sun, 24 Oct 2021 at 20:31, &lt;&lt;a
                href="mailto:admin@foundryserver.com"
                moz-do-not-send="true" \
class="moz-txt-link-freetext"&gt;admin@foundryserver.com&lt;/a&gt;&gt;  wrote:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
          &lt;/div&gt;
          &lt;blockquote style="border:none;border-left:solid #CCCCCC
            1.0pt;padding:0cm 0cm 0cm
            6.0pt;margin-left:4.8pt;margin-right:0cm"&gt;
            &lt;div&gt;
              &lt;div&gt;
                &lt;p class="MsoNormal"
                  style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;Hello
                  again,&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                &lt;p class="MsoNormal"
                  style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt; \
&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;  &lt;p class="MsoNormal"
                  style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;So
                  I have been struggling to compile the libvirt newest
                  version  7.8.0.  I am running CentOS 8 and during the
                  meson build process I am getting non stop dependency
                  fails.  I keep installing the necessary packages and
                  slowly progressing.  Now the last one that stopped was
                  gnutls.  When I go to install that package   via  yum
                  install gnutls -y it says that it is already complete
                  and installed.   Sigh…….&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                &lt;p class="MsoNormal"
                  style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt; \
&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;  &lt;p class="MsoNormal"
                  style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;I
                  am very surprised that there is no package for libvirt
                  via rpm,yum etc… the lastest one installed via yum was
                  6.0.0.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                &lt;p class="MsoNormal"
                  style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt; \
&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;  &lt;p class="MsoNormal"
                  style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;Can
                  someone help by pointing to some where that has these
                  latest packages?  Or how best to compile this from
                  source.  It is amazing how much is missing from this
                  distro.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                &lt;p class="MsoNormal"
                  style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt; \
&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;  &lt;p class="MsoNormal"
                  style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;Thanks
                  again.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                &lt;p class="MsoNormal"
                  style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;Brad&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
  &lt;p class="MsoNormal"
                  style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt; \
&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;  &lt;div&gt;
                  &lt;div style="border:none;border-top:solid windowtext
                    1.0pt;padding:3.0pt 0cm 0cm
                    0cm;border-color:currentcolor currentcolor"&gt;
                    &lt;p class="MsoNormal"
                      \
style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;&lt;b&gt;&lt;span  \
lang="EN-US"&gt;From:&lt;/span&gt;&lt;/b&gt;&lt;span  lang="EN-US"&gt; &lt;a
                          href="mailto:admin@foundryserver.com"
                          target="_blank" moz-do-not-send="true"
                          class="moz-txt-link-freetext"&gt;admin@foundryserver.com&lt;/a&gt;
                        &lt;&lt;a href="mailto:admin@foundryserver.com"
                          target="_blank" moz-do-not-send="true"
                          \
class="moz-txt-link-freetext"&gt;admin@foundryserver.com&lt;/a&gt;&gt;  &lt;br&gt;
                        &lt;b&gt;Sent:&lt;/b&gt; October 23, 2021 12:54 PM&lt;br&gt;
                        &lt;b&gt;To:&lt;/b&gt; '&lt;a
                          href="mailto:libvirt-users@redhat.com"
                          target="_blank" moz-do-not-send="true"
                          class="moz-txt-link-freetext"&gt;libvirt-users@redhat.com&lt;/a&gt;'
                        &lt;&lt;a href="mailto:libvirt-users@redhat.com"
                          target="_blank" moz-do-not-send="true"
                          \
                class="moz-txt-link-freetext"&gt;libvirt-users@redhat.com&lt;/a&gt;&gt;&lt;br&gt;
                        &lt;b&gt;Subject:&lt;/b&gt; apt libvirt package&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                  &lt;/div&gt;
                &lt;/div&gt;
                &lt;p class="MsoNormal"
                  style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt; \
&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;  &lt;p class="MsoNormal"
                  style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;&lt;span
                    lang="EN-US"&gt;Hello, &lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                &lt;p class="MsoNormal"
                  style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;&lt;span
                    lang="EN-US"&gt; &lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                &lt;p class="MsoNormal"
                  style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;&lt;span
                    lang="EN-US"&gt;I am new to kvm/qemu/libvirt.  I am
                    loving it.  I am working on setting my first vm with
                    shared file system with virtio-fs.  I got an error,
                    and google foo said, my version was too old.  When I
                    checked it said.&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                &lt;p class="MsoNormal"
                  style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;&lt;span
                    lang="EN-US"&gt; &lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                &lt;p class="MsoNormal"
                  style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;&lt;span
                    lang="EN-US"&gt;libvirt version: 6.0.0, package:
                    0ubuntu8.14 (Matthew Ruffell &lt;a
                      href="mailto:matthew.ruffell@canonical.com"
                      target="_blank" moz-do-not-send="true"
                      class="moz-txt-link-freetext"&gt;matthew.ruffell@canonical.com&lt;/a&gt;
                    Tue, 14 Sep 2021 14:00:49 +1200)&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                &lt;p class="MsoNormal"
                  style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;&lt;span
                    lang="EN-US"&gt; &lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                &lt;p class="MsoNormal"
                  style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;&lt;span
                    lang="EN-US"&gt;I used apt package manager to install
                    libvirt. I am running on ubuntu 20.04.  I have tried
                    apt update libvirt and I get..no updates available. 
                    What do I do at this point?  Do I have to build it
                    from source?&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                &lt;p class="MsoNormal"
                  style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;&lt;span
                    lang="EN-US"&gt; &lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                &lt;p class="MsoNormal"
                  style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;&lt;span
                    lang="EN-US"&gt;Any help would be greatly \
appreciated.&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;  &lt;p class="MsoNormal"
                  style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;&lt;span
                    lang="EN-US"&gt; &lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                &lt;p class="MsoNormal"
                  style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;&lt;span
                    lang="EN-US"&gt;Brad&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
              &lt;/div&gt;
            &lt;/div&gt;
          &lt;/blockquote&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/blockquote&gt;
  &lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20211025170538</emailId><senderName>"Paul D. O'Rorke"</senderName><senderEmail>paul@tracker-software.com</senderEmail><timestampReceived>2021-10-25 17:05:38-0400</timestampReceived><subject>Re: apt libvirt package</subject><body>

Sorry - wrong list/question/everything...

* Paul O'Rorke*


On 2021-10-25 9:59 a.m., Paul D. O'Rorke wrote:
&gt; 
&gt; Hi Brad,
&gt; 
&gt; For Ubuntu add the Linbit PPA.  From this page: 
&gt; https://linbit.com/drbd-user-guide/drbd-guide-9_0-en/#s-from-source
&gt; 
&gt; 
&gt; 3.3.3. Ubuntu Linux
&gt; 
&gt; For Ubuntu LTS, LINBIT offers a PPA repository
&gt; athttps://launchpad.net/~linbit/+archive/ubuntu/linbit-drbd9-stack
&gt; &lt;https://launchpad.net/~linbit/+archive/ubuntu/linbit-drbd9-stack&gt;.
&gt; SeeAdding Launchpad PPA Repositories
&gt; &lt;https://help.ubuntu.com/community/Repositories/CommandLine#Adding_Launchpad_PPA_Repositories&gt;for
&gt;  more information
&gt; 
&gt; 20.04 LTS then has DRBD9 from apt.
&gt; 
&gt; * Paul O'Rorke*
&gt; 
&gt; On 2021-10-25 9:49 a.m., admin@foundryserver.com wrote:
&gt; 
&gt; &gt; I would prefer the ubuntu packages. I am most familiar with that 
&gt; &gt; distro.  I can make centos8 work if I have to but I prefer not.
&gt; &gt; 
&gt; &gt; Thanks
&gt; &gt; 
&gt; &gt; Brad
&gt; &gt; 
&gt; &gt; *From:*Peter Crowther &lt;peter.crowther@melandra.com&gt;
&gt; &gt; *Sent:* October 24, 2021 2:38 PM
&gt; &gt; *To:* admin@foundryserver.com
&gt; &gt; *Cc:* libvirt-ML &lt;libvirt-users@redhat.com&gt;
&gt; &gt; *Subject:* Re: apt libvirt package
&gt; &gt; 
&gt; &gt; Do you want this on CentOS 8, Ubuntu 20.04, or something else?  The 
&gt; &gt; help we can give you will vary quite considerably depending on the 
&gt; &gt; distro you use; and, as you point out, RedHat-derived and 
&gt; &gt; Debian-derived distributions are very different.
&gt; &gt; 
&gt; &gt; For CentOS, do you have the advanced virtualization repo enabled? 
&gt; &gt; https://centos.pkgs.org/8-stream/centos-extras-x86_64/centos-release-advanced-virtualization-1.0-3.el8.noarch.rpm.html
&gt; &gt;  
&gt; &gt; Cheers,
&gt; &gt; 
&gt; &gt; Peter
&gt; &gt; 
&gt; &gt; On Sun, 24 Oct 2021 at 20:31, &lt;admin@foundryserver.com&gt; wrote:
&gt; &gt; 
&gt; &gt; Hello again,
&gt; &gt; 
&gt; &gt; So I have been struggling to compile the libvirt newest version 
&gt; &gt; 7.8.0.  I am running CentOS 8 and during the meson build process
&gt; &gt; I am getting non stop dependency fails.  I keep installing the
&gt; &gt; necessary packages and slowly progressing.  Now the last one that
&gt; &gt; stopped was gnutls.  When I go to install that package   via  yum
&gt; &gt; install gnutls -y it says that it is already complete and
&gt; &gt; installed.   Sigh…….
&gt; &gt; 
&gt; &gt; I am very surprised that there is no package for libvirt via
&gt; &gt; rpm,yum etc… the lastest one installed via yum was 6.0.0.
&gt; &gt; 
&gt; &gt; Can someone help by pointing to some where that has these latest
&gt; &gt; packages?  Or how best to compile this from source.  It is
&gt; &gt; amazing how much is missing from this distro.
&gt; &gt; 
&gt; &gt; Thanks again.
&gt; &gt; 
&gt; &gt; Brad
&gt; &gt; 
&gt; &gt; *From:*admin@foundryserver.com &lt;admin@foundryserver.com&gt;
&gt; &gt; *Sent:* October 23, 2021 12:54 PM
&gt; &gt; *To:* 'libvirt-users@redhat.com' &lt;libvirt-users@redhat.com&gt;
&gt; &gt; *Subject:* apt libvirt package
&gt; &gt; 
&gt; &gt; Hello,
&gt; &gt; 
&gt; &gt; I am new to kvm/qemu/libvirt.  I am loving it.  I am working on
&gt; &gt; setting my first vm with shared file system with virtio-fs.  I
&gt; &gt; got an error, and google foo said, my version was too old.  When
&gt; &gt; I checked it said.
&gt; &gt; 
&gt; &gt; libvirt version: 6.0.0, package: 0ubuntu8.14 (Matthew Ruffell
&gt; &gt; matthew.ruffell@canonical.com Tue, 14 Sep 2021 14:00:49 +1200)
&gt; &gt; 
&gt; &gt; I used apt package manager to install libvirt. I am running on
&gt; &gt; ubuntu 20.04.  I have tried apt update libvirt and I get..no
&gt; &gt; updates available.  What do I do at this point?  Do I have to
&gt; &gt; build it from source?
&gt; &gt; 
&gt; &gt; Any help would be greatly appreciated.
&gt; &gt; 
&gt; &gt; Brad
&gt; &gt; 


[Attachment #3 (text/html)]

&lt;html&gt;
  &lt;head&gt;
    &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;p&gt;Sorry - wrong list/question/everything...&lt;/p&gt;
    &lt;div class="moz-signature"&gt;
      &lt;meta http-equiv="content-type" content="text/html; charset=UTF-8"&gt;
      &lt;title&gt;&lt;/title&gt;
      &lt;p&gt;&lt;b&gt; Paul O'Rorke&lt;/b&gt;&lt;/p&gt;
      &lt;p style="margin-bottom: 0cm; line-height: 100%"&gt;&lt;br&gt;
      &lt;/p&gt;
    &lt;/div&gt;
    &lt;div class="moz-cite-prefix"&gt;On 2021-10-25 9:59 a.m., Paul D.
      O'Rorke wrote:&lt;br&gt;
    &lt;/div&gt;
    &lt;blockquote type="cite"
      cite="mid:0c1fbeeb-1d83-ba59-378f-90eb059af76f@tracker-software.com"&gt;
      &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
      &lt;p&gt;Hi Brad,&lt;/p&gt;
      &lt;p&gt;For Ubuntu add the Linbit PPA.  From this page: &lt;a
          moz-do-not-send="true"
href="https://linbit.com/drbd-user-guide/drbd-guide-9_0-en/#s-from-source"
          class="moz-txt-link-freetext"&gt;https://linbit.com/drbd-user-guide/drbd-guide-9_0-en/#s-from-source&lt;/a&gt;&lt;/p&gt;
  &lt;blockquote&gt;
        &lt;h4 id="s-install-pkgs-ubuntu_linux" style="box-sizing:
          border-box; margin-top: -130px; margin-bottom: 1rem;
          font-family: Roboto, sans-serif; font-weight: 500;
          line-height: 1.2; color: rgb(0, 0, 0); font-size: 1.5rem;
          padding-top: 130px; font-style: normal;
          font-variant-ligatures: normal; font-variant-caps: normal;
          letter-spacing: normal; orphans: 2; text-align: start;
          text-indent: 0px; text-transform: none; white-space: normal;
          widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;
          background-color: rgb(255, 255, 255);
          text-decoration-thickness: initial; text-decoration-style:
          initial; text-decoration-color: initial;"&gt;3.3.3. Ubuntu Linux&lt;/h4&gt;
        &lt;div class="paragraph" style="box-sizing: border-box; color:
          rgb(0, 0, 0); font-family: Roboto, sans-serif; font-size:
          16px; font-style: normal; font-variant-ligatures: normal;
          font-variant-caps: normal; font-weight: 400; letter-spacing:
          normal; orphans: 2; text-align: start; text-indent: 0px;
          text-transform: none; white-space: normal; widows: 2;
          word-spacing: 0px; -webkit-text-stroke-width: 0px;
          background-color: rgb(255, 255, 255);
          text-decoration-thickness: initial; text-decoration-style:
          initial; text-decoration-color: initial;"&gt;
          &lt;p style="box-sizing: border-box; margin-top: 0px;
            margin-bottom: 0.9rem;"&gt;For Ubuntu LTS, LINBIT offers a PPA
            repository at&lt;span&gt; &lt;/span&gt;&lt;a
              href="https://launchpad.net/~linbit/+archive/ubuntu/linbit-drbd9-stack"
              class="bare moz-txt-link-freetext" style="box-sizing:
              border-box; background-color: transparent;
              text-decoration: none; color: rgb(247, 145, 51);
              box-shadow: none; word-break: break-word;"
              moz-do-not-send="true"&gt;https://launchpad.net/~linbit/+archive/ubuntu/linbit-drbd9-stack&lt;/a&gt;.
  See&lt;span&gt; &lt;/span&gt;&lt;a
href="https://help.ubuntu.com/community/Repositories/CommandLine#Adding_Launchpad_PPA_Repositories"
  style="box-sizing: border-box; background-color:
              transparent; text-decoration: none; color: rgb(247, 145,
              51); box-shadow: none;" moz-do-not-send="true"&gt;Adding
              Launchpad PPA Repositories&lt;/a&gt;&lt;span&gt; &lt;/span&gt;for more
            information&lt;/p&gt;
        &lt;/div&gt;
      &lt;/blockquote&gt;
      &lt;p&gt;20.04 LTS then has DRBD9 from apt.&lt;br&gt;
      &lt;/p&gt;
      &lt;div class="moz-signature"&gt;
        &lt;meta http-equiv="content-type" content="text/html;
          charset=UTF-8"&gt;
        &lt;title&gt;&lt;/title&gt;
        &lt;p&gt;&lt;b&gt; Paul O'Rorke&lt;/b&gt;&lt;/p&gt;
        &lt;p&gt;On 2021-10-25 9:49 a.m., &lt;a class="moz-txt-link-abbreviated
            moz-txt-link-freetext" href="mailto:admin@foundryserver.com"
            moz-do-not-send="true"&gt;admin@foundryserver.com&lt;/a&gt; wrote:&lt;br&gt;
        &lt;/p&gt;
      &lt;/div&gt;
      &lt;blockquote type="cite"
        cite="mid:01bc01d7c9c0$46e3b170$d4ab1450$@foundryserver.com"&gt;
        &lt;meta http-equiv="Content-Type" content="text/html;
          charset=UTF-8"&gt;
        &lt;meta name="Generator" content="Microsoft Word 15 (filtered
          medium)"&gt;
        &lt;style&gt;@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}span.EmailStyle18
	{mso-style-type:personal-reply;
	font-family:"Calibri",sans-serif;
	color:windowtext;}.MsoChpDefault
	{mso-style-type:export-only;
	font-family:"Calibri",sans-serif;
	mso-fareast-language:EN-US;}div.WordSection1
	{page:WordSection1;}&lt;/style&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapelayout v:ext="edit"&gt;
&lt;o:idmap v:ext="edit" data="1" /&gt;
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
        &lt;div class="WordSection1"&gt;
          &lt;p class="MsoNormal"&gt;&lt;span style="mso-fareast-language:EN-US"&gt;I
              would prefer the ubuntu packages. I am most familiar with
              that distro.  I can make centos8 work if I have to but I
              prefer not.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
          &lt;p class="MsoNormal"&gt;&lt;span style="mso-fareast-language:EN-US"&gt;&lt;o:p&gt; \
                &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
          &lt;p class="MsoNormal"&gt;&lt;span \
                style="mso-fareast-language:EN-US"&gt;Thanks&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
          &lt;p class="MsoNormal"&gt;&lt;span \
                style="mso-fareast-language:EN-US"&gt;Brad&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
          &lt;p class="MsoNormal"&gt;&lt;span style="mso-fareast-language:EN-US"&gt;&lt;o:p&gt; \
&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;  &lt;div style="border:none;border-top:solid #E1E1E1
            1.0pt;padding:3.0pt 0cm 0cm 0cm"&gt;
            &lt;p class="MsoNormal"&gt;&lt;b&gt;&lt;span lang="EN-US"&gt;From:&lt;/span&gt;&lt;/b&gt;&lt;span
                lang="EN-US"&gt; Peter Crowther &lt;a
                  class="moz-txt-link-rfc2396E"
                  href="mailto:peter.crowther@melandra.com"
                  moz-do-not-send="true"&gt;&lt;peter.crowther@melandra.com&gt;&lt;/a&gt;
                &lt;br&gt;
                &lt;b&gt;Sent:&lt;/b&gt; October 24, 2021 2:38 PM&lt;br&gt;
                &lt;b&gt;To:&lt;/b&gt; &lt;a class="moz-txt-link-abbreviated
                  moz-txt-link-freetext"
                  href="mailto:admin@foundryserver.com"
                  moz-do-not-send="true"&gt;admin@foundryserver.com&lt;/a&gt;&lt;br&gt;
                &lt;b&gt;Cc:&lt;/b&gt; libvirt-ML &lt;a class="moz-txt-link-rfc2396E"
                  href="mailto:libvirt-users@redhat.com"
                  moz-do-not-send="true"&gt;&lt;libvirt-users@redhat.com&gt;&lt;/a&gt;&lt;br&gt;
                &lt;b&gt;Subject:&lt;/b&gt; Re: apt libvirt package&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
          &lt;/div&gt;
          &lt;p class="MsoNormal"&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;
          &lt;div&gt;
            &lt;div&gt;
              &lt;p class="MsoNormal"&gt;Do you want this on CentOS 8, Ubuntu
                20.04, or something else?  The help we can give you will
                vary quite considerably depending on the distro you use;
                and, as you point out, RedHat-derived and Debian-derived
                distributions are very different.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
            &lt;/div&gt;
            &lt;div&gt;
              &lt;p class="MsoNormal"&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;
            &lt;/div&gt;
            &lt;div&gt;
              &lt;p class="MsoNormal"&gt;For CentOS, do you have the advanced
                virtualization repo enabled?  &lt;a
href="https://centos.pkgs.org/8-stream/centos-extras-x86_64/centos-release-advanced-virtualization-1.0-3.el8.noarch.rpm.html"
  moz-do-not-send="true" \
class="moz-txt-link-freetext"&gt;https://centos.pkgs.org/8-stream/centos-extras-x86_64/ce \
ntos-release-advanced-virtualization-1.0-3.el8.noarch.rpm.html&lt;/a&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;  \
&lt;/div&gt;  &lt;div&gt;
              &lt;p class="MsoNormal"&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;
            &lt;/div&gt;
            &lt;div&gt;
              &lt;p class="MsoNormal"&gt;Cheers,&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
            &lt;/div&gt;
            &lt;div&gt;
              &lt;p class="MsoNormal"&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;
            &lt;/div&gt;
            &lt;div&gt;
              &lt;p class="MsoNormal"&gt;Peter&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
            &lt;/div&gt;
          &lt;/div&gt;
          &lt;p class="MsoNormal"&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;
          &lt;div&gt;
            &lt;div&gt;
              &lt;p class="MsoNormal"&gt;On Sun, 24 Oct 2021 at 20:31, &lt;&lt;a
                  href="mailto:admin@foundryserver.com"
                  moz-do-not-send="true" \
class="moz-txt-link-freetext"&gt;admin@foundryserver.com&lt;/a&gt;&gt;  wrote:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
            &lt;/div&gt;
            &lt;blockquote style="border:none;border-left:solid #CCCCCC
              1.0pt;padding:0cm 0cm 0cm
              6.0pt;margin-left:4.8pt;margin-right:0cm"&gt;
              &lt;div&gt;
                &lt;div&gt;
                  &lt;p class="MsoNormal"
                    style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;Hello
                    again,&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                  &lt;p class="MsoNormal"
                    style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt; \
&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;  &lt;p class="MsoNormal"
                    style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;So
                    I have been struggling to compile the libvirt newest
                    version  7.8.0.  I am running CentOS 8 and during
                    the meson build process I am getting non stop
                    dependency fails.  I keep installing the necessary
                    packages and slowly progressing.  Now the last one
                    that stopped was gnutls.  When I go to install that
                    package   via  yum install gnutls -y it says that it
                    is already complete and installed.   Sigh…….&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                  &lt;p class="MsoNormal"
                    style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt; \
&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;  &lt;p class="MsoNormal"
                    style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;I
                    am very surprised that there is no package for
                    libvirt via rpm,yum etc… the lastest one installed
                    via yum was 6.0.0.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                  &lt;p class="MsoNormal"
                    style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt; \
&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;  &lt;p class="MsoNormal"
                    style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;Can
                    someone help by pointing to some where that has
                    these latest packages?  Or how best to compile this
                    from source.  It is amazing how much is missing from
                    this distro.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                  &lt;p class="MsoNormal"
                    style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt; \
&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;  &lt;p class="MsoNormal"
                    style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;Thanks
                    again.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                  &lt;p class="MsoNormal"
                    style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;Brad&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
  &lt;p class="MsoNormal"
                    style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt; \
&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;  &lt;div&gt;
                    &lt;div style="border:none;border-top:solid windowtext
                      1.0pt;padding:3.0pt 0cm 0cm
                      0cm;border-color:currentcolor currentcolor"&gt;
                      &lt;p class="MsoNormal"
                        \
style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;&lt;b&gt;&lt;span  \
lang="EN-US"&gt;From:&lt;/span&gt;&lt;/b&gt;&lt;span  lang="EN-US"&gt; &lt;a
                            href="mailto:admin@foundryserver.com"
                            target="_blank" moz-do-not-send="true"
                            class="moz-txt-link-freetext"&gt;admin@foundryserver.com&lt;/a&gt;
                          &lt;&lt;a href="mailto:admin@foundryserver.com"
                            target="_blank" moz-do-not-send="true"
                            \
class="moz-txt-link-freetext"&gt;admin@foundryserver.com&lt;/a&gt;&gt;  &lt;br&gt;
                          &lt;b&gt;Sent:&lt;/b&gt; October 23, 2021 12:54 PM&lt;br&gt;
                          &lt;b&gt;To:&lt;/b&gt; '&lt;a
                            href="mailto:libvirt-users@redhat.com"
                            target="_blank" moz-do-not-send="true"
                            \
class="moz-txt-link-freetext"&gt;libvirt-users@redhat.com&lt;/a&gt;'  &lt;&lt;a \
href="mailto:libvirt-users@redhat.com"  target="_blank" moz-do-not-send="true"
                            \
                class="moz-txt-link-freetext"&gt;libvirt-users@redhat.com&lt;/a&gt;&gt;&lt;br&gt;
                          &lt;b&gt;Subject:&lt;/b&gt; apt libvirt package&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                    &lt;/div&gt;
                  &lt;/div&gt;
                  &lt;p class="MsoNormal"
                    style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt; \
&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;  &lt;p class="MsoNormal"
                    style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;&lt;span
                      lang="EN-US"&gt;Hello, &lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                  &lt;p class="MsoNormal"
                    style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;&lt;span
                      lang="EN-US"&gt; &lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                  &lt;p class="MsoNormal"
                    style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;&lt;span
                      lang="EN-US"&gt;I am new to kvm/qemu/libvirt.  I am
                      loving it.  I am working on setting my first vm
                      with shared file system with virtio-fs.  I got an
                      error, and google foo said, my version was too
                      old.  When I checked it said.&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                  &lt;p class="MsoNormal"
                    style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;&lt;span
                      lang="EN-US"&gt; &lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                  &lt;p class="MsoNormal"
                    style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;&lt;span
                      lang="EN-US"&gt;libvirt version: 6.0.0, package:
                      0ubuntu8.14 (Matthew Ruffell &lt;a
                        href="mailto:matthew.ruffell@canonical.com"
                        target="_blank" moz-do-not-send="true"
                        \
                class="moz-txt-link-freetext"&gt;matthew.ruffell@canonical.com&lt;/a&gt;
                      Tue, 14 Sep 2021 14:00:49 +1200)&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                  &lt;p class="MsoNormal"
                    style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;&lt;span
                      lang="EN-US"&gt; &lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                  &lt;p class="MsoNormal"
                    style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;&lt;span
                      lang="EN-US"&gt;I used apt package manager to install
                      libvirt. I am running on ubuntu 20.04.  I have
                      tried apt update libvirt and I get..no updates
                      available.  What do I do at this point?  Do I have
                      to build it from source?&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                  &lt;p class="MsoNormal"
                    style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;&lt;span
                      lang="EN-US"&gt; &lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                  &lt;p class="MsoNormal"
                    style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;&lt;span
                      lang="EN-US"&gt;Any help would be greatly
                      appreciated.&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                  &lt;p class="MsoNormal"
                    style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;&lt;span
                      lang="EN-US"&gt; &lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                  &lt;p class="MsoNormal"
                    style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"&gt;&lt;span
                      lang="EN-US"&gt;Brad&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;
                &lt;/div&gt;
              &lt;/div&gt;
            &lt;/blockquote&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/blockquote&gt;
    &lt;/blockquote&gt;
  &lt;/body&gt;
&lt;/html&gt;



</body></email></emails>