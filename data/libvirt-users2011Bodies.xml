<?xml version="1.0" encoding="utf-8"?>
<emails><email><emailId>20110103173935</emailId><senderName>Marcin Krol</senderName><senderEmail>mrkafk@gmail.com</senderEmail><timestampReceived>2011-01-03 17:39:35-0400</timestampReceived><subject>[libvirt-users] availability of snapshots functionality via Python bindings</subject><body>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hello everyone,

Is this being worked on? I rather need this thing...

Although my system is Debian Lenny, not RH:


kulfon 10.0.0.228 /etc/default % dpkg -l | grep libvirt
ii  libvirt-bin                          0.4.6-10+lenny1            the
programs for the libvirt library
ii  libvirt0                             0.4.6-10+lenny1
library for interfacing with different virtualization systems
ii  python-libvirt                       0.4.6-10+lenny1
libvirt Python bindings


I don't see anything like snapshots available via libvirt.virDomain:

&gt;&gt;&gt; dir(dom0)
['ID', 'OSType', 'UUID', 'UUIDString', 'XMLDesc', '__del__', '__doc__',
'__init__', '__module__', '_conn', '_o', 'attachDevice', 'autostart',
'blockPeek', 'blockStats', 'connect', 'coreDump', 'create', 'destroy',
'detachDevice', 'info', 'interfaceStats', 'maxMemory', 'maxVcpus',
'memoryPeek', 'migrate', 'name', 'pinVcpu', 'reboot', 'resume', 'save',
'schedulerParameters', 'schedulerType', 'setAutostart', 'setMaxMemory',
'setMemory', 'setSchedulerParameters', 'setVcpus', 'shutdown',
'suspend', 'undefine', 'vcpus']


- --

Regards,
mk

- --
Premature optimization is the root of all fun.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iQEcBAEBAgAGBQJNIgnXAAoJEFMgHzhQQ7hO86AIAIxQkWyYJ3vAsP579Geb0hhj
XbkU2BSlxAkxToBoPoOYnS+W5ZlSf0/kqwJh2yQDCCCfwUXJ7k+QLQfTlJB+qOAZ
xB/gA7c9wQLiHERWSYk81DoQWeatgHt/7G2cSP2G5O7I1l0C61mLEZQAQ8SqQ9Ay
hVi7DhVX0qCNJTLAoN/C0ZLOAzRAnrKj2LOpqjBqU7CzD2Zx60FoUElRebSuiv8x
aPPNgk5c7XQsEx+aXteobWwHdrlSeWXg4yomXrGQZ5CcJSTzQst0juhesK0CvdFM
6cLhBoAqI0C94CFNm1f2XP2ytnrCIQc3SXBNgHhy4SosqGE9+XMBLwq70OIYGCI=
=Q9VB
-----END PGP SIGNATURE-----

</body></email><email><emailId>20110201173902</emailId><senderName>Orion Poplawski</senderName><senderEmail>orion@cora.nwra.com</senderEmail><timestampReceived>2011-02-01 17:39:02-0400</timestampReceived><subject>[libvirt-users] network-performance</subject><body>

I'm just starting to take a look at guest networking performance and am a 
little disappointed.  I'm comparing two setups:

Host: Windows Server 2008 R2 Hyper-V
Guest: CentOS 5.5 x86_64

Host: CentOS 5.5 x86_64 kvm running libvirt
Guest: CentOS 5.5 x86_64

The guests are essentially identical except that I'm running the Microsoft 
Linux Integration Components synthetic drivers on the windows hosted VM.  The 
libvirt setup uses bridged networking.  Running bonnie++ on a nfs mounted 
filesystem on each guest I'm seeing the libvirt hosted guest get between 
16%-35% of the performance of the Hyper-V guest.  Is this expected?  Is there 
anything I can do to increase network performance of the kvm guest?

-- 
Orion Poplawski
Technical Manager                     303-415-9701 x222
NWRA/CoRA Division                    FAX: 303-415-9702
3380 Mitchell Lane                  orion@cora.nwra.com
Boulder, CO 80301              http://www.cora.nwra.com

</body></email><email><emailId>20110303161529</emailId><senderName>Hereward Cooper</senderName><senderEmail>hereward.cooper@iomart.com</senderEmail><timestampReceived>2011-03-03 16:15:29-0400</timestampReceived><subject>[libvirt-users] libvirt + ESX (HTTP response code 400 for call to 'Login')</subject><body>

Hi folks,

I'm trying to connect to a vSphere cluster using the information from
the libvirt documentation.


-------------------
$ virsh -c
"vpx://root@10.51.4.11/dc1/dc1-cluster-e01/dc1-vsphere-e04/?no_verify=1"

Enter root's password for 10.51.4.11:
error: internal error HTTP response code 400 for call to 'Login'
error: failed to connect to the hypervisor
-------------------

I seem to be able to establish a connection, but it fails with a "HTTP
code 400". If I provide the incorrect password it fails with a 'login
credentials' error, so it looks like I am getting a connection, but it's
failing for another reason.

Wireshark is no help as it's all done over SSL/TLS.

Any thoughts folks?

I've tried various versions of libvirt up to the newest.

When I put virsh into debug mode it returns this:

-------------------
[snip]
Enter root's password for 10.51.4.11:
15:19:09.011: debug : do_open:1249 : driver 3 ESX returned ERROR
15:19:09.011: debug : virUnrefConnect:294 : unref connection 0x98aa8f8 1
15:19:09.011: debug : virReleaseConnect:249 : release connection 0x98aa8f8
error: internal error HTTP response code 400 for call to 'Login'
error: failed to connect to the hypervisor
I've watched the vmware hostd.log file whilst trying to login, and it
reports this error:
-------------------

And the VMware hostd.log file reports this:

-------------------
[2011-03-02 10:24:16.415 26AF8B90 verbose 'Proxysvc Req16870'] New proxy
client SSL(TCP(local=10.4.100.26:34001, peer=10.51.4.103:443))
[2011-03-02 10:24:16.430 26933B90 error 'SoapAdapter'] Client sent us an
invalid SOAP request: at line number 8, not well-formed (invalid token)
-------------------

Any thoughts appreciated.

Cheers.

Coops.

</body></email><email><emailId>20110303215258</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-03-03 21:52:58-0400</timestampReceived><subject>Re: [libvirt-users] libvirt + ESX (HTTP response code 400 for call to 'Login')</subject><body>

2011/3/3 Hereward Cooper &lt;hereward.cooper@iomart.com&gt;:
&gt; Hi folks,
&gt;
&gt; I'm trying to connect to a vSphere cluster using the information from
&gt; the libvirt documentation.
&gt;
&gt;
&gt; -------------------
&gt; $ virsh -c
&gt; "vpx://root@10.51.4.11/dc1/dc1-cluster-e01/dc1-vsphere-e04/?no_verify=1"
&gt;
&gt; Enter root's password for 10.51.4.11:
&gt; error: internal error HTTP response code 400 for call to 'Login'
&gt; error: failed to connect to the hypervisor
&gt; -------------------
&gt;
&gt; I seem to be able to establish a connection, but it fails with a "HTTP
&gt; code 400". If I provide the incorrect password it fails with a 'login
&gt; credentials' error, so it looks like I am getting a connection, but it's
&gt; failing for another reason.

400 means bad request. You probably have a character in you password
that needs to be escaped in XML: &lt;, &gt;, &amp;, ', "

libvirt currently doesn't escape the password properly when building
the SOAP request. You can manually workaround this by entering the
password in escaped form. For example when your password is some&amp;word
enter some&amp;word instead.

I posted a patch to fix this:

https://www.redhat.com/archives/libvir-list/2011-March/msg00118.html

&gt; Wireshark is no help as it's all done over SSL/TLS.

By default libvirt uses HTTPS to talk to vSphere server. You can
disable TLS by using the transport=http query parameter like this

virsh -c "vpx://root@10.51.4.11/dc1/dc1-cluster-e01/dc1-vsphere-e04/?no_verify=1&amp;transport=http"

But you'll have to configure the vCenter server to accept HTTP
connections if you want use this.

Matthias

</body></email><email><emailId>20110401093420</emailId><senderName>Marcela_Castro_León</senderName><senderEmail>mcastrol@gmail.com</senderEmail><timestampReceived>2011-04-01 09:34:20-0400</timestampReceived><subject>[libvirt-users] LIBVIRT migration</subject><body>

Hello
I''m developing a system using libvirt and I need to use "migrate" to move
guest to different hosts.
I'm testing using a cluster connected by ssh, and I'm connect ok trought
them, using virsh and virt-manager.

But if I try to migrate doing:

*virsh # migrate --live scompi1 qemu+ssh://rionegro/system*

I got:
*error: monitor socket did not show up.: Connection refused*

I've try using the virt-manager, but troughs:

*Unable to migrate guest:
 Traceback (most recent call last):
  File "/usr/share/virt-manager/**virtManager/migrate.py", line 453, in
_async_migrate
    vm.migrate(dstconn, migrate_uri, rate, live, secure)
  File "/usr/share/virt-manager/**virtManager/domain.py", line 230, in
migrate
    self._backend.migrate(**destconn.vmm, flags, newname, interface, rate)
  File "/usr/lib/python2.6/dist-**packages/libvirt.py", line 429, in migrate
     if ret is None:raise libvirtError('**virDomainMigrate() failed',
dom=self)
libvirtError: monitor socket did not show up.: Connection refused*

Someone can help me? Thank you very much.
Marcela.

[Attachment #3 (text/html)]

&lt;div class="gmail_quote"&gt;Hello&lt;br&gt;I''m developing a system using libvirt and \
I need to use "migrate" to move guest to different hosts.&lt;br&gt;I'm \
testing using a cluster connected by ssh, and I'm connect ok trought them, using \
virsh and virt-manager.&lt;br&gt;

&lt;br&gt;But if I try to migrate doing:&lt;br&gt;&lt;br&gt;&lt;div style="margin-left: 40px;"&gt;&lt;b&gt;&lt;i&gt;virsh \
# migrate --live scompi1 qemu+ssh://rionegro/system&lt;/i&gt;&lt;/b&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;I \
got:&lt;br&gt;&lt;div style="margin-left: 40px;"&gt;&lt;b&gt;error: monitor socket did not show up.: \
Connection refused&lt;/b&gt;&lt;br&gt;

&lt;/div&gt;&lt;br&gt;I've try using the virt-manager, but troughs:&lt;br&gt;&lt;br&gt;&lt;div \
style="margin-left: 40px;"&gt;&lt;i&gt;&lt;b&gt;Unable to migrate guest:&lt;/b&gt;&lt;br&gt;&lt;b&gt; Traceback (most \
recent call last):&lt;/b&gt;&lt;br&gt;&lt;b&gt;  File \
"/usr/share/virt-manager/&lt;/b&gt;&lt;/i&gt;&lt;i&gt;&lt;b&gt;virtManager/migrate.py", line 453, \
in _async_migrate&lt;/b&gt;&lt;br&gt;

&lt;b&gt;    vm.migrate(dstconn, migrate_uri, rate, live, secure)&lt;/b&gt;&lt;br&gt;&lt;b&gt;
  File "/usr/share/virt-manager/&lt;/b&gt;&lt;/i&gt;&lt;i&gt;&lt;b&gt;virtManager/domain.py", line \
230, in migrate&lt;/b&gt;&lt;br&gt;&lt;b&gt;    self._backend.migrate(&lt;/b&gt;&lt;/i&gt;&lt;i&gt;&lt;b&gt;destconn.vmm, \
flags, newname, interface, rate)&lt;/b&gt;&lt;br&gt;&lt;b&gt;  File \
"/usr/lib/python2.6/dist-&lt;/b&gt;&lt;/i&gt;&lt;i&gt;&lt;b&gt;packages/libvirt.py", line 429, in \
migrate&lt;/b&gt;&lt;br&gt;

&lt;b&gt;
    if ret is None:raise libvirtError('&lt;/b&gt;&lt;/i&gt;&lt;i&gt;&lt;b&gt;virDomainMigrate() \
failed', dom=self)&lt;/b&gt;&lt;br&gt;&lt;b&gt;libvirtError: monitor socket did not show up.: \
Connection refused&lt;/b&gt;&lt;/i&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;Someone can help me? Thank you very much.&lt;br&gt; \
&lt;font color="#888888"&gt; Marcela.&lt;br&gt;
&lt;br&gt;&lt;br&gt;
&lt;/font&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110401122836</emailId><senderName></senderName><senderEmail>jurgen.depicker</senderEmail><timestampReceived>2011-04-01 12:28:36-0400</timestampReceived><subject>Re: [libvirt-users] LIBVIRT migration</subject><body>

This is a multipart message in MIME format.
--=_alternative 00448995C1257865_Content-Type: text/plain; charset="ISO-8859-1"
Content-Transfer-Encoding: quoted-printable

&gt; From: Marcela Castro León &lt;mcastrol@gmail.com&gt;
&gt; To: libvirt-users@redhat.com
&gt; Date: 01/04/2011 13:11
&gt; Subject: [libvirt-users] LIBVIRT migration
&gt; Sent by: libvirt-users-bounces@redhat.com
&gt; 
&gt; Hello
&gt; I''m developing a system using libvirt and I need to use "migrate" 
&gt; to move guest to different hosts.
&gt; I'm testing using a cluster connected by ssh, and I'm connect ok 
&gt; trought them, using virsh and virt-manager.
&gt; 
&gt; But if I try to migrate doing:

&gt; virsh # migrate --live scompi1 qemu+ssh://rionegro/system
&gt; 
&gt; I got:
&gt; error: monitor socket did not show up.: Connection refused

Please check that you used ssh-copy-id to copy your ssh key (the user you 
are logged in with when entering virsh) to the destination host's root 
account.

Jürgen

&gt; 
&gt; I've try using the virt-manager, but troughs:

&gt; Unable to migrate guest:
&gt; Traceback (most recent call last):
&gt; File "/usr/share/virt-manager/virtManager/migrate.py", line 453, 
&gt; in _async_migrate
&gt; vm.migrate(dstconn, migrate_uri, rate, live, secure)
&gt; File "/usr/share/virt-manager/virtManager/domain.py", line 230, in 
migrate
&gt; self._backend.migrate(destconn.vmm, flags, newname, interface, rate)
&gt; File "/usr/lib/python2.6/dist-packages/libvirt.py", line 429, in 
migrate
&gt; if ret is None:raise libvirtError('virDomainMigrate() failed', 
dom=self)
&gt; libvirtError: monitor socket did not show up.: Connection refused
&gt; 
&gt; Someone can help me? Thank you very much.
&gt; Marcela.
&gt; 

&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
--=_alternative 00448995C1257865_Content-Type: text/html; charset="ISO-8859-1"
Content-Transfer-Encoding: quoted-printable

&lt;tt&gt;&lt;font size=2&gt;&lt;br&gt;
&gt; From: Marcela Castro León &lt;mcastrol@gmail.com&gt;&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size=2&gt;&gt; To: libvirt-users@redhat.com&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size=2&gt;&gt; Date: 01/04/2011 13:11&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size=2&gt;&gt; Subject: [libvirt-users] LIBVIRT migration&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size=2&gt;&gt; Sent by: libvirt-users-bounces@redhat.com&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size=2&gt;&gt; &lt;br&gt;
&gt; Hello&lt;br&gt;
&gt; I''m developing a system using libvirt and I need to use "migrate"
&lt;br&gt;
&gt; to move guest to different hosts.&lt;br&gt;
&gt; I'm testing using a cluster connected by ssh, and I'm connect ok &lt;br&gt;
&gt; trought them, using virsh and virt-manager.&lt;br&gt;
&gt; &lt;br&gt;
&gt; But if I try to migrate doing:&lt;br&gt;
&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size=2&gt;&gt; virsh # migrate --live scompi1 \
qemu+ssh://rionegro/system&lt;/font&gt;&lt;/tt&gt; &lt;br&gt;&lt;tt&gt;&lt;font size=2&gt;&gt; &lt;br&gt;
&gt; I got:&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size=2&gt;&gt; error: monitor socket did not show up.: Connection
refused&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size=2&gt;Please check that you used ssh-copy-id to copy your
ssh key (the user you are logged in with when entering virsh) to the destination
host's root account.&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size=2&gt;Jürgen&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size=2&gt;&gt; &lt;br&gt;
&gt; I've try using the virt-manager, but troughs:&lt;br&gt;
&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size=2&gt;&gt; Unable to migrate guest:&lt;br&gt;
&gt;  Traceback (most recent call last):&lt;br&gt;
&gt;   File "/usr/share/virt-manager/virtManager/migrate.py",
line 453, &lt;br&gt;
&gt; in _async_migrate&lt;br&gt;
&gt;     vm.migrate(dstconn, migrate_uri, rate, live, secure)&lt;br&gt;
&gt;   File "/usr/share/virt-manager/virtManager/domain.py",
line 230, in migrate&lt;br&gt;
&gt;     self._backend.migrate(destconn.vmm, flags, newname,
interface, rate)&lt;br&gt;
&gt;   File "/usr/lib/python2.6/dist-packages/libvirt.py",
line 429, in migrate&lt;br&gt;
&gt;     if ret is None:raise libvirtError('virDomainMigrate()
failed', dom=self)&lt;br&gt;
&gt; libvirtError: monitor socket did not show up.: Connection refused&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size=2&gt;&gt; &lt;br&gt;
&gt; Someone can help me? Thank you very much.&lt;br&gt;
&gt; Marcela.&lt;br&gt;
&gt; &lt;br&gt;
&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size=2&gt;&gt; _______________________________________________&lt;br&gt;
&gt; libvirt-users mailing list&lt;br&gt;
&gt; libvirt-users@redhat.com&lt;br&gt;
&gt; &lt;/font&gt;&lt;/tt&gt;&lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users"&gt;&lt;tt&gt;&lt;font \
                size=2&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/font&gt;&lt;/tt&gt;&lt;/a&gt;
                
--=_alternative 00448995C1257865_=--


</body></email><email><emailId>20110401141523</emailId><senderName>Marcela_Castro_León</senderName><senderEmail>mcastrol@gmail.com</senderEmail><timestampReceived>2011-04-01 14:15:23-0400</timestampReceived><subject>Re: [libvirt-users] LIBVIRT migration</subject><body>

[Attachment #2 (multipart/alternative)]


Hello
I've put the root-key on the authorized_key file of all the host, and reboot
the cluster, but I've got the same error with the two opcion (virt-manager
and virsh).
I think that is sth related to the authorization on the libvirtd.conf.
This is my conf at all the hosts (see libvirtd.conf attached too)., I'd
appreciate a lot if someone can tell me if it right (it's a developer
cluster):

*unix_sock_group = "libvirtd"*
*unix_sock_ro_perms = "0777"*
*unix_sock_rw_perms = "0777"*
The user radic that execute is member of libvirtd group.
Thank you.
Marcela.


errors:
Virt Manager:
When I try to migrate using virt-manager I still get
*Unable to migrate guest:
 Traceback (most recent call last):
  File "/usr/share/virt-manager/virtManager/migrate.py", line 453, in
_async_migrate
    vm.migrate(dstconn, migrate_uri, rate, live, secure)
  File "/usr/share/virt-manager/virtManager/domain.py", line 230, in migrate
    self._backend.migrate(destconn.vmm, flags, newname, interface, rate)
  File "/usr/lib/python2.6/dist-packages/libvirt.py", line 429, in migrate
    if ret is None:raise libvirtError('virDomainMigrate() failed', dom=self)
libvirtError: monitor socket did not show up.: Connection refused*

VIRSH
*virsh # migrate --live scompi1 qemu+ssh://rionegro/system*
*error: monitor socket did not show up.: Connection refused*


2011/4/1 &lt;jurgen.depicker@let.be&gt;

&gt;
&gt; &gt; From: Marcela Castro León &lt;mcastrol@gmail.com&gt;
&gt; &gt; To: libvirt-users@redhat.com
&gt; &gt; Date: 01/04/2011 13:11
&gt; &gt; Subject: [libvirt-users] LIBVIRT migration
&gt; &gt; Sent by: libvirt-users-bounces@redhat.com
&gt; &gt;
&gt; &gt; Hello
&gt; &gt; I''m developing a system using libvirt and I need to use "migrate"
&gt; &gt; to move guest to different hosts.
&gt; &gt; I'm testing using a cluster connected by ssh, and I'm connect ok
&gt; &gt; trought them, using virsh and virt-manager.
&gt; &gt;
&gt; &gt; But if I try to migrate doing:
&gt;
&gt; &gt; virsh # migrate --live scompi1 qemu+ssh://rionegro/system
&gt; &gt;
&gt; &gt; I got:
&gt; &gt; error: monitor socket did not show up.: Connection refused
&gt;
&gt; Please check that you used ssh-copy-id to copy your ssh key (the user you
&gt; are logged in with when entering virsh) to the destination host's root
&gt; account.
&gt;
&gt; Jürgen
&gt;
&gt; &gt;
&gt; &gt; I've try using the virt-manager, but troughs:
&gt;
&gt; &gt; Unable to migrate guest:
&gt; &gt;  Traceback (most recent call last):
&gt; &gt;   File "/usr/share/virt-manager/virtManager/migrate.py", line 453,
&gt; &gt; in _async_migrate
&gt; &gt;     vm.migrate(dstconn, migrate_uri, rate, live, secure)
&gt; &gt;   File "/usr/share/virt-manager/virtManager/domain.py", line 230, in
&gt; migrate
&gt; &gt;     self._backend.migrate(destconn.vmm, flags, newname, interface, rate)
&gt; &gt;   File "/usr/lib/python2.6/dist-packages/libvirt.py", line 429, in
&gt; migrate
&gt; &gt;     if ret is None:raise libvirtError('virDomainMigrate() failed',
&gt; dom=self)
&gt; &gt; libvirtError: monitor socket did not show up.: Connection refused
&gt; &gt;
&gt; &gt; Someone can help me? Thank you very much.
&gt; &gt; Marcela.
&gt; &gt;
&gt;
&gt; &gt; _______________________________________________
&gt; &gt; libvirt-users mailing list
&gt; &gt; libvirt-users@redhat.com
&gt; &gt; https://www.redhat.com/mailman/listinfo/libvirt-users

[Attachment #5 (text/html)]

&lt;font size="4"&gt;Hello&lt;br&gt;I've put the root-key on the authorized_key file of all \
the host, and reboot the cluster, but I've got the same error with the two opcion \
(virt-manager and virsh).&lt;br&gt;I think that is sth related to the authorization on the \
libvirtd.conf.&lt;br&gt; This is my conf at all the hosts (see libvirtd.conf attached \
too)., I'd appreciate a lot if someone can tell me if it right (it's a \
developer cluster):&lt;br&gt;&lt;br&gt;&lt;/font&gt;&lt;div style="margin-left: 40px;"&gt;&lt;font \
size="4"&gt;&lt;i&gt;&lt;b&gt;unix_sock_group = "libvirtd"&lt;/b&gt;&lt;/i&gt;&lt;/font&gt;&lt;br&gt; &lt;font \
size="4"&gt;&lt;i&gt;&lt;b&gt;unix_sock_ro_perms = "0777"&lt;/b&gt;&lt;/i&gt;&lt;/font&gt;&lt;br&gt;&lt;font \
size="4"&gt;&lt;i&gt;&lt;b&gt;unix_sock_rw_perms = "0777"&lt;/b&gt;&lt;/i&gt;&lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;font \
size="4"&gt;The user radic that execute is member of libvirtd group.&lt;br&gt; Thank \
you.&lt;br&gt;Marcela.&lt;br&gt;&lt;br&gt; &lt;br&gt;errors:&lt;br&gt;Virt Manager:&lt;br&gt;When I try to migrate using \
virt-manager I still get&lt;br&gt;&lt;/font&gt;&lt;div style="margin-left: 40px;"&gt;&lt;b&gt;&lt;i&gt;&lt;font \
size="4"&gt;Unable to migrate guest:&lt;/font&gt;&lt;br&gt;&lt;font size="4"&gt; Traceback (most recent \
call last):&lt;/font&gt;&lt;br&gt; &lt;font size="4"&gt;  File \
"/usr/share/virt-manager/virtManager/migrate.py", line 453, in \
_async_migrate&lt;/font&gt;&lt;br&gt; &lt;font size="4"&gt;    vm.migrate(dstconn, migrate_uri, rate, \
live, secure)&lt;/font&gt;&lt;br&gt;&lt;font size="4"&gt;  File \
"/usr/share/virt-manager/virtManager/domain.py", line 230, in \
migrate&lt;/font&gt;&lt;br&gt;&lt;font size="4"&gt;    self._backend.migrate(destconn.vmm, flags, \
newname, interface, rate)&lt;/font&gt;&lt;br&gt;

&lt;font size="4"&gt;  File "/usr/lib/python2.6/dist-packages/libvirt.py", line \
429, in migrate&lt;/font&gt;&lt;br&gt;&lt;font size="4"&gt;    if ret is None:raise \
libvirtError('virDomainMigrate() failed', dom=self)&lt;/font&gt;&lt;br&gt; &lt;font \
size="4"&gt;libvirtError: monitor socket did not show up.: Connection \
refused&lt;/font&gt;&lt;/i&gt;&lt;/b&gt;&lt;br&gt; &lt;/div&gt;&lt;font size="4"&gt;&lt;br&gt;VIRSH&lt;br&gt;&lt;/font&gt;&lt;div \
style="margin-left: 40px;"&gt;&lt;font size="4"&gt;&lt;b&gt;&lt;i&gt;virsh # migrate --live scompi1 \
qemu+ssh://rionegro/system&lt;/i&gt;&lt;/b&gt;&lt;/font&gt;&lt;br&gt;&lt;font size="4"&gt;&lt;b&gt;&lt;i&gt;error: monitor \
socket did not show up.: Connection refused&lt;/i&gt;&lt;/b&gt;&lt;/font&gt;&lt;br&gt; &lt;/div&gt;&lt;font \
size="4"&gt;&lt;br&gt;&lt;/font&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;2011/4/1  &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:jurgen.depicker@let.be" \
target="_blank"&gt;jurgen.depicker@let.be&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, \
204, 204); padding-left: 1ex;"&gt;

&lt;tt&gt;&lt;font size="2"&gt;&lt;br&gt;
&gt; From: Marcela Castro León &lt;&lt;a href="mailto:mcastrol@gmail.com" \
target="_blank"&gt;mcastrol@gmail.com&lt;/a&gt;&gt;&lt;/font&gt;&lt;/tt&gt; &lt;br&gt;&lt;tt&gt;&lt;font size="2"&gt;&gt; \
To: &lt;a href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;/font&gt;&lt;/tt&gt; &lt;br&gt;&lt;tt&gt;&lt;font size="2"&gt;&gt; \
Date: 01/04/2011 13:11&lt;/font&gt;&lt;/tt&gt; &lt;br&gt;&lt;tt&gt;&lt;font size="2"&gt;&gt; Subject: \
[libvirt-users] LIBVIRT migration&lt;/font&gt;&lt;/tt&gt; &lt;br&gt;&lt;tt&gt;&lt;font size="2"&gt;&gt; Sent by: &lt;a \
href="mailto:libvirt-users-bounces@redhat.com" \
target="_blank"&gt;libvirt-users-bounces@redhat.com&lt;/a&gt;&lt;/font&gt;&lt;/tt&gt; &lt;br&gt;&lt;div&gt;&lt;tt&gt;&lt;font \
size="2"&gt;&gt; &lt;br&gt; &gt; Hello&lt;br&gt;
&gt; I''m developing a system using libvirt and I need to use \
"migrate" &lt;br&gt;
&gt; to move guest to different hosts.&lt;br&gt;
&gt; I'm testing using a cluster connected by ssh, and I'm connect ok &lt;br&gt;
&gt; trought them, using virsh and virt-manager.&lt;br&gt;
&gt; &lt;br&gt;
&gt; But if I try to migrate doing:&lt;br&gt;
&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size="2"&gt;&gt; virsh # migrate --live scompi1 \
qemu+ssh://rionegro/system&lt;/font&gt;&lt;/tt&gt; &lt;br&gt;&lt;tt&gt;&lt;font size="2"&gt;&gt; &lt;br&gt;
&gt; I got:&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size="2"&gt;&gt; error: monitor socket did not show up.: Connection
refused&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;
&lt;br&gt;&lt;/div&gt;&lt;tt&gt;&lt;font size="2"&gt;Please check that you used ssh-copy-id to copy your
ssh key (the user you are logged in with when entering virsh) to the destination
host's root account.&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size="2"&gt;Jürgen&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;&lt;div&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size="2"&gt;&gt; &lt;br&gt;
&gt; I've try using the virt-manager, but troughs:&lt;br&gt;
&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size="2"&gt;&gt; Unable to migrate guest:&lt;br&gt;
&gt;  Traceback (most recent call last):&lt;br&gt;
&gt;   File "/usr/share/virt-manager/virtManager/migrate.py",
line 453, &lt;br&gt;
&gt; in _async_migrate&lt;br&gt;
&gt;     vm.migrate(dstconn, migrate_uri, rate, live, secure)&lt;br&gt;
&gt;   File "/usr/share/virt-manager/virtManager/domain.py",
line 230, in migrate&lt;br&gt;
&gt;     self._backend.migrate(destconn.vmm, flags, newname,
interface, rate)&lt;br&gt;
&gt;   File "/usr/lib/python2.6/dist-packages/libvirt.py",
line 429, in migrate&lt;br&gt;
&gt;     if ret is None:raise libvirtError('virDomainMigrate()
failed', dom=self)&lt;br&gt;
&gt; libvirtError: monitor socket did not show up.: Connection refused&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size="2"&gt;&gt; &lt;br&gt;
&gt; Someone can help me? Thank you very much.&lt;br&gt;
&gt; Marcela.&lt;br&gt;
&gt; &lt;br&gt;
&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;&lt;/div&gt;&lt;tt&gt;&lt;font size="2"&gt;&gt; _______________________________________________&lt;br&gt;
&gt; libvirt-users mailing list&lt;br&gt;
&gt; &lt;a href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt; &gt; &lt;/font&gt;&lt;/tt&gt;&lt;a \
href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;&lt;tt&gt;&lt;font \
size="2"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/font&gt;&lt;/tt&gt;&lt;/a&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;


--20cf300255c072d4e2049fdc0aae--


["libvirtd.conf" (application/octet-stream)]

</body></email><email><emailId>20110401142611</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-04-01 14:26:11-0400</timestampReceived><subject>Re: [libvirt-users] LIBVIRT migration</subject><body>

On Fri, Apr 01, 2011 at 02:28:36PM +0200, jurgen.depicker@let.be wrote:
&gt; &gt; From: Marcela Castro León &lt;mcastrol@gmail.com&gt;
&gt; &gt; To: libvirt-users@redhat.com
&gt; &gt; Date: 01/04/2011 13:11
&gt; &gt; Subject: [libvirt-users] LIBVIRT migration
&gt; &gt; Sent by: libvirt-users-bounces@redhat.com
&gt; &gt; 
&gt; &gt; Hello
&gt; &gt; I''m developing a system using libvirt and I need to use "migrate" 
&gt; &gt; to move guest to different hosts.
&gt; &gt; I'm testing using a cluster connected by ssh, and I'm connect ok 
&gt; &gt; trought them, using virsh and virt-manager.
&gt; &gt; 
&gt; &gt; But if I try to migrate doing:
&gt; 
&gt; &gt; virsh # migrate --live scompi1 qemu+ssh://rionegro/system
&gt; &gt; 
&gt; &gt; I got:
&gt; &gt; error: monitor socket did not show up.: Connection refused
&gt; 
&gt; Please check that you used ssh-copy-id to copy your ssh key (the user you 
&gt; are logged in with when entering virsh) to the destination host's root 
&gt; account.

This error message shows that libvirt did *not* have any trouble
actually connecting to libvirtd on the dest host.

It actually means that QEMU on the target host failed to startup.
You should check /var/log/libvirt/qemu/scompi1.log for any
further details as to why it failed to start.


Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110401202404</emailId><senderName>Marcela_Castro_León</senderName><senderEmail>mcastrol@gmail.com</senderEmail><timestampReceived>2011-04-01 20:24:04-0400</timestampReceived><subject>Re: [libvirt-users] LIBVIRT migration</subject><body>

Hello Daniel:
In the log I found that libvirt coudn't find image file. I solved that, but
know I've got:
*virsh # migrate scompi1 qemu+ssh://rionegro/system
error: Unknown failure
*

The log on target (rionegro:/var/log/libvirt/qemu/scompi1.log) say:
LC_ALL=C PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin
QEMU_AUDIO_DRV=none /usr/bin/qemu-system-x86_64 -S -M pc-0.12 -enable-kvm -m
4096 -smp 4 -name scompi1 -uuid 355123af-b683-9fa6-ca31-10506c9ab9da
-chardev
socket,id=monitor,path=/var/lib/libvirt/qemu/scompi1.monitor,server,nowait
-monitor chardev:monitor -boot c -drive
file=/home/radic/mvdata/imagenes/scompi1.img,if=ide,index=0,boot=on,format=raw
-drive if=ide,media=cdrom,index=2,format=raw -net
nic,macaddr=52:54:00:05:d1:2a,vlan=0,model=virtio,name=virtio.0 -net
tap,fd=32,vlan=0,name=tap.0 -chardev pty,id=serial0 -serial chardev:serial0
-parallel none -usb -vnc 127.0.0.1:0 -vga cirrus -incoming tcp:0.0.0.0:49163
char device redirected to /dev/pts/1
*pci_add_option_rom: failed to find romfile "pxe-virtio.bin"*

At one forum I've read that it can be solved installing the package kvm-pxe.
It's ok?
Thank you very much.

Marcela.

2011/4/1 Daniel P. Berrange &lt;berrange@redhat.com&gt;

&gt; On Fri, Apr 01, 2011 at 02:28:36PM +0200, jurgen.depicker@let.be wrote:
&gt; &gt; &gt; From: Marcela Castro León &lt;mcastrol@gmail.com&gt;
&gt; &gt; &gt; To: libvirt-users@redhat.com
&gt; &gt; &gt; Date: 01/04/2011 13:11
&gt; &gt; &gt; Subject: [libvirt-users] LIBVIRT migration
&gt; &gt; &gt; Sent by: libvirt-users-bounces@redhat.com
&gt; &gt; &gt;
&gt; &gt; &gt; Hello
&gt; &gt; &gt; I''m developing a system using libvirt and I need to use "migrate"
&gt; &gt; &gt; to move guest to different hosts.
&gt; &gt; &gt; I'm testing using a cluster connected by ssh, and I'm connect ok
&gt; &gt; &gt; trought them, using virsh and virt-manager.
&gt; &gt; &gt;
&gt; &gt; &gt; But if I try to migrate doing:
&gt; &gt;
&gt; &gt; &gt; virsh # migrate --live scompi1 qemu+ssh://rionegro/system
&gt; &gt; &gt;
&gt; &gt; &gt; I got:
&gt; &gt; &gt; error: monitor socket did not show up.: Connection refused
&gt; &gt;
&gt; &gt; Please check that you used ssh-copy-id to copy your ssh key (the user you
&gt; &gt; are logged in with when entering virsh) to the destination host's root
&gt; &gt; account.
&gt;
&gt; This error message shows that libvirt did *not* have any trouble
&gt; actually connecting to libvirtd on the dest host.
&gt;
&gt; It actually means that QEMU on the target host failed to startup.
&gt; You should check /var/log/libvirt/qemu/scompi1.log for any
&gt; further details as to why it failed to start.
&gt;
&gt;
&gt; Daniel
&gt; --
&gt; |: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/:|
&gt; |: http://libvirt.org              -o-             http://virt-manager.org:|
&gt; |: http://autobuild.org       -o-         http://search.cpan.org/~danberr/:|
&gt; |: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc:|
&gt;

[Attachment #3 (text/html)]

&lt;font size="4"&gt;Hello Daniel:&lt;br&gt;In the log I found that libvirt coudn't find \
image file. I solved that, but know I've got:&lt;br&gt;&lt;/font&gt;&lt;div style="margin-left: \
40px;"&gt;&lt;i&gt;&lt;b&gt;&lt;font size="4"&gt;virsh # migrate scompi1 \
qemu+ssh://rionegro/system&lt;/font&gt;&lt;br&gt; &lt;font size="4"&gt;
error: Unknown failure&lt;/font&gt;&lt;br&gt;&lt;/b&gt;&lt;/i&gt;&lt;/div&gt;
&lt;br&gt;&lt;font size="4"&gt;The log &lt;/font&gt;&lt;font size="4"&gt;on target \
(rionegro:/var/log/libvirt/qemu/scompi1.log) say:&lt;br&gt;&lt;/font&gt;LC_ALL=C \
PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin QEMU_AUDIO_DRV=none \
/usr/bin/qemu-system-x86_64 -S -M pc-0.12 -enable-kvm -m 4096 -smp 4 -name scompi1 \
-uuid 355123af-b683-9fa6-ca31-10506c9ab9da -chardev \
socket,id=monitor,path=/var/lib/libvirt/qemu/scompi1.monitor,server,nowait -monitor \
chardev:monitor -boot c -drive \
file=/home/radic/mvdata/imagenes/scompi1.img,if=ide,index=0,boot=on,format=raw -drive \
if=ide,media=cdrom,index=2,format=raw -net \
nic,macaddr=52:54:00:05:d1:2a,vlan=0,model=virtio,name=virtio.0 -net \
tap,fd=32,vlan=0,name=tap.0 -chardev pty,id=serial0 -serial chardev:serial0 -parallel \
none -usb -vnc &lt;a href="http://127.0.0.1:0"&gt;127.0.0.1:0&lt;/a&gt; -vga cirrus -incoming \
tcp:&lt;a href="http://0.0.0.0:49163"&gt;0.0.0.0:49163&lt;/a&gt; &lt;br&gt; char device redirected to \
/dev/pts/1&lt;br&gt;&lt;i&gt;&lt;b&gt;pci_add_option_rom: failed to find romfile \
"pxe-virtio.bin"&lt;/b&gt;&lt;/i&gt;&lt;br&gt;&lt;br&gt;&lt;font size="4"&gt;At one forum I've read \
that it can be solved installing the package kvm-pxe. It's ok?&lt;br&gt; Thank you very \
much.&lt;br&gt;&lt;br&gt;Marcela.&lt;br&gt;&lt;br&gt;&lt;/font&gt;&lt;div class="gmail_quote"&gt;2011/4/1 Daniel P. \
Berrange &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:berrange@redhat.com"&gt;berrange@redhat.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, \
204, 204); padding-left: 1ex;"&gt; &lt;div class="im"&gt;On Fri, Apr 01, 2011 at 02:28:36PM \
+0200, &lt;a href="mailto:jurgen.depicker@let.be"&gt;jurgen.depicker@let.be&lt;/a&gt; wrote:&lt;br&gt; \
&gt; &gt; From: Marcela Castro León &lt;&lt;a \
href="mailto:mcastrol@gmail.com"&gt;mcastrol@gmail.com&lt;/a&gt;&gt;&lt;br&gt; &gt; &gt; To: &lt;a \
href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt; &gt; &gt; \
Date: 01/04/2011 13:11&lt;br&gt; &gt; &gt; Subject: [libvirt-users] LIBVIRT migration&lt;br&gt;
&gt; &gt; Sent by: &lt;a \
href="mailto:libvirt-users-bounces@redhat.com"&gt;libvirt-users-bounces@redhat.com&lt;/a&gt;&lt;br&gt;
 &gt; &gt;&lt;br&gt;
&gt; &gt; Hello&lt;br&gt;
&gt; &gt; I''m developing a system using libvirt and I need to use \
"migrate"&lt;br&gt; &gt; &gt; to move guest to different hosts.&lt;br&gt;
&gt; &gt; I'm testing using a cluster connected by ssh, and I'm connect \
ok&lt;br&gt; &gt; &gt; trought them, using virsh and virt-manager.&lt;br&gt;
&gt; &gt;&lt;br&gt;
&gt; &gt; But if I try to migrate doing:&lt;br&gt;
&gt;&lt;br&gt;
&gt; &gt; virsh # migrate --live scompi1 qemu+ssh://rionegro/system&lt;br&gt;
&gt; &gt;&lt;br&gt;
&gt; &gt; I got:&lt;br&gt;
&gt; &gt; error: monitor socket did not show up.: Connection refused&lt;br&gt;
&gt;&lt;br&gt;
&gt; Please check that you used ssh-copy-id to copy your ssh key (the user you&lt;br&gt;
&gt; are logged in with when entering virsh) to the destination host's root&lt;br&gt;
&gt; account.&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;This error message shows that libvirt did *not* have any trouble&lt;br&gt;
actually connecting to libvirtd on the dest host.&lt;br&gt;
&lt;br&gt;
It actually means that QEMU on the target host failed to startup.&lt;br&gt;
You should check /var/log/libvirt/qemu/scompi1.log for any&lt;br&gt;
further details as to why it failed to start.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Daniel&lt;br&gt;
&lt;font color="#888888"&gt;--&lt;br&gt;
&gt; &gt; &lt;a href="http://berrange.com" target="_blank"&gt;http://berrange.com&lt;/a&gt;      -o-    \
&gt; &gt; &lt;a href="http://www.flickr.com/photos/dberrange/" \
&gt; &gt; target="_blank"&gt;http://www.flickr.com/photos/dberrange/&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="http://libvirt.org" target="_blank"&gt;http://libvirt.org&lt;/a&gt;              \
&gt; &gt; -o-             &lt;a href="http://virt-manager.org" \
&gt; &gt; target="_blank"&gt;http://virt-manager.org&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="http://autobuild.org" target="_blank"&gt;http://autobuild.org&lt;/a&gt;       -o- \
&gt; &gt; &lt;a href="http://search.cpan.org/%7Edanberr/" \
&gt; &gt; target="_blank"&gt;http://search.cpan.org/~danberr/&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="http://entangle-photo.org" target="_blank"&gt;http://entangle-photo.org&lt;/a&gt; \
&gt; &gt; -o-       &lt;a href="http://live.gnome.org/gtk-vnc" \
&gt; &gt; target="_blank"&gt;http://live.gnome.org/gtk-vnc&lt;/a&gt; :|&lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110401202939</emailId><senderName>Marcela_Castro_León</senderName><senderEmail>mcastrol@gmail.com</senderEmail><timestampReceived>2011-04-01 20:29:39-0400</timestampReceived><subject>Re: [libvirt-users] LIBVIRT migration</subject><body>

Hello:
I've installed the package kvm-pxe on target host, and the error
*pci_add_option_rom:
failed to find romfile "pxe-virtio.bin" *dissappeared from the log, but the
migrate still doesn't work, and it continue saying:

virsh # migrate scompi1 qemu+ssh://rionegro/system
error: Unknown failure

I'd appreciate a lot any help.
Thank you.
Marcela

2011/4/1 Marcela Castro León &lt;mcastrol@gmail.com&gt;

&gt; Hello Daniel:
&gt; In the log I found that libvirt coudn't find image file. I solved that, but
&gt; know I've got:
&gt; *virsh # migrate scompi1 qemu+ssh://rionegro/system
&gt;  error: Unknown failure
&gt; *
&gt;
&gt; The log on target (rionegro:/var/log/libvirt/qemu/scompi1.log) say:
&gt; LC_ALL=C PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin
&gt; QEMU_AUDIO_DRV=none /usr/bin/qemu-system-x86_64 -S -M pc-0.12 -enable-kvm -m
&gt; 4096 -smp 4 -name scompi1 -uuid 355123af-b683-9fa6-ca31-10506c9ab9da
&gt; -chardev
&gt; socket,id=monitor,path=/var/lib/libvirt/qemu/scompi1.monitor,server,nowait
&gt; -monitor chardev:monitor -boot c -drive
&gt; file=/home/radic/mvdata/imagenes/scompi1.img,if=ide,index=0,boot=on,format=raw
&gt; -drive if=ide,media=cdrom,index=2,format=raw -net
&gt; nic,macaddr=52:54:00:05:d1:2a,vlan=0,model=virtio,name=virtio.0 -net
&gt; tap,fd=32,vlan=0,name=tap.0 -chardev pty,id=serial0 -serial chardev:serial0
&gt; -parallel none -usb -vnc 127.0.0.1:0 -vga cirrus -incoming tcp:
&gt; 0.0.0.0:49163
&gt; char device redirected to /dev/pts/1
&gt; *pci_add_option_rom: failed to find romfile "pxe-virtio.bin"*
&gt;
&gt; At one forum I've read that it can be solved installing the package
&gt; kvm-pxe. It's ok?
&gt;
&gt; Thank you very much.
&gt;
&gt; Marcela.
&gt;
&gt; 2011/4/1 Daniel P. Berrange &lt;berrange@redhat.com&gt;
&gt;
&gt; On Fri, Apr 01, 2011 at 02:28:36PM +0200, jurgen.depicker@let.be wrote:
&gt;&gt; &gt; &gt; From: Marcela Castro León &lt;mcastrol@gmail.com&gt;
&gt;&gt; &gt; &gt; To: libvirt-users@redhat.com
&gt;&gt; &gt; &gt; Date: 01/04/2011 13:11
&gt;&gt; &gt; &gt; Subject: [libvirt-users] LIBVIRT migration
&gt;&gt; &gt; &gt; Sent by: libvirt-users-bounces@redhat.com
&gt;&gt; &gt; &gt;
&gt;&gt; &gt; &gt; Hello
&gt;&gt; &gt; &gt; I''m developing a system using libvirt and I need to use "migrate"
&gt;&gt; &gt; &gt; to move guest to different hosts.
&gt;&gt; &gt; &gt; I'm testing using a cluster connected by ssh, and I'm connect ok
&gt;&gt; &gt; &gt; trought them, using virsh and virt-manager.
&gt;&gt; &gt; &gt;
&gt;&gt; &gt; &gt; But if I try to migrate doing:
&gt;&gt; &gt;
&gt;&gt; &gt; &gt; virsh # migrate --live scompi1 qemu+ssh://rionegro/system
&gt;&gt; &gt; &gt;
&gt;&gt; &gt; &gt; I got:
&gt;&gt; &gt; &gt; error: monitor socket did not show up.: Connection refused
&gt;&gt; &gt;
&gt;&gt; &gt; Please check that you used ssh-copy-id to copy your ssh key (the user
&gt;&gt; you
&gt;&gt; &gt; are logged in with when entering virsh) to the destination host's root
&gt;&gt; &gt; account.
&gt;&gt;
&gt;&gt; This error message shows that libvirt did *not* have any trouble
&gt;&gt; actually connecting to libvirtd on the dest host.
&gt;&gt;
&gt;&gt; It actually means that QEMU on the target host failed to startup.
&gt;&gt; You should check /var/log/libvirt/qemu/scompi1.log for any
&gt;&gt; further details as to why it failed to start.
&gt;&gt;
&gt;&gt;
&gt;&gt; Daniel
&gt;&gt; --
&gt;&gt; |: http://berrange.com      -o-
&gt;&gt; http://www.flickr.com/photos/dberrange/ :|
&gt;&gt; |: http://libvirt.org              -o-
&gt;&gt; http://virt-manager.org :|
&gt;&gt; |: http://autobuild.org       -o-
&gt;&gt; http://search.cpan.org/~danberr/ :|
&gt;&gt; |: http://entangle-photo.org       -o-
&gt;&gt; http://live.gnome.org/gtk-vnc :|
&gt;&gt;
&gt;
&gt;

[Attachment #3 (text/html)]

&lt;font size="4"&gt;Hello:&lt;br&gt;I've installed the package kvm-pxe on target host, and \
the error &lt;/font&gt;&lt;i&gt;&lt;b&gt;pci_add_option_rom: failed to find romfile \
"pxe-virtio.bin" &lt;/b&gt;&lt;/i&gt;&lt;font size="4"&gt;dissappeared from the log, but the \
migrate still doesn't work, and it continue saying:&lt;br&gt; &lt;/font&gt;&lt;div \
style="margin-left: 80px;"&gt;&lt;font size="4"&gt; &lt;/font&gt;&lt;br&gt;&lt;font size="4"&gt;virsh # migrate \
scompi1 qemu+ssh://rionegro/system&lt;/font&gt;&lt;br&gt;&lt;font size="4"&gt;error: Unknown \
failure&lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;font size="4"&gt;&lt;br&gt;I'd appreciate a lot any help.&lt;br&gt; \
Thank you.&lt;br&gt;Marcela&lt;br&gt;&lt;/font&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;2011/4/1 Marcela Castro \
León &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:mcastrol@gmail.com"&gt;mcastrol@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, \
204, 204); padding-left: 1ex;"&gt; &lt;font size="4"&gt;Hello Daniel:&lt;br&gt;In the log I found \
that libvirt coudn't find image file. I solved that, but know I've \
got:&lt;br&gt;&lt;/font&gt;&lt;div style="margin-left: 40px;"&gt;&lt;i&gt;&lt;b&gt;&lt;font size="4"&gt;virsh # migrate \
scompi1 qemu+ssh://rionegro/system&lt;/font&gt;&lt;br&gt;

&lt;font size="4"&gt;
error: Unknown failure&lt;/font&gt;&lt;br&gt;&lt;/b&gt;&lt;/i&gt;&lt;/div&gt;
&lt;br&gt;&lt;font size="4"&gt;The log &lt;/font&gt;&lt;font size="4"&gt;on target \
(rionegro:/var/log/libvirt/qemu/scompi1.log) say:&lt;br&gt;&lt;/font&gt;LC_ALL=C \
PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin QEMU_AUDIO_DRV=none \
/usr/bin/qemu-system-x86_64 -S -M pc-0.12 -enable-kvm -m 4096 -smp 4 -name scompi1 \
-uuid 355123af-b683-9fa6-ca31-10506c9ab9da -chardev \
socket,id=monitor,path=/var/lib/libvirt/qemu/scompi1.monitor,server,nowait -monitor \
chardev:monitor -boot c -drive \
file=/home/radic/mvdata/imagenes/scompi1.img,if=ide,index=0,boot=on,format=raw -drive \
if=ide,media=cdrom,index=2,format=raw -net \
nic,macaddr=52:54:00:05:d1:2a,vlan=0,model=virtio,name=virtio.0 -net \
tap,fd=32,vlan=0,name=tap.0 -chardev pty,id=serial0 -serial chardev:serial0 -parallel \
none -usb -vnc &lt;a href="http://127.0.0.1:0" target="_blank"&gt;127.0.0.1:0&lt;/a&gt; -vga \
cirrus -incoming tcp:&lt;a href="http://0.0.0.0:49163" target="_blank"&gt;0.0.0.0:49163&lt;/a&gt; \
&lt;br&gt;

char device redirected to /dev/pts/1&lt;br&gt;&lt;i&gt;&lt;b&gt;pci_add_option_rom: failed to find \
romfile "pxe-virtio.bin"&lt;/b&gt;&lt;/i&gt;&lt;br&gt;&lt;br&gt;&lt;font size="4"&gt;At one forum \
I've read that it can be solved installing the package kvm-pxe. It's ok?&lt;div \
class="im"&gt; &lt;br&gt;
Thank you very much.&lt;br&gt;&lt;br&gt;Marcela.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/font&gt;&lt;div \
class="gmail_quote"&gt;2011/4/1 Daniel P. Berrange &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:berrange@redhat.com" \
target="_blank"&gt;berrange@redhat.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;div&gt; &lt;div&gt;&lt;/div&gt;&lt;div \
class="h5"&gt;&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; \
border-left: 1px solid rgb(204, 204, 204); padding-left: 1ex;"&gt; &lt;div&gt;On Fri, Apr 01, \
2011 at 02:28:36PM +0200, &lt;a href="mailto:jurgen.depicker@let.be" \
target="_blank"&gt;jurgen.depicker@let.be&lt;/a&gt; wrote:&lt;br&gt; &gt; &gt; From: Marcela Castro \
León &lt;&lt;a href="mailto:mcastrol@gmail.com" \
target="_blank"&gt;mcastrol@gmail.com&lt;/a&gt;&gt;&lt;br&gt; &gt; &gt; To: &lt;a \
href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt; &gt; &gt; Date: 01/04/2011 13:11&lt;br&gt;
&gt; &gt; Subject: [libvirt-users] LIBVIRT migration&lt;br&gt;
&gt; &gt; Sent by: &lt;a href="mailto:libvirt-users-bounces@redhat.com" \
target="_blank"&gt;libvirt-users-bounces@redhat.com&lt;/a&gt;&lt;br&gt; &gt; &gt;&lt;br&gt;
&gt; &gt; Hello&lt;br&gt;
&gt; &gt; I''m developing a system using libvirt and I need to use \
"migrate"&lt;br&gt; &gt; &gt; to move guest to different hosts.&lt;br&gt;
&gt; &gt; I'm testing using a cluster connected by ssh, and I'm connect \
ok&lt;br&gt; &gt; &gt; trought them, using virsh and virt-manager.&lt;br&gt;
&gt; &gt;&lt;br&gt;
&gt; &gt; But if I try to migrate doing:&lt;br&gt;
&gt;&lt;br&gt;
&gt; &gt; virsh # migrate --live scompi1 qemu+ssh://rionegro/system&lt;br&gt;
&gt; &gt;&lt;br&gt;
&gt; &gt; I got:&lt;br&gt;
&gt; &gt; error: monitor socket did not show up.: Connection refused&lt;br&gt;
&gt;&lt;br&gt;
&gt; Please check that you used ssh-copy-id to copy your ssh key (the user you&lt;br&gt;
&gt; are logged in with when entering virsh) to the destination host's root&lt;br&gt;
&gt; account.&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;This error message shows that libvirt did *not* have any trouble&lt;br&gt;
actually connecting to libvirtd on the dest host.&lt;br&gt;
&lt;br&gt;
It actually means that QEMU on the target host failed to startup.&lt;br&gt;
You should check /var/log/libvirt/qemu/scompi1.log for any&lt;br&gt;
further details as to why it failed to start.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Daniel&lt;br&gt;
&lt;font color="#888888"&gt;--&lt;br&gt;
&gt; &gt; &lt;a href="http://berrange.com" target="_blank"&gt;http://berrange.com&lt;/a&gt;      -o-    \
&gt; &gt; &lt;a href="http://www.flickr.com/photos/dberrange/" \
&gt; &gt; target="_blank"&gt;http://www.flickr.com/photos/dberrange/&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="http://libvirt.org" target="_blank"&gt;http://libvirt.org&lt;/a&gt;              \
&gt; &gt; -o-             &lt;a href="http://virt-manager.org" \
&gt; &gt; target="_blank"&gt;http://virt-manager.org&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="http://autobuild.org" target="_blank"&gt;http://autobuild.org&lt;/a&gt;       -o- \
&gt; &gt; &lt;a href="http://search.cpan.org/%7Edanberr/" \
&gt; &gt; target="_blank"&gt;http://search.cpan.org/~danberr/&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="http://entangle-photo.org" target="_blank"&gt;http://entangle-photo.org&lt;/a&gt; \
&gt; &gt; -o-       &lt;a href="http://live.gnome.org/gtk-vnc" \
&gt; &gt; target="_blank"&gt;http://live.gnome.org/gtk-vnc&lt;/a&gt; :|&lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110404095825</emailId><senderName>Marcela_Castro_León</senderName><senderEmail>mcastrol@gmail.com</senderEmail><timestampReceived>2011-04-04 09:58:25-0400</timestampReceived><subject>[libvirt-users] LIBVIRT migration</subject><body>

[Attachment #2 (multipart/alternative)]


Hello
I'm having problem using migration. I'm working on ubuntu 10.4 and this
versions of libvirt and virsh:
virsh # version
Compiled against library: libvir 0.7.5
Using library: libvir 0.7.5
Using API: QEMU 0.7.5
Running hypervisor: QEMU 0.12.3

This is the error.
*virsh # migrate scompi1 qemu+ssh://rionegro/system
error: Unknown failure
*

This is the log on the destination, that show that there is no communication
problem, but it has a problem starting the guest on destination.

radic@rionegro:~$ sudo cat /var/log/libvirt/qemu/scompi1.log
[sudo] password for radic:
LC_ALL=C PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin
QEMU_AUDIO_DRV=none /usr/bin/qemu-system-x86_64 -S -M pc-0.12 -enable-kvm -m
4096 -smp 4 -name scompi1 -uuid 355123af-b683-9fa6-ca31-10506c9ab9da
-chardev
socket,id=monitor,path=/var/lib/libvirt/qemu/scompi1.monitor,server,nowait
-monitor chardev:monitor -boot c -drive
file=/home/radic/mvdata/imagenes/scompi1.img,if=ide,index=0,boot=on,format=raw
-drive if=ide,media=cdrom,index=2,format=raw -net
nic,macaddr=52:54:00:05:d1:2a,vlan=0,model=virtio,name=virtio.0 -net
tap,fd=33,vlan=0,name=tap.0 -chardev pty,id=serial0 -serial chardev:serial0
-parallel none -usb -vnc 127.0.0.1:0 -vga cirrus -incoming tcp:0.0.0.0:49153
char device redirected to /dev/pts/1
LC_ALL=C PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin
QEMU_AUDIO_DRV=none /usr/bin/qemu-system-x86_64 -S -M pc-0.12 -enable-kvm -m
4096 -smp 4 -name scompi1 -uuid 355123af-b683-9fa6-ca31-10506c9ab9da
-chardev
socket,id=monitor,path=/var/lib/libvirt/qemu/scompi1.monitor,server,nowait
-monitor chardev:monitor -boot c -drive
file=/home/radic/mvdata/imagenes/scompi1.img,if=ide,index=0,boot=on,format=raw
-drive if=ide,media=cdrom,index=2,format=raw -net
nic,macaddr=52:54:00:05:d1:2a,vlan=0,model=virtio,name=virtio.0 -net
tap,fd=33,vlan=0,name=tap.0 -chardev pty,id=serial0 -serial chardev:serial0
-parallel none -usb -vnc 127.0.0.1:0 -vga cirrus -incoming tcp:0.0.0.0:49154
char device redirected to /dev/pts/2
LC_ALL=C PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin
QEMU_AUDIO_DRV=none /usr/bin/qemu-system-x86_64 -S -M pc-0.12 -enable-kvm -m
4096 -smp 4 -name scompi1 -uuid 355123af-b683-9fa6-ca31-10506c9ab9da
-chardev
socket,id=monitor,path=/var/lib/libvirt/qemu/scompi1.monitor,server,nowait
-monitor chardev:monitor -boot c -drive
file=/home/radic/mvdata/imagenes/scompi1.img,if=ide,index=0,boot=on,format=raw
-drive if=ide,media=cdrom,index=2,format=raw -net
nic,macaddr=52:54:00:05:d1:2a,vlan=0,model=virtio,name=virtio.0 -net
tap,fd=33,vlan=0,name=tap.0 -chardev pty,id=serial0 -serial chardev:serial0
-parallel none -usb -vnc 127.0.0.1:0 -vga cirrus -incoming tcp:0.0.0.0:49155
char device redirected to /dev/pts/2

I'm attaching the xml of the scompi1 that i'm trying to migrate.
I'd apprciate a lot any help.
Marcela

[Attachment #5 (text/html)]

&lt;font size="4"&gt;Hello&lt;br&gt;I'm having problem using migration. I'm working on \
ubuntu 10.4 and this versions of libvirt and virsh:&lt;br&gt;virsh # version&lt;br&gt;Compiled \
against library: libvir 0.7.5&lt;br&gt;Using library: libvir 0.7.5&lt;br&gt; Using API: QEMU \
0.7.5&lt;br&gt;Running hypervisor: QEMU 0.12.3&lt;br&gt;&lt;br&gt;This is the error.&lt;br&gt;&lt;/font&gt;&lt;div \
style="margin-left: 40px;"&gt;&lt;i&gt;&lt;font size="4"&gt;virsh # migrate scompi1 \
qemu+ssh://rionegro/system&lt;/font&gt;&lt;br&gt;&lt;font size="4"&gt;error: Unknown failure&lt;/font&gt;&lt;br&gt; \
&lt;/i&gt;&lt;/div&gt;&lt;font size="4"&gt;&lt;br&gt;This is the log on the destination, that show that there \
is no communication problem, but it has a problem starting the guest on \
destination.&lt;br&gt;&lt;/font&gt;&lt;br&gt;radic@rionegro:~$ sudo cat \
/var/log/libvirt/qemu/scompi1.log&lt;br&gt; [sudo] password for radic: &lt;br&gt;LC_ALL=C \
PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin QEMU_AUDIO_DRV=none \
/usr/bin/qemu-system-x86_64 -S -M pc-0.12 -enable-kvm -m 4096 -smp 4 -name scompi1 \
-uuid 355123af-b683-9fa6-ca31-10506c9ab9da -chardev \
socket,id=monitor,path=/var/lib/libvirt/qemu/scompi1.monitor,server,nowait -monitor \
chardev:monitor -boot c -drive \
file=/home/radic/mvdata/imagenes/scompi1.img,if=ide,index=0,boot=on,format=raw -drive \
if=ide,media=cdrom,index=2,format=raw -net \
nic,macaddr=52:54:00:05:d1:2a,vlan=0,model=virtio,name=virtio.0 -net \
tap,fd=33,vlan=0,name=tap.0 -chardev pty,id=serial0 -serial chardev:serial0 -parallel \
none -usb -vnc &lt;a href="http://127.0.0.1:0"&gt;127.0.0.1:0&lt;/a&gt; -vga cirrus -incoming \
tcp:&lt;a href="http://0.0.0.0:49153"&gt;0.0.0.0:49153&lt;/a&gt; &lt;br&gt; char device redirected to \
/dev/pts/1&lt;br&gt;LC_ALL=C \
PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin QEMU_AUDIO_DRV=none \
/usr/bin/qemu-system-x86_64 -S -M pc-0.12 -enable-kvm -m 4096 -smp 4 -name scompi1 \
-uuid 355123af-b683-9fa6-ca31-10506c9ab9da -chardev \
socket,id=monitor,path=/var/lib/libvirt/qemu/scompi1.monitor,server,nowait -monitor \
chardev:monitor -boot c -drive \
file=/home/radic/mvdata/imagenes/scompi1.img,if=ide,index=0,boot=on,format=raw -drive \
if=ide,media=cdrom,index=2,format=raw -net \
nic,macaddr=52:54:00:05:d1:2a,vlan=0,model=virtio,name=virtio.0 -net \
tap,fd=33,vlan=0,name=tap.0 -chardev pty,id=serial0 -serial chardev:serial0 -parallel \
none -usb -vnc &lt;a href="http://127.0.0.1:0"&gt;127.0.0.1:0&lt;/a&gt; -vga cirrus -incoming \
tcp:&lt;a href="http://0.0.0.0:49154"&gt;0.0.0.0:49154&lt;/a&gt; &lt;br&gt; char device redirected to \
/dev/pts/2&lt;br&gt;LC_ALL=C \
PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin QEMU_AUDIO_DRV=none \
/usr/bin/qemu-system-x86_64 -S -M pc-0.12 -enable-kvm -m 4096 -smp 4 -name scompi1 \
-uuid 355123af-b683-9fa6-ca31-10506c9ab9da -chardev \
socket,id=monitor,path=/var/lib/libvirt/qemu/scompi1.monitor,server,nowait -monitor \
chardev:monitor -boot c -drive \
file=/home/radic/mvdata/imagenes/scompi1.img,if=ide,index=0,boot=on,format=raw -drive \
if=ide,media=cdrom,index=2,format=raw -net \
nic,macaddr=52:54:00:05:d1:2a,vlan=0,model=virtio,name=virtio.0 -net \
tap,fd=33,vlan=0,name=tap.0 -chardev pty,id=serial0 -serial chardev:serial0 -parallel \
none -usb -vnc &lt;a href="http://127.0.0.1:0"&gt;127.0.0.1:0&lt;/a&gt; -vga cirrus -incoming \
tcp:&lt;a href="http://0.0.0.0:49155"&gt;0.0.0.0:49155&lt;/a&gt; &lt;br&gt; char device redirected to \
/dev/pts/2&lt;br&gt;&lt;br&gt;&lt;font size="4"&gt;I'm attaching the xml of the scompi1 that \
i'm trying to migrate.&lt;br&gt;I'd apprciate a lot any \
help.&lt;br&gt;Marcela&lt;br&gt;&lt;/font&gt;&lt;br&gt;

--20cf300255c000487904a014cd43--


["scompi1.xml" (text/xml)]

&lt;domain type='kvm'&gt;
  &lt;name&gt;scompi1&lt;/name&gt;
  &lt;memory&gt;4194304&lt;/memory&gt;
  &lt;currentMemory&gt;1048576&lt;/currentMemory&gt;
  &lt;vcpu&gt;4&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='x86_64' machine='pc-0.12'&gt;hvm&lt;/type&gt;
    &lt;boot dev='hd'/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
    &lt;apic/&gt;
    &lt;pae/&gt;
  &lt;/features&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;restart&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/bin/qemu-system-x86_64&lt;/emulator&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;driver name='qemu' type='raw'/&gt;
      &lt;source file='/home/radic/mvdata/imagenes/scompi1.img'/&gt;
      &lt;target dev='hda' bus='ide'/&gt;
    &lt;/disk&gt;
    &lt;disk type='block' device='cdrom'&gt;
      &lt;driver name='qemu' type='raw'/&gt;
      &lt;target dev='hdc' bus='ide'/&gt;
      &lt;readonly/&gt;
    &lt;/disk&gt;
    &lt;interface type='bridge'&gt;
      &lt;mac address='52:54:00:05:d1:2a'/&gt;
      &lt;source bridge='br0'/&gt;
      &lt;target dev='vnet0'/&gt;
      &lt;model type='virtio'/&gt;
    &lt;/interface&gt;
    &lt;console type='pty'&gt;
      &lt;target port='0'/&gt;
    &lt;/console&gt;
    &lt;console type='pty'&gt;
      &lt;target port='0'/&gt;
    &lt;/console&gt;
    &lt;input type='mouse' bus='ps2'/&gt;
    &lt;graphics type='vnc' port='-1' autoport='yes'/&gt;
    &lt;video&gt;
      &lt;model type='cirrus' vram='9216' heads='1'/&gt;
    &lt;/video&gt;
  &lt;/devices&gt;
&lt;/domain&gt;



</body></email><email><emailId>20110304085506</emailId><senderName>Hereward Cooper</senderName><senderEmail>hereward.cooper@iomart.com</senderEmail><timestampReceived>2011-03-04 08:55:06-0400</timestampReceived><subject>Re: [libvirt-users] libvirt + ESX (HTTP response code 400 for call to 'Login')</subject><body>

[...]
&gt; 400 means bad request. You probably have a character in you password
&gt; that needs to be escaped in XML: &lt;, &gt;, &amp;, ', "
&gt; 
&gt; libvirt currently doesn't escape the password properly when building
&gt; the SOAP request. You can manually workaround this by entering the
&gt; password in escaped form. For example when your password is some&amp;word
&gt; enter some&amp;word instead.

That's fixed it! Thanks for the help.

Cheers.

Coops.

</body></email><email><emailId>20110201184213</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-02-01 18:42:13-0400</timestampReceived><subject>Re: [libvirt-users] network-performance</subject><body>

On 02/02/2011, at 4:39 AM, Orion Poplawski wrote:
&gt; I'm just starting to take a look at guest networking performance and am a little \
&gt; disappointed.  I'm comparing two setups: 
&gt; Host: Windows Server 2008 R2 Hyper-V
&gt; Guest: CentOS 5.5 x86_64
&gt; 
&gt; Host: CentOS 5.5 x86_64 kvm running libvirt
&gt; Guest: CentOS 5.5 x86_64
&gt; 
&gt; The guests are essentially identical except that I'm running the Microsoft Linux \
&gt; Integration Components synthetic drivers on the windows hosted VM.  The libvirt \
&gt; setup uses bridged networking.  Running bonnie++ on a nfs mounted filesystem on \
&gt; each guest I'm seeing the libvirt hosted guest get between 16%-35% of the \
&gt; performance of the Hyper-V guest.  Is this expected?  Is there anything I can do to \
&gt; increase network performance of the kvm guest?

Hi Orion,

Just as an initial question, if the CentOS 5.5 guest using the VirtIO network \
drivers? It's been ages since I used CentOS 5.x, so I don't remember if they're the \
default or not.

That's the initial "big performance boost" thing that's needed over the emulation \
type drivers.

To check, take a look at the XML definition for the guest, and look at the networking
interface.  There should be an element there called "model", and it will contain the
type of network card being emulated.  If it's anything other than "virtio" then an
emulated network driver interface is being used.  (not real fast)

I'd give you a direct URL for the XML to reference, but ironically the libvirt.org \
server appears to be offline at the moment (doesn't happen very often thankfully!).  \
Heh.

Hope that helps.

Regards and best wishes,

Justin Clift


</body></email><email><emailId>20110201193328</emailId><senderName>"Brian K. White"</senderName><senderEmail>brian@aljex.com</senderEmail><timestampReceived>2011-02-01 19:33:28-0400</timestampReceived><subject>Re: [libvirt-users] network-performance</subject><body>

On 2/1/2011 12:39 PM, Orion Poplawski wrote:
&gt; I'm just starting to take a look at guest networking performance and am
&gt; a little disappointed. I'm comparing two setups:
&gt;
&gt; Host: Windows Server 2008 R2 Hyper-V
&gt; Guest: CentOS 5.5 x86_64
&gt;
&gt; Host: CentOS 5.5 x86_64 kvm running libvirt
&gt; Guest: CentOS 5.5 x86_64
&gt;
&gt; The guests are essentially identical except that I'm running the
&gt; Microsoft Linux Integration Components synthetic drivers on the windows
&gt; hosted VM. The libvirt setup uses bridged networking. Running bonnie++
&gt; on a nfs mounted filesystem on each guest I'm seeing the libvirt hosted
&gt; guest get between 16%-35% of the performance of the Hyper-V guest. Is
&gt; this expected? Is there anything I can do to increase network
&gt; performance of the kvm guest?
&gt;

First thing is to stop unfairly comparing things that don't even claim 
to do the same job. hyper-v is a hypervisor, while kvm is not, xen is.

It would be closer but still unfair, to compare qemu or virtualbox for 
windows to kvm.

You didn't say what kind of networking is being used wth hyper-v, but 
it's an understood fact that bridgeing in linux is easy to use and less 
efficient than routing or vlan or macvlan.

So I guess the answer is use xen and something other than bridging.

-- 
bkw

</body></email><email><emailId>20110201203611</emailId><senderName>Orion Poplawski</senderName><senderEmail>orion@cora.nwra.com</senderEmail><timestampReceived>2011-02-01 20:36:11-0400</timestampReceived><subject>Re: [libvirt-users] network-performance</subject><body>

On 02/01/2011 11:42 AM, Justin Clift wrote:
&gt; On 02/02/2011, at 4:39 AM, Orion Poplawski wrote:
&gt; &gt; I'm just starting to take a look at guest networking performance and am a little \
&gt; &gt; disappointed.  I'm comparing two setups: 
&gt; &gt; Host: Windows Server 2008 R2 Hyper-V
&gt; &gt; Guest: CentOS 5.5 x86_64
&gt; &gt; 
&gt; &gt; Host: CentOS 5.5 x86_64 kvm running libvirt
&gt; &gt; Guest: CentOS 5.5 x86_64
&gt; &gt; 
&gt; &gt; The guests are essentially identical except that I'm running the Microsoft Linux \
&gt; &gt; Integration Components synthetic drivers on the windows hosted VM.  The libvirt \
&gt; &gt; setup uses bridged networking.  Running bonnie++ on a nfs mounted filesystem on \
&gt; &gt; each guest I'm seeing the libvirt hosted guest get between 16%-35% of the \
&gt; &gt; performance of the Hyper-V guest.  Is this expected?  Is there anything I can do \
&gt; &gt; to increase network performance of the kvm guest?
&gt; 
&gt; Hi Orion,
&gt; 
&gt; Just as an initial question, if the CentOS 5.5 guest using the VirtIO network \
&gt; drivers? It's been ages since I used CentOS 5.x, so I don't remember if they're the \
&gt; default or not.
&gt; 
&gt; That's the initial "big performance boost" thing that's needed over the emulation \
&gt; type drivers.
&gt; 
&gt; To check, take a look at the XML definition for the guest, and look at the \
&gt; networking interface.  There should be an element there called "model", and it will \
&gt; contain the type of network card being emulated.  If it's anything other than \
&gt; "virtio" then an emulated network driver interface is being used.  (not real fast)
&gt; 
&gt; I'd give you a direct URL for the XML to reference, but ironically the libvirt.org \
&gt; server appears to be offline at the moment (doesn't happen very often thankfully!). \
&gt; Heh. 
&gt; Hope that helps.
&gt; 
&gt; Regards and best wishes,
&gt; 
&gt; Justin Clift

Thanks a lot.  For some reason that particular machine was missing the crucial:

       &lt;model type='virtio'/&gt;

in the interface section.  Performance is much better now.

-- 
Orion Poplawski
Technical Manager                     303-415-9701 x222
NWRA/CoRA Division                    FAX: 303-415-9702
3380 Mitchell Lane                  orion@cora.nwra.com
Boulder, CO 80301              http://www.cora.nwra.com


</body></email><email><emailId>20110202084403</emailId><senderName>Francesc Guasch</senderName><senderEmail>frankie@etsetb.upc.edu</senderEmail><timestampReceived>2011-02-02 08:44:03-0400</timestampReceived><subject>Re: [libvirt-users] network-performance</subject><body>

On Tue, Feb 01, 2011 at 02:33:28PM -0500, Brian K. White wrote:
&gt; On 2/1/2011 12:39 PM, Orion Poplawski wrote:
&gt; &gt;I'm just starting to take a look at guest networking performance and am
&gt; &gt;a little disappointed. I'm comparing two setups:
&gt; &gt;
&gt; &gt;Host: Windows Server 2008 R2 Hyper-V
&gt; &gt;Host: CentOS 5.5 x86_64 kvm running libvirt
&gt; 
&gt; First thing is to stop unfairly comparing things that don't even
&gt; claim to do the same job. hyper-v is a hypervisor, while kvm is not,
&gt; xen is.

Hi Brian, I don't want to sound picky, but I did a quick search in the
KVM documentation and I couldn't find what category KVM is. I really
thought it was playing the same league as Xen.

That's from the KVM faq:

http://www.linux-kvm.org/page/FAQ#What_is_the_difference_between_KVM_and_Xen.3F

    Xen is an external hypervisor ...
    On the other hand, KVM is part of Linux and uses the regular Linux
    scheduler and memory ...

I just found this Linux Journal article:

http://www.linuxjournal.com/article/9764

    KVM is a unique hypervisor. ...

</body></email><email><emailId>20110202095411</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-02-02 09:54:11-0400</timestampReceived><subject>Re: [libvirt-users] network-performance</subject><body>

On 02/02/2011, at 7:44 PM, Francesc Guasch wrote:
&gt; On Tue, Feb 01, 2011 at 02:33:28PM -0500, Brian K. White wrote:
&gt;&gt; On 2/1/2011 12:39 PM, Orion Poplawski wrote:
&gt;&gt;&gt; I'm just starting to take a look at guest networking performance and am
&gt;&gt;&gt; a little disappointed. I'm comparing two setups:
&gt;&gt;&gt; 
&gt;&gt;&gt; Host: Windows Server 2008 R2 Hyper-V
&gt;&gt;&gt; Host: CentOS 5.5 x86_64 kvm running libvirt
&gt;&gt; 
&gt;&gt; First thing is to stop unfairly comparing things that don't even
&gt;&gt; claim to do the same job. hyper-v is a hypervisor, while kvm is not,
&gt;&gt; xen is.
&gt; 
&gt; Hi Brian, I don't want to sound picky, but I did a quick search in the
&gt; KVM documentation and I couldn't find what category KVM is. I really
&gt; thought it was playing the same league as Xen.
&gt; 
&gt; That's from the KVM faq:
&gt; 
&gt; http://www.linux-kvm.org/page/FAQ#What_is_the_difference_between_KVM_and_Xen.3F
&gt; 
&gt;    Xen is an external hypervisor ...
&gt;    On the other hand, KVM is part of Linux and uses the regular Linux
&gt;    scheduler and memory ...
&gt; 
&gt; I just found this Linux Journal article:
&gt; 
&gt; http://www.linuxjournal.com/article/9764
&gt; 
&gt;    KVM is a unique hypervisor. ...

Heh, Brian's email was worded a bit strongly, so may have thrown you onto
the wrong track. ;)

With RHEL *6* (and therefore CentOS 6 when it's released), KVM is production quality.

With the CentOS 5 series though, I'm personally just "not sure".  Maybe Xen is the right
choice for that technology series.

If you want the most up-to-date feature set and best performance, in a RHEL/CentOS
type of distribution, then you probably want to get a hold of RHEL 6 or wait for
CentOS 6 to be released.

As I work for Red Hat, I can find the right sales-y type of contact for you if you want, and
they'll get you access to the RHEL 6 evaluation download.  (I think it's like a 30 day trial version
or something, but I'm not sure... haven't kept up with that side of things.)

Anyway, hope some of that's useful, and happy to find someone for you if needed. :)

Regards and best wishes,

Justin Clift

</body></email><email><emailId>20110103175958</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2011-01-03 17:59:58-0400</timestampReceived><subject>Re: [libvirt-users] availability of snapshots functionality via Python bindings</subject><body>

On 01/03/11 - 06:39:35PM, Marcin Krol wrote:
&gt; -----BEGIN PGP SIGNED MESSAGE-----
&gt; Hash: SHA1
&gt; 
&gt; Hello everyone,
&gt; 
&gt; Is this being worked on? I rather need this thing...
&gt; 
&gt; Although my system is Debian Lenny, not RH:
&gt; 
&gt; 
&gt; kulfon 10.0.0.228 /etc/default % dpkg -l | grep libvirt
&gt; ii  libvirt-bin                          0.4.6-10+lenny1            the
&gt; programs for the libvirt library
&gt; ii  libvirt0                             0.4.6-10+lenny1
&gt; library for interfacing with different virtualization systems
&gt; ii  python-libvirt                       0.4.6-10+lenny1
&gt; libvirt Python bindings

Snapshot support is indeed in the libvirt python bindings already, but you
are using an *ancient* version.  You need at least libvirt 0.8.2 to get
snapshot support.

-- 
Chris Lalancette

</body></email><email><emailId>20110104120455</emailId><senderName>Marcin Krol</senderName><senderEmail>mrkafk@gmail.com</senderEmail><timestampReceived>2011-01-04 12:04:55-0400</timestampReceived><subject>Re: [libvirt-users] availability of snapshots functionality via Python bindings</subject><body>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Chris Lalancette wrote:
&gt; Snapshot support is indeed in the libvirt python bindings already, but you
&gt; are using an *ancient* version.  You need at least libvirt 0.8.2 to get
&gt; snapshot support.

Thanks! That's what I needed to know.

Regarding snapshots themselves: I presume with KVM/QEMU a qcow2 format
of the vm's disk is still required to make snapshots?
	

- --

Regards,
mk

- --
Premature optimization is the root of all fun.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iQEcBAEBAgAGBQJNIwznAAoJEFMgHzhQQ7hOT4MH/jnM/uFqG3qXwKtPXLA0p35Z
S0NC6bXZ58NSum7VSdbzvCWcbWKv+YrCdvMXoV3AZiLyVwylPADwxUmlSktBVO4A
3cd12H1WVihxCE96en3EJX5zy9r9Xj4dureWvZPHJxZrHtKpXs/gBz4wIZZghMp4
AoemWnqNQDPgtmDmYmq482vxQmUk50WAHEDRzB9Ec23xAJfRbVl6EfVQsNuTC4TV
psqUkvHuoWL0hPAci7Nhrpp1ZxXxR+hAHFdImb3mcW/uHZjxcRugd8sRvGhP5IZx
LLiKrqbvQPFtPyyUfdEOCyzPuymNbffIIrerosePw+JeowILqVZQ6VcW6bjacak=
=uP1d
-----END PGP SIGNATURE-----

</body></email><email><emailId>20111205083927</emailId><senderName>Ivars Strazdiņš</senderName><senderEmail>ivars.strazdins@gmail.com</senderEmail><timestampReceived>2011-12-05 08:39:27-0400</timestampReceived><subject>[libvirt-users] libvirt and LXC</subject><body>

Hi there,
I'm fairly new to libvirt and LXC, please forgive my ignorance.
I was looking for a graphical tool to manage LXC containers and noticed 
that libvirt has support for LXC.
Actually, I expected libvirt to be able to display and manage LXC hosts 
much like KVM. But it does not happen this way. The only thing I can see 
with virsh/virt-manager is storage pool with LXC containers, but not 
much else. No information on running/stopped containers or networking.

libvirt is 0.9.7 on both LXC server and client I use to connect to the 
server. I use lxc+ssh for connection.
Am I missing something obvious here? Some configuration file? libvirt 
documentation does not mention any.
Kind regards,
Ivars

[Attachment #3 (text/html)]

&lt;html&gt;
  &lt;head&gt;

    &lt;meta http-equiv="content-type" content="text/html; charset=UTF-8"&gt;
  &lt;/head&gt;
  &lt;body bgcolor="#FFFFFF" text="#000000"&gt;
    &lt;font size="+1"&gt;Hi there,&lt;br&gt;
      I'm fairly new to libvirt and LXC, please forgive my ignorance.&lt;br&gt;
      I was looking for a graphical tool to manage LXC containers and
      noticed that libvirt has support for LXC.&lt;br&gt;
      Actually, I expected libvirt to be able to display and manage LXC
      hosts much like KVM. But it does not happen this way. The only
      thing I can see with virsh/virt-manager is storage pool with LXC
      containers, but not much else. No information on running/stopped
      containers or networking.&lt;br&gt;
    &lt;/font&gt;&lt;br&gt;
    &lt;font size="+1"&gt;libvirt is 0.9.7 on both LXC server and client I use
      to connect to the server. I use lxc+ssh for connection.&lt;br&gt;
      Am I missing something obvious here? Some configuration file?
      libvirt documentation does not mention any.&lt;br&gt;
      Kind regards,&lt;br&gt;
      Ivars&lt;br&gt;
    &lt;/font&gt;
  &lt;/body&gt;
&lt;/html&gt;


</body></email><email><emailId>20111205111529</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-12-05 11:15:29-0400</timestampReceived><subject>Re: [libvirt-users] libvirt and LXC</subject><body>

On Mon, Dec 05, 2011 at 10:39:27AM +0200, Ivars Strazdiņš wrote:
&gt; Hi there,
&gt; I'm fairly new to libvirt and LXC, please forgive my ignorance.
&gt; I was looking for a graphical tool to manage LXC containers and
&gt; noticed that libvirt has support for LXC.
&gt; Actually, I expected libvirt to be able to display and manage LXC
&gt; hosts much like KVM. But it does not happen this way. The only thing
&gt; I can see with virsh/virt-manager is storage pool with LXC
&gt; containers, but not much else. No information on running/stopped
&gt; containers or networking.

virt-manager is able to manage LXC to some degree, you just need to
make sure you tell virt-manager to connect to LXC instead of KVM.

Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110401082031</emailId><senderName>Marcela_Castro_León</senderName><senderEmail>mcastrol@gmail.com</senderEmail><timestampReceived>2011-04-01 08:20:31-0400</timestampReceived><subject>[libvirt-users] Using Restore</subject><body>

Hello:
I'm developing a fault tolerance system, and I'm trying to use save/restore
operation.

But it's working fine when I restore the file saved on the same guest, but
If I move it to another host, and then try to restore using the file
previously saved I got this error.
I ask for help to know if this kind of operation is allows, and if it is,
how can I do to work it.

The exactly sequence using virsh I've test is:
On [HOST1]: Using virsh
1) save [domain] [file]
2) restore file
3) destroy [domain]

On [HOST1] using ubuntu sh
4) cp [guest.img] [guest.xml] [file] to HOST2

On [HOST2] using virsh
5) define [guest.xml] (using image on destination in HOST2)
6) restore [file]

The restore troughs the following message:
*virsh # restore sv-chubut-2011-04-01-09:58
error: Failed to restore domain from sv-chubut-2011-04-01-09:58
error: monitor socket did not show up.: Connection refused*

Thank you very much.

Marcela.

[Attachment #3 (text/html)]

Hello:&lt;br&gt;I'm developing a fault tolerance system, and I'm trying to use \
save/restore operation.&lt;br&gt;&lt;br&gt;But it's working fine when I restore the file \
saved on the same guest, but If I move it to another host, and then try to restore \
using the file previously saved I got this error.&lt;br&gt;

I ask for help to know if this kind of operation is allows, and if it is, how can I \
do to work it.&lt;br&gt;&lt;br&gt;The exactly sequence using virsh I've test is:&lt;br&gt;On \
[HOST1]: Using virsh&lt;br&gt;1) save [domain] [file]            &lt;br&gt;

2) restore file&lt;br&gt;3) destroy [domain]&lt;br&gt;&lt;br&gt;On [HOST1] using ubuntu sh&lt;br&gt;4) cp \
[guest.img] [guest.xml] [file] to HOST2&lt;br&gt;&lt;br&gt;On [HOST2] using virsh&lt;br&gt;5) define \
[guest.xml] (using image on destination in HOST2)&lt;br&gt;6) restore [file]&lt;br&gt;

&lt;br&gt;The restore troughs the following message: &lt;br&gt;&lt;div style="margin-left: \
40px;"&gt;&lt;b&gt;&lt;i&gt;virsh # restore sv-chubut-2011-04-01-09:58&lt;/i&gt;&lt;br&gt;&lt;i&gt;error: Failed to \
restore domain from sv-chubut-2011-04-01-09:58&lt;/i&gt;&lt;br&gt;&lt;i&gt;error: monitor socket did \
not show up.: Connection refused&lt;/i&gt;&lt;/b&gt;&lt;br&gt; &lt;/div&gt;&lt;br&gt;Thank you very \
much.&lt;br&gt;&lt;br&gt;Marcela.&lt;br&gt;&lt;br&gt;



</body></email><email><emailId>20110401195036</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2011-04-01 19:50:36-0400</timestampReceived><subject>Re: [libvirt-users] bridge and route without IP</subject><body>

On 03/31/2011 04:29 PM, Robert Šmol wrote:
&gt; Hi,
&gt; I want to forward all traffic received on eth1 into virtual domain 
&gt; 'firewall' (where I want to configure public IP+shorewall)
&gt;
&gt; I've created following network:
&gt;
&gt; node002 qemu # cat networks/int-001.xml
&gt; &lt;network&gt;
&gt; &lt;name&gt;int-001&lt;/name&gt;
&gt; &lt;bridge name="intbr0" /&gt;
&gt; &lt;forward mode="route" device="eth1"/&gt;
&gt; &lt;/network&gt;
&gt;
&gt; virsh # net-create networks/int-001.xml
&gt; error: Failed to create network from networks/int-001.xml
&gt; error: internal error Forwarding requested, but no IP address provided

You don't want to setup a virtual network for this type of configuration 
- a libvirt virtual network is in reality a bridge device that is only 
connected to guest interfaces, not to any physical interface. Because no 
physical device is connected to that bridge, the only way out to the 
rest of the world is via the host's IP routing, and in order for the 
bridge to participate in routing, it must have an IP address assigned to 
it (and the guests must be on the same subnet as that IP address). So, 
not only will a virtual network not give you the functionality you want, 
also you are trying to configure the virtual network in an unusable 
manner (you say you want it to forward, but you don't give it an IP 
address, which it needs in order to participate in IP routing).

&gt;
&gt; But wan to set the public IP on the Firewall side. How do I do that? 
&gt; Would the macvtap help me?

Yes, you need to either use macvtap (if your kernel supports it) and 
don't configure an IP address for eth1 on the host, or configure a 
bridge that's directly connected to eth1, don't supply that bridge with 
any IP address (so the host can't directly talk through it), and connect 
the guest to the bridge. macvtap will be simpler and more efficient (if 
you have it :-))

</body></email><email><emailId>20110404105413</emailId><senderName>Francesc Guasch</senderName><senderEmail>frankie@etsetb.upc.edu</senderEmail><timestampReceived>2011-04-04 10:54:13-0400</timestampReceived><subject>Re: [libvirt-users] LIBVIRT migration</subject><body>

Al 01/04/11 22:29, En/na Marcela Castro León ha escrit:
&gt; Hello:
&gt; I've installed the package kvm-pxe on target host, and the error
&gt; /*pci_add_option_rom: failed to find romfile "pxe-virtio.bin" */dissappeared
&gt; from the log, but the migrate still doesn't work, and it continue saying:

Hi, try installing the kvm-pxe package with apt-get.

</body></email><email><emailId>20110404133058</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2011-04-04 13:30:58-0400</timestampReceived><subject>[libvirt-users] Release of libvirt-0.9.0</subject><body>

  As scheduled, libvirt 0.9.0 was tagged and pushed today, it's
available from FTP at:
    ftp://libvirt.org/libvirt/

  This is a large release w.r.t. the amount of features and changes,
and well worth bumping the middle version number. We are also getting
closer to a 1.0.0 release !

Features:
- Support cputune cpu usage tuning (Osier Yang and Nikunj A. Dadhania)
- Add public APIs for storage volume upload/download (Daniel P. Berrange)
- Add public API for setting migration speed on the fly (Daniel P. Berrange)
- Add libxenlight driver (Jim Fehlig and Markus Groß)
- qemu: support migration to fd (Eric Blake)
- libvirt: add virDomain{Get,Set}BlkioParameters (Gui Jianfeng)
- setmem: introduce a new libvirt API (virDomainSetMemoryFlags) (Taku Izumi)
- Expose event loop implementation as a public API (Daniel P. Berrange)
- Dump the debug buffer to libvirtd.log on fatal signal (Daniel Veillard)
- Audit support (Eric Blake)

Documentation:
- fix typo (Eric Blake)
- correct invalid xml (Eric Blake)
- virsh: Fix documentation for memtune command (Jiri Denemark)
- Fix several formatting mistakes in doc (Michal Privoznik)
- mention C89 syntax preferences (Eric Blake)
- document recent hook additions (Eric Blake)
- Update on the goal page (Daniel Veillard)
- Document first release with spice and qxl (Cole Robinson)
- Add schema definition for imagelabel (Osier Yang)
- update virGetVersion description (Tiziano Mueller)
- Improve logging documentation including the debug buffer (Daniel Veillard)
- update windows page for initial libvirt 0.8.8 installer (Justin Clift)
- formatdomain.html.in: Fix spelling PIC-&gt;PCI (Philipp Hahn)
- fix missing &lt;/p&gt; (Eric Blake)
- documenting the 802.1Qbg parameters of a 'direct' interface (Gerhard Stenzel)
- silence warnings about generated API docs (Eric Blake)
- document &lt;driver name='vhost'/&gt; for interfaces (Eric Blake)
- correct range of default NAT subnet (Eric Blake)
- formatdomain: Add release info for disk &lt;driver&gt; attributes (Cole Robinson)
- Fix spelling mistake: seek (Philipp Hahn)
- maint: fix grammar in error message (Eric Blake)

Portability:
- virsh: fix mingw failure on creating nonblocking pipe (Eric Blake)
- Remove iohelper on Win32 since it is not required (Daniel P. Berrange)
- Fix domain events C example on Win32 (Daniel P. Berrange)
- build: fix compilation on mingw (Eric Blake)
- util: use SCM_RIGHTS in virFileOperation when needed (Eric Blake)
- Don't use INT64_MAX in libvirt.h because it requires stdint.h (Matthias Bolte)
- libvirtd: Remove indirect linking (Guido Günther)
- build: avoid compiler warning on cygwin (Eric Blake)
- build: fix build on cygwin (Eric Blake)
- build: fix building error when building without libvirtd (Wen Congyang)
- virsh: Remove indirect link against libxml2 (Guido Günther)
- Fix build on cygwin (Daniel Veillard)
- Add check for kill() to fix build of cgroups on win32 (Daniel P. Berrange)
- build: fix broken mingw cross-compilation (Eric Blake)

Bug fixes:
- fix memory leak in qemuProcessHandleGraphics() (Wen Congyang)
- do not lock vm while allocating memory (Wen Congyang)
- Fix libxl driver startup (Daniel Veillard)
- qemu: Ignore libvirt debug messages in qemu log (Jiri Denemark)
- qemu: Fix improper logic of qemuCgroupSetup (Osier Yang)
- free tmp after unlinking it (Wen Congyang)
- qemu: Fix media eject with qemu-0.12.* (Jiri Denemark)
- check whether qemuMonitorJSONHMP() failed (Wen Congyang)
- do not send monitor command after monitor meet error (Wen Congyang)
- qemu: unlock qemu driver before return from domain save (Hu Tao)
- qemu: fix regression with fd labeling on migration (Eric Blake)
- Ignore return value of virDomainObjUnref (Markus Groß)
- Fix infinite loop in daemon if client quits with multiple streams open (Daniel P. \
                Berrange)
- qemu: fix regression that hangs on save failure (Eric Blake)
- qemu: fix restoring a compressed save image (Eric Blake)
- util: allow clearing cloexec bit (Eric Blake)
- logging: always NUL-terminate circular buffer (Eric Blake)
- tests: don't alter state in $HOME (Eric Blake)
- qemu: don't restore state label twice (Eric Blake)
- Fix syntax error in configure.ac (Osier Yang)
- remote: Don't leak gnutls session on negotiation error (Matthias Bolte)
- hooks: fix regression in previous patch (Eric Blake)
- Add missing { for qemudDomainInterfaceStats (Philipp Hahn)
- daemon: Avoid resetting errors before they are reported (Jiri Denemark)
- fix the check of the output of monitor command 'device_add' (Wen Congyang)
- Make error reporting in libvirtd thread safe (Jiri Denemark)
- update domain status forcibly even if attach a device failed (Wen Congyang)
- util: Fix return value for virJSONValueFromString if it fails (Osier Yang)
- Initialization error of qemuCgroupData in Qemu host usb hotplug (Wen Congyang)
- build: fix missing initializer (Eric Blake)
- Fix uninitialized variable &amp; error reporting in LXC veth setup (Daniel P. Berrange)
- udev: fix regression with qemu:///session (Eric Blake)
- logging: fix off-by-one bug (Eric Blake)
- do not report OOM error when prepareCall() failed (Wen Congyang)
- Don't return an error on failure to create blkio controller (Hu Tao)
- qemu: respect locking rules (Eric Blake)
- openvz: fix a simple bug in openvzListDefinedDomains() (Jean-Baptiste Rouault)
- Fix delayed event delivery when SASL is active (Daniel P. Berrange)
- qemu: Fix copy&amp;paste error messages in text monitor (Jiri Denemark)
- do not unref obj in qemuDomainObjExitMonitor* (Wen Congyang)
- qemu: check driver name while attaching disk (Wen Congyang)
- remote: Add missing virCondDestroy calls (Matthias Bolte)
- build: improve rpm generation for distro backports (Eric Blake)
- storage: Fix a problem which will cause libvirtd crashed (Osier Yang)
- Fix misc bugs in virCommandPtr (Daniel P. Berrange)
- libvirt: fix a simple bug in virDomainSetMemoryFlags() (Taku Izumi)
- qemu: Check the unsigned integer overflow (Osier Yang)
- audit: eliminate potential null pointer deref when auditing macvtap devices (Laine \
                Stump)
- network driver: don't send default route to clients on isolated networks (Laine \
                Stump)
- virsh: Free stream when shutdown console (Osier Yang)
- Add missing checks for read only connections (Guido Günther)
- qemu: fix -global argument usage (Eric Blake)
- Make sure we reset the umask on the error path (Guido Günther)
- qemu: Stop guest CPUs before creating a snapshot (Jiri Denemark)
- qemu: Escape snapshot name passed to {save,load,del}vm (Jiri Denemark)
- qemu: Fix warnings in event handlers (Jiri Denemark)
- storage: Update qemu-img flag checking (Osier Yang)
- Make sure the rundir is accessible by the user (Guido Günther)
- Fix a wrong error message thrown to user (Hu Tao)
- unlock eventLoop before calling callback function (Wen Congyang)
- fixes for several memory leaks (Phil Petty)
- Fix a counter bug in the log buffer (Daniel Veillard)
- qemu: avoid corruption of domain hashtable and misuse of freed domains (Laine \
                Stump)
- qemu: Add missing lock of virDomainObj before calling virDomainUnref (Laine Stump)
- esx: Escape password for XML (Matthias Bolte)
- util: correct retry path in virFileOperation (Eric Blake)
- util: Allow removing hash entries in virHashForEach (Jiri Denemark)
- qemu: avoid double close on domain restore (Eric Blake)
- Fix port value parsing for serial and parallel ports (Michal Novotny)
- Fix off-by-1 in virFileAbsPath. (Daniel P. Berrange)
- security: avoid memory leak (Eric Blake)
- protect the scsi controller to be deleted when it is in use (Wen Congyang)
- virsh: freecell --all getting wrong NUMA nodes count (Michal Privoznik)
- remove duplicated call to reportOOMError (Christophe Fergeau)

Improvements:
- Make check_fc_host() and check_vport_capable() usable as rvalues (Guido Günther)
- maint: avoid locale-sensitivity in string case comparisons (Eric Blake)
- extend logging to record configuration-related changes (Naoya Horiguchi)
- Add libvirt_iohelper to spec file (Daniel Veillard)
- cputune: New tests for cputune XML (Osier Yang)
- cputune: Support cputune for xend driver (Osier Yang)
- cputune: Support cputune for lxc driver (Osier Yang)
- cputune: Support cputune for qemu driver (Osier Yang)
- cputune: Implementations of parsing and formating cputune xml (Osier Yang)
- cputune: Add data structures presenting cputune XML (Osier Yang)
- cputune: Add document for cputune XML (Osier Yang)
- cputune: Add XML schema for cputune xml (Osier Yang)
- qemu: improve error message on failed fd transfer (Eric Blake)
- maint: ignore new built file (Eric Blake)
- Add domainSuspend/Resume to libxl driver (Markus Groß)
- Add domainGetOSType to libxl driver (Markus Groß)
- Add domainGetSchedulerType to libxl driver (Markus Groß)
- Implements domainXMLTo/FromNative in libxl driver (Markus Groß)
- Add vcpu functions to libxl driver (Markus Groß)
- List authors in copyright headers (Markus Groß)
- Add event callbacks to libxl driver (Markus Groß)
- Remote protocol support for storage vol upload/download APIs (Daniel P. Berrange)
- Support volume data upload/download APIs in storage driver (Daniel P. Berrange)
- Add vol-upload and vol-download commands to virsh (Daniel P. Berrange)
- Enhance the streams helper to support plain file I/O (Daniel P. Berrange)
- Update event loop example programs to demonstrate best practice (Daniel P. \
                Berrange)
- qemu: support fd: migration with compression (Eric Blake)
- qemu: skip granting access during fd migration (Eric Blake)
- qemu: consolidate migration to file code (Eric Blake)
- qemu: use common API for reading difficult files (Eric Blake)
- qemu, storage: improve type safety (Eric Blake)
- util: adjust indentation in previous patch (Eric Blake)
- util: rename virFileOperation to virFileOpenAs (Eric Blake)
- storage: simplify fd handling (Eric Blake)
- qemu: simplify domain save fd handling (Eric Blake)
- qemu: allow simple domain save to use fd: protocol (Eric Blake)
- Update of localisations, switch to transifex (Daniel Veillard)
- build: shorten libxenlight summary for consistent alignment (Eric Blake)
- command: add virCommandAbort for cleanup paths (Eric Blake)
- command: don't mix RunAsync and daemons (Eric Blake)
- command: properly diagnose process exit via signal (Eric Blake)
- Add memory functions to libxl driver (Markus Groß)
- build: enforce reference count checking (Eric Blake)
- maint: prohibit access(,X_OK) (Eric Blake)
- Get cpu time and current memory balloon from libxl (Markus Groß)
- build: nuke all .x-sc* files, and fix VPATH syntax-check (Eric Blake)
- command: reject pidfile on non-daemon (Eric Blake)
- rpm: add missing dependencies (Eric Blake)
- rpm: separate runtime and build requirements (Eric Blake)
- qemu: simplify monitor callbacks (Eric Blake)
- 8021Qbh: use preassociate-rr during the migration prepare stage (Roopa Prabhu)
- Wire up virDomainMigrateSetSpeed into QEMU driver (Daniel P. Berrange)
- Wire up virDomainMigrateSetSpeed for the remote RPC driver (Daniel P. Berrange)
- maint: update authors (Eric Blake)
- Disable libxl build in RPM on Fedora &lt; 16 (Daniel P. Berrange)
- qemu: fallback to HMP drive_add/drive_del (Hu Tao)
- qemu: Only use HMP passthrough if it is supported (Jiri Denemark)
- qemu: Detect support for HMP passthrough (Jiri Denemark)
- qemu: add two hook script events "prepare" and "release" (Thibault Vincent)
- qemu: simplify interface fd handling in monitor (Eric Blake)
- qemu: simplify PCI configfd handling in monitor (Eric Blake)
- qemu: simplify monitor fd error handling (Eric Blake)
- util: guarantee sane errno in virFileIsExecutable (Eric Blake)
- Don't build libxenlight driver for Xen 4.0 (Jim Fehlig)
- network driver: log error and abort network startup when radvd isn't found (Laine \
                Stump)
- build: translate changes in previous patch (Eric Blake)
- Ensure binary is resolved wrt $PATH in virExec (Daniel P. Berrange)
- util: Forbid calling hash APIs from iterator callback (Jiri Denemark)
- Avoid taking lock in libvirt debug dump (Daniel Veillard)
- unlock the monitor when unwatching the monitor (Wen Congyang)
- Add vim configuration that makes vim auto-indent code (Hu Tao)
- virsh: fix memtune's help message for swap_hard_limit (Nikunj A. Dadhania)
- Add PCI sysfs reset access (Alex Williamson)
- Support Xen sysctl v8, domctl v7 (Jim Fehlig)
- macvtap: log an error if on failure to connect to netlink socket (Laine Stump)
- qemu: improve efficiency of dd during snapshots (Eric Blake)
- virsh: allow empty string arguments (Eric Blake)
- qemu: Fallback to HMP when cpu_set QMP command is not found (Wen Congyang)
- Change message for VIR_FROM_RPC error domain (Daniel P. Berrange)
- Add compat function for geteuid() (Daniel P. Berrange)
- Add virSetBlocking() to allow O_NONBLOCK to be toggle on or off (Daniel P. \
                Berrange)
- qemu: use more appropriate error (Eric Blake)
- Make LXC container startup/shutdown/I/O more robust (Daniel P. Berrange)
- Allow to dynamically set the size of the debug buffer (Daniel Veillard)
- qemu: consolidate duplicated monitor migration code (Eric Blake)
- qemu: use lighter-weight fd:n on incoming tunneled migration (Eric Blake)
- Fix performance problem of virStorageVolCreateXMLFrom() (Minoru Usui)
- libvirt-guests: avoid globbing when splitting $URIS (Eric Blake)
- libvirt-guest.init: quoting variables (Philipp Hahn)
- virsh: Insert error messages to avoid a quiet abortion of commands (Michal \
                Privoznik)
- python: Use hardcoded python path in libvirt.py (Jiri Denemark)
- virsh: Allow starting domains by UUID (Jiri Denemark)
- network driver: Use a separate dhcp leases file for each network (Laine Stump)
- network driver: Start dnsmasq even if no dhcp ranges/hosts are specified. (Laine \
                Stump)
- libvirt-guest.init: handle domain name with spaces (Philipp Hahn)
- domain.rng vs. formatdomain.html#elementsUSB (Philipp Hahn)
- Ignore backing file errors in FS storage pool (Philipp Hahn)
- remote-protocol: implement new BlkioParameters API (Gui Jianfeng)
- virsh: Adding blkiotune command to virsh tool (Gui Jianfeng)
- qemu: implement new BlkioParameters API (Gui Jianfeng)
- libvirt: implements virDomain{Get,Set}BlkioParameters (Gui Jianfeng)
- setmem: add the new options to "virsh setmem" command (Taku Izumi)
- setmem: implement the remote protocol to address the new API (Taku Izumi)
- setmem: implement the code to address the new API in the qemu driver (Taku Izumi)
- audit: audit use of /dev/net/tun, /dev/tapN, /dev/vhost-net (Eric Blake)
- qemu: don't request cgroup ACL access for /dev/net/tun (Eric Blake)
- qemu: support vhost in attach-interface (Eric Blake)
- qemu: Refactor qemuDomainSnapshotCreateXML (Jiri Denemark)
- qemu: Fallback to HMP for snapshot commands (Jiri Denemark)
- qemu: Setup infrastructure for HMP passthrough (Jiri Denemark)
- qemu: Replace deprecated option of qemu-img (Osier Yang)
- audit: also audit cgroup ACL permissions (Eric Blake)
- cgroup: allow fine-tuning of device ACL permissions (Eric Blake)
- audit: rename remaining qemu audit functions (Eric Blake)
- audit: also audit cgroup controller path (Eric Blake)
- audit: split cgroup audit types to allow more information (Eric Blake)
- audit: tweak audit messages to match conventions (Eric Blake)
- Don't overwrite virRun error messages (Cole Robinson)
- virsh: Change option parsing functions to return tri-state information (Michal \
                Privoznik)
- virsh: change vshCommandOptString return type and fix const-correctness (Michal \
                Privoznik)
- support to detach USB disk (Wen Congyang)
- rename qemuDomainDetachSCSIDiskDevice to qemuDomainDetachDiskDevice (Wen Congyang)
- qemu_hotplug: Reword error if spice password change not available (Cole Robinson)
- Move event code out of the daemon/ into src/util/ (Daniel P. Berrange)
- Convert daemon/virsh over to use primary event APIs, rather than impl (Daniel P. \
                Berrange)
- Cleaning up some of the logging code (Daniel Veillard)
- qemu: Support vram for video of qxl type (Osier Yang)
- Add an an internal API for emergency dump of debug buffer (Daniel Veillard)
- Add logrotate support for libvirtd.log (Daniel Veillard)
- Change default log policy to libvirtd.log instead of syslog (Daniel Veillard)
- Force all logs to go to the round robbin memory buffer (Daniel Veillard)
- AUTHORS: adjust to preferred spelling (KAMEZAWA Hiroyuki)
- Pass virSecurityManagerPtr to virSecurityDAC{Set, Restore}ChardevCallback (Soren \
                Hansen)
- maint: update to latest gnulib (Eric Blake)
- Attempt to improve an error message (Daniel P. Berrange)
- add additional event debug points (Daniel P. Berrange)
- qemu: only request sound cgroup ACL when required (Eric Blake)
- Add support for multiple serial ports into the Xen driver (Michal Novotny)
- Add APIs for killing off processes inside a cgroup (Daniel P. Berrange)
- Allow hash tables to use generic pointers as keys (Daniel P. Berrange)
- Remove deallocator parameter from hash functions (Daniel P. Berrange)
- Make commandtest more robust wrt its execution environment (Daniel P. Berrange)
- audit: audit qemu pci and usb device passthrough (Eric Blake)
- audit: audit qemu memory and vcpu adjusments (Eric Blake)
- audit: add qemu hooks for auditing cgroup events (Eric Blake)
- audit: prepare qemu for listing vm in cgroup audits (Eric Blake)
- cgroup: determine when skipping non-devices (Eric Blake)
- virExec: avoid uninitialized memory usage (Eric Blake)
- Allow 32-on-64 execution for LXC guests (Daniel P. Berrange)
- Put &lt;stdbool.h&gt; into internal.h so it is available everywhere (Daniel P. Berrange)
- qemu: Switch over command line capabilities to virBitmap (Jiri Denemark)
- qemu: Rename qemud\?CmdFlags to qemuCaps (Jiri Denemark)
- qemu: Use helper functions for handling cmd line capabilities (Jiri Denemark)
- qemu: Rename QEMUD_CMD_FLAG_* to QEMU_CAPS_* (Jiri Denemark)
- util: Add API for converting virBitmap into printable string (Jiri Denemark)
- util: Use unsigned long as a base type for virBitmap (Jiri Denemark)
- Expose name + UUID to LXC containers via env variables (Daniel P. Berrange)
- Fix discard of expected errors (Daniel P. Berrange)
- Fix group/mode for /dev/pts inside LXC container (Daniel P. Berrange)
- 802.1Qbh: Delay IFF_UP'ing interface until migration final stage (Roopa Prabhu)
- storage: make debug log more useful (Osier Yang)
- virsh: replace vshPrint with vshPrintExtra for snapshot list Otherwise extra \
                information will be printed even if "--quiet" is specified. (Osier \
                Yang)
- check device-mapper when building with mpath or disk storage driver (Wen Congyang)
- build: add dependency on gnutls-utils (Eric Blake)
- Renamed functions in xenxs (Markus Groß)
- Moved XM formatting functions to xenxs (Markus Groß)
- Moved XM parsing functions to xenxs (Markus Groß)
- Moved SEXPR formatting functions to xenxs (Markus Groß)
- Moved SEXPR parsing functions to xenxs (Markus Groß)
- Moved some SEXPR functions from xen-unified (Markus Groß)
- Moved SEXPR unit to utils (Markus Groß)
- virt-*-validate.in: quote all variable references (Dan Kenigsberg)
- virt-pki-validate: behave when CERTTOOL is missing (Dan Kenigsberg)
- autobuild.sh: use VPATH build (Eric Blake)
- maint: fix 'make dist' in VPATH build (Eric Blake)
- build: don't require pod2man for tarball builds (Eric Blake)
- hash: make virHashFree more free-like (Eric Blake)
- build: Fix API docs generation in VPATH build (Jiri Denemark)
- Remove all object hashtable caches from virConnectPtr (Daniel P. Berrange)
- nwfilter: enable rejection of packets (Stefan Berger)
- Drop empty argument from dnsmasq call (Guido Günther)
- esx: Ignore malformed host UUID from BIOS (Matthias Bolte)
- build: speed up non-maintainer builds (Eric Blake)
- build: recompute symbols after changing configure options (Eric Blake)
- Requires gettext for client package (Osier Yang)
- Do not add drive 'boot=on' param when a kernel is specified (Jim Fehlig)
- factor common code in virHashAddEntry and virHashUpdateEntry (Christophe Fergeau)
- add hash table rebalancing in virHashUpdateEntry (Christophe Fergeau)
- hash: modernize debug code (Eric Blake)
- build: improve 'make install' for VPATH builds (Eric Blake)
- check more error info about whether drive_add failed (Wen Congyang)
- logging: make VIR_ERROR and friends preserve errno (Eric Blake)
- maint: avoid 'make syntax-check' from tarball (Eric Blake)
- Give each virtual network bridge its own fixed MAC address (Laine Stump)
- Allow brAddTap to create a tap device that is down (Laine Stump)
- Add txmode attribute to interface XML for virtio backend (Laine Stump)
- Restructure domain struct interface "driver" data for easier expansion (Laine \
                Stump)
- build: Fix VPATH build (Jiri Denemark)
- storage: Allow to delete device mapper disk partition (Osier Yang)

Cleanups:
- The next release is 0.9.0 not 0.8.9 (Daniel Veillard)
- maint: use space, not tab, in remote_protocol-structs (Eric Blake)
- Remove the Open Nebula driver (Daniel P. Berrange)
- domain_conf: drop unused ref-count in snapshot object (Eric Blake)
- Update the set of maintainers for the project (Daniel Veillard)
- Make virDomainObjParseNode() static (Hu Tao)
- maint: make spacing in .sh files easier (Eric Blake)
- network driver: Fix indentation from previous commit (Laine Stump)
- qemu: Rename qemuMonitorCommandWithHandler as qemuMonitorText* (Jiri Denemark)
- qemu: Rename qemuMonitorCommand{,WithFd} as qemuMonitorHMP* (Jiri Denemark)
- maint: avoid long lines in more tests (Eric Blake)
- maint: kill all remaining uses of old DEBUG macro (Eric Blake)
- maint: Expand tabs in python code (Jiri Denemark)
- remove space between function name and ( (Christophe Fergeau)
- don't check for NULL before calling virHashFree (Christophe Fergeau)
- remove no longer needed calls to virReportOOMError (Christophe Fergeau)
- Move all the QEMU migration code to a new file (Daniel P. Berrange)
- Split all QEMU process mangement code into separate file (Daniel P. Berrange)


  Thanks to everybody who helped one way or another for this release !

Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/


</body></email><email><emailId>20110404203609</emailId><senderName>Alex</senderName><senderEmail>mysqlstudent@gmail.com</senderEmail><timestampReceived>2011-04-04 20:36:09-0400</timestampReceived><subject>[libvirt-users] iptables errors with guest</subject><body>

Hi,

I've just set up a fedora14 guest on a fedora14 server, and just
noticed the following in messages:

Apr  4 16:29:50 fc14 libvirtd: 16:29:50.767: error :
virRunWithHook:857 : internal error '/sbin/iptables --table mangle
--delete POSTROUTING --out-interface virbr0 --protocol udp
--destination-port 68 --jump CHECKSUM --checksum-fill' exited with
non-zero status 2 and signal 0: iptables v1.4.9: unknown option
`--checksum-fill'#012Try `iptables -h' or 'iptables --help' for more
information.#012
Apr  4 16:29:50 fc14 libvirtd: 16:29:50.840: error :
virRunWithHook:857 : internal error '/sbin/iptables --table filter
--delete INPUT --in-interface virbr0 --protocol udp --destination-port
69 --jump ACCEPT' exited with non-zero status 1 and signal 0:
iptables: Bad rule (does a matching rule exist in that chain?).#012
Apr  4 16:29:50 fc14 libvirtd: 16:29:50.990: error :
virRunWithHook:857 : internal error '/sbin/iptables --table mangle
--insert POSTROUTING --out-interface virbr0 --protocol udp
--destination-port 68 --jump CHECKSUM --checksum-fill' exited with
non-zero status 2 and signal 0: iptables v1.4.9: unknown option
`--checksum-fill'#012Try `iptables -h' or 'iptables --help' for more
information.#012
Apr  4 16:29:50 fc14 libvirtd: 16:29:50.990: warning :
networkAddIptablesRules:850 : Could not add rule to fixup DHCP
response checksums on network 'default'.
Apr  4 16:29:50 fc14 libvirtd: 16:29:50.990: warning :
networkAddIptablesRules:851 : May need to update iptables package &amp;
kernel to support CHECKSUM rule.

Is this something I'm doing wrong or is it a known problem? I have a
basic understanding of the iptables rules that libvirtd, but not
enough to troubleshoot this. What other information can I provide to
help troubleshoot this?

Thanks,
Alex

</body></email><email><emailId>20110405001742</emailId><senderName>Alex</senderName><senderEmail>mysqlstudent@gmail.com</senderEmail><timestampReceived>2011-04-05 00:17:42-0400</timestampReceived><subject>[libvirt-users] Creating a network bridge with multiple interfaces</subject><body>

Hi,
I have an existing fedora14 system with two interfaces and several
virtual interfaces (as in eth0:0, etc). They are currently configured
to not be controlled by NetworkManager, but just standard network
services.

I've recently started working with libvirtd, so I also have a virbr0
interface as well that has its own network and is masquerading the
networking for the single KVM instance I have running.

I would now like to create another instance that is not masqueraded,
but instead uses another virtual interface, such as eth0:1, which is
an Internet-addressable IP address. When I try to do this,
virt-manager seems to still configure it using NAT.

I think the right way to do this is to convert the eth* instances to
instead use a real bridge, correct? How can I do this?

Below is the output from ifconfig on my system:

eth0      Link encap:Ethernet  HWaddr 40:61:86:4E:84:09
          inet addr:XX.195.193.YY  Bcast:XX.195.193.YY  Mask:255.255.255.248
          inet6 addr: fe80::4261:86ff:fe4e:8409/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:204613580 errors:0 dropped:0 overruns:0 frame:0
          TX packets:220748087 errors:0 dropped:0 overruns:0 carrier:1
          collisions:0 txqueuelen:1000
          RX bytes:146443250035 (136.3 GiB)  TX bytes:207505258199 (193.2 GiB)
          Interrupt:42

eth0:0    Link encap:Ethernet  HWaddr 40:61:86:4E:84:09
          inet addr:XX.195.193.ZZ  Bcast:XX.195.193.YY  Mask:255.255.255.248
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          Interrupt:42

eth1      Link encap:Ethernet  HWaddr 00:0E:0C:3B:36:F4
          inet addr:192.168.1.1  Bcast:192.168.1.255  Mask:255.255.255.0
          inet6 addr: fe80::20e:cff:fe3b:36f4/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:241615579 errors:6 dropped:0 overruns:0 frame:3
          TX packets:230218850 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:210464139370 (196.0 GiB)  TX bytes:171698241573 (159.9 GiB)

eth1:0    Link encap:Ethernet  HWaddr 00:0E:0C:3B:36:F4
          inet addr:192.168.1.2  Bcast:192.168.1.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1

eth1:1    Link encap:Ethernet  HWaddr 00:0E:0C:3B:36:F4
          inet addr:192.168.1.100  Bcast:192.168.1.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:3439643 errors:0 dropped:0 overruns:0 frame:0
          TX packets:3439643 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:849466836 (810.1 MiB)  TX bytes:849466836 (810.1 MiB)

virbr0    Link encap:Ethernet  HWaddr 00:00:00:00:00:00
          inet addr:192.168.125.1  Bcast:192.168.125.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:16 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:3088 (3.0 KiB)  TX bytes:0 (0.0 b)

Thanks for any ideas.
Alex

</body></email><email><emailId>20110405024352</emailId><senderName>Marc Seward</senderName><senderEmail>linuxuser26@gmail.com</senderEmail><timestampReceived>2011-04-05 02:43:52-0400</timestampReceived><subject>Re: [libvirt-users] Protocols used for migration</subject><body>

Could someone confirm if tunneled (encrypted) and tcp (unencrypted) are the
only supported protocols for live migration of KVM guests.In the example
posted in my earlier mail,a separate process is being spawned by qemu-kvm to
perform migration.Does the qemu migrate command always spawn a separate
process?

Additionally,I'd like to know if there's a way I can check the QEMU monitor
command and parameters passed to the QEMU monitor command when a command is
executed through virsh.

Thanks,
Marc

On Mon, Apr 4, 2011 at 5:29 PM, linux user &lt;linuxuser26@gmail.com&gt; wrote:

&gt; Hi all,
&gt;
&gt; I'd like to know what are the different protocols used for migration of KVM
&gt; guests on RHEL hosts.I'm actually interested in 'virsh dump' and virsh dump
&gt; executes the qemu 'migrate' command.I understand 'exec' is one of the
&gt; protocols.
&gt; Appreciate any pointers.
&gt;
&gt; For eg:(qemu) migrate -d "exec:cat &gt;'/tmp/vm'"
&gt;
&gt; Thanks,
&gt; Marc
&gt;
&gt;

[Attachment #3 (text/html)]

&lt;br&gt;Could someone confirm if tunneled (encrypted) and tcp (unencrypted) are the only \
supported protocols for live migration of KVM guests.In the example posted in my \
earlier mail,a separate process is being spawned by qemu-kvm to perform \
migration.Does the qemu migrate command always spawn a separate process?&lt;br&gt; \
&lt;br&gt;Additionally,I'd like to know if there's a way I can check the QEMU \
monitor command and parameters passed to the QEMU monitor command when a command is \
executed through virsh.&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;Marc&lt;br&gt; &lt;h1 class="ha"&gt;&lt;span id=":xe" \
class="hP"&gt;&lt;/span&gt;&lt;/h1&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Mon, Apr 4, 2011 at 5:29 PM, \
linux user &lt;span dir="ltr"&gt;&lt;&lt;a href="mailto:linuxuser26@gmail.com" \
target="_blank"&gt;linuxuser26@gmail.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt; &lt;blockquote \
class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, \
204, 204); padding-left: 1ex;"&gt; Hi all,&lt;br&gt;&lt;br&gt;I'd like to know what are the \
different protocols used for migration of  KVM guests on RHEL hosts.I'm actually \
interested in 'virsh dump' and  virsh dump executes the qemu \
'migrate' command.I understand 'exec' is  one of the protocols.&lt;br&gt;
Appreciate any pointers.&lt;br&gt;
&lt;br&gt;
&lt;pre&gt;For eg:(qemu) migrate -d "exec:cat \
&gt;'/tmp/vm'"&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;Marc&lt;br&gt;&lt;/pre&gt; &lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110404212953</emailId><senderName>linux user</senderName><senderEmail>linuxuser26@gmail.com</senderEmail><timestampReceived>2011-04-04 21:29:53-0400</timestampReceived><subject>[libvirt-users] Protocols used for migration</subject><body>

Hi all,

I'd like to know what are the different protocols used for migration of KVM
guests on RHEL hosts.I'm actually interested in 'virsh dump' and virsh dump
executes the qemu 'migrate' command.I understand 'exec' is one of the
protocols.
Appreciate any pointers.

For eg:(qemu) migrate -d "exec:cat &gt;'/tmp/vm'"

Thanks,
Marc

[Attachment #3 (text/html)]

Hi all,&lt;br&gt;&lt;br&gt;I'd like to know what are the different protocols used for \
migration of  KVM guests on RHEL hosts.I'm actually interested in 'virsh \
dump' and  virsh dump executes the qemu 'migrate' command.I understand \
'exec' is  one of the protocols.&lt;br&gt;
Appreciate any pointers.&lt;br&gt;
&lt;br&gt;
&lt;pre class="bz_comment_text" id="comment_text_0"&gt;For eg:(qemu) migrate -d \
"exec:cat &gt;'/tmp/vm'"&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;Marc&lt;br&gt;&lt;/pre&gt;



</body></email><email><emailId>20110405143655</emailId><senderName>Marc Boorshtein</senderName><senderEmail>mboorshtein@gmail.com</senderEmail><timestampReceived>2011-04-05 14:36:55-0400</timestampReceived><subject>[libvirt-users] Can not convert LVM over two vmdk files</subject><body>

Hello,

I'm trying to migrate from VMWare to KVM.  I've got a redhat 5
(actually oracle unbreakable 5) vmware image that has two scsi vmdk
files with logical volumes spanning both drives.  Wether I convert
them to raw files or load them as vmdk files, when I start them linux
boots but fails while trying to initate the LVM.  They are both
mounted as scsi drives and in the correct order.  The host is Fedora
15 Alpha.  Any help would be greatly appreciated, I'd love to ditch
VMWare!

Thanks
Marc

</body></email><email><emailId>20110401101111</emailId><senderName>Masanari Iida</senderName><senderEmail>standby24x7@gmail.com</senderEmail><timestampReceived>2011-04-01 10:11:11-0400</timestampReceived><subject>[libvirt-users] Can I update libvirt while KVM guest os are running</subject><body>

Hello
I have a simple question.
Can I update libvirt RPM while KVM guest OS on RHEL5 is running.

Background
When I run rhn_register, then rhn-virtualization-host RPM was
installed by RHN.  And then libvirt-python was also installed from
the RHN.  The libvirt-python RPM has a dependency with libvirt.
And the dependency was not only the RPM file name, and also
specific RPM versions as well.

# rpm -qR libvirt-python
/usr/bin/python
(snip)
libssl.so.6()(64bit)
libvirt = 0.8.2-15.el5　&lt;==
libvirt.so.0()(64bit)

So the libvirt from RHEL5.5 was updated to libvirt from RHEL5.6
by this accident.

If nothing was happen, I don't care.
But after the force libvirt update, I couldn't do attach-disk.

　error : Failed to attach disk
  error : internal error missing disk device alias name for hdc

Now I would like to confirm from the authority that libvirt update
while running guest os is supported or not.
If supported, then these messages indicated something going wrong.
If not, I can ignore it.

Regards,
Masanari

</body></email><email><emailId>20110408224541</emailId><senderName>Wojciech Gumularz</senderName><senderEmail>wgumularz@gmail.com</senderEmail><timestampReceived>2011-04-08 22:45:41-0400</timestampReceived><subject>[libvirt-users] Python API - setting client certificate path</subject><body>

Hi there,
I'm trying to establish a TLS connection to libvirtd with certificates
verification from a python script. My question is quite simple: 

is it possible to set the client certificate/keyfile path from within a
python script? or it has to be in /etc/pki/libvirt/...


Thanks in advance for any help

Wojciech Gumularz 

</body></email><email><emailId>20110408155002</emailId><senderName>None</senderName><senderEmail>balexis@gmail.com</senderEmail><timestampReceived>2011-04-08 15:50:02-0400</timestampReceived><subject>[libvirt-users] Listing shut off domains</subject><body>

Hi, I am in the process of migrating a system that was using KVM to VMWare
Workstation.

The original code needs to list all the domains available on the local
machine, no matter what their state is. The problem is that the shut off
domains are not shown by the virsh commands on the VMWare Workstation
system.

On the KVM system, with one shut off domain, I get this output:
maxpower@sw ~$ virsh list --all
 Id Name                 State
----------------------------------
  - 00042-my-domain shut off

On the VMWare Workstation system, with one shut off domain, I get this
output:
maxpower@sw2 ~ $ virsh -c vmwarews:///session list --all
 Id Name                 State
----------------------------------

As soon as I power on the machine in VMWare, it appears in the output as
running:
maxpower@sw2 ~ $ virsh -c vmwarews:///session list --all
 Id Name                 State
----------------------------------
14063 my-domain-1      running


Is this a limitation of the Workstation driver? Is there a workaround of
some sort that I haven't thought of? How can I get the entire domain list
when using Workstation?

Thanks for your input,
Alexis

[Attachment #3 (text/html)]

Hi, I am in the process of migrating a system that was using KVM to VMWare =
Workstation.&lt;br&gt;&lt;br&gt;The original code needs to list all the domains availab=
le on the local machine,  no matter what their state is. The problem is tha=
t the shut off domains are not shown by the virsh commands on the VMWare Wo=
rkstation system.&lt;br&gt;
&lt;br&gt;On the KVM system, with one shut off domain, I get this output:&lt;br&gt;maxp=
ower@sw ~$ virsh list --all&lt;br&gt;=A0Id Name=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=
=A0=A0=A0=A0=A0 State&lt;br&gt;----------------------------------&lt;br&gt;=A0 - 00042-=
my-domain shut off&lt;br&gt;&lt;br&gt;On the VMWare Workstation system, with one shut o=
ff domain, I get this output:&lt;br&gt;
maxpower@sw2 ~ $ virsh -c vmwarews:///session list --all&lt;br&gt;=A0Id Name=A0=
=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0 State&lt;br&gt;--------------------=
--------------&lt;br&gt;&lt;br&gt;As soon as I power on the machine in VMWare, it appea=
rs in the output as running:&lt;br&gt;
maxpower@sw2 ~ $ virsh -c vmwarews:///session list --all&lt;br&gt;=A0Id Name=A0=
=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0 State&lt;br&gt;--------------------=
--------------&lt;br&gt;14063 my-domain-1 =A0=A0=A0=A0 running&lt;br&gt;&lt;br&gt;&lt;br&gt;Is this=
 a limitation of the Workstation driver? Is there a workaround of some sort=
 that I haven't thought of? How can I get the entire domain list when u=
sing Workstation?&lt;br&gt;
&lt;br&gt;Thanks for your input,&lt;br&gt;Alexis&lt;br&gt;&lt;br&gt;


</body></email><email><emailId>20110409050317</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-04-09 05:03:17-0400</timestampReceived><subject>Re: [libvirt-users] Python API - setting client certificate path</subject><body>

2011/4/9 Wojciech Gumularz &lt;wgumularz@gmail.com&gt;:
&gt; Hi there,
&gt; I'm trying to establish a TLS connection to libvirtd with certificates
&gt; verification from a python script. My question is quite simple:
&gt;
&gt; is it possible to set the client certificate/keyfile path from within a
&gt; python script? or it has to be in /etc/pki/libvirt/...

See http://libvirt.org/remote.html#Remote_URI_parameters and
http://libvirt.org/remote.html#Remote_PKI for the pkipath parameter.

For example: qemu+tls://remove-server.com/system/?pkipath=/path/to/my/certificates

This requires libvirt 0.8.8 or newer.

Matthias

</body></email><email><emailId>20110413122915</emailId><senderName>Jorge Somavilla</senderName><senderEmail>somavilla@dit.upm.es</senderEmail><timestampReceived>2011-04-13 12:29:15-0400</timestampReceived><subject>[libvirt-users] point-to-point connection between vm and host</subject><body>

Hi! hopefully someone can give me a hint with this:


I need to create a vm with a point-to-point connection to the host
using a /30 subnet. Right now i have this in the vm's xml for libvirt:

&lt;interface type="network" name="eth0" onboot="yes"&gt;
   &lt;source network="default"/&gt;
   &lt;mac address="02:fd:00:00:01:00"/&gt;
&lt;/interface&gt;


Which brings up an interface in the vm that is configured later by a a
daemon, getting to this:

vnx@r2:~$ ifconfig eth0
eth0     Link encap:Ethernet  HWaddr 02:fd:00:00:01:00
          inet addr:10.250.0.2  Bcast:10.250.0.3  Mask:255.255.255.252


While in the host the other interface is created:

root@tau:/home/jorge/workspace/vnx# ifconfig r2-e0
r2-e0     Link encap:Ethernet  HWaddr 0a:81:b6:3c:24:15
          inet addr:10.250.0.1  Bcast:10.250.0.3  Mask:255.255.255.252


However there is no connectivity between them, probably because of
some mistake in the &lt;interface&gt; tag, perhaps a wrong 'type' attribute,
but i haven't found out yet. I wouldn't want to create a bridge and
connect both interfaces (vm's and host's) to the bridge, but to have
this ptp, if possible. How would i go about doing that?

thanks!
Jorge

</body></email><email><emailId>20110413155615</emailId><senderName>Zvi Dubitzky</senderName><senderEmail>dubi@il.ibm.com</senderEmail><timestampReceived>2011-04-13 15:56:15-0400</timestampReceived><subject>[libvirt-users] virsh shutdown</subject><body>

Hi
For some reason recent libvirt code (0.8.3 and even before) the 'virsh 
shutdown &lt;domain&gt; ' is not effective .
It issues an ok message but the  domians remains in a runnning state . 
Only th e destroy works fine.

Any idea ?

thanks

Zvi Dubitzky 
Email:dubi@il.ibm.com


</body></email><email><emailId>20110409171153</emailId><senderName>Kurian Thayil</senderName><senderEmail>kurianmthayil@gmail.com</senderEmail><timestampReceived>2011-04-09 17:11:53-0400</timestampReceived><subject>[libvirt-users] custom iptables rules</subject><body>

Hi,

Is there a way that we can add custom IP-Tables rules in a nat'd
physical host? I need some custom rules mentioned in physical host to
access some services in the guest systems. Any hints on this?

Regards,
Kurian Thayil.

[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
&lt;head&gt;

&lt;meta http-equiv="content-type" content="text/html; charset=ISO-8859-1"&gt;
&lt;/head&gt;
&lt;body text="#000000" bgcolor="#ffffff"&gt;
&lt;font size="-1"&gt;&lt;font face="Liberation Mono"&gt;Hi,&lt;br&gt;
&lt;br&gt;
Is there a way that we can add custom IP-Tables rules in a nat'd
physical host? I need some custom rules mentioned in physical host to
access some services in the guest systems. Any hints on this?&lt;br&gt;
&lt;br&gt;
Regards,&lt;br&gt;
Kurian Thayil.&lt;br&gt;
&lt;/font&gt;&lt;/font&gt;
&lt;/body&gt;
&lt;/html&gt;


</body></email><email><emailId>20110413163724</emailId><senderName></senderName><senderEmail>paul.worner@thomsonreuters.com</senderEmail><timestampReceived>2011-04-13 16:37:24-0400</timestampReceived><subject>Re: [libvirt-users] virsh shutdown</subject><body>

Hi
For some reason recent libvirt code (0.8.3 and even before) the 'virsh 
shutdown &lt;domain&gt; ' is not effective .
It issues an ok message but the  domians remains in a runnning state . 
Only th e destroy works fine.

Any idea ?

thanks

Zvi Dubitzky 
Email:dubi@il.ibm.com



Hi Zvi,

I had to install acpid on ubuntu in order to shutdown via virsh.

Paul

</body></email><email><emailId>20110413174226</emailId><senderName>None</senderName><senderEmail>balexis@gmail.com</senderEmail><timestampReceived>2011-04-13 17:42:26-0400</timestampReceived><subject>Re: [libvirt-users] virsh shutdown</subject><body>

The libvirt API has this to say regarding the shutdown command:

virDomainShutdown:
Shutdown a domain, the domain object is still usable there after but the
domain OS is being stopped. *Note that the guest OS may ignore the request.*

It is likely a guest OS issue. Which guest are you running? I had problems
shutting down Windows guests, I had to resort to Destroy too in order to
make sure the guest effectively guests shut down.

On Wed, Apr 13, 2011 at 12:37 PM, &lt;paul.worner@thomsonreuters.com&gt; wrote:

&gt; Hi
&gt; For some reason recent libvirt code (0.8.3 and even before) the 'virsh
&gt; shutdown &lt;domain&gt; ' is not effective .
&gt; It issues an ok message but the  domians remains in a runnning state .
&gt; Only th e destroy works fine.
&gt;
&gt; Any idea ?
&gt;
&gt; thanks
&gt;
&gt; Zvi Dubitzky
&gt; Email:dubi@il.ibm.com
&gt;
&gt;
&gt;
&gt; Hi Zvi,
&gt;
&gt; I had to install acpid on ubuntu in order to shutdown via virsh.
&gt;
&gt; Paul
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

[Attachment #3 (text/html)]

The libvirt API has this to say regarding the shutdown \
command:&lt;br&gt;&lt;br&gt;virDomainShutdown:&lt;br&gt;Shutdown a domain, the domain object is still \
usable there after but the domain OS is being stopped. &lt;b&gt;Note that the guest OS may \
ignore the request.&lt;/b&gt;&lt;br&gt;&lt;br&gt;It is likely a guest OS issue. Which guest are you \
running? I had problems shutting down Windows guests, I had to resort to Destroy too \
in order to make sure the guest effectively guests shut down.&lt;br&gt; &lt;br&gt;&lt;div \
class="gmail_quote"&gt;On Wed, Apr 13, 2011 at 12:37 PM,  &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:paul.worner@thomsonreuters.com"&gt;paul.worner@thomsonreuters.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt; Hi&lt;br&gt;
For some reason recent libvirt code (0.8.3 and even before) the 'virsh&lt;br&gt;
shutdown &lt;domain&gt; ' is not effective .&lt;br&gt;
It issues an ok message but the  domians remains in a runnning state .&lt;br&gt;
Only th e destroy works fine.&lt;br&gt;
&lt;br&gt;
Any idea ?&lt;br&gt;
&lt;br&gt;
thanks&lt;br&gt;
&lt;br&gt;
Zvi Dubitzky&lt;br&gt;
&lt;a href="mailto:Email%3Adubi@il.ibm.com"&gt;Email:dubi@il.ibm.com&lt;/a&gt;&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Hi Zvi,&lt;br&gt;
&lt;br&gt;
I had to install acpid on ubuntu in order to shutdown via virsh.&lt;br&gt;
&lt;br&gt;
Paul&lt;br&gt;
&lt;br&gt;
_______________________________________________&lt;br&gt;
libvirt-users mailing list&lt;br&gt;
&lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
&lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; \
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110414134839</emailId><senderName>kadir_yüceer</senderName><senderEmail>kadiryuceer@gmail.com</senderEmail><timestampReceived>2011-04-14 13:48:39-0400</timestampReceived><subject>[libvirt-users] Where actually is the callback triggered?</subject><body>

Hi all,

Quick question:
When the hypervisor triggers a callback which is registered for generic
events, (assuming I'm connected through qemu+tcp) where exactly is the
callback triggered? On the hypervisor host or on my host?

Regards
Kadir

[Attachment #3 (text/html)]

Hi all,&lt;br&gt;&lt;br&gt;Quick question:&lt;br&gt;When the hypervisor triggers a callback which is \
registered for generic events, (assuming I'm connected through qemu+tcp) where \
exactly is the callback triggered? On the hypervisor host or on my host?&lt;br&gt; \
&lt;br&gt;Regards&lt;br&gt;Kadir&lt;br&gt;



</body></email><email><emailId>20110415201326</emailId><senderName>Alex</senderName><senderEmail>mysqlstudent@gmail.com</senderEmail><timestampReceived>2011-04-15 20:13:26-0400</timestampReceived><subject>[libvirt-users] Problems setting up bridge</subject><body>

Hi,
I have a fc14 box with two interfaces that I'm having some difficulty
setting up a bridge properly. I have a few kvm guests set up and
running, but I've switched from using NetworkManager to using standard
networking with a bridge. I've modified the ifcfg-eth0 and created
ifcfg-br0 as per the standard documentation, but I think I'm having
routing problems. This is what the network looks like:

[root@fc14 ~]# route
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
68.195.XXX.40   *               255.255.255.248 U     0      0        0 br0
192.168.1.0     *               255.255.255.0   U     0      0        0 eth1
192.168.125.0   *               255.255.255.0   U     0      0        0 virbr0
link-local      *               255.255.0.0     U     1003   0        0 eth1
link-local      *               255.255.0.0     U     1004   0        0 br0
default         ool-44c3c129.st 0.0.0.0         UG    0      0        0 br0

br0       Link encap:Ethernet  HWaddr 40:61:86:4E:84:09
          inet addr:68.195.XXX.42  Bcast:68.195.XXX.47  Mask:255.255.255.248
          inet6 addr: fe80::a0e7:ecff:fefd:340a/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:3883 errors:0 dropped:0 overruns:0 frame:0
          TX packets:3579 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:1818327 (1.7 MiB)  TX bytes:590720 (576.8 KiB)

eth0      Link encap:Ethernet  HWaddr 40:61:86:4E:84:09
          inet6 addr: fe80::4261:86ff:fe4e:8409/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:3891 errors:0 dropped:0 overruns:0 frame:0
          TX packets:3551 errors:0 dropped:0 overruns:0 carrier:1
          collisions:0 txqueuelen:1000
          RX bytes:1873169 (1.7 MiB)  TX bytes:588302 (574.5 KiB)
          Interrupt:42

eth1      Link encap:Ethernet  HWaddr 00:0E:0C:3B:36:F4
          inet addr:192.168.1.1  Bcast:192.168.1.255  Mask:255.255.255.0
          inet6 addr: fe80::20e:cff:fe3b:36f4/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:7622 errors:0 dropped:0 overruns:0 frame:0
          TX packets:6936 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:1062687 (1.0 MiB)  TX bytes:4304984 (4.1 MiB)

virbr0    Link encap:Ethernet  HWaddr E6:ED:D2:6E:58:5C
          inet addr:192.168.125.1  Bcast:192.168.125.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)

vnet0     Link encap:Ethernet  HWaddr FE:54:00:67:2C:4C
          inet6 addr: fe80::fc54:ff:fe67:2c4c/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:5 errors:0 dropped:0 overruns:0 frame:0
          TX packets:391 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:500
          RX bytes:300 (300.0 b)  TX bytes:23358 (22.8 KiB)

I've left out the loopback for simplicity. The problem is that I can't
reach the br0 device from a server on the eth1 device (the 192.168.
network).

Is this a routing issue? Should I also add the eth1 device to the
bridge? If so, how would I do that?

Also, can you explain under what circumstances a tun device would be
used? Does that have any relation to bridging?

Thanks,
Alex

</body></email><email><emailId>20110414202616</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-04-14 20:26:16-0400</timestampReceived><subject>Re: [libvirt-users] Where actually is the callback triggered?</subject><body>

2011/4/14 kadir yüceer &lt;kadiryuceer@gmail.com&gt;:
&gt; Hi all,
&gt;
&gt; Quick question:
&gt; When the hypervisor triggers a callback which is registered for generic
&gt; events, (assuming I'm connected through qemu+tcp) where exactly is the
&gt; callback triggered? On the hypervisor host or on my host?
&gt;
&gt; Regards
&gt; Kadir
&gt;

The event system is more complex.

The hypervisor/connection driver add events to a queue. The events
from this queue are transported to the client and can trigger you
registered callbacks.

In order to have your callbacks called you need to register an "event
implementation" that is responsible for driving the event delivery.
Recent libvirt exposed it's default "event implementation" via
virEventRegisterDefaultImpl().

In order to have events delivered to your callbacks you need to call
virEventRegisterDefaultImpl() or virEventRegisterImpl() with your own
"event implementation".

I assume you're still talking about the Java bindings here then you
hit the problem that the bindings are incomplete and don't export
virEventRegisterImpl() nor virEventRegisterDefaultImpl() yet. This
means that the event related part of the libvirt API can not be used
from the Java bindings yet.


A totally untested patch to add virEventRegisterDefaultImpl() looks like this:


diff --git a/src/main/java/org/libvirt/jna/Libvirt.java
b/src/main/java/org/libvirt/jna/Libvirt.java
index 2c8c03d..5b73859 100644
--- a/src/main/java/org/libvirt/jna/Libvirt.java
+++ b/src/main/java/org/libvirt/jna/Libvirt.java
@@ -373,4 +373,7 @@ public interface Libvirt extends Library {
     public int virNWFilterGetUUID(NetworkFilterPointer
virNWFilterPtr, byte[] uuidString);
     public int virNWFilterGetUUIDString(NetworkFilterPointer
virNWFilterPtr, byte[] uuidString);
     public int virNWFilterUndefine(NetworkFilterPointer virNWFilterPtr);
+
+    // Event Methods
+    public int virEventRegisterDefaultImpl(void);
 }


Then import org.libvirt.jna.Libvirt in your code and call:

Libvirt.INSTANCE.virEventRegisterDefaultImpl()

This _should_ register the default event implementation and make
events work for you assuming the rest of your event related code is
correct.

Matthias

</body></email><email><emailId>20110415071503</emailId><senderName>kadir_yüceer</senderName><senderEmail>kadiryuceer@gmail.com</senderEmail><timestampReceived>2011-04-15 07:15:03-0400</timestampReceived><subject>Re: [libvirt-users] Where actually is the callback triggered?</subject><body>

2011/4/14 Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;

&gt; 2011/4/14 kadir y=FCceer &lt;kadiryuceer@gmail.com&gt;:
&gt; &gt; Hi all,
&gt; &gt;
&gt; &gt; Quick question:
&gt; &gt; When the hypervisor triggers a callback which is registered for generic
&gt; &gt; events, (assuming I'm connected through qemu+tcp) where exactly is the
&gt; &gt; callback triggered? On the hypervisor host or on my host?
&gt; &gt;
&gt; &gt; Regards
&gt; &gt; Kadir
&gt; &gt;
&gt;
&gt; The event system is more complex.
&gt;
&gt; The hypervisor/connection driver add events to a queue. The events
&gt; from this queue are transported to the client and can trigger you
&gt; registered callbacks.
&gt;
&gt; In order to have your callbacks called you need to register an "event
&gt; implementation" that is responsible for driving the event delivery.
&gt; Recent libvirt exposed it's default "event implementation" via
&gt; virEventRegisterDefaultImpl().
&gt;
&gt; In order to have events delivered to your callbacks you need to call
&gt; virEventRegisterDefaultImpl() or virEventRegisterImpl() with your own
&gt; "event implementation".
&gt;
&gt; I assume you're still talking about the Java bindings here then you
&gt; hit the problem that the bindings are incomplete and don't export
&gt; virEventRegisterImpl() nor virEventRegisterDefaultImpl() yet. This
&gt; means that the event related part of the libvirt API can not be used
&gt; from the Java bindings yet.
&gt;
&gt;
&gt; A totally untested patch to add virEventRegisterDefaultImpl() looks like
&gt; this:
&gt;
&gt;
&gt; diff --git a/src/main/java/org/libvirt/jna/Libvirt.java
&gt; b/src/main/java/org/libvirt/jna/Libvirt.java
&gt; index 2c8c03d..5b73859 100644
&gt; --- a/src/main/java/org/libvirt/jna/Libvirt.java
&gt; +++ b/src/main/java/org/libvirt/jna/Libvirt.java
&gt; @@ -373,4 +373,7 @@ public interface Libvirt extends Library {
&gt;     public int virNWFilterGetUUID(NetworkFilterPointer
&gt; virNWFilterPtr, byte[] uuidString);
&gt;     public int virNWFilterGetUUIDString(NetworkFilterPointer
&gt; virNWFilterPtr, byte[] uuidString);
&gt;     public int virNWFilterUndefine(NetworkFilterPointer virNWFilterPtr);
&gt; +
&gt; +    // Event Methods
&gt; +    public int virEventRegisterDefaultImpl(void);
&gt;  }
&gt;
&gt;
&gt; Then import org.libvirt.jna.Libvirt in your code and call:
&gt;
&gt; Libvirt.INSTANCE.virEventRegisterDefaultImpl()
&gt;
&gt; This _should_ register the default event implementation and make
&gt; events work for you assuming the rest of your event related code is
&gt; correct.
&gt;
&gt; Matthias
&gt;

First of all, thanks for the answer Matthias, I've been looking for help fo=
r
some time.

I had already tried your suggestion, I added the function just as the same
way you did above, and I have this error:

Exception in thread "main"* java.lang.UnsatisfiedLinkError: Error looking u=
p
function 'virEventRegisterDefaultImpl': /usr/local/lib/libvirt.so: undefine=
d
symbol: virEventRegisterDefaultImpl*
        at com.sun.jna.Function.&lt;init&gt;(Function.java:179)
        at com.sun.jna.NativeLibrary.getFunction(NativeLibrary.java:345)
        at com.sun.jna.NativeLibrary.getFunction(NativeLibrary.java:325)
        at com.sun.jna.Library$Handler.invoke(Library.java:203)
        at $Proxy0.virEventRegisterDefaultImpl(Unknown Source)
        at novatest_v03.MainFrame.main(MainFrame.java:168)

I did not post not go too technical. I have the feeling that I need to
arrange one more step to satisfy the link to java bindings, because I've
tested event-driving in C and it works fine. Since I could not figure out i=
f
I can do it on binding side or it should be done originally by the driver,
I've posted my question.

So, any comments about how can I complete the link to C API? Maybe how to
edit this "libvirt.so"?

Regards
Kadir

PS: Everything else works fine, libvirtd running, I can command to domains,
etc. I can even register my own callback and register it via
Connect.setErrorCallback(). I assume only missing thing is the link.

[Attachment #3 (text/html)]

&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;2011/4/14 Matthias Bolte &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, \
204, 204); padding-left: 1ex;"&gt; 2011/4/14 kadir yüceer &lt;&lt;a \
href="mailto:kadiryuceer@gmail.com"&gt;kadiryuceer@gmail.com&lt;/a&gt;&gt;:&lt;br&gt; \
&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;&gt; Hi all,&lt;br&gt; &gt;&lt;br&gt;
&gt; Quick question:&lt;br&gt;
&gt; When the hypervisor triggers a callback which is registered for generic&lt;br&gt;
&gt; events, (assuming I'm connected through qemu+tcp) where exactly is the&lt;br&gt;
&gt; callback triggered? On the hypervisor host or on my host?&lt;br&gt;
&gt;&lt;br&gt;
&gt; Regards&lt;br&gt;
&gt; Kadir&lt;br&gt;
&gt;&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;The event system is more complex.&lt;br&gt;
&lt;br&gt;
The hypervisor/connection driver add events to a queue. The events&lt;br&gt;
from this queue are transported to the client and can trigger you&lt;br&gt;
registered callbacks.&lt;br&gt;
&lt;br&gt;
In order to have your callbacks called you need to register an "event&lt;br&gt;
implementation" that is responsible for driving the event delivery.&lt;br&gt;
Recent libvirt exposed it's default "event implementation" via&lt;br&gt;
virEventRegisterDefaultImpl().&lt;br&gt;
&lt;br&gt;
In order to have events delivered to your callbacks you need to call&lt;br&gt;
virEventRegisterDefaultImpl() or virEventRegisterImpl() with your own&lt;br&gt;
"event implementation".&lt;br&gt;
&lt;br&gt;
I assume you're still talking about the Java bindings here then you&lt;br&gt;
hit the problem that the bindings are incomplete and don't export&lt;br&gt;
virEventRegisterImpl() nor virEventRegisterDefaultImpl() yet. This&lt;br&gt;
means that the event related part of the libvirt API can not be used&lt;br&gt;
from the Java bindings yet.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
A totally untested patch to add virEventRegisterDefaultImpl() looks like this:&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
diff --git a/src/main/java/org/libvirt/jna/Libvirt.java&lt;br&gt;
b/src/main/java/org/libvirt/jna/Libvirt.java&lt;br&gt;
index 2c8c03d..5b73859 100644&lt;br&gt;
--- a/src/main/java/org/libvirt/jna/Libvirt.java&lt;br&gt;
+++ b/src/main/java/org/libvirt/jna/Libvirt.java&lt;br&gt;
@@ -373,4 +373,7 @@ public interface Libvirt extends Library {&lt;br&gt;
     public int virNWFilterGetUUID(NetworkFilterPointer&lt;br&gt;
virNWFilterPtr, byte[] uuidString);&lt;br&gt;
     public int virNWFilterGetUUIDString(NetworkFilterPointer&lt;br&gt;
virNWFilterPtr, byte[] uuidString);&lt;br&gt;
     public int virNWFilterUndefine(NetworkFilterPointer virNWFilterPtr);&lt;br&gt;
+&lt;br&gt;
+    // Event Methods&lt;br&gt;
+    public int virEventRegisterDefaultImpl(void);&lt;br&gt;
 }&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Then import org.libvirt.jna.Libvirt in your code and call:&lt;br&gt;
&lt;br&gt;
Libvirt.INSTANCE.virEventRegisterDefaultImpl()&lt;br&gt;
&lt;br&gt;
This _should_ register the default event implementation and make&lt;br&gt;
events work for you assuming the rest of your event related code is&lt;br&gt;
correct.&lt;br&gt;
&lt;font color="#888888"&gt;&lt;br&gt;
Matthias&lt;br&gt;&lt;/font&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;First of all, thanks for the answer \
Matthias, I've been looking for help for some time.&lt;br&gt;&lt;br&gt;I had already tried \
your suggestion, I added the function just as the same way you did above, and I have \
this error:&lt;br&gt; &lt;br&gt;Exception in thread "main"&lt;b&gt; \
java.lang.UnsatisfiedLinkError: Error looking up function \
'virEventRegisterDefaultImpl': /usr/local/lib/libvirt.so: undefined symbol: \
virEventRegisterDefaultImpl&lt;/b&gt;&lt;br&gt;  at \
com.sun.jna.Function.&lt;init&gt;(Function.java:179)&lt;br&gt;        at \
com.sun.jna.NativeLibrary.getFunction(NativeLibrary.java:345)&lt;br&gt;        at \
com.sun.jna.NativeLibrary.getFunction(NativeLibrary.java:325)&lt;br&gt;        at \
com.sun.jna.Library$Handler.invoke(Library.java:203)&lt;br&gt;  at \
$Proxy0.virEventRegisterDefaultImpl(Unknown Source)&lt;br&gt;        at \
novatest_v03.MainFrame.main(MainFrame.java:168)&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;I did not post not \
go too technical. I have the feeling that I need to arrange one more step to satisfy \
the link to java bindings, because I've tested event-driving in C and it works \
fine. Since I could not figure out if I can do it on binding side or it should be \
done originally by the driver, I've posted my question.&lt;br&gt; &lt;br&gt;So, any comments \
about how can I complete the link to C API? Maybe how to edit this \
"libvirt.so"?&lt;br&gt;&lt;br&gt;Regards&lt;br&gt;Kadir&lt;br&gt;&lt;br&gt;PS: Everything else works \
fine, libvirtd running, I can command to domains, etc. I can even register my own \
callback and register it via Connect.setErrorCallback(). I assume only missing thing \
is the link.&lt;br&gt;



</body></email><email><emailId>20110413130356</emailId><senderName></senderName><senderEmail>paul.worner@thomsonreuters.com</senderEmail><timestampReceived>2011-04-13 13:03:56-0400</timestampReceived><subject>Re: [libvirt-users] point-to-point connection between vm and host</subject><body>

Hi Jorge,

I am doing it by creating a bridge per vm.  I am not sure this is the
best approach.  Hopefully, someone has a cleaner approach.

I did need to add forward mode "route", since the vm's network is
independent of the host's network(s) and I am routing.

&lt;network&gt;
  &lt;name&gt;netdom4&lt;/name&gt;
  &lt;forward mode="route"/&gt;
  &lt;bridge name="virbr%d" stp="off" delay="0"/&gt;
  &lt;ip address="10.0.0.1" netmask="255.255.255.252"&gt;
  &lt;/ip&gt;
&lt;/network&gt;

If you are not routing, you can set this mode to "nat" so the vm will
get sourced from host's address.  I haven't tried this, but I would
assume the iptables nat rules are created automatically.

  &lt;forward mode="nat"/&gt;

Hope this helps,
Paul


-----Original Message-----
From: libvirt-users-bounces@redhat.com
[mailto:libvirt-users-bounces@redhat.com] On Behalf Of Jorge Somavilla
Sent: Wednesday, April 13, 2011 7:29 AM
To: libvirt-users@redhat.com
Subject: [libvirt-users] point-to-point connection between vm and host

Hi! hopefully someone can give me a hint with this:


I need to create a vm with a point-to-point connection to the host
using a /30 subnet. Right now i have this in the vm's xml for libvirt:

&lt;interface type="network" name="eth0" onboot="yes"&gt;
   &lt;source network="default"/&gt;
   &lt;mac address="02:fd:00:00:01:00"/&gt;
&lt;/interface&gt;


Which brings up an interface in the vm that is configured later by a a
daemon, getting to this:

vnx@r2:~$ ifconfig eth0
eth0     Link encap:Ethernet  HWaddr 02:fd:00:00:01:00
          inet addr:10.250.0.2  Bcast:10.250.0.3  Mask:255.255.255.252


While in the host the other interface is created:

root@tau:/home/jorge/workspace/vnx# ifconfig r2-e0
r2-e0     Link encap:Ethernet  HWaddr 0a:81:b6:3c:24:15
          inet addr:10.250.0.1  Bcast:10.250.0.3  Mask:255.255.255.252


However there is no connectivity between them, probably because of
some mistake in the &lt;interface&gt; tag, perhaps a wrong 'type' attribute,
but i haven't found out yet. I wouldn't want to create a bridge and
connect both interfaces (vm's and host's) to the bridge, but to have
this ptp, if possible. How would i go about doing that?

thanks!
Jorge

_______________________________________________
libvirt-users mailing list
libvirt-users@redhat.com
https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110512133050</emailId><senderName>Jorge Somavilla</senderName><senderEmail>somavilla@dit.upm.es</senderEmail><timestampReceived>2011-05-12 13:30:50-0400</timestampReceived><subject>Re: [libvirt-users] point-to-point connection between vm and host</subject><body>

Hello, we have been looking for other options to do this, and found
that we can add qemu lines to the vm's xml for libvirt.

What we want libvirt to do can be done with a qemu line like this:

    qemu -boot c -net nic,vlan=0,macaddr=02:fd:00:04:01:00,name=eth0
-net tap,vlan=0,ifname=ubuntu-e0,script=no ubuntu.img

Which means that inside the host we connect a new tap device to the
interface ubuntu-e0, and then connect the tap device of the host with
the guest's nic, eth0. This provides connectivity between host and
guest.

The way to do this with libvirt seems with the tag &lt;qemu:commandline&gt;,
which allows us to append some qemu lines. So now the definition file
of the vm for libvirt looks like this:

&lt;/domain&gt;
...
    &lt;interface type="network" name="eth0" onboot="yes"&gt;
      &lt;source network="default"/&gt;
      &lt;mac address="02:fd:00:04:01:00"/&gt;
    &lt;/interface&gt;
...
  &lt;qemu:commandline&gt;
    &lt;qemu:arg value="-net"/&gt;
    &lt;qemu:arg value="nic,macaddr=02:fd:00:04:01:00"/&gt;
    &lt;qemu:arg value="-net"/&gt;
    &lt;qemu:arg value="tap,ifname=ubuntu-e0,script=no"/&gt;
  &lt;/qemu:commandline&gt;
&lt;/domain&gt;

With this, the guest shows the eth0 interface correctly configured.
However there is no connectivity with the host. If we look at the log
file, we find that some of the qemu options of the xml are missing,
like the name oh the host's interface to be associated with the tap
device ("ifname=ubuntu-e0"):

# tail -f /var/log/libvirt/qemu/ubuntu.log
LC_ALL=C PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin
QEMU_AUDIO_DRV=none /usr/bin/kvm -S -M pc-0.12 -cpu qemu32 -enable-kvm
-m 256 -smp 1 -name ubuntu -uuid fb6e6954-53c6-7982-7b55-04edd406b871
-chardev socket,id=monitor,path=/var/lib/libvirt/qemu/ubuntu.monitor,server,nowait
-monitor chardev:monitor -boot cd -drive
file=/root/.vnx/scenarios/simple_ubuntu/vms/ubuntu/fs/root_cow_fs,if=ide,index=0,boot=on,format=qcow2
-drive file=/root/.vnx/scenarios/simple_ubuntu/vms/ubuntu/fs/opt_fs.iso,if=ide,media=cdrom,index=1
-net nic,macaddr=02:fd:00:04:01:00,vlan=0,name=nic.0 -net
tap,fd=16,vlan=0,name=tap.0 -net
nic,macaddr=02:fd:00:04:01:01,vlan=1,name=nic.1 -net
tap,fd=17,vlan=1,name=tap.1 -chardev pty,id=serial0 -serial
chardev:serial0 -chardev
socket,id=serial1,path=/root/.vnx/scenarios/simple_ubuntu/vms/ubuntu/ubuntu_socket,server,nowait
-serial chardev:serial1 -parallel none -usb -vnc :1 -vga cirrus
char device redirected to /dev/pts/8


What am i doing wrong? How can i specify the name of the host's interface?

regards,
Jorge





On Wed, Apr 13, 2011 at 14:29, Jorge Somavilla &lt;somavilla@dit.upm.es&gt; wrote:
&gt;
&gt; Hi! hopefully someone can give me a hint with this:
&gt;
&gt;
&gt; I need to create a vm with a point-to-point connection to the host
&gt; using a /30 subnet. Right now i have this in the vm's xml for libvirt:
&gt;
&gt; &lt;interface type="network" name="eth0" onboot="yes"&gt;
&gt;   &lt;source network="default"/&gt;
&gt;   &lt;mac address="02:fd:00:00:01:00"/&gt;
&gt; &lt;/interface&gt;
&gt;
&gt;
&gt; Which brings up an interface in the vm that is configured later by a a
&gt; daemon, getting to this:
&gt;
&gt; vnx@r2:~$ ifconfig eth0
&gt; eth0     Link encap:Ethernet  HWaddr 02:fd:00:00:01:00
&gt;          inet addr:10.250.0.2  Bcast:10.250.0.3  Mask:255.255.255.252
&gt;
&gt;
&gt; While in the host the other interface is created:
&gt;
&gt; root@tau:/home/jorge/workspace/vnx# ifconfig r2-e0
&gt; r2-e0     Link encap:Ethernet  HWaddr 0a:81:b6:3c:24:15
&gt;          inet addr:10.250.0.1  Bcast:10.250.0.3  Mask:255.255.255.252
&gt;
&gt;
&gt; However there is no connectivity between them, probably because of
&gt; some mistake in the &lt;interface&gt; tag, perhaps a wrong 'type' attribute,
&gt; but i haven't found out yet. I wouldn't want to create a bridge and
&gt; connect both interfaces (vm's and host's) to the bridge, but to have
&gt; this ptp, if possible. How would i go about doing that?
&gt;
&gt; thanks!
&gt; Jorge

</body></email><email><emailId>20110404082155</emailId><senderName>Masanari Iida</senderName><senderEmail>standby24x7@gmail.com</senderEmail><timestampReceived>2011-04-04 08:21:55-0400</timestampReceived><subject>Re: [libvirt-users] Can I update libvirt while KVM guest os are running</subject><body>

On Fri, Apr 1, 2011 at 7:11 PM, Masanari Iida &lt;standby24x7@gmail.com&gt; wrote:
&gt; Hello
&gt; I have a simple question.
&gt; Can I update libvirt RPM while KVM guest OS on RHEL5 is running.
&gt;
I am still searching for this answer.
As far as I have seen on FAQ, restarting libvirtd may not affect the
virtual machine.

&gt; Will restarting the libvirt daemon stop my virtual machines?
&gt;
&gt; NO, as of version 0.6.0 (Jan 2009). Versions older than this will kill VMs if the libvirtd daemon is
&gt; stopped, so beware.

My case  was libvirt update from 0.6.3 to 0.8.2 and then restart
libvirtd while running
the guest os.

Regards,

Masanari

</body></email><email><emailId>20110406074651</emailId><senderName>kadir_yüceer</senderName><senderEmail>kadiryuceer@gmail.com</senderEmail><timestampReceived>2011-04-06 07:46:51-0400</timestampReceived><subject>[libvirt-users] Registering a callback in Java</subject><body>

I'm able to edit org.libvirt.Domain.java and print a message when, for
example suspend() is called. However I want to use eventCallback API of
libvirt.
Isn't this the proper piece of code to register a callback to any
domain(domain parameter is null), for a lifecycle event(event id 0).
conn.domainEventRegisterAny(null,
                        0,
                        new VirConnectDomainEventGenericCallback() {

                    public void eventCallback(ConnectionPointer cp,
DomainPointer dp, Pointer pntr) {
                        System.out.println("event!");
                    }
});
 I can't get the println when I suspend or resume the domains. And the
reason I wrote "0" is that I could not find VIR_DOMAIN_EVENT_ID_LIFECYCLE
constant in java API. Any help about where to find macros,types and
enumerations in java API is appreciated. Unfortunately I can not find
anything about events in javadoc neither. Any comments?

Kind regards
Kadir

[Attachment #3 (text/html)]

I'm able to edit org.libvirt.Domain.java and print a message when, for =
example suspend() is called. However I want to use eventCallback API of lib=
virt.&lt;br&gt;Isn't this the proper piece of code to register a callback to =
any domain(domain parameter is null), for a lifecycle event(event id 0).&lt;br=
&gt;
conn.domainEventRegisterAny(null,&lt;br&gt;=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=
=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0 0,&lt;br&gt;=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=
=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0 new VirConnectDomainEventGenericCallba=
ck() {&lt;br&gt;&lt;br&gt;=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0 pub=
lic void eventCallback(ConnectionPointer cp, DomainPointer dp, Pointer pntr=
) {&lt;br&gt;

=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0 Syste=
m.out.println("event!");&lt;br&gt;=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=
=A0=A0=A0=A0=A0=A0=A0 }&lt;br&gt;});&lt;br&gt;=A0I can't get the println when I sus=
pend or resume the domains. And the reason I wrote "0" is that I =
could not find VIR_DOMAIN_EVENT_ID_LIFECYCLE constant in java API. Any help=
 about where to find macros,types and enumerations in java API is appreciat=
ed. Unfortunately I can not find anything about events in javadoc neither. =
Any comments?&lt;br&gt;
&lt;br&gt;Kind regards&lt;br&gt;Kadir&lt;br&gt;
&lt;br&gt;


</body></email><email><emailId>20110406081836</emailId><senderName>Masanari Iida</senderName><senderEmail>standby24x7@gmail.com</senderEmail><timestampReceived>2011-04-06 08:18:36-0400</timestampReceived><subject>Re: [libvirt-users] Can I update libvirt while KVM guest os are running</subject><body>

Answer to myself.

Troubleshooted the symptom with my colleague and found the root cause.
In case of libvirt update from 0.6.3 to 0.8.2,
I had to restart my Guest OS.
Otherwise I got an error when I execute attached-disk with libvirt 0.8.2.

&gt; error: Failed to attach disk
&gt; error: internal error missing disk device alias name for hdc

It was because virDomainDeviceInfo info in struct _virDomainDiskDef
was NOT exist in 0.6.3.
After update,  libvirt 0.8.2 does  origdisk-&gt;info.alias, and it causes this
error message.

I believe there are many changes between 2 versions.
So I conclude that it is safe to stop Guest OS when libvirtd is updated.

Thanks

Masanari

</body></email><email><emailId>20110409053634</emailId><senderName>Wojciech Gumularz</senderName><senderEmail>wgumularz@gmail.com</senderEmail><timestampReceived>2011-04-09 05:36:34-0400</timestampReceived><subject>Re: [libvirt-users] Python API - setting client certificate path</subject><body>

Dnia 2011-04-09, sob o godzinie 07:03 +0200, Matthias Bolte pisze:
&gt; 2011/4/9 Wojciech Gumularz &lt;wgumularz@gmail.com&gt;:
&gt; &gt; Hi there,
&gt; &gt; I'm trying to establish a TLS connection to libvirtd with certificates
&gt; &gt; verification from a python script. My question is quite simple:
&gt; &gt;
&gt; &gt; is it possible to set the client certificate/keyfile path from within a
&gt; &gt; python script? or it has to be in /etc/pki/libvirt/...
&gt; 
&gt; See http://libvirt.org/remote.html#Remote_URI_parameters and
&gt; http://libvirt.org/remote.html#Remote_PKI for the pkipath parameter.
&gt; 
&gt; For example: qemu+tls://remove-server.com/system/?pkipath=/path/to/my/certificates
&gt; 
&gt; This requires libvirt 0.8.8 or newer.
&gt; 
&gt; Matthias
That was quick!
Thanks a lot!

w.g.

</body></email><email><emailId>20110411133519</emailId><senderName>None</senderName><senderEmail>balexis@gmail.com</senderEmail><timestampReceived>2011-04-11 13:35:19-0400</timestampReceived><subject>Re: [libvirt-users] Listing shut off domains</subject><body>

Well it seems like Workstation itself cannot provide the listing of shut off
VMs, even through their own VIX api. I'm not sure other VMWare products can
provide it either, even though Server and ESX have the notion of Inventory.

As a last resort, I tried playing with libvirt, calling 'virsh define' in
the hope that libvirt could register the VM in its own store and later on be
able to list it, to no avail.

I think I'm done with Workstation. I'm a little disappointed with libvirt,
which I thought it provided a uniform interface to various hypervisors. I
should've read goals.html more thoroughly, as it is stated that:

libvirt should provide all APIs needed to do the management [...] within the
limits of the support of the hypervisor for those operations.

It would be neat to create a table with all the libvirt commands and the
supported hypervisors, showing which command is available to which
hypervisor. This would help people wanting to change hypervisors while
keeping their libvirt-based system by showing what will continue to work and
what will need to be worked around in other ways, such as listing shut off
VMs.

On Fri, Apr 8, 2011 at 11:50 AM, None &lt;balexis@gmail.com&gt; wrote:

&gt; Hi, I am in the process of migrating a system that was using KVM to VMWare
&gt; Workstation.
&gt;
&gt; The original code needs to list all the domains available on the local
&gt; machine, no matter what their state is. The problem is that the shut off
&gt; domains are not shown by the virsh commands on the VMWare Workstation
&gt; system.
&gt;
&gt; On the KVM system, with one shut off domain, I get this output:
&gt; maxpower@sw ~$ virsh list --all
&gt;  Id Name                 State
&gt; ----------------------------------
&gt;   - 00042-my-domain shut off
&gt;
&gt; On the VMWare Workstation system, with one shut off domain, I get this
&gt; output:
&gt; maxpower@sw2 ~ $ virsh -c vmwarews:///session list --all
&gt;  Id Name                 State
&gt; ----------------------------------
&gt;
&gt; As soon as I power on the machine in VMWare, it appears in the output as
&gt; running:
&gt; maxpower@sw2 ~ $ virsh -c vmwarews:///session list --all
&gt;  Id Name                 State
&gt; ----------------------------------
&gt; 14063 my-domain-1      running
&gt;
&gt;
&gt; Is this a limitation of the Workstation driver? Is there a workaround of
&gt; some sort that I haven't thought of? How can I get the entire domain list
&gt; when using Workstation?
&gt;
&gt; Thanks for your input,
&gt; Alexis
&gt;
&gt;

[Attachment #3 (text/html)]

Well it seems like Workstation itself cannot provide the listing of shut off VMs, \
even through their own VIX api. I'm not sure other VMWare products can provide it \
either, even though Server and ESX have the notion of Inventory.&lt;br&gt; &lt;br&gt;As a last \
resort, I tried playing with libvirt, calling 'virsh define' in the hope that \
libvirt could register the VM in its own store and later on be able to list it, to no \
avail.&lt;br&gt;&lt;br&gt;I think I'm done with Workstation. I'm a little disappointed \
with libvirt, which I thought it provided a uniform interface to various hypervisors. \
I should've read goals.html more thoroughly, as it is stated that:&lt;br&gt; &lt;br&gt; \
libvirt should provide all APIs needed to do the  management [...] within the limits \
of the support of the hypervisor  for those operations.&lt;br&gt;&lt;br&gt;It would be neat to \
create a table with all the libvirt commands and the supported hypervisors, showing \
which command is available to which hypervisor. This would help people wanting to \
change hypervisors while keeping their libvirt-based system by showing what will \
continue to work and what will need to be worked around in other ways, such as \
listing shut off VMs.&lt;br&gt; &lt;br&gt;&lt;div class="gmail_quote"&gt;On Fri, Apr 8, 2011 at 11:50 \
AM, None &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:balexis@gmail.com"&gt;balexis@gmail.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt; Hi, I am in the process of migrating a system that was \
using KVM to VMWare Workstation.&lt;br&gt;&lt;br&gt;The original code needs to list all the \
domains available on the local machine,  no matter what their state is. The problem \
is that the shut off domains are not shown by the virsh commands on the VMWare \
Workstation system.&lt;br&gt;

&lt;br&gt;On the KVM system, with one shut off domain, I get this output:&lt;br&gt;maxpower@sw ~$ \
virsh list --all&lt;br&gt; Id Name                 \
State&lt;br&gt;----------------------------------&lt;br&gt;  - 00042-my-domain shut off&lt;br&gt;&lt;br&gt;On \
the VMWare Workstation system, with one shut off domain, I get this output:&lt;br&gt;

maxpower@sw2 ~ $ virsh -c vmwarews:///session list --all&lt;br&gt; Id Name                 \
State&lt;br&gt;----------------------------------&lt;br&gt;&lt;br&gt;As soon as I power on the machine \
in VMWare, it appears in the output as running:&lt;br&gt;

maxpower@sw2 ~ $ virsh -c vmwarews:///session list --all&lt;br&gt; Id Name                 \
State&lt;br&gt;----------------------------------&lt;br&gt;14063 my-domain-1      \
running&lt;br&gt;&lt;br&gt;&lt;br&gt;Is this a limitation of the Workstation driver? Is there a \
workaround of some sort that I haven't thought of? How can I get the entire \
domain list when using Workstation?&lt;br&gt;

&lt;br&gt;Thanks for your input,&lt;br&gt;Alexis&lt;br&gt;&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110413150602</emailId><senderName>Jorge Somavilla</senderName><senderEmail>somavilla@dit.upm.es</senderEmail><timestampReceived>2011-04-13 15:06:02-0400</timestampReceived><subject>Re: [libvirt-users] point-to-point connection between vm and host</subject><body>

On Wed, Apr 13, 2011 at 15:03,  &lt;paul.worner@thomsonreuters.com&gt; wrote:
&gt; Hi Jorge,

Hi! thanks for the reply Paul,

&gt; I am doing it by creating a bridge per vm.  I am not sure this is the
&gt; best approach.  Hopefully, someone has a cleaner approach.

it is a good solution if nothing better comes up, i was thinking maybe
there is a cleaner way as you say though, if not i will most
definitely follow your lead, thank you!



&gt; I did need to add forward mode "route", since the vm's network is
&gt; independent of the host's network(s) and I am routing.
&gt;
&gt; &lt;network&gt;
&gt;  &lt;name&gt;netdom4&lt;/name&gt;
&gt;  &lt;forward mode="route"/&gt;
&gt;  &lt;bridge name="virbr%d" stp="off" delay="0"/&gt;
&gt;  &lt;ip address="10.0.0.1" netmask="255.255.255.252"&gt;
&gt;  &lt;/ip&gt;
&gt; &lt;/network&gt;
&gt;
&gt; If you are not routing, you can set this mode to "nat" so the vm will
&gt; get sourced from host's address.  I haven't tried this, but I would
&gt; assume the iptables nat rules are created automatically.
&gt;
&gt;  &lt;forward mode="nat"/&gt;
&gt;
&gt; Hope this helps,
&gt; Paul
&gt;
&gt;
&gt; -----Original Message-----
&gt; From: libvirt-users-bounces@redhat.com
&gt; [mailto:libvirt-users-bounces@redhat.com] On Behalf Of Jorge Somavilla
&gt; Sent: Wednesday, April 13, 2011 7:29 AM
&gt; To: libvirt-users@redhat.com
&gt; Subject: [libvirt-users] point-to-point connection between vm and host
&gt;
&gt; Hi! hopefully someone can give me a hint with this:
&gt;
&gt;
&gt; I need to create a vm with a point-to-point connection to the host
&gt; using a /30 subnet. Right now i have this in the vm's xml for libvirt:
&gt;
&gt; &lt;interface type="network" name="eth0" onboot="yes"&gt;
&gt;   &lt;source network="default"/&gt;
&gt;   &lt;mac address="02:fd:00:00:01:00"/&gt;
&gt; &lt;/interface&gt;
&gt;
&gt;
&gt; Which brings up an interface in the vm that is configured later by a a
&gt; daemon, getting to this:
&gt;
&gt; vnx@r2:~$ ifconfig eth0
&gt; eth0     Link encap:Ethernet  HWaddr 02:fd:00:00:01:00
&gt;          inet addr:10.250.0.2  Bcast:10.250.0.3  Mask:255.255.255.252
&gt;
&gt;
&gt; While in the host the other interface is created:
&gt;
&gt; root@tau:/home/jorge/workspace/vnx# ifconfig r2-e0
&gt; r2-e0     Link encap:Ethernet  HWaddr 0a:81:b6:3c:24:15
&gt;          inet addr:10.250.0.1  Bcast:10.250.0.3  Mask:255.255.255.252
&gt;
&gt;
&gt; However there is no connectivity between them, probably because of
&gt; some mistake in the &lt;interface&gt; tag, perhaps a wrong 'type' attribute,
&gt; but i haven't found out yet. I wouldn't want to create a bridge and
&gt; connect both interfaces (vm's and host's) to the bridge, but to have
&gt; this ptp, if possible. How would i go about doing that?
&gt;
&gt; thanks!
&gt; Jorge
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

</body></email><email><emailId>20110413200548</emailId><senderName>Igor Serebryany</senderName><senderEmail>igor47@moomers.org</senderEmail><timestampReceived>2011-04-13 20:05:48-0400</timestampReceived><subject>Re: [libvirt-users] virsh shutdown</subject><body>


As eblake mentioned on the other mailing list, you have to have an ACPI
daemon listening for ACPI events in the guest in order for 'virsh
shutdown' or 'virsh reboot' to do anything. If the guest or the ACPI
daemon crash, 'virsh shutdown' won't work.

In my own code, I set a timeout of a minute to let guests shut down
using the 'shutdown' command, and if the guest is still up after that
time I issue a 'destroy'.

--Igor

On Wed, Apr 13, 2011 at 06:56:15PM +0300, Zvi Dubitzky wrote:
&gt; Hi
&gt; For some reason recent libvirt code (0.8.3 and even before) the 'virsh 
&gt; shutdown &lt;domain&gt; ' is not effective .
&gt; It issues an ok message but the  domians remains in a runnning state . 
&gt; Only th e destroy works fine.
&gt; 
&gt; Any idea ?
&gt; 
&gt; thanks
&gt; 
&gt; Zvi Dubitzky 
&gt; Email:dubi@il.ibm.com
&gt; 
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20110415073447</emailId><senderName>Jan</senderName><senderEmail>jan@agetty.de</senderEmail><timestampReceived>2011-04-15 07:34:47-0400</timestampReceived><subject>Re: [libvirt-users] custom iptables rules</subject><body>

Hi Kurian,

On 04/09/2011 06:59 PM Kurian Thayil wrote:
&gt; Is there a way that we can add custom IP-Tables rules in a nat'd
&gt; physical host? I need some custom rules mentioned in physical host to
&gt; access some services in the guest systems. Any hints on this?

set your iptables ruleset as you would do it normally e.g. by using your
own firewall-script or the config-tool of the respective distribution
(yast, shorewall [...]).

Usually, before replacing the current ruleset, the firewall script itself
should delete existing all existing chains and also flush all tables.
Finally you will have to restart your libvirt daemon to manipulate the
existing ruleset to reflect it's configuration constraints.

This approach is less tricky as writing a script catching all use cases
needed in order to modify the existing ruleset, which is based on libvirt
definitions. Nevertheless, it would still be nice to see such a feature
which enables the user to manage custom rulesets with libvirt instead.

Hope this helps.. ;)

kind regards
Jan

</body></email><email><emailId>20110415074612</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-04-15 07:46:12-0400</timestampReceived><subject>Re: [libvirt-users] Where actually is the callback triggered?</subject><body>

2011/4/15 kadir yüceer &lt;kadiryuceer@gmail.com&gt;:
&gt;
&gt;
&gt; 2011/4/14 Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;
&gt;&gt;
&gt;&gt; 2011/4/14 kadir yüceer &lt;kadiryuceer@gmail.com&gt;:
&gt;&gt; &gt; Hi all,
&gt;&gt; &gt;
&gt;&gt; &gt; Quick question:
&gt;&gt; &gt; When the hypervisor triggers a callback which is registered for generic
&gt;&gt; &gt; events, (assuming I'm connected through qemu+tcp) where exactly is the
&gt;&gt; &gt; callback triggered? On the hypervisor host or on my host?
&gt;&gt; &gt;
&gt;&gt; &gt; Regards
&gt;&gt; &gt; Kadir
&gt;&gt; &gt;
&gt;&gt;
&gt;&gt; The event system is more complex.
&gt;&gt;
&gt;&gt; The hypervisor/connection driver add events to a queue. The events
&gt;&gt; from this queue are transported to the client and can trigger you
&gt;&gt; registered callbacks.
&gt;&gt;
&gt;&gt; In order to have your callbacks called you need to register an "event
&gt;&gt; implementation" that is responsible for driving the event delivery.
&gt;&gt; Recent libvirt exposed it's default "event implementation" via
&gt;&gt; virEventRegisterDefaultImpl().
&gt;&gt;
&gt;&gt; In order to have events delivered to your callbacks you need to call
&gt;&gt; virEventRegisterDefaultImpl() or virEventRegisterImpl() with your own
&gt;&gt; "event implementation".
&gt;&gt;
&gt;&gt; I assume you're still talking about the Java bindings here then you
&gt;&gt; hit the problem that the bindings are incomplete and don't export
&gt;&gt; virEventRegisterImpl() nor virEventRegisterDefaultImpl() yet. This
&gt;&gt; means that the event related part of the libvirt API can not be used
&gt;&gt; from the Java bindings yet.
&gt;&gt;
&gt;&gt;
&gt;&gt; A totally untested patch to add virEventRegisterDefaultImpl() looks like
&gt;&gt; this:
&gt;&gt;
&gt;&gt;
&gt;&gt; diff --git a/src/main/java/org/libvirt/jna/Libvirt.java
&gt;&gt; b/src/main/java/org/libvirt/jna/Libvirt.java
&gt;&gt; index 2c8c03d..5b73859 100644
&gt;&gt; --- a/src/main/java/org/libvirt/jna/Libvirt.java
&gt;&gt; +++ b/src/main/java/org/libvirt/jna/Libvirt.java
&gt;&gt; @@ -373,4 +373,7 @@ public interface Libvirt extends Library {
&gt;&gt;     public int virNWFilterGetUUID(NetworkFilterPointer
&gt;&gt; virNWFilterPtr, byte[] uuidString);
&gt;&gt;     public int virNWFilterGetUUIDString(NetworkFilterPointer
&gt;&gt; virNWFilterPtr, byte[] uuidString);
&gt;&gt;     public int virNWFilterUndefine(NetworkFilterPointer virNWFilterPtr);
&gt;&gt; +
&gt;&gt; +    // Event Methods
&gt;&gt; +    public int virEventRegisterDefaultImpl(void);
&gt;&gt;  }
&gt;&gt;
&gt;&gt;
&gt;&gt; Then import org.libvirt.jna.Libvirt in your code and call:
&gt;&gt;
&gt;&gt; Libvirt.INSTANCE.virEventRegisterDefaultImpl()
&gt;&gt;
&gt;&gt; This _should_ register the default event implementation and make
&gt;&gt; events work for you assuming the rest of your event related code is
&gt;&gt; correct.
&gt;&gt;
&gt;&gt; Matthias
&gt;
&gt; First of all, thanks for the answer Matthias, I've been looking for help for
&gt; some time.
&gt;
&gt; I had already tried your suggestion, I added the function just as the same
&gt; way you did above, and I have this error:
&gt;
&gt; Exception in thread "main" java.lang.UnsatisfiedLinkError: Error looking up
&gt; function 'virEventRegisterDefaultImpl': /usr/local/lib/libvirt.so: undefined
&gt; symbol: virEventRegisterDefaultImpl
&gt;         at com.sun.jna.Function.&lt;init&gt;(Function.java:179)
&gt;         at com.sun.jna.NativeLibrary.getFunction(NativeLibrary.java:345)
&gt;         at com.sun.jna.NativeLibrary.getFunction(NativeLibrary.java:325)
&gt;         at com.sun.jna.Library$Handler.invoke(Library.java:203)
&gt;         at $Proxy0.virEventRegisterDefaultImpl(Unknown Source)
&gt;         at novatest_v03.MainFrame.main(MainFrame.java:168)
&gt;

virEventRegisterDefaultImpl was added in libvirt 0.9.0. Your libvirt
is probably too old.

Matthias

</body></email><email><emailId>20110415204617</emailId><senderName>Nataraj</senderName><senderEmail>incoming-redhat@rjl.com</senderEmail><timestampReceived>2011-04-15 20:46:17-0400</timestampReceived><subject>Re: [libvirt-users] Problems setting up bridge</subject><body>

On 04/15/2011 01:13 PM, Alex wrote:
&gt; Hi,
&gt; I have a fc14 box with two interfaces that I'm having some difficulty
&gt; setting up a bridge properly. I have a few kvm guests set up and
&gt; running, but I've switched from using NetworkManager to using standard
&gt; networking with a bridge. I've modified the ifcfg-eth0 and created
&gt; ifcfg-br0 as per the standard documentation, but I think I'm having
&gt; routing problems. This is what the network looks like:
&gt;
&gt; [root@fc14 ~]# route
&gt; Kernel IP routing table
&gt; Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
&gt; 68.195.XXX.40   *               255.255.255.248 U     0      0        0 br0
&gt; 192.168.1.0     *               255.255.255.0   U     0      0        0 eth1
&gt; 192.168.125.0   *               255.255.255.0   U     0      0        0 virbr0
&gt; link-local      *               255.255.0.0     U     1003   0        0 eth1
&gt; link-local      *               255.255.0.0     U     1004   0        0 br0
&gt; default         ool-44c3c129.st 0.0.0.0         UG    0      0        0 br0
&gt;
&gt; br0       Link encap:Ethernet  HWaddr 40:61:86:4E:84:09
&gt;           inet addr:68.195.XXX.42  Bcast:68.195.XXX.47  Mask:255.255.255.248
&gt;           inet6 addr: fe80::a0e7:ecff:fefd:340a/64 Scope:Link
&gt;           UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
&gt;           RX packets:3883 errors:0 dropped:0 overruns:0 frame:0
&gt;           TX packets:3579 errors:0 dropped:0 overruns:0 carrier:0
&gt;           collisions:0 txqueuelen:0
&gt;           RX bytes:1818327 (1.7 MiB)  TX bytes:590720 (576.8 KiB)
&gt;
&gt; eth0      Link encap:Ethernet  HWaddr 40:61:86:4E:84:09
&gt;           inet6 addr: fe80::4261:86ff:fe4e:8409/64 Scope:Link
&gt;           UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
&gt;           RX packets:3891 errors:0 dropped:0 overruns:0 frame:0
&gt;           TX packets:3551 errors:0 dropped:0 overruns:0 carrier:1
&gt;           collisions:0 txqueuelen:1000
&gt;           RX bytes:1873169 (1.7 MiB)  TX bytes:588302 (574.5 KiB)
&gt;           Interrupt:42
&gt;
&gt; eth1      Link encap:Ethernet  HWaddr 00:0E:0C:3B:36:F4
&gt;           inet addr:192.168.1.1  Bcast:192.168.1.255  Mask:255.255.255.0
&gt;           inet6 addr: fe80::20e:cff:fe3b:36f4/64 Scope:Link
&gt;           UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
&gt;           RX packets:7622 errors:0 dropped:0 overruns:0 frame:0
&gt;           TX packets:6936 errors:0 dropped:0 overruns:0 carrier:0
&gt;           collisions:0 txqueuelen:1000
&gt;           RX bytes:1062687 (1.0 MiB)  TX bytes:4304984 (4.1 MiB)
&gt;
&gt; virbr0    Link encap:Ethernet  HWaddr E6:ED:D2:6E:58:5C
&gt;           inet addr:192.168.125.1  Bcast:192.168.125.255  Mask:255.255.255.0
&gt;           UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
&gt;           RX packets:0 errors:0 dropped:0 overruns:0 frame:0
&gt;           TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
&gt;           collisions:0 txqueuelen:0
&gt;           RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)
&gt;
&gt; vnet0     Link encap:Ethernet  HWaddr FE:54:00:67:2C:4C
&gt;           inet6 addr: fe80::fc54:ff:fe67:2c4c/64 Scope:Link
&gt;           UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
&gt;           RX packets:5 errors:0 dropped:0 overruns:0 frame:0
&gt;           TX packets:391 errors:0 dropped:0 overruns:0 carrier:0
&gt;           collisions:0 txqueuelen:500
&gt;           RX bytes:300 (300.0 b)  TX bytes:23358 (22.8 KiB)
&gt;
&gt; I've left out the loopback for simplicity. The problem is that I can't
&gt; reach the br0 device from a server on the eth1 device (the 192.168.
&gt; network).
Since the bridge is attached to the 68.195 network, you won't be able to
reach it from the 192.168.1 network unless this system (or another one)
is configured as a router.   To use it as a router you will need to
enable net.ipv4.ip_forward in /etc/sysctl.conf (echo '1' &gt;
/proc/sys/net/ipv4/ip_forward) and then either run a dynamic routing
protocol or setup static routes on any other system that wants to reach
it from the 192.168.1 network.  The static routes for 68.195.xxx should
point at 192.168.1.1.

Nataraj
&gt; Is this a routing issue? Should I also add the eth1 device to the
&gt; bridge? If so, how would I do that?
&gt;
&gt; Also, can you explain under what circumstances a tun device would be
&gt; used? Does that have any relation to bridging?
&gt;
&gt; Thanks,
&gt; Alex
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110304091302</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-03-04 09:13:02-0400</timestampReceived><subject>Re: [libvirt-users] libvirt + ESX (HTTP response code 400 for call to 'Login')</subject><body>

2011/3/4 Hereward Cooper &lt;hereward.cooper@iomart.com&gt;:
&gt; [...]
&gt;&gt; 400 means bad request. You probably have a character in you password
&gt;&gt; that needs to be escaped in XML: &lt;, &gt;, &amp;, ', "
&gt;&gt;
&gt;&gt; libvirt currently doesn't escape the password properly when building
&gt;&gt; the SOAP request. You can manually workaround this by entering the
&gt;&gt; password in escaped form. For example when your password is some&amp;word
&gt;&gt; enter some&amp;word instead.
&gt;
&gt; That's fixed it! Thanks for the help.
&gt;
&gt; Cheers.
&gt;
&gt; Coops.
&gt;

The patch was accepted and this will be fixed in the next libvirt release.

Matthias

</body></email><email><emailId>20110304183332</emailId><senderName></senderName><senderEmail>knawnd</senderEmail><timestampReceived>2011-03-04 18:33:32-0400</timestampReceived><subject>[libvirt-users] /etc/vz/vznetctl.conf has to be /etc/vz/vznet.conf</subject><body>

Hi!

In [1] it's written that "Then a generic configuration file 
/etc/vz/vznetctl.conf must be created containing [...]" whereas it has 
to be /etc/vz/vznet.conf since /usr/sbin/vznetcfg script has the 
following line
VZNETCFG='/etc/vz/vznet.conf'

vzctl version is 3.0.26-1.

Best regards,
Nikolay.

[1] http://libvirt.org/drvopenvz.html

</body></email><email><emailId>20110304183739</emailId><senderName></senderName><senderEmail>knawnd</senderEmail><timestampReceived>2011-03-04 18:37:39-0400</timestampReceived><subject>[libvirt-users] wrong domain type for openvz</subject><body>

Hi!

Is there any progress on issue mentioned in [1]? I mean the issue when 
xml file has VM type as openvz but 'virsh dumpxml &lt;VMID&gt;' returns domain 
type qemu. I still have issue in libvirt-0.8.8.

BR,
Nikolay.


[1] http://osdir.com/ml/libvir-list/2009-07/msg00635.html

</body></email><email><emailId>20110304191035</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2011-03-04 19:10:35-0400</timestampReceived><subject>Re: [libvirt-users] Connecting to Standalone KVM</subject><body>

On 03/04/2011 01:47 PM, Markiewicz, Patrick F (N-No Laurels) wrote:
&gt;
&gt; Hi,
&gt;
&gt; Can virsh be used to connect to a standalone KVM?  I.e. I started a 
&gt; KVM from the command line, and I wondered how to connect to it.  Virsh 
&gt; list shows no VMs.  Thanks.
&gt;

No. libvirt (and consequently virsh) only knows about guests that were 
defined/created/started via the libvirt API.

There is a virsh command to help you convert from your hand-written qemu 
commandline to a libvirt domain XML - "virsh domxml-from-native". You'll 
still have quite a bit of work left when it's done, but it's a start. If 
your concern is having access to qemu's monitor interface, virsh in 
newer versions of libvirt has the command "virsh qemu-monitor-command", 
which is 100% unsupported, but available.

</body></email><email><emailId>20110304194215</emailId><senderName>"Markiewicz, Patrick F (N-No Laurels)"</senderName><senderEmail>patrick.f.markiewicz@lmco.com</senderEmail><timestampReceived>2011-03-04 19:42:15-0400</timestampReceived><subject>Re: [libvirt-users] EXTERNAL: Re:  Connecting to Standalone KVM</subject><body>

Thanks.  Strange, after all the keywords I searched for today, after your email I looked up 'kvm-qemu config' and found exactly the explanation I needed here: "Converting from QEMU args to domain XML" http://libvirt.org/drvqemu.html


-----Original Message-----
From: libvirt-users-bounces@redhat.com [mailto:libvirt-users-bounces@redhat.com] On Behalf Of Laine Stump
Sent: Friday, March 04, 2011 2:11 PM
To: libvirt-users@redhat.com
Subject: EXTERNAL: Re: [libvirt-users] Connecting to Standalone KVM

On 03/04/2011 01:47 PM, Markiewicz, Patrick F (N-No Laurels) wrote:
&gt;
&gt; Hi,
&gt;
&gt; Can virsh be used to connect to a standalone KVM?  I.e. I started a 
&gt; KVM from the command line, and I wondered how to connect to it.  Virsh 
&gt; list shows no VMs.  Thanks.
&gt;

No. libvirt (and consequently virsh) only knows about guests that were 
defined/created/started via the libvirt API.

There is a virsh command to help you convert from your hand-written qemu 
commandline to a libvirt domain XML - "virsh domxml-from-native". You'll 
still have quite a bit of work left when it's done, but it's a start. If 
your concern is having access to qemu's monitor interface, virsh in 
newer versions of libvirt has the command "virsh qemu-monitor-command", 
which is 100% unsupported, but available.

_______________________________________________
libvirt-users mailing list
libvirt-users@redhat.com
https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110306105311</emailId><senderName>Tapas Mishra</senderName><senderEmail>mightydreams@gmail.com</senderEmail><timestampReceived>2011-03-06 10:53:11-0400</timestampReceived><subject>[libvirt-users] guest creation problem on pv dom0 kernel</subject><body>

I am having problem in guest creation for a pv-ops Dom0 kernel
I compiled every thing from scratch.(Xen and 2.6.32.27 pv-ops dom0 kernel)
on a Ubuntu Desktop 10.04 64 bit.
Following is my config file for 2.6.32.27
http://pastebin.com/AvSVgVQE
and the error  I am getting trying to create a guest  with virt-install is


ERROR    unable to connect to 'localhost:8000': Connection refused
Traceback (most recent call last):
 File "/usr/bin/virt-install", line 943, in &lt;module&gt;
   main()
 File "/usr/bin/virt-install", line 715, in main
   conn = cli.getConnection(options.connect)
 File "/usr/lib/pymodules/python2.6/virtinst/cli.py", line 162, in
getConnection
   conn = open_connection(connect)
 File "/usr/lib/pymodules/python2.6/virtinst/cli.py", line 177, in
open_connection
   open_flags)
 File "/usr/lib/python2.6/dist-packages/libvirt.py", line 111, in openAuth
   if ret is None:raise libvirtError('virConnectOpenAuth() failed')
libvirtError: unable to connect to 'localhost:8000': Connection refused


I am able to see xm info output but some how the guest creation is failing.

I could be wrong, but this doesn't appear to be a kernel problem. Especially
if xm info is working, so the xen service has started already.
Maybe my libvirt version doesn't know how to use the xen 4.0 utils or the
pvops kernel?


I  tried creating a guest by virt-manager also which when installed via
 apt-get install ubuntu-virt-server ubuntu-virt-mgmt
installs following
http://packages.ubuntu.com/lucid/&lt;http://packages.ubuntu.com/lucid/libvirt-bin&gt;
ubuntu-virt-server
http://packages.ubuntu.com/lucid/&lt;http://packages.ubuntu.com/lucid/libvirt-bin&gt;
ubuntu-virt-mgmt

Now when I open virt-manager the option to create guest by installing  from
a   ISO present on hard disk locally or even
PXE are greyed out.virt-manager version is 0.8.2


virsh version
Compiled against library: libvir 0.7.5
Using library: libvir 0.7.5
Using API: QEMU 0.7.5
Running hypervisor: QEMU 0.12.3

This above output is wrong as instead of QEMU it should show Xen.
I installed it via apt-get install libvirt-bin
when you do an apt-get install libvirt-bin python-libvirt then it installs
following
http://packages.ubuntu.com/lucid/libvirt-bin
http://packages.ubuntu.com/lucid/python-libvirt

It appears it is a problem with libvirt-bin and it does not know how to
create a pv-ops Dom0 guest.
The machine where I am trying all this is a non VT 64 bit machine and trying
to create 32 bit guests on it.
Can some one confirm me the same or tell what did I missed in above?
-- 
http://mightydreams.blogspot.com

[Attachment #3 (text/html)]

&lt;meta http-equiv="content-type" content="text/html; charset=utf-8"&gt;&lt;span \
class="Apple-style-span" style="border-collapse: collapse; font-family: arial, \
sans-serif; font-size: 13px; "&gt;I am having problem in guest creation for a pv-ops \
Dom0 kernel &lt;br&gt; I compiled every thing from scratch.(Xen and 2.6.32.27 pv-ops dom0 \
kernel)&lt;/span&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="arial, sans-serif"&gt;&lt;span \
class="Apple-style-span" style="border-collapse: collapse;"&gt;on a Ubuntu Desktop 10.04 \
64 bit.&lt;br&gt; &lt;/span&gt;&lt;/font&gt;&lt;div&gt;&lt;span class="Apple-style-span" style="border-collapse: \
collapse; font-family: arial, sans-serif; font-size: 13px; "&gt;Following is my config \
file for 2.6.32.27&lt;br&gt;&lt;a href="http://pastebin.com/AvSVgVQE" target="_blank" \
style="color: rgb(42, 93, 176); "&gt;http://pastebin.com/AvSVgVQE&lt;/a&gt;&lt;br&gt; and the error  \
I am getting trying to create a guest  with virt-install is &lt;br&gt;&lt;br&gt;&lt;br&gt;ERROR    \
unable to connect to 'localhost:8000': Connection refused&lt;br&gt;Traceback (most \
recent call last):&lt;br&gt; File "/usr/bin/virt-install", line 943, in \
&lt;module&gt;&lt;br&gt;  main()&lt;br&gt; File "/usr/bin/virt-install", line 715, in \
main&lt;br&gt;   conn = cli.getConnection(options.connect)&lt;br&gt; File \
"/usr/lib/pymodules/python2.6/virtinst/cli.py", line 162, in \
getConnection&lt;br&gt;   conn = open_connection(connect)&lt;br&gt;  File \
"/usr/lib/pymodules/python2.6/virtinst/cli.py", line 177, in \
open_connection&lt;br&gt;   open_flags)&lt;br&gt; File \
"/usr/lib/python2.6/dist-packages/libvirt.py", line 111, in openAuth&lt;br&gt;   \
                if ret is None:raise libvirtError('virConnectOpenAuth() \
                failed')&lt;br&gt;
libvirtError: unable to connect to 'localhost:8000': Connection \
refused&lt;br&gt;&lt;br&gt;&lt;br&gt;I am able to see xm info output but some how the guest creation is \
failing.&lt;/span&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="arial, sans-serif"&gt;&lt;span \
class="Apple-style-span" style="border-collapse: collapse;"&gt;&lt;meta \
http-equiv="content-type" content="text/html; charset=utf-8"&gt;&lt;span \
class="Apple-style-span" style="font-size: 13px; "&gt;&lt;br \
class="Apple-interchange-newline"&gt; I could be wrong, but this doesn't appear to \
be a kernel problem. Especially if xm info is working, so the xen service has started \
already.&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="arial, \
sans-serif"&gt;&lt;span class="Apple-style-span" style="border-collapse: collapse;"&gt;&lt;span \
class="Apple-style-span" style="font-size: 13px; "&gt;Maybe my libvirt version \
doesn't know how to use the xen 4.0 utils or the pvops \
kernel?&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font class="Apple-style-span" face="arial, \
sans-serif"&gt;&lt;span class="Apple-style-span" style="border-collapse: \
collapse;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="arial, \
sans-serif"&gt;&lt;span class="Apple-style-span" style="border-collapse: collapse;"&gt;&lt;br&gt; \
&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="arial, \
sans-serif"&gt;&lt;span class="Apple-style-span" style="border-collapse: collapse;"&gt;&lt;meta \
http-equiv="content-type" content="text/html; charset=utf-8"&gt;&lt;span \
class="Apple-style-span" style="font-family: arial; border-collapse: separate; \
"&gt;&lt;div&gt; I  tried creating a guest by virt-manager also which when installed \
via&lt;/div&gt;&lt;div&gt;&lt;span class="Apple-style-span" style="border-collapse: collapse; \
font-family: arial, sans-serif; font-size: 13px; "&gt; apt-get install \
ubuntu-virt-server ubuntu-virt-mgmt&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span class="Apple-style-span" \
style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px; \
"&gt;installs following&lt;br&gt;&lt;span class="Apple-style-span" style="font-size: small; "&gt;&lt;a \
href="http://packages.ubuntu.com/lucid/libvirt-bin"&gt;http://packages.ubuntu.com/lucid/&lt;/a&gt;&lt;/span&gt;ubuntu-virt-server&lt;/span&gt;&lt;/div&gt;
 &lt;div&gt;&lt;span class="Apple-style-span" style="border-collapse: collapse; font-family: \
arial, sans-serif; font-size: 13px; "&gt;&lt;span class="Apple-style-span" \
style="font-size: small; "&gt;&lt;a \
href="http://packages.ubuntu.com/lucid/libvirt-bin"&gt;http://packages.ubuntu.com/lucid/&lt;/a&gt;&lt;/span&gt;ubuntu-virt-mgmt&lt;/span&gt;&lt;/div&gt;
 &lt;div&gt;&lt;span class="Apple-style-span" style="border-collapse: collapse; font-family: \
arial, sans-serif; font-size: 13px; "&gt;&lt;br&gt;Now when I open virt-manager the option to \
create guest by installing  from a   ISO present on hard disk locally or even &lt;br&gt; \
PXE are greyed out.virt-manager version is 0.8.2&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
class="Apple-style-span" style="border-collapse: collapse; font-family: arial, \
sans-serif; font-size: 13px; "&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt; \
&lt;div&gt;&lt;font class="Apple-style-span" face="arial, sans-serif"&gt;&lt;span \
class="Apple-style-span" style="border-collapse: \
collapse;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="arial, \
sans-serif"&gt;&lt;span class="Apple-style-span" style="border-collapse: collapse;"&gt;&lt;div&gt; \
virsh version&lt;/div&gt;&lt;div&gt;Compiled against library: libvir 0.7.5&lt;/div&gt;&lt;div&gt;Using \
library: libvir 0.7.5&lt;/div&gt;&lt;div&gt;Using API: QEMU 0.7.5&lt;/div&gt;&lt;div&gt;Running hypervisor: \
QEMU 0.12.3&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;This above output is wrong as instead of QEMU it \
should show Xen.&lt;/div&gt; &lt;div&gt;I installed it via apt-get install \
libvirt-bin&lt;/div&gt;&lt;div&gt;when you do an apt-get install libvirt-bin python-libvirt then \
it installs following&lt;/div&gt;&lt;div&gt;&lt;meta http-equiv="content-type" content="text/html; \
charset=utf-8"&gt;&lt;a href="http://packages.ubuntu.com/lucid/libvirt-bin"&gt;http://packages.ubuntu.com/lucid/libvirt-bin&lt;/a&gt;&lt;/div&gt;
 &lt;div&gt;&lt;meta http-equiv="content-type" content="text/html; charset=utf-8"&gt;&lt;a \
href="http://packages.ubuntu.com/lucid/python-libvirt"&gt;http://packages.ubuntu.com/lucid/python-libvirt&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/span&gt;&lt;/font&gt;&lt;div&gt;
 &lt;span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, \
sans-serif; font-size: 13px; "&gt;It appears it is a problem with libvirt-bin and it \
does not know how to create a pv-ops Dom0 guest.&lt;/span&gt;&lt;/div&gt; &lt;/div&gt;&lt;div&gt;&lt;span \
class="Apple-style-span" style="border-collapse: collapse; font-family: arial, \
sans-serif; font-size: 13px; "&gt;The machine where I am trying all this is a non VT 64 \
bit machine and trying to create 32 bit guests on it.&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span \
class="Apple-style-span" style="border-collapse: collapse; font-family: arial, \
sans-serif; font-size: 13px; "&gt;Can some one confirm me the same or tell what did I \
missed in above?&lt;/span&gt;&lt;/div&gt;&lt;div&gt;-- &lt;br&gt;&lt;a href="http://mightydreams.blogspot.com" \
target="_blank"&gt;http://mightydreams.blogspot.com&lt;/a&gt;&lt;br&gt;

&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20110308053943</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-03-08 05:39:43-0400</timestampReceived><subject>Re: [libvirt-users] CDROM</subject><body>

ÓÚ 2011Äê03Ô 08ÈÕ 05:29, Markiewicz, Patrick F (N-No Laurels) Ð´µÀ:
&gt; How would I ¡°insert¡± a cdrom into a running virtual machine?
&gt; 

$ virsh help attach-device
$ virsh help attach-disk

Regards
Osier

</body></email><email><emailId>20110308224700</emailId><senderName>Jasper</senderName><senderEmail>js@i32.nl</senderEmail><timestampReceived>2011-03-08 22:47:00-0400</timestampReceived><subject>[libvirt-users] Python API and events, how to deal with libvirtd stop/start</subject><body>

Hi list,

I'm using the Python API to check for libvirt events. Works well, but 
when libvirtd is restarted, or stopped completely, the events are no 
longer seen. I guess this is logical, but how would I deal with this 
situation ?

I can re-open the connection to libvirt and re-register the callbacks, 
but this does not work. If I call virEventLoopPureRegister() again, the 
app crashes with a glibc error.

Any ideas ? You can reproduce this by using the event-test.py supplied 
with libvirt. Fire it up, restart libvirtd and see what happens when you 
start or stop a domain for example.

Many thanks for any pointers.

- Jasper

</body></email><email><emailId>20110304184748</emailId><senderName>"Markiewicz, Patrick F (N-No Laurels)"</senderName><senderEmail>patrick.f.markiewicz@lmco.com</senderEmail><timestampReceived>2011-03-04 18:47:48-0400</timestampReceived><subject>[libvirt-users] Connecting to Standalone KVM</subject><body>

Hi,

Can virsh be used to connect to a standalone KVM?  I.e. I started a KVM from the \
command line, and I wondered how to connect to it.  Virsh list shows no VMs.  Thanks.

Patrick


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:x="urn:schemas-microsoft-com:office:excel" \
xmlns:p="urn:schemas-microsoft-com:office:powerpoint" \
xmlns:a="urn:schemas-microsoft-com:office:access" \
xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882" \
xmlns:s="uuid:BDC6E3F0-6DA3-11d1-A2A3-00AA00C14882" \
xmlns:rs="urn:schemas-microsoft-com:rowset" xmlns:z="#RowsetSchema" \
xmlns:b="urn:schemas-microsoft-com:office:publisher" \
xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" \
xmlns:c="urn:schemas-microsoft-com:office:component:spreadsheet" \
xmlns:odc="urn:schemas-microsoft-com:office:odc" \
xmlns:oa="urn:schemas-microsoft-com:office:activation" \
xmlns:html="http://www.w3.org/TR/REC-html40" \
xmlns:q="http://schemas.xmlsoap.org/soap/envelope/" \
xmlns:rtc="http://microsoft.com/officenet/conferencing" xmlns:D="DAV:" \
xmlns:Repl="http://schemas.microsoft.com/repl/" \
xmlns:mt="http://schemas.microsoft.com/sharepoint/soap/meetings/" \
xmlns:x2="http://schemas.microsoft.com/office/excel/2003/xml" \
xmlns:ppda="http://www.passport.com/NameSpace.xsd" \
xmlns:ois="http://schemas.microsoft.com/sharepoint/soap/ois/" \
xmlns:dir="http://schemas.microsoft.com/sharepoint/soap/directory/" \
xmlns:ds="http://www.w3.org/2000/09/xmldsig#" \
xmlns:dsp="http://schemas.microsoft.com/sharepoint/dsp" \
xmlns:udc="http://schemas.microsoft.com/data/udc" \
xmlns:xsd="http://www.w3.org/2001/XMLSchema" \
xmlns:sub="http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/" \
xmlns:ec="http://www.w3.org/2001/04/xmlenc#" \
xmlns:sp="http://schemas.microsoft.com/sharepoint/" \
xmlns:sps="http://schemas.microsoft.com/sharepoint/soap/" \
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" \
xmlns:udcs="http://schemas.microsoft.com/data/udc/soap" \
xmlns:udcxf="http://schemas.microsoft.com/data/udc/xmlfile" \
xmlns:udcp2p="http://schemas.microsoft.com/data/udc/parttopart" \
xmlns:wf="http://schemas.microsoft.com/sharepoint/soap/workflow/" \
xmlns:dsss="http://schemas.microsoft.com/office/2006/digsig-setup" \
xmlns:dssi="http://schemas.microsoft.com/office/2006/digsig" \
xmlns:mdssi="http://schemas.openxmlformats.org/package/2006/digital-signature" \
xmlns:mver="http://schemas.openxmlformats.org/markup-compatibility/2006" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns:mrels="http://schemas.openxmlformats.org/package/2006/relationships" \
xmlns:spwp="http://microsoft.com/sharepoint/webpartpages" \
xmlns:ex12t="http://schemas.microsoft.com/exchange/services/2006/types" \
xmlns:ex12m="http://schemas.microsoft.com/exchange/services/2006/messages" \
xmlns:pptsl="http://schemas.microsoft.com/sharepoint/soap/SlideLibrary/" \
xmlns:spsl="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService" \
xmlns:Z="urn:schemas-microsoft-com:" xmlns:st="" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;&lt;head&gt;&lt;META HTTP-EQUIV="Content-Type" \
CONTENT="text/html; charset=us-ascii"&gt;&lt;meta name=Generator content="Microsoft Word 12 \
(filtered medium)"&gt;&lt;style&gt;&lt;!-- /* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
--&gt;&lt;/style&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapelayout v:ext="edit"&gt;
&lt;o:idmap v:ext="edit" data="1" /&gt;
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;&lt;/head&gt;&lt;body lang=EN-US link=blue vlink=purple&gt;&lt;div \
class=WordSection1&gt;&lt;p class=MsoNormal&gt;Hi,&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;Can virsh be used to connect \
to a standalone KVM?  I.e. I started a KVM from the command line, and I wondered \
how to connect to it.  Virsh list shows no VMs.  Thanks. &lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;Patrick&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20110307212928</emailId><senderName>"Markiewicz, Patrick F (N-No Laurels)"</senderName><senderEmail>patrick.f.markiewicz@lmco.com</senderEmail><timestampReceived>2011-03-07 21:29:28-0400</timestampReceived><subject>[libvirt-users] CDROM</subject><body>

How would I "insert" a cdrom into a running virtual machine?

Patrick

[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:x="urn:schemas-microsoft-com:office:excel" \
xmlns:p="urn:schemas-microsoft-com:office:powerpoint" \
xmlns:a="urn:schemas-microsoft-com:office:access" \
xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882" \
xmlns:s="uuid:BDC6E3F0-6DA3-11d1-A2A3-00AA00C14882" \
xmlns:rs="urn:schemas-microsoft-com:rowset" xmlns:z="#RowsetSchema" \
xmlns:b="urn:schemas-microsoft-com:office:publisher" \
xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" \
xmlns:c="urn:schemas-microsoft-com:office:component:spreadsheet" \
xmlns:odc="urn:schemas-microsoft-com:office:odc" \
xmlns:oa="urn:schemas-microsoft-com:office:activation" \
xmlns:html="http://www.w3.org/TR/REC-html40" \
xmlns:q="http://schemas.xmlsoap.org/soap/envelope/" \
xmlns:rtc="http://microsoft.com/officenet/conferencing" xmlns:D="DAV:" \
xmlns:Repl="http://schemas.microsoft.com/repl/" \
xmlns:mt="http://schemas.microsoft.com/sharepoint/soap/meetings/" \
xmlns:x2="http://schemas.microsoft.com/office/excel/2003/xml" \
xmlns:ppda="http://www.passport.com/NameSpace.xsd" \
xmlns:ois="http://schemas.microsoft.com/sharepoint/soap/ois/" \
xmlns:dir="http://schemas.microsoft.com/sharepoint/soap/directory/" \
xmlns:ds="http://www.w3.org/2000/09/xmldsig#" \
xmlns:dsp="http://schemas.microsoft.com/sharepoint/dsp" \
xmlns:udc="http://schemas.microsoft.com/data/udc" \
xmlns:xsd="http://www.w3.org/2001/XMLSchema" \
xmlns:sub="http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/" \
xmlns:ec="http://www.w3.org/2001/04/xmlenc#" \
xmlns:sp="http://schemas.microsoft.com/sharepoint/" \
xmlns:sps="http://schemas.microsoft.com/sharepoint/soap/" \
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" \
xmlns:udcs="http://schemas.microsoft.com/data/udc/soap" \
xmlns:udcxf="http://schemas.microsoft.com/data/udc/xmlfile" \
xmlns:udcp2p="http://schemas.microsoft.com/data/udc/parttopart" \
xmlns:wf="http://schemas.microsoft.com/sharepoint/soap/workflow/" \
xmlns:dsss="http://schemas.microsoft.com/office/2006/digsig-setup" \
xmlns:dssi="http://schemas.microsoft.com/office/2006/digsig" \
xmlns:mdssi="http://schemas.openxmlformats.org/package/2006/digital-signature" \
xmlns:mver="http://schemas.openxmlformats.org/markup-compatibility/2006" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns:mrels="http://schemas.openxmlformats.org/package/2006/relationships" \
xmlns:spwp="http://microsoft.com/sharepoint/webpartpages" \
xmlns:ex12t="http://schemas.microsoft.com/exchange/services/2006/types" \
xmlns:ex12m="http://schemas.microsoft.com/exchange/services/2006/messages" \
xmlns:pptsl="http://schemas.microsoft.com/sharepoint/soap/SlideLibrary/" \
xmlns:spsl="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService" \
xmlns:Z="urn:schemas-microsoft-com:" xmlns:st="" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;&lt;head&gt;&lt;META HTTP-EQUIV="Content-Type" \
CONTENT="text/html; charset=us-ascii"&gt;&lt;meta name=Generator content="Microsoft Word 12 \
(filtered medium)"&gt;&lt;style&gt;&lt;!-- /* Font Definitions */
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
--&gt;&lt;/style&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapelayout v:ext="edit"&gt;
&lt;o:idmap v:ext="edit" data="1" /&gt;
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;&lt;/head&gt;&lt;body lang=EN-US link=blue vlink=purple&gt;&lt;div \
class=WordSection1&gt;&lt;p class=MsoNormal&gt;How would I “insert” a cdrom into a \
running virtual machine?&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;Patrick&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20110307161123</emailId><senderName></senderName><senderEmail>knawnd</senderEmail><timestampReceived>2011-03-07 16:11:23-0400</timestampReceived><subject>[libvirt-users] openvz specific values for domain/devices tag</subject><body>

Hi!

Could you, please, point me to where I can read about possible values 
for domain/devices tag in case of OpenVZ?

I couldn't find such info at [1] whereas e.g. filesystem is mentioned at 
[2] but not at [1].

Thanks!
Nikolay.

[1] http://libvirt.org/formatdomain.html#elementsDevices
[2] http://libvirt.org/drvopenvz.html

</body></email><email><emailId>20110308055914</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-03-08 05:59:14-0400</timestampReceived><subject>Re: [libvirt-users] openvz specific values for domain/devices tag</subject><body>

ÓÚ 2011Äê03Ô 08ÈÕ 00:11, knawnd@gmail.com Ð´µÀ:
&gt; Hi!
&gt; 
&gt; Could you, please, point me to where I can read about possible values 
&gt; for domain/devices tag in case of OpenVZ?
&gt; 
&gt; I couldn't find such info at [1] whereas e.g. filesystem is mentioned at 
&gt; [2] but not at [1].

IMHO it's a document BZ then,

&gt; 
&gt; Thanks!
&gt; Nikolay.
&gt; 
&gt; [1] http://libvirt.org/formatdomain.html#elementsDevices
&gt; [2] http://libvirt.org/drvopenvz.html
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110309090032</emailId><senderName></senderName><senderEmail>knawnd</senderEmail><timestampReceived>2011-03-09 09:00:32-0400</timestampReceived><subject>Re: [libvirt-users] openvz specific values for domain/devices tag</subject><body>

Osier Yang wrote on 08/03/11 08:59:
&gt; 于 2011年03月08日 00:11, knawnd@gmail.com 写道:
&gt;&gt; Hi!
&gt;&gt;
&gt;&gt; Could you, please, point me to where I can read about possible values
&gt;&gt; for domain/devices tag in case of OpenVZ?
&gt;&gt;
&gt;&gt; I couldn't find such info at [1] whereas e.g. filesystem is mentioned at
&gt;&gt; [2] but not at [1].
&gt; IMHO it's a document BZ then,
I submitted a bug https://bugzilla.redhat.com/show_bug.cgi?id=683355

Nikolay.

&gt;&gt; Thanks!
&gt;&gt; Nikolay.
&gt;&gt;
&gt;&gt; [1] http://libvirt.org/formatdomain.html#elementsDevices
&gt;&gt; [2] http://libvirt.org/drvopenvz.html
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; libvirt-users mailing list
&gt;&gt; libvirt-users@redhat.com
&gt;&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110309155533</emailId><senderName></senderName><senderEmail>knawnd</senderEmail><timestampReceived>2011-03-09 15:55:33-0400</timestampReceived><subject>Re: [libvirt-users] diskspace and diskinodes tag for openvz</subject><body>

Matthias Bolte wrote on 07/03/11 21:18:
&gt; 2011/3/7&lt;knawnd@gmail.com&gt;:
&gt;&gt; Hi!
&gt;&gt;
&gt;&gt; as far as I understood from "xml format for openvz driver" thread available
&gt;&gt; at [1] it should be possible to specify via libvirt disk size and disk
&gt;&gt; inodes for openvz VM.But the following device section in VM xml description
&gt;&gt; doesn't set disksize and diskinodes properly (it looks like those parameters
&gt;&gt; are taken from default OpenVZ config and not as they are specified in
&gt;&gt; libvirt tags):
&gt;&gt;   &lt;devices&gt;
&gt;&gt;     &lt;filesystem type='template'&gt;
&gt;&gt;       &lt;source name='centos-5-x86'/&gt;
&gt;&gt;       &lt;target dir='/'/&gt;
&gt;&gt;       &lt;quota type="size" max="100000"/&gt;
&gt;&gt;       &lt;quota type="inodes" max="200000"/&gt;
&gt;&gt;     &lt;/filesystem&gt;
&gt;&gt;   &lt;/devices&gt;
&gt;&gt;
&gt;&gt; Could anyone manage to set mentioned OpenVZ parameters properly? I am using
&gt;&gt; libvirt-0.8.8, CentOS 5.5, vzctl version is 3.0.26-1.
&gt;&gt;
&gt;&gt; Thanks!
&gt;&gt; Nikolay.
&gt;&gt;
&gt;&gt; [1] http://www.mail-archive.com/libvir-list@redhat.com/msg07329.html
&gt;&gt;
&gt; You are misunderstanding the referenced thread. It isn't about
&gt; available features in libvirt. In this thread Evgeniy suggests several
&gt; additions to libvirt domain XML format related to OpenVZ.
&gt;
&gt; The additions of quota control to the filesystem element have never
&gt; been implemented, so they are not available and you're just seeing
&gt; expected behavior.
Thanks for reply, Matthias!

I've just submitted a feature request: 
https://bugzilla.redhat.com/show_bug.cgi?id=683512

Nikolay.
&gt; Matthias

</body></email><email><emailId>20110310132554</emailId><senderName></senderName><senderEmail>knawnd</senderEmail><timestampReceived>2011-03-10 13:25:54-0400</timestampReceived><subject>Re: [libvirt-users] ifname in openvz container</subject><body>

I submitted a bug: https://bugzilla.redhat.com/show_bug.cgi?id=683834

knawnd@gmail.com wrote on 04/03/11 21:21:
&gt; sorry, I forgot to mention a vzctl version which is 3.0.26-1.
&gt;
&gt; knawnd@gmail.com wrote on 04/03/11 21:10:
&gt;&gt; Hi!
&gt;&gt;
&gt;&gt; Is there any way to specify ethernet device name to be created inside
&gt;&gt; the openvz container?
&gt;&gt; I could find such info at
&gt;&gt; http://libvirt.org/formatdomain.html#elementsNICS.
&gt;&gt; If I do as below I get br0 as ethernet device inside VM whereas I'd like
&gt;&gt; it to be eth0.
&gt;&gt;
&gt;&gt; $ cat ovz.xml
&gt;&gt; &lt;domain type='openvz' id='144'&gt;
&gt;&gt; &lt;name&gt;144&lt;/name&gt;
&gt;&gt; &lt;uuid&gt;0071c128-58b4-4688-be17-1e062a22b36c&lt;/uuid&gt;
&gt;&gt; &lt;vcpu&gt;1&lt;/vcpu&gt;
&gt;&gt; &lt;memory&gt;524288&lt;/memory&gt;
&gt;&gt; &lt;os&gt;
&gt;&gt; &lt;type&gt;exe&lt;/type&gt;
&gt;&gt; &lt;init&gt;/sbin/init&lt;/init&gt;
&gt;&gt; &lt;/os&gt;
&gt;&gt; &lt;devices&gt;
&gt;&gt; &lt;filesystem type='template'&gt;
&gt;&gt; &lt;source name='centos-5-x86'/&gt;
&gt;&gt; &lt;target dir='/'/&gt;
&gt;&gt; &lt;/filesystem&gt;
&gt;&gt; &lt;interface type='bridge'&gt;
&gt;&gt; &lt;source bridge='br0'/&gt;
&gt;&gt; &lt;/interface&gt;
&gt;&gt; &lt;/devices&gt;
&gt;&gt; &lt;/domain&gt;
&gt;&gt;
&gt;&gt; $ virsh create ovz.xml
&gt;&gt; Domain 144 created from ovz.xml
&gt;&gt;
&gt;&gt; $ grep -i netif /etc/vz/conf/144.conf
&gt;&gt; NETIF="ifname=br0,bridge=br0,mac=52:54:00:74:DD:F3,host_ifname=veth144.0,host_mac=52:54:00:06:78:76" 
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; br0 is a bridge on the server (CT0). But I would like to assign ethernet
&gt;&gt; device inside VM as eth0 i.e. ifname in VM config has to be eth0.
&gt;&gt; ovzkernel release is 2.6.18-194.26.1.el5.028stab081.1
&gt;&gt; OS is CentOS 5.5, libvirt/virsh version is 0.8.8.
&gt;&gt;
&gt;&gt; Best regards,
&gt;&gt; Nikolay.

</body></email><email><emailId>20110310141313</emailId><senderName></senderName><senderEmail>knawnd</senderEmail><timestampReceived>2011-03-10 14:13:13-0400</timestampReceived><subject>[libvirt-users] venet as network device for openvz based VMs</subject><body>

Hi!

Is there any way to use venet (http://wiki.openvz.org/Venet) for openvz 
based VM via libvirt?

Thanks!
Nikolay.

</body></email><email><emailId>20110310144849</emailId><senderName>Christoph Raible</senderName><senderEmail>c.raible@science-computing.de</senderEmail><timestampReceived>2011-03-10 14:48:49-0400</timestampReceived><subject>Re: [libvirt-users] unable to connect to libvirtd at '*': No route to	host</subject><body>

Am 10.03.2011 14:30, schrieb Christoph Raible:
&gt; Hi @all,
&gt; I have the following systems:
&gt; AMD Processor
&gt; Scientific Linux 6.0
&gt; Kernelversion: 2.6.32-71.18.2.el6.x86_64
&gt; KVM / Libvirt  out of the repository
&gt; I've setup my TLS-Certificates with the following howto
&gt; /http://wiki.libvirt.org/page/TLSSetup/
&gt; Now I want to connect the servers with
&gt; /virsh -c qemu+tls://nebula3/system/(nebula3 is the hostname)
&gt; but the following error message always is displayed:
&gt; /error: unable to connect to libvirtd at 'nebula3': No route to host
&gt; error: failed to connect to the hypervisor/
&gt; SELinux is disabled  and the servers are in the same IP-Range (ping works fine)
&gt; Passwordless ssh-login also works fine!
&gt; If I connect to a server with
&gt; qemu+ssh://nebula3/system
&gt; all wroks fine...
&gt; Installation with virt-manager an bridged networkinterface also works fine...
&gt;
&gt;
&gt; Did anyone of you have an idea where my problem is?
&gt;
&gt; Thanks for Help :)
&gt;
&gt;
&gt; Regards,
&gt;
&gt; Christoph
&gt; -- 
&gt; Vorstand/Board of Management:
&gt; Dr. Bernd Finkbeiner, Dr. Roland Niemeier,
&gt; Dr. Arno Steitz, Dr. Ingrid Zech
&gt; Vorsitzender des Aufsichtsrats/
&gt; Chairman of the Supervisory Board:
&gt; Michel Lepert
&gt; Sitz/Registered Office: Tuebingen
&gt; Registergericht/Registration Court: Stuttgart
&gt; Registernummer/Commercial Register No.: HRB 382196
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
I've resolved the problem :)

the default config of IP-Tables is / was wrong.... now I disabled 
iptables an all works fine.

Regards,

Christoph
-- 
Vorstand/Board of Management:
Dr. Bernd Finkbeiner, Dr. Roland Niemeier, 
Dr. Arno Steitz, Dr. Ingrid Zech
Vorsitzender des Aufsichtsrats/
Chairman of the Supervisory Board:
Michel Lepert
Sitz/Registered Office: Tuebingen
Registergericht/Registration Court: Stuttgart
Registernummer/Commercial Register No.: HRB 382196 


[Attachment #3 (unknown)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta content="text/html; charset=ISO-8859-15"
      http-equiv="Content-Type"&gt;
  &lt;/head&gt;
  &lt;body bgcolor="#ffffff" text="#000000"&gt;
    Am 10.03.2011 14:30, schrieb Christoph Raible:
    &lt;blockquote cite="mid:4D78D28B.1040205@science-computing.de"
      type="cite"&gt;
      &lt;meta http-equiv="content-type" content="text/html;
        charset=ISO-8859-15"&gt;
      &lt;pre&gt;Hi @all,&lt;/pre&gt;
      &lt;pre&gt;I have the following systems:&lt;/pre&gt;
      &lt;pre&gt;AMD Processor
Scientific Linux 6.0
Kernelversion: 2.6.32-71.18.2.el6.x86_64
KVM / Libvirt  out of the repository&lt;/pre&gt;
      &lt;pre&gt;I've setup my TLS-Certificates with the following howto&lt;/pre&gt;
      &lt;pre&gt;&lt;i&gt;&lt;a moz-do-not-send="true" class="moz-txt-link-freetext" \
href="http://wiki.libvirt.org/page/TLSSetup"&gt;http://wiki.libvirt.org/page/TLSSetup&lt;/a&gt;&lt;/i&gt;&lt;/pre&gt;
  &lt;pre&gt;Now I want to connect the servers with&lt;/pre&gt;
      &lt;pre&gt;&lt;i&gt;virsh -c qemu+tls://nebula3/system    &lt;/i&gt;(nebula3 is the \
hostname)&lt;/pre&gt;  &lt;pre&gt;but the following error message always is displayed:&lt;/pre&gt;
      &lt;pre&gt;&lt;i&gt;error: unable to connect to libvirtd at 'nebula3': No route to host
error: failed to connect to the hypervisor&lt;/i&gt;&lt;/pre&gt;
      &lt;pre&gt;SELinux is disabled  and the servers are in the same IP-Range (ping works \
fine) Passwordless ssh-login also works fine!&lt;/pre&gt;
      &lt;pre&gt;If I connect to a server with &lt;/pre&gt;
      &lt;pre&gt;qemu+ssh://nebula3/system   &lt;/pre&gt;
      &lt;pre&gt;all wroks fine...&lt;/pre&gt;
      &lt;pre&gt;Installation with virt-manager an bridged networkinterface also works \
fine...


Did anyone of you have an idea where my problem is?

Thanks for Help :)


Regards,

Christoph
&lt;/pre&gt;
      &lt;font face="monospace"&gt;-- &lt;br&gt;
        Vorstand/Board of Management:&lt;br&gt;
        Dr. Bernd Finkbeiner, Dr. Roland Niemeier, &lt;br&gt;
        Dr. Arno Steitz, Dr. Ingrid Zech&lt;br&gt;
        Vorsitzender des Aufsichtsrats/&lt;br&gt;
        Chairman of the Supervisory Board:&lt;br&gt;
        Michel Lepert&lt;br&gt;
        Sitz/Registered Office: Tuebingen&lt;br&gt;
        Registergericht/Registration Court: Stuttgart&lt;br&gt;
        Registernummer/Commercial Register No.: HRB 382196 &lt;br&gt;
      &lt;/font&gt;
      &lt;pre wrap=""&gt;
&lt;fieldset class="mimeAttachmentHeader"&gt;&lt;/fieldset&gt;
_______________________________________________
libvirt-users mailing list
&lt;a class="moz-txt-link-abbreviated" \
href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt; &lt;a \
class="moz-txt-link-freetext" \
href="https://www.redhat.com/mailman/listinfo/libvirt-users"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;/pre&gt;
  &lt;/blockquote&gt;
    I've resolved the problem :)&lt;br&gt;
    &lt;br&gt;
    the default config of IP-Tables is / was wrong.... now I disabled
    iptables an all works fine.&lt;br&gt;
    &lt;br&gt;
    Regards, &lt;br&gt;
    &lt;br&gt;
    Christoph&lt;br&gt;
  &lt;font face="monospace"&gt;-- &lt;br&gt;
Vorstand/Board of Management:&lt;br&gt;
Dr. Bernd Finkbeiner, Dr. Roland Niemeier, &lt;br&gt;
Dr. Arno Steitz, Dr. Ingrid Zech&lt;br&gt;
Vorsitzender des Aufsichtsrats/&lt;br&gt;
Chairman of the Supervisory Board:&lt;br&gt;
Michel Lepert&lt;br&gt;
Sitz/Registered Office: Tuebingen&lt;br&gt;
Registergericht/Registration Court: Stuttgart&lt;br&gt;
Registernummer/Commercial Register No.: HRB 382196 &lt;br&gt;
&lt;/font&gt;&lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20110311094615</emailId><senderName>Werner, ES-Best-Shore-Services-China-SH</senderName><senderEmail>"boninsegna, werner</senderEmail><timestampReceived>2011-03-11 09:46:15-0400</timestampReceived><subject>[libvirt-users] libvirt and phyp driver (Power Hypervisor guests)</subject><body>

Hi all,

I would like to ask about the status of the phyp driver to manage Power Hypervisor \
guests. According the documentation [1] the driver is supported, however it does not \
show up on the main driver page [2].

Has somebody already had experience using this driver in a productive or testing \
environment?

[1] http://libvirt.org/guide/html/Application_Development_Guide-Connections-URI_Formats.html
 [2] http://libvirt.org/drivers.html

Kind regards,
Werner
---
Werner Boninsegna
HP Enterprise Services


</body></email><email><emailId>20110307171525</emailId><senderName></senderName><senderEmail>knawnd</senderEmail><timestampReceived>2011-03-07 17:15:25-0400</timestampReceived><subject>[libvirt-users] diskspace and diskinodes tag for openvz</subject><body>

Hi!

as far as I understood from "xml format for openvz driver" thread 
available at [1] it should be possible to specify via libvirt disk size 
and disk inodes for openvz VM.But the following device section in VM xml 
description doesn't set disksize and diskinodes properly (it looks like 
those parameters are taken from default OpenVZ config and not as they 
are specified in libvirt tags):
   &lt;devices&gt;
     &lt;filesystem type='template'&gt;
       &lt;source name='centos-5-x86'/&gt;
       &lt;target dir='/'/&gt;
       &lt;quota type="size" max="100000"/&gt;
       &lt;quota type="inodes" max="200000"/&gt;
     &lt;/filesystem&gt;
   &lt;/devices&gt;

Could anyone manage to set mentioned OpenVZ parameters properly? I am 
using libvirt-0.8.8, CentOS 5.5, vzctl version is 3.0.26-1.

Thanks!
Nikolay.

[1] http://www.mail-archive.com/libvir-list@redhat.com/msg07329.html

</body></email><email><emailId>20110304181042</emailId><senderName></senderName><senderEmail>knawnd</senderEmail><timestampReceived>2011-03-04 18:10:42-0400</timestampReceived><subject>[libvirt-users] ifname in openvz container</subject><body>

Hi!

Is there any way to specify ethernet device name to be created inside 
the openvz container?
I could find such info at http://libvirt.org/formatdomain.html#elementsNICS.
If I do as below I get br0 as ethernet device inside VM whereas I'd like 
it to be eth0.

$ cat ovz.xml
&lt;domain type='openvz' id='144'&gt;
   &lt;name&gt;144&lt;/name&gt;
   &lt;uuid&gt;0071c128-58b4-4688-be17-1e062a22b36c&lt;/uuid&gt;
   &lt;vcpu&gt;1&lt;/vcpu&gt;
   &lt;memory&gt;524288&lt;/memory&gt;
   &lt;os&gt;
     &lt;type&gt;exe&lt;/type&gt;
     &lt;init&gt;/sbin/init&lt;/init&gt;
   &lt;/os&gt;
   &lt;devices&gt;
     &lt;filesystem type='template'&gt;
       &lt;source name='centos-5-x86'/&gt;
       &lt;target dir='/'/&gt;
     &lt;/filesystem&gt;
     &lt;interface type='bridge'&gt;
       &lt;source bridge='br0'/&gt;
     &lt;/interface&gt;
   &lt;/devices&gt;
&lt;/domain&gt;

$ virsh create ovz.xml
Domain 144 created from ovz.xml

$ grep -i netif /etc/vz/conf/144.conf
NETIF="ifname=br0,bridge=br0,mac=52:54:00:74:DD:F3,host_ifname=veth144.0,host_mac=52:54:00:06:78:76"


br0 is a bridge on the server (CT0). But I would like to assign ethernet 
device inside VM as eth0 i.e. ifname in VM config has to be eth0.
ovzkernel release is 2.6.18-194.26.1.el5.028stab081.1
OS is CentOS 5.5, libvirt/virsh version is 0.8.8.

Best regards,
Nikolay.

</body></email><email><emailId>20110310133051</emailId><senderName>Christoph Raible</senderName><senderEmail>c.raible@science-computing.de</senderEmail><timestampReceived>2011-03-10 13:30:51-0400</timestampReceived><subject>[libvirt-users] unable to connect to libvirtd at '*': No route to host</subject><body>

Hi @all,

I have the following systems:

AMD Processor
Scientific Linux 6.0
Kernelversion: 2.6.32-71.18.2.el6.x86_64
KVM / Libvirt  out of the repository

I've setup my TLS-Certificates with the following howto

/http://wiki.libvirt.org/page/TLSSetup/

Now I want to connect the servers with

/virsh -c qemu+tls://nebula3/system/(nebula3 is the hostname)

but the following error message always is displayed:

/error: unable to connect to libvirtd at 'nebula3': No route to host
error: failed to connect to the hypervisor/

SELinux is disabled  and the servers are in the same IP-Range (ping works fine)
Passwordless ssh-login also works fine!

If I connect to a server with

qemu+ssh://nebula3/system

all wroks fine...

Installation with virt-manager an bridged networkinterface also works fine...


Did anyone of you have an idea where my problem is?

Thanks for Help :)


Regards,

Christoph

-- 
Vorstand/Board of Management:
Dr. Bernd Finkbeiner, Dr. Roland Niemeier, 
Dr. Arno Steitz, Dr. Ingrid Zech
Vorsitzender des Aufsichtsrats/
Chairman of the Supervisory Board:
Michel Lepert
Sitz/Registered Office: Tuebingen
Registergericht/Registration Court: Stuttgart
Registernummer/Commercial Register No.: HRB 382196 


[Attachment #3 (unknown)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
  &lt;head&gt;

    &lt;meta http-equiv="content-type" content="text/html; charset=ISO-8859-15"&gt;
  &lt;/head&gt;
  &lt;body bgcolor="#ffffff" text="#000000"&gt;
    &lt;pre&gt;Hi @all,&lt;/pre&gt;
    &lt;pre&gt;
I have the following systems:&lt;/pre&gt;
    &lt;pre&gt;
AMD Processor
Scientific Linux 6.0
Kernelversion: 2.6.32-71.18.2.el6.x86_64
KVM / Libvirt  out of the repository&lt;/pre&gt;
    &lt;pre&gt;
&lt;/pre&gt;
    &lt;pre&gt;I've setup my TLS-Certificates with the following howto&lt;/pre&gt;
    &lt;pre&gt;&lt;i&gt;&lt;a class="moz-txt-link-freetext" \
href="http://wiki.libvirt.org/page/TLSSetup"&gt;http://wiki.libvirt.org/page/TLSSetup&lt;/a&gt;&lt;/i&gt;&lt;/pre&gt;
  &lt;pre&gt;
Now I want to connect the servers with&lt;/pre&gt;
    &lt;pre&gt;
&lt;i&gt;virsh -c qemu+tls://nebula3/system    &lt;/i&gt;(nebula3 is the hostname)&lt;/pre&gt;
    &lt;pre&gt;
but the following error message always is displayed:&lt;/pre&gt;
    &lt;pre&gt;
&lt;i&gt;error: unable to connect to libvirtd at 'nebula3': No route to host
error: failed to connect to the hypervisor&lt;/i&gt;&lt;/pre&gt;
    &lt;pre&gt;
SELinux is disabled  and the servers are in the same IP-Range (ping works fine)
Passwordless ssh-login also works fine!&lt;/pre&gt;
    &lt;pre&gt;
If I connect to a server with &lt;/pre&gt;
    &lt;pre&gt;qemu+ssh://nebula3/system   &lt;/pre&gt;
    &lt;pre&gt;all wroks fine...&lt;/pre&gt;
    &lt;pre&gt;Installation with virt-manager an bridged networkinterface also works \
fine...


Did anyone of you have an idea where my problem is?

Thanks for Help :)


Regards,

Christoph
&lt;/pre&gt;
  &lt;font face="monospace"&gt;-- &lt;br&gt;
Vorstand/Board of Management:&lt;br&gt;
Dr. Bernd Finkbeiner, Dr. Roland Niemeier, &lt;br&gt;
Dr. Arno Steitz, Dr. Ingrid Zech&lt;br&gt;
Vorsitzender des Aufsichtsrats/&lt;br&gt;
Chairman of the Supervisory Board:&lt;br&gt;
Michel Lepert&lt;br&gt;
Sitz/Registered Office: Tuebingen&lt;br&gt;
Registergericht/Registration Court: Stuttgart&lt;br&gt;
Registernummer/Commercial Register No.: HRB 382196 &lt;br&gt;
&lt;/font&gt;&lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20110311203929</emailId><senderName>Anthony Goddard</senderName><senderEmail>agoddard@mbl.edu</senderEmail><timestampReceived>2011-03-11 20:39:29-0400</timestampReceived><subject>[libvirt-users] client certificate path hard coded?</subject><body>

Hi all,
I'm trying to figure out how to get my desktop talking to two libvirt =
hosts using qemu+tls and I've read that virsh relies on hard coded paths =
to the certificates.. which seems to be true.
Is there a way to tell virsh to use a different path to a certificate, =
or another way people solve this presently?

Cheers,
Ant


[Attachment #3 (unknown)]

&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body style="word-wrap: break-word; -webkit-nbsp-mode: space; \
-webkit-line-break: after-white-space; "&gt;Hi all,&lt;div&gt;I'm trying to figure out how to \
get my desktop talking to two libvirt hosts using qemu+tls and I've read that virsh \
relies on hard coded paths to the certificates.. which seems to be true.&lt;/div&gt;&lt;div&gt;Is \
there a way to tell virsh to use a different path to a certificate, or another way \
people solve this presently?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Cheers,&lt;/div&gt;&lt;div&gt;Ant&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;




</body></email><email><emailId>20110312040939</emailId><senderName>Onkar Mahajan</senderName><senderEmail>kern.devel@gmail.com</senderEmail><timestampReceived>2011-03-12 04:09:39-0400</timestampReceived><subject>[libvirt-users] libvirt configuration problem</subject><body>

Hi ,

I am getting errors while configuring libvirt to compile it from source.

There is a error in libnl

checking for UDEV... no
checking whether to compile with macvtap support... yes
checking whether to compile with virtual port support... no
checking for LIBNL... no
configure: error: libnl-devel &gt;= 1.1 is required for macvtap support


I have already installed the libnl library in /lib/

[root@localhost lib]# ls libnl*
libnl.a       libnl-cli.so.2      libnl-genl.so        libnl-nf.a
libnl-nf.so.2.0.0  libnl-route.so.2      libnl.so.2.0.0
libnl-cli.a   libnl-cli.so.2.0.0  libnl-genl.so.2      libnl-nf.la
libnl-route.a      libnl-route.so.2.0.0
libnl-cli.la  libnl-genl.a        libnl-genl.so.2.0.0  libnl-nf.so
libnl-route.la     libnl.so
libnl-cli.so  libnl-genl.la       libnl.la             libnl-nf.so.2
libnl-route.so     libnl.so.2


Please help me !!

Regards,
Onkar

[Attachment #3 (text/html)]

Hi , &lt;br&gt;&lt;br&gt;I am getting errors while configuring libvirt to compile it from source. \
&lt;br&gt;&lt;br&gt;There is a error in libnl &lt;br&gt;&lt;br&gt;checking for UDEV... no&lt;br&gt;checking whether \
to compile with macvtap support... yes&lt;br&gt;checking whether to compile with virtual \
port support... no&lt;br&gt; checking for LIBNL... no&lt;br&gt;configure: error: libnl-devel \
&gt;= 1.1 is required for macvtap support&lt;br&gt;&lt;br&gt;&lt;br&gt;I have already installed the \
libnl library in /lib/&lt;br&gt;&lt;br&gt;[root@localhost lib]# ls libnl*&lt;br&gt;libnl.a       \
libnl-cli.so.2      libnl-genl.so        libnl-nf.a     libnl-nf.so.2.0.0  \
libnl-route.so.2      libnl.so.2.0.0&lt;br&gt; libnl-cli.a   libnl-cli.so.2.0.0  \
libnl-genl.so.2      &lt;a href="http://libnl-nf.la"&gt;libnl-nf.la&lt;/a&gt;    libnl-route.a    \
libnl-route.so.2.0.0&lt;br&gt;&lt;a href="http://libnl-cli.la"&gt;libnl-cli.la&lt;/a&gt;  libnl-genl.a  \
libnl-genl.so.2.0.0  libnl-nf.so    &lt;a \
href="http://libnl-route.la"&gt;libnl-route.la&lt;/a&gt;     libnl.so&lt;br&gt; libnl-cli.so  &lt;a \
href="http://libnl-genl.la"&gt;libnl-genl.la&lt;/a&gt;       &lt;a \
href="http://libnl.la"&gt;libnl.la&lt;/a&gt;             libnl-nf.so.2  libnl-route.so     \
libnl.so.2&lt;br&gt;&lt;br&gt;&lt;br&gt;Please help me !!&lt;br&gt;&lt;br&gt;Regards,&lt;br&gt;Onkar&lt;br&gt;



</body></email><email><emailId>20110308202104</emailId><senderName>jbd</senderName><senderEmail>jeanbaptiste.denis@gmail.com</senderEmail><timestampReceived>2011-03-08 20:21:04-0400</timestampReceived><subject>[libvirt-users] dnsmasq not started when no dhcp enabled ?</subject><body>

Hello everybody,

i've defined a simple network, with no dhcp. I'd like to use dnsmasq 
only as a dns server.

$ virsh net-dumpxml basicswitch
&lt;network&gt;
   &lt;name&gt;basicswitch&lt;/name&gt;
   &lt;uuid&gt;60f491d2-d6c4-6b57-8a50-081cace8dedc&lt;/uuid&gt;
   &lt;forward mode='nat'/&gt;
   &lt;bridge name='virbr1' stp='on' delay='0' /&gt;
   &lt;ip address='192.168.100.1' netmask='255.255.255.0'&gt;
   &lt;/ip&gt;
&lt;/network&gt;

I start it :

$ virsh net-start basicswitch
Network basicswitch started

$  virsh net-list
Name                 State      Autostart
-----------------------------------------
basicswitch          active     no

But i see no dnsmasq process :

$ ps fax|grep dnsmas[q]

Here the output of "virsh version" :

$ virsh version
Compiled against library: libvir 0.8.8
Using library: libvir 0.8.8
Using API: QEMU 0.8.8
Running hypervisor: QEMU 0.12.5

What is funny is that the dnsmasq process is created on another box with 
different version :

$ virsh version
Compiled against library: libvir 0.8.3
Using library: libvir 0.8.3
Using API: QEMU 0.8.3
Running hypervisor: QEMU 0.12.5

$ ps fax|grep dnsmas[q]
7104 ?        S      0:00 dnsmasq --strict-order --bind-interfaces 
--pid-file=/var/run/libvirt/network/basicswitch.pid --conf-file= 
--listen-address 192.168.100.1 --except-interface lo

Any advice on it ?

Regards,

Jean-Baptiste

</body></email><email><emailId>20110308212620</emailId><senderName>jbd</senderName><senderEmail>jeanbaptiste.denis@gmail.com</senderEmail><timestampReceived>2011-03-08 21:26:20-0400</timestampReceived><subject>Re: [libvirt-users] dnsmasq not started when no dhcp enabled ?</subject><body>

On 03/08/2011 09:21 PM, jbd wrote:

&gt; ....


Just updated my working box (Compiled against library: libvir 0.8.3, 
Using library: libvir 0.8.3, Using API: QEMU 0.8.3) to a new libvirt 
(Compiled against library: libvir 0.8.8, Using library: libvir 0.8.8, 
Using API: QEMU 0.8.8) and dnsmasq is not launched anymore.

It looks like a regression. Did i miss something in the changelog or the 
documentation ?

Jean-Baptiste


</body></email><email><emailId>20110311210555</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-03-11 21:05:55-0400</timestampReceived><subject>Re: [libvirt-users] client certificate path hard coded?</subject><body>

2011/3/11 Anthony Goddard &lt;agoddard@mbl.edu&gt;:
&gt; Hi all,
&gt; I'm trying to figure out how to get my desktop talking to two libvirt hosts
&gt; using qemu+tls and I've read that virsh relies on hard coded paths to the
&gt; certificates.. which seems to be true.
&gt; Is there a way to tell virsh to use a different path to a certificate, or
&gt; another way people solve this presently?
&gt; Cheers,
&gt; Ant
&gt;

Recent libvirt 0.8.8 added a new query parameter pkipath. This allows
you to specify a directory containing cacert.pem, clientkey.pem and
clientcert.pem to be used for that connection.

virsh -c qemu+tls://example.com/system/?pkipath=/local/path/to/certificates

See http://libvirt.org/remote.html

Matthias

</body></email><email><emailId>20110310140258</emailId><senderName></senderName><senderEmail>knawnd</senderEmail><timestampReceived>2011-03-10 14:02:58-0400</timestampReceived><subject>Re: [libvirt-users] unable to connect to libvirtd at '*': No route to host</subject><body>

Christoph Raible wrote on 10/03/11 16:30:
&gt; Hi @all,
&gt; I have the following systems:
&gt; AMD Processor
&gt; Scientific Linux 6.0
&gt; Kernelversion: 2.6.32-71.18.2.el6.x86_64
&gt; KVM / Libvirt  out of the repository
&gt; I've setup my TLS-Certificates with the following howto
&gt; /http://wiki.libvirt.org/page/TLSSetup/
&gt; Now I want to connect the servers with
&gt; /virsh -c qemu+tls://nebula3/system/(nebula3 is the hostname)
I couldn't find qemu+tls as URI driver protocol for qemu at 
http://libvirt.org/drvqemu.html
But there is a line as below where TLS is mentioned:

qemu://example.com/system            (remote access, TLS/x509)

HTH,
Nikolay.

</body></email><email><emailId>20110310141506</emailId><senderName>Christoph Raible</senderName><senderEmail>c.raible@science-computing.de</senderEmail><timestampReceived>2011-03-10 14:15:06-0400</timestampReceived><subject>Re: [libvirt-users] unable to connect to libvirtd at '*': No route to host</subject><body>

Am 10.03.2011 15:02, schrieb knawnd@gmail.com:
&gt; Christoph Raible wrote on 10/03/11 16:30:
&gt;&gt; Hi @all,
&gt;&gt; I have the following systems:
&gt;&gt; AMD Processor
&gt;&gt; Scientific Linux 6.0
&gt;&gt; Kernelversion: 2.6.32-71.18.2.el6.x86_64
&gt;&gt; KVM / Libvirt  out of the repository
&gt;&gt; I've setup my TLS-Certificates with the following howto
&gt;&gt; /http://wiki.libvirt.org/page/TLSSetup/
&gt;&gt; Now I want to connect the servers with
&gt;&gt; /virsh -c qemu+tls://nebula3/system/(nebula3 is the hostname)
&gt; I couldn't find qemu+tls as URI driver protocol for qemu at 
&gt; http://libvirt.org/drvqemu.html
&gt; But there is a line as below where TLS is mentioned:
&gt;
&gt; qemu://example.com/system            (remote access, TLS/x509)
&gt;
&gt; HTH,
&gt; Nikolay.
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
Hi,

sorry for missunderstanding.... I tried the qemu://.....    "login"  
"qemu+tls:// "   was a typo by me ;)


Regards,
Christoph
-- 
Vorstand/Board of Management:
Dr. Bernd Finkbeiner, Dr. Roland Niemeier, 
Dr. Arno Steitz, Dr. Ingrid Zech
Vorsitzender des Aufsichtsrats/
Chairman of the Supervisory Board:
Michel Lepert
Sitz/Registered Office: Tuebingen
Registergericht/Registration Court: Stuttgart
Registernummer/Commercial Register No.: HRB 382196 



</body></email><email><emailId>20110304182118</emailId><senderName></senderName><senderEmail>knawnd</senderEmail><timestampReceived>2011-03-04 18:21:18-0400</timestampReceived><subject>Re: [libvirt-users] ifname in openvz container</subject><body>

sorry, I forgot to mention a vzctl version which is 3.0.26-1.

knawnd@gmail.com wrote on 04/03/11 21:10:
&gt; Hi!
&gt;
&gt; Is there any way to specify ethernet device name to be created inside
&gt; the openvz container?
&gt; I could find such info at
&gt; http://libvirt.org/formatdomain.html#elementsNICS.
&gt; If I do as below I get br0 as ethernet device inside VM whereas I'd like
&gt; it to be eth0.
&gt;
&gt; $ cat ovz.xml
&gt; &lt;domain type='openvz' id='144'&gt;
&gt; &lt;name&gt;144&lt;/name&gt;
&gt; &lt;uuid&gt;0071c128-58b4-4688-be17-1e062a22b36c&lt;/uuid&gt;
&gt; &lt;vcpu&gt;1&lt;/vcpu&gt;
&gt; &lt;memory&gt;524288&lt;/memory&gt;
&gt; &lt;os&gt;
&gt; &lt;type&gt;exe&lt;/type&gt;
&gt; &lt;init&gt;/sbin/init&lt;/init&gt;
&gt; &lt;/os&gt;
&gt; &lt;devices&gt;
&gt; &lt;filesystem type='template'&gt;
&gt; &lt;source name='centos-5-x86'/&gt;
&gt; &lt;target dir='/'/&gt;
&gt; &lt;/filesystem&gt;
&gt; &lt;interface type='bridge'&gt;
&gt; &lt;source bridge='br0'/&gt;
&gt; &lt;/interface&gt;
&gt; &lt;/devices&gt;
&gt; &lt;/domain&gt;
&gt;
&gt; $ virsh create ovz.xml
&gt; Domain 144 created from ovz.xml
&gt;
&gt; $ grep -i netif /etc/vz/conf/144.conf
&gt; NETIF="ifname=br0,bridge=br0,mac=52:54:00:74:DD:F3,host_ifname=veth144.0,host_mac=52:54:00:06:78:76"
&gt;
&gt;
&gt;
&gt; br0 is a bridge on the server (CT0). But I would like to assign ethernet
&gt; device inside VM as eth0 i.e. ifname in VM config has to be eth0.
&gt; ovzkernel release is 2.6.18-194.26.1.el5.028stab081.1
&gt; OS is CentOS 5.5, libvirt/virsh version is 0.8.8.
&gt;
&gt; Best regards,
&gt; Nikolay.

</body></email><email><emailId>20110307181849</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-03-07 18:18:49-0400</timestampReceived><subject>Re: [libvirt-users] diskspace and diskinodes tag for openvz</subject><body>

2011/3/7  &lt;knawnd@gmail.com&gt;:
&gt; Hi!
&gt;
&gt; as far as I understood from "xml format for openvz driver" thread available
&gt; at [1] it should be possible to specify via libvirt disk size and disk
&gt; inodes for openvz VM.But the following device section in VM xml description
&gt; doesn't set disksize and diskinodes properly (it looks like those parameters
&gt; are taken from default OpenVZ config and not as they are specified in
&gt; libvirt tags):
&gt;  &lt;devices&gt;
&gt;    &lt;filesystem type='template'&gt;
&gt;      &lt;source name='centos-5-x86'/&gt;
&gt;      &lt;target dir='/'/&gt;
&gt;      &lt;quota type="size" max="100000"/&gt;
&gt;      &lt;quota type="inodes" max="200000"/&gt;
&gt;    &lt;/filesystem&gt;
&gt;  &lt;/devices&gt;
&gt;
&gt; Could anyone manage to set mentioned OpenVZ parameters properly? I am using
&gt; libvirt-0.8.8, CentOS 5.5, vzctl version is 3.0.26-1.
&gt;
&gt; Thanks!
&gt; Nikolay.
&gt;
&gt; [1] http://www.mail-archive.com/libvir-list@redhat.com/msg07329.html
&gt;

You are misunderstanding the referenced thread. It isn't about
available features in libvirt. In this thread Evgeniy suggests several
additions to libvirt domain XML format related to OpenVZ.

The additions of quota control to the filesystem element have never
been implemented, so they are not available and you're just seeing
expected behavior.

Matthias

</body></email><email><emailId>20110311232428</emailId><senderName>Anthony Goddard</senderName><senderEmail>agoddard@mbl.edu</senderEmail><timestampReceived>2011-03-11 23:24:28-0400</timestampReceived><subject>Re: [libvirt-users] client certificate path hard coded?</subject><body>

Perfect, thanks Matthias, I'd tried those params but didn't realize they were only in 0.8.8 &amp; I was on 0.8.7.. 
I've just updated to 0.8.8 and it's working perfectly.



On Mar 11, 2011, at 4:05 PM, Matthias Bolte wrote:

&gt; 2011/3/11 Anthony Goddard &lt;agoddard@mbl.edu&gt;:
&gt;&gt; Hi all,
&gt;&gt; I'm trying to figure out how to get my desktop talking to two libvirt hosts
&gt;&gt; using qemu+tls and I've read that virsh relies on hard coded paths to the
&gt;&gt; certificates.. which seems to be true.
&gt;&gt; Is there a way to tell virsh to use a different path to a certificate, or
&gt;&gt; another way people solve this presently?
&gt;&gt; Cheers,
&gt;&gt; Ant
&gt;&gt; 
&gt; 
&gt; Recent libvirt 0.8.8 added a new query parameter pkipath. This allows
&gt; you to specify a directory containing cacert.pem, clientkey.pem and
&gt; clientcert.pem to be used for that connection.
&gt; 
&gt; virsh -c qemu+tls://example.com/system/?pkipath=/local/path/to/certificates
&gt; 
&gt; See http://libvirt.org/remote.html
&gt; 
&gt; Matthias


</body></email><email><emailId>20110312022808</emailId><senderName>Randall Webstuff</senderName><senderEmail>randallwebstuff@gmail.com</senderEmail><timestampReceived>2011-03-12 02:28:08-0400</timestampReceived><subject>[libvirt-users] Migrating existing debian system to KVM/libvirt</subject><body>

I have a dying machine running debian etch that acts as a web/mail server
that I would like to virtualize using debian/kvm/libvirt. Is it as simple as
removing the hard-disk (multiple ext2/ext3 partitions) from the dying
machine into my newer server and then writing a custom xml config file? Is
there a tutorial on doing this somewhere?

Thanks.
Randy

[Attachment #3 (text/html)]

I have a dying machine running debian etch that acts as a web/mail server t=
hat I would like to virtualize using debian/kvm/libvirt. Is it as simple as=
 removing the hard-disk (multiple ext2/ext3 partitions) from the dying mach=
ine into my newer server and then writing a custom xml config file? Is ther=
e a tutorial on doing this somewhere?&lt;div&gt;
&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks.&lt;/div&gt;&lt;div&gt;Randy&lt;/div&gt;


</body></email><email><emailId>20110312100103</emailId><senderName>Gian Uberto Lauri</senderName><senderEmail>saint@eng.it</senderEmail><timestampReceived>2011-03-12 10:01:03-0400</timestampReceived><subject>Re: [libvirt-users] Migrating existing debian system to	KVM/libvirt</subject><body>

Quoting Randall Webstuff &lt;randallwebstuff@gmail.com&gt;:

&gt; I have a dying machine running debian etch that acts as a web/mail server
&gt; that I would like to virtualize using debian/kvm/libvirt. Is it as simple as
&gt; removing the hard-disk (multiple ext2/ext3 partitions) from the dying
&gt; machine into my newer server and then writing a custom xml config file?

The only thing that could require some fixing inside your 'image' is  
the Grub configuration. And the doubt comes from the ignorance of the  
inner workings of grub .

For the XML, do not forget:

- the part that says to kvm which is the name of the disk inside kvm,  
so that it matches the name it had in the machine,
- the part that says to use an emulator that matches the old physical CPU.

--
ing. Gian Uberto Lauri
Ricercatore / Reasearcher
Divisione Ricerca ed Innovazione / Research &amp; Innovation Division
GianUberto.Lauri@eng.it

Engineering Ingegneria Informatica spa
Corso Stati Uniti 23/C, 35127 Padova (PD)

Tel. +39-049.8283.571         | main(){printf(&amp;unix["\021%six\012\0"],
Fax  +39-049.8283.569	      |    (unix)["have"]+"fun"-0x60);}
Skype: gian.uberto.lauri      |          David Korn, AT&amp;T Bell Labs
http://www.eng.it 	      |          ioccc best One Liner, 1987


</body></email><email><emailId>20110312115024</emailId><senderName>Andreas Jellinghaus</senderName><senderEmail>aj@dungeon.inka.de</senderEmail><timestampReceived>2011-03-12 11:50:24-0400</timestampReceived><subject>[libvirt-users] libvirt/kvm/qemu: pointopoint routed setup?</subject><body>

Hi,

can anyone give an example for a pointopoint routed setup?
i.e. each virtual machine has one ip with pointopoint config to the
host machine, on a private interface - thus the virtual machines can
only talk to the host, which routes them and can use normal iptables
for filtering all traffic.

with xen this was a simple script doing
	 ifconfig ${vif} ${main_ip} netmask 255.255.255.255 up
	 ip route ${ipcmd} ${addr} dev ${vif} src ${main_ip}
and an optional
	 echo 1 &gt;/proc/sys/net/ipv4/conf/${vif}/proxy_arp

has someone implemented something like this with libvirt/kvm setup?
can you give some pointers how to do this?

I don't need high speed communication between the virtual machines,
and the option to filter all traffic between them (without using
the bridge netfilter tables) would be nice.

Or is there a reason not to use such a setup, and a better option
to implement this?

Thanks for your help and best regards,

Andreas Jellinghaus

</body></email><email><emailId>20110312133709</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-03-12 13:37:09-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt] libvirt configuration problem</subject><body>

2011/3/12 Onkar Mahajan &lt;kern.devel@gmail.com&gt;:
&gt; Hi ,
&gt;
&gt; I am getting errors while configuring libvirt to compile it from source.
&gt;
&gt; There is a error in libnl
&gt;
&gt; checking for UDEV... no
&gt; checking whether to compile with macvtap support... yes
&gt; checking whether to compile with virtual port support... no
&gt; checking for LIBNL... no
&gt; configure: error: libnl-devel &gt;= 1.1 is required for macvtap support
&gt;
&gt;
&gt; I have already installed the libnl library in /lib/
&gt;
&gt; [root@localhost lib]# ls libnl*
&gt; libnl.a       libnl-cli.so.2      libnl-genl.so        libnl-nf.a
&gt; libnl-nf.so.2.0.0  libnl-route.so.2      libnl.so.2.0.0
&gt; libnl-cli.a   libnl-cli.so.2.0.0  libnl-genl.so.2      libnl-nf.la
&gt; libnl-route.a      libnl-route.so.2.0.0
&gt; libnl-cli.la  libnl-genl.a        libnl-genl.so.2.0.0  libnl-nf.so
&gt; libnl-route.la     libnl.so
&gt; libnl-cli.so  libnl-genl.la       libnl.la             libnl-nf.so.2
&gt; libnl-route.so     libnl.so.2
&gt;
&gt;
&gt; Please help me !!
&gt;
&gt; Regards,
&gt; Onkar
&gt;

The configure script uses pkg-config to detect libnl. Therefore,
pkg-config must be able to find the libnl-1.pc file. On my system it's
/usr/lib/pkgconfig/libnl-1.pc and pkg-config finds it by default.

You can use

  pkg-config --modversion libnl-1

to check the version. If pkg-config can't find the file it'll complain
and suggest that you set the PKG_CONFIG_PATH environment variable to
point to the directory containing the libnl-1.pc file, like this

  PKG_CONFIG_PATH=/path/to/directory pkg-config --modversion libnl-1

You can then run configure the same way

  PKG_CONFIG_PATH=/path/to/directory ./configure

Matthias

</body></email><email><emailId>20110312134341</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2011-03-12 13:43:41-0400</timestampReceived><subject>Re: [libvirt-users] dnsmasq not started when no dhcp enabled ?</subject><body>

On 03/08/2011 03:21 PM, jbd wrote:
&gt; Hello everybody,
&gt;
&gt; i've defined a simple network, with no dhcp. I'd like to use dnsmasq 
&gt; only as a dns server.
&gt;
&gt; $ virsh net-dumpxml basicswitch
&gt; &lt;network&gt;
&gt; &lt;name&gt;basicswitch&lt;/name&gt;
&gt; &lt;uuid&gt;60f491d2-d6c4-6b57-8a50-081cace8dedc&lt;/uuid&gt;
&gt; &lt;forward mode='nat'/&gt;
&gt; &lt;bridge name='virbr1' stp='on' delay='0' /&gt;
&gt; &lt;ip address='192.168.100.1' netmask='255.255.255.0'&gt;
&gt; &lt;/ip&gt;
&gt; &lt;/network&gt;
&gt;
&gt; I start it :
&gt;
&gt; $ virsh net-start basicswitch
&gt; Network basicswitch started
&gt;
&gt; $  virsh net-list
&gt; Name                 State      Autostart
&gt; -----------------------------------------
&gt; basicswitch          active     no
&gt;
&gt; But i see no dnsmasq process :
&gt;
&gt; $ ps fax|grep dnsmas[q]
&gt;
&gt; Here the output of "virsh version" :
&gt;
&gt; $ virsh version
&gt; Compiled against library: libvir 0.8.8
&gt; Using library: libvir 0.8.8
&gt; Using API: QEMU 0.8.8
&gt; Running hypervisor: QEMU 0.12.5
&gt;
&gt; What is funny is that the dnsmasq process is created on another box 
&gt; with different version :
&gt;
&gt; $ virsh version
&gt; Compiled against library: libvir 0.8.3
&gt; Using library: libvir 0.8.3
&gt; Using API: QEMU 0.8.3
&gt; Running hypervisor: QEMU 0.12.5
&gt;
&gt; $ ps fax|grep dnsmas[q]
&gt; 7104 ?        S      0:00 dnsmasq --strict-order --bind-interfaces 
&gt; --pid-file=/var/run/libvirt/network/basicswitch.pid --conf-file= 
&gt; --listen-address 192.168.100.1 --except-interface lo
&gt;
&gt; Any advice on it ?


Sigh. Yes, there was a regression when I added IPv6 support for virtual 
networks. I pushed a fix last night. Thanks for the report!

https://www.redhat.com/archives/libvir-list/2011-March/msg00584.html

     commit 7892edc9cc45e4fb1079b627bda3f571ac27041f
     Author: Laine Stump &lt;laine@laine.org&gt;
     Date:   Fri Mar 11 11:47:58 2011 -0500

     network driver: Start dnsmasq even if no dhcp ranges/hosts are 
specified.



</body></email><email><emailId>20110201022132</emailId><senderName>Taras Lipatov</senderName><senderEmail>taras@lipatov.com</senderEmail><timestampReceived>2011-02-01 02:21:32-0400</timestampReceived><subject>Re: [libvirt-users] libvirt bridge configuration</subject><body>

Superb!

Thanks for the help.

Taras Lipatov
Product deployment manager,
Opentext

Justin Clift wrote:
&gt; On 31/01/2011, at 5:52 AM, Taras Lipatov wrote:
&gt; 
&gt; &gt; Hi Every one,
&gt; &gt; 
&gt; &gt; I'm hoping some one can point me in the right direction.
&gt; &gt; We are piloting KVM + Libvirt for migrating off Xen and I'm stuck with the \
&gt; &gt; network bridge configuration via libvirt. 
&gt; &gt; What we have currently with xen is:
&gt; &gt; 1 server with Wan/lan interfaces and a pool of public ip addresses.
&gt; &gt; Using xen bridge scripts I'd start a xenbr0 and attach eth0 (wan) and go ahead \
&gt; &gt; and assign public IP's to images attached to xenbr0.
&gt; &gt; 
&gt; &gt; Now with creating virbr0, I need to assign it an ip address? and routing methods? \
&gt; &gt; what about creating a transparent bridge via libvirt? I kno I can achieve this \
&gt; &gt; using bridge utils, but it would be nice to have everything handled by libvirt. 
&gt; &gt; Any help would be appreciated.
&gt; &gt; 
&gt; 
&gt; Hi Taras,
&gt; 
&gt; Is this helpful at all?
&gt; 
&gt; http://wiki.libvirt.org/page/VirtualNetworking
&gt; 
&gt; I'm thinking the "Routed" mode there might be what you're looking for?
&gt; 
&gt; (note, the URL may change over time, as we're considering merging the info into \
&gt; other places, etc) 
&gt; Regards and best wishes,
&gt; 
&gt; Justin Clift


</body></email><email><emailId>20110201144108</emailId><senderName>"David M. Barlieb"</senderName><senderEmail>dmb@integrichain.com</senderEmail><timestampReceived>2011-02-01 14:41:08-0400</timestampReceived><subject>[libvirt-users] (no subject)</subject><body>

Hello all, I am looking to use bonded interfaces as a bridge device for
my virtual hosts. My goal was to have 4 nics bonded together to create a
large pipe for my guests. I then tried to create a bridge device out of
it similar to creating a bridge out of a single nic. It unfortunately
did not work. Does any one know of a way to bond 2 or more nics than
configure the bond as a bridge to the virtual guests.

 

Thanks in advance,

Dave B

 

 


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;meta http-equiv=Content-Type content="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 12 (filtered medium)"&gt;
&lt;style&gt;
&lt;!--
 /* Font Definitions */
 @font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;
	font-size:10.0pt;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.Section1
	{page:Section1;}
--&gt;
&lt;/style&gt;
&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapelayout v:ext="edit"&gt;
  &lt;o:idmap v:ext="edit" data="1" /&gt;
 &lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
&lt;/head&gt;

&lt;body lang=EN-US link=blue vlink=purple&gt;

&lt;div class=Section1&gt;

&lt;p class=MsoNormal&gt;Hello all, I am looking to use bonded interfaces as a bridge
device for my virtual hosts. My goal was to have 4 nics bonded together to
create a large pipe for my guests. I then tried to create a bridge device out
of it similar to creating a bridge out of a single nic. It unfortunately did
not work. Does any one know of a way to bond 2 or more nics than configure the
bond as a bridge to the virtual guests.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Thanks in advance,&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Dave B&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;



</body></email><email><emailId>20110202044644</emailId><senderName>Nikunj A !  Dadhania</senderName><senderEmail>nikunj@linux.vnet.ibm.com</senderEmail><timestampReceived>2011-02-02 04:46:44-0400</timestampReceived><subject>[libvirt-users] Not getting a virsh console</subject><body>

--=-=-=

Hi,

I am seeing a problem with a earlier working domain configuration. Here
is the  domain xml file. I am not getting the virsh console now. I am
trying this on RHEL 6.0. 

Here is the list of steps that I am using:

[root@krm1 test]# virsh define vmtest.xml
Domain vmtest3 defined from vmtest.xml

[root@krm1 test]# virsh start vmtest3
Domain vmtest3 started

[root@krm1 test]# virsh console vmtest3
Connected to domain vmtest3
Escape character is ^]

[root@krm1 test]# virsh dominfo vmtest3
Id:             2
Name:           vmtest3
UUID:           2b38ff93-1bc6-c78c-1ed8-ffb936c86dac
OS Type:        hvm
State:          running
CPU(s):         1
CPU time:       17.3s
Max memory:     524288 kB
Used memory:    524288 kB
Persistent:     yes
Autostart:      disable

[root@krm1 test]# 

The state of the domain shows running. One more thing that i noted was
that qemu-kvm is consuming 100% of the cpu. So not sure if the qemu-kvm
has started properly. I am not sure how to debug the issue. Would
appreciate some help on this.

Some more information:

I have attached following file /var/log/libvirt/qemu/vmtest3.log

Executing the following command on the bash works fine and the VM comes up:
/usr/libexec/qemu-kvm  -M rhel6.0.0 -enable-kvm -m 512 -smp \
1,sockets=1,cores=1,threads=1 -drive \
file=/home/bharata/cgroup-scalability/test/test.qcow2  -nographic

While executing the command in the vmtest3.log, the VM does not come at
all.

Here is the domain xml:

&lt;domain type='kvm'&gt;
  &lt;name&gt;vmtest3&lt;/name&gt;
  &lt;memory&gt;524288&lt;/memory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='i686'&gt;hvm&lt;/type&gt;
    &lt;boot dev='hd'/&gt;
  &lt;/os&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;restart&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/libexec/qemu-kvm&lt;/emulator&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;driver name='qemu' type='qcow2'/&gt;
      &lt;source file='/home/bharata/cgroup-scalability/test/test.qcow2'/&gt;
      &lt;target dev='hda' bus='ide'/&gt;
    &lt;/disk&gt;
    &lt;serial type='pty'&gt;
      &lt;target port='0'/&gt;
    &lt;/serial&gt;
    &lt;console type='pty'&gt;
      &lt;target port='0'/&gt;
    &lt;/console&gt;
  &lt;/devices&gt;
&lt;/domain&gt;

Thanks,
Nikunj


--=-=-=
Content-Disposition: inline; filename=vmtest3.log
Content-Description: vmtest3.log

LC_ALL=C PATH=/sbin:/usr/sbin:/bin:/usr/bin /usr/libexec/qemu-kvm -S -M rhel6.0.0 \
-cpu qemu32 -enable-kvm -m 512 -smp 1,sockets=1,cores=1,threads=1 -name vmtest3 -uuid \
2b38ff93-1bc6-c78c-1ed8-ffb936c86dac -nographic -nodefconfig -nodefaults -chardev \
socket,id=monitor,path=/var/lib/libvirt/qemu/vmtest3.monitor,server,nowait -mon \
chardev=monitor,mode=control -rtc base=utc -no-acpi -boot c -drive \
file=/home/bharata/cgroup-scalability/test/test.qcow2,if=none,id=drive-ide0-0-0,boot=on,format=qcow2 \
-device ide-drive,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0 -chardev \
pty,id=serial0 -device isa-serial,chardev=serial0 -usb -device \
virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x2  09:53:22.536: debug : \
virCgroupNew:493 : New group /libvirt/qemu/vmtest3 09:53:22.536: debug : \
virCgroupDetect:230 : Detected mount/mapping 0:cpu at /cgroup/cpu in  09:53:22.536: \
debug : virCgroupDetect:230 : Detected mount/mapping 1:cpuacct at /cgroup/cpuacct in  \
09:53:22.536: debug : virCgroupDetect:230 : Detected mount/mapping 2:cpuset at \
/cgroup/cpuset in  09:53:22.536: debug : virCgroupDetect:230 : Detected mount/mapping \
3:memory at /cgroup/memory in  09:53:22.536: debug : virCgroupDetect:230 : Detected \
mount/mapping 4:devices at /cgroup/devices in  09:53:22.536: debug : \
virCgroupDetect:230 : Detected mount/mapping 5:freezer at /cgroup/freezer in  \
09:53:22.536: debug : virCgroupMakeGroup:451 : Make group /libvirt/qemu/vmtest3 \
09:53:22.536: debug : virCgroupMakeGroup:463 : Make controller \
/cgroup/cpu/libvirt/qemu/vmtest3/ 09:53:22.536: debug : virCgroupMakeGroup:463 : Make \
controller /cgroup/cpuacct/libvirt/qemu/vmtest3/ 09:53:22.536: debug : \
virCgroupMakeGroup:463 : Make controller /cgroup/cpuset/libvirt/qemu/vmtest3/ \
09:53:22.536: debug : virCgroupMakeGroup:463 : Make controller \
/cgroup/memory/libvirt/qemu/vmtest3/ 09:53:22.536: debug : virCgroupMakeGroup:463 : \
Make controller /cgroup/devices/libvirt/qemu/vmtest3/ 09:53:22.536: debug : \
virCgroupMakeGroup:463 : Make controller /cgroup/freezer/libvirt/qemu/vmtest3/ \
09:53:22.536: debug : virCgroupSetValueStr:275 : Set value \
'/cgroup/cpu/libvirt/qemu/vmtest3/tasks' to '7312' 09:53:22.545: debug : \
virCgroupSetValueStr:275 : Set value '/cgroup/cpuacct/libvirt/qemu/vmtest3/tasks' to \
'7312' 09:53:22.554: debug : virCgroupSetValueStr:275 : Set value \
'/cgroup/cpuset/libvirt/qemu/vmtest3/tasks' to '7312' 09:53:22.562: debug : \
virCgroupSetValueStr:275 : Set value '/cgroup/memory/libvirt/qemu/vmtest3/tasks' to \
'7312' 09:53:22.569: debug : virCgroupSetValueStr:275 : Set value \
'/cgroup/devices/libvirt/qemu/vmtest3/tasks' to '7312' 09:53:22.577: debug : \
virCgroupSetValueStr:275 : Set value '/cgroup/freezer/libvirt/qemu/vmtest3/tasks' to \
'7312' 09:53:22.585: debug : qemudInitCpuAffinity:2618 : Setting CPU affinity
09:53:22.586: debug : qemuSecurityDACSetProcessLabel:547 : Dropping privileges of VM \
to 107:107 char device redirected to /dev/pts/2

--=-=-=--


</body></email><email><emailId>20110202104127</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-02-02 10:41:27-0400</timestampReceived><subject>Re: [libvirt-users] network-performance</subject><body>

On Tue, Feb 01, 2011 at 02:33:28PM -0500, Brian K. White wrote:
&gt; On 2/1/2011 12:39 PM, Orion Poplawski wrote:
&gt; &gt;I'm just starting to take a look at guest networking performance and am
&gt; &gt;a little disappointed. I'm comparing two setups:
&gt; &gt;
&gt; &gt;Host: Windows Server 2008 R2 Hyper-V
&gt; &gt;Guest: CentOS 5.5 x86_64
&gt; &gt;
&gt; &gt;Host: CentOS 5.5 x86_64 kvm running libvirt
&gt; &gt;Guest: CentOS 5.5 x86_64
&gt; &gt;
&gt; &gt;The guests are essentially identical except that I'm running the
&gt; &gt;Microsoft Linux Integration Components synthetic drivers on the windows
&gt; &gt;hosted VM. The libvirt setup uses bridged networking. Running bonnie++
&gt; &gt;on a nfs mounted filesystem on each guest I'm seeing the libvirt hosted
&gt; &gt;guest get between 16%-35% of the performance of the Hyper-V guest. Is
&gt; &gt;this expected? Is there anything I can do to increase network
&gt; &gt;performance of the kvm guest?
&gt; &gt;
&gt; 
&gt; First thing is to stop unfairly comparing things that don't even
&gt; claim to do the same job. hyper-v is a hypervisor, while kvm is not,
&gt; xen is.
&gt; It would be closer but still unfair, to compare qemu or virtualbox
&gt; for windows to kvm.

This distinction is completely irrelevant FUD. It is perfectly
valid to compare Hyper-V, Xen, KVM, VMWare and VirtualBox all
together, regardless of fact that they have different architectures.
They are all hypervisors, simply different types of hypervisor and
none of their architectures are inherantly "best", merely different.
For the only industry standard virtualization benchmark (SpecVirt),
KVM has the leading figures beating VMWare. This demonstrates the
KVM architecture is more than a match for the classical hypervisor
model of VWMare/Xen.

&gt; You didn't say what kind of networking is being used wth hyper-v,
&gt; but it's an understood fact that bridgeing in linux is easy to use
&gt; and less efficient than routing or vlan or macvlan.
&gt; 
&gt; So I guess the answer is use xen and something other than bridging.

Both Xen and KVM use the Linux hosting for network connectivity,
so anything you can do with Xen networking you can do with KVM.
KVM in fact has more options because it can use macvtap which
isn't available to Xen yet.

Regards,
Daniel

</body></email><email><emailId>20110202163231</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-02-02 16:32:31-0400</timestampReceived><subject>Re: [libvirt-users] virsh : Need help to manage a vm on a remote vmWare</subject><body>

2011/2/2 Etienne GOSSET &lt;ego@ubiqube.com&gt;:
&gt; Hello,
&gt;
&gt;
&gt;
&gt; I'm trying to use the tool virsh of libvirt.
&gt;
&gt; I want to manage via CLI a vm on a vmware hypervisor which is hosted on a
&gt; remote host (Is that what you call the node??).
&gt;

You say hosted, so what VMware hypervisor are you using? VMware
ESX(i), Server (aka GSX), Player or Workstation?

VMware Server, Player and Workstation are the hosted ones. Hosted
means that they are installed as an application on a common OS like
Linux, Windows or Mac.

&gt;
&gt; I read a lot of thing on your site but I really don't understand how to do
&gt; something…
&gt;
&gt; I saw that:
&gt;
&gt;&gt;virsh edit $your-vm-name
&gt;
&gt; I think "$your-vm-name" is the xml file you're talking about?
&gt;

No, $your-vm-name refers to the name of the virtual machine, not a
patch to a file.

&gt;
&gt; Is it mandatory to use those XML file in order to use virsh? (Because it is
&gt; very huge!)
&gt;

The domain XML files are a core aspect of libvirt and virsh. I
wouldn't call this fies huge, they typically have 20-30 lines. See

http://www.libvirt.org/drvesx.html#xmlconfig

for a typical example.

&gt;
&gt; I also saw this way of using virsh :
&gt;
&gt;&gt;virsh --connect esx://user@hypervisorHost://path/to/myVM.vmx
&gt;

This looks like random guessing, as in none of the VMware specific
driver in libvirt you can specify the path to a .vmx file.

Where did you saw this?

&gt;
&gt; Result is:
&gt;
&gt; error: invalid argument in libvirt was built without the 'esx' driver
&gt;
&gt;
&gt;
&gt; What is the problem here?
&gt;

Your libvirt was compiled without the VMware vSphere/ESX driver that
supports VMware vSphere/ESX(i) and VMware Server. For VMware Player
and Workstation you'll need the other VMware driver, that was recently
added. The later one has no additional dependencies and should be
available by default.

If you compiled libvirt from source yourself you need to have the
libcurl development package installed. Otherwise the configure script
will disable ESX support.

If you installed libvirt as package from your distro then your distro
decided to disable ESX support.

&gt;
&gt; For information, I installed libvirt-0.8.7, can you give me the first step
&gt; to manage an existing vm hosted on a distant vmWare (via CLI).
&gt;

Sure, we'll try to help you, but first we need to know to which of
VMware's hypervisors you actually want to talk to: VMware ESX(i),
Server (aka GSX), Player or Workstation.

Matthias

</body></email><email><emailId>20110203034211</emailId><senderName>Anthony Goddard</senderName><senderEmail>agoddard@mbl.edu</senderEmail><timestampReceived>2011-02-03 03:42:11-0400</timestampReceived><subject>Re: [libvirt-users] iSCSI storage pool questions</subject><body>

I think I may have inadvertently answered one of my questions, I was under the \
impression that an iSCSI storage pool was simply a pool of disk that libvirt could \
then create individual disks on (similar to an LVM VolumeGroup and Logical Volumes). \
But it seems that all disk creation has to happen on the SAN side when setup this \
way.

Is anyone aware of good guides for setting up a similar scenario using iSCSI backed \
LVM? I'm worried about consistency &amp; corruption across hosts and I'd love to see an \
example of a working setup documented somewhere.

Cheers,
Anthony


On Feb 2, 2011, at 4:26 PM, Anthony Goddard wrote:

&gt; Hi All,
&gt; I've been trying to figure out the best way of using an iSCSI SAN with KVM and \
&gt; thanks to a helpful post by Tom Georgoulias that I found on this list \
&gt; (https://www.redhat.com/archives/libvirt-users/2010-May/msg00008.html), it appears \
&gt; I have a solution. 
&gt; What I'm wondering is the following:
&gt; 
&gt; 1) If I use an iSCSI LUN as the storage pool (instead of creating an LVM VG from \
&gt; this iSCSI LUN manually first and using LVM in libvirt) do I loose any \
&gt; functionality (such as snapshotting)? 
&gt; 2) If I am intending on doing offline &amp; live-migration between hosts, does each \
&gt; host have to connect to the same LUN / storage pool, or should each host have a \
&gt; separate LUN that is stores VMs on and then each host should simply see all of the \
&gt; LUNs so that migration is possible? 
&gt; For example:
&gt; I create a LUN on the SAN, connect this to host 1 as a pool called "pool 1" and \
&gt; create VMs on it. Then, on host 2, do I connect to the same "pool 1" and create VMs \
&gt; there, or do I just connect to "pool 1" in order to see it (for migrations) but \
&gt; also define "pool 2" from another new LUN on the SAN and create VMs there? Hope \
&gt; that makes sense.. 
&gt; I'm trying to understand in what situations I might get myself in trouble by two \
&gt; hosts performing storage operations at the same time on the same pool (which is \
&gt; unlikely, but I'm trying to figure out where I stand) 
&gt; 
&gt; Thanks!
&gt; Anthony
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users


[Attachment #3 (unknown)]

&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body style="word-wrap: break-word; -webkit-nbsp-mode: space; \
-webkit-line-break: after-white-space; "&gt;&lt;div&gt;I think I may have inadvertently \
answered one of my questions, I was under the impression that an iSCSI storage pool \
was simply a pool of disk that libvirt could then create individual disks on (similar \
to an LVM VolumeGroup and Logical Volumes). But it seems that all disk creation has \
to happen on the SAN side when setup this way.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is anyone \
aware of good guides for setting up a similar scenario using iSCSI backed LVM? I'm \
worried about consistency &amp; corruption across hosts and I'd love to see an \
example of a working setup documented \
somewhere.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Cheers,&lt;/div&gt;&lt;div&gt;Anthony&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;div&gt;On \
Feb 2, 2011, at 4:26 PM, Anthony Goddard wrote:&lt;/div&gt;&lt;br \
class="Apple-interchange-newline"&gt;&lt;blockquote type="cite"&gt;&lt;div style="word-wrap: \
break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; "&gt;Hi \
All,&lt;div&gt;I've been trying to figure out the best way of using an iSCSI SAN with KVM \
and thanks to a helpful post by Tom Georgoulias that I found on this list (&lt;a \
href="https://www.redhat.com/archives/libvirt-users/2010-May/msg00008.html"&gt;https://www.redhat.com/archives/libvirt-users/2010-May/msg00008.html&lt;/a&gt;), \
it appears I have a solution.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;What I'm wondering is the \
following:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;1) If I use an iSCSI LUN as the storage pool \
(instead of creating an LVM VG from this iSCSI LUN manually first and using LVM in \
libvirt) do I loose any functionality (such as \
snapshotting)?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;2) If I am intending on doing offline &amp; \
live-migration between hosts, does each host have to connect to the \
&lt;i&gt;same&lt;/i&gt; LUN / storage pool, or should each host have a separate LUN that is \
stores VMs on and then each host should simply see all of the LUNs so that migration \
is possible?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;For example:&lt;/div&gt;&lt;div&gt;I create a LUN on the \
SAN, connect this to host 1 as a pool called "pool 1" and create VMs on \
it.&lt;/div&gt;&lt;div&gt;Then, on host 2, do I connect to the same "pool 1" and create VMs \
there, or do I just connect to "pool 1" in order to see it (for migrations) but also \
define "pool 2" from another new LUN on the SAN and create VMs there? Hope that makes \
sense..&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I'm trying to understand in what situations I might \
get myself in trouble by two hosts performing storage operations at the same time on \
the same pool (which is unlikely, but I'm trying to figure out where I \
stand)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks!&lt;/div&gt;&lt;div&gt;Anthony&lt;/div&gt;&lt;/div&gt;_______________________________________________&lt;br&gt;libvirt-users \
mailing list&lt;br&gt;&lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt; \
&lt;br&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/body&gt;&lt;/html&gt;




</body></email><email><emailId>20110203165553</emailId><senderName>Bryan Kearney</senderName><senderEmail>bkearney@redhat.com</senderEmail><timestampReceived>2011-02-03 16:55:53-0400</timestampReceived><subject>[libvirt-users] Release of libvirt-java 0.4.7</subject><body>

I have just released 0.4.7 of libvirt java. There are 2 main items in 
this release:

- Only throw errors on real errors.
- Remote non thread safe error reporting
- BZ 600819 Incorrect scheduler parameter value passed to native API.

You can access the latest version via the following means:

Source Code: http://www.libvirt.org/git/?p=libvirt-java.git;a=summary
Bundled Source (tarball and SRPM): http://libvirt.org/sources/java/
Maven: http://libvirt.org/maven2/
RPMS are making their way through F-14, F-13, and F12 build systems

Thank you!

-- bk

</body></email><email><emailId>20110205124318</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-02-05 12:43:18-0400</timestampReceived><subject>Re: [libvirt-users] libvirt, snapshots, LVM, and existing VMs</subject><body>

于 2011年02月04日 01:02, Casey Link 写道:
&gt;&gt; Sorry for the late, qemu driver only supports domain snapshotting
&gt;&gt; when the disks' driver type is "qcow2". e.g.
&gt;&gt;
&gt;&gt; &lt;disk...&gt;
&gt;&gt;     ......
&gt;&gt;     &lt;driver name="qemu" type="qcow2"/&gt;
&gt;&gt;     ......
&gt;&gt; &lt;/disk&gt;
&gt;
&gt; Ah, thanks. I assume this means I can't snapshot LVM backed domains at
&gt; this time? That is, it isn't possible to use qcow2 and lvm at the same
&gt; time?
&gt;
Yes, actually we have a bug: https://bugzilla.redhat.com 
/show_bug.cgi?id=613557， :-)

Regards
Osier

</body></email><email><emailId>20110205203638</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2011-02-05 20:36:38-0400</timestampReceived><subject>Re: [libvirt-users] Network/bridge questions</subject><body>

On 02/05/2011 01:06 AM, Alex wrote:
&gt; Hi,
&gt;
&gt; I have an fc14 install and would like to install a few kvm guests but
&gt; am having difficulty with the networking. On the host I have disabled
&gt; NetworkManager and configured a bridge which has eth0, the only
&gt; physical interface on the server.
&gt;
&gt; I have a dhcp server on the local lan, and if I add a mac address
&gt; entry to my dhcpd.conf, the guest will find an IP from there. I think
&gt; somehow the guest interface is not properly being routed through the
&gt; virtual gateway created by libvirtd, and is instead just routed
&gt; through br0 directly on the host. What am I missing?

You're mixing up two different modes of guest network connection:

1) bridge mode - the guest interface definition has &lt;source 
bridge='xxx'/&gt; (where 'xxx' is the name of a bridge device on the host 
that has a physical interface directly connected to it). In this case, 
packets from the guest travel from qemu through a tap device to the 
bridge (eg "br0") and from there directly out the physical interface.

2) virtual network mode - the guest interface definition has &lt;source 
network='xxx'/&gt; (where 'xxx' is the name of a virtual network defined in 
libvirt). The virtual network is in reality a bridge device that has *no 
connected physical devices*; traffic from the guest will go from qemu 
through a tap device to the bridge, and from there (possibly be NATed 
and) be given to the IP routing stack of the host, which will decide 
which physical interface, if any, to route the packet out.

If you are using the first mode, your guest will acquire any dhcp 
address from the dhcp server on the local physical LAN, and traffic 
will, as explained above, not be routed through any virtual network 
created by libvirt.

If you want the guest to behave as if it were connected directly to the 
physical network, use bridged mode. If you want to the guest to be on a 
separate subnet that lives completely on the host, and only reach the 
physical network via the IP routing stack of the host, then use one of 
the virtual network modes.

In your question above, you've setup the guest to use bridged mode, but 
then expect it to behave as if you'd used one of the virtual network 
modes. If the latter is what you really want, then the XML of the 
interface definition should look like what I show below, just after your 
current definition.


&gt; Here is some relevant output from some of the things I know:
&gt;
&gt; # # brctl show
&gt; bridge name     bridge id               STP enabled     interfaces
&gt; br0             8000.485b3961b55c       no              eth0
&gt;                                                          vnet0
&gt; virbr0          8000.000000000000       yes
&gt;
&gt; I don't understand what purpose the vnet0 has, or even how it got
&gt; there in the first place. Is it necessary, or did I do something wrong
&gt; here?
&gt;
&gt; # virsh net-list --all
&gt; Name                 State      Autostart
&gt; -----------------------------------------
&gt; default              active     yes
&gt;
&gt; &gt; From the guest xml file in /etc/libvirt/qemu/
&gt;
&gt;      &lt;interface type='bridge'&gt;
&gt;        &lt;mac address='52:54:00:a8:c5:9d'/&gt;
&gt;        &lt;source bridge='br0'/&gt;
&gt;        &lt;model type='virtio'/&gt;
&gt;        &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03'
&gt; function='0x0'/&gt;
&gt;      &lt;/interface&gt;

To connect via libvirt's virtual network (in this case, the network 
named "default", which operates in NATed mode), change your interface 
definition as follows:

     &lt;interface type='network'&gt;
       &lt;mac address='52:54:00:a8:c5:9d'/&gt;
       &lt;source network='default'/&gt;
       &lt;model type='virtio'/&gt;
       &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03' function='0x0'/&gt;
     &lt;/interface&gt;

See http://www.libvirt.org/formatdomain.html#elementsNICS for a more 
detailed explanation.

&gt; I've also flushed the firewall rules, so I'm sure the dhcp request
&gt; isn't being blocked. I've also tried changing the br0 above to virbr0,
&gt; with no change.
&gt;
&gt; This is from "net-edit default" in virsh:
&gt;
&gt; &lt;network&gt;
&gt;    &lt;name&gt;default&lt;/name&gt;
&gt;    &lt;uuid&gt;3d1f153f-fc0f-4de5-98c8-7f99f96f34d6&lt;/uuid&gt;
&gt;    &lt;forward mode='nat'/&gt;
&gt;    &lt;bridge name='virbr0' stp='on' delay='0' /&gt;
&gt;    &lt;ip address='192.168.122.1' netmask='255.255.255.0'&gt;
&gt;      &lt;dhcp&gt;
&gt;        &lt;range start='192.168.122.2' end='192.168.122.254' /&gt;
&gt;      &lt;/dhcp&gt;
&gt;    &lt;/ip&gt;
&gt; &lt;/network&gt;
&gt;
&gt; Sure would appreciate any ideas you may have.
&gt;
&gt; Thanks,
&gt; Alex
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

</body></email><email><emailId>20110104130848</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2011-01-04 13:08:48-0400</timestampReceived><subject>Re: [libvirt-users] availability of snapshots functionality via Python bindings</subject><body>

On 01/04/11 - 01:04:55PM, Marcin Krol wrote:
&gt; -----BEGIN PGP SIGNED MESSAGE-----
&gt; Hash: SHA1
&gt; 
&gt; Chris Lalancette wrote:
&gt; &gt; Snapshot support is indeed in the libvirt python bindings already, but you
&gt; &gt; are using an *ancient* version.  You need at least libvirt 0.8.2 to get
&gt; &gt; snapshot support.
&gt; 
&gt; Thanks! That's what I needed to know.
&gt; 
&gt; Regarding snapshots themselves: I presume with KVM/QEMU a qcow2 format
&gt; of the vm's disk is still required to make snapshots?

Yes, that is correct.

-- 
Chris Lalancette

</body></email><email><emailId>20110104140138</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-01-04 14:01:38-0400</timestampReceived><subject>Re: [libvirt-users] autostarting storage pool</subject><body>

2011/1/4 Marcin Krol &lt;mrkafk@gmail.com&gt;:
&gt; -----BEGIN PGP SIGNED MESSAGE-----
&gt; Hash: SHA1
&gt;
&gt; Hello everyone,
&gt;
&gt; How do I make storage pool auto start?
&gt;
&gt; I have:
&gt;
&gt; virsh # pool-list
&gt; Name                 State      Autostart
&gt; - -----------------------------------------
&gt; default              active     yes
&gt; virtimages           active     no
&gt;
&gt;
&gt; I don't see anything in pool's xml that could suit this purpose:
&gt;

That's expected because autostart isn't configured in the XML config.

See the virsh pool-autostart command for this.

Matthias

</body></email><email><emailId>20110105055315</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-01-05 05:53:15-0400</timestampReceived><subject>Re: [libvirt-users] Xen/KVM guest disk sizes</subject><body>

No specific virsh command or API to do this work.

However, you could check it by:

virsh # vol-info /var/lib/libvirt/images/f14.img
Name:           f14.img
Type:           file
Capacity:       8.00 GB
Allocation:     8.00 GB

virsh # vol-info /var/lib/libvirt/images/mytest.qcow2
Name:           mytest.qcow2
Type:           file
Capacity:       10.00 MB
Allocation:     136.00 KB

Regards
Osier
于 2011年01月05日 00:44, Tavares, John 写道:
&gt; I was wondering if there is any way from either the virsh CLI or the
&gt; libvirt API (preferably virsh) to get the amount of disk space to get
&gt; the amount of disk space each guest has been assigned??
&gt;
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110202102244</emailId><senderName>Etienne GOSSET</senderName><senderEmail>ego@ubiqube.com</senderEmail><timestampReceived>2011-02-02 10:22:44-0400</timestampReceived><subject>[libvirt-users] virsh : Need help to manage a vm on a remote vmWare</subject><body>

Hello,

I'm trying to use the tool virsh of libvirt.
I want to manage via CLI a vm on a vmware hypervisor which is hosted on a r=
emote host (Is that what you call the node??).

I read a lot of thing on your site but I really don't understand how to do =
something...
I saw that:

&gt;virsh edit $your-vm-name

I think "$your-vm-name" is the xml file you're talking about?



Is it mandatory to use those XML file in order to use virsh? (Because it is=
 very huge!)



I also saw this way of using virsh :

&gt;virsh --connect esx://user@hypervisorHost://path/to/myVM.vmx



Result is:

error: invalid argument in libvirt was built without the 'esx' driver



What is the problem here?



For information, I installed libvirt-0.8.7, can you give me the first step =
to manage an existing vm hosted on a distant vmWare (via CLI).



Thank you in advance.

[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;meta http-equiv=Content-Type content="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 11 (filtered medium)"&gt;
&lt;style&gt;
&lt;!--
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
pre
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Courier New";}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:Arial;
	color:windowtext;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:70.85pt 70.85pt 70.85pt 70.85pt;}
div.Section1
	{page:Section1;}
--&gt;
&lt;/style&gt;
&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapelayout v:ext="edit"&gt;
  &lt;o:idmap v:ext="edit" data="1" /&gt;
 &lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
&lt;/head&gt;

&lt;body lang=FR link=blue vlink=purple&gt;

&lt;div class=Section1&gt;

&lt;p class=MsoNormal&gt;&lt;font size=2 face=Arial&gt;&lt;span lang=EN-GB style='font-size:
10.0pt;font-family:Arial'&gt;Hello,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=2 face=Arial&gt;&lt;span lang=EN-GB style='font-size:
10.0pt;font-family:Arial'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=2 face=Arial&gt;&lt;span lang=EN-GB style='font-size:
10.0pt;font-family:Arial'&gt;I’m trying to use the tool virsh of \
libvirt.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=2 face=Arial&gt;&lt;span lang=EN-GB style='font-size:
10.0pt;font-family:Arial'&gt;I want to manage via CLI a vm on a vmware hypervisor
which is hosted on a remote host (Is that what you call the \
node??).&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=2 face=Arial&gt;&lt;span lang=EN-GB style='font-size:
10.0pt;font-family:Arial'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=2 face=Arial&gt;&lt;span lang=EN-GB style='font-size:
10.0pt;font-family:Arial'&gt;I read a lot of thing on your site but I really don’t
understand how to do something…&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=2 face=Arial&gt;&lt;span lang=EN-GB style='font-size:
10.0pt;font-family:Arial'&gt;I saw that:&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;pre&gt;&lt;font size=2 face=Arial&gt;&lt;span lang=EN-GB style='font-size:10.0pt;
font-family:Arial'&gt;&gt;&lt;/span&gt;&lt;/font&gt;&lt;font face=Arial&gt;&lt;span style='font-family:
Arial'&gt;virsh edit $your-vm-name&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre&gt;&lt;font
size=2 face=Arial&gt;&lt;span lang=EN-GB style='font-size:10.0pt;font-family:Arial'&gt;I think \
“$your-vm-name” is the xml file you’re talking \
about?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre&gt;&lt;font size=2 face=Arial&gt;&lt;span lang=EN-GB \
style='font-size:10.0pt;font-family:Arial'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre&gt;&lt;font
 size=2 face=Arial&gt;&lt;span lang=EN-GB style='font-size:10.0pt;font-family:Arial'&gt;Is it \
mandatory to use those XML file in order to use virsh? (Because it is very \
huge!)&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre&gt;&lt;font size=2 face=Arial&gt;&lt;span lang=EN-GB \
style='font-size:10.0pt;font-family:Arial'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre&gt;&lt;font
 size=2 face=Arial&gt;&lt;span lang=EN-GB style='font-size:10.0pt;font-family:Arial'&gt;I also \
saw this way of using virsh : &lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre&gt;&lt;font size=2 \
face=Arial&gt;&lt;span lang=EN-GB style='font-size:10.0pt;font-family:Arial'&gt;&gt;virsh \
--connect esx://user@hypervisorHost://path/to/myVM.vmx&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre&gt;&lt;font
 size=2 face=Arial&gt;&lt;span lang=EN-GB \
style='font-size:10.0pt;font-family:Arial'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre&gt;&lt;font
 size=2 face=Arial&gt;&lt;span lang=EN-GB style='font-size:10.0pt;font-family:Arial'&gt;Result \
is: &lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre&gt;&lt;font size=2 face=Arial&gt;&lt;span lang=EN-GB \
style='font-size:10.0pt;font-family:Arial'&gt;error: invalid argument in libvirt was \
built without the 'esx' driver&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre&gt;&lt;font size=2 \
face=Arial&gt;&lt;span lang=EN-GB \
style='font-size:10.0pt;font-family:Arial'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre&gt;&lt;font
 size=2 face=Arial&gt;&lt;span lang=EN-GB style='font-size:10.0pt;font-family:Arial'&gt;What \
is the problem here?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre&gt;&lt;font size=2 face=Arial&gt;&lt;span \
lang=EN-GB style='font-size:10.0pt;font-family:Arial'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre&gt;&lt;font
 size=2 face=Arial&gt;&lt;span lang=EN-GB style='font-size:10.0pt;font-family:Arial'&gt;For \
information, I installed libvirt-0.8.7, can you give me the first step to manage an \
existing vm hosted on a distant vmWare (via \
CLI).&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre&gt;&lt;font size=2 face=Arial&gt;&lt;span lang=EN-GB \
style='font-size:10.0pt;font-family:Arial'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre&gt;&lt;font
 size=2 face=Arial&gt;&lt;span lang=EN-GB style='font-size:10.0pt;font-family:Arial'&gt;Thank \
you in advance.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;



</body></email><email><emailId>20110202212606</emailId><senderName>Anthony Goddard</senderName><senderEmail>agoddard@mbl.edu</senderEmail><timestampReceived>2011-02-02 21:26:06-0400</timestampReceived><subject>[libvirt-users] iSCSI storage pool questions</subject><body>

Hi All,
I've been trying to figure out the best way of using an iSCSI SAN with =
KVM and thanks to a helpful post by Tom Georgoulias that I found on this =
list =
(https://www.redhat.com/archives/libvirt-users/2010-May/msg00008.html), =
it appears I have a solution.

What I'm wondering is the following:

1) If I use an iSCSI LUN as the storage pool (instead of creating an LVM =
VG from this iSCSI LUN manually first and using LVM in libvirt) do I =
loose any functionality (such as snapshotting)?

2) If I am intending on doing offline &amp; live-migration between hosts, =
does each host have to connect to the same LUN / storage pool, or should =
each host have a separate LUN that is stores VMs on and then each host =
should simply see all of the LUNs so that migration is possible?

For example:
I create a LUN on the SAN, connect this to host 1 as a pool called "pool =
1" and create VMs on it.
Then, on host 2, do I connect to the same "pool 1" and create VMs there, =
or do I just connect to "pool 1" in order to see it (for migrations) but =
also define "pool 2" from another new LUN on the SAN and create VMs =
there? Hope that makes sense..

I'm trying to understand in what situations I might get myself in =
trouble by two hosts performing storage operations at the same time on =
the same pool (which is unlikely, but I'm trying to figure out where I =
stand)


Thanks!
Anthony=

[Attachment #3 (unknown)]

&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body style="word-wrap: break-word; -webkit-nbsp-mode: space; \
-webkit-line-break: after-white-space; "&gt;Hi All,&lt;div&gt;I've been trying to figure out \
the best way of using an iSCSI SAN with KVM and thanks to a helpful post by Tom \
Georgoulias that I found on this list (&lt;a \
href="https://www.redhat.com/archives/libvirt-users/2010-May/msg00008.html"&gt;https://www.redhat.com/archives/libvirt-users/2010-May/msg00008.html&lt;/a&gt;), \
it appears I have a solution.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;What I'm wondering is the \
following:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;1) If I use an iSCSI LUN as the storage pool \
(instead of creating an LVM VG from this iSCSI LUN manually first and using LVM in \
libvirt) do I loose any functionality (such as \
snapshotting)?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;2) If I am intending on doing offline &amp; \
live-migration between hosts, does each host have to connect to the \
&lt;i&gt;same&lt;/i&gt; LUN / storage pool, or should each host have a separate LUN that is \
stores VMs on and then each host should simply see all of the LUNs so that migration \
is possible?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;For example:&lt;/div&gt;&lt;div&gt;I create a LUN on the \
SAN, connect this to host 1 as a pool called "pool 1" and create VMs on \
it.&lt;/div&gt;&lt;div&gt;Then, on host 2, do I connect to the same "pool 1" and create VMs \
there, or do I just connect to "pool 1" in order to see it (for migrations) but also \
define "pool 2" from another new LUN on the SAN and create VMs there? Hope that makes \
sense..&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I'm trying to understand in what situations I might \
get myself in trouble by two hosts performing storage operations at the same time on \
the same pool (which is unlikely, but I'm trying to figure out where I \
stand)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks!&lt;/div&gt;&lt;div&gt;Anthony&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;




</body></email><email><emailId>20110123080102</emailId><senderName>Casey Link</senderName><senderEmail>unnamedrambler@gmail.com</senderEmail><timestampReceived>2011-01-23 08:01:02-0400</timestampReceived><subject>[libvirt-users] libvirt, snapshots, LVM, and existing VMs</subject><body>

Hello,

I am running libvirt 0.8.3 with a couple VMs using a LVM VG that I had
previously setup on my host. I did not use the storage pool
functionality of libvirt to create the VG in the first place
('pool-list' is empty).

Now I want to be able to take snapshots of the VMs. Having read this
previous post [1] on the mailing list, I gather that libvirt does
indeed support taking snapshots of VMs on an LVM. I suppose I need to
create storage pool that includes the &lt;backingStore&gt; element. However,
I am not sure how to go about creating this pool and making my
existing VMs utilize it.

Is what I am trying to do even possible? If so, what is the proper way
to go about doing it?

Best,
Casey Link

[1] http://www.redhat.com/archives/libvir-list/2009-February/msg00196.html

</body></email><email><emailId>20110123114133</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-01-23 11:41:33-0400</timestampReceived><subject>Re: [libvirt-users] libvirt, snapshots, LVM, and existing VMs</subject><body>

于 2011年01月23日 16:01, Casey Link 写道:
&gt; Hello,
&gt; 
&gt; I am running libvirt 0.8.3 with a couple VMs using a LVM VG that I had
&gt; previously setup on my host. I did not use the storage pool
&gt; functionality of libvirt to create the VG in the first place
&gt; ('pool-list' is empty).
&gt; 
&gt; Now I want to be able to take snapshots of the VMs. Having read this
&gt; previous post [1] on the mailing list, I gather that libvirt does
&gt; indeed support taking snapshots of VMs on an LVM. I suppose I need to
&gt; create storage pool that includes the&lt;backingStore&gt;  element. However,
&gt; I am not sure how to go about creating this pool and making my
&gt; existing VMs utilize it.
&gt; 
&gt; Is what I am trying to do even possible? If so, what is the proper way
&gt; to go about doing it?
&gt; 

How to create the logical pool, refer to:
http://libvirt.org/git/?p=libvirt.git;a=tree;f=tests/storagepoolxml2xmlin;h=92d08b31073ade34bc2112694219030130fc5bd1;hb=HEAD


How to create the logical volume with backing store, refer to:
http://libvirt.org/git/?p=libvirt.git;a=tree;f=tests/storagevolxml2xmlin;h=ed26441f354c5183499eae14b56e280fe36c1da6;hb=HEAD


Hope it helps.

Regards
Osier
&gt; Best,
&gt; Casey Link
&gt; 
&gt; [1] http://www.redhat.com/archives/libvir-list/2009-February/msg00196.html
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users


</body></email><email><emailId>20110124034902</emailId><senderName>Casey Link</senderName><senderEmail>unnamedrambler@gmail.com</senderEmail><timestampReceived>2011-01-24 03:49:02-0400</timestampReceived><subject>Re: [libvirt-users] libvirt, snapshots, LVM, and existing VMs</subject><body>

Thanks for the info. Those xml files will be invaluable.

&gt; How to create the logical pool, refer to:
&gt; http://libvirt.org/git/?p=libvirt.git;a=tree;f=tests/storagepoolxml2xmlin;h=92d08b31073ade34bc2112694219030130fc5bd1;hb=HEAD
&gt; 

Looking at the pool-logical*.xml, pool-logical.xml will not harm an
existing data on disk, correct? Whereas pool-logical-create.xml will
attempt to create a new VG (and could cause data loss)?

&gt; How to create the logical volume with backing store, refer to:
&gt; http://libvirt.org/git/?p=libvirt.git;a=tree;f=tests/storagevolxml2xmlin;h=ed26441f354c5183499eae14b56e280fe36c1da6;hb=HEAD
&gt; 

Since I already have LVM setup, and an active VG should I just omit
the following from my logical vol xml?
&lt;source&gt;
   &lt;device path='/dev/sda2'&gt;
     &lt;extent start='31440502784' end='33520877568'/&gt;
   &lt;/device&gt;
 &lt;/source&gt;
 &lt;capacity&gt;2080374784&lt;/capacity&gt;
 &lt;allocation&gt;2080374784&lt;/allocation&gt;

You can understand I'm somewhat hesitant to do this, as I don't want
to destroy or overwrite any existing data.

Best,
Casey


</body></email><email><emailId>20110124060607</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-24 06:06:07-0400</timestampReceived><subject>Re: [libvirt-users] libvirt, snapshots, LVM, and existing VMs</subject><body>

On 24/01/2011, at 2:49 PM, Casey Link wrote:
&lt;snip&gt;
&gt; You can understand I'm somewhat hesitant to do this, as I don't want
&gt; to destroy or overwrite any existing data.

Um, do you have enough spare space to make a full backup of the existing volume \
somewhere first?

Just from the point of view that it's generally a really bad idea to use Actual Data \
(without a backup) for learning with. :)


</body></email><email><emailId>20110129221812</emailId><senderName>Casey Link</senderName><senderEmail>unnamedrambler@gmail.com</senderEmail><timestampReceived>2011-01-29 22:18:12-0400</timestampReceived><subject>Re: [libvirt-users] libvirt, snapshots, LVM, and existing VMs</subject><body>

&gt; How to create the logical pool, refer to:
&gt; http://libvirt.org/git/?p=libvirt.git;a=tree;f=tests/storagepoolxml2xmlin;h=92d08b31073ade34bc2112694219030130fc5bd1;hb=HEAD
&gt;  
&gt; How to create the logical volume with backing store, refer to:
&gt; http://libvirt.org/git/?p=libvirt.git;a=tree;f=tests/storagevolxml2xmlin;h=ed26441f354c5183499eae14b56e280fe36c1da6;hb=HEAD
&gt; 

Hi Osier,

So, I have managed to setup an LVM backed pool (koth-main), and
created volumes from this pool:

vol-create-as --pool koth-main --name koth-foo-snap --capacity 2G
vol-create-as --pool koth-main --name koth-foo --capacity 2G
--backing-vol koth-foo-snap

I then performed a virt-install, and after configuring the system
attempted s snapshot, but as you can see it still doesn't work. I get
the same error as before:
snapshot-create koth-foo
error: Requested operation is not valid: Disk '/dev/main/koth-foo'
does not support snapshotting

Did I miss a step?

Best,

Casey

Below is the XML for the main volume:

&lt;volume&gt;
  &lt;name&gt;koth-foo&lt;/name&gt;
  &lt;key&gt;5er4qK-stqa-zzJn-Npbe-HOeH-aYfs-TULujB&lt;/key&gt;
  &lt;source&gt;
    &lt;device path='/dev/sda2'&gt;
      &lt;extent start='417685569536' end='419833053184'/&gt;
    &lt;/device&gt;
  &lt;/source&gt;
  &lt;capacity&gt;2147483648&lt;/capacity&gt;
  &lt;allocation&gt;2147483648&lt;/allocation&gt;
  &lt;target&gt;
    &lt;path&gt;/dev/main/koth-foo&lt;/path&gt;
    &lt;permissions&gt;
      &lt;mode&gt;0600&lt;/mode&gt;
      &lt;owner&gt;0&lt;/owner&gt;
      &lt;group&gt;6&lt;/group&gt;
    &lt;/permissions&gt;
  &lt;/target&gt;
  &lt;backingStore&gt;
    &lt;path&gt;/dev/main/koth-foo-snap&lt;/path&gt;
    &lt;permissions&gt;
      &lt;mode&gt;0660&lt;/mode&gt;
      &lt;owner&gt;0&lt;/owner&gt;
      &lt;group&gt;6&lt;/group&gt;
    &lt;/permissions&gt;
  &lt;/backingStore&gt;
&lt;/volume&gt;


</body></email><email><emailId>20110203170203</emailId><senderName>Casey Link</senderName><senderEmail>unnamedrambler@gmail.com</senderEmail><timestampReceived>2011-02-03 17:02:03-0400</timestampReceived><subject>Re: [libvirt-users] libvirt, snapshots, LVM, and existing VMs</subject><body>

&gt; Sorry for the late, qemu driver only supports domain snapshotting
&gt; when the disks' driver type is "qcow2". e.g.
&gt;
&gt; &lt;disk...&gt;
&gt;    ......
&gt;    &lt;driver name="qemu" type="qcow2"/&gt;
&gt;    ......
&gt; &lt;/disk&gt;

Ah, thanks. I assume this means I can't snapshot LVM backed domains at
this time? That is, it isn't possible to use qcow2 and lvm at the same
time?

Best,
Casey

</body></email><email><emailId>20110205060623</emailId><senderName>Alex</senderName><senderEmail>mysqlstudent@gmail.com</senderEmail><timestampReceived>2011-02-05 06:06:23-0400</timestampReceived><subject>[libvirt-users] Network/bridge questions</subject><body>

Hi,

I have an fc14 install and would like to install a few kvm guests but
am having difficulty with the networking. On the host I have disabled
NetworkManager and configured a bridge which has eth0, the only
physical interface on the server.

I have a dhcp server on the local lan, and if I add a mac address
entry to my dhcpd.conf, the guest will find an IP from there. I think
somehow the guest interface is not properly being routed through the
virtual gateway created by libvirtd, and is instead just routed
through br0 directly on the host. What am I missing?

Here is some relevant output from some of the things I know:

# # brctl show
bridge name     bridge id               STP enabled     interfaces
br0             8000.485b3961b55c       no              eth0
                                                        vnet0
virbr0          8000.000000000000       yes

I don't understand what purpose the vnet0 has, or even how it got
there in the first place. Is it necessary, or did I do something wrong
here?

# virsh net-list --all
Name                 State      Autostart
-----------------------------------------
default              active     yes

&gt;From the guest xml file in /etc/libvirt/qemu/

    &lt;interface type='bridge'&gt;
      &lt;mac address='52:54:00:a8:c5:9d'/&gt;
      &lt;source bridge='br0'/&gt;
      &lt;model type='virtio'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03'
function='0x0'/&gt;
    &lt;/interface&gt;

I've also flushed the firewall rules, so I'm sure the dhcp request
isn't being blocked. I've also tried changing the br0 above to virbr0,
with no change.

This is from "net-edit default" in virsh:

&lt;network&gt;
  &lt;name&gt;default&lt;/name&gt;
  &lt;uuid&gt;3d1f153f-fc0f-4de5-98c8-7f99f96f34d6&lt;/uuid&gt;
  &lt;forward mode='nat'/&gt;
  &lt;bridge name='virbr0' stp='on' delay='0' /&gt;
  &lt;ip address='192.168.122.1' netmask='255.255.255.0'&gt;
    &lt;dhcp&gt;
      &lt;range start='192.168.122.2' end='192.168.122.254' /&gt;
    &lt;/dhcp&gt;
  &lt;/ip&gt;
&lt;/network&gt;

Sure would appreciate any ideas you may have.

Thanks,
Alex

</body></email><email><emailId>20110104134222</emailId><senderName>Marcin Krol</senderName><senderEmail>mrkafk@gmail.com</senderEmail><timestampReceived>2011-01-04 13:42:22-0400</timestampReceived><subject>[libvirt-users] autostarting storage pool</subject><body>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hello everyone,

How do I make storage pool auto start?

I have:

virsh # pool-list
Name                 State      Autostart
- -----------------------------------------
default              active     yes
virtimages           active     no


I don't see anything in pool's xml that could suit this purpose:

virsh # pool-dumpxml virtimages
&lt;pool type='dir'&gt;
  &lt;name&gt;virtimages&lt;/name&gt;
  &lt;uuid&gt;6294915e-7b48-e610-7e46-d771c2e376a3&lt;/uuid&gt;
  &lt;capacity&gt;84551581696&lt;/capacity&gt;
  &lt;allocation&gt;192811008&lt;/allocation&gt;
  &lt;available&gt;84358770688&lt;/available&gt;
  &lt;source&gt;
  &lt;/source&gt;
  &lt;target&gt;
    &lt;path&gt;/vms&lt;/path&gt;
    &lt;permissions&gt;
      &lt;mode&gt;0700&lt;/mode&gt;
      &lt;owner&gt;-1&lt;/owner&gt;
      &lt;group&gt;-1&lt;/group&gt;
    &lt;/permissions&gt;
  &lt;/target&gt;
&lt;/pool&gt;





- --

Regards,
mk

- --
Premature optimization is the root of all fun.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iQEcBAEBAgAGBQJNIyO+AAoJEFMgHzhQQ7hOuEwH/1a5zHnDNsGSsX6xLhGV3oN8
v81Vz5bE+SWBbiv3iv0fY8PVMmuEH/x0a4lLL3tZA8hvhPTvm2xGVHzGer9uHuUi
8mgUZUxNoE3tH7nLCzzBfO6QDOY5KZJat7C0sZ1yoAor5x18ARCcRou587zE8PZ5
xpBlcLMbt77sgG0BIirVtPF7jhLyRocUAQybVNyMqMUwiggaYwQXCE1EokcLjh6X
hxLvfaQaaY0DeFYoZyo52CzJIZjuK28KeZcdre2HRA1/Vn0Entpr3rovBwUibsTL
UD/MPPOXZHGuf0PxHNmxZKzjNrSVGaERuEvwIvH/yAHKykrZsX6e/HDo5XsklNs=
=+rTA
-----END PGP SIGNATURE-----

</body></email><email><emailId>20110104164413</emailId><senderName>"Tavares, John"</senderName><senderEmail>john_tavares@bmc.com</senderEmail><timestampReceived>2011-01-04 16:44:13-0400</timestampReceived><subject>[libvirt-users] Xen/KVM guest disk sizes</subject><body>

I was wondering if there is any way from either the virsh CLI or the libvir=
t API (preferably virsh) to get the amount of disk space to get the amount =
of disk space each guest has been assigned??


[Attachment #3 (text/html)]

&lt;html xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 11 (filtered medium)"&gt;
&lt;style&gt;
&lt;!--
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:Arial;
	color:windowtext;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;}
div.Section1
	{page:Section1;}
--&gt;
&lt;/style&gt;

&lt;/head&gt;

&lt;body lang=EN-US link=blue vlink=purple&gt;

&lt;div class=Section1&gt;

&lt;p class=MsoNormal style='text-autospace:none'&gt;&lt;font size=2 face="Courier New"&gt;&lt;span
style='font-size:10.0pt;font-family:"Courier New"'&gt;I was wondering if there is
any way from either the virsh CLI or the libvirt API (preferably virsh) to get
the amount of disk space to get the amount of disk space each guest has been
assigned??&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=2 face=Arial&gt;&lt;span style='font-size:10.0pt;
font-family:Arial'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;



</body></email><email><emailId>20110104165310</emailId><senderName>"Tavares, John"</senderName><senderEmail>john_tavares@bmc.com</senderEmail><timestampReceived>2011-01-04 16:53:10-0400</timestampReceived><subject>Re: [libvirt-users] Xen/KVM guest disk sizes</subject><body>

Lastly, if there is no way to get this information from virsh and/or libvir=
t, is there a way to figure it out any other way??

Thanks.

John

________________________________
From: Tavares, John
Sent: Tuesday, January 04, 2011 11:44 AM
To: 'libvirt-users@redhat.com'
Cc: Tavares, John; Betley, Greg; Tomen Tse; 'Daniel P. Berrange'
Subject: Xen/KVM guest disk sizes

I was wondering if there is any way from either the virsh CLI or the libvir=
t API (preferably virsh) to get the amount of disk space to get the amount =
of disk space each guest has been assigned??


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:st1="urn:schemas-microsoft-com:office:smarttags" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;meta http-equiv=Content-Type content="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 11 (filtered medium)"&gt;
&lt;!--[if !mso]&gt;
&lt;style&gt;
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
&lt;/style&gt;
&lt;![endif]--&gt;&lt;o:SmartTagType
 namespaceuri="urn:schemas-microsoft-com:office:smarttags" name="PersonName"/&gt;
&lt;!--[if !mso]&gt;
&lt;style&gt;
st1\:*{behavior:url(#default#ieooui) }
&lt;/style&gt;
&lt;![endif]--&gt;
&lt;style&gt;
&lt;!--
 /* Font Definitions */
 @font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal;
	font-family:Arial;
	color:windowtext;}
span.EmailStyle18
	{mso-style-type:personal-reply;
	font-family:Arial;
	color:navy;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;}
div.Section1
	{page:Section1;}
--&gt;
&lt;/style&gt;

&lt;/head&gt;

&lt;body lang=EN-US link=blue vlink=purple&gt;

&lt;div class=Section1&gt;

&lt;p class=MsoNormal&gt;&lt;font size=2 color=navy face=Arial&gt;&lt;span style='font-size:
10.0pt;font-family:Arial;color:navy'&gt;Lastly, if there is no way to get this
information from virsh and/or libvirt, is there a way to figure it out any
other way??&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=2 color=navy face=Arial&gt;&lt;span style='font-size:
10.0pt;font-family:Arial;color:navy'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=2 color=navy face=Arial&gt;&lt;span style='font-size:
10.0pt;font-family:Arial;color:navy'&gt;Thanks.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=2 color=navy face=Arial&gt;&lt;span style='font-size:
10.0pt;font-family:Arial;color:navy'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=2 color=navy face=Arial&gt;&lt;span style='font-size:
10.0pt;font-family:Arial;color:navy'&gt;John&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=2 color=navy face=Arial&gt;&lt;span style='font-size:
10.0pt;font-family:Arial;color:navy'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;div&gt;

&lt;div class=MsoNormal align=center style='text-align:center'&gt;&lt;font size=3
face="Times New Roman"&gt;&lt;span style='font-size:12.0pt'&gt;

&lt;hr size=2 width="100%" align=center tabindex=-1&gt;

&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;

&lt;p class=MsoNormal&gt;&lt;b&gt;&lt;font size=2 face=Tahoma&gt;&lt;span style='font-size:10.0pt;
font-family:Tahoma;font-weight:bold'&gt;From:&lt;/span&gt;&lt;/font&gt;&lt;/b&gt;&lt;font size=2
face=Tahoma&gt;&lt;span style='font-size:10.0pt;font-family:Tahoma'&gt; &lt;st1:PersonName
w:st="on"&gt;Tavares, John&lt;/st1:PersonName&gt; &lt;br&gt;
&lt;b&gt;&lt;span style='font-weight:bold'&gt;Sent:&lt;/span&gt;&lt;/b&gt; Tuesday, January 04, 2011
11:44 AM&lt;br&gt;
&lt;b&gt;&lt;span style='font-weight:bold'&gt;To:&lt;/span&gt;&lt;/b&gt; 'libvirt-users@redhat.com'&lt;br&gt;
&lt;b&gt;&lt;span style='font-weight:bold'&gt;Cc:&lt;/span&gt;&lt;/b&gt; &lt;st1:PersonName w:st="on"&gt;Tavares,
 John&lt;/st1:PersonName&gt;; &lt;st1:PersonName w:st="on"&gt;Betley, Greg&lt;/st1:PersonName&gt;;
&lt;st1:PersonName w:st="on"&gt;Tomen Tse&lt;/st1:PersonName&gt;; '&lt;st1:PersonName \
w:st="on"&gt;Daniel  P. Berrange&lt;/st1:PersonName&gt;'&lt;br&gt;
&lt;b&gt;&lt;span style='font-weight:bold'&gt;Subject:&lt;/span&gt;&lt;/b&gt; Xen/KVM guest disk \
sizes&lt;/span&gt;&lt;/font&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;p class=MsoNormal&gt;&lt;font size=3 face="Times New Roman"&gt;&lt;span style='font-size:
12.0pt'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal style='text-autospace:none'&gt;&lt;font size=2 face="Courier New"&gt;&lt;span
style='font-size:10.0pt;font-family:"Courier New"'&gt;I was wondering if there is
any way from either the virsh CLI or the libvirt API (preferably virsh) to get
the amount of disk space to get the amount of disk space each guest has been
assigned??&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=2 face=Arial&gt;&lt;span style='font-size:10.0pt;
font-family:Arial'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;



</body></email><email><emailId>20110104170021</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-04 17:00:21-0400</timestampReceived><subject>Re: [libvirt-users] Xen/KVM guest disk sizes</subject><body>

On 05/01/2011, at 3:53 AM, Tavares, John wrote:
&gt; Lastly, if there is no way to get this information from virsh and/or libvirt, is \
&gt; there a way to figure it out any other way??

Hi John,

Does the virsh "vol-list --details &lt;disk_image_name&gt;" command do what you want?

Regards and best wishes,

Justin Clift


</body></email><email><emailId>20110104170541</emailId><senderName>"Tavares, John"</senderName><senderEmail>john_tavares@bmc.com</senderEmail><timestampReceived>2011-01-04 17:05:41-0400</timestampReceived><subject>Re: [libvirt-users] Xen/KVM guest disk sizes</subject><body>

Hi Justin,

Is there a particular version of virsh/libvirt needed for this??

Thanks.

John

-----Original Message-----
From: Justin Clift [mailto:jclift@redhat.com] 
Sent: Tuesday, January 04, 2011 12:00 PM
To: Tavares, John
Cc: libvirt-users@redhat.com
Subject: Re: [libvirt-users] Xen/KVM guest disk sizes

On 05/01/2011, at 3:53 AM, Tavares, John wrote:
&gt; Lastly, if there is no way to get this information from virsh and/or libvirt, is \
&gt; there a way to figure it out any other way??

Hi John,

Does the virsh "vol-list --details &lt;disk_image_name&gt;" command do what you want?

Regards and best wishes,

Justin Clift


</body></email><email><emailId>20110104171037</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-04 17:10:37-0400</timestampReceived><subject>Re: [libvirt-users] Xen/KVM guest disk sizes</subject><body>

On 05/01/2011, at 4:05 AM, Tavares, John wrote:
&gt; Hi Justin,
&gt; 
&gt; Is there a particular version of virsh/libvirt needed for this??

Hi John,

Good point.  The --details option was added to vol-list from libvirt 0.8.3.

If the version of libvirt you're using is older than that, from memory you
should be able to get the same info (one volume at a time) using vol-info.

Does that work for you?

Regards and best wishes,

Justin Clift

</body></email><email><emailId>20110418135434</emailId><senderName>Marco Mirabile</senderName><senderEmail>dominioyp@gmail.com</senderEmail><timestampReceived>2011-04-18 13:54:34-0400</timestampReceived><subject>[libvirt-users] add file.img in libvirt</subject><body>

Good day
I downloaded an image of a VMs "centOS.img"
how can I open this image from libvirt?
I ask you with virt-install, but I could not
help me
dominioYP

[Attachment #3 (text/html)]

&lt;span class="Apple-style-span" style="font-family: arial, sans-serif; font-size: \
16px; "&gt;&lt;span class="hps" title="Fai clic per visualizzare le traduzioni \
alternative"&gt;Good day&lt;/span&gt;&lt;br&gt;&lt;span class="hps" title="Fai clic per visualizzare le \
traduzioni alternative"&gt;I&lt;/span&gt; &lt;span class="hps" title="Fai clic per visualizzare \
le traduzioni alternative"&gt;downloaded&lt;/span&gt; &lt;span class="hps" title="Fai clic per \
visualizzare le traduzioni alternative"&gt;an&lt;/span&gt; &lt;span class="hps" title="Fai clic \
per visualizzare le traduzioni alternative"&gt;image&lt;/span&gt; &lt;span class="hps" title="Fai \
clic per visualizzare le traduzioni alternative"&gt;of&lt;/span&gt; &lt;span class="hps" \
title="Fai clic per visualizzare le traduzioni alternative"&gt;a&lt;/span&gt; &lt;span \
class="hps" title="Fai clic per visualizzare le traduzioni alternative"&gt;VMs&lt;/span&gt; \
&lt;span class="hps atn" title="Fai clic per visualizzare le traduzioni \
alternative"&gt;"&lt;/span&gt;&lt;span title="Fai clic per visualizzare le traduzioni \
alternative" class=""&gt;centOS.img&lt;/span&gt;&lt;span title="Fai clic per visualizzare le \
traduzioni alternative" class=""&gt;"&lt;/span&gt;&lt;br&gt; &lt;span class="hps" title="Fai clic \
per visualizzare le traduzioni alternative"&gt;how&lt;/span&gt; &lt;span class="hps" title="Fai \
clic per visualizzare le traduzioni alternative"&gt;can I&lt;/span&gt; &lt;span class="hps" \
title="Fai clic per visualizzare le traduzioni alternative"&gt;open&lt;/span&gt; &lt;span \
class="hps" title="Fai clic per visualizzare le traduzioni alternative"&gt;this \
image&lt;/span&gt; &lt;span class="hps" title="Fai clic per visualizzare le traduzioni \
alternative"&gt;from&lt;/span&gt; &lt;span class="hps" title="Fai clic per visualizzare le \
traduzioni alternative"&gt;libvirt&lt;/span&gt;&lt;span title="Fai clic per visualizzare le \
traduzioni alternative" class=""&gt;?&lt;/span&gt;&lt;br&gt; &lt;span class="hps" title="Fai clic per \
visualizzare le traduzioni alternative"&gt;I&lt;/span&gt; &lt;span class="hps" title="Fai clic \
per visualizzare le traduzioni alternative"&gt;ask you&lt;/span&gt; &lt;span class="hps" \
title="Fai clic per visualizzare le traduzioni alternative"&gt;with&lt;/span&gt; &lt;span \
class="hps" title="Fai clic per visualizzare le traduzioni \
alternative"&gt;virt&lt;/span&gt;&lt;span class="atn" title="Fai clic per visualizzare le \
traduzioni alternative"&gt;-&lt;/span&gt;&lt;span title="Fai clic per visualizzare le traduzioni \
alternative" class=""&gt;install&lt;/span&gt;&lt;span title="Fai clic per visualizzare le \
traduzioni alternative" class=""&gt;,&lt;/span&gt; &lt;span class="hps" title="Fai clic per \
visualizzare le traduzioni alternative"&gt;but&lt;/span&gt; &lt;span class="hps" title="Fai clic \
per visualizzare le traduzioni alternative"&gt;I could not&lt;/span&gt;&lt;br&gt; &lt;span class="hps" \
title="Fai clic per visualizzare le traduzioni alternative"&gt;help&lt;/span&gt; &lt;span \
class="hps" title="Fai clic per visualizzare le traduzioni \
alternative"&gt;me&lt;/span&gt;&lt;/span&gt;&lt;div&gt;&lt;span class="Apple-style-span" style="font-family: \
arial, sans-serif; font-size: 16px; "&gt;&lt;span class="hps" title="Fai clic per \
visualizzare le traduzioni alternative"&gt;dominioYP&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;



</body></email><email><emailId>20110418144950</emailId><senderName></senderName><senderEmail>ssaleh</senderEmail><timestampReceived>2011-04-18 14:49:50-0400</timestampReceived><subject>[libvirt-users] Default network / net-edit</subject><body>

How do you modify the default network parameters?  The net-edit command within virsh does not seem to work as expected.

TIA

</body></email><email><emailId>20110416202119</emailId><senderName>David Lane</senderName><senderEmail>kg4giy@gmail.com</senderEmail><timestampReceived>2011-04-16 20:21:19-0400</timestampReceived><subject>[libvirt-users] Accessing a MAC address from inside the VM?</subject><body>

Greetings,

I have a very simple problem, but the resolution is proving rather complex.
Bare with me, I will attempt to explain.

I have a host machine with no GUI.

I attach an existing .img file to the host machine and need to change the
MAC address (since the image was created on another machine).  Is there a
way from with in the guest to do this or do I have muck with the XML?  And
if I muck with the XML and change it, how do I pass this information up to
the guest, or will the guest see it automagically or do I have to write it
down and then manually transfer it into the guest's ifcfg?

Using the GUI, when you change the NIC, the guest generally does not see the
new MAC and grouses until you change it.

Thanks.

DAVID

[Attachment #3 (text/html)]

Greetings,&lt;br&gt;&lt;br&gt;I have a very simple problem, but the resolution is proving rather \
complex.  Bare with me, I will attempt to explain.&lt;br&gt;&lt;br&gt;I have a host machine with \
no GUI.&lt;br&gt;&lt;br&gt;I attach an existing .img file to the host machine and need to change \
the MAC address (since the image was created on another machine).  Is there a way \
from with in the guest to do this or do I have muck with the XML?  And if I muck with \
the XML and change it, how do I pass this information up to the guest, or will the \
guest see it automagically or do I have to write it down and then manually transfer \
it into the guest's ifcfg?&lt;br&gt; &lt;br&gt;Using the GUI, when you change the NIC, the \
guest generally does not see the new MAC and grouses until you change \
it.&lt;br&gt;&lt;br&gt;Thanks.&lt;br&gt;&lt;br&gt;DAVID&lt;br clear="all"&gt;&lt;br&gt;



</body></email><email><emailId>20110418171205</emailId><senderName>Alex</senderName><senderEmail>mysqlstudent@gmail.com</senderEmail><timestampReceived>2011-04-18 17:12:05-0400</timestampReceived><subject>[libvirt-users] Undefined interfaces?</subject><body>

Hi,
I have a working fc14 install with a few virtual interfaces set up,
and just noticed the following in messages:

Apr 18 13:07:43 fc14 libvirtd: 13:07:43.155: error :
interfaceGetXMLDesc:355 : internal error could not get interface XML
description (netcf: NETLINK socket operation failed - couldn't find
ifindex for interface `br0:0`)
Apr 18 13:07:43 fc14 libvirtd: 13:07:43.165: error :
interfaceGetXMLDesc:355 : internal error could not get interface XML
description (netcf: NETLINK socket operation failed - couldn't find
ifindex for interface `eth0:0`)
Apr 18 13:07:43 fc14 libvirtd: 13:07:43.175: error :
interfaceGetXMLDesc:355 : internal error could not get interface XML
description (netcf: NETLINK socket operation failed - couldn't find
ifindex for interface `eth1:0`)
Apr 18 13:07:43 fc14 libvirtd: 13:07:43.185: error :
interfaceGetXMLDesc:355 : internal error could not get interface XML
description (netcf: NETLINK socket operation failed - couldn't find
ifindex for interface `eth1:1`)

I see several references that indicate this may be a bug. Or have I
configured something wrong?

I have some interfaces configured to be a bridge and others are
configured as a regular network, with the guests being masqueraded.
It's certainly possible I've configured something incorrectly.

I'm not sure what information to provide to help troubleshoot this.
Any information would be greatly appreciated.

Thanks,
Alex

</body></email><email><emailId>20110418221248</emailId><senderName>Yee Ja</senderName><senderEmail>yja@us.ibm.com</senderEmail><timestampReceived>2011-04-18 22:12:48-0400</timestampReceived><subject>[libvirt-users] kvm virtual server boot order</subject><body>


The boot order issue

   http://osdir.com/ml/libvir-list/2009-08/msg00398.html

resolved with the code changes specified by

   http://www.redhat.com/archives/libvir-list/2009-August/msg00340.html

seems to suggest that hard disks, cdroms, floppy devices (since they are
all disks) are ordered primarily by virtual bus type as encountered in the
domain xml.  This indicates that there can exist a conflict between the
primary and secondary boot device types.

Given the scenario where the disks of a virtual server are defined in the
following order

      harddisk hda
      harddisk vda
      cdrom vdb
      cdrom hdb

Boot device type is crdom.  Which cdrom device will be boot attempted?
&gt;From the above links, I'm guessing that hdb will be boot attempted. Is this
the actual behavior?


Thanks,
Yee
--
yja@us.ibm.com   *   512-286-6793 T/L 363   *   Systems Management Software
Development   *   Austin, TX

</body></email><email><emailId>20110421071918</emailId><senderName>KAMEZAWA Hiroyuki</senderName><senderEmail>kamezawa.hiroyu@jp.fujitsu.com</senderEmail><timestampReceived>2011-04-21 07:19:18-0400</timestampReceived><subject>[libvirt-users] [PATCHv11 0/6] libvirt/qemu - persistent modification of devices</subject><body>


Here is v11. Fixed comments/bugs and updated against the latest libvirt.git.

Changes v10-&gt;v11: 
 - fixed comments on each patches
 - fixed cgroup handling in patch 3.
 - fixed MODIFY_CURRENT handling in patch 4.

most of diff comes from refactoring qemu/qemu_driver.c
--
 conf/domain_conf.c   |   40 ++
 conf/domain_conf.h   |    5
 libvirt_private.syms |    3
 qemu/qemu_driver.c   |  727 +++++++++++++++++++++++++++++++--------------------
 4 files changed, 500 insertions(+), 275 deletions(-)


Thanks,
-Kame

</body></email><email><emailId>20110421165756</emailId><senderName>Marco van Beek</senderName><senderEmail>mvanbeek@supporting-role.co.uk</senderEmail><timestampReceived>2011-04-21 16:57:56-0400</timestampReceived><subject>[libvirt-users] No IOMMU found.  Unable to assign device</subject><body>

Hi,

I am playing around with PCI passthrough and came across some posts that 
said you could not do PCI passthrough unless you had IOMMU hardware. 
which it would appear I don't

Is this the case? Am I flogging a dead horse?

Thanks,

Marco

-- 
Marco van Beek
==========================================
Supporting Role Ltd.
Grove Park Studios,
188-192 Sutton Court Rd,
London, W4 3HR
==========================================
T: 0870 757 2824
F: 0870 757 2826
M: 0788 770 3604
E: mvanbeek@supporting-role.co.uk
W: http://www.supporting-role.co.uk/
==========================================
Company Registered in England No. 03658568
==========================================


</body></email><email><emailId>20110421072546</emailId><senderName>KAMEZAWA Hiroyuki</senderName><senderEmail>kamezawa.hiroyu@jp.fujitsu.com</senderEmail><timestampReceived>2011-04-21 07:25:46-0400</timestampReceived><subject>[libvirt-users] [PATCHv11 3/6] libvirt/qemu - clean up UpdateDevice for consolidation.</subject><body>

This patch strips reusable part of qemudDomainUpdateDeviceFlags()
and consolidate it to qemudDomainModifyDeviceFlags().
No functional changes.

Signed-off-by: KAMEZAWA Hiroyuki &lt;kamezawa.hiroyu@jp.fujitsu.com&gt;

Changelog: v10-&gt;v11
  - fixed qemuTeardownDiskCgroup()

* src/qemu/qemu_driver.c
(qemudDomainChangeDiskMediaLive) : pulled out code for updating disks.
(qemudDomainUpdateDeviceLive) : core of UpdateDevice, extracted from
UpdateDeviceFlags()
(qemudDomainModifyDeviceFlags): add support for updating device in live domain.
(qemudDomainUpdateDeviceFlags): reworked as a wrapper function of
qemudDomainModifyDeviceFlags()
---
 src/qemu/qemu_driver.c |  215 +++++++++++++++++++++--------------------------
 1 files changed, 96 insertions(+), 119 deletions(-)

diff --git a/src/qemu/qemu_driver.c b/src/qemu/qemu_driver.c
index f33a7f4..4cba9d0 100644
--- a/src/qemu/qemu_driver.c
+++ b/src/qemu/qemu_driver.c
@@ -3991,6 +3991,80 @@ static int qemudDomainDetachDeviceLive(virDomainObjPtr vm,
     return ret;
 }
 
+static int
+qemudDomainChangeDiskMediaLive(virDomainObjPtr vm,
+                               virDomainDeviceDefPtr dev,
+                               struct qemud_driver *driver,
+                               virBitmapPtr qemuCaps,
+                               bool force)
+{
+    virDomainDiskDefPtr disk = dev-&gt;data.disk;
+    virCgroupPtr cgroup = NULL;
+    int ret;
+
+    if (qemuCgroupControllerActive(driver, VIR_CGROUP_CONTROLLER_DEVICES)) {
+        if (virCgroupForDomain(driver-&gt;cgroup,
+                               vm-&gt;def-&gt;name, &amp;cgroup, 0) !=0 ) {
+            qemuReportError(VIR_ERR_INTERNAL_ERROR,
+                            _("Unable to find cgroup for %s"),
+                            vm-&gt;def-&gt;name);
+            goto end;
+        }
+        if (qemuSetupDiskCgroup(driver, vm, cgroup, disk) &lt; 0)
+            goto end;
+    }
+
+    switch (disk-&gt;device) {
+    case VIR_DOMAIN_DISK_DEVICE_CDROM:
+    case VIR_DOMAIN_DISK_DEVICE_FLOPPY:
+        ret = qemuDomainChangeEjectableMedia(driver, vm, disk, qemuCaps, force);
+        if (ret == 0)
+            dev-&gt;data.disk = NULL;
+        break;
+    default:
+        qemuReportError(VIR_ERR_CONFIG_UNSUPPORTED,
+                        _("disk bus '%s' cannot be updated."),
+                        virDomainDiskBusTypeToString(disk-&gt;bus));
+        break;
+    }
+
+    if (ret != 0 &amp;&amp; cgroup) {
+        if (qemuTeardownDiskCgroup(driver, vm, cgroup, disk) &lt; 0)
+             VIR_WARN("Failed to teardown cgroup for disk path %s",
+                      NULLSTR(disk-&gt;src));
+    }
+end:
+    if (cgroup)
+        virCgroupFree(&amp;cgroup);
+    return ret;
+}
+
+static int qemudDomainUpdateDeviceLive(virDomainObjPtr vm,
+                                       virDomainDeviceDefPtr dev,
+                                       virDomainPtr dom,
+                                       virBitmapPtr qemuCaps,
+                                       bool force)
+{
+    struct qemud_driver *driver = dom-&gt;conn-&gt;privateData;
+    int ret = -1;
+
+    switch (dev-&gt;type) {
+    case VIR_DOMAIN_DEVICE_DISK:
+        ret = qemudDomainChangeDiskMediaLive(vm, dev, driver, qemuCaps, force);
+        break;
+    case VIR_DOMAIN_DEVICE_GRAPHICS:
+        ret = qemuDomainChangeGraphics(driver, vm, dev-&gt;data.graphics);
+        break;
+    default:
+        qemuReportError(VIR_ERR_CONFIG_UNSUPPORTED,
+                        _("device type '%s' cannot be updated"),
+                        virDomainDeviceTypeToString(dev-&gt;type));
+        break;
+    }
+
+    return ret;
+}
+
 enum {
     QEMUD_DEVICE_ATTACH, QEMUD_DEVICE_DETACH, QEMUD_DEVICE_UPDATE,
 };
@@ -4002,10 +4076,25 @@ static int qemudDomainModifyDeviceFlags(virDomainPtr dom, const char *xml,
     virBitmapPtr qemuCaps = NULL;
     virDomainObjPtr vm = NULL;
     virDomainDeviceDefPtr dev = NULL;
+    bool force = (flags &amp; VIR_DOMAIN_DEVICE_MODIFY_FORCE) != 0;
     int ret = -1;
 
-    virCheckFlags(VIR_DOMAIN_DEVICE_MODIFY_LIVE |
-                  VIR_DOMAIN_DEVICE_MODIFY_CONFIG, -1);
+    switch (action) {
+    case QEMUD_DEVICE_ATTACH:
+    case QEMUD_DEVICE_DETACH:
+        virCheckFlags(VIR_DOMAIN_DEVICE_MODIFY_LIVE |
+                      VIR_DOMAIN_DEVICE_MODIFY_CONFIG, -1);
+        break;
+    case QEMUD_DEVICE_UPDATE:
+        virCheckFlags(VIR_DOMAIN_DEVICE_MODIFY_CURRENT |
+                      VIR_DOMAIN_DEVICE_MODIFY_LIVE |
+                      VIR_DOMAIN_DEVICE_MODIFY_CONFIG |
+                      VIR_DOMAIN_DEVICE_MODIFY_FORCE, -1);
+        break;
+    default:
+        break;
+    }
+
     if (flags &amp; VIR_DOMAIN_DEVICE_MODIFY_CONFIG) {
         qemuReportError(VIR_ERR_OPERATION_INVALID,
                         "%s", _("cannot modify the persistent configuration of a domain"));
@@ -4048,9 +4137,13 @@ static int qemudDomainModifyDeviceFlags(virDomainPtr dom, const char *xml,
     case QEMUD_DEVICE_DETACH:
         ret = qemudDomainDetachDeviceLive(vm, dev, dom, qemuCaps);
         break;
+    case QEMUD_DEVICE_UPDATE:
+        ret = qemudDomainUpdateDeviceLive(vm, dev, dom, qemuCaps, force);
+        break;
     default:
         break;
     }
+
     /*
      * update domain status forcibly because the domain status may be changed
      * even if we attach the device failed. For example, a new controller may
@@ -4089,125 +4182,9 @@ static int qemuDomainUpdateDeviceFlags(virDomainPtr dom,
                                        const char *xml,
                                        unsigned int flags)
 {
-    struct qemud_driver *driver = dom-&gt;conn-&gt;privateData;
-    virDomainObjPtr vm;
-    virDomainDeviceDefPtr dev = NULL;
-    virBitmapPtr qemuCaps = NULL;
-    virCgroupPtr cgroup = NULL;
-    int ret = -1;
-    bool force = (flags &amp; VIR_DOMAIN_DEVICE_MODIFY_FORCE) != 0;
-
-    virCheckFlags(VIR_DOMAIN_DEVICE_MODIFY_CURRENT |
-                  VIR_DOMAIN_DEVICE_MODIFY_LIVE |
-                  VIR_DOMAIN_DEVICE_MODIFY_CONFIG |
-                  VIR_DOMAIN_DEVICE_MODIFY_FORCE, -1);
-
-    if (flags &amp; VIR_DOMAIN_DEVICE_MODIFY_CONFIG) {
-        qemuReportError(VIR_ERR_OPERATION_INVALID,
-                        "%s", _("cannot modify the persistent configuration of a domain"));
-        return -1;
-    }
-
-    qemuDriverLock(driver);
-    vm = virDomainFindByUUID(&amp;driver-&gt;domains, dom-&gt;uuid);
-    if (!vm) {
-        char uuidstr[VIR_UUID_STRING_BUFLEN];
-        virUUIDFormat(dom-&gt;uuid, uuidstr);
-        qemuReportError(VIR_ERR_NO_DOMAIN,
-                        _("no domain with matching uuid '%s'"), uuidstr);
-        goto cleanup;
-    }
-
-    if (qemuDomainObjBeginJobWithDriver(driver, vm) &lt; 0)
-        goto cleanup;
-
-    if (!virDomainObjIsActive(vm)) {
-        qemuReportError(VIR_ERR_OPERATION_INVALID,
-                        "%s", _("cannot attach device on inactive domain"));
-        goto endjob;
-    }
-
-    dev = virDomainDeviceDefParse(driver-&gt;caps, vm-&gt;def, xml,
-                                  VIR_DOMAIN_XML_INACTIVE);
-    if (dev == NULL)
-        goto endjob;
-
-    if (qemuCapsExtractVersionInfo(vm-&gt;def-&gt;emulator, vm-&gt;def-&gt;os.arch,
-                                   NULL,
-                                   &amp;qemuCaps) &lt; 0)
-        goto endjob;
-
-    switch (dev-&gt;type) {
-    case VIR_DOMAIN_DEVICE_DISK:
-        if (qemuCgroupControllerActive(driver, VIR_CGROUP_CONTROLLER_DEVICES)) {
-            if (virCgroupForDomain(driver-&gt;cgroup, vm-&gt;def-&gt;name, &amp;cgroup, 0) !=0 ) {
-                qemuReportError(VIR_ERR_INTERNAL_ERROR,
-                                _("Unable to find cgroup for %s"),
-                                vm-&gt;def-&gt;name);
-                goto endjob;
-            }
-            if (qemuSetupDiskCgroup(driver, vm, cgroup, dev-&gt;data.disk) &lt; 0)
-                goto endjob;
-        }
-
-        switch (dev-&gt;data.disk-&gt;device) {
-        case VIR_DOMAIN_DISK_DEVICE_CDROM:
-        case VIR_DOMAIN_DISK_DEVICE_FLOPPY:
-            ret = qemuDomainChangeEjectableMedia(driver, vm,
-                                                 dev-&gt;data.disk,
-                                                 qemuCaps,
-                                                 force);
-            if (ret == 0)
-                dev-&gt;data.disk = NULL;
-            break;
-
-
-        default:
-            qemuReportError(VIR_ERR_CONFIG_UNSUPPORTED,
-                            _("disk bus '%s' cannot be updated."),
-                            virDomainDiskBusTypeToString(dev-&gt;data.disk-&gt;bus));
-            break;
-        }
-
-        if (ret != 0 &amp;&amp; cgroup) {
-            if (qemuTeardownDiskCgroup(driver, vm, cgroup, dev-&gt;data.disk) &lt; 0)
-                VIR_WARN("Failed to teardown cgroup for disk path %s",
-                         NULLSTR(dev-&gt;data.disk-&gt;src));
-        }
-        break;
-
-    case VIR_DOMAIN_DEVICE_GRAPHICS:
-        ret = qemuDomainChangeGraphics(driver, vm, dev-&gt;data.graphics);
-        break;
-
-    default:
-        qemuReportError(VIR_ERR_CONFIG_UNSUPPORTED,
-                        _("device type '%s' cannot be updated"),
-                        virDomainDeviceTypeToString(dev-&gt;type));
-        break;
-    }
-
-    if (!ret &amp;&amp; virDomainSaveStatus(driver-&gt;caps, driver-&gt;stateDir, vm) &lt; 0)
-        ret = -1;
-
-endjob:
-    if (qemuDomainObjEndJob(vm) == 0)
-        vm = NULL;
-
-cleanup:
-    if (cgroup)
-        virCgroupFree(&amp;cgroup);
-
-    qemuCapsFree(qemuCaps);
-    virDomainDeviceDefFree(dev);
-    if (vm)
-        virDomainObjUnlock(vm);
-    qemuDriverUnlock(driver);
-    return ret;
+    return qemudDomainModifyDeviceFlags(dom, xml, flags, QEMUD_DEVICE_UPDATE);
 }
 
-
-
 static int qemudDomainDetachDeviceFlags(virDomainPtr dom, const char *xml,
                                         unsigned int flags)
 {
-- 
1.7.4.1


</body></email><email><emailId>20110420173658</emailId><senderName>David White</senderName><senderEmail>dwhite@speakeasy.net</senderEmail><timestampReceived>2011-04-20 17:36:58-0400</timestampReceived><subject>[libvirt-users] domain not present after shutdown</subject><body>


I hope this is simple

I have one kvm host that lists all my domains even after shut down. 'virsh list
--all' shows machines in 'running' and 'shut off' states.  If I copy those over
to another machine and it only shows the virt machines in running state.

vmhost2:~$ virsh list --all
 Id Name                 State
----------------------------------
  4 mybox4               running

vmhost2:~$ virsh version
Compiled against library: libvir 0.8.3
Using library: libvir 0.8.3
Using API: QEMU 0.8.3
Running hypervisor: QEMU 0.12.5



vmhost1:~$ virsh list --all
 Id Name                 State
----------------------------------
  - mybox3               shut off
  2 mybox4               running

vmhost1:~$ virsh version
Compiled against library: libvir 0.7.5
Using library: libvir 0.7.5
Using API: QEMU 0.7.5
Running hypervisor: QEMU 0.12.3

question -- why doesn't mybox3 show up on vmhost2?  where should I start looking?

hope this isn't too open ended...

</body></email><email><emailId>20110422140417</emailId><senderName></senderName><senderEmail>ssaleh</senderEmail><timestampReceived>2011-04-22 14:04:17-0400</timestampReceived><subject>[libvirt-users] Setup Mulitple VM's</subject><body>

I have a small public IP block (/29) I'd like to populate with VM's from a single physical box running CentOS/5.  I'd like to get some thoughts on the best way to setup networking to support this.  I'm OK with setting up the virtual hosts.

Any advice would be appreciated.

TIA...

</body></email><email><emailId>20110423093537</emailId><senderName>Nikita A Menkovich</senderName><senderEmail>menkovich@gmail.com</senderEmail><timestampReceived>2011-04-23 09:35:37-0400</timestampReceived><subject>[libvirt-users] Media autoremove</subject><body>

I have an iso, than automate freebsd install, and after installation
it reboot VM.
I want to remove cdrom drive with ISO from VM config after reboot?
How I could do this?


-- 
Nikita A Menkovich
http://libc6.org/
JID: menkovich@gmail.com

</body></email><email><emailId>20110424195539</emailId><senderName>Miroslav Ludvik</senderName><senderEmail>miroslav.ludvik@4safety.cz</senderEmail><timestampReceived>2011-04-24 19:55:39-0400</timestampReceived><subject>[libvirt-users] problem with qemu</subject><body>

Hi All,

I use Ubuntu server 10.04 LTS as virtualization platform.

Actually running kernel 2.6.32-31-server #61-Ubuntu S

root@jupiter:~# uname -a
Linux jupiter 2.6.32-31-server #61-Ubuntu SMP Fri Apr 8 19:44:42 UTC
2011 x86_64 GNU/Linux

We have on running virtual
root@jupiter:~# virsh list --all
 Id Name                 State
----------------------------------
  1 kvmtik.4safety.cz    running


I run script for create virtual system wrote

root@jupiter:~# make-hestia.4safety.cz.sh
2011-04-24 21:13:25,613 ERROR   : ubuntu-kvm already exists
Traceback (most recent call last):
  File "/usr/bin/vmbuilder", line 24, in &lt;module&gt;
    cli.main()
  File "/usr/lib/python2.6/dist-packages/VMBuilder/contrib/cli.py", line
81, in main
    raise VMBuilderUserError('%s already exists' % destdir)
VMBuilder.exception.VMBuilderUserError: ubuntu-kvm already exists
/usr/local/bin/make-hestia.4safety.cz.sh: line 29:
--libvirt=qemu:///system: No such file or directory

I try restart libvirt and system wrote  to syslog

root@jupiter:~# /etc/init.d/libvirt-bin restart
Rather than invoking init scripts through /etc/init.d, use the service(8)
utility, e.g. service libvirt-bin restart

Since the script you are attempting to invoke has been converted to an
Upstart job, you may also use the restart(8) utility, e.g. restart
libvirt-bin
libvirt-bin start/running, process 25202
root@jupiter:~# tail -f /var/log/syslog
Apr 24 20:25:01 jupiter CRON[25031]: (root) CMD (command -v debian-sa1 &gt;
/dev/null &amp;&amp; debian-sa1 1 1)
Apr 24 20:35:01 jupiter CRON[25036]: (root) CMD (command -v debian-sa1 &gt;
/dev/null &amp;&amp; debian-sa1 1 1)
Apr 24 20:45:01 jupiter CRON[25042]: (root) CMD (command -v debian-sa1 &gt;
/dev/null &amp;&amp; debian-sa1 1 1)
Apr 24 20:55:01 jupiter CRON[25048]: (root) CMD (command -v debian-sa1 &gt;
/dev/null &amp;&amp; debian-sa1 1 1)
Apr 24 21:05:01 jupiter CRON[25152]: (root) CMD (command -v debian-sa1 &gt;
/dev/null &amp;&amp; debian-sa1 1 1)
Apr 24 21:15:01 jupiter CRON[25183]: (root) CMD (command -v debian-sa1 &gt;
/dev/null &amp;&amp; debian-sa1 1 1)
Apr 24 21:17:01 jupiter CRON[25189]: (root) CMD (   cd / &amp;&amp; run-parts
--report /etc/cron.hourly)
Apr 24 21:17:58 jupiter libvirtd: 21:17:58.089: warning :
qemudDispatchSignalEvent:385 : Shutting down on signal 15
Apr 24 21:17:58 jupiter libvirtd: 21:17:58.617: error :
udevStrToLong_ui:73 : Failed to convert '008' to unsigned int#012
Apr 24 21:17:59 jupiter kernel: [106086.771154] lo: Disabled Privacy
Extensions

Than for your help.

Mirek

</body></email><email><emailId>20110424050728</emailId><senderName>Dale Amon</senderName><senderEmail>amon@vnl.com</senderEmail><timestampReceived>2011-04-24 05:07:28-0400</timestampReceived><subject>[libvirt-users] Adding more disks...</subject><body>

I need a VM with about 6-8 qcow2 disk images, but it
seems to only allow 4 disks on the ide, like the real
hardware. What lines do you need to add on to the xml
definition file to get hde, hdf, hdg, etc?


</body></email><email><emailId>20110425205928</emailId><senderName>Zvi Dubitzky</senderName><senderEmail>dubi@il.ibm.com</senderEmail><timestampReceived>2011-04-25 20:59:28-0400</timestampReceived><subject>[libvirt-users] virt-image issue</subject><body>

Hi

Does anybody work with the virt-image utility.
- I do not see where/how  one specifies the pre-defned image  or the CD 
iso image to produce the image from
- what is the .xml file requested for ? I guess  it is  the output xml 
file

I just used the command with an existing .xml file (thought the utility 
will modify it according to the specified flags)
but got the error message :
"ERROR    Cannot parse 'vmTest3.xml': Root element is not 'image"

Any idea what is missing  ?

thanks

Zvi Dubitzky 
Email:dubi@il.ibm.com

</body></email><email><emailId>20110426204523</emailId><senderName>David Brown</senderName><senderEmail>dcbrown73@yahoo.com</senderEmail><timestampReceived>2011-04-26 20:45:23-0400</timestampReceived><subject>[libvirt-users] virt-clone: clone not bootable</subject><body>

Hi,
Not sure if this is the right mailing list, but...
I have a Linux VM (CentOS 5.4) VM. =A0I cloned it with virt-clone, but the =
clone isn't bootable. =A0When I attempt to boot it says: =A0
Booting from hard diskBoot failed: not a bootable diskFATAL: No bootable de=
vice
The clone was made with the following command: virt-clone -o centos -n cent=
osclone -f /path/to/new/image.img
I've attempted it several times and get the same result.
Has anyone seen this or know how to resolve it?
Thanks,Dave
[Attachment #3 (text/html)]

&lt;table cellspacing="0" cellpadding="0" border="0" &gt;&lt;tr&gt;&lt;td valign="top" style="font: \
inherit;"&gt;Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Not sure if this is the right mailing list, \
but...&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I have a Linux VM (CentOS 5.4) VM.  I cloned it \
with virt-clone, but the clone isn't bootable.  When I attempt to boot it says: \
 &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Booting from hard disk&lt;/div&gt;&lt;div&gt;Boot failed: not a \
bootable disk&lt;/div&gt;&lt;div&gt;FATAL: No bootable device&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The clone \
was made with the following command: virt-clone -o centos -n centosclone -f \
/path/to/new/image.img&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I've attempted it several times and \
get the same result.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Has anyone seen this or know how to \
resolve it?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;Dave&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;



</body></email><email><emailId>20110426212455</emailId><senderName>Whit Blauvelt</senderName><senderEmail>whit.virt@transpect.com</senderEmail><timestampReceived>2011-04-26 21:24:55-0400</timestampReceived><subject>Re: [libvirt-users] virt-clone: clone not bootable</subject><body>

On Tue, Apr 26, 2011 at 01:45:23PM -0700, David Brown wrote:
&gt;    The clone was made with the following command: virt-clone -o centos -n     
&gt;    centosclone -f /path/to/new/image.img                                      
&gt;    I've attempted it several times and get the same result.                   
&gt;    Has anyone seen this or know how to resolve it?                            

I've often cloned CentOS 5.5 KVM VMs with that same invocation, and no
problem.

When you say it's "not bootable," what exactly do you see at time of
failure?

Whit

</body></email><email><emailId>20110426221951</emailId><senderName>David Brown</senderName><senderEmail>dcbrown73@yahoo.com</senderEmail><timestampReceived>2011-04-26 22:19:51-0400</timestampReceived><subject>Re: [libvirt-users] virt-clone: clone not bootable</subject><body>

It says: 
booting from hard disk
Booting failed device not bootable
FATAL: failed to boot from device.

Or something very similar. 

Whit Blauvelt &lt;whit.virt@transpect.com&gt; wrote:

&gt;On Tue, Apr 26, 2011 at 01:45:23PM -0700, David Brown wrote:
&gt;&gt;    The clone was made with the following command: virt-clone -o centos -n     
&gt;&gt;    centosclone -f /path/to/new/image.img                                      
&gt;&gt;    I've attempted it several times and get the same result.                   
&gt;&gt;    Has anyone seen this or know how to resolve it?                            
&gt;
&gt;I've often cloned CentOS 5.5 KVM VMs with that same invocation, and no
&gt;problem.
&gt;
&gt;When you say it's "not bootable," what exactly do you see at time of
&gt;failure?
&gt;
&gt;Whit

</body></email><email><emailId>20110427003548</emailId><senderName>Whit Blauvelt</senderName><senderEmail>whit.virt@transpect.com</senderEmail><timestampReceived>2011-04-27 00:35:48-0400</timestampReceived><subject>Re: [libvirt-users] virt-clone: clone not bootable</subject><body>

David,

How exactly are you invoking it? And when you say "it says," which "it"?
There's more than one way to start a VM. Which are you using?

All we have to go by is your command to virt-clone - which was correct and
works for a great many people - and your observation that your cloned VM
wouldn't boot. Since the problem's most likely not in virt-clone, we'll need
more details on the rest of your procedure to have any chance of spotting
where the problem is.

Whit

On Tue, Apr 26, 2011 at 06:19:51PM -0400, David Brown wrote:
&gt; It says: 
&gt; booting from hard disk
&gt; Booting failed device not bootable
&gt; FATAL: failed to boot from device.
&gt; 
&gt; Or something very similar. 
&gt; 
&gt; Whit Blauvelt &lt;whit.virt@transpect.com&gt; wrote:
&gt; 
&gt; &gt;On Tue, Apr 26, 2011 at 01:45:23PM -0700, David Brown wrote:
&gt; &gt;&gt;    The clone was made with the following command: virt-clone -o centos -n     
&gt; &gt;&gt;    centosclone -f /path/to/new/image.img                                      
&gt; &gt;&gt;    I've attempted it several times and get the same result.                   
&gt; &gt;&gt;    Has anyone seen this or know how to resolve it?                            
&gt; &gt;
&gt; &gt;I've often cloned CentOS 5.5 KVM VMs with that same invocation, and no
&gt; &gt;problem.
&gt; &gt;
&gt; &gt;When you say it's "not bootable," what exactly do you see at time of
&gt; &gt;failure?
&gt; &gt;
&gt; &gt;Whit

</body></email><email><emailId>20110425071338</emailId><senderName>Dale Amon</senderName><senderEmail>amon@vnl.com</senderEmail><timestampReceived>2011-04-25 07:13:38-0400</timestampReceived><subject>Re: [libvirt-users] Adding more disks...</subject><body>

I did not find documentation but I managed by 
guessing:

&lt;target dev='sde' bus='scsi' /&gt;

did the trick. Is this stuff fully documented
anywhere?

</body></email><email><emailId>20110421061308</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-04-21 06:13:08-0400</timestampReceived><subject>Re: [libvirt-users] domain not present after shutdown</subject><body>

于 2011年04月21日 08:36, David White 写道:
&gt;
&gt; I hope this is simple
&gt;
&gt; I have one kvm host that lists all my domains even after shut down. 'virsh list
&gt; --all' shows machines in 'running' and 'shut off' states.  If I copy those over
&gt; to another machine and it only shows the virt machines in running state.

What do you mean "copy" here?

&gt;
&gt; vmhost2:~$ virsh list --all
&gt;   Id Name                 State
&gt; ----------------------------------
&gt;    4 mybox4               running
&gt;
&gt; vmhost2:~$ virsh version
&gt; Compiled against library: libvir 0.8.3
&gt; Using library: libvir 0.8.3
&gt; Using API: QEMU 0.8.3
&gt; Running hypervisor: QEMU 0.12.5
&gt;
&gt;
&gt;
&gt; vmhost1:~$ virsh list --all
&gt;   Id Name                 State
&gt; ----------------------------------
&gt;    - mybox3               shut off
&gt;    2 mybox4               running
&gt;
&gt; vmhost1:~$ virsh version
&gt; Compiled against library: libvir 0.7.5
&gt; Using library: libvir 0.7.5
&gt; Using API: QEMU 0.7.5
&gt; Running hypervisor: QEMU 0.12.3
&gt;
&gt; question -- why doesn't mybox3 show up on vmhost2?  where should I start looking?
&gt;
&gt; hope this isn't too open ended...
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110421124725</emailId><senderName>dave white</senderName><senderEmail>dave@fishherder.dyndns.org</senderEmail><timestampReceived>2011-04-21 12:47:25-0400</timestampReceived><subject>Re: [libvirt-users] domain not present after shutdown</subject><body>


&gt; What do you mean "copy" here?
&gt;
I mean file copy, using scp. I've copied the qcow2 image and the xml 
config file.
virt-manager gives me the same result.  If I log in to the guest and 
shut it down, it disappears from the UI.

-dmw

</body></email><email><emailId>20110421132005</emailId><senderName>dave white</senderName><senderEmail>dave@fishherder.dyndns.org</senderEmail><timestampReceived>2011-04-21 13:20:05-0400</timestampReceived><subject>Re: [libvirt-users] domain not present after shutdown</subject><body>

nm, got it.  Forgot a step

virsh define /etc/libvirt/qemu/myguest.xml

On 04/21/2011 05:47 AM, dave white wrote:
&gt;
&gt;&gt; What do you mean "copy" here?
&gt;&gt;
&gt; I mean file copy, using scp. I've copied the qcow2 image and the xml 
&gt; config file.
&gt; virt-manager gives me the same result.  If I log in to the guest and 
&gt; shut it down, it disappears from the UI.
&gt;
&gt; -dmw
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110422011001</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-04-22 01:10:01-0400</timestampReceived><subject>Re: [libvirt-users] domain not present after shutdown</subject><body>

于 2011年04月21日 21:20, dave white 写道:
&gt; nm, got it. Forgot a step
&gt;
&gt; virsh define /etc/libvirt/qemu/myguest.xml
&gt;

Yeah, that was my guessing, the shutoff domain on your
source host is trasicient.

Cheers
Osier
&gt; On 04/21/2011 05:47 AM, dave white wrote:
&gt;&gt;
&gt;&gt;&gt; What do you mean "copy" here?
&gt;&gt;&gt;
&gt;&gt; I mean file copy, using scp. I've copied the qcow2 image and the xml
&gt;&gt; config file.
&gt;&gt; virt-manager gives me the same result. If I log in to the guest and
&gt;&gt; shut it down, it disappears from the UI.
&gt;&gt;
&gt;&gt; -dmw
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; libvirt-users mailing list
&gt;&gt; libvirt-users@redhat.com
&gt;&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

</body></email><email><emailId>20110422011108</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-04-22 01:11:08-0400</timestampReceived><subject>Re: [libvirt-users] domain not present after shutdown</subject><body>

于 2011年04月21日 21:20, dave white 写道:
&gt; nm, got it. Forgot a step
&gt;
&gt; virsh define /etc/libvirt/qemu/myguest.xml
&gt;

Yeah, that was my guessing, shutoff domains on your
source host are transicient, they don't have domain
xml store on disk in /etc/libvirt/qemu/

Cheers
Osier
&gt; On 04/21/2011 05:47 AM, dave white wrote:
&gt;&gt;
&gt;&gt;&gt; What do you mean "copy" here?
&gt;&gt;&gt;
&gt;&gt; I mean file copy, using scp. I've copied the qcow2 image and the xml
&gt;&gt; config file.
&gt;&gt; virt-manager gives me the same result. If I log in to the guest and
&gt;&gt; shut it down, it disappears from the UI.
&gt;&gt;
&gt;&gt; -dmw
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; libvirt-users mailing list
&gt;&gt; libvirt-users@redhat.com
&gt;&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

</body></email><email><emailId>20110421215138</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-04-21 21:51:38-0400</timestampReceived><subject>Re: [libvirt-users] [PATCHv11 3/6] libvirt/qemu - clean up UpdateDevice for consolidation.</subject><body>


On 04/21/2011 01:25 AM, KAMEZAWA Hiroyuki wrote:
&gt; This patch strips reusable part of qemudDomainUpdateDeviceFlags()
&gt; and consolidate it to qemudDomainModifyDeviceFlags().
&gt; No functional changes.
&gt; 
&gt; Signed-off-by: KAMEZAWA Hiroyuki &lt;kamezawa.hiroyu@jp.fujitsu.com&gt;
&gt; 
&gt; Changelog: v10-&gt;v11
&gt;   - fixed qemuTeardownDiskCgroup()
&gt; 
&gt;  
&gt; -    virCheckFlags(VIR_DOMAIN_DEVICE_MODIFY_LIVE |
&gt; -                  VIR_DOMAIN_DEVICE_MODIFY_CONFIG, -1);
&gt; +    switch (action) {
&gt; +    case QEMUD_DEVICE_ATTACH:
&gt; +    case QEMUD_DEVICE_DETACH:
&gt; +        virCheckFlags(VIR_DOMAIN_DEVICE_MODIFY_LIVE |
&gt; +                      VIR_DOMAIN_DEVICE_MODIFY_CONFIG, -1);
&gt; +        break;
&gt; +    case QEMUD_DEVICE_UPDATE:
&gt; +        virCheckFlags(VIR_DOMAIN_DEVICE_MODIFY_CURRENT |
&gt; +                      VIR_DOMAIN_DEVICE_MODIFY_LIVE |
&gt; +                      VIR_DOMAIN_DEVICE_MODIFY_CONFIG |
&gt; +                      VIR_DOMAIN_DEVICE_MODIFY_FORCE, -1);
&gt; +        break;
&gt; +    default:
&gt; +        break;

This lets an invalid action through without warning.  And _CURRENT is 0,
so it's redundant.  I shrunk it a bit.

More qemud/qemu renaming.

ACK, and pushed with this squashed in:

diff --git i/src/qemu/qemu_driver.c w/src/qemu/qemu_driver.c
index b0ca3ce..771678e 100644
--- i/src/qemu/qemu_driver.c
+++ w/src/qemu/qemu_driver.c
@@ -3999,11 +3999,11 @@ qemuDomainDetachDeviceLive(virDomainObjPtr vm,
 }

 static int
-qemudDomainChangeDiskMediaLive(virDomainObjPtr vm,
-                               virDomainDeviceDefPtr dev,
-                               struct qemud_driver *driver,
-                               virBitmapPtr qemuCaps,
-                               bool force)
+qemuDomainChangeDiskMediaLive(virDomainObjPtr vm,
+                              virDomainDeviceDefPtr dev,
+                              struct qemud_driver *driver,
+                              virBitmapPtr qemuCaps,
+                              bool force)
 {
     virDomainDiskDefPtr disk = dev-&gt;data.disk;
     virCgroupPtr cgroup = NULL;
@@ -4046,18 +4046,19 @@ end:
     return ret;
 }

-static int qemudDomainUpdateDeviceLive(virDomainObjPtr vm,
-                                       virDomainDeviceDefPtr dev,
-                                       virDomainPtr dom,
-                                       virBitmapPtr qemuCaps,
-                                       bool force)
+static int
+qemuDomainUpdateDeviceLive(virDomainObjPtr vm,
+                           virDomainDeviceDefPtr dev,
+                           virDomainPtr dom,
+                           virBitmapPtr qemuCaps,
+                           bool force)
 {
     struct qemud_driver *driver = dom-&gt;conn-&gt;privateData;
     int ret = -1;

     switch (dev-&gt;type) {
     case VIR_DOMAIN_DEVICE_DISK:
-        ret = qemudDomainChangeDiskMediaLive(vm, dev, driver, qemuCaps,
force);
+        ret = qemuDomainChangeDiskMediaLive(vm, dev, driver, qemuCaps,
force);
         break;
     case VIR_DOMAIN_DEVICE_GRAPHICS:
         ret = qemuDomainChangeGraphics(driver, vm, dev-&gt;data.graphics);
@@ -4091,21 +4092,10 @@ qemuDomainModifyDeviceFlags(virDomainPtr dom,
const char *xml,
     bool force = (flags &amp; VIR_DOMAIN_DEVICE_MODIFY_FORCE) != 0;
     int ret = -1;

-    switch (action) {
-    case QEMU_DEVICE_ATTACH:
-    case QEMU_DEVICE_DETACH:
-        virCheckFlags(VIR_DOMAIN_DEVICE_MODIFY_LIVE |
-                      VIR_DOMAIN_DEVICE_MODIFY_CONFIG, -1);
-        break;
-    case QEMU_DEVICE_UPDATE:
-        virCheckFlags(VIR_DOMAIN_DEVICE_MODIFY_CURRENT |
-                      VIR_DOMAIN_DEVICE_MODIFY_LIVE |
-                      VIR_DOMAIN_DEVICE_MODIFY_CONFIG |
-                      VIR_DOMAIN_DEVICE_MODIFY_FORCE, -1);
-        break;
-    default:
-        break;
-    }
+    virCheckFlags(VIR_DOMAIN_DEVICE_MODIFY_LIVE |
+                  VIR_DOMAIN_DEVICE_MODIFY_CONFIG |
+                  (action == QEMU_DEVICE_UPDATE ?
+                   VIR_DOMAIN_DEVICE_MODIFY_FORCE : 0), -1);

     if (flags &amp; VIR_DOMAIN_DEVICE_MODIFY_CONFIG) {
         qemuReportError(VIR_ERR_OPERATION_INVALID,
@@ -4150,9 +4140,11 @@ qemuDomainModifyDeviceFlags(virDomainPtr dom,
const char *xml,
         ret = qemuDomainDetachDeviceLive(vm, dev, dom, qemuCaps);
         break;
     case QEMU_DEVICE_UPDATE:
-        ret = qemudDomainUpdateDeviceLive(vm, dev, dom, qemuCaps, force);
+        ret = qemuDomainUpdateDeviceLive(vm, dev, dom, qemuCaps, force);
         break;
     default:
+        qemuReportError(VIR_ERR_INTERNAL_ERROR,
+                        _("unknown domain modify action %d"), action);
         break;
     }



-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20110421184727</emailId><senderName>David White</senderName><senderEmail>dwhite@speakeasy.net</senderEmail><timestampReceived>2011-04-21 18:47:27-0400</timestampReceived><subject>Re: [libvirt-users] No IOMMU found.  Unable to assign device</subject><body>

That's correct.  You need a mainboard that supports Intel VT-d or 
AMD-Vi.  Start here 
(http://www.intel.com/support/motherboards/desktop/sb/CS-030922.htm ) 
for Intel.   Not sure where to find a list of AMD boards.   Without 
IOMMU you need to rely on emulation.

-dmw

On 04/21/2011 09:57 AM, Marco van Beek wrote:
&gt; Hi,
&gt;
&gt; I am playing around with PCI passthrough and came across some posts 
&gt; that said you could not do PCI passthrough unless you had IOMMU 
&gt; hardware. which it would appear I don't
&gt;
&gt; Is this the case? Am I flogging a dead horse?
&gt;
&gt; Thanks,
&gt;
&gt; Marco
&gt;

</body></email><email><emailId>20110418223448</emailId><senderName>Igor Serebryany</senderName><senderEmail>igor47@moomers.org</senderEmail><timestampReceived>2011-04-18 22:34:48-0400</timestampReceived><subject>Re: [libvirt-users] Accessing a MAC address from inside the VM?</subject><body>


On Sat, Apr 16, 2011 at 04:21:19PM -0400, David Lane wrote:
&gt; I attach an existing .img file to the host machine and need to change the
&gt; MAC address (since the image was created on another machine).  Is there a
&gt; way from with in the guest to do this or do I have muck with the XML?  And
&gt; if I muck with the XML and change it, how do I pass this information up to
&gt; the guest, or will the guest see it automagically or do I have to write it
&gt; down and then manually transfer it into the guest's ifcfg?

The only way to change what MAC address the interface shows up with is
to tell libvirt about the MAC you want, usually via the XML. There might
be a way to change it after a domain is defined, but I'm not sure.

&gt; Using the GUI, when you change the NIC, the guest generally does not
&gt; see the new MAC and grouses until you change it.

What do you mean by grouses? If you change the MAC in the XML, when your
domain boots it will see an interface with that MAC.

Do you mean that your interfaces don't come up with proper configs? Then
your problem might be udev's persistent net rules. You have config files
which assign IPs to eth0, for instance, but when you change the MAC
address in the XML, eth0 disappears and you instead get an eth1 which
comes up configured.

I solve this problem by removing any persistent network name rules from
udev. You can usually find a config file that controls such things in
/etc/udev/rules.d

--Igor

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20110418141219</emailId><senderName>Daniel Berteaud</senderName><senderEmail>dani@firewall-services.com</senderEmail><timestampReceived>2011-04-18 14:12:19-0400</timestampReceived><subject>Re: [libvirt-users] add file.img in libvirt</subject><body>

Le lundi 18 avril 2011 Ã  15:54 +0200, Marco Mirabile a Ã©crit :
&gt; Good day

Hi

&gt; I downloaded an image of a VMs "centOS.img"
&gt; how can I open this image from libvirt?

You need to copy it in a storage pool, for example, the default storage
pool is /var/lib/libvirt/images. Just copy your image in this directory,
and reload the pool with:

virsh pool-refresh default


Regards, Daniel

&gt; I ask you with virt-install, but I could not
&gt; help me
&gt; dominioYP
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

-- 
Daniel Berteaud
FIREWALL-SERVICES SARL.
SociÃ©tÃ© de Services en Logiciels Libres
TechnopÃ´le Montesquieu
33650 MARTILLAC
Tel : 05 56 64 15 32
Fax : 05 56 64 15 32
Mail: daniel@firewall-services.com
Web : http://www.firewall-services.com

</body></email><email><emailId>20110418162952</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2011-04-18 16:29:52-0400</timestampReceived><subject>Re: [libvirt-users] Default network / net-edit</subject><body>

On 04/18/2011 10:49 AM, ssaleh@nrln.us wrote:
&gt; How do you modify the default network parameters?  The net-edit command within \
&gt; virsh does not seem to work as expected.

Changes made to the configuration of a network do not take effect until 
the network has been net-destroyed, then net-started again.


</body></email><email><emailId>20110418185813</emailId><senderName>Marco van Beek</senderName><senderEmail>mvanbeek@forgetaboutit.net</senderEmail><timestampReceived>2011-04-18 18:58:13-0400</timestampReceived><subject>[libvirt-users] USB2 passthrough</subject><body>

Hi,

I am trying to get a USB device working on a Windows 7 virtual machine, 
and it needs USB2 to work, so the USB passthrough does not work. I have 
searched for an answer and either the answer is so obvious I am being 
thick, or too complicated for anyone to address it.

Can I simply do a PCI passthrough of a USB host controller? Would that 
then give me a whole load of USB2 ports I could connect to my computer? 
I would have to find out which port was connected to which controller, 
but surely it can't be that simple?

Thanks,

Marco

-- 
Marco van Beek
===================================================
Forget About IT Ltd.
Grove Park Studios,
188-192 Sutton Court Rd,
London, W4 3HR
===================================================
T: 0870 757 2924
F: 0870 757 2926
M: 0788 770 3604
E: mvanbeek@forgetaboutit.net
W: http://www.forgetaboutit.net/
===================================================
Forget About IT and FABIT are registered trademarks
===================================================
Company Registered in England No. 05375739
===================================================


</body></email><email><emailId>20110419125526</emailId><senderName>David Lane</senderName><senderEmail>kg4giy@gmail.com</senderEmail><timestampReceived>2011-04-19 12:55:26-0400</timestampReceived><subject>Re: [libvirt-users] Accessing a MAC address from inside the VM?</subject><body>

Igor,

Again, thanks for the tip.  Not a udev issue (no udev/or config file on the
guest) so it is back to manipulating the MAC by hand.

DAVID

On Mon, Apr 18, 2011 at 6:34 PM, Igor Serebryany &lt;igor47@moomers.org&gt; wrote:

&gt; On Sat, Apr 16, 2011 at 04:21:19PM -0400, David Lane wrote:
&gt; &gt; I attach an existing .img file to the host machine and need to change the
&gt; &gt; MAC address (since the image was created on another machine).  Is there a
&gt; &gt; way from with in the guest to do this or do I have muck with the XML?
&gt;  And
&gt; &gt; if I muck with the XML and change it, how do I pass this information up
&gt; to
&gt; &gt; the guest, or will the guest see it automagically or do I have to write
&gt; it
&gt; &gt; down and then manually transfer it into the guest's ifcfg?
&gt;
&gt; The only way to change what MAC address the interface shows up with is
&gt; to tell libvirt about the MAC you want, usually via the XML. There might
&gt; be a way to change it after a domain is defined, but I'm not sure.
&gt;
&gt; &gt; Using the GUI, when you change the NIC, the guest generally does not
&gt; &gt; see the new MAC and grouses until you change it.
&gt;
&gt; What do you mean by grouses? If you change the MAC in the XML, when your
&gt; domain boots it will see an interface with that MAC.
&gt;
&gt; Do you mean that your interfaces don't come up with proper configs? Then
&gt; your problem might be udev's persistent net rules. You have config files
&gt; which assign IPs to eth0, for instance, but when you change the MAC
&gt; address in the XML, eth0 disappears and you instead get an eth1 which
&gt; comes up configured.
&gt;
&gt; I solve this problem by removing any persistent network name rules from
&gt; udev. You can usually find a config file that controls such things in
&gt; /etc/udev/rules.d
&gt;
&gt; --Igor
&gt;
&gt; -----BEGIN PGP SIGNATURE-----
&gt; Version: GnuPG v1.4.10 (GNU/Linux)
&gt;
&gt; iEYEARECAAYFAk2svIgACgkQVyVcp2k8D/lgjwCgpb1scQCh5ACHebdMpZb2OZvU
&gt; dX4AnjpAOha8ELRgU+ObS+eGoAKzrHPO
&gt; =3WfH
&gt; -----END PGP SIGNATURE-----
&gt;
&gt;

[Attachment #3 (text/html)]

Igor,&lt;br&gt;&lt;br&gt;Again, thanks for the tip.  Not a udev issue (no udev/or config file on \
the guest) so it is back to manipulating the MAC by hand.&lt;br&gt;&lt;br&gt;DAVID&lt;br&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;On Mon, Apr 18, 2011 at 6:34 PM, Igor Serebryany &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:igor47@moomers.org"&gt;igor47@moomers.org&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt; &lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; \
border-left: 1px solid rgb(204, 204, 204); padding-left: 1ex;"&gt;&lt;div class="im"&gt;On \
Sat, Apr 16, 2011 at 04:21:19PM -0400, David Lane wrote:&lt;br&gt; &gt; I attach an \
existing .img file to the host machine and need to change the&lt;br&gt; &gt; MAC address \
(since the image was created on another machine).  Is there a&lt;br&gt; &gt; way from with \
in the guest to do this or do I have muck with the XML?  And&lt;br&gt; &gt; if I muck with \
the XML and change it, how do I pass this information up to&lt;br&gt; &gt; the guest, or \
will the guest see it automagically or do I have to write it&lt;br&gt; &gt; down and then \
manually transfer it into the guest's ifcfg?&lt;br&gt; &lt;br&gt;
&lt;/div&gt;The only way to change what MAC address the interface shows up with is&lt;br&gt;
to tell libvirt about the MAC you want, usually via the XML. There might&lt;br&gt;
be a way to change it after a domain is defined, but I'm not sure.&lt;br&gt;
&lt;div class="im"&gt;&lt;br&gt;
&gt; Using the GUI, when you change the NIC, the guest generally does not&lt;br&gt;
&gt; see the new MAC and grouses until you change it.&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;What do you mean by grouses? If you change the MAC in the XML, when your&lt;br&gt;
domain boots it will see an interface with that MAC.&lt;br&gt;
&lt;br&gt;
Do you mean that your interfaces don't come up with proper configs? Then&lt;br&gt;
your problem might be udev's persistent net rules. You have config files&lt;br&gt;
which assign IPs to eth0, for instance, but when you change the MAC&lt;br&gt;
address in the XML, eth0 disappears and you instead get an eth1 which&lt;br&gt;
comes up configured.&lt;br&gt;
&lt;br&gt;
I solve this problem by removing any persistent network name rules from&lt;br&gt;
udev. You can usually find a config file that controls such things in&lt;br&gt;
/etc/udev/rules.d&lt;br&gt;
&lt;font color="#888888"&gt;&lt;br&gt;
--Igor&lt;br&gt;
&lt;/font&gt;&lt;br&gt;-----BEGIN PGP SIGNATURE-----&lt;br&gt;
Version: GnuPG v1.4.10 (GNU/Linux)&lt;br&gt;
&lt;br&gt;
iEYEARECAAYFAk2svIgACgkQVyVcp2k8D/lgjwCgpb1scQCh5ACHebdMpZb2OZvU&lt;br&gt;
dX4AnjpAOha8ELRgU+ObS+eGoAKzrHPO&lt;br&gt;
=3WfH&lt;br&gt;
-----END PGP SIGNATURE-----&lt;br&gt;
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;



</body></email><email><emailId>20110419183256</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2011-04-19 18:32:56-0400</timestampReceived><subject>Re: [libvirt-users] Undefined interfaces?</subject><body>

On 04/18/2011 01:12 PM, Alex wrote:
&gt; Hi,
&gt; I have a working fc14 install with a few virtual interfaces set up,
&gt; and just noticed the following in messages:
&gt;
&gt; Apr 18 13:07:43 fc14 libvirtd: 13:07:43.155: error :
&gt; interfaceGetXMLDesc:355 : internal error could not get interface XML
&gt; description (netcf: NETLINK socket operation failed - couldn't find
&gt; ifindex for interface `br0:0`)
&gt; Apr 18 13:07:43 fc14 libvirtd: 13:07:43.165: error :
&gt; interfaceGetXMLDesc:355 : internal error could not get interface XML
&gt; description (netcf: NETLINK socket operation failed - couldn't find
&gt; ifindex for interface `eth0:0`)
&gt; Apr 18 13:07:43 fc14 libvirtd: 13:07:43.175: error :
&gt; interfaceGetXMLDesc:355 : internal error could not get interface XML
&gt; description (netcf: NETLINK socket operation failed - couldn't find
&gt; ifindex for interface `eth1:0`)
&gt; Apr 18 13:07:43 fc14 libvirtd: 13:07:43.185: error :
&gt; interfaceGetXMLDesc:355 : internal error could not get interface XML
&gt; description (netcf: NETLINK socket operation failed - couldn't find
&gt; ifindex for interface `eth1:1`)
&gt;
&gt; I see several references that indicate this may be a bug. Or have I
&gt; configured something wrong?

I'm assuming that you're running virt-manager, otherwise 
interfaceGetXMLDesc wouldn't be getting called so much. There could be 
some strange interaction between netlink and interfaces with ":" in the 
name. I'm just packing up to leave on a 5 day trip, though, and don't 
have time to investigate right now, but there are some things you can 
look at:

1) try running "virsh iface-list --all", then "virsh iface-dumpxml 
--inactive &lt;name&gt;" where &lt;name&gt; is the name of each interface displayed 
in the iface-list command. See which are successful.

2) also try "virsh iface-dumpxml &lt;name&gt;" (ie withough the --inactive) 
for each.

3) send the results of the above, as well as the output of "ifconfig -a"

4) also the output of "ls /etc/sysconfig/network-scripts/ifcfg-* | while 
read f; do echo =====; echo $f; cat $f; done"

Something from that could help in reproducing the problem.

&gt; I have some interfaces configured to be a bridge and others are
&gt; configured as a regular network, with the guests being masqueraded.
&gt; It's certainly possible I've configured something incorrectly.
&gt;
&gt; I'm not sure what information to provide to help troubleshoot this.
&gt; Any information would be greatly appreciated.
&gt;
&gt; Thanks,
&gt; Alex
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

</body></email><email><emailId>20110421072230</emailId><senderName>KAMEZAWA Hiroyuki</senderName><senderEmail>kamezawa.hiroyu@jp.fujitsu.com</senderEmail><timestampReceived>2011-04-21 07:22:30-0400</timestampReceived><subject>[libvirt-users] [PATCHv11 1/6] libvirt/qemu - Centralize device modification in the more flexible AP</subject><body>


Centralize device modification in the more flexible APIs, to allow future
honoring of additional flags.  Explicitly reject the 
VIR_DOMAIN_DEVICE_MODIFY_FORCE flag on attach/detach.

Based on Eric Blake&lt;eblake@redhat.com&gt;'s work.

From: Eric Blake &lt;eblake@redhat.com&gt;
Signed-off-by: KAMEZAWA Hiroyuki &lt;kamezawa.hiroyu@jp.fujitsu.com&gt;

* src/qemu/qemu_driver.c
(qemudDomainAttachDevice)(qemudDomainAttachDeviceFlags): Swap bodies,rename...
(qemudDomainDetachDevice, qemudDomainDetachDeviceFlags): Likewise.
---
 src/qemu/qemu_driver.c |   53 ++++++++++++++++++++++++++---------------------
 1 files changed, 29 insertions(+), 24 deletions(-)

diff --git a/src/qemu/qemu_driver.c b/src/qemu/qemu_driver.c
index f6e503a..a8f3849 100644
--- a/src/qemu/qemu_driver.c
+++ b/src/qemu/qemu_driver.c
@@ -3786,8 +3786,8 @@ cleanup:
 }
 
 
-static int qemudDomainAttachDevice(virDomainPtr dom,
-                                   const char *xml)
+static int qemudDomainAttachDeviceFlags(virDomainPtr dom, const char *xml,
+                                        unsigned int flags)
 {
     struct qemud_driver *driver = dom-&gt;conn-&gt;privateData;
     virDomainObjPtr vm;
@@ -3796,6 +3796,14 @@ static int qemudDomainAttachDevice(virDomainPtr dom,
     virCgroupPtr cgroup = NULL;
     int ret = -1;
 
+    virCheckFlags(VIR_DOMAIN_DEVICE_MODIFY_LIVE |
+                  VIR_DOMAIN_DEVICE_MODIFY_CONFIG, -1);
+    if (flags &amp; VIR_DOMAIN_DEVICE_MODIFY_CONFIG) {
+        qemuReportError(VIR_ERR_OPERATION_INVALID,
+                        "%s", _("cannot modify the persistent configuration of a domain"));
+        return -1;
+    }
+
     qemuDriverLock(driver);
     vm = virDomainFindByUUID(&amp;driver-&gt;domains, dom-&gt;uuid);
     if (!vm) {
@@ -3943,16 +3951,10 @@ cleanup:
     return ret;
 }
 
-static int qemudDomainAttachDeviceFlags(virDomainPtr dom,
-                                        const char *xml,
-                                        unsigned int flags) {
-    if (flags &amp; VIR_DOMAIN_DEVICE_MODIFY_CONFIG) {
-        qemuReportError(VIR_ERR_OPERATION_INVALID,
-                        "%s", _("cannot modify the persistent configuration of a domain"));
-        return -1;
-    }
-
-    return qemudDomainAttachDevice(dom, xml);
+static int qemudDomainAttachDevice(virDomainPtr dom, const char *xml)
+{
+    return qemudDomainAttachDeviceFlags(dom, xml,
+                                        VIR_DOMAIN_DEVICE_MODIFY_LIVE);
 }
 
 
@@ -4078,14 +4080,23 @@ cleanup:
 }
 
 
-static int qemudDomainDetachDevice(virDomainPtr dom,
-                                   const char *xml) {
+static int qemudDomainDetachDeviceFlags(virDomainPtr dom, const char *xml,
+                                        unsigned int flags)
+{
     struct qemud_driver *driver = dom-&gt;conn-&gt;privateData;
     virDomainObjPtr vm;
     virBitmapPtr qemuCaps = NULL;
     virDomainDeviceDefPtr dev = NULL;
     int ret = -1;
 
+    virCheckFlags(VIR_DOMAIN_DEVICE_MODIFY_LIVE|
+                  VIR_DOMAIN_DEVICE_MODIFY_CONFIG, -1);
+
+    if (flags &amp; VIR_DOMAIN_DEVICE_MODIFY_CONFIG) {
+        qemuReportError(VIR_ERR_OPERATION_INVALID,
+                        "%s", _("cannot modify the persistent configuration of a domain:"));
+        return -1;
+    }
     qemuDriverLock(driver);
     vm = virDomainFindByUUID(&amp;driver-&gt;domains, dom-&gt;uuid);
     if (!vm) {
@@ -4164,16 +4175,10 @@ cleanup:
     return ret;
 }
 
-static int qemudDomainDetachDeviceFlags(virDomainPtr dom,
-                                        const char *xml,
-                                        unsigned int flags) {
-    if (flags &amp; VIR_DOMAIN_DEVICE_MODIFY_CONFIG) {
-        qemuReportError(VIR_ERR_OPERATION_INVALID,
-                        "%s", _("cannot modify the persistent configuration of a domain"));
-        return -1;
-    }
-
-    return qemudDomainDetachDevice(dom, xml);
+static int qemudDomainDetachDevice(virDomainPtr dom, const char *xml)
+{
+    return qemudDomainDetachDeviceFlags(dom, xml,
+                                        VIR_DOMAIN_DEVICE_MODIFY_LIVE);
 }
 
 static int qemudDomainGetAutostart(virDomainPtr dom,
-- 
1.7.4.1


</body></email><email><emailId>20110421072348</emailId><senderName>KAMEZAWA Hiroyuki</senderName><senderEmail>kamezawa.hiroyu@jp.fujitsu.com</senderEmail><timestampReceived>2011-04-21 07:23:48-0400</timestampReceived><subject>[libvirt-users] [PATCHv11 2/6] libvirt/qemu - clean up At(De)tachDeviceFlags() for consolidation.</subject><body>

clean up At(De)tachDeviceFlags() for consolidation.

qemudDomainAttachDeviceFlags()/qemudDomainDetachFlags()/
qemudDomainUpdateDeviceFlags() has similar logics and copied codes.

This patch series tries to unify them to use shared code when it can.
At first, clean up At(De)tachDeviceFlags() and devide it into functions.

By this, this patch pulls out shared components between functions.
Based on patch series by Eric Blake, I added some modification as
switch-case with QEMUD_DEVICE_ATTACH, QEMUD_DEVICE_DETACH, QEMUD_DEVICE_UPDATE

From: Eric Blake &lt;eblake@redhat.com&gt;
Signed-off-by: KAMEZAWA Hiroyuki &lt;kamezawa.hiroyu@jp.fujitsu.com&gt;

* src/qemu/qemu_driver.c
(qemudDomainAt(De)tachDeviceFlags) : pulled out to qemudDomainModifyDeviceFlags()
(qemudDomainModifyDeviceFlags) : impelements a generic codes for modify domain.
(qemudDomainAt(De)tachDeviceFlagsLive) : codes for at(de)taching devices to domain in \
line. no changes in logic from old codes. (qemudDomainAt(De)tachDeviceDiskLive) : for \
at(de)taching Disks. (qemudDomainAt(De)tachDeviceControllerLive) : for at(de)taching \
                Controllers
---
 src/qemu/qemu_driver.c |  429 ++++++++++++++++++++++++++----------------------
 1 files changed, 234 insertions(+), 195 deletions(-)

diff --git a/src/qemu/qemu_driver.c b/src/qemu/qemu_driver.c
index a8f3849..f33a7f4 100644
--- a/src/qemu/qemu_driver.c
+++ b/src/qemu/qemu_driver.c
@@ -3785,15 +3785,223 @@ cleanup:
     return ret;
 }
 
+static int qemudDomainAttachDeviceDiskLive(struct qemud_driver *driver,
+                                           virDomainObjPtr vm,
+                                           virDomainDeviceDefPtr dev,
+                                           virBitmapPtr qemuCaps)
+{
+    virDomainDiskDefPtr disk = dev-&gt;data.disk;
+    virCgroupPtr cgroup = NULL;
+    int ret = -1;
 
-static int qemudDomainAttachDeviceFlags(virDomainPtr dom, const char *xml,
-                                        unsigned int flags)
+    if (disk-&gt;driverName != NULL &amp;&amp; !STREQ(disk-&gt;driverName, "qemu")) {
+        qemuReportError(VIR_ERR_INTERNAL_ERROR,
+                        _("unsupported driver name '%s' for disk '%s'"),
+                        disk-&gt;driverName, disk-&gt;src);
+        goto end;
+    }
+
+    if (qemuCgroupControllerActive(driver, VIR_CGROUP_CONTROLLER_DEVICES)) {
+        if (virCgroupForDomain(driver-&gt;cgroup, vm-&gt;def-&gt;name, &amp;cgroup, 0)) {
+            qemuReportError(VIR_ERR_INTERNAL_ERROR,
+                            _("Unable to find cgroup for %s"),
+                            vm-&gt;def-&gt;name);
+            goto end;
+        }
+        if (qemuSetupDiskCgroup(driver, vm, cgroup, disk) &lt; 0)
+            goto end;
+    }
+    switch (disk-&gt;device)  {
+    case VIR_DOMAIN_DISK_DEVICE_CDROM:
+    case VIR_DOMAIN_DISK_DEVICE_FLOPPY:
+        ret = qemuDomainChangeEjectableMedia(driver, vm, disk, qemuCaps, false);
+        break;
+    case VIR_DOMAIN_DISK_DEVICE_DISK:
+        if (disk-&gt;bus == VIR_DOMAIN_DISK_BUS_USB)
+            ret = qemuDomainAttachUsbMassstorageDevice(driver, vm,
+                                                       disk, qemuCaps);
+        else if (disk-&gt;bus == VIR_DOMAIN_DISK_BUS_VIRTIO)
+            ret = qemuDomainAttachPciDiskDevice(driver, vm, disk, qemuCaps);
+        else if (disk-&gt;bus == VIR_DOMAIN_DISK_BUS_SCSI)
+            ret = qemuDomainAttachSCSIDisk(driver, vm, disk, qemuCaps);
+        else
+            qemuReportError(VIR_ERR_CONFIG_UNSUPPORTED,
+                            _("disk bus '%s' cannot be hotplugged."),
+                            virDomainDiskBusTypeToString(disk-&gt;bus));
+        break;
+    default:
+        qemuReportError(VIR_ERR_CONFIG_UNSUPPORTED,
+                        _("disk device type '%s' cannot be hotplugged"),
+                        virDomainDiskDeviceTypeToString(disk-&gt;device));
+        break;
+    }
+
+    if (ret != 0 &amp;&amp; cgroup) {
+        if (qemuTeardownDiskCgroup(driver, vm, cgroup, disk) &lt; 0)
+            VIR_WARN("Failed to teardown cgroup for disk path %s",
+                     NULLSTR(disk-&gt;src));
+    }
+end:
+    if (cgroup)
+        virCgroupFree(&amp;cgroup);
+    return ret;
+}
+
+static int
+qemudDomainAttachDeviceControllerLive(struct qemud_driver *driver,
+                                      virDomainObjPtr vm,
+                                      virDomainDeviceDefPtr dev,
+                                      virBitmapPtr qemuCaps)
+{
+    virDomainControllerDefPtr cont = dev-&gt;data.controller;
+    int ret = -1;
+
+    switch (cont-&gt;type) {
+    case VIR_DOMAIN_CONTROLLER_TYPE_SCSI:
+        ret = qemuDomainAttachPciControllerDevice(driver, vm, cont, qemuCaps);
+        break;
+    default:
+        qemuReportError(VIR_ERR_CONFIG_UNSUPPORTED,
+                        _("disk controller bus '%s' cannot be hotplugged."),
+                        virDomainControllerTypeToString(cont-&gt;type));
+        break;
+    }
+    return ret;
+}
+
+static int qemudDomainAttachDeviceLive(virDomainObjPtr vm,
+                                       virDomainDeviceDefPtr dev,
+                                       virDomainPtr dom,
+                                       virBitmapPtr qemuCaps)
+{
+    struct qemud_driver *driver = dom-&gt;conn-&gt;privateData;
+    int ret = -1;
+
+    switch (dev-&gt;type) {
+    case VIR_DOMAIN_DEVICE_DISK:
+        ret = qemudDomainAttachDeviceDiskLive(driver, vm, dev, qemuCaps);
+        if (!ret)
+            dev-&gt;data.disk = NULL;
+        break;
+
+    case VIR_DOMAIN_DEVICE_CONTROLLER:
+        ret = qemudDomainAttachDeviceControllerLive(driver, vm, dev, qemuCaps);
+        if (!ret)
+            dev-&gt;data.controller = NULL;
+        break;
+
+    case VIR_DOMAIN_DEVICE_NET:
+        ret = qemuDomainAttachNetDevice(dom-&gt;conn, driver, vm,
+                                        dev-&gt;data.net, qemuCaps);
+        if (!ret)
+            dev-&gt;data.net = NULL;
+        break;
+
+    case VIR_DOMAIN_DEVICE_HOSTDEV:
+        ret = qemuDomainAttachHostDevice(driver, vm,
+                                         dev-&gt;data.hostdev, qemuCaps);
+        if (!ret)
+            dev-&gt;data.hostdev = NULL;
+        break;
+
+    default:
+        qemuReportError(VIR_ERR_CONFIG_UNSUPPORTED,
+                        _("device type '%s' cannot be attached"),
+                        virDomainDeviceTypeToString(dev-&gt;type));
+        break;
+    }
+
+    return ret;
+}
+
+static int qemudDomainDetachDeviceDiskLive(struct qemud_driver *driver,
+                                           virDomainObjPtr vm,
+                                           virDomainDeviceDefPtr dev,
+                                           virBitmapPtr qemuCaps)
+{
+    virDomainDiskDefPtr disk = dev-&gt;data.disk;
+    int ret = -1;
+
+    switch (disk-&gt;device) {
+    case VIR_DOMAIN_DISK_DEVICE_DISK:
+        if (disk-&gt;bus == VIR_DOMAIN_DISK_BUS_VIRTIO)
+            ret = qemuDomainDetachPciDiskDevice(driver, vm, dev, qemuCaps);
+        else if (disk-&gt;bus == VIR_DOMAIN_DISK_BUS_SCSI)
+            ret =  qemuDomainDetachDiskDevice(driver, vm, dev, qemuCaps);
+        else if (dev-&gt;data.disk-&gt;bus == VIR_DOMAIN_DISK_BUS_USB)
+            ret = qemuDomainDetachDiskDevice(driver, vm, dev, qemuCaps);
+        else
+            qemuReportError(VIR_ERR_CONFIG_UNSUPPORTED, "%s",
+                            _("This type of disk cannot be hot unplugged"));
+        break;
+    default:
+        break;
+    }
+    return ret;
+}
+
+static int
+qemudDomainDetachDeviceControllerLive(struct qemud_driver *driver,
+                                      virDomainObjPtr vm,
+                                      virDomainDeviceDefPtr dev,
+                                      virBitmapPtr qemuCaps)
+{
+    virDomainControllerDefPtr cont = dev-&gt;data.controller;
+    int ret = -1;
+
+    switch (cont-&gt;type) {
+    case VIR_DOMAIN_CONTROLLER_TYPE_SCSI:
+        ret = qemuDomainDetachPciControllerDevice(driver, vm, dev, qemuCaps);
+        break;
+    default :
+        qemuReportError(VIR_ERR_CONFIG_UNSUPPORTED,
+                        _("disk controller bus '%s' cannot be hotunplugged."),
+                        virDomainControllerTypeToString(cont-&gt;type));
+    }
+    return ret;
+}
+
+static int qemudDomainDetachDeviceLive(virDomainObjPtr vm,
+                                       virDomainDeviceDefPtr dev,
+                                       virDomainPtr dom,
+                                       virBitmapPtr qemuCaps)
+{
+    struct qemud_driver *driver = dom-&gt;conn-&gt;privateData;
+    int ret = -1;
+
+    switch (dev-&gt;type) {
+    case VIR_DOMAIN_DEVICE_DISK:
+        ret = qemudDomainDetachDeviceDiskLive(driver, vm, dev, qemuCaps);
+        break;
+    case VIR_DOMAIN_DEVICE_CONTROLLER:
+        ret = qemudDomainDetachDeviceControllerLive(driver, vm, dev, qemuCaps);
+        break;
+    case VIR_DOMAIN_DEVICE_NET:
+        ret = qemuDomainDetachNetDevice(driver, vm, dev, qemuCaps);
+        break;
+    case VIR_DOMAIN_DEVICE_HOSTDEV:
+        ret = qemuDomainDetachHostDevice(driver, vm, dev, qemuCaps);
+        break;
+    default:
+        qemuReportError(VIR_ERR_CONFIG_UNSUPPORTED,
+                        "%s", _("This type of device cannot be hot unplugged"));
+        break;
+    }
+
+    return ret;
+}
+
+enum {
+    QEMUD_DEVICE_ATTACH, QEMUD_DEVICE_DETACH, QEMUD_DEVICE_UPDATE,
+};
+
+static int qemudDomainModifyDeviceFlags(virDomainPtr dom, const char *xml,
+                                        unsigned int flags, int action)
 {
     struct qemud_driver *driver = dom-&gt;conn-&gt;privateData;
-    virDomainObjPtr vm;
-    virDomainDeviceDefPtr dev = NULL;
     virBitmapPtr qemuCaps = NULL;
-    virCgroupPtr cgroup = NULL;
+    virDomainObjPtr vm = NULL;
+    virDomainDeviceDefPtr dev = NULL;
     int ret = -1;
 
     virCheckFlags(VIR_DOMAIN_DEVICE_MODIFY_LIVE |
@@ -3833,106 +4041,22 @@ static int qemudDomainAttachDeviceFlags(virDomainPtr dom, \
const char *xml,  &amp;qemuCaps) &lt; 0)
         goto endjob;
 
-    if (dev-&gt;type == VIR_DOMAIN_DEVICE_DISK) {
-        if (dev-&gt;data.disk-&gt;driverName != NULL &amp;&amp;
-            !STREQ(dev-&gt;data.disk-&gt;driverName, "qemu")) {
-            qemuReportError(VIR_ERR_INTERNAL_ERROR,
-                            _("unsupported driver name '%s' for disk '%s'"),
-                            dev-&gt;data.disk-&gt;driverName, dev-&gt;data.disk-&gt;src);
-            goto endjob;
-        }
-
-        if (qemuCgroupControllerActive(driver, VIR_CGROUP_CONTROLLER_DEVICES)) {
-            if (virCgroupForDomain(driver-&gt;cgroup, vm-&gt;def-&gt;name, &amp;cgroup, 0) !=0 ) \
                {
-                qemuReportError(VIR_ERR_INTERNAL_ERROR,
-                                _("Unable to find cgroup for %s"),
-                                vm-&gt;def-&gt;name);
-                goto endjob;
-            }
-            if (qemuSetupDiskCgroup(driver, vm, cgroup, dev-&gt;data.disk) &lt; 0)
-                goto endjob;
-        }
-
-        switch (dev-&gt;data.disk-&gt;device) {
-        case VIR_DOMAIN_DISK_DEVICE_CDROM:
-        case VIR_DOMAIN_DISK_DEVICE_FLOPPY:
-            ret = qemuDomainChangeEjectableMedia(driver, vm,
-                                                 dev-&gt;data.disk,
-                                                 qemuCaps,
-                                                 false);
-            if (ret == 0)
-                dev-&gt;data.disk = NULL;
-            break;
-
-        case VIR_DOMAIN_DISK_DEVICE_DISK:
-            if (dev-&gt;data.disk-&gt;bus == VIR_DOMAIN_DISK_BUS_USB) {
-                ret = qemuDomainAttachUsbMassstorageDevice(driver, vm,
-                                                           dev-&gt;data.disk, \
                qemuCaps);
-                if (ret == 0)
-                    dev-&gt;data.disk = NULL;
-            } else if (dev-&gt;data.disk-&gt;bus == VIR_DOMAIN_DISK_BUS_VIRTIO) {
-                ret = qemuDomainAttachPciDiskDevice(driver, vm,
-                                                    dev-&gt;data.disk, qemuCaps);
-                if (ret == 0)
-                    dev-&gt;data.disk = NULL;
-            } else if (dev-&gt;data.disk-&gt;bus == VIR_DOMAIN_DISK_BUS_SCSI) {
-                ret = qemuDomainAttachSCSIDisk(driver, vm,
-                                               dev-&gt;data.disk, qemuCaps);
-                if (ret == 0)
-                    dev-&gt;data.disk = NULL;
-            } else {
-                qemuReportError(VIR_ERR_CONFIG_UNSUPPORTED,
-                                _("disk bus '%s' cannot be hotplugged."),
-                                virDomainDiskBusTypeToString(dev-&gt;data.disk-&gt;bus));
-                /* fallthrough */
-            }
-            break;
-
-        default:
-            qemuReportError(VIR_ERR_CONFIG_UNSUPPORTED,
-                            _("disk device type '%s' cannot be hotplugged"),
-                            \
                virDomainDiskDeviceTypeToString(dev-&gt;data.disk-&gt;device));
-            /* Fallthrough */
-        }
-        if (ret != 0 &amp;&amp; cgroup) {
-            if (qemuTeardownDiskCgroup(driver, vm, cgroup, dev-&gt;data.disk) &lt; 0)
-                VIR_WARN("Failed to teardown cgroup for disk path %s",
-                         NULLSTR(dev-&gt;data.disk-&gt;src));
-        }
-    } else if (dev-&gt;type == VIR_DOMAIN_DEVICE_CONTROLLER) {
-        if (dev-&gt;data.controller-&gt;type == VIR_DOMAIN_CONTROLLER_TYPE_SCSI) {
-            ret = qemuDomainAttachPciControllerDevice(driver, vm,
-                                                      dev-&gt;data.controller, \
                qemuCaps);
-            if (ret == 0)
-                dev-&gt;data.controller = NULL;
-        } else {
-            qemuReportError(VIR_ERR_CONFIG_UNSUPPORTED,
-                            _("disk controller bus '%s' cannot be hotplugged."),
-                            \
                virDomainControllerTypeToString(dev-&gt;data.controller-&gt;type));
-            /* fallthrough */
-        }
-    } else if (dev-&gt;type == VIR_DOMAIN_DEVICE_NET) {
-        ret = qemuDomainAttachNetDevice(dom-&gt;conn, driver, vm,
-                                        dev-&gt;data.net, qemuCaps);
-        if (ret == 0)
-            dev-&gt;data.net = NULL;
-    } else if (dev-&gt;type == VIR_DOMAIN_DEVICE_HOSTDEV) {
-        ret = qemuDomainAttachHostDevice(driver, vm,
-                                         dev-&gt;data.hostdev, qemuCaps);
-        if (ret == 0)
-            dev-&gt;data.hostdev = NULL;
-    } else {
-        qemuReportError(VIR_ERR_CONFIG_UNSUPPORTED,
-                        _("device type '%s' cannot be attached"),
-                        virDomainDeviceTypeToString(dev-&gt;type));
-        goto endjob;
+    switch (action) {
+    case QEMUD_DEVICE_ATTACH:
+        ret = qemudDomainAttachDeviceLive(vm, dev, dom, qemuCaps);
+        break;
+    case QEMUD_DEVICE_DETACH:
+        ret = qemudDomainDetachDeviceLive(vm, dev, dom, qemuCaps);
+        break;
+    default:
+        break;
     }
-
-    /* update domain status forcibly because the domain status may be changed
+    /*
+     * update domain status forcibly because the domain status may be changed
      * even if we attach the device failed. For example, a new controller may
      * be created.
      */
-    if (virDomainSaveStatus(driver-&gt;caps, driver-&gt;stateDir, vm) &lt; 0)
+    if (!ret &amp;&amp; virDomainSaveStatus(driver-&gt;caps, driver-&gt;stateDir, vm) &lt; 0)
         ret = -1;
 
 endjob:
@@ -3940,10 +4064,6 @@ endjob:
         vm = NULL;
 
 cleanup:
-    if (cgroup)
-        virCgroupFree(&amp;cgroup);
-
-    qemuCapsFree(qemuCaps);
     virDomainDeviceDefFree(dev);
     if (vm)
         virDomainObjUnlock(vm);
@@ -3951,6 +4071,13 @@ cleanup:
     return ret;
 }
 
+static int qemudDomainAttachDeviceFlags(virDomainPtr dom,
+                                        const char *xml,
+                                        unsigned int flags)
+{
+    return qemudDomainModifyDeviceFlags(dom, xml, flags, QEMUD_DEVICE_ATTACH);
+}
+
 static int qemudDomainAttachDevice(virDomainPtr dom, const char *xml)
 {
     return qemudDomainAttachDeviceFlags(dom, xml,
@@ -4080,99 +4207,11 @@ cleanup:
 }
 
 
+
 static int qemudDomainDetachDeviceFlags(virDomainPtr dom, const char *xml,
                                         unsigned int flags)
 {
-    struct qemud_driver *driver = dom-&gt;conn-&gt;privateData;
-    virDomainObjPtr vm;
-    virBitmapPtr qemuCaps = NULL;
-    virDomainDeviceDefPtr dev = NULL;
-    int ret = -1;
-
-    virCheckFlags(VIR_DOMAIN_DEVICE_MODIFY_LIVE|
-                  VIR_DOMAIN_DEVICE_MODIFY_CONFIG, -1);
-
-    if (flags &amp; VIR_DOMAIN_DEVICE_MODIFY_CONFIG) {
-        qemuReportError(VIR_ERR_OPERATION_INVALID,
-                        "%s", _("cannot modify the persistent configuration of a \
                domain:"));
-        return -1;
-    }
-    qemuDriverLock(driver);
-    vm = virDomainFindByUUID(&amp;driver-&gt;domains, dom-&gt;uuid);
-    if (!vm) {
-        char uuidstr[VIR_UUID_STRING_BUFLEN];
-        virUUIDFormat(dom-&gt;uuid, uuidstr);
-        qemuReportError(VIR_ERR_NO_DOMAIN,
-                        _("no domain with matching uuid '%s'"), uuidstr);
-        goto cleanup;
-    }
-
-    if (qemuDomainObjBeginJobWithDriver(driver, vm) &lt; 0)
-        goto cleanup;
-
-    if (!virDomainObjIsActive(vm)) {
-        qemuReportError(VIR_ERR_OPERATION_INVALID,
-                        "%s", _("cannot detach device on inactive domain"));
-        goto endjob;
-    }
-
-    dev = virDomainDeviceDefParse(driver-&gt;caps, vm-&gt;def, xml,
-                                  VIR_DOMAIN_XML_INACTIVE);
-    if (dev == NULL)
-        goto endjob;
-
-    if (qemuCapsExtractVersionInfo(vm-&gt;def-&gt;emulator, vm-&gt;def-&gt;os.arch,
-                                   NULL,
-                                   &amp;qemuCaps) &lt; 0)
-        goto endjob;
-
-    if (dev-&gt;type == VIR_DOMAIN_DEVICE_DISK &amp;&amp;
-        dev-&gt;data.disk-&gt;device == VIR_DOMAIN_DISK_DEVICE_DISK) {
-        if (dev-&gt;data.disk-&gt;bus == VIR_DOMAIN_DISK_BUS_VIRTIO) {
-            ret = qemuDomainDetachPciDiskDevice(driver, vm, dev, qemuCaps);
-        }
-        else if (dev-&gt;data.disk-&gt;bus == VIR_DOMAIN_DISK_BUS_SCSI) {
-            ret = qemuDomainDetachDiskDevice(driver, vm, dev, qemuCaps);
-        } else if (dev-&gt;data.disk-&gt;bus == VIR_DOMAIN_DISK_BUS_USB) {
-            ret = qemuDomainDetachDiskDevice(driver, vm, dev, qemuCaps);
-        }
-        else {
-            qemuReportError(VIR_ERR_CONFIG_UNSUPPORTED, "%s",
-                            _("This type of disk cannot be hot unplugged"));
-        }
-    } else if (dev-&gt;type == VIR_DOMAIN_DEVICE_NET) {
-        ret = qemuDomainDetachNetDevice(driver, vm, dev, qemuCaps);
-    } else if (dev-&gt;type == VIR_DOMAIN_DEVICE_CONTROLLER) {
-        if (dev-&gt;data.controller-&gt;type == VIR_DOMAIN_CONTROLLER_TYPE_SCSI) {
-            ret = qemuDomainDetachPciControllerDevice(driver, vm, dev,
-                                                      qemuCaps);
-        } else {
-            qemuReportError(VIR_ERR_CONFIG_UNSUPPORTED,
-                            _("disk controller bus '%s' cannot be hotunplugged."),
-                            \
                virDomainControllerTypeToString(dev-&gt;data.controller-&gt;type));
-            /* fallthrough */
-        }
-    } else if (dev-&gt;type == VIR_DOMAIN_DEVICE_HOSTDEV) {
-        ret = qemuDomainDetachHostDevice(driver, vm, dev, qemuCaps);
-    } else {
-        qemuReportError(VIR_ERR_CONFIG_UNSUPPORTED,
-                        "%s", _("This type of device cannot be hot unplugged"));
-    }
-
-    if (!ret &amp;&amp; virDomainSaveStatus(driver-&gt;caps, driver-&gt;stateDir, vm) &lt; 0)
-        ret = -1;
-
-endjob:
-    if (qemuDomainObjEndJob(vm) == 0)
-        vm = NULL;
-
-cleanup:
-    qemuCapsFree(qemuCaps);
-    virDomainDeviceDefFree(dev);
-    if (vm)
-        virDomainObjUnlock(vm);
-    qemuDriverUnlock(driver);
-    return ret;
+    return qemudDomainModifyDeviceFlags(dom, xml, flags, QEMUD_DEVICE_DETACH);
 }
 
 static int qemudDomainDetachDevice(virDomainPtr dom, const char *xml)
-- 
1.7.4.1


</body></email><email><emailId>20110421072702</emailId><senderName>KAMEZAWA Hiroyuki</senderName><senderEmail>kamezawa.hiroyu@jp.fujitsu.com</senderEmail><timestampReceived>2011-04-21 07:27:02-0400</timestampReceived><subject>[libvirt-users] [PATCHv11 4/6] libvirt/qemu support persistent device modification</subject><body>

libvirt/qemu support persistent device modification

This patch adds functions for modify domain's persistent definition.
To do error recovery in easy way, we use a copy of vmdef and update it.

The whole sequence will be:

  make a copy of domain definition.

  if (flags &amp; MODIFY_CONFIG)
      update copied domain definition
  if (flags &amp; MODIF_LIVE)
      do hotplug.
  if (no error)
      save copied one to the file and update cached definition.
  else
      discard copied definition.

This patch is mixuture of Eric Blake's work and mine.
From: Eric Blake &lt;eblake@redhat.com&gt;
Signed-off-by: KAMEZAWA Hiroyuki &lt;kamezawa.hiroyu@jp.fujitsu.com&gt;

Changelog: v10-&gt;v11
  - fixed MODIFY_CURRENT case.

(virDomainObjCopyPersistentDef): make a copy of persistent vm definition
(qemudDomainModifyDeviceFlags): add support for MODIFY_CONFIG and MODIFY_CURRENT
(qemudDomainAttach/Detach/UpdateDeviceConfig) : callbacks. now empty
(qemudDomainModifyDeviceFlags): modified to handle inactive domain.
---
 src/conf/domain_conf.c   |   18 ++++++
 src/conf/domain_conf.h   |    3 +
 src/libvirt_private.syms |    1 +
 src/qemu/qemu_driver.c   |  148 ++++++++++++++++++++++++++++++++++++----------
 4 files changed, 139 insertions(+), 31 deletions(-)

diff --git a/src/conf/domain_conf.c b/src/conf/domain_conf.c
index 381e692..6c1098a 100644
--- a/src/conf/domain_conf.c
+++ b/src/conf/domain_conf.c
@@ -9509,3 +9509,21 @@ cleanup:
 
     return ret;
 }
+
+
+virDomainDefPtr
+virDomainObjCopyPersistentDef(virCapsPtr caps, virDomainObjPtr dom)
+{
+    char *xml;
+    virDomainDefPtr cur, ret;
+
+    cur = virDomainObjGetPersistentDef(caps, dom);
+
+    xml = virDomainDefFormat(cur, VIR_DOMAIN_XML_WRITE_FLAGS);
+    if (!xml)
+        return NULL;
+
+    ret = virDomainDefParseString(caps, xml, VIR_DOMAIN_XML_READ_FLAGS);
+
+    return ret;
+}
diff --git a/src/conf/domain_conf.h b/src/conf/domain_conf.h
index 6ea30b9..ddf111a 100644
--- a/src/conf/domain_conf.h
+++ b/src/conf/domain_conf.h
@@ -1288,6 +1288,9 @@ int virDomainObjSetDefTransient(virCapsPtr caps,
 virDomainDefPtr
 virDomainObjGetPersistentDef(virCapsPtr caps,
                              virDomainObjPtr domain);
+virDomainDefPtr
+virDomainObjCopyPersistentDef(virCapsPtr caps, virDomainObjPtr dom);
+
 void virDomainRemoveInactive(virDomainObjListPtr doms,
                              virDomainObjPtr dom);
 
diff --git a/src/libvirt_private.syms b/src/libvirt_private.syms
index ba7739d..f732431 100644
--- a/src/libvirt_private.syms
+++ b/src/libvirt_private.syms
@@ -287,6 +287,7 @@ virDomainMemballoonModelTypeToString;
 virDomainNetDefFree;
 virDomainNetTypeToString;
 virDomainObjAssignDef;
+virDomainObjCopyPersistentDef;
 virDomainObjSetDefTransient;
 virDomainObjGetPersistentDef;
 virDomainObjIsDuplicate;
diff --git a/src/qemu/qemu_driver.c b/src/qemu/qemu_driver.c
index 4cba9d0..2c35bbb 100644
--- a/src/qemu/qemu_driver.c
+++ b/src/qemu/qemu_driver.c
@@ -4065,6 +4065,48 @@ static int qemudDomainUpdateDeviceLive(virDomainObjPtr vm,
     return ret;
 }
 
+static int
+qemudDomainAttachDeviceConfig(virDomainDefPtr vmdef ATTRIBUTE_UNUSED,
+                              virDomainDeviceDefPtr dev)
+{
+    switch (dev-&gt;type) {
+    default:
+         qemuReportError(VIR_ERR_CONFIG_UNSUPPORTED, "%s",
+                         _("persistent update of device is not supported"));
+         return -1;
+    }
+    return 0;
+}
+
+
+static int
+qemudDomainDetachDeviceConfig(virDomainDefPtr vmdef ATTRIBUTE_UNUSED,
+                              virDomainDeviceDefPtr dev)
+{
+    switch (dev-&gt;type) {
+    default:
+        qemuReportError(VIR_ERR_CONFIG_UNSUPPORTED, "%s",
+                        _("persistent update of device is not supported"));
+        return -1;
+    }
+    return 0;
+}
+
+static int
+qemudDomainUpdateDeviceConfig(virDomainDefPtr vmdef ATTRIBUTE_UNUSED,
+                              virDomainDeviceDefPtr dev,
+                              bool force ATTRIBUTE_UNUSED)
+{
+    switch (dev-&gt;type) {
+    default:
+        qemuReportError(VIR_ERR_CONFIG_UNSUPPORTED, "%s",
+                         _("persistent update of device is not supported"));
+        return -1;
+    }
+    return 0;
+
+}
+
 enum {
     QEMUD_DEVICE_ATTACH, QEMUD_DEVICE_DETACH, QEMUD_DEVICE_UPDATE,
 };
@@ -4075,6 +4117,7 @@ static int qemudDomainModifyDeviceFlags(virDomainPtr dom, const char *xml,
     struct qemud_driver *driver = dom-&gt;conn-&gt;privateData;
     virBitmapPtr qemuCaps = NULL;
     virDomainObjPtr vm = NULL;
+    virDomainDefPtr vmdef = NULL;
     virDomainDeviceDefPtr dev = NULL;
     bool force = (flags &amp; VIR_DOMAIN_DEVICE_MODIFY_FORCE) != 0;
     int ret = -1;
@@ -4083,7 +4126,8 @@ static int qemudDomainModifyDeviceFlags(virDomainPtr dom, const char *xml,
     case QEMUD_DEVICE_ATTACH:
     case QEMUD_DEVICE_DETACH:
         virCheckFlags(VIR_DOMAIN_DEVICE_MODIFY_LIVE |
-                      VIR_DOMAIN_DEVICE_MODIFY_CONFIG, -1);
+                      VIR_DOMAIN_DEVICE_MODIFY_CONFIG |
+                      VIR_DOMAIN_DEVICE_MODIFY_CURRENT, -1);
         break;
     case QEMUD_DEVICE_UPDATE:
         virCheckFlags(VIR_DOMAIN_DEVICE_MODIFY_CURRENT |
@@ -4095,12 +4139,6 @@ static int qemudDomainModifyDeviceFlags(virDomainPtr dom, const char *xml,
         break;
     }
 
-    if (flags &amp; VIR_DOMAIN_DEVICE_MODIFY_CONFIG) {
-        qemuReportError(VIR_ERR_OPERATION_INVALID,
-                        "%s", _("cannot modify the persistent configuration of a domain"));
-        return -1;
-    }
-
     qemuDriverLock(driver);
     vm = virDomainFindByUUID(&amp;driver-&gt;domains, dom-&gt;uuid);
     if (!vm) {
@@ -4114,11 +4152,29 @@ static int qemudDomainModifyDeviceFlags(virDomainPtr dom, const char *xml,
     if (qemuDomainObjBeginJobWithDriver(driver, vm) &lt; 0)
         goto cleanup;
 
-    if (!virDomainObjIsActive(vm)) {
-        qemuReportError(VIR_ERR_OPERATION_INVALID,
-                        "%s", _("cannot attach device on inactive domain"));
-        goto endjob;
+    if (virDomainObjIsActive(vm)) {
+        if (flags == VIR_DOMAIN_DEVICE_MODIFY_CURRENT)
+            flags |= VIR_DOMAIN_DEVICE_MODIFY_LIVE;
+    } else {
+        if (flags == VIR_DOMAIN_DEVICE_MODIFY_CURRENT)
+            flags |= VIR_DOMAIN_DEVICE_MODIFY_CONFIG;
+        /* check consistency between flags and the vm state */
+        if (flags &amp; VIR_DOMAIN_DEVICE_MODIFY_LIVE) {
+            qemuReportError(VIR_ERR_OPERATION_INVALID,
+                            "%s",
+                            _("cannot modify device on inactive domain"));
+            goto endjob;
+        }
+    }
+
+    if ((flags &amp; VIR_DOMAIN_DEVICE_MODIFY_CONFIG) &amp;&amp; !vm-&gt;persistent) {
+         qemuReportError(VIR_ERR_OPERATION_INVALID,
+                         "%s", _("cannot modify device on transient domain"));
+         goto endjob;
     }
+    /* At updating config, we update a copy */
+    if (flags &amp; VIR_DOMAIN_DEVICE_MODIFY_CONFIG)
+        vmdef = virDomainObjCopyPersistentDef(driver-&gt;caps, vm);
 
     dev = virDomainDeviceDefParse(driver-&gt;caps, vm-&gt;def, xml,
                                   VIR_DOMAIN_XML_INACTIVE);
@@ -4130,33 +4186,63 @@ static int qemudDomainModifyDeviceFlags(virDomainPtr dom, const char *xml,
                                    &amp;qemuCaps) &lt; 0)
         goto endjob;
 
-    switch (action) {
-    case QEMUD_DEVICE_ATTACH:
-        ret = qemudDomainAttachDeviceLive(vm, dev, dom, qemuCaps);
-        break;
-    case QEMUD_DEVICE_DETACH:
-        ret = qemudDomainDetachDeviceLive(vm, dev, dom, qemuCaps);
-        break;
-    case QEMUD_DEVICE_UPDATE:
-        ret = qemudDomainUpdateDeviceLive(vm, dev, dom, qemuCaps, force);
-        break;
-    default:
-        break;
-    }
+    ret = 0;
 
-    /*
-     * update domain status forcibly because the domain status may be changed
-     * even if we attach the device failed. For example, a new controller may
-     * be created.
-     */
-    if (!ret &amp;&amp; virDomainSaveStatus(driver-&gt;caps, driver-&gt;stateDir, vm) &lt; 0)
-        ret = -1;
+    /* Update a copy of persistent definition */
+    if (flags &amp; VIR_DOMAIN_DEVICE_MODIFY_CONFIG) {
+        switch (action) {
+        case QEMUD_DEVICE_ATTACH:
+            ret = qemudDomainAttachDeviceConfig(vmdef, dev);
+            break;
+        case QEMUD_DEVICE_DETACH:
+            ret = qemudDomainDetachDeviceConfig(vmdef, dev);
+            break;
+        case QEMUD_DEVICE_UPDATE:
+            ret = qemudDomainUpdateDeviceConfig(vmdef, dev, force);
+            break;
+        default:
+            break;
+        }
+    }
+    /* Update Live */
+    if (!ret &amp;&amp; (flags &amp; VIR_DOMAIN_DEVICE_MODIFY_LIVE)) {
+        switch (action) {
+        case QEMUD_DEVICE_ATTACH:
+            ret = qemudDomainAttachDeviceLive(vm, dev, dom, qemuCaps);
+            break;
+        case QEMUD_DEVICE_DETACH:
+            ret = qemudDomainDetachDeviceLive(vm, dev, dom, qemuCaps);
+            break;
+        case QEMUD_DEVICE_UPDATE:
+            ret = qemudDomainUpdateDeviceLive(vm, dev, dom, qemuCaps, force);
+            break;
+        default:
+            break;
+        }
+        /*
+         * update domain status forcibly because the domain status may be
+         * changed even if we attach the device failed. For example, a new
+         * controller may be created.
+         */
+        if (!ret &amp;&amp;
+            virDomainSaveStatus(driver-&gt;caps, driver-&gt;stateDir, vm) &lt; 0)
+            ret = -1;
+    }
+    /* No error until here, we can save persistent definition */
+    if (!ret &amp;&amp; (flags &amp; VIR_DOMAIN_DEVICE_MODIFY_CONFIG)) {
+        ret = virDomainSaveConfig(driver-&gt;configDir, vmdef);
+        if (!ret) {
+            virDomainObjAssignDef(vm, vmdef, false);
+            vmdef = NULL;
+        }
+    }
 
 endjob:
     if (qemuDomainObjEndJob(vm) == 0)
         vm = NULL;
 
 cleanup:
+    virDomainDefFree(vmdef);
     virDomainDeviceDefFree(dev);
     if (vm)
         virDomainObjUnlock(vm);
-- 
1.7.4.1


</body></email><email><emailId>20110421072818</emailId><senderName>KAMEZAWA Hiroyuki</senderName><senderEmail>kamezawa.hiroyu@jp.fujitsu.com</senderEmail><timestampReceived>2011-04-21 07:28:18-0400</timestampReceived><subject>[libvirt-users] [PATCHv11 5/6] libvirt/qemu - Support changes of disks by VIR_DOMAIN_DEVICE_MODIFY_C</subject><body>

Support changes of disks by VIR_DOMAIN_DEVICE_MODIFY_CONFIG for qemu.

This patch includes patches for Attach/Detach.

Signed-off-by: KAMEZAWA Hiroyuki &lt;kamezawa.hiroyu@jp.fujitsu.com&gt;

* /src/conf/domain_conf.c
(virDomainDiskIndexByName): returns array index of disk in vmdef.
(virDomainDiskRemoveByName): removes a disk which has the name.
* src/qemu/qemu_driver.c
(qemudDomainAttachDeviceConfig): add support for Disks.
(qemudDomainDetachDeviceConfig): add support for Disks.
---
 src/conf/domain_conf.c   |   22 ++++++++++++++++++++++
 src/conf/domain_conf.h   |    2 ++
 src/libvirt_private.syms |    2 ++
 src/qemu/qemu_driver.c   |   36 ++++++++++++++++++++++++++++++++++--
 4 files changed, 60 insertions(+), 2 deletions(-)

diff --git a/src/conf/domain_conf.c b/src/conf/domain_conf.c
index 6c1098a..d4fac87 100644
--- a/src/conf/domain_conf.c
+++ b/src/conf/domain_conf.c
@@ -5006,6 +5006,19 @@ virVirtualPortProfileFormat(virBufferPtr buf,
     virBufferVSprintf(buf, "%s&lt;/virtualport&gt;\n", indent);
 }
 
+int virDomainDiskIndexByName(virDomainDefPtr def, const char *name)
+{
+    virDomainDiskDefPtr vdisk;
+    int i;
+
+    for (i = 0; i &lt; def-&gt;ndisks; i++) {
+        vdisk = def-&gt;disks[i];
+        if (STREQ(vdisk-&gt;dst, name))
+            return i;
+    }
+    return -1;
+}
+
 int virDomainDiskInsert(virDomainDefPtr def,
                         virDomainDiskDefPtr disk)
 {
@@ -5077,6 +5090,15 @@ void virDomainDiskRemove(virDomainDefPtr def, size_t i)
     }
 }
 
+int virDomainDiskRemoveByName(virDomainDefPtr def, const char *name)
+{
+    int i = virDomainDiskIndexByName(def, name);
+    if (i &lt; 0)
+        return -1;
+    virDomainDiskRemove(def, i);
+    return 0;
+}
+
 
 int virDomainControllerInsert(virDomainDefPtr def,
                               virDomainControllerDefPtr controller)
diff --git a/src/conf/domain_conf.h b/src/conf/domain_conf.h
index ddf111a..1dadf98 100644
--- a/src/conf/domain_conf.h
+++ b/src/conf/domain_conf.h
@@ -1329,6 +1329,7 @@ int virDomainVcpupinAdd(virDomainDefPtr def,
                         int maplen,
                         int vcpu);
 
+int virDomainDiskIndexByName(virDomainDefPtr def, const char *name);
 int virDomainDiskInsert(virDomainDefPtr def,
                         virDomainDiskDefPtr disk);
 void virDomainDiskInsertPreAlloced(virDomainDefPtr def,
@@ -1336,6 +1337,7 @@ void virDomainDiskInsertPreAlloced(virDomainDefPtr def,
 int virDomainDiskDefAssignAddress(virCapsPtr caps, virDomainDiskDefPtr def);
 
 void virDomainDiskRemove(virDomainDefPtr def, size_t i);
+int virDomainDiskRemoveByName(virDomainDefPtr def, const char *name);
 
 int virDomainControllerInsert(virDomainDefPtr def,
                               virDomainControllerDefPtr controller);
diff --git a/src/libvirt_private.syms b/src/libvirt_private.syms
index f732431..c469259 100644
--- a/src/libvirt_private.syms
+++ b/src/libvirt_private.syms
@@ -246,11 +246,13 @@ virDomainDiskDefFree;
 virDomainDiskDeviceTypeToString;
 virDomainDiskErrorPolicyTypeFromString;
 virDomainDiskErrorPolicyTypeToString;
+virDomainDiskIndexByName;
 virDomainDiskInsert;
 virDomainDiskInsertPreAlloced;
 virDomainDiskIoTypeFromString;
 virDomainDiskIoTypeToString;
 virDomainDiskRemove;
+virDomainDiskRemoveByName;
 virDomainDiskTypeFromString;
 virDomainDiskTypeToString;
 virDomainFSDefFree;
diff --git a/src/qemu/qemu_driver.c b/src/qemu/qemu_driver.c
index 2c35bbb..3669f92 100644
--- a/src/qemu/qemu_driver.c
+++ b/src/qemu/qemu_driver.c
@@ -4066,10 +4066,32 @@ static int qemudDomainUpdateDeviceLive(virDomainObjPtr vm,
 }
 
 static int
-qemudDomainAttachDeviceConfig(virDomainDefPtr vmdef ATTRIBUTE_UNUSED,
+qemudDomainAttachDeviceConfig(virDomainDefPtr vmdef,
                               virDomainDeviceDefPtr dev)
 {
+    virDomainDiskDefPtr disk;
+
     switch (dev-&gt;type) {
+    case VIR_DOMAIN_DEVICE_DISK:
+        disk = dev-&gt;data.disk;
+        if (virDomainDiskIndexByName(vmdef, disk-&gt;dst) &gt;= 0) {
+            qemuReportError(VIR_ERR_INVALID_ARG,
+                            _("target %s already exists."), disk-&gt;dst);
+            return -1;
+        }
+        if (virDomainDiskInsert(vmdef, disk)) {
+            virReportOOMError();
+            return -1;
+        }
+        /* vmdef has the pointer. Generic codes for vmdef will do all jobs */
+        dev-&gt;data.disk = NULL;
+        if (disk-&gt;bus != VIR_DOMAIN_DISK_BUS_VIRTIO)
+            if (virDomainDefAddImplicitControllers(vmdef) &lt; 0)
+                return -1;
+        if (qemuDomainAssignPCIAddresses(vmdef) &lt; 0)
+            return -1;
+        break;
+
     default:
          qemuReportError(VIR_ERR_CONFIG_UNSUPPORTED, "%s",
                          _("persistent update of device is not supported"));
@@ -4080,10 +4102,20 @@ qemudDomainAttachDeviceConfig(virDomainDefPtr vmdef ATTRIBUTE_UNUSED,
 
 
 static int
-qemudDomainDetachDeviceConfig(virDomainDefPtr vmdef ATTRIBUTE_UNUSED,
+qemudDomainDetachDeviceConfig(virDomainDefPtr vmdef,
                               virDomainDeviceDefPtr dev)
 {
+    virDomainDiskDefPtr disk;
+
     switch (dev-&gt;type) {
+    case VIR_DOMAIN_DEVICE_DISK:
+        disk = dev-&gt;data.disk;
+        if (virDomainDiskRemoveByName(vmdef, disk-&gt;dst)) {
+            qemuReportError(VIR_ERR_INVALID_ARG,
+                            _("no target device %s"), disk-&gt;dst);
+            return -1;
+        }
+        break;
     default:
         qemuReportError(VIR_ERR_CONFIG_UNSUPPORTED, "%s",
                         _("persistent update of device is not supported"));
-- 
1.7.4.1


</body></email><email><emailId>20110421072941</emailId><senderName>KAMEZAWA Hiroyuki</senderName><senderEmail>kamezawa.hiroyu@jp.fujitsu.com</senderEmail><timestampReceived>2011-04-21 07:29:41-0400</timestampReceived><subject>[libvirt-users] [PATCH 6/6] libvirt/qemu - support update cdrom/floppy persistent</subject><body>

libvirt/qemu - support update cdrom/floppy persistent.

Signed-off-by: KAMEZAWA Hiroyuki &lt;kamezawa.hiroyu@jp.fujitsu.com&gt;

* src/qemu/qemu_driver.c
 (qemudDomainUpdateDeviceConfig): add cdrom/floppy exchange code.
---
 src/qemu/qemu_driver.c |   40 +++++++++++++++++++++++++++++++++++++++-
 1 files changed, 39 insertions(+), 1 deletions(-)

diff --git a/src/qemu/qemu_driver.c b/src/qemu/qemu_driver.c
index 3669f92..ec1fbc6 100644
--- a/src/qemu/qemu_driver.c
+++ b/src/qemu/qemu_driver.c
@@ -4125,11 +4125,49 @@ qemudDomainDetachDeviceConfig(virDomainDefPtr vmdef,
 }
 
 static int
-qemudDomainUpdateDeviceConfig(virDomainDefPtr vmdef ATTRIBUTE_UNUSED,
+qemudDomainUpdateDeviceConfig(virDomainDefPtr vmdef,
                               virDomainDeviceDefPtr dev,
                               bool force ATTRIBUTE_UNUSED)
 {
+    virDomainDiskDefPtr orig, disk;
+    int pos;
+
     switch (dev-&gt;type) {
+    case VIR_DOMAIN_DEVICE_DISK:
+        disk = dev-&gt;data.disk;
+        pos = virDomainDiskIndexByName(vmdef, disk-&gt;dst);
+        if (pos &lt; 0) {
+            qemuReportError(VIR_ERR_INVALID_ARG,
+                            _("target %s doesn't exists."), disk-&gt;dst);
+            return -1;
+        }
+        orig = vmdef-&gt;disks[pos];
+        if (!(orig-&gt;device == VIR_DOMAIN_DISK_DEVICE_CDROM) &amp;&amp;
+            !(orig-&gt;device == VIR_DOMAIN_DISK_DEVICE_FLOPPY)) {
+            qemuReportError(VIR_ERR_INVALID_ARG,
+                            _("this disk doesn't support update"));
+            return -1;
+        }
+        /*
+         * Update 'orig'
+         * We allow updating src/type//driverType/cachemode/
+         */
+        VIR_FREE(orig-&gt;src);
+        orig-&gt;src = disk-&gt;src;
+        orig-&gt;type = disk-&gt;type;
+        orig-&gt;cachemode = disk-&gt;cachemode;
+        if (disk-&gt;driverName) {
+            VIR_FREE(orig-&gt;driverName);
+            orig-&gt;driverName = disk-&gt;driverName;
+            disk-&gt;driverName = NULL;
+        }
+        if (disk-&gt;driverType) {
+            VIR_FREE(orig-&gt;driverType);
+            orig-&gt;driverType = disk-&gt;driverType;
+            disk-&gt;driverType = NULL;
+        }
+        disk-&gt;src = NULL;
+        break;
     default:
         qemuReportError(VIR_ERR_CONFIG_UNSUPPORTED, "%s",
                          _("persistent update of device is not supported"));
-- 
1.7.4.1


</body></email><email><emailId>20110421080430</emailId><senderName>Jiri Denemark</senderName><senderEmail>jdenemar@redhat.com</senderEmail><timestampReceived>2011-04-21 08:04:30-0400</timestampReceived><subject>Re: [libvirt-users] kvm virtual server boot order</subject><body>

&gt; Given the scenario where the disks of a virtual server are defined in the
&gt; following order
&gt; 
&gt;       harddisk hda
&gt;       harddisk vda
&gt;       cdrom vdb
&gt;       cdrom hdb
&gt; 
&gt; Boot device type is crdom.  Which cdrom device will be boot attempted?
&gt; &gt;From the above links, I'm guessing that hdb will be boot attempted. Is this
&gt; the actual behavior?

That depends on BIOS implementation used by qemu and to be honest, I'm not
sure what the default behavior is; you would need to try that :-)

However, if you have new enough libvirt (&gt;= 0.8.8), qemu and SeaBIOS (AFAIK
qemu &gt;= 0.14.0 should be ok), you can better control boot order by using
per-device boot configuration. That is, instead of specifying

    &lt;os&gt;
      ...
      &lt;boot dev='cdrom'/&gt;
    &lt;/os&gt;

you would use something like

    &lt;devices&gt;
      ...
      &lt;disk type='file' device='cdrom'&gt;
        ...
        &lt;boot order='1'/&gt;
      &lt;/disk&gt;
    &lt;/devices&gt;

It's also documented in libvirt XML documentation at
http://www.libvirt.org/formatdomain.html#elementsDisks

Jirka

</body></email><email><emailId>20110426071336</emailId><senderName>Maciej_Ga³kiewicz</senderName><senderEmail>maciej.galkiewicz@gmail.com</senderEmail><timestampReceived>2011-04-26 07:13:36-0400</timestampReceived><subject>[libvirt-users] Listing machines as non-root user</subject><body>

I have a problem with virsh. I'm using eucalyptus software on top of xen 4
(debian squeeze). The problem is that unix user "eucalyptus" cannot see vm
machines when it executes "virsh list". My libvirt version is 0.8.8-3 from
debian sid repository. The same
problem occurs with older versions.
What is more I have tried to change unix_sock_ro_perms  to "2777". After
libvirt restart it started to work. Even when I reverted this change it was
still working. Unfortunately after server restart virsh still does not work
(I am not sure but I cannot restart my production servers right now).
Everything is fine when I run virsh as root. I have the same issue on 7
machines.

regards
M. Galkiewicz

[Attachment #3 (text/html)]

&lt;meta http-equiv="content-type" content="text/html; charset=utf-8"&gt;&lt;font \
class="Apple-style-span" face="arial, sans-serif"&gt;&lt;span class="Apple-style-span" \
style="border-collapse: collapse;"&gt;&lt;div&gt;I have a problem with virsh. I'm using \
eucalyptus software on top of xen 4&lt;/div&gt; &lt;div&gt;(debian squeeze). The problem is that \
unix user "eucalyptus" cannot see vm&lt;/div&gt;&lt;div&gt;machines when it executes \
"virsh list". My libvirt version is 0.8.8-3 from debian sid repository. The \
same&lt;/div&gt; &lt;div&gt;problem occurs with older versions.&lt;/div&gt;&lt;div&gt;What is more I have \
tried to change unix_sock_ro_perms  to "2777". After&lt;/div&gt;&lt;div&gt;libvirt \
restart it started to work. Even when I reverted this change it was&lt;/div&gt; &lt;div&gt;still \
working. Unfortunately after server restart virsh still does not work&lt;/div&gt;&lt;div&gt;(I am \
not sure but I cannot restart my production servers right now).&lt;/div&gt;&lt;div&gt;Everything \
is fine when I run virsh as root. I have the same issue on 7&lt;/div&gt; \
&lt;div&gt;machines.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;regards&lt;/div&gt;&lt;div&gt;M. \
Galkiewicz&lt;/div&gt;&lt;/span&gt;&lt;/font&gt;



</body></email><email><emailId>20110426131403</emailId><senderName>Jan</senderName><senderEmail>jan@agetty.de</senderEmail><timestampReceived>2011-04-26 13:14:03-0400</timestampReceived><subject>Re: [libvirt-users] Listing machines as non-root user</subject><body>

Hi Maciej,

On 04/26/2011 09:13 AM Maciej Gałkiewicz wrote:
&gt; I have a problem with virsh. I'm using eucalyptus software on top of xen 4
&gt; (debian squeeze). The problem is that unix user "eucalyptus" cannot see vm
&gt; machines when it executes "virsh list". My libvirt version is 0.8.8-3 from
&gt; debian sid repository. The same
&gt; problem occurs with older versions.
&gt; What is more I have tried to change unix_sock_ro_perms  to "2777". After
&gt; libvirt restart it started to work. Even when I reverted this change it was
&gt; still working. Unfortunately after server restart virsh still does not work
&gt; (I am not sure but I cannot restart my production servers right now).
&gt; Everything is fine when I run virsh as root. I have the same issue on 7
&gt; machines.

have you tried a different connection URI?:

--------------&lt;-----------------
$ virsh -c qemu:///system 'list'
--------------&gt;-----------------

If not explicitly stated, the virsh binary uses the 'qemu:///session' URI
(at least under debian).

See also .. VIRSH(1):

----------------------------------&lt;---------------------------------------
qemu:///system
"connect locally as root to the daemon supervising QEmu and KVM domains"

qemu:///session
"connect locally as a normal user to his own set of QEmu and KVM domains"
----------------------------------&gt;---------------------------------------

Please note that in order for the 'qemu:///system' URI to work probably the
user must be part of the 'libvirt' group. This way you won't have to touch
the permission set of any of the respective sockets.

I hope this helps ;)

Cheers
Jan

</body></email><email><emailId>20110427072836</emailId><senderName>Maciej_Ga³kiewicz</senderName><senderEmail>maciej.galkiewicz@gmail.com</senderEmail><timestampReceived>2011-04-27 07:28:36-0400</timestampReceived><subject>Re: [libvirt-users] Listing machines as non-root user</subject><body>

2011/4/26 Jan &lt;jan@agetty.de&gt;

&gt;
&gt; have you tried a different connection URI?:
&gt;
&gt; --------------&lt;-----------------
&gt; $ virsh -c qemu:///system 'list'
&gt; --------------&gt;-----------------
&gt;
&gt; If not explicitly stated, the virsh binary uses the 'qemu:///session' URI
&gt; (at least under debian).
&gt;
&gt; See also .. VIRSH(1):
&gt;
&gt; ----------------------------------&lt;---------------------------------------
&gt; qemu:///system
&gt; "connect locally as root to the daemon supervising QEmu and KVM domains"
&gt;
&gt; qemu:///session
&gt; "connect locally as a normal user to his own set of QEmu and KVM domains"
&gt; ----------------------------------&gt;---------------------------------------
&gt;
&gt; Please note that in order for the 'qemu:///system' URI to work probably the
&gt; user must be part of the 'libvirt' group. This way you won't have to touch
&gt; the permission set of any of the respective sockets.
&gt;

My user is in libvirt group
$ id
uid=107(eucalyptus) gid=112(eucalyptus) groups=112(eucalyptus),110(libvirt)

I have tried 'virsh -c qemu:///system 'list'' as well. Still does not work.

regards
Maciej

[Attachment #3 (text/html)]

&lt;div class="gmail_quote"&gt;2011/4/26 Jan &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:jan@agetty.de"&gt;jan@agetty.de&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt; &lt;div&gt;&lt;div class="h5"&gt;&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;have you tried a different connection URI?:&lt;br&gt;
&lt;br&gt;
--------------&lt;-----------------&lt;br&gt;
$ virsh -c qemu:///system 'list'&lt;br&gt;
--------------&gt;-----------------&lt;br&gt;
&lt;br&gt;
If not explicitly stated, the virsh binary uses the 'qemu:///session' URI&lt;br&gt;
(at least under debian).&lt;br&gt;
&lt;br&gt;
See also .. VIRSH(1):&lt;br&gt;
&lt;br&gt;
----------------------------------&lt;---------------------------------------&lt;br&gt;
qemu:///system&lt;br&gt;
"connect locally as root to the daemon supervising QEmu and KVM \
domains"&lt;br&gt; &lt;br&gt;
qemu:///session&lt;br&gt;
"connect locally as a normal user to his own set of QEmu and KVM \
                domains"&lt;br&gt;
----------------------------------&gt;---------------------------------------&lt;br&gt;
&lt;br&gt;
Please note that in order for the 'qemu:///system' URI to work probably \
the&lt;br&gt; user must be part of the 'libvirt' group. This way you won't have \
to touch&lt;br&gt; the permission set of any of the respective \
sockets.&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;My user is in libvirt group \
&lt;/div&gt;&lt;div&gt;&lt;div&gt;$ id&lt;/div&gt;&lt;div&gt;uid=107(eucalyptus) gid=112(eucalyptus) \
groups=112(eucalyptus),110(libvirt)&lt;/div&gt; &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I have tried \
'virsh -c qemu:///system 'list'' as well. Still does not \
work.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;regards&lt;/div&gt;&lt;div&gt;Maciej&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20110427095517</emailId><senderName>Jan</senderName><senderEmail>jan@agetty.de</senderEmail><timestampReceived>2011-04-27 09:55:17-0400</timestampReceived><subject>Re: [libvirt-users] Listing machines as non-root user</subject><body>

Hi Maciej,

On 04/27/2011 09:28 AM Maciej Gałkiewicz wrote:

[...]

&gt;&gt; Please note that in order for the 'qemu:///system' URI to work probably the
&gt;&gt; user must be part of the 'libvirt' group. This way you won't have to touch
&gt;&gt; the permission set of any of the respective sockets.
&gt;&gt;
&gt; 
&gt; My user is in libvirt group
&gt; $ id
&gt; uid=107(eucalyptus) gid=112(eucalyptus) groups=112(eucalyptus),110(libvirt)
&gt; 
&gt; I have tried 'virsh -c qemu:///system 'list'' as well. Still does not work.

so far so good. So what about the output? Do you get any exceptions or
errors? If no virtual machines are up and running at the moment you will
still have to specify the "--all" parameter in order to list also offline
machines:

$ virsh -c qemu:///system 'list --all'

Maybe you could just try to run virsh in debug mode and figure out whats
happening when errors arise:

$ export LIBVIRT_DEBUG=1; $ virsh -c qemu:///system 'list'

Cheers
Jan

</body></email><email><emailId>20110427101130</emailId><senderName>Maciej_Ga³kiewicz</senderName><senderEmail>maciej.galkiewicz@gmail.com</senderEmail><timestampReceived>2011-04-27 10:11:30-0400</timestampReceived><subject>Re: [libvirt-users] Listing machines as non-root user</subject><body>

2011/4/27 Jan &lt;jan@agetty.de&gt;

&gt; so far so good. So what about the output? Do you get any exceptions or
&gt; errors? If no virtual machines are up and running at the moment you will
&gt; still have to specify the "--all" parameter in order to list also offline
&gt; machines:
&gt;
&gt; $ virsh -c qemu:///system 'list --all'
&gt;
&gt; Maybe you could just try to run virsh in debug mode and figure out whats
&gt; happening when errors arise:
&gt;
&gt; $ export LIBVIRT_DEBUG=1; $ virsh -c qemu:///system 'list'
&gt;

I realized that this URI is not appropriate for my xen. I have tried as
root:
# virsh -c xen:/// list
 Id Name                 State
----------------------------------
  0 Domain-0             running
 14 i-4E8D088D           idle

As user eucalyptus:
$  virsh -c xen:/// list
 Id Name                 State
----------------------------------

And as user eucalyptus with debug mode I got sth like this:
12:07:43.032: 22147: debug : xenUnifiedOpen:335 : Trying XenD sub-driver
12:07:43.032: 22147: debug : xenUnifiedOpen:364 : Handing off for remote
driver
12:07:43.032: 22147: debug : xenUnifiedOpen:393 : Failed to activate a
mandatory sub-driver

Do you need more output?

regards
Maciej

[Attachment #3 (text/html)]

&lt;div class="gmail_quote"&gt;2011/4/27 Jan &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:jan@agetty.de"&gt;jan@agetty.de&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt; so far so good. So what about the output? Do you get any \
exceptions or&lt;br&gt; errors? If no virtual machines are up and running at the moment you \
will&lt;br&gt; still have to specify the "--all" parameter in order to list also \
offline&lt;br&gt; machines:&lt;br&gt;
&lt;br&gt;
$ virsh -c qemu:///system 'list --all'&lt;br&gt;
&lt;br&gt;
Maybe you could just try to run virsh in debug mode and figure out whats&lt;br&gt;
happening when errors arise:&lt;br&gt;
&lt;br&gt;
$ export LIBVIRT_DEBUG=1; $ virsh -c qemu:///system \
'list'&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I realized that this URI is not \
appropriate for my xen. I have tried as root:&lt;/div&gt;&lt;div&gt;&lt;div&gt;# virsh -c xen:/// \
list&lt;/div&gt; &lt;div&gt; Id Name                 \
State&lt;/div&gt;&lt;div&gt;----------------------------------&lt;/div&gt;&lt;div&gt;  0 Domain-0             \
running&lt;/div&gt;&lt;div&gt; 14 i-4E8D088D           idle&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;As \
user eucalyptus:&lt;/div&gt;&lt;div&gt; $  virsh -c xen:/// list&lt;/div&gt;&lt;div&gt; Id Name               \
State&lt;/div&gt;&lt;div&gt;----------------------------------&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;And as \
user eucalyptus with debug mode I got sth like this:&lt;/div&gt;&lt;div&gt;&lt;div&gt;12:07:43.032: \
22147: debug : xenUnifiedOpen:335 : Trying XenD sub-driver&lt;/div&gt; &lt;div&gt;12:07:43.032: \
22147: debug : xenUnifiedOpen:364 : Handing off for remote \
driver&lt;/div&gt;&lt;div&gt;12:07:43.032: 22147: debug : xenUnifiedOpen:393 : Failed to activate \
a mandatory sub-driver&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Do you need more output?&lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;regards&lt;/div&gt;&lt;div&gt;Maciej&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20110427104937</emailId><senderName>Jan</senderName><senderEmail>jan@agetty.de</senderEmail><timestampReceived>2011-04-27 10:49:37-0400</timestampReceived><subject>Re: [libvirt-users] Listing machines as non-root user</subject><body>

On 04/27/2011 12:11 PM Maciej Gałkiewicz wrote:
&gt; I realized that this URI is not appropriate for my xen. I have tried as 

Sorry, I'm sticking with kvm for quiet some time now and haven't been using
xen for a while.

&gt; root: # virsh -c xen:/// list Id Name                 State 
&gt; ---------------------------------- 0 Domain-0             running 14
&gt; i-4E8D088D           idle
&gt; 
&gt; As user eucalyptus: $  virsh -c xen:/// list Id Name
&gt; State ----------------------------------
&gt; 
&gt; And as user eucalyptus with debug mode I got sth like this: 
&gt; 12:07:43.032: 22147: debug : xenUnifiedOpen:335 : Trying XenD
&gt; sub-driver 12:07:43.032: 22147: debug : xenUnifiedOpen:364 : Handing off
&gt; for remote driver 12:07:43.032: 22147: debug : xenUnifiedOpen:393 :
&gt; Failed to activate a mandatory sub-driver

Could you please have a look at the permissions of the xend sockets under
/var/run/xend/*? Since virsh is being executed with the the privileges of
the currently logged on user, the driver might not be able to access the
respective socket for reading which causes the driver .

</body></email><email><emailId>20110505080918</emailId><senderName>Maciej_Ga³kiewicz</senderName><senderEmail>maciej.galkiewicz@gmail.com</senderEmail><timestampReceived>2011-05-05 08:09:18-0400</timestampReceived><subject>Re: [libvirt-users] Listing machines as non-root user</subject><body>

2011/4/27 Maciej Ga=C5=82kiewicz &lt;maciej.galkiewicz@gmail.com&gt;

&gt; 2011/4/27 Jan &lt;jan@agetty.de&gt;
&gt;
&gt;&gt; Could you please have a look at the permissions of the xend sockets unde=
r
&gt;&gt; /var/run/xend/*? Since virsh is being executed with the the privileges o=
f
&gt;&gt; the currently logged on user, the driver might not be able to access the
&gt;&gt; respective socket for reading which causes the driver .
&gt;&gt;
&gt;
&gt; # ls -la
&gt; total 4.0K
&gt; drwx------  3 root root   54 Apr  3 07:09 .
&gt; drwxr-xr-x 19 root root 4.0K Apr 26 00:18 ..
&gt; drwx------  2 root root    6 Nov 24 15:56 boot
&gt; srwxr-xr-x  1 root root    0 Apr  3 07:09 xen-api.sock
&gt; srwxr-xr-x  1 root root    0 Apr  3 07:09 xmlrpc.sock
&gt;

Any ideas? I am stuck.

Maciej

[Attachment #3 (text/html)]

&lt;div class="gmail_quote"&gt;2011/4/27 Maciej GaÅ‚kiewicz &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:maciej.galkiewicz@gmail.com"&gt;maciej.galkiewicz@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt; &lt;div class="gmail_quote"&gt;&lt;div class="im"&gt;2011/4/27 Jan \
&lt;span dir="ltr"&gt;&lt;&lt;a href="mailto:jan@agetty.de" \
target="_blank"&gt;jan@agetty.de&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div class="im"&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex"&gt;

&lt;div&gt;Could you please have a look at the permissions of the xend sockets under&lt;/div&gt;
/var/run/xend/*? Since virsh is being executed with the the privileges of&lt;br&gt;
the currently logged on user, the driver might not be able to access the&lt;br&gt;
respective socket for reading which causes the driver .&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;# ls -la&lt;/div&gt;&lt;div&gt;total \
4.0K&lt;/div&gt;&lt;div&gt;drwx------   3 root root    54 Apr   3 07:09 .&lt;/div&gt;&lt;div&gt;drwxr-xr-x 19 \
root root 4.0K Apr 26 00:18 ..&lt;/div&gt;&lt;div&gt;drwx------   2 root root      6 Nov 24 15:56 \
boot&lt;/div&gt;

&lt;div&gt;srwxr-xr-x   1 root root      0 Apr   3 07:09 xen-api.sock&lt;/div&gt;&lt;div&gt;srwxr-xr-x  \
1 root root      0 Apr   3 07:09 \
xmlrpc.sock&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Any ideas? I am \
stuck.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; Maciej  &lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20110421185414</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-04-21 18:54:14-0400</timestampReceived><subject>Re: [libvirt-users] [PATCHv11 0/6] libvirt/qemu - persistent modification of devices</subject><body>


I'm assuming you meant for this to go to libvir-list rather than
libvirt-users; all my subsequent mails will swap the list reply.

On 04/21/2011 01:19 AM, KAMEZAWA Hiroyuki wrote:
&gt; 
&gt; Here is v11. Fixed comments/bugs and updated against the latest libvirt.git.
&gt; 
&gt; Changes v10-&gt;v11: 
&gt;  - fixed comments on each patches
&gt;  - fixed cgroup handling in patch 3.
&gt;  - fixed MODIFY_CURRENT handling in patch 4.
&gt; 
&gt; most of diff comes from refactoring qemu/qemu_driver.c
&gt; --
&gt;  conf/domain_conf.c   |   40 ++
&gt;  conf/domain_conf.h   |    5
&gt;  libvirt_private.syms |    3
&gt;  qemu/qemu_driver.c   |  727 +++++++++++++++++++++++++++++++--------------------
&gt;  4 files changed, 500 insertions(+), 275 deletions(-)
&gt; 
&gt; 
&gt; Thanks,
&gt; -Kame
&gt; 
&gt; 

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20110421192307</emailId><senderName>Robin Axelsson</senderName><senderEmail>gu99roax@student.chalmers.se</senderEmail><timestampReceived>2011-04-21 19:23:07-0400</timestampReceived><subject>Re: [libvirt-users] No IOMMU found.  Unable to assign device</subject><body>

This page (

http://wiki.xensource.com/xenwiki/VTdHowTo

) also lists motherboards that has the AMD IOMMU feature. The MSI 
890FXA-GD70 is no longer in beta, i.e. IOMMU now comes with the official 
BIOS firmware from 1.8 and up.

On 2011-04-21 20:47, David White wrote:
&gt; That's correct.  You need a mainboard that supports Intel VT-d or 
&gt; AMD-Vi.  Start here 
&gt; (http://www.intel.com/support/motherboards/desktop/sb/CS-030922.htm ) 
&gt; for Intel.   Not sure where to find a list of AMD boards.   Without 
&gt; IOMMU you need to rely on emulation.
&gt;
&gt; -dmw
&gt;
&gt; On 04/21/2011 09:57 AM, Marco van Beek wrote:
&gt;&gt; Hi,
&gt;&gt;
&gt;&gt; I am playing around with PCI passthrough and came across some posts 
&gt;&gt; that said you could not do PCI passthrough unless you had IOMMU 
&gt;&gt; hardware. which it would appear I don't
&gt;&gt;
&gt;&gt; Is this the case? Am I flogging a dead horse?
&gt;&gt;
&gt;&gt; Thanks,
&gt;&gt;
&gt;&gt; Marco
&gt;&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

</body></email><email><emailId>20110426142522</emailId><senderName>Lars Nordin</senderName><senderEmail>lnordin@internap.com</senderEmail><timestampReceived>2011-04-26 14:25:22-0400</timestampReceived><subject>[libvirt-users] problem installing libvirt from source</subject><body>

I'm trying to compile and install libvirt-0.9.0 on Ubuntu v10.04. The make and \
install went fine and I don't see any errors but there isn't a libvirt directory \
created in /usr/local/lib/python2.6/dist-packages.

I specified configure --with-vmware -with-esx  (and later --with-python), then make, \
then sudo make install.

&gt; From config.log:
prefix = /usr/local
exec_prefix = ${prefix}
pyexecdir = ${exec_prefix}/lib/python2.6/dist-packages
pythondir = ${prefix}/lib/python2.6/dist-packages
pkgpyexecdir = ${pyexecdir}/libvirt
pkgpythondir = ${pythondir}/libvirt


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;&lt;head&gt;&lt;meta http-equiv=Content-Type \
content="text/html; charset=us-ascii"&gt;&lt;meta name=Generator content="Microsoft Word 12 \
(filtered medium)"&gt;&lt;style&gt;&lt;!-- /* Font Definitions */
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
--&gt;&lt;/style&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapelayout v:ext="edit"&gt;
&lt;o:idmap v:ext="edit" data="1" /&gt;
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;&lt;/head&gt;&lt;body lang=EN-US link=blue vlink=purple&gt;&lt;div \
class=WordSection1&gt;&lt;p class=MsoNormal&gt;I’m trying to compile and install \
libvirt-0.9.0 on Ubuntu v10.04. The make and install went fine and I don’t see \
any errors but there isn’t a libvirt directory created in \
/usr/local/lib/python2.6/dist-packages.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;I specified configure \
--with-vmware –with-esx  (and later --with-python), then make, then sudo \
make install.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;From config.log: &lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;prefix = \
/usr/local&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;exec_prefix = ${prefix}&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;pyexecdir = \
${exec_prefix}/lib/python2.6/dist-packages&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;pythondir \
= ${prefix}/lib/python2.6/dist-packages&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;pkgpyexecdir \
= ${pyexecdir}/libvirt&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;pkgpythondir = \
${pythondir}/libvirt&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20110427142944</emailId><senderName>David Brown</senderName><senderEmail>dcbrown73@yahoo.com</senderEmail><timestampReceived>2011-04-27 14:29:44-0400</timestampReceived><subject>[libvirt-users] Disk not bootable from yesterday resolved</subject><body>

Just an update and a thanks.
The not bootable issue I was having yesterday ended up being for some odd reason the \
disk type in the domain define xml file had been switched to the disk being "raw" \
rather than qcow2 format.  When I changed:&lt;driver name='qemu' type='raw'/&gt; to &lt;driver \
name='qemu' type='qcow2'/&gt;

It booted without issue.  I'm not clear how that got changed on the original domain.  \
It was in use without issue about a week ago. :/ I then ran the clone again and it \
cloned fine, but had the boot issueagain.  I checked the cloned domain.xml file and \
again it said typeraw.  I changed it again to qcow2 and it booted fine. Bug?  \
Shouldn't it keep the type in the config the same? Anyway, thanks for help and \
especially the quick responses! Dave


[Attachment #3 (text/html)]

&lt;table cellspacing="0" cellpadding="0" border="0" &gt;&lt;tr&gt;&lt;td valign="top" style="font: \
inherit;"&gt;&lt;div&gt;Just an update and a thanks.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The not bootable \
issue I was having yesterday ended up being for some odd reason the disk type in the \
domain define xml file had been switched to the disk being "raw" rather than qcow2 \
format.  When I changed:&lt;/div&gt;&lt;div&gt;&lt;span class="Apple-style-span" \
style="line-height: 17px; font-family: 'Times New Roman'; font-size: medium; "&gt;&lt;pre \
style="margin-top: 0.5em; margin-right: 0px; margin-bottom: 0.5em; margin-left: 0px; \
padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; \
line-height: 1.1em; font-family: monospace; "&gt;&lt;driver name='qemu' type='raw'/&gt; \
&lt;/pre&gt;&lt;div&gt;to &lt;/div&gt;&lt;div&gt;&lt;pre style="margin-top: 0.5em; margin-right: 0px; \
margin-bottom: 0.5em; margin-left: 0px; padding-top: 0px; padding-right: 0px; \
padding-bottom: 0px; padding-left: 0px; line-height: 1.1em; font-family: monospace; \
"&gt;&lt;driver name='qemu' type='qcow2'/&gt; &lt;/pre&gt;&lt;pre style="margin-top: 0.5em; \
margin-right: 0px; margin-bottom: 0.5em; margin-left: 0px; padding-top: 0px; \
padding-right: 0px; padding-bottom: 0px; padding-left: 0px; line-height: 1.1em; \
font-family: monospace; "&gt;&lt;br&gt;&lt;/pre&gt;&lt;pre style="margin-top: 0.5em; margin-right: 0px; \
margin-bottom: 0.5em; margin-left: 0px; padding-top: 0px; padding-right: 0px; \
padding-bottom: 0px; padding-left: 0px; line-height: 1.1em; font-family: monospace; \
"&gt;It booted without issue.  I'm not clear how that got changed on the &lt;/pre&gt;&lt;pre \
style="margin-top: 0.5em; margin-right: 0px; margin-bottom: 0.5em; margin-left: 0px; \
padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; \
line-height: 1.1em; font-family: monospace; "&gt;original domain.  It was in use without \
issue about a week ago. :/&lt;/pre&gt;&lt;pre style="margin-top: 0.5em; margin-right: 0px; \
margin-bottom: 0.5em; margin-left: 0px; padding-top: 0px; padding-right: 0px; \
padding-bottom: 0px;  padding-left: 0px; line-height: 1.1em; font-family: monospace; \
"&gt;&lt;br&gt;&lt;/pre&gt;&lt;pre style="margin-top: 0.5em; margin-right: 0px; margin-bottom: 0.5em; \
margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; \
padding-left: 0px; line-height: 1.1em; font-family: monospace; "&gt;I then ran the clone \
again and it cloned fine, but had the boot issue&lt;/pre&gt;&lt;pre style="margin-top: 0.5em; \
margin-right: 0px; margin-bottom: 0.5em; margin-left: 0px; padding-top: 0px; \
padding-right: 0px; padding-bottom: 0px; padding-left: 0px; line-height: 1.1em; \
font-family: monospace; "&gt;again.  I checked the cloned domain.xml file and again it \
said type&lt;/pre&gt;&lt;pre style="margin-top: 0.5em; margin-right: 0px; margin-bottom: \
0.5em; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; \
padding-left: 0px; line-height: 1.1em; font-family: monospace; "&gt;raw.  I changed it \
again to qcow2 and it booted fine.&lt;/pre&gt;&lt;pre style="margin-top: 0.5em;  margin-right: \
0px; margin-bottom: 0.5em; margin-left: 0px; padding-top: 0px; padding-right: 0px; \
padding-bottom: 0px; padding-left: 0px; line-height: 1.1em; font-family: monospace; \
"&gt;&lt;br&gt;&lt;/pre&gt;&lt;pre style="margin-top: 0.5em; margin-right: 0px; margin-bottom: 0.5em; \
margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; \
padding-left: 0px; line-height: 1.1em; font-family: monospace; "&gt;Bug?  Shouldn't it \
keep the type in the config the same?&lt;/pre&gt;&lt;pre style="margin-top: 0.5em; \
margin-right: 0px; margin-bottom: 0.5em; margin-left: 0px; padding-top: 0px; \
padding-right: 0px; padding-bottom: 0px; padding-left: 0px; line-height: 1.1em; \
font-family: monospace; "&gt;&lt;br&gt;&lt;/pre&gt;&lt;pre style="margin-top: 0.5em; margin-right: 0px; \
margin-bottom: 0.5em; margin-left: 0px; padding-top: 0px; padding-right: 0px; \
padding-bottom: 0px; padding-left: 0px; line-height: 1.1em; font-family: monospace; \
"&gt;Anyway, thanks for help and especially the quick  responses!&lt;/pre&gt;&lt;pre \
style="margin-top: 0.5em; margin-right: 0px; margin-bottom: 0.5em; margin-left: 0px; \
padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; \
line-height: 1.1em; font-family: monospace; "&gt;&lt;br&gt;&lt;/pre&gt;&lt;pre style="margin-top: \
0.5em; margin-right: 0px; margin-bottom: 0.5em; margin-left: 0px; padding-top: 0px; \
padding-right: 0px; padding-bottom: 0px; padding-left: 0px; line-height: 1.1em; \
font-family: monospace; "&gt;Dave&lt;/pre&gt;&lt;pre style="margin-top: 0.5em; margin-right: 0px; \
margin-bottom: 0.5em; margin-left: 0px; padding-top: 0px; padding-right: 0px; \
padding-bottom: 0px; padding-left: 0px; line-height: 1.1em; font-family: monospace; \
"&gt;&lt;br&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;



</body></email><email><emailId>20110405115032</emailId><senderName></senderName><senderEmail>robert.smol@stereoit.com</senderEmail><timestampReceived>2011-04-05 11:50:32-0400</timestampReceived><subject>[libvirt-users] [Libvir] libvirt &amp; vde_switch</subject><body>

Hi,

I would like to ask about status of VDE and libvirt. I found a thread 
from http://www.redhat.com/archives/libvir-list/2008-February/msg00030.html.

I am not interested in connecting the VDE to the outside world. I have 
created a FW machine using macvtap. To this machine I would like to 
attach machines from different zones (dmz, prod, cust).  I was thinking 
on using VDE and vlans (FW would have 1 interface in each vlan - 
machines also), but I am not aware how to configure this in libvirt.

I now assume I can do the same setup with regular bridges for the moment 
(benefit of VDE would be only 1 switch for many vlans).

Regards,

Robert

-- 
stereoIT - Open Source Technology Partners
http://www.stereoit.com
mobile: +420 776 762378

</body></email><email><emailId>20110406083406</emailId><senderName>Nicolas Sebrecht</senderName><senderEmail>nsebrecht@piing.fr</senderEmail><timestampReceived>2011-04-06 08:34:06-0400</timestampReceived><subject>[libvirt-users]  Re: [Libvir] libvirt &amp; vde_switch</subject><body>

The 05/04/11, Robert Å mol wrote:

&gt; I would like to ask about status of VDE and libvirt. I found a
&gt; thread from http://www.redhat.com/archives/libvir-list/2008-February/msg00030.html.

AFAIK, vde_switch is still unsupported by libvirt and nobody seems to
work on it these days.

Most people wanting vde_switch (or open vswitch) enough leave libvirt.

&gt; I am not interested in connecting the VDE to the outside world. I
&gt; have created a FW machine using macvtap. To this machine I would
&gt; like to attach machines from different zones (dmz, prod, cust).  I
&gt; was thinking on using VDE and vlans (FW would have 1 interface in
&gt; each vlan - machines also), but I am not aware how to configure this
&gt; in libvirt.
&gt; 
&gt; I now assume I can do the same setup with regular bridges for the
&gt; moment

Yes, this is what I do for now.

&gt;        (benefit of VDE would be only 1 switch for many vlans).

Plus more features (i.e.: easy virtual switch link between hosts),
maintenance facilities, etc.

-- 
Nicolas Sebrecht

</body></email><email><emailId>20110428131513</emailId><senderName>Ireneusz Szcześniak</senderName><senderEmail>irek.szczesniak@gmail.com</senderEmail><timestampReceived>2011-04-28 13:15:13-0400</timestampReceived><subject>[libvirt-users] port forwarding</subject><body>

Hi,

I'm using CentOS release 5.6 (Final) and Xen 3.1.  I'm writing to ask 
how to configure port forwarding.  With virt-manager 0.6.1 I added the 
machines, but there I don't see an option for port forwarding.

I would like to reach the VM on a specific port of the host machine. 
Once the machinces are running, I can configure iptables so that the 
port forwarding works, but after host reboots, other rules are 
inserted (put in front of my rules), which disable my rules.  I guess 
these rules are put by libvirt, and so I'm writing to this list.

These are the rules inserted:

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination
ACCEPT     all  --  anywhere             192.168.122.0/24    state 
RELATED,ESTABLISHED
ACCEPT     all  --  192.168.122.0/24     anywhere
ACCEPT     all  --  anywhere             anywhere
REJECT     all  --  anywhere             anywhere 
reject-with icmp-port-unreachable
REJECT     all  --  anywhere             anywhere 
reject-with icmp-port-unreachable

I need to have a different rules for 192.168.122.0/24: the states 
RELATED,ESTABLISHED are fine, but I need the NEW state put there too, 
so that the new forwards can go through.


Thanks,
Irek

-- 
Ireneusz (Irek) Szczesniak
http://www.irkos.org

</body></email><email><emailId>20110428144111</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2011-04-28 14:41:11-0400</timestampReceived><subject>Re: [libvirt-users] port forwarding</subject><body>

On 04/28/2011 09:15 AM, Ireneusz Szcześniak wrote:
&gt; Hi,
&gt;
&gt; I'm using CentOS release 5.6 (Final) and Xen 3.1. I'm writing to ask 
&gt; how to configure port forwarding. With virt-manager 0.6.1 I added the 
&gt; machines, but there I don't see an option for port forwarding.
&gt;
&gt; I would like to reach the VM on a specific port of the host machine. 
&gt; Once the machinces are running, I can configure iptables so that the 
&gt; port forwarding works, but after host reboots, other rules are 
&gt; inserted (put in front of my rules), which disable my rules. I guess 
&gt; these rules are put by libvirt, and so I'm writing to this list.

Yes, these rules are put in by libvirt.

The iptables rules added by libvirt for virtual networks are intended to 
fulfill the needs of 95% of users, but are not configurable. To do what 
you want, you'll either need to construct your own bridge (rather than 
relying on libvirt) and do all the iptables and routing config outside 
of libvirt, or you may be able to use libvirt execution hooks to add the 
rules at the appropriate time. See: http://www.libvirt.org/hooks.html 
for details on libvirt hook scripts.

&gt;
&gt; These are the rules inserted:
&gt;
&gt; Chain FORWARD (policy ACCEPT)
&gt; target prot opt source destination
&gt; ACCEPT all -- anywhere 192.168.122.0/24 state RELATED,ESTABLISHED
&gt; ACCEPT all -- 192.168.122.0/24 anywhere
&gt; ACCEPT all -- anywhere anywhere
&gt; REJECT all -- anywhere anywhere reject-with icmp-port-unreachable
&gt; REJECT all -- anywhere anywhere reject-with icmp-port-unreachable
&gt;
&gt; I need to have a different rules for 192.168.122.0/24: the states 
&gt; RELATED,ESTABLISHED are fine, but I need the NEW state put there too, 
&gt; so that the new forwards can go through.
&gt;
&gt;
&gt; Thanks,
&gt; Irek
&gt;

</body></email><email><emailId>20110428145646</emailId><senderName>Whit Blauvelt</senderName><senderEmail>whit.virt@transpect.com</senderEmail><timestampReceived>2011-04-28 14:56:46-0400</timestampReceived><subject>Re: [libvirt-users] port forwarding</subject><body>

On Thu, Apr 28, 2011 at 10:41:11AM -0400, Laine Stump wrote:
&gt; On 04/28/2011 09:15 AM, Ireneusz Szcześniak wrote:

&gt; &gt;I would like to reach the VM on a specific port of the host
&gt; &gt;machine. Once the machinces are running, I can configure iptables
&gt; &gt;so that the port forwarding works, but after host reboots, other
&gt; &gt;rules are inserted (put in front of my rules), which disable my
&gt; &gt;rules. I guess these rules are put by libvirt, and so I'm writing
&gt; &gt;to this list.
&gt; 
&gt; Yes, these rules are put in by libvirt.
&gt; 
&gt; The iptables rules added by libvirt for virtual networks are
&gt; intended to fulfill the needs of 95% of users, but are not
&gt; configurable. To do what you want, you'll either need to construct
&gt; your own bridge (rather than relying on libvirt) and do all the
&gt; iptables and routing config outside of libvirt, or you may be able
&gt; to use libvirt execution hooks to add the rules at the appropriate
&gt; time. See: http://www.libvirt.org/hooks.html for details on libvirt
&gt; hook scripts.

&gt; &gt;ACCEPT all -- anywhere 192.168.122.0/24 state RELATED,ESTABLISHED

If all you need to do is change that one rule to "NEW,RELATED,ESTABLISHED"
iptables has an option to replace a rule. Sorry I don't have the syntax at
my fingertips, but it should be simple enough to modify the rule on system
startup after libvirt has built the initial ruleset, perhaps in rc.local.

Whit

</body></email><email><emailId>20110428161503</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2011-04-28 16:15:03-0400</timestampReceived><subject>Re: [libvirt-users] port forwarding</subject><body>

On 04/28/2011 10:56 AM, Whit Blauvelt wrote:
&gt; On Thu, Apr 28, 2011 at 10:41:11AM -0400, Laine Stump wrote:
&gt;&gt; On 04/28/2011 09:15 AM, Ireneusz Szcześniak wrote:
&gt;&gt;&gt; I would like to reach the VM on a specific port of the host
&gt;&gt;&gt; machine. Once the machinces are running, I can configure iptables
&gt;&gt;&gt; so that the port forwarding works, but after host reboots, other
&gt;&gt;&gt; rules are inserted (put in front of my rules), which disable my
&gt;&gt;&gt; rules. I guess these rules are put by libvirt, and so I'm writing
&gt;&gt;&gt; to this list.
&gt;&gt; Yes, these rules are put in by libvirt.
&gt;&gt;
&gt;&gt; The iptables rules added by libvirt for virtual networks are
&gt;&gt; intended to fulfill the needs of 95% of users, but are not
&gt;&gt; configurable. To do what you want, you'll either need to construct
&gt;&gt; your own bridge (rather than relying on libvirt) and do all the
&gt;&gt; iptables and routing config outside of libvirt, or you may be able
&gt;&gt; to use libvirt execution hooks to add the rules at the appropriate
&gt;&gt; time. See: http://www.libvirt.org/hooks.html for details on libvirt
&gt;&gt; hook scripts.
&gt;&gt;&gt; ACCEPT all -- anywhere 192.168.122.0/24 state RELATED,ESTABLISHED
&gt; If all you need to do is change that one rule to "NEW,RELATED,ESTABLISHED"
&gt; iptables has an option to replace a rule.

This would have the side effect of generating a warning log the next 
time libvirt brought down the network, and would also leave around the 
old rule (libvirt remove's its rules when the network is stopped by 
describing exactly the rule it created; if that exact rule doesn't exist 
when the network is being stopped, it will give a warning, and also not 
remove this "similar but different" rule).


&gt;   Sorry I don't have the syntax at
&gt; my fingertips, but it should be simple enough to modify the rule on system
&gt; startup after libvirt has built the initial ruleset, perhaps in rc.local.

That would be overridden any time libvirtd was restarted, or the virtual 
network in question was stopped/restarted. That's why I suggested 
looking into libvirt's hooks - with the proper hook, the extra iptables 
commands could happen exactly when needed (I haven't checked to see if 
"the proper hook" exists, but if not then "patches welcome" :-)

&gt; Whit
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110406113330</emailId><senderName>Robert Å mol</senderName><senderEmail>robert.smol@stereoit.com</senderEmail><timestampReceived>2011-04-06 11:33:30-0400</timestampReceived><subject>Re: [libvirt-users] [Libvir] libvirt &amp; vde_switch</subject><body>

On 04/06/2011 10:34 AM, Nicolas Sebrecht wrote:
&gt; The 05/04/11, Robert Å mol wrote:
&gt;
&gt;&gt; I would like to ask about status of VDE and libvirt. I found a
&gt;&gt; thread from http://www.redhat.com/archives/libvir-list/2008-February/msg00030.html.
&gt; AFAIK, vde_switch is still unsupported by libvirt and nobody seems to
&gt; work on it these days.
&gt;
&gt; Most people wanting vde_switch (or open vswitch) enough leave libvirt.
&gt;
On #IRC I got point to message:

http://www.mail-archive.com/libvir-list@redhat.com/msg32081.html

It seems there is a patch ready. I will test it against 0.9.0. What is 
the procedure to get the patch reviewed and eventually get into libvirt? 
I mean VMware has vSwitch and it is very powerful.

I'll checkout the vswitch as well.
&gt;&gt; I am not interested in connecting the VDE to the outside world. I
&gt;&gt; have created a FW machine using macvtap. To this machine I would
&gt;&gt; like to attach machines from different zones (dmz, prod, cust).  I
&gt;&gt; was thinking on using VDE and vlans (FW would have 1 interface in
&gt;&gt; each vlan - machines also), but I am not aware how to configure this
&gt;&gt; in libvirt.
&gt;&gt;
&gt;&gt; I now assume I can do the same setup with regular bridges for the
&gt;&gt; moment
&gt; Yes, this is what I do for now.
&gt;
&gt;&gt;         (benefit of VDE would be only 1 switch for many vlans).
&gt; Plus more features (i.e.: easy virtual switch link between hosts),
&gt; maintenance facilities, etc.
&gt;

-- 
stereoIT - Open Source Technology Partners
http://www.stereoit.com
mobile: +420 776 762378

</body></email><email><emailId>20110406140028</emailId><senderName>Nicolas Sebrecht</senderName><senderEmail>nsebrecht@piing.fr</senderEmail><timestampReceived>2011-04-06 14:00:28-0400</timestampReceived><subject>[libvirt-users]  Re: [Libvir] libvirt &amp; vde_switch</subject><body>

The 06/04/11, Robert Å mol wrote:
&gt; On 04/06/2011 10:34 AM, Nicolas Sebrecht wrote:
&gt; &gt;The 05/04/11, Robert Å mol wrote:
&gt; &gt;
&gt; &gt;&gt;I would like to ask about status of VDE and libvirt. I found a
&gt; &gt;&gt;thread from http://www.redhat.com/archives/libvir-list/2008-February/msg00030.html.
&gt; &gt;AFAIK, vde_switch is still unsupported by libvirt and nobody seems to
&gt; &gt;work on it these days.
&gt; &gt;
&gt; &gt;Most people wanting vde_switch (or open vswitch) enough leave libvirt.
&gt; &gt;
&gt; On #IRC I got point to message:
&gt; 
&gt; http://www.mail-archive.com/libvir-list@redhat.com/msg32081.html
&gt; 
&gt; It seems there is a patch ready. I will test it against 0.9.0. What
&gt; is the procedure to get the patch reviewed and eventually get into
&gt; libvirt?

The patch wasn't merged but the why is a question to the maintainers. I
guess the way it was implemented did not convinced. This is what I
understand from the whole thread, at least.

-- 
Nicolas Sebrecht

</body></email><email><emailId>20110406141331</emailId><senderName>Robert Å mol</senderName><senderEmail>robert.smol@stereoit.com</senderEmail><timestampReceived>2011-04-06 14:13:31-0400</timestampReceived><subject>Re: [libvirt-users] [Libvir] libvirt &amp; vde_switch</subject><body>



On 04/06/2011 04:00 PM, Nicolas Sebrecht wrote:
&gt; The 06/04/11, Robert Å mol wrote:
&gt;&gt; On 04/06/2011 10:34 AM, Nicolas Sebrecht wrote:
&gt;&gt;&gt; The 05/04/11, Robert Å mol wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; I would like to ask about status of VDE and libvirt. I found a
&gt;&gt;&gt;&gt; thread from http://www.redhat.com/archives/libvir-list/2008-February/msg00030.html.
&gt;&gt;&gt; AFAIK, vde_switch is still unsupported by libvirt and nobody seems to
&gt;&gt;&gt; work on it these days.
&gt;&gt;&gt;
&gt;&gt;&gt; Most people wanting vde_switch (or open vswitch) enough leave libvirt.
&gt;&gt;&gt;
&gt;&gt; On #IRC I got point to message:
&gt;&gt;
&gt;&gt; http://www.mail-archive.com/libvir-list@redhat.com/msg32081.html
&gt;&gt;
&gt;&gt; It seems there is a patch ready. I will test it against 0.9.0. What
&gt;&gt; is the procedure to get the patch reviewed and eventually get into
&gt;&gt; libvirt?
&gt; The patch wasn't merged but the why is a question to the maintainers. I
&gt; guess the way it was implemented did not convinced. This is what I
&gt; understand from the whole thread, at least.
&gt;
 From the thread it seems the maintainers would like to have a network 
based on VDE. To me it also looks like better idea (create vde network 
and then just attach the domain to a network.

-- 
stereoIT - Open Source Technology Partners
http://www.stereoit.com
mobile: +420 776 762378

</body></email><email><emailId>20110428135645</emailId><senderName>Robert Å mol</senderName><senderEmail>robert.smol@stereoit.com</senderEmail><timestampReceived>2011-04-28 13:56:45-0400</timestampReceived><subject>Re: [libvirt-users] [Libvir] libvirt &amp; vde_switch</subject><body>

For my needs I would like to see either vdeswitch or openvswitch 
integrated in the project. Is there any preference from the 
users/developers on which one of those I should start looking into?

Also I would like to know how this should be integrated, from the mails 
I can see devs prefers to have virtual switch present as a network. Can 
someone describe how the integration should be done? Support for 
additional features like vlan, QoS?

Robert

On 04/06/2011 04:13 PM, Robert Å mol wrote:
&gt;
&gt;
&gt; On 04/06/2011 04:00 PM, Nicolas Sebrecht wrote:
&gt;&gt; The 06/04/11, Robert Å mol wrote:
&gt;&gt;&gt; On 04/06/2011 10:34 AM, Nicolas Sebrecht wrote:
&gt;&gt;&gt;&gt; The 05/04/11, Robert Å mol wrote:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; I would like to ask about status of VDE and libvirt. I found a
&gt;&gt;&gt;&gt;&gt; thread from 
&gt;&gt;&gt;&gt;&gt; http://www.redhat.com/archives/libvir-list/2008-February/msg00030.html. 
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; AFAIK, vde_switch is still unsupported by libvirt and nobody seems to
&gt;&gt;&gt;&gt; work on it these days.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Most people wanting vde_switch (or open vswitch) enough leave libvirt.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt; On #IRC I got point to message:
&gt;&gt;&gt;
&gt;&gt;&gt; http://www.mail-archive.com/libvir-list@redhat.com/msg32081.html
&gt;&gt;&gt;
&gt;&gt;&gt; It seems there is a patch ready. I will test it against 0.9.0. What
&gt;&gt;&gt; is the procedure to get the patch reviewed and eventually get into
&gt;&gt;&gt; libvirt?
&gt;&gt; The patch wasn't merged but the why is a question to the maintainers. I
&gt;&gt; guess the way it was implemented did not convinced. This is what I
&gt;&gt; understand from the whole thread, at least.
&gt;&gt;
&gt; From the thread it seems the maintainers would like to have a network 
&gt; based on VDE. To me it also looks like better idea (create vde network 
&gt; and then just attach the domain to a network.
&gt;

-- 
stereoIT - Open Source Technology Partners
http://www.stereoit.com
mobile: +420 776 762378

</body></email><email><emailId>20110501212834</emailId><senderName>Robert Å mol</senderName><senderEmail>robert.smol@stereoit.com</senderEmail><timestampReceived>2011-05-01 21:28:34-0400</timestampReceived><subject>Re: [libvirt-users] [Libvir] libvirt &amp; vde_switch</subject><body>



On 04/28/2011 04:35 PM, Laine Stump wrote:
&gt; On 04/28/2011 09:56 AM, Robert Å mol wrote:
&gt;&gt; For my needs I would like to see either vdeswitch or openvswitch 
&gt;&gt; integrated in the project. Is there any preference from the 
&gt;&gt; users/developers on which one of those I should start looking into?
&gt;
&gt; Are you volunteering to write some code? :-)
&gt;
&gt; There have been requests for both, and both should eventually be done, 
&gt; so I guess pick whichever one you like better :-) (since there's 
&gt; already a patch for VDE, albeit with different XML than we'd like, 
&gt; that may be quicker to finish.)
&gt;
&gt; You may want to follow development of the work I'll point out below, 
&gt; though, otherwise you could waste a lot of time.

OK, I'll try to start with vde. I've subscribed now to libvirt-list as well.

&gt;
&gt;&gt;
&gt;&gt; Also I would like to know how this should be integrated, from the 
&gt;&gt; mails I can see devs prefers to have virtual switch present as a 
&gt;&gt; network. Can someone describe how the integration should be done? 
&gt;&gt; Support for additional features like vlan, QoS?
&gt;
&gt; Once we get into these kinds of questions, it's probably best to 
&gt; switch to the developers' list (libvir-list@redhat.com) to get better 
&gt; exposure to people writing the code. I'm Cc'ing this message there 
&gt; (and switching the Reply-To: as well).
&gt;
&gt; In particular, I recently send an RFC to libvir-list proposing an 
&gt; expansion of the &lt;network&gt; XML to remove the hard-coded connection 
&gt; between guest interface and host interface for macvtap (type='direct') 
&gt; interfaces:
&gt;
&gt;    https://www.redhat.com/archives/libvir-list/2011-April/msg00591.html
&gt;
&gt; and in a followup message showed how we could expand on this work to 
&gt; provide support for openvswitch (or vde):
&gt;
&gt;    https://www.redhat.com/archives/libvir-list/2011-April/msg00640.html
&gt;
&gt; I'm planning to have this code finished and tested within the next two 
&gt; months at most (hopefully considerably earlier). If you're interested 
&gt; in implementing a &lt;network type='openvswitch'&gt; or &lt;network type='vde'&gt; 
&gt; you should subscribe to libvir-list (if you aren't already) so that 
&gt; you can follow along.
&gt;
I am now trying to compile the stuff, but I get:
...
   CCLD   libvirt_driver_nwfilter.la
libtool: link: require no space between `-L' and `/usr/lib'
make[3]: *** [libvirt_driver_nwfilter.la] Error 1
make[3]: Leaving directory `/home/rsmol/Code/libvirt/src'
make[2]: *** [all] Error 2
make[2]: Leaving directory `/home/rsmol/Code/libvirt/src'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/home/rsmol/Code/libvirt'
make: *** [all] Error 2
...

But I'll figure out eventually.
&gt;
&gt;&gt;
&gt;&gt; Robert
&gt;&gt;
&gt;&gt; On 04/06/2011 04:13 PM, Robert Å mol wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; On 04/06/2011 04:00 PM, Nicolas Sebrecht wrote:
&gt;&gt;&gt;&gt; The 06/04/11, Robert Å mol wrote:
&gt;&gt;&gt;&gt;&gt; On 04/06/2011 10:34 AM, Nicolas Sebrecht wrote:
&gt;&gt;&gt;&gt;&gt;&gt; The 05/04/11, Robert Å mol wrote:
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; I would like to ask about status of VDE and libvirt. I found a
&gt;&gt;&gt;&gt;&gt;&gt;&gt; thread from 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; http://www.redhat.com/archives/libvir-list/2008-February/msg00030.html. 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; AFAIK, vde_switch is still unsupported by libvirt and nobody 
&gt;&gt;&gt;&gt;&gt;&gt; seems to
&gt;&gt;&gt;&gt;&gt;&gt; work on it these days.
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Most people wanting vde_switch (or open vswitch) enough leave 
&gt;&gt;&gt;&gt;&gt;&gt; libvirt.
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; On #IRC I got point to message:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; http://www.mail-archive.com/libvir-list@redhat.com/msg32081.html
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; It seems there is a patch ready. I will test it against 0.9.0. What
&gt;&gt;&gt;&gt;&gt; is the procedure to get the patch reviewed and eventually get into
&gt;&gt;&gt;&gt;&gt; libvirt?
&gt;&gt;&gt;&gt; The patch wasn't merged but the why is a question to the 
&gt;&gt;&gt;&gt; maintainers. I
&gt;&gt;&gt;&gt; guess the way it was implemented did not convinced. This is what I
&gt;&gt;&gt;&gt; understand from the whole thread, at least.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt; From the thread it seems the maintainers would like to have a 
&gt;&gt;&gt; network based on VDE. To me it also looks like better idea (create 
&gt;&gt;&gt; vde network and then just attach the domain to a network.
&gt;&gt;&gt;
&gt;&gt;
&gt;
&gt;

-- 
stereoIT - Open Source Technology Partners
http://www.stereoit.com
mobile: +420 776 762378

</body></email><email><emailId>20110502062813</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-05-02 06:28:13-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt]  [Libvir] libvirt &amp; vde_switch</subject><body>

2011/5/1 Robert Šmol &lt;robert.smol@stereoit.com&gt;:
&gt; I am now trying to compile the stuff, but I get:
&gt; ...
&gt;  CCLD   libvirt_driver_nwfilter.la
&gt; libtool: link: require no space between `-L' and `/usr/lib'
&gt; make[3]: *** [libvirt_driver_nwfilter.la] Error 1
&gt; make[3]: Leaving directory `/home/rsmol/Code/libvirt/src'
&gt; make[2]: *** [all] Error 2
&gt; make[2]: Leaving directory `/home/rsmol/Code/libvirt/src'
&gt; make[1]: *** [all-recursive] Error 1
&gt; make[1]: Leaving directory `/home/rsmol/Code/libvirt'
&gt; make: *** [all] Error 2
&gt; ...
&gt;
&gt; But I'll figure out eventually.

libtool tells you that if found '-L /usr/lib' in the commandline, but
it would like to see '-L/usr/lib' (without the space). Typically this
comes from a "broken" pkg-config file from one of the libraries
libvirt depends on.

Run 'make V=1' to make it print the complete commandlines, this might
help figuring out from which library the problem comes.

Matthias

</body></email><email><emailId>20110502092154</emailId><senderName>Robert Å mol</senderName><senderEmail>robert.smol@stereoit.com</senderEmail><timestampReceived>2011-05-02 09:21:54-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt]  [Libvir] libvirt &amp; vde_switch</subject><body>



On 05/02/2011 08:28 AM, Matthias Bolte wrote:
&gt; 2011/5/1 Robert Å mol&lt;robert.smol@stereoit.com&gt;:
&gt;&gt; I am now trying to compile the stuff, but I get:
&gt;&gt; ...
&gt;&gt;   CCLD   libvirt_driver_nwfilter.la
&gt;&gt; libtool: link: require no space between `-L' and `/usr/lib'
&gt;&gt; make[3]: *** [libvirt_driver_nwfilter.la] Error 1
&gt;&gt; make[3]: Leaving directory `/home/rsmol/Code/libvirt/src'
&gt;&gt; make[2]: *** [all] Error 2
&gt;&gt; make[2]: Leaving directory `/home/rsmol/Code/libvirt/src'
&gt;&gt; make[1]: *** [all-recursive] Error 1
&gt;&gt; make[1]: Leaving directory `/home/rsmol/Code/libvirt'
&gt;&gt; make: *** [all] Error 2
&gt;&gt; ...
&gt;&gt;
&gt;&gt; But I'll figure out eventually.
&gt; libtool tells you that if found '-L /usr/lib' in the commandline, but
&gt; it would like to see '-L/usr/lib' (without the space). Typically this
&gt; comes from a "broken" pkg-config file from one of the libraries
&gt; libvirt depends on.
&gt;
&gt; Run 'make V=1' to make it print the complete commandlines, this might
&gt; help figuring out from which library the problem comes.
&gt;
&gt; Matthias
&gt;

rsmol@laptop:~/Code/libvirt (git:master)$ pcap-config --libs
-L /usr/lib -lpcap

I filled #775433 on ubuntu for pcap-config. modified pcap-config and now 
I can compile the libvirt just fine. Moving on.

Robert

-- 
stereoIT - Open Source Technology Partners
http://www.stereoit.com
mobile: +420 776 762378

</body></email><email><emailId>20110427185610</emailId><senderName>David Mansfield</senderName><senderEmail>libvirt@dm.cobite.com</senderEmail><timestampReceived>2011-04-27 18:56:10-0400</timestampReceived><subject>Re: [libvirt-users] Disk not bootable from yesterday resolved</subject><body>



On Wed, 2011-04-27 at 07:29 -0700, David Brown wrote:
&gt; Just an update and a thanks.
&gt; 
&gt; 
&gt; The not bootable issue I was having yesterday ended up being for some
&gt; odd reason the disk type in the domain define xml file had been
&gt; switched to the disk being "raw" rather than qcow2 format.  When I
&gt; changed:
&gt; &lt;driver name='qemu' type='raw'/&gt;
&gt; to 
&gt; &lt;driver name='qemu' type='qcow2'/&gt;
&gt; 
&gt; It booted without issue.  I'm not clear how that got changed on the 
&gt; original domain.  It was in use without issue about a week ago. :/
&gt; 
&gt; I then ran the clone again and it cloned fine, but had the boot issue
&gt; again.  I checked the cloned domain.xml file and again it said type
&gt; raw.  I changed it again to qcow2 and it booted fine.
&gt; 
&gt; Bug?  Shouldn't it keep the type in the config the same?
&gt; 
&gt; Anyway, thanks for help and especially the quick
&gt;  responses!
&gt; 

I had this exact thing happen to me when I updated my centos 5.5 to
centos 5.6.  (which goes from libvirt 0.6.something to libvirt
0.6.something, and take each with a grain of salt as Red Hat/Centos  may
ship highly modified versions). 

I'm not sure if the qcow2 changed to raw in the XML during the update,
or if the old version "just worked" with raw, but the new version
doesn't.

David


</body></email><email><emailId>20110426145045</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-04-26 14:50:45-0400</timestampReceived><subject>Re: [libvirt-users] problem installing libvirt from source</subject><body>

2011/4/26 Lars Nordin &lt;lnordin@internap.com&gt;:
&gt; I'm trying to compile and install libvirt-0.9.0 on Ubuntu v10.04. The make
&gt; and install went fine and I don't see any errors but there isn't a libvirt
&gt; directory created in /usr/local/lib/python2.6/dist-packages.
&gt;
&gt;
&gt;
&gt; I specified configure --with-vmware –with-esx   (and later --with-python),
&gt; then make, then sudo make install.
&gt;

Without looking further into it, did you install the python-dev
package? ./configure will disable the Python bindings if it cannot
find the required files. But actually when you explicitly specify
--with-python then ./configure should fail when something is missing.

Did the summary at the end of the ./configure run say "Python: yes"?

Matthias

</body></email><email><emailId>20110426150520</emailId><senderName>Lars Nordin</senderName><senderEmail>lnordin@internap.com</senderEmail><timestampReceived>2011-04-26 15:05:20-0400</timestampReceived><subject>Re: [libvirt-users] problem installing libvirt from source</subject><body>

-----Original Message-----
From: Matthias Bolte [mailto:matthias.bolte@googlemail.com] 

Without looking further into it, did you install the python-dev
package? ./configure will disable the Python bindings if it cannot
find the required files. But actually when you explicitly specify
--with-python then ./configure should fail when something is missing.

Did the summary at the end of the ./configure run say "Python: yes"?
----------------------------------

That was it. Once I installed python-dev and re-ran configure, make and make install \
- I have a libvirt module. Odd that the configure script didn't spit out a warning, \
when I specified "--with-python". Thanks!


</body></email><email><emailId>20110421235640</emailId><senderName>KAMEZAWA Hiroyuki</senderName><senderEmail>kamezawa.hiroyu@jp.fujitsu.com</senderEmail><timestampReceived>2011-04-21 23:56:40-0400</timestampReceived><subject>Re: [libvirt-users] [PATCHv11 3/6] libvirt/qemu - clean up UpdateDevice for consolidation.</subject><body>

On Thu, 21 Apr 2011 15:51:38 -0600
Eric Blake &lt;eblake@redhat.com&gt; wrote:

&gt; On 04/21/2011 01:25 AM, KAMEZAWA Hiroyuki wrote:
&gt; &gt; This patch strips reusable part of qemudDomainUpdateDeviceFlags()
&gt; &gt; and consolidate it to qemudDomainModifyDeviceFlags().
&gt; &gt; No functional changes.
&gt; &gt; 
&gt; &gt; Signed-off-by: KAMEZAWA Hiroyuki &lt;kamezawa.hiroyu@jp.fujitsu.com&gt;
&gt; &gt; 
&gt; &gt; Changelog: v10-&gt;v11
&gt; &gt;   - fixed qemuTeardownDiskCgroup()
&gt; &gt; 
&gt; &gt;  
&gt; &gt; -    virCheckFlags(VIR_DOMAIN_DEVICE_MODIFY_LIVE |
&gt; &gt; -                  VIR_DOMAIN_DEVICE_MODIFY_CONFIG, -1);
&gt; &gt; +    switch (action) {
&gt; &gt; +    case QEMUD_DEVICE_ATTACH:
&gt; &gt; +    case QEMUD_DEVICE_DETACH:
&gt; &gt; +        virCheckFlags(VIR_DOMAIN_DEVICE_MODIFY_LIVE |
&gt; &gt; +                      VIR_DOMAIN_DEVICE_MODIFY_CONFIG, -1);
&gt; &gt; +        break;
&gt; &gt; +    case QEMUD_DEVICE_UPDATE:
&gt; &gt; +        virCheckFlags(VIR_DOMAIN_DEVICE_MODIFY_CURRENT |
&gt; &gt; +                      VIR_DOMAIN_DEVICE_MODIFY_LIVE |
&gt; &gt; +                      VIR_DOMAIN_DEVICE_MODIFY_CONFIG |
&gt; &gt; +                      VIR_DOMAIN_DEVICE_MODIFY_FORCE, -1);
&gt; &gt; +        break;
&gt; &gt; +    default:
&gt; &gt; +        break;
&gt; 
&gt; This lets an invalid action through without warning.  And _CURRENT is 0,
&gt; so it's redundant.  I shrunk it a bit.
&gt; 
Ah, yes. I was wrong.

&gt; More qemud/qemu renaming.
&gt; 
&gt; ACK, and pushed with this squashed in:
&gt; 

Thanks, I'll rework patch 4-6.
-Kame

</body></email><email><emailId>20110422145645</emailId><senderName>David White</senderName><senderEmail>dwhite@speakeasy.net</senderEmail><timestampReceived>2011-04-22 14:56:45-0400</timestampReceived><subject>Re: [libvirt-users] domain not present after shutdown</subject><body>

In fact the domain xml *was* under /etc/libvirt/qemu .   Apparently once 
the domain is 'defined', it is made known by libvirt in some other way, 
but I haven't been able to figure out where that information is stored.

On 04/21/2011 06:11 PM, Osier Yang wrote:
&gt; 于 2011年04月21日 21:20, dave white 写道:
&gt;&gt; nm, got it. Forgot a step
&gt;&gt;
&gt;&gt; virsh define /etc/libvirt/qemu/myguest.xml
&gt;&gt;
&gt;
&gt; Yeah, that was my guessing, shutoff domains on your
&gt; source host are transicient, they don't have domain
&gt; xml store on disk in /etc/libvirt/qemu/
&gt;
&gt; Cheers
&gt; Osier
&gt;&gt; On 04/21/2011 05:47 AM, dave white wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; What do you mean "copy" here?
&gt;&gt;&gt;&gt;
&gt;&gt;&gt; I mean file copy, using scp. I've copied the qcow2 image and the xml
&gt;&gt;&gt; config file.
&gt;&gt;&gt; virt-manager gives me the same result. If I log in to the guest and
&gt;&gt;&gt; shut it down, it disappears from the UI.
&gt;&gt;&gt;
&gt;&gt;&gt; -dmw
&gt;&gt;&gt;
&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt; libvirt-users mailing list
&gt;&gt;&gt; libvirt-users@redhat.com
&gt;&gt;&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110423201431</emailId><senderName>Varun Ganesh</senderName><senderEmail>vganesh2@ncsu.edu</senderEmail><timestampReceived>2011-04-23 20:14:31-0400</timestampReceived><subject>[libvirt-users] PCI Pass through of atheros card</subject><body>

Hi,

I am trying to make a PCI passthrough of the atheros card to a VM running
over KVM. am following the steps given at
http://docs.fedoraproject.org/en-US/Fedora/13/html/Virtualization_Guide/sect-Para-virtualized_Windows_Drivers_Guide-How_SR_IOV_Libvirt_Works.html.
 but am getting the following errors,


   1. Error starting domain: operation failed: failed to retrieve chardev
   info in qemu with 'info chaqdev'
   2. Details:
   3. Error starting domain: operation failed: failed to retrieve chardev
   info in qemu with 'info chaqdev'
   4.
   5. Traceback (most recent call last):
   6.   File "/usr/share/virt-manager/virtManager/asyncjob.py", line 45, in
   cb_wrapper
   7.     callback(asyncjob, *args, **kwargs)
   8.   File "/usr/share/virt-manager/virtManager/engine.py", line 959, in
   asyncfunc
   9.     vm.startup()
   10.   File "/usr/share/virt-manager/virtManager/domain.py", line 1114, in
   startup
   11.     self._backend.create()
   12.   File "/usr/lib/python2.7/site-packages/libvirt.py", line 333, in
   create
   13.     if ret == -1: raise libvirtError ('virDomainCreate() failed',
   dom=self)
   14. libvirtError: operation failed: failed to retrieve chardev info in
   qemu with 'info chaqdev'

I am using a Dell Optiplex XE system which has VT-d enabled and Atheros
AR5001X+ Wireless Network Adapter. How do i rectify this.

Thanks,
sincerely,
Varun Ganesh


[Attachment #3 (text/html)]

Hi,&lt;br&gt;&lt;br&gt;I am trying to make a PCI passthrough of the atheros card to a VM running \
over KVM. am following the steps given at &lt;br&gt;&lt;a \
href="http://docs.fedoraproject.org/en-US/Fedora/13/html/Virtualization_Guide/sect-Par \
a-virtualized_Windows_Drivers_Guide-How_SR_IOV_Libvirt_Works.html"&gt;http://docs.fedorap \
roject.org/en-US/Fedora/13/html/Virtualization_Guide/sect-Para-virtualized_Windows_Drivers_Guide-How_SR_IOV_Libvirt_Works.html&lt;/a&gt;. \
but am getting the following errors, &lt;br&gt;

&lt;br&gt;&lt;div class="text"&gt;&lt;ol&gt;&lt;li class="li1"&gt;&lt;div class="de1"&gt;Error starting domain: \
operation failed: failed to retrieve chardev info in qemu with 'info \
chaqdev'&lt;/div&gt;&lt;/li&gt;&lt;li class="li2"&gt;&lt;div class="de2"&gt;Details:&lt;/div&gt;

&lt;/li&gt;&lt;li class="li1"&gt;&lt;div class="de1"&gt;Error starting domain: operation failed: failed \
to retrieve chardev info in qemu with 'info chaqdev'&lt;/div&gt;&lt;/li&gt;&lt;li \
class="li2"&gt;&lt;div class="de2"&gt; &lt;/div&gt;&lt;/li&gt;&lt;li class="li1"&gt;&lt;div class="de1"&gt;

Traceback (most recent call last):&lt;/div&gt;&lt;/li&gt;&lt;li class="li2"&gt;&lt;div class="de2"&gt;  File \
"/usr/share/virt-manager/virtManager/asyncjob.py", line 45, in \
cb_wrapper&lt;/div&gt;&lt;/li&gt;&lt;li class="li1"&gt;&lt;div class="de1"&gt;    callback(asyncjob, *args, \
**kwargs)&lt;/div&gt;

&lt;/li&gt;&lt;li class="li2"&gt;&lt;div class="de2"&gt;  File \
"/usr/share/virt-manager/virtManager/engine.py", line 959, in \
asyncfunc&lt;/div&gt;&lt;/li&gt;&lt;li class="li1"&gt;&lt;div class="de1"&gt;    vm.startup()&lt;/div&gt;&lt;/li&gt;&lt;li \
class="li2"&gt;&lt;div class="de2"&gt;

  File "/usr/share/virt-manager/virtManager/domain.py", line 1114, in \
startup&lt;/div&gt;&lt;/li&gt;&lt;li class="li1"&gt;&lt;div class="de1"&gt;    \
self._backend.create()&lt;/div&gt;&lt;/li&gt;&lt;li class="li2"&gt;&lt;div class="de2"&gt;  File \
"/usr/lib/python2.7/site-packages/libvirt.py", line 333, in create&lt;/div&gt;

&lt;/li&gt;&lt;li class="li1"&gt;&lt;div class="de1"&gt;    if ret == -1: raise libvirtError \
('virDomainCreate() failed', dom=self)&lt;/div&gt;&lt;/li&gt;&lt;li class="li2"&gt;&lt;div \
class="de2"&gt;libvirtError: operation failed: failed to retrieve chardev info in qemu \
with 'info chaqdev'&lt;/div&gt;

&lt;/li&gt;&lt;/ol&gt;I am using a Dell Optiplex XE system which has VT-d enabled and Atheros \
AR5001X+ Wireless Network Adapter. How do i rectify \
this.&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;sincerely,&lt;br&gt;Varun Ganesh&lt;br&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110423205454</emailId><senderName>Whit Blauvelt</senderName><senderEmail>whit.virt@transpect.com</senderEmail><timestampReceived>2011-04-23 20:54:54-0400</timestampReceived><subject>[libvirt-users] 2 hosts, mirrored VM storage, avoiding conflicting VM instances</subject><body>

Hi,

Using libvirt for KVM, experimenting with live migration with the VM on
storage shared in a mirrored GlusterFS or an active-active DRBD setup where
QEMU/KVM runs on the hosts on both sides of the mirror, the live migration
works great. What concerns me is finding a way if possible to prevent a
situation where a particular VM is running on both hosts at once. Is there
any way within libvirt in this sort of setup to start a VM on mirrored
storage from a KVM host on one side of the mirror _only if_ the same VM
isn't already running on the other side of the mirror?

In a scripting context I can see how to do that check before starting, but
not how to prevent virsh or virt-manager from being used to create this bad
condition when they're being used directly. Is there some way to set up
protection from this within virsh and virt-manager? Or am I into feature
request territory? Or is there some other layer at which this can be
accomplished?

In active-passive DRBD this wouldn't be a danger, since only the active
system can see the storage to start the VM. But that wouldn't support live
migration. Part of the danger can be avoided by using stonith in failover,
but it would be nice to find a more fine-grained, subtle approach.

Best,
Whit

</body></email><email><emailId>20110424083132</emailId><senderName>Zvi Dubitzky</senderName><senderEmail>dubi@il.ibm.com</senderEmail><timestampReceived>2011-04-24 08:31:32-0400</timestampReceived><subject>[libvirt-users] vvirsh memtune</subject><body>

Hi

Does anybody use the 'virsh memtune'  command and can he say  what 
combination
of libvirt version and libcgroup does   he use

thanks

Zvi Dubitzky 
Email:dubi@il.ibm.com

</body></email><email><emailId>20110424215417</emailId><senderName>Matthew Macdonald-Wallace</senderName><senderEmail>lists@truthisfreedom.org.uk</senderEmail><timestampReceived>2011-04-24 21:54:17-0400</timestampReceived><subject>Re: [libvirt-users] Setup Mulitple VM's</subject><body>

On Fri, 2011-04-22 at 10:04 -0400, ssaleh@nrln.us wrote:
&gt; I have a small public IP block (/29) I'd like to populate with VM's from a single \
&gt; physical box running CentOS/5.  I'd like to get some thoughts on the best way to \
&gt; setup networking to support this.  I'm OK with setting up the virtual hosts. 
&gt; Any advice would be appreciated.
&gt; 
&gt; TIA...

Hi,

We use a physical bridge adapter to place the Vhosts directly onto the
Physical LAN (we firewall appropriately on the VHosts themselves).

This works fine for us, however as we're really only working in RFC1918
address space on the LAN, YMMV.

The alternative would be to use the Physical host as a firewall/NAT/load
balancer style device and have a setup similar to the following:

pub.lic.ip.range/29
     |
     |
+-------------------------+
&gt; Physical Host           |
&gt; eth0   = 1.2.3.4        |
&gt; eth0:1 = 1.2.3.5        |
&gt; eth0:2 = 1.2.3.6        |
&gt; br0    = 192.168.32.254 |
+-------------------------+
     |
     |
RFC1918 Address Space
     |
     |
+-----------------------+
&gt; VHOST1 (192.168.32.4) |
+-----------------------+
+-----------------------+
&gt; VHOST2 (192.168.32.5) |
+-----------------------+
+-----------------------+
&gt; VHOST3 (192.168.32.6) |
+-----------------------+

You could then firewall/NAT/Forward traffic from the pubic /29 to the
private /32 (or whatever you choose!) mapping ip addresses or ports as
you go.

This will require greater configuration of the physical host however it
also enables you to firewall on both the public and private LANS.

HTH,

Matt


</body></email><email><emailId>20110425141506</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-04-25 14:15:06-0400</timestampReceived><subject>Re: [libvirt-users] Media autoremove</subject><body>

于 2011年04月23日 17:35, Nikita A Menkovich 写道:
&gt; I have an iso, than automate freebsd install, and after installation
&gt; it reboot VM.
&gt; I want to remove cdrom drive with ISO from VM config after reboot?
&gt; How I could do this?
&gt;
&gt;

virsh detach-disk/detach-device will work, or if you just want to
eject the cd, virsh update-device will also work.

Regards
Osier

</body></email><email><emailId>20110425142117</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-04-25 14:21:17-0400</timestampReceived><subject>Re: [libvirt-users] problem with qemu</subject><body>

于 2011年04月25日 03:55, Miroslav Ludvik 写道:
&gt; Hi All,
&gt;
&gt; I use Ubuntu server 10.04 LTS as virtualization platform.
&gt;
&gt; Actually running kernel 2.6.32-31-server #61-Ubuntu S
&gt;
&gt; root@jupiter:~# uname -a
&gt; Linux jupiter 2.6.32-31-server #61-Ubuntu SMP Fri Apr 8 19:44:42 UTC
&gt; 2011 x86_64 GNU/Linux
&gt;
&gt; We have on running virtual
&gt; root@jupiter:~# virsh list --all
&gt;   Id Name                 State
&gt; ----------------------------------
&gt;    1 kvmtik.4safety.cz    running
&gt;
&gt;
&gt; I run script for create virtual system wrote
&gt;
&gt; root@jupiter:~# make-hestia.4safety.cz.sh
&gt; 2011-04-24 21:13:25,613 ERROR   : ubuntu-kvm already exists
&gt; Traceback (most recent call last):
&gt;    File "/usr/bin/vmbuilder", line 24, in&lt;module&gt;
&gt;      cli.main()
&gt;    File "/usr/lib/python2.6/dist-packages/VMBuilder/contrib/cli.py", line
&gt; 81, in main
&gt;      raise VMBuilderUserError('%s already exists' % destdir)
&gt; VMBuilder.exception.VMBuilderUserError: ubuntu-kvm already exists
&gt; /usr/local/bin/make-hestia.4safety.cz.sh: line 29:
&gt; --libvirt=qemu:///system: No such file or directory
&gt;
&gt; I try restart libvirt and system wrote  to syslog
&gt;
&gt; root@jupiter:~# /etc/init.d/libvirt-bin restart
&gt; Rather than invoking init scripts through /etc/init.d, use the service(8)
&gt; utility, e.g. service libvirt-bin restart
&gt;
&gt; Since the script you are attempting to invoke has been converted to an
&gt; Upstart job, you may also use the restart(8) utility, e.g. restart
&gt; libvirt-bin
&gt; libvirt-bin start/running, process 25202
&gt; root@jupiter:~# tail -f /var/log/syslog
&gt; Apr 24 20:25:01 jupiter CRON[25031]: (root) CMD (command -v debian-sa1&gt;
&gt; /dev/null&amp;&amp;  debian-sa1 1 1)
&gt; Apr 24 20:35:01 jupiter CRON[25036]: (root) CMD (command -v debian-sa1&gt;
&gt; /dev/null&amp;&amp;  debian-sa1 1 1)
&gt; Apr 24 20:45:01 jupiter CRON[25042]: (root) CMD (command -v debian-sa1&gt;
&gt; /dev/null&amp;&amp;  debian-sa1 1 1)
&gt; Apr 24 20:55:01 jupiter CRON[25048]: (root) CMD (command -v debian-sa1&gt;
&gt; /dev/null&amp;&amp;  debian-sa1 1 1)
&gt; Apr 24 21:05:01 jupiter CRON[25152]: (root) CMD (command -v debian-sa1&gt;
&gt; /dev/null&amp;&amp;  debian-sa1 1 1)
&gt; Apr 24 21:15:01 jupiter CRON[25183]: (root) CMD (command -v debian-sa1&gt;
&gt; /dev/null&amp;&amp;  debian-sa1 1 1)
&gt; Apr 24 21:17:01 jupiter CRON[25189]: (root) CMD (   cd /&amp;&amp;  run-parts
&gt; --report /etc/cron.hourly)
&gt; Apr 24 21:17:58 jupiter libvirtd: 21:17:58.089: warning :
&gt; qemudDispatchSignalEvent:385 : Shutting down on signal 15
&gt; Apr 24 21:17:58 jupiter libvirtd: 21:17:58.617: error :
&gt; udevStrToLong_ui:73 : Failed to convert '008' to unsigned int#012
&gt; Apr 24 21:17:59 jupiter kernel: [106086.771154] lo: Disabled Privacy
&gt; Extensions

It looks to me the error in log doesn't relates to your problem,
more like the problem of your scripts I guess. :)

Regards
Osier

</body></email><email><emailId>20110426110241</emailId><senderName>oPKo o</senderName><senderEmail>opko@hotmail.com</senderEmail><timestampReceived>2011-04-26 11:02:41-0400</timestampReceived><subject>[libvirt-users] How to providing virtual USB disk (usb-storage for QEMU) devices to guests?</subject><body>

Hi,
I am trying to provide virtual USB disk devices to guests but without success. With \
QEMU is simple to plug the virtual USB disk with the command:

(qemu) drive_add 0 id=my_usb_disk,if=none,file=usbdisk.img
OK
(qemu) device_add usb-storage,id=my_usb_disk,drive=my_usb_dis

I can do this with libvirt?

PK

PS: sorry for my poor english

 		 	   		  


[Attachment #3 (text/html)]

&lt;html&gt;
&lt;head&gt;
&lt;style&gt;&lt;!--
.hmmessage P
{
margin:0px;
padding:0px
}
body.hmmessage
{
font-size: 10pt;
font-family:Tahoma
}
--&gt;&lt;/style&gt;
&lt;/head&gt;
&lt;body class='hmmessage'&gt;
&lt;pre style="margin: 0em;"&gt;Hi,&lt;br&gt;I am trying to provide virtual USB disk devices to \
guests but without success. With QEMU is simple to plug the virtual USB disk with the \
command:&lt;br&gt;&lt;br&gt;(qemu) drive_add 0 \
id=my_usb_disk,if=none,file=usbdisk.img&lt;br&gt;OK&lt;br&gt;(qemu) device_add \
usb-storage,id=my_usb_disk,drive=my_usb_dis&lt;br&gt;&lt;br&gt;I can do this with \
libvirt?&lt;br&gt;&lt;br&gt;PK&lt;br&gt;&lt;br&gt;PS: sorry for my poor english&lt;br&gt;&lt;br&gt;&lt;/pre&gt;&lt;tt&gt;&lt;/tt&gt; 		 	   \
&lt;/body&gt; &lt;/html&gt;



</body></email><email><emailId>20110426131937</emailId><senderName>Jan</senderName><senderEmail>jan@agetty.de</senderEmail><timestampReceived>2011-04-26 13:19:37-0400</timestampReceived><subject>Re: [libvirt-users] Adding more disks...</subject><body>

Hi Dale,

On 04/25/2011 09:13 AM Dale Amon wrote:
&gt; I did not find documentation but I managed by 
&gt; guessing:
&gt; 
&gt; &lt;target dev='sde' bus='scsi' /&gt;
&gt; 
&gt; did the trick. Is this stuff fully documented
&gt; anywhere?

I got the following ...

"The dev attribute indicates the "logical" device name. The actual device
name specified is not guaranteed to map to the device name in the guest OS.
Treat it as a device ordering hint."

... from here:

http://libvirt.org/formatdomain.html#elementsDisks

Cheers
Jan

</body></email><email><emailId>20110427025408</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-04-27 02:54:08-0400</timestampReceived><subject>Re: [libvirt-users] virt-image issue</subject><body>

于 2011年04月26日 04:59, Zvi Dubitzky 写道:
&gt; Hi
&gt;
&gt; Does anybody work with the virt-image utility.
&gt; - I do not see where/how  one specifies the pre-defned image  or the CD
&gt; iso image to produce the image from
&gt; - what is the .xml file requested for ? I guess  it is  the output xml
&gt; file
&gt;
&gt; I just used the command with an existing .xml file (thought the utility
&gt; will modify it according to the specified flags)
&gt; but got the error message :
&gt; "ERROR    Cannot parse 'vmTest3.xml': Root element is not 'image"
&gt;

The required xml is not libvirt domain xml, but an xml with root
element "&lt;image&gt;" (which is called "virt-image" format), virt-image
somehow is an succession of virt-convert. E.g. you can convert
VMware vm in vmx format to "virt-image" format first, and then
use virt-image to create the VM under kvm.

Regards
Osier

</body></email><email><emailId>20110427031202</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-04-27 03:12:02-0400</timestampReceived><subject>Re: [libvirt-users] virt-clone: clone not bootable</subject><body>

于 2011年04月27日 06:19, David Brown 写道:
&gt; It says:
&gt; booting from hard disk
&gt; Booting failed device not bootable
&gt; FATAL: failed to boot from device.
&gt;

This means you have succeeded in defining the guest, however,
it failed to startup. Perhaps having a look at the domain xml
will help. And are you sure the domain before converted
could be startup successfully?

&gt; Or something very similar.
&gt;
&gt; Whit Blauvelt&lt;whit.virt@transpect.com&gt;  wrote:
&gt;
&gt;&gt; On Tue, Apr 26, 2011 at 01:45:23PM -0700, David Brown wrote:
&gt;&gt;&gt;     The clone was made with the following command: virt-clone -o centos -n
&gt;&gt;&gt;     centosclone -f /path/to/new/image.img
&gt;&gt;&gt;     I've attempted it several times and get the same result.
&gt;&gt;&gt;     Has anyone seen this or know how to resolve it?
&gt;&gt;
&gt;&gt; I've often cloned CentOS 5.5 KVM VMs with that same invocation, and no
&gt;&gt; problem.
&gt;&gt;
&gt;&gt; When you say it's "not bootable," what exactly do you see at time of
&gt;&gt; failure?
&gt;&gt;
&gt;&gt; Whit
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110427105327</emailId><senderName>Maciej_Ga³kiewicz</senderName><senderEmail>maciej.galkiewicz@gmail.com</senderEmail><timestampReceived>2011-04-27 10:53:27-0400</timestampReceived><subject>Re: [libvirt-users] Listing machines as non-root user</subject><body>

2011/4/27 Jan &lt;jan@agetty.de&gt;

&gt; Could you please have a look at the permissions of the xend sockets under
&gt; /var/run/xend/*? Since virsh is being executed with the the privileges of
&gt; the currently logged on user, the driver might not be able to access the
&gt; respective socket for reading which causes the driver .
&gt;

# ls -la
total 4.0K
drwx------  3 root root   54 Apr  3 07:09 .
drwxr-xr-x 19 root root 4.0K Apr 26 00:18 ..
drwx------  2 root root    6 Nov 24 15:56 boot
srwxr-xr-x  1 root root    0 Apr  3 07:09 xen-api.sock
srwxr-xr-x  1 root root    0 Apr  3 07:09 xmlrpc.sock

regards
Maciej

[Attachment #3 (text/html)]

&lt;div class="gmail_quote"&gt;2011/4/27 Jan &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:jan@agetty.de"&gt;jan@agetty.de&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt; &lt;div class="im"&gt;Could you please have a look at the \
                permissions of the xend sockets under&lt;/div&gt;
/var/run/xend/*? Since virsh is being executed with the the privileges of&lt;br&gt;
the currently logged on user, the driver might not be able to access the&lt;br&gt;
respective socket for reading which causes the driver .&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;# ls -la&lt;/div&gt;&lt;div&gt;total \
4.0K&lt;/div&gt;&lt;div&gt;drwx------  3 root root   54 Apr  3 07:09 .&lt;/div&gt;&lt;div&gt;drwxr-xr-x 19 \
root root 4.0K Apr 26 00:18 ..&lt;/div&gt;&lt;div&gt;drwx------  2 root root    6 Nov 24 15:56 \
boot&lt;/div&gt; &lt;div&gt;srwxr-xr-x  1 root root    0 Apr  3 07:09 \
xen-api.sock&lt;/div&gt;&lt;div&gt;srwxr-xr-x  1 root root    0 Apr  3 07:09 \
xmlrpc.sock&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;regards&lt;/div&gt;&lt;div&gt;Maciej&lt;/div&gt;



</body></email><email><emailId>20110427131339</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-04-27 13:13:39-0400</timestampReceived><subject>Re: [libvirt-users] problem installing libvirt from source</subject><body>

于 2011年04月26日 23:05, Lars Nordin 写道:
&gt; -----Original Message-----
&gt; From: Matthias Bolte [mailto:matthias.bolte@googlemail.com]
&gt; 
&gt; Without looking further into it, did you install the python-dev
&gt; package? ./configure will disable the Python bindings if it cannot
&gt; find the required files. But actually when you explicitly specify
&gt; --with-python then ./configure should fail when something is missing.
&gt; 
&gt; Did the summary at the end of the ./configure run say "Python: yes"?
&gt; ----------------------------------
&gt; 
&gt; That was it. Once I installed python-dev and re-ran configure, make and make \
&gt; install - I have a libvirt module. Odd that the configure script didn't spit out a \
&gt; warning, when I specified "--with-python". Thanks!

This is fixed upstream:

https://www.redhat.com/archives/libvir-list/2011-April/msg01148.html

Regards
Osier
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users


</body></email><email><emailId>20110427194030</emailId><senderName>David Mansfield</senderName><senderEmail>libvirt@dm.cobite.com</senderEmail><timestampReceived>2011-04-27 19:40:30-0400</timestampReceived><subject>Re: [libvirt-users] Disk not bootable from yesterday resolved</subject><body>




David




On Wed, 2011-04-27 at 14:56 -0400, David Mansfield wrote:
&gt; 
&gt; On Wed, 2011-04-27 at 07:29 -0700, David Brown wrote:
&gt; &gt; Just an update and a thanks.
&gt; &gt; 
&gt; &gt; 
&gt; &gt; The not bootable issue I was having yesterday ended up being for some
&gt; &gt; odd reason the disk type in the domain define xml file had been
&gt; &gt; switched to the disk being "raw" rather than qcow2 format.  When I
&gt; &gt; changed:
&gt; &gt; &lt;driver name='qemu' type='raw'/&gt;
&gt; &gt; to 
&gt; &gt; &lt;driver name='qemu' type='qcow2'/&gt;
&gt; &gt; 
&gt; &gt; It booted without issue.  I'm not clear how that got changed on the 
&gt; &gt; original domain.  It was in use without issue about a week ago. :/
&gt; &gt; 
&gt; &gt; I then ran the clone again and it cloned fine, but had the boot issue
&gt; &gt; again.  I checked the cloned domain.xml file and again it said type
&gt; &gt; raw.  I changed it again to qcow2 and it booted fine.
&gt; &gt; 
&gt; &gt; Bug?  Shouldn't it keep the type in the config the same?
&gt; &gt; 
&gt; &gt; Anyway, thanks for help and especially the quick
&gt; &gt;  responses!
&gt; &gt; 
&gt; 
&gt; I had this exact thing happen to me when I updated my centos 5.5 to
&gt; centos 5.6.  (which goes from libvirt 0.6.something to libvirt
&gt; 0.6.something, and take each with a grain of salt as Red Hat/Centos  may
&gt; ship highly modified versions). 
&gt; 
&gt; I'm not sure if the qcow2 changed to raw in the XML during the update,
&gt; or if the old version "just worked" with raw, but the new version
&gt; doesn't.
&gt; 
&gt; David
&gt; 
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110428143545</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2011-04-28 14:35:45-0400</timestampReceived><subject>Re: [libvirt-users] [Libvir] libvirt &amp; vde_switch</subject><body>

On 04/28/2011 09:56 AM, Robert Å mol wrote:
&gt; For my needs I would like to see either vdeswitch or openvswitch 
&gt; integrated in the project. Is there any preference from the 
&gt; users/developers on which one of those I should start looking into?

Are you volunteering to write some code? :-)

There have been requests for both, and both should eventually be done, 
so I guess pick whichever one you like better :-) (since there's already 
a patch for VDE, albeit with different XML than we'd like, that may be 
quicker to finish.)

You may want to follow development of the work I'll point out below, 
though, otherwise you could waste a lot of time.

&gt;
&gt; Also I would like to know how this should be integrated, from the 
&gt; mails I can see devs prefers to have virtual switch present as a 
&gt; network. Can someone describe how the integration should be done? 
&gt; Support for additional features like vlan, QoS?

Once we get into these kinds of questions, it's probably best to switch 
to the developers' list (libvir-list@redhat.com) to get better exposure 
to people writing the code. I'm Cc'ing this message there (and switching 
the Reply-To: as well).

In particular, I recently send an RFC to libvir-list proposing an 
expansion of the &lt;network&gt; XML to remove the hard-coded connection 
between guest interface and host interface for macvtap (type='direct') 
interfaces:

    https://www.redhat.com/archives/libvir-list/2011-April/msg00591.html

and in a followup message showed how we could expand on this work to 
provide support for openvswitch (or vde):

    https://www.redhat.com/archives/libvir-list/2011-April/msg00640.html

I'm planning to have this code finished and tested within the next two 
months at most (hopefully considerably earlier). If you're interested in 
implementing a &lt;network type='openvswitch'&gt; or &lt;network type='vde'&gt; you 
should subscribe to libvir-list (if you aren't already) so that you can 
follow along.


&gt;
&gt; Robert
&gt;
&gt; On 04/06/2011 04:13 PM, Robert Å mol wrote:
&gt;&gt;
&gt;&gt;
&gt;&gt; On 04/06/2011 04:00 PM, Nicolas Sebrecht wrote:
&gt;&gt;&gt; The 06/04/11, Robert Å mol wrote:
&gt;&gt;&gt;&gt; On 04/06/2011 10:34 AM, Nicolas Sebrecht wrote:
&gt;&gt;&gt;&gt;&gt; The 05/04/11, Robert Å mol wrote:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; I would like to ask about status of VDE and libvirt. I found a
&gt;&gt;&gt;&gt;&gt;&gt; thread from 
&gt;&gt;&gt;&gt;&gt;&gt; http://www.redhat.com/archives/libvir-list/2008-February/msg00030.html. 
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; AFAIK, vde_switch is still unsupported by libvirt and nobody seems to
&gt;&gt;&gt;&gt;&gt; work on it these days.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Most people wanting vde_switch (or open vswitch) enough leave 
&gt;&gt;&gt;&gt;&gt; libvirt.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; On #IRC I got point to message:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; http://www.mail-archive.com/libvir-list@redhat.com/msg32081.html
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; It seems there is a patch ready. I will test it against 0.9.0. What
&gt;&gt;&gt;&gt; is the procedure to get the patch reviewed and eventually get into
&gt;&gt;&gt;&gt; libvirt?
&gt;&gt;&gt; The patch wasn't merged but the why is a question to the maintainers. I
&gt;&gt;&gt; guess the way it was implemented did not convinced. This is what I
&gt;&gt;&gt; understand from the whole thread, at least.
&gt;&gt;&gt;
&gt;&gt; From the thread it seems the maintainers would like to have a network 
&gt;&gt; based on VDE. To me it also looks like better idea (create vde 
&gt;&gt; network and then just attach the domain to a network.
&gt;&gt;
&gt;

</body></email><email><emailId>20110428200130</emailId><senderName>Ireneusz Szcześniak</senderName><senderEmail>irek.szczesniak@gmail.com</senderEmail><timestampReceived>2011-04-28 20:01:30-0400</timestampReceived><subject>Re: [libvirt-users] port forwarding</subject><body>

Hi Laine and Whit,

Thank you for the information.  I will look into hooks -- this looks 
like the right choice.


Best,
Irek

On 28.04.2011 18:15, Laine Stump wrote:
&gt; On 04/28/2011 10:56 AM, Whit Blauvelt wrote:
&gt;&gt; On Thu, Apr 28, 2011 at 10:41:11AM -0400, Laine Stump wrote:
&gt;&gt;&gt; On 04/28/2011 09:15 AM, Ireneusz Szcześniak wrote:
&gt;&gt;&gt;&gt; I would like to reach the VM on a specific port of the host
&gt;&gt;&gt;&gt; machine. Once the machinces are running, I can configure iptables
&gt;&gt;&gt;&gt; so that the port forwarding works, but after host reboots, other
&gt;&gt;&gt;&gt; rules are inserted (put in front of my rules), which disable my
&gt;&gt;&gt;&gt; rules. I guess these rules are put by libvirt, and so I'm writing
&gt;&gt;&gt;&gt; to this list.
&gt;&gt;&gt; Yes, these rules are put in by libvirt.
&gt;&gt;&gt;
&gt;&gt;&gt; The iptables rules added by libvirt for virtual networks are
&gt;&gt;&gt; intended to fulfill the needs of 95% of users, but are not
&gt;&gt;&gt; configurable. To do what you want, you'll either need to construct
&gt;&gt;&gt; your own bridge (rather than relying on libvirt) and do all the
&gt;&gt;&gt; iptables and routing config outside of libvirt, or you may be able
&gt;&gt;&gt; to use libvirt execution hooks to add the rules at the appropriate
&gt;&gt;&gt; time. See: http://www.libvirt.org/hooks.html for details on libvirt
&gt;&gt;&gt; hook scripts.
&gt;&gt;&gt;&gt; ACCEPT all -- anywhere 192.168.122.0/24 state RELATED,ESTABLISHED
&gt;&gt; If all you need to do is change that one rule to
&gt;&gt; "NEW,RELATED,ESTABLISHED"
&gt;&gt; iptables has an option to replace a rule.
&gt;
&gt; This would have the side effect of generating a warning log the next
&gt; time libvirt brought down the network, and would also leave around the
&gt; old rule (libvirt remove's its rules when the network is stopped by
&gt; describing exactly the rule it created; if that exact rule doesn't exist
&gt; when the network is being stopped, it will give a warning, and also not
&gt; remove this "similar but different" rule).
&gt;
&gt;
&gt;&gt; Sorry I don't have the syntax at
&gt;&gt; my fingertips, but it should be simple enough to modify the rule on
&gt;&gt; system
&gt;&gt; startup after libvirt has built the initial ruleset, perhaps in rc.local.
&gt;
&gt; That would be overridden any time libvirtd was restarted, or the virtual
&gt; network in question was stopped/restarted. That's why I suggested
&gt; looking into libvirt's hooks - with the proper hook, the extra iptables
&gt; commands could happen exactly when needed (I haven't checked to see if
&gt; "the proper hook" exists, but if not then "patches welcome" :-)
&gt;
&gt;&gt; Whit
&gt;&gt; _______________________________________________
&gt;&gt; libvirt-users mailing list
&gt;&gt; libvirt-users@redhat.com
&gt;&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users


-- 
Ireneusz (Irek) Szczesniak
http://www.irkos.org

</body></email><email><emailId>20110312153320</emailId><senderName>SAURAV LAHIRI</senderName><senderEmail>saurav_lahiri@yahoo.com</senderEmail><timestampReceived>2011-03-12 15:33:20-0400</timestampReceived><subject>[libvirt-users] Issue creating vm channel</subject><body>

Hello,
I am trying to create a lucid guest VM with a vmchannel between the guest and the \
hypervisor. Details below:

KERNEL:
# uname -a
Linux saurav-desktop 2.6.38-2-generic #29~lucid1-Ubuntu SMP Mon Feb 7 13:35:14 UTC \
2011 i686 GNU/Linux

QEMU:
# /usr/bin/qemu --version
QEMU emulator version 0.13.0, Copyright (c) 2003-2008 Fabrice Bellard

LIBVIRT:
# /usr/sbin/libvirtd --version
/usr/local/sbin/libvirtd (libvirt) 0.8.8


Below is a snippet of my libvirt xml file.

===============================================================
&lt;domain type='kvm' id='16'&gt;
  &lt;name&gt;FinalTest&lt;/name&gt;
  &lt;uuid&gt;212bc1f1-b4f7-1ed3-7dc3-2b4b82ab68d1&lt;/uuid&gt;
  &lt;memory&gt;1048576&lt;/memory&gt;
  &lt;currentMemory&gt;1048576&lt;/currentMemory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='x86_64' machine='pc-0.12'&gt;hvm&lt;/type&gt;
    &lt;boot dev='hd'/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
    &lt;apic/&gt;
    &lt;pae/&gt;
  &lt;/features&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;destroy&lt;/on_reboot&gt;
  &lt;on_crash&gt;destroy&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;

&lt;controller type='virtio-serial' index='0' max_ports='15' vectors='4'/&gt;
&lt;channel type='pty'&gt;
  &lt;target type='virtio' name='org.linux-kvm.port.1'/&gt;
 &lt;address type='virtio-serial' controller='0' bus='0'/&gt;
&lt;/channel&gt;

    &lt;disk type='file' device='disk'&gt;
      &lt;driver name='qemu' type='qcow2'/&gt;
      &lt;source file='/home/user1/linux_installed/image.cow2'/&gt;
      &lt;target dev='hda' bus='ide'/&gt;
      &lt;alias name='ide-disk0'/&gt;
        &lt;address type='drive' controller='0' bus='0' unit='0'/&gt;
    &lt;/disk&gt;
================================================================

When i submit the xml file to virsh I get the following error:

===============================================================
# virsh create vmTemplete-1.xml 
error: Failed to create domain from vmTemplete-1.xml
error: internal error Process exited while reading console log output: char device \
redirected to /dev/pts/3 char device redirected to /dev/pts/4
open /dev/kvm: No such file or directory
Could not initialize KVM, will disable KVM support
kvm: -device virtserialport,bus=virtio-serial0.0,nr=1,chardev=charchannel0,id=channel0,name=org.linux-kvm.port.1: \
virtio-serial-bus: Out-of-range port id specified, max. allowed: 0

kvm: -device virtserialport,bus=virtio-serial0.0,nr=1,chardev=charchannel0,id=channel0,name=org.linux-kvm.port.1: \
Device 'virtserialport' could not be initialized

===========================================================

What could be the problem ? Could any one please point to the correct direction with \
regard to this.

Regards
sl




      


[Attachment #3 (text/html)]

&lt;table cellspacing="0" cellpadding="0" border="0" &gt;&lt;tr&gt;&lt;td valign="top" style="font: \
inherit;"&gt;Hello,&lt;br&gt;I am trying to create a lucid guest VM with a vmchannel between \
the guest and the hypervisor. Details below:&lt;br&gt;&lt;br&gt;KERNEL:&lt;br&gt;# uname -a&lt;br&gt;Linux \
saurav-desktop 2.6.38-2-generic #29~lucid1-Ubuntu SMP Mon Feb 7 13:35:14 UTC 2011 \
i686 GNU/Linux&lt;br&gt;&lt;br&gt;QEMU:&lt;br&gt;# /usr/bin/qemu --version&lt;br&gt;QEMU emulator version \
0.13.0, Copyright (c) 2003-2008 Fabrice Bellard&lt;br&gt;&lt;br&gt;LIBVIRT:&lt;br&gt;# \
/usr/sbin/libvirtd --version&lt;br&gt;/usr/local/sbin/libvirtd (libvirt) \
0.8.8&lt;br&gt;&lt;br&gt;&lt;br&gt;Below is a snippet of my libvirt xml \
file.&lt;br&gt;&lt;br&gt;===============================================================&lt;br&gt;&lt;domain \
type='kvm' id='16'&gt;&lt;br&gt;  &lt;name&gt;FinalTest&lt;/name&gt;&lt;br&gt;  \
&lt;uuid&gt;212bc1f1-b4f7-1ed3-7dc3-2b4b82ab68d1&lt;/uuid&gt;&lt;br&gt;  \
&lt;memory&gt;1048576&lt;/memory&gt;&lt;br&gt;  \
&lt;currentMemory&gt;1048576&lt;/currentMemory&gt;&lt;br&gt;   \
&lt;vcpu&gt;1&lt;/vcpu&gt;&lt;br&gt;  &lt;os&gt;&lt;br&gt;    &lt;type \
arch='x86_64' machine='pc-0.12'&gt;hvm&lt;/type&gt;&lt;br&gt;    &lt;boot \
dev='hd'/&gt;&lt;br&gt;  &lt;/os&gt;&lt;br&gt;  &lt;features&gt;&lt;br&gt;    \
&lt;acpi/&gt;&lt;br&gt;    &lt;apic/&gt;&lt;br&gt;    \
&lt;pae/&gt;&lt;br&gt;  &lt;/features&gt;&lt;br&gt;  &lt;clock \
offset='utc'/&gt;&lt;br&gt;  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;&lt;br&gt;  \
&lt;on_reboot&gt;destroy&lt;/on_reboot&gt;&lt;br&gt;  \
&lt;on_crash&gt;destroy&lt;/on_crash&gt;&lt;br&gt;  \
&lt;devices&gt;&lt;br&gt;    \
&lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;&lt;br&gt;&lt;br&gt;&lt;controller \
type='virtio-serial' index='0' max_ports='15' vectors='4'/&gt;&lt;br&gt;&lt;channel \
type='pty'&gt;&lt;br&gt;  &lt;target type='virtio' \
name='org.linux-kvm.port.1'/&gt;&lt;br&gt; &lt;address type='virtio-serial' \
controller='0' bus='0'/&gt;&lt;br&gt;&lt;/channel&gt;&lt;br&gt;&lt;br&gt;    &lt;disk  \
type='file' device='disk'&gt;&lt;br&gt;      &lt;driver \
name='qemu' type='qcow2'/&gt;&lt;br&gt;      &lt;source \
file='/home/user1/linux_installed/image.cow2'/&gt;&lt;br&gt;      \
&lt;target dev='hda' bus='ide'/&gt;&lt;br&gt;      &lt;alias \
name='ide-disk0'/&gt;&lt;br&gt;        &lt;address \
type='drive' controller='0' bus='0' unit='0'/&gt;&lt;br&gt;    \
&lt;/disk&gt;&lt;br&gt;================================================================&lt;br&gt;&lt;br&gt;When \
i submit the xml file to virsh I get the following \
error:&lt;br&gt;&lt;br&gt;===============================================================&lt;br&gt;# \
virsh create vmTemplete-1.xml &lt;br&gt;error: Failed to create domain from \
vmTemplete-1.xml&lt;br&gt;error: internal error Process exited while reading console log \
output: char device redirected to /dev/pts/3&lt;br&gt;char device redirected to \
/dev/pts/4&lt;br&gt;open /dev/kvm: No such file or  directory&lt;br&gt;Could not initialize KVM, \
will disable KVM support&lt;br&gt;kvm: -device \
virtserialport,bus=virtio-serial0.0,nr=1,chardev=charchannel0,id=channel0,name=org.linux-kvm.port.1: \
virtio-serial-bus: Out-of-range port id specified, max. allowed: 0&lt;br&gt;&lt;br&gt;kvm: \
-device virtserialport,bus=virtio-serial0.0,nr=1,chardev=charchannel0,id=channel0,name=org.linux-kvm.port.1: \
Device 'virtserialport' could not be \
initialized&lt;br&gt;&lt;br&gt;===========================================================&lt;br&gt;&lt;br&gt;What \
could be the problem ? Could any one please point to the correct direction with \
regard to this.&lt;br&gt;&lt;br&gt;Regards&lt;br&gt;sl&lt;br&gt;&lt;br&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;br&gt;



      



</body></email><email><emailId>20110314014219</emailId><senderName>"C.D."</senderName><senderEmail>ccd.stoy.ml@gmail.com</senderEmail><timestampReceived>2011-03-14 01:42:19-0400</timestampReceived><subject>[libvirt-users] Libvirt with multipath devices and/or FC on NPIV</subject><body>

Hello,

I am trying to find out a best practice for a specific scenario.

First of all I would like to know what is the proper way to set up
multipath, who should care about it the host or the guest. Right now I have
a setup where I have one multipath which sets my host to boot from FC SAN. I
have another multipathed LUN in the host which is essentially a dm which I
attached to a guest, however through virtio. I added the devices through
virsh with pool type of "mpath" and path through /dev/mapper/. So here is my
first question: with such a setup the multipath and eventual fail-over is
taken care by the host OS, right, the guest will not notice is I suppose?
But what about migration. What if I decide to migrate the guest to another
host. How would that work out? WIth shared directory it is easy, you just
have the images in it, but what about such a setup. I can always add the
aforementioned LUN, where the guest resides to another Storage Group on the
SAN where the new host has access and I can make sure that the mpath device
name is persistent across all hosts, but is that the right approach.

Here is another question that is bugging me. I have FC HBA-s on all hosts
and I would like to make a HBA visible through my guest. I stumbled upon a
bug that is documented in redhat's bugzilla that attempted creation of NPIV
on pci_0000_blah_blah instead on the scsi_hostX device, but I fixed that
easily in the xml and although virsh doesn't seem to think I completed the
nodedev-create NPIV_for_my_FC.xml the device is seen as a child in
nodedev-list and what is more important the WWN are seen on the SAN switch.
So this seems to be working OK, however I don't know how to attach this new
shiny device that I created to a guest. Could someone give me a hint? What
is the proper way to attach this new devices to a guest OS and do that
persistently. Do I do that with virsh's attach-device and if so what is the
proper XML format? Should I dump the XML for the newly created NPIV nodedev
and try to attach that? And again with multipathing. What if I decided to
create NPIV on my two FC cards in every host, then do the zoning and attach
those newly created NPIV nodes to the guests? Will that produce the same
effect that such a multipath does on the host? It doesn't really matter if I
would use it for root drive or a shared gfs2 storage between guests, I just
want to know is this possible and is it the right thing to do, or should I
stick to setup in my previous paragraph? And last question: what about
migration with such NPIV FC devices. I can move a guest around, but will
that move my NPIV FC with it's WWN so that I can continue using my zoning (I
think I just realized that this might be impossible because I'm migrating
the guest, not the entire setup of libvirt, but probably I'm wrong and I'm
not aware of a proper method to do it correctly?).

Probably those questions are easy to answer, but please bare with me, I'm
playing with libvirt in an enterprise setup only for the last couple of days
and I would really like to make it right and kick some VMware ass.

By the way, all my hosts are Fedora 14, with kernel 2.6.37 (rebuild of the
one for Fedora 15 from koji, because there was a small glitch with Qlogic's
driver in the stock 2.6.35). Most of my guests will be SL6,CentOS5/6(when it
arrives) and a couple of windows XP guests (but I'm not really concerned
with that).

Thanks for the support in advance

P.S. please keep me in CC, as I'm not on the list. Thank you

[Attachment #3 (text/html)]

Hello,&lt;br&gt;
&lt;br&gt;
I am trying to find out a best practice for a specific scenario.&lt;br&gt;
&lt;br&gt;
First of all I would like to know what is the proper way to set up 
multipath, who should care about it the host or the guest. Right now I 
have a setup where I have one multipath which sets my host to boot from 
FC SAN. I have another multipathed LUN in the host which is essentially a
 dm which I attached to a guest, however through virtio. I added the 
devices through virsh with pool type of "mpath" and path through 
/dev/mapper/. So here is my first question: with such a setup the 
multipath and eventual fail-over is taken care by the host OS, right, 
the guest will not notice is I suppose? But what about migration. What 
if I decide to migrate the guest to another host. How would that work 
out? WIth shared directory it is easy, you just have the images in it, 
but what about such a setup. I can always add the aforementioned LUN, 
where the guest resides to another Storage Group on the SAN where the 
new host has access and I can make sure that the mpath device name is 
persistent across all hosts, but is that the right approach.&lt;br&gt;
&lt;br&gt;
Here is another question that is bugging me. I have FC HBA-s on all 
hosts and I would like to make a HBA visible through my guest. I 
stumbled upon a bug that is documented in redhat's bugzilla that 
attempted creation of NPIV on pci_0000_blah_blah instead on the 
scsi_hostX device, but I fixed that easily in the xml and although virsh
 doesn't seem to think I completed the nodedev-create NPIV_for_my_FC.xml
 the device is seen as a child in nodedev-list and what is more 
important the WWN are seen on the SAN switch. So this seems to be 
working OK, however I don't know how to attach this new shiny device 
that I created to a guest. Could someone give me a hint? What is the 
proper way to attach this new devices to a guest OS and do that 
persistently. Do I do that with virsh's attach-device and if so what is 
the proper XML format? Should I dump the XML for the newly created NPIV 
nodedev and try to attach that? And again with multipathing. What if I 
decided to create NPIV on my two FC cards in every host, then do the 
zoning and attach those newly created NPIV nodes to the guests? Will 
that produce the same effect that such a multipath does on the host? It 
doesn't really matter if I would use it for root drive or a shared gfs2 
storage between guests, I just want to know is this possible and is it 
the right thing to do, or should I stick to setup in my previous 
paragraph? And last question: what about migration with such NPIV FC 
devices. I can move a guest around, but will that move my NPIV FC with 
it's WWN so that I can continue using my zoning (I think I just realized
 that this might be impossible because I'm migrating the guest, not the 
entire setup of libvirt, but probably I'm wrong and I'm not aware of a 
proper method to do it correctly?).&lt;br&gt;
&lt;br&gt;
Probably those questions are easy to answer, but please bare with me, 
I'm playing with libvirt in an enterprise setup only for the last couple
 of days and I would really like to make it right and kick some VMware 
ass.&lt;br&gt;
&lt;br&gt;
By the way, all my hosts are Fedora 14, with kernel 2.6.37 (rebuild of 
the one for Fedora 15 from koji, because there was a small glitch with 
Qlogic's driver in the stock 2.6.35). Most of my guests will be 
SL6,CentOS5/6(when it arrives) and a couple of windows XP guests (but I'm not \
really concerned with that).&lt;br&gt;&lt;br&gt;Thanks for the support in advance&lt;br&gt;&lt;br&gt;P.S. \
please keep me in CC, as I'm not on the list. Thank you&lt;br&gt;



 



</body></email><email><emailId>20110311001953</emailId><senderName>James Barkley</senderName><senderEmail>james.barkley@gmail.com</senderEmail><timestampReceived>2011-03-11 00:19:53-0400</timestampReceived><subject>[libvirt-users] ruby bindings has two gems (I think)</subject><body>

When I look at remote gems I see:

- libvirt (0.2.0), "A ruby client library providing an interface to libvirt
via FFI"
- ruby-libvirt (0.3.0), "Provides bindings for libvirt"

I've been using ruby-libvirt, but maybe I should give libvirt a try? Has
anyone used libvirt (0.2.0) and developed opinions they'd like to share?

-jb

[Attachment #3 (text/html)]

When I look at remote gems I see:&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;- libvirt (0.2.0), "A ruby \
client library providing an interface to libvirt via FFI"&lt;/div&gt;&lt;div&gt;- \
ruby-libvirt (0.3.0), "Provides bindings for libvirt"&lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I've been using ruby-libvirt, but maybe I should give libvirt \
a try? Has anyone used libvirt (0.2.0) and developed opinions they'd like to \
share?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-jb&lt;/div&gt;



</body></email><email><emailId>20110312131454</emailId><senderName>Nikita A Menkovich</senderName><senderEmail>menkovich@gmail.com</senderEmail><timestampReceived>2011-03-12 13:14:54-0400</timestampReceived><subject>[libvirt-users] QEMU monitor</subject><body>

Hello,

Is there any way to change VNC password without rebooting virtual machine?
It is available through qemu monitor, but, it seems, there is no way
to do add monitor to kvm.

-- 
Nikita A Menkovich
http://libc6.org/
JID: menkovich@gmail.com

</body></email><email><emailId>20110314154041</emailId><senderName>kadir_yüceer</senderName><senderEmail>kadiryuceer@gmail.com</senderEmail><timestampReceived>2011-03-14 15:40:41-0400</timestampReceived><subject>[libvirt-users] Beware! Newbie is in town</subject><body>

Hello everyone,
I'm working on Ubuntu 10.10, installed libvirt and created a project in
Netbeans, I included jna.jar and libvirt-0.4.7.jar. And guess what, I get
the exception below when I'm trying to run test.java which connects to
test:///default.

Exception in thread "main" java.lang.UnsatisfiedLinkError: Unable to load
library 'virt': libvirt.so: cannot open shared object file: No such file or
directory
        at com.sun.jna.NativeLibrary.loadLibrary(NativeLibrary.java:164)
        at com.sun.jna.NativeLibrary.getInstance(NativeLibrary.java:237)
        at com.sun.jna.Library$Handler.&lt;init&gt;(Library.java:140)
        at com.sun.jna.Native.loadLibrary(Native.java:374)
        at com.sun.jna.Native.loadLibrary(Native.java:359)
        at org.libvirt.jna.Libvirt.&lt;clinit&gt;(Unknown Source)
        at org.libvirt.Connect.&lt;clinit&gt;(Unknown Source)
        at novatest_v01.Main.main(Main.java:21)

I'm sure this question has been asked dozens of times, sorry.
But any answer/comment is appreciated.

Thanks
Kadir

[Attachment #3 (text/html)]

Hello everyone,&lt;br&gt;I'm working on Ubuntu 10.10, installed libvirt and c=
reated a project in Netbeans, I included jna.jar and libvirt-0.4.7.jar. And=
 guess what, I get the exception below when I'm trying to run test.java=
 which connects to test:///default.&lt;br&gt;
&lt;br&gt;Exception in thread "main" java.lang.UnsatisfiedLinkError: Un=
able to load library 'virt': libvirt.so: cannot open shared object =
file: No such file or directory&lt;br&gt;=A0=A0=A0=A0=A0=A0=A0 at com.sun.jna.Nat=
iveLibrary.loadLibrary(NativeLibrary.java:164)&lt;br&gt;
=A0=A0=A0=A0=A0=A0=A0 at com.sun.jna.NativeLibrary.getInstance(NativeLibrar=
y.java:237)&lt;br&gt;=A0=A0=A0=A0=A0=A0=A0 at com.sun.jna.Library$Handler.&lt;ini=
t&gt;(Library.java:140)&lt;br&gt;=A0=A0=A0=A0=A0=A0=A0 at com.sun.jna.Native.load=
Library(Native.java:374)&lt;br&gt;=A0=A0=A0=A0=A0=A0=A0 at com.sun.jna.Native.loa=
dLibrary(Native.java:359)&lt;br&gt;
=A0=A0=A0=A0=A0=A0=A0 at org.libvirt.jna.Libvirt.&lt;clinit&gt;(Unknown Sou=
rce)&lt;br&gt;=A0=A0=A0=A0=A0=A0=A0 at org.libvirt.Connect.&lt;clinit&gt;(Unknown=
 Source)&lt;br&gt;=A0=A0=A0=A0=A0=A0=A0 at novatest_v01.Main.main(Main.java:21)&lt;b=
r&gt;&lt;br&gt;I'm sure this question has been asked dozens of times, sorry.&lt;br&gt;
But any answer/comment is appreciated.&lt;br&gt;&lt;br&gt;Thanks &lt;br&gt;Kadir&lt;br&gt;


</body></email><email><emailId>20110316100804</emailId><senderName>kadir_yüceer</senderName><senderEmail>kadiryuceer@gmail.com</senderEmail><timestampReceived>2011-03-16 10:08:04-0400</timestampReceived><subject>[libvirt-users] With which VMM ,libvirt cooperates the most?</subject><body>

Hi all,

I'm trying to develop some applications that communicate with VMM about
guest OSs. Libvirt has drivers for many VMMs like Qemu, Vbox, etc. I'm
currently using Vbox and time to time I get the error that says "this
function is not supported by the connection driver".

So, for which VMM, libvirt has the most compatible driver, regarding your
experiences?

Kind regards
Kadir

[Attachment #3 (text/html)]

Hi all,&lt;br&gt;&lt;br&gt;I'm trying to develop some applications that communicate=
 with VMM about guest OSs. Libvirt has drivers for many VMMs like Qemu, Vbo=
x, etc. I'm currently using Vbox and time to time I get the error that =
says "this function is not supported by the connection driver".&lt;b=
r&gt;
&lt;br&gt;So, for which VMM, libvirt has the most compatible driver, regarding yo=
ur experiences?&lt;br&gt;&lt;br&gt;Kind regards&lt;br&gt;Kadir&lt;br&gt;


</body></email><email><emailId>20110316154737</emailId><senderName>Nikita A Menkovich</senderName><senderEmail>menkovich@gmail.com</senderEmail><timestampReceived>2011-03-16 15:47:37-0400</timestampReceived><subject>[libvirt-users] SSH recovery console</subject><body>

Hello,

Is there available to create ssh recovery console except vnc console,
that is default by libvirt.
For example connect to kvm@host:2220 and go to first console
For example like here
&lt;serial type="tcp"&gt;
      &lt;source mode="bind" host="127.0.0.1" service="2445"/&gt;
      &lt;protocol type="telnet"/&gt;
      &lt;target port="1"/&gt;
    &lt;/serial&gt;
But not plain format

-- 
Nikita A Menkovich
http://libc6.org/
JID: menkovich@gmail.com

</body></email><email><emailId>20110316114545</emailId><senderName></senderName><senderEmail>robert.smol@stereoit.com</senderEmail><timestampReceived>2011-03-16 11:45:45-0400</timestampReceived><subject>[libvirt-users] RH6 qemu expects driver name</subject><body>

Hi,
I am trying to start machine on RH6.

virsh # start ulp-001
error: Failed to start domain ulp-001
error: internal error process exited while connecting to monitor: char 
device redirected to /dev/pts/1
qemu-kvm: -device lsi,id=scsi0,bus=pci.0,addr=0x5: Parameter 'driver' 
expects a driver name
Try with argument '?' for a list.

virsh # version
Compiled against library: libvir 0.8.1
Using library: libvir 0.8.1
Using API: QEMU 0.8.1
Running hypervisor: QEMU 0.12.1

This is part of the config

&lt;disk type='file' device='disk'&gt;
&lt;driver name='qemu' type='raw'/&gt;
&lt;source file='/rhev-data/defaultStore/ulp-001a.img'/&gt;
&lt;target dev='sda' bus='scsi'/&gt;
&lt;address type='drive' controller='0' bus='0' unit='0'/&gt;
&lt;/disk&gt;
&lt;controller type='ide' index='0'&gt;
&lt;address type='pci' domain='0x0000' bus='0x00' slot='0x01' function='0x1'/&gt;
&lt;/controller&gt;
&lt;controller type='scsi' index='0'&gt;
&lt;address type='pci' domain='0x0000' bus='0x00' slot='0x05' function='0x0'/&gt;
&lt;/controller&gt;

Any tips?

-- 
stereoIT - Open Source Technology Partners
http://www.stereoit.com
mobile: +420 776 762378


[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta content="text/html; charset=windows-1252"
      http-equiv="Content-Type"&gt;
  &lt;/head&gt;
  &lt;body bgcolor="#ffffff" text="#000000"&gt;
    &lt;font size="-1"&gt;&lt;font face="Helvetica, Arial, sans-serif"&gt;Hi,&lt;br&gt;
        I am trying to start machine on RH6.&lt;br&gt;
        &lt;br&gt;
        virsh # start ulp-001&lt;br&gt;
        error: Failed to start domain ulp-001&lt;br&gt;
        error: internal error process exited while connecting to
        monitor: char device redirected to /dev/pts/1&lt;br&gt;
        qemu-kvm: -device lsi,id=scsi0,bus=pci.0,addr=0x5: Parameter
        'driver' expects a driver name&lt;br&gt;
        Try with argument '?' for a list.&lt;br&gt;
        &lt;br&gt;
        virsh # version&lt;br&gt;
        Compiled against library: libvir 0.8.1&lt;br&gt;
        Using library: libvir 0.8.1&lt;br&gt;
        Using API: QEMU 0.8.1&lt;br&gt;
        Running hypervisor: QEMU 0.12.1&lt;br&gt;
        &lt;br&gt;
        This is part of the config&lt;br&gt;
        &lt;br&gt;
        &lt;disk type='file' device='disk'&gt;&lt;br&gt;
              &lt;driver name='qemu' type='raw'/&gt;&lt;br&gt;
              &lt;source
        file='/rhev-data/defaultStore/ulp-001a.img'/&gt;&lt;br&gt;
              &lt;target dev='sda' bus='scsi'/&gt;&lt;br&gt;
              &lt;address type='drive' controller='0' bus='0'
        unit='0'/&gt;&lt;br&gt;
            &lt;/disk&gt;&lt;br&gt;
            &lt;controller type='ide' index='0'&gt;&lt;br&gt;
              &lt;address type='pci' domain='0x0000' bus='0x00'
        slot='0x01' function='0x1'/&gt;&lt;br&gt;
            &lt;/controller&gt;&lt;br&gt;
            &lt;controller type='scsi' index='0'&gt;&lt;br&gt;
              &lt;address type='pci' domain='0x0000' bus='0x00'
        slot='0x05' function='0x0'/&gt;&lt;br&gt;
            &lt;/controller&gt;&lt;br&gt;
        &lt;br&gt;
        Any tips?&lt;br&gt;
      &lt;/font&gt;&lt;/font&gt;
    &lt;pre class="moz-signature" cols="72"&gt;-- 
stereoIT - Open Source Technology Partners
&lt;a class="moz-txt-link-freetext" href="http://www.stereoit.com"&gt;http://www.stereoit.com&lt;/a&gt;
mobile: +420 776 762378&lt;/pre&gt;
  &lt;/body&gt;
&lt;/html&gt;


</body></email><email><emailId>20110321093143</emailId><senderName>Mateusz Kijowski</senderName><senderEmail>mateusz.kijowski@gmail.com</senderEmail><timestampReceived>2011-03-21 09:31:43-0400</timestampReceived><subject>[libvirt-users] start/stop hooks</subject><body>

Hi list,


I have a quick question. Is there a way to run a script on the libvirt host
after a domain is started/stopped ?

-- 
Mateusz

[Attachment #3 (text/html)]

Hi list,&lt;br&gt;&lt;br&gt;&lt;br&gt;I have a quick question. Is there a way to run a script on the \
libvirt host after a domain is started/stopped ?&lt;br&gt;&lt;br&gt;-- &lt;br&gt;Mateusz&lt;br&gt;



</body></email><email><emailId>20110321124732</emailId><senderName>kadir_yüceer</senderName><senderEmail>kadiryuceer@gmail.com</senderEmail><timestampReceived>2011-03-21 12:47:32-0400</timestampReceived><subject>[libvirt-users] About monitoring</subject><body>

Hello all,
As I've been exporing libvirt api, I've seen event registerers, and types of
events are defined, undefined, and you know the rest. Is it all for event
types? Any ideas about how to look for a device access event, for example?

Kind regards

[Attachment #3 (text/html)]

Hello all,&lt;br&gt;As I've been exporing libvirt api, I've seen event registerers, \
and types of events are defined, undefined, and you know the rest. Is it all for \
event types? Any ideas about how to look for a device access event, for example?&lt;br&gt; \
&lt;br&gt;Kind regards&lt;br&gt;



</body></email><email><emailId>20110316180401</emailId><senderName>Zvi Dubitzky</senderName><senderEmail>dubi@il.ibm.com</senderEmail><timestampReceived>2011-03-16 18:04:01-0400</timestampReceived><subject>[libvirt-users] using more than 1  core by a virtual machine</subject><body>

My virtual machine xml file has &lt;vcpu&gt;2&lt;/vcpu&gt;  clause  while the host has 
2 physical cpus (cores).
Is this enough to cause a VM  running 2 endless loop threads  to use the 2 
 cores ?
In my case the VM running reports (cat /roc/cpuinfo) that it has 2 vcpus 
but it uses only 1 core (at a time)  because
the 'top' at the host shows 100%cpu   (out of total 200%)  used by the 
endless loop application 
Also virsh vcpuinfo &lt;vm&gt; shows only 1 CPU and 1 vcpu

any idea ?

thanks

Zvi Dubitzky 
Email:dubi@il.ibm.com

</body></email><email><emailId>20110321070722</emailId><senderName>Zvi Dubitzky</senderName><senderEmail>dubi@il.ibm.com</senderEmail><timestampReceived>2011-03-21 07:07:22-0400</timestampReceived><subject>[libvirt-users] storage pool vs storage volume</subject><body>

Can anybody give a good reference to  understand the difference between 
storage pool and storage volume
&gt;From  what I have seem storage volume describes the physical storage media 
 and the pool a collection of such
But from the XML at libvirt  I do not exactly understand that .

thanks

Zvi Dubitzky 
Email:dubi@il.ibm.com


</body></email><email><emailId>20110324123306</emailId><senderName>Christoph Raible</senderName><senderEmail>c.raible@science-computing.de</senderEmail><timestampReceived>2011-03-24 12:33:06-0400</timestampReceived><subject>[libvirt-users] livemigration over specific bridge/nic?</subject><body>

Hi @all,

I have a question about the livemigration with libvirt / kvm.

I have two bridges configured in my  setup of each host. Now I want to 
set br1 (private network) as default NIC for live migration.

Is there any solution to get this work for me?

I tried to bind libvirt to those IP-Range but after that the 
livemigration doesn't works.

If you need more details please tell me :)


Regards,

Christoph


-- 
Vorstand/Board of Management:
Dr. Bernd Finkbeiner, Dr. Roland Niemeier, 
Dr. Arno Steitz, Dr. Ingrid Zech
Vorsitzender des Aufsichtsrats/
Chairman of the Supervisory Board:
Michel Lepert
Sitz/Registered Office: Tuebingen
Registergericht/Registration Court: Stuttgart
Registernummer/Commercial Register No.: HRB 382196 



</body></email><email><emailId>20110324111633</emailId><senderName>"=?gbk?B?us7OxLTP?="</senderName><senderEmail>xiwang_cong@foxmail.com</senderEmail><timestampReceived>2011-03-24 11:16:33-0400</timestampReceived><subject>[libvirt-users] how to restart the network connection of kvm guest OS ?</subject><body>

[Attachment #2 (text/plain)]

When a vm move from one VLAN(e.g. VLAN 1) to another VLAN (e.g. VLAN 2), it is needed \
to restart the network connection of guest OS, so that it can begin a dhcp discover \
and get a new ip again. But i can't find the way to restart the guest os's network \
connection by libvirt (neither python API nor virsh command). Is any other ways? PS: \
i found that the VirtualBox can detach the cable of VMs and re-attach so that the \
guest OS will recognize and restart a dhcp discover when the cable re-attach. I guess \
the KVM will have some feature like that , is anybody know something about that?


thanks and looking forward to your answers.


[Attachment #3 (text/html)]

&lt;div&gt;&lt;span class="Apple-style-span" style="font-family: arial; font-size: small; \
line-height: normal; "&gt;When a vm move from one VLAN(e.g. VLAN 1) to another VLAN \
(e.g. VLAN 2), it is needed to restart the network connection of guest OS, so that it \
can begin a dhcp discover and get a new ip again. But i can't find the way to restart \
the guest os's network connection by libvirt (neither python API nor virsh command). \
Is any other ways? &lt;div&gt;PS: i found that the VirtualBox can detach the cable of \
VMs and re-attach so that the guest OS will recognize and restart a dhcp discover \
when the cable re-attach. I guess the KVM will have some feature like that , is \
anybody know something about that?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
id="aeaoofnhgocdbnbeljkmbjdmhbcokfdb-mousedown"&gt;thanks and looking forward to your \
answers.&lt;/div&gt;&lt;/span&gt;&lt;/div&gt;



</body></email><email><emailId>20110328141111</emailId><senderName>James Barkley</senderName><senderEmail>james.barkley@gmail.com</senderEmail><timestampReceived>2011-03-28 14:11:11-0400</timestampReceived><subject>[libvirt-users] stage of data upload/download patch</subject><body>

Hey all,
I'm looking at ways to upload/download to/from a datastore. I see it is on
the todo roadmap wiki (http://libvirt.org/todo.html) and also on bugzilla at
https://bugzilla.redhat.com/show_bug.cgi?id=636130. It looks to be a low
priority item, so I was thinking about writing my own patch for this when I
ran across this thread
http://comments.gmane.org/gmane.comp.emulators.libvirt/35532. It looks like
a patch going through discussion/revision for a variety of operations (e.g.,
vol-upload) to do exactly what I need. Does anyone have more info on the
status of this patch (or the "todo" feature in general) and when it may be
accepted into the baseline? I've been checking the hourly snapshots but
haven't seen it show up yet.

-jb

[Attachment #3 (text/html)]

Hey all, &lt;div&gt;I'm looking at ways to upload/download to/from a datastore. I see \
it is on the todo roadmap wiki (&lt;a \
href="http://libvirt.org/todo.html"&gt;http://libvirt.org/todo.html&lt;/a&gt;) and also on \
bugzilla at &lt;a href="https://bugzilla.redhat.com/show_bug.cgi?id=636130"&gt;https://bugzilla.redhat.com/show_bug.cgi?id=636130&lt;/a&gt;. \
It looks to be a low priority item, so I was thinking about writing my own patch for \
this when I ran across this thread &lt;a \
href="http://comments.gmane.org/gmane.comp.emulators.libvirt/35532"&gt;http://comments.gmane.org/gmane.comp.emulators.libvirt/35532&lt;/a&gt;. \
It looks like a patch going through discussion/revision for a variety of operations \
(e.g., vol-upload) to do exactly what I need. Does anyone have more info on the \
status of this patch (or the "todo" feature in general) and when it may be \
accepted into the baseline? I've been checking the hourly snapshots but \
haven't seen it show up yet.&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-jb&lt;/div&gt;



</body></email><email><emailId>20110325044322</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-03-25 04:43:22-0400</timestampReceived><subject>Re: [libvirt-users] how to restart the network connection of kvm guest	OS ?</subject><body>

ÓÚ 2011Äê03Ô 24ÈÕ 19:16, ºÎÎÄ´Ï Ð´µÀ:
&gt; When a vm move from one VLAN(e.g. VLAN 1) to another VLAN (e.g. VLAN 2),
&gt; it is needed to restart the network connection of guest OS, so that it
&gt; can begin a dhcp discover and get a new ip again. But i can't find the
&gt; way to restart the guest os's network connection by libvirt (neither
&gt; python API nor virsh command). Is any other ways?

Hi,

Won't virt-manager (if has) in your guest try to restart the network?

&gt; PS: i found that the VirtualBox can detach the cable of VMs and
&gt; re-attach so that the guest OS will recognize and restart a dhcp
&gt; discover when the cable re-attach. I guess the KVM will have some
&gt; feature like that , is anybody know something about that?

Libvirt supports similar function.
# virsh detach-interface
# virsh attach-interface

Or
# virsh detach-device
# virsh attach-device

the difference between "*-device" and "*-interface" is the
accepted arguments, the later one accepts interface xml.

Regards
Osier

</body></email><email><emailId>20110325044542</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-03-25 04:45:42-0400</timestampReceived><subject>Re: [libvirt-users] livemigration over specific bridge/nic?</subject><body>

于 2011年03月24日 20:33, Christoph Raible 写道:
&gt; Hi @all,
&gt;
&gt; I have a question about the livemigration with libvirt / kvm.
&gt;
&gt; I have two bridges configured in my setup of each host. Now I want to
&gt; set br1 (private network) as default NIC for live migration.

libvirt doesn't support to bind a specified interface for the
live migration socket.

&gt;
&gt; Is there any solution to get this work for me?
&gt;
&gt; I tried to bind libvirt to those IP-Range but after that the
&gt; livemigration doesn't works.

Curious, how did you do that? :-)

Regards
Osier

</body></email><email><emailId>20110321081650</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-03-21 08:16:50-0400</timestampReceived><subject>Re: [libvirt-users] storage pool vs storage volume</subject><body>

于 2011年03月21日 15:07, Zvi Dubitzky 写道:
&gt; Can anybody give a good reference to  understand the difference between
&gt; storage pool and storage volume
&gt;&gt; From  what I have seem storage volume describes the physical storage media
&gt;   and the pool a collection of such
&gt; But from the XML at libvirt  I do not exactly understand that .
&gt;

Take the "directory" pool as example, you can simple imagine
the pool is the directory, and the volume is the files under
that directory.

Regards
Osier

</body></email><email><emailId>20110321082707</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-03-21 08:27:07-0400</timestampReceived><subject>Re: [libvirt-users] using more than 1  core by a virtual machine</subject><body>

于 2011年03月17日 02:04, Zvi Dubitzky 写道:
&gt; My virtual machine xml file has&lt;vcpu&gt;2&lt;/vcpu&gt;   clause  while the host has
&gt; 2 physical cpus (cores).
&gt; Is this enough to cause a VM  running 2 endless loop threads  to use the 2
&gt;   cores ?
&gt; In my case the VM running reports (cat /roc/cpuinfo) that it has 2 vcpus
&gt; but it uses only 1 core (at a time)  because
&gt; the 'top' at the host shows 100%cpu   (out of total 200%)  used by the
&gt; endless loop application
&gt; Also virsh vcpuinfo&lt;vm&gt;  shows only 1 CPU and 1 vcpu

Is it really only 1 vcpu is showed? it should be two, that's
strange if you specified two vcpus, but only 1 is showed.
and by default, if you don't specify "cpuset" in &lt;vcpu&gt;, it uses
all the physical cpus, if I'm right, so you should be able to
see something like:

    CPU Affinity:   yy

Could you try specify "cpuset" explicitly like:

&lt;vcpu cpuset="0,1"&gt;2&lt;/vcpu&gt;

And see what it happens?

Regards
Osier

</body></email><email><emailId>20110321084936</emailId><senderName>Zvi Dubitzky</senderName><senderEmail>dubi@il.ibm.com</senderEmail><timestampReceived>2011-03-21 08:49:36-0400</timestampReceived><subject>Re: [libvirt-users] using more than 1  core by a virtual machine</subject><body>

Zvi Dubitzky 
Email:dubi@il.ibm.com
IBM Haifa Research Laboratory    Phone: +972-4-8296182
Haifa, 31905, ISRAEL 



Osier Yang &lt;jyang@redhat.com&gt; wrote on 21/03/2011 10:27:07:

&gt; From: Osier Yang &lt;jyang@redhat.com&gt;
&gt; To: Zvi Dubitzky/Haifa/IBM@IBMIL
&gt; Cc: libvirt-users@redhat.com
&gt; Date: 21/03/2011 10:27
&gt; Subject: Re: [libvirt-users] using more than 1  core by a virtual 
machine
&gt; 
&gt; $BP2(B 2011$BG/(B03$B7n(B17$BF|(B 02:04, Zvi Dubitzky $B&lt;LF;(B:
&gt; &gt; My virtual machine xml file has&lt;vcpu&gt;2&lt;/vcpu&gt;   clause  while the host 
has
&gt; &gt; 2 physical cpus (cores).
&gt; &gt; Is this enough to cause a VM  running 2 endless loop threads  to use 
the 2
&gt; &gt;   cores ?
&gt; &gt; In my case the VM running reports (cat /roc/cpuinfo) that it has 2 
vcpus
&gt; &gt; but it uses only 1 core (at a time)  because
&gt; &gt; the 'top' at the host shows 100%cpu   (out of total 200%)  used by the
&gt; &gt; endless loop application
&gt; &gt; Also virsh vcpuinfo&lt;vm&gt;  shows only 1 CPU and 1 vcpu
&gt; 
&gt; Is it really only 1 vcpu is showed? it should be two, that's
&gt; strange if you specified two vcpus, but only 1 is showed.
&gt; and by default, if you don't specify "cpuset" in &lt;vcpu&gt;, it uses
&gt; all the physical cpus, if I'm right, so you should be able to
&gt; see something like:
&gt; 
&gt;     CPU Affinity:   yy
&gt; 
&gt; Could you try specify "cpuset" explicitly like:
&gt; 
&gt; &lt;vcpu cpuset="0,1"&gt;2&lt;/vcpu&gt;
&gt; 
&gt; And see what it happens?
&gt; 

NO. There 2 vcpus in the VM screen . I pasted only one of them . yes there 
is 
PU Affinity:   yy   anyhow in 'virsh  vcpuinfo &lt;domain&gt; even before fixing 
the problem as below.

I solved the problem : The BIOS did not have VT enabled although 
multiprocessing item was already enabled in the BIOS and also some item 
called "virtualization " was already  enabled . But that was not enough : 
I also had to drop the following clause from the VM xml file:
'&lt;emulator&gt;/usr/local/bin/qemu-system-x86_64&lt;/emulator&gt;'
Anyhow: I do not understand why using multicore under a VM is dependent on 
the VT enabled

Now the 'top' utility (at the host) shows qemu-kvm is the running  process 
instead of qemu-system-x86_64 as before the fix . On the another Debian 
system I did not have to drop the &lt;emulator&gt; clause from the xml and the 
VM was still using all the cores  though ! But the libvirt at the Debian 
was newer (0.8.6) while the fedora14 was running libvirt 0.8.3

Do you know what is exactly qemu-system-x86_64 vs. qemu-kvm . Does the 
latter appear only if 
HW virtualization is active in the BIOS ?

thanks anyhow



&gt; Regards
&gt; Osier
&gt; 

</body></email><email><emailId>20110317111749</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-03-17 11:17:49-0400</timestampReceived><subject>Re: [libvirt-users] RH6 qemu expects driver name</subject><body>

On Wed, Mar 16, 2011 at 12:45:45PM +0100, Robert Å mol wrote:
&gt; Hi,
&gt; I am trying to start machine on RH6.
&gt; 
&gt; virsh # start ulp-001
&gt; error: Failed to start domain ulp-001
&gt; error: internal error process exited while connecting to monitor:
&gt; char device redirected to /dev/pts/1
&gt; qemu-kvm: -device lsi,id=scsi0,bus=pci.0,addr=0x5: Parameter
&gt; 'driver' expects a driver name

This is a really terrible QEMU error message. What it actually
means is that LSI SCSI is not supported in this QEMU binary.

Only IDE or VirtIO are supported block drivers in RHEL. No SCSI
and no USB

Regards,
Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110317170313</emailId><senderName>Robert Å mol</senderName><senderEmail>robert.smol@stereoit.com</senderEmail><timestampReceived>2011-03-17 17:03:13-0400</timestampReceived><subject>Re: [libvirt-users] RH6 qemu expects driver name</subject><body>

On 03/17/2011 12:17 PM, Daniel P. Berrange wrote:
&gt; On Wed, Mar 16, 2011 at 12:45:45PM +0100, Robert Å mol wrote:
&gt;&gt; Hi,
&gt;&gt; I am trying to start machine on RH6.
&gt;&gt;
&gt;&gt; virsh # start ulp-001
&gt;&gt; error: Failed to start domain ulp-001
&gt;&gt; error: internal error process exited while connecting to monitor:
&gt;&gt; char device redirected to /dev/pts/1
&gt;&gt; qemu-kvm: -device lsi,id=scsi0,bus=pci.0,addr=0x5: Parameter
&gt;&gt; 'driver' expects a driver name
&gt; This is a really terrible QEMU error message. What it actually
&gt; means is that LSI SCSI is not supported in this QEMU binary.
&gt;
&gt; Only IDE or VirtIO are supported block drivers in RHEL. No SCSI
&gt; and no USB
&gt;
&gt; Regards,
&gt; Daniel
Hi, this is bad, we want to migrate some machines from VMWare, but 
internal scripts relly on /dev/sda to be present. Is the support for 
'scsi' planned for RHEL6?

Thanks for decoding the message for me ;)

Regards,

Robert

</body></email><email><emailId>20110315074504</emailId><senderName>kadir_yüceer</senderName><senderEmail>kadiryuceer@gmail.com</senderEmail><timestampReceived>2011-03-15 07:45:04-0400</timestampReceived><subject>Re: [libvirt-users] Beware! Newbie is in town</subject><body>

And this also happens when I try to call virsh in command line.

2011/3/14 kadir y=FCceer &lt;kadiryuceer@gmail.com&gt;

&gt; Hello everyone,
&gt; I'm working on Ubuntu 10.10, installed libvirt and created a project in
&gt; Netbeans, I included jna.jar and libvirt-0.4.7.jar. And guess what, I get
&gt; the exception below when I'm trying to run test.java which connects to
&gt; test:///default.
&gt;
&gt; Exception in thread "main" java.lang.UnsatisfiedLinkError: Unable to load
&gt; library 'virt': libvirt.so: cannot open shared object file: No such file =
or
&gt; directory
&gt;         at com.sun.jna.NativeLibrary.loadLibrary(NativeLibrary.java:164)
&gt;         at com.sun.jna.NativeLibrary.getInstance(NativeLibrary.java:237)
&gt;         at com.sun.jna.Library$Handler.&lt;init&gt;(Library.java:140)
&gt;         at com.sun.jna.Native.loadLibrary(Native.java:374)
&gt;         at com.sun.jna.Native.loadLibrary(Native.java:359)
&gt;         at org.libvirt.jna.Libvirt.&lt;clinit&gt;(Unknown Source)
&gt;         at org.libvirt.Connect.&lt;clinit&gt;(Unknown Source)
&gt;         at novatest_v01.Main.main(Main.java:21)
&gt;
&gt; I'm sure this question has been asked dozens of times, sorry.
&gt; But any answer/comment is appreciated.
&gt;
&gt; Thanks
&gt; Kadir
&gt;

[Attachment #3 (text/html)]

And this also happens when I try to call virsh in command line.&lt;br&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;2011/3/14 kadir yüceer &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:kadiryuceer@gmail.com"&gt;kadiryuceer@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, \
204, 204); padding-left: 1ex;"&gt; Hello everyone,&lt;br&gt;I'm working on Ubuntu 10.10, \
installed libvirt and created a project in Netbeans, I included jna.jar and \
libvirt-0.4.7.jar. And guess what, I get the exception below when I'm trying to \
run test.java which connects to test:///default.&lt;br&gt;

&lt;br&gt;Exception in thread "main" java.lang.UnsatisfiedLinkError: Unable to \
load library 'virt': libvirt.so: cannot open shared object file: No such file \
or directory&lt;br&gt;        at \
com.sun.jna.NativeLibrary.loadLibrary(NativeLibrary.java:164)&lt;br&gt;

        at com.sun.jna.NativeLibrary.getInstance(NativeLibrary.java:237)&lt;br&gt;        \
at com.sun.jna.Library$Handler.&lt;init&gt;(Library.java:140)&lt;br&gt;        at \
com.sun.jna.Native.loadLibrary(Native.java:374)&lt;br&gt;        at \
com.sun.jna.Native.loadLibrary(Native.java:359)&lt;br&gt;

        at org.libvirt.jna.Libvirt.&lt;clinit&gt;(Unknown Source)&lt;br&gt;        at \
org.libvirt.Connect.&lt;clinit&gt;(Unknown Source)&lt;br&gt;        at \
novatest_v01.Main.main(Main.java:21)&lt;br&gt;&lt;br&gt;I'm sure this question has been asked \
dozens of times, sorry.&lt;br&gt;

But any answer/comment is appreciated.&lt;br&gt;&lt;br&gt;Thanks &lt;br&gt;&lt;font \
color="#888888"&gt;Kadir&lt;br&gt; &lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110329075917</emailId><senderName>kadir_yüceer</senderName><senderEmail>kadiryuceer@gmail.com</senderEmail><timestampReceived>2011-03-29 07:59:17-0400</timestampReceived><subject>[libvirt-users] Event Types Libvirt can handle</subject><body>

Hello all,
I'm trying to observe access events of guest VMs. However, as far as I
understand event types in libvirt are really generic, like domain
defined/undefined, started/stopped, etc.

Isn't there any specific event types that libvirt can handle (like access to
a disk), or I'm missing them?

Thanks in advance
Kind regards
Kadir

[Attachment #3 (text/html)]

Hello all,&lt;br&gt;I'm trying to observe access events of guest VMs. However=
, as far as I understand event types in libvirt are really generic, like do=
main defined/undefined, started/stopped, etc.&lt;br&gt;&lt;br&gt;Isn't there any sp=
ecific event types that libvirt can handle (like access to a disk), or I=
9;m missing them?&lt;br&gt;
&lt;br&gt;Thanks in advance&lt;br&gt;Kind regards&lt;br&gt;Kadir&lt;br&gt;


</body></email><email><emailId>20110315075245</emailId><senderName>Berend Dekens</senderName><senderEmail>berend@cyberwizzard.nl</senderEmail><timestampReceived>2011-03-15 07:52:45-0400</timestampReceived><subject>Re: [libvirt-users] Beware! Newbie is in town</subject><body>

It looks to me like you don't have libvirt set up properly as the ".so"
file is a library which should be available in a system default location.

Regards,
Berend Dekens

On 15/03/11 08:45, kadir yüceer wrote:
&gt; And this also happens when I try to call virsh in command line.

</body></email><email><emailId>20110315080833</emailId><senderName>kadir_yüceer</senderName><senderEmail>kadiryuceer@gmail.com</senderEmail><timestampReceived>2011-03-15 08:08:33-0400</timestampReceived><subject>Re: [libvirt-users] Beware! Newbie is in town</subject><body>

2011/3/15 Berend Dekens &lt;berend@cyberwizzard.nl&gt;

&gt; It looks to me like you don't have libvirt set up properly as the ".so"
&gt; file is a library which should be available in a system default location.
&gt;

Well I downloaded
libvirt-0.8.8.tar.gz&lt;http://libvirt.org/sources/libvirt-0.8.8.tar.gz&gt;and
run ./configure; make; install successfully. And I'm logged in as
root(always). Is there something else that I should do, except adding
jna.jar and the jar file within
libvirt-java-0.4.7.tar.gz&lt;http://libvirt.org/sources/java/libvirt-java-0.4.=
7.tar.gz&gt;to
the libraries section of my java project? I'm trying to run the sample
code test.java on http://libvirt.org/java.html.

Regards
Kadir

&gt;
&gt; Regards,
&gt; Berend Dekens
&gt;
&gt; On 15/03/11 08:45, kadir y=FCceer wrote:
&gt; &gt; And this also happens when I try to call virsh in command line.
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

[Attachment #3 (text/html)]

&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;2011/3/15 Berend Dekens &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:berend@cyberwizzard.nl"&gt;berend@cyberwizzard.nl&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, \
204, 204); padding-left: 1ex;"&gt; It looks to me like you don't have libvirt set up \
properly as the ".so"&lt;br&gt; file is a library which should be available in a \
system default location.&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Well I downloaded &lt;a \
href="http://libvirt.org/sources/libvirt-0.8.8.tar.gz"&gt;libvirt-0.8.8.tar.gz&lt;/a&gt; and \
run ./configure; make; install successfully. And I'm logged in as root(always). \
Is there something else that I should do, except adding jna.jar and the jar file \
within &lt;a href="http://libvirt.org/sources/java/libvirt-java-0.4.7.tar.gz"&gt;libvirt-java-0.4.7.tar.gz&lt;/a&gt; \
to the libraries section of my java project? I'm trying to run the sample code \
test.java on &lt;a href="http://libvirt.org/java.html"&gt;http://libvirt.org/java.html&lt;/a&gt;.&lt;br&gt;
 &lt;br&gt;Regards&lt;br&gt;Kadir&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin: 0pt 0pt \
0pt 0.8ex; border-left: 1px solid rgb(204, 204, 204); padding-left: 1ex;"&gt; &lt;br&gt;
Regards,&lt;br&gt;
Berend Dekens&lt;br&gt;
&lt;div class="im"&gt;&lt;br&gt;
On 15/03/11 08:45, kadir yüceer wrote:&lt;br&gt;
&gt; And this also happens when I try to call virsh in command line.&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;_______________________________________________&lt;br&gt;
libvirt-users mailing list&lt;br&gt;
&lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
&lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; \
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110315081624</emailId><senderName>Berend Dekens</senderName><senderEmail>berend@cyberwizzard.nl</senderEmail><timestampReceived>2011-03-15 08:16:24-0400</timestampReceived><subject>Re: [libvirt-users] Beware! Newbie is in town</subject><body>

On 15/03/11 09:08, kadir yüceer wrote:
&gt; 2011/3/15 Berend Dekens &lt;berend@cyberwizzard.nl
&gt; &lt;mailto:berend@cyberwizzard.nl&gt;&gt;
&gt;
&gt;     It looks to me like you don't have libvirt set up properly as the
&gt;     ".so"
&gt;     file is a library which should be available in a system default
&gt;     location.
&gt;
&gt;
&gt; Well I downloaded libvirt-0.8.8.tar.gz
&gt; &lt;http://libvirt.org/sources/libvirt-0.8.8.tar.gz&gt; and run ./configure;
&gt; make; install successfully. And I'm logged in as root(always). Is
&gt; there something else that I should do, except adding jna.jar and the
&gt; jar file within libvirt-java-0.4.7.tar.gz
&gt; &lt;http://libvirt.org/sources/java/libvirt-java-0.4.7.tar.gz&gt; to the
&gt; libraries section of my java project? I'm trying to run the sample
&gt; code test.java on http://libvirt.org/java.html.
The fact that virsh throws the same error means you can leave the Java
bit for now and focus on virsh instead: as long as that does not work,
the Java bindings will not either.

On a side note: you might want to use your distributions package manage
to install libvirt so all the files end up in the correct paths. My
guess is that you currently install files into the wrong location.

Regards,
Berend Dekens

[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta content="text/html; charset=ISO-8859-1"
      http-equiv="Content-Type"&gt;
  &lt;/head&gt;
  &lt;body bgcolor="#ffffff" text="#000000"&gt;
    On 15/03/11 09:08, kadir yüceer wrote:&lt;br&gt;
    &lt;blockquote
      cite="mid:AANLkTi=PiqnOf0chiqcaz48HrmE0spW2sFr=8do_9BSV@mail.gmail.com"
      type="cite"&gt;
      &lt;div class="gmail_quote"&gt;2011/3/15 Berend Dekens &lt;span dir="ltr"&gt;&lt;&lt;a
            moz-do-not-send="true" \
href="mailto:berend@cyberwizzard.nl"&gt;berend@cyberwizzard.nl&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;  \
&lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt  0.8ex; border-left: 1px \
solid rgb(204, 204, 204);  padding-left: 1ex;"&gt;
          It looks to me like you don't have libvirt set up properly as
          the ".so"&lt;br&gt;
          file is a library which should be available in a system
          default location.&lt;br&gt;
        &lt;/blockquote&gt;
        &lt;div&gt;&lt;br&gt;
          Well I downloaded &lt;a moz-do-not-send="true"
            href="http://libvirt.org/sources/libvirt-0.8.8.tar.gz"&gt;libvirt-0.8.8.tar.gz&lt;/a&gt;
  and run ./configure; make; install successfully. And I'm
          logged in as root(always). Is there something else that I
          should do, except adding jna.jar and the jar file within &lt;a
            moz-do-not-send="true"
            href="http://libvirt.org/sources/java/libvirt-java-0.4.7.tar.gz"&gt;libvirt-java-0.4.7.tar.gz&lt;/a&gt;
  to the libraries section of my java project? I'm trying to run
          the sample code test.java on &lt;a moz-do-not-send="true"
            href="http://libvirt.org/java.html"&gt;http://libvirt.org/java.html&lt;/a&gt;.&lt;/div&gt;
  &lt;/div&gt;
    &lt;/blockquote&gt;
    The fact that virsh throws the same error means you can leave the
    Java bit for now and focus on virsh instead: as long as that does
    not work, the Java bindings will not either.&lt;br&gt;
    &lt;br&gt;
    On a side note: you might want to use your distributions package
    manage to install libvirt so all the files end up in the correct
    paths. My guess is that you currently install files into the wrong
    location.&lt;br&gt;
    &lt;br&gt;
    Regards,&lt;br&gt;
    Berend Dekens&lt;br&gt;
  &lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20110315083519</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-03-15 08:35:19-0400</timestampReceived><subject>Re: [libvirt-users] Beware! Newbie is in town</subject><body>

2011/3/15 kadir yüceer &lt;kadiryuceer@gmail.com&gt;:
&gt;
&gt;
&gt; 2011/3/15 Berend Dekens &lt;berend@cyberwizzard.nl&gt;
&gt;&gt;
&gt;&gt; It looks to me like you don't have libvirt set up properly as the ".so"
&gt;&gt; file is a library which should be available in a system default location.
&gt;
&gt; Well I downloaded libvirt-0.8.8.tar.gz and run ./configure; make; install
&gt; successfully. And I'm logged in as root(always). Is there something else
&gt; that I should do, except adding jna.jar and the jar file within
&gt; libvirt-java-0.4.7.tar.gz to the libraries section of my java project? I'm
&gt; trying to run the sample code test.java on http://libvirt.org/java.html.
&gt;

Running just ./configure without any options should make it install
under the /usr/local prefix. /usr/local/bin should be in PATH by
default, that's why you can run virsh, but ld fails to find
libvirt.so.

Did you try to run ldconfig as root to update ld's cache? That might help.

Matthias

</body></email><email><emailId>20110314061627</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-03-14 06:16:27-0400</timestampReceived><subject>Re: [libvirt-users] QEMU monitor</subject><body>

ÓÚ 2011Äê03Ô 12ÈÕ 21:14, Nikita A Menkovich Ð´µÀ:
&gt; Hello,
&gt; 
&gt; Is there any way to change VNC password without rebooting virtual machine?
&gt; It is available through qemu monitor, but, it seems, there is no way
&gt; to do add monitor to kvm.
&gt; 

If you are mean how to do with libvirt.

# cat demo.xml
&lt;graphics type='vnc' port='0' autoport='yes' listen='127.0.0.1'
keymap='en-us' passwd='111111'/&gt;

# virsh update-device demo.xml --persistent

NB, "--persistent" is optional, which is intended to change the vnc
password persistently.

Regards
Osier

</body></email><email><emailId>20110314144256</emailId><senderName>Nikita A Menkovich</senderName><senderEmail>menkovich@gmail.com</senderEmail><timestampReceived>2011-03-14 14:42:56-0400</timestampReceived><subject>Re: [libvirt-users] QEMU monitor</subject><body>

Thanks for your reply,

$ virsh update-device user user.xml --persistent
error: Failed to update device from user.xml
error: Requested operation is not valid: cannot modify the persistent
configuration of a domain
Without persistent it updates only live password, but in xml it is not modified

2011/3/14 Osier Yang &lt;jyang@redhat.com&gt;:
&gt; 于 2011年03月12日 21:14, Nikita A Menkovich 写道:
&gt;&gt; Hello,
&gt;&gt;
&gt;&gt; Is there any way to change VNC password without rebooting virtual machine?
&gt;&gt; It is available through qemu monitor, but, it seems, there is no way
&gt;&gt; to do add monitor to kvm.
&gt;&gt;
&gt;
&gt; If you are mean how to do with libvirt.
&gt;
&gt; # cat demo.xml
&gt; &lt;graphics type='vnc' port='0' autoport='yes' listen='127.0.0.1'
&gt; keymap='en-us' passwd='111111'/&gt;
&gt;
&gt; # virsh update-device demo.xml --persistent
&gt;
&gt; NB, "--persistent" is optional, which is intended to change the vnc
&gt; password persistently.
&gt;
&gt; Regards
&gt; Osier
&gt;
&gt;



-- 
Nikita A Menkovich
http://libc6.org/
JID: menkovich@gmail.com
Tel: +7 (921) 423-96-48

</body></email><email><emailId>20110311211550</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2011-03-11 21:15:50-0400</timestampReceived><subject>Re: [libvirt-users] ruby bindings has two gems (I think)</subject><body>

On 03/10/11 - 07:19:53PM, James Barkley wrote:
&gt; When I look at remote gems I see:
&gt; 
&gt; - libvirt (0.2.0), "A ruby client library providing an interface to libvirt
&gt; via FFI"
&gt; - ruby-libvirt (0.3.0), "Provides bindings for libvirt"
&gt; 
&gt; I've been using ruby-libvirt, but maybe I should give libvirt a try? Has
&gt; anyone used libvirt (0.2.0) and developed opinions they'd like to share?

I'm biased since I am the maintainer of ruby-libvirt, but I think
you should stick with ruby-libvirt :).  I do more active maintenance of the
bindings than what I saw in the "libvirt" gem, and since I monitor the libvirt
list I keep a very up-to-date with what is going on.  The downside is that
if you are using anything but MRI, the ruby-libvirt bindings won't work.  Since
most people are not, this is not usually an issue, but it is something to
consider.

-- 
Chris Lalancette

</body></email><email><emailId>20110313105936</emailId><senderName>James Barkley</senderName><senderEmail>james.barkley@gmail.com</senderEmail><timestampReceived>2011-03-13 10:59:36-0400</timestampReceived><subject>Re: [libvirt-users] ruby bindings has two gems (I think)</subject><body>

Thanks for the info. Are there any plans to extend the functionality of the
ruby-libvirt gem beyond just the bindings? For instance, convenience
functions, OVF parsing, etc? We have needed this functionality so ended up
building a gem called "ovfparse" for fetching and parsing these types of
files (code at https://github.com/ruby-ovf/ovfparse).

-jb

On Fri, Mar 11, 2011 at 4:15 PM, Chris Lalancette &lt;clalance@redhat.com&gt;wrote:

&gt; On 03/10/11 - 07:19:53PM, James Barkley wrote:
&gt; &gt; When I look at remote gems I see:
&gt; &gt;
&gt; &gt; - libvirt (0.2.0), "A ruby client library providing an interface to
&gt; libvirt
&gt; &gt; via FFI"
&gt; &gt; - ruby-libvirt (0.3.0), "Provides bindings for libvirt"
&gt; &gt;
&gt; &gt; I've been using ruby-libvirt, but maybe I should give libvirt a try? Has
&gt; &gt; anyone used libvirt (0.2.0) and developed opinions they'd like to share?
&gt;
&gt; I'm biased since I am the maintainer of ruby-libvirt, but I think
&gt; you should stick with ruby-libvirt :).  I do more active maintenance of the
&gt; bindings than what I saw in the "libvirt" gem, and since I monitor the
&gt; libvirt
&gt; list I keep a very up-to-date with what is going on.  The downside is that
&gt; if you are using anything but MRI, the ruby-libvirt bindings won't work.
&gt;  Since
&gt; most people are not, this is not usually an issue, but it is something to
&gt; consider.
&gt;
&gt; --
&gt; Chris Lalancette
&gt;

[Attachment #3 (text/html)]

Thanks for the info. Are there any plans to extend the functionality of the \
ruby-libvirt gem beyond just the bindings? For instance, convenience functions, OVF \
parsing, etc? We have needed this functionality so ended up building a gem called \
"ovfparse" for fetching and parsing these types of files (code at &lt;a \
href="https://github.com/ruby-ovf/ovfparse"&gt;https://github.com/ruby-ovf/ovfparse&lt;/a&gt;).&lt;div&gt;
 &lt;br&gt;&lt;/div&gt;&lt;div&gt;-jb&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Fri, Mar 11, 2011 at 4:15 PM, \
Chris Lalancette &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:clalance@redhat.com"&gt;clalance@redhat.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt; &lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;On &lt;a \
href="tel:03%2F10%2F11%20-%2007"&gt;03/10/11 - 07&lt;/a&gt;:19:53PM, James Barkley wrote:&lt;br&gt; \
&gt; When I look at remote gems I see:&lt;br&gt; &gt;&lt;br&gt;
&gt; - libvirt (0.2.0), "A ruby client library providing an interface to \
libvirt&lt;br&gt; &gt; via FFI"&lt;br&gt;
&gt; - ruby-libvirt (0.3.0), "Provides bindings for libvirt"&lt;br&gt;
&gt;&lt;br&gt;
&gt; I've been using ruby-libvirt, but maybe I should give libvirt a try? Has&lt;br&gt;
&gt; anyone used libvirt (0.2.0) and developed opinions they'd like to share?&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;I'm biased since I am the maintainer of ruby-libvirt, but I think&lt;br&gt;
you should stick with ruby-libvirt :).  I do more active maintenance of the&lt;br&gt;
bindings than what I saw in the "libvirt" gem, and since I monitor the \
libvirt&lt;br&gt; list I keep a very up-to-date with what is going on.  The downside is \
that&lt;br&gt; if you are using anything but MRI, the ruby-libvirt bindings won't work. \
Since&lt;br&gt; most people are not, this is not usually an issue, but it is something \
to&lt;br&gt; consider.&lt;br&gt;
&lt;br&gt;
--&lt;br&gt;
&lt;font color="#888888"&gt;Chris Lalancette&lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20110314014220</emailId><senderName>"C.D."</senderName><senderEmail>ccd.stoy.ml@gmail.com</senderEmail><timestampReceived>2011-03-14 01:42:20-0400</timestampReceived><subject>[libvirt-users] Libvirt with multipath devices and/or FC on NPIV</subject><body>

Hello,

I am trying to find out a best practice for a specific scenario.

First of all I would like to know what is the proper way to set up
multipath, who should care about it the host or the guest. Right now I have
a setup where I have one multipath which sets my host to boot from FC SAN. I
have another multipathed LUN in the host which is essentially a dm which I
attached to a guest, however through virtio. I added the devices through
virsh with pool type of "mpath" and path through /dev/mapper/. So here is my
first question: with such a setup the multipath and eventual fail-over is
taken care by the host OS, right, the guest will not notice is I suppose?
But what about migration. What if I decide to migrate the guest to another
host. How would that work out? WIth shared directory it is easy, you just
have the images in it, but what about such a setup. I can always add the
aforementioned LUN, where the guest resides to another Storage Group on the
SAN where the new host has access and I can make sure that the mpath device
name is persistent across all hosts, but is that the right approach.

Here is another question that is bugging me. I have FC HBA-s on all hosts
and I would like to make a HBA visible through my guest. I stumbled upon a
bug that is documented in redhat's bugzilla that attempted creation of NPIV
on pci_0000_blah_blah instead on the scsi_hostX device, but I fixed that
easily in the xml and although virsh doesn't seem to think I completed the
nodedev-create NPIV_for_my_FC.xml the device is seen as a child in
nodedev-list and what is more important the WWN are seen on the SAN switch.
So this seems to be working OK, however I don't know how to attach this new
shiny device that I created to a guest. Could someone give me a hint? What
is the proper way to attach this new devices to a guest OS and do that
persistently. Do I do that with virsh's attach-device and if so what is the
proper XML format? Should I dump the XML for the newly created NPIV nodedev
and try to attach that? And again with multipathing. What if I decided to
create NPIV on my two FC cards in every host, then do the zoning and attach
those newly created NPIV nodes to the guests? Will that produce the same
effect that such a multipath does on the host? It doesn't really matter if I
would use it for root drive or a shared gfs2 storage between guests, I just
want to know is this possible and is it the right thing to do, or should I
stick to setup in my previous paragraph? And last question: what about
migration with such NPIV FC devices. I can move a guest around, but will
that move my NPIV FC with it's WWN so that I can continue using my zoning (I
think I just realized that this might be impossible because I'm migrating
the guest, not the entire setup of libvirt, but probably I'm wrong and I'm
not aware of a proper method to do it correctly?).

Probably those questions are easy to answer, but please bare with me, I'm
playing with libvirt in an enterprise setup only for the last couple of days
and I would really like to make it right and kick some VMware ass.

By the way, all my hosts are Fedora 14, with kernel 2.6.37 (rebuild of the
one for Fedora 15 from koji, because there was a small glitch with Qlogic's
driver in the stock 2.6.35). Most of my guests will be SL6,CentOS5/6(when it
arrives) and a couple of windows XP guests (but I'm not really concerned
with that).

Thanks for the support in advance

P.S. please keep me in CC, as I'm not on the list. Thank you

[Attachment #3 (text/html)]

Hello,&lt;br&gt;
&lt;br&gt;
I am trying to find out a best practice for a specific scenario.&lt;br&gt;
&lt;br&gt;
First of all I would like to know what is the proper way to set up 
multipath, who should care about it the host or the guest. Right now I 
have a setup where I have one multipath which sets my host to boot from 
FC SAN. I have another multipathed LUN in the host which is essentially a
 dm which I attached to a guest, however through virtio. I added the 
devices through virsh with pool type of "mpath" and path through 
/dev/mapper/. So here is my first question: with such a setup the 
multipath and eventual fail-over is taken care by the host OS, right, 
the guest will not notice is I suppose? But what about migration. What 
if I decide to migrate the guest to another host. How would that work 
out? WIth shared directory it is easy, you just have the images in it, 
but what about such a setup. I can always add the aforementioned LUN, 
where the guest resides to another Storage Group on the SAN where the 
new host has access and I can make sure that the mpath device name is 
persistent across all hosts, but is that the right approach.&lt;br&gt;
&lt;br&gt;
Here is another question that is bugging me. I have FC HBA-s on all 
hosts and I would like to make a HBA visible through my guest. I 
stumbled upon a bug that is documented in redhat's bugzilla that 
attempted creation of NPIV on pci_0000_blah_blah instead on the 
scsi_hostX device, but I fixed that easily in the xml and although virsh
 doesn't seem to think I completed the nodedev-create NPIV_for_my_FC.xml
 the device is seen as a child in nodedev-list and what is more 
important the WWN are seen on the SAN switch. So this seems to be 
working OK, however I don't know how to attach this new shiny device 
that I created to a guest. Could someone give me a hint? What is the 
proper way to attach this new devices to a guest OS and do that 
persistently. Do I do that with virsh's attach-device and if so what is 
the proper XML format? Should I dump the XML for the newly created NPIV 
nodedev and try to attach that? And again with multipathing. What if I 
decided to create NPIV on my two FC cards in every host, then do the 
zoning and attach those newly created NPIV nodes to the guests? Will 
that produce the same effect that such a multipath does on the host? It 
doesn't really matter if I would use it for root drive or a shared gfs2 
storage between guests, I just want to know is this possible and is it 
the right thing to do, or should I stick to setup in my previous 
paragraph? And last question: what about migration with such NPIV FC 
devices. I can move a guest around, but will that move my NPIV FC with 
it's WWN so that I can continue using my zoning (I think I just realized
 that this might be impossible because I'm migrating the guest, not the 
entire setup of libvirt, but probably I'm wrong and I'm not aware of a 
proper method to do it correctly?).&lt;br&gt;
&lt;br&gt;
Probably those questions are easy to answer, but please bare with me, 
I'm playing with libvirt in an enterprise setup only for the last couple
 of days and I would really like to make it right and kick some VMware 
ass.&lt;br&gt;
&lt;br&gt;
By the way, all my hosts are Fedora 14, with kernel 2.6.37 (rebuild of 
the one for Fedora 15 from koji, because there was a small glitch with 
Qlogic's driver in the stock 2.6.35). Most of my guests will be 
SL6,CentOS5/6(when it arrives) and a couple of windows XP guests (but I'm not \
really concerned with that).&lt;br&gt;&lt;br&gt;Thanks for the support in advance&lt;br&gt;&lt;br&gt;P.S. \
please keep me in CC, as I'm not on the list. Thank you&lt;br&gt;



 



</body></email><email><emailId>20110314115834</emailId><senderName>"C.D."</senderName><senderEmail>ccd.stoy.ml@gmail.com</senderEmail><timestampReceived>2011-03-14 11:58:34-0400</timestampReceived><subject>[libvirt-users] Libvirt with multipath devices and/or FC on NPIV</subject><body>

Hello,

I am trying to find out a best practice for a specific scenario.

First of all I would like to know what is the proper way to set up
multipath, who should care about it the host or the guest. Right now I have
a setup where I have one multipath which sets my host to boot from FC SAN. I
have another multipathed LUN in the host which is essentially a dm which I
attached to a guest, however through virtio. I added the devices through
virsh with pool type of "mpath" and path through /dev/mapper/. So here is my
first question: with such a setup the multipath and eventual fail-over is
taken care by the host OS, right, the guest will not notice is I suppose?
But what about migration. What if I decide to migrate the guest to another
host. How would that work out? WIth shared directory it is easy, you just
have the images in it, but what about such a setup. I can always add the
aforementioned LUN, where the guest resides to another Storage Group on the
SAN where the new host has access and I can make sure that the mpath device
name is persistent across all hosts, but is that the right approach.

Here is another question that is bugging me. I have FC HBA-s on all hosts
and I would like to make a HBA visible through my guest. I stumbled upon a
bug that is documented in redhat's bugzilla that attempted creation of NPIV
on pci_0000_blah_blah instead on the scsi_hostX device, but I fixed that
easily in the xml and although virsh doesn't seem to think I completed the
nodedev-create NPIV_for_my_FC.xml the device is seen as a child in
nodedev-list and what is more important the WWN are seen on the SAN switch.
So this seems to be working OK, however I don't know how to attach this new
shiny device that I created to a guest. Could someone give me a hint? What
is the proper way to attach this new devices to a guest OS and do that
persistently. Do I do that with virsh's attach-device and if so what is the
proper XML format? Should I dump the XML for the newly created NPIV nodedev
and try to attach that? And again with multipathing. What if I decided to
create NPIV on my two FC cards in every host, then do the zoning and attach
those newly created NPIV nodes to the guests? Will that produce the same
effect that such a multipath does on the host? It doesn't really matter if I
would use it for root drive or a shared gfs2 storage between guests, I just
want to know is this possible and is it the right thing to do, or should I
stick to setup in my previous paragraph? And last question: what about
migration with such NPIV FC devices. I can move a guest around, but will
that move my NPIV FC with it's WWN so that I can continue using my zoning (I
think I just realized that this might be impossible because I'm migrating
the guest, not the entire setup of libvirt, but probably I'm wrong and I'm
not aware of a proper method to do it correctly?).

Probably those questions are easy to answer, but please bare with me, I'm
playing with libvirt in an enterprise setup only for the last couple of days
and I would really like to make it right and kick some VMware ass.

By the way, all my hosts are Fedora 14, with kernel 2.6.37 (rebuild of the
one for Fedora 15 from koji, because there was a small glitch with Qlogic's
driver in the stock 2.6.35). Most of my guests will be SL6,CentOS5/6(when it
arrives) and a couple of windows XP guests (but I'm not really concerned
with that).

Thanks for the support in advance

[Attachment #3 (text/html)]

Hello,&lt;br&gt;
&lt;br&gt;
I am trying to find out a best practice for a specific scenario.&lt;br&gt;
&lt;br&gt;
First of all I would like to know what is the proper way to set up 
multipath, who should care about it the host or the guest. Right now I 
have a setup where I have one multipath which sets my host to boot from 
FC SAN. I have another multipathed LUN in the host which is essentially a
 dm which I attached to a guest, however through virtio. I added the 
devices through virsh with pool type of "mpath" and path through 
/dev/mapper/. So here is my first question: with such a setup the 
multipath and eventual fail-over is taken care by the host OS, right, 
the guest will not notice is I suppose? But what about migration. What 
if I decide to migrate the guest to another host. How would that work 
out? WIth shared directory it is easy, you just have the images in it, 
but what about such a setup. I can always add the aforementioned LUN, 
where the guest resides to another Storage Group on the SAN where the 
new host has access and I can make sure that the mpath device name is 
persistent across all hosts, but is that the right approach.&lt;br&gt;
&lt;br&gt;
Here is another question that is bugging me. I have FC HBA-s on all 
hosts and I would like to make a HBA visible through my guest. I 
stumbled upon a bug that is documented in redhat's bugzilla that 
attempted creation of NPIV on pci_0000_blah_blah instead on the 
scsi_hostX device, but I fixed that easily in the xml and although virsh
 doesn't seem to think I completed the nodedev-create NPIV_for_my_FC.xml
 the device is seen as a child in nodedev-list and what is more 
important the WWN are seen on the SAN switch. So this seems to be 
working OK, however I don't know how to attach this new shiny device 
that I created to a guest. Could someone give me a hint? What is the 
proper way to attach this new devices to a guest OS and do that 
persistently. Do I do that with virsh's attach-device and if so what is 
the proper XML format? Should I dump the XML for the newly created NPIV 
nodedev and try to attach that? And again with multipathing. What if I 
decided to create NPIV on my two FC cards in every host, then do the 
zoning and attach those newly created NPIV nodes to the guests? Will 
that produce the same effect that such a multipath does on the host? It 
doesn't really matter if I would use it for root drive or a shared gfs2 
storage between guests, I just want to know is this possible and is it 
the right thing to do, or should I stick to setup in my previous 
paragraph? And last question: what about migration with such NPIV FC 
devices. I can move a guest around, but will that move my NPIV FC with 
it's WWN so that I can continue using my zoning (I think I just realized
 that this might be impossible because I'm migrating the guest, not the 
entire setup of libvirt, but probably I'm wrong and I'm not aware of a 
proper method to do it correctly?).&lt;br&gt;
&lt;br&gt;
Probably those questions are easy to answer, but please bare with me, 
I'm playing with libvirt in an enterprise setup only for the last couple
 of days and I would really like to make it right and kick some VMware 
ass.&lt;br&gt;
&lt;br&gt;
By the way, all my hosts are Fedora 14, with kernel 2.6.37 (rebuild of 
the one for Fedora 15 from koji, because there was a small glitch with 
Qlogic's driver in the stock 2.6.35). Most of my guests will be 
SL6,CentOS5/6(when it arrives) and a couple of windows XP guests (but I'm not \
really concerned with that).&lt;br&gt;&lt;br&gt;Thanks for the support in advance



</body></email><email><emailId>20110312160310</emailId><senderName>SAURAV LAHIRI</senderName><senderEmail>saurav_lahiri@yahoo.com</senderEmail><timestampReceived>2011-03-12 16:03:10-0400</timestampReceived><subject>Re: [libvirt-users] Issue creating vm channel</subject><body>

Hello,

On changing the machine type to "machine='pc-0.13" in the xml file. I was able to \
proceed further.


Regards
sl

--- On Sat, 12/3/11, SAURAV LAHIRI &lt;saurav_lahiri@yahoo.com&gt; wrote:

From: SAURAV LAHIRI &lt;saurav_lahiri@yahoo.com&gt;
Subject: [libvirt-users] Issue creating vm channel
To: libvirt-users@redhat.com
Date: Saturday, 12 March, 2011, 11:33

Hello,
I am trying to create a lucid guest VM with a vmchannel between the guest and the \
hypervisor. Details below:

KERNEL:
# uname -a
Linux saurav-desktop 2.6.38-2-generic #29~lucid1-Ubuntu SMP Mon Feb 7 13:35:14 UTC \
2011 i686 GNU/Linux

QEMU:
# /usr/bin/qemu --version
QEMU emulator version 0.13.0, Copyright (c) 2003-2008 Fabrice Bellard

LIBVIRT:
# /usr/sbin/libvirtd --version
/usr/local/sbin/libvirtd (libvirt) 0.8.8


Below is a snippet of my libvirt xml file.

===============================================================
&lt;domain type='kvm' id='16'&gt;
  &lt;name&gt;FinalTest&lt;/name&gt;
  &lt;uuid&gt;212bc1f1-b4f7-1ed3-7dc3-2b4b82ab68d1&lt;/uuid&gt;
  &lt;memory&gt;1048576&lt;/memory&gt;
  &lt;currentMemory&gt;1048576&lt;/currentMemory&gt;
 
 &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='x86_64' machine='pc-0.12'&gt;hvm&lt;/type&gt;
    &lt;boot dev='hd'/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
    &lt;apic/&gt;
    &lt;pae/&gt;
  &lt;/features&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;destroy&lt;/on_reboot&gt;
  &lt;on_crash&gt;destroy&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;

&lt;controller type='virtio-serial' index='0' max_ports='15' vectors='4'/&gt;
&lt;channel type='pty'&gt;
  &lt;target type='virtio' name='org.linux-kvm.port.1'/&gt;
 &lt;address type='virtio-serial' controller='0' bus='0'/&gt;
&lt;/channel&gt;

    &lt;disk
 type='file' device='disk'&gt;
      &lt;driver name='qemu' type='qcow2'/&gt;
      &lt;source file='/home/user1/linux_installed/image.cow2'/&gt;
      &lt;target dev='hda' bus='ide'/&gt;
      &lt;alias name='ide-disk0'/&gt;
        &lt;address type='drive' controller='0' bus='0' unit='0'/&gt;
    &lt;/disk&gt;
================================================================

When i submit the xml file to virsh I get the following error:

===============================================================
# virsh create vmTemplete-1.xml 
error: Failed to create domain from vmTemplete-1.xml
error: internal error Process exited while reading console log output: char device \
redirected to /dev/pts/3 char device redirected to /dev/pts/4
open /dev/kvm: No such file or
 directory
Could not initialize KVM, will disable KVM support
kvm: -device virtserialport,bus=virtio-serial0.0,nr=1,chardev=charchannel0,id=channel0,name=org.linux-kvm.port.1: \
virtio-serial-bus: Out-of-range port id specified, max. allowed: 0

kvm: -device virtserialport,bus=virtio-serial0.0,nr=1,chardev=charchannel0,id=channel0,name=org.linux-kvm.port.1: \
Device 'virtserialport' could not be initialized

===========================================================

What could be the problem ? Could any one please point to the correct direction with \
regard to this.

Regards
sl






      
-----Inline Attachment Follows-----

_______________________________________________
libvirt-users mailing list
libvirt-users@redhat.com
https://www.redhat.com/mailman/listinfo/libvirt-users


      


[Attachment #3 (text/html)]

&lt;table cellspacing="0" cellpadding="0" border="0" &gt;&lt;tr&gt;&lt;td valign="top" style="font: \
inherit;"&gt;Hello,&lt;br&gt;&lt;br&gt;On changing the machine type to "machine='pc-0.13" in the xml \
file. I was able to proceed further.&lt;br&gt;&lt;br&gt;&lt;br&gt;Regards&lt;br&gt;sl&lt;br&gt;&lt;br&gt;--- On &lt;b&gt;Sat, \
12/3/11, SAURAV LAHIRI &lt;i&gt;&lt;saurav_lahiri@yahoo.com&gt;&lt;/i&gt;&lt;/b&gt; \
wrote:&lt;br&gt;&lt;blockquote style="border-left: 2px solid rgb(16, 16, 255); margin-left: \
5px; padding-left: 5px;"&gt;&lt;br&gt;From: SAURAV LAHIRI \
&lt;saurav_lahiri@yahoo.com&gt;&lt;br&gt;Subject: [libvirt-users] Issue creating vm \
channel&lt;br&gt;To: libvirt-users@redhat.com&lt;br&gt;Date: Saturday, 12 March, 2011, \
11:33&lt;br&gt;&lt;br&gt;&lt;div id="yiv501300699"&gt;&lt;table border="0" cellpadding="0" \
cellspacing="0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td style="font: inherit;" valign="top"&gt;Hello,&lt;br&gt;I am \
trying to create a lucid guest VM with a vmchannel between the guest and the \
hypervisor. Details below:&lt;br&gt;&lt;br&gt;KERNEL:&lt;br&gt;# uname -a&lt;br&gt;Linux saurav-desktop \
2.6.38-2-generic #29~lucid1-Ubuntu SMP Mon Feb 7  13:35:14 UTC 2011 i686 \
GNU/Linux&lt;br&gt;&lt;br&gt;QEMU:&lt;br&gt;# /usr/bin/qemu --version&lt;br&gt;QEMU emulator version 0.13.0, \
Copyright (c) 2003-2008 Fabrice Bellard&lt;br&gt;&lt;br&gt;LIBVIRT:&lt;br&gt;# /usr/sbin/libvirtd \
--version&lt;br&gt;/usr/local/sbin/libvirtd (libvirt) 0.8.8&lt;br&gt;&lt;br&gt;&lt;br&gt;Below is a snippet \
of my libvirt xml file.&lt;br&gt;&lt;br&gt;===============================================================&lt;br&gt;&lt;domain \
type='kvm' id='16'&gt;&lt;br&gt;  &lt;name&gt;FinalTest&lt;/name&gt;&lt;br&gt;  \
&lt;uuid&gt;212bc1f1-b4f7-1ed3-7dc3-2b4b82ab68d1&lt;/uuid&gt;&lt;br&gt;  \
&lt;memory&gt;1048576&lt;/memory&gt;&lt;br&gt;  \
&lt;currentMemory&gt;1048576&lt;/currentMemory&gt;&lt;br&gt;   \
&lt;vcpu&gt;1&lt;/vcpu&gt;&lt;br&gt;  &lt;os&gt;&lt;br&gt;    &lt;type \
arch='x86_64' machine='pc-0.12'&gt;hvm&lt;/type&gt;&lt;br&gt;    &lt;boot \
dev='hd'/&gt;&lt;br&gt;  &lt;/os&gt;&lt;br&gt;  &lt;features&gt;&lt;br&gt;    \
&lt;acpi/&gt;&lt;br&gt;    &lt;apic/&gt;&lt;br&gt;    \
&lt;pae/&gt;&lt;br&gt;  &lt;/features&gt;&lt;br&gt;  &lt;clock \
offset='utc'/&gt;&lt;br&gt;  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;&lt;br&gt;  \
&lt;on_reboot&gt;destroy&lt;/on_reboot&gt;&lt;br&gt;  \
&lt;on_crash&gt;destroy&lt;/on_crash&gt;&lt;br&gt;  \
&lt;devices&gt;&lt;br&gt;    \
&lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;&lt;br&gt;&lt;br&gt;&lt;controller \
type='virtio-serial' index='0' max_ports='15' vectors='4'/&gt;&lt;br&gt;&lt;channel \
type='pty'&gt;&lt;br&gt;  &lt;target type='virtio' \
name='org.linux-kvm.port.1'/&gt;&lt;br&gt; &lt;address type='virtio-serial' \
controller='0' bus='0'/&gt;&lt;br&gt;&lt;/channel&gt;&lt;br&gt;&lt;br&gt;    &lt;disk  \
type='file' device='disk'&gt;&lt;br&gt;      &lt;driver \
name='qemu' type='qcow2'/&gt;&lt;br&gt;      &lt;source \
file='/home/user1/linux_installed/image.cow2'/&gt;&lt;br&gt;      \
&lt;target dev='hda' bus='ide'/&gt;&lt;br&gt;      &lt;alias \
name='ide-disk0'/&gt;&lt;br&gt;        &lt;address \
type='drive' controller='0' bus='0' unit='0'/&gt;&lt;br&gt;    \
&lt;/disk&gt;&lt;br&gt;================================================================&lt;br&gt;&lt;br&gt;When \
i submit the xml file to virsh I get the following \
error:&lt;br&gt;&lt;br&gt;===============================================================&lt;br&gt;# \
virsh create vmTemplete-1.xml &lt;br&gt;error: Failed to create domain from \
vmTemplete-1.xml&lt;br&gt;error: internal error Process exited while reading console log \
output: char device redirected to /dev/pts/3&lt;br&gt;char device redirected to \
/dev/pts/4&lt;br&gt;open /dev/kvm: No such file or  directory&lt;br&gt;Could not initialize KVM, \
will disable KVM support&lt;br&gt;kvm: -device \
virtserialport,bus=virtio-serial0.0,nr=1,chardev=charchannel0,id=channel0,name=org.linux-kvm.port.1: \
virtio-serial-bus: Out-of-range port id specified, max. allowed: 0&lt;br&gt;&lt;br&gt;kvm: \
-device virtserialport,bus=virtio-serial0.0,nr=1,chardev=charchannel0,id=channel0,name=org.linux-kvm.port.1: \
Device 'virtserialport' could not be \
initialized&lt;br&gt;&lt;br&gt;===========================================================&lt;br&gt;&lt;br&gt;What \
could be the problem ? Could any one please point to the correct direction with \
regard to this.&lt;br&gt;&lt;br&gt;Regards&lt;br&gt;sl&lt;br&gt;&lt;br&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;br&gt;



      &lt;/div&gt;&lt;br&gt;-----Inline Attachment Follows-----&lt;br&gt;&lt;br&gt;&lt;div \
class="plainMail"&gt;_______________________________________________&lt;br&gt;libvirt-users \
mailing list&lt;br&gt;&lt;a ymailto="mailto:libvirt-users@redhat.com" \
href="/mc/compose?to=libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;&lt;a \
href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;br&gt;




      



</body></email><email><emailId>20110314132217</emailId><senderName>"C.D."</senderName><senderEmail>ccd.stoy.ml@gmail.com</senderEmail><timestampReceived>2011-03-14 13:22:17-0400</timestampReceived><subject>Re: [libvirt-users] Libvirt with multipath devices and/or FC on NPIV</subject><body>

Ooops,

I am sorry for the multiposting

[Attachment #3 (text/html)]

Ooops,&lt;br&gt;&lt;br&gt;I am sorry for the multiposting&lt;br&gt;


</body></email><email><emailId>20110314132345</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2011-03-14 13:23:45-0400</timestampReceived><subject>Re: [libvirt-users] ruby bindings has two gems (I think)</subject><body>

On 03/13/11 - 06:59:36AM, James Barkley wrote:
&gt; Thanks for the info. Are there any plans to extend the functionality of the
&gt; ruby-libvirt gem beyond just the bindings? For instance, convenience
&gt; functions, OVF parsing, etc? We have needed this functionality so ended up
&gt; building a gem called "ovfparse" for fetching and parsing these types of
&gt; files (code at https://github.com/ruby-ovf/ovfparse).

The current bindings are, indeed, just a thin wrapper on top of the libvirt
API.  I have had some requests (and patches) for a higher-level, more ruby-like
layer on top of the standard bindings.  I haven't yet had time to take a look
at them, but I am not opposed to having a better library on top.

-- 
Chris Lalancette

</body></email><email><emailId>20110314150814</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-03-14 15:08:14-0400</timestampReceived><subject>Re: [libvirt-users] QEMU monitor</subject><body>

于 2011年03月14日 22:42, Nikita A Menkovich 写道:
&gt; Thanks for your reply,
&gt;
&gt; $ virsh update-device user user.xml --persistent
&gt; error: Failed to update device from user.xml
&gt; error: Requested operation is not valid: cannot modify the persistent
&gt; configuration of a domain
&gt; Without persistent it updates only live password, but in xml it is not modified
&gt;
&gt; 2011/3/14 Osier Yang&lt;jyang@redhat.com&gt;:
&gt;&gt; 于 2011年03月12日 21:14, Nikita A Menkovich 写道:
&gt;&gt;&gt; Hello,
&gt;&gt;&gt;
&gt;&gt;&gt; Is there any way to change VNC password without rebooting virtual machine?
&gt;&gt;&gt; It is available through qemu monitor, but, it seems, there is no way
&gt;&gt;&gt; to do add monitor to kvm.
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt; If you are mean how to do with libvirt.
&gt;&gt;
&gt;&gt; # cat demo.xml
&gt;&gt; &lt;graphics type='vnc' port='0' autoport='yes' listen='127.0.0.1'
&gt;&gt; keymap='en-us' passwd='111111'/&gt;
&gt;&gt;
&gt;&gt; # virsh update-device demo.xml --persistent
&gt;&gt;
&gt;&gt; NB, "--persistent" is optional, which is intended to change the vnc
&gt;&gt; password persistently.

It means "persistent" changing is still not supported. :-)
&gt;&gt;
&gt;&gt; Regards
&gt;&gt; Osier
&gt;&gt;
&gt;&gt;
&gt;
&gt;
&gt;

</body></email><email><emailId>20110314163951</emailId><senderName>Zvi Dubitzky</senderName><senderEmail>dubi@il.ibm.com</senderEmail><timestampReceived>2011-03-14 16:39:51-0400</timestampReceived><subject>[libvirt-users] cgroups limitations on Virtual machines</subject><body>

I have 2 VMs  launched by : 'virsh create &lt;xml file&gt;' .  Both VMs get 2 
vcpus (out of total 2 cores of  the host) 
I then try bias their cpu cycle quota by manipulating the cpu_shares ( 
virsh schedinfo --set cpu_shares=&lt;value&gt; vm1/2 ) so that   VM1 will get 3 
times the cpu cycles VM2 gets.
(e.g : VM1 cpu_shares = 150 . VM2 cpu_shares = 50) .
There are no other VMs defined or any other significant process running on 
the host .
Each VM runs the same process (2 threads endless loop ).
Still both VM1 and VM2 get equal share of the 2 cores - running top 
utility
at the host shows each is consuming 100% CPU.
At each VM console cat /proc/cpuinfo shows 2 cores assigned to the VM.
At the host : virsh vcpuinfo &lt;vm1/2&gt; shows each has 2 vcpus (0 an 1 )but 
actually a single separate CPU is used for either vcpu0 or vcpu1 at each 
VM at any check point in time  (this is reasonable as it does not say what 
portion of the core cycles is used by each VM) .

Can anyone explain that and how to  bias the core usage of the 2 VMs by 
manipulating the cpu_shares parameter (or other parameters) so that 'top' 
at the host will reflect the bias . I would expect  'top' at the host  to 
show 150% CPU for VM1 ( qemu-system-x86) and 50% CPU for  VM2 (the other  
qemu-system-x86)  with above set cpu_share values .

Doing the same test with 2 plain processes (instead VMs udner libvirt) 
with same cpu_shares bias gives the expected biased cpu usage between the 
2 processes

My system is fedora14 and kernel 2.6.35.6-45.fc14.x86_64 .

thanks

Zvi Dubitzky 
Email:dubi@il.ibm.com


</body></email><email><emailId>20110315101239</emailId><senderName>kadir_yüceer</senderName><senderEmail>kadiryuceer@gmail.com</senderEmail><timestampReceived>2011-03-15 10:12:39-0400</timestampReceived><subject>Re: [libvirt-users] Beware! Newbie is in town</subject><body>

ldconfig seemed to perform the magic. Everything is working right now, and
also netbeans, when I run libvirtd beforehand.

Thanks for help.
Kind regards
Kadir

2011/3/15 Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;

&gt; 2011/3/15 kadir y=FCceer &lt;kadiryuceer@gmail.com&gt;:
&gt; &gt;
&gt; &gt;
&gt; &gt; 2011/3/15 Berend Dekens &lt;berend@cyberwizzard.nl&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; It looks to me like you don't have libvirt set up properly as the ".so=
"
&gt; &gt;&gt; file is a library which should be available in a system default
&gt; location.
&gt; &gt;
&gt; &gt; Well I downloaded libvirt-0.8.8.tar.gz and run ./configure; make; insta=
ll
&gt; &gt; successfully. And I'm logged in as root(always). Is there something els=
e
&gt; &gt; that I should do, except adding jna.jar and the jar file within
&gt; &gt; libvirt-java-0.4.7.tar.gz to the libraries section of my java project?
&gt; I'm
&gt; &gt; trying to run the sample code test.java on http://libvirt.org/java.html=
.
&gt; &gt;
&gt;
&gt; Running just ./configure without any options should make it install
&gt; under the /usr/local prefix. /usr/local/bin should be in PATH by
&gt; default, that's why you can run virsh, but ld fails to find
&gt; libvirt.so.
&gt;
&gt; Did you try to run ldconfig as root to update ld's cache? That might help=
.
&gt;
&gt; Matthias
&gt;

[Attachment #3 (text/html)]

ldconfig seemed to perform the magic. Everything is working right now, and also \
netbeans, when I run libvirtd beforehand. &lt;br&gt;&lt;br&gt;Thanks for help.&lt;br&gt;Kind \
regards&lt;br&gt;Kadir&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;2011/3/15 Matthias Bolte &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;
 &lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px \
solid rgb(204, 204, 204); padding-left: 1ex;"&gt;2011/3/15 kadir yüceer &lt;&lt;a \
href="mailto:kadiryuceer@gmail.com"&gt;kadiryuceer@gmail.com&lt;/a&gt;&gt;:&lt;br&gt;

&lt;div class="im"&gt;&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt; 2011/3/15 Berend Dekens &lt;&lt;a \
href="mailto:berend@cyberwizzard.nl"&gt;berend@cyberwizzard.nl&lt;/a&gt;&gt;&lt;br&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; It looks to me like you don't have libvirt set up properly as the \
".so"&lt;br&gt; &gt;&gt; file is a library which should be available in a system \
default location.&lt;br&gt; &gt;&lt;br&gt;
&gt; Well I downloaded libvirt-0.8.8.tar.gz and run ./configure; make; install&lt;br&gt;
&gt; successfully. And I'm logged in as root(always). Is there something else&lt;br&gt;
&gt; that I should do, except adding jna.jar and the jar file within&lt;br&gt;
&gt; libvirt-java-0.4.7.tar.gz to the libraries section of my java project? \
I'm&lt;br&gt; &gt; trying to run the sample code test.java on &lt;a \
href="http://libvirt.org/java.html" \
target="_blank"&gt;http://libvirt.org/java.html&lt;/a&gt;.&lt;br&gt; &gt;&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;Running just ./configure without any options should make it install&lt;br&gt;
under the /usr/local prefix. /usr/local/bin should be in PATH by&lt;br&gt;
default, that's why you can run virsh, but ld fails to find&lt;br&gt;
libvirt.so.&lt;br&gt;
&lt;br&gt;
Did you try to run ldconfig as root to update ld's cache? That might help.&lt;br&gt;
&lt;font color="#888888"&gt;&lt;br&gt;
Matthias&lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110315151114</emailId><senderName>sd</senderName><senderEmail>dioda11@gmail.com</senderEmail><timestampReceived>2011-03-15 15:11:14-0400</timestampReceived><subject>[libvirt-users] remote xen+ssh://host</subject><body>

Hello,

Is there a way where I can connect remote via ssh on a host and specify the
username / password ?
So far I found out that only the username can be specified and that
will ssh keys.

I would like something like

xen+ssh://user:password@host

thanks

sd

</body></email><email><emailId>20110316160713</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2011-03-16 16:07:13-0400</timestampReceived><subject>Re: [libvirt-users] With which VMM ,libvirt cooperates the most?</subject><body>

On 03/16/2011 06:08 AM, kadir yüceer wrote:
&gt; Hi all,
&gt;
&gt; I'm trying to develop some applications that communicate with VMM 
&gt; about guest OSs. Libvirt has drivers for many VMMs like Qemu, Vbox, 
&gt; etc. I'm currently using Vbox and time to time I get the error that 
&gt; says "this function is not supported by the connection driver".
&gt;
&gt; So, for which VMM, libvirt has the most compatible driver, regarding 
&gt; your experiences?

It seems like the most activity centers around KVM/Qemu, and to a lesser 
extent Xen, but there is certainly work going on for the Vbox, LXC and 
VMWare ports. A lot depends on what your host platform supports best. 
(Personally everything I do is really done with KVM/Qemu in mind).

</body></email><email><emailId>20110316162354</emailId><senderName>JT Justman</senderName><senderEmail>jjustman@uoregon.edu</senderEmail><timestampReceived>2011-03-16 16:23:54-0400</timestampReceived><subject>Re: [libvirt-users] SSH recovery console</subject><body>

Nikita,

I don't know the answer to your specific question, but if your goal is 
to not use VNC insecurely, what I do is create the VNC port and secure 
it with host's firewall, then use ssh tunneling to only allow 
authenticated SSH clients to connect.

Hope this helps,

JT

On 3/16/2011 8:47 AM, Nikita A Menkovich wrote:
&gt; Hello,
&gt;
&gt; Is there available to create ssh recovery console except vnc console,
&gt; that is default by libvirt.
&gt; For example connect to kvm@host:2220 and go to first console
&gt; For example like here
&gt; &lt;serial type="tcp"&gt;
&gt;        &lt;source mode="bind" host="127.0.0.1" service="2445"/&gt;
&gt;        &lt;protocol type="telnet"/&gt;
&gt;        &lt;target port="1"/&gt;
&gt;      &lt;/serial&gt;
&gt; But not plain format
&gt;

-- 
JT Justman
Web Developer
Center on Teaching and Learning
University of Oregon
541-346-1781

</body></email><email><emailId>20110317170933</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-03-17 17:09:33-0400</timestampReceived><subject>Re: [libvirt-users] RH6 qemu expects driver name</subject><body>

On Thu, Mar 17, 2011 at 06:03:13PM +0100, Robert Å mol wrote:
&gt; On 03/17/2011 12:17 PM, Daniel P. Berrange wrote:
&gt; &gt;On Wed, Mar 16, 2011 at 12:45:45PM +0100, Robert Å mol wrote:
&gt; &gt;&gt;Hi,
&gt; &gt;&gt;I am trying to start machine on RH6.
&gt; &gt;&gt;
&gt; &gt;&gt;virsh # start ulp-001
&gt; &gt;&gt;error: Failed to start domain ulp-001
&gt; &gt;&gt;error: internal error process exited while connecting to monitor:
&gt; &gt;&gt;char device redirected to /dev/pts/1
&gt; &gt;&gt;qemu-kvm: -device lsi,id=scsi0,bus=pci.0,addr=0x5: Parameter
&gt; &gt;&gt;'driver' expects a driver name
&gt; &gt;This is a really terrible QEMU error message. What it actually
&gt; &gt;means is that LSI SCSI is not supported in this QEMU binary.
&gt; &gt;
&gt; &gt;Only IDE or VirtIO are supported block drivers in RHEL. No SCSI
&gt; &gt;and no USB
&gt; &gt;
&gt; &gt;Regards,
&gt; &gt;Daniel
&gt; Hi, this is bad, we want to migrate some machines from VMWare, but
&gt; internal scripts relly on /dev/sda to be present. Is the support for
&gt; 'scsi' planned for RHEL6?

I expect it is fairly unlikely in the short term, since the QEMU code
has some significant problems in the SCSI area wrt both performance
and data integrity. VirtIO Block is going to be faster&amp; more reliable,
and IDE is going to be more reliable too (not sure of speed of IDE vs
SCSI)

Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110318100315</emailId><senderName>Kurian Thayil</senderName><senderEmail>kurianmthayil@gmail.com</senderEmail><timestampReceived>2011-03-18 10:03:15-0400</timestampReceived><subject>[libvirt-users] libvirtd -- iptables</subject><body>

Hi All,

I created a couple of virtual networks (forward mode=nat) in my
rhel6-kvm box. I've come across 2 weird issues.
1. My Iptables rule chainset contains repeated rules. The same rule gets
repeated block by block
2. For connecting to guest using SSH, I created a custom IPTables chain.
I want this chain to be on top of the FORWARD chain, but everytime the
libvirtd is restarted the rule comes to the bottom of the chain (Appended).

Can anyone suggest me what the solution could be? My IPtable rules are
given below: Let me know if any further info is needed.

[root@santiago Packages]# iptables -L -n -v
Chain INPUT (policy ACCEPT 41 packets, 5818 bytes)
 pkts bytes target     prot opt in     out     source              
destination        
    0     0 ACCEPT     udp  --  vbr0   *       0.0.0.0/0           
0.0.0.0/0           udp dpt:53
    0     0 ACCEPT     tcp  --  vbr0   *       0.0.0.0/0           
0.0.0.0/0           tcp dpt:53
    0     0 ACCEPT     udp  --  vbr0   *       0.0.0.0/0           
0.0.0.0/0           udp dpt:67
    0     0 ACCEPT     tcp  --  vbr0   *       0.0.0.0/0           
0.0.0.0/0           tcp dpt:67
    0     0 ACCEPT     udp  --  vbr1   *       0.0.0.0/0           
0.0.0.0/0           udp dpt:53
    0     0 ACCEPT     tcp  --  vbr1   *       0.0.0.0/0           
0.0.0.0/0           tcp dpt:53
    0     0 ACCEPT     udp  --  vbr1   *       0.0.0.0/0           
0.0.0.0/0           udp dpt:67
    0     0 ACCEPT     tcp  --  vbr1   *       0.0.0.0/0           
0.0.0.0/0           tcp dpt:67
    0     0 ACCEPT     udp  --  vbr0   *       0.0.0.0/0           
0.0.0.0/0           udp dpt:53
    0     0 ACCEPT     tcp  --  vbr0   *       0.0.0.0/0           
0.0.0.0/0           tcp dpt:53
    0     0 ACCEPT     udp  --  vbr0   *       0.0.0.0/0           
0.0.0.0/0           udp dpt:67
    0     0 ACCEPT     tcp  --  vbr0   *       0.0.0.0/0           
0.0.0.0/0           tcp dpt:67
    0     0 ACCEPT     udp  --  vbr1   *       0.0.0.0/0           
0.0.0.0/0           udp dpt:53
    0     0 ACCEPT     tcp  --  vbr1   *       0.0.0.0/0           
0.0.0.0/0           tcp dpt:53
    0     0 ACCEPT     udp  --  vbr1   *       0.0.0.0/0           
0.0.0.0/0           udp dpt:67
    0     0 ACCEPT     tcp  --  vbr1   *       0.0.0.0/0           
0.0.0.0/0           tcp dpt:67
    0     0 ACCEPT     udp  --  vbr0   *       0.0.0.0/0           
0.0.0.0/0           udp dpt:53
    0     0 ACCEPT     tcp  --  vbr0   *       0.0.0.0/0           
0.0.0.0/0           tcp dpt:53
    0     0 ACCEPT     udp  --  vbr0   *       0.0.0.0/0           
0.0.0.0/0           udp dpt:67
    0     0 ACCEPT     tcp  --  vbr0   *       0.0.0.0/0           
0.0.0.0/0           tcp dpt:67
    0     0 ACCEPT     udp  --  vbr1   *       0.0.0.0/0           
0.0.0.0/0           udp dpt:53
    0     0 ACCEPT     tcp  --  vbr1   *       0.0.0.0/0           
0.0.0.0/0           tcp dpt:53
    0     0 ACCEPT     udp  --  vbr1   *       0.0.0.0/0           
0.0.0.0/0           udp dpt:67
    0     0 ACCEPT     tcp  --  vbr1   *       0.0.0.0/0           
0.0.0.0/0           tcp dpt:67
    0     0 ACCEPT     udp  --  vbr0   *       0.0.0.0/0           
0.0.0.0/0           udp dpt:53
    0     0 ACCEPT     tcp  --  vbr0   *       0.0.0.0/0           
0.0.0.0/0           tcp dpt:53
    0     0 ACCEPT     udp  --  vbr0   *       0.0.0.0/0           
0.0.0.0/0           udp dpt:67
    0     0 ACCEPT     tcp  --  vbr0   *       0.0.0.0/0           
0.0.0.0/0           tcp dpt:67
    0     0 ACCEPT     udp  --  vbr1   *       0.0.0.0/0           
0.0.0.0/0           udp dpt:53
    0     0 ACCEPT     tcp  --  vbr1   *       0.0.0.0/0           
0.0.0.0/0           tcp dpt:53
    0     0 ACCEPT     udp  --  vbr1   *       0.0.0.0/0           
0.0.0.0/0           udp dpt:67
    0     0 ACCEPT     tcp  --  vbr1   *       0.0.0.0/0           
0.0.0.0/0           tcp dpt:67
    0     0 ACCEPT     udp  --  vbr0   *       0.0.0.0/0           
0.0.0.0/0           udp dpt:53
    0     0 ACCEPT     tcp  --  vbr0   *       0.0.0.0/0           
0.0.0.0/0           tcp dpt:53
    0     0 ACCEPT     udp  --  vbr0   *       0.0.0.0/0           
0.0.0.0/0           udp dpt:67
    0     0 ACCEPT     tcp  --  vbr0   *       0.0.0.0/0           
0.0.0.0/0           tcp dpt:67
    0     0 ACCEPT     udp  --  vbr1   *       0.0.0.0/0           
0.0.0.0/0           udp dpt:53
    0     0 ACCEPT     tcp  --  vbr1   *       0.0.0.0/0           
0.0.0.0/0           tcp dpt:53
    0     0 ACCEPT     udp  --  vbr1   *       0.0.0.0/0           
0.0.0.0/0           udp dpt:67
    0     0 ACCEPT     tcp  --  vbr1   *       0.0.0.0/0           
0.0.0.0/0           tcp dpt:67

Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source              
destination        
    0     0 ACCEPT     all  --  *      vbr0    0.0.0.0/0           
10.10.0.0/24        state RELATED,ESTABLISHED
    0     0 ACCEPT     all  --  vbr0   *       10.10.0.0/24        
0.0.0.0/0          
    0     0 ACCEPT     all  --  vbr0   vbr0    0.0.0.0/0           
0.0.0.0/0          
    0     0 REJECT     all  --  *      vbr0    0.0.0.0/0           
0.0.0.0/0           reject-with icmp-port-unreachable
    0     0 REJECT     all  --  vbr0   *       0.0.0.0/0           
0.0.0.0/0           reject-with icmp-port-unreachable
    0     0 ACCEPT     all  --  *      vbr1    0.0.0.0/0           
10.10.1.0/24        state RELATED,ESTABLISHED
    0     0 ACCEPT     all  --  vbr1   *       10.10.1.0/24        
0.0.0.0/0          
    0     0 ACCEPT     all  --  vbr1   vbr1    0.0.0.0/0           
0.0.0.0/0          
    0     0 REJECT     all  --  *      vbr1    0.0.0.0/0           
0.0.0.0/0           reject-with icmp-port-unreachable
    0     0 REJECT     all  --  vbr1   *       0.0.0.0/0           
0.0.0.0/0           reject-with icmp-port-unreachable
 5688  588K rhel-virt-forward-1  all  --  *      *      
0.0.0.0/0            0.0.0.0/0          
    0     0 ACCEPT     all  --  *      vbr0    0.0.0.0/0           
10.10.0.0/24        state RELATED,ESTABLISHED
    0     0 ACCEPT     all  --  vbr0   *       10.10.0.0/24        
0.0.0.0/0          
    0     0 ACCEPT     all  --  vbr0   vbr0    0.0.0.0/0           
0.0.0.0/0          
    0     0 REJECT     all  --  *      vbr0    0.0.0.0/0           
0.0.0.0/0           reject-with icmp-port-unreachable
    0     0 REJECT     all  --  vbr0   *       0.0.0.0/0           
0.0.0.0/0           reject-with icmp-port-unreachable
    0     0 ACCEPT     all  --  *      vbr1    0.0.0.0/0           
10.10.1.0/24        state RELATED,ESTABLISHED
    0     0 ACCEPT     all  --  vbr1   *       10.10.1.0/24        
0.0.0.0/0          
    0     0 ACCEPT     all  --  vbr1   vbr1    0.0.0.0/0           
0.0.0.0/0          
    0     0 REJECT     all  --  *      vbr1    0.0.0.0/0           
0.0.0.0/0           reject-with icmp-port-unreachable
    0     0 REJECT     all  --  vbr1   *       0.0.0.0/0           
0.0.0.0/0           reject-with icmp-port-unreachable
    0     0 ACCEPT     all  --  *      vbr0    0.0.0.0/0           
10.10.0.0/24        state RELATED,ESTABLISHED
    0     0 ACCEPT     all  --  vbr0   *       10.10.0.0/24        
0.0.0.0/0          
    0     0 ACCEPT     all  --  vbr0   vbr0    0.0.0.0/0           
0.0.0.0/0          
    0     0 REJECT     all  --  *      vbr0    0.0.0.0/0           
0.0.0.0/0           reject-with icmp-port-unreachable
    0     0 REJECT     all  --  vbr0   *       0.0.0.0/0           
0.0.0.0/0           reject-with icmp-port-unreachable
    0     0 ACCEPT     all  --  *      vbr1    0.0.0.0/0           
10.10.1.0/24        state RELATED,ESTABLISHED
    0     0 ACCEPT     all  --  vbr1   *       10.10.1.0/24        
0.0.0.0/0          
    0     0 ACCEPT     all  --  vbr1   vbr1    0.0.0.0/0           
0.0.0.0/0          
    0     0 REJECT     all  --  *      vbr1    0.0.0.0/0           
0.0.0.0/0           reject-with icmp-port-unreachable
    0     0 REJECT     all  --  vbr1   *       0.0.0.0/0           
0.0.0.0/0           reject-with icmp-port-unreachable
    0     0 ACCEPT     all  --  *      vbr0    0.0.0.0/0           
10.10.0.0/24        state RELATED,ESTABLISHED
    0     0 ACCEPT     all  --  vbr0   *       10.10.0.0/24        
0.0.0.0/0          
    0     0 ACCEPT     all  --  vbr0   vbr0    0.0.0.0/0           
0.0.0.0/0          
    0     0 REJECT     all  --  *      vbr0    0.0.0.0/0           
0.0.0.0/0           reject-with icmp-port-unreachable
    0     0 REJECT     all  --  vbr0   *       0.0.0.0/0           
0.0.0.0/0           reject-with icmp-port-unreachable
    0     0 ACCEPT     all  --  *      vbr1    0.0.0.0/0           
10.10.1.0/24        state RELATED,ESTABLISHED
    0     0 ACCEPT     all  --  vbr1   *       10.10.1.0/24        
0.0.0.0/0          
    0     0 ACCEPT     all  --  vbr1   vbr1    0.0.0.0/0           
0.0.0.0/0          
    0     0 REJECT     all  --  *      vbr1    0.0.0.0/0           
0.0.0.0/0           reject-with icmp-port-unreachable
    0     0 REJECT     all  --  vbr1   *       0.0.0.0/0           
0.0.0.0/0           reject-with icmp-port-unreachable
    0     0 ACCEPT     all  --  *      vbr0    0.0.0.0/0           
10.10.0.0/24        state RELATED,ESTABLISHED
    0     0 ACCEPT     all  --  vbr0   *       10.10.0.0/24        
0.0.0.0/0          
    0     0 ACCEPT     all  --  vbr0   vbr0    0.0.0.0/0           
0.0.0.0/0          
    0     0 REJECT     all  --  *      vbr0    0.0.0.0/0           
0.0.0.0/0           reject-with icmp-port-unreachable
    0     0 REJECT     all  --  vbr0   *       0.0.0.0/0           
0.0.0.0/0           reject-with icmp-port-unreachable
    0     0 ACCEPT     all  --  *      vbr1    0.0.0.0/0           
10.10.1.0/24        state RELATED,ESTABLISHED
    0     0 ACCEPT     all  --  vbr1   *       10.10.1.0/24        
0.0.0.0/0          
    0     0 ACCEPT     all  --  vbr1   vbr1    0.0.0.0/0           
0.0.0.0/0          
    0     0 REJECT     all  --  *      vbr1    0.0.0.0/0           
0.0.0.0/0           reject-with icmp-port-unreachable
    0     0 REJECT     all  --  vbr1   *       0.0.0.0/0           
0.0.0.0/0           reject-with icmp-port-unreachable
    0     0 ACCEPT     all  --  *      *       0.0.0.0/0           
0.0.0.0/0           PHYSDEV match --physdev-is-bridged

Chain OUTPUT (policy ACCEPT 38 packets, 4234 bytes)
 pkts bytes target     prot opt in     out     source              
destination        

Chain rhel-virt-forward-1 (1 references)
 pkts bytes target     prot opt in     out     source              
destination        
   25  2100 ACCEPT     icmp --  eth0   vbr1    0.0.0.0/0           
0.0.0.0/0          
 3515  262K ACCEPT     tcp  --  eth0   vbr1    0.0.0.0/0           
0.0.0.0/0           tcp dpt:22
    0     0 ACCEPT     icmp --  eth0   vbr0    0.0.0.0/0           
0.0.0.0/0          
    0     0 ACCEPT     tcp  --  eth0   vbr0    0.0.0.0/0           
0.0.0.0/0           tcp dpt:22


**************Details about my virtual network interfaces are given below:

[root@santiago Packages]# virsh net-list --all
Name                 State      Autostart
-----------------------------------------
vir0                 active     yes      
vir1                 active     yes

Thank you in advance.

Regards,
--Kurian.

[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
&lt;head&gt;

&lt;meta http-equiv="content-type" content="text/html; charset=ISO-8859-1"&gt;
&lt;/head&gt;
&lt;body text="#000000" bgcolor="#ffffff"&gt;
&lt;font size="-1"&gt;&lt;font face="Liberation Mono"&gt;Hi All,&lt;br&gt;
&lt;br&gt;
&lt;/font&gt;&lt;/font&gt;
&lt;div align="justify"&gt;&lt;font size="-1"&gt;&lt;font face="Liberation Mono"&gt;I
created a couple of virtual networks (forward mode=nat) in my rhel6-kvm
box. I've come across 2 weird issues.&lt;br&gt;
1. My Iptables rule chainset contains repeated rules. The same rule
gets repeated block by block&lt;br&gt;
2. For connecting to guest using SSH, I created a custom IPTables
chain. I want this chain to be on top of the FORWARD chain, but
everytime the libvirtd is restarted the rule comes to the bottom of the
chain (Appended).&lt;br&gt;
&lt;br&gt;
Can anyone suggest me what the solution could be? My IPtable rules are
given below: Let me know if any further info is needed.&lt;br&gt;
&lt;br&gt;
[root@santiago Packages]# iptables -L -n -v&lt;br&gt;
Chain INPUT (policy ACCEPT 41 packets, 5818 bytes)&lt;br&gt;
 pkts bytes target     prot opt in     \
out     \
source              
 destination         &lt;br&gt;
    0     0 ACCEPT     \
udp  --  vbr0   *       \
0.0.0.0/0            \
0.0.0.0/0           udp dpt:53 &lt;br&gt; \
    0     0 ACCEPT     \
tcp  --  vbr0   *       \
0.0.0.0/0            \
0.0.0.0/0           tcp dpt:53 &lt;br&gt; \
    0     0 ACCEPT     \
udp  --  vbr0   *       \
0.0.0.0/0            \
0.0.0.0/0           udp dpt:67 &lt;br&gt; \
    0     0 ACCEPT     \
tcp  --  vbr0   *       \
0.0.0.0/0            \
0.0.0.0/0           tcp dpt:67 &lt;br&gt; \
    0     0 ACCEPT     \
udp  --  vbr1   *       \
0.0.0.0/0            \
0.0.0.0/0           udp dpt:53 &lt;br&gt; \
    0     0 ACCEPT     \
tcp  --  vbr1   *       \
0.0.0.0/0            \
0.0.0.0/0           tcp dpt:53 &lt;br&gt; \
    0     0 ACCEPT     \
udp  --  vbr1   *       \
0.0.0.0/0            \
0.0.0.0/0           udp dpt:67 &lt;br&gt; \
    0     0 ACCEPT     \
tcp  --  vbr1   *       \
0.0.0.0/0            \
0.0.0.0/0           tcp dpt:67 &lt;br&gt; \
    0     0 ACCEPT     \
udp  --  vbr0   *       \
0.0.0.0/0            \
0.0.0.0/0           udp dpt:53 &lt;br&gt; \
    0     0 ACCEPT     \
tcp  --  vbr0   *       \
0.0.0.0/0            \
0.0.0.0/0           tcp dpt:53 &lt;br&gt; \
    0     0 ACCEPT     \
udp  --  vbr0   *       \
0.0.0.0/0            \
0.0.0.0/0           udp dpt:67 &lt;br&gt; \
    0     0 ACCEPT     \
tcp  --  vbr0   *       \
0.0.0.0/0            \
0.0.0.0/0           tcp dpt:67 &lt;br&gt; \
    0     0 ACCEPT     \
udp  --  vbr1   *       \
0.0.0.0/0            \
0.0.0.0/0           udp dpt:53 &lt;br&gt; \
    0     0 ACCEPT     \
tcp  --  vbr1   *       \
0.0.0.0/0            \
0.0.0.0/0           tcp dpt:53 &lt;br&gt; \
    0     0 ACCEPT     \
udp  --  vbr1   *       \
0.0.0.0/0            \
0.0.0.0/0           udp dpt:67 &lt;br&gt; \
    0     0 ACCEPT     \
tcp  --  vbr1   *       \
0.0.0.0/0            \
0.0.0.0/0           tcp dpt:67 &lt;br&gt; \
    0     0 ACCEPT     \
udp  --  vbr0   *       \
0.0.0.0/0            \
0.0.0.0/0           udp dpt:53 &lt;br&gt; \
    0     0 ACCEPT     \
tcp  --  vbr0   *       \
0.0.0.0/0            \
0.0.0.0/0           tcp dpt:53 &lt;br&gt; \
    0     0 ACCEPT     \
udp  --  vbr0   *       \
0.0.0.0/0            \
0.0.0.0/0           udp dpt:67 &lt;br&gt; \
    0     0 ACCEPT     \
tcp  --  vbr0   *       \
0.0.0.0/0            \
0.0.0.0/0           tcp dpt:67 &lt;br&gt; \
    0     0 ACCEPT     \
udp  --  vbr1   *       \
0.0.0.0/0            \
0.0.0.0/0           udp dpt:53 &lt;br&gt; \
    0     0 ACCEPT     \
tcp  --  vbr1   *       \
0.0.0.0/0            \
0.0.0.0/0           tcp dpt:53 &lt;br&gt; \
    0     0 ACCEPT     \
udp  --  vbr1   *       \
0.0.0.0/0            \
0.0.0.0/0           udp dpt:67 &lt;br&gt; \
    0     0 ACCEPT     \
tcp  --  vbr1   *       \
0.0.0.0/0            \
0.0.0.0/0           tcp dpt:67 &lt;br&gt; \
    0     0 ACCEPT     \
udp  --  vbr0   *       \
0.0.0.0/0            \
0.0.0.0/0           udp dpt:53 &lt;br&gt; \
    0     0 ACCEPT     \
tcp  --  vbr0   *       \
0.0.0.0/0            \
0.0.0.0/0           tcp dpt:53 &lt;br&gt; \
    0     0 ACCEPT     \
udp  --  vbr0   *       \
0.0.0.0/0            \
0.0.0.0/0           udp dpt:67 &lt;br&gt; \
    0     0 ACCEPT     \
tcp  --  vbr0   *       \
0.0.0.0/0            \
0.0.0.0/0           tcp dpt:67 &lt;br&gt; \
    0     0 ACCEPT     \
udp  --  vbr1   *       \
0.0.0.0/0            \
0.0.0.0/0           udp dpt:53 &lt;br&gt; \
    0     0 ACCEPT     \
tcp  --  vbr1   *       \
0.0.0.0/0            \
0.0.0.0/0           tcp dpt:53 &lt;br&gt; \
    0     0 ACCEPT     \
udp  --  vbr1   *       \
0.0.0.0/0            \
0.0.0.0/0           udp dpt:67 &lt;br&gt; \
    0     0 ACCEPT     \
tcp  --  vbr1   *       \
0.0.0.0/0            \
0.0.0.0/0           tcp dpt:67 &lt;br&gt; \
    0     0 ACCEPT     \
udp  --  vbr0   *       \
0.0.0.0/0            \
0.0.0.0/0           udp dpt:53 &lt;br&gt; \
    0     0 ACCEPT     \
tcp  --  vbr0   *       \
0.0.0.0/0            \
0.0.0.0/0           tcp dpt:53 &lt;br&gt; \
    0     0 ACCEPT     \
udp  --  vbr0   *       \
0.0.0.0/0            \
0.0.0.0/0           udp dpt:67 &lt;br&gt; \
    0     0 ACCEPT     \
tcp  --  vbr0   *       \
0.0.0.0/0            \
0.0.0.0/0           tcp dpt:67 &lt;br&gt; \
    0     0 ACCEPT     \
udp  --  vbr1   *       \
0.0.0.0/0            \
0.0.0.0/0           udp dpt:53 &lt;br&gt; \
    0     0 ACCEPT     \
tcp  --  vbr1   *       \
0.0.0.0/0            \
0.0.0.0/0           tcp dpt:53 &lt;br&gt; \
    0     0 ACCEPT     \
udp  --  vbr1   *       \
0.0.0.0/0            \
0.0.0.0/0           udp dpt:67 &lt;br&gt; \
    0     0 ACCEPT     \
tcp  --  vbr1   *       \
0.0.0.0/0            \
0.0.0.0/0           tcp dpt:67 &lt;br&gt; \
&lt;br&gt; Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)&lt;br&gt;
 pkts bytes target     prot opt in     \
out     \
source              
 destination         &lt;br&gt;
    0     0 ACCEPT     \
all  --  *      vbr0    \
0.0.0.0/0            \
10.10.0.0/24        state RELATED,ESTABLISHED &lt;br&gt; \
    0     0 ACCEPT     \
all  --  vbr0   *       \
10.10.0.0/24         \
0.0.0.0/0           &lt;br&gt; \
    0     0 ACCEPT     \
all  --  vbr0   vbr0    \
0.0.0.0/0            \
0.0.0.0/0           &lt;br&gt; \
    0     0 REJECT     \
all  --  *      vbr0    \
0.0.0.0/0            \
0.0.0.0/0           reject-with \
icmp-port-unreachable &lt;br&gt;     0     0 \
REJECT     all  --  vbr0   \
*       \
0.0.0.0/0            \
0.0.0.0/0           reject-with \
icmp-port-unreachable &lt;br&gt;     0     0 \
ACCEPT     all  --  *      \
vbr1    \
0.0.0.0/0            \
10.10.1.0/24        state RELATED,ESTABLISHED &lt;br&gt; \
    0     0 ACCEPT     \
all  --  vbr1   *       \
10.10.1.0/24         \
0.0.0.0/0           &lt;br&gt; \
    0     0 ACCEPT     \
all  --  vbr1   vbr1    \
0.0.0.0/0            \
0.0.0.0/0           &lt;br&gt; \
    0     0 REJECT     \
all  --  *      vbr1    \
0.0.0.0/0            \
0.0.0.0/0           reject-with \
icmp-port-unreachable &lt;br&gt;     0     0 \
REJECT     all  --  vbr1   \
*       \
0.0.0.0/0            \
0.0.0.0/0           reject-with \
icmp-port-unreachable &lt;br&gt; &lt;font color="#cc0000"&gt; 5688  588K \
                rhel-virt-forward-1  all  --  \
                *     
*       \
0.0.0.0/0            \
0.0.0.0/0           &lt;/font&gt;&lt;br&gt; \
    0     0 ACCEPT     \
all  --  *      vbr0    \
0.0.0.0/0            \
10.10.0.0/24        state RELATED,ESTABLISHED &lt;br&gt; \
    0     0 ACCEPT     \
all  --  vbr0   *       \
10.10.0.0/24         \
0.0.0.0/0           &lt;br&gt; \
    0     0 ACCEPT     \
all  --  vbr0   vbr0    \
0.0.0.0/0            \
0.0.0.0/0           &lt;br&gt; \
    0     0 REJECT     \
all  --  *      vbr0    \
0.0.0.0/0            \
0.0.0.0/0           reject-with \
icmp-port-unreachable &lt;br&gt;     0     0 \
REJECT     all  --  vbr0   \
*       \
0.0.0.0/0            \
0.0.0.0/0           reject-with \
icmp-port-unreachable &lt;br&gt;     0     0 \
ACCEPT     all  --  *      \
vbr1    \
0.0.0.0/0            \
10.10.1.0/24        state RELATED,ESTABLISHED &lt;br&gt; \
    0     0 ACCEPT     \
all  --  vbr1   *       \
10.10.1.0/24         \
0.0.0.0/0           &lt;br&gt; \
    0     0 ACCEPT     \
all  --  vbr1   vbr1    \
0.0.0.0/0            \
0.0.0.0/0           &lt;br&gt; \
    0     0 REJECT     \
all  --  *      vbr1    \
0.0.0.0/0            \
0.0.0.0/0           reject-with \
icmp-port-unreachable &lt;br&gt;     0     0 \
REJECT     all  --  vbr1   \
*       \
0.0.0.0/0            \
0.0.0.0/0           reject-with \
icmp-port-unreachable &lt;br&gt;     0     0 \
ACCEPT     all  --  *      \
vbr0    \
0.0.0.0/0            \
10.10.0.0/24        state RELATED,ESTABLISHED &lt;br&gt; \
    0     0 ACCEPT     \
all  --  vbr0   *       \
10.10.0.0/24         \
0.0.0.0/0           &lt;br&gt; \
    0     0 ACCEPT     \
all  --  vbr0   vbr0    \
0.0.0.0/0            \
0.0.0.0/0           &lt;br&gt; \
    0     0 REJECT     \
all  --  *      vbr0    \
0.0.0.0/0            \
0.0.0.0/0           reject-with \
icmp-port-unreachable &lt;br&gt;     0     0 \
REJECT     all  --  vbr0   \
*       \
0.0.0.0/0            \
0.0.0.0/0           reject-with \
icmp-port-unreachable &lt;br&gt;     0     0 \
ACCEPT     all  --  *      \
vbr1    \
0.0.0.0/0            \
10.10.1.0/24        state RELATED,ESTABLISHED &lt;br&gt; \
    0     0 ACCEPT     \
all  --  vbr1   *       \
10.10.1.0/24         \
0.0.0.0/0           &lt;br&gt; \
    0     0 ACCEPT     \
all  --  vbr1   vbr1    \
0.0.0.0/0            \
0.0.0.0/0           &lt;br&gt; \
    0     0 REJECT     \
all  --  *      vbr1    \
0.0.0.0/0            \
0.0.0.0/0           reject-with \
icmp-port-unreachable &lt;br&gt;     0     0 \
REJECT     all  --  vbr1   \
*       \
0.0.0.0/0            \
0.0.0.0/0           reject-with \
icmp-port-unreachable &lt;br&gt;     0     0 \
ACCEPT     all  --  *      \
vbr0    \
0.0.0.0/0            \
10.10.0.0/24        state RELATED,ESTABLISHED &lt;br&gt; \
    0     0 ACCEPT     \
all  --  vbr0   *       \
10.10.0.0/24         \
0.0.0.0/0           &lt;br&gt; \
    0     0 ACCEPT     \
all  --  vbr0   vbr0    \
0.0.0.0/0            \
0.0.0.0/0           &lt;br&gt; \
    0     0 REJECT     \
all  --  *      vbr0    \
0.0.0.0/0            \
0.0.0.0/0           reject-with \
icmp-port-unreachable &lt;br&gt;     0     0 \
REJECT     all  --  vbr0   \
*       \
0.0.0.0/0            \
0.0.0.0/0           reject-with \
icmp-port-unreachable &lt;br&gt;     0     0 \
ACCEPT     all  --  *      \
vbr1    \
0.0.0.0/0            \
10.10.1.0/24        state RELATED,ESTABLISHED &lt;br&gt; \
    0     0 ACCEPT     \
all  --  vbr1   *       \
10.10.1.0/24         \
0.0.0.0/0           &lt;br&gt; \
    0     0 ACCEPT     \
all  --  vbr1   vbr1    \
0.0.0.0/0            \
0.0.0.0/0           &lt;br&gt; \
    0     0 REJECT     \
all  --  *      vbr1    \
0.0.0.0/0            \
0.0.0.0/0           reject-with \
icmp-port-unreachable &lt;br&gt;     0     0 \
REJECT     all  --  vbr1   \
*       \
0.0.0.0/0            \
0.0.0.0/0           reject-with \
icmp-port-unreachable &lt;br&gt;     0     0 \
ACCEPT     all  --  *      \
vbr0    \
0.0.0.0/0            \
10.10.0.0/24        state RELATED,ESTABLISHED &lt;br&gt; \
    0     0 ACCEPT     \
all  --  vbr0   *       \
10.10.0.0/24         \
0.0.0.0/0           &lt;br&gt; \
    0     0 ACCEPT     \
all  --  vbr0   vbr0    \
0.0.0.0/0            \
0.0.0.0/0           &lt;br&gt; \
    0     0 REJECT     \
all  --  *      vbr0    \
0.0.0.0/0            \
0.0.0.0/0           reject-with \
icmp-port-unreachable &lt;br&gt;     0     0 \
REJECT     all  --  vbr0   \
*       \
0.0.0.0/0            \
0.0.0.0/0           reject-with \
icmp-port-unreachable &lt;br&gt;     0     0 \
ACCEPT     all  --  *      \
vbr1    \
0.0.0.0/0            \
10.10.1.0/24        state RELATED,ESTABLISHED &lt;br&gt; \
    0     0 ACCEPT     \
all  --  vbr1   *       \
10.10.1.0/24         \
0.0.0.0/0           &lt;br&gt; \
    0     0 ACCEPT     \
all  --  vbr1   vbr1    \
0.0.0.0/0            \
0.0.0.0/0           &lt;br&gt; \
    0     0 REJECT     \
all  --  *      vbr1    \
0.0.0.0/0            \
0.0.0.0/0           reject-with \
icmp-port-unreachable &lt;br&gt;     0     0 \
REJECT     all  --  vbr1   \
*       \
0.0.0.0/0            \
0.0.0.0/0           reject-with \
icmp-port-unreachable &lt;br&gt;     0     0 \
ACCEPT     all  --  *      \
*       \
0.0.0.0/0            \
0.0.0.0/0           PHYSDEV match \
--physdev-is-bridged &lt;br&gt; &lt;br&gt;
Chain OUTPUT (policy ACCEPT 38 packets, 4234 bytes)&lt;br&gt;
 pkts bytes target     prot opt in     \
out     \
source              
 destination         &lt;br&gt;
&lt;br&gt;
Chain rhel-virt-forward-1 (1 references)&lt;br&gt;
 pkts bytes target     prot opt in     \
out     \
source              
 destination         &lt;br&gt;
   25  2100 ACCEPT     icmp --  \
eth0   vbr1    \
0.0.0.0/0            \
0.0.0.0/0           &lt;br&gt; \
 3515  262K ACCEPT     tcp  --  \
eth0   vbr1    \
0.0.0.0/0            \
0.0.0.0/0           tcp dpt:22 &lt;br&gt; \
    0     0 ACCEPT     icmp \
--  eth0   vbr0    \
0.0.0.0/0            \
0.0.0.0/0           &lt;br&gt; \
    0     0 ACCEPT     \
tcp  --  eth0   vbr0    \
0.0.0.0/0            \
0.0.0.0/0           tcp dpt:22&lt;br&gt; \
&lt;br&gt; &lt;br&gt;
**************Details about my virtual network interfaces are given
below:&lt;br&gt;
&lt;br&gt;
[root@santiago Packages]# virsh net-list --all&lt;br&gt;
Name                 \
                State      Autostart&lt;br&gt;
-----------------------------------------&lt;br&gt;
vir0                 \
active     yes       &lt;br&gt; \
vir1                 \
active     yes&lt;br&gt; &lt;br&gt;
Thank you in advance.&lt;br&gt;
&lt;br&gt;
Regards,&lt;br&gt;
--Kurian.&lt;br&gt;
&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20110321095337</emailId><senderName>Christoph Raible</senderName><senderEmail>c.raible@science-computing.de</senderEmail><timestampReceived>2011-03-21 09:53:37-0400</timestampReceived><subject>[libvirt-users] error : remoteDispatchAuthPolkit:3799 : Policy kit denied action org.libvirt.unix.ma</subject><body>

Hi @all,

first my system:

OS:  Scientific Linux 6.0
Hypervisor:  KVM + libvirt

I got the following error

/*error : remoteDispatchAuthPolkit:3799 : Policy kit denied action \
org.libvirt.unix.manage from pid 2381*/

when I want to connect with:

/*virsh -c qemu:///system*/

to the hypervisor with a new added user.

The user is in in kvm and qmeu group and the connection with virsh -c \
qemu://$hostname/system works fine. Also root login with the "login" works fine.

I configured libvirt to use TLS-authetification...



Did anyone of you have a solution to solve this problem.




Best Regards

Christoph Raible


-- 
Vorstand/Board of Management:
Dr. Bernd Finkbeiner, Dr. Roland Niemeier, 
Dr. Arno Steitz, Dr. Ingrid Zech
Vorsitzender des Aufsichtsrats/
Chairman of the Supervisory Board:
Michel Lepert
Sitz/Registered Office: Tuebingen
Registergericht/Registration Court: Stuttgart
Registernummer/Commercial Register No.: HRB 382196 


[Attachment #3 (unknown)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
  &lt;head&gt;

    &lt;meta http-equiv="content-type" content="text/html; charset=ISO-8859-15"&gt;
  &lt;/head&gt;
  &lt;body bgcolor="#ffffff" text="#000000"&gt;
    &lt;pre&gt;Hi @all,&lt;/pre&gt;
    &lt;pre&gt;
first my system:&lt;/pre&gt;
    &lt;pre&gt;OS:  Scientific Linux 6.0
Hypervisor:  KVM + libvirt&lt;/pre&gt;
    &lt;pre&gt;
&lt;/pre&gt;
    &lt;pre&gt;I got the following error &lt;/pre&gt;
    &lt;pre&gt;&lt;i&gt;&lt;b&gt;error : remoteDispatchAuthPolkit:3799 : Policy kit denied action \
org.libvirt.unix.manage from pid 2381&lt;/b&gt;&lt;/i&gt;&lt;/pre&gt;  &lt;pre&gt;
when I want to connect with:&lt;/pre&gt;
    &lt;pre&gt;&lt;i&gt;&lt;b&gt;virsh -c qemu:///system &lt;/b&gt;&lt;/i&gt;&lt;/pre&gt;
    &lt;pre&gt;to the hypervisor with a new added user.&lt;/pre&gt;
    &lt;pre&gt;
The user is in in kvm and qmeu group and the connection with virsh -c \
qemu://$hostname/system works fine. Also root login with the "login" works fine.
&lt;/pre&gt;
    &lt;pre&gt;
I configured libvirt to use TLS-authetification... 



Did anyone of you have a solution to solve this problem.




Best Regards

Christoph Raible

&lt;/pre&gt;
  &lt;font face="monospace"&gt;-- &lt;br&gt;
Vorstand/Board of Management:&lt;br&gt;
Dr. Bernd Finkbeiner, Dr. Roland Niemeier, &lt;br&gt;
Dr. Arno Steitz, Dr. Ingrid Zech&lt;br&gt;
Vorsitzender des Aufsichtsrats/&lt;br&gt;
Chairman of the Supervisory Board:&lt;br&gt;
Michel Lepert&lt;br&gt;
Sitz/Registered Office: Tuebingen&lt;br&gt;
Registergericht/Registration Court: Stuttgart&lt;br&gt;
Registernummer/Commercial Register No.: HRB 382196 &lt;br&gt;
&lt;/font&gt;&lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20110321144741</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-03-21 14:47:41-0400</timestampReceived><subject>Re: [libvirt-users] start/stop hooks</subject><body>

于 2011年03月21日 17:31, Mateusz Kijowski 写道:
&gt; Hi list,
&gt;
&gt;
&gt; I have a quick question. Is there a way to run a script on the libvirt
&gt; host after a domain is started/stopped ?

Current hooks implenmation execute the hook script before domain start
, and after the domain is stopped. So, it can satisfy one of your
requirement. :-)

http://libvirt.org/hooks.html

Regards
Osier

</body></email><email><emailId>20110321144908</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-03-21 14:49:08-0400</timestampReceived><subject>Re: [libvirt-users] About monitoring</subject><body>

于 2011年03月21日 20:47, kadir yüceer 写道:
&gt; Hello all,
&gt; As I've been exporing libvirt api, I've seen event registerers, and
&gt; types of events are defined, undefined, and you know the rest. Is it all
&gt; for event types? Any ideas about how to look for a device access event,
&gt; for example?
&gt;
&gt; Kind regards

AFAIK, there are some domain lifecycle events, also perhaps
several migration events? can't remeber clearly.

Regards
Osier

</body></email><email><emailId>20110321151044</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-03-21 15:10:44-0400</timestampReceived><subject>Re: [libvirt-users] using more than 1  core by a virtual machine</subject><body>

$BP2(B 2011$BG/(B03$B7n(B21$BF|(B 16:49, Zvi Dubitzky $B&lt;LF;(B:
&gt; Zvi Dubitzky
&gt; Email:dubi@il.ibm.com
&gt; IBM Haifa Research Laboratory    Phone: +972-4-8296182
&gt; Haifa, 31905, ISRAEL
&gt; 
&gt; 
&gt; 
&gt; Osier Yang&lt;jyang@redhat.com&gt;  wrote on 21/03/2011 10:27:07:
&gt; 
&gt;&gt; From: Osier Yang&lt;jyang@redhat.com&gt;
&gt;&gt; To: Zvi Dubitzky/Haifa/IBM@IBMIL
&gt;&gt; Cc: libvirt-users@redhat.com
&gt;&gt; Date: 21/03/2011 10:27
&gt;&gt; Subject: Re: [libvirt-users] using more than 1  core by a virtual
&gt; machine
&gt;&gt;
&gt;&gt; $BP2(B 2011$BG/(B03$B7n(B17$BF|(B 02:04, Zvi Dubitzky $B&lt;LF;(B:
&gt;&gt;&gt; My virtual machine xml file has&lt;vcpu&gt;2&lt;/vcpu&gt;    clause  while the host
&gt; has
&gt;&gt;&gt; 2 physical cpus (cores).
&gt;&gt;&gt; Is this enough to cause a VM  running 2 endless loop threads  to use
&gt; the 2
&gt;&gt;&gt;    cores ?
&gt;&gt;&gt; In my case the VM running reports (cat /roc/cpuinfo) that it has 2
&gt; vcpus
&gt;&gt;&gt; but it uses only 1 core (at a time)  because
&gt;&gt;&gt; the 'top' at the host shows 100%cpu   (out of total 200%)  used by the
&gt;&gt;&gt; endless loop application
&gt;&gt;&gt; Also virsh vcpuinfo&lt;vm&gt;   shows only 1 CPU and 1 vcpu
&gt;&gt;
&gt;&gt; Is it really only 1 vcpu is showed? it should be two, that's
&gt;&gt; strange if you specified two vcpus, but only 1 is showed.
&gt;&gt; and by default, if you don't specify "cpuset" in&lt;vcpu&gt;, it uses
&gt;&gt; all the physical cpus, if I'm right, so you should be able to
&gt;&gt; see something like:
&gt;&gt;
&gt;&gt;      CPU Affinity:   yy
&gt;&gt;
&gt;&gt; Could you try specify "cpuset" explicitly like:
&gt;&gt;
&gt;&gt; &lt;vcpu cpuset="0,1"&gt;2&lt;/vcpu&gt;
&gt;&gt;
&gt;&gt; And see what it happens?
&gt;&gt;
&gt; 
&gt; NO. There 2 vcpus in the VM screen . I pasted only one of them . yes there
&gt; is
&gt; PU Affinity:   yy   anyhow in 'virsh  vcpuinfo&lt;domain&gt;  even before fixing
&gt; the problem as below.
&gt; 
&gt; I solved the problem : The BIOS did not have VT enabled although
&gt; multiprocessing item was already enabled in the BIOS and also some item
&gt; called "virtualization " was already  enabled . But that was not enough :
&gt; I also had to drop the following clause from the VM xml file:
&gt; '&lt;emulator&gt;/usr/local/bin/qemu-system-x86_64&lt;/emulator&gt;'
&gt; Anyhow: I do not understand why using multicore under a VM is dependent on
&gt; the VT enabled
&gt; 
&gt; Now the 'top' utility (at the host) shows qemu-kvm is the running  process
&gt; instead of qemu-system-x86_64 as before the fix . On the another Debian
&gt; system I did not have to drop the&lt;emulator&gt;  clause from the xml and the
&gt; VM was still using all the cores  though ! But the libvirt at the Debian
&gt; was newer (0.8.6) while the fedora14 was running libvirt 0.8.3
&gt; 
&gt; Do you know what is exactly qemu-system-x86_64 vs. qemu-kvm .

Simpley speaking, qemu-kvm is with kvm support, while qemu-system-x86-64
is not.

 Does the
&gt; latter appear only if
&gt; HW virtualization is active in the BIOS ?
&gt; 

Not sure what your exact meaning, but I guess you mean it appears in
domain xml. If so:

libvirt contruct the capability of qemu driver when libvirtd starts,
if your host doesn't enable VT support, then kvm module is not loaded,
libvirt inspects if "/dev/kvm" is accessiable to determine whether to
use "qemu-kvm" as emulator in the capability xml or not. That's why
it's not &lt;emulator&gt;/usr/libexec/qemu-kvm&lt;/emulator&gt; in your domain xml.

It's not the detailed explaination, but simply makes sense for you.

To see the qemu guest capabilities your host supports:

# virsh -c qemu:///system capabilities

And anyway, I don't think multicore for VM relates with the emulator,
if qemu-kvm is used, vcpus are virtualized by KVM, if qemu-system-x86_64
is used, they are emulated.

Regards
Osier

</body></email><email><emailId>20110323072750</emailId><senderName>Zvi Dubitzky</senderName><senderEmail>dubi@il.ibm.com</senderEmail><timestampReceived>2011-03-23 07:27:50-0400</timestampReceived><subject>Re: [libvirt-users] storage pool vs storage volume</subject><body>

some more on pools ( storage and volume):

1. Are they  used for data storage only or also for images

2. How are they used by a VM , via the  &lt;device&gt; element ? Does libvirt 
knows how to use it
    or some additional staff (aside from defining ) is needed :

3. Does one has to specify both storage pool and a volume or just the 
volume is enough (in the VM XML) ?

thanks


Zvi Dubitzky 
Email:dubi@il.ibm.com



Osier Yang &lt;jyang@redhat.com&gt; wrote on 21/03/2011 10:16:50:

&gt; From: Osier Yang &lt;jyang@redhat.com&gt;
&gt; To: Zvi Dubitzky/Haifa/IBM@IBMIL
&gt; Cc: libvirt-users@redhat.com
&gt; Date: 21/03/2011 10:17
&gt; Subject: Re: [libvirt-users] storage pool vs storage volume
&gt; 
&gt; $BP2(B 2011$BG/(B03$B7n(B21$BF|(B 15:07, Zvi Dubitzky $B&lt;LF;(B:
&gt; &gt; Can anybody give a good reference to  understand the difference 
between
&gt; &gt; storage pool and storage volume
&gt; &gt;&gt; From  what I have seem storage volume describes the physical storage 
media
&gt; &gt;   and the pool a collection of such
&gt; &gt; But from the XML at libvirt  I do not exactly understand that .
&gt; &gt;
&gt; 
&gt; Take the "directory" pool as example, you can simple imagine
&gt; the pool is the directory, and the volume is the files under
&gt; that directory.
&gt; 
&gt; Regards
&gt; Osier

</body></email><email><emailId>20110324095105</emailId><senderName>Igor Serebryany</senderName><senderEmail>igor47@moomers.org</senderEmail><timestampReceived>2011-03-24 09:51:05-0400</timestampReceived><subject>Re: [libvirt-users] libvirt unavailable while a VM is in migration?]</subject><body>


I recently had a chance to come back to this problem, and I'm sorry to
say that it hasn't gotten any better. I tested on debian sid with a
stock install of kvm 0.14 and libvirt 0.8.8-3 -- i'm still completely
unable to interact with libvirt while an outgoing migration is in
progress, although it seems as though actual migrations have gotten much
faster.

just an fyi.

--Igor

On Wed, Dec 29, 2010 at 05:06:12PM -0600, Igor Serebryany wrote:
&gt; I've opened a bug to track this issue:
&gt; https://bugzilla.redhat.com/show_bug.cgi?id=666266
&gt; 
&gt; I have tried to work around the issue by making my migrations non-live,
&gt; hoping that the shorter downtime will make this less of a big deal. But
&gt; migrating busy domains with lots of RAM still takes a surprisingly long
&gt; time even if the domain is paused during migration -- something I did
&gt; not expect.
&gt; 
&gt; For instance, a domain with 8 GB of ram migrating over a gigabit network
&gt; takes about 20 seconds if the domain is idle and not using much ram.
&gt; However, if I start a run of 'stress' inside the VM which uses 6 gigs of
&gt; RAM in random malloc/free calls, the same domain might take 20 minutes
&gt; to migrate. 
&gt; 
&gt; Has anyone else experienced this? Is there some kind of compression
&gt; going on when doing tunneled migrations which breaks down when the pages
&gt; are dirty?
&gt; 
&gt; --Igor
&gt; 
&gt; On Thu, Dec 23, 2010 at 06:13:35AM +1100, Justin Clift wrote:
&gt; &gt; On 23/12/2010, at 5:44 AM, Igor Serebryany wrote:
&gt; &gt; &gt; On Mon, Dec 20, 2010 at 02:14:42PM +0100, Jiri Denemark wrote:
&gt; &gt; &gt;&gt; Ouch, I wonder if that could be the reason...
&gt; &gt; &gt; 
&gt; &gt; &gt; Just to make sure that my strange compiling/packages aren't causing the
&gt; &gt; &gt; problem, I've set up two servers running fedora 14 with the official
&gt; &gt; &gt; libvirt packages. i experience the same problem -- while a vm is in
&gt; &gt; &gt; migration, nothing else works. my traces reveal libvirt getting stuck at
&gt; &gt; &gt; the same exact spot as on my debian machines.
&gt; &gt; 
&gt; &gt; This sounded familiar, so went looking in git history.  I *think* this is
&gt; &gt; what was sounding familiar, from ~ libvirt 0.8.2:
&gt; &gt; 
&gt; &gt; commit 755b53f946107539ba6faf3022450b3d0bbe1d78
&gt; &gt; Author: Daniel P. Berrange &lt;berrange@redhat.com&gt;
&gt; &gt; Date:   Thu Jun 24 19:15:27 2010 +0100
&gt; &gt; 
&gt; &gt;     Avoid blocking all APIs during incoming migration
&gt; &gt;    
&gt; &gt;     During incoming migration the QEMU monitor is not able to be
&gt; &gt;     used. The incoming migration code did not keep hold of the
&gt; &gt;     job lock because migration is split across multiple API calls.
&gt; &gt;     This meant that further monitor commands on the guest would
&gt; &gt;     hang until migration finished with no timeout.
&gt; &gt;    
&gt; &gt;     In this change the qemuDomainMigratePrepare method sets the
&gt; &gt;     job flag just before it returns. The qemuDomainMigrateFinish
&gt; &gt;     method checks for this job flag &amp; clears it once done. This
&gt; &gt;     prevents any use of the monitor between prepare+finish steps.
&gt; &gt;    
&gt; &gt;     The qemuDomainGetJobInfo method is also updated to refresh
&gt; &gt;     the job elapsed time. This means that virsh domjobinfo can
&gt; &gt;     return time data during incoming migration
&gt; &gt;    
&gt; &gt;     * src/qemu/qemu_driver.c: Keep a job active during incoming
&gt; &gt;       migration. Refresh job elapsed time when returning job info
&gt; &gt; 
&gt; &gt; Anyone know if this is actually relevant?
&gt; &gt; 
&gt; &gt; 
&gt; &gt; &gt; i am desperate to get this bug fixed, and i don't think i have the
&gt; &gt; &gt; resources to try to patch it myself. is there anything i can do to help
&gt; &gt; &gt; you guys? more debugging info? foot massage?
&gt; &gt; 
&gt; &gt; Good idea.  Foot massages would definitely be an incentive I
&gt; &gt; could be convinced with. :)
&gt; &gt; 
&gt; &gt; (it would probably help if I was the right kind of coder for this,
&gt; &gt; but I'm not)



&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20110325083920</emailId><senderName>Christoph Raible</senderName><senderEmail>c.raible@science-computing.de</senderEmail><timestampReceived>2011-03-25 08:39:20-0400</timestampReceived><subject>Re: [libvirt-users] livemigration over specific bridge/nic?</subject><body>

Am 25.03.2011 05:45, schrieb Osier Yang:
&gt; 于 2011年03月24日 20:33, Christoph Raible 写道:
&gt;&gt; Hi @all,
&gt;&gt;
&gt;&gt; I have a question about the livemigration with libvirt / kvm.
&gt;&gt;
&gt;&gt; I have two bridges configured in my setup of each host. Now I want to
&gt;&gt; set br1 (private network) as default NIC for live migration.
&gt;
&gt; libvirt doesn't support to bind a specified interface for the
&gt; live migration socket.

Hmm thats pity :D

&gt;
&gt;&gt;
&gt;&gt; Is there any solution to get this work for me?
&gt;&gt;
&gt;&gt; I tried to bind libvirt to those IP-Range but after that the
&gt;&gt; livemigration doesn't works.
&gt;
&gt; Curious, how did you do that? :-)
&gt;

This was a false description by me :-) I bound libvirt not to an 
IP-Range. I bound it to the specific IP-address of the bridge ;)

I've done this on this option:

# Override the default configuration which binds to all network
# interfaces. This can be a numeric IPv4/6 address, or hostname
#
listen_addr = "192.168.2.10"


&gt; Regards
&gt; Osier
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users


-- 
Vorstand/Board of Management:
Dr. Bernd Finkbeiner, Dr. Roland Niemeier, 
Dr. Arno Steitz, Dr. Ingrid Zech
Vorsitzender des Aufsichtsrats/
Chairman of the Supervisory Board:
Michel Lepert
Sitz/Registered Office: Tuebingen
Registergericht/Registration Court: Stuttgart
Registernummer/Commercial Register No.: HRB 382196 


</body></email><email><emailId>20110325154806</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2011-03-25 15:48:06-0400</timestampReceived><subject>Re: [libvirt-users] how to restart the network connection of kvm guest	OS ?</subject><body>

On 03/25/2011 12:43 AM, Osier Yang wrote:
&gt; ÓÚ 2011Äê03Ô 24ÈÕ 19:16, ºÎÎÄ´Ï Ð´µÀ:
&gt;&gt; When a vm move from one VLAN(e.g. VLAN 1) to another VLAN (e.g. VLAN 2),
&gt;&gt; it is needed to restart the network connection of guest OS, so that it
&gt;&gt; can begin a dhcp discover and get a new ip again. But i can't find the
&gt;&gt; way to restart the guest os's network connection by libvirt (neither
&gt;&gt; python API nor virsh command). Is any other ways?
&gt;
&gt; Hi,
&gt;
&gt; Won't virt-manager (if has) in your guest try to restart the network?
&gt;
&gt;&gt; PS: i found that the VirtualBox can detach the cable of VMs and
&gt;&gt; re-attach so that the guest OS will recognize and restart a dhcp
&gt;&gt; discover when the cable re-attach. I guess the KVM will have some
&gt;&gt; feature like that , is anybody know something about that?
&gt;
&gt; Libvirt supports similar function.
&gt; # virsh detach-interface
&gt; # virsh attach-interface
&gt;
&gt; Or
&gt; # virsh detach-device
&gt; # virsh attach-device
&gt;
&gt; the difference between "*-device" and "*-interface" is the
&gt; accepted arguments, the later one accepts interface xml.

Those present to the guest as if the interface itself was being 
unplugged. What he's looking for is a way to just emulate a loss of 
carrier on the interface (ie unplugging the *cable*). There is an open 
bug for that:

https://bugzilla.redhat.com/show_bug.cgi?id=643373

but no work has been done on it yet.

Note that the required qemu monitor command does exist: "set_link XXX 
off" and "set_link XXX on", but I was unable to get a form of "virsh 
qemu-monitor-command" that could make this work.

</body></email><email><emailId>20110326132706</emailId><senderName>Zvi Dubitzky</senderName><senderEmail>dubi@il.ibm.com</senderEmail><timestampReceived>2011-03-26 13:27:06-0400</timestampReceived><subject>[libvirt-users] saslpasswd2 and virsh -c qemu+tcp:///system &lt;command&gt;</subject><body>

I need define a user /password for sasl but want that to do the 
verification
automatically no -promting ( or even maybe  avoid the  verification) while
using  a tcp socket with some applications that need authentication (e.g 
libvirt)

so I try :   saslpasswd2 -c -p  -a libvirt &lt;user&gt;  
 
 and it hangs (if i  now press  Enter it says :  "invalid parameter 
supplied") . if I avoid the -p flag  the above commad works fine and 
prompts for password  and later when using the tc p (virsh -c 
qemu+tcp:...) it prompts for the above defined user/password and 
autheticates ok .
But I want without the prompting 

The  man pages says
-p  Pipe mode - saslpasswd2 will neither prompt for the password nor 
verify that it was entered correctly. This is the default when standard 
input is not a terminal. 

In the past (before some upgrading of libvirt via rpm) the SASL 
authentication was done automatically no need for prompting
Don't know how to restore it .

Any help ? 

thanks

Zvi Dubitzky 
Email:dubi@il.ibm.com


</body></email><email><emailId>20110326173155</emailId><senderName>Zvi Dubitzky</senderName><senderEmail>dubi@il.ibm.com</senderEmail><timestampReceived>2011-03-26 17:31:55-0400</timestampReceived><subject>Re: [libvirt-users] libvirt-users Digest, Vol 15, Issue 25</subject><body>

Sorry, let me rephrase the question again:

I need define a user /password for sasl but want the authentication at 
runtime 
 be automatic - no explicit promting the user while accessing a tcp socket 

 with some applications that need authentication (e.g  libvirt)
 
  I try :   saslpasswd2 -c -p  -a libvirt &lt;user&gt; 

  and it hangs (if i  now press  Enter it says :  "invalid parameter 
  supplied") . if I avoid the -p flag  the above commad works fine and 
  prompts for password  and later when using the tcp (virsh -c 
  qemu+tcp:...) it prompts for the above defined user/password and 
  autheticates ok.

  But I want without the explicit authentication 



 The  man pages says :
 "-p  Pipe mode - saslpasswd2 will neither prompt for the password nor 
 verify that it was entered correctly. This is the default when standard 
 input is not a terminal. "



 In the past (before  upgrading of libvirt via rpm) I had the SASL 
 authentication  done automatically without prompting the user at runtime 
 (virsh qemu+tcp:///system &lt;command&gt; ) and without need to configure that.
 
 Don't know how to restore it .
 
 Any help ? 
 
 thanks

Zvi Dubitzky 
Email:dubi@il.ibm.com



libvirt-users-bounces@redhat.com wrote on 26/03/2011 18:00:08:

&gt; From: libvirt-users-request@redhat.com
&gt; To: libvirt-users@redhat.com
&gt; Date: 26/03/2011 18:08
&gt; Subject: libvirt-users Digest, Vol 15, Issue 25
&gt; Sent by: libvirt-users-bounces@redhat.com
&gt; 
&gt; Send libvirt-users mailing list submissions to
&gt;    libvirt-users@redhat.com
&gt; 
&gt; To subscribe or unsubscribe via the World Wide Web, visit
&gt;    https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; or, via email, send a message with subject or body 'help' to
&gt;    libvirt-users-request@redhat.com
&gt; 
&gt; You can reach the person managing the list at
&gt;    libvirt-users-owner@redhat.com
&gt; 
&gt; When replying, please edit your Subject line so it is more specific
&gt; than "Re: Contents of libvirt-users digest..."
&gt; 
&gt; 
&gt; Today's Topics:
&gt; 
&gt;    1. saslpasswd2 and virsh -c qemu+tcp:///system   &lt;command&gt;
&gt;       (Zvi Dubitzky)
&gt; 
&gt; 
&gt; ----------------------------------------------------------------------
&gt; 
&gt; Message: 1
&gt; Date: Sat, 26 Mar 2011 16:27:06 +0300
&gt; From: Zvi Dubitzky &lt;DUBI@il.ibm.com&gt;
&gt; To: libvirt-users@redhat.com
&gt; Subject: [libvirt-users] saslpasswd2 and virsh -c qemu+tcp:///system
&gt;    &lt;command&gt;
&gt; Message-ID:
&gt; &lt;OF80114F71.6895179C-ONC225785F.00498EC8-C225785F.0049E967@il.ibm.com&gt;
&gt; Content-Type: text/plain; charset="US-ASCII"
&gt; 
&gt; I need define a user /password for sasl but want that to do the 
&gt; verification
&gt; automatically no -promting ( or even maybe  avoid the  verification) 
while
&gt; using  a tcp socket with some applications that need authentication (e.g 

&gt; libvirt)
&gt; 
&gt; so I try :   saslpasswd2 -c -p  -a libvirt &lt;user&gt; 
&gt; 
&gt;  and it hangs (if i  now press  Enter it says :  "invalid parameter 
&gt; supplied") . if I avoid the -p flag  the above commad works fine and 
&gt; prompts for password  and later when using the tc p (virsh -c 
&gt; qemu+tcp:...) it prompts for the above defined user/password and 
&gt; autheticates ok .
&gt; But I want without the prompting 
&gt; 
&gt; The  man pages says
&gt; -p  Pipe mode - saslpasswd2 will neither prompt for the password nor 
&gt; verify that it was entered correctly. This is the default when standard 
&gt; input is not a terminal. 
&gt; 
&gt; In the past (before some upgrading of libvirt via rpm) the SASL 
&gt; authentication was done automatically no need for prompting
&gt; Don't know how to restore it .
&gt; 
&gt; Any help ? 
&gt; 
&gt; thanks
&gt; 
&gt; Zvi Dubitzky 
&gt; Email:dubi@il.ibm.com
&gt; 
&gt; 
&gt; 
&gt; 
&gt; ------------------------------
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; 
&gt; End of libvirt-users Digest, Vol 15, Issue 25
&gt; *********************************************

</body></email><email><emailId>20110331062928</emailId><senderName>Masanari Iida</senderName><senderEmail>standby24x7@gmail.com</senderEmail><timestampReceived>2011-03-31 06:29:28-0400</timestampReceived><subject>[libvirt-users] How to disconnect the ISO image using virsh</subject><body>

Hello,

I can attach disc ISO image to cd-rom from virsh.
And I can replace the ISO image from disc1 to disc2 using the 2nd example.

(example)
attach-disk guest01 /root/disc1.iso hdc --driver file --type cdrom
--mode readonly
attach-disk guest01 /root/disc2.iso hdc --driver file --type cdrom
--mode readonly

My question is, how can I disconnect the image from the cdrom drive using virsh.
Because, if I try to detach-disk hdc, I got following errors.

virsh # detach-disk guest01 hdc
error: Failed to detach disk
error: this function is not supported by the connection driver:
This type of device cannot be hot unplugged

What I can do is possible from virt-manager's "Disconnect" button,
(next to source path: line)  from Hardware's TAB, Disk hdc screen.
I want to do this from virsh.

OS: RHEL5.6
libvirt-0.8.2-15.el5_6.1 is used.

Regards,
Masanari Iida

</body></email><email><emailId>20110331101835</emailId><senderName>James Barkley</senderName><senderEmail>james.barkley@gmail.com</senderEmail><timestampReceived>2011-03-31 10:18:35-0400</timestampReceived><subject>[libvirt-users] ESX networking functions</subject><body>

Greeetings,
Using the latest git snapshot I noticed that none of the networking
functions are implemented in the ESX driver. No listing networks, no adding
networks, etc. This functionality seems to be fully implemented for most of
the other drivers and I don't see it on the "todo" wiki. Does anyone have an
idea if/when this might get implemented? Would others be interested if I
were to add it and submit it as a patch?

-jb

[Attachment #3 (text/html)]

Greeetings,&lt;div&gt;Using the latest git snapshot I noticed that none of the ne=
tworking functions are implemented in the ESX driver. No listing networks, =
no adding networks, etc. This functionality seems to be fully implemented f=
or most of the other drivers and I don't see it on the "todo"=
 wiki. Does anyone have an idea if/when this might get implemented? Would o=
thers be interested if I were to add it and submit it as a patch?&lt;/div&gt;
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-jb&lt;/div&gt;


</body></email><email><emailId>20110331112857</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-03-31 11:28:57-0400</timestampReceived><subject>Re: [libvirt-users] ESX networking functions</subject><body>

2011/3/31 James Barkley &lt;james.barkley@gmail.com&gt;:
&gt; Greeetings,
&gt; Using the latest git snapshot I noticed that none of the networking
&gt; functions are implemented in the ESX driver. No listing networks, no adding
&gt; networks, etc. This functionality seems to be fully implemented for most of
&gt; the other drivers and I don't see it on the "todo" wiki. Does anyone have an
&gt; idea if/when this might get implemented? Would others be interested if I
&gt; were to add it and submit it as a patch?
&gt; -jb

The networking functions aren't implemented yet, because the ESX and
the libvirt network model don't map directly. I didn't have time to
figure this out in all the necessary details yet. I'll have only
limited time to spent on libvirt and ESX development in the next
months, so I cannot give an ETA for any new features in the driver.

Regarding the implementation, once we have a sound mapping the
implementation should be the easy part.

If you want to work on that area I suggest you start by getting
familiar with the libvirt and the ESX networking model and then define
a suitable mapping between them. This might require extensions to the
libvirt network model to handle the vSwitch concept of ESX.

There might also be a legacy problem to solve. Currently the ESX port
groups are used a bridges in the libvirt domain XML config. Actually
they should be used as virtual networks. This is a shortcoming in my
original design of the ESX driver.

IIRC, Daniel P. Berrange mentioned a while ago that he is planning to
add such a virtual switch concept to libvirt. There is also vSwitch
item on the todo page.

Matthias

</body></email><email><emailId>20110331071739</emailId><senderName>Masanari Iida</senderName><senderEmail>standby24x7@gmail.com</senderEmail><timestampReceived>2011-03-31 07:17:39-0400</timestampReceived><subject>Re: [libvirt-users] How to disconnect the ISO image using virsh</subject><body>

Somebody sent me a tips.
Following command do what I wanted to do.
Thanks.

attach-disk guest01 " " hdc --driver file --type cdrom
--mode readonly

On Thu, Mar 31, 2011 at 3:29 PM, Masanari Iida &lt;standby24x7@gmail.com&gt; wrote:
&gt; Hello,
&gt;
&gt; I can attach disc ISO image to cd-rom from virsh.
&gt; And I can replace the ISO image from disc1 to disc2 using the 2nd example.
&gt;
&gt; (example)
&gt; attach-disk guest01 /root/disc1.iso hdc --driver file --type cdrom
&gt; --mode readonly
&gt; attach-disk guest01 /root/disc2.iso hdc --driver file --type cdrom
&gt; --mode readonly
&gt;
&gt; My question is, how can I disconnect the image from the cdrom drive using virsh.
&gt; Because, if I try to detach-disk hdc, I got following errors.
&gt;
&gt; virsh # detach-disk guest01 hdc
&gt; error: Failed to detach disk
&gt; error: this function is not supported by the connection driver:
&gt; This type of device cannot be hot unplugged
&gt;
&gt; What I can do is possible from virt-manager's "Disconnect" button,
&gt; (next to source path: line)  from Hardware's TAB, Disk hdc screen.
&gt; I want to do this from virsh.
&gt;
&gt; OS: RHEL5.6
&gt; libvirt-0.8.2-15.el5_6.1 is used.
&gt;
&gt; Regards,
&gt; Masanari Iida
&gt;

</body></email><email><emailId>20110331094647</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-03-31 09:46:47-0400</timestampReceived><subject>Re: [libvirt-users] How to disconnect the ISO image using virsh</subject><body>

于 2011年03月31日 15:17, Masanari Iida 写道:
&gt; Somebody sent me a tips.
&gt; Following command do what I wanted to do.
&gt; Thanks.
&gt;
&gt; attach-disk guest01 " " hdc --driver file --type cdrom
&gt; --mode readonly

Also using "update-device" with an xml which doesn't specify
the source file path will work.

&gt; On Thu, Mar 31, 2011 at 3:29 PM, Masanari Iida&lt;standby24x7@gmail.com&gt;  wrote:
&gt;&gt; Hello,
&gt;&gt;
&gt;&gt; I can attach disc ISO image to cd-rom from virsh.
&gt;&gt; And I can replace the ISO image from disc1 to disc2 using the 2nd example.
&gt;&gt;
&gt;&gt; (example)
&gt;&gt; attach-disk guest01 /root/disc1.iso hdc --driver file --type cdrom
&gt;&gt; --mode readonly
&gt;&gt; attach-disk guest01 /root/disc2.iso hdc --driver file --type cdrom
&gt;&gt; --mode readonly
&gt;&gt;
&gt;&gt; My question is, how can I disconnect the image from the cdrom drive using virsh.
&gt;&gt; Because, if I try to detach-disk hdc, I got following errors.
&gt;&gt;
&gt;&gt; virsh # detach-disk guest01 hdc
&gt;&gt; error: Failed to detach disk
&gt;&gt; error: this function is not supported by the connection driver:
&gt;&gt; This type of device cannot be hot unplugged
&gt;&gt;
&gt;&gt; What I can do is possible from virt-manager's "Disconnect" button,
&gt;&gt; (next to source path: line)  from Hardware's TAB, Disk hdc screen.
&gt;&gt; I want to do this from virsh.
&gt;&gt;
&gt;&gt; OS: RHEL5.6
&gt;&gt; libvirt-0.8.2-15.el5_6.1 is used.
&gt;&gt;
&gt;&gt; Regards,
&gt;&gt; Masanari Iida
&gt;&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110327153229</emailId><senderName>Zvi Dubitzky</senderName><senderEmail>dubi@il.ibm.com</senderEmail><timestampReceived>2011-03-27 15:32:29-0400</timestampReceived><subject>[libvirt-users] virsh sechedinfo with libvirt-0.8.8</subject><body>

I have fedora14 installed with  standard libvirt-0.8.3.  I can start VM 
using .xml files and also run: virsh schedinfo. the cgroup CPU
controller is mounted and active . In fact I  have the path to the Virtual 
machine :   /dev/cgroup/cpu/libvirt/qemu/&lt;vm name &gt;

Now I upgraded to libvirt-0.8.8 from a tar ball ( configure , make , make 
install) .  I rebooted , new libvirtd started . virsh is working ok
(I can create a vm) except  for the commands : schedinfo and memtune that 
say upon  ' virsh schedinfo &lt;vm name&gt;' 

Scheduler      : Unknown
error: Requested operation is not valid: cgroup CPU controller is not 
mounted

Indeed I have the path :   /dev/cgroup/cpu/libvirt/qemu/   but now without 
 the &lt;vm_name&gt; group which  is not generated   despite
that the VM was generated ok by virsh and I can access it 

Any idea what is missing or some config file needs a change ?

thanks

Zvi Dubitzky 
Email:dubi@il.ibm.com


</body></email><email><emailId>20110327164814</emailId><senderName>Zvi Dubitzky</senderName><senderEmail>dubi@il.ibm.com</senderEmail><timestampReceived>2011-03-27 16:48:14-0400</timestampReceived><subject>Re: [libvirt-users] libvirt-users Digest, Vol 15, Issue 26</subject><body>

I resolved topic 1 please diregard ( libvirtd.conf : Authentication / 
auth_tcp="none") .

Please answer topic 2 as ver 0.8.8 claims cpu controller (cgroups) is not 
mounted while it is 

thanks

Zvi Dubitzky 
Email:dubi@il.ibm.com



libvirt-users-bounces@redhat.com wrote on 27/03/2011 18:00:05:

&gt; From: libvirt-users-request@redhat.com
&gt; To: libvirt-users@redhat.com
&gt; Date: 27/03/2011 18:00
&gt; Subject: libvirt-users Digest, Vol 15, Issue 26
&gt; Sent by: libvirt-users-bounces@redhat.com
&gt; 
&gt; Send libvirt-users mailing list submissions to
&gt;    libvirt-users@redhat.com
&gt; 
&gt; To subscribe or unsubscribe via the World Wide Web, visit
&gt;    https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; or, via email, send a message with subject or body 'help' to
&gt;    libvirt-users-request@redhat.com
&gt; 
&gt; You can reach the person managing the list at
&gt;    libvirt-users-owner@redhat.com
&gt; 
&gt; When replying, please edit your Subject line so it is more specific
&gt; than "Re: Contents of libvirt-users digest..."
&gt; 
&gt; 
&gt; Today's Topics:
&gt; 
&gt;    1. Re: libvirt-users Digest, Vol 15, Issue 25 (Zvi Dubitzky)
&gt;    2. virsh sechedinfo with libvirt-0.8.8 (Zvi Dubitzky)
&gt; 
&gt; 
&gt; ----------------------------------------------------------------------
&gt; 
&gt; Message: 1
&gt; Date: Sat, 26 Mar 2011 20:31:55 +0300
&gt; From: Zvi Dubitzky &lt;DUBI@il.ibm.com&gt;
&gt; To: libvirt-users@redhat.com
&gt; Subject: Re: [libvirt-users] libvirt-users Digest, Vol 15, Issue 25
&gt; Message-ID:
&gt; &lt;OF433F2588.21ED2F16-ONC225785F.005EC3E4-C225785F.00605332@il.ibm.com&gt;
&gt; Content-Type: text/plain; charset="US-ASCII"
&gt; 
&gt; Sorry, let me rephrase the question again:
&gt; 
&gt; I need define a user /password for sasl but want the authentication at 
&gt; runtime 
&gt;  be automatic - no explicit promting the user while accessing a tcp 
socket 
&gt; 
&gt;  with some applications that need authentication (e.g  libvirt)
&gt; 
&gt;   I try :   saslpasswd2 -c -p  -a libvirt &lt;user&gt; 
&gt; 
&gt;   and it hangs (if i  now press  Enter it says :  "invalid parameter 
&gt;   supplied") . if I avoid the -p flag  the above commad works fine and 
&gt;   prompts for password  and later when using the tcp (virsh -c 
&gt;   qemu+tcp:...) it prompts for the above defined user/password and 
&gt;   autheticates ok.
&gt; 
&gt;   But I want without the explicit authentication 
&gt; 
&gt; 
&gt; 
&gt;  The  man pages says :
&gt;  "-p  Pipe mode - saslpasswd2 will neither prompt for the password nor 
&gt;  verify that it was entered correctly. This is the default when standard 

&gt;  input is not a terminal. "
&gt; 
&gt; 
&gt; 
&gt;  In the past (before  upgrading of libvirt via rpm) I had the SASL 
&gt;  authentication  done automatically without prompting the user at 
runtime 
&gt;  (virsh qemu+tcp:///system &lt;command&gt; ) and without need to configure 
that.
&gt; 
&gt;  Don't know how to restore it .
&gt; 
&gt;  Any help ? 
&gt; 
&gt;  thanks
&gt; 
&gt; Zvi Dubitzky 
&gt; Email:dubi@il.ibm.com
&gt; 
&gt; 
&gt; 
&gt; libvirt-users-bounces@redhat.com wrote on 26/03/2011 18:00:08:
&gt; 
&gt; &gt; From: libvirt-users-request@redhat.com
&gt; &gt; To: libvirt-users@redhat.com
&gt; &gt; Date: 26/03/2011 18:08
&gt; &gt; Subject: libvirt-users Digest, Vol 15, Issue 25
&gt; &gt; Sent by: libvirt-users-bounces@redhat.com
&gt; &gt; 
&gt; &gt; Send libvirt-users mailing list submissions to
&gt; &gt;    libvirt-users@redhat.com
&gt; &gt; 
&gt; &gt; To subscribe or unsubscribe via the World Wide Web, visit
&gt; &gt;    https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; &gt; or, via email, send a message with subject or body 'help' to
&gt; &gt;    libvirt-users-request@redhat.com
&gt; &gt; 
&gt; &gt; You can reach the person managing the list at
&gt; &gt;    libvirt-users-owner@redhat.com
&gt; &gt; 
&gt; &gt; When replying, please edit your Subject line so it is more specific
&gt; &gt; than "Re: Contents of libvirt-users digest..."
&gt; &gt; 
&gt; &gt; 
&gt; &gt; Today's Topics:
&gt; &gt; 
&gt; &gt;    1. saslpasswd2 and virsh -c qemu+tcp:///system   &lt;command&gt;
&gt; &gt;       (Zvi Dubitzky)
&gt; &gt; 
&gt; &gt; 
&gt; &gt; ----------------------------------------------------------------------
&gt; &gt; 
&gt; &gt; Message: 1
&gt; &gt; Date: Sat, 26 Mar 2011 16:27:06 +0300
&gt; &gt; From: Zvi Dubitzky &lt;DUBI@il.ibm.com&gt;
&gt; &gt; To: libvirt-users@redhat.com
&gt; &gt; Subject: [libvirt-users] saslpasswd2 and virsh -c qemu+tcp:///system
&gt; &gt;    &lt;command&gt;
&gt; &gt; Message-ID:
&gt; &gt; &lt;OF80114F71.6895179C-ONC225785F.00498EC8-C225785F.0049E967@il.ibm.com&gt;
&gt; &gt; Content-Type: text/plain; charset="US-ASCII"
&gt; &gt; 
&gt; &gt; I need define a user /password for sasl but want that to do the 
&gt; &gt; verification
&gt; &gt; automatically no -promting ( or even maybe  avoid the  verification) 
&gt; while
&gt; &gt; using  a tcp socket with some applications that need authentication 
(e.g 
&gt; 
&gt; &gt; libvirt)
&gt; &gt; 
&gt; &gt; so I try :   saslpasswd2 -c -p  -a libvirt &lt;user&gt; 
&gt; &gt; 
&gt; &gt;  and it hangs (if i  now press  Enter it says :  "invalid parameter 
&gt; &gt; supplied") . if I avoid the -p flag  the above commad works fine and 
&gt; &gt; prompts for password  and later when using the tc p (virsh -c 
&gt; &gt; qemu+tcp:...) it prompts for the above defined user/password and 
&gt; &gt; autheticates ok .
&gt; &gt; But I want without the prompting 
&gt; &gt; 
&gt; &gt; The  man pages says
&gt; &gt; -p  Pipe mode - saslpasswd2 will neither prompt for the password nor 
&gt; &gt; verify that it was entered correctly. This is the default when 
standard 
&gt; &gt; input is not a terminal. 
&gt; &gt; 
&gt; &gt; In the past (before some upgrading of libvirt via rpm) the SASL 
&gt; &gt; authentication was done automatically no need for prompting
&gt; &gt; Don't know how to restore it .
&gt; &gt; 
&gt; &gt; Any help ? 
&gt; &gt; 
&gt; &gt; thanks
&gt; &gt; 
&gt; &gt; Zvi Dubitzky 
&gt; &gt; Email:dubi@il.ibm.com
&gt; &gt; 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; ------------------------------
&gt; &gt; 
&gt; &gt; _______________________________________________
&gt; &gt; libvirt-users mailing list
&gt; &gt; libvirt-users@redhat.com
&gt; &gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; &gt; 
&gt; &gt; End of libvirt-users Digest, Vol 15, Issue 25
&gt; &gt; *********************************************
&gt; 
&gt; 
&gt; 
&gt; ------------------------------
&gt; 
&gt; Message: 2
&gt; Date: Sun, 27 Mar 2011 18:32:29 +0300
&gt; From: Zvi Dubitzky &lt;DUBI@il.ibm.com&gt;
&gt; To: libvirt-users@redhat.com
&gt; Subject: [libvirt-users] virsh sechedinfo with libvirt-0.8.8
&gt; Message-ID:
&gt; &lt;OF06ABB03A.CFC8CAEA-ONC2257860.00546582-C2257860.00556403@il.ibm.com&gt;
&gt; Content-Type: text/plain; charset="US-ASCII"
&gt; 
&gt; I have fedora14 installed with  standard libvirt-0.8.3.  I can start VM 
&gt; using .xml files and also run: virsh schedinfo. the cgroup CPU
&gt; controller is mounted and active . In fact I  have the path to the 
Virtual 
&gt; machine :   /dev/cgroup/cpu/libvirt/qemu/&lt;vm name &gt;
&gt; 
&gt; Now I upgraded to libvirt-0.8.8 from a tar ball ( configure , make , 
make 
&gt; install) .  I rebooted , new libvirtd started . virsh is working ok
&gt; (I can create a vm) except  for the commands : schedinfo and memtune 
that 
&gt; say upon  ' virsh schedinfo &lt;vm name&gt;' 
&gt; 
&gt; Scheduler      : Unknown
&gt; error: Requested operation is not valid: cgroup CPU controller is not 
&gt; mounted
&gt; 
&gt; Indeed I have the path :   /dev/cgroup/cpu/libvirt/qemu/   but now 
without 
&gt;  the &lt;vm_name&gt; group which  is not generated   despite
&gt; that the VM was generated ok by virsh and I can access it 
&gt; 
&gt; Any idea what is missing or some config file needs a change ?
&gt; 
&gt; thanks
&gt; 
&gt; Zvi Dubitzky 
&gt; Email:dubi@il.ibm.com
&gt; 
&gt; 
&gt; 
&gt; 
&gt; ------------------------------
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; 
&gt; End of libvirt-users Digest, Vol 15, Issue 26
&gt; *********************************************

</body></email><email><emailId>20110328143119</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-03-28 14:31:19-0400</timestampReceived><subject>Re: [libvirt-users] stage of data upload/download patch</subject><body>

On Mon, Mar 28, 2011 at 10:11:11AM -0400, James Barkley wrote:
&gt; Hey all,
&gt; I'm looking at ways to upload/download to/from a datastore. I see it is on
&gt; the todo roadmap wiki (http://libvirt.org/todo.html) and also on bugzilla at
&gt; https://bugzilla.redhat.com/show_bug.cgi?id=636130. It looks to be a low
&gt; priority item, so I was thinking about writing my own patch for this when I
&gt; ran across this thread
&gt; http://comments.gmane.org/gmane.comp.emulators.libvirt/35532. It looks like
&gt; a patch going through discussion/revision for a variety of operations (e.g.,
&gt; vol-upload) to do exactly what I need. Does anyone have more info on the
&gt; status of this patch (or the "todo" feature in general) and when it may be
&gt; accepted into the baseline? I've been checking the hourly snapshots but
&gt; haven't seen it show up yet.

It'll probably be in the 0.9.0 release, implemented for any of the
generic Linux only virt drivers (ie  Xen, KVM, LXC, UML, but *not*
VMWare, VirtualBox, etc)


Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110330060214</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-03-30 06:02:14-0400</timestampReceived><subject>Re: [libvirt-users] Event Types Libvirt can handle</subject><body>

于 2011年03月29日 15:59, kadir yüceer 写道:
&gt; Hello all,
&gt; I'm trying to observe access events of guest VMs. However, as far as I
&gt; understand event types in libvirt are really generic, like domain
&gt; defined/undefined, started/stopped, etc.
&gt;
&gt; Isn't there any specific event types that libvirt can handle (like
&gt; access to a disk), or I'm missing them?

Unfortunately, no, :-)

&gt;
&gt; Thanks in advance
&gt; Kind regards
&gt; Kadir
&gt;
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110330195450</emailId><senderName>mkey</senderName><senderEmail>mkey@inter7.jp</senderEmail><timestampReceived>2011-03-30 19:54:50-0400</timestampReceived><subject>[libvirt-users] block migration</subject><body>

Hello,

I'm trying to use block migration with below procedure, but got some errors. I would \
highly appreciate if anyone give me a hand.. There are 2 hosts(hostA and hostB), both \
OS is Ubuntu 10.10(merverick). And a VM(named centos54-1mg) is running at \
hostA(centos54 64bit).

[package version]
+++-=====================-=====================-===================
ii  kvm                   1:84+dfsg-0ubuntu16+0 dummy transitional 
ii  libvirt-bin           0.8.8-1ubuntu3~ppamav the programs for 
ii  qemu-common           0.14.0~rc1+noroms-0ub qemu common 
ii  qemu-kvm              0.14.0~rc1+noroms-0ub Full virtualization

[proceduere]
root@hostA:~# /etc/init.d/apparmor teardown
root@hostA:~# stop libvirt-bin &amp;&amp; start libvirt-bin

root@hostB:~# /etc/init.d/apparmor teardown
root@hostB:~# stop libvirt-bin &amp;&amp; start libvirt-bin
root@hostB:~# touch /tmp/centos54-1mg.img
root@hostB:~# chown -R libvirt-qemu:kvm /tmp/centos54-1mg.img

root@hostA:~# virsh migrate --live --copy-storage-all --p2p --direct centos54-1mg \
qemu+tcp://hostB/system

[NOTE]
1. What I was being careful is permission. Therefore, apparmor is off, libvirt is \
running as root. 2. normal live migration is successfully finished. So, libvirtd can \
communicate between hostA and hostB. 3. Regarding to options "--live \
--copy-storage-all --p2p --direct", I think --copy-storage-all is minimum, so I was \
trying to change pairs of options, but no good result.

The error logs and configuration at hostB are attached.
Thanks in advance

mkey


["var_log_libvirt_libvirt.log" (text/plain)]

18:43:57.283: 2045: debug : virEventRunOnce:592 : Poll got 1 event(s)
18:43:57.283: 2045: debug : virEventDispatchTimeouts:393 : Dispatch 3
18:43:57.283: 2045: debug : virEventDispatchHandles:438 : Dispatch 8
18:43:57.283: 2045: debug : virEventDispatchHandles:452 : i=0 w=1
18:43:57.283: 2045: debug : virEventDispatchHandles:452 : i=1 w=2
18:43:57.283: 2045: debug : virEventDispatchHandles:452 : i=2 w=3
18:43:57.283: 2045: debug : virEventDispatchHandles:452 : i=3 w=4
18:43:57.283: 2045: debug : virEventDispatchHandles:452 : i=4 w=5
18:43:57.283: 2045: debug : virEventDispatchHandles:452 : i=5 w=6
18:43:57.283: 2045: debug : virEventDispatchHandles:465 : Dispatch n=5 f w=6 e=1 \
0xa8e740 18:43:57.283: 2045: debug : qemudDispatchServer:1351 : CLIENT_CONNECT: fd, \
readonly=0 localAddr=0.0.0.0;16509 remoteAddr2.19.0.42;59088 18:43:57.283: 2045: \
debug : virEventAddHandleImpl:103 : Add handle fd events=1 cb=0x41c5d0 \
opaque=0xa8e740 18:43:57.283: 2045: debug : virEventInterruptLocked:657 : Skip \
interrupt, 1 -1733568752 18:43:57.284: 2045: debug : virEventDispatchHandles:452 : \
i=6 w=7 18:43:57.284: 2045: debug : virEventDispatchHandles:452 : i=7 w=8
18:43:57.284: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:57.284: 2045: debug : virEventCleanupHandles:526 : Cleanup 9
18:43:57.284: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:57.284: 2045: debug : virEventCleanupHandles:526 : Cleanup 9
18:43:57.284: 2045: debug : virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1
18:43:57.284: 2045: debug : virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1
18:43:57.284: 2045: debug : virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1
18:43:57.284: 2045: debug : virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1
18:43:57.284: 2045: debug : virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1
18:43:57.284: 2045: debug : virEventMakePollFDs:361 : Prepare n=5 w=6, f e%
18:43:57.284: 2045: debug : virEventMakePollFDs:361 : Prepare n=6 w=7, f e%
18:43:57.284: 2045: debug : virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e%
18:43:57.284: 2045: debug : virEventMakePollFDs:361 : Prepare n=8 w, f e=1
18:43:57.284: 2045: debug : virEventCalculateTimeout:302 : Calculate expiry of 3 \
timers 18:43:57.284: 2045: debug : virEventCalculateTimeout:332 : Timeout at 0 due in \
-1 ms 18:43:57.284: 2045: debug : virEventRunOnce:583 : Poll on 9 handles 0xb47b70 \
timeout -1 18:43:57.284: 2045: debug : virEventRunOnce:592 : Poll got 1 event(s)
18:43:57.284: 2045: debug : virEventDispatchTimeouts:393 : Dispatch 3
18:43:57.284: 2045: debug : virEventDispatchHandles:438 : Dispatch 9
18:43:57.284: 2045: debug : virEventDispatchHandles:452 : i=0 w=1
18:43:57.284: 2045: debug : virEventDispatchHandles:452 : i=1 w=2
18:43:57.284: 2045: debug : virEventDispatchHandles:452 : i=2 w=3
18:43:57.284: 2045: debug : virEventDispatchHandles:452 : i=3 w=4
18:43:57.284: 2045: debug : virEventDispatchHandles:452 : i=4 w=5
18:43:57.284: 2045: debug : virEventDispatchHandles:452 : i=5 w=6
18:43:57.284: 2045: debug : virEventDispatchHandles:452 : i=6 w=7
18:43:57.284: 2045: debug : virEventDispatchHandles:452 : i=7 w=8
18:43:57.284: 2045: debug : virEventDispatchHandles:452 : i=8 w
18:43:57.284: 2045: debug : virEventDispatchHandles:465 : Dispatch n=8 f w e=1 \
0xa8e740 18:43:57.284: 2045: debug : virEventUpdateHandleImpl:136 : Update handle w \
e=1 18:43:57.284: 2045: debug : virEventInterruptLocked:657 : Skip interrupt, 1 \
-1733568752 18:43:57.284: 2045: debug : virEventUpdateHandleImpl:136 : Update handle \
w e=1 18:43:57.284: 2045: debug : virEventInterruptLocked:657 : Skip interrupt, 1 \
-1733568752 18:43:57.284: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:57.284: 2045: debug : virEventCleanupHandles:526 : Cleanup 9
18:43:57.284: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:57.284: 2045: debug : virEventCleanupHandles:526 : Cleanup 9
18:43:57.284: 2045: debug : virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1
18:43:57.284: 2045: debug : virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1
18:43:57.284: 2045: debug : virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1
18:43:57.284: 2048: debug : remoteDispatchClientRequest:377 : progS6903814 ver=1 \
type=0 status=0 serial=0 procf 18:43:57.284: 2048: debug : \
virEventUpdateHandleImpl:136 : Update handle w e=3 18:43:57.284: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1 18:43:57.284: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1 18:43:57.284: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=5 w=6, f e% 18:43:57.284: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=6 w=7, f e% 18:43:57.284: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e% 18:43:57.284: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=8 w, f e=1 18:43:57.284: 2045: debug : \
virEventCalculateTimeout:302 : Calculate expiry of 3 timers 18:43:57.284: 2045: debug \
: virEventCalculateTimeout:332 : Timeout at 0 due in -1 ms 18:43:57.284: 2045: debug \
: virEventRunOnce:583 : Poll on 9 handles 0xaa7480 timeout -1 18:43:57.284: 2048: \
debug : virEventInterruptLocked:661 : Interrupting 18:43:57.284: 2045: debug : \
virEventRunOnce:592 : Poll got 1 event(s) 18:43:57.284: 2045: debug : \
virEventDispatchTimeouts:393 : Dispatch 3 18:43:57.284: 2045: debug : \
virEventDispatchHandles:438 : Dispatch 9 18:43:57.284: 2045: debug : \
virEventDispatchHandles:452 : i=0 w=1 18:43:57.284: 2045: debug : \
virEventDispatchHandles:465 : Dispatch n=0 f=3 w=1 e=1 (nil) 18:43:57.284: 2045: \
debug : virEventDispatchHandles:452 : i=1 w=2 18:43:57.284: 2045: debug : \
virEventDispatchHandles:452 : i=2 w=3 18:43:57.284: 2045: debug : \
virEventDispatchHandles:452 : i=3 w=4 18:43:57.285: 2045: debug : \
virEventDispatchHandles:452 : i=4 w=5 18:43:57.285: 2045: debug : \
virEventDispatchHandles:452 : i=5 w=6 18:43:57.285: 2045: debug : \
virEventDispatchHandles:452 : i=6 w=7 18:43:57.285: 2045: debug : \
virEventDispatchHandles:452 : i=7 w=8 18:43:57.285: 2045: debug : \
virEventDispatchHandles:452 : i=8 w 18:43:57.285: 2045: debug : \
virEventCleanupTimeouts:483 : Cleanup 3 18:43:57.285: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 9 18:43:57.285: 2045: debug : \
virEventCleanupTimeouts:483 : Cleanup 3 18:43:57.285: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 9 18:43:57.285: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1 18:43:57.285: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1 18:43:57.285: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1 18:43:57.285: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1 18:43:57.285: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1 18:43:57.285: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=5 w=6, f e% 18:43:57.285: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=6 w=7, f e% 18:43:57.285: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e% 18:43:57.285: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=8 w, f e=5 18:43:57.285: 2045: debug : \
virEventCalculateTimeout:302 : Calculate expiry of 3 timers 18:43:57.285: 2045: debug \
: virEventCalculateTimeout:332 : Timeout at 0 due in -1 ms 18:43:57.285: 2045: debug \
: virEventRunOnce:583 : Poll on 9 handles 0xb4a120 timeout -1 18:43:57.285: 2045: \
debug : virEventRunOnce:592 : Poll got 1 event(s) 18:43:57.285: 2045: debug : \
virEventDispatchTimeouts:393 : Dispatch 3 18:43:57.285: 2045: debug : \
virEventDispatchHandles:438 : Dispatch 9 18:43:57.285: 2045: debug : \
virEventDispatchHandles:452 : i=0 w=1 18:43:57.285: 2045: debug : \
virEventDispatchHandles:452 : i=1 w=2 18:43:57.285: 2045: debug : \
virEventDispatchHandles:452 : i=2 w=3 18:43:57.285: 2045: debug : \
virEventDispatchHandles:452 : i=3 w=4 18:43:57.285: 2045: debug : \
virEventDispatchHandles:452 : i=4 w=5 18:43:57.285: 2045: debug : \
virEventDispatchHandles:452 : i=5 w=6 18:43:57.285: 2045: debug : \
virEventDispatchHandles:452 : i=6 w=7 18:43:57.285: 2045: debug : \
virEventDispatchHandles:452 : i=7 w=8 18:43:57.285: 2045: debug : \
virEventDispatchHandles:452 : i=8 w 18:43:57.285: 2045: debug : \
virEventDispatchHandles:465 : Dispatch n=8 f w e=4 0xa8e740 18:43:57.285: 2045: \
debug : virEventUpdateHandleImpl:136 : Update handle w e=1 18:43:57.285: 2045: debug \
: virEventInterruptLocked:657 : Skip interrupt, 1 -1733568752 18:43:57.285: 2045: \
debug : virEventCleanupTimeouts:483 : Cleanup 3 18:43:57.285: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 9 18:43:57.285: 2045: debug : \
virEventCleanupTimeouts:483 : Cleanup 3 18:43:57.285: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 9 18:43:57.285: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1 18:43:57.285: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1 18:43:57.285: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1 18:43:57.285: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1 18:43:57.285: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1 18:43:57.285: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=5 w=6, f e% 18:43:57.285: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=6 w=7, f e% 18:43:57.285: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e% 18:43:57.285: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=8 w, f e=1 18:43:57.285: 2045: debug : \
virEventCalculateTimeout:302 : Calculate expiry of 3 timers 18:43:57.285: 2045: debug \
: virEventCalculateTimeout:332 : Timeout at 0 due in -1 ms 18:43:57.285: 2045: debug \
: virEventRunOnce:583 : Poll on 9 handles 0xaa7480 timeout -1 18:43:57.285: 2045: \
debug : virEventRunOnce:592 : Poll got 1 event(s) 18:43:57.285: 2045: debug : \
virEventDispatchTimeouts:393 : Dispatch 3 18:43:57.285: 2045: debug : \
virEventDispatchHandles:438 : Dispatch 9 18:43:57.285: 2045: debug : \
virEventDispatchHandles:452 : i=0 w=1 18:43:57.285: 2045: debug : \
virEventDispatchHandles:452 : i=1 w=2 18:43:57.285: 2045: debug : \
virEventDispatchHandles:452 : i=2 w=3 18:43:57.285: 2045: debug : \
virEventDispatchHandles:452 : i=3 w=4 18:43:57.285: 2045: debug : \
virEventDispatchHandles:452 : i=4 w=5 18:43:57.285: 2045: debug : \
virEventDispatchHandles:452 : i=5 w=6 18:43:57.285: 2045: debug : \
virEventDispatchHandles:452 : i=6 w=7 18:43:57.285: 2045: debug : \
virEventDispatchHandles:452 : i=7 w=8 18:43:57.285: 2045: debug : \
virEventDispatchHandles:452 : i=8 w 18:43:57.285: 2045: debug : \
virEventDispatchHandles:465 : Dispatch n=8 f w e=1 0xa8e740 18:43:57.285: 2045: \
debug : virEventUpdateHandleImpl:136 : Update handle w e=1 18:43:57.285: 2045: debug \
: virEventInterruptLocked:657 : Skip interrupt, 1 -1733568752 18:43:57.286: 2045: \
debug : virEventUpdateHandleImpl:136 : Update handle w e=1 18:43:57.286: 2045: debug \
: virEventInterruptLocked:657 : Skip interrupt, 1 -1733568752 18:43:57.286: 2045: \
debug : virEventCleanupTimeouts:483 : Cleanup 3 18:43:57.286: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 9 18:43:57.286: 2045: debug : \
virEventCleanupTimeouts:483 : Cleanup 3 18:43:57.286: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 9 18:43:57.286: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1 18:43:57.286: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1 18:43:57.286: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1 18:43:57.286: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1 18:43:57.286: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1 18:43:57.286: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=5 w=6, f e% 18:43:57.286: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=6 w=7, f e% 18:43:57.286: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e% 18:43:57.286: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=8 w, f e=1 18:43:57.286: 2045: debug : \
virEventCalculateTimeout:302 : Calculate expiry of 3 timers 18:43:57.286: 2045: debug \
: virEventCalculateTimeout:332 : Timeout at 0 due in -1 ms 18:43:57.286: 2045: debug \
: virEventRunOnce:583 : Poll on 9 handles 0xb47b70 timeout -1 18:43:57.286: 2047: \
debug : remoteDispatchClientRequest:377 : progS6903814 ver=1 type=0 status=0 serial=1 \
proc=1 18:43:57.286: 2047: debug : virConnectOpen:1216 : name=qemu:///system
18:43:57.286: 2047: debug : do_open:1023 : name "qemu:///system" to URI components:
  scheme qemu
  opaque (null)
  authority (null)
  server (null)
  user (null)
  port 0
  path /system

18:43:57.286: 2047: debug : do_open:1062 : trying driver 0 (Test) ...
18:43:57.286: 2047: debug : do_open:1068 : driver 0 Test returned DECLINED
18:43:57.286: 2047: debug : do_open:1062 : trying driver 1 (Xen) ...
18:43:57.286: 2047: debug : do_open:1068 : driver 1 Xen returned DECLINED
18:43:57.286: 2047: debug : do_open:1062 : trying driver 2 (OPENVZ) ...
18:43:57.286: 2047: debug : do_open:1068 : driver 2 OPENVZ returned DECLINED
18:43:57.286: 2047: debug : do_open:1062 : trying driver 3 (VMWARE) ...
18:43:57.286: 2047: debug : do_open:1068 : driver 3 VMWARE returned DECLINED
18:43:57.286: 2047: debug : do_open:1062 : trying driver 4 (remote) ...
18:43:57.286: 2047: debug : do_open:1068 : driver 4 remote returned DECLINED
18:43:57.286: 2047: debug : do_open:1062 : trying driver 5 (QEMU) ...
18:43:57.286: 2047: debug : do_open:1068 : driver 5 QEMU returned SUCCESS
18:43:57.286: 2047: debug : do_open:1090 : network driver 0 Test returned DECLINED
18:43:57.286: 2047: debug : do_open:1090 : network driver 1 remote returned DECLINED
18:43:57.286: 2047: debug : do_open:1090 : network driver 2 Network returned SUCCESS
18:43:57.286: 2047: debug : do_open:1105 : interface driver 0 Test returned DECLINED
18:43:57.286: 2047: debug : do_open:1105 : interface driver 1 remote returned \
DECLINED 18:43:57.286: 2047: debug : do_open:1121 : storage driver 0 Test returned \
DECLINED 18:43:57.286: 2047: debug : do_open:1121 : storage driver 1 remote returned \
DECLINED 18:43:57.286: 2047: debug : do_open:1121 : storage driver 2 storage returned \
SUCCESS 18:43:57.286: 2047: debug : do_open:1137 : node driver 0 Test returned \
DECLINED 18:43:57.286: 2047: debug : do_open:1137 : node driver 1 remote returned \
DECLINED 18:43:57.286: 2047: debug : do_open:1137 : node driver 2 udevDeviceMonitor \
returned SUCCESS 18:43:57.286: 2047: debug : do_open:1153 : secret driver 0 Test \
returned DECLINED 18:43:57.286: 2047: debug : do_open:1153 : secret driver 1 remote \
returned DECLINED 18:43:57.286: 2047: debug : do_open:1153 : secret driver 2 secret \
returned SUCCESS 18:43:57.286: 2047: debug : do_open:1169 : nwfilter driver 0 Test \
returned DECLINED 18:43:57.286: 2047: debug : do_open:1169 : nwfilter driver 1 remote \
returned DECLINED 18:43:57.286: 2047: debug : do_open:1169 : nwfilter driver 2 \
nwfilter returned SUCCESS 18:43:57.286: 2047: debug : virEventUpdateHandleImpl:136 : \
Update handle w e=3 18:43:57.286: 2047: debug : virEventInterruptLocked:661 : \
Interrupting 18:43:57.286: 2045: debug : virEventRunOnce:592 : Poll got 1 event(s)
18:43:57.286: 2045: debug : virEventDispatchTimeouts:393 : Dispatch 3
18:43:57.286: 2045: debug : virEventDispatchHandles:438 : Dispatch 9
18:43:57.286: 2045: debug : virEventDispatchHandles:452 : i=0 w=1
18:43:57.286: 2045: debug : virEventDispatchHandles:465 : Dispatch n=0 f=3 w=1 e=1 \
(nil) 18:43:57.286: 2045: debug : virEventDispatchHandles:452 : i=1 w=2
18:43:57.286: 2045: debug : virEventDispatchHandles:452 : i=2 w=3
18:43:57.286: 2045: debug : virEventDispatchHandles:452 : i=3 w=4
18:43:57.286: 2045: debug : virEventDispatchHandles:452 : i=4 w=5
18:43:57.286: 2045: debug : virEventDispatchHandles:452 : i=5 w=6
18:43:57.286: 2045: debug : virEventDispatchHandles:452 : i=6 w=7
18:43:57.286: 2045: debug : virEventDispatchHandles:452 : i=7 w=8
18:43:57.286: 2045: debug : virEventDispatchHandles:452 : i=8 w
18:43:57.286: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:57.286: 2045: debug : virEventCleanupHandles:526 : Cleanup 9
18:43:57.286: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:57.286: 2045: debug : virEventCleanupHandles:526 : Cleanup 9
18:43:57.286: 2045: debug : virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1
18:43:57.286: 2045: debug : virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1
18:43:57.286: 2045: debug : virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1
18:43:57.286: 2045: debug : virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1
18:43:57.286: 2045: debug : virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1
18:43:57.286: 2045: debug : virEventMakePollFDs:361 : Prepare n=5 w=6, f e%
18:43:57.286: 2045: debug : virEventMakePollFDs:361 : Prepare n=6 w=7, f e%
18:43:57.286: 2045: debug : virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e%
18:43:57.287: 2045: debug : virEventMakePollFDs:361 : Prepare n=8 w, f e=5
18:43:57.287: 2045: debug : virEventCalculateTimeout:302 : Calculate expiry of 3 \
timers 18:43:57.287: 2045: debug : virEventCalculateTimeout:332 : Timeout at 0 due in \
-1 ms 18:43:57.287: 2045: debug : virEventRunOnce:583 : Poll on 9 handles 0xaa68f0 \
timeout -1 18:43:57.287: 2045: debug : virEventRunOnce:592 : Poll got 1 event(s)
18:43:57.287: 2045: debug : virEventDispatchTimeouts:393 : Dispatch 3
18:43:57.287: 2045: debug : virEventDispatchHandles:438 : Dispatch 9
18:43:57.287: 2045: debug : virEventDispatchHandles:452 : i=0 w=1
18:43:57.287: 2045: debug : virEventDispatchHandles:452 : i=1 w=2
18:43:57.287: 2045: debug : virEventDispatchHandles:452 : i=2 w=3
18:43:57.287: 2045: debug : virEventDispatchHandles:452 : i=3 w=4
18:43:57.287: 2045: debug : virEventDispatchHandles:452 : i=4 w=5
18:43:57.287: 2045: debug : virEventDispatchHandles:452 : i=5 w=6
18:43:57.287: 2045: debug : virEventDispatchHandles:452 : i=6 w=7
18:43:57.287: 2045: debug : virEventDispatchHandles:452 : i=7 w=8
18:43:57.287: 2045: debug : virEventDispatchHandles:452 : i=8 w
18:43:57.287: 2045: debug : virEventDispatchHandles:465 : Dispatch n=8 f w e=4 \
0xa8e740 18:43:57.287: 2045: debug : virEventUpdateHandleImpl:136 : Update handle w \
e=1 18:43:57.287: 2045: debug : virEventInterruptLocked:657 : Skip interrupt, 1 \
-1733568752 18:43:57.287: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:57.287: 2045: debug : virEventCleanupHandles:526 : Cleanup 9
18:43:57.287: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:57.287: 2045: debug : virEventCleanupHandles:526 : Cleanup 9
18:43:57.287: 2045: debug : virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1
18:43:57.287: 2045: debug : virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1
18:43:57.287: 2045: debug : virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1
18:43:57.287: 2045: debug : virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1
18:43:57.287: 2045: debug : virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1
18:43:57.287: 2045: debug : virEventMakePollFDs:361 : Prepare n=5 w=6, f e%
18:43:57.287: 2045: debug : virEventMakePollFDs:361 : Prepare n=6 w=7, f e%
18:43:57.287: 2045: debug : virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e%
18:43:57.287: 2045: debug : virEventMakePollFDs:361 : Prepare n=8 w, f e=1
18:43:57.287: 2045: debug : virEventCalculateTimeout:302 : Calculate expiry of 3 \
timers 18:43:57.287: 2045: debug : virEventCalculateTimeout:332 : Timeout at 0 due in \
-1 ms 18:43:57.287: 2045: debug : virEventRunOnce:583 : Poll on 9 handles 0xb4e8b0 \
timeout -1 18:43:57.288: 2045: debug : virEventRunOnce:592 : Poll got 1 event(s)
18:43:57.288: 2045: debug : virEventDispatchTimeouts:393 : Dispatch 3
18:43:57.288: 2045: debug : virEventDispatchHandles:438 : Dispatch 9
18:43:57.288: 2045: debug : virEventDispatchHandles:452 : i=0 w=1
18:43:57.288: 2045: debug : virEventDispatchHandles:452 : i=1 w=2
18:43:57.288: 2045: debug : virEventDispatchHandles:452 : i=2 w=3
18:43:57.288: 2045: debug : virEventDispatchHandles:452 : i=3 w=4
18:43:57.288: 2045: debug : virEventDispatchHandles:452 : i=4 w=5
18:43:57.288: 2045: debug : virEventDispatchHandles:452 : i=5 w=6
18:43:57.288: 2045: debug : virEventDispatchHandles:452 : i=6 w=7
18:43:57.288: 2045: debug : virEventDispatchHandles:452 : i=7 w=8
18:43:57.288: 2045: debug : virEventDispatchHandles:452 : i=8 w
18:43:57.288: 2045: debug : virEventDispatchHandles:465 : Dispatch n=8 f w e=1 \
0xa8e740 18:43:57.288: 2045: debug : virEventUpdateHandleImpl:136 : Update handle w \
e=1 18:43:57.288: 2045: debug : virEventInterruptLocked:657 : Skip interrupt, 1 \
-1733568752 18:43:57.288: 2045: debug : virEventUpdateHandleImpl:136 : Update handle \
w e=1 18:43:57.288: 2045: debug : virEventInterruptLocked:657 : Skip interrupt, 1 \
-1733568752 18:43:57.288: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:57.288: 2045: debug : virEventCleanupHandles:526 : Cleanup 9
18:43:57.288: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:57.288: 2045: debug : virEventCleanupHandles:526 : Cleanup 9
18:43:57.288: 2045: debug : virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1
18:43:57.288: 2045: debug : virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1
18:43:57.288: 2045: debug : virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1
18:43:57.288: 2045: debug : virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1
18:43:57.288: 2049: debug : remoteDispatchClientRequest:377 : progS6903814 ver=1 \
type=0 status=0 serial=2 proc` 18:43:57.288: 2049: debug : virDrvSupportsFeature:1373 \
: conn=0xaa6630, feature=4 18:43:57.288: 2049: debug : virEventUpdateHandleImpl:136 : \
Update handle w e=3 18:43:57.288: 2045: debug : virEventMakePollFDs:361 : Prepare \
n=4 w=5, f e=1 18:43:57.288: 2045: debug : virEventMakePollFDs:361 : Prepare n=5 \
w=6, f e% 18:43:57.288: 2045: debug : virEventMakePollFDs:361 : Prepare n=6 w=7, f \
e% 18:43:57.288: 2045: debug : virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e%
18:43:57.288: 2045: debug : virEventMakePollFDs:361 : Prepare n=8 w, f e=1
18:43:57.288: 2045: debug : virEventCalculateTimeout:302 : Calculate expiry of 3 \
timers 18:43:57.288: 2045: debug : virEventCalculateTimeout:332 : Timeout at 0 due in \
-1 ms 18:43:57.289: 2045: debug : virEventRunOnce:583 : Poll on 9 handles 0xb4a2a0 \
timeout -1 18:43:57.289: 2049: debug : virEventInterruptLocked:661 : Interrupting
18:43:57.289: 2045: debug : virEventRunOnce:592 : Poll got 1 event(s)
18:43:57.289: 2045: debug : virEventDispatchTimeouts:393 : Dispatch 3
18:43:57.289: 2045: debug : virEventDispatchHandles:438 : Dispatch 9
18:43:57.289: 2045: debug : virEventDispatchHandles:452 : i=0 w=1
18:43:57.289: 2045: debug : virEventDispatchHandles:465 : Dispatch n=0 f=3 w=1 e=1 \
(nil) 18:43:57.289: 2045: debug : virEventDispatchHandles:452 : i=1 w=2
18:43:57.289: 2045: debug : virEventDispatchHandles:452 : i=2 w=3
18:43:57.289: 2045: debug : virEventDispatchHandles:452 : i=3 w=4
18:43:57.289: 2045: debug : virEventDispatchHandles:452 : i=4 w=5
18:43:57.289: 2045: debug : virEventDispatchHandles:452 : i=5 w=6
18:43:57.289: 2045: debug : virEventDispatchHandles:452 : i=6 w=7
18:43:57.289: 2045: debug : virEventDispatchHandles:452 : i=7 w=8
18:43:57.289: 2045: debug : virEventDispatchHandles:452 : i=8 w
18:43:57.289: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:57.289: 2045: debug : virEventCleanupHandles:526 : Cleanup 9
18:43:57.289: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:57.289: 2045: debug : virEventCleanupHandles:526 : Cleanup 9
18:43:57.289: 2045: debug : virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1
18:43:57.289: 2045: debug : virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1
18:43:57.289: 2045: debug : virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1
18:43:57.289: 2045: debug : virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1
18:43:57.289: 2045: debug : virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1
18:43:57.289: 2045: debug : virEventMakePollFDs:361 : Prepare n=5 w=6, f e%
18:43:57.289: 2045: debug : virEventMakePollFDs:361 : Prepare n=6 w=7, f e%
18:43:57.289: 2045: debug : virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e%
18:43:57.289: 2045: debug : virEventMakePollFDs:361 : Prepare n=8 w, f e=5
18:43:57.289: 2045: debug : virEventCalculateTimeout:302 : Calculate expiry of 3 \
timers 18:43:57.289: 2045: debug : virEventCalculateTimeout:332 : Timeout at 0 due in \
-1 ms 18:43:57.289: 2045: debug : virEventRunOnce:583 : Poll on 9 handles \
0x7f78900012e0 timeout -1 18:43:57.289: 2045: debug : virEventRunOnce:592 : Poll got \
1 event(s) 18:43:57.289: 2045: debug : virEventDispatchTimeouts:393 : Dispatch 3
18:43:57.289: 2045: debug : virEventDispatchHandles:438 : Dispatch 9
18:43:57.289: 2045: debug : virEventDispatchHandles:452 : i=0 w=1
18:43:57.289: 2045: debug : virEventDispatchHandles:452 : i=1 w=2
18:43:57.289: 2045: debug : virEventDispatchHandles:452 : i=2 w=3
18:43:57.289: 2045: debug : virEventDispatchHandles:452 : i=3 w=4
18:43:57.289: 2045: debug : virEventDispatchHandles:452 : i=4 w=5
18:43:57.289: 2045: debug : virEventDispatchHandles:452 : i=5 w=6
18:43:57.289: 2045: debug : virEventDispatchHandles:452 : i=6 w=7
18:43:57.289: 2045: debug : virEventDispatchHandles:452 : i=7 w=8
18:43:57.289: 2045: debug : virEventDispatchHandles:452 : i=8 w
18:43:57.289: 2045: debug : virEventDispatchHandles:465 : Dispatch n=8 f w e=4 \
0xa8e740 18:43:57.289: 2045: debug : virEventUpdateHandleImpl:136 : Update handle w \
e=1 18:43:57.289: 2045: debug : virEventInterruptLocked:657 : Skip interrupt, 1 \
-1733568752 18:43:57.289: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:57.289: 2045: debug : virEventCleanupHandles:526 : Cleanup 9
18:43:57.289: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:57.289: 2045: debug : virEventCleanupHandles:526 : Cleanup 9
18:43:57.289: 2045: debug : virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1
18:43:57.289: 2045: debug : virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1
18:43:57.289: 2045: debug : virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1
18:43:57.289: 2045: debug : virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1
18:43:57.289: 2045: debug : virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1
18:43:57.289: 2045: debug : virEventMakePollFDs:361 : Prepare n=5 w=6, f e%
18:43:57.289: 2045: debug : virEventMakePollFDs:361 : Prepare n=6 w=7, f e%
18:43:57.289: 2045: debug : virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e%
18:43:57.289: 2045: debug : virEventMakePollFDs:361 : Prepare n=8 w, f e=1
18:43:57.289: 2045: debug : virEventCalculateTimeout:302 : Calculate expiry of 3 \
timers 18:43:57.289: 2045: debug : virEventCalculateTimeout:332 : Timeout at 0 due in \
-1 ms 18:43:57.290: 2045: debug : virEventRunOnce:583 : Poll on 9 handles \
0x7f78900013c0 timeout -1 18:43:57.290: 2045: debug : virEventRunOnce:592 : Poll got \
1 event(s) 18:43:57.290: 2045: debug : virEventDispatchTimeouts:393 : Dispatch 3
18:43:57.290: 2045: debug : virEventDispatchHandles:438 : Dispatch 9
18:43:57.290: 2045: debug : virEventDispatchHandles:452 : i=0 w=1
18:43:57.290: 2045: debug : virEventDispatchHandles:452 : i=1 w=2
18:43:57.290: 2045: debug : virEventDispatchHandles:452 : i=2 w=3
18:43:57.290: 2045: debug : virEventDispatchHandles:452 : i=3 w=4
18:43:57.290: 2045: debug : virEventDispatchHandles:452 : i=4 w=5
18:43:57.290: 2045: debug : virEventDispatchHandles:452 : i=5 w=6
18:43:57.290: 2045: debug : virEventDispatchHandles:452 : i=6 w=7
18:43:57.290: 2045: debug : virEventDispatchHandles:452 : i=7 w=8
18:43:57.290: 2045: debug : virEventDispatchHandles:452 : i=8 w
18:43:57.290: 2045: debug : virEventDispatchHandles:465 : Dispatch n=8 f w e=1 \
0xa8e740 18:43:57.290: 2045: debug : virEventUpdateHandleImpl:136 : Update handle w \
e=1 18:43:57.290: 2045: debug : virEventInterruptLocked:657 : Skip interrupt, 1 \
-1733568752 18:43:57.290: 2045: debug : virEventUpdateHandleImpl:136 : Update handle \
w e=1 18:43:57.290: 2045: debug : virEventInterruptLocked:657 : Skip interrupt, 1 \
-1733568752 18:43:57.290: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:57.290: 2045: debug : virEventCleanupHandles:526 : Cleanup 9
18:43:57.290: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:57.290: 2045: debug : virEventCleanupHandles:526 : Cleanup 9
18:43:57.290: 2045: debug : virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1
18:43:57.290: 2045: debug : virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1
18:43:57.290: 2045: debug : virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1
18:43:57.290: 2045: debug : virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1
18:43:57.290: 2045: debug : virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1
18:43:57.290: 2050: debug : remoteDispatchClientRequest:377 : progS6903814 ver=1 \
type=0 status=0 serial=3 proc8 18:43:57.290: 2045: debug : virEventMakePollFDs:361 : \
Prepare n=5 w=6, f e% 18:43:57.291: 2045: debug : virEventMakePollFDs:361 : Prepare \
n=6 w=7, f e% 18:43:57.291: 2045: debug : virEventMakePollFDs:361 : Prepare n=7 w=8, \
f=9 e% 18:43:57.291: 2045: debug : virEventMakePollFDs:361 : Prepare n=8 w, f e=1
18:43:57.291: 2045: debug : virEventCalculateTimeout:302 : Calculate expiry of 3 \
timers 18:43:57.291: 2045: debug : virEventCalculateTimeout:332 : Timeout at 0 due in \
-1 ms 18:43:57.291: 2045: debug : virEventRunOnce:583 : Poll on 9 handles \
0x7f7890000da0 timeout -1 18:43:57.291: 2050: debug : virDomainMigratePrepare2:3868 : \
dconn=0xaa6630, cookie=0x7f78958b7b30, cookielen=0x7f78958b7b3c, uri_in=(null), \
uri_out=0xa966d0,flagsg, dname=(null), bandwidth=0, dom_xml=&lt;domain type='qemu' \
id='3'&gt;  &lt;name&gt;centos54-1mg&lt;/name&gt;
  &lt;uuid&gt;2a4a5f8e-06b4-079e-bc62-63295f87d4e5&lt;/uuid&gt;
  &lt;memory&gt;1048576&lt;/memory&gt;
  &lt;currentMemory&gt;1048576&lt;/currentMemory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='x86_64' machine='pc-0.12'&gt;hvm&lt;/type&gt;
    &lt;boot dev='hd'/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
    &lt;apic/&gt;
    &lt;pae/&gt;
  &lt;/features&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;restart&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;driver name='qemu' type='raw'/&gt;
      &lt;source file='/tmp/centos54-1mg.img'/&gt;
      &lt;target dev='hda' bus='ide'/&gt;
      &lt;alias name='ide0-0-0'/&gt;
      &lt;address type='drive' controller='0' bus='0' unit='0'/&gt;
    &lt;/disk&gt;
    &lt;disk type='block' device='cdrom'&gt;
      &lt;driver name='qemu' type='raw'/&gt;
      &lt;target dev='hdc' bus='ide'/&gt;
      &lt;readonly/&gt;
      &lt;alias name='ide0-1-0'/&gt;
      &lt;address type='drive' controller='0' bus='1' unit='0'/&gt;
    &lt;/disk&gt;
    &lt;controller type='ide' index='0'&gt;
      &lt;alias name='ide0'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x01' function='0x1'/&gt;
    &lt;/controller&gt;
    &lt;interface type='network'&gt;
      &lt;mac address='52:54:00:4f:a9:04'/&gt;
      &lt;source network='default'/&gt;
      &lt;target dev='vnet0'/&gt;
      &lt;alias name='net0'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03' function='0x0'/&gt;
    &lt;/interface&gt;
    &lt;serial type='pty'&gt;
      &lt;source path='/dev/pts/3'/&gt;
      &lt;target port='0'/&gt;
      &lt;alias name='serial0'/&gt;
    &lt;/serial&gt;
    &lt;console type='pty' tty='/dev/pts/3'&gt;
      &lt;source path='/dev/pts/3'/&gt;
      &lt;target type='serial' port='0'/&gt;
      &lt;alias name='serial0'/&gt;
    &lt;/console&gt;
    &lt;input type='mouse' bus='ps2'/&gt;
    &lt;graphics type='vnc' port='5900' autoport='yes'/&gt;
    &lt;sound model='ac97'&gt;
      &lt;alias name='sound0'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x04' function='0x0'/&gt;
    &lt;/sound&gt;
    &lt;video&gt;
      &lt;model type='cirrus' vram='9216' heads='1'/&gt;
      &lt;alias name='video0'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x02' function='0x0'/&gt;
    &lt;/video&gt;
    &lt;memballoon model='virtio'&gt;
      &lt;alias name='balloon0'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x05' function='0x0'/&gt;
    &lt;/memballoon&gt;
  &lt;/devices&gt;
&lt;/domain&gt;

18:43:57.291: 2050: debug : qemudDomainMigratePrepare2:8320 : Generated \
uri_out=tcp:hostB:49154 18:43:57.291: 2050: debug : virDomainObjNew:1015 : \
obj=0xbdae80 18:43:57.292: 2050: debug : virDomainObjRef:967 : obj=0xbdae80 refs=2
18:43:57.292: 2050: debug : qemudStartVMDaemon:2639 : Beginning VM startup process
18:43:57.292: 2050: debug : qemudStartVMDaemon:2651 : Setting current domain def as \
transient 18:43:57.292: 2050: debug : qemudStartVMDaemon:2658 : Preparing host \
devices 18:43:57.292: 2050: debug : qemudStartVMDaemon:2662 : Preparing chr devices
18:43:57.292: 2050: debug : qemudStartVMDaemon:2671 : Generating domain security \
label (if required) 18:43:57.292: 2050: debug : qemudStartVMDaemon:2678 : Generating \
setting domain security labels (if required) 18:43:57.292: 2050: info : \
virSecurityDACSetOwnership:99 : Setting DAC user and group on '/tmp/centos54-1mg.img' \
to '114:123' 18:43:57.292: 2050: debug : qemudStartVMDaemon:2703 : Ensuring no \
historical cgroup is lying around 18:43:57.292: 2050: debug : qemudStartVMDaemon:2749 \
: Creating domain log file 18:43:57.292: 2050: debug : qemudStartVMDaemon:2753 : \
Determining emulator version 18:43:57.292: 2050: debug : virCommandRunAsync:1150 : \
About to run LC_ALL=C \
PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin /usr/bin/kvm -help \
18:43:57.292: 2050: debug : virExecWithHook:738 : LC_ALL=C \
PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin /usr/bin/kvm -help \
18:43:57.292: 2050: debug : virCommandRunAsync:1166 : Command result 0, with PID 2277 \
18:43:57.299: 2050: debug : virCommandRun:1051 : Result stdout: 'QEMU emulator \
                version 0.13.91 (qemu-kvm-0.14.0-rc1), Copyright (c) 2003-2008 \
                Fabrice Bellard
usage: qemu [options] [disk_image]

'disk_image' is a raw hard disk image for IDE hard disk 0

Standard options:
-h or -help     display this help and exit
-version        display version information and exit
-M machine      select emulated machine (-M ? for list)
-cpu cpu        select CPU (-cpu ? for list)
-smp n[,maxcpus=cpus][,cores=cores][,threads=threads][,sockets=sockets]
                set the number of CPUs to 'n' [default=1]
                maxcpus= maximum number of total cpus, including
                offline CPUs for hotplug, etc
                cores= number of CPU cores on one socket
                threads= number of threads on one CPU core
                sockets= number of discrete sockets in the system
-numa node[,mem=size][,cpus=cpu[-cpu]][,nodeid=node]
-fda/-fdb file  use 'file' as floppy disk 0/1 image
-hda/-hdb file  use 'file' as IDE hard disk 0/1 image
-hdc/-hdd file  use 'file' as IDE hard disk 2/3 image
-cdrom file     use 'file' as IDE cdrom image (cdrom is ide1 master)
-drive [file=file][,if=type][,bus=n][,unit=m][,media=d][,index=i]
       [,cyls=c,heads=h,secs=s[,trans=t]][,snapshot=on|off]
       [,cache=writethrough|writeback|none|unsafe][,format=f]
       [,serial=s][,addr=A][,id=name][,aio=threads|native]
       [,readonly=on|off][,boot=on|off]
                use 'file' as a drive image
-set group.id.arg=value
                set &lt;arg&gt; parameter for item &lt;id&gt; of type &lt;group&gt;
                i.e. -set drive.$id.file=/path/to/image
-global driver.property=value
                set a global default for a driver property
-mtdblock file  use 'file' as on-board Flash memory image
-sd file        use 'file' as SecureDigital card image
-pflash file    use 'file' as a parallel flash image
-boot [order=drives][,once=drives][,menu=on|off]
                'drives': floppy (a), hard disk (c), CD-ROM (d), network (n)
-snapshot       write to temporary files instead of disk image files
-m megs         set virtual RAM size to megs MB [default84]
-mem-path FILE  provide backing storage for guest RAM
-mem-prealloc   preallocate guest memory (use with -mem-path)
-k language     use keyboard layout (for example 'fr' for French)
-audio-help     print list of audio drivers and their options
-soundhw c1,... enable audio support
                and only specified sound cards (comma separated list)
                use -soundhw ? to get the list of supported cards
                use -soundhw all to enable all of them
-usb            enable the USB driver (will be the default soon)
-usbdevice name add the host or guest USB device 'name'
-device driver[,prop[=value][,...]]
                add device (based on driver)
                prop=value,... sets driver properties
                use -device ? to print all possible drivers
                use -device driver,? to print all possible properties
File system options:
-fsdev local,id=id,path=path,security_model=[mapped|passthrough|none]
Virtual File system pass-through options:
-virtfs local,path=path,mount_tag=tag,security_model=[mapped|passthrough|none]

-name string1[,process=string2]
                set the name of the guest
                string1 sets the window title and string2 the process name (on Linux)
-uuid %08x-%04x-%04x-%04x-%012x
                specify machine UUID

Display options:
-nographic      disable graphical output and redirect serial I/Os to console
-curses         use a curses/ncurses interface instead of SDL
-no-frame       open SDL window without a frame and window decorations
-alt-grab       use Ctrl-Alt-Shift to grab mouse (instead of Ctrl-Alt)
-ctrl-grab      use Right-Ctrl to grab mouse (instead of Ctrl-Alt)
-no-quit        disable SDL window close capability
-sdl            enable SDL
-spice &lt;args&gt;   enable spice
-portrait       rotate graphical output 90 deg left (only PXA LCD)
-vga [std|cirrus|vmware|qxl|xenfb|none]
                select video card type
-full-screen    start in full screen
-g WxH[xDEPTH]  Set the initial graphical resolution and depth
-vnc display    start a VNC server on display

i386 target only:
-win2k-hack     use it when installing Windows 2000 to avoid a disk full bug
-no-fd-bootchk  disable boot signature checking for floppy disks
-no-acpi        disable ACPI
-no-hpet        disable HPET
-balloon none   disable balloon device
-balloon virtio[,addr=str]
                enable virtio balloon device (default)
-acpitable [sig=str][,rev=n][,oem_id=str][,oem_table_id=str][,oem_rev=n][,asl_compiler_id=str][,asl_compiler_rev=n][,data=file1[:file2]...]
  ACPI table description
-smbios file=binary
                load SMBIOS entry from binary file
-smbios type=0[,vendor=str][,version=str][,date=str][,release=%d.%d]
                specify SMBIOS type 0 fields
-smbios type=1[,manufacturer=str][,product=str][,version=str][,serial=str]
              [,uuid=uuid][,sku=str][,family=str]
                specify SMBIOS type 1 fields

Network options:
-net nic[,vlan=n][,macaddr=mac][,model=type][,name=str][,addr=str][,vectors=v]
                create a new Network Interface Card and connect it to VLAN 'n'
-net user[,vlan=n][,name=str][,net­dr[/mask]][,host­dr][,restrict=y|n]
         [,hostname=host][,dhcpstart­dr][,dns­dr][,tftp=dir][,bootfile=f]
         [,hostfwd=rule][,guestfwd=rule][,smb=dir[,smbserver­dr]]
                connect the user mode network stack to VLAN 'n', configure its
                DHCP server and enabled optional services
-net tap[,vlan=n][,name=str][,fd=h][,ifname=name][,script=file][,downscriptßile][,sndbuf=nbytes][,vnet_hdr=on|off][,vhost=on|off][,vhostfd=h][,vhostforce=on|off]
                
                connect the host TAP network interface to VLAN 'n' and use the
                network scripts 'file' (default=/etc/qemu-ifup)
                and 'dfile' (default=/etc/qemu-ifdown)
                use '[down]script=no' to disable script execution
                use 'fd=h' to connect to an already opened TAP interface
                use 'sndbuf=nbytes' to limit the size of the send buffer (the
                default is disabled 'sndbuf=0' to enable flow control set \
                'sndbuf48576')
                use vnet_hdr=off to avoid enabling the IFF_VNET_HDR tap flag
                use vnet_hdr=on to make the lack of IFF_VNET_HDR support an error \
condition  use vhost=on to enable experimental in kernel accelerator
                    (only has effect for virtio guests which use MSIX)
                use vhostforce=on to force vhost on for non-MSIX virtio guests
                use 'vhostfd=h' to connect to an already opened vhost net device
-net socket[,vlan=n][,name=str][,fd=h][,listen=[host]:port][,connect=host:port]
                connect the vlan 'n' to another VLAN using a socket connection
-net socket[,vlan=n][,name=str][,fd=h][,mcast=maddr:port[,localaddr­dr]]
                connect the vlan 'n' to multicast maddr and port
                use 'localaddr­dr' to specify the host address to send packets from
-net dump[,vlan=n][,file=f][,len=n]
                dump traffic on vlan 'n' to file 'f' (max n bytes per packet)
-net none       use it alone to have zero network devices. If no -net option
                is provided, the default is '-net nic -net user'
-netdev [user|tap|socket],id=str[,option][,option][,...]

Character device options:
-chardev null,id=id[,mux=on|off]
-chardev socket,id=id[,host=host],port=host[,to=to][,ipv4][,ipv6][,nodelay]
         [,server][,nowait][,telnet][,mux=on|off] (tcp)
-chardev socket,id=id,path=path[,server][,nowait][,telnet],[mux=on|off] (unix)
-chardev udp,id=id[,host=host],port=port[,localaddr=localaddr]
         [,localport=localport][,ipv4][,ipv6][,mux=on|off]
-chardev msmouse,id=id[,mux=on|off]
-chardev vc,id=id[[,width=width][,height=height]][[,cols=cols][,rows=rows]]
         [,mux=on|off]
-chardev file,id=id,path=path[,mux=on|off]
-chardev pipe,id=id,path=path[,mux=on|off]
-chardev pty,id=id[,mux=on|off]
-chardev stdio,id=id[,mux=on|off][,signal=on|off]
-chardev tty,id=id,path=path[,mux=on|off]
-chardev parport,id=id,path=path[,mux=on|off]

Bluetooth(R) options:
-bt hci,null    dumb bluetooth HCI - doesn't respond to commands
-bt hci,host[:id]
                use host's HCI with the given name
-bt hci[,vlan=n]
                emulate a standard HCI in virtual scatternet 'n'
-bt vhci[,vlan=n]
                add host computer to virtual scatternet 'n' using VHCI
-bt device:dev[,vlan=n]
                emulate a bluetooth device 'dev' in scatternet 'n'

Linux/Multiboot boot specific:
-kernel bzImage use 'bzImage' as kernel image
-append cmdline use 'cmdline' as kernel command line
-initrd file    use 'file' as initial ram disk

Debug/Expert options:
-serial dev     redirect the serial port to char device 'dev'
-parallel dev   redirect the parallel port to char device 'dev'
-monitor dev    redirect the monitor to char device 'dev'
-qmp dev        like -monitor but opens in 'control' mode
-mon chardev=[name][,mode=readline|control][,default]
-debugcon dev   redirect the debug console to char device 'dev'
-pidfile file   write PID to 'file'
-singlestep     always run in singlestep mode
-S              freeze CPU at startup (use 'c' to start execution)
-gdb dev        wait for gdb connection on 'dev'
-s              shorthand for -gdb tcp::1234
-d item1,...    output log to /tmp/qemu.log (use -d ? for a list of log items)
-hdachs c,h,s[,t]
                force hard disk 0 physical geometry and the optional BIOS
                translation (t=none or lba) (usually qemu can guess them)
-L path         set the directory for the BIOS, VGA BIOS and keymaps
-bios file      set the filename for the BIOS
-enable-kvm     enable KVM full virtualization support
-xen-domid id   specify xen guest domain id
-xen-create     create domain using xen hypercalls, bypassing xend
                warning: should not be used when xend is in use
-xen-attach     attach to existing xen domain
                xend will use this when starting qemu
-no-reboot      exit instead of rebooting
-no-shutdown    stop before shutdown
-loadvm [tag|id]
                start right away with a saved state (loadvm in monitor)
-daemonize      daemonize QEMU after initializing
-option-rom rom load a file, rom, into the option ROM space
-clock          force the use of the given methods for timer alarm.
                To see what timers are available use -clock ?
-rtc [base=utc|localtime|date][,clock=host|vm][,driftfix=none|slew]
                set the RTC base and clock, enable drift fix for clock ticks (x86 \
                only)
-icount [N|auto]
                enable virtual instruction counter with 2^N clock ticks per
                instruction
-watchdog i6300esb|ib700
                enable virtual hardware watchdog [default=none]
-watchdog-action reset|shutdown|poweroff|pause|debug|none
                action when watchdog fires [default=reset]
-echr chr       set terminal escape character instead of ctrl-a
-virtioconsole c
                set virtio console
-show-cursor    show cursor
-tb-size n      set TB size
-incoming p     prepare for incoming migration, listen on port p
-nodefaults     don't create default devices
-chroot dir     chroot to dir just before starting the VM
-runas user     change to user id user just before starting the VM
-prom-env variable=value
                set OpenBIOS nvram variables
-semihosting    semihosting mode
-old-param      old param mode
-readconfig &lt;file&gt;
-writeconfig &lt;file&gt;
                read/write config file
-nodefconfig
                do not load default config files at startup
-no-kvm         disable KVM hardware virtualization
-no-kvm-irqchip disable KVM kernel mode PIC/IOAPIC/LAPIC
-no-kvm-pit     disable KVM kernel mode PIT
-no-kvm-pit-reinjection
                disable KVM kernel mode PIT interrupt reinjection
-enable-nesting enable support for running a VM inside the VM (AMD only)
-nvram FILE     provide ia64 nvram contents
-tdf            enable guest time drift compensation
-kvm-shadow-memory MEGABYTES
                allocate MEGABYTES for kvm mmu shadowing

During emulation, the following keys are useful:
ctrl-alt-f      toggle full screen
ctrl-alt-n      switch to virtual console 'n'
ctrl-alt        toggle mouse and keyboard grab

When using -nographic, press 'ctrl-a h' to get some help.
' stderr: ''
18:43:57.300: 2050: debug : qemuCapsParseHelpStr:1035 : Version 0.13.91, cooked \
version 13091, flags 0x9ff6efffdfd7e 18:43:57.300: 2050: debug : \
qemuCapsParseHelpStr:1039 : qemu-kvm version 0.13.91 detected 18:43:57.300: 2050: \
debug : virCommandRunAsync:1150 : About to run LC_ALL=C \
PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin /usr/bin/kvm \
-device ? -device pci-assign,? -device virtio-blk-pci,? 18:43:57.300: 2050: debug : \
virExecWithHook:738 : LC_ALL=C \
PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin /usr/bin/kvm \
-device ? -device pci-assign,? -device virtio-blk-pci,? 18:43:57.300: 2050: debug : \
virCommandRunAsync:1166 : Command result 0, with PID 2278 18:43:57.802: 2050: debug : \
virCommandRun:1051 : Result stdout: '' stderr: 'name "virtio-balloon-pci", bus PCI \
name "virtio-serial-pci", bus PCI, alias "virtio-serial" name "virtio-net-pci", bus \
PCI name "virtio-blk-pci", bus PCI, alias "virtio-blk"
name "ivshmem", bus PCI
name "smbus-eeprom", bus I2C
name "scsi-disk", bus SCSI, desc "virtual scsi disk or cdrom"
name "scsi-generic", bus SCSI, desc "pass through generic scsi device (/dev/sg*)"
name "usb-hub", bus USB
name "usb-host", bus USB
name "usb-kbd", bus USB
name "usb-mouse", bus USB
name "usb-tablet", bus USB
name "usb-storage", bus USB
name "usb-wacom-tablet", bus USB, desc "QEMU PenPartner Tablet"
name "usb-braille", bus USB
name "usb-serial", bus USB
name "usb-net", bus USB
name "usb-bt-dongle", bus USB
name "virtserialport", bus virtio-serial-bus
name "virtconsole", bus virtio-serial-bus
name "ioh3420", bus PCI, desc "Intel IOH device id 3420 PCIE Root Port"
name "x3130-upstream", bus PCI, desc "TI X3130 Upstream Port of PCI Express Switch"
name "xio3130-downstream", bus PCI, desc "TI X3130 Downstream Port of PCI Express \
Switch" name "isa-serial", bus ISA
name "isa-parallel", bus ISA
name "vt82c686b-usb-uhci", bus PCI
name "piix4-usb-uhci", bus PCI
name "piix3-usb-uhci", bus PCI
name "sysbus-ohci", bus System, desc "OHCI USB Controller"
name "pci-ohci", bus PCI, desc "Apple USB Controller"
name "SUNW,fdtwo", bus System
name "sysbus-fdc", bus System
name "i6300esb", bus PCI
name "ne2k_pci", bus PCI
name "i82801", bus PCI, desc "Intel i82801 Ethernet"
name "i82562", bus PCI, desc "Intel i82562 Ethernet"
name "i82559er", bus PCI, desc "Intel i82559ER Ethernet"
name "i82559c", bus PCI, desc "Intel i82559C Ethernet"
name "i82559b", bus PCI, desc "Intel i82559B Ethernet"
name "i82559a", bus PCI, desc "Intel i82559A Ethernet"
name "i82558b", bus PCI, desc "Intel i82558B Ethernet"
name "i82558a", bus PCI, desc "Intel i82558A Ethernet"
name "i82557c", bus PCI, desc "Intel i82557C Ethernet"
name "i82557b", bus PCI, desc "Intel i82557B Ethernet"
name "i82557a", bus PCI, desc "Intel i82557A Ethernet"
name "i82551", bus PCI, desc "Intel i82551 Ethernet"
name "i82550", bus PCI, desc "Intel i82550 Ethernet"
name "pcnet", bus PCI
name "e1000", bus PCI, desc "Intel Gigabit Ethernet"
name "rtl8139", bus PCI
name "ne2k_isa", bus ISA
name "ide-drive", bus IDE
name "isa-ide", bus ISA
name "ich9-ahci", bus PCI, alias "ahci"
name "lsi53c895a", bus PCI, alias "lsi"
name "VGA", bus PCI
name "vmware-svga", bus PCI
name "sb16", bus ISA, desc "Creative Sound Blaster 16"
name "ES1370", bus PCI, desc "ENSONIQ AudioPCI ES1370"
name "AC97", bus PCI, desc "Intel 82801AA AC97 Audio"
name "intel-hda", bus PCI, desc "Intel HD Audio Controller"
name "hda-duplex", bus HDA, desc "HDA Audio Codec, duplex"
name "hda-output", bus HDA, desc "HDA Audio Codec, output-only"
name "cirrus-vga", bus PCI, desc "Cirrus CLGD 54xx VGA"
name "isa-applesmc", bus ISA
name "ib700", bus ISA
name "isa-debugcon", bus ISA
name "testdev", bus ISA
name "pci-assign", bus PCI, desc "pass through host pci devices to the guest"
pci-assign.host=pci-hostaddr
pci-assign.iommu=on/off
pci-assign.prefer_msi=on/off
pci-assign.bootindex=int32
pci-assign.configfd=string
virtio-blk-pci.class=hex32
virtio-blk-pci.drive=drive
virtio-blk-pci.logical_block_size=uint16
virtio-blk-pci.physical_block_size=uint16
virtio-blk-pci.min_io_size=uint16
virtio-blk-pci.opt_io_size=uint32
virtio-blk-pci.bootindex=int32
virtio-blk-pci.discard_granularity=uint32
virtio-blk-pci.ioeventfd=on/off
virtio-blk-pci.vectors=uint32
virtio-blk-pci.indirect_desc=on/off
virtio-blk-pci.scsi=on/off
'
18:43:57.802: 2050: debug : qemudStartVMDaemon:2759 : Setting up domain cgroup (if \
required) 18:43:57.802: 2050: debug : qemudStartVMDaemon:2768 : Preparing monitor \
state 18:43:57.802: 2050: debug : qemudStartVMDaemon:2803 : Assigning domain PCI \
addresses 18:43:57.802: 2050: debug : qemuCollectPCIAddress:706 : Remembering PCI \
addr 0:0:3 18:43:57.802: 2050: debug : qemuCollectPCIAddress:706 : Remembering PCI \
addr 0:0:4 18:43:57.802: 2050: debug : qemuCollectPCIAddress:706 : Remembering PCI \
addr 0:0:2 18:43:57.802: 2050: debug : qemuCollectPCIAddress:706 : Remembering PCI \
addr 0:0:1 18:43:57.802: 2050: debug : qemuCollectPCIAddress:706 : Remembering PCI \
addr 0:0:5 18:43:57.802: 2050: debug : qemuDomainPCIAddressReserveAddr:749 : \
Reserving PCI addr 0:0:0 18:43:57.802: 2050: debug : qemudStartVMDaemon:2822 : \
Building emulator command line 18:43:57.802: 2050: debug : \
virNetworkLookupByName:6043 : conn=0xaa6630, nameÞfault 18:43:57.802: 2050: debug : \
virNetworkIsActive:11379 : net=0xaa5e30 18:43:57.802: 2050: debug : \
virNetworkGetBridgeName:6596 : network=0xaa5e30 18:43:57.802: 2050: debug : \
virNetworkFree:6390 : network=0xaa5e30 18:43:57.802: 2050: debug : \
virUnrefNetwork:620 : unref network 0xaa5e30 default 1 18:43:57.802: 2050: debug : \
virReleaseNetwork:575 : release network 0xaa5e30 default \
06bb0128-a641-793d-8be8-ecea7a19e599 18:43:57.802: 2050: debug : \
virReleaseNetwork:589 : unref connection 0xaa6630 2 18:43:57.803: 2045: debug : \
virEventRunOnce:592 : Poll got 1 event(s) 18:43:57.803: 2045: debug : \
virEventDispatchTimeouts:393 : Dispatch 3 18:43:57.803: 2045: debug : \
virEventDispatchHandles:438 : Dispatch 9 18:43:57.803: 2045: debug : \
virEventDispatchHandles:452 : i=0 w=1 18:43:57.803: 2045: debug : \
virEventDispatchHandles:452 : i=1 w=2 18:43:57.803: 2045: debug : \
virEventDispatchHandles:452 : i=2 w=3 18:43:57.803: 2045: debug : \
virEventDispatchHandles:452 : i=3 w=4 18:43:57.803: 2045: debug : \
virEventDispatchHandles:465 : Dispatch n=3 f w=4 e=1 (nil) 18:43:57.803: 2045: debug \
: udevEventHandleCallback:1458 : udev action: 'add' 18:43:57.803: 2045: debug : \
udevGetDeviceProperty:120 : udev reports device 'vnet0' does not have property \
'DRIVER' 18:43:57.803: 2045: debug : udevGetDeviceType:1089 : Found device type \
'(null)' for device 'vnet0' 18:43:57.803: 2045: debug : udevGetDeviceProperty:120 : \
udev reports device 'vnet0' does not have property 'PCI_CLASS' 18:43:57.803: 2045: \
debug : udevGetDeviceProperty:140 : Found property key 'INTERFACE' value 'vnet0' for \
device with sysname 'vnet0' 18:43:57.803: 2045: debug : udevGetDeviceProperty:140 : \
Found property key 'INTERFACE' value 'vnet0' for device with sysname 'vnet0' \
18:43:57.803: 2045: debug : udevGetDeviceSysfsAttr:229 : Found sysfs attribute \
'address' value 'fe:54:00:4f:a9:04' for device with sysname 'vnet0' 18:43:57.803: \
2045: debug : udevGetDeviceSysfsAttr:229 : Found sysfs attribute 'addr_len' value '6' \
for device with sysname 'vnet0' 18:43:57.803: 2045: debug : udevStrToLong_ui:84 : \
Converted '6' to unsigned int 6 18:43:57.803: 2045: debug : \
virEventDispatchHandles:452 : i=4 w=5 18:43:57.803: 2045: debug : \
virEventDispatchHandles:452 : i=5 w=6 18:43:57.803: 2045: debug : \
virEventDispatchHandles:452 : i=6 w=7 18:43:57.803: 2045: debug : \
virEventDispatchHandles:452 : i=7 w=8 18:43:57.803: 2045: debug : \
virEventDispatchHandles:452 : i=8 w 18:43:57.803: 2045: debug : \
virEventCleanupTimeouts:483 : Cleanup 3 18:43:57.803: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 9 18:43:57.803: 2045: debug : \
virEventCleanupTimeouts:483 : Cleanup 3 18:43:57.803: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 9 18:43:57.803: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1 18:43:57.803: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1 18:43:57.803: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1 18:43:57.803: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1 18:43:57.804: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1 18:43:57.804: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=5 w=6, f e% 18:43:57.804: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=6 w=7, f e% 18:43:57.804: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e% 18:43:57.804: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=8 w, f e=1 18:43:57.804: 2045: debug : \
virEventCalculateTimeout:302 : Calculate expiry of 3 timers 18:43:57.804: 2045: debug \
: virEventCalculateTimeout:332 : Timeout at 0 due in -1 ms 18:43:57.804: 2045: debug \
: virEventRunOnce:583 : Poll on 9 handles 0xbda5e0 timeout -1 18:43:57.804: 2045: \
debug : virEventRunOnce:592 : Poll got 1 event(s) 18:43:57.804: 2045: debug : \
virEventDispatchTimeouts:393 : Dispatch 3 18:43:57.804: 2045: debug : \
virEventDispatchHandles:438 : Dispatch 9 18:43:57.804: 2045: debug : \
virEventDispatchHandles:452 : i=0 w=1 18:43:57.804: 2045: debug : \
virEventDispatchHandles:452 : i=1 w=2 18:43:57.804: 2045: debug : \
virEventDispatchHandles:452 : i=2 w=3 18:43:57.804: 2045: debug : \
virEventDispatchHandles:452 : i=3 w=4 18:43:57.804: 2045: debug : \
virEventDispatchHandles:465 : Dispatch n=3 f w=4 e=1 (nil) 18:43:57.804: 2045: debug \
: udevEventHandleCallback:1458 : udev action: 'add' 18:43:57.804: 2045: debug : \
udevGetDeviceProperty:120 : udev reports device 'rx-0' does not have property \
'DRIVER' 18:43:57.804: 2045: debug : udevGetDeviceType:1089 : Found device type \
'(null)' for device 'rx-0' 18:43:57.804: 2045: debug : udevGetDeviceProperty:120 : \
udev reports device 'rx-0' does not have property 'PCI_CLASS' 18:43:57.804: 2045: \
debug : udevGetDeviceProperty:120 : udev reports device 'rx-0' does not have property \
'INTERFACE' 18:43:57.804: 2045: debug : udevGetDeviceType:1146 : Could not determine \
device type for device with sysfs path 'rx-0' 18:43:57.804: 2045: debug : \
virEventDispatchHandles:452 : i=4 w=5 18:43:57.804: 2045: debug : \
virEventDispatchHandles:452 : i=5 w=6 18:43:57.804: 2045: debug : \
virEventDispatchHandles:452 : i=6 w=7 18:43:57.804: 2045: debug : \
virEventDispatchHandles:452 : i=7 w=8 18:43:57.804: 2045: debug : \
virEventDispatchHandles:452 : i=8 w 18:43:57.804: 2045: debug : \
virEventCleanupTimeouts:483 : Cleanup 3 18:43:57.804: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 9 18:43:57.804: 2045: debug : \
virEventCleanupTimeouts:483 : Cleanup 3 18:43:57.804: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 9 18:43:57.804: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1 18:43:57.804: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1 18:43:57.804: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1 18:43:57.804: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1 18:43:57.804: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1 18:43:57.804: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=5 w=6, f e% 18:43:57.804: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=6 w=7, f e% 18:43:57.804: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e% 18:43:57.804: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=8 w, f e=1 18:43:57.804: 2045: debug : \
virEventCalculateTimeout:302 : Calculate expiry of 3 timers 18:43:57.804: 2045: debug \
: virEventCalculateTimeout:332 : Timeout at 0 due in -1 ms 18:43:57.804: 2045: debug \
: virEventRunOnce:583 : Poll on 9 handles 0xb43d80 timeout -1 18:43:57.807: 2050: \
debug : qemudStartVMDaemon:2868 : Clear emulator capabilities: 1 18:43:57.807: 2050: \
debug : virCommandRunAsync:1150 : About to run LC_ALL=C \
PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin QEMU_AUDIO_DRV=none \
/usr/bin/kvm -S -M pc-0.12 -no-kvm -m 1024 -smp 1,sockets=1,cores=1,threads=1 -name \
centos54-1mg -uuid 2a4a5f8e-06b4-079e-bc62-63295f87d4e5 -nodefconfig -nodefaults \
-chardev socket,id=charmonitor,path=/var/lib/libvirt/qemu/centos54-1mg.monitor,server,nowait \
-mon chardev=charmonitor,id=monitor,mode=readline -rtc base=utc -boot c -drive \
file=/tmp/centos54-1mg.img,if=none,id=drive-ide0-0-0,format=raw -device \
ide-drive,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0 -drive \
if=none,mediaÍrom,id=drive-ide0-1-0,readonly=on,format=raw -device \
ide-drive,bus=ide.1,unit=0,drive=drive-ide0-1-0,id=ide0-1-0 -netdev \
tap,fd,id=hostnet0 -device \
rtl8139,netdev=hostnet0,id=net0,macR:54:00:4f:a9:04,bus=pci.0,addr=0x3 -chardev \
pty,id=charserial0 -device isa-serial,chardev=charserial0,id=serial0 -usb -vnc \
127.0.0.1:0 -vga cirrus -device AC97,id=sound0,bus=pci.0,addr=0x4 -incoming \
tcp:0.0.0.0:49154 -device virtio-balloon-pci,idºlloon0,bus=pci.0,addr=0x5 \
18:43:57.807: 2050: debug : virExecWithHook:738 : LC_ALL=C \
PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin QEMU_AUDIO_DRV=none \
/usr/bin/kvm -S -M pc-0.12 -no-kvm -m 1024 -smp 1,sockets=1,cores=1,threads=1 -name \
centos54-1mg -uuid 2a4a5f8e-06b4-079e-bc62-63295f87d4e5 -nodefconfig -nodefaults \
-chardev socket,id=charmonitor,path=/var/lib/libvirt/qemu/centos54-1mg.monitor,server,nowait \
-mon chardev=charmonitor,id=monitor,mode=readline -rtc base=utc -boot c -drive \
file=/tmp/centos54-1mg.img,if=none,id=drive-ide0-0-0,format=raw -device \
ide-drive,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0 -drive \
if=none,mediaÍrom,id=drive-ide0-1-0,readonly=on,format=raw -device \
ide-drive,bus=ide.1,unit=0,drive=drive-ide0-1-0,id=ide0-1-0 -netdev \
tap,fd,id=hostnet0 -device \
rtl8139,netdev=hostnet0,id=net0,macR:54:00:4f:a9:04,bus=pci.0,addr=0x3 -chardev \
pty,id=charserial0 -device isa-serial,chardev=charserial0,id=serial0 -usb -vnc \
127.0.0.1:0 -vga cirrus -device AC97,id=sound0,bus=pci.0,addr=0x4 -incoming \
tcp:0.0.0.0:49154 -device virtio-balloon-pci,idºlloon0,bus=pci.0,addr=0x5 \
18:43:57.808: 2050: debug : virCommandRunAsync:1166 : Command result 0, with PID 2289 \
18:43:57.809: 2050: debug : virCommandRun:1051 : Result stdout: '(null)' stderr: \
'(null)' 18:43:57.809: 2050: debug : qemudStartVMDaemon:2919 : Waiting for monitor to \
show up 18:43:58.009: 2050: debug : qemudWaitForMonitor:1847 : Connect monitor to \
0xbdae80 'centos54-1mg' 18:43:58.009: 2050: debug : virDomainObjRef:967 : \
obj=0xbdae80 refs=3 18:43:58.009: 2050: debug : virEventAddHandleImpl:103 : Add \
handle fd  events cb=0x469f40 opaque=0xb43bb0 18:43:58.009: 2050: debug : \
virEventInterruptLocked:661 : Interrupting 18:43:58.009: 2050: debug : \
qemuMonitorOpen:683 : New mon 0xb43bb0 fd   watch 18:43:58.009: 2050: debug : \
qemuMonitorSetCapabilities:906 : mon=0xb43bb0 18:43:58.009: 2050: debug : \
qemuMonitorGetPtyPaths:1784 : mon=0xb43bb0 18:43:58.009: 2050: debug : \
qemuMonitorCommandWithHandler:231 : Send command 'info chardev' for write with FD -1 \
18:43:58.009: 2050: debug : virEventUpdateHandleImpl:136 : Update handle w e \
18:43:58.009: 2050: debug : virEventInterruptLocked:661 : Interrupting 18:43:58.009: \
2045: debug : virEventRunOnce:592 : Poll got 1 event(s) 18:43:58.009: 2045: debug : \
virEventDispatchTimeouts:393 : Dispatch 3 18:43:58.009: 2045: debug : \
virEventDispatchHandles:438 : Dispatch 9 18:43:58.009: 2045: debug : \
virEventDispatchHandles:452 : i=0 w=1 18:43:58.009: 2045: debug : \
virEventDispatchHandles:465 : Dispatch n=0 f=3 w=1 e=1 (nil) 18:43:58.009: 2045: \
debug : virEventDispatchHandles:452 : i=1 w=2 18:43:58.009: 2045: debug : \
virEventDispatchHandles:452 : i=2 w=3 18:43:58.009: 2045: debug : \
virEventDispatchHandles:452 : i=3 w=4 18:43:58.009: 2045: debug : \
virEventDispatchHandles:452 : i=4 w=5 18:43:58.009: 2045: debug : \
virEventDispatchHandles:452 : i=5 w=6 18:43:58.009: 2045: debug : \
virEventDispatchHandles:452 : i=6 w=7 18:43:58.009: 2045: debug : \
virEventDispatchHandles:452 : i=7 w=8 18:43:58.009: 2045: debug : \
virEventDispatchHandles:452 : i=8 w 18:43:58.009: 2045: debug : \
virEventCleanupTimeouts:483 : Cleanup 3 18:43:58.009: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 10 18:43:58.009: 2045: debug : \
virEventCleanupTimeouts:483 : Cleanup 3 18:43:58.010: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 10 18:43:58.010: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1 18:43:58.010: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1 18:43:58.010: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1 18:43:58.010: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1 18:43:58.010: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1 18:43:58.010: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=5 w=6, f e% 18:43:58.010: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=6 w=7, f e% 18:43:58.010: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e% 18:43:58.010: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=8 w, f e=1 18:43:58.010: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=9 w, f  e) 18:43:58.010: 2045: debug : \
virEventCalculateTimeout:302 : Calculate expiry of 3 timers 18:43:58.010: 2045: debug \
: virEventCalculateTimeout:332 : Timeout at 0 due in -1 ms 18:43:58.010: 2045: debug \
: virEventRunOnce:583 : Poll on 10 handles 0xbdab50 timeout -1 18:43:58.010: 2045: \
debug : virEventRunOnce:592 : Poll got 2 event(s) 18:43:58.010: 2045: debug : \
virEventDispatchTimeouts:393 : Dispatch 3 18:43:58.010: 2045: debug : \
virEventDispatchHandles:438 : Dispatch 10 18:43:58.010: 2045: debug : \
virEventDispatchHandles:452 : i=0 w=1 18:43:58.010: 2045: debug : \
virEventDispatchHandles:465 : Dispatch n=0 f=3 w=1 e=1 (nil) 18:43:58.010: 2045: \
debug : virEventDispatchHandles:452 : i=1 w=2 18:43:58.010: 2045: debug : \
virEventDispatchHandles:452 : i=2 w=3 18:43:58.010: 2045: debug : \
virEventDispatchHandles:452 : i=3 w=4 18:43:58.010: 2045: debug : \
virEventDispatchHandles:452 : i=4 w=5 18:43:58.010: 2045: debug : \
virEventDispatchHandles:452 : i=5 w=6 18:43:58.010: 2045: debug : \
virEventDispatchHandles:452 : i=6 w=7 18:43:58.010: 2045: debug : \
virEventDispatchHandles:452 : i=7 w=8 18:43:58.010: 2045: debug : \
virEventDispatchHandles:452 : i=8 w 18:43:58.010: 2045: debug : \
virEventDispatchHandles:452 : i=9 w 18:43:58.010: 2045: debug : \
virEventDispatchHandles:465 : Dispatch n=9 f  w e=5 0xb43bb0 18:43:58.010: 2045: \
debug : virEventUpdateHandleImpl:136 : Update handle w e 18:43:58.010: 2045: debug \
: virEventInterruptLocked:657 : Skip interrupt, 1 -1733568752 18:43:58.010: 2045: \
debug : virEventCleanupTimeouts:483 : Cleanup 3 18:43:58.010: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 10 18:43:58.010: 2045: debug : \
virEventCleanupTimeouts:483 : Cleanup 3 18:43:58.010: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 10 18:43:58.010: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1 18:43:58.010: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1 18:43:58.010: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1 18:43:58.010: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1 18:43:58.010: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1 18:43:58.010: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=5 w=6, f e% 18:43:58.010: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=6 w=7, f e% 18:43:58.010: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e% 18:43:58.010: 2045: debug : \
18:43:58.010: 2045: debug : virEventCalculateTimeout:302 : Calculate expiry of 3 \
timers 18:43:58.010: 2045: debug : virEventCalculateTimeout:332 : Timeout at 0 due in \
-1 ms 18:43:58.010: 2045: debug : virEventRunOnce:583 : Poll on 10 handles 0xbdab50 \
timeout -1 18:43:58.010: 2045: debug : virEventRunOnce:592 : Poll got 1 event(s)
18:43:58.010: 2045: debug : virEventDispatchTimeouts:393 : Dispatch 3
18:43:58.010: 2045: debug : virEventDispatchHandles:438 : Dispatch 10
18:43:58.010: 2045: debug : virEventDispatchHandles:452 : i=0 w=1
18:43:58.010: 2045: debug : virEventDispatchHandles:452 : i=1 w=2
18:43:58.010: 2045: debug : virEventDispatchHandles:452 : i=2 w=3
18:43:58.010: 2045: debug : virEventDispatchHandles:452 : i=3 w=4
18:43:58.010: 2045: debug : virEventDispatchHandles:452 : i=4 w=5
18:43:58.010: 2045: debug : virEventDispatchHandles:452 : i=5 w=6
18:43:58.010: 2045: debug : virEventDispatchHandles:452 : i=6 w=7
18:43:58.010: 2045: debug : virEventDispatchHandles:452 : i=7 w=8
18:43:58.010: 2045: debug : virEventDispatchHandles:452 : i=8 w
18:43:58.010: 2045: debug : virEventDispatchHandles:452 : i=9 w
18:43:58.010: 2045: debug : virEventDispatchHandles:465 : Dispatch n=9 f  w e=1 \
0xb43bb0 18:43:58.010: 2045: debug : virEventUpdateHandleImpl:136 : Update handle w \
e 18:43:58.010: 2045: debug : virEventInterruptLocked:657 : Skip interrupt, 1 \
-1733568752 18:43:58.010: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:58.010: 2050: debug : virEventUpdateHandleImpl:136 : Update handle w e
18:43:58.010: 2045: debug : virEventCleanupHandles:526 : Cleanup 10
18:43:58.010: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:58.010: 2045: debug : virEventCleanupHandles:526 : Cleanup 10
18:43:58.010: 2045: debug : virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1
18:43:58.010: 2045: debug : virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1
18:43:58.010: 2045: debug : virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1
18:43:58.010: 2045: debug : virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1
18:43:58.010: 2045: debug : virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1
18:43:58.010: 2045: debug : virEventMakePollFDs:361 : Prepare n=5 w=6, f e%
18:43:58.010: 2045: debug : virEventMakePollFDs:361 : Prepare n=6 w=7, f e%
18:43:58.010: 2045: debug : virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e%
18:43:58.010: 2045: debug : virEventMakePollFDs:361 : Prepare n=8 w, f e=1
18:43:58.010: 2045: debug : virEventMakePollFDs:361 : Prepare n=9 w, f  e%
18:43:58.010: 2045: debug : virEventCalculateTimeout:302 : Calculate expiry of 3 \
timers 18:43:58.010: 2045: debug : virEventCalculateTimeout:332 : Timeout at 0 due in \
-1 ms 18:43:58.010: 2045: debug : virEventRunOnce:583 : Poll on 10 handles \
0x7f78900416e0 timeout -1 18:43:58.010: 2050: debug : virEventInterruptLocked:661 : \
Interrupting 18:43:58.011: 2050: debug : qemuMonitorCommandWithHandler:236 : Receive \
command reply ret=0 errno=0 116 bytes 'charmonitor: \
                filename=unix:/var/lib/libvirt/qemu/centos54-1mg.monitor,server
charserial0: filename=pty:/dev/pts/3
'
18:43:58.011: 2050: debug : qemudWaitForMonitor:1867 : qemuMonitorGetPtyPaths \
returned 0 18:43:58.011: 2045: debug : virEventRunOnce:592 : Poll got 1 event(s)
18:43:58.011: 2045: debug : virEventDispatchTimeouts:393 : Dispatch 3
18:43:58.011: 2050: debug : qemudStartVMDaemon:2923 : Detecting VCPU PIDs
18:43:58.011: 2045: debug : virEventDispatchHandles:438 : Dispatch 10
18:43:58.011: 2050: debug : qemudStartVMDaemon:2927 : Setting any required VM \
passwords 18:43:58.011: 2045: debug : virEventDispatchHandles:452 : i=0 w=1
18:43:58.011: 2045: debug : virEventDispatchHandles:465 : Dispatch n=0 f=3 w=1 e=1 \
(nil) 18:43:58.011: 2050: debug : qemudStartVMDaemon:2939 : Setting initial memory \
amount 18:43:58.011: 2050: debug : qemuMonitorSetBalloon:1194 : mon=0xb43bb0 \
newmem48576 18:43:58.011: 2045: debug : virEventDispatchHandles:452 : i=1 w=2
18:43:58.011: 2045: debug : virEventDispatchHandles:452 : i=2 w=3
18:43:58.011: 2050: debug : qemuMonitorCommandWithHandler:231 : Send command 'balloon \
1024' for write with FD -1 18:43:58.011: 2045: debug : virEventDispatchHandles:452 : \
i=3 w=4 18:43:58.011: 2050: debug : virEventUpdateHandleImpl:136 : Update handle w \
e 18:43:58.011: 2045: debug : virEventDispatchHandles:452 : i=4 w=5
18:43:58.011: 2045: debug : virEventDispatchHandles:452 : i=5 w=6
18:43:58.011: 2045: debug : virEventDispatchHandles:452 : i=6 w=7
18:43:58.011: 2045: debug : virEventDispatchHandles:452 : i=7 w=8
18:43:58.011: 2045: debug : virEventDispatchHandles:452 : i=8 w
18:43:58.011: 2045: debug : virEventDispatchHandles:452 : i=9 w
18:43:58.011: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:58.011: 2045: debug : virEventCleanupHandles:526 : Cleanup 10
18:43:58.011: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:58.011: 2045: debug : virEventCleanupHandles:526 : Cleanup 10
18:43:58.011: 2045: debug : virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1
18:43:58.011: 2045: debug : virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1
18:43:58.011: 2045: debug : virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1
18:43:58.011: 2045: debug : virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1
18:43:58.011: 2045: debug : virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1
18:43:58.011: 2045: debug : virEventMakePollFDs:361 : Prepare n=5 w=6, f e%
18:43:58.011: 2045: debug : virEventMakePollFDs:361 : Prepare n=6 w=7, f e%
18:43:58.011: 2045: debug : virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e%
18:43:58.011: 2045: debug : virEventMakePollFDs:361 : Prepare n=8 w, f e=1
18:43:58.011: 2045: debug : virEventMakePollFDs:361 : Prepare n=9 w, f  e%
18:43:58.011: 2045: debug : virEventCalculateTimeout:302 : Calculate expiry of 3 \
timers 18:43:58.011: 2045: debug : virEventCalculateTimeout:332 : Timeout at 0 due in \
-1 ms 18:43:58.011: 2045: debug : virEventRunOnce:583 : Poll on 10 handles \
0x7f78900416e0 timeout -1 18:43:58.011: 2050: debug : virEventInterruptLocked:661 : \
Interrupting 18:43:58.011: 2045: debug : virEventRunOnce:592 : Poll got 1 event(s)
18:43:58.011: 2045: debug : virEventDispatchTimeouts:393 : Dispatch 3
18:43:58.011: 2045: debug : virEventDispatchHandles:438 : Dispatch 10
18:43:58.011: 2045: debug : virEventDispatchHandles:452 : i=0 w=1
18:43:58.011: 2045: debug : virEventDispatchHandles:465 : Dispatch n=0 f=3 w=1 e=1 \
(nil) 18:43:58.011: 2045: debug : virEventDispatchHandles:452 : i=1 w=2
18:43:58.011: 2045: debug : virEventDispatchHandles:452 : i=2 w=3
18:43:58.011: 2045: debug : virEventDispatchHandles:452 : i=3 w=4
18:43:58.011: 2045: debug : virEventDispatchHandles:452 : i=4 w=5
18:43:58.011: 2045: debug : virEventDispatchHandles:452 : i=5 w=6
18:43:58.011: 2045: debug : virEventDispatchHandles:452 : i=6 w=7
18:43:58.011: 2045: debug : virEventDispatchHandles:452 : i=7 w=8
18:43:58.011: 2045: debug : virEventDispatchHandles:452 : i=8 w
18:43:58.011: 2045: debug : virEventDispatchHandles:452 : i=9 w
18:43:58.011: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:58.011: 2045: debug : virEventCleanupHandles:526 : Cleanup 10
18:43:58.011: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:58.011: 2045: debug : virEventCleanupHandles:526 : Cleanup 10
18:43:58.011: 2045: debug : virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1
18:43:58.011: 2045: debug : virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1
18:43:58.011: 2045: debug : virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1
18:43:58.011: 2045: debug : virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1
18:43:58.011: 2045: debug : virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1
18:43:58.011: 2045: debug : virEventMakePollFDs:361 : Prepare n=5 w=6, f e%
18:43:58.011: 2045: debug : virEventMakePollFDs:361 : Prepare n=6 w=7, f e%
18:43:58.011: 2045: debug : virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e%
18:43:58.011: 2045: debug : virEventMakePollFDs:361 : Prepare n=8 w, f e=1
18:43:58.011: 2045: debug : virEventMakePollFDs:361 : Prepare n=9 w, f  e)
18:43:58.012: 2045: debug : virEventCalculateTimeout:302 : Calculate expiry of 3 \
timers 18:43:58.012: 2045: debug : virEventCalculateTimeout:332 : Timeout at 0 due in \
-1 ms 18:43:58.012: 2045: debug : virEventRunOnce:583 : Poll on 10 handles \
0x7f78900416e0 timeout -1 18:43:58.012: 2045: debug : virEventRunOnce:592 : Poll got \
1 event(s) 18:43:58.012: 2045: debug : virEventDispatchTimeouts:393 : Dispatch 3
18:43:58.012: 2045: debug : virEventDispatchHandles:438 : Dispatch 10
18:43:58.012: 2045: debug : virEventDispatchHandles:452 : i=0 w=1
18:43:58.012: 2045: debug : virEventDispatchHandles:452 : i=1 w=2
18:43:58.012: 2045: debug : virEventDispatchHandles:452 : i=2 w=3
18:43:58.012: 2045: debug : virEventDispatchHandles:452 : i=3 w=4
18:43:58.012: 2045: debug : virEventDispatchHandles:452 : i=4 w=5
18:43:58.012: 2045: debug : virEventDispatchHandles:452 : i=5 w=6
18:43:58.012: 2045: debug : virEventDispatchHandles:452 : i=6 w=7
18:43:58.012: 2045: debug : virEventDispatchHandles:452 : i=7 w=8
18:43:58.012: 2045: debug : virEventDispatchHandles:452 : i=8 w
18:43:58.012: 2045: debug : virEventDispatchHandles:452 : i=9 w
18:43:58.012: 2045: debug : virEventDispatchHandles:465 : Dispatch n=9 f  w e=4 \
0xb43bb0 18:43:58.012: 2045: debug : virEventUpdateHandleImpl:136 : Update handle w \
e 18:43:58.012: 2045: debug : virEventInterruptLocked:657 : Skip interrupt, 1 \
-1733568752 18:43:58.012: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:58.012: 2045: debug : virEventCleanupHandles:526 : Cleanup 10
18:43:58.012: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:58.012: 2045: debug : virEventCleanupHandles:526 : Cleanup 10
18:43:58.012: 2045: debug : virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1
18:43:58.012: 2045: debug : virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1
18:43:58.012: 2045: debug : virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1
18:43:58.012: 2045: debug : virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1
18:43:58.012: 2045: debug : virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1
18:43:58.012: 2045: debug : virEventMakePollFDs:361 : Prepare n=5 w=6, f e%
18:43:58.012: 2045: debug : virEventMakePollFDs:361 : Prepare n=6 w=7, f e%
18:43:58.012: 2045: debug : virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e%
18:43:58.012: 2045: debug : virEventMakePollFDs:361 : Prepare n=8 w, f e=1
18:43:58.012: 2045: debug : virEventMakePollFDs:361 : Prepare n=9 w, f  e%
18:43:58.012: 2045: debug : virEventCalculateTimeout:302 : Calculate expiry of 3 \
timers 18:43:58.012: 2045: debug : virEventCalculateTimeout:332 : Timeout at 0 due in \
-1 ms 18:43:58.012: 2045: debug : virEventRunOnce:583 : Poll on 10 handles \
0x7f78900416e0 timeout -1 18:43:58.012: 2045: debug : virEventRunOnce:592 : Poll got \
1 event(s) 18:43:58.012: 2045: debug : virEventDispatchTimeouts:393 : Dispatch 3
18:43:58.012: 2045: debug : virEventDispatchHandles:438 : Dispatch 10
18:43:58.012: 2045: debug : virEventDispatchHandles:452 : i=0 w=1
18:43:58.012: 2045: debug : virEventDispatchHandles:452 : i=1 w=2
18:43:58.012: 2045: debug : virEventDispatchHandles:452 : i=2 w=3
18:43:58.012: 2045: debug : virEventDispatchHandles:452 : i=3 w=4
18:43:58.012: 2045: debug : virEventDispatchHandles:452 : i=4 w=5
18:43:58.012: 2045: debug : virEventDispatchHandles:452 : i=5 w=6
18:43:58.012: 2045: debug : virEventDispatchHandles:452 : i=6 w=7
18:43:58.012: 2045: debug : virEventDispatchHandles:452 : i=7 w=8
18:43:58.012: 2045: debug : virEventDispatchHandles:452 : i=8 w
18:43:58.012: 2045: debug : virEventDispatchHandles:452 : i=9 w
18:43:58.012: 2045: debug : virEventDispatchHandles:465 : Dispatch n=9 f  w e=1 \
0xb43bb0 18:43:58.012: 2045: debug : virEventUpdateHandleImpl:136 : Update handle w \
e 18:43:58.012: 2045: debug : virEventInterruptLocked:657 : Skip interrupt, 1 \
-1733568752 18:43:58.012: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:58.012: 2045: debug : virEventCleanupHandles:526 : Cleanup 10
18:43:58.012: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:58.012: 2050: debug : virEventUpdateHandleImpl:136 : Update handle w e
18:43:58.012: 2045: debug : virEventCleanupHandles:526 : Cleanup 10
18:43:58.012: 2045: debug : virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1
18:43:58.012: 2045: debug : virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1
18:43:58.012: 2045: debug : virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1
18:43:58.012: 2045: debug : virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1
18:43:58.012: 2045: debug : virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1
18:43:58.012: 2045: debug : virEventMakePollFDs:361 : Prepare n=5 w=6, f e%
18:43:58.012: 2045: debug : virEventMakePollFDs:361 : Prepare n=6 w=7, f e%
18:43:58.012: 2045: debug : virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e%
18:43:58.012: 2045: debug : virEventMakePollFDs:361 : Prepare n=8 w, f e=1
18:43:58.012: 2045: debug : virEventMakePollFDs:361 : Prepare n=9 w, f  e%
18:43:58.012: 2045: debug : virEventCalculateTimeout:302 : Calculate expiry of 3 \
timers 18:43:58.012: 2045: debug : virEventCalculateTimeout:332 : Timeout at 0 due in \
-1 ms 18:43:58.012: 2045: debug : virEventRunOnce:583 : Poll on 10 handles \
0x7f78900416e0 timeout -1 18:43:58.012: 2050: debug : virEventInterruptLocked:661 : \
Interrupting 18:43:58.013: 2050: debug : qemuMonitorCommandWithHandler:236 : Receive \
command reply ret=0 errno=0 0 bytes '(null)' 18:43:58.013: 2050: debug : \
qemudStartVMDaemon:2959 : Writing domain status to disk 18:43:58.013: 2045: debug : \
virEventRunOnce:592 : Poll got 1 event(s) 18:43:58.013: 2045: debug : \
virEventDispatchTimeouts:393 : Dispatch 3 18:43:58.013: 2045: debug : \
virEventDispatchHandles:438 : Dispatch 10 18:43:58.013: 2045: debug : \
virEventDispatchHandles:452 : i=0 w=1 18:43:58.013: 2045: debug : \
virEventDispatchHandles:465 : Dispatch n=0 f=3 w=1 e=1 (nil) 18:43:58.013: 2045: \
debug : virEventDispatchHandles:452 : i=1 w=2 18:43:58.013: 2045: debug : \
virEventDispatchHandles:452 : i=2 w=3 18:43:58.013: 2050: debug : \
virDomainObjUnref:974 : obj=0xbdae80 refs=2 18:43:58.013: 2045: debug : \
virEventDispatchHandles:452 : i=3 w=4 18:43:58.013: 2045: debug : \
virEventDispatchHandles:452 : i=4 w=5 18:43:58.013: 2045: debug : \
virEventDispatchHandles:452 : i=5 w=6 18:43:58.013: 2050: debug : \
virEventUpdateTimeoutImpl:236 : Updating timer 12 timeout with 0 ms freq \
18:43:58.013: 2045: debug : virEventDispatchHandles:452 : i=6 w=7 18:43:58.013: 2045: \
debug : virEventDispatchHandles:452 : i=7 w=8 18:43:58.013: 2045: debug : \
virEventDispatchHandles:452 : i=8 w 18:43:58.013: 2045: debug : \
virEventDispatchHandles:452 : i=9 w 18:43:58.013: 2045: debug : \
virEventCleanupTimeouts:483 : Cleanup 3 18:43:58.013: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 10 18:43:58.013: 2045: debug : \
virEventCleanupTimeouts:483 : Cleanup 3 18:43:58.013: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 10 18:43:58.013: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1 18:43:58.013: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1 18:43:58.013: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1 18:43:58.013: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1 18:43:58.013: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1 18:43:58.013: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=5 w=6, f e% 18:43:58.013: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=6 w=7, f e% 18:43:58.013: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e% 18:43:58.013: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=8 w, f e=1 18:43:58.013: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=9 w, f  e% 18:43:58.013: 2045: debug : \
virEventCalculateTimeout:302 : Calculate expiry of 3 timers 18:43:58.013: 2045: debug \
: virEventCalculateTimeout:332 : Timeout at 0 due in -1 ms 18:43:58.013: 2045: debug \
: virEventRunOnce:583 : Poll on 10 handles 0x7f78900416e0 timeout -1 18:43:58.013: \
2050: debug : virEventInterruptLocked:661 : Interrupting 18:43:58.013: 2050: debug : \
virEventUpdateHandleImpl:136 : Update handle w e=3 18:43:58.013: 2045: debug : \
virEventRunOnce:592 : Poll got 1 event(s) 18:43:58.013: 2050: debug : \
virEventInterruptLocked:661 : Interrupting 18:43:58.013: 2045: debug : \
virEventDispatchTimeouts:393 : Dispatch 3 18:43:58.013: 2045: debug : \
virEventUpdateTimeoutImpl:236 : Updating timer 12 timeout with -1 ms freq \
18:43:58.013: 2045: debug : virEventInterruptLocked:657 : Skip interrupt, 1 \
-1733568752 18:43:58.013: 2045: debug : virEventDispatchHandles:438 : Dispatch 10
18:43:58.013: 2045: debug : virEventDispatchHandles:452 : i=0 w=1
18:43:58.013: 2045: debug : virEventDispatchHandles:465 : Dispatch n=0 f=3 w=1 e=1 \
(nil) 18:43:58.013: 2045: debug : virEventDispatchHandles:452 : i=1 w=2
18:43:58.013: 2045: debug : virEventDispatchHandles:452 : i=2 w=3
18:43:58.013: 2045: debug : virEventDispatchHandles:452 : i=3 w=4
18:43:58.013: 2045: debug : virEventDispatchHandles:452 : i=4 w=5
18:43:58.013: 2045: debug : virEventDispatchHandles:452 : i=5 w=6
18:43:58.013: 2045: debug : virEventDispatchHandles:452 : i=6 w=7
18:43:58.013: 2045: debug : virEventDispatchHandles:452 : i=7 w=8
18:43:58.013: 2045: debug : virEventDispatchHandles:452 : i=8 w
18:43:58.013: 2045: debug : virEventDispatchHandles:452 : i=9 w
18:43:58.013: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:58.013: 2045: debug : virEventCleanupHandles:526 : Cleanup 10
18:43:58.013: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:58.013: 2045: debug : virEventCleanupHandles:526 : Cleanup 10
18:43:58.013: 2045: debug : virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1
18:43:58.013: 2045: debug : virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1
18:43:58.013: 2045: debug : virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1
18:43:58.014: 2045: debug : virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1
18:43:58.014: 2045: debug : virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1
18:43:58.014: 2045: debug : virEventMakePollFDs:361 : Prepare n=5 w=6, f e%
18:43:58.014: 2045: debug : virEventMakePollFDs:361 : Prepare n=6 w=7, f e%
18:43:58.014: 2045: debug : virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e%
18:43:58.014: 2045: debug : virEventMakePollFDs:361 : Prepare n=8 w, f e=5
18:43:58.014: 2045: debug : virEventMakePollFDs:361 : Prepare n=9 w, f  e%
18:43:58.014: 2045: debug : virEventCalculateTimeout:302 : Calculate expiry of 3 \
timers 18:43:58.014: 2045: debug : virEventCalculateTimeout:332 : Timeout at 0 due in \
-1 ms 18:43:58.014: 2045: debug : virEventRunOnce:583 : Poll on 10 handles \
0x7f78900416e0 timeout -1 18:43:58.014: 2045: debug : virEventRunOnce:592 : Poll got \
2 event(s) 18:43:58.014: 2045: debug : virEventDispatchTimeouts:393 : Dispatch 3
18:43:58.014: 2045: debug : virEventDispatchHandles:438 : Dispatch 10
18:43:58.014: 2045: debug : virEventDispatchHandles:452 : i=0 w=1
18:43:58.014: 2045: debug : virEventDispatchHandles:465 : Dispatch n=0 f=3 w=1 e=1 \
(nil) 18:43:58.014: 2045: debug : virEventDispatchHandles:452 : i=1 w=2
18:43:58.014: 2045: debug : virEventDispatchHandles:452 : i=2 w=3
18:43:58.014: 2045: debug : virEventDispatchHandles:452 : i=3 w=4
18:43:58.014: 2045: debug : virEventDispatchHandles:452 : i=4 w=5
18:43:58.014: 2045: debug : virEventDispatchHandles:452 : i=5 w=6
18:43:58.014: 2045: debug : virEventDispatchHandles:452 : i=6 w=7
18:43:58.014: 2045: debug : virEventDispatchHandles:452 : i=7 w=8
18:43:58.014: 2045: debug : virEventDispatchHandles:452 : i=8 w
18:43:58.014: 2045: debug : virEventDispatchHandles:465 : Dispatch n=8 f w e=4 \
0xa8e740 18:43:58.014: 2045: debug : virEventUpdateHandleImpl:136 : Update handle w \
e=1 18:43:58.014: 2045: debug : virEventInterruptLocked:657 : Skip interrupt, 1 \
-1733568752 18:43:58.014: 2045: debug : virEventDispatchHandles:452 : i=9 w
18:43:58.014: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:58.014: 2045: debug : virEventCleanupHandles:526 : Cleanup 10
18:43:58.014: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:58.014: 2045: debug : virEventCleanupHandles:526 : Cleanup 10
18:43:58.014: 2045: debug : virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1
18:43:58.014: 2045: debug : virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1
18:43:58.014: 2045: debug : virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1
18:43:58.014: 2045: debug : virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1
18:43:58.014: 2045: debug : virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1
18:43:58.014: 2045: debug : virEventMakePollFDs:361 : Prepare n=5 w=6, f e%
18:43:58.014: 2045: debug : virEventMakePollFDs:361 : Prepare n=6 w=7, f e%
18:43:58.014: 2045: debug : virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e%
18:43:58.014: 2045: debug : virEventMakePollFDs:361 : Prepare n=8 w, f e=1
18:43:58.014: 2045: debug : virEventMakePollFDs:361 : Prepare n=9 w, f  e%
18:43:58.014: 2045: debug : virEventCalculateTimeout:302 : Calculate expiry of 3 \
timers 18:43:58.014: 2045: debug : virEventCalculateTimeout:332 : Timeout at 0 due in \
-1 ms 18:43:58.014: 2045: debug : virEventRunOnce:583 : Poll on 10 handles \
0x7f78900416e0 timeout -1 18:43:58.119: 2045: debug : virEventRunOnce:592 : Poll got \
1 event(s) 18:43:58.119: 2045: debug : virEventDispatchTimeouts:393 : Dispatch 3
18:43:58.119: 2045: debug : virEventDispatchHandles:438 : Dispatch 10
18:43:58.119: 2045: debug : virEventDispatchHandles:452 : i=0 w=1
18:43:58.119: 2045: debug : virEventDispatchHandles:452 : i=1 w=2
18:43:58.119: 2045: debug : virEventDispatchHandles:452 : i=2 w=3
18:43:58.119: 2045: debug : virEventDispatchHandles:452 : i=3 w=4
18:43:58.119: 2045: debug : virEventDispatchHandles:452 : i=4 w=5
18:43:58.119: 2045: debug : virEventDispatchHandles:452 : i=5 w=6
18:43:58.119: 2045: debug : virEventDispatchHandles:452 : i=6 w=7
18:43:58.119: 2045: debug : virEventDispatchHandles:452 : i=7 w=8
18:43:58.119: 2045: debug : virEventDispatchHandles:452 : i=8 w
18:43:58.119: 2045: debug : virEventDispatchHandles:452 : i=9 w
18:43:58.119: 2045: debug : virEventDispatchHandles:465 : Dispatch n=9 f  w e \
0xb43bb0 18:43:58.119: 2045: debug : virEventUpdateHandleImpl:136 : Update handle w \
e 18:43:58.119: 2045: debug : virEventInterruptLocked:657 : Skip interrupt, 1 \
-1733568752 18:43:58.119: 2045: debug : qemuMonitorIO:592 : Triggering EOF callback \
error? 0 18:43:58.119: 2045: debug : qemuHandleMonitorEOF:355 : Received EOF on \
0xbdae80 'centos54-1mg' 18:43:58.119: 2045: debug : qemudShutdownVMDaemon:2993 : \
Shutting down VM 'centos54-1mg' pid"91 migrated=0 18:43:58.119: 2045: debug : \
qemuMonitorClose:706 : mon=0xb43bb0 18:43:58.119: 2045: debug : \
virEventRemoveHandleImpl:163 : Remove handle w 18:43:58.119: 2045: debug : \
virEventRemoveHandleImpl:176 : mark delete 9 20 18:43:58.119: 2045: debug : \
virEventInterruptLocked:657 : Skip interrupt, 1 -1733568752 18:43:58.119: 2045: debug \
: virSecurityDACRestoreSecurityAllLabel:493 : Restoring security label on \
centos54-1mg migrated=0 18:43:58.119: 2045: info : \
virSecurityDACRestoreSecurityFileLabel:139 : Restoring DAC user and group on \
'/tmp/centos54-1mg.img' 18:43:58.119: 2045: info : virSecurityDACSetOwnership:99 : \
Setting DAC user and group on '/tmp/centos54-1mg.img' to '0:0' 18:43:58.119: 2045: \
debug : virDomainObjUnref:974 : obj=0xbdae80 refs=1 18:43:58.119: 2045: debug : \
virEventUpdateTimeoutImpl:236 : Updating timer 12 timeout with 0 ms freq \
18:43:58.119: 2045: debug : virEventInterruptLocked:657 : Skip interrupt, 1 \
-1733568752 18:43:58.119: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:58.119: 2045: debug : virEventCleanupHandles:526 : Cleanup 10
18:43:58.119: 2045: debug : qemuMonitorFree:207 : mon=0xb43bb0
18:43:58.119: 2045: debug : virDomainObjUnref:974 : obj=0xbdae80 refs=0
18:43:58.119: 2045: debug : virDomainObjFree:950 : obj=0xbdae80
18:43:58.119: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:58.119: 2045: debug : virEventCleanupHandles:526 : Cleanup 9
18:43:58.119: 2045: debug : virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1
18:43:58.119: 2045: debug : virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1
18:43:58.119: 2045: debug : virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1
18:43:58.119: 2045: debug : virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1
18:43:58.119: 2045: debug : virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1
18:43:58.119: 2045: debug : virEventMakePollFDs:361 : Prepare n=5 w=6, f e%
18:43:58.119: 2045: debug : virEventMakePollFDs:361 : Prepare n=6 w=7, f e%
18:43:58.119: 2045: debug : virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e%
18:43:58.119: 2045: debug : virEventMakePollFDs:361 : Prepare n=8 w, f e=1
18:43:58.119: 2045: debug : virEventCalculateTimeout:302 : Calculate expiry of 3 \
timers 18:43:58.119: 2045: debug : virEventCalculateTimeout:308 : Got a timeout \
scheduled for 1301305438119 18:43:58.119: 2045: debug : virEventCalculateTimeout:332 \
: Timeout at 1301305438119 due in 0 ms 18:43:58.119: 2045: debug : \
virEventRunOnce:583 : Poll on 9 handles 0x7f7890001380 timeout 0 18:43:58.119: 2045: \
debug : virEventRunOnce:592 : Poll got 0 event(s) 18:43:58.119: 2045: debug : \
virEventDispatchTimeouts:393 : Dispatch 3 18:43:58.119: 2045: debug : \
virEventUpdateTimeoutImpl:236 : Updating timer 12 timeout with -1 ms freq \
18:43:58.119: 2045: debug : virEventInterruptLocked:657 : Skip interrupt, 1 \
-1733568752 18:43:58.119: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:58.119: 2045: debug : virEventCleanupHandles:526 : Cleanup 9
18:43:58.119: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:58.119: 2045: debug : virEventCleanupHandles:526 : Cleanup 9
18:43:58.119: 2045: debug : virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1
18:43:58.119: 2045: debug : virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1
18:43:58.119: 2045: debug : virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1
18:43:58.120: 2045: debug : virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1
18:43:58.120: 2045: debug : virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1
18:43:58.120: 2045: debug : virEventMakePollFDs:361 : Prepare n=5 w=6, f e%
18:43:58.120: 2045: debug : virEventMakePollFDs:361 : Prepare n=6 w=7, f e%
18:43:58.120: 2045: debug : virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e%
18:43:58.120: 2045: debug : virEventMakePollFDs:361 : Prepare n=8 w, f e=1
18:43:58.120: 2045: debug : virEventCalculateTimeout:302 : Calculate expiry of 3 \
timers 18:43:58.120: 2045: debug : virEventCalculateTimeout:332 : Timeout at 0 due in \
-1 ms 18:43:58.120: 2045: debug : virEventRunOnce:583 : Poll on 9 handles \
0x7f7890000e40 timeout -1 18:43:58.175: 2045: debug : virEventRunOnce:592 : Poll got \
1 event(s) 18:43:58.175: 2045: debug : virEventDispatchTimeouts:393 : Dispatch 3
18:43:58.175: 2045: debug : virEventDispatchHandles:438 : Dispatch 9
18:43:58.175: 2045: debug : virEventDispatchHandles:452 : i=0 w=1
18:43:58.175: 2045: debug : virEventDispatchHandles:452 : i=1 w=2
18:43:58.175: 2045: debug : virEventDispatchHandles:452 : i=2 w=3
18:43:58.175: 2045: debug : virEventDispatchHandles:452 : i=3 w=4
18:43:58.175: 2045: debug : virEventDispatchHandles:452 : i=4 w=5
18:43:58.175: 2045: debug : virEventDispatchHandles:452 : i=5 w=6
18:43:58.175: 2045: debug : virEventDispatchHandles:452 : i=6 w=7
18:43:58.175: 2045: debug : virEventDispatchHandles:452 : i=7 w=8
18:43:58.175: 2045: debug : virEventDispatchHandles:452 : i=8 w
18:43:58.175: 2045: debug : virEventDispatchHandles:465 : Dispatch n=8 f w e=1 \
0xa8e740 18:43:58.175: 2045: debug : virEventUpdateHandleImpl:136 : Update handle w \
e=1 18:43:58.175: 2045: debug : virEventInterruptLocked:657 : Skip interrupt, 1 \
-1733568752 18:43:58.175: 2045: debug : virEventUpdateHandleImpl:136 : Update handle \
w e=1 18:43:58.175: 2045: debug : virEventInterruptLocked:657 : Skip interrupt, 1 \
-1733568752 18:43:58.175: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:58.175: 2045: debug : virEventCleanupHandles:526 : Cleanup 9
18:43:58.175: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:43:58.175: 2045: debug : virEventCleanupHandles:526 : Cleanup 9
18:43:58.175: 2045: debug : virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1
18:43:58.175: 2045: debug : virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1
18:43:58.175: 2045: debug : virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1
18:43:58.175: 2045: debug : virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1
18:43:58.175: 2045: debug : virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1
18:43:58.175: 2045: debug : virEventMakePollFDs:361 : Prepare n=5 w=6, f e%
18:43:58.175: 2046: debug : remoteDispatchClientRequest:377 : progS6903814 ver=1 \
type=0 status=0 serial=4 proc9 18:43:58.175: 2045: debug : virEventMakePollFDs:361 : \
Prepare n=6 w=7, f e% 18:43:58.175: 2045: debug : virEventMakePollFDs:361 : Prepare \
n=7 w=8, f=9 e% 18:43:58.175: 2046: debug : virDomainMigrateFinish2:3916 : \
dconn=0xaa6630, dnameÎntos54-1mg, cookie=(nil), cookielen=0, uri=tcp:hostB:49154, \
flagsg, retcode=-1 18:43:58.175: 2045: debug : virEventMakePollFDs:361 : Prepare n=8 \
w, f e=1 18:43:58.175: 2045: debug : virEventCalculateTimeout:302 : Calculate \
expiry of 3 timers 18:43:58.175: 2046: debug : qemudDomainMigrateFinish2:9068 : \
Domain not found: no domain with matching name 'centos54-1mg' 18:43:58.175: 2045: \
debug : virEventCalculateTimeout:332 : Timeout at 0 due in -1 ms 18:43:58.175: 2045: \
debug : virEventRunOnce:583 : Poll on 9 handles 0x7f7890000e90 timeout -1 \
18:43:58.175: 2046: debug : remoteSerializeError:146 : progS6903814 ver=1 proc9 \
type=1 serial=4, msg=Unknown failure 18:43:58.175: 2046: debug : \
virEventUpdateHandleImpl:136 : Update handle w e=3 18:43:58.175: 2046: debug : \
virEventInterruptLocked:661 : Interrupting 18:43:58.175: 2045: debug : \
virEventRunOnce:592 : Poll got 1 event(s) 18:43:58.175: 2045: debug : \
virEventDispatchTimeouts:393 : Dispatch 3 18:43:58.175: 2045: debug : \
virEventDispatchHandles:438 : Dispatch 9 18:43:58.175: 2045: debug : \
virEventDispatchHandles:452 : i=0 w=1 18:43:58.175: 2045: debug : \
virEventDispatchHandles:465 : Dispatch n=0 f=3 w=1 e=1 (nil) 18:43:58.175: 2045: \
debug : virEventDispatchHandles:452 : i=1 w=2 18:43:58.175: 2045: debug : \
virEventDispatchHandles:452 : i=2 w=3 18:43:58.176: 2045: debug : \
virEventDispatchHandles:452 : i=3 w=4 18:43:58.176: 2045: debug : \
virEventDispatchHandles:452 : i=4 w=5 18:43:58.176: 2045: debug : \
virEventDispatchHandles:452 : i=5 w=6 18:43:58.176: 2045: debug : \
virEventDispatchHandles:452 : i=6 w=7 18:43:58.176: 2045: debug : \
virEventDispatchHandles:452 : i=7 w=8 18:43:58.176: 2045: debug : \
virEventDispatchHandles:452 : i=8 w 18:43:58.176: 2045: debug : \
virEventCleanupTimeouts:483 : Cleanup 3 18:43:58.176: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 9 18:43:58.176: 2045: debug : \
virEventCleanupTimeouts:483 : Cleanup 3 18:43:58.176: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 9 18:43:58.176: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1 18:43:58.176: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1 18:43:58.176: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1 18:43:58.176: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1 18:43:58.176: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1 18:43:58.176: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=5 w=6, f e% 18:43:58.176: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=6 w=7, f e% 18:43:58.176: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e% 18:43:58.176: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=8 w, f e=5 18:43:58.176: 2045: debug : \
virEventCalculateTimeout:302 : Calculate expiry of 3 timers 18:43:58.176: 2045: debug \
: virEventCalculateTimeout:332 : Timeout at 0 due in -1 ms 18:43:58.176: 2045: debug \
: virEventRunOnce:583 : Poll on 9 handles 0x7f7890001300 timeout -1 18:43:58.176: \
2045: debug : virEventRunOnce:592 : Poll got 1 event(s) 18:43:58.176: 2045: debug : \
virEventDispatchTimeouts:393 : Dispatch 3 18:43:58.176: 2045: debug : \
virEventDispatchHandles:438 : Dispatch 9 18:43:58.176: 2045: debug : \
virEventDispatchHandles:452 : i=0 w=1 18:43:58.176: 2045: debug : \
virEventDispatchHandles:452 : i=1 w=2 18:43:58.176: 2045: debug : \
virEventDispatchHandles:452 : i=2 w=3 18:43:58.176: 2045: debug : \
virEventDispatchHandles:452 : i=3 w=4 18:43:58.176: 2045: debug : \
virEventDispatchHandles:452 : i=4 w=5 18:43:58.176: 2045: debug : \
virEventDispatchHandles:452 : i=5 w=6 18:43:58.176: 2045: debug : \
virEventDispatchHandles:452 : i=6 w=7 18:43:58.176: 2045: debug : \
virEventDispatchHandles:452 : i=7 w=8 18:43:58.176: 2045: debug : \
virEventDispatchHandles:452 : i=8 w 18:43:58.176: 2045: debug : \
virEventDispatchHandles:465 : Dispatch n=8 f w e=4 0xa8e740 18:43:58.176: 2045: \
debug : virEventUpdateHandleImpl:136 : Update handle w e=1 18:43:58.176: 2045: debug \
: virEventInterruptLocked:657 : Skip interrupt, 1 -1733568752 18:43:58.176: 2045: \
debug : virEventCleanupTimeouts:483 : Cleanup 3 18:43:58.176: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 9 18:43:58.176: 2045: debug : \
virEventCleanupTimeouts:483 : Cleanup 3 18:43:58.176: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 9 18:43:58.176: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1 18:43:58.176: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1 18:43:58.176: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1 18:43:58.176: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1 18:43:58.176: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1 18:43:58.176: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=5 w=6, f e% 18:43:58.176: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=6 w=7, f e% 18:43:58.176: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e% 18:43:58.176: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=8 w, f e=1 18:43:58.176: 2045: debug : \
virEventCalculateTimeout:302 : Calculate expiry of 3 timers 18:43:58.176: 2045: debug \
: virEventCalculateTimeout:332 : Timeout at 0 due in -1 ms 18:43:58.176: 2045: debug \
: virEventRunOnce:583 : Poll on 9 handles 0x7f7890000e00 timeout -1 18:43:58.177: \
2045: debug : virEventRunOnce:592 : Poll got 1 event(s) 18:43:58.177: 2045: debug : \
virEventDispatchTimeouts:393 : Dispatch 3 18:43:58.177: 2045: debug : \
virEventDispatchHandles:438 : Dispatch 9 18:43:58.177: 2045: debug : \
virEventDispatchHandles:452 : i=0 w=1 18:43:58.177: 2045: debug : \
virEventDispatchHandles:452 : i=1 w=2 18:43:58.177: 2045: debug : \
virEventDispatchHandles:452 : i=2 w=3 18:43:58.177: 2045: debug : \
virEventDispatchHandles:452 : i=3 w=4 18:43:58.177: 2045: debug : \
virEventDispatchHandles:452 : i=4 w=5 18:43:58.177: 2045: debug : \
virEventDispatchHandles:452 : i=5 w=6 18:43:58.177: 2045: debug : \
virEventDispatchHandles:452 : i=6 w=7 18:43:58.177: 2045: debug : \
virEventDispatchHandles:452 : i=7 w=8 18:43:58.177: 2045: debug : \
virEventDispatchHandles:452 : i=8 w 18:43:58.177: 2045: debug : \
virEventDispatchHandles:465 : Dispatch n=8 f w e=1 0xa8e740 18:43:58.177: 2045: \
debug : virEventUpdateHandleImpl:136 : Update handle w e=1 18:43:58.177: 2045: debug \
: virEventInterruptLocked:657 : Skip interrupt, 1 -1733568752 18:43:58.177: 2045: \
debug : virEventUpdateHandleImpl:136 : Update handle w e=1 18:43:58.177: 2045: debug \
: virEventInterruptLocked:657 : Skip interrupt, 1 -1733568752 18:43:58.177: 2045: \
debug : virEventCleanupTimeouts:483 : Cleanup 3 18:43:58.177: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 9 18:43:58.177: 2048: debug : \
remoteDispatchClientRequest:377 : progS6903814 ver=1 type=0 status=0 serial=5 proc=2 \
18:43:58.178: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3 18:43:58.178: \
2048: debug : virEventUpdateHandleImpl:136 : Update handle w e=3 18:43:58.178: 2045: \
debug : virEventCleanupHandles:526 : Cleanup 9 18:43:58.178: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1 18:43:58.178: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1 18:43:58.178: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1 18:43:58.178: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1 18:43:58.178: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1 18:43:58.178: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=5 w=6, f e% 18:43:58.178: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=6 w=7, f e% 18:43:58.178: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e% 18:43:58.178: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=8 w, f e=1 18:43:58.178: 2045: debug : \
virEventCalculateTimeout:302 : Calculate expiry of 3 timers 18:43:58.178: 2045: debug \
: virEventCalculateTimeout:332 : Timeout at 0 due in -1 ms 18:43:58.178: 2045: debug \
: virEventRunOnce:583 : Poll on 9 handles 0x7f7890000f30 timeout -1 18:43:58.178: \
2048: debug : virEventInterruptLocked:661 : Interrupting 18:43:58.178: 2045: debug : \
virEventRunOnce:592 : Poll got 1 event(s) 18:43:58.178: 2045: debug : \
virEventDispatchTimeouts:393 : Dispatch 3 18:43:58.178: 2045: debug : \
virEventDispatchHandles:438 : Dispatch 9 18:43:58.178: 2045: debug : \
virEventDispatchHandles:452 : i=0 w=1 18:43:58.178: 2045: debug : \
virEventDispatchHandles:465 : Dispatch n=0 f=3 w=1 e=1 (nil) 18:43:58.178: 2045: \
debug : virEventDispatchHandles:452 : i=1 w=2 18:43:58.178: 2045: debug : \
virEventDispatchHandles:452 : i=2 w=3 18:43:58.178: 2045: debug : \
virEventDispatchHandles:452 : i=3 w=4 18:43:58.178: 2045: debug : \
virEventDispatchHandles:452 : i=4 w=5 18:43:58.178: 2045: debug : \
virEventDispatchHandles:452 : i=5 w=6 18:43:58.178: 2045: debug : \
virEventDispatchHandles:452 : i=6 w=7 18:43:58.178: 2045: debug : \
virEventDispatchHandles:452 : i=7 w=8 18:43:58.178: 2045: debug : \
virEventDispatchHandles:452 : i=8 w 18:43:58.178: 2045: debug : \
virEventCleanupTimeouts:483 : Cleanup 3 18:43:58.178: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 9 18:43:58.178: 2045: debug : \
virEventCleanupTimeouts:483 : Cleanup 3 18:43:58.178: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 9 18:43:58.178: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1 18:43:58.178: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1 18:43:58.178: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1 18:43:58.178: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1 18:43:58.178: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1 18:43:58.178: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=5 w=6, f e% 18:43:58.178: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=6 w=7, f e% 18:43:58.178: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e% 18:43:58.178: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=8 w, f e=5 18:43:58.178: 2045: debug : \
virEventCalculateTimeout:302 : Calculate expiry of 3 timers 18:43:58.178: 2045: debug \
: virEventCalculateTimeout:332 : Timeout at 0 due in -1 ms 18:43:58.178: 2045: debug \
: virEventRunOnce:583 : Poll on 9 handles 0x7f7890081ce0 timeout -1 18:43:58.178: \
2045: debug : virEventRunOnce:592 : Poll got 1 event(s) 18:43:58.178: 2045: debug : \
virEventDispatchTimeouts:393 : Dispatch 3 18:43:58.178: 2045: debug : \
virEventDispatchHandles:438 : Dispatch 9 18:43:58.178: 2045: debug : \
virEventDispatchHandles:452 : i=0 w=1 18:43:58.178: 2045: debug : \
virEventDispatchHandles:452 : i=1 w=2 18:43:58.178: 2045: debug : \
virEventDispatchHandles:452 : i=2 w=3 18:43:58.178: 2045: debug : \
virEventDispatchHandles:452 : i=3 w=4 18:43:58.178: 2045: debug : \
virEventDispatchHandles:452 : i=4 w=5 18:43:58.178: 2045: debug : \
virEventDispatchHandles:452 : i=5 w=6 18:43:58.178: 2045: debug : \
virEventDispatchHandles:452 : i=6 w=7 18:43:58.178: 2045: debug : \
virEventDispatchHandles:452 : i=7 w=8 18:43:58.178: 2045: debug : \
virEventDispatchHandles:452 : i=8 w 18:43:58.178: 2045: debug : \
virEventDispatchHandles:465 : Dispatch n=8 f w e=4 0xa8e740 18:43:58.178: 2045: \
debug : virEventUpdateHandleImpl:136 : Update handle w e=1 18:43:58.178: 2045: debug \
: virEventInterruptLocked:657 : Skip interrupt, 1 -1733568752 18:43:58.178: 2045: \
debug : virEventRemoveHandleImpl:163 : Remove handle w 18:43:58.178: 2045: debug : \
virEventRemoveHandleImpl:176 : mark delete 8 16 18:43:58.178: 2045: debug : \
virEventInterruptLocked:657 : Skip interrupt, 1 -1733568752 18:43:58.178: 2045: debug \
: qemudDispatchClientFailure:1554 : CLIENT_DISCONNECT: fd 18:43:58.178: 2045: debug \
: virEventCleanupTimeouts:483 : Cleanup 3 18:43:58.178: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 9 18:43:58.178: 2045: debug : \
virConnectClose:1314 : conn=0xaa6630 18:43:58.178: 2045: debug : virUnrefConnect:314 \
: unref connection 0xaa6630 1 18:43:58.178: 2045: debug : virReleaseConnect:246 : \
release connection 0xaa6630 18:43:58.178: 2045: debug : virEventCleanupTimeouts:483 : \
Cleanup 3 18:43:58.178: 2045: debug : virEventCleanupHandles:526 : Cleanup 8
18:43:58.178: 2045: debug : virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1
18:43:58.178: 2045: debug : virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1
18:43:58.179: 2045: debug : virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1
18:43:58.179: 2045: debug : virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1
18:43:58.179: 2045: debug : virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1
18:43:58.179: 2045: debug : virEventMakePollFDs:361 : Prepare n=5 w=6, f e%
18:43:58.179: 2045: debug : virEventMakePollFDs:361 : Prepare n=6 w=7, f e%
18:43:58.179: 2045: debug : virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e%
18:43:58.179: 2045: debug : virEventCalculateTimeout:302 : Calculate expiry of 3 \
timers 18:43:58.179: 2045: debug : virEventCalculateTimeout:332 : Timeout at 0 due in \
-1 ms 18:43:58.179: 2045: debug : virEventRunOnce:583 : Poll on 8 handles \
0x7f7890000b90 timeout -1 18:43:58.272: 2045: debug : virEventRunOnce:592 : Poll got \
1 event(s) 18:43:58.273: 2045: debug : virEventDispatchTimeouts:393 : Dispatch 3
18:43:58.273: 2045: debug : virEventDispatchHandles:438 : Dispatch 8
18:43:58.273: 2045: debug : virEventDispatchHandles:452 : i=0 w=1
18:43:58.273: 2045: debug : virEventDispatchHandles:452 : i=1 w=2
18:43:58.273: 2045: debug : virEventDispatchHandles:452 : i=2 w=3
18:43:58.273: 2045: debug : virEventDispatchHandles:452 : i=3 w=4
18:43:58.273: 2045: debug : virEventDispatchHandles:465 : Dispatch n=3 f w=4 e=1 \
(nil) 18:43:58.273: 2045: debug : udevEventHandleCallback:1458 : udev action: \
'remove' 18:43:58.273: 2045: debug : udevRemoveOneDevice:1213 : Failed to find device \
to remove that has udev name '/sys/devices/virtual/net/vnet0/queues/rx-0' \
18:43:58.273: 2045: debug : virEventDispatchHandles:452 : i=4 w=5 18:43:58.273: 2045: \
debug : virEventDispatchHandles:452 : i=5 w=6 18:43:58.273: 2045: debug : \
virEventDispatchHandles:452 : i=6 w=7 18:43:58.273: 2045: debug : \
virEventDispatchHandles:452 : i=7 w=8 18:43:58.273: 2045: debug : \
virEventCleanupTimeouts:483 : Cleanup 3 18:43:58.273: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 8 18:43:58.273: 2045: debug : \
virEventCleanupTimeouts:483 : Cleanup 3 18:43:58.273: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 8 18:43:58.273: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1 18:43:58.273: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1 18:43:58.273: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1 18:43:58.273: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1 18:43:58.273: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1 18:43:58.273: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=5 w=6, f e% 18:43:58.273: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=6 w=7, f e% 18:43:58.273: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e% 18:43:58.273: 2045: debug : \
virEventCalculateTimeout:302 : Calculate expiry of 3 timers 18:43:58.273: 2045: debug \
: virEventCalculateTimeout:332 : Timeout at 0 due in -1 ms 18:43:58.273: 2045: debug \
: virEventRunOnce:583 : Poll on 8 handles 0x7f78900014f0 timeout -1 18:43:58.273: \
2045: debug : virEventRunOnce:592 : Poll got 1 event(s) 18:43:58.273: 2045: debug : \
virEventDispatchTimeouts:393 : Dispatch 3 18:43:58.273: 2045: debug : \
virEventDispatchHandles:438 : Dispatch 8 18:43:58.273: 2045: debug : \
virEventDispatchHandles:452 : i=0 w=1 18:43:58.273: 2045: debug : \
virEventDispatchHandles:452 : i=1 w=2 18:43:58.273: 2045: debug : \
virEventDispatchHandles:452 : i=2 w=3 18:43:58.273: 2045: debug : \
virEventDispatchHandles:452 : i=3 w=4 18:43:58.273: 2045: debug : \
virEventDispatchHandles:465 : Dispatch n=3 f w=4 e=1 (nil) 18:43:58.273: 2045: debug \
: udevEventHandleCallback:1458 : udev action: 'remove' 18:43:58.273: 2045: debug : \
udevRemoveOneDevice:1209 : Removing device 'net_vnet0_fe_54_00_4f_a9_04' with sysfs \
path '/sys/devices/virtual/net/vnet0' 18:43:58.273: 2045: debug : \
virEventDispatchHandles:452 : i=4 w=5 18:43:58.273: 2045: debug : \
virEventDispatchHandles:452 : i=5 w=6 18:43:58.273: 2045: debug : \
virEventDispatchHandles:452 : i=6 w=7 18:43:58.273: 2045: debug : \
virEventDispatchHandles:452 : i=7 w=8 18:43:58.273: 2045: debug : \
virEventCleanupTimeouts:483 : Cleanup 3 18:43:58.273: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 8 18:43:58.273: 2045: debug : \
virEventCleanupTimeouts:483 : Cleanup 3 18:43:58.273: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 8 18:43:58.273: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1 18:43:58.273: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1 18:43:58.273: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1 18:43:58.273: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1 18:43:58.273: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1 18:43:58.273: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=5 w=6, f e% 18:43:58.273: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=6 w=7, f e% 18:43:58.273: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e% 18:43:58.273: 2045: debug : \
virEventCalculateTimeout:302 : Calculate expiry of 3 timers 18:43:58.273: 2045: debug \
: virEventCalculateTimeout:332 : Timeout at 0 due in -1 ms 18:43:58.273: 2045: debug \
: virEventRunOnce:583 : Poll on 8 handles 0xab48e0 timeout -1 18:45:31.710: 2045: \
debug : virEventRunOnce:592 : Poll got 1 event(s) 18:45:31.710: 2045: debug : \
virEventDispatchTimeouts:393 : Dispatch 3 18:45:31.710: 2045: debug : \
virEventDispatchHandles:438 : Dispatch 8 18:45:31.710: 2045: debug : \
virEventDispatchHandles:452 : i=0 w=1 18:45:31.710: 2045: debug : \
virEventDispatchHandles:452 : i=1 w=2 18:45:31.710: 2045: debug : \
virEventDispatchHandles:452 : i=2 w=3 18:45:31.710: 2045: debug : \
virEventDispatchHandles:465 : Dispatch n=2 f w=3 e=1 0xa90c40 18:45:31.710: 2045: \
debug : libvirtd_mdns_watch_dispatch:234 : Dispatch watch 3 FD 12 Event 1 \
18:45:31.710: 2045: debug : libvirtd_mdns_timeout_update:351 : Update timeout \
0xa8d9f0 TV 0x7f789a7beb60 18:45:31.710: 2045: debug : virEventUpdateTimeoutImpl:236 \
: Updating timer 1 timeout with 0 ms freq 18:45:31.710: 2045: debug : \
virEventInterruptLocked:657 : Skip interrupt, 1 -1733568752 18:45:31.710: 2045: debug \
: virEventDispatchHandles:452 : i=3 w=4 18:45:31.710: 2045: debug : \
virEventDispatchHandles:452 : i=4 w=5 18:45:31.710: 2045: debug : \
virEventDispatchHandles:452 : i=5 w=6 18:45:31.710: 2045: debug : \
virEventDispatchHandles:452 : i=6 w=7 18:45:31.710: 2045: debug : \
virEventDispatchHandles:452 : i=7 w=8 18:45:31.710: 2045: debug : \
virEventCleanupTimeouts:483 : Cleanup 3 18:45:31.710: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 8 18:45:31.710: 2045: debug : \
virEventCleanupTimeouts:483 : Cleanup 3 18:45:31.710: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 8 18:45:31.710: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1 18:45:31.710: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1 18:45:31.710: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1 18:45:31.710: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1 18:45:31.710: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1 18:45:31.710: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=5 w=6, f e% 18:45:31.710: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=6 w=7, f e% 18:45:31.710: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e% 18:45:31.710: 2045: debug : \
virEventCalculateTimeout:302 : Calculate expiry of 3 timers 18:45:31.710: 2045: debug \
: virEventCalculateTimeout:308 : Got a timeout scheduled for 1301305531710 \
18:45:31.710: 2045: debug : virEventCalculateTimeout:332 : Timeout at 1301305531710 \
due in 0 ms 18:45:31.710: 2045: debug : virEventRunOnce:583 : Poll on 8 handles \
0xaa5c60 timeout 0 18:45:31.710: 2045: debug : virEventRunOnce:592 : Poll got 0 \
event(s) 18:45:31.710: 2045: debug : virEventDispatchTimeouts:393 : Dispatch 3
18:45:31.710: 2045: debug : libvirtd_mdns_timeout_dispatch:292 : Dispatch timeout \
0xa8d9f0 1 18:45:31.710: 2045: debug : virEventUpdateTimeoutImpl:236 : Updating timer \
1 timeout with -1 ms freq 18:45:31.710: 2045: debug : virEventInterruptLocked:657 : \
Skip interrupt, 1 -1733568752 18:45:31.710: 2045: debug : \
libvirtd_mdns_timeout_update:351 : Update timeout 0xa8d9f0 TV (nil) 18:45:31.710: \
2045: debug : virEventUpdateTimeoutImpl:236 : Updating timer 1 timeout with -1 ms \
freq 18:45:31.710: 2045: debug : virEventInterruptLocked:657 : Skip interrupt, 1 \
-1733568752 18:45:31.710: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:45:31.710: 2045: debug : virEventCleanupHandles:526 : Cleanup 8
18:45:31.710: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:45:31.710: 2045: debug : virEventCleanupHandles:526 : Cleanup 8
18:45:31.710: 2045: debug : virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1
18:45:31.710: 2045: debug : virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1
18:45:31.710: 2045: debug : virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1
18:45:31.710: 2045: debug : virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1
18:45:31.710: 2045: debug : virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1
18:45:31.710: 2045: debug : virEventMakePollFDs:361 : Prepare n=5 w=6, f e%
18:45:31.710: 2045: debug : virEventMakePollFDs:361 : Prepare n=6 w=7, f e%
18:45:31.710: 2045: debug : virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e%
18:45:31.710: 2045: debug : virEventCalculateTimeout:302 : Calculate expiry of 3 \
timers 18:45:31.710: 2045: debug : virEventCalculateTimeout:332 : Timeout at 0 due in \
-1 ms 18:45:31.710: 2045: debug : virEventRunOnce:583 : Poll on 8 handles 0xaa5a00 \
timeout -1 18:45:31.853: 2045: debug : virEventRunOnce:592 : Poll got 1 event(s)
18:45:31.853: 2045: debug : virEventDispatchTimeouts:393 : Dispatch 3
18:45:31.853: 2045: debug : virEventDispatchHandles:438 : Dispatch 8
18:45:31.853: 2045: debug : virEventDispatchHandles:452 : i=0 w=1
18:45:31.853: 2045: debug : virEventDispatchHandles:452 : i=1 w=2
18:45:31.853: 2045: debug : virEventDispatchHandles:452 : i=2 w=3
18:45:31.853: 2045: debug : virEventDispatchHandles:465 : Dispatch n=2 f w=3 e=1 \
0xa90c40 18:45:31.853: 2045: debug : libvirtd_mdns_watch_dispatch:234 : Dispatch \
watch 3 FD 12 Event 1 18:45:31.853: 2045: debug : libvirtd_mdns_timeout_update:351 : \
Update timeout 0xa8d9f0 TV 0x7f789a7beb60 18:45:31.853: 2045: debug : \
virEventUpdateTimeoutImpl:236 : Updating timer 1 timeout with 0 ms freq 18:45:31.853: \
2045: debug : virEventInterruptLocked:657 : Skip interrupt, 1 -1733568752 \
18:45:31.853: 2045: debug : virEventDispatchHandles:452 : i=3 w=4 18:45:31.853: 2045: \
debug : virEventDispatchHandles:452 : i=4 w=5 18:45:31.853: 2045: debug : \
virEventDispatchHandles:452 : i=5 w=6 18:45:31.853: 2045: debug : \
virEventDispatchHandles:452 : i=6 w=7 18:45:31.853: 2045: debug : \
virEventDispatchHandles:452 : i=7 w=8 18:45:31.853: 2045: debug : \
virEventCleanupTimeouts:483 : Cleanup 3 18:45:31.853: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 8 18:45:31.853: 2045: debug : \
virEventCleanupTimeouts:483 : Cleanup 3 18:45:31.853: 2045: debug : \
virEventCleanupHandles:526 : Cleanup 8 18:45:31.853: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1 18:45:31.853: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1 18:45:31.853: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1 18:45:31.853: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1 18:45:31.853: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1 18:45:31.853: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=5 w=6, f e% 18:45:31.853: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=6 w=7, f e% 18:45:31.853: 2045: debug : \
virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e% 18:45:31.853: 2045: debug : \
virEventCalculateTimeout:302 : Calculate expiry of 3 timers 18:45:31.853: 2045: debug \
: virEventCalculateTimeout:308 : Got a timeout scheduled for 1301305531853 \
18:45:31.853: 2045: debug : virEventCalculateTimeout:332 : Timeout at 1301305531853 \
due in 0 ms 18:45:31.853: 2045: debug : virEventRunOnce:583 : Poll on 8 handles \
0xb4e0c0 timeout 0 18:45:31.853: 2045: debug : virEventRunOnce:592 : Poll got 0 \
event(s) 18:45:31.854: 2045: debug : virEventDispatchTimeouts:393 : Dispatch 3
18:45:31.854: 2045: debug : libvirtd_mdns_timeout_dispatch:292 : Dispatch timeout \
0xa8d9f0 1 18:45:31.854: 2045: debug : virEventUpdateTimeoutImpl:236 : Updating timer \
1 timeout with -1 ms freq 18:45:31.854: 2045: debug : virEventInterruptLocked:657 : \
Skip interrupt, 1 -1733568752 18:45:31.854: 2045: debug : \
libvirtd_mdns_timeout_update:351 : Update timeout 0xa8d9f0 TV (nil) 18:45:31.854: \
2045: debug : virEventUpdateTimeoutImpl:236 : Updating timer 1 timeout with -1 ms \
freq 18:45:31.854: 2045: debug : virEventInterruptLocked:657 : Skip interrupt, 1 \
-1733568752 18:45:31.854: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:45:31.854: 2045: debug : virEventCleanupHandles:526 : Cleanup 8
18:45:31.854: 2045: debug : virEventCleanupTimeouts:483 : Cleanup 3
18:45:31.854: 2045: debug : virEventCleanupHandles:526 : Cleanup 8
18:45:31.854: 2045: debug : virEventMakePollFDs:361 : Prepare n=0 w=1, f=3 e=1
18:45:31.854: 2045: debug : virEventMakePollFDs:361 : Prepare n=1 w=2, f=6 e=1
18:45:31.854: 2045: debug : virEventMakePollFDs:361 : Prepare n=2 w=3, f e=1
18:45:31.854: 2045: debug : virEventMakePollFDs:361 : Prepare n=3 w=4, f e=1
18:45:31.854: 2045: debug : virEventMakePollFDs:361 : Prepare n=4 w=5, f e=1
18:45:31.854: 2045: debug : virEventMakePollFDs:361 : Prepare n=5 w=6, f e%
18:45:31.854: 2045: debug : virEventMakePollFDs:361 : Prepare n=6 w=7, f e%
18:45:31.854: 2045: debug : virEventMakePollFDs:361 : Prepare n=7 w=8, f=9 e%
18:45:31.854: 2045: debug : virEventCalculateTimeout:302 : Calculate expiry of 3 \
timers 18:45:31.854: 2045: debug : virEventCalculateTimeout:332 : Timeout at 0 due in \
-1 ms 18:45:31.854: 2045: debug : virEventRunOnce:583 : Poll on 8 handles 0xb4a120 \
timeout -1


["var_log_libvirt_qemu_Centos54-1mg.txt" (text/plain)]

2011-03-28 18:43:57.807: starting up
LC_ALL=C PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin \
QEMU_AUDIO_DRV=none /usr/bin/kvm -S -M pc-0.12 -no-kvm -m 1024 -smp \
1,sockets=1,cores=1,threads=1 -name centos54-1mg -uuid \
2a4a5f8e-06b4-079e-bc62-63295f87d4e5 -nodefconfig -nodefaults -chardev \
socket,id=charmonitor,path=/var/lib/libvirt/qemu/centos54-1mg.monitor,server,nowait \
-mon chardev=charmonitor,id=monitor,mode=readline -rtc base=utc -boot c -drive \
file=/tmp/centos54-1mg.img,if=none,id=drive-ide0-0-0,format=raw -device \
ide-drive,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0 -drive \
if=none,media=cdrom,id=drive-ide0-1-0,readonly=on,format=raw -device \
ide-drive,bus=ide.1,unit=0,drive=drive-ide0-1-0,id=ide0-1-0 -netdev \
tap,fd=19,id=hostnet0 -device \
rtl8139,netdev=hostnet0,id=net0,mac=52:54:00:4f:a9:04,bus=pci.0,addr=0x3 -chardev \
pty,id=charserial0 -device isa-serial,chardev=charserial0,id=serial0 -usb -vnc \
127.0.0.1:0 -vga cirrus -device AC97,id=sound0,bus=pci.0,addr=0x4 -incoming \
tcp:0.0.0.0:49154 -device virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x5 \
18:43:57.808: 2291: info : libvirt version: 0.8.8 18:43:57.808: 2291: debug : \
qemudInitCpuAffinity:1952 : Setting CPU affinity 18:43:57.810: 2291: debug : \
virSecurityDACSetProcessLabel:618 : Dropping privileges of VM to 114:123 char device \
redirected to /dev/pts/3 Receiving block device images
kvm: Error getting length of block device drive-ide0-0-0

qemu: warning: error while loading state section id 1
load of migration failed
2011-03-28 18:43:58.119: shutting down


["etc_init_libvirt.conf" (text/plain)]

# Master libvirt daemon configuration file
#
# For further information consult http://libvirt.org/format.html
#
# NOTE: the tests/daemon-conf regression test script requires
# that each "PARAMETER = VALUE" line in this file have the parameter
# name just after a leading "#".

#################################################################
#
# Network connectivity controls
#

# Flag listening for secure TLS connections on the public TCP/IP port.
# NB, must pass the --listen flag to the libvirtd process for this to
# have any effect.
#
# It is necessary to setup a CA and issue server certificates before
# using this capability.
#
# This is enabled by default, uncomment this to disable it
#listen_tls = 0
listen_tls = 0

# Listen for unencrypted TCP connections on the public TCP/IP port.
# NB, must pass the --listen flag to the libvirtd process for this to
# have any effect.
#
# Using the TCP socket requires SASL authentication by default. Only
# SASL mechanisms which support data encryption are allowed. This is
# DIGEST_MD5 and GSSAPI (Kerberos5)
#
# This is disabled by default, uncomment this to enable it.
#listen_tcp = 1
listen_tcp = 1



# Override the port for accepting secure TLS connections
# This can be a port number, or service name
#
#tls_port = "16514"

# Override the port for accepting insecure TCP connections
# This can be a port number, or service name
#
#tcp_port = "16509"


# Override the default configuration which binds to all network
# interfaces. This can be a numeric IPv4/6 address, or hostname
#
#listen_addr = "192.168.0.1"


# Flag toggling mDNS advertizement of the libvirt service.
#
# Alternatively can disable for all services on a host by
# stopping the Avahi daemon
#
# This is enabled by default, uncomment this to disable it
#mdns_adv = 0

# Override the default mDNS advertizement name. This must be
# unique on the immediate broadcast network.
#
# The default is "Virtualization Host HOSTNAME", where HOSTNAME
# is subsituted for the short hostname of the machine (without domain)
#
#mdns_name = "Virtualization Host Joe Demo"


#################################################################
#
# UNIX socket access controls
#

# Set the UNIX domain socket group ownership. This can be used to
# allow a 'trusted' set of users access to management capabilities
# without becoming root.
#
# This is restricted to 'root' by default.
unix_sock_group = "libvirtd"

# Set the UNIX socket permissions for the R/O socket. This is used
# for monitoring VM status only
#
# Default allows any user. If setting group ownership may want to
# restrict this to:
#unix_sock_ro_perms = "0777"

# Set the UNIX socket permissions for the R/W socket. This is used
# for full management of VMs
#
# Default allows only root. If PolicyKit is enabled on the socket,
# the default will change to allow everyone (eg, 0777)
#
# If not using PolicyKit and setting group ownership for access
# control then you may want to relax this to:
unix_sock_rw_perms = "0770"

# Set the name of the directory in which sockets will be found/created.
#unix_sock_dir = "/var/run/libvirt"

#################################################################
#
# Authentication.
#
#  - none: do not perform auth checks. If you can connect to the
#          socket you are allowed. This is suitable if there are
#          restrictions on connecting to the socket (eg, UNIX
#          socket permissions), or if there is a lower layer in
#          the network providing auth (eg, TLS/x509 certificates)
#
#  - sasl: use SASL infrastructure. The actual auth scheme is then
#          controlled from /etc/sasl2/libvirt.conf. For the TCP
#          socket only GSSAPI &amp; DIGEST-MD5 mechanisms will be used.
#          For non-TCP or TLS sockets,  any scheme is allowed.
#
#  - polkit: use PolicyKit to authenticate. This is only suitable
#            for use on the UNIX sockets. The default policy will
#            require a user to supply their own password to gain
#            full read/write access (aka sudo like), while anyone
#            is allowed read/only access.
#
# Set an authentication scheme for UNIX read-only sockets
# By default socket permissions allow anyone to connect
#
# To restrict monitoring of domains you may wish to enable
# an authentication mechanism here
auth_unix_ro = "none"

# Set an authentication scheme for UNIX read-write sockets
# By default socket permissions only allow root. If PolicyKit
# support was compiled into libvirt, the default will be to
# use 'polkit' auth.
#
# If the unix_sock_rw_perms are changed you may wish to enable
# an authentication mechanism here
auth_unix_rw = "none"

# Change the authentication scheme for TCP sockets.
#
# If you don't enable SASL, then all TCP traffic is cleartext.
# Don't do this outside of a dev/test scenario. For real world
# use, always enable SASL and use the GSSAPI or DIGEST-MD5
# mechanism in /etc/sasl2/libvirt.conf
#auth_tcp = "sasl"
auth_tcp = "none"

# Change the authentication scheme for TLS sockets.
#
# TLS sockets already have encryption provided by the TLS
# layer, and limited authentication is done by certificates
#
# It is possible to make use of any SASL authentication
# mechanism as well, by using 'sasl' for this option
#auth_tls = "none"



#################################################################
#
# TLS x509 certificate configuration
#


# Override the default server key file path
#
#key_file = "/etc/pki/libvirt/private/serverkey.pem"

# Override the default server certificate file path
#
#cert_file = "/etc/pki/libvirt/servercert.pem"

# Override the default CA certificate path
#
#ca_file = "/etc/pki/CA/cacert.pem"

# Specify a certificate revocation list.
#
# Defaults to not using a CRL, uncomment to enable it
#crl_file = "/etc/pki/CA/crl.pem"



#################################################################
#
# Authorization controls
#


# Flag to disable verification of client certificates
#
# Client certificate verification is the primary authentication mechanism.
# Any client which does not present a certificate signed by the CA
# will be rejected.
#
# Default is to always verify. Uncommenting this will disable
# verification - make sure an IP whitelist is set
#tls_no_verify_certificate = 1


# A whitelist of allowed x509  Distinguished Names
# This list may contain wildcards such as
#
#    "C=GB,ST=London,L=London,O=Red Hat,CN=*"
#
# See the POSIX fnmatch function for the format of the wildcards.
#
# NB If this is an empty list, no client can connect, so comment out
# entirely rather than using empty list to disable these checks
#
# By default, no DN's are checked
#tls_allowed_dn_list = ["DN1", "DN2"]


# A whitelist of allowed SASL usernames. The format for usernames
# depends on the SASL authentication mechanism. Kerberos usernames
# look like username@REALM
#
# This list may contain wildcards such as
#
#    "*@EXAMPLE.COM"
#
# See the POSIX fnmatch function for the format of the wildcards.
#
# NB If this is an empty list, no client can connect, so comment out
# entirely rather than using empty list to disable these checks
#
# By default, no Username's are checked
#sasl_allowed_username_list = ["joe@EXAMPLE.COM", "fred@EXAMPLE.COM" ]



#################################################################
#
# Processing controls
#

# The maximum number of concurrent client connections to allow
# over all sockets combined.
#max_clients = 20


# The minimum limit sets the number of workers to start up
# initially. If the number of active clients exceeds this,
# then more threads are spawned, upto max_workers limit.
# Typically you'd want max_workers to equal maximum number
# of clients allowed
#min_workers = 5
#max_workers = 20

# Total global limit on concurrent RPC calls. Should be
# at least as large as max_workers. Beyond this, RPC requests
# will be read into memory and queued. This directly impact
# memory usage, currently each request requires 256 KB of
# memory. So by default upto 5 MB of memory is used
#
# XXX this isn't actually enforced yet, only the per-client
# limit is used so far
#max_requests = 20

# Limit on concurrent requests from a single client
# connection. To avoid one client monopolizing the server
# this should be a small fraction of the global max_requests
# and max_workers parameter
#max_client_requests = 5

#################################################################
#
# Logging controls
#

# Logging level: 4 errors, 3 warnings, 2 informations, 1 debug
# basically 1 will log everything possible
#log_level = 3

# Logging filters:
# A filter allows to select a different logging level for a given category
# of logs
# The format for a filter is:
#    x:name
#      where name is a match string e.g. remote or qemu
# the x prefix is the minimal level where matching messages should be logged
#    1: DEBUG
#    2: INFO
#    3: WARNING
#    4: ERROR
#
# Multiple filter can be defined in a single @filters, they just need to be
# separated by spaces.
#
# e.g:
# log_filters="3:remote 4:event"
# to only get warning or errors from the remote layer and only errors from
# the event layer.

# Logging outputs:
# An output is one of the places to save logging informations
# The format for an output can be:
#    x:stderr
#      output goes to stderr
#    x:syslog:name
#      use syslog for the output and use the given name as the ident
#    x:file:file_path
#      output to a file, with the given filepath
# In all case the x prefix is the minimal level, acting as a filter
#    1: DEBUG
#    2: INFO
#    3: WARNING
#    4: ERROR
#
# Multiple output can be defined, they just need to be separated by spaces.
# e.g.:
# log_outputs="3:syslog:libvirtd"
# to log all warnings and errors to syslog under the libvirtd ident


##################################################################
#
# Auditing
#
# This setting allows usage of the auditing subsystem to be altered:
#
#   audit_level == 0  -&gt; disable all auditing
#   audit_level == 1  -&gt; enable auditing, only if enabled on host (default)
#   audit_level == 2  -&gt; enable auditing, and exit if disabled on host
#
#audit_level = 2
#
# If set to 1, then audit messages will also be sent
# via libvirt logging infrastructure. Defaults to 0
#
#audit_logging = 1
log_level = 1
log_outputs="1:file:/var/log/libvirt/libvirtd.log"


###################################################################
# UUID of the host:
# Provide the UUID of the host here in case the command
# 'dmidecode -s system-uuid' does not provide a valid uuid. In case
# 'dmidecode' does not provide a valid UUID and none is provided here, a
# temporary UUID will be generated.
# Keep the format of the example UUID below. UUID must not have all digits
# be the same.

# NB This default all-zeros UUID will not work. Replace
# it with the output of the 'uuidgen' command and then
# uncomment this entry
#host_uuid = "00000000-0000-0000-0000-000000000000"

["etc_libvirt_qemu.conf" (text/plain)]

# Master configuration file for the QEMU driver.
# All settings described here are optional - if omitted, sensible
# defaults are used.

# VNC is configured to listen on 127.0.0.1 by default.
# To make it listen on all public interfaces, uncomment
# this next option.
#
# NB, strong recommendation to enable TLS + x509 certificate
# verification when allowing public access
#
# vnc_listen = "0.0.0.0"

# Enable this option to have VNC served over an automatically created
# unix socket. This prevents unprivileged access from users on the
# host machine, though most VNC clients do not support it.
#
# This will only be enabled for VNC configurations that do not have
# a hardcoded 'listen' or 'socket' value. This setting takes preference
# over vnc_listen.
#
# vnc_auto_unix_socket = 1

# Enable use of TLS encryption on the VNC server. This requires
# a VNC client which supports the VeNCrypt protocol extension.
# Examples include vinagre, virt-viewer, virt-manager and vencrypt
# itself. UltraVNC, RealVNC, TightVNC do not support this
#
# It is necessary to setup CA and issue a server certificate
# before enabling this.
#
# vnc_tls = 1


# Use of TLS requires that x509 certificates be issued. The
# default it to keep them in /etc/pki/libvirt-vnc. This directory
# must contain
#
#  ca-cert.pem - the CA master certificate
#  server-cert.pem - the server certificate signed with ca-cert.pem
#  server-key.pem  - the server private key
#
# This option allows the certificate directory to be changed
#
# vnc_tls_x509_cert_dir = "/etc/pki/libvirt-vnc"


# The default TLS configuration only uses certificates for the server
# allowing the client to verify the server's identity and establish
# an encrypted channel.
#
# It is possible to use x509 certificates for authentication too, by
# issuing a x509 certificate to every client who needs to connect.
#
# Enabling this option will reject any client who does not have a
# certificate signed by the CA in /etc/pki/libvirt-vnc/ca-cert.pem
#
# vnc_tls_x509_verify = 1


# The default VNC password. Only 8 letters are significant for
# VNC passwords. This parameter is only used if the per-domain
# XML config does not already provide a password. To allow
# access without passwords, leave this commented out. An empty
# string will still enable passwords, but be rejected by QEMU,
# effectively preventing any use of VNC. Obviously change this
# example here before you set this.
#
# vnc_password = "XYZ12345"


# Enable use of SASL encryption on the VNC server. This requires
# a VNC client which supports the SASL protocol extension.
# Examples include vinagre, virt-viewer and virt-manager
# itself. UltraVNC, RealVNC, TightVNC do not support this
#
# It is necessary to configure /etc/sasl2/qemu.conf to choose
# the desired SASL plugin (eg, GSSPI for Kerberos)
#
# vnc_sasl = 1


# The default SASL configuration file is located in /etc/sasl2/
# When running libvirtd unprivileged, it may be desirable to
# override the configs in this location. Set this parameter to
# point to the directory, and create a qemu.conf in that location
#
# vnc_sasl_dir = "/some/directory/sasl2"



# SPICE is configured to listen on 127.0.0.1 by default.
# To make it listen on all public interfaces, uncomment
# this next option.
#
# NB, strong recommendation to enable TLS + x509 certificate
# verification when allowing public access
#
# spice_listen = "0.0.0.0"


# Enable use of TLS encryption on the SPICE server.
#
# It is necessary to setup CA and issue a server certificate
# before enabling this.
#
# spice_tls = 1


# Use of TLS requires that x509 certificates be issued. The
# default it to keep them in /etc/pki/libvirt-spice. This directory
# must contain
#
#  ca-cert.pem - the CA master certificate
#  server-cert.pem - the server certificate signed with ca-cert.pem
#  server-key.pem  - the server private key
#
# This option allows the certificate directory to be changed.
#
# spice_tls_x509_cert_dir = "/etc/pki/libvirt-spice"


# The default SPICE password. This parameter is only used if the
# per-domain XML config does not already provide a password. To
# allow access without passwords, leave this commented out. An
# empty string will still enable passwords, but be rejected by
# QEMU, effectively preventing any use of SPICE. Obviously change
# this example here before you set this.
#
# spice_password = "XYZ12345"


# The default security driver is SELinux. If SELinux is disabled
# on the host, then the security driver will automatically disable
# itself. If you wish to disable QEMU SELinux security driver while
# leaving SELinux enabled for the host in general, then set this
# to 'none' instead.
#
# security_driver = "selinux"


# The user ID for QEMU processes run by the system instance.
#user = "root"

# The group ID for QEMU processes run by the system instance.
#group = "root"

# Whether libvirt should dynamically change file ownership
# to match the configured user/group above. Defaults to 1.
# Set to 0 to disable file ownership changes.
#dynamic_ownership = 1


# What cgroup controllers to make use of with QEMU guests
#
#  - 'cpu' - use for schedular tunables
#  - 'devices' - use for device whitelisting
#  - 'memory' - use for memory tunables
#
# NB, even if configured here, they won't be used unless
# the administrator has mounted cgroups, e.g.:
#
#  mkdir /dev/cgroup
#  mount -t cgroup -o devices,cpu,memory none /dev/cgroup
#
# They can be mounted anywhere, and different controllers
# can be mounted in different locations. libvirt will detect
# where they are located.
#
# cgroup_controllers = [ "cpu", "devices", "memory" ]

# This is the basic set of devices allowed / required by
# all virtual machines.
#
# As well as this, any configured block backed disks,
# all sound device, and all PTY devices are allowed.
#
# This will only need setting if newer QEMU suddenly
# wants some device we don't already know about.
#
#cgroup_device_acl = [
#    "/dev/null", "/dev/full", "/dev/zero",
#    "/dev/random", "/dev/urandom",
#    "/dev/ptmx", "/dev/kvm", "/dev/kqemu",
#    "/dev/rtc", "/dev/hpet", "/dev/net/tun",
#]


# The default format for Qemu/KVM guest save images is raw; that is, the
# memory from the domain is dumped out directly to a file.  If you have
# guests with a large amount of memory, however, this can take up quite
# a bit of space.  If you would like to compress the images while they
# are being saved to disk, you can also set "lzop", "gzip", "bzip2", or "xz"
# for save_image_format.  Note that this means you slow down the process of
# saving a domain in order to save disk space; the list above is in descending
# order by performance and ascending order by compression ratio.
#
# save_image_format is used when you use 'virsh save' at scheduled saving.
# dump_image_format is used when you use 'virsh dump' at emergency crashdump.
#
# save_image_format = "raw"
# dump_image_format = "raw"

# When a domain is configured to be auto-dumped when libvirtd receives a
# watchdog event from qemu guest, libvirtd will save dump files in directory
# specified by auto_dump_path. Default value is /var/lib/libvirt/qemu/dump
#
# auto_dump_path = "/var/lib/libvirt/qemu/dump"

# If provided by the host and a hugetlbfs mount point is configured,
# a guest may request huge page backing.  When this mount point is
# unspecified here, determination of a host mount point in /proc/mounts
# will be attempted.  Specifying an explicit mount overrides detection
# of the same in /proc/mounts.  Setting the mount point to "" will
# disable guest hugepage backing.
#
# NB, within this mount point, guests will create memory backing files
# in a location of  $MOUNTPOINT/libvirt/qemu
#
# hugetlbfs_mount = "/dev/hugepages"


# mac_filter enables MAC addressed based filtering on bridge ports.
# This currently requires ebtables to be installed.
#
# mac_filter = 1


# By default, PCI devices below non-ACS switch are not allowed to be assigned
# to guests. By setting relaxed_acs_check to 1 such devices will be allowed to
# be assigned to guests.
#
# relaxed_acs_check = 1


# QEMU implements an extension for providing audio over a VNC connection,
# though if your VNC client does not support it, your only chance for getting
# sound output is through regular audio backends. By default, libvirt will
# disable all QEMU sound backends if using VNC, since they can cause
# permissions issues. Enabling this option will make libvirtd honor the
# QEMU_AUDIO_DRV environment variable when using VNC.
#
# vnc_allow_host_audio = 0


# If clear_emulator_capabilities is enabled, libvirt will drop all
# privileged capabilities of the QEmu/KVM emulator. This is enabled by
# default.
#
# Warning: Disabling this option means that a compromised guest can
# exploit the privileges and possibly do damage to the host.
#
# clear_emulator_capabilities = 1


# If allow_disk_format_probing is enabled, libvirt will probe disk
# images to attempt to identify their format, when not otherwise
# specified in the XML. This is disabled by default.
#
# WARNING: Enabling probing is a security hole in almost all
# deployments. It is strongly recommended that users update their
# guest XML &lt;disk&gt; elements to include  &lt;driver type='XXXX'/&gt;
# elements instead of enabling this option.
#
# allow_disk_format_probing = 1


# If enabled, libvirt will have QEMU set its process name to
# "qemu:VM_NAME", where VM_NAME is the name of the VM. The QEMU
# process will appear as "qemu:VM_NAME" in process listings and
# other system monitoring tools. By default, QEMU does not set
# its process title, so the complete QEMU command (emulator and
# its arguments) appear in process listings.
#
# set_process_name = 1

["etc_libvirt_libvirtd.conf" (text/plain)]

# Master libvirt daemon configuration file
#
# For further information consult http://libvirt.org/format.html
#
# NOTE: the tests/daemon-conf regression test script requires
# that each "PARAMETER = VALUE" line in this file have the parameter
# name just after a leading "#".

#################################################################
#
# Network connectivity controls
#

# Flag listening for secure TLS connections on the public TCP/IP port.
# NB, must pass the --listen flag to the libvirtd process for this to
# have any effect.
#
# It is necessary to setup a CA and issue server certificates before
# using this capability.
#
# This is enabled by default, uncomment this to disable it
#listen_tls = 0
listen_tls = 0

# Listen for unencrypted TCP connections on the public TCP/IP port.
# NB, must pass the --listen flag to the libvirtd process for this to
# have any effect.
#
# Using the TCP socket requires SASL authentication by default. Only
# SASL mechanisms which support data encryption are allowed. This is
# DIGEST_MD5 and GSSAPI (Kerberos5)
#
# This is disabled by default, uncomment this to enable it.
#listen_tcp = 1
listen_tcp = 1



# Override the port for accepting secure TLS connections
# This can be a port number, or service name
#
#tls_port = "16514"

# Override the port for accepting insecure TCP connections
# This can be a port number, or service name
#
#tcp_port = "16509"


# Override the default configuration which binds to all network
# interfaces. This can be a numeric IPv4/6 address, or hostname
#
#listen_addr = "192.168.0.1"


# Flag toggling mDNS advertizement of the libvirt service.
#
# Alternatively can disable for all services on a host by
# stopping the Avahi daemon
#
# This is enabled by default, uncomment this to disable it
#mdns_adv = 0

# Override the default mDNS advertizement name. This must be
# unique on the immediate broadcast network.
#
# The default is "Virtualization Host HOSTNAME", where HOSTNAME
# is subsituted for the short hostname of the machine (without domain)
#
#mdns_name = "Virtualization Host Joe Demo"


#################################################################
#
# UNIX socket access controls
#

# Set the UNIX domain socket group ownership. This can be used to
# allow a 'trusted' set of users access to management capabilities
# without becoming root.
#
# This is restricted to 'root' by default.
unix_sock_group = "libvirtd"

# Set the UNIX socket permissions for the R/O socket. This is used
# for monitoring VM status only
#
# Default allows any user. If setting group ownership may want to
# restrict this to:
#unix_sock_ro_perms = "0777"

# Set the UNIX socket permissions for the R/W socket. This is used
# for full management of VMs
#
# Default allows only root. If PolicyKit is enabled on the socket,
# the default will change to allow everyone (eg, 0777)
#
# If not using PolicyKit and setting group ownership for access
# control then you may want to relax this to:
unix_sock_rw_perms = "0770"

# Set the name of the directory in which sockets will be found/created.
#unix_sock_dir = "/var/run/libvirt"

#################################################################
#
# Authentication.
#
#  - none: do not perform auth checks. If you can connect to the
#          socket you are allowed. This is suitable if there are
#          restrictions on connecting to the socket (eg, UNIX
#          socket permissions), or if there is a lower layer in
#          the network providing auth (eg, TLS/x509 certificates)
#
#  - sasl: use SASL infrastructure. The actual auth scheme is then
#          controlled from /etc/sasl2/libvirt.conf. For the TCP
#          socket only GSSAPI &amp; DIGEST-MD5 mechanisms will be used.
#          For non-TCP or TLS sockets,  any scheme is allowed.
#
#  - polkit: use PolicyKit to authenticate. This is only suitable
#            for use on the UNIX sockets. The default policy will
#            require a user to supply their own password to gain
#            full read/write access (aka sudo like), while anyone
#            is allowed read/only access.
#
# Set an authentication scheme for UNIX read-only sockets
# By default socket permissions allow anyone to connect
#
# To restrict monitoring of domains you may wish to enable
# an authentication mechanism here
auth_unix_ro = "none"

# Set an authentication scheme for UNIX read-write sockets
# By default socket permissions only allow root. If PolicyKit
# support was compiled into libvirt, the default will be to
# use 'polkit' auth.
#
# If the unix_sock_rw_perms are changed you may wish to enable
# an authentication mechanism here
auth_unix_rw = "none"

# Change the authentication scheme for TCP sockets.
#
# If you don't enable SASL, then all TCP traffic is cleartext.
# Don't do this outside of a dev/test scenario. For real world
# use, always enable SASL and use the GSSAPI or DIGEST-MD5
# mechanism in /etc/sasl2/libvirt.conf
#auth_tcp = "sasl"
auth_tcp = "none"

# Change the authentication scheme for TLS sockets.
#
# TLS sockets already have encryption provided by the TLS
# layer, and limited authentication is done by certificates
#
# It is possible to make use of any SASL authentication
# mechanism as well, by using 'sasl' for this option
#auth_tls = "none"



#################################################################
#
# TLS x509 certificate configuration
#


# Override the default server key file path
#
#key_file = "/etc/pki/libvirt/private/serverkey.pem"

# Override the default server certificate file path
#
#cert_file = "/etc/pki/libvirt/servercert.pem"

# Override the default CA certificate path
#
#ca_file = "/etc/pki/CA/cacert.pem"

# Specify a certificate revocation list.
#
# Defaults to not using a CRL, uncomment to enable it
#crl_file = "/etc/pki/CA/crl.pem"



#################################################################
#
# Authorization controls
#


# Flag to disable verification of client certificates
#
# Client certificate verification is the primary authentication mechanism.
# Any client which does not present a certificate signed by the CA
# will be rejected.
#
# Default is to always verify. Uncommenting this will disable
# verification - make sure an IP whitelist is set
#tls_no_verify_certificate = 1


# A whitelist of allowed x509  Distinguished Names
# This list may contain wildcards such as
#
#    "C=GB,ST=London,L=London,O=Red Hat,CN=*"
#
# See the POSIX fnmatch function for the format of the wildcards.
#
# NB If this is an empty list, no client can connect, so comment out
# entirely rather than using empty list to disable these checks
#
# By default, no DN's are checked
#tls_allowed_dn_list = ["DN1", "DN2"]


# A whitelist of allowed SASL usernames. The format for usernames
# depends on the SASL authentication mechanism. Kerberos usernames
# look like username@REALM
#
# This list may contain wildcards such as
#
#    "*@EXAMPLE.COM"
#
# See the POSIX fnmatch function for the format of the wildcards.
#
# NB If this is an empty list, no client can connect, so comment out
# entirely rather than using empty list to disable these checks
#
# By default, no Username's are checked
#sasl_allowed_username_list = ["joe@EXAMPLE.COM", "fred@EXAMPLE.COM" ]



#################################################################
#
# Processing controls
#

# The maximum number of concurrent client connections to allow
# over all sockets combined.
#max_clients = 20


# The minimum limit sets the number of workers to start up
# initially. If the number of active clients exceeds this,
# then more threads are spawned, upto max_workers limit.
# Typically you'd want max_workers to equal maximum number
# of clients allowed
#min_workers = 5
#max_workers = 20

# Total global limit on concurrent RPC calls. Should be
# at least as large as max_workers. Beyond this, RPC requests
# will be read into memory and queued. This directly impact
# memory usage, currently each request requires 256 KB of
# memory. So by default upto 5 MB of memory is used
#
# XXX this isn't actually enforced yet, only the per-client
# limit is used so far
#max_requests = 20

# Limit on concurrent requests from a single client
# connection. To avoid one client monopolizing the server
# this should be a small fraction of the global max_requests
# and max_workers parameter
#max_client_requests = 5

#################################################################
#
# Logging controls
#

# Logging level: 4 errors, 3 warnings, 2 informations, 1 debug
# basically 1 will log everything possible
#log_level = 3

# Logging filters:
# A filter allows to select a different logging level for a given category
# of logs
# The format for a filter is:
#    x:name
#      where name is a match string e.g. remote or qemu
# the x prefix is the minimal level where matching messages should be logged
#    1: DEBUG
#    2: INFO
#    3: WARNING
#    4: ERROR
#
# Multiple filter can be defined in a single @filters, they just need to be
# separated by spaces.
#
# e.g:
# log_filters="3:remote 4:event"
# to only get warning or errors from the remote layer and only errors from
# the event layer.

# Logging outputs:
# An output is one of the places to save logging informations
# The format for an output can be:
#    x:stderr
#      output goes to stderr
#    x:syslog:name
#      use syslog for the output and use the given name as the ident
#    x:file:file_path
#      output to a file, with the given filepath
# In all case the x prefix is the minimal level, acting as a filter
#    1: DEBUG
#    2: INFO
#    3: WARNING
#    4: ERROR
#
# Multiple output can be defined, they just need to be separated by spaces.
# e.g.:
# log_outputs="3:syslog:libvirtd"
# to log all warnings and errors to syslog under the libvirtd ident


##################################################################
#
# Auditing
#
# This setting allows usage of the auditing subsystem to be altered:
#
#   audit_level == 0  -&gt; disable all auditing
#   audit_level == 1  -&gt; enable auditing, only if enabled on host (default)
#   audit_level == 2  -&gt; enable auditing, and exit if disabled on host
#
#audit_level = 2
#
# If set to 1, then audit messages will also be sent
# via libvirt logging infrastructure. Defaults to 0
#
#audit_logging = 1
log_level = 1
log_outputs="1:file:/var/log/libvirt/libvirtd.log"


###################################################################
# UUID of the host:
# Provide the UUID of the host here in case the command
# 'dmidecode -s system-uuid' does not provide a valid uuid. In case
# 'dmidecode' does not provide a valid UUID and none is provided here, a
# temporary UUID will be generated.
# Keep the format of the example UUID below. UUID must not have all digits
# be the same.

# NB This default all-zeros UUID will not work. Replace
# it with the output of the 'uuidgen' command and then
# uncomment this entry
#host_uuid = "00000000-0000-0000-0000-000000000000"


</body></email><email><emailId>20110331104708</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-03-31 10:47:08-0400</timestampReceived><subject>Re: [libvirt-users] How to disconnect the ISO image using virsh</subject><body>

On Thu, Mar 31, 2011 at 05:46:47PM +0800, Osier Yang wrote:
&gt; 于 2011年03月31日 15:17, Masanari Iida 写道:
&gt; &gt;Somebody sent me a tips.
&gt; &gt;Following command do what I wanted to do.
&gt; &gt;Thanks.
&gt; &gt;
&gt; &gt;attach-disk guest01 " " hdc --driver file --type cdrom
&gt; &gt;--mode readonly
&gt; 
&gt; Also using "update-device" with an xml which doesn't specify
&gt; the source file path will work.

BTW, if someone is looking for a short coding idea, it would
be great if we finally added support for two commands specifically
targetting devices with removable media:

  'eject-disk'   (ejects current media)
  'insert-disk'  (replaces current media (if any) with new media)


Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110331151454</emailId><senderName>James Barkley</senderName><senderEmail>james.barkley@gmail.com</senderEmail><timestampReceived>2011-03-31 15:14:54-0400</timestampReceived><subject>Re: [libvirt-users] ESX networking functions</subject><body>

I would probably start with the basic "net-list" type of functionality
contained in libvirt. I understand what you mean about the mappings - would
the place to start be by mapping the relevant SOAP API model into the
esx_vi_generator.input file? Should this conversation be moved to the
libvirt-dev-list?

-jb

On Thu, Mar 31, 2011 at 7:28 AM, Matthias Bolte &lt;
matthias.bolte@googlemail.com&gt; wrote:

&gt; 2011/3/31 James Barkley &lt;james.barkley@gmail.com&gt;:
&gt; &gt; Greeetings,
&gt; &gt; Using the latest git snapshot I noticed that none of the networking
&gt; &gt; functions are implemented in the ESX driver. No listing networks, no
&gt; adding
&gt; &gt; networks, etc. This functionality seems to be fully implemented for most
&gt; of
&gt; &gt; the other drivers and I don't see it on the "todo" wiki. Does anyone have
&gt; an
&gt; &gt; idea if/when this might get implemented? Would others be interested if I
&gt; &gt; were to add it and submit it as a patch?
&gt; &gt; -jb
&gt;
&gt; The networking functions aren't implemented yet, because the ESX and
&gt; the libvirt network model don't map directly. I didn't have time to
&gt; figure this out in all the necessary details yet. I'll have only
&gt; limited time to spent on libvirt and ESX development in the next
&gt; months, so I cannot give an ETA for any new features in the driver.
&gt;
&gt; Regarding the implementation, once we have a sound mapping the
&gt; implementation should be the easy part.
&gt;
&gt; If you want to work on that area I suggest you start by getting
&gt; familiar with the libvirt and the ESX networking model and then define
&gt; a suitable mapping between them. This might require extensions to the
&gt; libvirt network model to handle the vSwitch concept of ESX.
&gt;
&gt; There might also be a legacy problem to solve. Currently the ESX port
&gt; groups are used a bridges in the libvirt domain XML config. Actually
&gt; they should be used as virtual networks. This is a shortcoming in my
&gt; original design of the ESX driver.
&gt;
&gt; IIRC, Daniel P. Berrange mentioned a while ago that he is planning to
&gt; add such a virtual switch concept to libvirt. There is also vSwitch
&gt; item on the todo page.
&gt;
&gt; Matthias
&gt;

[Attachment #3 (text/html)]

I would probably start with the basic "net-list" type of functionality \
contained in libvirt. I understand what you mean about the mappings - would the place \
to start be by mapping the relevant SOAP API model into the esx_vi_generator.input \
file? Should this conversation be moved to the libvirt-dev-list?&lt;div&gt; \
&lt;br&gt;&lt;/div&gt;&lt;div&gt;-jb&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Thu, Mar 31, 2011 at 7:28 AM, \
Matthias Bolte &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt; &lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt;2011/3/31 James Barkley &lt;&lt;a \
href="mailto:james.barkley@gmail.com"&gt;james.barkley@gmail.com&lt;/a&gt;&gt;:&lt;br&gt; \
&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;&gt; Greeetings,&lt;br&gt; &gt; Using the latest git \
snapshot I noticed that none of the networking&lt;br&gt; &gt; functions are implemented in \
the ESX driver. No listing networks, no adding&lt;br&gt; &gt; networks, etc. This \
functionality seems to be fully implemented for most of&lt;br&gt; &gt; the other drivers \
and I don't see it on the "todo" wiki. Does anyone have an&lt;br&gt; &gt; \
idea if/when this might get implemented? Would others be interested if I&lt;br&gt; &gt; \
were to add it and submit it as a patch?&lt;br&gt; &gt; -jb&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;The networking functions aren't implemented yet, because the ESX \
and&lt;br&gt; the libvirt network model don't map directly. I didn't have time \
to&lt;br&gt; figure this out in all the necessary details yet. I'll have only&lt;br&gt;
limited time to spent on libvirt and ESX development in the next&lt;br&gt;
months, so I cannot give an ETA for any new features in the driver.&lt;br&gt;
&lt;br&gt;
Regarding the implementation, once we have a sound mapping the&lt;br&gt;
implementation should be the easy part.&lt;br&gt;
&lt;br&gt;
If you want to work on that area I suggest you start by getting&lt;br&gt;
familiar with the libvirt and the ESX networking model and then define&lt;br&gt;
a suitable mapping between them. This might require extensions to the&lt;br&gt;
libvirt network model to handle the vSwitch concept of ESX.&lt;br&gt;
&lt;br&gt;
There might also be a legacy problem to solve. Currently the ESX port&lt;br&gt;
groups are used a bridges in the libvirt domain XML config. Actually&lt;br&gt;
they should be used as virtual networks. This is a shortcoming in my&lt;br&gt;
original design of the ESX driver.&lt;br&gt;
&lt;br&gt;
IIRC, Daniel P. Berrange mentioned a while ago that he is planning to&lt;br&gt;
add such a virtual switch concept to libvirt. There is also vSwitch&lt;br&gt;
item on the todo page.&lt;br&gt;
&lt;font color="#888888"&gt;&lt;br&gt;
Matthias&lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20110331182547</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2011-03-31 18:25:47-0400</timestampReceived><subject>[libvirt-users] ANNOUNCE: oz 0.3.0 release</subject><body>

All,
     I'm pleased to announce release 0.3.0 of Oz.  Oz is a program for doing
automated installation of guest operating systems with limited input from the
user.
     Release 0.3.0 is mostly a bugfix release for Oz.  However, there are also
a few minor features included as well.  Some of the highlights between Oz 0.2.0
and 0.3.0 are:

- Add the ability to specify the output directory for screenshots (the default
is still CWD).
- Add the ability to specify the bridge to use for installs (the default is
still the first libvirt NAT bridge on the system).
- Nicer error messages from the command-line tools when debugging is off.
- Add the ability to install Debian 5 and 6.
- Detect servers that can't possibly work for installing RedHat/Fedora OSs,
and fail the install.
- Allow installs with spaces in the name.
- Add the ability to install OpenSUSE 11.4.

More documentation on Oz is available here: http://aeolusproject.org/oz.html

If you have any questions or comments about oz, please feel free to contact
aeolus-devel@fedorahosted.org or me (clalance@redhat.com) directly.

Thanks,
--
Chris Lalancette

</body></email><email><emailId>20110331202912</emailId><senderName></senderName><senderEmail>robert.smol@stereoit.com</senderEmail><timestampReceived>2011-03-31 20:29:12-0400</timestampReceived><subject>[libvirt-users] bridge and route without IP</subject><body>

Hi,
I want to forward all traffic received on eth1 into virtual domain 
'firewall' (where I want to configure public IP+shorewall)

I've created following network:

node002 qemu # cat networks/int-001.xml
&lt;network&gt;
&lt;name&gt;int-001&lt;/name&gt;
&lt;bridge name="intbr0" /&gt;
&lt;forward mode="route" device="eth1"/&gt;
&lt;/network&gt;

virsh # net-create networks/int-001.xml
error: Failed to create network from networks/int-001.xml
error: internal error Forwarding requested, but no IP address provided

But wan to set the public IP on the Firewall side. How do I do that? 
Would the macvtap help me?

Regards,

Robert

-- 
stereoIT - Open Source Technology Partners
http://www.stereoit.com
mobile: +420 776 762378


[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta content="text/html; charset=windows-1252"
      http-equiv="Content-Type"&gt;
  &lt;/head&gt;
  &lt;body bgcolor="#ffffff" text="#000000"&gt;
    &lt;font size="-1"&gt;&lt;font face="Helvetica, Arial, sans-serif"&gt;Hi,&lt;br&gt;
        I want to forward all traffic received on eth1 into virtual
        domain 'firewall' (where I want to configure public
        IP+shorewall)&lt;br&gt;
        &lt;br&gt;
        I've created following network:&lt;br&gt;
        &lt;br&gt;
        node002 qemu # cat networks/int-001.xml&lt;br&gt;
        &lt;network&gt;&lt;br&gt;
          &lt;name&gt;int-001&lt;/name&gt;&lt;br&gt;
          &lt;bridge name="intbr0" /&gt;&lt;br&gt;
          &lt;forward mode="route" device="eth1"/&gt;&lt;br&gt;
        &lt;/network&gt;&lt;br&gt;
        &lt;br&gt;
        virsh # net-create networks/int-001.xml &lt;br&gt;
        error: Failed to create network from networks/int-001.xml&lt;br&gt;
        error: internal error Forwarding requested, but no IP address
        provided&lt;br&gt;
        &lt;br&gt;
        But wan to set the public IP on the Firewall side. How do I do
        that? Would the macvtap help me?&lt;br&gt;
        &lt;br&gt;
        Regards,&lt;br&gt;
        &lt;br&gt;
        Robert&lt;br&gt;
      &lt;/font&gt;&lt;/font&gt;
    &lt;pre class="moz-signature" cols="72"&gt;-- 
stereoIT - Open Source Technology Partners
&lt;a class="moz-txt-link-freetext" href="http://www.stereoit.com"&gt;http://www.stereoit.com&lt;/a&gt;
mobile: +420 776 762378&lt;/pre&gt;
  &lt;/body&gt;
&lt;/html&gt;


</body></email><email><emailId>20110204092935</emailId><senderName>Dale Amon</senderName><senderEmail>amon@vnl.com</senderEmail><timestampReceived>2011-02-04 09:29:35-0400</timestampReceived><subject>[libvirt-users] Disk atomicity...</subject><body>

I suspect the answer is no, as the very idea makes
my head hurt, but a confirmation would be nice:

Am I correct in assuming that it is a very bad idea
to mount a physical disk on both the physical machine
and on a hosted VM at the same time? 

I can imagine getting away with it if one were RO, but
not otherwise.

Any takers?

</body></email><email><emailId>20110208043307</emailId><senderName>arpita k</senderName><senderEmail>arpitak29@gmail.com</senderEmail><timestampReceived>2011-02-08 04:33:07-0400</timestampReceived><subject>[libvirt-users] Libvirt in Windows not working</subject><body>

Hi,

This is Arpita.

I am using Libvirt API in the Windows Vista system.VMware is installed over
there.I have installed Libvirt and Python 2.6 in the Windows Vista system
andhave written a small test file in Python.

Here is the code:

import libvirt*
*

import sys

conn = libvirt.openReadOnly(None)

if conn == None:

print *'Failed to open connection to the hypervisor'
*

sys.exit(1)

try:

dom0 = conn.lookupByName(*"vmware1"*)

except:

print *'Failed to find the main domain'
*

sys.exit(1)

print *"Domain 0: id %d running %s"* % (dom0.ID(), dom0.OSType())

print dom0.info()

When I am trying to execute this python code I received error message that :

ImportError: No module named libvirt



Please help me.



Regards,

Arpita

[Attachment #3 (text/html)]

&lt;div&gt;Hi,&lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt;This is Arpita.&lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt;I am using Libvirt API in the Windows Vista system.VMware is installed over \
there.I have installed Libvirt and Python 2.6 in the Windows Vista system andhave \
written a small test file in Python.&lt;/div&gt; &lt;div&gt; &lt;/div&gt;
&lt;div&gt;Here is the code:&lt;/div&gt;
&lt;div&gt;&lt;font color="#0000ff" size="2"&gt;&lt;font color="#0000ff" size="2"&gt;&lt;/font&gt;&lt;/font&gt; \
&lt;/div&gt; &lt;div&gt;&lt;font color="#0000ff" size="2"&gt;&lt;font color="#0000ff" \
size="2"&gt;import&lt;/font&gt;&lt;/font&gt;&lt;font size="2"&gt; libvirt&lt;u&gt;&lt;/u&gt;&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font \
color="#0000ff" size="2"&gt;&lt;font color="#0000ff" size="2"&gt; &lt;p \
align="left"&gt;import&lt;/p&gt;&lt;/font&gt;&lt;/font&gt;&lt;font size="2"&gt; sys &lt;p align="left"&gt;&lt;/p&gt;
&lt;p align="left"&gt;conn = libvirt.openReadOnly(&lt;/p&gt;&lt;/font&gt;&lt;font color="#0000ff" \
size="2"&gt;&lt;font color="#0000ff" size="2"&gt;None&lt;/font&gt;&lt;/font&gt;&lt;font \
size="2"&gt;)&lt;/font&gt;&lt;font color="#0000ff" size="2"&gt;&lt;font color="#0000ff" size="2"&gt; &lt;p \
align="left"&gt;if&lt;/p&gt;&lt;/font&gt;&lt;/font&gt;&lt;font size="2"&gt; conn == &lt;/font&gt;&lt;font color="#0000ff" \
size="2"&gt;&lt;font color="#0000ff" size="2"&gt;None&lt;/font&gt;&lt;/font&gt;&lt;font size="2"&gt;: &lt;p \
align="left"&gt;&lt;/p&gt;&lt;/font&gt;&lt;font color="#0000ff" size="2"&gt;&lt;font color="#0000ff" \
size="2"&gt;print&lt;/font&gt;&lt;/font&gt;&lt;font size="2"&gt; &lt;/font&gt;&lt;i&gt;&lt;font color="#00aa00" \
size="2"&gt;&lt;font color="#00aa00" size="2"&gt;'Failed to open connection to the \
&lt;u&gt;hypervisor&lt;/u&gt;'&lt;/font&gt;&lt;/font&gt;&lt;/i&gt;&lt;font size="2"&gt; &lt;p \
align="left"&gt;sys.exit(&lt;/p&gt;&lt;/font&gt;&lt;font color="#800000" size="2"&gt;&lt;font color="#800000" \
size="2"&gt;1&lt;/font&gt;&lt;/font&gt;&lt;font size="2"&gt;) &lt;p align="left"&gt;&lt;/p&gt;&lt;/font&gt;&lt;font \
color="#0000ff" size="2"&gt;&lt;font color="#0000ff" size="2"&gt; &lt;p \
align="left"&gt;try&lt;/p&gt;&lt;/font&gt;&lt;/font&gt;&lt;font size="2"&gt;: &lt;p align="left"&gt;dom0 = \
conn.lookupByName(&lt;/p&gt;&lt;/font&gt;&lt;i&gt;&lt;font color="#00aa00" size="2"&gt;&lt;font color="#00aa00" \
size="2"&gt;"vmware1"&lt;/font&gt;&lt;/font&gt;&lt;/i&gt;&lt;font size="2"&gt;)&lt;/font&gt;&lt;font \
color="#0000ff" size="2"&gt;&lt;font color="#0000ff" size="2"&gt; &lt;p \
align="left"&gt;except&lt;/p&gt;&lt;/font&gt;&lt;/font&gt;&lt;font size="2"&gt;: &lt;p \
align="left"&gt;&lt;/p&gt;&lt;/font&gt;&lt;font color="#0000ff" size="2"&gt;&lt;font color="#0000ff" \
size="2"&gt;print&lt;/font&gt;&lt;/font&gt;&lt;font size="2"&gt; &lt;/font&gt;&lt;i&gt;&lt;font color="#00aa00" \
size="2"&gt;&lt;font color="#00aa00" size="2"&gt;'Failed to find the main \
domain'&lt;/font&gt;&lt;/font&gt;&lt;/i&gt;&lt;font size="2"&gt; &lt;p \
align="left"&gt;sys.exit(&lt;/p&gt;&lt;/font&gt;&lt;font color="#800000" size="2"&gt;&lt;font color="#800000" \
size="2"&gt;1&lt;/font&gt;&lt;/font&gt;&lt;font size="2"&gt;) &lt;p align="left"&gt;&lt;/p&gt;&lt;/font&gt;&lt;font \
color="#0000ff" size="2"&gt;&lt;font color="#0000ff" size="2"&gt; &lt;p \
align="left"&gt;print&lt;/p&gt;&lt;/font&gt;&lt;/font&gt;&lt;font size="2"&gt; &lt;/font&gt;&lt;i&gt;&lt;font color="#00aa00" \
size="2"&gt;&lt;font color="#00aa00" size="2"&gt;"Domain 0: id %d running \
%s"&lt;/font&gt;&lt;/font&gt;&lt;/i&gt;&lt;font size="2"&gt; % (dom0.ID(), dom0.OSType())&lt;/font&gt;&lt;font \
color="#0000ff" size="2"&gt;&lt;font color="#0000ff" size="2"&gt; \
&lt;p&gt;print&lt;/p&gt;&lt;/font&gt;&lt;/font&gt;&lt;font size="2"&gt; &lt;a \
href="http://dom0.info"&gt;dom0.info&lt;/a&gt;()&lt;/font&gt;&lt;/div&gt; &lt;div&gt; &lt;/div&gt;
&lt;div&gt;When I am trying to execute this python code I received error message that \
:&lt;font color="#ff0000" size="2"&gt;&lt;font color="#ff0000" size="2"&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt; \
&lt;p&gt;ImportError: No module named libvirt&lt;/p&gt; &lt;p&gt; &lt;/p&gt;
&lt;p&gt;&lt;font color="#000000"&gt;Please help me.&lt;/font&gt;&lt;/p&gt;
&lt;p&gt;&lt;font color="#000000"&gt;&lt;/font&gt; &lt;/p&gt;
&lt;p&gt;&lt;font color="#000000"&gt;Regards,&lt;/font&gt;&lt;/p&gt;
&lt;p&gt;&lt;font color="#000000"&gt;Arpita&lt;/font&gt;&lt;/p&gt;



</body></email><email><emailId>20110204050407</emailId><senderName>Nandini Chandra</senderName><senderEmail>nachandr@redhat.com</senderEmail><timestampReceived>2011-02-04 05:04:07-0400</timestampReceived><subject>[libvirt-users] Making multiple connections from an application using libvirt-0.6.3-20.1.el5_4</subject><body>

I came across a thread in the archives that seems to suggest that 
multiple connections can be made from a single application,although I am 
unsure what version(s) of libvirt support it.
https://www.redhat.com/archives/libvirt-users/2010-March/msg00074.html

I'd like to know if multiple connections(for eg,virConnectOpenAuth()) 
can be made from an application using libvirt-0.6.3-20.1.el5_4 .

Thanks


</body></email><email><emailId>20110209113007</emailId><senderName>arpita k</senderName><senderEmail>arpitak29@gmail.com</senderEmail><timestampReceived>2011-02-09 11:30:07-0400</timestampReceived><subject>[libvirt-users] How to use Python Binding with Lbivirt.</subject><body>

HI,

I am using ubuntu host machine and KVM is present as guest in that
machine.Two virtual machines are there.I am using Python binding to query on
the hypervisor and extract the VM related information.

Here is my  simple code:


#!/*usr*/local/bin/*python
*

import libvirt

import sys

conn = libvirt.openReadOnly(None)

if conn == None:

print *'Failed to open connection to the hypervisor'
*

sys.exit(1)

try:

domIds = conn.listDomainsID()

for id in domIds:

dom0 = conn.lookupByID(id)

dom0.info()

print *"Domain 0: id %d running %s"* % (dom0.ID(), dom0.OSType())

print dom0.info()

except:

print *'Failed to find the main domain'
*

sys.exit()
The output is :

Domain 0: id 2 running hvm
[1, 131072L, 131072L, 1, 14921710000000L]
Domain 0: id 3 running hvm
[1, 131072L, 131072L, 1, 30880000000L]

Here I am not able to understand these values are represent what type of
information, which value is representing what resource of host machine.Could
you please help me to understand how I could find out CPU,VM ,memory related
information seperately through python binding?.
I didn't find Python binding Reference in the Libvirt site.Could you help me
by providing the Reference link for Python binding?

Thanks in Advance!!

Arpita

[Attachment #3 (text/html)]

&lt;div&gt; &lt;/div&gt;
&lt;div&gt;HI,&lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt;I am using &lt;span class="J-JK9eJ-PJVNOc" style="BACKGROUND: yellow"&gt;ubuntu&lt;/span&gt; \
host machine and &lt;span class="J-JK9eJ-PJVNOc" style="BACKGROUND: yellow"&gt;KVM&lt;/span&gt; \
is present as guest in that machine.Two virtual machines are there.I am using Python \
binding to query on the &lt;span class="J-JK9eJ-PJVNOc" style="BACKGROUND: \
yellow"&gt;hypervisor&lt;/span&gt; and extract the &lt;span class="J-JK9eJ-PJVNOc" \
style="BACKGROUND: yellow"&gt;VM&lt;/span&gt; related information.&lt;/div&gt;

&lt;div&gt; &lt;/div&gt;
&lt;div&gt;Here is my  simple code: &lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt;&lt;font color="#c0c0c0" size="2"&gt;&lt;font color="#c0c0c0" size="2"&gt;
&lt;p align="left"&gt;#!/&lt;u&gt;&lt;span class="J-JK9eJ-PJVNOc" style="BACKGROUND: \
yellow"&gt;usr&lt;/span&gt;&lt;/u&gt;/local/bin/&lt;u&gt;python&lt;/u&gt;&lt;/p&gt;&lt;/font&gt;&lt;/font&gt;&lt;font color="#0000ff" \
size="2"&gt;&lt;font color="#0000ff" size="2"&gt; &lt;p \
align="left"&gt;import&lt;/p&gt;&lt;/font&gt;&lt;/font&gt;&lt;font size="2"&gt; &lt;span class="J-JK9eJ-PJVNOc" \
style="BACKGROUND: yellow"&gt;libvirt&lt;/span&gt;&lt;/font&gt;&lt;font color="#0000ff" size="2"&gt;&lt;font \
color="#0000ff" size="2"&gt; &lt;p align="left"&gt;import&lt;/p&gt;&lt;/font&gt;&lt;/font&gt;&lt;font size="2"&gt; sys
&lt;p align="left"&gt;&lt;/p&gt;
&lt;p align="left"&gt;&lt;span class="J-JK9eJ-PJVNOc" style="BACKGROUND: yellow"&gt;conn&lt;/span&gt; = \
&lt;span class="J-JK9eJ-PJVNOc" style="BACKGROUND: yellow"&gt;libvirt&lt;/span&gt;.&lt;span \
class="J-JK9eJ-PJVNOc" style="BACKGROUND: yellow"&gt;openReadOnly&lt;/span&gt;(&lt;/p&gt; \
&lt;/font&gt;&lt;font color="#0000ff" size="2"&gt;&lt;font color="#0000ff" \
size="2"&gt;None&lt;/font&gt;&lt;/font&gt;&lt;font size="2"&gt;)&lt;/font&gt;&lt;font color="#0000ff" \
size="2"&gt;&lt;font color="#0000ff" size="2"&gt; &lt;p align="left"&gt;if&lt;/p&gt;&lt;/font&gt;&lt;/font&gt;&lt;font \
size="2"&gt; conn == &lt;/font&gt;&lt;font color="#0000ff" size="2"&gt;&lt;font color="#0000ff" \
size="2"&gt;None&lt;/font&gt;&lt;/font&gt;&lt;font size="2"&gt;: &lt;p align="left"&gt;&lt;/p&gt;&lt;/font&gt;&lt;font \
color="#0000ff" size="2"&gt;&lt;font color="#0000ff" size="2"&gt;print&lt;/font&gt;&lt;/font&gt;&lt;font \
size="2"&gt; &lt;/font&gt;&lt;i&gt;&lt;u&gt;&lt;font color="#00aa00" size="2"&gt;&lt;font color="#00aa00" \
size="2"&gt;'Failed to open connection to the \
hypervisor'&lt;/font&gt;&lt;/font&gt;&lt;/u&gt;&lt;/i&gt;&lt;font size="2"&gt; &lt;p align="left"&gt;&lt;span \
class="J-JK9eJ-PJVNOc" style="BACKGROUND: yellow"&gt;sys&lt;/span&gt;.exit(&lt;/p&gt;&lt;/font&gt;&lt;font \
color="#800000" size="2"&gt;&lt;font color="#800000" size="2"&gt;1&lt;/font&gt;&lt;/font&gt;&lt;font \
size="2"&gt;) &lt;p align="left"&gt;&lt;/p&gt;&lt;/font&gt;&lt;font color="#0000ff" size="2"&gt;&lt;font \
color="#0000ff" size="2"&gt; &lt;p align="left"&gt;try&lt;/p&gt;&lt;/font&gt;&lt;/font&gt;&lt;font size="2"&gt;: 
&lt;p align="left"&gt;&lt;span class="J-JK9eJ-PJVNOc" style="BACKGROUND: yellow"&gt;domIds&lt;/span&gt; \
= &lt;span class="J-JK9eJ-PJVNOc" style="BACKGROUND: yellow"&gt;conn&lt;/span&gt;.&lt;span \
class="J-JK9eJ-PJVNOc" style="BACKGROUND: yellow"&gt;listDomainsID&lt;/span&gt;()&lt;/p&gt;

&lt;p align="left"&gt;&lt;/p&gt;
&lt;p align="left"&gt;&lt;/p&gt;&lt;/font&gt;&lt;font color="#0000ff" size="2"&gt;&lt;font color="#0000ff" \
size="2"&gt;for&lt;/font&gt;&lt;/font&gt;&lt;font size="2"&gt; id &lt;/font&gt;&lt;font color="#0000ff" \
size="2"&gt;&lt;font color="#0000ff" size="2"&gt;in&lt;/font&gt;&lt;/font&gt;&lt;font size="2"&gt; domIds: &lt;p \
align="left"&gt;dom0 = &lt;span class="J-JK9eJ-PJVNOc" style="BACKGROUND: \
yellow"&gt;conn&lt;/span&gt;.&lt;span class="J-JK9eJ-PJVNOc" style="BACKGROUND: \
yellow"&gt;lookupByID&lt;/span&gt;(id)&lt;/p&gt; &lt;p align="left"&gt;&lt;a \
href="http://dom0.info"&gt;dom0.info&lt;/a&gt;()&lt;/p&gt; &lt;p align="left"&gt;&lt;/p&gt;&lt;/font&gt;&lt;font \
color="#0000ff" size="2"&gt;&lt;font color="#0000ff" size="2"&gt;print&lt;/font&gt;&lt;/font&gt;&lt;font \
size="2"&gt; &lt;/font&gt;&lt;i&gt;&lt;font color="#00aa00" size="2"&gt;&lt;font color="#00aa00" \
size="2"&gt;"Domain 0: id %d running %s"&lt;/font&gt;&lt;/font&gt;&lt;/i&gt;&lt;font size="2"&gt; % \
(dom0.ID(), dom0.OSType()) &lt;p align="left"&gt;&lt;/p&gt;&lt;/font&gt;&lt;font color="#0000ff" \
size="2"&gt;&lt;font color="#0000ff" size="2"&gt;print&lt;/font&gt;&lt;/font&gt;&lt;font size="2"&gt; &lt;a \
href="http://dom0.info"&gt;dom0.info&lt;/a&gt;()     &lt;p align="left"&gt;&lt;/p&gt;
&lt;p align="left"&gt;&lt;/p&gt;&lt;/font&gt;&lt;font color="#0000ff" size="2"&gt;&lt;font color="#0000ff" \
size="2"&gt;except&lt;/font&gt;&lt;/font&gt;&lt;font size="2"&gt;: &lt;p&gt;&lt;/p&gt;
&lt;p align="left"&gt;&lt;/p&gt;&lt;/font&gt;&lt;font color="#0000ff" size="2"&gt;&lt;font color="#0000ff" \
size="2"&gt;print&lt;/font&gt;&lt;/font&gt;&lt;font size="2"&gt; &lt;/font&gt;&lt;i&gt;&lt;font color="#00aa00" \
size="2"&gt;&lt;font color="#00aa00" size="2"&gt;'Failed to find the main \
domain'&lt;/font&gt;&lt;/font&gt;&lt;/i&gt;&lt;font size="2"&gt; &lt;p align="left"&gt;&lt;span \
class="J-JK9eJ-PJVNOc" style="BACKGROUND: yellow"&gt;sys&lt;/span&gt;.exit(&lt;/p&gt;&lt;/font&gt;&lt;font \
color="#800000" size="2"&gt;&lt;font color="#800000" size="2"&gt;&lt;/font&gt;&lt;/font&gt;&lt;font \
size="2"&gt;)&lt;/font&gt;&lt;/div&gt; &lt;div&gt;The output is :&lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt;Domain 0: id 2 running hvm&lt;br&gt;[1, 131072L, 131072L, 1, \
14921710000000L]&lt;br&gt;Domain 0: id 3 running hvm&lt;br&gt;[1, 131072L, 131072L, 1, \
30880000000L]&lt;/div&gt; &lt;div&gt; &lt;/div&gt;
&lt;div&gt;Here I am not able to understand these values are represent what type of \
information, which value is representing what resource of host machine.Could you \
please help me to understand how I could find out CPU,VM ,memory related information \
seperately through python binding?.&lt;br&gt; &lt;/div&gt;
&lt;div&gt;I didn't find Python binding Reference in the Libvirt site.Could you help me \
by providing the Reference link for Python binding?&lt;/div&gt; &lt;div&gt; &lt;/div&gt;
&lt;div&gt;Thanks in Advance!!&lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt;Arpita&lt;/div&gt;



</body></email><email><emailId>20110209172625</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2011-02-09 17:26:25-0400</timestampReceived><subject>Re: [libvirt-users] [virt-tools-list] store vm xml files in another directory</subject><body>

On 02/08/2011 03:05 PM, Kenneth Armstrong wrote:
&gt; I know that by default, vm xml files are in
&gt; /etc/libvirt/qemu/vm-name.xml, but is there a configuration somewhere
&gt; that I could point to another directory?  For instance, have it on
&gt; something like /srv/qemu/xml/vm-name.xml which would be a GFS2
&gt; filesystem (for HA purposes)?
&gt; 


It isn't configurable, short of modifying the source code and recompiling.

As far as sharing /etc/libvirt/qemu, Dan has responded to that question in the
past:

http://www.mail-archive.com/libvir-list@redhat.com/msg16921.html

- Cole

</body></email><email><emailId>20110210091208</emailId><senderName>Marcela_Castro_León</senderName><senderEmail>mcastrol@gmail.com</senderEmail><timestampReceived>2011-02-10 09:12:08-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt] configuring network interface</subject><body>

[Attachment #2 (multipart/alternative)]


Hello Laine:
I've revised the configuration and followed all your instructions.
I'll try to give you a better explain of my problem.

a) I need a bridged (3) configuration, because I have to connect the guests
from each others. (via ssh and execute mpi). I've three hosts, each of one
has at least a guest.
I'll only explain about the configuration of one of them, because the
problem is only related a one configuration.
hostname=rionegro  ip=192.168.1.4
guest-name=rnompi1

b) I've configured host bridge following step by step ther instruction on
http://wiki.libvirt.org/page/Networking
this is the /etc/network/config

# The loopback network interface
auto lo
iface lo inet loopback


auto br0
iface br0 inet static
address 192.168.1.4
netmask 255.255.255.0
network 192.168.1.0
broadcast 192.168.1.255
gateway 192.168.1.10
bridge_ports eth0
bridge_stp on
bridge_fd 0
bridge_maxwait 0

c) this is the xml guest configuration related to the network.

    &lt;interface type='bridge'&gt;
      &lt;source bridge='br0'/&gt;
    &lt;/interface&gt;


d) But the guest doesn't get any IP automatically, and create an interface
with a variable name (eth4, eth5,etch6..)*. I don't know how to achieve the
guest don't behave like this and create always its network interface *with a
fixed name, for example, eth0).

Why I ask that?

if the guest created an interface with a fixed name, I would configure and
static ip for the it.
I'm attaching a printscreen "rnompi1.jpg"  that show what ifconfig ahow on
the guest (eth14 and without any IP). It doesn't get their host either.

The only way I achieve to solve but "temporally" until reboot is configuring
the guest statically using the name of the interface that has just up.In
that case every works fine, and the guest can connect to all the other
guests on the lan and others can connect to it.
But this only works until reboot or reconfigure the guest, because each time
the name of interface change, and my configuration I had done of
/etc/network/interface didn't work any more because is related to another
interface.

I hope I've explained better the problem I have.

Thank you very much, you've already helped too much to better understand the
different cases of network configuration

Regards.




2011/2/10 Marcela Castro León &lt;mcastrol@gmail.com&gt;

&gt; Hello Laine:
&gt; Thank you very much.
&gt; I've showed only one of the guest, each one have it's own ip address.
&gt; Anyway, I'll follow your advise of revise all the configuration after
&gt; reading the doc.
&gt; Thank you very much again.
&gt; Regards.
&gt;
&gt; 2011/2/8 Laine Stump &lt;laine@laine.org&gt;
&gt;
&gt;  (For future questions such as this, you may find you get a better response
&gt;&gt; (and lower signal-noise ratio) by asking on the recently -created
&gt;&gt; libvirt-users@redhat.com list, as libvir-list has a very large volume of
&gt;&gt; patches and discussion about the internals of libvirt)
&gt;&gt;
&gt;&gt;
&gt;&gt; On 02/08/2011 12:05 PM, Marcela Castro León wrote:
&gt;&gt;
&gt;&gt; Hello
&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;  I've a lan of virtual machine configured with bridge. I've a private
&gt;&gt; lan of 4 machine, but one of them have 2 lan-card with access to internet.
&gt;&gt;
&gt;&gt; Evertything works almost fine, except that I've configured on each guest
&gt;&gt; the static configuration of the bridge with the ip address, like this:
&gt;&gt;
&gt;&gt; auto lo
&gt;&gt; iface lo inet loopback
&gt;&gt;
&gt;&gt; auto eth6
&gt;&gt; iface eth6 inet static
&gt;&gt; address 192.168.1.41
&gt;&gt; network 192.168.1.0
&gt;&gt; netmask 255.255.255.0
&gt;&gt; gateway 192.168.1.10
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; So are you saying that you're attempting to give each guest the *same* IP
&gt;&gt; address? There's no way that can possibly work, even if each is connected to
&gt;&gt; a separate virtual network or bridge. Since the host's IP stack can "see"
&gt;&gt; all of the guests' network traffic, regardless of the connection mode you
&gt;&gt; choose, each must have a unique IP address even if they can't see each
&gt;&gt; other.
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; But each time I, for example, define the guest, it start with a ascending
&gt;&gt; number of interface: eth6,eth7, eth8, etc, Now is initializing with eth12.
&gt;&gt;
&gt;&gt;
&gt;&gt; There must be a mixup in the explanation - I'm understanding that you put
&gt;&gt; the same config file in each guest, but each guest, when it starts, shows a
&gt;&gt; different ethernet interface in its ifconfig. That doesn't seem right,
&gt;&gt; because none of the guests know about each other. Or are you saying
&gt;&gt; something different? Where are you seeing the "eth6", "eth7", ... "eth12"?
&gt;&gt; In the guest XML config maybe?
&gt;&gt;
&gt;&gt;
&gt;&gt; So, it doesn't get the manual configuration I've done on the
&gt;&gt; /etc/network/interfaces.
&gt;&gt; How can avoid this way of work of the number of ethernet interface the
&gt;&gt; guest start?
&gt;&gt;
&gt;&gt;
&gt;&gt; Why are you doing a manual/static definition on the guest at all? It's
&gt;&gt; simpler to just leave the guest to automatically configure its eth0, and if
&gt;&gt; you really want a particular IP address for a particular guest, handle that
&gt;&gt; with a &lt;host&gt; element in the &lt;dhcp&gt; section of the virtual network the guest
&gt;&gt; is connected to (or, if you're using a pure bridging setup, then in the
&gt;&gt; static hosts config of the dhcp server on that network).
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; A way i'm trying to solve is configuring the interface trough the guest
&gt;&gt; xml definition,
&gt;&gt;
&gt;&gt;
&gt;&gt; The guest xml interface configuration cannot be used to setup the IP
&gt;&gt; address, route, etc config of the guest. It is only used for two things:
&gt;&gt;
&gt;&gt; 1) configuring what kind of hardware appears on the guest (but not what
&gt;&gt; name the guest gives to it!)
&gt;&gt;
&gt;&gt; 2) configuring how that hardware is connected to the physical network
&gt;&gt; (usually either via an existing bridge interface on the host (in order for
&gt;&gt; the guest to appear as if its directly connected to the physical network),
&gt;&gt; or via a "virtual network" created by libvirt (which is really just a bridge
&gt;&gt; that's not directly connected to any physical interface, relying instead on
&gt;&gt; the host's IP stack to route packets from the guest out to the physical
&gt;&gt; network.)
&gt;&gt;
&gt;&gt;
&gt;&gt;  but the operation "define" on virsh accepted without error the xml i've
&gt;&gt; done, but the dumpxml doesn't show them, so, it doesn't work at all.
&gt;&gt; I've followed the instruction that said the manual "Application
&gt;&gt; development guide - a guide to application development with libvirt" on page
&gt;&gt; 71.
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; That document is targeted towards software developers writing applications
&gt;&gt; to manage virtual guests using the libvirt API, not for system
&gt;&gt; administrators who are configuring virtual guests manually (or, more likely,
&gt;&gt; by using software that uses the libvirt API, eg virsh or virt-manager). It
&gt;&gt; likely contains more detail and less overview than what you need, which is
&gt;&gt; probably what led to the confusion. I've included a pointer to a wiki page
&gt;&gt; below that is more the appropriate level of information (Justin, if the docs
&gt;&gt; you were working on are somewhere easily accessible, you can point to those
&gt;&gt; instead.)
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; The whole definition of the VM is attached, but the related to interface
&gt;&gt; is:
&gt;&gt;     &lt;interface type='bridge'&gt;
&gt;&gt;       &lt;source bridge='br0'/&gt;
&gt;&gt;       &lt;target dev='vnet0'/&gt;
&gt;&gt;     &lt;protocol&gt;
&gt;&gt;         &lt;ip address="192.168.1.41" prefix="24"/&gt;
&gt;&gt;         &lt;route gateway="192.168.1.10"/&gt;
&gt;&gt;     &lt;/protocol&gt;
&gt;&gt;     &lt;bridge stp="off" delay="0.01"&gt;
&gt;&gt;     &lt;interface type="ethernet" name="eth12"&gt;
&gt;&gt;     &lt;protocol&gt;
&gt;&gt;         &lt;ip address="192.168.1.41" prefix="24"/&gt;
&gt;&gt;         &lt;route gateway="192.168.1.10"/&gt;
&gt;&gt;     &lt;/protocol&gt;
&gt;&gt;     &lt;/interface&gt;
&gt;&gt;     &lt;/bridge&gt;
&gt;&gt;     &lt;/interface&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; You are confusing the guest interface config (that is part of the guest's
&gt;&gt; XML config, and described above), and host physical interface config (that
&gt;&gt; is not in any way associated with guest config, but instead used to
&gt;&gt; configure the host's physical network interfaces, bridges, bonds, and vlan
&gt;&gt; interfaces; and nearly as important, is not supported on Ubuntu anyway).
&gt;&gt;
&gt;&gt; Actual guest interface config is *much* simpler than that.
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; But after define, the dumpxml only show this part:
&gt;&gt;     &lt;interface type='bridge'&gt;
&gt;&gt;       &lt;mac address='52:54:00:3c:92:9a'/&gt;
&gt;&gt;       &lt;source bridge='br0'/&gt;
&gt;&gt;     &lt;/interface&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; That's because everything else you've put in your guest config is not
&gt;&gt; actually a part of a valid guest interface config, and so is ignored.
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; I would appreciate any help to solve the question. The problem I've is I
&gt;&gt; lost the access to the guest every time the libvirt change the name of the
&gt;&gt; interface eth1,2,3, etc.
&gt;&gt;
&gt;&gt;
&gt;&gt; In this case I think it may be useful to start over. You've somehow been
&gt;&gt; tricked into misunderstanding the way that network configuration in libvirt
&gt;&gt; works, confusing host interface config with guest interface config, and the
&gt;&gt; resulting config bears little resemblance to what would actually work.
&gt;&gt;
&gt;&gt; ==
&gt;&gt; The first step is to read this page:
&gt;&gt;
&gt;&gt;    http://wiki.libvirt.org/page/Networking
&gt;&gt;
&gt;&gt; to get a basic overview.
&gt;&gt;
&gt;&gt; ==
&gt;&gt; Second step: you should decide which of the three methods of connecting to
&gt;&gt; guests to the physical network you want to use:
&gt;&gt;
&gt;&gt; 1) NATed
&gt;&gt; 2) routed
&gt;&gt; 3) bridged
&gt;&gt;
&gt;&gt; The simplest is (1), and that will probably work just fine as long as 1)
&gt;&gt; you don't need incoming connections to the guests, and 2) you're not
&gt;&gt; concerned about getting the last fraction of an ounce of performance out of
&gt;&gt; the network.
&gt;&gt;
&gt;&gt; Depending on which of those 3 you decide to use:
&gt;&gt;
&gt;&gt; ==
&gt;&gt; Third step: follow the instructions to either create a bridge interface on
&gt;&gt; the host connected to a physical network interface (for (3)), or to create a
&gt;&gt; libvirt virtual network using one of the two modes ((1) or (2) - actually
&gt;&gt; the stock libvirt config already has a "default" network that is probably
&gt;&gt; adequate for (1), and unless you understand IP routing very well, you'll
&gt;&gt; likely want to avoid (2)).
&gt;&gt;
&gt;&gt; Once the physical network is setup:
&gt;&gt;
&gt;&gt; ==
&gt;&gt; Fourth step: define your guests. In each guest, you'll have an &lt;interface&gt;
&gt;&gt; element, but it will be much simpler than what you've previously tried. For
&gt;&gt; bridged mode, the interface section would look like this:
&gt;&gt;
&gt;&gt;
&gt;&gt;   &lt;interface type='bridge'&gt;
&gt;&gt;     &lt;source bridge='br0'/&gt;
&gt;&gt;   &lt;/interface&gt;
&gt;&gt;
&gt;&gt; Depending on the guest, you may want to specify what type of hardware is
&gt;&gt; presented to the guest (default is rtl, which almost always works, but is
&gt;&gt; not the best perfrorming), in particular, if the guest supports virtio-net,
&gt;&gt; you'll want to add this into the &lt;interface&gt; element:
&gt;&gt;
&gt;&gt;   &lt;model type='virtio'/&gt;
&gt;&gt;
&gt;&gt; For NATed or routed mode, the guest's interface definition would look like
&gt;&gt; this:
&gt;&gt;
&gt;&gt;   &lt;interface type='network'&gt;
&gt;&gt;      &lt;source network='default'/&gt;
&gt;&gt;   &lt;/interface&gt;
&gt;&gt;
&gt;&gt; (replace "default" with the name of the network you've defined, if you've
&gt;&gt; defined your own). In this case also, you can add a &lt;model type='...'/&gt; if
&gt;&gt; appropriate.
&gt;&gt;
&gt;&gt; Note that I don't put anything in the &lt;interface&gt; element about MAC
&gt;&gt; address, target device, or bus address. Those are all setup automatically by
&gt;&gt; libvirt the first time you start the guest, and it will make sure that the
&gt;&gt; guests don't interfere with each other.
&gt;&gt;
&gt;&gt; ==
&gt;&gt; Fifth step: only if you need a particular guest to have a particular fixed
&gt;&gt; IP address, either 1) edit the network config file on the guest, 2) add a
&gt;&gt; static host to the libvirt virtual network definition (giving the MAC
&gt;&gt; address provided to the guest by libvirt during the initial guest startup)
&gt;&gt; with a &lt;host&gt; element added to the &lt;dhcp&gt; element of the network; details
&gt;&gt; are here:
&gt;&gt;
&gt;&gt;     http://www.libvirt.org/formatnetwork.html
&gt;&gt;
&gt;&gt; or 3) if you're using the bridged method to connect to the physical
&gt;&gt; network, again either configure the guest's own config file, or add a static
&gt;&gt; host definition to the dhcp server running on your physical network.
&gt;&gt;
&gt;&gt; If you still have problems don't hesitate to send another mail (although,
&gt;&gt; as I said at the top, sending to libvirt-users@redhat.com may yield
&gt;&gt; better results than libvir-list@redhat.com).
&gt;&gt;
&gt;
&gt;

[Attachment #5 (text/html)]

Hello Laine:&lt;br&gt;I've revised the configuration and followed all your \
instructions.&lt;br&gt;I'll try to give you a better explain of my problem.&lt;br&gt;&lt;br&gt;a) I \
need a bridged (3) configuration, because I have to connect the guests from each \
others. (via ssh and execute mpi). I've three hosts, each of one has at least a \
guest. &lt;br&gt; I'll only explain about the configuration of one of them, because the \
problem is only related a one configuration.&lt;br&gt;hostname=rionegro  \
ip=192.168.1.4&lt;br&gt;guest-name=rnompi1&lt;br&gt;&lt;br&gt;b) I've configured host bridge \
following step by step ther instruction on    &lt;a \
href="http://wiki.libvirt.org/page/Networking" \
target="_blank"&gt;http://wiki.libvirt.org/page/Networking&lt;/a&gt;&lt;br&gt;

    this is the /etc/network/config&lt;br&gt;&lt;br style="color: rgb(192, 192, 192);"&gt;&lt;span \
style="font-family: courier new,monospace; background-color: rgb(192, 192, 192); \
color: rgb(0, 0, 0);"&gt;# The loopback network interface&lt;/span&gt;&lt;br style="font-family: \
courier new,monospace; background-color: rgb(192, 192, 192); color: rgb(0, 0, 0);"&gt; \
&lt;span style="font-family: courier new,monospace; background-color: rgb(192, 192, \
192); color: rgb(0, 0, 0);"&gt;auto lo&lt;/span&gt;&lt;br style="font-family: courier \
new,monospace; background-color: rgb(192, 192, 192); color: rgb(0, 0, 0);"&gt; &lt;span \
style="font-family: courier new,monospace; background-color: rgb(192, 192, 192); \
color: rgb(0, 0, 0);"&gt;iface lo inet loopback&lt;/span&gt;&lt;br style="font-family: courier \
new,monospace; background-color: rgb(192, 192, 192); color: rgb(0, 0, 0);"&gt; &lt;br \
style="font-family: courier new,monospace; background-color: rgb(192, 192, 192); \
color: rgb(0, 0, 0);"&gt;&lt;span style="font-family: courier new,monospace; \
background-color: rgb(192, 192, 192); color: rgb(0, 0, 0);"&gt;&lt;/span&gt;&lt;br \
style="font-family: courier new,monospace; background-color: rgb(192, 192, 192); \
color: rgb(0, 0, 0);"&gt; &lt;span style="font-family: courier new,monospace; \
background-color: rgb(192, 192, 192); color: rgb(0, 0, 0);"&gt;auto br0&lt;/span&gt;&lt;br \
style="font-family: courier new,monospace; background-color: rgb(192, 192, 192); \
color: rgb(0, 0, 0);"&gt; &lt;span style="font-family: courier new,monospace; \
background-color: rgb(192, 192, 192); color: rgb(0, 0, 0);"&gt;iface br0 inet \
static&lt;/span&gt;&lt;br style="font-family: courier new,monospace; background-color: \
rgb(192, 192, 192); color: rgb(0, 0, 0);"&gt; &lt;span style="font-family: courier \
new,monospace; background-color: rgb(192, 192, 192); color: rgb(0, 0, 0);"&gt;address \
192.168.1.4&lt;/span&gt;&lt;br style="font-family: courier new,monospace; background-color: \
rgb(192, 192, 192); color: rgb(0, 0, 0);"&gt; &lt;span style="font-family: courier \
new,monospace; background-color: rgb(192, 192, 192); color: rgb(0, 0, 0);"&gt;netmask \
255.255.255.0&lt;/span&gt;&lt;br style="font-family: courier new,monospace; background-color: \
rgb(192, 192, 192); color: rgb(0, 0, 0);"&gt; &lt;span style="font-family: courier \
new,monospace; background-color: rgb(192, 192, 192); color: rgb(0, 0, 0);"&gt;network \
192.168.1.0&lt;/span&gt;&lt;br style="font-family: courier new,monospace; background-color: \
rgb(192, 192, 192); color: rgb(0, 0, 0);"&gt; &lt;span style="font-family: courier \
new,monospace; background-color: rgb(192, 192, 192); color: rgb(0, 0, 0);"&gt;broadcast \
192.168.1.255&lt;/span&gt;&lt;br style="font-family: courier new,monospace; background-color: \
rgb(192, 192, 192); color: rgb(0, 0, 0);"&gt; &lt;span style="font-family: courier \
new,monospace; background-color: rgb(192, 192, 192); color: rgb(0, 0, 0);"&gt;gateway \
192.168.1.10&lt;/span&gt;&lt;br style="font-family: courier new,monospace; background-color: \
rgb(192, 192, 192); color: rgb(0, 0, 0);"&gt; &lt;span style="font-family: courier \
new,monospace; background-color: rgb(192, 192, 192); color: rgb(0, 0, \
0);"&gt;bridge_ports eth0&lt;/span&gt;&lt;br style="font-family: courier new,monospace; \
background-color: rgb(192, 192, 192); color: rgb(0, 0, 0);"&gt; &lt;span \
style="font-family: courier new,monospace; background-color: rgb(192, 192, 192); \
color: rgb(0, 0, 0);"&gt;bridge_stp on&lt;/span&gt;&lt;br style="font-family: courier \
new,monospace; background-color: rgb(192, 192, 192); color: rgb(0, 0, 0);"&gt; &lt;span \
style="font-family: courier new,monospace; background-color: rgb(192, 192, 192); \
color: rgb(0, 0, 0);"&gt;bridge_fd 0&lt;/span&gt;&lt;br style="font-family: courier \
new,monospace; background-color: rgb(192, 192, 192); color: rgb(0, 0, 0);"&gt; &lt;span \
style="font-family: courier new,monospace; background-color: rgb(192, 192, 192); \
color: rgb(0, 0, 0);"&gt;bridge_maxwait 0&lt;/span&gt;&lt;br style="font-family: courier \
new,monospace; background-color: rgb(153, 153, 153);"&gt;&lt;br&gt; c) this is the xml guest \
configuration related to the network.&lt;br&gt;&lt;br&gt;&lt;span style="font-family: courier \
new,monospace; color: rgb(51, 0, 0); background-color: rgb(192, 192, 192);"&gt;    \
&lt;interface type='bridge'&gt;&lt;/span&gt;&lt;br style="font-family: courier \
new,monospace; color: rgb(51, 0, 0); background-color: rgb(192, 192, 192);"&gt; &lt;span \
style="font-family: courier new,monospace; color: rgb(51, 0, 0); background-color: \
rgb(192, 192, 192);"&gt;      &lt;source bridge='br0'/&gt;&lt;/span&gt;&lt;br \
style="font-family: courier new,monospace; color: rgb(51, 0, 0); background-color: \
rgb(192, 192, 192);"&gt; &lt;span style="font-family: courier new,monospace; color: rgb(51, \
0, 0); background-color: rgb(192, 192, 192);"&gt;    &lt;/interface&gt;&lt;/span&gt;&lt;br \
style="font-family: courier new,monospace;"&gt;&lt;br&gt;&lt;br&gt;d) But the guest doesn't get \
any IP automatically, and create an interface with a variable name (eth4, \
eth5,etch6..)&lt;u&gt;. I don't know how to achieve the guest don't behave like \
this and create always its network interface &lt;/u&gt;with a fixed name, for example, \
eth0).&lt;br&gt; &lt;br&gt;Why I ask that?&lt;br&gt;&lt;br&gt;if the guest created an interface with a fixed \
name, I would configure and static ip for the it.&lt;br&gt;I'm attaching a printscreen \
"rnompi1.jpg"  that show what ifconfig ahow on the guest (eth14 and without \
any IP). It doesn't get their host either.&lt;br&gt; &lt;br&gt;The only way I achieve to \
solve but "temporally" until reboot is configuring the guest statically \
using the name of the interface that has just up.In that case every works fine, and \
the guest can connect to all the other guests on the lan and others can connect to \
it. &lt;br&gt; But this only works until reboot or reconfigure the guest, because each time \
the name of interface change, and my configuration I had done of \
/etc/network/interface didn't work any more because is related to another \
interface.&lt;br&gt; &lt;br&gt;I hope I've explained better the problem I have.&lt;br&gt;&lt;br&gt;Thank \
you very much, you've already helped too much to better understand the different \
cases of network configuration&lt;br&gt;&lt;br&gt;Regards.&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt; &lt;div \
class="gmail_quote"&gt;2011/2/10 Marcela Castro León &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:mcastrol@gmail.com"&gt;mcastrol@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, \
204, 204); padding-left: 1ex;"&gt; Hello Laine:&lt;br&gt;Thank you very much. &lt;br&gt;I've \
showed only one of the guest, each one have it's own ip address. Anyway, I'll \
follow your advise of revise all the configuration after reading the doc.&lt;br&gt;Thank \
you very much again.&lt;br&gt;

Regards.&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;2011/2/8 Laine Stump &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:laine@laine.org" \
target="_blank"&gt;laine@laine.org&lt;/a&gt;&gt;&lt;/span&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div \
class="h5"&gt;&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; \
border-left: 1px solid rgb(204, 204, 204); padding-left: 1ex;"&gt;



  
    
  
  &lt;div bgcolor="#ffffff" text="#000000"&gt;
    (For future questions such as this, you may find you get a better
    response (and lower signal-noise ratio) by asking on the recently
    -created &lt;a href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt; list, as libvir-list has a very  large \
volume of patches and discussion about the internals of  libvirt)&lt;div&gt;&lt;br&gt;
    &lt;br&gt;
    On 02/08/2011 12:05 PM, Marcela Castro León wrote:
    &lt;blockquote type="cite"&gt;Hello &lt;br&gt;
      &lt;div class="gmail_quote"&gt;
        &lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; \
border-left: 1px solid rgb(204, 204, 204); padding-left: 1ex;"&gt;&lt;br&gt;  &lt;/blockquote&gt;
      &lt;/div&gt;
      I've a lan of virtual machine configured with bridge. I've a
      private lan of 4 machine, but one of them have 2 lan-card with
      access to internet. &lt;br&gt;
      &lt;br&gt;
      Evertything works almost fine, except that I've configured on each
      guest the static configuration of the bridge with the ip address,
      like this:&lt;br&gt;
      &lt;br&gt;
      auto lo&lt;br&gt;
      iface lo inet loopback&lt;br&gt;
      &lt;br&gt;
      auto eth6&lt;br&gt;
      iface eth6 inet static&lt;br&gt;
      address 192.168.1.41&lt;br&gt;
      network 192.168.1.0&lt;br&gt;
      netmask 255.255.255.0&lt;br&gt;
      gateway 192.168.1.10&lt;br&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
    &lt;br&gt;&lt;/div&gt;
    So are you saying that you're attempting to give each guest the
    *same* IP address? There's no way that can possibly work, even if
    each is connected to a separate virtual network or bridge. Since the
    host's IP stack can "see" all of the guests' network traffic,
    regardless of the connection mode you choose, each must have a
    unique IP address even if they can't see each other.&lt;div&gt;&lt;br&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;blockquote type="cite"&gt;&lt;br&gt;
      But each time I, for example, define the guest, it start with a
      ascending number of interface: eth6,eth7, eth8, etc, Now is
      initializing with eth12.&lt;/blockquote&gt;
    &lt;br&gt;&lt;/div&gt;
    There must be a mixup in the explanation - I'm understanding that
    you put the same config file in each guest, but each guest, when it
    starts, shows a different ethernet interface in its ifconfig. That
    doesn't seem right, because none of the guests know about each
    other. Or are you saying something different? Where are you seeing
    the "eth6", "eth7", ... "eth12"? In the guest XML \
config maybe?&lt;div&gt;&lt;br&gt;  &lt;br&gt;
    &lt;blockquote type="cite"&gt;So, it doesn't get the manual configuration I've \
done  on the /etc/network/interfaces.&lt;br&gt;
      How can avoid this way of work of the number of ethernet interface
      the guest start?&lt;br&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;&lt;/div&gt;
    Why are you doing a manual/static definition on the guest at all?
    It's simpler to just leave the guest to automatically configure its
    eth0, and if you really want a particular IP address for a
    particular guest, handle that with a &lt;host&gt; element in the
    &lt;dhcp&gt; section of the virtual network the guest is connected
    to (or, if you're using a pure bridging setup, then in the static
    hosts config of the dhcp server on that network).&lt;div&gt;&lt;br&gt;
    &lt;br&gt;
    &lt;blockquote type="cite"&gt;&lt;br&gt;
      A way i'm trying to solve is configuring the interface trough the
      guest xml definition,&lt;/blockquote&gt;
    &lt;br&gt;&lt;/div&gt;
    The guest xml interface configuration cannot be used to setup the IP
    address, route, etc config of the guest. It is only used for two
    things:&lt;br&gt;
    &lt;br&gt;
    1) configuring what kind of hardware appears on the guest (but not
    what name the guest gives to it!)&lt;br&gt;
    &lt;br&gt;
    2) configuring how that hardware is connected to the physical
    network (usually either via an existing bridge interface on the host
    (in order for the guest to appear as if its directly connected to
    the physical network), or via a "virtual network" created by libvirt
    (which is really just a bridge that's not directly connected to any
    physical interface, relying instead on the host's IP stack to route
    packets from the guest out to the physical network.)&lt;div&gt;&lt;br&gt;
    &lt;br&gt;
    &lt;blockquote type="cite"&gt; but the operation "define" on virsh accepted \
                without
      error the xml i've done, but the dumpxml doesn't show them, so, it
      doesn't work at all.&lt;br&gt;
      I've followed the instruction that said the manual "Application
      development guide - a guide to application development with
      libvirt" on page 71.&lt;br&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
    &lt;br&gt;&lt;/div&gt;
    That document is targeted towards software developers writing
    applications to manage virtual guests using the libvirt API, not for
    system administrators who are configuring virtual guests manually
    (or, more likely, by using software that uses the libvirt API, eg
    virsh or virt-manager). It likely contains more detail and less
    overview than what you need, which is probably what led to the
    confusion. I've included a pointer to a wiki page below that is more
    the appropriate level of information (Justin, if the docs you were
    working on are somewhere easily accessible, you can point to those
    instead.)&lt;div&gt;&lt;br&gt;
    &lt;br&gt;
    &lt;blockquote type="cite"&gt;&lt;br&gt;
      The whole definition of the VM is attached, but the related to
      interface is:&lt;br&gt;
          &lt;interface type='bridge'&gt;&lt;br&gt;
            &lt;source bridge='br0'/&gt;&lt;br&gt;
            &lt;target dev='vnet0'/&gt;&lt;br&gt;
          &lt;protocol&gt;&lt;br&gt;
              &lt;ip address="192.168.1.41" prefix="24"/&gt;&lt;br&gt;
              &lt;route gateway="192.168.1.10"/&gt;&lt;br&gt;
          &lt;/protocol&gt;&lt;br&gt;
          &lt;bridge stp="off" delay="0.01"&gt;&lt;br&gt;
          &lt;interface type="ethernet" name="eth12"&gt;&lt;br&gt;
          &lt;protocol&gt;&lt;br&gt;
              &lt;ip address="192.168.1.41" prefix="24"/&gt;&lt;br&gt;
              &lt;route gateway="192.168.1.10"/&gt;&lt;br&gt;
          &lt;/protocol&gt;&lt;br&gt;
          &lt;/interface&gt;&lt;br&gt;
          &lt;/bridge&gt;&lt;br&gt;
          &lt;/interface&gt;&lt;br&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
    &lt;br&gt;&lt;/div&gt;
    You are confusing the guest interface config (that is part of the
    guest's XML config, and described above), and host physical
    interface config (that is not in any way associated with guest
    config, but instead used to configure the host's physical network
    interfaces, bridges, bonds, and vlan interfaces; and nearly as
    important, is not supported on Ubuntu anyway).&lt;br&gt;
    &lt;br&gt;
    Actual guest interface config is *much* simpler than that.&lt;div&gt;&lt;br&gt;
    &lt;br&gt;
    &lt;blockquote type="cite"&gt;&lt;br&gt;
      &lt;br&gt;
      But after define, the dumpxml only show this part:&lt;br&gt;
          &lt;interface type='bridge'&gt;&lt;br&gt;
            &lt;mac address='52:54:00:3c:92:9a'/&gt;&lt;br&gt;
            &lt;source bridge='br0'/&gt;&lt;br&gt;
          &lt;/interface&gt;&lt;br&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
    &lt;br&gt;&lt;/div&gt;
    That's because everything else you've put in your guest config is
    not actually a part of a valid guest interface config, and so is
    ignored.&lt;div&gt;&lt;br&gt;
    &lt;br&gt;
    &lt;blockquote type="cite"&gt;&lt;br&gt;
      &lt;br&gt;
      I would appreciate any help to solve the question. The problem
      I've is I lost the access to the guest every time the libvirt
      change the name of the interface eth1,2,3, etc.&lt;br&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;&lt;/div&gt;
    In this case I think it may be useful to start over. You've somehow
    been tricked into misunderstanding the way that network
    configuration in libvirt works, confusing host interface config with
    guest interface config, and the resulting config bears little
    resemblance to what would actually work.&lt;br&gt;
    &lt;br&gt;
    ==&lt;br&gt;
    The first step is to read this page:&lt;br&gt;
    &lt;br&gt;
       &lt;a href="http://wiki.libvirt.org/page/Networking" \
target="_blank"&gt;http://wiki.libvirt.org/page/Networking&lt;/a&gt;&lt;br&gt;  &lt;br&gt;
    to get a basic overview.&lt;br&gt;
    &lt;br&gt;
    ==&lt;br&gt;
    Second step: you should decide which of the three methods of
    connecting to guests to the physical network you want to use:&lt;br&gt;
    &lt;br&gt;
    1) NATed&lt;br&gt;
    2) routed&lt;br&gt;
    3) bridged&lt;br&gt;
    &lt;br&gt;
    The simplest is (1), and that will probably work just fine as long
    as 1) you don't need incoming connections to the guests, and 2)
    you're not concerned about getting the last fraction of an ounce of
    performance out of the network.&lt;br&gt;
    &lt;br&gt;
    Depending on which of those 3 you decide to use:&lt;br&gt;
    &lt;br&gt;
    ==&lt;br&gt;
    Third step: follow the instructions to either create a bridge
    interface on the host connected to a physical network interface (for
    (3)), or to create a libvirt virtual network using one of the two
    modes ((1) or (2) - actually the stock libvirt config already has a
    "default" network that is probably adequate for (1), and unless you
    understand IP routing very well, you'll likely want to avoid (2)).&lt;br&gt;
    &lt;br&gt;
    Once the physical network is setup:&lt;br&gt;
    &lt;br&gt;
    ==&lt;br&gt;
    Fourth step: define your guests. In each guest, you'll have an
    &lt;interface&gt; element, but it will be much simpler than what
    you've previously tried. For bridged mode, the interface section
    would look like this:&lt;div&gt;&lt;br&gt;
    &lt;br&gt;
      &lt;interface type='bridge'&gt;&lt;br&gt;
        &lt;source bridge='br0'/&gt;&lt;br&gt;&lt;/div&gt;
      &lt;/interface&gt;&lt;br&gt;
    &lt;br&gt;
    Depending on the guest, you may want to specify what type of
    hardware is presented to the guest (default is rtl, which almost
    always works, but is not the best perfrorming), in particular, if
    the guest supports virtio-net, you'll want to add this into the
    &lt;interface&gt; element:&lt;br&gt;
    &lt;br&gt;
      &lt;model type='virtio'/&gt;&lt;br&gt;
    &lt;br&gt;
    For NATed or routed mode, the guest's interface definition would
    look like this:&lt;br&gt;
    &lt;br&gt;
    &lt;pre&gt;  &lt;interface type='network'&gt;
     &lt;source network='default'/&gt;
  &lt;/interface&gt;
&lt;/pre&gt;
    (replace "default" with the name of the network you've defined, if
    you've defined your own). In this case also, you can add a &lt;model
    type='...'/&gt; if appropriate.&lt;br&gt;
    &lt;br&gt;
    Note that I don't put anything in the &lt;interface&gt; element
    about MAC address, target device, or bus address. Those are all
    setup automatically by libvirt the first time you start the guest,
    and it will make sure that the guests don't interfere with each
    other.&lt;br&gt;
    &lt;br&gt;
    ==&lt;br&gt;
    Fifth step: only if you need a particular guest to have a particular
    fixed IP address, either 1) edit the network config file on the
    guest, 2) add a static host to the libvirt virtual network
    definition (giving the MAC address provided to the guest by libvirt
    during the initial guest startup) with a &lt;host&gt; element added
    to the &lt;dhcp&gt; element of the network; details are here:&lt;br&gt;
    &lt;br&gt;
        &lt;a href="http://www.libvirt.org/formatnetwork.html" \
target="_blank"&gt;http://www.libvirt.org/formatnetwork.html&lt;/a&gt;&lt;br&gt;  &lt;br&gt;
    or 3) if you're using the bridged method to connect to the physical
    network, again either configure the guest's own config file, or add
    a static host definition to the dhcp server running on your physical
    network.&lt;br&gt;
    &lt;br&gt;
    If you still have problems don't hesitate to send another mail
    (although, as I said at the top, sending to &lt;a \
href="mailto:libvirt-users@redhat.com" target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;  \
may yield better results than &lt;a href="mailto:libvir-list@redhat.com" \
target="_blank"&gt;libvir-list@redhat.com&lt;/a&gt;).&lt;br&gt;  &lt;/div&gt;

&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;

--001485f0a01ee7ae26049be9f913--


["rnompi1.jpg" (image/jpeg)]

</body></email><email><emailId>20110211074119</emailId><senderName>arpita k</senderName><senderEmail>arpitak29@gmail.com</senderEmail><timestampReceived>2011-02-11 07:41:19-0400</timestampReceived><subject>[libvirt-users] Not able to capture detailed CPU information of the guest machine using Libvirt API.</subject><body>

Hi ,

I have two KVM guests in ubuntu host machine.I am using Python binding of
Libvirt API to query on the hypervisor and capture the CPU , memory related
information of the guest machines.

I need to capture the detail information regarding CPU like : cpu_aidle,
cpu_idle, cpu_speed, cpu_wio and memory like
:mem_cached,mem_buffers,mem_free etc. of the guest machines.

How could I get these information?

Please help me.

Thanks in Advance!!

Arpita

[Attachment #3 (text/html)]

Hi ,&lt;br&gt;&lt;br&gt;I have two KVM guests in ubuntu host machine.I am using Python =
binding of Libvirt API to query on the hypervisor and capture the CPU , mem=
ory related information of the guest machines.&lt;br&gt;&lt;br&gt;I need to capture the=
 detail information regarding CPU like : cpu_aidle, cpu_idle, cpu_speed, cp=
u_wio and memory like :mem_cached,mem_buffers,mem_free etc. of the guest ma=
chines.&lt;br&gt;
&lt;br&gt;How could I get these information?&lt;br&gt;&lt;br&gt;Please help me.&lt;br&gt;&lt;br&gt;Thanks=
 in Advance!!&lt;br&gt;&lt;br&gt;Arpita&lt;br&gt;


</body></email><email><emailId>20110210235457</emailId><senderName>"Bryan D. Payne"</senderName><senderEmail>bryan@thepaynes.cc</senderEmail><timestampReceived>2011-02-10 23:54:57-0400</timestampReceived><subject>[libvirt-users] Start domain with usable QMP connection?</subject><body>

Is there any way to get virsh / libvirt to create a domain such that I
can later connect to it via QMP (without hacking the code)?

The command line that libvirt creates for my current setup looks like this:

/usr/local/bin/qemu-system-x86_64 -S -M pc-0.12 -enable-kvm -m 512
-smp 1,sockets=1,cores=1,threads=1 -name winxpsp2 -uuid
ab244939-c804-1aff-68b6-9324f174c3c8 -nodefconfig -nodefaults -chardev
socket,id=monitor,path=/usr/local/var/lib/libvirt/qemu/winxpsp2.monitor,server,nowait
-mon chardev=monitor,mode=control -rtc base=localtime -boot c -drive
file=/var/lib/libvirt/images/winxpsp2.img,if=none,id=drive-ide0-0-0,format=raw
-device ide-drive,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0
-drive file=/home/username/iso/en_winxp_pro_with_sp2.iso,if=none,media=cdrom,id=drive-ide0-1-0,readonly=on,format=raw
                
-device ide-drive,bus=ide.1,unit=0,drive=drive-ide0-1-0,id=ide0-1-0
-netdev tap,fd=16,id=hostnet0 -device
rtl8139,netdev=hostnet0,id=net0,mac=52:54:00:4d:1d:1b,bus=pci.0,addr=0x3
-chardev pty,id=serial0 -device isa-serial,chardev=serial0 -usb
-device usb-tablet,id=input0 -vnc 127.0.0.1:0 -k en-us -vga std
-device ES1370,id=sound0,bus=pci.0,addr=0x4 -device
virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x5

The important pieces of this command line (I believe) are:

-chardev socket,id=monitor,path=/usr/local/var/lib/libvirt/qemu/winxpsp2.monitor,server,nowait
                
-mon chardev=monitor,mode=control

However, I'm unable to connect using this path because -- I'm guessing
-- libvirt has already connected.  As a test, I added some code to
src/qemu/qemu_command.c to open a second chardev.  My new command line
looks like this:

/usr/local/bin/qemu-system-x86_64 -S -M pc-0.12 -enable-kvm -m 512
-smp 1,sockets=1,cores=1,threads=1 -name winxpsp2 -uuid
ab244939-c804-1aff-68b6-9324f174c3c8 -nodefconfig -nodefaults -chardev
socket,id=monitor,path=/usr/local/var/lib/libvirt/qemu/winxpsp2.monitor,server,nowait
-mon chardev=monitor,mode=control -chardev
socket,id=qmpmonitor,path=/usr/local/var/lib/libvirt/qemu/winxpsp2.qmpmonitor,server,nowait
                
-mon chardev=qmpmonitor,mode=control -rtc base=localtime -boot c
-drive file=/var/lib/libvirt/images/winxpsp2.img,if=none,id=drive-ide0-0-0,format=raw
-device ide-drive,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0
-drive file=/home/username/iso/en_winxp_pro_with_sp2.iso,if=none,media=cdrom,id=drive-ide0-1-0,readonly=on,format=raw
                
-device ide-drive,bus=ide.1,unit=0,drive=drive-ide0-1-0,id=ide0-1-0
-netdev tap,fd=15,id=hostnet0 -device
rtl8139,netdev=hostnet0,id=net0,mac=52:54:00:4d:1d:1b,bus=pci.0,addr=0x3
-chardev pty,id=serial0 -device isa-serial,chardev=serial0 -usb
-device usb-tablet,id=input0 -vnc 127.0.0.1:0 -k en-us -vga std
-device ES1370,id=sound0,bus=pci.0,addr=0x4 -device
virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x5

Notice that there are now two chardevs:

-chardev socket,id=monitor,path=/usr/local/var/lib/libvirt/qemu/winxpsp2.monitor,server,nowait
                
-mon chardev=monitor,mode=control

-chardev socket,id=qmpmonitor,path=/usr/local/var/lib/libvirt/qemu/winxpsp2.qmpmonitor,server,nowait
                
-mon chardev=qmpmonitor,mode=control

As expected, I am able to connect to this second chardev via QMP.  Is
there anyway that I can enable such functionality in libvirt without
hacking the code?

Thanks,
bryan


</body></email><email><emailId>20110211103143</emailId><senderName>Marcela_Castro_León</senderName><senderEmail>mcastrol@gmail.com</senderEmail><timestampReceived>2011-02-11 10:31:43-0400</timestampReceived><subject>[libvirt-users] Using NFS to read image file</subject><body>

Hello:
When I start the guest with an image on NFS file system, the ubuntu doesn't
boot, It's remain on inittrams.
I've tried to redefine the guest without
&lt;apic&gt;
&lt;pae&gt;
configuration as I see on a blog, and I've increased the parameters of the
mount to rsize=32768 and wsize=32768, but it still doesn't work.
Can anyone give any advice to get it?
Thank you very much.

Marcela

[Attachment #3 (text/html)]

&lt;font style="font-family: georgia,serif;" size="2"&gt;&lt;br&gt;Hello:&lt;br&gt;When I start the \
guest with an image on NFS file system, the ubuntu doesn't boot, It's remain \
on inittrams.&lt;br&gt;I've tried to redefine the guest without &lt;br&gt; &lt;apic&gt;&lt;br&gt;
&lt;pae&gt;&lt;br&gt;configuration as I see on a blog, and I've increased the \
parameters of the mount to rsize=32768 and wsize=32768, but it still doesn't \
work.&lt;br&gt;Can anyone give any advice to get it?&lt;br&gt;Thank you very much.&lt;br&gt; \
&lt;br&gt;&lt;/font&gt;Marcela&lt;br&gt;



</body></email><email><emailId>20110213205811</emailId><senderName>Zvi Dubitzky</senderName><senderEmail>dubi@il.ibm.com</senderEmail><timestampReceived>2011-02-13 20:58:11-0400</timestampReceived><subject>[libvirt-users] Linux  version that supports cgroup</subject><body>

Hi
Does Fedora release 14 (Laughlin)  having   Linux kernel 
2.6.35.6-45.fc14.x86_64 support cgroup
at the kernel ?

thanks

Zvi Dubitzky 
Email:dubi@il.ibm.com

</body></email><email><emailId>20110214045033</emailId><senderName>Gary Scarborough</senderName><senderEmail>linuxgoblin@gmail.com</senderEmail><timestampReceived>2011-02-14 04:50:33-0400</timestampReceived><subject>[libvirt-users] connecting to virtualbox with libvirt</subject><body>

I am trying to connect to the virtualbox hypervisor through libvirt.  If I
am doing it correctly,

virsh -c vbox:///session

should get me connected.  I am on F14 64 bit.  I tried this with both vbox
3.2 and 4.02.  I keep getting the following error:

error: no connection driver available for vbox:///session.

What am I missing?

Thanks,

Gary

[Attachment #3 (text/html)]

I am trying to connect to the virtualbox hypervisor through libvirt.=A0 If =
I am doing it correctly, &lt;br&gt;&lt;br&gt;virsh -c vbox:///session&lt;br&gt;&lt;br&gt;should get=
 me connected.=A0 I am on F14 64 bit.=A0 I tried this with both vbox 3.2 an=
d 4.02.=A0 I keep getting the following error:&lt;br&gt;
&lt;br&gt;error: no connection driver available for vbox:///session.&lt;br&gt;&lt;br&gt;What =
am I missing?&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;&lt;br&gt;Gary&lt;br&gt;


</body></email><email><emailId>20110214210149</emailId><senderName>Iain MacDonnell</senderName><senderEmail>dseven@dseven.org</senderEmail><timestampReceived>2011-02-14 21:01:49-0400</timestampReceived><subject>[libvirt-users] Xen disk device detach fails as non-root [libvirt-0.8.7 and older versions]</subject><body>

Hi All,

I find that I am able to attach a disk device do a Xen domain, using
virDomainAttachDevice(), running as a non-root user, but I am unable
to use virDomainDetachDevice() - it results in an "unknown failure".
Using "virsh [attach|detach]-device" exhibits this behviour.

$ virsh attach-device domu1 attach.xml
Device attached successfully

$ virsh detach-device domu1 attach.xml
error: Failed to detach device from attach.xml
error: Unknown failure

$

With some digging, I determined that the problem arises when libvirt
tries to translate the device name to a number, using the XenStore API
(xenStoreDomainGetDiskID()), which requires use of the "xenstored"
UNIX socket, and that socket is only accessible by root. On making
that socket accessible to the user (by group), virDomainAttachDevice()
starts working, but I'm then unable to list domains, because
xenStoreDoListDomains() waits to verify each domain using
xenHypervisorHasDomain(), and that requires access to another socket -
"/proc/xen/privcmd"

My question, before going down the path of trying to hack permissions
for these sockets permanently ..... is this how it's supposed to be,
or could, perhaps, libvirtd, which runs as root, access these sockets
on behalf of the user? It seems it should at least fail more
gracefully....

TIA for any pointers....

    ~iain

</body></email><email><emailId>20110215075251</emailId><senderName>Zvi Dubitzky</senderName><senderEmail>dubi@il.ibm.com</senderEmail><timestampReceived>2011-02-15 07:52:51-0400</timestampReceived><subject>[libvirt-users] monitiring cpu usage via cgroup</subject><body>

Hi

I was asking about the fedora 14 kernel if it is good enough for cgroup 
usage because 
I am trying to set a cgroup  under  cpu subsytem ( /dev/cgroup/cpu/group1/ 
) that have   /cpu.rt_runtime_us of 100000
while cpu.rt_period_us has a value of 1000000 i.e a ratio of 1/10 . still 
when I run a task (endless loop) in that group
(cgexec -g cpu,cpuset:group1 ./test)  it gets all the cpu core time that 
is assigned to it ( i watch via top utility)  , so it seems
that the quota set via the group does not take effect although I restart 
the cgconfig service .
I also verified   libcgroup is installed by:  rpm -q libcgroup

Am I missing something or top is not the right utility to  watch the cpu 
usage in this case ?

thanks

Zvi Dubitzky 
Email:dubi@il.ibm.com


</body></email><email><emailId>20110214083756</emailId><senderName>seven</senderName><senderEmail>lingjie@gyyx.cn</senderEmail><timestampReceived>2011-02-14 08:37:56-0400</timestampReceived><subject>[libvirt-users] Use libvirt-python to attach cdrom</subject><body>

Hi all,

I want to attach cdrom by libvirt.py .But can't find a func in
libvirt.py can finish this work.

Who can help me ?

Regard


-- 
Seven Ling
E-mail: jiejie.ling@qq.com


</body></email><email><emailId>20110208152916</emailId><senderName>Berend Dekens</senderName><senderEmail>berend@cyberwizzard.nl</senderEmail><timestampReceived>2011-02-08 15:29:16-0400</timestampReceived><subject>[libvirt-users] Clarification about virsh migration options</subject><body>

I am trying to work out what all the options are for migrating a KVM
machine to another KVM machine, without using shared storage. The
documentation is not quite verbose and not intuitive, so I'm hoping
someone can explain this to me. The man pages show this syntax:

migrate optional --live --p2p --direct --tunnelled --persistent
--undefinesource --suspend --copy-storage-all --copy-storage-inc
domain-id desturi migrateuri dname

The 'live' and 'suspend' options are clear. The 'undefinesource' option
is straightforward as well.

But what does 'persistent' mean? I mean, when transferring a VM to a
destination, it will be available on the destination when migration
completes, so what does 'persistent' mean in this context?

The p2p, direct and tunneled options are not. When migrating, I assume
it is possible to let the underlying virtualisation framework handle the
migration - so I assume 'direct' means Qemu-KVM gets to migrate the VM
and 'tunneled' means the RPC mechanism of libvirt migrates the machine.
But what does 'p2p' mean? Normally, peer-to-peer implies direct
communication, but since there is a 'direct' mode, I'm clueless what
this option does.

On a side note: is it possible to use tunneled mode to transfer VMs from
for example Xen to KVM?

Then I have some questions about the non-shared storage migration. I
really like this option as most of my virtualized servers are run on one
or two physical systems without shared VM storage. Migrating those VMs
without downtime would be awesome.

If I migrate the VMs, I assume the storage of the VM is places in the
libvirt default storage location. But what is the difference between
'copy-storage-all' and 'copy-storage-inc'? Incremental hints that it
would save incremental changes without actually transferring the storage
between hosts. But how is that possible if the storage was not shared in
the first place?

Lots of questions but I hope someone who has done this before can answer
some of these things.

Regards,
Berend Dekens

</body></email><email><emailId>20110211100446</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-02-11 10:04:46-0400</timestampReceived><subject>Re: [libvirt-users] Clarification about virsh migration options</subject><body>

于 2011年02月08日 23:29, Berend Dekens 写道:
&gt; I am trying to work out what all the options are for migrating a KVM
&gt; machine to another KVM machine, without using shared storage. The
&gt; documentation is not quite verbose and not intuitive, so I'm hoping
&gt; someone can explain this to me. The man pages show this syntax:
&gt;
&gt; migrate optional --live --p2p --direct --tunnelled --persistent
&gt; --undefinesource --suspend --copy-storage-all --copy-storage-inc
&gt; domain-id desturi migrateuri dname
&gt;
&gt; The 'live' and 'suspend' options are clear. The 'undefinesource' option
&gt; is straightforward as well.
&gt;
&gt; But what does 'persistent' mean? I mean, when transferring a VM to a
&gt; destination, it will be available on the destination when migration
&gt; completes, so what does 'persistent' mean in this context?

It means the domain conf will be saved on your disk, e.g.
/etc/libvirt/qemu/$domain.xml. Without specifying it, your
domain will be disappear after destroying, that means your
domain is transicient, opposite meaning of persistent.

&gt;
&gt; The p2p, direct and tunneled options are not. When migrating, I assume
&gt; it is possible to let the underlying virtualisation framework handle the
&gt; migration - so I assume 'direct' means Qemu-KVM gets to migrate the VM
&gt; and 'tunneled' means the RPC mechanism of libvirt migrates the machine.
&gt; But what does 'p2p' mean? Normally, peer-to-peer implies direct
&gt; communication, but since there is a 'direct' mode, I'm clueless what
&gt; this option does.

It's a mess, though I known something about it, but can't explain it
very well, leaving it to others who has good knownledge of it.. :-)

&gt;
&gt; On a side note: is it possible to use tunneled mode to transfer VMs from
&gt; for example Xen to KVM?
&gt;

No, xen doesn't support tunneled and peer2peer migration.

&gt; Then I have some questions about the non-shared storage migration. I
&gt; really like this option as most of my virtualized servers are run on one
&gt; or two physical systems without shared VM storage. Migrating those VMs
&gt; without downtime would be awesome.
&gt;
&gt; If I migrate the VMs, I assume the storage of the VM is places in the
&gt; libvirt default storage location. But what is the difference between
&gt; 'copy-storage-all' and 'copy-storage-inc'? Incremental hints that it
&gt; would save incremental changes without actually transferring the storage
&gt; between hosts. But how is that possible if the storage was not shared in
&gt; the first place?

The incremental migration requires you have the image on destination
host for the domain. e.g. assume you need to migrate the domains from
time to time, then only the first time need "copy-storage-all".

Regards
Osier

</body></email><email><emailId>20110212084110</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-02-12 08:41:10-0400</timestampReceived><subject>Re: [libvirt-users] Clarification about virsh migration options</subject><body>

On 11/02/2011, at 9:04 PM, Osier Yang wrote:
&lt;snip&gt;
&gt; 
&gt;&gt; But what does 'persistent' mean? I mean, when transferring a VM to a
&gt;&gt; destination, it will be available on the destination when migration
&gt;&gt; completes, so what does 'persistent' mean in this context?
&gt; 
&gt; It means the domain conf will be saved on your disk, e.g.
&gt; /etc/libvirt/qemu/$domain.xml. Without specifying it, your
&gt; domain will be disappear after destroying, that means your
&gt; domain is transicient, opposite meaning of persistent.

This might help explain the difference as well:

  http://wiki.libvirt.org/page/VM_lifecycle#Transient_guest_domains_vs_Persistent_guest_domains

There is also migration info on that page, but it's fairly basic so
not sure how useful.  Worth checking, just in case though. :)

Regards and best wishes,

Justin Clift

</body></email><email><emailId>20110215051946</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-02-15 05:19:46-0400</timestampReceived><subject>Re: [libvirt-users] Use libvirt-python to attach cdrom</subject><body>

于 2011年02月14日 16:37, seven 写道:
&gt; Hi all,
&gt;
&gt; I want to attach cdrom by libvirt.py .But can't find a func in
&gt; libvirt.py can finish this work.
&gt;
&gt; Who can help me ?
&gt;
&gt; Regard
&gt;
&gt;

# python
 &gt;&gt;&gt; import libvirt
 &gt;&gt;&gt; conn = libvirt.open('qemu:///system')
 &gt;&gt;&gt; dom = conn.lookupByName('f14')
 &gt;&gt;&gt; dir(dom)
['ID', 'OSType', 'UUID', 'UUIDString', 'XMLDesc', '__del__', '__doc__', 
'__init__', '__module__', '_conn', '_o', 'abortJob', 'attachDevice', 
'attachDeviceFlags', 'autostart', 'blockInfo', 'blockPeek', 
'blockStats', 'connect', 'coreDump', 'create', 'createWithFlags', 
'destroy', 'detachDevice', 'detachDeviceFlags', 'hasCurrentSnapshot', 
'hasManagedSaveImage', 'info', 'interfaceStats', 'isActive', 
'isPersistent', 'isUpdated', 'jobInfo', 'managedSave', 
'managedSaveRemove', 'maxMemory', 'maxVcpus', 'memoryParameters', 
'memoryPeek', 'memoryStats', 'migrate', 'migrateSetMaxDowntime', 
'migrateToURI', 'name', 'openConsole', 'pinVcpu', 'reboot', 'resume', 
'revertToSnapshot', 'save', 'schedulerParameters', 'schedulerType', 
'setAutostart', 'setMaxMemory', 'setMemory', 'setMemoryParameters', 
'setSchedulerParameters', 'setVcpus', 'setVcpusFlags', 'shutdown', 
'snapshotCreateXML', 'snapshotCurrent', 'snapshotListNames', 
'snapshotLookupByName', 'snapshotNum', 'suspend', 'undefine', 
'updateDeviceFlags', 'vcpus', 'vcpusFlags']
 &gt;&gt;&gt;

see "attachDevice", "attachDeviceFlags", and "updateDeviceFlags", (in
case of your guest already has CDROM device).

to get how to use them:

 &gt;&gt;&gt; help(dom.attachDevice)

Regards
Osier

</body></email><email><emailId>20110216032041</emailId><senderName>seven</senderName><senderEmail>lingjie@gyyx.cn</senderEmail><timestampReceived>2011-02-16 03:20:41-0400</timestampReceived><subject>Re: [libvirt-users] Use libvirt-python to attach cdrom</subject><body>

Osier Yang &lt;jyang@...&gt; writes:

&gt; 
&gt; 于 2011年02月14日 16:37, seven 写道:
&gt; &gt; Hi all,
&gt; &gt;
&gt; &gt; I want to attach cdrom by libvirt.py .But can't find a func in
&gt; &gt; libvirt.py can finish this work.
&gt; &gt;
&gt; &gt; Who can help me ?
&gt; &gt;
&gt; &gt; Regard
&gt; &gt;
&gt; &gt;
&gt; 
&gt; # python
&gt;  &gt;&gt;&gt; import libvirt
&gt;  &gt;&gt;&gt; conn = libvirt.open('qemu:///system')
&gt;  &gt;&gt;&gt; dom = conn.lookupByName('f14')
&gt;  &gt;&gt;&gt; dir(dom)
&gt; ['ID', 'OSType', 'UUID', 'UUIDString', 'XMLDesc', '__del__', '__doc__', 
&gt; '__init__', '__module__', '_conn', '_o', 'abortJob', 'attachDevice', 
&gt; 'attachDeviceFlags', 'autostart', 'blockInfo', 'blockPeek', 
&gt; 'blockStats', 'connect', 'coreDump', 'create', 'createWithFlags', 
&gt; 'destroy', 'detachDevice', 'detachDeviceFlags', 'hasCurrentSnapshot', 
&gt; 'hasManagedSaveImage', 'info', 'interfaceStats', 'isActive', 
&gt; 'isPersistent', 'isUpdated', 'jobInfo', 'managedSave', 
&gt; 'managedSaveRemove', 'maxMemory', 'maxVcpus', 'memoryParameters', 
&gt; 'memoryPeek', 'memoryStats', 'migrate', 'migrateSetMaxDowntime', 
&gt; 'migrateToURI', 'name', 'openConsole', 'pinVcpu', 'reboot', 'resume', 
&gt; 'revertToSnapshot', 'save', 'schedulerParameters', 'schedulerType', 
&gt; 'setAutostart', 'setMaxMemory', 'setMemory', 'setMemoryParameters', 
&gt; 'setSchedulerParameters', 'setVcpus', 'setVcpusFlags', 'shutdown', 
&gt; 'snapshotCreateXML', 'snapshotCurrent', 'snapshotListNames', 
&gt; 'snapshotLookupByName', 'snapshotNum', 'suspend', 'undefine', 
&gt; 'updateDeviceFlags', 'vcpus', 'vcpusFlags']
&gt;  &gt;&gt;&gt;
&gt; 
&gt; see "attachDevice", "attachDeviceFlags", and "updateDeviceFlags", (in
&gt; case of your guest already has CDROM device).
&gt; 
&gt; to get how to use them:
&gt; 
&gt;  &gt;&gt;&gt; help(dom.attachDevice)
&gt; 
&gt; Regards
&gt; Osier
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users &lt;at&gt; redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

--------------------------__

I'm sorry that I as you do,but I don't find the "attachDeviceFlags" and 
"updateDeviceFlags"

&gt;&gt;&gt; dir(dom)
['ID', 'OSType', 'UUID', 'UUIDString', 'XMLDesc', '__del__', '__doc__', 
'__init__', '__module__', '_conn', '_o', 'attachDevice', 'autostart', 
'blockPeek', 'blockStats', 'connect', 'coreDump', 'create', 'destroy', 
'detachDevice', 'info', 'interfaceStats', 'maxMemory', 'maxVcpus', 'memoryPeek', 
'migrate', 'name', 'pinVcpu', 'reboot', 'ref', 'resume', 'save', 
'schedulerParameters', 'schedulerType', 'setAutostart', 'setMaxMemory', 
'setMemory', 'setSchedulerParameters', 'setVcpus', 'shutdown', 'suspend', 
'undefine', 'vcpus']

I think this is the version of the problem . My libvir.py's version is 0.6.3

And when I use "attachDevice" to attach cdrom , I get "no wrong"(return value is 
"0"),but the vm not find the cdrom.

Regards
Seven
 


</body></email><email><emailId>20110215080557</emailId><senderName>KAMEZAWA Hiroyuki</senderName><senderEmail>kamezawa.hiroyu@jp.fujitsu.com</senderEmail><timestampReceived>2011-02-15 08:05:57-0400</timestampReceived><subject>Re: [libvirt-users] monitiring cpu usage via cgroup</subject><body>

On Tue, 15 Feb 2011 09:52:51 +0200
Zvi Dubitzky &lt;DUBI@il.ibm.com&gt; wrote:

&gt; Hi
&gt; 
&gt; I was asking about the fedora 14 kernel if it is good enough for cgroup 
&gt; usage because 
&gt; I am trying to set a cgroup  under  cpu subsytem ( /dev/cgroup/cpu/group1/ 
&gt; ) that have   /cpu.rt_runtime_us of 100000
&gt; while cpu.rt_period_us has a value of 1000000 i.e a ratio of 1/10 . still 
&gt; when I run a task (endless loop) in that group
&gt; (cgexec -g cpu,cpuset:group1 ./test)  it gets all the cpu core time that 
&gt; is assigned to it ( i watch via top utility)  , so it seems
&gt; that the quota set via the group does not take effect although I restart 
&gt; the cgconfig service .
&gt; I also verified   libcgroup is installed by:  rpm -q libcgroup
&gt; 
&gt; Am I missing something or top is not the right utility to  watch the cpu 
&gt; usage in this case ?
&gt; 

rt_runtime_us and rt_period_us are parameters for handling realtime class
(SCHED_RR, SCHED_FIFO) applications. Does your 'test' run in which priority ?
(see sched_setscheduler())


Thanks,
-Kame

&gt; thanks
&gt; 
&gt; Zvi Dubitzky 
&gt; Email:dubi@il.ibm.com
&gt; 
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; 

</body></email><email><emailId>20110212050723</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-02-12 05:07:23-0400</timestampReceived><subject>Re: [libvirt-users] Using NFS to read image file</subject><body>

于 2011年02月11日 18:31, Marcela Castro León 写道:
&gt;
&gt; Hello:
&gt; When I start the guest with an image on NFS file system, the ubuntu
&gt; doesn't boot, It's remain on inittrams.
&gt; I've tried to redefine the guest without
&gt; &lt;apic&gt;
&gt; &lt;pae&gt;
&gt; configuration as I see on a blog, and I've increased the parameters of
&gt; the mount to rsize=32768 and wsize=32768, but it still doesn't work.
&gt; Can anyone give any advice to get it?
&gt; Thank you very much.

Do you have any useful log? e.g. /var/log/messages, which is the default
log location for libvirtd. and /var/log/libvirt/qemu/$guest.log, perhaps
some useful log of you guest is printed there.

Regards
Osier
&gt;
&gt; Marcela
&gt;
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110211094509</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-02-11 09:45:09-0400</timestampReceived><subject>Re: [libvirt-users] Start domain with usable QMP connection?</subject><body>

于 2011年02月11日 07:54, Bryan D. Payne 写道:
&gt; Is there any way to get virsh / libvirt to create a domain such that I
&gt; can later connect to it via QMP (without hacking the code)?
&gt; 
&gt; The command line that libvirt creates for my current setup looks like this:
&gt; 
&gt; /usr/local/bin/qemu-system-x86_64 -S -M pc-0.12 -enable-kvm -m 512
&gt; -smp 1,sockets=1,cores=1,threads=1 -name winxpsp2 -uuid
&gt; ab244939-c804-1aff-68b6-9324f174c3c8 -nodefconfig -nodefaults -chardev
&gt; socket,id=monitor,path=/usr/local/var/lib/libvirt/qemu/winxpsp2.monitor,server,nowait
&gt;                 
&gt; -mon chardev=monitor,mode=control -rtc base=localtime -boot c -drive
&gt; file=/var/lib/libvirt/images/winxpsp2.img,if=none,id=drive-ide0-0-0,format=raw
&gt; -device ide-drive,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0
&gt; -drive file=/home/username/iso/en_winxp_pro_with_sp2.iso,if=none,media=cdrom,id=drive-ide0-1-0,readonly=on,format=raw
&gt;                 
&gt; -device ide-drive,bus=ide.1,unit=0,drive=drive-ide0-1-0,id=ide0-1-0
&gt; -netdev tap,fd=16,id=hostnet0 -device
&gt; rtl8139,netdev=hostnet0,id=net0,mac=52:54:00:4d:1d:1b,bus=pci.0,addr=0x3
&gt; -chardev pty,id=serial0 -device isa-serial,chardev=serial0 -usb
&gt; -device usb-tablet,id=input0 -vnc 127.0.0.1:0 -k en-us -vga std
&gt; -device ES1370,id=sound0,bus=pci.0,addr=0x4 -device
&gt; virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x5
&gt; 
&gt; The important pieces of this command line (I believe) are:
&gt; 
&gt; -chardev socket,id=monitor,path=/usr/local/var/lib/libvirt/qemu/winxpsp2.monitor,server,nowait
&gt;                 
&gt; -mon chardev=monitor,mode=control
&gt; 
&gt; However, I'm unable to connect using this path because -- I'm guessing
&gt; -- libvirt has already connected.  As a test, I added some code to
&gt; src/qemu/qemu_command.c to open a second chardev.  My new command line
&gt; looks like this:
&gt; 
&gt; /usr/local/bin/qemu-system-x86_64 -S -M pc-0.12 -enable-kvm -m 512
&gt; -smp 1,sockets=1,cores=1,threads=1 -name winxpsp2 -uuid
&gt; ab244939-c804-1aff-68b6-9324f174c3c8 -nodefconfig -nodefaults -chardev
&gt; socket,id=monitor,path=/usr/local/var/lib/libvirt/qemu/winxpsp2.monitor,server,nowait
&gt;                 
&gt; -mon chardev=monitor,mode=control -chardev
&gt; socket,id=qmpmonitor,path=/usr/local/var/lib/libvirt/qemu/winxpsp2.qmpmonitor,server,nowait
&gt;                 
&gt; -mon chardev=qmpmonitor,mode=control -rtc base=localtime -boot c
&gt; -drive file=/var/lib/libvirt/images/winxpsp2.img,if=none,id=drive-ide0-0-0,format=raw
&gt;                 
&gt; -device ide-drive,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0
&gt; -drive file=/home/username/iso/en_winxp_pro_with_sp2.iso,if=none,media=cdrom,id=drive-ide0-1-0,readonly=on,format=raw
&gt;                 
&gt; -device ide-drive,bus=ide.1,unit=0,drive=drive-ide0-1-0,id=ide0-1-0
&gt; -netdev tap,fd=15,id=hostnet0 -device
&gt; rtl8139,netdev=hostnet0,id=net0,mac=52:54:00:4d:1d:1b,bus=pci.0,addr=0x3
&gt; -chardev pty,id=serial0 -device isa-serial,chardev=serial0 -usb
&gt; -device usb-tablet,id=input0 -vnc 127.0.0.1:0 -k en-us -vga std
&gt; -device ES1370,id=sound0,bus=pci.0,addr=0x4 -device
&gt; virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x5
&gt; 
&gt; Notice that there are now two chardevs:
&gt; 
&gt; -chardev socket,id=monitor,path=/usr/local/var/lib/libvirt/qemu/winxpsp2.monitor,server,nowait
&gt;                 
&gt; -mon chardev=monitor,mode=control
&gt; 
&gt; -chardev socket,id=qmpmonitor,path=/usr/local/var/lib/libvirt/qemu/winxpsp2.qmpmonitor,server,nowait
&gt;                 
&gt; -mon chardev=qmpmonitor,mode=control
&gt; 
&gt; As expected, I am able to connect to this second chardev via QMP.  Is
&gt; there anyway that I can enable such functionality in libvirt without
&gt; hacking the code?
&gt; 

Though it's not that convenient as you have a independant monitor to 
talk directly, you could use "qemu-monitor-command" of communicate
with the qemu monitor. And with the latest qemu, which supports monitor
command "human-monitor-command", it's more compact, e.g.

# virsh qemu-monitor-command --hmp test "info kvm"

Regards
Osier


</body></email><email><emailId>20110212035231</emailId><senderName>Nirmal Guhan</senderName><senderEmail>vavatutu@gmail.com</senderEmail><timestampReceived>2011-02-12 03:52:31-0400</timestampReceived><subject>[libvirt-users] LXC libvirt support</subject><body>

Hi,

Has anyone used libvirt to start/stop/manage LXC (linux containers) ?
Is it supported at all? Last I tried, had few issues and the reply was
:

///
Note that libvirt lxc driver is a different implementation from lxc tools
and doesn't use lxc tools internally. You may not be able to do what
you are doing with lxc tools. Especially, the driver doesn't take aware
of files and settings inside a container at all. You have to prepare them
by yourself in advance
///
Is it still the case?

~nirmal

</body></email><email><emailId>20110212050502</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-02-12 05:05:02-0400</timestampReceived><subject>Re: [libvirt-users] LXC libvirt support</subject><body>

于 2011年02月12日 11:52, Nirmal Guhan 写道:
&gt; Hi,
&gt;
&gt; Has anyone used libvirt to start/stop/manage LXC (linux containers) ?
&gt; Is it supported at all? Last I tried, had few issues and the reply was
&gt; :

Yes, it's supported, though still much work to do, but the basic is
there.

&gt;
&gt; ///
&gt; Note that libvirt lxc driver is a different implementation from lxc tools
&gt; and doesn't use lxc tools internally.

Indeed, it doesn't invoke lxc tools.

You may not be able to do what
&gt; you are doing with lxc tools. Especially, the driver doesn't take aware
&gt; of files and settings inside a container at all. You have to prepare them
&gt; by yourself in advance

libvirt.org has the example, e.g. the busybox example, I guess it could
explain "the driver doesn't take care of files and setting inside a
container at all, you have to prepare them by yourself in advance."

Regards
Osier

</body></email><email><emailId>20110218014743</emailId><senderName>Nirmal Guhan</senderName><senderEmail>vavatutu@gmail.com</senderEmail><timestampReceived>2011-02-18 01:47:43-0400</timestampReceived><subject>Re: [libvirt-users] LXC libvirt support</subject><body>

2011/2/11 Nirmal Guhan &lt;vavatutu@gmail.com&gt;:
&gt; On Fri, Feb 11, 2011 at 9:05 PM, Osier Yang &lt;jyang@redhat.com&gt; wrote:
&gt;&gt; ÓÚ 2011Äê02Ô 12ÈÕ 11:52, Nirmal Guhan Ð´µÀ:
&gt;&gt;&gt;
&gt;&gt;&gt; Hi,
&gt;&gt;&gt;
&gt;&gt;&gt; Has anyone used libvirt to start/stop/manage LXC (linux containers) ?
&gt;&gt;&gt; Is it supported at all? Last I tried, had few issues and the reply was
&gt;&gt;&gt; :
&gt;&gt;
&gt;&gt; Yes, it's supported, though still much work to do, but the basic is
&gt;&gt; there.
&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; ///
&gt;&gt;&gt; Note that libvirt lxc driver is a different implementation from lxc tools
&gt;&gt;&gt; and doesn't use lxc tools internally.
&gt;&gt;
&gt;&gt; Indeed, it doesn't invoke lxc tools.
&gt;&gt;
&gt;&gt; You may not be able to do what
&gt;&gt;&gt;
&gt;&gt;&gt; you are doing with lxc tools. Especially, the driver doesn't take aware
&gt;&gt;&gt; of files and settings inside a container at all. You have to prepare them
&gt;&gt;&gt; by yourself in advance
&gt;&gt;
&gt;&gt; libvirt.org has the example, e.g. the busybox example, I guess it could
&gt;&gt; explain "the driver doesn't take care of files and setting inside a
&gt;&gt; container at all, you have to prepare them by yourself in advance."
&gt;&gt;
&gt;&gt; Regards
&gt;&gt; Osier
&gt;
&gt; Thanks. Will give a try.
&gt; ~nirmal
&gt;
Seeing some strange behavior running fedora 12 for both host and lxc container.
I do a define, start and console :

[root@fedora12new lxc-libvirt-scripts]# virsh -c lxc:// console testf12new
Connected to domain testf12new
Escape character is ^]
--&gt; I press enter here and virsh exits.

I don't get login prompt always. Sometimes I do and when I try to
login it rejects my password. Apparently, the same rootfs works fine
with lxc tools and I can login.

Snippet from  etc/event.d/tty1 :
respawn
exec /sbin/mingetty pts/0

I use "exec /sbin/mingetty tty1" for lxc tools and that works fine. I
had to try pts/0 for libvirt since tty1 does not even get me the
occasional login prompts I get with pts.

Also even after virsh shutdown, I see that the container processes do
not exit. Is there something else I should do?

~nirmal

</body></email><email><emailId>20110218101754</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-02-18 10:17:54-0400</timestampReceived><subject>Re: [libvirt-users] LXC libvirt support</subject><body>

On Thu, Feb 17, 2011 at 05:47:43PM -0800, Nirmal Guhan wrote:
&gt; 2011/2/11 Nirmal Guhan &lt;vavatutu@gmail.com&gt;:
&gt; &gt; On Fri, Feb 11, 2011 at 9:05 PM, Osier Yang &lt;jyang@redhat.com&gt; wrote:
&gt; &gt;&gt; 于 2011年02月12日 11:52, Nirmal Guhan 写道:
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; Hi,
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; Has anyone used libvirt to start/stop/manage LXC (linux containers) ?
&gt; &gt;&gt;&gt; Is it supported at all? Last I tried, had few issues and the reply was
&gt; &gt;&gt;&gt; :
&gt; &gt;&gt;
&gt; &gt;&gt; Yes, it's supported, though still much work to do, but the basic is
&gt; &gt;&gt; there.
&gt; &gt;&gt;
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; ///
&gt; &gt;&gt;&gt; Note that libvirt lxc driver is a different implementation from lxc tools
&gt; &gt;&gt;&gt; and doesn't use lxc tools internally.
&gt; &gt;&gt;
&gt; &gt;&gt; Indeed, it doesn't invoke lxc tools.
&gt; &gt;&gt;
&gt; &gt;&gt; You may not be able to do what
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; you are doing with lxc tools. Especially, the driver doesn't take aware
&gt; &gt;&gt;&gt; of files and settings inside a container at all. You have to prepare them
&gt; &gt;&gt;&gt; by yourself in advance
&gt; &gt;&gt;
&gt; &gt;&gt; libvirt.org has the example, e.g. the busybox example, I guess it could
&gt; &gt;&gt; explain "the driver doesn't take care of files and setting inside a
&gt; &gt;&gt; container at all, you have to prepare them by yourself in advance."
&gt; &gt;&gt;
&gt; &gt;&gt; Regards
&gt; &gt;&gt; Osier
&gt; &gt;
&gt; &gt; Thanks. Will give a try.
&gt; &gt; ~nirmal
&gt; &gt;
&gt; Seeing some strange behavior running fedora 12 for both host and lxc container.
&gt; I do a define, start and console :
&gt; 
&gt; [root@fedora12new lxc-libvirt-scripts]# virsh -c lxc:// console testf12new
&gt; Connected to domain testf12new
&gt; Escape character is ^]
&gt; --&gt; I press enter here and virsh exits.
&gt; 
&gt; I don't get login prompt always. Sometimes I do and when I try to
&gt; login it rejects my password. Apparently, the same rootfs works fine
&gt; with lxc tools and I can login.

There are likely multiple problems here.  The issue where virsh exits
is a bug in libvirts LXC console handling. During Fedora startup
the init process will close &amp; reopen the primary console. If libvirt
notices this happen then it'll think the close is a shutdown and
exit. I need to rewrite console handling to make this reliable.

Rejecting the login is likely a configuration issue - perhaps a
missing securetty entry, but also PAM has various things that
relate to selinux / audit that don't work within a container and
need to be removed - sadly i can't remember just which ones offhand,
but try removing items from the PAM configs.

&gt; Snippet from  etc/event.d/tty1 :
&gt; respawn
&gt; exec /sbin/mingetty pts/0
&gt; 
&gt; I use "exec /sbin/mingetty tty1" for lxc tools and that works fine. I
&gt; had to try pts/0 for libvirt since tty1 does not even get me the
&gt; occasional login prompts I get with pts.
&gt; 
&gt; Also even after virsh shutdown, I see that the container processes do
&gt; not exit. Is there something else I should do?

This 'virsh shutdown' is requesting a graceful shutdown - guests aren't
required to honour this request. virsh detroy is the failsafe

Regards,
Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110211094742</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-02-11 09:47:42-0400</timestampReceived><subject>Re: [libvirt-users] Start domain with usable QMP connection?</subject><body>

By the way, the patch of shortcut for HMP passthrough is very
recent.

commit 2169472ab6cac3bdb1f32578de2b608a61a1d703
Author: Jiri Denemark &lt;jdenemar@redhat.com&gt;
Date:   Wed Feb 2 16:37:10 2011 +0100

Make sure you have it supported.. ;-)

Regards
Osier
于 2011年02月11日 07:54, Bryan D. Payne 写道:
&gt; Is there any way to get virsh / libvirt to create a domain such that I
&gt; can later connect to it via QMP (without hacking the code)?
&gt; 
&gt; The command line that libvirt creates for my current setup looks like this:
&gt; 
&gt; /usr/local/bin/qemu-system-x86_64 -S -M pc-0.12 -enable-kvm -m 512
&gt; -smp 1,sockets=1,cores=1,threads=1 -name winxpsp2 -uuid
&gt; ab244939-c804-1aff-68b6-9324f174c3c8 -nodefconfig -nodefaults -chardev
&gt; socket,id=monitor,path=/usr/local/var/lib/libvirt/qemu/winxpsp2.monitor,server,nowait
&gt;                 
&gt; -mon chardev=monitor,mode=control -rtc base=localtime -boot c -drive
&gt; file=/var/lib/libvirt/images/winxpsp2.img,if=none,id=drive-ide0-0-0,format=raw
&gt; -device ide-drive,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0
&gt; -drive file=/home/username/iso/en_winxp_pro_with_sp2.iso,if=none,media=cdrom,id=drive-ide0-1-0,readonly=on,format=raw
&gt;                 
&gt; -device ide-drive,bus=ide.1,unit=0,drive=drive-ide0-1-0,id=ide0-1-0
&gt; -netdev tap,fd=16,id=hostnet0 -device
&gt; rtl8139,netdev=hostnet0,id=net0,mac=52:54:00:4d:1d:1b,bus=pci.0,addr=0x3
&gt; -chardev pty,id=serial0 -device isa-serial,chardev=serial0 -usb
&gt; -device usb-tablet,id=input0 -vnc 127.0.0.1:0 -k en-us -vga std
&gt; -device ES1370,id=sound0,bus=pci.0,addr=0x4 -device
&gt; virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x5
&gt; 
&gt; The important pieces of this command line (I believe) are:
&gt; 
&gt; -chardev socket,id=monitor,path=/usr/local/var/lib/libvirt/qemu/winxpsp2.monitor,server,nowait
&gt;                 
&gt; -mon chardev=monitor,mode=control
&gt; 
&gt; However, I'm unable to connect using this path because -- I'm guessing
&gt; -- libvirt has already connected.  As a test, I added some code to
&gt; src/qemu/qemu_command.c to open a second chardev.  My new command line
&gt; looks like this:
&gt; 
&gt; /usr/local/bin/qemu-system-x86_64 -S -M pc-0.12 -enable-kvm -m 512
&gt; -smp 1,sockets=1,cores=1,threads=1 -name winxpsp2 -uuid
&gt; ab244939-c804-1aff-68b6-9324f174c3c8 -nodefconfig -nodefaults -chardev
&gt; socket,id=monitor,path=/usr/local/var/lib/libvirt/qemu/winxpsp2.monitor,server,nowait
&gt;                 
&gt; -mon chardev=monitor,mode=control -chardev
&gt; socket,id=qmpmonitor,path=/usr/local/var/lib/libvirt/qemu/winxpsp2.qmpmonitor,server,nowait
&gt;                 
&gt; -mon chardev=qmpmonitor,mode=control -rtc base=localtime -boot c
&gt; -drive file=/var/lib/libvirt/images/winxpsp2.img,if=none,id=drive-ide0-0-0,format=raw
&gt;                 
&gt; -device ide-drive,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0
&gt; -drive file=/home/username/iso/en_winxp_pro_with_sp2.iso,if=none,media=cdrom,id=drive-ide0-1-0,readonly=on,format=raw
&gt;                 
&gt; -device ide-drive,bus=ide.1,unit=0,drive=drive-ide0-1-0,id=ide0-1-0
&gt; -netdev tap,fd=15,id=hostnet0 -device
&gt; rtl8139,netdev=hostnet0,id=net0,mac=52:54:00:4d:1d:1b,bus=pci.0,addr=0x3
&gt; -chardev pty,id=serial0 -device isa-serial,chardev=serial0 -usb
&gt; -device usb-tablet,id=input0 -vnc 127.0.0.1:0 -k en-us -vga std
&gt; -device ES1370,id=sound0,bus=pci.0,addr=0x4 -device
&gt; virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x5
&gt; 
&gt; Notice that there are now two chardevs:
&gt; 
&gt; -chardev socket,id=monitor,path=/usr/local/var/lib/libvirt/qemu/winxpsp2.monitor,server,nowait
&gt;                 
&gt; -mon chardev=monitor,mode=control
&gt; 
&gt; -chardev socket,id=qmpmonitor,path=/usr/local/var/lib/libvirt/qemu/winxpsp2.qmpmonitor,server,nowait
&gt;                 
&gt; -mon chardev=qmpmonitor,mode=control
&gt; 
&gt; As expected, I am able to connect to this second chardev via QMP.  Is
&gt; there anyway that I can enable such functionality in libvirt without
&gt; hacking the code?
&gt; 
&gt; Thanks,
&gt; bryan
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users


</body></email><email><emailId>20110211102619</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-02-11 10:26:19-0400</timestampReceived><subject>Re: [libvirt-users] Not able to capture detailed CPU information of the guest machine using Libvirt </subject><body>

于 2011年02月11日 15:29, arpita k 写道:
&gt; Hi ,
&gt;
&gt; I have two KVM guests in ubuntu host machine.I am using Python binding
&gt; of Libvirt API to query on the hypervisor and capture the CPU , memory
&gt; related information of the guest machines.
&gt;
&gt; I need to capture the detail information regarding CPU like : cpu_aidle,
&gt; cpu_idle, cpu_speed, cpu_wio and memory like
&gt; :mem_cached,mem_buffers,mem_free etc. of the guest machines.
&gt;
&gt; How could I get these information?

You ask more than what libvirt could provide. :-)

Guess libguest will help you get what you want. (directly execute
commands on it, and then parse the returned information? )

http://libguestfs.org

Regards
Osier

</body></email><email><emailId>20110210135025</emailId><senderName>Tanguy ROZIER</senderName><senderEmail>tanguy@rozier.eu</senderEmail><timestampReceived>2011-02-10 13:50:25-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt] configuring network interface</subject><body>

Your problem is related to udev : every reboot of VM, udev in VM
checks the MAC address of the ethernet interface of the system to
associate it with a static name (eth0, eth1...).
If you change the MAC address of the Ethernet interface of your VM, it
will detect a new interface and associate it with a new name (ethx+1).
In order to avoid it :
try not to change the MAC address of your VM ethernet device (you can
fix it with libvirt xml),
or deactivate this mecanism in the VM : search in
/etc/udev/rules.d/70-persistent-net.rules : it calls
/lib/udev/write_net_rules at every reboot, you could chmod -x this
script in order to avoid it.

Tanguy

2011/2/10 Marcela Castro León &lt;mcastrol@gmail.com&gt;:
&gt; Hello Laine:
&gt; I've revised the configuration and followed all your instructions.
&gt; I'll try to give you a better explain of my problem.
&gt;
&gt; a) I need a bridged (3) configuration, because I have to connect the guests
&gt; from each others. (via ssh and execute mpi). I've three hosts, each of one
&gt; has at least a guest.
&gt; I'll only explain about the configuration of one of them, because the
&gt; problem is only related a one configuration.
&gt; hostname=rionegro  ip=192.168.1.4
&gt; guest-name=rnompi1
&gt;
&gt; b) I've configured host bridge following step by step ther instruction on
&gt; http://wiki.libvirt.org/page/Networking
&gt; this is the /etc/network/config
&gt;
&gt; # The loopback network interface
&gt; auto lo
&gt; iface lo inet loopback
&gt;
&gt;
&gt; auto br0
&gt; iface br0 inet static
&gt; address 192.168.1.4
&gt; netmask 255.255.255.0
&gt; network 192.168.1.0
&gt; broadcast 192.168.1.255
&gt; gateway 192.168.1.10
&gt; bridge_ports eth0
&gt; bridge_stp on
&gt; bridge_fd 0
&gt; bridge_maxwait 0
&gt;
&gt; c) this is the xml guest configuration related to the network.
&gt;
&gt;     &lt;interface type='bridge'&gt;
&gt;       &lt;source bridge='br0'/&gt;
&gt;     &lt;/interface&gt;
&gt;
&gt;
&gt; d) But the guest doesn't get any IP automatically, and create an interface
&gt; with a variable name (eth4, eth5,etch6..). I don't know how to achieve the
&gt; guest don't behave like this and create always its network interface with a
&gt; fixed name, for example, eth0).
&gt;
&gt; Why I ask that?
&gt;
&gt; if the guest created an interface with a fixed name, I would configure and
&gt; static ip for the it.
&gt; I'm attaching a printscreen "rnompi1.jpg"  that show what ifconfig ahow on
&gt; the guest (eth14 and without any IP). It doesn't get their host either.
&gt;
&gt; The only way I achieve to solve but "temporally" until reboot is configuring
&gt; the guest statically using the name of the interface that has just up.In
&gt; that case every works fine, and the guest can connect to all the other
&gt; guests on the lan and others can connect to it.
&gt; But this only works until reboot or reconfigure the guest, because each time
&gt; the name of interface change, and my configuration I had done of
&gt; /etc/network/interface didn't work any more because is related to another
&gt; interface.
&gt;
&gt; I hope I've explained better the problem I have.
&gt;
&gt; Thank you very much, you've already helped too much to better understand the
&gt; different cases of network configuration
&gt;
&gt; Regards.
&gt;
&gt;
&gt;
&gt;
&gt; 2011/2/10 Marcela Castro León &lt;mcastrol@gmail.com&gt;
&gt;&gt;
&gt;&gt; Hello Laine:
&gt;&gt; Thank you very much.
&gt;&gt; I've showed only one of the guest, each one have it's own ip address.
&gt;&gt; Anyway, I'll follow your advise of revise all the configuration after
&gt;&gt; reading the doc.
&gt;&gt; Thank you very much again.
&gt;&gt; Regards.
&gt;&gt;
&gt;&gt; 2011/2/8 Laine Stump &lt;laine@laine.org&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; (For future questions such as this, you may find you get a better
&gt;&gt;&gt; response (and lower signal-noise ratio) by asking on the recently -created
&gt;&gt;&gt; libvirt-users@redhat.com list, as libvir-list has a very large volume of
&gt;&gt;&gt; patches and discussion about the internals of libvirt)
&gt;&gt;&gt;
&gt;&gt;&gt; On 02/08/2011 12:05 PM, Marcela Castro León wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; Hello
&gt;&gt;&gt;&gt;
&gt;&gt;&gt; I've a lan of virtual machine configured with bridge. I've a private lan
&gt;&gt;&gt; of 4 machine, but one of them have 2 lan-card with access to internet.
&gt;&gt;&gt;
&gt;&gt;&gt; Evertything works almost fine, except that I've configured on each guest
&gt;&gt;&gt; the static configuration of the bridge with the ip address, like this:
&gt;&gt;&gt;
&gt;&gt;&gt; auto lo
&gt;&gt;&gt; iface lo inet loopback
&gt;&gt;&gt;
&gt;&gt;&gt; auto eth6
&gt;&gt;&gt; iface eth6 inet static
&gt;&gt;&gt; address 192.168.1.41
&gt;&gt;&gt; network 192.168.1.0
&gt;&gt;&gt; netmask 255.255.255.0
&gt;&gt;&gt; gateway 192.168.1.10
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; So are you saying that you're attempting to give each guest the *same* IP
&gt;&gt;&gt; address? There's no way that can possibly work, even if each is connected to
&gt;&gt;&gt; a separate virtual network or bridge. Since the host's IP stack can "see"
&gt;&gt;&gt; all of the guests' network traffic, regardless of the connection mode you
&gt;&gt;&gt; choose, each must have a unique IP address even if they can't see each
&gt;&gt;&gt; other.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; But each time I, for example, define the guest, it start with a ascending
&gt;&gt;&gt; number of interface: eth6,eth7, eth8, etc, Now is initializing with eth12.
&gt;&gt;&gt;
&gt;&gt;&gt; There must be a mixup in the explanation - I'm understanding that you put
&gt;&gt;&gt; the same config file in each guest, but each guest, when it starts, shows a
&gt;&gt;&gt; different ethernet interface in its ifconfig. That doesn't seem right,
&gt;&gt;&gt; because none of the guests know about each other. Or are you saying
&gt;&gt;&gt; something different? Where are you seeing the "eth6", "eth7", ... "eth12"?
&gt;&gt;&gt; In the guest XML config maybe?
&gt;&gt;&gt;
&gt;&gt;&gt; So, it doesn't get the manual configuration I've done on the
&gt;&gt;&gt; /etc/network/interfaces.
&gt;&gt;&gt; How can avoid this way of work of the number of ethernet interface the
&gt;&gt;&gt; guest start?
&gt;&gt;&gt;
&gt;&gt;&gt; Why are you doing a manual/static definition on the guest at all? It's
&gt;&gt;&gt; simpler to just leave the guest to automatically configure its eth0, and if
&gt;&gt;&gt; you really want a particular IP address for a particular guest, handle that
&gt;&gt;&gt; with a &lt;host&gt; element in the &lt;dhcp&gt; section of the virtual network the guest
&gt;&gt;&gt; is connected to (or, if you're using a pure bridging setup, then in the
&gt;&gt;&gt; static hosts config of the dhcp server on that network).
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; A way i'm trying to solve is configuring the interface trough the guest
&gt;&gt;&gt; xml definition,
&gt;&gt;&gt;
&gt;&gt;&gt; The guest xml interface configuration cannot be used to setup the IP
&gt;&gt;&gt; address, route, etc config of the guest. It is only used for two things:
&gt;&gt;&gt;
&gt;&gt;&gt; 1) configuring what kind of hardware appears on the guest (but not what
&gt;&gt;&gt; name the guest gives to it!)
&gt;&gt;&gt;
&gt;&gt;&gt; 2) configuring how that hardware is connected to the physical network
&gt;&gt;&gt; (usually either via an existing bridge interface on the host (in order for
&gt;&gt;&gt; the guest to appear as if its directly connected to the physical network),
&gt;&gt;&gt; or via a "virtual network" created by libvirt (which is really just a bridge
&gt;&gt;&gt; that's not directly connected to any physical interface, relying instead on
&gt;&gt;&gt; the host's IP stack to route packets from the guest out to the physical
&gt;&gt;&gt; network.)
&gt;&gt;&gt;
&gt;&gt;&gt; but the operation "define" on virsh accepted without error the xml i've
&gt;&gt;&gt; done, but the dumpxml doesn't show them, so, it doesn't work at all.
&gt;&gt;&gt; I've followed the instruction that said the manual "Application
&gt;&gt;&gt; development guide - a guide to application development with libvirt" on page
&gt;&gt;&gt; 71.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; That document is targeted towards software developers writing
&gt;&gt;&gt; applications to manage virtual guests using the libvirt API, not for system
&gt;&gt;&gt; administrators who are configuring virtual guests manually (or, more likely,
&gt;&gt;&gt; by using software that uses the libvirt API, eg virsh or virt-manager). It
&gt;&gt;&gt; likely contains more detail and less overview than what you need, which is
&gt;&gt;&gt; probably what led to the confusion. I've included a pointer to a wiki page
&gt;&gt;&gt; below that is more the appropriate level of information (Justin, if the docs
&gt;&gt;&gt; you were working on are somewhere easily accessible, you can point to those
&gt;&gt;&gt; instead.)
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; The whole definition of the VM is attached, but the related to interface
&gt;&gt;&gt; is:
&gt;&gt;&gt;     &lt;interface type='bridge'&gt;
&gt;&gt;&gt;       &lt;source bridge='br0'/&gt;
&gt;&gt;&gt;       &lt;target dev='vnet0'/&gt;
&gt;&gt;&gt;     &lt;protocol&gt;
&gt;&gt;&gt;         &lt;ip address="192.168.1.41" prefix="24"/&gt;
&gt;&gt;&gt;         &lt;route gateway="192.168.1.10"/&gt;
&gt;&gt;&gt;     &lt;/protocol&gt;
&gt;&gt;&gt;     &lt;bridge stp="off" delay="0.01"&gt;
&gt;&gt;&gt;     &lt;interface type="ethernet" name="eth12"&gt;
&gt;&gt;&gt;     &lt;protocol&gt;
&gt;&gt;&gt;         &lt;ip address="192.168.1.41" prefix="24"/&gt;
&gt;&gt;&gt;         &lt;route gateway="192.168.1.10"/&gt;
&gt;&gt;&gt;     &lt;/protocol&gt;
&gt;&gt;&gt;     &lt;/interface&gt;
&gt;&gt;&gt;     &lt;/bridge&gt;
&gt;&gt;&gt;     &lt;/interface&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; You are confusing the guest interface config (that is part of the guest's
&gt;&gt;&gt; XML config, and described above), and host physical interface config (that
&gt;&gt;&gt; is not in any way associated with guest config, but instead used to
&gt;&gt;&gt; configure the host's physical network interfaces, bridges, bonds, and vlan
&gt;&gt;&gt; interfaces; and nearly as important, is not supported on Ubuntu anyway).
&gt;&gt;&gt;
&gt;&gt;&gt; Actual guest interface config is *much* simpler than that.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; But after define, the dumpxml only show this part:
&gt;&gt;&gt;     &lt;interface type='bridge'&gt;
&gt;&gt;&gt;       &lt;mac address='52:54:00:3c:92:9a'/&gt;
&gt;&gt;&gt;       &lt;source bridge='br0'/&gt;
&gt;&gt;&gt;     &lt;/interface&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; That's because everything else you've put in your guest config is not
&gt;&gt;&gt; actually a part of a valid guest interface config, and so is ignored.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; I would appreciate any help to solve the question. The problem I've is I
&gt;&gt;&gt; lost the access to the guest every time the libvirt change the name of the
&gt;&gt;&gt; interface eth1,2,3, etc.
&gt;&gt;&gt;
&gt;&gt;&gt; In this case I think it may be useful to start over. You've somehow been
&gt;&gt;&gt; tricked into misunderstanding the way that network configuration in libvirt
&gt;&gt;&gt; works, confusing host interface config with guest interface config, and the
&gt;&gt;&gt; resulting config bears little resemblance to what would actually work.
&gt;&gt;&gt;
&gt;&gt;&gt; ==
&gt;&gt;&gt; The first step is to read this page:
&gt;&gt;&gt;
&gt;&gt;&gt;    http://wiki.libvirt.org/page/Networking
&gt;&gt;&gt;
&gt;&gt;&gt; to get a basic overview.
&gt;&gt;&gt;
&gt;&gt;&gt; ==
&gt;&gt;&gt; Second step: you should decide which of the three methods of connecting
&gt;&gt;&gt; to guests to the physical network you want to use:
&gt;&gt;&gt;
&gt;&gt;&gt; 1) NATed
&gt;&gt;&gt; 2) routed
&gt;&gt;&gt; 3) bridged
&gt;&gt;&gt;
&gt;&gt;&gt; The simplest is (1), and that will probably work just fine as long as 1)
&gt;&gt;&gt; you don't need incoming connections to the guests, and 2) you're not
&gt;&gt;&gt; concerned about getting the last fraction of an ounce of performance out of
&gt;&gt;&gt; the network.
&gt;&gt;&gt;
&gt;&gt;&gt; Depending on which of those 3 you decide to use:
&gt;&gt;&gt;
&gt;&gt;&gt; ==
&gt;&gt;&gt; Third step: follow the instructions to either create a bridge interface
&gt;&gt;&gt; on the host connected to a physical network interface (for (3)), or to
&gt;&gt;&gt; create a libvirt virtual network using one of the two modes ((1) or (2) -
&gt;&gt;&gt; actually the stock libvirt config already has a "default" network that is
&gt;&gt;&gt; probably adequate for (1), and unless you understand IP routing very well,
&gt;&gt;&gt; you'll likely want to avoid (2)).
&gt;&gt;&gt;
&gt;&gt;&gt; Once the physical network is setup:
&gt;&gt;&gt;
&gt;&gt;&gt; ==
&gt;&gt;&gt; Fourth step: define your guests. In each guest, you'll have an
&gt;&gt;&gt; &lt;interface&gt; element, but it will be much simpler than what you've previously
&gt;&gt;&gt; tried. For bridged mode, the interface section would look like this:
&gt;&gt;&gt;
&gt;&gt;&gt;   &lt;interface type='bridge'&gt;
&gt;&gt;&gt;     &lt;source bridge='br0'/&gt;
&gt;&gt;&gt;   &lt;/interface&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Depending on the guest, you may want to specify what type of hardware is
&gt;&gt;&gt; presented to the guest (default is rtl, which almost always works, but is
&gt;&gt;&gt; not the best perfrorming), in particular, if the guest supports virtio-net,
&gt;&gt;&gt; you'll want to add this into the &lt;interface&gt; element:
&gt;&gt;&gt;
&gt;&gt;&gt;   &lt;model type='virtio'/&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; For NATed or routed mode, the guest's interface definition would look
&gt;&gt;&gt; like this:
&gt;&gt;&gt;
&gt;&gt;&gt;   &lt;interface type='network'&gt;
&gt;&gt;&gt;      &lt;source network='default'/&gt;
&gt;&gt;&gt;   &lt;/interface&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; (replace "default" with the name of the network you've defined, if you've
&gt;&gt;&gt; defined your own). In this case also, you can add a &lt;model type='...'/&gt; if
&gt;&gt;&gt; appropriate.
&gt;&gt;&gt;
&gt;&gt;&gt; Note that I don't put anything in the &lt;interface&gt; element about MAC
&gt;&gt;&gt; address, target device, or bus address. Those are all setup automatically by
&gt;&gt;&gt; libvirt the first time you start the guest, and it will make sure that the
&gt;&gt;&gt; guests don't interfere with each other.
&gt;&gt;&gt;
&gt;&gt;&gt; ==
&gt;&gt;&gt; Fifth step: only if you need a particular guest to have a particular
&gt;&gt;&gt; fixed IP address, either 1) edit the network config file on the guest, 2)
&gt;&gt;&gt; add a static host to the libvirt virtual network definition (giving the MAC
&gt;&gt;&gt; address provided to the guest by libvirt during the initial guest startup)
&gt;&gt;&gt; with a &lt;host&gt; element added to the &lt;dhcp&gt; element of the network; details
&gt;&gt;&gt; are here:
&gt;&gt;&gt;
&gt;&gt;&gt;     http://www.libvirt.org/formatnetwork.html
&gt;&gt;&gt;
&gt;&gt;&gt; or 3) if you're using the bridged method to connect to the physical
&gt;&gt;&gt; network, again either configure the guest's own config file, or add a static
&gt;&gt;&gt; host definition to the dhcp server running on your physical network.
&gt;&gt;&gt;
&gt;&gt;&gt; If you still have problems don't hesitate to send another mail (although,
&gt;&gt;&gt; as I said at the top, sending to libvirt-users@redhat.com may yield better
&gt;&gt;&gt; results than libvir-list@redhat.com).
&gt;&gt;
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;



-- 
----------------------------------------
Tanguy ROZIER
tanguy@rozier.eu
+33 6 07 26 46 68
----------------------------------------

</body></email><email><emailId>20110210142951</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2011-02-10 14:29:51-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt] configuring network interface</subject><body>

On 02/10/2011 08:50 AM, Tanguy ROZIER wrote:
&gt; Your problem is related to udev : every reboot of VM, udev in VM
&gt; checks the MAC address of the ethernet interface of the system to
&gt; associate it with a static name (eth0, eth1...).
&gt; If you change the MAC address of the Ethernet interface of your VM, it
&gt; will detect a new interface and associate it with a new name (ethx+1).
&gt; In order to avoid it :
&gt; try not to change the MAC address of your VM ethernet device (you can
&gt; fix it with libvirt xml),

When a domain is defined with an interface, if no mac address is 
supplied, libvirt will automatically generate one and write that 
generated mac back to the config, so that the next time the guest boots 
it will be presented with an ethernet having the same mac address as the 
previous time.

How are you defining your guests? Are you perhaps using "virsh create" 
(but using an existing image file) to create a transient guest each time 
you want to boot the guest, rather than doing "virsh define" once to 
create a persistent guest, then using "virsh start" each time you want 
to boot it? You should be doing the latter - if you continuously use 
"virsh create", libvirt will think that it's a "throw away" guest, and 
won't save the config (or any changes to it), so the next time you do 
"virsh create", the disk image will have memory of the previous run (by 
having "eth0" assigned to some particular mac address), but libvirt 
won't have any memory of it (it thinks you're creating a brand new 
guest), so it will generate a new mac address for the interface, the 
guest will boot, see a "new" interface, notice that "eth0" is already 
taken, so it will use "eth1", and so on.

If you actually are using "virsh define" to define a persistent guest, 
do a "virsh dumpxml" of the guest after you've started and destroyed it, 
and see if there is a mac address in the interface config. If not, 
that's a bug.


&gt; or deactivate this mecanism in the VM : search in
&gt; /etc/udev/rules.d/70-persistent-net.rules : it calls
&gt; /lib/udev/write_net_rules at every reboot, you could chmod -x this
&gt; script in order to avoid it.

This may work (or may not - I haven't investigated), but it isn't the 
right way to fix this problem. It's dealing with the symptom rather than 
the cause.


&gt; Tanguy
&gt;
&gt; 2011/2/10 Marcela Castro León&lt;mcastrol@gmail.com&gt;:
&gt;&gt; Hello Laine:
&gt;&gt; I've revised the configuration and followed all your instructions.
&gt;&gt; I'll try to give you a better explain of my problem.
&gt;&gt;
&gt;&gt; a) I need a bridged (3) configuration, because I have to connect the guests
&gt;&gt; from each others. (via ssh and execute mpi). I've three hosts, each of one
&gt;&gt; has at least a guest.
&gt;&gt; I'll only explain about the configuration of one of them, because the
&gt;&gt; problem is only related a one configuration.
&gt;&gt; hostname=rionegro  ip=192.168.1.4
&gt;&gt; guest-name=rnompi1
&gt;&gt;
&gt;&gt; b) I've configured host bridge following step by step ther instruction on
&gt;&gt; http://wiki.libvirt.org/page/Networking
&gt;&gt; this is the /etc/network/config
&gt;&gt;
&gt;&gt; # The loopback network interface
&gt;&gt; auto lo
&gt;&gt; iface lo inet loopback
&gt;&gt;
&gt;&gt;
&gt;&gt; auto br0
&gt;&gt; iface br0 inet static
&gt;&gt; address 192.168.1.4
&gt;&gt; netmask 255.255.255.0
&gt;&gt; network 192.168.1.0
&gt;&gt; broadcast 192.168.1.255
&gt;&gt; gateway 192.168.1.10
&gt;&gt; bridge_ports eth0
&gt;&gt; bridge_stp on
&gt;&gt; bridge_fd 0
&gt;&gt; bridge_maxwait 0
&gt;&gt;
&gt;&gt; c) this is the xml guest configuration related to the network.
&gt;&gt;
&gt;&gt;      &lt;interface type='bridge'&gt;
&gt;&gt;        &lt;source bridge='br0'/&gt;
&gt;&gt;      &lt;/interface&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; d) But the guest doesn't get any IP automatically, and create an interface
&gt;&gt; with a variable name (eth4, eth5,etch6..). I don't know how to achieve the
&gt;&gt; guest don't behave like this and create always its network interface with a
&gt;&gt; fixed name, for example, eth0).
&gt;&gt;
&gt;&gt; Why I ask that?
&gt;&gt;
&gt;&gt; if the guest created an interface with a fixed name, I would configure and
&gt;&gt; static ip for the it.
&gt;&gt; I'm attaching a printscreen "rnompi1.jpg"  that show what ifconfig ahow on
&gt;&gt; the guest (eth14 and without any IP). It doesn't get their host either.
&gt;&gt;
&gt;&gt; The only way I achieve to solve but "temporally" until reboot is configuring
&gt;&gt; the guest statically using the name of the interface that has just up.In
&gt;&gt; that case every works fine, and the guest can connect to all the other
&gt;&gt; guests on the lan and others can connect to it.
&gt;&gt; But this only works until reboot or reconfigure the guest, because each time
&gt;&gt; the name of interface change, and my configuration I had done of
&gt;&gt; /etc/network/interface didn't work any more because is related to another
&gt;&gt; interface.
&gt;&gt;
&gt;&gt; I hope I've explained better the problem I have.
&gt;&gt;
&gt;&gt; Thank you very much, you've already helped too much to better understand the
&gt;&gt; different cases of network configuration
&gt;&gt;
&gt;&gt; Regards.
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; 2011/2/10 Marcela Castro León&lt;mcastrol@gmail.com&gt;
&gt;&gt;&gt; Hello Laine:
&gt;&gt;&gt; Thank you very much.
&gt;&gt;&gt; I've showed only one of the guest, each one have it's own ip address.
&gt;&gt;&gt; Anyway, I'll follow your advise of revise all the configuration after
&gt;&gt;&gt; reading the doc.
&gt;&gt;&gt; Thank you very much again.
&gt;&gt;&gt; Regards.
&gt;&gt;&gt;
&gt;&gt;&gt; 2011/2/8 Laine Stump&lt;laine@laine.org&gt;
&gt;&gt;&gt;&gt; (For future questions such as this, you may find you get a better
&gt;&gt;&gt;&gt; response (and lower signal-noise ratio) by asking on the recently -created
&gt;&gt;&gt;&gt; libvirt-users@redhat.com list, as libvir-list has a very large volume of
&gt;&gt;&gt;&gt; patches and discussion about the internals of libvirt)
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; On 02/08/2011 12:05 PM, Marcela Castro León wrote:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Hello
&gt;&gt;&gt;&gt; I've a lan of virtual machine configured with bridge. I've a private lan
&gt;&gt;&gt;&gt; of 4 machine, but one of them have 2 lan-card with access to internet.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Evertything works almost fine, except that I've configured on each guest
&gt;&gt;&gt;&gt; the static configuration of the bridge with the ip address, like this:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; auto lo
&gt;&gt;&gt;&gt; iface lo inet loopback
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; auto eth6
&gt;&gt;&gt;&gt; iface eth6 inet static
&gt;&gt;&gt;&gt; address 192.168.1.41
&gt;&gt;&gt;&gt; network 192.168.1.0
&gt;&gt;&gt;&gt; netmask 255.255.255.0
&gt;&gt;&gt;&gt; gateway 192.168.1.10
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; So are you saying that you're attempting to give each guest the *same* IP
&gt;&gt;&gt;&gt; address? There's no way that can possibly work, even if each is connected to
&gt;&gt;&gt;&gt; a separate virtual network or bridge. Since the host's IP stack can "see"
&gt;&gt;&gt;&gt; all of the guests' network traffic, regardless of the connection mode you
&gt;&gt;&gt;&gt; choose, each must have a unique IP address even if they can't see each
&gt;&gt;&gt;&gt; other.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; But each time I, for example, define the guest, it start with a ascending
&gt;&gt;&gt;&gt; number of interface: eth6,eth7, eth8, etc, Now is initializing with eth12.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; There must be a mixup in the explanation - I'm understanding that you put
&gt;&gt;&gt;&gt; the same config file in each guest, but each guest, when it starts, shows a
&gt;&gt;&gt;&gt; different ethernet interface in its ifconfig. That doesn't seem right,
&gt;&gt;&gt;&gt; because none of the guests know about each other. Or are you saying
&gt;&gt;&gt;&gt; something different? Where are you seeing the "eth6", "eth7", ... "eth12"?
&gt;&gt;&gt;&gt; In the guest XML config maybe?
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; So, it doesn't get the manual configuration I've done on the
&gt;&gt;&gt;&gt; /etc/network/interfaces.
&gt;&gt;&gt;&gt; How can avoid this way of work of the number of ethernet interface the
&gt;&gt;&gt;&gt; guest start?
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Why are you doing a manual/static definition on the guest at all? It's
&gt;&gt;&gt;&gt; simpler to just leave the guest to automatically configure its eth0, and if
&gt;&gt;&gt;&gt; you really want a particular IP address for a particular guest, handle that
&gt;&gt;&gt;&gt; with a&lt;host&gt;  element in the&lt;dhcp&gt;  section of the virtual network the guest
&gt;&gt;&gt;&gt; is connected to (or, if you're using a pure bridging setup, then in the
&gt;&gt;&gt;&gt; static hosts config of the dhcp server on that network).
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; A way i'm trying to solve is configuring the interface trough the guest
&gt;&gt;&gt;&gt; xml definition,
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; The guest xml interface configuration cannot be used to setup the IP
&gt;&gt;&gt;&gt; address, route, etc config of the guest. It is only used for two things:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; 1) configuring what kind of hardware appears on the guest (but not what
&gt;&gt;&gt;&gt; name the guest gives to it!)
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; 2) configuring how that hardware is connected to the physical network
&gt;&gt;&gt;&gt; (usually either via an existing bridge interface on the host (in order for
&gt;&gt;&gt;&gt; the guest to appear as if its directly connected to the physical network),
&gt;&gt;&gt;&gt; or via a "virtual network" created by libvirt (which is really just a bridge
&gt;&gt;&gt;&gt; that's not directly connected to any physical interface, relying instead on
&gt;&gt;&gt;&gt; the host's IP stack to route packets from the guest out to the physical
&gt;&gt;&gt;&gt; network.)
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; but the operation "define" on virsh accepted without error the xml i've
&gt;&gt;&gt;&gt; done, but the dumpxml doesn't show them, so, it doesn't work at all.
&gt;&gt;&gt;&gt; I've followed the instruction that said the manual "Application
&gt;&gt;&gt;&gt; development guide - a guide to application development with libvirt" on page
&gt;&gt;&gt;&gt; 71.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; That document is targeted towards software developers writing
&gt;&gt;&gt;&gt; applications to manage virtual guests using the libvirt API, not for system
&gt;&gt;&gt;&gt; administrators who are configuring virtual guests manually (or, more likely,
&gt;&gt;&gt;&gt; by using software that uses the libvirt API, eg virsh or virt-manager). It
&gt;&gt;&gt;&gt; likely contains more detail and less overview than what you need, which is
&gt;&gt;&gt;&gt; probably what led to the confusion. I've included a pointer to a wiki page
&gt;&gt;&gt;&gt; below that is more the appropriate level of information (Justin, if the docs
&gt;&gt;&gt;&gt; you were working on are somewhere easily accessible, you can point to those
&gt;&gt;&gt;&gt; instead.)
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; The whole definition of the VM is attached, but the related to interface
&gt;&gt;&gt;&gt; is:
&gt;&gt;&gt;&gt;      &lt;interface type='bridge'&gt;
&gt;&gt;&gt;&gt;        &lt;source bridge='br0'/&gt;
&gt;&gt;&gt;&gt;        &lt;target dev='vnet0'/&gt;
&gt;&gt;&gt;&gt;      &lt;protocol&gt;
&gt;&gt;&gt;&gt;          &lt;ip address="192.168.1.41" prefix="24"/&gt;
&gt;&gt;&gt;&gt;          &lt;route gateway="192.168.1.10"/&gt;
&gt;&gt;&gt;&gt;      &lt;/protocol&gt;
&gt;&gt;&gt;&gt;      &lt;bridge stp="off" delay="0.01"&gt;
&gt;&gt;&gt;&gt;      &lt;interface type="ethernet" name="eth12"&gt;
&gt;&gt;&gt;&gt;      &lt;protocol&gt;
&gt;&gt;&gt;&gt;          &lt;ip address="192.168.1.41" prefix="24"/&gt;
&gt;&gt;&gt;&gt;          &lt;route gateway="192.168.1.10"/&gt;
&gt;&gt;&gt;&gt;      &lt;/protocol&gt;
&gt;&gt;&gt;&gt;      &lt;/interface&gt;
&gt;&gt;&gt;&gt;      &lt;/bridge&gt;
&gt;&gt;&gt;&gt;      &lt;/interface&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; You are confusing the guest interface config (that is part of the guest's
&gt;&gt;&gt;&gt; XML config, and described above), and host physical interface config (that
&gt;&gt;&gt;&gt; is not in any way associated with guest config, but instead used to
&gt;&gt;&gt;&gt; configure the host's physical network interfaces, bridges, bonds, and vlan
&gt;&gt;&gt;&gt; interfaces; and nearly as important, is not supported on Ubuntu anyway).
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Actual guest interface config is *much* simpler than that.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; But after define, the dumpxml only show this part:
&gt;&gt;&gt;&gt;      &lt;interface type='bridge'&gt;
&gt;&gt;&gt;&gt;        &lt;mac address='52:54:00:3c:92:9a'/&gt;
&gt;&gt;&gt;&gt;        &lt;source bridge='br0'/&gt;
&gt;&gt;&gt;&gt;      &lt;/interface&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; That's because everything else you've put in your guest config is not
&gt;&gt;&gt;&gt; actually a part of a valid guest interface config, and so is ignored.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; I would appreciate any help to solve the question. The problem I've is I
&gt;&gt;&gt;&gt; lost the access to the guest every time the libvirt change the name of the
&gt;&gt;&gt;&gt; interface eth1,2,3, etc.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; In this case I think it may be useful to start over. You've somehow been
&gt;&gt;&gt;&gt; tricked into misunderstanding the way that network configuration in libvirt
&gt;&gt;&gt;&gt; works, confusing host interface config with guest interface config, and the
&gt;&gt;&gt;&gt; resulting config bears little resemblance to what would actually work.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; ==
&gt;&gt;&gt;&gt; The first step is to read this page:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;     http://wiki.libvirt.org/page/Networking
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; to get a basic overview.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; ==
&gt;&gt;&gt;&gt; Second step: you should decide which of the three methods of connecting
&gt;&gt;&gt;&gt; to guests to the physical network you want to use:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; 1) NATed
&gt;&gt;&gt;&gt; 2) routed
&gt;&gt;&gt;&gt; 3) bridged
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; The simplest is (1), and that will probably work just fine as long as 1)
&gt;&gt;&gt;&gt; you don't need incoming connections to the guests, and 2) you're not
&gt;&gt;&gt;&gt; concerned about getting the last fraction of an ounce of performance out of
&gt;&gt;&gt;&gt; the network.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Depending on which of those 3 you decide to use:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; ==
&gt;&gt;&gt;&gt; Third step: follow the instructions to either create a bridge interface
&gt;&gt;&gt;&gt; on the host connected to a physical network interface (for (3)), or to
&gt;&gt;&gt;&gt; create a libvirt virtual network using one of the two modes ((1) or (2) -
&gt;&gt;&gt;&gt; actually the stock libvirt config already has a "default" network that is
&gt;&gt;&gt;&gt; probably adequate for (1), and unless you understand IP routing very well,
&gt;&gt;&gt;&gt; you'll likely want to avoid (2)).
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Once the physical network is setup:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; ==
&gt;&gt;&gt;&gt; Fourth step: define your guests. In each guest, you'll have an
&gt;&gt;&gt;&gt; &lt;interface&gt;  element, but it will be much simpler than what you've previously
&gt;&gt;&gt;&gt; tried. For bridged mode, the interface section would look like this:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;    &lt;interface type='bridge'&gt;
&gt;&gt;&gt;&gt;      &lt;source bridge='br0'/&gt;
&gt;&gt;&gt;&gt;    &lt;/interface&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Depending on the guest, you may want to specify what type of hardware is
&gt;&gt;&gt;&gt; presented to the guest (default is rtl, which almost always works, but is
&gt;&gt;&gt;&gt; not the best perfrorming), in particular, if the guest supports virtio-net,
&gt;&gt;&gt;&gt; you'll want to add this into the&lt;interface&gt;  element:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;    &lt;model type='virtio'/&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; For NATed or routed mode, the guest's interface definition would look
&gt;&gt;&gt;&gt; like this:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;    &lt;interface type='network'&gt;
&gt;&gt;&gt;&gt;       &lt;source network='default'/&gt;
&gt;&gt;&gt;&gt;    &lt;/interface&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; (replace "default" with the name of the network you've defined, if you've
&gt;&gt;&gt;&gt; defined your own). In this case also, you can add a&lt;model type='...'/&gt;  if
&gt;&gt;&gt;&gt; appropriate.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Note that I don't put anything in the&lt;interface&gt;  element about MAC
&gt;&gt;&gt;&gt; address, target device, or bus address. Those are all setup automatically by
&gt;&gt;&gt;&gt; libvirt the first time you start the guest, and it will make sure that the
&gt;&gt;&gt;&gt; guests don't interfere with each other.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; ==
&gt;&gt;&gt;&gt; Fifth step: only if you need a particular guest to have a particular
&gt;&gt;&gt;&gt; fixed IP address, either 1) edit the network config file on the guest, 2)
&gt;&gt;&gt;&gt; add a static host to the libvirt virtual network definition (giving the MAC
&gt;&gt;&gt;&gt; address provided to the guest by libvirt during the initial guest startup)
&gt;&gt;&gt;&gt; with a&lt;host&gt;  element added to the&lt;dhcp&gt;  element of the network; details
&gt;&gt;&gt;&gt; are here:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;      http://www.libvirt.org/formatnetwork.html
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; or 3) if you're using the bridged method to connect to the physical
&gt;&gt;&gt;&gt; network, again either configure the guest's own config file, or add a static
&gt;&gt;&gt;&gt; host definition to the dhcp server running on your physical network.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; If you still have problems don't hesitate to send another mail (although,
&gt;&gt;&gt;&gt; as I said at the top, sending to libvirt-users@redhat.com may yield better
&gt;&gt;&gt;&gt; results than libvir-list@redhat.com).
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; libvirt-users mailing list
&gt;&gt; libvirt-users@redhat.com
&gt;&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;&gt;
&gt;
&gt;

</body></email><email><emailId>20110210145124</emailId><senderName>Tanguy ROZIER</senderName><senderEmail>tanguy@rozier.eu</senderEmail><timestampReceived>2011-02-10 14:51:24-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt] configuring network interface</subject><body>

OK so he should fix the problem with libvirt to associate a fixed MAC
to the interface of the VM :

&lt;interface type='bridge'&gt;
   &lt;source bridge='br0'/&gt;
   &lt;mac address="00:11:22:33:44:55"/&gt;       &lt;----------this is here :
you must *define* the MAC address of your interface
&lt;/interface&gt;

Tanguy

2011/2/10 Laine Stump &lt;laine@laine.org&gt;:
&gt; On 02/10/2011 08:50 AM, Tanguy ROZIER wrote:
&gt;&gt;
&gt;&gt; Your problem is related to udev : every reboot of VM, udev in VM
&gt;&gt; checks the MAC address of the ethernet interface of the system to
&gt;&gt; associate it with a static name (eth0, eth1...).
&gt;&gt; If you change the MAC address of the Ethernet interface of your VM, it
&gt;&gt; will detect a new interface and associate it with a new name (ethx+1).
&gt;&gt; In order to avoid it :
&gt;&gt; try not to change the MAC address of your VM ethernet device (you can
&gt;&gt; fix it with libvirt xml),
&gt;
&gt; When a domain is defined with an interface, if no mac address is supplied,
&gt; libvirt will automatically generate one and write that generated mac back to
&gt; the config, so that the next time the guest boots it will be presented with
&gt; an ethernet having the same mac address as the previous time.
&gt;
&gt; How are you defining your guests? Are you perhaps using "virsh create" (but
&gt; using an existing image file) to create a transient guest each time you want
&gt; to boot the guest, rather than doing "virsh define" once to create a
&gt; persistent guest, then using "virsh start" each time you want to boot it?
&gt; You should be doing the latter - if you continuously use "virsh create",
&gt; libvirt will think that it's a "throw away" guest, and won't save the config
&gt; (or any changes to it), so the next time you do "virsh create", the disk
&gt; image will have memory of the previous run (by having "eth0" assigned to
&gt; some particular mac address), but libvirt won't have any memory of it (it
&gt; thinks you're creating a brand new guest), so it will generate a new mac
&gt; address for the interface, the guest will boot, see a "new" interface,
&gt; notice that "eth0" is already taken, so it will use "eth1", and so on.
&gt;
&gt; If you actually are using "virsh define" to define a persistent guest, do a
&gt; "virsh dumpxml" of the guest after you've started and destroyed it, and see
&gt; if there is a mac address in the interface config. If not, that's a bug.
&gt;
&gt;
&gt;&gt; or deactivate this mecanism in the VM : search in
&gt;&gt; /etc/udev/rules.d/70-persistent-net.rules : it calls
&gt;&gt; /lib/udev/write_net_rules at every reboot, you could chmod -x this
&gt;&gt; script in order to avoid it.
&gt;
&gt; This may work (or may not - I haven't investigated), but it isn't the right
&gt; way to fix this problem. It's dealing with the symptom rather than the
&gt; cause.
&gt;
&gt;
&gt;&gt; Tanguy
&gt;&gt;
&gt;&gt; 2011/2/10 Marcela Castro León&lt;mcastrol@gmail.com&gt;:
&gt;&gt;&gt;
&gt;&gt;&gt; Hello Laine:
&gt;&gt;&gt; I've revised the configuration and followed all your instructions.
&gt;&gt;&gt; I'll try to give you a better explain of my problem.
&gt;&gt;&gt;
&gt;&gt;&gt; a) I need a bridged (3) configuration, because I have to connect the
&gt;&gt;&gt; guests
&gt;&gt;&gt; from each others. (via ssh and execute mpi). I've three hosts, each of
&gt;&gt;&gt; one
&gt;&gt;&gt; has at least a guest.
&gt;&gt;&gt; I'll only explain about the configuration of one of them, because the
&gt;&gt;&gt; problem is only related a one configuration.
&gt;&gt;&gt; hostname=rionegro  ip=192.168.1.4
&gt;&gt;&gt; guest-name=rnompi1
&gt;&gt;&gt;
&gt;&gt;&gt; b) I've configured host bridge following step by step ther instruction on
&gt;&gt;&gt; http://wiki.libvirt.org/page/Networking
&gt;&gt;&gt; this is the /etc/network/config
&gt;&gt;&gt;
&gt;&gt;&gt; # The loopback network interface
&gt;&gt;&gt; auto lo
&gt;&gt;&gt; iface lo inet loopback
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; auto br0
&gt;&gt;&gt; iface br0 inet static
&gt;&gt;&gt; address 192.168.1.4
&gt;&gt;&gt; netmask 255.255.255.0
&gt;&gt;&gt; network 192.168.1.0
&gt;&gt;&gt; broadcast 192.168.1.255
&gt;&gt;&gt; gateway 192.168.1.10
&gt;&gt;&gt; bridge_ports eth0
&gt;&gt;&gt; bridge_stp on
&gt;&gt;&gt; bridge_fd 0
&gt;&gt;&gt; bridge_maxwait 0
&gt;&gt;&gt;
&gt;&gt;&gt; c) this is the xml guest configuration related to the network.
&gt;&gt;&gt;
&gt;&gt;&gt;     &lt;interface type='bridge'&gt;
&gt;&gt;&gt;       &lt;source bridge='br0'/&gt;
&gt;&gt;&gt;     &lt;/interface&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; d) But the guest doesn't get any IP automatically, and create an
&gt;&gt;&gt; interface
&gt;&gt;&gt; with a variable name (eth4, eth5,etch6..). I don't know how to achieve
&gt;&gt;&gt; the
&gt;&gt;&gt; guest don't behave like this and create always its network interface with
&gt;&gt;&gt; a
&gt;&gt;&gt; fixed name, for example, eth0).
&gt;&gt;&gt;
&gt;&gt;&gt; Why I ask that?
&gt;&gt;&gt;
&gt;&gt;&gt; if the guest created an interface with a fixed name, I would configure
&gt;&gt;&gt; and
&gt;&gt;&gt; static ip for the it.
&gt;&gt;&gt; I'm attaching a printscreen "rnompi1.jpg"  that show what ifconfig ahow
&gt;&gt;&gt; on
&gt;&gt;&gt; the guest (eth14 and without any IP). It doesn't get their host either.
&gt;&gt;&gt;
&gt;&gt;&gt; The only way I achieve to solve but "temporally" until reboot is
&gt;&gt;&gt; configuring
&gt;&gt;&gt; the guest statically using the name of the interface that has just up.In
&gt;&gt;&gt; that case every works fine, and the guest can connect to all the other
&gt;&gt;&gt; guests on the lan and others can connect to it.
&gt;&gt;&gt; But this only works until reboot or reconfigure the guest, because each
&gt;&gt;&gt; time
&gt;&gt;&gt; the name of interface change, and my configuration I had done of
&gt;&gt;&gt; /etc/network/interface didn't work any more because is related to another
&gt;&gt;&gt; interface.
&gt;&gt;&gt;
&gt;&gt;&gt; I hope I've explained better the problem I have.
&gt;&gt;&gt;
&gt;&gt;&gt; Thank you very much, you've already helped too much to better understand
&gt;&gt;&gt; the
&gt;&gt;&gt; different cases of network configuration
&gt;&gt;&gt;
&gt;&gt;&gt; Regards.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; 2011/2/10 Marcela Castro León&lt;mcastrol@gmail.com&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Hello Laine:
&gt;&gt;&gt;&gt; Thank you very much.
&gt;&gt;&gt;&gt; I've showed only one of the guest, each one have it's own ip address.
&gt;&gt;&gt;&gt; Anyway, I'll follow your advise of revise all the configuration after
&gt;&gt;&gt;&gt; reading the doc.
&gt;&gt;&gt;&gt; Thank you very much again.
&gt;&gt;&gt;&gt; Regards.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; 2011/2/8 Laine Stump&lt;laine@laine.org&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; (For future questions such as this, you may find you get a better
&gt;&gt;&gt;&gt;&gt; response (and lower signal-noise ratio) by asking on the recently
&gt;&gt;&gt;&gt;&gt; -created
&gt;&gt;&gt;&gt;&gt; libvirt-users@redhat.com list, as libvir-list has a very large volume
&gt;&gt;&gt;&gt;&gt; of
&gt;&gt;&gt;&gt;&gt; patches and discussion about the internals of libvirt)
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; On 02/08/2011 12:05 PM, Marcela Castro León wrote:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Hello
&gt;&gt;&gt;&gt;&gt; I've a lan of virtual machine configured with bridge. I've a private
&gt;&gt;&gt;&gt;&gt; lan
&gt;&gt;&gt;&gt;&gt; of 4 machine, but one of them have 2 lan-card with access to internet.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Evertything works almost fine, except that I've configured on each
&gt;&gt;&gt;&gt;&gt; guest
&gt;&gt;&gt;&gt;&gt; the static configuration of the bridge with the ip address, like this:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; auto lo
&gt;&gt;&gt;&gt;&gt; iface lo inet loopback
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; auto eth6
&gt;&gt;&gt;&gt;&gt; iface eth6 inet static
&gt;&gt;&gt;&gt;&gt; address 192.168.1.41
&gt;&gt;&gt;&gt;&gt; network 192.168.1.0
&gt;&gt;&gt;&gt;&gt; netmask 255.255.255.0
&gt;&gt;&gt;&gt;&gt; gateway 192.168.1.10
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; So are you saying that you're attempting to give each guest the *same*
&gt;&gt;&gt;&gt;&gt; IP
&gt;&gt;&gt;&gt;&gt; address? There's no way that can possibly work, even if each is
&gt;&gt;&gt;&gt;&gt; connected to
&gt;&gt;&gt;&gt;&gt; a separate virtual network or bridge. Since the host's IP stack can
&gt;&gt;&gt;&gt;&gt; "see"
&gt;&gt;&gt;&gt;&gt; all of the guests' network traffic, regardless of the connection mode
&gt;&gt;&gt;&gt;&gt; you
&gt;&gt;&gt;&gt;&gt; choose, each must have a unique IP address even if they can't see each
&gt;&gt;&gt;&gt;&gt; other.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; But each time I, for example, define the guest, it start with a
&gt;&gt;&gt;&gt;&gt; ascending
&gt;&gt;&gt;&gt;&gt; number of interface: eth6,eth7, eth8, etc, Now is initializing with
&gt;&gt;&gt;&gt;&gt; eth12.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; There must be a mixup in the explanation - I'm understanding that you
&gt;&gt;&gt;&gt;&gt; put
&gt;&gt;&gt;&gt;&gt; the same config file in each guest, but each guest, when it starts,
&gt;&gt;&gt;&gt;&gt; shows a
&gt;&gt;&gt;&gt;&gt; different ethernet interface in its ifconfig. That doesn't seem right,
&gt;&gt;&gt;&gt;&gt; because none of the guests know about each other. Or are you saying
&gt;&gt;&gt;&gt;&gt; something different? Where are you seeing the "eth6", "eth7", ...
&gt;&gt;&gt;&gt;&gt; "eth12"?
&gt;&gt;&gt;&gt;&gt; In the guest XML config maybe?
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; So, it doesn't get the manual configuration I've done on the
&gt;&gt;&gt;&gt;&gt; /etc/network/interfaces.
&gt;&gt;&gt;&gt;&gt; How can avoid this way of work of the number of ethernet interface the
&gt;&gt;&gt;&gt;&gt; guest start?
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Why are you doing a manual/static definition on the guest at all? It's
&gt;&gt;&gt;&gt;&gt; simpler to just leave the guest to automatically configure its eth0,
&gt;&gt;&gt;&gt;&gt; and if
&gt;&gt;&gt;&gt;&gt; you really want a particular IP address for a particular guest, handle
&gt;&gt;&gt;&gt;&gt; that
&gt;&gt;&gt;&gt;&gt; with a&lt;host&gt;  element in the&lt;dhcp&gt;  section of the virtual network the
&gt;&gt;&gt;&gt;&gt; guest
&gt;&gt;&gt;&gt;&gt; is connected to (or, if you're using a pure bridging setup, then in the
&gt;&gt;&gt;&gt;&gt; static hosts config of the dhcp server on that network).
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; A way i'm trying to solve is configuring the interface trough the guest
&gt;&gt;&gt;&gt;&gt; xml definition,
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; The guest xml interface configuration cannot be used to setup the IP
&gt;&gt;&gt;&gt;&gt; address, route, etc config of the guest. It is only used for two
&gt;&gt;&gt;&gt;&gt; things:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; 1) configuring what kind of hardware appears on the guest (but not what
&gt;&gt;&gt;&gt;&gt; name the guest gives to it!)
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; 2) configuring how that hardware is connected to the physical network
&gt;&gt;&gt;&gt;&gt; (usually either via an existing bridge interface on the host (in order
&gt;&gt;&gt;&gt;&gt; for
&gt;&gt;&gt;&gt;&gt; the guest to appear as if its directly connected to the physical
&gt;&gt;&gt;&gt;&gt; network),
&gt;&gt;&gt;&gt;&gt; or via a "virtual network" created by libvirt (which is really just a
&gt;&gt;&gt;&gt;&gt; bridge
&gt;&gt;&gt;&gt;&gt; that's not directly connected to any physical interface, relying
&gt;&gt;&gt;&gt;&gt; instead on
&gt;&gt;&gt;&gt;&gt; the host's IP stack to route packets from the guest out to the physical
&gt;&gt;&gt;&gt;&gt; network.)
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; but the operation "define" on virsh accepted without error the xml i've
&gt;&gt;&gt;&gt;&gt; done, but the dumpxml doesn't show them, so, it doesn't work at all.
&gt;&gt;&gt;&gt;&gt; I've followed the instruction that said the manual "Application
&gt;&gt;&gt;&gt;&gt; development guide - a guide to application development with libvirt" on
&gt;&gt;&gt;&gt;&gt; page
&gt;&gt;&gt;&gt;&gt; 71.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; That document is targeted towards software developers writing
&gt;&gt;&gt;&gt;&gt; applications to manage virtual guests using the libvirt API, not for
&gt;&gt;&gt;&gt;&gt; system
&gt;&gt;&gt;&gt;&gt; administrators who are configuring virtual guests manually (or, more
&gt;&gt;&gt;&gt;&gt; likely,
&gt;&gt;&gt;&gt;&gt; by using software that uses the libvirt API, eg virsh or virt-manager).
&gt;&gt;&gt;&gt;&gt; It
&gt;&gt;&gt;&gt;&gt; likely contains more detail and less overview than what you need, which
&gt;&gt;&gt;&gt;&gt; is
&gt;&gt;&gt;&gt;&gt; probably what led to the confusion. I've included a pointer to a wiki
&gt;&gt;&gt;&gt;&gt; page
&gt;&gt;&gt;&gt;&gt; below that is more the appropriate level of information (Justin, if the
&gt;&gt;&gt;&gt;&gt; docs
&gt;&gt;&gt;&gt;&gt; you were working on are somewhere easily accessible, you can point to
&gt;&gt;&gt;&gt;&gt; those
&gt;&gt;&gt;&gt;&gt; instead.)
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; The whole definition of the VM is attached, but the related to
&gt;&gt;&gt;&gt;&gt; interface
&gt;&gt;&gt;&gt;&gt; is:
&gt;&gt;&gt;&gt;&gt;     &lt;interface type='bridge'&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;source bridge='br0'/&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;target dev='vnet0'/&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;protocol&gt;
&gt;&gt;&gt;&gt;&gt;         &lt;ip address="192.168.1.41" prefix="24"/&gt;
&gt;&gt;&gt;&gt;&gt;         &lt;route gateway="192.168.1.10"/&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;/protocol&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;bridge stp="off" delay="0.01"&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;interface type="ethernet" name="eth12"&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;protocol&gt;
&gt;&gt;&gt;&gt;&gt;         &lt;ip address="192.168.1.41" prefix="24"/&gt;
&gt;&gt;&gt;&gt;&gt;         &lt;route gateway="192.168.1.10"/&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;/protocol&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;/interface&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;/bridge&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;/interface&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; You are confusing the guest interface config (that is part of the
&gt;&gt;&gt;&gt;&gt; guest's
&gt;&gt;&gt;&gt;&gt; XML config, and described above), and host physical interface config
&gt;&gt;&gt;&gt;&gt; (that
&gt;&gt;&gt;&gt;&gt; is not in any way associated with guest config, but instead used to
&gt;&gt;&gt;&gt;&gt; configure the host's physical network interfaces, bridges, bonds, and
&gt;&gt;&gt;&gt;&gt; vlan
&gt;&gt;&gt;&gt;&gt; interfaces; and nearly as important, is not supported on Ubuntu
&gt;&gt;&gt;&gt;&gt; anyway).
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Actual guest interface config is *much* simpler than that.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; But after define, the dumpxml only show this part:
&gt;&gt;&gt;&gt;&gt;     &lt;interface type='bridge'&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;mac address='52:54:00:3c:92:9a'/&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;source bridge='br0'/&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;/interface&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; That's because everything else you've put in your guest config is not
&gt;&gt;&gt;&gt;&gt; actually a part of a valid guest interface config, and so is ignored.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; I would appreciate any help to solve the question. The problem I've is
&gt;&gt;&gt;&gt;&gt; I
&gt;&gt;&gt;&gt;&gt; lost the access to the guest every time the libvirt change the name of
&gt;&gt;&gt;&gt;&gt; the
&gt;&gt;&gt;&gt;&gt; interface eth1,2,3, etc.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; In this case I think it may be useful to start over. You've somehow
&gt;&gt;&gt;&gt;&gt; been
&gt;&gt;&gt;&gt;&gt; tricked into misunderstanding the way that network configuration in
&gt;&gt;&gt;&gt;&gt; libvirt
&gt;&gt;&gt;&gt;&gt; works, confusing host interface config with guest interface config, and
&gt;&gt;&gt;&gt;&gt; the
&gt;&gt;&gt;&gt;&gt; resulting config bears little resemblance to what would actually work.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; ==
&gt;&gt;&gt;&gt;&gt; The first step is to read this page:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;    http://wiki.libvirt.org/page/Networking
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; to get a basic overview.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; ==
&gt;&gt;&gt;&gt;&gt; Second step: you should decide which of the three methods of connecting
&gt;&gt;&gt;&gt;&gt; to guests to the physical network you want to use:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; 1) NATed
&gt;&gt;&gt;&gt;&gt; 2) routed
&gt;&gt;&gt;&gt;&gt; 3) bridged
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; The simplest is (1), and that will probably work just fine as long as
&gt;&gt;&gt;&gt;&gt; 1)
&gt;&gt;&gt;&gt;&gt; you don't need incoming connections to the guests, and 2) you're not
&gt;&gt;&gt;&gt;&gt; concerned about getting the last fraction of an ounce of performance
&gt;&gt;&gt;&gt;&gt; out of
&gt;&gt;&gt;&gt;&gt; the network.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Depending on which of those 3 you decide to use:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; ==
&gt;&gt;&gt;&gt;&gt; Third step: follow the instructions to either create a bridge interface
&gt;&gt;&gt;&gt;&gt; on the host connected to a physical network interface (for (3)), or to
&gt;&gt;&gt;&gt;&gt; create a libvirt virtual network using one of the two modes ((1) or (2)
&gt;&gt;&gt;&gt;&gt; -
&gt;&gt;&gt;&gt;&gt; actually the stock libvirt config already has a "default" network that
&gt;&gt;&gt;&gt;&gt; is
&gt;&gt;&gt;&gt;&gt; probably adequate for (1), and unless you understand IP routing very
&gt;&gt;&gt;&gt;&gt; well,
&gt;&gt;&gt;&gt;&gt; you'll likely want to avoid (2)).
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Once the physical network is setup:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; ==
&gt;&gt;&gt;&gt;&gt; Fourth step: define your guests. In each guest, you'll have an
&gt;&gt;&gt;&gt;&gt; &lt;interface&gt;  element, but it will be much simpler than what you've
&gt;&gt;&gt;&gt;&gt; previously
&gt;&gt;&gt;&gt;&gt; tried. For bridged mode, the interface section would look like this:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;   &lt;interface type='bridge'&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;source bridge='br0'/&gt;
&gt;&gt;&gt;&gt;&gt;   &lt;/interface&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Depending on the guest, you may want to specify what type of hardware
&gt;&gt;&gt;&gt;&gt; is
&gt;&gt;&gt;&gt;&gt; presented to the guest (default is rtl, which almost always works, but
&gt;&gt;&gt;&gt;&gt; is
&gt;&gt;&gt;&gt;&gt; not the best perfrorming), in particular, if the guest supports
&gt;&gt;&gt;&gt;&gt; virtio-net,
&gt;&gt;&gt;&gt;&gt; you'll want to add this into the&lt;interface&gt;  element:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;   &lt;model type='virtio'/&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; For NATed or routed mode, the guest's interface definition would look
&gt;&gt;&gt;&gt;&gt; like this:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;   &lt;interface type='network'&gt;
&gt;&gt;&gt;&gt;&gt;      &lt;source network='default'/&gt;
&gt;&gt;&gt;&gt;&gt;   &lt;/interface&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; (replace "default" with the name of the network you've defined, if
&gt;&gt;&gt;&gt;&gt; you've
&gt;&gt;&gt;&gt;&gt; defined your own). In this case also, you can add a&lt;model type='...'/&gt;
&gt;&gt;&gt;&gt;&gt;  if
&gt;&gt;&gt;&gt;&gt; appropriate.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Note that I don't put anything in the&lt;interface&gt;  element about MAC
&gt;&gt;&gt;&gt;&gt; address, target device, or bus address. Those are all setup
&gt;&gt;&gt;&gt;&gt; automatically by
&gt;&gt;&gt;&gt;&gt; libvirt the first time you start the guest, and it will make sure that
&gt;&gt;&gt;&gt;&gt; the
&gt;&gt;&gt;&gt;&gt; guests don't interfere with each other.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; ==
&gt;&gt;&gt;&gt;&gt; Fifth step: only if you need a particular guest to have a particular
&gt;&gt;&gt;&gt;&gt; fixed IP address, either 1) edit the network config file on the guest,
&gt;&gt;&gt;&gt;&gt; 2)
&gt;&gt;&gt;&gt;&gt; add a static host to the libvirt virtual network definition (giving the
&gt;&gt;&gt;&gt;&gt; MAC
&gt;&gt;&gt;&gt;&gt; address provided to the guest by libvirt during the initial guest
&gt;&gt;&gt;&gt;&gt; startup)
&gt;&gt;&gt;&gt;&gt; with a&lt;host&gt;  element added to the&lt;dhcp&gt;  element of the network;
&gt;&gt;&gt;&gt;&gt; details
&gt;&gt;&gt;&gt;&gt; are here:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;     http://www.libvirt.org/formatnetwork.html
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; or 3) if you're using the bridged method to connect to the physical
&gt;&gt;&gt;&gt;&gt; network, again either configure the guest's own config file, or add a
&gt;&gt;&gt;&gt;&gt; static
&gt;&gt;&gt;&gt;&gt; host definition to the dhcp server running on your physical network.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; If you still have problems don't hesitate to send another mail
&gt;&gt;&gt;&gt;&gt; (although,
&gt;&gt;&gt;&gt;&gt; as I said at the top, sending to libvirt-users@redhat.com may yield
&gt;&gt;&gt;&gt;&gt; better
&gt;&gt;&gt;&gt;&gt; results than libvir-list@redhat.com).
&gt;&gt;&gt;
&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt; libvirt-users mailing list
&gt;&gt;&gt; libvirt-users@redhat.com
&gt;&gt;&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;
&gt;



-- 
----------------------------------------
Tanguy ROZIER
tanguy@rozier.eu
+33 6 07 26 46 68
----------------------------------------

</body></email><email><emailId>20110210202923</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2011-02-10 20:29:23-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt] configuring network interface</subject><body>

On 02/10/2011 09:51 AM, Tanguy ROZIER wrote:
&gt; OK so he should fix the problem with libvirt to associate a fixed MAC
&gt; to the interface of the VM :
&gt;
&gt; &lt;interface type='bridge'&gt;
&gt;     &lt;source bridge='br0'/&gt;
&gt;     &lt;mac address="00:11:22:33:44:55"/&gt;        &lt;----------this is here :
&gt; you must *define* the MAC address of your interface
&gt; &lt;/interface&gt;

As I said in my last mail, if you do not  manually define a MAC address 
for an interface, libvirt will automatically generate a random mac 
address, and save it into the domain config for you, so that the 2nd and 
subsequent times you start the guest, it will use the same mac address. 
So, there is no requirement that you manually define the MAC address.

For example, I just edited an existing domain config with "virsh edit 
domainname" and added this:

&lt;interface type='network'&gt;
&lt;source network='default'/&gt;
&lt;model type='virtio'/&gt;
&lt;/interface&gt;

Then I immediately ran "virsh dumpxml domainname", and the interface 
config had been magically transformed:

&lt;interface type='network'&gt;
&lt;mac address='52:54:00:e2:75:a4'/&gt;
&lt;source network='default'/&gt;
&lt;model type='virtio'/&gt;
&lt;address type='pci' domain='0x0000' bus='0x00' slot='0x07' function='0x0'/&gt;
&lt;/interface&gt;

This mac address (and pci addressing information) is stored in the 
persistent config for the guest, so they will be the same every time the 
guest is started.

If this is not happening, it's due to 1 of 3 reasons:

1) You are using a *very* old libvirt. I'm fairly certain, that it has 
auto-generated mac addresses at least since I became involved with 
libvirt 2 years ago (and possibly it's always been that way).

2) The guests are being "virsh create"ed as transient guests, so that 
the auto-generated mac address is never saved. "virsh create" is the 
wrong tool for this job, a combination of "virsh define" followed by 
"virsh start" would be more appropriate.

3) there is a bug somewhere.

&gt; 2011/2/10 Laine Stump&lt;laine@laine.org&gt;:
&gt;&gt; On 02/10/2011 08:50 AM, Tanguy ROZIER wrote:
&gt;&gt;&gt; Your problem is related to udev : every reboot of VM, udev in VM
&gt;&gt;&gt; checks the MAC address of the ethernet interface of the system to
&gt;&gt;&gt; associate it with a static name (eth0, eth1...).
&gt;&gt;&gt; If you change the MAC address of the Ethernet interface of your VM, it
&gt;&gt;&gt; will detect a new interface and associate it with a new name (ethx+1).
&gt;&gt;&gt; In order to avoid it :
&gt;&gt;&gt; try not to change the MAC address of your VM ethernet device (you can
&gt;&gt;&gt; fix it with libvirt xml),
&gt;&gt; When a domain is defined with an interface, if no mac address is supplied,
&gt;&gt; libvirt will automatically generate one and write that generated mac back to
&gt;&gt; the config, so that the next time the guest boots it will be presented with
&gt;&gt; an ethernet having the same mac address as the previous time.
&gt;&gt;
&gt;&gt; How are you defining your guests? Are you perhaps using "virsh create" (but
&gt;&gt; using an existing image file) to create a transient guest each time you want
&gt;&gt; to boot the guest, rather than doing "virsh define" once to create a
&gt;&gt; persistent guest, then using "virsh start" each time you want to boot it?
&gt;&gt; You should be doing the latter - if you continuously use "virsh create",
&gt;&gt; libvirt will think that it's a "throw away" guest, and won't save the config
&gt;&gt; (or any changes to it), so the next time you do "virsh create", the disk
&gt;&gt; image will have memory of the previous run (by having "eth0" assigned to
&gt;&gt; some particular mac address), but libvirt won't have any memory of it (it
&gt;&gt; thinks you're creating a brand new guest), so it will generate a new mac
&gt;&gt; address for the interface, the guest will boot, see a "new" interface,
&gt;&gt; notice that "eth0" is already taken, so it will use "eth1", and so on.
&gt;&gt;
&gt;&gt; If you actually are using "virsh define" to define a persistent guest, do a
&gt;&gt; "virsh dumpxml" of the guest after you've started and destroyed it, and see
&gt;&gt; if there is a mac address in the interface config. If not, that's a bug.
&gt;&gt;
&gt;&gt;
&gt;&gt;&gt; or deactivate this mecanism in the VM : search in
&gt;&gt;&gt; /etc/udev/rules.d/70-persistent-net.rules : it calls
&gt;&gt;&gt; /lib/udev/write_net_rules at every reboot, you could chmod -x this
&gt;&gt;&gt; script in order to avoid it.
&gt;&gt; This may work (or may not - I haven't investigated), but it isn't the right
&gt;&gt; way to fix this problem. It's dealing with the symptom rather than the
&gt;&gt; cause.
&gt;&gt;
&gt;&gt;
&gt;&gt;&gt; Tanguy
&gt;&gt;&gt;
&gt;&gt;&gt; 2011/2/10 Marcela Castro León&lt;mcastrol@gmail.com&gt;:
&gt;&gt;&gt;&gt; Hello Laine:
&gt;&gt;&gt;&gt; I've revised the configuration and followed all your instructions.
&gt;&gt;&gt;&gt; I'll try to give you a better explain of my problem.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; a) I need a bridged (3) configuration, because I have to connect the
&gt;&gt;&gt;&gt; guests
&gt;&gt;&gt;&gt; from each others. (via ssh and execute mpi). I've three hosts, each of
&gt;&gt;&gt;&gt; one
&gt;&gt;&gt;&gt; has at least a guest.
&gt;&gt;&gt;&gt; I'll only explain about the configuration of one of them, because the
&gt;&gt;&gt;&gt; problem is only related a one configuration.
&gt;&gt;&gt;&gt; hostname=rionegro  ip=192.168.1.4
&gt;&gt;&gt;&gt; guest-name=rnompi1
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; b) I've configured host bridge following step by step ther instruction on
&gt;&gt;&gt;&gt; http://wiki.libvirt.org/page/Networking
&gt;&gt;&gt;&gt; this is the /etc/network/config
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; # The loopback network interface
&gt;&gt;&gt;&gt; auto lo
&gt;&gt;&gt;&gt; iface lo inet loopback
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; auto br0
&gt;&gt;&gt;&gt; iface br0 inet static
&gt;&gt;&gt;&gt; address 192.168.1.4
&gt;&gt;&gt;&gt; netmask 255.255.255.0
&gt;&gt;&gt;&gt; network 192.168.1.0
&gt;&gt;&gt;&gt; broadcast 192.168.1.255
&gt;&gt;&gt;&gt; gateway 192.168.1.10
&gt;&gt;&gt;&gt; bridge_ports eth0
&gt;&gt;&gt;&gt; bridge_stp on
&gt;&gt;&gt;&gt; bridge_fd 0
&gt;&gt;&gt;&gt; bridge_maxwait 0
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; c) this is the xml guest configuration related to the network.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;      &lt;interface type='bridge'&gt;
&gt;&gt;&gt;&gt;        &lt;source bridge='br0'/&gt;
&gt;&gt;&gt;&gt;      &lt;/interface&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; d) But the guest doesn't get any IP automatically, and create an
&gt;&gt;&gt;&gt; interface
&gt;&gt;&gt;&gt; with a variable name (eth4, eth5,etch6..). I don't know how to achieve
&gt;&gt;&gt;&gt; the
&gt;&gt;&gt;&gt; guest don't behave like this and create always its network interface with
&gt;&gt;&gt;&gt; a
&gt;&gt;&gt;&gt; fixed name, for example, eth0).
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Why I ask that?
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; if the guest created an interface with a fixed name, I would configure
&gt;&gt;&gt;&gt; and
&gt;&gt;&gt;&gt; static ip for the it.
&gt;&gt;&gt;&gt; I'm attaching a printscreen "rnompi1.jpg"  that show what ifconfig ahow
&gt;&gt;&gt;&gt; on
&gt;&gt;&gt;&gt; the guest (eth14 and without any IP). It doesn't get their host either.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; The only way I achieve to solve but "temporally" until reboot is
&gt;&gt;&gt;&gt; configuring
&gt;&gt;&gt;&gt; the guest statically using the name of the interface that has just up.In
&gt;&gt;&gt;&gt; that case every works fine, and the guest can connect to all the other
&gt;&gt;&gt;&gt; guests on the lan and others can connect to it.
&gt;&gt;&gt;&gt; But this only works until reboot or reconfigure the guest, because each
&gt;&gt;&gt;&gt; time
&gt;&gt;&gt;&gt; the name of interface change, and my configuration I had done of
&gt;&gt;&gt;&gt; /etc/network/interface didn't work any more because is related to another
&gt;&gt;&gt;&gt; interface.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; I hope I've explained better the problem I have.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Thank you very much, you've already helped too much to better understand
&gt;&gt;&gt;&gt; the
&gt;&gt;&gt;&gt; different cases of network configuration
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Regards.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; 2011/2/10 Marcela Castro León&lt;mcastrol@gmail.com&gt;
&gt;&gt;&gt;&gt;&gt; Hello Laine:
&gt;&gt;&gt;&gt;&gt; Thank you very much.
&gt;&gt;&gt;&gt;&gt; I've showed only one of the guest, each one have it's own ip address.
&gt;&gt;&gt;&gt;&gt; Anyway, I'll follow your advise of revise all the configuration after
&gt;&gt;&gt;&gt;&gt; reading the doc.
&gt;&gt;&gt;&gt;&gt; Thank you very much again.
&gt;&gt;&gt;&gt;&gt; Regards.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; 2011/2/8 Laine Stump&lt;laine@laine.org&gt;
&gt;&gt;&gt;&gt;&gt;&gt; (For future questions such as this, you may find you get a better
&gt;&gt;&gt;&gt;&gt;&gt; response (and lower signal-noise ratio) by asking on the recently
&gt;&gt;&gt;&gt;&gt;&gt; -created
&gt;&gt;&gt;&gt;&gt;&gt; libvirt-users@redhat.com list, as libvir-list has a very large volume
&gt;&gt;&gt;&gt;&gt;&gt; of
&gt;&gt;&gt;&gt;&gt;&gt; patches and discussion about the internals of libvirt)
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; On 02/08/2011 12:05 PM, Marcela Castro León wrote:
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Hello
&gt;&gt;&gt;&gt;&gt;&gt; I've a lan of virtual machine configured with bridge. I've a private
&gt;&gt;&gt;&gt;&gt;&gt; lan
&gt;&gt;&gt;&gt;&gt;&gt; of 4 machine, but one of them have 2 lan-card with access to internet.
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Evertything works almost fine, except that I've configured on each
&gt;&gt;&gt;&gt;&gt;&gt; guest
&gt;&gt;&gt;&gt;&gt;&gt; the static configuration of the bridge with the ip address, like this:
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; auto lo
&gt;&gt;&gt;&gt;&gt;&gt; iface lo inet loopback
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; auto eth6
&gt;&gt;&gt;&gt;&gt;&gt; iface eth6 inet static
&gt;&gt;&gt;&gt;&gt;&gt; address 192.168.1.41
&gt;&gt;&gt;&gt;&gt;&gt; network 192.168.1.0
&gt;&gt;&gt;&gt;&gt;&gt; netmask 255.255.255.0
&gt;&gt;&gt;&gt;&gt;&gt; gateway 192.168.1.10
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; So are you saying that you're attempting to give each guest the *same*
&gt;&gt;&gt;&gt;&gt;&gt; IP
&gt;&gt;&gt;&gt;&gt;&gt; address? There's no way that can possibly work, even if each is
&gt;&gt;&gt;&gt;&gt;&gt; connected to
&gt;&gt;&gt;&gt;&gt;&gt; a separate virtual network or bridge. Since the host's IP stack can
&gt;&gt;&gt;&gt;&gt;&gt; "see"
&gt;&gt;&gt;&gt;&gt;&gt; all of the guests' network traffic, regardless of the connection mode
&gt;&gt;&gt;&gt;&gt;&gt; you
&gt;&gt;&gt;&gt;&gt;&gt; choose, each must have a unique IP address even if they can't see each
&gt;&gt;&gt;&gt;&gt;&gt; other.
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; But each time I, for example, define the guest, it start with a
&gt;&gt;&gt;&gt;&gt;&gt; ascending
&gt;&gt;&gt;&gt;&gt;&gt; number of interface: eth6,eth7, eth8, etc, Now is initializing with
&gt;&gt;&gt;&gt;&gt;&gt; eth12.
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; There must be a mixup in the explanation - I'm understanding that you
&gt;&gt;&gt;&gt;&gt;&gt; put
&gt;&gt;&gt;&gt;&gt;&gt; the same config file in each guest, but each guest, when it starts,
&gt;&gt;&gt;&gt;&gt;&gt; shows a
&gt;&gt;&gt;&gt;&gt;&gt; different ethernet interface in its ifconfig. That doesn't seem right,
&gt;&gt;&gt;&gt;&gt;&gt; because none of the guests know about each other. Or are you saying
&gt;&gt;&gt;&gt;&gt;&gt; something different? Where are you seeing the "eth6", "eth7", ...
&gt;&gt;&gt;&gt;&gt;&gt; "eth12"?
&gt;&gt;&gt;&gt;&gt;&gt; In the guest XML config maybe?
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; So, it doesn't get the manual configuration I've done on the
&gt;&gt;&gt;&gt;&gt;&gt; /etc/network/interfaces.
&gt;&gt;&gt;&gt;&gt;&gt; How can avoid this way of work of the number of ethernet interface the
&gt;&gt;&gt;&gt;&gt;&gt; guest start?
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Why are you doing a manual/static definition on the guest at all? It's
&gt;&gt;&gt;&gt;&gt;&gt; simpler to just leave the guest to automatically configure its eth0,
&gt;&gt;&gt;&gt;&gt;&gt; and if
&gt;&gt;&gt;&gt;&gt;&gt; you really want a particular IP address for a particular guest, handle
&gt;&gt;&gt;&gt;&gt;&gt; that
&gt;&gt;&gt;&gt;&gt;&gt; with a&lt;host&gt;    element in the&lt;dhcp&gt;    section of the virtual network the
&gt;&gt;&gt;&gt;&gt;&gt; guest
&gt;&gt;&gt;&gt;&gt;&gt; is connected to (or, if you're using a pure bridging setup, then in the
&gt;&gt;&gt;&gt;&gt;&gt; static hosts config of the dhcp server on that network).
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; A way i'm trying to solve is configuring the interface trough the guest
&gt;&gt;&gt;&gt;&gt;&gt; xml definition,
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; The guest xml interface configuration cannot be used to setup the IP
&gt;&gt;&gt;&gt;&gt;&gt; address, route, etc config of the guest. It is only used for two
&gt;&gt;&gt;&gt;&gt;&gt; things:
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; 1) configuring what kind of hardware appears on the guest (but not what
&gt;&gt;&gt;&gt;&gt;&gt; name the guest gives to it!)
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; 2) configuring how that hardware is connected to the physical network
&gt;&gt;&gt;&gt;&gt;&gt; (usually either via an existing bridge interface on the host (in order
&gt;&gt;&gt;&gt;&gt;&gt; for
&gt;&gt;&gt;&gt;&gt;&gt; the guest to appear as if its directly connected to the physical
&gt;&gt;&gt;&gt;&gt;&gt; network),
&gt;&gt;&gt;&gt;&gt;&gt; or via a "virtual network" created by libvirt (which is really just a
&gt;&gt;&gt;&gt;&gt;&gt; bridge
&gt;&gt;&gt;&gt;&gt;&gt; that's not directly connected to any physical interface, relying
&gt;&gt;&gt;&gt;&gt;&gt; instead on
&gt;&gt;&gt;&gt;&gt;&gt; the host's IP stack to route packets from the guest out to the physical
&gt;&gt;&gt;&gt;&gt;&gt; network.)
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; but the operation "define" on virsh accepted without error the xml i've
&gt;&gt;&gt;&gt;&gt;&gt; done, but the dumpxml doesn't show them, so, it doesn't work at all.
&gt;&gt;&gt;&gt;&gt;&gt; I've followed the instruction that said the manual "Application
&gt;&gt;&gt;&gt;&gt;&gt; development guide - a guide to application development with libvirt" on
&gt;&gt;&gt;&gt;&gt;&gt; page
&gt;&gt;&gt;&gt;&gt;&gt; 71.
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; That document is targeted towards software developers writing
&gt;&gt;&gt;&gt;&gt;&gt; applications to manage virtual guests using the libvirt API, not for
&gt;&gt;&gt;&gt;&gt;&gt; system
&gt;&gt;&gt;&gt;&gt;&gt; administrators who are configuring virtual guests manually (or, more
&gt;&gt;&gt;&gt;&gt;&gt; likely,
&gt;&gt;&gt;&gt;&gt;&gt; by using software that uses the libvirt API, eg virsh or virt-manager).
&gt;&gt;&gt;&gt;&gt;&gt; It
&gt;&gt;&gt;&gt;&gt;&gt; likely contains more detail and less overview than what you need, which
&gt;&gt;&gt;&gt;&gt;&gt; is
&gt;&gt;&gt;&gt;&gt;&gt; probably what led to the confusion. I've included a pointer to a wiki
&gt;&gt;&gt;&gt;&gt;&gt; page
&gt;&gt;&gt;&gt;&gt;&gt; below that is more the appropriate level of information (Justin, if the
&gt;&gt;&gt;&gt;&gt;&gt; docs
&gt;&gt;&gt;&gt;&gt;&gt; you were working on are somewhere easily accessible, you can point to
&gt;&gt;&gt;&gt;&gt;&gt; those
&gt;&gt;&gt;&gt;&gt;&gt; instead.)
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; The whole definition of the VM is attached, but the related to
&gt;&gt;&gt;&gt;&gt;&gt; interface
&gt;&gt;&gt;&gt;&gt;&gt; is:
&gt;&gt;&gt;&gt;&gt;&gt;      &lt;interface type='bridge'&gt;
&gt;&gt;&gt;&gt;&gt;&gt;        &lt;source bridge='br0'/&gt;
&gt;&gt;&gt;&gt;&gt;&gt;        &lt;target dev='vnet0'/&gt;
&gt;&gt;&gt;&gt;&gt;&gt;      &lt;protocol&gt;
&gt;&gt;&gt;&gt;&gt;&gt;          &lt;ip address="192.168.1.41" prefix="24"/&gt;
&gt;&gt;&gt;&gt;&gt;&gt;          &lt;route gateway="192.168.1.10"/&gt;
&gt;&gt;&gt;&gt;&gt;&gt;      &lt;/protocol&gt;
&gt;&gt;&gt;&gt;&gt;&gt;      &lt;bridge stp="off" delay="0.01"&gt;
&gt;&gt;&gt;&gt;&gt;&gt;      &lt;interface type="ethernet" name="eth12"&gt;
&gt;&gt;&gt;&gt;&gt;&gt;      &lt;protocol&gt;
&gt;&gt;&gt;&gt;&gt;&gt;          &lt;ip address="192.168.1.41" prefix="24"/&gt;
&gt;&gt;&gt;&gt;&gt;&gt;          &lt;route gateway="192.168.1.10"/&gt;
&gt;&gt;&gt;&gt;&gt;&gt;      &lt;/protocol&gt;
&gt;&gt;&gt;&gt;&gt;&gt;      &lt;/interface&gt;
&gt;&gt;&gt;&gt;&gt;&gt;      &lt;/bridge&gt;
&gt;&gt;&gt;&gt;&gt;&gt;      &lt;/interface&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; You are confusing the guest interface config (that is part of the
&gt;&gt;&gt;&gt;&gt;&gt; guest's
&gt;&gt;&gt;&gt;&gt;&gt; XML config, and described above), and host physical interface config
&gt;&gt;&gt;&gt;&gt;&gt; (that
&gt;&gt;&gt;&gt;&gt;&gt; is not in any way associated with guest config, but instead used to
&gt;&gt;&gt;&gt;&gt;&gt; configure the host's physical network interfaces, bridges, bonds, and
&gt;&gt;&gt;&gt;&gt;&gt; vlan
&gt;&gt;&gt;&gt;&gt;&gt; interfaces; and nearly as important, is not supported on Ubuntu
&gt;&gt;&gt;&gt;&gt;&gt; anyway).
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Actual guest interface config is *much* simpler than that.
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; But after define, the dumpxml only show this part:
&gt;&gt;&gt;&gt;&gt;&gt;      &lt;interface type='bridge'&gt;
&gt;&gt;&gt;&gt;&gt;&gt;        &lt;mac address='52:54:00:3c:92:9a'/&gt;
&gt;&gt;&gt;&gt;&gt;&gt;        &lt;source bridge='br0'/&gt;
&gt;&gt;&gt;&gt;&gt;&gt;      &lt;/interface&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; That's because everything else you've put in your guest config is not
&gt;&gt;&gt;&gt;&gt;&gt; actually a part of a valid guest interface config, and so is ignored.
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; I would appreciate any help to solve the question. The problem I've is
&gt;&gt;&gt;&gt;&gt;&gt; I
&gt;&gt;&gt;&gt;&gt;&gt; lost the access to the guest every time the libvirt change the name of
&gt;&gt;&gt;&gt;&gt;&gt; the
&gt;&gt;&gt;&gt;&gt;&gt; interface eth1,2,3, etc.
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; In this case I think it may be useful to start over. You've somehow
&gt;&gt;&gt;&gt;&gt;&gt; been
&gt;&gt;&gt;&gt;&gt;&gt; tricked into misunderstanding the way that network configuration in
&gt;&gt;&gt;&gt;&gt;&gt; libvirt
&gt;&gt;&gt;&gt;&gt;&gt; works, confusing host interface config with guest interface config, and
&gt;&gt;&gt;&gt;&gt;&gt; the
&gt;&gt;&gt;&gt;&gt;&gt; resulting config bears little resemblance to what would actually work.
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; ==
&gt;&gt;&gt;&gt;&gt;&gt; The first step is to read this page:
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;     http://wiki.libvirt.org/page/Networking
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; to get a basic overview.
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; ==
&gt;&gt;&gt;&gt;&gt;&gt; Second step: you should decide which of the three methods of connecting
&gt;&gt;&gt;&gt;&gt;&gt; to guests to the physical network you want to use:
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; 1) NATed
&gt;&gt;&gt;&gt;&gt;&gt; 2) routed
&gt;&gt;&gt;&gt;&gt;&gt; 3) bridged
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; The simplest is (1), and that will probably work just fine as long as
&gt;&gt;&gt;&gt;&gt;&gt; 1)
&gt;&gt;&gt;&gt;&gt;&gt; you don't need incoming connections to the guests, and 2) you're not
&gt;&gt;&gt;&gt;&gt;&gt; concerned about getting the last fraction of an ounce of performance
&gt;&gt;&gt;&gt;&gt;&gt; out of
&gt;&gt;&gt;&gt;&gt;&gt; the network.
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Depending on which of those 3 you decide to use:
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; ==
&gt;&gt;&gt;&gt;&gt;&gt; Third step: follow the instructions to either create a bridge interface
&gt;&gt;&gt;&gt;&gt;&gt; on the host connected to a physical network interface (for (3)), or to
&gt;&gt;&gt;&gt;&gt;&gt; create a libvirt virtual network using one of the two modes ((1) or (2)
&gt;&gt;&gt;&gt;&gt;&gt; -
&gt;&gt;&gt;&gt;&gt;&gt; actually the stock libvirt config already has a "default" network that
&gt;&gt;&gt;&gt;&gt;&gt; is
&gt;&gt;&gt;&gt;&gt;&gt; probably adequate for (1), and unless you understand IP routing very
&gt;&gt;&gt;&gt;&gt;&gt; well,
&gt;&gt;&gt;&gt;&gt;&gt; you'll likely want to avoid (2)).
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Once the physical network is setup:
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; ==
&gt;&gt;&gt;&gt;&gt;&gt; Fourth step: define your guests. In each guest, you'll have an
&gt;&gt;&gt;&gt;&gt;&gt; &lt;interface&gt;    element, but it will be much simpler than what you've
&gt;&gt;&gt;&gt;&gt;&gt; previously
&gt;&gt;&gt;&gt;&gt;&gt; tried. For bridged mode, the interface section would look like this:
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;    &lt;interface type='bridge'&gt;
&gt;&gt;&gt;&gt;&gt;&gt;      &lt;source bridge='br0'/&gt;
&gt;&gt;&gt;&gt;&gt;&gt;    &lt;/interface&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Depending on the guest, you may want to specify what type of hardware
&gt;&gt;&gt;&gt;&gt;&gt; is
&gt;&gt;&gt;&gt;&gt;&gt; presented to the guest (default is rtl, which almost always works, but
&gt;&gt;&gt;&gt;&gt;&gt; is
&gt;&gt;&gt;&gt;&gt;&gt; not the best perfrorming), in particular, if the guest supports
&gt;&gt;&gt;&gt;&gt;&gt; virtio-net,
&gt;&gt;&gt;&gt;&gt;&gt; you'll want to add this into the&lt;interface&gt;    element:
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;    &lt;model type='virtio'/&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; For NATed or routed mode, the guest's interface definition would look
&gt;&gt;&gt;&gt;&gt;&gt; like this:
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;    &lt;interface type='network'&gt;
&gt;&gt;&gt;&gt;&gt;&gt;       &lt;source network='default'/&gt;
&gt;&gt;&gt;&gt;&gt;&gt;    &lt;/interface&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; (replace "default" with the name of the network you've defined, if
&gt;&gt;&gt;&gt;&gt;&gt; you've
&gt;&gt;&gt;&gt;&gt;&gt; defined your own). In this case also, you can add a&lt;model type='...'/&gt;
&gt;&gt;&gt;&gt;&gt;&gt;   if
&gt;&gt;&gt;&gt;&gt;&gt; appropriate.
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Note that I don't put anything in the&lt;interface&gt;    element about MAC
&gt;&gt;&gt;&gt;&gt;&gt; address, target device, or bus address. Those are all setup
&gt;&gt;&gt;&gt;&gt;&gt; automatically by
&gt;&gt;&gt;&gt;&gt;&gt; libvirt the first time you start the guest, and it will make sure that
&gt;&gt;&gt;&gt;&gt;&gt; the
&gt;&gt;&gt;&gt;&gt;&gt; guests don't interfere with each other.
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; ==
&gt;&gt;&gt;&gt;&gt;&gt; Fifth step: only if you need a particular guest to have a particular
&gt;&gt;&gt;&gt;&gt;&gt; fixed IP address, either 1) edit the network config file on the guest,
&gt;&gt;&gt;&gt;&gt;&gt; 2)
&gt;&gt;&gt;&gt;&gt;&gt; add a static host to the libvirt virtual network definition (giving the
&gt;&gt;&gt;&gt;&gt;&gt; MAC
&gt;&gt;&gt;&gt;&gt;&gt; address provided to the guest by libvirt during the initial guest
&gt;&gt;&gt;&gt;&gt;&gt; startup)
&gt;&gt;&gt;&gt;&gt;&gt; with a&lt;host&gt;    element added to the&lt;dhcp&gt;    element of the network;
&gt;&gt;&gt;&gt;&gt;&gt; details
&gt;&gt;&gt;&gt;&gt;&gt; are here:
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;      http://www.libvirt.org/formatnetwork.html
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; or 3) if you're using the bridged method to connect to the physical
&gt;&gt;&gt;&gt;&gt;&gt; network, again either configure the guest's own config file, or add a
&gt;&gt;&gt;&gt;&gt;&gt; static
&gt;&gt;&gt;&gt;&gt;&gt; host definition to the dhcp server running on your physical network.
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; If you still have problems don't hesitate to send another mail
&gt;&gt;&gt;&gt;&gt;&gt; (although,
&gt;&gt;&gt;&gt;&gt;&gt; as I said at the top, sending to libvirt-users@redhat.com may yield
&gt;&gt;&gt;&gt;&gt;&gt; better
&gt;&gt;&gt;&gt;&gt;&gt; results than libvir-list@redhat.com).
&gt;&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt;&gt; libvirt-users mailing list
&gt;&gt;&gt;&gt; libvirt-users@redhat.com
&gt;&gt;&gt;&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt;
&gt;

</body></email><email><emailId>20110209184632</emailId><senderName>Kenneth Armstrong</senderName><senderEmail>digimars@gmail.com</senderEmail><timestampReceived>2011-02-09 18:46:32-0400</timestampReceived><subject>Re: [libvirt-users] [virt-tools-list] store vm xml files in another directory</subject><body>

Cool, thanks for the link.

- Kenny

On Wed, Feb 9, 2011 at 12:26 PM, Cole Robinson &lt;crobinso@redhat.com&gt; wrote:
&gt; On 02/08/2011 03:05 PM, Kenneth Armstrong wrote:
&gt;&gt; I know that by default, vm xml files are in
&gt;&gt; /etc/libvirt/qemu/vm-name.xml, but is there a configuration somewhere
&gt;&gt; that I could point to another directory?  For instance, have it on
&gt;&gt; something like /srv/qemu/xml/vm-name.xml which would be a GFS2
&gt;&gt; filesystem (for HA purposes)?
&gt;&gt;
&gt;
&gt;
&gt; It isn't configurable, short of modifying the source code and recompiling.
&gt;
&gt; As far as sharing /etc/libvirt/qemu, Dan has responded to that question in the
&gt; past:
&gt;
&gt; http://www.mail-archive.com/libvir-list@redhat.com/msg16921.html
&gt;
&gt; - Cole
&gt;

</body></email><email><emailId>20110209190815</emailId><senderName>Kenneth Armstrong</senderName><senderEmail>digimars@gmail.com</senderEmail><timestampReceived>2011-02-09 19:08:15-0400</timestampReceived><subject>Re: [libvirt-users] [virt-tools-list] store vm xml files in another directory</subject><body>

Here's my latest thoughts on how to do this:

With 2 nodes, and using the Red Hat Cluster suite to fence the two
hosts, and all vm disk images stored on shared storage (for example,
an iSCSI LUN) that both hosts will have access to, and using a GFS2
formatted partition on each node.  Also, using Bind Mounts to mount
/etc/libvirt/qemu onto the GFS2 partition so that the vm xml files
will be sync'ed up between both hosts.

Does that make sense?  Or would their be something simpler to try?

-Kenny

On Wed, Feb 9, 2011 at 1:46 PM, Kenneth Armstrong &lt;digimars@gmail.com&gt; wrote:
&gt; Cool, thanks for the link.
&gt;
&gt; - Kenny
&gt;
&gt; On Wed, Feb 9, 2011 at 12:26 PM, Cole Robinson &lt;crobinso@redhat.com&gt; wrote:
&gt;&gt; On 02/08/2011 03:05 PM, Kenneth Armstrong wrote:
&gt;&gt;&gt; I know that by default, vm xml files are in
&gt;&gt;&gt; /etc/libvirt/qemu/vm-name.xml, but is there a configuration somewhere
&gt;&gt;&gt; that I could point to another directory?  For instance, have it on
&gt;&gt;&gt; something like /srv/qemu/xml/vm-name.xml which would be a GFS2
&gt;&gt;&gt; filesystem (for HA purposes)?
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; It isn't configurable, short of modifying the source code and recompiling.
&gt;&gt;
&gt;&gt; As far as sharing /etc/libvirt/qemu, Dan has responded to that question in the
&gt;&gt; past:
&gt;&gt;
&gt;&gt; http://www.mail-archive.com/libvir-list@redhat.com/msg16921.html
&gt;&gt;
&gt;&gt; - Cole
&gt;&gt;
&gt;

</body></email><email><emailId>20110209193323</emailId><senderName>Thomas Sjolshagen</senderName><senderEmail>thomas@sjolshagen.net</senderEmail><timestampReceived>2011-02-09 19:33:23-0400</timestampReceived><subject>Re: [libvirt-users] [virt-tools-list] store vm xml files in another directory</subject><body>

On Wed, 9 Feb 2011 14:08:15 -0500, Kenneth Armstrong wrote: 

&gt;
Here's my latest thoughts on how to do this:
&gt; 
&gt; With 2 nodes, and
using the Red Hat Cluster suite to fence the two
&gt; hosts, and all vm
disk images stored on shared storage (for example,
&gt; an iSCSI LUN) that
both hosts will have access to, and using a GFS2
&gt; formatted partition
on each node. Also, using Bind Mounts to mount
&gt; /etc/libvirt/qemu onto
the GFS2 partition so that the vm xml files
&gt; will be sync'ed up between
both hosts.
&gt; 
&gt; Does that make sense? Or would their be something
simpler to try?

Why do you need shared copies of the xml?I've got a
shared GFS2 file system for the VM image files, using rmganager to
manage the VMs and have the xml defined statically in the libvirtd
instances on the cluster members. If/when I change something in terms of
the VM definition on one cluster member, I "# virsh dumpxml  &gt; ./vm.xml"
and "# virsh define" it on the other members. Same UUID for the VMs on
all cluster members.
 
[Attachment #3 (unknown)]

&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"&gt;
&lt;html&gt;&lt;body&gt;
&lt;p&gt;On Wed, 9 Feb 2011 14:08:15 -0500, Kenneth Armstrong wrote:&lt;/p&gt;
&lt;blockquote type="cite" style="padding-left:5px; border-left:#1010ff 2px solid; \
margin-left:5px; width:100%"&gt; &lt;pre&gt;Here's my latest thoughts on how to do this:

With 2 nodes, and using the Red Hat Cluster suite to fence the two
hosts, and all vm disk images stored on shared storage (for example,
an iSCSI LUN) that both hosts will have access to, and using a GFS2
formatted partition on each node.  Also, using Bind Mounts to mount
/etc/libvirt/qemu onto the GFS2 partition so that the vm xml files
will be sync'ed up between both hosts.

Does that make sense?  Or would their be something simpler to try?

&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;p&gt;Why do you need shared copies of the xml?&lt;/p&gt;I've got a shared GFS2 file \
system for the VM image files, using rmganager to manage the VMs and have the xml \
defined statically in the libvirtd instances on the cluster members. If/when I change \
something in terms of the VM definition on one cluster member, I "# virsh dumpxml \
&lt;vm&gt; &gt; ./vm.xml" and "# virsh define" it on the other members. Same UUID for \
the VMs on all cluster members.&lt;/pre&gt; &lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20110209035804</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2011-02-09 03:58:04-0400</timestampReceived><subject>Re: [libvirt-users] Making multiple connections from an application using libvirt-0.6.3-20.1.el5_4</subject><body>

On Fri, Feb 04, 2011 at 12:04:07AM -0500, Nandini Chandra wrote:
&gt; I came across a thread in the archives that seems to suggest that
&gt; multiple connections can be made from a single application,although
&gt; I am unsure what version(s) of libvirt support it.
&gt; https://www.redhat.com/archives/libvirt-users/2010-March/msg00074.html
&gt; 
&gt; I'd like to know if multiple connections(for
&gt; eg,virConnectOpenAuth()) can be made from an application using
&gt; libvirt-0.6.3-20.1.el5_4 .

  Yes, that's should be no problem,

Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

</body></email><email><emailId>20110208161644</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-02-08 16:16:44-0400</timestampReceived><subject>Re: [libvirt-users] Libvirt in Windows not working</subject><body>

2011/2/8 arpita k &lt;arpitak29@gmail.com&gt;:
&gt; Hi,
&gt;
&gt; This is Arpita.
&gt;
&gt; I am using Libvirt API in the Windows Vista system.VMware is installed over
&gt; there.I have installed Libvirt and Python 2.6 in the Windows Vista system
&gt; andhave written a small test file in Python.

You mean you're trying to connect to an VMware ESX or Workstation or
Player installed on another computer?

&gt; Here is the code:
&gt;
&gt; import libvirt
&gt;
&gt; import
&gt;
&gt; sys
&gt;
&gt; conn = libvirt.openReadOnly(
&gt;
&gt; None)

If you try to connect to a VMware thing on another computer you need
to specify the URI (including hostname or IP address) to the
libvirt.openReadOnly call:

libvirt.openReadOnly("esx://your-esx-server.com")

Passing None only works for autodetection on local connections.

Also in order to connect to an ESX server you need to use the openAuth
function instead of the openReadOnly one.

&gt; if
&gt;
&gt; conn == None:
&gt;
&gt; print 'Failed to open connection to the hypervisor'
&gt;
&gt; sys.exit(
&gt;
&gt; 1)
&gt;
&gt; try
&gt;
&gt; :
&gt;
&gt; dom0 = conn.lookupByName(
&gt;
&gt; "vmware1")
&gt;
&gt; except
&gt;
&gt; :
&gt;
&gt; print 'Failed to find the main domain'
&gt;
&gt; sys.exit(
&gt;
&gt; 1)
&gt;
&gt; print
&gt;
&gt; "Domain 0: id %d running %s" % (dom0.ID(), dom0.OSType())
&gt;
&gt; print
&gt;
&gt; dom0.info()
&gt;
&gt; When I am trying to execute this python code I received error message that :
&gt;
&gt; ImportError: No module named libvirt

Currently the libvirt installer for Windows includes the Python
bindings but doesn't try to detect an installed Python to put the
bindings into the right place yet.

You have to do this manually. Copy libvirt.py and libvirtmod.py from
the python subdirectory of your libvirt installation to the
Lib\site-packages subdirectory in your Python 2.6 installation, for
example C:\Python26\Lib\site-packages. Now Python should be able to
find the libvirt module.

Matthias

</body></email><email><emailId>20110204101403</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-02-04 10:14:03-0400</timestampReceived><subject>Re: [libvirt-users] Disk atomicity...</subject><body>

On Fri, Feb 04, 2011 at 04:29:35AM -0500, Dale Amon wrote:
&gt; I suspect the answer is no, as the very idea makes
&gt; my head hurt, but a confirmation would be nice:
&gt; 
&gt; Am I correct in assuming that it is a very bad idea
&gt; to mount a physical disk on both the physical machine
&gt; and on a hosted VM at the same time? 
&gt; 
&gt; I can imagine getting away with it if one were RO, but
&gt; not otherwise.

Even readonly is not safe. If the host OS has a RO mount
and has partial FS metadata cached, then the guest OS
writes to the FS, this might invalidate the host metadata
and potentially confuse the host OS enough that it would
crash if you're unlucky.

If you want safe concurrent mounts then you need a clustered
or network filesystem. You can also use libguestfs for readonly
access to live guest disks (still has the potential problem I
mention above, but libguestfs runs in a VM so it avoids any
risk to your host OS)

Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110206132547</emailId><senderName>rajalakshmi</senderName><senderEmail>raji.gayathri90@gmail.com</senderEmail><timestampReceived>2011-02-06 13:25:47-0400</timestampReceived><subject>[libvirt-users] Live migration using virsh</subject><body>

Sir,
I am working in cloud environment and i have set up a private cloud using
eucalyptus. I am trying to migrate virtual machines within the cloud using
virsh migrate command. I could successfully implement it but when i wanted
to know the method used to do live migration. I tried to interpret the code.
I also saw that they are setting a flag initially if it is live migration
and then assigning 1 to variable live. and i also could find that
xenDomainMigratePrepare is calling xend_op which in turn is calling
xend_op_ext. But i could'n understand the method of migration. Can you
please explain the logic?

[Attachment #3 (text/html)]

Sir,&lt;br&gt;&lt;div class="gmail_quote"&gt;I am working in cloud environment and i have set up \
a private cloud using eucalyptus. I am trying to migrate virtual machines within the \
cloud using virsh migrate command. I could successfully implement it but when i \
wanted to know the method used to do live migration. I tried to interpret the code. I \
also saw that they are setting a flag initially if it is live migration and then \
assigning 1 to variable live. and i also could find that xenDomainMigratePrepare is \
calling xend_op which in turn is calling xend_op_ext. But i could'n understand \
the method of migration. Can you please explain the logic?&lt;br&gt;


&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110207135708</emailId><senderName>David W King</senderName><senderEmail>davidwk@goshen.edu</senderEmail><timestampReceived>2011-02-07 13:57:08-0400</timestampReceived><subject>Re: [libvirt-users] Disk atomicity...</subject><body>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

It is okay to do concurrent mounts if _all_ of the mounts are RO, right?
 I frequently have many VM's mounting the same DVD iso (RO, of course).
 Should I be anticipating disaster?

David King
Goshen College ITS
davidwk@goshen.edu
574-535-7726


On 02/04/2011 05:14 AM, Daniel P. Berrange wrote:
&gt; On Fri, Feb 04, 2011 at 04:29:35AM -0500, Dale Amon wrote:
&gt;&gt; I suspect the answer is no, as the very idea makes
&gt;&gt; my head hurt, but a confirmation would be nice:
&gt;&gt;
&gt;&gt; Am I correct in assuming that it is a very bad idea
&gt;&gt; to mount a physical disk on both the physical machine
&gt;&gt; and on a hosted VM at the same time? 
&gt;&gt;
&gt;&gt; I can imagine getting away with it if one were RO, but
&gt;&gt; not otherwise.
&gt; 
&gt; Even readonly is not safe. If the host OS has a RO mount
&gt; and has partial FS metadata cached, then the guest OS
&gt; writes to the FS, this might invalidate the host metadata
&gt; and potentially confuse the host OS enough that it would
&gt; crash if you're unlucky.
&gt; 
&gt; If you want safe concurrent mounts then you need a clustered
&gt; or network filesystem. You can also use libguestfs for readonly
&gt; access to live guest disks (still has the potential problem I
&gt; mention above, but libguestfs runs in a VM so it avoids any
&gt; risk to your host OS)
&gt; 
&gt; Daniel
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAk1P+jQACgkQH+/Vg7DylXYz4gCcD2+/J85sjqGYKKieDledchg5
pAkAn2xxzjuPld7mf8zc1taNiPIC/ZrL
=y66D
-----END PGP SIGNATURE-----

</body></email><email><emailId>20110208185849</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-02-08 18:58:49-0400</timestampReceived><subject>Re: [libvirt-users] Libvirt in Windows not working</subject><body>

On 09/02/2011, at 3:16 AM, Matthias Bolte wrote:
&lt;snip&gt;
&gt; Currently the libvirt installer for Windows includes the Python
&gt; bindings but doesn't try to detect an installed Python to put the
&gt; bindings into the right place yet.
&gt; 
&gt; You have to do this manually. Copy libvirt.py and libvirtmod.py from
&gt; the python subdirectory of your libvirt installation to the
&gt; Lib\site-packages subdirectory in your Python 2.6 installation, for
&gt; example C:\Python26\Lib\site-packages. Now Python should be able to
&gt; find the libvirt module.

Aha, we should add this to the README file for the windows installer.

(adding this to my ToDo list)

+ Justin

</body></email><email><emailId>20110208211441</emailId><senderName>Adam Reid</senderName><senderEmail>adam@adamreid.ca</senderEmail><timestampReceived>2011-02-08 21:14:41-0400</timestampReceived><subject>[libvirt-users] Serving DHCP and DNS from a KVM guest</subject><body>

Hello All,

I am trying to set up a cobbler server running as a guest on an isolated
network. I'm having trouble figuring out how I can forward the DHCP and DNS
traffic to this guest instead of DNSMASQ on the host.  So far I have only
tried to get dhcp working by enabling the 'allow-dhcp-server' on a guest
named test and setting the $DHCPSERVER variable through a filterref
parameter element. I figure If I can get this working I can use this filter
as a basis for DNS.

In my guest the filter is applied to the only network interface setting
DHCPSERVER to the IP of my cobbler VM.

    &lt;interface type='network'&gt;
      &lt;mac address='52:54:00:6b:56:ab'/&gt;
      &lt;source network='internal'/&gt;
      &lt;target dev='vnet2'/&gt;
      &lt;model type='virtio'/&gt;
      &lt;filterref filter='allow-dhcp-server'&gt;
        &lt;parameter name='DHCPSERVER' value='192.168.100.2'/&gt;
      &lt;/filterref&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03'
function='0x0'/&gt;
    &lt;/interface&gt;

And the internal network is defined as:

&lt;network&gt;
  &lt;name&gt;internal&lt;/name&gt;
  &lt;uuid&gt;c1aef8ea-9d30-7514-5eb4-5ffbc235cffb&lt;/uuid&gt;
  &lt;bridge name='virbr1' stp='on' delay='0' /&gt;
  &lt;ip address='192.168.100.1' netmask='255.255.255.0'&gt;
  &lt;/ip&gt;
&lt;/network&gt;

My understanding of the filter is that when it is applied to a hosts
interface it should allow DHCP requests to go to a server other than the
host system. Is this correct? Are guests allowed to serve DHCP to other
guests?

Does anyone have any suggestions or experience with this?

Thanks in advance,

Adam Reid

[Attachment #3 (text/html)]

Hello All,&lt;br&gt;&lt;br&gt;I am trying to set up a cobbler server running as a guest on an \
isolated network. I'm having trouble figuring out how I can forward the DHCP and \
DNS traffic to this guest instead of DNSMASQ on the host.  So far I have only tried \
to get dhcp working by enabling the  'allow-dhcp-server' on a guest named \
test and setting the $DHCPSERVER variable through a filterref parameter element. I \
figure If I can get this  working I can use this filter as a basis for DNS. \
&lt;br&gt;&lt;br&gt;In my guest the filter is applied to the only network interface setting \
DHCPSERVER to the IP of my cobbler VM.&lt;br&gt;&lt;br&gt;    &lt;interface \
type='network'&gt;&lt;br&gt;  &lt;mac address='52:54:00:6b:56:ab'/&gt;&lt;br&gt;  \
&lt;source network='internal'/&gt;&lt;br&gt;      &lt;target \
dev='vnet2'/&gt;&lt;br&gt;      &lt;model type='virtio'/&gt;&lt;br&gt;      \
&lt;filterref filter='allow-dhcp-server'&gt;&lt;br&gt;  &lt;parameter \
name='DHCPSERVER' value='192.168.100.2'/&gt;&lt;br&gt;      \
&lt;/filterref&gt;&lt;br&gt;      &lt;address type='pci' domain='0x0000' \
bus='0x00' slot='0x03' function='0x0'/&gt;&lt;br&gt;  \
&lt;/interface&gt;&lt;br&gt;&lt;br&gt;And the internal network is defined \
as:&lt;br&gt;&lt;br&gt;&lt;network&gt;&lt;br&gt;  &lt;name&gt;internal&lt;/name&gt;&lt;br&gt;  \
&lt;uuid&gt;c1aef8ea-9d30-7514-5eb4-5ffbc235cffb&lt;/uuid&gt;&lt;br&gt;  &lt;bridge \
name='virbr1' stp='on' delay='0' /&gt;&lt;br&gt;  &lt;ip \
address='192.168.100.1' netmask='255.255.255.0'&gt;&lt;br&gt;  \
&lt;/ip&gt;&lt;br&gt;&lt;/network&gt;&lt;br&gt;&lt;br&gt;My understanding of the filter is that when it \
is applied to a hosts interface it should allow DHCP requests to go to a server other \
than the host system. Is this correct? Are guests allowed to serve DHCP to other \
guests?&lt;br&gt; &lt;br&gt;Does anyone have any suggestions or experience with \
this?&lt;br&gt;&lt;br&gt;Thanks in advance,&lt;br&gt;&lt;br&gt;Adam Reid&lt;br&gt;&lt;br&gt;



</body></email><email><emailId>20110209093329</emailId><senderName>Nikita A Menkovich</senderName><senderEmail>menkovich@gmail.com</senderEmail><timestampReceived>2011-02-09 09:33:29-0400</timestampReceived><subject>[libvirt-users] Question about putting vm in blkio cgroup</subject><body>

Hello,

I have another question about cgroup in libvirt
I create a script that put vm in cgroup for limiting blkio

sudo cgcreate -f 750 -d 750 -a $user:$group -g blkio:$alias
pid=`pgrep $alias`
echo $pid &gt; /dev/cgroup/blkio/$alias/tasks
$virsh schedinfo --set cpu_shares=$cpu $alias
echo "8:0 $disk_io" &gt; /dev/cgroup/blkio/$alias/blkio.throttle.read_bps_device
echo "8:0 $disk_io" &gt; /dev/cgroup/blkio/$alias/blkio.throttle.write_bps_device

For example I write:
8:0	10485760 to /dev/cgroup/blkio/$alias/blkio.throttle.*_bps_device
So there should be limit to 10Mbyte/s to acces to /dev/sda

But when I run hdparm -t /dev/vda or dd to test limits I receive value
~ 70 Mbyte/s


-- 
Nikita A Menkovich
JID: menkovich@gmail.com

</body></email><email><emailId>20110209103155</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-02-09 10:31:55-0400</timestampReceived><subject>Re: [libvirt-users] Making multiple connections from an application using libvirt-0.6.3-20.1.el5_4</subject><body>

On Wed, Feb 09, 2011 at 11:58:04AM +0800, Daniel Veillard wrote:
&gt; On Fri, Feb 04, 2011 at 12:04:07AM -0500, Nandini Chandra wrote:
&gt; &gt; I came across a thread in the archives that seems to suggest that
&gt; &gt; multiple connections can be made from a single application,although
&gt; &gt; I am unsure what version(s) of libvirt support it.
&gt; &gt; https://www.redhat.com/archives/libvirt-users/2010-March/msg00074.html
&gt; &gt; 
&gt; &gt; I'd like to know if multiple connections(for
&gt; &gt; eg,virConnectOpenAuth()) can be made from an application using
&gt; &gt; libvirt-0.6.3-20.1.el5_4 .
&gt; 
&gt;   Yes, that's should be no problem,

Though it won't help you very much if you're looking for greater
concurrency. libvirtd in 0.6.3 is still single threaded, so it
will serialize all requests from the connections

Daniel
--
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110209122325</emailId><senderName>Igor Serebryany</senderName><senderEmail>igor47@moomers.org</senderEmail><timestampReceived>2011-02-09 12:23:25-0400</timestampReceived><subject>Re: [libvirt-users] How to use Python Binding with Lbivirt.</subject><body>


Arpita,

        I have used the python bindings extensively, but AFAIK there is no
        documentation specifically for python. The python bindings closely
        follow the C API, which is documented here:

        http://libvirt.org/html/libvirt-libvirt.html

        The function names in python will closely mirror the names listed in
        that document. For instance, when you are calling 'dom0.info()' you
        are really calling 'virDomainGetInfo' -- you leave out the domain
        pointer because you are calling the function on a domain object, and
        you leave out the info pointer because in python you can just get
        that back as a return value.

        The list you're getting from 'info()' is just this structure here:

        http://libvirt.org/html/libvirt-libvirt.html#virDomainInfo

        If you get stuck, I recommend getting a connection or domain object
        inside a python interpreter and calling dir() or help() on that
        object. This can reveal other things to play with.


        &gt;&gt;&gt; import libvirt                                                            \
  &gt;&gt;&gt; c = libvirt.open(None)                                                          \
  &gt;&gt;&gt; dir(c)                                                                          \
  &gt;&gt;&gt; d = c.lookupByID(0)                                                             \
  &gt;&gt;&gt; help(d)                                                                         \


--igor

On Wed, Feb 09, 2011 at 04:48:07PM +0530, arpita k wrote:
&gt; HI,
&gt; 
&gt; I am using ubuntu host machine and KVM is present as guest in that
&gt; machine.Two virtual machines are there.I am using Python binding to query on
&gt; the hypervisor and extract the VM related information.
&gt; 
&gt; Here is my  simple code:
&gt; 
&gt; 
&gt; #!/*usr*/local/bin/*python
&gt; *
&gt; 
&gt; import libvirt
&gt; 
&gt; import sys
&gt; 
&gt; conn = libvirt.openReadOnly(None)
&gt; 
&gt; if conn == None:
&gt; 
&gt; print *'Failed to open connection to the hypervisor'
&gt; *
&gt; 
&gt; sys.exit(1)
&gt; 
&gt; try:
&gt; 
&gt; domIds = conn.listDomainsID()
&gt; 
&gt; for id in domIds:
&gt; 
&gt; dom0 = conn.lookupByID(id)
&gt; 
&gt; dom0.info()
&gt; 
&gt; print *"Domain 0: id %d running %s"* % (dom0.ID(), dom0.OSType())
&gt; 
&gt; print dom0.info()
&gt; 
&gt; except:
&gt; 
&gt; print *'Failed to find the main domain'
&gt; *
&gt; 
&gt; sys.exit()
&gt; The output is :
&gt; 
&gt; Domain 0: id 2 running hvm
&gt; [1, 131072L, 131072L, 1, 14921710000000L]
&gt; Domain 0: id 3 running hvm
&gt; [1, 131072L, 131072L, 1, 30880000000L]
&gt; 
&gt; Here I am not able to understand these values are represent what type of
&gt; information, which value is representing what resource of host machine.Could
&gt; you please help me to understand how I could find out CPU,VM ,memory related
&gt; information seperately through python binding?.
&gt; I didn't find Python binding Reference in the Libvirt site.Could you help me
&gt; by providing the Reference link for Python binding?
&gt; 
&gt; Thanks in Advance!!
&gt; 
&gt; Arpita

&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20110209214456</emailId><senderName>Kenneth Armstrong</senderName><senderEmail>digimars@gmail.com</senderEmail><timestampReceived>2011-02-09 21:44:56-0400</timestampReceived><subject>Re: [libvirt-users] [virt-tools-list] store vm xml files in another directory</subject><body>

Are you referring to a setup similar to this?:

http://sources.redhat.com/cluster/wiki/KvmMigration

- Kenny

On Wed, Feb 9, 2011 at 2:33 PM, Thomas Sjolshagen &lt;thomas@sjolshagen.net&gt; wrote:
&gt; On Wed, 9 Feb 2011 14:08:15 -0500, Kenneth Armstrong wrote:
&gt;
&gt; Here's my latest thoughts on how to do this:
&gt;
&gt; With 2 nodes, and using the Red Hat Cluster suite to fence the two
&gt; hosts, and all vm disk images stored on shared storage (for example,
&gt; an iSCSI LUN) that both hosts will have access to, and using a GFS2
&gt; formatted partition on each node.  Also, using Bind Mounts to mount
&gt; /etc/libvirt/qemu onto the GFS2 partition so that the vm xml files
&gt; will be sync'ed up between both hosts.
&gt;
&gt; Does that make sense?  Or would their be something simpler to try?
&gt;
&gt; Why do you need shared copies of the xml?
&gt;
&gt; I've got a shared GFS2 file system for the VM image files, using rmganager
&gt; to manage the VMs and have the xml defined statically in the libvirtd
&gt; instances on the cluster members. If/when I change something in terms of the
&gt; VM definition on one cluster member, I "# virsh dumpxml &lt;vm&gt; &gt; ./vm.xml" and
&gt; "# virsh define" it on the other members. Same UUID for the VMs on all
&gt; cluster members.

</body></email><email><emailId>20110210122143</emailId><senderName>arpita k</senderName><senderEmail>arpitak29@gmail.com</senderEmail><timestampReceived>2011-02-10 12:21:43-0400</timestampReceived><subject>[libvirt-users] How to retrieve Memory stat of the KVM using python binding with Libvirt API</subject><body>

Hi ,

I am using ubuntu host machine and KVM is present as guest in that
machine.Two virtual machines are there.I am using Python binding to query on
the hypervisor and extract the VM related information.I like to print memory
stat of the VM  like  SWAP_IN , SWAP_OUT,free memory, mem cached etc.So, the
code, I have written for this, is :

#!/usr/local/bin/python
import libvirt
import sys

conn = libvirt.openReadOnly(None)
if conn == None:
    print "Failed to open connection to the hypervisor"
    sys.exit(1)

try:
    domIds = conn.listDomainsID()

    for id in domIds:

        dom0 = conn.lookupByID(id)


        try:
            print "memory stats: %s"% dom0.memoryStats().values()
        except:
            print 'Failed to find the memory data of this domain'
            sys.exit(1)

except:
    print 'Failed to find the main domain'
    sys.exit(1)



But this code 'dom0.memoryStats().values()' is returning empty list.I need
to collect more information regarding the memory .How should I proceed?


Regards,
Arpita

[Attachment #3 (text/html)]

Hi ,&lt;br&gt; &lt;br&gt;I am using &lt;span style="background: none repeat scroll 0% 0% \
yellow;"&gt;ubuntu&lt;/span&gt; host machine and &lt;span style="background: none repeat scroll \
0% 0% yellow;"&gt;KVM&lt;/span&gt; is present as guest in that machine.Two virtual machines \
are there.I am using Python binding to query on the &lt;span style="background: none \
repeat scroll 0% 0% yellow;"&gt;hypervisor&lt;/span&gt; and extract the &lt;span \
style="background: none repeat scroll 0% 0% yellow;"&gt;VM&lt;/span&gt; related information.I \
like to print memory stat of the VM  like  SWAP_IN , SWAP_OUT,free memory, mem cached \
etc.So, the code, I have written for this, is :&lt;br&gt;  
&lt;br&gt;#!/usr/local/bin/python&lt;br&gt;import libvirt&lt;br&gt;import sys&lt;br&gt;&lt;br&gt;conn = \
libvirt.openReadOnly(None)&lt;br&gt;if conn == None:&lt;br&gt;    print "Failed to open \
connection to the hypervisor"&lt;br&gt;    sys.exit(1)&lt;br&gt;&lt;br&gt;try: &lt;br&gt;

    domIds = conn.listDomainsID()&lt;br&gt;    &lt;br&gt;    for id in domIds:&lt;br&gt;       &lt;br&gt;     \
dom0 = conn.lookupByID(id)&lt;br&gt;        &lt;br&gt;       &lt;br&gt;        try:&lt;br&gt;            \
print "memory stats: %s"% dom0.memoryStats().values()&lt;br&gt;

        except:&lt;br&gt;            print 'Failed to find the memory data of this \
domain'&lt;br&gt;            sys.exit(1) &lt;br&gt;      &lt;br&gt;except:&lt;br&gt;    print 'Failed \
to find the main domain'&lt;br&gt;    sys.exit(1)&lt;br&gt;&lt;br&gt;

&lt;br&gt;&lt;br&gt;But this code 'dom0.memoryStats().values()' is returning empty list.I \
need to collect more information regarding the memory .How should I \
proceed?&lt;br&gt;&lt;br&gt;&lt;br&gt;Regards,&lt;br&gt;Arpita&lt;br&gt;



</body></email><email><emailId>20110211101844</emailId><senderName>Marcela_Castro_León</senderName><senderEmail>mcastrol@gmail.com</senderEmail><timestampReceived>2011-02-11 10:18:44-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt] configuring network interface</subject><body>

Hello
It's working now. I've put the mac address in the xml definition.
Thank you very much,
Regards.



2011/2/10 Laine Stump &lt;laine@laine.org&gt;

&gt; On 02/10/2011 09:51 AM, Tanguy ROZIER wrote:
&gt;
&gt;&gt; OK so he should fix the problem with libvirt to associate a fixed MAC
&gt;&gt; to the interface of the VM :
&gt;&gt;
&gt;&gt; &lt;interface type='bridge'&gt;
&gt;&gt;    &lt;source bridge='br0'/&gt;
&gt;&gt;    &lt;mac address="00:11:22:33:44:55"/&gt;        &lt;----------this is here :
&gt;&gt; you must *define* the MAC address of your interface
&gt;&gt; &lt;/interface&gt;
&gt;&gt;
&gt;
&gt; As I said in my last mail, if you do not  manually define a MAC address for
&gt; an interface, libvirt will automatically generate a random mac address, and
&gt; save it into the domain config for you, so that the 2nd and subsequent times
&gt; you start the guest, it will use the same mac address. So, there is no
&gt; requirement that you manually define the MAC address.
&gt;
&gt; For example, I just edited an existing domain config with "virsh edit
&gt; domainname" and added this:
&gt;
&gt;
&gt; &lt;interface type='network'&gt;
&gt; &lt;source network='default'/&gt;
&gt; &lt;model type='virtio'/&gt;
&gt; &lt;/interface&gt;
&gt;
&gt; Then I immediately ran "virsh dumpxml domainname", and the interface config
&gt; had been magically transformed:
&gt;
&gt; &lt;interface type='network'&gt;
&gt; &lt;mac address='52:54:00:e2:75:a4'/&gt;
&gt; &lt;source network='default'/&gt;
&gt; &lt;model type='virtio'/&gt;
&gt; &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x07' function='0x0'/&gt;
&gt; &lt;/interface&gt;
&gt;
&gt; This mac address (and pci addressing information) is stored in the
&gt; persistent config for the guest, so they will be the same every time the
&gt; guest is started.
&gt;
&gt; If this is not happening, it's due to 1 of 3 reasons:
&gt;
&gt; 1) You are using a *very* old libvirt. I'm fairly certain, that it has
&gt; auto-generated mac addresses at least since I became involved with libvirt 2
&gt; years ago (and possibly it's always been that way).
&gt;
&gt; 2) The guests are being "virsh create"ed as transient guests, so that the
&gt; auto-generated mac address is never saved. "virsh create" is the wrong tool
&gt; for this job, a combination of "virsh define" followed by "virsh start"
&gt; would be more appropriate.
&gt;
&gt; 3) there is a bug somewhere.
&gt;
&gt;
&gt;  2011/2/10 Laine Stump&lt;laine@laine.org&gt;:
&gt;&gt;
&gt;&gt;&gt; On 02/10/2011 08:50 AM, Tanguy ROZIER wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Your problem is related to udev : every reboot of VM, udev in VM
&gt;&gt;&gt;&gt; checks the MAC address of the ethernet interface of the system to
&gt;&gt;&gt;&gt; associate it with a static name (eth0, eth1...).
&gt;&gt;&gt;&gt; If you change the MAC address of the Ethernet interface of your VM, it
&gt;&gt;&gt;&gt; will detect a new interface and associate it with a new name (ethx+1).
&gt;&gt;&gt;&gt; In order to avoid it :
&gt;&gt;&gt;&gt; try not to change the MAC address of your VM ethernet device (you can
&gt;&gt;&gt;&gt; fix it with libvirt xml),
&gt;&gt;&gt;&gt;
&gt;&gt;&gt; When a domain is defined with an interface, if no mac address is
&gt;&gt;&gt; supplied,
&gt;&gt;&gt; libvirt will automatically generate one and write that generated mac back
&gt;&gt;&gt; to
&gt;&gt;&gt; the config, so that the next time the guest boots it will be presented
&gt;&gt;&gt; with
&gt;&gt;&gt; an ethernet having the same mac address as the previous time.
&gt;&gt;&gt;
&gt;&gt;&gt; How are you defining your guests? Are you perhaps using "virsh create"
&gt;&gt;&gt; (but
&gt;&gt;&gt; using an existing image file) to create a transient guest each time you
&gt;&gt;&gt; want
&gt;&gt;&gt; to boot the guest, rather than doing "virsh define" once to create a
&gt;&gt;&gt; persistent guest, then using "virsh start" each time you want to boot it?
&gt;&gt;&gt; You should be doing the latter - if you continuously use "virsh create",
&gt;&gt;&gt; libvirt will think that it's a "throw away" guest, and won't save the
&gt;&gt;&gt; config
&gt;&gt;&gt; (or any changes to it), so the next time you do "virsh create", the disk
&gt;&gt;&gt; image will have memory of the previous run (by having "eth0" assigned to
&gt;&gt;&gt; some particular mac address), but libvirt won't have any memory of it (it
&gt;&gt;&gt; thinks you're creating a brand new guest), so it will generate a new mac
&gt;&gt;&gt; address for the interface, the guest will boot, see a "new" interface,
&gt;&gt;&gt; notice that "eth0" is already taken, so it will use "eth1", and so on.
&gt;&gt;&gt;
&gt;&gt;&gt; If you actually are using "virsh define" to define a persistent guest, do
&gt;&gt;&gt; a
&gt;&gt;&gt; "virsh dumpxml" of the guest after you've started and destroyed it, and
&gt;&gt;&gt; see
&gt;&gt;&gt; if there is a mac address in the interface config. If not, that's a bug.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;  or deactivate this mecanism in the VM : search in
&gt;&gt;&gt;&gt; /etc/udev/rules.d/70-persistent-net.rules : it calls
&gt;&gt;&gt;&gt; /lib/udev/write_net_rules at every reboot, you could chmod -x this
&gt;&gt;&gt;&gt; script in order to avoid it.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt; This may work (or may not - I haven't investigated), but it isn't the
&gt;&gt;&gt; right
&gt;&gt;&gt; way to fix this problem. It's dealing with the symptom rather than the
&gt;&gt;&gt; cause.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;  Tanguy
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; 2011/2/10 Marcela Castro León&lt;mcastrol@gmail.com&gt;:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Hello Laine:
&gt;&gt;&gt;&gt;&gt; I've revised the configuration and followed all your instructions.
&gt;&gt;&gt;&gt;&gt; I'll try to give you a better explain of my problem.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; a) I need a bridged (3) configuration, because I have to connect the
&gt;&gt;&gt;&gt;&gt; guests
&gt;&gt;&gt;&gt;&gt; from each others. (via ssh and execute mpi). I've three hosts, each of
&gt;&gt;&gt;&gt;&gt; one
&gt;&gt;&gt;&gt;&gt; has at least a guest.
&gt;&gt;&gt;&gt;&gt; I'll only explain about the configuration of one of them, because the
&gt;&gt;&gt;&gt;&gt; problem is only related a one configuration.
&gt;&gt;&gt;&gt;&gt; hostname=rionegro  ip=192.168.1.4
&gt;&gt;&gt;&gt;&gt; guest-name=rnompi1
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; b) I've configured host bridge following step by step ther instruction
&gt;&gt;&gt;&gt;&gt; on
&gt;&gt;&gt;&gt;&gt; http://wiki.libvirt.org/page/Networking
&gt;&gt;&gt;&gt;&gt; this is the /etc/network/config
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; # The loopback network interface
&gt;&gt;&gt;&gt;&gt; auto lo
&gt;&gt;&gt;&gt;&gt; iface lo inet loopback
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; auto br0
&gt;&gt;&gt;&gt;&gt; iface br0 inet static
&gt;&gt;&gt;&gt;&gt; address 192.168.1.4
&gt;&gt;&gt;&gt;&gt; netmask 255.255.255.0
&gt;&gt;&gt;&gt;&gt; network 192.168.1.0
&gt;&gt;&gt;&gt;&gt; broadcast 192.168.1.255
&gt;&gt;&gt;&gt;&gt; gateway 192.168.1.10
&gt;&gt;&gt;&gt;&gt; bridge_ports eth0
&gt;&gt;&gt;&gt;&gt; bridge_stp on
&gt;&gt;&gt;&gt;&gt; bridge_fd 0
&gt;&gt;&gt;&gt;&gt; bridge_maxwait 0
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; c) this is the xml guest configuration related to the network.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;interface type='bridge'&gt;
&gt;&gt;&gt;&gt;&gt;       &lt;source bridge='br0'/&gt;
&gt;&gt;&gt;&gt;&gt;     &lt;/interface&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; d) But the guest doesn't get any IP automatically, and create an
&gt;&gt;&gt;&gt;&gt; interface
&gt;&gt;&gt;&gt;&gt; with a variable name (eth4, eth5,etch6..). I don't know how to achieve
&gt;&gt;&gt;&gt;&gt; the
&gt;&gt;&gt;&gt;&gt; guest don't behave like this and create always its network interface
&gt;&gt;&gt;&gt;&gt; with
&gt;&gt;&gt;&gt;&gt; a
&gt;&gt;&gt;&gt;&gt; fixed name, for example, eth0).
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Why I ask that?
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; if the guest created an interface with a fixed name, I would configure
&gt;&gt;&gt;&gt;&gt; and
&gt;&gt;&gt;&gt;&gt; static ip for the it.
&gt;&gt;&gt;&gt;&gt; I'm attaching a printscreen "rnompi1.jpg"  that show what ifconfig ahow
&gt;&gt;&gt;&gt;&gt; on
&gt;&gt;&gt;&gt;&gt; the guest (eth14 and without any IP). It doesn't get their host either.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; The only way I achieve to solve but "temporally" until reboot is
&gt;&gt;&gt;&gt;&gt; configuring
&gt;&gt;&gt;&gt;&gt; the guest statically using the name of the interface that has just
&gt;&gt;&gt;&gt;&gt; up.In
&gt;&gt;&gt;&gt;&gt; that case every works fine, and the guest can connect to all the other
&gt;&gt;&gt;&gt;&gt; guests on the lan and others can connect to it.
&gt;&gt;&gt;&gt;&gt; But this only works until reboot or reconfigure the guest, because each
&gt;&gt;&gt;&gt;&gt; time
&gt;&gt;&gt;&gt;&gt; the name of interface change, and my configuration I had done of
&gt;&gt;&gt;&gt;&gt; /etc/network/interface didn't work any more because is related to
&gt;&gt;&gt;&gt;&gt; another
&gt;&gt;&gt;&gt;&gt; interface.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; I hope I've explained better the problem I have.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Thank you very much, you've already helped too much to better
&gt;&gt;&gt;&gt;&gt; understand
&gt;&gt;&gt;&gt;&gt; the
&gt;&gt;&gt;&gt;&gt; different cases of network configuration
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Regards.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; 2011/2/10 Marcela Castro León&lt;mcastrol@gmail.com&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Hello Laine:
&gt;&gt;&gt;&gt;&gt;&gt; Thank you very much.
&gt;&gt;&gt;&gt;&gt;&gt; I've showed only one of the guest, each one have it's own ip address.
&gt;&gt;&gt;&gt;&gt;&gt; Anyway, I'll follow your advise of revise all the configuration after
&gt;&gt;&gt;&gt;&gt;&gt; reading the doc.
&gt;&gt;&gt;&gt;&gt;&gt; Thank you very much again.
&gt;&gt;&gt;&gt;&gt;&gt; Regards.
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; 2011/2/8 Laine Stump&lt;laine@laine.org&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; (For future questions such as this, you may find you get a better
&gt;&gt;&gt;&gt;&gt;&gt;&gt; response (and lower signal-noise ratio) by asking on the recently
&gt;&gt;&gt;&gt;&gt;&gt;&gt; -created
&gt;&gt;&gt;&gt;&gt;&gt;&gt; libvirt-users@redhat.com list, as libvir-list has a very large
&gt;&gt;&gt;&gt;&gt;&gt;&gt; volume
&gt;&gt;&gt;&gt;&gt;&gt;&gt; of
&gt;&gt;&gt;&gt;&gt;&gt;&gt; patches and discussion about the internals of libvirt)
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; On 02/08/2011 12:05 PM, Marcela Castro León wrote:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Hello
&gt;&gt;&gt;&gt;&gt;&gt;&gt; I've a lan of virtual machine configured with bridge. I've a private
&gt;&gt;&gt;&gt;&gt;&gt;&gt; lan
&gt;&gt;&gt;&gt;&gt;&gt;&gt; of 4 machine, but one of them have 2 lan-card with access to
&gt;&gt;&gt;&gt;&gt;&gt;&gt; internet.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Evertything works almost fine, except that I've configured on each
&gt;&gt;&gt;&gt;&gt;&gt;&gt; guest
&gt;&gt;&gt;&gt;&gt;&gt;&gt; the static configuration of the bridge with the ip address, like
&gt;&gt;&gt;&gt;&gt;&gt;&gt; this:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; auto lo
&gt;&gt;&gt;&gt;&gt;&gt;&gt; iface lo inet loopback
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; auto eth6
&gt;&gt;&gt;&gt;&gt;&gt;&gt; iface eth6 inet static
&gt;&gt;&gt;&gt;&gt;&gt;&gt; address 192.168.1.41
&gt;&gt;&gt;&gt;&gt;&gt;&gt; network 192.168.1.0
&gt;&gt;&gt;&gt;&gt;&gt;&gt; netmask 255.255.255.0
&gt;&gt;&gt;&gt;&gt;&gt;&gt; gateway 192.168.1.10
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; So are you saying that you're attempting to give each guest the
&gt;&gt;&gt;&gt;&gt;&gt;&gt; *same*
&gt;&gt;&gt;&gt;&gt;&gt;&gt; IP
&gt;&gt;&gt;&gt;&gt;&gt;&gt; address? There's no way that can possibly work, even if each is
&gt;&gt;&gt;&gt;&gt;&gt;&gt; connected to
&gt;&gt;&gt;&gt;&gt;&gt;&gt; a separate virtual network or bridge. Since the host's IP stack can
&gt;&gt;&gt;&gt;&gt;&gt;&gt; "see"
&gt;&gt;&gt;&gt;&gt;&gt;&gt; all of the guests' network traffic, regardless of the connection mode
&gt;&gt;&gt;&gt;&gt;&gt;&gt; you
&gt;&gt;&gt;&gt;&gt;&gt;&gt; choose, each must have a unique IP address even if they can't see
&gt;&gt;&gt;&gt;&gt;&gt;&gt; each
&gt;&gt;&gt;&gt;&gt;&gt;&gt; other.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; But each time I, for example, define the guest, it start with a
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ascending
&gt;&gt;&gt;&gt;&gt;&gt;&gt; number of interface: eth6,eth7, eth8, etc, Now is initializing with
&gt;&gt;&gt;&gt;&gt;&gt;&gt; eth12.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; There must be a mixup in the explanation - I'm understanding that you
&gt;&gt;&gt;&gt;&gt;&gt;&gt; put
&gt;&gt;&gt;&gt;&gt;&gt;&gt; the same config file in each guest, but each guest, when it starts,
&gt;&gt;&gt;&gt;&gt;&gt;&gt; shows a
&gt;&gt;&gt;&gt;&gt;&gt;&gt; different ethernet interface in its ifconfig. That doesn't seem
&gt;&gt;&gt;&gt;&gt;&gt;&gt; right,
&gt;&gt;&gt;&gt;&gt;&gt;&gt; because none of the guests know about each other. Or are you saying
&gt;&gt;&gt;&gt;&gt;&gt;&gt; something different? Where are you seeing the "eth6", "eth7", ...
&gt;&gt;&gt;&gt;&gt;&gt;&gt; "eth12"?
&gt;&gt;&gt;&gt;&gt;&gt;&gt; In the guest XML config maybe?
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; So, it doesn't get the manual configuration I've done on the
&gt;&gt;&gt;&gt;&gt;&gt;&gt; /etc/network/interfaces.
&gt;&gt;&gt;&gt;&gt;&gt;&gt; How can avoid this way of work of the number of ethernet interface
&gt;&gt;&gt;&gt;&gt;&gt;&gt; the
&gt;&gt;&gt;&gt;&gt;&gt;&gt; guest start?
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Why are you doing a manual/static definition on the guest at all?
&gt;&gt;&gt;&gt;&gt;&gt;&gt; It's
&gt;&gt;&gt;&gt;&gt;&gt;&gt; simpler to just leave the guest to automatically configure its eth0,
&gt;&gt;&gt;&gt;&gt;&gt;&gt; and if
&gt;&gt;&gt;&gt;&gt;&gt;&gt; you really want a particular IP address for a particular guest,
&gt;&gt;&gt;&gt;&gt;&gt;&gt; handle
&gt;&gt;&gt;&gt;&gt;&gt;&gt; that
&gt;&gt;&gt;&gt;&gt;&gt;&gt; with a&lt;host&gt;    element in the&lt;dhcp&gt;    section of the virtual
&gt;&gt;&gt;&gt;&gt;&gt;&gt; network the
&gt;&gt;&gt;&gt;&gt;&gt;&gt; guest
&gt;&gt;&gt;&gt;&gt;&gt;&gt; is connected to (or, if you're using a pure bridging setup, then in
&gt;&gt;&gt;&gt;&gt;&gt;&gt; the
&gt;&gt;&gt;&gt;&gt;&gt;&gt; static hosts config of the dhcp server on that network).
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; A way i'm trying to solve is configuring the interface trough the
&gt;&gt;&gt;&gt;&gt;&gt;&gt; guest
&gt;&gt;&gt;&gt;&gt;&gt;&gt; xml definition,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; The guest xml interface configuration cannot be used to setup the IP
&gt;&gt;&gt;&gt;&gt;&gt;&gt; address, route, etc config of the guest. It is only used for two
&gt;&gt;&gt;&gt;&gt;&gt;&gt; things:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 1) configuring what kind of hardware appears on the guest (but not
&gt;&gt;&gt;&gt;&gt;&gt;&gt; what
&gt;&gt;&gt;&gt;&gt;&gt;&gt; name the guest gives to it!)
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 2) configuring how that hardware is connected to the physical network
&gt;&gt;&gt;&gt;&gt;&gt;&gt; (usually either via an existing bridge interface on the host (in
&gt;&gt;&gt;&gt;&gt;&gt;&gt; order
&gt;&gt;&gt;&gt;&gt;&gt;&gt; for
&gt;&gt;&gt;&gt;&gt;&gt;&gt; the guest to appear as if its directly connected to the physical
&gt;&gt;&gt;&gt;&gt;&gt;&gt; network),
&gt;&gt;&gt;&gt;&gt;&gt;&gt; or via a "virtual network" created by libvirt (which is really just a
&gt;&gt;&gt;&gt;&gt;&gt;&gt; bridge
&gt;&gt;&gt;&gt;&gt;&gt;&gt; that's not directly connected to any physical interface, relying
&gt;&gt;&gt;&gt;&gt;&gt;&gt; instead on
&gt;&gt;&gt;&gt;&gt;&gt;&gt; the host's IP stack to route packets from the guest out to the
&gt;&gt;&gt;&gt;&gt;&gt;&gt; physical
&gt;&gt;&gt;&gt;&gt;&gt;&gt; network.)
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; but the operation "define" on virsh accepted without error the xml
&gt;&gt;&gt;&gt;&gt;&gt;&gt; i've
&gt;&gt;&gt;&gt;&gt;&gt;&gt; done, but the dumpxml doesn't show them, so, it doesn't work at all.
&gt;&gt;&gt;&gt;&gt;&gt;&gt; I've followed the instruction that said the manual "Application
&gt;&gt;&gt;&gt;&gt;&gt;&gt; development guide - a guide to application development with libvirt"
&gt;&gt;&gt;&gt;&gt;&gt;&gt; on
&gt;&gt;&gt;&gt;&gt;&gt;&gt; page
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 71.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; That document is targeted towards software developers writing
&gt;&gt;&gt;&gt;&gt;&gt;&gt; applications to manage virtual guests using the libvirt API, not for
&gt;&gt;&gt;&gt;&gt;&gt;&gt; system
&gt;&gt;&gt;&gt;&gt;&gt;&gt; administrators who are configuring virtual guests manually (or, more
&gt;&gt;&gt;&gt;&gt;&gt;&gt; likely,
&gt;&gt;&gt;&gt;&gt;&gt;&gt; by using software that uses the libvirt API, eg virsh or
&gt;&gt;&gt;&gt;&gt;&gt;&gt; virt-manager).
&gt;&gt;&gt;&gt;&gt;&gt;&gt; It
&gt;&gt;&gt;&gt;&gt;&gt;&gt; likely contains more detail and less overview than what you need,
&gt;&gt;&gt;&gt;&gt;&gt;&gt; which
&gt;&gt;&gt;&gt;&gt;&gt;&gt; is
&gt;&gt;&gt;&gt;&gt;&gt;&gt; probably what led to the confusion. I've included a pointer to a wiki
&gt;&gt;&gt;&gt;&gt;&gt;&gt; page
&gt;&gt;&gt;&gt;&gt;&gt;&gt; below that is more the appropriate level of information (Justin, if
&gt;&gt;&gt;&gt;&gt;&gt;&gt; the
&gt;&gt;&gt;&gt;&gt;&gt;&gt; docs
&gt;&gt;&gt;&gt;&gt;&gt;&gt; you were working on are somewhere easily accessible, you can point to
&gt;&gt;&gt;&gt;&gt;&gt;&gt; those
&gt;&gt;&gt;&gt;&gt;&gt;&gt; instead.)
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; The whole definition of the VM is attached, but the related to
&gt;&gt;&gt;&gt;&gt;&gt;&gt; interface
&gt;&gt;&gt;&gt;&gt;&gt;&gt; is:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;     &lt;interface type='bridge'&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;       &lt;source bridge='br0'/&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;       &lt;target dev='vnet0'/&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;     &lt;protocol&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;         &lt;ip address="192.168.1.41" prefix="24"/&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;         &lt;route gateway="192.168.1.10"/&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;     &lt;/protocol&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;     &lt;bridge stp="off" delay="0.01"&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;     &lt;interface type="ethernet" name="eth12"&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;     &lt;protocol&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;         &lt;ip address="192.168.1.41" prefix="24"/&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;         &lt;route gateway="192.168.1.10"/&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;     &lt;/protocol&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;     &lt;/interface&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;     &lt;/bridge&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;     &lt;/interface&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; You are confusing the guest interface config (that is part of the
&gt;&gt;&gt;&gt;&gt;&gt;&gt; guest's
&gt;&gt;&gt;&gt;&gt;&gt;&gt; XML config, and described above), and host physical interface config
&gt;&gt;&gt;&gt;&gt;&gt;&gt; (that
&gt;&gt;&gt;&gt;&gt;&gt;&gt; is not in any way associated with guest config, but instead used to
&gt;&gt;&gt;&gt;&gt;&gt;&gt; configure the host's physical network interfaces, bridges, bonds, and
&gt;&gt;&gt;&gt;&gt;&gt;&gt; vlan
&gt;&gt;&gt;&gt;&gt;&gt;&gt; interfaces; and nearly as important, is not supported on Ubuntu
&gt;&gt;&gt;&gt;&gt;&gt;&gt; anyway).
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Actual guest interface config is *much* simpler than that.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; But after define, the dumpxml only show this part:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;     &lt;interface type='bridge'&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;       &lt;mac address='52:54:00:3c:92:9a'/&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;       &lt;source bridge='br0'/&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;     &lt;/interface&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; That's because everything else you've put in your guest config is not
&gt;&gt;&gt;&gt;&gt;&gt;&gt; actually a part of a valid guest interface config, and so is ignored.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; I would appreciate any help to solve the question. The problem I've
&gt;&gt;&gt;&gt;&gt;&gt;&gt; is
&gt;&gt;&gt;&gt;&gt;&gt;&gt; I
&gt;&gt;&gt;&gt;&gt;&gt;&gt; lost the access to the guest every time the libvirt change the name
&gt;&gt;&gt;&gt;&gt;&gt;&gt; of
&gt;&gt;&gt;&gt;&gt;&gt;&gt; the
&gt;&gt;&gt;&gt;&gt;&gt;&gt; interface eth1,2,3, etc.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; In this case I think it may be useful to start over. You've somehow
&gt;&gt;&gt;&gt;&gt;&gt;&gt; been
&gt;&gt;&gt;&gt;&gt;&gt;&gt; tricked into misunderstanding the way that network configuration in
&gt;&gt;&gt;&gt;&gt;&gt;&gt; libvirt
&gt;&gt;&gt;&gt;&gt;&gt;&gt; works, confusing host interface config with guest interface config,
&gt;&gt;&gt;&gt;&gt;&gt;&gt; and
&gt;&gt;&gt;&gt;&gt;&gt;&gt; the
&gt;&gt;&gt;&gt;&gt;&gt;&gt; resulting config bears little resemblance to what would actually
&gt;&gt;&gt;&gt;&gt;&gt;&gt; work.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ==
&gt;&gt;&gt;&gt;&gt;&gt;&gt; The first step is to read this page:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;    http://wiki.libvirt.org/page/Networking
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; to get a basic overview.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ==
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Second step: you should decide which of the three methods of
&gt;&gt;&gt;&gt;&gt;&gt;&gt; connecting
&gt;&gt;&gt;&gt;&gt;&gt;&gt; to guests to the physical network you want to use:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 1) NATed
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 2) routed
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 3) bridged
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; The simplest is (1), and that will probably work just fine as long as
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 1)
&gt;&gt;&gt;&gt;&gt;&gt;&gt; you don't need incoming connections to the guests, and 2) you're not
&gt;&gt;&gt;&gt;&gt;&gt;&gt; concerned about getting the last fraction of an ounce of performance
&gt;&gt;&gt;&gt;&gt;&gt;&gt; out of
&gt;&gt;&gt;&gt;&gt;&gt;&gt; the network.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Depending on which of those 3 you decide to use:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ==
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Third step: follow the instructions to either create a bridge
&gt;&gt;&gt;&gt;&gt;&gt;&gt; interface
&gt;&gt;&gt;&gt;&gt;&gt;&gt; on the host connected to a physical network interface (for (3)), or
&gt;&gt;&gt;&gt;&gt;&gt;&gt; to
&gt;&gt;&gt;&gt;&gt;&gt;&gt; create a libvirt virtual network using one of the two modes ((1) or
&gt;&gt;&gt;&gt;&gt;&gt;&gt; (2)
&gt;&gt;&gt;&gt;&gt;&gt;&gt; -
&gt;&gt;&gt;&gt;&gt;&gt;&gt; actually the stock libvirt config already has a "default" network
&gt;&gt;&gt;&gt;&gt;&gt;&gt; that
&gt;&gt;&gt;&gt;&gt;&gt;&gt; is
&gt;&gt;&gt;&gt;&gt;&gt;&gt; probably adequate for (1), and unless you understand IP routing very
&gt;&gt;&gt;&gt;&gt;&gt;&gt; well,
&gt;&gt;&gt;&gt;&gt;&gt;&gt; you'll likely want to avoid (2)).
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Once the physical network is setup:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ==
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Fourth step: define your guests. In each guest, you'll have an
&gt;&gt;&gt;&gt;&gt;&gt;&gt; &lt;interface&gt;    element, but it will be much simpler than what you've
&gt;&gt;&gt;&gt;&gt;&gt;&gt; previously
&gt;&gt;&gt;&gt;&gt;&gt;&gt; tried. For bridged mode, the interface section would look like this:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;   &lt;interface type='bridge'&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;     &lt;source bridge='br0'/&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;   &lt;/interface&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Depending on the guest, you may want to specify what type of hardware
&gt;&gt;&gt;&gt;&gt;&gt;&gt; is
&gt;&gt;&gt;&gt;&gt;&gt;&gt; presented to the guest (default is rtl, which almost always works,
&gt;&gt;&gt;&gt;&gt;&gt;&gt; but
&gt;&gt;&gt;&gt;&gt;&gt;&gt; is
&gt;&gt;&gt;&gt;&gt;&gt;&gt; not the best perfrorming), in particular, if the guest supports
&gt;&gt;&gt;&gt;&gt;&gt;&gt; virtio-net,
&gt;&gt;&gt;&gt;&gt;&gt;&gt; you'll want to add this into the&lt;interface&gt;    element:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;   &lt;model type='virtio'/&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; For NATed or routed mode, the guest's interface definition would look
&gt;&gt;&gt;&gt;&gt;&gt;&gt; like this:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;   &lt;interface type='network'&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;      &lt;source network='default'/&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;   &lt;/interface&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; (replace "default" with the name of the network you've defined, if
&gt;&gt;&gt;&gt;&gt;&gt;&gt; you've
&gt;&gt;&gt;&gt;&gt;&gt;&gt; defined your own). In this case also, you can add a&lt;model
&gt;&gt;&gt;&gt;&gt;&gt;&gt; type='...'/&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;  if
&gt;&gt;&gt;&gt;&gt;&gt;&gt; appropriate.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Note that I don't put anything in the&lt;interface&gt;    element about MAC
&gt;&gt;&gt;&gt;&gt;&gt;&gt; address, target device, or bus address. Those are all setup
&gt;&gt;&gt;&gt;&gt;&gt;&gt; automatically by
&gt;&gt;&gt;&gt;&gt;&gt;&gt; libvirt the first time you start the guest, and it will make sure
&gt;&gt;&gt;&gt;&gt;&gt;&gt; that
&gt;&gt;&gt;&gt;&gt;&gt;&gt; the
&gt;&gt;&gt;&gt;&gt;&gt;&gt; guests don't interfere with each other.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ==
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Fifth step: only if you need a particular guest to have a particular
&gt;&gt;&gt;&gt;&gt;&gt;&gt; fixed IP address, either 1) edit the network config file on the
&gt;&gt;&gt;&gt;&gt;&gt;&gt; guest,
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 2)
&gt;&gt;&gt;&gt;&gt;&gt;&gt; add a static host to the libvirt virtual network definition (giving
&gt;&gt;&gt;&gt;&gt;&gt;&gt; the
&gt;&gt;&gt;&gt;&gt;&gt;&gt; MAC
&gt;&gt;&gt;&gt;&gt;&gt;&gt; address provided to the guest by libvirt during the initial guest
&gt;&gt;&gt;&gt;&gt;&gt;&gt; startup)
&gt;&gt;&gt;&gt;&gt;&gt;&gt; with a&lt;host&gt;    element added to the&lt;dhcp&gt;    element of the network;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; details
&gt;&gt;&gt;&gt;&gt;&gt;&gt; are here:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;     http://www.libvirt.org/formatnetwork.html
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; or 3) if you're using the bridged method to connect to the physical
&gt;&gt;&gt;&gt;&gt;&gt;&gt; network, again either configure the guest's own config file, or add a
&gt;&gt;&gt;&gt;&gt;&gt;&gt; static
&gt;&gt;&gt;&gt;&gt;&gt;&gt; host definition to the dhcp server running on your physical network.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; If you still have problems don't hesitate to send another mail
&gt;&gt;&gt;&gt;&gt;&gt;&gt; (although,
&gt;&gt;&gt;&gt;&gt;&gt;&gt; as I said at the top, sending to libvirt-users@redhat.com may yield
&gt;&gt;&gt;&gt;&gt;&gt;&gt; better
&gt;&gt;&gt;&gt;&gt;&gt;&gt; results than libvir-list@redhat.com).
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt;&gt;&gt; libvirt-users mailing list
&gt;&gt;&gt;&gt;&gt; libvirt-users@redhat.com
&gt;&gt;&gt;&gt;&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;

[Attachment #3 (text/html)]

Hello&lt;br&gt;It's working now. I've put the mac address in the xml \
definition.&lt;br&gt;Thank you very much,&lt;br&gt;Regards.&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;2011/2/10 Laine Stump &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:laine@laine.org"&gt;laine@laine.org&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt; &lt;blockquote \
class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, \
204, 204); padding-left: 1ex;"&gt;&lt;div class="im"&gt;On 02/10/2011 09:51 AM, Tanguy ROZIER \
wrote:&lt;br&gt; &lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; \
border-left: 1px solid rgb(204, 204, 204); padding-left: 1ex;"&gt; OK so he should fix \
the problem with libvirt to associate a fixed MAC&lt;br&gt; to the interface of the VM \
:&lt;br&gt; &lt;br&gt;
&lt;interface type='bridge'&gt;&lt;br&gt;
    &lt;source bridge='br0'/&gt;&lt;br&gt;
    &lt;mac address="00:11:22:33:44:55"/&gt;        &lt;----------this is \
here :&lt;br&gt; you must *define* the MAC address of your interface&lt;br&gt;
&lt;/interface&gt;&lt;br&gt;
&lt;/blockquote&gt;
&lt;br&gt;&lt;/div&gt;
As I said in my last mail, if you do not  manually define a MAC address for an \
interface, libvirt will automatically generate a random mac address, and save it into \
the domain config for you, so that the 2nd and subsequent times you start the guest, \
it will use the same mac address. So, there is no requirement that you manually \
define the MAC address.&lt;br&gt;

&lt;br&gt;
For example, I just edited an existing domain config with "virsh edit \
domainname" and added this:&lt;div class="im"&gt;&lt;br&gt; &lt;br&gt;
&lt;interface type='network'&gt;&lt;br&gt;
&lt;source network='default'/&gt;&lt;br&gt;&lt;/div&gt;
&lt;model type='virtio'/&gt;&lt;br&gt;
&lt;/interface&gt;&lt;br&gt;
&lt;br&gt;
Then I immediately ran "virsh dumpxml domainname", and the interface config \
had been magically transformed:&lt;br&gt; &lt;br&gt;
&lt;interface type='network'&gt;&lt;br&gt;
&lt;mac address='52:54:00:e2:75:a4'/&gt;&lt;br&gt;
&lt;source network='default'/&gt;&lt;br&gt;
&lt;model type='virtio'/&gt;&lt;br&gt;
&lt;address type='pci' domain='0x0000' bus='0x00' \
slot='0x07' function='0x0'/&gt;&lt;br&gt; &lt;/interface&gt;&lt;br&gt;
&lt;br&gt;
This mac address (and pci addressing information) is stored in the persistent config \
for the guest, so they will be the same every time the guest is started.&lt;br&gt; &lt;br&gt;
If this is not happening, it's due to 1 of 3 reasons:&lt;br&gt;
&lt;br&gt;
1) You are using a *very* old libvirt. I'm fairly certain, that it has \
auto-generated mac addresses at least since I became involved with libvirt 2 years \
ago (and possibly it's always been that way).&lt;br&gt; &lt;br&gt;
2) The guests are being "virsh create"ed as transient guests, so that the \
auto-generated mac address is never saved. "virsh create" is the wrong tool \
for this job, a combination of "virsh define" followed by "virsh \
start" would be more appropriate.&lt;br&gt;

&lt;br&gt;
3) there is a bug somewhere.&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;&lt;br&gt;
&lt;br&gt;
&lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px \
solid rgb(204, 204, 204); padding-left: 1ex;"&gt; 2011/2/10 Laine Stump&lt;&lt;a \
href="mailto:laine@laine.org" target="_blank"&gt;laine@laine.org&lt;/a&gt;&gt;:&lt;br&gt; \
&lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px \
solid rgb(204, 204, 204); padding-left: 1ex;"&gt; On 02/10/2011 08:50 AM, Tanguy ROZIER \
wrote:&lt;br&gt; &lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; \
border-left: 1px solid rgb(204, 204, 204); padding-left: 1ex;"&gt; Your problem is \
related to udev : every reboot of VM, udev in VM&lt;br&gt; checks the MAC address of the \
ethernet interface of the system to&lt;br&gt; associate it with a static name (eth0, \
eth1...).&lt;br&gt; If you change the MAC address of the Ethernet interface of your VM, \
it&lt;br&gt; will detect a new interface and associate it with a new name (ethx+1).&lt;br&gt;
In order to avoid it :&lt;br&gt;
try not to change the MAC address of your VM ethernet device (you can&lt;br&gt;
fix it with libvirt xml),&lt;br&gt;
&lt;/blockquote&gt;
When a domain is defined with an interface, if no mac address is supplied,&lt;br&gt;
libvirt will automatically generate one and write that generated mac back to&lt;br&gt;
the config, so that the next time the guest boots it will be presented with&lt;br&gt;
an ethernet having the same mac address as the previous time.&lt;br&gt;
&lt;br&gt;
How are you defining your guests? Are you perhaps using "virsh create" \
(but&lt;br&gt; using an existing image file) to create a transient guest each time you \
want&lt;br&gt; to boot the guest, rather than doing "virsh define" once to create \
a&lt;br&gt; persistent guest, then using "virsh start" each time you want to boot \
it?&lt;br&gt; You should be doing the latter - if you continuously use "virsh \
create",&lt;br&gt; libvirt will think that it's a "throw away" guest, \
and won't save the config&lt;br&gt; (or any changes to it), so the next time you do \
"virsh create", the disk&lt;br&gt; image will have memory of the previous run (by \
having "eth0" assigned to&lt;br&gt; some particular mac address), but libvirt \
won't have any memory of it (it&lt;br&gt; thinks you're creating a brand new \
guest), so it will generate a new mac&lt;br&gt; address for the interface, the guest will \
boot, see a "new" interface,&lt;br&gt; notice that "eth0" is already \
taken, so it will use "eth1", and so on.&lt;br&gt; &lt;br&gt;
If you actually are using "virsh define" to define a persistent guest, do \
a&lt;br&gt; "virsh dumpxml" of the guest after you've started and destroyed \
it, and see&lt;br&gt; if there is a mac address in the interface config. If not, that's \
a bug.&lt;br&gt; &lt;br&gt;
&lt;br&gt;
&lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px \
solid rgb(204, 204, 204); padding-left: 1ex;"&gt; or deactivate this mecanism in the VM \
                : search in&lt;br&gt;
/etc/udev/rules.d/70-persistent-net.rules : it calls&lt;br&gt;
/lib/udev/write_net_rules at every reboot, you could chmod -x this&lt;br&gt;
script in order to avoid it.&lt;br&gt;
&lt;/blockquote&gt;
This may work (or may not - I haven't investigated), but it isn't the \
right&lt;br&gt; way to fix this problem. It's dealing with the symptom rather than \
the&lt;br&gt; cause.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px \
solid rgb(204, 204, 204); padding-left: 1ex;"&gt; Tanguy&lt;br&gt;
&lt;br&gt;
2011/2/10 Marcela Castro León&lt;&lt;a href="mailto:mcastrol@gmail.com" \
target="_blank"&gt;mcastrol@gmail.com&lt;/a&gt;&gt;:&lt;br&gt; &lt;blockquote class="gmail_quote" \
style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, 204, 204); \
padding-left: 1ex;"&gt; Hello Laine:&lt;br&gt;
I've revised the configuration and followed all your instructions.&lt;br&gt;
I'll try to give you a better explain of my problem.&lt;br&gt;
&lt;br&gt;
a) I need a bridged (3) configuration, because I have to connect the&lt;br&gt;
guests&lt;br&gt;
from each others. (via ssh and execute mpi). I've three hosts, each of&lt;br&gt;
one&lt;br&gt;
has at least a guest.&lt;br&gt;
I'll only explain about the configuration of one of them, because the&lt;br&gt;
problem is only related a one configuration.&lt;br&gt;
hostname=rionegro  ip=192.168.1.4&lt;br&gt;
guest-name=rnompi1&lt;br&gt;
&lt;br&gt;
b) I've configured host bridge following step by step ther instruction on&lt;br&gt;
&lt;a href="http://wiki.libvirt.org/page/Networking" \
target="_blank"&gt;http://wiki.libvirt.org/page/Networking&lt;/a&gt;&lt;br&gt; this is the \
/etc/network/config&lt;br&gt; &lt;br&gt;
# The loopback network interface&lt;br&gt;
auto lo&lt;br&gt;
iface lo inet loopback&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
auto br0&lt;br&gt;
iface br0 inet static&lt;br&gt;
address 192.168.1.4&lt;br&gt;
netmask 255.255.255.0&lt;br&gt;
network 192.168.1.0&lt;br&gt;
broadcast 192.168.1.255&lt;br&gt;
gateway 192.168.1.10&lt;br&gt;
bridge_ports eth0&lt;br&gt;
bridge_stp on&lt;br&gt;
bridge_fd 0&lt;br&gt;
bridge_maxwait 0&lt;br&gt;
&lt;br&gt;
c) this is the xml guest configuration related to the network.&lt;br&gt;
&lt;br&gt;
     &lt;interface type='bridge'&gt;&lt;br&gt;
       &lt;source bridge='br0'/&gt;&lt;br&gt;
     &lt;/interface&gt;&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
d) But the guest doesn't get any IP automatically, and create an&lt;br&gt;
interface&lt;br&gt;
with a variable name (eth4, eth5,etch6..). I don't know how to achieve&lt;br&gt;
the&lt;br&gt;
guest don't behave like this and create always its network interface with&lt;br&gt;
a&lt;br&gt;
fixed name, for example, eth0).&lt;br&gt;
&lt;br&gt;
Why I ask that?&lt;br&gt;
&lt;br&gt;
if the guest created an interface with a fixed name, I would configure&lt;br&gt;
and&lt;br&gt;
static ip for the it.&lt;br&gt;
I'm attaching a printscreen "rnompi1.jpg"  that show what ifconfig \
ahow&lt;br&gt; on&lt;br&gt;
the guest (eth14 and without any IP). It doesn't get their host either.&lt;br&gt;
&lt;br&gt;
The only way I achieve to solve but "temporally" until reboot is&lt;br&gt;
configuring&lt;br&gt;
the guest statically using the name of the interface that has just up.In&lt;br&gt;
that case every works fine, and the guest can connect to all the other&lt;br&gt;
guests on the lan and others can connect to it.&lt;br&gt;
But this only works until reboot or reconfigure the guest, because each&lt;br&gt;
time&lt;br&gt;
the name of interface change, and my configuration I had done of&lt;br&gt;
/etc/network/interface didn't work any more because is related to another&lt;br&gt;
interface.&lt;br&gt;
&lt;br&gt;
I hope I've explained better the problem I have.&lt;br&gt;
&lt;br&gt;
Thank you very much, you've already helped too much to better understand&lt;br&gt;
the&lt;br&gt;
different cases of network configuration&lt;br&gt;
&lt;br&gt;
Regards.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
2011/2/10 Marcela Castro León&lt;&lt;a href="mailto:mcastrol@gmail.com" \
target="_blank"&gt;mcastrol@gmail.com&lt;/a&gt;&gt;&lt;br&gt; &lt;blockquote class="gmail_quote" \
style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, 204, 204); \
padding-left: 1ex;"&gt; Hello Laine:&lt;br&gt;
Thank you very much.&lt;br&gt;
I've showed only one of the guest, each one have it's own ip address.&lt;br&gt;
Anyway, I'll follow your advise of revise all the configuration after&lt;br&gt;
reading the doc.&lt;br&gt;
Thank you very much again.&lt;br&gt;
Regards.&lt;br&gt;
&lt;br&gt;
2011/2/8 Laine Stump&lt;&lt;a href="mailto:laine@laine.org" \
target="_blank"&gt;laine@laine.org&lt;/a&gt;&gt;&lt;br&gt; &lt;blockquote class="gmail_quote" \
style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, 204, 204); \
padding-left: 1ex;"&gt; (For future questions such as this, you may find you get a \
better&lt;br&gt; response (and lower signal-noise ratio) by asking on the recently&lt;br&gt;
-created&lt;br&gt;
&lt;a href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt; list, as libvir-list has a very large \
volume&lt;br&gt; of&lt;br&gt;
patches and discussion about the internals of libvirt)&lt;br&gt;
&lt;br&gt;
On 02/08/2011 12:05 PM, Marcela Castro León wrote:&lt;br&gt;
&lt;br&gt;
Hello&lt;br&gt;
I've a lan of virtual machine configured with bridge. I've a private&lt;br&gt;
lan&lt;br&gt;
of 4 machine, but one of them have 2 lan-card with access to internet.&lt;br&gt;
&lt;br&gt;
Evertything works almost fine, except that I've configured on each&lt;br&gt;
guest&lt;br&gt;
the static configuration of the bridge with the ip address, like this:&lt;br&gt;
&lt;br&gt;
auto lo&lt;br&gt;
iface lo inet loopback&lt;br&gt;
&lt;br&gt;
auto eth6&lt;br&gt;
iface eth6 inet static&lt;br&gt;
address 192.168.1.41&lt;br&gt;
network 192.168.1.0&lt;br&gt;
netmask 255.255.255.0&lt;br&gt;
gateway 192.168.1.10&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
So are you saying that you're attempting to give each guest the *same*&lt;br&gt;
IP&lt;br&gt;
address? There's no way that can possibly work, even if each is&lt;br&gt;
connected to&lt;br&gt;
a separate virtual network or bridge. Since the host's IP stack can&lt;br&gt;
"see"&lt;br&gt;
all of the guests' network traffic, regardless of the connection mode&lt;br&gt;
you&lt;br&gt;
choose, each must have a unique IP address even if they can't see each&lt;br&gt;
other.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
But each time I, for example, define the guest, it start with a&lt;br&gt;
ascending&lt;br&gt;
number of interface: eth6,eth7, eth8, etc, Now is initializing with&lt;br&gt;
eth12.&lt;br&gt;
&lt;br&gt;
There must be a mixup in the explanation - I'm understanding that you&lt;br&gt;
put&lt;br&gt;
the same config file in each guest, but each guest, when it starts,&lt;br&gt;
shows a&lt;br&gt;
different ethernet interface in its ifconfig. That doesn't seem right,&lt;br&gt;
because none of the guests know about each other. Or are you saying&lt;br&gt;
something different? Where are you seeing the "eth6", "eth7", \
...&lt;br&gt; "eth12"?&lt;br&gt;
In the guest XML config maybe?&lt;br&gt;
&lt;br&gt;
So, it doesn't get the manual configuration I've done on the&lt;br&gt;
/etc/network/interfaces.&lt;br&gt;
How can avoid this way of work of the number of ethernet interface the&lt;br&gt;
guest start?&lt;br&gt;
&lt;br&gt;
Why are you doing a manual/static definition on the guest at all? It's&lt;br&gt;
simpler to just leave the guest to automatically configure its eth0,&lt;br&gt;
and if&lt;br&gt;
you really want a particular IP address for a particular guest, handle&lt;br&gt;
that&lt;br&gt;
with a&lt;host&gt;    element in the&lt;dhcp&gt;    section of the virtual network \
the&lt;br&gt; guest&lt;br&gt;
is connected to (or, if you're using a pure bridging setup, then in the&lt;br&gt;
static hosts config of the dhcp server on that network).&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
A way i'm trying to solve is configuring the interface trough the guest&lt;br&gt;
xml definition,&lt;br&gt;
&lt;br&gt;
The guest xml interface configuration cannot be used to setup the IP&lt;br&gt;
address, route, etc config of the guest. It is only used for two&lt;br&gt;
things:&lt;br&gt;
&lt;br&gt;
1) configuring what kind of hardware appears on the guest (but not what&lt;br&gt;
name the guest gives to it!)&lt;br&gt;
&lt;br&gt;
2) configuring how that hardware is connected to the physical network&lt;br&gt;
(usually either via an existing bridge interface on the host (in order&lt;br&gt;
for&lt;br&gt;
the guest to appear as if its directly connected to the physical&lt;br&gt;
network),&lt;br&gt;
or via a "virtual network" created by libvirt (which is really just a&lt;br&gt;
bridge&lt;br&gt;
that's not directly connected to any physical interface, relying&lt;br&gt;
instead on&lt;br&gt;
the host's IP stack to route packets from the guest out to the physical&lt;br&gt;
network.)&lt;br&gt;
&lt;br&gt;
but the operation "define" on virsh accepted without error the xml \
i've&lt;br&gt; done, but the dumpxml doesn't show them, so, it doesn't work at \
all.&lt;br&gt; I've followed the instruction that said the manual "Application&lt;br&gt;
development guide - a guide to application development with libvirt" on&lt;br&gt;
page&lt;br&gt;
71.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
That document is targeted towards software developers writing&lt;br&gt;
applications to manage virtual guests using the libvirt API, not for&lt;br&gt;
system&lt;br&gt;
administrators who are configuring virtual guests manually (or, more&lt;br&gt;
likely,&lt;br&gt;
by using software that uses the libvirt API, eg virsh or virt-manager).&lt;br&gt;
It&lt;br&gt;
likely contains more detail and less overview than what you need, which&lt;br&gt;
is&lt;br&gt;
probably what led to the confusion. I've included a pointer to a wiki&lt;br&gt;
page&lt;br&gt;
below that is more the appropriate level of information (Justin, if the&lt;br&gt;
docs&lt;br&gt;
you were working on are somewhere easily accessible, you can point to&lt;br&gt;
those&lt;br&gt;
instead.)&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
The whole definition of the VM is attached, but the related to&lt;br&gt;
interface&lt;br&gt;
is:&lt;br&gt;
     &lt;interface type='bridge'&gt;&lt;br&gt;
       &lt;source bridge='br0'/&gt;&lt;br&gt;
       &lt;target dev='vnet0'/&gt;&lt;br&gt;
     &lt;protocol&gt;&lt;br&gt;
         &lt;ip address="192.168.1.41" prefix="24"/&gt;&lt;br&gt;
         &lt;route gateway="192.168.1.10"/&gt;&lt;br&gt;
     &lt;/protocol&gt;&lt;br&gt;
     &lt;bridge stp="off" delay="0.01"&gt;&lt;br&gt;
     &lt;interface type="ethernet" name="eth12"&gt;&lt;br&gt;
     &lt;protocol&gt;&lt;br&gt;
         &lt;ip address="192.168.1.41" prefix="24"/&gt;&lt;br&gt;
         &lt;route gateway="192.168.1.10"/&gt;&lt;br&gt;
     &lt;/protocol&gt;&lt;br&gt;
     &lt;/interface&gt;&lt;br&gt;
     &lt;/bridge&gt;&lt;br&gt;
     &lt;/interface&gt;&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
You are confusing the guest interface config (that is part of the&lt;br&gt;
guest's&lt;br&gt;
XML config, and described above), and host physical interface config&lt;br&gt;
(that&lt;br&gt;
is not in any way associated with guest config, but instead used to&lt;br&gt;
configure the host's physical network interfaces, bridges, bonds, and&lt;br&gt;
vlan&lt;br&gt;
interfaces; and nearly as important, is not supported on Ubuntu&lt;br&gt;
anyway).&lt;br&gt;
&lt;br&gt;
Actual guest interface config is *much* simpler than that.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
But after define, the dumpxml only show this part:&lt;br&gt;
     &lt;interface type='bridge'&gt;&lt;br&gt;
       &lt;mac address='52:54:00:3c:92:9a'/&gt;&lt;br&gt;
       &lt;source bridge='br0'/&gt;&lt;br&gt;
     &lt;/interface&gt;&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
That's because everything else you've put in your guest config is not&lt;br&gt;
actually a part of a valid guest interface config, and so is ignored.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
I would appreciate any help to solve the question. The problem I've is&lt;br&gt;
I&lt;br&gt;
lost the access to the guest every time the libvirt change the name of&lt;br&gt;
the&lt;br&gt;
interface eth1,2,3, etc.&lt;br&gt;
&lt;br&gt;
In this case I think it may be useful to start over. You've somehow&lt;br&gt;
been&lt;br&gt;
tricked into misunderstanding the way that network configuration in&lt;br&gt;
libvirt&lt;br&gt;
works, confusing host interface config with guest interface config, and&lt;br&gt;
the&lt;br&gt;
resulting config bears little resemblance to what would actually work.&lt;br&gt;
&lt;br&gt;
==&lt;br&gt;
The first step is to read this page:&lt;br&gt;
&lt;br&gt;
    &lt;a href="http://wiki.libvirt.org/page/Networking" \
target="_blank"&gt;http://wiki.libvirt.org/page/Networking&lt;/a&gt;&lt;br&gt; &lt;br&gt;
to get a basic overview.&lt;br&gt;
&lt;br&gt;
==&lt;br&gt;
Second step: you should decide which of the three methods of connecting&lt;br&gt;
to guests to the physical network you want to use:&lt;br&gt;
&lt;br&gt;
1) NATed&lt;br&gt;
2) routed&lt;br&gt;
3) bridged&lt;br&gt;
&lt;br&gt;
The simplest is (1), and that will probably work just fine as long as&lt;br&gt;
1)&lt;br&gt;
you don't need incoming connections to the guests, and 2) you're not&lt;br&gt;
concerned about getting the last fraction of an ounce of performance&lt;br&gt;
out of&lt;br&gt;
the network.&lt;br&gt;
&lt;br&gt;
Depending on which of those 3 you decide to use:&lt;br&gt;
&lt;br&gt;
==&lt;br&gt;
Third step: follow the instructions to either create a bridge interface&lt;br&gt;
on the host connected to a physical network interface (for (3)), or to&lt;br&gt;
create a libvirt virtual network using one of the two modes ((1) or (2)&lt;br&gt;
-&lt;br&gt;
actually the stock libvirt config already has a "default" network that&lt;br&gt;
is&lt;br&gt;
probably adequate for (1), and unless you understand IP routing very&lt;br&gt;
well,&lt;br&gt;
you'll likely want to avoid (2)).&lt;br&gt;
&lt;br&gt;
Once the physical network is setup:&lt;br&gt;
&lt;br&gt;
==&lt;br&gt;
Fourth step: define your guests. In each guest, you'll have an&lt;br&gt;
&lt;interface&gt;    element, but it will be much simpler than what you've&lt;br&gt;
previously&lt;br&gt;
tried. For bridged mode, the interface section would look like this:&lt;br&gt;
&lt;br&gt;
   &lt;interface type='bridge'&gt;&lt;br&gt;
     &lt;source bridge='br0'/&gt;&lt;br&gt;
   &lt;/interface&gt;&lt;br&gt;
&lt;br&gt;
Depending on the guest, you may want to specify what type of hardware&lt;br&gt;
is&lt;br&gt;
presented to the guest (default is rtl, which almost always works, but&lt;br&gt;
is&lt;br&gt;
not the best perfrorming), in particular, if the guest supports&lt;br&gt;
virtio-net,&lt;br&gt;
you'll want to add this into the&lt;interface&gt;    element:&lt;br&gt;
&lt;br&gt;
   &lt;model type='virtio'/&gt;&lt;br&gt;
&lt;br&gt;
For NATed or routed mode, the guest's interface definition would look&lt;br&gt;
like this:&lt;br&gt;
&lt;br&gt;
   &lt;interface type='network'&gt;&lt;br&gt;
      &lt;source network='default'/&gt;&lt;br&gt;
   &lt;/interface&gt;&lt;br&gt;
&lt;br&gt;
(replace "default" with the name of the network you've defined, if&lt;br&gt;
you've&lt;br&gt;
defined your own). In this case also, you can add a&lt;model \
type='...'/&gt;&lt;br&gt;  if&lt;br&gt;
appropriate.&lt;br&gt;
&lt;br&gt;
Note that I don't put anything in the&lt;interface&gt;    element about MAC&lt;br&gt;
address, target device, or bus address. Those are all setup&lt;br&gt;
automatically by&lt;br&gt;
libvirt the first time you start the guest, and it will make sure that&lt;br&gt;
the&lt;br&gt;
guests don't interfere with each other.&lt;br&gt;
&lt;br&gt;
==&lt;br&gt;
Fifth step: only if you need a particular guest to have a particular&lt;br&gt;
fixed IP address, either 1) edit the network config file on the guest,&lt;br&gt;
2)&lt;br&gt;
add a static host to the libvirt virtual network definition (giving the&lt;br&gt;
MAC&lt;br&gt;
address provided to the guest by libvirt during the initial guest&lt;br&gt;
startup)&lt;br&gt;
with a&lt;host&gt;    element added to the&lt;dhcp&gt;    element of the network;&lt;br&gt;
details&lt;br&gt;
are here:&lt;br&gt;
&lt;br&gt;
     &lt;a href="http://www.libvirt.org/formatnetwork.html" \
target="_blank"&gt;http://www.libvirt.org/formatnetwork.html&lt;/a&gt;&lt;br&gt; &lt;br&gt;
or 3) if you're using the bridged method to connect to the physical&lt;br&gt;
network, again either configure the guest's own config file, or add a&lt;br&gt;
static&lt;br&gt;
host definition to the dhcp server running on your physical network.&lt;br&gt;
&lt;br&gt;
If you still have problems don't hesitate to send another mail&lt;br&gt;
(although,&lt;br&gt;
as I said at the top, sending to &lt;a href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt; may yield&lt;br&gt; better&lt;br&gt;
results than &lt;a href="mailto:libvir-list@redhat.com" \
target="_blank"&gt;libvir-list@redhat.com&lt;/a&gt;).&lt;br&gt; &lt;/blockquote&gt;&lt;/blockquote&gt;
_______________________________________________&lt;br&gt;
libvirt-users mailing list&lt;br&gt;
&lt;a href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt; &lt;a \
href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; &lt;br&gt;
&lt;/blockquote&gt;
&lt;br&gt;
&lt;/blockquote&gt;
&lt;br&gt;
&lt;/blockquote&gt;
&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;
&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110211152158</emailId><senderName>Peter Phaal</senderName><senderEmail>peter.phaal@gmail.com</senderEmail><timestampReceived>2011-02-11 15:21:58-0400</timestampReceived><subject>Re: [libvirt-users] Not able to capture detailed CPU information of the guest machine using Libvirt </subject><body>

I don't believe that libvirt provides access to that level of detail
for guest VMs. You might want to look at Host sFlow:

http://host-sflow.sourceforge.net/

Installed on the hypervisor, it exports detailed statistics for the
server as well as the standard libvirt metrics for each guest.
Installed on each guest, it adds the detailed counters you are looking
for.

Peter

On Thu, Feb 10, 2011 at 11:29 PM, arpita k &lt;arpitak29@gmail.com&gt; wrote:
&gt; Hi ,
&gt;
&gt; I have two KVM guests in ubuntu host machine.I am using Python binding of
&gt; Libvirt API to query on the hypervisor and capture the CPU , memory related
&gt; information of the guest machines.
&gt;
&gt; I need to capture the detail information regarding CPU like : cpu_aidle,
&gt; cpu_idle, cpu_speed, cpu_wio and memory like
&gt; :mem_cached,mem_buffers,mem_free etc. of the guest machines.
&gt;
&gt; How could I get these information?
&gt;
&gt; Please help me.
&gt;
&gt; Thanks in Advance!!
&gt;
&gt; Arpita
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

</body></email><email><emailId>20110211215645</emailId><senderName>"Bryan D. Payne"</senderName><senderEmail>bryan@thepaynes.cc</senderEmail><timestampReceived>2011-02-11 21:56:45-0400</timestampReceived><subject>Re: [libvirt-users] Start domain with usable QMP connection?</subject><body>

&gt; Though it's not that convenient as you have a independant monitor to talk
&gt; directly, you could use "qemu-monitor-command" of communicate
&gt; with the qemu monitor. And with the latest qemu, which supports monitor
&gt; command "human-monitor-command", it's more compact, e.g.

Very interesting, thanks for the pointer.  It also looks like the
qemu-monitor-command (without the new --hmp switch) could also be
useful for some basic code access to the monitor commands.  I could
send them through virsh instead of my own qmp socket.  If there are
specific commands that I end up using a lot, then I'll look into
extending the libvirt API to support them more cleanly.

Cheers,
bryan

</body></email><email><emailId>20110212091643</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-02-12 09:16:43-0400</timestampReceived><subject>Re: [libvirt-users] Using NFS to read image file</subject><body>

于 2011年02月12日 13:07, Osier Yang 写道:
&gt; 于 2011年02月11日 18:31, Marcela Castro León 写道:
&gt;&gt;
&gt;&gt; Hello:
&gt;&gt; When I start the guest with an image on NFS file system, the ubuntu
&gt;&gt; doesn't boot, It's remain on inittrams.
&gt;&gt; I've tried to redefine the guest without
&gt;&gt; &lt;apic&gt;
&gt;&gt; &lt;pae&gt;
&gt;&gt; configuration as I see on a blog, and I've increased the parameters of
&gt;&gt; the mount to rsize=32768 and wsize=32768, but it still doesn't work.
&gt;&gt; Can anyone give any advice to get it?
&gt;&gt; Thank you very much.
&gt;
I'm guessing it's probly a seabios or qemu-kvm bug, which version
of seabios and qemu-kvm you use? It's better if you can also provide
libvirt version.

Regards
Osier

</body></email><email><emailId>20110213213729</emailId><senderName>Ondrej Famera</senderName><senderEmail>xfamera@fi.muni.cz</senderEmail><timestampReceived>2011-02-13 21:37:29-0400</timestampReceived><subject>Re: [libvirt-users] cgroup</subject><body>

On 13.02.2011 19:33, Zvi Dubitzky wrote:
&gt; Hi
&gt;
&gt; Should  libvirtd be in a cgroup hierarchy  rooted at /dev/cgroup or it can
&gt; be rooted also at /cgroup
&gt; i,e  can /etc/cgconfig.conf   look like his  (without the /dev) :
&gt;
&gt; mount {
&gt;          cpuset  = /cgroup/cpuset;
&gt;          cpu     = /cgroup/cpu;
&gt;          cpuacct = /cgroup/cpuacct;
&gt;          memory  = /cgroup/memory;
&gt;          devices = /cgroup/devices;
&gt;          freezer = /cgroup/freezer;
&gt;          net_cls = /cgroup/net_cls;
&gt;          ns      = /cgroup/ns;
&gt;          blkio   = /cgroup/blkio;
&gt; }
&gt;
&gt; thanks

Hi,

it doesn't matter where the cgroup hierarchy is mounted. And yes, the 
/etc/cgconfig.conf can look like that. But you are missing some group in 
which to put libvirtd.

- good tutorial with examples for cgroups in libvirt can be found at

http://berrange.com/posts/2009/12/03/using-cgroups-with-libvirt-and-lxckvm-guests-in-fedora-12/

&gt; Zvi Dubitzky
&gt; Email:dubi@il.ibm.com
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

-- 
Ondrej Famera
unix@fi

</body></email><email><emailId>20110213214425</emailId><senderName>Ondrej Famera</senderName><senderEmail>xfamera@fi.muni.cz</senderEmail><timestampReceived>2011-02-13 21:44:25-0400</timestampReceived><subject>Re: [libvirt-users] Linux  version that supports cgroup</subject><body>

On 13.02.2011 21:58, Zvi Dubitzky wrote:
&gt; Hi
&gt; Does Fedora release 14 (Laughlin)  having   Linux kernel
&gt; 2.6.35.6-45.fc14.x86_64 support cgroup
&gt; at the kernel ?
&gt;
&gt; thanks

Hi,

yes it does. kernel support for cgroup is there since Fedora 12. Only 
additional thing you will probably need is 'libcgroup' if you don't want 
to setup cgroup every time you reboot.

&gt; Zvi Dubitzky
&gt; Email:dubi@il.ibm.com
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

-- 
Ondrej Famera
unix@fi

</body></email><email><emailId>20110214123938</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-02-14 12:39:38-0400</timestampReceived><subject>Re: [libvirt-users] connecting to virtualbox with libvirt</subject><body>

On 14/02/2011, at 3:50 PM, Gary Scarborough wrote:
&gt; I am trying to connect to the virtualbox hypervisor through libvirt.  If I am doing \
&gt; it correctly,  
&gt; virsh -c vbox:///session
&gt; 
&gt; should get me connected.  I am on F14 64 bit.  I tried this with both vbox 3.2 and \
&gt; 4.02.  I keep getting the following error: 
&gt; error: no connection driver available for vbox:///session.
&gt; 
&gt; What am I missing?

It looks like the version of libvirt you are using doesn't have the VirtualBox driver \
compiled in.

To easily check, do a "virsh -V" to list what's included in the version you have.

For example, on F13 with a recently compiled development version of libvirt:

  $ virsh -V
  Virsh command line tool of libvirt 0.8.7
  See web site at http://libvirt.org/
  
  Compiled with support for:
   Hypervisors: QEmu/KVM UML OpenVZ VirtualBox LXC Test
   Networking: Remote Daemon Network Bridging Netcf Nwfilter VirtualPort
   Storage: Dir Filesystem SCSI Multipath LVM
   Miscellaneous: SELinux Secrets Debug

"VirtualBox" is in the Hypervisor line, so I'd be ok.  You might need to (re)compile \
the libvirt you're using.

Regards and best wishes,

Justin Clift


</body></email><email><emailId>20110215052926</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-02-15 05:29:26-0400</timestampReceived><subject>Re: [libvirt-users] Xen disk device detach fails as non-root	[libvirt-0.8.7 and older versions]</subject><body>

于 2011年02月15日 05:01, Iain MacDonnell 写道:
&gt; Hi All,
&gt;
&gt; I find that I am able to attach a disk device do a Xen domain, using
&gt; virDomainAttachDevice(), running as a non-root user, but I am unable
&gt; to use virDomainDetachDevice() - it results in an "unknown failure".
&gt; Using "virsh [attach|detach]-device" exhibits this behviour.
&gt;
&gt; $ virsh attach-device domu1 attach.xml
&gt; Device attached successfully
&gt;
&gt; $ virsh detach-device domu1 attach.xml
&gt; error: Failed to detach device from attach.xml
&gt; error: Unknown failure
&gt;
&gt; $
&gt;
&gt; With some digging, I determined that the problem arises when libvirt
&gt; tries to translate the device name to a number, using the XenStore API
&gt; (xenStoreDomainGetDiskID()), which requires use of the "xenstored"
&gt; UNIX socket, and that socket is only accessible by root. On making
&gt; that socket accessible to the user (by group), virDomainAttachDevice()
&gt; starts working, but I'm then unable to list domains, because
&gt; xenStoreDoListDomains() waits to verify each domain using
&gt; xenHypervisorHasDomain(), and that requires access to another socket -
&gt; "/proc/xen/privcmd"
&gt;
&gt; My question, before going down the path of trying to hack permissions
&gt; for these sockets permanently ..... is this how it's supposed to be,
&gt; or could, perhaps, libvirtd, which runs as root, access these sockets
&gt; on behalf of the user? It seems it should at least fail more
&gt; gracefully....

Recall there was discussion on problems like these before, but I can't
find the thread now, if I remember well, the conclusion was libvirt
will need a more robust solution for non-root users' priv.

And in my mind, Justin was involed in the discussion, so cc' to him to
see if he could help. :-)

Regards
Osier

</body></email><email><emailId>20110216002059</emailId><senderName>Zvi Dubitzky</senderName><senderEmail>dubi@il.ibm.com</senderEmail><timestampReceived>2011-02-16 00:20:59-0400</timestampReceived><subject>[libvirt-users] monitiring cpu usage via cgroup</subject><body>

thanks Kame,

1) the policy of my process(test) is indeed SCHED_NORMAL .
     When I use sched_setscheduler() to set the pid sched policy  to 
SCHED_FIFO then the cpu usage via cgroup  rt_runtime_us and 
  rt_period_us  is affected . Still  the ratio I specified  is 1:10   but 
I see via top that my process 
     ,that gets 1 cpu ,shows 20% usage

2)  What about memory and cpuset subsystems of cgroup. Do their settings 
apply also only in the cases of processes with policy =
      SCHED_FIFO/SCHED_RR ?

3) lastly:
     What is the meaning of the ‘cap’ parameter in the schedinfo virsh 
command (what are the units and range of values ) and what is 
    the ‘weigth’ parameter .I did not find any documentation of libvirt 
about it ?

thanks

Zvi Dubitzky 
Email:dubi@il.ibm.com


</body></email><email><emailId>20110216051918</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-02-16 05:19:18-0400</timestampReceived><subject>Re: [libvirt-users] Use libvirt-python to attach cdrom</subject><body>

于 2011年02月16日 11:20, seven 写道:
&gt; Osier Yang&lt;jyang@...&gt;  writes:
&gt;
&gt;&gt;
&gt;&gt; 于 2011年02月14日 16:37, seven 写道:
&gt;&gt;&gt; Hi all,
&gt;&gt;&gt;
&gt;&gt;&gt; I want to attach cdrom by libvirt.py .But can't find a func in
&gt;&gt;&gt; libvirt.py can finish this work.
&gt;&gt;&gt;
&gt;&gt;&gt; Who can help me ?
&gt;&gt;&gt;
&gt;&gt;&gt; Regard
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt; # python
&gt;&gt;   &gt;&gt;&gt;  import libvirt
&gt;&gt;   &gt;&gt;&gt;  conn = libvirt.open('qemu:///system')
&gt;&gt;   &gt;&gt;&gt;  dom = conn.lookupByName('f14')
&gt;&gt;   &gt;&gt;&gt;  dir(dom)
&gt;&gt; ['ID', 'OSType', 'UUID', 'UUIDString', 'XMLDesc', '__del__', '__doc__',
&gt;&gt; '__init__', '__module__', '_conn', '_o', 'abortJob', 'attachDevice',
&gt;&gt; 'attachDeviceFlags', 'autostart', 'blockInfo', 'blockPeek',
&gt;&gt; 'blockStats', 'connect', 'coreDump', 'create', 'createWithFlags',
&gt;&gt; 'destroy', 'detachDevice', 'detachDeviceFlags', 'hasCurrentSnapshot',
&gt;&gt; 'hasManagedSaveImage', 'info', 'interfaceStats', 'isActive',
&gt;&gt; 'isPersistent', 'isUpdated', 'jobInfo', 'managedSave',
&gt;&gt; 'managedSaveRemove', 'maxMemory', 'maxVcpus', 'memoryParameters',
&gt;&gt; 'memoryPeek', 'memoryStats', 'migrate', 'migrateSetMaxDowntime',
&gt;&gt; 'migrateToURI', 'name', 'openConsole', 'pinVcpu', 'reboot', 'resume',
&gt;&gt; 'revertToSnapshot', 'save', 'schedulerParameters', 'schedulerType',
&gt;&gt; 'setAutostart', 'setMaxMemory', 'setMemory', 'setMemoryParameters',
&gt;&gt; 'setSchedulerParameters', 'setVcpus', 'setVcpusFlags', 'shutdown',
&gt;&gt; 'snapshotCreateXML', 'snapshotCurrent', 'snapshotListNames',
&gt;&gt; 'snapshotLookupByName', 'snapshotNum', 'suspend', 'undefine',
&gt;&gt; 'updateDeviceFlags', 'vcpus', 'vcpusFlags']
&gt;&gt;   &gt;&gt;&gt;
&gt;&gt;
&gt;&gt; see "attachDevice", "attachDeviceFlags", and "updateDeviceFlags", (in
&gt;&gt; case of your guest already has CDROM device).
&gt;&gt;
&gt;&gt; to get how to use them:
&gt;&gt;
&gt;&gt;   &gt;&gt;&gt;  help(dom.attachDevice)
&gt;&gt;
&gt;&gt; Regards
&gt;&gt; Osier
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; libvirt-users mailing list
&gt;&gt; libvirt-users&lt;at&gt;  redhat.com
&gt;&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;
&gt; --------------------------__
&gt;
&gt; I'm sorry that I as you do,but I don't find the "attachDeviceFlags" and
&gt; "updateDeviceFlags"
&gt;
&gt;&gt;&gt;&gt; dir(dom)
&gt; ['ID', 'OSType', 'UUID', 'UUIDString', 'XMLDesc', '__del__', '__doc__',
&gt; '__init__', '__module__', '_conn', '_o', 'attachDevice', 'autostart',
&gt; 'blockPeek', 'blockStats', 'connect', 'coreDump', 'create', 'destroy',
&gt; 'detachDevice', 'info', 'interfaceStats', 'maxMemory', 'maxVcpus', 'memoryPeek',
&gt; 'migrate', 'name', 'pinVcpu', 'reboot', 'ref', 'resume', 'save',
&gt; 'schedulerParameters', 'schedulerType', 'setAutostart', 'setMaxMemory',
&gt; 'setMemory', 'setSchedulerParameters', 'setVcpus', 'shutdown', 'suspend',
&gt; 'undefine', 'vcpus']
&gt;
&gt; I think this is the version of the problem . My libvir.py's version is 0.6.3
&gt;

Yes, virDomainAttachDeviceFlags was introduced in 0.7.7, though not sure
if Python binding include it timely, 0.6.3 definitely doesn't support
it. :-)

&gt; And when I use "attachDevice" to attach cdrom , I get "no wrong"(return value is
&gt; "0"),but the vm not find the cdrom.

Not sure if it's bug, but could you confirm it's attached, but just not
mounted?

Regards
Osier

</body></email><email><emailId>20110219214853</emailId><senderName>Zvi Dubitzky</senderName><senderEmail>dubi@il.ibm.com</senderEmail><timestampReceived>2011-02-19 21:48:53-0400</timestampReceived><subject>[libvirt-users] schedinfo for kvm</subject><body>

Is there any schedinfo support for  kvm currently  ?

Zvi Dubitzky 
Email:dubi@il.ibm.com

</body></email><email><emailId>20110222003323</emailId><senderName>Matthias Meyer</senderName><senderEmail>matthias.meyer@gmx.li</senderEmail><timestampReceived>2011-02-22 00:33:23-0400</timestampReceived><subject>[libvirt-users] Vista guest doesn't start after libvirt upgrade</subject><body>

Hi,

I've updated my Debian lenny to Debian squeeze last week. So I have now:
  libvirt 0.8.3-5
  qemu-kvm 0.12.5+dfsg-3
  virt-manager 0.8.4-8

Today I try to start my Vista quest again. I am surprised because it won't 
starts. In "/var/log/libvirt/qemu/devel-vista.log" stands "Read failed". The 
Console stays as a black screen after a short SeaBIOS message.
I tried system recovery too but Vista system recovery identified the Vista 
installation without any errors.

Nearly the same occurs with my Windows7 guest. The logfile seems fine but the 
console present me:
Starting SeaBIOS (version...)
Booting from Hard Disk...
Boot failed: not a bootable disk
I tried system recovery too and indeed, W7 doesn't found a Windows 
Installation.

linux-dev:~# LANG==C ls -lh --block-size=1M /var/lib/libvirt/images/
total 90399
-rwxr-xr-x 1 root         root 10000 Feb 12 19:20 devel-CentOS.img
-rwxr-xr-x 1 root         root 10000 Feb 15 20:17 devel-SUSE.img
-rwxr-xr-x 1 root         root 10001 Feb 16 22:55 devel-fedora.img
-rwxr-xr-x 1 root         root 10000 Feb 16 19:23 devel-ubuntu.img
-rwxr-xr-x 1 root         root 12575 Feb  1 07:56 devel-vista.qcow2
-rwxr-xr-x 1 libvirt-qemu kvm  40961 Feb 21 23:50 devel-vista.qcow2.2del
-rwxr-xr-x 1 root         root  9330 Jan 23 18:03 devel-w7.qcow2
-rwxr-xr-x 1 root         root 10136 Feb 13 20:58 devel-w7.qcow2.2del
-rwxr-xr-x 1 root         root 10241 Feb 22 00:34 devel-xp.qcow2

the *.2del files are the original images which doesn't start. The responding 
files without .2del are restored from a backup.


WindowsXP as well as different Linux guests does start and run fine.

There are any experience with this obscurse behavior?


Thanks in advance
Matthias
-- 
Don't Panic

</body></email><email><emailId>20110216102708</emailId><senderName>VHPC2011</senderName><senderEmail>dist@vhpc.org</senderEmail><timestampReceived>2011-02-16 10:27:08-0400</timestampReceived><subject>[libvirt-users] CfP 6th Workshop on Virtualization in High-Performance Cloud Computing (VHPC'11)</subject><body>

Apologies if you received multiple copies of this message.


=================================================================

CALL FOR PAPERS

6th Workshop on

Virtualization in High-Performance Cloud Computing

VHPC'11

as part of Euro-Par 2011, Bordeaux, France

=================================================================

Date: August 30, 2011

Euro-Par 2011: http://europar2011.bordeaux.inria.fr/

Workshop URL: http://vhpc.org

SUBMISSION DEADLINE:

Abstracts: May 2, 2011
Full Paper: June 13, 2011

Scope:

Virtualization has become a common abstraction layer in modern data
centers, enabling resource owners to manage complex infrastructure
independently of their applications. Conjointly virtualization is
becoming a driving technology for a manifold of industry grade IT
services. The cloud concept includes the notion of a separation
between resource owners and users, adding services such as hosted
application frameworks and queuing. Utilizing the same infrastructure,
clouds carry significant potential for use in high-performance
scientific computing. The ability of clouds to provide for
requests and releases of vast computing resource dynamically and
close to the marginal cost of providing the services is unprecedented
in the history of scientific and commercial computing.

Distributed computing concepts that leverage federated resource access
are popular within the grid community, but have not seen previously
desired deployed levels so far. Also, many of the scientific
datacenters have not adopted virtualization or cloud concepts yet.

This workshop aims to bring together industrial providers with the
scientific community in order to foster discussion, collaboration and
mutual exchange of knowledge and experience.

The workshop will be one day in length, composed of 20 min paper
presentations, each followed by 10 min discussion sections.
Presentations may be accompanied by interactive demonstrations. It
concludes with a 30 min panel discussion by presenters.

TOPICS

Topics include, but are not limited to, the following subjects:

- Virtualization in cloud, cluster and grid environments
- VM-based cloud performance modeling
- Workload characterizations for VM-based environments
- Software as a Service (SaaS)
- Cloud reliability, fault-tolerance, and security
- Cloud, cluster and grid filesystems
- QoS and and service levels
- Cross-layer VM optimizations
- Virtualized I/O and storage
- Virtualization and HPC architectures including NUMA
- System and process/bytecode VM convergence
- Paravirtualized driver development
- Research and education use cases
- VM cloud, cluster distribution algorithms
- MPI on virtual machines and clouds
- Cloud frameworks and API sets
- Checkpointing of large compute jobs
- Cloud load balancing
- Accelerator virtualization
- Instrumentation interfaces and languages
- Hardware support for virtualization
- High-performance network virtualization
- Auto-tuning of VMM and VM parameters
- High-speed interconnects
- Hypervisor extensions and tools for cluster and grid computing
- VMMs/Hypervisors
- Cloud use cases including optimizations
- Performance modeling
- Fault tolerant VM environments
- VMM performance tuning on various load types
- Cloud provisioning
- Virtual machine monitor platforms
- Pass-through VM device access
- Management, deployment of VM-based environments

PAPER SUBMISSION

Papers submitted to the workshop will be reviewed by at least two
members of the program committee and external reviewers. Submissions
should include abstract, key words, the e-mail address of the
corresponding author, and must not exceed 10 pages, including tables
and figures at a main font size no smaller than 11 point. Submission
of a paper should be regarded as a commitment that, should the paper
be accepted, at least one of the authors will register and attend the
conference to present the work.

Accepted papers will be published in the Springer LNCS series - the
format must be according to the Springer LNCS Style. Initial
submissions are in PDF, accepted papers will be requested to provided
source files.

Format Guidelines: http://www.springer.de/comp/lncs/authors.html
Submission Link: http://edas.info/newPaper.php?c=10155


CHAIR

Michael Alexander (chair), IBM, Austria
Gianluigi Zanetti (co-chair), CRS4, Italy


PROGRAM COMMITTEE

Paolo Anedda, CRS4, Italy
Volker Buege, University of Karlsruhe, Germany
Giovanni Busonera, CRS4, Italy
Roberto Canonico, University of Napoli, Italy
Tommaso Cucinotta, Scuola Superiore Sant'Anna, Italy
William Gardner, University of Guelph, Canada
Werner Fischer, Thomas-Krenn AG, Germany
Wolfgang Gentzsch, Max Planck Gesellschaft, Germany
Marcus Hardt, Forschungszentrum Karlsruhe, Germany
Sverre Jarp, CERN, Switzerland
Shantenu Sjha, Louisiana State University, USA
Xuxian Jiang, NC State, USA
Kenji Kaneda, Google, USA
Simone Leo, CRS4, Italy
Ignancio Llorente, Universidad Complutense de Madrid, Spain,
Naoya Maruyama, Tokyo Institute of Technology, Japan
Jean-Marc Menaud, Ecole des Mines de Nantes, France
Anastassios Nanos, National Technical University of Athens, Greece
Jose Renato Santos, HP Labs, USA
Deepak Singh, Amazon Webservices, USA
Boria Sotomayor, University of Chicago, USA
Yoshio Turner, HP Labs, USA
Kurt Tutschku, University of Vienna, Austria
Lizhe Wang, Indiana University, USA
Chao-Tung Yang, Tunghai University, China


DURATION: Workshop Duration is one day.

GENERAL INFORMATION

The workshop will be held as part of Euro-Par 2011,
organized by INRIA, CNRS and the University of Bordeaux I, II, France.
Euro-Par 2011: http://europar2011.bordeaux.inria.fr/

</body></email><email><emailId>20110216140532</emailId><senderName>Berend Dekens</senderName><senderEmail>berend@cyberwizzard.nl</senderEmail><timestampReceived>2011-02-16 14:05:32-0400</timestampReceived><subject>Re: [libvirt-users] Clarification about virsh migration options</subject><body>

On 02/12/2011 09:41 AM, Justin Clift wrote:
&gt; This might help explain the difference as well:
&gt;
&gt;    http://wiki.libvirt.org/page/VM_lifecycle#Transient_guest_domains_vs_Persistent_guest_domains
&gt;
&gt; There is also migration info on that page, but it's fairly basic so
&gt; not sure how useful.  Worth checking, just in case though. :)

Cheers for the clarifications. I've been experimenting with 2 
Qemu+KVM+libvirt systems but I cannot get the block migration to work:

virsh # migrate --live ISPConfig qemu+ssh://192.168.2.9/system 
--tunnelled --p2p --persistent --copy-storage-all
error: internal error process exited while connecting to monitor: char 
device redirected to /dev/pts/5
qemu: could not open disk image /mnt/storage/Virtual 
Machines/KVM/ispconfig_drive.img: No such file or directory

I run the virsh on the current host and 192.168.2.9 is the new VM host. 
I see the following on the current host in message output:

Feb 16 14:57:54 cyberxps qemu: could not open disk image 
/mnt/storage/Virtual Machines/KVM/ispconfig_drive.img: No such file or 
directory
Feb 16 15:00:56 cyberxps libvirtd: 15:00:56.999: 2850: debug : 
remoteIO:10438 : internal error process exited while connecting to 
monitor: 15:00:17.990: debug : qemudInitCpuAffinity:2459 : Setting CPU 
affinity
Feb 16 15:00:56 cyberxps 15:00:17.991: debug : 
qemuSecurityDACSetProcessLabel:547 : Dropping privileges of VM to 114:123
Feb 16 15:00:56 cyberxps char device redirected to /dev/pts/5
Feb 16 15:00:56 cyberxps qemu: could not open disk image 
/mnt/storage/Virtual Machines/KVM/ispconfig_drive.img: No such file or 
directory

This looks to me like at some point the block migration is failing 
('internal error ... monitor'?), but why? On the target host I can only 
see the same error messages but no clues as to why it fails.

Regards,
Berend Dekens

</body></email><email><emailId>20110216184242</emailId><senderName>Zvi Dubitzky</senderName><senderEmail>dubi@il.ibm.com</senderEmail><timestampReceived>2011-02-16 18:42:42-0400</timestampReceived><subject>[libvirt-users] schedinfo</subject><body>

  libvirt schedinfo :
  ------------------
  What is the meaning of the 'cap' parameter in the schedinfo virsh 
        command (what are the units and range of values ) and what is 
        the 'weigth' parameter ?

Zvi Dubitzky 
Email:dubi@il.ibm.com


</body></email><email><emailId>20110218054910</emailId><senderName>Ryan Sumner</senderName><senderEmail>rsumner@us.ibm.com</senderEmail><timestampReceived>2011-02-18 05:49:10-0400</timestampReceived><subject>[libvirt-users] altering virtual network driver iptables behavior</subject><body>

This is a multipart message in MIME format.
--=_alternative 001FF77C8625783B_=
Content-Type: text/plain; charset="US-ASCII"

I have the need to modify the behavior of the virtual network driver's 
behavior and how it deals with routed networks.  I'm running 
libvirt-0.8.3-2.fc14.

According to http://libvirt.org/firewall.html, the following is 
automatically added to the FORWARD chain of iptables when a network type 
of "routed" is started up:

"Allow inbound, but only to our expected subnet. Allow outbound, but only 
from our expected subnet. Allow traffic between guests. Deny all other 
inbound. Deny all other outbound. "

The part of this that I need to adjust is the fact that only IPs on my 
subnet will be allowed in and out.  I have IP addresses assigned to my 
guests that have static routes configured on the hypervisor to route to 
the local bridged interface.  I have to do this due to the way the 
surrounding routers and switches on the network are configured to handle 
public IP addresses and MAC address filtering.   Here is an example of my 
config where the public IP address on the guest machine is 1.1.2.2:

My network to do the routing mode:
&lt;network&gt;
  &lt;name&gt;local&lt;/name&gt;
  &lt;forward dev='eth0' mode='route'/&gt;
  &lt;bridge name='virbr_local' stp='on' delay='0' /&gt;
  &lt;ip address='192.168.122.1' netmask='255.255.255.0'/&gt;
&lt;/network&gt;

The network portion of the domain:
    &lt;interface type='network'&gt;
      &lt;mac address='xx:xx:xx:cc:xx:xx'/&gt;
      &lt;source network='local'/&gt;
      &lt;target dev='vnet0'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x02' 
function='0x0'/&gt;
    &lt;/interface&gt;

And finally the static route configured on the hypervisor to get the 
routed traffic from eth0 on the hypervisor down to the virbr_local device:
# ip route add 1.1.2.2 dev virbr_local

This will setup the iptables filters just as the documentation defines, 
but the problem is that all traffic from the guest will get REJECTED by 
iptables due to the source and destination IP not falling within 
192.168.122.0/24. 

I've tried adding a custom filter into the network filter driver, but 
haven't had much luck. Here are some of the things that I've tried.

The custom network filter.   Notice that I'm using tcp, udp, and icmp 
specifically.  I'm doing this so it will force inclusion into the iptables 
filtering rules rather than ebtables. 
&lt;filter name='my-static-ip' chain='root'&gt;
  &lt;rule action='accept' direction='out' priority='500'&gt;
    &lt;tcp srcipaddr='$MYIP'/&gt;
  &lt;/rule&gt;
  &lt;rule action='accept' direction='out' priority='500'&gt;
    &lt;udp srcipaddr='$MYIP'/&gt;
  &lt;/rule&gt;
  &lt;rule action='accept' direction='out' priority='500'&gt;
    &lt;icmp srcipaddr='$MYIP'/&gt;
  &lt;/rule&gt;
  &lt;rule action='accept' direction='in' priority='500'&gt;
    &lt;tcp dstipaddr='$MYIP'/&gt;
  &lt;/rule&gt;
  &lt;rule action='accept' direction='in' priority='500'&gt;
    &lt;udp dstipaddr='$MYIP'/&gt;
  &lt;/rule&gt;
  &lt;rule action='accept' direction='in' priority='500'&gt;
    &lt;icmp dstipaddr='$MYIP'/&gt;
  &lt;/rule&gt;
&lt;/filter&gt;

And the modifications made to the domain's network interface definition:
    &lt;interface type='network'&gt;
      &lt;mac address='xx:xx:xx:xx'/&gt;
      &lt;source network='local'/&gt;
      &lt;target dev='vnet0'/&gt;
      &lt;filterref filter='my-static-ip'&gt;
        &lt;parameter name='MYIP' value=1.1.2.2'/&gt;
      &lt;/filterref&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x02' 
function='0x0'/&gt;
    &lt;/interface&gt;

With the exception of simply manually adding iptables rules in place after 
I start the network using virsh, does anyone know how to accomplish what 
I'm trying to do? 

Ryan Sumner
--=_alternative 001FF77C8625783B_=
Content-Type: text/html; charset="US-ASCII"

&lt;font size=2 face="sans-serif"&gt;I have the need to modify the behavior
of the virtual network driver's behavior and how it deals with routed networks.
 I'm running libvirt-0.8.3-2.fc14.&lt;/font&gt;
&lt;br&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;According to &lt;/font&gt;&lt;a \
href=http://libvirt.org/firewall.html&gt;&lt;font size=2 \
face="sans-serif"&gt;http://libvirt.org/firewall.html&lt;/font&gt;&lt;/a&gt;&lt;font size=2 \
face="sans-serif"&gt;, the following is automatically added to the FORWARD chain of \
iptables when a network type of "routed" is started up:&lt;/font&gt;
&lt;br&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;"Allow inbound, but only to our
expected subnet. Allow outbound, but only from our expected subnet. Allow
traffic between guests. Deny all other inbound. Deny all other outbound.
"&lt;/font&gt;
&lt;br&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;The part of this that I need to adjust
is the fact that only IPs on my subnet will be allowed in and out.  I
have IP addresses assigned to my guests that have static routes configured
on the hypervisor to route to the local bridged interface.  I have
to do this due to the way the surrounding routers and switches on the network
are configured to handle public IP addresses and MAC address filtering.
  Here is an example of my config where the public IP address on the
guest machine is 1.1.2.2:&lt;/font&gt;
&lt;br&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;My network to do the routing mode:&lt;/font&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;&lt;network&gt;&lt;/font&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;  &lt;name&gt;local&lt;/name&gt;&lt;/font&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;  &lt;forward dev='eth0' \
mode='route'/&gt;&lt;/font&gt; &lt;br&gt;&lt;font size=2 face="sans-serif"&gt;  &lt;bridge \
name='virbr_local' stp='on' delay='0' /&gt;&lt;/font&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;  &lt;ip address='192.168.122.1'
netmask='255.255.255.0'/&gt;&lt;/font&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;&lt;/network&gt;&lt;/font&gt;
&lt;br&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;The network portion of the domain:&lt;/font&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;    &lt;interface \
type='network'&gt;&lt;/font&gt; &lt;br&gt;&lt;font size=2 face="sans-serif"&gt;      \
&lt;mac address='xx:xx:xx:cc:xx:xx'/&gt;&lt;/font&gt; &lt;br&gt;&lt;font size=2 \
face="sans-serif"&gt;      &lt;source network='local'/&gt;&lt;/font&gt; \
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;      &lt;target \
dev='vnet0'/&gt;&lt;/font&gt; &lt;br&gt;&lt;font size=2 face="sans-serif"&gt;      \
&lt;address type='pci' domain='0x0000' bus='0x00' slot='0x02' \
function='0x0'/&gt;&lt;/font&gt; &lt;br&gt;&lt;font size=2 face="sans-serif"&gt;    \
&lt;/interface&gt;&lt;/font&gt; &lt;br&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;And finally the static route configured
on the hypervisor to get the routed traffic from eth0 on the hypervisor
down to the virbr_local device:&lt;/font&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;# ip route add 1.1.2.2 dev virbr_local&lt;/font&gt;
&lt;br&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;This will setup the iptables filters
just as the documentation defines, but the problem is that all traffic
from the guest will get REJECTED by iptables due to the source and destination
IP not falling within 192.168.122.0/24.  &lt;/font&gt;
&lt;br&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;I've tried adding a custom filter into
the network filter driver, but haven't had much luck. Here are some of
the things that I've tried.&lt;/font&gt;
&lt;br&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;The custom network filter.   Notice
that I'm using tcp, udp, and icmp specifically.  I'm doing this so
it will force inclusion into the iptables filtering rules rather than ebtables.
 &lt;/font&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;&lt;filter name='my-static-ip' \
chain='root'&gt;&lt;/font&gt; &lt;br&gt;&lt;font size=2 face="sans-serif"&gt;  &lt;rule \
action='accept' direction='out' priority='500'&gt;&lt;/font&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;    &lt;tcp \
srcipaddr='$MYIP'/&gt;&lt;/font&gt; &lt;br&gt;&lt;font size=2 face="sans-serif"&gt;  \
&lt;/rule&gt;&lt;/font&gt; &lt;br&gt;&lt;font size=2 face="sans-serif"&gt;  &lt;rule \
action='accept' direction='out' priority='500'&gt;&lt;/font&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;    &lt;udp \
srcipaddr='$MYIP'/&gt;&lt;/font&gt; &lt;br&gt;&lt;font size=2 face="sans-serif"&gt;  \
&lt;/rule&gt;&lt;/font&gt; &lt;br&gt;&lt;font size=2 face="sans-serif"&gt;  &lt;rule \
action='accept' direction='out' priority='500'&gt;&lt;/font&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;    &lt;icmp \
srcipaddr='$MYIP'/&gt;&lt;/font&gt; &lt;br&gt;&lt;font size=2 face="sans-serif"&gt;  \
&lt;/rule&gt;&lt;/font&gt; &lt;br&gt;&lt;font size=2 face="sans-serif"&gt;  &lt;rule \
action='accept' direction='in' priority='500'&gt;&lt;/font&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;    &lt;tcp \
dstipaddr='$MYIP'/&gt;&lt;/font&gt; &lt;br&gt;&lt;font size=2 face="sans-serif"&gt;  \
&lt;/rule&gt;&lt;/font&gt; &lt;br&gt;&lt;font size=2 face="sans-serif"&gt;  &lt;rule \
action='accept' direction='in' priority='500'&gt;&lt;/font&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;    &lt;udp \
dstipaddr='$MYIP'/&gt;&lt;/font&gt; &lt;br&gt;&lt;font size=2 face="sans-serif"&gt;  \
&lt;/rule&gt;&lt;/font&gt; &lt;br&gt;&lt;font size=2 face="sans-serif"&gt;  &lt;rule \
action='accept' direction='in' priority='500'&gt;&lt;/font&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;    &lt;icmp \
dstipaddr='$MYIP'/&gt;&lt;/font&gt; &lt;br&gt;&lt;font size=2 face="sans-serif"&gt;  \
&lt;/rule&gt;&lt;/font&gt; &lt;br&gt;&lt;font size=2 face="sans-serif"&gt;&lt;/filter&gt;&lt;/font&gt;
&lt;br&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;And the modifications made to the domain's
network interface definition:&lt;/font&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;    &lt;interface \
type='network'&gt;&lt;/font&gt; &lt;br&gt;&lt;font size=2 face="sans-serif"&gt;      \
&lt;mac address='xx:xx:xx:xx'/&gt;&lt;/font&gt; &lt;br&gt;&lt;font size=2 face="sans-serif"&gt;  \
    &lt;source network='local'/&gt;&lt;/font&gt; &lt;br&gt;&lt;font size=2 \
face="sans-serif"&gt;      &lt;target dev='vnet0'/&gt;&lt;/font&gt; &lt;br&gt;&lt;font \
size=2 face="sans-serif"&gt;      &lt;filterref \
filter='my-static-ip'&gt;&lt;/font&gt; &lt;br&gt;&lt;font size=2 face="sans-serif"&gt;    \
    &lt;parameter name='MYIP' value=1.1.2.2'/&gt;&lt;/font&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;      &lt;/filterref&gt;&lt;/font&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;      &lt;address type='pci'
domain='0x0000' bus='0x00' slot='0x02' function='0x0'/&gt;&lt;/font&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;    &lt;/interface&gt;&lt;/font&gt;
&lt;br&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;With the exception of simply manually
adding iptables rules in place after I start the network using virsh, does
anyone know how to accomplish what I'm trying to do? &lt;/font&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;&lt;br&gt;
Ryan Sumner&lt;/font&gt;
--=_alternative 001FF77C8625783B_=--


</body></email><email><emailId>20110218204432</emailId><senderName>Nirmal</senderName><senderEmail>vavatutu@gmail.com</senderEmail><timestampReceived>2011-02-18 20:44:32-0400</timestampReceived><subject>Re: [libvirt-users] LXC libvirt support</subject><body>





On Feb 18, 2011, at 2:17 AM, "Daniel P. Berrange"  
&lt;berrange@redhat.com&gt; wrote:

&gt; On Thu, Feb 17, 2011 at 05:47:43PM -0800, Nirmal Guhan wrote:
&gt;&gt; 2011/2/11 Nirmal Guhan &lt;vavatutu@gmail.com&gt;:
&gt;&gt;&gt; On Fri, Feb 11, 2011 at 9:05 PM, Osier Yang &lt;jyang@redhat.com&gt;  
&gt;&gt;&gt; wrote:
&gt;&gt;&gt;&gt; 于 2011年02月12日 11:52, Nirmal Guhan 写道:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Hi,
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Has anyone used libvirt to start/stop/manage LXC (linux  
&gt;&gt;&gt;&gt;&gt; containers) ?
&gt;&gt;&gt;&gt;&gt; Is it supported at all? Last I tried, had few issues and the  
&gt;&gt;&gt;&gt;&gt; reply was
&gt;&gt;&gt;&gt;&gt; :
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Yes, it's supported, though still much work to do, but the basic is
&gt;&gt;&gt;&gt; there.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; ///
&gt;&gt;&gt;&gt;&gt; Note that libvirt lxc driver is a different implementation from  
&gt;&gt;&gt;&gt;&gt; lxc tools
&gt;&gt;&gt;&gt;&gt; and doesn't use lxc tools internally.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Indeed, it doesn't invoke lxc tools.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; You may not be able to do what
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; you are doing with lxc tools. Especially, the driver doesn't  
&gt;&gt;&gt;&gt;&gt; take aware
&gt;&gt;&gt;&gt;&gt; of files and settings inside a container at all. You have to  
&gt;&gt;&gt;&gt;&gt; prepare them
&gt;&gt;&gt;&gt;&gt; by yourself in advance
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; libvirt.org has the example, e.g. the busybox example, I guess it  
&gt;&gt;&gt;&gt; could
&gt;&gt;&gt;&gt; explain "the driver doesn't take care of files and setting inside a
&gt;&gt;&gt;&gt; container at all, you have to prepare them by yourself in advance."
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Regards
&gt;&gt;&gt;&gt; Osier
&gt;&gt;&gt;
&gt;&gt;&gt; Thanks. Will give a try.
&gt;&gt;&gt; ~nirmal
&gt;&gt;&gt;
&gt;&gt; Seeing some strange behavior running fedora 12 for both host and  
&gt;&gt; lxc container.
&gt;&gt; I do a define, start and console :
&gt;&gt;
&gt;&gt; [root@fedora12new lxc-libvirt-scripts]# virsh -c lxc:// console  
&gt;&gt; testf12new
&gt;&gt; Connected to domain testf12new
&gt;&gt; Escape character is ^]
&gt;&gt; --&gt; I press enter here and virsh exits.
&gt;&gt;
&gt;&gt; I don't get login prompt always. Sometimes I do and when I try to
&gt;&gt; login it rejects my password. Apparently, the same rootfs works fine
&gt;&gt; with lxc tools and I can login.
&gt;
&gt; There are likely multiple problems here.  The issue where virsh exits
&gt; is a bug in libvirts LXC console handling. During Fedora startup
&gt; the init process will close &amp; reopen the primary console. If libvirt
&gt; notices this happen then it'll think the close is a shutdown and
&gt; exit. I need to rewrite console handling to make this reliable.

Thanks. Let me know when you do and I can give a try.

&gt;
&gt; Rejecting the login is likely a configuration issue - perhaps a
&gt; missing securetty entry, but also PAM has various things that
&gt; relate to selinux / audit that don't work within a container and
&gt; need to be removed - sadly i can't remember just which ones offhand,
&gt; but try removing items from the PAM configs.

Sure...

&gt;
&gt;&gt; Snippet from  etc/event.d/tty1 :
&gt;&gt; respawn
&gt;&gt; exec /sbin/mingetty pts/0
&gt;&gt;
&gt;&gt; I use "exec /sbin/mingetty tty1" for lxc tools and that works fine. I
&gt;&gt; had to try pts/0 for libvirt since tty1 does not even get me the
&gt;&gt; occasional login prompts I get with pts.
&gt;&gt;
&gt;&gt; Also even after virsh shutdown, I see that the container processes do
&gt;&gt; not exit. Is there something else I should do?
&gt;
&gt; This 'virsh shutdown' is requesting a graceful shutdown - guests  
&gt; aren't
&gt; required to honour this request. virsh detroy is the failsafe
Ok. Will try.
&gt;
&gt; Regards,
&gt; Daniel
&gt; -- 
&gt; |: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ 
&gt;  :|
&gt; |: http://libvirt.org              -o-             http://virt-manager.org 
&gt;  :|
&gt; |: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ 
&gt;  :|
&gt; |: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc 
&gt;  :|

</body></email><email><emailId>20110221045630</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-02-21 04:56:30-0400</timestampReceived><subject>Re: [libvirt-users] schedinfo for kvm</subject><body>

ÓÚ 2011Äê02Ô 20ÈÕ 05:48, Zvi Dubitzky Ð´µÀ:
&gt; Is there any schedinfo support for  kvm currently  ?

cpu.shares, e.g.

# virsh schedinfo --set cpu_shares=...

Regards
Osier

</body></email><email><emailId>20110222052248</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-02-22 05:22:48-0400</timestampReceived><subject>Re: [libvirt-users] Vista guest doesn't start after libvirt upgrade</subject><body>

于 2011年02月22日 08:33, Matthias Meyer 写道:
&gt; Hi,
&gt;
&gt; I've updated my Debian lenny to Debian squeeze last week. So I have now:
&gt;    libvirt 0.8.3-5
&gt;    qemu-kvm 0.12.5+dfsg-3
&gt;    virt-manager 0.8.4-8
&gt;
&gt; Today I try to start my Vista quest again. I am surprised because it won't
&gt; starts. In "/var/log/libvirt/qemu/devel-vista.log" stands "Read failed". The
&gt; Console stays as a black screen after a short SeaBIOS message.
&gt; I tried system recovery too but Vista system recovery identified the Vista
&gt; installation without any errors.
&gt;
&gt; Nearly the same occurs with my Windows7 guest. The logfile seems fine but the
&gt; console present me:
&gt; Starting SeaBIOS (version...)
&gt; Booting from Hard Disk...
&gt; Boot failed: not a bootable disk
&gt; I tried system recovery too and indeed, W7 doesn't found a Windows
&gt; Installation.
&gt;
&gt; linux-dev:~# LANG==C ls -lh --block-size=1M /var/lib/libvirt/images/
&gt; total 90399
&gt; -rwxr-xr-x 1 root         root 10000 Feb 12 19:20 devel-CentOS.img
&gt; -rwxr-xr-x 1 root         root 10000 Feb 15 20:17 devel-SUSE.img
&gt; -rwxr-xr-x 1 root         root 10001 Feb 16 22:55 devel-fedora.img
&gt; -rwxr-xr-x 1 root         root 10000 Feb 16 19:23 devel-ubuntu.img
&gt; -rwxr-xr-x 1 root         root 12575 Feb  1 07:56 devel-vista.qcow2
&gt; -rwxr-xr-x 1 libvirt-qemu kvm  40961 Feb 21 23:50 devel-vista.qcow2.2del
&gt; -rwxr-xr-x 1 root         root  9330 Jan 23 18:03 devel-w7.qcow2
&gt; -rwxr-xr-x 1 root         root 10136 Feb 13 20:58 devel-w7.qcow2.2del
&gt; -rwxr-xr-x 1 root         root 10241 Feb 22 00:34 devel-xp.qcow2
&gt;
&gt; the *.2del files are the original images which doesn't start. The responding
&gt; files without .2del are restored from a backup.
&gt;
&gt;
&gt; WindowsXP as well as different Linux guests does start and run fine.
&gt;
&gt; There are any experience with this obscurse behavior?

IMHO it's bug of seabios, perhaps you need to ask in qemu-devel for
help.

Regards
Osier

</body></email><email><emailId>20110223081037</emailId><senderName>KAMEZAWA Hiroyuki</senderName><senderEmail>kamezawa.hiroyu@jp.fujitsu.com</senderEmail><timestampReceived>2011-02-23 08:10:37-0400</timestampReceived><subject>[libvirt-users] [PATCH 1/2] libvirt/qemu : allow persistent modification of disks via A(De)ttachDevi</subject><body>


&gt;From 030135224dd6563af0fb8615dc6a4b8e6084410d Mon Sep 17 00:00:00 2001
From: KAMEZAWA Hiroyuki &lt;kamezawa@bluextal.(none)&gt;
Date: Wed, 23 Feb 2011 15:25:26 +0900
Subject: [PATCH 1/2] libvirt/qemu : support attach/detach-disk --persistent

Now, only Xen supports 'virsh attach/detach-disk XXXX --persistent',
modifying inactive domain definition via virsh.

This patch adds a support for qemu. With this patch,
virsh attach/detach-disk --persistent works well with qemu.

Signed-off-by: KAMEZAWA Hiroyuki &lt;kamezawa.hiroyu@jp.fujitsu.com&gt;
---
 src/qemu/qemu_driver.c |  170 ++++++++++++++++++++++++++++++++++++++++++++++--
 1 files changed, 163 insertions(+), 7 deletions(-)

diff --git a/src/qemu/qemu_driver.c b/src/qemu/qemu_driver.c
index 0f25a2a..703f86a 100644
--- a/src/qemu/qemu_driver.c
+++ b/src/qemu/qemu_driver.c
@@ -4082,16 +4082,174 @@ cleanup:
     return ret;
 }
 
+static int qemuDomainFindDiskByName(virDomainDefPtr vmdef, const char *name)
+{
+    virDomainDiskDefPtr vdisk;
+    int i;
+
+    for (i = 0; i &lt; vmdef-&gt;ndisks; i++) {
+        vdisk = vmdef-&gt;disks[i];
+        if (!strcmp(vdisk-&gt;dst, name))
+            return i;
+    }
+    return -1;
+}
+/*
+ * Attach a device given by XML, the change will be persistent
+ * and domain XML definition file is updated.
+ */
+static int qemuDomainAttachDevicePersistent(virDomainDefPtr vmdef,
+                                            virDomainDeviceDefPtr newdev)
+{
+    virDomainDiskDefPtr disk;
+
+    /* At first, check device confliction */
+    switch(newdev-&gt;type) {
+    case VIR_DOMAIN_DEVICE_DISK:
+        disk = newdev-&gt;data.disk;
+        if (qemuDomainFindDiskByName(vmdef, disk-&gt;dst) &gt;= 0) {
+            qemuReportError(VIR_ERR_INVALID_ARG,
+                 _("target %s already exists."), disk-&gt;dst);
+            return -1;
+        }
+
+        if (virDomainDiskInsert(vmdef, disk)) {
+            virReportOOMError();
+            return -1;
+        }
+        if (disk-&gt;info.type == VIR_DOMAIN_DEVICE_ADDRESS_TYPE_PCI) {
+            /*
+             * Address/Drive information is NULL. If virtio, PCI address
+             * shoule be fixed. Other devices as IDE, SCSI...will get ID
+             * automatically
+             */
+            qemuDomainAssignPCIAddresses(vmdef);
+
+        }
+        newdev-&gt;data.disk = NULL;
+        break;
+    default:
+        qemuReportError(VIR_ERR_INVALID_ARG, "%s",
+                        _("Sorry, the device is not suppored for now"));
+        return -1;
+    }
+    
+    return 0;
+}
+
+static int qemuDomainDetachDevicePersistent(virDomainDefPtr vmdef,
+		virDomainDeviceDefPtr device)
+{
+    int x;
+    virDomainDiskDefPtr disk;
+
+    switch(device-&gt;type) {
+    case VIR_DOMAIN_DEVICE_DISK:
+        disk = device-&gt;data.disk;
+        x = qemuDomainFindDiskByName(vmdef, disk-&gt;dst);
+        if (x &lt; 0) {
+            qemuReportError(VIR_ERR_INVALID_ARG,
+                 _("target %s doesn't exist."), disk-&gt;dst);
+            return -1;
+        }
+        virDomainDiskRemove(vmdef, x);
+        break;
+    default:
+        qemuReportError(VIR_ERR_INVALID_ARG, "%s",
+                        _("Sorry, the device is not suppored for now"));
+        return -1;
+    }
+    return 0;
+}
+
+static int qemuDomainModifyDevicePersistent(virDomainPtr dom,
+                                        const char *xml,
+                                        unsigned int attach)
+{
+    struct qemud_driver *driver;
+    virDomainDeviceDefPtr device;
+    virDomainDefPtr vmdef;
+    virDomainObjPtr vm;
+    int ret = -1;
+
+    if (!dom || !dom-&gt;conn || !dom-&gt;name || !xml) {
+        qemuReportError(VIR_ERR_INVALID_ARG,
+                        _("internal error : %s"),  __FUNCTION__);
+        return -1;
+    }
+
+    if (dom-&gt;conn-&gt;flags &amp; VIR_CONNECT_RO)
+        return -1;
+
+    driver = dom-&gt;conn-&gt;privateData;
+    qemuDriverLock(driver);
+    vm = virDomainFindByUUID(&amp;driver-&gt;domains, dom-&gt;uuid);
+    if (!vm) {
+        qemuReportError(VIR_ERR_NO_DOMAIN, _("cannot find domain '%s'"),
+                        dom-&gt;name);
+        goto unlock_out;
+    }
+
+    if (qemuDomainObjBeginJobWithDriver(driver, vm) &lt; 0) {
+	/*
+         * For now, just allow updating inactive domains. Further development
+	 * will allow updating both active domain and its config file at
+	 * the same time.
+	 */
+        qemuReportError(VIR_ERR_INVALID_ARG,
+                        _("cannot update alive domain : %s"),  __FUNCTION__);
+        goto endjob;
+    }
+    vmdef = virDomainObjGetPersistentDef(driver-&gt;caps, vm);
+
+    if (!vmdef)
+        goto endjob;
+
+    device = virDomainDeviceDefParse(driver-&gt;caps,
+                 vmdef, xml, VIR_DOMAIN_XML_INACTIVE);
+    if (!device)
+        goto endjob;
+
+    if (attach) {
+        ret = qemuDomainAttachDevicePersistent(vmdef, device);
+        if (ret &lt; 0)
+            goto out;
+    } else {
+        ret = qemuDomainDetachDevicePersistent(vmdef, device);
+        if (ret &lt; 0)
+            goto out;
+    }
+    ret = virDomainSaveConfig(driver-&gt;configDir, vmdef);
+
+out:
+    virDomainDeviceDefFree(device);
+endjob:
+    if (qemuDomainObjEndJob(vm) == 0)
+        vm = NULL;
+    if (vm)
+        virDomainObjUnlock(vm);
+    /* Note: insert of newdev is done by copy */
+unlock_out:
+    qemuDriverUnlock(driver);
+    return ret;
+}
+
 static int qemudDomainAttachDeviceFlags(virDomainPtr dom,
                                         const char *xml,
                                         unsigned int flags) {
     if (flags &amp; VIR_DOMAIN_DEVICE_MODIFY_CONFIG) {
-        qemuReportError(VIR_ERR_OPERATION_INVALID,
-                        "%s", _("cannot modify the persistent configuration of a domain"));
-        return -1;
+        /*
+	 * Because we can't update the live guest and XML
+         * in atomic, limiting modification as only-acrive and
+         * only-inactive. Need some idea to update both at the same time.
+         */
+        return qemuDomainModifyDevicePersistent(dom, xml, 1);
     }
 
-    return qemudDomainAttachDevice(dom, xml);
+    if (flags &amp; VIR_DOMAIN_DEVICE_MODIFY_LIVE)
+        return qemudDomainAttachDevice(dom, xml);
+
+    return -1;
 }
 
 
@@ -4304,9 +4462,7 @@ static int qemudDomainDetachDeviceFlags(virDomainPtr dom,
                                         const char *xml,
                                         unsigned int flags) {
     if (flags &amp; VIR_DOMAIN_DEVICE_MODIFY_CONFIG) {
-        qemuReportError(VIR_ERR_OPERATION_INVALID,
-                        "%s", _("cannot modify the persistent configuration of a domain"));
-        return -1;
+        return qemuDomainModifyDevicePersistent(dom, xml, 0);
     }
 
     return qemudDomainDetachDevice(dom, xml);
-- 
1.7.1


</body></email><email><emailId>20110223091658</emailId><senderName>Alessandro Italiano</senderName><senderEmail>alessandro.italiano@cnaf.infn.it</senderEmail><timestampReceived>2011-02-23 09:16:58-0400</timestampReceived><subject>[libvirt-users] Using qemu-kvm divre snapshot option</subject><body>

Hi,

looking at the qemu-kvm man page, it is possible to enable
snapshot for a given drive. This is what we need because we would like to start a \
domain with two drives, one on a file with snapshot=on  and an other drive  on LVM \
with snapshot=off.

Unfortunately it seems that if you use libvirt the same option is not available when \
you define the domain with a XML file. I mean, I didn't find out a way to support the \
above use case.

So, does libvirt support the drive snapshot option as qemu-kvm does ?

[root@dom0-103-13-26-b libvirt-0.8.8]# cat /etc/issue
Scientific Linux sl54_x86_64

[root@dom0-103-13-26-b libvirt-0.8.8]# rpm -qa | grep libvirt
libvirt-0.6.3-20.1.el5_4.x86_64
libvirt-python-0.6.3-20.1.el5_4.x86_64

[root@dom0-103-13-26-b libvirt-0.8.8]# rpm -qa | grep qemu
qemu-common-0.10.5-1.el5.2.x86_64
kvm-qemu-img-83-164.el5_5.21.x86_64
qemu-system-x86-0.10.5-1.el5.2.x86_64

Below you can find a copy of the XML where we would like to add somewhere the option \
snapshot

&lt;domain type='kvm'&gt;
 &lt;name&gt;centos5_b&lt;/name&gt;
 &lt;uuid&gt;a973d1d4-7af6-3f41-a3c1-bea958aba98b&lt;/uuid&gt;
 &lt;memory&gt;524288&lt;/memory&gt;
 &lt;currentMemory&gt;524288&lt;/currentMemory&gt;
 &lt;vcpu&gt;1&lt;/vcpu&gt;
 &lt;os&gt;
   &lt;type arch='x86_64' machine='rhel5.4.0'&gt;hvm&lt;/type&gt;
   &lt;boot dev='hd'/&gt;
 &lt;/os&gt;
 &lt;features&gt;
   &lt;acpi/&gt;
   &lt;apic/&gt;
   &lt;pae/&gt;
 &lt;/features&gt;
 &lt;clock offset='utc'/&gt;
 &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
 &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
 &lt;on_crash&gt;restart&lt;/on_crash&gt;
 &lt;devices&gt;
   &lt;emulator&gt;/usr/libexec/qemu-kvm&lt;/emulator&gt;
   &lt;disk type='file' device='disk'&gt;
     &lt;driver name='qemu' cache='none'/&gt;
     &lt;source file='/home/davide/WNoDeS/disks/centos5_b.raw'/&gt;
     &lt;target dev='vda' bus='virtio'&gt;
   &lt;/disk&gt;
   &lt;disk type=block device='disk'&gt;
     &lt;source file='/dev/vg0/lv_slash'/&gt;
     &lt;target dev='vda' bus='virtio'&gt;
   &lt;/disk&gt;
   &lt;disk type='file' device='cdrom'&gt;
     &lt;target dev='hdc' bus='ide'/&gt;
     &lt;readonly/&gt;
   &lt;/disk&gt;
   &lt;interface type='bridge'&gt;
     &lt;mac address='00:16:36:36:70:3e'/&gt;
     &lt;source bridge='br0'/&gt;
     &lt;model type='virtio'/&gt;
   &lt;/interface&gt;
   &lt;serial type='pty'&gt;
     &lt;target port='0'/&gt;
   &lt;/serial&gt;
   &lt;console type='pty'&gt;
     &lt;target port='0'/&gt;
   &lt;/console&gt;
   &lt;input type='mouse' bus='ps2'/&gt;
   &lt;graphics type='vnc' port='-1' autoport='yes' keymap='it'/&gt;
 &lt;/devices&gt;
&lt;/domain&gt;


Thanks in advance

Alessanndro

**********************************************
Alessandro Italiano
INFN-CNAF,Tier1 Farming Group
Viale Berti Pichat 6/2, 40127 Bologna, Italy
Tel: +39 051 6092751
alessandro.italiano@cnaf.infn.it
www.cnaf.infn.it
Skype#alessandroitaliano

**********************************************


["smime.p7s" (smime.p7s)]

0�	*�H��
 �0�10	+0�	*�H��
 �c0�_0�G A�0
	*�H��
0.10	UIT1
0U
INFN10UINFN CA0
100504125546Z
110504125546Z0h10	UIT1
0U
INFN10UPersonal Certificate1
0UCNAF10UAlessandro Italiano0�"0
	*�H��
�0�
��;?7
V�S��f�ZD�R��itnk����2�z*�y�����E��6��o�,���zeO��r
�b(��������{���1���M���wC����������������8?\'�( A��H�v�$ �K�
�vG�mx�������N@yt�DYr4%w%KX|���l:�x�=|q&amp;�$`[��3(AS|�Gxf{�����;Mm��/%������_}�	�/��o���� \
�?����{�d���l����K0�G0U�00U��0U%0++0=U60402 \
0 .�,http://security.fi.infn.it/CA/INFNCA_crl.der0%U 00 +�#
0
*�H��L0Ueli����L@�v�Ya`�m�a0VU#O0M��b��wr�.��yo7N'�� \
�2�00.10	UIT1 0U
INFN10UINFN CA�0+U$0"� alessandro.italiano@cnaf.infn.it0
	*�H��
��Gs`�����dma��g+5�'�?�u��`l/�Wt�d�4(�N��[:���kZ�f��`� \
�����B�}����Ri����FA�}a�I��EU,��R���j�fem��W���R}eb���������3�5�'���!x�k�$�����r&amp;��L�9�P���,E���7J�f������@�}�"���v�K�BE�xZ�&lt;��F \
��N1p��)bU]�3�� )����E�����c�����&gt;� g�9F1�G0�C040.10	UIT1 \
0U INFN10UINFN CAA�0	+ ��0	*�H��
	1	*�H��
0	*�H��
	1
110223091658Z0#	*�H��
	1�[��p��S�+k��p��K�0C	+�716040.10	UIT1
0U
INFN10UINFN CAA�0E*�H��
	16 40.10	UIT1
0U
INFN10UINFN CAA�0
	*�H��
�R2�K��9��[��,!��1��x���7�J~��RJ-�����K9d������nm��q�|B���Q��c����&amp;i�)W��wAq�������P=!�Yll�6��E��:�� \
��O���K/�2o���\�~����0���x��t S��UW��� �DC�n� &gt;0C���qT����@^�,	"3�d�X�'F�  \
�t��W �c4&amp;��`���~27y�����������{!A;���� ��4���^



</body></email><email><emailId>20110223165501</emailId><senderName>Zvi Dubitzky</senderName><senderEmail>dubi@il.ibm.com</senderEmail><timestampReceived>2011-02-23 16:55:01-0400</timestampReceived><subject>[libvirt-users] libvirt cgroup</subject><body>

1. I am using libvirt 0.8.3 on fedora14  .  Acoording to 
     
http://berrange.com/posts/2009/12/03/using-cgroups-with-libvirt-and-lxckvm-guests-in-fedora-12/
     inorder to have libvirt memory  cgroup under a  pre specified group 
one should add  
 CGROUP_DAEMON="memory:/virt" to /etc/sysconfig/libvirtd and restart 
cgconfig service  and the
   libvirtd service . That did not help . any idea ?

2. Also : specifying a limit to the memory subsystem 
(/dev/cgroup/memory/libvirt/qemu/memory.limit_in_bytes)
    by echoing a value , does not propagate to a VM generated later under 
qemu  which is actually generated with a huge default
    value for memory.limit_in_bytes .
    Suppose there was such a limit . Should it   decline a generation of a 
VM that requests a higher memory size in its 
    XML file or the limit prevents the VM from consuming more that the 
specified cgroup limit when consuming a higher value
 

thanks

Zvi Dubitzky 
Email:dubi@il.ibm.com


</body></email><email><emailId>20110224151337</emailId><senderName>"Schnizer, Monika"</senderName><senderEmail>monika.schnizer@ts.fujitsu.com</senderEmail><timestampReceived>2011-02-24 15:13:37-0400</timestampReceived><subject>[libvirt-users] Using dlls for Windows provided in http://libvirt.org/sources/win32_experimental/Lib</subject><body>

Hello libvirt-users,

        could anybody tell me, whether we could use dlls provided in the ex=
perimental package for windows,
and distribute it with our application.

We would do the following:
        a) Install the executable from  http://libvirt.org/sources/win32_ex=
perimental/Libvirt-0.8.7-2.exe
                on our production machine.
            b) Add the dlls to the setup of our application
        c) Install the dlls on the customer's system in some location named=
 /&lt;product root&gt;/lib.


Questions:
        - do we violate the LGPL by doing so?
        - does anybody have better suggestions on how to provide the functi=
onality to the customer?
        - who could tell me how to contact the copyright owners, in order t=
o directly discuss this issue
          with them.


Let me thank in advance for any any information.

With best regards,

--

Monika Schnizer
Software Development
FTS TSP x86 E SW4

FUJITSU
Fujitsu TECHNOLOGY SOLUTIONS  GmbH
Domagk-Str.28, 80807 Munich, Germany
Tel:  +49 (89) 3222 2287
Fax:  +49 (89) 3222 329 2287
Email:  Monika.Schnizer@ts.fujitsu.com
Web:   http://ts.fujitsu.com&lt;http://ts.fujitsu.com/&gt;
Company Details: de.ts.fujitsu.com/imprint.html







[Attachment #3 (text/html)]

&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=us-ascii"&gt;
&lt;meta name="Generator" content="Microsoft Exchange Server"&gt;
&lt;!-- converted from rtf --&gt;
&lt;style&gt;&lt;!-- .EmailQuote { margin-left: 1pt; padding-left: 4pt; border-left: #800000 \
2px solid; } --&gt;&lt;/style&gt; &lt;/head&gt;
&lt;body&gt;
&lt;font face="Arial, sans-serif" size="2"&gt;
&lt;div&gt;Hello libvirt-users,&lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt;        could anybody tell me, whether we \
could use dlls provided in the experimental package for windows,&lt;/div&gt; &lt;div&gt;and \
distribute it with our application.&lt;/div&gt; &lt;div&gt; &lt;/div&gt;
&lt;div&gt;We would do the following:&lt;/div&gt;
&lt;div&gt;        a) Install the executable from  \
&lt;a href="http://libvirt.org/sources/win32_experimental/Libvirt-0.8.7-2.exe"&gt;&lt;font \
color="#0000FF"&gt;&lt;u&gt;http://libvirt.org/sources/win32_experimental/Libvirt-0.8.7-2.exe&lt;/u&gt;&lt;/font&gt;&lt;/a&gt; \
&lt;/div&gt; &lt;div&gt;                \
on our production machine.&lt;/div&gt; \
&lt;div&gt;            b) Add the \
dlls to the setup of our application&lt;/div&gt; \
&lt;div&gt;        c) Install the dlls on the customer's \
system in some location named /&lt;product root&gt;/lib.&lt;/div&gt; &lt;div&gt; &lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt;Questions:&lt;/div&gt;
&lt;div&gt;        - do we violate the LGPL by doing \
so?&lt;/div&gt; &lt;div&gt;        - does anybody have better \
suggestions on how to provide the functionality to the customer?&lt;/div&gt; \
&lt;div&gt;        - who could tell me how to contact \
the copyright owners, in order to directly discuss this issue&lt;/div&gt; \
&lt;div&gt;          with them.&lt;/div&gt; \
&lt;div&gt; &lt;/div&gt; &lt;div&gt; &lt;/div&gt;
&lt;div&gt;Let me thank in advance for any any information.&lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt;With best regards,&lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, sans-serif"&gt;--&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, sans-serif"&gt; &lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, sans-serif" size="1"&gt;&lt;b&gt;Monika Schnizer&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, sans-serif" size="1"&gt;Software Development&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, sans-serif" size="1"&gt;FTS TSP x86 E SW4&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, sans-serif" size="1"&gt; &lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, sans-serif" size="1"&gt;&lt;b&gt;FUJITSU &lt;/b&gt;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, sans-serif" size="1"&gt;Fujitsu TECHNOLOGY SOLUTIONS  \
GmbH       &lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font face="Courier New, \
monospace"&gt;Domagk-Str.28, 80807 Munich, Germany&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font face="Courier \
New, monospace" size="1"&gt;Tel:  +49 (89) 3222 2287&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font \
face="Courier New, monospace" size="1"&gt;Fax:  +49 (89) 3222 329 \
2287&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font face="Arial, sans-serif" size="1"&gt;Email:  \
Monika.Schnizer@ts.fujitsu.com&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font face="Arial, sans-serif" \
size="1"&gt;Web:   &lt;a href="http://ts.fujitsu.com/"&gt;&lt;font \
color="#0000FF"&gt;&lt;u&gt;http://ts.fujitsu.com&lt;/u&gt;&lt;/font&gt;&lt;/a&gt;&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font \
face="Arial, sans-serif" size="1"&gt;Company Details: \
de.ts.fujitsu.com/imprint.html&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font face="Arial, sans-serif" \
size="1"&gt; &lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font face="Arial, sans-serif" \
size="1"&gt; &lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font face="Arial, sans-serif" \
size="1"&gt; &lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font face="Arial, sans-serif" \
size="1"&gt; &lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font face="Arial, sans-serif" \
size="1"&gt; &lt;/font&gt;&lt;/div&gt; &lt;div&gt; &lt;/div&gt;
&lt;/font&gt;
&lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20110108000018</emailId><senderName>Matthias Meyer</senderName><senderEmail>matthias.meyer@gmx.li</senderEmail><timestampReceived>2011-01-08 00:00:18-0400</timestampReceived><subject>[libvirt-users] TUNGETIFF ioctl() failed - virtual machine can't start</subject><body>

Hi,

I want to migrate from vmware to KVM. Therefore I have installed debian 
stable (lenny) and create two virtual machines (KVM).
Both (XP as well as Vista) running fine.
After upgrading to debian testing (sqeeze) both XP-guest as well as 
Vista-guest didn't start anymore.
Both are failing during preparation, probably because of a network-problem.
I will give XP as an example:

cat /var/log/libvirt/qemu/devel-xp.log.2
/usr/bin/kvm -S -M pc -m 256 -smp 1 -name devel-xp -monitor 
pty -localtime -no-acpi -boot c -drive 
file=/KVM-Images/devel-xp.qcow2,if=ide,index=0,boot=on -drive 
file=/mnt/MultiMedia/CD-Server/Betriebssysteme/Windows/WindowsNT/WindowsXPpro_sp2_de.iso,if=ide,media=cdrom,index=2 \
-net  nic,macaddr=54:52:00:29:1a:2d,vlan=0 -net 
tap,fd=11,script=,vlan=0,ifname=vnet0 -serial pty -parallel 
none -usb -usbdevice tablet -vnc 127.0.0.1:0 -k de
char device redirected to /dev/pts/1
char device redirected to /dev/pts/2
info cpus
-&gt; the above will run fine before the upgrade

the following will fail after the upgrade
tail /var/log/messages:
Jan  8 00:56:33 linux-dev libvirtd: 00:56:33.461: warning : 
qemudParsePCIDeviceStrs:1422 : Unexpected exit status '1', qemu probably 
failed
Jan  8 00:56:33 linux-dev kernel: [ 1903.710664] device vnet0 entered 
promiscuous mode
Jan  8 00:56:33 linux-dev kernel: [ 1903.711011] br0: port 2(vnet0) entering 
learning state
Jan  8 00:56:33 linux-dev kernel: [ 1904.022502] br0: port 2(vnet0) entering 
disabled state
Jan  8 00:56:33 linux-dev kernel: [ 1904.024752] device vnet0 left 
promiscuous mode
Jan  8 00:56:33 linux-dev kernel: [ 1904.024752] br0: port 2(vnet0) entering 
disabled state

tail -f /var/log/libvirt/qemu/devel-xp.log
LC_ALL=C PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin 
HOME=/ QEMU_AUDIO_DRV=none /usr/bin/kvm -S -M pc-0.12 -enable-kvm -m 
512 -smp 1,sockets=1,cores=1,threads=1 -name devel-xp -uuid 
1b412c63-dcc0-739f-3c27-630147e6b162 -nodefaults -chardev 
socket,id=monitor,path=/var/lib/libvirt/qemu/devel-xp.monitor,server,nowait -mon 
chardev=monitor,mode=readline -rtc base=localtime -no-acpi -boot c -drive 
file=/KVM-Images/devel-xp.qcow2,if=none,id=drive-ide0-0-0,boot=on,format=raw -device 
ide-drive,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0 -drive 
file=/mnt/MultiMedia/CD-Server/Betriebssysteme/Windows/WindowsNT/WindowsXPpro_sp2_de.iso,if=none,media=cdrom,id=drive-ide0-1-0,readonly=on,format=raw \
-device  ide-drive,bus=ide.1,unit=0,drive=drive-ide0-1-0,id=ide0-1-0 -device 
rtl8139,vlan=0,id=net0,mac=54:52:00:29:1a:2d,bus=pci.0,addr=0x3 -net 
tap,fd=40,vlan=0,name=hostnet0 -chardev pty,id=serial0 -device 
isa-serial,chardev=serial0 -usb -device usb-tablet,id=input0 -vnc 
127.0.0.1:0 -k de -vga cirrus -device 
virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x4
char device redirected to /dev/pts/4
TUNGETIFF ioctl() failed: Invalid argument
exception 13 (0)
rax 0000000000000010 rbx 0000000000008c00 rcx 0000000000006eb6 rdx 
00000000000c8c00
rsi 00000000f2010000 rdi 00000000000c0000 rsp 0000000000006eac rbp 
00000000f2010000
r8  0000000000000000 r9  0000000000000000 r10 0000000000000000 r11 
0000000000000000
r12 0000000000000000 r13 0000000000000000 r14 0000000000000000 r15 
0000000000000000
rip 00000000000fde7c rflags 00033002
cs 0000 (00000000/0000ffff p 1 dpl 3 db 0 s 1 type 3 l 0 g 0 avl 0)
ds 0000 (00000000/0000ffff p 1 dpl 3 db 0 s 1 type 3 l 0 g 0 avl 0)
es 0000 (00000000/0000ffff p 1 dpl 3 db 0 s 1 type 3 l 0 g 0 avl 0)
ss 0000 (00000000/0000ffff p 1 dpl 3 db 0 s 1 type 3 l 0 g 0 avl 0)
fs 0000 (00000000/0000ffff p 1 dpl 3 db 0 s 1 type 3 l 0 g 0 avl 0)
gs 0000 (00000000/0000ffff p 1 dpl 3 db 0 s 1 type 3 l 0 g 0 avl 0)
tr 0000 (feffd000/00002088 p 1 dpl 0 db 0 s 0 type b l 0 g 0 avl 0)
ldt 0000 (00000000/0000ffff p 1 dpl 0 db 0 s 0 type 2 l 0 g 0 avl 0)
gdt f7910/37
idt f8990/0
cr0 10 cr2 0 cr3 0 cr4 0 cr8 0 efer 0
code: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 --&gt; 00 00 
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 
00 00 00

Any hints?
Thanks
AthLux
-- 
Don't Panic


</body></email><email><emailId>20110108162958</emailId><senderName>Matthias Meyer</senderName><senderEmail>matthias.meyer@gmx.li</senderEmail><timestampReceived>2011-01-08 16:29:58-0400</timestampReceived><subject>[libvirt-users] virt-manager can't start because of a dbus problem</subject><body>

Hi,

Since today I can't start virt-manager anymore :-(
Failed to connect to socket /tmp/dbus-yhDz4m8loi
By the way the same message as I get from qdbus.

There are no files called /tmp/dbus* on my system but
some dbus applications are running:
linux-dev:~# ps ax | grep dbus
 1774 ?        Ss     0:00 /usr/bin/dbus-daemon --system
 2436 ?        S      0:00 dbus-launch --autolaunch 1996d3ce005bf1ed73cca8164d21a0b5 \
--binary-syntax --close-stderr  2437 ?        Ss     0:00 /usr/bin/dbus-daemon --fork \
--print-pid 5 --print-address 7 --session

The error-message-box containing:
most common cause is a missing or misconfigured D-Bus
 session bus daemon. See http://projects.gnome.org/gconf/
But I've removed gnome and installed KDE.

Thanks in advance
Matthias
-- 
Don't Panic


</body></email><email><emailId>20110109113100</emailId><senderName>Matthias Meyer</senderName><senderEmail>matthias.meyer@gmx.li</senderEmail><timestampReceived>2011-01-09 11:31:00-0400</timestampReceived><subject>Re: [libvirt-users] virt-manager can t start because of a dbus problem</subject><body>

Am Samstag 08 Januar 2011 schrieb Justin Clift:
&gt; On 09/01/2011, at 3:29 AM, Matthias Meyer wrote:
&gt; &gt; Hi,
&gt; &gt; 
&gt; &gt; Since today I can't start virt-manager anymore :-(
&gt; &gt; Failed to connect to socket /tmp/dbus-yhDz4m8loi
&gt; &gt; By the way the same message as I get from qdbus.
&gt; &gt; 
&gt; &gt; There are no files called /tmp/dbus* on my system but
&gt; &gt; some dbus applications are running:
&gt; &gt; linux-dev:~# ps ax | grep dbus
&gt; &gt; 1774 ?        Ss     0:00 /usr/bin/dbus-daemon --system
&gt; &gt; 2436 ?        S      0:00 dbus-launch --autolaunch 
1996d3ce005bf1ed73cca8164d21a0b5 --binary-syntax --close-stderr
&gt; &gt; 2437 ?        Ss     0:00 /usr/bin/dbus-daemon --fork --print-pid 
5 --print-address 7 --session
&gt; &gt; 
&gt; &gt; The error-message-box containing:
&gt; &gt; most common cause is a missing or misconfigured D-Bus
&gt; &gt; session bus daemon. See http://projects.gnome.org/gconf/
&gt; &gt; But I've removed gnome and installed KDE.
&gt; 
&gt; Hi Matthias,
&gt; 
&gt; (I'm about to get some sleep, so won't be of direct help with this.)
&gt; 
&gt; But, you forgot to mention which linux distro you're using.  RHEL? Fedora? 
Ubuntu? Slackware? etc. :)
&gt; 
&gt; Regards and best wishes,
&gt; 
&gt; Justin Clift

Sorry :-)
I am using Debian testing (sqeeze)

-- 
Don't Panic

</body></email><email><emailId>20110110104314</emailId><senderName>Lucas Arbiza</senderName><senderEmail>lucas.arbiza@gmail.com</senderEmail><timestampReceived>2011-01-10 10:43:14-0400</timestampReceived><subject>[libvirt-users] How to proceed after Libvirt compilation? [Problem]</subject><body>

I'm using Ubuntu 10.10.

At first I installed Libvirt from repositories. Due to problems I removed it
and then I installed from sources this way:

# ./configure --prefix=$HOME/usr
# make
# make install
# ldconfig

The installation gone well. I added the users to libvirtd and rebooted.

When I type virsh I receive from system a message saying virsh is not
installed and instructing to install from repository.

Someone know what should I do or where I can find it?

Thanks in advance.

__

*Lucas Arbiza*

email: lucas.arbiza@gmail.com

Twitter: http://twitter.com/lucasarbiza
Facebook: http://www.facebook.com/lucas.arbiza
Google Profile: http://www.google.com/profiles/lucas.arbiza
&lt;http://www.google.com/profiles/lucas.arbiza&gt;LinkedIn:
http://br.linkedin.com/in/lucasarbiza

[Attachment #3 (text/html)]

&lt;font face="verdana,sans-serif"&gt;&lt;div style="color: rgb(0, 0, 0); "&gt;&lt;font \
color="#000000"&gt;&lt;font face="verdana,sans-serif"&gt;I'm using Ubuntu 10.10. \
&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style="color: rgb(0, 0, 0); "&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;&lt;br&gt;


&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style="color: rgb(0, 0, 0); "&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;At first I installed Libvirt from repositories. Due to \
problems I removed it and then I installed from sources this way:&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;

&lt;div style="color: rgb(0, 0, 0); "&gt;
&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" \
color="#333333"&gt;&lt;font&gt;&lt;font face="verdana,sans-serif"&gt;# &lt;/font&gt;&lt;/font&gt;./configure \
--prefix=$HOME/usr&lt;/font&gt;&lt;/div&gt;

&lt;div&gt;&lt;font class="Apple-style-span" color="#333333"&gt;# make&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
class="Apple-style-span" color="#333333"&gt;# make install&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font \
class="Apple-style-span" color="#333333"&gt;# ldconfig&lt;/font&gt;&lt;/div&gt;&lt;div style="color: \
rgb(0, 0, 0); "&gt;&lt;br&gt;&lt;/div&gt;&lt;div style="color: rgb(0, 0, 0); "&gt;The installation gone \
well. I added the users to libvirtd and rebooted.&lt;/div&gt;

&lt;div style="color: rgb(0, 0, 0); "&gt;&lt;br&gt;&lt;/div&gt;&lt;div style="color: rgb(0, 0, 0); "&gt;When \
I type virsh I receive from system a message saying virsh is not installed and \
instructing to install from repository.&lt;/div&gt;&lt;div style="color: rgb(0, 0, 0); "&gt;

&lt;br&gt;&lt;/div&gt;&lt;div style="color: rgb(0, 0, 0); "&gt;Someone know what should I do or where I \
can find it?&lt;/div&gt;&lt;div style="color: rgb(0, 0, 0); "&gt;&lt;br&gt;&lt;/div&gt;&lt;div style="color: \
rgb(0, 0, 0); "&gt;Thanks in advance.&lt;/div&gt;&lt;br clear="all"&gt;

&lt;/font&gt;__&lt;br&gt;&lt;br&gt;&lt;b&gt;&lt;font face="verdana, sans-serif"&gt;&lt;font color="#333333"&gt;Lucas \
Arbiza&lt;/font&gt;&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;br&gt;email: &lt;a href="mailto:lucas.arbiza@gmail.com" \
target="_blank"&gt;lucas.arbiza@gmail.com&lt;/a&gt;&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;

&lt;div&gt;Twitter: &lt;a href="http://twitter.com/lucasarbiza" \
target="_blank"&gt;http://twitter.com/lucasarbiza&lt;/a&gt;&lt;/div&gt;&lt;div&gt;Facebook: &lt;a \
href="http://www.facebook.com/lucas.arbiza" \
target="_blank"&gt;http://www.facebook.com/lucas.arbiza&lt;/a&gt;&lt;/div&gt;


&lt;div&gt;Google Profile: &lt;a href="http://www.google.com/profiles/lucas.arbiza" \
target="_blank"&gt;http://www.google.com/profiles/lucas.arbiza&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;a \
href="http://www.google.com/profiles/lucas.arbiza" target="_blank"&gt;&lt;/a&gt;LinkedIn: &lt;a \
href="http://br.linkedin.com/in/lucasarbiza" \
target="_blank"&gt;http://br.linkedin.com/in/lucasarbiza&lt;/a&gt;&lt;br&gt;


&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110111140235</emailId><senderName>Robert_Šmol</senderName><senderEmail>robert.smol@stereoit.com</senderEmail><timestampReceived>2011-01-11 14:02:35-0400</timestampReceived><subject>[libvirt-users] Timed out during operation: cannot acquire state change lock</subject><body>

Hi, 

I am looking for help to troubleshoot: 

node002 ~ # virsh
virsh # list
 Id Name State
----------------------------------
 1 dom001 paused

virsh # resume dom001
error: Failed to resume domain dom001
error: Timed out during operation: cannot acquire state change lock

virsh # 

then I've looked into /var/run/libvirt/qemu 

node002 ~ # ls -l /var/run/libvirt/qemu/
total 8
-rw------- 1 root root 5 Jan 10 17:41 dom001.pid
-rw------- 1 root root 2785 Jan 10 17:47 dom001.xml

node002 ~ # ps ax|grep 16681
16681 ?        Sl     6:07 /usr/bin/qemu-system-x86_64 --enable-kvm -S -M
pc-0.13 -enable-kvm -m 512 -smp 2,sockets=2,cores=1,threads=1 -name dom001
-uuid 357d1d40-31a1-ca62-da4b-5c6f9f5f1399 -nodefconfig -nodefaults
-chardev
socket,id=monitor,path=/var/lib/libvirt/qemu/dom001.monitor,server,nowait
-mon chardev=monitor,mode=control -rtc base=utc -boot c -kernel
/srv/kernels/kernel-2.6.36-gentoo-r5-2 -append console=tty1 root=/dev/vda
-device lsi,id=scsi0,bus=pci.0,addr=0x6 -drive
file=/dev/vg_node002/dom001_root,if=none,id=drive-virtio-disk0,boot=on,format=raw
-device
virtio-blk-pci,bus=pci.0,addr=0x3,drive=drive-virtio-disk0,id=virtio-disk0
-drive
file=/dev/vg_node002/dom001_swap,if=none,id=drive-virtio-disk1,format=raw
-device
virtio-blk-pci,bus=pci.0,addr=0x4,drive=drive-virtio-disk1,id=virtio-disk1
-netdev tap,fd=61,id=hostnet0 -device
virtio-net-pci,netdev=hostnet0,id=net0,mac=52:54:00:29:98:f8,bus=pci.0,addr=0x7
-chardev pty,id=serial0 -device isa-serial,chardev=serial0 -usb -vnc
127.0.0.1:0 -vga cirrus -device
virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x5

I have used virt-manager to start the machine (KVM+QEMU), then I tried to
pause the machine and the virt-manager was gray for long time so I killed
it. Now I cannot resume the machine. Any tips? 

Regards, 

Robert

</body></email><email><emailId>20110103182436</emailId><senderName></senderName><senderEmail>saint</senderEmail><timestampReceived>2011-01-03 18:24:36-0400</timestampReceived><subject>Re: [libvirt-users] livemigrate problems</subject><body>

&gt; &gt; &gt; &gt; &gt; "CC" == saint  &lt;saint@eng.it&gt; writes:

CC&gt; I can livemigrate w/o problems between any two from red9, red10
CC&gt; and red11, I can livemigrate from either red9, red10 or red11 to
CC&gt; red3 but I can't livemigrate to any other blade from red3.

That's  a selection  of lines  from red9  log when  red10 succeeds  in
migrating (live) one-71 and red3 fails to migrate one-73:

Success from red10:

19:15:25.120: debug : virConnectOpen:1103 : name=qemu:///system
19:15:25.120: debug : do_open:973 : name "qemu:///system" to URI components:
  scheme qemu
  opaque (null)
  authority (null)
  server (null)
  user (null)
  port 0
  path /system

19:15:25.120: debug : do_open:983 : trying driver 0 (Test) ...
19:15:25.120: debug : do_open:989 : driver 0 Test returned DECLINED
19:15:25.120: debug : do_open:983 : trying driver 1 (Xen) ...
19:15:25.120: debug : do_open:989 : driver 1 Xen returned DECLINED
19:15:25.120: debug : do_open:983 : trying driver 2 (remote) ...
19:15:25.120: debug : do_open:989 : driver 2 remote returned DECLINED
19:15:25.120: debug : do_open:983 : trying driver 3 (QEMU) ...
19:15:25.120: debug : do_open:989 : driver 3 QEMU returned SUCCESS
19:15:25.120: debug : do_open:1009 : network driver 0 Test returned DECLINED
19:15:25.120: debug : do_open:1009 : network driver 1 remote returned DECLINED
19:15:25.120: debug : do_open:1009 : network driver 2 Network returned SUCCESS
19:15:25.120: debug : do_open:1031 : storage driver 0 Test returned DECLINED
19:15:25.120: debug : do_open:1031 : storage driver 1 remote returned DECLINED
19:15:25.120: debug : do_open:1031 : storage driver 2 storage returned SUCCESS
19:15:25.120: debug : do_open:1052 : node driver 0 Test returned DECLINED
19:15:25.120: debug : do_open:1052 : node driver 1 remote returned DECLINED
19:15:25.120: debug : do_open:1052 : node driver 2 halDeviceMonitor returned SUCCESS
19:15:25.122: debug : virDrvSupportsFeature:1232 : conn=0x2aaaac000970, feature=3
19:15:25.125: debug : virDomainMigratePrepare2:3071 : dconn=0x2aaaac000970, \
cookie=0x43624eb8, cookielen=0x43624ec4, uri_in=(null), uri_out=0x18e54a80,flags=1, \
dname=(null), bandwidth=0, dom_xml=&lt;domain type='kvm' id='7'&gt;  &lt;name&gt;one-71&lt;/name&gt;
  &lt;uuid&gt;346d40a2-10f7-d39a-f969-7f1c901db6ca&lt;/uuid&gt;
  &lt;memory&gt;262144&lt;/memory&gt;
  &lt;currentMemory&gt;262144&lt;/currentMemory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='x86_64' machine='rhel5.4.0'&gt;hvm&lt;/type&gt;
    &lt;boot dev='hd'/&gt;
  &lt;/os&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;destroy&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;source file='/srv/cloud/one/var/images/71/images/disk.0'/&gt;
      &lt;target dev='hda' bus='ide'/&gt;
    &lt;/disk&gt;
    &lt;disk type='file' device='cdrom'&gt;
      &lt;source file='/srv/cloud/one/var/images/71/images/disk.1'/&gt;
      &lt;target dev='hdb' bus='ide'/&gt;
      &lt;readonly/&gt;
    &lt;/disk&gt;
    &lt;interface type='bridge'&gt;
      &lt;mac address='02:00:a1:1b:d6:d5'/&gt;
      &lt;source bridge='bridge0.334'/&gt;
      &lt;target dev='vnet0'/&gt;
    &lt;/interface&gt;
    &lt;input type='mouse' bus='ps2'/&gt;
    &lt;graphics type='vnc' port='5971' autoport='no' listen='0.0.0.0'/&gt;
  &lt;/devices&gt;
&lt;/domain&gt;

19:15:25.126: debug : virExecWithHook:546 : /usr/bin/kvm -help
19:15:25.133: info : Received unexpected signal 17
19:15:25.147: debug : virExecWithHook:546 : /usr/bin/kvm -S -M rhel5.4.0 -m 256 -smp \
1 -name one-71 -uuid 346d40a2-10f7-d39a-f969-7f1c901db6ca -no-kvm-pit-reinjection \
-monitor pty -pidfile /var/run/libvirt/qemu//one-71.pid -no-acpi -boot c -drive \
file=/srv/cloud/one/var/images/71/images/disk.0,if=ide,index=0,boot=on -drive \
file=/srv/cloud/one/var/images/71/images/disk.1,if=ide,media=cdrom,index=1 -net \
nic,macaddr=02:00:a1:1b:d6:d5,vlan=0 -net tap,fd=16,script=,vlan=0,ifname=vnet3 \
-serial none -parallel none -usb -vnc 0.0.0.0:71 -incoming tcp:0.0.0.0:49154 \
19:15:25.148: info : Received unexpected signal 17 19:15:25.624: debug : \
virConnectOpen:1103 : name=qemu:///system 19:15:25.624: debug : do_open:973 : name \
"qemu:///system" to URI components:  scheme qemu
  opaque (null)
  authority (null)
  server (null)
  user (null)
  port 0
  path /system

19:15:25.624: debug : do_open:983 : trying driver 0 (Test) ...
19:15:25.624: debug : do_open:989 : driver 0 Test returned DECLINED
19:15:25.624: debug : do_open:983 : trying driver 1 (Xen) ...
19:15:25.624: debug : do_open:989 : driver 1 Xen returned DECLINED
19:15:25.624: debug : do_open:983 : trying driver 2 (remote) ...
19:15:25.624: debug : do_open:989 : driver 2 remote returned DECLINED
19:15:25.624: debug : do_open:983 : trying driver 3 (QEMU) ...
19:15:25.624: debug : do_open:989 : driver 3 QEMU returned SUCCESS
19:15:25.624: debug : do_open:1009 : network driver 0 Test returned DECLINED
19:15:25.624: debug : do_open:1009 : network driver 1 remote returned DECLINED
19:15:25.624: debug : do_open:1009 : network driver 2 Network returned SUCCESS
19:15:25.624: debug : do_open:1031 : storage driver 0 Test returned DECLINED
19:15:25.624: debug : do_open:1031 : storage driver 1 remote returned DECLINED
19:15:25.624: debug : do_open:1031 : storage driver 2 storage returned SUCCESS
19:15:25.624: debug : do_open:1052 : node driver 0 Test returned DECLINED
19:15:25.624: debug : do_open:1052 : node driver 1 remote returned DECLINED
19:15:25.624: debug : do_open:1052 : node driver 2 halDeviceMonitor returned SUCCESS
19:15:25.625: debug : virNodeGetInfo:3165 : conn=0x18e790b0, info=0x42c23e80
19:15:25.626: debug : qemudDispatchClientFailure:1407 : Deregistering to relay remote \
events 19:15:25.626: debug : virConnectDomainEventDeregister:7760 : conn=0x18e790b0, \
cb=0x4143d0 19:15:26.178: debug : qemudDomainSetMemoryBalloon:2719 : one-71: balloon \
reply: balloon 256

19:15:26.179: debug : virConnectClose:1171 : conn=0x18e790b0
19:15:26.179: debug : virUnrefConnect:210 : unref connection 0x18e790b0 1
19:15:26.179: debug : virReleaseConnect:171 : release connection 0x18e790b0
19:15:28.709: debug : virDomainMigrateFinish2:3119 : dconn=0x2aaaac000970, \
dname=one-71, cookie=(nil), cookielen=0, \
uri=tcp:itpsmenc044.engicloud.psmidc.com:49154, flags=1, retcode=0 19:15:28.710: \
debug : virGetDomain:271 : New hash entry 0x2aaaac000a80 19:15:28.729: debug : \
qemudDispatchClientFailure:1407 : Deregistering to relay remote events 19:15:28.729: \
debug : virConnectDomainEventDeregister:7760 : conn=0x2aaaac000970, cb=0x4143d0 \
19:15:28.729: debug : virConnectClose:1171 : conn=0x2aaaac000970 19:15:28.729: debug \
: virUnrefConnect:210 : unref connection 0x2aaaac000970 2


failure from red3:

18:03:55.054: debug : virConnectOpen:1103 : name=qemu:///system
18:03:55.054: debug : do_open:973 : name "qemu:///system" to URI components:
  scheme qemu
  opaque (null)
  authority (null)
  server (null)
  user (null)
  port 0
  path /system

18:03:55.054: debug : do_open:983 : trying driver 0 (Test) ...
18:03:55.054: debug : do_open:989 : driver 0 Test returned DECLINED
18:03:55.054: debug : do_open:983 : trying driver 1 (Xen) ...
18:03:55.054: debug : do_open:989 : driver 1 Xen returned DECLINED
18:03:55.054: debug : do_open:983 : trying driver 2 (remote) ...
18:03:55.054: debug : do_open:989 : driver 2 remote returned DECLINED
18:03:55.054: debug : do_open:983 : trying driver 3 (QEMU) ...
18:03:55.054: debug : do_open:989 : driver 3 QEMU returned SUCCESS
18:03:55.054: debug : do_open:1009 : network driver 0 Test returned DECLINED
18:03:55.054: debug : do_open:1009 : network driver 1 remote returned DECLINED
18:03:55.054: debug : do_open:1009 : network driver 2 Network returned SUCCESS
18:03:55.054: debug : do_open:1031 : storage driver 0 Test returned DECLINED
18:03:55.054: debug : do_open:1031 : storage driver 1 remote returned DECLINED
18:03:55.054: debug : do_open:1031 : storage driver 2 storage returned SUCCESS
18:03:55.054: debug : do_open:1052 : node driver 0 Test returned DECLINED
18:03:55.054: debug : do_open:1052 : node driver 1 remote returned DECLINED
18:03:55.054: debug : do_open:1052 : node driver 2 halDeviceMonitor returned SUCCESS
18:03:55.057: debug : virDrvSupportsFeature:1232 : conn=0x18e7f280, feature=3
18:03:55.060: debug : virDomainMigratePrepare2:3071 : dconn=0x18e7f280, \
cookie=0x42222eb8, cookielen=0x42222ec4, uri_in=(null), uri_out=0x18e46a00,flags=1, \
dname=(null), bandwidth=0, dom_xml=&lt;domain type='kvm' id='1'&gt;  &lt;name&gt;one-73&lt;/name&gt;
  &lt;uuid&gt;1095202e-6042-d2f7-28bf-ad745dd341da&lt;/uuid&gt;
  &lt;memory&gt;262144&lt;/memory&gt;
  &lt;currentMemory&gt;262144&lt;/currentMemory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='x86_64' machine='rhel5.4.0'&gt;hvm&lt;/type&gt;
    &lt;boot dev='hd'/&gt;
  &lt;/os&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;destroy&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;source file='/srv/cloud/one/var/images/73/images/disk.0'/&gt;
      &lt;target dev='hda' bus='ide'/&gt;
    &lt;/disk&gt;
    &lt;disk type='file' device='cdrom'&gt;
      &lt;source file='/srv/cloud/one/var/images/73/images/disk.1'/&gt;
      &lt;target dev='hdb' bus='ide'/&gt;
      &lt;readonly/&gt;
    &lt;/disk&gt;
    &lt;interface type='bridge'&gt;
      &lt;mac address='02:00:a1:1b:d6:d7'/&gt;
      &lt;source bridge='bridge0.334'/&gt;
      &lt;target dev='vnet4'/&gt;
    &lt;/interface&gt;
    &lt;input type='mouse' bus='ps2'/&gt;
    &lt;graphics type='vnc' port='5973' autoport='no' listen='0.0.0.0'/&gt;
  &lt;/devices&gt;
&lt;/domain&gt;

18:03:55.061: debug : virExecWithHook:546 : /usr/bin/kvm -help
18:03:55.067: info : Received unexpected signal 17
18:03:55.078: debug : virExecWithHook:546 : /usr/bin/kvm -S -M rhel5.4.0 -m 256 -smp \
1 -name one-73 -uuid 1095202e-6042-d2f7-28bf-ad745dd341da -no-kvm-pit-reinjection \
-monitor pty -pidfile /var/run/libvirt/qemu//one-73.pid -no-acpi -boot c -drive \
file=/srv/cloud/one/var/images/73/images/disk.0,if=ide,index=0,boot=on -drive \
file=/srv/cloud/one/var/images/73/images/disk.1,if=ide,media=cdrom,index=1 -net \
nic,macaddr=02:00:a1:1b:d6:d7,vlan=0 -net tap,fd=19,script=,vlan=0,ifname=vnet4 \
-serial none -parallel none -usb -vnc 0.0.0.0:73 -incoming tcp:0.0.0.0:49153 \
18:03:55.080: info : Received unexpected signal 17 18:03:56.106: debug : \
qemudDomainSetMemoryBalloon:2719 : one-73: balloon reply: balloon 256

18:03:56.114: debug : virDomainMigrateFinish2:3119 : dconn=0x18e7f280, dname=one-73, \
cookie=(nil), cookielen=0, uri=tcp:itpsmenc044.engicloud.psmidc.com:49153, flags=1, \
retcode=-1 18:03:56.114: debug : qemudShutdownVMDaemon:1684 : Shutting down VM \
'one-73'

18:03:56.115: debug : qemudDispatchClientFailure:1407 : Deregistering to relay remote \
events 18:03:56.115: debug : virConnectDomainEventDeregister:7760 : conn=0x18e7f280, \
cb=0x4143d0 18:03:56.115: debug : virConnectClose:1171 : conn=0x18e7f280
18:03:56.115: debug : virUnrefConnect:210 : unref connection 0x18e7f280 1
18:03:56.115: debug : virReleaseConnect:171 : release connection 0x18e7f280
18:04:10.666: debug : virConnectOpen:1103 : name=qemu:///system
18:04:10.666: debug : do_open:973 : name "qemu:///system" to URI components:
  scheme qemu
  opaque (null)
  authority (null)
  server (null)
  user (null)
  port 0
  path /system

18:04:10.666: debug : do_open:983 : trying driver 0 (Test) ...
18:04:10.666: debug : do_open:989 : driver 0 Test returned DECLINED
18:04:10.666: debug : do_open:983 : trying driver 1 (Xen) ...
18:04:10.666: debug : do_open:989 : driver 1 Xen returned DECLINED
18:04:10.666: debug : do_open:983 : trying driver 2 (remote) ...
18:04:10.666: debug : do_open:989 : driver 2 remote returned DECLINED
18:04:10.666: debug : do_open:983 : trying driver 3 (QEMU) ...
18:04:10.666: debug : do_open:989 : driver 3 QEMU returned SUCCESS
18:04:10.666: debug : do_open:1009 : network driver 0 Test returned DECLINED
18:04:10.666: debug : do_open:1009 : network driver 1 remote returned DECLINED
18:04:10.666: debug : do_open:1009 : network driver 2 Network returned SUCCESS
18:04:10.666: debug : do_open:1031 : storage driver 0 Test returned DECLINED
18:04:10.666: debug : do_open:1031 : storage driver 1 remote returned DECLINED
18:04:10.666: debug : do_open:1031 : storage driver 2 storage returned SUCCESS
18:04:10.666: debug : do_open:1052 : node driver 0 Test returned DECLINED
18:04:10.666: debug : do_open:1052 : node driver 1 remote returned DECLINED
18:04:10.666: debug : do_open:1052 : node driver 2 halDeviceMonitor returned SUCCESS
18:04:10.667: debug : virNodeGetInfo:3165 : conn=0x18e73df0, info=0x42222e80
18:04:10.668: debug : qemudDispatchClientFailure:1407 : Deregistering to relay remote \
events 18:04:10.668: debug : virConnectDomainEventDeregister:7760 : conn=0x18e73df0, \
cb=0x4143d0 18:04:10.668: debug : virConnectClose:1171 : conn=0x18e73df0
18:04:10.668: debug : virUnrefConnect:210 : unref connection 0x18e73df0 1
18:04:10.668: debug : virReleaseConnect:171 : release connection 0x18e73df0
18:04:14.646: debug : virConnectOpenReadOnly:1126 : name=qemu:///system
18:04:14.646: debug : do_open:973 : name "qemu:///system" to URI components:
  scheme qemu
  opaque (null)
  authority (null)
  server (null)
  user (null)
  port 0
  path /system

18:04:14.646: debug : do_open:983 : trying driver 0 (Test) ...
18:04:14.646: debug : do_open:989 : driver 0 Test returned DECLINED
18:04:14.646: debug : do_open:983 : trying driver 1 (Xen) ...
18:04:14.646: debug : do_open:989 : driver 1 Xen returned DECLINED
18:04:14.646: debug : do_open:983 : trying driver 2 (remote) ...
18:04:14.646: debug : do_open:989 : driver 2 remote returned DECLINED
18:04:14.646: debug : do_open:983 : trying driver 3 (QEMU) ...
18:04:14.646: debug : do_open:989 : driver 3 QEMU returned SUCCESS
18:04:14.646: debug : do_open:1009 : network driver 0 Test returned DECLINED
18:04:14.646: debug : do_open:1009 : network driver 1 remote returned DECLINED
18:04:14.646: debug : do_open:1009 : network driver 2 Network returned SUCCESS
18:04:14.646: debug : do_open:1031 : storage driver 0 Test returned DECLINED
18:04:14.646: debug : do_open:1031 : storage driver 1 remote returned DECLINED
18:04:14.646: debug : do_open:1031 : storage driver 2 storage returned SUCCESS
18:04:14.646: debug : do_open:1052 : node driver 0 Test returned DECLINED
18:04:14.646: debug : do_open:1052 : node driver 1 remote returned DECLINED
18:04:14.646: debug : do_open:1052 : node driver 2 halDeviceMonitor returned SUCCESS
18:04:14.647: debug : virDomainLookupByName:1771 : conn=0x18e1e6b0, name=one-71
18:04:14.647: debug : virGetDomain:271 : New hash entry 0x18e717c0
18:04:14.647: debug : virDomainFree:1859 : domain=0x18e717c0
18:04:14.647: debug : virUnrefDomain:345 : unref domain 0x18e717c0 one-71 1
18:04:14.647: debug : virReleaseDomain:303 : release domain 0x18e717c0 one-71
18:04:14.647: debug : virReleaseDomain:315 : unref connection 0x18e1e6b0 2
18:04:14.648: debug : virGetDomain:271 : New hash entry 0x18e717c0
18:04:14.648: debug : virDomainGetOSType:2438 : domain=0x18e717c0
18:04:14.648: debug : virDomainFree:1859 : domain=0x18e717c0
18:04:14.648: debug : virUnrefDomain:345 : unref domain 0x18e717c0 one-71 1
18:04:14.648: debug : virReleaseDomain:303 : release domain 0x18e717c0 one-71
18:04:14.648: debug : virReleaseDomain:315 : unref connection 0x18e1e6b0 2
18:04:14.648: debug : virGetDomain:271 : New hash entry 0x18e717c0
18:04:14.648: debug : virDomainGetInfo:2622 : domain=0x18e717c0, info=0x42c23ea0
18:04:14.649: debug : qemudGetProcessInfo:2149 : Got status for 26133/0 user=4 sys=22 \
cpu=0 18:04:14.649: debug : qemudDomainGetMemoryBalloon:2665 : one-71: balloon reply: \
                'info balloon
balloon: actual=256
'
18:04:14.649: debug : virDomainFree:1859 : domain=0x18e717c0
18:04:14.649: debug : virUnrefDomain:345 : unref domain 0x18e717c0 one-71 1
18:04:14.649: debug : virReleaseDomain:303 : release domain 0x18e717c0 one-71
18:04:14.649: debug : virReleaseDomain:315 : unref connection 0x18e1e6b0 2
18:04:14.650: debug : virGetDomain:271 : New hash entry 0x18e717c0
18:04:14.650: debug : virDomainGetAutostart:3959 : domain=0x18e717c0, \
autostart=0x44026040 18:04:14.650: debug : virDomainFree:1859 : domain=0x18e717c0
18:04:14.650: debug : virUnrefDomain:345 : unref domain 0x18e717c0 one-71 1
18:04:14.650: debug : virReleaseDomain:303 : release domain 0x18e717c0 one-71
18:04:14.650: debug : virReleaseDomain:315 : unref connection 0x18e1e6b0 2
18:04:14.652: debug : qemudDispatchClientFailure:1407 : Deregistering to relay remote \
events 18:04:14.652: debug : virConnectDomainEventDeregister:7760 : conn=0x18e1e6b0, \
cb=0x4143d0 18:04:14.652: debug : virConnectClose:1171 : conn=0x18e1e6b0
18:04:14.652: debug : virUnrefConnect:210 : unref connection 0x18e1e6b0 1
18:04:14.652: debug : virReleaseConnect:171 : release connection 0x18e1e6b0

libsdl-console-dev libsdl-console libsdl-sge libsdl-sound1.2 

Comparing  the two  sets of  lines,  the differences  start after  the
second unexpected  SIGCHLD (17) that  happened at 19:15:25.148  in the
successful migrate and at 18:03:55.080 during the failing attempt.

As usual, any wisdom &amp; advice about what I could have done wrong would
be really appreciated.

--
ing. Gian Uberto Lauri
Ricercatore / Reasearcher
Divisione Ricerca ed Innovazione / Research &amp; Innovation Division
GianUberto.Lauri@eng.it

Engineering Ingegneria Informatica spa
Corso Stati Uniti 23/C, 35127 Padova (PD) 

Tel. +39-049.8283.538         | main(){printf(&amp;unix["\021%six\012\0"], 
Fax  +39-049.8283.569		  |    (unix)["have"]+"fun"-0x60);}   
Skype: gian.uberto.lauri	  |          David Korn, AT&amp;T Bell Labs             
http://www.eng.it 			  |          ioccc best One Liner, 1987             

P.S. I apologize for any inconvenience generated by my poor English ...


</body></email><email><emailId>20110109180544</emailId><senderName>Matthias Meyer</senderName><senderEmail>matthias.meyer@gmx.li</senderEmail><timestampReceived>2011-01-09 18:05:44-0400</timestampReceived><subject>[libvirt-users] Windows guest eats as many CPU as available</subject><body>

Hello,

I run Debian on my Laptop Lenovo X60s (with VT).
I've created a Windows-XP as well as a Windows-Vista guest on it.
Both, XP as well as Vista, eats as many CPU as available.
Therefore the CPU always has high load and will never reduce cpu-frequenz or 
ventilator.

Did this works as designed or should I modify something?

Thanks in advance
Matthias
-- 
Don't Panic

</body></email><email><emailId>20110113134527</emailId><senderName>Nikita A Menkovich</senderName><senderEmail>menkovich@gmail.com</senderEmail><timestampReceived>2011-01-13 13:45:27-0400</timestampReceived><subject>[libvirt-users] Problem with FreeBSD graceful shutdown</subject><body>

Hello,

I have FreeBSD guest running with KVM+libvirt, when I send shutdown
through virsh for ex.

$ virsh shutdown freebsd

There is not any reaction from FreeBSD. Linux guests works together
with acpid daemon well.
devd in freebsd is running, and should work correct. Is there any way
to fix this

dumpxml config
http://pastebin.com/UGGgG894

devd config is out of box
-- 
Nikita A Menkovich
JID: menkovich@gmail.com

</body></email><email><emailId>20110113175459</emailId><senderName>Lucas Arbiza</senderName><senderEmail>lucas.arbiza@gmail.com</senderEmail><timestampReceived>2011-01-13 17:54:59-0400</timestampReceived><subject>[libvirt-users] ERROR Unable to deny all devices for (solution)</subject><body>

Hi. This is not a question, I had the following problem and I want to share
my solution.

-------

I tried to create a new virtual machine with this command:

$ virt-install --connect qemu:///system -n vmTeste -r 512 -f
/var/lib/libvirt/images/vmTeste.qcow2 -s 2 -c
/media/Data/isos/debian-506-amd64-netinst.iso --vnc --noautoconsole
--accelerate --hvm


And I got this error:

ERROR    Unable to deny all devices for vmTeste: No such file or directory
Traceback (most recent call last):
  File "/usr/bin/virt-install", line 1033, in &lt;module&gt;
    main()
  File "/usr/bin/virt-install", line 915, in main
    start_time, guest.start_install)
  File "/usr/bin/virt-install", line 957, in do_install
    dom = install_func(conscb, progresscb, wait=(not wait))
  File "/usr/lib/pymodules/python2.6/virtinst/Guest.py", line 973, in
start_install
    return self._do_install(consolecb, meter, removeOld, wait)
  File "/usr/lib/pymodules/python2.6/virtinst/Guest.py", line 1038, in
_do_install
    "install")
  File "/usr/lib/pymodules/python2.6/virtinst/Guest.py", line 1009, in
_create_guest
    dom = self.conn.createLinux(start_xml, 0)
  File "/usr/lib/python2.6/dist-packages/libvirt.py", line 1277, in
createLinux
    if ret is None:raise libvirtError('virDomainCreateLinux() failed',
conn=self)
libvirtError: Unable to deny all devices for vmTeste: No such file or
directory


I found the same error looking for in the internet, similar errors including
in this list. I tried to solve changing permissions, editing xml and
defining the virtual machine, etc.

No long time ago I made some changes to optimize kernel performance for
desktop as described here (it's in Portuguese, but can be undertood reading
the commands and files) and this changes caused the above errors (in Ubuntu
10.10 and Fedora 14).  I undid the changes and I had no more errors.

Possibly I can be wrong, but it worked for me.
__

*Lucas Arbiza*

email: lucas.arbiza@gmail.com
celular: +55 (55) 9152 7561

Twitter: http://twitter.com/lucasarbiza
Facebook: http://www.facebook.com/lucas.arbiza
Google Profile: http://www.google.com/profiles/lucas.arbiza
&lt;http://www.google.com/profiles/lucas.arbiza&gt;LinkedIn:
http://br.linkedin.com/in/lucasarbiza

[Attachment #3 (text/html)]

&lt;div&gt;&lt;font class="Apple-style-span" face="verdana, sans-serif"&gt;Hi. This is not a \
question, I had the following problem and I want to share my \
solution.&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="verdana, \
sans-serif"&gt;&lt;br&gt;

&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="verdana, \
sans-serif"&gt;-------&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="verdana, \
sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="verdana, \
sans-serif"&gt;I tried to create a new virtual machine with this command:&lt;/font&gt;&lt;/div&gt;

&lt;div&gt;&lt;font class="Apple-style-span" face="verdana, \
sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;blockquote class="webkit-indent-blockquote" \
style="margin: 0 0 0 40px; border: none; padding: 0px;"&gt;&lt;div&gt;&lt;font \
class="Apple-style-span" face="verdana, sans-serif" style="background-color: rgb(204, \
204, 204);"&gt;$ virt-install --connect qemu:///system -n vmTeste -r 512 -f \
/var/lib/libvirt/images/vmTeste.qcow2 -s 2 -c \
/media/Data/isos/debian-506-amd64-netinst.iso --vnc --noautoconsole --accelerate \
--hvm&lt;/font&gt;&lt;/div&gt;

&lt;/blockquote&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="verdana, \
sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div class="gmail_quote"&gt;And I got this \
error:&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote class="webkit-indent-blockquote" style="margin: 0 0 0 \
40px; border: none; padding: 0px;"&gt;

&lt;div class="gmail_quote"&gt;&lt;font color="#000000"&gt;&lt;font face="verdana,sans-serif"&gt;&lt;div \
style="background-color: rgb(204, 204, 204);"&gt;ERROR    Unable to deny all devices for \
vmTeste: No such file or directory&lt;/div&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;

&lt;div class="gmail_quote"&gt;&lt;font color="#000000"&gt;&lt;font face="verdana,sans-serif"&gt;&lt;div \
style="background-color: rgb(204, 204, 204);"&gt;Traceback (most recent call \
last):&lt;/div&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div class="gmail_quote"&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;&lt;div style="background-color: rgb(204, 204, 204);"&gt;

  File "/usr/bin/virt-install", line 1033, in \
&lt;module&gt;&lt;/div&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div class="gmail_quote"&gt;&lt;font \
color="#000000"&gt;&lt;font face="verdana,sans-serif"&gt;&lt;div style="background-color: \
rgb(204, 204, 204);"&gt;

    main()&lt;/div&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div class="gmail_quote"&gt;&lt;font \
color="#000000"&gt;&lt;font face="verdana,sans-serif"&gt;&lt;div style="background-color: \
rgb(204, 204, 204);"&gt;  File "/usr/bin/virt-install", line 915, in \
main&lt;/div&gt;

&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div class="gmail_quote"&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;&lt;div style="background-color: rgb(204, 204, 204);"&gt;    \
start_time, guest.start_install)&lt;/div&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div class="gmail_quote"&gt;

&lt;font color="#000000"&gt;&lt;font face="verdana,sans-serif"&gt;&lt;div style="background-color: \
rgb(204, 204, 204);"&gt;  File "/usr/bin/virt-install", line 957, in \
do_install&lt;/div&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div class="gmail_quote"&gt;

&lt;font color="#000000"&gt;&lt;font face="verdana,sans-serif"&gt;&lt;div style="background-color: \
rgb(204, 204, 204);"&gt;    dom = install_func(conscb, progresscb, wait=(not \
wait))&lt;/div&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div class="gmail_quote"&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;&lt;div style="background-color: rgb(204, 204, 204);"&gt;

  File "/usr/lib/pymodules/python2.6/virtinst/Guest.py", line 973, in \
start_install&lt;/div&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div class="gmail_quote"&gt;&lt;font \
color="#000000"&gt;&lt;font face="verdana,sans-serif"&gt;&lt;div style="background-color: \
rgb(204, 204, 204);"&gt;

    return self._do_install(consolecb, meter, removeOld, \
wait)&lt;/div&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div class="gmail_quote"&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;&lt;div style="background-color: rgb(204, 204, 204);"&gt;  File \
"/usr/lib/pymodules/python2.6/virtinst/Guest.py", line 1038, in \
_do_install&lt;/div&gt;

&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div class="gmail_quote"&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;&lt;div style="background-color: rgb(204, 204, 204);"&gt;    \
"install")&lt;/div&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div class="gmail_quote"&gt;

&lt;font color="#000000"&gt;&lt;font face="verdana,sans-serif"&gt;&lt;div style="background-color: \
rgb(204, 204, 204);"&gt;  File \
"/usr/lib/pymodules/python2.6/virtinst/Guest.py", line 1009, in \
_create_guest&lt;/div&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;

&lt;div class="gmail_quote"&gt;&lt;font color="#000000"&gt;&lt;font face="verdana,sans-serif"&gt;&lt;div \
style="background-color: rgb(204, 204, 204);"&gt;    dom = \
self.conn.createLinux(start_xml, 0)&lt;/div&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div \
class="gmail_quote"&gt;

&lt;font color="#000000"&gt;&lt;font face="verdana,sans-serif"&gt;&lt;div style="background-color: \
rgb(204, 204, 204);"&gt;  File "/usr/lib/python2.6/dist-packages/libvirt.py", \
line 1277, in createLinux&lt;/div&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt; &lt;div class="gmail_quote"&gt;
&lt;font color="#000000"&gt;&lt;font face="verdana,sans-serif"&gt;&lt;div style="background-color: \
rgb(204, 204, 204);"&gt;    if ret is None:raise \
libvirtError('virDomainCreateLinux() failed', \
conn=self)&lt;/div&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt; &lt;div class="gmail_quote"&gt;
&lt;font color="#000000"&gt;&lt;font face="verdana,sans-serif"&gt;&lt;div style="background-color: \
rgb(204, 204, 204);"&gt;libvirtError: Unable to deny all devices for vmTeste: No such \
file or directory&lt;/div&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;/blockquote&gt;

&lt;div class="gmail_quote"&gt;&lt;font color="#000000"&gt;&lt;font face="verdana,sans-serif"&gt;



&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I found the same error looking for in the internet, similar \
errors including in this list. I tried to solve changing permissions, editing xml and \
defining the virtual machine, etc.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;

&lt;div&gt;No long time ago I made some changes to optimize kernel performance for desktop \
as described here (it's in Portuguese, but can be undertood reading the commands \
and files) and this changes caused the above errors (in Ubuntu 10.10 and Fedora 14).  \
I undid the changes and I had no more errors.&lt;/div&gt;

&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Possibly I can be wrong, but it worked for \
me.&lt;/div&gt;&lt;/font&gt;&lt;/font&gt;__&lt;br&gt; &lt;br&gt;&lt;b&gt;&lt;font face="verdana, sans-serif"&gt;&lt;font \
color="#333333"&gt;Lucas Arbiza&lt;/font&gt;&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;br&gt;email: &lt;a \
href="mailto:lucas.arbiza@gmail.com" \
target="_blank"&gt;lucas.arbiza@gmail.com&lt;/a&gt;&lt;br&gt;celular: +55 (55) 9152 7561&lt;div&gt;


&lt;br&gt;&lt;/div&gt;&lt;div&gt;Twitter: &lt;a href="http://twitter.com/lucasarbiza" \
target="_blank"&gt;http://twitter.com/lucasarbiza&lt;/a&gt;&lt;/div&gt;&lt;div&gt;Facebook: &lt;a \
href="http://www.facebook.com/lucas.arbiza" \
target="_blank"&gt;http://www.facebook.com/lucas.arbiza&lt;/a&gt;&lt;/div&gt;


&lt;div&gt;Google Profile: &lt;a href="http://www.google.com/profiles/lucas.arbiza" \
target="_blank"&gt;http://www.google.com/profiles/lucas.arbiza&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;a \
href="http://www.google.com/profiles/lucas.arbiza" target="_blank"&gt;&lt;/a&gt;LinkedIn: &lt;a \
href="http://br.linkedin.com/in/lucasarbiza" \
target="_blank"&gt;http://br.linkedin.com/in/lucasarbiza&lt;/a&gt;&lt;br&gt;


&lt;/div&gt;&lt;br&gt;
&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110118024213</emailId><senderName>Scott Lerman</senderName><senderEmail>smlerman@gmail.com</senderEmail><timestampReceived>2011-01-18 02:42:13-0400</timestampReceived><subject>[libvirt-users] Open virt-viewer with virsh start</subject><body>

Is it possible to have virt-viewer come up when a domain is started
with virsh start, the same way that it does with virt-install?

Thanks.

---
Scott Lerman

</body></email><email><emailId>20110117204557</emailId><senderName>Josiah Ritchie</senderName><senderEmail>josiah@fim.org</senderEmail><timestampReceived>2011-01-17 20:45:57-0400</timestampReceived><subject>[libvirt-users] list mac or IP of all guests NICs?</subject><body>

I'm trying to figure out how to use virsh (or something else) to list all
the IP addresses (or MAC addresses if needed) for each virtual NIC,
preferably with it domain affiliation also listed.

Is this possible?

Thanks,
JSR/

[Attachment #3 (text/html)]

I'm trying to figure out how to use virsh (or something else) to list all the IP \
addresses (or MAC addresses if needed) for each virtual NIC, preferably with it \
domain affiliation also listed. &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is this \
possible?&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;JSR/&lt;/div&gt;



</body></email><email><emailId>20110112151151</emailId><senderName>John Paul Walters</senderName><senderEmail>jwalters@isi.edu</senderEmail><timestampReceived>2011-01-12 15:11:51-0400</timestampReceived><subject>[libvirt-users] host to VM serial device configuration</subject><body>

Hi,

I'm trying to get a virtual serial device up and running between my  
host and virtual machine with a device name on the host.  I'm using  
libvirt 0.8.3 and qemu 0.13.0.  The challenge that I'm running into is  
that I'm able to get a serial device, but I cannot fix it to a pre- 
defined device name.  For example, I'm using the following in my VM's  
xml file:

&lt;serial type='pty'&gt;
	&lt;source path='/dev/pts/19' /&gt;
	&lt;target port='0' /&gt;
&lt;/serial&gt;

As I said this works, but it doesn't set the host side to /dev/pts/ 
19.  Is there any way to do this?

thanks,
JP 
  

</body></email><email><emailId>20110119161802</emailId><senderName>Guido Winkelmann</senderName><senderEmail>guido-libvi@unknownsite.de</senderEmail><timestampReceived>2011-01-19 16:18:02-0400</timestampReceived><subject>[libvirt-users] Getting CPU and memory usage statistics for the host</subject><body>

Hi,

I have noticed that virt-manager has the ability to show me the current cpu- and 
memory-usage of both the host and running guest machines.

How does it do that?

I could make good use of that information myself in the client applications I'm 
writing, however, from what I can see on 
http://libvirt.org/html/libvirt-libvirt.html, I have no idea how to go about 
getting it from libvirt. In fact, before I've seen virt-manager, I just assumed 
libvirt cannot do that at all, and was planning to manually ssh to the host and 
read statistics from /proc when I'd need them.

I've tried looking at the virt-manager source code to find out how to do this, 
but it appears I would have to learn Python first in order to understand it.

Could someone please give me some pointers?

Regards,

	Guido

</body></email><email><emailId>20110117105109</emailId><senderName>Hongqing Yang</senderName><senderEmail>hoyang@redhat.com</senderEmail><timestampReceived>2011-01-17 10:51:09-0400</timestampReceived><subject>[libvirt-users] virt-install with --channel option inquiry</subject><body>

hi, virt guys,
This is Hongqing from Fedroa QA team. I try to forward the guest installation logs to \
host with virtio. I have used virsh edit &lt;guestName&gt; to add a channel, it works fine. \
 I think it would be better if I can initialize it when I create the guest using \
virt-install,  and virt-install also offers the option, I have tried  below, but it \
does not work. virt-install
     --connect qemu:///system \
     --virt-type kvm \
     --name demo2 \
     --ram 500 \
     --disk  path=/home/hongqing/testscript/demo2.img,size=10,sparse=true \
     --accelerate \
     --cdrom  /home/hongqing/fedora/Fedora-14-x86_64-DVD.iso \
     --channel tcp host=127.0.0.1:6080  mode=connect target_type=virtio \
name=org.fedoraproject.anaconda.log.0  
error message is :
ERROR    internal error Process exited while reading console log output: char device \
redirected to /dev/pts/20 getaddrinfo(127.0.0.1,None): Servname not supported for \
                ai_socktype
chardev: opening backend "socket" failed

both the host and guest are fedaora 14.
I have checked the service syslog with port 6080 is listening. and also I have \
disabled the SElinux. Do you have any idea about this? Thanks for taking time to view \
it.

Hongqing YANG


</body></email><email><emailId>20110119080515</emailId><senderName>vipul borikar</senderName><senderEmail>vipulcell@gmail.com</senderEmail><timestampReceived>2011-01-19 08:05:15-0400</timestampReceived><subject>[libvirt-users] Python Bindings for Python 2.7</subject><body>

Hello,
          I want to source compile the libvirt 0.8.4 with its Python
bindings.

I have python 2.4 rpm installed but i dont use it. I use Python 2.7 source
compiled version.

So when i compile libvirt it produces bindings for Python 2.4 which is
obvious  choice since it is rpm.

So how should i make it point to Python 2.7 so that it produces bindings for
it.  Installed path of Python 2.7 is /opt/Python2.7.

Please Guide me.

Thanks
Vipul

[Attachment #3 (text/html)]

Hello, &lt;br&gt;=A0=A0=A0=A0=A0=A0=A0=A0=A0 I want to source compile the libvirt=
 0.8.4 with its Python bindings. &lt;br&gt;&lt;br&gt;I have python 2.4 rpm installed bu=
t i dont use it. I use Python 2.7 source compiled version. &lt;br&gt;&lt;br&gt;So when =
i compile libvirt it produces bindings for Python 2.4 which is obvious=A0 c=
hoice since it is rpm.&lt;br&gt;
&lt;br&gt;So how should i make it point to Python 2.7 so that it produces binding=
s for it.=A0 Installed path of Python 2.7 is /opt/Python2.7.&lt;br&gt;&lt;br&gt;Please =
Guide me.&lt;br&gt;&lt;br&gt;Thanks&lt;br&gt;Vipul&lt;br&gt;


</body></email><email><emailId>20110119125555</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-01-19 12:55:55-0400</timestampReceived><subject>Re: [libvirt-users] Python Bindings for Python 2.7</subject><body>

2011/1/19 vipul borikar &lt;vipulcell@gmail.com&gt;:
&gt; Hello,
&gt;           I want to source compile the libvirt 0.8.4 with its Python
&gt; bindings.
&gt;
&gt; I have python 2.4 rpm installed but i dont use it. I use Python 2.7 source
&gt; compiled version.
&gt;
&gt; So when i compile libvirt it produces bindings for Python 2.4 which is
&gt; obvious  choice since it is rpm.
&gt;
&gt; So how should i make it point to Python 2.7 so that it produces bindings for
&gt; it.  Installed path of Python 2.7 is /opt/Python2.7.
&gt;
&gt; Please Guide me.

You can try to run

  ./configure --with-python=/opt/Python2.7

assuming that there is /opt/Python2.7/bin/python.

Another possibility is to specify the Python binary per environment variable

  PYTHON=/opt/Python2.7/bin/python ./configure

This will probably work but I'm not entirely sure as this is an
uncommon configuration.

Matthias

</body></email><email><emailId>20110120054140</emailId><senderName>vipul borikar</senderName><senderEmail>vipulcell@gmail.com</senderEmail><timestampReceived>2011-01-20 05:41:40-0400</timestampReceived><subject>Re: [libvirt-users] Python Bindings for Python 2.7</subject><body>

Thanks for the Reply Matthias.

The  ./configure --with-python=/opt/Python2.7  worked.

But when i do make I go this error related with sax parser.



make[3]: Entering directory `/root/libvirt-0.8.4/python'
/opt/Python-2.7//bin/python ./generator.py .
Traceback (most recent call last):
  File "./generator.py", line 1447, in &lt;module&gt;
    if buildStubs() &lt; 0:
  File "./generator.py", line 567, in buildStubs
    (parser, target)  = getparser()
  File "./generator.py", line 35, in getparser
    parser = xml.sax.make_parser()
  File
"/opt/Python-2.7/lib/python2.7/site-packages/_xmlplus/sax/sax2exts.py", line
37, in make_parser
    return XMLParserFactory.make_parser(parser_list)
  File
"/opt/Python-2.7/lib/python2.7/site-packages/_xmlplus/sax/saxexts.py", line
75, in make_parser
    sys.modules[parser_name].create_parser = _create_parser
KeyError: 'xml.sax.drivers2.drv_pyexpat'
make[3]: *** [generated.stamp] Error 1
make[3]: Leaving directory `/root/libvirt-0.8.4/python'
make[2]: *** [all-recursive] Error 1
make[2]: Leaving directory `/root/libvirt-0.8.4/python'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/root/libvirt-0.8.4'
make: *** [all] Error 2

Thanks
Vipul

On Wed, Jan 19, 2011 at 6:25 PM, Matthias Bolte &lt;
matthias.bolte@googlemail.com&gt; wrote:

&gt; 2011/1/19 vipul borikar &lt;vipulcell@gmail.com&gt;:
&gt; &gt; Hello,
&gt; &gt;           I want to source compile the libvirt 0.8.4 with its Python
&gt; &gt; bindings.
&gt; &gt;
&gt; &gt; I have python 2.4 rpm installed but i dont use it. I use Python 2.7
&gt; source
&gt; &gt; compiled version.
&gt; &gt;
&gt; &gt; So when i compile libvirt it produces bindings for Python 2.4 which is
&gt; &gt; obvious  choice since it is rpm.
&gt; &gt;
&gt; &gt; So how should i make it point to Python 2.7 so that it produces bindings
&gt; for
&gt; &gt; it.  Installed path of Python 2.7 is /opt/Python2.7.
&gt; &gt;
&gt; &gt; Please Guide me.
&gt;
&gt; You can try to run
&gt;
&gt;  ./configure --with-python=/opt/Python2.7
&gt;
&gt; assuming that there is /opt/Python2.7/bin/python.
&gt;
&gt; Another possibility is to specify the Python binary per environment
&gt; variable
&gt;
&gt;  PYTHON=/opt/Python2.7/bin/python ./configure
&gt;
&gt; This will probably work but I'm not entirely sure as this is an
&gt; uncommon configuration.
&gt;
&gt; Matthias
&gt;

[Attachment #3 (text/html)]

Thanks for the Reply Matthias.&lt;br&gt;&lt;br&gt;The  
 ./configure --with-python=/opt/Python2.7  worked. &lt;br&gt;&lt;br&gt;But when i do make I go \
this error related with sax parser.&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;make[3]: Entering directory \
`/root/libvirt-0.8.4/python'&lt;br&gt;/opt/Python-2.7//bin/python ./generator.py .&lt;br&gt; \
Traceback (most recent call last):&lt;br&gt;  File "./generator.py", line 1447, \
in &lt;module&gt;&lt;br&gt;    if buildStubs() &lt; 0:&lt;br&gt;  File \
"./generator.py", line 567, in buildStubs&lt;br&gt;    (parser, target)  = \
getparser()&lt;br&gt;  File "./generator.py", line 35, in getparser&lt;br&gt;    parser \
= xml.sax.make_parser()&lt;br&gt;  File \
"/opt/Python-2.7/lib/python2.7/site-packages/_xmlplus/sax/sax2exts.py", \
line 37, in make_parser&lt;br&gt;    return XMLParserFactory.make_parser(parser_list)&lt;br&gt;  \
File "/opt/Python-2.7/lib/python2.7/site-packages/_xmlplus/sax/saxexts.py", \
line 75, in make_parser&lt;br&gt;    sys.modules[parser_name].create_parser = \
_create_parser&lt;br&gt;KeyError: 'xml.sax.drivers2.drv_pyexpat'&lt;br&gt; make[3]: *** \
[generated.stamp] Error 1&lt;br&gt;make[3]: Leaving directory \
`/root/libvirt-0.8.4/python'&lt;br&gt;make[2]: *** [all-recursive] Error 1&lt;br&gt;make[2]: \
Leaving directory `/root/libvirt-0.8.4/python'&lt;br&gt;make[1]: *** [all-recursive] \
Error 1&lt;br&gt; make[1]: Leaving directory `/root/libvirt-0.8.4'&lt;br&gt;make: *** [all] \
Error 2&lt;br&gt;&lt;br&gt;Thanks&lt;br&gt;Vipul&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Wed, Jan 19, 2011 \
at 6:25 PM, Matthias Bolte &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt; &lt;blockquote class="gmail_quote" style="border-left: 1px solid rgb(204, \
204, 204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;"&gt;2011/1/19 vipul borikar \
&lt;&lt;a href="mailto:vipulcell@gmail.com"&gt;vipulcell@gmail.com&lt;/a&gt;&gt;:&lt;br&gt;

&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;&gt; Hello,&lt;br&gt;
&gt;           I want to source compile the libvirt 0.8.4 with its Python&lt;br&gt;
&gt; bindings.&lt;br&gt;
&gt;&lt;br&gt;
&gt; I have python 2.4 rpm installed but i dont use it. I use Python 2.7 source&lt;br&gt;
&gt; compiled version.&lt;br&gt;
&gt;&lt;br&gt;
&gt; So when i compile libvirt it produces bindings for Python 2.4 which is&lt;br&gt;
&gt; obvious  choice since it is rpm.&lt;br&gt;
&gt;&lt;br&gt;
&gt; So how should i make it point to Python 2.7 so that it produces bindings for&lt;br&gt;
&gt; it.  Installed path of Python 2.7 is /opt/Python2.7.&lt;br&gt;
&gt;&lt;br&gt;
&gt; Please Guide me.&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;You can try to run&lt;br&gt;
&lt;br&gt;
  ./configure --with-python=/opt/Python2.7&lt;br&gt;
&lt;br&gt;
assuming that there is /opt/Python2.7/bin/python.&lt;br&gt;
&lt;br&gt;
Another possibility is to specify the Python binary per environment variable&lt;br&gt;
&lt;br&gt;
  PYTHON=/opt/Python2.7/bin/python ./configure&lt;br&gt;
&lt;br&gt;
This will probably work but I'm not entirely sure as this is an&lt;br&gt;
uncommon configuration.&lt;br&gt;
&lt;font color="#888888"&gt;&lt;br&gt;
Matthias&lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110120023338</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-01-20 02:33:38-0400</timestampReceived><subject>Re: [libvirt-users] virt-install with --channel option inquiry</subject><body>

于 2011年01月17日 18:51, Hongqing Yang 写道:
&gt; hi, virt guys,
&gt; This is Hongqing from Fedroa QA team. I try to forward the guest installation logs \
&gt; to host with virtio. I have used virsh edit&lt;guestName&gt;  to add a channel, it works \
&gt; fine. I think it would be better if I can initialize it when I create the guest \
&gt; using virt-install, and virt-install also offers the option, I have tried  below, \
&gt; but it does not work. virt-install
&gt; --connect qemu:///system \
&gt; --virt-type kvm \
&gt; --name demo2 \
&gt; --ram 500 \
&gt; --disk  path=/home/hongqing/testscript/demo2.img,size=10,sparse=true \
&gt; --accelerate \
&gt; --cdrom  /home/hongqing/fedora/Fedora-14-x86_64-DVD.iso \
&gt; --channel tcp host=127.0.0.1:6080  mode=connect target_type=virtio \
&gt; name=org.fedoraproject.anaconda.log.0 
&gt; error message is :
&gt; ERROR    internal error Process exited while reading console log output: char \
&gt; device redirected to /dev/pts/20 getaddrinfo(127.0.0.1,None): Servname not \
&gt;                 supported for ai_socktype
&gt; chardev: opening backend "socket" failed
&gt; 
&gt; both the host and guest are fedaora 14.
&gt; I have checked the service syslog with port 6080 is listening. and also I have \
&gt; disabled the SElinux. Do you have any idea about this? Thanks for taking time to \
&gt; view it. 
&gt; Hongqing YANG
&gt; 

--channel SOURCE,target_type=guestfwd,target_address=HOST:PORT

use "," to seperate, but I guess virt-manager could have a more
robust option parsing method, e.g, report error early before doing
the installation for your case.

Regards
Osier
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users


</body></email><email><emailId>20110120024855</emailId><senderName>Hongqing Yang</senderName><senderEmail>hoyang@redhat.com</senderEmail><timestampReceived>2011-01-20 02:48:55-0400</timestampReceived><subject>Re: [libvirt-users] virt-install with --channel option inquiry</subject><body>

Osier,
Thanks for ur reply, it works now.
the place need comma is after tcp  as --channel tcp,host=...
Thanks again

Hongqing

----- Original Message -----
From: "Osier Yang" &lt;jyang@redhat.com&gt;
To: libvirt-users@redhat.com
Sent: Thursday, January 20, 2011 10:33:38 AM
Subject: Re: [libvirt-users] virt-install with --channel option inquiry

于 2011年01月17日 18:51, Hongqing Yang 写道:
&gt; hi, virt guys,
&gt; This is Hongqing from Fedroa QA team. I try to forward the guest installation logs \
&gt; to host with virtio. I have used virsh edit&lt;guestName&gt;  to add a channel, it works \
&gt; fine. I think it would be better if I can initialize it when I create the guest \
&gt; using virt-install, and virt-install also offers the option, I have tried  below, \
&gt; but it does not work. virt-install
&gt; --connect qemu:///system \
&gt; --virt-type kvm \
&gt; --name demo2 \
&gt; --ram 500 \
&gt; --disk  path=/home/hongqing/testscript/demo2.img,size=10,sparse=true \
&gt; --accelerate \
&gt; --cdrom  /home/hongqing/fedora/Fedora-14-x86_64-DVD.iso \
&gt; --channel tcp host=127.0.0.1:6080  mode=connect target_type=virtio \
&gt; name=org.fedoraproject.anaconda.log.0 
&gt; error message is :
&gt; ERROR    internal error Process exited while reading console log output: char \
&gt; device redirected to /dev/pts/20 getaddrinfo(127.0.0.1,None): Servname not \
&gt;                 supported for ai_socktype
&gt; chardev: opening backend "socket" failed
&gt; 
&gt; both the host and guest are fedaora 14.
&gt; I have checked the service syslog with port 6080 is listening. and also I have \
&gt; disabled the SElinux. Do you have any idea about this? Thanks for taking time to \
&gt; view it. 
&gt; Hongqing YANG
&gt; 

--channel SOURCE,target_type=guestfwd,target_address=HOST:PORT

use "," to seperate, but I guess virt-manager could have a more
robust option parsing method, e.g, report error early before doing
the installation for your case.

Regards
Osier
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

_______________________________________________
libvirt-users mailing list
libvirt-users@redhat.com
https://www.redhat.com/mailman/listinfo/libvirt-users


</body></email><email><emailId>20110120030312</emailId><senderName>Hongqing Yang</senderName><senderEmail>hoyang@redhat.com</senderEmail><timestampReceived>2011-01-20 03:03:12-0400</timestampReceived><subject>Re: [libvirt-users] virt-install with --channel option inquiry</subject><body>

I tried again, yes, adding comma is the best manner, if there is no comma between 
target_type and name, org.fedoraproject.anaconda.log.0 will disappear from the guest \
xml file.


----- Original Message -----
From: "Hongqing Yang" &lt;hoyang@redhat.com&gt;
To: "Osier Yang" &lt;jyang@redhat.com&gt;
Cc: libvirt-users@redhat.com
Sent: Thursday, January 20, 2011 10:48:55 AM
Subject: Re: [libvirt-users] virt-install with --channel option inquiry

Osier,
Thanks for ur reply, it works now.
the place need comma is after tcp  as --channel tcp,host=...
Thanks again

Hongqing

----- Original Message -----
From: "Osier Yang" &lt;jyang@redhat.com&gt;
To: libvirt-users@redhat.com
Sent: Thursday, January 20, 2011 10:33:38 AM
Subject: Re: [libvirt-users] virt-install with --channel option inquiry

于 2011年01月17日 18:51, Hongqing Yang 写道:
&gt; hi, virt guys,
&gt; This is Hongqing from Fedroa QA team. I try to forward the guest installation logs \
&gt; to host with virtio. I have used virsh edit&lt;guestName&gt;  to add a channel, it works \
&gt; fine. I think it would be better if I can initialize it when I create the guest \
&gt; using virt-install, and virt-install also offers the option, I have tried  below, \
&gt; but it does not work. virt-install
&gt; --connect qemu:///system \
&gt; --virt-type kvm \
&gt; --name demo2 \
&gt; --ram 500 \
&gt; --disk  path=/home/hongqing/testscript/demo2.img,size=10,sparse=true \
&gt; --accelerate \
&gt; --cdrom  /home/hongqing/fedora/Fedora-14-x86_64-DVD.iso \
&gt; --channel tcp host=127.0.0.1:6080  mode=connect target_type=virtio \
&gt; name=org.fedoraproject.anaconda.log.0 
&gt; error message is :
&gt; ERROR    internal error Process exited while reading console log output: char \
&gt; device redirected to /dev/pts/20 getaddrinfo(127.0.0.1,None): Servname not \
&gt;                 supported for ai_socktype
&gt; chardev: opening backend "socket" failed
&gt; 
&gt; both the host and guest are fedaora 14.
&gt; I have checked the service syslog with port 6080 is listening. and also I have \
&gt; disabled the SElinux. Do you have any idea about this? Thanks for taking time to \
&gt; view it. 
&gt; Hongqing YANG
&gt; 

--channel SOURCE,target_type=guestfwd,target_address=HOST:PORT

use "," to seperate, but I guess virt-manager could have a more
robust option parsing method, e.g, report error early before doing
the installation for your case.

Regards
Osier
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

_______________________________________________
libvirt-users mailing list
libvirt-users@redhat.com
https://www.redhat.com/mailman/listinfo/libvirt-users

_______________________________________________
libvirt-users mailing list
libvirt-users@redhat.com
https://www.redhat.com/mailman/listinfo/libvirt-users


</body></email><email><emailId>20110123143833</emailId><senderName>Nikita A Menkovich</senderName><senderEmail>menkovich@gmail.com</senderEmail><timestampReceived>2011-01-23 14:38:33-0400</timestampReceived><subject>[libvirt-users] Cgroup</subject><body>

Hello,

I'm running Debian Sid with libvirt/qemu/kvm packages from experimental:
$ qemu --version
QEMU emulator version 0.13.0 (Debian 0.13.0+dfsg-2), Copyright (c)
2003-2008 Fabrice Bellard
$ kvm --version
QEMU emulator version 0.13.0 (qemu-kvm-0.13.0 Debian 0.13.0+dfsg-2),
Copyright (c) 2003-2008 Fabrice Bellard
$ libvirtd --version
libvirtd (libvirt) 0.8.6

/etc/libvirt/qemu.conf
cgroup_controllers = [ "cpu", "devices" ]
cgroup_device_acl = [
    "/dev/null", "/dev/full", "/dev/zero",
    "/dev/random", "/dev/urandom",
    "/dev/ptmx", "/dev/kvm", "/dev/kqemu",
    "/dev/rtc", "/dev/hpet", "/dev/net/tun",
]
/etc/cgconfig.conf
mount {
	cpu = /dev/cgroup/cpu;
	cpuacct = /dev/cgroup/cpuacct;
	devices = /dev/cgroup/devices;
#	memory  = /dev/cgroup/memory;
	blkio   = /dev/cgroup/blkio;
}
When I'm running virsh, and want to change cpu shares I receive an error
virsh # schedinfo --set cpu.shares=2048 test
Scheduler      : posix
error: internal error cannot find cgroup for domain test
Really I didn't have any group test in
$ ls /dev/cgroup/cpu/sysdefault/libvirt/qemu/
cgroup.clone_children  cgroup.event_control  cgroup.procs  cpu.shares
notify_on_release  tasks

It happens if I run libvirt as usual user, how can I grant access to
create cgroup to ordinary user?

-- 
Nikita A Menkovich
JID: menkovich@gmail.com

</body></email><email><emailId>20110213183315</emailId><senderName>Zvi Dubitzky</senderName><senderEmail>dubi@il.ibm.com</senderEmail><timestampReceived>2011-02-13 18:33:15-0400</timestampReceived><subject>[libvirt-users] cgroup</subject><body>

Hi

Should  libvirtd be in a cgroup hierarchy  rooted at /dev/cgroup or it can 
be rooted also at /cgroup
i,e  can /etc/cgconfig.conf   look like his  (without the /dev) :

mount {
        cpuset  = /cgroup/cpuset;
        cpu     = /cgroup/cpu;
        cpuacct = /cgroup/cpuacct;
        memory  = /cgroup/memory;
        devices = /cgroup/devices;
        freezer = /cgroup/freezer;
        net_cls = /cgroup/net_cls;
        ns      = /cgroup/ns;
        blkio   = /cgroup/blkio;
}

thanks

Zvi Dubitzky 
Email:dubi@il.ibm.com


</body></email><email><emailId>20110114035001</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-01-14 03:50:01-0400</timestampReceived><subject>Re: [libvirt-users] host to VM serial device configuration</subject><body>

于 2011年01月12日 23:11, John Paul Walters 写道:
&gt; Hi,
&gt;
&gt; I'm trying to get a virtual serial device up and running between my host
&gt; and virtual machine with a device name on the host. I'm using libvirt
&gt; 0.8.3 and qemu 0.13.0. The challenge that I'm running into is that I'm
&gt; able to get a serial device, but I cannot fix it to a pre-defined device
&gt; name. For example, I'm using the following in my VM's xml file:
&gt;
&gt; &lt;serial type='pty'&gt;
&gt; &lt;source path='/dev/pts/19' /&gt;
&gt; &lt;target port='0' /&gt;
&gt; &lt;/serial&gt;
&gt;
&gt; As I said this works, but it doesn't set the host side to /dev/pts/19.
&gt; Is there any way to do this?

I could reproduce it, trying to find out why.

Regards
Osier

</body></email><email><emailId>20110114103938</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-01-14 10:39:38-0400</timestampReceived><subject>Re: [libvirt-users] host to VM serial device configuration</subject><body>

On Fri, Jan 14, 2011 at 11:50:01AM +0800, Osier Yang wrote:
&gt; 于 2011年01月12日 23:11, John Paul Walters 写道:
&gt; &gt;Hi,
&gt; &gt;
&gt; &gt;I'm trying to get a virtual serial device up and running between my host
&gt; &gt;and virtual machine with a device name on the host. I'm using libvirt
&gt; &gt;0.8.3 and qemu 0.13.0. The challenge that I'm running into is that I'm
&gt; &gt;able to get a serial device, but I cannot fix it to a pre-defined device
&gt; &gt;name. For example, I'm using the following in my VM's xml file:
&gt; &gt;
&gt; &gt;&lt;serial type='pty'&gt;
&gt; &gt;&lt;source path='/dev/pts/19' /&gt;
&gt; &gt;&lt;target port='0' /&gt;
&gt; &gt;&lt;/serial&gt;
&gt; &gt;
&gt; &gt;As I said this works, but it doesn't set the host side to /dev/pts/19.
&gt; &gt;Is there any way to do this?
&gt; 
&gt; I could reproduce it, trying to find out why.

When using type='type', the source path is an output only
attribute. You can't control it yourself, it is autoassigned
by the kernel as it sees fit.

Regards,
Daniel

</body></email><email><emailId>20110114140907</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-14 14:09:07-0400</timestampReceived><subject>Re: [libvirt-users] host to VM serial device configuration</subject><body>

On 14/01/2011, at 9:39 PM, Daniel P. Berrange wrote:
&gt; On Fri, Jan 14, 2011 at 11:50:01AM +0800, Osier Yang wrote:
&gt;&gt; 于 2011年01月12日 23:11, John Paul Walters 写道:
&gt;&gt;&gt; Hi,
&gt;&gt;&gt; 
&gt;&gt;&gt; I'm trying to get a virtual serial device up and running between my host
&gt;&gt;&gt; and virtual machine with a device name on the host. I'm using libvirt
&gt;&gt;&gt; 0.8.3 and qemu 0.13.0. The challenge that I'm running into is that I'm
&gt;&gt;&gt; able to get a serial device, but I cannot fix it to a pre-defined device
&gt;&gt;&gt; name. For example, I'm using the following in my VM's xml file:
&gt;&gt;&gt; 
&gt;&gt;&gt; &lt;serial type='pty'&gt;
&gt;&gt;&gt; &lt;source path='/dev/pts/19' /&gt;
&gt;&gt;&gt; &lt;target port='0' /&gt;
&gt;&gt;&gt; &lt;/serial&gt;
&gt;&gt;&gt; 
&gt;&gt;&gt; As I said this works, but it doesn't set the host side to /dev/pts/19.
&gt;&gt;&gt; Is there any way to do this?
&gt;&gt; 
&gt;&gt; I could reproduce it, trying to find out why.
&gt; 
&gt; When using type='type', the source path is an output only
&gt; attribute. You can't control it yourself, it is autoassigned
&gt; by the kernel as it sees fit.

Any idea if it's the kind of thing whose name could be selected or changed
using udev rules?

</body></email><email><emailId>20110114144444</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-01-14 14:44:44-0400</timestampReceived><subject>Re: [libvirt-users] host to VM serial device configuration</subject><body>

On Sat, Jan 15, 2011 at 01:09:07AM +1100, Justin Clift wrote:
&gt; On 14/01/2011, at 9:39 PM, Daniel P. Berrange wrote:
&gt; &gt; On Fri, Jan 14, 2011 at 11:50:01AM +0800, Osier Yang wrote:
&gt; &gt;&gt; 于 2011年01月12日 23:11, John Paul Walters 写道:
&gt; &gt;&gt;&gt; Hi,
&gt; &gt;&gt;&gt; 
&gt; &gt;&gt;&gt; I'm trying to get a virtual serial device up and running between my host
&gt; &gt;&gt;&gt; and virtual machine with a device name on the host. I'm using libvirt
&gt; &gt;&gt;&gt; 0.8.3 and qemu 0.13.0. The challenge that I'm running into is that I'm
&gt; &gt;&gt;&gt; able to get a serial device, but I cannot fix it to a pre-defined device
&gt; &gt;&gt;&gt; name. For example, I'm using the following in my VM's xml file:
&gt; &gt;&gt;&gt; 
&gt; &gt;&gt;&gt; &lt;serial type='pty'&gt;
&gt; &gt;&gt;&gt; &lt;source path='/dev/pts/19' /&gt;
&gt; &gt;&gt;&gt; &lt;target port='0' /&gt;
&gt; &gt;&gt;&gt; &lt;/serial&gt;
&gt; &gt;&gt;&gt; 
&gt; &gt;&gt;&gt; As I said this works, but it doesn't set the host side to /dev/pts/19.
&gt; &gt;&gt;&gt; Is there any way to do this?
&gt; &gt;&gt; 
&gt; &gt;&gt; I could reproduce it, trying to find out why.
&gt; &gt; 
&gt; &gt; When using type='type', the source path is an output only
&gt; &gt; attribute. You can't control it yourself, it is autoassigned
&gt; &gt; by the kernel as it sees fit.
&gt; 
&gt; Any idea if it's the kind of thing whose name could be selected or changed
&gt; using udev rules?

No, these aren't normal devices. This is a magic filesystem
which creates entries on the fly.

Daniel

</body></email><email><emailId>20110114193531</emailId><senderName>John Paul Walters</senderName><senderEmail>jwalters@isi.edu</senderEmail><timestampReceived>2011-01-14 19:35:31-0400</timestampReceived><subject>Re: [libvirt-users] host to VM serial device configuration</subject><body>


On Jan 14, 2011, at 9:44 AM, Daniel P. Berrange wrote:

&gt; On Sat, Jan 15, 2011 at 01:09:07AM +1100, Justin Clift wrote:
&gt;&gt; On 14/01/2011, at 9:39 PM, Daniel P. Berrange wrote:
&gt;&gt;&gt; On Fri, Jan 14, 2011 at 11:50:01AM +0800, Osier Yang wrote:
&gt;&gt;&gt;&gt; 于 2011年01月12日 23:11, John Paul Walters 写道:
&gt;&gt;&gt;&gt;&gt; Hi,
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; I'm trying to get a virtual serial device up and running between  
&gt;&gt;&gt;&gt;&gt; my host
&gt;&gt;&gt;&gt;&gt; and virtual machine with a device name on the host. I'm using  
&gt;&gt;&gt;&gt;&gt; libvirt
&gt;&gt;&gt;&gt;&gt; 0.8.3 and qemu 0.13.0. The challenge that I'm running into is  
&gt;&gt;&gt;&gt;&gt; that I'm
&gt;&gt;&gt;&gt;&gt; able to get a serial device, but I cannot fix it to a pre- 
&gt;&gt;&gt;&gt;&gt; defined device
&gt;&gt;&gt;&gt;&gt; name. For example, I'm using the following in my VM's xml file:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; &lt;serial type='pty'&gt;
&gt;&gt;&gt;&gt;&gt; &lt;source path='/dev/pts/19' /&gt;
&gt;&gt;&gt;&gt;&gt; &lt;target port='0' /&gt;
&gt;&gt;&gt;&gt;&gt; &lt;/serial&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; As I said this works, but it doesn't set the host side to /dev/ 
&gt;&gt;&gt;&gt;&gt; pts/19.
&gt;&gt;&gt;&gt;&gt; Is there any way to do this?
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; I could reproduce it, trying to find out why.
&gt;&gt;&gt;
&gt;&gt;&gt; When using type='type', the source path is an output only
&gt;&gt;&gt; attribute. You can't control it yourself, it is autoassigned
&gt;&gt;&gt; by the kernel as it sees fit.
&gt;&gt;
&gt;&gt; Any idea if it's the kind of thing whose name could be selected or  
&gt;&gt; changed
&gt;&gt; using udev rules?
&gt;
&gt; No, these aren't normal devices. This is a magic filesystem
&gt; which creates entries on the fly.

Thanks for the replies.  I'm not necessarily stuck on type='pty'.  I  
just need to be able to pin the device name or a pipe name to  
something known on the host side.  Along those lines, I've tried using  
type='pipe' like so:

&lt;serial type='pipe'&gt;
	&lt;source path='/tmp/mypipe' /&gt;
	&lt;target port='1' /&gt;
&lt;/serial&gt;

I've created the /tmp/mypipe.in and /tmp/mypipe.out using mkfifo per  
the qemu directions.  But I'm not sure what this is supposed to look  
like on the VM-side.  I notice that I have a ttyS1 in the VM, which I  
believe is connected to the pipe on the host side, but do I use this  
as a serial device or as a named pipe?

regards,
JP


</body></email><email><emailId>20110118101326</emailId><senderName>Igor Serebryany</senderName><senderEmail>igor47@moomers.org</senderEmail><timestampReceived>2011-01-18 10:13:26-0400</timestampReceived><subject>Re: [libvirt-users] host to VM serial device configuration</subject><body>


Hey John, 

	If I understand correctly, you are trying to get access to the
	character device after you've created the domain. The exact device
	is auto-assigned when the VM is created, but you can get the correct
	device from the domain XML after the domain is running.
	
	I use 'type=pty' in my domain definition XML. I then extract the
	device that was assigned to the domain using the following bit of
	python:

	import xml.etree.cElementTree as etree
	xml = etree.fromstring(myDomainObject.XMLDesc(0))
	tty = xml.find('devices').find('console').attrib['tty']

	Hope this helps!

--Igor




On Fri, Jan 14, 2011 at 02:35:31PM -0500, John Paul Walters wrote:
&gt; 
&gt; On Jan 14, 2011, at 9:44 AM, Daniel P. Berrange wrote:
&gt; 
&gt; &gt;On Sat, Jan 15, 2011 at 01:09:07AM +1100, Justin Clift wrote:
&gt; &gt;&gt;On 14/01/2011, at 9:39 PM, Daniel P. Berrange wrote:
&gt; &gt;&gt;&gt;On Fri, Jan 14, 2011 at 11:50:01AM +0800, Osier Yang wrote:
&gt; &gt;&gt;&gt;&gt;于 2011年01月12日 23:11, John Paul Walters 写道:
&gt; &gt;&gt;&gt;&gt;&gt;Hi,
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;I'm trying to get a virtual serial device up and running
&gt; &gt;&gt;&gt;&gt;&gt;between my host
&gt; &gt;&gt;&gt;&gt;&gt;and virtual machine with a device name on the host. I'm
&gt; &gt;&gt;&gt;&gt;&gt;using libvirt
&gt; &gt;&gt;&gt;&gt;&gt;0.8.3 and qemu 0.13.0. The challenge that I'm running into
&gt; &gt;&gt;&gt;&gt;&gt;is that I'm
&gt; &gt;&gt;&gt;&gt;&gt;able to get a serial device, but I cannot fix it to a pre-
&gt; &gt;&gt;&gt;&gt;&gt;defined device
&gt; &gt;&gt;&gt;&gt;&gt;name. For example, I'm using the following in my VM's xml file:
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&lt;serial type='pty'&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&lt;source path='/dev/pts/19' /&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&lt;target port='0' /&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&lt;/serial&gt;
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;As I said this works, but it doesn't set the host side to
&gt; &gt;&gt;&gt;&gt;&gt;/dev/pts/19.
&gt; &gt;&gt;&gt;&gt;&gt;Is there any way to do this?
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;I could reproduce it, trying to find out why.
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;When using type='type', the source path is an output only
&gt; &gt;&gt;&gt;attribute. You can't control it yourself, it is autoassigned
&gt; &gt;&gt;&gt;by the kernel as it sees fit.
&gt; &gt;&gt;
&gt; &gt;&gt;Any idea if it's the kind of thing whose name could be selected
&gt; &gt;&gt;or changed
&gt; &gt;&gt;using udev rules?
&gt; &gt;
&gt; &gt;No, these aren't normal devices. This is a magic filesystem
&gt; &gt;which creates entries on the fly.
&gt; 
&gt; Thanks for the replies.  I'm not necessarily stuck on type='pty'.  I
&gt; just need to be able to pin the device name or a pipe name to
&gt; something known on the host side.  Along those lines, I've tried
&gt; using type='pipe' like so:
&gt; 
&gt; &lt;serial type='pipe'&gt;
&gt; 	&lt;source path='/tmp/mypipe' /&gt;
&gt; 	&lt;target port='1' /&gt;
&gt; &lt;/serial&gt;
&gt; 
&gt; I've created the /tmp/mypipe.in and /tmp/mypipe.out using mkfifo per
&gt; the qemu directions.  But I'm not sure what this is supposed to look
&gt; like on the VM-side.  I notice that I have a ttyS1 in the VM, which
&gt; I believe is connected to the pipe on the host side, but do I use
&gt; this as a serial device or as a named pipe?
&gt; 
&gt; regards,
&gt; JP
&gt; 
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20110118055753</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-18 05:57:53-0400</timestampReceived><subject>Re: [libvirt-users] list mac or IP of all guests NICs?</subject><body>

On 18/01/2011, at 7:45 AM, Josiah Ritchie wrote:
&gt; I'm trying to figure out how to use virsh (or something else) to list all the IP \
&gt; addresses (or MAC addresses if needed) for each virtual NIC, preferably with it \
&gt; domain affiliation also listed. 
&gt; Is this possible?

Hi Josiah,

It should be pretty straight forward to get the MAC addresses of things.

The (scripting) approach that's coming to mind, is to first use virsh to get a list \
of all the domains (using "virsh list --all") or similiar.

Then, for each of the domains, run the virsh "dumpxml" command, which includes the \
MAC address on one of the network device lines.

Getting the IP addresses associated with each MAC isn't always quite as easy.  It \
depends on how IP addresses are given to the guests.  For example they could be given \
out via a DHCP server controlled by libvirt.  Or they could be given out via a DHCP \
on a real physical network.  (both quite possible)  Alternatively, they could be hard \
coded statically inside each guest (so libvirt doesn't know what it is), or any \
combination of the above

I'm pretty sure there are scripts around, that will help automate the collection of \
IP addresses for some of these.  From memory Richard Jones (on this mailing list \
already) has a blog entry or two on this subject.  He'll probably post a link if my \
memory isn't being dodgy. :)

Does any of that help?

Regards and best wishes,

Justin Clift


</body></email><email><emailId>20110118090117</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-01-18 09:01:17-0400</timestampReceived><subject>Re: [libvirt-users] list mac or IP of all guests NICs?</subject><body>

于 2011年01月18日 04:45, Josiah Ritchie 写道:
&gt; I'm trying to figure out how to use virsh (or something else) to list
&gt; all the IP addresses (or MAC addresses if needed) for each virtual NIC,
&gt; preferably with it domain affiliation also listed.
&gt;
&gt; Is this possible?
&gt;

== method 1: (simple but not reliable)
# cat /var/lib/dnsmasq/dnsmasq.leases
1295343272 52:54:00:6f:2e:72 192.168.122.118 * *

== method 2:
# This script is to map MAC into IP, accepts two
# arguments, subnet prefix and MAC address of the
# interface.
#! /bin/bash

if [ $# -ne 2 ]; then
     echo "Usage: $(basename $0) &lt;SUBNET&gt; &lt;MAC&gt;"
     exit 1
fi

SUBNET=$1
MAC=$2

rpm -q nmap &gt; /dev/NULL
if [ $? -ne 0 ]; then
     echo "You need install nmap"
     exit 1
fi

if [[ -n $SUBNET ]]; then
    OUTPUT=$(nmap -sP -n $SUBNET | grep -i -B 2 $MAC)
    if [[ -n $OUTPUT ]]; then
       IP=$(echo $OUTPUT | sed -e 's/.* 
\([0-9]*\.[0-9]*\.[0-9]*\.[0-9]*\).*/\1/')
    fi
fi

echo $IP

e.g. for a guest which use libvirt "default" network, get the subnet
like:
# ip route | grep "virbr0" | sed -n 1p | awk '{print $1}'

you could write automate script to parse the MAC address of domain
interfaces, the bridge name, and the subnet prefix of bridge, and
then use the script above the get the IP.

And as Justin said, Rich has more clever tool to do it, I also forgot,
you can wait him, :-)

Regards
Osier

&gt; JSR/
&gt;
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110118060107</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-18 06:01:07-0400</timestampReceived><subject>Re: [libvirt-users] Open virt-viewer with virsh start</subject><body>

On 18/01/2011, at 1:42 PM, Scott Lerman wrote:
&gt; Is it possible to have virt-viewer come up when a domain is started
&gt; with virsh start, the same way that it does with virt-install?

I don't think so.  But, if you're reasonably familiar with shell scripting, you can \
could a simple script that does the "virsh start", then kicks off virt-viewer for it.

Not exactly the same level of automatic-and-ready-to-go.  But quite doable.

That helpful at all?

Regards and best wishes,

Justin Clift


</body></email><email><emailId>20110113181258</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-13 18:12:58-0400</timestampReceived><subject>Re: [libvirt-users] ERROR Unable to deny all devices for (solution)</subject><body>

On 14/01/2011, at 4:54 AM, Lucas Arbiza wrote:
&gt; No long time ago I made some changes to optimize kernel performance for
&gt; desktop as described here (it's in Portuguese, but can be undertood reading
&gt; the commands and files) and this changes caused the above errors (in Ubuntu
&gt; 10.10 and Fedora 14).

URL? :)

</body></email><email><emailId>20110113181940</emailId><senderName>Lucas Arbiza</senderName><senderEmail>lucas.arbiza@gmail.com</senderEmail><timestampReceived>2011-01-13 18:19:40-0400</timestampReceived><subject>Re: [libvirt-users] ERROR Unable to deny all devices for (solution)</subject><body>

Here is the URL:
http://blog.coderepository.net/2010/11/19/otimizando-o-kernel-de-seu-desktop-linux/


Sorry

Thanks, Juntin

[Attachment #3 (text/html)]

&lt;font color="#000000"&gt;&lt;font face="verdana,sans-serif"&gt;Here is the URL: &lt;meta \
http-equiv="content-type" content="text/html; charset=utf-8"&gt;&lt;a \
href="http://blog.coderepository.net/2010/11/19/otimizando-o-kernel-de-seu-desktop-lin \
ux/"&gt;http://blog.coderepository.net/2010/11/19/otimizando-o-kernel-de-seu-desktop-linux/&lt;/a&gt;&lt;br \
clear="all"&gt;

&lt;/font&gt;&lt;/font&gt;&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Sorry&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks, \
Juntin&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20110110054924</emailId><senderName>Xiaoguang Liu</senderName><senderEmail>syslxg@gmail.com</senderEmail><timestampReceived>2011-01-10 05:49:24-0400</timestampReceived><subject>Re: [libvirt-users] Windows guest eats as many CPU as available</subject><body>

When my Windows 2003 guest  is idling (0% vcpu usage), host  os is
idling too ( up to 3% cpu).
Did you check the guest os and find out the process which is eating
your cpu time?



On Mon, Jan 10, 2011 at 2:05 AM, Matthias Meyer &lt;Matthias.Meyer@gmx.li&gt; wrote:
&gt; Hello,
&gt;
&gt; I run Debian on my Laptop Lenovo X60s (with VT).
&gt; I've created a Windows-XP as well as a Windows-Vista guest on it.
&gt; Both, XP as well as Vista, eats as many CPU as available.
&gt; Therefore the CPU always has high load and will never reduce cpu-frequenz or
&gt; ventilator.
&gt;
&gt; Did this works as designed or should I modify something?
&gt;
&gt; Thanks in advance
&gt; Matthias
&gt; --
&gt; Don't Panic
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

</body></email><email><emailId>20110110222517</emailId><senderName>Matthias Meyer</senderName><senderEmail>matthias.meyer@gmx.li</senderEmail><timestampReceived>2011-01-10 22:25:17-0400</timestampReceived><subject>Re: [libvirt-users] Windows guest eats as many CPU as available</subject><body>

Am Montag 10 Januar 2011 schrieben Sie:
&gt; On Mon, January 10, 2011 07:05, Matthias Meyer wrote:
&gt; &gt; Hello,
&gt; &gt; 
&gt; &gt; I run Debian on my Laptop Lenovo X60s (with VT).
&gt; &gt; I've created a Windows-XP as well as a Windows-Vista guest on it.
&gt; &gt; Both, XP as well as Vista, eats as many CPU as available.
&gt; &gt; Therefore the CPU always has high load and will never reduce 
cpu-frequenz
&gt; &gt; or ventilator.
&gt; 
&gt; Can you check if there is a particular process inside Windows that is
&gt; using all of the CPU via the Task Manager?
&gt; 
&gt; Steve
&gt; 
&gt; 

No, there is only the idle-process ("Leerlaufprozess" in german) which need 
96% of the CPU in an average.
In the same time KVM needs nearly 100% of my Host-CPU.

13895 ?        Sl    21:21 /usr/bin/kvm -S -M pc -m 256 -smp 1 -name 
devel-xp -monitor pty -localtime -no-acpi -boot c -drive 
file=/var/lib/libvirt/images/devel-xp.qcow2,if=ide,index=0,boot=on -drive 
file=/mnt/MultiMedia/CD-Server/Betriebssysteme/Windows/WindowsNT/WindowsXPpro_sp2_de.iso,if=ide,media=cdrom,index=2 \
-net  nic,macaddr=54:52:00:61:dd:94,vlan=0 -net 
tap,fd=14,script=,vlan=0,ifname=vnet0 -serial pty -parallel 
none -usb -usbdevice tablet -vnc 127.0.0.1:0 -k de -soundhw es1370

br
Matthias
-- 
Don't Panic


</body></email><email><emailId>20110110225622</emailId><senderName>Mike Ponomarenko</senderName><senderEmail>mponomarenko@gmail.com</senderEmail><timestampReceived>2011-01-10 22:56:22-0400</timestampReceived><subject>Re: [libvirt-users] Windows guest eats as many CPU as available</subject><body>

For me it eats 10-20%, and I was not able to lower that (linux uses 0%).
And if I am not mistaken, it eats 100% when you have chosen wrong ACPI
parameters in domain.xml.
Take a look at https://bugs.launchpad.net/ubuntu/+source/virt-manager/+bug/228442

On Tue, Jan 11, 2011 at 00:25, Matthias Meyer &lt;Matthias.Meyer@gmx.li&gt; wrote:
&gt; Am Montag 10 Januar 2011 schrieben Sie:
&gt; &gt; On Mon, January 10, 2011 07:05, Matthias Meyer wrote:
&gt; &gt; &gt; Hello,
&gt; &gt; &gt; 
&gt; &gt; &gt; I run Debian on my Laptop Lenovo X60s (with VT).
&gt; &gt; &gt; I've created a Windows-XP as well as a Windows-Vista guest on it.
&gt; &gt; &gt; Both, XP as well as Vista, eats as many CPU as available.
&gt; &gt; &gt; Therefore the CPU always has high load and will never reduce
&gt; cpu-frequenz
&gt; &gt; &gt; or ventilator.
&gt; &gt; 
&gt; &gt; Can you check if there is a particular process inside Windows that is
&gt; &gt; using all of the CPU via the Task Manager?
&gt; &gt; 
&gt; &gt; Steve
&gt; &gt; 
&gt; &gt; 
&gt; 
&gt; No, there is only the idle-process ("Leerlaufprozess" in german) which need
&gt; 96% of the CPU in an average.
&gt; In the same time KVM needs nearly 100% of my Host-CPU.
&gt; 
&gt; 13895 ?        Sl    21:21 /usr/bin/kvm -S -M pc -m 256 -smp 1 -name
&gt; devel-xp -monitor pty -localtime -no-acpi -boot c -drive
&gt; file=/var/lib/libvirt/images/devel-xp.qcow2,if=ide,index=0,boot=on -drive
&gt; file=/mnt/MultiMedia/CD-Server/Betriebssysteme/Windows/WindowsNT/WindowsXPpro_sp2_de.iso,if=ide,media=cdrom,index=2 \
&gt; -net nic,macaddr=54:52:00:61:dd:94,vlan=0 -net
&gt; tap,fd=14,script=,vlan=0,ifname=vnet0 -serial pty -parallel
&gt; none -usb -usbdevice tablet -vnc 127.0.0.1:0 -k de -soundhw es1370
&gt; 
&gt; br
&gt; Matthias
&gt; --
&gt; Don't Panic
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; 


</body></email><email><emailId>20110111175233</emailId><senderName>jeremy avnet</senderName><senderEmail>brainsik+libvirt@saucelabs.com</senderEmail><timestampReceived>2011-01-11 17:52:33-0400</timestampReceived><subject>Re: [libvirt-users] Windows guest eats as many CPU as available</subject><body>

IIRC, this was a problem with older versions of QEmu that was fixed later.
Are you on a recent version? You should be able to run a single VCPU,
Windows XP instance *without* ACPI and have low CPU usage. I've done it.

Note, this problem still exists for multi-VCPU XP instances.
.:. jeremy

On Mon, Jan 10, 2011 at 2:25 PM, Matthias Meyer &lt;Matthias.Meyer@gmx.li&gt;wrote:

&gt; Am Montag 10 Januar 2011 schrieben Sie:
&gt; &gt; On Mon, January 10, 2011 07:05, Matthias Meyer wrote:
&gt; &gt; &gt; Hello,
&gt; &gt; &gt; 
&gt; &gt; &gt; I run Debian on my Laptop Lenovo X60s (with VT).
&gt; &gt; &gt; I've created a Windows-XP as well as a Windows-Vista guest on it.
&gt; &gt; &gt; Both, XP as well as Vista, eats as many CPU as available.
&gt; &gt; &gt; Therefore the CPU always has high load and will never reduce
&gt; cpu-frequenz
&gt; &gt; &gt; or ventilator.
&gt; &gt; 
&gt; &gt; Can you check if there is a particular process inside Windows that is
&gt; &gt; using all of the CPU via the Task Manager?
&gt; &gt; 
&gt; &gt; Steve
&gt; &gt; 
&gt; &gt; 
&gt; 
&gt; No, there is only the idle-process ("Leerlaufprozess" in german) which need
&gt; 96% of the CPU in an average.
&gt; In the same time KVM needs nearly 100% of my Host-CPU.
&gt; 
&gt; 13895 ?        Sl    21:21 /usr/bin/kvm -S -M pc -m 256 -smp 1 -name
&gt; devel-xp -monitor pty -localtime -no-acpi -boot c -drive
&gt; file=/var/lib/libvirt/images/devel-xp.qcow2,if=ide,index=0,boot=on -drive
&gt; file=/mnt/MultiMedia/CD-Server/Betriebssysteme/Windows/WindowsNT/WindowsXPpro_sp2_de.iso,if=ide,media=cdrom,index=2
&gt;                 
&gt; -net
&gt; nic,macaddr=54:52:00:61:dd:94,vlan=0 -net
&gt; tap,fd=14,script=,vlan=0,ifname=vnet0 -serial pty -parallel
&gt; none -usb -usbdevice tablet -vnc 127.0.0.1:0 -k de -soundhw es1370
&gt; 
&gt; br
&gt; Matthias
&gt; --
&gt; Don't Panic
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; 


[Attachment #3 (text/html)]

&lt;font face="verdana,sans-serif"&gt;IIRC, this was a problem with older versions of QEmu \
that was fixed later. Are you on a recent version? You should be able to run a single \
VCPU, Windows XP instance *without* ACPI and have low CPU usage. I've done \
it.&lt;/font&gt;&lt;div&gt; &lt;font face="verdana,sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
face="verdana,sans-serif"&gt;Note, this problem still exists for multi-VCPU XP \
instances.&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face="verdana,sans-serif"&gt;.:. jeremy&lt;br&gt;&lt;/font&gt;&lt;br&gt; \
&lt;div class="gmail_quote"&gt;On Mon, Jan 10, 2011 at 2:25 PM, Matthias Meyer &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:Matthias.Meyer@gmx.li"&gt;Matthias.Meyer@gmx.li&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt; Am Montag 10 Januar 2011 schrieben Sie:&lt;br&gt;
&lt;div class="im"&gt;&gt; On Mon, January 10, 2011 07:05, Matthias Meyer wrote:&lt;br&gt;
&gt; &gt; Hello,&lt;br&gt;
&gt; &gt;&lt;br&gt;
&gt; &gt; I run Debian on my Laptop Lenovo X60s (with VT).&lt;br&gt;
&gt; &gt; I've created a Windows-XP as well as a Windows-Vista guest on it.&lt;br&gt;
&gt; &gt; Both, XP as well as Vista, eats as many CPU as available.&lt;br&gt;
&gt; &gt; Therefore the CPU always has high load and will never reduce&lt;br&gt;
cpu-frequenz&lt;br&gt;
&gt; &gt; or ventilator.&lt;br&gt;
&gt;&lt;br&gt;
&lt;/div&gt;&gt; Can you check if there is a particular process inside Windows that is&lt;br&gt;
&gt; using all of the CPU via the Task Manager?&lt;br&gt;
&gt;&lt;br&gt;
&gt; Steve&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&lt;br&gt;
No, there is only the idle-process ("Leerlaufprozess" in german) which \
need&lt;br&gt; 96% of the CPU in an average.&lt;br&gt;
In the same time KVM needs nearly 100% of my Host-CPU.&lt;br&gt;
&lt;br&gt;
13895 ?            Sl      21:21 /usr/bin/kvm -S -M pc -m 256 -smp 1 -name&lt;br&gt;
devel-xp -monitor pty -localtime -no-acpi -boot c -drive&lt;br&gt;
file=/var/lib/libvirt/images/devel-xp.qcow2,if=ide,index=0,boot=on -drive&lt;br&gt;
file=/mnt/MultiMedia/CD-Server/Betriebssysteme/Windows/WindowsNT/WindowsXPpro_sp2_de.iso,if=ide,media=cdrom,index=2 \
-net&lt;br&gt; nic,macaddr=54:52:00:61:dd:94,vlan=0 -net&lt;br&gt;
tap,fd=14,script=,vlan=0,ifname=vnet0 -serial pty -parallel&lt;br&gt;
none -usb -usbdevice tablet -vnc &lt;a href="http://127.0.0.1:0" \
target="_blank"&gt;127.0.0.1:0&lt;/a&gt; -k de -soundhw es1370&lt;br&gt; &lt;br&gt;
br&lt;br&gt;
&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;Matthias&lt;br&gt;
--&lt;br&gt;
Don't Panic&lt;br&gt;
&lt;br&gt;
_______________________________________________&lt;br&gt;
libvirt-users mailing list&lt;br&gt;
&lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
&lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; \
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20110105132031</emailId><senderName></senderName><senderEmail>saint</senderEmail><timestampReceived>2011-01-05 13:20:31-0400</timestampReceived><subject>Re: [libvirt-users] livemigrate problems</subject><body>

&gt;&gt;&gt;&gt;&gt; "CC" == saint  &lt;saint@eng.it&gt; writes:

&gt;&gt;&gt;&gt;&gt; "CC" == saint  &lt;saint@eng.it&gt; writes:
CC&gt; I can livemigrate w/o problems between any two from red9, red10
CC&gt; and red11, I can livemigrate from either red9, red10 or red11 to
CC&gt; red3 but I can't livemigrate to any other blade from red3.

I TCP-dumped the  dialog from both a succesful and  a failed migration
(as I said,  I have a couple of problematic  hosts and other perfectly
working ones).

When the  migration succeeds, I have  data transmitted to TLS  port on
the target  machine and  to one  of the  ports that  must be  open for
migration with this pattern:

first data are sent  to the TLS port, then to the  other port (and the
communication ends  with a reset), then  other data ended by  a FIN to
the TLS port on the target machine. The reply to the FIN is a RESET.

I checked, it is not a problem  with the certificates: I had a machine
raising  such  problems  because  had  the clock  set  to  before  the
beginning of the vvalidity of the client certificate.

I checked libvirtd configuration, and got nothing strange.

The machine that fails to migrate can contact the intended target:

virsh -c qemu://remotehost/system list --all 

works perfectly.

I think I am going to fill a bug report...

--
ing. Gian Uberto Lauri
Ricercatore / Reasearcher
Divisione Ricerca ed Innovazione / Research &amp; Innovation Division
GianUberto.Lauri@eng.it

Engineering Ingegneria Informatica spa
Corso Stati Uniti 23/C, 35127 Padova (PD) 

Tel. +39-049.8283.538         | main(){printf(&amp;unix["\021%six\012\0"], 
Fax  +39-049.8283.569		  |    (unix)["have"]+"fun"-0x60);}   
Skype: gian.uberto.lauri	  |          David Korn, AT&amp;T Bell Labs             
http://www.eng.it 			  |          ioccc best One Liner, 1987             

</body></email><email><emailId>20110111144844</emailId><senderName>Nicolas Sebrecht</senderName><senderEmail>nsebrecht@piing.fr</senderEmail><timestampReceived>2011-01-11 14:48:44-0400</timestampReceived><subject>[libvirt-users] Re: Timed out during operation: cannot acquire state change lock</subject><body>

The 11/01/11, Robert Å mol wrote:
&gt; Hi, 
&gt; 
&gt; I am looking for help to troubleshoot: 
&gt; 
&gt; node002 ~ # virsh
&gt; virsh # list
&gt;  Id Name State
&gt; ----------------------------------
&gt;  1 dom001 paused
&gt; 
&gt; virsh # resume dom001
&gt; error: Failed to resume domain dom001
&gt; error: Timed out during operation: cannot acquire state change lock

You may have hit a bug corrected by this patch
http://comments.gmane.org/gmane.comp.emulators.libvirt/28718?set_cite=hide

I would check your libvirt version has this bugfix and upgrade if
needed.  I don't remember the version having this fix, sorry.

-- 
Nicolas Sebrecht

</body></email><email><emailId>20110111145113</emailId><senderName>Nicolas Sebrecht</senderName><senderEmail>nsebrecht@piing.fr</senderEmail><timestampReceived>2011-01-11 14:51:13-0400</timestampReceived><subject>[libvirt-users] Re: Timed out during operation: cannot acquire state change lock</subject><body>

The 11/01/11, Nicolas Sebrecht wrote:
&gt; The 11/01/11, Robert Å mol wrote:
&gt; &gt; Hi, 
&gt; &gt; 
&gt; &gt; I am looking for help to troubleshoot: 
&gt; &gt; 
&gt; &gt; node002 ~ # virsh
&gt; &gt; virsh # list
&gt; &gt;  Id Name State
&gt; &gt; ----------------------------------
&gt; &gt;  1 dom001 paused
&gt; &gt; 
&gt; &gt; virsh # resume dom001
&gt; &gt; error: Failed to resume domain dom001
&gt; &gt; error: Timed out during operation: cannot acquire state change lock
&gt; 
&gt; You may have hit a bug corrected by this patch
&gt; http://comments.gmane.org/gmane.comp.emulators.libvirt/28718?set_cite=hide
&gt; 
&gt; I would check your libvirt version has this bugfix and upgrade if
&gt; needed.  I don't remember the version having this fix, sorry.

The fix I'm talking about is included in v0.8.5.

-- 
Nicolas Sebrecht

</body></email><email><emailId>20110111150417</emailId><senderName>Robert Å mol</senderName><senderEmail>robert.smol@stereoit.com</senderEmail><timestampReceived>2011-01-11 15:04:17-0400</timestampReceived><subject>Re: [libvirt-users] Timed out during operation: cannot acquire state change lock</subject><body>

Hi,
thanks for quick reply, however it seems I am running

node002 ~ # libvirtd --version
libvirtd (libvirt) 0.8.6

This is on funtoo/gentoo but I do not see any custom patches applied. 
Shall I open a bug report, how to troubleshoot?

Robert



      &lt;https://pm011sma.intranet.fw:2381/chphead.php?chppath=Logs%3A%3ASystem%20Manage \
ment%20Homepage&amp;chppage=System%20Management%20Homepage%20Log&amp;chpurl=/errlog.php%3Flog%3Dhpsmhlog&amp;chptarget=undefined#&gt;




On 01/11/2011 03:51 PM, Nicolas Sebrecht wrote:
&gt; The 11/01/11, Nicolas Sebrecht wrote:
&gt; &gt; The 11/01/11, Robert Å mol wrote:
&gt; &gt; &gt; Hi,
&gt; &gt; &gt; 
&gt; &gt; &gt; I am looking for help to troubleshoot:
&gt; &gt; &gt; 
&gt; &gt; &gt; node002 ~ # virsh
&gt; &gt; &gt; virsh # list
&gt; &gt; &gt; Id Name State
&gt; &gt; &gt; ----------------------------------
&gt; &gt; &gt; 1 dom001 paused
&gt; &gt; &gt; 
&gt; &gt; &gt; virsh # resume dom001
&gt; &gt; &gt; error: Failed to resume domain dom001
&gt; &gt; &gt; error: Timed out during operation: cannot acquire state change lock
&gt; &gt; You may have hit a bug corrected by this patch
&gt; &gt; http://comments.gmane.org/gmane.comp.emulators.libvirt/28718?set_cite=hide
&gt; &gt; 
&gt; &gt; I would check your libvirt version has this bugfix and upgrade if
&gt; &gt; needed.  I don't remember the version having this fix, sorry.
&gt; The fix I'm talking about is included in v0.8.5.
&gt; 


</body></email><email><emailId>20110110132329</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-10 13:23:29-0400</timestampReceived><subject>Re: [libvirt-users] How to proceed after Libvirt compilation? [Problem]</subject><body>

On 10/01/2011, at 9:43 PM, Lucas Arbiza wrote:
&gt; I'm using Ubuntu 10.10.
&gt; 
&gt; At first I installed Libvirt from repositories. Due to problems I removed it and \
&gt; then I installed from sources this way: 
&gt; # ./configure --prefix=$HOME/usr
&gt; # make
&gt; # make install
&gt; # ldconfig
&gt; 
&gt; The installation gone well. I added the users to libvirtd and rebooted.
&gt; 
&gt; When I type virsh I receive from system a message saying virsh is not installed and \
&gt; instructing to install from repository. 
&gt; Someone know what should I do or where I can find it?

Hi Lucas,

It *sounds* like this might be a simple one to solve (hopefully). :)

If you take a look in the $HOME/usr/bin/ directory, is there a "virsh" command there?

If so, then it just means you're missing this directory from the PATH statement, so \
virsh isn't being found.

If it's not there, something didn't go right with the "make install" step.  Might be \
a permissions problem.

(Of the two, it sounds more like it's the first one, a PATH problem.)

Does that help?

Regards and best wishes,

Justin Clift


</body></email><email><emailId>20110111023124</emailId><senderName>Lucas Arbiza</senderName><senderEmail>lucas.arbiza@gmail.com</senderEmail><timestampReceived>2011-01-11 02:31:24-0400</timestampReceived><subject>Re: [libvirt-users] How to proceed after Libvirt compilation? [Problem]</subject><body>

Thanks, Justin, you are right.

I solved that with:

# ./configure --prefix=/usr

Even compiling from source I got the same problems I had installing from
repositories.

I'm trying with older releases.

This compiling problem was fixed, thanks.
__

*Lucas Arbiza*

[Attachment #3 (text/html)]

&lt;font color="#000000"&gt;&lt;font face="verdana,sans-serif"&gt;Thanks, Justin, you are \
right.&lt;/font&gt;&lt;/font&gt;&lt;div&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;I solved that with:&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;

&lt;div&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;# .&lt;meta http-equiv="content-type" content="text/html; \
charset=utf-8"&gt;&lt;span class="Apple-style-span" style="font-family: arial; "&gt;/configure \
--prefix=/usr&lt;/span&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;

&lt;div&gt;&lt;font color="#000000"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color="#000000"&gt;Even compiling \
from source I got the same problems I had installing from \
repositories.&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color="#000000"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
color="#000000"&gt;I'm trying with older releases.&lt;/font&gt;&lt;/div&gt;

&lt;div&gt;&lt;font color="#000000"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color="#000000"&gt;This compiling \
problem was fixed, thanks.&lt;br clear="all"&gt;&lt;/font&gt;__&lt;br&gt;&lt;br&gt;&lt;b&gt;&lt;font face="verdana, \
sans-serif"&gt;&lt;font color="#333333"&gt;Lucas Arbiza&lt;/font&gt;&lt;/font&gt;&lt;/b&gt;&lt;br&gt;

&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20110108201829</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-08 20:18:29-0400</timestampReceived><subject>Re: [libvirt-users] virt-manager can't start because of a dbus problem</subject><body>

On 09/01/2011, at 3:29 AM, Matthias Meyer wrote:
&gt; Hi,
&gt; 
&gt; Since today I can't start virt-manager anymore :-(
&gt; Failed to connect to socket /tmp/dbus-yhDz4m8loi
&gt; By the way the same message as I get from qdbus.
&gt; 
&gt; There are no files called /tmp/dbus* on my system but
&gt; some dbus applications are running:
&gt; linux-dev:~# ps ax | grep dbus
&gt; 1774 ?        Ss     0:00 /usr/bin/dbus-daemon --system
&gt; 2436 ?        S      0:00 dbus-launch --autolaunch 1996d3ce005bf1ed73cca8164d21a0b5 \
&gt; --binary-syntax --close-stderr 2437 ?        Ss     0:00 /usr/bin/dbus-daemon \
&gt; --fork --print-pid 5 --print-address 7 --session 
&gt; The error-message-box containing:
&gt; most common cause is a missing or misconfigured D-Bus
&gt; session bus daemon. See http://projects.gnome.org/gconf/
&gt; But I've removed gnome and installed KDE.

Hi Matthias,

(I'm about to get some sleep, so won't be of direct help with this.)

But, you forgot to mention which linux distro you're using.  RHEL? Fedora? Ubuntu? \
Slackware? etc. :)

Regards and best wishes,

Justin Clift


</body></email><email><emailId>20110108001524</emailId><senderName>Matthias Meyer</senderName><senderEmail>matthias.meyer@gmx.li</senderEmail><timestampReceived>2011-01-08 00:15:24-0400</timestampReceived><subject>Re: [libvirt-users] TUNGETIFF ioctl() failed - virtual machine can't start</subject><body>

Am Samstag 08 Januar 2011 schrieben Sie:
&gt; Hi,
&gt; 
&gt; I want to migrate from vmware to KVM. Therefore I have installed debian 
&gt; stable (lenny) and create two virtual machines (KVM).
&gt; Both (XP as well as Vista) running fine.
&gt; After upgrading to debian testing (sqeeze) both XP-guest as well as 
&gt; Vista-guest didn't start anymore.
&gt; Both are failing during preparation, probably because of a 
network-problem.
&gt; I will give XP as an example:
&gt; 
&gt; cat /var/log/libvirt/qemu/devel-xp.log.2
&gt; /usr/bin/kvm -S -M pc -m 256 -smp 1 -name devel-xp -monitor 
&gt; pty -localtime -no-acpi -boot c -drive 
&gt; file=/KVM-Images/devel-xp.qcow2,if=ide,index=0,boot=on -drive 
&gt; 
file=/mnt/MultiMedia/CD-Server/Betriebssysteme/Windows/WindowsNT/WindowsXPpro_sp2_de.iso,if=ide,media=cdrom,index=2 \
-net 
&gt; nic,macaddr=54:52:00:29:1a:2d,vlan=0 -net 
&gt; tap,fd=11,script=,vlan=0,ifname=vnet0 -serial pty -parallel 
&gt; none -usb -usbdevice tablet -vnc 127.0.0.1:0 -k de
&gt; char device redirected to /dev/pts/1
&gt; char device redirected to /dev/pts/2
&gt; info cpus
&gt; -&gt; the above will run fine before the upgrade
&gt; 
&gt; the following will fail after the upgrade
&gt; tail /var/log/messages:
&gt; Jan  8 00:56:33 linux-dev libvirtd: 00:56:33.461: warning : 
&gt; qemudParsePCIDeviceStrs:1422 : Unexpected exit status '1', qemu probably 
&gt; failed
&gt; Jan  8 00:56:33 linux-dev kernel: [ 1903.710664] device vnet0 entered 
&gt; promiscuous mode
&gt; Jan  8 00:56:33 linux-dev kernel: [ 1903.711011] br0: port 2(vnet0) 
entering 
&gt; learning state
&gt; Jan  8 00:56:33 linux-dev kernel: [ 1904.022502] br0: port 2(vnet0) 
entering 
&gt; disabled state
&gt; Jan  8 00:56:33 linux-dev kernel: [ 1904.024752] device vnet0 left 
&gt; promiscuous mode
&gt; Jan  8 00:56:33 linux-dev kernel: [ 1904.024752] br0: port 2(vnet0) 
entering 
&gt; disabled state
&gt; 
&gt; tail -f /var/log/libvirt/qemu/devel-xp.log
&gt; LC_ALL=C PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin 
&gt; HOME=/ QEMU_AUDIO_DRV=none /usr/bin/kvm -S -M pc-0.12 -enable-kvm -m 
&gt; 512 -smp 1,sockets=1,cores=1,threads=1 -name devel-xp -uuid 
&gt; 1b412c63-dcc0-739f-3c27-630147e6b162 -nodefaults -chardev 
&gt; 
socket,id=monitor,path=/var/lib/libvirt/qemu/devel-xp.monitor,server,nowait -mon 
&gt; chardev=monitor,mode=readline -rtc base=localtime -no-acpi -boot c -drive 
&gt; 
file=/KVM-Images/devel-xp.qcow2,if=none,id=drive-ide0-0-0,boot=on,format=raw -device 
&gt; ide-drive,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0 -drive 
&gt; 
file=/mnt/MultiMedia/CD-Server/Betriebssysteme/Windows/WindowsNT/WindowsXPpro_sp2_de.iso,if=none,media=cdrom,id=drive-ide0-1-0,readonly=on,format=raw \
-device 
&gt; ide-drive,bus=ide.1,unit=0,drive=drive-ide0-1-0,id=ide0-1-0 -device 
&gt; rtl8139,vlan=0,id=net0,mac=54:52:00:29:1a:2d,bus=pci.0,addr=0x3 -net 
&gt; tap,fd=40,vlan=0,name=hostnet0 -chardev pty,id=serial0 -device 
&gt; isa-serial,chardev=serial0 -usb -device usb-tablet,id=input0 -vnc 
&gt; 127.0.0.1:0 -k de -vga cirrus -device 
&gt; virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x4
&gt; char device redirected to /dev/pts/4
&gt; TUNGETIFF ioctl() failed: Invalid argument
&gt; exception 13 (0)
&gt; rax 0000000000000010 rbx 0000000000008c00 rcx 0000000000006eb6 rdx 
&gt; 00000000000c8c00
&gt; rsi 00000000f2010000 rdi 00000000000c0000 rsp 0000000000006eac rbp 
&gt; 00000000f2010000
&gt; r8  0000000000000000 r9  0000000000000000 r10 0000000000000000 r11 
&gt; 0000000000000000
&gt; r12 0000000000000000 r13 0000000000000000 r14 0000000000000000 r15 
&gt; 0000000000000000
&gt; rip 00000000000fde7c rflags 00033002
&gt; cs 0000 (00000000/0000ffff p 1 dpl 3 db 0 s 1 type 3 l 0 g 0 avl 0)
&gt; ds 0000 (00000000/0000ffff p 1 dpl 3 db 0 s 1 type 3 l 0 g 0 avl 0)
&gt; es 0000 (00000000/0000ffff p 1 dpl 3 db 0 s 1 type 3 l 0 g 0 avl 0)
&gt; ss 0000 (00000000/0000ffff p 1 dpl 3 db 0 s 1 type 3 l 0 g 0 avl 0)
&gt; fs 0000 (00000000/0000ffff p 1 dpl 3 db 0 s 1 type 3 l 0 g 0 avl 0)
&gt; gs 0000 (00000000/0000ffff p 1 dpl 3 db 0 s 1 type 3 l 0 g 0 avl 0)
&gt; tr 0000 (feffd000/00002088 p 1 dpl 0 db 0 s 0 type b l 0 g 0 avl 0)
&gt; ldt 0000 (00000000/0000ffff p 1 dpl 0 db 0 s 0 type 2 l 0 g 0 avl 0)
&gt; gdt f7910/37
&gt; idt f8990/0
&gt; cr0 10 cr2 0 cr3 0 cr4 0 cr8 0 efer 0
&gt; code: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 --&gt; 00 
00 
&gt; 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 
&gt; 00 00 00
&gt; 
&gt; Any hints?
&gt; Thanks
&gt; AthLux
&gt; -- 
&gt; Don't Panic
&gt; 
The above problem occurs with Linux kernel "2.6.26-2-686 #1 SMP" but not 
with "Linux kernel 2.6.32-5-686 #1 SMP".
At least a workaround for me.

br
AthLux
-- 
Don't Panic


</body></email><email><emailId>20110108042851</emailId><senderName>Dale Amon</senderName><senderEmail>amon@vnl.com</senderEmail><timestampReceived>2011-01-08 04:28:51-0400</timestampReceived><subject>[libvirt-users] The VM as a way of saving our digital heritage</subject><body>

Some of the discussion items I have seen about 
VM's failing under upgrades brings up a worrisome
point, for me at least.

I look at a VM as a 'forever machine'. A way in
which I can set up an environment with any old
OS and software and be able to boot and interact
with it now, or next year or 100 years from now.

It is the answer to 'how do we guarantee access to
our digitized cultural heritage?'

That puts a great burden on the team doing this work.
It means you have to guarantee that an archivist
in 2110 can take a VM created today and boot it up
and run it on their hyper-quantum-bio computer (the
one that you could mistake for a real penguin) under
Linux version 15.4.32... and still be able to run
a Mathematica file from 2005.

I don't know about the rest of you, but I think
this is a *very* important part of what should be
the spec for VM handling, perhaps one of *the*
most important ones.


</body></email><email><emailId>20110110105237</emailId><senderName>Nicolas Sebrecht</senderName><senderEmail>nsebrecht@piing.fr</senderEmail><timestampReceived>2011-01-10 10:52:37-0400</timestampReceived><subject>[libvirt-users] Re: virt-manager can't start because of a dbus problem</subject><body>

The 08/01/11, Matthias Meyer wrote:
&gt; Hi,
&gt; 
&gt; Since today I can't start virt-manager anymore :-(
&gt; Failed to connect to socket /tmp/dbus-yhDz4m8loi
&gt; By the way the same message as I get from qdbus.

I hit a similar problem.

It happens when I connect with ssh to different hosts with X11
redirection. I can't launch multiple virt-manager session this way on
multiple hosts. I need to completely disconnect the previous ssh session
where a virt-manager instance was launched.

Not sure it is the same issue, though.

-- 
Nicolas Sebrecht

</body></email><email><emailId>20110110222356</emailId><senderName>Matthias Meyer</senderName><senderEmail>matthias.meyer@gmx.li</senderEmail><timestampReceived>2011-01-10 22:23:56-0400</timestampReceived><subject>Re: [libvirt-users] virt-manager can t start because of a dbus problem</subject><body>

Am Montag 10 Januar 2011 schrieb Nicolas Sebrecht:
&gt; The 08/01/11, Matthias Meyer wrote:
&gt; &gt; Hi,
&gt; &gt; 
&gt; &gt; Since today I can't start virt-manager anymore :-(
&gt; &gt; Failed to connect to socket /tmp/dbus-yhDz4m8loi
&gt; &gt; By the way the same message as I get from qdbus.
&gt; 
&gt; I hit a similar problem.
&gt; 
&gt; It happens when I connect with ssh to different hosts with X11
&gt; redirection. I can't launch multiple virt-manager session this way on
&gt; multiple hosts. I need to completely disconnect the previous ssh session
&gt; where a virt-manager instance was launched.
&gt; 
&gt; Not sure it is the same issue, though.
&gt; 
&gt; -- 
&gt; Nicolas Sebrecht
&gt; 
&gt; 

I don't believe that is the same problem.
My problem occurs just after reboot too.
In the meantime I've reinstalled my laptop with debian stable.

br
Matthias
-- 
Don't Panic

</body></email><email><emailId>20110111122937</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-11 12:29:37-0400</timestampReceived><subject>Re: [libvirt-users] How to proceed after Libvirt compilation? [Problem]</subject><body>

On 11/01/2011, at 1:31 PM, Lucas Arbiza wrote:
Thanks, Justin, you are right.
&gt; 
&gt; I solved that with:
&gt; 
&gt; # ./configure --prefix=/usr
&gt; 
&gt; Even compiling from source I got the same problems I had installing from \
&gt; repositories. 
&gt; I'm trying with older releases.
&gt; 
&gt; This compiling problem was fixed, thanks.

No worries.  If you're compiling on a RHEL or Fedora based system, you can do "make \
rpm".

It creates a set of libvirt rpm, which you can then install to replace or upgrade the \
ones already on the system.

Hope that's useful. :)

Regards and best wishes,

Justin Clift


</body></email><email><emailId>20110111152646</emailId><senderName>Nicolas Sebrecht</senderName><senderEmail>nsebrecht@piing.fr</senderEmail><timestampReceived>2011-01-11 15:26:46-0400</timestampReceived><subject>[libvirt-users] Re: Timed out during operation: cannot acquire state change lock</subject><body>

The 11/01/11, Robert Å mol wrote:
&gt; Hi,
&gt; thanks for quick reply, however it seems I am running
&gt; 
&gt; node002 ~ # libvirtd --version
&gt; libvirtd (libvirt) 0.8.6
&gt; 
&gt; This is on funtoo/gentoo but I do not see any custom patches
&gt; applied. Shall I open a bug report, how to troubleshoot?

You might rather start a thread upstream at the developper mailing list
(libvirt-list).


-- 
Nicolas Sebrecht

</body></email><email><emailId>20110111203017</emailId><senderName>Frederic SOULIER</senderName><senderEmail>frederic.soulier@univ-tlse1.fr</senderEmail><timestampReceived>2011-01-11 20:30:17-0400</timestampReceived><subject>[libvirt-users] libvirt and shared storage SAN Fiber Channel</subject><body>

Hi,

I'm looking information about using libvirt with san (fiber channel) 
based storage and googling for a while i don't see anything about it.
I send this email in order to get advices about libvirt and shared storage

We use here, for 3 years now, 8 linux centos server connected to an 
hitachi FC SAN (multipath devices).
Each server run Xen dom0 and use SAN LUNs to store Virtual machine 
filesystem ( basically one LUN per VM).
For each LUN we create an LVM VolGroup. On each VolGroup we create 
Logical volumes (one for swap, one for root filesystem).
We present to the vm the 2 Logical Volume as it was raw disk.
In this system we can make live migration between host using local 
scripts which assume than one VolumeGroup is used only by one host at 
the same time on the 8 node "cluster". We don't use any clustered aware 
environment like CLVM.

We plan to migrate to kvm and libvirt with the new centos release 
(CentOS 6).
Reading the upstream documentation and libvirt i don't find anything 
about using libvirt with san storage except for iscsi.
Do you have any link or idea about using kvm + libvirt + SAN FC storage 
that permit to make live migration between node (we think about RHCS 
with GFS2 but it seems very complex to set up) ?

Do you think i can use the LUN's SAN as local storage on each node. For 
each LUN create an LVM Volume Group (same on each node, like that we 
doing now with xen) and use it as volume pool in libvirt.
Is volume pool in libvirt is 'cluster aware' (Can i access it 
simultaneously from different node) ?

I'm beginner in kvm so any advice will be great.

regards

-- 
Frederic Soulier

DSI / Service Système
Université Toulouse 1 Capitole
2 rue du doyen Gabriel Marty
31 042 Toulouse Cedex 9
Tel: +33 5 61 63 39 98 Fax: +33 5 61 63 37 98


</body></email><email><emailId>20110120145531</emailId><senderName>Fyodor Kupchik</senderName><senderEmail>ferimy@gmail.com</senderEmail><timestampReceived>2011-01-20 14:55:31-0400</timestampReceived><subject>[libvirt-users] git repository access via HTTPS</subject><body>

Hi,

I've just tried to do a fresh checkout (git clone) with libvirt sources tree
and had no luck because it seems to be inaccessible/non-existent at all. Is
this temporary situation or I have to only use git:// proto?
I'm asking because I'm sitting behind rather restrictive corporate proxy
which does not allow anything but a little set of protocols such as HTTP(S).

Thanks.

[Attachment #3 (text/html)]

Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I've just tried to do a fresh checkout (git clone) with \
libvirt sources tree and had no luck because it seems to be inaccessible/non-existent \
at all. Is this temporary situation or I have to only use git:// proto?&lt;/div&gt; \
&lt;div&gt;I'm asking because I'm sitting behind rather restrictive corporate proxy \
which does not allow anything but a little set of protocols such as \
HTTP(S).&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks.&lt;/div&gt;



</body></email><email><emailId>20110122064955</emailId><senderName>Igor Serebryany</senderName><senderEmail>igor47@moomers.org</senderEmail><timestampReceived>2011-01-22 06:49:55-0400</timestampReceived><subject>[libvirt-users] invalid argument error when using cache parameter</subject><body>


hi, 

	i tried to add a 'cache' argument to the 'driver' element in my
	domainxml for qemu/kvm. i tried adding cache="none" as well as
	"writethrough" and "writeback", but every time i get these errors:

libvirtError: internal error process exited while connecting to monitor: char device \
                redirected to /dev/pts/1
qemu: could not open disk image /vms/test.img: Invalid argument 

	the full driver line looks like this:
	&lt;driver name="qemu" type="raw" cache="none"/&gt;

	the same domainxml works just fine without the cache parameter. does
	anyone know what i'm doing wrong? is there some other way to set the
	default cache policy on qemu/kvm? i didn't see anything in the
	config file...


--igor


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20110122065728</emailId><senderName>Igor Serebryany</senderName><senderEmail>igor47@moomers.org</senderEmail><timestampReceived>2011-01-22 06:57:28-0400</timestampReceived><subject>Re: [libvirt-users] invalid argument error when using cache parameter</subject><body>


Actually, I only get the error when using cache='none' -- writethrough
and writeback both work, and default works also but the cache parameter
is gone from the driver element if I do a dumpxml.

i also forgot to include versions:

cloud1:~# qemu --version
QEMU PC emulator version 0.12.5 (Debian 0.12.5+dfsg-3), Copyright (c) 2003-2008 \
Fabrice Bellard cloud1:~# virsh --version
0.8.6

--Igor

On Sat, Jan 22, 2011 at 12:49:55AM -0600, Igor Serebryany wrote:
&gt; hi, 
&gt; 
&gt; 	i tried to add a 'cache' argument to the 'driver' element in my
&gt; 	domainxml for qemu/kvm. i tried adding cache="none" as well as
&gt; 	"writethrough" and "writeback", but every time i get these errors:
&gt; 
&gt; libvirtError: internal error process exited while connecting to monitor: char \
&gt;                 device redirected to /dev/pts/1
&gt; qemu: could not open disk image /vms/test.img: Invalid argument 
&gt; 
&gt; 	the full driver line looks like this:
&gt; 	&lt;driver name="qemu" type="raw" cache="none"/&gt;
&gt; 
&gt; 	the same domainxml works just fine without the cache parameter. does
&gt; 	anyone know what i'm doing wrong? is there some other way to set the
&gt; 	default cache policy on qemu/kvm? i didn't see anything in the
&gt; 	config file...
&gt; 
&gt; 
&gt; --igor



&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20110123113506</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-01-23 11:35:06-0400</timestampReceived><subject>Re: [libvirt-users] invalid argument error when using cache parameter</subject><body>

ÓÚ 2011Äê01Ô 22ÈÕ 14:57, Igor Serebryany Ð´µÀ:
&gt; Actually, I only get the error when using cache='none' -- writethrough
&gt; and writeback both work, and default works also but the cache parameter
&gt; is gone from the driver element if I do a dumpxml.
&gt; 

Hi, Igor,

Could you check the disk cache support of your qemu?

[root@Osier libvirt]# qemu-kvm --help | grep cache
       [,cache=writethrough|writeback|none|unsafe][,format=f]

And, also the qemu command line for your guest?
/var/log/libvirt/qemu/$guest.log

Regards
Osier
&gt; i also forgot to include versions:
&gt; 
&gt; cloud1:~# qemu --version
&gt; QEMU PC emulator version 0.12.5 (Debian 0.12.5+dfsg-3), Copyright (c) 2003-2008 \
&gt; Fabrice Bellard cloud1:~# virsh --version
&gt; 0.8.6
&gt; 
&gt; --Igor
&gt; 
&gt; On Sat, Jan 22, 2011 at 12:49:55AM -0600, Igor Serebryany wrote:
&gt; &gt; hi,
&gt; &gt; 
&gt; &gt; 	i tried to add a 'cache' argument to the 'driver' element in my
&gt; &gt; 	domainxml for qemu/kvm. i tried adding cache="none" as well as
&gt; &gt; 	"writethrough" and "writeback", but every time i get these errors:
&gt; &gt; 
&gt; &gt; libvirtError: internal error process exited while connecting to monitor: char \
&gt; &gt;                 device redirected to /dev/pts/1
&gt; &gt; qemu: could not open disk image /vms/test.img: Invalid argument
&gt; &gt; 
&gt; &gt; 	the full driver line looks like this:
&gt; &gt; 	&lt;driver name="qemu" type="raw" cache="none"/&gt;
&gt; &gt; 
&gt; &gt; 	the same domainxml works just fine without the cache parameter. does
&gt; &gt; 	anyone know what i'm doing wrong? is there some other way to set the
&gt; &gt; 	default cache policy on qemu/kvm? i didn't see anything in the
&gt; &gt; 	config file...
&gt; &gt; 
&gt; &gt; 
&gt; &gt; --igor
&gt; 
&gt; 
&gt; 
&gt; &gt; _______________________________________________
&gt; &gt; libvirt-users mailing list
&gt; &gt; libvirt-users@redhat.com
&gt; &gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; 
&gt; 
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users


</body></email><email><emailId>20110124112636</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-01-24 11:26:36-0400</timestampReceived><subject>Re: [libvirt-users] invalid argument error when using cache parameter</subject><body>

On Sat, Jan 22, 2011 at 12:49:55AM -0600, Igor Serebryany wrote:
&gt; hi, 
&gt; 
&gt; 	i tried to add a 'cache' argument to the 'driver' element in my
&gt; 	domainxml for qemu/kvm. i tried adding cache="none" as well as
&gt; 	"writethrough" and "writeback", but every time i get these errors:
&gt; 
&gt; libvirtError: internal error process exited while connecting to monitor: char \
&gt;                 device redirected to /dev/pts/1
&gt; qemu: could not open disk image /vms/test.img: Invalid argument 
&gt; 
&gt; 	the full driver line looks like this:
&gt; 	&lt;driver name="qemu" type="raw" cache="none"/&gt;
&gt; 
&gt; 	the same domainxml works just fine without the cache parameter. does
&gt; 	anyone know what i'm doing wrong? is there some other way to set the
&gt; 	default cache policy on qemu/kvm? i didn't see anything in the
&gt; 	config file...

What filesystem type is /vms ?  I've seen this error message when
the filesystem did not support O_DIRECT, which cache=none enables

Regards,
Daniel


</body></email><email><emailId>20110118093213</emailId><senderName>joe fu</senderName><senderEmail>joefuu10@gmail.com</senderEmail><timestampReceived>2011-01-18 09:32:13-0400</timestampReceived><subject>[libvirt-users] Allocating Sockets Cores and Threads.</subject><body>

Hi,

Is there any other way I could allocate sockets, cores and threads to my
virtual machine? I looked over the virsh man page and I didn't find anything
that talks about sockets, threads and cores.
I edited the vm xml file and added this...

&lt;cpu&gt;
    &lt;topology sockets='1' cores='2' threads='1'/&gt;
 &lt;/cpu&gt;

Saw this in the libvirt documents, http://libvirt.org/formatdomain.html

Setting this up shows me a single core in my vm, but I don't see any sockets
and threads. Can somebody tell me how to do it in a right way so that I see
all sockets, cores and threads allocated in my vm.

Thanks
joe

[Attachment #3 (text/html)]

&lt;br&gt;&lt;div class="gmail_quote"&gt;Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is there any other way I could \
allocate sockets, cores and threads to my virtual machine? I looked over the virsh \
man page and I didn't find anything that talks about sockets, threads and cores. \
&lt;/div&gt;

&lt;div&gt;I edited the vm xml file and added this... \
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;cpu&gt;&lt;/div&gt;&lt;div&gt;    &lt;topology \
sockets='1' cores='2' threads='1'/&gt;&lt;/div&gt;&lt;div&gt; \
&lt;/cpu&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;

&lt;br&gt;&lt;/div&gt;&lt;div&gt;Saw this in the libvirt documents, &lt;a \
href="http://libvirt.org/formatdomain.html" \
target="_blank"&gt;http://libvirt.org/formatdomain.html&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Setting \
this up shows me a single core in my vm, but I don't see any sockets and threads. \
Can somebody tell me how to do it in a right way so that I see all sockets, cores and \
threads allocated in my vm.&lt;/div&gt;

&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&lt;/div&gt;&lt;div&gt;joe&lt;/div&gt;
&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110127202024</emailId><senderName>Tomasz Chmielewski</senderName><senderEmail>mangoo@wpkg.org</senderEmail><timestampReceived>2011-01-27 20:20:24-0400</timestampReceived><subject>[libvirt-users] multi-user libvirt / virsh?</subject><body>

I was wondering if libvirt / virsh was designed for multi-user environments.

I.e. I was thinking of the "roles", i.e. root would be able to do 
everything, but regular users would only be able to stop/start/suspend, 
or use vnc with the virtual machines which belong to them.

Is it possible with libvirt / virsh? If not, are there any other options 
to achieve it?


-- 
Tomasz Chmielewski
http://wpkg.org

</body></email><email><emailId>20110127235928</emailId><senderName>Thomas Schweikle</senderName><senderEmail>tps@vr-web.de</senderEmail><timestampReceived>2011-01-27 23:59:28-0400</timestampReceived><subject>[libvirt-users] libvirtd + vir-manager + kerberos</subject><body>

Hi!

Having two hosts installed with libvirtd, kvm, qemu on (Ubuntu
10.10). Now I have one big problem and one less:

I have set up kerberos for both hosts. Created the principal
"libvirt/srv1.example.org@EXAMPLE.ORG" and
"libvirt/srv2.example.org@EXAMPLE.ORG", Exported the krb5.keytab,
Installed it and tested the servers:

srv1.example.org: I can connect using kerberos after acquiring a
ticket with kinit.

srv2.example.org: I am asked for user and password. Setup seems to
be identical. Is there a way to debug, what is going on on this
server? I'd like to have both respect kerberos and allow logging in
with no password it already authenticated!

Here is what I've set up:
/etc/sasl2/libvirt.conf
listen_tls = 0
listen_tcp = 1
mdns_adv = 0
auth_unix_ro = "none"
auth_unix_rw = "none"
auth_tcp = "sasl"

/etc/sasl2/libvirt.conf
mech_list: gssapi
keytab: /etc/libvirt/krb5.kqemu
sasldb_path: /etc/libvirt/passwd.db

I start libvirtd with:
KRB5_KTNAME=/etc/libvirt/krb5.kqemu
/usr/sbin/libvirtd -d --listen

In virt-manager I've set both hosts:
qemu+tcp://srv1.example.org
qemu+tcp://srv2.example.org

Since both configs are identical (I've ran diff on them) I am a bit
lost at the moment. I do not have any idea why it works for one
host, but not the other. Any ideas?

-- 
Thomas

</body></email><email><emailId>20110126183833</emailId><senderName>Alexander Topolanek</senderName><senderEmail>atopo@ocv.org</senderEmail><timestampReceived>2011-01-26 18:38:33-0400</timestampReceived><subject>[libvirt-users] syslog messages after cd-rom removal</subject><body>


Sorry, I know this is not really libvirt related, but I'm searching for 
a solution sind about an hour and cannot find anything that helps me ...


Ok, I used to install a standard debian in a kvm instance, and removed 
the virtual cd-rom after installation. Now I'm getting this triplet 
every five minutes in my syslog:

Jan 26 19:25:12 srv62 kernel: [ 1324.267675] hdc: task_in_intr: 
status=0x41 { DriveReady Error }
Jan 26 19:25:12 srv62 kernel: [ 1324.267683] hdc: task_in_intr: 
error=0x04 { AbortedCommand }
Jan 26 19:25:12 srv62 kernel: [ 1324.267685] ide: failed opcode was: 0xec

and I'm looking how to get rid of the device.



thanks for any help

Alexander

</body></email><email><emailId>20110127003952</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-27 00:39:52-0400</timestampReceived><subject>Re: [libvirt-users] syslog messages after cd-rom removal</subject><body>

On 27/01/2011, at 5:38 AM, Alexander Topolanek wrote:
&gt; Sorry, I know this is not really libvirt related, but I'm searching for a solution \
&gt; sind about an hour and cannot find anything that helps me ... 
&gt; Ok, I used to install a standard debian in a kvm instance, and removed the virtual \
&gt; cd-rom after installation. Now I'm getting this triplet every five minutes in my \
&gt; syslog: 
&gt; Jan 26 19:25:12 srv62 kernel: [ 1324.267675] hdc: task_in_intr: status=0x41 { \
&gt;                 DriveReady Error }
&gt; Jan 26 19:25:12 srv62 kernel: [ 1324.267683] hdc: task_in_intr: error=0x04 { \
&gt;                 AbortedCommand }
&gt; Jan 26 19:25:12 srv62 kernel: [ 1324.267685] ide: failed opcode was: 0xec
&gt; 
&gt; and I'm looking how to get rid of the device.

Just for clarification, is that the syslog of the host machine, or the syslog of a \
guest?

If it's the guest, I'm kind of wondering if you did the "sudo eject" thing before \
removing the virtual-cdrom, so the guest "knows" the cd drive don't have any mdedia \
in it?

Regards and best wishes,

Justin Clift


</body></email><email><emailId>20110130185241</emailId><senderName>Taras Lipatov</senderName><senderEmail>taras@lipatov.com</senderEmail><timestampReceived>2011-01-30 18:52:41-0400</timestampReceived><subject>[libvirt-users] libvirt bridge configuration</subject><body>

Hi Every one,

I'm hoping some one can point me in the right direction.
We are piloting KVM + Libvirt for migrating off Xen and I'm stuck with 
the network bridge configuration via libvirt.

What we have currently with xen is:
1 server with Wan/lan interfaces and a pool of public ip addresses.
Using xen bridge scripts I'd start a xenbr0 and attach eth0 (wan) and go 
ahead and assign public IP's
to images attached to xenbr0.

Now with creating virbr0, I need to assign it an ip address? and routing 
methods? what about creating a transparent bridge via libvirt?
I kno I can achieve this using bridge utils, but it would be nice to 
have everything handled by libvirt.

Any help would be appreciated.

cheers,
Taras

</body></email><email><emailId>20110130121941</emailId><senderName>Sengor</senderName><senderEmail>sengork@gmail.com</senderEmail><timestampReceived>2011-01-30 12:19:41-0400</timestampReceived><subject>[libvirt-users] Guest interface info under ESX driver</subject><body>

Hi,

Is there a way to fetch the current IP address of a running guest
domain (with VMware Tools installed) running on an ESX host?

Ideally this would be doable via the libvirt Python bindings.

Thank you.

-- 
sengork

</body></email><email><emailId>20110131052208</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-31 05:22:08-0400</timestampReceived><subject>Re: [libvirt-users] Guest interface info under ESX driver</subject><body>

On 30/01/2011, at 11:19 PM, Sengor wrote:
&gt; Hi,
&gt; 
&gt; Is there a way to fetch the current IP address of a running guest
&gt; domain (with VMware Tools installed) running on an ESX host?
&gt; 
&gt; Ideally this would be doable via the libvirt Python bindings.

Hi Sengor,

Does this help?

  https://rwmj.wordpress.com/2010/10/26/tip-find-the-ip-address-of-a-virtual-machine/

I'm unsure about it's interaction with vSphere/ESX though.

Regards and best wishes,

Justin Clift

</body></email><email><emailId>20110131131117</emailId><senderName>Sengor</senderName><senderEmail>sengork@gmail.com</senderEmail><timestampReceived>2011-01-31 13:11:17-0400</timestampReceived><subject>Re: [libvirt-users] Guest interface info under ESX driver</subject><body>

Hi Justin,

Thanks. I did come across that post, but was hoping there'd be a more
contained method of finding the domain's IP address without needing to
do ARP/MAC lookups or query the DHCP server itself.

The following does not display the IP either for an ESX guest 'testvm':
virsh # dumpxml testvm
...
    &lt;interface type='bridge'&gt;
      &lt;mac address='00:0c:29:09:ab:2c'/&gt;
      &lt;source bridge='VM Network'/&gt;
    &lt;/interface&gt;
...

Looking around the libvirt Python bindings reveals class virInterface
from lib/site-packages/libvirt.py with the following function:
    def XMLDesc(self, flags):
        """VIR_INTERFACE_XML_INACTIVE - return the static configuration,
                                          suitable for use redefining the
                                          interface via virInterfaceDefineXML()

        Provide an XML description of the interface. If
        VIR_INTERFACE_XML_INACTIVE is set, the description may be reused
        later to redefine the interface with virInterfaceDefineXML(). If it
        is not set, the ip address and netmask will be the current live
        setting of the interface, not the settings from the config files. """
        ret = libvirtmod.virInterfaceGetXMLDesc(self._o, flags)
        if ret is None: raise libvirtError ('virInterfaceGetXMLDesc()
failed', net=self)
        return ret

This looks promising (if it indeed does work for ESX driver), however
I've not figured out how to use this particular class/function yet. So
far unable to find any examples on the web...

Lastly I cannot tell whether this is supported at all for the ESX
driver given the current driver support matrix:
http://www.libvirt.org/hvsupport.html

Any help is appreciated.


On Mon, Jan 31, 2011 at 4:22 PM, Justin Clift &lt;jclift@redhat.com&gt; wrote:
&gt; On 30/01/2011, at 11:19 PM, Sengor wrote:
&gt;&gt; Hi,
&gt;&gt;
&gt;&gt; Is there a way to fetch the current IP address of a running guest
&gt;&gt; domain (with VMware Tools installed) running on an ESX host?
&gt;&gt;
&gt;&gt; Ideally this would be doable via the libvirt Python bindings.
&gt;
&gt; Hi Sengor,
&gt;
&gt; Does this help?
&gt;
&gt;  https://rwmj.wordpress.com/2010/10/26/tip-find-the-ip-address-of-a-virtual-machine/
&gt;
&gt; I'm unsure about it's interaction with vSphere/ESX though.
&gt;
&gt; Regards and best wishes,
&gt;
&gt; Justin Clift



-- 
sengork

</body></email><email><emailId>20110131134522</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-01-31 13:45:22-0400</timestampReceived><subject>Re: [libvirt-users] Guest interface info under ESX driver</subject><body>

2011/1/31 Sengor &lt;sengork@gmail.com&gt;:
&gt; Hi Justin,
&gt;
&gt; Thanks. I did come across that post, but was hoping there'd be a more
&gt; contained method of finding the domain's IP address without needing to
&gt; do ARP/MAC lookups or query the DHCP server itself.

Currently libvirt doesn't provide a function to get the IP address of
a domain's network interface.

Might be a useful addition as libvirt can know/determine the IP
address in several cases.

&gt; The following does not display the IP either for an ESX guest 'testvm':
&gt; virsh # dumpxml testvm
&gt; ...
&gt;    &lt;interface type='bridge'&gt;
&gt;      &lt;mac address='00:0c:29:09:ab:2c'/&gt;
&gt;      &lt;source bridge='VM Network'/&gt;
&gt;    &lt;/interface&gt;
&gt; ...

The domain XML doesn't contain the IP address (yet).

With VMware tools installed in the guest it might be possible to
obtain the IP address via the vSphere API, I didn't test this yet.

But libvirt doesn't have a function to expose this information yet.

&gt; Looking around the libvirt Python bindings reveals class virInterface
&gt; from lib/site-packages/libvirt.py with the following function:
&gt;    def XMLDesc(self, flags):
&gt;        """VIR_INTERFACE_XML_INACTIVE - return the static configuration,
&gt;                                          suitable for use redefining the
&gt;                                          interface via virInterfaceDefineXML()
&gt;
&gt;        Provide an XML description of the interface. If
&gt;        VIR_INTERFACE_XML_INACTIVE is set, the description may be reused
&gt;        later to redefine the interface with virInterfaceDefineXML(). If it
&gt;        is not set, the ip address and netmask will be the current live
&gt;        setting of the interface, not the settings from the config files. """
&gt;        ret = libvirtmod.virInterfaceGetXMLDesc(self._o, flags)
&gt;        if ret is None: raise libvirtError ('virInterfaceGetXMLDesc()
&gt; failed', net=self)
&gt;        return ret
&gt;
&gt; This looks promising (if it indeed does work for ESX driver), however
&gt; I've not figured out how to use this particular class/function yet. So
&gt; far unable to find any examples on the web...

virInterface is for the host network interfaces, this is not what
you're looking for.

&gt; Lastly I cannot tell whether this is supported at all for the ESX
&gt; driver given the current driver support matrix:
&gt; http://www.libvirt.org/hvsupport.html

This matrix is quite outdated, and needs to be updated :(

Matthias

&gt;
&gt; On Mon, Jan 31, 2011 at 4:22 PM, Justin Clift &lt;jclift@redhat.com&gt; wrote:
&gt;&gt; On 30/01/2011, at 11:19 PM, Sengor wrote:
&gt;&gt;&gt; Hi,
&gt;&gt;&gt;
&gt;&gt;&gt; Is there a way to fetch the current IP address of a running guest
&gt;&gt;&gt; domain (with VMware Tools installed) running on an ESX host?
&gt;&gt;&gt;
&gt;&gt;&gt; Ideally this would be doable via the libvirt Python bindings.
&gt;&gt;
&gt;&gt; Hi Sengor,
&gt;&gt;
&gt;&gt; Does this help?
&gt;&gt;
&gt;&gt;  https://rwmj.wordpress.com/2010/10/26/tip-find-the-ip-address-of-a-virtual-machine/
&gt;&gt;
&gt;&gt; I'm unsure about it's interaction with vSphere/ESX though.
&gt;&gt;
&gt;&gt; Regards and best wishes,
&gt;&gt;
&gt;&gt; Justin Clift
&gt;
&gt;
&gt;
&gt; --
&gt; sengork
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

</body></email><email><emailId>20110131051848</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-31 05:18:48-0400</timestampReceived><subject>Re: [libvirt-users] libvirt bridge configuration</subject><body>

On 31/01/2011, at 5:52 AM, Taras Lipatov wrote:
&gt; Hi Every one,
&gt; 
&gt; I'm hoping some one can point me in the right direction.
&gt; We are piloting KVM + Libvirt for migrating off Xen and I'm stuck with the network \
&gt; bridge configuration via libvirt. 
&gt; What we have currently with xen is:
&gt; 1 server with Wan/lan interfaces and a pool of public ip addresses.
&gt; Using xen bridge scripts I'd start a xenbr0 and attach eth0 (wan) and go ahead and \
&gt; assign public IP's to images attached to xenbr0.
&gt; 
&gt; Now with creating virbr0, I need to assign it an ip address? and routing methods? \
&gt; what about creating a transparent bridge via libvirt? I kno I can achieve this \
&gt; using bridge utils, but it would be nice to have everything handled by libvirt. 
&gt; Any help would be appreciated.

Hi Taras,

Is this helpful at all?

  http://wiki.libvirt.org/page/VirtualNetworking

I'm thinking the "Routed" mode there might be what you're looking for?

(note, the URL may change over time, as we're considering merging the info into other \
places, etc)

Regards and best wishes,

Justin Clift


</body></email><email><emailId>20110131132545</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2011-01-31 13:25:45-0400</timestampReceived><subject>Re: [libvirt-users] libvirt bridge configuration</subject><body>

On 01/31/2011 12:18 AM, Justin Clift wrote:
&gt; On 31/01/2011, at 5:52 AM, Taras Lipatov wrote:
&gt; &gt; Hi Every one,
&gt; &gt; 
&gt; &gt; I'm hoping some one can point me in the right direction.
&gt; &gt; We are piloting KVM + Libvirt for migrating off Xen and I'm stuck with the \
&gt; &gt; network bridge configuration via libvirt. 
&gt; &gt; What we have currently with xen is:
&gt; &gt; 1 server with Wan/lan interfaces and a pool of public ip addresses.
&gt; &gt; Using xen bridge scripts I'd start a xenbr0 and attach eth0 (wan) and go ahead \
&gt; &gt; and assign public IP's to images attached to xenbr0.
&gt; &gt; 
&gt; &gt; Now with creating virbr0, I need to assign it an ip address? and routing methods? \
&gt; &gt; what about creating a transparent bridge via libvirt? I kno I can achieve this \
&gt; &gt; using bridge utils, but it would be nice to have everything handled by libvirt. 
&gt; &gt; Any help would be appreciated.
&gt; Hi Taras,
&gt; 
&gt; Is this helpful at all?
&gt; 
&gt; http://wiki.libvirt.org/page/VirtualNetworking
&gt; 
&gt; I'm thinking the "Routed" mode there might be what you're looking for?

Actually, since he's talking about attaching eth0 to the bridge and the 
guests having public IPs, I'm thinking he's talking about what we call 
"bridged mode", which is covered starting here:

http://wiki.libvirt.org/page/FAQ#Why_doesn.27t_libvirt_just_auto_configure_a_regular_network_bridge.3F


(Note that recent libvirt does have an API to configure any host network 
interface, including a bridge that's attached to a physical interface 
(look for the "iface-*" commands in virsh), but that API depends on the 
netcf library, which so far is only available on RHEL and Fedora 
platforms, so if you're running on something else, you'll need to follow 
the manual instructions at the provided link for setting up the bridge).


</body></email><email><emailId>20110127122734</emailId><senderName>Guido Winkelmann</senderName><senderEmail>guido-libvi@unknownsite.de</senderEmail><timestampReceived>2011-01-27 12:27:34-0400</timestampReceived><subject>Re: [libvirt-users] syslog messages after cd-rom removal</subject><body>

Am Thursday 27 January 2011 schrieb Justin Clift:
&gt; On 27/01/2011, at 5:38 AM, Alexander Topolanek wrote:
&gt; &gt; Sorry, I know this is not really libvirt related, but I'm searching for a
&gt; &gt; solution sind about an hour and cannot find anything that helps me ...
&gt; &gt; 
&gt; &gt; Ok, I used to install a standard debian in a kvm instance, and removed
&gt; &gt; the virtual cd-rom after installation. Now I'm getting this triplet
&gt; &gt; every five minutes in my syslog:
&gt; &gt; 
&gt; &gt; Jan 26 19:25:12 srv62 kernel: [ 1324.267675] hdc: task_in_intr:
&gt; &gt; status=0x41 { DriveReady Error } Jan 26 19:25:12 srv62 kernel: [
&gt; &gt; 1324.267683] hdc: task_in_intr: error=0x04 { AbortedCommand } Jan 26
&gt; &gt; 19:25:12 srv62 kernel: [ 1324.267685] ide: failed opcode was: 0xec
&gt; &gt; 
&gt; &gt; and I'm looking how to get rid of the device.
&gt; 
&gt; Just for clarification, is that the syslog of the host machine, or the
&gt; syslog of a guest?
&gt; 
&gt; If it's the guest, I'm kind of wondering if you did the "sudo eject" thing
&gt; before removing the virtual-cdrom, so the guest "knows" the cd drive don't
&gt; have any mdedia in it?

Why should that be necessary? On my physical machine, I can just manually eject 
the cdrom, too, without saying sudo eject first, and the kernel will not be that 
confused by it.

My suspicion is that he accidentally removed the entire virtual drive from the 
kvm instance, instead of just the medium...

	Guido

</body></email><email><emailId>20110127125751</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-27 12:57:51-0400</timestampReceived><subject>Re: [libvirt-users] syslog messages after cd-rom removal</subject><body>

On 27/01/2011, at 11:27 PM, Guido Winkelmann wrote:
&lt;snip&gt;
&gt;&gt; If it's the guest, I'm kind of wondering if you did the "sudo eject" thing
&gt;&gt; before removing the virtual-cdrom, so the guest "knows" the cd drive don't
&gt;&gt; have any mdedia in it?
&gt; 
&gt; Why should that be necessary? On my physical machine, I can just manually eject 
&gt; the cdrom, too, without saying sudo eject first, and the kernel will not be that 
&gt; confused by it.

Heh, for me, I couldn't manually eject the cdrom when it's in use, unless I wanted to get
a paperclip out and really force the issue.  Which then does lead to messages
getting sent to syslog.

Though, that was a while ago. ;)

You're right about it also looking like the entire virtual drive that might have been
removed too.

</body></email><email><emailId>20110128111412</emailId><senderName>antoni artigues</senderName><senderEmail>tartigues@iac3.eu</senderEmail><timestampReceived>2011-01-28 11:14:12-0400</timestampReceived><subject>Re: [libvirt-users] compilation error</subject><body>

Okey!! Good!! now has compiled without errors.

I'm going to check if can manage our esx hypevisors.

Thanks to all

Regards

Antoni Artigues

El vie, 28-01-2011 a las 10:48 +0100, Matthias Bolte escribió:
&gt; 2011/1/28 Justin Clift &lt;jclift@redhat.com&gt;:
&gt; &gt; On 28/01/2011, at 7:21 PM, antoni artigues wrote:
&gt; &gt;&gt; Hello
&gt; &gt;&gt;
&gt; &gt;&gt; Thanks again for all the help.
&gt; &gt;&gt;
&gt; &gt;&gt; Now with the patch and 0.8.7, and only ESX enabled returns this error:
&gt; &gt;&gt;
&gt; &gt;&gt; ----------------------------------
&gt; &gt;&gt; virsh-virsh.o(.text+0x128a8): In function `cmdCPUBaseline':
&gt; &gt;&gt; : undefined reference to `xmlSaveToBuffer'
&gt; &gt;&gt; collect2: ld returned 1 exit status
&gt; &gt; &lt;snip&gt;
&gt; &gt;
&gt; &gt; Hey Daniel, any idea if there's a reasonable alternative to xmlSaveToBuffer(),
&gt; &gt; that would work with older releases of libxml2? (ie the RHEL4 version)
&gt; &gt;
&gt; &gt; Regards and best wishes,
&gt; &gt;
&gt; &gt; Justin Clift
&gt; &gt;
&gt; 
&gt; Well, we could just do the same as for the kernel version problem,
&gt; just remove the offending code from virsh.c as the cpu-baseline
&gt; command is currently not supported for ESX anyway :)
&gt; 
&gt; I attached a patch that just removes the entire cpu-baseline command
&gt; from virsh, quite harsh but effective.
&gt; 
&gt; Matthias



</body></email><email><emailId>20110118103725</emailId><senderName>joe fu</senderName><senderEmail>joefuu10@gmail.com</senderEmail><timestampReceived>2011-01-18 10:37:25-0400</timestampReceived><subject>Re: [libvirt-users] Allocating Sockets Cores and Threads.</subject><body>

I'm checked out my /proc/cpuinfo file and I'm finding the following changes.

Physical ID : 0
Siblings : 1
core id :0
cpu cores :1
apicid :0
initial apicid:0

This is what I noticed when I edited the vm with this ...
&lt;cpu&gt;
    &lt;topology sockets='1' cores='2' threads='4'/&gt;
 &lt;/cpu&gt;

Thanks
Joe


On Tue, Jan 18, 2011 at 2:50 PM, joe fu &lt;joefuu10@gmail.com&gt; wrote:

&gt;
&gt; Hi,
&gt;
&gt; Is there any other way I could allocate sockets, cores and threads to my
&gt; virtual machine? I looked over the virsh man page and I didn't find anything
&gt; that talks about sockets, threads and cores.
&gt; I edited the vm xml file and added this...
&gt;
&gt; &lt;cpu&gt;
&gt;     &lt;topology sockets='1' cores='2' threads='1'/&gt;
&gt;  &lt;/cpu&gt;
&gt;
&gt; Saw this in the libvirt documents, http://libvirt.org/formatdomain.html
&gt;
&gt; Setting this up shows me a single core in my vm, but I don't see any
&gt; sockets and threads. Can somebody tell me how to do it in a right way so
&gt; that I see all sockets, cores and threads allocated in my vm.
&gt;
&gt; Thanks
&gt; joe
&gt;
&gt;

[Attachment #3 (text/html)]

I'm checked out my /proc/cpuinfo file and I'm finding the following \
changes.&lt;br&gt;&lt;br&gt;Physical ID : 0&lt;br&gt;Siblings : 1&lt;br&gt;core id :0&lt;br&gt;cpu cores \
:1&lt;br&gt;apicid :0&lt;br&gt;initial apicid:0&lt;br&gt;&lt;br&gt;This is what I noticed when I edited the \
vm with this ...&lt;br&gt; &lt;div&gt;&lt;div&gt;&lt;cpu&gt;&lt;/div&gt;&lt;div&gt;    &lt;topology \
sockets='1' cores='2' threads='4'/&gt;&lt;/div&gt;&lt;div&gt; \
&lt;/cpu&gt;&lt;/div&gt;&lt;/div&gt;

&lt;br&gt;Thanks&lt;br&gt;Joe&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Tue, Jan 18, 2011 at 2:50 \
PM, joe fu &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:joefuu10@gmail.com"&gt;joefuu10@gmail.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="border-left: 1px solid rgb(204, 204, \
204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;"&gt; &lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div \
class="h5"&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is there any other way \
I could allocate sockets, cores and threads to my virtual machine? I looked over the \
virsh man page and I didn't find anything that talks about sockets, threads and \
cores. &lt;/div&gt;


&lt;div&gt;I edited the vm xml file and added this... \
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;cpu&gt;&lt;/div&gt;&lt;div&gt;    &lt;topology \
sockets='1' cores='2' threads='1'/&gt;&lt;/div&gt;&lt;div&gt; \
&lt;/cpu&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;


&lt;br&gt;&lt;/div&gt;&lt;div&gt;Saw this in the libvirt documents, &lt;a \
href="http://libvirt.org/formatdomain.html" \
target="_blank"&gt;http://libvirt.org/formatdomain.html&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Setting \
this up shows me a single core in my vm, but I don't see any sockets and threads. \
Can somebody tell me how to do it in a right way so that I see all sockets, cores and \
threads allocated in my vm.&lt;/div&gt;


&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&lt;/div&gt;&lt;div&gt;joe&lt;/div&gt;
&lt;/div&gt;&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110120060446</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-20 06:04:46-0400</timestampReceived><subject>Re: [libvirt-users] Allocating Sockets Cores and Threads.</subject><body>

On 18/01/2011, at 9:25 PM, joe fu wrote:
&gt; I'm checked out my /proc/cpuinfo file and I'm finding the following changes.
&gt; 
&gt; Physical ID : 0
&gt; Siblings : 1
&gt; core id :0
&gt; cpu cores :1
&gt; apicid :0
&gt; initial apicid:0
&gt; 
&gt; This is what I noticed when I edited the vm with this ...
&gt; &lt;cpu&gt;
&gt;     &lt;topology sockets='1' cores='2' threads='4'/&gt;
&gt;  &lt;/cpu&gt;

Hi Joe,

Looking at the same part of the XML description as you did:

  http://libvirt.org/formatdomain.html#elementsCPU

You're right, in that it shows we have some kind of capacity to process that info.

Some questions that might help us find the answer:

 + What's the virtualisation host you're trying this out on?

     i.e. KVM/Xen/vSphere/ESX/VirtualBox/etc

 + Which version of libvirt is it running?

 + What guest OS's have you tried with?

Regards and best wishes,

Justin Clift

</body></email><email><emailId>20110121072602</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-01-21 07:26:02-0400</timestampReceived><subject>Re: [libvirt-users] git repository access via HTTPS</subject><body>

于 2011年01月20日 22:55, Fyodor Kupchik 写道:
&gt; Hi,
&gt;
&gt; I've just tried to do a fresh checkout (git clone) with libvirt sources
&gt; tree and had no luck because it seems to be inaccessible/non-existent at
&gt; all. Is this temporary situation or I have to only use git:// proto?
&gt; I'm asking because I'm sitting behind rather restrictive corporate proxy
&gt; which does not allow anything but a little set of protocols such as HTTP(S).
&gt;

http://libvirt.org/downloads.html

Regards
Osier

</body></email><email><emailId>20110126105722</emailId><senderName>antoni artigues</senderName><senderEmail>tartigues@iac3.eu</senderEmail><timestampReceived>2011-01-26 10:57:22-0400</timestampReceived><subject>[libvirt-users] compilation error</subject><body>

Hello

I'm trying to compile libvirt-0.8.6 on RHEL4 with kernel 2.6.9-67

The make command returns:
--------------------
util/interface.c: In function `ifaceGetVlanID':
util/interface.c:355: error: `GET_VLAN_VID_CMD' undeclared (first use in
this function)
util/interface.c:355: error: (Each undeclared identifier is reported
only once
util/interface.c:355: error: for each function it appears in.)
make[3]: *** [libvirt_util_la-interface.lo] Error 1
make[3]: Leaving directory `/root/InstalledPackages/libvirt-0.8.6/src'
make[2]: *** [all] Error 2
make[2]: Leaving directory `/root/InstalledPackages/libvirt-0.8.6/src'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/root/InstalledPackages/libvirt-0.8.6'
make: *** [all] Error 2
--------------------

I have saw that GET_VLAN_VID_CMD should be in if_vlan.h file, but it is
not present.

What do I have to update in my system to avoid this error?

Thanks in advance

regards

Antoni Artigues

</body></email><email><emailId>20110127052739</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2011-01-27 05:27:39-0400</timestampReceived><subject>Re: [libvirt-users] compilation error</subject><body>

On Wed, Jan 26, 2011 at 11:57:22AM +0100, antoni artigues wrote:
&gt; Hello
&gt; 
&gt; I'm trying to compile libvirt-0.8.6 on RHEL4 with kernel 2.6.9-67

  Ouch, in general libvirt and virtualization was added only in RHEL-5
and while we are trying to make sure libvirt still compile on that
platform, we never made any attempt to support RHEL-4, simply because
there is also nothing to support (no xen, qemu ...)

&gt; The make command returns:
&gt; --------------------
&gt; util/interface.c: In function `ifaceGetVlanID':
&gt; util/interface.c:355: error: `GET_VLAN_VID_CMD' undeclared (first use in
&gt; this function)
&gt; util/interface.c:355: error: (Each undeclared identifier is reported
&gt; only once
&gt; util/interface.c:355: error: for each function it appears in.)
&gt; make[3]: *** [libvirt_util_la-interface.lo] Error 1
&gt; make[3]: Leaving directory `/root/InstalledPackages/libvirt-0.8.6/src'
&gt; make[2]: *** [all] Error 2
&gt; make[2]: Leaving directory `/root/InstalledPackages/libvirt-0.8.6/src'
&gt; make[1]: *** [all-recursive] Error 1
&gt; make[1]: Leaving directory `/root/InstalledPackages/libvirt-0.8.6'
&gt; make: *** [all] Error 2
&gt; --------------------
&gt; 
&gt; I have saw that GET_VLAN_VID_CMD should be in if_vlan.h file, but it is
&gt; not present.
&gt; 
&gt; What do I have to update in my system to avoid this error?

  I still wonder about the usefulness of libvirt on RHEL-4 (except maybe
for the client library part). On my RHEL-4 box, GET_VLAN_VID_CMD is nowhere
to be found, I'm afraid that will be true for many other parts of libvirt
system support on a 2.6.9 linux kernel.

Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

</body></email><email><emailId>20110127085555</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-27 08:55:55-0400</timestampReceived><subject>Re: [libvirt-users] compilation error</subject><body>

On 27/01/2011, at 4:27 PM, Daniel Veillard wrote:
&lt;snip&gt;
&gt;  I still wonder about the usefulness of libvirt on RHEL-4 (except maybe
&gt; for the client library part).

That's a really good point.  Antoni, what are you wanting to do with libvirt?

If you want the libvirt server to run... that's probably never going to work.

But if you're only needing the libvirt client to run, so you can connect from
it to other servers, that's something we should probably think about letting
work. :)

Regards and best wishes,

Justin Clift

</body></email><email><emailId>20110127091132</emailId><senderName>antoni artigues</senderName><senderEmail>tartigues@iac3.eu</senderEmail><timestampReceived>2011-01-27 09:11:32-0400</timestampReceived><subject>Re: [libvirt-users] compilation error</subject><body>

Hello

Yes. I want to run only the libvirt client. I want to connect from it to
manage vmware ESX servers on the cluster nodes.

But we must hurry up. So, I think we can't wait for your solution.When
would be the improvement?

Thank for the answers

regards

Antoni Artigues


El jue, 27-01-2011 a las 19:55 +1100, Justin Clift escribió:
&gt; On 27/01/2011, at 4:27 PM, Daniel Veillard wrote:
&gt; &lt;snip&gt;
&gt; &gt;  I still wonder about the usefulness of libvirt on RHEL-4 (except maybe
&gt; &gt; for the client library part).
&gt; 
&gt; That's a really good point.  Antoni, what are you wanting to do with libvirt?
&gt; 
&gt; If you want the libvirt server to run... that's probably never going to work.
&gt; 
&gt; But if you're only needing the libvirt client to run, so you can connect from
&gt; it to other servers, that's something we should probably think about letting
&gt; work. :)
&gt; 
&gt; Regards and best wishes,
&gt; 
&gt; Justin Clift



</body></email><email><emailId>20110127102935</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-27 10:29:35-0400</timestampReceived><subject>Re: [libvirt-users] compilation error</subject><body>

On 27/01/2011, at 8:11 PM, antoni artigues wrote:
&gt; Hello
&gt; 
&gt; Yes. I want to run only the libvirt client. I want to connect from it to
&gt; manage vmware ESX servers on the cluster nodes.
&gt; 
&gt; But we must hurry up. So, I think we can't wait for your solution.When
&gt; would be the improvement?

That's one of those "it's hard to tell things".

However, you might be in luck. :)

Because you're just needing the libvirt client, there's a chance that the broken
pieces are in an option you don't need.

So, try turning off the compiling for as many options as possible, using
configure switches.  Using this kind of approach:

  $ ./configure --with-libvirtd=no (add more options here if needed)

It will mean a bit of experimentation on your part, but it's worth trying.

Btw, one of the important options to turn off is the macvtap one,  The macvtap
code seem to directly use the function you mention is broken, so avoid that one.

You ok to try this out?

Regards and best wishes,

Justin Clift

</body></email><email><emailId>20110127112230</emailId><senderName>antoni artigues</senderName><senderEmail>tartigues@iac3.eu</senderEmail><timestampReceived>2011-01-27 11:22:30-0400</timestampReceived><subject>Re: [libvirt-users] compilation error</subject><body>

Okey!! Thank you for the answer.

I'm trying to compile with your recommendations.

I will post here the experiment results.

Thanks

Antoni Artigues

El jue, 27-01-2011 a las 21:29 +1100, Justin Clift escribió:
&gt; On 27/01/2011, at 8:11 PM, antoni artigues wrote:
&gt; &gt; Hello
&gt; &gt; 
&gt; &gt; Yes. I want to run only the libvirt client. I want to connect from it to
&gt; &gt; manage vmware ESX servers on the cluster nodes.
&gt; &gt; 
&gt; &gt; But we must hurry up. So, I think we can't wait for your solution.When
&gt; &gt; would be the improvement?
&gt; 
&gt; That's one of those "it's hard to tell things".
&gt; 
&gt; However, you might be in luck. :)
&gt; 
&gt; Because you're just needing the libvirt client, there's a chance that the broken
&gt; pieces are in an option you don't need.
&gt; 
&gt; So, try turning off the compiling for as many options as possible, using
&gt; configure switches.  Using this kind of approach:
&gt; 
&gt;   $ ./configure --with-libvirtd=no (add more options here if needed)
&gt; 
&gt; It will mean a bit of experimentation on your part, but it's worth trying.
&gt; 
&gt; Btw, one of the important options to turn off is the macvtap one,  The macvtap
&gt; code seem to directly use the function you mention is broken, so avoid that one.
&gt; 
&gt; You ok to try this out?
&gt; 
&gt; Regards and best wishes,
&gt; 
&gt; Justin Clift



</body></email><email><emailId>20110127122943</emailId><senderName>antoni artigues</senderName><senderEmail>tartigues@iac3.eu</senderEmail><timestampReceived>2011-01-27 12:29:43-0400</timestampReceived><subject>Re: [libvirt-users] compilation error</subject><body>

Hello

I have tried to compile with the minimum number of options. But still
the same error:

  CC     libvirt_util_la-interface.lo
util/interface.c: In function `ifaceGetVlanID':
util/interface.c:355: error: `GET_VLAN_VID_CMD' undeclared (first use in
this function)

As you can see, only the ESX driver is enabled in the configuration:

-------------------
configure: Drivers
configure: 
configure:      Xen: no
configure:    Proxy: no
configure:     QEMU: no
configure:      UML: no
configure:   OpenVZ: no
configure:     VBox: no
configure:   XenAPI: no
configure:      LXC: no
configure:     PHYP: no
configure:      ONE: no
configure:      ESX: yes
configure:     Test: no
configure:   Remote: no
configure:  Network: no
configure: Libvirtd: no
configure:    netcf: no
configure:  macvtap: no
configure: virtport: no
configure: 
configure: Storage Drivers
configure: 
configure:      Dir: no
configure:       FS: no
configure:    NetFS: no
configure:      LVM: no
configure:    iSCSI: no
configure:     SCSI: no
configure:    mpath: no
configure:     Disk: no
configure: 
configure: Security Drivers
configure: 
configure:  SELinux: no
configure: AppArmor: no
configure: 
configure: Driver Loadable Modules
configure: 
configure:   dlopen: no
configure: 
configure: Libraries
configure: 
configure:   libxml: -I/usr/include/libxml2   -lxml2 -lpthread -lz -lm  
configure:  libcurl: -DCURL_DISABLE_TYPECHECK -I/usr/local/include
-L/usr/local/lib -lcurl  
configure:  libssh2:  
configure:   gnutls:  -lgnutls  -lgcrypt
configure:     sasl: no
configure:     yajl: no
configure:    avahi: no
configure:   polkit: no
configure:  selinux: no
configure: apparmor: no
configure:  numactl: no
configure:    capng: no
configure:      xen: no
configure:   xenapi: no
configure:      hal: no
configure:     udev: no
configure:    netcf: no
configure:   xmlrpc: no
configure:     pcap: no
configure:       nl: no
---------------------------------

So, I think is not possible to compile libvirt client on RHEL4.

thanks anyway

Antoni Artigues

El jue, 27-01-2011 a las 21:29 +1100, Justin Clift escribió:
&gt; On 27/01/2011, at 8:11 PM, antoni artigues wrote:
&gt; &gt; Hello
&gt; &gt; 
&gt; &gt; Yes. I want to run only the libvirt client. I want to connect from it to
&gt; &gt; manage vmware ESX servers on the cluster nodes.
&gt; &gt; 
&gt; &gt; But we must hurry up. So, I think we can't wait for your solution.When
&gt; &gt; would be the improvement?
&gt; 
&gt; That's one of those "it's hard to tell things".
&gt; 
&gt; However, you might be in luck. :)
&gt; 
&gt; Because you're just needing the libvirt client, there's a chance that the broken
&gt; pieces are in an option you don't need.
&gt; 
&gt; So, try turning off the compiling for as many options as possible, using
&gt; configure switches.  Using this kind of approach:
&gt; 
&gt;   $ ./configure --with-libvirtd=no (add more options here if needed)
&gt; 
&gt; It will mean a bit of experimentation on your part, but it's worth trying.
&gt; 
&gt; Btw, one of the important options to turn off is the macvtap one,  The macvtap
&gt; code seem to directly use the function you mention is broken, so avoid that one.
&gt; 
&gt; You ok to try this out?
&gt; 
&gt; Regards and best wishes,
&gt; 
&gt; Justin Clift



</body></email><email><emailId>20110127123700</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-27 12:37:00-0400</timestampReceived><subject>Re: [libvirt-users] compilation error</subject><body>

On 27/01/2011, at 11:29 PM, antoni artigues wrote:
&lt;snip&gt;
&gt; So, I think is not possible to compile libvirt client on RHEL4.
&gt; 
&gt; thanks anyway

Looks like it. :(

Sorry Antoni.

Regards and best wishes,

Justin Clift

</body></email><email><emailId>20110127130608</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-01-27 13:06:08-0400</timestampReceived><subject>Re: [libvirt-users] compilation error</subject><body>

If you only need the ESX part you can disable most of the parts that
may have problems due to the old kernel version. Running configure
like Justin suggested:

./configure --with-esx --without-libvirtd --without-network

This will disable libvirtd, the network driver and probably other
things. configure will disable other things like macvtap automatically
when it doesn't detect support for them in your system.

The compile error you see can easily by avoided by this patch:


diff --git a/src/util/interface.c b/src/util/interface.c
index fe58823..1463574 100644
--- a/src/util/interface.c
+++ b/src/util/interface.c
@@ -348,7 +348,7 @@ ifaceGetIndex(bool reportError,

 #endif /* __linux__ */

-#ifdef __linux__
+#if 0
 int
 ifaceGetVlanID(const char *vlanifname, int *vlanid) {
     struct vlan_ioctl_args vlanargs = {


As ifaceGetVlanID is only used in macvtap specific code that'll
probably be disabled anyway because of the kernel version.

Matthias

2011/1/27 antoni artigues &lt;tartigues@iac3.eu&gt;:
&gt; Hello
&gt;
&gt; Yes. I want to run only the libvirt client. I want to connect from it to
&gt; manage vmware ESX servers on the cluster nodes.
&gt;
&gt; But we must hurry up. So, I think we can't wait for your solution.When
&gt; would be the improvement?
&gt;
&gt; Thank for the answers
&gt;
&gt; regards
&gt;
&gt; Antoni Artigues
&gt;
&gt;
&gt; El jue, 27-01-2011 a las 19:55 +1100, Justin Clift escribió:
&gt;&gt; On 27/01/2011, at 4:27 PM, Daniel Veillard wrote:
&gt;&gt; &lt;snip&gt;
&gt;&gt; &gt;  I still wonder about the usefulness of libvirt on RHEL-4 (except maybe
&gt;&gt; &gt; for the client library part).
&gt;&gt;
&gt;&gt; That's a really good point.  Antoni, what are you wanting to do with libvirt?
&gt;&gt;
&gt;&gt; If you want the libvirt server to run... that's probably never going to work.
&gt;&gt;
&gt;&gt; But if you're only needing the libvirt client to run, so you can connect from
&gt;&gt; it to other servers, that's something we should probably think about letting
&gt;&gt; work. :)
&gt;&gt;
&gt;&gt; Regards and best wishes,
&gt;&gt;
&gt;&gt; Justin Clift
&gt;
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110127151706</emailId><senderName>antoni artigues</senderName><senderEmail>tartigues@iac3.eu</senderEmail><timestampReceived>2011-01-27 15:17:06-0400</timestampReceived><subject>Re: [libvirt-users] compilation error</subject><body>

Hello

Thank you for the answer

Now, with this patch, and only ESX enabled returns a different error:

--------------------------------------
Making all in daemon
make[2]: Entering directory
`/root/InstalledPackages/libvirt-0.8.3/daemon'
make  all-am
make[3]: Entering directory
`/root/InstalledPackages/libvirt-0.8.3/daemon'
make[3]: *** No rule to make target `libvirtd.8', needed by `all-am'.
Stop.
make[3]: Leaving directory
`/root/InstalledPackages/libvirt-0.8.3/daemon'
make[2]: *** [all] Error 2
make[2]: Leaving directory
`/root/InstalledPackages/libvirt-0.8.3/daemon'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/root/InstalledPackages/libvirt-0.8.3'
make: *** [all] Error 2
--------------------------------------

It seems a libvirtd error, but libvirtd is not enabled:

"configure: Libvirtd: no"

I don't know why returns a libvirtd error. Is there another patch to
solve this?

Thanks in advance

Antoni Artigues


El jue, 27-01-2011 a las 14:06 +0100, Matthias Bolte escribió:
&gt; If you only need the ESX part you can disable most of the parts that
&gt; may have problems due to the old kernel version. Running configure
&gt; like Justin suggested:
&gt; 
&gt; ./configure --with-esx --without-libvirtd --without-network
&gt; 
&gt; This will disable libvirtd, the network driver and probably other
&gt; things. configure will disable other things like macvtap automatically
&gt; when it doesn't detect support for them in your system.
&gt; 
&gt; The compile error you see can easily by avoided by this patch:
&gt; 
&gt; 
&gt; diff --git a/src/util/interface.c b/src/util/interface.c
&gt; index fe58823..1463574 100644
&gt; --- a/src/util/interface.c
&gt; +++ b/src/util/interface.c
&gt; @@ -348,7 +348,7 @@ ifaceGetIndex(bool reportError,
&gt; 
&gt;  #endif /* __linux__ */
&gt; 
&gt; -#ifdef __linux__
&gt; +#if 0
&gt;  int
&gt;  ifaceGetVlanID(const char *vlanifname, int *vlanid) {
&gt;      struct vlan_ioctl_args vlanargs = {
&gt; 
&gt; 
&gt; As ifaceGetVlanID is only used in macvtap specific code that'll
&gt; probably be disabled anyway because of the kernel version.
&gt; 
&gt; Matthias
&gt; 
&gt; 2011/1/27 antoni artigues &lt;tartigues@iac3.eu&gt;:
&gt; &gt; Hello
&gt; &gt;
&gt; &gt; Yes. I want to run only the libvirt client. I want to connect from it to
&gt; &gt; manage vmware ESX servers on the cluster nodes.
&gt; &gt;
&gt; &gt; But we must hurry up. So, I think we can't wait for your solution.When
&gt; &gt; would be the improvement?
&gt; &gt;
&gt; &gt; Thank for the answers
&gt; &gt;
&gt; &gt; regards
&gt; &gt;
&gt; &gt; Antoni Artigues
&gt; &gt;
&gt; &gt;
&gt; &gt; El jue, 27-01-2011 a las 19:55 +1100, Justin Clift escribió:
&gt; &gt;&gt; On 27/01/2011, at 4:27 PM, Daniel Veillard wrote:
&gt; &gt;&gt; &lt;snip&gt;
&gt; &gt;&gt; &gt;  I still wonder about the usefulness of libvirt on RHEL-4 (except maybe
&gt; &gt;&gt; &gt; for the client library part).
&gt; &gt;&gt;
&gt; &gt;&gt; That's a really good point.  Antoni, what are you wanting to do with libvirt?
&gt; &gt;&gt;
&gt; &gt;&gt; If you want the libvirt server to run... that's probably never going to work.
&gt; &gt;&gt;
&gt; &gt;&gt; But if you're only needing the libvirt client to run, so you can connect from
&gt; &gt;&gt; it to other servers, that's something we should probably think about letting
&gt; &gt;&gt; work. :)
&gt; &gt;&gt;
&gt; &gt;&gt; Regards and best wishes,
&gt; &gt;&gt;
&gt; &gt;&gt; Justin Clift
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; _______________________________________________
&gt; &gt; libvirt-users mailing list
&gt; &gt; libvirt-users@redhat.com
&gt; &gt; https://www.redhat.com/mailman/listinfo/libvirt-users



</body></email><email><emailId>20110127153511</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-01-27 15:35:11-0400</timestampReceived><subject>Re: [libvirt-users] compilation error</subject><body>

2011/1/27 antoni artigues &lt;tartigues@iac3.eu&gt;:
&gt; Hello
&gt;
&gt; Thank you for the answer
&gt;
&gt; Now, with this patch, and only ESX enabled returns a different error:
&gt;
&gt; --------------------------------------
&gt; Making all in daemon
&gt; make[2]: Entering directory
&gt; `/root/InstalledPackages/libvirt-0.8.3/daemon'
&gt; make   all-am
&gt; make[3]: Entering directory
&gt; `/root/InstalledPackages/libvirt-0.8.3/daemon'
&gt; make[3]: *** No rule to make target `libvirtd.8', needed by `all-am'.
&gt; Stop.
&gt; make[3]: Leaving directory
&gt; `/root/InstalledPackages/libvirt-0.8.3/daemon'
&gt; make[2]: *** [all] Error 2
&gt; make[2]: Leaving directory
&gt; `/root/InstalledPackages/libvirt-0.8.3/daemon'
&gt; make[1]: *** [all-recursive] Error 1
&gt; make[1]: Leaving directory `/root/InstalledPackages/libvirt-0.8.3'
&gt; make: *** [all] Error 2
&gt; --------------------------------------
&gt;
&gt; It seems a libvirtd error, but libvirtd is not enabled:
&gt;
&gt; "configure: Libvirtd: no"
&gt;
&gt; I don't know why returns a libvirtd error. Is there another patch to
&gt; solve this?
&gt;

That's a bug in libvirt 0.8.3 that was fixed in 0.8.4 by this commit:

http://libvirt.org/git/?p=libvirt.git;a=commit;h=e7e9456bb4cce02dda7749434fec431a37a437cf

Matthias

</body></email><email><emailId>20110127155547</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-27 15:55:47-0400</timestampReceived><subject>Re: [libvirt-users] compilation error</subject><body>

On 28/01/2011, at 2:35 AM, Matthias Bolte wrote:
&lt;snip&gt;
&gt; That's a bug in libvirt 0.8.3 that was fixed in 0.8.4 by this commit:
&gt; 
&gt; http://libvirt.org/git/?p=libvirt.git;a=commit;h=e7e9456bb4cce02dda7749434fec431a37a437cf

On that note, Antoni, are you able to try with our most recent release, 0.8.7?
(you'd need to apply Matthias' patch again though)

</body></email><email><emailId>20110128082128</emailId><senderName>antoni artigues</senderName><senderEmail>tartigues@iac3.eu</senderEmail><timestampReceived>2011-01-28 08:21:28-0400</timestampReceived><subject>Re: [libvirt-users] compilation error</subject><body>

Hello

Thanks again for all the help.

Now with the patch and 0.8.7, and only ESX enabled returns this error:

----------------------------------
virsh-virsh.o(.text+0x128a8): In function `cmdCPUBaseline':
: undefined reference to `xmlSaveToBuffer'
collect2: ld returned 1 exit status
make[3]: *** [virsh] Error 1
make[3]: Leaving directory `/root/InstalledPackages/libvirt-0.8.7/tools'
make[2]: *** [all] Error 2
make[2]: Leaving directory `/root/InstalledPackages/libvirt-0.8.7/tools'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/root/InstalledPackages/libvirt-0.8.7'
make: *** [all] Error 2
-----------------------------------

Thanks in advance

Antoni Artigues

El vie, 28-01-2011 a las 02:55 +1100, Justin Clift escribió:
&gt; On 28/01/2011, at 2:35 AM, Matthias Bolte wrote:
&gt; &lt;snip&gt;
&gt; &gt; That's a bug in libvirt 0.8.3 that was fixed in 0.8.4 by this commit:
&gt; &gt; 
&gt; &gt; http://libvirt.org/git/?p=libvirt.git;a=commit;h=e7e9456bb4cce02dda7749434fec431a37a437cf
&gt; 
&gt; On that note, Antoni, are you able to try with our most recent release, 0.8.7?
&gt; (you'd need to apply Matthias' patch again though)



</body></email><email><emailId>20110128083727</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-28 08:37:27-0400</timestampReceived><subject>Re: [libvirt-users] compilation error</subject><body>

On 28/01/2011, at 7:21 PM, antoni artigues wrote:
&gt; Hello
&gt; 
&gt; Thanks again for all the help.
&gt; 
&gt; Now with the patch and 0.8.7, and only ESX enabled returns this error:
&gt; 
&gt; ----------------------------------
&gt; virsh-virsh.o(.text+0x128a8): In function `cmdCPUBaseline':
&gt; : undefined reference to `xmlSaveToBuffer'
&gt; collect2: ld returned 1 exit status
&lt;snip&gt;

Hey Daniel, any idea if there's a reasonable alternative to xmlSaveToBuffer(),
that would work with older releases of libxml2? (ie the RHEL4 version)

Regards and best wishes,

Justin Clift


</body></email><email><emailId>20110128094823</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-01-28 09:48:23-0400</timestampReceived><subject>Re: [libvirt-users] compilation error</subject><body>

2011/1/28 Justin Clift &lt;jclift@redhat.com&gt;:
&gt; On 28/01/2011, at 7:21 PM, antoni artigues wrote:
&gt;&gt; Hello
&gt;&gt;
&gt;&gt; Thanks again for all the help.
&gt;&gt;
&gt;&gt; Now with the patch and 0.8.7, and only ESX enabled returns this error:
&gt;&gt;
&gt;&gt; ----------------------------------
&gt;&gt; virsh-virsh.o(.text+0x128a8): In function `cmdCPUBaseline':
&gt;&gt; : undefined reference to `xmlSaveToBuffer'
&gt;&gt; collect2: ld returned 1 exit status
&gt; &lt;snip&gt;
&gt;
&gt; Hey Daniel, any idea if there's a reasonable alternative to xmlSaveToBuffer(),
&gt; that would work with older releases of libxml2? (ie the RHEL4 version)
&gt;
&gt; Regards and best wishes,
&gt;
&gt; Justin Clift
&gt;

Well, we could just do the same as for the kernel version problem,
just remove the offending code from virsh.c as the cpu-baseline
command is currently not supported for ESX anyway :)

I attached a patch that just removes the entire cpu-baseline command
from virsh, quite harsh but effective.

Matthias

["remove-cpu-baseline.patch" (text/x-patch)]

diff --git a/tools/virsh.c b/tools/virsh.c
index 4533d38..3611be7 100644
--- a/tools/virsh.c
+++ b/tools/virsh.c
@@ -8946,6 +8946,7 @@ cmdCPUCompare(vshControl *ctl, const vshCmd *cmd)
     return ret;
 }
 
+#if 0
 /*
  * "cpu-baseline" command
  */
@@ -9063,6 +9064,7 @@ no_memory:
     ret = FALSE;
     goto cleanup;
 }
+#endif
 
 /* Common code for the edit / net-edit / pool-edit functions which follow. */
 static char *
@@ -9979,7 +9981,9 @@ static const vshCmdDef domManagementCmds[] = {
 #ifndef WIN32
     {"console", cmdConsole, opts_console, info_console},
 #endif
+#if 0
     {"cpu-baseline", cmdCPUBaseline, opts_cpu_baseline, info_cpu_baseline},
+#endif
     {"cpu-compare", cmdCPUCompare, opts_cpu_compare, info_cpu_compare},
     {"create", cmdCreate, opts_create, info_create},
     {"define", cmdDefine, opts_define, info_define},


</body></email><email><emailId>20110121081546</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-21 08:15:46-0400</timestampReceived><subject>Re: [libvirt-users] git repository access via HTTPS</subject><body>

On 21/01/2011, at 1:55 AM, Fyodor Kupchik wrote:
&gt; Hi,
&gt; 
&gt; I've just tried to do a fresh checkout (git clone) with libvirt sources tree and \
&gt; had no luck because it seems to be inaccessible/non-existent at all. Is this \
&gt; temporary situation or I have to only use git:// proto? I'm asking because I'm \
&gt; sitting behind rather restrictive corporate proxy which does not allow anything but \
&gt; a little set of protocols such as HTTP(S).

Just checked the server setup here, and it doesn't look like there's any way other \
than git://.  Not even http://.

Sorry. :(


</body></email><email><emailId>20110121082506</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-21 08:25:06-0400</timestampReceived><subject>Re: [libvirt-users] git repository access via HTTPS</subject><body>

On 21/01/2011, at 7:15 PM, Justin Clift wrote:
&gt; On 21/01/2011, at 1:55 AM, Fyodor Kupchik wrote:
&gt; &gt; Hi,
&gt; &gt; 
&gt; &gt; I've just tried to do a fresh checkout (git clone) with libvirt sources tree and \
&gt; &gt; had no luck because it seems to be inaccessible/non-existent at all. Is this \
&gt; &gt; temporary situation or I have to only use git:// proto? I'm asking because I'm \
&gt; &gt; sitting behind rather restrictive corporate proxy which does not allow anything \
&gt; &gt; but a little set of protocols such as HTTP(S).
&gt; 
&gt; Just checked the server setup here, and it doesn't look like there's any way other \
&gt; than git://.  Not even http://. 
&gt; Sorry. :(

Oh, there is one other possibility, briefly mentioned on the downloads page Osier \
pointed you to.

Depending upon what you're needs are, the hourly source code snapshot (tarball) might \
work for you:

  http://libvir.org/sources/libvirt-git-snapshot.tar.gz

But, if you really do need the proper git repo cloned, that's going to be tricky. :(


</body></email><email><emailId>20110121082942</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2011-01-21 08:29:42-0400</timestampReceived><subject>Re: [libvirt-users] git repository access via HTTPS</subject><body>

On Fri, Jan 21, 2011 at 07:15:46PM +1100, Justin Clift wrote:
&gt; On 21/01/2011, at 1:55 AM, Fyodor Kupchik wrote:
&gt; &gt; Hi,
&gt; &gt; 
&gt; &gt; I've just tried to do a fresh checkout (git clone) with libvirt sources tree and \
&gt; &gt; had no luck because it seems to be inaccessible/non-existent at all. Is this \
&gt; &gt; temporary situation or I have to only use git:// proto? I'm asking because I'm \
&gt; &gt; sitting behind rather restrictive corporate proxy which does not allow anything \
&gt; &gt; but a little set of protocols such as HTTP(S).
&gt; 
&gt; Just checked the server setup here, and it doesn't look like there's any way other \
&gt; than git://.  Not even http://. 
&gt; Sorry. :(

  Well, right now there are still:
    - hourly snapshots extracted from git available via http and FTP
      ftp://libvirt.org/libvirt/
      http://libvirt.org/sources/
    - the git interface at 
      http://libvirt.org/git/?p=libvirt.git;a=summary
      allows to extract snapshots
but git though HTTP is not configured, in general it's fairly inefficient.

Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/


</body></email><email><emailId>20110121083247</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2011-01-21 08:32:47-0400</timestampReceived><subject>Re: [libvirt-users] git repository access via HTTPS</subject><body>

On Fri, Jan 21, 2011 at 07:25:06PM +1100, Justin Clift wrote:
&gt; On 21/01/2011, at 7:15 PM, Justin Clift wrote:
&gt; &gt; On 21/01/2011, at 1:55 AM, Fyodor Kupchik wrote:
&gt; &gt; &gt; Hi,
&gt; &gt; &gt; 
&gt; &gt; &gt; I've just tried to do a fresh checkout (git clone) with libvirt sources tree \
&gt; &gt; &gt; and had no luck because it seems to be inaccessible/non-existent at all. Is \
&gt; &gt; &gt; this temporary situation or I have to only use git:// proto? I'm asking because \
&gt; &gt; &gt; I'm sitting behind rather restrictive corporate proxy which does not allow \
&gt; &gt; &gt; anything but a little set of protocols such as HTTP(S).
&gt; &gt; 
&gt; &gt; Just checked the server setup here, and it doesn't look like there's any way \
&gt; &gt; other than git://.  Not even http://. 
&gt; &gt; Sorry. :(
&gt; 
&gt; Oh, there is one other possibility, briefly mentioned on the downloads page Osier \
&gt; pointed you to.

  Last possibility use the gitorious clone repo, it seems available via http
   http://www.gitorious.net/libvirt?page=3

Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/


</body></email><email><emailId>20110121083905</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-21 08:39:05-0400</timestampReceived><subject>Re: [libvirt-users] git repository access via HTTPS</subject><body>

On 21/01/2011, at 7:32 PM, Daniel Veillard wrote:
&gt; On Fri, Jan 21, 2011 at 07:25:06PM +1100, Justin Clift wrote:
&gt; &gt; On 21/01/2011, at 7:15 PM, Justin Clift wrote:
&gt; &gt; &gt; On 21/01/2011, at 1:55 AM, Fyodor Kupchik wrote:
&gt; &gt; &gt; &gt; Hi,
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; I've just tried to do a fresh checkout (git clone) with libvirt sources tree \
&gt; &gt; &gt; &gt; and had no luck because it seems to be inaccessible/non-existent at all. Is \
&gt; &gt; &gt; &gt; this temporary situation or I have to only use git:// proto? I'm asking \
&gt; &gt; &gt; &gt; because I'm sitting behind rather restrictive corporate proxy which does not \
&gt; &gt; &gt; &gt; allow anything but a little set of protocols such as HTTP(S).
&gt; &gt; &gt; 
&gt; &gt; &gt; Just checked the server setup here, and it doesn't look like there's any way \
&gt; &gt; &gt; other than git://.  Not even http://. 
&gt; &gt; &gt; Sorry. :(
&gt; &gt; 
&gt; &gt; Oh, there is one other possibility, briefly mentioned on the downloads page Osier \
&gt; &gt; pointed you to.
&gt; 
&gt; Last possibility use the gitorious clone repo, it seems available via http
&gt; http://www.gitorious.net/libvirt?page=3

Interesting.  That one looks workable.


</body></email><email><emailId>20110121094442</emailId><senderName>James Barkley</senderName><senderEmail>james.barkley@gmail.com</senderEmail><timestampReceived>2011-01-21 09:44:42-0400</timestampReceived><subject>Re: [libvirt-users] git repository access via HTTPS</subject><body>

I've had to use the hourly snapshot because I also cannot get to the git
protocol. How is the gitorious clone repo kept in sync? Is this native git
functionality (sync repos) or is it some special sauce on top of that?

-jb

On Fri, Jan 21, 2011 at 3:39 AM, Justin Clift &lt;jclift@redhat.com&gt; wrote:

&gt; On 21/01/2011, at 7:32 PM, Daniel Veillard wrote:
&gt; &gt; On Fri, Jan 21, 2011 at 07:25:06PM +1100, Justin Clift wrote:
&gt; &gt;&gt; On 21/01/2011, at 7:15 PM, Justin Clift wrote:
&gt; &gt;&gt;&gt; On 21/01/2011, at 1:55 AM, Fyodor Kupchik wrote:
&gt; &gt;&gt;&gt;&gt; Hi,
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; I've just tried to do a fresh checkout (git clone) with libvirt
&gt; sources tree and had no luck because it seems to be
&gt; inaccessible/non-existent at all. Is this temporary situation or I have to
&gt; only use git:// proto?
&gt; &gt;&gt;&gt;&gt; I'm asking because I'm sitting behind rather restrictive corporate
&gt; proxy which does not allow anything but a little set of protocols such as
&gt; HTTP(S).
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; Just checked the server setup here, and it doesn't look like there's
&gt; any way other than git://.  Not even http://.
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; Sorry. :(
&gt; &gt;&gt;
&gt; &gt;&gt; Oh, there is one other possibility, briefly mentioned on the downloads
&gt; page Osier pointed you to.
&gt; &gt;
&gt; &gt;  Last possibility use the gitorious clone repo, it seems available via
&gt; http
&gt; &gt;   http://www.gitorious.net/libvirt?page=3
&gt;
&gt; Interesting.  That one looks workable.
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

[Attachment #3 (text/html)]

I've had to use the hourly snapshot because I also cannot get to the git \
protocol. How is the gitorious clone repo kept in sync? Is this native git \
functionality (sync repos) or is it some special sauce on top of that?&lt;div&gt; \
&lt;br&gt;&lt;/div&gt;&lt;div&gt;-jb&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Fri, Jan 21, 2011 at 3:39 AM, \
Justin Clift &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:jclift@redhat.com"&gt;jclift@redhat.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt; &lt;div class="im"&gt;On 21/01/2011, at 7:32 PM, Daniel \
Veillard wrote:&lt;br&gt; &gt; On Fri, Jan 21, 2011 at 07:25:06PM +1100, Justin Clift \
wrote:&lt;br&gt; &gt;&gt; On 21/01/2011, at 7:15 PM, Justin Clift wrote:&lt;br&gt;
&gt;&gt;&gt; On 21/01/2011, at 1:55 AM, Fyodor Kupchik wrote:&lt;br&gt;
&gt;&gt;&gt;&gt; Hi,&lt;br&gt;
&gt;&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt;&gt; I've just tried to do a fresh checkout (git clone) with libvirt \
sources tree and had no luck because it seems to be inaccessible/non-existent at all. \
Is this temporary situation or I have to only use git:// proto?&lt;br&gt;

&gt;&gt;&gt;&gt; I'm asking because I'm sitting behind rather restrictive \
corporate proxy which does not allow anything but a little set of protocols such as \
HTTP(S).&lt;br&gt; &gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt; Just checked the server setup here, and it doesn't look like \
there's any way other than git://.  Not even http://.&lt;br&gt; &gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt; Sorry. :(&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; Oh, there is one other possibility, briefly mentioned on the downloads page \
Osier pointed you to.&lt;br&gt; &gt;&lt;br&gt;
&gt;  Last possibility use the gitorious clone repo, it seems available via http&lt;br&gt;
&gt;   &lt;a href="http://www.gitorious.net/libvirt?page=3" \
target="_blank"&gt;http://www.gitorious.net/libvirt?page=3&lt;/a&gt;&lt;br&gt; &lt;br&gt;
&lt;/div&gt;Interesting.  That one looks workable.&lt;br&gt;
&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;&lt;br&gt;
_______________________________________________&lt;br&gt;
libvirt-users mailing list&lt;br&gt;
&lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
&lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; \
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20110121165208</emailId><senderName>Fyodor Kupchik</senderName><senderEmail>ferimy@gmail.com</senderEmail><timestampReceived>2011-01-21 16:52:08-0400</timestampReceived><subject>Re: [libvirt-users] git repository access via HTTPS</subject><body>

thank you, guys for quick replies and suggestions but I still can't access
repo on gitorius with the HTTP 403 error
HTTPS didn't work as well with"operation now in progress" error

do I need any special creds for anonymous access?


2011/1/21 James Barkley &lt;james.barkley@gmail.com&gt;

&gt; I've had to use the hourly snapshot because I also cannot get to the git
&gt; protocol. How is the gitorious clone repo kept in sync? Is this native git
&gt; functionality (sync repos) or is it some special sauce on top of that?
&gt;
&gt; -jb
&gt;
&gt; On Fri, Jan 21, 2011 at 3:39 AM, Justin Clift &lt;jclift@redhat.com&gt; wrote:
&gt;
&gt;&gt; On 21/01/2011, at 7:32 PM, Daniel Veillard wrote:
&gt;&gt; &gt; On Fri, Jan 21, 2011 at 07:25:06PM +1100, Justin Clift wrote:
&gt;&gt; &gt;&gt; On 21/01/2011, at 7:15 PM, Justin Clift wrote:
&gt;&gt; &gt;&gt;&gt; On 21/01/2011, at 1:55 AM, Fyodor Kupchik wrote:
&gt;&gt; &gt;&gt;&gt;&gt; Hi,
&gt;&gt; &gt;&gt;&gt;&gt;
&gt;&gt; &gt;&gt;&gt;&gt; I've just tried to do a fresh checkout (git clone) with libvirt
&gt;&gt; sources tree and had no luck because it seems to be
&gt;&gt; inaccessible/non-existent at all. Is this temporary situation or I have to
&gt;&gt; only use git:// proto?
&gt;&gt; &gt;&gt;&gt;&gt; I'm asking because I'm sitting behind rather restrictive corporate
&gt;&gt; proxy which does not allow anything but a little set of protocols such as
&gt;&gt; HTTP(S).
&gt;&gt; &gt;&gt;&gt;
&gt;&gt; &gt;&gt;&gt; Just checked the server setup here, and it doesn't look like there's
&gt;&gt; any way other than git://.  Not even http://.
&gt;&gt; &gt;&gt;&gt;
&gt;&gt; &gt;&gt;&gt; Sorry. :(
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Oh, there is one other possibility, briefly mentioned on the downloads
&gt;&gt; page Osier pointed you to.
&gt;&gt; &gt;
&gt;&gt; &gt;  Last possibility use the gitorious clone repo, it seems available via
&gt;&gt; http
&gt;&gt; &gt;   http://www.gitorious.net/libvirt?page=3
&gt;&gt;
&gt;&gt; Interesting.  That one looks workable.
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; libvirt-users mailing list
&gt;&gt; libvirt-users@redhat.com
&gt;&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;&gt;
&gt;
&gt;

[Attachment #3 (text/html)]

thank you, guys for quick replies and suggestions but I still can't access repo \
on gitorius with the HTTP 403 error&lt;div&gt;HTTPS didn't work as well \
with"operation now in progress" error&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; do I need any \
special creds for anonymous access?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;2011/1/21 James Barkley &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:james.barkley@gmail.com"&gt;james.barkley@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt; \
&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt;I've had to use the hourly snapshot because I also \
cannot get to the git protocol. How is the gitorious clone repo kept in sync? Is this \
native git functionality (sync repos) or is it some special sauce on top of \
that?&lt;div&gt;

&lt;br&gt;&lt;/div&gt;&lt;div&gt;-jb&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;On \
Fri, Jan 21, 2011 at 3:39 AM, Justin Clift &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:jclift@redhat.com" target="_blank"&gt;jclift@redhat.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt; &lt;/div&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 \
.8ex;border-left:1px #ccc solid;padding-left:1ex"&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt; \
&lt;div&gt;On 21/01/2011, at 7:32 PM, Daniel Veillard wrote:&lt;br&gt; &gt; On Fri, Jan 21, 2011 \
at 07:25:06PM +1100, Justin Clift wrote:&lt;br&gt; &gt;&gt; On 21/01/2011, at 7:15 PM, \
Justin Clift wrote:&lt;br&gt; &gt;&gt;&gt; On 21/01/2011, at 1:55 AM, Fyodor Kupchik \
wrote:&lt;br&gt; &gt;&gt;&gt;&gt; Hi,&lt;br&gt;
&gt;&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt;&gt; I've just tried to do a fresh checkout (git clone) with libvirt \
sources tree and had no luck because it seems to be inaccessible/non-existent at all. \
Is this temporary situation or I have to only use git:// proto?&lt;br&gt;


&gt;&gt;&gt;&gt; I'm asking because I'm sitting behind rather restrictive \
corporate proxy which does not allow anything but a little set of protocols such as \
HTTP(S).&lt;br&gt; &gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt; Just checked the server setup here, and it doesn't look like \
there's any way other than git://.   Not even http://.&lt;br&gt; &gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt; Sorry. :(&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; Oh, there is one other possibility, briefly mentioned on the downloads page \
Osier pointed you to.&lt;br&gt; &gt;&lt;br&gt;
&gt;   Last possibility use the gitorious clone repo, it seems available via http&lt;br&gt;
&gt;    &lt;a href="http://www.gitorious.net/libvirt?page=3" \
target="_blank"&gt;http://www.gitorious.net/libvirt?page=3&lt;/a&gt;&lt;br&gt; &lt;br&gt;
&lt;/div&gt;Interesting.   That one looks workable.&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;
_______________________________________________&lt;br&gt;
libvirt-users mailing list&lt;br&gt;
&lt;a href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt; &lt;a \
href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; \
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt; &lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20110121205553</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-21 20:55:53-0400</timestampReceived><subject>Re: [libvirt-users] git repository access via HTTPS</subject><body>

On 22/01/2011, at 3:52 AM, Fyodor Kupchik wrote:
thank you, guys for quick replies and suggestions but I still can't access repo on \
gitorius with the HTTP 403 error
&gt; HTTPS didn't work as well with"operation now in progress" error
&gt; 
&gt; do I need any special creds for anonymous access?
&gt; 
&gt; 
&gt; 2011/1/21 James Barkley &lt;james.barkley@gmail.com&gt;
&gt; I've had to use the hourly snapshot because I also cannot get to the git protocol. \
&gt; How is the gitorious clone repo kept in sync? Is this native git functionality \
&gt; (sync repos) or is it some special sauce on top of that? 
&gt; -jb

Yeah, it's definitely not working here for me either.  The clone operation is just \
hanging for me:

  $ git clone http://git.gitorious.org/libvirt/libvirt.git
  Cloning into libvirt...
  (and that's it.  Left it running for 1/2 hour, no change)

I don't have a gitorious account either, so will get a free one and see if that \
helps.


</body></email><email><emailId>20110122002857</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-22 00:28:57-0400</timestampReceived><subject>Re: [libvirt-users] git repository access via HTTPS</subject><body>

On 22/01/2011, at 7:55 AM, Justin Clift wrote:
&gt; On 22/01/2011, at 3:52 AM, Fyodor Kupchik wrote:
&gt; thank you, guys for quick replies and suggestions but I still can't access repo on \
&gt; gitorius with the HTTP 403 error
&gt; &gt; HTTPS didn't work as well with"operation now in progress" error
&gt; &gt; 
&gt; &gt; do I need any special creds for anonymous access?
&gt; &gt; 
&gt; &gt; 
&gt; &gt; 2011/1/21 James Barkley &lt;james.barkley@gmail.com&gt;
&gt; &gt; I've had to use the hourly snapshot because I also cannot get to the git \
&gt; &gt; protocol. How is the gitorious clone repo kept in sync? Is this native git \
&gt; &gt; functionality (sync repos) or is it some special sauce on top of that? 
&gt; &gt; -jb
&gt; 
&gt; Yeah, it's definitely not working here for me either.  The clone operation is just \
&gt; hanging for me: 
&gt; $ git clone http://git.gitorious.org/libvirt/libvirt.git
&gt; Cloning into libvirt...
&gt; (and that's it.  Left it running for 1/2 hour, no change)
&gt; 
&gt; I don't have a gitorious account either, so will get a free one and see if that \
&gt; helps.

Something seems to be wrong with the gitorius end of things:

  $ git clone git://gitorious.org/libvirt/libvirt.git
  Cloning into libvirt...
  remote: Counting objects: 51387, done.
  fatal: The remote end hung up unexpectedly
  fatal: early EOF
  fatal: index-pack failed
  $

Using a browser to go to the http:// URL above from before just gives a "Not Found" \
error too.  I'll email them and see if they have any idea of what's wrong.


</body></email><email><emailId>20110124120605</emailId><senderName>Fyodor Kupchik</senderName><senderEmail>ferimy@gmail.com</senderEmail><timestampReceived>2011-01-24 12:06:05-0400</timestampReceived><subject>Re: [libvirt-users] git repository access via HTTPS</subject><body>

I can make a checkout from https://github.org and there exist several repos
with the libvirt sources but I don't know if I can safely use them.

Unfortunately I can't use snapshot since I'm using scripted installation
procedure. Yes, I can rewrite the script but it is not convenient to me
because I want to automate update and compilation of sources and maintaining
the patches for the bootstrap script looks painful to me.

Can anyone from the official team create a repo on github server and
configure mirroring the sources tree? Of course the best way it to have
HTTPS on the official libvirt.org site.

2011/1/22 Justin Clift &lt;jclift@redhat.com&gt;

&gt; On 22/01/2011, at 7:55 AM, Justin Clift wrote:
&gt; &gt; On 22/01/2011, at 3:52 AM, Fyodor Kupchik wrote:
&gt; &gt; thank you, guys for quick replies and suggestions but I still can't
&gt; access repo on gitorius with the HTTP 403 error
&gt; &gt;&gt; HTTPS didn't work as well with"operation now in progress" error
&gt; &gt;&gt;
&gt; &gt;&gt; do I need any special creds for anonymous access?
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; 2011/1/21 James Barkley &lt;james.barkley@gmail.com&gt;
&gt; &gt;&gt; I've had to use the hourly snapshot because I also cannot get to the git
&gt; protocol. How is the gitorious clone repo kept in sync? Is this native git
&gt; functionality (sync repos) or is it some special sauce on top of that?
&gt; &gt;&gt;
&gt; &gt;&gt; -jb
&gt; &gt;
&gt; &gt; Yeah, it's definitely not working here for me either.  The clone
&gt; operation is just hanging for me:
&gt; &gt;
&gt; &gt;  $ git clone http://git.gitorious.org/libvirt/libvirt.git
&gt; &gt;  Cloning into libvirt...
&gt; &gt;  (and that's it.  Left it running for 1/2 hour, no change)
&gt; &gt;
&gt; &gt; I don't have a gitorious account either, so will get a free one and see
&gt; if that helps.
&gt;
&gt; Something seems to be wrong with the gitorius end of things:
&gt;
&gt;  $ git clone git://gitorious.org/libvirt/libvirt.git
&gt;  Cloning into libvirt...
&gt;  remote: Counting objects: 51387, done.
&gt;  fatal: The remote end hung up unexpectedly
&gt;  fatal: early EOF
&gt;  fatal: index-pack failed
&gt;  $
&gt;
&gt; Using a browser to go to the http:// URL above from before just gives a
&gt; "Not Found" error too.  I'll email them and see if they have any idea of
&gt; what's wrong.

[Attachment #3 (text/html)]

&lt;meta http-equiv="content-type" content="text/html; charset=utf-8"&gt;I can make a \
checkout from &lt;a href="https://github.org"&gt;https://github.org&lt;/a&gt; and there exist \
several repos with the libvirt sources but I don't know if I can safely use \
them.&lt;div&gt; &lt;br&gt;&lt;/div&gt;&lt;div&gt;Unfortunately I can't use snapshot since I'm using \
scripted installation procedure. Yes, I can rewrite the script but it is not \
convenient to me because I want to automate update and compilation of sources and \
maintaining the patches for the bootstrap script looks painful to me.&lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Can anyone from the official team create a repo on github server \
and configure mirroring the sources tree? Of course the best way it to have HTTPS on \
the official &lt;a href="http://libvirt.org"&gt;libvirt.org&lt;/a&gt; site.&lt;br&gt; &lt;/div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;2011/1/22 Justin Clift &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:jclift@redhat.com"&gt;jclift@redhat.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt; &lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;On 22/01/2011, at 7:55 AM, \
Justin Clift wrote:&lt;br&gt; &gt; On 22/01/2011, at 3:52 AM, Fyodor Kupchik wrote:&lt;br&gt;
&gt; thank you, guys for quick replies and suggestions but I still can't access \
repo on gitorius with the HTTP 403 error&lt;br&gt; &gt;&gt; HTTPS didn't work as well \
with"operation now in progress" error&lt;br&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; do I need any special creds for anonymous access?&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; 2011/1/21 James Barkley &lt;&lt;a \
href="mailto:james.barkley@gmail.com"&gt;james.barkley@gmail.com&lt;/a&gt;&gt;&lt;br&gt; &gt;&gt; \
I've had to use the hourly snapshot because I also cannot get to the git \
protocol. How is the gitorious clone repo kept in sync? Is this native git \
functionality (sync repos) or is it some special sauce on top of that?&lt;br&gt;

&gt;&gt;&lt;br&gt;
&gt;&gt; -jb&lt;br&gt;
&gt;&lt;br&gt;
&gt; Yeah, it's definitely not working here for me either.   The clone operation \
is just hanging for me:&lt;br&gt; &gt;&lt;br&gt;
&gt;   $ git clone &lt;a href="http://git.gitorious.org/libvirt/libvirt.git" \
target="_blank"&gt;http://git.gitorious.org/libvirt/libvirt.git&lt;/a&gt;&lt;br&gt; &gt;   Cloning \
into libvirt...&lt;br&gt; &gt;   (and that's it.   Left it running for 1/2 hour, no \
change)&lt;br&gt; &gt;&lt;br&gt;
&gt; I don't have a gitorious account either, so will get a free one and see if \
that helps.&lt;br&gt; &lt;br&gt;
&lt;/div&gt;&lt;/div&gt;Something seems to be wrong with the gitorius end of things:&lt;br&gt;
&lt;br&gt;
   $ git clone git://&lt;a href="http://gitorious.org/libvirt/libvirt.git" \
target="_blank"&gt;gitorious.org/libvirt/libvirt.git&lt;/a&gt;&lt;br&gt;  Cloning into \
libvirt...&lt;br&gt;  remote: Counting objects: 51387, done.&lt;br&gt;
   fatal: The remote end hung up unexpectedly&lt;br&gt;
   fatal: early EOF&lt;br&gt;
   fatal: index-pack failed&lt;br&gt;
   $&lt;br&gt;
&lt;br&gt;
Using a browser to go to the http:// URL above from before just gives a "Not \
Found" error too.   I'll email them and see if they have any idea of \
what's wrong.&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110124123328</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-24 12:33:28-0400</timestampReceived><subject>Re: [libvirt-users] git repository access via HTTPS</subject><body>

On 24/01/2011, at 11:06 PM, Fyodor Kupchik wrote:
&gt; I can make a checkout from https://github.org and there exist several repos with \
&gt; the libvirt sources but I don't know if I can safely use them. 
&gt; Unfortunately I can't use snapshot since I'm using scripted installation procedure. \
&gt; Yes, I can rewrite the script but it is not convenient to me because I want to \
&gt; automate update and compilation of sources and maintaining the patches for the \
&gt; bootstrap script looks painful to me. 
&gt; Can anyone from the official team create a repo on github server and configure \
&gt; mirroring the sources tree? Of course the best way it to have HTTPS on the official \
&gt; libvirt.org site.

Hey Daniel, where is the git mirroring to gitorious done?

Is it a script or something that pushes from the libvirt.org servers, or something \
that pulls from gitorious, or something else?

Was thinking of setting up an equivalent for GitHub, as gitorious has problems with \
http:// and https:// access.

Regards and best wishes,

Justin Clift


</body></email><email><emailId>20110124124251</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-01-24 12:42:51-0400</timestampReceived><subject>Re: [libvirt-users] git repository access via HTTPS</subject><body>

On Mon, Jan 24, 2011 at 11:33:28PM +1100, Justin Clift wrote:
&gt; On 24/01/2011, at 11:06 PM, Fyodor Kupchik wrote:
&gt; &gt; I can make a checkout from https://github.org and there exist several repos with \
&gt; &gt; the libvirt sources but I don't know if I can safely use them. 
&gt; &gt; Unfortunately I can't use snapshot since I'm using scripted installation \
&gt; &gt; procedure. Yes, I can rewrite the script but it is not convenient to me because I \
&gt; &gt; want to automate update and compilation of sources and maintaining the patches \
&gt; &gt; for the bootstrap script looks painful to me. 
&gt; &gt; Can anyone from the official team create a repo on github server and configure \
&gt; &gt; mirroring the sources tree? Of course the best way it to have HTTPS on the \
&gt; &gt; official libvirt.org site.
&gt; 
&gt; Hey Daniel, where is the git mirroring to gitorious done?
&gt; 
&gt; Is it a script or something that pushes from the libvirt.org servers, or something \
&gt; that pulls from gitorious, or something else? 
&gt; Was thinking of setting up an equivalent for GitHub, as
&gt; gitorious has problems with http:// and https:// access.

Err, http:// access works fine with gitorious. I think
you simply didn't wait long enough. GIT's  HTTP access
mechanism is seriously inefficient, and doesn't appear
to give you ongoing progress feedback like the git://
protocol, so expect to wait a while. I've verified I
can clone the main GIT repo over http in about 2 minutes
using:

 git clone http://git.gitorious.org/libvirt/libvirt.git

Regards,
Daniel


</body></email><email><emailId>20110124132047</emailId><senderName>Fyodor Kupchik</senderName><senderEmail>ferimy@gmail.com</senderEmail><timestampReceived>2011-01-24 13:20:47-0400</timestampReceived><subject>Re: [libvirt-users] git repository access via HTTPS</subject><body>

still no luck with it :(
I precede git command by proxychains one since git does not respect any kind
of proxy settings (nor system wide or those I set via git config http.proxy)
and it only works  in such way.
==============================================================================
ProxyChains-3.1 (http://proxychains.sf.net)
Initialized empty Git repository in
/home/teo/prj/archipel/Archipel/Libvirt/.gnulib/.git/
git.sv.gnu.org[0: 140.186.70.72]: errno=Connection refused
fatal: unable to connect a socket (Connection refused)
Clone of 'git://git.sv.gnu.org/gnulib.git' into submodule path '.gnulib'
failed
Failed to recurse into submodule path 'Libvirt'
Unable to initialize submodules
==============================================================================

I suspect it still tries to use git proto somehow...

here's the output from another libvirt repo
==============================================================================
time proxychains git clone https://github.com/marcusk/libvirt.git
ProxyChains-3.1 (http://proxychains.sf.net)
Initialized empty Git repository in /home/teo/prj/libvirt/.git/
remote: Counting objects: 50464, done.
remote: Compressing objects: 100% (8268/8268), done.
remote: Total 50464 (delta 42261), reused 50257 (delta 42058)
Receiving objects: 100% (50464/50464), 51.74 MiB | 177 KiB/s, done.
Resolving deltas: 100% (42261/42261), done.

real    7m42.509s
user    0m13.210s
sys     0m1.140s
==============================================================================

2011/1/24 Daniel P. Berrange &lt;berrange@redhat.com&gt;

&gt; On Mon, Jan 24, 2011 at 11:33:28PM +1100, Justin Clift wrote:
&gt; &gt; On 24/01/2011, at 11:06 PM, Fyodor Kupchik wrote:
&gt; &gt; &gt; I can make a checkout from https://github.org and there exist several
&gt; repos with the libvirt sources but I don't know if I can safely use them.
&gt; &gt; &gt;
&gt; &gt; &gt; Unfortunately I can't use snapshot since I'm using scripted
&gt; installation procedure. Yes, I can rewrite the script but it is not
&gt; convenient to me because I want to automate update and compilation of
&gt; sources and maintaining the patches for the bootstrap script looks painful
&gt; to me.
&gt; &gt; &gt;
&gt; &gt; &gt; Can anyone from the official team create a repo on github server and
&gt; configure mirroring the sources tree? Of course the best way it to have
&gt; HTTPS on the official libvirt.org site.
&gt; &gt;
&gt; &gt; Hey Daniel, where is the git mirroring to gitorious done?
&gt; &gt;
&gt; &gt; Is it a script or something that pushes from the libvirt.org servers, or
&gt; something that pulls from gitorious, or something else?
&gt; &gt;
&gt; &gt; Was thinking of setting up an equivalent for GitHub, as
&gt; &gt;  gitorious has problems with http:// and https:// access.
&gt;
&gt; Err, http:// access works fine with gitorious. I think
&gt; you simply didn't wait long enough. GIT's  HTTP access
&gt; mechanism is seriously inefficient, and doesn't appear
&gt; to give you ongoing progress feedback like the git://
&gt; protocol, so expect to wait a while. I've verified I
&gt; can clone the main GIT repo over http in about 2 minutes
&gt; using:
&gt;
&gt;  git clone http://git.gitorious.org/libvirt/libvirt.git
&gt;
&gt; Regards,
&gt; Daniel
&gt;

[Attachment #3 (text/html)]

&lt;meta http-equiv="content-type" content="text/html; charset=utf-8"&gt;still no luck with \
it :(&lt;div&gt;I precede git command by proxychains one since git does not respect any \
kind of proxy settings (nor system wide or those I set via git config http.proxy) and \
it only works   in such way.&lt;/div&gt; \
&lt;div&gt;==============================================================================&lt;/div&gt;&lt;div&gt;&lt;div&gt;ProxyChains-3.1 \
(&lt;a href="http://proxychains.sf.net"&gt;http://proxychains.sf.net&lt;/a&gt;)&lt;/div&gt;&lt;div&gt;Initialized \
empty Git repository in /home/teo/prj/archipel/Archipel/Libvirt/.gnulib/.git/&lt;/div&gt; \
&lt;div&gt;&lt;a href="http://git.sv.gnu.org"&gt;git.sv.gnu.org&lt;/a&gt;[0: 140.186.70.72]: \
errno=Connection refused&lt;/div&gt;&lt;div&gt;fatal: unable to connect a socket (Connection \
refused)&lt;/div&gt;&lt;div&gt;Clone of 'git://&lt;a \
href="http://git.sv.gnu.org/gnulib.git"&gt;git.sv.gnu.org/gnulib.git&lt;/a&gt;' into \
submodule path '.gnulib' failed&lt;/div&gt; &lt;div&gt;Failed to recurse into submodule \
path 'Libvirt'&lt;/div&gt;&lt;div&gt;Unable to initialize \
submodules&lt;/div&gt;&lt;div&gt;==============================================================================&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I \
suspect it still tries to use git proto somehow...&lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;here's the output from another libvirt \
repo&lt;/div&gt;&lt;div&gt;==============================================================================&lt;/div&gt;&lt;div&gt;&lt;div&gt;time \
proxychains git clone &lt;a \
href="https://github.com/marcusk/libvirt.git"&gt;https://github.com/marcusk/libvirt.git&lt;/a&gt;&lt;/div&gt;
 &lt;div&gt;ProxyChains-3.1 (&lt;a \
href="http://proxychains.sf.net"&gt;http://proxychains.sf.net&lt;/a&gt;)&lt;/div&gt;&lt;div&gt;Initialized \
empty Git repository in /home/teo/prj/libvirt/.git/&lt;/div&gt;&lt;div&gt;remote: Counting \
                objects: 50464, done.&lt;/div&gt;&lt;div&gt;
remote: Compressing objects: 100% (8268/8268), done.&lt;/div&gt;&lt;div&gt;remote: Total 50464 \
(delta 42261), reused 50257 (delta 42058)&lt;/div&gt;&lt;div&gt;Receiving objects: 100% \
(50464/50464), 51.74 MiB | 177 KiB/s, done.&lt;/div&gt;&lt;div&gt;Resolving deltas: 100% \
(42261/42261), done.&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;real      7m42.509s&lt;/div&gt;&lt;div&gt;user     \
0m13.210s&lt;/div&gt;&lt;div&gt;sys       \
0m1.140s&lt;/div&gt;&lt;/div&gt;&lt;div&gt;==============================================================================&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt; 2011/1/24 Daniel P. Berrange &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:berrange@redhat.com"&gt;berrange@redhat.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt; &lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;On Mon, Jan 24, 2011 at \
11:33:28PM +1100, Justin Clift wrote:&lt;br&gt; &gt; On 24/01/2011, at 11:06 PM, Fyodor \
Kupchik wrote:&lt;br&gt; &gt; &gt; I can make a checkout from &lt;a href="https://github.org" \
target="_blank"&gt;https://github.org&lt;/a&gt; and there exist several repos with the libvirt \
sources but I don't know if I can safely use them.&lt;br&gt; &gt; &gt;&lt;br&gt;
&gt; &gt; Unfortunately I can't use snapshot since I'm using scripted \
installation procedure. Yes, I can rewrite the script but it is not convenient to me \
because I want to automate update and compilation of sources and maintaining the \
patches for the bootstrap script looks painful to me.&lt;br&gt;

&gt; &gt;&lt;br&gt;
&gt; &gt; Can anyone from the official team create a repo on github server and \
configure mirroring the sources tree? Of course the best way it to have HTTPS on the \
official &lt;a href="http://libvirt.org" target="_blank"&gt;libvirt.org&lt;/a&gt; site.&lt;br&gt;

&gt;&lt;br&gt;
&gt; Hey Daniel, where is the git mirroring to gitorious done?&lt;br&gt;
&gt;&lt;br&gt;
&gt; Is it a script or something that pushes from the &lt;a href="http://libvirt.org" \
target="_blank"&gt;libvirt.org&lt;/a&gt; servers, or something that pulls from gitorious, or \
something else?&lt;br&gt; &gt;&lt;br&gt;
&gt; Was thinking of setting up an equivalent for GitHub, as&lt;br&gt;
&gt;   gitorious has problems with http:// and https:// access.&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;Err, http:// access works fine with gitorious. I think&lt;br&gt;
you simply didn't wait long enough. GIT's   HTTP access&lt;br&gt;
mechanism is seriously inefficient, and doesn't appear&lt;br&gt;
to give you ongoing progress feedback like the git://&lt;br&gt;
protocol, so expect to wait a while. I've verified I&lt;br&gt;
can clone the main GIT repo over http in about 2 minutes&lt;br&gt;
using:&lt;br&gt;
&lt;div class="im"&gt;&lt;br&gt;
  git clone &lt;a href="http://git.gitorious.org/libvirt/libvirt.git" \
target="_blank"&gt;http://git.gitorious.org/libvirt/libvirt.git&lt;/a&gt;&lt;br&gt; &lt;br&gt;
&lt;/div&gt;Regards,&lt;br&gt;
&lt;font color="#888888"&gt;Daniel&lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110124132926</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-01-24 13:29:26-0400</timestampReceived><subject>Re: [libvirt-users] git repository access via HTTPS</subject><body>

On Mon, Jan 24, 2011 at 03:20:47PM +0200, Fyodor Kupchik wrote:
&gt; still no luck with it :(
&gt; I precede git command by proxychains one since git does not respect any kind
&gt; of proxy settings (nor system wide or those I set via git config http.proxy)
&gt; and it only works  in such way.
&gt; ==============================================================================
&gt; ProxyChains-3.1 (http://proxychains.sf.net)
&gt; Initialized empty Git repository in
&gt; /home/teo/prj/archipel/Archipel/Libvirt/.gnulib/.git/
&gt; git.sv.gnu.org[0: 140.186.70.72]: errno=Connection refused
&gt; fatal: unable to connect a socket (Connection refused)
&gt; Clone of 'git://git.sv.gnu.org/gnulib.git' into submodule path '.gnulib'
&gt; failed
&gt; Failed to recurse into submodule path 'Libvirt'
&gt; Unable to initialize submodules

This shows that the initial libvirt checkover over HTTP worked
fine.  What in fact failed was the attempt to checkout the
GNULIB submodule, which is still using git:// protocol. I don't
believe there is any way to change the protocol used for submodules
during initial checkout.


Regards,
Daniel

</body></email><email><emailId>20110124142755</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-24 14:27:55-0400</timestampReceived><subject>Re: [libvirt-users] git repository access via HTTPS</subject><body>

On 24/01/2011, at 11:42 PM, Daniel P. Berrange wrote:
&lt;snip&gt;
&gt; Err, http:// access works fine with gitorious. I think
&gt; you simply didn't wait long enough. GIT's  HTTP access
&gt; mechanism is seriously inefficient, and doesn't appear
&gt; to give you ongoing progress feedback like the git://
&gt; protocol, so expect to wait a while. I've verified I
&gt; can clone the main GIT repo over http in about 2 minutes
&gt; using:
&gt; 
&gt; git clone http://git.gitorious.org/libvirt/libvirt.git


Thanks Daniel.  Tried http again (first time today) and this
time it worked:

  $ time git clone http://git.gitorious.org/libvirt/libvirt.git
  Cloning into libvirt...

  real	9m57.209s
  user	0m11.130s
  sys	0m5.670s
  $

~10 mins, but still, at least it worked.

For the gnulib submodule, I'm thinking it might be possible
to use a tarball as a workaround.

Fyodor, are you ok to try something?

If you can grab this tarball (41MB):

  http://justinclift.fedorapeople.org/gnulib_commit_2f41af65.tar.bz2

Extract it somewhere (ie /tmp/gnulib), then set the
GNULIB_SRCDIR environment variable to point to it prior to doing
the libvirt pieces.

  $ export GNULIB_SRCDIR=/tmp/gnulib
  $ git clone http://git.gitorious.org/libvirt/libvirt.git
  $ cd libvirt
  $ ./autogen.sh

That *might* work.  Not for sure, but probably worth trying.

+ Justin

</body></email><email><emailId>20110111174311</emailId><senderName></senderName><senderEmail>saint</senderEmail><timestampReceived>2011-01-11 17:43:11-0400</timestampReceived><subject>Re: [libvirt-users] livemigrate problems</subject><body>

&gt;&gt;&gt;&gt;&gt; "CC" == saint  &lt;saint@eng.it&gt; writes:

&gt;&gt;&gt;&gt;&gt; "CC" == saint  &lt;saint@eng.it&gt; writes:
CC&gt; I can livemigrate w/o problems between any two from red9, red10
CC&gt; and red11, I can livemigrate from either red9, red10 or red11 to
CC&gt; red3 but I can't livemigrate to any other blade from red3.

*wears the dunce cap*

It was  a damn line in  /etc/libvirt/libvirtd.conf, unix_sock_ro_perms
has to be left commented...

*takes a chalk... 1000 do not uncomment unix_sock_ro_perms in
 libvird.conf... 999 do not uncomment unix_sock_ro_perms ...*

--
ing. Gian Uberto Lauri
Ricercatore / Reasearcher
Divisione Ricerca ed Innovazione / Research &amp; Innovation Division
GianUberto.Lauri@eng.it

Engineering Ingegneria Informatica spa
Corso Stati Uniti 23/C, 35127 Padova (PD) 

Tel. +39-049.8283.538         | main(){printf(&amp;unix["\021%six\012\0"], 
Fax  +39-049.8283.569		  |    (unix)["have"]+"fun"-0x60);}   
Skype: gian.uberto.lauri	  |          David Korn, AT&amp;T Bell Labs             
http://www.eng.it 			  |          ioccc best One Liner, 1987             

</body></email><email><emailId>20110111215429</emailId><senderName>Matthias Meyer</senderName><senderEmail>matthias.meyer@gmx.li</senderEmail><timestampReceived>2011-01-11 21:54:29-0400</timestampReceived><subject>Re: [libvirt-users] Windows guest eats as many CPU as available</subject><body>

Am Montag 10 Januar 2011 schrieben Sie:
&gt; For me it eats 10-20%, and I was not able to lower that (linux uses 0%).
&gt; And if I am not mistaken, it eats 100% when you have chosen wrong ACPI
&gt; parameters in domain.xml.
&gt; Take a look at 
https://bugs.launchpad.net/ubuntu/+source/virt-manager/+bug/228442
&gt; 

I change my HAL from SMP to Standard-PC and now it works great.

Changing of HAL is descripted here:
http://www.linux-kvm.com/content/running-windows-smp-guests

Thanks,
Matthias
-- 
Don't Panic

</body></email><email><emailId>20110113141529</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-13 14:15:29-0400</timestampReceived><subject>Re: [libvirt-users] Problem with FreeBSD graceful shutdown</subject><body>

On 14/01/2011, at 12:45 AM, Nikita A Menkovich wrote:
&gt; Hello,
&gt; 
&gt; I have FreeBSD guest running with KVM+libvirt, when I send shutdown
&gt; through virsh for ex.
&gt; 
&gt; $ virsh shutdown freebsd
&gt; 
&gt; There is not any reaction from FreeBSD. Linux guests works together
&gt; with acpid daemon well.
&gt; devd in freebsd is running, and should work correct. Is there any way
&gt; to fix this
&gt; 
&gt; dumpxml config
&gt; http://pastebin.com/UGGgG894

Hi Nikita,

Just as a way to check what is wrong, is there a way to enable debugging
or logging of devd, to see if it is receiving the ACPI events?

I'm just thinking that "in theory", the virtual machine should be getting the
ACPI shutdown.  Checking if it really is or isn't would be a good way to
figure out which part of things is going wrong.

Regards and best wishes,

Justin Clift

</body></email><email><emailId>20110114034835</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-01-14 03:48:35-0400</timestampReceived><subject>Re: [libvirt-users] ERROR Unable to deny all devices for (solution)</subject><body>

于 2011年01月14日 02:19, Lucas Arbiza 写道:
&gt; Here is the URL:
&gt; http://blog.coderepository.net/2010/11/19/otimizando-o-kernel-de-seu-desktop-linux/
&gt;
Really can't understand Portuguese, :-)

But seems you hacked on cgroup, the error message you encounted with
the hacking is throwed when libvirt trying to setting up cgroup for
your guest, (it deny all devices first, and then allow some devices),
so that's why you saw the error message, "Unable to deny all devices..."
, think we need to improve the error, at least tell where it's from,
e.g.

"Cgroup: Unable to deny all devices ..."

Regards
Osier

</body></email><email><emailId>20110118114304</emailId><senderName>Scott Lerman</senderName><senderEmail>smlerman@gmail.com</senderEmail><timestampReceived>2011-01-18 11:43:04-0400</timestampReceived><subject>Re: [libvirt-users] Open virt-viewer with virsh start</subject><body>

Thanks for the reply. I thought about just putting the commands
together in a shell script, but I wasn't sure if the timing would work
with the VM being available right away. I'll try it out and see what
happens.

---
Scott Lerman



On Tue, Jan 18, 2011 at 1:01 AM, Justin Clift &lt;jclift@redhat.com&gt; wrote:
&gt; On 18/01/2011, at 1:42 PM, Scott Lerman wrote:
&gt; &gt; Is it possible to have virt-viewer come up when a domain is started
&gt; &gt; with virsh start, the same way that it does with virt-install?
&gt; 
&gt; I don't think so.  But, if you're reasonably familiar with shell scripting, you can \
&gt; could a simple script that does the "virsh start", then kicks off virt-viewer for \
&gt; it. 
&gt; Not exactly the same level of automatic-and-ready-to-go.  But quite doable.
&gt; 
&gt; That helpful at all?
&gt; 
&gt; Regards and best wishes,
&gt; 
&gt; Justin Clift
&gt; 
&gt; 


</body></email><email><emailId>20110118165037</emailId><senderName>Josiah Ritchie</senderName><senderEmail>josiah@fim.org</senderEmail><timestampReceived>2011-01-18 16:50:37-0400</timestampReceived><subject>Re: [libvirt-users] list mac or IP of all guests NICs?</subject><body>

Thanks Justin and Osier. I had searched for a leases file on the machine
before, but couldn't find it so thank you for pointing that out. I had
thought about installing nmap, but figured I had to have some better record
on the machine itself.

Thanks also for the tip on Rich's blog post. I found it at
http://rwmj.wordpress.com/2010/10/26/tip-find-the-ip-address-of-a-virtual-machine/

JSR/

On Tue, Jan 18, 2011 at 4:01 AM, Osier Yang &lt;jyang@redhat.com&gt; wrote:

&gt; 于 2011年01月18日 04:45, Josiah Ritchie 写道:
&gt;
&gt;  I'm trying to figure out how to use virsh (or something else) to list
&gt;&gt; all the IP addresses (or MAC addresses if needed) for each virtual NIC,
&gt;&gt; preferably with it domain affiliation also listed.
&gt;&gt;
&gt;&gt; Is this possible?
&gt;&gt;
&gt;&gt;
&gt; == method 1: (simple but not reliable)
&gt; # cat /var/lib/dnsmasq/dnsmasq.leases
&gt; 1295343272 52:54:00:6f:2e:72 192.168.122.118 * *
&gt;
&gt; == method 2:
&gt; # This script is to map MAC into IP, accepts two
&gt; # arguments, subnet prefix and MAC address of the
&gt; # interface.
&gt; #! /bin/bash
&gt;
&gt; if [ $# -ne 2 ]; then
&gt;    echo "Usage: $(basename $0) &lt;SUBNET&gt; &lt;MAC&gt;"
&gt;    exit 1
&gt; fi
&gt;
&gt; SUBNET=$1
&gt; MAC=$2
&gt;
&gt; rpm -q nmap &gt; /dev/NULL
&gt; if [ $? -ne 0 ]; then
&gt;    echo "You need install nmap"
&gt;    exit 1
&gt; fi
&gt;
&gt; if [[ -n $SUBNET ]]; then
&gt;   OUTPUT=$(nmap -sP -n $SUBNET | grep -i -B 2 $MAC)
&gt;   if [[ -n $OUTPUT ]]; then
&gt;      IP=$(echo $OUTPUT | sed -e 's/.*
&gt; \([0-9]*\.[0-9]*\.[0-9]*\.[0-9]*\).*/\1/')
&gt;   fi
&gt; fi
&gt;
&gt; echo $IP
&gt;
&gt; e.g. for a guest which use libvirt "default" network, get the subnet
&gt; like:
&gt; # ip route | grep "virbr0" | sed -n 1p | awk '{print $1}'
&gt;
&gt; you could write automate script to parse the MAC address of domain
&gt; interfaces, the bridge name, and the subnet prefix of bridge, and
&gt; then use the script above the get the IP.
&gt;
&gt; And as Justin said, Rich has more clever tool to do it, I also forgot,
&gt; you can wait him, :-)
&gt;
&gt; Regards
&gt; Osier
&gt;
&gt;  JSR/
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; libvirt-users mailing list
&gt;&gt; libvirt-users@redhat.com
&gt;&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

[Attachment #3 (text/html)]

Thanks Justin and Osier. I had searched for a leases file on the machine before, but \
couldn't find it so thank you for pointing that out. I had thought about \
installing nmap, but figured I had to have some better record on the machine \
itself.&lt;div&gt; &lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks also for the tip on Rich's blog post. I found \
it at  &lt;a href="http://rwmj.wordpress.com/2010/10/26/tip-find-the-ip-address-of-a-virt \
ual-machine/"&gt;http://rwmj.wordpress.com/2010/10/26/tip-find-the-ip-address-of-a-virtual-machine/&lt;/a&gt;&lt;/div&gt;
 &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;JSR/&lt;div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Tue, Jan 18, 2011 at \
4:01 AM, Osier Yang &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:jyang@redhat.com"&gt;jyang@redhat.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt; 于 2011年01月18日 04:45, Josiah Ritchie \
写道:&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;&lt;br&gt; &lt;blockquote class="gmail_quote" \
style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"&gt; I'm trying \
to figure out how to use virsh (or something else) to list&lt;br&gt; all the IP addresses \
(or MAC addresses if needed) for each virtual NIC,&lt;br&gt; preferably with it domain \
affiliation also listed.&lt;br&gt; &lt;br&gt;
Is this possible?&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;
&lt;br&gt;&lt;/div&gt;&lt;/div&gt;
== method 1: (simple but not reliable)&lt;br&gt;
# cat /var/lib/dnsmasq/dnsmasq.leases&lt;br&gt;
1295343272 52:54:00:6f:2e:72 192.168.122.118 * *&lt;br&gt;
&lt;br&gt;
== method 2:&lt;br&gt;
# This script is to map MAC into IP, accepts two&lt;br&gt;
# arguments, subnet prefix and MAC address of the&lt;br&gt;
# interface.&lt;br&gt;
#! /bin/bash&lt;br&gt;
&lt;br&gt;
if [ $# -ne 2 ]; then&lt;br&gt;
      echo "Usage: $(basename $0) &lt;SUBNET&gt; &lt;MAC&gt;"&lt;br&gt;
      exit 1&lt;br&gt;
fi&lt;br&gt;
&lt;br&gt;
SUBNET=$1&lt;br&gt;
MAC=$2&lt;br&gt;
&lt;br&gt;
rpm -q nmap &gt; /dev/NULL&lt;br&gt;
if [ $? -ne 0 ]; then&lt;br&gt;
      echo "You need install nmap"&lt;br&gt;
      exit 1&lt;br&gt;
fi&lt;br&gt;
&lt;br&gt;
if [[ -n $SUBNET ]]; then&lt;br&gt;
    OUTPUT=$(nmap -sP -n $SUBNET | grep -i -B 2 $MAC)&lt;br&gt;
    if [[ -n $OUTPUT ]]; then&lt;br&gt;
         IP=$(echo $OUTPUT | sed -e 's/.* \
\([0-9]*\.[0-9]*\.[0-9]*\.[0-9]*\).*/\1/')&lt;br&gt;  fi&lt;br&gt;
fi&lt;br&gt;
&lt;br&gt;
echo $IP&lt;br&gt;
&lt;br&gt;
e.g. for a guest which use libvirt "default" network, get the subnet&lt;br&gt;
like:&lt;br&gt;
# ip route | grep "virbr0" | sed -n 1p | awk '{print $1}'&lt;br&gt;
&lt;br&gt;
you could write automate script to parse the MAC address of domain&lt;br&gt;
interfaces, the bridge name, and the subnet prefix of bridge, and&lt;br&gt;
then use the script above the get the IP.&lt;br&gt;
&lt;br&gt;
And as Justin said, Rich has more clever tool to do it, I also forgot,&lt;br&gt;
you can wait him, :-)&lt;br&gt;
&lt;br&gt;
Regards&lt;br&gt;
Osier&lt;br&gt;
&lt;br&gt;
&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex"&gt; JSR/&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
_______________________________________________&lt;br&gt;
libvirt-users mailing list&lt;br&gt;
&lt;a href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt; &lt;a \
href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; \
&lt;/blockquote&gt; &lt;br&gt;
_______________________________________________&lt;br&gt;
libvirt-users mailing list&lt;br&gt;
&lt;a href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt; &lt;a \
href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;




</body></email><email><emailId>20110118190608</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-18 19:06:08-0400</timestampReceived><subject>[libvirt-users] Libvirt Windows 0.8.7 installer available</subject><body>

Hi all,

The Libvirt 0.8.7 installer for Windows is now available online:

 http://libvirt.org/sources/win32_experimental/Libvirt-0.8.7-2.exe

Changes for this release include:

+ VirtualBox support on Windows, as added to the main Libvirt
   0.8.7 release.

   I haven't personally tested this yet, so if someone has the time to
   test and report/confirm it's working, that would be really helpful.

+ There is now an option to update the system PATH with the
   libvirt binaries location, so they don't have to be copied around
   if you're using the .dlls elsewhere.

+ The README text has been tweaked to be less confusing for
   vSphere ESX users reading about TLS certificates

All thoughts and feedback are welcome. :)

Regards and best wishes,

Justin Clift

</body></email><email><emailId>20110119013300</emailId><senderName>John Paul Walters</senderName><senderEmail>jwalters@isi.edu</senderEmail><timestampReceived>2011-01-19 01:33:00-0400</timestampReceived><subject>Re: [libvirt-users] host to VM serial device configuration</subject><body>


On Tue, 2011-01-18 at 04:13 -0600, Igor Serebryany wrote:
&gt; Hey John, 
&gt; 
&gt; 	If I understand correctly, you are trying to get access to the
&gt; 	character device after you've created the domain. The exact device
&gt; 	is auto-assigned when the VM is created, but you can get the correct
&gt; 	device from the domain XML after the domain is running.
&gt; 	
&gt; 	I use 'type=pty' in my domain definition XML. I then extract the
&gt; 	device that was assigned to the domain using the following bit of
&gt; 	python:
&gt; 
&gt; 	import xml.etree.cElementTree as etree
&gt; 	xml = etree.fromstring(myDomainObject.XMLDesc(0))
&gt; 	tty = xml.find('devices').find('console').attrib['tty']
&gt; 
&gt; 	Hope this helps!
&gt; 
&gt; --Igor
&gt; 

Thanks Igor, that works perfectly.

best,
JP

</body></email><email><emailId>20110119180028</emailId><senderName>Peter Phaal</senderName><senderEmail>peter.phaal@gmail.com</senderEmail><timestampReceived>2011-01-19 18:00:28-0400</timestampReceived><subject>Re: [libvirt-users] Getting CPU and memory usage statistics for the host</subject><body>

If your client application is being written in C, you might want to
take a look at the Host sFlow source code:

http://host-sflow.sourceforge.net/

The Host sFlow agent locally polls counters using libvirt and then
exports them using the sFlow protocol.

You might want to think about adding sFlow support to your
application. Passively receiving the counters over UDP is simpler and
more scalable than counter polling. You can also use sFlow to monitor
the physical server statistics and traffic through the virtual switch
to get a complete picture of performance.

http://blog.sflow.com/2010/10/sflowtrend-adds-server-performance.html



On Wed, Jan 19, 2011 at 8:18 AM, Guido Winkelmann
&lt;guido-libvi@unknownsite.de&gt; wrote:
&gt; Hi,
&gt;
&gt; I have noticed that virt-manager has the ability to show me the current cpu- and
&gt; memory-usage of both the host and running guest machines.
&gt;
&gt; How does it do that?
&gt;
&gt; I could make good use of that information myself in the client applications I'm
&gt; writing, however, from what I can see on
&gt; http://libvirt.org/html/libvirt-libvirt.html, I have no idea how to go about
&gt; getting it from libvirt. In fact, before I've seen virt-manager, I just assumed
&gt; libvirt cannot do that at all, and was planning to manually ssh to the host and
&gt; read statistics from /proc when I'd need them.
&gt;
&gt; I've tried looking at the virt-manager source code to find out how to do this,
&gt; but it appears I would have to learn Python first in order to understand it.
&gt;
&gt; Could someone please give me some pointers?
&gt;
&gt; Regards,
&gt;
&gt;        Guido
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

</body></email><email><emailId>20110120031456</emailId><senderName>Hongqing Yang</senderName><senderEmail>hoyang@redhat.com</senderEmail><timestampReceived>2011-01-20 03:14:56-0400</timestampReceived><subject>Re: [libvirt-users] virt-install with --channel option inquiry</subject><body>

one more thing, when I ran the script below:
virt-install \
  --connect qemu:///system \
  --virt-type kvm \
  --name mydemo \
  --ram 600 \
  --disk  path=/var/lib/libvirt/images/mydemo.img,size=10,sparse=true \
  --accelerate \
  --location ftp://download.englab.nay.redhat.com/pub/fedora/linux/releases/14/Fedora/x86_64/os/ \
                \
  --os-variant fedora14 \
  --channel tcp,host=127.0.0.1:6080,target_type=virtio,name='org.fedoraproject.anaconda.log.0'
 it gives me error:
ERROR    internal error Process exited while reading console log output: char device \
                redirected to /dev/pts/35
inet_listen_opts: bind(ipv4,127.0.0.1,6080): Address already in use
inet_listen_opts: FAILED
chardev: opening backend "socket" failed

if I specify mode=connect, it will work. but according the man page, the default mode \
is connect.

----- Original Message -----
From: "Hongqing Yang" &lt;hoyang@redhat.com&gt;
To: "Osier Yang" &lt;jyang@redhat.com&gt;
Cc: libvirt-users@redhat.com
Sent: Thursday, January 20, 2011 11:03:12 AM
Subject: Re: [libvirt-users] virt-install with --channel option inquiry

I tried again, yes, adding comma is the best manner, if there is no comma between 
target_type and name, org.fedoraproject.anaconda.log.0 will disappear from the guest \
xml file.


----- Original Message -----
From: "Hongqing Yang" &lt;hoyang@redhat.com&gt;
To: "Osier Yang" &lt;jyang@redhat.com&gt;
Cc: libvirt-users@redhat.com
Sent: Thursday, January 20, 2011 10:48:55 AM
Subject: Re: [libvirt-users] virt-install with --channel option inquiry

Osier,
Thanks for ur reply, it works now.
the place need comma is after tcp  as --channel tcp,host=...
Thanks again

Hongqing

----- Original Message -----
From: "Osier Yang" &lt;jyang@redhat.com&gt;
To: libvirt-users@redhat.com
Sent: Thursday, January 20, 2011 10:33:38 AM
Subject: Re: [libvirt-users] virt-install with --channel option inquiry

于 2011年01月17日 18:51, Hongqing Yang 写道:
&gt; hi, virt guys,
&gt; This is Hongqing from Fedroa QA team. I try to forward the guest installation logs \
&gt; to host with virtio. I have used virsh edit&lt;guestName&gt;  to add a channel, it works \
&gt; fine. I think it would be better if I can initialize it when I create the guest \
&gt; using virt-install, and virt-install also offers the option, I have tried  below, \
&gt; but it does not work. virt-install
&gt; --connect qemu:///system \
&gt; --virt-type kvm \
&gt; --name demo2 \
&gt; --ram 500 \
&gt; --disk  path=/home/hongqing/testscript/demo2.img,size=10,sparse=true \
&gt; --accelerate \
&gt; --cdrom  /home/hongqing/fedora/Fedora-14-x86_64-DVD.iso \
&gt; --channel tcp host=127.0.0.1:6080  mode=connect target_type=virtio \
&gt; name=org.fedoraproject.anaconda.log.0 
&gt; error message is :
&gt; ERROR    internal error Process exited while reading console log output: char \
&gt; device redirected to /dev/pts/20 getaddrinfo(127.0.0.1,None): Servname not \
&gt;                 supported for ai_socktype
&gt; chardev: opening backend "socket" failed
&gt; 
&gt; both the host and guest are fedaora 14.
&gt; I have checked the service syslog with port 6080 is listening. and also I have \
&gt; disabled the SElinux. Do you have any idea about this? Thanks for taking time to \
&gt; view it. 
&gt; Hongqing YANG
&gt; 

--channel SOURCE,target_type=guestfwd,target_address=HOST:PORT

use "," to seperate, but I guess virt-manager could have a more
robust option parsing method, e.g, report error early before doing
the installation for your case.

Regards
Osier
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

_______________________________________________
libvirt-users mailing list
libvirt-users@redhat.com
https://www.redhat.com/mailman/listinfo/libvirt-users

_______________________________________________
libvirt-users mailing list
libvirt-users@redhat.com
https://www.redhat.com/mailman/listinfo/libvirt-users

_______________________________________________
libvirt-users mailing list
libvirt-users@redhat.com
https://www.redhat.com/mailman/listinfo/libvirt-users


</body></email><email><emailId>20110120071038</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2011-01-20 07:10:38-0400</timestampReceived><subject>Re: [libvirt-users] Python Bindings for Python 2.7</subject><body>

On Thu, Jan 20, 2011 at 10:59:40AM +0530, vipul borikar wrote:
&gt; Thanks for the Reply Matthias.
&gt; 
&gt; The  ./configure --with-python=/opt/Python2.7  worked.
&gt; 
&gt; But when i do make I go this error related with sax parser.
&gt; 
&gt; 
&gt; 
&gt; make[3]: Entering directory `/root/libvirt-0.8.4/python'
&gt; /opt/Python-2.7//bin/python ./generator.py .
&gt; Traceback (most recent call last):
&gt;   File "./generator.py", line 1447, in &lt;module&gt;
&gt;     if buildStubs() &lt; 0:
&gt;   File "./generator.py", line 567, in buildStubs
&gt;     (parser, target)  = getparser()
&gt;   File "./generator.py", line 35, in getparser
&gt;     parser = xml.sax.make_parser()
&gt;   File
&gt; "/opt/Python-2.7/lib/python2.7/site-packages/_xmlplus/sax/sax2exts.py", line
&gt; 37, in make_parser
&gt;     return XMLParserFactory.make_parser(parser_list)
&gt;   File
&gt; "/opt/Python-2.7/lib/python2.7/site-packages/_xmlplus/sax/saxexts.py", line
&gt; 75, in make_parser
&gt;     sys.modules[parser_name].create_parser = _create_parser
[...]
&gt; &gt; &gt; I have python 2.4 rpm installed but i dont use it. I use Python 2.7
&gt; &gt; source
&gt; &gt; &gt; compiled version.

  seems your hand compiled version of python has a problem and
lacks XML/expat support. Unrelated to libvirt, Fedora uses Python
2.7 and I have no problem with it.

Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

</body></email><email><emailId>20110124114033</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-01-24 11:40:33-0400</timestampReceived><subject>Re: [libvirt-users] Cgroup</subject><body>

On Sun, Jan 23, 2011 at 05:38:33PM +0300, Nikita A Menkovich wrote:
&gt; Hello,
&gt; 
&gt; I'm running Debian Sid with libvirt/qemu/kvm packages from experimental:
&gt; $ qemu --version
&gt; QEMU emulator version 0.13.0 (Debian 0.13.0+dfsg-2), Copyright (c)
&gt; 2003-2008 Fabrice Bellard
&gt; $ kvm --version
&gt; QEMU emulator version 0.13.0 (qemu-kvm-0.13.0 Debian 0.13.0+dfsg-2),
&gt; Copyright (c) 2003-2008 Fabrice Bellard
&gt; $ libvirtd --version
&gt; libvirtd (libvirt) 0.8.6
&gt; 
&gt; /etc/libvirt/qemu.conf
&gt; cgroup_controllers = [ "cpu", "devices" ]
&gt; cgroup_device_acl = [
&gt;     "/dev/null", "/dev/full", "/dev/zero",
&gt;     "/dev/random", "/dev/urandom",
&gt;     "/dev/ptmx", "/dev/kvm", "/dev/kqemu",
&gt;     "/dev/rtc", "/dev/hpet", "/dev/net/tun",
&gt; ]
&gt; /etc/cgconfig.conf
&gt; mount {
&gt; 	cpu = /dev/cgroup/cpu;
&gt; 	cpuacct = /dev/cgroup/cpuacct;
&gt; 	devices = /dev/cgroup/devices;
&gt; #	memory  = /dev/cgroup/memory;
&gt; 	blkio   = /dev/cgroup/blkio;
&gt; }
&gt; When I'm running virsh, and want to change cpu shares I receive an error
&gt; virsh # schedinfo --set cpu.shares=2048 test
&gt; Scheduler      : posix
&gt; error: internal error cannot find cgroup for domain test
&gt; Really I didn't have any group test in
&gt; $ ls /dev/cgroup/cpu/sysdefault/libvirt/qemu/
&gt; cgroup.clone_children  cgroup.event_control  cgroup.procs  cpu.shares
&gt; notify_on_release  tasks
&gt; 
&gt; It happens if I run libvirt as usual user, how can I grant access to
&gt; create cgroup to ordinary user?

When run libvirt will create cgroups under whichever group it was
in when it was started. Out of the box this will only work for
libvirt run as root, because the 'sysdefault' cgroup is readonly
for non-root users. You need to configure things such that your
user login is given a dedicated cgroup + ownership on that cgroup
to let it do 'mkdir' while non-root.

Daniel

</body></email><email><emailId>20110124151311</emailId><senderName>Frederic SOULIER</senderName><senderEmail>frederic.soulier@univ-tlse1.fr</senderEmail><timestampReceived>2011-01-24 15:13:11-0400</timestampReceived><subject>Re: [libvirt-users] libvirt and shared storage SAN Fiber Channel</subject><body>

Hi,

is anyone using libvirt with SAN Fiber Channel storage and multiple hosts ?

is rhcs and gfs the only reliable solution ?

i will test rhel 6 with one LUN shared by two hosts and try to make a 
libvirt-pool on it.
is libvirt-pool and libvirt-volume "metdata" stored on the physical disk 
like with LVM ?
Can anyone explain or point me to the info which explain how libvirt is 
used in multi hosted environment ?

Thanks for tour help.

Regards


On 11/01/2011 21:30, Frederic SOULIER wrote:
&gt; Hi,
&gt;
&gt; I'm looking information about using libvirt with san (fiber channel) 
&gt; based storage and googling for a while i don't see anything about it.
&gt; I send this email in order to get advices about libvirt and shared 
&gt; storage
&gt;
&gt; We use here, for 3 years now, 8 linux centos server connected to an 
&gt; hitachi FC SAN (multipath devices).
&gt; Each server run Xen dom0 and use SAN LUNs to store Virtual machine 
&gt; filesystem ( basically one LUN per VM).
&gt; For each LUN we create an LVM VolGroup. On each VolGroup we create 
&gt; Logical volumes (one for swap, one for root filesystem).
&gt; We present to the vm the 2 Logical Volume as it was raw disk.
&gt; In this system we can make live migration between host using local 
&gt; scripts which assume than one VolumeGroup is used only by one host at 
&gt; the same time on the 8 node "cluster". We don't use any clustered 
&gt; aware environment like CLVM.
&gt;
&gt; We plan to migrate to kvm and libvirt with the new centos release 
&gt; (CentOS 6).
&gt; Reading the upstream documentation and libvirt i don't find anything 
&gt; about using libvirt with san storage except for iscsi.
&gt; Do you have any link or idea about using kvm + libvirt + SAN FC 
&gt; storage that permit to make live migration between node (we think 
&gt; about RHCS with GFS2 but it seems very complex to set up) ?
&gt;
&gt; Do you think i can use the LUN's SAN as local storage on each node. 
&gt; For each LUN create an LVM Volume Group (same on each node, like that 
&gt; we doing now with xen) and use it as volume pool in libvirt.
&gt; Is volume pool in libvirt is 'cluster aware' (Can i access it 
&gt; simultaneously from different node) ?
&gt;
&gt; I'm beginner in kvm so any advice will be great.
&gt;
&gt; regards
&gt;


-- 
Frederic Soulier

DSI / Service Système
Université Toulouse 1 Capitole
2 rue du doyen Gabriel Marty
31 042 Toulouse Cedex 9
Tel: +33 5 61 63 39 98 Fax: +33 5 61 63 37 98


</body></email><email><emailId>20110124153415</emailId><senderName>Fyodor Kupchik</senderName><senderEmail>ferimy@gmail.com</senderEmail><timestampReceived>2011-01-24 15:34:15-0400</timestampReceived><subject>Re: [libvirt-users] git repository access via HTTPS</subject><body>

Unfortunately that didn't work (i mean the tarball download/unpack and
exporting env var)... I can make it to work as the installation is described
by several simple python scripts but this is not right solution.

Thank you guys for help, it seems to me that the only way is to ask our
sysadmins to open git ports for several opensource git repositories. I hope
they won't refuse.

Thank you again!

2011/1/24 Justin Clift &lt;jclift@redhat.com&gt;

&gt; On 24/01/2011, at 11:42 PM, Daniel P. Berrange wrote:
&gt; &lt;snip&gt;
&gt; &gt; Err, http:// access works fine with gitorious. I think
&gt; &gt; you simply didn't wait long enough. GIT's  HTTP access
&gt; &gt; mechanism is seriously inefficient, and doesn't appear
&gt; &gt; to give you ongoing progress feedback like the git://
&gt; &gt; protocol, so expect to wait a while. I've verified I
&gt; &gt; can clone the main GIT repo over http in about 2 minutes
&gt; &gt; using:
&gt; &gt;
&gt; &gt; git clone http://git.gitorious.org/libvirt/libvirt.git
&gt;
&gt;
&gt; Thanks Daniel.  Tried http again (first time today) and this
&gt; time it worked:
&gt;
&gt;  $ time git clone http://git.gitorious.org/libvirt/libvirt.git
&gt;  Cloning into libvirt...
&gt;
&gt;  real  9m57.209s
&gt;  user  0m11.130s
&gt;  sys   0m5.670s
&gt;  $
&gt;
&gt; ~10 mins, but still, at least it worked.
&gt;
&gt; For the gnulib submodule, I'm thinking it might be possible
&gt; to use a tarball as a workaround.
&gt;
&gt; Fyodor, are you ok to try something?
&gt;
&gt; If you can grab this tarball (41MB):
&gt;
&gt;  http://justinclift.fedorapeople.org/gnulib_commit_2f41af65.tar.bz2
&gt;
&gt; Extract it somewhere (ie /tmp/gnulib), then set the
&gt; GNULIB_SRCDIR environment variable to point to it prior to doing
&gt; the libvirt pieces.
&gt;
&gt;  $ export GNULIB_SRCDIR=/tmp/gnulib
&gt;  $ git clone http://git.gitorious.org/libvirt/libvirt.git
&gt;  $ cd libvirt
&gt;  $ ./autogen.sh
&gt;
&gt; That *might* work.  Not for sure, but probably worth trying.
&gt;
&gt; + Justin
&gt;

[Attachment #3 (text/html)]

&lt;meta http-equiv="content-type" content="text/html; charset=utf-8"&gt;Unfortunately that \
didn't work (i mean the tarball download/unpack and exporting env var)... I can \
make it to work as the installation is described by several simple python scripts but \
this is not right solution.&lt;div&gt; &lt;br&gt;&lt;/div&gt;&lt;div&gt;Thank you guys for help, it seems to \
me that the only way is to ask our sysadmins to open git ports for several opensource \
git repositories. I hope they won't refuse.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thank you \
again!&lt;/div&gt; &lt;br&gt;&lt;div class="gmail_quote"&gt;2011/1/24 Justin Clift &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:jclift@redhat.com"&gt;jclift@redhat.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt; On 24/01/2011, at 11:42 PM, Daniel P. Berrange wrote:&lt;br&gt;
&lt;snip&gt;&lt;br&gt;
&lt;div class="im"&gt;&gt; Err, http:// access works fine with gitorious. I think&lt;br&gt;
&gt; you simply didn't wait long enough. GIT's   HTTP access&lt;br&gt;
&gt; mechanism is seriously inefficient, and doesn't appear&lt;br&gt;
&gt; to give you ongoing progress feedback like the git://&lt;br&gt;
&gt; protocol, so expect to wait a while. I've verified I&lt;br&gt;
&gt; can clone the main GIT repo over http in about 2 minutes&lt;br&gt;
&gt; using:&lt;br&gt;
&gt;&lt;br&gt;
&gt; git clone &lt;a href="http://git.gitorious.org/libvirt/libvirt.git" \
target="_blank"&gt;http://git.gitorious.org/libvirt/libvirt.git&lt;/a&gt;&lt;br&gt; &lt;br&gt;
&lt;br&gt;
&lt;/div&gt;Thanks Daniel.   Tried http again (first time today) and this&lt;br&gt;
time it worked:&lt;br&gt;
&lt;br&gt;
   $ time git clone &lt;a href="http://git.gitorious.org/libvirt/libvirt.git" \
target="_blank"&gt;http://git.gitorious.org/libvirt/libvirt.git&lt;/a&gt;&lt;br&gt;  Cloning into \
libvirt...&lt;br&gt; &lt;br&gt;
   real   9m57.209s&lt;br&gt;
   user   0m11.130s&lt;br&gt;
   sys    0m5.670s&lt;br&gt;
   $&lt;br&gt;
&lt;br&gt;
~10 mins, but still, at least it worked.&lt;br&gt;
&lt;br&gt;
For the gnulib submodule, I'm thinking it might be possible&lt;br&gt;
to use a tarball as a workaround.&lt;br&gt;
&lt;br&gt;
Fyodor, are you ok to try something?&lt;br&gt;
&lt;br&gt;
If you can grab this tarball (41MB):&lt;br&gt;
&lt;br&gt;
   &lt;a href="http://justinclift.fedorapeople.org/gnulib_commit_2f41af65.tar.bz2" \
target="_blank"&gt;http://justinclift.fedorapeople.org/gnulib_commit_2f41af65.tar.bz2&lt;/a&gt;&lt;br&gt;
 &lt;br&gt;
Extract it somewhere (ie /tmp/gnulib), then set the&lt;br&gt;
GNULIB_SRCDIR environment variable to point to it prior to doing&lt;br&gt;
the libvirt pieces.&lt;br&gt;
&lt;br&gt;
   $ export GNULIB_SRCDIR=/tmp/gnulib&lt;br&gt;
   $ git clone &lt;a href="http://git.gitorious.org/libvirt/libvirt.git" \
target="_blank"&gt;http://git.gitorious.org/libvirt/libvirt.git&lt;/a&gt;&lt;br&gt;  $ cd \
libvirt&lt;br&gt;  $ ./autogen.sh&lt;br&gt;
&lt;br&gt;
That *might* work.   Not for sure, but probably worth trying.&lt;br&gt;
&lt;font color="#888888"&gt;&lt;br&gt;
+ Justin&lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110126071255</emailId><senderName>Igor Serebryany</senderName><senderEmail>igor47@moomers.org</senderEmail><timestampReceived>2011-01-26 07:12:55-0400</timestampReceived><subject>Re: [libvirt-users] invalid argument error when using cache parameter</subject><body>


On Mon, Jan 24, 2011 at 11:26:36AM +0000, Daniel P. Berrange wrote:
&gt; What filesystem type is /vms ?  I've seen this error message when
&gt; the filesystem did not support O_DIRECT, which cache=none enables

yup, that was the exact culprit -- /vms is a FUSE-mounted FS which
doesn't support O_DIRECT. thanks!

--igor

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20110127024109</emailId><senderName>Oliver Schneider</senderName><senderEmail>borbarad@gmxpro.net</senderEmail><timestampReceived>2011-01-27 02:41:09-0400</timestampReceived><subject>[libvirt-users] Is there a way to suppress netfilter rules (default.xml)?</subject><body>

Hi,

in order to get hook scripts to work, I used a backported version of
libvirtd on Ubuntu 10.04 LTS. Here are the details:

Compiled against library: libvir 0.8.3
Using library: libvir 0.8.3
Using API: QEMU 0.8.3
Running hypervisor: QEMU 0.12.5

After adjusting the apparmor profile to accept the hook scripts under
/etc/libvirt/hooks/, I am able to start and stop domains again, but only
the script named "daemon" gets executed, the one named "qemu" gets
ignored. All my domains are KVM domains. I thought the "qemu" script
should apply to that?!

My actual goal is to suppress the rules or better yet execute my own
script (in order to amend or replace the libvirt rules) after insertion
of the "default" rules during startup of the daemon. The reason being
that I need to do some PNAT and other custom handling ...

So far I have not been able to catch the state where the bridge has
already been created and the rules inserted. Thus I've had to manipulate
the firewall rules manually (well, still scripted ;)) after booting the
host.

Any ideas?


Thanks,

// Oliver

PS: Side-note, I tried using the newfilter facilities, but there seems
to be no way to insert rules at the start of a chain and similar things.
PPS: # cat /etc/libvirt/qemu/networks/default.xml
&lt;network&gt;
  &lt;name&gt;default&lt;/name&gt;
  &lt;bridge name="virbr%d" /&gt;
  &lt;forward/&gt;
  &lt;ip address="192.168.122.1" netmask="255.255.255.0" /&gt;
&lt;/network&gt;

</body></email><email><emailId>20110127061649</emailId><senderName>joe fu</senderName><senderEmail>joefuu10@gmail.com</senderEmail><timestampReceived>2011-01-27 06:16:49-0400</timestampReceived><subject>Re: [libvirt-users] Allocating Sockets Cores and Threads.</subject><body>

Hi justin,

I guess I'm too late. Thanks for the response anyway. So, let me
getinto thepoint right away.

 +What's the virtualisation host you're trying this out on?

KVM.

 +Which version of libvirt is it running?

Compiled against library: libvir 0.8.3
Using library: libvir 0.8.3
Using API: QEMU 0.8.3
Running hypervisor: QEMU 0.9.1


 + What guest OS's have you tried with?

Debian (Lenny) AMD64.

Thanks,
Joe

On Thu, Jan 20, 2011 at 11:34 AM, Justin Clift &lt;jclift@redhat.com&gt; wrote:

&gt; On 18/01/2011, at 9:25 PM, joe fu wrote:
&gt; &gt; I'm checked out my /proc/cpuinfo file and I'm finding the following
&gt; changes.
&gt; &gt;
&gt; &gt; Physical ID : 0
&gt; &gt; Siblings : 1
&gt; &gt; core id :0
&gt; &gt; cpu cores :1
&gt; &gt; apicid :0
&gt; &gt; initial apicid:0
&gt; &gt;
&gt; &gt; This is what I noticed when I edited the vm with this ...
&gt; &gt; &lt;cpu&gt;
&gt; &gt;     &lt;topology sockets='1' cores='2' threads='4'/&gt;
&gt; &gt;  &lt;/cpu&gt;
&gt;
&gt; Hi Joe,
&gt;
&gt; Looking at the same part of the XML description as you did:
&gt;
&gt;  http://libvirt.org/formatdomain.html#elementsCPU
&gt;
&gt; You're right, in that it shows we have some kind of capacity to process
&gt; that info.
&gt;
&gt; Some questions that might help us find the answer:
&gt;
&gt;  + What's the virtualisation host you're trying this out on?
&gt;
&gt;     i.e. KVM/Xen/vSphere/ESX/VirtualBox/etc
&gt;
&gt;  + Which version of libvirt is it running?
&gt;
&gt;  + What guest OS's have you tried with?
&gt;
&gt; Regards and best wishes,
&gt;
&gt; Justin Clift

[Attachment #3 (text/html)]

Hi justin,&lt;br&gt;&lt;br&gt;I guess I'm too late. Thanks for &lt;span class="il"&gt;the&lt;/span&gt; \
response anyway. So, let me getinto &lt;span class="il"&gt;the&lt;/span&gt; point right \
away.&lt;br&gt;&lt;br&gt; +What's &lt;span class="il"&gt;the&lt;/span&gt; virtualisation host &lt;span \
class="il"&gt;you&lt;/span&gt;'re trying this out on?&lt;br&gt; &lt;br&gt;KVM.&lt;br&gt;&lt;br&gt; +Which version \
&lt;span class="il"&gt;of&lt;/span&gt; libvirt is it running? &lt;br&gt; &lt;br&gt;Compiled against library: \
libvir 0.8.3&lt;br&gt;Using library: libvir 0.8.3&lt;br&gt;Using API: QEMU 0.8.3&lt;br&gt;Running \
hypervisor: QEMU 0.9.1&lt;div class="im"&gt;&lt;br&gt;&lt;br&gt; + What guest OS's have &lt;span \
class="il"&gt;you&lt;/span&gt; tried with?&lt;br&gt; &lt;br&gt;&lt;/div&gt;Debian (Lenny) \
AMD64.&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;&lt;font color="#888888"&gt; Joe&lt;/font&gt;&lt;br&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;On Thu, Jan 20, 2011 at 11:34 AM, Justin Clift &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:jclift@redhat.com"&gt;jclift@redhat.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="border-left: 1px solid rgb(204, 204, \
204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;"&gt; &lt;div class="im"&gt;On 18/01/2011, \
at 9:25 PM, joe fu wrote:&lt;br&gt; &gt; I'm checked out my /proc/cpuinfo file and \
I'm finding the following changes.&lt;br&gt; &gt;&lt;br&gt;
&gt; Physical ID : 0&lt;br&gt;
&gt; Siblings : 1&lt;br&gt;
&gt; core id :0&lt;br&gt;
&gt; cpu cores :1&lt;br&gt;
&gt; apicid :0&lt;br&gt;
&gt; initial apicid:0&lt;br&gt;
&gt;&lt;br&gt;
&gt; This is what I noticed when I edited the vm with this ...&lt;br&gt;
&gt; &lt;cpu&gt;&lt;br&gt;
&gt;     &lt;topology sockets='1' cores='2' \
threads='4'/&gt;&lt;br&gt; &gt;  &lt;/cpu&gt;&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;Hi Joe,&lt;br&gt;
&lt;br&gt;
Looking at the same part of the XML description as you did:&lt;br&gt;
&lt;br&gt;
  &lt;a href="http://libvirt.org/formatdomain.html#elementsCPU" \
target="_blank"&gt;http://libvirt.org/formatdomain.html#elementsCPU&lt;/a&gt;&lt;br&gt; &lt;br&gt;
You're right, in that it shows we have some kind of capacity to process that \
info.&lt;br&gt; &lt;br&gt;
Some questions that might help us find the answer:&lt;br&gt;
&lt;br&gt;
 + What's the virtualisation host you're trying this out on?&lt;br&gt;
&lt;br&gt;
     i.e. KVM/Xen/vSphere/ESX/VirtualBox/etc&lt;br&gt;
&lt;br&gt;
 + Which version of libvirt is it running?&lt;br&gt;
&lt;br&gt;
 + What guest OS's have you tried with?&lt;br&gt;
&lt;br&gt;
Regards and best wishes,&lt;br&gt;
&lt;font color="#888888"&gt;&lt;br&gt;
Justin Clift&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110128105329</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-01-28 10:53:29-0400</timestampReceived><subject>Re: [libvirt-users] multi-user libvirt / virsh?</subject><body>

On Thu, Jan 27, 2011 at 09:20:24PM +0100, Tomasz Chmielewski wrote:
&gt; I was wondering if libvirt / virsh was designed for multi-user environments.
&gt; 
&gt; I.e. I was thinking of the "roles", i.e. root would be able to do
&gt; everything, but regular users would only be able to
&gt; stop/start/suspend, or use vnc with the virtual machines which
&gt; belong to them.
&gt; 
&gt; Is it possible with libvirt / virsh? If not, are there any other
&gt; options to achieve it?

Not yet, but it is one of the features we would like to develop
in the future.

Daniel

</body></email><email><emailId>20110128110708</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-01-28 11:07:08-0400</timestampReceived><subject>Re: [libvirt-users] libvirtd + vir-manager + kerberos</subject><body>

On Fri, Jan 28, 2011 at 12:59:28AM +0100, Thomas Schweikle wrote:
&gt; Hi!
&gt; 
&gt; Having two hosts installed with libvirtd, kvm, qemu on (Ubuntu
&gt; 10.10). Now I have one big problem and one less:
&gt; 
&gt; I have set up kerberos for both hosts. Created the principal
&gt; "libvirt/srv1.example.org@EXAMPLE.ORG" and
&gt; "libvirt/srv2.example.org@EXAMPLE.ORG", Exported the krb5.keytab,
&gt; Installed it and tested the servers:
&gt; 
&gt; srv1.example.org: I can connect using kerberos after acquiring a
&gt; ticket with kinit.
&gt; 
&gt; srv2.example.org: I am asked for user and password. Setup seems to
&gt; be identical. Is there a way to debug, what is going on on this
&gt; server? I'd like to have both respect kerberos and allow logging in
&gt; with no password it already authenticated!
&gt; 
&gt; Here is what I've set up:
&gt; /etc/sasl2/libvirt.conf
&gt; listen_tls = 0
&gt; listen_tcp = 1
&gt; mdns_adv = 0
&gt; auth_unix_ro = "none"
&gt; auth_unix_rw = "none"
&gt; auth_tcp = "sasl"
&gt; 
&gt; /etc/sasl2/libvirt.conf
&gt; mech_list: gssapi
&gt; keytab: /etc/libvirt/krb5.kqemu
&gt; sasldb_path: /etc/libvirt/passwd.db
&gt; 
&gt; I start libvirtd with:
&gt; KRB5_KTNAME=/etc/libvirt/krb5.kqemu
&gt; /usr/sbin/libvirtd -d --listen
&gt; 
&gt; In virt-manager I've set both hosts:
&gt; qemu+tcp://srv1.example.org
&gt; qemu+tcp://srv2.example.org
&gt; 
&gt; Since both configs are identical (I've ran diff on them) I am a bit
&gt; lost at the moment. I do not have any idea why it works for one
&gt; host, but not the other. Any ideas?

Also check file permissions and make sure you've restarted
libvirtd. Also make sure /etc/hosts is accurate and that
the name reported by 'hostname' command resolves to a real
IP address (ie not 127.0.0.1), and that the IP address
resolves back to the original hostname.

You can set LIBVIRT_DEBUG=1 for virsh, and similar for
libvirtd in /etc/libvirt/libvirtd.conf to see verbose
debugging. 

Also 'klist' on the client will show whether the client
ever even started kerberos for the host in question - you
should see the host's ticket present

Daniel

</body></email><email><emailId>20110128125021</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2011-01-28 12:50:21-0400</timestampReceived><subject>Re: [libvirt-users] compilation error</subject><body>

On 28/01/2011, at 8:48 PM, Matthias Bolte wrote:
&gt; I attached a patch that just removes the entire cpu-baseline command
&gt; from virsh, quite harsh but effective.

Good point.  The practical approach. :)

</body></email><email><emailId>20110130152621</emailId><senderName>Alexander Topolanek</senderName><senderEmail>atopo@ocv.org</senderEmail><timestampReceived>2011-01-30 15:26:21-0400</timestampReceived><subject>Re: [libvirt-users] syslog messages after cd-rom removal</subject><body>

Am 27.01.2011 01:39, schrieb Justin Clift:
&gt; On 27/01/2011, at 5:38 AM, Alexander Topolanek wrote:
&gt; &gt; Sorry, I know this is not really libvirt related, but I'm searching for a \
&gt; &gt; solution sind about an hour and cannot find anything that helps me ... 
&gt; &gt; Ok, I used to install a standard debian in a kvm instance, and removed the \
&gt; &gt; virtual cd-rom after installation. Now I'm getting this triplet every five \
&gt; &gt; minutes in my syslog: 
&gt; &gt; Jan 26 19:25:12 srv62 kernel: [ 1324.267675] hdc: task_in_intr: status=0x41 { \
&gt; &gt;                 DriveReady Error }
&gt; &gt; Jan 26 19:25:12 srv62 kernel: [ 1324.267683] hdc: task_in_intr: error=0x04 { \
&gt; &gt;                 AbortedCommand }
&gt; &gt; Jan 26 19:25:12 srv62 kernel: [ 1324.267685] ide: failed opcode was: 0xec
&gt; &gt; 
&gt; &gt; and I'm looking how to get rid of the device.
&gt; Just for clarification, is that the syslog of the host machine, or the syslog of a \
&gt; guest? 
&gt; If it's the guest, I'm kind of wondering if you did the "sudo eject" thing before \
&gt; removing the virtual-cdrom, so the guest "knows" the cd drive don't have any mdedia \
&gt; in it? 
&gt; Regards and best wishes,
&gt; 
&gt; Justin Clift
It's the syslog on the guest. I was using an iso image for installation, 
and later removed the virtual CD Rom drive. So the point is that the 
guest system doesn't have a CD-Rom drive anymore, but debian believes 
it's still there. The question is how to tell debian there is no cd rom 
drive any more...

thanks and regards
Alexander Topolanek


</body></email><email><emailId>20110131055136</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-01-31 05:51:36-0400</timestampReceived><subject>Re: [libvirt-users] libvirt, snapshots, LVM, and existing VMs</subject><body>

于 2011年01月30日 06:18, Casey Link 写道:
&gt; &gt; How to create the logical pool, refer to:
&gt; &gt; http://libvirt.org/git/?p=libvirt.git;a=tree;f=tests/storagepoolxml2xmlin;h=92d08b31073ade34bc2112694219030130fc5bd1;hb=HEAD
&gt; &gt;  
&gt; &gt; How to create the logical volume with backing store, refer to:
&gt; &gt; http://libvirt.org/git/?p=libvirt.git;a=tree;f=tests/storagevolxml2xmlin;h=ed26441f354c5183499eae14b56e280fe36c1da6;hb=HEAD
&gt; &gt; 
&gt; 
&gt; Hi Osier,
&gt; 
&gt; So, I have managed to setup an LVM backed pool (koth-main), and
&gt; created volumes from this pool:
&gt; 
&gt; vol-create-as --pool koth-main --name koth-foo-snap --capacity 2G
&gt; vol-create-as --pool koth-main --name koth-foo --capacity 2G
&gt; --backing-vol koth-foo-snap
&gt; 
&gt; I then performed a virt-install, and after configuring the system
&gt; attempted s snapshot, but as you can see it still doesn't work. I get
&gt; the same error as before:
&gt; snapshot-create koth-foo
&gt; error: Requested operation is not valid: Disk '/dev/main/koth-foo'
&gt; does not support snapshotting

Sorry for the late, qemu driver only supports domain snapshotting
when the disks' driver type is "qcow2". e.g.

&lt;disk...&gt;
     ......
     &lt;driver name="qemu" type="qcow2"/&gt;
     ......
&lt;/disk&gt;

&gt; 
&gt; Did I miss a step?
&gt; 
&gt; Best,
&gt; 
&gt; Casey
&gt; 
&gt; Below is the XML for the main volume:
&gt; 
&gt; &lt;volume&gt;
&gt; &lt;name&gt;koth-foo&lt;/name&gt;
&gt; &lt;key&gt;5er4qK-stqa-zzJn-Npbe-HOeH-aYfs-TULujB&lt;/key&gt;
&gt; &lt;source&gt;
&gt; &lt;device path='/dev/sda2'&gt;
&gt; &lt;extent start='417685569536' end='419833053184'/&gt;
&gt; &lt;/device&gt;
&gt; &lt;/source&gt;
&gt; &lt;capacity&gt;2147483648&lt;/capacity&gt;
&gt; &lt;allocation&gt;2147483648&lt;/allocation&gt;
&gt; &lt;target&gt;
&gt; &lt;path&gt;/dev/main/koth-foo&lt;/path&gt;
&gt; &lt;permissions&gt;
&gt; &lt;mode&gt;0600&lt;/mode&gt;
&gt; &lt;owner&gt;0&lt;/owner&gt;
&gt; &lt;group&gt;6&lt;/group&gt;
&gt; &lt;/permissions&gt;
&gt; &lt;/target&gt;
&gt; &lt;backingStore&gt;
&gt; &lt;path&gt;/dev/main/koth-foo-snap&lt;/path&gt;
&gt; &lt;permissions&gt;
&gt; &lt;mode&gt;0660&lt;/mode&gt;
&gt; &lt;owner&gt;0&lt;/owner&gt;
&gt; &lt;group&gt;6&lt;/group&gt;
&gt; &lt;/permissions&gt;
&gt; &lt;/backingStore&gt;
&gt; &lt;/volume&gt;


</body></email><email><emailId>20110131132657</emailId><senderName>Guido Winkelmann</senderName><senderEmail>guido-libvi@unknownsite.de</senderEmail><timestampReceived>2011-01-31 13:26:57-0400</timestampReceived><subject>Re: [libvirt-users] libvirt bridge configuration</subject><body>

Am Sunday 30 January 2011 schrieb Taras Lipatov:
&gt; Hi Every one,
&gt; 
&gt; I'm hoping some one can point me in the right direction.
&gt; We are piloting KVM + Libvirt for migrating off Xen and I'm stuck with
&gt; the network bridge configuration via libvirt.
&gt; 
&gt; What we have currently with xen is:
&gt; 1 server with Wan/lan interfaces and a pool of public ip addresses.
&gt; Using xen bridge scripts I'd start a xenbr0 and attach eth0 (wan) and go
&gt; ahead and assign public IP's
&gt; to images attached to xenbr0.
&gt; 
&gt; Now with creating virbr0, I need to assign it an ip address? and routing
&gt; methods? what about creating a transparent bridge via libvirt?
&gt; I kno I can achieve this using bridge utils, but it would be nice to
&gt; have everything handled by libvirt.

As far as I can tell, libvirt just doesn't support the "plain old bridge" 
scenario (i.e. the one where you enslave a physical ethernet device in the same 
bridge as the virtual devices for the guests), at least not if you want to 
define the network itself using libvirt.

Just create a new bridge device (say, br1) manually, make your OS create it 
automatically on startup and then put something like this in the devices section 
of your guests:

&lt;interface type="bridge"&gt;
  &lt;source bridge="br1"/&gt;
  &lt;model type='e1000'/&gt;"
  &lt;mac address="&lt;somemacaddress&gt;"&gt;   
&lt;/interface&gt;

(Note: You will have to manuall keep track of the MAC addresses in use on your 
network. If one is used twice, things will break down.)

	Guido

</body></email><email><emailId>20110131140053</emailId><senderName>Sengor</senderName><senderEmail>sengork@gmail.com</senderEmail><timestampReceived>2011-01-31 14:00:53-0400</timestampReceived><subject>Re: [libvirt-users] Guest interface info under ESX driver</subject><body>

Thanks for the speedy replies guys, much appreciated.

On Tue, Feb 1, 2011 at 12:45 AM, Matthias Bolte
&lt;matthias.bolte@googlemail.com&gt; wrote:
&gt; Currently libvirt doesn't provide a function to get the IP address of
&gt; a domain's network interface.
&gt;
&gt; Might be a useful addition as libvirt can know/determine the IP
&gt; address in several cases.

It'd be an useful addon to libvirt, as at the moment there are not
many mature Python interface libraries for ESX.

&gt; The domain XML doesn't contain the IP address (yet).
&gt;
&gt; With VMware tools installed in the guest it might be possible to
&gt; obtain the IP address via the vSphere API, I didn't test this yet.

Yes VMware Tools need to be deployed within the guest OS for the IP to
be visible even to ESX itself.

I think I'll resort to using ESX's own API interface to query this
piece of info (possibly via pywbem). An example of such use is
available @ http://www.linuxdynasty.org/howto-list-virtual-machines-using-python-and-cim-part-2.html

Regardless will keep using libvirt for the remainder of functionality
I'm after.

&gt; But libvirt doesn't have a function to expose this information yet.
&gt;
&gt;
&gt; virInterface is for the host network interfaces, this is not what
&gt; you're looking for.
&gt;
&gt; This matrix is quite outdated, and needs to be updated :(
&gt;
&gt; Matthias

-- 
sengork

</body></email><email><emailId>20110725202637</emailId><senderName>Guilherme Santos</senderName><senderEmail>guisgb13@gmail.com</senderEmail><timestampReceived>2011-07-25 20:26:37-0400</timestampReceived><subject>Re: [libvirt-users] VirtualBox headless</subject><body>

My objective is also to run headless virtual machines through libvirt
library.
I am using an Ubuntu 10.04 distro and libvirt 0.9.2.

Before asking you guys about it, I searched on the web and found this:

Hi,
&gt;
&gt; thanks for your hint.
&gt;
&gt; I read the lines in the documentation, but unfortunately editing the xml
&gt;
&gt; within virsh lead to the errors.
&gt;
&gt; The Solution to a headless domain was to edit the XML file from bash and
&gt; then
&gt;
&gt; #virsh: define &lt;domainname.xml&gt;
&gt;
&gt; to reload the new values for the graphics type of the machine.
&gt;
&gt; Obvioulsy something went wrong when editing "live"....
&gt;
&gt; Regards,
&gt; Christian
&gt;
&gt; Am 24.06.2010 18:27, schrieb Jean-Baptiste Rouault:
&gt; &gt; Hi,
&gt; &gt;
&gt; &gt; Something like this should work, as can be seen in the
&gt;
&gt; &gt; documentation here : http://libvirt.org/formatdomain.html#elementsGraphics
&gt; &gt;
&gt; &gt; &lt;drivers&gt;
&gt; &gt;   &lt;graphics type='rdp' autoport='yes' /&gt;
&gt;
&gt; &gt; &lt;/drivers&gt;
&gt; &gt;
&gt; &gt; Regards,
&gt; &gt;
&gt; &gt; Jean-Baptiste
&gt; &gt;
&gt; &gt;
&gt; &gt;&gt; Hello,
&gt; &gt;&gt;
&gt; &gt;&gt; I'm trying to use the VirtualBox/vbox driver together with libvirt 0.8.1
&gt; &gt;&gt; on a Ubuntu Lucid Machine, VirtualBox Release 3.1.
&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; The goal is to run the virtual machines headless and to connect using RDP.
&gt; &gt;&gt;
&gt; &gt;&gt; When starting a virtual domain using 'virsh start &lt;domainname&gt;' the GUI
&gt; &gt;&gt; of VirtualBox will pop up and I see no option to prevent this. If X is
&gt;
&gt; &gt;&gt; not running, the virsh command will terminate with 'unknown failure'.
&gt; &gt;&gt;
&gt; &gt;&gt; I've found some hints on inclusion of the headless statement in the
&gt; &gt;&gt; 'graphics' part of the XML definition file, but when I tree to adopt
&gt;
&gt; &gt;&gt; this, the editing of the file will crash.
&gt; &gt;&gt;
&gt; &gt;&gt; Has anyone achieved to manage VBox machines with libvirt on a headless
&gt; &gt;&gt; server ?
&gt; &gt;&gt;
&gt; &gt;&gt; Thanks in advance for some hints or experiences with this issue,
&gt;
&gt; &gt;&gt; Christian
&gt; &gt;&gt;
&gt;
&gt;
Unfortunately this isn't working for me.
Following is my XML configuration:

&lt;domain type='vbox'&gt;
  &lt;name&gt;THEDOMAIN&lt;/name&gt;
  &lt;uuid&gt;33f6e188-1479-46f4-9d90-4d5a2d3a30f2&lt;/uuid&gt;
  &lt;memory&gt;393216&lt;/memory&gt;
  &lt;currentMemory&gt;393216&lt;/currentMemory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='i686'&gt;hvm&lt;/type&gt;
    &lt;boot dev='hd'/&gt;
    &lt;boot dev='cdrom'/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
  &lt;/features&gt;
  &lt;clock offset='localtime'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;destroy&lt;/on_reboot&gt;
  &lt;on_crash&gt;destroy&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;source file='/local/vbox-shared.vdi' /&gt;
      &lt;target dev='hda' bus='ide'/&gt;
    &lt;/disk&gt;
    &lt;disk type='file' device='cdrom'&gt;
      &lt;source file='/local/ubuntu-11.04-desktop-i386.iso' /&gt;
      &lt;target dev='hdc' bus='ide'/&gt;
    &lt;/disk&gt;
    &lt;interface type='user'&gt;
      &lt;mac address='08:00:27:9a:d0:63'/&gt;
      &lt;model type='Am79C973'/&gt;
    &lt;/interface&gt;
    &lt;input type='mouse' bus='ps2'/&gt;
    &lt;graphics type='rdp' autoport='yes' /&gt;
    &lt;video&gt;
      &lt;model type='vbox' vram='12' heads='1'&gt;
        &lt;acceleration accel3d='no' accel2d='no'/&gt;
      &lt;/model&gt;
    &lt;/video&gt;
  &lt;/devices&gt;
&lt;/domain&gt;

When I run command

*virsh start THEDOMAIN*

it is popping up the following error message:

*OpenRemoteSession/LaunchVMProcess failed, domain can't be started*

As it wasn't working I also tried other options, but unfortunately, using
all other graphic type options (except for 'spice', which I didn't try) the
GUI is launched.

I don't think I'll be needing a RDP connection, neither anything similar to
that, except if these are necessary to basic management of the vm through
virsh (start, stop, reboot, create and revert snapshots).
Isn't there one simple way to run a virtual machine domain headless without
vnc, spice or rdp servers?
If not, which could be going wrong in my xml configuration?

To help understanding of my desired behavior, what I need is to do through
virsh what can be done using

*VBoxManage startvm THEDOMAIN --headless*

or

*VBoxHeadless startvm THEDOMAIN*,

because will use other hypervisors in the future, so it is a critical thing
to me.

Thanks in advance for the help,

Guilherme Santos

[Attachment #3 (text/html)]

&lt;div&gt;My objective is also to run headless virtual machines through libvirt \
library.&lt;br&gt;I am using an Ubuntu 10.04 distro and libvirt 0.9.2.&lt;br&gt;&lt;br&gt;Before asking \
you guys about it, I searched on the web and found this:&lt;br&gt;&lt;br&gt;

&lt;/div&gt;&lt;blockquote style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, \
204, 204); padding-left: 1ex;" class="gmail_quote"&gt;&lt;pre&gt;Hi,&lt;br&gt;&lt;br&gt;thanks for your \
hint.&lt;br&gt;&lt;br&gt;I read the lines in the documentation, but unfortunately editing the \
xml&lt;br&gt;

within virsh lead to the errors.&lt;br&gt;&lt;br&gt;The Solution to a headless domain was to edit \
the XML file from bash and&lt;br&gt;then&lt;br&gt;&lt;br&gt;#virsh: define \
&lt;domainname.xml&gt;&lt;br&gt;&lt;br&gt;to reload the new values for the graphics type of the \
machine.&lt;br&gt;

&lt;br&gt;Obvioulsy something went wrong when editing \
"live"....&lt;br&gt;&lt;br&gt;Regards,&lt;br&gt;Christian&lt;br&gt;&lt;br&gt;Am 24.06.2010 18:27, schrieb \
Jean-Baptiste Rouault:&lt;br&gt;&gt; Hi,&lt;br&gt;&gt;&lt;br&gt;&gt; Something like this should work, \
as can be seen in the&lt;br&gt;

&gt; documentation here : &lt;a rel="nofollow" \
href="http://libvirt.org/formatdomain.html#elementsGraphics"&gt;http://libvirt.org/formatdomain.html#elementsGraphics&lt;/a&gt;&lt;br&gt;&gt;&lt;br&gt;&gt; \
&lt;drivers&gt;&lt;br&gt;&gt;   &lt;graphics type='rdp' autoport='yes' \
/&gt;&lt;br&gt;

&gt; &lt;/drivers&gt;&lt;br&gt;&gt;&lt;br&gt;&gt; Regards,&lt;br&gt;&gt;&lt;br&gt;&gt; \
Jean-Baptiste&lt;br&gt;&gt;&lt;br&gt;&gt;   &lt;br&gt;&gt;&gt; Hello,&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt; I'm \
trying to use the VirtualBox/vbox driver together with libvirt 0.8.1&lt;br&gt;&gt;&gt; on a \
Ubuntu Lucid Machine, VirtualBox Release 3.1.&lt;br&gt;

&gt;&gt;&lt;br&gt;&gt;&gt; The goal is to run the virtual machines headless and to connect \
using RDP.&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt; When starting a virtual domain using 'virsh \
start &lt;domainname&gt;' the GUI&lt;br&gt;&gt;&gt; of VirtualBox will pop up and I see \
no option to prevent this. If X is&lt;br&gt;

&gt;&gt; not running, the virsh command will terminate with 'unknown \
failure'.&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt; I've found some hints on inclusion of the \
headless statement in the&lt;br&gt;&gt;&gt; 'graphics' part of the XML definition \
file, but when I tree to adopt&lt;br&gt;

&gt;&gt; this, the editing of the file will crash.&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt; Has anyone \
achieved to manage VBox machines with libvirt on a headless&lt;br&gt;&gt;&gt; server \
?&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt; Thanks in advance for some hints or experiences with this \
issue,&lt;br&gt;

&gt;&gt; Christian&lt;br&gt;&gt;&gt;&lt;br&gt;&lt;/pre&gt;&lt;/blockquote&gt;&lt;br&gt;Unfortunately this isn't \
working for me.&lt;br&gt;Following is my XML configuration:&lt;br&gt;&lt;br&gt;&lt;domain \
type='vbox'&gt;&lt;br&gt;  &lt;name&gt;THEDOMAIN&lt;/name&gt;&lt;br&gt;

  &lt;uuid&gt;33f6e188-1479-46f4-9d90-4d5a2d3a30f2&lt;/uuid&gt;&lt;br&gt;  \
&lt;memory&gt;393216&lt;/memory&gt;&lt;br&gt;  \
&lt;currentMemory&gt;393216&lt;/currentMemory&gt;&lt;br&gt;  &lt;vcpu&gt;1&lt;/vcpu&gt;&lt;br&gt; \
&lt;os&gt;&lt;br&gt;    &lt;type arch='i686'&gt;hvm&lt;/type&gt;&lt;br&gt;

    &lt;boot dev='hd'/&gt;&lt;br&gt;    &lt;boot dev='cdrom'/&gt;&lt;br&gt;  \
&lt;/os&gt;&lt;br&gt;  &lt;features&gt;&lt;br&gt;    &lt;acpi/&gt;&lt;br&gt;  &lt;/features&gt;&lt;br&gt;  \
&lt;clock offset='localtime'/&gt;&lt;br&gt;  \
&lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;&lt;br&gt;

  &lt;on_reboot&gt;destroy&lt;/on_reboot&gt;&lt;br&gt;  \
&lt;on_crash&gt;destroy&lt;/on_crash&gt;&lt;br&gt;  &lt;devices&gt;&lt;br&gt;    &lt;disk \
type='file' device='disk'&gt;&lt;br&gt;      &lt;source \
file='/local/vbox-shared.vdi' /&gt;&lt;br&gt;

      &lt;target dev='hda' bus='ide'/&gt;&lt;br&gt;    &lt;/disk&gt;&lt;br&gt;    \
&lt;disk type='file' device='cdrom'&gt;&lt;br&gt;      &lt;source \
file='/local/ubuntu-11.04-desktop-i386.iso' /&gt;&lt;br&gt;

      &lt;target dev='hdc' bus='ide'/&gt;&lt;br&gt;    &lt;/disk&gt;&lt;br&gt;    \
&lt;interface type='user'&gt;&lt;br&gt;      &lt;mac \
address='08:00:27:9a:d0:63'/&gt;&lt;br&gt;      &lt;model \
type='Am79C973'/&gt;&lt;br&gt;

    &lt;/interface&gt;&lt;br&gt;    &lt;input type='mouse' \
bus='ps2'/&gt;&lt;br&gt;    &lt;graphics type='rdp' autoport='yes' \
/&gt;&lt;br&gt;    &lt;video&gt;&lt;br&gt;      &lt;model type='vbox' vram='12' \
heads='1'&gt;&lt;br&gt;

        &lt;acceleration accel3d='no' accel2d='no'/&gt;&lt;br&gt;      \
&lt;/model&gt;&lt;br&gt;    &lt;/video&gt;&lt;br&gt;  &lt;/devices&gt;&lt;br&gt;&lt;/domain&gt;&lt;br \
clear="all"&gt;&lt;br&gt;When I run command&lt;br&gt;&lt;br&gt;&lt;i&gt;virsh start THEDOMAIN&lt;/i&gt;&lt;br&gt;

&lt;br&gt;it is popping up the following error \
message:&lt;br&gt;&lt;br&gt;&lt;i&gt;OpenRemoteSession/LaunchVMProcess failed, domain can't be \
started&lt;/i&gt;&lt;br&gt;&lt;br&gt;As it wasn't working I also tried other options, but \
unfortunately, using all other graphic type options (except for 'spice', \
which I didn't try) the GUI is launched.&lt;br&gt;

&lt;br&gt;I don't think I'll be needing a RDP connection, neither anything similar \
to that, except if these are necessary to basic management of the vm through virsh \
(start, stop, reboot, create and revert snapshots).&lt;br&gt;

Isn't there one simple way to run a virtual machine domain headless without vnc, \
spice or rdp servers?&lt;br&gt;If not, which could be going wrong in my xml \
configuration?&lt;br&gt;&lt;br&gt;To help understanding of my desired behavior, what I need is to \
do through virsh what can be done using&lt;br&gt;

&lt;br&gt;&lt;i&gt;VBoxManage startvm THEDOMAIN --headless&lt;/i&gt;&lt;br&gt;&lt;br&gt;or&lt;br&gt;&lt;br&gt;&lt;i&gt;VBoxHeadless \
startvm THEDOMAIN&lt;/i&gt;,&lt;br&gt;&lt;br&gt;because will use other hypervisors in the future, so it \
is a critical thing to me.&lt;br&gt;&lt;br&gt;Thanks in advance for the help,&lt;br&gt;

&lt;br&gt;Guilherme Santos&lt;br&gt;



</body></email><email><emailId>20110727124435</emailId><senderName>Rodolfo Viana</senderName><senderEmail>rodolfodelimaviana@gmail.com</senderEmail><timestampReceived>2011-07-27 12:44:35-0400</timestampReceived><subject>Re: [libvirt-users] VirtualBox headless</subject><body>

I have the same problem. I've already tried to start vbox vm without GUI but
I couldn't do it.

Christian, as it seems that you've managed to do it successfully, could you
help us out in this task?

If not, does anyone here have a way to do it? Or is it impossible with
current libvirt code?

thanks in advance!

2011/7/25 Guilherme Santos &lt;guisgb13@gmail.com&gt;

&gt; My objective is also to run headless virtual machines through libvirt
&gt; library.
&gt; I am using an Ubuntu 10.04 distro and libvirt 0.9.2.
&gt;
&gt; Before asking you guys about it, I searched on the web and found this:
&gt;
&gt; Hi,
&gt;&gt;
&gt;&gt; thanks for your hint.
&gt;&gt;
&gt;&gt; I read the lines in the documentation, but unfortunately editing the xml
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; within virsh lead to the errors.
&gt;&gt;
&gt;&gt; The Solution to a headless domain was to edit the XML file from bash and
&gt;&gt; then
&gt;&gt;
&gt;&gt; #virsh: define &lt;domainname.xml&gt;
&gt;&gt;
&gt;&gt; to reload the new values for the graphics type of the machine.
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; Obvioulsy something went wrong when editing "live"....
&gt;&gt;
&gt;&gt; Regards,
&gt;&gt; Christian
&gt;&gt;
&gt;&gt; Am 24.06.2010 18:27, schrieb Jean-Baptiste Rouault:
&gt;&gt; &gt; Hi,
&gt;&gt; &gt;
&gt;&gt; &gt; Something like this should work, as can be seen in the
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; &gt; documentation here : http://libvirt.org/formatdomain.html#elementsGraphics
&gt;&gt; &gt;
&gt;&gt; &gt; &lt;drivers&gt;
&gt;&gt; &gt;   &lt;graphics type='rdp' autoport='yes' /&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; &gt; &lt;/drivers&gt;
&gt;&gt; &gt;
&gt;&gt; &gt; Regards,
&gt;&gt; &gt;
&gt;&gt; &gt; Jean-Baptiste
&gt;&gt; &gt;
&gt;&gt; &gt;
&gt;&gt; &gt;&gt; Hello,
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; I'm trying to use the VirtualBox/vbox driver together with libvirt 0.8.1
&gt;&gt; &gt;&gt; on a Ubuntu Lucid Machine, VirtualBox Release 3.1.
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; The goal is to run the virtual machines headless and to connect using RDP.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; When starting a virtual domain using 'virsh start &lt;domainname&gt;' the GUI
&gt;&gt; &gt;&gt; of VirtualBox will pop up and I see no option to prevent this. If X is
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; &gt;&gt; not running, the virsh command will terminate with 'unknown failure'.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; I've found some hints on inclusion of the headless statement in the
&gt;&gt; &gt;&gt; 'graphics' part of the XML definition file, but when I tree to adopt
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; &gt;&gt; this, the editing of the file will crash.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Has anyone achieved to manage VBox machines with libvirt on a headless
&gt;&gt; &gt;&gt; server ?
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Thanks in advance for some hints or experiences with this issue,
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; &gt;&gt; Christian
&gt;&gt; &gt;&gt;
&gt;&gt;
&gt;&gt;
&gt; Unfortunately this isn't working for me.
&gt; Following is my XML configuration:
&gt;
&gt; &lt;domain type='vbox'&gt;
&gt;   &lt;name&gt;THEDOMAIN&lt;/name&gt;
&gt;   &lt;uuid&gt;33f6e188-1479-46f4-9d90-4d5a2d3a30f2&lt;/uuid&gt;
&gt;   &lt;memory&gt;393216&lt;/memory&gt;
&gt;   &lt;currentMemory&gt;393216&lt;/currentMemory&gt;
&gt;   &lt;vcpu&gt;1&lt;/vcpu&gt;
&gt;   &lt;os&gt;
&gt;     &lt;type arch='i686'&gt;hvm&lt;/type&gt;
&gt;     &lt;boot dev='hd'/&gt;
&gt;     &lt;boot dev='cdrom'/&gt;
&gt;   &lt;/os&gt;
&gt;   &lt;features&gt;
&gt;     &lt;acpi/&gt;
&gt;   &lt;/features&gt;
&gt;   &lt;clock offset='localtime'/&gt;
&gt;   &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
&gt;   &lt;on_reboot&gt;destroy&lt;/on_reboot&gt;
&gt;   &lt;on_crash&gt;destroy&lt;/on_crash&gt;
&gt;   &lt;devices&gt;
&gt;     &lt;disk type='file' device='disk'&gt;
&gt;       &lt;source file='/local/vbox-shared.vdi' /&gt;
&gt;       &lt;target dev='hda' bus='ide'/&gt;
&gt;     &lt;/disk&gt;
&gt;     &lt;disk type='file' device='cdrom'&gt;
&gt;       &lt;source file='/local/ubuntu-11.04-desktop-i386.iso' /&gt;
&gt;       &lt;target dev='hdc' bus='ide'/&gt;
&gt;     &lt;/disk&gt;
&gt;     &lt;interface type='user'&gt;
&gt;       &lt;mac address='08:00:27:9a:d0:63'/&gt;
&gt;       &lt;model type='Am79C973'/&gt;
&gt;     &lt;/interface&gt;
&gt;     &lt;input type='mouse' bus='ps2'/&gt;
&gt;     &lt;graphics type='rdp' autoport='yes' /&gt;
&gt;     &lt;video&gt;
&gt;       &lt;model type='vbox' vram='12' heads='1'&gt;
&gt;         &lt;acceleration accel3d='no' accel2d='no'/&gt;
&gt;       &lt;/model&gt;
&gt;     &lt;/video&gt;
&gt;   &lt;/devices&gt;
&gt; &lt;/domain&gt;
&gt;
&gt; When I run command
&gt;
&gt; *virsh start THEDOMAIN*
&gt;
&gt; it is popping up the following error message:
&gt;
&gt; *OpenRemoteSession/LaunchVMProcess failed, domain can't be started*
&gt;
&gt; As it wasn't working I also tried other options, but unfortunately, using
&gt; all other graphic type options (except for 'spice', which I didn't try) the
&gt; GUI is launched.
&gt;
&gt; I don't think I'll be needing a RDP connection, neither anything similar to
&gt; that, except if these are necessary to basic management of the vm through
&gt; virsh (start, stop, reboot, create and revert snapshots).
&gt; Isn't there one simple way to run a virtual machine domain headless without
&gt; vnc, spice or rdp servers?
&gt; If not, which could be going wrong in my xml configuration?
&gt;
&gt; To help understanding of my desired behavior, what I need is to do through
&gt; virsh what can be done using
&gt;
&gt; *VBoxManage startvm THEDOMAIN --headless*
&gt;
&gt; or
&gt;
&gt; *VBoxHeadless startvm THEDOMAIN*,
&gt;
&gt; because will use other hypervisors in the future, so it is a critical thing
&gt; to me.
&gt;
&gt; Thanks in advance for the help,
&gt;
&gt; Guilherme Santos
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;



-- 
Rodolfo de Lima Viana
Undergraduate in Computer Science at UFCG
LSD - Distributed Systems Laboratory

[Attachment #3 (text/html)]

I have the same problem. I've already tried to start vbox vm without GUI but I \
couldn't do it.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;meta http-equiv="content-type" \
content="text/html; charset=utf-8"&gt;Christian, as it seems that you've managed to \
do it successfully, could you help us out in this task?&lt;/div&gt;

&lt;div&gt;&lt;br&gt;&lt;div&gt;If not, does anyone here have a way to do it? Or is it impossible with \
current libvirt code?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;thanks in advance!&lt;br&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;2011/7/25 Guilherme Santos &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:guisgb13@gmail.com"&gt;guisgb13@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;

&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt;&lt;div&gt;My objective is also to run headless virtual machines \
through libvirt library.&lt;br&gt;I am using an Ubuntu 10.04 distro and libvirt 0.9.2.&lt;br&gt;

&lt;br&gt;Before asking you guys about it, I searched on the web and found this:&lt;br&gt;&lt;br&gt;

&lt;/div&gt;&lt;blockquote style="margin:0pt 0pt 0pt 0.8ex;border-left:1px solid rgb(204, 204, \
204);padding-left:1ex" class="gmail_quote"&gt;&lt;pre&gt;Hi,&lt;br&gt;&lt;br&gt;thanks for your \
hint.&lt;br&gt;&lt;br&gt;I read the lines in the documentation, but unfortunately editing the \
xml&lt;br&gt;



within virsh lead to the errors.&lt;br&gt;&lt;br&gt;The Solution to a headless domain was to edit \
the XML file from bash and&lt;br&gt;then&lt;br&gt;&lt;br&gt;#virsh: define \
&lt;domainname.xml&gt;&lt;br&gt;&lt;br&gt;to reload the new values for the graphics type of the \
machine.&lt;br&gt;



&lt;br&gt;Obvioulsy something went wrong when editing \
"live"....&lt;br&gt;&lt;br&gt;Regards,&lt;br&gt;Christian&lt;br&gt;&lt;br&gt;Am 24.06.2010 18:27, schrieb \
Jean-Baptiste Rouault:&lt;br&gt;&gt; Hi,&lt;br&gt;&gt;&lt;br&gt;&gt; Something like this should work, \
as can be seen in the&lt;br&gt;



&gt; documentation here : &lt;a rel="nofollow" \
href="http://libvirt.org/formatdomain.html#elementsGraphics" \
target="_blank"&gt;http://libvirt.org/formatdomain.html#elementsGraphics&lt;/a&gt;&lt;br&gt;&gt;&lt;br&gt;&gt; \
&lt;drivers&gt;&lt;br&gt;&gt;   &lt;graphics type='rdp' autoport='yes' \
/&gt;&lt;br&gt;



&gt; &lt;/drivers&gt;&lt;br&gt;&gt;&lt;br&gt;&gt; Regards,&lt;br&gt;&gt;&lt;br&gt;&gt; \
Jean-Baptiste&lt;br&gt;&gt;&lt;br&gt;&gt;   &lt;br&gt;&gt;&gt; Hello,&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt; I'm \
trying to use the VirtualBox/vbox driver together with libvirt 0.8.1&lt;br&gt;&gt;&gt; on a \
Ubuntu Lucid Machine, VirtualBox Release 3.1.&lt;br&gt;



&gt;&gt;&lt;br&gt;&gt;&gt; The goal is to run the virtual machines headless and to connect \
using RDP.&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt; When starting a virtual domain using 'virsh \
start &lt;domainname&gt;' the GUI&lt;br&gt;&gt;&gt; of VirtualBox will pop up and I see \
no option to prevent this. If X is&lt;br&gt;



&gt;&gt; not running, the virsh command will terminate with 'unknown \
failure'.&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt; I've found some hints on inclusion of the \
headless statement in the&lt;br&gt;&gt;&gt; 'graphics' part of the XML definition \
file, but when I tree to adopt&lt;br&gt;



&gt;&gt; this, the editing of the file will crash.&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt; Has anyone \
achieved to manage VBox machines with libvirt on a headless&lt;br&gt;&gt;&gt; server \
?&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt; Thanks in advance for some hints or experiences with this \
issue,&lt;br&gt;



&gt;&gt; Christian&lt;br&gt;&gt;&gt;&lt;br&gt;&lt;/pre&gt;&lt;/blockquote&gt;&lt;br&gt;Unfortunately this isn't \
working for me.&lt;br&gt;Following is my XML configuration:&lt;br&gt;&lt;br&gt;&lt;domain \
type='vbox'&gt;&lt;br&gt;  &lt;name&gt;THEDOMAIN&lt;/name&gt;&lt;br&gt;



  &lt;uuid&gt;33f6e188-1479-46f4-9d90-4d5a2d3a30f2&lt;/uuid&gt;&lt;br&gt;  \
&lt;memory&gt;393216&lt;/memory&gt;&lt;br&gt;  \
&lt;currentMemory&gt;393216&lt;/currentMemory&gt;&lt;br&gt;  &lt;vcpu&gt;1&lt;/vcpu&gt;&lt;br&gt; \
&lt;os&gt;&lt;br&gt;    &lt;type arch='i686'&gt;hvm&lt;/type&gt;&lt;br&gt;



    &lt;boot dev='hd'/&gt;&lt;br&gt;    &lt;boot dev='cdrom'/&gt;&lt;br&gt;  \
&lt;/os&gt;&lt;br&gt;  &lt;features&gt;&lt;br&gt;    &lt;acpi/&gt;&lt;br&gt;  &lt;/features&gt;&lt;br&gt;  \
&lt;clock offset='localtime'/&gt;&lt;br&gt;  \
&lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;&lt;br&gt;



  &lt;on_reboot&gt;destroy&lt;/on_reboot&gt;&lt;br&gt;  \
&lt;on_crash&gt;destroy&lt;/on_crash&gt;&lt;br&gt;  &lt;devices&gt;&lt;br&gt;    &lt;disk \
type='file' device='disk'&gt;&lt;br&gt;      &lt;source \
file='/local/vbox-shared.vdi' /&gt;&lt;br&gt;



      &lt;target dev='hda' bus='ide'/&gt;&lt;br&gt;    &lt;/disk&gt;&lt;br&gt;    \
&lt;disk type='file' device='cdrom'&gt;&lt;br&gt;      &lt;source \
file='/local/ubuntu-11.04-desktop-i386.iso' /&gt;&lt;br&gt;



      &lt;target dev='hdc' bus='ide'/&gt;&lt;br&gt;    &lt;/disk&gt;&lt;br&gt;    \
&lt;interface type='user'&gt;&lt;br&gt;      &lt;mac \
address='08:00:27:9a:d0:63'/&gt;&lt;br&gt;      &lt;model \
type='Am79C973'/&gt;&lt;br&gt;



    &lt;/interface&gt;&lt;br&gt;    &lt;input type='mouse' \
bus='ps2'/&gt;&lt;br&gt;    &lt;graphics type='rdp' autoport='yes' \
/&gt;&lt;br&gt;    &lt;video&gt;&lt;br&gt;      &lt;model type='vbox' vram='12' \
heads='1'&gt;&lt;br&gt;



        &lt;acceleration accel3d='no' accel2d='no'/&gt;&lt;br&gt;      \
&lt;/model&gt;&lt;br&gt;    &lt;/video&gt;&lt;br&gt;  &lt;/devices&gt;&lt;br&gt;&lt;/domain&gt;&lt;br \
clear="all"&gt;&lt;br&gt;When I run command&lt;br&gt;&lt;br&gt;&lt;i&gt;virsh start THEDOMAIN&lt;/i&gt;&lt;br&gt;



&lt;br&gt;it is popping up the following error \
message:&lt;br&gt;&lt;br&gt;&lt;i&gt;OpenRemoteSession/LaunchVMProcess failed, domain can't be \
started&lt;/i&gt;&lt;br&gt;&lt;br&gt;As it wasn't working I also tried other options, but \
unfortunately, using all other graphic type options (except for 'spice', \
which I didn't try) the GUI is launched.&lt;br&gt;



&lt;br&gt;I don't think I'll be needing a RDP connection, neither anything similar \
to that, except if these are necessary to basic management of the vm through virsh \
(start, stop, reboot, create and revert snapshots).&lt;br&gt;



Isn't there one simple way to run a virtual machine domain headless without vnc, \
spice or rdp servers?&lt;br&gt;If not, which could be going wrong in my xml \
configuration?&lt;br&gt;&lt;br&gt;To help understanding of my desired behavior, what I need is to \
do through virsh what can be done using&lt;br&gt;



&lt;br&gt;&lt;i&gt;VBoxManage startvm THEDOMAIN --headless&lt;/i&gt;&lt;br&gt;&lt;br&gt;or&lt;br&gt;&lt;br&gt;&lt;i&gt;VBoxHeadless \
startvm THEDOMAIN&lt;/i&gt;,&lt;br&gt;&lt;br&gt;because will use other hypervisors in the future, so it \
is a critical thing to me.&lt;br&gt;&lt;br&gt;Thanks in advance for the help,&lt;br&gt;

&lt;font color="#888888"&gt;

&lt;br&gt;Guilherme Santos&lt;br&gt;
&lt;/font&gt;&lt;br&gt;_______________________________________________&lt;br&gt;
libvirt-users mailing list&lt;br&gt;
&lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
&lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br \
clear="all"&gt;&lt;br&gt;-- &lt;br&gt;Rodolfo de Lima Viana&lt;div&gt;Undergraduate in Computer Science at \
UFCG&lt;/div&gt;

&lt;div&gt;LSD - Distributed Systems Laboratory &lt;/div&gt;&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20110825113131</emailId><senderName>"lingjiao.lc"</senderName><senderEmail>lingjiao.lc@taobao.com</senderEmail><timestampReceived>2011-08-25 11:31:31-0400</timestampReceived><subject>[libvirt-users] (no subject)</subject><body>

Hi,
  I've used the libvirt and sheepdog, they are so great!
But I have one question about libvirt and sheepdog.
As we know, I can use this command to create a sheepdog image,

         #qemu-img create ���f raw sheepdog:fedora15.img 40G

but how can I create a pool and volume for sheepdog with the xml of libvirt ?

________________________________

This email (including any attachments) is confidential and may be legally privileged. \
If you received this email in error, please delete it immediately and do not copy it \
or use it for any purpose or disclose its contents to any other person. Thank you.

���������(������������������)�������������������������������������������������������������������������������������������� \
���������������������������������������������������������������������������������������������������������������������



[Attachment #3 (text/html)]

&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;
&lt;style&gt;
&lt;!--
@font-face
	{font-family:SimSun}
@font-face
	{font-family:"Cambria Math"}
@font-face
	{font-family:Calibri}
@font-face
	{font-family:SimSun}
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:"Calibri","sans-serif"}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:9.0pt;
	font-family:"Calibri","sans-serif"}
span.EmailStyle17
	{font-family:"Calibri","sans-serif";
	color:windowtext}
span.Char
	{}
.MsoChpDefault
	{}
@page Section1
	{margin:72.0pt 90.0pt 72.0pt 90.0pt}
div.Section1
	{}
--&gt;
&lt;/style&gt;
&lt;/head&gt;
&lt;body lang="ZH-CN" link="blue" vlink="purple" style=""&gt;
&lt;div class="Section1"&gt;
&lt;p class="MsoNormal"&gt;&lt;span lang="EN-US"&gt;Hi,&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal"&gt;&lt;span lang="EN-US"&gt;  I've used the libvirt and \
sheepdog, they are so great!&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span lang="EN-US"&gt;But I \
have one question about libvirt and sheepdog.&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span \
lang="EN-US"&gt;As we know, I can use this command to create a sheepdog image, \
&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span lang="EN-US"&gt; &lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal"&gt;&lt;span \
lang="EN-US"&gt;         #qemu-img create ���f \
raw sheepdog:fedora15.img 40G&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span \
lang="EN-US"&gt; &lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span lang="EN-US"&gt;but how can I \
create a pool and volume for sheepdog with the xml of libvirt ?&lt;/span&gt;&lt;/p&gt; &lt;/div&gt;
&lt;br&gt;
&lt;hr&gt;
&lt;font face="Arial" color="Gray" size="1"&gt;&lt;br&gt;
This email (including any attachments) is confidential and may be legally privileged. \
If you received this email in error, please delete it immediately and do not copy it \
or use it for any purpose or disclose its contents to any other person. Thank \
you.&lt;br&gt; &lt;br&gt;
���������(������������������)�������������������������������������������������������������������������������������������� \
���������������������������������������������������������������������������������������������������������������������&lt;br&gt;
 &lt;/font&gt;
&lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20110825114700</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-08-25 11:47:00-0400</timestampReceived><subject>Re: [libvirt-users] (no subject)</subject><body>

On Thu, Aug 25, 2011 at 07:31:31PM +0800, lingjiao.lc wrote:
&gt; Hi,
&gt;   I've used the libvirt and sheepdog, they are so great!
&gt; But I have one question about libvirt and sheepdog.
&gt; As we know, I can use this command to create a sheepdog image,
&gt; 
&gt;          #qemu-img create –f raw sheepdog:fedora15.img 40G
&gt; 
&gt; but how can I create a pool and volume for sheepdog with the xml of libvirt ?

Libvirt doesn't have a pool/volume implementation for sheepdog yet.
You can currently only configure the guest XML with sheepdog
We'd like sheepdog pool support in the future of course...

Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110705202706</emailId><senderName>Abhishek Gupta</senderName><senderEmail>abhishekgupta.iitd@gmail.com</senderEmail><timestampReceived>2011-07-05 20:27:06-0400</timestampReceived><subject>[libvirt-users] (no subject)</subject><body>

Hello

I am having a libvirt installation on kvm, ubuntu 10.04. A few months ago, I
setup a cloud on the hypervisors which was functioning really cool. But from
last two-three days I am getting following error on using function
snapshotListNames in python.

&gt;&gt;&gt; snapshots=dom.snapshotListNames(0)
libvir: Remote error : unknown procedure: 187
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
  File "/usr/lib/python2.7/dist-packages/libvirt.py", line 890, in
snapshotListNames
    if ret is None: raise libvirtError ('virDomainSnapshotListNames()
failed', dom=self)
libvirt.libvirtError: unknown procedure: 187


Any ideas so as what could be causing the error?

-- 
Abhishek
Webpage &lt;http://abhishekgupta92.info/&gt; !!! Blog&lt;http://thelazy.info/abhishek&gt;

[Attachment #3 (text/html)]

Hello&lt;br&gt;&lt;br&gt;I am having a libvirt installation on kvm, ubuntu 10.04. A few months \
ago, I setup a cloud on the hypervisors which was functioning really cool. But from \
last two-three days I am getting following error on using function snapshotListNames \
in python.&lt;br&gt; &lt;br&gt;&gt;&gt;&gt; snapshots=dom.snapshotListNames(0)&lt;br&gt;libvir: Remote \
error : unknown procedure: 187&lt;br&gt;Traceback (most recent call last):&lt;br&gt;  File \
"&lt;stdin&gt;", line 1, in &lt;module&gt;&lt;br&gt;  File \
"/usr/lib/python2.7/dist-packages/libvirt.py", line 890, in \
snapshotListNames&lt;br&gt;  if ret is None: raise libvirtError \
('virDomainSnapshotListNames() failed', dom=self)&lt;br&gt;libvirt.libvirtError: \
unknown procedure: 187&lt;br clear="all"&gt;&lt;br&gt;&lt;br&gt;Any ideas so as what could be causing \
                the error?&lt;br&gt;&lt;br&gt;
-- &lt;br&gt;Abhishek&lt;br&gt;&lt;a href="http://abhishekgupta92.info/" target="_blank"&gt;Webpage&lt;/a&gt; \
!!! &lt;a href="http://thelazy.info/abhishek" target="_blank"&gt;Blog&lt;/a&gt;&lt;br&gt;&lt;br&gt;



</body></email><email><emailId>20110515123754</emailId><senderName>Abhishek Gupta</senderName><senderEmail>abhishekgupta.iitd@gmail.com</senderEmail><timestampReceived>2011-05-15 12:37:54-0400</timestampReceived><subject>[libvirt-users] (no subject)</subject><body>

Hello,

I am using python bindings of libvirt. When I use the function
listDomainsID( ) it successfully returns me the list of the ids of my
current virtual machines, but when I call function listDefinedDomains( ) it
returns me an empty list.

Is this some kind of bug because as per my understanding listDefinedDomains
should return a superset of vm's as returned by listDefinedDomains().

I am using 0.8.8 version of the libvirt.

--
Thanks
Abhishek

[Attachment #3 (text/html)]

Hello,&lt;br&gt;&lt;br&gt;I am using python bindings of libvirt. When I use the function \
listDomainsID( ) it successfully returns me the list of the ids of my current virtual \
machines, but when I call function listDefinedDomains( ) it returns me an empty \
list.&lt;br&gt; &lt;br&gt;Is this some kind of bug because as per my understanding \
listDefinedDomains should return a superset of vm's as returned by \
listDefinedDomains().&lt;br&gt;&lt;br&gt;I am using 0.8.8 version of the \
libvirt.&lt;br&gt;&lt;br&gt;--&lt;br&gt;Thanks&lt;br&gt; Abhishek&lt;br&gt;



</body></email><email><emailId>20110515124923</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-05-15 12:49:23-0400</timestampReceived><subject>Re: [libvirt-users] (no subject)</subject><body>

2011/5/15 Abhishek Gupta &lt;abhishekgupta.iitd@gmail.com&gt;:
&gt; Hello,
&gt;
&gt; I am using python bindings of libvirt. When I use the function
&gt; listDomainsID( ) it successfully returns me the list of the ids of my
&gt; current virtual machines, but when I call function listDefinedDomains( ) it
&gt; returns me an empty list.

That's correct. In your case all known VMs are running.

&gt; Is this some kind of bug because as per my understanding listDefinedDomains
&gt; should return a superset of vm's as returned by listDefinedDomains().

listDefinedDomains doesn't return a superset, it just returns the list
of known but non-running VMs, it doesn't return all known VMs. To get
the list of all known VMs you need to combine the lists returned by
listDomainsID and listDefinedDomains.

Matthias

</body></email><email><emailId>20110515131243</emailId><senderName>Abhishek Gupta</senderName><senderEmail>abhishekgupta.iitd@gmail.com</senderEmail><timestampReceived>2011-05-15 13:12:43-0400</timestampReceived><subject>Re: [libvirt-users] (no subject)</subject><body>

Thanks a lot. This did the trick.

On 15 May 2011 18:19, Matthias Bolte &lt;matthias.bolte@googlemail.com&gt; wrote:

&gt; 2011/5/15 Abhishek Gupta &lt;abhishekgupta.iitd@gmail.com&gt;:
&gt; &gt; Hello,
&gt; &gt;
&gt; &gt; I am using python bindings of libvirt. When I use the function
&gt; &gt; listDomainsID( ) it successfully returns me the list of the ids of my
&gt; &gt; current virtual machines, but when I call function listDefinedDomains( )
&gt; it
&gt; &gt; returns me an empty list.
&gt;
&gt; That's correct. In your case all known VMs are running.
&gt;
&gt; &gt; Is this some kind of bug because as per my understanding
&gt; listDefinedDomains
&gt; &gt; should return a superset of vm's as returned by listDefinedDomains().
&gt;
&gt; listDefinedDomains doesn't return a superset, it just returns the list
&gt; of known but non-running VMs, it doesn't return all known VMs. To get
&gt; the list of all known VMs you need to combine the lists returned by
&gt; listDomainsID and listDefinedDomains.
&gt;
&gt; Matthias
&gt;

[Attachment #3 (text/html)]

Thanks a lot. This did the trick.&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On 15 May 2011 \
18:19, Matthias Bolte &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt; &lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt;2011/5/15 Abhishek Gupta &lt;&lt;a \
href="mailto:abhishekgupta.iitd@gmail.com"&gt;abhishekgupta.iitd@gmail.com&lt;/a&gt;&gt;:&lt;br&gt; \
&lt;div class="im"&gt;&gt; Hello,&lt;br&gt; &gt;&lt;br&gt;
&gt; I am using python bindings of libvirt. When I use the function&lt;br&gt;
&gt; listDomainsID( ) it successfully returns me the list of the ids of my&lt;br&gt;
&gt; current virtual machines, but when I call function listDefinedDomains( ) it&lt;br&gt;
&gt; returns me an empty list.&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;That's correct. In your case all known VMs are running.&lt;br&gt;
&lt;div class="im"&gt;&lt;br&gt;
&gt; Is this some kind of bug because as per my understanding listDefinedDomains&lt;br&gt;
&gt; should return a superset of vm's as returned by listDefinedDomains().&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;listDefinedDomains doesn't return a superset, it just returns the list&lt;br&gt;
of known but non-running VMs, it doesn't return all known VMs. To get&lt;br&gt;
the list of all known VMs you need to combine the lists returned by&lt;br&gt;
listDomainsID and listDefinedDomains.&lt;br&gt;
&lt;font color="#888888"&gt;&lt;br&gt;
Matthias&lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110515135744</emailId><senderName>Abhishek Gupta</senderName><senderEmail>abhishekgupta.iitd@gmail.com</senderEmail><timestampReceived>2011-05-15 13:57:44-0400</timestampReceived><subject>[libvirt-users] (no subject)</subject><body>

Hello,

In the documentation section of Python API Website it is written that the
generation of python API and documentation is automated using generator.py
file. This should produce the necessary files alongwith the documentation in
libvirtclass.txt which should be present in docs or python folder.

I executed generator.py file but was not able to find the libvirtclass.txt
file to get the documentation.

The easiest way I could think of was to manually browse the libvirt.py file
for the available functions. Is there any other way of doing the same?

--
Abhishek

[Attachment #3 (text/html)]

Hello,&lt;br&gt;&lt;br&gt;In the documentation section of Python API Website it is writ=
ten that the generation of python API and documentation is automated using =
generator.py file. This should produce the necessary files alongwith the do=
cumentation in libvirtclass.txt which should be present in docs or python f=
older.&lt;br&gt;
&lt;br&gt;I executed generator.py file but was not able to find the libvirtclass.=
txt file to get the documentation.&lt;br&gt;&lt;br&gt;The easiest way I could think of =
was to manually browse the libvirt.py file for the available functions. Is =
there any other way of doing the same?&lt;br&gt;
&lt;br&gt;--&lt;br&gt;Abhishek&lt;br&gt;


</body></email><email><emailId>20110516064826</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2011-05-16 06:48:26-0400</timestampReceived><subject>Re: [libvirt-users] (no subject)</subject><body>

On Sun, May 15, 2011 at 07:15:44PM +0530, Abhishek Gupta wrote:
&gt; Hello,
&gt; 
&gt; In the documentation section of Python API Website it is written that the
&gt; generation of python API and documentation is automated using generator.py
&gt; file. This should produce the necessary files alongwith the documentation in
&gt; libvirtclass.txt which should be present in docs or python folder.
&gt; 
&gt; I executed generator.py file but was not able to find the libvirtclass.txt
&gt; file to get the documentation.
&gt; 
&gt; The easiest way I could think of was to manually browse the libvirt.py file
&gt; for the available functions. Is there any other way of doing the same?

  yes the libvirtclass.txt output has been removed since the time the
documentation page was written (it's old and a revamp is in order ...)
As you found out most of the informations goes directly in the generated
libvirt.py file, it's probably the most convenient anyway since there is
only one file now, but the documentation need to be updated !

Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

</body></email><email><emailId>20110516131149</emailId><senderName>Abhishek Gupta</senderName><senderEmail>w2lame@gmail.com</senderEmail><timestampReceived>2011-05-16 13:11:49-0400</timestampReceived><subject>[libvirt-users] (no subject)</subject><body>

Hi,

I am using libvirt and virsh for my application. I am trying to manage
snapshots for my infrastructure. All virsh commands are working fine like
snapshot-create, delete, list, revert, current.

But when I try to do the same using libvirt, I get out of memory error. Here
are the commands that i execute on my host in a python shell...

import libvirt
conn = libvirt.open("qemu:///system")
dom = conn.lookupByName("vmtest")

*snap = dom.snapshotCreateXML(None,0);*

The error is as follows

libvir: Remote error : out of memory
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
  File "/usr/lib/python2.6/dist-packages/libvirt.py", line 669, in
snapshotCreateXML
    if ret is None:raise libvirtError('virDomainSnapshotCreateXML() failed',
dom=self)
libvirt.libvirtError: out of memory

[Attachment #3 (text/html)]

Hi,&lt;br&gt;&lt;br&gt;I am using libvirt and virsh for my application. I am trying to manage \
snapshots for my infrastructure. All virsh commands are working fine like \
snapshot-create, delete, list, revert, current. &lt;br&gt;&lt;br&gt;But when I try to do the same \
using libvirt, I get out of memory error. Here are the commands that i execute on my \
host in a python shell...&lt;br&gt; &lt;br&gt;import libvirt&lt;br&gt;conn = \
libvirt.open("qemu:///system")&lt;br&gt;dom = \
conn.lookupByName("vmtest")&lt;br&gt;&lt;br&gt;&lt;i&gt;snap = \
dom.snapshotCreateXML(None,0);&lt;/i&gt;&lt;br&gt;&lt;br&gt;The error is as follows&lt;br&gt;&lt;br&gt;libvir: \
Remote error : out of memory&lt;br&gt; Traceback (most recent call last):&lt;br&gt;  File \
"&lt;stdin&gt;", line 1, in &lt;module&gt;&lt;br&gt;  File \
"/usr/lib/python2.6/dist-packages/libvirt.py", line 669, in \
snapshotCreateXML&lt;br&gt;    if ret is None:raise \
                libvirtError('virDomainSnapshotCreateXML() failed', \
                dom=self)&lt;br&gt;
libvirt.libvirtError: out of memory&lt;br&gt;



</body></email><email><emailId>20110516165659</emailId><senderName>Abhishek Gupta</senderName><senderEmail>w2lame@gmail.com</senderEmail><timestampReceived>2011-05-16 16:56:59-0400</timestampReceived><subject>Re: [libvirt-users] (no subject)</subject><body>

Hello,

Sorry, I figured out the error. Instead of none I need to send the xml file
for the same. But still I am unable to understand the relevance of the error
reported in the present context.


On 16 May 2011 18:29, Abhishek Gupta &lt;w2lame@gmail.com&gt; wrote:

&gt; Hi,
&gt;
&gt; I am using libvirt and virsh for my application. I am trying to manage
&gt; snapshots for my infrastructure. All virsh commands are working fine like
&gt; snapshot-create, delete, list, revert, current.
&gt;
&gt; But when I try to do the same using libvirt, I get out of memory error.
&gt; Here are the commands that i execute on my host in a python shell...
&gt;
&gt; import libvirt
&gt; conn = libvirt.open("qemu:///system")
&gt; dom = conn.lookupByName("vmtest")
&gt;
&gt; *snap = dom.snapshotCreateXML(None,0);*
&gt;
&gt; The error is as follows
&gt;
&gt; libvir: Remote error : out of memory
&gt; Traceback (most recent call last):
&gt;   File "&lt;stdin&gt;", line 1, in &lt;module&gt;
&gt;   File "/usr/lib/python2.6/dist-packages/libvirt.py", line 669, in
&gt; snapshotCreateXML
&gt;     if ret is None:raise libvirtError('virDomainSnapshotCreateXML()
&gt; failed', dom=self)
&gt; libvirt.libvirtError: out of memory
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

[Attachment #3 (text/html)]

Hello,&lt;br&gt;&lt;br&gt;Sorry, I figured out the error. Instead of none I need to send the xml \
file for the same. But still I am unable to understand the relevance of the error \
reported in the present context.&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt; On 16 May 2011 \
18:29, Abhishek Gupta &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:w2lame@gmail.com"&gt;w2lame@gmail.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt; Hi,&lt;br&gt;&lt;br&gt;I am using libvirt and virsh for my application. \
I am trying to manage snapshots for my infrastructure. All virsh commands are working \
fine like snapshot-create, delete, list, revert, current. &lt;br&gt;&lt;br&gt;But when I try to \
do the same using libvirt, I get out of memory error. Here are the commands that i \
execute on my host in a python shell...&lt;br&gt;

&lt;br&gt;import libvirt&lt;br&gt;conn = libvirt.open("qemu:///system")&lt;br&gt;dom = \
conn.lookupByName("vmtest")&lt;br&gt;&lt;br&gt;&lt;i&gt;snap = \
dom.snapshotCreateXML(None,0);&lt;/i&gt;&lt;br&gt;&lt;br&gt;The error is as follows&lt;br&gt;&lt;br&gt;libvir: \
Remote error : out of memory&lt;br&gt;

Traceback (most recent call last):&lt;br&gt;  File "&lt;stdin&gt;", line 1, in \
&lt;module&gt;&lt;br&gt;  File "/usr/lib/python2.6/dist-packages/libvirt.py", \
line 669, in snapshotCreateXML&lt;br&gt;    if ret is None:raise \
libvirtError('virDomainSnapshotCreateXML() failed', dom=self)&lt;br&gt;

libvirt.libvirtError: out of memory&lt;br&gt;
&lt;br&gt;_______________________________________________&lt;br&gt;
libvirt-users mailing list&lt;br&gt;
&lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
&lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;




</body></email><email><emailId>20110516172511</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-05-16 17:25:11-0400</timestampReceived><subject>Re: [libvirt-users] (no subject)</subject><body>

The out of memory error is probably a bug in libvirt. What libvirt
version are you using?

Matthias

2011/5/16 Abhishek Gupta &lt;w2lame@gmail.com&gt;:
&gt; Hello,
&gt;
&gt; Sorry, I figured out the error. Instead of none I need to send the xml file
&gt; for the same. But still I am unable to understand the relevance of the error
&gt; reported in the present context.
&gt;
&gt;
&gt; On 16 May 2011 18:29, Abhishek Gupta &lt;w2lame@gmail.com&gt; wrote:
&gt;&gt;
&gt;&gt; Hi,
&gt;&gt;
&gt;&gt; I am using libvirt and virsh for my application. I am trying to manage
&gt;&gt; snapshots for my infrastructure. All virsh commands are working fine like
&gt;&gt; snapshot-create, delete, list, revert, current.
&gt;&gt;
&gt;&gt; But when I try to do the same using libvirt, I get out of memory error.
&gt;&gt; Here are the commands that i execute on my host in a python shell...
&gt;&gt;
&gt;&gt; import libvirt
&gt;&gt; conn = libvirt.open("qemu:///system")
&gt;&gt; dom = conn.lookupByName("vmtest")
&gt;&gt;
&gt;&gt; snap = dom.snapshotCreateXML(None,0);
&gt;&gt;
&gt;&gt; The error is as follows
&gt;&gt;
&gt;&gt; libvir: Remote error : out of memory
&gt;&gt; Traceback (most recent call last):
&gt;&gt;   File "&lt;stdin&gt;", line 1, in &lt;module&gt;
&gt;&gt;   File "/usr/lib/python2.6/dist-packages/libvirt.py", line 669, in
&gt;&gt; snapshotCreateXML
&gt;&gt;     if ret is None:raise libvirtError('virDomainSnapshotCreateXML()
&gt;&gt; failed', dom=self)
&gt;&gt; libvirt.libvirtError: out of memory
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; libvirt-users mailing list
&gt;&gt; libvirt-users@redhat.com
&gt;&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

</body></email><email><emailId>20111013060021</emailId><senderName>d hee</senderName><senderEmail>coolio@ymail.com</senderEmail><timestampReceived>2011-10-13 06:00:21-0400</timestampReceived><subject>[libvirt-users] Virtio Balloon- Can not see the results</subject><body>

with kvm and virtio- would -m 1024 take proceedence over -balloon 
virtio? when i use both together, i see memory stay around 1024 MB less on my host \
side. I know the guest is not taking but a fraction of that ram, so I would expect \
the virtio balloon to take the majority of the guests ram and hand it back to the \
host. this is using the free util/command to take snapshots of the host memory. 

thanks,
-dman


[Attachment #3 (text/html)]

&lt;html&gt;&lt;body&gt;&lt;div style="color:#000; background-color:#fff; font-family:arial, \
helvetica, sans-serif;font-size:10pt"&gt;&lt;div&gt;with kvm and virtio- would -m 1024 take \
proceedence over -balloon  virtio? when i use both together, i see memory stay around \
1024 MB less on my host side. I know the guest is not taking but a fraction of that \
ram, so I would expect the virtio balloon to take the majority of the guests ram and \
hand it back to the host. this is using the free util/command to take snapshots of \
the host memory. &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;thanks,&lt;/div&gt;&lt;div&gt;-dman&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;




</body></email><email><emailId>20111010125723</emailId><senderName></senderName><senderEmail>zlh_086@126.com</senderEmail><timestampReceived>2011-10-10 12:57:23-0400</timestampReceived><subject>[libvirt-users] no connection driver available for openvz:///system</subject><body>

dears.
I can not solved the problem:
 vzctl works. But how do I connect to Virtuozzo? Using the openvz
&gt;&gt; &gt; driver
&gt;&gt; &gt; it doesn't work out of the box:
&gt;&gt; &gt; virsh # connect openvz:///system
&gt;&gt; &gt; error: Failed to connect to the hypervisor
&gt;&gt; &gt; error: no connection driver available for openvz:///system


Why can not I connect to the openvz???
please help me , thanks.



[Attachment #3 (text/html)]

&lt;div style="line-height:1.7;color:#000000;font-size:14px;font-family:arial"&gt; dears.&lt;br&gt;I \
can not solved the problem:&lt;pre&gt; vzctl works. But how do I connect to Virtuozzo? \
Using the openvz&lt;br&gt;&gt;&gt; &gt; driver&lt;br&gt;&gt;&gt; &gt; it doesn't work out of the \
box:&lt;br&gt;&gt;&gt; &gt; virsh # connect openvz:///system&lt;br&gt;&gt;&gt; &gt; error: Failed \
to connect to the hypervisor&lt;br&gt;&gt;&gt; &gt; error: no connection driver available \
for openvz:///system&lt;br&gt;&lt;br&gt;&lt;/pre&gt;&lt;div dir="ltr"&gt;Why can not I connect to the \
openvz???&lt;br&gt;please help me , thanks.&lt;br&gt;&lt;/div&gt;&lt;pre&gt;&lt;br&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;&lt;span \
title="neteasefooter"&gt;&lt;span id="netease_mail_footer"&gt;&lt;/span&gt;&lt;/span&gt;



</body></email><email><emailId>20111020062722</emailId><senderName>Alex</senderName><senderEmail>mysqlstudent@gmail.com</senderEmail><timestampReceived>2011-10-20 06:27:22-0400</timestampReceived><subject>[libvirt-users] Identifying proper CPU type</subject><body>

Hi,

I've been working on trying to figure out why my virtual machine keeps
crashing when I don't believe I have a hardware problem, and I believe
I might know why. As I'm relatively new to this, I believe I may have
misconfigured the XML file to try and maximize the CPU features that
are available to the guest from the host.

I have an Intel Xeon E3-1240 3.3Ghz quad-core. How can I properly
configure the XML file to transparently make available as many of the
CPU features as possible to the guest?

I have read cpu_map.xml, and my processor has more capabilities than
anything listed. I've now configured the &lt;cpu&gt; section to read as
follows:

  &lt;cpu&gt;
    &lt;topology sockets='1' cores='4' threads='2'/&gt;
  &lt;/cpu&gt;

The guest processor still seems to indicate there is only one core,
despite there being 7 processors? Below is the cpuinfo from the host,
followed by that of the guest:

processor       : 7
vendor_id       : GenuineIntel
cpu family      : 6
model           : 42
model name      : Intel(R) Xeon(R) CPU E31240 @ 3.30GHz
stepping        : 7
cpu MHz         : 3301.000
cache size      : 8192 KB
physical id     : 0
siblings        : 8
core id         : 3
cpu cores       : 4
apicid          : 7
initial apicid  : 7
fpu             : yes
fpu_exception   : yes
cpuid level     : 13
wp              : yes
flags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge
mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe
syscall nx rdtscp lm constant_tsc arch_perfmon pebs bts rep_good nopl
xtopology nonstop_tsc aperfmperf pni pclmulqdq dtes64 monitor ds_cpl
vmx smx est tm2 ssse3 cx16 xtpr pdcm sse4_1 sse4_2 x2apic popcnt aes
xsave avx lahf_lm ida arat epb xsaveopt pln pts dts tpr_shadow vnmi
flexpriority ept vpid
bogomips        : 6584.20
clflush size    : 64
cache_alignment : 64
address sizes   : 36 bits physical, 48 bits virtual
power management:

Guest:
processor       : 7
vendor_id       : GenuineIntel
cpu family      : 6
model           : 2
model name      : QEMU Virtual CPU version 0.14.0
stepping        : 3
cpu MHz         : 3292.520
cache size      : 4096 KB
physical id     : 0
siblings        : 8
core id         : 0
cpu cores       : 1
apicid          : 0
initial apicid  : 0
fpu             : yes
fpu_exception   : yes
cpuid level     : 4
wp              : yes
flags           : fpu de pse tsc msr pae mce cx8 apic sep mtrr pge mca
cmov pse36 clflush mmx fxsr sse sse2 ht syscall nx lm rep_good nopl
pni cx16 popcnt hypervisor lahf_lm
bogomips        : 6585.04
clflush size    : 64
cache_alignment : 64
address sizes   : 40 bits physical, 48 bits virtual
power management:

Any ideas greatly appreciated.
Thanks,
Alex

</body></email><email><emailId>20110601231721</emailId><senderName>Chun Tat David Chu</senderName><senderEmail>beyonddc.storage@gmail.com</senderEmail><timestampReceived>2011-06-01 23:17:21-0400</timestampReceived><subject>[libvirt-users] libvirtError: internal error Domain mytest didn't show up</subject><body>

Hi All,

I am new using libvirt.

I kept on getting the following error when I try to start my VM.  Can anyone
give me any suggestion on what could went wrong?

Traceback (most recent call last):
  File "/usr/share/virt-manager/virtManager/engine.py", line 498, in
run_domain
    vm.startup()
  File "/usr/share/virt-manager/virtManager/domain.py", line 573, in startup
    self.vm.create()
  File "/usr/lib64/python2.4/site-packages/libvirt.py", line 287, in create
    if ret == -1: raise libvirtError ('virDomainCreate() failed', dom=self)
libvirtError: internal error Domain mytest didn't show up

Thanks,

David

[Attachment #3 (text/html)]

Hi All,&lt;br&gt;&lt;br&gt;I am new using libvirt.&lt;br&gt;&lt;br&gt;I kept on getting the following error \
when I try to start my VM.  Can anyone give me any suggestion on what could went \
wrong?&lt;br&gt;&lt;br&gt;Traceback (most recent call last):&lt;br&gt;  File \
"/usr/share/virt-manager/virtManager/engine.py", line 498, in \
run_domain&lt;br&gt;  vm.startup()&lt;br&gt;  File \
"/usr/share/virt-manager/virtManager/domain.py", line 573, in startup&lt;br&gt;   \
self.vm.create()&lt;br&gt;  File "/usr/lib64/python2.4/site-packages/libvirt.py", \
line 287, in create&lt;br&gt;  if ret == -1: raise libvirtError ('virDomainCreate() \
failed', dom=self)&lt;br&gt;libvirtError: internal error Domain mytest didn't show \
up&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;&lt;br&gt;David&lt;br&gt;



</body></email><email><emailId>20110701132247</emailId><senderName>"Zeeshan Ali (Khattak)"</senderName><senderEmail>zeeshanak@gnome.org</senderEmail><timestampReceived>2011-07-01 13:22:47-0400</timestampReceived><subject>[libvirt-users] [PATCH] Use correct param names in Product getters</subject><body>

From: "Zeeshan Ali (Khattak)" &lt;zeeshanak@gnome.org&gt;

---
 osinfo/osinfo_product.c |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/osinfo/osinfo_product.c b/osinfo/osinfo_product.c
index 89e01bd..bbbcf67 100644
--- a/osinfo/osinfo_product.c
+++ b/osinfo/osinfo_product.c
@@ -158,15 +158,15 @@ void osinfo_product_add_related(OsinfoProduct *product, OsinfoProductRelationshi
 
 const gchar *osinfo_product_get_vendor(OsinfoProduct *prod)
 {
-    return osinfo_entity_get_param_value(OSINFO_ENTITY(prod), OSINFO_PRODUCT_PROP_NAME);
+    return osinfo_entity_get_param_value(OSINFO_ENTITY(prod), OSINFO_PRODUCT_PROP_VENDOR);
 }
 const gchar *osinfo_product_get_version(OsinfoProduct *prod)
 {
-    return osinfo_entity_get_param_value(OSINFO_ENTITY(prod), OSINFO_PRODUCT_PROP_NAME);
+    return osinfo_entity_get_param_value(OSINFO_ENTITY(prod), OSINFO_PRODUCT_PROP_VERSION);
 }
 const gchar *osinfo_product_get_short_id(OsinfoProduct *prod)
 {
-    return osinfo_entity_get_param_value(OSINFO_ENTITY(prod), OSINFO_PRODUCT_PROP_NAME);
+    return osinfo_entity_get_param_value(OSINFO_ENTITY(prod), OSINFO_PRODUCT_PROP_SHORT_ID);
 }
 const gchar *osinfo_product_get_name(OsinfoProduct *prod)
 {
-- 
1.7.5.4

</body></email><email><emailId>20110802001525</emailId><senderName>Trey Dockendorf</senderName><senderEmail>treydock@gmail.com</senderEmail><timestampReceived>2011-08-02 00:15:25-0400</timestampReceived><subject>[libvirt-users] Snapshot error "command savevm not found"</subject><body>

Attempting to take snapshots of VM using virsh with the following command,

# virsh -c qemu:///system snapshot-create CentOS6-x86-001

Results in the following error,

error: internal error unable to execute QEMU command 'savevm': The command
savevm has not been found

The VM's virtual disks are qcow2.  Below is the XML file for this vm

------------
&lt;domain type='kvm' id='6'&gt;
  &lt;name&gt;CentOS6-x86-001&lt;/name&gt;
  &lt;uuid&gt;050fb9d8-0b9a-48b9-a432-16eec57a9e8f&lt;/uuid&gt;
  &lt;memory&gt;1024000&lt;/memory&gt;
  &lt;currentMemory&gt;1024000&lt;/currentMemory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='x86_64' machine='rhel6.0.0'&gt;hvm&lt;/type&gt;
    &lt;boot dev='hd'/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
    &lt;apic/&gt;
    &lt;pae/&gt;
  &lt;/features&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;restart&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/libexec/qemu-kvm&lt;/emulator&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;driver name='qemu' type='qcow2' cache='none'/&gt;
      &lt;source file='/vmstore/CentOS6-x86-001/CentOS6-x86-001_sys.qcow2'/&gt;
      &lt;target dev='vda' bus='virtio'/&gt;
      &lt;alias name='virtio-disk0'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x04'
function='0x0'/&gt;
    &lt;/disk&gt;
    &lt;disk type='file' device='cdrom'&gt;
      &lt;driver name='qemu' type='raw'/&gt;
      &lt;target dev='hdc' bus='ide'/&gt;
      &lt;readonly/&gt;
      &lt;alias name='ide0-1-0'/&gt;
      &lt;address type='drive' controller='0' bus='1' unit='0'/&gt;
    &lt;/disk&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;driver name='qemu' type='qcow2'/&gt;
      &lt;source file='/vmstore/CentOS6-x86-001/CentOS6-x86-001_var.img'/&gt;
      &lt;target dev='vdb' bus='virtio'/&gt;
      &lt;alias name='virtio-disk1'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x06'
function='0x0'/&gt;
    &lt;/disk&gt;
    &lt;controller type='ide' index='0'&gt;
      &lt;alias name='ide0'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x01'
function='0x1'/&gt;
    &lt;/controller&gt;
    &lt;interface type='bridge'&gt;
      &lt;mac address='52:54:00:4d:74:c7'/&gt;
      &lt;source bridge='br0'/&gt;
      &lt;target dev='vnet0'/&gt;
      &lt;model type='virtio'/&gt;
      &lt;alias name='net0'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03'
function='0x0'/&gt;
    &lt;/interface&gt;
    &lt;serial type='pty'&gt;
      &lt;source path='/dev/pts/1'/&gt;
      &lt;target port='0'/&gt;
      &lt;alias name='serial0'/&gt;
    &lt;/serial&gt;
    &lt;console type='pty' tty='/dev/pts/1'&gt;
      &lt;source path='/dev/pts/1'/&gt;
      &lt;target port='0'/&gt;
      &lt;alias name='serial0'/&gt;
    &lt;/console&gt;
    &lt;input type='tablet' bus='usb'&gt;
      &lt;alias name='input0'/&gt;
    &lt;/input&gt;
    &lt;input type='mouse' bus='ps2'/&gt;
    &lt;graphics type='vnc' port='5900' autoport='yes'/&gt;
    &lt;video&gt;
      &lt;model type='cirrus' vram='9216' heads='1'/&gt;
      &lt;alias name='video0'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x02'
function='0x0'/&gt;
    &lt;/video&gt;
    &lt;memballoon model='virtio'&gt;
      &lt;alias name='balloon0'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x05'
function='0x0'/&gt;
    &lt;/memballoon&gt;
  &lt;/devices&gt;
  &lt;seclabel type='dynamic' model='selinux'&gt;
    &lt;label&gt;system_u:system_r:svirt_t:s0:c292,c580&lt;/label&gt;
    &lt;imagelabel&gt;system_u:object_r:svirt_image_t:s0:c292,c580&lt;/imagelabel&gt;
  &lt;/seclabel&gt;
&lt;/domain&gt;


------------

This is my first attempt at snapshots with KVM after migrating from ESXi, so
if there's a better method please let me know.

Thanks
- Trey

[Attachment #3 (text/html)]

&lt;meta charset="utf-8"&gt;&lt;span class="Apple-style-span" style="border-collapse: \
collapse; font-family: arial, sans-serif; font-size: 13px; "&gt;Attempting to take \
snapshots of VM using virsh with the following command,&lt;div&gt;&lt;br&gt;&lt;/div&gt; &lt;div&gt;# virsh \
-c qemu:///system snapshot-create CentOS6-x86-001&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Results in \
the following error,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;error: internal error unable to execute \
QEMU command 'savevm': The command savevm has not been found&lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The VM's virtual disks are qcow2.  Below is the XML file for \
this vm&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;------------&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;domain \
type='kvm' id='6'&gt;&lt;/div&gt;&lt;div&gt;  \
&lt;name&gt;CentOS6-x86-001&lt;/name&gt;&lt;/div&gt; &lt;div&gt;  \
&lt;uuid&gt;050fb9d8-0b9a-48b9-a432-16eec57a9e8f&lt;/uuid&gt;&lt;/div&gt;&lt;div&gt;  \
&lt;memory&gt;1024000&lt;/memory&gt;&lt;/div&gt;&lt;div&gt;  \
&lt;currentMemory&gt;1024000&lt;/currentMemory&gt;&lt;/div&gt;&lt;div&gt;  \
&lt;vcpu&gt;1&lt;/vcpu&gt;&lt;/div&gt; &lt;div&gt;  &lt;os&gt;&lt;/div&gt;&lt;div&gt;    &lt;type \
arch='x86_64' machine='rhel6.0.0'&gt;hvm&lt;/type&gt;&lt;/div&gt;&lt;div&gt;    \
&lt;boot dev='hd'/&gt;&lt;/div&gt;&lt;div&gt;  &lt;/os&gt;&lt;/div&gt;&lt;div&gt;  \
&lt;features&gt;&lt;/div&gt;&lt;div&gt;    &lt;acpi/&gt;&lt;/div&gt; &lt;div&gt;    &lt;apic/&gt;&lt;/div&gt;&lt;div&gt;  \
&lt;pae/&gt;&lt;/div&gt;&lt;div&gt;  &lt;/features&gt;&lt;/div&gt;&lt;div&gt;  &lt;clock \
offset='utc'/&gt;&lt;/div&gt;&lt;div&gt;  \
&lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;&lt;/div&gt;&lt;div&gt;  \
&lt;on_reboot&gt;restart&lt;/on_reboot&gt;&lt;/div&gt; &lt;div&gt;  \
&lt;on_crash&gt;restart&lt;/on_crash&gt;&lt;/div&gt;&lt;div&gt;  &lt;devices&gt;&lt;/div&gt;&lt;div&gt;    \
&lt;emulator&gt;/usr/libexec/qemu-kvm&lt;/emulator&gt;&lt;/div&gt;&lt;div&gt;    &lt;disk \
type='file' device='disk'&gt;&lt;/div&gt;&lt;div&gt;  &lt;driver \
name='qemu' type='qcow2' cache='none'/&gt;&lt;/div&gt;&lt;div&gt;      \
&lt;source file='/vmstore/CentOS6-x86-001/CentOS6-x86-001_sys.qcow2'/&gt;&lt;/div&gt;&lt;div&gt; \
&lt;target dev='vda' bus='virtio'/&gt;&lt;/div&gt; &lt;div&gt;      &lt;alias \
name='virtio-disk0'/&gt;&lt;/div&gt;&lt;div&gt;      &lt;address type='pci' \
domain='0x0000' bus='0x00' slot='0x04' \
function='0x0'/&gt;&lt;/div&gt;&lt;div&gt;    &lt;/disk&gt;&lt;/div&gt; &lt;div&gt;    &lt;disk \
type='file' device='cdrom'&gt;&lt;/div&gt;&lt;div&gt;      &lt;driver \
name='qemu' type='raw'/&gt;&lt;/div&gt;&lt;div&gt;      &lt;target \
dev='hdc' bus='ide'/&gt;&lt;/div&gt;&lt;div&gt;      &lt;readonly/&gt;&lt;/div&gt; \
&lt;div&gt;      &lt;alias name='ide0-1-0'/&gt;&lt;/div&gt;&lt;div&gt;      &lt;address \
type='drive' controller='0' bus='1' \
unit='0'/&gt;&lt;/div&gt;&lt;div&gt;    &lt;/disk&gt;&lt;/div&gt;&lt;div&gt;    &lt;disk \
type='file' device='disk'&gt;&lt;/div&gt; &lt;div&gt;      &lt;driver \
name='qemu' type='qcow2'/&gt;&lt;/div&gt;&lt;div&gt;      &lt;source \
file='/vmstore/CentOS6-x86-001/CentOS6-x86-001_var.img'/&gt;&lt;/div&gt;&lt;div&gt;      \
&lt;target dev='vdb' bus='virtio'/&gt;&lt;/div&gt; &lt;div&gt;      &lt;alias \
name='virtio-disk1'/&gt;&lt;/div&gt;&lt;div&gt;      &lt;address type='pci' \
domain='0x0000' bus='0x00' slot='0x06' \
function='0x0'/&gt;&lt;/div&gt;&lt;div&gt;    &lt;/disk&gt;&lt;/div&gt; &lt;div&gt;    &lt;controller \
type='ide' index='0'&gt;&lt;/div&gt;&lt;div&gt;      &lt;alias \
name='ide0'/&gt;&lt;/div&gt;&lt;div&gt;      &lt;address type='pci' \
domain='0x0000' bus='0x00' slot='0x01' \
function='0x1'/&gt;&lt;/div&gt; &lt;div&gt;    &lt;/controller&gt;&lt;/div&gt;&lt;div&gt;    \
&lt;interface type='bridge'&gt;&lt;/div&gt;&lt;div&gt;      &lt;mac \
address='52:54:00:4d:74:c7'/&gt;&lt;/div&gt;&lt;div&gt;      &lt;source \
bridge='br0'/&gt;&lt;/div&gt;&lt;div&gt;      &lt;target dev='vnet0'/&gt;&lt;/div&gt; \
&lt;div&gt;      &lt;model type='virtio'/&gt;&lt;/div&gt;&lt;div&gt;      &lt;alias \
name='net0'/&gt;&lt;/div&gt;&lt;div&gt;      &lt;address type='pci' \
domain='0x0000' bus='0x00' slot='0x03' \
function='0x0'/&gt;&lt;/div&gt; &lt;div&gt;    &lt;/interface&gt;&lt;/div&gt;&lt;div&gt;    \
&lt;serial type='pty'&gt;&lt;/div&gt;&lt;div&gt;      &lt;source \
path='/dev/pts/1'/&gt;&lt;/div&gt;&lt;div&gt;      &lt;target \
port='0'/&gt;&lt;/div&gt;&lt;div&gt;      &lt;alias name='serial0'/&gt;&lt;/div&gt; \
&lt;div&gt;    &lt;/serial&gt;&lt;/div&gt;&lt;div&gt;    &lt;console type='pty' \
tty='/dev/pts/1'&gt;&lt;/div&gt;&lt;div&gt;      &lt;source \
path='/dev/pts/1'/&gt;&lt;/div&gt;&lt;div&gt;      &lt;target \
port='0'/&gt;&lt;/div&gt;&lt;div&gt;      &lt;alias name='serial0'/&gt;&lt;/div&gt; \
&lt;div&gt;    &lt;/console&gt;&lt;/div&gt;&lt;div&gt;    &lt;input type='tablet' \
bus='usb'&gt;&lt;/div&gt;&lt;div&gt;      &lt;alias name='input0'/&gt;&lt;/div&gt;&lt;div&gt; \
&lt;/input&gt;&lt;/div&gt;&lt;div&gt;    &lt;input type='mouse' \
bus='ps2'/&gt;&lt;/div&gt; &lt;div&gt;    &lt;graphics type='vnc' \
port='5900' autoport='yes'/&gt;&lt;/div&gt;&lt;div&gt;    \
&lt;video&gt;&lt;/div&gt;&lt;div&gt;      &lt;model type='cirrus' vram='9216' \
heads='1'/&gt;&lt;/div&gt;&lt;div&gt;      &lt;alias name='video0'/&gt;&lt;/div&gt; \
&lt;div&gt;      &lt;address type='pci' domain='0x0000' bus='0x00' \
slot='0x02' function='0x0'/&gt;&lt;/div&gt;&lt;div&gt;    \
&lt;/video&gt;&lt;/div&gt;&lt;div&gt;    &lt;memballoon model='virtio'&gt;&lt;/div&gt; &lt;div&gt;    \
&lt;alias name='balloon0'/&gt;&lt;/div&gt;&lt;div&gt;      &lt;address type='pci' \
domain='0x0000' bus='0x00' slot='0x05' \
function='0x0'/&gt;&lt;/div&gt;&lt;div&gt;    &lt;/memballoon&gt;&lt;/div&gt; &lt;div&gt;  \
&lt;/devices&gt;&lt;/div&gt;&lt;div&gt;  &lt;seclabel type='dynamic' \
model='selinux'&gt;&lt;/div&gt;&lt;div&gt;    \
&lt;label&gt;system_u:system_r:svirt_t:s0:c292,c580&lt;/label&gt;&lt;/div&gt;&lt;div&gt;    \
&lt;imagelabel&gt;system_u:object_r:svirt_image_t:s0:c292,c580&lt;/imagelabel&gt;&lt;/div&gt;
 &lt;div&gt;  &lt;/seclabel&gt;&lt;/div&gt;&lt;div&gt;&lt;/domain&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;------------&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;This \
is my first attempt at snapshots with KVM after migrating from ESXi, so if \
there's a better method please let me know.&lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&lt;/div&gt;&lt;div&gt;- Trey&lt;/div&gt;&lt;/span&gt;



</body></email><email><emailId>20110903101900</emailId><senderName>Jatin Kumar</senderName><senderEmail>cs5090243@cse.iitd.ernet.in</senderEmail><timestampReceived>2011-09-03 10:19:00-0400</timestampReceived><subject>[libvirt-users] Char dev error</subject><body>

Hello,
I have been trying to migrate a guest from one host to another.
But it is showing this error:

 virsh --connect qemu+ssh://root@host1/system migrate --live
--undefinesource testvm3 qemu+ssh://root@host2/system
tcp://host2:48160
 error: operation failed: failed to retrieve chardev info in qemu with
'info chardev'

I have tried this command from the host1 also but it shows the same error.
Another thing i would like to ask is the that whats the use of
migrateuri in migrate command ?

--
Jatin Kumar

</body></email><email><emailId>20111003195350</emailId><senderName>David Goulet</senderName><senderEmail>dgoulet@ev0ke.net</senderEmail><timestampReceived>2011-10-03 19:53:50-0400</timestampReceived><subject>[libvirt-users] Usage serial device</subject><body>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hi,

I'm trying to connect the *same* serial device to two KVM Linux machines where
one is running KGDB and the other uses the connected serial to interact with the
target machine running under KGDB.

However, I'm unable to do so. Using a pty port, I am able to use my kgdb setup
with host/VM but unable to make it work with VM/VM since it's two different pty
created on the two machines.

Anyone on this list can help me with that kind of setup ?

Unfortunately, I must use libvirtd 0.7.5 for now... I'm aware that it might be a
version issue here but still...

Thanks!
David
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)

iQEcBAEBAgAGBQJOihLOAAoJEELoaioR9I02GawH/1Ux197Pj3F+Qf54LcI3yy+w
Vhd8yOGIAreBES7FUIf/7dCFqUz2mXFbtRuo9KZi+M0qs02kEs/nbhgOJLmHdZFA
iRdCprzCR4Ue1x8H/tVogfBElfGhlJDaPHx5KIsxDmXwPJYhrPBt8qhyzLSTVQZG
/pibv03sQdGRM6ZIyIhbA3ZmZ7Yh0SToGl3Fodw5Yp6YjrxRtpTu/OkHuHweM+nq
wxthsgVstAEjJSxwV5O1+GzQ8xVDzjvZTvSRXnU2mTKXTiW2CkbnPbDG7cYfAcdx
jICcAOf4AHtuKt5ZTfXFMUT4qSPfEntoXKsjt1IpCOpYH70GNGxLkh96SKjS1+w=
=AYT3
-----END PGP SIGNATURE-----

</body></email><email><emailId>20110903132820</emailId><senderName>Joseph Harnish</senderName><senderEmail>bigjoe1008@gmail.com</senderEmail><timestampReceived>2011-09-03 13:28:20-0400</timestampReceived><subject>Re: [libvirt-users] Char dev error</subject><body>

I have seen this when the port or the ip of the hypervisor was defined
in the XML config so it couldn't bind to that address when it migrated
over.

--Joe

Sent from my iPhone

On Sep 3, 2011, at 9:22 AM, Jatin Kumar &lt;cs5090243@cse.iitd.ernet.in&gt; wrote:

&gt; Hello,
&gt; I have been trying to migrate a guest from one host to another.
&gt; But it is showing this error:
&gt;
&gt; virsh --connect qemu+ssh://root@host1/system migrate --live
&gt; --undefinesource testvm3 qemu+ssh://root@host2/system
&gt; tcp://host2:48160
&gt; error: operation failed: failed to retrieve chardev info in qemu with
&gt; 'info chardev'
&gt;
&gt; I have tried this command from the host1 also but it shows the same error.
&gt; Another thing i would like to ask is the that whats the use of
&gt; migrateuri in migrate command ?
&gt;
&gt; --
&gt; Jatin Kumar
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110903161427</emailId><senderName>Jatin Kumar</senderName><senderEmail>cs5090243@cse.iitd.ernet.in</senderEmail><timestampReceived>2011-09-03 16:14:27-0400</timestampReceived><subject>Re: [libvirt-users] Char dev error</subject><body>

testvm1 is using port 5901 on host1 and the same is free on host2.
So port unavailability is definitely not the problem.

--
Jatin

On Sat, Sep 3, 2011 at 6:58 PM, Joseph Harnish &lt;bigjoe1008@gmail.com&gt; wrote:
&gt; I have seen this when the port or the ip of the hypervisor was defined
&gt; in the XML config so it couldn't bind to that address when it migrated
&gt; over.
&gt;
&gt; --Joe
&gt;
&gt; Sent from my iPhone
&gt;
&gt; On Sep 3, 2011, at 9:22 AM, Jatin Kumar &lt;cs5090243@cse.iitd.ernet.in&gt; wrote:
&gt;
&gt;&gt; Hello,
&gt;&gt; I have been trying to migrate a guest from one host to another.
&gt;&gt; But it is showing this error:
&gt;&gt;
&gt;&gt; virsh --connect qemu+ssh://root@host1/system migrate --live
&gt;&gt; --undefinesource testvm3 qemu+ssh://root@host2/system
&gt;&gt; tcp://host2:48160
&gt;&gt; error: operation failed: failed to retrieve chardev info in qemu with
&gt;&gt; 'info chardev'
&gt;&gt;
&gt;&gt; I have tried this command from the host1 also but it shows the same error.
&gt;&gt; Another thing i would like to ask is the that whats the use of
&gt;&gt; migrateuri in migrate command ?
&gt;&gt;
&gt;&gt; --
&gt;&gt; Jatin Kumar
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; libvirt-users mailing list
&gt;&gt; libvirt-users@redhat.com
&gt;&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;
&gt;

</body></email><email><emailId>20111101071516</emailId><senderName>Alexander Biryukov</senderName><senderEmail>reddoggad@gmail.com</senderEmail><timestampReceived>2011-11-01 07:15:16-0400</timestampReceived><subject>[libvirt-users] Error on the site</subject><body>

Good afternoon.
I apologize for my English.

Error on page: http://libvirt.org/formatdomain.html
To be more precise in the line "&lt;target *def*='hdc' bus='ide'/&gt;"

-- 
Biryukov Alexander

ICQ: 467093457
Skype: reddog_gad

[Attachment #3 (text/html)]

&lt;span id="result_box" class="" lang="en"&gt;&lt;span class="hps"&gt;Good afternoon.&lt;/span&gt;&lt;br&gt; \
&lt;span class="hps"&gt;I apologize for&lt;/span&gt; &lt;span class="hps"&gt;my&lt;/span&gt; &lt;span \
class="hps"&gt;English&lt;/span&gt;&lt;span class=""&gt;.&lt;/span&gt;&lt;br&gt;&lt;br&gt; &lt;span class="hps"&gt;Error on \
page&lt;/span&gt;&lt;span class=""&gt;: &lt;a \
href="http://libvirt.org/formatdomain.html"&gt;http://libvirt.org/formatdomain.html&lt;/a&gt;&lt;/span&gt;&lt;/span&gt; \
&lt;br&gt;

&lt;span id="result_box" class="" lang="en"&gt;&lt;span class="hps"&gt;To be more precise&lt;/span&gt; \
&lt;span class="hps"&gt;in the line&lt;/span&gt; &lt;span class="hps"&gt;"&lt;target \
&lt;b&gt;def&lt;/b&gt;='hdc' bus='ide'/&gt;"&lt;/span&gt;&lt;/span&gt;&lt;br clear="all"&gt;

&lt;br&gt;-- &lt;br&gt;Biryukov Alexander&lt;br&gt;&lt;br&gt;ICQ: 467093457&lt;br&gt;Skype: reddog_gad&lt;br&gt;&lt;br&gt;



</body></email><email><emailId>20111203012317</emailId><senderName>Todd And Margo Chester</senderName><senderEmail>toddandmargo@gmail.com</senderEmail><timestampReceived>2011-12-03 01:23:17-0400</timestampReceived><subject>Re: [libvirt-users] Can I configure cores instead of CPU's</subject><body>

Hi All,

Scientific Linux 6.1 x64
qemu-kvm-0.12.1.2-2.160.el6_1.2.x86_64

My XP-Pro guest will only let me use two CPUs.
Is there a way I can tell Virt-Manager to use
one CPU with six cores instead of four separate
CPUs?

I can manually insert things with
          virsh edit KVM-WinXP

  Currently, I have:
          &lt;vcpu&gt;6&lt;/vcpu&gt;

I found an example of a run string:

     -smp 2,sockets=2,cores=1,threads=1

But I will be darned if I can figure out the virsh xml syntax.

Many thanks,
-T

</body></email><email><emailId>20111203015335</emailId><senderName>Todd And Margo Chester</senderName><senderEmail>toddandmargo@gmail.com</senderEmail><timestampReceived>2011-12-03 01:53:35-0400</timestampReceived><subject>Re: [libvirt-users] Can I configure cores instead of CPU's</subject><body>

&gt; -------- Original message --------
&gt; Subject: Re: [libvirt-users] Can I configure cores instead of CPU's
&gt; From: Todd And Margo Chester &lt;toddandmargo@gmail.com&gt;
&gt; To: "libvirt-users@redhat.com" &lt;libvirt-users@redhat.com&gt;
&gt; CC:
&gt;
&gt;
&gt; Hi All,
&gt;
&gt; Scientific Linux 6.1 x64
&gt; qemu-kvm-0.12.1.2-2.160.el6_1.2.x86_64
&gt;
&gt; My XP-Pro guest will only let me use two CPUs.
&gt; Is there a way I can tell Virt-Manager to use
&gt; one CPU with six cores instead of four separate
&gt; CPUs?
&gt;
&gt; I can manually insert things with
&gt; virsh edit KVM-WinXP
&gt;
&gt; Currently, I have:
&gt; &lt;vcpu&gt;6&lt;/vcpu&gt;
&gt;
&gt; I found an example of a run string:
&gt;
&gt; -smp 2,sockets=2,cores=1,threads=1
&gt;
&gt; But I will be darned if I can figure out the virsh xml syntax.
&gt;
&gt; Many thanks,
&gt; -T

On 12/02/2011 05:32 PM, Frank Hauptle wrote:
 &gt; Yes under advanced in cpu in virt manager are socket /core
 &gt; settings. i use a fedora virt manager to connect to sl61
 &gt; libvirt. more options that way.


I configured my processor in virt-mamager:

     CPU's: Current Allocation: 2
     Manual set CPU Topology:
         Sockets: 1
         Cores: 6
         Threads: 1

or from my XML file

    &lt;vcpu&gt;1&lt;/vcpu&gt;
    &lt;cpu&gt;
        &lt;topology sockets='1' cores='6' threads='1'/&gt;
    &lt;/cpu&gt;

I still get two CPUs in my guest XP-Pro.

What am I doing wrong?

-T

</body></email><email><emailId>20111204054942</emailId><senderName>Todd And Margo Chester</senderName><senderEmail>toddandmargo@gmail.com</senderEmail><timestampReceived>2011-12-04 05:49:42-0400</timestampReceived><subject>Re: [libvirt-users] Can I configure cores instead of CPU's</subject><body>


&gt; On 3/12/2011 9:53 AM, Todd And Margo Chester wrote:
&gt;&gt;&gt; -------- Original message --------
&gt;&gt;&gt; Subject: Re: [libvirt-users] Can I configure cores instead of CPU's
&gt;&gt;&gt; From: Todd And Margo Chester&lt;toddandmargo@gmail.com&gt;
&gt;&gt;&gt; To: "libvirt-users@redhat.com"&lt;libvirt-users@redhat.com&gt;
&gt;&gt;&gt; CC:
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Hi All,
&gt;&gt;&gt;
&gt;&gt;&gt; Scientific Linux 6.1 x64
&gt;&gt;&gt; qemu-kvm-0.12.1.2-2.160.el6_1.2.x86_64
&gt;&gt;&gt;
&gt;&gt;&gt; My XP-Pro guest will only let me use two CPUs.
&gt;&gt;&gt; Is there a way I can tell Virt-Manager to use
&gt;&gt;&gt; one CPU with six cores instead of four separate
&gt;&gt;&gt; CPUs?
&gt;&gt;&gt;
&gt;&gt;&gt; I can manually insert things with
&gt;&gt;&gt; virsh edit KVM-WinXP
&gt;&gt;&gt;
&gt;&gt;&gt; Currently, I have:
&gt;&gt;&gt; &lt;vcpu&gt;6&lt;/vcpu&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; I found an example of a run string:
&gt;&gt;&gt;
&gt;&gt;&gt; -smp 2,sockets=2,cores=1,threads=1
&gt;&gt;&gt;
&gt;&gt;&gt; But I will be darned if I can figure out the virsh xml syntax.
&gt;&gt;&gt;
&gt;&gt;&gt; Many thanks,
&gt;&gt;&gt; -T
&gt;&gt; On 12/02/2011 05:32 PM, Frank Hauptle wrote:
&gt;&gt; &gt; Yes under advanced in cpu in virt manager are socket /core
&gt;&gt; &gt; settings. i use a fedora virt manager to connect to sl61
&gt;&gt; &gt; libvirt. more options that way.
&gt;&gt;
&gt;&gt;
&gt;&gt; I configured my processor in virt-mamager:
&gt;&gt;
&gt;&gt; CPU's: Current Allocation: 2
&gt;&gt; Manual set CPU Topology:
&gt;&gt; Sockets: 1
&gt;&gt; Cores: 6
&gt;&gt; Threads: 1
&gt;&gt;
&gt;&gt; or from my XML file
&gt;&gt;
&gt;&gt; &lt;vcpu&gt;1&lt;/vcpu&gt;
&gt;&gt; &lt;cpu&gt;
&gt;&gt; &lt;topology sockets='1' cores='6' threads='1'/&gt;
&gt;&gt; &lt;/cpu&gt;
&gt;&gt;
&gt;&gt; I still get two CPUs in my guest XP-Pro.
&gt;&gt;
&gt;&gt; What am I doing wrong?
&gt;&gt;
&gt;&gt; -T
On 12/03/2011 07:40 PM, Frank Hauptle wrote:
&gt; I'm not even sure XP could differentiate
&gt; between a core and a socket as multicore CPU's were not common to x86 in
&gt; 2000 when XP was released.
&gt;
&gt; If you want to see if it really worked, download a knoppix CD and mount
&gt; the ISO in the CDrom of that
&gt; VM, then set it to boot from the CDROM.
&gt;
&gt; When knoppix boots up, open a terminal and type:
&gt;
&gt; cat /proc/cpuinfo
&gt;
&gt; See what it gives you.
&gt;
&gt; I think the hardware info GUI app in knoppix will give you more info too.
&gt;
&gt; cheers
&gt;
&gt;
&gt; Frank

Hi Frank,

I have FC16 live CD as a guest.  /proc/cpuinfo said I had four cpu's.
Given a bit of time I can give you the full report if that would help.
My host CPU is an i7-960 (four real cores, eight hyperthreaded cores.)

-T

</body></email><email><emailId>20110602033321</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-06-02 03:33:21-0400</timestampReceived><subject>Re: [libvirt-users] libvirtError: internal error Domain mytest didn't show up</subject><body>

On 06/02/2011 07:17 AM, Chun Tat David Chu wrote:
&gt; Hi All,
&gt;
&gt; I am new using libvirt.
&gt;
&gt; I kept on getting the following error when I try to start my VM.  Can
&gt; anyone give me any suggestion on what could went wrong?
&gt;
&gt; Traceback (most recent call last):
&gt;    File "/usr/share/virt-manager/virtManager/engine.py", line 498, in
&gt; run_domain
&gt;      vm.startup()
&gt;    File "/usr/share/virt-manager/virtManager/domain.py", line 573, in
&gt; startup
&gt;      self.vm.create()
&gt;    File "/usr/lib64/python2.4/site-packages/libvirt.py", line 287, in create
&gt;      if ret == -1: raise libvirtError ('virDomainCreate() failed', dom=self)
&gt; libvirtError: internal error Domain mytest didn't show up
&gt;
&gt; Thanks,
&gt;
&gt; David
&gt;

virt-manager has debug log, ~/.virt-manager/virt-manager.log.

And you can check libvirtd log too, by default, it's /var/log/messages,
change "log_outputs" in /etc/libvirt/libvirtd.conf if you want it logs
somewhere else.

Change the "log_level" in /etc/libvirt/libvirtd.conf if you want to
see more log.

Perhaps detailed log will help you find out the problem.

Regards
Osier

</body></email><email><emailId>20110602154941</emailId><senderName>Chun Tat David Chu</senderName><senderEmail>beyonddc.storage@gmail.com</senderEmail><timestampReceived>2011-06-02 15:49:41-0400</timestampReceived><subject>Re: [libvirt-users] libvirtError: internal error Domain mytest didn't show up</subject><body>

Hi Osier,

The debug log from virt-manager wasn't that helpful.

[Thu, 02 Jun 2011 11:32:26 virt-manager 5104] DEBUG (engine:496) Starting vm
'rpmbuilderbase'.
[Thu, 02 Jun 2011 11:32:37 virt-manager 5104] DEBUG (error:76) Uncaught
Error: Error starting domain: internal error Domain rpmbuilderbase didn't
show up
 : Traceback (most recent call last):
  File "/usr/share/virt-manager/virtManager/engine.py", line 498, in
run_domain
    vm.startup()
  File "/usr/share/virt-manager/virtManager/domain.py", line 573, in startup
    self.vm.create()
  File "/usr/lib64/python2.4/site-packages/libvirt.py", line 287, in create
    if ret == -1: raise libvirtError ('virDomainCreate() failed', dom=self)
libvirtError: internal error Domain rpmbuilderbase didn't show up

The log in /var/log/libvirt/qemu is a little bit more useful but I don't
really understand it.  Can someone please explains it to me?

LC_ALL=C PATH=/sbin:/usr/sbin:/bin:/usr/bin HOME=/ /usr/libexec/qemu-kvm -S
-M pc -m 2048 -smp 1 -name rpmbuilderbase -uuid
bb226766-a712-8e31-74ed-1f971d6a8230 -monitor pty -pidfile
/var/run/libvirt/qemu//rpmbuilderbase.pid -boot cc -drive
file=/var/lib/libvirt/devmappings/rpmbuilderbase,if=ide,index=0,boot=on -net
nic,macaddr=54:52:00:68:ea:d0,vlan=0,model=e1000 -net
tap,fd=15,script=,vlan=0,ifname=vnet0 -serial pty -parallel none -usb -vnc
127.0.0.1:0 -k en-us
Boot device 'c' was given twice

Is the message "Boot device 'c' was given twice' a fatal error?  If so what
is the correct action to resolve the issue?

Thanks!

David

On Wed, Jun 1, 2011 at 11:33 PM, Osier Yang &lt;jyang@redhat.com&gt; wrote:

&gt; On 06/02/2011 07:17 AM, Chun Tat David Chu wrote:
&gt;
&gt;&gt; Hi All,
&gt;&gt;
&gt;&gt; I am new using libvirt.
&gt;&gt;
&gt;&gt; I kept on getting the following error when I try to start my VM.  Can
&gt;&gt; anyone give me any suggestion on what could went wrong?
&gt;&gt;
&gt;&gt; Traceback (most recent call last):
&gt;&gt;   File "/usr/share/virt-manager/virtManager/engine.py", line 498, in
&gt;&gt; run_domain
&gt;&gt;     vm.startup()
&gt;&gt;   File "/usr/share/virt-manager/virtManager/domain.py", line 573, in
&gt;&gt; startup
&gt;&gt;     self.vm.create()
&gt;&gt;   File "/usr/lib64/python2.4/site-packages/libvirt.py", line 287, in
&gt;&gt; create
&gt;&gt;     if ret == -1: raise libvirtError ('virDomainCreate() failed',
&gt;&gt; dom=self)
&gt;&gt; libvirtError: internal error Domain mytest didn't show up
&gt;&gt;
&gt;&gt; Thanks,
&gt;&gt;
&gt;&gt; David
&gt;&gt;
&gt;&gt;
&gt; virt-manager has debug log, ~/.virt-manager/virt-manager.log.
&gt;
&gt; And you can check libvirtd log too, by default, it's /var/log/messages,
&gt; change "log_outputs" in /etc/libvirt/libvirtd.conf if you want it logs
&gt; somewhere else.
&gt;
&gt; Change the "log_level" in /etc/libvirt/libvirtd.conf if you want to
&gt; see more log.
&gt;
&gt; Perhaps detailed log will help you find out the problem.
&gt;
&gt; Regards
&gt; Osier
&gt;
&gt;

[Attachment #3 (text/html)]

Hi Osier,&lt;br&gt;&lt;br&gt;The debug log from virt-manager wasn't that \
helpful.&lt;br&gt;&lt;br&gt;[Thu, 02 Jun 2011 11:32:26 virt-manager 5104] DEBUG (engine:496) \
Starting vm 'rpmbuilderbase'.&lt;br&gt;[Thu, 02 Jun 2011 11:32:37 virt-manager \
5104] DEBUG (error:76) Uncaught Error: Error starting domain: internal error Domain \
rpmbuilderbase didn't show up&lt;br&gt;  : Traceback (most recent call last):&lt;br&gt;  File \
"/usr/share/virt-manager/virtManager/engine.py", line 498, in \
run_domain&lt;br&gt;    vm.startup()&lt;br&gt;  File \
"/usr/share/virt-manager/virtManager/domain.py", line 573, in startup&lt;br&gt;  \
self.vm.create()&lt;br&gt;  File "/usr/lib64/python2.4/site-packages/libvirt.py", \
line 287, in create&lt;br&gt;    if ret == -1: raise libvirtError ('virDomainCreate() \
failed', dom=self)&lt;br&gt;libvirtError: internal error Domain rpmbuilderbase \
didn't show up&lt;br&gt; &lt;br&gt;The log in /var/log/libvirt/qemu is a little bit more \
useful but I don't really understand it.  Can someone please explains it to \
me?&lt;br&gt;&lt;br&gt;LC_ALL=C PATH=/sbin:/usr/sbin:/bin:/usr/bin HOME=/ /usr/libexec/qemu-kvm \
-S -M pc -m 2048 -smp 1 -name rpmbuilderbase -uuid \
bb226766-a712-8e31-74ed-1f971d6a8230 -monitor pty -pidfile \
/var/run/libvirt/qemu//rpmbuilderbase.pid -boot cc -drive \
file=/var/lib/libvirt/devmappings/rpmbuilderbase,if=ide,index=0,boot=on -net \
nic,macaddr=54:52:00:68:ea:d0,vlan=0,model=e1000 -net \
tap,fd=15,script=,vlan=0,ifname=vnet0 -serial pty -parallel none -usb -vnc &lt;a \
href="http://127.0.0.1:0"&gt;127.0.0.1:0&lt;/a&gt; -k en-us&lt;br&gt; Boot device 'c' was \
given twice&lt;br&gt;&lt;br&gt;Is the message "Boot device 'c' was given twice' \
a fatal error?  If so what is the correct action to resolve the \
issue?&lt;br&gt;&lt;br&gt;Thanks!&lt;br&gt;&lt;br&gt;David&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt; On Wed, Jun 1, \
2011 at 11:33 PM, Osier Yang &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:jyang@redhat.com"&gt;jyang@redhat.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt; &lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;On 06/02/2011 07:17 AM, \
Chun Tat David Chu wrote:&lt;br&gt; &lt;blockquote class="gmail_quote" style="margin:0 0 0 \
.8ex;border-left:1px #ccc solid;padding-left:1ex"&gt; Hi All,&lt;br&gt;
&lt;br&gt;
I am new using libvirt.&lt;br&gt;
&lt;br&gt;
I kept on getting the following error when I try to start my VM.  Can&lt;br&gt;
anyone give me any suggestion on what could went wrong?&lt;br&gt;
&lt;br&gt;
Traceback (most recent call last):&lt;br&gt;
   File "/usr/share/virt-manager/virtManager/engine.py", line 498, in&lt;br&gt;
run_domain&lt;br&gt;
     vm.startup()&lt;br&gt;
   File "/usr/share/virt-manager/virtManager/domain.py", line 573, in&lt;br&gt;
startup&lt;br&gt;
     self.vm.create()&lt;br&gt;
   File "/usr/lib64/python2.4/site-packages/libvirt.py", line 287, in \
                create&lt;br&gt;
     if ret == -1: raise libvirtError ('virDomainCreate() failed', \
                dom=self)&lt;br&gt;
libvirtError: internal error Domain mytest didn't show up&lt;br&gt;
&lt;br&gt;
Thanks,&lt;br&gt;
&lt;br&gt;
David&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;
&lt;br&gt;&lt;/div&gt;&lt;/div&gt;
virt-manager has debug log, ~/.virt-manager/virt-manager.log.&lt;br&gt;
&lt;br&gt;
And you can check libvirtd log too, by default, it's /var/log/messages,&lt;br&gt;
change "log_outputs" in /etc/libvirt/libvirtd.conf if you want it logs&lt;br&gt;
somewhere else.&lt;br&gt;
&lt;br&gt;
Change the "log_level" in /etc/libvirt/libvirtd.conf if you want to&lt;br&gt;
see more log.&lt;br&gt;
&lt;br&gt;
Perhaps detailed log will help you find out the problem.&lt;br&gt;
&lt;br&gt;
Regards&lt;br&gt;&lt;font color="#888888"&gt;
Osier&lt;br&gt;
&lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20111020063416</emailId><senderName>Mihamina Rakotomandimby</senderName><senderEmail>mihamina@rktmb.org</senderEmail><timestampReceived>2011-10-20 06:34:16-0400</timestampReceived><subject>Re: [libvirt-users] Identifying proper CPU type</subject><body>

On 10/20/2011 09:27 AM, Alex wrote:
&gt; I've been working on trying to figure out why my virtual machine keeps
&gt; crashing [...]  As I'm relatively new to this, I believe I may have
&gt; misconfigured the XML file to try and maximize the CPU features that
&gt; are available to the guest from the host.

Is it crashing with default configuration or the tuned one?

&gt; The guest processor still seems to indicate there is only one core,

The CPU number seen by the guest is set in the guest configuration file.
For example, I create my guests with "virt-install" and the generated 
XML file has a "vcpu" parameter that I may tune.

&gt; despite there being 7 processors?

You have 8 CPU (#0 -&gt; #7)

-- 
RMA.

</body></email><email><emailId>20111010214258</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-10-10 21:42:58-0400</timestampReceived><subject>Re: [libvirt-users] no connection driver available for openvz:///system</subject><body>

On 10/10/2011 06:57 AM, ÕÅÁ¢ºé wrote:
&gt;   dears.
&gt; I can not solved the problem:
&gt;   vzctl works. But how do I connect to Virtuozzo? Using the openvz
&gt;&gt;&gt;&gt; driver
&gt;&gt;&gt;&gt; it doesn't work out of the box:
&gt;&gt;&gt;&gt; virsh # connect openvz:///system
&gt;&gt;&gt;&gt; error: Failed to connect to the hypervisor
&gt;&gt;&gt;&gt; error: no connection driver available for openvz:///system
&gt;
&gt;
&gt; Why can not I connect to the openvz???

This may be a simple case of your libvirt binary not being pre-compiled 
with openvz support.  What distro are you using?  What does:

virsh --version=long

display?  It may be that you have to recompile libvirt from a tarball 
and explicitly request that the openvz code be compiled, if the 
pre-built binary from your distro omits that driver.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20111011085019</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-10-11 08:50:19-0400</timestampReceived><subject>Re: [libvirt-users] no connection driver available for openvz:///system</subject><body>

2011/10/10 Eric Blake &lt;eblake@redhat.com&gt;:
&gt; On 10/10/2011 06:57 AM, 张立洪 wrote:
&gt;&gt;
&gt;&gt;  dears.
&gt;&gt; I can not solved the problem:
&gt;&gt;  vzctl works. But how do I connect to Virtuozzo? Using the openvz
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; driver
&gt;&gt;&gt;&gt;&gt; it doesn't work out of the box:
&gt;&gt;&gt;&gt;&gt; virsh # connect openvz:///system
&gt;&gt;&gt;&gt;&gt; error: Failed to connect to the hypervisor
&gt;&gt;&gt;&gt;&gt; error: no connection driver available for openvz:///system
&gt;&gt;
&gt;&gt;
&gt;&gt; Why can not I connect to the openvz???
&gt;
&gt; This may be a simple case of your libvirt binary not being pre-compiled with
&gt; openvz support.  What distro are you using?  What does:
&gt;
&gt; virsh --version=long
&gt;
&gt; display?  It may be that you have to recompile libvirt from a tarball and
&gt; explicitly request that the openvz code be compiled, if the pre-built binary
&gt; from your distro omits that driver.

Maybe the problem is that OpenVZ and Virtuozzo are not identical. See
this thread on the user list about the difference between ctid and
vpsid:

https://www.redhat.com/archives/libvirt-users/2011-May/msg00070.html
https://www.redhat.com/archives/libvirt-users/2011-July/msg00031.html

I looked this up in the OpenVZ source history at that time and vpsid
was changed to ctid at some time. So the OpenVZ driver needs to deal
with this difference as it seems that Virtuozzo is based on newer
OpenVZ that uses ctid.

-- 
Matthias Bolte
http://photron.blogspot.com

</body></email><email><emailId>20111011121309</emailId><senderName></senderName><senderEmail>zlh_086@126.com</senderEmail><timestampReceived>2011-10-11 12:13:09-0400</timestampReceived><subject>Re: [libvirt-users] no connection driver available for openvz:///system</subject><body>

[Attachment #2 (text/plain)]

First ,thanks for you help
but I am very sorry,I do not konw how to recompile libvirt to support openvz.


My os is centos6,its own libvirt version is 0.8.1

please tell me how to recomplie libvirt.because I do not find libvirt makefile.





ÔÚ 2011-10-11 16:50:19£¬"Matthias Bolte" &lt;matthias.bolte@googlemail.com&gt; Ð´µÀ£º
&gt;2011/10/10 Eric Blake &lt;eblake@redhat.com&gt;:
&gt;&gt; On 10/10/2011 06:57 AM, ÕÅÁ¢ºé wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;  dears.
&gt;&gt;&gt; I can not solved the problem:
&gt;&gt;&gt;  vzctl works. But how do I connect to Virtuozzo? Using the openvz
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; driver
&gt;&gt;&gt;&gt;&gt;&gt; it doesn't work out of the box:
&gt;&gt;&gt;&gt;&gt;&gt; virsh # connect openvz:///system
&gt;&gt;&gt;&gt;&gt;&gt; error: Failed to connect to the hypervisor
&gt;&gt;&gt;&gt;&gt;&gt; error: no connection driver available for openvz:///system
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Why can not I connect to the openvz???
&gt;&gt;
&gt;&gt; This may be a simple case of your libvirt binary not being pre-compiled with
&gt;&gt; openvz support.  What distro are you using?  What does:
&gt;&gt;
&gt;&gt; virsh --version=long
&gt;&gt;
&gt;&gt; display?  It may be that you have to recompile libvirt from a tarball and
&gt;&gt; explicitly request that the openvz code be compiled, if the pre-built binary
&gt;&gt; from your distro omits that driver.
&gt;
&gt;Maybe the problem is that OpenVZ and Virtuozzo are not identical. See
&gt;this thread on the user list about the difference between ctid and
&gt;vpsid:
&gt;
&gt;https://www.redhat.com/archives/libvirt-users/2011-May/msg00070.html
&gt;https://www.redhat.com/archives/libvirt-users/2011-July/msg00031.html
&gt;
&gt;I looked this up in the OpenVZ source history at that time and vpsid
&gt;was changed to ctid at some time. So the OpenVZ driver needs to deal
&gt;with this difference as it seems that Virtuozzo is based on newer
&gt;OpenVZ that uses ctid.
&gt;
&gt;-- 
&gt;Matthias Bolte
&gt;http://photron.blogspot.com

[Attachment #3 (text/html)]

&lt;div style="line-height:1.7;color:#000000;font-size:14px;font-family:arial"&gt;First \
,thanks for you help&lt;br&gt;but I am very sorry,I do not konw how to \
recompile libvirt to support openvz.&lt;br&gt;&lt;br&gt;&lt;br&gt;My os is centos6,its own libvirt \
version is 0.8.1&lt;br&gt;&lt;br&gt;please tell me how to recomplie libvirt.because I do not find \
libvirt makefile.&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt;&lt;div \
id="divNeteaseMailCard"&gt;&lt;/div&gt;&lt;br&gt;&lt;pre&gt;&lt;br&gt;ÔÚ 2011-10-11 16:50:19£¬"Matthias Bolte" &lt;matthias.bolte@googlemail.com&gt; Ð´µÀ£º
 &gt;2011/10/10 Eric Blake &lt;eblake@redhat.com&gt;:
&gt;&gt; On 10/10/2011 06:57 AM, ÕÅÁ¢ºé wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;  dears.
&gt;&gt;&gt; I can not solved the problem:
&gt;&gt;&gt;  vzctl works. But how do I connect to Virtuozzo? Using the openvz
 &gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; driver
&gt;&gt;&gt;&gt;&gt;&gt; it doesn't work out of the box:
 &gt;&gt;&gt;&gt;&gt;&gt; virsh # connect openvz:///system
&gt;&gt;&gt;&gt;&gt;&gt; error: Failed to connect to the hypervisor
 &gt;&gt;&gt;&gt;&gt;&gt; error: no connection driver available for openvz:///system
 &gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Why can not I connect to the openvz???
 &gt;&gt;
&gt;&gt; This may be a simple case of your libvirt binary not being pre-compiled with
 &gt;&gt; openvz support.  What distro are you using?  What does:
 &gt;&gt;
&gt;&gt; virsh --version=long
&gt;&gt;
&gt;&gt; display?  It may be that you have to recompile libvirt from a tarball and
 &gt;&gt; explicitly request that the openvz code be compiled, if the pre-built binary
 &gt;&gt; from your distro omits that driver.
&gt;
&gt;Maybe the problem is that OpenVZ and Virtuozzo are not identical. See
 &gt;this thread on the user list about the difference between ctid and
 &gt;vpsid:
&gt;
&gt;https://www.redhat.com/archives/libvirt-users/2011-May/msg00070.html
&gt;https://www.redhat.com/archives/libvirt-users/2011-July/msg00031.html
&gt;
&gt;I looked this up in the OpenVZ source history at that time and vpsid
 &gt;was changed to ctid at some time. So the OpenVZ driver needs to deal
 &gt;with this difference as it seems that Virtuozzo is based on newer
 &gt;OpenVZ that uses ctid.
&gt;
&gt;-- 
&gt;Matthias Bolte
&gt;http://photron.blogspot.com
&lt;/pre&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;&lt;span title="neteasefooter"&gt;&lt;span \
id="netease_mail_footer"&gt;&lt;/span&gt;&lt;/span&gt;



</body></email><email><emailId>20111012030729</emailId><senderName>Trey Dockendorf</senderName><senderEmail>treydock@gmail.com</senderEmail><timestampReceived>2011-10-12 03:07:29-0400</timestampReceived><subject>Re: [libvirt-users] no connection driver available for openvz:///system</subject><body>

2011/10/11 ÕÅÁ¢ºé &lt;zlh_086@126.com&gt;

&gt; First ,thanks for you help
&gt; but I am very sorry,I do not konw how to recompile libvirt to support
&gt; openvz.
&gt;
&gt;
&gt; My os is centos6,its own libvirt version is 0.8.1
&gt;
&gt; please tell me how to recomplie libvirt.because I do not find libvirt
&gt; makefile.
&gt;
&gt;
&gt;
&gt; ÔÚ 2011-10-11 16:50:19£¬"Matthias Bolte" &lt;matthias.bolte@googlemail.com&gt; Ð´µÀ£º
&gt; &gt;2011/10/10 Eric Blake &lt;eblake@redhat.com&gt;:
&gt; &gt;&gt; On 10/10/2011 06:57 AM, ÕÅÁ¢ºé wrote:
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;  dears.
&gt; &gt;&gt;&gt; I can not solved the problem:
&gt; &gt;&gt;&gt;  vzctl works. But how do I connect to Virtuozzo? Using the openvz
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; driver
&gt; &gt;&gt;&gt;&gt;&gt;&gt; it doesn't work out of the box:
&gt; &gt;&gt;&gt;&gt;&gt;&gt; virsh # connect openvz:///system
&gt; &gt;&gt;&gt;&gt;&gt;&gt; error: Failed to connect to the hypervisor
&gt; &gt;&gt;&gt;&gt;&gt;&gt; error: no connection driver available for openvz:///system
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; Why can not I connect to the openvz???
&gt; &gt;&gt;
&gt; &gt;&gt; This may be a simple case of your libvirt binary not being pre-compiled with
&gt; &gt;&gt; openvz support.  What distro are you using?  What does:
&gt; &gt;&gt;
&gt; &gt;&gt; virsh --version=long
&gt; &gt;&gt;
&gt; &gt;&gt; display?  It may be that you have to recompile libvirt from a tarball and
&gt; &gt;&gt; explicitly request that the openvz code be compiled, if the pre-built binary
&gt; &gt;&gt; from your distro omits that driver.
&gt; &gt;
&gt; &gt;Maybe the problem is that OpenVZ and Virtuozzo are not identical. See
&gt; &gt;this thread on the user list about the difference between ctid and
&gt; &gt;vpsid:
&gt; &gt;
&gt; &gt;https://www.redhat.com/archives/libvirt-users/2011-May/msg00070.html
&gt;
&gt; &gt;https://www.redhat.com/archives/libvirt-users/2011-July/msg00031.html
&gt; &gt;
&gt; &gt;I looked this up in the OpenVZ source history at that time and vpsid
&gt; &gt;was changed to ctid at some time. So the OpenVZ driver needs to deal
&gt; &gt;with this difference as it seems that Virtuozzo is based on newer
&gt; &gt;OpenVZ that uses ctid.
&gt; &gt;
&gt; &gt;--
&gt; &gt;Matthias Bolte
&gt; &gt;http://photron.blogspot.com
&gt;
&gt;
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

Accidently sent this directly to OP,

You'll want to download the libvirt SRPM for CentOS 6.  Based on the comment
from the spec file , RHEL and CentOS is purposely not compiled with openvz,

# RHEL doesn't ship OpenVZ, VBox, UML, OpenNebula, PowerHypervisor,
# VMWare, or libxenserver (xenapi)
%if 0%{?rhel}
%define with_openvz 0

To enable openvz you change that define to 1 and then rebuild using the
spec.

You can extract the SRPM contents with...

rpm2cpio libvirt-xxxx.src.rpm | cpio -dimv

Then follow this documentation, http://wiki.centos.org/HowTos/RebuildSRPM ,
to rebuild a new RPM.

Hope that helps,

 - Trey

[Attachment #3 (text/html)]

&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;2011/10/11 ÕÅÁ¢ºé &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:zlh_086@126.com"&gt;zlh_086@126.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt; &lt;div \
style="line-height:1.7;color:#000000;font-size:14px;font-family:arial"&gt;First ,thanks \
for you help&lt;br&gt;but I am very sorry,I do not konw how to recompile libvirt to \
support openvz.&lt;br&gt;&lt;br&gt;&lt;br&gt;My os is centos6,its own libvirt version is 0.8.1&lt;br&gt; \
&lt;br&gt;please tell me how to recomplie libvirt.because I do not find libvirt \
makefile.&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;br&gt;&lt;pre&gt;&lt;br&gt;ÔÚ 2011-10-11 16:50:19£¬"Matthias Bolte" &lt;&lt;a \
href="mailto:matthias.bolte@googlemail.com" \
target="_blank"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt; Ð´µÀ£º \
&gt;2011/10/10 Eric Blake &lt;&lt;a href="mailto:eblake@redhat.com" \
target="_blank"&gt;eblake@redhat.com&lt;/a&gt;&gt;: \
&gt;&gt; On 10/10/2011 06:57 AM, ÕÅÁ¢ºé wrote: \
&gt;&gt;&gt; &gt;&gt;&gt;  dears.
&gt;&gt;&gt; I can not solved the problem:
&gt;&gt;&gt;  vzctl works. But how do I connect to Virtuozzo? Using the openvz
 &gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; driver
&gt;&gt;&gt;&gt;&gt;&gt; it doesn't work out of the box:
 &gt;&gt;&gt;&gt;&gt;&gt; virsh # connect openvz:///system
&gt;&gt;&gt;&gt;&gt;&gt; error: Failed to connect to the hypervisor
 &gt;&gt;&gt;&gt;&gt;&gt; error: no connection driver available for openvz:///system
 &gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Why can not I connect to the openvz???
 &gt;&gt;
&gt;&gt; This may be a simple case of your libvirt binary not being pre-compiled with
 &gt;&gt; openvz support.  What distro are you using?  What does:
 &gt;&gt;
&gt;&gt; virsh --version=long
&gt;&gt;
&gt;&gt; display?  It may be that you have to recompile libvirt from a tarball and
 &gt;&gt; explicitly request that the openvz code be compiled, if the pre-built binary
 &gt;&gt; from your distro omits that driver.
&gt;
&gt;Maybe the problem is that OpenVZ and Virtuozzo are not identical. See
 &gt;this thread on the user list about the difference between ctid and
 &gt;vpsid:
&gt;
&gt;&lt;a href="https://www.redhat.com/archives/libvirt-users/2011-May/msg00070.html" \
target="_blank"&gt;https://www.redhat.com/archives/libvirt-users/2011-May/msg00070.html&lt;/a&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div \
class="h5"&gt; &gt;&lt;a href="https://www.redhat.com/archives/libvirt-users/2011-July/msg00031.html" \
target="_blank"&gt;https://www.redhat.com/archives/libvirt-users/2011-July/msg00031.html&lt;/a&gt;
 &gt;
&gt;I looked this up in the OpenVZ source history at that time and vpsid
 &gt;was changed to ctid at some time. So the OpenVZ driver needs to deal
 &gt;with this difference as it seems that Virtuozzo is based on newer
 &gt;OpenVZ that uses ctid.
&gt;
&gt;-- 
&gt;Matthias Bolte
&gt;&lt;a href="http://photron.blogspot.com" \
target="_blank"&gt;http://photron.blogspot.com&lt;/a&gt; &lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;&lt;span \
title="neteasefooter"&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;_______________________________________________&lt;br&gt;
 libvirt-users mailing list&lt;br&gt;
&lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
&lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;Accidently \
sent this directly to OP,&lt;/div&gt;&lt;div&gt;&lt;br&gt; &lt;/div&gt;&lt;div&gt;&lt;span class="Apple-style-span" \
style="font-family: arial, sans-serif; font-size: 13px; background-color: rgb(255, \
255, 255); "&gt;&lt;div&gt;You'll want to download the libvirt SRPM for CentOS 6. \
 Based on the comment from the spec file , RHEL and CentOS is purposely not \
compiled with openvz,&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;# RHEL doesn't ship OpenVZ, \
VBox, UML, OpenNebula, PowerHypervisor,&lt;/div&gt;&lt;div&gt;# VMWare, or libxenserver \
(xenapi)&lt;/div&gt;&lt;div&gt;%if 0%{?rhel}&lt;/div&gt;&lt;div&gt;%define with_openvz \
0&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt; &lt;div&gt;To enable openvz you change that define to 1 and \
then rebuild using the spec.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;You can extract the SRPM \
contents with...&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;rpm2cpio libvirt-xxxx.src.rpm | cpio \
-dimv&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Then follow this documentation, &lt;a \
href="http://wiki.centos.org/HowTos/RebuildSRPM" target="_blank" style="color: \
rgb(87, 151, 176); "&gt;http://wiki.centos.org/HowTos/RebuildSRPM&lt;/a&gt; , to rebuild \
a new RPM.&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Hope that \
helps,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; - Trey&lt;/div&gt;&lt;/span&gt;&lt;/div&gt;



</body></email><email><emailId>20111013193404</emailId><senderName>Trey Dockendorf</senderName><senderEmail>treydock@gmail.com</senderEmail><timestampReceived>2011-10-13 19:34:04-0400</timestampReceived><subject>Re: [libvirt-users] no connection driver available for openvz:///system</subject><body>

2011/10/12 =E5=BC=A0=E7=AB=8B=E6=B4=AA &lt;zlh_086@126.com&gt;

&gt; thanks for help.
&gt;
&gt; I download a new libvirt 0.8.1,and compile libvirt.spec. and I success.I
&gt; can use virsh command connect openvz.
&gt;
&gt; but I want use libvirt manager KVM and openvz simultaneously.can you tell
&gt; me how can I implement.....?
&gt; openvz and kvm 's  VMs can network interconnect?
&gt;    the end I want to ask whether libvirt0.9.6 support openvz,vbox,lxc etc=
?
&gt;
&gt; thanks very much again!!!! look forward to your replies.
&gt;
&gt;
&gt;
&gt;
&gt;
Replying back to the list as this may be useful for others.

Personally, I don't know openvz or its capabilities, but you can use
something like virt-manager to manage anything controlled by Libvirt.  If
the openvz server connects via libvirt then virt-manager should be able to
manage that also.  In virt-manager you'd just do "File" -&gt; "Add Conection"
to connect a new server to the same interface.

I'd recommend also upgrading the CentOS 6 CR.  The version of libvirt fixes
many issues I've run into, primarily the snapshot capabilities.  Also the
virt-manager version in CentOS 6 is very dated.  I have one you can downloa=
d
that is the latest I've found to work with libvirt-0.8.1 and libvirt-0.8.7
(CentOS 6.1 / CR).
http://itscblog.tamu.edu/virt-manager-0-8-7-for-centos-6/ .  I'll be
updating the virt-manager RPM shortly, to just incorporate changes from
upstream RedHat.

- Trey

[Attachment #3 (text/html)]

&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;2011/10/12 å¼ ç«‹æ´ª &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:zlh_086@126.com"&gt;zlh_086@126.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt; &lt;div \
style="line-height:1.7;color:#000000;font-size:14px;font-family:arial"&gt;thanks for \
help.&lt;br&gt;&lt;br&gt;I download a new libvirt 0.8.1,and compile libvirt.spec. and I success.I \
can use virsh command connect openvz.&lt;br&gt;&lt;br&gt;but I want use libvirt manager KVM and \
openvz simultaneously.can you tell me how can I implement.....? &lt;br&gt; openvz and kvm \
's   VMs can network interconnect?&lt;br&gt;     the end I want to ask whether \
libvirt0.9.6 support openvz,vbox,lxc etc?&lt;br&gt;&lt;br&gt;thanks very much again!!!! look \
forward to your replies.&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt; &lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;&lt;span \
title="neteasefooter"&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;Replying back \
to the list as this may be useful for others.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Personally, I \
don't know openvz or its capabilities, but you can use something like \
virt-manager to manage anything controlled by Libvirt.   If the openvz server \
connects via libvirt then virt-manager should be able to manage that also.   In \
virt-manager you'd just do "File" -&gt; "Add Conection" to \
connect a new server to the same interface.&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I'd \
recommend also upgrading the CentOS 6 CR.   The version of libvirt fixes many issues \
I've run into, primarily the snapshot capabilities.   Also the virt-manager \
version in CentOS 6 is very dated.   I have one you can download that is the latest \
I've found to work with libvirt-0.8.1 and libvirt-0.8.7 (CentOS 6.1 / CR).   &lt;a \
href="http://itscblog.tamu.edu/virt-manager-0-8-7-for-centos-6/"&gt;http://itscblog.tamu.edu/virt-manager-0-8-7-for-centos-6/&lt;/a&gt; \
.   I'll be updating the virt-manager RPM shortly, to just incorporate changes \
from upstream RedHat.&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;- Trey&lt;/div&gt;



</body></email><email><emailId>20111014005736</emailId><senderName></senderName><senderEmail>zlh_086@126.com</senderEmail><timestampReceived>2011-10-14 00:57:36-0400</timestampReceived><subject>Re: [libvirt-users] no connection driver available for openvz:///system</subject><body>

I am very proud to share this problem with you !

thanks for your instructions.


virt-manager currently support xen,qemu-kvm,and the latest version support \
lxc.libvirt can connect openvz,and via virsh command tools can mananger openvz, but \
official does not claimed that virt-manager support openvz...perhaps virt-manager can \
support openvz in theory,but I do not kown how to modify or add to support openvz.


[Attachment #3 (text/html)]

&lt;div style="line-height:1.7;color:#000000;font-size:14px;font-family:arial"&gt;I am very \
proud to share this problem with you !&lt;br&gt;&lt;br&gt;thanks for your \
instructions.&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt;&lt;div id="divNeteaseMailCard"&gt;&lt;/div&gt;virt-manager \
currently support xen,qemu-kvm,and the latest version support lxc.libvirt can connect \
openvz,and via virsh command tools can mananger openvz, but official does not claimed \
that virt-manager support openvz...perhaps virt-manager can support openvz in \
theory,but I do not kown how to modify or add to support \
openvz.&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;&lt;span title="neteasefooter"&gt;&lt;span \
id="netease_mail_footer"&gt;&lt;/span&gt;&lt;/span&gt;



</body></email><email><emailId>20111014141933</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-10-14 14:19:33-0400</timestampReceived><subject>Re: [libvirt-users] no connection driver available for openvz:///system</subject><body>

On 10/13/2011 06:57 PM, ÕÅÁ¢ºé wrote:
&gt; I am very proud to share this problem with you !
&gt; 
&gt; thanks for your instructions.
&gt; 
&gt; 
&gt; virt-manager currently support xen,qemu-kvm,and the latest version support \
&gt; lxc.libvirt can connect openvz,and via virsh command tools can mananger openvz, but \
&gt; official does not claimed that virt-manager support openvz...perhaps virt-manager \
&gt; can support openvz in theory,but I do not kown how to modify or add to support \
&gt; openvz.

Support for openvz requires recompilation of the libvirt package from 
source, with the correct headers installed.  For example, Fedora's 
pre-built libvirt includes this support, while RHEL does not.  Depending 
on your distro, you may have to rebuild your own libvirt to enable the 
extra bits that your distro does not support by default.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


</body></email><email><emailId>20111018015606</emailId><senderName></senderName><senderEmail>zlh_086@126.com</senderEmail><timestampReceived>2011-10-18 01:56:06-0400</timestampReceived><subject>Re: [libvirt-users] no connection driver available for openvz:///system</subject><body>

thanks for your patient helps!

If I have any questions I would need your help in the future!





[Attachment #3 (text/html)]

&lt;div style="line-height:1.7;color:#000000;font-size:14px;font-family:arial"&gt;thanks \
for your patient helps!&lt;br&gt;&lt;br&gt;If I have any questions I would need your help in the \
future!&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt;&lt;div \
id="divNeteaseMailCard"&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;&lt;span title="neteasefooter"&gt;&lt;span \
id="netease_mail_footer"&gt;&lt;/span&gt;&lt;/span&gt;



</body></email><email><emailId>20111016222337</emailId><senderName>d hee</senderName><senderEmail>coolio@ymail.com</senderEmail><timestampReceived>2011-10-16 22:23:37-0400</timestampReceived><subject>Re: [libvirt-users] Virtio Balloon- Can not see the results</subject><body>

What would be the correct email address to send my questions on Virtio Balloon to?




________________________________
From: d hee &lt;coolio@ymail.com&gt;
To: "libvirt-users@redhat.com" &lt;libvirt-users@redhat.com&gt;
Sent: Thursday, October 13, 2011 1:00 AM
Subject: Virtio Balloon- Can not see the results


with kvm and virtio- would -m 1024 take proceedence over -balloon 
virtio? when i use both together, i see memory stay around 1024 MB less on my host \
side. I know the guest is not taking but a fraction of that ram, so I would expect \
the virtio balloon to take the majority of the guests ram and hand it back to the \
host. this is using the free util/command to take snapshots of the host memory. 

thanks,
-dman


[Attachment #3 (text/html)]

&lt;html&gt;&lt;body&gt;&lt;div style="color:#000; background-color:#fff; font-family:arial, \
helvetica, sans-serif;font-size:10pt"&gt;&lt;div&gt;&lt;span&gt;What would be the correct email \
address to send my questions on Virtio Balloon \
to?&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
style="font-family: arial, helvetica, sans-serif; font-size: 10pt;"&gt;&lt;div \
style="font-family: times new roman, new york, times, serif; font-size: 12pt;"&gt;&lt;font \
face="Arial" size="2"&gt;&lt;hr size="1"&gt;&lt;b&gt;&lt;span \
style="font-weight:bold;"&gt;From:&lt;/span&gt;&lt;/b&gt; d hee &lt;coolio@ymail.com&gt;&lt;br&gt;&lt;b&gt;&lt;span \
style="font-weight: bold;"&gt;To:&lt;/span&gt;&lt;/b&gt; "libvirt-users@redhat.com" \
&lt;libvirt-users@redhat.com&gt;&lt;br&gt;&lt;b&gt;&lt;span style="font-weight: \
bold;"&gt;Sent:&lt;/span&gt;&lt;/b&gt; Thursday, October 13, 2011 1:00 AM&lt;br&gt;&lt;b&gt;&lt;span \
style="font-weight: bold;"&gt;Subject:&lt;/span&gt;&lt;/b&gt; Virtio Balloon- Can not see the \
results&lt;br&gt;&lt;/font&gt;&lt;br&gt; &lt;div id="yiv322620496"&gt;&lt;div&gt;&lt;div \
style="color:#000;background-color:#fff;font-family:arial, helvetica, \
sans-serif;font-size:10pt;"&gt;&lt;div&gt;with kvm and virtio- would -m 1024 take proceedence \
over -balloon  virtio? when i use both together, i see memory stay around 1024 MB \
less on my host side. I know the guest is not taking but a fraction of that ram, so I \
would expect the virtio balloon to take the majority of the guests ram and hand it \
back to the host. this is using the free util/command to take snapshots of the host \
memory. &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;thanks,&lt;/div&gt;&lt;div&gt;-dman&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;




</body></email><email><emailId>20111017174352</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-10-17 17:43:52-0400</timestampReceived><subject>Re: [libvirt-users] Virtio Balloon- Can not see the results</subject><body>

On 10/13/2011 12:00 AM, d hee wrote:
&gt; with kvm and virtio- would -m 1024 take proceedence over -balloon
&gt; virtio? when i use both together, i see memory stay around 1024 MB less on my host \
&gt; side. I know the guest is not taking but a fraction of that ram, so I would expect \
&gt; the virtio balloon to take the majority of the guests ram and hand it back to the \
&gt; host. this is using the free util/command to take snapshots of the host memory.

Some helpful reading:
https://rwmj.wordpress.com/2010/07/17/virtio-balloon/
http://publib.boulder.ibm.com/infocenter/lnxinfo/v3r0m0/index.jsp?topic=%2Fliaat%2Fliaatbpballooning.htm


Remember that libvirt defaults to using both -m (maximum memory) and a 
virtio balloon (using -device virtio-balloon-pci, rather than -balloon, 
but the concept is the same).  As far as I know, there is _no way_ with 
current qemu to start a guest with less than maximum memory; rather, you 
are forced to start with maximum then rely on balloon to reduce the 
usage back down.  And this, unfortunately, requires guest cooperation. 
If the guest doesn't know how to use the virtio balloon driver, then you 
are stuck - the guest uses the maximum memory.  That said, from the host 
side, memory usage is still under normal host memory management rules, 
even if ballooning doesn't work, where the host can swap out pages that 
have not yet been touched by the guest, so that not all of the memory 
attributed to the guest is actually tying up host pages.

There's certainly room for improvement here, but it has to start with 
qemu improvements.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


</body></email><email><emailId>20111205003203</emailId><senderName>Todd And Margo Chester</senderName><senderEmail>toddandmargo@gmail.com</senderEmail><timestampReceived>2011-12-05 00:32:03-0400</timestampReceived><subject>Re: [libvirt-users] Can I configure cores instead of CPU's</subject><body>


&gt; On 3/12/2011 9:53 AM, Todd And Margo Chester wrote:
&gt;&gt;&gt; -------- Original message --------
&gt;&gt;&gt; Subject: Re: [libvirt-users] Can I configure cores instead of CPU's
&gt;&gt;&gt; From: Todd And Margo Chester&lt;toddandmargo@gmail.com&gt;
&gt;&gt;&gt; To: "libvirt-users@redhat.com"&lt;libvirt-users@redhat.com&gt;
&gt;&gt;&gt; CC:
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Hi All,
&gt;&gt;&gt;
&gt;&gt;&gt; Scientific Linux 6.1 x64
&gt;&gt;&gt; qemu-kvm-0.12.1.2-2.160.el6_1.2.x86_64
&gt;&gt;&gt;
&gt;&gt;&gt; My XP-Pro guest will only let me use two CPUs.
&gt;&gt;&gt; Is there a way I can tell Virt-Manager to use
&gt;&gt;&gt; one CPU with six cores instead of four separate
&gt;&gt;&gt; CPUs?
&gt;&gt;&gt;
&gt;&gt;&gt; I can manually insert things with
&gt;&gt;&gt; virsh edit KVM-WinXP
&gt;&gt;&gt;
&gt;&gt;&gt; Currently, I have:
&gt;&gt;&gt; &lt;vcpu&gt;6&lt;/vcpu&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; I found an example of a run string:
&gt;&gt;&gt;
&gt;&gt;&gt; -smp 2,sockets=2,cores=1,threads=1
&gt;&gt;&gt;
&gt;&gt;&gt; But I will be darned if I can figure out the virsh xml syntax.
&gt;&gt;&gt;
&gt;&gt;&gt; Many thanks,
&gt;&gt;&gt; -T
&gt;&gt; On 12/02/2011 05:32 PM, Frank Hauptle wrote:
&gt;&gt; &gt; Yes under advanced in cpu in virt manager are socket /core
&gt;&gt; &gt; settings. i use a fedora virt manager to connect to sl61
&gt;&gt; &gt; libvirt. more options that way.
&gt;&gt;
&gt;&gt;
&gt;&gt; I configured my processor in virt-mamager:
&gt;&gt;
&gt;&gt; CPU's: Current Allocation: 2
&gt;&gt; Manual set CPU Topology:
&gt;&gt; Sockets: 1
&gt;&gt; Cores: 6
&gt;&gt; Threads: 1
&gt;&gt;
&gt;&gt; or from my XML file
&gt;&gt;
&gt;&gt; &lt;vcpu&gt;1&lt;/vcpu&gt;
&gt;&gt; &lt;cpu&gt;
&gt;&gt; &lt;topology sockets='1' cores='6' threads='1'/&gt;
&gt;&gt; &lt;/cpu&gt;
&gt;&gt;
&gt;&gt; I still get two CPUs in my guest XP-Pro.
&gt;&gt;
&gt;&gt; What am I doing wrong?
&gt;&gt;
&gt;&gt; -T


On 12/03/2011 07:40 PM, Frank Hauptle wrote:
 &gt;I'm not even sure XP could differentiate
 &gt; between a core and a socket as multicore CPU's were not common to x86 in
 &gt; 2000 when XP was released.
 &gt;
 &gt; If you want to see if it really worked, download a knoppix CD and mount
 &gt; the ISO in the CDrom of that
 &gt; VM, then set it to boot from the CDROM.
 &gt;
 &gt; When knoppix boots up, open a terminal and type:
 &gt;
 &gt; cat /proc/cpuinfo
 &gt;
 &gt; See what it gives you.
 &gt;
 &gt; I think the hardware info GUI app in knoppix will give you more info too.
 &gt;
 &gt; cheers
 &gt;
 &gt;
 &gt; Frank


Hi Frank,

   Don't have knoppix, but do have FC16-Live-CD.

   The rules for CPU count in XP-Pro are as follows: the
physically chip that you install on your motherboard is
referred to by M$ as a CPU.  XP-Pro will only allow up to
two CPUs.  Each physical CPU may have as many processors
on it as will fit.  M$ calls these processors "cores".
XP-Pro does not limit cores as long as they do not span
more than two CPU's.

    My host machine has one CPU and four cores (eight if
you consider the hyperthreading).

    KVM is presenting my XP-Pro guest multiple CPUs, not cores.
XP will not use more than two CPUs by design.

    What I am after is a way to have KVM present my guest
one CPU with four cores. Not four independent CPUs.

    I have attached /proc/cpuinfo from Fedora Core 16
guest, along with my /proc/cpuinfo from my host.

    What am I doing wrong?

Many thanks,
-T



----&gt;&gt; cat /proc/cpuinfo from FC16 Guest:

processor	: 0
vendor_id	: GenuineIntel
cpu family	: 6
model		: 13
model name	: QEMU Virtual CPU version (cpu64-rhel6)
stepping	: 3
cpu MHz		: 3067.098
cache size	: 4096 KB
fpu		: yes
fpu_exception	: yes
cpuid level	: 4
wp		: yes
flags		: fpu de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pse36 
clflush mmx fxsr sse sse2 syscall nx lm nopl pni cx16 hypervisor lahf_lm
bogomips	: 6134.19
clflush size	: 64
cache_alignment	: 64
address sizes	: 40 bits physical, 48 bits virtual
power management:

processor	: 1
vendor_id	: GenuineIntel
cpu family	: 6
model		: 13
model name	: QEMU Virtual CPU version (cpu64-rhel6)
stepping	: 3
cpu MHz		: 3067.098
cache size	: 4096 KB
fpu		: yes
fpu_exception	: yes
cpuid level	: 4
wp		: yes
flags		: fpu de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pse36 
clflush mmx fxsr sse sse2 syscall nx lm nopl pni cx16 hypervisor lahf_lm
bogomips	: 6134.19
clflush size	: 64
cache_alignment	: 64
address sizes	: 40 bits physical, 48 bits virtual
power management:

processor	: 2
vendor_id	: GenuineIntel
cpu family	: 6
model		: 13
model name	: QEMU Virtual CPU version (cpu64-rhel6)
stepping	: 3
cpu MHz		: 3067.098
cache size	: 4096 KB
fpu		: yes
fpu_exception	: yes
cpuid level	: 4
wp		: yes
flags		: fpu de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pse36 
clflush mmx fxsr sse sse2 syscall nx lm nopl pni cx16 hypervisor lahf_lm
bogomips	: 6134.19
clflush size	: 64
cache_alignment	: 64
address sizes	: 40 bits physical, 48 bits virtual
power management:

processor	: 3
vendor_id	: GenuineIntel
cpu family	: 6
model		: 13
model name	: QEMU Virtual CPU version (cpu64-rhel6)
stepping	: 3
cpu MHz		: 3067.098
cache size	: 4096 KB
fpu		: yes
fpu_exception	: yes
cpuid level	: 4
wp		: yes
flags		: fpu de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pse36 
clflush mmx fxsr sse sse2 syscall nx lm nopl pni cx16 hypervisor lahf_lm
bogomips	: 6134.19
clflush size	: 64
cache_alignment	: 64
address sizes	: 40 bits physical, 48 bits virtual
power management:



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
----&gt;&gt; cat /proc/cpuinfo from  Local Host (i7-960)

processor	: 0
vendor_id	: GenuineIntel
cpu family	: 6
model		: 26
model name	: Intel(R) Core(TM) i7 CPU         950  @ 3.07GHz
stepping	: 5
cpu MHz		: 1600.000
cache size	: 8192 KB
physical id	: 0
siblings	: 8
core id		: 0
cpu cores	: 4
apicid		: 0
initial apicid	: 0
fpu		: yes
fpu_exception	: yes
cpuid level	: 11
wp		: yes
flags		: fpu vme de pse tsc msr pae mce cx8 apic mtrr pge mca cmov pat 
pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp 
lm constant_tsc arch_perfmon pebs bts rep_good xtopology nonstop_tsc 
aperfmperf pni dtes64 monitor ds_cpl vmx est tm2 ssse3 cx16 xtpr pdcm 
sse4_1 sse4_2 popcnt lahf_lm ida tpr_shadow vnmi flexpriority ept vpid
bogomips	: 6134.19
clflush size	: 64
cache_alignment	: 64
address sizes	: 36 bits physical, 48 bits virtual
power management:

processor	: 1
vendor_id	: GenuineIntel
cpu family	: 6
model		: 26
model name	: Intel(R) Core(TM) i7 CPU         950  @ 3.07GHz
stepping	: 5
cpu MHz		: 1600.000
cache size	: 8192 KB
physical id	: 0
siblings	: 8
core id		: 1
cpu cores	: 4
apicid		: 2
initial apicid	: 2
fpu		: yes
fpu_exception	: yes
cpuid level	: 11
wp		: yes
flags		: fpu vme de pse tsc msr pae mce cx8 apic mtrr pge mca cmov pat 
pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp 
lm constant_tsc arch_perfmon pebs bts rep_good xtopology nonstop_tsc 
aperfmperf pni dtes64 monitor ds_cpl vmx est tm2 ssse3 cx16 xtpr pdcm 
sse4_1 sse4_2 popcnt lahf_lm ida tpr_shadow vnmi flexpriority ept vpid
bogomips	: 6132.39
clflush size	: 64
cache_alignment	: 64
address sizes	: 36 bits physical, 48 bits virtual
power management:

processor	: 2
vendor_id	: GenuineIntel
cpu family	: 6
model		: 26
model name	: Intel(R) Core(TM) i7 CPU         950  @ 3.07GHz
stepping	: 5
cpu MHz		: 1600.000
cache size	: 8192 KB
physical id	: 0
siblings	: 8
core id		: 2
cpu cores	: 4
apicid		: 4
initial apicid	: 4
fpu		: yes
fpu_exception	: yes
cpuid level	: 11
wp		: yes
flags		: fpu vme de pse tsc msr pae mce cx8 apic mtrr pge mca cmov pat 
pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp 
lm constant_tsc arch_perfmon pebs bts rep_good xtopology nonstop_tsc 
aperfmperf pni dtes64 monitor ds_cpl vmx est tm2 ssse3 cx16 xtpr pdcm 
sse4_1 sse4_2 popcnt lahf_lm ida tpr_shadow vnmi flexpriority ept vpid
bogomips	: 6132.40
clflush size	: 64
cache_alignment	: 64
address sizes	: 36 bits physical, 48 bits virtual
power management:

processor	: 3
vendor_id	: GenuineIntel
cpu family	: 6
model		: 26
model name	: Intel(R) Core(TM) i7 CPU         950  @ 3.07GHz
stepping	: 5
cpu MHz		: 1600.000
cache size	: 8192 KB
physical id	: 0
siblings	: 8
core id		: 3
cpu cores	: 4
apicid		: 6
initial apicid	: 6
fpu		: yes
fpu_exception	: yes
cpuid level	: 11
wp		: yes
flags		: fpu vme de pse tsc msr pae mce cx8 apic mtrr pge mca cmov pat 
pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp 
lm constant_tsc arch_perfmon pebs bts rep_good xtopology nonstop_tsc 
aperfmperf pni dtes64 monitor ds_cpl vmx est tm2 ssse3 cx16 xtpr pdcm 
sse4_1 sse4_2 popcnt lahf_lm ida tpr_shadow vnmi flexpriority ept vpid
bogomips	: 6132.39
clflush size	: 64
cache_alignment	: 64
address sizes	: 36 bits physical, 48 bits virtual
power management:

processor	: 4
vendor_id	: GenuineIntel
cpu family	: 6
model		: 26
model name	: Intel(R) Core(TM) i7 CPU         950  @ 3.07GHz
stepping	: 5
cpu MHz		: 1600.000
cache size	: 8192 KB
physical id	: 0
siblings	: 8
core id		: 0
cpu cores	: 4
apicid		: 1
initial apicid	: 1
fpu		: yes
fpu_exception	: yes
cpuid level	: 11
wp		: yes
flags		: fpu vme de pse tsc msr pae mce cx8 apic mtrr pge mca cmov pat 
pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp 
lm constant_tsc arch_perfmon pebs bts rep_good xtopology nonstop_tsc 
aperfmperf pni dtes64 monitor ds_cpl vmx est tm2 ssse3 cx16 xtpr pdcm 
sse4_1 sse4_2 popcnt lahf_lm ida tpr_shadow vnmi flexpriority ept vpid
bogomips	: 6132.38
clflush size	: 64
cache_alignment	: 64
address sizes	: 36 bits physical, 48 bits virtual
power management:

processor	: 5
vendor_id	: GenuineIntel
cpu family	: 6
model		: 26
model name	: Intel(R) Core(TM) i7 CPU         950  @ 3.07GHz
stepping	: 5
cpu MHz		: 1600.000
cache size	: 8192 KB
physical id	: 0
siblings	: 8
core id		: 1
cpu cores	: 4
apicid		: 3
initial apicid	: 3
fpu		: yes
fpu_exception	: yes
cpuid level	: 11
wp		: yes
flags		: fpu vme de pse tsc msr pae mce cx8 apic mtrr pge mca cmov pat 
pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp 
lm constant_tsc arch_perfmon pebs bts rep_good xtopology nonstop_tsc 
aperfmperf pni dtes64 monitor ds_cpl vmx est tm2 ssse3 cx16 xtpr pdcm 
sse4_1 sse4_2 popcnt lahf_lm ida tpr_shadow vnmi flexpriority ept vpid
bogomips	: 6132.39
clflush size	: 64
cache_alignment	: 64
address sizes	: 36 bits physical, 48 bits virtual
power management:

processor	: 6
vendor_id	: GenuineIntel
cpu family	: 6
model		: 26
model name	: Intel(R) Core(TM) i7 CPU         950  @ 3.07GHz
stepping	: 5
cpu MHz		: 1600.000
cache size	: 8192 KB
physical id	: 0
siblings	: 8
core id		: 2
cpu cores	: 4
apicid		: 5
initial apicid	: 5
fpu		: yes
fpu_exception	: yes
cpuid level	: 11
wp		: yes
flags		: fpu vme de pse tsc msr pae mce cx8 apic mtrr pge mca cmov pat 
pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp 
lm constant_tsc arch_perfmon pebs bts rep_good xtopology nonstop_tsc 
aperfmperf pni dtes64 monitor ds_cpl vmx est tm2 ssse3 cx16 xtpr pdcm 
sse4_1 sse4_2 popcnt lahf_lm ida tpr_shadow vnmi flexpriority ept vpid
bogomips	: 6132.39
clflush size	: 64
cache_alignment	: 64
address sizes	: 36 bits physical, 48 bits virtual
power management:

processor	: 7
vendor_id	: GenuineIntel
cpu family	: 6
model		: 26
model name	: Intel(R) Core(TM) i7 CPU         950  @ 3.07GHz
stepping	: 5
cpu MHz		: 1600.000
cache size	: 8192 KB
physical id	: 0
siblings	: 8
core id		: 3
cpu cores	: 4
apicid		: 7
initial apicid	: 7
fpu		: yes
fpu_exception	: yes
cpuid level	: 11
wp		: yes
flags		: fpu vme de pse tsc msr pae mce cx8 apic mtrr pge mca cmov pat 
pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp 
lm constant_tsc arch_perfmon pebs bts rep_good xtopology nonstop_tsc 
aperfmperf pni dtes64 monitor ds_cpl vmx est tm2 ssse3 cx16 xtpr pdcm 
sse4_1 sse4_2 popcnt lahf_lm ida tpr_shadow vnmi flexpriority ept vpid
bogomips	: 6132.39
clflush size	: 64
cache_alignment	: 64
address sizes	: 36 bits physical, 48 bits virtual
power management:



</body></email><email><emailId>20111205084601</emailId><senderName>Shaun Glass</senderName><senderEmail>shaunglass@gmail.com</senderEmail><timestampReceived>2011-12-05 08:46:01-0400</timestampReceived><subject>[libvirt-users] virt-manager / libvirtd connection options</subject><body>

Good Day,

I had previously posted an issue last week where I had qemu/kvm
running on RHEL 6.1 and could not create any vm's when connecting from
virt-manager running on another machine. Seems virt-manager checks the
host it is running on for the capability of creating vm's as opposed
to the machine it has connected to. Nobody could give me an answer to
why that happens or how to fix.

I have in the meantime setup convirture on the RHEL 6.1 machine but
would prefer to use virt-manager. Can anyone offer any suggestions to
what is the best way to connect from a remote client to the RHEL 6.1
machine running qemu/kvm. The method I was trying to use was ssh with
publickey login.

Regards

</body></email><email><emailId>20111101015635</emailId><senderName>Wen Congyang</senderName><senderEmail>wency@cn.fujitsu.com</senderEmail><timestampReceived>2011-11-01 01:56:35-0400</timestampReceived><subject>Re: [libvirt-users] Hard limit for the cpu usage of a VM</subject><body>

At 10/25/2011 05:13 AM, Eric Blake Write:
&gt; On 10/24/2011 02:54 PM, sethuraman subbiah wrote:
&gt; 
&gt;&gt; [root@sbc11 ssubbiah]# virsh schedinfo rubis_ws --set vcpu_quota=50
&gt;&gt; Scheduler      : posix
&gt;&gt; error: invalid scheduler option: vcpu_quota=50
&gt;&gt;
&gt;&gt; I get the same error for "virsh schedinfo rubies_ws --set vcpu_quota
&gt;&gt; 50" .
&gt;&gt;
&gt;&gt; I find that my version is 0.9.4.
&gt;&gt;
&gt;&gt; [root@sbc11 ssubbiah]# virsh --version
&gt;&gt; 0.9.4
&gt;&gt;
&gt;&gt; Should I do some modifications,enable options or add some patch to get
&gt;&gt; the capability to set cap ? Thanks for all your help.
&gt; 
&gt; I found this comment in the code:
&gt; 
&gt;     /* If we does not know VCPU&lt;-&gt;PID mapping or all vcpu runs in the same
&gt;      * thread, we cannot control each vcpu. So we only modify cpu bandwidth
&gt;      * when each vcpu has a separated thread.
&gt;     
&gt; I think that means that in order to use CPU caps, you have to also use
&gt; &lt;vcpupin&gt; to call out the host CPU pinning to be used by the guest VCPUS.

VCPU&lt;-&gt;PID mapping is the thread id for each vcpu. qemu-kvm supports this
feature. We use monitor command query-cpus to get VCPU&lt;-&gt;PID mapping in
libvirt(the function is: qemuProcessDetectVcpuPIDs()).

&gt; 
&gt; The original implementation was here, although I don't see much
&gt; documentation in that patch series.
&gt; https://www.redhat.com/archives/libvir-list/2011-July/msg01389.html
&gt; 
&gt; Wen, can you help out here?
&gt; 

It seems that the kernel does not support it. The cfs bandwidth was merged into
kernel tree about some months ago.

Thanks
Wen Congyang

</body></email><email><emailId>20111101163942</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-11-01 16:39:42-0400</timestampReceived><subject>Re: [libvirt-users] Error on the site</subject><body>

On 11/01/2011 01:15 AM, Alexander Biryukov wrote:
&gt; Good afternoon.
&gt; I apologize for my English.
&gt;
&gt; Error on page: http://libvirt.org/formatdomain.html
&gt; To be more precise in the line "&lt;target *def*='hdc' bus='ide'/&gt;"

Thanks; I'm pushing this as the trivial fix:

diff --git i/docs/formatdomain.html.in w/docs/formatdomain.html.in
index 4fb5829..c3e7752 100644
--- i/docs/formatdomain.html.in
+++ w/docs/formatdomain.html.in
@@ -925,7 +925,7 @@
      &lt;/disk&gt;
      &lt;disk type='block' device='cdrom'&gt;
        &lt;driver name='qemu' type='raw'/&gt;
-      &lt;target def='hdc' bus='ide'/&gt;
+      &lt;target dev='hdc' bus='ide'/&gt;
        &lt;readonly/&gt;
      &lt;/disk&gt;
    &lt;/devices&gt;


-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20111101195321</emailId><senderName>Joe Auty</senderName><senderEmail>joe@netmusician.org</senderEmail><timestampReceived>2011-11-01 19:53:21-0400</timestampReceived><subject>[libvirt-users] Network filesystem pool mount options</subject><body>

Hello,

What are the default NFS mount options used by libvirt's network
filesystem pool storage management, and can these be modified?


-- 
Joe Auty, NetMusician
NetMusician helps musicians, bands and artists create beautiful,
professional, custom designed, career-essential websites that are easy
to maintain and to integrate with popular social networks.
www.netmusician.org &lt;http://www.netmusician.org&gt;
joe@netmusician.org &lt;mailto:joe@netmusician.org&gt;


[Attachment #3 (multipart/related)]

[Attachment #5 (text/html)]

&lt;html&gt;&lt;head&gt;
&lt;meta http-equiv="content-type" content="text/html; charset=ISO-8859-1"&gt;&lt;/head&gt;&lt;body
 bgcolor="#FFFFFF" text="#000000"&gt;
Hello,&lt;br&gt;
  &lt;br&gt;
What are the default NFS mount options used by libvirt's network 
filesystem pool storage management, and can these be modified?&lt;br&gt;
  &lt;br&gt;
  &lt;br&gt;
  &lt;div class="moz-signature"&gt;-- &lt;br&gt;

&lt;span style="font-weight: bold;"&gt;Joe Auty, NetMusician&lt;/span&gt;&lt;br&gt;






&lt;img style="width: 67px; height: 67px;" alt="" 
src="cid:part1.00030708.00020607@netmusician.org" align="left"&gt;NetMusician
 helps musicians, bands and artists create beautiful,
professional, custom designed, career-essential websites that are easy
to maintain and to integrate with popular social networks.&lt;br&gt;







&lt;a href="http://www.netmusician.org"&gt;www.netmusician.org&lt;/a&gt;&lt;br&gt;







&lt;a href="mailto:joe@netmusician.org"&gt;joe@netmusician.org&lt;/a&gt;&lt;br&gt;







&lt;br&gt;






  &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
["nmtwitter.png" (image/png)]

</body></email><email><emailId>20111102093936</emailId><senderName>Jiri Denemark</senderName><senderEmail>jdenemar@redhat.com</senderEmail><timestampReceived>2011-11-02 09:39:36-0400</timestampReceived><subject>Re: [libvirt-users] CentOS5: libvirtd filling up /var/lib/libvirt/qemu/save</subject><body>

On Tue, Nov 01, 2011 at 17:14:47 -0400, Ben Clay wrote:
&gt; How can I disable libvirtd from attempting to suspend VMs on poweroff /
&gt; reboot?

There is a separate init script which provides this feature. All you need to
do is to disable it:

    chkconfig libvirt-guests off

Alternatively, you may configure it to shutdown your VMs instead of suspending
them. See /etc/sysconfig/libvirt-guests.

&gt; It is slowly filling up our /var/ filesystem with save points at
&gt; /var/lib/libvirt/qemu/save/&lt;vm name&gt;.save

IIRC, that libvirt version had a bug that save files were not removed after
successful resume, which I believe is fixed in current release.

Jirka

</body></email><email><emailId>20111102095931</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-11-02 09:59:31-0400</timestampReceived><subject>Re: [libvirt-users] auto-set /cgroup/*/libvirt/qemu/&lt;vm name&gt;/ directory permissions on creation</subject><body>

On Tue, Nov 01, 2011 at 05:27:24PM -0400, Ben Clay wrote:
&gt; Is there a way to automatically set the permissions of cgroups directories
&gt; created by libvirt when a VM is launched?  
&gt; 
&gt;  
&gt; 
&gt; Although it looks like I can set permissions on top-level /cgroup
&gt; directories via cgconfig.conf, the cgconfig.conf manpage says "Permissions
&gt; are related only to enclosing control group and are not inherited by
&gt; subgroups.".  From this, I believe that when libvirt creates VMs, the new
&gt; directories under /cgroup/*/libvirt/qemu/&lt;vm name&gt;/ will not receive the
&gt; cgconfig.conf permissions.
&gt; 
&gt;  
&gt; 
&gt; Where in the libvirt config can I set this?  We need users other than root
&gt; to write to specific subsystems.

We don't support setting alternate permissions, because the intention is
that all access is via libvirt APIs, which allow unprivileged users as
defined by the libvirt access control policy.

Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20111102143127</emailId><senderName>Alex</senderName><senderEmail>mysqlstudent@gmail.com</senderEmail><timestampReceived>2011-11-02 14:31:27-0400</timestampReceived><subject>[libvirt-users] general protection errors</subject><body>

Hi,
Some time ago I sent a message about some general protection errors,
and didn't receive a response. I hoped I could post again and that
someone might have some ideas. I really don't think it is a hardware
problem producing these errors, but am otherwise out of ideas.

 I'm having a problem with a fedora15 x86_64 host with a fedora15
x86_64 guest on a Xeon E3-1240 with 8GB RAM on the guest. This is the
only guest. The server is configured as a mail server, using
spamassassin, postfix, amavisd, and clamav.

Have there been significant changes in the current version from 0.8.8
that is shipped with fedora15?

It was previously running without error on different hardware. I
migrated the disks to a more powerful server due to load. It's a new
server, and has been stress tested with memtest86, mprime, and
passmark's Linux test for more than 24 hours without producing a
problem.

However, when I run the kvm vm, I receive a bunch of errors similar to
these on the guest:

[169245.360511] clamscan[27448] general protection ip:7f125f2e6ffb
sp:7fff117566f0 error:0 in libclamav.so.6.1.11[7f125f229000+9ce000]

[29016.445470] clamd[1110] general protection ip:30df2c3981
sp:7fffa08f4fe0 error:0 in libclamav.so.6.1
.11[30df200000+9ce000]

There are other applications, such as pyzor, that produce similar errors.

Is this something that could be a result of some software
configuration error I've made? Is there something I can do to debug
this further? There also aren't any errors on the host indicating a
kernel problem or hardware issue.

Is it possible this is a known error?

I was previously trying to improve IO performance by using 'block'
instead of 'file' for the device, but had to abandon that idea because
it didn't work and I had to concentrate on this problem.

Could disabling the cache (cache=none) cause this?

I've included some info below, in hopes someone could guide me towards
a solution.

# rpm -qva|egrep 'kvm|libvirt|kernel|qemu'
libvirt-python-0.8.8-7.fc15.x86_64
kernel-2.6.40.6-0.fc15.x86_64
qemu-img-0.14.0-8.fc15.x86_64
gpxe-roms-qemu-1.0.1-4.fc15.noarch
kernel-2.6.40.4-5.fc15.x86_64
qemu-system-x86-0.14.0-8.fc15.x86_64
libvirt-0.8.8-7.fc15.x86_64
libvirt-client-0.8.8-7.fc15.x86_64
qemu-common-0.14.0-8.fc15.x86_64
kernel-headers-2.6.40.6-0.fc15.x86_64
qemu-kvm-0.14.0-8.fc15.x86_64

I've included my domain config below in hopes it helps.

&lt;domain type='kvm'&gt;
 &lt;name&gt;mail02&lt;/name&gt;
 &lt;uuid&gt;ec4f3cf5-2f27-fb3e-72f6-3fa3176b13b6&lt;/uuid&gt;
 &lt;memory&gt;6291456&lt;/memory&gt;
 &lt;currentMemory&gt;6291456&lt;/currentMemory&gt;
 &lt;vcpu&gt;4&lt;/vcpu&gt;
 &lt;os&gt;
   &lt;type arch='x86_64' machine='pc-0.14'&gt;hvm&lt;/type&gt;
   &lt;boot dev='hd'/&gt;
 &lt;/os&gt;
 &lt;features&gt;
   &lt;acpi/&gt;
   &lt;apic/&gt;
   &lt;pae/&gt;
 &lt;/features&gt;
 &lt;clock offset='utc'/&gt;
 &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
 &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
 &lt;on_crash&gt;restart&lt;/on_crash&gt;
 &lt;devices&gt;
   &lt;emulator&gt;/usr/bin/qemu-kvm&lt;/emulator&gt;
   &lt;disk type='file' device='disk'&gt;
     &lt;driver name='qemu' type='raw' cache='none'/&gt;
     &lt;source file='/var/lib/libvirt/images/mail02.img'/&gt;
     &lt;target dev='vda' bus='virtio'/&gt;
     &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x05'
function='0x0'/&gt;
   &lt;/disk&gt;
   &lt;disk type='block' device='cdrom'&gt;
     &lt;driver name='qemu' type='raw'/&gt;
     &lt;target dev='hdc' bus='ide'/&gt;
     &lt;readonly/&gt;
     &lt;address type='drive' controller='0' bus='1' unit='0'/&gt;
   &lt;/disk&gt;
   &lt;controller type='ide' index='0'&gt;
     &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x01'
function='0x1'/&gt;
   &lt;/controller&gt;
   &lt;interface type='bridge'&gt;
     &lt;mac address='52:54:00:67:2c:4c'/&gt;
     &lt;source bridge='br0'/&gt;
     &lt;model type='virtio'/&gt;
     &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03'
function='0x0'/&gt;
   &lt;/interface&gt;
   &lt;serial type='pty'&gt;
     &lt;target port='0'/&gt;
   &lt;/serial&gt;
   &lt;console type='pty'&gt;
     &lt;target type='serial' port='0'/&gt;
   &lt;/console&gt;
   &lt;input type='mouse' bus='ps2'/&gt;
   &lt;graphics type='vnc' port='-1' autoport='yes'/&gt;
   &lt;video&gt;
     &lt;model type='cirrus' vram='9216' heads='1'/&gt;
     &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x02'
function='0x0'/&gt;
   &lt;/video&gt;
   &lt;memballoon model='virtio'&gt;
     &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x06'
function='0x0'/&gt;
   &lt;/memballoon&gt;
 &lt;/devices&gt;
&lt;/domain&gt;

Thanks,
Alex

</body></email><email><emailId>20111103173650</emailId><senderName>Jean-Luc Derrien</senderName><senderEmail>jl.derrien@gmail.com</senderEmail><timestampReceived>2011-11-03 17:36:50-0400</timestampReceived><subject>[libvirt-users] Cannot start VM after restart libvirt daemon</subject><body>

Hello all,

I'm using libvirt 0.8.3 on Debian Lenny (package provided in
lenny-backports).

After restarting libvirtd, I cannot start VM anymore.

The daemon is restarted, but each time I try to start a domain, I get this
message :

virsh # start vm2
error: Failed to start domain vm2
error: internal error Process exited while reading console log output:


When daemon is started with -v argument :

18:20:26.142: warning : qemudParsePCIDeviceStrs:1422 : Unexpected exit
status '1', qemu probably failed
18:20:26.149: error : virExecDaemonize:782 : internal error Intermediate
daemon process exited with status 0.
18:20:26.230: error : qemudReadLogOutput:2118 : internal error Process
exited while reading console log output:


In /var/log/syslog :

Nov  3 18:20:26 ksm03 kernel: device vnet0 entered promiscuous mode
Nov  3 18:20:26 ksm03 kernel: br0: port 2(vnet0) entering learning state
Nov  3 18:20:26 ksm03 kernel: br0: port 2(vnet0) entering learning state
Nov  3 18:20:26 ksm03 kernel: libvirtd[13599]: segfault at 41882000 ip
000000000043ac8b sp 000000004187e3b0 error 4 in libvirtd[400000+db000]
Nov  3 18:20:26 ksm03 kernel: br0: port 2(vnet0) entering learning state
Nov  3 18:20:26 ksm03 kernel: device vnet0 left promiscuous mode
Nov  3 18:20:26 ksm03 kernel: br0: port 2(vnet0) entering disabled state


When I reboot the server it works.

Help welcome. Thanks in advance.


Regards,
Jean-Luc

[Attachment #3 (text/html)]

Hello all,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I'm using libvirt 0.8.3 on Debian Lenny (=
package provided in lenny-backports).&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;After restar=
ting libvirtd, I cannot start VM anymore.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The daem=
on is restarted, but each time I try to start a domain, I get this message =
:&lt;/div&gt;

&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;virsh # start vm2&lt;/div&gt;&lt;div&gt;error: Failed to start=
 domain vm2&lt;/div&gt;&lt;div&gt;error: internal error Process exited while reading co=
nsole log output:=A0&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;When dae=
mon is started with -v argument :&lt;/div&gt;

&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;18:20:26.142: warning : qemudParsePCIDeviceStrs:14=
22 : Unexpected exit status '1', qemu probably failed&lt;/div&gt;&lt;div&gt;18:=
20:26.149: error : virExecDaemonize:782 : internal error Intermediate daemo=
n process exited with status 0.&lt;/div&gt;

&lt;div&gt;18:20:26.230: error : qemudReadLogOutput:2118 : internal error Process=
 exited while reading console log output:=A0&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div=
&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;In /var/log/syslog :&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;Nov =A03=
 18:20:26 ksm03 kernel: device vnet0 entered promiscuous mode&lt;/div&gt;

&lt;div&gt;Nov =A03 18:20:26 ksm03 kernel: br0: port 2(vnet0) entering learning s=
tate&lt;/div&gt;&lt;div&gt;Nov =A03 18:20:26 ksm03 kernel: br0: port 2(vnet0) entering =
learning state&lt;/div&gt;&lt;div&gt;Nov =A03 18:20:26 ksm03 kernel: libvirtd[13599]: s=
egfault at 41882000 ip 000000000043ac8b sp 000000004187e3b0 error 4 in libv=
irtd[400000+db000]&lt;/div&gt;

&lt;div&gt;Nov =A03 18:20:26 ksm03 kernel: br0: port 2(vnet0) entering learning s=
tate&lt;/div&gt;&lt;div&gt;Nov =A03 18:20:26 ksm03 kernel: device vnet0 left promiscuou=
s mode&lt;/div&gt;&lt;div&gt;Nov =A03 18:20:26 ksm03 kernel: br0: port 2(vnet0) enterin=
g disabled state&lt;/div&gt;

&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;When I reboot the server it works.=
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Help welcome.=A0Thanks in advance.&lt;/div&gt;&lt;div&gt;&lt;br&gt;=
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;Jean-Luc&lt;/div&gt;


</body></email><email><emailId>20111104102550</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-11-04 10:25:50-0400</timestampReceived><subject>Re: [libvirt-users] Event&amp;Callback in QEMU</subject><body>

On Fri, Nov 04, 2011 at 11:42:00AM +0800, huachao yao wrote:
&gt; Hi buddy,
&gt; I wanna to monitor a domain's life cycle event, so i register a event an a
&gt; 
&gt; virConnectDomainEventCallback, the code segment is as below:
&gt; 
&gt; ------------------------
&gt; int DomainEventCallback(virConnectPtr conn,
&gt; 			virDomainPtr dom,
&gt; 			int event,
&gt; 			int detail,
&gt; 		        void * opaque){
&gt; 	/*My code */
&gt;        .......
&gt; }
&gt; 
&gt; int main(){
&gt; 
&gt;   /* .....*/
&gt;    virDomainPtr dom = domain.getDomains("xp");
&gt;    virFreeCallback	freecb    = NULL;
&gt;    void *opaque	=NULL;
&gt;    virConnectDomainEventCallback cb	=DomainEventCallback;
&gt;    virConnectDomainEventRegisterAny(conn, dom,
&gt; VIR_DOMAIN_EVENT_ID_LIFECYCLE,
&gt; VIR_DOMAIN_EVENT_CALLBACK(cb),opaque,freecb);
&gt;   /* .....*/
&gt; }
&gt; 
&gt; but such a error happened:
&gt; libvir: Remote error : this function is not supported by the
&gt; connection driver: no event support
&gt; 
&gt; and the libvirt version is 0.9; the driver is QEMU-KVM ,version is 0.14.0.
&gt; 
&gt; I want to know why this Error will happen? Is the QEMU not support the
&gt; LIFECYCLE Event ? If it is , how can i monitor the domain's life cycle
&gt; event( such as started,defined and stopped..)

This means you have not registered any event loop implementation.

Take a look at examples/domain-events/events-c/event-test.c for a
good example of how to deal with the events APIs.

Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20111104133509</emailId><senderName></senderName><senderEmail>zlh_086@126.com</senderEmail><timestampReceived>2011-11-04 13:35:09-0400</timestampReceived><subject>Re: [libvirt-users] no connection driver available for openvz:///system</subject><body>

[Attachment #2 (text/plain)]

dears
I have some errors:

[root@libvirt libvirt]# libvirtd start
21:30:45.484: 2805: info : libvirt version: 0.9.6
21:30:45.484: 2805: error : virPidFileAcquirePath:345 : Failed to acquire pid file \
'/usr/local/var/run/libvirtd.pid': ×ÊÔ´ÔÝÊ±²»¿ÉÓÃ can you tell me why?


[Attachment #3 (text/html)]

&lt;div style="line-height:1.7;color:#000000;font-size:14px;font-family:arial"&gt;dears&lt;br&gt;I \
have some errors:&lt;br&gt;&lt;div&gt;&lt;/div&gt;&lt;div id="divNeteaseMailCard"&gt;&lt;/div&gt;[root@libvirt \
libvirt]# libvirtd start&lt;br&gt;21:30:45.484: 2805: info : libvirt version: \
0.9.6&lt;br&gt;21:30:45.484: 2805: error : virPidFileAcquirePath:345 : Failed to acquire \
pid file '/usr/local/var/run/libvirtd.pid': ×ÊÔ´ÔÝÊ±²»¿ÉÓÃ&lt;br&gt;can you tell me \
why?&lt;br&gt;&lt;br&gt;&lt;pre&gt;&lt;br&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;&lt;span title="neteasefooter"&gt;&lt;span \
id="netease_mail_footer"&gt;&lt;/span&gt;&lt;/span&gt;



</body></email><email><emailId>20111105190000</emailId><senderName>Stephen Eilert</senderName><senderEmail>spedrosa@gmail.com</senderEmail><timestampReceived>2011-11-05 19:00:00-0400</timestampReceived><subject>[libvirt-users] Libvirt exiting and respawning</subject><body>

Hi,

I'm trying to use Libvirt with LXC, under Ubuntu 11.04, but I can't get it
to work. It keeps exiting and being restarted by upstart. Log file follows.

It appears that it is complaining, among other things, of QEMU. I am not
running QEMU and would like to disable everything except for LXC, but I am
not sure it would fix my issue. I've set the log level to debug, even, but
didn't see anything out of ordinary. Even resorted to strace, but I don't
know enough about libvirtd to try and understand its behavior.

Anyone got any clue about what's causing it to decide to exit?

# libvirtd --version
libvirtd (libvirt) 0.9.2

# uname -a
Linux CI-Server-3-Backend-2 2.6.35.4-rscloud #2 SMP Sat Oct 29 21:16:49 UTC
2011 x86_64 x86_64 x86_64 GNU/Linux

# lxc-checkconfig
--- Namespaces ---
Namespaces: enabled
Utsname namespace: enabled
Ipc namespace: enabled
Pid namespace: enabled
User namespace: enabled
Network namespace: enabled
Multiple /dev/pts instances: enabled

--- Control groups ---
Cgroup: enabled
Cgroup namespace: enabled
Cgroup device: enabled
Cgroup sched: enabled
Cgroup cpu account: enabled
Cgroup memory controller: enabled
Cgroup cpuset: enabled

--- Misc ---
Veth pair device: enabled
Macvlan: enabled
Vlan: enabled
File capabilities: enabled

# cat /var/log/syslog

Nov  5 18:42:50 CI-Server-3-Backend-2 libvirtd: 18:42:50.696: 25820: info :
libvirt version: 0.9.2
Nov  5 18:42:50 CI-Server-3-Backend-2 libvirtd: 18:42:50.696: 25820: info :
networkReloadIptablesRules:1410 : Reloading iptab
les rules
Nov  5 18:42:50 CI-Server-3-Backend-2 libvirtd: 18:42:50.776: 25820: error
: virCommandWait:1393 : internal error Child proce
ss (/sbin/iptables --table mangle --delete POSTROUTING --out-interface
virbr0 --protocol udp --destination-port 68 --jump CHE
CKSUM --checksum-fill) status unexpected: exit status 1
Nov  5 18:42:50 CI-Server-3-Backend-2 libvirtd: 18:42:50.817: 25820: error
: virCommandWait:1393 : internal error Child proce
ss (/sbin/iptables --table mangle --insert POSTROUTING --out-interface
virbr0 --protocol udp --destination-port 68 --jump CHE
CKSUM --checksum-fill) status unexpected: exit status 1
Nov  5 18:42:50 CI-Server-3-Backend-2 libvirtd: 18:42:50.818: 25820:
warning : networkAddGeneralIptablesRules:1199 : Could not add rule to fixup
DHCP response checksums on network 'default'.
Nov  5 18:42:50 CI-Server-3-Backend-2 libvirtd: 18:42:50.818: 25820:
warning : networkAddGeneralIptablesRules:1200 : May need to update iptables
package &amp; kernel to support CHECKSUM rule.
Nov  5 18:42:50 CI-Server-3-Backend-2 libvirtd: 18:42:50.888: 25820: error
: udevDeviceMonitorStartup:1616 : Failed to initialize libpciaccess: No
such file or directory
Nov  5 18:42:50 CI-Server-3-Backend-2 libvirtd: 18:42:50.889: 25820: error
: virStateInitialize:830 : Initialization of udev state driver failed
Nov  5 18:42:50 CI-Server-3-Backend-2 libvirtd: 18:42:50.930: 25820: info :
qemudStartup:525 : Unable to create cgroup for driver: Invalid argument
Nov  5 18:42:50 CI-Server-3-Backend-2 libvirtd: 18:42:50.931: 25820: info :
qemudLoadDriverConfig:315 : Configured cgroup controller 'cpu'
Nov  5 18:42:50 CI-Server-3-Backend-2 libvirtd: 18:42:50.931: 25820: info :
qemudLoadDriverConfig:315 : Configured cgroup controller 'memory'
Nov  5 18:42:50 CI-Server-3-Backend-2 libvirtd: 18:42:50.931: 25820: info :
qemudLoadDriverConfig:315 : Configured cgroup controller 'devices'
Nov  5 18:42:50 CI-Server-3-Backend-2 libvirtd: 18:42:50.931: 25820: info :
qemudLoadDriverConfig:315 : Configured cgroup controller 'blkio'
Nov  5 18:42:51 CI-Server-3-Backend-2 libvirtd: 18:42:51.100: 25820: info :
virDomainLoadAllConfigs:9950 : Scanning for configs in /var/run/libvirt/qemu
Nov  5 18:42:51 CI-Server-3-Backend-2 libvirtd: 18:42:51.100: 25820: info :
virDomainLoadAllConfigs:9950 : Scanning for configs in /etc/libvirt/qemu
Nov  5 18:42:51 CI-Server-3-Backend-2 kernel: [  442.486147] lo: Disabled
Privacy Extensions
Nov  5 18:42:51 CI-Server-3-Backend-2 libvirtd: 18:42:51.319: 25820: info :
virDomainLoadAllConfigs:9950 : Scanning for configs in /var/run/libvirt/lxc
Nov  5 18:42:51 CI-Server-3-Backend-2 libvirtd: 18:42:51.319: 25820: info :
virDomainLoadAllConfigs:9950 : Scanning for configs in /etc/libvirt/lxc
Nov  5 18:42:51 CI-Server-3-Backend-2 libvirtd: 18:42:51.320: 25820: info :
umlStartup:431 : Adding inotify watch on /var/run/libvirt/uml-guest
Nov  5 18:42:51 CI-Server-3-Backend-2 libvirtd: 18:42:51.321: 25820: info :
virDomainLoadAllConfigs:9950 : Scanning for configs in /etc/libvirt/uml
Nov  5 18:42:51 CI-Server-3-Backend-2 libvirtd: 18:42:51.321: 25820: error
: main:3390 : Driver state initialization failed
Nov  5 18:42:51 CI-Server-3-Backend-2 libvirtd: 18:42:51.321: 25821:
warning : qemudDispatchSignalEvent:424 : Shutting down on signal 3


-- Stephen

*"Kids these days.*
*Whatever happened to hard work?"*

       -- Joel Spolsky, The perils of javaschools

[Attachment #3 (text/html)]

&lt;div&gt;&lt;br&gt;&lt;/div&gt;Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I'm trying to use Libvirt with LXC, under \
Ubuntu 11.04, but I can't get it to work. It keeps exiting and being restarted by \
upstart. Log file follows.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; It appears that it is \
complaining, among other things, of QEMU. I am not running QEMU and would like to \
disable everything except for LXC, but I am not sure it would fix my issue. I've \
set the log level to debug, even, but didn't see anything out of ordinary. Even \
resorted to strace, but I don't know enough about libvirtd to try and understand \
its behavior.&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Anyone got any clue about what's causing \
it to decide to exit?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;# libvirtd \
--version&lt;/div&gt;&lt;div&gt;libvirtd (libvirt) 0.9.2&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;# uname \
-a&lt;/div&gt;&lt;div&gt; Linux CI-Server-3-Backend-2 2.6.35.4-rscloud #2 SMP Sat Oct 29 21:16:49 \
UTC 2011 x86_64 x86_64 x86_64 GNU/Linux&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;# \
lxc-checkconfig  &lt;/div&gt;&lt;div&gt;--- Namespaces ---&lt;/div&gt;&lt;div&gt;Namespaces: enabled&lt;/div&gt; \
&lt;div&gt;Utsname namespace: enabled&lt;/div&gt;&lt;div&gt;Ipc namespace: enabled&lt;/div&gt;&lt;div&gt;Pid \
namespace: enabled&lt;/div&gt;&lt;div&gt;User namespace: enabled&lt;/div&gt;&lt;div&gt;Network namespace: \
enabled&lt;/div&gt;&lt;div&gt;Multiple /dev/pts instances: enabled&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;--- \
Control groups ---&lt;/div&gt;&lt;div&gt;Cgroup: enabled&lt;/div&gt;&lt;div&gt;Cgroup namespace: \
enabled&lt;/div&gt;&lt;div&gt;Cgroup device: enabled&lt;/div&gt;&lt;div&gt;Cgroup sched: \
enabled&lt;/div&gt;&lt;div&gt;Cgroup cpu account: enabled&lt;/div&gt;&lt;div&gt;Cgroup memory controller: \
enabled&lt;/div&gt; &lt;div&gt;Cgroup cpuset: enabled&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;--- Misc \
---&lt;/div&gt;&lt;div&gt;Veth pair device: enabled&lt;/div&gt;&lt;div&gt;Macvlan: enabled&lt;/div&gt;&lt;div&gt;Vlan: \
enabled&lt;/div&gt;&lt;div&gt;File capabilities: enabled&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; # cat \
/var/log/syslog&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;Nov   5 18:42:50 CI-Server-3-Backend-2 \
libvirtd: 18:42:50.696: 25820: info : libvirt version: 0.9.2&lt;/div&gt;&lt;div&gt;Nov   5 \
18:42:50 CI-Server-3-Backend-2 libvirtd: 18:42:50.696: 25820: info : \
networkReloadIptablesRules:1410 : Reloading iptab&lt;/div&gt; &lt;div&gt;les rules&lt;/div&gt;&lt;div&gt;Nov  \
5 18:42:50 CI-Server-3-Backend-2 libvirtd: 18:42:50.776: 25820: error : \
virCommandWait:1393 : internal error Child proce&lt;/div&gt;&lt;div&gt;ss (/sbin/iptables --table \
mangle --delete POSTROUTING --out-interface virbr0 --protocol udp --destination-port \
68 --jump CHE&lt;/div&gt; &lt;div&gt;CKSUM --checksum-fill) status unexpected: exit status \
1&lt;/div&gt;&lt;div&gt;Nov   5 18:42:50 CI-Server-3-Backend-2 libvirtd: 18:42:50.817: 25820: \
error : virCommandWait:1393 : internal error Child proce&lt;/div&gt;&lt;div&gt;ss (/sbin/iptables \
--table mangle --insert POSTROUTING --out-interface virbr0 --protocol udp \
--destination-port 68 --jump CHE&lt;/div&gt; &lt;div&gt;CKSUM --checksum-fill) status unexpected: \
exit status 1&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;Nov   5 18:42:50 CI-Server-3-Backend-2 libvirtd: \
18:42:50.818: 25820: warning : networkAddGeneralIptablesRules:1199 : Could not add \
rule to fixup DHCP response checksums on network 'default'.&lt;/div&gt; &lt;div&gt;Nov   \
5 18:42:50 CI-Server-3-Backend-2 libvirtd: 18:42:50.818: 25820: warning : \
networkAddGeneralIptablesRules:1200 : May need to update iptables package &amp; \
kernel to support CHECKSUM rule.&lt;/div&gt;&lt;div&gt;Nov   5 18:42:50 CI-Server-3-Backend-2 \
libvirtd: 18:42:50.888: 25820: error : udevDeviceMonitorStartup:1616 : Failed to \
initialize libpciaccess: No such file or directory&lt;/div&gt; &lt;div&gt;Nov   5 18:42:50 \
CI-Server-3-Backend-2 libvirtd: 18:42:50.889: 25820: error : virStateInitialize:830 : \
Initialization of udev state driver failed&lt;/div&gt;&lt;div&gt;Nov   5 18:42:50 \
CI-Server-3-Backend-2 libvirtd: 18:42:50.930: 25820: info : qemudStartup:525 : Unable \
to create cgroup for driver: Invalid argument&lt;/div&gt; &lt;div&gt;Nov   5 18:42:50 \
CI-Server-3-Backend-2 libvirtd: 18:42:50.931: 25820: info : qemudLoadDriverConfig:315 \
: Configured cgroup controller 'cpu'&lt;/div&gt;&lt;div&gt;Nov   5 18:42:50 \
CI-Server-3-Backend-2 libvirtd: 18:42:50.931: 25820: info : qemudLoadDriverConfig:315 \
: Configured cgroup controller 'memory'&lt;/div&gt; &lt;div&gt;Nov   5 18:42:50 \
CI-Server-3-Backend-2 libvirtd: 18:42:50.931: 25820: info : qemudLoadDriverConfig:315 \
: Configured cgroup controller 'devices'&lt;/div&gt;&lt;div&gt;Nov   5 18:42:50 \
CI-Server-3-Backend-2 libvirtd: 18:42:50.931: 25820: info : qemudLoadDriverConfig:315 \
: Configured cgroup controller 'blkio'&lt;/div&gt; &lt;div&gt;Nov   5 18:42:51 \
CI-Server-3-Backend-2 libvirtd: 18:42:51.100: 25820: info : \
virDomainLoadAllConfigs:9950 : Scanning for configs in \
/var/run/libvirt/qemu&lt;/div&gt;&lt;div&gt;Nov   5 18:42:51 CI-Server-3-Backend-2 libvirtd: \
18:42:51.100: 25820: info : virDomainLoadAllConfigs:9950 : Scanning for configs in \
/etc/libvirt/qemu&lt;/div&gt; &lt;div&gt;Nov   5 18:42:51 CI-Server-3-Backend-2 kernel: [   \
442.486147] lo: Disabled Privacy Extensions&lt;/div&gt;&lt;div&gt;Nov   5 18:42:51 \
CI-Server-3-Backend-2 libvirtd: 18:42:51.319: 25820: info : \
virDomainLoadAllConfigs:9950 : Scanning for configs in /var/run/libvirt/lxc&lt;/div&gt; \
&lt;div&gt;Nov   5 18:42:51 CI-Server-3-Backend-2 libvirtd: 18:42:51.319: 25820: info : \
virDomainLoadAllConfigs:9950 : Scanning for configs in /etc/libvirt/lxc&lt;/div&gt;&lt;div&gt;Nov \
5 18:42:51 CI-Server-3-Backend-2 libvirtd: 18:42:51.320: 25820: info : umlStartup:431 \
: Adding inotify watch on /var/run/libvirt/uml-guest&lt;/div&gt; &lt;div&gt;Nov   5 18:42:51 \
CI-Server-3-Backend-2 libvirtd: 18:42:51.321: 25820: info : \
virDomainLoadAllConfigs:9950 : Scanning for configs in /etc/libvirt/uml&lt;/div&gt;&lt;div&gt;Nov \
5 18:42:51 CI-Server-3-Backend-2 libvirtd: 18:42:51.321: 25820: error : main:3390 : \
Driver state initialization failed&lt;/div&gt; &lt;div&gt;Nov   5 18:42:51 CI-Server-3-Backend-2 \
libvirtd: 18:42:51.321: 25821: warning : qemudDispatchSignalEvent:424 : Shutting down \
on signal 3&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br clear="all"&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- \
Stephen&lt;div&gt;&lt;br&gt;&lt;div&gt;&lt;i&gt;"Kids these days.&lt;/i&gt;&lt;/div&gt; &lt;div&gt;&lt;i&gt;Whatever happened to \
hard work?"&lt;/i&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;           -- Joel Spolsky, The perils \
of javaschools&lt;/div&gt;&lt;/div&gt;&lt;br&gt; &lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20111106140213</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-11-06 14:02:13-0400</timestampReceived><subject>Re: [libvirt-users] Finding out if Xen or KVM is used</subject><body>

2011/11/5 PREETHI RAMESH &lt;iampreethiramesh@gmail.com&gt;:
&gt; I've got 2 doubts:
&gt; 1.I've been trying to write an application using Libvirt's Java API which
&gt; should run on both Xen and KVM running machines and execute the Xen or KVM
&gt; code based on the hypervisor used. I want the physical machine to know if
&gt; it's running Xen or KVM and execute only that code.
&gt;
&gt; While using getURI(), I need to use it as
&gt; conn.getURI()
&gt; but then I can't use conn without declaring it previously as Connect
&gt; conn=new Connect("URI");
&gt;
&gt; Is there any way to get the URI used and hence the hypervisor used?

The URI is the way you can tell libvirt how and to which hypervisor it
should connect.

libvirt also has some autodetection mechanism for local hypervisors.
Pass null as URI and libvirt will connect to the first available
locally installed hypervisor. This should give you the behavior you
want, because you can then use conn.getURI() to get the actual URI
used and detect the hypervisor from it.

&gt; 2. This question concerns the usage of the listDomains(). When I run this
&gt; piece of code in KVM, it works perfectly fine but throws an array out of
&gt; bounds exception in Xen.
&gt;
&gt; Connect conn=null;
&gt;              conn = new Connect("xen:///", true);
&gt;              int[] id = conn.listDomains();
&gt;              System.out.println("lD of VM " +id[0]);

Well, your code assumes that id.length is &gt;= 1, but listDomains() can
return an empty array when there are no active domains known to
libvirt. So you need to check id.length before accessing any element
in the array.

-- 
Matthias Bolte
http://photron.blogspot.com

</body></email><email><emailId>20111107040834</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-11-07 04:08:34-0400</timestampReceived><subject>Re: [libvirt-users] virt-manager: create lxc app container hangs</subject><body>

On 11/05/2011 10:11 PM, sean darcy wrote:
&gt; On 11/04/2011 09:55 PM, sean darcy wrote:
&gt;&gt; libvirt-0.9.6-2.fc15.x86_64
&gt;&gt; virt-manager-0.9.0-7.fc15.noarch
&gt;&gt;
&gt;&gt; I'm trying to use virt-manager create a simple lxc app container just to
&gt;&gt; see how it works. App is /bin/sh, 128 megs, 1 cpu.
&gt;&gt;
&gt;&gt; All seems to go well, but when I click "Finish" and the "Creating
&gt;&gt; Virtual Machine" box comes up, "Creating Domain..." stays at 0B though
&gt;&gt; the slider keeps going back and forth.
&gt;&gt;
&gt;&gt; Nothing in /var/log/libvirt/libvirtd.log
&gt;&gt;
&gt;&gt; No relevant log in /var/log/libvirt/qemu/
&gt;&gt;
&gt;&gt; Any help appreciated.
&gt;&gt;
&gt;&gt; sean
&gt;
&gt; I did find a log entry:
&gt;
&gt; cat /var/log/libvirt/lxc/bash.log
&gt; 2011-11-04 21:27:10.539: starting up
&gt; PATH=/sbin:/usr/sbin:/bin:/usr/bin LIBVIRT_DEBUG=3 
&gt; LIBVIRT_LOG_OUTPUTS=3:stderr /usr/libexec/libvirt_lxc --name bash 
&gt; --console 27 --handshake 30 --background --veth veth1
&gt;
&gt; FWIW, I let the dialog box run all night! No success.
&gt;
&gt; sean

Looks like your guest was started successfully,  you can
check if it's true by:

# virsh -c lxc:/// list --all

If it's true, it might be problem of virt-manager,  and you
should ask in virt-tools list instead.

Osier

</body></email><email><emailId>20111107183044</emailId><senderName>"Wouter"</senderName><senderEmail>w.a.miltenburg@hetnet.nl</senderEmail><timestampReceived>2011-11-07 18:30:44-0400</timestampReceived><subject>[libvirt-users] libvirtError: internal error cannot find PCI address for balloon virtio</subject><body>

This is a multipart message in MIME format.


Hi guys,

 

I have a little problem here. When I want to install a virtual machine I get
this error:

 

libvirtError: internal error cannot find PCI address for balloon virtio

 

 

Libvirt is running on a debian 5 system with kvm and of course libvirt. How
can I solve this problem, I searched on the Internet but there aren't posts
about this problem yet. So I don't have an idea where to look for.

 

I hope you guys can help me.

 

With kind regards,

Wouter.


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;&lt;head&gt;&lt;META HTTP-EQUIV="Content-Type" \
CONTENT="text/html; charset=us-ascii"&gt;&lt;meta name=Generator content="Microsoft Word 14 \
(filtered medium)"&gt;&lt;style&gt;&lt;!-- /* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	mso-fareast-language:EN-US;}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.E-mailStijl17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;
	font-family:"Calibri","sans-serif";
	mso-fareast-language:EN-US;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:70.85pt 70.85pt 70.85pt 70.85pt;}
div.WordSection1
	{page:WordSection1;}
--&gt;&lt;/style&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapelayout v:ext="edit"&gt;
&lt;o:idmap v:ext="edit" data="1" /&gt;
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;&lt;/head&gt;&lt;body lang=NL link=blue vlink=purple&gt;&lt;div \
class=WordSection1&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;Hi \
guys,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;I have a \
little problem here. When I want to install a virtual machine I get this \
error:&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;libvirtError: internal error cannot find PCI address for balloon \
virtio&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;Libvirt is \
running on a debian 5 system with kvm and of course libvirt. How can I solve this \
problem, I searched on the Internet but there aren’t posts about this problem \
yet. So I don’t have an idea where to look for.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;I hope you guys can help me.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;With kind \
regards,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;Wouter.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20111101211447</emailId><senderName>"Ben Clay"</senderName><senderEmail>rbclay@ncsu.edu</senderEmail><timestampReceived>2011-11-01 21:14:47-0400</timestampReceived><subject>[libvirt-users] CentOS5: libvirtd filling up /var/lib/libvirt/qemu/save</subject><body>

This is a multipart message in MIME format.


How can I disable libvirtd from attempting to suspend VMs on poweroff /
reboot?  It is slowly filling up our /var/ filesystem with save points at
/var/lib/libvirt/qemu/save/&lt;vm name&gt;.save, even though I'm not initiating
any suspend or restore functionality.

 

I checked /etc/libvirt/libvirtd.conf and /etc/libvirt/qemu.conf but could
not find anything.

 

This is CentOS 5 with libvirt 0.8.2-22 and kvm-83-239.

 

Thanks.

 

Ben Clay

 &lt;mailto:rbclay@ncsu.edu&gt; rbclay@ncsu.edu

 


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;&lt;head&gt;&lt;meta http-equiv=Content-Type \
content="text/html; charset=us-ascii"&gt;&lt;meta name=Generator content="Microsoft Word 14 \
(filtered medium)"&gt;&lt;style&gt;&lt;!-- /* Font Definitions */
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;
	font-family:"Calibri","sans-serif";}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
--&gt;&lt;/style&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapelayout v:ext="edit"&gt;
&lt;o:idmap v:ext="edit" data="1" /&gt;
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;&lt;/head&gt;&lt;body lang=EN-US link=blue vlink=purple&gt;&lt;div \
class=WordSection1&gt;&lt;p class=MsoNormal&gt;How can I disable libvirtd from attempting to \
suspend VMs on poweroff / reboot?  It is slowly filling up our /var/ filesystem \
with save points at /var/lib/libvirt/qemu/save/&lt;vm name&gt;.save, even though \
I’m not initiating any suspend or restore functionality.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;I checked \
/etc/libvirt/libvirtd.conf and /etc/libvirt/qemu.conf but could not find \
anything.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;This is CentOS 5 with libvirt 0.8.2-22 and \
kvm-83-239.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;Thanks.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;Ben Clay&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;a \
href="mailto:rbclay@ncsu.edu"&gt;&lt;span \
style='color:blue'&gt;rbclay@ncsu.edu&lt;/span&gt;&lt;/a&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20111101212724</emailId><senderName>"Ben Clay"</senderName><senderEmail>rbclay@ncsu.edu</senderEmail><timestampReceived>2011-11-01 21:27:24-0400</timestampReceived><subject>[libvirt-users] auto-set /cgroup/*/libvirt/qemu/&lt;vm name&gt;/ directory permissions on creation</subject><body>

This is a multipart message in MIME format.


Is there a way to automatically set the permissions of cgroups directories
created by libvirt when a VM is launched?  

 

Although it looks like I can set permissions on top-level /cgroup
directories via cgconfig.conf, the cgconfig.conf manpage says "Permissions
are related only to enclosing control group and are not inherited by
subgroups.".  From this, I believe that when libvirt creates VMs, the new
directories under /cgroup/*/libvirt/qemu/&lt;vm name&gt;/ will not receive the
cgconfig.conf permissions.

 

Where in the libvirt config can I set this?  We need users other than root
to write to specific subsystems.

 

I can ask on the libcg mailing list as well, but I thought I'd try here
first since libvirt is dynamically creating / destroying these groups.

 

Thanks.

 

Ben Clay

 &lt;mailto:rbclay@ncsu.edu&gt; rbclay@ncsu.edu

 


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;&lt;head&gt;&lt;meta http-equiv=Content-Type \
content="text/html; charset=us-ascii"&gt;&lt;meta name=Generator content="Microsoft Word 14 \
(filtered medium)"&gt;&lt;style&gt;&lt;!-- /* Font Definitions */
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;
	font-family:"Calibri","sans-serif";}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
--&gt;&lt;/style&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapelayout v:ext="edit"&gt;
&lt;o:idmap v:ext="edit" data="1" /&gt;
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;&lt;/head&gt;&lt;body lang=EN-US link=blue vlink=purple&gt;&lt;div \
class=WordSection1&gt;&lt;p class=MsoNormal&gt;Is there a way to automatically set the \
permissions of cgroups directories created by libvirt when a VM is launched?  \
&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;Although it \
looks like I can set permissions on top-level /cgroup directories via cgconfig.conf, \
the cgconfig.conf manpage says “Permissions are related only to enclosing \
control group and are not inherited by subgroups.”.  From this, I believe \
that when libvirt creates VMs, the new directories under \
/cgroup/*/libvirt/qemu/&lt;vm name&gt;/ will not receive the cgconfig.conf \
permissions.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;Where in the libvirt config can I set this?  We need users other \
than root to write to specific subsystems.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;I can ask on the libcg \
mailing list as well, but I thought I’d try here first since libvirt is \
dynamically creating / destroying these groups.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;Thanks.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;Ben Clay&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;a href="mailto:rbclay@ncsu.edu"&gt;&lt;span \
style='color:blue'&gt;rbclay@ncsu.edu&lt;/span&gt;&lt;/a&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20111104034200</emailId><senderName>huachao yao</senderName><senderEmail>yao.d.hc@gmail.com</senderEmail><timestampReceived>2011-11-04 03:42:00-0400</timestampReceived><subject>[libvirt-users] Event&amp;Callback in QEMU</subject><body>

Hi buddy,
I wanna to monitor a domain's life cycle event, so i register a event an a

virConnectDomainEventCallback, the code segment is as below:

------------------------
int DomainEventCallback(virConnectPtr conn,
			virDomainPtr dom,
			int event,
			int detail,
		        void * opaque){
	/*My code */
       .......
}

int main(){

  /* .....*/
   virDomainPtr dom = domain.getDomains("xp");
   virFreeCallback	freecb    = NULL;
   void *opaque	=NULL;
   virConnectDomainEventCallback cb	=DomainEventCallback;
   virConnectDomainEventRegisterAny(conn, dom,
VIR_DOMAIN_EVENT_ID_LIFECYCLE,
VIR_DOMAIN_EVENT_CALLBACK(cb),opaque,freecb);
  /* .....*/
}

but such a error happened:
libvir: Remote error : this function is not supported by the
connection driver: no event support

and the libvirt version is 0.9; the driver is QEMU-KVM ,version is 0.14.0.

I want to know why this Error will happen? Is the QEMU not support the
LIFECYCLE Event ? If it is , how can i monitor the domain's life cycle
event( such as started,defined and stopped..)

Pls help~~

[Attachment #3 (text/html)]

Hi buddy,&lt;br&gt;I wanna to monitor a domain's life cycle event, so i register a \
event an a&lt;br&gt;&lt;br&gt; virConnectDomainEventCallback, the code segment is as \
below:&lt;br&gt;&lt;pre&gt;------------------------&lt;br&gt;int DomainEventCallback(virConnectPtr \
conn,&lt;br&gt;  virDomainPtr dom,&lt;br&gt;			int event,&lt;br&gt;			int detail,&lt;br&gt;		        void * \
opaque){&lt;br&gt;	/*My code */&lt;br&gt;       .......&lt;br&gt;}&lt;br&gt;&lt;br&gt;int main(){&lt;br&gt;&lt;br&gt;  /* \
.....*/&lt;br&gt;   virDomainPtr dom = domain.getDomains("xp");&lt;br&gt;  \
virFreeCallback	freecb    = NULL;&lt;br&gt;   void *opaque	=NULL;&lt;br&gt;   \
virConnectDomainEventCallback cb	=DomainEventCallback;&lt;br&gt;   \
virConnectDomainEventRegisterAny(conn, dom, VIR_DOMAIN_EVENT_ID_LIFECYCLE, \
VIR_DOMAIN_EVENT_CALLBACK(cb),opaque,freecb);&lt;br&gt;  /* .....*/&lt;br&gt;}&lt;br&gt;&lt;br&gt;but such a \
error happened:&lt;br&gt;&lt;span style="color: rgb(255, 0, 0);"&gt;libvir: Remote error : this \
function is not supported by the connection driver: no event \
support&lt;/span&gt;&lt;br&gt;&lt;br&gt;and the libvirt version is 0.9; the driver is QEMU-KVM ,version \
is 0.14.0.&lt;br&gt; &lt;br&gt;I want to know why this Error will happen? Is the QEMU not support \
the &lt;br&gt;LIFECYCLE Event ? If it is , how can i monitor the domain's life cycle \
event( such as started,defined and stopped..)&lt;br&gt;&lt;br&gt;Pls help~~&lt;br&gt; &lt;/pre&gt;



</body></email><email><emailId>20111105072909</emailId><senderName>PREETHI RAMESH</senderName><senderEmail>iampreethiramesh@gmail.com</senderEmail><timestampReceived>2011-11-05 07:29:09-0400</timestampReceived><subject>[libvirt-users] Finding out if Xen or KVM is used</subject><body>

I've got 2 doubts:
1.I've been trying to write an application using Libvirt's Java API which
should run on both Xen and KVM running machines and execute the Xen or KVM
code based on the hypervisor used. I want the physical machine to know if
it's running Xen or KVM and execute only that code.

While using getURI(), I need to use it as
conn.getURI()
but then I can't use conn without declaring it previously as Connect
conn=new Connect("URI");

Is there any way to get the URI used and hence the hypervisor used?

2. This question concerns the usage of the listDomains(). When I run this
piece of code in KVM, it works perfectly fine but throws an array out of
bounds exception in Xen.

Connect conn=null;
             conn = new Connect("xen:///", true);
             int[] id = conn.listDomains();
             System.out.println("lD of VM " +id[0]);

Thanks for your time.
P Ramesh

[Attachment #3 (text/html)]

I've got 2 doubts:&lt;br&gt;1.I've been trying to write an application using \
Libvirt's Java API which should run on both Xen and KVM running machines and \
execute the Xen or KVM code based on the hypervisor used. I want the physical machine \
to know if it's running Xen or KVM and execute only that code. &lt;br&gt; &lt;br&gt;While \
using getURI(), I need to use it as &lt;br&gt;conn.getURI() &lt;br&gt;but then I can't use \
conn without declaring it previously as Connect conn=new \
Connect("URI");&lt;br&gt;&lt;br&gt;Is there any way to get the URI used and hence the \
hypervisor used?&lt;br&gt; &lt;br&gt;2. This question concerns the usage of the listDomains(). \
When I run this piece of code in KVM, it works perfectly fine but throws an array out \
of bounds exception in Xen.&lt;br&gt;&lt;br&gt;Connect conn=null;&lt;br&gt;             conn = new \
                Connect("xen:///", true);&lt;br&gt;
             int[] id = conn.listDomains();&lt;br&gt;             \
System.out.println("lD of VM " +id[0]);&lt;br&gt;&lt;br&gt;Thanks for your time.&lt;br&gt;P \
Ramesh&lt;br&gt;



</body></email><email><emailId>20111105015516</emailId><senderName>sean darcy</senderName><senderEmail>seandarcy2@gmail.com</senderEmail><timestampReceived>2011-11-05 01:55:16-0400</timestampReceived><subject>[libvirt-users] virt-manager: create lxc app container hangs</subject><body>

libvirt-0.9.6-2.fc15.x86_64
virt-manager-0.9.0-7.fc15.noarch

I'm trying to use virt-manager create a simple lxc app container just to 
see how it works. App is /bin/sh, 128 megs, 1 cpu.

All seems to go well, but when I click "Finish" and the "Creating 
Virtual Machine" box comes up, "Creating Domain..." stays at 0B though 
the slider keeps going back and forth.

Nothing in /var/log/libvirt/libvirtd.log

No relevant log in /var/log/libvirt/qemu/

Any help appreciated.

sean

</body></email><email><emailId>20111105141113</emailId><senderName>sean darcy</senderName><senderEmail>seandarcy2@gmail.com</senderEmail><timestampReceived>2011-11-05 14:11:13-0400</timestampReceived><subject>Re: [libvirt-users] virt-manager: create lxc app container hangs</subject><body>

On 11/04/2011 09:55 PM, sean darcy wrote:
&gt; libvirt-0.9.6-2.fc15.x86_64
&gt; virt-manager-0.9.0-7.fc15.noarch
&gt;
&gt; I'm trying to use virt-manager create a simple lxc app container just to
&gt; see how it works. App is /bin/sh, 128 megs, 1 cpu.
&gt;
&gt; All seems to go well, but when I click "Finish" and the "Creating
&gt; Virtual Machine" box comes up, "Creating Domain..." stays at 0B though
&gt; the slider keeps going back and forth.
&gt;
&gt; Nothing in /var/log/libvirt/libvirtd.log
&gt;
&gt; No relevant log in /var/log/libvirt/qemu/
&gt;
&gt; Any help appreciated.
&gt;
&gt; sean

I did find a log entry:

cat /var/log/libvirt/lxc/bash.log
2011-11-04 21:27:10.539: starting up
PATH=/sbin:/usr/sbin:/bin:/usr/bin LIBVIRT_DEBUG=3 
LIBVIRT_LOG_OUTPUTS=3:stderr /usr/libexec/libvirt_lxc --name bash 
--console 27 --handshake 30 --background --veth veth1

FWIW, I let the dialog box run all night! No success.

sean

</body></email><email><emailId>20111001004849</emailId><senderName>Trey Dockendorf</senderName><senderEmail>treydock@gmail.com</senderEmail><timestampReceived>2011-10-01 00:48:49-0400</timestampReceived><subject>[libvirt-users] qemu+ssh fails with "packet received from server too large"</subject><body>

I'm attempting to connect to my KVM host from a remote system, but am unable
to connect using virsh.  I'm able to connect if I disable sasl on the KVM
host...

The KVM host is on CentOS 6 x86_64 with libvirt-0.8.1

Here's the command I'm using,
---------
$ virsh -c qemu+ssh://kvmhost.tld/system
error: packet received from server too large
error: failed to connect to the hypervisor


Here's the uncommented lines in my /etc/libvirt/libvirtd.conf
-----------
listen_tls = 1
listen_tcp = 0
listen_addr = "...." (set to eth0)
key_file = "/var/lib/puppet/ssl/private_keys/kvmhost.tld.pem"
cert_file = "/var/lib/puppet/ssl/certs/kvmhost.tld.pem"
ca_file = "/var/lib/puppet/ssl/certs/ca.pem"
log_level = 1
log_filters="1:remote 1:event"
log_outputs="1:syslog:libvirtd 1:file:/var/log/libvirt/libvirtd.log"


There is no output in /var/log/libvirt/libvirtd.log while trying to connect
remotely through virsh.  The only logs that are generated are
/var/log/secure,
--------------
Sep 30 19:34:53 kvmhost sshd[20074]: Accepted publickey for foreman from
10.1.0.1 port 55269 ssh2
Sep 30 19:34:53 kvmhost sshd[20074]: pam_unix(sshd:session): session opened
for user foreman by (uid=0)
Sep 30 19:34:53 kvmhost sshd[20074]: pam_unix(sshd:session): session closed
for user foreman

I've also opened up the port through iptables,
1    ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0           tcp
dpt:16514


And I don't see anything being blocked by SELinux during these connection
attempts.

Is there possibly a log filter I could enable to shed more light on this?
 Any help is greatly appreciated.

Thanks
- Trey

[Attachment #3 (text/html)]

I'm attempting to connect to my KVM host from a remote system, but am unable to \
connect using virsh.  I'm able to connect if I disable sasl on the KVM \
host...&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The KVM host is on CentOS 6 x86_64 with libvirt-0.8.1&lt;br&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Here's the command I'm using, \
&lt;/div&gt;&lt;div&gt;---------&lt;/div&gt;&lt;div&gt;&lt;div&gt;$ virsh -c \
qemu+ssh://kvmhost.tld/system&lt;/div&gt;&lt;div&gt;error: packet received from server too \
large&lt;/div&gt;&lt;div&gt;error: failed to connect to the hypervisor&lt;/div&gt; \
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Here's the uncommented lines in my \
/etc/libvirt/libvirtd.conf&lt;/div&gt;&lt;div&gt;-----------&lt;/div&gt;&lt;div&gt;&lt;div&gt;listen_tls = \
1&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;listen_tcp = 0&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;listen_addr = \
"...." (set to eth0)&lt;/div&gt; &lt;/div&gt;&lt;div&gt;&lt;div&gt;key_file = \
"/var/lib/puppet/ssl/private_keys/kvmhost.tld.pem"&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;cert_file \
= "/var/lib/puppet/ssl/certs/kvmhost.tld.pem"&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;ca_file \
= "/var/lib/puppet/ssl/certs/ca.pem"&lt;/div&gt; &lt;/div&gt;&lt;div&gt;&lt;div&gt;log_level = \
1&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;log_filters="1:remote \
1:event"&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;log_outputs="1:syslog:libvirtd \
1:file:/var/log/libvirt/libvirtd.log"&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; \
&lt;br&gt;&lt;/div&gt;&lt;div&gt;There is no output in /var/log/libvirt/libvirtd.log while trying to \
connect remotely through virsh.  The only logs that are generated are \
/var/log/secure,&lt;/div&gt;&lt;div&gt;--------------&lt;/div&gt;&lt;div&gt;&lt;div&gt;Sep 30 19:34:53 kvmhost \
sshd[20074]: Accepted publickey for foreman from 10.1.0.1 port 55269 ssh2&lt;/div&gt; \
&lt;div&gt;Sep 30 19:34:53 kvmhost sshd[20074]: pam_unix(sshd:session): session opened for \
user foreman by (uid=0)&lt;/div&gt;&lt;div&gt;Sep 30 19:34:53 kvmhost sshd[20074]: \
pam_unix(sshd:session): session closed for user foreman&lt;/div&gt;&lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I've also opened up the port through iptables, \
&lt;/div&gt;&lt;div&gt;&lt;div&gt;1    ACCEPT     tcp  --  &lt;a href="http://0.0.0.0/0"&gt;0.0.0.0/0&lt;/a&gt;     \
&lt;a href="http://0.0.0.0/0"&gt;0.0.0.0/0&lt;/a&gt;           tcp dpt:16514 &lt;/div&gt; \
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;And I don't see anything being blocked \
by SELinux during these connection attempts.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is there \
possibly a log filter I could enable to shed more light on this?  Any help is greatly \
appreciated.&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&lt;/div&gt;&lt;div&gt;- Trey&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20111003054001</emailId><senderName>Magicloud Magiclouds</senderName><senderEmail>magicloud.magiclouds@gmail.com</senderEmail><timestampReceived>2011-10-03 05:40:01-0400</timestampReceived><subject>Re: [libvirt-users] Second VM cannot get dhcp ip in NAT mode</subject><body>

Thanks for the reply. It seemed like the whole virtual network was
down. Not knowing why. I rebooted the host....

On Mon, Oct 3, 2011 at 10:26 AM, Laine Stump &lt;laine@laine.org&gt; wrote:
&gt; On 09/29/2011 11:45 PM, Magicloud Magiclouds wrote:
&gt;&gt;
&gt;&gt; On Fri, Sep 30, 2011 at 10:34 AM, Magicloud Magiclouds
&gt;&gt; &lt;magicloud.magiclouds@gmail.com&gt;  wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; Hi,
&gt;&gt;&gt;  Yesterday I started to use libvirt with kvm under centos6. The first
&gt;&gt;&gt; VM works great.
&gt;&gt;&gt;  Today I added another VM and start to initialize with virt-install.
&gt;&gt;&gt;  Well, it seems that, the second VM cannot get dhcp ip. I did not
&gt;&gt;&gt; change the default libvirt network configuration.
&gt;&gt;&gt;  What should I do?
&gt;&gt;&gt; --
&gt;&gt;&gt; 竹密岂妨流水过
&gt;&gt;&gt; 山高哪阻野云飞
&gt;&gt;&gt;
&gt;&gt; So it is not a dhcp issue.
&gt;&gt; Fixed ip did not work. Stop the first one did not help.
&gt;&gt; Seems like the second VM just cannot use the network.
&gt;
&gt; Do "virsh dumpxml ${guestname} &gt;/tmp/${guestname}.xml" for each of the two
&gt; guests, then compare the &lt;interface&gt; section of the two guests (are both
&gt; guests running the same OS?).
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users



-- 
竹密岂妨流水过
山高哪阻野云飞

</body></email><email><emailId>20111004075849</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-10-04 07:58:49-0400</timestampReceived><subject>Re: [libvirt-users] Usage serial device</subject><body>

On Mon, Oct 03, 2011 at 03:53:50PM -0400, David Goulet wrote:
&gt; -----BEGIN PGP SIGNED MESSAGE-----
&gt; Hash: SHA1
&gt; 
&gt; Hi,
&gt; 
&gt; I'm trying to connect the *same* serial device to two KVM Linux machines where
&gt; one is running KGDB and the other uses the connected serial to interact with the
&gt; target machine running under KGDB.
&gt; 
&gt; However, I'm unable to do so. Using a pty port, I am able to use my kgdb setup
&gt; with host/VM but unable to make it work with VM/VM since it's two different pty
&gt; created on the two machines.
&gt; 
&gt; Anyone on this list can help me with that kind of setup ?

You don't really want to use PTYs to connect 2 VMs together.
Instead try using one of the TCP or UDP connection methods

  http://libvirt.org/formatdomain.html#elementsCharTCP

eg, configure one VM with

    &lt;serial type="tcp"&gt;
      &lt;source mode="bind" host="127.0.0.1" service="2445"/&gt;
      &lt;protocol type="raw"/&gt;
    &lt;/serial&gt;

and the other with

    &lt;serial type="tcp"&gt;
      &lt;source mode="connect" host="127.0.0.1" service="2445"/&gt;
      &lt;protocol type="raw"/&gt;
    &lt;/serial&gt;


Regards,
Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20111004160356</emailId><senderName>Dave Allan</senderName><senderEmail>dallan@redhat.com</senderEmail><timestampReceived>2011-10-04 16:03:56-0400</timestampReceived><subject>Re: [libvirt-users] libvir: Remote error : cannot recv data: : Connection reset by peer</subject><body>

On Tue, Oct 04, 2011 at 08:30:16AM -0700, Sharad Mishra wrote:
&gt; 
&gt; Check the 'max_clients' value in /etc/libvirt/libvirtd.conf. Experiment
&gt; with increasing that value to see if your problem goes away.

The OP filed a BZ about this problem that provided a bit more
information about the code which indicated that it was opening new
connections for every API call and not closing them, resulting in no
available connections.  Increasing max_clients will appear to make the
problem go away, but will only delay the inevitable result of running
out of connections.  The code needs to be fixed to open one connection
and use it for all subsequent API calls.

Dave


&gt; Regards,
&gt; Sharad Mishra
&gt; 
&gt; 
&gt; 
&gt;                                                                        
&gt;              PREETHI RAMESH                                            
&gt;              &lt;iampreethiramesh                                         
&gt;              @gmail.com&gt;                                                To
&gt;              Sent by:                  libvirt-users@redhat.com        
&gt;              libvirt-users-bou                                          cc
&gt;              nces@redhat.com                                           
&gt;                                                                    Subject
&gt;                                        [libvirt-users] libvir: Remote  
&gt;              10/04/11 12:44 AM         error : cannot recv data: :     
&gt;                                        Connection reset by peer        
&gt;                                                                        
&gt;                                                                        
&gt;                                                                        
&gt;                                                                        
&gt;                                                                        
&gt;                                                                        
&gt; 
&gt; 
&gt; 
&gt; 
&gt; I'm using Libvirt's Java API and connecting to the hypervisor using the
&gt; same. My program is such that periodic discovery of active VMs is done
&gt; using Libvirt's functions.
&gt; 
&gt; However, when I try to perform any VM related operations while the Java
&gt; code connecting to Qemu is running such as shutdown, start VM using virsh,
&gt; I end up with :
&gt; 'libvir: Remote error : cannot recv data: : Connection reset by peer' on my
&gt; Java IDE and 'error: cannot recv data: : Connection reset by peer error:
&gt; failed to connect to the hypervisor' on the terminal running virsh.
&gt; 
&gt; I'm using QEMU emulator version 0.14.0 (qemu-kvm-0.14.0) and Libvirt
&gt; version 0.4.7 on Ubuntu 11.04.
&gt; 
&gt; Please help me out! Thanks._______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users





&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20111005210659</emailId><senderName>Darren Dao</senderName><senderEmail>darrendao@gmail.com</senderEmail><timestampReceived>2011-10-05 21:06:59-0400</timestampReceived><subject>[libvirt-users] Need help debugging virtio net issue</subject><body>

This is what I use for creating the VM

sudo virt-install -n myvm -r 2048 --vcpus=1 --accelerate -v -w
bridge:br0,model=virtio  --nographics -m 54:52:00:01:bb:8d  --disk
path=/storage_pool/myvm.raw,size=20,bus=virtio --pxe

It used to work fine, but now it get stuck trying to do pxeboot/kickstart.
Here's what I see when trying to debug the pxeboot/kickstart process:
* Querying DHCP server for IP address went through fine
* vmlinuz.CentOS5-5.5-x86_64 was downloaded successfully
* initrd.img.CentOS5-5.5-x86_64 started to get transferred, but then
stopped. It looks like the VM's network interface just crashed (can't even
ping the VM anymore)

If I don't use virtio for networking, then everything went through fine.

What's strange that is virtio used to work fine.

I ran out of ideas/ways to debug this issue. Any has any idea?

Here's more info on my system:
Host:
   * Scientific Linux 6, kernel version: 2.6.32-71.el6.x86_64
   * libvirt: 0.8.1-27
   * qemu-kvm: 0.12.1.2-2.113
 Guest:
   * Scientific Linux 6, kernel version: 2.6.32-71.el6.x86_64

[Attachment #3 (text/html)]

&lt;div&gt;This is what I use for creating the VM&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;sudo virt-install -n \
myvm -r 2048 --vcpus=1 --accelerate -v -w bridge:br0,model=virtio  --nographics -m \
54:52:00:01:bb:8d  --disk path=/storage_pool/myvm.raw,size=20,bus=virtio --pxe&lt;div&gt; \
&lt;br&gt;&lt;/div&gt;&lt;div&gt;It used to work fine, but now it get stuck trying to do \
pxeboot/kickstart. Here's what I see when trying to debug the pxeboot/kickstart \
process:&lt;/div&gt;&lt;div&gt;* Querying DHCP server for IP address went through fine&lt;/div&gt; \
&lt;div&gt;* vmlinuz.CentOS5-5.5-x86_64 was downloaded successfully&lt;/div&gt;&lt;div&gt;* \
initrd.img.CentOS5-5.5-x86_64 started to get transferred, but then stopped. It looks \
like the VM's network interface just crashed (can't even ping the VM \
anymore)&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If I don't use virtio for networking, then \
everything went through fine.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;What's strange that is \
virtio used to work fine. &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I ran out of ideas/ways to debug \
this issue. Any has any idea?&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Here's more info on my \
system:&lt;/div&gt;&lt;div&gt;Host:&lt;/div&gt;&lt;div&gt;   * Scientific Linux 6, kernel version: \
2.6.32-71.el6.x86_64&lt;/div&gt;&lt;div&gt;   * libvirt: 0.8.1-27&lt;/div&gt;&lt;div&gt;   * qemu-kvm: \
0.12.1.2-2.113&lt;/div&gt; &lt;div&gt; Guest:&lt;/div&gt;&lt;div&gt;   * Scientific Linux 6, kernel version: \
2.6.32-71.el6.x86_64&lt;/div&gt;



</body></email><email><emailId>20111006165841</emailId><senderName>Rogério_Vinhal_Nunes</senderName><senderEmail>rogervn@dcc.ufmg.br</senderEmail><timestampReceived>2011-10-06 16:58:41-0400</timestampReceived><subject>[libvirt-users] virsh list not working with xen 4</subject><body>

Hi, I'm having some trouble to get libvirt to show the correct power state
of my virtual machines. I'm using Ubuntu 10.04 + Xen 4.1.1 + libvirt 0.8.8.

virsh list --all only shows turned off machines registered in xend. If I
turn them on, they just "disappear", and when I start machines directly from
xml, they just doesn't appear at all.

Libvirt is correctly connecting to xen as I can use the other commands fine,
just the list option doesn't seem to work at all. What can I do to change
that?

# virsh version
Compiled against library: libvir 0.8.8
Using library: libvir 0.8.8
Using API: Xen 3.0.1
Running hypervisor: Xen 4.1.0

[Attachment #3 (text/html)]

Hi, I'm having some trouble to get libvirt to show the correct power st=
ate of my virtual machines. I'm using Ubuntu 10.04 + Xen 4.1.1 + libvir=
t 0.8.8.&lt;br&gt;&lt;br&gt;virsh list --all only shows turned off machines registered =
in xend. If I turn them on, they just "disappear", and when I sta=
rt machines directly from xml, they just doesn't appear at all.&lt;br&gt;
&lt;br&gt;Libvirt is correctly connecting to xen as I can use the other commands =
fine, just the list option doesn't seem to work at all. What can I do t=
o change that?&lt;br&gt;&lt;br&gt;# virsh version&lt;br&gt;Compiled against library: libvir 0=
.8.8&lt;br&gt;
Using library: libvir 0.8.8&lt;br&gt;Using API: Xen 3.0.1&lt;br&gt;Running hypervisor: =
Xen 4.1.0&lt;br&gt;&lt;br&gt;


</body></email><email><emailId>20111004075646</emailId><senderName>PREETHI RAMESH</senderName><senderEmail>iampreethiramesh@gmail.com</senderEmail><timestampReceived>2011-10-04 07:56:46-0400</timestampReceived><subject>[libvirt-users] libvir: Remote error : cannot recv data: : Connection reset by peer</subject><body>

I'm using Libvirt's Java API and connecting to the hypervisor using the
same. My program is such that periodic discovery of active VMs is done using
Libvirt's functions.

However, when I try to perform any VM related operations while the Java code
connecting to Qemu is running such as shutdown, start VM using virsh, I end
up with :
'libvir: Remote error : cannot recv data: : Connection reset by peer' on my
Java IDE and 'error: cannot recv data: : Connection reset by peer error:
failed to connect to the hypervisor' on the terminal running virsh.

I'm using QEMU emulator version 0.14.0 (qemu-kvm-0.14.0) and Libvirt version
0.4.7 on Ubuntu 11.04.

Please help me out! Thanks.

[Attachment #3 (text/html)]

I'm using Libvirt's Java API and connecting to the hypervisor using=
 the same. My program is such that periodic discovery of active VMs is done=
 using Libvirt's functions. &lt;br&gt;&lt;br&gt;However, when I try to perform any =
VM related operations while the Java code connecting to Qemu is running suc=
h as shutdown, start VM using virsh, I end up with :&lt;br&gt;
'libvir: Remote error : cannot recv data: : Connection reset by peer=
9; on my Java IDE and 'error: cannot recv data: : Connection reset by p=
eer error: failed to connect to the hypervisor' on the terminal running=
 virsh.&lt;br&gt;
&lt;br&gt;I'm using QEMU emulator version 0.14.0 (qemu-kvm-0.14.0) and Libvir=
t version 0.4.7 on Ubuntu 11.04. &lt;br&gt;&lt;br&gt;Please help me out! Thanks.&lt;br&gt;


</body></email><email><emailId>20111004153016</emailId><senderName>Sharad Mishra</senderName><senderEmail>snmishra@us.ibm.com</senderEmail><timestampReceived>2011-10-04 15:30:16-0400</timestampReceived><subject>Re: [libvirt-users] libvir: Remote error : cannot recv data: :	Connection reset by peer</subject><body>

[Attachment #2 (multipart/alternative)]


Check the 'max_clients' value in /etc/libvirt/libvirtd.conf. Experiment=

with increasing that value to see if your problem goes away.

Regards,
Sharad Mishra



                                                                       =
    
             PREETHI RAMESH                                            =
    
             &lt;iampreethiramesh                                         =
    
             @gmail.com&gt;                                               =
 To 
             Sent by:                  libvirt-users@redhat.com        =
    
             libvirt-users-bou                                         =
 cc 
             nces@redhat.com                                           =
    
                                                                   Subj=
ect 
                                       [libvirt-users] libvir: Remote  =
    
             10/04/11 12:44 AM         error : cannot recv data: :     =
  
                                       Connection reset by peer        =
    
                                                                       =
    
                                                                       =
    
                                                                       =
    
                                                                       =
    
                                                                       =
    
                                                                       =
    




I'm using Libvirt's Java API and connecting to the hypervisor using the=

same. My program is such that periodic discovery of active VMs is done
using Libvirt's functions.

However, when I try to perform any VM related operations while the Java=

code connecting to Qemu is running such as shutdown, start VM using vir=
sh,
I end up with :
'libvir: Remote error : cannot recv data: : Connection reset by peer' o=
n my
Java IDE and 'error: cannot recv data: : Connection reset by peer error=
:
failed to connect to the hypervisor' on the terminal running virsh.

I'm using QEMU emulator version 0.14.0 (qemu-kvm-0.14.0) and Libvirt
version 0.4.7 on Ubuntu 11.04.

Please help me out! Thanks.____________________________________________=
___
libvirt-users mailing list
libvirt-users@redhat.com
https://www.redhat.com/mailman/listinfo/libvirt-users=

[Attachment #5 (text/html)]

&lt;html&gt;&lt;body&gt;
&lt;p&gt;Check the 'max_clients' value in /etc/libvirt/libvirtd.conf. Experiment with \
increasing that value to see if your problem goes away.&lt;br&gt; &lt;br&gt;
Regards,&lt;br&gt;
Sharad Mishra&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;img width="16" height="16" src="cid:1__=08BBF38CDFC77CD68f9e8a93df938@us.ibm.com" \
border="0" alt="Inactive hide details for PREETHI RAMESH ---10/04/2011 12:48:20 \
AM---I'm using Libvirt's Java API and connecting to the hypervi"&gt;&lt;font \
color="#424282"&gt;PREETHI RAMESH ---10/04/2011 12:48:20 AM---I'm using Libvirt's Java \
API and connecting to the hypervisor using the same. My program is such that periodic \
discovery of act&lt;/font&gt;&lt;br&gt; &lt;br&gt;

&lt;table width="100%" border="0" cellspacing="0" cellpadding="0"&gt;
&lt;tr valign="top"&gt;&lt;td \
style="background-image:url(cid:2__=08BBF38CDFC77CD68f9e8a93df938@us.ibm.com); \
background-repeat: no-repeat; " width="40%"&gt; &lt;ul&gt;
&lt;ul&gt;
&lt;ul&gt;
&lt;ul&gt;&lt;b&gt;&lt;font size="2"&gt;PREETHI RAMESH \
&lt;iampreethiramesh@gmail.com&gt;&lt;/font&gt;&lt;/b&gt;&lt;font size="2"&gt; &lt;/font&gt;&lt;br&gt; &lt;font \
size="2"&gt;Sent by: libvirt-users-bounces@redhat.com&lt;/font&gt; &lt;p&gt;&lt;font size="2"&gt;10/04/11 \
12:44 AM&lt;/font&gt;&lt;/ul&gt; &lt;/ul&gt;
&lt;/ul&gt;
&lt;/ul&gt;
&lt;/td&gt;&lt;td width="60%"&gt;
&lt;table width="100%" border="0" cellspacing="0" cellpadding="0"&gt;
&lt;tr valign="top"&gt;&lt;td width="1%"&gt;&lt;img width="58" height="1" \
src="cid:3__=08BBF38CDFC77CD68f9e8a93df938@us.ibm.com" border="0" alt=""&gt;&lt;br&gt; &lt;div \
align="right"&gt;&lt;font size="2"&gt;To&lt;/font&gt;&lt;/div&gt;&lt;/td&gt;&lt;td width="100%"&gt;&lt;img width="1" \
height="1" src="cid:3__=08BBF38CDFC77CD68f9e8a93df938@us.ibm.com" border="0" \
alt=""&gt;&lt;br&gt; &lt;font size="2"&gt;libvirt-users@redhat.com&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;

&lt;tr valign="top"&gt;&lt;td width="1%"&gt;&lt;img width="58" height="1" \
src="cid:3__=08BBF38CDFC77CD68f9e8a93df938@us.ibm.com" border="0" alt=""&gt;&lt;br&gt; &lt;div \
align="right"&gt;&lt;font size="2"&gt;cc&lt;/font&gt;&lt;/div&gt;&lt;/td&gt;&lt;td width="100%"&gt;&lt;img width="1" \
height="1" src="cid:3__=08BBF38CDFC77CD68f9e8a93df938@us.ibm.com" border="0" \
alt=""&gt;&lt;br&gt; &lt;/td&gt;&lt;/tr&gt;

&lt;tr valign="top"&gt;&lt;td width="1%"&gt;&lt;img width="58" height="1" \
src="cid:3__=08BBF38CDFC77CD68f9e8a93df938@us.ibm.com" border="0" alt=""&gt;&lt;br&gt; &lt;div \
align="right"&gt;&lt;font size="2"&gt;Subject&lt;/font&gt;&lt;/div&gt;&lt;/td&gt;&lt;td width="100%"&gt;&lt;img width="1" \
height="1" src="cid:3__=08BBF38CDFC77CD68f9e8a93df938@us.ibm.com" border="0" \
alt=""&gt;&lt;br&gt; &lt;font size="2"&gt;[libvirt-users] libvir: Remote error : cannot recv data: \
:	Connection reset by peer&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt; &lt;/table&gt;

&lt;table border="0" cellspacing="0" cellpadding="0"&gt;
&lt;tr valign="top"&gt;&lt;td width="58"&gt;&lt;img width="1" height="1" \
src="cid:3__=08BBF38CDFC77CD68f9e8a93df938@us.ibm.com" border="0" alt=""&gt;&lt;/td&gt;&lt;td \
width="336"&gt;&lt;img width="1" height="1" \
src="cid:3__=08BBF38CDFC77CD68f9e8a93df938@us.ibm.com" border="0" alt=""&gt;&lt;/td&gt;&lt;/tr&gt; \
&lt;/table&gt; &lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
&lt;br&gt;
&lt;font size="4"&gt;I'm using Libvirt's Java API and connecting to the hypervisor using \
the same. My program is such that periodic discovery of active VMs is done using \
Libvirt's functions. &lt;br&gt; &lt;br&gt;
However, when I try to perform any VM related operations while the Java code \
connecting to Qemu is running such as shutdown, start VM using virsh, I end up with \
:&lt;br&gt; 'libvir: Remote error : cannot recv data: : Connection reset by peer' on my \
Java IDE and 'error: cannot recv data: : Connection reset by peer error: failed to \
connect to the hypervisor' on the terminal running virsh.&lt;br&gt; &lt;br&gt;
I'm using QEMU emulator version 0.14.0 (qemu-kvm-0.14.0) and Libvirt version 0.4.7 on \
Ubuntu 11.04. &lt;br&gt; &lt;br&gt;
Please help me out! Thanks.&lt;/font&gt;&lt;tt&gt;_______________________________________________&lt;br&gt;
 libvirt-users mailing list&lt;br&gt;
libvirt-users@redhat.com&lt;br&gt;
&lt;/tt&gt;&lt;tt&gt;&lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;/tt&gt;&lt;br&gt;
 &lt;/body&gt;&lt;/html&gt;


["graycol.gif" (image/gif)]
["pic15363.gif" (image/gif)]
["ecblank.gif" (image/gif)]

</body></email><email><emailId>20111004084733</emailId><senderName>ankur deshwal</senderName><senderEmail>a.s.deshwal@gmail.com</senderEmail><timestampReceived>2011-10-04 08:47:33-0400</timestampReceived><subject>[libvirt-users] Libvirt for custom VM</subject><body>

Hi,

I need to create an application where I can use a single interface for
different VMs (libvirt becomes an obvious choice then). However I will
need to control a VM running on custom hypervisor other than ones
currently supported by libvirt. Is it possible to add a new interface
to the hypervisor (easily)? Shall I try to use "test-hypervisor"
supported by libvirt ??

I shall be grateful for some initial pointers to read which can help
me for the task.


Thanks and Regards,
Ankur

</body></email><email><emailId>20111006180619</emailId><senderName>Alphonse Hansel Anthony</senderName><senderEmail>alphonse.anthony@gmail.com</senderEmail><timestampReceived>2011-10-06 18:06:19-0400</timestampReceived><subject>[libvirt-users] Reg: shutdown/restart from within the container(system LXC)</subject><body>

Hi,

   Is it possible to shutdown/restart a system LXC from within the
container?

   From what I have observed(Version - 0.8.4):
   * The libvirt_lxc manager process, which listens on the /dev/pts for
console connection loops
      infinitely.

   Let me know If I am missing out something obvious or there exists any
other way to
   shutdown/restart system LXC from within.

   Any pointers in this regard would be useful.

Thanks,
Alphonse

[Attachment #3 (text/html)]

&lt;font color="#666666"&gt;&lt;font size="2"&gt;&lt;font face="verdana,sans-serif"&gt;&lt;br&gt;Hi,&lt;br&gt;&lt;br&gt;  \
Is it possible to shutdown/restart a system LXC from within the container?&lt;br&gt;  &lt;br&gt;  \
From what I have observed(Version - 0.8.4):&lt;br&gt;   * The libvirt_lxc manager process, \
which listens on the /dev/pts for console connection loops&lt;br&gt;


      infinitely.&lt;br&gt;&lt;br&gt;   Let me know If I am missing out something obvious or \
there exists any other way to &lt;br&gt;   shutdown/restart system LXC from within.&lt;br&gt;&lt;br&gt; \
Any pointers in this regard would be useful.&lt;br&gt;&lt;br&gt;


Thanks,&lt;br&gt;Alphonse&lt;br&gt;&lt;/font&gt;&lt;/font&gt;&lt;/font&gt;



</body></email><email><emailId>20111007112800</emailId><senderName>PREETHI RAMESH</senderName><senderEmail>iampreethiramesh@gmail.com</senderEmail><timestampReceived>2011-10-07 11:28:00-0400</timestampReceived><subject>[libvirt-users] Libvirt newbie, need help with doubts</subject><body>

Hi,
These are my doubts:

1. I tried live migration of Ubuntu 11.04 from the one physical machine to
another using the migrate() function. I connected via tcp in the destination
URI and migrated successfully(lesser than 2 seconds). I tried running virsh
list --all on the destination PM and confirmed that the VM had been migrated
successfully.

When I tried checking ps aux | grep vmname where vmname was the name of the
VM migrated, I could see that on the source PM the thread was still active
with the PID though the machine had been migrated successfully.

Shouldn't the vmname not be listed at all on the source PM's side,if it has
been completely migrated?

Isn't 2 seconds too little(considering the memory allotted to the VM was
128MB and I'm using a 100Mbps LAN switch, time taken=size/speed~10 seconds).

Why is virsh list --all showing me that the VM migrated to be shutdown on
the source PM? If it's been completely migrated, shouldn't the entry be
removed completely?

2. Is there any way to set the CPU limit in terms of % of CPU used on a VCPU
using libvirt function? As in, if I want my VM to use just 10% of VCPU 1.

3. I'm developing an application in Java to monitor VM usage(Memory,CPU,
Network etc). Are there any easily integrable graph plotting applications I
could integrate with?

Thanks for your time.

Regards,
Preethi

[Attachment #3 (text/html)]

Hi,&lt;br&gt;These are my doubts:&lt;br&gt;&lt;br&gt;1. I tried live migration of Ubuntu 11.04 from the \
one physical machine to another using the migrate() function. I connected via tcp in \
the destination URI and migrated successfully(lesser than 2 seconds). I tried running \
virsh list --all on the destination PM and confirmed that the VM had been migrated \
successfully.&lt;br&gt; &lt;br&gt;When I tried checking ps aux | grep vmname where vmname was the \
name of the VM migrated, I could see that on the source PM the thread was still \
active with the PID though the machine had been migrated successfully.&lt;br&gt; \
&lt;br&gt;Shouldn't the vmname not be listed at all on the source PM's side,if it \
has been completely migrated? &lt;br&gt;&lt;br&gt;Isn't 2 seconds too little(considering the \
memory allotted to the VM was 128MB and I'm using a 100Mbps LAN switch, time \
taken=size/speed~10 seconds).&lt;br&gt; &lt;br&gt;Why is virsh list --all showing me that the VM \
migrated to be shutdown on the source PM? If it's been completely migrated, \
shouldn't the entry be removed completely?&lt;br&gt;&lt;br&gt;2. Is there any way to set the \
CPU limit in terms of % of CPU used on a VCPU using libvirt function? As in, if I \
want my VM to use just 10% of VCPU 1.&lt;br&gt; &lt;br&gt;3. I'm developing an application in \
Java to monitor VM usage(Memory,CPU, Network etc). Are there any easily integrable \
graph plotting applications I could integrate with?&lt;br&gt;&lt;br&gt;Thanks for your \
time.&lt;br&gt;&lt;br&gt;Regards,&lt;br&gt; Preethi&lt;br&gt;



</body></email><email><emailId>20111005182830</emailId><senderName>Alex</senderName><senderEmail>mysqlstudent@gmail.com</senderEmail><timestampReceived>2011-10-05 18:28:30-0400</timestampReceived><subject>[libvirt-users] Performance tuning questions for mail server</subject><body>

Hi,

I have a fedora15 x86_64 host with one fedora15 guest running
amavis+spamassassin+postfix and performance is horrible. The host is a
quad-core E13240 with 16GB and 3 1TB Seagate ST31000524NS and all
partitions are ext4. I've allocated 4 processors and 8GB of RAM to
this guest. I really hoped someone could help me identify areas in
which performance can be improved at both the guest and host.

Load on the server is regularly above 20, yet the processors generally
are idle and the host is still responsive.

Should the concentration of the performance tuning be done on the
guest or the host? I've read through the information at
http://libvirt.org/formatdomain.html#elementsMemoryTuning but I don't
know how the settings apply to my configuration and which ones apply
to my hardware.

I've included my libvirt xml config below. It was built using
virt-manager on fedora15. There appears to be quite a few other
options that are available and not provided by virt-manager that I
would like to be able to use.

I've done a little kernel tuning on the host, although it doesn't
appear to have made much difference. Are there a set of values for
kernel parameters that would be advisable to make for a mail server?
Here is what I currently have:

# sysctl -p
net.ipv4.ip_forward = 1
net.ipv4.conf.default.rp_filter = 1
net.ipv4.conf.default.accept_source_route = 0
kernel.sysrq = 0
kernel.core_uses_pid = 1
net.bridge.bridge-nf-call-ip6tables = 0
net.bridge.bridge-nf-call-iptables = 0
net.bridge.bridge-nf-call-arptables = 0
net.ipv4.ip_forward = 1
net.ipv4.conf.default.rp_filter = 0
net.ipv4.conf.all.send_redirects = 0
net.ipv4.conf.default.send_redirects = 0
net.ipv4.icmp_ignore_bogus_error_responses = 1
net.ipv4.conf.all.log_martians = 0
net.ipv4.conf.default.log_martians = 0
net.ipv4.conf.default.accept_source_route = 0
net.ipv4.conf.all.accept_redirects = 0
net.ipv4.conf.default.accept_redirects = 0
vm.vfs_cache_pressure = 35
vm.nr_hugepages = 512
net.ipv4.tcp_max_syn_backlog = 2048
fs.aio-max-nr = 1048576
vm.dirty_background_ratio = 3
vm.dirty_ratio = 40

After making changes, do you have any recommendations on which tools
to use to monitor those changes and see how they perform?

I have noatime set in fstab in the guest for the /var partition, where
much of the spamassassin  occurs.

I've included below my libvirt xml config for the guest and hoped
someone could make some recommendations on how to apply the cputune
and memtune parameters to my system.

&lt;domain type='kvm'&gt;
  &lt;name&gt;mail02&lt;/name&gt;
  &lt;uuid&gt;ec4f3cf5-2f27-fb3e-72f6-3fa3176b13b6&lt;/uuid&gt;
  &lt;memory&gt;8388608&lt;/memory&gt;
  &lt;currentMemory&gt;8388608&lt;/currentMemory&gt;
  &lt;vcpu&gt;8&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='x86_64' machine='pc-0.14'&gt;hvm&lt;/type&gt;
    &lt;boot dev='hd'/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
    &lt;apic/&gt;
    &lt;pae/&gt;
  &lt;/features&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;restart&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/bin/qemu-kvm&lt;/emulator&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;driver name='qemu' type='raw'/&gt;
      &lt;source file='/var/lib/libvirt/images/mail02.img'/&gt;
      &lt;target dev='vda' bus='virtio'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x05'
function='0x0'/&gt;
    &lt;/disk&gt;
    &lt;disk type='block' device='cdrom'&gt;
      &lt;driver name='qemu' type='raw'/&gt;
      &lt;target dev='hdc' bus='ide'/&gt;
      &lt;readonly/&gt;
      &lt;address type='drive' controller='0' bus='1' unit='0'/&gt;
    &lt;/disk&gt;
    &lt;controller type='ide' index='0'&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x01'
function='0x1'/&gt;
    &lt;/controller&gt;
    &lt;interface type='bridge'&gt;
      &lt;mac address='52:54:00:67:2c:4c'/&gt;
      &lt;source bridge='br0'/&gt;
      &lt;model type='virtio'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03'
function='0x0'/&gt;
    &lt;/interface&gt;
    &lt;serial type='pty'&gt;
      &lt;target port='0'/&gt;
    &lt;/serial&gt;
    &lt;console type='pty'&gt;
      &lt;target type='serial' port='0'/&gt;
    &lt;/console&gt;
    &lt;input type='mouse' bus='ps2'/&gt;
    &lt;graphics type='vnc' port='-1' autoport='yes'/&gt;
    &lt;video&gt;
      &lt;model type='cirrus' vram='9216' heads='1'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x02'
function='0x0'/&gt;
    &lt;/video&gt;
    &lt;memballoon model='virtio'&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x06'
function='0x0'/&gt;
    &lt;/memballoon&gt;
  &lt;/devices&gt;
&lt;/domain&gt;

Thanks,
Alex

</body></email><email><emailId>20111010102823</emailId><senderName>PREETHI RAMESH</senderName><senderEmail>iampreethiramesh@gmail.com</senderEmail><timestampReceived>2011-10-10 10:28:23-0400</timestampReceived><subject>[libvirt-users] Live Migration using Libvirt migrate()</subject><body>

Hi,
This is a follow up of the mail regd migration I'd posted a few days ago. My
scenario:

I'm creating two virtual machines images from an Ubuntu 10.10 iso of RAM
size 128 and 700 MB.

Using the migrate() , I migrate it from the current physical machine to the
destination machine via a 100 Mbps  switch LAN connection. BOTH migrations
take the same amount of time.

Checking out the eth0's transmitted and received bytes after and before the
migration, I find that there's NO change in the readings. Using any other
method to migrate(virsh,Qemu) takes a substantial amount of time(close to 10
seconds) for the 128 and 700 MB images.

How can this drastic change in migration time be accounted for?

Are there any other ways to check if the VM has been successfully migrated
to the destination(i tried using virsh console after migrate() but for some
reason it just hangs. I tried out the suggested patches on various sites but
to no avail)?

Is pinging the migrated VM from its PM a sure test for successful migration?

Thanks guys.

[Attachment #3 (text/html)]

Hi,&lt;br&gt;This is a follow up of the mail regd migration I'd posted a few =
days ago. My scenario:&lt;br&gt;&lt;br&gt;I'm creating two virtual machines images =
from an Ubuntu 10.10 iso of RAM size 128 and 700 MB.&lt;br&gt;&lt;br&gt;Using the migra=
te() , I migrate it from the current physical machine to the destination ma=
chine via a 100 Mbps=A0 switch LAN connection. BOTH migrations take the sam=
e amount of time.&lt;br&gt;
&lt;br&gt;Checking out the eth0's transmitted and received bytes after and be=
fore the migration, I find that there's NO change in the readings. Usin=
g any other method to migrate(virsh,Qemu) takes a substantial amount of tim=
e(close to 10 seconds) for the 128 and 700 MB images.&lt;br&gt;
&lt;br&gt;How can this drastic change in migration time be accounted for?&lt;br&gt;&lt;br&gt;=
Are there any other ways to check if the VM has been successfully migrated =
to the destination(i tried using virsh console after migrate() but for some=
 reason it just hangs. I tried out the suggested patches on various sites b=
ut to no avail)? &lt;br&gt;
&lt;br&gt;Is pinging the migrated VM from its PM a sure test for successful migra=
tion?&lt;br&gt;&lt;br&gt;Thanks guys.&lt;br&gt;&lt;br&gt;


</body></email><email><emailId>20111005184105</emailId><senderName>Robin Lee Powell</senderName><senderEmail>rlpowell@digitalkingdom.org</senderEmail><timestampReceived>2011-10-05 18:41:05-0400</timestampReceived><subject>Re: [libvirt-users] Performance tuning questions for mail server</subject><body>

On Wed, Oct 05, 2011 at 02:28:30PM -0400, Alex wrote:
&gt; 
&gt; Load on the server is regularly above 20, yet the processors
&gt; generally are idle and the host is still responsive.

That's completely normal for an email server running spamassassin,
in my experience, and has nothing to do with libvirt.  IME, the
issue is DNS lookups, which spamassassin and the RBLs it uses make
*heavy* use of.  Run a caching DNS on localhost with fairly
agressive caching (i.e. go ahead and have it ignore TTLs and keep
everything for at least 5 minutes) and I expect that you'll find
that problem being rapidly resolved.

-Robin

</body></email><email><emailId>20111005200812</emailId><senderName>Alex</senderName><senderEmail>mysqlstudent@gmail.com</senderEmail><timestampReceived>2011-10-05 20:08:12-0400</timestampReceived><subject>Re: [libvirt-users] Performance tuning questions for mail server</subject><body>

Hi,

&gt;&gt; Load on the server is regularly above 20, yet the processors
&gt;&gt; generally are idle and the host is still responsive.
&gt;
&gt; That's completely normal for an email server running spamassassin,
&gt; in my experience, and has nothing to do with libvirt.  IME, the
&gt; issue is DNS lookups, which spamassassin and the RBLs it uses make
&gt; *heavy* use of.  Run a caching DNS on localhost with fairly
&gt; agressive caching (i.e. go ahead and have it ignore TTLs and keep
&gt; everything for at least 5 minutes) and I expect that you'll find
&gt; that problem being rapidly resolved.

Thanks for your help, but as much as I'd like it to be a simple DNS
issue, I really don't think that's the case. I have a caching
nameserver running, and while there sure is a lot of DNS traffic, it's
got to be more than that.

This mail server does manage a lot of mail per day, but not enough to
even consume the 8GB I've allocated, and the "mailq" command typically
takes a few seconds to respond, even when there's only a few messages
in the queue.

iotop may report as much as 2M/s on the host, with an average of about
400-600K/s. Does that seem like a lot? I can write like 80MB/s at
least using dd to test.

My configuration does not use any of the optional CPU or memory
parameters from libvirt, so I'm pretty sure there is something more
that can be done to improve performance, but I just don't know how.

Thanks for any ideas.
Alex

</body></email><email><emailId>20111006160741</emailId><senderName>Emmanuel Noobadmin</senderName><senderEmail>centos.admin@gmail.com</senderEmail><timestampReceived>2011-10-06 16:07:41-0400</timestampReceived><subject>Re: [libvirt-users] Performance tuning questions for mail server</subject><body>

On 10/6/11, Alex &lt;mysqlstudent@gmail.com&gt; wrote:
&gt; This mail server does manage a lot of mail per day, but not enough to
&gt; even consume the 8GB I've allocated, and the "mailq" command typically
&gt; takes a few seconds to respond, even when there's only a few messages
&gt; in the queue.
&gt;
&gt; iotop may report as much as 2M/s on the host, with an average of about
&gt; 400-600K/s. Does that seem like a lot? I can write like 80MB/s at
&gt; least using dd to test.

I had similar problems previously. The crux in my case is the number
of IOPS possible. 100K of 2KB file writes is still 2MB/s but requires
a lot more IO overheads than 1 single 2MB file.

Recommendations that I was given which stopped the system from locking
up included
1. use ionice on the mail process
2. change the IO scheduler/elevator from the default CFQ
3. switch from file-based virtual drives to raw disk devices
4. mount filesystems with noatime

Also, are you using RAID 5?

</body></email><email><emailId>20111006161655</emailId><senderName>Alex</senderName><senderEmail>mysqlstudent@gmail.com</senderEmail><timestampReceived>2011-10-06 16:16:55-0400</timestampReceived><subject>Re: [libvirt-users] Performance tuning questions for mail server</subject><body>

Hi,

&gt;&gt; This mail server does manage a lot of mail per day, but not enough to
&gt;&gt; even consume the 8GB I've allocated, and the "mailq" command typically
&gt;&gt; takes a few seconds to respond, even when there's only a few messages
&gt;&gt; in the queue.
&gt;&gt;
&gt;&gt; iotop may report as much as 2M/s on the host, with an average of about
&gt;&gt; 400-600K/s. Does that seem like a lot? I can write like 80MB/s at
&gt;&gt; least using dd to test.
&gt;
&gt; I had similar problems previously. The crux in my case is the number
&gt; of IOPS possible. 100K of 2KB file writes is still 2MB/s but requires
&gt; a lot more IO overheads than 1 single 2MB file.
&gt;
&gt; Recommendations that I was given which stopped the system from locking
&gt; up included
&gt; 1. use ionice on the mail process
&gt; 2. change the IO scheduler/elevator from the default CFQ
&gt; 3. switch from file-based virtual drives to raw disk devices
&gt; 4. mount filesystems with noatime
&gt;
&gt; Also, are you using RAID 5?

The only thing I haven't done from above is to use ionice on mail
processes. I'm using RAID5 across three 1TB SATA3 disks, I'm using
deadline scheduler, the /var partition is mounted noatime, and the
disk is mounted raw:

    &lt;disk type='file' device='disk'&gt;
      &lt;driver name='qemu' type='raw'/&gt;
      &lt;source file='/var/lib/libvirt/images/mail02.img'/&gt;
      &lt;target dev='vda' bus='virtio'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x05'
function='0x0'/&gt;

How do I configure BIND to ignore TTLs and keep everything for five
minutes, as suggested?

Thanks,
Alex

</body></email><email><emailId>20111010085042</emailId><senderName>xuteng</senderName><senderEmail>xuteng@szjhkx.com</senderEmail><timestampReceived>2011-10-10 08:50:42-0400</timestampReceived><subject>[libvirt-users] BIOS Delay</subject><body>

[Attachment #2 (text/plain)]


Hi,
Does the libvirt support the bios delay ?
I mean that after set a special number of seconds or minutes, when the domain starts, \
the bios will delay after the time I set 

Thanks for your time

wade




xuteng via foxmail


[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;
&lt;HTML&gt;&lt;HEAD&gt;
&lt;META http-equiv=Content-Type content="text/html; charset=us-ascii"&gt;
&lt;STYLE&gt;
BLOCKQUOTE {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; MARGIN-LEFT: 2em
}
OL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
UL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
P {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
BODY {
	FONT-SIZE: 10.5pt; COLOR: #000000; LINE-HEIGHT: 1.5; FONT-FAMILY: 宋体
}
&lt;/STYLE&gt;

&lt;META content="MSHTML 6.00.2900.6129" name=GENERATOR&gt;&lt;/HEAD&gt;
&lt;BODY style="MARGIN: 10px"&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;Hi,&lt;/DIV&gt;
&lt;DIV&gt;Does the libvirt support the bios delay ?&lt;/DIV&gt;
&lt;DIV&gt;I mean that after set a special number of seconds or minutes, when the 
domain starts, the bios will delay after the time I set &lt;/DIV&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;Thanks for your time&lt;/DIV&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;wade&lt;/DIV&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;
&lt;HR style="WIDTH: 210px; HEIGHT: 1px" align=left color=#b5c4df SIZE=1&gt;
&lt;/DIV&gt;
&lt;DIV&gt;&lt;SPAN&gt;xuteng&lt;SPAN 
style="FONT-SIZE: 10.5pt; COLOR: #969696; FONT-STYLE: italic; FONT-FAMILY: Microsoft Sans Serif"&gt; 
via foxmail&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/DIV&gt;&lt;/BODY&gt;&lt;/HTML&gt;


</body></email><email><emailId>20111012173018</emailId><senderName>Trey Dockendorf</senderName><senderEmail>treydock@gmail.com</senderEmail><timestampReceived>2011-10-12 17:30:18-0400</timestampReceived><subject>[libvirt-users] XML file format for snapshot-create</subject><body>

I've created a very basic snapshot XML file, to allow for a description of
the snapshot.  However when running the virsh command, it doesn't like the
formatting.

# virsh snapshot-create proxy_0 /vmstore/proxy_0/proxy_0_ss.xml
error: XML description for failed to parse snapshot xml document is not well
formed or invalid


This are the XML file contents...

# cat proxy_0_ss.xml
&lt;domainsnapshot&gt;
  &lt;name&gt;&lt;/name&gt;
  &lt;description&gt;Before updating to CR repo&lt;/desciption&gt;
&lt;/domainsnapshot&gt;

I'm running libvirt-0.8.7 on CentOS 6 x86_64.  I can take snapshots just
fine without defining the XML file, but I'd like to be able to add a
description.

Thanks
- Trey

[Attachment #3 (text/html)]

I've created a very basic snapshot XML file, to allow for a description=
 of the snapshot. =A0However when running the virsh command, it doesn't=
 like the formatting.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;# virsh snapshot-create proxy_0 /v=
mstore/proxy_0/proxy_0_ss.xml&lt;/div&gt;
&lt;div&gt;&lt;div&gt;error: XML description for failed to parse snapshot xml document =
is not well formed or invalid&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div=
&gt;This are the XML file contents...&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;# cat prox=
y_0_ss.xml=A0&lt;/div&gt;
&lt;div&gt;&lt;domainsnapshot&gt;&lt;/div&gt;&lt;div&gt;=A0 &lt;name&gt;&lt;/name&gt;&lt;/div&gt;&lt;d=
iv&gt;=A0 &lt;description&gt;Before updating to CR repo&lt;/desciption&gt;&lt;/di=
v&gt;&lt;div&gt;&lt;/domainsnapshot&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I'm runni=
ng libvirt-0.8.7 on CentOS 6 x86_64. =A0I can take snapshots just fine with=
out defining the XML file, but I'd like to be able to add a description=
.&lt;/div&gt;
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&lt;/div&gt;&lt;div&gt;- Trey&lt;/div&gt;


</body></email><email><emailId>20111012173509</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-10-12 17:35:09-0400</timestampReceived><subject>Re: [libvirt-users] XML file format for snapshot-create</subject><body>

On 10/12/2011 11:30 AM, Trey Dockendorf wrote:
&gt; I've created a very basic snapshot XML file, to allow for a description of
&gt; the snapshot.  However when running the virsh command, it doesn't like the
&gt; formatting.
&gt;
&gt; # virsh snapshot-create proxy_0 /vmstore/proxy_0/proxy_0_ss.xml
&gt; error: XML description for failed to parse snapshot xml document is not well
&gt; formed or invalid

That's because:

&gt;
&gt;
&gt; This are the XML file contents...
&gt;
&gt; # cat proxy_0_ss.xml
&gt; &lt;domainsnapshot&gt;
&gt;    &lt;name&gt;&lt;/name&gt;

If &lt;name&gt; is present, it must not be empty.

&gt;    &lt;description&gt;Before updating to CR repo&lt;/desciption&gt;
&gt; &lt;/domainsnapshot&gt;

If you want libvirt to generate the name for you, then omit &lt;name&gt;; 
otherwise, provide a non-empty name alongside your description.

&gt;
&gt; I'm running libvirt-0.8.7 on CentOS 6 x86_64.  I can take snapshots just
&gt; fine without defining the XML file, but I'd like to be able to add a
&gt; description.

Newer libvirt also has:

virsh snapshot-create-as --description 'Before updating to CR repo' proxy_0

which creates the XML for you, and thus is a bit easier to use.  Alas, 
that would mean you'd have to upgrade.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20111013022740</emailId><senderName>Trey Dockendorf</senderName><senderEmail>treydock@gmail.com</senderEmail><timestampReceived>2011-10-13 02:27:40-0400</timestampReceived><subject>Re: [libvirt-users] XML file format for snapshot-create</subject><body>

On Wed, Oct 12, 2011 at 12:35 PM, Eric Blake &lt;eblake@redhat.com&gt; wrote:

&gt; On 10/12/2011 11:30 AM, Trey Dockendorf wrote:
&gt;
&gt;&gt; I've created a very basic snapshot XML file, to allow for a description of
&gt;&gt; the snapshot.  However when running the virsh command, it doesn't like the
&gt;&gt; formatting.
&gt;&gt;
&gt;&gt; # virsh snapshot-create proxy_0 /vmstore/proxy_0/proxy_0_ss.**xml
&gt;&gt; error: XML description for failed to parse snapshot xml document is not
&gt;&gt; well
&gt;&gt; formed or invalid
&gt;&gt;
&gt;
&gt; That's because:
&gt;
&gt;
&gt;
&gt;&gt;
&gt;&gt; This are the XML file contents...
&gt;&gt;
&gt;&gt; # cat proxy_0_ss.xml
&gt;&gt; &lt;domainsnapshot&gt;
&gt;&gt;   &lt;name&gt;&lt;/name&gt;
&gt;&gt;
&gt;
&gt; If &lt;name&gt; is present, it must not be empty.
&gt;
&gt;
&gt;    &lt;description&gt;Before updating to CR repo&lt;/desciption&gt;
&gt;&gt; &lt;/domainsnapshot&gt;
&gt;&gt;
&gt;
&gt; If you want libvirt to generate the name for you, then omit &lt;name&gt;;
&gt; otherwise, provide a non-empty name alongside your description.
&gt;
&gt;
&gt;
&gt;&gt; I'm running libvirt-0.8.7 on CentOS 6 x86_64.  I can take snapshots just
&gt;&gt; fine without defining the XML file, but I'd like to be able to add a
&gt;&gt; description.
&gt;&gt;
&gt;
&gt; Newer libvirt also has:
&gt;
&gt; virsh snapshot-create-as --description 'Before updating to CR repo' proxy_0
&gt;
&gt; which creates the XML for you, and thus is a bit easier to use.  Alas, that
&gt; would mean you'd have to upgrade.
&gt;
&gt; --
&gt; Eric Blake   eblake@redhat.com    +1-801-349-2682
&gt; Libvirt virtualization library http://libvirt.org
&gt;

Thanks for the response.  Unfortunately I still receive the exact same error
with only this as the contents...

&lt;domainsnapshot&gt;
  &lt;description&gt;Before updating to CR repo&lt;/desciption&gt;
&lt;/domainsnapshot&gt;

I also tried filling in a name, and still the same error.

Thanks
- Trey

[Attachment #3 (text/html)]

&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Wed, Oct 12, 2011 at 12:35 PM, Eric Blake &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:eblake@redhat.com"&gt;eblake@redhat.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt; &lt;div class="im"&gt;On 10/12/2011 11:30 AM, Trey \
Dockendorf wrote:&lt;br&gt; &lt;blockquote class="gmail_quote" style="margin:0 0 0 \
.8ex;border-left:1px #ccc solid;padding-left:1ex"&gt; I've created a very basic \
snapshot XML file, to allow for a description of&lt;br&gt; the snapshot.  However when \
running the virsh command, it doesn't like the&lt;br&gt; formatting.&lt;br&gt;
&lt;br&gt;
# virsh snapshot-create proxy_0 /vmstore/proxy_0/proxy_0_ss.&lt;u&gt;&lt;/u&gt;xml&lt;br&gt;
error: XML description for failed to parse snapshot xml document is not well&lt;br&gt;
formed or invalid&lt;br&gt;
&lt;/blockquote&gt;
&lt;br&gt;&lt;/div&gt;
That's because:&lt;div class="im"&gt;&lt;br&gt;
&lt;br&gt;
&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex"&gt; &lt;br&gt;
&lt;br&gt;
This are the XML file contents...&lt;br&gt;
&lt;br&gt;
# cat proxy_0_ss.xml&lt;br&gt;
&lt;domainsnapshot&gt;&lt;br&gt;
   &lt;name&gt;&lt;/name&gt;&lt;br&gt;
&lt;/blockquote&gt;
&lt;br&gt;&lt;/div&gt;
If &lt;name&gt; is present, it must not be empty.&lt;div class="im"&gt;&lt;br&gt;
&lt;br&gt;
&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex"&gt;  &lt;description&gt;Before updating to CR \
repo&lt;/desciption&gt;&lt;br&gt; &lt;/domainsnapshot&gt;&lt;br&gt;
&lt;/blockquote&gt;
&lt;br&gt;&lt;/div&gt;
If you want libvirt to generate the name for you, then omit &lt;name&gt;; otherwise, \
provide a non-empty name alongside your description.&lt;div class="im"&gt;&lt;br&gt; &lt;br&gt;
&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex"&gt; &lt;br&gt;
I'm running libvirt-0.8.7 on CentOS 6 x86_64.  I can take snapshots just&lt;br&gt;
fine without defining the XML file, but I'd like to be able to add a&lt;br&gt;
description.&lt;br&gt;
&lt;/blockquote&gt;
&lt;br&gt;&lt;/div&gt;
Newer libvirt also has:&lt;br&gt;
&lt;br&gt;
virsh snapshot-create-as --description 'Before updating to CR repo' \
proxy_0&lt;br&gt; &lt;br&gt;
which creates the XML for you, and thus is a bit easier to use.  Alas, that would \
mean you'd have to upgrade.&lt;br&gt;&lt;font color="#888888"&gt; &lt;br&gt;
-- &lt;br&gt;
Eric Blake   &lt;a href="mailto:eblake@redhat.com" target="_blank"&gt;eblake@redhat.com&lt;/a&gt; \
&lt;a href="tel:%2B1-801-349-2682" value="+18013492682" \
target="_blank"&gt;+1-801-349-2682&lt;/a&gt;&lt;br&gt; Libvirt virtualization library &lt;a \
href="http://libvirt.org" target="_blank"&gt;http://libvirt.org&lt;/a&gt;&lt;br&gt; \
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;Thanks for the response.  Unfortunately I still \
receive the exact same error with only this as the \
contents...&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;domainsnapshot&gt;&lt;/div&gt;&lt;div&gt;  \
&lt;description&gt;Before updating to CR repo&lt;/desciption&gt;&lt;/div&gt; \
&lt;div&gt;&lt;/domainsnapshot&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I also tried filling in a \
name, and still the same error.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&lt;/div&gt;&lt;div&gt;- \
Trey&lt;/div&gt;



</body></email><email><emailId>20111013073052</emailId><senderName></senderName><senderEmail>jurgen.depicker</senderEmail><timestampReceived>2011-10-13 07:30:52-0400</timestampReceived><subject>Re: [libvirt-users] XML file format for snapshot-create</subject><body>

This is a multipart message in MIME format.
--=_alternative 00294CEEC1257928_Content-Type: text/plain; charset="ISO-8859-1"
Content-Transfer-Encoding: quoted-printable

&gt; &lt;domainsnapshot&gt;
&gt;   &lt;description&gt;Before updating to CR repo&lt;/desciption&gt;
&gt; &lt;/domainsnapshot&gt;
&gt; 


-&gt; it seems to be something rather silly: your closing tag misses an 'r': 
it should be &lt;/description&gt;

Grts, Jürgen
--=_alternative 00294CEEC1257928_Content-Type: text/html; charset="ISO-8859-1"
Content-Transfer-Encoding: quoted-printable

&lt;tt&gt;&lt;font size=2&gt;&lt;br&gt;
&gt; &lt;domainsnapshot&gt;&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size=2&gt;&gt;   &lt;description&gt;Before updating to
CR repo&lt;/desciption&gt;&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size=2&gt;&gt; &lt;/domainsnapshot&gt;&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size=2&gt;&gt; &lt;br&gt;
&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size=2&gt;-&gt; it seems to be something rather silly: your
closing tag misses an 'r': it should be &lt;/description&gt;&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size=2&gt;Grts, Jürgen&lt;/font&gt;&lt;/tt&gt;
--=_alternative 00294CEEC1257928_=--

</body></email><email><emailId>20111011215542</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-10-11 21:55:42-0400</timestampReceived><subject>Re: [libvirt-users] BIOS Delay</subject><body>

On 10/10/2011 02:50 AM, xuteng wrote:
&gt; 
&gt; Hi,
&gt; Does the libvirt support the bios delay ?
&gt; I mean that after set a special number of seconds or minutes, when the domain \
&gt; starts, the bios will delay after the time I set

Is there a qemu option that affects this?  I'm not aware of one, off the 
top of my head, which means that libvirt does not expose one directly. 
If there _is_ such a qemu option, then you can access it via 
&lt;qemu:commandline&gt; xml while waiting for libvirt to implement official 
xml to support this feature.

Taking a step back, I'm not even sure what you are trying to accomplish 
with a delay.  Perhaps it is sufficient if you use virDomainStartFlags 
with VIR_DOMAIN_START_PAUSED (or virsh start --paused) to request that a 
guest be created without running it, then at your choice of delay, 
resume the guest?  But that's not a BIOS delay.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


</body></email><email><emailId>20111006191033</emailId><senderName>Alex</senderName><senderEmail>mysqlstudent@gmail.com</senderEmail><timestampReceived>2011-10-06 19:10:33-0400</timestampReceived><subject>Re: [libvirt-users] Performance tuning questions for mail server</subject><body>

Hi,

&gt;&gt; iotop may report as much as 2M/s on the host, with an average of about
&gt;&gt; 400-600K/s. Does that seem like a lot? I can write like 80MB/s at
&gt;&gt; least using dd to test.
&gt;
&gt; I had similar problems previously. The crux in my case is the number
&gt; of IOPS possible. 100K of 2KB file writes is still 2MB/s but requires
&gt; a lot more IO overheads than 1 single 2MB file.

Can I also ask how you measured performance and the effect any changes
you made may have had on the system?

iotop seems very general. Perhaps sar? Ideas for graphing its output?

Thanks again,
Alex

</body></email><email><emailId>20111007093422</emailId><senderName>Emmanuel Noobadmin</senderName><senderEmail>centos.admin@gmail.com</senderEmail><timestampReceived>2011-10-07 09:34:22-0400</timestampReceived><subject>Re: [libvirt-users] Performance tuning questions for mail server</subject><body>

On 10/7/11, Alex &lt;mysqlstudent@gmail.com&gt; wrote:
&gt; The only thing I haven't done from above is to use ionice on mail
&gt; processes. I'm using RAID5 across three 1TB SATA3 disks,

RAID 5 is another major bottleneck there. The commonly cited write
penalty for RAID 5 appears to be 4 IOPS, while RAID 1/10 is 2 IOPS.
Due to the typical load on an email server with more writes than read,
this become rather punishing.

So you might see a major improvement simply by adding another 1TB and
going for RAID 10.

Personally because of that, as well as the headache of recovering from
a RAID 5 disaster, I've stopped using RAID 5 especially since the cost
of drives are really cheap.

&gt; I'm using
&gt; deadline scheduler, the /var partition is mounted noatime, and the
&gt; disk is mounted raw:
&gt;
&gt;     &lt;disk type='file' device='disk'&gt;
&gt;       &lt;driver name='qemu' type='raw'/&gt;
&gt;       &lt;source file='/var/lib/libvirt/images/mail02.img'/&gt;
&gt;       &lt;target dev='vda' bus='virtio'/&gt;
&gt;       &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x05'
&gt; function='0x0'/&gt;

I meant raw disk devices rather than files e.g.
&lt;disk type='block' device='disk'&gt;
      &lt;driver name='qemu' type='raw' cache='none'/&gt;
      &lt;source dev='/dev/server02_vg1_2tb/lv_vm03_swap'/&gt;
      &lt;target dev='vdb' bus='virtio'/&gt;
&lt;/disk&gt;

This eliminates one layer of filesystem overheads.

&gt; How do I configure BIND to ignore TTLs and keep everything for five
&gt; minutes, as suggested?

I'm not too sure about this sorry.

</body></email><email><emailId>20111007094143</emailId><senderName>Emmanuel Noobadmin</senderName><senderEmail>centos.admin@gmail.com</senderEmail><timestampReceived>2011-10-07 09:41:43-0400</timestampReceived><subject>Re: [libvirt-users] Performance tuning questions for mail server</subject><body>

On 10/7/11, Alex &lt;mysqlstudent@gmail.com&gt; wrote:
&gt; Can I also ask how you measured performance and the effect any changes
&gt; you made may have had on the system?
&gt;
&gt; iotop seems very general. Perhaps sar? Ideas for graphing its output?

Well for that situation, people were screaming at me so I didn't
really measured things empirically. It was just throwing one possible
fix after another, while watching the system load iowait % go down
until things were smooth again.

Another key thing is having sufficient memory for the VM but I don't
think that's your problem since you have 8GB on it. Then again, it
would really depend on how much mails you are handling.

But if you have time for measurement, as well as can afford the
time/impact, you can try iozone which produces detailed stats and
includes graphing functionality IIRC.

The other tool I use is iostat.

Although I'm also thinking of writing a script that more closely mimic
the kind of loads on my typical server i.e. many small email files
written + some reads and random updates to a single large file (e.g.
log file, user db).

</body></email><email><emailId>20111009192652</emailId><senderName>Alex</senderName><senderEmail>mysqlstudent@gmail.com</senderEmail><timestampReceived>2011-10-09 19:26:52-0400</timestampReceived><subject>Re: [libvirt-users] Performance tuning questions for mail server</subject><body>

Hi,

&gt;&gt; The only thing I haven't done from above is to use ionice on mail
&gt;&gt; processes. I'm using RAID5 across three 1TB SATA3 disks,
&gt;
&gt; RAID 5 is another major bottleneck there. The commonly cited write
&gt; penalty for RAID 5 appears to be 4 IOPS, while RAID 1/10 is 2 IOPS.
&gt; Due to the typical load on an email server with more writes than read,
&gt; this become rather punishing.
&gt;
&gt; So you might see a major improvement simply by adding another 1TB and
&gt; going for RAID 10.

I thought RAID10 still involved RAID1 on all disks, so really the only
improvement would be the lack of the parity write, correct? The
wikipedia entry seems to indicate it's not all that much faster:

http://en.wikipedia.org/wiki/Non-standard_RAID_levels#Linux_MD_RAID_10

Am I just expecting more from kvm/qemu than is realistic at this
point? Are there no high-volume mail servers that use libvirt?

&gt;&gt;     &lt;disk type='file' device='disk'&gt;
&gt;&gt;       &lt;driver name='qemu' type='raw'/&gt;
&gt;&gt;       &lt;source file='/var/lib/libvirt/images/mail02.img'/&gt;
&gt;&gt;       &lt;target dev='vda' bus='virtio'/&gt;
&gt;&gt;       &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x05'
&gt;&gt; function='0x0'/&gt;
&gt;
&gt; I meant raw disk devices rather than files e.g.
&gt; &lt;disk type='block' device='disk'&gt;
&gt;      &lt;driver name='qemu' type='raw' cache='none'/&gt;
&gt;      &lt;source dev='/dev/server02_vg1_2tb/lv_vm03_swap'/&gt;
&gt;      &lt;target dev='vdb' bus='virtio'/&gt;
&gt; &lt;/disk&gt;
&gt;
&gt; This eliminates one layer of filesystem overheads.

Can this type change be done without modifying the image, or must some
conversion be done prior to making this change?

I also found this cool doc on monitoring and improving performance:

http://www.ufsdump.org/papers/io-tuning.pdf

Thanks again,
Alex

</body></email><email><emailId>20111010022039</emailId><senderName>Robin Lee Powell</senderName><senderEmail>rlpowell@digitalkingdom.org</senderEmail><timestampReceived>2011-10-10 02:20:39-0400</timestampReceived><subject>Re: [libvirt-users] Performance tuning questions for mail server</subject><body>

On Sun, Oct 09, 2011 at 03:26:52PM -0400, Alex wrote:
&gt; 
&gt; &gt;&gt;     &lt;disk type='file' device='disk'&gt;
&gt; &gt;&gt;       &lt;driver name='qemu' type='raw'/&gt;
&gt; &gt;&gt;       &lt;source file='/var/lib/libvirt/images/mail02.img'/&gt;
&gt; &gt;&gt;       &lt;target dev='vda' bus='virtio'/&gt;
&gt; &gt;&gt;       &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x05'
&gt; &gt;&gt; function='0x0'/&gt;
&gt; &gt;
&gt; &gt; I meant raw disk devices rather than files e.g.
&gt; &gt; &lt;disk type='block' device='disk'&gt;
&gt; &gt;      &lt;driver name='qemu' type='raw' cache='none'/&gt;
&gt; &gt;      &lt;source dev='/dev/server02_vg1_2tb/lv_vm03_swap'/&gt;
&gt; &gt;      &lt;target dev='vdb' bus='virtio'/&gt;
&gt; &gt; &lt;/disk&gt;
&gt; &gt;
&gt; &gt; This eliminates one layer of filesystem overheads.
&gt; 
&gt; Can this type change be done without modifying the image, or must
&gt; some conversion be done prior to making this change?

You can do that at any time; it just requires a reboot.  You really
want caching off; see
http://publib.boulder.ibm.com/infocenter/lnxinfo/v3r0m0/index.jsp?topic=%2Fliaat%2Fliaattunkickoff.htm

-Robin

</body></email><email><emailId>20111010070719</emailId><senderName>Emmanuel Noobadmin</senderName><senderEmail>centos.admin@gmail.com</senderEmail><timestampReceived>2011-10-10 07:07:19-0400</timestampReceived><subject>Re: [libvirt-users] Performance tuning questions for mail server</subject><body>

On 10/10/11, Alex &lt;mysqlstudent@gmail.com&gt; wrote:
&gt; I thought RAID10 still involved RAID1 on all disks, so really the only
&gt; improvement would be the lack of the parity write, correct? The
&gt; wikipedia entry seems to indicate it's not all that much faster:

Parity write and parity calculations. For a RAID 1 or RAID 10 setup,
you just write the same data to 2 disks. But for RAID 5, you need to
read, verify parity, calculate new parity, then write.
In terms of raw sequential bandwidth, the two don't differ that much
but it's the random IOPS that's the problem.

You can check out this post, it's meant for an Exchange 2007 server
but the calculations there clearly demonstrate the difference between
RAID 1/10 and RAID 5, it also assumes a 50/50 mix.

http://www.mmcug.org/blogs/Lists/Posts/Post.aspx?ID=16

There are also plenty of other tests and articles done to compare RAID
10 and RAID 5.

</body></email><email><emailId>20111010215228</emailId><senderName>Alex</senderName><senderEmail>mysqlstudent@gmail.com</senderEmail><timestampReceived>2011-10-10 21:52:28-0400</timestampReceived><subject>Re: [libvirt-users] Performance tuning questions for mail server</subject><body>

Hi,

&gt;&gt; I'm using
&gt;&gt; deadline scheduler, the /var partition is mounted noatime, and the
&gt;&gt; disk is mounted raw:
&gt;&gt;
&gt;&gt;     &lt;disk type='file' device='disk'&gt;
&gt;&gt;       &lt;driver name='qemu' type='raw'/&gt;
&gt;&gt;       &lt;source file='/var/lib/libvirt/images/mail02.img'/&gt;
&gt;&gt;       &lt;target dev='vda' bus='virtio'/&gt;
&gt;&gt;       &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x05'
&gt;&gt; function='0x0'/&gt;
&gt;
&gt; I meant raw disk devices rather than files e.g.
&gt; &lt;disk type='block' device='disk'&gt;
&gt;      &lt;driver name='qemu' type='raw' cache='none'/&gt;
&gt;      &lt;source dev='/dev/server02_vg1_2tb/lv_vm03_swap'/&gt;
&gt;      &lt;target dev='vdb' bus='virtio'/&gt;
&gt; &lt;/disk&gt;

I made this change by editing the xml, restarting libvirtd, then using
virsh to define the xml file and received this message:

virsh # define /etc/libvirt/qemu/bwimail02.xml
error: Failed to define domain from /etc/libvirt/qemu/bwimail02.xml
error: missing source information for device vda

Have I done something wrong, or am I missing something?

Thanks for the other notes. I'm still trying to digest it all, but
continuing to make progress.

Thanks,
Alex

</body></email><email><emailId>20111010220948</emailId><senderName>Robin Lee Powell</senderName><senderEmail>rlpowell@digitalkingdom.org</senderEmail><timestampReceived>2011-10-10 22:09:48-0400</timestampReceived><subject>Re: [libvirt-users] Performance tuning questions for mail server</subject><body>

On Mon, Oct 10, 2011 at 05:52:28PM -0400, Alex wrote:
&gt; Hi,
&gt; 
&gt; &gt;&gt; I'm using
&gt; &gt;&gt; deadline scheduler, the /var partition is mounted noatime, and the
&gt; &gt;&gt; disk is mounted raw:
&gt; &gt;&gt;
&gt; &gt;&gt;     &lt;disk type='file' device='disk'&gt;
&gt; &gt;&gt;       &lt;driver name='qemu' type='raw'/&gt;
&gt; &gt;&gt;       &lt;source file='/var/lib/libvirt/images/mail02.img'/&gt;
&gt; &gt;&gt;       &lt;target dev='vda' bus='virtio'/&gt;
&gt; &gt;&gt;       &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x05'
&gt; &gt;&gt; function='0x0'/&gt;
&gt; &gt;
&gt; &gt; I meant raw disk devices rather than files e.g.
&gt; &gt; &lt;disk type='block' device='disk'&gt;
&gt; &gt;      &lt;driver name='qemu' type='raw' cache='none'/&gt;
&gt; &gt;      &lt;source dev='/dev/server02_vg1_2tb/lv_vm03_swap'/&gt;
&gt; &gt;      &lt;target dev='vdb' bus='virtio'/&gt;
&gt; &gt; &lt;/disk&gt;
&gt; 
&gt; I made this change by editing the xml, restarting libvirtd, then using
&gt; virsh to define the xml file and received this message:
&gt; 
&gt; virsh # define /etc/libvirt/qemu/bwimail02.xml
&gt; error: Failed to define domain from /etc/libvirt/qemu/bwimail02.xml
&gt; error: missing source information for device vda
&gt; 
&gt; Have I done something wrong, or am I missing something?

You'll need to show us the xml file.

-Robin

</body></email><email><emailId>20111010221344</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-10-10 22:13:44-0400</timestampReceived><subject>Re: [libvirt-users] Performance tuning questions for mail server</subject><body>

On 10/10/2011 03:52 PM, Alex wrote:
&gt; I made this change by editing the xml, restarting libvirtd, then using
&gt; virsh to define the xml file and received this message:
&gt;
&gt; virsh # define /etc/libvirt/qemu/bwimail02.xml
&gt; error: Failed to define domain from /etc/libvirt/qemu/bwimail02.xml
&gt; error: missing source information for device vda
&gt;
&gt; Have I done something wrong, or am I missing something?

Yes, you goofed by directly editing /etc/libvirt.  By doing that, you 
are going behind libvirt's back - if your edits happen to work, then a 
libvirtd restart will use them, but if you introduce a typo or other 
problem, then it is your fault that libvirt can't get things to work. 
If you had instead gone through the libvirt API (such as by using 'virsh 
edit bwimail02'), then libvirt would do some sanity checking up front 
and refuse to install your changes unless they were safe.

That said, your typo:

 &gt;      &lt;source dev='/dev/server02_vg1_2tb/lv_vm03_swap'/&gt;

is that you used &lt;source dev=/&gt; instead of &lt;source file=/&gt;.  Even if the 
source is a raw block device on the host, you still call it out using 
file= in the xml.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20111011055551</emailId><senderName>Emmanuel Noobadmin</senderName><senderEmail>centos.admin@gmail.com</senderEmail><timestampReceived>2011-10-11 05:55:51-0400</timestampReceived><subject>Re: [libvirt-users] Performance tuning questions for mail server</subject><body>

On 10/11/11, Alex &lt;mysqlstudent@gmail.com&gt; wrote:
&gt; I made this change by editing the xml, restarting libvirtd, then using
&gt; virsh to define the xml file and received this message:
&gt;
&gt; virsh # define /etc/libvirt/qemu/bwimail02.xml
&gt; error: Failed to define domain from /etc/libvirt/qemu/bwimail02.xml
&gt; error: missing source information for device vda
&gt;
&gt; Have I done something wrong, or am I missing something?

Will need to see your current XML to tell. But if you simply copied
and pasted my code, then it's definitely not going to work. For one
thing, you would need to have created a LVM volume named exactly the
same way I did.

If you simply changed the paremeters using your existing .img file as
the source, then it also won't work simply for obvious reasons.

</body></email><email><emailId>20111011062909</emailId><senderName>Alex</senderName><senderEmail>mysqlstudent@gmail.com</senderEmail><timestampReceived>2011-10-11 06:29:09-0400</timestampReceived><subject>Re: [libvirt-users] Performance tuning questions for mail server</subject><body>

Hi,

&gt;&gt; I made this change by editing the xml, restarting libvirtd, then using
&gt;&gt; virsh to define the xml file and received this message:
&gt;&gt;
&gt;&gt; virsh # define /etc/libvirt/qemu/bwimail02.xml
&gt;&gt; error: Failed to define domain from /etc/libvirt/qemu/bwimail02.xml
&gt;&gt; error: missing source information for device vda
&gt;&gt;
&gt;&gt; Have I done something wrong, or am I missing something?
&gt;
&gt; Will need to see your current XML to tell. But if you simply copied
&gt; and pasted my code, then it's definitely not going to work. For one
&gt; thing, you would need to have created a LVM volume named exactly the
&gt; same way I did.
&gt;
&gt; If you simply changed the paremeters using your existing .img file as
&gt; the source, then it also won't work simply for obvious reasons.

Although I'm not very experienced with libvirt, I'd like to think I
have a reasonable grasp of the technology.

Perhaps I'm showing just how new at this I am, but what would be the
proper way using virsh to change the type to file instead of raw?

I've included my xml below, and would really appreciate any guidance
you may be able to offer. This is the pre-modified version.

One of the things I was working on was trying to get the host
processor spec to mirror that of the guest, but the guest had quite a
few deficiencies from the host, including less cache (4096kb vs
8192kb), and quite a few missing flags on the guest. How does that
impact performance?

This guest config was mostly generated by virt-manager on fedora15.

&lt;domain type='kvm'&gt;
  &lt;name&gt;mail02&lt;/name&gt;
  &lt;uuid&gt;ec4f3cf5-2f27-fb3e-72f6-3fa3176b13b6&lt;/uuid&gt;
  &lt;memory&gt;4194304&lt;/memory&gt;
  &lt;currentMemory&gt;4194304&lt;/currentMemory&gt;
  &lt;vcpu&gt;8&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='x86_64' machine='pc-0.14'&gt;hvm&lt;/type&gt;
    &lt;boot dev='hd'/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
    &lt;apic/&gt;
    &lt;pae/&gt;
  &lt;/features&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;restart&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/bin/qemu-kvm&lt;/emulator&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;driver name='qemu' type='raw' cache='none'/&gt;
      &lt;source file='/var/lib/libvirt/images/mail02.img'/&gt;
      &lt;target dev='vda' bus='virtio'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x05'
function='0x0'/&gt;
    &lt;/disk&gt;
    &lt;disk type='block' device='cdrom'&gt;
      &lt;driver name='qemu' type='raw'/&gt;
      &lt;target dev='hdc' bus='ide'/&gt;
      &lt;readonly/&gt;
      &lt;address type='drive' controller='0' bus='1' unit='0'/&gt;
    &lt;/disk&gt;
    &lt;controller type='ide' index='0'&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x01'
function='0x1'/&gt;
    &lt;/controller&gt;
    &lt;interface type='bridge'&gt;
      &lt;mac address='52:54:00:67:2c:4c'/&gt;
      &lt;source bridge='br0'/&gt;
      &lt;model type='virtio'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03'
function='0x0'/&gt;
    &lt;/interface&gt;
    &lt;serial type='pty'&gt;
      &lt;target port='0'/&gt;
    &lt;/serial&gt;
    &lt;console type='pty'&gt;
      &lt;target type='serial' port='0'/&gt;
    &lt;/console&gt;
    &lt;input type='mouse' bus='ps2'/&gt;
    &lt;graphics type='vnc' port='-1' autoport='yes'/&gt;
    &lt;video&gt;
      &lt;model type='cirrus' vram='9216' heads='1'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x02'
function='0x0'/&gt;
    &lt;/video&gt;
    &lt;memballoon model='virtio'&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x06'
function='0x0'/&gt;
    &lt;/memballoon&gt;
  &lt;/devices&gt;
&lt;/domain&gt;

Thanks,
Alex


&gt;

</body></email><email><emailId>20111011080415</emailId><senderName>Nicolas Sebrecht</senderName><senderEmail>nsebrecht@piing.fr</senderEmail><timestampReceived>2011-10-11 08:04:15-0400</timestampReceived><subject>[libvirt-users]  Re: Performance tuning questions for mail server</subject><body>

The 10/10/11, Eric Blake wrote:
&gt; On 10/10/2011 03:52 PM, Alex wrote:
&gt; &gt;I made this change by editing the xml, restarting libvirtd, then using
&gt; &gt;virsh to define the xml file and received this message:

&lt;...&gt;

&gt; &gt;Have I done something wrong, or am I missing something?
&gt; 
&gt; Yes, you goofed by directly editing /etc/libvirt.  By doing that,
&gt; you are going behind libvirt's back - if your edits happen to work,
&gt; then a libvirtd restart will use them, but if you introduce a typo
&gt; or other problem, then it is your fault that libvirt can't get
&gt; things to work. If you had instead gone through the libvirt API
&gt; (such as by using 'virsh edit bwimail02'), then libvirt would do
&gt; some sanity checking up front and refuse to install your changes
&gt; unless they were safe.

Which is comunterintuitive, IMHO. Admins are used to edit configuration
files in /etc because most software are designed this way.

Files not designed to be edited may stand in /var. At least, current
files in /etc could have a header with comments from preventing manual
edition and tips on how to deal to change configuration. ,-p

-- 
Nicolas Sebrecht

</body></email><email><emailId>20111007160857</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-10-07 16:08:57-0400</timestampReceived><subject>Re: [libvirt-users] Libvirt newbie, need help with doubts</subject><body>

On 10/07/2011 05:28 AM, PREETHI RAMESH wrote:
&gt; Hi,
&gt; These are my doubts:

I'll answer what I can, but you'll have to hope that others chime in as 
well.

&gt;
&gt; 1. I tried live migration of Ubuntu 11.04 from the one physical machine to
&gt; another using the migrate() function. I connected via tcp in the destination
&gt; URI and migrated successfully(lesser than 2 seconds). I tried running virsh
&gt; list --all on the destination PM and confirmed that the VM had been migrated
&gt; successfully.
&gt;
&gt; When I tried checking ps aux | grep vmname where vmname was the name of the
&gt; VM migrated, I could see that on the source PM the thread was still active
&gt; with the PID though the machine had been migrated successfully.

That's odd - either the migration was still going on at the time of your 
ps, or something else went wrong.  What version of libvirt are you using 
on source and destination?  Migration should not complete until the qemu 
process on the source has gone away.  Are you sure you were interpreting 
the ps listing correctly?

&gt;
&gt; Shouldn't the vmname not be listed at all on the source PM's side,if it has
&gt; been completely migrated?
&gt;
&gt; Isn't 2 seconds too little(considering the memory allotted to the VM was
&gt; 128MB and I'm using a 100Mbps LAN switch, time taken=size/speed~10 seconds).

Not necessarily.  Migration can go faster than the memory size if the 
source can prove that some of the memory is untouched, and can therefore 
convey that information to the destination without copying entire blocks 
of 0 over the line.  That is, qemu can do some forms of compression to 
speed up migration.

&gt;
&gt; Why is virsh list --all showing me that the VM migrated to be shutdown on
&gt; the source PM? If it's been completely migrated, shouldn't the entry be
&gt; removed completely?

You probably didn't specify 'virsh migrate --persistent 
--undefinesource' - the --persistent flag says to keep the guest 
definition persistent on the definition, and the --undefinesource says 
to remove the guest definition on the source (all on successful 
migration, of course).  Without --persistent, the guest is transient; 
and without --undefinesource, 'virsh list --all' will still list the 
guest configuration on the source (and it is up to you to only run the 
guest on one of the two machines at a given time, although recent 
improvements in sanlock or fcntl lock managers can help prevent 
accidental running of the same guest from two machines).

&gt;
&gt; 2. Is there any way to set the CPU limit in terms of % of CPU used on a VCPU
&gt; using libvirt function? As in, if I want my VM to use just 10% of VCPU 1.

To limit a guests' use of a VCPU, you have to do that within the guest. 
  You probably meant to ask whether you can constrain a guest using 100% 
of its VCPU to only consume 10% of the physical CPU on the host that is 
providing the VCPU to the guest.  And yes, with recent additions to the 
xml regarding cpu tuning, you can do something like that:
http://libvirt.org/formatdomain.html#elementsCPUTuning

&gt;
&gt; 3. I'm developing an application in Java to monitor VM usage(Memory,CPU,
&gt; Network etc). Are there any easily integrable graph plotting applications I
&gt; could integrate with?

Sorry, I can't answer this one.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20111007090656</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-10-07 09:06:56-0400</timestampReceived><subject>Re: [libvirt-users] Reg: shutdown/restart from within the container(system LXC)</subject><body>

On Thu, Oct 06, 2011 at 02:06:19PM -0400, Alphonse Hansel Anthony wrote:
&gt; Hi,
&gt; 
&gt;    Is it possible to shutdown/restart a system LXC from within the
&gt; container?
&gt; 
&gt;    From what I have observed(Version - 0.8.4):
&gt;    * The libvirt_lxc manager process, which listens on the /dev/pts for
&gt; console connection loops
&gt;       infinitely.

This is a flaw in that version of libvirt. If you upgrade to the
current libvirt it'll work much more reliably.


Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20111007012739</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-10-07 01:27:39-0400</timestampReceived><subject>Re: [libvirt-users] Libvirt for custom VM</subject><body>

On 10/04/2011 02:35 AM, ankur deshwal wrote:
&gt; Hi,
&gt;
&gt; I need to create an application where I can use a single interface for
&gt; different VMs (libvirt becomes an obvious choice then). However I will
&gt; need to control a VM running on custom hypervisor other than ones
&gt; currently supported by libvirt. Is it possible to add a new interface
&gt; to the hypervisor (easily)? Shall I try to use "test-hypervisor"
&gt; supported by libvirt ??

Yes, adding a new hypervisor is intended to be relatively easy - provide 
callbacks that implement the semantics for your hypervisor, and it is 
okay to do things incrementally.  See some recent posts for how to do 
this.  HyperV was just added [1], and the Parallels driver had an 
initial proposal [2] (although it still needs a bit more work to be 
ready to integrate).  Before that was libxl (I didn't dig up a URL for 
that one):

[1] https://www.redhat.com/archives/libvir-list/2011-August/msg00169.html
[2] https://www.redhat.com/archives/libvir-list/2011-September/msg00984.html

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20111007135947</emailId><senderName>Alphonse Hansel Anthony</senderName><senderEmail>alphonse.anthony@gmail.com</senderEmail><timestampReceived>2011-10-07 13:59:47-0400</timestampReceived><subject>Re: [libvirt-users] Reg: shutdown/restart from within the container(system LXC)</subject><body>

Hi Daniel,
   I checked the latest version (0.9.6) and observed the following from the
code.

  * So If a shutdown is issued from the within the container and
    only if that init process within the container terminates,
    the function "lxcPidGone()" in lxcController, takes care of exiting from
the while loop.

  Please let me know, if my understanding is correct.

Thanks,
Alphonse

On Fri, Oct 7, 2011 at 5:06 AM, Daniel P. Berrange &lt;berrange@redhat.com&gt;wrote:

&gt; On Thu, Oct 06, 2011 at 02:06:19PM -0400, Alphonse Hansel Anthony wrote:
&gt; &gt; Hi,
&gt; &gt;
&gt; &gt;    Is it possible to shutdown/restart a system LXC from within the
&gt; &gt; container?
&gt; &gt;
&gt; &gt;    From what I have observed(Version - 0.8.4):
&gt; &gt;    * The libvirt_lxc manager process, which listens on the /dev/pts for
&gt; &gt; console connection loops
&gt; &gt;       infinitely.
&gt;
&gt; This is a flaw in that version of libvirt. If you upgrade to the
&gt; current libvirt it'll work much more reliably.
&gt;
&gt;
&gt; Daniel
&gt; --
&gt; |: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/:|
&gt; |: http://libvirt.org              -o-             http://virt-manager.org:|
&gt; |: http://autobuild.org       -o-         http://search.cpan.org/~danberr/:|
&gt; |: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc:|
&gt;

[Attachment #3 (text/html)]

&lt;font color="#666666"&gt;&lt;font size="2"&gt;&lt;font face="verdana,sans-serif"&gt;Hi Daniel,&lt;br&gt;   \
I checked the latest version (0.9.6) and observed the following from the \
code.&lt;br&gt;&lt;br&gt;  * So If a shutdown is issued from the within the container and&lt;br&gt;  \
only if that init process within the container terminates, &lt;br&gt;    the function \
"lxcPidGone()" in lxcController, takes care of exiting from the while \
loop.&lt;br&gt;&lt;br&gt;  Please let me know, if my understanding is correct.&lt;br&gt; \
&lt;br&gt;Thanks,&lt;br&gt;Alphonse&lt;br&gt;&lt;/font&gt;&lt;/font&gt;&lt;/font&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Fri, \
Oct 7, 2011 at 5:06 AM, Daniel P. Berrange &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:berrange@redhat.com"&gt;berrange@redhat.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt; \
&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt;&lt;div class="im"&gt;On Thu, Oct 06, 2011 at 02:06:19PM -0400, \
Alphonse Hansel Anthony wrote:&lt;br&gt; &gt; Hi,&lt;br&gt;
&gt;&lt;br&gt;
&gt;    Is it possible to shutdown/restart a system LXC from within the&lt;br&gt;
&gt; container?&lt;br&gt;
&gt;&lt;br&gt;
&gt;    From what I have observed(Version - 0.8.4):&lt;br&gt;
&gt;    * The libvirt_lxc manager process, which listens on the /dev/pts for&lt;br&gt;
&gt; console connection loops&lt;br&gt;
&gt;       infinitely.&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;This is a flaw in that version of libvirt. If you upgrade to the&lt;br&gt;
current libvirt it'll work much more reliably.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Daniel&lt;br&gt;
&lt;font color="#888888"&gt;--&lt;br&gt;
&gt; &gt; &lt;a href="http://berrange.com" target="_blank"&gt;http://berrange.com&lt;/a&gt;      -o-    \
&gt; &gt; &lt;a href="http://www.flickr.com/photos/dberrange/" \
&gt; &gt; target="_blank"&gt;http://www.flickr.com/photos/dberrange/&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="http://libvirt.org" target="_blank"&gt;http://libvirt.org&lt;/a&gt;              \
&gt; &gt; -o-             &lt;a href="http://virt-manager.org" \
&gt; &gt; target="_blank"&gt;http://virt-manager.org&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="http://autobuild.org" target="_blank"&gt;http://autobuild.org&lt;/a&gt;       -o- \
&gt; &gt; &lt;a href="http://search.cpan.org/%7Edanberr/" \
&gt; &gt; target="_blank"&gt;http://search.cpan.org/~danberr/&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="http://entangle-photo.org" target="_blank"&gt;http://entangle-photo.org&lt;/a&gt; \
&gt; &gt; -o-       &lt;a href="http://live.gnome.org/gtk-vnc" \
&gt; &gt; target="_blank"&gt;http://live.gnome.org/gtk-vnc&lt;/a&gt; :|&lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20111007173658</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-10-07 17:36:58-0400</timestampReceived><subject>Re: [libvirt-users] Libvirt newbie, need help with doubts</subject><body>

Forwarding to the list (this was mistakenly sent to just me)

On 10/07/2011 11:32 AM, Mohammed Naser wrote:
&gt; On 2011-10-07, at 12:13 PM, Eric Blake&lt;eblake@redhat.com&gt;  wrote:
&gt;
&gt;&gt; On 10/07/2011 05:28 AM, PREETHI RAMESH wrote:

&gt;&gt;&gt;
&gt;&gt;&gt; 3. I'm developing an application in Java to monitor VM usage(Memory,CPU,
&gt;&gt;&gt; Network etc). Are there any easily integrable graph plotting applications I
&gt;&gt;&gt; could integrate with?
&gt;&gt;
&gt;&gt; Sorry, I can't answer this one.
&gt;
&gt; There is a plugin that collects resource details of libvirt for
&gt; collectd. I believe that collectd collects data in an RRD database and
&gt; I'm sure you can find an RRD charting library for Java.
&gt;
&gt;&gt;
&gt;&gt; --
&gt;&gt; Eric Blake   eblake@redhat.com    +1-801-349-2682
&gt;&gt; Libvirt virtualization library http://libvirt.org
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; libvirt-users mailing list
&gt;&gt; libvirt-users@redhat.com
&gt;&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;
&gt; Regards,
&gt; Mohammed Naser
&gt;
&gt; Sent from my iPhone

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20111011114455</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-10-11 11:44:55-0400</timestampReceived><subject>Re: [libvirt-users] Performance tuning questions for mail server</subject><body>

On 10/11/2011 02:04 AM, Nicolas Sebrecht wrote:
&gt;&gt; Yes, you goofed by directly editing /etc/libvirt.  By doing that,
&gt;&gt; you are going behind libvirt's back - if your edits happen to work,
&gt;&gt; then a libvirtd restart will use them, but if you introduce a typo
&gt;&gt; or other problem, then it is your fault that libvirt can't get
&gt;&gt; things to work. If you had instead gone through the libvirt API
&gt;&gt; (such as by using 'virsh edit bwimail02'), then libvirt would do
&gt;&gt; some sanity checking up front and refuse to install your changes
&gt;&gt; unless they were safe.
&gt;
&gt; Which is comunterintuitive, IMHO. Admins are used to edit configuration
&gt; files in /etc because most software are designed this way.
&gt;
&gt; Files not designed to be edited may stand in /var. At least, current
&gt; files in /etc could have a header with comments from preventing manual
&gt; edition and tips on how to deal to change configuration. ,-p

Which is exactly why newer libvirt sticks this header on such files 
(here, from /etc/libvirt/qemu/domainname.xml):

&lt;!--
WARNING: THIS IS AN AUTO-GENERATED FILE. CHANGES TO IT ARE LIKELY TO BE
OVERWRITTEN AND LOST. Changes to this xml configuration should be made 
using:
   virsh edit domainname
or other application using the libvirt API.
--&gt;

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20111011220548</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-10-11 22:05:48-0400</timestampReceived><subject>Re: [libvirt-users] Live Migration using Libvirt migrate()</subject><body>

On 10/10/2011 04:28 AM, PREETHI RAMESH wrote:
&gt; Hi,
&gt; This is a follow up of the mail regd migration I'd posted a few days ago. My
&gt; scenario:
&gt;
&gt; I'm creating two virtual machines images from an Ubuntu 10.10 iso of RAM
&gt; size 128 and 700 MB.
&gt;
&gt; Using the migrate()

Which language binding?  Show the actual code snippet you used to do the 
migration (whether by 'virsh migrate ...' or whatever language binding 
you were using).

 &gt; , I migrate it from the current physical machine to the
&gt; destination machine via a 100 Mbps  switch LAN connection. BOTH migrations
&gt; take the same amount of time.
&gt;
&gt; Checking out the eth0's transmitted and received bytes after and before the
&gt; migration, I find that there's NO change in the readings.

As in no packets transmitted, or as in the same amount of packets 
transmitted for both migration memory sizes?

 &gt; Using any other
&gt; method to migrate(virsh,Qemu) takes a substantial amount of time(close to 10
&gt; seconds) for the 128 and 700 MB images.
&gt;
&gt; How can this drastic change in migration time be accounted for?

Most likely, if things are happening super-fast with no change in packet 
counts, then you aren't using the migration API correctly.

&gt;
&gt; Are there any other ways to check if the VM has been successfully migrated
&gt; to the destination(i tried using virsh console after migrate() but for some
&gt; reason it just hangs. I tried out the suggested patches on various sites but
&gt; to no avail)?
&gt;
&gt; Is pinging the migrated VM from its PM a sure test for successful migration?

Pinging is a sure test that the guest is still running, but not a sure 
test of which host is running the guest.

I'm not sure you have quite presented enough details to make your setup 
reproducible by others, which is probably why no one has been able to 
give more specific answers yet.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20111013020742</emailId><senderName>xuteng</senderName><senderEmail>xuteng@szjhkx.com</senderEmail><timestampReceived>2011-10-13 02:07:42-0400</timestampReceived><subject>Re: [libvirt-users] BIOS Delay</subject><body>

[Attachment #2 (text/plain)]

Hi,Eric:
Thank you for your reply.
All I want to do is like this:
I have 2 vms ,vm-01 and vm-02 which set to be autostart both.
further more, I want vm-02 start 10sec later than vm-01.
Compared with VMware ESX which has a function that can delay several times after the \
vm run into bios, Does libvirt also have some fuction like this or should I write a \
shell script to controll the start pace of the vms ?




xuteng via foxmail

Sender: Eric Blake
Date: 2011年10月12日 星期三 上午5:55
To: xuteng
CC: libvirt-users
Subject: Re: [libvirt-users] BIOS Delay
On 10/10/2011 02:50 AM, xuteng wrote:
&gt; 
&gt; Hi,
&gt; Does the libvirt support the bios delay ?
&gt; I mean that after set a special number of seconds or minutes, when the domain \
&gt; starts, the bios will delay after the time I set

Is there a qemu option that affects this?  I'm not aware of one, off the 
top of my head, which means that libvirt does not expose one directly. 
If there _is_ such a qemu option, then you can access it via 
&lt;qemu:commandline&gt; xml while waiting for libvirt to implement official 
xml to support this feature.

Taking a step back, I'm not even sure what you are trying to accomplish 
with a delay.  Perhaps it is sufficient if you use virDomainStartFlags 
with VIR_DOMAIN_START_PAUSED (or virsh start --paused) to request that a 
guest be created without running it, then at your choice of delay, 
resume the guest?  But that's not a BIOS delay.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


[Attachment #3 (text/html)]

﻿&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;
&lt;HTML&gt;&lt;HEAD&gt;
&lt;META http-equiv=Content-Type content="text/html; charset=utf-8"&gt;
&lt;STYLE&gt;
BLOCKQUOTE {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; MARGIN-LEFT: 2em
}
OL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
UL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
P {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
BODY {
	FONT-SIZE: 10.5pt; COLOR: #000080; LINE-HEIGHT: 1.5; FONT-FAMILY: 宋体
}
&lt;/STYLE&gt;

&lt;META content="MSHTML 6.00.2900.6148" name=GENERATOR&gt;&lt;/HEAD&gt;
&lt;BODY style="MARGIN: 10px"&gt;
&lt;DIV&gt;Hi,Eric:&lt;/DIV&gt;
&lt;DIV&gt;Thank you for your reply.&lt;/DIV&gt;
&lt;DIV&gt;All I want to do is like this:&lt;/DIV&gt;
&lt;DIV&gt;I have 2 vms ,vm-01 and vm-02 which set to be autostart both.&lt;/DIV&gt;
&lt;DIV&gt;further more, I want vm-02 start 10sec later than vm-01.&lt;/DIV&gt;
&lt;DIV&gt;Compared with VMware ESX which has a function that can delay several times 
after the vm run into bios,&lt;/DIV&gt;
&lt;DIV&gt;Does libvirt also have some fuction like this or should I write a shell 
script to controll the start pace of the vms ?&lt;/DIV&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;HR style="WIDTH: 210px; HEIGHT: 1px" align=left color=#b5c4df SIZE=1&gt;

&lt;DIV&gt;&lt;SPAN&gt;xuteng&lt;SPAN 
style="FONT-SIZE: 10.5pt; COLOR: #969696; FONT-STYLE: italic; FONT-FAMILY: Microsoft \
Sans Serif"&gt;  via foxmail&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/DIV&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV 
style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: #b5c4df 1pt solid; \
PADDING-LEFT: 0cm; PADDING-BOTTOM: 0cm; BORDER-LEFT: medium none; PADDING-TOP: 3pt; \
BORDER-BOTTOM: medium none"&gt; &lt;DIV 
style="PADDING-RIGHT: 8px; PADDING-LEFT: 8px; FONT-SIZE: 12px; BACKGROUND: #efefef; \
PADDING-BOTTOM: 8px; COLOR: #000000; PADDING-TOP: 8px"&gt; &lt;DIV&gt;&lt;B&gt;Sender:&lt;/B&gt; &lt;A \
href="mailto:eblake@redhat.com"&gt;Eric Blake&lt;/A&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;B&gt;Date:&lt;/B&gt; 2011年10月12日 星期三 上午5:55&lt;/DIV&gt; \
&lt;DIV&gt;&lt;B&gt;To:&lt;/B&gt; &lt;A href="mailto:xuteng@szjhkx.com"&gt;xuteng&lt;/A&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;B&gt;CC:&lt;/B&gt; &lt;A  \
href="mailto:libvirt-users@redhat.com"&gt;libvirt-users&lt;/A&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;B&gt;Subject:&lt;/B&gt; Re: [libvirt-users] BIOS Delay&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt; &lt;DIV&gt;
&lt;DIV&gt;On 10/10/2011 02:50 AM, xuteng wrote:&lt;/DIV&gt;
&lt;DIV&gt;&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt; Hi,&lt;/DIV&gt;
&lt;DIV&gt;&gt; Does the libvirt support the bios delay ?&lt;/DIV&gt;
 &lt;DIV&gt;&gt; I mean that after set a special num \
ber of seconds or minutes, when the domain sta \
rts, the bios will delay after the time I set&lt;/DIV&gt;
 &lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;Is there a qemu option that affects this?  I'm not aware of one, off the &lt;/DIV&gt;
 &lt;DIV&gt;top of my head, which means that libvirt does not expose one directly. &lt;/DIV&gt;
 &lt;DIV&gt;If there _is_ such a qemu option, then you can access it via &lt;/DIV&gt;
 &lt;DIV&gt;&lt;qemu:commandline&gt; xml while waiting for libvirt to implement official &lt;/DIV&gt;
 &lt;DIV&gt;xml to support this feature.&lt;/DIV&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;Taking a step back, I'm not even sure what you are trying to accomplish &lt;/DIV&gt;
 &lt;DIV&gt;with a delay.  Perhaps it is sufficient if you use virDomainStartFlags &lt;/DIV&gt;
 &lt;DIV&gt;with VIR_DOMAIN_START_PAUSED (or virsh start --paused) to request that a &lt;/DIV&gt;
 &lt;DIV&gt;guest be created without running it, then at your choice of delay, &lt;/DIV&gt;
 &lt;DIV&gt;resume the guest?  But that's not a BIOS delay.&lt;/DIV&gt;
 &lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;-- &lt;/DIV&gt;
&lt;DIV&gt;Eric Blake   eblake@redhat.com    +1-801-349-2682&lt;/DIV&gt;
 &lt;DIV&gt;Libvirt virtualization library http://libvirt.org&lt;/DIV&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt; &lt;/DIV&gt;&lt;/DIV&gt;&lt;/BODY&gt;&lt;/HTML&gt;



</body></email><email><emailId>20111013130440</emailId><senderName>Trey Dockendorf</senderName><senderEmail>treydock@gmail.com</senderEmail><timestampReceived>2011-10-13 13:04:40-0400</timestampReceived><subject>Re: [libvirt-users] XML file format for snapshot-create</subject><body>

On Thu, Oct 13, 2011 at 2:30 AM, &lt;jurgen.depicker@let.be&gt; wrote:

&gt;
&gt; &gt; &lt;domainsnapshot&gt;
&gt; &gt;   &lt;description&gt;Before updating to CR repo&lt;/desciption&gt;
&gt; &gt; &lt;/domainsnapshot&gt;
&gt; &gt;
&gt;
&gt;
&gt; -&gt; it seems to be something rather silly: your closing tag misses an 'r':
&gt; it should be &lt;/description&gt;
&gt;
&gt; Grts, J=FCrgen


Yep that is silly.  Thanks for catching that! I'd been staring at it so
long, and even went to the source to see what could trip it up.  Thanks
again, it works!

 - Trey

[Attachment #3 (text/html)]

&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Thu, Oct 13, 2011 at 2:30 AM,  &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:jurgen.depicker@let.be"&gt;jurgen.depicker@let.be&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt; &lt;div class="im"&gt;&lt;tt&gt;&lt;font size="2"&gt;&lt;br&gt;
&gt; &lt;domainsnapshot&gt;&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size="2"&gt;&gt;   &lt;description&gt;Before updating to
CR repo&lt;/desciption&gt;&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size="2"&gt;&gt; &lt;/domainsnapshot&gt;&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size="2"&gt;&gt; &lt;br&gt;
&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;
&lt;br&gt;&lt;/div&gt;&lt;tt&gt;&lt;font size="2"&gt;-&gt; it seems to be something rather silly: your
closing tag misses an 'r': it should be &lt;/description&gt;&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size="2"&gt;Grts, Jürgen&lt;/font&gt;&lt;/tt&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;Yep that \
is silly.  Thanks for catching that! I'd been staring at it so long, and even \
went to the source to see what could trip it up.  Thanks again, it works!&lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; - Trey&lt;/div&gt;



</body></email><email><emailId>20111016182533</emailId><senderName>Chuck LaVerde</senderName><senderEmail>cclaverde@gmail.com</senderEmail><timestampReceived>2011-10-16 18:25:33-0400</timestampReceived><subject>[libvirt-users] virt-install.</subject><body>

Why does virt-install shutdown the guest after the initial install? Is there
a way to have the guest reboot after the initial installation?

Chuck

[Attachment #3 (text/html)]

Why does virt-install shutdown the guest after the initial install? Is there a way to \
have the guest reboot after the initial installation?&lt;br&gt;&lt;br&gt;Chuck&lt;br&gt;



</body></email><email><emailId>20110902144738</emailId><senderName>zahra tavakoli</senderName><senderEmail>za_tavakoli@yahoo.com</senderEmail><timestampReceived>2011-09-02 14:47:38-0400</timestampReceived><subject>[libvirt-users] ssh connection problem</subject><body>

Hello,

I have a problem in remote connection to libvirt deamon.
when I add the ssh connection in virt-manager, this error message appears:

server closed connection: 

Traceback (most recent call last):
  File "/usr/share/virt-manager/virtManager/connection.py", line 1022, in _try_open
    None], flags)
  File "/usr/lib/python2.7/dist-packages/libvirt.py", line 107, in openAuth
    if ret is None:raise libvirtError('virConnectOpenAuth() failed')
libvirtError: server closed connection: 

 Please let me know what the problem is.

Thanks.
[Attachment #3 (text/html)]

&lt;html&gt;&lt;body&gt;&lt;div style="color:#000; background-color:#fff; font-family:arial, \
helvetica, sans-serif;font-size:10pt"&gt;&lt;div&gt;&lt;span&gt;Hello,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;I \
have a problem in remote connection to libvirt deamon.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;when I \
add the ssh connection in virt-manager, this error message \
appears:&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;server closed connection: \
&lt;br&gt;&lt;br&gt;Traceback (most recent call last):&lt;br&gt;  File \
"/usr/share/virt-manager/virtManager/connection.py", line 1022, in \
_try_open&lt;br&gt;    None], flags)&lt;br&gt;  File \
"/usr/lib/python2.7/dist-packages/libvirt.py", line 107, in \
openAuth&lt;br&gt;    if ret is None:raise \
libvirtError('virConnectOpenAuth() failed')&lt;br&gt;libvirtError: server closed \
connection: &lt;/span&gt;&lt;/div&gt;&lt;div&gt; &lt;/div&gt;Please let me know what the problem \
is.&lt;br&gt;&lt;br&gt;Thanks.&lt;br&gt;&lt;font  \
style="BACKGROUND-COLOR:#ffffff;"&gt;        &amp;nbs \
p;                      \
     &lt;br&gt;&lt;/font&gt;&lt;div&gt;&lt;font \
style="BACKGROUND-COLOR:#fdeee0;"&gt;&lt;/font&gt; &lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20110903235636</emailId><senderName>Joseph Harnish</senderName><senderEmail>bigjoe1008@gmail.com</senderEmail><timestampReceived>2011-09-03 23:56:36-0400</timestampReceived><subject>Re: [libvirt-users] Char dev error</subject><body>

Sorry. I meant the ip address it is listening on. You can set it to
127.0.0.1, the hypervisors actual ip or 0.0.0.0 which can be defined
in your XML. If it is the hypervisors ip address it won't be able to
move it.

Sent from my iPhone

On Sep 3, 2011, at 12:02 PM, Jatin Kumar &lt;cs5090243@cse.iitd.ernet.in&gt; wrote:

&gt; testvm1 is using port 5901 on host1 and the same is free on host2.
&gt; So port unavailability is definitely not the problem.
&gt;
&gt; --
&gt; Jatin
&gt;
&gt; On Sat, Sep 3, 2011 at 6:58 PM, Joseph Harnish &lt;bigjoe1008@gmail.com&gt; wrote:
&gt;&gt; I have seen this when the port or the ip of the hypervisor was defined
&gt;&gt; in the XML config so it couldn't bind to that address when it migrated
&gt;&gt; over.
&gt;&gt;
&gt;&gt; --Joe
&gt;&gt;
&gt;&gt; Sent from my iPhone
&gt;&gt;
&gt;&gt; On Sep 3, 2011, at 9:22 AM, Jatin Kumar &lt;cs5090243@cse.iitd.ernet.in&gt; wrote:
&gt;&gt;
&gt;&gt;&gt; Hello,
&gt;&gt;&gt; I have been trying to migrate a guest from one host to another.
&gt;&gt;&gt; But it is showing this error:
&gt;&gt;&gt;
&gt;&gt;&gt; virsh --connect qemu+ssh://root@host1/system migrate --live
&gt;&gt;&gt; --undefinesource testvm3 qemu+ssh://root@host2/system
&gt;&gt;&gt; tcp://host2:48160
&gt;&gt;&gt; error: operation failed: failed to retrieve chardev info in qemu with
&gt;&gt;&gt; 'info chardev'
&gt;&gt;&gt;
&gt;&gt;&gt; I have tried this command from the host1 also but it shows the same error.
&gt;&gt;&gt; Another thing i would like to ask is the that whats the use of
&gt;&gt;&gt; migrateuri in migrate command ?
&gt;&gt;&gt;
&gt;&gt;&gt; --
&gt;&gt;&gt; Jatin Kumar
&gt;&gt;&gt;
&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt; libvirt-users mailing list
&gt;&gt;&gt; libvirt-users@redhat.com
&gt;&gt;&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;&gt;
&gt;&gt;

</body></email><email><emailId>20110905110233</emailId><senderName>Jean Michault</senderName><senderEmail>jean.michault@ch-perigueux.fr</senderEmail><timestampReceived>2011-09-05 11:02:33-0400</timestampReceived><subject>Re: [libvirt-users] RAID1 over IP?</subject><body>

Hello,

I have some hosts with a similar configuration.
I have choosen to build the md arrays on the guests, because on your site we use live \
migration, and i don't know how to handle the mirror while migrating the guest. A \
disadvantage is the difficulty to boot the guest if the mirror is broken.

----- Original Message -----
From: "Emmanuel Noobadmin" &lt;centos.admin@gmail.com&gt;
To: "David Ehle" &lt;ehle@agni.phys.iit.edu&gt;
Cc: libvirt-users@redhat.com
Sent: Mercredi 20 Juillet 2011 07:06:51
Subject: Re: [libvirt-users] RAID1 over IP?

On 7/20/11, David Ehle &lt;ehle@phys.iit.edu&gt; wrote:

&gt; Would you be willing /able to elaborate more on this idea?  I've been
&gt; looking into it a bit more and while your right that it sounds simpler on
&gt; paper, it looks like doing DRBD is packaged for Ubuntu, and there is
&gt; pretty good Cook Book documentation for how to do HA NFS on top of DRBD.
&gt; 
&gt; I'm a real novice on the multipath topic so I'm having trouble comparing
&gt; apples to apples to see what the pros and cons of the two scenarios would
&gt; be.

I'm a novice as well (if my nickname didn't make that obvious yet :D)
It's all on paper since I haven't had the time to push for it
internally nor was the original client eager to put out the budget for
the necessary hardware.

My basic idea was this

Physically
=======
[VM Host]
NIC1 -&gt; Switch 1
NIC2 -&gt; Switch 2

[Storage Node] x 2
NIC1 -&gt; Switch 1
NIC2 -&gt; Switch 2
Export HDD x 4 (RAID 10 or could do with RAID 1)


So for VM1
mp1: multipath NIC1 -&gt; Storage1:HDD1, NIC2-&gt;Storage1:HDD1
mp2: multipath NIC2 -&gt; Storage2:HDD1, NIC2-&gt;Storage2:HDD2
then
md mirror using mp1 and mp2

This way, if one switch fails, multipath should keep the array
working. if one node fails, md mirror should keep it alive.

One question I haven't figured an answer to is whether it would be
better to build the array in the host and simply show the guest a
single drive (less overheads? more flexible? since I could change the
setup on the host as long as the guest definition points to the
correct block device), or do it within the guest itself (faster I/O
since the kernel is aware of more drives?)

_______________________________________________
libvirt-users mailing list
libvirt-users@redhat.com
https://www.redhat.com/mailman/listinfo/libvirt-users


</body></email><email><emailId>20110905153445</emailId><senderName>Vidon Guillaume</senderName><senderEmail>ggvi_fr@yahoo.fr</senderEmail><timestampReceived>2011-09-05 15:34:45-0400</timestampReceived><subject>[libvirt-users] vlan and libvirt</subject><body>

Hi,=0AI have to deploy some Ubuntu machines via pxe/dhcp/tftp/preseed/puppe=
t on a =0Avlan. the switches are configured to add vlan tag to the traffic =
to/from those =0Amachines. To test new configuration, i tried to configure =
a domain alike it was =0Aconnected by a port of a managed switch configured=
 in general mode where untag =0Aid is not 1. Anybody have already done this=
 ? Can i use openvswitch to do this ?=0AThank you=0AGV  =0A
[Attachment #3 (text/html)]

&lt;html&gt;&lt;head&gt;&lt;style type="text/css"&gt;&lt;!-- DIV {margin:0px;} \
--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div style="font-family:times new roman,new \
york,times,serif;font-size:12pt"&gt;&lt;div&gt;Hi,&lt;br&gt;I have to deploy some Ubuntu machines \
via pxe/dhcp/tftp/preseed/puppet on a vlan. the switches are configured to add vlan \
tag to the traffic to/from those machines. To test new configuration, i tried to \
configure a domain alike it was connected by a port of a managed switch configured in \
general mode where untag id is not 1. Anybody have already done this ? Can i use \
openvswitch to do this ?&lt;br&gt;Thank you&lt;br&gt;GV  &lt;br&gt;&lt;/div&gt;



&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20110906200557</emailId><senderName>Rogério_Vinhal_Nunes</senderName><senderEmail>rogeriovnunes@gmail.com</senderEmail><timestampReceived>2011-09-06 20:05:57-0400</timestampReceived><subject>[libvirt-users] Libvirt migration with Xen 4.1.1</subject><body>

Hello,

I am trying to migrate a virtual machine between two xen 4.1.1 hosts using
libvirt, but as I use this command:

virsh migrate --live vm102 xen+ssh://10.0.254.8

The following error happens:

error: POST operation failed: xend_post: error from xen daemon: (xend.err
"can't connect: [Errno -2] Name or service not known")

The live migration works fine using "xm --live migrate vm102 10.0.254.8", so
everything is correctly set up. Am I doing something wrong?

Xen = 4.1.1
Ubuntu = 10.04
virsh version =
Using library: libvir 0.8.8
Using API: Xen 3.0.1
Running hypervisor: Xen 4.1.0

[Attachment #3 (text/html)]

Hello,&lt;br&gt;&lt;br&gt;I am trying to migrate a virtual machine between two xen 4.1.1 hosts \
using libvirt, but as I use this command:&lt;br&gt;&lt;br&gt;virsh migrate --live vm102 \
xen+ssh://&lt;a href="http://10.0.254.8"&gt;10.0.254.8&lt;/a&gt;&lt;br&gt;&lt;br&gt;The following error \
happens:&lt;br&gt; &lt;br&gt;error: POST operation failed: xend_post: error from xen daemon: \
(xend.err "can't connect: [Errno -2] Name or service not \
known")&lt;br&gt;&lt;br&gt;The live migration works fine using "xm --live migrate vm102 \
10.0.254.8", so everything is correctly set up. Am I doing something wrong?&lt;br&gt; \
&lt;br&gt;Xen = 4.1.1&lt;br&gt;Ubuntu = 10.04&lt;br&gt;virsh version = &lt;br&gt;Using library: libvir \
0.8.8&lt;br&gt;Using API: Xen 3.0.1&lt;br&gt;Running hypervisor: Xen 4.1.0&lt;br&gt;



</body></email><email><emailId>20110907134019</emailId><senderName>RaSca</senderName><senderEmail>rasca@miamammausalinux.org</senderEmail><timestampReceived>2011-09-07 13:40:19-0400</timestampReceived><subject>Re: [libvirt-users] How to dedicate a NIC for VM traffic without assigning it an IP</subject><body>

Il giorno Mer 07 Set 2011 15:31:45 CEST, Albert Chin ha scritto:
&gt; I am testing out a new server with RHEL6 running KVM. We have a few
&gt; NICs on the server, one of which we would like to dedicate to network
&gt; traffic to/from the virtual guests. Is it possible to do this without
&gt; assigning an IP address to the NIC? We're currently doing something
&gt; like this with Vmware Server, HP's HPVM for HP-UX/IA, and IBM's
&gt; PowerVM for AIX.

For a similar situation I've used vlan tagging, declaring the interface 
as follows:

auto eth0.111
iface eth0.111 inet static
         address 192.168.0.0
         netmask 255.255.255.0
         vlan_raw_device eth1

And so on for the other networks.

Bye,

-- 
RaSca
Mia Mamma Usa Linux: Niente è impossibile da capire, se lo spieghi bene!
rasca@miamammausalinux.org
http://www.miamammausalinux.org


</body></email><email><emailId>20110907151253</emailId><senderName>Rogério_Vinhal_Nunes</senderName><senderEmail>rogervn@dcc.ufmg.br</senderEmail><timestampReceived>2011-09-07 15:12:53-0400</timestampReceived><subject>[libvirt-users] Libvirt vm migration with xen 4.1.1</subject><body>

Hello,

I am trying to migrate a virtual machine between two xen 4.1.1 hosts using
libvirt, but as I use this command:

virsh migrate --live vm102 xen+ssh://10.0.254.8

The following error happens:

error: POST operation failed: xend_post: error from xen daemon: (xend.err
"can't connect: [Errno -2] Name or service not known")

The live migration works fine using "xm --live migrate vm102 10.0.254.8", so
everything is correctly set up. Am I doing something wrong?

Xen = 4.1.1
Ubuntu = 10.04
virsh version =
Using library: libvir 0.8.8
Using API: Xen 3.0.1
Running hypervisor: Xen 4.1.0

[Attachment #3 (text/html)]

Hello,&lt;br&gt;&lt;br&gt;I am trying to migrate a virtual machine between two xen 4.1.1 hosts \
using libvirt, but as I use this command:&lt;br&gt;&lt;br&gt;virsh migrate --live vm102 \
xen+ssh://&lt;a href="http://10.0.254.8/" target="_blank"&gt;10.0.254.8&lt;/a&gt;&lt;br&gt; &lt;br&gt;The \
following error happens:&lt;br&gt; &lt;br&gt;error: POST operation failed: xend_post: error from \
xen daemon: (xend.err "can't connect: [Errno -2] Name or service not \
known")&lt;br&gt;&lt;br&gt;The  live migration works fine using "xm --live migrate \
vm102 10.0.254.8",  so everything is correctly set up. Am I doing something \
wrong?&lt;br&gt; &lt;br&gt;Xen = 4.1.1&lt;br&gt;Ubuntu = 10.04&lt;br&gt;virsh version = &lt;br&gt;Using library: \
libvir 0.8.8&lt;br&gt;Using API: Xen 3.0.1&lt;br&gt;Running hypervisor: Xen 4.1.0



</body></email><email><emailId>20110907192911</emailId><senderName>Joshua Harlow</senderName><senderEmail>harlowja@yahoo-inc.com</senderEmail><timestampReceived>2011-09-07 19:29:11-0400</timestampReceived><subject>[libvirt-users] Libvirt xen snapshot support?</subject><body>

Hi all,

I was wondering if there was support for xen (not xenserver/xcp) for snapsh=
otting.
I have seen various sites that say it doesn't (using domainsnapshot) but I =
wanted to verify with the source.

Thanks.
Josh

[Attachment #3 (text/html)]

&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Libvirt xen snapshot support?&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;FONT FACE="Calibri, Verdana, Helvetica, Arial"&gt;&lt;SPAN STYLE='font-size:11pt'&gt;Hi \
all,&lt;BR&gt; &lt;BR&gt;
I was wondering if there was support for xen (not xenserver/xcp) for \
snapshotting.&lt;BR&gt; I have seen various sites that say it doesn’t (using \
&lt;I&gt;domainsnapshot&lt;/I&gt;) but I wanted to verify with the source.&lt;BR&gt; &lt;BR&gt;
Thanks.&lt;BR&gt;
Josh&lt;/SPAN&gt;&lt;/FONT&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;



</body></email><email><emailId>20110909120127</emailId><senderName>Mihamina Rakotomandimby</senderName><senderEmail>mihamina@rktmb.org</senderEmail><timestampReceived>2011-09-09 12:01:27-0400</timestampReceived><subject>Re: [libvirt-users] IPs of VMs on KVM</subject><body>

On 09/09/2011 01:59 PM, PREETHI RAMESH wrote:
&gt; How can I find the IPs of the VMs using libvirt function?

First:
The VM can manage it's IP adress itself: may be static or dynamic.
To know the IP adress, I'd sugges to to use the tools you use to use for 
a "real" network.

But, you are lucky on the host you have "iptables".
I suggest you to look at the "LOG" target: http://is.gd/TFy6KQ

The MAC &amp; IP will then be visible in the logs (syslog, or somewhere else)

-- 
RMA.

</body></email><email><emailId>20110909155011</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2011-09-09 15:50:11-0400</timestampReceived><subject>Re: [libvirt-users] Graphical framebuffers confuse, XML format about spice</subject><body>

(please reply to the list rather than personal mail)

On 09/08/2011 11:23 PM, huachao yao wrote:
&gt;
&gt;
&gt; 2011/9/9 Laine Stump &lt;laine@laine.org &lt;mailto:laine@laine.org&gt;&gt;
&gt;
&gt;     On 09/07/2011 11:03 PM, huachao yao wrote:
&gt;
&gt;         Hello, i want to start a guest OS in the server, and use spice
&gt;         to achieve  graphical interaction with the guest OS. But when
&gt;         i config the XML file, i was confuse by spice .
&gt;         The graphic node is :
&gt;         &lt;graphics type='spice' port='5990' &gt;&lt;listen type='address'
&gt;         address='127.0.0.1'/&gt;&lt;/graphics&gt;
&gt;
&gt;         but is has such error as below :
&gt;         libvir: QEMU error : internal error process exited while
&gt;         connecting to monitor: qemu-spice: -spice
&gt;         port=5990,addr=127.0.0.1,disable-ticketing: Invalid parameter
&gt;         'addr'
&gt;         parse error: port=5990,addr=127.0.0.1,disable-ticketing
&gt;
&gt;
&gt;     Apparently your "qemu-spice" binary supports the -spice option,
&gt;     but doesn't support the addr option. That seems very strange. What
&gt;     is the origin of "qemu-spice", and what version does it display?
&gt;
&gt; The qemu-spice version is :
&gt; version 0.13.50 (qemu-kvm-devel), copy-right 2003-2008
&gt; and the host OS is Fedora 13 , x86_64
&gt; I think that "qemu-spice" binary supports the -spice option, but 
&gt; doesn't support the addr option." is a good reason to explain to 
&gt; problem. But how can i get the latest qemu-spice ?
&gt; It is suit fedora 13?

Where did the original "qemu-spice" come from? That's not an official 
Fedora13 package, and in later versions of Fedora, spice support is 
included in the standard qemu-kvm package. It sounds like you either 
built qemu + a spice patch from source, or found a prebuilt package like 
that somewhere.

I've only used the spice support that is integrated into the qemu-kvm 
package of Fedora 14 and RHEL (the qemu-kvm in Fedora 13 is too old to 
have spice support, and Fedora 13 is now officially out of support mode)

I would do one of these things:

1) try getting a source tarball for a more recent qemu-kvm release and 
build/install that on your F13 machine.

2) upgrade to F14 or F15 (if you upgrade to F14, add the virt-preview 
repo to your yum configuration (just copy 
http://repos.fedorapeople.org/repos/jforbes/virt-preview/fedora-virt-preview.repo 
into /etc/yum.repos.d)

3) Decide that you maybe don't *really* need spice support, but that the 
VNC-based guest displays are adequate for your needs - this will work 
with the stock qemu-kvm on F13 and is just fine for most uses.


[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta content="text/html; charset=ISO-8859-1"
      http-equiv="Content-Type"&gt;
  &lt;/head&gt;
  &lt;body bgcolor="#ffffff" text="#000000"&gt;
    (please reply to the list rather than personal mail)&lt;br&gt;
    &lt;br&gt;
    On 09/08/2011 11:23 PM, huachao yao wrote:
    &lt;blockquote
cite="mid:CABK2uVugGw+4M+CNMZYep-oYd=Ur47wgbNJVD9kyT4fE7SqRfA@mail.gmail.com"
      type="cite"&gt;&lt;br&gt;
      &lt;br&gt;
      &lt;div class="gmail_quote"&gt;2011/9/9 Laine Stump &lt;span dir="ltr"&gt;&lt;&lt;a
            moz-do-not-send="true" \
href="mailto:laine@laine.org"&gt;laine@laine.org&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;  &lt;blockquote \
class="gmail_quote" style="margin: 0pt 0pt 0pt  0.8ex; border-left: 1px solid \
rgb(204, 204, 204);  padding-left: 1ex;"&gt;
          &lt;div class="im"&gt;On 09/07/2011 11:03 PM, huachao yao wrote:&lt;br&gt;
            &lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt
              0.8ex; border-left: 1px solid rgb(204, 204, 204);
              padding-left: 1ex;"&gt;
              Hello, i want to start a guest OS in the server, and use
              spice to achieve  graphical interaction with the guest OS.
              But when i config the XML file, i was confuse by spice .&lt;br&gt;
              The graphic node is :&lt;br&gt;
              &lt;graphics type='spice' port='5990' &gt;&lt;listen
              type='address' address='127.0.0.1'/&gt;&lt;/graphics&gt;&lt;br&gt;
              &lt;br&gt;
              but is has such error as below :&lt;br&gt;
              libvir: QEMU error : internal error process exited while
              connecting to monitor: qemu-spice: -spice
              port=5990,addr=127.0.0.1,disable-ticketing: Invalid
              parameter 'addr'&lt;br&gt;
              parse error: port=5990,addr=127.0.0.1,disable-ticketing&lt;br&gt;
            &lt;/blockquote&gt;
            &lt;br&gt;
          &lt;/div&gt;
          Apparently your "qemu-spice" binary supports the -spice
          option, but doesn't support the addr option. That seems very
          strange. What is the origin of "qemu-spice", and what version
          does it display?
          &lt;div class="im"&gt;
            &lt;br&gt;
          &lt;/div&gt;
        &lt;/blockquote&gt;
        &lt;div&gt;&lt;span style="color: rgb(255, 0, 0);"&gt;The qemu-spice version
            is :&lt;/span&gt;&lt;br style="color: rgb(255, 0, 0);"&gt;
          &lt;span style="color: rgb(0, 0, 0);"&gt;version 0.13.50
            (qemu-kvm-devel), copy-right 2003-2008 &lt;/span&gt;&lt;br
            style="color: rgb(255, 0, 0);"&gt;
          &lt;span style="color: rgb(255, 0, 0);"&gt;and the host OS is &lt;span
              style="color: rgb(0, 0, 0);"&gt;Fedora 13 , x86_64&lt;/span&gt;&lt;/span&gt;&lt;br
            style="color: rgb(255, 0, 0);"&gt;
          &lt;span style="color: rgb(255, 0, 0);"&gt;I think that  &lt;span
              style="color: rgb(0, 0, 0);"&gt;"qemu-spice" binary supports
              the -spice option, but doesn't support the addr option."&lt;/span&gt;
            is a good reason to explain to problem. But how can i get
            the latest qemu-spice ?&lt;/span&gt;&lt;br style="color: rgb(255, 0,
            0);"&gt;
          &lt;span style="color: rgb(255, 0, 0);"&gt;It is suit fedora 13?&lt;/span&gt;&lt;br&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
    Where did the original "qemu-spice" come from? That's not an
    official Fedora13 package, and in later versions of Fedora, spice
    support is included in the standard qemu-kvm package. It sounds like
    you either built qemu + a spice patch from source, or found a
    prebuilt package like that somewhere.&lt;br&gt;
    &lt;br&gt;
    I've only used the spice support that is integrated into the
    qemu-kvm package of Fedora 14 and RHEL (the qemu-kvm in Fedora 13 is
    too old to have spice support, and Fedora 13 is now officially out
    of support mode)&lt;br&gt;
    &lt;br&gt;
    I would do one of these things:&lt;br&gt;
    &lt;br&gt;
    1) try getting a source tarball for a more recent qemu-kvm release
    and build/install that on your F13 machine.&lt;br&gt;
    &lt;br&gt;
    2) upgrade to F14 or F15 (if you upgrade to F14, add the
    virt-preview repo to your yum configuration (just copy
    &lt;a class="moz-txt-link-freetext" \
href="http://repos.fedorapeople.org/repos/jforbes/virt-preview/fedora-virt-preview.rep \
o"&gt;http://repos.fedorapeople.org/repos/jforbes/virt-preview/fedora-virt-preview.repo&lt;/a&gt;
  into /etc/yum.repos.d)&lt;br&gt;
    &lt;br&gt;
    3) Decide that you maybe don't *really* need spice support, but that
    the VNC-based guest displays are adequate for your needs - this will
    work with the stock qemu-kvm on F13 and is just fine for most uses.&lt;br&gt;
    &lt;br&gt;
  &lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20110909162838</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2011-09-09 16:28:38-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt] how did libvirt manage Virtual Network?</subject><body>

(This seems more appropriate for the libvirt-users mailing list)

On 09/08/2011 10:16 PM, Wayne Xia wrote:
&gt;     Working at the network management, I am a bit confused about the
&gt; VLAN model in libvirt.
&gt;
&gt;     in the xml definition, there is a section as following:
&gt;
&gt; &lt;devices&gt;
&gt; &lt;interface type='network'&gt;
&gt; &lt;source network='default'/&gt;
&gt; &lt;/interface&gt;
&gt;     ...
&gt; &lt;interface type='network'&gt;
&gt; &lt;source network='default' portgroup='engineering'/&gt;
&gt; &lt;target dev='vnet7'/&gt;
&gt; &lt;mac address="00:11:22:33:44:55"/&gt;
&gt; &lt;virtualport type='802.1Qbg'&gt;
&gt; &lt;parameters managerid='11' typeid='1193047' typeidversion='2'
&gt; instanceid='09b11c53-8b5c-4eeb-8f00-d84eaa0aaa4f'/&gt;
&gt; &lt;/virtualport&gt;
&gt;
&gt; &lt;/interface&gt;
&gt; &lt;/devices&gt;
&gt;
&gt;
&gt;     What is the really meaning of its related parameters of
&gt; "virtualport"? I want to discover informations such as VLAN id,
&gt; the switch type( software switch or hardware switch), connecting
&gt; relationship, but from the xml I can only found "managerid". I am not 
&gt; sure how to map these xml information to those I needed, could I 
&gt; consider managerid as VLAN id, and a portgroup as a specified VLAN group?
&gt;     By the way to use virtualport, what components should I install on
&gt; Linux?

&lt;virtualport&gt; is used only when configuring guests that connect directly 
to a VEPA or VNLINK (i.e. 802.1Q) capable switch. Unless you have one of 
these switches, you will not use it. If you do have one of these 
switches, you will also have information included with them that 
explains the meaning of the virtualport parameters and how they are used 
(they're opaque to libvirt - it just passes them on to the switch 
without assigning any meaning to them).

portgroup is a tag used to select certain bits of config out of 
&lt;portgroup&gt; sections in the &lt;network&gt; definition being used for the 
interface. Currently the things that can be configured in the 
&lt;portgroup&gt; sections are 1) &lt;bandwidth&gt; info, and 2) &lt;virtualport&gt; 
parameters. Again, it has nothing to do with VLAN groups. &lt;portgroup&gt; is 
very new, btw - it has only been in libvirt since 0.9.4, so if you're 
using an older version don't expect it to do anything.

Down to the real basic question of which VLAN a particular guest is 
using - that can either be determined by the guest itself, or if the 
guest has no VLAN id setting, it could be determined by the 
switch/bridge the guest is connected to; in other words, wherever it is 
done, it's outside of libvirt (well, I guess if your platform has 
support for the iface-* commands, you could define a bridge that uses a 
vlan interface as its connection to the physical network - then traffic 
from any guest connected to that bridge would end up going onto the 
physical network with the given vlan id).

</body></email><email><emailId>20110907133145</emailId><senderName>Albert Chin</senderName><senderEmail>libvirt-users@mlists.thewrittenword.com</senderEmail><timestampReceived>2011-09-07 13:31:45-0400</timestampReceived><subject>[libvirt-users] How to dedicate a NIC for VM traffic without assigning it an IP</subject><body>

I am testing out a new server with RHEL6 running KVM. We have a few
NICs on the server, one of which we would like to dedicate to network
traffic to/from the virtual guests. Is it possible to do this without
assigning an IP address to the NIC? We're currently doing something
like this with Vmware Server, HP's HPVM for HP-UX/IA, and IBM's
PowerVM for AIX.

-- 
albert chin (china@thewrittenword.com)

</body></email><email><emailId>20110909111100</emailId><senderName>PREETHI RAMESH</senderName><senderEmail>iampreethiramesh@gmail.com</senderEmail><timestampReceived>2011-09-09 11:11:00-0400</timestampReceived><subject>[libvirt-users] IPs of VMs on KVM</subject><body>

How can I find the IPs of the VMs using libvirt function? As of now, I'm
thinking of using Nmap to get the MAC address and the ARP it to get the IP.
Can someone please help me out?

[Attachment #3 (text/html)]

How can I find the IPs of the VMs using libvirt function? As of now, I'm thinking \
of using Nmap to get the MAC address and the ARP it to get the IP. Can someone please \
help me out?&lt;br&gt;



</body></email><email><emailId>20110908030335</emailId><senderName>huachao yao</senderName><senderEmail>yao.d.hc@gmail.com</senderEmail><timestampReceived>2011-09-08 03:03:35-0400</timestampReceived><subject>[libvirt-users] Graphical framebuffers confuse, XML format about spice</subject><body>

Hello, i want to start a guest OS in the server, and use spice to achieve
graphical interaction with the guest OS. But when i config the XML file, i
was confuse by spice .
The graphic node is :
 &lt;graphics type='spice' port='5990' &gt;&lt;listen type='address'
address='127.0.0.1'/&gt;&lt;/graphics&gt;

but is has such error as below :
libvir: QEMU error : internal error process exited while connecting to
monitor: qemu-spice: -spice port=5990,addr=127.0.0.1,disable-ticketing:
Invalid parameter 'addr'
parse error: port=5990,addr=127.0.0.1,disable-ticketing

What is the meaning of &lt;listen type='address' address='*****'/&gt;,  If the
localhost IP is A and the spice-server IP is B. what should i set the listen
type ? to start the Domain   and to achieve  graphical interaction with the
guest OS.

[Attachment #3 (text/html)]

Hello, i want to start a guest OS in the server, and use spice to achieve   graphical \
interaction with the  guest OS. But when i config the XML file, i was confuse by \
spice .&lt;br&gt;The graphic node is :&lt;br&gt;&lt;span style="color: rgb(255, 0, 0);"&gt; \
&lt;graphics type='spice' port='5990' &gt;&lt;listen \
type='address' address='127.0.0.1'/&gt;&lt;/graphics&gt;&lt;/span&gt;&lt;br&gt; \
&lt;br&gt;but is has such error as below :&lt;br&gt;&lt;span style="color: rgb(255, 0, 0);"&gt;libvir: \
QEMU error : internal error process exited while connecting to monitor: qemu-spice: \
-spice port=5990,addr=127.0.0.1,disable-ticketing: Invalid parameter \
'addr'&lt;/span&gt;&lt;br style="color: rgb(255, 0, 0);"&gt; &lt;span style="color: rgb(255, \
0, 0);"&gt;parse error: port=5990,addr=127.0.0.1,disable-ticketing&lt;/span&gt;&lt;br&gt;&lt;br&gt;What is \
the meaning of &lt;span style="color: rgb(255, 0, 0);"&gt;&lt;listen type='address' \
address='*****'/&gt;&lt;/span&gt;,  If the  localhost IP is A and the spice-server \
IP is B. what should i set the listen type ? to start the Domain   and to achieve   \
graphical interaction with the  guest OS. &lt;br&gt;



</body></email><email><emailId>20110908031324</emailId><senderName>huachao yao</senderName><senderEmail>yao.d.hc@gmail.com</senderEmail><timestampReceived>2011-09-08 03:13:24-0400</timestampReceived><subject>Re: [libvirt-users] Graphical framebuffers confuse, XML format about spice</subject><body>

When i set the Graphic node as :

    &lt;graphics type='spice'&gt;
      &lt;listen type='network' network='rednet'/&gt;
    &lt;/graphics&gt;

the Error is :
libvir: QEMU error : XML error: listen network 'rednet' had no usable
address

what should i do to achieve  graphical interaction with the guest OS ??


2011/9/8 huachao yao &lt;yao.d.hc@gmail.com&gt;

&gt; Hello, i want to start a guest OS in the server, and use spice to achieve
&gt; graphical interaction with the guest OS. But when i config the XML file, i
&gt; was confuse by spice .
&gt; The graphic node is :
&gt;  &lt;graphics type='spice' port='5990' &gt;&lt;listen type='address'
&gt; address='127.0.0.1'/&gt;&lt;/graphics&gt;
&gt;
&gt; but is has such error as below :
&gt; libvir: QEMU error : internal error process exited while connecting to
&gt; monitor: qemu-spice: -spice port=5990,addr=127.0.0.1,disable-ticketing:
&gt; Invalid parameter 'addr'
&gt; parse error: port=5990,addr=127.0.0.1,disable-ticketing
&gt;
&gt; What is the meaning of &lt;listen type='address' address='*****'/&gt;,  If the
&gt; localhost IP is A and the spice-server IP is B. what should i set the listen
&gt; type ? to start the Domain   and to achieve  graphical interaction with the
&gt; guest OS.
&gt;

[Attachment #3 (text/html)]

When i set the Graphic node as :&lt;br&gt;&lt;pre style="color: rgb(204, 0, 0);"&gt;    \
&lt;graphics type='spice'&gt;  &lt;listen type='network' \
network='rednet'/&gt;  &lt;/graphics&gt;&lt;br&gt;&lt;/pre&gt;the Error is :&lt;br&gt;&lt;span \
style="color: rgb(255, 0, 0);"&gt;libvir: QEMU error : XML error: listen network \
'rednet' had no usable address&lt;/span&gt;&lt;br&gt;&lt;br&gt;what should i do to  achieve   \
graphical interaction with the  guest OS ??&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;2011/9/8 huachao yao &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:yao.d.hc@gmail.com"&gt;yao.d.hc@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, \
204, 204); padding-left: 1ex;"&gt; Hello, i want to start a guest OS in the server, and \
use spice to achieve   graphical interaction with the  guest OS. But when i config \
the XML file, i was confuse by spice .&lt;br&gt;The graphic node is :&lt;br&gt;&lt;span \
style="color: rgb(255, 0, 0);"&gt; &lt;graphics type='spice' port='5990' \
&gt;&lt;listen type='address' \
address='127.0.0.1'/&gt;&lt;/graphics&gt;&lt;/span&gt;&lt;br&gt;

&lt;br&gt;but is has such error as below :&lt;br&gt;&lt;span style="color: rgb(255, 0, 0);"&gt;libvir: \
QEMU error : internal error process exited while connecting to monitor: qemu-spice: \
-spice port=5990,addr=127.0.0.1,disable-ticketing: Invalid parameter \
'addr'&lt;/span&gt;&lt;br style="color: rgb(255, 0, 0);"&gt;

&lt;span style="color: rgb(255, 0, 0);"&gt;parse error: \
port=5990,addr=127.0.0.1,disable-ticketing&lt;/span&gt;&lt;br&gt;&lt;br&gt;What is the meaning of &lt;span \
style="color: rgb(255, 0, 0);"&gt;&lt;listen type='address' \
address='*****'/&gt;&lt;/span&gt;,  If the  localhost IP is A and the spice-server \
IP is B. what should i set the listen type ? to start the Domain   and to achieve   \
graphical interaction with the  guest OS. &lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110908192008</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2011-09-08 19:20:08-0400</timestampReceived><subject>Re: [libvirt-users] Graphical framebuffers confuse, XML format about spice</subject><body>

On 09/07/2011 11:03 PM, huachao yao wrote:
&gt; Hello, i want to start a guest OS in the server, and use spice to 
&gt; achieve  graphical interaction with the guest OS. But when i config 
&gt; the XML file, i was confuse by spice .
&gt; The graphic node is :
&gt; &lt;graphics type='spice' port='5990' &gt;&lt;listen type='address' 
&gt; address='127.0.0.1'/&gt;&lt;/graphics&gt;
&gt;
&gt; but is has such error as below :
&gt; libvir: QEMU error : internal error process exited while connecting to 
&gt; monitor: qemu-spice: -spice 
&gt; port=5990,addr=127.0.0.1,disable-ticketing: Invalid parameter 'addr'
&gt; parse error: port=5990,addr=127.0.0.1,disable-ticketing

Apparently your "qemu-spice" binary supports the -spice option, but 
doesn't support the addr option. That seems very strange. What is the 
origin of "qemu-spice", and what version does it display?

&gt;
&gt; What is the meaning of &lt;listen type='address' address='*****'/&gt;,

This is a new syntax starting in libvirt 0.9.4 that allows describing 
the address to listen on either as an IP address/domain name, or as a 
network name ("network name" referring to one of the virtual networks 
defined by libvirt)

&gt;   If the  localhost IP is A and the spice-server IP is B. what should 
&gt; i set the listen type ? to start the Domain   and to achieve  
&gt; graphical interaction with the guest OS.

You can leave it at the default of localhost (127.0.0.1) as long as your 
spice client (e.g. virt-manager) is running on the same machine. You 
would only want to change the address to something else if you needed to 
connect directly to the guest's spice server from a different physical 
machine, and in that case you would set the address to one of the 
physical interfaces on the host (*not* the guest).

However, this is not the cause of your original problem - your qemu 
binary doesn't like the -spice option as constructed by libvirt; there 
is something old / non-standard about this qemu.


</body></email><email><emailId>20110908192455</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2011-09-08 19:24:55-0400</timestampReceived><subject>Re: [libvirt-users] Graphical framebuffers confuse, XML format about spice</subject><body>

On 09/07/2011 11:13 PM, huachao yao wrote:
&gt; When i set the Graphic node as :
&gt;      &lt;graphics type='spice'&gt;
&gt;        &lt;listen type='network' network='rednet'/&gt;
&gt;      &lt;/graphics&gt;
&gt; the Error is :
&gt; libvir: QEMU error : XML error: listen network 'rednet' had no usable 
&gt; address

Unless you actually have a network defined in libvirt that is named 
"rednet", this configuration makes no sense. I can say with 99% 
certainty that you don't want a listen type of "network" - this is 
really only useful for large installations where guests are migrating 
between multiple hosts.


&gt; what should i do to achieve  graphical interaction with the guest OS ??

1) leave this part of the guest's configuration at its default as 
created by virt-manager or virt-install.

2) either use virt-manager and double click on the guest's icon, or (as 
root) run "virt-viewer guestname" from a shell on the host.

</body></email><email><emailId>20110801064813</emailId><senderName>Charles</senderName><senderEmail>cshtreck@yahoo.com</senderEmail><timestampReceived>2011-08-01 06:48:13-0400</timestampReceived><subject>[libvirt-users] centos6.0 unable to install guests w/ kickstart via virt-install</subject><body>

How does one use virt-install and kickstart ? I've seen others have success but I've \
had no joy thus far. BTW, my interactive virt-installs for centos6 guests work just \
fine AND I can do unattended kickstarts for vms by booting from centos6 install dvd \
and typing the kickstart commands from the boot: prompt. However, kickstart commands \
in --extra-args when used w/ virt-install just don't seem to work for me.

It looks like the kickstart file is just getting ignored .. 

virt-install -n d2 \
        -r 1024 \
        --vcpus=2 \
        -l http://mirror.cogentco.com/pub/linux/centos/6/os/x86_64/ \
        --accelerate -v \
        --disk path=/data/vm/d2.img,size=10  \
        --os-type=linux \
        --os-variant=rhel6 
        --network=bridge:br0
        -x "ks=http://10.1.10.2/id400ks.cfg ip=10.1.10.2 netmask=255.255.255.0 \
gateway=10.1.10.1 dns=8.8.8.8"

The above will boot from the mirror and then launch into the interactive graphical \
installer as though the kickstart file isn't even there.

kickstart file is here http://pastebin.com/ZChtv2C5

I also tried 'virsh edit domain' and set cmdline to 
&lt;cmdline&gt;ks=http://10.1.10.2/id400ks.cfg&lt;/cmdline&gt; 
and that didn't work. vm would'nt start.


details ...

uname -a Linux myhost 2.6.32-71.29.1.el6.x86_64 #1 SMP Mon Jun 27 19:49:27 BST 2011 \
x86_64 x86_64 x86_64 GNU/Linux [root vm]# rpm -qa | grep libvir
libvirt-0.8.1-27.el6_0.6.x86_64
libvirt-client-0.8.1-27.el6_0.6.x86_64
libvirt-python-0.8.1-27.el6_0.6.x86_64
[root vm]# rpm -qa | grep kvm
qemu-kvm-tools-0.12.1.2-2.113.el6_0.8.x86_64
qemu-kvm-0.12.1.2-2.113.el6_0.8.x86_64


any hlp apprec.
C.


</body></email><email><emailId>20110808172820</emailId><senderName>Jeff</senderName><senderEmail>jwk1230@gmail.com</senderEmail><timestampReceived>2011-08-08 17:28:20-0400</timestampReceived><subject>[libvirt-users] XML file location</subject><body>

Can anyone tell me how to change the default directory which stores the guest XML files?  I want to keep them with the guest image files on a shared NFS filesystem. 

Thanks,

Jeff

</body></email><email><emailId>20110801171529</emailId><senderName>Whit Blauvelt</senderName><senderEmail>whit.virt@transpect.com</senderEmail><timestampReceived>2011-08-01 17:15:29-0400</timestampReceived><subject>[libvirt-users] Is there a good way to "slot" libvirtd versions?</subject><body>

Hi,

Is there a reasonable way to alternately use several versions of libvirtd on
the same system? I ask because there are features of 0.9.X I want to
experiment with, yet also need to use the systems where I'm doing that to
connect via virt-manager and virsh to non-experimental systems running 0.8.8
and 0.8.3 on Ubuntu - which the compiled-from-tar 0.9.x has an
incompatibility with. 

As far as I can see with library dependencies there's no simple way to run
different editions of the libvirtd stack alternately on the same system. But
I could easily be missing a trick. Anyone have this working?

Thanks,
Whit

</body></email><email><emailId>20110801234522</emailId><senderName>Whit Blauvelt</senderName><senderEmail>whit.virt@transpect.com</senderEmail><timestampReceived>2011-08-01 23:45:22-0400</timestampReceived><subject>[libvirt-users] Q on stupid video tricks</subject><body>

Hi,

The good news is that if you use Virt-Manager running in a VM viewed through
Virt-Manager, that VM can drill another level through to view VMs. The
badish news is if that's a GUI desktop, the video for the VM-in-VM view ends
up (at least for me) with some serious artifacts - particularly distortions
largely involving vertical lines down through it.

Okay, this is an odd case that hardly counts as a problem, since who would
be crazy enough to do it? Still, since that's me, I'm wondering if there's
any setting to tweak that would bring that video into better focus?

Thanks,
Whit

</body></email><email><emailId>20110801235910</emailId><senderName>Michael Jinks</senderName><senderEmail>michael.jinks@gmail.com</senderEmail><timestampReceived>2011-08-01 23:59:10-0400</timestampReceived><subject>[libvirt-users] Guests ignoring config changes</subject><body>

I have a libvirt/kvm setup on a Gentoo system which I've been using
happily for a couple of years.  Recently, after a round of updates, I
started encountering all sorts of strange behavior, which I'll mostly
skip for now...  My current issue is that guest domains appear to be
ignoring changes made with 'virsh edit &lt;domain&gt;'.

Two examples: My primary desktop VM is crashing on boot, so I'm trying
to boot it with an install/rescue CD.  In my client definition file I
have:

  &lt;os&gt;
    &lt;type arch='x86_64' machine='pc-0.13'&gt;hvm&lt;/type&gt;
    &lt;boot dev='cdrom'/&gt;
    &lt;boot dev='hd'/&gt;
  &lt;/os&gt;

...and the cdrom defined elsewhere in the file points to a real ISO
file, which I know is bootable.  But when I start the guest, it
ignores the CD and boots from the (buggy) system image on the hd
device.  This still happens if I remove the "&lt;boot dev='hd'/&gt;" line
altogether.


Second example: I created another VM, definition copied from the one
above, so that I wouldn't be playing around with anything important.
On first boot it complains:

error: internal error process exited while connecting to monitor: char
device redirected to /dev/pts/3
inet_listen_opts: bind(ipv4,127.0.0.1,5911): Address already in use
inet_listen_opts: FAILED

...Oops, forgot to fix my VNC port.  So I edited the VM using "virsh
edit", found the VNC line, changed "port=5911" to "port=5912".  Saved,
verified that my change appears in the XML file on disk, tried again
to start the guest, and got the same complaint about port 5911 being
in use.  "virsh dumpxml" shows the corrrected port number, but for
some reason the change isn't making it through to the guest.

I've tried restarting libvirtd, with no effect, so I'm guessing there
must be some cache of VM configuration data that isn't being updated
when I edit my guest definitions?  What am I doing wrong?

Thanks,
--Michael

</body></email><email><emailId>20110808203708</emailId><senderName>Marc Haber</senderName><senderEmail>mh+libvirt-users@zugschlus.de</senderEmail><timestampReceived>2011-08-08 20:37:08-0400</timestampReceived><subject>[libvirt-users] virt-manager - how to add /dev/mapper as a storage pool</subject><body>

Hi,

I would like to be able to configure VMs running off dm-crypt devices
that were unlocked in the host. Unlocked dm-crypt devices show up in
/dev/mapper/devicename, with devicename being the second parameter
given to cryptsetup luksOpen.

The LVM storage pool type insists on searching in /dev/vgname and
cannot be tricked into reading /dev/mapper by giving it a fake VG
named mapper; the LVM storage pool type "dir" mishandles
/dev/mapper/control ("illegal seek").

Is there a workaround to be able to use such devices in virt-manager
without having to define a single storage pool for every device used?

Greetings
Marc

-- 
-----------------------------------------------------------------------------
Marc Haber         | "I don't trust Computers. They | Mailadresse im Header
Mannheim, Germany  |  lose things."    Winona Ryder | Fon: *49 621 72739834
Nordisch by Nature |  How to make an American Quilt | Fax: *49 3221 2323190

</body></email><email><emailId>20110809222850</emailId><senderName>Yih-Herng Chuang</senderName><senderEmail>yihherng@us.ibm.com</senderEmail><timestampReceived>2011-08-09 22:28:50-0400</timestampReceived><subject>[libvirt-users] the naming convention libvirt names a block based storage volume</subject><body>

Seems like different libvirt versions generate a storage volume name in=

different format.  We would like to learn how libvirt names a storage
volume under a block based storage pool.  So that we may properly extra=
ct
the LUN identifier out of the volume name for now and in the future.

On host A loaded with libvirt 0.8.7
# virsh vol-list SanPool1
Name Path
-----------------------------------------
unit:0:0:11 /dev/disk/by-id/wwn-0x600a0b800013071a000035ec4e32b832

On host B loaded with libvirt 0.8.1

# virsh vol-list SanPool1
Name Path
-----------------------------------------
1.0.0.0 /dev/disk/by-id/wwn-0x60080e500017e1d40000d0b74d873b13

Regards,

--Yih

Yih-Herng Chuang
IBM Center for Microsoft Technologies
3600 Carillon Point, Kirkland WA 98033
(DID) (425) 803-7285
(TIE) 977-7285
YihHerng@us.ibm.com=

[Attachment #3 (text/html)]

&lt;html&gt;&lt;body&gt;
&lt;p&gt;Seems like different libvirt versions generate a storage volume name=
 in different format.  We would like to learn how libvirt names a stora=
ge volume under a block based storage pool.  So that we may properly ex=
tract the LUN identifier out of the volume name for now and in the futu=
re.&lt;br&gt;
&lt;br&gt;
On host A loaded with libvirt 0.8.7&lt;br&gt;
# virsh vol-list SanPool1&lt;br&gt;
Name Path&lt;br&gt;
-----------------------------------------&lt;br&gt;
&lt;b&gt;unit:0:0:11&lt;/b&gt; /dev/disk/by-id/wwn-0x600a0b800013071a000035ec4e32b8=
32&lt;br&gt;
&lt;br&gt;
On host B loaded with libvirt 0.8.1&lt;br&gt;
&lt;br&gt;
# virsh vol-list SanPool1&lt;br&gt;
Name Path&lt;br&gt;
-----------------------------------------&lt;br&gt;
&lt;b&gt;1.0.0.0&lt;/b&gt; /dev/disk/by-id/wwn-0x60080e500017e1d40000d0b74d873b13&lt;b=
r&gt;
 &lt;br&gt;
Regards,&lt;br&gt;
&lt;br&gt;
--Yih&lt;br&gt;
&lt;br&gt;
Yih-Herng Chuang&lt;br&gt;
IBM Center for Microsoft Technologies&lt;br&gt;
3600 Carillon Point, Kirkland WA 98033&lt;br&gt;
(DID) (425) 803-7285&lt;br&gt;
(TIE) 977-7285&lt;br&gt;
YihHerng@us.ibm.com&lt;/body&gt;&lt;/html&gt;=


</body></email><email><emailId>20110810092010</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-08-10 09:20:10-0400</timestampReceived><subject>Re: [libvirt-users] the naming convention libvirt names a block based storage volume</subject><body>

On Tue, Aug 09, 2011 at 03:28:50PM -0700, Yih-Herng Chuang wrote:
&gt; 
&gt; 
&gt; Seems like different libvirt versions generate a storage volume name in
&gt; different format.  We would like to learn how libvirt names a storage
&gt; volume under a block based storage pool.  So that we may properly extract
&gt; the LUN identifier out of the volume name for now and in the future.
&gt; 
&gt; On host A loaded with libvirt 0.8.7
&gt; # virsh vol-list SanPool1
&gt; Name Path
&gt; -----------------------------------------
&gt; unit:0:0:11 /dev/disk/by-id/wwn-0x600a0b800013071a000035ec4e32b832

This is the new naming scheme which we plan to stick with long
term. The key point of the naming scheme is that the name is
stable across reboots, and across login/logout of iSCSI targets.

&gt; 
&gt; On host B loaded with libvirt 0.8.1
&gt; 
&gt; # virsh vol-list SanPool1
&gt; Name Path
&gt; -----------------------------------------
&gt; 1.0.0.0 /dev/disk/by-id/wwn-0x60080e500017e1d40000d0b74d873b13

This was the old method, which was broken, because we should not
have been including the HBA number in the name (the leading '1'
here). The HBA number changes every time you login to an iSCSI
target, or everytime an NPIV HBA is created, so it resulted in
an unstable name which changed frequently


Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110810212851</emailId><senderName>"Stefan G. Weichinger"</senderName><senderEmail>lists@xunil.at</senderEmail><timestampReceived>2011-08-10 21:28:51-0400</timestampReceived><subject>[libvirt-users] iscsi w/ libvirt</subject><body>


"Playing" with a NAS capable of iscsi ... trying to make use of it
within the virtual machine manager.

Could someone point me at or provide me an example/screenshot of adding
iscsi to my KVM-host?

I think I still don't get it.

Should I add an iscsi-LUN as a storage-pool? Or as single disk to a VM?

Could someone pls point me at some docs to make me understand?

Thanks a lot, Stefan

</body></email><email><emailId>20110811183651</emailId><senderName>Sharad Mishra</senderName><senderEmail>harad.mishra@gmail.com</senderEmail><timestampReceived>2011-08-11 18:36:51-0400</timestampReceived><subject>[libvirt-users] virInitialize dumps core intermittently.</subject><body>

Hi,

   I have a host with 6 VMs set to autostart. When this host reboots, it
starts libvirtd, pegasus cimom and libvirt-cim. It also restarts the VMs.
Intermittently we noticed a core during start up that points to the last
call made by libvirt-cim to "virInitialize". I am thinking that it is a
timing issue where virInitialize is called  while libvirt is trying to
autostart the VMs.

   Is this a known issue?

Thanks,
Sharad Mishra

[Attachment #3 (text/html)]

Hi,&lt;br&gt;&lt;br&gt;=A0=A0 I have a host with 6 VMs set to autostart. When this host=
 reboots, it starts libvirtd, pegasus cimom and libvirt-cim. It also restar=
ts the VMs. Intermittently we noticed a core during start up that points to=
 the last call made by libvirt-cim to "virInitialize". I am think=
ing that it is a timing issue where virInitialize is called=A0 while libvir=
t is trying to autostart the VMs. &lt;br&gt;
&lt;br&gt;=A0=A0 Is this a known issue?&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;Sharad Mishra&lt;br&gt;


</body></email><email><emailId>20110812021148</emailId><senderName>Gareth S Bestor</senderName><senderEmail>bestor@us.ibm.com</senderEmail><timestampReceived>2011-08-12 02:11:48-0400</timestampReceived><subject>[libvirt-users] virStoragePoolRefresh() returns before or after all new vols on path discovered?</subject><body>

This is a multipart message in MIME format.
--=_alternative 000B97EE882578EA_=
Content-Type: text/plain; charset="US-ASCII"

Basically, does virStoragePoolRefresh() api 'block' until the pool has 
refreshed itself (eg added any/all new volumes found in the pool path) or 
can it return early before the refresh is fully 'done' ?

- G

Dr. Gareth S. Bestor
IBM Senior Software Engineer
Systems &amp; Technology Group - Systems Management Standards
971-285-6375 (mobile)
bestor@us.ibm.com
--=_alternative 000B97EE882578EA_=
Content-Type: text/html; charset="US-ASCII"


&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;Basically, does virStoragePoolRefresh()
api 'block' until the pool has refreshed itself (eg added any/all new volumes
found in the pool path) or can it return early before the refresh is fully
'done' ?&lt;/font&gt;
&lt;br&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;- G&lt;/font&gt;
&lt;br&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;Dr. Gareth S. Bestor&lt;br&gt;
IBM Senior Software Engineer&lt;br&gt;
Systems &amp; Technology Group - Systems Management Standards&lt;br&gt;
971-285-6375 (mobile)&lt;br&gt;
bestor@us.ibm.com&lt;/font&gt;
--=_alternative 000B97EE882578EA_=--

</body></email><email><emailId>20110810150051</emailId><senderName>"William A. Mahaffey III"</senderName><senderEmail>wam@hiwaay.net</senderEmail><timestampReceived>2011-08-10 15:00:51-0400</timestampReceived><subject>[libvirt-users] Problems setting up a VM ....</subject><body>

.... New to this list &amp; definitely new to virtualization :-/ .... I am 
trying to setup a 64-bit CentOS 5.6 VM on a 64-bit FC14 server host, all 
patched up as of a couple of weeks ago. uname -a on the host shows:


[wam@Q6600, CFD, 9:24:23am] 540 % uname -a
Linux Q6600 2.6.35.11-83.fc14.x86_64 #1 SMP Mon Feb 7 07:06:44 UTC 2011 
x86_64 x86_64 x86_64 GNU/Linux
[wam@Q6600, CFD, 9:52:43am] 541 %


I access the server by ssh on my LAN. I was working on this last Sunday 
&amp; got stuck, see below. I posted this question to a couple of other 
lists &amp; had no takers, so here I am here. The server runs in runlevel 3 
&amp; has no gfx card onboard, so I am working from the command line. I had 
a couple of abortive attempts at setup, which got as far as initializing 
my disk storage for the VM, then the following:



[root@Q6600:/etc, Sun Aug 07, 05:08 PM] 1339 # virt-install   -n 
CentOS-5.6-64bitVM  -r 2048  --arch=x86_64  --cpu core2duo,disable=vmx  
--vcpus=1,maxvcpus=1,sockets=1,cores=2,threads=1  --os-type=linux  
--os-variant=rhel5  --disk 
path=/home/VMs/CentOS.5.6-64bit-VM/disk.img,size=50  --cdrom 
/home/ISOs/CentOS-5.6/64bit/CentOS-5.6-x86_64-bin-DVD-1of2.iso  
--autostart  --prompt
This will overwrite the existing path 
'/home/VMs/CentOS.5.6-64bit-VM/disk.img'
Do you really want to use this disk (yes or no)
yes

Starting install...
Creating 
domain...                                                                                     
|    0 B     00:00
Gtk-Message: Failed to load module "pk-gtk-module": libpk-gtk-module.so: 
cannot open shared object file: No such file or directory
Gtk-Message: Failed to load module "canberra-gtk-module": 
libcanberra-gtk-module.so: cannot open shared object file: No such file 
or directory

(virt-viewer:20165): Pango-WARNING **: failed to choose a font, expect 
ugly output. engine-type='PangoRenderFc', script='latin'
Domain installation still in progress. You can reconnect to
the console to complete the installation process.
[root@Q6600:/etc, Sun Aug 07, 05:14 PM] 1339 # virsh --connect 
qemu:///system
Welcome to virsh, the virtualization interactive terminal.

Type:  'help' for help with commands
        'quit' to quit

virsh # list
  Id Name                 State
----------------------------------
  11 CentOS-5.6-64bitVM   running

virsh # help


The install began OK, right after the 'Pango-WARNING' message, in a 
separate window, quite readable, started booting &amp; scrolling text past 
*FAST*, for about 15 sec., then hung, right after a line about 'serial 
port ....' (I couldn't click-&amp;-drag to capture text from the VM window, 
going from memory). I let it sit for about 5 min. to be sure it was 
really hung, then clicked the VM window out, whereupon the message about 
'installation still in progress' &amp; the rest appeared. I poked around in 
virsh a bit as you can see, but couldn't figure anything out. I tried 
(re)connecting to the console of the VM &amp; that hung, I had to kill the 
virsh command from another window. I attach syslog output from the 
proceedings. I am *sure* this is pilot error, but I am stuck for now. 
Any assistance appreciated :-) ....



-- 

	William A. Mahaffey III

  ----------------------------------------------------------------------

	"The M1 Garand is without doubt the finest implement of war
	 ever devised by man."
                            -- Gen. George S. Patton Jr.


["syslog.txt" (text/plain)]

Aug  7 09:14:43 Q6600 kernel: [169377.248047] FWDROP:INP:IN=virbr0 OUT= \
MAC=01:00:5e:00:00:01:00:00:00:00:00:00:08:00 SRC=0.0.0.0 DST=224.0.0.1 LEN=32 \
                TOS=0x00 PREC=0xC0 TTL=1 ID=0 DF PROTO=2 
Aug  7 17:01:08 Q6600 libvirtd: 17:01:08.795: error : qemudDomainLookupByName:4403 : \
                Domain not found: no domain with matching name 'CentOS-5.6-64bitVM'
Aug  7 17:01:08 Q6600 libvirtd: 17:01:08.799: error : storageVolumeLookupByPath:1241 \
                : Storage volume not found: no storage vol with matching path
Aug  7 17:01:08 Q6600 libvirtd: 17:01:08.826: error : storageVolumeLookupByPath:1241 \
                : Storage volume not found: no storage vol with matching path
Aug  7 17:01:49 Q6600 libvirtd: 17:01:49.542: error : qemudDomainLookupByName:4403 : \
                Domain not found: no domain with matching name 'CentOS-5.6-64bitVM'
Aug  7 17:01:49 Q6600 libvirtd: 17:01:49.544: error : storageVolumeLookupByPath:1241 \
                : Storage volume not found: no storage vol with matching path
Aug  7 17:01:49 Q6600 libvirtd: 17:01:49.571: error : storageVolumeLookupByPath:1241 \
                : Storage volume not found: no storage vol with matching path
Aug  7 17:01:49 Q6600 libvirtd: 17:01:49.576: error : storageVolumeLookupByPath:1241 \
                : Storage volume not found: no storage vol with matching path
Aug  7 17:01:49 Q6600 libvirtd: 17:01:49.579: error : storageVolumeLookupByPath:1241 \
                : Storage volume not found: no storage vol with matching path
Aug  7 17:01:49 Q6600 libvirtd: 17:01:49.603: error : qemudDomainLookupByUUID:4378 : \
                Domain not found: no domain with matching uuid \
                '6b5f5750-d802-4695-40ff-a808a5f8732e'
Aug  7 17:03:35 Q6600 libvirtd: 17:03:35.176: error : qemudDomainLookupByName:4403 : \
                Domain not found: no domain with matching name 'CentOS-5.6-64bitVM'
Aug  7 17:04:20 Q6600 libvirtd: 17:04:20.261: error : qemudDomainLookupByName:4403 : \
                Domain not found: no domain with matching name 'CentOS-5.6-64bitVM'
Aug  7 17:04:20 Q6600 libvirtd: 17:04:20.262: error : storageVolumeLookupByPath:1241 \
                : Storage volume not found: no storage vol with matching path
Aug  7 17:04:20 Q6600 libvirtd: 17:04:20.265: error : storageVolumeLookupByPath:1241 \
                : Storage volume not found: no storage vol with matching path
Aug  7 17:04:25 Q6600 libvirtd: 17:04:25.399: error : storageVolumeLookupByPath:1241 \
                : Storage volume not found: no storage vol with matching path
Aug  7 17:04:25 Q6600 libvirtd: 17:04:25.402: error : storageVolumeLookupByPath:1241 \
                : Storage volume not found: no storage vol with matching path
Aug  7 17:04:25 Q6600 libvirtd: 17:04:25.423: error : qemudDomainLookupByUUID:4378 : \
                Domain not found: no domain with matching uuid \
                '8d89c794-40e9-048b-9363-be20c5fd42ad'
Aug  7 17:08:24 Q6600 libvirtd: 17:08:24.296: error : qemudDomainLookupByName:4403 : \
                Domain not found: no domain with matching name 'CentOS-5.6-64bitVM'
Aug  7 17:08:24 Q6600 libvirtd: 17:08:24.298: error : storageVolumeLookupByPath:1241 \
                : Storage volume not found: no storage vol with matching path
Aug  7 17:08:24 Q6600 libvirtd: 17:08:24.301: error : storageVolumeLookupByPath:1241 \
                : Storage volume not found: no storage vol with matching path
Aug  7 17:08:27 Q6600 libvirtd: 17:08:27.038: error : storageVolumeLookupByPath:1241 \
                : Storage volume not found: no storage vol with matching path
Aug  7 17:08:27 Q6600 libvirtd: 17:08:27.041: error : storageVolumeLookupByPath:1241 \
                : Storage volume not found: no storage vol with matching path
Aug  7 17:08:27 Q6600 libvirtd: 17:08:27.062: error : qemudDomainLookupByUUID:4378 : \
                Domain not found: no domain with matching uuid \
                '782d7cf1-19f7-2b62-5a05-6cd8dc1d2659'
Aug  7 17:08:27 Q6600 libvirtd: 17:08:27.069: error : storageVolumeLookupByPath:1241 \
                : Storage volume not found: no storage vol with matching path
Aug  7 17:08:27 Q6600 libvirtd: 17:08:27.071: error : qemudDomainLookupByName:4403 : \
                Domain not found: no domain with matching name 'CentOS-5.6-64bitVM'
Aug  7 17:08:27 Q6600 kernel: [197800.696529] device vnet0 entered promiscuous mode
Aug  7 17:08:27 Q6600 kernel: [197800.698312] virbr0: topology change detected, \
                propagating
Aug  7 17:08:27 Q6600 kernel: [197800.698317] virbr0: port 1(vnet0) entering \
                forwarding state
Aug  7 17:08:27 Q6600 kernel: [197800.698319] virbr0: port 1(vnet0) entering \
                forwarding state
Aug  7 17:08:27 Q6600 kernel: [197800.750047] virbr0: port 1(vnet0) entering \
                forwarding state
Aug  7 17:08:27 Q6600 kernel: [197800.756045] device vnet0 left promiscuous mode
Aug  7 17:08:27 Q6600 kernel: [197800.756056] virbr0: port 1(vnet0) entering disabled \
                state
Aug  7 17:08:27 Q6600 NetworkManager[1377]: &lt;warn&gt; /sys/devices/virtual/net/vnet0: \
                couldn't determine device driver; ignoring...
Aug  7 17:08:27 Q6600 libvirtd: 17:08:27.319: error : qemudReadLogOutput:2118 : \
internal error Process exited while reading console log output: char device \
redirected to /dev/pts/6#012qemu: could not open disk image \
                /home/ISOs/CentOS-5.6/64bit/CentOS-5.6-x86_64-bin-DVD-1of2.iso: \
                Permission denied#012
Aug  7 17:09:37 Q6600 libvirtd: 17:09:37.769: error : qemudDomainLookupByName:4403 : \
                Domain not found: no domain with matching name 'CentOS-5.6-64bitVM'
Aug  7 17:09:37 Q6600 libvirtd: 17:09:37.771: error : storageVolumeLookupByPath:1241 \
                : Storage volume not found: no storage vol with matching path
Aug  7 17:09:37 Q6600 libvirtd: 17:09:37.775: error : storageVolumeLookupByPath:1241 \
                : Storage volume not found: no storage vol with matching path
Aug  7 17:09:40 Q6600 libvirtd: 17:09:40.476: error : storageVolumeLookupByPath:1241 \
                : Storage volume not found: no storage vol with matching path
Aug  7 17:09:40 Q6600 libvirtd: 17:09:40.479: error : storageVolumeLookupByPath:1241 \
                : Storage volume not found: no storage vol with matching path
Aug  7 17:09:40 Q6600 libvirtd: 17:09:40.502: error : qemudDomainLookupByUUID:4378 : \
                Domain not found: no domain with matching uuid \
                'c6590824-f2a7-9954-bd59-1f6f80fce1c9'
Aug  7 17:09:40 Q6600 libvirtd: 17:09:40.509: error : storageVolumeLookupByPath:1241 \
                : Storage volume not found: no storage vol with matching path
Aug  7 17:09:40 Q6600 libvirtd: 17:09:40.511: error : qemudDomainLookupByName:4403 : \
                Domain not found: no domain with matching name 'CentOS-5.6-64bitVM'
Aug  7 17:09:40 Q6600 kernel: [197874.104122] device vnet0 entered promiscuous mode
Aug  7 17:09:40 Q6600 kernel: [197874.105869] virbr0: topology change detected, \
                propagating
Aug  7 17:09:40 Q6600 kernel: [197874.105873] virbr0: port 1(vnet0) entering \
                forwarding state
Aug  7 17:09:40 Q6600 kernel: [197874.105875] virbr0: port 1(vnet0) entering \
                forwarding state
Aug  7 17:09:40 Q6600 NetworkManager[1377]: &lt;warn&gt; /sys/devices/virtual/net/vnet0: \
                couldn't determine device driver; ignoring...
Aug  7 17:09:40 Q6600 kernel: [197874.395411] kvm: 20139: cpu0 unhandled wrmsr: 0x198 \
                data 0
Aug  7 17:09:41 Q6600 libvirtd: 17:09:41.048: error : phypStorageOpen:3884 : invalid \
                argument in phypStorageOpen: unsupported flags (0x1)
Aug  7 17:09:43 Q6600 ntpd[1710]: Listen normally on 14 vnet0 fe80::fc54:ff:fed1:3f7d \
UDP 123



</body></email><email><emailId>20110812031603</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2011-08-12 03:16:03-0400</timestampReceived><subject>Re: [libvirt-users] virInitialize dumps core intermittently.</subject><body>

On Thu, Aug 11, 2011 at 11:36:51AM -0700, Sharad Mishra wrote:
&gt; Hi,
&gt; 
&gt;    I have a host with 6 VMs set to autostart. When this host reboots, it
&gt; starts libvirtd, pegasus cimom and libvirt-cim. It also restarts the VMs.
&gt; Intermittently we noticed a core during start up that points to the last
&gt; call made by libvirt-cim to "virInitialize". I am thinking that it is a
&gt; timing issue where virInitialize is called  while libvirt is trying to
&gt; autostart the VMs.

  Libvirt should not crash as is, but restarting the 6 domains may take
quite some time and it's done synchronously at startup, libvirt daemon
will start processing requests only once done. The problem is that
tog-pegasus may start in the meantime, libvirt-cim virInitialize()
run ... and fails to connect. You may have a crash there, make sure
how it behaves if there is a failure to connect on startup (apparently
it may take multiple attempts).

Daniel


-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

</body></email><email><emailId>20110811094446</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-08-11 09:44:46-0400</timestampReceived><subject>Re: [libvirt-users] iscsi w/ libvirt</subject><body>

On Wed, Aug 10, 2011 at 11:28:51PM +0200, Stefan G. Weichinger wrote:
&gt; 
&gt; "Playing" with a NAS capable of iscsi ... trying to make use of it
&gt; within the virtual machine manager.
&gt; 
&gt; Could someone point me at or provide me an example/screenshot of adding
&gt; iscsi to my KVM-host?
&gt; 
&gt; I think I still don't get it.
&gt; 
&gt; Should I add an iscsi-LUN as a storage-pool? Or as single disk to a VM?

A storage pool maps to an iSCSI target.  LUNs in the target, appear as
storage volumes inside the pool. A storage volume is then assigned as a
single disk to a VM.

&gt; Could someone pls point me at some docs to make me understand?

These 4 blog posts should help your understanding.

http://berrange.com/posts/2010/05/04/provisioning-kvm-virtual-machines-on-iscsi-with-qnap-virt-manager-part-1-of-2/
 http://berrange.com/posts/2010/05/04/provisioning-kvm-virtual-machines-on-iscsi-with-qnap-virt-manager-part-2-of-2/


http://berrange.com/posts/2010/05/05/provisioning-kvm-virtual-machines-on-iscsi-the-hard-way-part-1-of-2/
 http://berrange.com/posts/2010/05/05/provisioning-kvm-virtual-machines-on-iscsi-the-hard-way-part-2-of-2/


Regards,
Daniel
-- 
&gt; &gt; http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
&gt; &gt; http://libvirt.org              -o-             http://virt-manager.org :|
&gt; &gt; http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
&gt; &gt; http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|


</body></email><email><emailId>20110810140241</emailId><senderName>Dave Allan</senderName><senderEmail>dallan@redhat.com</senderEmail><timestampReceived>2011-08-10 14:02:41-0400</timestampReceived><subject>Re: [libvirt-users] the naming convention libvirt names a block based storage volume</subject><body>

On Wed, Aug 10, 2011 at 10:20:10AM +0100, Daniel P. Berrange wrote:
&gt; On Tue, Aug 09, 2011 at 03:28:50PM -0700, Yih-Herng Chuang wrote:
&gt; &gt; 
&gt; &gt; 
&gt; &gt; Seems like different libvirt versions generate a storage volume name in
&gt; &gt; different format.  We would like to learn how libvirt names a storage
&gt; &gt; volume under a block based storage pool.  So that we may properly extract
&gt; &gt; the LUN identifier out of the volume name for now and in the future.
&gt; &gt; 
&gt; &gt; On host A loaded with libvirt 0.8.7
&gt; &gt; # virsh vol-list SanPool1
&gt; &gt; Name Path
&gt; &gt; -----------------------------------------
&gt; &gt; unit:0:0:11 /dev/disk/by-id/wwn-0x600a0b800013071a000035ec4e32b832
&gt; 
&gt; This is the new naming scheme which we plan to stick with long
&gt; term. The key point of the naming scheme is that the name is
&gt; stable across reboots, and across login/logout of iSCSI targets.
&gt; 
&gt; &gt; 
&gt; &gt; On host B loaded with libvirt 0.8.1
&gt; &gt; 
&gt; &gt; # virsh vol-list SanPool1
&gt; &gt; Name Path
&gt; &gt; -----------------------------------------
&gt; &gt; 1.0.0.0 /dev/disk/by-id/wwn-0x60080e500017e1d40000d0b74d873b13
&gt; 
&gt; This was the old method, which was broken, because we should not
&gt; have been including the HBA number in the name (the leading '1'
&gt; here). The HBA number changes every time you login to an iSCSI
&gt; target, or everytime an NPIV HBA is created, so it resulted in
&gt; an unstable name which changed frequently

Since I was the one who came up with the original naming method, I
should probably chime in.  Note that although the HBA number changes
rapidly with iSCSI and NPIV, resulting as Dan points out in unstable
volume names, the other parts of the tuple are not guaranteed to
remain stable, either.  Changes to SAN topology will result in volume
name changes.  The only identifier you can depend on is the UUID of
the logical unit.

Dave

</body></email><email><emailId>20110809150906</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2011-08-09 15:09:06-0400</timestampReceived><subject>Re: [libvirt-users] virt-manager - how to add /dev/mapper as a storage pool</subject><body>

On 08/08/2011 04:37 PM, Marc Haber wrote:
&gt; Hi,
&gt; 
&gt; I would like to be able to configure VMs running off dm-crypt devices
&gt; that were unlocked in the host. Unlocked dm-crypt devices show up in
&gt; /dev/mapper/devicename, with devicename being the second parameter
&gt; given to cryptsetup luksOpen.
&gt; 
&gt; The LVM storage pool type insists on searching in /dev/vgname and
&gt; cannot be tricked into reading /dev/mapper by giving it a fake VG
&gt; named mapper; the LVM storage pool type "dir" mishandles
&gt; /dev/mapper/control ("illegal seek").
&gt; 
&gt; Is there a workaround to be able to use such devices in virt-manager
&gt; without having to define a single storage pool for every device used?
&gt; 
&gt; Greetings
&gt; Marc
&gt; 

cc-ing virt-tool-list

Latest virt-manager-0.9.0 allows adding a libvirt mpath pool which might
be what you're looking for. If you don't have that version you can try
configuring it on the command line with virsh. Some more info:

http://libvirt.org/storage.html#StorageBackendMultipath

- Cole

</body></email><email><emailId>20110809163112</emailId><senderName>Marc Haber</senderName><senderEmail>mh+libvirt-users@zugschlus.de</senderEmail><timestampReceived>2011-08-09 16:31:12-0400</timestampReceived><subject>Re: [libvirt-users] virt-manager - how to add /dev/mapper as a storage pool</subject><body>

On Tue, Aug 09, 2011 at 11:09:06AM -0400, Cole Robinson wrote:
&gt; On 08/08/2011 04:37 PM, Marc Haber wrote:
&gt; &gt; I would like to be able to configure VMs running off dm-crypt devices
&gt; &gt; that were unlocked in the host. Unlocked dm-crypt devices show up in
&gt; &gt; /dev/mapper/devicename, with devicename being the second parameter
&gt; &gt; given to cryptsetup luksOpen.
&gt; &gt; 
&gt; &gt; The LVM storage pool type insists on searching in /dev/vgname and
&gt; &gt; cannot be tricked into reading /dev/mapper by giving it a fake VG
&gt; &gt; named mapper; the LVM storage pool type "dir" mishandles
&gt; &gt; /dev/mapper/control ("illegal seek").
&gt; &gt; 
&gt; &gt; Is there a workaround to be able to use such devices in virt-manager
&gt; &gt; without having to define a single storage pool for every device used?
&gt; 
&gt; cc-ing virt-tool-list

Bcc, or forgotten?

&gt; Latest virt-manager-0.9.0 allows adding a libvirt mpath pool which might
&gt; be what you're looking for. If you don't have that version you can try
&gt; configuring it on the command line with virsh.

I have that version, but an mpath pool set to /dev/mapper stays empty.
Googling and reading the available docs suggests that this feature
only looks for /dev/mapper/mpath*

Greetings
Marc

-- 
-----------------------------------------------------------------------------
Marc Haber         | "I don't trust Computers. They | Mailadresse im Header
Mannheim, Germany  |  lose things."    Winona Ryder | Fon: *49 621 72739834
Nordisch by Nature |  How to make an American Quilt | Fax: *49 3221 2323190

</body></email><email><emailId>20110809164506</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2011-08-09 16:45:06-0400</timestampReceived><subject>Re: [libvirt-users] virt-manager - how to add /dev/mapper as a storage pool</subject><body>

On 08/09/2011 12:31 PM, Marc Haber wrote:
&gt; On Tue, Aug 09, 2011 at 11:09:06AM -0400, Cole Robinson wrote:
&gt;&gt; On 08/08/2011 04:37 PM, Marc Haber wrote:
&gt;&gt;&gt; I would like to be able to configure VMs running off dm-crypt devices
&gt;&gt;&gt; that were unlocked in the host. Unlocked dm-crypt devices show up in
&gt;&gt;&gt; /dev/mapper/devicename, with devicename being the second parameter
&gt;&gt;&gt; given to cryptsetup luksOpen.
&gt;&gt;&gt;
&gt;&gt;&gt; The LVM storage pool type insists on searching in /dev/vgname and
&gt;&gt;&gt; cannot be tricked into reading /dev/mapper by giving it a fake VG
&gt;&gt;&gt; named mapper; the LVM storage pool type "dir" mishandles
&gt;&gt;&gt; /dev/mapper/control ("illegal seek").
&gt;&gt;&gt;
&gt;&gt;&gt; Is there a workaround to be able to use such devices in virt-manager
&gt;&gt;&gt; without having to define a single storage pool for every device used?
&gt;&gt;
&gt;&gt; cc-ing virt-tool-list
&gt; 
&gt; Bcc, or forgotten?
&gt; 
&gt;&gt; Latest virt-manager-0.9.0 allows adding a libvirt mpath pool which might
&gt;&gt; be what you're looking for. If you don't have that version you can try
&gt;&gt; configuring it on the command line with virsh.
&gt; 
&gt; I have that version, but an mpath pool set to /dev/mapper stays empty.
&gt; Googling and reading the available docs suggests that this feature
&gt; only looks for /dev/mapper/mpath*
&gt; 

Forgotten, sorry.

Not really sure then, maybe this is something that libvirt should be
extended to handle. CCing libvirt devel list

- Cole

</body></email><email><emailId>20110802083516</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-08-02 08:35:16-0400</timestampReceived><subject>Re: [libvirt-users] Snapshot error "command savevm not found"</subject><body>

? 2011?08?02? 08:15, Trey Dockendorf ??:
&gt; Attempting to take snapshots of VM using virsh with the following 
&gt; command,
&gt;
&gt; # virsh -c qemu:///system snapshot-create CentOS6-x86-001
&gt;
&gt; Results in the following error,
&gt;
&gt; error: internal error unable to execute QEMU command 'savevm': The 
&gt; command savevm has not been found
&gt;
&gt; The VM's virtual disks are qcow2.  Below is the XML file for this vm

It means your qemu or qemu-kvm doesn't support savevm monitor command.
You can confirm it like below.

# service libvirtd stop
# nc -U /var/lib/libvirt/qemu/$domain.monitor
 &gt; {"execute": "qmp_capabilities"}
 &gt; {"execute": "query-commands"}

Osier

[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta content="text/html; charset=ISO-8859-1"
      http-equiv="Content-Type"&gt;
    &lt;title&gt;&lt;/title&gt;
  &lt;/head&gt;
  &lt;body bgcolor="#ffffff" text="#000000"&gt;
    于 2011年08月02日 08:15, Trey Dockendorf 写道:
    &lt;blockquote
cite="mid:CAN0oX1YaBQ18D9G3SSuh_erH1PTw0tJkUbjEZm3wtnVm6XE5ow@mail.gmail.com"
      type="cite"&gt;
      &lt;meta charset="utf-8"&gt;
      &lt;span class="Apple-style-span" style="border-collapse: collapse;
        font-family: arial,sans-serif; font-size: 13px;"&gt;Attempting to
        take snapshots of VM using virsh with the following command,
        &lt;div&gt;&lt;br&gt;
        &lt;/div&gt;
        &lt;div&gt;# virsh -c qemu:///system snapshot-create CentOS6-x86-001&lt;/div&gt;
        &lt;div&gt;&lt;br&gt;
        &lt;/div&gt;
        &lt;div&gt;Results in the following error,&lt;/div&gt;
        &lt;div&gt;&lt;br&gt;
        &lt;/div&gt;
        &lt;div&gt;error: internal error unable to execute QEMU command
          'savevm': The command savevm has not been found&lt;/div&gt;
        &lt;div&gt;&lt;br&gt;
        &lt;/div&gt;
        &lt;div&gt;The VM's virtual disks are qcow2.  Below is the XML file
          for this vm&lt;/div&gt;
      &lt;/span&gt;&lt;/blockquote&gt;
    &lt;br&gt;
    It means your qemu or qemu-kvm doesn't support savevm monitor
    command.&lt;br&gt;
    You can confirm it like below.&lt;br&gt;
    &lt;br&gt;
    # service libvirtd stop&lt;br&gt;
    # nc -U /var/lib/libvirt/qemu/$domain.monitor&lt;br&gt;
    &gt; {"execute": "qmp_capabilities"}&lt;br&gt;
    &gt; {"execute": "query-commands"}&lt;br&gt;
    &lt;br&gt;
    Osier&lt;br&gt;
  &lt;/body&gt;
&lt;/html&gt;


</body></email><email><emailId>20110802085113</emailId><senderName>Olivier BONHOMME</senderName><senderEmail>obonhomme@nerim.net</senderEmail><timestampReceived>2011-08-02 08:51:13-0400</timestampReceived><subject>[libvirt-users] CPU Model detection with virsh capabilities</subject><body>

Hello everybody,

I am a new user discovering libvirt with KVM software. During my first 
VM creation, I saw an issue with virsh that I can't understand.

I wanted to emulate another CPU than the classical qemu32 using virsh. 
So I used the virsh capabilites command to detect how is detected my CPU 
host which is an Intel Xeon E5410 and my problem is that this CPU is 
detected only with the cpumodel "pentium3".

But if use the kvm -cpu ? command, it returns me the following 
capabilities :

$ kvm -cpu ?
x86           qemu64
x86           phenom
x86         core2duo
x86            kvm64
x86           qemu32
x86          coreduo
x86              486
x86          pentium
x86         pentium2
x86         pentium3
x86           athlon
x86             n270

Moreover, if i decide to use the pentium3 cpumodel for my KVM VM, the 
CentOS freeze during its loading.

My libvirt and kvm are the following on a Debian Squeeeze :

$ virsh version
Compiled against library: libvir 0.8.3
Using library: libvir 0.8.3
Using API: QEMU 0.8.3
Running hypervisor: QEMU 0.12.5

Does anybody already had the same issue or am I doing anything wrong ?

Thanks for your answers

Regards,
Olivier BONHOMME

</body></email><email><emailId>20110802205010</emailId><senderName>"JDF. Franklin"</senderName><senderEmail>jdf.lists@gmail.com</senderEmail><timestampReceived>2011-08-02 20:50:10-0400</timestampReceived><subject>Re: [libvirt-users] centos6.0 unable to install guests w/ kickstart via virt-install</subject><body>

Looks like you're missing some backslashes toward the bottom, so
virt-install wouldn't see anything past "os-variant". Here's mine
(adding the ttyS0 allows looking at it on the cli with "virsh console"
as well):

virt-install \
   --name=myhost \
   --connect qemu:///system \
   --disk path=/data/virt/guest$$,size=20,bus=virtio \
   --vcpus=2 --ram=1024 \
   --graphics vnc,keymap=en-us \
   --autostart \
   --location=http://example.org/ks/el6/x86_64/ \
   -x "console=ttyS0,115200 ks=http://example.org/ks/myhost.cfg" \
   --network bridge=br0 \
   --os-type=linux \
   --os-variant=virtio26

</body></email><email><emailId>20110803021106</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-08-03 02:11:06-0400</timestampReceived><subject>Re: [libvirt-users] Associating a statefile with an image</subject><body>

On 08/02/2011 07:06 PM, sethuraman subbiah wrote:
&gt;&gt;
&gt;
&gt; I tried changing the disk image and it works fine. But if I try to change
&gt; the mac address , I get error: unsupported configuration.

That's correct - changing the MAC address would be a guest-visible 
change, with possibly fatal consequences to a guest (your hardware 
doesn't change MAC addresses on the fly, so why should your virtual 
hardware allow it?).

&gt; My aim was to
&gt; perform cloning and change the mac of the cloned image and also doing some
&gt; changes inside the vm to make sure it obtains a new ip. Is there a
&gt; possibility to get this working with the current API ?

Cloning is not a trivial operation.  There is no support for cloning a 
running machine; it is only safe to clone offline disk images, at which 
point, you _can_ modify MAC addresses for the clone, since a guest 
booting with a new MAC address is no different than swapping out 
hardware while your machine was offline.  Virt-manager is able to do 
cloning, and it involves multiple libvirt API calls; perhaps studying 
that source will give you some better ideas.  It is unlikely that 
libvirt will ever be able to support cloning in a single API call; 
rather it will continue to support enough API to be used in sequence to 
do a clone.  Likewise, cloning a live machine (even one whose state was 
saved by 'virsh save' or 'virsh snapshot') is unlikely to ever be possible.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20110813025806</emailId><senderName>"William A. Mahaffey III"</senderName><senderEmail>wam@hiwaay.net</senderEmail><timestampReceived>2011-08-13 02:58:06-0400</timestampReceived><subject>[libvirt-users] How do I disable auto-logout ....</subject><body>



.... I have a 64-bit CentOS 5.6 VM running on a 64-bit FC14 host. I 
notice that it has an automatic logout feature after a period of 
idleness, see below:


[wam@centos-5, CFD, 5:52:45pm] 1183 % ll -tr LIST LIST.Update 
/usr/local/bin/P* /usr/local/bin/*WAM* ; ps -u wam -lf ; uname -a ; date
ls: No match.
F S UID        PID  PPID  C PRI  NI P    SZ:RSS  WCHAN  STIME 
TTY          TIME CMD
5 S wam       2270  2266  0  15   0 * 22540:1788 ?      15:48 ?        
00:00:04 sshd: wam@pts/0
0 S wam       2271  2270  0  15   0 *  3144:2720 rt_sig 15:48 pts/0    
00:00:00 -tcsh
0 R wam      18249  2271  0  15   0 0  2621:896  -      17:52 pts/0    
00:00:00 ps -u wam -lf
Linux centos-5.6-vm 2.6.18-238.el5 #1 SMP Thu Jan 13 15:51:15 EST 2011 
x86_64 x86_64 x86_64 GNU/Linux
Fri Aug 12 17:52:50 CDT 2011
[wam@centos-5, CFD, 5:52:50pm] 1184 % auto-logout
Connection to 192.168.122.213 closed.
[wam@Q6600, ~, 6:52:51pm] 1014 %
[wam@Q6600, ~, 9:40:49pm] 1014 %
[wam@Q6600, ~, 9:40:49pm] 1014 % ssh2 -l wam 192.168.122.213
Last login: Fri Aug 12 15:48:11 2011 from 192.168.122.1
[wam@centos-5, ~, 9:40:54pm] 1135 %


I checked man pages on both host &amp; VM, but came up blank. I have another 
box running CentOS 5.6 native &amp; it doesn't do this, so I suspect it is 
something w/ the VM environment. How do I disable that :-) ? Thanks in 
advance.


-- 

	William A. Mahaffey III

  ----------------------------------------------------------------------

	"The M1 Garand is without doubt the finest implement of war
	 ever devised by man."
                            -- Gen. George S. Patton Jr.

</body></email><email><emailId>20110812214655</emailId><senderName>Jeff</senderName><senderEmail>jwk1230@gmail.com</senderEmail><timestampReceived>2011-08-12 21:46:55-0400</timestampReceived><subject>[libvirt-users] VNC ports</subject><body>

I am needing to explicitly assign VNC ports to my virtual guests so that I can \
connect to them externally via a VNC client, and not virt-viewer.  Since I will have \
multiple KVM Hosts with access to the same shared storage (to facilitate migrations) \
I need to ensure I have unique VNC ports assigned to each guest so that I don't \
overlap somehow.

I had planned to use a range of ports starting at 51000 for this purpose.  While it \
works to assign port 51001, for example, to a guest and connect via my VNC client, \
when I run 'virsh vncdisplay guestname' it gives me back a different number that is \
specified in the XML file:

#virsh vncdisplay win2k8guest
&gt; 45101

#virsh dumpxml win2k8guest |grep vnc
&lt;graphics type='vnc' port='51001' autoport='no' /&gt;


Is there a logical reason for this that I'm not getting?  I know when I have the port \
set to 5907, for example, it returns something expected:

#virsh vncdisplay win2k8guest
&gt; 7

But since I am likely going to need a good number of ports, I want to use a \
non-registered port range.  Any insights?


</body></email><email><emailId>20110815200131</emailId><senderName>"Xianqing Yu"</senderName><senderEmail>yu267155364@hotmail.com</senderEmail><timestampReceived>2011-08-15 20:01:31-0400</timestampReceived><subject>[libvirt-users] Non-persistent disk</subject><body>

Hi Libvirt team,

I am trying to create a new domain from XML file by using libvirt. I want 
this new domain using non-persistent disk as its disk. Non-persistent disk 
means that when the domain is running, all the modification would not be 
written to disk file.  So next time, when you boot VM from the same disk 
file, you would have a fresh disk. I check the website but I could not find 
anything about this. I wonder if libvirt support this function.

FYI, if I use KVM, I can use command "qemu-kvm -snapshot" to boot a VM on 
non-persistent disk. If I use VMware, I can set disk type to Independ-disk, 
non-persistent.

Thanks,

Xianqing Yu

------
Graduate Research Assistant, Cyber Defense Lab
Department of Computer Science
North Carolina State University, Raleigh, NC
E-mail: xyu6@ncsu.edu 

</body></email><email><emailId>20110813071754</emailId><senderName>Abhishek Gupta</senderName><senderEmail>abhishekgupta.iitd@gmail.com</senderEmail><timestampReceived>2011-08-13 07:17:54-0400</timestampReceived><subject>Re: [libvirt-users] VNC ports</subject><body>

Hello Jeff,

For our project we are using port forwarding. Our architecture is as follows
:

Web Server A
Servers on which vms are hosted - H1,H2,H3 and so on
Client C

There is a VM(i,j) which is the ith vm on the jth server that is HJ. But the
client fires a request to A:some-port and is served from
Hj:some-other-port-on-b

This way client is not aware of the servers in the model. We maintain those
rules when new machines are created as well as when old machines are
deleted.

On 13 August 2011 03:16, Jeff &lt;jwk1230@gmail.com&gt; wrote:

&gt; I am needing to explicitly assign VNC ports to my virtual guests so that I
&gt; can connect to them externally via a VNC client, and not virt-viewer.  Since
&gt; I will have multiple KVM Hosts with access to the same shared storage (to
&gt; facilitate migrations) I need to ensure I have unique VNC ports assigned to
&gt; each guest so that I don't overlap somehow.
&gt;
&gt; We have following redundancy in our architecture.

5901:server -&gt; 5901:h1
5902:server -&gt; 5901:h2
5903:server -&gt; 5902:h1
5904:server -&gt; 5901:h3

I had planned to use a range of ports starting at 51000 for this purpose.
&gt;  While it works to assign port 51001, for example, to a guest and connect
&gt; via my VNC client, when I run 'virsh vncdisplay guestname' it gives me back
&gt; a different number that is specified in the XML file:
&gt;
&gt; #virsh vncdisplay win2k8guest
&gt; :45101
&gt;
&gt; It should give you a port number 5900 less than. It basically assumes 5900
as the VNC port.


&gt; #virsh dumpxml win2k8guest |grep vnc
&gt; &lt;graphics type='vnc' port='51001' autoport='no' /&gt;
&gt;
&gt;
&gt; Is there a logical reason for this that I'm not getting?  I know when I
&gt; have the port set to 5907, for example, it returns something expected:
&gt;
&gt; #virsh vncdisplay win2k8guest
&gt; :7
&gt;
&gt; But since I am likely going to need a good number of ports, I want to use a
&gt; non-registered port range.  Any insights?
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;



-- 
Abhishek
Webpage &lt;http://abhishekgupta92.info/&gt; !!! Blog &lt;http://thelazy.info&gt; !!!
Tech-Blog &lt;http://geek.thelazy.info&gt;

[Attachment #3 (text/html)]

Hello Jeff,&lt;br&gt;&lt;br&gt;For our project we are using port forwarding. Our architecture is \
as follows :&lt;br&gt;&lt;br&gt;Web Server A&lt;br&gt;Servers on which vms are hosted - H1,H2,H3 and so \
on&lt;br&gt;Client C&lt;br&gt;&lt;br&gt;There is a VM(i,j) which is the ith vm on the jth server that \
is HJ. But the client fires a request to A:some-port and is served from \
Hj:some-other-port-on-b&lt;br&gt; &lt;br&gt;This way client is not aware of the servers in the \
model. We maintain those rules when new machines are created as well as when old \
machines are deleted.&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On 13 August 2011 03:16, Jeff \
&lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:jwk1230@gmail.com"&gt;jwk1230@gmail.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt; \
&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt;I am needing to explicitly assign VNC ports to my virtual \
guests so that I can connect to them externally via a VNC client, and not \
virt-viewer.  Since I will have multiple KVM Hosts with access to the same shared \
storage (to facilitate migrations) I need to ensure I have unique VNC ports assigned \
to each guest so that I don't overlap somehow.&lt;br&gt;

&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;We have following redundancy in our \
architecture.&lt;br&gt;&lt;br&gt;5901:server -&gt; 5901:h1&lt;br&gt;5902:server -&gt; \
5901:h2&lt;br&gt;5903:server -&gt; 5902:h1 &lt;br&gt;5904:server -&gt; \
5901:h3&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt \
0.8ex; border-left: 1px solid rgb(204, 204, 204); padding-left: 1ex;"&gt;

I had planned to use a range of ports starting at 51000 for this purpose.  While it \
works to assign port 51001, for example, to a guest and connect via my VNC client, \
when I run 'virsh vncdisplay guestname' it gives me back a different number \
that is specified in the XML file:&lt;br&gt;

&lt;br&gt;
#virsh vncdisplay win2k8guest&lt;br&gt;
&gt; 45101&lt;br&gt;
&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;It should give you a port number 5900 less than. It basically \
assumes 5900 as the VNC port.&lt;br&gt; &lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" \
style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, 204, 204); \
padding-left: 1ex;"&gt;

#virsh dumpxml win2k8guest |grep vnc&lt;br&gt;
&lt;graphics type='vnc' port='51001' autoport='no' /&gt;&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Is there a logical reason for this that I'm not getting?  I know when I have the \
port set to 5907, for example, it returns something expected:&lt;br&gt; &lt;br&gt;
#virsh vncdisplay win2k8guest&lt;br&gt;
&gt; 7&lt;br&gt;
&lt;br&gt;
But since I am likely going to need a good number of ports, I want to use a \
non-registered port range.  Any insights?&lt;br&gt; &lt;br&gt;
_______________________________________________&lt;br&gt;
libvirt-users mailing list&lt;br&gt;
&lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
&lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; \
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;Abhishek&lt;br&gt;&lt;a \
href="http://abhishekgupta92.info/" target="_blank"&gt;Webpage&lt;/a&gt; !!! &lt;a \
href="http://thelazy.info" target="_blank"&gt;Blog&lt;/a&gt; !!! &lt;a \
href="http://geek.thelazy.info" target="_blank"&gt;Tech-Blog&lt;/a&gt;&lt;br&gt; &lt;br&gt;



</body></email><email><emailId>20110813161556</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-08-13 16:15:56-0400</timestampReceived><subject>Re: [libvirt-users] VNC ports</subject><body>

2011/8/12 Jeff &lt;jwk1230@gmail.com&gt;:
&gt; I am needing to explicitly assign VNC ports to my virtual guests so that I can \
&gt; connect to them externally via a VNC client, and not virt-viewer.  Since I will \
&gt; have multiple KVM Hosts with access to the same shared storage (to facilitate \
&gt; migrations) I need to ensure I have unique VNC ports assigned to each guest so that \
&gt; I don't overlap somehow. 
&gt; I had planned to use a range of ports starting at 51000 for this purpose.  While it \
&gt; works to assign port 51001, for example, to a guest and connect via my VNC client, \
&gt; when I run 'virsh vncdisplay guestname' it gives me back a different number that is \
&gt; specified in the XML file: 
&gt; #virsh vncdisplay win2k8guest
&gt; &gt; 45101
&gt; 
&gt; #virsh dumpxml win2k8guest |grep vnc
&gt; &lt;graphics type='vnc' port='51001' autoport='no' /&gt;
&gt; 
&gt; 
&gt; Is there a logical reason for this that I'm not getting?  I know when I have the \
&gt; port set to 5907, for example, it returns something expected: 
&gt; #virsh vncdisplay win2k8guest
&gt; &gt; 7
&gt; 
&gt; But since I am likely going to need a good number of ports, I want to use a \
&gt; non-registered port range.  Any insights?

virsh vncdisplay gives you the VNC display number, not the VNC port
number. The common VNC port range starts at port 5900 and this maps to
VNC display 0. virsh vncdisplay gives you :7 for VNC port 5907 because
of this. This this is the expected behavior for virsh vncdisplay.

-- 
Matthias Bolte
http://photron.blogspot.com


</body></email><email><emailId>20110813082330</emailId><senderName>Carlos_Campderrós</senderName><senderEmail>gilipollas.desconcertante@gmail.com</senderEmail><timestampReceived>2011-08-13 08:23:30-0400</timestampReceived><subject>Re: [libvirt-users] How do I disable auto-logout ....</subject><body>

Hi,

Maybe it's bash and its configurable timeout? Check $TMOUT variable, if it's
non empty, it specifies a number of seconds to auto-logout when idle.

On Aug 13, 2011 4:53 AM, "William A. Mahaffey III" &lt;wam@hiwaay.net&gt; wrote:



.... I have a 64-bit CentOS 5.6 VM running on a 64-bit FC14 host. I notice
that it has an automatic logout feature after a period of idleness, see
below:


[wam@centos-5, CFD, 5:52:45pm] 1183 % ll -tr LIST LIST.Update
/usr/local/bin/P* /usr/local/bin/*WAM* ; ps -u wam -lf ; uname -a ; date
ls: No match.
F S UID        PID  PPID  C PRI  NI P    SZ:RSS  WCHAN  STIME TTY
 TIME CMD
5 S wam       2270  2266  0  15   0 * 22540:1788 ?      15:48 ?
 00:00:04 sshd: wam@pts/0
0 S wam       2271  2270  0  15   0 *  3144:2720 rt_sig 15:48 pts/0
 00:00:00 -tcsh
0 R wam      18249  2271  0  15   0 0  2621:896  -      17:52 pts/0
 00:00:00 ps -u wam -lf
Linux centos-5.6-vm 2.6.18-238.el5 #1 SMP Thu Jan 13 15:51:15 EST 2011
x86_64 x86_64 x86_64 GNU/Linux
Fri Aug 12 17:52:50 CDT 2011
[wam@centos-5, CFD, 5:52:50pm] 1184 % auto-logout
Connection to 192.168.122.213 closed.
[wam@Q6600, ~, 6:52:51pm] 1014 %
[wam@Q6600, ~, 9:40:49pm] 1014 %
[wam@Q6600, ~, 9:40:49pm] 1014 % ssh2 -l wam 192.168.122.213
Last login: Fri Aug 12 15:48:11 2011 from 192.168.122.1
[wam@centos-5, ~, 9:40:54pm] 1135 %


I checked man pages on both host &amp; VM, but came up blank. I have another box
running CentOS 5.6 native &amp; it doesn't do this, so I suspect it is something
w/ the VM environment. How do I disable that :-) ? Thanks in advance.


-- 

       William A. Mahaffey III

 ------------------------------**------------------------------**----------

       "The M1 Garand is without doubt the finest implement of war
        ever devised by man."
                          -- Gen. George S. Patton Jr.

______________________________**_________________
libvirt-users mailing list
libvirt-users@redhat.com
https://www.redhat.com/**mailman/listinfo/libvirt-users&lt;https://www.redhat.com/mailman/listinfo/libvirt-users&gt;



[Attachment #3 (text/html)]

&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Maybe it's bash and its configurable timeout? Check $TMOUT variable, if \
it's non empty, it specifies a number of seconds to auto-logout when idle.&lt;/p&gt; \
&lt;p&gt;&lt;blockquote type="cite"&gt;On Aug 13, 2011 4:53 AM, "William A. Mahaffey \
III" &lt;&lt;a href="mailto:wam@hiwaay.net"&gt;wam@hiwaay.net&lt;/a&gt;&gt; \
wrote:&lt;br&gt;&lt;br&gt;&lt;br&gt; &lt;br&gt;
.... I have a 64-bit CentOS 5.6 VM running on a 64-bit FC14 host. I notice that it \
has an automatic logout feature after a period of idleness, see below:&lt;br&gt; &lt;br&gt;
&lt;br&gt;
[wam@centos-5, CFD, 5:52:45pm] 1183 % ll -tr LIST LIST.Update /usr/local/bin/P* \
                /usr/local/bin/*WAM* ; ps -u wam -lf ; uname -a ; date&lt;br&gt;
ls: No match.&lt;br&gt;
F S UID        PID  PPID  C PRI  NI P    SZ:RSS  WCHAN  STIME TTY          TIME \
CMD&lt;br&gt; 5 S wam       2270  2266  0  15   0 * 22540:1788 ?      15:48 ?        \
00:00:04 sshd: wam@pts/0&lt;br&gt; 0 S wam       2271  2270  0  15   0 *  3144:2720 rt_sig \
15:48 pts/0    00:00:00 -tcsh&lt;br&gt; 0 R wam      18249  2271  0  15   0 0  2621:896  -  \
17:52 pts/0    00:00:00 ps -u wam -lf&lt;br&gt; Linux centos-5.6-vm 2.6.18-238.el5 #1 SMP \
Thu Jan 13 15:51:15 EST 2011 x86_64 x86_64 x86_64 GNU/Linux&lt;br&gt; Fri Aug 12 17:52:50 \
CDT 2011&lt;br&gt; [wam@centos-5, CFD, 5:52:50pm] 1184 % auto-logout&lt;br&gt;
Connection to 192.168.122.213 closed.&lt;br&gt;
[wam@Q6600, ~, 6:52:51pm] 1014 %&lt;br&gt;
[wam@Q6600, ~, 9:40:49pm] 1014 %&lt;br&gt;
[wam@Q6600, ~, 9:40:49pm] 1014 % ssh2 -l wam 192.168.122.213&lt;br&gt;
Last login: Fri Aug 12 15:48:11 2011 from 192.168.122.1&lt;br&gt;
[wam@centos-5, ~, 9:40:54pm] 1135 %&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
I checked man pages on both host &amp; VM, but came up blank. I have another box \
running CentOS 5.6 native &amp; it doesn't do this, so I suspect it is something \
w/ the VM environment. How do I disable that :-) ? Thanks in advance.&lt;br&gt;

&lt;br&gt;
&lt;br&gt;
-- &lt;br&gt;
&lt;br&gt;
        William A. Mahaffey III&lt;br&gt;
&lt;br&gt;
 ------------------------------&lt;u&gt;&lt;/u&gt;------------------------------&lt;u&gt;&lt;/u&gt;----------&lt;br&gt;
 &lt;br&gt;
        "The M1 Garand is without doubt the finest implement of war&lt;br&gt;
         ever devised by man."&lt;br&gt;
                           -- Gen. George S. Patton Jr.&lt;br&gt;
&lt;br&gt;
______________________________&lt;u&gt;&lt;/u&gt;_________________&lt;br&gt;
libvirt-users mailing list&lt;br&gt;
&lt;a href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt; &lt;a \
href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/&lt;u&gt;&lt;/u&gt;mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; \
&lt;/blockquote&gt;&lt;/p&gt;



</body></email><email><emailId>20110804095637</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-08-04 09:56:37-0400</timestampReceived><subject>[libvirt-users] ANNOUNCE: libvirt Perl bindings Sys::Virt 0.9.4 release</subject><body>

I am happy to announce a new release[1] of the libvirt Perl bindings,
Sys::Virt 0.9.4 is available for download:

  http://search.cpan.org/CPAN/authors/id/D/DA/DANBERR/Sys-Virt-0.9.4.tar.gz

Changes in this release

 - Add all new APIs in libvirt 0.9.4
 - Requires libvirt &gt;= 0.9.4
 - Add missing VIR_DUMP_* and VIR_MIGRATE_* constants
   from previous releases

The permanent link for the Sys::Virt package, where all historic releases
can be found, is

  http://search.cpan.org/dist/Sys-Virt/

Thanks to everyone who contributed to this release through testing, bug
reporting, patch submission, etc.

Regards,
Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110804141032</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-08-04 14:10:32-0400</timestampReceived><subject>Re: [libvirt-users] Custom storage pools/volumes</subject><body>

2011/7/29 Mohammed Naser &lt;mnaser@vexxhost.com&gt;:
&gt; Hello everyone,
&gt; 
&gt; We're currently working with using libvirt as an abstract API to make our dealings \
&gt; with other hypervisors far easier and faster, however, we have our own storage API \
&gt; that connects/disconnects and makes LUNs available over iSCSI with iSER. 
&gt; We would have loved to use a storage pool however our system implements a one \
&gt; target per LUN/VDI, therefore, we'd have to create a pool for each server.

Having as much pools as volumes is a bit unfortunate, but not a show
stopper, is it?

Regarding iSER and iSCSI there where some patch proposed on the list a
year ago, but nothing seems to have happened since then.

https://www.redhat.com/archives/libvir-list/2010-August/msg00031.html

&gt; We really would like to utilize the virStorageVolDownload / virStorageVolUpload API \
&gt; calls, however, it seems that those would only work if the storage volume is within \
&gt; a pool. 
&gt; Is there a way we could possibly define a storage volume without a pool or will we \
&gt; have to create a storage pool for each individual volume?

The storage API assumes that volumes are in pools.

-- 
Matthias Bolte
http://photron.blogspot.com


</body></email><email><emailId>20110804182600</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2011-08-04 18:26:00-0400</timestampReceived><subject>Re: [libvirt-users] Using libvirt with a preexisting network	infrastructure</subject><body>

On 07/29/2011 07:19 AM, Vegard Vesterheim wrote:
&gt; On Fri, 29 Jul 2011 10:15:09 +0100 Tom Hughes&lt;tom@compton.nu&gt;  wrote:
&gt;
&gt;&gt; - virt-manager should offer the bridges as options when you
&gt;&gt; create an interface and you just select the one you want.
&gt; I do not see my bridges as options in virt-manager, but when configuring
&gt; a network device for a VM, I can select "Specify shared device name" and
&gt; manually enter the name of an existing bridge device.
&gt;
&gt; It would be nice if virt-manager could present a menu of existing
&gt; devices, or alternatively, that one could define a network in libvirt
&gt; which simply refers to the preexisting bridge,

Done, and done. You just don't have a new enough version of virt-manager 
(for the first) or libvirt (for the second).

</body></email><email><emailId>20110804191327</emailId><senderName>Alphonse Hansel Anthony</senderName><senderEmail>alphonse.anthony@gmail.com</senderEmail><timestampReceived>2011-08-04 19:13:27-0400</timestampReceived><subject>[libvirt-users] Reg: Packaging format for LIBIVRT</subject><body>

Hi,

   I am looking for an available Open Source Packaging model for Libvirt,
similar to
OVF/OVA supported by Vmware.

The OVA model uses the manifest to define the resource requirements for the
virtual appliance
and the XML schema follows OVF.

Are there similar specification to include libvirt XML in a package along
with disk images/ISO... etc?

Any pointers in this regard would be useful.

Thanks,
Alphonse

[Attachment #3 (text/html)]

&lt;font color="#666666"&gt;&lt;font size="2"&gt;&lt;font face="verdana,sans-serif"&gt;Hi,&lt;br&gt;&lt;br&gt;   I \
am looking for an available Open Source Packaging model for Libvirt, similar to \
&lt;br&gt;OVF/OVA supported by Vmware. &lt;br&gt;&lt;br&gt;The OVA model uses the manifest to define \
the resource requirements for the virtual appliance&lt;br&gt;

and the XML schema follows OVF.&lt;br&gt;&lt;br&gt;Are there similar specification to include \
libvirt XML in a package along with disk images/ISO... etc?&lt;br&gt;&lt;br&gt;Any pointers in \
this regard would be useful.&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;Alphonse&lt;br&gt; &lt;/font&gt;&lt;/font&gt;&lt;/font&gt;



</body></email><email><emailId>20110806203429</emailId><senderName>Anatoliy Guskov</senderName><senderEmail>anatoliy.guskov@gmail.com</senderEmail><timestampReceived>2011-08-06 20:34:29-0400</timestampReceived><subject>[libvirt-users] Create volume wit libvirt API for Python</subject><body>

Please help! How create volume with libvirt API for python?

conn = libvirt.open(qemu:///system)
vol = libvirt.virStoragePool(conn)
conf_file = 'disk.xml'
f = open(conf_file)
xml = f.read()
pool = "default"
vol.createXML(pool,xml)

xml file disk.xml:
&lt;volume&gt;
&lt;name&gt;name.img&lt;/name&gt;
&lt;key&gt;/var/lib/libvirt/images/name.img&lt;/key&gt;
&lt;source&gt;
&lt;/source&gt;
&lt;capacity&gt;21474836480&lt;/capacity&gt;
&lt;allocation&gt;21474840576&lt;/allocation&gt;
&lt;target&gt;
&lt;path&gt;/var/lib/libvirt/images/name.img&lt;/path&gt;
&lt;format type='raw'/&gt;
&lt;/target&gt;
&lt;/volume&gt;

This script not work :-(

Thanks for help!

</body></email><email><emailId>20110808174803</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-08-08 17:48:03-0400</timestampReceived><subject>Re: [libvirt-users] XML file location</subject><body>

On 08/08/2011 11:28 AM, Jeff wrote:
&gt; Can anyone tell me how to change the default directory which stores the guest XML \
&gt; files?  I want to keep them with the guest image files on a shared NFS filesystem.

No, you don't want to share libvirt's internal xml files among multiple 
hosts.  Otherwise, two hosts will stomp on each other's edits, and 
likely corrupt your guest.

Rather, you want to store 'virsh dumpxml' output in a shared directory, 
and then 'virsh define' that shared definition into all hosts where you 
care about sharing common XML information.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


</body></email><email><emailId>20110809165143</emailId><senderName>Marc Haber</senderName><senderEmail>mh+libvirt-users@zugschlus.de</senderEmail><timestampReceived>2011-08-09 16:51:43-0400</timestampReceived><subject>Re: [libvirt-users] virt-manager - how to add /dev/mapper as a storage pool</subject><body>

On Tue, Aug 09, 2011 at 12:45:06PM -0400, Cole Robinson wrote:
&gt; Not really sure then, maybe this is something that libvirt should be
&gt; extended to handle. CCing libvirt devel list

Please note that I am only subscribed to libvirt-users, please Cc me
on replies.

There is also https://bugzilla.redhat.com/show_bug.cgi?id=710866 which
I filed back in June when I encountered this for the first time. I
accidentally filed the issue a second time yesterday but marked it as
a duplicate.

Greetings
Marc

-- 
-----------------------------------------------------------------------------
Marc Haber         | "I don't trust Computers. They | Mailadresse im Header
Mannheim, Germany  |  lose things."    Winona Ryder | Fon: *49 621 72739834
Nordisch by Nature |  How to make an American Quilt | Fax: *49 3221 2323190

</body></email><email><emailId>20110810141347</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-08-10 14:13:47-0400</timestampReceived><subject>Re: [libvirt-users] the naming convention libvirt names a block based storage volume</subject><body>

On Wed, Aug 10, 2011 at 10:02:41AM -0400, Dave Allan wrote:
&gt; On Wed, Aug 10, 2011 at 10:20:10AM +0100, Daniel P. Berrange wrote:
&gt; &gt; On Tue, Aug 09, 2011 at 03:28:50PM -0700, Yih-Herng Chuang wrote:
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; Seems like different libvirt versions generate a storage volume name in
&gt; &gt; &gt; different format.  We would like to learn how libvirt names a storage
&gt; &gt; &gt; volume under a block based storage pool.  So that we may properly extract
&gt; &gt; &gt; the LUN identifier out of the volume name for now and in the future.
&gt; &gt; &gt; 
&gt; &gt; &gt; On host A loaded with libvirt 0.8.7
&gt; &gt; &gt; # virsh vol-list SanPool1
&gt; &gt; &gt; Name Path
&gt; &gt; &gt; -----------------------------------------
&gt; &gt; &gt; unit:0:0:11 /dev/disk/by-id/wwn-0x600a0b800013071a000035ec4e32b832
&gt; &gt; 
&gt; &gt; This is the new naming scheme which we plan to stick with long
&gt; &gt; term. The key point of the naming scheme is that the name is
&gt; &gt; stable across reboots, and across login/logout of iSCSI targets.
&gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; On host B loaded with libvirt 0.8.1
&gt; &gt; &gt; 
&gt; &gt; &gt; # virsh vol-list SanPool1
&gt; &gt; &gt; Name Path
&gt; &gt; &gt; -----------------------------------------
&gt; &gt; &gt; 1.0.0.0 /dev/disk/by-id/wwn-0x60080e500017e1d40000d0b74d873b13
&gt; &gt; 
&gt; &gt; This was the old method, which was broken, because we should not
&gt; &gt; have been including the HBA number in the name (the leading '1'
&gt; &gt; here). The HBA number changes every time you login to an iSCSI
&gt; &gt; target, or everytime an NPIV HBA is created, so it resulted in
&gt; &gt; an unstable name which changed frequently
&gt; 
&gt; Since I was the one who came up with the original naming method, I
&gt; should probably chime in.  Note that although the HBA number changes
&gt; rapidly with iSCSI and NPIV, resulting as Dan points out in unstable
&gt; volume names, the other parts of the tuple are not guaranteed to
&gt; remain stable, either.  Changes to SAN topology will result in volume
&gt; name changes.  The only identifier you can depend on is the UUID of
&gt; the logical unit.

More specifically

 - path: assuming use of /dev/disk/by-id paths, this should be globally
   unique and stable across OS reboots &amp; for all hosts with the pool
   configured in the same way.

 - name: this is unique within the scope of the storage pool, and is
   stable across hosts &amp; reboots, provided the storage topology is
   not changed.

 - key: this is globally unique across all pools and all OS no matter
   what configuration is used.

For the latter, we use a number of strategies. For LVM we use the LVM
volume UUID, while for SCSI/iSCSI we use the SCSI lun's WWN


Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110811121233</emailId><senderName>"Stefan G. Weichinger"</senderName><senderEmail>lists@xunil.at</senderEmail><timestampReceived>2011-08-11 12:12:33-0400</timestampReceived><subject>Re: [libvirt-users] iscsi w/ libvirt</subject><body>

Am 11.08.2011 11:44, schrieb Daniel P. Berrange:

&gt; A storage pool maps to an iSCSI target.  LUNs in the target, appear as
&gt; storage volumes inside the pool. A storage volume is then assigned as a
&gt; single disk to a VM.
&gt; 
&gt;&gt; Could someone pls point me at some docs to make me understand?
&gt; 
&gt; These 4 blog posts should help your understanding.

Thanks a lot, yes, they did. I was close yesterday but only now I
correctly see the LUNs as volumes ...

on my way now!

Thanks for the helpful howtos.
Stefan


</body></email><email><emailId>20110812085810</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-08-12 08:58:10-0400</timestampReceived><subject>Re: [libvirt-users] virInitialize dumps core intermittently.</subject><body>

On Thu, Aug 11, 2011 at 11:36:51AM -0700, Sharad Mishra wrote:
&gt; Hi,
&gt; 
&gt;    I have a host with 6 VMs set to autostart. When this host reboots, it
&gt; starts libvirtd, pegasus cimom and libvirt-cim. It also restarts the VMs.
&gt; Intermittently we noticed a core during start up that points to the last
&gt; call made by libvirt-cim to "virInitialize". I am thinking that it is a
&gt; timing issue where virInitialize is called  while libvirt is trying to
&gt; autostart the VMs.

The virInitialize() API calls does very little, it merely sets up a few
internal data structures.

There is no attempt to connect to libvirtd until you call viConnectOpen,
so I can't see how virInitialize would race with libvirtd autostart.

To get more information, you really need to capture a stack trace of
the crash in GDB (or via Abrt)

Regards,
Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110812090004</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-08-12 09:00:04-0400</timestampReceived><subject>Re: [libvirt-users] virStoragePoolRefresh() returns before or after all new vols on path discovered?</subject><body>

On Thu, Aug 11, 2011 at 07:11:48PM -0700, Gareth S Bestor wrote:
&gt; Basically, does virStoragePoolRefresh() api 'block' until the pool has 
&gt; refreshed itself (eg added any/all new volumes found in the pool path) or 
&gt; can it return early before the refresh is fully 'done' ?

It is a blocking API call.

Regards,
Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110812142810</emailId><senderName>"William A. Mahaffey III"</senderName><senderEmail>wam@hiwaay.net</senderEmail><timestampReceived>2011-08-12 14:28:10-0400</timestampReceived><subject>Re: [libvirt-users] Problems setting up a VM ....</subject><body>

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta content="text/html; charset=ISO-8859-1"
      http-equiv="Content-Type"&gt;
  &lt;/head&gt;
  &lt;body bgcolor="#ffffff" text="#000000"&gt;
    On 08/10/11 10:00, William A. Mahaffey III wrote:
    &lt;blockquote cite="mid:4E429D23.1050306@hiwaay.net" type="cite"&gt;
      &lt;br&gt;
      &lt;br&gt;
      .... New to this list &amp; definitely new to virtualization :-/
      .... I am trying to setup a 64-bit CentOS 5.6 VM on a 64-bit FC14
      server host, all patched up as of a couple of weeks ago. uname -a
      on the host shows:
      &lt;br&gt;
      &lt;br&gt;
      &lt;br&gt;
      [wam@Q6600, CFD, 9:24:23am] 540 % uname -a
      &lt;br&gt;
      Linux Q6600 2.6.35.11-83.fc14.x86_64 #1 SMP Mon Feb 7 07:06:44 UTC
      2011 x86_64 x86_64 x86_64 GNU/Linux
      &lt;br&gt;
      [wam@Q6600, CFD, 9:52:43am] 541 %
      &lt;br&gt;
      &lt;br&gt;
      &lt;br&gt;
      I access the server by ssh on my LAN. I was working on this last
      Sunday &amp; got stuck, see below. I posted this question to a
      couple of other lists &amp; had no takers, so here I am here. The
      server runs in runlevel 3 &amp; has no gfx card onboard, so I am
      working from the command line. I had a couple of abortive attempts
      at setup, which got as far as initializing my disk storage for the
      VM, then the following:
      &lt;br&gt;
      &lt;br&gt;
      &lt;br&gt;
      &lt;br&gt;
      [root@Q6600:/etc, Sun Aug 07, 05:08 PM] 1339 # virt-install   -n
      CentOS-5.6-64bitVM  -r 2048  --arch=x86_64  --cpu
      core2duo,disable=vmx 
      --vcpus=1,maxvcpus=1,sockets=1,cores=2,threads=1  --os-type=linux 
      --os-variant=rhel5  --disk
      path=/home/VMs/CentOS.5.6-64bit-VM/disk.img,size=50  --cdrom
      /home/ISOs/CentOS-5.6/64bit/CentOS-5.6-x86_64-bin-DVD-1of2.iso 
      --autostart  --prompt
      &lt;br&gt;
      This will overwrite the existing path
      '/home/VMs/CentOS.5.6-64bit-VM/disk.img'
      &lt;br&gt;
      Do you really want to use this disk (yes or no)
      &lt;br&gt;
      yes
      &lt;br&gt;
      &lt;br&gt;
      Starting install...
      &lt;br&gt;
      Creating
      domain...             \
;              &amp; \
nbsp;             &amp;nb \
sp;               \
;              &amp; \
nbsp;              
  |    0 B     00:00
      &lt;br&gt;
      Gtk-Message: Failed to load module "pk-gtk-module":
      libpk-gtk-module.so: cannot open shared object file: No such file
      or directory
      &lt;br&gt;
      Gtk-Message: Failed to load module "canberra-gtk-module":
      libcanberra-gtk-module.so: cannot open shared object file: No such
      file or directory
      &lt;br&gt;
      &lt;br&gt;
      (virt-viewer:20165): Pango-WARNING **: failed to choose a font,
      expect ugly output. engine-type='PangoRenderFc', script='latin'
      &lt;br&gt;
      Domain installation still in progress. You can reconnect to
      &lt;br&gt;
      the console to complete the installation process.
      &lt;br&gt;
      [root@Q6600:/etc, Sun Aug 07, 05:14 PM] 1339 # virsh --connect
      qemu:///system
      &lt;br&gt;
      Welcome to virsh, the virtualization interactive terminal.
      &lt;br&gt;
      &lt;br&gt;
      Type:  'help' for help with commands
      &lt;br&gt;
             'quit' to quit
      &lt;br&gt;
      &lt;br&gt;
      virsh # list
      &lt;br&gt;
       Id Name                 \
State  &lt;br&gt;
      ----------------------------------
      &lt;br&gt;
       11 CentOS-5.6-64bitVM   running
      &lt;br&gt;
      &lt;br&gt;
      virsh # help
      &lt;br&gt;
      &lt;br&gt;
      &lt;br&gt;
      The install began OK, right after the 'Pango-WARNING' message, in
      a separate window, quite readable, started booting &amp; scrolling
      text past *FAST*, for about 15 sec., then hung, right after a line
      about 'serial port ....' (I couldn't click-&amp;-drag to capture
      text from the VM window, going from memory). I let it sit for
      about 5 min. to be sure it was really hung, then clicked the VM
      window out, whereupon the message about 'installation still in
      progress' &amp; the rest appeared. I poked around in virsh a bit
      as you can see, but couldn't figure anything out. I tried
      (re)connecting to the console of the VM &amp; that hung, I had to
      kill the virsh command from another window. I attach syslog output
      from the proceedings. I am *sure* this is pilot error, but I am
      stuck for now. Any assistance appreciated :-) ....
      &lt;br&gt;
      &lt;br&gt;
      &lt;br&gt;
      &lt;br&gt;
      &lt;pre wrap=""&gt;
&lt;fieldset class="mimeAttachmentHeader"&gt;&lt;/fieldset&gt;
_______________________________________________
libvirt-users mailing list
&lt;a class="moz-txt-link-abbreviated" \
href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt; &lt;a \
class="moz-txt-link-freetext" \
href="https://www.redhat.com/mailman/listinfo/libvirt-users"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;/pre&gt;
  &lt;/blockquote&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;br&gt;
    Update here, I did a full yum upgrade this A.M., &amp; rebooted. On
    a lark, I decided to retry the VM install and .... it worked. I am
    logged in there now, trying to get it setup the way I want, &amp; I
    am stuck on something new. The VM can't see anything on the host
    machine, let alone the rest of the network. I tried automounting the
    host's exports, &amp; I can see that a directory is exported, but
    can't view it. What I really need is to access the install ISO to
    install more software (gcc &amp; other libraries for compiling
    code), but I am stuck there for now .... Any assistance appreciated
    :-) ....&lt;br&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;pre class="moz-signature" cols="72"&gt;-- 

	William A. Mahaffey III

 ----------------------------------------------------------------------

	"The M1 Garand is without doubt the finest implement of war
	 ever devised by man."
                           -- Gen. George S. Patton Jr.
&lt;/pre&gt;
  &lt;/body&gt;
&lt;/html&gt;


</body></email><email><emailId>20110813140749</emailId><senderName>"William A. Mahaffey III"</senderName><senderEmail>wam@hiwaay.net</senderEmail><timestampReceived>2011-08-13 14:07:49-0400</timestampReceived><subject>Re: [libvirt-users] How do I disable auto-logout ....</subject><body>

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta content="text/html; charset=ISO-8859-1"
      http-equiv="Content-Type"&gt;
  &lt;/head&gt;
  &lt;body bgcolor="#ffffff" text="#000000"&gt;
    On 08/13/11 03:23, Carlos Campderrós wrote:
    &lt;blockquote
cite="mid:CAKitJ7Oo86Ch-FZ4f0Sm5Hxuiwr_3hJe0eOFS4LYHE5c-za2Uw@mail.gmail.com"
      type="cite"&gt;
      &lt;p&gt;Hi,&lt;/p&gt;
      &lt;p&gt;Maybe it's bash and its configurable timeout? Check $TMOUT
        variable, if it's non empty, it specifies a number of seconds to
        auto-logout when idle.&lt;/p&gt;
      &lt;blockquote type="cite"&gt;On Aug 13, 2011 4:53 AM, "William A.
        Mahaffey III" &lt;&lt;a moz-do-not-send="true"
          href="mailto:wam@hiwaay.net"&gt;wam@hiwaay.net&lt;/a&gt;&gt; wrote:&lt;br&gt;
        &lt;br&gt;
        &lt;br&gt;
        &lt;br&gt;
        .... I have a 64-bit CentOS 5.6 VM running on a 64-bit FC14
        host. I notice that it has an automatic logout feature after a
        period of idleness, see below:&lt;br&gt;
        &lt;br&gt;
        &lt;br&gt;
        [wam@centos-5, CFD, 5:52:45pm] 1183 % ll -tr LIST LIST.Update
        /usr/local/bin/P* /usr/local/bin/*WAM* ; ps -u wam -lf ; uname
        -a ; date&lt;br&gt;
        ls: No match.&lt;br&gt;
        F S UID        PID  PPID  C PRI  NI P \
   SZ:RSS  WCHAN  STIME  TTY         \
                 TIME CMD&lt;br&gt;
        5 S wam       2270  2266  0  15   0 * \
22540:1788 ?      15:48 ?         00:00:04 sshd: \
                wam@pts/0&lt;br&gt;
        0 S wam       2271  2270  0  15   0 * \
 3144:2720 rt_sig 15:48  pts/0    00:00:00 -tcsh&lt;br&gt;
        0 R wam      18249  2271  0  15   0 0 \
 2621:896  -      17:52  pts/0    00:00:00 ps -u \
wam -lf&lt;br&gt;  Linux centos-5.6-vm 2.6.18-238.el5 #1 SMP Thu Jan 13 15:51:15
        EST 2011 x86_64 x86_64 x86_64 GNU/Linux&lt;br&gt;
        Fri Aug 12 17:52:50 CDT 2011&lt;br&gt;
        [wam@centos-5, CFD, 5:52:50pm] 1184 % auto-logout&lt;br&gt;
        Connection to 192.168.122.213 closed.&lt;br&gt;
        [wam@Q6600, ~, 6:52:51pm] 1014 %&lt;br&gt;
        [wam@Q6600, ~, 9:40:49pm] 1014 %&lt;br&gt;
        [wam@Q6600, ~, 9:40:49pm] 1014 % ssh2 -l wam 192.168.122.213&lt;br&gt;
        Last login: Fri Aug 12 15:48:11 2011 from 192.168.122.1&lt;br&gt;
        [wam@centos-5, ~, 9:40:54pm] 1135 %&lt;br&gt;
        &lt;br&gt;
        &lt;br&gt;
        I checked man pages on both host &amp; VM, but came up blank. I
        have another box running CentOS 5.6 native &amp; it doesn't do
        this, so I suspect it is something w/ the VM environment. How do
        I disable that :-) ? Thanks in advance.&lt;br&gt;
        &lt;br&gt;
        &lt;br&gt;
        -- &lt;br&gt;
        &lt;br&gt;
               William A. Mahaffey III&lt;br&gt;
        &lt;br&gt;
         ----------------------------------------------------------------------&lt;br&gt;
  &lt;br&gt;
               "The M1 Garand is without doubt the finest \
implement of  war&lt;br&gt;
                ever devised by man."&lt;br&gt;
                              \
    -- Gen. George S. Patton Jr.&lt;br&gt;  &lt;br&gt;
        _______________________________________________&lt;br&gt;
        libvirt-users mailing list&lt;br&gt;
        &lt;a moz-do-not-send="true" href="mailto:libvirt-users@redhat.com"
          target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
        &lt;a moz-do-not-send="true"
          href="https://www.redhat.com/mailman/listinfo/libvirt-users"
          target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt;
  &lt;/blockquote&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;br&gt;
    Correct :-). Tcsh, actually, &amp; I got it turned off. I was
    curious because (so far) I only see/saw that on the VM, I have other
    boxen running Centos 5.6 raw &amp; I don't see that 'feature' there,
    is it specific to VM's somehow ? Thanks again.&lt;br&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;pre class="moz-signature" cols="72"&gt;-- 

	William A. Mahaffey III

 ----------------------------------------------------------------------

	"The M1 Garand is without doubt the finest implement of war
	 ever devised by man."
                           -- Gen. George S. Patton Jr.
&lt;/pre&gt;
  &lt;/body&gt;
&lt;/html&gt;


</body></email><email><emailId>20110813180407</emailId><senderName>Jeff</senderName><senderEmail>jwk1230@gmail.com</senderEmail><timestampReceived>2011-08-13 18:04:07-0400</timestampReceived><subject>Re: [libvirt-users] VNC ports</subject><body>

Thanks for the clarification. :)

On Aug 13, 2011, at 11:15 AM, Matthias Bolte wrote:

&gt; 2011/8/12 Jeff &lt;jwk1230@gmail.com&gt;:
&gt; &gt; I am needing to explicitly assign VNC ports to my virtual guests so that I can \
&gt; &gt; connect to them externally via a VNC client, and not virt-viewer.  Since I will \
&gt; &gt; have multiple KVM Hosts with access to the same shared storage (to facilitate \
&gt; &gt; migrations) I need to ensure I have unique VNC ports assigned to each guest so \
&gt; &gt; that I don't overlap somehow. 
&gt; &gt; I had planned to use a range of ports starting at 51000 for this purpose.  While \
&gt; &gt; it works to assign port 51001, for example, to a guest and connect via my VNC \
&gt; &gt; client, when I run 'virsh vncdisplay guestname' it gives me back a different \
&gt; &gt; number that is specified in the XML file: 
&gt; &gt; #virsh vncdisplay win2k8guest
&gt; &gt; &gt; 45101
&gt; &gt; 
&gt; &gt; #virsh dumpxml win2k8guest |grep vnc
&gt; &gt; &lt;graphics type='vnc' port='51001' autoport='no' /&gt;
&gt; &gt; 
&gt; &gt; 
&gt; &gt; Is there a logical reason for this that I'm not getting?  I know when I have the \
&gt; &gt; port set to 5907, for example, it returns something expected: 
&gt; &gt; #virsh vncdisplay win2k8guest
&gt; &gt; &gt; 7
&gt; &gt; 
&gt; &gt; But since I am likely going to need a good number of ports, I want to use a \
&gt; &gt; non-registered port range.  Any insights?
&gt; 
&gt; virsh vncdisplay gives you the VNC display number, not the VNC port
&gt; number. The common VNC port range starts at port 5900 and this maps to
&gt; VNC display 0. virsh vncdisplay gives you :7 for VNC port 5907 because
&gt; of this. This this is the expected behavior for virsh vncdisplay.
&gt; 
&gt; -- 
&gt; Matthias Bolte
&gt; http://photron.blogspot.com


</body></email><email><emailId>20110813220628</emailId><senderName>"William A. Mahaffey III"</senderName><senderEmail>wam@hiwaay.net</senderEmail><timestampReceived>2011-08-13 22:06:28-0400</timestampReceived><subject>[libvirt-users] How to setup routed networking in CLI ....</subject><body>





.... I have a 64-bit CentOS 5.6 VM running on a 64-bit FC14 host. I have 
the stock networking (NAT), but I need routed to be able to access other 
boxen on my LAN. I looked at the docs on the libvirtd website, but their 
example of how to setup routed networking is for the GUI, which doesn't 
work for me (text in buttons, etc. doesn't display, no gfx card on 
host). The man pages are pretty good, but lack pointers on the myriad 
options &amp; their interaction for networking &amp; are a bit short on 
examples. Any hints on doing that (setup routed networking under CLI) 
for me ? URL's, etc. ? TIA ....



-- 

	William A. Mahaffey III

  ----------------------------------------------------------------------

	"The M1 Garand is without doubt the finest implement of war
	 ever devised by man."
                            -- Gen. George S. Patton Jr.

</body></email><email><emailId>20110815034725</emailId><senderName>"William A. Mahaffey III"</senderName><senderEmail>wam@hiwaay.net</senderEmail><timestampReceived>2011-08-15 03:47:25-0400</timestampReceived><subject>[libvirt-users] Ongoing VM saga ....</subject><body>



.... I have a 64-bit CentOS 5.6 VM running on a 64-bit FC-14 host. I was 
originally using the stock NAT networking on the guest, which could 
access the host, but nothing else on the network. I eventually found 
some links on how to setup routed networking on the guest using a 
specifically setup bridge. I followed the example a bit too closely, 
bridging my eth0 interface, which is the one I nornally use to access 
the host over my LAN. So eth0 temporarily ceased functioning &amp; I had to 
undo my handiwork through the console on the host, which I virtually 
never use. I restarted networking manually a couple of time on the host, 
but eth0 was still fried. I then rebooted the host (still through the 
console) &amp; that went AOK, took about 5 min. &amp; all was well, eth0/SSH LAN 
access was back &amp; I logged back in &amp; tried to log into the VM to plot my 
next course of action &amp; .... The VM address had moved. I had set it up 
to use static addressing (modified the ifcfg-eth0 on the VM &amp; restarted 
networking, 2 or 3 times yesterday, installed compilers, etc. from the 
host, &amp; all was well until I messed around w/ trying the roll-your-own 
bridge this A.M.). Which brings me to the real question: How do I figure 
out the IP address the VM is using so I can login &amp; continue the 
festivities ? I found it yesterday through the VM (virt-viewer) console 
after setting up the VM the 1st time, but that doesn't work today either 
(black screen inside the viewer, no response to regular or ctrl-keys, 
etc.) :-/ .... 'virsh .... console' hangs virsh, etc. :-) .... Soooooo 
.... how do I recover that $&amp;#&amp;^$&amp;#* IP address for the VM :-) ? TIA ....


-- 

	William A. Mahaffey III

  ----------------------------------------------------------------------

	"The M1 Garand is without doubt the finest implement of war
	 ever devised by man."
                            -- Gen. George S. Patton Jr.

</body></email><email><emailId>20110815180003</emailId><senderName>David Knierim</senderName><senderEmail>dknierim@gmail.com</senderEmail><timestampReceived>2011-08-15 18:00:03-0400</timestampReceived><subject>[libvirt-users] How to send a break using "virsh console"??</subject><body>

I have a KVM guest running on CentOS 5.6 that is in a bad state. I
would like to dump the kernel information using magic-sysrq commands,
but I cannot figure out how to send a break on the virtual serial port
provided by "virsh console".

The guest is a standard install that will respond if I can send a
break on the virtual serial port.

Is it possible to send a break on the virtual serial port?

Thanks,
David

</body></email><email><emailId>20110815201005</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-08-15 20:10:05-0400</timestampReceived><subject>Re: [libvirt-users] Non-persistent disk</subject><body>

On 08/15/2011 02:01 PM, Xianqing Yu wrote:
&gt; Hi Libvirt team,
&gt;
&gt; I am trying to create a new domain from XML file by using libvirt. I
&gt; want this new domain using non-persistent disk as its disk.
&gt; Non-persistent disk means that when the domain is running, all the
&gt; modification would not be written to disk file. So next time, when you
&gt; boot VM from the same disk file, you would have a fresh disk. I check
&gt; the website but I could not find anything about this. I wonder if
&gt; libvirt support this function.

Yep, I'm working on it, and hope to have it in 0.9.5.  See my RFC here:

https://www.redhat.com/archives/libvir-list/2011-August/msg00552.html

You will basically call out:

&lt;devices&gt;
   &lt;disk ...&gt;
     ...
     &lt;transient/&gt;
   &lt;/disk&gt;
  ...

&gt; FYI, if I use KVM, I can use command "qemu-kvm -snapshot" to boot a VM
&gt; on non-persistent disk.

Unfortunately, that makes for a non-migrateable VM - so I'm working on 
something a bit more robust that stands a chance of creating a transient 
yet migrateable domain.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20110701134422</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-07-01 13:44:22-0400</timestampReceived><subject>Re: [libvirt-users] [PATCH] Use correct param names in Product getters</subject><body>


[assuming you meant this to go to virt-tools-list]

On 07/01/2011 07:22 AM, Zeeshan Ali (Khattak) wrote:
&gt; From: "Zeeshan Ali (Khattak)" &lt;zeeshanak@gnome.org&gt;
&gt; 
&gt; ---
&gt;  osinfo/osinfo_product.c |    6 +++---
&gt;  1 files changed, 3 insertions(+), 3 deletions(-)
&gt; 
&gt; diff --git a/osinfo/osinfo_product.c b/osinfo/osinfo_product.c
&gt; index 89e01bd..bbbcf67 100644
&gt; --- a/osinfo/osinfo_product.c
&gt; +++ b/osinfo/osinfo_product.c
&gt; @@ -158,15 +158,15 @@ void osinfo_product_add_related(OsinfoProduct *product, OsinfoProductRelationshi
&gt;  
&gt;  const gchar *osinfo_product_get_vendor(OsinfoProduct *prod)
&gt;  {
&gt; -    return osinfo_entity_get_param_value(OSINFO_ENTITY(prod), OSINFO_PRODUCT_PROP_NAME);
&gt; +    return osinfo_entity_get_param_value(OSINFO_ENTITY(prod), OSINFO_PRODUCT_PROP_VENDOR);
&gt;  }
&gt;  const gchar *osinfo_product_get_version(OsinfoProduct *prod)
&gt;  {
&gt; -    return osinfo_entity_get_param_value(OSINFO_ENTITY(prod), OSINFO_PRODUCT_PROP_NAME);
&gt; +    return osinfo_entity_get_param_value(OSINFO_ENTITY(prod), OSINFO_PRODUCT_PROP_VERSION);
&gt;  }
&gt;  const gchar *osinfo_product_get_short_id(OsinfoProduct *prod)
&gt;  {
&gt; -    return osinfo_entity_get_param_value(OSINFO_ENTITY(prod), OSINFO_PRODUCT_PROP_NAME);
&gt; +    return osinfo_entity_get_param_value(OSINFO_ENTITY(prod), OSINFO_PRODUCT_PROP_SHORT_ID);
&gt;  }
&gt;  const gchar *osinfo_product_get_name(OsinfoProduct *prod)
&gt;  {

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20110702183824</emailId><senderName>yeswanth swami</senderName><senderEmail>swamiyeswanth@gmail.com</senderEmail><timestampReceived>2011-07-02 18:38:24-0400</timestampReceived><subject>[libvirt-users] Unable to boot from a vdi image</subject><body>

Hi,
I am not able to boot a vdi image on virtualbox using libvirt .It keeps
showing me "Bootable medium not found". I have tried booting it manually
with virtualbox GUI and it boots without any problem. May there is some
problem with my libvirt domain XML . I also realized on some investigation
that it is not detecting the vdi image file as a hard disk (when i am
booting from a live cd)
A part of my libvirt domain XML is here:

&lt;os&gt;
&lt;type&gt;hvm&lt;/type&gt;
&lt;boot dev='hd'/&gt;
&lt;/os&gt;


------------------------------

&lt;devices&gt;
&lt;disk type='file' device='disk'&gt;
&lt;source file='disk.vdi'/&gt;
&lt;target dev='hdd' bus='ide'/&gt;
&lt;/disk&gt;
&lt;/devices&gt;


Thanks for replying
-- 
Cheers,
Yeswanth

[Attachment #3 (text/html)]

&lt;div&gt;&lt;span class="Apple-style-span" style="border-collapse: collapse; font-family: \
Arial, 'Liberation Sans', 'DejaVu Sans', sans-serif; font-size: 14px; \
line-height: 18px; "&gt;Hi,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;meta http-equiv="content-type" \
content="text/html; charset=utf-8"&gt;&lt;span class="Apple-style-span" \
style="border-collapse: collapse; font-family: Arial, 'Liberation Sans', \
'DejaVu Sans', sans-serif; font-size: 14px; line-height: 18px; "&gt;I am not \
able to boot a vdi image on virtualbox using libvirt .It keeps showing me \
"Bootable medium not found". I have tried booting it manually with \
virtualbox GUI and it boots without any problem. May there is some problem with my \
libvirt domain XML &lt;/span&gt;&lt;span class="Apple-style-span" style="border-collapse: \
collapse; font-family: Arial, 'Liberation Sans', 'DejaVu Sans', \
sans-serif; font-size: 14px; line-height: 18px; "&gt;. I also realized on some \
investigation that it is not detecting the vdi image file as a hard disk (when i am \
booting from a live cd)&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span class="Apple-style-span" \
style="border-collapse: collapse; font-family: Arial, 'Liberation Sans', \
'DejaVu Sans', sans-serif; font-size: 14px; line-height: 18px; "&gt;A part of my \
libvirt domain XML is here:&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span class="Apple-style-span" \
style="border-collapse: collapse; font-family: Arial, 'Liberation Sans', \
'DejaVu Sans', sans-serif; font-size: 14px; line-height: 18px; \
"&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span class="Apple-style-span" style="border-collapse: \
collapse; font-family: Arial, 'Liberation Sans', 'DejaVu Sans', \
sans-serif; font-size: 14px; line-height: 18px; "&gt;&lt;meta http-equiv="content-type" \
content="text/html; charset=utf-8"&gt;&lt;pre style="margin-top: 0px; margin-right: 0px; \
margin-bottom: 10px; margin-left: 0px; padding-top: 5px; padding-right: 5px; \
padding-bottom: 5px; padding-left: 5px; border-top-width: 0px; border-right-width: \
0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; \
border-color: initial; font-size: 14px; vertical-align: baseline; background-image: \
initial; background-attachment: initial; background-origin: initial; background-clip: \
initial; background-color: rgb(238, 238, 238); font-family: Consolas, Menlo, Monaco, \
'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', \
'Bitstream Vera Sans Mono', 'Courier New', monospace, serif; \
overflow-x: auto; overflow-y: auto; width: auto; max-height: 600px; \
background-position: initial initial; background-repeat: initial initial; "&gt; &lt;code \
style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; \
padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; \
border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; \
border-left-width: 0px; border-style: initial; border-color: initial; font-size: \
14px; vertical-align: baseline; background-image: initial; background-attachment: \
initial; background-origin: initial; background-clip: initial; background-color: \
rgb(238, 238, 238); font-family: Consolas, Menlo, Monaco, 'Lucida Console', \
'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans \
Mono', 'Courier New', monospace, serif; background-position: initial \
initial; background-repeat: initial initial; "&gt;&lt;os&gt;  \
&lt;type&gt;hvm&lt;/type&gt;  &lt;boot dev='hd'/&gt;           
&lt;/os&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span class="Apple-style-span" \
style="border-collapse: collapse; font-family: Arial, 'Liberation Sans', \
'DejaVu Sans', sans-serif; font-size: 14px; line-height: 18px; "&gt;&lt;br&gt; \
&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span class="Apple-style-span" style="border-collapse: collapse; \
font-family: Arial, 'Liberation Sans', 'DejaVu Sans', sans-serif; \
font-size: 14px; line-height: 18px; "&gt;&lt;meta http-equiv="content-type" \
content="text/html; charset=utf-8"&gt;&lt;hr style="border-top-width: 0px; \
border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; \
border-style: initial; border-color: initial; color: rgb(221, 221, 221); \
background-color: rgb(221, 221, 221); height: 1px; margin-bottom: 20px; "&gt; &lt;pre \
style="margin-top: 0px; margin-right: 0px; margin-bottom: 10px; margin-left: 0px; \
padding-top: 5px; padding-right: 5px; padding-bottom: 5px; padding-left: 5px; \
border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; \
border-left-width: 0px; border-style: initial; border-color: initial; font-size: \
14px; vertical-align: baseline; background-image: initial; background-attachment: \
initial; background-origin: initial; background-clip: initial; background-color: \
rgb(238, 238, 238); font-family: Consolas, Menlo, Monaco, 'Lucida Console', \
'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans \
Mono', 'Courier New', monospace, serif; overflow-x: auto; overflow-y: \
auto; width: auto; max-height: 600px; background-position: initial initial; \
background-repeat: initial initial; "&gt; &lt;code style="margin-top: 0px; margin-right: \
0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; \
padding-bottom: 0px; padding-left: 0px; border-top-width: 0px; border-right-width: \
0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; \
border-color: initial; font-size: 14px; vertical-align: baseline; background-image: \
initial; background-attachment: initial; background-origin: initial; background-clip: \
initial; background-color: rgb(238, 238, 238); font-family: Consolas, Menlo, Monaco, \
'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', \
'Bitstream Vera Sans Mono', 'Courier New', monospace, serif; \
background-position: initial initial; background-repeat: initial initial; \
"&gt;&lt;devices&gt; &lt;disk type='file' device='disk'&gt; 
&lt;source file='disk.vdi'/&gt; 
&lt;target dev='hdd' bus='ide'/&gt; 
&lt;/disk&gt;
&lt;/devices&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/span&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks for replying&lt;/div&gt;-- \
&lt;/div&gt;&lt;div&gt;Cheers,&lt;div&gt;Yeswanth&lt;/div&gt;&lt;br&gt; &lt;/div&gt;



</body></email><email><emailId>20110702212314</emailId><senderName>negar behinaeen</senderName><senderEmail>negar.bihe@gmail.com</senderEmail><timestampReceived>2011-07-02 21:23:14-0400</timestampReceived><subject>[libvirt-users] Helping on libvirt</subject><body>

*Writting myVirt*
------------------------------
Dear all,
I'm new in libvirt. I would be glad if you help me.


I want to write a program for controlling all libvirt servers named
"MYVIRT".
The libvirtd works as fallow:
{ CLIENT } ---------------------&gt; { SERVER A }
 |
 |
 ------------------------------&gt; { SERVER B }

Now, I want to place MYVIRT between client and libvirtd servers. By calling
a command, MYVIRT should execute the command for all servers.


{ CLIENT }
 |
 |
{ MYVIRT } ---------------------&gt; { SERVER A }
 |
 |
 ------------------------------&gt; { SERVER B }

The client softwares for libvirtd are virsh and virt-manager. Now I want
them to connect to MYVIRT and look it as a libvirtd server.

Would you please guide me for connecting to MYVIRT through virsh and execute
a command on all servers?

[Attachment #3 (text/html)]

&lt;div class="smallfont"&gt;
				
				&lt;strong&gt;Writting myVirt&lt;/strong&gt;
			&lt;/div&gt;
			&lt;hr style="color:#FFFFFF; background-color:#FFFFFF" size="1"&gt;
			
		


		
		
		&lt;div class="vbclean_msgtext" id="post_message_11004423"&gt;Dear all, &lt;br&gt;
I'm new in libvirt. I would be glad if you help me.&lt;br&gt;
 &lt;br&gt;
&lt;br&gt;
&lt;font face="Calibri"&gt;I want to write a program for controlling all libvirt servers \
named "MYVIRT". &lt;/font&gt;&lt;br&gt;  &lt;font face="Calibri"&gt;The libvirtd works as \
fallow:&lt;/font&gt;&lt;br&gt;  &lt;font face="Calibri"&gt;{ CLIENT }  ---------------------&gt; { \
SERVER A }&lt;/font&gt;&lt;br&gt;  &lt;font face="Calibri"&gt;       |&lt;/font&gt;&lt;br&gt;
  &lt;font face="Calibri"&gt;       |&lt;/font&gt;&lt;br&gt;
  &lt;font face="Calibri"&gt;       ------------------------------&gt; { SERVER B \
}&lt;/font&gt;&lt;br&gt;  &lt;br&gt;
  &lt;font face="Calibri"&gt;Now, I want to place MYVIRT between client and 
libvirtd servers. By calling a command, MYVIRT should execute the 
command for all servers.&lt;/font&gt;&lt;br&gt;
  &lt;br&gt;
  &lt;br&gt;
  &lt;font face="Calibri"&gt;{ CLIENT }&lt;/font&gt;&lt;br&gt;
  &lt;font face="Calibri"&gt;       |&lt;/font&gt;&lt;br&gt;
  &lt;font face="Calibri"&gt;       |&lt;/font&gt;&lt;br&gt;
  &lt;font face="Calibri"&gt;{ MYVIRT }  ---------------------&gt; { SERVER A }&lt;/font&gt;&lt;br&gt;
  &lt;font face="Calibri"&gt;       |&lt;/font&gt;&lt;br&gt;
  &lt;font face="Calibri"&gt;       |&lt;/font&gt;&lt;br&gt;
  &lt;font face="Calibri"&gt;       ------------------------------&gt; { SERVER B \
}&lt;/font&gt;&lt;br&gt;  &lt;br&gt;
  &lt;font face="Calibri"&gt;The client softwares for libvirtd are virsh and 
virt-manager. Now I want them to connect to MYVIRT and look it as a 
libvirtd server.&lt;/font&gt;&lt;br&gt;
  &lt;br&gt;
  &lt;font face="Calibri"&gt;Would you please guide me for connecting to MYVIRT through \
virsh and execute a command on all servers?&lt;/font&gt;&lt;/div&gt;



</body></email><email><emailId>20110705054404</emailId><senderName>zhuxuegang</senderName><senderEmail>zhuxuegang@360buy.com</senderEmail><timestampReceived>2011-07-05 05:44:04-0400</timestampReceived><subject>[libvirt-users] Xm driver only supports modifying persistent config.</subject><body>

[Attachment #2 (text/plain)]

Dear all.
I use libvirt to attach a volume to xen's guest VM,but l got the following message:

Attached device: /dev/sdb
[Mon Jul  4 09:18:58 2011][006640][EUCAERROR ] libvirt: Requested operation is not \
valid: Xm driver only supports modifying persistent config (code=55) [Mon Jul  4 \
09:18:58 2011][006640][EUCAERROR ] AttachVolume() failed (err=-1) XML=&lt;disk \
type='block'&gt;&lt;driver name='phy'/&gt;&lt;source dev='/dev/sdb'/&gt;&lt;target dev='sdae'/&gt;&lt;/d isk&gt;
[Mon Jul  4 09:18:58 2011][006640][EUCAERROR ] ERROR: doAttachVolume() failed error=1
[Mon Jul  4 09:19:02 2011][006640][EUCADEBUG ] doDescribeResource() invoked
[Mon Jul  4 09:19:02 2011][006640][EUCADEBUG ] doDescribeInstances() invoked

any help will be greatly appreciated.
Thank you in advance...

2011-07-05



zhuxuegang


[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;
&lt;HTML&gt;&lt;HEAD&gt;
&lt;STYLE type=text/css&gt; &lt;!--@import url(D:\Program \
Files\Netease\网易闪电邮\\data\scrollbar.css); --&gt;&lt;/STYLE&gt;

&lt;META content="text/html; charset=utf-8" http-equiv=Content-Type&gt;
&lt;STYLE&gt;BLOCKQUOTE{margin-Top: 0px; margin-Bottom: 0px; margin-Left: 2em}; \
OL, UL{margin-Top: 0px; margin-Bottom: 0px}; 									p{margin-Top:0em; \
margin-Bottom:0px; padding:0px;}; 									body{FONT-SIZE:12pt; \
FONT-FAMILY:宋体,serif;}; 									&lt;/STYLE&gt;

&lt;META name=GENERATOR content="MSHTML 8.00.7600.16385"&gt;&lt;BASE 
target=_blank&gt;&lt;/HEAD&gt;
&lt;BODY 
style="LINE-HEIGHT: 1.3; BORDER-RIGHT-WIDTH: 0px; MARGIN: 12px; BORDER-TOP-WIDTH: \
0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px"  marginheight="0" \
marginwidth="0"&gt;&lt;STATIONERY&gt; &lt;DIV&gt;
&lt;DIV&gt;&lt;FONT color=#000000 size=3 face=宋体&gt;Dear all.&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;I use libvirt to attach a volume to xen's guest VM,but l got the following 
message:&lt;/DIV&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;Attached device: /dev/sdb&lt;BR&gt;[Mon Jul  4 09:18:58 
2011][006640][EUCAERROR ] libvirt: Requested operation is not valid: Xm driver 
only supports modifying persistent config (code=55)&lt;BR&gt;[Mon Jul  4 09:18:58 
2011][006640][EUCAERROR ] AttachVolume() failed (err=-1) XML=&lt;disk 
type='block'&gt;&lt;driver name='phy'/&gt;&lt;source 
dev='/dev/sdb'/&gt;&lt;target dev='sdae'/&gt;&lt;/d&lt;BR&gt;isk&gt;&lt;BR&gt;[Mon Jul  
4 09:18:58 2011][006640][EUCAERROR ] ERROR: doAttachVolume() failed 
error=1&lt;BR&gt;[Mon Jul  4 09:19:02 2011][006640][EUCADEBUG ] 
doDescribeResource() invoked&lt;BR&gt;[Mon Jul  4 09:19:02 
2011][006640][EUCADEBUG ] doDescribeInstances() invoked&lt;/DIV&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT color=#000000 size=3 face=宋体&gt;
&lt;DIV&gt;any help will be greatly appreciated.&lt;/DIV&gt;
&lt;DIV&gt;Thank you in advance...&lt;/DIV&gt;
&lt;DIV&gt; &lt;/DIV&gt;&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV align=left&gt;&lt;FONT color=#c0c0c0 size=2 
face=Verdana&gt;2011-07-05&lt;/FONT&gt;&lt;/DIV&gt;&lt;FONT size=2 face=Verdana&gt;
&lt;HR style="WIDTH: 122px; HEIGHT: 2px" id=SignNameHR align=left SIZE=2&gt;

&lt;DIV&gt;&lt;FONT color=#c0c0c0 size=2 face=Verdana&gt;&lt;SPAN 
id=_FlashSignName&gt;zhuxuegang&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/DIV&gt;&lt;/FONT&gt;&lt;/DIV&gt;&lt;/STATIONERY&gt;&lt;/BODY&gt;&lt;/HTML&gt;




</body></email><email><emailId>20110705173027</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-07-05 17:30:27-0400</timestampReceived><subject>Re: [libvirt-users] Associating a statefile with an image</subject><body>


On 07/05/2011 11:20 AM, sethuraman subbiah wrote:
&gt; Hi Eric, 

[your mailer is not wrapping long lines, which is making this harder for
me to reply to; also, top-posting is not the preferred behavior on this
list]

&gt; 
&gt; I tried editing the xml in statefile
...
&gt; I think libvirt (qemu-driver) saves the length of the xml file along with its header,

Exactly.  This is the case, and if you alter the length of the embedded
xml, you must also update the binary position that encodes the length of
the embedded xml.  You ended up invalidating the state file.  Libvirt
should probably do a better job at erroring out rather than booting from
scratch when it detects a corrupted state file, but it also lends
credence to my argument that libvirt should provide an API that makes it
possible to edit the XML embedded within a system checkpoint state file.

[P.S. At this point, we have to be careful with terminology.  The qemu
developers are introducing 'snapshot' commands which save the state of
just a disk image, whereas their 'savevm' monitor command creates a
'checkpoint', or combination of memory and disk state used to restore a
running VM from that checkpoint - what you called a statefile.  So it
can be a bit confusing that libvirt's current virDomainSnapshot API
manages checkpoints, although I hope to enhance it to also handle
snapshots.]

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20110706140835</emailId><senderName>Nikita A Menkovich</senderName><senderEmail>menkovich@gmail.com</senderEmail><timestampReceived>2011-07-06 14:08:35-0400</timestampReceived><subject>[libvirt-users] SSH console for qemu</subject><body>

Hello,

I'm using qemu with libvirt and I want to create SSH emergency console
to linux/unix guests, same way as it is realized in qemu VNC.
Maybe someone could help me to determine a place to dive in this question.

I think the best way to make it - extend qemu API. But if this could
be made with libvirt - this will be also fine.

-- 
Nikita A Menkovich
http://libc6.org/
JID: menkovich@gmail.com

</body></email><email><emailId>20110707065524</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2011-07-07 06:55:24-0400</timestampReceived><subject>Re: [libvirt-users] Guest-networking: Two subnets = Guests cannot connect to the other subnet</subject><body>

On 07/06/2011 06:02 AM, mailinglists@florian-kaiser.net wrote:
&gt; Hello list,
&gt;
&gt; We have KVM setup using libvirt (0.9.0) as configuration device on a Debian
&gt; Squeeze Host. Networking is done in routed bridge mode and we have two
&gt; different subnets, as well as one main ip. Subnets get routed to the main ip
&gt; (this is done by our provider).
&gt;
&gt; Network on hosts are done like this:
&gt; &lt;network&gt;
&gt;    &lt;name&gt;subnet_1&lt;/name&gt;
&gt;    &lt;uuid&gt;7c60990d-ab31-c4a5-cd2b-5ce4c7c61d38&lt;/uuid&gt;
&gt;    &lt;forward dev='eth0' mode='route'/&gt;
&gt;    &lt;bridge name='virtbridge1' stp='off' delay='0' /&gt;
&gt;    &lt;mac address='52:54:00:4D:83:2A'/&gt;
&gt;    &lt;ip address='xx.xx.240.121' netmask='255.255.255.248'&gt;
&gt;    &lt;/ip&gt;
&gt; &lt;/network&gt;
&gt;
&gt; &lt;network&gt;
&gt;    &lt;name&gt;subnet_2&lt;/name&gt;
&gt;    &lt;uuid&gt;7c60990d-ab31-c4a5-cd2b-5ce4c7c61d38&lt;/uuid&gt;
&gt;    &lt;forward dev='eth0' mode='route'/&gt;
&gt;    &lt;bridge name='virtbridge1' stp='off' delay='0' /&gt;
&gt;    &lt;mac address='52:54:00:4D:83:2A'/&gt;
&gt;    &lt;ip address='xx.xx.240.200' netmask='255.255.255.248'&gt;
&gt;    &lt;/ip&gt;
&gt; &lt;/network&gt;
&gt;
&gt; Routing on host
&gt; Kernel IP routing table
&gt; Destination     Gateway         Genmask         Flags Metric Ref    Use
&gt; Iface
&gt; xx.xx.122.33     0.0.0.0         255.255.255.255 UH    0      0        0
&gt; eth0
&gt; xx.xx.240.120   0.0.0.0         255.255.255.248 U     0      0        0
&gt; virtbridge1
&gt; xx.xx.239.200   0.0.0.0         255.255.255.248 U     0      0        0
&gt; virtbridge2
&gt; 0.0.0.0         xx.xx.122.33     0.0.0.0         UG    0      0        0
&gt; eth0
&gt;
&gt;
&gt; Guests get this:
&gt; &lt;interface type='network'&gt;
&gt;    &lt;mac address='de:ad:b6:83:85:5b'/&gt;
&gt;    &lt;source network='subnet_1'/&gt;
&gt;    &lt;model type='virtio'/&gt;
&gt;    &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03'
&gt; function='0x0'/&gt;
&gt; &lt;/interface&gt;
&gt;
&gt; Guests put this into interfaces:
&gt; iface eth0 inet static
&gt;          address xx.xx.239.202
&gt;          netmask 255.255.255.248
&gt;          gateway xx.xx.239.201
&gt;
&gt; Guest routing
&gt; Kernel IP routing table
&gt; Destination     Gateway         Genmask         Flags Metric Ref    Use
&gt; Iface
&gt; xx.xx.239.200   0.0.0.0         255.255.255.248 U     0      0        0 eth0
&gt; 0.0.0.0         xx.xx.239.201   0.0.0.0         UG    0      0        0 eth0
&gt; 	
&gt; 	
&gt; Everything seemed to work just fine, that is: Guests could connect
&gt; - to host,
&gt; - to internet
&gt; - to other virtual maschines in the same subnet - all vice-versa.
&gt;
&gt; Internet can connect to any guest and our host can connect to any guest,
&gt; too.
&gt;
&gt; Then, we needed one guest to connect to a guest from the other subnet. And
&gt; this does not work, what I get follows:
&gt;
&gt; PING xx.xx.240.122 (xx.xx.240.122) 56(84) bytes of data.
&gt; &gt; From xx.xx.239.201 icmp_seq=1 Destination Port Unreachable
&gt; &gt; From xx.xx.239.201 icmp_seq=2 Destination Port Unreachable
&gt;
&gt; Note, that I can ping the other subnets gateway just fine! But I cannot
&gt; connect to any of the other subnet IPs.
&gt;
&gt; I believe this is just a routing problem, but I cannot figure out what route
&gt; to add where. Please ask if you need any more information.

(I think you are the same person who asked about this on IRC later in 
the day. Still, for archival purposes, here is an answer):

By design, libvirt's virtual networks can only be reached from the host 
itself. The only other connections allowed are outgoing connections frmo 
the virtual network. This applies to communications between two virtual 
networks on the same host - the network with the initiating guest will 
allow an outbound connection, but the the network with the receiving 
host will not allow this (from its point of view) inbound connection.

If you want the guests on two subnets to be able to talk to each other, 
there are two possible solutions:

1) create host bridges yourself, outside of libvirt. You'll want to 
assign an IP address to each bridge, but not bind any physical interface 
to it - let the host's IP stack handle the forwarding of the traffic. 
You'll also need to add some iptables rules.

2) define multiple IP addresses (each address on a different subnet) on 
a single libvirt virtual network. The examples in the domain XML 
document section of the website give examples of this. The only caveat 
is that only the 1st IP address can have a dhcp server associated with 
it, so guests that will be on the other subnets connected to this same 
bridge will need to have their IP addresses statically configured.

</body></email><email><emailId>20110707205508</emailId><senderName>Nikita A Menkovich</senderName><senderEmail>menkovich@gmail.com</senderEmail><timestampReceived>2011-07-07 20:55:08-0400</timestampReceived><subject>Re: [libvirt-users] [Qemu-devel] SSH console for qemu</subject><body>

I want to launch very minimal ssh daemon (that listen on selected port
and allows only input commands and read output from console)  that
launch when guest started, and this not run inside a guest.
Thanks to the link for patch

On 7 July 2011 22:19, Eric Blake &lt;eblake@redhat.com&gt; wrote:
&gt; On 07/07/2011 02:36 AM, Nikita A Menkovich wrote:
&gt;&gt; Seems no, I think, that the best way is running some kind of ssh
&gt;&gt; daemon, that connects to console (/dev/vcsa1 for example), that listen
&gt;&gt; on port and send to output console events on boot, and allow to work
&gt;&gt; with server with simple ssh client. Also important feature will be
&gt;&gt; saving history of output.
&gt;
&gt; If you're trying to capture boot events, then you have to have an SGA
&gt; (serial graphics adaptor) capable BIOS that can output boot events on
&gt; the serial console.  There's recent work underway to add that feature to
&gt; qemu, and to expose that feature from libvirt:
&gt;
&gt; https://www.redhat.com/archives/libvir-list/2011-July/msg00174.html
&gt;
&gt; Setting up an ssh daemon in the guest is too late - the daemon won't be
&gt; set up until the guest has already booted, so there's no way to have
&gt; that daemon forward boot messages back to the host in a timely manner.
&gt; I think you're trying too hard - 'virsh console' really is the way to
&gt; read all messages output to the guest's console, and your only missing
&gt; piece is that you also appear to want BIOS to output to the console.
&gt;
&gt; --
&gt; Eric Blake   eblake@redhat.com    +1-801-349-2682
&gt; Libvirt virtualization library http://libvirt.org
&gt;
&gt;



-- 
Nikita A Menkovich
http://libc6.org/
JID: menkovich@gmail.com
Tel: +7 (921) 423-96-48

</body></email><email><emailId>20110702155904</emailId><senderName>sethuraman subbiah</senderName><senderEmail>sethusubbiah@gmail.com</senderEmail><timestampReceived>2011-07-02 15:59:04-0400</timestampReceived><subject>[libvirt-users] Associating a statefile with an image</subject><body>

Hi ,

I am trying to perform offline migration (i.e) Create an incremental image using the \
qcow format, transfer the vm memory state to a state fie.Use the image and statefile \
together as a template. Now create a new vm using the template. I can successfully do \
it using the following commands : 

Save phase :
stop
migrate "exec:gzip -c &gt; STATEFILE.gz"
qemu-img 
qemu-img create -b BASE_img -f qcow2 INCRE_img

Restore phase :
qemu-kvm -m 1024 -hda INCRE_img -incoming "exec: gzip -c -d STATEFILE.gz"

And it works fine. But I am not able to find the vm with virt-manager or other \
libvirt based tools.

If I use : 
virsh save &lt;dom_id&gt; STATEFILE

I can restore using "virsh restore STATEFILE" but I want to associate this with the \
incremental image that I created, but I dont know how. I think it saves the existing \
vm's xml file along with the STATEFILE, thus I am not able to change the disk image \
to the incremental image.

Thus ,
1. Either I should find a way to make vms created using qemu-kvm appear in \
libvirt-based tools.

OR 

2. Find a way to associate the virsh save STATEFILE with a incremental image. 

Any help or hint with respect to these will be very helpful. I am try to do cloning \
with minimal cost. This takes only 25 seconds ( to create STATEFILE) and creating \
incremental image is instantatenous . But I want to use the vm monitoring code based \
on libvirt. And it makes life difficult. 

Thanks for your help. 

-
Regards,
Sethuraman Subbiah

Graduate Student - NC state University
M.S in Computer Science


[Attachment #3 (unknown)]

&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body style="word-wrap: break-word; -webkit-nbsp-mode: space; \
-webkit-line-break: after-white-space; "&gt;&lt;meta charset="utf-8"&gt;&lt;span \
class="Apple-style-span" style="font-family: Arial, Helvetica, 'Nimbus Sans L', \
sans-serif; font-size: 13px; -webkit-text-size-adjust: none; line-height: 15px; "&gt;Hi \
,&lt;br&gt;&lt;br&gt;I am trying to perform offline migration (i.e) Create an incremental image \
using the qcow format, transfer the vm memory state to a state fie.Use the image and \
statefile together as a template. Now create a new vm using the template. I can \
successfully do it using the following commands : &lt;br&gt;&lt;br&gt;&lt;u&gt;Save phase \
:&lt;/u&gt;&lt;br&gt;stop&lt;br&gt;migrate "exec:gzip -c &gt; \
STATEFILE.gz"&lt;br&gt;qemu-img &lt;br&gt;qemu-img create -b BASE_img -f qcow2 \
INCRE_img&lt;br&gt;&lt;br&gt;&lt;u&gt;Restore phase :&lt;/u&gt;&lt;br&gt;qemu-kvm -m 1024 -hda INCRE_img -incoming \
"exec: gzip -c -d STATEFILE.gz"&lt;br&gt;&lt;br&gt;And it works fine. But I am not able to find \
the vm with virt-manager or other libvirt based tools.&lt;br&gt;&lt;br&gt;If I use \
: &lt;br&gt;virsh save &lt;dom_id&gt; STATEFILE&lt;br&gt;&lt;br&gt;I can restore using "virsh \
restore STATEFILE" but I want to associate this with the incremental image that I \
created, but I dont know how. I think it saves the existing vm's xml file along \
with the STATEFILE, thus I am not able to change the disk image to the incremental \
image.&lt;br&gt;&lt;br&gt;Thus ,&lt;br&gt;1. Either I should find a way to make vms created using \
qemu-kvm appear in libvirt-based tools.&lt;br&gt;&lt;br&gt;OR &lt;br&gt;&lt;br&gt;2. Find a way to \
associate the virsh save STATEFILE with a incremental image. &lt;br&gt;&lt;br&gt;Any help or \
hint with respect to these will be very helpful. I am try to do cloning with minimal \
cost. This takes only 25 seconds ( to create STATEFILE) and creating incremental \
image is instantatenous . But I want to use the vm monitoring code based on libvirt. \
And it makes life difficult. &lt;br&gt;&lt;br&gt;Thanks for your \
help. &lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;div&gt; &lt;span class="Apple-style-span" \
style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; \
font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: \
normal; line-height: normal; orphans: 2; text-align: auto; text-indent: 0px; \
text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; \
-webkit-border-horizontal-spacing: 0px; -webkit-border-vertical-spacing: 0px; \
-webkit-text-decorations-in-effect: none; -webkit-text-size-adjust: auto; \
-webkit-text-stroke-width: 0px; font-size: medium; "&gt;-&lt;br&gt;Regards,&lt;br&gt;Sethuraman \
Subbiah&lt;br&gt;&lt;br&gt;Graduate Student - NC state University&lt;br&gt;M.S in Computer \
Science&lt;br&gt;&lt;br&gt;&lt;/span&gt; &lt;/div&gt;
&lt;br&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20110706100251</emailId><senderName></senderName><senderEmail>mailinglists@florian-kaiser.net</senderEmail><timestampReceived>2011-07-06 10:02:51-0400</timestampReceived><subject>[libvirt-users] Guest-networking: Two subnets = Guests cannot connect to the other subnet</subject><body>

Hello list,

We have KVM setup using libvirt (0.9.0) as configuration device on a Debian
Squeeze Host. Networking is done in routed bridge mode and we have two
different subnets, as well as one main ip. Subnets get routed to the main ip
(this is done by our provider).

Network on hosts are done like this:
&lt;network&gt;
  &lt;name&gt;subnet_1&lt;/name&gt;
  &lt;uuid&gt;7c60990d-ab31-c4a5-cd2b-5ce4c7c61d38&lt;/uuid&gt;
  &lt;forward dev='eth0' mode='route'/&gt;
  &lt;bridge name='virtbridge1' stp='off' delay='0' /&gt;
  &lt;mac address='52:54:00:4D:83:2A'/&gt;
  &lt;ip address='xx.xx.240.121' netmask='255.255.255.248'&gt;
  &lt;/ip&gt;
&lt;/network&gt;

&lt;network&gt;
  &lt;name&gt;subnet_2&lt;/name&gt;
  &lt;uuid&gt;7c60990d-ab31-c4a5-cd2b-5ce4c7c61d38&lt;/uuid&gt;
  &lt;forward dev='eth0' mode='route'/&gt;
  &lt;bridge name='virtbridge1' stp='off' delay='0' /&gt;
  &lt;mac address='52:54:00:4D:83:2A'/&gt;
  &lt;ip address='xx.xx.240.200' netmask='255.255.255.248'&gt;
  &lt;/ip&gt;
&lt;/network&gt;

Routing on host
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use
Iface
xx.xx.122.33     0.0.0.0         255.255.255.255 UH    0      0        0
eth0
xx.xx.240.120   0.0.0.0         255.255.255.248 U     0      0        0
virtbridge1
xx.xx.239.200   0.0.0.0         255.255.255.248 U     0      0        0
virtbridge2
0.0.0.0         xx.xx.122.33     0.0.0.0         UG    0      0        0
eth0


Guests get this:
&lt;interface type='network'&gt;
  &lt;mac address='de:ad:b6:83:85:5b'/&gt;
  &lt;source network='subnet_1'/&gt;
  &lt;model type='virtio'/&gt;
  &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03'
function='0x0'/&gt;
&lt;/interface&gt;

Guests put this into interfaces:
iface eth0 inet static
        address xx.xx.239.202
        netmask 255.255.255.248
        gateway xx.xx.239.201

Guest routing
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use
Iface
xx.xx.239.200   0.0.0.0         255.255.255.248 U     0      0        0 eth0
0.0.0.0         xx.xx.239.201   0.0.0.0         UG    0      0        0 eth0
	
	
Everything seemed to work just fine, that is: Guests could connect 
- to host, 
- to internet
- to other virtual maschines in the same subnet - all vice-versa. 

Internet can connect to any guest and our host can connect to any guest,
too.

Then, we needed one guest to connect to a guest from the other subnet. And
this does not work, what I get follows:

PING xx.xx.240.122 (xx.xx.240.122) 56(84) bytes of data.
&gt;From xx.xx.239.201 icmp_seq=1 Destination Port Unreachable
&gt;From xx.xx.239.201 icmp_seq=2 Destination Port Unreachable

Note, that I can ping the other subnets gateway just fine! But I cannot
connect to any of the other subnet IPs.

I believe this is just a routing problem, but I cannot figure out what route
to add where. Please ask if you need any more information.

</body></email><email><emailId>20110706152716</emailId><senderName>Stefan Hajnoczi</senderName><senderEmail>stefanha@gmail.com</senderEmail><timestampReceived>2011-07-06 15:27:16-0400</timestampReceived><subject>Re: [libvirt-users] [Qemu-devel] SSH console for qemu</subject><body>

On Wed, Jul 6, 2011 at 3:08 PM, Nikita A Menkovich &lt;menkovich@gmail.com&gt; wrote:
&gt; I'm using qemu with libvirt and I want to create SSH emergency console
&gt; to linux/unix guests, same way as it is realized in qemu VNC.
&gt; Maybe someone could help me to determine a place to dive in this question.
&gt;
&gt; I think the best way to make it - extend qemu API. But if this could
&gt; be made with libvirt - this will be also fine.

Serial console and the "virsh console" command?

Stefan

</body></email><email><emailId>20110707235209</emailId><senderName>Jatin Kumar</senderName><senderEmail>jatin.iitdelhi@gmail.com</senderEmail><timestampReceived>2011-07-07 23:52:09-0400</timestampReceived><subject>[libvirt-users] Changing path of VM configuration files</subject><body>

Hello,
I am using shared storage and i want to keep all the configuration files of
vms of different hosts in one single location (on shared storage).
Is there a way i can change the default path=/etc/libvirt/qemu/&lt;VMName&gt;.xml
to something else.
I looked into libvirtd.conf and qemu.conf but could not find any such thing.

--
Jatin

[Attachment #3 (text/html)]

Hello,&lt;div&gt;I am using shared storage and i want to keep all the configuration files \
of vms of different hosts in one single location (on shared storage).&lt;/div&gt;&lt;div&gt;Is \
there a way i can change the default path=/etc/libvirt/qemu/&lt;VMName&gt;.xml to \
something else.&lt;/div&gt;

&lt;div&gt;I looked into libvirtd.conf and qemu.conf but could not find any such \
thing.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;--&lt;/div&gt;&lt;div&gt;Jatin&lt;/div&gt;



</body></email><email><emailId>20110710212044</emailId><senderName>Dale Amon</senderName><senderEmail>amon@vnl.com</senderEmail><timestampReceived>2011-07-10 21:20:44-0400</timestampReceived><subject>[libvirt-users] Creating a CENTOS VM</subject><body>

I used the following command:

virt-install --connect qemu:///system -n server -r 512 --vcpus=1 -f \
kvm/server.cyberteams.com/root.qcow2 -s 12 -c iso/CentOS-5.6-x86_64-bin-DVD-1of2.iso \
--vnc --noautoconsole --os-type linux --accelerate --network=bridge:br0 --hvm

which with a BlueOnyx CD some months ago worked fine. However
when I connected with virt-viewer, after going through the TEST
function it then claimed it could not find the CD.

Is CENTOS a bit strange in some way?


</body></email><email><emailId>20110701211617</emailId><senderName>Eric Ross</senderName><senderEmail>eross@alcf.anl.gov</senderEmail><timestampReceived>2011-07-01 21:16:17-0400</timestampReceived><subject>[libvirt-users] NPIV + KVM</subject><body>

Is this possible:

I would like to have a VM use a FC LUN exported to a virtual wwn (using 
NPIV) as its primary disk.

I was thinking there might be a mechanism to say VM, boot using a LUN 
with this vwwn as your primary disk?

Thanks in advance.

-- 
---------------------------------------------------------------------
Eric Ross
HPC Systems Administrator
Argonne National Laboratory
Leadership Computing Facility
---------------------------------------------------------------------

</body></email><email><emailId>20110708064542</emailId><senderName>Soeren Grunewald</senderName><senderEmail>soeren.grunewald@avionic-design.de</senderEmail><timestampReceived>2011-07-08 06:45:42-0400</timestampReceived><subject>Re: [libvirt-users] Changing path of VM configuration files</subject><body>

Hallo,

the easiest way to do this, would be to mount /etc/libvirt to a 
different location. e.g. using nfs.
$ cat /etc/fstab
&lt;nfshost&gt;:/libvirt/configs   /etc/libvirt             nfs   defaults 0 0
&lt;nfshost&gt;:/libvirt/images    /var/lib/libvirt/images  nfs   defaults 0 0
--
Regards
Soeren


On 07/08/2011 01:40 AM, Jatin Kumar wrote:
&gt; Hello,I am using shared storage and i want to keep all the configuration files of \
&gt; vms of different hosts in one single location (on shared storage). Is there a way i \
&gt; can change the default path=/etc/libvirt/qemu/&lt;VMName&gt;.xml to something else. I \
&gt; looked into libvirtd.conf and qemu.conf but could not find any such thing. 
&gt; 
&gt; --
&gt; Jatin
&gt; 


</body></email><email><emailId>20110707083628</emailId><senderName>Nikita A Menkovich</senderName><senderEmail>menkovich@gmail.com</senderEmail><timestampReceived>2011-07-07 08:36:28-0400</timestampReceived><subject>Re: [libvirt-users] [Qemu-devel] SSH console for qemu</subject><body>

Seems no, I think, that the best way is running some kind of ssh
daemon, that connects to console (/dev/vcsa1 for example), that listen
on port and send to output console events on boot, and allow to work
with server with simple ssh client. Also important feature will be
saving history of output.

On 6 July 2011 19:27, Stefan Hajnoczi &lt;stefanha@gmail.com&gt; wrote:
&gt; On Wed, Jul 6, 2011 at 3:08 PM, Nikita A Menkovich &lt;menkovich@gmail.com&gt; wrote:
&gt;&gt; I'm using qemu with libvirt and I want to create SSH emergency console
&gt;&gt; to linux/unix guests, same way as it is realized in qemu VNC.
&gt;&gt; Maybe someone could help me to determine a place to dive in this question.
&gt;&gt;
&gt;&gt; I think the best way to make it - extend qemu API. But if this could
&gt;&gt; be made with libvirt - this will be also fine.
&gt;
&gt; Serial console and the "virsh console" command?
&gt;
&gt; Stefan
&gt;



-- 
Nikita A Menkovich
http://libc6.org/
JID: menkovich@gmail.com
Tel: +7 (921) 423-96-48

</body></email><email><emailId>20110707181955</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-07-07 18:19:55-0400</timestampReceived><subject>Re: [libvirt-users] [Qemu-devel] SSH console for qemu</subject><body>


On 07/07/2011 02:36 AM, Nikita A Menkovich wrote:
&gt; Seems no, I think, that the best way is running some kind of ssh
&gt; daemon, that connects to console (/dev/vcsa1 for example), that listen
&gt; on port and send to output console events on boot, and allow to work
&gt; with server with simple ssh client. Also important feature will be
&gt; saving history of output.

If you're trying to capture boot events, then you have to have an SGA
(serial graphics adaptor) capable BIOS that can output boot events on
the serial console.  There's recent work underway to add that feature to
qemu, and to expose that feature from libvirt:

https://www.redhat.com/archives/libvir-list/2011-July/msg00174.html

Setting up an ssh daemon in the guest is too late - the daemon won't be
set up until the guest has already booted, so there's no way to have
that daemon forward boot messages back to the host in a timely manner.
I think you're trying too hard - 'virsh console' really is the way to
read all messages output to the guest's console, and your only missing
piece is that you also appear to want BIOS to output to the console.

--=20
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20110707184733</emailId><senderName>Stefan Hajnoczi</senderName><senderEmail>stefanha@gmail.com</senderEmail><timestampReceived>2011-07-07 18:47:33-0400</timestampReceived><subject>Re: [libvirt-users] [Qemu-devel] SSH console for qemu</subject><body>

On Thu, Jul 7, 2011 at 9:36 AM, Nikita A Menkovich &lt;menkovich@gmail.com&gt; wrote:
&gt; Seems no, I think, that the best way is running some kind of ssh
&gt; daemon, that connects to console (/dev/vcsa1 for example), that listen
&gt; on port and send to output console events on boot, and allow to work
&gt; with server with simple ssh client. Also important feature will be
&gt; saving history of output.

If you configure an ssh daemon properly you can have it invoke "virsh
console &lt;domain&gt;" as the shell.  Remember to lock down port forwarding
and sftp.

Stefan

</body></email><email><emailId>20110705165015</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-07-05 16:50:15-0400</timestampReceived><subject>Re: [libvirt-users] Associating a statefile with an image</subject><body>


On 07/02/2011 09:59 AM, sethuraman subbiah wrote:
&gt; Hi ,
&gt; 
&gt; I am trying to perform offline migration (i.e) Create an incremental image using \
&gt; the qcow format, transfer the vm memory state to a state fie.Use the image and \
&gt; statefile together as a template. Now create a new vm using the template. I can \
&gt; successfully do it using the following commands :  
&gt; Save phase :
&gt; stop
&gt; migrate "exec:gzip -c &gt; STATEFILE.gz"
&gt; qemu-img 
&gt; qemu-img create -b BASE_img -f qcow2 INCRE_img
&gt; 
&gt; Restore phase :
&gt; qemu-kvm -m 1024 -hda INCRE_img -incoming "exec: gzip -c -d STATEFILE.gz"
&gt; 
&gt; And it works fine. But I am not able to find the vm with virt-manager or other \
&gt; libvirt based tools. 
&gt; If I use : 
&gt; virsh save &lt;dom_id&gt; STATEFILE
&gt; 
&gt; I can restore using "virsh restore STATEFILE" but I want to associate this with the \
&gt; incremental image that I created, but I dont know how. I think it saves the \
&gt; existing vm's xml file along with the STATEFILE, thus I am not able to change the \
&gt; disk image to the incremental image. 
&gt; Thus ,
&gt; 1. Either I should find a way to make vms created using qemu-kvm appear in \
&gt; libvirt-based tools.

There is a patch series pending to teach libvirt how to attach to a vm
created by raw invocation of qemu-kvm:
https://www.redhat.com/archives/libvir-list/2011-July/msg00111.html

But ultimately, our preference is to do everything through libvirt, to
isolate you from incompatible changes in qemu-kvm or to ease the
transition to any other type of hypervisor that supports similar
functionality.

&gt; 
&gt; OR 
&gt; 
&gt; 2. Find a way to associate the virsh save STATEFILE with a incremental image. 

Oh, I see what you mean.  Right now, the 'virsh save' statefile, _as
part of its saved state_, includes a verbatim copy of the XML in use at
the time the snapshot was created.  So even if you do 'virsh save', then
manually use 'qemu-img' to create incremental snapshots on top of those
images (or even my proposed RFC for virStorageVolSnapshot APIs for
managing incremental images from virsh rather than having to use
qemu-img:
https://www.redhat.com/archives/libvir-list/2011-June/msg00761.html),
you are still constrained in how to get those new disk images injected
back into the state file.  You can't just do 'virsh edit dom' to change
the name of the files that are backing each disk device, because 'virsh
restore' will _undo_ those changes as part of reverting back to the XML
that was stored verbatim in the statefile.

Your only recourse at the moment is to actually edit the XML embedded
within the statefiles, which is not appealing (text-editing a binary
file is dangerous).

This sounds like something worth working into the existing
virDomainSnapshot APIs; right now, when invoked on an inactive domain,
those APIs create _internal_ qcow2 snapshots (using qemu-img under the
hood for all disks tied to the domain); but as you are pointing out, it
is the _external_ incremental snapshot layout (a new file with the old
file serving as the backing image) that may better suit your needs.
Furthermore, that fits in with the fact that I'm trying to extend
virDomainSnapshot APIs to support an upcoming qemu monitor command for
online disk snapshots, and that monitor command will only support
external snapshots, so I already have to figure out how to make that
command manage the aspect of changing the file name associated with a
disk to swap over to the new incremental image.  Therefore, it seems
like whether online (new qemu monitor command) or offline, it makes
sense to enhance the virDomainSnapshot behavior to support external
images, at which point you will have the behavior of properly
associating a statefile with new file names for incremental images.

Meanwhile, it may mean that it might be worth adding some APIs to make
it easier to edit the XML embedded within a statefile image.  We
recently introduced the virDomainMigrate2 API, which takes an optional
XML rendition to use on the destination, and which is validated against
the original XML as being guest-compatible (that is, items related to
the host, such as a file name used as the backing image for a disk, can
be altered, while items related to the guest, such as the fact that the
guest expects a virtual disk in the first place, must not be altered).
So a new API that lets you provide an alternate XML for use with an
existing state file could use the same XML compatibility checking, to
ensure that the XML being injected into the state file is safe; this
would allow you to change the name of a host file to use for the guest
disk on the next 'virsh restore'.  Certainly some food for thought that
I'll keep in mind as I work on snapshot code.

&gt; 
&gt; Any help or hint with respect to these will be very helpful.

It's a work under progress, so keep your thoughts coming to make sure we
are not precluding useful modes of operation as we introduce new APIs or
new flags to existing APIs.

&gt; I am try to do cloning with minimal cost. This takes only 25 seconds ( to create \
&gt; STATEFILE) and creating incremental image is instantatenous . But I want to use the \
&gt; vm monitoring code based on libvirt. And it makes life difficult.  

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20110705172004</emailId><senderName>sethuraman subbiah</senderName><senderEmail>sethusubbiah@gmail.com</senderEmail><timestampReceived>2011-07-05 17:20:04-0400</timestampReceived><subject>Re: [libvirt-users] Associating a statefile with an image</subject><body>

Hi Eric, 

Thanks for the mail. I tried all possibilities without changing the libvirt's \
library. I tried editing the xml in statefile. But It never worked as we expect. It \
doesnt resume from the state, it boots the OS from scratch. I am not sure about the \
exact issue. I checked the code, I think libvirt (qemu-driver) saves the length of \
the xml file along with its header, I didnt check the restore part, but I think they \
do a validation check before restoring to make sure the length of the xml stored(its \
just a char*) is the same as mentioned in the header. Please let me know your views. \
I will be happy if there is anything I can do via implementation to make it work \
according to my specification. I am thinking of passing the new xml file as another \
argument and editing the libvirt code to consider that xml. Please let me know \
whether it is viable and whether it will fix the problem. Thanks a lot! 

-
Regards,
Sethuraman Subbiah

Graduate Student - NC state University
M.S in Computer Science


On Jul 5, 2011, at 12:50 PM, Eric Blake wrote:

&gt; On 07/02/2011 09:59 AM, sethuraman subbiah wrote:
&gt; &gt; Hi ,
&gt; &gt; 
&gt; &gt; I am trying to perform offline migration (i.e) Create an incremental image using \
&gt; &gt; the qcow format, transfer the vm memory state to a state fie.Use the image and \
&gt; &gt; statefile together as a template. Now create a new vm using the template. I can \
&gt; &gt; successfully do it using the following commands :  
&gt; &gt; Save phase :
&gt; &gt; stop
&gt; &gt; migrate "exec:gzip -c &gt; STATEFILE.gz"
&gt; &gt; qemu-img 
&gt; &gt; qemu-img create -b BASE_img -f qcow2 INCRE_img
&gt; &gt; 
&gt; &gt; Restore phase :
&gt; &gt; qemu-kvm -m 1024 -hda INCRE_img -incoming "exec: gzip -c -d STATEFILE.gz"
&gt; &gt; 
&gt; &gt; And it works fine. But I am not able to find the vm with virt-manager or other \
&gt; &gt; libvirt based tools. 
&gt; &gt; If I use : 
&gt; &gt; virsh save &lt;dom_id&gt; STATEFILE
&gt; &gt; 
&gt; &gt; I can restore using "virsh restore STATEFILE" but I want to associate this with \
&gt; &gt; the incremental image that I created, but I dont know how. I think it saves the \
&gt; &gt; existing vm's xml file along with the STATEFILE, thus I am not able to change the \
&gt; &gt; disk image to the incremental image. 
&gt; &gt; Thus ,
&gt; &gt; 1. Either I should find a way to make vms created using qemu-kvm appear in \
&gt; &gt; libvirt-based tools.
&gt; 
&gt; There is a patch series pending to teach libvirt how to attach to a vm
&gt; created by raw invocation of qemu-kvm:
&gt; https://www.redhat.com/archives/libvir-list/2011-July/msg00111.html
&gt; 
&gt; But ultimately, our preference is to do everything through libvirt, to
&gt; isolate you from incompatible changes in qemu-kvm or to ease the
&gt; transition to any other type of hypervisor that supports similar
&gt; functionality.
&gt; 
&gt; &gt; 
&gt; &gt; OR 
&gt; &gt; 
&gt; &gt; 2. Find a way to associate the virsh save STATEFILE with a incremental image. 
&gt; 
&gt; Oh, I see what you mean.  Right now, the 'virsh save' statefile, _as
&gt; part of its saved state_, includes a verbatim copy of the XML in use at
&gt; the time the snapshot was created.  So even if you do 'virsh save', then
&gt; manually use 'qemu-img' to create incremental snapshots on top of those
&gt; images (or even my proposed RFC for virStorageVolSnapshot APIs for
&gt; managing incremental images from virsh rather than having to use
&gt; qemu-img:
&gt; https://www.redhat.com/archives/libvir-list/2011-June/msg00761.html),
&gt; you are still constrained in how to get those new disk images injected
&gt; back into the state file.  You can't just do 'virsh edit dom' to change
&gt; the name of the files that are backing each disk device, because 'virsh
&gt; restore' will _undo_ those changes as part of reverting back to the XML
&gt; that was stored verbatim in the statefile.
&gt; 
&gt; Your only recourse at the moment is to actually edit the XML embedded
&gt; within the statefiles, which is not appealing (text-editing a binary
&gt; file is dangerous).
&gt; 
&gt; This sounds like something worth working into the existing
&gt; virDomainSnapshot APIs; right now, when invoked on an inactive domain,
&gt; those APIs create _internal_ qcow2 snapshots (using qemu-img under the
&gt; hood for all disks tied to the domain); but as you are pointing out, it
&gt; is the _external_ incremental snapshot layout (a new file with the old
&gt; file serving as the backing image) that may better suit your needs.
&gt; Furthermore, that fits in with the fact that I'm trying to extend
&gt; virDomainSnapshot APIs to support an upcoming qemu monitor command for
&gt; online disk snapshots, and that monitor command will only support
&gt; external snapshots, so I already have to figure out how to make that
&gt; command manage the aspect of changing the file name associated with a
&gt; disk to swap over to the new incremental image.  Therefore, it seems
&gt; like whether online (new qemu monitor command) or offline, it makes
&gt; sense to enhance the virDomainSnapshot behavior to support external
&gt; images, at which point you will have the behavior of properly
&gt; associating a statefile with new file names for incremental images.
&gt; 
&gt; Meanwhile, it may mean that it might be worth adding some APIs to make
&gt; it easier to edit the XML embedded within a statefile image.  We
&gt; recently introduced the virDomainMigrate2 API, which takes an optional
&gt; XML rendition to use on the destination, and which is validated against
&gt; the original XML as being guest-compatible (that is, items related to
&gt; the host, such as a file name used as the backing image for a disk, can
&gt; be altered, while items related to the guest, such as the fact that the
&gt; guest expects a virtual disk in the first place, must not be altered).
&gt; So a new API that lets you provide an alternate XML for use with an
&gt; existing state file could use the same XML compatibility checking, to
&gt; ensure that the XML being injected into the state file is safe; this
&gt; would allow you to change the name of a host file to use for the guest
&gt; disk on the next 'virsh restore'.  Certainly some food for thought that
&gt; I'll keep in mind as I work on snapshot code.
&gt; 
&gt; &gt; 
&gt; &gt; Any help or hint with respect to these will be very helpful.
&gt; 
&gt; It's a work under progress, so keep your thoughts coming to make sure we
&gt; are not precluding useful modes of operation as we introduce new APIs or
&gt; new flags to existing APIs.
&gt; 
&gt; &gt; I am try to do cloning with minimal cost. This takes only 25 seconds ( to create \
&gt; &gt; STATEFILE) and creating incremental image is instantatenous . But I want to use \
&gt; &gt; the vm monitoring code based on libvirt. And it makes life difficult.  
&gt; 
&gt; -- 
&gt; Eric Blake   eblake@redhat.com    +1-801-349-2682
&gt; Libvirt virtualization library http://libvirt.org
&gt; 


</body></email><email><emailId>20110802212918</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-08-02 21:29:18-0400</timestampReceived><subject>Re: [libvirt-users] Associating a statefile with an image</subject><body>

[re-adding the list]

On 08/02/2011 03:18 PM, sethuraman subbiah wrote:
&gt; &gt; Libvirt shoots for monthly releases; the current schedule is feature freeze this \
&gt; &gt; weekend, then a release around the first of August. 
&gt; &gt; The new API will allow you do to either:
&gt; &gt; 
&gt; &gt; virsh dumpxml --inactive --dom&gt;  file.xml
&gt; &gt; edit file.xml
&gt; &gt; virsh save dom dom.save --xml file.xml
&gt; &gt; virsh restore file.save
&gt; &gt; 
&gt; &gt; or:
&gt; &gt; 
&gt; &gt; virsh dumpxml --inactive --dom&gt;  file.xml

Using --inactive here only works if you haven't made any changes to the 
inactive configuration that differs from the currently running domain. 
I'd amend this step to 'virsh dumpxml dom &gt; file.xml' for both of these 
examples.

&gt; &gt; virsh save dom dom.save
&gt; &gt; edit file.xml
&gt; &gt; virsh restore file.save --xml file.xml

These two examples will be supported in 0.9.4.  Additionally, I added:

virsh save-file-dumpxml dom.save &gt; file.xml
virsh save-file-define dom.save file.xml
virsh save-file-edit dom.save

to do things inline, and to make it so you don't have to remember to 
'virsh dumpxml dom' prior to 'virsh save'.

&gt; 
&gt; I found that the latest libvirt (libvirt 0.9.4) is out.

That's amazing, considering it hasn't been released yet :)  Maybe you 
are referring to 0.9.4-rc2 instead?  But at any rate, the official 0.9.4 
will probably be released tomorrow with even more bug fixes above 0.9.4-rc2.

 &gt; I tried installing in my Centos 5.6 machine. After a successful 
installation, when I start virsh , I get :
&gt; 
&gt; virsh: /lib/libvirt.so.0: version `LIBVIRT_PRIVATE_0.8.2' not found (required by \
&gt; virsh) 
&gt; Is it possible to get the latest version of libvirt 0.9.4 work on Centos 5.6 ?  \
&gt; Thanks a lot for your help.

Yes, it should be possible, although I haven't tried it myself on centos 
(but I have tried on RHEL 5.7).  Are you sure you installed your 
self-built libvirt.so correctly?  We take great pains to ensure that 
libvirt.so is backwards compatible (no symbols are ever removed).

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


</body></email><email><emailId>20110802222827</emailId><senderName>sethuraman subbiah</senderName><senderEmail>sethusubbiah@gmail.com</senderEmail><timestampReceived>2011-08-02 22:28:27-0400</timestampReceived><subject>Re: [libvirt-users] Associating a statefile with an image</subject><body>


On Aug 2, 2011, at 5:29 PM, Eric Blake wrote:

&gt; [re-adding the list]
&gt; 
&gt; On 08/02/2011 03:18 PM, sethuraman subbiah wrote:
&gt; &gt; &gt; Libvirt shoots for monthly releases; the current schedule is feature freeze \
&gt; &gt; &gt; this weekend, then a release around the first of August. 
&gt; &gt; &gt; The new API will allow you do to either:
&gt; &gt; &gt; 
&gt; &gt; &gt; virsh dumpxml --inactive --dom&gt;  file.xml
&gt; &gt; &gt; edit file.xml
&gt; &gt; &gt; virsh save dom dom.save --xml file.xml
&gt; &gt; &gt; virsh restore file.save
&gt; &gt; &gt; 
&gt; &gt; &gt; or:
&gt; &gt; &gt; 
&gt; &gt; &gt; virsh dumpxml --inactive --dom&gt;  file.xml
&gt; 
&gt; Using --inactive here only works if you haven't made any changes to the inactive \
&gt; configuration that differs from the currently running domain. I'd amend this step \
&gt; to 'virsh dumpxml dom &gt; file.xml' for both of these examples. 
&gt; &gt; &gt; virsh save dom dom.save
&gt; &gt; &gt; edit file.xml
&gt; &gt; &gt; virsh restore file.save --xml file.xml
&gt; 
&gt; These two examples will be supported in 0.9.4.  Additionally, I added:
&gt; 
&gt; virsh save-file-dumpxml dom.save &gt; file.xml
&gt; virsh save-file-define dom.save file.xml
&gt; virsh save-file-edit dom.save
&gt; 
&gt; to do things inline, and to make it so you don't have to remember to 'virsh dumpxml \
&gt; dom' prior to 'virsh save'. 
&gt; &gt; 
&gt; &gt; I found that the latest libvirt (libvirt 0.9.4) is out.
&gt; 
&gt; That's amazing, considering it hasn't been released yet :)  Maybe you are referring \
&gt; to 0.9.4-rc2 instead?  But at any rate, the official 0.9.4 will probably be \
&gt; released tomorrow with even more bug fixes above 0.9.4-rc2. 
Yeah , I was referring to 0.9.4-rc2 :) I will install the official libvirt 0.9.4 \
tomorrow . 
&gt; &gt; I tried installing in my Centos 5.6 machine. After a successful installation, \
&gt; &gt; when I start virsh , I get : 
&gt; &gt; virsh: /lib/libvirt.so.0: version `LIBVIRT_PRIVATE_0.8.2' not found (required by \
&gt; &gt; virsh) 
&gt; &gt; Is it possible to get the latest version of libvirt 0.9.4 work on Centos 5.6 ?  \
&gt; &gt; Thanks a lot for your help.
&gt; 
&gt; Yes, it should be possible, although I haven't tried it myself on centos (but I \
&gt; have tried on RHEL 5.7).  Are you sure you installed your self-built libvirt.so \
&gt; correctly?  We take great pains to ensure that libvirt.so is backwards compatible \
&gt; (no symbols are ever removed). 
I think so, I installed libvirt 0.9.4-rc2 on Centos 6 and it worked fine. I tried \
installing in Centos 5.6 (It had libvirt already installed through yum) . I did yum \
remove libvirt. Then I did ./configure --prefix = / , make , make install , ldconfig. \
When I enter virsh after finishing these steps, I get that error. I am not sure \
whether I am committing a mistake in-between. Please correct me if I am wrong. Thank \
you.  
&gt; -- 
&gt; Eric Blake   eblake@redhat.com    +1-801-349-2682
&gt; Libvirt virtualization library http://libvirt.org


</body></email><email><emailId>20110523115724</emailId><senderName>Andreas Mauf</senderName><senderEmail>a.mauf@syseleven.de</senderEmail><timestampReceived>2011-05-23 11:57:24-0400</timestampReceived><subject>[libvirt-users] Compatibility with Parallels Virtouzo</subject><body>

Hi,

will libvirt work with the commercial parallels virtuozzo, too? Cause
the linux version of virtuozzo is based on openvz, which ist supported
by libvirt.

Does someone have some experencies with that?

Thanks for any feedback,

Andreas

-- 
SysEleven GmbH
Rosenthaler Str. 34/35
10178 Berlin

Firmensitz: Berlin
Registergericht: AG Berlin Charlottenburg, HRB 108571 B
Geschäftsführer: Marc Korthaus

</body></email><email><emailId>20110712090515</emailId><senderName>Andreas Mauf</senderName><senderEmail>a.mauf@syseleven.de</senderEmail><timestampReceived>2011-07-12 09:05:15-0400</timestampReceived><subject>Re: [libvirt-users] Compatibility with Parallels Virtouzo</subject><body>

Yes, vzctl works. But how do I connect to Virtuozzo? Using the openvz driver
it doesn't work out of the box:

virsh # connect openvz:///system
error: Failed to connect to the hypervisor
error: no connection driver available for openvz:///system


2011/5/23 Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;

&gt; 2011/5/23 Andreas Mauf &lt;a.mauf@syseleven.de&gt;:
&gt; &gt; Hi,
&gt; &gt;
&gt; &gt; will libvirt work with the commercial parallels virtuozzo, too? Cause
&gt; &gt; the linux version of virtuozzo is based on openvz, which ist supported
&gt; &gt; by libvirt.
&gt;
&gt; This depends on whether or not virtuozzo can be controlled via the
&gt; vzctl tool, because that's bow libvirt interacts with OpenVZ.
&gt;
&gt; Matthias
&gt;

[Attachment #3 (text/html)]

Yes, vzctl works. But how do I connect to Virtuozzo? Using the openvz driver it \
doesn't work out of the box:&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;virsh # connect \
openvz:///system&lt;/div&gt;&lt;div&gt;error: Failed to connect to the hypervisor&lt;/div&gt; \
&lt;div&gt;error: no connection driver available for \
openvz:///system&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;2011/5/23 Matthias \
Bolte &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;
 &lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt;2011/5/23 Andreas Mauf &lt;&lt;a \
href="mailto:a.mauf@syseleven.de"&gt;a.mauf@syseleven.de&lt;/a&gt;&gt;:&lt;br&gt; &lt;div \
class="im"&gt;&gt; Hi,&lt;br&gt; &gt;&lt;br&gt;
&gt; will libvirt work with the commercial parallels virtuozzo, too? Cause&lt;br&gt;
&gt; the linux version of virtuozzo is based on openvz, which ist supported&lt;br&gt;
&gt; by libvirt.&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;This depends on whether or not virtuozzo can be controlled via the&lt;br&gt;
vzctl tool, because that's bow libvirt interacts with OpenVZ.&lt;br&gt;
&lt;font color="#888888"&gt;&lt;br&gt;
Matthias&lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;
&lt;/div&gt;



</body></email><email><emailId>20110712100306</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-07-12 10:03:06-0400</timestampReceived><subject>Re: [libvirt-users] Compatibility with Parallels Virtouzo</subject><body>

2011/7/12 Andreas Mauf &lt;a.mauf@syseleven.de&gt;:
&gt; Yes, vzctl works. But how do I connect to Virtuozzo? Using the openvz driver
&gt; it doesn't work out of the box:
&gt; virsh # connect openvz:///system
&gt; error: Failed to connect to the hypervisor
&gt; error: no connection driver available for openvz:///system

You're libvirt might be compiled without OpenVZ support. Try

  LIBVIRT_DEBUG=1 virsh -c openvz:///system

and check if it's probing the OpenVZ driver.

On the other hand the OpenVZ driver checks for the existence of
/proc/vz and reports an error if it's not there

  $ virsh -c openvz:///system
  error: internal error OpenVZ control file /proc/vz does not exist
  error: failed to connect to the hypervisor

This might need to be changed/extended in your case, I don't know.

&gt; 2011/5/23 Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;
&gt;&gt;
&gt;&gt; 2011/5/23 Andreas Mauf &lt;a.mauf@syseleven.de&gt;:
&gt;&gt; &gt; Hi,
&gt;&gt; &gt;
&gt;&gt; &gt; will libvirt work with the commercial parallels virtuozzo, too? Cause
&gt;&gt; &gt; the linux version of virtuozzo is based on openvz, which ist supported
&gt;&gt; &gt; by libvirt.
&gt;&gt;
&gt;&gt; This depends on whether or not virtuozzo can be controlled via the
&gt;&gt; vzctl tool, because that's bow libvirt interacts with OpenVZ.
&gt;&gt;
&gt;&gt; Matthias
&gt;

-- 
Matthias Bolte
http://photron.blogspot.com

</body></email><email><emailId>20110712121935</emailId><senderName>Andreas Mauf</senderName><senderEmail>a.mauf@syseleven.de</senderEmail><timestampReceived>2011-07-12 12:19:35-0400</timestampReceived><subject>Re: [libvirt-users] Compatibility with Parallels Virtouzo</subject><body>

Thanks! I compiled libvirt on my own and added --with-openvz. Driver is now
available.

But as feared libvirt is using a api call that virtuozzo dont accept. Is
there a way to update those calls?

[root@localhost local]# LIBVIRT_DEBUG=1 virsh -c openvz:///system
&gt; [...]
&gt; 00:25:12.878: 2313: debug : do_open:1053 : trying driver 1 (OPENVZ) ...
&gt; 00:25:12.879: 2313: debug : virCommandRunAsync:1874 : *About to run
&gt; /usr/sbin/vzlist -a -ovpsid,status -H
&gt; *00:25:12.901: 2313: debug : virCommandRunAsync:1890 : Command result 0,
&gt; with PID 2314
&gt; 00:25:12.902: 2313: debug : virCommandRun:1711 : Result status 0, stdout:
&gt; '' stderr: '00:25:12.889: 2314: debug : virCommandHook:1808 : Hook is done 0
&gt; *Unknown field: vpsid
&gt; *'
&gt; 00:25:12.902: 2313: debug : do_open:1059 : driver 1 OPENVZ returned ERROR
&gt; 00:25:12.903: 2313: debug : virUnrefConnect:145 : unref connection
&gt; 0xc9aada0 1
&gt; 00:25:12.903: 2313: debug : virReleaseConnect:94 : release connection
&gt; 0xc9aada0
&gt; error: internal error Child process (/usr/sbin/vzlist -a -ovpsid,status -H)
&gt; status unexpected: exit status 1
&gt; error: failed to connect to the hypervisor



2011/7/12 Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;

&gt; 2011/7/12 Andreas Mauf &lt;a.mauf@syseleven.de&gt;:
&gt; &gt; Yes, vzctl works. But how do I connect to Virtuozzo? Using the openvz
&gt; driver
&gt; &gt; it doesn't work out of the box:
&gt; &gt; virsh # connect openvz:///system
&gt; &gt; error: Failed to connect to the hypervisor
&gt; &gt; error: no connection driver available for openvz:///system
&gt;
&gt; You're libvirt might be compiled without OpenVZ support. Try
&gt;
&gt;  LIBVIRT_DEBUG=1 virsh -c openvz:///system
&gt;
&gt; and check if it's probing the OpenVZ driver.

[Attachment #3 (text/html)]

Thanks! I compiled libvirt on my own and added --with-openvz. Driver is now \
available.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;But as feared libvirt is using a api call that \
virtuozzo dont accept. Is there a way to update those calls?&lt;/div&gt;&lt;div&gt; \
&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;meta charset="utf-8"&gt;&lt;blockquote class="gmail_quote" \
style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0.8ex; \
border-left-width: 1px; border-left-color: rgb(204, 204, 204); border-left-style: \
solid; padding-left: 1ex; "&gt; &lt;span class="Apple-style-span" style="border-collapse: \
collapse; color: rgb(51, 51, 51); font-family: arial, sans-serif; font-size: 13px; \
"&gt;[root@localhost local]# LIBVIRT_DEBUG=1 virsh -c openvz:///system&lt;br&gt;&lt;/span&gt;&lt;span \
class="Apple-style-span" style="border-collapse: collapse; color: rgb(51, 51, 51); \
font-family: arial, sans-serif; font-size: 13px; "&gt;[...]&lt;br&gt; &lt;/span&gt;&lt;span \
class="Apple-style-span" style="border-collapse: collapse; color: rgb(51, 51, 51); \
font-family: arial, sans-serif; font-size: 13px; "&gt;00:25:12.878: 2313: debug : \
do_open:1053 : trying driver 1 (OPENVZ) ...&lt;br&gt; &lt;/span&gt;&lt;span class="Apple-style-span" \
style="border-collapse: collapse; color: rgb(51, 51, 51); font-family: arial, \
sans-serif; font-size: 13px; "&gt;00:25:12.879: 2313: debug : virCommandRunAsync:1874 : \
&lt;b&gt;About to run /usr/sbin/vzlist -a -ovpsid,status -H&lt;br&gt; &lt;/b&gt;&lt;/span&gt;&lt;span \
class="Apple-style-span" style="border-collapse: collapse; color: rgb(51, 51, 51); \
font-family: arial, sans-serif; font-size: 13px; "&gt;00:25:12.901: 2313: debug : \
virCommandRunAsync:1890 : Command result 0, with PID 2314&lt;br&gt; &lt;/span&gt;&lt;span \
class="Apple-style-span" style="border-collapse: collapse; color: rgb(51, 51, 51); \
font-family: arial, sans-serif; font-size: 13px; "&gt;00:25:12.902: 2313: debug : \
virCommandRun:1711 : Result status 0, stdout: '' stderr: '00:25:12.889: \
2314: debug : virCommandHook:1808 : Hook is done 0&lt;br&gt; &lt;/span&gt;&lt;span \
class="Apple-style-span" style="border-collapse: collapse; color: rgb(51, 51, 51); \
font-family: arial, sans-serif; font-size: 13px; "&gt;&lt;b&gt;Unknown field: \
vpsid&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;span class="Apple-style-span" style="border-collapse: collapse; \
color: rgb(51, 51, 51); font-family: arial, sans-serif; font-size: 13px; "&gt;'&lt;br&gt; \
&lt;/span&gt;&lt;span class="Apple-style-span" style="border-collapse: collapse; color: \
rgb(51, 51, 51); font-family: arial, sans-serif; font-size: 13px; "&gt;00:25:12.902: \
2313: debug : do_open:1059 : driver 1 OPENVZ returned ERROR&lt;br&gt; &lt;/span&gt;&lt;span \
class="Apple-style-span" style="border-collapse: collapse; color: rgb(51, 51, 51); \
font-family: arial, sans-serif; font-size: 13px; "&gt;00:25:12.903: 2313: debug : \
virUnrefConnect:145 : unref connection 0xc9aada0 1&lt;br&gt; &lt;/span&gt;&lt;span \
class="Apple-style-span" style="border-collapse: collapse; color: rgb(51, 51, 51); \
font-family: arial, sans-serif; font-size: 13px; "&gt;00:25:12.903: 2313: debug : \
virReleaseConnect:94 : release connection 0xc9aada0&lt;br&gt; &lt;/span&gt;&lt;span \
class="Apple-style-span" style="border-collapse: collapse; color: rgb(51, 51, 51); \
font-family: arial, sans-serif; font-size: 13px; "&gt;error: internal error Child \
process (/usr/sbin/vzlist -a -ovpsid,status -H) status unexpected: exit status \
                1&lt;/span&gt;&lt;br&gt;
error: failed to connect to the hypervisor&lt;/blockquote&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;2011/7/12 Matthias Bolte &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;
 &lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt;2011/7/12 Andreas Mauf &lt;&lt;a \
href="mailto:a.mauf@syseleven.de"&gt;a.mauf@syseleven.de&lt;/a&gt;&gt;:&lt;br&gt; &lt;div \
class="im"&gt;&gt; Yes, vzctl works. But how do I connect to Virtuozzo? Using the openvz \
driver&lt;br&gt; &gt; it doesn't work out of the box:&lt;br&gt;
&gt; virsh # connect openvz:///system&lt;br&gt;
&gt; error: Failed to connect to the hypervisor&lt;br&gt;
&gt; error: no connection driver available for openvz:///system&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;You're libvirt might be compiled without OpenVZ support. Try&lt;br&gt;
&lt;br&gt;
  LIBVIRT_DEBUG=1 virsh -c openvz:///system&lt;br&gt;
&lt;br&gt;
and check if it's probing the OpenVZ driver.&lt;/blockquote&gt;&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20110712123510</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-07-12 12:35:10-0400</timestampReceived><subject>Re: [libvirt-users] Compatibility with Parallels Virtouzo</subject><body>

Well, as Virtuozzo is a variant of OpenVZ it'll probably be possible
to teach the OpenVZ driver to detect and deal with this similar to the
QEMU driver dealing with different variants of QEMU.

2011/7/12 Andreas Mauf &lt;a.mauf@syseleven.de&gt;:
&gt; Thanks! I compiled libvirt on my own and added --with-openvz. Driver is now
&gt; available.
&gt; But as feared libvirt is using a api call that virtuozzo dont accept. Is
&gt; there a way to update those calls?
&gt;&gt;
&gt;&gt; [root@localhost local]# LIBVIRT_DEBUG=1 virsh -c openvz:///system
&gt;&gt; [...]
&gt;&gt; 00:25:12.878: 2313: debug : do_open:1053 : trying driver 1 (OPENVZ) ...
&gt;&gt; 00:25:12.879: 2313: debug : virCommandRunAsync:1874 : About to run
&gt;&gt; /usr/sbin/vzlist -a -ovpsid,status -H
&gt;&gt; 00:25:12.901: 2313: debug : virCommandRunAsync:1890 : Command result 0,
&gt;&gt; with PID 2314
&gt;&gt; 00:25:12.902: 2313: debug : virCommandRun:1711 : Result status 0, stdout:
&gt;&gt; '' stderr: '00:25:12.889: 2314: debug : virCommandHook:1808 : Hook is done 0
&gt;&gt; Unknown field: vpsid
&gt;&gt; '

Is this filed just named differently, or did Virtuozzo completely
remove this ID?

If it's just named different then this should be simple to fix, but it
needs someone to figure this out.

&gt;&gt; 00:25:12.902: 2313: debug : do_open:1059 : driver 1 OPENVZ returned ERROR
&gt;&gt; 00:25:12.903: 2313: debug : virUnrefConnect:145 : unref connection
&gt;&gt; 0xc9aada0 1
&gt;&gt; 00:25:12.903: 2313: debug : virReleaseConnect:94 : release connection
&gt;&gt; 0xc9aada0
&gt;&gt; error: internal error Child process (/usr/sbin/vzlist -a -ovpsid,status
&gt;&gt; -H) status unexpected: exit status 1
&gt;&gt; error: failed to connect to the hypervisor
&gt;
&gt; 2011/7/12 Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;
&gt;&gt;
&gt;&gt; 2011/7/12 Andreas Mauf &lt;a.mauf@syseleven.de&gt;:
&gt;&gt; &gt; Yes, vzctl works. But how do I connect to Virtuozzo? Using the openvz
&gt;&gt; &gt; driver
&gt;&gt; &gt; it doesn't work out of the box:
&gt;&gt; &gt; virsh # connect openvz:///system
&gt;&gt; &gt; error: Failed to connect to the hypervisor
&gt;&gt; &gt; error: no connection driver available for openvz:///system
&gt;&gt;
&gt;&gt; You're libvirt might be compiled without OpenVZ support. Try
&gt;&gt;
&gt;&gt;  LIBVIRT_DEBUG=1 virsh -c openvz:///system
&gt;&gt;
&gt;&gt; and check if it's probing the OpenVZ driver.

-- 
Matthias Bolte
http://photron.blogspot.com

</body></email><email><emailId>20110712133427</emailId><senderName>Andreas Mauf</senderName><senderEmail>a.mauf@syseleven.de</senderEmail><timestampReceived>2011-07-12 13:34:27-0400</timestampReceived><subject>Re: [libvirt-users] Compatibility with Parallels Virtouzo</subject><body>

It should be CTID instead of VPSID. I think this was changed in openvz
version, too: http://wiki.openvz.org/Man/vzlist.8

Can we fix this in /root/libvirt-0.9.3/srcopenvz/openvz_conf.c and
reinstall?


2011/7/12 Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;

&gt; Well, as Virtuozzo is a variant of OpenVZ it'll probably be possible
&gt; to teach the OpenVZ driver to detect and deal with this similar to the
&gt; QEMU driver dealing with different variants of QEMU.
&gt;
&gt; 2011/7/12 Andreas Mauf &lt;a.mauf@syseleven.de&gt;:
&gt; &gt; Thanks! I compiled libvirt on my own and added --with-openvz. Driver is
&gt; now
&gt; &gt; available.
&gt; &gt; But as feared libvirt is using a api call that virtuozzo dont accept. Is
&gt; &gt; there a way to update those calls?
&gt; &gt;&gt;
&gt; &gt;&gt; [root@localhost local]# LIBVIRT_DEBUG=1 virsh -c openvz:///system
&gt; &gt;&gt; [...]
&gt; &gt;&gt; 00:25:12.878: 2313: debug : do_open:1053 : trying driver 1 (OPENVZ) ...
&gt; &gt;&gt; 00:25:12.879: 2313: debug : virCommandRunAsync:1874 : About to run
&gt; &gt;&gt; /usr/sbin/vzlist -a -ovpsid,status -H
&gt; &gt;&gt; 00:25:12.901: 2313: debug : virCommandRunAsync:1890 : Command result 0,
&gt; &gt;&gt; with PID 2314
&gt; &gt;&gt; 00:25:12.902: 2313: debug : virCommandRun:1711 : Result status 0,
&gt; stdout:
&gt; &gt;&gt; '' stderr: '00:25:12.889: 2314: debug : virCommandHook:1808 : Hook is
&gt; done 0
&gt; &gt;&gt; Unknown field: vpsid
&gt; &gt;&gt; '
&gt;
&gt; Is this filed just named differently, or did Virtuozzo completely
&gt; remove this ID?
&gt;
&gt; If it's just named different then this should be simple to fix, but it
&gt; needs someone to figure this out.

[Attachment #3 (text/html)]

It should be CTID instead of VPSID. I think this was changed in openvz version, too: \
&lt;a href="http://wiki.openvz.org/Man/vzlist.8"&gt;http://wiki.openvz.org/Man/vzlist.8&lt;/a&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Can \
we fix this in /root/libvirt-0.9.3/srcopenvz/openvz_conf.c and reinstall?&lt;/div&gt; \
&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div class="gmail_quote"&gt;2011/7/12 Matthias \
Bolte &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt; Well, as Virtuozzo is a variant of OpenVZ it'll \
probably be possible&lt;br&gt; to teach the OpenVZ driver to detect and deal with this \
similar to the&lt;br&gt; QEMU driver dealing with different variants of QEMU.&lt;br&gt;
&lt;div class="im"&gt;&lt;br&gt;
2011/7/12 Andreas Mauf &lt;&lt;a \
href="mailto:a.mauf@syseleven.de"&gt;a.mauf@syseleven.de&lt;/a&gt;&gt;:&lt;br&gt; &lt;/div&gt;&lt;div \
class="im"&gt;&gt; Thanks! I compiled libvirt on my own and added --with-openvz. Driver \
is now&lt;br&gt; &gt; available.&lt;br&gt;
&gt; But as feared libvirt is using a api call that virtuozzo dont accept. Is&lt;br&gt;
&gt; there a way to update those calls?&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; [root@localhost local]# LIBVIRT_DEBUG=1 virsh -c openvz:///system&lt;br&gt;
&gt;&gt; [...]&lt;br&gt;
&gt;&gt; 00:25:12.878: 2313: debug : do_open:1053 : trying driver 1 (OPENVZ) ...&lt;br&gt;
&gt;&gt; 00:25:12.879: 2313: debug : virCommandRunAsync:1874 : About to run&lt;br&gt;
&gt;&gt; /usr/sbin/vzlist -a -ovpsid,status -H&lt;br&gt;
&gt;&gt; 00:25:12.901: 2313: debug : virCommandRunAsync:1890 : Command result 0,&lt;br&gt;
&gt;&gt; with PID 2314&lt;br&gt;
&gt;&gt; 00:25:12.902: 2313: debug : virCommandRun:1711 : Result status 0, \
stdout:&lt;br&gt; &gt;&gt; '' stderr: '00:25:12.889: 2314: debug : \
virCommandHook:1808 : Hook is done 0&lt;br&gt; &gt;&gt; Unknown field: vpsid&lt;br&gt;
&gt;&gt; '&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;Is this filed just named differently, or did Virtuozzo completely&lt;br&gt;
remove this ID?&lt;br&gt;
&lt;br&gt;
If it's just named different then this should be simple to fix, but it&lt;br&gt;
needs someone to figure this out.&lt;/blockquote&gt;&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20110803010632</emailId><senderName>sethuraman subbiah</senderName><senderEmail>sethusubbiah@gmail.com</senderEmail><timestampReceived>2011-08-03 01:06:32-0400</timestampReceived><subject>Re: [libvirt-users] Associating a statefile with an image</subject><body>

On 2 August 2011 18:28, sethuraman subbiah &lt;sethusubbiah@gmail.com&gt; wrote:

&gt;
&gt; On Aug 2, 2011, at 5:29 PM, Eric Blake wrote:
&gt;
&gt; &gt; [re-adding the list]
&gt; &gt;
&gt; &gt; On 08/02/2011 03:18 PM, sethuraman subbiah wrote:
&gt; &gt;&gt;&gt; Libvirt shoots for monthly releases; the current schedule is feature
&gt; freeze this weekend, then a release around the first of August.
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; The new API will allow you do to either:
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; virsh dumpxml --inactive --dom&gt;  file.xml
&gt; &gt;&gt;&gt; edit file.xml
&gt; &gt;&gt;&gt; virsh save dom dom.save --xml file.xml
&gt; &gt;&gt;&gt; virsh restore file.save
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; or:
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; virsh dumpxml --inactive --dom&gt;  file.xml
&gt; &gt;
&gt; &gt; Using --inactive here only works if you haven't made any changes to the
&gt; inactive configuration that differs from the currently running domain. I'd
&gt; amend this step to 'virsh dumpxml dom &gt; file.xml' for both of these
&gt; examples.
&gt; &gt;
&gt; &gt;&gt;&gt; virsh save dom dom.save
&gt; &gt;&gt;&gt; edit file.xml
&gt; &gt;&gt;&gt; virsh restore file.save --xml file.xml
&gt; &gt;
&gt; &gt; These two examples will be supported in 0.9.4.  Additionally, I added:
&gt; &gt;
&gt; &gt; virsh save-file-dumpxml dom.save &gt; file.xml
&gt; &gt; virsh save-file-define dom.save file.xml
&gt; &gt; virsh save-file-edit dom.save
&gt; &gt;
&gt; &gt; to do things inline, and to make it so you don't have to remember to
&gt; 'virsh dumpxml dom' prior to 'virsh save'.
&gt; &gt;
&gt;

I tried changing the disk image and it works fine. But if I try to change
the mac address , I get error: unsupported configuration. My aim was to
perform cloning and change the mac of the cloned image and also doing some
changes inside the vm to make sure it obtains a new ip. Is there a
possibility to get this working with the current API ?

&gt; &gt;&gt;
&gt; &gt;&gt; I found that the latest libvirt (libvirt 0.9.4) is out.
&gt; &gt;
&gt; &gt; That's amazing, considering it hasn't been released yet :)  Maybe you are
&gt; referring to 0.9.4-rc2 instead?  But at any rate, the official 0.9.4 will
&gt; probably be released tomorrow with even more bug fixes above 0.9.4-rc2.
&gt; &gt;
&gt; Yeah , I was referring to 0.9.4-rc2 :) I will install the official libvirt
&gt; 0.9.4 tomorrow .
&gt; &gt; &gt; I tried installing in my Centos 5.6 machine. After a successful
&gt; installation, when I start virsh , I get :
&gt; &gt;&gt;
&gt; &gt;&gt; virsh: /lib/libvirt.so.0: version `LIBVIRT_PRIVATE_0.8.2' not found
&gt; (required by virsh)
&gt; &gt;&gt;
&gt; &gt;&gt; Is it possible to get the latest version of libvirt 0.9.4 work on Centos
&gt; 5.6 ?  Thanks a lot for your help.
&gt; &gt;
&gt; &gt; Yes, it should be possible, although I haven't tried it myself on centos
&gt; (but I have tried on RHEL 5.7).  Are you sure you installed your self-built
&gt; libvirt.so correctly?  We take great pains to ensure that libvirt.so is
&gt; backwards compatible (no symbols are ever removed).
&gt; &gt;
&gt; I think so, I installed libvirt 0.9.4-rc2 on Centos 6 and it worked fine. I
&gt; tried installing in Centos 5.6 (It had libvirt already installed through
&gt; yum) . I did yum remove libvirt. Then I did ./configure --prefix = / , make
&gt; , make install , ldconfig. When I enter virsh after finishing these steps, I
&gt; get that error. I am not sure whether I am committing a mistake in-between.
&gt; Please correct me if I am wrong. Thank you.
&gt; &gt; --
&gt; &gt; Eric Blake   eblake@redhat.com    +1-801-349-2682
&gt; &gt; Libvirt virtualization library http://libvirt.org
&gt;

Thanks a lot for your time.

   -

Regards,

Sethuraman Subbiah


Graduate Student - NC state University
M.S in Computer Science

[Attachment #3 (text/html)]

&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On 2 August 2011 18:28, sethuraman subbiah &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:sethusubbiah@gmail.com"&gt;sethusubbiah@gmail.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt;

&lt;div class="im"&gt;&lt;br&gt;
On Aug 2, 2011, at 5:29 PM, Eric Blake wrote:&lt;br&gt;
&lt;br&gt;
&gt; [re-adding the list]&lt;br&gt;
&gt;&lt;br&gt;
&gt; On 08/02/2011 03:18 PM, sethuraman subbiah wrote:&lt;br&gt;
&gt;&gt;&gt; Libvirt shoots for monthly releases; the current schedule is feature \
freeze this weekend, then a release around the first of August.&lt;br&gt; &gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt; The new API will allow you do to either:&lt;br&gt;
&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt; virsh dumpxml --inactive --dom&gt;  file.xml&lt;br&gt;
&gt;&gt;&gt; edit file.xml&lt;br&gt;
&gt;&gt;&gt; virsh save dom dom.save --xml file.xml&lt;br&gt;
&gt;&gt;&gt; virsh restore file.save&lt;br&gt;
&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt; or:&lt;br&gt;
&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt; virsh dumpxml --inactive --dom&gt;  file.xml&lt;br&gt;
&gt;&lt;br&gt;
&gt; Using --inactive here only works if you haven't made any changes to the \
inactive configuration that differs from the currently running domain. I'd amend \
this step to 'virsh dumpxml dom &gt; file.xml' for both of these \
examples.&lt;br&gt;


&gt;&lt;br&gt;
&gt;&gt;&gt; virsh save dom dom.save&lt;br&gt;
&gt;&gt;&gt; edit file.xml&lt;br&gt;
&gt;&gt;&gt; virsh restore file.save --xml file.xml&lt;br&gt;
&gt;&lt;br&gt;
&gt; These two examples will be supported in 0.9.4.  Additionally, I added:&lt;br&gt;
&gt;&lt;br&gt;
&gt; virsh save-file-dumpxml dom.save &gt; file.xml&lt;br&gt;
&gt; virsh save-file-define dom.save file.xml&lt;br&gt;
&gt; virsh save-file-edit dom.save&lt;br&gt;
&gt;&lt;br&gt;
&gt; to do things inline, and to make it so you don't have to remember to \
'virsh dumpxml dom' prior to 'virsh save'.&lt;br&gt; \
&gt;&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I tried changing the disk image and it \
works fine. But if I try to change the mac address , I get error: unsupported \
configuration. My aim was to perform cloning and change the mac of the cloned image \
and also doing some changes inside the vm to make sure it obtains a new ip. Is there \
a possibility to get this working with the current API ? &lt;/div&gt;

&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt;&lt;div class="im"&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; I found that the latest libvirt (libvirt 0.9.4) is out.&lt;br&gt;
&gt;&lt;br&gt;
&gt; That's amazing, considering it hasn't been released yet :)  Maybe you \
are referring to 0.9.4-rc2 instead?  But at any rate, the official 0.9.4 will \
probably be released tomorrow with even more bug fixes above 0.9.4-rc2.&lt;br&gt;


&gt;&lt;br&gt;
&lt;/div&gt;Yeah , I was referring to 0.9.4-rc2 :) I will install the official libvirt \
0.9.4 tomorrow .&lt;br&gt; &lt;div class="im"&gt;&gt; &gt; I tried installing in my Centos 5.6 \
machine. After a successful installation, when I start virsh , I get :&lt;br&gt; \
&gt;&gt;&lt;br&gt; &gt;&gt; virsh: /lib/libvirt.so.0: version `LIBVIRT_PRIVATE_0.8.2' \
not found (required by virsh)&lt;br&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; Is it possible to get the latest version of libvirt 0.9.4 work on Centos 5.6 \
?  Thanks a lot for your help.&lt;br&gt; &gt;&lt;br&gt;
&gt; Yes, it should be possible, although I haven't tried it myself on centos \
(but I have tried on RHEL 5.7).  Are you sure you installed your self-built \
libvirt.so correctly?  We take great pains to ensure that libvirt.so is backwards \
compatible (no symbols are ever removed).&lt;br&gt;


&gt;&lt;br&gt;
&lt;/div&gt;I think so, I installed libvirt 0.9.4-rc2 on Centos 6 and it worked fine. I \
tried installing in Centos 5.6 (It had libvirt already installed through yum) . I did \
yum remove libvirt. Then I did ./configure --prefix = / , make , make install , \
ldconfig. When I enter virsh after finishing these steps, I get that error. I am not \
sure whether I am committing a mistake in-between. Please correct me if I am wrong. \
Thank you.&lt;br&gt;


&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;&gt; --&lt;br&gt;
&gt; Eric Blake   &lt;a href="mailto:eblake@redhat.com"&gt;eblake@redhat.com&lt;/a&gt;    \
+1-801-349-2682&lt;br&gt; &gt; Libvirt virtualization library &lt;a href="http://libvirt.org" \
target="_blank"&gt;http://libvirt.org&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks \
a lot for your time. &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;meta http-equiv="Content-Type" \
content="text/html; charset=UTF-8"&gt; &lt;meta http-equiv="Content-Style-Type" \
content="text/css"&gt; &lt;title&gt;&lt;/title&gt;
&lt;meta name="Generator" content="Cocoa HTML Writer"&gt;
&lt;meta name="CocoaVersion" content="1138"&gt;
&lt;style type="text/css"&gt;
p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
&lt;/style&gt;


&lt;p class="p1"&gt;-&lt;/p&gt;
&lt;p class="p1"&gt;Regards,&lt;/p&gt;
&lt;p class="p1"&gt;Sethuraman Subbiah&lt;/p&gt;
&lt;p class="p2"&gt;&lt;br&gt;&lt;/p&gt;
&lt;p class="p1"&gt;Graduate Student - NC state University&lt;/p&gt;
&lt;div&gt;&lt;span class="Apple-style-span" style="font-family: Helvetica; font-size: 12px; \
"&gt;M.S in Computer Science&lt;/span&gt; &lt;/div&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110707212408</emailId><senderName>Whit Blauvelt</senderName><senderEmail>whit.virt@transpect.com</senderEmail><timestampReceived>2011-07-07 21:24:08-0400</timestampReceived><subject>[libvirt-users] Is arping useful if a VM is brought up on a different (bridged) interface/machine?</subject><body>

Hi,

Using libvirt/qemu/kvm VMs, if a VM has stopped on one host and then the
identical VM is started afresh on a different host, with the exact same
(bridged) VM IP, would there be a point in having the VM run arping (or
arping2) on startup to help it be quickly found on the LAN?

Or is this built in at some level already?

Or does it not apply here?

Thanks,
Whit


</body></email><email><emailId>20110707214213</emailId><senderName>Maximilian Wilhelm</senderName><senderEmail>max@rfc2324.org</senderEmail><timestampReceived>2011-07-07 21:42:13-0400</timestampReceived><subject>[libvirt-users] KVM and &lt;interface type='ethernet'&gt;</subject><body>

Hi!

I'm trying to set up a VM with "just an tap device" with the following config
(basicly inherited from 'virsh domxml-from-native qemu-argv'):

&lt;domain type='kvm'&gt;
[...]
    &lt;interface type='ethernet'&gt;
      &lt;mac address='52:54:1f:ac:08:51'/&gt;
      &lt;target dev='foo_eth0'/&gt;
      &lt;model type='virtio'/&gt;
    &lt;/interface&gt;
[...]
  &lt;/devices&gt;
&lt;/domain&gt;

This sadly failes with:

&gt; error: Failed to start domain foo
&gt; error: internal error process exited while connecting to monitor: could not \
&gt; configure /dev/net/tun: Device or resource busy

I'm wondering why this fails as there shouldn't anything be done with
the tap device besides setting it up.

(The basic goal would be to set up a VM with a tap device, put an v4
 and v6 IP on it and let OSPF do the rest. As the &lt;script&gt; parameter
 will not work with dropped privileges I wrote a wrapper for the kvm
 binary which takes care of this via sudo. This part works, but I fail
 to get the VM started with &lt;interface type='ethernet'&gt;)

Any ideas?

Thanks
Max
-- 
&lt;@uschebit&gt; Das erklärt die Sitte. Das ist so ähnlich wie mit dem Verbeugen zur \
                Begrüßung in Japan.
            Das dient auch nur dazu, durch Begutachten der Schuhqualität den \
sozialen Rang festzustellen.


</body></email><email><emailId>20110708132503</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-07-08 13:25:03-0400</timestampReceived><subject>Re: [libvirt-users] Changing path of VM configuration files</subject><body>


On 07/08/2011 12:45 AM, Soeren Grunewald wrote:
&gt; Hallo,
&gt; 
&gt; the easiest way to do this, would be to mount /etc/libvirt to a
&gt; different location. e.g. using nfs.
&gt; $ cat /etc/fstab
&gt; &lt;nfshost&gt;:/libvirt/configs   /etc/libvirt             nfs   defaults 0 0

Beware - doing this interferes with migrations.  Each host needs an
independent location for tracking persistent configurations, otherwise
migrations will cause the destination host to stomp over the source
host's configuration before the migration is complete.  Not to mention
that restarting libvirtd on one host may accidentally try to start a
guest that is already running on another host, and having two guests on
two different hosts trying to access the same disk image is a recipe for
disaster.

Rather than share /etc/libvirt, I would instead store 'virsh dumpxml'
output into a shared location, at which point you can then 'virsh
define' the same definition into any other host, without worrying about
cross-host complications.

&gt; &lt;nfshost&gt;:/libvirt/images    /var/lib/libvirt/images  nfs   defaults 0 0

However, this is safe.  And with the latest libvirt 0.9.3 coupled with
sanlock (available in Fedora rawhide), you can also mount a sanlock
directory to take out leases on each disk image to ensure that no two
hosts accidentally start a guest pointing to an already in-use disk.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20110710233245</emailId><senderName>Dale Amon</senderName><senderEmail>amon@vnl.com</senderEmail><timestampReceived>2011-07-10 23:32:45-0400</timestampReceived><subject>Re: [libvirt-users] Creating a CENTOS VM</subject><body>

On Sun, Jul 10, 2011 at 05:20:44PM -0400, Dale Amon wrote:
&gt; I used the following command:
&gt; 
&gt; virt-install --connect qemu:///system -n server -r 512 --vcpus=1 -f \
&gt; kvm/server.cyberteams.com/root.qcow2 -s 12 -c \
&gt; iso/CentOS-5.6-x86_64-bin-DVD-1of2.iso --vnc --noautoconsole --os-type linux \
&gt; --accelerate --network=bridge:br0 --hvm 
&gt; which with a BlueOnyx CD some months ago worked fine. However
&gt; when I connected with virt-viewer, after going through the TEST
&gt; function it then claimed it could not find the CD.
&gt; 
&gt; Is CENTOS a bit strange in some way?

Never mind. I found some changes in the command syntax.

virt-install --connect qemu:///system -n server -r 512 --vcpus=1 --disk \
path=/srv/Cyberteams/kvm/server.cyberteams.com/root.qcow2,size=12 -c \
iso/CentOS-5.6-x86_64-bin-DVD-1of2.iso --vnc --noautoconsole --os-type linux \
--accelerate --network=bridge:br0 --hvm


</body></email><email><emailId>20110711012454</emailId><senderName>Dave Allan</senderName><senderEmail>dallan@redhat.com</senderEmail><timestampReceived>2011-07-11 01:24:54-0400</timestampReceived><subject>Re: [libvirt-users] NPIV + KVM</subject><body>

On Fri, Jul 01, 2011 at 04:16:17PM -0500, Eric Ross wrote:
&gt; Is this possible:
&gt; 
&gt; I would like to have a VM use a FC LUN exported to a virtual wwn
&gt; (using NPIV) as its primary disk.
&gt; 
&gt; I was thinking there might be a mechanism to say VM, boot using a
&gt; LUN with this vwwn as your primary disk?

Hi Eric,

A VM with a primary disk that's a LU accessed through a vHBA works
fine, however, right now the process is fairly manual.  You would need
to create the vHBA as described at:

http://fedoraproject.org/wiki/Features/VirtStorageManagement

When the host discovers the LUs, use /dev/disk/by-id/... when you
assign the LU to the guest.

Migration presents an additional challenge.  If you want to be able to
migrate the guest, the easiest thing to to is to create two WWNs and
expose the LUs for the guest to both of them.  You can then create the
vHBA with one WWN on the source host and with the second WWN on the
destination host.  If you use /dev/disk/by-id/... for the path that
you assign to the guest, the paths should be correct on both systems.
After migration completes, the vHBA on the source host can be
destroyed and used on the destination host for any subsequent
migrations.

Hope that helps,
Dave

</body></email><email><emailId>20110711155454</emailId><senderName>Whit Blauvelt</senderName><senderEmail>whit.virt@transpect.com</senderEmail><timestampReceived>2011-07-11 15:54:54-0400</timestampReceived><subject>[libvirt-users] Questions on libvirt hook scripts</subject><body>

Hi,

Reading http://libvirt.org/hooks.html I'm wondering of the following
implication is accurate:

Under "QEMU guest migration" it says

	At the beginning of the migration, the qemu hook script on the
	_destination_ host is executed with the "start" operation.

Above that, under "Specifics" 

	Before a QEMU guest is started, the qemu hook script is called in
	two locations; if either location fails, the guest is not started.
	The first location, since 0.9.0, is before libvirt performs any
	resource labeling.... This is called as:

	/etc/libvirt/hooks/qemu guest_name prepare begin -

	The second location, available Since 0.8.0, occurs after libvirt has
	finished labeling all resources, but has not yet started the guest,
	called as:

	/etc/libvirt/hooks/qemu guest_name start begin -

Is it accurate that under 0.9.x, starting a VM will run the qemu hook script
as both "prepare" and "start," but migrating a VM will only run the qemu
hook script as "start"? Or is the description incomplete with libvirt also
running "prepare" on migration?

Another question, under "Calling libvirt functions from within a hook
script" it says

	DO NOT DO THIS!

	A hook script must not call back into libvirt, as the libvirt daemon
	is already waiting for the script to exit.

	A deadlock is likely to occur.

That makes obvious sense. But does it apply to calling libvirt on a second
system? For example, a script might check the status of VMs on a second
system as a condition of starting a VM on first, using virsh. My guess is
that shouldn't deadlock. But then since during migration "the qemu hook
script on the _destination_ host is executed," if the destination hook
script were in turn to use virsh to check the _source_ host, then in a
roundabout way a libvirt function has been called from within the hook
script. I can't quite picture whether this particular instance would be
dangerous.

If it's accurate that the _destination_ hook script is only called with
"start" and not with "prepare," the second question matters less. The checks
on the second system that I want to do can be limited to the "prepare"
invocation, and so never loop back. 

On the other hand, if the destination hook script _is_ called with "prepare"
during migration, it would be useful to know how to tell if it's being
called as part of a migration.

TIA,
Whit

</body></email><email><emailId>20110712134545</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-07-12 13:45:45-0400</timestampReceived><subject>Re: [libvirt-users] Compatibility with Parallels Virtouzo</subject><body>

Well, vpsid is in there for a reason. If this was renamed we need to
figure out how to detect that and make the OpenVZ driver deal with it
at runtime. We definitely cannot just replace vpsid with ctid as this
would break compatibility with older OpenVZ versions. But I'm not
familiar with OpenVZ, so I'm not the one to decide here.

For testing you can just go ahead and replace vpsid with ctid and
recompile to see how far that gets you.

2011/7/12 Andreas Mauf &lt;a.mauf@syseleven.de&gt;:
&gt; It should be CTID instead of VPSID. I think this was changed in openvz
&gt; version, too: http://wiki.openvz.org/Man/vzlist.8
&gt; Can we fix this in /root/libvirt-0.9.3/srcopenvz/openvz_conf.c and
&gt; reinstall?
&gt;
&gt; 2011/7/12 Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;
&gt;&gt;
&gt;&gt; Well, as Virtuozzo is a variant of OpenVZ it'll probably be possible
&gt;&gt; to teach the OpenVZ driver to detect and deal with this similar to the
&gt;&gt; QEMU driver dealing with different variants of QEMU.
&gt;&gt;
&gt;&gt; 2011/7/12 Andreas Mauf &lt;a.mauf@syseleven.de&gt;:
&gt;&gt; &gt; Thanks! I compiled libvirt on my own and added --with-openvz. Driver is
&gt;&gt; &gt; now
&gt;&gt; &gt; available.
&gt;&gt; &gt; But as feared libvirt is using a api call that virtuozzo dont accept. Is
&gt;&gt; &gt; there a way to update those calls?
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; [root@localhost local]# LIBVIRT_DEBUG=1 virsh -c openvz:///system
&gt;&gt; &gt;&gt; [...]
&gt;&gt; &gt;&gt; 00:25:12.878: 2313: debug : do_open:1053 : trying driver 1 (OPENVZ) ...
&gt;&gt; &gt;&gt; 00:25:12.879: 2313: debug : virCommandRunAsync:1874 : About to run
&gt;&gt; &gt;&gt; /usr/sbin/vzlist -a -ovpsid,status -H
&gt;&gt; &gt;&gt; 00:25:12.901: 2313: debug : virCommandRunAsync:1890 : Command result 0,
&gt;&gt; &gt;&gt; with PID 2314
&gt;&gt; &gt;&gt; 00:25:12.902: 2313: debug : virCommandRun:1711 : Result status 0,
&gt;&gt; &gt;&gt; stdout:
&gt;&gt; &gt;&gt; '' stderr: '00:25:12.889: 2314: debug : virCommandHook:1808 : Hook is
&gt;&gt; &gt;&gt; done 0
&gt;&gt; &gt;&gt; Unknown field: vpsid
&gt;&gt; &gt;&gt; '
&gt;&gt;
&gt;&gt; Is this filed just named differently, or did Virtuozzo completely
&gt;&gt; remove this ID?
&gt;&gt;
&gt;&gt; If it's just named different then this should be simple to fix, but it
&gt;&gt; needs someone to figure this out.

</body></email><email><emailId>20110602152737</emailId><senderName>Troels Arvin</senderName><senderEmail>troels@arvin.dk</senderEmail><timestampReceived>2011-06-02 15:27:37-0400</timestampReceived><subject>[libvirt-users] io=native</subject><body>

Hello,

Regarding KVM - in particular RHEL 6.1 x86_64:

I just did a set of benchmarks comparing the effect of

&lt;driver name='qemu' type='raw' cache='none' io='native'/&gt;
versus
&lt;driver name='qemu' type='raw' cache='none'/&gt;

Using Oracle's "orion" tool with an XIV backend, I got:

With io='native':
Maximum Large MBPS=964.41
Maximum Small IOPS=11797
Minimum Small Latency=7.57

WithOUT io='native':
Maximum Large MBPS=727.42
Maximum Small IOPS=7793
Minimum Small Latency=7.56

In other words, setting the io-attribute to 'native' yields a significant 
performance improvement.

I wonder why KVM doesn't simply default to using io='native'. If that 
can't happen, then I wonder why libvirt doesn't set io='native' for 
storage attached to a guest after creation. (virt-manager sets io='native' 
for the first storage, attached during guest setup, but seems to forget 
for subsequent block-device additions).

-- 
Regards,
Troels Arvin &lt;troels@arvin.dk&gt;
http://troels.arvin.dk/

</body></email><email><emailId>20110602181709</emailId><senderName>Chun Tat David Chu</senderName><senderEmail>beyonddc.storage@gmail.com</senderEmail><timestampReceived>2011-06-02 18:17:09-0400</timestampReceived><subject>Re: [libvirt-users] libvirtError: internal error Domain mytest didn't show up</subject><body>

Problem resolved.

The XML configuration file for my VM is incorrect in /etc/libvirt/qemu
directory.

Apparently it listed two boot devices.

I am not sure how that entry get there but once I removed it now my VM can
boot.

- David

On Thu, Jun 2, 2011 at 11:49 AM, Chun Tat David Chu &lt;
beyonddc.storage@gmail.com&gt; wrote:

&gt; Hi Osier,
&gt;
&gt; The debug log from virt-manager wasn't that helpful.
&gt;
&gt; [Thu, 02 Jun 2011 11:32:26 virt-manager 5104] DEBUG (engine:496) Starting
&gt; vm 'rpmbuilderbase'.
&gt; [Thu, 02 Jun 2011 11:32:37 virt-manager 5104] DEBUG (error:76) Uncaught
&gt; Error: Error starting domain: internal error Domain rpmbuilderbase didn't
&gt; show up
&gt;  : Traceback (most recent call last):
&gt;
&gt;   File "/usr/share/virt-manager/virtManager/engine.py", line 498, in
&gt; run_domain
&gt;     vm.startup()
&gt;   File "/usr/share/virt-manager/virtManager/domain.py", line 573, in
&gt; startup
&gt;     self.vm.create()
&gt;   File "/usr/lib64/python2.4/site-packages/libvirt.py", line 287, in create
&gt;     if ret == -1: raise libvirtError ('virDomainCreate() failed', dom=self)
&gt; libvirtError: internal error Domain rpmbuilderbase didn't show up
&gt;
&gt; The log in /var/log/libvirt/qemu is a little bit more useful but I don't
&gt; really understand it.  Can someone please explains it to me?
&gt;
&gt; LC_ALL=C PATH=/sbin:/usr/sbin:/bin:/usr/bin HOME=/ /usr/libexec/qemu-kvm -S
&gt; -M pc -m 2048 -smp 1 -name rpmbuilderbase -uuid
&gt; bb226766-a712-8e31-74ed-1f971d6a8230 -monitor pty -pidfile
&gt; /var/run/libvirt/qemu//rpmbuilderbase.pid -boot cc -drive
&gt; file=/var/lib/libvirt/devmappings/rpmbuilderbase,if=ide,index=0,boot=on -net
&gt; nic,macaddr=54:52:00:68:ea:d0,vlan=0,model=e1000 -net
&gt; tap,fd=15,script=,vlan=0,ifname=vnet0 -serial pty -parallel none -usb -vnc
&gt; 127.0.0.1:0 -k en-us
&gt; Boot device 'c' was given twice
&gt;
&gt; Is the message "Boot device 'c' was given twice' a fatal error?  If so what
&gt; is the correct action to resolve the issue?
&gt;
&gt; Thanks!
&gt;
&gt; David
&gt;
&gt;
&gt; On Wed, Jun 1, 2011 at 11:33 PM, Osier Yang &lt;jyang@redhat.com&gt; wrote:
&gt;
&gt;&gt; On 06/02/2011 07:17 AM, Chun Tat David Chu wrote:
&gt;&gt;
&gt;&gt;&gt; Hi All,
&gt;&gt;&gt;
&gt;&gt;&gt; I am new using libvirt.
&gt;&gt;&gt;
&gt;&gt;&gt; I kept on getting the following error when I try to start my VM.  Can
&gt;&gt;&gt; anyone give me any suggestion on what could went wrong?
&gt;&gt;&gt;
&gt;&gt;&gt; Traceback (most recent call last):
&gt;&gt;&gt;   File "/usr/share/virt-manager/virtManager/engine.py", line 498, in
&gt;&gt;&gt; run_domain
&gt;&gt;&gt;     vm.startup()
&gt;&gt;&gt;   File "/usr/share/virt-manager/virtManager/domain.py", line 573, in
&gt;&gt;&gt; startup
&gt;&gt;&gt;     self.vm.create()
&gt;&gt;&gt;   File "/usr/lib64/python2.4/site-packages/libvirt.py", line 287, in
&gt;&gt;&gt; create
&gt;&gt;&gt;     if ret == -1: raise libvirtError ('virDomainCreate() failed',
&gt;&gt;&gt; dom=self)
&gt;&gt;&gt; libvirtError: internal error Domain mytest didn't show up
&gt;&gt;&gt;
&gt;&gt;&gt; Thanks,
&gt;&gt;&gt;
&gt;&gt;&gt; David
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt; virt-manager has debug log, ~/.virt-manager/virt-manager.log.
&gt;&gt;
&gt;&gt; And you can check libvirtd log too, by default, it's /var/log/messages,
&gt;&gt; change "log_outputs" in /etc/libvirt/libvirtd.conf if you want it logs
&gt;&gt; somewhere else.
&gt;&gt;
&gt;&gt; Change the "log_level" in /etc/libvirt/libvirtd.conf if you want to
&gt;&gt; see more log.
&gt;&gt;
&gt;&gt; Perhaps detailed log will help you find out the problem.
&gt;&gt;
&gt;&gt; Regards
&gt;&gt; Osier
&gt;&gt;
&gt;&gt;
&gt;

[Attachment #3 (text/html)]

Problem resolved.&lt;br&gt;
&lt;br&gt;
The XML configuration file for my VM is incorrect in /etc/libvirt/qemu directory.&lt;br&gt;
&lt;br&gt;
Apparently it listed two boot devices.  &lt;br&gt;
&lt;br&gt;
I am not sure how that entry get there but once I removed it now my VM can boot.&lt;br&gt;
&lt;br&gt;
- David&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Thu, Jun 2, 2011 at 11:49 AM, Chun Tat \
David Chu &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:beyonddc.storage@gmail.com"&gt;beyonddc.storage@gmail.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt; Hi Osier,&lt;br&gt;&lt;br&gt;The debug log from virt-manager \
wasn't that helpful.&lt;br&gt;&lt;br&gt;[Thu, 02 Jun 2011 11:32:26 virt-manager 5104] DEBUG \
(engine:496) Starting vm 'rpmbuilderbase'.&lt;br&gt;[Thu, 02 Jun 2011 11:32:37 \
virt-manager 5104] DEBUG (error:76) Uncaught Error: Error starting domain: internal \
error Domain rpmbuilderbase didn't show up&lt;br&gt;

 : Traceback (most recent call last):&lt;div class="im"&gt;&lt;br&gt;  File \
"/usr/share/virt-manager/virtManager/engine.py", line 498, in \
run_domain&lt;br&gt;    vm.startup()&lt;br&gt;  File \
"/usr/share/virt-manager/virtManager/domain.py", line 573, in startup&lt;br&gt;

    self.vm.create()&lt;br&gt;  File \
"/usr/lib64/python2.4/site-packages/libvirt.py", line 287, in create&lt;br&gt;    \
if ret == -1: raise libvirtError ('virDomainCreate() failed', \
dom=self)&lt;br&gt;&lt;/div&gt;libvirtError: internal error Domain rpmbuilderbase didn't show \
up&lt;br&gt;

&lt;br&gt;The log in /var/log/libvirt/qemu is a little bit more useful but I don't \
really understand it.  Can someone please explains it to me?&lt;br&gt;&lt;br&gt;LC_ALL=C \
PATH=/sbin:/usr/sbin:/bin:/usr/bin HOME=/ /usr/libexec/qemu-kvm -S -M pc -m 2048 -smp \
1 -name rpmbuilderbase -uuid bb226766-a712-8e31-74ed-1f971d6a8230 -monitor pty \
-pidfile /var/run/libvirt/qemu//rpmbuilderbase.pid -boot cc -drive \
file=/var/lib/libvirt/devmappings/rpmbuilderbase,if=ide,index=0,boot=on -net \
nic,macaddr=54:52:00:68:ea:d0,vlan=0,model=e1000 -net \
tap,fd=15,script=,vlan=0,ifname=vnet0 -serial pty -parallel none -usb -vnc &lt;a \
href="http://127.0.0.1:0" target="_blank"&gt;127.0.0.1:0&lt;/a&gt; -k en-us&lt;br&gt;

Boot device 'c' was given twice&lt;br&gt;&lt;br&gt;Is the message "Boot device \
'c' was given twice' a fatal error?  If so what is the correct action to \
resolve the issue?&lt;br&gt;&lt;br&gt;Thanks!&lt;br&gt;&lt;font color="#888888"&gt;&lt;br&gt; \
David&lt;/font&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt; On Wed, \
Jun 1, 2011 at 11:33 PM, Osier Yang &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:jyang@redhat.com" target="_blank"&gt;jyang@redhat.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex"&gt;

&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;On 06/02/2011 07:17 AM, Chun Tat David Chu wrote:&lt;br&gt;
&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex"&gt; Hi All,&lt;br&gt;
&lt;br&gt;
I am new using libvirt.&lt;br&gt;
&lt;br&gt;
I kept on getting the following error when I try to start my VM.  Can&lt;br&gt;
anyone give me any suggestion on what could went wrong?&lt;br&gt;
&lt;br&gt;
Traceback (most recent call last):&lt;br&gt;
   File "/usr/share/virt-manager/virtManager/engine.py", line 498, in&lt;br&gt;
run_domain&lt;br&gt;
     vm.startup()&lt;br&gt;
   File "/usr/share/virt-manager/virtManager/domain.py", line 573, in&lt;br&gt;
startup&lt;br&gt;
     self.vm.create()&lt;br&gt;
   File "/usr/lib64/python2.4/site-packages/libvirt.py", line 287, in \
                create&lt;br&gt;
     if ret == -1: raise libvirtError ('virDomainCreate() failed', \
                dom=self)&lt;br&gt;
libvirtError: internal error Domain mytest didn't show up&lt;br&gt;
&lt;br&gt;
Thanks,&lt;br&gt;
&lt;br&gt;
David&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;
&lt;br&gt;&lt;/div&gt;&lt;/div&gt;
virt-manager has debug log, ~/.virt-manager/virt-manager.log.&lt;br&gt;
&lt;br&gt;
And you can check libvirtd log too, by default, it's /var/log/messages,&lt;br&gt;
change "log_outputs" in /etc/libvirt/libvirtd.conf if you want it logs&lt;br&gt;
somewhere else.&lt;br&gt;
&lt;br&gt;
Change the "log_level" in /etc/libvirt/libvirtd.conf if you want to&lt;br&gt;
see more log.&lt;br&gt;
&lt;br&gt;
Perhaps detailed log will help you find out the problem.&lt;br&gt;
&lt;br&gt;
Regards&lt;br&gt;&lt;font color="#888888"&gt;
Osier&lt;br&gt;
&lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110603222417</emailId><senderName>PREETHI RAMESH</senderName><senderEmail>iampreethiramesh@gmail.com</senderEmail><timestampReceived>2011-06-03 22:24:17-0400</timestampReceived><subject>[libvirt-users] Unable to migrate a vm</subject><body>

[Attachment #2 (multipart/alternative)]


Hi!
I've attached my code
The error I got was:
run:
Domain:hda2 id 11 running hvm
libvir: Domain error : operation virDomainMigrate forbidden for read only
access
exception FOUR caught:org.libvirt.LibvirtException: operation
virDomainMigrate forbidden for read only access
level:VIR_ERR_ERROR
code:VIR_ERR_OPERATION_DENIED
domain:VIR_FROM_DOM
hasConn:false
hasDom:false
hasNet:false
message:operation virDomainMigrate forbidden for read only access
str1:operation %s forbidden for read only access
str2:virDomainMigrate
str3:null
int1:-1
int2:-1

BUILD SUCCESSFUL (total time: 9 seconds)


PLEASE help me. I've been stuck with it for three days!

[Attachment #5 (text/html)]

Hi!&lt;div&gt;I've attached my code&lt;/div&gt;&lt;div&gt;The error I got \
was:&lt;/div&gt;&lt;div&gt;&lt;div&gt;run:&lt;/div&gt;&lt;div&gt;Domain:hda2 id 11 running hvm&lt;/div&gt;&lt;div&gt;libvir: \
Domain error : operation virDomainMigrate forbidden for read only access&lt;/div&gt;&lt;div&gt; \
exception FOUR caught:org.libvirt.LibvirtException: operation virDomainMigrate \
forbidden for read only \
access&lt;/div&gt;&lt;div&gt;level:VIR_ERR_ERROR&lt;/div&gt;&lt;div&gt;code:VIR_ERR_OPERATION_DENIED&lt;/div&gt;&lt;div&gt;domain:VIR_FROM_DOM&lt;/div&gt;&lt;div&gt;hasConn:false&lt;/div&gt;
 &lt;div&gt;hasDom:false&lt;/div&gt;&lt;div&gt;hasNet:false&lt;/div&gt;&lt;div&gt;message:operation \
virDomainMigrate forbidden for read only access&lt;/div&gt;&lt;div&gt;str1:operation %s forbidden \
for read only access&lt;/div&gt;&lt;div&gt;str2:virDomainMigrate&lt;/div&gt;&lt;div&gt;str3:null&lt;/div&gt; \
&lt;div&gt;int1:-1&lt;/div&gt;&lt;div&gt;int2:-1&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;BUILD SUCCESSFUL (total time: \
9 seconds)&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;PLEASE help me. I've \
been stuck with it for three days!&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;

--0016e6d99fc0f0282004a4d60b19--


["Migrate.java" (text/x-java)]

/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/*
 * Migrate.java
 *
 * Created on 4 Jun, 2011, 1:00:04 AM
 */

package src.test.java;

import java.util.logging.Level;
import java.util.logging.Logger;
import org.libvirt.Connect;
import org.libvirt.Domain;
import org.libvirt.LibvirtException;

/**
 *
 * @author pre
 */
public class Migrate extends javax.swing.JFrame {

    /** Creates new form Migrate */
    public Migrate() {
        initComponents();
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // &lt;editor-fold defaultstate="collapsed" desc="Generated Code"&gt;
    private void initComponents() {

        jButton1 = new javax.swing.JButton();
        jButton2 = new javax.swing.JButton();
        jLabel2 = new javax.swing.JLabel();
        jLabel1 = new javax.swing.JLabel();
        vmname123 = new javax.swing.JTextField();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        jButton1.setText("Cancel");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });

        jButton2.setText("Migrate");
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });

        jLabel2.setText("Name of VM");

        jLabel1.setText("Migrate Virtual Machine");

        vmname123.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                vmname123ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout layout = new \
javax.swing.GroupLayout(getContentPane());  getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, \
                false)
                    .addGroup(layout.createSequentialGroup()
                        .addGap(95, 95, 95)
                        \
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                
                            .addGroup(layout.createSequentialGroup()
                                .addComponent(jLabel2)
                                \
.addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 113, \
                Short.MAX_VALUE)
                                .addComponent(vmname123, \
                javax.swing.GroupLayout.PREFERRED_SIZE, 88, \
                javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addComponent(jLabel1)))
                    .addGroup(layout.createSequentialGroup()
                        .addGap(211, 211, 211)
                        .addComponent(jButton2)
                        .addGap(43, 43, 43)
                        .addComponent(jButton1)))
                .addGap(88, 88, 88))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(76, 76, 76)
                .addComponent(jLabel1)
                .addGap(18, 18, 18)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                
                    .addComponent(jLabel2)
                    .addComponent(vmname123, javax.swing.GroupLayout.PREFERRED_SIZE, \
                javax.swing.GroupLayout.DEFAULT_SIZE, \
                javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(272, 272, 272)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                
                    .addComponent(jButton2)
                    .addComponent(jButton1))
                .addGap(29, 29, 29))
        );

        pack();
    }// &lt;/editor-fold&gt;

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {
        // TODO add your handling code here:
        System.exit(0);
}

    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {
        // TODO add your handling code here:
        Connect conn=null;
        Connect conn1=null;
        Connect conn2=null;
        Domain testDomain = null;

        //connect to host vm
        try{
            conn = new Connect("qemu:///system", true);
        } catch (LibvirtException e){
            System.out.println("exception ONE caught:"+e);
            System.out.println(e.getError());
        }
        //get the domain in host vm
        try {
            testDomain = conn.domainLookupByName(vmname123.getText());
        } catch (LibvirtException ex) {
            System.out.println("exception TWO CAUGHT");
            //Logger.getLogger(Migrate.class.getName()).log(Level.SEVERE, null, ex);
        }

        //check if domain is running
        try{
            
            System.out.println("Domain:" + testDomain.getName() + " id " +
                               testDomain.getID() + " running " +
                               testDomain.getOSType());
        } catch (LibvirtException e1){
            System.out.println("exception THREE caught: "+e1);
            System.out.println(e1.getError());
        }

        //connect to the guest vm
         try{
             conn1 = new Connect("qemu+ssh://root@10.129.54.254/system", true);
             //conn2 = new Connect("qemu+ssh://root@10.129.54.254/system", true);
             Domain migrate1;
             migrate1 = \
testDomain.migrate(conn1,1,null,"tcp://root@10.129.54.254:49155",0);  }catch \
(LibvirtException e2){  System.out.println("exception FOUR caught:"+e2);
            System.out.println(e2.getError());
             
    }
     
        //migrate the host to guest
        /*try{
            Domain d1;
            migrate = testDomain.migrate(conn1,1, \
"hda2","tcp://root@10.129.54.254:49155",0);  }catch (LibvirtException e3){
            System.out.println("exception five caught:"+e3);
            System.out.println(e3.getError());
        }*/
    }
private void vmname123ActionPerformed(java.awt.event.ActionEvent evt) {
    // TODO add your handling code here:
}


    /**
    * @param args the command line arguments
    */
    public static void main(String args[]) {
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new Migrate().setVisible(true);
            }
        });


    }
    // Variables declaration - do not modify
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JTextField vmname123;
    // End of variables declaration





    



</body></email><email><emailId>20110606053913</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2011-06-06 05:39:13-0400</timestampReceived><subject>[libvirt-users]  Release of libvirt-0.9.2</subject><body>

  As planned the new release is available at:

      ftp://libvirt.org/libvirt/

It is a rather large release with near 400 commits included. From
an user point of view the main improvement is likely to be when
using migration as various work has been done to extend the protocol
and to avoid having the migration command stop other concurrent
operations (like virsh list). See below for a number of new features,
improvement and bug fixes:

Features:
- Framework for lock manager plugins (Daniel P. Berrange)
- API for network config change transactions (Michal Privoznik)
- flags for setting memory parameters (Hu Tao)
- virDomainGetState public API (Jiri Denemark)
- qemu: allow blkstat/blkinfo calls during migration (Federico Simoncelli)
- Introduce migration v3 API (Daniel P. Berrange)
- Defining the Screenshot public API (Michal Privoznik)
- public API for NMI injection (Lai Jiangshan)

Documentation:
- esx: Fix driver method version annotations (Matthias Bolte)
- vbox: Fix typo in error message (Matthias Bolte)
- virsh: Document nodeinfo output (Jiri Denemark)
- Correct 'cputune' documentation example. (Neil Wilson)
- document iface-* commands (Eric Blake)
- Add initial docs about the lock managers (Daniel P. Berrange)
- maint: use consistent file name for threading notes (Eric Blake)
- Fix virTypedParameter alias comments (Matthias Bolte)
- Fix error syntax of vcpupin example XML (Osier Yang)
- Automatically generate the hvsupport.html.in file from source files (Daniel P. Berrange)
- Fix documentation for cputune parameters (Osier Yang)
- avoid double 'the' (Eric Blake)
- Add documentation about test suites (Daniel Veillard)
- updates to CA cert and client cert/key info (Doug Goldstein)
- node filesystem attr is 'accessmode', not 'mode' (Cole Robinson)

Portability:
- vbox: Fix version extraction on Windows for newer VirtualBox versions (Matthias Bolte)
- Make dlopen usage in lock manager conditional (Matthias Bolte)
- build: fix VPATH build break from previous patch (Eric Blake)
- Remove call to deprecated gnutls_certificate_type_set_priority (Daniel P. Berrange)
- Fix sysinfo/virsh build problems on Win32 (Daniel P. Berrange)
- Fix build with --with-driver-modules enabled (Matthias Bolte)
- build: fix 'make dist' for ./configure --without-remote (Eric Blake)
- virsh: time_t is not a long on FreeBSD (Matthias Bolte)
- time_t is not a long on FreeBSD, switch internal type to long long (Matthias Bolte)
- build: avoid strerror_r pitfalls (Eric Blake)
- build: fix VIR_DEBUG on mingw (Eric Blake)
- build: generate files when building without libvirtd (Wen Congyang)
- build: drop unused sys/syslimits.h header (Eric Blake)
- Fix prototype of virRun for Win32 targets (Daniel P. Berrange)
- build: tolerate unlimited group size (Eric Blake)
- Disable virCommandExec on Win32 (Daniel P. Berrange)
- command: Fix compilation on FreeBSD (Matthias Bolte)
- apparmor: Fix compilation by removing remains from virCommand conversion (Matthias Bolte)
- configure: Fix mpath check on non-Linux systems (Matthias Bolte)
- fix xdr detection and use with recent glibc (Christophe Fergeau)
- build: avoid gcc preprocessor extensions (Eric Blake)
- build: fix VPATH build with distributed generated files (Eric Blake)
- build: fix VPATH builds (Eric Blake)

Bug fixes:
- Fix QEMU p2p v2 migration when run from a v3 client (Daniel P. Berrange)
- Don't raise an error if the migration cookie is NULL (Daniel P. Berrange)
- Fix check of virKillProcess return status (Daniel P. Berrange)
- qemu: Avoid use after free in qemuCaps parsing (Jiri Denemark)
- security driver: ignore EINVAL when chowning an image file (Laine Stump)
- migrate: detect xml incompatibility (Eric Blake)
- event: avoid memory leak on cleanup (Eric Blake)
- qemu: avoid memory leak on vcpupin (Eric Blake)
- remote: avoid leak on failure (Eric Blake)
- lock: avoid leak on failure (Eric Blake)
- storage: avoid memory leak on stat failure (Eric Blake)
- storage: avoid memory leak (Eric Blake)
- libvirtd: avoid leak on failure (Eric Blake)
- command: avoid leak on failure (Eric Blake)
- Explicitly set VM state to paused after migration completes (Daniel P. Berrange)
- Fix regressions BlockStats/Info APIs in QEMU driver (Daniel P. Berrange)
- Fix minor issues in libxenlight managed save (Jim Fehlig)
- Fix auditing of disk hotunplug operations (Daniel P. Berrange)
- Avoid crash on NULL pointer in lock driver impls during hotplug (Daniel P. Berrange)
- Fix return value in lock manager hotplug methods (Daniel P. Berrange)
- Make sure virDomainSave/virDomainManagedSave reset id to -1 (Daniel P. Berrange)
- Fix handling of VIR_EVENT_HANDLE_ERROR in QEMU monitor (Daniel P. Berrange)
- security: plug regression introduced in disk probe logic (Eric Blake)
- Fix order of disks and controllers (Jiri Denemark)
- util: Fix incorrect error in PCI functions (Osier Yang)
- openvz: Restore original EOF handling in openvzGetProcessInfo (Matthias Bolte)
- openvz: Handle getline failures in openvzReadConfigParam properly (Matthias Bolte)
- conf: Fix incorrect spice graphic XML format on compression options (Michal Privoznik)
- nwfilter: reorder locks (Stefan Berger)
- openvz: Fix regression in openvzGetVPSUUID (Matthias Bolte)
- esx: Fix regression in absolute file name handling (Matthias Bolte)
- openvz: Fix regression in config file parsing (Taisuke Yamada)
- audit: fix minor off-by-one (Eric Blake)
- Fix libxl vm def handling on domU cleanup (Markus Groß)
- Fix modifying disk devices in qemu driver (Markus Groß)
- json: Avoid passing large positive 64 bit integers to QMP. (Richard W.M. Jones)
- Fix initialization of current vcpus in libxl driver (Jim Fehlig)
- qemu: Don't change ownership of file when appending to it (Michal Privoznik)
- qemu: fix typo in name - should be VHOST_NET, not VNET_HOST (Laine Stump)
- Fix QEMU -vnc arg generation with raw IPv6 addresses (Daniel P. Berrange)
- Fix peer2peer migration with transient VMs (Daniel P. Berrange)
- python: Don't free must-not-free variables (Michal Privoznik)
- python: Fix typo in bindings (Michal Privoznik)
- libvirt.spec: /var/cache/libvirt should be 0711. (Richard W.M. Jones)
- remote: remove bogus virDomainFree. (Richard W.M. Jones)
- qemudDomainMemoryPeek: change ownership/selinux label on temporary file. (Richard W.M. Jones)
- Fix QEMU migration cookie crash for guests with no graphics (Daniel P. Berrange)
- Blank out the 'listenAddr' parameter if empty string (Daniel P. Berrange)
- Improve invalid argument checks for the public API (Matthias Bolte)
- qemu: fix typo in spice migration code (Michal Privoznik)
- openvz: fix logic bug in previous patch (Eric Blake)
- Fix error reporting in stream creation code (Matthias Bolte)
- virsh: Correctly initialize libvirt (Jiri Denemark)
- Fix leak of mime type string in screenshot dispatcher (Daniel P. Berrange)
- Fix remote dispatcher for screenshot command (Daniel P. Berrange)
- Add missing initialization to 'ret' in qemu migration (Daniel P. Berrange)
- Close all sockets before cancelling QEMU migration (Daniel P. Berrange)
- Ensure we always read a full buffer in tunnelled migration (Daniel P. Berrange)
- phyp: avoid a crash (Eric Blake)
- stream: avoid use-after-free (Eric Blake)
- virsh: Fix uninitialized variable warning (Matthias Bolte)
- libxl: fix typos in previous patch (Eric Blake)
- node_device: avoid null dereference on error (Eric Blake)
- tests: avoid crash when run under gcov (Eric Blake)
- Fix two uninitialized variable warnings (Matthias Bolte)
- apparmor: Fix uninitalized variable warning in virt-aa-helper (Matthias Bolte)
- Fix qemuMigrationToFile nonull annotation (Daniel P. Berrange)

Improvements:
- API: consolidate common unreleased enums (Eric Blake)
- uml: correct command line networking parameters (Heath Petersen)
- Add call to sanlock_restrict() in QEMU lock driver (Daniel P. Berrange)
- screenshot: Expose the new API in virsh (Michal Privoznik)
- libxl: adds managed save and restore support (Markus Groß)
- libxl: get maximum memory of running domain (Markus Groß)
- Add a plugin for the 'sanlock' project (Daniel P. Berrange)
- Allow leases to be hotpluged with QEMU guests (Daniel P. Berrange)
- Support passing QEMU lock state to dest during migration (Daniel P. Berrange)
- Integrate the QEMU driver with the lock manager infrastructure (Daniel P. Berrange)
- Add higher level lock API for domain objects (Daniel P. Berrange)
- Add a 'nop' lock driver implementation. (Daniel P. Berrange)
- Support leases in guest XML and lock manager (Daniel P. Berrange)
- Allow handshake with child process during startup (Daniel P. Berrange)
- tests: really fix QEMU XML-2-ARGV graphics-spice-timeout test (Eric Blake)
- build: avoid corrupting / in RHEL 5 (Eric Blake)
- tests: Add a test for correct disk device ordering (Jiri Denemark)
- Fix QEMU XML-2-ARGV graphics-spice-timeout test (Matthias Bolte)
- remote generator: Handle some virTypedParameterPtr using functions (Matthias Bolte)
- apibuild: Restrict long usage to existing functions and structs (Matthias Bolte)
- remote generator: Legacy support for hyper to long mappings (Matthias Bolte)
- Use common parameter order for remote(De)SerializeTypedParameters (Matthias Bolte)
- openvz: Add simple test for openvzReadNetworkConf (Matthias Bolte)
- openvz: Set virtType to openvz in openvzLoadDomains (Matthias Bolte)
- storage: List directory volumes for dir/fs/netfs pools (Cole Robinson)
- tests: Add more complex domain scheme test data (Michal Privoznik)
- tests: Test for SPICE compression options (Michal Privoznik)
- Ignore backward compatibility macros in apibuild.py (Matthias Bolte)
- openvz: fix bridge devices parsing in openvzReadNetworkConf() (Jean-Baptiste Rouault)
- Allow custom XML to be passed in during migration (Daniel P. Berrange)
- Allow virsh to pass in a custom XML document for migration (Daniel P. Berrange)
- Add an API for comparing the ABI of two guest configurations (Daniel P. Berrange)
- Remove unused 'target' field in virDomainHostdevDef (Daniel P. Berrange)
- lxc: Seperate domain config loading (Osier Yang)
- openvz: Automatically disable on non-Linux systems (Matthias Bolte)
- Support maximum and current memory flags in libxl driver (Markus Groß)
- Add domainSave/Restore to libxl driver (Markus Groß)
- Add domainCoreDump to libxl driver (Markus Groß)
- Populate domid field of devices for libxenlight (Markus Groß)
- Issue full error messages when processing QEMU monitor I/O (Daniel P. Berrange)
- Don't kill QEMU process when a monitor I/O parsing error occurs (Daniel P. Berrange)
- Introduce a new event emitted when a virtualization failure occurs (Daniel P. Berrange)
- sched: provide new API shims for remaining drivers (Eric Blake)
- virsh: improve schedinfo querying ability (Eric Blake)
- remote: introduce remoteGetSchedulerParametersFlags (Eric Blake)
- qemu: introduce qemuGetSchedulerParametersFlags (Eric Blake)
- sched: introduce virDomainGetSchedulerParametersFlags (Eric Blake)
- remote: consolidate typed parameter handling (Eric Blake)
- maint: prefer newer API names internally (Eric Blake)
- libvirt.h: avoid regression, and document preferred name (Eric Blake)
- Fix virExecWithHook Prototype (Richard Laager)
- interface: reformat error logs (Laine Stump)
- interface: implement a test driver for network config transaction API. (Michal Privoznik)
- interface: Implement driver methods for network config transaction API (Michal Privoznik)
- interface: expose network config transaction API to virsh (Michal Privoznik)
- interface: implement remote protocol for network config transaction API (Michal Privoznik)
- interface: implement public APIs for libvirt transactional network changes (Michal Privoznik)
- interface: define internal driver API for network config transactions (Michal Privoznik)
- sexpr: Improve serialization error reporting (Matthias Bolte)
- qemu: implement the new flags for setting memory parameters (Hu Tao)
- qemu: implement the new flags for getting memory parameters (Hu Tao)
- qemu : support persistent add/delete network interface (KAMEZAWA Hiroyuki)
- openvz: Add simple testcase for config file parsing function (Matthias Bolte)
- Add disk attach/detach support to libxl driver (Markus Groß)
- Refactored libxl datastructure instantiation (Markus Groß)
- schema: Add graphics element passwdValidTo attribute to schema (Michal Privoznik)
- Fix sign mismatches between public API, driver API and XDR protocol (Matthias Bolte)
- remote generator: Fix XDR sign mismatch for virNodeGet(Cells)FreeMemory (Matthias Bolte)
- remote generator: Handle stream-using functions (Matthias Bolte)
- remote generator: Make call-by-reference handling stricter (Matthias Bolte)
- remote generator: Rename virNodeGetCellsFreeMemory parameters to common pattern (Matthias Bolte)
- remote generator: Handle virDomainCreateWithFlags (Matthias Bolte)
- Allow to explicitly disable the secrets a directory storage driver (Matthias Bolte)
- Fix the signature of virDomainMigrateFinish3 for error reporting (Daniel P. Berrange)
- Fix preservation of errors across migration steps (Daniel P. Berrange)
- Improve debug logging of migration APIs (Daniel P. Berrange)
- Fix error propagation in finish method for v3 migration (Daniel P. Berrange)
- Fix SPICE seamless migration hostname (Daniel P. Berrange)
- Fix resume on destination when doing non-live tunnelled migration (Daniel P. Berrange)
- Introduce two method migration APIs (Daniel P. Berrange)
- Add a second URI parameter to virDomainMigratePerform3 method (Daniel P. Berrange)
- Extend v3 migration protocol to allow app supplied XML for target (Daniel P. Berrange)
- esx: Report an error when auth pointer is missing instead of declining (Matthias Bolte)
- Perform feature flag compat checking in QEMU migration cookies (Daniel P. Berrange)
- Replace all remaining setgid/setuid calls with virSetUIDGID (Jiri Denemark)
- util: Keep errno set to the root error after when returning from virSetUIDGID (Jiri Denemark)
- storage: Add comment to picking return value of qemu-img (Michal Privoznik)
- spice: support streaming-video parameter (Alon Levy)
- nwfilter: enable filtering of gratuitous ARP packets (Stefan Berger)
- qemu: don't require is_kvm for vhost-net support (Laine Stump)
- Use per-user TLS certificates when possible (Doug Goldstein)
- storage: pick return value of qemu-img (Michal Privoznik)
- remote generator: Add special case for virConnectGetType (Matthias Bolte)
- remote generator: Don't rely on $_ being stable over a large function (Matthias Bolte)
- build: require newer gettext (Eric Blake)
- virsh: Use Env variables for debug level and logfile (Supriya Kannery)
- Don't generate cookies with v2 migration protocol. (Daniel P. Berrange)
- Ensure p2p and direct migration use the new v3 protocol if available (Daniel P. Berrange)
- remote: remove special case for getting version (Eric Blake)
- virsh: optimize creation of default connection (Eric Blake)
- Clarify that virDomainGet(Memory|Blkio)Parameters doesn't support subsets (Matthias Bolte)
- Clarify that virDomainSet(Memory|Blkio)Parameters can take parameter subsets (Matthias Bolte)
- Clarify that virDomainSetSchedulerParameters(Flags) can take subsets (Matthias Bolte)
- Clarify the semantic of virDomainGetSchedulerParameters arguments (Matthias Bolte)
- Clarify semantic of nparams argument of virDomainGetSchedulerType (Matthias Bolte)
- Fix messages using VIR_ERR_XML_ERROR (Cole Robinson)
- libvirt.h: consolidate typed parameter handling (Eric Blake)
- build: update to latest gnulib (Eric Blake)
- Add support for 'passthru' mode for direct network interfaces (Dirk Herrendorefer)
- virsh: add parameters --live, --config and --current to cmd schedinfo (Hu Tao)
- remote: introduce remoteSetSchedulerParametersFlags (Hu Tao)
- qemu: introduce qemuSetSchedulerParametersFlags (Hu Tao)
- sched: adjust parameter values to make current = 0 (Eric Blake)
- introduce virDomainSetSchedulerParametersFlags (Hu Tao)
- storage_backend: Convert virRunWithHook usage to virCommand (Cole Robinson)
- storage_backend: Fix error reporting with regex helper (Cole Robinson)
- storage: Covert regex helpers to virCommand (Cole Robinson)
- openvz: Convert virExec usage to virCommand (Cole Robinson)
- storage: iscsi: Convert virExec to virCommand (Cole Robinson)
- remote generator, client: Add more special case handling (Matthias Bolte)
- remote generator, client: Handle functions that return an optional string (Matthias Bolte)
- esx: Simplify some esxVI_Boolean to bool (Matthias Bolte)
- esx: Convert autoAnswer from esxVI_Boolean to a simple bool (Matthias Bolte)
- esx: Fix race condition in esxVI_EnsureSession (Matthias Bolte)
- esx: Whitespace cleanup in the generator (Matthias Bolte)
- esx: Change some alignments in the input file (Matthias Bolte)
- esx: Change generated method parameter autobinding (Matthias Bolte)
- virsh: Report an error when virGetUserDirectory fails (Matthias Bolte)
- maint: mark more perl scripts executable (Eric Blake)
- maint: mark perl script executable (Eric Blake)
- maint: ignore generated file (Eric Blake)
- Improve error message when XDR marshalling fails (Daniel P. Berrange)
- Run tunnelled migration IO in separate thread (Daniel P. Berrange)
- Don't overwrite error when stream send fails (Daniel P. Berrange)
- Make tunnelled migration honour resource restriction (Daniel P. Berrange)
- Refactor migration completion loop to allow code reuse (Daniel P. Berrange)
- Implement migration v3 protocol in QEMU driver (Daniel P. Berrange)
- Merge tunnel and non-tunnel migration impl into one (Daniel P. Berrange)
- Fix VM teardown if prepare returns invalid URI in v2 migration (Daniel P. Berrange)
- Refactor tunnelled migration methods (Daniel P. Berrange)
- Wire up SPICE client relocation with QEMU migration (Daniel P. Berrange)
- Pass graphics setup from dst back to src via migration cookies (Daniel P. Berrange)
- Introduce migration cookies to QEMU driver (Daniel P. Berrange)
- Fix locking with qemuMigrationPrepareTunnel method (Daniel P. Berrange)
- Remote driver implementation of new migration API (Daniel P. Berrange)
- Add many version number annotations to drivers (Daniel P. Berrange)
- Convert all driver struct intializers to C99 style (Daniel P. Berrange)
- Tweak driver naming for consistency with public API (Daniel P. Berrange)
- qemu: Update domain state when reconnecting monitor (Jiri Denemark)
- Implement domain state reason (Jiri Denemark)
- Implement basic virDomainGetState in all drivers (Jiri Denemark)
- virsh: Prefer virDomainGetState over virDomainGetInfo (Jiri Denemark)
- Wire protocol format and remote driver for virDomainGetState (Jiri Denemark)
- virDomainGetState public API implementation (Jiri Denemark)
- Internal driver API for virDomainGetState (Jiri Denemark)
- esx: Refactor common code in the generator (Matthias Bolte)
- esx: Improve dynamic cast detection in the generator (Matthias Bolte)
- esx: Improve list usage detection in the generator (Matthias Bolte)
- esx: Remove 1000 lines of generated but unused code (Matthias Bolte)
- esx: Generate implicit _this macros (Matthias Bolte)
- esx: Move the Event type from the VI generator to manually written code (Matthias Bolte)
- test: all test_scripts should be part of tarball when building without libvirtd (Wen Congyang)
- build: probes.d and libvirtd.stp should be part of tarball (Wen Congyang)
- remote: Convert SSH tunnel to virCommand (Cole Robinson)
- storage: Convert qemu-img -help parsing to virCommand (Cole Robinson)
- apparmor: Convert virExec usage to virCommand (Cole Robinson)
- util: Combine __virExec and virExecWithHook (Cole Robinson)
- remote_driver: Convert virExecDaemonize usage to virCommand (Cole Robinson)
- remote: Use virDomainEventState helpers (Cole Robinson)
- libxl: Convert to virDomainEventState (Cole Robinson)
- test: Use virDomainEventState helpers (Cole Robinson)
- lxc: Use virDomainEventState helpers (Cole Robinson)
- qemu: Use virDomainEventState helpers (Cole Robinson)
- domain_event: Add common domain event queue/flush helpers (Cole Robinson)
- domain_event: Add virDomainEventState structure (Cole Robinson)
- xml: Use virXMLParse* helpers everywhere (Cole Robinson)
- domain: Require init node for container guests (Cole Robinson)
- xml: Make sure virXpathNodeSet always sets an error (Cole Robinson)
- vbox: Implement the Screenshot driver methods (Michal Privoznik)
- qemu: Implement the Screenshot driver methods (Michal Privoznik)
- virFDStream: Add option for delete file after it's opening (Michal Privoznik)
- Implementing the Screenshot remote protocol (Michal Privoznik)
- Implementing the Screenshot public API (Michal Privoznik)
- Defining the Screenshot internal API (Michal Privoznik)
- remote generator: Add skipgen/autogen flags to .x files (Matthias Bolte)
- nwfilter: drop unused flag argument (Eric Blake)
- maint: omit translation for all VIR_INFO (Eric Blake)
- build: wrap macro body in one-shot do-while loop (Eric Blake)
- build: drop need for VIR_DOMAIN_DEBUG0() (Eric Blake)
- libvirt,logging: cleanup VIR_XXX0() (Lai Jiangshan)
- maint: avoid a couple of gnulib regressions (Eric Blake)
- build: remove some dead assignments (Eric Blake)
- Allow destroying QEMU VM even if a job is active (Daniel P. Berrange)
- Add support for YAJL version 2 API/ABI (Daniel P. Berrange)
- libxl: support enabling the HPET (Paolo Bonzini)
- libxl: support enabling the HPET (Paolo Bonzini)
- xen: parse and generate hpet item in sxpr (Paolo Bonzini)
- virsh: flexibility in CA cert and user cert/key (Doug Goldstein)
- remote generator: Make parsing stricter (Matthias Bolte)
- remote generator: Unify unsigned int notation in .x files (Matthias Bolte)
- remote generator: Fix comment ignoring regex (Matthias Bolte)
- Rename internal DumpXML functions to GetXMLDesc (Matthias Bolte)
- qemu,inject-nmi: Implement the driver methods (Lai Jiangshan)
- inject-nmi: Expose the new API in virsh (Lai Jiangshan)
- inject-nmi: Implementing the remote protocol (Lai Jiangshan)
- inject-nmi: Implementing the public API (Lai Jiangshan)
- inject-nmi: Defining the internal API (Lai Jiangshan)
- lxc: container: Build init cmd before we close stdout (Cole Robinson)
- lxc: container: Convert init node exec to virCommand (Cole Robinson)
- command: Add virCommandExec helper (Cole Robinson)
- lxc: driver: Improve logging when launching emulator (Cole Robinson)
- lxc: driver: Convert emulator launching to virCommand (Cole Robinson)
- command: Add virCommandEnvAddFormat (Cole Robinson)
- build: translate generated strings (Eric Blake)
- Pull in gnulib fnmatch module (Daniel P. Berrange)
- json: Fix *GetBoolean functions (Jiri Denemark)
- build: rebuild generated files after rpcgen_fix.pl tweak (Eric Blake)
- Re-add libvirt.spec to tarball to allwo "make rpm" (Daniel Veillard)
- build: Remove all generated RPC files from GIT (Daniel P. Berrange)
- build: refactor generated RPC files (Daniel P. Berrange)
- build: rename generated files to .h, for automake's sake (Eric Blake)
- remote generator, client: Handle arguments with limited length (Matthias Bolte)
- remote generator, client: Handle functions that return lists (Matthias Bolte)
- remote: Refactor remote*Open and remote*Close functions (Matthias Bolte)
- remote generator, client: Handle functions with optional return values (Matthias Bolte)
- remote generator, client: Handle functions with multiple return values (Matthias Bolte)
- remote generator, client: Handle functions with wrapped return values (Matthias Bolte)
- remote generator, client: Handle functions with simple return values (Matthias Bolte)
- remote generator, client: Handle simple remote driver functions (Matthias Bolte)
- remote generator: Reorder into prepare and print section (Matthias Bolte)
- remote generator, daemon: Handle functions with multiple return values (Matthias Bolte)
- remote generator, daemon: Combine multiple ifs in the generated code (Matthias Bolte)
- remote generator, daemon: Handle the CPU functions (Matthias Bolte)
- remote generator: Refactor duplicate code (Matthias Bolte)
- remote generator, daemon: Handle functions that return lists (Matthias Bolte)
- remote: Rename 'nameslen' to the common 'maxnames' (Matthias Bolte)
- remote generator, daemon: Handle functions with optional arguments (Matthias Bolte)
- remote generator, daemon: Handle more functions (Matthias Bolte)
- remote generator, daemon: Handle simple-return-value functions (Matthias Bolte)
- remote generator, daemon: Change capitalization of some words (Matthias Bolte)
- remote: Replace 'domain' with 'dom' in the XDR protocol (Matthias Bolte)
- remote generator, daemon: Output function bodies too (Matthias Bolte)
- remote generator: Replace tabs with spaces and rename file (Matthias Bolte)
- Balloon dom0 in libxl driver (Markus Groß)
- remote: check actual access to the cert (Doug Goldstein)
- maint: avoid comparisons to bool constants (Eric Blake)
- Add warning message to XML definition files stored on disk (Michal Privoznik)
- Fix security driver handling of FIFOs with QEMU (Daniel P. Berrange)
- Make taint warnings also go into the domain logfile (Daniel P. Berrange)
- Add a qemuDomainAppendLog method for writing to the domain logfile (Daniel P. Berrange)
- Move qemuProcessLogReadFD and qemuProcessLogFD methods (Daniel P. Berrange)
- Log taint warnings in QEMU driver (Daniel P. Berrange)
- Add field to virDomainObjPtr to track "tainting" (Daniel P. Berrange)
- virsh: improve TLS certificate error messages (Doug Goldstein)
- virsh: use new method for easier log to file (Eric Blake)
- buf: add virBufferVasprintf (Eric Blake)
- maint: rename virBufferVSprintf to virBufferAsprintf (Eric Blake)
- Make QEMU migration use cached qemu capabilities data (Daniel P. Berrange)
- Make QEMU hotplug use cached qemu capabilities data (Daniel P. Berrange)
- Persist qemu capabilities in the domain status file (Daniel P. Berrange)

Cleanups:
- build: silence coverity false positive (Eric Blake)
- build: silence coverity false positive (Eric Blake)
- .gitignore: Exempt a new test binary. (Eric Blake)
- Ensure hvsupport.html.in is built before HTML validation (Daniel P. Berrange)
- Fix a make check error (Daniel Veillard)
- Add sexpr.c to the list of file with translatable messages (Matthias Bolte)
- don't check flags in virDomainSetSchedulerParametersFlags (Hu Tao)
- build: silence clang false positive (Eric Blake)
- Remove obsolete remoteDispatchOOMError method (Daniel P. Berrange)
- remote: keep 'make check' happy (Eric Blake)
- build: avoid compiler warning during configure (Wen Congyang)
- Remove bogus assert() from migration code (Daniel P. Berrange)
- build: drop files generated by config.status from tarball (Eric Blake)

  Thanks everybody for contributing to the release, with documentation,
ideas, feedback or patches !


Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

</body></email><email><emailId>20110608091434</emailId><senderName></senderName><senderEmail>arun.sasi1@wipro.com</senderEmail><timestampReceived>2011-06-08 09:14:34-0400</timestampReceived><subject>Re: [libvirt-users] [Qemu-devel] Qcow2</subject><body>

Hello Stephen.

 

Error from Syslog messages.

-----------------------------

May 30 11:36:49 sd0005srv01 libvirtd: 11:36:49.044: error : internal
error Timed out while reading console log output May 30 11:36:49
sd0005srv01 libvirtd: 11:36:49.044: error : internal error unable to
start guest:

-------------------------

 

----------------------------

May 30 12:21:29 sd0005srv01 kernel: [19836592.317217] device vnet0
entered promiscuous mode May 30 12:21:29 sd0005srv01 kernel:
[19836592.319449] br0: port 2(vnet0) entering learning state

May 30 12:21:29 sd0005srv01 nm-system-settings:    SCPlugin-Ifupdown:
device added (udi: /org/freedesktop/Hal/devices/net_ce_1b_36_05_70_14,
iface: vnet0): not well known

May 30 12:21:30 sd0005srv01 avahi-daemon[3449]: Registering new address
record for fe80::cc1b:36ff:fe05:7014 on vnet0.*.

May 30 12:21:33 sd0005srv01 nm-system-settings: Added default wired
connection 'Auto vnet0' for
/org/freedesktop/Hal/devices/net_ce_1b_36_05_70_14

May 30 12:21:38 sd0005srv01 kernel: [19836601.316008] br0: topology
change detected, propagating May 30 12:21:38 sd0005srv01 kernel:
[19836601.316014] br0: port 2(vnet0) entering forwarding state May 30
12:21:39 sd0005srv01 kernel: [19836602.949751] vnet0: no IPv6 routers
present May 30 12:21:59 sd0005srv01 libvirtd: 12:21:59.278: error :
internal error Timed out while reading console log output May 30
12:21:59 sd0005srv01 libvirtd: 12:21:59.278: error : internal error
unable to start guest:

May 30 12:21:59 sd0005srv01 avahi-daemon[3449]: Withdrawing address
record for fe80::cc1b:36ff:fe05:7014 on vnet0.

May 30 12:21:59 sd0005srv01 kernel: [19836622.479659] br0: port 2(vnet0)
entering disabled state May 30 12:21:59 sd0005srv01 kernel:
[19836622.493771] device vnet0 left promiscuous mode May 30 12:21:59
sd0005srv01 kernel: [19836622.493773] br0: port 2(vnet0) entering
disabled state

May 30 12:21:59 sd0005srv01 nm-system-settings:    SCPlugin-Ifupdown:
devices removed (udi: /org/freedesktop/Hal/

------------------------------------------------------

 

XML File

-------------

&lt;domain type='kvm'&gt;

  &lt;name&gt;sy0005embinf02&lt;/name&gt;

  &lt;uuid&gt;9ddfc4b5-51bc-c3e9-3aea-59101bc15174&lt;/uuid&gt;

  &lt;memory&gt;4096000&lt;/memory&gt;

  &lt;currentMemory&gt;524288&lt;/currentMemory&gt;

  &lt;vcpu&gt;4&lt;/vcpu&gt;

  &lt;os&gt;

    &lt;type arch='x86_64' machine='pc'&gt;hvm&lt;/type&gt;

    &lt;boot dev='hd'/&gt;

  &lt;/os&gt;

  &lt;features&gt;

    &lt;acpi/&gt;

    &lt;apic/&gt;

    &lt;pae/&gt;

  &lt;/features&gt;

  &lt;clock offset='utc'/&gt;

  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;

  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;

  &lt;on_crash&gt;restart&lt;/on_crash&gt;

  &lt;devices&gt;

    &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;

    &lt;disk type='file' device='cdrom'&gt;

      &lt;target dev='hdc' bus='ide'/&gt;

      &lt;readonly/&gt;

    &lt;/disk&gt;

    &lt;disk type='file' device='disk'&gt;

      &lt;source file='/var/lib/libvirt/images/sy0005embinf02.img'/&gt;

      &lt;target dev='vda' bus='virtio'/&gt;

    &lt;/disk&gt;

    &lt;disk type='file' device='disk'&gt;

      &lt;source file='/var/lib/libvirt/images/sy0005embinf02_vdb.img'/&gt;

      &lt;target dev='vdb' bus='virtio'/&gt;

    &lt;/disk&gt;

    &lt;interface type='bridge'&gt;

      &lt;mac address='00:16:36:1d:67:9e'/&gt;

      &lt;source bridge='br0'/&gt;

      &lt;model type='virtio'/&gt;

    &lt;/interface&gt;

    &lt;serial type='pty'&gt;

      &lt;source path='/dev/pts/11'/&gt;

      &lt;target port='0'/&gt;

    &lt;/serial&gt;

    &lt;console type='pty' tty='/dev/pts/11'&gt;

      &lt;source path='/dev/pts/11'/&gt;

      &lt;target port='0'/&gt;

    &lt;/console&gt;

    &lt;input type='mouse' bus='ps2'/&gt;

    &lt;graphics type='vnc' port='-1' autoport='yes' keymap='en-us'/&gt;

    &lt;sound model='es1370'/&gt;

  &lt;/devices&gt;

&lt;/domain&gt;

 

 

Thanks,

-Arun

 

-----Original Message-----
From: Stefan Hajnoczi [mailto:stefanha@gmail.com] 
Sent: Wednesday, June 08, 2011 1:49 PM
To: Arun Sasi V (WI01 - Manage IT)
Cc: stefanha@linux.vnet.ibm.com; qemu-devel@nongnu.org;
libvirt-users@redhat.com
Subject: Re: [Qemu-devel] Qcow2

 

On Tue, Jun 7, 2011 at 6:10 PM,  &lt;arun.sasi1@wipro.com&gt; wrote:

&gt; Any update on this... what could be the reason... If I am not able to

&gt; start VM and if I add two virtual hard disk and one virtual hard disk
is

&gt; more than 500GB.

&gt; 

&gt; Virtual harddisk type is virtio. Created by using qcow2

 

Sorry, nothing obvious from your error output.  I recommend running a

recent distro.

 

Stefan


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:x="urn:schemas-microsoft-com:office:excel" \
xmlns:p="urn:schemas-microsoft-com:office:powerpoint" \
xmlns:a="urn:schemas-microsoft-com:office:access" \
xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882" \
xmlns:s="uuid:BDC6E3F0-6DA3-11d1-A2A3-00AA00C14882" \
xmlns:rs="urn:schemas-microsoft-com:rowset" xmlns:z="#RowsetSchema" \
xmlns:b="urn:schemas-microsoft-com:office:publisher" \
xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" \
xmlns:c="urn:schemas-microsoft-com:office:component:spreadsheet" \
xmlns:odc="urn:schemas-microsoft-com:office:odc" \
xmlns:oa="urn:schemas-microsoft-com:office:activation" \
xmlns:html="http://www.w3.org/TR/REC-html40" \
xmlns:q="http://schemas.xmlsoap.org/soap/envelope/" \
xmlns:rtc="http://microsoft.com/officenet/conferencing" xmlns:D="DAV:" \
xmlns:Repl="http://schemas.microsoft.com/repl/" \
xmlns:mt="http://schemas.microsoft.com/sharepoint/soap/meetings/" \
xmlns:x2="http://schemas.microsoft.com/office/excel/2003/xml" \
xmlns:ppda="http://www.passport.com/NameSpace.xsd" \
xmlns:ois="http://schemas.microsoft.com/sharepoint/soap/ois/" \
xmlns:dir="http://schemas.microsoft.com/sharepoint/soap/directory/" \
xmlns:ds="http://www.w3.org/2000/09/xmldsig#" \
xmlns:dsp="http://schemas.microsoft.com/sharepoint/dsp" \
xmlns:udc="http://schemas.microsoft.com/data/udc" \
xmlns:xsd="http://www.w3.org/2001/XMLSchema" \
xmlns:sub="http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/" \
xmlns:ec="http://www.w3.org/2001/04/xmlenc#" \
xmlns:sp="http://schemas.microsoft.com/sharepoint/" \
xmlns:sps="http://schemas.microsoft.com/sharepoint/soap/" \
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" \
xmlns:udcs="http://schemas.microsoft.com/data/udc/soap" \
xmlns:udcxf="http://schemas.microsoft.com/data/udc/xmlfile" \
xmlns:udcp2p="http://schemas.microsoft.com/data/udc/parttopart" \
xmlns:wf="http://schemas.microsoft.com/sharepoint/soap/workflow/" \
xmlns:dsss="http://schemas.microsoft.com/office/2006/digsig-setup" \
xmlns:dssi="http://schemas.microsoft.com/office/2006/digsig" \
xmlns:mdssi="http://schemas.openxmlformats.org/package/2006/digital-signature" \
xmlns:mver="http://schemas.openxmlformats.org/markup-compatibility/2006" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns:mrels="http://schemas.openxmlformats.org/package/2006/relationships" \
xmlns:spwp="http://microsoft.com/sharepoint/webpartpages" \
xmlns:ex12t="http://schemas.microsoft.com/exchange/services/2006/types" \
xmlns:ex12m="http://schemas.microsoft.com/exchange/services/2006/messages" \
xmlns:pptsl="http://schemas.microsoft.com/sharepoint/soap/SlideLibrary/" \
xmlns:spsl="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService" \
xmlns:Z="urn:schemas-microsoft-com:" xmlns:st="" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 12 (filtered medium)"&gt;
&lt;style&gt;
&lt;!--
 /* Font Definitions */
 @font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{mso-style-priority:99;
	mso-style-link:"Plain Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:10.5pt;
	font-family:Consolas;}
span.PlainTextChar
	{mso-style-name:"Plain Text Char";
	mso-style-priority:99;
	mso-style-link:"Plain Text";
	font-family:Consolas;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.Section1
	{page:Section1;}
--&gt;
&lt;/style&gt;
&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapelayout v:ext="edit"&gt;
  &lt;o:idmap v:ext="edit" data="1" /&gt;
 &lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
&lt;/head&gt;

&lt;body lang=EN-US link=blue vlink=purple&gt;

&lt;div class=Section1&gt;

&lt;p class=MsoPlainText&gt;Hello Stephen.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;Error from Syslog messages.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;-----------------------------&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;May 30 11:36:49 sd0005srv01 libvirtd: 11:36:49.044: error
&gt; internal error Timed out while reading console log output May 30 11:36:49
sd0005srv01 libvirtd: 11:36:49.044: error : internal error unable to start
guest:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;-------------------------&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;----------------------------&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;May 30 12:21:29 sd0005srv01 kernel: [19836592.317217]
device vnet0 entered promiscuous mode May 30 12:21:29 sd0005srv01 kernel:
[19836592.319449] br0: port 2(vnet0) entering learning state&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;May 30 12:21:29 sd0005srv01 \
                nm-system-settings:   
SCPlugin-Ifupdown: device added (udi:
/org/freedesktop/Hal/devices/net_ce_1b_36_05_70_14, iface: vnet0): not well
known&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;May 30 12:21:30 sd0005srv01 avahi-daemon[3449]:
Registering new address record for fe80::cc1b:36ff:fe05:7014 on \
vnet0.*.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;May 30 12:21:33 sd0005srv01 nm-system-settings: Added
default wired connection 'Auto vnet0' for
/org/freedesktop/Hal/devices/net_ce_1b_36_05_70_14&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;May 30 12:21:38 sd0005srv01 kernel: [19836601.316008]
br0: topology change detected, propagating May 30 12:21:38 sd0005srv01 kernel:
[19836601.316014] br0: port 2(vnet0) entering forwarding state May 30 12:21:39
sd0005srv01 kernel: [19836602.949751] vnet0: no IPv6 routers present May 30
12:21:59 sd0005srv01 libvirtd: 12:21:59.278: error : internal error Timed out
while reading console log output May 30 12:21:59 sd0005srv01 libvirtd:
12:21:59.278: error : internal error unable to start guest:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;May 30 12:21:59 sd0005srv01 avahi-daemon[3449]:
Withdrawing address record for fe80::cc1b:36ff:fe05:7014 on vnet0.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;May 30 12:21:59 sd0005srv01 kernel: [19836622.479659]
br0: port 2(vnet0) entering disabled state May 30 12:21:59 sd0005srv01 kernel:
[19836622.493771] device vnet0 left promiscuous mode May 30 12:21:59
sd0005srv01 kernel: [19836622.493773] br0: port 2(vnet0) entering disabled
state&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;May 30 12:21:59 sd0005srv01 \
                nm-system-settings:   
SCPlugin-Ifupdown: devices removed (udi: /org/freedesktop/Hal/&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;------------------------------------------------------&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;


&lt;p class=MsoPlainText&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;XML File&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;-------------&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;domain type='kvm'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;  &lt;name&gt;sy0005embinf02&lt;/name&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt; 
&lt;uuid&gt;9ddfc4b5-51bc-c3e9-3aea-59101bc15174&lt;/uuid&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;  &lt;memory&gt;4096000&lt;/memory&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;  \
&lt;currentMemory&gt;524288&lt;/currentMemory&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;  &lt;vcpu&gt;4&lt;/vcpu&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;  &lt;os&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;    &lt;type arch='x86_64' \
machine='pc'&gt;hvm&lt;/type&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;    &lt;boot dev='hd'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;  &lt;/os&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;  &lt;features&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;    &lt;acpi/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;    &lt;apic/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;    &lt;pae/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;  &lt;/features&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;  &lt;clock offset='utc'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;  \
&lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;  \
&lt;on_reboot&gt;restart&lt;/on_reboot&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;  &lt;on_crash&gt;restart&lt;/on_crash&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;  &lt;devices&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;    \
&lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;    &lt;disk type='file' \
device='cdrom'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;      &lt;target dev='hdc' \
bus='ide'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;      &lt;readonly/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;    &lt;/disk&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;    &lt;disk type='file' \
device='disk'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;      &lt;source
file='/var/lib/libvirt/images/sy0005embinf02.img'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;      &lt;target dev='vda' \
bus='virtio'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;    &lt;/disk&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;    &lt;span \
style='background:yellow;mso-highlight:yellow'&gt;&lt;disk type='file' \
device='disk'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;span \
style='background:yellow;mso-highlight:yellow'&gt;      \
&lt;source file='/var/lib/libvirt/images/sy0005embinf02_vdb.img'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoPlainText&gt;&lt;span \
style='background:yellow;mso-highlight:yellow'&gt;      \
&lt;target dev='vdb' bus='virtio'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;span \
style='background:yellow;mso-highlight:yellow'&gt;    \
&lt;/disk&gt;&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;    &lt;interface \
type='bridge'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;      &lt;mac \
address='00:16:36:1d:67:9e'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;      &lt;source \
bridge='br0'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;      &lt;model \
type='virtio'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;    &lt;/interface&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;    &lt;serial type='pty'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;      &lt;source \
path='/dev/pts/11'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;      &lt;target \
port='0'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;    &lt;/serial&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;    &lt;console type='pty' \
tty='/dev/pts/11'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;      &lt;source \
path='/dev/pts/11'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;      &lt;target \
port='0'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;    &lt;/console&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;    &lt;input type='mouse' \
bus='ps2'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;    &lt;graphics type='vnc' port='-1' \
autoport='yes' keymap='en-us'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;    &lt;sound model='es1370'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;  &lt;/devices&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;/domain&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;Thanks,&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;-Arun&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;-----Original Message-----&lt;br&gt;
From: Stefan Hajnoczi [mailto:stefanha@gmail.com] &lt;br&gt;
Sent: Wednesday, June 08, 2011 1:49 PM&lt;br&gt;
To: Arun Sasi V (WI01 - Manage IT)&lt;br&gt;
Cc: stefanha@linux.vnet.ibm.com; qemu-devel@nongnu.org;
libvirt-users@redhat.com&lt;br&gt;
Subject: Re: [Qemu-devel] Qcow2&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;On Tue, Jun 7, 2011 at 6:10 PM, 
&lt;arun.sasi1@wipro.com&gt; wrote:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; Any update on this... what could be the reason... If
I am not able to&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; start VM and if I add two virtual hard disk and one
virtual hard disk is&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; more than 500GB.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; Virtual harddisk type is virtio. Created by using
qcow2&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;Sorry, nothing obvious from your error output.  I
recommend running a&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;recent distro.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;Stefan&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;



</body></email><email><emailId>20110503020923</emailId><senderName>Whit Blauvelt</senderName><senderEmail>whit.virt@transpect.com</senderEmail><timestampReceived>2011-05-03 02:09:23-0400</timestampReceived><subject>Re: [libvirt-users] LibVirtD Networking</subject><body>

On Mon, May 02, 2011 at 09:12:15PM -0400, ssaleh@nrln.us wrote:

&gt; Can I support 5 VM's with the three raminging NIC's?  Should I use virtual
&gt; IP's for the 5 VM's? Should I use a single NIC for all 5 VM's (similar to
&gt; what VMWare does)?

The simplest would be to bridge one NIC for the host and your 5 VMs. Use
another for your LAN, and let the other two sit idle. If your router to the
ISP can handle bonding, bond two NICs then bridge that, in case one NIC
fails - but most likely it doesn't.

Whit

</body></email><email><emailId>20110518165836</emailId><senderName>Stefan Hajnoczi</senderName><senderEmail>stefanha@gmail.com</senderEmail><timestampReceived>2011-05-18 16:58:36-0400</timestampReceived><subject>Re: [libvirt-users] [Qemu-devel] Qcow2</subject><body>

On Wed, May 18, 2011 at 5:18 PM,  &lt;arun.sasi1@wipro.com&gt; wrote:
&gt; Hello Stefan,
&gt;
&gt;
&gt;
&gt; Thank you very much for considering my issue...
&gt;
&gt;
&gt;
&gt; Here is My problem...
&gt;
&gt;
&gt;
&gt; 1) I have 4 VM`s Running on Base server.
&gt;
&gt; 2) Base server is having 15GB RAM.
&gt;
&gt; 3) I can start all VM`s apart from my file server.
&gt;
&gt; 4) File server is having OS image and 1.2TB QCOW2 Image.
&gt;
&gt; 5) When I remove 1.2TB from xml file (vdb.img) I can start my server but
&gt; Data partition is null becase I have not added 1.2TB in XML.
&gt;
&gt; 6) Command I am using virsh start &lt;Domain&gt;
&gt;
&gt; 7) Even through virt-manager also I am not able to start the VM. Attached is
&gt; the error message

Unfortunately the message gives no details:
"libvirtError: internal error unable to start guest:"

&gt; 8) Keep on trying adding and removing and defining the XML after 2 Hrs I am
&gt; able to start.

What did you change that made it work?

&gt; 9) Operating system Ubuntu 9.04
&gt;
&gt; 10) I have 3 location file server having the same issue… even all file
&gt; servers are same configuration…

Libvirt keeps log files for each VM under
/var/log/libvirt/qemu/&lt;domain&gt;.log.  You might find more detailed
error information in that file and it will at least contain the
qemu-kvm command-line used to launch the domain.  Please take a look
at that file and post the lines surrounding the error, especially the
"starting up" log line.

Have you verified that the .qcow2 image file is accessible, ownership
and permissions should be the same as the image files of your other
domains.

Stefan

&gt; -----Original Message-----
&gt; From: Stefan Hajnoczi [mailto:stefanha@linux.vnet.ibm.com]
&gt; Sent: Wednesday, May 18, 2011 9:28 PM
&gt; To: Arun Sasi V (WI01 - Manage IT)
&gt; Subject: Re: Qcow2
&gt;
&gt;
&gt;
&gt; On Wed, May 18, 2011 at 07:30:05PM +0530, arun.sasi1@wipro.com wrote:
&gt;
&gt;&gt; The Guest VM which is larger example 1.2TB is not starting after the
&gt;
&gt;&gt; base server reboot... Pleae help what needs to be do in this situation.
&gt;
&gt;
&gt;
&gt; You have not provided information on what is happening.  Are you getting
&gt;
&gt; an error message during boot from the 1.2TB guest?  Is the 1.2TB guest
&gt;
&gt; even being autostarted (use "virsh autostart &lt;domain&gt;" to enable
&gt;
&gt; autostart on a domain)?
&gt;
&gt;
&gt;
&gt; Please send support questions like this to qemu-devel@nongnu.org in the
&gt;
&gt; future.  That way other people in the QEMU community can help too.
&gt;
&gt;
&gt;
&gt; Stefan
&gt;
&gt; Please do not print this email unless it is absolutely necessary.
&gt;
&gt; The information contained in this electronic message and any attachments to
&gt; this message are intended for the exclusive use of the addressee(s) and may
&gt; contain proprietary, confidential or privileged information. If you are not
&gt; the intended recipient, you should not disseminate, distribute or copy this
&gt; e-mail. Please notify the sender immediately and destroy all copies of this
&gt; message and any attachments.
&gt;
&gt; WARNING: Computer viruses can be transmitted via email. The recipient should
&gt; check this email and any attachments for the presence of viruses. The
&gt; company accepts no liability for any damage caused by any virus transmitted
&gt; by this email.
&gt;
&gt; www.wipro.com

</body></email><email><emailId>20110518181505</emailId><senderName></senderName><senderEmail>arun.sasi1@wipro.com</senderEmail><timestampReceived>2011-05-18 18:15:05-0400</timestampReceived><subject>Re: [libvirt-users] [Qemu-devel] Qcow2</subject><body>

Stefan,

 

I was getting only the problem with audio(only Warning and error log)
when I checking the logs

{snip}

LC_ALL=C
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
HOME=/root USER=root LOGNAME=root TMPDIR=/tmp/root-tmp.2af1b17/files
/usr/bin/kvm -S -M pc -m 512 -smp 4 -name sy0005embinf02 -uuid
9ddfc4b5-51bc-c3e9-3aea-59101bc15174 -monitor pty -pidfile
/var/run/libvirt/qemu//sy0005embinf02.pid -boot c -drive
file=,if=ide,media=cdrom,index=2 -drive
file=/var/lib/libvirt/images/sy0005embinf02.img,if=virtio,index=0,boot=o
n -drive
file=/var/lib/libvirt/images/sy0005embinf02_vdb.img,if=virtio,index=1
-net nic,macaddr=00:16:36:1d:67:9e,vlan=0,model=virtio -net
tap,fd=23,script=,vlan=0,ifname=vnet2 -serial pty -parallel none -usb
-vnc 127.0.0.1:2 -k en-us -soundhw es1370

 

cont

oss: Could not initialize DAC

oss: Failed to open `/dev/dsp'

oss: Reason: No such file or directory

oss: Could not initialize DAC

oss: Failed to open `/dev/dsp'

oss: Reason: No such file or directory

audio: Failed to create voice `es1370.dac2'

oss: Could not initialize ADC

oss: Failed to open `/dev/dsp'

oss: Reason: No such file or directory

oss: Could not initialize ADC

oss: Failed to open `/dev/dsp'

oss: Reason: No such file or directory

audio: Failed to create voice `es1370.adc'

{snip}

 

When it was not booting up I just given full permission

-rw-r--r-- 1 root root 384M 2010-10-06 08:01 sy0005embinf01.img.gz

-rw-rw-rw- 1 root root   45 2010-10-06 15:43 SLBTemplate.img

-rw-r--r-- 1 root root   45 2010-10-14 11:44 sy0005embapp01.img

-rw-r--r-- 1 root root 412K 2011-01-08 19:54 sy0005embinf02_vdd.img

-rwxrwxrwx 1 root root 609G 2011-05-18 23:41 sy0005embinf02_vdb.img

-rw-rw-rw- 1 root root  41G 2011-05-18 23:51 sy0005embinf02.img

-rw-rw-rw- 1 root root 2.0G 2011-05-18 23:52 sy0005embinf01.img

-rw-rw-rw- 1 root root 3.8G 2011-05-18 23:52 sy0005embldap01.img

 

Note: it was not working after the full permission too...

 

Was there any caching problem after the reboot...???

 

Thanks,

-Arun

 

 

-----Original Message-----
From: Stefan Hajnoczi [mailto:stefanha@gmail.com] 
Sent: Wednesday, May 18, 2011 10:29 PM
To: Arun Sasi V (WI01 - Manage IT)
Cc: stefanha@linux.vnet.ibm.com; qemu-devel@nongnu.org;
libvirt-users@redhat.com
Subject: Re: [Qemu-devel] Qcow2

 

On Wed, May 18, 2011 at 5:18 PM,  &lt;arun.sasi1@wipro.com&gt; wrote:

&gt; Hello Stefan,

&gt; 

&gt; 

&gt; 

&gt; Thank you very much for considering my issue...

&gt; 

&gt; 

&gt; 

&gt; Here is My problem...

&gt; 

&gt; 

&gt; 

&gt; 1) I have 4 VM`s Running on Base server.

&gt; 

&gt; 2) Base server is having 15GB RAM.

&gt; 

&gt; 3) I can start all VM`s apart from my file server.

&gt; 

&gt; 4) File server is having OS image and 1.2TB QCOW2 Image.

&gt; 

&gt; 5) When I remove 1.2TB from xml file (vdb.img) I can start my server
but

&gt; Data partition is null becase I have not added 1.2TB in XML.

&gt; 

&gt; 6) Command I am using virsh start &lt;Domain&gt;

&gt; 

&gt; 7) Even through virt-manager also I am not able to start the VM.
Attached is

&gt; the error message

 

Unfortunately the message gives no details:

"libvirtError: internal error unable to start guest:"

 

&gt; 8) Keep on trying adding and removing and defining the XML after 2 Hrs
I am

&gt; able to start.

 

What did you change that made it work?

 

&gt; 9) Operating system Ubuntu 9.04

&gt; 

&gt; 10) I have 3 location file server having the same issue... even all
file

&gt; servers are same configuration...

 

Libvirt keeps log files for each VM under

/var/log/libvirt/qemu/&lt;domain&gt;.log.  You might find more detailed

error information in that file and it will at least contain the

qemu-kvm command-line used to launch the domain.  Please take a look

at that file and post the lines surrounding the error, especially the

"starting up" log line.

 

Have you verified that the .qcow2 image file is accessible, ownership

and permissions should be the same as the image files of your other

domains.

 

Stefan

 

&gt; -----Original Message-----

&gt; From: Stefan Hajnoczi [mailto:stefanha@linux.vnet.ibm.com]

&gt; Sent: Wednesday, May 18, 2011 9:28 PM

&gt; To: Arun Sasi V (WI01 - Manage IT)

&gt; Subject: Re: Qcow2

&gt; 

&gt; 

&gt; 

&gt; On Wed, May 18, 2011 at 07:30:05PM +0530, arun.sasi1@wipro.com wrote:

&gt; 

&gt;&gt; The Guest VM which is larger example 1.2TB is not starting after the

&gt; 

&gt;&gt; base server reboot... Pleae help what needs to be do in this
situation.

&gt; 

&gt; 

&gt; 

&gt; You have not provided information on what is happening.  Are you
getting

&gt; 

&gt; an error message during boot from the 1.2TB guest?  Is the 1.2TB guest

&gt; 

&gt; even being autostarted (use "virsh autostart &lt;domain&gt;" to enable

&gt; 

&gt; autostart on a domain)?

&gt; 

&gt; 

&gt; 

&gt; Please send support questions like this to qemu-devel@nongnu.org in
the

&gt; 

&gt; future.  That way other people in the QEMU community can help too.

&gt; 

&gt; 

&gt; 

&gt; Stefan

&gt; 

&gt; Please do not print this email unless it is absolutely necessary.

&gt; 

&gt; The information contained in this electronic message and any
attachments to

&gt; this message are intended for the exclusive use of the addressee(s)
and may

&gt; contain proprietary, confidential or privileged information. If you
are not

&gt; the intended recipient, you should not disseminate, distribute or copy
this

&gt; e-mail. Please notify the sender immediately and destroy all copies of
this

&gt; message and any attachments.

&gt; 

&gt; WARNING: Computer viruses can be transmitted via email. The recipient
should

&gt; check this email and any attachments for the presence of viruses. The

&gt; company accepts no liability for any damage caused by any virus
transmitted

&gt; by this email.

&gt; 

&gt; www.wipro.com


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:x="urn:schemas-microsoft-com:office:excel" \
xmlns:p="urn:schemas-microsoft-com:office:powerpoint" \
xmlns:a="urn:schemas-microsoft-com:office:access" \
xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882" \
xmlns:s="uuid:BDC6E3F0-6DA3-11d1-A2A3-00AA00C14882" \
xmlns:rs="urn:schemas-microsoft-com:rowset" xmlns:z="#RowsetSchema" \
xmlns:b="urn:schemas-microsoft-com:office:publisher" \
xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" \
xmlns:c="urn:schemas-microsoft-com:office:component:spreadsheet" \
xmlns:odc="urn:schemas-microsoft-com:office:odc" \
xmlns:oa="urn:schemas-microsoft-com:office:activation" \
xmlns:html="http://www.w3.org/TR/REC-html40" \
xmlns:q="http://schemas.xmlsoap.org/soap/envelope/" \
xmlns:rtc="http://microsoft.com/officenet/conferencing" xmlns:D="DAV:" \
xmlns:Repl="http://schemas.microsoft.com/repl/" \
xmlns:mt="http://schemas.microsoft.com/sharepoint/soap/meetings/" \
xmlns:x2="http://schemas.microsoft.com/office/excel/2003/xml" \
xmlns:ppda="http://www.passport.com/NameSpace.xsd" \
xmlns:ois="http://schemas.microsoft.com/sharepoint/soap/ois/" \
xmlns:dir="http://schemas.microsoft.com/sharepoint/soap/directory/" \
xmlns:ds="http://www.w3.org/2000/09/xmldsig#" \
xmlns:dsp="http://schemas.microsoft.com/sharepoint/dsp" \
xmlns:udc="http://schemas.microsoft.com/data/udc" \
xmlns:xsd="http://www.w3.org/2001/XMLSchema" \
xmlns:sub="http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/" \
xmlns:ec="http://www.w3.org/2001/04/xmlenc#" \
xmlns:sp="http://schemas.microsoft.com/sharepoint/" \
xmlns:sps="http://schemas.microsoft.com/sharepoint/soap/" \
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" \
xmlns:udcs="http://schemas.microsoft.com/data/udc/soap" \
xmlns:udcxf="http://schemas.microsoft.com/data/udc/xmlfile" \
xmlns:udcp2p="http://schemas.microsoft.com/data/udc/parttopart" \
xmlns:wf="http://schemas.microsoft.com/sharepoint/soap/workflow/" \
xmlns:dsss="http://schemas.microsoft.com/office/2006/digsig-setup" \
xmlns:dssi="http://schemas.microsoft.com/office/2006/digsig" \
xmlns:mdssi="http://schemas.openxmlformats.org/package/2006/digital-signature" \
xmlns:mver="http://schemas.openxmlformats.org/markup-compatibility/2006" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns:mrels="http://schemas.openxmlformats.org/package/2006/relationships" \
xmlns:spwp="http://microsoft.com/sharepoint/webpartpages" \
xmlns:ex12t="http://schemas.microsoft.com/exchange/services/2006/types" \
xmlns:ex12m="http://schemas.microsoft.com/exchange/services/2006/messages" \
xmlns:pptsl="http://schemas.microsoft.com/sharepoint/soap/SlideLibrary/" \
xmlns:spsl="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService" \
xmlns:Z="urn:schemas-microsoft-com:" xmlns:st="" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 12 (filtered medium)"&gt;
&lt;style&gt;
&lt;!--
 /* Font Definitions */
 @font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{mso-style-priority:99;
	mso-style-link:"Plain Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:10.5pt;
	font-family:Consolas;}
span.PlainTextChar
	{mso-style-name:"Plain Text Char";
	mso-style-priority:99;
	mso-style-link:"Plain Text";
	font-family:Consolas;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.Section1
	{page:Section1;}
--&gt;
&lt;/style&gt;
&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapelayout v:ext="edit"&gt;
  &lt;o:idmap v:ext="edit" data="1" /&gt;
 &lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
&lt;/head&gt;

&lt;body lang=EN-US link=blue vlink=purple&gt;

&lt;div class=Section1&gt;

&lt;p class=MsoPlainText&gt;Stefan,&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;I was getting only the problem with audio(only Warning
and error log) when I checking the logs&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;{snip}&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;LC_ALL=C
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin HOME=/root
USER=root LOGNAME=root TMPDIR=/tmp/root-tmp.2af1b17/files /usr/bin/kvm -S -M pc
-m 512 -smp 4 -name sy0005embinf02 -uuid 9ddfc4b5-51bc-c3e9-3aea-59101bc15174
-monitor pty -pidfile /var/run/libvirt/qemu//sy0005embinf02.pid -boot c -drive
file=,if=ide,media=cdrom,index=2 -drive
file=/var/lib/libvirt/images/sy0005embinf02.img,if=virtio,index=0,boot=on
-drive file=/var/lib/libvirt/images/sy0005embinf02_vdb.img,if=virtio,index=1
-net nic,macaddr=00:16:36:1d:67:9e,vlan=0,model=virtio -net
tap,fd=23,script=,vlan=0,ifname=vnet2 -serial pty -parallel none -usb -vnc
127.0.0.1:2 -k en-us -soundhw es1370&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;cont&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;oss: Could not initialize DAC&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;oss: Failed to open `/dev/dsp'&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;oss: Reason: No such file or directory&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;oss: Could not initialize DAC&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;oss: Failed to open `/dev/dsp'&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;oss: Reason: No such file or directory&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;audio: Failed to create voice `es1370.dac2'&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;oss: Could not initialize ADC&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;oss: Failed to open `/dev/dsp'&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;oss: Reason: No such file or directory&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;oss: Could not initialize ADC&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;oss: Failed to open `/dev/dsp'&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;oss: Reason: No such file or directory&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;audio: Failed to create voice `es1370.adc'&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;{snip}&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;When it was not booting up I just given full \
permission&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;-rw-r--r-- 1 root root 384M 2010-10-06 08:01
sy0005embinf01.img.gz&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;-rw-rw-rw- 1 root root   45 2010-10-06 15:43
SLBTemplate.img&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;-rw-r--r-- 1 root root   45 2010-10-14 11:44
sy0005embapp01.img&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;-rw-r--r-- 1 root root 412K 2011-01-08 19:54
sy0005embinf02_vdd.img&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;b&gt;&lt;span \
style='background:yellow;mso-highlight:yellow'&gt;-rwxrwxrwx 1 root root 609G 2011-05-18 \
23:41 sy0005embinf02_vdb.img&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/b&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;-rw-rw-rw- 1 root root  41G 2011-05-18 23:51
sy0005embinf02.img&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;-rw-rw-rw- 1 root root 2.0G 2011-05-18 23:52
sy0005embinf01.img&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;-rw-rw-rw- 1 root root 3.8G 2011-05-18 23:52
sy0005embldap01.img&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;Note: it was not working after the full permission \
too...&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;Was there any caching problem after the \
reboot…???&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;Thanks,&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;-Arun&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;-----Original Message-----&lt;br&gt;
From: Stefan Hajnoczi [mailto:stefanha@gmail.com] &lt;br&gt;
Sent: Wednesday, May 18, 2011 10:29 PM&lt;br&gt;
To: Arun Sasi V (WI01 - Manage IT)&lt;br&gt;
Cc: stefanha@linux.vnet.ibm.com; qemu-devel@nongnu.org;
libvirt-users@redhat.com&lt;br&gt;
Subject: Re: [Qemu-devel] Qcow2&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;On Wed, May 18, 2011 at 5:18 PM, 
&lt;arun.sasi1@wipro.com&gt; wrote:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; Hello Stefan,&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; Thank you very much for considering my \
issue...&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; Here is My problem...&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; 1) I have 4 VM`s Running on Base server.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; 2) Base server is having 15GB RAM.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; 3) I can start all VM`s apart from my file \
server.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; 4) File server is having OS image and 1.2TB QCOW2
Image.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; 5) When I remove 1.2TB from xml file (vdb.img) I can
start my server but&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; Data partition is null becase I have not added 1.2TB
in XML.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; 6) Command I am using virsh start \
&lt;Domain&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; 7) Even through virt-manager also I am not able to
start the VM. Attached is&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; the error message&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;Unfortunately the message gives no details:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;"libvirtError: internal error unable to start
guest:"&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; 8) Keep on trying adding and removing and defining
the XML after 2 Hrs I am&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; able to start.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;What did you change that made it work?&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; 9) Operating system Ubuntu 9.04&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; 10) I have 3 location file server having the same
issue… even all file&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; servers are same configuration…&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;Libvirt keeps log files for each VM under&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;/var/log/libvirt/qemu/&lt;domain&gt;.log.  You might find
more detailed&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;error information in that file and it will at least
contain the&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;qemu-kvm command-line used to launch the domain.  Please
take a look&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;at that file and post the lines surrounding the error,
especially the&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;"starting up" log line.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;Have you verified that the .qcow2 image file is
accessible, ownership&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;and permissions should be the same as the image files of
your other&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;domains.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;Stefan&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; -----Original Message-----&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; From: Stefan Hajnoczi
[mailto:stefanha@linux.vnet.ibm.com]&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; Sent: Wednesday, May 18, 2011 9:28 PM&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; To: Arun Sasi V (WI01 - Manage IT)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; Subject: Re: Qcow2&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; On Wed, May 18, 2011 at 07:30:05PM +0530,
arun.sasi1@wipro.com wrote:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&gt; The Guest VM which is larger example 1.2TB is
not starting after the&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&gt; base server reboot... Pleae help what needs to
be do in this situation.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; You have not provided information on what is
happening.  Are you getting&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; an error message during boot from the 1.2TB
guest?  Is the 1.2TB guest&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; even being autostarted (use "virsh autostart
&lt;domain&gt;" to enable&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; autostart on a domain)?&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; Please send support questions like this to
qemu-devel@nongnu.org in the&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; future.  That way other people in the QEMU
community can help too.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; Stefan&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; Please do not print this email unless it is
absolutely necessary.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; The information contained in this electronic message
and any attachments to&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; this message are intended for the exclusive use of
the addressee(s) and may&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; contain proprietary, confidential or privileged
information. If you are not&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; the intended recipient, you should not disseminate,
distribute or copy this&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; e-mail. Please notify the sender immediately and
destroy all copies of this&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; message and any attachments.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; WARNING: Computer viruses can be transmitted via
email. The recipient should&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; check this email and any attachments for the
presence of viruses. The&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; company accepts no liability for any damage caused
by any virus transmitted&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; by this email.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&gt; www.wipro.com&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;



</body></email><email><emailId>20110519082237</emailId><senderName>Stefan Hajnoczi</senderName><senderEmail>stefanha@gmail.com</senderEmail><timestampReceived>2011-05-19 08:22:37-0400</timestampReceived><subject>Re: [libvirt-users] [Qemu-devel] Qcow2</subject><body>

On Wed, May 18, 2011 at 7:03 PM,  &lt;arun.sasi1@wipro.com&gt; wrote:
&gt; I was getting only the problem with audio(only Warning and error log) when I
&gt; checking the logs
&gt;
&gt; {snip}
&gt;
&gt; LC_ALL=C PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
&gt; HOME=/root USER=root LOGNAME=root TMPDIR=/tmp/root-tmp.2af1b17/files
&gt; /usr/bin/kvm -S -M pc -m 512 -smp 4 -name sy0005embinf02 -uuid
&gt; 9ddfc4b5-51bc-c3e9-3aea-59101bc15174 -monitor pty -pidfile
&gt; /var/run/libvirt/qemu//sy0005embinf02.pid -boot c -drive
&gt; file=,if=ide,media=cdrom,index=2 -drive
&gt; file=/var/lib/libvirt/images/sy0005embinf02.img,if=virtio,index=0,boot=on
&gt; -drive file=/var/lib/libvirt/images/sy0005embinf02_vdb.img,if=virtio,index=1
&gt; -net nic,macaddr=00:16:36:1d:67:9e,vlan=0,model=virtio -net
&gt; tap,fd=23,script=,vlan=0,ifname=vnet2 -serial pty -parallel none -usb -vnc
&gt; 127.0.0.1:2 -k en-us -soundhw es1370
&gt;
&gt;
&gt;
&gt; cont
&gt;
&gt; oss: Could not initialize DAC
&gt;
&gt; oss: Failed to open `/dev/dsp'
&gt;
&gt; oss: Reason: No such file or directory
&gt;
&gt; oss: Could not initialize DAC
&gt;
&gt; oss: Failed to open `/dev/dsp'
&gt;
&gt; oss: Reason: No such file or directory
&gt;
&gt; audio: Failed to create voice `es1370.dac2'
&gt;
&gt; oss: Could not initialize ADC
&gt;
&gt; oss: Failed to open `/dev/dsp'
&gt;
&gt; oss: Reason: No such file or directory
&gt;
&gt; oss: Could not initialize ADC
&gt;
&gt; oss: Failed to open `/dev/dsp'
&gt;
&gt; oss: Reason: No such file or directory
&gt;
&gt; audio: Failed to create voice `es1370.adc'

These audio messages look like warnings, not fatal errors, but I am
not sure.  I would view the VM details using virt-manager and remove
the sound card device from the VM if you don't need it.

&gt; {snip}

There were no further error messages indicating that starting the VM failed?

&gt;
&gt;
&gt;
&gt; When it was not booting up I just given full permission
&gt;
&gt; -rw-r--r-- 1 root root 384M 2010-10-06 08:01 sy0005embinf01.img.gz
&gt;
&gt; -rw-rw-rw- 1 root root   45 2010-10-06 15:43 SLBTemplate.img
&gt;
&gt; -rw-r--r-- 1 root root   45 2010-10-14 11:44 sy0005embapp01.img
&gt;
&gt; -rw-r--r-- 1 root root 412K 2011-01-08 19:54 sy0005embinf02_vdd.img
&gt;
&gt; -rwxrwxrwx 1 root root 609G 2011-05-18 23:41 sy0005embinf02_vdb.img
&gt;
&gt; -rw-rw-rw- 1 root root  41G 2011-05-18 23:51 sy0005embinf02.img
&gt;
&gt; -rw-rw-rw- 1 root root 2.0G 2011-05-18 23:52 sy0005embinf01.img
&gt;
&gt; -rw-rw-rw- 1 root root 3.8G 2011-05-18 23:52 sy0005embldap01.img
&gt;
&gt;
&gt;
&gt; Note: it was not working after the full permission too...
&gt;
&gt;
&gt;
&gt; Was there any caching problem after the reboot…???

You mentioned using QCOW2.  Use "qemu-img check
sy0005embinf02_vdb.img" to run a consistency check on the image file.
There should be no fatal errors.

Stefan

</body></email><email><emailId>20110519143611</emailId><senderName></senderName><senderEmail>arun.sasi1@wipro.com</senderEmail><timestampReceived>2011-05-19 14:36:11-0400</timestampReceived><subject>Re: [libvirt-users] [Qemu-devel] Qcow2</subject><body>

Hello Stefan,

I couldn't find any error when I do consistency check on the image file...

What can be the reason for not starting the VM.

Here I am suspecting when the base server go for reboot lesser image will start and \
it cached and larger image will take more time to create the cache...

Was this correct... if yes could you please help me how to increase the caching...


Thanks,
-Arun


-----Original Message-----
From: Stefan Hajnoczi [mailto:stefanha@gmail.com] 
Sent: Thursday, May 19, 2011 1:53 PM
To: Arun Sasi V (WI01 - Manage IT)
Cc: stefanha@linux.vnet.ibm.com; qemu-devel@nongnu.org; libvirt-users@redhat.com
Subject: Re: [Qemu-devel] Qcow2

On Wed, May 18, 2011 at 7:03 PM,  &lt;arun.sasi1@wipro.com&gt; wrote:
&gt; I was getting only the problem with audio(only Warning and error log) when I
&gt; checking the logs
&gt; 
&gt; {snip}
&gt; 
&gt; LC_ALL=C PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
&gt; HOME=/root USER=root LOGNAME=root TMPDIR=/tmp/root-tmp.2af1b17/files
&gt; /usr/bin/kvm -S -M pc -m 512 -smp 4 -name sy0005embinf02 -uuid
&gt; 9ddfc4b5-51bc-c3e9-3aea-59101bc15174 -monitor pty -pidfile
&gt; /var/run/libvirt/qemu//sy0005embinf02.pid -boot c -drive
&gt; file=,if=ide,media=cdrom,index=2 -drive
&gt; file=/var/lib/libvirt/images/sy0005embinf02.img,if=virtio,index=0,boot=on
&gt; -drive file=/var/lib/libvirt/images/sy0005embinf02_vdb.img,if=virtio,index=1
&gt; -net nic,macaddr=00:16:36:1d:67:9e,vlan=0,model=virtio -net
&gt; tap,fd=23,script=,vlan=0,ifname=vnet2 -serial pty -parallel none -usb -vnc
&gt; 127.0.0.1:2 -k en-us -soundhw es1370
&gt; 
&gt; 
&gt; 
&gt; cont
&gt; 
&gt; oss: Could not initialize DAC
&gt; 
&gt; oss: Failed to open `/dev/dsp'
&gt; 
&gt; oss: Reason: No such file or directory
&gt; 
&gt; oss: Could not initialize DAC
&gt; 
&gt; oss: Failed to open `/dev/dsp'
&gt; 
&gt; oss: Reason: No such file or directory
&gt; 
&gt; audio: Failed to create voice `es1370.dac2'
&gt; 
&gt; oss: Could not initialize ADC
&gt; 
&gt; oss: Failed to open `/dev/dsp'
&gt; 
&gt; oss: Reason: No such file or directory
&gt; 
&gt; oss: Could not initialize ADC
&gt; 
&gt; oss: Failed to open `/dev/dsp'
&gt; 
&gt; oss: Reason: No such file or directory
&gt; 
&gt; audio: Failed to create voice `es1370.adc'

These audio messages look like warnings, not fatal errors, but I am
not sure.  I would view the VM details using virt-manager and remove
the sound card device from the VM if you don't need it.

&gt; {snip}

There were no further error messages indicating that starting the VM failed?

&gt; 
&gt; 
&gt; 
&gt; When it was not booting up I just given full permission
&gt; 
&gt; -rw-r--r-- 1 root root 384M 2010-10-06 08:01 sy0005embinf01.img.gz
&gt; 
&gt; -rw-rw-rw- 1 root root   45 2010-10-06 15:43 SLBTemplate.img
&gt; 
&gt; -rw-r--r-- 1 root root   45 2010-10-14 11:44 sy0005embapp01.img
&gt; 
&gt; -rw-r--r-- 1 root root 412K 2011-01-08 19:54 sy0005embinf02_vdd.img
&gt; 
&gt; -rwxrwxrwx 1 root root 609G 2011-05-18 23:41 sy0005embinf02_vdb.img
&gt; 
&gt; -rw-rw-rw- 1 root root  41G 2011-05-18 23:51 sy0005embinf02.img
&gt; 
&gt; -rw-rw-rw- 1 root root 2.0G 2011-05-18 23:52 sy0005embinf01.img
&gt; 
&gt; -rw-rw-rw- 1 root root 3.8G 2011-05-18 23:52 sy0005embldap01.img
&gt; 
&gt; 
&gt; 
&gt; Note: it was not working after the full permission too...
&gt; 
&gt; 
&gt; 
&gt; Was there any caching problem after the reboot...???

You mentioned using QCOW2.  Use "qemu-img check
sy0005embinf02_vdb.img" to run a consistency check on the image file.
There should be no fatal errors.

Stefan


</body></email><email><emailId>20110519190513</emailId><senderName>Stefan Hajnoczi</senderName><senderEmail>stefanha@gmail.com</senderEmail><timestampReceived>2011-05-19 19:05:13-0400</timestampReceived><subject>Re: [libvirt-users] [Qemu-devel] Qcow2</subject><body>

On Thu, May 19, 2011 at 3:24 PM,  &lt;arun.sasi1@wipro.com&gt; wrote:
&gt; I couldn't find any error when I do consistency check on the image file...

Good, so there are no problems with your data.

&gt; What can be the reason for not starting the VM.

Did you find any more error messages besides the sound related errors
in /var/log/libvirt/qemu/&lt;domain&gt;.log?

&gt; Here I am suspecting when the base server go for reboot lesser image will start and \
&gt; it cached and larger image will take more time to create the cache... 
&gt; Was this correct... if yes could you please help me how to increase the caching...

No, there is no "cache creation".  There is no startup delay for qcow2
image files.

Stefan


</body></email><email><emailId>20110503011215</emailId><senderName></senderName><senderEmail>ssaleh</senderEmail><timestampReceived>2011-05-03 01:12:15-0400</timestampReceived><subject>[libvirt-users] LibVirtD Networking</subject><body>

I'm looking for the best way to setup networking support for VM's.   I have a small \
subnet with 6 routable IP's I can use on the Internet.  So, I'd like to setup a host \
and have VM's on the public IP's.  The computer I have has 4 NICs.   I'd like to use \
one for a private 10.x.x.x and the others for the public facing VM's. 

Can I support 5 VM's with the three raminging NIC's?  Should I use virtual IP's for \
the 5 VM's?  Should I use a single NIC for all 5 VM's (similar to what VMWare does)?

What is the best way to newtork this solution?

Thanks in advance.


</body></email><email><emailId>20110501083822</emailId><senderName>guan qin</senderName><senderEmail>qinguan0619@gmail.com</senderEmail><timestampReceived>2011-05-01 08:38:22-0400</timestampReceived><subject>[libvirt-users] can't up the eth in the vm and access to network</subject><body>

[Attachment #2 (multipart/alternative)]


Hi,

I encounter a problem that the eth can't be up in the VM by using VT-d.
I boot the VM using "virsh create vt_d.xml".
The VM could recongize the NIC which was assigned .then I do in VM as
follows:
#cat /sys/class/net/eth0/operstate
down
#ifconfig eth0 up
#cat /sys/class/net/eth0/operstate
down
#ficonfig eth 10.100.0.5
#cat /sys/class/net/eth0/operstate
down
more system information is attached.(uname ¡¢ifconfig ¡¢lspci¡¢cmdline...)

I can't figure out the reason why the eth is still down? can anyone help me
?

best regards,
qinguan



vt_d.xml:
&lt;domain type='kvm'&gt;
    &lt;name&gt;test&lt;/name&gt;
    &lt;description&gt;just test using sriov!&lt;/description&gt;
    &lt;os&gt;
        &lt;type&gt;hvm&lt;/type&gt;
        &lt;boot dev='hd'/&gt;
    &lt;/os&gt;
    &lt;memory&gt;524288&lt;/memory&gt;
    &lt;currentMemory&gt;524288&lt;/currentMemory&gt;
    &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
    &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
    &lt;on_crash&gt;restart&lt;/on_crash&gt;

    &lt;features&gt;&lt;pae/&gt;&lt;acpi/&gt;&lt;apic/&gt;&lt;/features&gt;
    &lt;clock offset='utc'/&gt;
    &lt;devices&gt;
        &lt;input type='mouse' bus='usb'/&gt;
        &lt;disk type='file' device='disk'&gt;
            &lt;source file='/home/qinguan/exp/ubuntu_1.img'/&gt;
            &lt;target dev='hda' bus='virtio'/&gt;
        &lt;/disk&gt;
        &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;
        &lt;graphics type='vnc' port='-1'/&gt;
        &lt;hostdev mode='subsystem' type='pci' managed='yes'&gt;
            &lt;source&gt;
                &lt;address bus='0x0' slot='0x19' function='0x0'/&gt;
            &lt;/source&gt;
        &lt;/hostdev&gt;
    &lt;/devices&gt;
&lt;/domain&gt;

[Attachment #5 (text/html)]

Hi,&lt;br&gt;&lt;br&gt;I encounter a problem that the eth can't be up in the VM by using \
VT-d.&lt;br&gt;I boot the VM using "virsh create vt_d.xml".&lt;br&gt;The VM could \
recongize the NIC which was assigned .then I do in VM as follows:&lt;br&gt; #cat \
/sys/class/net/eth0/operstate&lt;br&gt;down&lt;br&gt;#ifconfig eth0 up&lt;br&gt;#cat \
/sys/class/net/eth0/operstate&lt;br&gt;down&lt;br&gt;#ficonfig eth 10.100.0.5&lt;br&gt;#cat \
/sys/class/net/eth0/operstate&lt;br&gt;down&lt;br&gt;more system information is attached.(uname \
¡¢ifconfig ¡¢lspci¡¢cmdline...)&lt;br&gt; &lt;br&gt;I can't figure out the reason why the eth \
is still down? can anyone help me ?&lt;br&gt;&lt;br&gt;best \
regards,&lt;br&gt;qinguan&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;vt_d.xml:&lt;br&gt;&lt;domain \
type='kvm'&gt;&lt;br&gt;    \
&lt;name&gt;test&lt;/name&gt;&lt;br&gt;    &lt;description&gt;just test \
using sriov!&lt;/description&gt;&lt;br&gt;     \
&lt;os&gt;&lt;br&gt;        \
&lt;type&gt;hvm&lt;/type&gt;&lt;br&gt;        &lt;boot \
dev='hd'/&gt;&lt;br&gt;    &lt;/os&gt;&lt;br&gt;    \
&lt;memory&gt;524288&lt;/memory&gt;&lt;br&gt;    \
&lt;currentMemory&gt;524288&lt;/currentMemory&gt;&lt;br&gt;    \
&lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;&lt;br&gt;     \
&lt;on_reboot&gt;restart&lt;/on_reboot&gt;&lt;br&gt;    \
&lt;on_crash&gt;restart&lt;/on_crash&gt;&lt;br&gt;  &lt;br&gt;    \
&lt;features&gt;&lt;pae/&gt;&lt;acpi/&gt;&lt;apic/&gt;&lt;/features&gt;&lt;br&gt;    \
&lt;clock offset='utc'/&gt;&lt;br&gt;     \
&lt;devices&gt;&lt;br&gt;        &lt;input \
type='mouse' bus='usb'/&gt;      \
&lt;br&gt;        &lt;disk type='file' \
device='disk'&gt;&lt;br&gt;            \
&lt;source file='/home/qinguan/exp/ubuntu_1.img'/&gt;&lt;br&gt; \
            &lt;target \
dev='hda' bus='virtio'/&gt;&lt;br&gt;        \
&lt;/disk&gt;    &lt;br&gt;        \
&lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;&lt;br&gt;        \
&lt;graphics type='vnc' port='-1'/&gt;      \
&lt;br&gt;         &lt;hostdev mode='subsystem' \
type='pci' managed='yes'&gt;&lt;br&gt;            \
&lt;source&gt;&lt;br&gt;                \
&lt;address bus='0x0' slot='0x19' \
function='0x0'/&gt;&lt;br&gt;            \
&lt;/source&gt;&lt;br&gt;         \
&lt;/hostdev&gt;     &lt;br&gt;    \
&lt;/devices&gt;&lt;br&gt;&lt;/domain&gt;&lt;br&gt;&lt;br&gt;

--000e0cd34d9662ff6d04a232d4cb--


["system" (application/octet-stream)]
["Screenshot.png" (image/png)]

</body></email><email><emailId>20110503153218</emailId><senderName>Ricard Daniel Santafe Bence</senderName><senderEmail>rsantafe@uic.es</senderEmail><timestampReceived>2011-05-03 15:32:18-0400</timestampReceived><subject>[libvirt-users] virt-install becoming a headache</subject><body>

&lt;p&gt;hi libvirt team!!&lt;/p&gt;
&lt;p&gt;i'have been trying to install a OS Guest in my Host(Centos 5.5 server with kernel \
2.6.18-192 o 2.6.38) and i wasn't successfull. i have installed all the \
virtualization paquets of the Centos 5.5 installation, nothing more nothing less.&lt;/p&gt; \
&lt;p&gt;my server is without GUI. i want my servers without gui too. so i want text based \
installation&lt;/p&gt; &lt;p&gt;i enter the command bellow:&lt;/p&gt;
&lt;p&gt;[root@fsystem ~]# virt-install -n JPII -r 1024 --disk path=/data/images/disk.img \
-l /data/dist_img/CentOS_5.2_Final.iso --nographics --extra-args "console=tty0 \
console=ttyS0,115200" --network bridge:br0&lt;/p&gt; &lt;p&gt;so it enters installation mode \
(text based), but when i enter the menu of "Installation Method" i can't do nothing. \
the option of "Local Cdrom" it doesn't recognise any cdrom device, the option of \
"Hard DISK" it sees 3 partitionds hda,hdb&amp;hdc that i don't have and so it doesn't \
recognise nothing, the options http, ftp &amp; nfs-install more the same.&lt;/p&gt; &lt;p&gt;also \
if i change in the command -l for -c or --cdrom and then change the iso for the path \
of the cdrom device it doesn't even start the installation it prints Escape character \
^] and it stucks there instead of entering the installation&lt;/p&gt; &lt;p&gt;if you need more \
information of paquets, versions i'm using you are welcome to ask.&lt;/p&gt; &lt;p&gt;thanks for \
all &amp; you are my last hope!!!!&lt;/p&gt; &lt;p&gt;Atentamente&lt;/p&gt;
&lt;p&gt;Ricard Santafé&lt;/p&gt;
&lt;p&gt; &lt;/p&gt;


</body></email><email><emailId>20110505120730</emailId><senderName>guan qin</senderName><senderEmail>qinguan0619@gmail.com</senderEmail><timestampReceived>2011-05-05 12:07:30-0400</timestampReceived><subject>[libvirt-users] Error: unable to connect to '/var/run/libvirt/libvirt-sock'</subject><body>

Hi,
I meet with the problem that "Error: unable to connect to
'/var/run/libvirt/libvirt-sock' ".
I do as  Error: unable to connect to '/var/run/libvirt/libvirt-sock'
&lt;http://wiki.libvirt.org/page/FAQ#Error:_unable_to_connect_to_.27.2Fvar.2Frun.2Flibvirt.2Flibvirt-sock.27&gt;said
 but never worked:

root@shahe26:~# virsh
error: unable to connect to '/var/run/libvirt/libvirt-sock', libvirtd may
need to be started: No such file or directory
error: failed to connect to the hypervisor
root@shahe26:~# ls /usr/lib64 | grep libvirt
libvirt
libvirt.a
libvirt.la
libvirt-qemu.a
libvirt-qemu.la
libvirt-qemu.so
libvirt-qemu.so.0
libvirt-qemu.so.0.8.3
libvirt-qemu.so.0.9.0
libvirt.so
libvirt.so.0
libvirt.so.0.8.3
libvirt.so.0.9.0
root@shahe26:~# ls /usr/lib32 | grep libvirt
root@shahe26:~# /etc/init.d/libvirt-bin restart
Restarting libvirt management daemon: /usr/sbin/libvirtd.
root@shahe26:~# virsh
error: unable to connect to '/var/run/libvirt/libvirt-sock', libvirtd may
need to be started: No such file or directory
error: failed to connect to the hypervisor
root@shahe26:~#

I install the libvirt as follows:
#./configure --prefix=/usr --libdir=/usr/lib64
#make
#make install

my OS is debian6.0.1a:
root@shahe26:~# uname -a
Linux shahe26 2.6.32 #1 SMP Wed Apr 27 21:52:04 PDT 2011 x86_64 GNU/Linux
root@shahe26:~#

How to solve this problem?thanks.

best regards,
qinguan


[Attachment #3 (text/html)]

Hi,&lt;br&gt;I meet with the problem that "Error: unable to connect to \
'/var/run/libvirt/libvirt-sock' ".&lt;br&gt;I do as  &lt;a \
href="http://wiki.libvirt.org/page/FAQ#Error:_unable_to_connect_to_.27.2Fvar.2Frun.2Flibvirt.2Flibvirt-sock.27"&gt;Error: \
unable to connect to '/var/run/libvirt/libvirt-sock' &lt;/a&gt;said but never \
worked:&lt;br&gt; &lt;br&gt;root@shahe26:~# virsh&lt;br&gt;error: unable to connect to \
'/var/run/libvirt/libvirt-sock', libvirtd may need to be started: No such \
file or directory&lt;br&gt;error: failed to connect to the hypervisor&lt;br&gt;root@shahe26:~# ls \
/usr/lib64 | grep libvirt&lt;br&gt; libvirt&lt;br&gt;libvirt.a&lt;br&gt;&lt;a \
href="http://libvirt.la"&gt;libvirt.la&lt;/a&gt;&lt;br&gt;libvirt-qemu.a&lt;br&gt;&lt;a \
href="http://libvirt-qemu.la"&gt;libvirt-qemu.la&lt;/a&gt;&lt;br&gt;libvirt-qemu.so&lt;br&gt;libvirt-qemu.so.0&lt;br&gt;libvirt-qemu.so.0.8.3&lt;br&gt;libvirt-qemu.so.0.9.0&lt;br&gt;
 libvirt.so&lt;br&gt;libvirt.so.0&lt;br&gt;libvirt.so.0.8.3&lt;br&gt;libvirt.so.0.9.0&lt;br&gt;root@shahe26:~# \
ls /usr/lib32 | grep libvirt&lt;br&gt;root@shahe26:~# /etc/init.d/libvirt-bin \
restart&lt;br&gt;Restarting libvirt management daemon: /usr/sbin/libvirtd.&lt;br&gt; \
root@shahe26:~# virsh&lt;br&gt;error: unable to connect to \
'/var/run/libvirt/libvirt-sock', libvirtd may need to be started: No such \
file or directory&lt;br&gt;error: failed to connect to the hypervisor&lt;br&gt;root@shahe26:~# \
&lt;br&gt; &lt;br&gt;I install the libvirt as follows:&lt;br&gt;#./configure --prefix=/usr \
--libdir=/usr/lib64&lt;br&gt;#make&lt;br&gt;#make install&lt;br&gt;&lt;br&gt;my OS is \
debian6.0.1a:&lt;br&gt;root@shahe26:~# uname -a&lt;br&gt;Linux shahe26 2.6.32 #1 SMP Wed Apr 27 \
21:52:04 PDT 2011 x86_64 GNU/Linux&lt;br&gt; root@shahe26:~# &lt;br&gt;&lt;br&gt;How to solve this \
problem?thanks.&lt;br&gt;&lt;br&gt;best regards,&lt;br&gt;qinguan&lt;br&gt;



</body></email><email><emailId>20110505175610</emailId><senderName>Andrew Tappert</senderName><senderEmail>andrew@pikewerks.com</senderEmail><timestampReceived>2011-05-05 17:56:10-0400</timestampReceived><subject>[libvirt-users] converting save/dump output into physical memory image</subject><body>


A lot of people in the security community, myself included, are
interested in memory forensics these days.  Virtualization is a natural
fit with memory forensics because it allows one to get access to a
guest's memory without having to introduce any extra software into the
guest or otherwise interfere with it.  Incident responders are
particularly interested in getting memory dumps from systems they're
investigating.

Virsh has "save" and "dump" commands for storing the state of a guest to
a file on disk, but memory of KVM guests doesn't get saved in the
"standard" input format for memory forensics tools, which is a raw
physical memory image.  (This is what you'd get via the classical "dd
/dev/mem" approach or the contemporary equivalent using the crash
driver; and VMware Server and Workstation produce .vmem files, which are
such raw physical memory images, when a guest is paused or snapshotted.)

In order to analyze the memory of Libvirt/KVM guests with my Linux
memory forensics software, Second Look, I've created a tool for
converting Libvirt-QEMU-save files (output of virsh save command) or
QEMU-savevm files (output of virsh dump command) to raw physical memory
images.

I've got a basic working capability, though I'm still tracking down some
problems with a guest allocated 8GB RAM--not all the memory seems to be
present in the save or dump file.  And I haven't tested very extensively
yet, version support is limited to what I myself am currently running, et=
c.

I'd like to know if this is a capability that others are interested in.
 Is this something that would be of interest to the Libvirt project if I
were to contribute the code, or to the KVM project, or do you think it
best exists as a separate project?

I've also got a proof-of-concept tool for converting hibernate images to
raw physical memory images.  Perhaps a collection of tools for
converting various memory dump formats would be a good project.  Anyone
else interested in this kind of stuff?  As an author of commercial
memory forensics software I've got a vested interest in availability of
good memory acquisition capabilities.  But there are a number of people
working on FOSS Linux memory analysis tools, too...

Andrew


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20110506143937</emailId><senderName>Guilherme Santos</senderName><senderEmail>guisgb13@gmail.com</senderEmail><timestampReceived>2011-05-06 14:39:37-0400</timestampReceived><subject>[libvirt-users] Objective: run commands in the domain. Trouble: setting up a console</subject><body>

I've installed libvirt and also Virtual Box OSE hypervisor, in order to see
if I could properly manage it through virsh.
I could easily set up, start, pause, resume, shutdown and destroy the newly
created domains, from a XML file.

Then I was wondering how could I be able to spawn commands in the domain
through virsh, and the command 'console' gave me a the thought that I should
connect to the domain's console, so that, once connected, I would be able to
"do anything". Am I right?

I need to be able to run commands in the virtual machine. If the only way is
by accessing the domain's console, how can I properly set up one? I tried
several ways, following the examples in the documentation.

Problem is that no matter what I wrote in the xml file about serial or
console devices, it aways get overriden by null configuration when I start
the domain (I can see it by using command 'edit' &lt;domain&gt; ).

So then I tried to edit the XML through virsh and insert specifications
about console or serial devices, but I never was able to sucessfully edit
the file. I always got the same error message: "could not define a domain,
rc=80bb0004", although the domain is in fact defined! I tried editing the
XML both with the domain running and stopped.

My final alternative was using command 'attach-device' passing a xml
containing only the specifications of serial or console devices. I aways
received an error message saying that memory limit was exceeded, although I
strongly suppose that's not the real problem.

I am sure that I am configuring something (or many things) wrongly, so that
I am getting all those errors... My initial problem is just to be able to
run commands in the newly created domain. Anybody can tell me an easier way
to do this? If setting up consoles is the only way, what is going on wrongly
for me?

Sorry if an answer for this issue is already somewhere in the documentation,
I tried to find it hard before emailing you guys!

Thanks anyway!!

-- 
Guilherme Santos G. Baptista
Graduando em Ciência da Computação pela UFCG
LSD - Laboratório de Sistemas Distribuídos

[Attachment #3 (text/html)]

I've installed libvirt and also Virtual Box OSE hypervisor, in order to see if I \
could properly manage it through virsh.&lt;br&gt;I could easily set up, start, pause, \
resume, shutdown and destroy the newly created domains, from a XML file.&lt;br&gt; &lt;br&gt;Then \
I was wondering how could I be able to spawn commands in the domain through virsh, \
and the command 'console' gave me a the thought that I should connect to the \
domain's console, so that, once connected, I would be able to "do \
anything". Am I right?&lt;br&gt; &lt;br&gt;I need to be able to run commands in the virtual \
machine. If the only way is by accessing the domain's console, how can I properly \
set up one? I tried several ways, following the examples in the documentation.&lt;br&gt; \
&lt;br&gt;Problem is that no matter what I wrote in the xml file about serial or console \
devices, it aways get overriden by null configuration when I start the domain (I can \
see it by using command 'edit' &lt;domain&gt; ).&lt;br&gt; &lt;br&gt;So then I tried to \
edit the XML through virsh and insert specifications about console or serial devices, \
but I never was able to sucessfully edit the file. I always got the same error \
message: "could not define a domain, rc=80bb0004", although the domain is \
in fact defined! I tried editing the XML both with the domain running and \
stopped.&lt;br&gt; &lt;br&gt;My final alternative was using command 'attach-device' \
passing a xml containing only the specifications of serial or console devices. I \
aways received an error message saying that memory limit was exceeded, although I \
strongly suppose that's not the real problem.&lt;br&gt; &lt;br&gt;I am sure that I am \
configuring something (or many things) wrongly, so that I am getting all those \
errors... My initial problem is just to be able to run commands in the newly created \
domain. Anybody can tell me an easier way to do this? If setting up consoles is the \
only way, what is going on wrongly for me?&lt;br&gt; &lt;br&gt;Sorry if an answer for this issue \
is already somewhere in the documentation, I tried to find it hard before emailing \
you guys!&lt;br&gt;&lt;br&gt;Thanks anyway!!&lt;br&gt;&lt;br&gt;-- &lt;br&gt;Guilherme Santos G. \
Baptista&lt;br&gt;Graduando em Ciência da Computação pela UFCG&lt;br&gt; LSD - Laboratório de \
Sistemas Distribuídos&lt;br&gt;



</body></email><email><emailId>20110510045705</emailId><senderName>Mike Hall</senderName><senderEmail>mhall@astc.nt.gov.au</senderEmail><timestampReceived>2011-05-10 04:57:05-0400</timestampReceived><subject>[libvirt-users] Audio pass through</subject><body>

I'm running a RHEL6 as a development desktop with Fedora 14 (multimedia stuff) and \
Win XP (corporate email and calendars) running on it as KVM VMs. Everything runs \
great except for audio pass through.

Audio works on the RHEL host. Both VMs see sound cards provided by the VM, but no \
sound is forthcoming. I have tried adding a PCI audio device from the physical host \
to the Fedora VM, but then it refuses to boot. I remember reading that physical \
hardware can only be passed through to VMs if it is not in use on the physical host.

Any suggestions on how to get audio pass through happening?
How can I get the host to "relinquish" the audio device so that a VM can use it?

Thanks


Michael Hall
IT Communications Officer
Alice Springs Town Council
mhall@astc.nt.gov.au
(08) 8950 0561


</body></email><email><emailId>20110510105710</emailId><senderName></senderName><senderEmail>s.b</senderEmail><timestampReceived>2011-05-10 10:57:10-0400</timestampReceived><subject>[libvirt-users] Logfile with domain states</subject><body>

Hi,

 Is there any logfile where I can find information about startup, shutdown, etc of \
domains virtual machines (domains)?

 Thanks,
 Stef


[Attachment #3 (text/html)]

&lt;span style='font-family:Verdana'&gt;&lt;span style='font-size:12px'&gt;&lt;!--[if gte mso \
9]&gt;&lt;xml&gt;   &lt;o:OfficeDocumentSettings&gt; 
  &lt;o:AllowPNG/&gt; 
 &lt;/o:OfficeDocumentSettings&gt; 
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt; 
 &lt;w:WordDocument&gt; 
  &lt;w:View&gt;Normal&lt;/w:View&gt; 
  &lt;w:Zoom&gt;0&lt;/w:Zoom&gt; 
  &lt;w:TrackMoves/&gt; 
  &lt;w:TrackFormatting/&gt; 
  &lt;w:PunctuationKerning/&gt; 
  &lt;w:ValidateAgainstSchemas/&gt; 
  &lt;w:SaveIfXMLInvalid&gt;false&lt;/w:SaveIfXMLInvalid&gt; 
  &lt;w:IgnoreMixedContent&gt;false&lt;/w:IgnoreMixedContent&gt; 
  &lt;w:AlwaysShowPlaceholderText&gt;false&lt;/w:AlwaysShowPlaceholderText&gt; 
  &lt;w:DoNotPromoteQF/&gt; 
  &lt;w:LidThemeOther&gt;EN-US&lt;/w:LidThemeOther&gt; 
  &lt;w:LidThemeAsian&gt;X-NONE&lt;/w:LidThemeAsian&gt; 
  &lt;w:LidThemeComplexScript&gt;X-NONE&lt;/w:LidThemeComplexScript&gt; 
  &lt;w:Compatibility&gt; 
   &lt;w:BreakWrappedTables/&gt; 
   &lt;w:SnapToGridInCell/&gt; 
   &lt;w:WrapTextWithPunct/&gt; 
   &lt;w:UseAsianBreakRules/&gt; 
   &lt;w:DontGrowAutofit/&gt; 
   &lt;w:SplitPgBreakAndParaMark/&gt; 
   &lt;w:EnableOpenTypeKerning/&gt; 
   &lt;w:DontFlipMirrorIndents/&gt; 
   &lt;w:OverrideTableStyleHps/&gt; 
  &lt;/w:Compatibility&gt; 
  &lt;m:mathPr&gt; 
   &lt;m:mathFont m:val="Cambria Math"/&gt; 
   &lt;m:brkBin m:val="before"/&gt; 
   &lt;m:brkBinSub m:val="--"/&gt; 
   &lt;m:smallFrac m:val="off"/&gt; 
   &lt;m:dispDef/&gt; 
   &lt;m:lMargin m:val="0"/&gt; 
   &lt;m:rMargin m:val="0"/&gt; 
   &lt;m:defJc m:val="centerGroup"/&gt; 
   &lt;m:wrapIndent m:val="1440"/&gt; 
   &lt;m:intLim m:val="subSup"/&gt; 
   &lt;m:naryLim m:val="undOvr"/&gt; 
  &lt;/m:mathPr&gt;&lt;/w:WordDocument&gt; 
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt; 
 &lt;w:LatentStyles DefLockedState="false" DefUnhideWhenUsed="true" 
  DefSemiHidden="true" DefQFormat="false" DefPriority="99" 
  LatentStyleCount="267"&gt; 
  &lt;w:LsdException Locked="false" Priority="0" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="Normal"/&gt; 
  &lt;w:LsdException Locked="false" Priority="9" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="heading 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 7"/&gt; 
  &lt;w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 8"/&gt; 
  &lt;w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 9"/&gt; 
  &lt;w:LsdException Locked="false" Priority="39" Name="toc 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="39" Name="toc 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="39" Name="toc 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="39" Name="toc 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="39" Name="toc 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="39" Name="toc 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="39" Name="toc 7"/&gt; 
  &lt;w:LsdException Locked="false" Priority="39" Name="toc 8"/&gt; 
  &lt;w:LsdException Locked="false" Priority="39" Name="toc 9"/&gt; 
  &lt;w:LsdException Locked="false" Priority="35" QFormat="true" Name="caption"/&gt; 
  &lt;w:LsdException Locked="false" Priority="10" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="Title"/&gt; 
  &lt;w:LsdException Locked="false" Priority="1" Name="Default Paragraph Font"/&gt; 
  &lt;w:LsdException Locked="false" Priority="11" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="Subtitle"/&gt; 
  &lt;w:LsdException Locked="false" Priority="22" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="Strong"/&gt; 
  &lt;w:LsdException Locked="false" Priority="20" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="Emphasis"/&gt; 
  &lt;w:LsdException Locked="false" Priority="59" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Table Grid"/&gt; 
  &lt;w:LsdException Locked="false" UnhideWhenUsed="false" Name="Placeholder Text"/&gt; 
  &lt;w:LsdException Locked="false" Priority="1" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="No Spacing"/&gt; 
  &lt;w:LsdException Locked="false" Priority="60" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light Shading"/&gt; 
  &lt;w:LsdException Locked="false" Priority="61" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light List"/&gt; 
  &lt;w:LsdException Locked="false" Priority="62" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light Grid"/&gt; 
  &lt;w:LsdException Locked="false" Priority="63" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Shading 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="64" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Shading 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="65" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium List 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="66" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium List 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="67" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="68" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="69" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="70" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Dark List"/&gt; 
  &lt;w:LsdException Locked="false" Priority="71" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful Shading"/&gt; 
  &lt;w:LsdException Locked="false" Priority="72" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful List"/&gt; 
  &lt;w:LsdException Locked="false" Priority="73" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful Grid"/&gt; 
  &lt;w:LsdException Locked="false" Priority="60" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light Shading Accent 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="61" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light List Accent 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="62" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light Grid Accent 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="63" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="64" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="65" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium List 1 Accent 1"/&gt; 
  &lt;w:LsdException Locked="false" UnhideWhenUsed="false" Name="Revision"/&gt; 
  &lt;w:LsdException Locked="false" Priority="34" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="List Paragraph"/&gt; 
  &lt;w:LsdException Locked="false" Priority="29" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="Quote"/&gt; 
  &lt;w:LsdException Locked="false" Priority="30" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="Intense Quote"/&gt; 
  &lt;w:LsdException Locked="false" Priority="66" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium List 2 Accent 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="67" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="68" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="69" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="70" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Dark List Accent 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="71" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful Shading Accent 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="72" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful List Accent 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="73" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful Grid Accent 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="60" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light Shading Accent 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="61" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light List Accent 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="62" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light Grid Accent 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="63" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="64" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="65" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium List 1 Accent 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="66" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium List 2 Accent 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="67" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="68" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="69" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="70" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Dark List Accent 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="71" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful Shading Accent 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="72" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful List Accent 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="73" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful Grid Accent 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="60" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light Shading Accent 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="61" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light List Accent 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="62" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light Grid Accent 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="63" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="64" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="65" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium List 1 Accent 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="66" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium List 2 Accent 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="67" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="68" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="69" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="70" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Dark List Accent 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="71" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful Shading Accent 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="72" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful List Accent 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="73" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful Grid Accent 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="60" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light Shading Accent 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="61" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light List Accent 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="62" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light Grid Accent 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="63" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="64" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="65" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium List 1 Accent 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="66" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium List 2 Accent 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="67" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="68" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="69" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="70" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Dark List Accent 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="71" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful Shading Accent 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="72" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful List Accent 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="73" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful Grid Accent 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="60" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light Shading Accent 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="61" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light List Accent 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="62" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light Grid Accent 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="63" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="64" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="65" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium List 1 Accent 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="66" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium List 2 Accent 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="67" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="68" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="69" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="70" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Dark List Accent 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="71" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful Shading Accent 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="72" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful List Accent 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="73" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful Grid Accent 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="60" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light Shading Accent 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="61" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light List Accent 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="62" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light Grid Accent 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="63" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="64" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="65" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium List 1 Accent 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="66" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium List 2 Accent 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="67" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="68" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="69" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="70" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Dark List Accent 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="71" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful Shading Accent 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="72" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful List Accent 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="73" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful Grid Accent 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="19" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="Subtle Emphasis"/&gt; 
  &lt;w:LsdException Locked="false" Priority="21" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="Intense Emphasis"/&gt; 
  &lt;w:LsdException Locked="false" Priority="31" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="Subtle Reference"/&gt; 
  &lt;w:LsdException Locked="false" Priority="32" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="Intense Reference"/&gt; 
  &lt;w:LsdException Locked="false" Priority="33" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="Book Title"/&gt; 
  &lt;w:LsdException Locked="false" Priority="37" Name="Bibliography"/&gt; 
  &lt;w:LsdException Locked="false" Priority="39" QFormat="true" Name="TOC Heading"/&gt; 
 &lt;/w:LatentStyles&gt; 
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 10]&gt; 
&lt;style&gt; 
 /* Style Definitions */ 
 table.MsoNormalTable 
	{mso-style-name:"Table Normal"; 
	mso-tstyle-rowband-size:0; 
	mso-tstyle-colband-size:0; 
	mso-style-noshow:yes; 
	mso-style-priority:99; 
	mso-style-parent:""; 
	mso-padding-alt:0in 5.4pt 0in 5.4pt; 
	mso-para-margin:0in; 
	mso-para-margin-bottom:.0001pt; 
	mso-pagination:widow-orphan; 
	font-size:11.0pt; 
	font-family:"Calibri","sans-serif"; 
	mso-ascii-font-family:Calibri; 
	mso-ascii-theme-font:minor-latin; 
	mso-hansi-font-family:Calibri; 
	mso-hansi-theme-font:minor-latin; 
	mso-bidi-font-family:"Times New Roman"; 
	mso-bidi-theme-font:minor-bidi;} 
&lt;/style&gt; 
&lt;![endif]--&gt; 
&lt;p class="MsoNormal"&gt; 
	Hi,&lt;br /&gt; 
	&lt;br /&gt; 
	Is there any logfile where I can find information about startup, shutdown, etc of \
domains virtual machines (domains)?&lt;br /&gt;   &lt;br /&gt; 
	Thanks,&lt;br /&gt; 
	  Stef&lt;/p&gt; 
&lt;p style="margin:0px; padding:0px;" &gt; 
	 &lt;/p&gt; 
&lt;br /&gt; 
&lt;span id="editor_signature"&gt;&lt;span style="font-family:Verdana; \
font-size:12px"&gt; &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;



</body></email><email><emailId>20110510052339</emailId><senderName>Hisao Taguchi</senderName><senderEmail>hisao.taguchi@uniadex.co.jp</senderEmail><timestampReceived>2011-05-10 05:23:39-0400</timestampReceived><subject>Re: [libvirt-users] Audio pass through</subject><body>

Hi, Michael

How about trying to set

...
user='foobar'
group='foobar'
...
vnc_allow_host_audio = 1
...

in the "/etc/libvirt/qemu.conf" file.

I'm using fedora14 as a KVM host and
running Windows XP guest and
this solved the sound problem.

Please refer to the folloing for details.

http://fedoraproject.org/wiki/How_to_debug_Virtualization_problems

--
Hisao


On 05/10/2011 01:45 PM, Mike Hall wrote:
&gt; I'm running a RHEL6 as a development desktop with Fedora 14 (multimedia stuff) and \
&gt; Win XP (corporate email and calendars) running on it as KVM VMs. Everything runs \
&gt; great except for audio pass through. 
&gt; Audio works on the RHEL host. Both VMs see sound cards provided by the VM, but no \
&gt; sound is forthcoming. I have tried adding a PCI audio device from the physical host \
&gt; to the Fedora VM, but then it refuses to boot. I remember reading that physical \
&gt; hardware can only be passed through to VMs if it is not in use on the physical \
&gt; host. 
&gt; Any suggestions on how to get audio pass through happening?
&gt; How can I get the host to "relinquish" the audio device so that a VM can use it?
&gt; 
&gt; Thanks
&gt; 
&gt; 
&gt; Michael Hall
&gt; IT Communications Officer
&gt; Alice Springs Town Council
&gt; mhall@astc.nt.gov.au
&gt; (08) 8950 0561
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; 


-- 
������ ������
���������������������� ���������� Linux/UNIX���������������
Tel:050-3132-7676 (������ 840-27676)
E-Mail:hisao.taguchi@uniadex.co.jp


</body></email><email><emailId>20110505183354</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-05-05 18:33:54-0400</timestampReceived><subject>Re: [libvirt-users] converting save/dump output into physical memory image</subject><body>


On 05/05/2011 11:56 AM, Andrew Tappert wrote:
&gt; 
&gt; A lot of people in the security community, myself included, are
&gt; interested in memory forensics these days.  Virtualization is a natural
&gt; fit with memory forensics because it allows one to get access to a
&gt; guest's memory without having to introduce any extra software into the
&gt; guest or otherwise interfere with it.  Incident responders are
&gt; particularly interested in getting memory dumps from systems they're
&gt; investigating.
&gt; 
&gt; Virsh has "save" and "dump" commands for storing the state of a guest to
&gt; a file on disk, but memory of KVM guests doesn't get saved in the
&gt; "standard" input format for memory forensics tools, which is a raw
&gt; physical memory image.  (This is what you'd get via the classical "dd
&gt; /dev/mem" approach or the contemporary equivalent using the crash
&gt; driver; and VMware Server and Workstation produce .vmem files, which are
&gt; such raw physical memory images, when a guest is paused or snapshotted.)

Libvirt also has the virDomainMemoryPeek API; right now, it is not
exposed by virsh, but we could add a command-line-interface for it if
that proves useful.  Does that API fit your needs any better than
converting a qemu dump image back into raw memory?

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20110505184939</emailId><senderName>Andrew Tappert</senderName><senderEmail>andrew@pikewerks.com</senderEmail><timestampReceived>2011-05-05 18:49:39-0400</timestampReceived><subject>Re: [libvirt-users] converting save/dump output into physical memory image</subject><body>


On 05/05/2011 02:33 PM, Eric Blake wrote:
&gt; On 05/05/2011 11:56 AM, Andrew Tappert wrote:
&gt;&gt;
&gt;&gt; Virsh has "save" and "dump" commands for storing the state of a guest to
&gt;&gt; a file on disk, but memory of KVM guests doesn't get saved in the
&gt;&gt; "standard" input format for memory forensics tools, which is a raw
&gt;&gt; physical memory image.  (This is what you'd get via the classical "dd
&gt;&gt; /dev/mem" approach or the contemporary equivalent using the crash
&gt;&gt; driver; and VMware Server and Workstation produce .vmem files, which are
&gt;&gt; such raw physical memory images, when a guest is paused or snapshotted.)
&gt; 
&gt; Libvirt also has the virDomainMemoryPeek API; right now, it is not
&gt; exposed by virsh, but we could add a command-line-interface for it if
&gt; that proves useful.  Does that API fit your needs any better than
&gt; converting a qemu dump image back into raw memory?
&gt; 

Before starting to write the LibvirtQemuSave/QemuSavevm conversion tool
I did explore the possibility of writing a Libvirt memory dump program
using that API.  But given the way it writes to a temporary file it did
not seem like it would be feasible/efficient for full memory dumps.  I
just signed up to your mailing list today, but I saw in your last post a
mention of qemu raw monitor passthrough commands.  Maybe directly
invoking qemu's pmemsave is the way to go.  The nice thing about the
qemu savevm format, though, is that it does contain cpu state, which is
actually quite relevant to "memory" forensics... it's not all about
getting a raw physical memory image, actually.

Andrew


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20110505121451</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-05-05 12:14:51-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt] Error: unable to connect to '/var/run/libvirt/libvirt-sock'</subject><body>

On Thu, May 05, 2011 at 08:07:30PM +0800, guan qin wrote:
&gt; Hi,
&gt; I meet with the problem that "Error: unable to connect to
&gt; '/var/run/libvirt/libvirt-sock' ".
&gt; I do as  Error: unable to connect to '/var/run/libvirt/libvirt-sock'
&gt; &lt;http://wiki.libvirt.org/page/FAQ#Error:_unable_to_connect_to_.27.2Fvar.2Frun.2Flibvirt.2Flibvirt-sock.27&gt;said
&gt;  but never worked:
&gt; 
&gt; root@shahe26:~# virsh
&gt; error: unable to connect to '/var/run/libvirt/libvirt-sock', libvirtd may
&gt; need to be started: No such file or directory
&gt; error: failed to connect to the hypervisor
&gt; root@shahe26:~# ls /usr/lib64 | grep libvirt
&gt; libvirt
&gt; libvirt.a
&gt; libvirt.la
&gt; libvirt-qemu.a
&gt; libvirt-qemu.la
&gt; libvirt-qemu.so
&gt; libvirt-qemu.so.0
&gt; libvirt-qemu.so.0.8.3
&gt; libvirt-qemu.so.0.9.0
&gt; libvirt.so
&gt; libvirt.so.0
&gt; libvirt.so.0.8.3
&gt; libvirt.so.0.9.0
&gt; root@shahe26:~# ls /usr/lib32 | grep libvirt
&gt; root@shahe26:~# /etc/init.d/libvirt-bin restart
&gt; Restarting libvirt management daemon: /usr/sbin/libvirtd.
&gt; root@shahe26:~# virsh
&gt; error: unable to connect to '/var/run/libvirt/libvirt-sock', libvirtd may
&gt; need to be started: No such file or directory
&gt; error: failed to connect to the hypervisor
&gt; root@shahe26:~#
&gt; 
&gt; I install the libvirt as follows:
&gt; #./configure --prefix=/usr --libdir=/usr/lib64

You're missing   --localstatedir=/var --sysconfdir=/etc

&gt; #make
&gt; #make install
&gt; 


Regards,
Daniel
-- 
&gt; &gt; http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
&gt; &gt; http://libvirt.org              -o-             http://virt-manager.org :|
&gt; &gt; http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
&gt; &gt; http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|


</body></email><email><emailId>20110511190109</emailId><senderName>Tarciso Oliveira</senderName><senderEmail>tarcisocomp@gmail.com</senderEmail><timestampReceived>2011-05-11 19:01:09-0400</timestampReceived><subject>[libvirt-users] Problems connecting to Virtualbox hypervisor using libvirt java binding</subject><body>

I am trying to connect to the virtualbox hypervisor through libvirt java
binding.

I am on Ubuntu 10.04 and I have installed libvirt-0.85, libvirt-java-0.4.6
and virtualbox-ose-dkms. I have configured libvirt project and its java
binding at Eclipse and the default test of the binding runs properly. When I
try to run a simple test in java with the connection:

conn = new Connect("vbox:///session", false)

I get the following exception: "exception caught:org.libvirt.

LibvirtException: Failed to start the nwfilter driver: Is the daemon running
?"

If I try to do the same thing, but instead of using the java biding I  use
virsh, it works. I am able to connect and start the virtual machine
successfully, although none of the nwfilter commands work in virsh.

(The nwfilter-list command shows this error:  Failed to list network
filters. This function is not supported by the connection driver:
virConnectNumOfNWFilters)

If I run the same java test using the Test hypervisor connection, things
work properly.

I don't know if I have to install or configure something else in order to
get the nwfilter working or if virtualbox doesn't provide support for it,
and if it doesn't provide, how can I get rid of this exception and use
virtualbox virtual machine connection through java binding ?

My objective is being able to use libvirt library commands in a software (in
java) which uses virtualization to run jobs in different machines, but
without the connection to the hypervisor I can't do anything.

I apologize if this question has been already answered. I have tried hard to
get the answers for it looking at forums and also in the discussions of this
list, but I couldn't.

What am I missing?

Thanks!

-- 
Tarciso Braz de Oliveira Filho
Graduando em Ciência da Computação
LSD - Laboratório de Sistemas Distribuídos
UFCG
2011

[Attachment #3 (text/html)]

&lt;div class="im"&gt;I am trying to connect to the virtualbox hypervisor through libvirt \
java binding.&lt;br&gt;&lt;br&gt;I  am on Ubuntu 10.04 and I have installed libvirt-0.85, 
libvirt-java-0.4.6 and virtualbox-ose-dkms. I have configured libvirt 
project and its java binding at Eclipse and the default test of the 
binding runs properly. When I try to run a simple test in java with the 
connection:&lt;br&gt;

&lt;br&gt;conn = new Connect("vbox:///session", false)&lt;br&gt;&lt;br&gt;&lt;/div&gt;I get the \
following exception: "exception caught:org.libvirt.&lt;br&gt;&lt;br&gt;LibvirtException: \
Failed to start the nwfilter driver: Is the daemon running ?"&lt;br&gt; &lt;br&gt;If I try \
to do the same thing, but instead of using the java biding  I  use virsh, it works. I \
am able to connect and start the virtual  machine successfully, although none of the \
nwfilter commands work in  virsh.&lt;br&gt;&lt;br&gt;(The nwfilter-list command shows this error: \
Failed to list network  filters. This function is not supported by the connection \
driver:  virConnectNumOfNWFilters)&lt;br&gt;&lt;br&gt;If I run the same java test using the Test \
hypervisor connection, things work properly.&lt;br&gt;&lt;br&gt;I don't know if I have to \
install or configure something else in  order to get the nwfilter working or if \
virtualbox doesn't provide  support for it, and if it doesn't provide, how \
can I get rid of this  exception and use virtualbox virtual machine connection \
through java  binding ?&lt;br&gt;&lt;br&gt;My objective is being able to use libvirt library \
commands in a  software (in java) which uses virtualization to run jobs in different 
machines, but without the connection to the hypervisor I can't do 
anything.&lt;br&gt;&lt;br&gt;I apologize if this question has been already 
answered. I have tried hard to get the answers for it looking at forums 
and also in the discussions of this list, but I couldn't. &lt;br&gt;&lt;br&gt;What am I \
missing?&lt;br&gt;&lt;br&gt;Thanks!&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;Tarciso Braz de Oliveira \
Filho&lt;br&gt;Graduando em Ciência da Computação&lt;br&gt;LSD - Laboratório de Sistemas \
Distribuídos&lt;br&gt; UFCG&lt;br&gt;2011&lt;br&gt;&lt;br&gt;



</body></email><email><emailId>20110502121643</emailId><senderName>Marco van Beek</senderName><senderEmail>mvanbeek@forgetaboutit.net</senderEmail><timestampReceived>2011-05-02 12:16:43-0400</timestampReceived><subject>Re: [libvirt-users] can't up the eth in the vm and access to network</subject><body>

Hi,

If you find that the whole VM does not come up, then it may either be
permissions due to apparmor, (if you are running it), or as I found out,
unless your motherboard supports IOMMU, then PCI passthough (which is
what you appear to be trying to do) will apparently never work.

What you would normally see in the xml file is something like this:

&lt;interface type='network'&gt;
&lt;mac address='54:52:00:18:88:29'/&gt;
&lt;source network='default'/&gt;
&lt;/interface&gt;

or

&lt;interface type='bridge'&gt;
&lt;mac address='00:16:3e:19:b4:38'/&gt;
&lt;source bridge='br0'/&gt;
&lt;/interface&gt;

Hope this helps.

Regards,

Marco

On 01/05/11 09:38, guan qin wrote:
&gt; Hi,
&gt;
&gt; I encounter a problem that the eth can't be up in the VM by using VT-d.
&gt; I boot the VM using "virsh create vt_d.xml".
&gt; The VM could recongize the NIC which was assigned .then I do in VM as
&gt; follows:
&gt; #cat /sys/class/net/eth0/operstate
&gt; down
&gt; #ifconfig eth0 up
&gt; #cat /sys/class/net/eth0/operstate
&gt; down
&gt; #ficonfig eth 10.100.0.5
&gt; #cat /sys/class/net/eth0/operstate
&gt; down
&gt; more system information is attached.(uname ¡¢ifconfig ¡¢lspci¡¢cmdline...)
&gt;
&gt; I can't figure out the reason why the eth is still down? can anyone
&gt; help me ?
&gt;
&gt; best regards,
&gt; qinguan
&gt;
&gt;
&gt;
&gt; vt_d.xml:
&gt; &lt;domain type='kvm'&gt;
&gt; &lt;name&gt;test&lt;/name&gt;
&gt; &lt;description&gt;just test using sriov!&lt;/description&gt;
&gt; &lt;os&gt;
&gt; &lt;type&gt;hvm&lt;/type&gt;
&gt; &lt;boot dev='hd'/&gt;
&gt; &lt;/os&gt;
&gt; &lt;memory&gt;524288&lt;/memory&gt;
&gt; &lt;currentMemory&gt;524288&lt;/currentMemory&gt;
&gt; &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
&gt; &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
&gt; &lt;on_crash&gt;restart&lt;/on_crash&gt;
&gt;
&gt; &lt;features&gt;&lt;pae/&gt;&lt;acpi/&gt;&lt;apic/&gt;&lt;/features&gt;
&gt; &lt;clock offset='utc'/&gt;
&gt; &lt;devices&gt;
&gt; &lt;input type='mouse' bus='usb'/&gt;
&gt; &lt;disk type='file' device='disk'&gt;
&gt; &lt;source file='/home/qinguan/exp/ubuntu_1.img'/&gt;
&gt; &lt;target dev='hda' bus='virtio'/&gt;
&gt; &lt;/disk&gt;
&gt; &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;
&gt; &lt;graphics type='vnc' port='-1'/&gt;
&gt; &lt;hostdev mode='subsystem' type='pci' managed='yes'&gt;
&gt; &lt;source&gt;
&gt; &lt;address bus='0x0' slot='0x19' function='0x0'/&gt;
&gt; &lt;/source&gt;
&gt; &lt;/hostdev&gt;
&gt; &lt;/devices&gt;
&gt; &lt;/domain&gt;
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

-- 
Marco van Beek
===================================================
Forget About IT Ltd.
Grove Park Studios,
188-192 Sutton Court Rd,
London, W4 3HR
===================================================
T: 0870 757 2924
F: 0870 757 2926
M: 0788 770 3604
E: mvanbeek@forgetaboutit.net
W: http://www.forgetaboutit.net/
===================================================
Forget About IT and FABIT are registered trademarks
===================================================
Company Registered in England No. 05375739
===================================================



[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta content="text/html; charset=GB2312" http-equiv="Content-Type"&gt;
  &lt;/head&gt;
  &lt;body bgcolor="#ffffff" text="#000000"&gt;
    Hi,&lt;br&gt;
    &lt;br&gt;
    If you find that the whole VM does not come up, then it may either
    be permissions due to apparmor, (if you are running it), or as I
    found out, unless your motherboard supports IOMMU, then PCI
    passthough (which is what you appear to be trying to do) will
    apparently never work.&lt;br&gt;
    &lt;br&gt;
    What you would normally see in the xml file is something like this:&lt;br&gt;
    &lt;br&gt;
        &lt;interface type='network'&gt;&lt;br&gt;
          &lt;mac address='54:52:00:18:88:29'/&gt;&lt;br&gt;
          &lt;source network='default'/&gt;&lt;br&gt;
        &lt;/interface&gt;&lt;br&gt;
    &lt;br&gt;
    or &lt;br&gt;
    &lt;br&gt;
        &lt;interface type='bridge'&gt;&lt;br&gt;
          &lt;mac address='00:16:3e:19:b4:38'/&gt;&lt;br&gt;
          &lt;source bridge='br0'/&gt;&lt;br&gt;
        &lt;/interface&gt;&lt;br&gt;
    &lt;br&gt;
    Hope this helps.&lt;br&gt;
    &lt;br&gt;
    Regards,&lt;br&gt;
    &lt;br&gt;
    Marco&lt;br&gt;
    &lt;br&gt;
    On 01/05/11 09:38, guan qin wrote:
    &lt;blockquote
      cite="mid:BANLkTi=2_EHWtVc-+WL1Mp9v=ErYtRNotA@mail.gmail.com"
      type="cite"&gt;Hi,&lt;br&gt;
      &lt;br&gt;
      I encounter a problem that the eth can't be up in the VM by using
      VT-d.&lt;br&gt;
      I boot the VM using "virsh create vt_d.xml".&lt;br&gt;
      The VM could recongize the NIC which was assigned .then I do in VM
      as follows:&lt;br&gt;
      #cat /sys/class/net/eth0/operstate&lt;br&gt;
      down&lt;br&gt;
      #ifconfig eth0 up&lt;br&gt;
      #cat /sys/class/net/eth0/operstate&lt;br&gt;
      down&lt;br&gt;
      #ficonfig eth 10.100.0.5&lt;br&gt;
      #cat /sys/class/net/eth0/operstate&lt;br&gt;
      down&lt;br&gt;
      more system information is attached.(uname ¡¢ifconfig
      ¡¢lspci¡¢cmdline...)&lt;br&gt;
      &lt;br&gt;
      I can't figure out the reason why the eth is still down? can
      anyone help me ?&lt;br&gt;
      &lt;br&gt;
      best regards,&lt;br&gt;
      qinguan&lt;br&gt;
      &lt;br&gt;
      &lt;br&gt;
      &lt;br&gt;
      vt_d.xml:&lt;br&gt;
      &lt;domain type='kvm'&gt;&lt;br&gt;
          &lt;name&gt;test&lt;/name&gt;&lt;br&gt;
          &lt;description&gt;just test using \
sriov!&lt;/description&gt;&lt;br&gt;      &lt;os&gt;&lt;br&gt;
              &lt;type&gt;hvm&lt;/type&gt;&lt;br&gt;
              &lt;boot dev='hd'/&gt;&lt;br&gt;
          &lt;/os&gt;&lt;br&gt;
          &lt;memory&gt;524288&lt;/memory&gt;&lt;br&gt;
          &lt;currentMemory&gt;524288&lt;/currentMemory&gt;&lt;br&gt;
          &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;&lt;br&gt;
          &lt;on_reboot&gt;restart&lt;/on_reboot&gt;&lt;br&gt;
          &lt;on_crash&gt;restart&lt;/on_crash&gt;&lt;br&gt;
        &lt;br&gt;
         
      &lt;features&gt;&lt;pae/&gt;&lt;acpi/&gt;&lt;apic/&gt;&lt;/features&gt;&lt;br&gt;
          &lt;clock offset='utc'/&gt;&lt;br&gt;
          &lt;devices&gt;&lt;br&gt;
              &lt;input type='mouse' \
                bus='usb'/&gt;      &lt;br&gt;
              &lt;disk type='file' \
                device='disk'&gt;&lt;br&gt;
                  &lt;source \
                file='/home/qinguan/exp/ubuntu_1.img'/&gt;&lt;br&gt;
                  &lt;target \
                dev='hda' bus='virtio'/&gt;&lt;br&gt;
              &lt;/disk&gt;    &lt;br&gt;
              \
                &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;&lt;br&gt;
              &lt;graphics type='vnc' \
                port='-1'/&gt;      &lt;br&gt;
              &lt;hostdev mode='subsystem' \
                type='pci' managed='yes'&gt;&lt;br&gt;
                  \
                &lt;source&gt;&lt;br&gt;
                      \
&lt;address bus='0x0' slot='0x19'  function='0x0'/&gt;&lt;br&gt;
                  \
                &lt;/source&gt;&lt;br&gt;
              \
&lt;/hostdev&gt;     &lt;br&gt;      \
&lt;/devices&gt;&lt;br&gt;  &lt;/domain&gt;&lt;br&gt;
      &lt;br&gt;
      &lt;pre wrap=""&gt;
&lt;fieldset class="mimeAttachmentHeader"&gt;&lt;/fieldset&gt;
_______________________________________________
libvirt-users mailing list
&lt;a class="moz-txt-link-abbreviated" \
href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt; &lt;a \
class="moz-txt-link-freetext" \
href="https://www.redhat.com/mailman/listinfo/libvirt-users"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;/pre&gt;
  &lt;/blockquote&gt;
    &lt;br&gt;
    &lt;pre class="moz-signature" cols="72"&gt;-- 
Marco van Beek
===================================================
Forget About IT Ltd.
Grove Park Studios,
188-192 Sutton Court Rd,
London, W4 3HR
===================================================
T: 0870 757 2924
F: 0870 757 2926
M: 0788 770 3604
E: &lt;a class="moz-txt-link-abbreviated" \
                href="mailto:mvanbeek@forgetaboutit.net"&gt;mvanbeek@forgetaboutit.net&lt;/a&gt;
                
W: &lt;a class="moz-txt-link-freetext" \
href="http://www.forgetaboutit.net/"&gt;http://www.forgetaboutit.net/&lt;/a&gt; \
=================================================== Forget About IT and FABIT are \
registered trademarks ===================================================
Company Registered in England No. 05375739
===================================================

&lt;/pre&gt;
  &lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20110503004757</emailId><senderName>David White</senderName><senderEmail>dwhite@speakeasy.net</senderEmail><timestampReceived>2011-05-03 00:47:57-0400</timestampReceived><subject>Re: [libvirt-users] can't up the eth in the vm and access to network</subject><body>

did you 'unbind' the device from the host OS driver?

On 05/01/2011 01:38 AM, guan qin wrote:
&gt; Hi,
&gt;
&gt; I encounter a problem that the eth can't be up in the VM by using VT-d.
&gt; I boot the VM using "virsh create vt_d.xml".
&gt; The VM could recongize the NIC which was assigned .then I do in VM as
&gt; follows:
&gt; #cat /sys/class/net/eth0/operstate
&gt; down
&gt; #ifconfig eth0 up
&gt; #cat /sys/class/net/eth0/operstate
&gt; down
&gt; #ficonfig eth 10.100.0.5
&gt; #cat /sys/class/net/eth0/operstate
&gt; down
&gt; more system information is attached.(uname ¡¢ifconfig ¡¢lspci¡¢cmdline...)
&gt;
&gt; I can't figure out the reason why the eth is still down? can anyone
&gt; help me ?
&gt;
&gt; best regards,
&gt; qinguan
&gt;
&gt;
&gt;
&gt; vt_d.xml:
&gt; &lt;domain type='kvm'&gt;
&gt; &lt;name&gt;test&lt;/name&gt;
&gt; &lt;description&gt;just test using sriov!&lt;/description&gt;
&gt; &lt;os&gt;
&gt; &lt;type&gt;hvm&lt;/type&gt;
&gt; &lt;boot dev='hd'/&gt;
&gt; &lt;/os&gt;
&gt; &lt;memory&gt;524288&lt;/memory&gt;
&gt; &lt;currentMemory&gt;524288&lt;/currentMemory&gt;
&gt; &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
&gt; &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
&gt; &lt;on_crash&gt;restart&lt;/on_crash&gt;
&gt;
&gt; &lt;features&gt;&lt;pae/&gt;&lt;acpi/&gt;&lt;apic/&gt;&lt;/features&gt;
&gt; &lt;clock offset='utc'/&gt;
&gt; &lt;devices&gt;
&gt; &lt;input type='mouse' bus='usb'/&gt;
&gt; &lt;disk type='file' device='disk'&gt;
&gt; &lt;source file='/home/qinguan/exp/ubuntu_1.img'/&gt;
&gt; &lt;target dev='hda' bus='virtio'/&gt;
&gt; &lt;/disk&gt;
&gt; &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;
&gt; &lt;graphics type='vnc' port='-1'/&gt;
&gt; &lt;hostdev mode='subsystem' type='pci' managed='yes'&gt;
&gt; &lt;source&gt;
&gt; &lt;address bus='0x0' slot='0x19' function='0x0'/&gt;
&gt; &lt;/source&gt;
&gt; &lt;/hostdev&gt;
&gt; &lt;/devices&gt;
&gt; &lt;/domain&gt;
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users


[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta content="text/html; charset=GB2312" http-equiv="Content-Type"&gt;
    &lt;title&gt;&lt;/title&gt;
  &lt;/head&gt;
  &lt;body bgcolor="#ffffff" text="#000000"&gt;
    &lt;br&gt;
    did you 'unbind' the device from the host OS driver?&lt;br&gt;
    &lt;br&gt;
    On 05/01/2011 01:38 AM, guan qin wrote:
    &lt;blockquote
      cite="mid:BANLkTi=2_EHWtVc-+WL1Mp9v=ErYtRNotA@mail.gmail.com"
      type="cite"&gt;Hi,&lt;br&gt;
      &lt;br&gt;
      I encounter a problem that the eth can't be up in the VM by using
      VT-d.&lt;br&gt;
      I boot the VM using "virsh create vt_d.xml".&lt;br&gt;
      The VM could recongize the NIC which was assigned .then I do in VM
      as follows:&lt;br&gt;
      #cat /sys/class/net/eth0/operstate&lt;br&gt;
      down&lt;br&gt;
      #ifconfig eth0 up&lt;br&gt;
      #cat /sys/class/net/eth0/operstate&lt;br&gt;
      down&lt;br&gt;
      #ficonfig eth 10.100.0.5&lt;br&gt;
      #cat /sys/class/net/eth0/operstate&lt;br&gt;
      down&lt;br&gt;
      more system information is attached.(uname ¡¢ifconfig
      ¡¢lspci¡¢cmdline...)&lt;br&gt;
      &lt;br&gt;
      I can't figure out the reason why the eth is still down? can
      anyone help me ?&lt;br&gt;
      &lt;br&gt;
      best regards,&lt;br&gt;
      qinguan&lt;br&gt;
      &lt;br&gt;
      &lt;br&gt;
      &lt;br&gt;
      vt_d.xml:&lt;br&gt;
      &lt;domain type='kvm'&gt;&lt;br&gt;
          &lt;name&gt;test&lt;/name&gt;&lt;br&gt;
          &lt;description&gt;just test using \
sriov!&lt;/description&gt;&lt;br&gt;      &lt;os&gt;&lt;br&gt;
              &lt;type&gt;hvm&lt;/type&gt;&lt;br&gt;
              &lt;boot dev='hd'/&gt;&lt;br&gt;
          &lt;/os&gt;&lt;br&gt;
          &lt;memory&gt;524288&lt;/memory&gt;&lt;br&gt;
          &lt;currentMemory&gt;524288&lt;/currentMemory&gt;&lt;br&gt;
          &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;&lt;br&gt;
          &lt;on_reboot&gt;restart&lt;/on_reboot&gt;&lt;br&gt;
          &lt;on_crash&gt;restart&lt;/on_crash&gt;&lt;br&gt;
        &lt;br&gt;
         
      &lt;features&gt;&lt;pae/&gt;&lt;acpi/&gt;&lt;apic/&gt;&lt;/features&gt;&lt;br&gt;
          &lt;clock offset='utc'/&gt;&lt;br&gt;
          &lt;devices&gt;&lt;br&gt;
              &lt;input type='mouse' \
                bus='usb'/&gt;      &lt;br&gt;
              &lt;disk type='file' \
                device='disk'&gt;&lt;br&gt;
                  &lt;source \
                file='/home/qinguan/exp/ubuntu_1.img'/&gt;&lt;br&gt;
                  &lt;target \
                dev='hda' bus='virtio'/&gt;&lt;br&gt;
              &lt;/disk&gt;    &lt;br&gt;
              \
                &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;&lt;br&gt;
              &lt;graphics type='vnc' \
                port='-1'/&gt;      &lt;br&gt;
              &lt;hostdev mode='subsystem' \
                type='pci' managed='yes'&gt;&lt;br&gt;
                  \
                &lt;source&gt;&lt;br&gt;
                      \
&lt;address bus='0x0' slot='0x19'  function='0x0'/&gt;&lt;br&gt;
                  \
                &lt;/source&gt;&lt;br&gt;
              \
&lt;/hostdev&gt;     &lt;br&gt;      \
&lt;/devices&gt;&lt;br&gt;  &lt;/domain&gt;&lt;br&gt;
      &lt;br&gt;
      &lt;pre wrap=""&gt;
&lt;fieldset class="mimeAttachmentHeader"&gt;&lt;/fieldset&gt;
_______________________________________________
libvirt-users mailing list
&lt;a class="moz-txt-link-abbreviated" \
href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt; &lt;a \
class="moz-txt-link-freetext" \
href="https://www.redhat.com/mailman/listinfo/libvirt-users"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;/pre&gt;
  &lt;/blockquote&gt;
    &lt;br&gt;
  &lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20110503073845</emailId><senderName>guan qin</senderName><senderEmail>qinguan0619@gmail.com</senderEmail><timestampReceived>2011-05-03 07:38:45-0400</timestampReceived><subject>Re: [libvirt-users] can't up the eth in the vm and access to network</subject><body>

Thanks a lot for your reply sincerely!

Actually ,if I do as what
http://www.linux-kvm.org/page/How_to_assign_devices_with_VT-d_in_KVM said,:
"
 echo "8086 10b9" &gt; /sys/bus/pci/drivers/pci-stub/new_id
echo 0000:01:00.0 &gt; /sys/bus/pci/devices/0000:01:00.0/driver/unbind
echo 0000:01:00.0 &gt; /sys/bus/pci/drivers/pci-stub/bind
"
Then I can assign a NIC to the VM ,and the VM also can use the NIC to access
the network.

 But , according  the libvirt guide that
http://libvirt.org/formatdomain.html#elementsUSB shows:
"
When managed is "yes" for a PCI device, it is detached from the host before
being passed on to the guest.
"
So should I still "unbind " the device from the host OS driver first ? If
that ,What's the "detached" meaning ? thanks.


best regards,
qinguan

ÔÚ 2011Äê5Ô 3ÈÕ ÉÏÎç8:47£¬David White &lt;dwhite@speakeasy.net&gt;Ð´µÀ£º

&gt;
&gt; did you 'unbind' the device from the host OS driver?
&gt;
&gt;
&gt; On 05/01/2011 01:38 AM, guan qin wrote:
&gt;
&gt;  Hi,
&gt;
&gt; I encounter a problem that the eth can't be up in the VM by using VT-d.
&gt; I boot the VM using "virsh create vt_d.xml".
&gt; The VM could recongize the NIC which was assigned .then I do in VM as
&gt; follows:
&gt; #cat /sys/class/net/eth0/operstate
&gt; down
&gt; #ifconfig eth0 up
&gt; #cat /sys/class/net/eth0/operstate
&gt; down
&gt; #ficonfig eth 10.100.0.5
&gt; #cat /sys/class/net/eth0/operstate
&gt; down
&gt; more system information is attached.(uname ¡¢ifconfig ¡¢lspci¡¢cmdline...)
&gt;
&gt; I can't figure out the reason why the eth is still down? can anyone help me
&gt; ?
&gt;
&gt; best regards,
&gt; qinguan
&gt;
&gt;
&gt;
&gt; vt_d.xml:
&gt; &lt;domain type='kvm'&gt;
&gt;     &lt;name&gt;test&lt;/name&gt;
&gt;     &lt;description&gt;just test using sriov!&lt;/description&gt;
&gt;     &lt;os&gt;
&gt;         &lt;type&gt;hvm&lt;/type&gt;
&gt;         &lt;boot dev='hd'/&gt;
&gt;     &lt;/os&gt;
&gt;     &lt;memory&gt;524288&lt;/memory&gt;
&gt;     &lt;currentMemory&gt;524288&lt;/currentMemory&gt;
&gt;     &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
&gt;     &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
&gt;     &lt;on_crash&gt;restart&lt;/on_crash&gt;
&gt;
&gt;     &lt;features&gt;&lt;pae/&gt;&lt;acpi/&gt;&lt;apic/&gt;&lt;/features&gt;
&gt;     &lt;clock offset='utc'/&gt;
&gt;     &lt;devices&gt;
&gt;         &lt;input type='mouse' bus='usb'/&gt;
&gt;         &lt;disk type='file' device='disk'&gt;
&gt;             &lt;source file='/home/qinguan/exp/ubuntu_1.img'/&gt;
&gt;             &lt;target dev='hda' bus='virtio'/&gt;
&gt;         &lt;/disk&gt;
&gt;         &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;
&gt;         &lt;graphics type='vnc' port='-1'/&gt;
&gt;         &lt;hostdev mode='subsystem' type='pci' managed='yes'&gt;
&gt;             &lt;source&gt;
&gt;                 &lt;address bus='0x0' slot='0x19' function='0x0'/&gt;
&gt;             &lt;/source&gt;
&gt;         &lt;/hostdev&gt;
&gt;     &lt;/devices&gt;
&gt; &lt;/domain&gt;
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing listlibvirt-users@redhat.comhttps://www.redhat.com/mailman/listinfo/libvirt-users
&gt;
&gt;
&gt;

[Attachment #3 (text/html)]

&lt;div&gt;Thanks a lot for your reply sincerely!&lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt;Actually ,if I do as what &lt;a \
href="http://www.linux-kvm.org/page/How_to_assign_devices_with_VT-d_in_KVM"&gt;http://www.linux-kvm.org/page/How_to_assign_devices_with_VT-d_in_KVM&lt;/a&gt; said,:&lt;/div&gt;
 &lt;div&gt;"&lt;/div&gt;
&lt;div&gt;
&lt;li&gt;echo "8086 10b9" &gt; /sys/bus/pci/drivers/pci-stub/new_id 
&lt;li&gt;echo 0000:01:00.0 &gt; /sys/bus/pci/devices/0000:01:00.0/driver/unbind 
&lt;li&gt;echo 0000:01:00.0 &gt; /sys/bus/pci/drivers/pci-stub/bind&lt;/li&gt;&lt;/li&gt;&lt;/li&gt;&lt;/div&gt;
&lt;div&gt;"&lt;/div&gt;
&lt;div&gt;Then I can assign a NIC to the VM ,and the VM also can use the NIC to access the \
network.&lt;/div&gt; &lt;div&gt; &lt;/div&gt;
&lt;div&gt;
&lt;div&gt;But , according  the libvirt guide that &lt;a \
href="http://libvirt.org/formatdomain.html#elementsUSB"&gt;http://libvirt.org/formatdomain.html#elementsUSB&lt;/a&gt; shows:&lt;/div&gt;
 &lt;div&gt;"&lt;/div&gt;
&lt;div&gt;When &lt;code&gt;managed&lt;/code&gt; is "yes" for a PCI device, it is detached \
from the host before being passed on to the guest.&lt;/div&gt; &lt;div&gt;"&lt;br&gt;So should I \
still "unbind " the device from the host OS driver first ? If that \
,What's the "detached" meaning ? thanks.&lt;/div&gt; &lt;div&gt; &lt;/div&gt;
&lt;div&gt; &lt;/div&gt;&lt;/div&gt;
&lt;div&gt;best regards,&lt;/div&gt;
&lt;div&gt;qinguan&lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div class="gmail_quote"&gt;ÔÚ 2011Äê5Ô 3ÈÕ ÉÏÎç8:47£¬David White &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:dwhite@speakeasy.net"&gt;dwhite@speakeasy.net&lt;/a&gt;&gt;&lt;/span&gt;Ð´µÀ£º&lt;br&gt; \
&lt;blockquote class="gmail_quote" style="PADDING-LEFT: 1ex; MARGIN: 0px 0px 0px 0.8ex; \
BORDER-LEFT: #ccc 1px solid"&gt; &lt;div text="#000000" bgcolor="#ffffff"&gt;&lt;br&gt;did you \
'unbind' the device from the host OS driver?  &lt;div&gt;
&lt;div&gt;&lt;/div&gt;
&lt;div class="h5"&gt;&lt;br&gt;&lt;br&gt;On 05/01/2011 01:38 AM, guan qin wrote: &lt;/div&gt;&lt;/div&gt;
&lt;blockquote type="cite"&gt;
&lt;div&gt;
&lt;div&gt;&lt;/div&gt;
&lt;div class="h5"&gt;Hi,&lt;br&gt;&lt;br&gt;I encounter a problem that the eth can't be up in the \
VM by using VT-d.&lt;br&gt;I boot the VM using "virsh create vt_d.xml".&lt;br&gt;The VM \
could recongize the NIC which was assigned .then I do in VM as follows:&lt;br&gt; #cat \
/sys/class/net/eth0/operstate&lt;br&gt;down&lt;br&gt;#ifconfig eth0 up&lt;br&gt;#cat \
/sys/class/net/eth0/operstate&lt;br&gt;down&lt;br&gt;#ficonfig eth 10.100.0.5&lt;br&gt;#cat \
/sys/class/net/eth0/operstate&lt;br&gt;down&lt;br&gt;more system information is attached.(uname \
¡¢ifconfig ¡¢lspci¡¢cmdline...)&lt;br&gt; &lt;br&gt;I can't figure out the reason why the eth \
is still down? can anyone help me ?&lt;br&gt;&lt;br&gt;best \
regards,&lt;br&gt;qinguan&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;vt_d.xml:&lt;br&gt;&lt;domain \
type='kvm'&gt;&lt;br&gt;    \
&lt;name&gt;test&lt;/name&gt;&lt;br&gt;    &lt;description&gt;just test \
using sriov!&lt;/description&gt;&lt;br&gt;     \
&lt;os&gt;&lt;br&gt;        \
&lt;type&gt;hvm&lt;/type&gt;&lt;br&gt;        &lt;boot \
dev='hd'/&gt;&lt;br&gt;    &lt;/os&gt;&lt;br&gt;    \
&lt;memory&gt;524288&lt;/memory&gt;&lt;br&gt;    \
&lt;currentMemory&gt;524288&lt;/currentMemory&gt;&lt;br&gt;    \
&lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;&lt;br&gt;     \
&lt;on_reboot&gt;restart&lt;/on_reboot&gt;&lt;br&gt;    \
&lt;on_crash&gt;restart&lt;/on_crash&gt;&lt;br&gt;  &lt;br&gt;    \
&lt;features&gt;&lt;pae/&gt;&lt;acpi/&gt;&lt;apic/&gt;&lt;/features&gt;&lt;br&gt;    \
&lt;clock offset='utc'/&gt;&lt;br&gt;     \
&lt;devices&gt;&lt;br&gt;        &lt;input \
type='mouse' bus='usb'/&gt;      \
&lt;br&gt;        &lt;disk type='file' \
device='disk'&gt;&lt;br&gt;            \
&lt;source file='/home/qinguan/exp/ubuntu_1.img'/&gt;&lt;br&gt; \
            &lt;target \
dev='hda' bus='virtio'/&gt;&lt;br&gt;        \
&lt;/disk&gt;    &lt;br&gt;        \
&lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;&lt;br&gt;        \
&lt;graphics type='vnc' port='-1'/&gt;      \
&lt;br&gt;         &lt;hostdev mode='subsystem' \
type='pci' managed='yes'&gt;&lt;br&gt;            \
&lt;source&gt;&lt;br&gt;                \
&lt;address bus='0x0' slot='0x19' \
function='0x0'/&gt;&lt;br&gt;            \
&lt;/source&gt;&lt;br&gt;         \
&lt;/hostdev&gt;     &lt;br&gt;    \
&lt;/devices&gt;&lt;br&gt;&lt;/domain&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;pre&gt;&lt;fieldset&gt;&lt;/fieldset&gt; \
_______________________________________________ libvirt-users mailing list
&lt;a href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt; &lt;a \
href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;/pre&gt;&lt;/blockquote&gt;&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;




</body></email><email><emailId>20110503082813</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-05-03 08:28:13-0400</timestampReceived><subject>Re: [libvirt-users] can't up the eth in the vm and access to network</subject><body>

ÓÚ 2011Äê05Ô 03ÈÕ 15:38, guan qin Ð´µÀ:
&gt; Thanks a lot for your reply sincerely!
&gt; Actually ,if I do as what 
&gt; http://www.linux-kvm.org/page/How_to_assign_devices_with_VT-d_in_KVM said,:
&gt; "
&gt; # echo "8086 10b9" &gt; /sys/bus/pci/drivers/pci-stub/new_id
&gt; # echo 0000:01:00.0 &gt; /sys/bus/pci/devices/0000:01:00.0/driver/unbind
&gt; # echo 0000:01:00.0 &gt; /sys/bus/pci/drivers/pci-stub/bind
&gt; "
&gt; Then I can assign a NIC to the VM ,and the VM also can use the NIC to 
&gt; access the network.
&gt; But , according the libvirt guide that 
&gt; http://libvirt.org/formatdomain.html#elementsUSB shows:
&gt; "
&gt; When |managed| is "yes" for a PCI device, it is detached from the host 
&gt; before being passed on to the guest.
&gt; "
&gt; So should I still "unbind " the device from the host OS driver first ? 
&gt; If that ,What's the "detached" meaning ? thanks.
&gt; best regards,
&gt; qinguan

libvirt trys to detach the PCI device from host as preparation when
starting up the domain, and it also binds the device to pci_stub
driver, so it's strange that you need to do it manually? what's
your libvirt version?

&gt; ÔÚ 2011Äê5Ô 3ÈÕ ÉÏÎç8:47£¬David White &lt;dwhite@speakeasy.net 
&gt; &lt;mailto:dwhite@speakeasy.net&gt;&gt;Ð´µÀ£º
&gt; 
&gt; 
&gt;     did you 'unbind' the device from the host OS driver?
&gt; 
&gt; 
&gt;     On 05/01/2011 01:38 AM, guan qin wrote:
&gt;&gt;     Hi,
&gt;&gt;
&gt;&gt;     I encounter a problem that the eth can't be up in the VM by using
&gt;&gt;     VT-d.
&gt;&gt;     I boot the VM using "virsh create vt_d.xml".
&gt;&gt;     The VM could recongize the NIC which was assigned .then I do in VM
&gt;&gt;     as follows:
&gt;&gt;     #cat /sys/class/net/eth0/operstate
&gt;&gt;     down
&gt;&gt;     #ifconfig eth0 up
&gt;&gt;     #cat /sys/class/net/eth0/operstate
&gt;&gt;     down
&gt;&gt;     #ficonfig eth 10.100.0.5
&gt;&gt;     #cat /sys/class/net/eth0/operstate
&gt;&gt;     down
&gt;&gt;     more system information is attached.(uname ¡¢ifconfig ¡¢lspci¡¢
&gt;&gt;     cmdline...)
&gt;&gt;
&gt;&gt;     I can't figure out the reason why the eth is still down? can
&gt;&gt;     anyone help me ?
&gt;&gt;
&gt;&gt;     best regards,
&gt;&gt;     qinguan
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;     vt_d.xml:
&gt;&gt;     &lt;domain type='kvm'&gt;
&gt;&gt;     &lt;name&gt;test&lt;/name&gt;
&gt;&gt;     &lt;description&gt;just test using sriov!&lt;/description&gt;
&gt;&gt;     &lt;os&gt;
&gt;&gt;     &lt;type&gt;hvm&lt;/type&gt;
&gt;&gt;     &lt;boot dev='hd'/&gt;
&gt;&gt;     &lt;/os&gt;
&gt;&gt;     &lt;memory&gt;524288&lt;/memory&gt;
&gt;&gt;     &lt;currentMemory&gt;524288&lt;/currentMemory&gt;
&gt;&gt;     &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
&gt;&gt;     &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
&gt;&gt;     &lt;on_crash&gt;restart&lt;/on_crash&gt;
&gt;&gt;
&gt;&gt;     &lt;features&gt;&lt;pae/&gt;&lt;acpi/&gt;&lt;apic/&gt;&lt;/features&gt;
&gt;&gt;     &lt;clock offset='utc'/&gt;
&gt;&gt;     &lt;devices&gt;
&gt;&gt;     &lt;input type='mouse' bus='usb'/&gt;
&gt;&gt;     &lt;disk type='file' device='disk'&gt;
&gt;&gt;     &lt;source file='/home/qinguan/exp/ubuntu_1.img'/&gt;
&gt;&gt;     &lt;target dev='hda' bus='virtio'/&gt;
&gt;&gt;     &lt;/disk&gt;
&gt;&gt;     &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;
&gt;&gt;     &lt;graphics type='vnc' port='-1'/&gt;
&gt;&gt;     &lt;hostdev mode='subsystem' type='pci' managed='yes'&gt;
&gt;&gt;     &lt;source&gt;
&gt;&gt;     &lt;address bus='0x0' slot='0x19' function='0x0'/&gt;
&gt;&gt;     &lt;/source&gt;
&gt;&gt;     &lt;/hostdev&gt;
&gt;&gt;     &lt;/devices&gt;
&gt;&gt;     &lt;/domain&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;     _______________________________________________
&gt;&gt;     libvirt-users mailing list
&gt;&gt;     libvirt-users@redhat.com  &lt;mailto:libvirt-users@redhat.com&gt;
&gt;&gt;     https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; 
&gt; 
&gt; 
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110504063106</emailId><senderName>guan qin</senderName><senderEmail>qinguan0619@gmail.com</senderEmail><timestampReceived>2011-05-04 06:31:06-0400</timestampReceived><subject>Re: [libvirt-users] can't up the eth in the vm and access to network</subject><body>

Hi£¬the libvirt version is 0.8.3, I just used  "apt-get install libvirt-bin"
to install it under debian6.0.1a.
Is it  necessary to install 0.8.4 or higher version ?

Best regards,
qinguan


ÔÚ 2011Äê5Ô 3ÈÕ Ï Îç4:28£¬Osier Yang &lt;jyang@redhat.com&gt;Ð´µÀ£º

&gt; ÓÚ 2011Äê05Ô 03ÈÕ 15:38, guan qin Ð´µÀ:
&gt; &gt; Thanks a lot for your reply sincerely!
&gt; &gt; Actually ,if I do as what
&gt; &gt; http://www.linux-kvm.org/page/How_to_assign_devices_with_VT-d_in_KVMsaid,:
&gt; &gt; "
&gt; &gt; # echo "8086 10b9" &gt; /sys/bus/pci/drivers/pci-stub/new_id
&gt; &gt; # echo 0000:01:00.0 &gt; /sys/bus/pci/devices/0000:01:00.0/driver/unbind
&gt; &gt; # echo 0000:01:00.0 &gt; /sys/bus/pci/drivers/pci-stub/bind
&gt; &gt; "
&gt; &gt; Then I can assign a NIC to the VM ,and the VM also can use the NIC to
&gt; &gt; access the network.
&gt; &gt; But , according the libvirt guide that
&gt; &gt; http://libvirt.org/formatdomain.html#elementsUSB shows:
&gt; &gt; "
&gt; &gt; When |managed| is "yes" for a PCI device, it is detached from the host
&gt; &gt; before being passed on to the guest.
&gt; &gt; "
&gt; &gt; So should I still "unbind " the device from the host OS driver first ?
&gt; &gt; If that ,What's the "detached" meaning ? thanks.
&gt; &gt; best regards,
&gt; &gt; qinguan
&gt;
&gt; libvirt trys to detach the PCI device from host as preparation when
&gt; starting up the domain, and it also binds the device to pci_stub
&gt; driver, so it's strange that you need to do it manually? what's
&gt; your libvirt version?
&gt;
&gt; &gt; ÔÚ 2011Äê5Ô 3ÈÕ ÉÏÎç8:47£¬David White &lt;dwhite@speakeasy.net
&gt; &gt; &lt;mailto:dwhite@speakeasy.net&gt;&gt;Ð´µÀ£º
&gt; &gt;
&gt; &gt;
&gt; &gt;     did you 'unbind' the device from the host OS driver?
&gt; &gt;
&gt; &gt;
&gt; &gt;     On 05/01/2011 01:38 AM, guan qin wrote:
&gt; &gt;&gt;     Hi,
&gt; &gt;&gt;
&gt; &gt;&gt;     I encounter a problem that the eth can't be up in the VM by using
&gt; &gt;&gt;     VT-d.
&gt; &gt;&gt;     I boot the VM using "virsh create vt_d.xml".
&gt; &gt;&gt;     The VM could recongize the NIC which was assigned .then I do in VM
&gt; &gt;&gt;     as follows:
&gt; &gt;&gt;     #cat /sys/class/net/eth0/operstate
&gt; &gt;&gt;     down
&gt; &gt;&gt;     #ifconfig eth0 up
&gt; &gt;&gt;     #cat /sys/class/net/eth0/operstate
&gt; &gt;&gt;     down
&gt; &gt;&gt;     #ficonfig eth 10.100.0.5
&gt; &gt;&gt;     #cat /sys/class/net/eth0/operstate
&gt; &gt;&gt;     down
&gt; &gt;&gt;     more system information is attached.(uname ¡¢ifconfig ¡¢lspci¡¢
&gt; &gt;&gt;     cmdline...)
&gt; &gt;&gt;
&gt; &gt;&gt;     I can't figure out the reason why the eth is still down? can
&gt; &gt;&gt;     anyone help me ?
&gt; &gt;&gt;
&gt; &gt;&gt;     best regards,
&gt; &gt;&gt;     qinguan
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt;     vt_d.xml:
&gt; &gt;&gt;     &lt;domain type='kvm'&gt;
&gt; &gt;&gt;     &lt;name&gt;test&lt;/name&gt;
&gt; &gt;&gt;     &lt;description&gt;just test using sriov!&lt;/description&gt;
&gt; &gt;&gt;     &lt;os&gt;
&gt; &gt;&gt;     &lt;type&gt;hvm&lt;/type&gt;
&gt; &gt;&gt;     &lt;boot dev='hd'/&gt;
&gt; &gt;&gt;     &lt;/os&gt;
&gt; &gt;&gt;     &lt;memory&gt;524288&lt;/memory&gt;
&gt; &gt;&gt;     &lt;currentMemory&gt;524288&lt;/currentMemory&gt;
&gt; &gt;&gt;     &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
&gt; &gt;&gt;     &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
&gt; &gt;&gt;     &lt;on_crash&gt;restart&lt;/on_crash&gt;
&gt; &gt;&gt;
&gt; &gt;&gt;     &lt;features&gt;&lt;pae/&gt;&lt;acpi/&gt;&lt;apic/&gt;&lt;/features&gt;
&gt; &gt;&gt;     &lt;clock offset='utc'/&gt;
&gt; &gt;&gt;     &lt;devices&gt;
&gt; &gt;&gt;     &lt;input type='mouse' bus='usb'/&gt;
&gt; &gt;&gt;     &lt;disk type='file' device='disk'&gt;
&gt; &gt;&gt;     &lt;source file='/home/qinguan/exp/ubuntu_1.img'/&gt;
&gt; &gt;&gt;     &lt;target dev='hda' bus='virtio'/&gt;
&gt; &gt;&gt;     &lt;/disk&gt;
&gt; &gt;&gt;     &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;
&gt; &gt;&gt;     &lt;graphics type='vnc' port='-1'/&gt;
&gt; &gt;&gt;     &lt;hostdev mode='subsystem' type='pci' managed='yes'&gt;
&gt; &gt;&gt;     &lt;source&gt;
&gt; &gt;&gt;     &lt;address bus='0x0' slot='0x19' function='0x0'/&gt;
&gt; &gt;&gt;     &lt;/source&gt;
&gt; &gt;&gt;     &lt;/hostdev&gt;
&gt; &gt;&gt;     &lt;/devices&gt;
&gt; &gt;&gt;     &lt;/domain&gt;
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt;     _______________________________________________
&gt; &gt;&gt;     libvirt-users mailing list
&gt; &gt;&gt;     libvirt-users@redhat.com  &lt;mailto:libvirt-users@redhat.com&gt;
&gt; &gt;&gt;     https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; _______________________________________________
&gt; &gt; libvirt-users mailing list
&gt; &gt; libvirt-users@redhat.com
&gt; &gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;
&gt;

[Attachment #3 (text/html)]

Hi£¬the libvirt version is 0.8.3, I just used  "apt-get install \
libvirt-bin" to install it under debian6.0.1a.&lt;br&gt;Is it  necessary to \
install 0.8.4 or higher version ?&lt;br&gt;&lt;br&gt;Best regards,&lt;br&gt;qinguan&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt; ÔÚ 2011Äê5Ô 3ÈÕ Ï Îç4:28£¬Osier Yang &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:jyang@redhat.com"&gt;jyang@redhat.com&lt;/a&gt;&gt;&lt;/span&gt;Ð´µÀ£º&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt; ÓÚ 2011Äê05Ô 03ÈÕ 15:38, guan qin Ð´µÀ:&lt;br&gt;
&lt;div class="im"&gt;&gt; Thanks a lot for your reply sincerely!&lt;br&gt;
&gt; Actually ,if I do as what&lt;br&gt;
&gt; &lt;a href="http://www.linux-kvm.org/page/How_to_assign_devices_with_VT-d_in_KVM" \
target="_blank"&gt;http://www.linux-kvm.org/page/How_to_assign_devices_with_VT-d_in_KVM&lt;/a&gt; \
said,:&lt;br&gt; &gt; "&lt;br&gt;
&gt; # echo "8086 10b9" &gt; /sys/bus/pci/drivers/pci-stub/new_id&lt;br&gt;
&gt; # echo 0000:01:00.0 &gt; /sys/bus/pci/devices/0000:01:00.0/driver/unbind&lt;br&gt;
&gt; # echo 0000:01:00.0 &gt; /sys/bus/pci/drivers/pci-stub/bind&lt;br&gt;
&gt; "&lt;br&gt;
&gt; Then I can assign a NIC to the VM ,and the VM also can use the NIC to&lt;br&gt;
&gt; access the network.&lt;br&gt;
&gt; But , according the libvirt guide that&lt;br&gt;
&gt; &lt;a href="http://libvirt.org/formatdomain.html#elementsUSB" \
target="_blank"&gt;http://libvirt.org/formatdomain.html#elementsUSB&lt;/a&gt; shows:&lt;br&gt; &gt; \
"&lt;br&gt; &gt; When |managed| is "yes" for a PCI device, it is detached \
from the host&lt;br&gt; &gt; before being passed on to the guest.&lt;br&gt;
&gt; "&lt;br&gt;
&gt; So should I still "unbind " the device from the host OS driver first \
?&lt;br&gt; &gt; If that ,What's the "detached" meaning ? thanks.&lt;br&gt;
&gt; best regards,&lt;br&gt;
&gt; qinguan&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;libvirt trys to detach the PCI device from host as preparation when&lt;br&gt;
starting up the domain, and it also binds the device to pci_stub&lt;br&gt;
driver, so it's strange that you need to do it manually? what's&lt;br&gt;
your libvirt version?&lt;br&gt;
&lt;div class="im"&gt;&lt;br&gt;
&gt; ÔÚ 2011Äê5Ô 3ÈÕ ÉÏÎç8:47£¬David White &lt;&lt;a \
href="mailto:dwhite@speakeasy.net"&gt;dwhite@speakeasy.net&lt;/a&gt;&lt;br&gt; &lt;/div&gt;&gt; \
&lt;mailto:&lt;a href="mailto:dwhite@speakeasy.net"&gt;dwhite@speakeasy.net&lt;/a&gt;&gt;&gt;Ð´µÀ£º&lt;br&gt;
 &lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt;     did you 'unbind' the device from the host OS driver?&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt;     On 05/01/2011 01:38 AM, guan qin wrote:&lt;br&gt;
&gt;&gt;     Hi,&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;     I encounter a problem that the eth can't be up in the VM \
by using&lt;br&gt; &gt;&gt;     VT-d.&lt;br&gt;
&gt;&gt;     I boot the VM using "virsh create vt_d.xml".&lt;br&gt;
&gt;&gt;     The VM could recongize the NIC which was assigned .then I do \
in VM&lt;br&gt; &gt;&gt;     as follows:&lt;br&gt;
&gt;&gt;     #cat /sys/class/net/eth0/operstate&lt;br&gt;
&gt;&gt;     down&lt;br&gt;
&gt;&gt;     #ifconfig eth0 up&lt;br&gt;
&gt;&gt;     #cat /sys/class/net/eth0/operstate&lt;br&gt;
&gt;&gt;     down&lt;br&gt;
&gt;&gt;     #ficonfig eth 10.100.0.5&lt;br&gt;
&gt;&gt;     #cat /sys/class/net/eth0/operstate&lt;br&gt;
&gt;&gt;     down&lt;br&gt;
&gt;&gt;     more system information is attached.(uname ¡¢ifconfig \
¡¢lspci¡¢&lt;br&gt; &gt;&gt;     cmdline...)&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;     I can't figure out the reason why the eth is still down? \
can&lt;br&gt; &gt;&gt;     anyone help me ?&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;     best regards,&lt;br&gt;
&gt;&gt;     qinguan&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;     vt_d.xml:&lt;br&gt;
&gt;&gt;     &lt;domain type='kvm'&gt;&lt;br&gt;
&gt;&gt;     &lt;name&gt;test&lt;/name&gt;&lt;br&gt;
&gt;&gt;     &lt;description&gt;just test using \
sriov!&lt;/description&gt;&lt;br&gt; &gt;&gt;     &lt;os&gt;&lt;br&gt;
&gt;&gt;     &lt;type&gt;hvm&lt;/type&gt;&lt;br&gt;
&gt;&gt;     &lt;boot dev='hd'/&gt;&lt;br&gt;
&gt;&gt;     &lt;/os&gt;&lt;br&gt;
&gt;&gt;     &lt;memory&gt;524288&lt;/memory&gt;&lt;br&gt;
&gt;&gt;     &lt;currentMemory&gt;524288&lt;/currentMemory&gt;&lt;br&gt;
&gt;&gt;     &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;&lt;br&gt;
&gt;&gt;     &lt;on_reboot&gt;restart&lt;/on_reboot&gt;&lt;br&gt;
&gt;&gt;     &lt;on_crash&gt;restart&lt;/on_crash&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;     \
&lt;features&gt;&lt;pae/&gt;&lt;acpi/&gt;&lt;apic/&gt;&lt;/features&gt;&lt;br&gt; &gt;&gt; \
    &lt;clock offset='utc'/&gt;&lt;br&gt; &gt;&gt;     \
&lt;devices&gt;&lt;br&gt; &gt;&gt;     &lt;input type='mouse' \
bus='usb'/&gt;&lt;br&gt; &gt;&gt;     &lt;disk type='file' \
device='disk'&gt;&lt;br&gt; &gt;&gt;     &lt;source \
file='/home/qinguan/exp/ubuntu_1.img'/&gt;&lt;br&gt; &gt;&gt;     \
&lt;target dev='hda' bus='virtio'/&gt;&lt;br&gt; &gt;&gt;     \
&lt;/disk&gt;&lt;br&gt; &gt;&gt;     \
&lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;&lt;br&gt; &gt;&gt;     &lt;graphics \
type='vnc' port='-1'/&gt;&lt;br&gt; &gt;&gt;     &lt;hostdev \
mode='subsystem' type='pci' managed='yes'&gt;&lt;br&gt; &gt;&gt; \
    &lt;source&gt;&lt;br&gt; &gt;&gt;     &lt;address bus='0x0' \
slot='0x19' function='0x0'/&gt;&lt;br&gt; &gt;&gt;     \
&lt;/source&gt;&lt;br&gt; &gt;&gt;     &lt;/hostdev&gt;&lt;br&gt;
&gt;&gt;     &lt;/devices&gt;&lt;br&gt;
&gt;&gt;     &lt;/domain&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;     _______________________________________________&lt;br&gt;
&gt;&gt;     libvirt-users mailing list&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;&gt;&gt;     &lt;a \
href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt; \
 &lt;mailto:&lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&gt;&lt;br&gt;
 &lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;&gt;&gt;     &lt;a \
href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; \
&gt;&lt;br&gt; &gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt; _______________________________________________&lt;br&gt;
&gt; libvirt-users mailing list&lt;br&gt;
&gt; &lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
&gt; &lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; &lt;br&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110504065504</emailId><senderName>guan qin</senderName><senderEmail>qinguan0619@gmail.com</senderEmail><timestampReceived>2011-05-04 06:55:04-0400</timestampReceived><subject>Re: [libvirt-users] can't up the eth in the vm and access to network</subject><body>

sorry for missing some information.
I checkd the device that :
# readlink /sys/bus/pci/devices/0000\:00\:19.0/driver
../../../bus/pci/drivers/pci-stub

the device has been already claimed by pci-stub and under the control of
pci_stub.
so the reason that can't up the eth in VM maybe has nothing to do with the
libvirt version.

After doing the first three
steps:How_to_assign_devices_with_VT-d_in_KVM&lt;http://www.linux-kvm.org/page/How_to_assign_devices_with_VT-d_in_KVM&gt;
 (
*1. Modifying kernel config
**2. build kernel
**3. reboot and verify that your system has IOMMU support*
),
I use "virsh create vt_d.xml" instead of the ubind/bind and assign device.
(the kvm and kvm_intel has already been loaded)
should I do something others to use the VT_d?

best regards,
qinguan


ÔÚ 2011Äê5Ô 4ÈÕ Ï Îç2:31£¬guan qin &lt;qinguan0619@gmail.com&gt;Ð´µÀ£º

&gt; Hi£¬the libvirt version is 0.8.3, I just used  "apt-get install libvirt-bin"
&gt; to install it under debian6.0.1a.
&gt; Is it  necessary to install 0.8.4 or higher version ?
&gt; 
&gt; Best regards,
&gt; qinguan
&gt; 
&gt; 
&gt; ÔÚ 2011Äê5Ô 3ÈÕ Ï Îç4:28£¬Osier Yang &lt;jyang@redhat.com&gt;Ð´µÀ£º
&gt; 
&gt; &gt; ÓÚ 2011Äê05Ô 03ÈÕ 15:38, guan qin Ð´µÀ:
&gt; &gt; 
&gt; &gt; &gt; Thanks a lot for your reply sincerely!
&gt; &gt; &gt; Actually ,if I do as what
&gt; &gt; &gt; http://www.linux-kvm.org/page/How_to_assign_devices_with_VT-d_in_KVMsaid,:
&gt; &gt; &gt; "
&gt; &gt; &gt; # echo "8086 10b9" &gt; /sys/bus/pci/drivers/pci-stub/new_id
&gt; &gt; &gt; # echo 0000:01:00.0 &gt; /sys/bus/pci/devices/0000:01:00.0/driver/unbind
&gt; &gt; &gt; # echo 0000:01:00.0 &gt; /sys/bus/pci/drivers/pci-stub/bind
&gt; &gt; &gt; "
&gt; &gt; &gt; Then I can assign a NIC to the VM ,and the VM also can use the NIC to
&gt; &gt; &gt; access the network.
&gt; &gt; &gt; But , according the libvirt guide that
&gt; &gt; &gt; http://libvirt.org/formatdomain.html#elementsUSB shows:
&gt; &gt; &gt; "
&gt; &gt; &gt; When |managed| is "yes" for a PCI device, it is detached from the host
&gt; &gt; &gt; before being passed on to the guest.
&gt; &gt; &gt; "
&gt; &gt; &gt; So should I still "unbind " the device from the host OS driver first ?
&gt; &gt; &gt; If that ,What's the "detached" meaning ? thanks.
&gt; &gt; &gt; best regards,
&gt; &gt; &gt; qinguan
&gt; &gt; 
&gt; &gt; libvirt trys to detach the PCI device from host as preparation when
&gt; &gt; starting up the domain, and it also binds the device to pci_stub
&gt; &gt; driver, so it's strange that you need to do it manually? what's
&gt; &gt; your libvirt version?
&gt; &gt; 
&gt; &gt; &gt; ÔÚ 2011Äê5Ô 3ÈÕ ÉÏÎç8:47£¬David White &lt;dwhite@speakeasy.net
&gt; &gt; &gt; &lt;mailto:dwhite@speakeasy.net&gt;&gt;Ð´µÀ£º
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; did you 'unbind' the device from the host OS driver?
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; On 05/01/2011 01:38 AM, guan qin wrote:
&gt; &gt; &gt; &gt; Hi,
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; I encounter a problem that the eth can't be up in the VM by using
&gt; &gt; &gt; &gt; VT-d.
&gt; &gt; &gt; &gt; I boot the VM using "virsh create vt_d.xml".
&gt; &gt; &gt; &gt; The VM could recongize the NIC which was assigned .then I do in VM
&gt; &gt; &gt; &gt; as follows:
&gt; &gt; &gt; &gt; #cat /sys/class/net/eth0/operstate
&gt; &gt; &gt; &gt; down
&gt; &gt; &gt; &gt; #ifconfig eth0 up
&gt; &gt; &gt; &gt; #cat /sys/class/net/eth0/operstate
&gt; &gt; &gt; &gt; down
&gt; &gt; &gt; &gt; #ficonfig eth 10.100.0.5
&gt; &gt; &gt; &gt; #cat /sys/class/net/eth0/operstate
&gt; &gt; &gt; &gt; down
&gt; &gt; &gt; &gt; more system information is attached.(uname ¡¢ifconfig ¡¢lspci¡¢
&gt; &gt; &gt; &gt; cmdline...)
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; I can't figure out the reason why the eth is still down? can
&gt; &gt; &gt; &gt; anyone help me ?
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; best regards,
&gt; &gt; &gt; &gt; qinguan
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; vt_d.xml:
&gt; &gt; &gt; &gt; &lt;domain type='kvm'&gt;
&gt; &gt; &gt; &gt; &lt;name&gt;test&lt;/name&gt;
&gt; &gt; &gt; &gt; &lt;description&gt;just test using sriov!&lt;/description&gt;
&gt; &gt; &gt; &gt; &lt;os&gt;
&gt; &gt; &gt; &gt; &lt;type&gt;hvm&lt;/type&gt;
&gt; &gt; &gt; &gt; &lt;boot dev='hd'/&gt;
&gt; &gt; &gt; &gt; &lt;/os&gt;
&gt; &gt; &gt; &gt; &lt;memory&gt;524288&lt;/memory&gt;
&gt; &gt; &gt; &gt; &lt;currentMemory&gt;524288&lt;/currentMemory&gt;
&gt; &gt; &gt; &gt; &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
&gt; &gt; &gt; &gt; &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
&gt; &gt; &gt; &gt; &lt;on_crash&gt;restart&lt;/on_crash&gt;
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &lt;features&gt;&lt;pae/&gt;&lt;acpi/&gt;&lt;apic/&gt;&lt;/features&gt;
&gt; &gt; &gt; &gt; &lt;clock offset='utc'/&gt;
&gt; &gt; &gt; &gt; &lt;devices&gt;
&gt; &gt; &gt; &gt; &lt;input type='mouse' bus='usb'/&gt;
&gt; &gt; &gt; &gt; &lt;disk type='file' device='disk'&gt;
&gt; &gt; &gt; &gt; &lt;source file='/home/qinguan/exp/ubuntu_1.img'/&gt;
&gt; &gt; &gt; &gt; &lt;target dev='hda' bus='virtio'/&gt;
&gt; &gt; &gt; &gt; &lt;/disk&gt;
&gt; &gt; &gt; &gt; &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;
&gt; &gt; &gt; &gt; &lt;graphics type='vnc' port='-1'/&gt;
&gt; &gt; &gt; &gt; &lt;hostdev mode='subsystem' type='pci' managed='yes'&gt;
&gt; &gt; &gt; &gt; &lt;source&gt;
&gt; &gt; &gt; &gt; &lt;address bus='0x0' slot='0x19' function='0x0'/&gt;
&gt; &gt; &gt; &gt; &lt;/source&gt;
&gt; &gt; &gt; &gt; &lt;/hostdev&gt;
&gt; &gt; &gt; &gt; &lt;/devices&gt;
&gt; &gt; &gt; &gt; &lt;/domain&gt;
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; _______________________________________________
&gt; &gt; &gt; &gt; libvirt-users mailing list
&gt; &gt; &gt; &gt; libvirt-users@redhat.com  &lt;mailto:libvirt-users@redhat.com&gt;
&gt; &gt; &gt; &gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; _______________________________________________
&gt; &gt; &gt; libvirt-users mailing list
&gt; &gt; &gt; libvirt-users@redhat.com
&gt; &gt; &gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; &gt; 
&gt; &gt; 
&gt; 


[Attachment #3 (text/html)]

sorry for missing some information.&lt;br&gt;I checkd the device that :&lt;br&gt;# readlink \
/sys/bus/pci/devices/0000\:00\:19.0/driver&lt;br&gt;../../../bus/pci/drivers/pci-stub&lt;br&gt;&lt;br&gt;the \
device has been already claimed by pci-stub and under the control of pci_stub.&lt;br&gt; so \
the reason that can't up the eth in VM maybe has nothing to do with the libvirt \
version.&lt;br&gt;&lt;br&gt;After doing the first three steps:&lt;a \
href="http://www.linux-kvm.org/page/How_to_assign_devices_with_VT-d_in_KVM"&gt;How_to_assign_devices_with_VT-d_in_KVM&lt;/a&gt;&lt;br&gt;
 (&lt;br&gt;&lt;b&gt;1. Modifying kernel config&lt;br&gt;&lt;/b&gt;&lt;b&gt;2. build kernel&lt;br&gt;&lt;/b&gt;&lt;b&gt;3. reboot and \
verify that your system has IOMMU support&lt;/b&gt;&lt;br&gt;),&lt;br&gt;I use "virsh create \
vt_d.xml" instead of the ubind/bind and assign device.&lt;br&gt; (the kvm and \
kvm_intel has already been loaded)&lt;br&gt;should I do something others to use the \
VT_d?&lt;br&gt;&lt;br&gt;best regards,&lt;br&gt;qinguan&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;ÔÚ 2011Äê5Ô \
4ÈÕ Ï Îç2:31£¬guan qin &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:qinguan0619@gmail.com"&gt;qinguan0619@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;Ð´µÀ£º&lt;br&gt; \
&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt;Hi£¬the libvirt version is 0.8.3, I just used  \
"apt-get install libvirt-bin" to install it under debian6.0.1a.&lt;br&gt; Is \
it  necessary to install 0.8.4 or higher version ?&lt;br&gt;&lt;br&gt;Best \
regards,&lt;br&gt;qinguan&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div class="im"&gt; ÔÚ 2011Äê5Ô \
3ÈÕ Ï Îç4:28£¬Osier Yang &lt;span dir="ltr"&gt;&lt;&lt;a href="mailto:jyang@redhat.com" \
target="_blank"&gt;jyang@redhat.com&lt;/a&gt;&gt;&lt;/span&gt;Ð´µÀ£º&lt;br&gt;&lt;/div&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex"&gt;

ÓÚ 2011Äê05Ô 03ÈÕ 15:38, guan qin Ð´µÀ:&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;&lt;br&gt;
&lt;div&gt;&gt; Thanks a lot for your reply sincerely!&lt;br&gt;
&gt; Actually ,if I do as what&lt;br&gt;
&gt; &lt;a href="http://www.linux-kvm.org/page/How_to_assign_devices_with_VT-d_in_KVM" \
target="_blank"&gt;http://www.linux-kvm.org/page/How_to_assign_devices_with_VT-d_in_KVM&lt;/a&gt; \
said,:&lt;br&gt; &gt; "&lt;br&gt;
&gt; # echo "8086 10b9" &gt; /sys/bus/pci/drivers/pci-stub/new_id&lt;br&gt;
&gt; # echo 0000:01:00.0 &gt; /sys/bus/pci/devices/0000:01:00.0/driver/unbind&lt;br&gt;
&gt; # echo 0000:01:00.0 &gt; /sys/bus/pci/drivers/pci-stub/bind&lt;br&gt;
&gt; "&lt;br&gt;
&gt; Then I can assign a NIC to the VM ,and the VM also can use the NIC to&lt;br&gt;
&gt; access the network.&lt;br&gt;
&gt; But , according the libvirt guide that&lt;br&gt;
&gt; &lt;a href="http://libvirt.org/formatdomain.html#elementsUSB" \
target="_blank"&gt;http://libvirt.org/formatdomain.html#elementsUSB&lt;/a&gt; shows:&lt;br&gt; &gt; \
"&lt;br&gt; &gt; When |managed| is "yes" for a PCI device, it is detached \
from the host&lt;br&gt; &gt; before being passed on to the guest.&lt;br&gt;
&gt; "&lt;br&gt;
&gt; So should I still "unbind " the device from the host OS driver first \
?&lt;br&gt; &gt; If that ,What's the "detached" meaning ? thanks.&lt;br&gt;
&gt; best regards,&lt;br&gt;
&gt; qinguan&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;libvirt trys to detach the PCI device from host as preparation when&lt;br&gt;
starting up the domain, and it also binds the device to pci_stub&lt;br&gt;
driver, so it's strange that you need to do it manually? what's&lt;br&gt;
your libvirt version?&lt;br&gt;
&lt;div&gt;&lt;br&gt;
&gt; ÔÚ 2011Äê5Ô 3ÈÕ ÉÏÎç8:47£¬David White &lt;&lt;a href="mailto:dwhite@speakeasy.net" \
target="_blank"&gt;dwhite@speakeasy.net&lt;/a&gt;&lt;br&gt; &lt;/div&gt;&gt; &lt;mailto:&lt;a \
href="mailto:dwhite@speakeasy.net" \
target="_blank"&gt;dwhite@speakeasy.net&lt;/a&gt;&gt;&gt;Ð´µÀ£º&lt;br&gt; \
&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&gt;&lt;br&gt; &gt;&lt;br&gt;
&gt;     did you 'unbind' the device from the host OS driver?&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt;     On 05/01/2011 01:38 AM, guan qin wrote:&lt;br&gt;
&gt;&gt;     Hi,&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;     I encounter a problem that the eth can't be up in the VM \
by using&lt;br&gt; &gt;&gt;     VT-d.&lt;br&gt;
&gt;&gt;     I boot the VM using "virsh create vt_d.xml".&lt;br&gt;
&gt;&gt;     The VM could recongize the NIC which was assigned .then I do \
in VM&lt;br&gt; &gt;&gt;     as follows:&lt;br&gt;
&gt;&gt;     #cat /sys/class/net/eth0/operstate&lt;br&gt;
&gt;&gt;     down&lt;br&gt;
&gt;&gt;     #ifconfig eth0 up&lt;br&gt;
&gt;&gt;     #cat /sys/class/net/eth0/operstate&lt;br&gt;
&gt;&gt;     down&lt;br&gt;
&gt;&gt;     #ficonfig eth 10.100.0.5&lt;br&gt;
&gt;&gt;     #cat /sys/class/net/eth0/operstate&lt;br&gt;
&gt;&gt;     down&lt;br&gt;
&gt;&gt;     more system information is attached.(uname ¡¢ifconfig \
¡¢lspci¡¢&lt;br&gt; &gt;&gt;     cmdline...)&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;     I can't figure out the reason why the eth is still down? \
can&lt;br&gt; &gt;&gt;     anyone help me ?&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;     best regards,&lt;br&gt;
&gt;&gt;     qinguan&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;     vt_d.xml:&lt;br&gt;
&gt;&gt;     &lt;domain type='kvm'&gt;&lt;br&gt;
&gt;&gt;     &lt;name&gt;test&lt;/name&gt;&lt;br&gt;
&gt;&gt;     &lt;description&gt;just test using \
sriov!&lt;/description&gt;&lt;br&gt; &gt;&gt;     &lt;os&gt;&lt;br&gt;
&gt;&gt;     &lt;type&gt;hvm&lt;/type&gt;&lt;br&gt;
&gt;&gt;     &lt;boot dev='hd'/&gt;&lt;br&gt;
&gt;&gt;     &lt;/os&gt;&lt;br&gt;
&gt;&gt;     &lt;memory&gt;524288&lt;/memory&gt;&lt;br&gt;
&gt;&gt;     &lt;currentMemory&gt;524288&lt;/currentMemory&gt;&lt;br&gt;
&gt;&gt;     &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;&lt;br&gt;
&gt;&gt;     &lt;on_reboot&gt;restart&lt;/on_reboot&gt;&lt;br&gt;
&gt;&gt;     &lt;on_crash&gt;restart&lt;/on_crash&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;     \
&lt;features&gt;&lt;pae/&gt;&lt;acpi/&gt;&lt;apic/&gt;&lt;/features&gt;&lt;br&gt; &gt;&gt; \
    &lt;clock offset='utc'/&gt;&lt;br&gt; &gt;&gt;     \
&lt;devices&gt;&lt;br&gt; &gt;&gt;     &lt;input type='mouse' \
bus='usb'/&gt;&lt;br&gt; &gt;&gt;     &lt;disk type='file' \
device='disk'&gt;&lt;br&gt; &gt;&gt;     &lt;source \
file='/home/qinguan/exp/ubuntu_1.img'/&gt;&lt;br&gt; &gt;&gt;     \
&lt;target dev='hda' bus='virtio'/&gt;&lt;br&gt; &gt;&gt;     \
&lt;/disk&gt;&lt;br&gt; &gt;&gt;     \
&lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;&lt;br&gt; &gt;&gt;     &lt;graphics \
type='vnc' port='-1'/&gt;&lt;br&gt; &gt;&gt;     &lt;hostdev \
mode='subsystem' type='pci' managed='yes'&gt;&lt;br&gt; &gt;&gt; \
    &lt;source&gt;&lt;br&gt; &gt;&gt;     &lt;address bus='0x0' \
slot='0x19' function='0x0'/&gt;&lt;br&gt; &gt;&gt;     \
&lt;/source&gt;&lt;br&gt; &gt;&gt;     &lt;/hostdev&gt;&lt;br&gt;
&gt;&gt;     &lt;/devices&gt;&lt;br&gt;
&gt;&gt;     &lt;/domain&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;     _______________________________________________&lt;br&gt;
&gt;&gt;     libvirt-users mailing list&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;&gt;&gt;     &lt;a href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;  &lt;mailto:&lt;a \
href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;&gt;&lt;br&gt; &lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&gt;&gt; \
    &lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; \
&gt;&lt;br&gt; &gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt; _______________________________________________&lt;br&gt;
&gt; libvirt-users mailing list&lt;br&gt;
&gt; &lt;a href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt; &gt; &lt;a \
href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; &lt;br&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110504081736</emailId><senderName>guan qin</senderName><senderEmail>qinguan0619@gmail.com</senderEmail><timestampReceived>2011-05-04 08:17:36-0400</timestampReceived><subject>Re: [libvirt-users] can't up the eth in the vm and access to network</subject><body>

Hi ,
 I look into the qemu log file ,find that :

LC_ALL=C PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
HOME=/ QEMU_AUDIO_DRV=none /usr/bin/kvm -S -M pc-0.12 -enable-kvm -m 512
-smp 1,sockets=1,cores=1,threads=1 -name vt_d_5 -uuid
05f608a3-f64f-2418-a90a-d611982c8336 -nodefaults -chardev
socket,id=monitor,path=/var/lib/libvirt/qemu/vt_d_5.monitor,server,nowait
-mon chardev=monitor,mode=readline -rtc base=utc -boot c -drive
file=/home/qinguan/exp/kvm_vtd/ubuntu_1.img,if=none,id=drive-virtio-disk0,boot=on,format=raw
                
-device
virtio-blk-pci,bus=pci.0,addr=0x3,drive=drive-virtio-disk0,id=virtio-disk0
-usb -device usb-mouse,id=input0 -vnc 127.0.0.1:0 -vga cirrus -device
pci-assign,host=00:19.0,id=hostdev0,bus=pci.0,addr=0x4 -device
virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x5
Failed to assign irq for "hostdev0": Operation not permitted
Perhaps you are assigning a device that shares an IRQ with another device?
Failed to assign irq for "hostdev0": Operation not permitted
Perhaps you are assigning a device that shares an IRQ with another device?
Failed to assign irq for "hostdev0": Operation not permitted
Perhaps you are assigning a device that shares an IRQ with another device?
Failed to assign irq for "hostdev0": Operation not permitted
Perhaps you are assigning a device that shares an IRQ with another device?
Failed to assign irq for "hostdev0": Operation not permitted

maybe the VM can't access to the network because of Failed  to assign irg
for "hostdev0"?

in kern.log :
May  1 12:40:07 Optiplex-780 kernel: [ 3172.784803] e1000e 0000:00:19.0: PCI
INT A disabled
May  1 12:40:07 Optiplex-780 kernel: [ 3172.784863] pci-stub 0000:00:19.0:
claimed by stub
May  1 12:40:07 Optiplex-780 kernel: [ 3173.103965] pci-stub 0000:00:19.0:
PCI INT A -&gt; GSI 21 (level, low) -&gt; IRQ 21
May  1 12:40:07 Optiplex-780 kernel: [ 3173.204030] pci-stub 0000:00:19.0:
restoring config space at offset 0x6 (was 0x1, writing 0xece1)
May  1 12:40:07 Optiplex-780 kernel: [ 3173.204035] pci-stub 0000:00:19.0:
restoring config space at offset 0x5 (was 0x0, writing 0xf7ad9000)
May  1 12:40:07 Optiplex-780 kernel: [ 3173.204039] pci-stub 0000:00:19.0:
restoring config space at offset 0x4 (was 0x0, writing 0xf7ae0000)
May  1 12:40:07 Optiplex-780 kernel: [ 3173.204045] pci-stub 0000:00:19.0:
restoring config space at offset 0x1 (was 0x100000, writing 0x100103)
May  1 12:40:07 Optiplex-780 kernel: [ 3173.435751] assign device 0:0:19.0
May  1 12:44:24 Optiplex-780 kernel: [ 3430.568526] pci-stub 0000:00:19.0:
restoring config space at offset 0x6 (was 0x1, writing 0xece1)
May  1 12:44:24 Optiplex-780 kernel: [ 3430.568532] pci-stub 0000:00:19.0:
restoring config space at offset 0x5 (was 0x0, writing 0xf7ad9000)
May  1 12:44:24 Optiplex-780 kernel: [ 3430.568537] pci-stub 0000:00:19.0:
restoring config space at offset 0x4 (was 0x0, writing 0xf7ae0000)
May  1 12:44:24 Optiplex-780 kernel: [ 3430.568543] pci-stub 0000:00:19.0:
restoring config space at offset 0x1 (was 0x100000, writing 0x100103)
May  1 12:44:24 Optiplex-780 kernel: [ 3430.568561] pci-stub 0000:00:19.0:
PCI INT A disabled


root@Optiplex-780:/var/log/libvirt/qemu# cat /proc/interrupts
           CPU0       CPU1       CPU2       CPU3
  0:         97          1          2          1   IO-APIC-edge      timer
  1:          2          0          0          0   IO-APIC-edge      i8042
  7:          0          0          0          0   IO-APIC-edge
parport0
  8:          1          0          0          0   IO-APIC-edge      rtc0
  9:          0          0          0          0   IO-APIC-fasteoi   acpi
 12:          1          2          1          0   IO-APIC-edge      i8042
 16:          0          0          0          0   IO-APIC-fasteoi
uhci_hcd:usb2
 17:       5822       1952       3614       2233   IO-APIC-fasteoi
uhci_hcd:usb4, uhci_hcd:usb7
 18:          0          0          0          0   IO-APIC-fasteoi
uhci_hcd:usb8
 22:          1          1          1          0   IO-APIC-fasteoi
ehci_hcd:usb1, uhci_hcd:usb5
 23:       1461       1299       1153        912   IO-APIC-fasteoi
ehci_hcd:usb3, uhci_hcd:usb6
 24:     268579          0          0          0  HPET_MSI-edge      hpet2
 25:          0     286310          0          0  HPET_MSI-edge      hpet3
 26:          0          0     210675          0  HPET_MSI-edge      hpet4
 27:          0          0          0     256688  HPET_MSI-edge      hpet5
 29:          1          0          0          0  DMAR_MSI-edge      dmar1
 30:          0          0          0          0  DMAR_MSI-edge      dmar0
 31:          0          0          0          0  DMAR_MSI-edge      dmar2
 35:          0          0          0          1   PCI-MSI-edge      eth1
 36:       1456        916       1323       1657   PCI-MSI-edge
eth1-rx-0
 37:       1031        772       1459        895   PCI-MSI-edge
eth1-rx-1
 38:        958        965        785        470   PCI-MSI-edge
eth1-rx-2
 39:       1319        557       1007        714   PCI-MSI-edge
eth1-rx-3
 40:        892        864        417       1134   PCI-MSI-edge
eth1-tx-0
 41:        414        749        998        606   PCI-MSI-edge
eth1-tx-1
 42:        307        921        375        332   PCI-MSI-edge
eth1-tx-2
 43:        966        693        396        502   PCI-MSI-edge
eth1-tx-3
 54:       7109       5755       5683       5609   PCI-MSI-edge      ahci
 55:         74        105         73         84   PCI-MSI-edge
hda_intel
 56:       1446        927       1108        870   PCI-MSI-edge      i915
NMI:          0          0          0          0   Non-maskable interrupts
LOC:        740        725        703        677   Local timer interrupts
SPU:          0          0          0          0   Spurious interrupts
PMI:          0          0          0          0   Performance monitoring
interrupts
PND:          0          0          0          0   Performance pending work
RES:        665        679        714        547   Rescheduling interrupts
CAL:       5332        408       5619        539   Function call interrupts
TLB:       1880       2843       1788       3202   TLB shootdowns
TRM:          0          0          0          0   Thermal event interrupts
THR:          0          0          0          0   Threshold APIC interrupts
MCE:          0          0          0          0   Machine check exceptions
MCP:          5          5          5          5   Machine check polls
ERR:          3
MIS:          0
root@Optiplex-780:/var/log/libvirt/qemu#

I search the similarly problems that sharing the irg  but never find a
answer , and now I have no idea.
How to solve the problem  ,can you help me ? thanks.

best regards,
qinguan


ÔÚ 2011Äê5Ô 4ÈÕ Ï Îç2:55£¬guan qin &lt;qinguan0619@gmail.com&gt;Ð´µÀ£º

&gt; sorry for missing some information.
&gt; I checkd the device that :
&gt; # readlink /sys/bus/pci/devices/0000\:00\:19.0/driver
&gt; ../../../bus/pci/drivers/pci-stub
&gt; 
&gt; the device has been already claimed by pci-stub and under the control of
&gt; pci_stub.
&gt; so the reason that can't up the eth in VM maybe has nothing to do with the
&gt; libvirt version.
&gt; 
&gt; After doing the first three \
&gt; steps:How_to_assign_devices_with_VT-d_in_KVM&lt;http://www.linux-kvm.org/page/How_to_assign_devices_with_VT-d_in_KVM&gt;
&gt;  (
&gt; *1. Modifying kernel config
&gt; **2. build kernel
&gt; **3. reboot and verify that your system has IOMMU support*
&gt; ),
&gt; I use "virsh create vt_d.xml" instead of the ubind/bind and assign device.
&gt; (the kvm and kvm_intel has already been loaded)
&gt; should I do something others to use the VT_d?
&gt; 
&gt; best regards,
&gt; qinguan
&gt; 
&gt; 
&gt; ÔÚ 2011Äê5Ô 4ÈÕ Ï Îç2:31£¬guan qin &lt;qinguan0619@gmail.com&gt;Ð´µÀ£º
&gt; 
&gt; Hi£¬the libvirt version is 0.8.3, I just used  "apt-get install libvirt-bin"
&gt; &gt; to install it under debian6.0.1a.
&gt; &gt; Is it  necessary to install 0.8.4 or higher version ?
&gt; &gt; 
&gt; &gt; Best regards,
&gt; &gt; qinguan
&gt; &gt; 
&gt; &gt; 
&gt; &gt; ÔÚ 2011Äê5Ô 3ÈÕ Ï Îç4:28£¬Osier Yang &lt;jyang@redhat.com&gt;Ð´µÀ£º
&gt; &gt; 
&gt; &gt; &gt; ÓÚ 2011Äê05Ô 03ÈÕ 15:38, guan qin Ð´µÀ:
&gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Thanks a lot for your reply sincerely!
&gt; &gt; &gt; &gt; Actually ,if I do as what
&gt; &gt; &gt; &gt; http://www.linux-kvm.org/page/How_to_assign_devices_with_VT-d_in_KVMsaid,:
&gt; &gt; &gt; &gt; "
&gt; &gt; &gt; &gt; # echo "8086 10b9" &gt; /sys/bus/pci/drivers/pci-stub/new_id
&gt; &gt; &gt; &gt; # echo 0000:01:00.0 &gt; /sys/bus/pci/devices/0000:01:00.0/driver/unbind
&gt; &gt; &gt; &gt; # echo 0000:01:00.0 &gt; /sys/bus/pci/drivers/pci-stub/bind
&gt; &gt; &gt; &gt; "
&gt; &gt; &gt; &gt; Then I can assign a NIC to the VM ,and the VM also can use the NIC to
&gt; &gt; &gt; &gt; access the network.
&gt; &gt; &gt; &gt; But , according the libvirt guide that
&gt; &gt; &gt; &gt; http://libvirt.org/formatdomain.html#elementsUSB shows:
&gt; &gt; &gt; &gt; "
&gt; &gt; &gt; &gt; When |managed| is "yes" for a PCI device, it is detached from the host
&gt; &gt; &gt; &gt; before being passed on to the guest.
&gt; &gt; &gt; &gt; "
&gt; &gt; &gt; &gt; So should I still "unbind " the device from the host OS driver first ?
&gt; &gt; &gt; &gt; If that ,What's the "detached" meaning ? thanks.
&gt; &gt; &gt; &gt; best regards,
&gt; &gt; &gt; &gt; qinguan
&gt; &gt; &gt; 
&gt; &gt; &gt; libvirt trys to detach the PCI device from host as preparation when
&gt; &gt; &gt; starting up the domain, and it also binds the device to pci_stub
&gt; &gt; &gt; driver, so it's strange that you need to do it manually? what's
&gt; &gt; &gt; your libvirt version?
&gt; &gt; &gt; 
&gt; &gt; &gt; &gt; ÔÚ 2011Äê5Ô 3ÈÕ ÉÏÎç8:47£¬David White &lt;dwhite@speakeasy.net
&gt; &gt; &gt; &gt; &lt;mailto:dwhite@speakeasy.net&gt;&gt;Ð´µÀ£º
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; did you 'unbind' the device from the host OS driver?
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; On 05/01/2011 01:38 AM, guan qin wrote:
&gt; &gt; &gt; &gt; &gt; Hi,
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; I encounter a problem that the eth can't be up in the VM by using
&gt; &gt; &gt; &gt; &gt; VT-d.
&gt; &gt; &gt; &gt; &gt; I boot the VM using "virsh create vt_d.xml".
&gt; &gt; &gt; &gt; &gt; The VM could recongize the NIC which was assigned .then I do in VM
&gt; &gt; &gt; &gt; &gt; as follows:
&gt; &gt; &gt; &gt; &gt; #cat /sys/class/net/eth0/operstate
&gt; &gt; &gt; &gt; &gt; down
&gt; &gt; &gt; &gt; &gt; #ifconfig eth0 up
&gt; &gt; &gt; &gt; &gt; #cat /sys/class/net/eth0/operstate
&gt; &gt; &gt; &gt; &gt; down
&gt; &gt; &gt; &gt; &gt; #ficonfig eth 10.100.0.5
&gt; &gt; &gt; &gt; &gt; #cat /sys/class/net/eth0/operstate
&gt; &gt; &gt; &gt; &gt; down
&gt; &gt; &gt; &gt; &gt; more system information is attached.(uname ¡¢ifconfig ¡¢lspci¡¢
&gt; &gt; &gt; &gt; &gt; cmdline...)
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; I can't figure out the reason why the eth is still down? can
&gt; &gt; &gt; &gt; &gt; anyone help me ?
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; best regards,
&gt; &gt; &gt; &gt; &gt; qinguan
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; vt_d.xml:
&gt; &gt; &gt; &gt; &gt; &lt;domain type='kvm'&gt;
&gt; &gt; &gt; &gt; &gt; &lt;name&gt;test&lt;/name&gt;
&gt; &gt; &gt; &gt; &gt; &lt;description&gt;just test using sriov!&lt;/description&gt;
&gt; &gt; &gt; &gt; &gt; &lt;os&gt;
&gt; &gt; &gt; &gt; &gt; &lt;type&gt;hvm&lt;/type&gt;
&gt; &gt; &gt; &gt; &gt; &lt;boot dev='hd'/&gt;
&gt; &gt; &gt; &gt; &gt; &lt;/os&gt;
&gt; &gt; &gt; &gt; &gt; &lt;memory&gt;524288&lt;/memory&gt;
&gt; &gt; &gt; &gt; &gt; &lt;currentMemory&gt;524288&lt;/currentMemory&gt;
&gt; &gt; &gt; &gt; &gt; &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
&gt; &gt; &gt; &gt; &gt; &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
&gt; &gt; &gt; &gt; &gt; &lt;on_crash&gt;restart&lt;/on_crash&gt;
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &lt;features&gt;&lt;pae/&gt;&lt;acpi/&gt;&lt;apic/&gt;&lt;/features&gt;
&gt; &gt; &gt; &gt; &gt; &lt;clock offset='utc'/&gt;
&gt; &gt; &gt; &gt; &gt; &lt;devices&gt;
&gt; &gt; &gt; &gt; &gt; &lt;input type='mouse' bus='usb'/&gt;
&gt; &gt; &gt; &gt; &gt; &lt;disk type='file' device='disk'&gt;
&gt; &gt; &gt; &gt; &gt; &lt;source file='/home/qinguan/exp/ubuntu_1.img'/&gt;
&gt; &gt; &gt; &gt; &gt; &lt;target dev='hda' bus='virtio'/&gt;
&gt; &gt; &gt; &gt; &gt; &lt;/disk&gt;
&gt; &gt; &gt; &gt; &gt; &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;
&gt; &gt; &gt; &gt; &gt; &lt;graphics type='vnc' port='-1'/&gt;
&gt; &gt; &gt; &gt; &gt; &lt;hostdev mode='subsystem' type='pci' managed='yes'&gt;
&gt; &gt; &gt; &gt; &gt; &lt;source&gt;
&gt; &gt; &gt; &gt; &gt; &lt;address bus='0x0' slot='0x19' function='0x0'/&gt;
&gt; &gt; &gt; &gt; &gt; &lt;/source&gt;
&gt; &gt; &gt; &gt; &gt; &lt;/hostdev&gt;
&gt; &gt; &gt; &gt; &gt; &lt;/devices&gt;
&gt; &gt; &gt; &gt; &gt; &lt;/domain&gt;
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; _______________________________________________
&gt; &gt; &gt; &gt; &gt; libvirt-users mailing list
&gt; &gt; &gt; &gt; &gt; libvirt-users@redhat.com  &lt;mailto:libvirt-users@redhat.com&gt;
&gt; &gt; &gt; &gt; &gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; _______________________________________________
&gt; &gt; &gt; &gt; libvirt-users mailing list
&gt; &gt; &gt; &gt; libvirt-users@redhat.com
&gt; &gt; &gt; &gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; 
&gt; 


[Attachment #3 (text/html)]

Hi ,&lt;br&gt; I look into the qemu log file ,find that :&lt;br&gt;&lt;br&gt;LC_ALL=C \
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin HOME=/ \
QEMU_AUDIO_DRV=none /usr/bin/kvm -S -M pc-0.12 -enable-kvm -m 512 -smp \
1,sockets=1,cores=1,threads=1 -name vt_d_5 -uuid 05f608a3-f64f-2418-a90a-d611982c8336 \
-nodefaults -chardev \
socket,id=monitor,path=/var/lib/libvirt/qemu/vt_d_5.monitor,server,nowait -mon \
chardev=monitor,mode=readline -rtc base=utc -boot c -drive \
file=/home/qinguan/exp/kvm_vtd/ubuntu_1.img,if=none,id=drive-virtio-disk0,boot=on,format=raw \
-device virtio-blk-pci,bus=pci.0,addr=0x3,drive=drive-virtio-disk0,id=virtio-disk0 \
-usb -device usb-mouse,id=input0 -vnc &lt;a href="http://127.0.0.1:0"&gt;127.0.0.1:0&lt;/a&gt; \
-vga cirrus -device pci-assign,host=00:19.0,id=hostdev0,bus=pci.0,addr=0x4 -device \
virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x5&lt;br&gt; Failed to assign irq for \
"hostdev0": Operation not permitted&lt;br&gt;Perhaps you are assigning a device \
that shares an IRQ with another device?&lt;br&gt;Failed to assign irq for \
"hostdev0": Operation not permitted&lt;br&gt; Perhaps you are assigning a device \
that shares an IRQ with another device?&lt;br&gt;Failed to assign irq for \
"hostdev0": Operation not permitted&lt;br&gt;Perhaps you are assigning a device \
that shares an IRQ with another device?&lt;br&gt; Failed to assign irq for \
"hostdev0": Operation not permitted&lt;br&gt;Perhaps you are assigning a device \
that shares an IRQ with another device?&lt;br&gt;Failed to assign irq for \
"hostdev0": Operation not permitted&lt;br&gt; &lt;br&gt;maybe the VM can't access \
to the network because of Failed  to assign irg for \
"hostdev0"?&lt;br&gt;&lt;br&gt;in kern.log :&lt;br&gt;May  1 12:40:07 Optiplex-780 \
kernel: [ 3172.784803] e1000e 0000:00:19.0: PCI INT A disabled&lt;br&gt; May  1 \
12:40:07 Optiplex-780 kernel: [ 3172.784863] pci-stub 0000:00:19.0: claimed by \
stub&lt;br&gt;May  1 12:40:07 Optiplex-780 kernel: [ 3173.103965] pci-stub \
0000:00:19.0: PCI INT A -&gt; GSI 21 (level, low) -&gt; IRQ 21&lt;br&gt; May  1 \
12:40:07 Optiplex-780 kernel: [ 3173.204030] pci-stub 0000:00:19.0: restoring config \
space at offset 0x6 (was 0x1, writing 0xece1)&lt;br&gt;May  1 12:40:07 Optiplex-780 \
kernel: [ 3173.204035] pci-stub 0000:00:19.0: restoring config space at offset 0x5 \
(was 0x0, writing 0xf7ad9000)&lt;br&gt; May  1 12:40:07 Optiplex-780 kernel: [ \
3173.204039] pci-stub 0000:00:19.0: restoring config space at offset 0x4 (was 0x0, \
writing 0xf7ae0000)&lt;br&gt;May  1 12:40:07 Optiplex-780 kernel: [ 3173.204045] \
pci-stub 0000:00:19.0: restoring config space at offset 0x1 (was 0x100000, writing \
0x100103)&lt;br&gt; May  1 12:40:07 Optiplex-780 kernel: [ 3173.435751] assign device \
0:0:19.0&lt;br&gt;May  1 12:44:24 Optiplex-780 kernel: [ 3430.568526] pci-stub \
0000:00:19.0: restoring config space at offset 0x6 (was 0x1, writing \
0xece1)&lt;br&gt;May  1 12:44:24 Optiplex-780 kernel: [ 3430.568532] pci-stub \
0000:00:19.0: restoring config space at offset 0x5 (was 0x0, writing 0xf7ad9000)&lt;br&gt; \
May  1 12:44:24 Optiplex-780 kernel: [ 3430.568537] pci-stub 0000:00:19.0: \
restoring config space at offset 0x4 (was 0x0, writing 0xf7ae0000)&lt;br&gt;May  1 \
12:44:24 Optiplex-780 kernel: [ 3430.568543] pci-stub 0000:00:19.0: restoring config \
space at offset 0x1 (was 0x100000, writing 0x100103)&lt;br&gt; May  1 12:44:24 \
Optiplex-780 kernel: [ 3430.568561] pci-stub 0000:00:19.0: PCI INT A \
disabled&lt;br&gt;&lt;br&gt;&lt;br&gt;root@Optiplex-780:/var/log/libvirt/qemu# cat \
/proc/interrupts&lt;br&gt;           \
CPU0       CPU1       \
CPU2       CPU3       \
&lt;br&gt;   0:         \
97          \
1          \
2          1   \
IO-APIC-edge      timer&lt;br&gt;  \
1:          \
2          \
0          \
0          0   \
IO-APIC-edge      i8042&lt;br&gt;  \
7:          \
0          \
0          \
0          0   \
IO-APIC-edge      parport0&lt;br&gt;   \
8:          \
1          \
0          \
0          0   \
IO-APIC-edge      rtc0&lt;br&gt;  \
9:          \
0          \
0          \
0          0   \
IO-APIC-fasteoi   \
acpi&lt;br&gt; 12:          \
1          \
2          \
1          0   \
IO-APIC-edge      i8042&lt;br&gt; \
 16:          \
0          \
0          \
0          0   \
IO-APIC-fasteoi   \
uhci_hcd:usb2&lt;br&gt; 17:       \
5822       1952       \
3614       2233   IO-APIC-fasteoi   \
uhci_hcd:usb4, uhci_hcd:usb7&lt;br&gt; 18:          \
0          \
0          \
0          0   \
IO-APIC-fasteoi   uhci_hcd:usb8&lt;br&gt; \
 22:          \
1          \
1          \
1          0   \
IO-APIC-fasteoi   ehci_hcd:usb1, \
uhci_hcd:usb5&lt;br&gt; 23:       \
1461       1299       \
1153        912   \
IO-APIC-fasteoi   ehci_hcd:usb3, \
uhci_hcd:usb6&lt;br&gt; 24:     \
268579          \
0          \
0          0  \
HPET_MSI-edge      hpet2&lt;br&gt; \
 25:          \
0     \
286310          \
0          0  \
HPET_MSI-edge      \
hpet3&lt;br&gt; 26:          \
0          0     \
210675          0  \
HPET_MSI-edge      \
hpet4&lt;br&gt; 27:          \
0          \
0          0     \
256688  HPET_MSI-edge      hpet5&lt;br&gt; \
 29:          \
1          \
0          \
0          0  \
DMAR_MSI-edge      \
dmar1&lt;br&gt; 30:          \
0          \
0          \
0          0  \
DMAR_MSI-edge      \
dmar0&lt;br&gt; 31:          \
0          \
0          \
0          0  \
DMAR_MSI-edge      dmar2&lt;br&gt; \
 35:          \
0          \
0          \
0          1   \
PCI-MSI-edge      \
eth1&lt;br&gt; 36:       \
1456        \
916       1323       \
1657   PCI-MSI-edge      \
eth1-rx-0&lt;br&gt; 37:       \
1031        \
772       \
1459        895   \
PCI-MSI-edge      eth1-rx-1&lt;br&gt; \
 38:        \
958        \
965        \
785        470   \
PCI-MSI-edge      \
eth1-rx-2&lt;br&gt; 39:       \
1319        \
557       \
1007        714   \
PCI-MSI-edge      \
eth1-rx-3&lt;br&gt; 40:        \
892        \
864        417       \
1134   PCI-MSI-edge      eth1-tx-0&lt;br&gt; \
 41:        \
414        \
749        \
998        606   \
PCI-MSI-edge      \
eth1-tx-1&lt;br&gt; 42:        \
307        \
921        \
375        332   \
PCI-MSI-edge      \
eth1-tx-2&lt;br&gt; 43:        \
966        \
693        \
396        502   \
PCI-MSI-edge      eth1-tx-3&lt;br&gt; \
 54:       \
7109       5755       \
5683       5609   \
PCI-MSI-edge      \
ahci&lt;br&gt; 55:         \
74        \
105         \
73         84   \
PCI-MSI-edge      \
hda_intel&lt;br&gt; 56:       \
1446        \
927       \
1108        870   \
PCI-MSI-edge      i915&lt;br&gt; \
NMI:          \
0          \
0          \
0          0   Non-maskable \
interrupts&lt;br&gt;LOC:        \
740        \
725        \
703        677   Local timer \
interrupts&lt;br&gt;SPU:          \
0          \
0          \
0          0   Spurious \
CAL:       \
5332        \
408       \
5619        539   Function call \
interrupts&lt;br&gt;TLB:       \
1880       2843       \
1788       3202   TLB \
shootdowns&lt;br&gt;TRM:          \
0          \
0          \
0          0   Thermal event \
interrupts&lt;br&gt; THR:          \
0          \
0          \
0          0   Threshold APIC \
interrupts&lt;br&gt;MCE:          \
0          \
0          \
0          0   Machine check \
exceptions&lt;br&gt;MCP:          \
5          \
5          \
5          5   Machine check \
polls&lt;br&gt; ERR:          \
3&lt;br&gt;MIS:          \
0&lt;br&gt;root@Optiplex-780:/var/log/libvirt/qemu# &lt;br&gt;&lt;br&gt;I search the similarly problems \
that sharing the irg  but never find a answer , and now I have no idea.&lt;br&gt;How \
to solve the problem  ,can you help me ? thanks.&lt;br&gt; &lt;br&gt;best \
regards,&lt;br&gt;qinguan&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;ÔÚ 2011Äê5Ô 4ÈÕ Ï \
Îç2:55£¬guan qin &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:qinguan0619@gmail.com"&gt;qinguan0619@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;Ð´µÀ£º&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt; sorry for missing some information.&lt;br&gt;I checkd the device \
that :&lt;br&gt;# readlink \
/sys/bus/pci/devices/0000\:00\:19.0/driver&lt;br&gt;../../../bus/pci/drivers/pci-stub&lt;br&gt;&lt;br&gt;the \
device has been already claimed by pci-stub and under the control of pci_stub.&lt;br&gt;

so the reason that can't up the eth in VM maybe has nothing to do with the \
libvirt version.&lt;br&gt;&lt;br&gt;After doing the first three steps:&lt;a \
href="http://www.linux-kvm.org/page/How_to_assign_devices_with_VT-d_in_KVM" \
target="_blank"&gt;How_to_assign_devices_with_VT-d_in_KVM&lt;/a&gt;&lt;br&gt;

(&lt;br&gt;&lt;b&gt;1. Modifying kernel config&lt;br&gt;&lt;/b&gt;&lt;b&gt;2. build kernel&lt;br&gt;&lt;/b&gt;&lt;b&gt;3. reboot and \
verify that your system has IOMMU support&lt;/b&gt;&lt;br&gt;),&lt;br&gt;I use "virsh create \
vt_d.xml" instead of the ubind/bind and assign device.&lt;br&gt;

(the kvm and kvm_intel has already been loaded)&lt;br&gt;should I do something others to \
use the VT_d?&lt;br&gt;&lt;br&gt;best regards,&lt;br&gt;qinguan&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;ÔÚ \
2011Äê5Ô 4ÈÕ Ï Îç2:31£¬guan qin &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:qinguan0619@gmail.com" \
target="_blank"&gt;qinguan0619@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;Ð´µÀ£º&lt;div&gt; &lt;div&gt;&lt;/div&gt;&lt;div \
class="h5"&gt;&lt;br&gt; &lt;blockquote class="gmail_quote" style="margin:0 0 0 \
.8ex;border-left:1px #ccc solid;padding-left:1ex"&gt;Hi£¬the libvirt version is 0.8.3, I \
just used  "apt-get install libvirt-bin" to install it under \
debian6.0.1a.&lt;br&gt;

Is it  necessary to install 0.8.4 or higher version ?&lt;br&gt;&lt;br&gt;Best \
regards,&lt;br&gt;qinguan&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div&gt; ÔÚ 2011Äê5Ô 3ÈÕ Ï \
Îç4:28£¬Osier Yang &lt;span dir="ltr"&gt;&lt;&lt;a href="mailto:jyang@redhat.com" \
target="_blank"&gt;jyang@redhat.com&lt;/a&gt;&gt;&lt;/span&gt;Ð´µÀ£º&lt;br&gt;&lt;/div&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex"&gt;


ÓÚ 2011Äê05Ô 03ÈÕ 15:38, guan qin Ð´µÀ:&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;
&lt;div&gt;&gt; Thanks a lot for your reply sincerely!&lt;br&gt;
&gt; Actually ,if I do as what&lt;br&gt;
&gt; &lt;a href="http://www.linux-kvm.org/page/How_to_assign_devices_with_VT-d_in_KVM" \
target="_blank"&gt;http://www.linux-kvm.org/page/How_to_assign_devices_with_VT-d_in_KVM&lt;/a&gt; \
said,:&lt;br&gt; &gt; "&lt;br&gt;
&gt; # echo "8086 10b9" &gt; /sys/bus/pci/drivers/pci-stub/new_id&lt;br&gt;
&gt; # echo 0000:01:00.0 &gt; /sys/bus/pci/devices/0000:01:00.0/driver/unbind&lt;br&gt;
&gt; # echo 0000:01:00.0 &gt; /sys/bus/pci/drivers/pci-stub/bind&lt;br&gt;
&gt; "&lt;br&gt;
&gt; Then I can assign a NIC to the VM ,and the VM also can use the NIC to&lt;br&gt;
&gt; access the network.&lt;br&gt;
&gt; But , according the libvirt guide that&lt;br&gt;
&gt; &lt;a href="http://libvirt.org/formatdomain.html#elementsUSB" \
target="_blank"&gt;http://libvirt.org/formatdomain.html#elementsUSB&lt;/a&gt; shows:&lt;br&gt; &gt; \
"&lt;br&gt; &gt; When |managed| is "yes" for a PCI device, it is detached \
from the host&lt;br&gt; &gt; before being passed on to the guest.&lt;br&gt;
&gt; "&lt;br&gt;
&gt; So should I still "unbind " the device from the host OS driver first \
?&lt;br&gt; &gt; If that ,What's the "detached" meaning ? thanks.&lt;br&gt;
&gt; best regards,&lt;br&gt;
&gt; qinguan&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;libvirt trys to detach the PCI device from host as preparation when&lt;br&gt;
starting up the domain, and it also binds the device to pci_stub&lt;br&gt;
driver, so it's strange that you need to do it manually? what's&lt;br&gt;
your libvirt version?&lt;br&gt;
&lt;div&gt;&lt;br&gt;
&gt; ÔÚ 2011Äê5Ô 3ÈÕ ÉÏÎç8:47£¬David White &lt;&lt;a href="mailto:dwhite@speakeasy.net" \
target="_blank"&gt;dwhite@speakeasy.net&lt;/a&gt;&lt;br&gt; &lt;/div&gt;&gt; &lt;mailto:&lt;a \
href="mailto:dwhite@speakeasy.net" \
target="_blank"&gt;dwhite@speakeasy.net&lt;/a&gt;&gt;&gt;Ð´µÀ£º&lt;br&gt; \
&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&gt;&lt;br&gt; &gt;&lt;br&gt;
&gt;     did you 'unbind' the device from the host OS driver?&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt;     On 05/01/2011 01:38 AM, guan qin wrote:&lt;br&gt;
&gt;&gt;     Hi,&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;     I encounter a problem that the eth can't be up in the VM \
by using&lt;br&gt; &gt;&gt;     VT-d.&lt;br&gt;
&gt;&gt;     I boot the VM using "virsh create vt_d.xml".&lt;br&gt;
&gt;&gt;     The VM could recongize the NIC which was assigned .then I do \
in VM&lt;br&gt; &gt;&gt;     as follows:&lt;br&gt;
&gt;&gt;     #cat /sys/class/net/eth0/operstate&lt;br&gt;
&gt;&gt;     down&lt;br&gt;
&gt;&gt;     #ifconfig eth0 up&lt;br&gt;
&gt;&gt;     #cat /sys/class/net/eth0/operstate&lt;br&gt;
&gt;&gt;     down&lt;br&gt;
&gt;&gt;     #ficonfig eth 10.100.0.5&lt;br&gt;
&gt;&gt;     #cat /sys/class/net/eth0/operstate&lt;br&gt;
&gt;&gt;     down&lt;br&gt;
&gt;&gt;     more system information is attached.(uname ¡¢ifconfig \
¡¢lspci¡¢&lt;br&gt; &gt;&gt;     cmdline...)&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;     I can't figure out the reason why the eth is still down? \
can&lt;br&gt; &gt;&gt;     anyone help me ?&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;     best regards,&lt;br&gt;
&gt;&gt;     qinguan&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;     vt_d.xml:&lt;br&gt;
&gt;&gt;     &lt;domain type='kvm'&gt;&lt;br&gt;
&gt;&gt;     &lt;name&gt;test&lt;/name&gt;&lt;br&gt;
&gt;&gt;     &lt;description&gt;just test using \
sriov!&lt;/description&gt;&lt;br&gt; &gt;&gt;     &lt;os&gt;&lt;br&gt;
&gt;&gt;     &lt;type&gt;hvm&lt;/type&gt;&lt;br&gt;
&gt;&gt;     &lt;boot dev='hd'/&gt;&lt;br&gt;
&gt;&gt;     &lt;/os&gt;&lt;br&gt;
&gt;&gt;     &lt;memory&gt;524288&lt;/memory&gt;&lt;br&gt;
&gt;&gt;     &lt;currentMemory&gt;524288&lt;/currentMemory&gt;&lt;br&gt;
&gt;&gt;     &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;&lt;br&gt;
&gt;&gt;     &lt;on_reboot&gt;restart&lt;/on_reboot&gt;&lt;br&gt;
&gt;&gt;     &lt;on_crash&gt;restart&lt;/on_crash&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;     \
&lt;features&gt;&lt;pae/&gt;&lt;acpi/&gt;&lt;apic/&gt;&lt;/features&gt;&lt;br&gt; &gt;&gt; \
    &lt;clock offset='utc'/&gt;&lt;br&gt; &gt;&gt;     \
&lt;devices&gt;&lt;br&gt; &gt;&gt;     &lt;input type='mouse' \
bus='usb'/&gt;&lt;br&gt; &gt;&gt;     &lt;disk type='file' \
device='disk'&gt;&lt;br&gt; &gt;&gt;     &lt;source \
file='/home/qinguan/exp/ubuntu_1.img'/&gt;&lt;br&gt; &gt;&gt;     \
&lt;target dev='hda' bus='virtio'/&gt;&lt;br&gt; &gt;&gt;     \
&lt;/disk&gt;&lt;br&gt; &gt;&gt;     \
&lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;&lt;br&gt; &gt;&gt;     &lt;graphics \
type='vnc' port='-1'/&gt;&lt;br&gt; &gt;&gt;     &lt;hostdev \
mode='subsystem' type='pci' managed='yes'&gt;&lt;br&gt; &gt;&gt; \
    &lt;source&gt;&lt;br&gt; &gt;&gt;     &lt;address bus='0x0' \
slot='0x19' function='0x0'/&gt;&lt;br&gt; &gt;&gt;     \
&lt;/source&gt;&lt;br&gt; &gt;&gt;     &lt;/hostdev&gt;&lt;br&gt;
&gt;&gt;     &lt;/devices&gt;&lt;br&gt;
&gt;&gt;     &lt;/domain&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;     _______________________________________________&lt;br&gt;
&gt;&gt;     libvirt-users mailing list&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;&gt;&gt;     &lt;a href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;  &lt;mailto:&lt;a \
href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;&gt;&lt;br&gt; &lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&gt;&gt; \
    &lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; \
&gt;&lt;br&gt; &gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt; _______________________________________________&lt;br&gt;
&gt; libvirt-users mailing list&lt;br&gt;
&gt; &lt;a href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt; &gt; &lt;a \
href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; &lt;br&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110530090535</emailId><senderName></senderName><senderEmail>arun.sasi1@wipro.com</senderEmail><timestampReceived>2011-05-30 09:05:35-0400</timestampReceived><subject>Re: [libvirt-users] [Qemu-devel] Qcow2</subject><body>

Hello Stefan,

I can see some error messages 

May 30 11:36:49 sd0005srv01 libvirtd: 11:36:49.044: error : internal
error Timed out while reading console log output
May 30 11:36:49 sd0005srv01 libvirtd: 11:36:49.044: error : internal
error unable to start guest:

I am using ubuntu 9.04

Thanks,
-Arun

-----Original Message-----
From: Stefan Hajnoczi [mailto:stefanha@gmail.com] 
Sent: Friday, May 20, 2011 12:35 AM
To: Arun Sasi V (WI01 - Manage IT)
Cc: stefanha@linux.vnet.ibm.com; qemu-devel@nongnu.org;
libvirt-users@redhat.com
Subject: Re: [Qemu-devel] Qcow2

On Thu, May 19, 2011 at 3:24 PM,  &lt;arun.sasi1@wipro.com&gt; wrote:
&gt; I couldn't find any error when I do consistency check on the image
file...

Good, so there are no problems with your data.

&gt; What can be the reason for not starting the VM.

Did you find any more error messages besides the sound related errors
in /var/log/libvirt/qemu/&lt;domain&gt;.log?

&gt; Here I am suspecting when the base server go for reboot lesser image
will start and it cached and larger image will take more time to create
the cache...
&gt;
&gt; Was this correct... if yes could you please help me how to increase
the caching...

No, there is no "cache creation".  There is no startup delay for qcow2
image files.

Stefan

</body></email><email><emailId>20110607172224</emailId><senderName></senderName><senderEmail>arun.sasi1@wipro.com</senderEmail><timestampReceived>2011-06-07 17:22:24-0400</timestampReceived><subject>Re: [libvirt-users] [Qemu-devel] Qcow2</subject><body>

Hello Stephen,

Any update on this... what could be the reason... If I am not able to
start VM and if I add two virtual hard disk and one virtual hard disk is
more than 500GB.

Virtual harddisk type is virtio. Created by using qcow2

Thanks,
-Arun

-----Original Message-----
From: Arun Sasi V (WI01 - Manage IT) 
Sent: Monday, May 30, 2011 3:02 PM
To: 'Stefan Hajnoczi'
Cc: 'stefanha@linux.vnet.ibm.com'; 'qemu-devel@nongnu.org';
'libvirt-users@redhat.com'
Subject: RE: [Qemu-devel] Qcow2

Hello Team,

Please help me to solve this...

Find the below error 

May 30 12:21:29 sd0005srv01 kernel: [19836592.317217] device vnet0
entered promiscuous mode
May 30 12:21:29 sd0005srv01 kernel: [19836592.319449] br0: port 2(vnet0)
entering learning state
May 30 12:21:29 sd0005srv01 nm-system-settings:    SCPlugin-Ifupdown:
device added (udi: /org/freedesktop/Hal/devices/net_ce_1b_36_05_70_14,
iface: vnet0): not well known
May 30 12:21:30 sd0005srv01 avahi-daemon[3449]: Registering new address
record for fe80::cc1b:36ff:fe05:7014 on vnet0.*.
May 30 12:21:33 sd0005srv01 nm-system-settings: Added default wired
connection 'Auto vnet0' for
/org/freedesktop/Hal/devices/net_ce_1b_36_05_70_14
May 30 12:21:38 sd0005srv01 kernel: [19836601.316008] br0: topology
change detected, propagating
May 30 12:21:38 sd0005srv01 kernel: [19836601.316014] br0: port 2(vnet0)
entering forwarding state
May 30 12:21:39 sd0005srv01 kernel: [19836602.949751] vnet0: no IPv6
routers present
May 30 12:21:59 sd0005srv01 libvirtd: 12:21:59.278: error : internal
error Timed out while reading console log output
May 30 12:21:59 sd0005srv01 libvirtd: 12:21:59.278: error : internal
error unable to start guest:
May 30 12:21:59 sd0005srv01 avahi-daemon[3449]: Withdrawing address
record for fe80::cc1b:36ff:fe05:7014 on vnet0.
May 30 12:21:59 sd0005srv01 kernel: [19836622.479659] br0: port 2(vnet0)
entering disabled state
May 30 12:21:59 sd0005srv01 kernel: [19836622.493771] device vnet0 left
promiscuous mode
May 30 12:21:59 sd0005srv01 kernel: [19836622.493773] br0: port 2(vnet0)
entering disabled state
May 30 12:21:59 sd0005srv01 nm-system-settings:    SCPlugin-Ifupdown:
devices removed (udi: /org/freedesktop/Hal/



Thanks,
-Arun


-----Original Message-----
From: Arun Sasi V (WI01 - Manage IT) 
Sent: Monday, May 30, 2011 2:24 PM
To: 'Stefan Hajnoczi'
Cc: 'stefanha@linux.vnet.ibm.com'; 'qemu-devel@nongnu.org';
'libvirt-users@redhat.com'
Subject: RE: [Qemu-devel] Qcow2

Hello Stefan,

I can see some error messages 

May 30 11:36:49 sd0005srv01 libvirtd: 11:36:49.044: error : internal
error Timed out while reading console log output
May 30 11:36:49 sd0005srv01 libvirtd: 11:36:49.044: error : internal
error unable to start guest:

I am using ubuntu 9.04

Thanks,
-Arun

-----Original Message-----
From: Stefan Hajnoczi [mailto:stefanha@gmail.com] 
Sent: Friday, May 20, 2011 12:35 AM
To: Arun Sasi V (WI01 - Manage IT)
Cc: stefanha@linux.vnet.ibm.com; qemu-devel@nongnu.org;
libvirt-users@redhat.com
Subject: Re: [Qemu-devel] Qcow2

On Thu, May 19, 2011 at 3:24 PM,  &lt;arun.sasi1@wipro.com&gt; wrote:
&gt; I couldn't find any error when I do consistency check on the image
file...

Good, so there are no problems with your data.

&gt; What can be the reason for not starting the VM.

Did you find any more error messages besides the sound related errors
in /var/log/libvirt/qemu/&lt;domain&gt;.log?

&gt; Here I am suspecting when the base server go for reboot lesser image
will start and it cached and larger image will take more time to create
the cache...
&gt;
&gt; Was this correct... if yes could you please help me how to increase
the caching...

No, there is no "cache creation".  There is no startup delay for qcow2
image files.

Stefan

</body></email><email><emailId>20110608081915</emailId><senderName>Stefan Hajnoczi</senderName><senderEmail>stefanha@gmail.com</senderEmail><timestampReceived>2011-06-08 08:19:15-0400</timestampReceived><subject>Re: [libvirt-users] [Qemu-devel] Qcow2</subject><body>

On Tue, Jun 7, 2011 at 6:10 PM,  &lt;arun.sasi1@wipro.com&gt; wrote:
&gt; Any update on this... what could be the reason... If I am not able to
&gt; start VM and if I add two virtual hard disk and one virtual hard disk is
&gt; more than 500GB.
&gt;
&gt; Virtual harddisk type is virtio. Created by using qcow2

Sorry, nothing obvious from your error output.  I recommend running a
recent distro.

Stefan

</body></email><email><emailId>20110504085623</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-05-04 08:56:23-0400</timestampReceived><subject>Re: [libvirt-users] can't up the eth in the vm and access to network</subject><body>

ÓÚ 2011Äê05Ô 04ÈÕ 16:17, guan qin Ð´µÀ:
&gt; Hi ,
&gt; I look into the qemu log file ,find that :
&gt; 
&gt; LC_ALL=C 
&gt; PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin HOME=/ 
&gt; QEMU_AUDIO_DRV=none /usr/bin/kvm -S -M pc-0.12 -enable-kvm -m 512 -smp 
&gt; 1,sockets=1,cores=1,threads=1 -name vt_d_5 -uuid 
&gt; 05f608a3-f64f-2418-a90a-d611982c8336 -nodefaults -chardev 
&gt; socket,id=monitor,path=/var/lib/libvirt/qemu/vt_d_5.monitor,server,nowait -mon 
&gt; chardev=monitor,mode=readline -rtc base=utc -boot c -drive 
&gt; file=/home/qinguan/exp/kvm_vtd/ubuntu_1.img,if=none,id=drive-virtio-disk0,boot=on,format=raw 
&gt; -device 
&gt; virtio-blk-pci,bus=pci.0,addr=0x3,drive=drive-virtio-disk0,id=virtio-disk0 
&gt; -usb -device usb-mouse,id=input0 -vnc 127.0.0.1:0 &lt;http://127.0.0.1:0&gt; 
&gt; -vga cirrus -device 
&gt; pci-assign,host=00:19.0,id=hostdev0,bus=pci.0,addr=0x4 -device 
&gt; virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x5
&gt; Failed to assign irq for "hostdev0": Operation not permitted
&gt; Perhaps you are assigning a device that shares an IRQ with another device?
&gt; Failed to assign irq for "hostdev0": Operation not permitted
&gt; Perhaps you are assigning a device that shares an IRQ with another device?
&gt; Failed to assign irq for "hostdev0": Operation not permitted
&gt; Perhaps you are assigning a device that shares an IRQ with another device?
&gt; Failed to assign irq for "hostdev0": Operation not permitted
&gt; Perhaps you are assigning a device that shares an IRQ with another device?
&gt; Failed to assign irq for "hostdev0": Operation not permitted

Perhaps you need to ask in qemu-devel list for help. :)

Regards
Osier
&gt; 
&gt; maybe the VM can't access to the network because of Failed to assign irg 
&gt; for "hostdev0"?
&gt; 
&gt; in kern.log :
&gt; May 1 12:40:07 Optiplex-780 kernel: [ 3172.784803] e1000e 0000:00:19.0: 
&gt; PCI INT A disabled
&gt; May 1 12:40:07 Optiplex-780 kernel: [ 3172.784863] pci-stub 
&gt; 0000:00:19.0: claimed by stub
&gt; May 1 12:40:07 Optiplex-780 kernel: [ 3173.103965] pci-stub 
&gt; 0000:00:19.0: PCI INT A -&gt; GSI 21 (level, low) -&gt; IRQ 21
&gt; May 1 12:40:07 Optiplex-780 kernel: [ 3173.204030] pci-stub 
&gt; 0000:00:19.0: restoring config space at offset 0x6 (was 0x1, writing 0xece1)
&gt; May 1 12:40:07 Optiplex-780 kernel: [ 3173.204035] pci-stub 
&gt; 0000:00:19.0: restoring config space at offset 0x5 (was 0x0, writing 
&gt; 0xf7ad9000)
&gt; May 1 12:40:07 Optiplex-780 kernel: [ 3173.204039] pci-stub 
&gt; 0000:00:19.0: restoring config space at offset 0x4 (was 0x0, writing 
&gt; 0xf7ae0000)
&gt; May 1 12:40:07 Optiplex-780 kernel: [ 3173.204045] pci-stub 
&gt; 0000:00:19.0: restoring config space at offset 0x1 (was 0x100000, 
&gt; writing 0x100103)
&gt; May 1 12:40:07 Optiplex-780 kernel: [ 3173.435751] assign device 0:0:19.0
&gt; May 1 12:44:24 Optiplex-780 kernel: [ 3430.568526] pci-stub 
&gt; 0000:00:19.0: restoring config space at offset 0x6 (was 0x1, writing 0xece1)
&gt; May 1 12:44:24 Optiplex-780 kernel: [ 3430.568532] pci-stub 
&gt; 0000:00:19.0: restoring config space at offset 0x5 (was 0x0, writing 
&gt; 0xf7ad9000)
&gt; May 1 12:44:24 Optiplex-780 kernel: [ 3430.568537] pci-stub 
&gt; 0000:00:19.0: restoring config space at offset 0x4 (was 0x0, writing 
&gt; 0xf7ae0000)
&gt; May 1 12:44:24 Optiplex-780 kernel: [ 3430.568543] pci-stub 
&gt; 0000:00:19.0: restoring config space at offset 0x1 (was 0x100000, 
&gt; writing 0x100103)
&gt; May 1 12:44:24 Optiplex-780 kernel: [ 3430.568561] pci-stub 
&gt; 0000:00:19.0: PCI INT A disabled
&gt; 
&gt; 
&gt; root@Optiplex-780:/var/log/libvirt/qemu# cat /proc/interrupts
&gt; CPU0 CPU1 CPU2 CPU3
&gt; 0: 97 1 2 1 IO-APIC-edge timer
&gt; 1: 2 0 0 0 IO-APIC-edge i8042
&gt; 7: 0 0 0 0 IO-APIC-edge parport0
&gt; 8: 1 0 0 0 IO-APIC-edge rtc0
&gt; 9: 0 0 0 0 IO-APIC-fasteoi acpi
&gt; 12: 1 2 1 0 IO-APIC-edge i8042
&gt; 16: 0 0 0 0 IO-APIC-fasteoi uhci_hcd:usb2
&gt; 17: 5822 1952 3614 2233 IO-APIC-fasteoi uhci_hcd:usb4, uhci_hcd:usb7
&gt; 18: 0 0 0 0 IO-APIC-fasteoi uhci_hcd:usb8
&gt; 22: 1 1 1 0 IO-APIC-fasteoi ehci_hcd:usb1, uhci_hcd:usb5
&gt; 23: 1461 1299 1153 912 IO-APIC-fasteoi ehci_hcd:usb3, uhci_hcd:usb6
&gt; 24: 268579 0 0 0 HPET_MSI-edge hpet2
&gt; 25: 0 286310 0 0 HPET_MSI-edge hpet3
&gt; 26: 0 0 210675 0 HPET_MSI-edge hpet4
&gt; 27: 0 0 0 256688 HPET_MSI-edge hpet5
&gt; 29: 1 0 0 0 DMAR_MSI-edge dmar1
&gt; 30: 0 0 0 0 DMAR_MSI-edge dmar0
&gt; 31: 0 0 0 0 DMAR_MSI-edge dmar2
&gt; 35: 0 0 0 1 PCI-MSI-edge eth1
&gt; 36: 1456 916 1323 1657 PCI-MSI-edge eth1-rx-0
&gt; 37: 1031 772 1459 895 PCI-MSI-edge eth1-rx-1
&gt; 38: 958 965 785 470 PCI-MSI-edge eth1-rx-2
&gt; 39: 1319 557 1007 714 PCI-MSI-edge eth1-rx-3
&gt; 40: 892 864 417 1134 PCI-MSI-edge eth1-tx-0
&gt; 41: 414 749 998 606 PCI-MSI-edge eth1-tx-1
&gt; 42: 307 921 375 332 PCI-MSI-edge eth1-tx-2
&gt; 43: 966 693 396 502 PCI-MSI-edge eth1-tx-3
&gt; 54: 7109 5755 5683 5609 PCI-MSI-edge ahci
&gt; 55: 74 105 73 84 PCI-MSI-edge hda_intel
&gt; 56: 1446 927 1108 870 PCI-MSI-edge i915
&gt; NMI: 0 0 0 0 Non-maskable interrupts
&gt; LOC: 740 725 703 677 Local timer interrupts
&gt; SPU: 0 0 0 0 Spurious interrupts
&gt; PMI: 0 0 0 0 Performance monitoring interrupts
&gt; PND: 0 0 0 0 Performance pending work
&gt; RES: 665 679 714 547 Rescheduling interrupts
&gt; CAL: 5332 408 5619 539 Function call interrupts
&gt; TLB: 1880 2843 1788 3202 TLB shootdowns
&gt; TRM: 0 0 0 0 Thermal event interrupts
&gt; THR: 0 0 0 0 Threshold APIC interrupts
&gt; MCE: 0 0 0 0 Machine check exceptions
&gt; MCP: 5 5 5 5 Machine check polls
&gt; ERR: 3
&gt; MIS: 0
&gt; root@Optiplex-780:/var/log/libvirt/qemu#
&gt; 
&gt; I search the similarly problems that sharing the irg but never find a 
&gt; answer , and now I have no idea.
&gt; How to solve the problem ,can you help me ? thanks.
&gt; 
&gt; best regards,
&gt; qinguan
&gt; 
&gt; 
&gt; ÔÚ 2011Äê5Ô 4ÈÕ Ï Îç2:55£¬guan qin &lt;qinguan0619@gmail.com 
&gt; &lt;mailto:qinguan0619@gmail.com&gt;&gt;Ð´µÀ£º
&gt; 
&gt;     sorry for missing some information.
&gt;     I checkd the device that :
&gt;     # readlink /sys/bus/pci/devices/0000\:00\:19.0/driver
&gt;     ../../../bus/pci/drivers/pci-stub
&gt; 
&gt;     the device has been already claimed by pci-stub and under the
&gt;     control of pci_stub.
&gt;     so the reason that can't up the eth in VM maybe has nothing to do
&gt;     with the libvirt version.
&gt; 
&gt;     After doing the first three
&gt;     steps:How_to_assign_devices_with_VT-d_in_KVM
&gt;     &lt;http://www.linux-kvm.org/page/How_to_assign_devices_with_VT-d_in_KVM&gt;
&gt;     (
&gt;     *1. Modifying kernel config
&gt;     **2. build kernel
&gt;     **3. reboot and verify that your system has IOMMU support*
&gt;     ),
&gt;     I use "virsh create vt_d.xml" instead of the ubind/bind and assign
&gt;     device.
&gt;     (the kvm and kvm_intel has already been loaded)
&gt;     should I do something others to use the VT_d?
&gt; 
&gt;     best regards,
&gt;     qinguan
&gt; 
&gt; 
&gt;     ÔÚ 2011Äê5Ô 4ÈÕ Ï Îç2:31£¬guan qin &lt;qinguan0619@gmail.com
&gt;     &lt;mailto:qinguan0619@gmail.com&gt;&gt;Ð´µÀ£º
&gt; 
&gt;         Hi£¬the libvirt version is 0.8.3, I just used "apt-get install
&gt;         libvirt-bin" to install it under debian6.0.1a.
&gt;         Is it necessary to install 0.8.4 or higher version ?
&gt; 
&gt;         Best regards,
&gt;         qinguan
&gt; 
&gt; 
&gt;         ÔÚ 2011Äê5Ô 3ÈÕ Ï Îç4:28£¬Osier Yang &lt;jyang@redhat.com
&gt;         &lt;mailto:jyang@redhat.com&gt;&gt;Ð´µÀ£º
&gt; 
&gt;             ÓÚ 2011Äê05Ô 03ÈÕ 15:38, guan qin Ð´µÀ:
&gt; 
&gt;              &gt; Thanks a lot for your reply sincerely!
&gt;              &gt; Actually ,if I do as what
&gt;              &gt;
&gt;             http://www.linux-kvm.org/page/How_to_assign_devices_with_VT-d_in_KVM
&gt;             said,:
&gt;              &gt; "
&gt;              &gt; # echo "8086 10b9" &gt; /sys/bus/pci/drivers/pci-stub/new_id
&gt;              &gt; # echo 0000:01:00.0 &gt;
&gt;             /sys/bus/pci/devices/0000:01:00.0/driver/unbind
&gt;              &gt; # echo 0000:01:00.0 &gt; /sys/bus/pci/drivers/pci-stub/bind
&gt;              &gt; "
&gt;              &gt; Then I can assign a NIC to the VM ,and the VM also can
&gt;             use the NIC to
&gt;              &gt; access the network.
&gt;              &gt; But , according the libvirt guide that
&gt;              &gt; http://libvirt.org/formatdomain.html#elementsUSB shows:
&gt;              &gt; "
&gt;              &gt; When |managed| is "yes" for a PCI device, it is detached
&gt;             from the host
&gt;              &gt; before being passed on to the guest.
&gt;              &gt; "
&gt;              &gt; So should I still "unbind " the device from the host OS
&gt;             driver first ?
&gt;              &gt; If that ,What's the "detached" meaning ? thanks.
&gt;              &gt; best regards,
&gt;              &gt; qinguan
&gt; 
&gt;             libvirt trys to detach the PCI device from host as
&gt;             preparation when
&gt;             starting up the domain, and it also binds the device to pci_stub
&gt;             driver, so it's strange that you need to do it manually? what's
&gt;             your libvirt version?
&gt; 
&gt;              &gt; ÔÚ 2011Äê5Ô 3ÈÕ ÉÏÎç8:47£¬David White
&gt;             &lt;dwhite@speakeasy.net &lt;mailto:dwhite@speakeasy.net&gt;
&gt;              &gt; &lt;mailto:dwhite@speakeasy.net
&gt;             &lt;mailto:dwhite@speakeasy.net&gt;&gt;&gt;Ð´µÀ£º
&gt;              &gt;
&gt;              &gt;
&gt;              &gt; did you 'unbind' the device from the host OS driver?
&gt;              &gt;
&gt;              &gt;
&gt;              &gt; On 05/01/2011 01:38 AM, guan qin wrote:
&gt;              &gt;&gt; Hi,
&gt;              &gt;&gt;
&gt;              &gt;&gt; I encounter a problem that the eth can't be up in the VM
&gt;             by using
&gt;              &gt;&gt; VT-d.
&gt;              &gt;&gt; I boot the VM using "virsh create vt_d.xml".
&gt;              &gt;&gt; The VM could recongize the NIC which was assigned .then
&gt;             I do in VM
&gt;              &gt;&gt; as follows:
&gt;              &gt;&gt; #cat /sys/class/net/eth0/operstate
&gt;              &gt;&gt; down
&gt;              &gt;&gt; #ifconfig eth0 up
&gt;              &gt;&gt; #cat /sys/class/net/eth0/operstate
&gt;              &gt;&gt; down
&gt;              &gt;&gt; #ficonfig eth 10.100.0.5
&gt;              &gt;&gt; #cat /sys/class/net/eth0/operstate
&gt;              &gt;&gt; down
&gt;              &gt;&gt; more system information is attached.(uname ¡¢ifconfig ¡¢
&gt;             lspci¡¢
&gt;              &gt;&gt; cmdline...)
&gt;              &gt;&gt;
&gt;              &gt;&gt; I can't figure out the reason why the eth is still down? can
&gt;              &gt;&gt; anyone help me ?
&gt;              &gt;&gt;
&gt;              &gt;&gt; best regards,
&gt;              &gt;&gt; qinguan
&gt;              &gt;&gt;
&gt;              &gt;&gt;
&gt;              &gt;&gt;
&gt;              &gt;&gt; vt_d.xml:
&gt;              &gt;&gt; &lt;domain type='kvm'&gt;
&gt;              &gt;&gt; &lt;name&gt;test&lt;/name&gt;
&gt;              &gt;&gt; &lt;description&gt;just test using sriov!&lt;/description&gt;
&gt;              &gt;&gt; &lt;os&gt;
&gt;              &gt;&gt; &lt;type&gt;hvm&lt;/type&gt;
&gt;              &gt;&gt; &lt;boot dev='hd'/&gt;
&gt;              &gt;&gt; &lt;/os&gt;
&gt;              &gt;&gt; &lt;memory&gt;524288&lt;/memory&gt;
&gt;              &gt;&gt; &lt;currentMemory&gt;524288&lt;/currentMemory&gt;
&gt;              &gt;&gt; &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
&gt;              &gt;&gt; &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
&gt;              &gt;&gt; &lt;on_crash&gt;restart&lt;/on_crash&gt;
&gt;              &gt;&gt;
&gt;              &gt;&gt; &lt;features&gt;&lt;pae/&gt;&lt;acpi/&gt;&lt;apic/&gt;&lt;/features&gt;
&gt;              &gt;&gt; &lt;clock offset='utc'/&gt;
&gt;              &gt;&gt; &lt;devices&gt;
&gt;              &gt;&gt; &lt;input type='mouse' bus='usb'/&gt;
&gt;              &gt;&gt; &lt;disk type='file' device='disk'&gt;
&gt;              &gt;&gt; &lt;source file='/home/qinguan/exp/ubuntu_1.img'/&gt;
&gt;              &gt;&gt; &lt;target dev='hda' bus='virtio'/&gt;
&gt;              &gt;&gt; &lt;/disk&gt;
&gt;              &gt;&gt; &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;
&gt;              &gt;&gt; &lt;graphics type='vnc' port='-1'/&gt;
&gt;              &gt;&gt; &lt;hostdev mode='subsystem' type='pci' managed='yes'&gt;
&gt;              &gt;&gt; &lt;source&gt;
&gt;              &gt;&gt; &lt;address bus='0x0' slot='0x19' function='0x0'/&gt;
&gt;              &gt;&gt; &lt;/source&gt;
&gt;              &gt;&gt; &lt;/hostdev&gt;
&gt;              &gt;&gt; &lt;/devices&gt;
&gt;              &gt;&gt; &lt;/domain&gt;
&gt;              &gt;&gt;
&gt;              &gt;&gt;
&gt;              &gt;&gt; _______________________________________________
&gt;              &gt;&gt; libvirt-users mailing list
&gt;              &gt;&gt; libvirt-users@redhat.com
&gt;             &lt;mailto:libvirt-users@redhat.com&gt;
&gt;             &lt;mailto:libvirt-users@redhat.com
&gt;             &lt;mailto:libvirt-users@redhat.com&gt;&gt;
&gt;              &gt;&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;              &gt;
&gt;              &gt;
&gt;              &gt;
&gt;              &gt;
&gt;              &gt; _______________________________________________
&gt;              &gt; libvirt-users mailing list
&gt;              &gt; libvirt-users@redhat.com &lt;mailto:libvirt-users@redhat.com&gt;
&gt;              &gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; 
&gt; 
&gt; 
&gt; 

</body></email><email><emailId>20110504135820</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2011-05-04 13:58:20-0400</timestampReceived><subject>Re: [libvirt-users] virt-install becoming a headache</subject><body>

On 05/03/2011 11:32 AM, Ricard Daniel Santafe Bence wrote:
&gt; hi libvirt team!!
&gt; 
&gt; i'have been trying to install a OS Guest in my Host(Centos 5.5 server with
&gt; kernel 2.6.18-192 o 2.6.38) and i wasn't successfull. i have installed all the
&gt; virtualization paquets of the Centos 5.5 installation, nothing more nothing less.
&gt; 
&gt; my server is without GUI. i want my servers without gui too. so i want text
&gt; based installation
&gt; 
&gt; i enter the command bellow:
&gt; 
&gt; [root@fsystem ~]# virt-install -n JPII -r 1024 --disk
&gt; path=/data/images/disk.img -l /data/dist_img/CentOS_5.2_Final.iso --nographics
&gt; --extra-args "console=tty0 console=ttyS0,115200" --network bridge:br0
&gt; 

Using --location with a CDROM doesn't really work all that well. The easiest
thing to do is mount that ISO somewhere and export the directory over HTTP,
then use --location http://localhost/path/to/the/mounted/iso and it should all
work

- Cole

&gt; so it enters installation mode (text based), but when i enter the menu of
&gt; "Installation Method" i can't do nothing. the option of "Local Cdrom" it
&gt; doesn't recognise any cdrom device, the option of "Hard DISK" it sees 3
&gt; partitionds hda,hdb&amp;hdc that i don't have and so it doesn't recognise nothing,
&gt; the options http, ftp &amp; nfs-install more the same.
&gt; 
&gt; also if i change in the command -l for -c or --cdrom and then change the iso
&gt; for the path of the cdrom device it doesn't even start the installation it
&gt; prints Escape character ^] and it stucks there instead of entering the
&gt; installation
&gt; 
&gt; if you need more information of paquets, versions i'm using you are welcome to
&gt; ask.
&gt; 
&gt; thanks for all &amp; you are my last hope!!!!
&gt; 
&gt; Atentamente
&gt; 
&gt; Ricard Santafé
&gt; 
&gt;  
&gt; 
&gt; 
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110505034004</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2011-05-05 03:40:04-0400</timestampReceived><subject>[libvirt-users] Release of libvirt-0.9.1</subject><body>

  As planned and after most of the clang detected problems got fixed
(thanks Eric !) the new release is available at:

    ftp://libvirt.org/libvirt/

  It's a mixed release, it includes a number of improvements as
well as many bug fixes and a few new features:

Features:
- support various persistent domain updates (KAMEZAWA Hiroyuki)
- improvements on memory APIs (Taku Izumi)
- Add virDomainEventRebootNew (Matthias Bolte)
- various improvements to libxl driver (Markus Groß)
- Spice: support audio, images and stream compression (Michal Privoznik)

Documentation:
- fix missing VLAN id for Qbg example (Gerhard Stenzel)
- docs: Document filesystem tag device (Cole Robinson)
- maint: fix comment typos (Eric Blake)
- Fix two out-of-date comments in LVM backend (Richard Laager)
- docs: Serial and parallel device target ports actually start from 0 (Matthias Bolte)
- maint: fix grammar errors (Eric Blake)
- docs: document freecell --all (Eric Blake)
- docs: remove "returns" word from beginning of lines (Jean-Baptiste Rouault)
- docs: add an IPv6 address to network XML examples (Laine Stump)

Portability:
- build: fix getcwd portability problems (Eric Blake)
- build: avoid test warnings on mingw (Eric Blake)
- virsh: avoid compiler warning on mingw (Eric Blake)
- build: Use pkg-config for libssh2 check (Jiri Denemark)
- build: Ignore old audit library (Jiri Denemark)
- build: fix 32-bit test failure (Eric Blake)
- build: Fix problem of building Python bindings (Osier Yang)
- build: fix 32-bit test failure (Eric Blake)
- ppc: Enable starting of Qemu VMs on ppc host (Stefan Berger)
- Migrate VMs between different-endianess hosts (Stefan Berger)
- build: really fix mingw startup (Eric Blake)
- build: fix mingw build (Eric Blake)
- do not build libvirt_iohelper when building without libvirtd (Wen Congyang)
- virsh: fix mingw startup (Eric Blake)
- build: avoid compiler warning on cygwin (Eric Blake)
- Fix build for older gcc (Jim Fehlig)
- Don't try to enable stack protector on Win32 (Daniel P. Berrange)

Bug Fixes:
- storage: avoid null deref and leak on failure (Eric Blake)
- esx: Avoid null dereference on error in esxDomainGetInfo (Matthias Bolte)
- remote: avoid null dereference on error (Eric Blake)
- cgroup: avoid leaking a file (Eric Blake)
- virsh: avoid null pointer dereference (Eric Blake)
- pci: fix null pointer dereference (Eric Blake)
- qemu: avoid null pointer dereference (Eric Blake)
- tests: avoid null pointer dereference (Eric Blake)
- Fix disability to run on systems with no PCI bus (Michal Privoznik)
- virsh: fix regression in log to file (Supriya Kannery)
- nwfilter: Fix memory leak in the ebtables subdriver (Matthias Bolte)
- qemu: Fix qemuDomainModifyDeviceFlags leaking the caps bitmap (Matthias Bolte)
- Fix memory leak in __virExec (Matthias Bolte)
- hash: fix memory leak regression (Eric Blake)
- Xen: Do not generate net ifname if domain is inactive (Jim Fehlig)
- xen: check if device is assigned to guest before reattaching (Yufang Zhang)
- util: Initialize hooks at daemon shutdown if no hooks defined (Osier Yang)
- fix virsh's regression (Wen Congyang)
- release PCI address only when we have ensured it successfully (Wen Congyang)
- free memory properly in cleanup patch (Hu Tao)
- free buf content when vsnprintf() failed (Wen Congyang)
- esx: Fix dynamic dispatch for CastFromAnyType functions (Matthias Bolte)
- Make crash and live flags mutually exclusive in virDomainCoreDump (Mark Wu)
- Fix small memory leaks in config parsing related functions (Matthias Bolte)
- daemon: Don't try to free an unsigned int in error paths (Matthias Bolte)
- Fix QEMU tunnelled migration FD handling (Daniel P. Berrange)
- Remove artificial minimum limit for guest memory (Jiri Denemark)
- fix tunnelled migration's regression (Wen Congyang)
- qemu: fix the check of virDomainObjUnref()'s return value (Wen Congyang)
- Fix checking of return codes in dispatcher (Daniel P. Berrange)
- qemu: avoid qemu_driver being unlocked twice when virThreadPoolNew() failed (Wen Congyang)
- virsh: fix regression in parsing optional integer (Eric Blake)
- phyp: avoid memory leaks in command values (Eric Blake)
- phyp: avoid memory leak on failure (Eric Blake)
- phyp: avoid a logic bug (Eric Blake)
- free cpumask of vcpupinDef (Hu Tao)
- network: Fix NULL dereference during error recovery (Michal Privoznik)
- Add missing checks for QEMU domain state in tunables APIs (Daniel P. Berrange)
- phyp: Fix too small buffer allocation in phypAttachDevice (Matthias Bolte)
- phyp: Don't overwrite error from virDomainDeviceDefParse by OOM error (Matthias Bolte)
- phyp: Don't try to use a string from a failed virAsprintf (Matthias Bolte)
- phyp: Remove stack allocating a 4kb volume key and fix related memory leaks (Matthias Bolte)
- qemu: fix a dead-lock problem (Hu Tao)
- util: Fix crash when removing entries during hash iteration (Jiri Denemark)
- Fix possible infinite loop in remote driver (Michal Privoznik)
- qemu: Remove the managed state file only if restoring succeeded (Osier Yang)
- reattach pci devices when qemuPrepareHostdevPCIDevices() failed (Wen Congyang)
- reattach pci device when pciBindDeviceToStub() failed (Wen Congyang)
- remove devices from driver activePciHostdevs when qemuPrepareHostdevPCIDevices() failed (Wen Congyang)
- pci: avoid invalid free, init path to NULL (Wen Congyang)
- qemu: Support for overriding NPROC limit (Jiri Denemark)
- qemu: Always reserves slot 0x02 for primary VGA. (Osier Yang)
- Fix typo in systemtap tapset directory name (Daniel P. Berrange)
- qemu: Ignore unusable binaries (Jiri Denemark)

Improvements:
- maint: detect clang 2.9 (Eric Blake)
- qemu: update qemuCgroupControllerActive signature (Eric Blake)
- lxc: report correct error (Eric Blake)
- libxl: avoid compiler warning (Eric Blake)
- storage: use virCommand to avoid compiler warning (Eric Blake)
- tests: Lower stack usage below 4096 bytes (Matthias Bolte)
- tests: Update valgrind suppressions file (Matthias Bolte)
- tests: simplify common setup (Eric Blake)
- network: fix return value of hostsFileWrite (Laine Stump)
- libvirt/qemu - support persistent attach/detach disks (KAMEZAWA Hiroyuki)
- libvirt/qemu - support persistent modification of devices (KAMEZAWA Hiroyuki)
- util: Simplify hash implementation (Jiri Denemark)
- tests: More unit tests for internal hash APIs (Jiri Denemark)
- Move call to virReportOOMError into virFileBuildPath (Matthias Bolte)
- build: use gnulib passfd for simpler SCM_RIGHTS code (Eric Blake)
- qemu: Add flags checking in DomainCoreDump (Jiri Denemark)
- Make sure DNSMASQ_STATE_DIR exists (Guido Günther)
- build: make VIR_FREE do some type checking (Eric Blake)
- threads: add one-time initialization support (Eric Blake)
- esx: Add a wrapper for shared CURL handles (Matthias Bolte)
- esx: Move CURL handling code to it's own type (Matthias Bolte)
- daemon: Honor error variable name change in the generator (Matthias Bolte)
- libvirt/qemu - clean up UpdateDevice for consolidation. (KAMEZAWA Hiroyuki)
- libvirt/qemu - clean up At(De)tachDeviceFlags() for consolidation. (KAMEZAWA Hiroyuki)
- libvirt/qemu - Centralize device modification in the more flexible APIs (KAMEZAWA Hiroyuki)
- Add support for s390(x) cpu options parsing (Michal Privoznik)
- PHYP: Adding reboot domain function (Eduardo Otubo)
- nwfilter: no support for direct type of interface (Stefan Berger)
- Add cputune support to libxl driver (Markus Groß)
- Update and sort msg_gen_function list and mark unmarked messages (Matthias Bolte)
- Write error check conditionals in more compact form for dispatcher (Daniel P. Berrange)
- Merge all returns paths from dispatcher into single path (Daniel P. Berrange)
- Experimental libvirtd upstart job (Alan Pevec)
- enhance processWatchdogEvent() (Wen Congyang)
- xen: Replace statsErrorFunc with a macro (Matthias Bolte)
- tests: Unit tests for internal hash APIs (Jiri Denemark)
- build: include esx_vi.generated.* into dist file (Wen Congyang)
- tests: test recent virsh option parsing changes (Eric Blake)
- virsh: list required options first (Eric Blake)
- phyp: use consistent return string handling (Eric Blake)
- maint: use lighter-weight function for straight appends (Eric Blake)
- libvirt-guests: implement START_DELAY (Alexander Todorov)
- network: truncate bridges' dummy tap device names to IFNAMSIZ (15) chars (Laine Stump)
- Introduce virDomainChrDefNew() (Michal Novotny)
- esx: Make the parsed URI part of the private connection data (Matthias Bolte)
- esx: Mark error message in macros for translation (Matthias Bolte)
- esx: Extend VI generator to cover managed object types (Matthias Bolte)
- esx: Cleanup and refactor CastFromAnyType macros (Matthias Bolte)
- esx: Cleanup VI generator code (Matthias Bolte)
- phyp: Reduce code duplication in error and success paths (Matthias Bolte)
- Replace REMOTE_DEBUG with VIR_DEBUG in daemon dispatcher (Daniel P. Berrange)
- Add missing checks for whether the connection is open in dispatcher (Daniel P. Berrange)
- PHYP: Adding network interface (Eduardo Otubo)
- xen: Remove PATH_MAX sized stack allocation from block stats code (Matthias Bolte)
- setmaxmem: add the new options to "virsh setmaxmem" command (Taku Izumi)
- maxmem: implement virDomainSetMaxMemory API of the qemu driver (Taku Izumi)
- maxmem: introduces VIR_DOMAIN_MEM_MAXIMUM flag (Taku Izumi)
- nwfilters: support for TCP flags evaluation (Stefan Berger)
- setmem: add --current option to virsh setmem command (Taku Izumi)
- setmem: add VIR_DOMAIN_MEM_CURRENT support to qemu (Taku Izumi)
- setmem: introduce VIR_DOMAIN_MEM_CURRENT flag (Taku Izumi)
- build: Install libxenlight log dir (Jim Fehlig)
- Add domainSet/GetSchedulerParameters to libxl driver (Markus Groß)
- rename pciUnBindDeviceFromStub() to pciUnbindDeviceFromStub() and float it up (Wen Congyang)
- Add domainIsUpdated to libxl driver (Markus Groß)
- Change locking for udev monitor and callbacks (Serge Hallyn)
- Improve SCSI volume key generation (Daniel P. Berrange)
- qemu: Rewrite LOOKUP_PTYS macro into a function (Jiri Denemark)
- Enable use of -Wold-style-definition compiler flag (Daniel P. Berrange)
- Enable use of -Wmissing-noreturn (Daniel P. Berrange)
- Enable -Wmissing-format-attribute warning (Daniel P. Berrange)
- Use gnulib's manywarnings and warnings modules (Daniel P. Berrange)
- Use virBufferPtr for sexpr2string instead of manual buffer handling (Matthias Bolte)
- xend: Remove 4kb stack allocation (Matthias Bolte)
- uml: Remove PATH_MAX sized stack allocation from /proc parsing code (Matthias Bolte)
- storage: Remove PATH_MAX sized stack allocation from iSCSI backend (Matthias Bolte)
- qemu: Remove PATH_MAX sized stack allocation used in commandline building (Matthias Bolte)
- Remove PATH_MAX sized stack allocation from virFileOpenTtyAt (Matthias Bolte)
- openvz: Remove several larger stack allocations (Matthias Bolte)
- daemon: Remove 4kb stack allocation of security label (Matthias Bolte)
- virsh: Remove two 4kb stack allocations (Matthias Bolte)
- Use virFileAbsPath instead of manually creating the absolute path (Matthias Bolte)
- xenxs: Remove PATH_MAX sized stack allocation in XM script parsing (Matthias Bolte)
- sasl: Remove stack allocated 8kb temporary buffers (Matthias Bolte)
- qemu: Use heap allocated memory to read the monitor greeting (Matthias Bolte)
- phyp: Remove 16kb stack allocation (Matthias Bolte)
- virt-aa-helper: Remove PATH_MAX sized stack allocations (Matthias Bolte)
- ebtables: Remove PATH_MAX sized stack allocation (Matthias Bolte)
- pci: Remove PATH_MAX sized stack allocations (Matthias Bolte)
- Remove PATH_MAX sized stack allocations related to virFileBuildPath (Matthias Bolte)
- vmx: Use case-insensitive compare functions for all content (Matthias Bolte)
- vmx: Support persistent CPU shares (Matthias Bolte)
- Add autostart support to libxl driver (Markus Groß)
- Allow relative path for qemu backing file (Jesse Cook)
- build: detect potentential uninitialized variables (Eric Blake)

Cleanups:
- esx: Disable performance counter queries in esxDomainGetInfo (Matthias Bolte)
- esx: Remove dead store in esxUtil_ParseDatastorePath (Matthias Bolte)
- util: remove dead assignment (Eric Blake)
- qemu: remove dead assignment (Eric Blake)
- qemu: silence clang false positives (Eric Blake)
- tests: suppress more valgrind situations (Eric Blake)
- tests: avoid compiler warning (Eric Blake)
- qemu: fix uninitialized variable warning (Christophe Fergeau)
- build: fix syntax-check failure (Eric Blake)
- virsh: nuke use of TRUE and FALSE (Eric Blake)
- phyp: another simplification (Eric Blake)
- maint: ignore built file (Eric Blake)
- Change some variable names to follow standard in daemon dispatcher (Daniel P. Berrange)
- Remove curly braces on all single-line conditional jumps in dispatcher (Daniel P. Berrange)
- Remove virConnectPtr from virRaiseErrorFull (Matthias Bolte)
- phyp: prefer memcpy over memmove when legal (Eric Blake)
- phyp: use consistent style for labels (Eric Blake)
- phyp: more return handling cleanup (Eric Blake)
- esx: Fix gcc 4.6 warning about initialized but unused variables (Matthias Bolte)
- maint: silence cppi warnings (Eric Blake)
- Fix gcc 4.6 warnings in vbox_tmpl.c (Christophe Fergeau)
- Fix gcc 4.6 warnings (Christophe Fergeau)
- Remove C99 variable declare in PHYP network driver (Daniel P. Berrange)
- Standard on error variable name in libvirtd dispatcher (Daniel P. Berrange)
- Remove all whitespace before function brackets in daemon dispatcher (Daniel P. Berrange)
- docs: tweak virsh restore warning (Eric Blake)
- setmaxmem: remove the code to invoke virDomainSetMemory in cmdSetmaxmem (Taku Izumi)
- build: fix gitignore sorting (Eric Blake)
- tests: fix recent test failures (Eric Blake)
- libxl: avoid compiler warning (Eric Blake)
- Avoid compiler warnings about int to void * casts (Daniel P. Berrange)
- Remove acinclude.m4 file (Daniel P. Berrange)
- Remove possible uninitialized variable in openvz driver (Daniel P. Berrange)

  Thanks to everybody who helped with this release in any way,
bug reports, documentation, patches or features !

Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

</body></email><email><emailId>20110505132457</emailId><senderName>guan qin</senderName><senderEmail>qinguan0619@gmail.com</senderEmail><timestampReceived>2011-05-05 13:24:57-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt] Error: unable to connect to '/var/run/libvirt/libvirt-sock'</subject><body>

Hi,
I recompile the libvirt-0.9.0 with "./configure --prefix=/usr
--libdir=/usr/lib64 --localstatedir=/var --sysconfdir=/etc "
in both the dell optiplex 780 and Xeon(R) E5620,find that in the dell 780
shows:

root@Optiplex-780:/home/qinguan# virsh
error£ºunable to connect to '/usr/local/var/run/libvirt/libvirt-sock',
libvirtd may need to be started: Ã»ÓÐÄÇ¸öÎÄ¼þ»òÄ¿ ¼(no such file or directory )
error£ºÁ¬½Óµ½¹ÜÀí³ÌÐòÊ§°Ü(failed to connect the monitor)
root@Optiplex-780:/home/qinguan# /usr/local/sbin/libvirtd -d
root@Optiplex-780:/home/qinguan# virsh
Welcome to virsh, the virtualization interactive terminal.

Type:  'help' for help with commands
       'quit' to quit

virsh #
root@Optiplex-780:/home/qinguan# virsh --version
0.9.0
root@Optiplex-780:/home/qinguan#
¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á
In Xeon E5620,it's OK , but I still can't connect the VM running on the
E5620 from dell 780 by "virt-viewer -c
qemu+ssh://192.168.7.126/systemubuntu" or "virsh -c qemu+ssh://
root@192.168.7.126/system".


best regards,
qinguan



2011/5/5 Daniel P. Berrange &lt;berrange@redhat.com&gt;

&gt; On Thu, May 05, 2011 at 08:07:30PM +0800, guan qin wrote:
&gt; &gt; Hi,
&gt; &gt; I meet with the problem that "Error: unable to connect to
&gt; &gt; '/var/run/libvirt/libvirt-sock' ".
&gt; &gt; I do as  Error: unable to connect to '/var/run/libvirt/libvirt-sock'
&gt; &gt; &lt;
&gt; http://wiki.libvirt.org/page/FAQ#Error:_unable_to_connect_to_.27.2Fvar.2Frun.2Flibvirt.2Flibvirt-sock.27
&gt; 
&gt; &gt; said
&gt; &gt; but never worked:
&gt; &gt; 
&gt; &gt; root@shahe26:~# virsh
&gt; &gt; error: unable to connect to '/var/run/libvirt/libvirt-sock', libvirtd may
&gt; &gt; need to be started: No such file or directory
&gt; &gt; error: failed to connect to the hypervisor
&gt; &gt; root@shahe26:~# ls /usr/lib64 | grep libvirt
&gt; &gt; libvirt
&gt; &gt; libvirt.a
&gt; &gt; libvirt.la
&gt; &gt; libvirt-qemu.a
&gt; &gt; libvirt-qemu.la
&gt; &gt; libvirt-qemu.so
&gt; &gt; libvirt-qemu.so.0
&gt; &gt; libvirt-qemu.so.0.8.3
&gt; &gt; libvirt-qemu.so.0.9.0
&gt; &gt; libvirt.so
&gt; &gt; libvirt.so.0
&gt; &gt; libvirt.so.0.8.3
&gt; &gt; libvirt.so.0.9.0
&gt; &gt; root@shahe26:~# ls /usr/lib32 | grep libvirt
&gt; &gt; root@shahe26:~# /etc/init.d/libvirt-bin restart
&gt; &gt; Restarting libvirt management daemon: /usr/sbin/libvirtd.
&gt; &gt; root@shahe26:~# virsh
&gt; &gt; error: unable to connect to '/var/run/libvirt/libvirt-sock', libvirtd may
&gt; &gt; need to be started: No such file or directory
&gt; &gt; error: failed to connect to the hypervisor
&gt; &gt; root@shahe26:~#
&gt; &gt; 
&gt; &gt; I install the libvirt as follows:
&gt; &gt; #./configure --prefix=/usr --libdir=/usr/lib64
&gt; 
&gt; You're missing   --localstatedir=/var --sysconfdir=/etc
&gt; 
&gt; &gt; #make
&gt; &gt; #make install
&gt; &gt; 
&gt; 
&gt; 
&gt; Regards,
&gt; Daniel
&gt; --
&gt; &gt; &gt; http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/:|
&gt; &gt; &gt; http://libvirt.org              -o-             http://virt-manager.org:|
&gt; &gt; &gt; http://autobuild.org       -o-         http://search.cpan.org/~danberr/:|
&gt; &gt; &gt; http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc:|
&gt; 


[Attachment #3 (text/html)]

Hi,&lt;br&gt;I recompile the libvirt-0.9.0 with "./configure --prefix=/usr \
--libdir=/usr/lib64 --localstatedir=/var --sysconfdir=/etc " &lt;br&gt;in both the \
dell optiplex 780 and Xeon(R) E5620,find that in the dell 780 shows:&lt;br&gt; \
&lt;br&gt;root@Optiplex-780:/home/qinguan# virsh&lt;br&gt;error£ºunable to connect to \
'/usr/local/var/run/libvirt/libvirt-sock', libvirtd may need to be started: \
Ã»ÓÐÄÇ¸öÎÄ¼þ»òÄ¿ ¼(no such file or directory )&lt;br&gt;error£ºÁ¬½Óµ½¹ÜÀí³ÌÐòÊ§°Ü(failed to \
connect the monitor)&lt;br&gt; root@Optiplex-780:/home/qinguan# /usr/local/sbin/libvirtd \
-d&lt;br&gt;root@Optiplex-780:/home/qinguan# virsh&lt;br&gt;Welcome to virsh, the virtualization \
interactive terminal.&lt;br&gt;&lt;br&gt;Type:  'help' for help with \
commands&lt;br&gt;       'quit' to quit&lt;br&gt; &lt;br&gt;virsh \
# &lt;br&gt; root@Optiplex-780:/home/qinguan# virsh --version&lt;br&gt;
0.9.0&lt;br&gt;
root@Optiplex-780:/home/qinguan# \
&lt;br&gt;¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á¡Á&lt;br&gt;In Xeon \
E5620,it's OK , but I still can't connect the VM running on the E5620 from \
dell 780 by "virt-viewer -c qemu+ssh://&lt;a \
href="http://192.168.7.126/system"&gt;192.168.7.126/system&lt;/a&gt; ubuntu" or \
"virsh -c qemu+ssh://&lt;a \
href="http://root@192.168.7.126/system"&gt;root@192.168.7.126/system&lt;/a&gt;".&lt;br&gt; \
&lt;br&gt;&lt;br&gt;best regards,&lt;br&gt;qinguan&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;2011/5/5 \
Daniel P. Berrange &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:berrange@redhat.com"&gt;berrange@redhat.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt; &lt;div class="im"&gt;On Thu, May 05, 2011 at 08:07:30PM +0800, \
guan qin wrote:&lt;br&gt; &gt; Hi,&lt;br&gt;
&gt; I meet with the problem that "Error: unable to connect to&lt;br&gt;
&gt; '/var/run/libvirt/libvirt-sock' ".&lt;br&gt;
&gt; I do as  Error: unable to connect to \
'/var/run/libvirt/libvirt-sock'&lt;br&gt; &lt;/div&gt;&gt; &lt;&lt;a \
href="http://wiki.libvirt.org/page/FAQ#Error:_unable_to_connect_to_.27.2Fvar.2Frun.2Flibvirt.2Flibvirt-sock.27" \
target="_blank"&gt;http://wiki.libvirt.org/page/FAQ#Error:_unable_to_connect_to_.27.2Fvar.2Frun.2Flibvirt.2Flibvirt-sock.27&lt;/a&gt;&gt;said&lt;br&gt;


&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;&gt; but never worked:&lt;br&gt;
&gt;&lt;br&gt;
&gt; root@shahe26:~# virsh&lt;br&gt;
&gt; error: unable to connect to '/var/run/libvirt/libvirt-sock', libvirtd \
may&lt;br&gt; &gt; need to be started: No such file or directory&lt;br&gt;
&gt; error: failed to connect to the hypervisor&lt;br&gt;
&gt; root@shahe26:~# ls /usr/lib64 | grep libvirt&lt;br&gt;
&gt; libvirt&lt;br&gt;
&gt; libvirt.a&lt;br&gt;
&gt; &lt;a href="http://libvirt.la" target="_blank"&gt;libvirt.la&lt;/a&gt;&lt;br&gt;
&gt; libvirt-qemu.a&lt;br&gt;
&gt; &lt;a href="http://libvirt-qemu.la" target="_blank"&gt;libvirt-qemu.la&lt;/a&gt;&lt;br&gt;
&gt; libvirt-qemu.so&lt;br&gt;
&gt; libvirt-qemu.so.0&lt;br&gt;
&gt; libvirt-qemu.so.0.8.3&lt;br&gt;
&gt; libvirt-qemu.so.0.9.0&lt;br&gt;
&gt; libvirt.so&lt;br&gt;
&gt; libvirt.so.0&lt;br&gt;
&gt; libvirt.so.0.8.3&lt;br&gt;
&gt; libvirt.so.0.9.0&lt;br&gt;
&gt; root@shahe26:~# ls /usr/lib32 | grep libvirt&lt;br&gt;
&gt; root@shahe26:~# /etc/init.d/libvirt-bin restart&lt;br&gt;
&gt; Restarting libvirt management daemon: /usr/sbin/libvirtd.&lt;br&gt;
&gt; root@shahe26:~# virsh&lt;br&gt;
&gt; error: unable to connect to '/var/run/libvirt/libvirt-sock', libvirtd \
may&lt;br&gt; &gt; need to be started: No such file or directory&lt;br&gt;
&gt; error: failed to connect to the hypervisor&lt;br&gt;
&gt; root@shahe26:~#&lt;br&gt;
&gt;&lt;br&gt;
&gt; I install the libvirt as follows:&lt;br&gt;
&gt; #./configure --prefix=/usr --libdir=/usr/lib64&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;You're missing   --localstatedir=/var --sysconfdir=/etc&lt;br&gt;
&lt;br&gt;
&gt; #make&lt;br&gt;
&gt; #make install&lt;br&gt;
&gt;&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Regards,&lt;br&gt;
Daniel&lt;br&gt;
&lt;font color="#888888"&gt;--&lt;br&gt;
&gt; &gt; &lt;a href="http://berrange.com" target="_blank"&gt;http://berrange.com&lt;/a&gt;   \
&gt; &gt;    -o-    &lt;a href="http://www.flickr.com/photos/dberrange/" \
&gt; &gt; target="_blank"&gt;http://www.flickr.com/photos/dberrange/&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="http://libvirt.org" target="_blank"&gt;http://libvirt.org&lt;/a&gt;     \
&gt; &gt;          -o-             \
&gt; &gt; &lt;a href="http://virt-manager.org" target="_blank"&gt;http://virt-manager.org&lt;/a&gt; \
&gt; &gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="http://autobuild.org" target="_blank"&gt;http://autobuild.org&lt;/a&gt;   \
&gt; &gt;     -o-         &lt;a \
&gt; &gt; href="http://search.cpan.org/%7Edanberr/" \
&gt; &gt; target="_blank"&gt;http://search.cpan.org/~danberr/&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="http://entangle-photo.org" target="_blank"&gt;http://entangle-photo.org&lt;/a&gt; \
&gt; &gt;       -o-       &lt;a \
&gt; &gt; href="http://live.gnome.org/gtk-vnc" \
&gt; &gt; target="_blank"&gt;http://live.gnome.org/gtk-vnc&lt;/a&gt; :|&lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110506060253</emailId><senderName></senderName><senderEmail>panhcn@gmail.com</senderEmail><timestampReceived>2011-05-06 06:02:53-0400</timestampReceived><subject>[libvirt-users] kvm libvirt migration problem</subject><body>

Hi everyone:

I am new here

I am using kvm and libvirt on my Dell server. Now i am trying to migrate one
virtual machine from a physical server to another. However, I failed
everytime.

In virsh on physicalServer1, I typed:

virsh # migrate virtualmachine1 qemu+ssh://username@physicalServer2/system
error: operation failed: migration to 'tcp: physicalServer2:49163' failed:
migration failed

Then I searched FAQ part on libvirt.org http://wiki.libvirt.org/page/FAQ
it says:

* error: operation failed: migration to '...' failed: migration failed *

This is an error often encountered when trying to migrate with QEMU/KVM. This
typically happens with plain migration, when the source VM cannot connect to
the destination host. You will want to make sure your hosts are properly
configured for migration (see the migration section of this FAQ)



I managed to ssh physicalServer2 in virtualmachine1 shell. So the above red
part did not explain my failure.

I also open ports on physicalServer2, iptables -L shows following
information:

Chain INPUT (policy ACCEPT)
target prot opt source destination
ACCEPT udp -- anywhere anywhere udp dpt:domain
ACCEPT tcp -- anywhere anywhere tcp dpt:domain
ACCEPT udp -- anywhere anywhere udp dpt:bootps
ACCEPT tcp -- anywhere anywhere tcp dpt:bootps
ACCEPT udp -- anywhere anywhere udp dpt:domain
ACCEPT tcp -- anywhere anywhere tcp dpt:domain
ACCEPT udp -- anywhere anywhere udp dpt:bootps
ACCEPT tcp -- anywhere anywhere tcp dpt:bootps
ACCEPT tcp -- anywhere anywhere state NEW tcp dpts:49152:49215


Chain FORWARD (policy ACCEPT)
target prot opt source destination
ACCEPT all -- anywhere 192.168.122.0/24 state RELATED,ESTABLISHED
ACCEPT all -- 192.168.122.0/24 anywhere
ACCEPT all -- anywhere anywhere
REJECT all -- anywhere anywhere reject-with icmp-port-unreachable
REJECT all -- anywhere anywhere reject-with icmp-port-unreachable
ACCEPT all -- anywhere 192.168.122.0/24 state RELATED,ESTABLISHED
ACCEPT all -- 192.168.122.0/24 anywhere
ACCEPT all -- anywhere anywhere
REJECT all -- anywhere anywhere reject-with icmp-port-unreachable
REJECT all -- anywhere anywhere reject-with icmp-port-unreachable


Chain OUTPUT (policy ACCEPT)
target prot opt source destination


The /var/log/libvirt/qemu/virtualmachine1.log on physicalServer2:

2011-05-06 13:37:30.708: starting up
LC_ALL=C PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin
QEMU_AUDIO_DRV=none /usr/bin/kvm -S -M pc-0.14 -enable-kvm -m 2048 -smp
1,sockets=1,cores=1,threads=1 -name openjudge-test -uuid
a8c704bc-a4f9-90db-3e57-40e60b00aac1 -nodefconfig -nodefaults -chardev
socket,id=charmonitor,path=/var/lib/libvirt/qemu/virtualmachine1.monitor,server,nowait
-mon chardev=charmonitor,id=monitor,mode=readline -rtc base=utc -boot c
-drive
file=/media/nfs/virtualmachine1.img,if=none,id=drive-ide0-0-0,format=raw
-device ide-drive,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0 -drive
if=none,media=cdrom,id=drive-ide0-1-0,readonly=on,format=raw -device
ide-drive,bus=ide.1,unit=0,drive=drive-ide0-1-0,id=ide0-1-0 -netdev
tap,fd=20,id=hostnet0 -device
rtl8139,netdev=hostnet0,id=net0,mac=00:16:36:8a:22 :a0,bus=pci.0,addr=0x3
-chardev pty,id=charserial0 -device
isa-serial,chardev=charserial0,id=serial0 -usb -vnc 127.0.0.1:2 -vga cirrus
-incoming tcp:0.0.0.0:49163 -device
virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x4
char device redirected to /dev/pts/0
2011-05-06 13:37:30.915: shutting down


The /var/log/libvirt/qemu/virtualmachine1.log on physicalServer1 is empty.

Both physical servers are using Ubuntu 11.04. The libvirt and kvm used are
installed by apt-get. The libvirt version is 0.8.8.

Is there anyone can help me? Thanks for help!


-- 
Best wishes,
-Panda

[Attachment #3 (text/html)]

			
		


		
		
		&lt;div class="vbclean_msgtext" id="post_message_10776461"&gt;Hi everyone:&lt;br&gt;
&lt;br&gt;
I am new here &lt;img src="http://ubuntuforums.org/images/smilies/icon_biggrin.gif" \
alt="" title="Very Happy" class="inlineimg" border="0"&gt;&lt;br&gt; &lt;br&gt;
I am using kvm and libvirt on my Dell server. Now i am trying to migrate
 one virtual machine from a physical server to another. However, I 
failed everytime. &lt;br&gt;
&lt;br&gt;
In virsh on physicalServer1, I typed:&lt;blockquote&gt; virsh #  migrate virtualmachine1 \
                qemu+ssh://username@physicalServer2/system&lt;br&gt;
error: operation failed: migration to 'tcp: physicalServer2:49163' failed: \
migration failed&lt;br&gt; &lt;/blockquote&gt;Then I searched FAQ part on &lt;a \
href="http://libvirt.org"&gt;libvirt.org&lt;/a&gt; &lt;a href="http://wiki.libvirt.org/page/FAQ" \
target="_blank"&gt;http://wiki.libvirt.org/page/FAQ&lt;/a&gt;&lt;br&gt; it says:&lt;blockquote&gt;&lt;b&gt; \
error: operation failed: migration to '...' failed: migration failed &lt;/b&gt;&lt;br&gt; \
&lt;br&gt;  This is an error often encountered when trying to migrate with  QEMU/KVM. &lt;font \
color="Red"&gt;This typically happens with plain migration, when the source  VM cannot \
connect to the destination host&lt;/font&gt;. You will want to make sure  your hosts are \
properly configured for migration (see the migration  section of this FAQ) &lt;br&gt;

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;I managed to ssh physicalServer2 in virtualmachine1 shell. So the above \
red part did not explain my failure. &lt;br&gt; &lt;br&gt;
I also open ports on physicalServer2, iptables -L shows following \
information:&lt;blockquote&gt;Chain INPUT (policy ACCEPT)&lt;br&gt; target     prot opt source    \
destination         &lt;br&gt; ACCEPT     udp  --  anywhere             anywhere            \
udp dpt:domain &lt;br&gt; ACCEPT     tcp  --  anywhere             anywhere            tcp \
dpt:domain &lt;br&gt;  ACCEPT     udp  --  anywhere             anywhere            udp \
dpt:bootps &lt;br&gt; ACCEPT     tcp  --  anywhere             anywhere            tcp \
dpt:bootps &lt;br&gt; ACCEPT     udp  --  anywhere             anywhere            udp \
dpt:domain &lt;br&gt;  ACCEPT     tcp  --  anywhere             anywhere            tcp \
dpt:domain &lt;br&gt; ACCEPT     udp  --  anywhere             anywhere            udp \
dpt:bootps &lt;br&gt; ACCEPT     tcp  --  anywhere             anywhere            tcp \
dpt:bootps &lt;br&gt;  &lt;font color="Red"&gt;ACCEPT     tcp  --  anywhere             anywhere  \
state NEW tcp dpts:49152:49215&lt;/font&gt; &lt;br&gt; &lt;br&gt;
&lt;br&gt;
Chain FORWARD (policy ACCEPT)&lt;br&gt;
target     prot opt source               destination         &lt;br&gt;
 ACCEPT     all  --  anywhere             &lt;a href="http://192.168.122.0/24" \
target="_blank"&gt;192.168.122.0/24&lt;/a&gt;    state RELATED,ESTABLISHED &lt;br&gt; ACCEPT     all \
--  &lt;a href="http://192.168.122.0/24" target="_blank"&gt;192.168.122.0/24&lt;/a&gt;     \
anywhere            &lt;br&gt;  ACCEPT     all  --  anywhere             anywhere           \
&lt;br&gt; REJECT     all  --  anywhere             anywhere            reject-with \
icmp-port-unreachable &lt;br&gt; REJECT     all  --  anywhere             anywhere          \
reject-with icmp-port-unreachable &lt;br&gt;  ACCEPT     all  --  anywhere             &lt;a \
href="http://192.168.122.0/24" target="_blank"&gt;192.168.122.0/24&lt;/a&gt;    state \
RELATED,ESTABLISHED &lt;br&gt; ACCEPT     all  --  &lt;a href="http://192.168.122.0/24" \
target="_blank"&gt;192.168.122.0/24&lt;/a&gt;     anywhere            &lt;br&gt;  ACCEPT     all  -- \
anywhere             anywhere            &lt;br&gt; REJECT     all  --  anywhere            \
anywhere            reject-with icmp-port-unreachable &lt;br&gt; REJECT     all  --  \
anywhere             anywhere            reject-with icmp-port-unreachable &lt;br&gt;  &lt;br&gt;
&lt;br&gt;
Chain OUTPUT (policy ACCEPT)&lt;br&gt;
target     prot opt source               destination &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;The /var/log/libvirt/qemu/virtualmachine1.log on \
physicalServer2:&lt;blockquote&gt;2011-05-06 13:37:30.708: starting up&lt;br&gt; LC_ALL=C 
PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin  
QEMU_AUDIO_DRV=none /usr/bin/kvm -S -M pc-0.14 -enable-kvm -m 2048 -smp 
 1,sockets=1,cores=1,threads=1 -name openjudge-test -uuid  
a8c704bc-a4f9-90db-3e57-40e60b00aac1 -nodefconfig -nodefaults -chardev 
socket,id=charmonitor,path=/var/lib/libvirt/qemu/virtualmachine1.monitor,server,nowait
                
 -mon chardev=charmonitor,id=monitor,mode=readline -rtc base=utc -boot c
 -drive 
file=/media/nfs/virtualmachine1.img,if=none,id=drive-ide0-0-0,format=raw
 -device ide-drive,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0 
-drive if=none,media=cdrom,id=drive-ide0-1-0,readonly=on,format=raw 
-device ide-drive,bus=ide.1,unit=0,drive=drive-ide0-1-0,id=ide0-1-0 
-netdev tap,fd=20,id=hostnet0 -device 
rtl8139,netdev=hostnet0,id=net0,mac=00:16:36:8a:22  
&gt; a0,bus=pci.0,addr=0x3 -chardev pty,id=charserial0 -device 
isa-serial,chardev=charserial0,id=serial0 -usb -vnc &lt;a href="http://127.0.0.1:2/" \
target="_blank"&gt;127.0.0.1:2&lt;/a&gt; -vga cirrus -incoming tcp:&lt;a \
href="http://0.0.0.0:49163/" target="_blank"&gt;0.0.0.0:49163&lt;/a&gt; -device \
virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x4&lt;br&gt;

 char device redirected to /dev/pts/0&lt;br&gt;
2011-05-06 13:37:30.915: shutting down&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;The /var/log/libvirt/qemu/virtualmachine1.log on physicalServer1 is \
empty.&lt;br&gt; &lt;br&gt;
Both physical servers are using Ubuntu 11.04. The libvirt and kvm used are installed \
by apt-get. The libvirt version is 0.8.8.&lt;br&gt; &lt;br&gt;
Is there anyone can help me? Thanks for help!&lt;img \
src="http://ubuntuforums.org/images/smilies/icon_razz.gif" alt="" title="Capital \
Razz" class="inlineimg" border="0"&gt;&lt;img \
src="http://ubuntuforums.org/images/smilies/icon_razz.gif" alt="" title="Capital \
Razz" class="inlineimg" border="0"&gt;&lt;img \
src="http://ubuntuforums.org/images/smilies/icon_razz.gif" alt="" title="Capital \
Razz" class="inlineimg" border="0"&gt;&lt;/div&gt; &lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;Best \
wishes,&lt;div&gt;-Panda&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110506093830</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-05-06 09:38:30-0400</timestampReceived><subject>Re: [libvirt-users] converting save/dump output into physical memory image</subject><body>

On Thu, May 05, 2011 at 01:56:10PM -0400, Andrew Tappert wrote:
&gt; 
&gt; A lot of people in the security community, myself included, are
&gt; interested in memory forensics these days.  Virtualization is a natural
&gt; fit with memory forensics because it allows one to get access to a
&gt; guest's memory without having to introduce any extra software into the
&gt; guest or otherwise interfere with it.  Incident responders are
&gt; particularly interested in getting memory dumps from systems they're
&gt; investigating.
&gt; 
&gt; Virsh has "save" and "dump" commands for storing the state of a guest to
&gt; a file on disk, but memory of KVM guests doesn't get saved in the
&gt; "standard" input format for memory forensics tools, which is a raw
&gt; physical memory image.  (This is what you'd get via the classical "dd
&gt; /dev/mem" approach or the contemporary equivalent using the crash
&gt; driver; and VMware Server and Workstation produce .vmem files, which are
&gt; such raw physical memory images, when a guest is paused or snapshotted.)
&gt; 
&gt; In order to analyze the memory of Libvirt/KVM guests with my Linux
&gt; memory forensics software, Second Look, I've created a tool for
&gt; converting Libvirt-QEMU-save files (output of virsh save command) or
&gt; QEMU-savevm files (output of virsh dump command) to raw physical memory
&gt; images.
&gt; 
&gt; I've got a basic working capability, though I'm still tracking down some
&gt; problems with a guest allocated 8GB RAM--not all the memory seems to be
&gt; present in the save or dump file.  And I haven't tested very extensively
&gt; yet, version support is limited to what I myself am currently running, etc.

KVM only allocates memory on demand, when the guest touches the page,
so the data will almost certainly be sparse.

FWIW, the 'crash' tool has been taught how to understand the output
of 'virsh dump' for Linux guests. I agree, it could be nice to have
a raw memory dump though, instead of the KVM save format, at least
as an option.

Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110509064155</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-05-09 06:41:55-0400</timestampReceived><subject>Re: [libvirt-users] Objective: run commands in the domain. Trouble: setting up a console</subject><body>

于 2011年05月06日 22:39, Guilherme Santos 写道:
&gt; I've installed libvirt and also Virtual Box OSE hypervisor, in order to
&gt; see if I could properly manage it through virsh.
&gt; I could easily set up, start, pause, resume, shutdown and destroy the
&gt; newly created domains, from a XML file.
&gt;
&gt; Then I was wondering how could I be able to spawn commands in the domain
&gt; through virsh, and the command 'console' gave me a the thought that I
&gt; should connect to the domain's console, so that, once connected, I would
&gt; be able to "do anything". Am I right?
&gt;
&gt; I need to be able to run commands in the virtual machine. If the only
&gt; way is by accessing the domain's console, how can I properly set up one?
&gt; I tried several ways, following the examples in the documentation.
&gt;
&gt; Problem is that no matter what I wrote in the xml file about serial or
&gt; console devices, it aways get overriden by null configuration when I
&gt; start the domain (I can see it by using command 'edit' &lt;domain&gt; ).
&gt;
&gt; So then I tried to edit the XML through virsh and insert specifications
&gt; about console or serial devices, but I never was able to sucessfully
&gt; edit the file. I always got the same error message: "could not define a
&gt; domain, rc=80bb0004", although the domain is in fact defined! I tried
&gt; editing the XML both with the domain running and stopped.
&gt;
&gt; My final alternative was using command 'attach-device' passing a xml
&gt; containing only the specifications of serial or console devices. I aways
&gt; received an error message saying that memory limit was exceeded,
&gt; although I strongly suppose that's not the real problem.

If it says "no memory", it's bug.

&gt;
&gt; I am sure that I am configuring something (or many things) wrongly, so
&gt; that I am getting all those errors... My initial problem is just to be
&gt; able to run commands in the newly created domain. Anybody can tell me an
&gt; easier way to do this? If setting up consoles is the only way, what is
&gt; going on wrongly for me?

You need to configure your guest kernel command line. E.g. Append
following to your guest kernel command line.

  console=ttyS0,115200

For more how to connect to linux via serial console, search web, :)

Then something like following in domain xml:

   &lt;serial type='pty'&gt;
     &lt;target port='0'/&gt;
   &lt;/serial&gt;
   &lt;console type='pty'&gt;
     &lt;target port='0'/&gt;
   &lt;/console&gt;

Hope you can connect to the domain via console then by:

# virsh console domain

&gt;
&gt; Sorry if an answer for this issue is already somewhere in the
&gt; documentation, I tried to find it hard before emailing you guys!
&gt;
&gt; Thanks anyway!!
&gt;
&gt; --
&gt; Guilherme Santos G. Baptista
&gt; Graduando em Ciência da Computação pela UFCG
&gt; LSD - Laboratório de Sistemas Distribuídos
&gt;
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110509071308</emailId><senderName>Emmanuel Noobadmin</senderName><senderEmail>centos.admin@gmail.com</senderEmail><timestampReceived>2011-05-09 07:13:08-0400</timestampReceived><subject>[libvirt-users] Problems using virt-install to create KVM CentOS 5.6 guest</subject><body>

I was having problems creating a KVM CentOS 5.6
Initially the host was CentOS 5.6 but I switched to Scientific Linux 6
during the process of trying to solve it. I was able to install a
working guest in the end by manually writing an XML and using virsh.

However, as it shouldn't be so complicated, Gleb over at the KVM list
asked me to share this with the libvirtd ML. I don't know it's an old
bug, since current libvirt seems to be several sub-versions ahead of
mine so decided to post to the user list first in case it's a known
bug. Hopefully somebody will be able to pinpoint what went wrong.

Host system: SL 6.0 with libvirtd (libvirt) 0.8.1
Network: 2 physical NICs, eth0 bridged to br0 for WAN connectivity,
eth1 is for internal use
Installation medium: CentOS 5.6 DVD ISO

Original problem
virt-install would simply not work, I get a blank console with nothing
happening and qemu-kvm will be 100% load on one core.

This was eventually traced to virt-install not being able to mount/use
the ISO. Mounting the ISO as loopback allowed the installation to
proceed.

However, the guest was not able to see the installation "cdrom". With
httpd running off the host, and tested accessibly via Internet, a
network install did not work either.

After much frustration, I followed the documentation at libvirt
website to write my own XML file.

The result of this was the discovery that

1. permissions on initrd.img and vmlinux was not allowing virsh access
- copying these files to disk and adjusting the xml allowed
installation to proceed. virt-install appears to do this on the fly.

2. virt-install guest could not see any disk. The anaconda installer
could not find any CDROM or hard disk.
- Part of the problem seems to be that virt-install did not save the
source for the installation medium, the generated XML did not have the
source information under the &lt;disk&gt; element. I specified this in my
manual XML and the CentOS guest was able to see the "cdrom" and
install properly. As I did not have any problem with missing hard
disks with my manually written XML so I'm not sure what went wrong
with virt-install's

3. Can't install via network
- This was traced to networking not working at all. Even in my manual
XML, networking did not work although the guest could install from the
disk. Eventually, this was solved by adding the &lt;model type='virtio'
/&gt; to the device definition.

</body></email><email><emailId>20110510122947</emailId><senderName>Andrew Cathrow</senderName><senderEmail>acathrow@redhat.com</senderEmail><timestampReceived>2011-05-10 12:29:47-0400</timestampReceived><subject>Re: [libvirt-users] Audio pass through</subject><body>



----- Original Message -----
&gt; From: "Mike Hall" &lt;MHall@astc.nt.gov.au&gt;
&gt; To: libvirt-users@redhat.com
&gt; Sent: Tuesday, May 10, 2011 12:45:05 AM
&gt; Subject: [libvirt-users] Audio pass through
&gt; 
&gt; I'm running a RHEL6 as a development desktop with Fedora 14
&gt; (multimedia stuff) and Win XP (corporate email and calendars)
&gt; running on it as KVM VMs. Everything runs great except for audio
&gt; pass through.
&gt; 

If you use Fedora virt-preview[1], or Fedora 15 then you can use SPICE which handles bidirectional audio


[1] https://fedoraproject.org/wiki/Virtualization_Preview_Repository

&gt; Audio works on the RHEL host. Both VMs see sound cards provided by
&gt; the VM, but no sound is forthcoming.
&gt; I have tried adding a PCI audio device from the physical host to the
&gt; Fedora VM, but then it refuses to boot.
&gt; I remember reading that physical hardware can only be passed through
&gt; to VMs if it is not in use on the physical host.
&gt; 
&gt; Any suggestions on how to get audio pass through happening?
&gt; How can I get the host to "relinquish" the audio device so that a VM
&gt; can use it?
&gt; 
&gt; Thanks
&gt; 
&gt; 
&gt; Michael Hall
&gt; IT Communications Officer
&gt; Alice Springs Town Council
&gt; mhall@astc.nt.gov.au
&gt; (08) 8950 0561
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; 

</body></email><email><emailId>20110510225715</emailId><senderName>Mike Hall</senderName><senderEmail>mhall@astc.nt.gov.au</senderEmail><timestampReceived>2011-05-10 22:57:15-0400</timestampReceived><subject>Re: [libvirt-users] Logfile with domain states</subject><body>

Try /var/log/libvirt/qemu

Mike

________________________________
From: libvirt-users-bounces@redhat.com [mailto:libvirt-users-bounces@redhat=
.com] On Behalf Of s.b@post.com
Sent: Tuesday, 10 May 2011 8:27 PM
To: libvirt-users@redhat.com
Subject: [libvirt-users] Logfile with domain states

Hi,

Is there any logfile where I can find information about startup, shutdown, =
etc of domains virtual machines (domains)?

Thanks,
  Stef





[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;
&lt;!--[if gte mso 9]&gt;&lt;xml&gt; 
 &lt;o:OfficeDocumentSettings&gt; 
  &lt;o:AllowPNG/&gt; 
 &lt;/o:OfficeDocumentSettings&gt; 
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt; 
 &lt;w:WordDocument&gt; 
  &lt;w:View&gt;Normal&lt;/w:View&gt; 
  &lt;w:Zoom&gt;0&lt;/w:Zoom&gt; 
  &lt;w:TrackMoves/&gt; 
  &lt;w:TrackFormatting/&gt; 
  &lt;w:PunctuationKerning/&gt; 
  &lt;w:ValidateAgainstSchemas/&gt; 
  &lt;w:SaveIfXMLInvalid&gt;false&lt;/w:SaveIfXMLInvalid&gt; 
  &lt;w:IgnoreMixedContent&gt;false&lt;/w:IgnoreMixedContent&gt; 
  &lt;w:AlwaysShowPlaceholderText&gt;false&lt;/w:AlwaysShowPlaceholderText&gt; 
  &lt;w:DoNotPromoteQF/&gt; 
  &lt;w:LidThemeOther&gt;EN-US&lt;/w:LidThemeOther&gt; 
  &lt;w:LidThemeAsian&gt;X-NONE&lt;/w:LidThemeAsian&gt; 
  &lt;w:LidThemeComplexScript&gt;X-NONE&lt;/w:LidThemeComplexScript&gt; 
  &lt;w:Compatibility&gt; 
   &lt;w:BreakWrappedTables/&gt; 
   &lt;w:SnapToGridInCell/&gt; 
   &lt;w:WrapTextWithPunct/&gt; 
   &lt;w:UseAsianBreakRules/&gt; 
   &lt;w:DontGrowAutofit/&gt; 
   &lt;w:SplitPgBreakAndParaMark/&gt; 
   &lt;w:EnableOpenTypeKerning/&gt; 
   &lt;w:DontFlipMirrorIndents/&gt; 
   &lt;w:OverrideTableStyleHps/&gt; 
  &lt;/w:Compatibility&gt; 
  &lt;m:mathPr&gt; 
   &lt;m:mathFont m:val="Cambria Math"/&gt; 
   &lt;m:brkBin m:val="before"/&gt; 
   &lt;m:brkBinSub m:val="--"/&gt; 
   &lt;m:smallFrac m:val="off"/&gt; 
   &lt;m:dispDef/&gt; 
   &lt;m:lMargin m:val="0"/&gt; 
   &lt;m:rMargin m:val="0"/&gt; 
   &lt;m:defJc m:val="centerGroup"/&gt; 
   &lt;m:wrapIndent m:val="1440"/&gt; 
   &lt;m:intLim m:val="subSup"/&gt; 
   &lt;m:naryLim m:val="undOvr"/&gt; 
  &lt;/m:mathPr&gt;&lt;/w:WordDocument&gt; 
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt; 
 &lt;w:LatentStyles DefLockedState="false" DefUnhideWhenUsed="true" 
  DefSemiHidden="true" DefQFormat="false" DefPriority="99" 
  LatentStyleCount="267"&gt; 
  &lt;w:LsdException Locked="false" Priority="0" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="Normal"/&gt; 
  &lt;w:LsdException Locked="false" Priority="9" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="heading 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 7"/&gt; 
  &lt;w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 8"/&gt; 
  &lt;w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 9"/&gt; 
  &lt;w:LsdException Locked="false" Priority="39" Name="toc 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="39" Name="toc 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="39" Name="toc 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="39" Name="toc 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="39" Name="toc 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="39" Name="toc 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="39" Name="toc 7"/&gt; 
  &lt;w:LsdException Locked="false" Priority="39" Name="toc 8"/&gt; 
  &lt;w:LsdException Locked="false" Priority="39" Name="toc 9"/&gt; 
  &lt;w:LsdException Locked="false" Priority="35" QFormat="true" Name="caption"/&gt; 
  &lt;w:LsdException Locked="false" Priority="10" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="Title"/&gt; 
  &lt;w:LsdException Locked="false" Priority="1" Name="Default Paragraph Font"/&gt; 
  &lt;w:LsdException Locked="false" Priority="11" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="Subtitle"/&gt; 
  &lt;w:LsdException Locked="false" Priority="22" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="Strong"/&gt; 
  &lt;w:LsdException Locked="false" Priority="20" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="Emphasis"/&gt; 
  &lt;w:LsdException Locked="false" Priority="59" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Table Grid"/&gt; 
  &lt;w:LsdException Locked="false" UnhideWhenUsed="false" Name="Placeholder Text"/&gt; 
  &lt;w:LsdException Locked="false" Priority="1" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="No Spacing"/&gt; 
  &lt;w:LsdException Locked="false" Priority="60" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light Shading"/&gt; 
  &lt;w:LsdException Locked="false" Priority="61" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light List"/&gt; 
  &lt;w:LsdException Locked="false" Priority="62" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light Grid"/&gt; 
  &lt;w:LsdException Locked="false" Priority="63" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Shading 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="64" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Shading 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="65" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium List 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="66" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium List 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="67" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="68" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="69" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="70" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Dark List"/&gt; 
  &lt;w:LsdException Locked="false" Priority="71" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful Shading"/&gt; 
  &lt;w:LsdException Locked="false" Priority="72" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful List"/&gt; 
  &lt;w:LsdException Locked="false" Priority="73" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful Grid"/&gt; 
  &lt;w:LsdException Locked="false" Priority="60" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light Shading Accent 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="61" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light List Accent 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="62" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light Grid Accent 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="63" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="64" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="65" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium List 1 Accent 1"/&gt; 
  &lt;w:LsdException Locked="false" UnhideWhenUsed="false" Name="Revision"/&gt; 
  &lt;w:LsdException Locked="false" Priority="34" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="List Paragraph"/&gt; 
  &lt;w:LsdException Locked="false" Priority="29" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="Quote"/&gt; 
  &lt;w:LsdException Locked="false" Priority="30" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="Intense Quote"/&gt; 
  &lt;w:LsdException Locked="false" Priority="66" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium List 2 Accent 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="67" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="68" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="69" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="70" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Dark List Accent 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="71" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful Shading Accent 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="72" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful List Accent 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="73" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful Grid Accent 1"/&gt; 
  &lt;w:LsdException Locked="false" Priority="60" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light Shading Accent 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="61" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light List Accent 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="62" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light Grid Accent 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="63" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="64" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="65" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium List 1 Accent 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="66" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium List 2 Accent 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="67" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="68" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="69" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="70" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Dark List Accent 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="71" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful Shading Accent 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="72" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful List Accent 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="73" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful Grid Accent 2"/&gt; 
  &lt;w:LsdException Locked="false" Priority="60" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light Shading Accent 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="61" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light List Accent 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="62" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light Grid Accent 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="63" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="64" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="65" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium List 1 Accent 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="66" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium List 2 Accent 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="67" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="68" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="69" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="70" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Dark List Accent 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="71" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful Shading Accent 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="72" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful List Accent 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="73" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful Grid Accent 3"/&gt; 
  &lt;w:LsdException Locked="false" Priority="60" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light Shading Accent 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="61" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light List Accent 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="62" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light Grid Accent 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="63" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="64" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="65" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium List 1 Accent 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="66" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium List 2 Accent 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="67" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="68" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="69" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="70" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Dark List Accent 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="71" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful Shading Accent 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="72" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful List Accent 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="73" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful Grid Accent 4"/&gt; 
  &lt;w:LsdException Locked="false" Priority="60" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light Shading Accent 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="61" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light List Accent 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="62" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light Grid Accent 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="63" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="64" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="65" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium List 1 Accent 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="66" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium List 2 Accent 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="67" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="68" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="69" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="70" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Dark List Accent 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="71" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful Shading Accent 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="72" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful List Accent 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="73" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful Grid Accent 5"/&gt; 
  &lt;w:LsdException Locked="false" Priority="60" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light Shading Accent 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="61" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light List Accent 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="62" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Light Grid Accent 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="63" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="64" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="65" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium List 1 Accent 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="66" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium List 2 Accent 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="67" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="68" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="69" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="70" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Dark List Accent 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="71" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful Shading Accent 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="72" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful List Accent 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="73" SemiHidden="false" 
   UnhideWhenUsed="false" Name="Colorful Grid Accent 6"/&gt; 
  &lt;w:LsdException Locked="false" Priority="19" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="Subtle Emphasis"/&gt; 
  &lt;w:LsdException Locked="false" Priority="21" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="Intense Emphasis"/&gt; 
  &lt;w:LsdException Locked="false" Priority="31" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="Subtle Reference"/&gt; 
  &lt;w:LsdException Locked="false" Priority="32" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="Intense Reference"/&gt; 
  &lt;w:LsdException Locked="false" Priority="33" SemiHidden="false" 
   UnhideWhenUsed="false" QFormat="true" Name="Book Title"/&gt; 
  &lt;w:LsdException Locked="false" Priority="37" Name="Bibliography"/&gt; 
  &lt;w:LsdException Locked="false" Priority="39" QFormat="true" Name="TOC Heading"/&gt; 
 &lt;/w:LatentStyles&gt; 
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 10]&gt; 
&lt;style&gt; 
 /* Style Definitions */ 
 table.MsoNormalTable 
	{mso-style-name:"Table Normal"; 
	mso-tstyle-rowband-size:0; 
	mso-tstyle-colband-size:0; 
	mso-style-noshow:yes; 
	mso-style-priority:99; 
	mso-style-parent:""; 
	mso-padding-alt:0in 5.4pt 0in 5.4pt; 
	mso-para-margin:0in; 
	mso-para-margin-bottom:.0001pt; 
	mso-pagination:widow-orphan; 
	font-size:11.0pt; 
	font-family:"Calibri","sans-serif"; 
	mso-ascii-font-family:Calibri; 
	mso-ascii-theme-font:minor-latin; 
	mso-hansi-font-family:Calibri; 
	mso-hansi-theme-font:minor-latin; 
	mso-bidi-font-family:"Times New Roman"; 
	mso-bidi-theme-font:minor-bidi;} 
&lt;/style&gt; 
&lt;![endif]--&gt;&lt;HTML&gt;&lt;HEAD&gt;
&lt;META http-equiv=Content-Type content="text/html; charset=us-ascii"&gt;
&lt;META content="MSHTML 6.00.6000.17080" name=GENERATOR&gt;&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;DIV dir=ltr align=left&gt;&lt;SPAN class=672304022-10052011&gt;&lt;FONT face=Arial 
color=#0000ff size=2&gt;Try /var/log/libvirt/qemu&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;
&lt;DIV dir=ltr align=left&gt;&lt;SPAN class=672304022-10052011&gt;&lt;FONT face=Arial 
color=#0000ff size=2&gt;&lt;/FONT&gt;&lt;/SPAN&gt; &lt;/DIV&gt;
&lt;DIV dir=ltr align=left&gt;&lt;SPAN class=672304022-10052011&gt;&lt;FONT face=Arial 
color=#0000ff size=2&gt;Mike&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;&lt;BR&gt;
&lt;DIV class=OutlookMessageHeader lang=en-us dir=ltr align=left&gt;
&lt;HR tabIndex=-1&gt;
&lt;FONT face=Tahoma size=2&gt;&lt;B&gt;From:&lt;/B&gt; libvirt-users-bounces@redhat.com 
[mailto:libvirt-users-bounces@redhat.com] &lt;B&gt;On Behalf Of 
&lt;/B&gt;s.b@post.com&lt;BR&gt;&lt;B&gt;Sent:&lt;/B&gt; Tuesday, 10 May 2011 8:27 PM&lt;BR&gt;&lt;B&gt;To:&lt;/B&gt; 
libvirt-users@redhat.com&lt;BR&gt;&lt;B&gt;Subject:&lt;/B&gt; [libvirt-users] Logfile with domain 
states&lt;BR&gt;&lt;/FONT&gt;&lt;BR&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;/DIV&gt;&lt;SPAN style="FONT-FAMILY: Verdana"&gt;&lt;SPAN style="FONT-SIZE: 12px"&gt;
&lt;P class=MsoNormal&gt;Hi,&lt;BR&gt;&lt;BR&gt;Is there any logfile where I can find information 
about startup, shutdown, etc of domains virtual machines 
(domains)?&lt;BR&gt;&lt;BR&gt;Thanks,&lt;BR&gt;  Stef&lt;/P&gt;
&lt;P 
style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; \
PADDING-TOP: 0px"&gt; &lt;/P&gt;&lt;BR&gt;&lt;SPAN  id=editor_signature&gt;&lt;SPAN 
style="FONT-SIZE: 12px; FONT-FAMILY: Verdana"&gt; &lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/SPAN&gt; 
&lt;/BODY&gt;&lt;/HTML&gt;



</body></email><email><emailId>20110511193752</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-05-11 19:37:52-0400</timestampReceived><subject>Re: [libvirt-users] Problems connecting to Virtualbox hypervisor using libvirt java binding</subject><body>

2011/5/11 Tarciso Oliveira &lt;tarcisocomp@gmail.com&gt;:
&gt; I am trying to connect to the virtualbox hypervisor through libvirt java
&gt; binding.
&gt;
&gt; I am on Ubuntu 10.04 and I have installed libvirt-0.85, libvirt-java-0.4.6
&gt; and virtualbox-ose-dkms. I have configured libvirt project and its java
&gt; binding at Eclipse and the default test of the binding runs properly. When I
&gt; try to run a simple test in java with the connection:
&gt;
&gt; conn = new Connect("vbox:///session", false)
&gt;
&gt; I get the following exception: "exception caught:org.libvirt.
&gt;
&gt; LibvirtException: Failed to start the nwfilter driver: Is the daemon running
&gt; ?"

This is actually a warning, but the Java bindings report it as an
exception. This is fixed in libvirt-java 0.4.7

&gt; If I try to do the same thing, but instead of using the java biding I   use
&gt; virsh, it works. I am able to connect and start the virtual machine
&gt; successfully, although none of the nwfilter commands work in virsh.

That's expected because virConnectOpen doesn't actually fail and
therefore virsh ignores the warning.

Actually, recent libvirt stopped reporting this warning at all.

Matthias

</body></email><email><emailId>20110512082950</emailId><senderName>Nikita A Menkovich</senderName><senderEmail>menkovich@gmail.com</senderEmail><timestampReceived>2011-05-12 08:29:50-0400</timestampReceived><subject>[libvirt-users] blkio issue</subject><body>

When I run
virsh blkiotune alias --weight 100
I receive:

error: Unable to change blkio parameters
error: this function is not supported by the connection driver: blkio
cgroup isn't mounted

But I have mounted blkio:

cgroup /dev/cgroup/cpu cgroup rw,relatime,cpu 0 0
cgroup /dev/cgroup/cpuacct cgroup rw,relatime,cpuacct 0 0
cgroup /dev/cgroup/devices cgroup rw,relatime,devices 0 0
cgroup /dev/cgroup/blkio cgroup rw,relatime,blkio 0 0
cgroup /dev/cgroup/freezer cgroup rw,relatime,freezer 0 0
cgroup /dev/cgroup/cpuset cgroup rw,relatime,cpuset 0 0

why it is not worked?


-- 
Nikita A Menkovich
http://libc6.org/
JID: menkovich@gmail.com
Tel: +7 (921) 423-96-48

</body></email><email><emailId>20111207135634</emailId><senderName>"Hansa"</senderName><senderEmail>mythtv@logic-q.nl</senderEmail><timestampReceived>2011-12-07 13:56:34-0400</timestampReceived><subject>[libvirt-users] Custom firewall rules</subject><body>

Hi,

 

Normally I’m using webmin to manage my firewall. Webmin fw however breaks
the iptable rules invoked by libvirt.

Is there a fw tool (beside iptables console command) which can be used
without breaking libvirts’ rules?

 

-Hansa

 

 

 


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;&lt;head&gt;&lt;meta http-equiv=Content-Type \
content="text/html; charset=iso-8859-1"&gt;&lt;meta name=Generator content="Microsoft Word \
12 (filtered medium)"&gt;&lt;style&gt;&lt;!-- /* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-priority:99;
	mso-style-link:"Balloon Text Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-priority:99;
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";}
.MsoChpDefault
	{mso-style-type:export-only;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:70.85pt 70.85pt 70.85pt 70.85pt;}
div.WordSection1
	{page:WordSection1;}
--&gt;&lt;/style&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapelayout v:ext="edit"&gt;
&lt;o:idmap v:ext="edit" data="1" /&gt;
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;&lt;/head&gt;&lt;body lang=NL link=blue vlink=purple&gt;&lt;div \
class=WordSection1&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;Hi,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;Normally I’m using webmin to manage my firewall. Webmin fw however \
breaks the iptable rules invoked by libvirt.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span lang=EN-US&gt;Is there a fw tool (beside iptables console command) \
which can be used without breaking libvirts’ rules?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;-Hansa&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20111207225341</emailId><senderName>Chris Haumesser</senderName><senderEmail>ch@wryfi.net</senderEmail><timestampReceived>2011-12-07 22:53:41-0400</timestampReceived><subject>[libvirt-users] lxc errors on 0.9.7</subject><body>

I'm testing 0.9.7 now with lxc, and get the following error when trying
to start a container:

2011-12-07 22:49:26.293: 1997: error : lxcControllerRun:1158 :
unsupported configuration: Expected exactly one TTY fd

My configuration is very simply:


  hw
  38320e75-1ba0-d85a-6138-532a3a66f13d
  102400
  102400
  1
  
    exe
    /bin/bash
  
  
  destroy
  restart
  destroy
  
    /usr/lib/libvirt/libvirt_lxc
    
      
    
  


If I try to add any different type of console, I get an error that only
pty consoles are supported.

What am I missing?


-C-



[Attachment #3 (text/html)]

&lt;html&gt;&lt;head&gt;
&lt;meta http-equiv="content-type" content="text/html; charset=ISO-8859-1"&gt;&lt;/head&gt;&lt;body
 bgcolor="#FFFFFF" text="#000000"&gt;
  &lt;div class="moz-text-plain" wrap="false" graphical-quote="true" 
style="font-family: -moz-fixed"&gt;&lt;pre wrap=""&gt;I'm testing 0.9.7 now with lxc, and get \
the following error when trying to start a container:

2011-12-07 22:49:26.293: 1997: error : lxcControllerRun:1158 :
unsupported configuration: Expected exactly one TTY fd

My configuration is very simply:

&lt;domain type="lxc"&gt;
  &lt;name&gt;hw&lt;/name&gt;
  &lt;uuid&gt;38320e75-1ba0-d85a-6138-532a3a66f13d&lt;/uuid&gt;
  &lt;memory&gt;102400&lt;/memory&gt;
  &lt;currentmemory&gt;102400&lt;/currentmemory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch="x86_64"&gt;exe&lt;/type&gt;
    &lt;init&gt;/bin/bash&lt;/init&gt;
  &lt;/os&gt;
  &lt;clock offset="utc"&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;destroy&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/lib/libvirt/libvirt_lxc&lt;/emulator&gt;
    &lt;console type="pty"&gt;
      &lt;target type="lxc" port="0"&gt;
    &lt;/target&gt;&lt;/console&gt;
  &lt;/devices&gt;
&lt;/clock&gt;&lt;/domain&gt;

If I try to add any different type of console, I get an error that only
pty consoles are supported.

What am I missing?


-C-

&lt;/pre&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20111208153028</emailId><senderName>Chris Haumesser</senderName><senderEmail>ch@luciddg.com</senderEmail><timestampReceived>2011-12-08 15:30:28-0400</timestampReceived><subject>[libvirt-users] tmpfs mounts for lxc container</subject><body>

I intend to share a single read-only filesystem root among a number of
LXC containers.

With lxc-tools, I can specify tmpfs bind mounts within the container,
for directories that need to be writable, like /var/run and /var/lock.

Is there a simple way to do this with libvirt, or do I need to mount the
tmpfs in the host first, and specify it as a filesystem in the xml?


Cheers,


-C-

</body></email><email><emailId>20111208153413</emailId><senderName>Chris Haumesser</senderName><senderEmail>ch@luciddg.com</senderEmail><timestampReceived>2011-12-08 15:34:13-0400</timestampReceived><subject>[libvirt-users] read-only rootfs for lxc containers</subject><body>

And speaking of running out of a shared read-only root, I get the
following error when I attempt it:

error: Failed to start domain hw
error: internal error guest failed to start: PATH=/bin:/sbin TERM=linux
LIBVIRT_LXC_UUID=38320e75-1ba0-d85a-6138-532a3a66f13d
LIBVIRT_LXC_NAME=hw /bin/bash
2011-12-08 15:31:41.945: 1: info : libvirt version: 0.9.7
2011-12-08 15:31:41.945: 1: error : lxcContainerPivotRoot:345 : Failed
to create /mnt/vmroot/.oldroot: Read-only file system
2011-12-08 15:31:41.945: 2666: info : libvirt version: 0.9.7
2011-12-08 15:31:41.945: 2666: error : lxcControllerRun:1210 : error
receiving signal from container: Input/output error


XML: http://pastebin.com/Q0p5irBH


Cheers,


-C-

</body></email><email><emailId>20111207205544</emailId><senderName>Chris Haumesser</senderName><senderEmail>ch@luciddg.com</senderEmail><timestampReceived>2011-12-07 20:55:44-0400</timestampReceived><subject>[libvirt-users] lxc capabilities</subject><body>

I'm experimenting with the libvirt lxc driver, and wondering if there is
some way to control the capabilities assigned to the container processes.

With lxc-tools, I can specify a configuration option, lxc.cap.drop,
which causes the container processes to drop the specified privileges.

My libvirt containers seem to run with
cap_sys_module,cap_sys_boot,cap_sys_time,cap_audit_control,cap_mac_admin
which is rather more permissive than I'd like. In particular,
cap_sys_boot allows a container to reboot the host machine.

I am running libvirt-0.9.2 from squeeze-backports on debian squeeze.


Cheers,



-C-

</body></email><email><emailId>20111209125726</emailId><senderName></senderName><senderEmail>pitnvrsk@rambler.ru</senderEmail><timestampReceived>2011-12-09 12:57:26-0400</timestampReceived><subject>[libvirt-users] http://libvirt.org/archdomain.html - page is empty</subject><body>

Hello.

I have found in section

Architecture --&gt;Domain management architecture

an empty page.

http://libvirt.org/archdomain.html

Respectfully, Peter.

</body></email><email><emailId>20111213070732</emailId><senderName></senderName><senderEmail>zhanggp@neusoft.com</senderEmail><timestampReceived>2011-12-13 07:07:32-0400</timestampReceived><subject>[libvirt-users] libvirt0.9.7.tar.gz installation cannot start libvirtd?</subject><body>

[Attachment #2 (text/plain)]


Hi£º
I have a host  Redhat6.1 £¬when i install os  the libvirt0.8.7 were contained . \
Latter i installed libvirt0.9.3.tar.gz without uninstall the libvirt0.8.7, i just use \
the virsh functions. Now i want to install libvirt0.9.7.tar.gz , and i uninstall \
libvirt0.9.3 and uninstall libvirt0.8.7 with "rpm -e" , i also delete some files \
contains vesion number 0.8.7 or o.9.3.

Today i install libvirt 0.9.7 , untar and install wit "./configure \
--prefix-/usr/local/libvirt  --with-esx", then " make" "make install" ,and i make a \
link "ln -s /usr/local/libvirt/bin/virsh  /usr/bin/virsh" , so i can use virsh .

But i cannot start libvirtd ,when i use "service libvirtd start/status.." ,it returns \
"libvirtd:unrecognized service". I found a libvirtd file in  /usr/sbin/.

Could someone help to resolve the problem ?

Thanks all

Best regards
---------------------------------------------------------------------------------------------------
 Confidentiality Notice: The information contained in this e-mail and any \
accompanying attachment(s)  is intended only for the use of the intended recipient \
and may be confidential and/or privileged of  Neusoft Corporation, its subsidiaries \
and/or its affiliates. If any reader of this communication is  not the intended \
recipient, unauthorized use, forwarding, printing,  storing, disclosure or copying  \
is strictly prohibited, and may be unlawful.If you have received this communication \
in error,please  immediately notify the sender by return e-mail, and delete the \
original message and all copies from  your system. Thank you. 
---------------------------------------------------------------------------------------------------



[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;
&lt;HTML&gt;&lt;HEAD&gt;
&lt;META content="text/html; charset=gb2312" http-equiv=Content-Type&gt;
&lt;STYLE&gt;BLOCKQUOTE {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; MARGIN-LEFT: 2em
}
OL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
UL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
&lt;/STYLE&gt;

&lt;META name=GENERATOR content="MSHTML 9.00.8112.16437"&gt;&lt;/HEAD&gt;
&lt;BODY style="MARGIN: 10px"&gt;&lt;FONT size=2 face=Verdana&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;Hi£º&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt;I have a host  Redhat6.1 £¬when i install 
os  the libvirt0.8.7 were contained . Latter i installed 
libvirt0.9.3.tar.gz without uninstall the libvirt0.8.7, i just use the virsh 
functions. Now i want to install libvirt0.9.7.tar.gz , and i uninstall 
libvirt0.9.3 and uninstall libvirt0.8.7 with "rpm -e" , i also delete some files 
contains vesion number 0.8.7 or o.9.3.&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt; &lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt;Today i install libvirt 0.9.7 , untar and install 
wit "./configure --prefix-/usr/local/libvirt  --with-esx", then " make" 
"make install" ,and i make a link "ln -s /usr/local/libvirt/bin/virsh  
/usr/bin/virsh" , so i can use virsh .&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt; &lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt;But i cannot start libvirtd ,when i use "service 
libvirtd start/status.." ,it returns "libvirtd:unrecognized service". I found a 
libvirtd file in  /usr/sbin/.&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt; &lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt;Could someone help to resolve the problem 
?&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt; &lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt;Thanks all&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt; &lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt;Best regards&lt;/DIV&gt;&lt;/FONT&gt;&lt;font \
face="monospace"&gt;---------------------------------------------------------------------------------------------------&lt;br&gt;
 Confidentiality Notice: The information contained in this e-mail and any \
accompanying attachment(s) &lt;br&gt; is intended only for the use of the intended \
recipient and may be confidential and/or privileged of &lt;br&gt; Neusoft Corporation, its \
subsidiaries and/or its affiliates. If any reader of this communication is &lt;br&gt; not \
the intended recipient, unauthorized use, forwarding, printing,  storing, \
disclosure or copying &lt;br&gt; is strictly prohibited, and may be unlawful.If you have \
received this communication in error,please &lt;br&gt; immediately notify the sender by \
return e-mail, and delete the original message and all copies from &lt;br&gt; your system. \
                Thank you. &lt;br&gt;
---------------------------------------------------------------------------------------------------&lt;/font&gt;&lt;/BODY&gt;&lt;/HTML&gt;




</body></email><email><emailId>20111213221835</emailId><senderName>zz elle</senderName><senderEmail>zzelle@gmail.com</senderEmail><timestampReceived>2011-12-13 22:18:35-0400</timestampReceived><subject>[libvirt-users] Libvirt filterref magic</subject><body>

Hi everyone,


When i start a libvirt domain (on KVM) with network filtering (using
filterref clean-traffic for example), the filter works !
But ... i don't understand how/why it works :(
Indeed when i look at ebtables -L iptables-save &amp; arptables-save (and KVM
command),
I see no filtering rules (which is surprising because clean-traffic
requires at least ebtables to be installed).


Is it normal ?
Do i miss some xxtables administration command to see them ?

What appends if i do a arptables-restore, iptables-restore after the vm
startup ?
Does it remove network filtering rules from xxtables ? No impact ?


Thx by advance for your help

ZZ, what is the magic behind my questioning ?

[Attachment #3 (text/html)]

Hi everyone,&lt;br&gt;&lt;br&gt;&lt;br&gt;When i start a libvirt domain (on KVM) with network filtering \
(using filterref clean-traffic for example), the filter works !&lt;br&gt;But ... i \
don't understand how/why it works :(&lt;br&gt;Indeed when i look at ebtables -L \
iptables-save &amp; arptables-save (and KVM command),&lt;br&gt; I see no filtering rules \
(which is surprising because clean-traffic requires at least ebtables to be \
installed).&lt;br&gt;&lt;br&gt;&lt;br&gt;Is it normal ? &lt;br&gt;Do i miss some xxtables administration \
command to see them ?&lt;br&gt;&lt;br&gt;What appends if i do a arptables-restore, \
iptables-restore after the vm startup ? &lt;br&gt; Does it remove network filtering rules \
from xxtables ? No impact ?&lt;br&gt;&lt;br&gt;&lt;br&gt;Thx by advance for your help&lt;br&gt;&lt;br&gt;ZZ, what \
is the magic behind my questioning ?&lt;span class="POS2"&gt;&lt;/span&gt;&lt;br&gt;&lt;br&gt;



</body></email><email><emailId>20111212131938</emailId><senderName>"Hansa"</senderName><senderEmail>mythtv@logic-q.nl</senderEmail><timestampReceived>2011-12-12 13:19:38-0400</timestampReceived><subject>[libvirt-users] Why does libvirt use XML firewall rules?</subject><body>

Hi there,

 

When creating a VM with a persistent virtual network, libvirt creates an XML
file with firewall definitions and stores it in
/etc/libvirt/&lt;hypervisor&gt;/networks/. The XML file is (to my knowledge)
incompatible with iptables-restore. Therefore you can’t manage your firewall
with other iptables (GUI) tools unless libvirt lets you a) import extra
rules, b) has an option to export the XML rules into iptables-save format or
c) something else. If a) , b) or c) is possible then this discussion is of
course useless and I would be pleased to know how it’s done :)

 

If not, then let’s get the discussion started.

IMHO, saving rules into XML instead of using iptables-save is absurd since
you’ll have to code stuff which is already coded. Also you’ll make it
incompatible with the tools which are readily available. Why go for this
approach and what do we get from it?

 

Best regards,

 

-Hansa


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;&lt;head&gt;&lt;meta http-equiv=Content-Type \
content="text/html; charset=iso-8859-1"&gt;&lt;meta name=Generator content="Microsoft Word \
12 (filtered medium)"&gt;&lt;style&gt;&lt;!-- /* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-priority:99;
	mso-style-link:"Balloon Text Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{mso-style-priority:34;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-priority:99;
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";}
.MsoChpDefault
	{mso-style-type:export-only;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:70.85pt 70.85pt 70.85pt 70.85pt;}
div.WordSection1
	{page:WordSection1;}
/* List Definitions */
@list l0
	{mso-list-id:2138837602;
	mso-list-type:hybrid;
	mso-list-template-ids:882153610 68354071 68354073 68354075 68354063 68354073 \
68354075 68354063 68354073 68354075;} @list l0:level1
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%1\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
--&gt;&lt;/style&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapelayout v:ext="edit"&gt;
&lt;o:idmap v:ext="edit" data="1" /&gt;
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;&lt;/head&gt;&lt;body lang=NL link=blue vlink=purple&gt;&lt;div \
class=WordSection1&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;Hi \
there,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;When \
creating a VM with a persistent virtual network, libvirt creates an XML file with \
firewall definitions and stores it in \
&lt;i&gt;/etc/libvirt/&lt;hypervisor&gt;/networks/&lt;/i&gt;. The XML file is (to my knowledge) \
incompatible with iptables-restore. Therefore you can’t manage your firewall \
with other iptables (GUI) tools unless libvirt lets you a) import extra rules, b) has \
an option to export the XML rules into iptables-save format or c) something else. If \
a) , b) or c) is possible then this discussion is of course useless and I would be \
pleased to know how it’s done :)&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;If not, \
then let’s get the discussion started.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span lang=EN-US&gt;IMHO, saving rules into XML instead of using \
iptables-save is absurd since you’ll have to code stuff which is already coded. \
Also you’ll make it incompatible with the tools which are readily available. \
Why go for this approach and what do we get from it?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;Best regards,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;-Hansa&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20111213155507</emailId><senderName>Jorge</senderName><senderEmail>jsomav@gmail.com</senderEmail><timestampReceived>2011-12-13 15:55:07-0400</timestampReceived><subject>[libvirt-users] Temporary use of disk space when deploying KVM with qcow2?</subject><body>

Hello,

I'm using libvirt to deploy a series of 7 KVM (in qcow2 format)
sequentially. The base image of the qcow2 is an ubuntu server.

The environment where i am doing this is a Live USB Ubuntu with a
persistence file (so that changes made remain).


So, my problem:

* If the persistence file (i.e. free disk space in the live ubuntu) is up
to around 1.5GB, the qemu process of launching the first one of the KVM
gets stuck, and a few seconds later an Ubuntu message pops up saying there
is no disk space left.

* If the persistence file is a bit bigger (100 MB more), it can launch the
7 KVM machines without any disk space problems.


This would suggest that during the deployment of one virtual machine, there
is a short period of time where a big amount of disk space (similar to the
size of the base image) is used (even if i am using qcow2 vms) and
afterwards released, so it can be used to launch the second vm, released,
used for the third, and so on.

If this is correct, i would like to know who is using that space, since my
intention would be to, if possible, redirect this temporary disk usage to a
RAM filesystem such as tmpfs, so that i don't need such a huge persistence
file in the USB.


I'm aware that this might be related to qemu-kvm rather than to libvirt
itself, but i can't find information about it and i would appreciate if
anyone could point me in the right direction. More details or clarification
can be provided if needed.

Best regards,
Jorge

[Attachment #3 (text/html)]

Hello,&lt;br&gt;&lt;br&gt;I'm using libvirt to deploy a series of 7 KVM (in qcow2 f=
ormat) sequentially. The base image of the qcow2 is an ubuntu server.&lt;br&gt;&lt;b=
r&gt;The environment where i am doing this is a Live USB Ubuntu with a persist=
ence file (so that changes made remain).&lt;br&gt;

&lt;br&gt;&lt;br&gt;So, my problem:&lt;br&gt;&lt;br&gt;* If the persistence file (i.e. free disk sp=
ace in the live ubuntu) is up to around 1.5GB, the qemu process of launchin=
g the first one of the KVM gets stuck, and a few seconds later an Ubuntu me=
ssage pops up saying there is no disk space left.&lt;br&gt;

&lt;br&gt;* If the persistence file is a bit bigger (100 MB more), it can launch =
the 7 KVM machines without any disk space problems.&lt;br&gt;&lt;br&gt;&lt;br&gt;This would s=
uggest that during the deployment of one virtual machine, there is a short =
period of time where a big amount of disk space (similar to the size of the=
 base image) is used (even if i am using qcow2 vms) and afterwards released=
, so it can be used to launch the second vm, released, used for the third, =
and so on.&lt;br&gt;

&lt;br&gt;If this is correct, i would like to know who is using that space, since=
 my intention would be to, if possible, redirect this temporary disk usage =
to a RAM filesystem such as tmpfs, so that i don't need such a huge per=
sistence file in the USB.&lt;br&gt;

&lt;br&gt;&lt;br&gt;I'm aware that this might be related to qemu-kvm rather than to=
 libvirt itself, but i can't find information about it and i would appr=
eciate if anyone could point me in the right direction. More details or cla=
rification can be provided if needed.&lt;br&gt;

&lt;br&gt;Best regards,&lt;br&gt;Jorge&lt;br&gt;&lt;br&gt;


</body></email><email><emailId>20111214035725</emailId><senderName>Dave Allan</senderName><senderEmail>dallan@redhat.com</senderEmail><timestampReceived>2011-12-14 03:57:25-0400</timestampReceived><subject>[libvirt-users] acceptable SASL mechanisms/can libvirt authenticate against PAM</subject><body>

I was playing with SASL authentication a bit today and I wasn't able
to get libvirt to authenticate against PAM (or anything else except
the sasldb, although I didn't try Kerberos).  Does anybody know off
the top of their head what mechanisms/password check options work?
I'm trying to figure out if I'm attempting the impossible.

Dave

</body></email><email><emailId>20111214120241</emailId><senderName>Sudheer Satyanarayana</senderName><senderEmail>sudheer.s@sudheer.net</senderEmail><timestampReceived>2011-12-14 12:02:41-0400</timestampReceived><subject>[libvirt-users] Adding a public static IP address to the guest</subject><body>

Hello,

The host runs on CentOS 6. I have installed a guest, CentOS 5.7, using 
libvirt.

I am having difficulty understanding how to assign a public static IP 
address to the guest. From what I understand by reading the Wiki, I 
think I require routed mode.

The ISP has provided a 'portable' IP routed to the VLAN of our servers. 
I want to assign this IP address to the guest.  From the virtual machine 
hardware details window, I see that "Virtual network 'default' : NAT" is 
selected for the source device field.

Can someone offer a helping hand and instruct and educate me on how to 
proceed from here?

Thanks.


-- 

With warm regards,
Sudheer. S


</body></email><email><emailId>20111215154830</emailId><senderName>Dennis Householder</senderName><senderEmail>dhouseholder@telecomsys.com</senderEmail><timestampReceived>2011-12-15 15:48:30-0400</timestampReceived><subject>[libvirt-users] Qemu restore error</subject><body>

Hello,

I'm not sure if I am having a kvm/qemu issue, a virt-manager issue, or a 
libvirt issue, so if I am asking the wrong crowd please let me know! In 
short, restoring some suspended kvm guests via virt-manager is failing 
because libvirt cannot read the qemu header. I cannot find any 
documentation on what this means. From virsh's limited documentation I 
was able to gather that there is probably something wrong with an xml 
file somewhere, but I cannot find it. Any advice is greatly appreciated!

Synopsis:
I have 5 KVM guests on a Fedora 16 laptop host. I manage them locally 
through virt-manager. These guests are JUNOS 10.1R1 (installed over 
FreeBSD 4.1 mini-inst) on a patched bios (SeaBIOS 
pre-0.6.1-20100805_064324-Compaq8510w). One time I suspended my laptop 
and the kvm domains were suspended as well. Trying to restore yields the 
following error:

Error restoring domain: operation failed: failed to read qemu header

Traceback (most recent call last):
   File "/usr/share/virt-manager/virtManager/asyncjob.py", line 44, in 
cb_wrapper
     callback(asyncjob, *args, **kwargs)
   File "/usr/share/virt-manager/virtManager/asyncjob.py", line 65, in tmpcb
     callback(*args, **kwargs)
   File "/usr/share/virt-manager/virtManager/domain.py", line 1050, in 
startup
     self._backend.create()
   File "/usr/lib64/python2.7/site-packages/libvirt.py", line 510, in create
     if ret == -1: raise libvirtError ('virDomainCreate() failed', dom=self)
libvirtError: operation failed: failed to read qemu header

#end error output

Package version info:

libvirt-python-0.9.6-2.fc16.x86_64
libvirt-0.9.6-2.fc16.x86_64
libvirt-client-0.9.6-2.fc16.x86_64
gpxe-roms-qemu-1.0.1-4.fc16.noarch
qemu-system-x86-0.15.1-3.fc16.x86_64
qemu-common-0.15.1-3.fc16.x86_64
qemu-kvm-0.15.1-3.fc16.x86_64
qemu-img-0.15.1-3.fc16.x86_64
virt-manager-0.9.0-7.fc16.noarch
virt-manager-common-0.9.0-7.fc16.noarch
virt-viewer-0.4.1-3.fc16.x86_64


Again, any advice is appreciated. I hope I have provided enough info. 
Thank you for your time!


-- Dennis

CONFIDENTIALITY NOTICE: The information contained in this message may be privileged \
and/or confidential. If you are not the intended recipient, or responsible for \
delivering this message to the intended recipient, any review, forwarding, \
dissemination, distribution or copying of this communication or any attachment(s) is \
strictly prohibited. If you have received this message in error, please notify the \
sender immediately, and delete it and all attachments from your computer and network.


</body></email><email><emailId>20111201231853</emailId><senderName>Nathan March</senderName><senderEmail>nathan@gt.net</senderEmail><timestampReceived>2011-12-01 23:18:53-0400</timestampReceived><subject>[libvirt-users] Libvirtd slowness</subject><body>

Hi,

Can anyone tell me if it's normal to take over 2 seconds to connect to 
the libvirt daemon?

xen1 ~ # time virsh -c 'xen://xen5/' pwd
real    0m2.102s

xen1 ~ # time virsh -c 'xen://xen1/' pwd
real    0m2.217s

Strace shows it sitting for 2.08s on polling the remote socket:
poll([{fd=6, events=POLLIN}, {fd=7, events=POLLIN}], 2, -1) = 1 ([{fd=6, 
revents=POLLIN}]) &lt;2.082839&gt;

Not quite sure why though? Experiencing this on both 0.9.7 and 0.9.0.  
This happens both with virsh and the perl libvirt bindings.

If i just spawn virsh interactively I only incur that 2s hit on intial 
spawn, all commands are very quick and responsive.

Anyone have any suggestions?

- Nathan

-- 
Nathan March&lt;nathan@gt.net&gt;
Gossamer Threads Inc. http://www.gossamer-threads.com/
Tel: (604) 687-5804 Fax: (604) 687-5806

</body></email><email><emailId>20111213003502</emailId><senderName>Nathan March</senderName><senderEmail>nathan@gt.net</senderEmail><timestampReceived>2011-12-13 00:35:02-0400</timestampReceived><subject>Re: [libvirt-users] Libvirtd slowness</subject><body>

On 12/1/2011 3:18 PM, Nathan March wrote:
&gt; Can anyone tell me if it's normal to take over 2 seconds to connect to 
&gt; the libvirt daemon?
&gt;

Can anyone comment on this? Even just a quick test to see if it happens 
on your systems would be appreciated.

- Nathan

</body></email><email><emailId>20111213004829</emailId><senderName>Nathan March</senderName><senderEmail>nathan@gt.net</senderEmail><timestampReceived>2011-12-13 00:48:29-0400</timestampReceived><subject>Re: [libvirt-users] Libvirtd slowness</subject><body>

On 12/12/2011 4:35 PM, Nathan March wrote:
&gt; On 12/1/2011 3:18 PM, Nathan March wrote:
&gt;&gt; Can anyone tell me if it's normal to take over 2 seconds to connect 
&gt;&gt; to the libvirt daemon?
&gt;&gt;
&gt;
&gt; Can anyone comment on this? Even just a quick test to see if it 
&gt; happens on your systems would be appreciated.
&gt;

I've rebuilt it with debugging and found the following:

16:47:29.640: 5972: debug : remoteIOEventLoop:10599 : Giving up the buck 
66 0x7ff564a59010 (nil)
16:47:29.640: 5972: debug : remoteIO:10773 : All done with our call 66 
(nil) 0x7ff564a59010
16:47:29.641: 5972: debug : remoteIO:10673 : Do proc=1 serial=1 
length=48 wait=(nil)
16:47:29.641: 5972: debug : remoteIO:10745 : We have the buck 1 
0x10c6130 0x10c6130
16:47:31.670: 5972: debug : remoteIODecodeMessageLength:10066 : Got 
length, now need 56 total (52 more)
16:47:31.670: 5972: debug : remoteIOEventLoop:10599 : Giving up the buck 
1 0x10c6130 (nil)
16:47:31.670: 5972: debug : remoteIO:10773 : All done with our call 1 
(nil) 0x10c6130
16:47:31.670: 5972: debug : doRemoteOpen:922 : Adding Handler for remote 
events
16:47:31.670: 5972: debug : virEventPollAddHandle:110 : Add handle fd=7 
events=1 cb=0x7ff

The 2s gap is pretty visible, not sure why yet.

- Nathan

</body></email><email><emailId>20111213085113</emailId><senderName>Michal Privoznik</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2011-12-13 08:51:13-0400</timestampReceived><subject>Re: [libvirt-users] Libvirtd slowness</subject><body>

On 13.12.2011 01:48, Nathan March wrote:
&gt; On 12/12/2011 4:35 PM, Nathan March wrote:
&gt;&gt; On 12/1/2011 3:18 PM, Nathan March wrote:
&gt;&gt;&gt; Can anyone tell me if it's normal to take over 2 seconds to connect
&gt;&gt;&gt; to the libvirt daemon?
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt; Can anyone comment on this? Even just a quick test to see if it
&gt;&gt; happens on your systems would be appreciated.
&gt;&gt;
&gt; 
&gt; I've rebuilt it with debugging and found the following:
&gt; 
&gt; 16:47:29.640: 5972: debug : remoteIOEventLoop:10599 : Giving up the buck
&gt; 66 0x7ff564a59010 (nil)
&gt; 16:47:29.640: 5972: debug : remoteIO:10773 : All done with our call 66
&gt; (nil) 0x7ff564a59010
&gt; 16:47:29.641: 5972: debug : remoteIO:10673 : Do proc=1 serial=1
&gt; length=48 wait=(nil)
&gt; 16:47:29.641: 5972: debug : remoteIO:10745 : We have the buck 1
&gt; 0x10c6130 0x10c6130
&gt; 16:47:31.670: 5972: debug : remoteIODecodeMessageLength:10066 : Got
&gt; length, now need 56 total (52 more)
&gt; 16:47:31.670: 5972: debug : remoteIOEventLoop:10599 : Giving up the buck
&gt; 1 0x10c6130 (nil)
&gt; 16:47:31.670: 5972: debug : remoteIO:10773 : All done with our call 1
&gt; (nil) 0x10c6130
&gt; 16:47:31.670: 5972: debug : doRemoteOpen:922 : Adding Handler for remote
&gt; events
&gt; 16:47:31.670: 5972: debug : virEventPollAddHandle:110 : Add handle fd=7
&gt; events=1 cb=0x7ff
&gt; 
&gt; The 2s gap is pretty visible, not sure why yet.

Yeah, the gap is obvious. However, this is not telling us why. Can you
please provide the daemon logs? As far as I can tell, we see client
here, waiting for response for 2 secs. Therefore we need to inspect the
daemon for what take it so long.

Michal

</body></email><email><emailId>20111213191134</emailId><senderName>Nathan March</senderName><senderEmail>nathan@gt.net</senderEmail><timestampReceived>2011-12-13 19:11:34-0400</timestampReceived><subject>Re: [libvirt-users] Libvirtd slowness</subject><body>

On 12/13/2011 12:51 AM, Michal Privoznik wrote:
&gt; On 13.12.2011 01:48, Nathan March wrote:
&gt;&gt;
&gt;&gt; I've rebuilt it with debugging and found the following:
&gt;&gt;
&gt;&gt; 16:47:29.640: 5972: debug : remoteIOEventLoop:10599 : Giving up the buck
&gt;&gt; 66 0x7ff564a59010 (nil)
&gt;&gt; 16:47:29.640: 5972: debug : remoteIO:10773 : All done with our call 66
&gt;&gt; (nil) 0x7ff564a59010
&gt;&gt; 16:47:29.641: 5972: debug : remoteIO:10673 : Do proc=1 serial=1
&gt;&gt; length=48 wait=(nil)
&gt;&gt; 16:47:29.641: 5972: debug : remoteIO:10745 : We have the buck 1
&gt;&gt; 0x10c6130 0x10c6130
&gt;&gt; 16:47:31.670: 5972: debug : remoteIODecodeMessageLength:10066 : Got
&gt;&gt; length, now need 56 total (52 more)
&gt;&gt; 16:47:31.670: 5972: debug : remoteIOEventLoop:10599 : Giving up the buck
&gt;&gt; 1 0x10c6130 (nil)
&gt;&gt; 16:47:31.670: 5972: debug : remoteIO:10773 : All done with our call 1
&gt;&gt; (nil) 0x10c6130
&gt;&gt; 16:47:31.670: 5972: debug : doRemoteOpen:922 : Adding Handler for remote
&gt;&gt; events
&gt;&gt; 16:47:31.670: 5972: debug : virEventPollAddHandle:110 : Add handle fd=7
&gt;&gt; events=1 cb=0x7ff
&gt;&gt;
&gt;&gt; The 2s gap is pretty visible, not sure why yet.
&gt; Yeah, the gap is obvious. However, this is not telling us why. Can you
&gt; please provide the daemon logs? As far as I can tell, we see client
&gt; here, waiting for response for 2 secs. Therefore we need to inspect the
&gt; daemon for what take it so long.

Yep, here it is:

11:09:25.687: 7898: debug : virEventPollDispatchHandles:466 : i=5 w=6
11:09:25.687: 7898: debug : virEventPollDispatchHandles:466 : i=6 w=7
11:09:25.687: 7898: debug : virEventPollDispatchHandles:466 : i=7 w=8
11:09:25.687: 7898: debug : virEventPollDispatchHandles:479 : Dispatch 
n=7 f=17 w=8 e=1 0x21e19a0
11:09:25.688: 7903: debug : virEventPollUpdateHandle:143 : Update handle 
w=7 e=3
11:09:25.688: 7903: debug : virEventPollInterruptLocked:693 : Interrupting
11:09:25.688: 7898: debug : xenStoreDomainIntroduced:1354 : Some domains 
were missing, trying again
11:09:25.789: 7898: debug : xenStoreDomainIntroduced:1354 : Some domains 
were missing, trying again
11:09:25.889: 7898: debug : xenStoreDomainIntroduced:1354 : Some domains 
were missing, trying again
11:09:25.990: 7898: debug : xenStoreDomainIntroduced:1354 : Some domains 
were missing, trying again
11:09:26.091: 7898: debug : xenStoreDomainIntroduced:1354 : Some domains 
were missing, trying again
11:09:26.191: 7898: debug : xenStoreDomainIntroduced:1354 : Some domains 
were missing, trying again
11:09:26.292: 7898: debug : xenStoreDomainIntroduced:1354 : Some domains 
were missing, trying again
11:09:26.393: 7898: debug : xenStoreDomainIntroduced:1354 : Some domains 
were missing, trying again
11:09:26.494: 7898: debug : xenStoreDomainIntroduced:1354 : Some domains 
were missing, trying again
11:09:26.595: 7898: debug : xenStoreDomainIntroduced:1354 : Some domains 
were missing, trying again
11:09:26.696: 7898: debug : xenStoreDomainIntroduced:1354 : Some domains 
were missing, trying again
11:09:26.796: 7898: debug : xenStoreDomainIntroduced:1354 : Some domains 
were missing, trying again
11:09:26.897: 7898: debug : xenStoreDomainIntroduced:1354 : Some domains 
were missing, trying again
11:09:27.025: 7898: debug : xenStoreDomainIntroduced:1354 : Some domains 
were missing, trying again
11:09:27.126: 7898: debug : xenStoreDomainIntroduced:1354 : Some domains 
were missing, trying again
11:09:27.227: 7898: debug : xenStoreDomainIntroduced:1354 : Some domains 
were missing, trying again
11:09:27.328: 7898: debug : xenStoreDomainIntroduced:1354 : Some domains 
were missing, trying again
11:09:27.429: 7898: debug : xenStoreDomainIntroduced:1354 : Some domains 
were missing, trying again
11:09:27.530: 7898: debug : xenStoreDomainIntroduced:1354 : Some domains 
were missing, trying again
11:09:27.631: 7898: debug : xenStoreDomainIntroduced:1354 : Some domains 
were missing, trying again
11:09:27.731: 7898: debug : virEventPollDispatchHandles:466 : i=8 w=9
11:09:27.732: 7898: debug : virEventPollCleanupTimeouts:497 : Cleanup 1
11:09:27.732: 7898: debug : virEventPollCleanupHandles:544 : Cleanup 9
11:09:27.732: 7898: debug : virEventRunDefaultImpl:188 :
11:09:27.732: 7898: debug : virEventPollCleanupTimeouts:497 : Cleanup 1
11:09:27.732: 7898: debug : virEventPollCleanupHandles:544 : Cleanup 9

This is on a freshly booted machine with no VM's running on it, so not 
sure what domains it's expecting to find?

- Nathan

</body></email><email><emailId>20111213192440</emailId><senderName>Nathan March</senderName><senderEmail>nathan@gt.net</senderEmail><timestampReceived>2011-12-13 19:24:40-0400</timestampReceived><subject>Re: [libvirt-users] Libvirtd slowness</subject><body>

On 12/13/2011 11:11 AM, Nathan March wrote:
&gt;
&gt; This is on a freshly booted machine with no VM's running on it, so not 
&gt; sure what domains it's expecting to find?
&gt;
&gt; - Nathan

Little more info, here's an strace of the libvirtd during that time:

[pid  7898] 11:21:48.450160 write(8, "11:21:48.449: 7898: debug : 
xenStoreDomainIntroduced:1354 : Some domains were missing, trying 
again\n", 100) = 100
[pid  7898] 11:21:48.450468 nanosleep({0, 100000000}, NULL) = 0
[pid  7898] 11:21:48.550803 rt_sigaction(SIGPIPE, {SIG_IGN, [], 
SA_RESTORER, 0x7fc1cfa42400}, {SIG_IGN, [], SA_RESTORER|SA_SIGINFO, 
0x7fc1cfa42400}, 8) = 0
[pid  7898] 11:21:48.551095 write(16, 
"\1\0\0\0\0\0\0\0\0\0\0\0\16\0\0\0", 16) = 16
[pid  7898] 11:21:48.551351 write(16, "/local/domain\0", 14 &lt;unfinished ...&gt;
[pid  8577] 11:21:48.551597 &lt;... read resumed&gt; 
"\1\0\0\0\0\0\0\0\0\0\0\0\2\0\0\0", 16) = 16
[pid  8577] 11:21:48.551729 read(16, "0\0", 2) = 2
[pid  8577] 11:21:48.551937 read(16, &lt;unfinished ...&gt;
[pid  7898] 11:21:48.552081 &lt;... write resumed&gt; ) = 14
[pid  7898] 11:21:48.552193 rt_sigaction(SIGPIPE, {SIG_IGN, [], 
SA_RESTORER|SA_SIGINFO, 0x7fc1cfa42400}, NULL, 8) = 0
[pid  7898] 11:21:48.552435 mlock(0x7fc1cdb697d0, 80) = 0
[pid  7898] 11:21:48.552662 mlock(0x7fc1cdb696e0, 136) = 0
[pid  7898] 11:21:48.552886 ioctl(15, SNDCTL_DSP_RESET, 0x7fc1cdb69560) = 0
[pid  7898] 11:21:48.553158 munlock(0x7fc1cdb696e0, 136) = 0
[pid  7898] 11:21:48.553330 munlock(0x7fc1cdb697d0, 80) = 0
[pid  7898] 11:21:48.553524 rt_sigaction(SIGPIPE, {SIG_IGN, [], 
SA_RESTORER, 0x7fc1cfa42400}, {SIG_IGN, [], SA_RESTORER|SA_SIGINFO, 
0x7fc1cfa42400}, 8) = 0
[pid  7898] 11:21:48.553843 write(16, 
"\1\0\0\0\0\0\0\0\0\0\0\0\16\0\0\0", 16) = 16
[pid  7898] 11:21:48.554124 write(16, "/local/domain\0", 14 &lt;unfinished ...&gt;
[pid  8577] 11:21:48.554411 &lt;... read resumed&gt; 
"\1\0\0\0\0\0\0\0\0\0\0\0\2\0\0\0", 16) = 16
[pid  8577] 11:21:48.554584 read(16, "0\0", 2) = 2
[pid  8577] 11:21:48.554745 read(16, &lt;unfinished ...&gt;
[pid  7898] 11:21:48.554911 &lt;... write resumed&gt; ) = 14
[pid  7898] 11:21:48.555020 rt_sigaction(SIGPIPE, {SIG_IGN, [], 
SA_RESTORER|SA_SIGINFO, 0x7fc1cfa42400}, NULL, 8) = 0
[pid  7898] 11:21:48.555289 mlock(0x7fc1cdb697c0, 80) = 0
[pid  7898] 11:21:48.555461 mlock(0x7fc1cdb696d0, 136) = 0
[pid  7898] 11:21:48.555684 ioctl(15, SNDCTL_DSP_RESET, 0x7fc1cdb69550) = 0
[pid  7898] 11:21:48.555884 munlock(0x7fc1cdb696d0, 136) = 0
[pid  7898] 11:21:48.556088 munlock(0x7fc1cdb697c0, 80) = 0
[pid  7898] 11:21:48.556293 rt_sigaction(SIGPIPE, {SIG_IGN, [], 
SA_RESTORER, 0x7fc1cfa42400}, {SIG_IGN, [], SA_RESTORER|SA_SIGINFO, 
0x7fc1cfa42400}, 8) = 0
[pid  7898] 11:21:48.556548 write(16, 
"\2\0\0\0\0\0\0\0\0\0\0\0\25\0\0\0", 16) = 16
[pid  7898] 11:21:48.556825 write(16, "/local/domain/0/name\0", 21 
&lt;unfinished ...&gt;
[pid  8577] 11:21:48.557075 &lt;... read resumed&gt; 
"\2\0\0\0\0\0\0\0\0\0\0\0\10\0\0\0", 16) = 16
[pid  8577] 11:21:48.557206 read(16, "Domain-0", 8) = 8
[pid  8577] 11:21:48.557373 read(16, &lt;unfinished ...&gt;
[pid  7898] 11:21:48.557538 &lt;... write resumed&gt; ) = 21
[pid  7898] 11:21:48.557602 rt_sigaction(SIGPIPE, {SIG_IGN, [], 
SA_RESTORER|SA_SIGINFO, 0x7fc1cfa42400}, NULL, 8) = 0
[pid  7898] 11:21:48.557872 rt_sigaction(SIGPIPE, {SIG_IGN, [], 
SA_RESTORER, 0x7fc1cfa42400}, {SIG_IGN, [], SA_RESTORER|SA_SIGINFO, 
0x7fc1cfa42400}, 8) = 0
[pid  7898] 11:21:48.558166 write(16, 
"\2\0\0\0\0\0\0\0\0\0\0\0\23\0\0\0", 16) = 16
[pid  7898] 11:21:48.558420 write(16, "/local/domain/0/vm\0", 19 
&lt;unfinished ...&gt;
[pid  8577] 11:21:48.558662 &lt;... read resumed&gt; 
"\2\0\0\0\0\0\0\0\0\0\0\0*\0\0\0", 16) = 16
[pid  8577] 11:21:48.558887 read(16, 
"/vm/00000000-0000-0000-0000-000000000000-7", 42) = 42
[pid  8577] 11:21:48.559150 read(16, &lt;unfinished ...&gt;
[pid  7898] 11:21:48.559331 &lt;... write resumed&gt; ) = 19
[pid  7898] 11:21:48.559464 rt_sigaction(SIGPIPE, {SIG_IGN, [], 
SA_RESTORER|SA_SIGINFO, 0x7fc1cfa42400}, NULL, 8) = 0
[pid  7898] 11:21:48.559706 gettimeofday({1323804108, 559781}, NULL) = 0
[pid  7898] 11:21:48.559912 gettid()    = 7898
[pid  7898] 11:21:48.560116 write(8, "11:21:48.559: 7898: debug : 
xenStoreDomainIntroduced:1354 : Some domains were missing, trying 
again\n", 100) = 100


Yet xenstore data for the local dom0 looks fine?

xen3 ~ # xenstore-ls /local/domain/0
vm = "/vm/00000000-0000-0000-0000-000000000000-7"
device = ""
control = ""
  platform-feature-multiprocessor-suspend = "1"
error = ""
memory = ""
  target = "1048576"
guest = ""
hvmpv = ""
data = ""
description = ""
console = ""
  limit = "1048576"
  type = "xenconsoled"
domid = "0"
cpu = ""
  0 = ""
   availability = "online"
name = "Domain-0"

xen3 ~ # xenstore-read /local/domain/0/name
Domain-0

xen3 ~ # xenstore-read /local/domain/0/vm
/vm/00000000-0000-0000-0000-000000000000-7

Bug?

- Nathan

</body></email><email><emailId>20111215161223</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-12-15 16:12:23-0400</timestampReceived><subject>Re: [libvirt-users] Qemu restore error</subject><body>


On 12/15/2011 08:48 AM, Dennis Householder wrote:
&gt; Hello,
&gt; 
&gt; I'm not sure if I am having a kvm/qemu issue, a virt-manager issue, or a 
&gt; libvirt issue, so if I am asking the wrong crowd please let me know! In 
&gt; short, restoring some suspended kvm guests via virt-manager is failing 
&gt; because libvirt cannot read the qemu header. I cannot find any 
&gt; documentation on what this means. From virsh's limited documentation I 
&gt; was able to gather that there is probably something wrong with an xml 
&gt; file somewhere, but I cannot find it. Any advice is greatly appreciated!

This is the correct list; the error message comes from libvirt's
qemuDomainSaveImageOpen() method, and implies that you have a corrupted
save file (save files are created by 'virsh save' to a user-specified
location, or by 'virsh managedsave' to a libvirt-maintained location;
the libvirt-guests init script uses virsh managedsave as part of host
shutdown).

&gt; 
&gt; Synopsis:
&gt; I have 5 KVM guests on a Fedora 16 laptop host. I manage them locally 
&gt; through virt-manager. These guests are JUNOS 10.1R1 (installed over 
&gt; FreeBSD 4.1 mini-inst) on a patched bios (SeaBIOS 
&gt; pre-0.6.1-20100805_064324-Compaq8510w). One time I suspended my laptop 
&gt; and the kvm domains were suspended as well. Trying to restore yields the 
&gt; following error:
&gt; 
&gt; Error restoring domain: operation failed: failed to read qemu header

Are you restoring via 'virsh restore path/to/file', or are you just
trying to start the guest with 'virsh start' or a similar action in
virt-manager?

If the former, then path/to/file is indeed corrupt; can you show us the
size of that file, as well as 'od -N 128 -tx1z path/to/file'?

If the latter, then you've uncovered a bug in the managedsave code
(which I will be fixing shortly) - we attempt to detect and unlink
corrupt managedsave files automatically, but in looking at the code, I
see I missed a code path - if the file is corrupt because it is too
short, then we fail to do the unlink(), making the problem perpetual.
If this is the case, then please give me the same output as requested in
the previous paragraph, but using /var/lib/libvirt/qemu/save/&lt;dom&gt;.save
as the path/to/file.

Then, after you have given me the details, you can work around the
problem by doing 'virsh start --force' to force a fresh boot (the save
file is already corrupt, so there is unfortunately no way to get the
runtime state of the guest back to what it was when you suspended your
host); hopefully your guest can fsck and recover gracefully from what
was in the virtual disks at the time of the host suspend.

-- 
Eric Blake   eblake@redhat.com    +1-919-301-3266
Libvirt virtualization library http://libvirt.org


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20111214090549</emailId><senderName>Josip Deanovic</senderName><senderEmail>djosip+news@linuxpages.net</senderEmail><timestampReceived>2011-12-14 09:05:49-0400</timestampReceived><subject>Re: [libvirt-users] acceptable SASL mechanisms/can libvirt authenticate against PAM</subject><body>

On Wednesday 2011-12-14, Dave Allan wrote:
&gt; I was playing with SASL authentication a bit today and I wasn't able
&gt; to get libvirt to authenticate against PAM (or anything else except
&gt; the sasldb, although I didn't try Kerberos).  Does anybody know off
&gt; the top of their head what mechanisms/password check options work?
&gt; I'm trying to figure out if I'm attempting the impossible.
&gt; 
&gt; Dave


Hi Dave,

Here is my working configuration with sql backend. I am using postgres.

mech_list: digest-md5
pwcheck_method: auxprop
auxprop_plugin: sql
sql_engine: pgsql  
sql_hostnames: localhost            
sql_user: qemukvm
sql_passwd: secret   
sql_database: qemukvmdb
sql_select: select password from qemuusers where username = '%u'


To make use of PAM as far as I know you will have to use saslauthd method.

And here is the list of relevant sasl options (I am not sure if it's up to 
date): http://asyd.net/docs/cyrus-options.html


-- 
Josip Deanovic

</body></email><email><emailId>20111222190921</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2011-12-22 19:09:21-0400</timestampReceived><subject>Re: [libvirt-users] [virt-tools-list] error creating NFS storage pool</subject><body>

On 12/16/2011 05:32 PM, Grant Siebrecht wrote:
&gt; Virtual Machine Manager 0.9.0
&gt; OS = Ubuntu 11.10
&gt; I've tried changing permissions on my_nfs_server to 777 with still no luck.
&gt; 
&gt; 
&gt; 
&gt; Error creating pool: Could not start storage pool: cannot open volume
&gt; '/var/lib/libvirt/images/my_nfs_server/.$EXTEND': Permission denied
&gt; 
&gt; Traceback (most recent call last):
&gt;   File "/usr/share/virt-manager/virtManager/asyncjob.py", line 44, in cb_wrapper
&gt;     callback(asyncjob, *args, **kwargs)
&gt;   File "/usr/share/virt-manager/virtManager/createpool.py", line 480, in
&gt; _async_pool_create
&gt;     poolobj = self._pool.install(create=True, meter=meter, build=build)
&gt;   File "/usr/lib/pymodules/python2.7/virtinst/Storage.py", line 489, in install
&gt;     raise RuntimeError(errmsg)
&gt; RuntimeError: Could not start storage pool: cannot open volume
&gt; '/var/lib/libvirt/images/my_nfs_server/.$EXTEND': Permission denied
&gt; 

moving to libvirt-users

What is the .$EXTEND file? Is it a socket or something strange like that?

- Cole

</body></email><email><emailId>20111214091332</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-12-14 09:13:32-0400</timestampReceived><subject>Re: [libvirt-users] acceptable SASL mechanisms/can libvirt authenticate against PAM</subject><body>

On Tue, Dec 13, 2011 at 10:57:25PM -0500, Dave Allan wrote:
&gt; I was playing with SASL authentication a bit today and I wasn't able
&gt; to get libvirt to authenticate against PAM (or anything else except
&gt; the sasldb, although I didn't try Kerberos).  Does anybody know off
&gt; the top of their head what mechanisms/password check options work?
&gt; I'm trying to figure out if I'm attempting the impossible.

If you are configuring SASL for the tcp socket it will refuse to use
SASL mechanisms which do not support encryption, which is all of them
except Kerberos or Digest-MD5.

If you are configuring SASL for the TLS socket it will allow any
SASL mechanism, since TLS provides the encryption

Regards,
Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20111214100713</emailId><senderName>Josip Deanovic</senderName><senderEmail>djosip@linuxpages.org</senderEmail><timestampReceived>2011-12-14 10:07:13-0400</timestampReceived><subject>Re: [libvirt-users] acceptable SASL mechanisms/can libvirt authenticate against PAM</subject><body>

On Wednesday 2011-12-14, Josip Deanovic wrote:
&gt; On Wednesday 2011-12-14, Dave Allan wrote:
&gt; &gt; I was playing with SASL authentication a bit today and I wasn't able
&gt; &gt; to get libvirt to authenticate against PAM (or anything else except
&gt; &gt; the sasldb, although I didn't try Kerberos).  Does anybody know off
&gt; &gt; the top of their head what mechanisms/password check options work?
&gt; &gt; I'm trying to figure out if I'm attempting the impossible.
&gt; &gt; 
&gt; &gt; Dave
&gt; 
&gt; Hi Dave,
&gt; 
&gt; Here is my working configuration with sql backend. I am using postgres.
&gt; 
&gt; mech_list: digest-md5
&gt; pwcheck_method: auxprop
&gt; auxprop_plugin: sql
&gt; sql_engine: pgsql
&gt; sql_hostnames: localhost
&gt; sql_user: qemukvm
&gt; sql_passwd: secret
&gt; sql_database: qemukvmdb
&gt; sql_select: select password from qemuusers where username = '%u'
&gt; 
&gt; 
&gt; To make use of PAM as far as I know you will have to use saslauthd
&gt; method.
&gt; 
&gt; And here is the list of relevant sasl options (I am not sure if it's up
&gt; to date): http://asyd.net/docs/cyrus-options.html


Sorry, I was mistakenly referring to sasl authentication for vnc client with 
sasl support.
However, this configuration might work with libvit with little or no 
modifications. However I never tried to authenticate to libvrit using sasl.


-- 
Josip Deanovic

</body></email><email><emailId>20111214102103</emailId><senderName>Josip Deanovic</senderName><senderEmail>djosip+news@linuxpages.net</senderEmail><timestampReceived>2011-12-14 10:21:03-0400</timestampReceived><subject>Re: [libvirt-users] acceptable SASL mechanisms/can libvirt authenticate against PAM</subject><body>

On Wednesday 2011-12-14, Josip Deanovic wrote:
&gt; On Wednesday 2011-12-14, Dave Allan wrote:
&gt; &gt; I was playing with SASL authentication a bit today and I wasn't able
&gt; &gt; to get libvirt to authenticate against PAM (or anything else except
&gt; &gt; the sasldb, although I didn't try Kerberos).  Does anybody know off
&gt; &gt; the top of their head what mechanisms/password check options work?
&gt; &gt; I'm trying to figure out if I'm attempting the impossible.
&gt; &gt; 
&gt; &gt; Dave
&gt; 
&gt; Hi Dave,
&gt; 
&gt; Here is my working configuration with sql backend. I am using postgres.
&gt; 
&gt; mech_list: digest-md5
&gt; pwcheck_method: auxprop
&gt; auxprop_plugin: sql
&gt; sql_engine: pgsql
&gt; sql_hostnames: localhost
&gt; sql_user: qemukvm
&gt; sql_passwd: secret
&gt; sql_database: qemukvmdb
&gt; sql_select: select password from qemuusers where username = '%u'
&gt; 
&gt; 
&gt; To make use of PAM as far as I know you will have to use saslauthd
&gt; method.
&gt; 
&gt; And here is the list of relevant sasl options (I am not sure if it's up
&gt; to date): http://asyd.net/docs/cyrus-options.html


Sorry, I was mistakenly referring to sasl authentication for vnc client with 
sasl support.
However, this configuration might work with libvit with little or no 
modifications. However I never tried to authenticate to libvrit using sasl.


-- 
Josip Deanovic

</body></email><email><emailId>20111214142751</emailId><senderName>Dave Allan</senderName><senderEmail>dallan@redhat.com</senderEmail><timestampReceived>2011-12-14 14:27:51-0400</timestampReceived><subject>Re: [libvirt-users] acceptable SASL mechanisms/can libvirt authenticate against PAM</subject><body>

On Wed, Dec 14, 2011 at 09:13:32AM +0000, Daniel P. Berrange wrote:
&gt; On Tue, Dec 13, 2011 at 10:57:25PM -0500, Dave Allan wrote:
&gt; &gt; I was playing with SASL authentication a bit today and I wasn't able
&gt; &gt; to get libvirt to authenticate against PAM (or anything else except
&gt; &gt; the sasldb, although I didn't try Kerberos).  Does anybody know off
&gt; &gt; the top of their head what mechanisms/password check options work?
&gt; &gt; I'm trying to figure out if I'm attempting the impossible.
&gt; 
&gt; If you are configuring SASL for the tcp socket it will refuse to use
&gt; SASL mechanisms which do not support encryption, which is all of them
&gt; except Kerberos or Digest-MD5.
&gt; 
&gt; If you are configuring SASL for the TLS socket it will allow any
&gt; SASL mechanism, since TLS provides the encryption

Ah, I left out the most salient detail: I was trying it on the unix rw
socket.  libvirtd.conf says "For non-TCP or TLS sockets, any scheme is
allowed."  The way I read that, I'd expect any scheme to work with the
unix rw socket, is that right?

Dave

</body></email><email><emailId>20111214143401</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-12-14 14:34:01-0400</timestampReceived><subject>Re: [libvirt-users] acceptable SASL mechanisms/can libvirt authenticate against PAM</subject><body>

On Wed, Dec 14, 2011 at 09:27:51AM -0500, Dave Allan wrote:
&gt; On Wed, Dec 14, 2011 at 09:13:32AM +0000, Daniel P. Berrange wrote:
&gt; &gt; On Tue, Dec 13, 2011 at 10:57:25PM -0500, Dave Allan wrote:
&gt; &gt; &gt; I was playing with SASL authentication a bit today and I wasn't able
&gt; &gt; &gt; to get libvirt to authenticate against PAM (or anything else except
&gt; &gt; &gt; the sasldb, although I didn't try Kerberos).  Does anybody know off
&gt; &gt; &gt; the top of their head what mechanisms/password check options work?
&gt; &gt; &gt; I'm trying to figure out if I'm attempting the impossible.
&gt; &gt; 
&gt; &gt; If you are configuring SASL for the tcp socket it will refuse to use
&gt; &gt; SASL mechanisms which do not support encryption, which is all of them
&gt; &gt; except Kerberos or Digest-MD5.
&gt; &gt; 
&gt; &gt; If you are configuring SASL for the TLS socket it will allow any
&gt; &gt; SASL mechanism, since TLS provides the encryption
&gt; 
&gt; Ah, I left out the most salient detail: I was trying it on the unix rw
&gt; socket.  libvirtd.conf says "For non-TCP or TLS sockets, any scheme is
&gt; allowed."  The way I read that, I'd expect any scheme to work with the
&gt; unix rw socket, is that right?

It should allow any scheme with UNIX sockets, but I doubt we've
tested that to make sure


Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20111214090913</emailId><senderName>"Hansa"</senderName><senderEmail>mythtv@logic-q.nl</senderEmail><timestampReceived>2011-12-14 09:09:13-0400</timestampReceived><subject>Re: [libvirt-users] Why does libvirt use XML firewall rules?</subject><body>

On 12/12/2011 14:20, Hansa wrote
&gt; Hi there,
&gt; 
&gt; When creating a VM with a persistent virtual network, libvirt creates
&gt; an XML file with firewall definitions and stores it in
&gt; /etc/libvirt/&lt;hypervisor&gt;/networks/. The XML file is (to my knowledge)
&gt; incompatible with iptables-restore. Therefore you can’t manage your
&gt; firewall with other iptables (GUI) tools unless libvirt lets you a)
&gt; import extra rules, b) has an option to export the XML rules into
&gt; iptables-save format or c) something else. If a) , b) or c) is possible
&gt; then this discussion is of course useless and I would be pleased to
&gt; know how it’s done :)
&gt; 
&gt; If not, then let’s get the discussion started.
&gt; IMHO, saving rules into XML instead of using iptables-save is absurd
&gt; since you’ll have to code stuff which is already coded. Also you’ll
&gt; make it incompatible with the tools which are readily available. Why go
&gt; for this approach and what do we get from it?
&gt; 
&gt; Best regards,
&gt; 
&gt; -Hansa

Bump...
Why does libvirt use XML firewall rules?


</body></email><email><emailId>20111208085426</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-12-08 08:54:26-0400</timestampReceived><subject>Re: [libvirt-users] lxc capabilities</subject><body>

On Wed, Dec 07, 2011 at 12:55:44PM -0800, Chris Haumesser wrote:
&gt; I'm experimenting with the libvirt lxc driver, and wondering if there is
&gt; some way to control the capabilities assigned to the container processes.
&gt; 
&gt; With lxc-tools, I can specify a configuration option, lxc.cap.drop,
&gt; which causes the container processes to drop the specified privileges.
&gt; 
&gt; My libvirt containers seem to run with
&gt; cap_sys_module,cap_sys_boot,cap_sys_time,cap_audit_control,cap_mac_admin
&gt; which is rather more permissive than I'd like. In particular,
&gt; cap_sys_boot allows a container to reboot the host machine.

I think you have that the wrong way around. The containers run
*without*  cap_sys_{module,boot,time,audit_control,mac_admin}.
Any of the remaining capabilities we allow should be safe to use
within the context of a container (well ok, we need the UID/GID
namespace stuff to be finished really for this to be safe). But
we certainly block clearly dangerous things like reboot &amp; module
loading

Regards,
Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20111208144813</emailId><senderName>Chris Haumesser</senderName><senderEmail>ch@luciddg.com</senderEmail><timestampReceived>2011-12-08 14:48:13-0400</timestampReceived><subject>Re: [libvirt-users] lxc capabilities</subject><body>

Daniel P. Berrange wrote:
&gt; I think you have that the wrong way around. The containers run
&gt; *without*  cap_sys_{module,boot,time,audit_control,mac_admin}.

Am I misinterpreting the output of getpcaps then? (getpcaps is rather
undocumented).

See: http://pastebin.com/6FkXt66c

Moreover, I opened a virsh console to my helloworld container, typed
'reboot' and the whole host machine rebooted. Yikes!

Or are these bugs in the 0.9.2 codebase that have since been fixed?


-C-

[Attachment #3 (text/html)]

&lt;html&gt;&lt;head&gt;
&lt;meta content="text/html; charset=UTF-8" http-equiv="Content-Type"&gt;
&lt;/head&gt;&lt;body bgcolor="#FFFFFF" text="#000000"&gt;Daniel P. Berrange wrote:
&lt;blockquote cite="mid:20111208085425.GC8493@redhat.com" type="cite"&gt;
  &lt;pre wrap=""&gt;I think you have that the wrong way around. The containers run
&lt;b class="moz-txt-star"&gt;&lt;span class="moz-txt-tag"&gt;*&lt;/span&gt;without&lt;span \
class="moz-txt-tag"&gt;*&lt;/span&gt;&lt;/b&gt;  \
cap_sys_{module,boot,time,audit_control,mac_admin}.&lt;/pre&gt; &lt;/blockquote&gt;
&lt;br&gt;
Am I misinterpreting the output of getpcaps then? (getpcaps is rather 
undocumented).&lt;br&gt;
&lt;br&gt;
See: &lt;a class="moz-txt-link-freetext" \
href="http://pastebin.com/6FkXt66c"&gt;http://pastebin.com/6FkXt66c&lt;/a&gt;&lt;br&gt; &lt;br&gt;
Moreover, I opened a virsh console to my helloworld container, typed 
'reboot' and the whole host machine rebooted. Yikes!&lt;br&gt;
&lt;br&gt;
Or are these bugs in the 0.9.2 codebase that have since been fixed?&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
-C-&lt;br&gt;
&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20111208151441</emailId><senderName>Chris Haumesser</senderName><senderEmail>ch@luciddg.com</senderEmail><timestampReceived>2011-12-08 15:14:41-0400</timestampReceived><subject>Re: [libvirt-users] lxc capabilities</subject><body>

Chris Haumesser wrote:
&gt; Am I misinterpreting the output of getpcaps then? (getpcaps is rather
&gt; undocumented).

Answering my own question, I was misinterpreting the output of getpcaps.
I found the cap_from_text(3) man page, which explained the output format.

I still don't understand why I was able to reboot the host from within a
container, however.



-C-

</body></email><email><emailId>20111208153448</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-12-08 15:34:48-0400</timestampReceived><subject>Re: [libvirt-users] lxc capabilities</subject><body>

On Thu, Dec 08, 2011 at 07:14:41AM -0800, Chris Haumesser wrote:
&gt; Chris Haumesser wrote:
&gt; &gt; Am I misinterpreting the output of getpcaps then? (getpcaps is rather
&gt; &gt; undocumented).
&gt; 
&gt; Answering my own question, I was misinterpreting the output of getpcaps.
&gt; I found the cap_from_text(3) man page, which explained the output format.
&gt; 
&gt; I still don't understand why I was able to reboot the host from within a
&gt; container, however.

Well I just confirmed (the hard way!) that you are correct. It is possible
to reboot the host from inside the container, despire CAP_SYS_REBOOT
being blocked. I'll try &amp; figure out how that's happening/possible...

Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20111208153854</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-12-08 15:38:54-0400</timestampReceived><subject>Re: [libvirt-users] read-only rootfs for lxc containers</subject><body>

On Thu, Dec 08, 2011 at 07:34:13AM -0800, Chris Haumesser wrote:
&gt; And speaking of running out of a shared read-only root, I get the
&gt; following error when I attempt it:
&gt; 
&gt; error: Failed to start domain hw
&gt; error: internal error guest failed to start: PATH=/bin:/sbin TERM=linux
&gt; LIBVIRT_LXC_UUID=38320e75-1ba0-d85a-6138-532a3a66f13d
&gt; LIBVIRT_LXC_NAME=hw /bin/bash
&gt; 2011-12-08 15:31:41.945: 1: info : libvirt version: 0.9.7
&gt; 2011-12-08 15:31:41.945: 1: error : lxcContainerPivotRoot:345 : Failed
&gt; to create /mnt/vmroot/.oldroot: Read-only file system
&gt; 2011-12-08 15:31:41.945: 2666: info : libvirt version: 0.9.7
&gt; 2011-12-08 15:31:41.945: 2666: error : lxcControllerRun:1210 : error
&gt; receiving signal from container: Input/output error

Hmm, so your actual filesystem on the host side is read only ?

I'd not considered that possibilty. When I've done read-only
roots for containers, the host side was always writable, and
then I used  '&lt;readonly/&gt;' in the &lt;filesystem&gt; tag to make
the container see it readoly.


I'll have to think about how to make it work when the host
FS itself is readonly. Probably have to define some location
that is guarenteed to exist, instead of trying to create a
'/.oldroot' location ourselves.

Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20111208154728</emailId><senderName>Chris Haumesser</senderName><senderEmail>ch@luciddg.com</senderEmail><timestampReceived>2011-12-08 15:47:28-0400</timestampReceived><subject>Re: [libvirt-users] read-only rootfs for lxc containers</subject><body>

Daniel P. Berrange wrote:
&gt; Hmm, so your actual filesystem on the host side is read only ?

Yup, mounting a squashfs in RAM.

&gt; I'll have to think about how to make it work when the host
&gt; FS itself is readonly. Probably have to define some location
&gt; that is guarenteed to exist, instead of trying to create a
&gt; '/.oldroot' location ourselves.


I suppose so, yes. What is the purpose of .oldroot? When I switch to a
rw filesystem, I see that .oldroot gets created, but it is just an empty
directory.


Cheers,


-C-

[Attachment #3 (text/html)]

&lt;html&gt;&lt;head&gt;
&lt;meta content="text/html; charset=UTF-8" http-equiv="Content-Type"&gt;
&lt;/head&gt;&lt;body bgcolor="#FFFFFF" text="#000000"&gt;Daniel P. Berrange wrote:
&lt;blockquote cite="mid:20111208153854.GC2062@redhat.com" type="cite"&gt;
  &lt;pre wrap=""&gt;Hmm, so your actual filesystem on the host side is read only ?&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;br&gt;
Yup, mounting a squashfs in RAM.&lt;span style="font-family: monospace;"&gt;&lt;br&gt;
  &lt;br&gt;
&lt;/span&gt;
&lt;pre wrap=""&gt;&lt;blockquote type="cite"&gt;&lt;span&gt;&lt;pre wrap=""&gt;I'll have to think about how \
to make it work when the host FS itself is readonly. Probably have to define some \
location that is guarenteed to exist, instead of trying to create a
'/.oldroot' location ourselves.&lt;/pre&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;/pre&gt;
&lt;br&gt;
I suppose so, yes. What is the purpose of .oldroot? When I switch to a 
rw filesystem, I see that .oldroot gets created, but it is just an empty
 directory.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Cheers,&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
-C-&lt;br&gt;
&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20111207225907</emailId><senderName>Chris Haumesser</senderName><senderEmail>ch@luciddg.com</senderEmail><timestampReceived>2011-12-07 22:59:07-0400</timestampReceived><subject>Re: [libvirt-users] lxc errors on 0.9.7</subject><body>

Here is the configuration on pastebin, in case your mua ate it or you're
viewing the mailman archive: http://pastebin.com/ByWHcb9x.

Chris Haumesser wrote:
&gt; My configuration is very simply:

</body></email><email><emailId>20111207232454</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-12-07 23:24:54-0400</timestampReceived><subject>Re: [libvirt-users] lxc errors on 0.9.7</subject><body>


On 12/07/2011 03:53 PM, Chris Haumesser wrote:
&gt; I'm testing 0.9.7 now with lxc, and get the following error when trying
&gt; to start a container:
&gt; 
&gt; 2011-12-07 22:49:26.293: 1997: error : lxcControllerRun:1158 :
&gt; unsupported configuration: Expected exactly one TTY fd

There have been some lxc fixes in the meantime; can you repeat this test
on 0.9.8-rc2 to see if we have fixed it already?

-- 
Eric Blake   eblake@redhat.com    +1-919-301-3266
Libvirt virtualization library http://libvirt.org


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20111208090601</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-12-08 09:06:01-0400</timestampReceived><subject>Re: [libvirt-users] lxc errors on 0.9.7</subject><body>

On Wed, Dec 07, 2011 at 02:53:41PM -0800, Chris Haumesser wrote:
&gt; I'm testing 0.9.7 now with lxc, and get the following error when trying
&gt; to start a container:
&gt; 
&gt; 2011-12-07 22:49:26.293: 1997: error : lxcControllerRun:1158 :
&gt; unsupported configuration: Expected exactly one TTY fd
&gt; 
&gt; My configuration is very simply:
&gt; 
&gt; &lt;domain type='lxc'&gt;
&gt;   &lt;name&gt;hw&lt;/name&gt;
&gt;   &lt;uuid&gt;38320e75-1ba0-d85a-6138-532a3a66f13d&lt;/uuid&gt;
&gt;   &lt;memory&gt;102400&lt;/memory&gt;
&gt;   &lt;currentMemory&gt;102400&lt;/currentMemory&gt;
&gt;   &lt;vcpu&gt;1&lt;/vcpu&gt;
&gt;   &lt;os&gt;
&gt;     &lt;type arch='x86_64'&gt;exe&lt;/type&gt;
&gt;     &lt;init&gt;/bin/bash&lt;/init&gt;
&gt;   &lt;/os&gt;
&gt;   &lt;clock offset='utc'/&gt;
&gt;   &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
&gt;   &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
&gt;   &lt;on_crash&gt;destroy&lt;/on_crash&gt;
&gt;   &lt;devices&gt;
&gt;     &lt;emulator&gt;/usr/lib/libvirt/libvirt_lxc&lt;/emulator&gt;
&gt;     &lt;console type='pty'&gt;
&gt;       &lt;target type='lxc' port='0'/&gt;
&gt;     &lt;/console&gt;
&gt;   &lt;/devices&gt;
&gt; &lt;/domain&gt;
&gt; 
&gt; If I try to add any different type of console, I get an error that only
&gt; pty consoles are supported.

Nothing, only type='pty' is supported for consoles in LXC. The other
console types like tcp, udp, fifo, etc are only supported by QEMU

Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20111208143848</emailId><senderName>Chris Haumesser</senderName><senderEmail>ch@luciddg.com</senderEmail><timestampReceived>2011-12-08 14:38:48-0400</timestampReceived><subject>Re: [libvirt-users] lxc errors on 0.9.7</subject><body>

Daniel P. Berrange wrote:
&gt; Nothing, only type='pty' is supported for consoles in LXC.

Oops, I had accidentally pasted the wrong (experimental) config.

I get the exact same error when I use type='pty'.

See: http://pastebin.com/gC946Y0m

Is it possible that the libvirt_lxc emulator is getting called with a
missing or incorrect value for its -c argument?

It did work for me under 0.9.2. I had trouble building 9.6 and 9.8-rc2
deb packages for squeeze, so did not test those versions yet.


-C-
 

</body></email><email><emailId>20111208122730</emailId><senderName>"Hansa"</senderName><senderEmail>mythtv@logic-q.nl</senderEmail><timestampReceived>2011-12-08 12:27:30-0400</timestampReceived><subject>Re: [libvirt-users] Custom firewall rules</subject><body>

Nobody?

 

Most firewall tools I looked at break libvirts’ invoked rules because they
create their own rule file. Is there one that collaborates with libvirts’
(xml) format?

 

-Hansa

 

From: libvirt-users-bounces@redhat.com
[mailto:libvirt-users-bounces@redhat.com] On Behalf Of Hansa
Sent: woensdag 7 december 2011 14:57
To: libvirt-users@redhat.com
Subject: [libvirt-users] Custom firewall rules

 

Hi,

 

Normally I’m using webmin to manage my firewall. Webmin fw however breaks
the iptable rules invoked by libvirt.

Is there a fw tool (beside iptables console command) which can be used
without breaking libvirts’ rules?

 

-Hansa

 

 

 


[Attachment #3 (text/html)]

&lt;META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1"&gt;
&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;&lt;head&gt;&lt;meta name=Generator content="Microsoft \
Word 12 (filtered medium)"&gt;&lt;style&gt;&lt;!-- /* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-priority:99;
	mso-style-link:"Balloon Text Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-priority:99;
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";}
span.EmailStyle19
	{mso-style-type:personal;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
span.EmailStyle20
	{mso-style-type:personal-reply;
	font-family:"Calibri","sans-serif";
	color:#1F497D;}
.MsoChpDefault
	{mso-style-type:export-only;
	font-size:10.0pt;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:70.85pt 70.85pt 70.85pt 70.85pt;}
div.WordSection1
	{page:WordSection1;}
--&gt;&lt;/style&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapelayout v:ext="edit"&gt;
&lt;o:idmap v:ext="edit" data="1" /&gt;
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;&lt;/head&gt;&lt;body lang=NL link=blue vlink=purple&gt;&lt;div \
class=WordSection1&gt;&lt;p class=MsoNormal&gt;&lt;span \
style='color:#1F497D'&gt;Nobody?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
style='color:#1F497D'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US \
style='color:#1F497D'&gt;Most firewall tools I looked at break libvirts’ invoked \
rules because they create their own rule file. Is there one that collaborates with \
libvirts’ (xml) format?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US style='color:#1F497D'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US style='color:#1F497D'&gt;-Hansa&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US style='color:#1F497D'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;div \
style='border:none;border-left:solid blue 1.5pt;padding:0cm 0cm 0cm 4.0pt'&gt;&lt;div&gt;&lt;div \
style='border:none;border-top:solid #B5C4DF 1.0pt;padding:3.0pt 0cm 0cm 0cm'&gt;&lt;p \
class=MsoNormal&gt;&lt;b&gt;&lt;span lang=EN-US \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;From:&lt;/span&gt;&lt;/b&gt;&lt;span \
lang=EN-US style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt; \
libvirt-users-bounces@redhat.com [mailto:libvirt-users-bounces@redhat.com] &lt;b&gt;On \
Behalf Of &lt;/b&gt;Hansa&lt;br&gt;&lt;b&gt;Sent:&lt;/b&gt; woensdag 7 december 2011 14:57&lt;br&gt;&lt;b&gt;To:&lt;/b&gt; \
libvirt-users@redhat.com&lt;br&gt;&lt;b&gt;Subject:&lt;/b&gt; [libvirt-users] Custom firewall \
rules&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span lang=EN-US&gt;Hi,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;Normally \
I’m using webmin to manage my firewall. Webmin fw however breaks the iptable \
rules invoked by libvirt.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;Is \
there a fw tool (beside iptables console command) which can be used without breaking \
libvirts’ rules?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;-Hansa&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20111208150802</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-12-08 15:08:02-0400</timestampReceived><subject>Re: [libvirt-users] lxc errors on 0.9.7</subject><body>

On Thu, Dec 08, 2011 at 09:06:01AM +0000, Daniel P. Berrange wrote:
&gt; On Wed, Dec 07, 2011 at 02:53:41PM -0800, Chris Haumesser wrote:
&gt; &gt; I'm testing 0.9.7 now with lxc, and get the following error when trying
&gt; &gt; to start a container:
&gt; &gt; 
&gt; &gt; 2011-12-07 22:49:26.293: 1997: error : lxcControllerRun:1158 :
&gt; &gt; unsupported configuration: Expected exactly one TTY fd
&gt; &gt; 
&gt; &gt; My configuration is very simply:
&gt; &gt; 
&gt; &gt; &lt;domain type='lxc'&gt;
&gt; &gt;   &lt;name&gt;hw&lt;/name&gt;
&gt; &gt;   &lt;uuid&gt;38320e75-1ba0-d85a-6138-532a3a66f13d&lt;/uuid&gt;
&gt; &gt;   &lt;memory&gt;102400&lt;/memory&gt;
&gt; &gt;   &lt;currentMemory&gt;102400&lt;/currentMemory&gt;
&gt; &gt;   &lt;vcpu&gt;1&lt;/vcpu&gt;
&gt; &gt;   &lt;os&gt;
&gt; &gt;     &lt;type arch='x86_64'&gt;exe&lt;/type&gt;
&gt; &gt;     &lt;init&gt;/bin/bash&lt;/init&gt;
&gt; &gt;   &lt;/os&gt;
&gt; &gt;   &lt;clock offset='utc'/&gt;
&gt; &gt;   &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
&gt; &gt;   &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
&gt; &gt;   &lt;on_crash&gt;destroy&lt;/on_crash&gt;
&gt; &gt;   &lt;devices&gt;
&gt; &gt;     &lt;emulator&gt;/usr/lib/libvirt/libvirt_lxc&lt;/emulator&gt;
&gt; &gt;     &lt;console type='pty'&gt;
&gt; &gt;       &lt;target type='lxc' port='0'/&gt;
&gt; &gt;     &lt;/console&gt;
&gt; &gt;   &lt;/devices&gt;
&gt; &gt; &lt;/domain&gt;
&gt; &gt; 
&gt; &gt; If I try to add any different type of console, I get an error that only
&gt; &gt; pty consoles are supported.
&gt; 
&gt; Nothing, only type='pty' is supported for consoles in LXC. The other
&gt; console types like tcp, udp, fifo, etc are only supported by QEMU

Actually it is a stupid mistake on my part, which affects LXC
guests which do not have any &lt;filesystem&gt; element. The patch
is here:

https://www.redhat.com/archives/libvir-list/2011-December/msg00409.html


Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20111208153627</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-12-08 15:36:27-0400</timestampReceived><subject>Re: [libvirt-users] tmpfs mounts for lxc container</subject><body>

On Thu, Dec 08, 2011 at 07:30:28AM -0800, Chris Haumesser wrote:
&gt; I intend to share a single read-only filesystem root among a number of
&gt; LXC containers.
&gt; 
&gt; With lxc-tools, I can specify tmpfs bind mounts within the container,
&gt; for directories that need to be writable, like /var/run and /var/lock.
&gt; 
&gt; Is there a simple way to do this with libvirt, or do I need to mount the
&gt; tmpfs in the host first, and specify it as a filesystem in the xml?

At this point in time you need to create the FS in the host and export
it via the XML

Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20111208155349</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-12-08 15:53:49-0400</timestampReceived><subject>Re: [libvirt-users] read-only rootfs for lxc containers</subject><body>

On Thu, Dec 08, 2011 at 07:47:28AM -0800, Chris Haumesser wrote:
&gt; Daniel P. Berrange wrote:
&gt; &gt; Hmm, so your actual filesystem on the host side is read only ?
&gt; 
&gt; Yup, mounting a squashfs in RAM.
&gt; 
&gt; &gt; I'll have to think about how to make it work when the host
&gt; &gt; FS itself is readonly. Probably have to define some location
&gt; &gt; that is guarenteed to exist, instead of trying to create a
&gt; &gt; '/.oldroot' location ourselves.
&gt; 
&gt; 
&gt; I suppose so, yes. What is the purpose of .oldroot? When I switch to a
&gt; rw filesystem, I see that .oldroot gets created, but it is just an empty
&gt; directory.

It is used as an intermediate temporary location when we pivot from
one root filesystem to another, so you shouldn't expect to see anything
there. We just need a directory somewhere to pivot on, and chose to
use /.oldroot

Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20111208162119</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-12-08 16:21:19-0400</timestampReceived><subject>Re: [libvirt-users] lxc capabilities</subject><body>

On Thu, Dec 08, 2011 at 03:34:48PM +0000, Daniel P. Berrange wrote:
&gt; On Thu, Dec 08, 2011 at 07:14:41AM -0800, Chris Haumesser wrote:
&gt; &gt; Chris Haumesser wrote:
&gt; &gt; &gt; Am I misinterpreting the output of getpcaps then? (getpcaps is rather
&gt; &gt; &gt; undocumented).
&gt; &gt; 
&gt; &gt; Answering my own question, I was misinterpreting the output of getpcaps.
&gt; &gt; I found the cap_from_text(3) man page, which explained the output format.
&gt; &gt; 
&gt; &gt; I still don't understand why I was able to reboot the host from within a
&gt; &gt; container, however.
&gt; 
&gt; Well I just confirmed (the hard way!) that you are correct. It is possible
&gt; to reboot the host from inside the container, despire CAP_SYS_REBOOT
&gt; being blocked. I'll try &amp; figure out how that's happening/possible...

It is obvious in retrospect. If you have a container which is sharing
the host OS's root filesystem, then it can see the host's /dev which
contains a /dev/initctrl FIFO pipe. The 'reboot' command can tell the
host OS to shutdown via that pipe, thus lack of CAP_SYS_REBOOT is
irrelevant.

Since this is a FIFO and not a blockdev/chardev we can't use cgroups
to prevent access to /dev/initctrl. The only reliable way is to wait
for the kernel's user namespace stuff.

Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20111209121631</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-12-09 12:16:31-0400</timestampReceived><subject>[libvirt-users] FYI: SpecVirt results using libvirt + KVM</subject><body>

Some folks may be aware of the SpecVirt benchmark, where KVM is giving
the competition something to worry about :-)

    http://www.spec.org/virt_sc2010/results/

&gt;From the POV of libvirt uses though, there has been one annoyance with
the previously submitted results though, in that they have been invoking
the KVM command line directly. This has made it harder for people who are
deploying KVM using libvirt to replicate the optimal configurations.

I'm pleased to be able to point out that the latest result published for
KVM by IBM has in fact been done using libvirt! You can clearly see how
the guests are being configured with libvirt and the results demonstrate
that using libvirt to manage KVM does not involve sacrificing any of the
performance that KVM offers:

    http://www.spec.org/virt_sc2010/results/res2011q4/

This can only continue to get better as our communities work together
to add more performance related features to both libvirt and KVM :-)

Regards,
Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20111209153517</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-12-09 15:35:17-0400</timestampReceived><subject>Re: [libvirt-users] http://libvirt.org/archdomain.html - page is empty</subject><body>


On 12/09/2011 05:57 AM, pitnvrsk@rambler.ru wrote:
&gt; Hello.
&gt; 
&gt; I have found in section
&gt; 
&gt; Architecture --&gt;Domain management architecture
&gt; 
&gt; an empty page.
&gt; 
&gt; http://libvirt.org/archdomain.html

Yes, and this means that someone needs to volunteer to help write
content for the page.  A good candidate for information to stick here
would be the lifecycle of a domain, and a comparison of transient and
persistent domains.  Perhaps a good starting point for this page would be:

http://libvirt.org/guide/html/Application_Development_Guide-Guest_Domains-Lifecycle.html

Would anyone care to help contribute here?

-- 
Eric Blake   eblake@redhat.com    +1-919-301-3266
Libvirt virtualization library http://libvirt.org


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20111210074855</emailId><senderName>Kevin</senderName><senderEmail>libvirt@allyourspam.arebelongtous.com</senderEmail><timestampReceived>2011-12-10 07:48:55-0400</timestampReceived><subject>[libvirt-users] Issues with nwfilter rules</subject><body>

Hi All,

I have two kvm guests running with a bridged configuration bound 
separately to br0 and br1 on my Fedora 15 host.  I'm attempting to create 
some nwfilter rules on br1 and am running into a bunch of problems that 
have me scratching my head.

libvirt version: 0.8.8-7

What I've noticed on the second host is as follows:
- Most all nwfilter rules that I create for the host on br1 don't
work as I would expect.  If I create a rule for TCP dest port 22
with direction set to 'in', I would expect I could connect to the
host via SSH from another host, but I only see a SYN and not a full 
connection.  If I set the direction to 'inout', SSH seems to work.
- A nwfilter rule for UDP dest port 53 with direction set to 'out' or 
'inout' doesn't allow lookups to an outside DNS server.
- In the configuration of one VM, the source Virtual network device
lists "Host device vnet0 (Bridge 'br0') and the other lists "Host
device eth1 (Bridge 'br1')".  I don't see anything different in the
two hosts XML configuration files that describe the difference, but
I'm concerned that the second VM on br1 is misconfigured.

I notice a few iptables rules with "PHYSDEV match --physdev-in vnet1" 
listed in them, should these really read "PHYSDEV match --physdev-in br1" 
given the configuration virt-manager is reporting?

I would appreciate any pointers.

-Kevin

</body></email><email><emailId>20111213170613</emailId><senderName>"Jean-Baptiste Rouault"</senderName><senderEmail>jean-baptiste.rouault@diateam.net</senderEmail><timestampReceived>2011-12-13 17:06:13-0400</timestampReceived><subject>[libvirt-users] Thread-safety issues with vbox driver ?</subject><body>

Hi,

I'm experiencing weird things with the vbox driver when using multiple threads.
Following is the snippet of code I experience problems with

/*****************************************************/
#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;pthread.h&gt;
#include &lt;libvirt/libvirt.h&gt;

void *create_and_destroy(void *arg)
{
    virDomainPtr dom = (virDomainPtr)arg;

    char buf[VIR_UUID_STRING_BUFLEN];
    virDomainGetUUIDString(dom, buf);
    
    if (virDomainCreate(dom) != 0) {
        printf("failed to start %s\n", buf);
        goto end;
    }
    printf("%s started\n", buf);

    if (virDomainDestroy(dom) != 0) {
        printf("failed to destroy %s\n", buf);
    }
    printf("%s destroyed\n", buf);

end:
    virDomainFree(dom);
    pthread_exit(NULL);
}

int main(int argc, char **argv)
{
    virConnectPtr conn = virConnectOpen("vbox:///session");
    
    int i;
    int count = virConnectNumOfDefinedDomains(conn);
    char **names = malloc(count * sizeof(char *));
    virConnectListDefinedDomains(conn, names, count);
    virDomainPtr *doms = malloc(count * sizeof(virDomainPtr));
    for (i = 0 ; i &lt; count ; ++i) {
        doms[i] = virDomainLookupByName(conn, names[i]);
    }

    pthread_t *threads = malloc(count * sizeof(pthread_t));
    pthread_attr_t attr;
    pthread_attr_init(&amp;attr);
    pthread_attr_setdetachstate(&amp;attr, PTHREAD_CREATE_JOINABLE);

    for (i = 0 ; i &lt; count ; ++i) {
        pthread_create(&amp;threads[i], &amp;attr, create_and_destroy, (void *)doms[i]);
    }

    pthread_attr_destroy(&amp;attr);
    for (i = 0 ; i &lt; count ; ++i) {
        pthread_join(threads[i], NULL);
    }

    virConnectClose(conn);

    pthread_exit(NULL);
}
/************************************************/

Here is the output of the program with 2 defined domains:
&gt; libvir: VBOX error : operation failed: OpenRemoteSession/LaunchVMProcess failed, \
&gt; domain can't be started failed to start c538c89a-70da-42ab-a88a-5aeb15698c12
&gt; 034cf837-abe7-4c48-8373-0ddcf480d416 started
&gt; 034cf837-abe7-4c48-8373-0ddcf480d416 destroyed

Sometimes the first domain really fails to start, but sometimes it starts correctly \
but libvirt reports an error. Sometimes domains aren't destroyed but libvirt reports \
no error at all. If there is only one domain, no problem occurs at all. I also tried \
the same code (ie with multiple domains) but with only one thread and it works well.

I managed to reproduce these issues with libvirt 0.9.4, 0.9.7, using VirtualBox 4.0 \
and 4.1.

-- 
Jean-Baptiste ROUAULT
Ingénieur R&amp;D - diateam : Architectes de l'information
Phone : +33 (0)9 53 16 02 70 Fax : +33 (0)2 98 050 051


</body></email><email><emailId>20111213220227</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-12-13 22:02:27-0400</timestampReceived><subject>Re: [libvirt-users] libvirt0.9.7.tar.gz installation cannot start libvirtd?</subject><body>


On 12/13/2011 12:07 AM, �� ������ wrote:
&gt; Today i install libvirt 0.9.7 , untar and install wit "./configure \
&gt; --prefix-/usr/local/libvirt  --with-esx", then " make" "make install" ,and i make a \
&gt; link "ln -s /usr/local/libvirt/bin/virsh  /usr/bin/virsh" , so i can use virsh . 
&gt; But i cannot start libvirtd ,when i use "service libvirtd start/status.." ,it \
&gt; returns "libvirtd:unrecognized service". I found a libvirtd file in  /usr/sbin/.

'service' expects things to be installed in particular locations; your
use of --prefix=/usr/local/libvirt violated those assumptions.  While
you "fixed" things for /usr/bin/virsh, there's a lot more files you'd
have to link into place if you want to match the default layout of the
libvirt binary package that came with RHEL that you are trying to
upgrade.  If you use libvirt.git, you can use './autogen.sh --system' to
pre-populate all of the configure arguments to match the RHEL defaults
(and even if you don't build libvirt.git, but from a tarball, then
looking at what autogen.sh does can prove useful).

Also, if you self-build libvirt, you may want to be sure that you
include the same RHEL-specific patches as in the distro's package, so
that you don't inadvertently lose the benefits of RHEL's efforts in
providing a stable product.

&gt; 
&gt; Could someone help to resolve the problem ?

You may want to consider opening a help ticket with Red Hat, and/or
upgrading to RHEL 6.2.

&gt; 
&gt; Thanks all
&gt; 
&gt; Best regards
&gt; ---------------------------------------------------------------------------------------------------
&gt;  Confidentiality Notice: The information contained in this e-mail and any \
&gt; accompanying attachment(s) 

It's generally considered poor netiquette to send disclaimers to
publicly-archived lists, where they cannot be enforced.  You may want to
consider sending from an alternate email account.

-- 
Eric Blake   eblake@redhat.com    +1-919-301-3266
Libvirt virtualization library http://libvirt.org


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20111213232411</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-12-13 23:24:11-0400</timestampReceived><subject>Re: [libvirt-users] Libvirt filterref magic</subject><body>

On Tue, Dec 13, 2011 at 11:18:35PM +0100, zz elle wrote:
&gt; Hi everyone,
&gt; 
&gt; 
&gt; When i start a libvirt domain (on KVM) with network filtering (using
&gt; filterref clean-traffic for example), the filter works !
&gt; But ... i don't understand how/why it works :(
&gt; Indeed when i look at ebtables -L iptables-save &amp; arptables-save (and KVM
&gt; command),
&gt; I see no filtering rules (which is surprising because clean-traffic
&gt; requires at least ebtables to be installed).

You want to look at 'ebtables -t nat -L' not a plain 'ebtables -L'

Regards,
Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20111214092222</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-12-14 09:22:22-0400</timestampReceived><subject>Re: [libvirt-users] Why does libvirt use XML firewall rules?</subject><body>

On Mon, Dec 12, 2011 at 02:19:38PM +0100, Hansa wrote:
&gt; Hi there,
&gt; 
&gt;  
&gt; 
&gt; When creating a VM with a persistent virtual network, libvirt creates an XML
&gt; file with firewall definitions and stores it in
&gt; /etc/libvirt/&lt;hypervisor&gt;/networks/. The XML file is (to my knowledge)
&gt; incompatible with iptables-restore. Therefore you can ’t manage your firewall
&gt; with other iptables (GUI) tools unless libvirt lets you a) import extra
&gt; rules, b) has an option to export the XML rules into iptables-save format or
&gt; c) something else. If a) , b) or c) is possible then this discussion is of
&gt; course useless and I would be pleased to know how it ’s done :)
&gt; 
&gt; If not, then let ’s get the discussion started.
&gt; 
&gt; IMHO, saving rules into XML instead of using iptables-save is absurd since
&gt; you ’ll have to code stuff which is already coded. Also you ’ll make it
&gt; incompatible with the tools which are readily available. Why go for this
&gt; approach and what do we get from it?

The core goal of libvirt is to provide data formats which are independent
of any particular implementation, so that they are portable across all
hypervisors / OS / releases. If we uses iptables CLI as a data format,
this would not be portable to Windows, BSD, OS-X. It would not even be
portable to future Linux which may use the firewalld daemon over DBus
instead of direct iptables rule manipulation.

Furthermore the Fedora iptables-save/restore impl as it stands is really
an unfixably broken design since it is designed around the idea of a
statically configured firewall. Back in the real world, firewalls need
to really dynamically change as services change on the host. This is
why Fedora is aiming to kill it off by creating firewalld

Regards,
Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20111214135722</emailId><senderName>Jorge Somavilla</senderName><senderEmail>somavilla@dit.upm.es</senderEmail><timestampReceived>2011-12-14 13:57:22-0400</timestampReceived><subject>[libvirt-users] Temporary use of disk space when deploying KVM with qcow2 ?</subject><body>

Hello,

I'm using libvirt to deploy a series of 7 KVM (in qcow2 format)
sequentially. The base image of the qcow2 is an ubuntu server of around
1.6GB.

The environment where i am doing this is a Live USB Ubuntu with a
persistence file (so that changes made remain).


So, the problem:

* If the persistence file (i.e. free disk space in the live ubuntu) is up
to around 1.6GB, the qemu process of launching the first one of the KVM
gets stuck, and a few seconds later an Ubuntu message pops up saying there
is no disk space left.

* If the persistence file is a bit bigger (100 MB more), it can launch the
7 KVM machines without any disk space problems.


This would suggest that during the deployment of one virtual machine, there
is a short period of time where a big amount of disk space (similar to the
size of the base image) is used (even if i am using qcow2 vms) and
afterwards released, so it can be used to launch the second vm, released,
used for the third, and so on.

If this is correct, i would like to know who is using that space, since my
intention would be to, if possible, redirect this temporary disk usage to a
RAM filesystem such as tmpfs, so that i don't need such a huge persistence
file in the USB.


I'm aware that this might be related to qemu-kvm rather than to
libvirtitself, but i can't find information about it and i would
appreciate if
anyone could point me in the right direction. More details or clarification
can be provided if needed.

Best regards,

Jorge

[Attachment #3 (text/html)]

&lt;div class="ajy"&gt;&lt;img class="ajz" id=":1sz" tabindex="0" src="images/cleardot.gif" \
alt=""&gt;&lt;/div&gt;Hello,&lt;br&gt;&lt;br&gt;I'm using &lt;span class="il"&gt;libvirt&lt;/span&gt; to deploy a \
series of 7 KVM (in qcow2 format) sequentially. The base image of the qcow2 is an \
ubuntu server of around 1.6GB.&lt;br&gt;

&lt;br&gt;The environment where i am doing this is a Live USB Ubuntu with a persistence \
file (so that changes made remain).&lt;br&gt; &lt;br&gt;&lt;br&gt;So, the problem:&lt;br&gt;&lt;br&gt;* If the \
persistence file (i.e. free disk  space in the live ubuntu) is up to around 1.6GB, \
the qemu process of  launching the first one of the KVM gets stuck, and a few seconds \
later  an Ubuntu message pops up saying there is no disk space left.&lt;br&gt;
&lt;br&gt;* If the persistence file is a bit bigger (100 MB more), it can launch the 7 KVM \
machines without any disk space problems.&lt;br&gt;&lt;br&gt;&lt;br&gt;This  would suggest that during \
the deployment of one virtual machine, there  is a short period of time where a big \
amount of disk space (similar to  the size of the base image) is used (even if i am \
using qcow2 vms) and  afterwards released, so it can be used to launch the second vm, \
 released, used for the third, and so on.&lt;br&gt;
&lt;br&gt;If this is correct, i would like to know who is using that space, 
since my intention would be to, if possible, redirect this temporary 
disk usage to a RAM filesystem such as tmpfs, so that i don't need such a
 huge persistence file in the USB.&lt;br&gt;
&lt;br&gt;&lt;br&gt;I'm aware that this might be related to qemu-kvm rather than to &lt;span \
class="il"&gt;libvirt&lt;/span&gt;  itself, but i can't find information about it and i \
would appreciate if  anyone could point me in the right direction. More details or 
clarification can be provided if needed.&lt;br&gt;
&lt;br&gt;Best regards,&lt;div class="yj6qo ajU"&gt;&lt;div id=":1tc" class="ajR" tabindex="0"&gt;&lt;img \
class="ajT" src="images/cleardot.gif"&gt;&lt;/div&gt;&lt;/div&gt;&lt;span class="HOEnZb adL"&gt;&lt;font \
color="#888888"&gt;&lt;br&gt;Jorge&lt;/font&gt;&lt;/span&gt;



</body></email><email><emailId>20111214173913</emailId><senderName>Dave Allan</senderName><senderEmail>dallan@redhat.com</senderEmail><timestampReceived>2011-12-14 17:39:13-0400</timestampReceived><subject>Re: [libvirt-users] acceptable SASL mechanisms/can libvirt authenticate against PAM</subject><body>

On Wed, Dec 14, 2011 at 11:07:13AM +0100, Josip Deanovic wrote:
&gt; On Wednesday 2011-12-14, Josip Deanovic wrote:
&gt; &gt; On Wednesday 2011-12-14, Dave Allan wrote:
&gt; &gt; &gt; I was playing with SASL authentication a bit today and I wasn't able
&gt; &gt; &gt; to get libvirt to authenticate against PAM (or anything else except
&gt; &gt; &gt; the sasldb, although I didn't try Kerberos).  Does anybody know off
&gt; &gt; &gt; the top of their head what mechanisms/password check options work?
&gt; &gt; &gt; I'm trying to figure out if I'm attempting the impossible.
&gt; &gt; &gt; 
&gt; &gt; &gt; Dave
&gt; &gt; 
&gt; &gt; Hi Dave,
&gt; &gt; 
&gt; &gt; Here is my working configuration with sql backend. I am using postgres.
&gt; &gt; 
&gt; &gt; mech_list: digest-md5
&gt; &gt; pwcheck_method: auxprop
&gt; &gt; auxprop_plugin: sql
&gt; &gt; sql_engine: pgsql
&gt; &gt; sql_hostnames: localhost
&gt; &gt; sql_user: qemukvm
&gt; &gt; sql_passwd: secret
&gt; &gt; sql_database: qemukvmdb
&gt; &gt; sql_select: select password from qemuusers where username = '%u'
&gt; &gt; 
&gt; &gt; 
&gt; &gt; To make use of PAM as far as I know you will have to use saslauthd
&gt; &gt; method.
&gt; &gt; 
&gt; &gt; And here is the list of relevant sasl options (I am not sure if it's up
&gt; &gt; to date): http://asyd.net/docs/cyrus-options.html
&gt; 
&gt; 
&gt; Sorry, I was mistakenly referring to sasl authentication for vnc client with 
&gt; sasl support.
&gt; However, this configuration might work with libvit with little or no 
&gt; modifications. However I never tried to authenticate to libvrit using sasl.

Good info nonetheless, thanks.

Dave

&gt; -- 
&gt; Josip Deanovic
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20111214213854</emailId><senderName></senderName><senderEmail>libvirt</senderEmail><timestampReceived>2011-12-14 21:38:54-0400</timestampReceived><subject>Re: [libvirt-users] Adding a public static IP address to the guest</subject><body>

The easiest way that I found to do this is to configure a bridge on your 
physical host's NIC, and then configure the KVM guest to use the shared 
device.

I used the following general howto to originally get this set up:

http://www.cyberciti.biz/faq/rhel-linux-kvm-virtualization-bridged-networking-with-libvirt/

-Kevin

On Wed, 14 Dec 2011, Sudheer Satyanarayana wrote:

&gt; Hello,
&gt;
&gt; The host runs on CentOS 6. I have installed a guest, CentOS 5.7, using 
&gt; libvirt.
&gt;
&gt; I am having difficulty understanding how to assign a public static IP address 
&gt; to the guest. From what I understand by reading the Wiki, I think I require 
&gt; routed mode.
&gt;
&gt; The ISP has provided a 'portable' IP routed to the VLAN of our servers. I 
&gt; want to assign this IP address to the guest.  From the virtual machine 
&gt; hardware details window, I see that "Virtual network 'default' : NAT" is 
&gt; selected for the source device field.
&gt;
&gt; Can someone offer a helping hand and instruct and educate me on how to 
&gt; proceed from here?
&gt;
&gt; Thanks.
&gt;
&gt;
&gt; -- 
&gt;
&gt; With warm regards,
&gt; Sudheer. S
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

</body></email><email><emailId>20111215183546</emailId><senderName>Dennis Householder</senderName><senderEmail>dhouseholder@telecomsys.com</senderEmail><timestampReceived>2011-12-15 18:35:46-0400</timestampReceived><subject>Re: [libvirt-users] Qemu restore error</subject><body>

Thanks for the prompt response Eric! The error I first posted was output 
from virt-manager after selecting restore on the GUI, and it was 
perpetual. The save files were 0 bytes in size, which probably qualifies 
them as being 'too short' :-). 'virsh start --force-boot' recovered the VMs.

For completeness sake, here is the 'virsh restore' output on the 0-byte 
savefile, as requested. The od command naturally returned all zeros.

virsh restore /var/lib/libvirt/qemu/save/JEMU-R3.save
error: Failed to restore domain from /var/lib/libvirt/qemu/save/JEMU-R3.save
error: operation failed: failed to read qemu header

Thanks for your help!

Dennis


On 12/15/2011 11:12 AM, Eric Blake wrote:
&gt; On 12/15/2011 08:48 AM, Dennis Householder wrote:
&gt; &gt; Hello,
&gt; &gt; 
&gt; &gt; I'm not sure if I am having a kvm/qemu issue, a virt-manager issue, or a
&gt; &gt; libvirt issue, so if I am asking the wrong crowd please let me know! In
&gt; &gt; short, restoring some suspended kvm guests via virt-manager is failing
&gt; &gt; because libvirt cannot read the qemu header. I cannot find any
&gt; &gt; documentation on what this means. From virsh's limited documentation I
&gt; &gt; was able to gather that there is probably something wrong with an xml
&gt; &gt; file somewhere, but I cannot find it. Any advice is greatly appreciated!
&gt; This is the correct list; the error message comes from libvirt's
&gt; qemuDomainSaveImageOpen() method, and implies that you have a corrupted
&gt; save file (save files are created by 'virsh save' to a user-specified
&gt; location, or by 'virsh managedsave' to a libvirt-maintained location;
&gt; the libvirt-guests init script uses virsh managedsave as part of host
&gt; shutdown).
&gt; 
&gt; &gt; Synopsis:
&gt; &gt; I have 5 KVM guests on a Fedora 16 laptop host. I manage them locally
&gt; &gt; through virt-manager. These guests are JUNOS 10.1R1 (installed over
&gt; &gt; FreeBSD 4.1 mini-inst) on a patched bios (SeaBIOS
&gt; &gt; pre-0.6.1-20100805_064324-Compaq8510w). One time I suspended my laptop
&gt; &gt; and the kvm domains were suspended as well. Trying to restore yields the
&gt; &gt; following error:
&gt; &gt; 
&gt; &gt; Error restoring domain: operation failed: failed to read qemu header
&gt; Are you restoring via 'virsh restore path/to/file', or are you just
&gt; trying to start the guest with 'virsh start' or a similar action in
&gt; virt-manager?
&gt; 
&gt; If the former, then path/to/file is indeed corrupt; can you show us the
&gt; size of that file, as well as 'od -N 128 -tx1z path/to/file'?
&gt; 
&gt; If the latter, then you've uncovered a bug in the managedsave code
&gt; (which I will be fixing shortly) - we attempt to detect and unlink
&gt; corrupt managedsave files automatically, but in looking at the code, I
&gt; see I missed a code path - if the file is corrupt because it is too
&gt; short, then we fail to do the unlink(), making the problem perpetual.
&gt; If this is the case, then please give me the same output as requested in
&gt; the previous paragraph, but using /var/lib/libvirt/qemu/save/&lt;dom&gt;.save
&gt; as the path/to/file.
&gt; 
&gt; Then, after you have given me the details, you can work around the
&gt; problem by doing 'virsh start --force' to force a fresh boot (the save
&gt; file is already corrupt, so there is unfortunately no way to get the
&gt; runtime state of the guest back to what it was when you suspended your
&gt; host); hopefully your guest can fsck and recover gracefully from what
&gt; was in the virtual disks at the time of the host suspend.
&gt; 

CONFIDENTIALITY NOTICE: The information contained in this message may be privileged \
and/or confidential. If you are not the intended recipient, or responsible for \
delivering this message to the intended recipient, any review, forwarding, \
dissemination, distribution or copying of this communication or any attachment(s) is \
strictly prohibited. If you have received this message in error, please notify the \
sender immediately, and delete it and all attachments from your computer and network.


</body></email><email><emailId>20111221222333</emailId><senderName>David Mansfield</senderName><senderEmail>libvirt@dm.cobite.com</senderEmail><timestampReceived>2011-12-21 22:23:33-0400</timestampReceived><subject>[libvirt-users] for a guest accessing host "full disk", how to prevent host vgscan</subject><body>

Hi All.

I have a dell system with a H700 raid.  Within the hardware RAID config 
I've created a "virtual disk" which I have assigned to one of my 
guests.  On the host the device is "/dev/sdb", on the guest it's "/dev/vdb".

This works fine.

Within the guest, we have created lvm PV on /dev/vdb (using the whole 
disk - no partitions) and created a volume group.  The guest's hostname 
is "argo" and the vg is called "vg_argo_bkup".

When I reboot the host, it does a vgscan and finds the volume group and 
activates it in the _host_, which I need to prevent (I think??).

I have successfully done this by filtering "/dev/sdb" in 
/etc/lvm/lvm.conf (which does NOT work as advertised BTW), but 
referencing the extremely volatile SCSI "sd*" names seems a terrible way 
to do this.  If I fiddle around in the HW raid config, the /dev/sd? may 
change.

I plan on creating about 10 more VM's spread over a number of machines 
over the next weeks with a very similar setup, and the admin overhead 
seems like it'll be onerous and error-prone.

I'd love to be able to filter the volume groups by VG name instead of pv 
device node.  The host's hostname is "narnia" and I'd love to say, 
'vgscan --include-regex "vg_narnia.*"' or something similar, if you get 
my drift.

Does anyone have a best practice for this?  I'm sure iSCSI enthusiasts 
must have the exact same issue all the time.

Oh... I'm using centos 6.2 on host and guest, 
libvirt-0.9.4-23.el6_2.1.x86_64, although it hardly seems a libvirt 
issue at all, it seems to be a lvm host issue mainly.

Thanks,
David Mansfield



</body></email><email><emailId>20111228040122</emailId><senderName>Juliano Souza</senderName><senderEmail>thespamer@gmail.com</senderEmail><timestampReceived>2011-12-28 04:01:22-0400</timestampReceived><subject>[libvirt-users] cannot find -lportablexdr</subject><body>

When I try to compile libvirt:

checking for xdrmem_create in -lportablexdr... no
checking for library containing xdrmem_create... no
configure: error: Cannot find a XDR library


Where have that libxdr source?

Thanks.

-- 
Juliano Souza

[Attachment #3 (text/html)]

When I try to compile libvirt:&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;checking for xdrmem_create in \
-lportablexdr... no&lt;/div&gt;&lt;div&gt;checking for library containing xdrmem_create... \
no&lt;/div&gt;&lt;div&gt;configure: error: Cannot find a XDR library&lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Where have that libxdr \
source?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks.&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- &lt;br&gt;Juliano \
Souza&lt;br&gt;&lt;br&gt; &lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20111221224143</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-12-21 22:41:43-0400</timestampReceived><subject>Re: [libvirt-users] for a guest accessing host "full disk", how to prevent host vgscan</subject><body>

On Wed, Dec 21, 2011 at 05:23:33PM -0500, David Mansfield wrote:
&gt; Hi All.
&gt; 
&gt; I have a dell system with a H700 raid.  Within the hardware RAID
&gt; config I've created a "virtual disk" which I have assigned to one of
&gt; my guests.  On the host the device is "/dev/sdb", on the guest it's
&gt; "/dev/vdb".
&gt; 
&gt; This works fine.
&gt; 
&gt; Within the guest, we have created lvm PV on /dev/vdb (using the
&gt; whole disk - no partitions) and created a volume group.  The guest's
&gt; hostname is "argo" and the vg is called "vg_argo_bkup".
&gt; 
&gt; When I reboot the host, it does a vgscan and finds the volume group
&gt; and activates it in the _host_, which I need to prevent (I think??).
&gt; 
&gt; I have successfully done this by filtering "/dev/sdb" in
&gt; /etc/lvm/lvm.conf (which does NOT work as advertised BTW), but
&gt; referencing the extremely volatile SCSI "sd*" names seems a terrible
&gt; way to do this.  If I fiddle around in the HW raid config, the
&gt; /dev/sd? may change.
&gt; 
&gt; I plan on creating about 10 more VM's spread over a number of
&gt; machines over the next weeks with a very similar setup, and the
&gt; admin overhead seems like it'll be onerous and error-prone.
&gt; 
&gt; I'd love to be able to filter the volume groups by VG name instead
&gt; of pv device node.  The host's hostname is "narnia" and I'd love to
&gt; say, 'vgscan --include-regex "vg_narnia.*"' or something similar, if
&gt; you get my drift.
&gt; 
&gt; Does anyone have a best practice for this?  I'm sure iSCSI
&gt; enthusiasts must have the exact same issue all the time.

The recommended approach is not to assign the entire disk to the
guest. Partition the host disk, to contain 1 single partition
consuming all space, then assign the partition to the guest. Worst
case is you loose a few KB of space due to partition alignment, but
this is a small price to pay to avoid the LVM problems you describe
all to well.

Regards,
Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20111226082658</emailId><senderName>"ice"</senderName><senderEmail>ice_feng@usish.com</senderEmail><timestampReceived>2011-12-26 08:26:58-0400</timestampReceived><subject>[libvirt-users] How to connect to a remote VM ESXi server with Python language?</subject><body>

Hi, Dear Mr/Mrs.

I have trouble in connecting to a VM ESXi server with python.

I am a developer using libvirt to control remote VM ESXi with python
language. But I am not able to connect to a remote VM ESXi server.

I make my try to solve this issue:

1: I use the function libvirt.Open() to open the remote VM ESXi Server, but
I don't know how to input the password. It seems that there is no parameter
for password input. 

2: I use "virsh connect ---". It is succeed when it is executed on locale
machine manual, but failed when I invoke this command in python environment.
I use "subprocess.Popen" to execute the command "virsh", but this function
would be hung on after command "communicate" executed.

-bash-4.1# python

Python 2.6.6 (r266:84292, May 20 2011, 16:42:11) 

[GCC 4.4.5 20110214 (Red Hat 4.4.5-6)] on linux2

Type "help", "copyright", "credits" or "license" for more information.

&gt;&gt;&gt; from subprocess import Popen,PIPE,STDOUT

&gt;&gt;&gt; command=['virsh', '-c', 'esx://192.168.58.144/?no_verify=1','list',
'--all']

&gt;&gt;&gt; p=Popen(command, stdin=PIPE,stdout=PIPE, stderr=STDOUT)

&gt;&gt;&gt; output = p.communicate()[0]

How to fix it?

 

Thanks for help!

Best regards!

 

 

 


[Attachment #3 (text/html)]

&lt;html xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:st1="urn:schemas-microsoft-com:office:smarttags" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;meta http-equiv=Content-Type content="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 11 (filtered medium)"&gt;
&lt;o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="chsdate"/&gt;
&lt;!--[if !mso]&gt;
&lt;style&gt;
st1\:*{behavior:url(#default#ieooui) }
&lt;/style&gt;
&lt;![endif]--&gt;
&lt;style&gt;
&lt;!--
 /* Font Definitions */
 @font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:Arial;
	color:windowtext;}
 /* Page Definitions */
 @page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	layout-grid:15.6pt;}
div.Section1
	{page:Section1;}
--&gt;
&lt;/style&gt;

&lt;/head&gt;

&lt;body lang=ZH-CN link=blue vlink=purple style='text-justify-trim:punctuation'&gt;

&lt;div class=Section1 style='layout-grid:15.6pt'&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;Hi, Dear Mr/Mrs.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;I have trouble in connecting to a VM ESXi server with
python.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;I am a developer using libvirt to control remote VM
ESXi with python language. But I am not able to connect to a remote VM ESXi
server.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;I make my try to solve this \
issue:&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;1: I use the function libvirt.Open() to open the
remote VM ESXi Server, but I don’t know how to input the password. It seems
that there is no parameter for password input. &lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;2: I use “virsh connect ---“. It is succeed
when it is executed on locale machine manual, but failed when I invoke this
command in python environment. I use “subprocess.Popen” to execute the
command “virsh”, but this function would be hung on after command \
“communicate” executed.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd'&gt;&lt;font
size=1 face=Arial&gt;&lt;span lang=EN-US \
style='font-size:9.0pt;font-family:Arial'&gt;-bash-4.1# \
python&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd'&gt;&lt;font
size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:9.0pt;font-family:Arial'&gt;Python
&lt;st1:chsdate IsROCDate="False" IsLunarDate="False" Day="30" Month="12"
Year="1899" w:st="on"&gt;2.6.6&lt;/st1:chsdate&gt; (r266:84292, May 20 2011, 16:42:11) \
&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd'&gt;&lt;font
size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:9.0pt;font-family:Arial'&gt;[GCC
4.4.5 20110214 (Red Hat &lt;st1:chsdate IsROCDate="False" IsLunarDate="False"
Day="30" Month="12" Year="1899" w:st="on"&gt;4.4.5&lt;/st1:chsdate&gt;-6)] on \
linux2&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd'&gt;&lt;font
size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:9.0pt;font-family:Arial'&gt;Type
"help", "copyright", "credits" or
"license" for more information.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd'&gt;&lt;font
size=1 face=Arial&gt;&lt;span lang=EN-US \
style='font-size:9.0pt;font-family:Arial'&gt;&gt;&gt;&gt; from subprocess import \
Popen,PIPE,STDOUT&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd'&gt;&lt;font
size=1 face=Arial&gt;&lt;span lang=EN-US \
style='font-size:9.0pt;font-family:Arial'&gt;&gt;&gt;&gt; command=['virsh', '-c', \
'esx://192.168.58.144/?no_verify=1','list', '--all']&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd'&gt;&lt;font
size=1 face=Arial&gt;&lt;span lang=EN-US \
style='font-size:9.0pt;font-family:Arial'&gt;&gt;&gt;&gt; p=Popen(command, \
stdin=PIPE,stdout=PIPE, stderr=STDOUT)&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd'&gt;&lt;font
size=1 face=Arial&gt;&lt;span lang=EN-US \
style='font-size:9.0pt;font-family:Arial'&gt;&gt;&gt;&gt; output = \
p.communicate()[0]&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;How to fix it?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;Thanks for help!&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;Best regards!&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=2 face="Times New Roman"&gt;&lt;span lang=EN-US
style='font-size:10.0pt'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;



</body></email><email><emailId>20111222142001</emailId><senderName>David Mansfield</senderName><senderEmail>libvirt@dm.cobite.com</senderEmail><timestampReceived>2011-12-22 14:20:01-0400</timestampReceived><subject>Re: [libvirt-users] for a guest accessing host "full disk", how to prevent host vgscan</subject><body>



On 12/21/2011 05:41 PM, Daniel P. Berrange wrote:
&gt; On Wed, Dec 21, 2011 at 05:23:33PM -0500, David Mansfield wrote:
&gt;&gt; Hi All.
&gt;&gt;
&gt;&gt; I have a dell system with a H700 raid.  Within the hardware RAID
&gt;&gt; config I've created a "virtual disk" which I have assigned to one of
&gt;&gt; my guests.  On the host the device is "/dev/sdb", on the guest it's
&gt;&gt; "/dev/vdb".
&gt;&gt;
&gt;&gt; This works fine.
&gt;&gt;
&gt;&gt; Within the guest, we have created lvm PV on /dev/vdb (using the
&gt;&gt; whole disk - no partitions) and created a volume group.  The guest's
&gt;&gt; hostname is "argo" and the vg is called "vg_argo_bkup".
&gt;&gt;
&gt;&gt; When I reboot the host, it does a vgscan and finds the volume group
&gt;&gt; and activates it in the _host_, which I need to prevent (I think??).
&gt;&gt;
&gt;&gt; I have successfully done this by filtering "/dev/sdb" in
&gt;&gt; /etc/lvm/lvm.conf (which does NOT work as advertised BTW), but
&gt;&gt; referencing the extremely volatile SCSI "sd*" names seems a terrible
&gt;&gt; way to do this.  If I fiddle around in the HW raid config, the
&gt;&gt; /dev/sd? may change.
&gt;&gt;
&gt;&gt; I plan on creating about 10 more VM's spread over a number of
&gt;&gt; machines over the next weeks with a very similar setup, and the
&gt;&gt; admin overhead seems like it'll be onerous and error-prone.
&gt;&gt;
&gt;&gt; I'd love to be able to filter the volume groups by VG name instead
&gt;&gt; of pv device node.  The host's hostname is "narnia" and I'd love to
&gt;&gt; say, 'vgscan --include-regex "vg_narnia.*"' or something similar, if
&gt;&gt; you get my drift.
&gt;&gt;
&gt;&gt; Does anyone have a best practice for this?  I'm sure iSCSI
&gt;&gt; enthusiasts must have the exact same issue all the time.
&gt; The recommended approach is not to assign the entire disk to the
&gt; guest. Partition the host disk, to contain 1 single partition
&gt; consuming all space, then assign the partition to the guest. Worst
&gt; case is you loose a few KB of space due to partition alignment, but
&gt; this is a small price to pay to avoid the LVM problems you describe
&gt; all to well.
I don't really understand.  The host still scans the partitions, right?  
And the partition "dev" names change dynamically if the whole-disk 
changes it's "dev" name.  Won't I still have to list specific volatile 
names in the /etc/lvm/lvm.conf on the host?

Thanks,
David

</body></email><email><emailId>20111222174441</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-12-22 17:44:41-0400</timestampReceived><subject>Re: [libvirt-users] for a guest accessing host "full disk", how to prevent host vgscan</subject><body>

On Thu, Dec 22, 2011 at 09:20:01AM -0500, David Mansfield wrote:
&gt; 
&gt; 
&gt; On 12/21/2011 05:41 PM, Daniel P. Berrange wrote:
&gt; &gt;On Wed, Dec 21, 2011 at 05:23:33PM -0500, David Mansfield wrote:
&gt; &gt;&gt;Hi All.
&gt; &gt;&gt;
&gt; &gt;&gt;I have a dell system with a H700 raid.  Within the hardware RAID
&gt; &gt;&gt;config I've created a "virtual disk" which I have assigned to one of
&gt; &gt;&gt;my guests.  On the host the device is "/dev/sdb", on the guest it's
&gt; &gt;&gt;"/dev/vdb".
&gt; &gt;&gt;
&gt; &gt;&gt;This works fine.
&gt; &gt;&gt;
&gt; &gt;&gt;Within the guest, we have created lvm PV on /dev/vdb (using the
&gt; &gt;&gt;whole disk - no partitions) and created a volume group.  The guest's
&gt; &gt;&gt;hostname is "argo" and the vg is called "vg_argo_bkup".
&gt; &gt;&gt;
&gt; &gt;&gt;When I reboot the host, it does a vgscan and finds the volume group
&gt; &gt;&gt;and activates it in the _host_, which I need to prevent (I think??).
&gt; &gt;&gt;
&gt; &gt;&gt;I have successfully done this by filtering "/dev/sdb" in
&gt; &gt;&gt;/etc/lvm/lvm.conf (which does NOT work as advertised BTW), but
&gt; &gt;&gt;referencing the extremely volatile SCSI "sd*" names seems a terrible
&gt; &gt;&gt;way to do this.  If I fiddle around in the HW raid config, the
&gt; &gt;&gt;/dev/sd? may change.
&gt; &gt;&gt;
&gt; &gt;&gt;I plan on creating about 10 more VM's spread over a number of
&gt; &gt;&gt;machines over the next weeks with a very similar setup, and the
&gt; &gt;&gt;admin overhead seems like it'll be onerous and error-prone.
&gt; &gt;&gt;
&gt; &gt;&gt;I'd love to be able to filter the volume groups by VG name instead
&gt; &gt;&gt;of pv device node.  The host's hostname is "narnia" and I'd love to
&gt; &gt;&gt;say, 'vgscan --include-regex "vg_narnia.*"' or something similar, if
&gt; &gt;&gt;you get my drift.
&gt; &gt;&gt;
&gt; &gt;&gt;Does anyone have a best practice for this?  I'm sure iSCSI
&gt; &gt;&gt;enthusiasts must have the exact same issue all the time.
&gt; &gt;The recommended approach is not to assign the entire disk to the
&gt; &gt;guest. Partition the host disk, to contain 1 single partition
&gt; &gt;consuming all space, then assign the partition to the guest. Worst
&gt; &gt;case is you loose a few KB of space due to partition alignment, but
&gt; &gt;this is a small price to pay to avoid the LVM problems you describe
&gt; &gt;all to well.
&gt; I don't really understand.  The host still scans the partitions,
&gt; right?  And the partition "dev" names change dynamically if the
&gt; whole-disk changes it's "dev" name.  Won't I still have to list
&gt; specific volatile names in the /etc/lvm/lvm.conf on the host?

The host will see '/dev/sda' and '/dev/sda1', you'll assign
' /dev/sda1' to the guest, and it will appear as /dev/vda.
In the guest you'll create '/dev/vda1' and format it as the
PV. So while the host will see /dev/sda1, it won't see the
nested partition table, and thus won't see the PV

Regards,
Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20111222190034</emailId><senderName>David Mansfield</senderName><senderEmail>libvirt@dm.cobite.com</senderEmail><timestampReceived>2011-12-22 19:00:34-0400</timestampReceived><subject>Re: [libvirt-users] for a guest accessing host "full disk", how to prevent host vgscan</subject><body>



On 12/22/2011 12:44 PM, Daniel P. Berrange wrote:
&gt; On Thu, Dec 22, 2011 at 09:20:01AM -0500, David Mansfield wrote:
&gt;&gt;
&gt;&gt; On 12/21/2011 05:41 PM, Daniel P. Berrange wrote:
&gt;&gt;&gt; On Wed, Dec 21, 2011 at 05:23:33PM -0500, David Mansfield wrote:
&gt;&gt;&gt;&gt; Hi All.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; I have a dell system with a H700 raid.  Within the hardware RAID
&gt;&gt;&gt;&gt; config I've created a "virtual disk" which I have assigned to one of
&gt;&gt;&gt;&gt; my guests.  On the host the device is "/dev/sdb", on the guest it's
&gt;&gt;&gt;&gt; "/dev/vdb".
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; This works fine.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Within the guest, we have created lvm PV on /dev/vdb (using the
&gt;&gt;&gt;&gt; whole disk - no partitions) and created a volume group.  The guest's
&gt;&gt;&gt;&gt; hostname is "argo" and the vg is called "vg_argo_bkup".
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; When I reboot the host, it does a vgscan and finds the volume group
&gt;&gt;&gt;&gt; and activates it in the _host_, which I need to prevent (I think??).
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; I have successfully done this by filtering "/dev/sdb" in
&gt;&gt;&gt;&gt; /etc/lvm/lvm.conf (which does NOT work as advertised BTW), but
&gt;&gt;&gt;&gt; referencing the extremely volatile SCSI "sd*" names seems a terrible
&gt;&gt;&gt;&gt; way to do this.  If I fiddle around in the HW raid config, the
&gt;&gt;&gt;&gt; /dev/sd? may change.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; I plan on creating about 10 more VM's spread over a number of
&gt;&gt;&gt;&gt; machines over the next weeks with a very similar setup, and the
&gt;&gt;&gt;&gt; admin overhead seems like it'll be onerous and error-prone.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; I'd love to be able to filter the volume groups by VG name instead
&gt;&gt;&gt;&gt; of pv device node.  The host's hostname is "narnia" and I'd love to
&gt;&gt;&gt;&gt; say, 'vgscan --include-regex "vg_narnia.*"' or something similar, if
&gt;&gt;&gt;&gt; you get my drift.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Does anyone have a best practice for this?  I'm sure iSCSI
&gt;&gt;&gt;&gt; enthusiasts must have the exact same issue all the time.
&gt;&gt;&gt; The recommended approach is not to assign the entire disk to the
&gt;&gt;&gt; guest. Partition the host disk, to contain 1 single partition
&gt;&gt;&gt; consuming all space, then assign the partition to the guest. Worst
&gt;&gt;&gt; case is you loose a few KB of space due to partition alignment, but
&gt;&gt;&gt; this is a small price to pay to avoid the LVM problems you describe
&gt;&gt;&gt; all to well.
&gt;&gt; I don't really understand.  The host still scans the partitions,
&gt;&gt; right?  And the partition "dev" names change dynamically if the
&gt;&gt; whole-disk changes it's "dev" name.  Won't I still have to list
&gt;&gt; specific volatile names in the /etc/lvm/lvm.conf on the host?
&gt; The host will see '/dev/sda' and '/dev/sda1', you'll assign
&gt; ' /dev/sda1' to the guest, and it will appear as /dev/vda.
&gt; In the guest you'll create '/dev/vda1' and format it as the
&gt; PV. So while the host will see /dev/sda1, it won't see the
&gt; nested partition table, and thus won't see the PV

Ahhh.  Brilliant.  Thanks.  Now the only problem is getting the 
underlying stripe alignment right ;-)

David

</body></email><email><emailId>20111217073544</emailId><senderName>xuteng</senderName><senderEmail>xuteng@szjhkx.com</senderEmail><timestampReceived>2011-12-17 07:35:44-0400</timestampReceived><subject>[libvirt-users] network problems with some cloned vm</subject><body>

[Attachment #2 (text/plain)]

Hi,All:
   Using KVM + libvirt + virt-manager, I meet a strange problem , some cloned vm  \
cannot get correct ip address via bridge network, but some vm can. My host ip is \
192.168.1.8 , a bridge interface br0 , an ethernet interface eth0 When the vm(win7) \
started ,I got the information like " ip 169.254.XXX.XXX netmask 255.255.0.0" by \
ipconfig Here is the host network settings:
[root@kvm-8 ~]# ifconfig 
br0       Link encap:Ethernet  HWaddr BC:AE:C5:21:C8:FB  
          inet addr:192.168.1.8  Bcast:192.168.1.255  Mask:255.255.255.0
          inet6 addr: fe80::beae:c5ff:fe21:c8fb/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:59381 errors:0 dropped:0 overruns:0 frame:0
          TX packets:52495 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:7078092 (6.7 MiB)  TX bytes:50729969 (48.3 MiB)

eth0      Link encap:Ethernet  HWaddr BC:AE:C5:21:C8:FB  
          inet6 addr: fe80::beae:c5ff:fe21:c8fb/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:60238 errors:0 dropped:0 overruns:0 frame:0
          TX packets:76409 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:8037333 (7.6 MiB)  TX bytes:52546222 (50.1 MiB)
          Memory:fbee0000-fbf00000 

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:11312 errors:0 dropped:0 overruns:0 frame:0
          TX packets:11312 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:36054480 (34.3 MiB)  TX bytes:36054480 (34.3 MiB)

virbr0    Link encap:Ethernet  HWaddr D2:38:52:7D:0D:5D  
          inet addr:192.168.122.1  Bcast:192.168.122.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)

vnet0     Link encap:Ethernet  HWaddr FE:54:00:A1:A1:90  
          inet6 addr: fe80::fc54:ff:fea1:a190/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:134 errors:0 dropped:0 overruns:0 frame:0
          TX packets:247 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:500 
          RX bytes:24091 (23.5 KiB)  TX bytes:15846 (15.4 KiB)

[root@kvm-8 ~]# 

brctl shows:
[root@kvm-8 ~]# brctl show
bridge name bridge id STP enabled interfaces
br0 8000.bcaec521c8fb yes eth0
vnet0
virbr0 8000.000000000000 yes 
[root@kvm-8 ~]# 

Any information would be appreciated
Thank you!

wade




xuteng via foxmail


[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;
&lt;HTML&gt;&lt;HEAD&gt;
&lt;META http-equiv=Content-Type content="text/html; charset=us-ascii"&gt;
&lt;STYLE&gt;
BLOCKQUOTE {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; MARGIN-LEFT: 2em
}
OL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
UL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
P {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
BODY {
	FONT-SIZE: 10.5pt; COLOR: #000000; LINE-HEIGHT: 1.5; FONT-FAMILY: 宋体
}
&lt;/STYLE&gt;

&lt;META content="MSHTML 6.00.2900.6169" name=GENERATOR&gt;&lt;/HEAD&gt;
&lt;BODY style="MARGIN: 10px"&gt;
&lt;DIV&gt;
&lt;DIV&gt;Hi,All:&lt;/DIV&gt;
&lt;DIV&gt;   Using KVM + libvirt + virt-manager, I meet a strange 
problem , some cloned vm  cannot get correct ip address via bridge network, 
but some vm can.&lt;/DIV&gt;
&lt;DIV&gt;My host ip is 192.168.1.8 , a bridge interface br0 , an ethernet interface 
eth0&lt;/DIV&gt;
&lt;DIV&gt;When the vm(win7) started ,I got the information like " ip 169.254.XXX.XXX 
netmask 255.255.0.0" by ipconfig&lt;/DIV&gt;
&lt;DIV&gt;Here is the host network settings:&lt;/DIV&gt;
&lt;BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px"&gt;
  &lt;BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px"&gt;
    &lt;BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px"&gt;
      &lt;DIV&gt;
      &lt;DIV&gt;[root@kvm-8 ~]# ifconfig &lt;/DIV&gt;
      &lt;DIV&gt;br0       Link encap:Ethernet  HWaddr BC:AE:C5:21:C8:FB  &lt;/DIV&gt;
                
      &lt;DIV&gt;          inet addr:192.168.1.8  Bcast:192.168.1.255  Mask:255.255.255.0&lt;/DIV&gt;
                
      &lt;DIV&gt;          inet6 addr: fe80::beae:c5ff:fe21:c8fb/64 Scope:Link&lt;/DIV&gt;
                
      &lt;DIV&gt;          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1&lt;/DIV&gt;
                
      &lt;DIV&gt;          RX packets:59381 errors:0 dropped:0 overruns:0 frame:0&lt;/DIV&gt;
                
      &lt;DIV&gt;          TX packets:52495 errors:0 dropped:0 overruns:0 carrier:0&lt;/DIV&gt;
                
      &lt;DIV&gt;          collisions:0 txqueuelen:0 &lt;/DIV&gt;
  &lt;DIV&gt;          RX bytes:70780 \
92 (6.7 MiB)  TX bytes:50729969 (48.3 MiB)&lt;/DIV&gt;  \
                &lt;DIV&gt; &lt;/DIV&gt;
      &lt;DIV&gt;eth0      Link encap:Ethernet  HWaddr BC:AE:C5:21:C8:FB  &lt;/DIV&gt;
                
      &lt;DIV&gt;          inet6 addr: fe80::beae:c5ff:fe21:c8fb/64 Scope:Link&lt;/DIV&gt;
                
      &lt;DIV&gt;          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1&lt;/DIV&gt;
                
      &lt;DIV&gt;          RX packets:60238 errors:0 dropped:0 overruns:0 frame:0&lt;/DIV&gt;
                
      &lt;DIV&gt;          TX packets:76409 errors:0 dropped:0 overruns:0 carrier:0&lt;/DIV&gt;
                
      &lt;DIV&gt;          collisions:0 txqueuelen:1000 &lt;/DIV&gt;
  &lt;DIV&gt;          RX bytes:80373 \
                33 (7.6 MiB)  TX bytes:52546222 (50.1 MiB)&lt;/DIV&gt;
                
      &lt;DIV&gt;          Memory:fbee0000-fbf00000 &lt;/DIV&gt;
  &lt;DIV&gt; &lt;/DIV&gt;
      &lt;DIV&gt;lo        Link encap:Local Loopback  &lt;/DIV&gt;
                
      &lt;DIV&gt;          inet addr:127.0.0.1  Mask:255.0.0.0&lt;/DIV&gt;
                
      &lt;DIV&gt;          inet6 addr: ::1/128 Scope:Host&lt;/DIV&gt;
                
      &lt;DIV&gt;          UP LOOPBACK RUNNING  MTU:16436  Metric:1&lt;/DIV&gt;
                
      &lt;DIV&gt;          RX packets:11312 errors:0 dropped:0 overruns:0 frame:0&lt;/DIV&gt;
                
      &lt;DIV&gt;          TX packets:11312 errors:0 dropped:0 overruns:0 carrier:0&lt;/DIV&gt;
                
      &lt;DIV&gt;          collisions:0 txqueuelen:0 &lt;/DIV&gt;
  &lt;DIV&gt;          RX bytes:36054 \
480 (34.3 MiB)  TX bytes:36054480 (34.3 MiB)&lt;/DIV&gt; \
                &lt;DIV&gt; &lt;/DIV&gt;
      &lt;DIV&gt;virbr0    Link encap:Ethernet  HWaddr D2:38:52:7D:0D:5D  &lt;/DIV&gt;
  &lt;DIV&gt;          inet addr:192.168.122.1  Bcast:192.168.122.255  Mask:255.255.255.0&lt;/DIV&gt;
                
      &lt;DIV&gt;          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1&lt;/DIV&gt;
                
      &lt;DIV&gt;          RX packets:0 errors:0 dropped:0 overruns:0 frame:0&lt;/DIV&gt;
                
      &lt;DIV&gt;          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0&lt;/DIV&gt;
                
      &lt;DIV&gt;          collisions:0 txqueuelen:0 &lt;/DIV&gt;
                
      &lt;DIV&gt;          RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)&lt;/DIV&gt;
  &lt;DIV&gt; &lt;/DIV&gt;
      &lt;DIV&gt;vnet0     Link encap:Ethernet  HWaddr FE:54:00:A1:A1:90  &lt;/DIV&gt;
                
      &lt;DIV&gt;          inet6 addr: fe80::fc54:ff:fea1:a190/64 Scope:Link&lt;/DIV&gt;
                
      &lt;DIV&gt;          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1&lt;/DIV&gt;
                
      &lt;DIV&gt;          RX packets:134 errors:0 dropped:0 overruns:0 frame:0&lt;/DIV&gt;
                
      &lt;DIV&gt;          TX packets:247 errors:0 dropped:0 overruns:0 carrier:0&lt;/DIV&gt;
                
      &lt;DIV&gt;          collisions:0 txqueuelen:500 &lt;/DIV&gt;
  &lt;DIV&gt;          RX bytes:24091 (23.5 KiB)  TX bytes:15846 (15.4 KiB)&lt;/DIV&gt;
  &lt;DIV&gt; &lt;/DIV&gt;
      &lt;DIV&gt;[root@kvm-8 ~]# &lt;/DIV&gt;&lt;/DIV&gt;&lt;/BLOCKQUOTE&gt;&lt;/BLOCKQUOTE&gt;&lt;/BLOCKQUOTE&gt;
 &lt;DIV dir=ltr&gt; &lt;/DIV&gt;
&lt;DIV dir=ltr&gt;brctl shows:&lt;/DIV&gt;
&lt;DIV dir=ltr 
style="TEXT-INDENT: 6em"&gt;[root@kvm-8 ~]# brctl show&lt;/DIV&gt;
&lt;DIV dir=ltr style="TEXT-INDENT: 6em"&gt;bridge name bridge id 
STP enabled interfaces&lt;/DIV&gt;
&lt;DIV dir=ltr style="TEXT-INDENT: 6em"&gt;br0 8000.bcaec521c8fb yes eth0&lt;/DIV&gt;
&lt;DIV dir=ltr style="TEXT-INDENT: 20em"&gt;vnet0&lt;/DIV&gt;
&lt;DIV dir=ltr style="TEXT-INDENT: 6em"&gt;virbr0 8000.000000000000 yes &lt;/DIV&gt;
&lt;DIV dir=ltr style="TEXT-INDENT: 6em"&gt;[root@kvm-8 ~]# &lt;/DIV&gt;
&lt;DIV dir=ltr style="TEXT-INDENT: 6em; TEXT-ALIGN: left"&gt; &lt;/DIV&gt;
&lt;DIV dir=ltr style="TEXT-ALIGN: left"&gt;Any information would be appreciated&lt;/DIV&gt;
&lt;DIV dir=ltr style="TEXT-ALIGN: left"&gt;Thank you!&lt;/DIV&gt;
&lt;DIV dir=ltr style="TEXT-ALIGN: left"&gt; &lt;/DIV&gt;
&lt;DIV dir=ltr style="TEXT-ALIGN: left"&gt;wade&lt;/DIV&gt;&lt;/DIV&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;HR style="WIDTH: 210px; HEIGHT: 1px" align=left color=#b5c4df SIZE=1&gt;

&lt;DIV&gt;&lt;SPAN&gt;xuteng&lt;SPAN 
style="FONT-SIZE: 10.5pt; COLOR: #969696; FONT-STYLE: italic; FONT-FAMILY: Microsoft \
Sans Serif"&gt;  via foxmail&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/DIV&gt;&lt;/BODY&gt;&lt;/HTML&gt;



</body></email><email><emailId>20111229083848</emailId><senderName></senderName><senderEmail>al.g.belyaev@gmail.com</senderEmail><timestampReceived>2011-12-29 08:38:48-0400</timestampReceived><subject>[libvirt-users] redirect ports from user network</subject><body>

Hello.
I would like to redirect some ports from user network to host system.

In console i can do it:
/usr/libexec/qemu-kvm -drive file=/home/libvirt/qemu-fedora.img -vnc
10.200.1.1:1 -net user -redir tcp:22000::49999 -redir tcp:22001::22

How can i do it with libvirt?
I make users network in XML config VM:

 &lt;interface type='user'&gt;
      &lt;mac address='52:54:00:48:3f:f5'/&gt;
      &lt;alias name='net0'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03'
function='0x0'/&gt;
    &lt;/interface&gt;

But i don't know - how to make redirecting ports and i cann't fint it
in documentation. Is it possible?

-- 
Thanks for your feedback.

Best regards,
Alex

</body></email><email><emailId>20111219114444</emailId><senderName>Andrew Spiers</senderName><senderEmail>andrew@andrewspiers.net</senderEmail><timestampReceived>2011-12-19 11:44:44-0400</timestampReceived><subject>[libvirt-users] Using libvirt networking properly.</subject><body>

Hi, I'm interested in a setup in which one guest  receives all its
networking services (routed IPv4, dhcp, tftp, dns) from another, which
is connected via a routing through the hypervisor. I think this is a
lot like Guest C and Guest B in the diagram at
http://libvirt.org/archnetwork.html.

I have experimented with setting the network between Guest B and the
hypervisor as a routed network, and the network between Guest B and
Guest C as an isolated network. The problems I am having is that I am
not sure how to set up a persistent static route to Guest C via Guest
B, (I created a file with the route called route-virbr3 in
/etc/sysconfig/network-scripts on the hypervisor, but it doesn't seem
to do anything), and the changes I need to make to allow traffic with
Guest C's source IP to come from Guest B's interface with the
hypervisor seems to get overwritten or superceded by additional rules
that are created when I start my machine.)

I can see something about a qemu-ifup script mentioned at
http://www.linux-kvm.org/page/Networking. Should I create something
like that and put some sort of `ip route add` command in it? When
should that script be called?

Is there a way to specify the necessary  firewall and routing rules in
the xml network configuration?

I am working with  a Fedora 16 hypervisor and Guest B is a Centos 6
machine. I'd like to use all sorts of different distributions where
Guest C is.

Regards,

Andrew.

</body></email><email><emailId>20111219134635</emailId><senderName>"Paul K. Alabi"</senderName><senderEmail>kehi@ees1s0.engr.ccny.cuny.edu</senderEmail><timestampReceived>2011-12-19 13:46:35-0400</timestampReceived><subject>[libvirt-users] Virt-Manager + IDE Controller</subject><body>

Hi , 
i m currently running CentOS 5.4 on a Dell C2100 . I have virt-manger , livirt
installed but i can't get my VMs to mount more than 4 IDE disk ( i have 8) . I
would like to know how to mount ALL 8 Disk on my VM . 

P



----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.

</body></email><email><emailId>20111219205934</emailId><senderName>Nathan March</senderName><senderEmail>nathan@gt.net</senderEmail><timestampReceived>2011-12-19 20:59:34-0400</timestampReceived><subject>Re: [libvirt-users] Libvirtd slowness</subject><body>

On 12/13/2011 11:24 AM, Nathan March wrote:
&gt; On 12/13/2011 11:11 AM, Nathan March wrote:
&gt;&gt;
&gt;&gt; This is on a freshly booted machine with no VM's running on it, so 
&gt;&gt; not sure what domains it's expecting to find?
&gt;&gt;
&gt;&gt; - Nathan
&gt;
&gt; Little more info, here's an strace of the libvirtd during that time:

Anyone have anything they can suggest for this?

- Nathan

</body></email><email><emailId>20111221215714</emailId><senderName>Jawahar Tadipatri</senderName><senderEmail>jtadipa@ncsu.edu</senderEmail><timestampReceived>2011-12-21 21:57:14-0400</timestampReceived><subject>[libvirt-users] Issue with IPMI (and KVM) on RHEL 6</subject><body>

Hi folks,
We experiencing some difficulties in getting IPMI to work on RHEL 6 running
as Guest using KVM. We have verified that IPMI works on RHEL 6 if installed
on bare metal.
Is this a known issue? Can anyone please suggest a fix or work-around for
this problem?

*RHEL 6 as guest os with kvm on RHEL 6 as host os -- doesn't work*
RHEL 6 (client) on bare metal (i.e., the above mentioned host os)-- works

Below is the the output of the command (just an indication that it failed)
and relevant part of dmesg .

# service ipmi start
Starting ipmi drivers:                                     [FAILED]

# dmesg | tail -12
ipmi message handler version 39.2
IPMI System Interface driver.
ipmi_si: Adding default-specified kcs state machine
ipmi_si: Trying default-specified kcs state machine at i/o address 0xca2,
slave address 0x0, irq 0
ipmi_si: Interface detection failed
ipmi_si: Adding default-specified smic state machine
ipmi_si: Trying default-specified smic state machine at i/o address 0xca9,
slave address 0x0, irq 0
ipmi_si: Interface detection failed
ipmi_si: Adding default-specified bt state machine
ipmi_si: Trying default-specified bt state machine at i/o address 0xe4,
slave address 0x0, irq 0
ipmi_si: Interface detection failed
ipmi_si: Unable to find any System Interface(s)

Please revert if any more information is needed.

Thanks and Regards,
Jawahar

[Attachment #3 (text/html)]

Hi folks,&lt;br&gt;&lt;div&gt;We experiencing some difficulties in getting IPMI to work on RHEL 6
 running as Guest using KVM. We have verified that IPMI
 works on RHEL 6 if installed on bare metal. &lt;br&gt;Is this a known issue? Can anyone 
please suggest a fix or work-around for this problem?&lt;/div&gt;
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;RHEL 6 as guest os with kvm on RHEL 6 as host os -- \
doesn't work&lt;/b&gt;&lt;/div&gt;&lt;div&gt;RHEL 6 (client) on bare metal (i.e., the above \
mentioned host os)-- works&lt;/div&gt; &lt;div&gt;&lt;br&gt;Below is the the output of the command \
(just an indication that it failed) and relevant part of dmesg .&lt;br&gt;&lt;br&gt;# service \
ipmi start&lt;br&gt;Starting ipmi drivers:                                     \
[FAILED]&lt;br&gt;&lt;br&gt;# dmesg | tail -12&lt;br&gt; ipmi message handler version 39.2&lt;br&gt;IPMI \
System Interface driver.&lt;br&gt;ipmi_si: Adding default-specified kcs state \
machine&lt;br&gt;ipmi_si: Trying default-specified kcs state machine at i/o address 0xca2, \
                slave address 0x0, irq 0&lt;br&gt;
ipmi_si: Interface detection failed&lt;br&gt;ipmi_si: Adding default-specified smic state \
machine&lt;br&gt;ipmi_si: Trying default-specified smic state machine at i/o address 0xca9, \
                slave address 0x0, irq 0&lt;br&gt;ipmi_si: Interface detection failed&lt;br&gt;
ipmi_si: Adding default-specified bt state machine&lt;br&gt;ipmi_si: Trying \
default-specified bt state machine at i/o address 0xe4, slave address 0x0, irq \
0&lt;br&gt;ipmi_si: Interface detection failed&lt;br&gt;ipmi_si: Unable to find any System \
Interface(s)&lt;br&gt; &lt;br&gt;Please revert if any more information is needed.&lt;br&gt;&lt;br&gt;Thanks \
and Regards,&lt;br&gt;Jawahar&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20111222121845</emailId><senderName>Stefano Ghio</senderName><senderEmail>steghio@eng.it</senderEmail><timestampReceived>2011-12-22 12:18:45-0400</timestampReceived><subject>[libvirt-users] Error when creating domain with virsh+qemu</subject><body>

Cheers,

I'm working on Ubuntu server 11.10 32 bit with libvirt 0.9.2 and 
qemu-kvm 0.14.1. I have a user oneadmin:oneadmin who also belongs to kvm 
and libvirtd groups. I have set qemu.conf and libvirtd.conf with 
user/group oneadmin.

I have disk.0 and deployment.0 files owned by oneadmin. My system does 
not support hardware virtualization so I don't have /dev/kvm. I'm able 
to start VM with qemu anyways but when issuing the command:

virsh -c qemu:///system create deployment.0

I get:

error: Failed to create domain from deployment.0
error: internal error process exited while connecting to monitor: 
13:00:52.354:1291: info: libvirt version: 0.9.2
13:00:52.371: 1291: debug : virCommandHook:1826 : Waiting on parent for 
handshake complete on 23
13:00:52.371: 1291: debug : virCommandHook:1842 : Hook is done 0
open /dev/kvm: No such file or directory
failed to initialize KVM: Operation not permitted

"error while connecting to monitor" looks to me as something 
permission-related but I tried a lot of combinations between the qemu 
and libvirt conf files and nothing worked (yes, I always restarted the 
system after every change).

If I start the same image with sudo /usr/bin/qemu-system-i386 -hda 
disk.img -boot d -m 384 it works

Any help?

Thanks
-- 
Dr. Stefano Ghio - ENG Engineering Italy

Website: http://groglogs.blogspot.com/

*If you received this message but you are not its recipient, please 
ignore it and warn me, thank you.*

[Attachment #3 (text/html)]

&lt;html&gt;
  &lt;head&gt;

    &lt;meta http-equiv="content-type" content="text/html; charset=ISO-8859-1"&gt;
  &lt;/head&gt;
  &lt;body bgcolor="#FFFFFF" text="#000000"&gt;
    Cheers,&lt;br&gt;
    &lt;br&gt;
    I'm working on Ubuntu server 11.10 32 bit with libvirt 0.9.2 and
    qemu-kvm 0.14.1. I have a user oneadmin:oneadmin who also belongs to
    kvm and libvirtd groups. I have set qemu.conf and libvirtd.conf with
    user/group oneadmin.&lt;br&gt;
    &lt;br&gt;
    I have disk.0 and deployment.0 files owned by oneadmin. My system
    does not support hardware virtualization so I don't have /dev/kvm.
    I'm able to start VM with qemu anyways but when issuing the command:&lt;br&gt;
    &lt;br&gt;
    virsh -c qemu:///system create deployment.0&lt;br&gt;
    &lt;br&gt;
    I get:&lt;br&gt;
    &lt;br&gt;
    error: Failed to create domain from deployment.0&lt;br&gt;
    error: internal error process exited while connecting to monitor:
    13:00:52.354:1291: info: libvirt version: 0.9.2&lt;br&gt;
    13:00:52.371: 1291: debug : virCommandHook:1826 : Waiting on parent
    for handshake complete on 23&lt;br&gt;
    13:00:52.371: 1291: debug : virCommandHook:1842 : Hook is done 0&lt;br&gt;
    open /dev/kvm: No such file or directory&lt;br&gt;
    failed to initialize KVM: Operation not permitted&lt;br&gt;
    &lt;br&gt;
    "error while connecting to monitor" looks to me as something
    permission-related but I tried a lot of combinations between the
    qemu and libvirt conf files and nothing worked (yes, I always
    restarted the system after every change).&lt;br&gt;
    &lt;br&gt;
    If I start the same image with sudo /usr/bin/qemu-system-i386 -hda
    disk.img -boot d -m 384 it works&lt;br&gt;
    &lt;br&gt;
    Any help?&lt;br&gt;
    &lt;br&gt;
    Thanks&lt;br&gt;
    &lt;div class="moz-signature"&gt;-- &lt;br&gt;
      Dr. Stefano Ghio - ENG Engineering Italy&lt;br&gt;
      &lt;br&gt;
      Website: &lt;a href="http://groglogs.blogspot.com/"&gt;http://groglogs.blogspot.com/&lt;/a&gt;&lt;br&gt;
      &lt;br&gt;
      &lt;b&gt;If you received this message but you are not its recipient,
        please ignore it and warn me, thank you.&lt;/b&gt;&lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;


</body></email><email><emailId>20111222195018</emailId><senderName>"Grant Siebrecht"</senderName><senderEmail>gsiebrecht@westianet.com</senderEmail><timestampReceived>2011-12-22 19:50:18-0400</timestampReceived><subject>Re: [libvirt-users] [virt-tools-list] error creating NFS storage pool</subject><body>

It looks like it has something to do with windows sharing on my storage appliance.
When I enable CIFS, that hidden folder appears.
The storage pool can't be created because the permissions on the .$EXTEND folder cannot be changed.
Apparently for the pool to be created virt-manager needs full access to all files and folders.
Grant




-----Original Message-----
From: Cole Robinson [mailto:crobinso@redhat.com]
Sent: Thu 12/22/2011 1:09 PM
To: Grant Siebrecht
Cc: libvirt-users@redhat.com
Subject: Re: [virt-tools-list] error creating NFS storage pool
 
On 12/16/2011 05:32 PM, Grant Siebrecht wrote:
&gt; Virtual Machine Manager 0.9.0
&gt; OS = Ubuntu 11.10
&gt; I've tried changing permissions on my_nfs_server to 777 with still no luck.
&gt; 
&gt; 
&gt; 
&gt; Error creating pool: Could not start storage pool: cannot open volume
&gt; '/var/lib/libvirt/images/my_nfs_server/.$EXTEND': Permission denied
&gt; 
&gt; Traceback (most recent call last):
&gt;   File "/usr/share/virt-manager/virtManager/asyncjob.py", line 44, in cb_wrapper
&gt;     callback(asyncjob, *args, **kwargs)
&gt;   File "/usr/share/virt-manager/virtManager/createpool.py", line 480, in
&gt; _async_pool_create
&gt;     poolobj = self._pool.install(create=True, meter=meter, build=build)
&gt;   File "/usr/lib/pymodules/python2.7/virtinst/Storage.py", line 489, in install
&gt;     raise RuntimeError(errmsg)
&gt; RuntimeError: Could not start storage pool: cannot open volume
&gt; '/var/lib/libvirt/images/my_nfs_server/.$EXTEND': Permission denied
&gt; 

moving to libvirt-users

What is the .$EXTEND file? Is it a socket or something strange like that?

- Cole



[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN"&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1"&gt;
&lt;META NAME="Generator" CONTENT="MS Exchange Server version 6.5.7654.12"&gt;
&lt;TITLE&gt;RE: [virt-tools-list] error creating NFS storage pool&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;!-- Converted from text/plain format --&gt;

&lt;P&gt;&lt;FONT SIZE=2&gt;It looks like it has something to do with windows sharing on my \
storage appliance.&lt;BR&gt; When I enable CIFS, that hidden folder appears.&lt;BR&gt;
The storage pool can't be created because the permissions on the .$EXTEND folder \
cannot be changed.&lt;BR&gt; Apparently for the pool to be created virt-manager needs full \
access to all files and folders.&lt;BR&gt; Grant&lt;BR&gt;
&lt;BR&gt;
&lt;BR&gt;
&lt;BR&gt;
&lt;BR&gt;
-----Original Message-----&lt;BR&gt;
From: Cole Robinson [&lt;A \
                HREF="mailto:crobinso@redhat.com"&gt;mailto:crobinso@redhat.com&lt;/A&gt;]&lt;BR&gt;
Sent: Thu 12/22/2011 1:09 PM&lt;BR&gt;
To: Grant Siebrecht&lt;BR&gt;
Cc: libvirt-users@redhat.com&lt;BR&gt;
Subject: Re: [virt-tools-list] error creating NFS storage pool&lt;BR&gt;
&lt;BR&gt;
On 12/16/2011 05:32 PM, Grant Siebrecht wrote:&lt;BR&gt;
&gt; Virtual Machine Manager 0.9.0&lt;BR&gt;
&gt; OS = Ubuntu 11.10&lt;BR&gt;
&gt; I've tried changing permissions on my_nfs_server to 777 with still no luck.&lt;BR&gt;
&gt;&lt;BR&gt;
&gt;&lt;BR&gt;
&gt;&lt;BR&gt;
&gt; Error creating pool: Could not start storage pool: cannot open volume&lt;BR&gt;
&gt; '/var/lib/libvirt/images/my_nfs_server/.$EXTEND': Permission denied&lt;BR&gt;
&gt;&lt;BR&gt;
&gt; Traceback (most recent call last):&lt;BR&gt;
&gt;   File "/usr/share/virt-manager/virtManager/asyncjob.py", \
line 44, in cb_wrapper&lt;BR&gt; &gt;     callback(asyncjob, *args, \
**kwargs)&lt;BR&gt; &gt;   File \
"/usr/share/virt-manager/virtManager/createpool.py", line 480, in&lt;BR&gt; &gt; \
_async_pool_create&lt;BR&gt; &gt;     poolobj = \
self._pool.install(create=True, meter=meter, build=build)&lt;BR&gt; &gt;   File \
"/usr/lib/pymodules/python2.7/virtinst/Storage.py", line 489, in \
install&lt;BR&gt; &gt;     raise RuntimeError(errmsg)&lt;BR&gt;
&gt; RuntimeError: Could not start storage pool: cannot open volume&lt;BR&gt;
&gt; '/var/lib/libvirt/images/my_nfs_server/.$EXTEND': Permission denied&lt;BR&gt;
&gt;&lt;BR&gt;
&lt;BR&gt;
moving to libvirt-users&lt;BR&gt;
&lt;BR&gt;
What is the .$EXTEND file? Is it a socket or something strange like that?&lt;BR&gt;
&lt;BR&gt;
- Cole&lt;BR&gt;
&lt;BR&gt;
&lt;BR&gt;
&lt;/FONT&gt;
&lt;/P&gt;

&lt;/BODY&gt;
&lt;/HTML&gt;



</body></email><email><emailId>20111223202415</emailId><senderName>David Mansfield</senderName><senderEmail>david@cobite.com</senderEmail><timestampReceived>2011-12-23 20:24:15-0400</timestampReceived><subject>Re: [libvirt-users] for a guest accessing host "full disk", how to prevent host vgscan</subject><body>



On 12/22/2011 02:00 PM, David Mansfield wrote:
&gt;
&gt;
&gt; On 12/22/2011 12:44 PM, Daniel P. Berrange wrote:
&gt;&gt; On Thu, Dec 22, 2011 at 09:20:01AM -0500, David Mansfield wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; On 12/21/2011 05:41 PM, Daniel P. Berrange wrote:
&gt;&gt;&gt;&gt; On Wed, Dec 21, 2011 at 05:23:33PM -0500, David Mansfield wrote:
&gt;&gt;&gt;&gt;&gt; Hi All.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; I have a dell system with a H700 raid. Within the hardware RAID
&gt;&gt;&gt;&gt;&gt; config I've created a "virtual disk" which I have assigned to one of
&gt;&gt;&gt;&gt;&gt; my guests. On the host the device is "/dev/sdb", on the guest it's
&gt;&gt;&gt;&gt;&gt; "/dev/vdb".
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; This works fine.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Within the guest, we have created lvm PV on /dev/vdb (using the
&gt;&gt;&gt;&gt;&gt; whole disk - no partitions) and created a volume group. The guest's
&gt;&gt;&gt;&gt;&gt; hostname is "argo" and the vg is called "vg_argo_bkup".
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; When I reboot the host, it does a vgscan and finds the volume group
&gt;&gt;&gt;&gt;&gt; and activates it in the _host_, which I need to prevent (I think??).
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; I have successfully done this by filtering "/dev/sdb" in
&gt;&gt;&gt;&gt;&gt; /etc/lvm/lvm.conf (which does NOT work as advertised BTW), but
&gt;&gt;&gt;&gt;&gt; referencing the extremely volatile SCSI "sd*" names seems a terrible
&gt;&gt;&gt;&gt;&gt; way to do this. If I fiddle around in the HW raid config, the
&gt;&gt;&gt;&gt;&gt; /dev/sd? may change.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; I plan on creating about 10 more VM's spread over a number of
&gt;&gt;&gt;&gt;&gt; machines over the next weeks with a very similar setup, and the
&gt;&gt;&gt;&gt;&gt; admin overhead seems like it'll be onerous and error-prone.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; I'd love to be able to filter the volume groups by VG name instead
&gt;&gt;&gt;&gt;&gt; of pv device node. The host's hostname is "narnia" and I'd love to
&gt;&gt;&gt;&gt;&gt; say, 'vgscan --include-regex "vg_narnia.*"' or something similar, if
&gt;&gt;&gt;&gt;&gt; you get my drift.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Does anyone have a best practice for this? I'm sure iSCSI
&gt;&gt;&gt;&gt;&gt; enthusiasts must have the exact same issue all the time.
&gt;&gt;&gt;&gt; The recommended approach is not to assign the entire disk to the
&gt;&gt;&gt;&gt; guest. Partition the host disk, to contain 1 single partition
&gt;&gt;&gt;&gt; consuming all space, then assign the partition to the guest. Worst
&gt;&gt;&gt;&gt; case is you loose a few KB of space due to partition alignment, but
&gt;&gt;&gt;&gt; this is a small price to pay to avoid the LVM problems you describe
&gt;&gt;&gt;&gt; all to well.
&gt;&gt;&gt; I don't really understand. The host still scans the partitions,
&gt;&gt;&gt; right? And the partition "dev" names change dynamically if the
&gt;&gt;&gt; whole-disk changes it's "dev" name. Won't I still have to list
&gt;&gt;&gt; specific volatile names in the /etc/lvm/lvm.conf on the host?
&gt;&gt; The host will see '/dev/sda' and '/dev/sda1', you'll assign
&gt;&gt; ' /dev/sda1' to the guest, and it will appear as /dev/vda.
&gt;&gt; In the guest you'll create '/dev/vda1' and format it as the
&gt;&gt; PV. So while the host will see /dev/sda1, it won't see the
&gt;&gt; nested partition table, and thus won't see the PV
&gt;
&gt; Ahhh. Brilliant. Thanks. Now the only problem is getting the underlying
&gt; stripe alignment right ;-)
&gt;

In case anyone googles this (or is on this list and curious ;-) and gets 
to the last part, about aligning the partitions, I thought I'd mention 
the completely bizarre behavior I'm seeing.

First of all, with a 3TB "disk", you have to use the GPT label, 
available in 'parted' and not in 'fdisk'.  Anyway, my particular "disk" 
is a RAID5 (on my H700 raid controller) of 4 disks, with a 64k stripe 
element.  Therefore each full-stripe is 192k.  This is 384 512-byte 
sectors.  So I used this line in parted:

mkpart primary 384s  5857345502s

And the performance on /dev/sda1 sucked compared to /dev/sda.  I tried 
many different alignments, then finally tried:

mkpart primary 383s  5857345502s

And voila!

I can't explain this, because I can verify the partition start sector is 
indeed 383 according to /sys/block/sda1/start, so it's not a 'parted' 
bug or anything.

The difference in the host was significant, but I went further and 
assigned the partition, with different alignments, to the VM and tested 
there and the difference was magnified.  When aligned, the VM hit very 
close to bare metal speed, but when unaligned it suffered a perf hit 
(about 50% of when aligned) vs bare metal (which was slower anyway to 
the misalignment).

So thanks to Daniel who gave me the trick, and a reverse-thanks to the 
gods of the computers for coming up with this bizarre unexpected result.

David Mansfield
Cobite, INC.

</body></email><email><emailId>20111223235957</emailId><senderName>"Sergey Sudakovich (ssudakov)"</senderName><senderEmail>ssudakov@cisco.com</senderEmail><timestampReceived>2011-12-23 23:59:57-0400</timestampReceived><subject>[libvirt-users] Libvirt java from Windows</subject><body>

I am writing a java based client that would be executed from windows
that will use libvirt.

1.       Got libvirt-java (
http://libvirt.org/sources/java/libvirt-java-0.4.7.tar.gz) and build a
jar out it (ant with no params)

2.       Then, according to http://libvirt.org/windows.html, built a dll
using the "MSYS build script"

3.       Got 2 files libvirt-0.dll and libqemu-0.dll

When I run the sample example(from Eclipse) from
http://libvirt.org/java.html I get the following error:

 

Exception in thread "main" java.lang.UnsatisfiedLinkError: Unable to
load library 'virt': %1 is not a valid Win32 application.

 

      at com.sun.jna.NativeLibrary.loadLibrary(NativeLibrary.java:169)

      at com.sun.jna.NativeLibrary.getInstance(NativeLibrary.java:242)

      at com.sun.jna.Library$Handler.&lt;init&gt;(Library.java:140)

      at com.sun.jna.Native.loadLibrary(Native.java:368)

      at com.sun.jna.Native.loadLibrary(Native.java:353)

      at org.libvirt.jna.Libvirt.&lt;clinit&gt;(Unknown Source)

      at org.libvirt.Connect.&lt;clinit&gt;(Unknown Source)

      at Main.main(Main.java:26)

 

 

Also tried instead of step 2 cross compile in Fedora - same error
message when I use new dll's.

 

Does anybody have any idea where do I start fixing the issue??

 

-- 

Thank you,

Sergey Sudakovich 

 


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;&lt;head&gt;&lt;meta http-equiv=Content-Type \
content="text/html; charset=us-ascii"&gt;&lt;meta name=Generator content="Microsoft Word 12 \
(filtered medium)"&gt;&lt;style&gt;&lt;!-- /* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{mso-style-priority:34;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
/* List Definitions */
@list l0
	{mso-list-id:763108206;
	mso-list-type:hybrid;
	mso-list-template-ids:-927172964 67698703 67698713 67698715 67698703 67698713 \
67698715 67698703 67698713 67698715;} @list l0:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
--&gt;&lt;/style&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapelayout v:ext="edit"&gt;
&lt;o:idmap v:ext="edit" data="1" /&gt;
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;&lt;/head&gt;&lt;body lang=EN-US link=blue vlink=purple&gt;&lt;div \
class=WordSection1&gt;&lt;p class=MsoNormal&gt;I am writing a java based client that would be \
executed from windows that will use libvirt.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoListParagraph \
style='text-indent:-.25in;mso-list:l0 level1 lfo1'&gt;&lt;![if !supportLists]&gt;&lt;span \
style='mso-list:Ignore'&gt;1.&lt;span style='font:7.0pt "Times New \
Roman"'&gt;       &lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;Got libvirt-java \
( &lt;a href="http://libvirt.org/sources/java/libvirt-java-0.4.7.tar.gz"&gt;http://libvirt.org/sources/java/libvirt-java-0.4.7.tar.gz&lt;/a&gt;) \
and build a jar out it (ant with no params)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoListParagraph \
style='text-indent:-.25in;mso-list:l0 level1 lfo1'&gt;&lt;![if !supportLists]&gt;&lt;span \
style='mso-list:Ignore'&gt;2.&lt;span style='font:7.0pt "Times New \
Roman"'&gt;       &lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;Then, according \
to &lt;a href="http://libvirt.org/windows.html"&gt;http://libvirt.org/windows.html&lt;/a&gt;, \
built a dll using the “MSYS build script”&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoListParagraph style='text-indent:-.25in;mso-list:l0 level1 lfo1'&gt;&lt;![if \
!supportLists]&gt;&lt;span style='mso-list:Ignore'&gt;3.&lt;span style='font:7.0pt "Times New \
Roman"'&gt;       &lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;Got 2 files \
libvirt-0.dll and libqemu-0.dll&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;When I run the \
sample example(from Eclipse) from &lt;a \
href="http://libvirt.org/java.html"&gt;http://libvirt.org/java.html&lt;/a&gt; I get the \
following error:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier New";color:red'&gt;Exception in thread \
"main" java.lang.UnsatisfiedLinkError: Unable to load library 'virt': %1 is \
not a valid Win32 application.&lt;/span&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier New"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier New"'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier \
New";color:red'&gt;      at \
com.sun.jna.NativeLibrary.loadLibrary(&lt;/span&gt;&lt;u&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier \
New";color:navy'&gt;NativeLibrary.java:169&lt;/span&gt;&lt;/u&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier New";color:red'&gt;)&lt;/span&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier New"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier \
New";color:red'&gt;      at \
com.sun.jna.NativeLibrary.getInstance(&lt;/span&gt;&lt;u&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier \
New";color:navy'&gt;NativeLibrary.java:242&lt;/span&gt;&lt;/u&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier New";color:red'&gt;)&lt;/span&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier New"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier \
New";color:red'&gt;      at \
com.sun.jna.Library$Handler.&lt;init&gt;(&lt;/span&gt;&lt;u&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier \
New";color:navy'&gt;Library.java:140&lt;/span&gt;&lt;/u&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier New";color:red'&gt;)&lt;/span&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier New"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier \
New";color:red'&gt;      at \
com.sun.jna.Native.loadLibrary(&lt;/span&gt;&lt;u&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier \
New";color:navy'&gt;Native.java:368&lt;/span&gt;&lt;/u&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier New";color:red'&gt;)&lt;/span&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier New"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier \
New";color:red'&gt;      at \
com.sun.jna.Native.loadLibrary(&lt;/span&gt;&lt;u&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier \
New";color:navy'&gt;Native.java:353&lt;/span&gt;&lt;/u&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier New";color:red'&gt;)&lt;/span&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier New"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier \
New";color:red'&gt;      at \
org.libvirt.jna.Libvirt.&lt;clinit&gt;(Unknown Source)&lt;/span&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier New"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal style='text-autospace:none'&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier \
New";color:red'&gt;      at \
org.libvirt.Connect.&lt;clinit&gt;(Unknown Source)&lt;/span&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier New"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span style='font-size:10.0pt;font-family:"Courier \
New";color:red'&gt;      at Main.main(&lt;/span&gt;&lt;u&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier \
New";color:navy'&gt;Main.java:26&lt;/span&gt;&lt;/u&gt;&lt;span \
style='font-size:10.0pt;font-family:"Courier \
New";color:red'&gt;)&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;i&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/i&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;Also tried instead of step 2 \
cross compile in Fedora – same error message when I use new \
dll’s.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;Does anybody have any idea where do I start fixing the \
issue??&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;-- \
&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;Thank you,&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;Sergey \
Sudakovich &lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20111228134203</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-12-28 13:42:03-0400</timestampReceived><subject>Re: [libvirt-users] cannot find -lportablexdr</subject><body>


On 12/27/2011 09:01 PM, Juliano Souza wrote:
&gt; When I try to compile libvirt:
&gt; 
&gt; checking for xdrmem_create in -lportablexdr... no
&gt; checking for library containing xdrmem_create... no
&gt; configure: error: Cannot find a XDR library

What platform are you compiling on?  For example, on Fedora 16, glibc
provides xdr functionality natively; whereas if you are cross-compiling
for mingw, the mingw32-portablexdr package provides the necessary
headers. A quick google search gives
http://people.redhat.com/~rjones/portablexdr/ as the place to look for
source code if you are on some other platform.

-- 
Eric Blake   eblake@redhat.com    +1-919-301-3266
Libvirt virtualization library http://libvirt.org


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20111228150906</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-12-28 15:09:06-0400</timestampReceived><subject>Re: [libvirt-users] How to connect to a remote VM ESXi server with Python language?</subject><body>

2011/12/26 ice &lt;ice_feng@usish.com&gt;:
&gt; Hi, Dear Mr/Mrs.
&gt;
&gt; I have trouble in connecting to a VM ESXi server with python.
&gt;
&gt; I am a developer using libvirt to control remote VM ESXi with python
&gt; language. But I am not able to connect to a remote VM ESXi server.
&gt;
&gt; I make my try to solve this issue:
&gt;
&gt; 1: I use the function libvirt.Open() to open the remote VM ESXi Server, but
&gt; I don't know how to input the password. It seems that there is no parameter
&gt; for password input.

Let's just ignore your second try with virsh. The problem with your
first try is that you need to use libvirt.openAuth() instead of
libvirt.open(). openAuth() allows to pass credentials via a callback
mechanism.

There is a Python example in the libvirt codebase that does this, see

  http://libvirt.org/git/?p=libvirt.git;a=blob;f=examples/python/esxlist.py

-- 
Matthias Bolte
http://photron.blogspot.com

</body></email><email><emailId>20111229153250</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-12-29 15:32:50-0400</timestampReceived><subject>Re: [libvirt-users] redirect ports from user network</subject><body>

On 2011年12月29日 16:38, Алексей Беляев wrote:
&gt; Hello.
&gt; I would like to redirect some ports from user network to host system.
&gt; 
&gt; In console i can do it:
&gt; /usr/libexec/qemu-kvm -drive file=/home/libvirt/qemu-fedora.img -vnc
&gt; 10.200.1.1:1 -net user -redir tcp:22000::49999 -redir tcp:22001::22
&gt; 
&gt; How can i do it with libvirt?
&gt; I make users network in XML config VM:
&gt; 
&gt; &lt;interface type='user'&gt;
&gt; &lt;mac address='52:54:00:48:3f:f5'/&gt;
&gt; &lt;alias name='net0'/&gt;
&gt; &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03'
&gt; function='0x0'/&gt;
&gt; &lt;/interface&gt;
&gt; 
&gt; But i don't know - how to make redirecting ports and i cann't fint it
&gt; in documentation. Is it possible?
&gt; 

The only way to do that is use qemu:commandline. The tests below can
serve the examples to you:

http://libvirt.org/git/?p=libvirt.git;a=tree;f=tests/qemuxmlnsdata;h=36d7c838d7d31461c3028cd866c2565ecf1e23d1;hb=HEAD


We need to support the -redir option. But before we support that,
you can use qemu:commandline instead.

Regards,
Osier


</body></email><email><emailId>20111230065836</emailId><senderName>"ice"</senderName><senderEmail>ice_feng@usish.com</senderEmail><timestampReceived>2011-12-30 06:58:36-0400</timestampReceived><subject>[libvirt-users] =?gb2312?b?tPC4tDogIEhvdyB0byBjb25uZWN0IHRvIGEg?= =?gb2312?b?cmVtb3RlIFZNIEVTWGkgc2V</subject><body>

Hi, Matthias,
Thanks for your reply. 
I look into the example, and I am now having connected to the remote VM ESXi
Server.

Thanks a lot for your help.
Best Regards.


 
-----ÓÊ¼þÔ­¼þ-----
·¢¼þÈË: Matthias Bolte [mailto:matthias.bolte@googlemail.com] 
·¢ËÍÊ±¼ä: 2011Äê12Ô 28ÈÕ 23:09
ÊÕ¼þÈË: ice
³­ËÍ: libvirt-users@redhat.com; libvir-list@redhat.com
Ö÷Ìâ: Re: [libvirt-users] How to connect to a remote VM ESXi server with
Python language?

2011/12/26 ice &lt;ice_feng@usish.com&gt;:
&gt; Hi, Dear Mr/Mrs.
&gt;
&gt; I have trouble in connecting to a VM ESXi server with python.
&gt;
&gt; I am a developer using libvirt to control remote VM ESXi with python
&gt; language. But I am not able to connect to a remote VM ESXi server.
&gt;
&gt; I make my try to solve this issue:
&gt;
&gt; 1: I use the function libvirt.Open() to open the remote VM ESXi Server,
but
&gt; I don¡¯t know how to input the password. It seems that there is no
parameter
&gt; for password input.

Let's just ignore your second try with virsh. The problem with your
first try is that you need to use libvirt.openAuth() instead of
libvirt.open(). openAuth() allows to pass credentials via a callback
mechanism.

There is a Python example in the libvirt codebase that does this, see

  http://libvirt.org/git/?p=libvirt.git;a=blob;f=examples/python/esxlist.py

-- 
Matthias Bolte
http://photron.blogspot.com


</body></email><email><emailId>20111106002731</emailId><senderName>Brian Candler</senderName><senderEmail>b.candler@pobox.com</senderEmail><timestampReceived>2011-11-06 00:27:31-0400</timestampReceived><subject>[libvirt-users] libvirt, OSX and VirtualBox - how?</subject><body>

I have a new OSX Lion Macbook and would like to control VirtualBox using
"virsh" (as I do with KVM under Ubuntu).

I've got this far:

* Installed VirtualBox
* Installed libvirt (brew install libvirt)

But now I'm a bit stuck :-)

I ran VirtualBox itself, and created a test VM successfully.

If I try to use virsh, this is what I get:

Brians-MacBook-Air:~ $ virsh -c vbox:///session
error: internal error unable to initialize VirtualBox driver API
error: failed to connect to the hypervisor
Brians-MacBook-Air:~ $ virsh -c vbox+unix:///session
error: Failed to connect socket to '@/Users/brian/.libvirt/libvirt-sock': No such \
                file or directory
error: failed to connect to the hypervisor

If I try to start libvirtd, this is what I get:

Brians-MacBook-Air:~ $ /usr/local/sbin/libvirtd 
00:00:18.970: -1: info : libvirt version: 0.9.6
00:00:18.970: -1: error : virNetSocketNewListenUNIX:340 : Failed to bind socket to \
'@/Users/brian/.libvirt/libvirt-sock': No such file or directory

[but directory /Users/brian/.libvirt was created]

However, VirtualBox itself is running OK:

Brians-MacBook-Air:~ $ VBoxManage list vms
"test" {d0d74c25-1dfc-44a4-8a2b-1d25b7972e7c}

Furthermore, dtruss suggests that virsh is finding the installed VirtualBox:

Brians-MacBook-Air:~ $ sudo dtruss -f virsh -c vbox:///session 2&gt;&amp;1 | grep -i \
                virtualbox
error: internal error unable to initialize VirtualBox driver API
48916/0x3cc08:  write_nocancel(0x2, "internal error unable to initialize VirtualBox \
                driver API\n\0", 0x3A)		 = 58 0
48916/0x3cc08:  access("/usr/lib/virtualbox/VBoxXPCOMC.dylib\0", 0x0, 0x0)	 = -1 \
                Err#2
48916/0x3cc08:  access("/usr/lib/virtualbox-ose/VBoxXPCOMC.dylib\0", 0x0, 0x0)	 = -1 \
                Err#2
48916/0x3cc08:  access("/usr/lib64/virtualbox/VBoxXPCOMC.dylib\0", 0x0, 0x0)	 = -1 \
                Err#2
48916/0x3cc08:  access("/usr/lib64/virtualbox-ose/VBoxXPCOMC.dylib\0", 0x0, 0x0) = -1 \
                Err#2
48916/0x3cc08:  access("/usr/lib/VirtualBox/VBoxXPCOMC.dylib\0", 0x0, 0x0)	 = -1 \
                Err#2
48916/0x3cc08:  access("/opt/virtualbox/VBoxXPCOMC.dylib\0", 0x0, 0x0)		 = -1 Err#2
48916/0x3cc08:  access("/opt/VirtualBox/VBoxXPCOMC.dylib\0", 0x0, 0x0)		 = -1 Err#2
48916/0x3cc08:  access("/opt/virtualbox/i386/VBoxXPCOMC.dylib\0", 0x0, 0x0)	 = -1 \
                Err#2
48916/0x3cc08:  access("/opt/VirtualBox/i386/VBoxXPCOMC.dylib\0", 0x0, 0x0)	 = -1 \
                Err#2
48916/0x3cc08:  access("/opt/virtualbox/amd64/VBoxXPCOMC.dylib\0", 0x0, 0x0)	 = -1 \
                Err#2
48916/0x3cc08:  access("/opt/VirtualBox/amd64/VBoxXPCOMC.dylib\0", 0x0, 0x0)	 = -1 \
                Err#2
48916/0x3cc08:  access("/usr/local/lib/virtualbox/VBoxXPCOMC.dylib\0", 0x0, 0x0) = -1 \
                Err#2
48916/0x3cc08:  access("/usr/local/lib/VirtualBox/VBoxXPCOMC.dylib\0", 0x0, 0x0) = -1 \
                Err#2
48916/0x3cc08:  access("/Applications/VirtualBox.app/Contents/MacOS/VBoxXPCOMC.dylib\0", \
                0x0, 0x0)		 = 0 0
48916/0x3cc08:  stat64("/Applications/VirtualBox.app/Contents/MacOS/VBoxXPCOMC.dylib\0", \
                0x7FFF685D0980, 0x7FFF685D1810)		 = 0 0
48916/0x3cc08:  open("/Applications/VirtualBox.app/Contents/MacOS/VBoxXPCOMC.dylib\0", \
                0x0, 0x0)		 = 4 0
48916/0x3cc08:  stat64("/Applications/VirtualBox.app/Contents/MacOS/VBoxRT.dylib\0", \
                0x7FFF685D0750, 0x7FFF685D15D0)		 = 0 0
48916/0x3cc08:  open("/Applications/VirtualBox.app/Contents/MacOS/VBoxRT.dylib\0", \
                0x0, 0x0)		 = 4 0
48916/0x3cc08:  stat64("/Applications/VirtualBox.app/Contents/MacOS/VBoxXPCOM.dylib\0", \
                0x7FFF685D0750, 0x7FFF685D15D0)		 = 0 0
48916/0x3cc08:  open("/Applications/VirtualBox.app/Contents/MacOS/VBoxXPCOM.dylib\0", \
0x0, 0x0)		 = 4 0

But looking at the dtruss output shortly before it prints the error message
doesn't give me any clues as to what's going wrong.

...
48916/0x3cc08:  stat64("/usr/lib/libbsm.0.dylib\0", 0x7FFF685D0090, 0x7FFF685D0F10)   \
                = 0 0
48916/0x3cc08:  stat64("/System/Library/PrivateFrameworks/Heimdal.framework/Versions/A/Heimdal\0", \
                0x7FFF685D0290, 0x7FFF685D1110)               = 0 0
48916/0x3cc08:  stat64("/usr/lib/libncurses.5.4.dylib\0", 0x7FFF685D05A0, \
                0x7FFF685D1420)                = 0 0
48916/0x3cc08:  getpid(0x7FFF685D1628, 0x108A16004, 0xEA60)              = 48916 0
48916/0x3cc08:  open("/dev/dtracehelper\0", 0x2, 0xFFFFFFFFFFFFFFB0)             = 4 \
                0
48916/0x3cc08:  ioctl(0x4, 0x80086804, 0x7FFF685D1708)           = 0 0
48916/0x3cc08:  close(0x4)               = 0 0
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  sigaction(0xD, 0x7FFF685D1978, 0x0)              = 0 0
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  pipe(0x108BF1D90, 0x1000004, 0x7)                = 4 0
48916/0x3cc08:  fcntl(0x5, 0x3, 0x0)             = 1 0
48916/0x3cc08:  fcntl(0x5, 0x4, 0x5)             = 0 0
48916/0x3cc08:  fcntl(0x4, 0x3, 0x0)             = 0 0
48916/0x3cc08:  fcntl(0x4, 0x4, 0x4)             = 0 0
48916/0x3cc08:  fcntl(0x5, 0x1, 0x0)             = 0 0
48916/0x3cc08:  fcntl(0x5, 0x2, 0x1)             = 0 0
48916/0x3cc08:  fcntl(0x4, 0x1, 0x0)             = 0 0
48916/0x3cc08:  fcntl(0x4, 0x2, 0x1)             = 0 0
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  getuid(0x7F9ABBC2B850, 0x108BED7A0, 0x0)                 = 0 0
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  gettid(0x0, 0x7FFF74AC9F00, 0x108A32B58)                 = -1 Err#3
48916/0x3cc08:  write_nocancel(0x2, "error: \0", 0x7)            = 7 0
48916/0x3cc08:  write_nocancel(0x2, "internal error unable to initialize VirtualBox \
                driver API\n\0", 0x3A)               = 58 0
48916/0x3cc08:  write_nocancel(0x2, "error: \0", 0x7)            = 7 0
48916/0x3cc08:  write_nocancel(0x2, "failed to connect to the hypervisor\n\0", 0x24)  \
                = 36 0
48916/0x3cc08:  close(0x3)               = 0 0
48916/0x3cc08:  __sysctl(0x7FFF685D0F4C, 0x2, 0x7FFF685D0F38)            = 0 0
48916/0x3cc08:  bsdthread_register(0x7FFF8DCDCB68, 0x7FFF8DCDCB78, 0x2000)            \
                = 0 0
48916/0x3cc08:  thread_selfid(0x7FFF8DCDCB68, 0x7FFF8DCDCB78, 0x0)               = \
                248840 0
...

Has anybody got libvirt + OSX Lion + VirtualBox working, and if so, how did
you do it?

I see the same question asked here:
http://stackoverflow.com/questions/7946994/libvirt-and-virtualbox-on-osx
but unfortunately no response as yet.

Thanks in advance,

Brian.


</body></email><email><emailId>20111111020849</emailId><senderName></senderName><senderEmail>zhanggp@neusoft.com</senderEmail><timestampReceived>2011-11-11 02:08:49-0400</timestampReceived><subject>[libvirt-users] How to create virtual machine via virsh shell?</subject><body>

[Attachment #2 (text/plain)]


Hi,

I recently in the study of the knowledge of the libvirt(version 0.9.6) and \
vmware(3.0beta1) ,  I use virshshell doing some work such as create virtual \
machine(but i get an error like "the connetc driver do not support") , define virtual \
machine(success but when i start it i get an error like "can not find vmdk file \
»òÆäËùÒÀÀµµÄ¿ìÕÕ´ÅÅÌÖ®Ò»"). Then I realized to first create a volume , but I again \
meet a mistake like "internal error Could not create volume: NotImplemented".

Excuse me.How should I do the right to create or define a virtual machine and the \
normal starting  it?


Regards!

zhanggp
---------------------------------------------------------------------------------------------------
 Confidentiality Notice: The information contained in this e-mail and any \
accompanying attachment(s)  is intended only for the use of the intended recipient \
and may be confidential and/or privileged of  Neusoft Corporation, its subsidiaries \
and/or its affiliates. If any reader of this communication is  not the intended \
recipient, unauthorized use, forwarding, printing,  storing, disclosure or copying  \
is strictly prohibited, and may be unlawful.If you have received this communication \
in error,please  immediately notify the sender by return e-mail, and delete the \
original message and all copies from  your system. Thank you. 
---------------------------------------------------------------------------------------------------



[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;
&lt;HTML&gt;&lt;HEAD&gt;
&lt;STYLE type=text/css&gt;@import url( C:\Documents and Settings\Administrator\Local \
Settings\Temporary Internet Files\scrollbar.css ); &lt;/STYLE&gt;

&lt;META content="text/html; charset=GB2312" http-equiv=Content-Type&gt;
&lt;STYLE&gt;BLOCKQUOTE {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; MARGIN-LEFT: 2em
}
OL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
UL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
&lt;/STYLE&gt;

&lt;META name=GENERATOR content="MSHTML 8.00.6001.19154"&gt;&lt;/HEAD&gt;
&lt;BODY style="MARGIN: 10px"&gt;&lt;FONT size=2 face=Verdana&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;Hi,&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt; &lt;/DIV&gt;
&lt;DIV 
style="TEXT-INDENT: 2em"&gt;I recently in the study of the&amp; \
nbsp;knowledge of the libvirt(version 0.9.6) and vmware( \
3.0beta1) ,  I use virshshell doing some work such as create virtual machine(but \
 i get an error like "the connetc driver do not support") , define virtual 
machine(success but when i start it i get an error like "can not find vmdk file 
&lt;SPAN 
style="FONT-FAMILY: ËÎÌå; FONT-SIZE: 10.5pt; mso-bidi-font-size: 12.0pt; \
mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; \
mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 1.0pt; mso-ansi-language: \
EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: \
AR-SA"&gt;»òÆäËùÒÀÀµµÄ¿ìÕÕ´ÅÅÌÖ®Ò»&lt;/SPAN&gt;").  \
Then I realized to first create a volume ,  \
but I again meet a mistake like "&lt;SPAN  style="FONT-FAMILY: \
'Times New Roman','serif'; FONT-SIZE: 10.5pt; mso-font-kerning: 1.0pt; \
mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; \
mso-fareast-font-family: ËÎÌå"  lang=EN-US&gt;internal error Could not create volume: \
NotImplemented&lt;/SPAN&gt;".&lt;/DIV&gt; &lt;DIV style="TEXT-INDENT: 2em"&gt; &lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt;Excuse 
me.How should I do the right to create or define a virtual machine and \
 the normal starting  it?&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt; &lt;/DIV&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt;Regards!&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt; &lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt;zhanggp&lt;/DIV&gt;&lt;/FONT&gt;&lt;font \
face="monospace"&gt;---------------------------------------------------------------------------------------------------&lt;br&gt;
 Confidentiality Notice: The information contained in this e-mail and any \
accompanying attachment(s) &lt;br&gt; is intended only for the use of the intended \
recipient and may be confidential and/or privileged of &lt;br&gt; Neusoft Corporation, its \
subsidiaries and/or its affiliates. If any reader of this communication is &lt;br&gt; not \
the intended recipient, unauthorized use, forwarding, printing,  storing, \
disclosure or copying &lt;br&gt; is strictly prohibited, and may be unlawful.If you have \
received this communication in error,please &lt;br&gt; immediately notify the sender by \
return e-mail, and delete the original message and all copies from &lt;br&gt; your system. \
                Thank you. &lt;br&gt;
---------------------------------------------------------------------------------------------------&lt;/font&gt;&lt;/BODY&gt;&lt;/HTML&gt;




</body></email><email><emailId>20111111162946</emailId><senderName>Jeff Gaer</senderName><senderEmail>jeff_gaer@yahoo.com</senderEmail><timestampReceived>2011-11-11 16:29:46-0400</timestampReceived><subject>[libvirt-users] diificulty installing or building libvert</subject><body>

I am unable to install or build libvert for RHEL4-64. Due to the errors below. Is it \
because all the source/rpms are for Fedora? I don't see any redhat versions on the \
sources page. Thanks in advance for any help.


When running make against the untarred /libvirt-0.9.4.tar.gz configure succeeds but \
make fails.

make  all-am

make[3]: Entering directory `/home/jgaer/Desktop/NiFi/libvirt-0.9.4/src'
  CC     libvirt_driver_nwfilter_la-nwfilter_learnipaddr.lo
nwfilter/nwfilter_learnipaddr.c: In function 'learnIPAddressThread':
nwfilter/nwfilter_learnipaddr.c:522: error: 'ETHERTYPE_VLAN' undeclared (first use in \
this function) nwfilter/nwfilter_learnipaddr.c:522: error: (Each undeclared \
identifier is reported only once nwfilter/nwfilter_learnipaddr.c:522: error: for each \
function it appears in.)


installing the src rpm fails

jgaer@ljgaer_~/Desktop/NiFi: sudo rpm -i libvirt-0.9.0-1.fc14.src.rpm

[sudo] password for jgaer:
warning: libvirt-0.9.0-1.fc14.src.rpm: Header V3 DSA signature: NOKEY, key ID \
                de95bc1f
warning: user veillard does not exist - using root
warning: group www does not exist - using root
error: unpacking of archive failed on file \
/usr/src/redhat/SOURCES/libvirt-0.9.0.tar.gz;4ebd4829: cpio: MD5 sum mismatch


when trying to install  rpm -i  libvirt-0.9.7-1.fc14.x86_64.rpm
 even with –force I get a long list of unresolved dependencies including all \
previous versions of libvirt.so

Trying to use rpmbuild results in the following missing dependancies. I am unable to \
build or install the libpcap-devel because of a dependency on libcap1 which seems to \
only exist for suse,


jgaer@ljgaer_~/Desktop/NiFi: sudo rpmbuild -ta libvirt-0.9.4.tar.gz

[sudo] password for jgaer:

error: Failed build dependencies:

        libtasn1-devel is needed by libvirt-0.9.4-1.x86_64
        libpcap-devel is needed by libvirt-0.9.4-1.x86_64
        libnl-devel is needed by libvirt-0.9.4-1.x86_64
        radvd is needed by libvirt-0.9.4-1.x86_64
        ebtables is needed by libvirt-0.9.4-1.x86_64
        /usr/bin/qemu-img is needed by libvirt-0.9.4-1.x86_64
        parted-devel is needed by libvirt-0.9.4-1.x86_64
        device-mapper-devel is needed by libvirt-0.9.4-1.x86_64
        numactl-devel is needed by libvirt-0.9.4-1.x86_64
        libssh2-devel is needed by libvirt-0.9.4-1.x86_64

Jeff


</body></email><email><emailId>20111111042131</emailId><senderName>PREETHI RAMESH</senderName><senderEmail>iampreethiramesh@gmail.com</senderEmail><timestampReceived>2011-11-11 04:21:31-0400</timestampReceived><subject>[libvirt-users] Problem with listDomains() in Xen</subject><body>

This question concerns the usage of the listDomains(). When I run this
piece of code in KVM, it works perfectly fine but throws an array out of
bounds exception in Xen.

 Connect conn=null;
 conn = new Connect("xen:///", true);
 int[] id = conn.listDomains();
 System.out.println("lD of VM " +id[0]);

Answer I'd got:
Well, your code assumes that id.length is &gt;= 1, but listDomains() can
return an empty array when there are no active domains known to
libvirt. So you need to check id.length before accessing any element
in the array.

Follow up- I tried accessing the length of the array and it's 0 all the
time. And there are active domains available.
In fact, I'm able to getUUID from the domain name. Other functions work
fine too.

Am I missing something?Can someone please help me? Thanks!

[Attachment #3 (text/html)]

This question concerns the usage of the listDomains(). When I run this&lt;br&gt;
piece of code in KVM, it works perfectly fine but throws an array out of&lt;br&gt;bounds \
exception in Xen.&lt;br&gt; &lt;br&gt; Connect conn=null;&lt;br&gt; conn = new \
Connect("xen:///", true);&lt;br&gt; int[] id = conn.listDomains();&lt;br&gt; \
System.out.println("lD of VM " +id[0]);&lt;br&gt; &lt;br&gt;Answer I'd got:&lt;br&gt;
Well, your code assumes that id.length is &gt;= 1, but listDomains() can&lt;br&gt;
return an empty array when there are no active domains known to&lt;br&gt;
libvirt. So you need to check id.length before accessing any element&lt;br&gt;
in the array.&lt;br&gt;&lt;br&gt;Follow up- I tried accessing the length of the array and \
it's 0 all the time. And there are active domains available.&lt;br&gt;In fact, I'm \
able to getUUID from the domain name. Other functions work fine too.&lt;br&gt;

&lt;br&gt;Am I missing something?Can someone please help me? Thanks!



</body></email><email><emailId>20111113091502</emailId><senderName>Jatin Kumar</senderName><senderEmail>cs5090243@cse.iitd.ernet.in</senderEmail><timestampReceived>2011-11-13 09:15:02-0400</timestampReceived><subject>[libvirt-users] CPU and RAM utilization</subject><body>

Hello,
I have a few vms running on a blade server and i want to log the actual RAM
and CPU
utilization by these vms. dom.info(), libvirt API call is not giving
correct results. It is always
showing the max allocated resources.
I have tried using virt-top also but same problem persists.

Is there any thing that i am missing.

--
Jatin Kumar

[Attachment #3 (text/html)]

Hello,&lt;div&gt;I have a few vms running on a blade server and i want to log the actual \
RAM and CPU&lt;/div&gt;&lt;div&gt;utilization by these vms. &lt;a \
href="http://dom.info"&gt;dom.info&lt;/a&gt;(), libvirt API call is not giving correct \
results. It is always&lt;/div&gt;

&lt;div&gt;showing the max allocated resources.&lt;/div&gt;&lt;div&gt;I have tried using virt-top also \
but same problem persists.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is there any thing that i am \
missing. &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;--&lt;/div&gt;&lt;div&gt;Jatin Kumar&lt;/div&gt;



</body></email><email><emailId>20111114093508</emailId><senderName></senderName><senderEmail>zhanggp@neusoft.com</senderEmail><timestampReceived>2011-11-14 09:35:08-0400</timestampReceived><subject>[libvirt-users] libvirt0.8.7.tar.gz installation failure</subject><body>

[Attachment #2 (text/plain)]


Hi:
I get a very strange problem when I installing libvirt0.8.7.tar.gz.
Here is my infomaton:

compute with RHELD6.0 systerm;
the systerm comes with libvirt0.8.7,bu I uninstalled it and its dependencies .
And then i download the libvirt0.8.7.tar.gz , untar it ,configure \
--with-esx,make,make install.

But I got an error like "libvirtd: /usr/local/lib/libvirt.so.0: version \
`LIBVIRT_PRIVATE_0.8.7' not found (required by libvirtd) "  when i use virsh,or \
libvirtd.

Can someone tell me what is the error mean?

Regards!

zhanggp@neusoft.com
---------------------------------------------------------------------------------------------------
 Confidentiality Notice: The information contained in this e-mail and any \
accompanying attachment(s)  is intended only for the use of the intended recipient \
and may be confidential and/or privileged of  Neusoft Corporation, its subsidiaries \
and/or its affiliates. If any reader of this communication is  not the intended \
recipient, unauthorized use, forwarding, printing,  storing, disclosure or copying  \
is strictly prohibited, and may be unlawful.If you have received this communication \
in error,please  immediately notify the sender by return e-mail, and delete the \
original message and all copies from  your system. Thank you. 
---------------------------------------------------------------------------------------------------



[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;
&lt;HTML&gt;&lt;HEAD&gt;
&lt;META content="text/html; charset=gb2312" http-equiv=Content-Type&gt;
&lt;STYLE&gt;BLOCKQUOTE {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; MARGIN-LEFT: 2em
}
OL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
UL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
&lt;/STYLE&gt;

&lt;META name=GENERATOR content="MSHTML 8.00.6001.19154"&gt;&lt;/HEAD&gt;
&lt;BODY style="MARGIN: 10px"&gt;&lt;FONT size=2 face=Verdana&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;Hi:&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt;I get a very strange problem when I installing 
libvirt0.8.7.tar.gz.&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt;Here is my infomaton:&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt; &lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt;compute with RHELD6.0 systerm;&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt;the systerm comes with libvirt0.8.7,bu I 
uninstalled it and its dependencies .&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt;And then i download the libvirt0.8.7.tar.gz , 
untar it ,configure --with-esx,make,make install.&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt; &lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt;But I got an error like 
"libvirtd: /usr/local/lib/libvirt.so.0: version `LIBVIRT_PRIVATE_0.8.7' not found (required by libvirtd) \
 " &lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt;when i use virsh,or libvirtd.&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt; &lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt;Can someone tell me what is the error mean?&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt; &lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt;Regards!&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt; &lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt;zhanggp@neusoft.com&lt;/DIV&gt;&lt;/FONT&gt;&lt;font \
face="monospace"&gt;---------------------------------------------------------------------------------------------------&lt;br&gt;
 Confidentiality Notice: The information contained in this e-mail and any \
accompanying attachment(s) &lt;br&gt; is intended only for the use of the intended \
recipient and may be confidential and/or privileged of &lt;br&gt; Neusoft Corporation, its \
subsidiaries and/or its affiliates. If any reader of this communication is &lt;br&gt; not \
the intended recipient, unauthorized use, forwarding, printing,  storing, \
disclosure or copying &lt;br&gt; is strictly prohibited, and may be unlawful.If you have \
received this communication in error,please &lt;br&gt; immediately notify the sender by \
return e-mail, and delete the original message and all copies from &lt;br&gt; your system. \
                Thank you. &lt;br&gt;
---------------------------------------------------------------------------------------------------&lt;/font&gt;&lt;/BODY&gt;&lt;/HTML&gt;




</body></email><email><emailId>20111115034502</emailId><senderName>Frank Hauptle</senderName><senderEmail>frank.hauptle@uwa.edu.au</senderEmail><timestampReceived>2011-11-15 03:45:02-0400</timestampReceived><subject>[libvirt-users] kvm/libvirt can't use vmdk files? qemu: 'vmdk' invalid format</subject><body>

Hi all,

I have a RHEL6.1 qemu-kvm  hypervisor running a raw image that I need 
for various reasons to convert to vmdk.


I used this process:
qemu-img convert server3.img -O vmdk server3.vmdk


Then I edited the XML file (/etc/libvirt/qemu/server3.xml) like so:

&lt;devices&gt;
&lt;emulator&gt;/usr/libexec/qemu-kvm&lt;/emulator&gt;
&lt;disk type='file' device='disk'&gt;
&lt;driver name='qemu' type='vmdk'/&gt;
&lt;source file='/raid5/images/guilder3.vmdk'/&gt;
&lt;target dev='hda' bus='ide'/&gt;
&lt;address type='drive' controller='0' bus='0' unit='0'/&gt;
&lt;/disk&gt;


Which basically means that I changed raw to vmdk in this line:
&lt;driver name='qemu' type='vmdk'/&gt;


but when I try to start the VM, I get this:



Error starting domain: internal error Process exited while reading 
console log output: char device redirected to /dev/pts/5
qemu: 'vmdk' invalid format


Traceback (most recent call last):
   File "/usr/share/virt-manager/virtManager/asyncjob.py", line 45, in 
cb_wrapper
     callback(asyncjob, *args, **kwargs)
   File "/usr/share/virt-manager/virtManager/engine.py", line 959, in 
asyncfunc
     vm.startup()
   File "/usr/share/virt-manager/virtManager/domain.py", line 1128, in 
startup
     self._backend.create()
   File "/usr/lib64/python2.7/site-packages/libvirt.py", line 330, in create
     if ret == -1: raise libvirtError ('virDomainCreate() failed', dom=self)
libvirtError: internal error Process exited while reading console log 
output: char device redirected to /dev/pts/5
qemu: 'vmdk' invalid format


This bit is telling:  qemu: 'vmdk' invalid format


As a test I tried using libvirt to create a vmdk  and then add it to an 
existing VM, and it failed with the same message.
Does this mean that libvirt supports vmdk, but qemu-kvm doesn't?  IF so, 
why does libvirt continue to offer it as an option for KVM VM's??


IF this isn't related to libvirt, I apologise, but I'd appreciate any 
pointers.


kindest regards

Frank
UWA











</body></email><email><emailId>20111115113404</emailId><senderName>PREETHI RAMESH</senderName><senderEmail>iampreethiramesh@gmail.com</senderEmail><timestampReceived>2011-11-15 11:34:04-0400</timestampReceived><subject>[libvirt-users] listDomains() not working on Xen</subject><body>

Hey all,
I've been trying to make listDomains() work on Xen but it simply returns an
array of null values. Also, while displaying the length of the array
returned by listDomains(). Upon using the same function in KVM, I'm able to
retrieve the complete array of active machines. I'm positive that active
Xen machines are running(cross checked it with xm list).

I've been posting this for quite sometime now but haven't received any
reply which could debug my code. I'd really appreciate it if someone could
help me.

Thanks,
P Ramesh

[Attachment #3 (text/html)]

Hey all,&lt;br&gt;I've been trying to make listDomains() work on Xen but it s=
imply returns an array of null values. Also, while displaying the length of=
 the array returned by listDomains(). Upon using the same function in KVM, =
I'm able to retrieve the complete array of active machines. I'm pos=
itive that active Xen machines are running(cross checked it with xm list).&lt;=
br&gt;
&lt;br&gt;I've been posting this for quite sometime now but haven't recei=
ved any reply which could debug my code. I'd really appreciate it if so=
meone could help me.&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;P Ramesh &lt;br&gt;


</body></email><email><emailId>20111116135500</emailId><senderName>"William A. Mahaffey III"</senderName><senderEmail>wam@hiwaay.net</senderEmail><timestampReceived>2011-11-16 13:55:00-0400</timestampReceived><subject>[libvirt-users] Speaking of DNSmasq ....</subject><body>




.... I am getting a bit tired of those pesky DNSmasq entries in my 
syslog file, they fill it up about weekly, wash other stuff out of view 
on a tail. Is there any way to suppress them. or else increase their 
lease time so that they happen less frequently ? Having a finite lease 
time for a VM seems nonsensical, it can't go anywhere or disconnect 
(obviously) .... I tried restarting DNSmasq, but it said 'Socket busy' 
or some such &amp; didn't restart. Someone on another list said that DNSmasq 
was/is in fact started by libvirt/KVM/QEMU, &amp; I poked around in the 
various /etc/sysconfig files, but couldn't find anything related to 
DNSmasq, whatever options it is started with seem to be hardwired or 
compiled into one of the pertinent executables .... FC 14, 64 bit, 
terminally patched up, libvirt 0.8.3-10.fc14 64-bit, qemu-KVM 
2:0.13.0-1.fc14 64-bit .... TIA ....


-- 

	William A. Mahaffey III

  ----------------------------------------------------------------------

	"The M1 Garand is without doubt the finest implement of war
	 ever devised by man."
                            -- Gen. George S. Patton Jr.

</body></email><email><emailId>20111116122818</emailId><senderName>Preethi Ramesh</senderName><senderEmail>pree011235@gmail.com</senderEmail><timestampReceived>2011-11-16 12:28:18-0400</timestampReceived><subject>[libvirt-users] Checking if the VM has been created</subject><body>

I'm a Libvirt newbie and I'd really appreciate it if someone could answer
my doubts. I'm using Libvirt's Java API.
My doubts:

1.Currently, I'm able to create a VM on Ubuntu 11.04 using Libvirt
functions domainCreateLinux() and domainDefineXML(). Apart fromt the
boolean return status of these operations and running the virsh list
command, is there any way to SSH in (login) to the newly created VMs  and
run applications on them? I tried running virsh console but nothing comes
up. Also I tried fixing the XML file to accommodate the console operation(
link &lt;http://ubuntuforums.org/showthread.php?t=1159220&gt;) but that was
unsuccessful too.

2. If yes, how can I get the IP of the VM created?

3. Is there any function to create image files(in any format qcow or qcow2)
using Libvirt API? Right now, I'm using a shell script which creates the
image from it's iso.

Thanks in advance
P Ramesh

[Attachment #3 (text/html)]

I'm a Libvirt newbie and I'd really appreciate it if someone could answer my \
doubts. I'm using Libvirt's Java API.&lt;br&gt;My doubts:&lt;br&gt;&lt;br&gt;1.Currently, \
I'm able to create a VM on Ubuntu 11.04 using Libvirt functions \
domainCreateLinux() and domainDefineXML().  Apart fromt the boolean return status of \
these operations and running the virsh list command, is there any way to SSH in \
(login) to the newly created VMs  and run applications on them? I tried running virsh \
console but nothing comes up. Also I tried fixing the XML file to accommodate the \
console operation(&lt;a \
href="http://ubuntuforums.org/showthread.php?t=1159220"&gt;link&lt;/a&gt;) but that was \
unsuccessful too.&lt;br&gt; &lt;br&gt;2. If yes, how can I get the IP of the VM created?  \
&lt;br&gt;&lt;br&gt;3. Is there any function to create image files(in any format qcow or qcow2) \
using Libvirt API? Right now, I'm using a shell script which creates the image \
from it's iso.&lt;br&gt; &lt;br&gt;Thanks in advance&lt;br&gt;P Ramesh&lt;br&gt; &lt;br&gt;&lt;br&gt;



</body></email><email><emailId>20111109111446</emailId><senderName></senderName><senderEmail>jurgen.depicker</senderEmail><timestampReceived>2011-11-09 11:14:46-0400</timestampReceived><subject>[libvirt-users] consider bios upgrade...</subject><body>

This is a multipart message in MIME format.
--=_alternative 003DE021C1257943_=
Content-Type: text/plain; charset="UTF-8"
Content-Transfer-Encoding: base64

RGVhciBhbGwsDQoNCk9uIG9uZSBvZiBteSB3aW5kb3dzIFZtcyAoS1ZNKSwgSSBnZXQgZnJvbSB0
aW1lIHRvIHRpbWUgYSAnd2luZG93cyANCnJlY292ZXJlZCBmcm9tIGEgc2VyaW91cyBlcnJvcicg
bWVzc2FnZSwgYW5kIGlmIEkgY2xpY2sgdGhlIHdvbmRlcmZ1bGx5IA0KdXNlZnVsIChhaHVtKSBz
dXBwb3J0IGxpbmssIEkgcmVhY2ggdGhpcyBwYWdlOg0KaHR0cDovL3dlci5taWNyb3NvZnQuY29t
L3Jlc3BvbnNlcy9SZXNwb25zZS5hc3B4LzE0NDUvZW4vNS4xLjI2MDAuMi4wMDAxMDEwMC4zLjA/
U0dEPTY3ZGJhNWM5LWRjNzMtNGJiOC04MDY1LTUxMmViZDFjNzRhYw0KSSBxdW90ZSB0aGUgZmly
c3QgcGFydCBvZiBpdCBoZXJlOg0KDQoiQ29uc2lkZXIgQklPUyB1cGdyYWRlDQoNCk1pY3Jvc29m
dCBpcyB1bmFibGUgdG8gZGV0ZXJtaW5lIHRoZSBleGFjdCBjYXVzZSBvZiB0aGlzIGVycm9yLiBI
b3dldmVyLCANCnRoaXMgcHJvYmxlbSB3YXMgbW9zdCBsaWtlbHkgY2F1c2VkIGJ5IGFuIGVycm9y
IGluIHlvdXIgY29tcHV0ZXLigJlzIHJhbmRvbSANCmFjY2VzcyBtZW1vcnkgKFJBTSkuIFJBTSBp
cyB0aGUgbWFpbiBpbnRlcm5hbCBzdG9yYWdlIGFyZWEgdGhlIGNvbXB1dGVyIA0KdXNlcyB0byBy
dW4gcHJvZ3JhbXMgYW5kIHN0b3JlIGRhdGEuDQoNCkR1cmluZyB0aGUgY3Jhc2ggYW5hbHlzaXMs
IHdlIG5vdGljZWQgdGhlIGJhc2ljIGlucHV0L291dHB1dCBzeXN0ZW0gKEJJT1MpIA0KdmVyc2lv
biBvbiB0aGlzIGNvbXB1dGVyIGRvZXMgbm90IG1hdGNoIHRoZSBzcGVjaWZpY2F0aW9ucyBmb3Ig
dGhlIGNlbnRyYWwgDQpwcm9jZXNzaW5nIHVuaXQgKENQVSksIGFsc28ga25vd24gYXMgYSBwcm9j
ZXNzb3IsIHRoYXQgaXMgaW5zdGFsbGVkIG9uIA0KeW91ciBjb21wdXRlci4gVGhpcyBjYW4gb2Nj
dXIgd2hlbiBhIG5ld2VyIHByb2Nlc3NvciBpcyBpbnN0YWxsZWQgb24gYW4gDQpvbGRlciBzeXN0
ZW0gYm9hcmQgb3Igb2xkZXIgQklPUy4gVXNpbmcgYSBCSU9TIHRoYXQgZG9lcyBub3Qgc3VwcG9y
dCB0aGUgDQppbnN0YWxsZWQgcHJvY2Vzc29yIGNhbiByZXN1bHQgaW4gV2luZG93cyBzeXN0ZW0g
Y3Jhc2hlcy4gQ29udGFjdCB5b3VyIA0KY29tcHV0ZXIgbWFudWZhY3R1cmVyIG9yIG1vdGhlcmJv
YXJkIG1hbnVmYWN0dXJlciBmb3IgYW4gdXBkYXRlZCB2ZXJzaW9uIA0Kb2YgQklPUyBmb3IgeW91
ciBjb21wdXRlcidzIHByb2Nlc3Nvci4iDQoNCg0KTm93IEknbSBub3Qgc3VyZSB3aGF0IHRoaXMg
aXMgYWxsIGFib3V0OiBob3cgY2FuIEkgcG9zc2libHkgdXBncmFkZSBteSANClZNJ3MgQklPUywg
b3Igc2hvdWxkIEkgZG8gc29tZXRoaW5nIGVsc2U/DQoNClRoYW5rcyBmb3IgbG9va2luZyBpbnRv
IHRoaXMsDQoNCkrDvHJnZW4NCg0K
--=_alternative 003DE021C1257943_=
Content-Type: text/html; charset="UTF-8"
Content-Transfer-Encoding: base64

PHR0Pjxmb250IHNpemU9Mj5EZWFyIGFsbCw8L2ZvbnQ+PC90dD4NCjxicj4NCjxicj48dHQ+PGZv
bnQgc2l6ZT0yPk9uIG9uZSBvZiBteSB3aW5kb3dzIFZtcyAoS1ZNKSwgSSBnZXQgZnJvbSB0aW1l
IHRvDQp0aW1lIGEgJ3dpbmRvd3MgcmVjb3ZlcmVkIGZyb20gYSBzZXJpb3VzIGVycm9yJyBtZXNz
YWdlLCBhbmQgaWYgSSBjbGljaw0KdGhlIHdvbmRlcmZ1bGx5IHVzZWZ1bCAoYWh1bSkgc3VwcG9y
dCBsaW5rLCBJIHJlYWNoIHRoaXMgcGFnZTo8L2ZvbnQ+PC90dD4NCjxicj48YSBocmVmPSJodHRw
Oi8vd2VyLm1pY3Jvc29mdC5jb20vcmVzcG9uc2VzL1Jlc3BvbnNlLmFzcHgvMTQ0NS9lbi81LjEu
MjYwMC4yLjAwMDEwMTAwLjMuMD9TR0Q9NjdkYmE1YzktZGM3My00YmI4LTgwNjUtNTEyZWJkMWM3
NGFjIj48dHQ+PGZvbnQgc2l6ZT0yPmh0dHA6Ly93ZXIubWljcm9zb2Z0LmNvbS9yZXNwb25zZXMv
UmVzcG9uc2UuYXNweC8xNDQ1L2VuLzUuMS4yNjAwLjIuMDAwMTAxMDAuMy4wP1NHRD02N2RiYTVj
OS1kYzczLTRiYjgtODA2NS01MTJlYmQxYzc0YWM8L2ZvbnQ+PC90dD48L2E+DQo8YnI+PHR0Pjxm
b250IHNpemU9Mj5JIHF1b3RlIHRoZSBmaXJzdCBwYXJ0IG9mIGl0IGhlcmU6PC9mb250PjwvdHQ+
DQo8YnI+DQo8YnI+PHR0Pjxmb250IHNpemU9Mj4mcXVvdDtDb25zaWRlciBCSU9TIHVwZ3JhZGU8
L2ZvbnQ+PC90dD4NCjxicj4NCjxicj48dHQ+PGZvbnQgc2l6ZT0yPk1pY3Jvc29mdCBpcyB1bmFi
bGUgdG8gZGV0ZXJtaW5lIHRoZSBleGFjdCBjYXVzZSBvZg0KdGhpcyBlcnJvci4gSG93ZXZlciwg
dGhpcyBwcm9ibGVtIHdhcyBtb3N0IGxpa2VseSBjYXVzZWQgYnkgYW4gZXJyb3IgaW4NCnlvdXIg
Y29tcHV0ZXLigJlzIHJhbmRvbSBhY2Nlc3MgbWVtb3J5IChSQU0pLiBSQU0gaXMgdGhlIG1haW4g
aW50ZXJuYWwgc3RvcmFnZQ0KYXJlYSB0aGUgY29tcHV0ZXIgdXNlcyB0byBydW4gcHJvZ3JhbXMg
YW5kIHN0b3JlIGRhdGEuPC9mb250PjwvdHQ+DQo8YnI+DQo8YnI+PHR0Pjxmb250IHNpemU9Mj5E
dXJpbmcgdGhlIGNyYXNoIGFuYWx5c2lzLCB3ZSBub3RpY2VkIHRoZSBiYXNpYyBpbnB1dC9vdXRw
dXQNCnN5c3RlbSAoQklPUykgdmVyc2lvbiBvbiB0aGlzIGNvbXB1dGVyIGRvZXMgbm90IG1hdGNo
IHRoZSBzcGVjaWZpY2F0aW9ucw0KZm9yIHRoZSBjZW50cmFsIHByb2Nlc3NpbmcgdW5pdCAoQ1BV
KSwgYWxzbyBrbm93biBhcyBhIHByb2Nlc3NvciwgdGhhdA0KaXMgaW5zdGFsbGVkIG9uIHlvdXIg
Y29tcHV0ZXIuIFRoaXMgY2FuIG9jY3VyIHdoZW4gYSBuZXdlciBwcm9jZXNzb3IgaXMNCmluc3Rh
bGxlZCBvbiBhbiBvbGRlciBzeXN0ZW0gYm9hcmQgb3Igb2xkZXIgQklPUy4gVXNpbmcgYSBCSU9T
IHRoYXQgZG9lcw0Kbm90IHN1cHBvcnQgdGhlIGluc3RhbGxlZCBwcm9jZXNzb3IgY2FuIHJlc3Vs
dCBpbiBXaW5kb3dzIHN5c3RlbSBjcmFzaGVzLg0KQ29udGFjdCB5b3VyIGNvbXB1dGVyIG1hbnVm
YWN0dXJlciBvciBtb3RoZXJib2FyZCBtYW51ZmFjdHVyZXIgZm9yIGFuIHVwZGF0ZWQNCnZlcnNp
b24gb2YgQklPUyBmb3IgeW91ciBjb21wdXRlcidzIHByb2Nlc3Nvci4mcXVvdDs8L2ZvbnQ+PC90
dD4NCjxicj4NCjxicj4NCjxicj48dHQ+PGZvbnQgc2l6ZT0yPk5vdyBJJ20gbm90IHN1cmUgd2hh
dCB0aGlzIGlzIGFsbCBhYm91dDogaG93IGNhbiBJDQpwb3NzaWJseSB1cGdyYWRlIG15IFZNJ3Mg
QklPUywgb3Igc2hvdWxkIEkgZG8gc29tZXRoaW5nIGVsc2U/PC9mb250PjwvdHQ+DQo8YnI+DQo8
YnI+PHR0Pjxmb250IHNpemU9Mj5UaGFua3MgZm9yIGxvb2tpbmcgaW50byB0aGlzLDwvZm9udD48
L3R0Pg0KPGJyPg0KPGJyPjx0dD48Zm9udCBzaXplPTI+SsO8cmdlbjwvZm9udD48L3R0Pg0KPGJy
Pg0K
--=_alternative 003DE021C1257943_=--

</body></email><email><emailId>20111117093050</emailId><senderName></senderName><senderEmail>zhanggp@neusoft.com</senderEmail><timestampReceived>2011-11-17 09:30:50-0400</timestampReceived><subject>[libvirt-users] libvirt uninstall @ install problem??</subject><body>

[Attachment #2 (text/plain)]


Hi:

I have a rhel6.1 system, before I installed libvirt0.9.6.tar.gz, it already have \
installed libvirt-0.8.7-xxx.rpm.

Can someone tell me how to uninstall the libvirt-0.8.7XXX.rpm ,and then i can install \
libvirt0.9.6.tar.gz and use it .

Thanks!

zhanggp@neusoft.com
---------------------------------------------------------------------------------------------------
 Confidentiality Notice: The information contained in this e-mail and any \
accompanying attachment(s)  is intended only for the use of the intended recipient \
and may be confidential and/or privileged of  Neusoft Corporation, its subsidiaries \
and/or its affiliates. If any reader of this communication is  not the intended \
recipient, unauthorized use, forwarding, printing,  storing, disclosure or copying  \
is strictly prohibited, and may be unlawful.If you have received this communication \
in error,please  immediately notify the sender by return e-mail, and delete the \
original message and all copies from  your system. Thank you. 
---------------------------------------------------------------------------------------------------



[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;
&lt;HTML&gt;&lt;HEAD&gt;
&lt;STYLE type=text/css&gt;@import url( C:\Documents and Settings\Administrator\Local \
Settings\Temporary Internet Files\scrollbar.css ); &lt;/STYLE&gt;

&lt;META content="text/html; charset=GB2312" http-equiv=Content-Type&gt;
&lt;STYLE&gt;BLOCKQUOTE {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; MARGIN-LEFT: 2em
}
OL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
UL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
&lt;/STYLE&gt;

&lt;META name=GENERATOR content="MSHTML 8.00.6001.19154"&gt;&lt;/HEAD&gt;
&lt;BODY style="MARGIN: 10px"&gt;&lt;FONT size=2 face=Verdana&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;Hi:&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt; &lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt;I have a rhel6.1 system, before I installed 
libvirt0.9.6.tar.gz, it already have installed libvirt-0.8.7-xxx.rpm.&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt; &lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt;Can someone tell me how to uninstall the 
libvirt-0.8.7XXX.rpm ,and then i can install libvirt0.9.6.tar.gz and use it 
.&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt; &lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt;Thanks!&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt; &lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt;&lt;A 
href="mailto:zhanggp@neusoft.com"&gt;zhanggp@neusoft.com&lt;/A&gt;&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt; &lt;/DIV&gt;&lt;/FONT&gt;&lt;font \
face="monospace"&gt;---------------------------------------------------------------------------------------------------&lt;br&gt;
 Confidentiality Notice: The information contained in this e-mail and any \
accompanying attachment(s) &lt;br&gt; is intended only for the use of the intended \
recipient and may be confidential and/or privileged of &lt;br&gt; Neusoft Corporation, its \
subsidiaries and/or its affiliates. If any reader of this communication is &lt;br&gt; not \
the intended recipient, unauthorized use, forwarding, printing,  storing, \
disclosure or copying &lt;br&gt; is strictly prohibited, and may be unlawful.If you have \
received this communication in error,please &lt;br&gt; immediately notify the sender by \
return e-mail, and delete the original message and all copies from &lt;br&gt; your system. \
                Thank you. &lt;br&gt;
---------------------------------------------------------------------------------------------------&lt;/font&gt;&lt;/BODY&gt;&lt;/HTML&gt;




</body></email><email><emailId>20111117220215</emailId><senderName>Ken Coar</senderName><senderEmail>kcoar@redhat.com</senderEmail><timestampReceived>2011-11-17 22:02:15-0400</timestampReceived><subject>[libvirt-users] Ruby libvirt gem: state reasons</subject><body>

Does anyone know of a way to use the Ruby bindings to find out
the 'reason' value for the state of the VM?  Such as obtaining
VIR_DOMAIN_RUNNING_BOOTED for a running domain?
-- 
#ken	B-)}

Ken Coar, Sanagendamgagwedweinini
IT Engineering Tower, Red Hat/RDU

"Millennium hand and shrimp!"

</body></email><email><emailId>20111118233547</emailId><senderName>Christian Parpart</senderName><senderEmail>trapni@gentoo.org</senderEmail><timestampReceived>2011-11-18 23:35:47-0400</timestampReceived><subject>[libvirt-users] libvirt and linux-vserver</subject><body>

Hi,

I was just googling around for linux-vserver support in libvirt,
however, only found sad ppl complaining about the fact,
that there is still no linux-vserver support in libbirt.
Despite the fact, that there was some kind of lag in review by more
than one person, why isn't it still in? so... merely two years after?
I think once the patched would have been applied, ppl would start
using it, and then also report bugs in case there were some not
yet found by the author nor the single reviewer :)

Best regards,
Christian Parpart.

[Attachment #3 (text/html)]

Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I was just googling around for linux-vserver support in \
libvirt,&lt;/div&gt;&lt;div&gt;however, only found sad ppl complaining about the \
fact,&lt;/div&gt;&lt;div&gt;that there is still no linux-vserver support in libbirt.&lt;/div&gt; \
&lt;div&gt;Despite the fact, that there was some kind of lag in review by \
more&lt;/div&gt;&lt;div&gt;than one person, why isn't it still in? so... merely two years \
after?&lt;/div&gt;&lt;div&gt;I think once the patched would have been applied, ppl would \
start&lt;/div&gt; &lt;div&gt;using it, and then also report bugs in case there were some \
not&lt;/div&gt;&lt;div&gt;yet found by the author nor the single reviewer \
:)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Best regards,&lt;/div&gt;&lt;div&gt;Christian Parpart.&lt;/div&gt;



</body></email><email><emailId>20111121153613</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-11-21 15:36:13-0400</timestampReceived><subject>Re: [libvirt-users] libvirt and linux-vserver</subject><body>

On Sat, Nov 19, 2011 at 12:35:47AM +0100, Christian Parpart wrote:
&gt; Hi,
&gt; 
&gt; I was just googling around for linux-vserver support in libvirt,
&gt; however, only found sad ppl complaining about the fact,
&gt; that there is still no linux-vserver support in libbirt.
&gt; Despite the fact, that there was some kind of lag in review by more
&gt; than one person, why isn't it still in? so... merely two years after?
&gt; I think once the patched would have been applied, ppl would start
&gt; using it, and then also report bugs in case there were some not
&gt; yet found by the author nor the single reviewer :)

We're always open to accepting new drivers - we have almost every
major HV technology covered to some degreee now. There was a patch
for vserver posted here:

https://www.redhat.com/archives/libvir-list/2008-January/msg00097.html

with some review of the code, but there were not any followup postings
for it. So what's lacking is someone motivated todo the work to finish
it off &amp; update to latest libvirt coding standards for drivers. Volunteers
are welcome to submit vserver support to libvir-list again....

Regards,
Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20111122111826</emailId><senderName>Nicolas Sebrecht</senderName><senderEmail>nsebrecht@piing.fr</senderEmail><timestampReceived>2011-11-22 11:18:26-0400</timestampReceived><subject>[libvirt-users]  Re: libvirt and linux-vserver</subject><body>

The 21/11/11, Daniel P. Berrange wrote:

&gt; We're always open to accepting new drivers - we have almost every
&gt; major HV technology covered to some degreee now. There was a patch
&gt; for vserver posted here:
&gt; 
&gt; https://www.redhat.com/archives/libvir-list/2008-January/msg00097.html
&gt; 
&gt; with some review of the code, but there were not any followup postings
&gt; for it. So what's lacking is someone motivated todo the work to finish
&gt; it off &amp; update to latest libvirt coding standards for drivers. Volunteers
&gt; are welcome to submit vserver support to libvir-list again....

I would have to second such a call until I realized the last Windows KVM
virtio drivers are not freely available anymore (v1.2.0 &amp; v1.3.3 of the
drivers are distributed with a proprietary license instead of the GPLv2
for the previous versions). Looks like Redhat is going to close
contributions in the virtualization world.

-- 
Nicolas Sebrecht

</body></email><email><emailId>20111123084847</emailId><senderName>Jérôme_Gallard</senderName><senderEmail>jeronimo974@gmail.com</senderEmail><timestampReceived>2011-11-23 08:48:47-0400</timestampReceived><subject>[libvirt-users] Difference between "Max Memory" and "Used Memory"</subject><body>

Hello,

I am new on this mailing list, so If I do something wrong, don't hesitate
to tell me :-)

I am using the following version of libvirt :
Compiled against library: libvir 0.8.8
Using library: libvir 0.8.8
Using API: QEMU 0.8.8
Running hypervisor: QEMU 0.14.0

I would like to understand the difference between "Max Memory" and "Used
Memory" returned by a "virsh dominfo" command. In my configuration both
values are equal. This surprises me because my VM is not using all its
memory. Perhaps I miss something ?

Thank you very much for your help.

Regards,
J=E9r=F4me

[Attachment #3 (text/html)]

&lt;div&gt;Hello,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I am new on this mailing list, so If I=
 do something wrong, don't hesitate to tell me :-)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;=
&lt;div&gt;I am using the following version of libvirt :&lt;/div&gt;&lt;div&gt;Compiled again=
st library: libvir 0.8.8&lt;/div&gt;

&lt;div&gt;Using library: libvir 0.8.8&lt;/div&gt;&lt;div&gt;Using API: QEMU 0.8.8&lt;/div&gt;&lt;div&gt;=
Running hypervisor: QEMU 0.14.0&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I would like to un=
derstand the difference between "Max Memory" and "Used Memor=
y" returned by a "virsh dominfo" command. In my configuratio=
n both values are equal. This surprises me because my VM is not using all i=
ts memory. Perhaps I miss something ?&lt;/div&gt;

&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thank you very much for your help.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;=
&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;J=E9r=F4me&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;


</body></email><email><emailId>20111122143932</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-11-22 14:39:32-0400</timestampReceived><subject>Re: [libvirt-users] libvirt and linux-vserver</subject><body>

On Tue, Nov 22, 2011 at 12:18:26PM +0100, Nicolas Sebrecht wrote:
&gt; The 21/11/11, Daniel P. Berrange wrote:
&gt; 
&gt; &gt; We're always open to accepting new drivers - we have almost every
&gt; &gt; major HV technology covered to some degreee now. There was a patch
&gt; &gt; for vserver posted here:
&gt; &gt; 
&gt; &gt; https://www.redhat.com/archives/libvir-list/2008-January/msg00097.html
&gt; &gt; 
&gt; &gt; with some review of the code, but there were not any followup postings
&gt; &gt; for it. So what's lacking is someone motivated todo the work to finish
&gt; &gt; it off &amp; update to latest libvirt coding standards for drivers. Volunteers
&gt; &gt; are welcome to submit vserver support to libvir-list again....
&gt; 
&gt; I would have to second such a call until I realized the last Windows KVM
&gt; virtio drivers are not freely available anymore (v1.2.0 &amp; v1.3.3 of the
&gt; drivers are distributed with a proprietary license instead of the GPLv2
&gt; for the previous versions). Looks like Redhat is going to close
&gt; contributions in the virtualization world.

There is in fact *not* an attempt by Red Hat to keep the Windows drivers
closed-source, but there are a couple of factors which might have
mistakenly given that impression.

The KVM wiki link to the GIT repository was outdated. The master GIT
repository now lives on GIT Hub:

  https://github.com/YanVugenfirer/kvm-guest-drivers-windows

I have updated the wiki accordingly:

  http://www.linux-kvm.org/page/WindowsGuestDrivers/Download_Drivers


For reasons I don't understand, the binary releases published to Fedora
download page are (unfortunately) using a different version numbering
scheme to the RHEL binaries. So while Fedora shows release 1.1.16, RHEL
will show 1.4. They both ultimately come from source in the same GIT
repo I mention above. The Fedora link is on the download page above

Finally, although the source code is GPL, the binary signed &amp; WHQL'd
drivers provided for RHEL are not under the GPL. This is due to license
restrictions of the MicroSoft WHQL certification process :-( This is
one of the reasons why we can't distribute the drivers in Fedora YUM
repos directly.

Regards,
Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20111117221508</emailId><senderName>Mohammed Naser</senderName><senderEmail>mnaser@vexxhost.com</senderEmail><timestampReceived>2011-11-17 22:15:08-0400</timestampReceived><subject>Re: [libvirt-users] Ruby libvirt gem: state reasons</subject><body>

Sent from my iPhone

On 2011-11-17, at 5:07 PM, Ken Coar &lt;kcoar@redhat.com&gt; wrote:

&gt; Does anyone know of a way to use the Ruby bindings to find out
&gt; the 'reason' value for the state of the VM?  Such as obtaining
&gt; VIR_DOMAIN_RUNNING_BOOTED for a running domain?

Don't have the API on hand but you can compare them by referencing the constants

Libvirt::Domain::RUNNING or so

&gt; --
&gt; #ken    B-)}
&gt;
&gt; Ken Coar, Sanagendamgagwedweinini
&gt; IT Engineering Tower, Red Hat/RDU
&gt;
&gt; "Millennium hand and shrimp!"
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20111116111140</emailId><senderName></senderName><senderEmail>jurgen.depicker</senderEmail><timestampReceived>2011-11-16 11:11:40-0400</timestampReceived><subject>[libvirt-users] consider bios upgrade...</subject><body>

This is a multipart message in MIME format.
--=_alternative 003D765EC125794A_=
Content-Type: text/plain; charset="UTF-8"
Content-Transfer-Encoding: base64

RGVhciBhbGwsIA0KDQpJIGRpZG4ndCBnZXQgYW55IHJlcGx5LCBzbyBJIHNlbmQgdGhpcyBtYWls
IGFnYWluLg0KDQpPbiBvbmUgb2YgbXkgd2luZG93cyBWbXMgKEtWTSksIEkgZ2V0IGZyb20gdGlt
ZSB0byB0aW1lIGEgJ3dpbmRvd3MgDQpyZWNvdmVyZWQgZnJvbSBhIHNlcmlvdXMgZXJyb3InIG1l
c3NhZ2UsIGFuZCBpZiBJIGNsaWNrIHRoZSB3b25kZXJmdWxseSANCnVzZWZ1bCAoYWh1bSkgc3Vw
cG9ydCBsaW5rLCBJIHJlYWNoIHRoaXMgcGFnZTogDQpodHRwOi8vd2VyLm1pY3Jvc29mdC5jb20v
cmVzcG9uc2VzL1Jlc3BvbnNlLmFzcHgvMTQ0NS9lbi81LjEuMjYwMC4yLjAwMDEwMTAwLjMuMD9T
R0Q9NjdkYmE1YzktZGM3My00YmI4LTgwNjUtNTEyZWJkMWM3NGFjIA0KDQpJIHF1b3RlIHRoZSBm
aXJzdCBwYXJ0IG9mIGl0IGhlcmU6IA0KDQoiQ29uc2lkZXIgQklPUyB1cGdyYWRlIA0KDQpNaWNy
b3NvZnQgaXMgdW5hYmxlIHRvIGRldGVybWluZSB0aGUgZXhhY3QgY2F1c2Ugb2YgdGhpcyBlcnJv
ci4gSG93ZXZlciwgDQp0aGlzIHByb2JsZW0gd2FzIG1vc3QgbGlrZWx5IGNhdXNlZCBieSBhbiBl
cnJvciBpbiB5b3VyIGNvbXB1dGVy4oCZcyByYW5kb20gDQphY2Nlc3MgbWVtb3J5IChSQU0pLiBS
QU0gaXMgdGhlIG1haW4gaW50ZXJuYWwgc3RvcmFnZSBhcmVhIHRoZSBjb21wdXRlciANCnVzZXMg
dG8gcnVuIHByb2dyYW1zIGFuZCBzdG9yZSBkYXRhLiANCg0KRHVyaW5nIHRoZSBjcmFzaCBhbmFs
eXNpcywgd2Ugbm90aWNlZCB0aGUgYmFzaWMgaW5wdXQvb3V0cHV0IHN5c3RlbSAoQklPUykgDQp2
ZXJzaW9uIG9uIHRoaXMgY29tcHV0ZXIgZG9lcyBub3QgbWF0Y2ggdGhlIHNwZWNpZmljYXRpb25z
IGZvciB0aGUgY2VudHJhbCANCnByb2Nlc3NpbmcgdW5pdCAoQ1BVKSwgYWxzbyBrbm93biBhcyBh
IHByb2Nlc3NvciwgdGhhdCBpcyBpbnN0YWxsZWQgb24gDQp5b3VyIGNvbXB1dGVyLiBUaGlzIGNh
biBvY2N1ciB3aGVuIGEgbmV3ZXIgcHJvY2Vzc29yIGlzIGluc3RhbGxlZCBvbiBhbiANCm9sZGVy
IHN5c3RlbSBib2FyZCBvciBvbGRlciBCSU9TLiBVc2luZyBhIEJJT1MgdGhhdCBkb2VzIG5vdCBz
dXBwb3J0IHRoZSANCmluc3RhbGxlZCBwcm9jZXNzb3IgY2FuIHJlc3VsdCBpbiBXaW5kb3dzIHN5
c3RlbSBjcmFzaGVzLiBDb250YWN0IHlvdXIgDQpjb21wdXRlciBtYW51ZmFjdHVyZXIgb3IgbW90
aGVyYm9hcmQgbWFudWZhY3R1cmVyIGZvciBhbiB1cGRhdGVkIHZlcnNpb24gDQpvZiBCSU9TIGZv
ciB5b3VyIGNvbXB1dGVyJ3MgcHJvY2Vzc29yLiIgDQoNCg0KTm93IEknbSBub3Qgc3VyZSB3aGF0
IHRoaXMgaXMgYWxsIGFib3V0OiBob3cgY2FuIEkgcG9zc2libHkgdXBncmFkZSBteSANClZNJ3Mg
QklPUywgb3Igc2hvdWxkIEkgZG8gc29tZXRoaW5nIGVsc2U/ICBDYW4gaXQgaGF2ZSBzb21ldGhp
bmcgdG8gZG8gDQp3aXRoIHRoZSBwcm9jZXNzb3Igc3BlY3MgaW4gdGhlIFZNJ3MgWE1MIGRlZmlu
aXRpb24/DQoNClRoYW5rcyBmb3IgbG9va2luZyBpbnRvIHRoaXMsIA0KDQpKw7xyZ2VuIA0K
--=_alternative 003D765EC125794A_=
Content-Type: text/html; charset="UTF-8"
Content-Transfer-Encoding: base64

PHR0Pjxmb250IHNpemU9Mj5EZWFyIGFsbCw8L2ZvbnQ+PC90dD48Zm9udCBzaXplPTM+IDwvZm9u
dD4NCjxicj4NCjxicj48Zm9udCBzaXplPTM+SSBkaWRuJ3QgZ2V0IGFueSByZXBseSwgc28gSSBz
ZW5kIHRoaXMgbWFpbCBhZ2Fpbi48YnI+DQo8L2ZvbnQ+PHR0Pjxmb250IHNpemU9Mj48YnI+DQpP
biBvbmUgb2YgbXkgd2luZG93cyBWbXMgKEtWTSksIEkgZ2V0IGZyb20gdGltZSB0byB0aW1lIGEg
J3dpbmRvd3MgcmVjb3ZlcmVkDQpmcm9tIGEgc2VyaW91cyBlcnJvcicgbWVzc2FnZSwgYW5kIGlm
IEkgY2xpY2sgdGhlIHdvbmRlcmZ1bGx5IHVzZWZ1bCAoYWh1bSkNCnN1cHBvcnQgbGluaywgSSBy
ZWFjaCB0aGlzIHBhZ2U6PC9mb250PjwvdHQ+PGZvbnQgc2l6ZT0zPiA8L2ZvbnQ+PGZvbnQgc2l6
ZT0zIGNvbG9yPWJsdWU+PGJyPg0KPC9mb250PjxhIGhyZWY9Imh0dHA6Ly93ZXIubWljcm9zb2Z0
LmNvbS9yZXNwb25zZXMvUmVzcG9uc2UuYXNweC8xNDQ1L2VuLzUuMS4yNjAwLjIuMDAwMTAxMDAu
My4wP1NHRD02N2RiYTVjOS1kYzczLTRiYjgtODA2NS01MTJlYmQxYzc0YWMiPjx0dD48Zm9udCBz
aXplPTIgY29sb3I9Ymx1ZT5odHRwOi8vd2VyLm1pY3Jvc29mdC5jb20vcmVzcG9uc2VzL1Jlc3Bv
bnNlLmFzcHgvMTQ0NS9lbi81LjEuMjYwMC4yLjAwMDEwMTAwLjMuMD9TR0Q9NjdkYmE1YzktZGM3
My00YmI4LTgwNjUtNTEyZWJkMWM3NGFjPC9mb250PjwvdHQ+PC9hPjxmb250IHNpemU9Mz4NCjwv
Zm9udD48dHQ+PGZvbnQgc2l6ZT0yPjxicj4NCkkgcXVvdGUgdGhlIGZpcnN0IHBhcnQgb2YgaXQg
aGVyZTo8L2ZvbnQ+PC90dD48Zm9udCBzaXplPTM+IDxicj4NCjwvZm9udD48dHQ+PGZvbnQgc2l6
ZT0yPjxicj4NCiZxdW90O0NvbnNpZGVyIEJJT1MgdXBncmFkZTwvZm9udD48L3R0Pjxmb250IHNp
emU9Mz4gPGJyPg0KPC9mb250Pjx0dD48Zm9udCBzaXplPTI+PGJyPg0KTWljcm9zb2Z0IGlzIHVu
YWJsZSB0byBkZXRlcm1pbmUgdGhlIGV4YWN0IGNhdXNlIG9mIHRoaXMgZXJyb3IuIEhvd2V2ZXIs
DQp0aGlzIHByb2JsZW0gd2FzIG1vc3QgbGlrZWx5IGNhdXNlZCBieSBhbiBlcnJvciBpbiB5b3Vy
IGNvbXB1dGVy4oCZcyByYW5kb20NCmFjY2VzcyBtZW1vcnkgKFJBTSkuIFJBTSBpcyB0aGUgbWFp
biBpbnRlcm5hbCBzdG9yYWdlIGFyZWEgdGhlIGNvbXB1dGVyDQp1c2VzIHRvIHJ1biBwcm9ncmFt
cyBhbmQgc3RvcmUgZGF0YS48L2ZvbnQ+PC90dD48Zm9udCBzaXplPTM+IDxicj4NCjwvZm9udD48
dHQ+PGZvbnQgc2l6ZT0yPjxicj4NCkR1cmluZyB0aGUgY3Jhc2ggYW5hbHlzaXMsIHdlIG5vdGlj
ZWQgdGhlIGJhc2ljIGlucHV0L291dHB1dCBzeXN0ZW0gKEJJT1MpDQp2ZXJzaW9uIG9uIHRoaXMg
Y29tcHV0ZXIgZG9lcyBub3QgbWF0Y2ggdGhlIHNwZWNpZmljYXRpb25zIGZvciB0aGUgY2VudHJh
bA0KcHJvY2Vzc2luZyB1bml0IChDUFUpLCBhbHNvIGtub3duIGFzIGEgcHJvY2Vzc29yLCB0aGF0
IGlzIGluc3RhbGxlZCBvbg0KeW91ciBjb21wdXRlci4gVGhpcyBjYW4gb2NjdXIgd2hlbiBhIG5l
d2VyIHByb2Nlc3NvciBpcyBpbnN0YWxsZWQgb24gYW4NCm9sZGVyIHN5c3RlbSBib2FyZCBvciBv
bGRlciBCSU9TLiBVc2luZyBhIEJJT1MgdGhhdCBkb2VzIG5vdCBzdXBwb3J0IHRoZQ0KaW5zdGFs
bGVkIHByb2Nlc3NvciBjYW4gcmVzdWx0IGluIFdpbmRvd3Mgc3lzdGVtIGNyYXNoZXMuIENvbnRh
Y3QgeW91cg0KY29tcHV0ZXIgbWFudWZhY3R1cmVyIG9yIG1vdGhlcmJvYXJkIG1hbnVmYWN0dXJl
ciBmb3IgYW4gdXBkYXRlZCB2ZXJzaW9uDQpvZiBCSU9TIGZvciB5b3VyIGNvbXB1dGVyJ3MgcHJv
Y2Vzc29yLiZxdW90OzwvZm9udD48L3R0Pjxmb250IHNpemU9Mz4gPGJyPg0KPGJyPg0KPC9mb250
Pjx0dD48Zm9udCBzaXplPTI+PGJyPg0KTm93IEknbSBub3Qgc3VyZSB3aGF0IHRoaXMgaXMgYWxs
IGFib3V0OiBob3cgY2FuIEkgcG9zc2libHkgdXBncmFkZSBteQ0KVk0ncyBCSU9TLCBvciBzaG91
bGQgSSBkbyBzb21ldGhpbmcgZWxzZT88L2ZvbnQ+PC90dD48Zm9udCBzaXplPTM+ICZuYnNwO0Nh
bg0KaXQgaGF2ZSBzb21ldGhpbmcgdG8gZG8gd2l0aCB0aGUgcHJvY2Vzc29yIHNwZWNzIGluIHRo
ZSBWTSdzIFhNTCBkZWZpbml0aW9uPzxicj4NCjwvZm9udD48dHQ+PGZvbnQgc2l6ZT0yPjxicj4N
ClRoYW5rcyBmb3IgbG9va2luZyBpbnRvIHRoaXMsPC9mb250PjwvdHQ+PGZvbnQgc2l6ZT0zPiA8
YnI+DQo8L2ZvbnQ+PHR0Pjxmb250IHNpemU9Mj48YnI+DQpKw7xyZ2VuPC9mb250PjwvdHQ+PGZv
bnQgc2l6ZT0zPiA8L2ZvbnQ+DQo=
--=_alternative 003D765EC125794A_=--

</body></email><email><emailId>20111116134635</emailId><senderName>"William A. Mahaffey III"</senderName><senderEmail>wam@hiwaay.net</senderEmail><timestampReceived>2011-11-16 13:46:35-0400</timestampReceived><subject>Re: [libvirt-users] Checking if the VM has been created</subject><body>

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta content="text/html; charset=ISO-8859-1"
      http-equiv="Content-Type"&gt;
  &lt;/head&gt;
  &lt;body bgcolor="#ffffff" text="#000000"&gt;
    On 11/16/11 06:16, Preethi Ramesh wrote:&lt;br&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;blockquote
cite="mid:CAKeZmz+-QQewUie9q3kDsewtHYZP8C-3pKHr5dObUMFfL_+_Eg@mail.gmail.com"
      type="cite"&gt;I'm a Libvirt newbie and I'd really appreciate it if
      someone could answer my doubts. I'm using Libvirt's Java API.&lt;br&gt;
      My doubts:&lt;br&gt;
      &lt;br&gt;
      1.Currently, I'm able to create a VM on Ubuntu 11.04 using Libvirt
      functions domainCreateLinux() and domainDefineXML(). Apart fromt
      the boolean return status of these operations and running the
      virsh list command, is there any way to SSH in (login) to the
      newly created VMs  and run applications on them? I tried running
      virsh console but nothing comes up. Also I tried fixing the XML
      file to accommodate the console operation(&lt;a
        moz-do-not-send="true"
        href="http://ubuntuforums.org/showthread.php?t=1159220"&gt;link&lt;/a&gt;)
      but that was unsuccessful too.&lt;br&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
    &lt;br&gt;
    The route command on the host will show the newly added routes for
    the VM. Also, tail your syslog file &amp; you will see messages
    about every 15 min. from dnsmasq w/ the IP adder. of the VM.&lt;br&gt;
    &lt;br&gt;
    &lt;br&gt;
    Hand editing the XML file is not recommended, usually won't work,
    try the 'virsh edit' command, that will make sure that the edited
    stuff gets saved properly &amp; gets communicated to the VM's.&lt;br&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;blockquote
cite="mid:CAKeZmz+-QQewUie9q3kDsewtHYZP8C-3pKHr5dObUMFfL_+_Eg@mail.gmail.com"
      type="cite"&gt;
      &lt;br&gt;
      2. If yes, how can I get the IP of the VM created? &lt;br&gt;
      &lt;br&gt;
      3. Is there any function to create image files(in any format qcow
      or qcow2) using Libvirt API? Right now, I'm using a shell script
      which creates the image from it's iso.&lt;br&gt;
      &lt;br&gt;
      Thanks in advance&lt;br&gt;
      P Ramesh&lt;br&gt;
       &lt;br&gt;
      &lt;br&gt;
      &lt;pre wrap=""&gt;
&lt;fieldset class="mimeAttachmentHeader"&gt;&lt;/fieldset&gt;
_______________________________________________
libvirt-users mailing list
&lt;a class="moz-txt-link-abbreviated" \
href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt; &lt;a \
class="moz-txt-link-freetext" \
href="https://www.redhat.com/mailman/listinfo/libvirt-users"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;/pre&gt;
  &lt;/blockquote&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;pre class="moz-signature" cols="72"&gt;-- 

	William A. Mahaffey III

 ----------------------------------------------------------------------

	"The M1 Garand is without doubt the finest implement of war
	 ever devised by man."
                           -- Gen. George S. Patton Jr.
&lt;/pre&gt;
  &lt;/body&gt;
&lt;/html&gt;


</body></email><email><emailId>20111116142852</emailId><senderName>Till Mossakowski</senderName><senderEmail>till.mossakowski@dfki.de</senderEmail><timestampReceived>2011-11-16 14:28:52-0400</timestampReceived><subject>Re: [libvirt-users] Checking if the VM has been created</subject><body>

Am 16.11.2011 14:46, schrieb William A. Mahaffey III:

&gt; The route command on the host will show the newly added routes for the
&gt; VM. Also, tail your syslog file &amp; you will see messages about every 15
&gt; min. from dnsmasq w/ the IP adder. of the VM.

route just shows the bridge, the individual IP of the VM is only shown 
in the syslog. However, this is just a workaround, and does not provide 
reliable identification of the IP if there are many VMs. libvirt resp. 
virsh should provide a way of obtaining the IP directly from the domain 
name.

Best, Till


-- 
Prof. Dr. Till Mossakowski  Cartesium, room 2.51 Phone +49-421-218-64226
DFKI GmbH Bremen                             Fax +49-421-218-9864226
Cyber-Physical Systems                      Till.Mossakowski@dfki.de
Enrique-Schmidt-Str. 5, D-28359 Bremen   http://www.dfki.de/sks/till

Deutsches Forschungszentrum fuer Kuenstliche Intelligenz GmbH
principal office, *not* the address for mail etc.!!!:
Trippstadter Str. 122, D-67663 Kaiserslautern
management board: Prof. Wolfgang Wahlster (chair), Dr. Walter Olthoff
supervisory board: Prof. Hans A. Aukes (chair)
Amtsgericht Kaiserslautern, HRB 2313

</body></email><email><emailId>20111116154628</emailId><senderName>"William A. Mahaffey III"</senderName><senderEmail>wam@hiwaay.net</senderEmail><timestampReceived>2011-11-16 15:46:28-0400</timestampReceived><subject>Re: [libvirt-users] Checking if the VM has been created</subject><body>

On 11/16/11 08:28, Till Mossakowski wrote:
&gt; Am 16.11.2011 14:46, schrieb William A. Mahaffey III:
&gt;
&gt;&gt; The route command on the host will show the newly added routes for the
&gt;&gt; VM. Also, tail your syslog file &amp; you will see messages about every 15
&gt;&gt; min. from dnsmasq w/ the IP adder. of the VM.
&gt;
&gt; route just shows the bridge, the individual IP of the VM is only shown 
&gt; in the syslog. However, this is just a workaround, and does not 
&gt; provide reliable identification of the IP if there are many VMs. 
&gt; libvirt resp. virsh should provide a way of obtaining the IP directly 
&gt; from the domain name.
&gt;
&gt; Best, Till
&gt;
&gt;



output from 'route -CFvnee' as root on my host attached, 4th line in 
file shows IP addr of my VM, visible in other lines as well ....



&amp; I definitely agree that virsh *should* show that info :-) ....


-- 

	William A. Mahaffey III

  ----------------------------------------------------------------------

	"The M1 Garand is without doubt the finest implement of war
	 ever devised by man."
                            -- Gen. George S. Patton Jr.


["route.txt" (text/plain)]

Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface    MSS  \
Window irtt 192.168.0.0     0.0.0.0         255.255.255.0   U     0      0        0 \
eth0     0     0      0 192.168.122.0   0.0.0.0         255.255.255.0   U     0      \
0        0 virbr0   0     0      0 169.254.0.0     0.0.0.0         255.255.0.0     U  \
1002   0        0 eth0     0     0      0 0.0.0.0         192.168.0.254   0.0.0.0     \
UG    0      0        0 eth0     0     0      0 Kernel IP routing cache
Source          Destination     Gateway         Flags Metric Ref    Use Iface    MSS  \
Window irtt  TOS HHRef HHUptod     SpecDst 192.168.122.213 192.168.122.255 \
192.168.122.255 ibl   0      0    11041 lo       0     0      0     0   -1    0     \
192.168.122.1 192.168.0.4     192.168.0.255   192.168.0.255   ibl   0      0    20338 \
lo       0     0      0     0   -1    0       192.168.0.9 192.168.122.1   \
192.168.122.255 192.168.122.255 bl    0      0    11041 virbr0   1500  0      0     0 \
2     1     192.168.122.1 192.168.122.213 192.168.122.1   192.168.122.1   il    0     \
0        1 lo       0     0      0     0   -1    0     192.168.122.1 192.168.0.9     \
192.168.0.6     192.168.0.6           0      0        1 eth0     1500  0      0     0 \
-1    0       192.168.0.9 192.168.0.9     192.168.0.4     192.168.0.4           0     \
0     3930 eth0     1500  0      44    0   4     1       192.168.0.9 192.168.0.9     \
192.168.0.4     192.168.0.4           0      7       10 eth0     1500  0      64    \
10  4     1       192.168.0.9 192.168.0.17    192.168.0.255   192.168.0.255   ibl   0 \
0        0 lo       0     0      0     0   -1    0       192.168.0.9 192.168.122.1   \
192.168.122.213 192.168.122.213       0      0        0 virbr0   1500  0      0     0 \
3     0     192.168.122.1 192.168.0.9     192.168.0.4     192.168.0.4           0     \
0     8077 eth0     1500  0      0     0   4     1       192.168.0.9 192.168.0.9     \
192.168.0.255   192.168.0.255   bl    0      0    17593 eth0     1500  0      0     0 \
3     1       192.168.0.9 192.168.0.9     192.168.0.15    192.168.0.15          0     \
0     3716 eth0     1500  0      32    0   3     0       192.168.0.9 0.0.0.0         \
224.0.0.1       224.0.0.1       ml    0      0    15844 lo       0     0      0     0 \
-1    0     192.168.122.1 192.168.0.9     192.168.0.255   192.168.0.255   bl    0     \
0        0 eth0     1500  0      0     0   3     1       192.168.0.9 192.168.0.4     \
192.168.0.9     192.168.0.9     il    0      0        0 lo       0     0      0     0 \
-1    0       192.168.0.9 192.168.0.4     192.168.0.9     192.168.0.9     il    0     \
0     1000 lo       0     0      0     10  -1    0       192.168.0.9 192.168.0.9     \
192.168.0.6     192.168.0.6           0      0     8513 eth0     1500  0      0     0 \
-1    0       192.168.0.9 192.168.0.9     192.168.0.15    192.168.0.15          0     \
0     8292 eth0     1500  0      0     0   3     0       192.168.0.9 192.168.0.15    \
192.168.0.9     192.168.0.9     il    0      0   4694564 lo       0     0      0     \
0   -1    0       192.168.0.9 192.168.122.1   192.168.122.213 192.168.122.213       0 \
1        7 virbr0   1500  0      25    10  3     0     192.168.122.1 127.0.0.1       \
127.0.0.1       127.0.0.1       l     0      0        0 lo       16436 0      0     0 \
-1    0         127.0.0.1 192.168.0.15    192.168.0.255   192.168.0.255   ibl   0     \
0    16529 lo       0     0      0     0   -1    0       192.168.0.9



</body></email><email><emailId>20111116160155</emailId><senderName>Michal Privoznik</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2011-11-16 16:01:55-0400</timestampReceived><subject>Re: [libvirt-users] Checking if the VM has been created</subject><body>

On 16.11.2011 16:46, William A. Mahaffey III wrote:
&gt; On 11/16/11 08:28, Till Mossakowski wrote:
&gt;&gt; Am 16.11.2011 14:46, schrieb William A. Mahaffey III:
&gt;&gt;
&gt;&gt;&gt; The route command on the host will show the newly added routes for the
&gt;&gt;&gt; VM. Also, tail your syslog file &amp; you will see messages about every 15
&gt;&gt;&gt; min. from dnsmasq w/ the IP adder. of the VM.
&gt;&gt;
&gt;&gt; route just shows the bridge, the individual IP of the VM is only shown
&gt;&gt; in the syslog. However, this is just a workaround, and does not
&gt;&gt; provide reliable identification of the IP if there are many VMs.
&gt;&gt; libvirt resp. virsh should provide a way of obtaining the IP directly
&gt;&gt; from the domain name.
&gt;&gt;
&gt;&gt; Best, Till
&gt;&gt;
&gt;&gt;
&gt; 
&gt; 
&gt; 
&gt; output from 'route -CFvnee' as root on my host attached, 4th line in
&gt; file shows IP addr of my VM, visible in other lines as well ....
&gt; 
&gt; 
&gt; 
&gt; &amp; I definitely agree that virsh *should* show that info :-) ....

It is not so simple. Although we have this 'ip address learning module'
in nwfilters code, it is not reliable. In general there is no reliable
technique to determine guest IP address(es) unless using guest agent
who'll tell us.

Listening on bridge and guessing addresses is not right, as guest might
be not playing a fair game and produce packets with different IP addresses.

Moreover, sniffing on multiple bridges and guessing IP addresses can be
CPU consuming. And one would need to do this sniffing repeatedly as IP
address might change over time.

Michal

</body></email><email><emailId>20111116144638</emailId><senderName>Steve Gordon</senderName><senderEmail>sgordon@redhat.com</senderEmail><timestampReceived>2011-11-16 14:46:38-0400</timestampReceived><subject>Re: [libvirt-users] Speaking of DNSmasq ....</subject><body>

&gt; .... I am getting a bit tired of those pesky DNSmasq entries in my
&gt; syslog file, they fill it up about weekly, wash other stuff out of
&gt; view
&gt; on a tail. Is there any way to suppress them. or else increase their
&gt; lease time so that they happen less frequently ? Having a finite
&gt; lease
&gt; time for a VM seems nonsensical, it can't go anywhere or disconnect
&gt; (obviously) .... I tried restarting DNSmasq, but it said 'Socket
&gt; busy'
&gt; or some such &amp; didn't restart. Someone on another list said that
&gt; DNSmasq
&gt; was/is in fact started by libvirt/KVM/QEMU, &amp; I poked around in the
&gt; various /etc/sysconfig files, but couldn't find anything related to
&gt; DNSmasq, whatever options it is started with seem to be hardwired or
&gt; compiled into one of the pertinent executables .... FC 14, 64 bit,
&gt; terminally patched up, libvirt 0.8.3-10.fc14 64-bit, qemu-KVM
&gt; 2:0.13.0-1.fc14 64-bit .... TIA ....

Hi William,

If you are running/using libvirt then chances are that it is indeed spawning an \
instance of dnsmasq listening on the virtual network. The dnsmasq instance is spawned \
based on a combination of hard-coded/default values and network configuration \
specified in the libvirt xml files, by default /var/lib/libvirt/network/default.xml \
(at least on my F16 box anyway). Unfortunately I do not think lease time is currently \
one of the supported configurable values (http://libvirt.org/formatnetwork.html), but \
you always raise a bug/rfe and ask for it to be added :).

My approach in the past with these situations in the meantime has been to kill off \
the libvirt spawned dnsmasq instances and use the system wide dnsmasq service \
instead, specifying both the configuration values libvirt *would* have used (libvirt \
feeds all the values as command line args so you can easily view them when the \
dnsmasq process is running) and the additional ones I need which are not supported by \
the xml currently.

-Steve


</body></email><email><emailId>20111115120052</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-11-15 12:00:52-0400</timestampReceived><subject>Re: [libvirt-users] listDomains() not working on Xen</subject><body>

2011/11/15 PREETHI RAMESH &lt;iampreethiramesh@gmail.com&gt;:
&gt; Hey all,
&gt; I've been trying to make listDomains() work on Xen but it simply returns an
&gt; array of null values. Also, while displaying the length of the array
&gt; returned by listDomains(). Upon using the same function in KVM, I'm able to
&gt; retrieve the complete array of active machines. I'm positive that active Xen
&gt; machines are running(cross checked it with xm list).
&gt;
&gt; I've been posting this for quite sometime now but haven't received any reply
&gt; which could debug my code. I'd really appreciate it if someone could help
&gt; me.

Your problem is probably not related to your code or the Java bindings at all.

Did you check whether 'virsh list' shows active domains for Xen?

I guess your problem is that libvirt doesn't recognize your active Xen
domains form some reason. Therefore, 'virsh list' and your own code
don't show active domains.

-- 
Matthias Bolte
http://photron.blogspot.com

</body></email><email><emailId>20111111232125</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-11-11 23:21:25-0400</timestampReceived><subject>Re: [libvirt-users] Problem with listDomains() in Xen</subject><body>


[your mailer seems to want to start a new thread rather than replying to
the existing thread, which makes following your mails difficult.  Could
you please fix that?]

On 11/10/2011 09:09 PM, PREETHI RAMESH wrote:
&gt; This question concerns the usage of the listDomains(). When I run this
&gt; piece of code in KVM, it works perfectly fine but throws an array out of
&gt; bounds exception in Xen.
&gt; 
&gt;  Connect conn=null;
&gt;  conn = new Connect("xen:///", true);
&gt;  int[] id = conn.listDomains();
&gt;  System.out.println("lD of VM " +id[0]);
&gt; 
&gt; Answer I'd got:
&gt; Well, your code assumes that id.length is &gt;= 1, but listDomains() can
&gt; return an empty array when there are no active domains known to
&gt; libvirt. So you need to check id.length before accessing any element
&gt; in the array.
&gt; 
&gt; Follow up- I tried accessing the length of the array and it's 0 all the
&gt; time. And there are active domains available.
&gt; In fact, I'm able to getUUID from the domain name. Other functions work
&gt; fine too.

getUUID works on inactive domains.  Are you sure you have active
domains?  Most likely, the array length really is 0 because you haven't
started any of your domains.

Have you looked into using listDefinedDomains(), to see the remaining
persistent domains that are defined but not running?

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20111106092401</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-11-06 09:24:01-0400</timestampReceived><subject>Re: [libvirt-users] libvirt, OSX and VirtualBox - how?</subject><body>

2011/11/6 Brian Candler &lt;B.Candler@pobox.com&gt;:
&gt; I have a new OSX Lion Macbook and would like to control VirtualBox using
&gt; "virsh" (as I do with KVM under Ubuntu).
&gt; 
&gt; I've got this far:
&gt; 
&gt; * Installed VirtualBox

Which version?

&gt; But now I'm a bit stuck :-)
&gt; 
&gt; I ran VirtualBox itself, and created a test VM successfully.
&gt; 
&gt; If I try to use virsh, this is what I get:
&gt; 
&gt; Brians-MacBook-Air:~ $ virsh -c vbox:///session
&gt; error: internal error unable to initialize VirtualBox driver API
&gt; error: failed to connect to the hypervisor

vbox:///session is the correct URI.

&gt; Brians-MacBook-Air:~ $ virsh -c vbox+unix:///session
&gt; error: Failed to connect socket to '@/Users/brian/.libvirt/libvirt-sock': No such \
&gt;                 file or directory
&gt; error: failed to connect to the hypervisor
&gt; 
&gt; If I try to start libvirtd, this is what I get:
&gt; 
&gt; Brians-MacBook-Air:~ $ /usr/local/sbin/libvirtd
&gt; 00:00:18.970: -1: info : libvirt version: 0.9.6
&gt; 00:00:18.970: -1: error : virNetSocketNewListenUNIX:340 : Failed to bind socket to \
&gt; '@/Users/brian/.libvirt/libvirt-sock': No such file or directory 
&gt; [but directory /Users/brian/.libvirt was created]

IIRC the problem here is that libvirtd uses anonymous UNIX sockets
that are specific to Linux. Anyway, you don't need libvirtd for
VirtualBox, virsh -c vbox:///session is just fine.

&gt; However, VirtualBox itself is running OK:
&gt; 
&gt; Brians-MacBook-Air:~ $ VBoxManage list vms
&gt; "test" {d0d74c25-1dfc-44a4-8a2b-1d25b7972e7c}
&gt; 
&gt; Furthermore, dtruss suggests that virsh is finding the installed VirtualBox:
&gt; 
&gt; Brians-MacBook-Air:~ $ sudo dtruss -f virsh -c vbox:///session 2&gt;&amp;1 | grep -i \
&gt;                 virtualbox
&gt; error: internal error unable to initialize VirtualBox driver API
&gt; 48916/0x3cc08:  write_nocancel(0x2, "internal error unable to initialize VirtualBox \
&gt;                 driver API\n\0", 0x3A)               = 58 0
&gt; 48916/0x3cc08:  access("/usr/lib/virtualbox/VBoxXPCOMC.dylib\0", 0x0, 0x0)       = \
&gt;                 -1 Err#2
&gt; 48916/0x3cc08:  access("/usr/lib/virtualbox-ose/VBoxXPCOMC.dylib\0", 0x0, 0x0)   = \
&gt;                 -1 Err#2
&gt; 48916/0x3cc08:  access("/usr/lib64/virtualbox/VBoxXPCOMC.dylib\0", 0x0, 0x0)     = \
&gt;                 -1 Err#2
&gt; 48916/0x3cc08:  access("/usr/lib64/virtualbox-ose/VBoxXPCOMC.dylib\0", 0x0, 0x0) = \
&gt;                 -1 Err#2
&gt; 48916/0x3cc08:  access("/usr/lib/VirtualBox/VBoxXPCOMC.dylib\0", 0x0, 0x0)       = \
&gt;                 -1 Err#2
&gt; 48916/0x3cc08:  access("/opt/virtualbox/VBoxXPCOMC.dylib\0", 0x0, 0x0)           = \
&gt;                 -1 Err#2
&gt; 48916/0x3cc08:  access("/opt/VirtualBox/VBoxXPCOMC.dylib\0", 0x0, 0x0)           = \
&gt;                 -1 Err#2
&gt; 48916/0x3cc08:  access("/opt/virtualbox/i386/VBoxXPCOMC.dylib\0", 0x0, 0x0)      = \
&gt;                 -1 Err#2
&gt; 48916/0x3cc08:  access("/opt/VirtualBox/i386/VBoxXPCOMC.dylib\0", 0x0, 0x0)      = \
&gt;                 -1 Err#2
&gt; 48916/0x3cc08:  access("/opt/virtualbox/amd64/VBoxXPCOMC.dylib\0", 0x0, 0x0)     = \
&gt;                 -1 Err#2
&gt; 48916/0x3cc08:  access("/opt/VirtualBox/amd64/VBoxXPCOMC.dylib\0", 0x0, 0x0)     = \
&gt;                 -1 Err#2
&gt; 48916/0x3cc08:  access("/usr/local/lib/virtualbox/VBoxXPCOMC.dylib\0", 0x0, 0x0) = \
&gt;                 -1 Err#2
&gt; 48916/0x3cc08:  access("/usr/local/lib/VirtualBox/VBoxXPCOMC.dylib\0", 0x0, 0x0) = \
&gt;                 -1 Err#2
&gt; 48916/0x3cc08:  access("/Applications/VirtualBox.app/Contents/MacOS/VBoxXPCOMC.dylib\0", \
&gt;                 0x0, 0x0)               = 0 0
&gt; 48916/0x3cc08:  stat64("/Applications/VirtualBox.app/Contents/MacOS/VBoxXPCOMC.dylib\0", \
&gt;                 0x7FFF685D0980, 0x7FFF685D1810)                 = 0 0
&gt; 48916/0x3cc08:  open("/Applications/VirtualBox.app/Contents/MacOS/VBoxXPCOMC.dylib\0", \
&gt;                 0x0, 0x0)                 = 4 0
&gt; 48916/0x3cc08:  stat64("/Applications/VirtualBox.app/Contents/MacOS/VBoxRT.dylib\0", \
&gt;                 0x7FFF685D0750, 0x7FFF685D15D0)             = 0 0
&gt; 48916/0x3cc08:  open("/Applications/VirtualBox.app/Contents/MacOS/VBoxRT.dylib\0", \
&gt;                 0x0, 0x0)             = 4 0
&gt; 48916/0x3cc08:  stat64("/Applications/VirtualBox.app/Contents/MacOS/VBoxXPCOM.dylib\0", \
&gt;                 0x7FFF685D0750, 0x7FFF685D15D0)          = 0 0
&gt; 48916/0x3cc08:  open("/Applications/VirtualBox.app/Contents/MacOS/VBoxXPCOM.dylib\0", \
&gt; 0x0, 0x0)          = 4 0

That's good, so libvirt actually finds the required XPCOM library.

The error you're getting indicates that libvirt has a problem
initializing the XPCOM library.

&gt; Has anybody got libvirt + OSX Lion + VirtualBox working, and if so, how did
&gt; you do it?

I don't have an OSX at hand for testing, but you can try

LIBVIRT_LOG_FILTERS=1:vbox virsh -c vbox:///session

and post the output here. This might give a hint about what's wrong.

-- 
Matthias Bolte
http://photron.blogspot.com


</body></email><email><emailId>20111106181512</emailId><senderName>Brian Candler</senderName><senderEmail>b.candler@pobox.com</senderEmail><timestampReceived>2011-11-06 18:15:12-0400</timestampReceived><subject>Re: [libvirt-users] libvirt, OSX and VirtualBox - how?</subject><body>

On Sun, Nov 06, 2011 at 10:24:01AM +0100, Matthias Bolte wrote:
&gt; &gt; * Installed VirtualBox
&gt; 
&gt; Which version?

v4.1.4 r74291 (the current version when I downloaded it 2 days ago)

&gt; vbox:///session is the correct URI.

OK, that's good to know.

&gt; I don't have an OSX at hand for testing, but you can try
&gt; 
&gt; LIBVIRT_LOG_FILTERS=1:vbox virsh -c vbox:///session
&gt; 
&gt; and post the output here. This might give a hint about what's wrong.

Brians-MacBook-Air:~ $ LIBVIRT_LOG_FILTERS=1:vbox virsh -c vbox:///session
18:11:05.910: -1: info : libvirt version: 0.9.6
18:11:05.910: -1: debug : tryLoadOne:163 : Found VBoxXPCOMC.dylib in \
'/Applications/VirtualBox.app/Contents/MacOS' 18:11:05.910: -1: debug : \
vboxRegister:94 : VBoxCGlueInit found API version: 4.1.4 (4001004) 18:11:05.910: -1: \
                debug : vboxRegister:126 : Unsupport VirtualBox API version
error: internal error unable to initialize VirtualBox driver API
error: failed to connect to the hypervisor

Looks like libvirt doesn't grok this version of VirtualBox. The version of
libvirt which Homebrew built was:

  homepage 'http://www.libvirt.org'
  url 'ftp://libvirt.org/libvirt/libvirt-0.9.6.tar.gz'
  sha256 'ce29b1cd3067b224aa834fec2a93d7613c0e72bc035760ad536a2142430bc02b'

This seems to be latest stable version - should I try 0.9.7rc2?

Aha: 7 days ago...
http://libvirt.org/git/?p=libvirt.git;a=commit;h=73ce5050e0dcf897a975fd077d249f42e0549c64


Regards,

Brian.


</body></email><email><emailId>20111106182657</emailId><senderName>Brian Candler</senderName><senderEmail>b.candler@pobox.com</senderEmail><timestampReceived>2011-11-06 18:26:57-0400</timestampReceived><subject>Re: [libvirt-users] libvirt, OSX and VirtualBox - how?</subject><body>

On Sun, Nov 06, 2011 at 06:15:12PM +0000, Brian Candler wrote:
&gt; This seems to be latest stable version - should I try 0.9.7rc2?
&gt; 
&gt; Aha: 7 days ago...
&gt; http://libvirt.org/git/?p=libvirt.git;a=commit;h=73ce5050e0dcf897a975fd077d249f42e0549c64

Updating the brew formula to 0.97-rc2, I get the following build error:

...
  CC     libvirt_driver_secret_la-secret_driver.lo
  CC     libvirt_driver_storage_la-storage_driver.lo
  CC     libvirt_driver_storage_la-storage_backend.lo
  CC     libvirt_driver_storage_la-storage_backend_fs.lo
  CC     libvirt_driver_storage_la-storage_backend_scsi.lo
  CC     libvirt_iohelper-iohelper.o
  CCLD   libvirt_util.la
  CCLD   libvirt_conf.la
/usr/bin/ranlib: file: .libs/libvirt_util.a(libvirt_util_la-bridge.o) has no symbols
/usr/bin/ranlib: file: .libs/libvirt_util.a(libvirt_util_la-stats_linux.o) has no symbols
ranlib:   CCLD   libvirt_cpu.la
file: .libs/libvirt_util.a(libvirt_util_la-bridge.o) has no symbols
ranlib: file: .libs/libvirt_util.a(libvirt_util_la-stats_linux.o) has no symbols
  CCLD   libvirt_vmx.la
  CCLD   libvirt_driver.la
  CCLD   libvirt_driver_test.la
  CCLD   libvirt-net-rpc-client.la
/usr/bin/ranlib: file: .libs/libvirt_driver.a(libvirt_driver_la-driver.o) has no symbols
ranlib: file: .libs/libvirt_driver.a(libvirt_driver_la-driver.o) has no symbols
  CCLD   libvirt-net-rpc-server.la
  CCLD   libvirt-net-rpc.la
  CCLD   libvirt_driver_vmware.la
  CCLD   libvirt_driver_vbox.la
  CCLD   libvirt_driver_security.la
  CCLD   libvirt_driver_secret.la
  CCLD   libvirt_driver_storage.la
  CCLD   libvirt_iohelper
  CCLD   libvirt_driver_remote.la
Undefined symbols for architecture x86_64:
  "_ptsname_r", referenced from:
      _virFileOpenTty in libvirt_util.a(libvirt_util_la-util.o)
ld: symbol(s) not found for architecture x86_64
collect2: ld returned 1 exit status
make[3]: *** [libvirt_iohelper] Error 1
make[3]: *** Waiting for unfinished jobs....
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [all] Error 2
==&gt; Exit Status: 2
http://github.com/mxcl/homebrew/blob/master/Library/Formula/libvirt.rb#L42
==&gt; Environment
HOMEBREW_VERSION: 0.8
HEAD: 0e318ead7589fedca2f647d0401324bfe0179a9d
HOMEBREW_PREFIX: /usr/local
HOMEBREW_CELLAR: /usr/local/Cellar
HOMEBREW_REPOSITORY: /usr/local
HOMEBREW_LIBRARY_PATH: /usr/local/Library/Homebrew
Hardware: quad-core 64-bit sandybridge
OS X: 10.7.2
Kernel Architecture: x86_64
Ruby: 1.8.7-249
/usr/bin/ruby =&gt; /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby
Xcode: 4.1
GCC-4.0: N/A 
GCC-4.2: build 5666 
LLVM: build 2335 
MacPorts or Fink? false
X11 installed? true
==&gt; Build Flags
CC: /usr/bin/llvm-gcc =&gt; /usr/llvm-gcc-4.2/bin/llvm-gcc-4.2
CXX: /usr/bin/llvm-g++ =&gt; /usr/llvm-gcc-4.2/bin/llvm-g++-4.2
LD: /usr/bin/llvm-gcc =&gt; /usr/llvm-gcc-4.2/bin/llvm-gcc-4.2
CFLAGS: -O3 -march=core2 -w -pipe
CXXFLAGS: -O3 -march=core2 -w -pipe
MAKEFLAGS: -j4

Error: Failed executing: make 
If `brew doctor' does not help diagnose the issue, please report the bug:
    https://github.com/mxcl/homebrew/wiki/checklist-before-filing-a-new-issue

--------

It would appear that OSX has ptsname but not ptsname_r:

Brians-MacBook-Air:~ $ man -k ptsname
grantpt(3), posix_openpt(3), ptsname(3), unlockpt(3) - pseudo-terminal access functions

Note: the brew formula builds libvirt with the following ./configure
arguments

    args = ["--prefix=#{prefix}",
            "--localstatedir=#{var}",
            "--mandir=#{man}",
            "--sysconfdir=#{etc}",
            "--with-esx",
            "--with-init-script=none",
            "--with-remote",
            "--with-test",
            "--with-vbox",
            "--with-vmware",
            "--with-yajl",
            "--without-qemu"]

Regards,

Brian.

</body></email><email><emailId>20111106210019</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-11-06 21:00:19-0400</timestampReceived><subject>Re: [libvirt-users] libvirt, OSX and VirtualBox - how?</subject><body>

2011/11/6 Brian Candler &lt;B.Candler@pobox.com&gt;:
&gt; On Sun, Nov 06, 2011 at 06:15:12PM +0000, Brian Candler wrote:
&gt;&gt; This seems to be latest stable version - should I try 0.9.7rc2?
&gt;&gt;
&gt;&gt; Aha: 7 days ago...
&gt;&gt; http://libvirt.org/git/?p=libvirt.git;a=commit;h=73ce5050e0dcf897a975fd077d249f42e0549c64
&gt;
&gt; Updating the brew formula to 0.97-rc2, I get the following build error:
&gt;
&gt; ...
&gt;  CC     libvirt_driver_secret_la-secret_driver.lo
&gt;  CC     libvirt_driver_storage_la-storage_driver.lo
&gt;  CC     libvirt_driver_storage_la-storage_backend.lo
&gt;  CC     libvirt_driver_storage_la-storage_backend_fs.lo
&gt;  CC     libvirt_driver_storage_la-storage_backend_scsi.lo
&gt;  CC     libvirt_iohelper-iohelper.o
&gt;  CCLD   libvirt_util.la
&gt;  CCLD   libvirt_conf.la
&gt; /usr/bin/ranlib: file: .libs/libvirt_util.a(libvirt_util_la-bridge.o) has no symbols
&gt; /usr/bin/ranlib: file: .libs/libvirt_util.a(libvirt_util_la-stats_linux.o) has no symbols
&gt; ranlib:   CCLD   libvirt_cpu.la
&gt; file: .libs/libvirt_util.a(libvirt_util_la-bridge.o) has no symbols
&gt; ranlib: file: .libs/libvirt_util.a(libvirt_util_la-stats_linux.o) has no symbols
&gt;  CCLD   libvirt_vmx.la
&gt;  CCLD   libvirt_driver.la
&gt;  CCLD   libvirt_driver_test.la
&gt;  CCLD   libvirt-net-rpc-client.la
&gt; /usr/bin/ranlib: file: .libs/libvirt_driver.a(libvirt_driver_la-driver.o) has no symbols
&gt; ranlib: file: .libs/libvirt_driver.a(libvirt_driver_la-driver.o) has no symbols
&gt;  CCLD   libvirt-net-rpc-server.la
&gt;  CCLD   libvirt-net-rpc.la
&gt;  CCLD   libvirt_driver_vmware.la
&gt;  CCLD   libvirt_driver_vbox.la
&gt;  CCLD   libvirt_driver_security.la
&gt;  CCLD   libvirt_driver_secret.la
&gt;  CCLD   libvirt_driver_storage.la
&gt;  CCLD   libvirt_iohelper
&gt;  CCLD   libvirt_driver_remote.la
&gt; Undefined symbols for architecture x86_64:
&gt;  "_ptsname_r", referenced from:
&gt;      _virFileOpenTty in libvirt_util.a(libvirt_util_la-util.o)

This is a known problem and there is already a patch proposed for this.

https://www.redhat.com/archives/libvir-list/2011-November/msg00244.html

It's not in git yet, but will make it into libvirt 0.9.7 final.

-- 
Matthias Bolte
http://photron.blogspot.com

</body></email><email><emailId>20111106210506</emailId><senderName>Brian Candler</senderName><senderEmail>b.candler@pobox.com</senderEmail><timestampReceived>2011-11-06 21:05:06-0400</timestampReceived><subject>Re: [libvirt-users] libvirt, OSX and VirtualBox - how?</subject><body>

On Sun, Nov 06, 2011 at 10:00:19PM +0100, Matthias Bolte wrote:
&gt; https://www.redhat.com/archives/libvir-list/2011-November/msg00244.html
&gt; 
&gt; It's not in git yet, but will make it into libvirt 0.9.7 final.

Thanks. I found a simple workaround:

brew install libvirt --without-libvirtd

builds fine with 0.9.7-rc2, and you said I didn't need libvirtd. And yay!

Brians-MacBook-Air:~ $ virsh list
 Id Name                 State
----------------------------------
  2 raddev64             running

Regards,

Brian.

</body></email><email><emailId>20111109113516</emailId><senderName>Brian Candler</senderName><senderEmail>b.candler@pobox.com</senderEmail><timestampReceived>2011-11-09 11:35:16-0400</timestampReceived><subject>Re: [libvirt-users] libvirt, OSX and VirtualBox - how?</subject><body>

On Sun, Nov 06, 2011 at 10:00:19PM +0100, Matthias Bolte wrote:
&gt; This is a known problem and there is already a patch proposed for this.
&gt; 
&gt; https://www.redhat.com/archives/libvir-list/2011-November/msg00244.html
&gt; 
&gt; It's not in git yet, but will make it into libvirt 0.9.7 final.

0.9.7 final builds and works fine for me under OSX, and controls VirtualBox
4.1.  Thank you!

</body></email><email><emailId>20111109183820</emailId><senderName>"Wouter - Iamotor"</senderName><senderEmail>webmaster@iamotor.nl</senderEmail><timestampReceived>2011-11-09 18:38:20-0400</timestampReceived><subject>[libvirt-users] Problem with libvirt daemon</subject><body>

This is a multipart message in MIME format.


Hello,

 

I have a problem with the libvirt daemon. I have a little php script which
should connect with libvirt, but it won't.

 

When I try to start the libvirt daemon I get this error (using the command
libvirtd --listen):

2011-11-09 19:35:18.095: 3560: info : libvirt version: 0.9.7

2011-11-09 19:35:18.095: 3560: error : virPidFileAcquirePath:345 : Failed to
acquire pid file '/var/run/libvirtd.pid': Resource temporarily unavailable

 

So the daemon won't start and isn't started yet. If I check if the service
is running with ps -ef | grep libvirtd I get this output:

root      2865     1  0 15:50 ?        00:00:00 /usr/sbin/libvirtd -d

root      3149     1  0 19:17 ?        00:00:00 libvirtd -d

root      3206     1  0 19:17 ?        00:00:00 libvirtd -dl

root      3300     1  0 19:20 ?        00:00:00 libvirtd --listen --daemon

root      3356     1  0 19:21 ?        00:00:00 libvirtd --listen --daemon

root      3564  3077  0 19:36 pts/0    00:00:00 grep --color=auto libvirtd

 

Here you can see that the service isn't running.

 

How can I fix this problem. There is a .pid file in the /var/run/ directory.
I already deleted it and used the command libvirtd -daemon -listen but it
won't start. It doesn't show any output but when I use the ps -ef command, I
see that the service is not running.

 

Can you please help me?

 

With kind regards,

Wouter.


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;&lt;head&gt;&lt;META HTTP-EQUIV="Content-Type" \
CONTENT="text/html; charset=us-ascii"&gt;&lt;meta name=Generator content="Microsoft Word 14 \
(filtered medium)"&gt;&lt;style&gt;&lt;!-- /* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	mso-fareast-language:EN-US;}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.E-mailStijl17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;
	font-family:"Calibri","sans-serif";
	mso-fareast-language:EN-US;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:70.85pt 70.85pt 70.85pt 70.85pt;}
div.WordSection1
	{page:WordSection1;}
--&gt;&lt;/style&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapelayout v:ext="edit"&gt;
&lt;o:idmap v:ext="edit" data="1" /&gt;
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;&lt;/head&gt;&lt;body lang=NL link=blue vlink=purple&gt;&lt;div \
class=WordSection1&gt;&lt;p class=MsoNormal&gt;Hello,&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;I have a \
problem with the libvirt daemon. I have a little php script which should connect with \
libvirt, but it won’t.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;When I try \
to start the libvirt daemon I get this error (using the command libvirtd \
--listen):&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;2011-11-09 \
19:35:18.095: 3560: info : libvirt version: 0.9.7&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span lang=EN-US&gt;2011-11-09 19:35:18.095: 3560: error : \
virPidFileAcquirePath:345 : Failed to acquire pid file '/var/run/libvirtd.pid': \
Resource temporarily unavailable&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;So the \
daemon won’t start and isn’t started yet. If I check if the service is \
running with ps –ef | grep libvirtd I get this output:&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span lang=EN-US&gt;root      \
2865     1  0 15:50 \
?        00:00:00 /usr/sbin/libvirtd \
-d&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;root      3149     1  0 \
19:17 ?        00:00:00 libvirtd \
-d&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;root      3206     1  0 \
19:17 ?        00:00:00 libvirtd \
-dl&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;root      3300     1  0 \
19:20 ?        00:00:00 libvirtd --listen \
--daemon&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;root      3356     1  0 \
19:21 ?        00:00:00 libvirtd --listen \
--daemon&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;root      3564  3077  0 19:36 \
pts/0    00:00:00 grep --color=auto libvirtd&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;Here you can see that the service isn’t \
running.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;How can I \
fix this problem. There is a .pid file in the /var/run/ directory. I already deleted \
it and used the command libvirtd –daemon –listen but it won’t \
start. It doesn’t show any output but when I use the ps –ef command, I \
see that the service is not running.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;Can you \
please help me?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;With kind \
regards,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;Wouter.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20111110140456</emailId><senderName></senderName><senderEmail>zhouyb13@sina.com</senderEmail><timestampReceived>2011-11-10 14:04:56-0400</timestampReceived><subject>[libvirt-users] Can't assign the 2nd MAC address to the VM</subject><body>

[Attachment #2 (text/plain)]

to all who read this message,

I can't assign the second MAC to the second NIC for a VM. If only use 1 NIC, \
assigning MAC works. But not for 2 NICs or more. Do anyone has any ideas?

I have installed KVM on Ubuntu 11.10 64bit on my laptop. Also created the bridge on \
the host, and also taps. I created a RHEL 6.1 64bit VM on this environment and run:
sudo kvm -m 512 -drive file=/data/vm/kvm/hslt/rhel61_x64_1st,cache=writeback -boot \
order=c -localtime -net nic,model=virtio,vlan=1,macaddr=52:54:00:12:34:56 -net \
tap,vlan=1,ifname=tap2,script=no -net \
nic,model=virtio,vlan=1,macaddr=52:54:00:12:34:55 -net \
tap,vlan=1,ifname=tap3,script=no It doesn't work and the VM can NOT start.
If I change the command to:
sudo kvm -m 512 -drive file=/data/vm/kvm/hslt/rhel61_x64_1st,cache=writeback -boot \
order=c -localtime -net nic,model=virtio,vlan=1,macaddr=52:54:00:12:34:56 -net \
tap,vlan=1,ifname=tap2,script=no -net nic,model=virtio,vlan=1 -net \
tap,vlan=1,ifname=tap3,script=no The VM can start, but the second NIC doesn't work in \
guest VM, and showing like no such device. After change it to:
sudo kvm -m 512 -drive file=/data/vm/kvm/hslt/rhel61_x64_1st,cache=writeback -boot \
order=c -localtime -net nic,model=virtio,vlan=1 -net tap,vlan=1,ifname=tap2,script=no \
-net nic,model=virtio,vlan=1 -net tap,vlan=1,ifname=tap3,script=no It works well, \
with 2 NICs in guest VM.


[Attachment #3 (text/html)]

to all who read this message,&lt;br&gt;&lt;br&gt;I can't assign the second MAC to the second NIC \
for a VM. If only use 1 NIC, assigning MAC works. But not for 2 NICs or more. Do \
anyone has any ideas?&lt;br&gt;&lt;br&gt;I have installed KVM on Ubuntu 11.10 64bit on my laptop. \
Also created the bridge on the host, and also taps.&lt;br&gt;I created a RHEL 6.1 64bit VM \
on this environment and run:&lt;br&gt;sudo kvm -m 512 -drive \
file=/data/vm/kvm/hslt/rhel61_x64_1st,cache=writeback -boot order=c -localtime -net \
nic,model=virtio,vlan=1,macaddr=52:54:00:12:34:56 -net \
tap,vlan=1,ifname=tap2,script=no -net \
nic,model=virtio,vlan=1,macaddr=52:54:00:12:34:55 -net \
tap,vlan=1,ifname=tap3,script=no&lt;br&gt;It doesn't work and the VM can NOT start.&lt;br&gt;If I \
change the command to:&lt;br&gt;sudo kvm -m 512 -drive \
file=/data/vm/kvm/hslt/rhel61_x64_1st,cache=writeback -boot order=c -localtime -net \
nic,model=virtio,vlan=1,macaddr=52:54:00:12:34:56 -net \
tap,vlan=1,ifname=tap2,script=no -net nic,model=virtio,vlan=1 -net \
tap,vlan=1,ifname=tap3,script=no&lt;br&gt;The VM can start, but the second NIC doesn't work \
in guest VM, and showing like no such device.&lt;br&gt;After change it to:&lt;br&gt;sudo kvm -m \
512 -drive file=/data/vm/kvm/hslt/rhel61_x64_1st,cache=writeback -boot order=c \
-localtime -net nic,model=virtio,vlan=1 -net tap,vlan=1,ifname=tap2,script=no -net \
nic,model=virtio,vlan=1 -net tap,vlan=1,ifname=tap3,script=no&lt;br&gt;It works well, with \
2 NICs in guest VM.&lt;br&gt;&lt;br&gt;&lt;a \
href="http://t.sina.com.cn/1400272442?s=6ZqP5L6/5p2l5Liq5ZCn" \
target="_blank"&gt;&lt;br&gt;&lt;/a&gt;



</body></email><email><emailId>20111111014116</emailId><senderName>���������</senderName><senderEmail>zhanggp@neusoft.com</senderEmail><timestampReceived>2011-11-11 01:41:16-0400</timestampReceived><subject>[libvirt-users] =?utf-8?q?libvirt=3Acreate_volume_error?=</subject><body>

[Attachment #2 (text/plain)]


Hi,
I use libvirt version of 0.9.6,and i use vpx://xx/db/compute to login on the esx \
hypervisor.But I get an error like "internal error Could not create volume: \
NotImplemented - ?..?���.?��?������??..���. �" when i create a new volume.And I \
follows the web-page http://www.jedi.be/blog/2010/12/08/libvirt-0-8-6-and-vmware-esx/ \
, so,do I lost something or someelse configurations are needed?  Regards ! 
---------------------------------------------------------------------------------------------------
 Confidentiality Notice: The information contained in this e-mail and any \
accompanying attachment(s)  is intended only for the use of the intended recipient \
and may be confidential and/or privileged of  Neusoft Corporation, its subsidiaries \
and/or its affiliates. If any reader of this communication is  not the intended \
recipient, unauthorized use, forwarding, printing,  storing, disclosure or copying  \
is strictly prohibited, and may be unlawful.If you have received this communication \
in error,please  immediately notify the sender by return e-mail, and delete the \
original message and all copies from  your system. Thank you. 
---------------------------------------------------------------------------------------------------



[Attachment #3 (text/html)]

���&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;
&lt;HTML&gt;&lt;HEAD&gt;
&lt;META content="text/html; charset=utf-8" http-equiv=Content-Type&gt;
&lt;STYLE&gt;BLOCKQUOTE {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; MARGIN-LEFT: 2em
}
OL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
UL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
&lt;/STYLE&gt;

&lt;META name=GENERATOR content="MSHTML 8.00.6001.19154"&gt;&lt;/HEAD&gt;
&lt;BODY style="MARGIN: 10px"&gt;&lt;FONT size=2 face=Verdana&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;Hi,&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt;I use libvirt version of 0.9.6,and i use 
vpx://xx/db/compute to login on the esx hypervisor.But I get an error like 
"internal error Could not create volume: NotImplemented - 
?..?���.?��?������??..���. �" when i create a new volume.And I follows the 
web-page &lt;A 
href="http://www.jedi.be/blog/2010/12/08/libvirt-0-8-6-and-vmware-esx/ \
"&gt;http://www.jedi.be/blog/2010/12/08/libvirt-0-8-6-and-vmware-esx/  &lt;/A&gt;, so,do \
I lost something or someelse configurations are  needed? &lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt;Regards ! &lt;/DIV&gt;&lt;/FONT&gt;&lt;font \
face="monospace"&gt;---------------------------------------------------------------------------------------------------&lt;br&gt;
 Confidentiality Notice: The information contained in this e-mail and any \
accompanying attachment(s) &lt;br&gt; is intended only for the use of the intended \
recipient and may be confidential and/or privileged of &lt;br&gt; Neusoft Corporation, its \
subsidiaries and/or its affiliates. If any reader of this communication is &lt;br&gt; not \
the intended recipient, unauthorized use, forwarding, printing,  storing, \
disclosure or copying &lt;br&gt; is strictly prohibited, and may be unlawful.If you have \
received this communication in error,please &lt;br&gt; immediately notify the sender by \
return e-mail, and delete the original message and all copies from &lt;br&gt; your system. \
                Thank you. &lt;br&gt;
---------------------------------------------------------------------------------------------------&lt;/font&gt;&lt;/BODY&gt;&lt;/HTML&gt;




</body></email><email><emailId>20111111021646</emailId><senderName></senderName><senderEmail>zhanggp@neusoft.com</senderEmail><timestampReceived>2011-11-11 02:16:46-0400</timestampReceived><subject>[libvirt-users] How to create virtual machine via virsh shell?</subject><body>

[Attachment #2 (text/plain)]


Hi,

I recently in the study of the knowledge of the libvirt(version 0.9.6) and \
vmware(esx,esxi,vcenter,vspheere client),  I use virshshell doing some work such as \
create virtual machine(but i get an error like "the connetc driver do not support") , \
define virtual machine(success but when i start it i get an error like "can not find \
vmdk file »òÆäËùÒÀÀµµÄ¿ìÕÕ´ÅÅÌÖ®Ò»"). Then I realized to first create a volume , but \
I again meet a mistake like "internal error Could not create volume: NotImplemented".

Excuse me.How should I do the right to create or define a virtual machine and the \
normal starting  it?


Regards!

zhanggp
---------------------------------------------------------------------------------------------------
 Confidentiality Notice: The information contained in this e-mail and any \
accompanying attachment(s)  is intended only for the use of the intended recipient \
and may be confidential and/or privileged of  Neusoft Corporation, its subsidiaries \
and/or its affiliates. If any reader of this communication is  not the intended \
recipient, unauthorized use, forwarding, printing,  storing, disclosure or copying  \
is strictly prohibited, and may be unlawful.If you have received this communication \
in error,please  immediately notify the sender by return e-mail, and delete the \
original message and all copies from  your system. Thank you. 
---------------------------------------------------------------------------------------------------



[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;
&lt;HTML&gt;&lt;HEAD&gt;
&lt;META content="text/html; charset=gb2312" http-equiv=Content-Type&gt;
&lt;STYLE&gt;BLOCKQUOTE {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; MARGIN-LEFT: 2em
}
OL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
UL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
&lt;/STYLE&gt;

&lt;META name=GENERATOR content="MSHTML 8.00.6001.19154"&gt;&lt;/HEAD&gt;
&lt;BODY style="MARGIN: 10px"&gt;&lt;FONT size=2 face=Verdana&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;
&lt;DIV&gt;Hi,&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt; &lt;/DIV&gt;
&lt;DIV 
style="TEXT-INDENT: 2em"&gt;I recently in the study of the&amp; \
nbsp;knowledge of the libvirt(version 0.9.6) and vmware(esx,esxi,vcenter,vspheere \
 client),  I use virshshell doing some work such as create virtual machine(but \
 i get an error like "the connetc driver do not support") , define virtual 
machine(success but when i start it i get an error like "can not find vmdk file 
&lt;SPAN 
style="FONT-FAMILY: ËÎÌå; FONT-SIZE: 10.5pt; mso-bidi-font-size: 12.0pt; \
mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; \
mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 1.0pt; mso-ansi-language: \
EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: \
AR-SA"&gt;»òÆäËùÒÀÀµµÄ¿ìÕÕ´ÅÅÌÖ®Ò»&lt;/SPAN&gt;").  \
Then I realized to first create a volume ,  \
but I again meet a mistake like "&lt;SPAN  style="FONT-FAMILY: \
'Times New Roman','serif'; FONT-SIZE: 10.5pt; mso-font-kerning: 1.0pt; \
mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; \
mso-fareast-font-family: ËÎÌå"  lang=EN-US&gt;internal error Could not create volume: \
NotImplemented&lt;/SPAN&gt;".&lt;/DIV&gt; &lt;DIV style="TEXT-INDENT: 2em"&gt; &lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt;Excuse 
me.How should I do the right to create or define a virtual machine and \
 the normal starting  it?&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt; &lt;/DIV&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt;Regards!&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt; &lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em"&gt;zhanggp&lt;/DIV&gt;&lt;/DIV&gt;&lt;/FONT&gt;&lt;font \
face="monospace"&gt;---------------------------------------------------------------------------------------------------&lt;br&gt;
 Confidentiality Notice: The information contained in this e-mail and any \
accompanying attachment(s) &lt;br&gt; is intended only for the use of the intended \
recipient and may be confidential and/or privileged of &lt;br&gt; Neusoft Corporation, its \
subsidiaries and/or its affiliates. If any reader of this communication is &lt;br&gt; not \
the intended recipient, unauthorized use, forwarding, printing,  storing, \
disclosure or copying &lt;br&gt; is strictly prohibited, and may be unlawful.If you have \
received this communication in error,please &lt;br&gt; immediately notify the sender by \
return e-mail, and delete the original message and all copies from &lt;br&gt; your system. \
                Thank you. &lt;br&gt;
---------------------------------------------------------------------------------------------------&lt;/font&gt;&lt;/BODY&gt;&lt;/HTML&gt;




</body></email><email><emailId>20111111181734</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-11-11 18:17:34-0400</timestampReceived><subject>Re: [libvirt-users] diificulty installing or building libvert</subject><body>


On 11/11/2011 09:29 AM, Jeff Gaer wrote:
&gt; I am unable to install or build libvert for RHEL4-64. Due to the errors below. Is \
&gt; it because all the source/rpms are for Fedora? I don't see any redhat versions on \
&gt; the sources page. Thanks in advance for any help.

libvirt is not supported as an rpm for RHEL 4 (it is maintained for RHEL
5, although these days most development appears to be focused on RHEL 6).

&gt; When running make against the untarred /libvirt-0.9.4.tar.gz configure succeeds but \
&gt; make fails. 
&gt; make  all-am
&gt; 
&gt; make[3]: Entering directory `/home/jgaer/Desktop/NiFi/libvirt-0.9.4/src'
&gt; CC     libvirt_driver_nwfilter_la-nwfilter_learnipaddr.lo
&gt; nwfilter/nwfilter_learnipaddr.c: In function 'learnIPAddressThread':
&gt; nwfilter/nwfilter_learnipaddr.c:522: error: 'ETHERTYPE_VLAN' undeclared (first use \
&gt; in this function) nwfilter/nwfilter_learnipaddr.c:522: error: (Each undeclared \
&gt; identifier is reported only once nwfilter/nwfilter_learnipaddr.c:522: error: for \
&gt; each function it appears in.)

That means that you'll have to do some back-porting work yourself, since
no one else on this list has tried to build for something as old as RHEL
4.  Sorry I couldn't be of more help.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20111112064132</emailId><senderName>PREETHI RAMESH</senderName><senderEmail>iampreethiramesh@gmail.com</senderEmail><timestampReceived>2011-11-12 06:41:32-0400</timestampReceived><subject>Re: [libvirt-users] Problem with listDomains() in Xen</subject><body>

Hey,
I've tried the following:

1.Domain d=conn.domainLookupByName("test");
   System.out.print("Active test" +d.isActive() );
O/p- This gives me 1 as the answer and hence active.

2.Domain d=conn.domainLookupByName("test");
   System.out.print("Active test" +d.isPersistent() );
O/p- Gives me the following error:
Exception in thread "main" org.libvirt.LibvirtException: Unknown failure
        at org.libvirt.ErrorHandler.processError(Unknown Source)
        at org.libvirt.Connect.processError(Unknown Source)
        at org.libvirt.Domain.processError(Unknown Source)
        at org.libvirt.Domain.isPersistent(Unknown Source)

3. Using listDefinedDomains():
String a[]=conn.listDefinedDomains();
System.out.println(a.length); ---&gt;gives 0
System.out.println(a[0]);       ----&gt; throes null pointer exception

4.Tried looking at VMM, and all the domains are running. The output of xm
--list also confirms it.

Thanks!
Preethi

On Sat, Nov 12, 2011 at 4:51 AM, Eric Blake &lt;eblake@redhat.com&gt; wrote:

&gt; [your mailer seems to want to start a new thread rather than replying to
&gt; the existing thread, which makes following your mails difficult.  Could
&gt; you please fix that?]
&gt;
&gt; On 11/10/2011 09:09 PM, PREETHI RAMESH wrote:
&gt; &gt; This question concerns the usage of the listDomains(). When I run this
&gt; &gt; piece of code in KVM, it works perfectly fine but throws an array out of
&gt; &gt; bounds exception in Xen.
&gt; &gt;
&gt; &gt;  Connect conn=null;
&gt; &gt;  conn = new Connect("xen:///", true);
&gt; &gt;  int[] id = conn.listDomains();
&gt; &gt;  System.out.println("lD of VM " +id[0]);
&gt; &gt;
&gt; &gt; Answer I'd got:
&gt; &gt; Well, your code assumes that id.length is &gt;= 1, but listDomains() can
&gt; &gt; return an empty array when there are no active domains known to
&gt; &gt; libvirt. So you need to check id.length before accessing any element
&gt; &gt; in the array.
&gt; &gt;
&gt; &gt; Follow up- I tried accessing the length of the array and it's 0 all the
&gt; &gt; time. And there are active domains available.
&gt; &gt; In fact, I'm able to getUUID from the domain name. Other functions work
&gt; &gt; fine too.
&gt;
&gt; getUUID works on inactive domains.  Are you sure you have active
&gt; domains?  Most likely, the array length really is 0 because you haven't
&gt; started any of your domains.
&gt;
&gt; Have you looked into using listDefinedDomains(), to see the remaining
&gt; persistent domains that are defined but not running?
&gt;
&gt; --
&gt; Eric Blake   eblake@redhat.com    +1-801-349-2682
&gt; Libvirt virtualization library http://libvirt.org
&gt;
&gt;

[Attachment #3 (text/html)]

Hey,&lt;br&gt;I've tried the following:&lt;br&gt;&lt;br&gt;1.Domain \
d=conn.domainLookupByName("test");&lt;br&gt;   System.out.print("Active \
test" +d.isActive() );&lt;br&gt;O/p- This gives me 1 as the answer and hence \
active.&lt;br&gt; &lt;br&gt;2.Domain d=conn.domainLookupByName("test");&lt;br&gt;   \
System.out.print("Active test" +d.isPersistent() );&lt;br&gt;O/p- Gives me the \
following error:&lt;br&gt;Exception in thread "main" \
org.libvirt.LibvirtException: Unknown failure&lt;br&gt;  at \
org.libvirt.ErrorHandler.processError(Unknown Source)&lt;br&gt;        at \
org.libvirt.Connect.processError(Unknown Source)&lt;br&gt;        at \
org.libvirt.Domain.processError(Unknown Source)&lt;br&gt;        at \
org.libvirt.Domain.isPersistent(Unknown Source)&lt;br&gt; &lt;br&gt;3. Using \
listDefinedDomains():&lt;br&gt;String \
a[]=conn.listDefinedDomains();&lt;br&gt;System.out.println(a.length); ---&gt;gives \
0&lt;br&gt;System.out.println(a[0]);       ----&gt; throes null pointer exception \
&lt;br&gt;&lt;br&gt;4.Tried looking at VMM, and all the domains are running. The output of xm \
--list also confirms it.&lt;br&gt; &lt;br&gt;Thanks!&lt;br&gt;Preethi&lt;br&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;On Sat, Nov 12, 2011 at 4:51 AM, Eric Blake &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:eblake@redhat.com"&gt;eblake@redhat.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; \
border-left: 1px solid rgb(204, 204, 204); padding-left: 1ex;"&gt; [your mailer seems to \
want to start a new thread rather than replying to&lt;br&gt; the existing thread, which \
makes following your mails difficult.  Could&lt;br&gt; you please fix that?]&lt;br&gt;
&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;&lt;br&gt;
On 11/10/2011 09:09 PM, PREETHI RAMESH wrote:&lt;br&gt;
&gt; This question concerns the usage of the listDomains(). When I run this&lt;br&gt;
&gt; piece of code in KVM, it works perfectly fine but throws an array out of&lt;br&gt;
&gt; bounds exception in Xen.&lt;br&gt;
&gt;&lt;br&gt;
&gt;  Connect conn=null;&lt;br&gt;
&gt;  conn = new Connect("xen:///", true);&lt;br&gt;
&gt;  int[] id = conn.listDomains();&lt;br&gt;
&gt;  System.out.println("lD of VM " +id[0]);&lt;br&gt;
&gt;&lt;br&gt;
&gt; Answer I'd got:&lt;br&gt;
&gt; Well, your code assumes that id.length is &gt;= 1, but listDomains() can&lt;br&gt;
&gt; return an empty array when there are no active domains known to&lt;br&gt;
&gt; libvirt. So you need to check id.length before accessing any element&lt;br&gt;
&gt; in the array.&lt;br&gt;
&gt;&lt;br&gt;
&gt; Follow up- I tried accessing the length of the array and it's 0 all the&lt;br&gt;
&gt; time. And there are active domains available.&lt;br&gt;
&gt; In fact, I'm able to getUUID from the domain name. Other functions work&lt;br&gt;
&gt; fine too.&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;getUUID works on inactive domains.  Are you sure you have active&lt;br&gt;
domains?  Most likely, the array length really is 0 because you haven't&lt;br&gt;
started any of your domains.&lt;br&gt;
&lt;br&gt;
Have you looked into using listDefinedDomains(), to see the remaining&lt;br&gt;
persistent domains that are defined but not running?&lt;br&gt;
&lt;font color="#888888"&gt;&lt;br&gt;
--&lt;br&gt;
Eric Blake   &lt;a href="mailto:eblake@redhat.com"&gt;eblake@redhat.com&lt;/a&gt;    \
+1-801-349-2682&lt;br&gt; Libvirt virtualization library &lt;a href="http://libvirt.org" \
target="_blank"&gt;http://libvirt.org&lt;/a&gt;&lt;br&gt; &lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20111114041048</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-11-14 04:10:48-0400</timestampReceived><subject>Re: [libvirt-users] CPU and RAM utilization</subject><body>

? 2011?11?13? 17:03, Jatin Kumar ??:
&gt; Hello,
&gt; I have a few vms running on a blade server and i want to log the 
&gt; actual RAM and CPU
&gt; utilization by these vms. dom.info &lt;http://dom.info&gt;(), libvirt API 
&gt; call is not giving correct results. It is always
&gt; showing the max allocated resources.
&gt; I have tried using virt-top also but same problem persists.

virDomainMemoryStats should work for you, in python binding, it's named
memoryStats.

&gt;
&gt; Is there any thing that i am missing.
&gt;
&gt; --
&gt; Jatin Kumar
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users


[Attachment #3 (text/html)]

&lt;html&gt;
  &lt;head&gt;
    &lt;meta content="text/html; charset=ISO-8859-1"
      http-equiv="Content-Type"&gt;
  &lt;/head&gt;
  &lt;body text="#000000" bgcolor="#FFFFFF"&gt;
    于 2011年11月13日 17:03, Jatin Kumar 写道:
    &lt;blockquote
cite="mid:CAFQ6HNwrBprLdRsLr7HUZdBz28Oz_=8DXLX+DVkLs-BpNt2stA@mail.gmail.com"
      type="cite"&gt;Hello,
      &lt;div&gt;I have a few vms running on a blade server and i want to log
        the actual RAM and CPU&lt;/div&gt;
      &lt;div&gt;utilization by these vms. &lt;a moz-do-not-send="true"
          href="http://dom.info"&gt;dom.info&lt;/a&gt;(), libvirt API call is not
        giving correct results. It is always&lt;/div&gt;
      &lt;div&gt;showing the max allocated resources.&lt;/div&gt;
      &lt;div&gt;I have tried using virt-top also but same problem persists.&lt;/div&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
    virDomainMemoryStats should work for you, in python binding, it's
    named&lt;br&gt;
    memoryStats.&lt;br&gt;
    &lt;br&gt;
    &lt;blockquote
cite="mid:CAFQ6HNwrBprLdRsLr7HUZdBz28Oz_=8DXLX+DVkLs-BpNt2stA@mail.gmail.com"
      type="cite"&gt;
      &lt;div&gt;&lt;br&gt;
      &lt;/div&gt;
      &lt;div&gt;Is there any thing that i am missing. &lt;/div&gt;
      &lt;div&gt;&lt;br&gt;
      &lt;/div&gt;
      &lt;div&gt;--&lt;/div&gt;
      &lt;div&gt;Jatin Kumar&lt;/div&gt;
      &lt;br&gt;
      &lt;fieldset class="mimeAttachmentHeader"&gt;&lt;/fieldset&gt;
      &lt;br&gt;
      &lt;pre wrap=""&gt;_______________________________________________
libvirt-users mailing list
&lt;a class="moz-txt-link-abbreviated" \
href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt; &lt;a \
class="moz-txt-link-freetext" \
href="https://www.redhat.com/mailman/listinfo/libvirt-users"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;/pre&gt;
  &lt;/blockquote&gt;
    &lt;br&gt;
  &lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20111114102121</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-11-14 10:21:21-0400</timestampReceived><subject>Re: [libvirt-users] libvirt0.8.7.tar.gz installation failure</subject><body>

äº 2011å¹´11æ14æ¥ 17:35, å¼ åé¹ åé:
&gt; Hi:
&gt; I get a very strange problem when I installing libvirt0.8.7.tar.gz.
&gt; Here is my infomaton:
&gt; compute with RHELD6.0 systerm;
&gt; the systerm comes with libvirt0.8.7,bu I uninstalled it and its 
&gt; dependencies .
&gt; And then i download the libvirt0.8.7.tar.gz , untar it ,configure 
&gt; --with-esx,make,make install.

  Guess you installed libvirt to /usr/local. Try compile with --prefix=/usr
and make install.

&gt; But I got an error like 
&gt; "libvirtd: /usr/local/lib/libvirt.so.0: version `LIBVIRT_PRIVATE_0.8.7' not found \
&gt; (required by libvirtd)  "
&gt; when i use virsh,or libvirtd.
&gt; Can someone tell me what is the error mean?
&gt; Regards!
&gt; zhanggp@neusoft.com
&gt; ---------------------------------------------------------------------------------------------------
&gt;  Confidentiality Notice: The information contained in this e-mail and 
&gt; any accompanying attachment(s)
&gt; is intended only for the use of the intended recipient and may be 
&gt; confidential and/or privileged of
&gt; Neusoft Corporation, its subsidiaries and/or its affiliates. If any 
&gt; reader of this communication is
&gt; not the intended recipient, unauthorized use, forwarding, printing,  
&gt; storing, disclosure or copying
&gt; is strictly prohibited, and may be unlawful.If you have received this 
&gt; communication in error,please
&gt; immediately notify the sender by return e-mail, and delete the 
&gt; original message and all copies from
&gt; your system. Thank you.
&gt; --------------------------------------------------------------------------------------------------- \
&gt;  
&gt; 
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users


[Attachment #3 (text/html)]

&lt;html&gt;
  &lt;head&gt;
    &lt;meta content="text/html; charset=UTF-8" http-equiv="Content-Type"&gt;
  &lt;/head&gt;
  &lt;body text="#000000" bgcolor="#FFFFFF"&gt;
    于 2011年11月14日 17:35, 张光鹏 写道:
    &lt;blockquote cite="mid:201111141735030319363@neusoft.com" type="cite"&gt;
      &lt;meta content="text/html; charset=UTF-8" http-equiv="Content-Type"&gt;
      &lt;style&gt;BLOCKQUOTE {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; MARGIN-LEFT: 2em
}
OL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
UL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
&lt;/style&gt;
      &lt;meta name="GENERATOR" content="MSHTML 8.00.6001.19154"&gt;
      &lt;font face="Verdana" size="2"&gt;
        &lt;div&gt; &lt;/div&gt;
        &lt;div&gt;Hi:&lt;/div&gt;
        &lt;div style="TEXT-INDENT: 2em"&gt;I get a very strange problem when
          I installing libvirt0.8.7.tar.gz.&lt;/div&gt;
        &lt;div style="TEXT-INDENT: 2em"&gt;Here is my infomaton:&lt;/div&gt;
        &lt;div style="TEXT-INDENT: 2em"&gt; &lt;/div&gt;
        &lt;div style="TEXT-INDENT: 2em"&gt;compute with RHELD6.0 systerm;&lt;/div&gt;
        &lt;div style="TEXT-INDENT: 2em"&gt;the systerm comes with
          libvirt0.8.7,bu I uninstalled it and its dependencies .&lt;/div&gt;
        &lt;div style="TEXT-INDENT: 2em"&gt;And then i download the
          libvirt0.8.7.tar.gz , untar it ,configure --with-esx,make,make
          install.&lt;/div&gt;
      &lt;/font&gt;&lt;/blockquote&gt;
    &lt;br&gt;
     Guess you installed libvirt to /usr/local. Try compile with
    --prefix=/usr&lt;br&gt;
    and make install. &lt;br&gt;
    &lt;br&gt;
    &lt;blockquote cite="mid:201111141735030319363@neusoft.com" type="cite"&gt;&lt;font
        face="Verdana" size="2"&gt;
        &lt;div style="TEXT-INDENT: 2em"&gt; &lt;/div&gt;
        &lt;div style="TEXT-INDENT: 2em"&gt;But I got an error like
          "libvirtd: /usr/local/lib/libvirt.so.0: version `LIBVIRT_PRIVATE_0.8.7' not \
found (required by libvirtd)  " &lt;/div&gt;
        &lt;div style="TEXT-INDENT: 2em"&gt;when i use virsh,or libvirtd.&lt;/div&gt;
        &lt;div style="TEXT-INDENT: 2em"&gt; &lt;/div&gt;
        &lt;div style="TEXT-INDENT: 2em"&gt;Can someone tell me what is the
          error mean?&lt;/div&gt;
        &lt;div style="TEXT-INDENT: 2em"&gt; &lt;/div&gt;
        &lt;div style="TEXT-INDENT: 2em"&gt;Regards!&lt;/div&gt;
        &lt;div style="TEXT-INDENT: 2em"&gt; &lt;/div&gt;
        &lt;div style="TEXT-INDENT: 2em"&gt;&lt;a class="moz-txt-link-abbreviated" \
                href="mailto:zhanggp@neusoft.com"&gt;zhanggp@neusoft.com&lt;/a&gt;&lt;/div&gt;
      &lt;/font&gt;&lt;font face="monospace"&gt;---------------------------------------------------------------------------------------------------&lt;br&gt;
  Confidentiality Notice: The information contained in this e-mail
        and any accompanying attachment(s) &lt;br&gt;
        is intended only for the use of the intended recipient and may
        be confidential and/or privileged of &lt;br&gt;
        Neusoft Corporation, its subsidiaries and/or its affiliates. If
        any reader of this communication is &lt;br&gt;
        not the intended recipient, unauthorized use, forwarding,
        printing,  storing, disclosure or copying &lt;br&gt;
        is strictly prohibited, and may be unlawful.If you have received
        this communication in error,please &lt;br&gt;
        immediately notify the sender by return e-mail, and delete the
        original message and all copies from &lt;br&gt;
        your system. Thank you. &lt;br&gt;
---------------------------------------------------------------------------------------------------&lt;/font&gt;
  &lt;br&gt;
      &lt;fieldset class="mimeAttachmentHeader"&gt;&lt;/fieldset&gt;
      &lt;br&gt;
      &lt;pre wrap=""&gt;_______________________________________________
libvirt-users mailing list
&lt;a class="moz-txt-link-abbreviated" \
href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt; &lt;a \
class="moz-txt-link-freetext" \
href="https://www.redhat.com/mailman/listinfo/libvirt-users"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;/pre&gt;
  &lt;/blockquote&gt;
    &lt;br&gt;
  &lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20111114103416</emailId><senderName>���������</senderName><senderEmail>zhanggp@neusoft.com</senderEmail><timestampReceived>2011-11-14 10:34:16-0400</timestampReceived><subject>Re: [libvirt-users] =?utf-8?q?libvirt0=2E8=2E7=2Etar=2Egz_installatio?=</subject><body>

[Attachment #2 (text/plain)]


Hi,
I lost someting. Before I install the libvirt0.8.7.tar.gz, i have installed 0.9.6, \
but i uninstall it by delete some files. So, maybe this is why i cannot install the \
version 0.8.7. And i  have tried compile with --prefix=/usr, but it doesnot work . 
Please tell me about how to unistall it compeletly and install it.
  


�� ������

���������������������
������������������������������
���������������������������������8���������������������6������
Postcode���100193
Email��� hanjp@neusoft.com
Http://www.neusoft.com 

2011-11-14



������������ Osier Yang
��������������� 2011-11-14 18:21:25
������������ �� ������
��������� libvirt-users
��������� Re: [libvirt-users] libvirt0.8.7.tar.gz installation failure

��� 2011���11���14��� 17:35, �� ������ ������: 

Hi:
I get a very strange problem when I installing libvirt0.8.7.tar.gz.
Here is my infomaton:

compute with RHELD6.0 systerm;
the systerm comes with libvirt0.8.7,bu I uninstalled it and its dependencies .
And then i download the libvirt0.8.7.tar.gz , untar it ,configure \
--with-esx,make,make install.

 Guess you installed libvirt to /usr/local. Try compile with --prefix=/usr
and make install. 



But I got an error like "libvirtd: /usr/local/lib/libvirt.so.0: version \
`LIBVIRT_PRIVATE_0.8.7' not found (required by libvirtd) "  when i use virsh,or \
libvirtd.

Can someone tell me what is the error mean?

Regards!

zhanggp@neusoft.com
---------------------------------------------------------------------------------------------------
 Confidentiality Notice: The information contained in this e-mail and any \
accompanying attachment(s)  is intended only for the use of the intended recipient \
and may be confidential and/or privileged of  Neusoft Corporation, its subsidiaries \
and/or its affiliates. If any reader of this communication is  not the intended \
recipient, unauthorized use, forwarding, printing,  storing, disclosure or copying  \
is strictly prohibited, and may be unlawful.If you have received this communication \
in error,please  immediately notify the sender by return e-mail, and delete the \
original message and all copies from  your system. Thank you. 
--------------------------------------------------------------------------------------------------- \
  

_______________________________________________
libvirt-users mailing list
libvirt-users@redhat.com
https://www.redhat.com/mailman/listinfo/libvirt-users
---------------------------------------------------------------------------------------------------
 Confidentiality Notice: The information contained in this e-mail and any \
accompanying attachment(s)  is intended only for the use of the intended recipient \
and may be confidential and/or privileged of  Neusoft Corporation, its subsidiaries \
and/or its affiliates. If any reader of this communication is  not the intended \
recipient, unauthorized use, forwarding, printing,  storing, disclosure or copying  \
is strictly prohibited, and may be unlawful.If you have received this communication \
in error,please  immediately notify the sender by return e-mail, and delete the \
original message and all copies from  your system. Thank you. 
---------------------------------------------------------------------------------------------------



[Attachment #3 (text/html)]

���&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;
&lt;HTML&gt;&lt;HEAD&gt;
&lt;META content="text/html; charset=UTF-8" http-equiv=Content-Type&gt;
&lt;META name=GENERATOR content="MSHTML 8.00.6001.19154"&gt;
&lt;STYLE&gt;@font-face {
	font-family: ������;
}
@font-face {
	font-family: Verdana;
}
@font-face {
	font-family: @������;
}
@page Section1 {size: 595.3pt 841.9pt; margin: 72.0pt 90.0pt 72.0pt 90.0pt; \
layout-grid: 15.6pt; } P.MsoNormal {
	TEXT-JUSTIFY: inter-ideograph; TEXT-ALIGN: justify; MARGIN: 0cm 0cm 0pt; \
FONT-FAMILY: "Times New Roman"; FONT-SIZE: 10.5pt }
LI.MsoNormal {
	TEXT-JUSTIFY: inter-ideograph; TEXT-ALIGN: justify; MARGIN: 0cm 0cm 0pt; \
FONT-FAMILY: "Times New Roman"; FONT-SIZE: 10.5pt }
DIV.MsoNormal {
	TEXT-JUSTIFY: inter-ideograph; TEXT-ALIGN: justify; MARGIN: 0cm 0cm 0pt; \
FONT-FAMILY: "Times New Roman"; FONT-SIZE: 10.5pt }
A:link {
	COLOR: blue; TEXT-DECORATION: underline
}
SPAN.MsoHyperlink {
	COLOR: blue; TEXT-DECORATION: underline
}
A:visited {
	COLOR: purple; TEXT-DECORATION: underline
}
SPAN.MsoHyperlinkFollowed {
	COLOR: purple; TEXT-DECORATION: underline
}
SPAN.EmailStyle17 {
	FONT-STYLE: normal; FONT-FAMILY: Verdana; COLOR: windowtext; FONT-WEIGHT: normal; \
TEXT-DECORATION: none; mso-style-type: personal-compose }
DIV.Section1 {
	page: Section1
}
BLOCKQUOTE {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; MARGIN-LEFT: 2em
}
OL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
UL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
&lt;/STYLE&gt;
&lt;/HEAD&gt;
&lt;BODY style="MARGIN-TOP: 10px; MARGIN-LEFT: 10px; MARGIN-RIGHT: 10px"&gt;
&lt;DIV align=left&gt;&lt;FONT color=#0000ff size=2 face=Verdana&gt;&lt;/FONT&gt;&lt;FONT 
color=#0000ff size=2 face=Verdana&gt;&lt;/FONT&gt; &lt;/DIV&gt;
&lt;DIV align=left&gt;&lt;FONT color=#0000ff size=2 face=Verdana&gt;Hi,&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em" align=left&gt;&lt;FONT color=#0000ff size=2 
face=Verdana&gt;I lost someting. Before I install the libvirt0.8.7.tar.gz, i have 
installed 0.9.6, but i uninstall it by delete some files. So, maybe this is why 
i cannot install the version 0.8.7.&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em" align=left&gt;&lt;FONT color=#0000ff size=2 
face=Verdana&gt;And i  have tried&lt;FONT color=#000000&gt; compile with 
--prefix=/usr, but it doesnot work . &lt;/FONT&gt;&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV style="TEXT-INDENT: 2em" align=left&gt;&lt;FONT color=#0000ff size=2 
face=Verdana&gt;Please tell me about how to unistall it compeletly and install 
it.&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT size=2 face=Verdana&gt;&lt;/FONT&gt;  
&lt;HR&gt;
&lt;/DIV&gt;
&lt;DIV align=left&gt;
&lt;DIV align=left&gt;&lt;FONT color=#c0c0c0&gt;&lt;FONT size=2 
face=Verdana&gt;&lt;SPAN&gt;�� ������&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT color=#c0c0c0 size=2 face=Verdana&gt;&lt;/FONT&gt; &lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT color=#c0c0c0&gt;&lt;FONT color=#808080 size=2&gt;&lt;FONT color=#000000&gt;&lt;FONT 
face=������&gt;���������������������&lt;/FONT&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT color=#c0c0c0&gt;&lt;FONT color=#808080 size=2&gt;&lt;SPAN 
style="FONT-FAMILY: ������; COLOR: black; FONT-SIZE: 10pt; mso-font-kerning: \
0pt"&gt;������������������������������&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#c0c0c0&gt;&lt;FONT color=#808080 size=2&gt;&lt;SPAN  style="FONT-FAMILY: ������; COLOR: \
black; FONT-SIZE: 10pt; mso-font-kerning: 0pt"&gt;&lt;/SPAN&gt;&lt;SPAN  style="FONT-FAMILY: \
������; FONT-SIZE: 10pt"&gt;&lt;FONT color=#000000&gt;���������������������������������&lt;SPAN  \
lang=EN-US&gt;8&lt;/SPAN&gt;���������������������&lt;SPAN \
lang=EN-US&gt;6&lt;/SPAN&gt;������&lt;/FONT&gt;&lt;/SPAN&gt;&lt;SPAN  style="FONT-FAMILY: ������; COLOR: \
black; FONT-SIZE: 10pt; mso-font-kerning: 0pt"  lang=EN-US&gt;&lt;BR&gt;&lt;FONT \
color=#000000&gt;Postcode&lt;/FONT&gt;&lt;/SPAN&gt;&lt;SPAN  style="FONT-FAMILY: ������; COLOR: black; \
FONT-SIZE: 10pt; mso-font-kerning: 0pt"&gt;&lt;FONT  color=#000000&gt;���&lt;SPAN \
lang=EN-US&gt;100193&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#c0c0c0&gt;&lt;FONT color=#808080 size=2&gt;&lt;FONT color=#000000&gt;&lt;SPAN  \
style="FONT-FAMILY: ������; COLOR: black; FONT-SIZE: 10pt; mso-font-kerning: \
0pt"&gt;&lt;SPAN  lang=EN-US&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&lt;FONT color=#000000&gt;&lt;SPAN 
style="FONT-FAMILY: ������; COLOR: black; FONT-SIZE: 10pt; mso-font-kerning: 0pt" 
lang=EN-US&gt;Email&lt;/SPAN&gt;&lt;SPAN 
style="FONT-FAMILY: ������; COLOR: black; FONT-SIZE: 10pt; mso-font-kerning: 0pt"&gt;��� \
 &lt;FONT color=#0000ff&gt;&lt;U&gt;hanjp&lt;/U&gt;&lt;/FONT&gt;&lt;A 
href="mailto:weixl@neusoft.com"&gt;@neusoft.com&lt;/A&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT color=#c0c0c0&gt;&lt;FONT color=#808080 size=2&gt;&lt;A 
href="http://www.neusoft.com"&gt;&lt;FONT color=#0000ff size=2 
face=@������&gt;Http://www.neusoft.com&lt;/FONT&gt;&lt;/A&gt; &lt;/DIV&gt;&lt;/FONT&gt;&lt;/FONT&gt;
&lt;DIV&gt;&lt;FONT color=#c0c0c0&gt;&lt;FONT color=#808080&gt;&lt;/FONT&gt; &lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT size=2 face=Verdana&gt;2011-11-14&lt;/FONT&gt;&lt;/FONT&gt;&lt;/DIV&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT size=2 face=Verdana&gt;
&lt;HR&gt;
&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=Verdana&gt;&lt;FONT size=2&gt;&lt;STRONG&gt;������������&lt;/STRONG&gt; Osier 
Yang&lt;/FONT&gt;&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=Verdana&gt;&lt;FONT size=2&gt;&lt;STRONG&gt;���������������&lt;/STRONG&gt; 
2011-11-14 18:21:25&lt;/FONT&gt;&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=Verdana&gt;&lt;FONT size=2&gt;&lt;STRONG&gt;������������&lt;/STRONG&gt; 
�� ������&lt;/FONT&gt;&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=Verdana&gt;&lt;FONT size=2&gt;&lt;STRONG&gt;���������&lt;/STRONG&gt; 
libvirt-users&lt;/FONT&gt;&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=Verdana&gt;&lt;FONT size=2&gt;&lt;STRONG&gt;���������&lt;/STRONG&gt; Re: [libvirt-users] 
libvirt0.8.7.tar.gz installation failure&lt;/FONT&gt;&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT size=2 face=Verdana&gt;&lt;/FONT&gt; &lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT size=2 face=Verdana&gt;��� 2011���11���14��� 17:35, �� ������ ������: 
&lt;BLOCKQUOTE cite=mid:201111141735030319363@neusoft.com type="cite"&gt;
  &lt;STYLE&gt;BLOCKQUOTE {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; MARGIN-LEFT: 2em
}
OL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
UL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
&lt;/STYLE&gt;

  &lt;META name=GENERATOR content="MSHTML 8.00.6001.19154"&gt;&lt;FONT size=2 
  face=Verdana&gt;
  &lt;DIV&gt; &lt;/DIV&gt;
  &lt;DIV&gt;Hi:&lt;/DIV&gt;
  &lt;DIV style="TEXT-INDENT: 2em"&gt;I get a very strange problem when I installing 
  libvirt0.8.7.tar.gz.&lt;/DIV&gt;
  &lt;DIV style="TEXT-INDENT: 2em"&gt;Here is my infomaton:&lt;/DIV&gt;
  &lt;DIV style="TEXT-INDENT: 2em"&gt; &lt;/DIV&gt;
  &lt;DIV style="TEXT-INDENT: 2em"&gt;compute with RHELD6.0 systerm;&lt;/DIV&gt;
  &lt;DIV style="TEXT-INDENT: 2em"&gt;the systerm comes with libvirt0.8.7,bu I 
  uninstalled it and its dependencies .&lt;/DIV&gt;
  &lt;DIV style="TEXT-INDENT: 2em"&gt;And then i download the 
  libvirt0.8.7.tar.gz , untar it ,configure --with-esx,make,make 
  install.&lt;/DIV&gt;&lt;/FONT&gt;&lt;/BLOCKQUOTE&gt;&lt;BR&gt; Guess you installed libvirt to 
/usr/local. Try compile with --prefix=/usr&lt;BR&gt;and make install. &lt;BR&gt;&lt;BR&gt;
&lt;BLOCKQUOTE cite=mid:201111141735030319363@neusoft.com type="cite"&gt;&lt;FONT 
  size=2 face=Verdana&gt;
  &lt;DIV style="TEXT-INDENT: 2em"&gt; &lt;/DIV&gt;
  &lt;DIV style="TEXT-INDENT: 2em"&gt;But I got an error like 
  "libvirtd: /usr/local/lib/libvirt.so.0: version `LIBVIRT_PRIVATE_0.8.7' not found (required by libvirtd) \
  " &lt;/DIV&gt;
  &lt;DIV style="TEXT-INDENT: 2em"&gt;when i use virsh,or libvirtd.&lt;/DIV&gt;
  &lt;DIV style="TEXT-INDENT: 2em"&gt; &lt;/DIV&gt;
  &lt;DIV style="TEXT-INDENT: 2em"&gt;Can someone tell me what is the error 
mean?&lt;/DIV&gt;
  &lt;DIV style="TEXT-INDENT: 2em"&gt; &lt;/DIV&gt;
  &lt;DIV style="TEXT-INDENT: 2em"&gt;Regards!&lt;/DIV&gt;
  &lt;DIV style="TEXT-INDENT: 2em"&gt; &lt;/DIV&gt;
  &lt;DIV style="TEXT-INDENT: 2em"&gt;&lt;A class=moz-txt-link-abbreviated 
  href="mailto:zhanggp@neusoft.com"&gt;zhanggp@neusoft.com&lt;/A&gt;&lt;/DIV&gt;&lt;/FONT&gt;&lt;FONT 
  face=monospace&gt;---------------------------------------------------------------------------------------------------&lt;BR&gt;Confidentiality \
  Notice: The information contained in this e-mail and any accompanying 
  attachment(s) &lt;BR&gt;is intended only for the use of the intended recipient and 
  may be confidential and/or privileged of &lt;BR&gt;Neusoft Corporation, its 
  subsidiaries and/or its affiliates. If any reader of this communication is 
  &lt;BR&gt;not the intended recipient, unauthorized use, forwarding, printing,  
  storing, disclosure or copying &lt;BR&gt;is strictly prohibited, and may be 
  unlawful.If you have received this communication in error,please 
  &lt;BR&gt;immediately notify the sender by return e-mail, and delete the original 
  message and all copies from &lt;BR&gt;your system. Thank you. 
  &lt;BR&gt;---------------------------------------------------------------------------------------------------&lt;/FONT&gt; \
  &lt;BR&gt;
  &lt;FIELDSET class=mimeAttachmentHeader&gt;&lt;/FIELDSET&gt; &lt;BR&gt;&lt;PRE \
wrap=""&gt;_______________________________________________ libvirt-users mailing list
&lt;A class=moz-txt-link-abbreviated \
href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/A&gt; &lt;A \
class=moz-txt-link-freetext \
href="https://www.redhat.com/mailman/listinfo/libvirt-users"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/A&gt;&lt;/PRE&gt;&lt;/BLOCKQUOTE&gt;&lt;BR&gt;&lt;/FONT&gt;&lt;/DIV&gt;&lt;font \
face="monospace"&gt;---------------------------------------------------------------------------------------------------&lt;br&gt;
 Confidentiality Notice: The information contained in this e-mail and any \
accompanying attachment(s) &lt;br&gt; is intended only for the use of the intended \
recipient and may be confidential and/or privileged of &lt;br&gt; Neusoft Corporation, its \
subsidiaries and/or its affiliates. If any reader of this communication is &lt;br&gt; not \
the intended recipient, unauthorized use, forwarding, printing,  storing, \
disclosure or copying &lt;br&gt; is strictly prohibited, and may be unlawful.If you have \
received this communication in error,please &lt;br&gt; immediately notify the sender by \
return e-mail, and delete the original message and all copies from &lt;br&gt; your system. \
                Thank you. &lt;br&gt;
---------------------------------------------------------------------------------------------------&lt;/font&gt;&lt;/BODY&gt;&lt;/HTML&gt;




</body></email><email><emailId>20111115093515</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-11-15 09:35:15-0400</timestampReceived><subject>Re: [libvirt-users] kvm/libvirt can't use vmdk files? qemu: 'vmdk' invalid format</subject><body>

On Tue, Nov 15, 2011 at 11:45:02AM +0800, Frank Hauptle wrote:
&gt; Hi all,
&gt; 
&gt; I have a RHEL6.1 qemu-kvm  hypervisor running a raw image that I
&gt; need for various reasons to convert to vmdk.

The RHEL-6 qemu-kvm build only supports raw + qcow2 file formats.

If you have another format, you must use  qemu-img to convert it
to raw/qcow2 before you can launch a KVM guest with it.


&gt; Error starting domain: internal error Process exited while reading
&gt; console log output: char device redirected to /dev/pts/5
&gt; qemu: 'vmdk' invalid format

This is QEMU telling you it doesn't support vmdk.

Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20111115133050</emailId><senderName>Preethi Ramesh</senderName><senderEmail>pree011235@gmail.com</senderEmail><timestampReceived>2011-11-15 13:30:50-0400</timestampReceived><subject>Re: [libvirt-users] listDomains() not working on Xen</subject><body>

Thanks!

I tried virsh -c xen:///system list --all
and I got:
Domain 0  running
test          idle

I'm able to successfully ping the test VM also. How can I get the list of
active VMs now?



On Tue, Nov 15, 2011 at 11:00 AM, Matthias Bolte &lt;
matthias.bolte@googlemail.com&gt; wrote:

&gt; 2011/11/15 PREETHI RAMESH &lt;iampreethiramesh@gmail.com&gt;:
&gt; &gt; Hey all,
&gt; &gt; I've been trying to make listDomains() work on Xen but it simply returns
&gt; an
&gt; &gt; array of null values. Also, while displaying the length of the array
&gt; &gt; returned by listDomains(). Upon using the same function in KVM, I'm able
&gt; to
&gt; &gt; retrieve the complete array of active machines. I'm positive that active
&gt; Xen
&gt; &gt; machines are running(cross checked it with xm list).
&gt; &gt;
&gt; &gt; I've been posting this for quite sometime now but haven't received any
&gt; reply
&gt; &gt; which could debug my code. I'd really appreciate it if someone could help
&gt; &gt; me.
&gt;
&gt; Your problem is probably not related to your code or the Java bindings at
&gt; all.
&gt;
&gt; Did you check whether 'virsh list' shows active domains for Xen?
&gt;
&gt; I guess your problem is that libvirt doesn't recognize your active Xen
&gt; domains form some reason. Therefore, 'virsh list' and your own code
&gt; don't show active domains.
&gt;
&gt; --
&gt; Matthias Bolte
&gt; http://photron.blogspot.com
&gt;

[Attachment #3 (text/html)]

Thanks!&lt;br&gt;&lt;br&gt;I tried virsh -c xen:///system list --all&lt;br&gt;and I got:&lt;br&gt;Domain 0  \
running&lt;br&gt;test          idle&lt;br&gt;&lt;br&gt;I'm able to successfully ping the test VM \
also. How can I get the list of active VMs now?&lt;br&gt;&lt;br&gt; &lt;br&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;On Tue, Nov 15, 2011 at 11:00 AM, Matthias Bolte &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:matthias.bolte@googlemail.com" \
target="_blank"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex"&gt;

2011/11/15 PREETHI RAMESH &lt;&lt;a href="mailto:iampreethiramesh@gmail.com" \
target="_blank"&gt;iampreethiramesh@gmail.com&lt;/a&gt;&gt;:&lt;br&gt; &gt; Hey all,&lt;br&gt;
&gt; I've been trying to make listDomains() work on Xen but it simply returns \
an&lt;br&gt; &gt; array of null values. Also, while displaying the length of the array&lt;br&gt;
&gt; returned by listDomains(). Upon using the same function in KVM, I'm able \
to&lt;br&gt; &gt; retrieve the complete array of active machines. I'm positive that \
active Xen&lt;br&gt; &gt; machines are running(cross checked it with xm list).&lt;br&gt;
&gt;&lt;br&gt;
&gt; I've been posting this for quite sometime now but haven't received any \
reply&lt;br&gt; &gt; which could debug my code. I'd really appreciate it if someone \
could help&lt;br&gt; &gt; me.&lt;br&gt;
&lt;br&gt;
Your problem is probably not related to your code or the Java bindings at all.&lt;br&gt;
&lt;br&gt;
Did you check whether 'virsh list' shows active domains for Xen?&lt;br&gt;
&lt;br&gt;
I guess your problem is that libvirt doesn't recognize your active Xen&lt;br&gt;
domains form some reason. Therefore, 'virsh list' and your own code&lt;br&gt;
don't show active domains.&lt;br&gt;
&lt;font color="#888888"&gt;&lt;br&gt;
--&lt;br&gt;
Matthias Bolte&lt;br&gt;
&lt;a href="http://photron.blogspot.com" \
target="_blank"&gt;http://photron.blogspot.com&lt;/a&gt;&lt;br&gt; &lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20111115181534</emailId><senderName>Jatin Kumar</senderName><senderEmail>cs5090243@cse.iitd.ernet.in</senderEmail><timestampReceived>2011-11-15 18:15:34-0400</timestampReceived><subject>[libvirt-users] virsh Attach-disk function</subject><body>

Hello,
I have to use attach-disk function for providing additional storage to the
guest domain
but i couldn't found proper documentation anywhere which i can follow.
----
For linux (Ubuntu 11.10 server edition, 64bit) guest i tried
qemu-img create -f qcow2 disk.qcow2 size
virsh attach-disk guest_name --driver file disk.qcow2 sdc

Both of the above commands are working fine but when i try to format the
drive from
inside linux then its size reduces to few KB. Before formatting qemu-img
info reports
correct info(as expected, correct virtual size) but after formatting the
even qemu-img
info reports its actual size(few KB) not virtual size.
-----
For windows (Windows 2008 Server R2) guest, i tried
qemu-img create -f raw disk.img size
virsh attach-disk guest_name --driver file disk.img vdb

virsh shows that the disk is attached successfully, but i cannot find any
disk attached
from inside the guest (in storage management). I tried rebooting the guest
but same
problem.

Is there anything that i am doing wrong or missing.

--
Jatin Kumar

[Attachment #3 (text/html)]

Hello,&lt;div&gt;I have to use attach-disk function for providing additional stor=
age to the guest domain&lt;/div&gt;&lt;div&gt;but i couldn't found proper documenta=
tion anywhere which i can follow.&lt;/div&gt;&lt;div&gt;----&lt;/div&gt;&lt;div&gt;For linux (Ubunt=
u 11.10 server edition, 64bit) guest i tried&lt;/div&gt;

&lt;div&gt;qemu-img create -f qcow2 disk.qcow2 size&lt;/div&gt;&lt;div&gt;virsh attach-disk g=
uest_name --driver file disk.qcow2 sdc&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Both of the=
 above commands are working fine but when i try to format the drive from&lt;/d=
iv&gt;

&lt;div&gt;inside linux then its size reduces to few KB. Before formatting qemu-i=
mg info reports&lt;/div&gt;&lt;div&gt;correct info(as expected, correct virtual size) b=
ut after formatting the even qemu-img&lt;/div&gt;&lt;div&gt;info reports its actual siz=
e(few KB) not virtual size.&lt;/div&gt;

&lt;div&gt;-----&lt;/div&gt;&lt;div&gt;For windows (Windows 2008 Server R2) guest, i tried&lt;/d=
iv&gt;&lt;div&gt;qemu-img create -f raw disk.img size&lt;/div&gt;&lt;div&gt;virsh attach-disk gu=
est_name --driver file disk.img vdb&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;virsh shows th=
at the disk is attached successfully, but i cannot find any disk attached&lt;/=
div&gt;

&lt;div&gt;from inside the guest (in storage management). I tried rebooting the g=
uest but same&lt;/div&gt;&lt;div&gt;problem.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is there anything=
 that i am doing wrong or missing.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;--&lt;/div&gt;&lt;div&gt;

Jatin Kumar&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;


</body></email><email><emailId>20111116151753</emailId><senderName>"William A. Mahaffey III"</senderName><senderEmail>wam@hiwaay.net</senderEmail><timestampReceived>2011-11-16 15:17:53-0400</timestampReceived><subject>Re: [libvirt-users] Speaking of DNSmasq ....</subject><body>

On 11/16/11 08:46, Steve Gordon wrote:
&gt; &gt; .... I am getting a bit tired of those pesky DNSmasq entries in my
&gt; &gt; syslog file, they fill it up about weekly, wash other stuff out of
&gt; &gt; view
&gt; &gt; on a tail. Is there any way to suppress them. or else increase their
&gt; &gt; lease time so that they happen less frequently ? Having a finite
&gt; &gt; lease
&gt; &gt; time for a VM seems nonsensical, it can't go anywhere or disconnect
&gt; &gt; (obviously) .... I tried restarting DNSmasq, but it said 'Socket
&gt; &gt; busy'
&gt; &gt; or some such&amp;  didn't restart. Someone on another list said that
&gt; &gt; DNSmasq
&gt; &gt; was/is in fact started by libvirt/KVM/QEMU,&amp;  I poked around in the
&gt; &gt; various /etc/sysconfig files, but couldn't find anything related to
&gt; &gt; DNSmasq, whatever options it is started with seem to be hardwired or
&gt; &gt; compiled into one of the pertinent executables .... FC 14, 64 bit,
&gt; &gt; terminally patched up, libvirt 0.8.3-10.fc14 64-bit, qemu-KVM
&gt; &gt; 2:0.13.0-1.fc14 64-bit .... TIA ....
&gt; Hi William,
&gt; 
&gt; If you are running/using libvirt then chances are that it is indeed spawning an \
&gt; instance of dnsmasq listening on the virtual network. The dnsmasq instance is \
&gt; spawned based on a combination of hard-coded/default values and network \
&gt; configuration specified in the libvirt xml files, by default \
&gt; /var/lib/libvirt/network/default.xml (at least on my F16 box anyway). Unfortunately \
&gt; I do not think lease time is currently one of the supported configurable values \
&gt; (http://libvirt.org/formatnetwork.html), but you always raise a bug/rfe and ask for \
&gt; it to be added :). 
&gt; My approach in the past with these situations in the meantime has been to kill off \
&gt; the libvirt spawned dnsmasq instances and use the system wide dnsmasq service \
&gt; instead, specifying both the configuration values libvirt *would* have used \
&gt; (libvirt feeds all the values as command line args so you can easily view them when \
&gt; the dnsmasq process is running) and the additional ones I need which are not \
&gt; supported by the xml currently. 
&gt; -Steve
&gt; 



Thanks, I just bugzilla'ed it &amp; it took it (didn't bounce it as dup or 
ridiculous) .... Just a longer default lease time, maybe daily or 
weekly, would be AOK w/ me .... I don't have another instance running, 
don't use it or need it for anything else, local LAN only, /etc/hosts 
handles everything .... Thanks again :-) ....


-- 

	William A. Mahaffey III

  ----------------------------------------------------------------------

	"The M1 Garand is without doubt the finest implement of war
	 ever devised by man."
                            -- Gen. George S. Patton Jr.


</body></email><email><emailId>20111116160926</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-11-16 16:09:26-0400</timestampReceived><subject>Re: [libvirt-users] Checking if the VM has been created</subject><body>


On 11/16/2011 08:46 AM, William A. Mahaffey III wrote:
&gt;&gt;&gt; The route command on the host will show the newly added routes for the
&gt;&gt;&gt; VM. Also, tail your syslog file &amp; you will see messages about every 15
&gt;&gt;&gt; min. from dnsmasq w/ the IP adder. of the VM.
&gt;&gt;

&gt; 
&gt; &amp; I definitely agree that virsh *should* show that info :-) ....

This has been an oft-requested feature, but no one has yet submitted
patches.  The closest we have is that use of nwfilter can snoop a
guest's address, but this isn't yet exposed to the user via an
easy-to-access API.  If you set up a DHCP server to assign guest IP
addresses based on guest MAC address, then you know what IP address the
guest should have.  But if this is not the case, then the only way
libvirt can learn this is by snooping - libvirt can snoop DHCP traffic
to learn what an external dhcp server is giving to the guest, as well as
snoop guest traffic to see what address the guest appears to be using.
But a malicious guest can spoof this snooping, not to mention that a
guest that uses multiple IP addresses on a single interface may confuse
libvirt, which will probably only snoop the first address used.  And a
guest that never initiates traffic is hard to snoop - making it hard to
know what address to use for ssh into the guest.  There are also plans
to make use of a guest agent for communicating the guest IP address back
over the agent channel (right now, libvirt's only use of a guest agent
is for triggering guest shutdown), but again this relies on the agent
being present in the guest and cannot be deemed 100% reliable.

Use of libvirt guest console features tends to be more reliable than
trying to ssh into a guest, since that bypasses the need to learn the
guest's IP address.

-- 
Eric Blake   eblake@redhat.com    +1-919-301-3266
Libvirt virtualization library http://libvirt.org


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20111116161848</emailId><senderName></senderName><senderEmail>paul.worner@thomsonreuters.com</senderEmail><timestampReceived>2011-11-16 16:18:48-0400</timestampReceived><subject>[libvirt-users] Network questions</subject><body>

Hi all,

When creating a new network:


1)    Is there a way to disable automatic spawning of dnsmasq on network creation?  I \
read that leaving out the &lt;DHCP&gt; section should accomplish this, but that is not what \
I am seeing.

2)    Is there a way to disable automatic installation of iptables rules?

3)    For that matter, what is the purpose of the default iptables rule set?  Doesn't \
line 3 let all traffic pass anyway?

Thanks,
Paul


Running libvirt 0.9.2 on Ubuntu 11.10 server.

Here's the libvirt network config:

RAW CONFIG
&lt;network&gt;
  &lt;name&gt;test&lt;/name&gt;
  &lt;bridge name="virbr%d" stp="off" delay="0"/&gt;
  &lt;forward mode="route"/&gt;
  &lt;ip address="192.168.0.1" netmask="255.255.255.0"&gt;
  &lt;/ip&gt;
&lt;/network&gt;

COMMAND
virsh net-create test.xml

RESULTS
virsh net-dumpxml test
&lt;network&gt;
  &lt;name&gt;test&lt;/name&gt;
  &lt;uuid&gt;2eff5e7f-847a-1fbf-ec82-01a46ef0f6c2&lt;/uuid&gt;
  &lt;forward mode='route'/&gt;
  &lt;bridge name='virbr3' stp='off' delay='0' /&gt;
  &lt;mac address='52:54:00:47:E6:15'/&gt;
  &lt;ip address='192.168.0.1' netmask='255.255.255.0'&gt;
  &lt;/ip&gt;
&lt;/network

ps aux | grep dns
nobody    4391  0.0  0.0  21616   916 ?        S    09:45   0:00 dnsmasq \
--strict-order --bind-interfaces --pid-file=/var/run/libvirt/network/test.pid \
--conf-file= --except-interface lo --listen-address 192.168.0.1

iptables -L --line-numbers
Chain FORWARD (policy ACCEPT)
num  target     prot opt source               destination
1    ACCEPT     all  --  anywhere             192.168.0.0/24
2    ACCEPT     all  --  192.168.0.0/24       anywhere
3    ACCEPT     all  --  anywhere             anywhere
4    REJECT     all  --  anywhere             anywhere            reject-with \
icmp-port-unreachable 5    REJECT     all  --  anywhere             anywhere          \
reject-with icmp-port-unreachable


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt; &lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=us-ascii"&gt;
&lt;meta name="Generator" content="Microsoft Word 12 (filtered medium)"&gt;
&lt;style&gt;&lt;!--
/* Font Definitions */
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{mso-style-priority:34;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Tahoma","sans-serif";
	color:windowtext;
	font-weight:normal;
	font-style:normal;
	text-decoration:none none;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
/* List Definitions */
@list l0
	{mso-list-id:1731269078;
	mso-list-type:hybrid;
	mso-list-template-ids:933263592 67698705 67698713 67698715 67698703 67698713 \
67698715 67698703 67698713 67698715;} @list l0:level1
	{mso-level-text:"%1\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
--&gt;&lt;/style&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapelayout v:ext="edit"&gt;
&lt;o:idmap v:ext="edit" data="1" /&gt;
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
&lt;/head&gt;
&lt;body lang="EN-US" link="blue" vlink="purple"&gt;
&lt;div class="WordSection1"&gt;
&lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;Hi \
all,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;When \
creating a new network:&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class="MsoListParagraph" style="text-indent:-.25in;mso-list:l0 level1 lfo1"&gt;&lt;![if \
!supportLists]&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;&lt;span \
style="mso-list:Ignore"&gt;1)&lt;span style="font:7.0pt "Times New \
Roman""&gt;    &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;Is \
there a way to disable automatic spawning of dnsmasq on network creation?  I \
read that leaving out the &lt;DHCP&gt; section should accomplish this, but that is \
not  what I am seeing.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoListParagraph" style="text-indent:-.25in;mso-list:l0 level1 lfo1"&gt;&lt;![if \
!supportLists]&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;&lt;span \
style="mso-list:Ignore"&gt;2)&lt;span style="font:7.0pt "Times New \
Roman""&gt;    &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;Is \
there a way to disable automatic installation of iptables \
rules?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoListParagraph" \
style="text-indent:-.25in;mso-list:l0 level1 lfo1"&gt;&lt;![if !supportLists]&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;&lt;span \
style="mso-list:Ignore"&gt;3)&lt;span style="font:7.0pt "Times New \
Roman""&gt;    &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;For \
that matter, what is the purpose of the default iptables rule set?  \
Doesn’t line 3 let all traffic pass anyway?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p \
class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;Thanks,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;Paul&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;Running \
libvirt 0.9.2 on Ubuntu 11.10 server.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p \
class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;Here’s \
the libvirt network config:&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class="MsoNormal"&gt;&lt;b&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;RAW \
CONFIG&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/b&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;&lt;network&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;  \
&lt;name&gt;test&lt;/name&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;  \
&lt;bridge name="virbr%d" stp="off" \
delay="0"/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;  \
&lt;forward mode="route"/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p \
class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;  \
&lt;ip address="192.168.0.1" \
netmask="255.255.255.0"&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p \
class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;  \
&lt;/ip&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;&lt;/network&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class="MsoNormal"&gt;&lt;b&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;COMMAND&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;
 &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;virsh \
net-create test.xml&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class="MsoNormal"&gt;&lt;b&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;RESULTS&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;
 &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;virsh \
net-dumpxml test&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;&lt;network&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;  \
&lt;name&gt;test&lt;/name&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;  \
&lt;uuid&gt;2eff5e7f-847a-1fbf-ec82-01a46ef0f6c2&lt;/uuid&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; \
&lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;  \
&lt;forward mode='route'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;  \
&lt;bridge name='virbr3' stp='off' delay='0' /&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p \
class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;  \
&lt;mac address='52:54:00:47:E6:15'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p \
class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;  \
&lt;ip address='192.168.0.1' netmask='255.255.255.0'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p \
class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;  \
&lt;/ip&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;&lt;/network&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class="MsoNormal"&gt;&lt;b&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;
 &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;ps aux \
| grep dns&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;nobody    \
4391  0.0  0.0  21616   916 \
?        S    09:45   \
0:00 dnsmasq --strict-order --bind-interfaces \
--pid-file=/var/run/libvirt/network/test.pid --conf-file= --except-interface  lo \
--listen-address 192.168.0.1&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;iptables \
-L --line-numbers&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;Chain \
FORWARD (policy ACCEPT)&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;num  \
target     prot opt \
source               \
destination         &lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;1    \
ACCEPT     all  --  \
anywhere             \
192.168.0.0/24      &lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;2    \
ACCEPT     all  --  \
192.168.0.0/24       \
anywhere            \
&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;3    \
ACCEPT     all  --  \
anywhere             \
anywhere            \
&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;4    \
REJECT     all  --  \
anywhere             \
anywhere            \
reject-with icmp-port-unreachable &lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;5    \
REJECT     all  --  \
anywhere             \
anywhere            \
reject-with icmp-port-unreachable&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p class="MsoNormal"&gt;&lt;span \
style="font-size:10.0pt;font-family:"Tahoma","sans-serif""&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20111117090515</emailId><senderName>Nicolas Sebrecht</senderName><senderEmail>nsebrecht@piing.fr</senderEmail><timestampReceived>2011-11-17 09:05:15-0400</timestampReceived><subject>[libvirt-users]  Re: consider bios upgrade...</subject><body>

The 16/11/11, jurgen.depicker@let.be wrote:

&gt;    Now I'm not sure what this is all about: how can I possibly upgrade my
&gt;    VM's BIOS, or should I do something else?  Can it have something to do
&gt;    with the processor specs in the VM's XML definition?

Giving your hardware specs and Windows version might help. I bet you'll
get much better help from qemu-kvm developers, though.

Oh, and I wouldn't pay too much attention to the Microsoft's diagnostic...

-- 
Nicolas Sebrecht

</body></email><email><emailId>20111117112449</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-11-17 11:24:49-0400</timestampReceived><subject>Re: [libvirt-users] libvirt uninstall @ install problem??</subject><body>

äº 2011å¹´11æ17æ¥ 17:30, å¼ åé¹ åé:
&gt; Hi:
&gt; I have a rhel6.1 system, before I installed libvirt0.9.6.tar.gz, it 
&gt; already have installed libvirt-0.8.7-xxx.rpm.
&gt; Can someone tell me how to uninstall the libvirt-0.8.7XXX.rpm ,and 
&gt; then i can install libvirt0.9.6.tar.gz and use it .

Per you installed 0.8.7 as rpm, simply erase it (rpm -e) will work I guess.

&gt; Thanks!
&gt; zhanggp@neusoft.com &lt;mailto:zhanggp@neusoft.com&gt;
&gt; ---------------------------------------------------------------------------------------------------
&gt; Confidentiality Notice: The information contained in this e-mail and 
&gt; any accompanying attachment(s)
&gt; is intended only for the use of the intended recipient and may be 
&gt; confidential and/or privileged of
&gt; Neusoft Corporation, its subsidiaries and/or its affiliates. If any 
&gt; reader of this communication is
&gt; not the intended recipient, unauthorized use, forwarding, printing,  
&gt; storing, disclosure or copying
&gt; is strictly prohibited, and may be unlawful.If you have received this 
&gt; communication in error,please
&gt; immediately notify the sender by return e-mail, and delete the 
&gt; original message and all copies from
&gt; your system. Thank you.
&gt; --------------------------------------------------------------------------------------------------- 
&gt;
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users


[Attachment #3 (text/html)]

&lt;html&gt;
  &lt;head&gt;
    &lt;meta content="text/html; charset=UTF-8" http-equiv="Content-Type"&gt;
  &lt;/head&gt;
  &lt;body text="#000000" bgcolor="#FFFFFF"&gt;
    于 2011年11月17日 17:30, 张光鹏 写道:
    &lt;blockquote cite="mid:201111171730355316604@neusoft.com" type="cite"&gt;
      &lt;style type="text/css"&gt;@import url( C:\Documents and \
Settings\Administrator\Local Settings\Temporary Internet Files\scrollbar.css ); \
&lt;/style&gt;  &lt;meta content="text/html; charset=UTF-8" http-equiv="Content-Type"&gt;
      &lt;style&gt;BLOCKQUOTE {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; MARGIN-LEFT: 2em
}
OL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
UL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
&lt;/style&gt;
      &lt;meta name="GENERATOR" content="MSHTML 8.00.6001.19154"&gt;
      &lt;font face="Verdana" size="2"&gt;
        &lt;div&gt; &lt;/div&gt;
        &lt;div&gt;Hi:&lt;/div&gt;
        &lt;div style="TEXT-INDENT: 2em"&gt; &lt;/div&gt;
        &lt;div style="TEXT-INDENT: 2em"&gt;I have a rhel6.1 system, before I
          installed libvirt0.9.6.tar.gz, it already have installed
          libvirt-0.8.7-xxx.rpm.&lt;/div&gt;
        &lt;div style="TEXT-INDENT: 2em"&gt; &lt;/div&gt;
        &lt;div style="TEXT-INDENT: 2em"&gt;Can someone tell me how to
          uninstall the libvirt-0.8.7XXX.rpm ,and then i can install
          libvirt0.9.6.tar.gz and use it .&lt;/div&gt;
      &lt;/font&gt;&lt;/blockquote&gt;
    &lt;br&gt;
    Per you installed 0.8.7 as rpm, simply erase it (rpm -e) will work I
    guess.&lt;br&gt;
    &lt;br&gt;
    &lt;blockquote cite="mid:201111171730355316604@neusoft.com" type="cite"&gt;&lt;font
        face="Verdana" size="2"&gt;
        &lt;div style="TEXT-INDENT: 2em"&gt; &lt;/div&gt;
        &lt;div style="TEXT-INDENT: 2em"&gt;Thanks!&lt;/div&gt;
        &lt;div style="TEXT-INDENT: 2em"&gt; &lt;/div&gt;
        &lt;div style="TEXT-INDENT: 2em"&gt;&lt;a moz-do-not-send="true"
            href="mailto:zhanggp@neusoft.com"&gt;zhanggp@neusoft.com&lt;/a&gt;&lt;/div&gt;
        &lt;div style="TEXT-INDENT: 2em"&gt; &lt;/div&gt;
      &lt;/font&gt;&lt;font face="monospace"&gt;---------------------------------------------------------------------------------------------------&lt;br&gt;
  Confidentiality Notice: The information contained in this e-mail
        and any accompanying attachment(s) &lt;br&gt;
        is intended only for the use of the intended recipient and may
        be confidential and/or privileged of &lt;br&gt;
        Neusoft Corporation, its subsidiaries and/or its affiliates. If
        any reader of this communication is &lt;br&gt;
        not the intended recipient, unauthorized use, forwarding,
        printing,  storing, disclosure or copying &lt;br&gt;
        is strictly prohibited, and may be unlawful.If you have received
        this communication in error,please &lt;br&gt;
        immediately notify the sender by return e-mail, and delete the
        original message and all copies from &lt;br&gt;
        your system. Thank you. &lt;br&gt;
---------------------------------------------------------------------------------------------------&lt;/font&gt;
  &lt;br&gt;
      &lt;fieldset class="mimeAttachmentHeader"&gt;&lt;/fieldset&gt;
      &lt;br&gt;
      &lt;pre wrap=""&gt;_______________________________________________
libvirt-users mailing list
&lt;a class="moz-txt-link-abbreviated" \
href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt; &lt;a \
class="moz-txt-link-freetext" \
href="https://www.redhat.com/mailman/listinfo/libvirt-users"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;/pre&gt;
  &lt;/blockquote&gt;
    &lt;br&gt;
  &lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20111117131214</emailId><senderName>Chang Liu</senderName><senderEmail>lingjiao.lc@taobao.com</senderEmail><timestampReceived>2011-11-17 13:12:14-0400</timestampReceived><subject>[libvirt-users] [libvirt-user] questions about disk driver virtio and charmonitor</subject><body>

hi all,
   I have two questions about libvirt.

   At first, how can I write a XML file that libvirt could give me a command that \
include this: if=virtio.

  -drive file=/dev/vg.vmms/lvm-v097218.sqa.cm4,if=none,id=drive-ide0-0-0,format=raw \
-device ide-drive,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0

  event I have let the &lt;target dev=vda bus=virtio&gt;  the XML file also make the \
command not include virtio, it's like this:

-drive file=/dev/vg.vmms/lvm-v097226.sqa.cm4,if=none,id=drive-virtio-disk0,format=raw,cache=none \
-device virtio-blk-pci,bus=pci.0,addr=0x4,drive=drive-virtio-disk0,id=virtio-disk0

 and my question is, this is command args could enable virtio? or there is some other \
XML format could let the if=virtio.

  Second when I boot the vm in the second step after use the kickstart install it.
Once in a while, it occurs an error that:

                    monitor socket did not show up.: No such file or &gt;
                    Traceback (most recent call last):
                    File \
"/home/lingjiao.lc/vmms/backserv/bin/../lib/virtmgr.py&lt;http://lingjiao.lc/vmms/backserv/lib/virtmgr.py&gt;", \
line 1007, in request_vm  dom.create()
                    File "/usr/lib64/python2.6/site-packages/libvirt.py", line 325, \
                in create
                    if ret == -1: raise libvirtError ('virDomainCreate() failed', \
                dom=self)
                    libvirtError: monitor socket did not show up.: No such file or \
directory

  But if I reinstall it, it will be ok.  If I install hundreds of VMs once, I think \
this is a headache.


   Could anybody help me, how can I disable the charmonitor or solve these problem.

Thanks.

________________________________

This email (including any attachments) is confidential and may be legally privileged. \
If you received this email in error, please delete it immediately and do not copy it \
or use it for any purpose or disclose its contents to any other person. Thank you.

���������(������������������)�������������������������������������������������������������������������������������������� \
���������������������������������������������������������������������������������������������������������������������



[Attachment #3 (text/html)]

&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;span style="font-family:arial,sans-serif; font-size:13px; \
background-color:rgb(255,255,255)"&gt;hi all,&lt;/span&gt; &lt;div&gt;&lt;font face="arial, \
sans-serif"&gt;   I have two questions about libvirt.&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font \
face="arial, sans-serif"&gt;&lt;br&gt; &lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="arial, sans-serif"&gt;   At first, how can I write a XML file \
that libvirt could give me a command that include this: if=virtio.&lt;/font&gt;&lt;/div&gt; \
&lt;div&gt;&lt;font face="arial, sans-serif"&gt;&lt;br&gt; &lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="arial, sans-serif"&gt;  -drive \
file=/dev/vg.vmms/lvm-v097218.sqa.cm4,if=none,id=drive-ide0-0-0,format=raw -device \
ide-drive,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0&lt;br&gt; &lt;/font&gt;
&lt;div&gt;&lt;font face="arial, sans-serif"&gt;  &lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="arial, sans-serif"&gt;  event I have let the &lt;target dev=vda \
bus=virtio&gt;  the XML file also make the command not include virtio, it's like \
this:&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font face="arial, sans-serif"&gt;&lt;br&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="arial, sans-serif"&gt;-drive \
file=/dev/vg.vmms/lvm-v097226.sqa.cm4,if=none,id=drive-virtio-disk0,format=raw,cache=none \
-device virtio-blk-pci,bus=pci.0,addr=0x4,drive=drive-virtio-disk0,id=virtio-disk0&lt;/font&gt;&lt;/div&gt;
 &lt;div&gt;&lt;font face="arial, sans-serif"&gt;&lt;br&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="arial, sans-serif"&gt; and my question is, this is command args \
could enable virtio? or there is some other XML format could let the \
if=virtio.&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font face="arial, sans-serif"&gt;&lt;br&gt;
&lt;/font&gt;&lt;span style="font-family:arial,sans-serif; font-size:13px; \
background-color:rgb(255,255,255)"&gt; &lt;div&gt;  Second when I boot the vm in the \
second step after use the kickstart install it. &lt;/div&gt; &lt;div&gt;Once in a while, it \
occurs an error that:&lt;/div&gt; &lt;div&gt;&lt;br&gt;
&lt;/div&gt;
&lt;div&gt;                  \
  monitor socket did not show up.: No such file or &gt;&lt;/div&gt; &lt;div&gt;  \
                  Traceback (most recent \
call last):&lt;/div&gt; &lt;div&gt;                  \
  File "/home/&lt;a href="http://lingjiao.lc/vmms/backserv/lib/virtmgr.py" \
target="_blank" style="color:rgb(0,0,204)"&gt;&lt;span \
style="background-color:rgb(255,255,136); color:rgb(34,34,34)"&gt;lingjiao&lt;/span&gt;.&lt;span \
style="background-color:rgb(255,255,136); \
color:rgb(34,34,34)"&gt;lc&lt;/span&gt;/vmms/backserv/bin/../lib/virtmgr.py&lt;/a&gt;",  line \
1007, in request_vm&lt;/div&gt; &lt;div&gt;              \
              dom.create()&lt;/div&gt; &lt;div&gt;  \
                  File \
"/usr/lib64/python2.6/site-packages/libvirt.py", line 325, in create&lt;/div&gt; \
&lt;div&gt;                    if ret == \
-1: raise libvirtError ('virDomainCreate() failed', dom=self)&lt;/div&gt; &lt;div&gt;  \
                  libvirtError: monitor \
socket did not show up.: No such file or directory&lt;/div&gt; &lt;div&gt;&lt;br&gt;
&lt;/div&gt;
&lt;div&gt;  But if I reinstall it, it will be ok.  If I install hundreds of VMs \
once, I think this is a headache.&lt;/div&gt; &lt;div&gt;&lt;br&gt;
&lt;/div&gt;
&lt;div&gt;&lt;br&gt;
&lt;/div&gt;
&lt;div&gt;   Could anybody help me, how can I disable the charmonitor or solve \
these problem.&lt;/div&gt; &lt;div&gt;&lt;br&gt;
&lt;/div&gt;
&lt;div&gt;Thanks.&lt;/div&gt;
&lt;/span&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;br&gt;
&lt;hr&gt;
&lt;font face="Arial" color="Gray" size="1"&gt;&lt;br&gt;
This email (including any attachments) is confidential and may be legally privileged. \
If you received this email in error, please delete it immediately and do not copy it \
or use it for any purpose or disclose its contents to any other person. Thank \
you.&lt;br&gt; &lt;br&gt;
���������(������������������)�������������������������������������������������������������������������������������������� \
���������������������������������������������������������������������������������������������������������������������&lt;br&gt;
 &lt;/font&gt;
&lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20111117213246</emailId><senderName>Sharad Mishra</senderName><senderEmail>snmishra@us.ibm.com</senderEmail><timestampReceived>2011-11-17 21:32:46-0400</timestampReceived><subject>[libvirt-users] Defined VM goes missing in multi-threaded environment.</subject><body>


In a multi-threaded environment where multiple threads are trying to get
list of all VMs on host, we have seen that at times this list is missing
couple of VMs. The code used is fairly simple, it makes three libvirt
calls.

1. Call virConnectNumOfDefinedDomains() to get number of defined domains.

2. Call virConnectNumOfDomains() to get a list of active domains.

3. If there are defined domains, then call virConnectListDefinedDomains
(conn, (char **)names, n_names), where n_names is the count returned from
#1.

The count returned from #3 is less than the one returned from #1.

I have bumped up the connection count in libvirtd.conf to 100, and using 20
threads. On average I get one missing defined VM every 5 runs of this test.

I have 25 running VMs and 8 defined VMs  on this host.

# rpm -aq | grep libvirt
libvirt-python-0.8.7-18.el6_1.1.x86_64
libvirt-0.8.7-18.el6_1.1.x86_64
libvirt-cim-0.5.14-1.el6.x86_64
libvirt-client-0.8.7-18.el6_1.1.x86_64

Its RHEL 6.1 running 2.6.32-131.17.1.el6.x86_64

Regards,
Sharad Mishra

</body></email><email><emailId>20111117221816</emailId><senderName>Ken Coar</senderName><senderEmail>kcoar@redhat.com</senderEmail><timestampReceived>2011-11-17 22:18:16-0400</timestampReceived><subject>Re: [libvirt-users] Ruby libvirt gem: state reasons</subject><body>

On 11/17/2011 05:15 PM, Mohammed Naser wrote:
&gt; Sent from my iPhone
&gt; 
&gt; On 2011-11-17, at 5:07 PM, Ken Coar &lt;kcoar@redhat.com&gt; wrote:
&gt; 
&gt;&gt; Does anyone know of a way to use the Ruby bindings to find out
&gt;&gt; the 'reason' value for the state of the VM?  Such as obtaining
&gt;&gt; VIR_DOMAIN_RUNNING_BOOTED for a running domain?
&gt; 
&gt; Don't have the API on hand but you can compare them by referencing the constants
&gt; 
&gt; Libvirt::Domain::RUNNING or so

I can get the current state from the Libvirt::Domain#state method,
yes.  What I'm looking for is the constant explaining *why/how* the
domain is in that state. :-(

It looks as though a) the Ruby bindings don't explicitly call that out,
and b) therefore there's no access method to the virDomainXXXReason
methods. :-(

Oh well..
-- 
#ken	B-)}

Ken Coar, Sanagendamgagwedweinini
IT Engineering Tower, Red Hat/RDU

"Millennium hand and shrimp!"

</body></email><email><emailId>20111128171613</emailId><senderName>KaBuTe</senderName><senderEmail>kabute@kabute.org</senderEmail><timestampReceived>2011-11-28 17:16:13-0400</timestampReceived><subject>[libvirt-users] VM Manager for Android</subject><body>

To whom it may concern,

I send this email to this list to report that I've released a small
application for Android that uses libvirt over SSH. It is still under
development and it has little features (Start/Destroy/Info) but I'll add
more soon.

You can check it here: https://market.android.com/details?id=vm.manager



------------------------------------
Diego Pérez

kabute@kabute.org

[Attachment #3 (text/html)]

To whom it may concern,&lt;div&gt;&lt;br&gt;&lt;div&gt;I send this email to this list to report that \
I've released a small application for Android that uses libvirt over SSH. It is \
still under development and it has little features (Start/Destroy/Info) but I'll \
add more soon.&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;You can check it here: &lt;a \
href="https://market.android.com/details?id=vm.manager"&gt;https://market.android.com/det \
ails?id=vm.manager&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;------------------------------------&lt;/div&gt;
 &lt;div&gt;Diego Pérez&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;a \
href="mailto:kabute@kabute.org"&gt;kabute@kabute.org&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20111128193223</emailId><senderName>Shaun Glass</senderName><senderEmail>shaunglass@gmail.com</senderEmail><timestampReceived>2011-11-28 19:32:23-0400</timestampReceived><subject>[libvirt-users] virt-manager / ssh (publickey)</subject><body>

Good day All,

I have experienced the following ...

I have a rhel 6.1 server running qemu-kvm. I have setup my desktop for
a publickey login (root user) to said server so that I may manage the
server (qemu-kvm) via the desktop with virt-manager.

However, I connect just fine, but cannot create vm's. I get :

"No hypervisor options where found for this connection"

My laptop does run qemu-kvm via virt-manager and so I decided to setup
a publickey login as before and guess what ... I can create vm's. It
seems virt-manager bases the creation of vm's based on the hardware /
software of the machine it is launched from and not the machine it is
connecting to.

Is there a workaround / config change etc that can be done so that
virt-manager uses the hardware / software configuration of the system
it is connecting to ?

Regards

Shaun Glass

</body></email><email><emailId>20111122154055</emailId><senderName>Nicolas Sebrecht</senderName><senderEmail>nsebrecht@piing.fr</senderEmail><timestampReceived>2011-11-22 15:40:55-0400</timestampReceived><subject>[libvirt-users]  Re: libvirt and linux-vserver</subject><body>

The 22/11/11, Daniel P. Berrange wrote:
&gt; On Tue, Nov 22, 2011 at 12:18:26PM +0100, Nicolas Sebrecht wrote:

&gt; There is in fact *not* an attempt by Red Hat to keep the Windows drivers
&gt; closed-source, but there are a couple of factors which might have
&gt; mistakenly given that impression.
&gt; 
&gt; The KVM wiki link to the GIT repository was outdated. The master GIT
&gt; repository now lives on GIT Hub:
&gt; 
&gt;   https://github.com/YanVugenfirer/kvm-guest-drivers-windows
&gt; 
&gt; I have updated the wiki accordingly:
&gt; 
&gt;   http://www.linux-kvm.org/page/WindowsGuestDrivers/Download_Drivers
&gt; 
&gt; 
&gt; For reasons I don't understand, the binary releases published to Fedora
&gt; download page are (unfortunately) using a different version numbering
&gt; scheme to the RHEL binaries. So while Fedora shows release 1.1.16, RHEL
&gt; will show 1.4. They both ultimately come from source in the same GIT
&gt; repo I mention above. The Fedora link is on the download page above
&gt; 
&gt; Finally, although the source code is GPL, the binary signed &amp; WHQL'd
&gt; drivers provided for RHEL are not under the GPL. This is due to license
&gt; restrictions of the MicroSoft WHQL certification process :-( This is
&gt; one of the reasons why we can't distribute the drivers in Fedora YUM
&gt; repos directly.

Alright. I'm surprised you've found alone all of the factors that gave
me this impression. Thank you for fixing and keeping the head up to this
issue.

-- 
Nicolas Sebrecht

</body></email><email><emailId>20111123122701</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-11-23 12:27:01-0400</timestampReceived><subject>Re: [libvirt-users] Difference between "Max Memory" and "Used Memory"</subject><body>


On 11/23/2011 01:48 AM, Jérôme Gallard wrote:
&gt; Hello,
&gt; 
&gt; I am new on this mailing list, so If I do something wrong, don't hesitate
&gt; to tell me :-)

Welcome to the community.

&gt; 
&gt; I am using the following version of libvirt :
&gt; Compiled against library: libvir 0.8.8
&gt; Using library: libvir 0.8.8
&gt; Using API: QEMU 0.8.8
&gt; Running hypervisor: QEMU 0.14.0
&gt; 
&gt; I would like to understand the difference between "Max Memory" and "Used
&gt; Memory" returned by a "virsh dominfo" command. In my configuration both
&gt; values are equal. This surprises me because my VM is not using all its
&gt; memory. Perhaps I miss something ?

"Max Memory" is the cap amount of memory reserved for the domain at
guest startup; qemu will not let the guest exceed this amount, but for
typical guests, it starts the guest with this much memory reserved (the
host's memory is used on-demand, though, so unless the guest actually
touches this much memory, the host does not necessarily give up this
much memory).

"Used Memory" refers to the amount of memory that the guest informs the
host that it is using.  This requires guest cooperation, via the 'virtio
memory balloon' device, so if the guest does not support this device,
qemu must treat it the same as "Max Memory".  On hosts that do support
memory ballooning (most Linux guests support it by default, and you can
install virtio drivers for Windows guests), then you can request that
the guest use less memory by way of the 'virsh setmem' command
(virDomainSetMemoryFlags API call), at which point libvirt issues a
command for the guest to use its memory balloon device in order to
reduce "Used Memory".

-- 
Eric Blake   eblake@redhat.com    +1-919-301-3266
Libvirt virtualization library http://libvirt.org


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20111125015611</emailId><senderName>xuteng</senderName><senderEmail>xuteng@szjhkx.com</senderEmail><timestampReceived>2011-11-25 01:56:11-0400</timestampReceived><subject>[libvirt-users] Failed to start a "virtual machine " service on RHCS in CentOS 6</subject><body>

[Attachment #2 (text/plain)]

Hi£¬ All:

I have two physical machines as KVM hosts (clusterA.RHCS and clusterB.RHCS) , an \
iscsi target set into GFS.  All I want is a HA Cluster which could migrate all the \
virtual machines on a node to another when the first node failed into some error \
status.

So I created a cluster "cluster" using RHCS ,added the two hosts into the cluster . \
created a fence device . for every virtual machine on clusterA , create a service \
,added a resouce which type is "virtual machine" , and set it's properties.

But when I start the service ,I got these errors in /var/log/message :

[root@clusterA ~]# tail -f /var/log/messages
Nov 24 16:19:29 clusterA libvirtd: Could not find keytab file: /etc/libvirt/krb5.tab: \
                Permission denied
Nov 24 16:19:30 clusterA modclusterd: startup succeeded
Nov 24 16:19:48 clusterA rgmanager[6754]: Executing /etc/init.d/httpd status
Nov 24 16:19:56 clusterA modcluster: Starting service: wuguang-xp on node 
Nov 24 16:19:56 clusterA rgmanager[2198]: Stopping service vm:wuguang-xp
Nov 24 16:19:56 clusterA rgmanager[6850]: Using /etc/libvirt/qemu/wuguang-xp.xml \
                instead of searching /etc/libvirt/qemu
Nov 24 16:19:56 clusterA rgmanager[6906]: xend/libvirtd is dead; cannot stop \
                wuguang-xp
Nov 24 16:19:56 clusterA rgmanager[2198]: stop on vm "wuguang-xp" returned 1 (generic \
                error)
Nov 24 16:19:56 clusterA rgmanager[2198]: Marking vm:wuguang-xp as 'disabled', but \
                some resources may still be allocated!
Nov 24 16:19:56 clusterA rgmanager[2198]: Service vm:wuguang-xp is disabled


But I set the libvirt tcp authority to "none" , here is my libvirtd.conf:


listen_tls = 0


listen_tcp = 1


tcp_port = "16509"


auth_tcp = "none"



my cluster.conf is :

&lt;?xml version="1.0"?&gt;
&lt;cluster config_version="83" name="cluster"&gt;
&lt;fence_daemon clean_start="0" post_fail_delay="0" post_join_delay="3"/&gt;
&lt;clusternodes&gt;
&lt;clusternode name="clusterA.RHCS" nodeid="1" votes="1"&gt;
&lt;fence&gt;
&lt;method name="fence1"&gt;
&lt;device name="fence1"/&gt;
&lt;/method&gt;
&lt;/fence&gt;
&lt;/clusternode&gt;
&lt;clusternode name="clusterB.RHCS" nodeid="2" votes="1"&gt;
&lt;fence&gt;
&lt;method name="fence2"&gt;
&lt;device name="fence2"/&gt;
&lt;/method&gt;
&lt;/fence&gt;
&lt;/clusternode&gt;
&lt;/clusternodes&gt;
&lt;cman expected_votes="1" two_node="1"/&gt;
&lt;fencedevices&gt;
&lt;fencedevice agent="fence_scsi" name="fence1" nodename="clusterA.RHCS"/&gt;
&lt;fencedevice agent="fence_scsi" name="fence2" nodename="clusterB.RHCS"/&gt;
&lt;/fencedevices&gt;
&lt;rm&gt;
&lt;failoverdomains&gt;
&lt;failoverdomain name="FD" nofailback="0" ordered="1" restricted="1"&gt;
&lt;failoverdomainnode name="clusterA.RHCS" priority="1"/&gt;
&lt;failoverdomainnode name="clusterB.RHCS" priority="2"/&gt;
&lt;/failoverdomain&gt;
&lt;/failoverdomains&gt;
&lt;resources&gt;
&lt;ip address="192.168.6.250/24" monitor_link="on" sleeptime="10"/&gt;
&lt;script file="/etc/init.d/httpd" name="www_script"/&gt;
&lt;clusterfs device="/dev/dm-0" force_unmount="on" fsid="56449" fstype="gfs2" \
mountpoint="/var/lib/libvirt/images/iscsi" name="gfs2" self_fence="on"/&gt; &lt;/resources&gt;
&lt;service autostart="1" domain="FD" exclusive="0" name="www_service" \
recovery="relocate"&gt; &lt;ip ref="192.168.6.250/24"/&gt;
&lt;script ref="www_script"/&gt;
&lt;clusterfs ref="gfs2"/&gt;
&lt;/service&gt;
&lt;vm autostart="1" domain="FD" exclusive="0" migrate="live" name="wuguang-xp" \
path="/etc/libvirt/qemu" recovery="relocate" \
xmlfile="/etc/libvirt/qemu/wuguang-xp.xml"/&gt; &lt;/rm&gt;
&lt;/cluster&gt;

What's wrong with my configuration of RHCS or libvirt?
Thanks in advance

wade




xuteng via foxmail


[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;
&lt;HTML&gt;&lt;HEAD&gt;
&lt;META http-equiv=Content-Type content="text/html; charset=gb2312"&gt;
&lt;STYLE&gt;
BLOCKQUOTE {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; MARGIN-LEFT: 2em
}
OL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
UL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
P {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
BODY {
	FONT-SIZE: 10.5pt; COLOR: #000000; LINE-HEIGHT: 1.5; FONT-FAMILY: ËÎÌå
}
&lt;/STYLE&gt;

&lt;META content="MSHTML 6.00.2900.6148" name=GENERATOR&gt;&lt;/HEAD&gt;
&lt;BODY style="MARGIN: 10px"&gt;
&lt;DIV&gt;&lt;SPAN class=Apple-style-span 
style="WORD-SPACING: 0px; FONT: 12px Verdana, Arial, Helvetica, sans-serif; \
TEXT-TRANSFORM: none; COLOR: rgb(70,70,70); TEXT-INDENT: 0px; WHITE-SPACE: normal; \
LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(250,250,250); orphans: 2; widows: 2; \
webkit-text-decorations-in-effect: none; webkit-text-size-adjust: auto; \
webkit-text-stroke-width: 0px"&gt;Hi£¬  All:&lt;BR&gt;&lt;BR&gt;I have two physical machines as KVM \
hosts (clusterA.RHCS and  clusterB.RHCS) , an iscsi target set into GFS.&lt;SPAN 
class=Apple-converted-space&gt; &lt;/SPAN&gt;&lt;BR&gt;All I want is a HA Cluster which 
could migrate all the virtual machines on a node to another when the first node 
failed into some error status.&lt;BR&gt;&lt;BR&gt;So I created a cluster "cluster" using 
RHCS ,added the two hosts into the cluster . created a fence device .&lt;BR&gt;for 
every virtual machine on clusterA , create a service ,added a resouce which type 
is "virtual machine" , and set it's properties.&lt;BR&gt;&lt;BR&gt;But when I start the 
service ,I got these errors in /var/log/message :&lt;BR&gt;&lt;BR&gt;[&lt;A 
style="FONT-WEIGHT: bold; COLOR: rgb(153,0,153); BACKGROUND-COLOR: transparent; \
TEXT-DECORATION: none"  href="mailto:root@clusterA"&gt;root@clusterA&lt;/A&gt;&lt;SPAN 
class=Apple-converted-space&gt; &lt;/SPAN&gt;~]# tail -f /var/log/messages&lt;BR&gt;Nov 24 
16:19:29 clusterA libvirtd: Could not find keytab file: /etc/libvirt/krb5.tab: 
Permission denied&lt;BR&gt;Nov 24 16:19:30 clusterA modclusterd: startup 
succeeded&lt;BR&gt;Nov 24 16:19:48 clusterA rgmanager[6754]: Executing 
/etc/init.d/httpd status&lt;BR&gt;Nov 24 16:19:56 clusterA modcluster: Starting 
service: wuguang-xp on node&lt;SPAN 
class=Apple-converted-space&gt; &lt;/SPAN&gt;&lt;BR&gt;Nov 24 16:19:56 clusterA 
rgmanager[2198]: Stopping service vm:wuguang-xp&lt;BR&gt;Nov 24 16:19:56 clusterA 
rgmanager[6850]: Using /etc/libvirt/qemu/wuguang-xp.xml instead of searching 
/etc/libvirt/qemu&lt;BR&gt;Nov 24 16:19:56 clusterA rgmanager[6906]: xend/libvirtd is 
dead; cannot stop wuguang-xp&lt;BR&gt;Nov 24 16:19:56 clusterA rgmanager[2198]: stop 
on vm "wuguang-xp" returned 1 (generic error)&lt;BR&gt;Nov 24 16:19:56 clusterA 
rgmanager[2198]: Marking vm:wuguang-xp as 'disabled', but some resources may 
still be allocated!&lt;BR&gt;Nov 24 16:19:56 clusterA rgmanager[2198]: Service 
vm:wuguang-xp is disabled&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;But I set the libvirt tcp authority to 
"none" , here is my libvirtd.conf:&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;listen_tls = 
0&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;listen_tcp = 1&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;tcp_port = "16509"&lt;BR&gt;&lt;/SPAN&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;SPAN class=Apple-style-span 
style="WORD-SPACING: 0px; FONT: 12px Verdana, Arial, Helvetica, sans-serif; \
TEXT-TRANSFORM: none; COLOR: rgb(70,70,70); TEXT-INDENT: 0px; WHITE-SPACE: normal; \
LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(250,250,250); orphans: 2; widows: 2; \
webkit-text-decorations-in-effect: none; webkit-text-size-adjust: auto; \
webkit-text-stroke-width: 0px"&gt;&lt;/SPAN&gt; &lt;/DIV&gt; &lt;DIV&gt;&lt;SPAN class=Apple-style-span 
style="WORD-SPACING: 0px; FONT: 12px Verdana, Arial, Helvetica, sans-serif; \
TEXT-TRANSFORM: none; COLOR: rgb(70,70,70); TEXT-INDENT: 0px; WHITE-SPACE: normal; \
LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(250,250,250); orphans: 2; widows: 2; \
webkit-text-decorations-in-effect: none; webkit-text-size-adjust: auto; \
webkit-text-stroke-width: 0px"&gt;auth_tcp  = "none"&lt;/DIV&gt;
&lt;DIV&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;my cluster.conf is :&lt;BR&gt;&lt;BR&gt;&lt;?xml 
version="1.0"?&gt;&lt;BR&gt;&lt;cluster config_version="83" 
name="cluster"&gt;&lt;BR&gt;&lt;fence_daemon clean_start="0" post_fail_delay="0" 
post_join_delay="3"/&gt;&lt;BR&gt;&lt;clusternodes&gt;&lt;BR&gt;&lt;clusternode 
name="clusterA.RHCS" nodeid="1" votes="1"&gt;&lt;BR&gt;&lt;fence&gt;&lt;BR&gt;&lt;method 
name="fence1"&gt;&lt;BR&gt;&lt;device 
name="fence1"/&gt;&lt;BR&gt;&lt;/method&gt;&lt;BR&gt;&lt;/fence&gt;&lt;BR&gt;&lt;/clusternode&gt;&lt;BR&gt;&lt;clusternode \
 name="clusterB.RHCS" nodeid="2" votes="1"&gt;&lt;BR&gt;&lt;fence&gt;&lt;BR&gt;&lt;method 
name="fence2"&gt;&lt;BR&gt;&lt;device 
name="fence2"/&gt;&lt;BR&gt;&lt;/method&gt;&lt;BR&gt;&lt;/fence&gt;&lt;BR&gt;&lt;/clusternode&gt;&lt;BR&gt;&lt;/clusternodes&gt;&lt;BR&gt;&lt;cman \
 expected_votes="1" two_node="1"/&gt;&lt;BR&gt;&lt;fencedevices&gt;&lt;BR&gt;&lt;fencedevice 
agent="fence_scsi" name="fence1" 
nodename="clusterA.RHCS"/&gt;&lt;BR&gt;&lt;fencedevice agent="fence_scsi" 
name="fence2" 
nodename="clusterB.RHCS"/&gt;&lt;BR&gt;&lt;/fencedevices&gt;&lt;BR&gt;&lt;rm&gt;&lt;BR&gt;&lt;failoverdomains&gt;&lt;BR&gt;&lt;failoverdomain \
 name="FD" nofailback="0" ordered="1" 
restricted="1"&gt;&lt;BR&gt;&lt;failoverdomainnode name="clusterA.RHCS" 
priority="1"/&gt;&lt;BR&gt;&lt;failoverdomainnode name="clusterB.RHCS" 
priority="2"/&gt;&lt;BR&gt;&lt;/failoverdomain&gt;&lt;BR&gt;&lt;/failoverdomains&gt;&lt;BR&gt;&lt;resources&gt;&lt;BR&gt;&lt;ip \
 address="192.168.6.250/24" monitor_link="on" sleeptime="10"/&gt;&lt;BR&gt;&lt;script 
file="/etc/init.d/httpd" name="www_script"/&gt;&lt;BR&gt;&lt;clusterfs 
device="/dev/dm-0" force_unmount="on" fsid="56449" fstype="gfs2" 
mountpoint="/var/lib/libvirt/images/iscsi" name="gfs2" 
self_fence="on"/&gt;&lt;BR&gt;&lt;/resources&gt;&lt;BR&gt;&lt;service autostart="1" 
domain="FD" exclusive="0" name="www_service" recovery="relocate"&gt;&lt;BR&gt;&lt;ip 
ref="192.168.6.250/24"/&gt;&lt;BR&gt;&lt;script ref="www_script"/&gt;&lt;BR&gt;&lt;clusterfs 
ref="gfs2"/&gt;&lt;BR&gt;&lt;/service&gt;&lt;BR&gt;&lt;vm autostart="1" domain="FD" 
exclusive="0" migrate="live" name="wuguang-xp" path="/etc/libvirt/qemu" 
recovery="relocate" 
xmlfile="/etc/libvirt/qemu/wuguang-xp.xml"/&gt;&lt;BR&gt;&lt;/rm&gt;&lt;BR&gt;&lt;/cluster&gt;&lt;BR&gt;&lt;BR&gt;What's \
 wrong with my configuration of RHCS or libvirt?&lt;BR&gt;Thanks in advance&lt;/DIV&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;wade&lt;/SPAN&gt;&lt;/DIV&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;HR style="WIDTH: 210px; HEIGHT: 1px" align=left color=#b5c4df SIZE=1&gt;

&lt;DIV&gt;&lt;SPAN&gt;xuteng&lt;SPAN 
style="FONT-SIZE: 10.5pt; COLOR: #969696; FONT-STYLE: italic; FONT-FAMILY: Microsoft \
Sans Serif"&gt;  via foxmail&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/DIV&gt;&lt;/BODY&gt;&lt;/HTML&gt;



</body></email><email><emailId>20111128175052</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-11-28 17:50:52-0400</timestampReceived><subject>Re: [libvirt-users] VM Manager for Android</subject><body>


On 11/28/2011 10:16 AM, KaBuTe wrote:
&gt; To whom it may concern,
&gt; 
&gt; I send this email to this list to report that I've released a small
&gt; application for Android that uses libvirt over SSH. It is still under
&gt; development and it has little features (Start/Destroy/Info) but I'll add
&gt; more soon.
&gt; 
&gt; You can check it here: https://market.android.com/details?id=vm.manager

Thanks for the information.  Would you like to turn this into a patch
against the files under libvirt.git/docs, which in turn feed our web
page, so that this can be listed in an appropriate location under this page?

http://libvirt.org/apps.html

-- 
Eric Blake   eblake@redhat.com    +1-919-301-3266
Libvirt virtualization library http://libvirt.org


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20111129033518</emailId><senderName>Trey Dockendorf</senderName><senderEmail>treydock@gmail.com</senderEmail><timestampReceived>2011-11-29 03:35:18-0400</timestampReceived><subject>Re: [libvirt-users] virt-manager / ssh (publickey)</subject><body>

Whats the connection string your using?

Also Id recommend not using root and giving a normal user account full
libvirt control via policykit.  I have an example here,
http://itscblog.tamu.edu/startup-guide-for-kvm-on-centos-6/ .

- Trey
On Nov 28, 2011 1:34 PM, "Shaun Glass" &lt;shaunglass@gmail.com&gt; wrote:

&gt; Good day All,
&gt;
&gt; I have experienced the following ...
&gt;
&gt; I have a rhel 6.1 server running qemu-kvm. I have setup my desktop for
&gt; a publickey login (root user) to said server so that I may manage the
&gt; server (qemu-kvm) via the desktop with virt-manager.
&gt;
&gt; However, I connect just fine, but cannot create vm's. I get :
&gt;
&gt; "No hypervisor options where found for this connection"
&gt;
&gt; My laptop does run qemu-kvm via virt-manager and so I decided to setup
&gt; a publickey login as before and guess what ... I can create vm's. It
&gt; seems virt-manager bases the creation of vm's based on the hardware /
&gt; software of the machine it is launched from and not the machine it is
&gt; connecting to.
&gt;
&gt; Is there a workaround / config change etc that can be done so that
&gt; virt-manager uses the hardware / software configuration of the system
&gt; it is connecting to ?
&gt;
&gt; Regards
&gt;
&gt; Shaun Glass
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

[Attachment #3 (text/html)]

&lt;p&gt;Whats the connection string your using?&lt;/p&gt;
&lt;p&gt;Also Id recommend not using root and giving a normal user account full libvirt \
control via policykit.  I have an example here, &lt;a \
href="http://itscblog.tamu.edu/startup-guide-for-kvm-on-centos-6/"&gt;http://itscblog.tamu.edu/startup-guide-for-kvm-on-centos-6/&lt;/a&gt; \
.&lt;/p&gt;

&lt;p&gt;- Trey&lt;/p&gt;
&lt;div class="gmail_quote"&gt;On Nov 28, 2011 1:34 PM, "Shaun Glass" &lt;&lt;a \
href="mailto:shaunglass@gmail.com" target="_blank"&gt;shaunglass@gmail.com&lt;/a&gt;&gt; \
wrote:&lt;br type="attribution"&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 \
.8ex;border-left:1px #ccc solid;padding-left:1ex"&gt;

Good day All,&lt;br&gt;
&lt;br&gt;
I have experienced the following ...&lt;br&gt;
&lt;br&gt;
I have a rhel 6.1 server running qemu-kvm. I have setup my desktop for&lt;br&gt;
a publickey login (root user) to said server so that I may manage the&lt;br&gt;
server (qemu-kvm) via the desktop with virt-manager.&lt;br&gt;
&lt;br&gt;
However, I connect just fine, but cannot create vm's. I get :&lt;br&gt;
&lt;br&gt;
"No hypervisor options where found for this connection"&lt;br&gt;
&lt;br&gt;
My laptop does run qemu-kvm via virt-manager and so I decided to setup&lt;br&gt;
a publickey login as before and guess what ... I can create vm's. It&lt;br&gt;
seems virt-manager bases the creation of vm's based on the hardware /&lt;br&gt;
software of the machine it is launched from and not the machine it is&lt;br&gt;
connecting to.&lt;br&gt;
&lt;br&gt;
Is there a workaround / config change etc that can be done so that&lt;br&gt;
virt-manager uses the hardware / software configuration of the system&lt;br&gt;
it is connecting to ?&lt;br&gt;
&lt;br&gt;
Regards&lt;br&gt;
&lt;br&gt;
Shaun Glass&lt;br&gt;
&lt;br&gt;
_______________________________________________&lt;br&gt;
libvirt-users mailing list&lt;br&gt;
&lt;a href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt; &lt;a \
href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; \
&lt;/blockquote&gt;&lt;/div&gt;



</body></email><email><emailId>20111129061544</emailId><senderName>Shaun Glass</senderName><senderEmail>shaunglass@gmail.com</senderEmail><timestampReceived>2011-11-29 06:15:44-0400</timestampReceived><subject>[libvirt-users] Fwd:  virt-manager / ssh (publickey)</subject><body>

Heya,

I will setup for a regular user, but as for connection, as follows :

I opened virt-manager, defined a new connection :

Hypervisor : QEMU/KVM

* Connect to remote host

Method : SSH

Username : root

Hostname : 192.168.1.201

Generated URI : qemu+ssh://root@192.168.1.201/system

Cheers



---------- Forwarded message ----------
From: Trey Dockendorf &lt;treydock@gmail.com&gt;
Date: Tue, Nov 29, 2011 at 5:35 AM
Subject: Re: [libvirt-users] virt-manager / ssh (publickey)
To: Shaun Glass &lt;shaunglass@gmail.com&gt;
Cc: libvirt-users@redhat.com


Whats the connection string your using?

Also Id recommend not using root and giving a normal user account full
libvirt control via policykit.  I have an example here,
http://itscblog.tamu.edu/startup-guide-for-kvm-on-centos-6/ .

- Trey

On Nov 28, 2011 1:34 PM, "Shaun Glass" &lt;shaunglass@gmail.com&gt; wrote:
&gt;
&gt; Good day All,
&gt;
&gt; I have experienced the following ...
&gt;
&gt; I have a rhel 6.1 server running qemu-kvm. I have setup my desktop for
&gt; a publickey login (root user) to said server so that I may manage the
&gt; server (qemu-kvm) via the desktop with virt-manager.
&gt;
&gt; However, I connect just fine, but cannot create vm's. I get :
&gt;
&gt; "No hypervisor options where found for this connection"
&gt;
&gt; My laptop does run qemu-kvm via virt-manager and so I decided to setup
&gt; a publickey login as before and guess what ... I can create vm's. It
&gt; seems virt-manager bases the creation of vm's based on the hardware /
&gt; software of the machine it is launched from and not the machine it is
&gt; connecting to.
&gt;
&gt; Is there a workaround / config change etc that can be done so that
&gt; virt-manager uses the hardware / software configuration of the system
&gt; it is connecting to ?
&gt;
&gt; Regards
&gt;
&gt; Shaun Glass
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20111129182844</emailId><senderName></senderName><senderEmail>mail278151237@gmail.com</senderEmail><timestampReceived>2011-11-29 18:28:44-0400</timestampReceived><subject>[libvirt-users] permission denied when setting up VMchannel with libvirt</subject><body>

Hi,
 I am trying to set up vmchannel between the host and guest os.

 However, "sudo virsh start vm1" always gave me this error:
 *************************************************************
 error: Failed to start domain vm1
 error: internal error Process exited while reading console log output: char
 device redirected to /dev/pts/5
 bind(unix:/tmp/foo): Permission denied
 chardev: opening backend "socket" failed
 *************************************************************

 Related xml is:
 *************************************************************
 &lt;channel type='unix'&gt;
   &lt;source mode='bind' path='/tmp/foo'/&gt;
   &lt;target type='virtio' name='channel.port.0'/&gt;
   &lt;address type='virtio-serial' controller='0' bus='0' port='1'/&gt;
 &lt;/channel&gt;
 *************************************************************

 I can succeed while I manually run the guest os by:
 *************************************************************
 sudo kvm -device virtio-serial \
 -chardev socket,path=/tmp/foo,server,nowait,id=foo \
 -device virtserialport,chardev=foo,name=org.fedoraproject.port.0\
 /path/to/vm1.img
 *************************************************************

 I also noticed that libvirt is able to create socke
 /var/lib/libvirt/qemu/vm1.monitor every time. I can't win even I change
the unix
 socket path to "/var/lib/libvirt/qemu/foo"


 Any information will be appreciated!

Thanks,
Will

[Attachment #3 (text/html)]

&lt;span class="Apple-style-span" style="font-family: arial, sans-serif; font-size: \
13px; border-collapse: collapse; "&gt; Hi,&lt;br&gt; I am trying to set up vmchannel between \
the host and guest os.&lt;br&gt;&lt;br&gt; However, "sudo virsh start vm1" always gave \
                me this error:&lt;br&gt;
 *************************************************************&lt;br&gt; error: Failed to \
start domain vm1&lt;br&gt; error: internal error Process exited while reading console log \
output: char&lt;br&gt; device redirected to /dev/pts/5&lt;br&gt; bind(unix:/tmp/foo): Permission \
denied&lt;br&gt;  chardev: opening backend "socket" failed&lt;br&gt; \
*************************************************************&lt;br&gt;&lt;br&gt; Related xml \
is:&lt;br&gt; *************************************************************&lt;br&gt; &lt;channel \
type='unix'&gt;&lt;br&gt;  &lt;source mode='bind' \
path='/tmp/foo'/&gt;&lt;br&gt;   &lt;target type='virtio' \
name='channel.port.0'/&gt;&lt;br&gt;   &lt;address type='virtio-serial' \
controller='0' bus='0' port='1'/&gt;&lt;br&gt;  \
&lt;/channel&gt;&lt;br&gt; \
*************************************************************&lt;br&gt;&lt;br&gt; I can succeed \
while I manually run the guest os by:&lt;br&gt; \
*************************************************************&lt;br&gt; sudo kvm -device \
                virtio-serial \&lt;br&gt;
 -chardev socket,path=/tmp/foo,server,nowait,id=foo \&lt;br&gt; -device \
virtserialport,chardev=foo,name=org.fedoraproject.port.0\&lt;br&gt; /path/to/vm1.img&lt;br&gt; \
*************************************************************&lt;br&gt;&lt;br&gt; I also noticed \
that libvirt is able to create socke&lt;br&gt;  /var/lib/libvirt/qemu/vm1.monitor every \
time. I can't win even I change the unix&lt;br&gt; socket path to \
"/var/lib/libvirt/qemu/foo"&lt;br&gt;&lt;br&gt;&lt;br&gt; Any information will be \
appreciated!&lt;/span&gt; &lt;div&gt;&lt;span class="Apple-style-span" style="font-family: arial, \
sans-serif; font-size: 13px; border-collapse: collapse; "&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
class="Apple-style-span" face="arial, sans-serif"&gt;&lt;span class="Apple-style-span" \
style="border-collapse: collapse;"&gt;Thanks,&lt;/span&gt;&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font \
class="Apple-style-span" face="arial, sans-serif"&gt;&lt;span class="Apple-style-span" \
style="border-collapse: collapse;"&gt;Will&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;



</body></email><email><emailId>20111130102631</emailId><senderName>Upendra Moturi</senderName><senderEmail>upendra.m@hexagrid.com</senderEmail><timestampReceived>2011-11-30 10:26:31-0400</timestampReceived><subject>[libvirt-users] need help with sanlock plugin</subject><body>

Hi

I am working with libvirt on ubuntu.
I would like have sanlock feature with ubuntu.

Can you please guide me on how to.

-- 
Thanks and Regards,
Upendra.M

*As a leading developer of IT infrastructure software solutions, Hexagrid
developed the first cloud
computing&lt;http://www.hexagrid.com/d/vxdatacenter.html&gt;platform that
directly aligns with the real-world IT delivery models of
both solution providers and enterprises. Hexagrid provides all the software
and support that IT organizations need to successfully build public,
private, or hybrid clouds that fit their specific business and end-user
requirements. Hexagrid cloud solutions truly simplify and expedite virtual
IT management, empowering successful cloud computing strategies that
quickly increase profits by pooling resources, delivering control, and
building value. Our Software, Your Cloud.  For more information, visit
www.hexagrid.com and follow @Hexagrid on Twitter*

[Attachment #3 (text/html)]

Hi&lt;br&gt;&lt;br&gt;I am working with libvirt on ubuntu.&lt;br&gt;I would like have sanlock feature \
with ubuntu.&lt;br&gt;&lt;br clear="all"&gt;Can you please guide me on how to.&lt;br \
clear="all"&gt;&lt;br&gt;-- &lt;br&gt;Thanks and Regards,&lt;br&gt;Upendra.M&lt;br&gt;&lt;br&gt;&lt;font \
size="2"&gt;&lt;i&gt;&lt;span style="line-height: 115%; font-style: normal; color: black;"&gt;&lt;span \
style="line-height: 115%; font-style: normal; color: black;"&gt;&lt;font \
face="arial,helvetica,sans-serif"&gt;&lt;font color="#666666"&gt;&lt;i&gt;&lt;span style="line-height: \
115%;"&gt;As a leading developer of IT infrastructure software solutions, Hexagrid \
developed the first &lt;/span&gt;&lt;span style="line-height: 115%;"&gt;&lt;a \
href="http://www.hexagrid.com/d/vxdatacenter.html" target="_blank"&gt;&lt;span&gt;cloud \
computing&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;span style="line-height: 115%;"&gt; platform that directly \
aligns with the real-world IT delivery models of both solution providers and \
enterprises. Hexagrid provides all the software and support that IT organizations \
need to successfully build public, private, or hybrid clouds that fit their specific \
business and end-user requirements. Hexagrid cloud solutions truly simplify and
expedite virtual IT management, empowering successful cloud computing
strategies that quickly increase profits by pooling resources,
delivering control, and building value. &lt;b&gt;Our Software, Your Cloud.&lt;/b&gt;&lt;span&gt;  \
&lt;/span&gt;For more information, visit &lt;/span&gt;&lt;span style="line-height: 115%;"&gt;&lt;a \
href="http://www.hexagrid.com/" \
target="_blank"&gt;&lt;span&gt;www.hexagrid.com&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;span style="line-height: \
115%;"&gt; and follow @Hexagrid on \
Twitter&lt;/span&gt;&lt;/i&gt;&lt;/font&gt;&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/i&gt;&lt;/font&gt;&lt;br&gt;


&lt;br&gt;



</body></email><email><emailId>20111130151044</emailId><senderName>"Li, David"</senderName><senderEmail>lid@cloudshield.com</senderEmail><timestampReceived>2011-11-30 15:10:44-0400</timestampReceived><subject>[libvirt-users] How to use virt-install and http to install openbsd VM in KVM?</subject><body>

Hi,

Not quite sure if this is the right forum for this question.

My requirement is to http boot openbsd in KVM.  This works fine with RHEL6 guest \
install but not with OpenBSD. 

I loop mounted the openbsd installer on the http server. My Http server directory \
looks like:


[root@uefiserver vm-openbsd]# ll
total 5
drwxr-xr-x 3 root kmem 2048 Aug 17 09:35 5.0
drwxr-xr-x 2 root kmem 2048 Aug 17 09:35 etc
-r--r--r-- 1 root root   82 Aug 17 09:35 TRANS.TBL

My browser can see this directory no problem.

And KVM output:


[root@lid-hs22-2 ~]# virt-install --hvm --connect qemu:///system --network=bridge:br0 \
--location=http://10.10.36.134/vm-openbsd/ --name=vm5-openbsd --ram=2048 --vcpus=2 \
--os-type=unix  --file=/var/lib/libvirt/images/vm5-openbsd.img --file-size=20 ERROR   \
Error creating cdrom disk: Could not find an installable distribution at \
'http://10.10.36.134/vm-openbsd/' The location must be the root directory of an \
install tree. [root@lid-hs22-2 ~]# 

IS this supported? Did I use the right semantics?

Thanks.
        

- David


</body></email><email><emailId>20111021022527</emailId><senderName>Luengffy XUE</senderName><senderEmail>feiliangxue@gmail.com</senderEmail><timestampReceived>2011-10-21 02:25:27-0400</timestampReceived><subject>[libvirt-users] Libvirt Live Migrat error</subject><body>

[Attachment #2 (multipart/alternative)]


 Dear ,
Today=A3=AC i use the libvirt-manager to migrate the live VM . Problem come=
s ad
the picture.
How did it happen?
Please help me.
Thanks very much.
Leungffy XUE

[Attachment #5 (text/html)]

&lt;div class="gmail_quote"&gt;
&lt;div&gt;Dear ,&lt;/div&gt;
&lt;div&gt;Today£¬ i use the libvirt-manager to migrate the live VM . Problem \
comes ad the picture.&lt;/div&gt; &lt;div&gt;How did it happen?&lt;/div&gt;
&lt;div&gt;Please help me.&lt;/div&gt;
&lt;div&gt;Thanks very much.&lt;/div&gt;
&lt;div&gt;Leungffy XUE&lt;/div&gt;&lt;/div&gt;&lt;br&gt;

--bcaec51ba05551b5a804afc5c928--


["=?GB2312?B?zrTD/MP7LmpwZw==?=" (image/jpeg)]

</body></email><email><emailId>20111022095339</emailId><senderName>vmnode guy</senderName><senderEmail>vmnodeguy@gmail.com</senderEmail><timestampReceived>2011-10-22 09:53:39-0400</timestampReceived><subject>[libvirt-users] virt-install with set vnc password</subject><body>

Hi Guy,

Anyone know how we can set up the vnc password during using virt-install
command ?

         # virt-install \
              --connect qemu:///system \
              --name demo \
              --ram 500 \
              --disk path=/var/lib/libvirt/images/demo.img,size=5 \
              --network network=default,model=virtio \
              --vnc \
              --cdrom /dev/cdrom


Regards,
Peter

[Attachment #3 (text/html)]

&lt;div&gt;Hi Guy,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Anyone know how we can set up the vnc password \
during using virt-install command ?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;         # \
virt-install \&lt;/div&gt;&lt;div&gt;              --connect qemu:///system \&lt;/div&gt;

&lt;div&gt;              --name demo \&lt;/div&gt;&lt;div&gt;              --ram 500 \&lt;/div&gt;&lt;div&gt;       \
--disk path=/var/lib/libvirt/images/demo.img,size=5 \&lt;/div&gt;&lt;div&gt;              \
--network network=default,model=virtio \&lt;/div&gt;&lt;div&gt;

              --vnc \&lt;/div&gt;&lt;div&gt;              --cdrom \
/dev/cdrom&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;Peter&lt;/div&gt;




</body></email><email><emailId>20111021093205</emailId><senderName>vmnode guy</senderName><senderEmail>vmnodeguy@gmail.com</senderEmail><timestampReceived>2011-10-21 09:32:05-0400</timestampReceived><subject>[libvirt-users] virsh modified option... alternative..</subject><body>

Hi All,

I am new to libvirt, i wander how we can achieve below objective, i
read through a lot from libvirt.org but couldn't found any thing solid
something equivalent to this:-


  virsh dumpxml dom &gt; /tmp/dom.xml

  $EDITOR /tmp/dom.xml &amp;&amp; virsh define /tmp/dom.xml

What i try to achieve is to have one management server that install
with libvirt in place then we can use libvirt to connect to other
libvirt box to provision the vm-create, vm-delete &amp; capable to
vm-modified the CPU,MEM,HDD,boot sequence, vnc password attached &amp;
detech network card..on the targeted VM.

Currently we do it through editing the xml file which was a bit pain to do so..

Regards,

Peter

[Attachment #3 (text/html)]

&lt;meta http-equiv="content-type" content="text/html; charset=utf-8"&gt;&lt;pre \
style="font-family: 'Times New Roman'; font-size: medium; "&gt;Hi \
All,&lt;/pre&gt;&lt;pre&gt;&lt;font class="Apple-style-span" face="'Times New Roman'" \
size="3"&gt;I am new to libvirt, i wander how we can achieve below objective, i read \
through a lot from &lt;a href="http://libvirt.org"&gt;libvirt.org&lt;/a&gt; but couldn't \
&lt;/font&gt;&lt;font class="Apple-style-span" face="'Times New Roman'" size="3"&gt;found \
any thing solid something &lt;/font&gt;&lt;span class="Apple-style-span" style="font-family: \
'Times New Roman'; font-size: medium; "&gt;equivalent to this:-&lt;/span&gt;&lt;/pre&gt; \
&lt;pre&gt;&lt;span class="Apple-style-span" style="font-family: 'Times New Roman'; \
font-size: medium; "&gt;&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;&lt;pre&gt;&lt;span class="Apple-style-span" \
style="font-family: 'Times New Roman'; font-size: medium; "&gt;  virsh dumpxml \
dom &gt; /tmp/dom.xml&lt;/span&gt;&lt;/pre&gt; &lt;pre style="font-family: 'Times New \
Roman'; font-size: medium; "&gt;  $EDITOR /tmp/dom.xml &amp;&amp; virsh define \
/tmp/dom.xml &lt;br&gt;&lt;/pre&gt;&lt;pre style="font-family: 'Times New Roman'; font-size: \
medium; "&gt;What i try to achieve is to have one management server that install with \
libvirt in place then we can use libvirt to connect to other libvirt box to provision \
the vm-create, vm-delete &amp; capable to vm-modified the CPU,MEM,HDD,boot sequence, \
vnc password attached &amp; detech network card..on the targeted VM.&lt;/pre&gt; &lt;pre \
style="font-family: 'Times New Roman'; font-size: medium; "&gt;Currently we do \
it through editing the xml file which was a bit pain to do so..&lt;/pre&gt;&lt;pre \
style="font-family: 'Times New Roman'; font-size: medium; "&gt; \
Regards,&lt;/pre&gt;&lt;pre style="font-family: 'Times New Roman'; font-size: medium; \
"&gt;Peter&lt;/pre&gt;



</body></email><email><emailId>20111021203125</emailId><senderName>Face</senderName><senderEmail>falazemi@gmail.com</senderEmail><timestampReceived>2011-10-21 20:31:25-0400</timestampReceived><subject>[libvirt-users] high-privileges</subject><body>

hello all,

my vm (windows server 2008) keep crashing?


2011-09-21 15:00:45.924: 1355: info : libvirt version: 0.9.6
2011-09-21 15:00:45.924: 1355: error : virSysinfoRead:465 : internal
error Failed to find path for dmidecode binary
2011-09-21 15:05:43.873: 1349: warning : qemuDomainObjTaint:1128 :
Domain id=1 name='IIS' uuid=a02e41a9-9f4d-d94f-43a6-995b1ca6d37d is
tainted: high-privileges
2011-09-21 16:07:10.593: 1344: error : qemuMonitorIO:541 : internal
error End of file from monitor


Any help would be much appreciated.

-- 
Sincerely,
falazemi

</body></email><email><emailId>20111022223600</emailId><senderName>Stefano Facchini</senderName><senderEmail>stefano.facchini@gmail.com</senderEmail><timestampReceived>2011-10-22 22:36:00-0400</timestampReceived><subject>[libvirt-users] VirtualBox 4.1 support</subject><body>

Is version 4.1 (and later) of VirtualBox supported by libvirt?

-- 
Stefano Facchini &lt;stefano.facchini@gmail.com&gt;

</body></email><email><emailId>20111024051713</emailId><senderName>Jatin Kumar</senderName><senderEmail>cs5090243@cse.iitd.ernet.in</senderEmail><timestampReceived>2011-10-24 05:17:13-0400</timestampReceived><subject>[libvirt-users] Unable to acquire lock</subject><body>

Hello,
I am trying to execute virsh commands on a host but it is giving errors
due to failure in acquiring lock.

root@kvm01:~# virsh suspend blindone
error: Failed to suspend domain blindone
error: Timed out during operation: cannot acquire state change lock

Any suggestions how can we figure out possible reasons.

--
Jatin

[Attachment #3 (text/html)]

Hello,&lt;br&gt;I am trying to execute virsh commands on a host but it is giving =
errors&lt;br&gt;due to failure in acquiring lock.&lt;br&gt;&lt;br&gt;root@kvm01:~# virsh susp=
end blindone&lt;br&gt;error: Failed to suspend domain blindone&lt;br&gt;error: Timed ou=
t during operation: cannot acquire state change lock&lt;br&gt;

&lt;br&gt;Any suggestions how can we figure out possible reasons.&lt;br&gt;&lt;br&gt;--&lt;br&gt;Ja=
tin&lt;br&gt;


</body></email><email><emailId>20111024173128</emailId><senderName>"Roberto Attias (rattias)"</senderName><senderEmail>rattias@cisco.com</senderEmail><timestampReceived>2011-10-24 17:31:28-0400</timestampReceived><subject>[libvirt-users] renaming a domain</subject><body>

Hello,

In my system a VM  with a given domain name is defined and started. At a
certain point I will define and start a new VM, with a different name. I
then want to dispose of the old VM and rename the new one to the old
one. Unfortunately I didn't find any API to do the last  step. Is it
possible to change the domain name of a running VM?

 

Thanks,

 

              Roberto

 


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;&lt;head&gt;&lt;meta http-equiv=Content-Type \
content="text/html; charset=us-ascii"&gt;&lt;meta name=Generator content="Microsoft Word 12 \
(filtered medium)"&gt;&lt;style&gt;&lt;!-- /* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
--&gt;&lt;/style&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapelayout v:ext="edit"&gt;
&lt;o:idmap v:ext="edit" data="1" /&gt;
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;&lt;/head&gt;&lt;body lang=EN-US link=blue vlink=purple&gt;&lt;div \
class=WordSection1&gt;&lt;p class=MsoNormal&gt;Hello,&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;In my \
system a VM  with a given domain name is defined and started. At a certain point \
I will define and start a new VM, with a different name. I then want to dispose of \
the old VM and rename the new one to the old one. Unfortunately I didn’t find \
any API to do the last  step. Is it possible to change the domain name of a \
running VM?&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;Thanks,&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;              \
Roberto&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20111024194257</emailId><senderName>Trey Dockendorf</senderName><senderEmail>treydock@gmail.com</senderEmail><timestampReceived>2011-10-24 19:42:57-0400</timestampReceived><subject>[libvirt-users] Fwd: Re:  Unable to acquire lock</subject><body>

Accidentally sent to OP only.

This has been with 0.8.7 on CentOS 6 CR that Ive had the problem.
---------- Forwarded message ----------
From: "Trey Dockendorf" &lt;treydock@gmail.com&gt;
Date: Oct 24, 2011 12:31 AM
Subject: Re: [libvirt-users] Unable to acquire lock
To: "Jatin Kumar" &lt;cs5090243@cse.iitd.ernet.in&gt;



On Mon, Oct 24, 2011 at 12:05 AM, Jatin Kumar
&lt;cs5090243@cse.iitd.ernet.in&gt;wrote:

&gt; Hello,
&gt; I am trying to execute virsh commands on a host but it is giving errors
&gt; due to failure in acquiring lock.
&gt;
&gt; root@kvm01:~# virsh suspend blindone
&gt; error: Failed to suspend domain blindone
&gt; error: Timed out during operation: cannot acquire state change lock
&gt;
&gt; Any suggestions how can we figure out possible reasons.
&gt;
&gt; --
&gt; Jatin
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

I've run into this a few times when a snapshot hangs.  Unfortunately I can't
offer much advice on why it happens, but increasing log verbosity may help
troubleshoot it.  These are the relevant lines I use in
/etc/libvirt/libvirtd.conf

log_level = 2
log_filters="2:remote 2:event"
log_outputs="2:file:/var/log/libvirt/libvirtd.log"

Be careful with level 1 alerts...I generated a 100GB text log in 3 days.

To fix that problem and unlock a VM, you need to kill libvirt, remove the
PID files and start libvirt

# service libvirtd stop
# rm -rfv /var/run/libvirt
# service libvirtd start

More information here, https://bugzilla.redhat.com/show_bug.cgi?id=676205

- Trey

[Attachment #3 (text/html)]

&lt;p&gt;Accidentally sent to OP only.&lt;/p&gt;
&lt;p&gt;This has been with 0.8.7 on CentOS 6 CR that Ive had the problem.&lt;/p&gt;
&lt;div class="gmail_quote"&gt;---------- Forwarded message ----------&lt;br&gt;From: "Trey \
Dockendorf" &lt;&lt;a \
href="mailto:treydock@gmail.com"&gt;treydock@gmail.com&lt;/a&gt;&gt;&lt;br&gt;Date: Oct 24, 2011 \
                12:31 AM&lt;br&gt;Subject: Re: [libvirt-users] Unable to acquire lock&lt;br&gt;
To: "Jatin Kumar" &lt;&lt;a \
href="mailto:cs5090243@cse.iitd.ernet.in"&gt;cs5090243@cse.iitd.ernet.in&lt;/a&gt;&gt;&lt;br&gt;&lt;br \
type="attribution"&gt;&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div class="elided-text"&gt;On Mon, \
Oct 24, 2011 at 12:05 AM, Jatin Kumar &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:cs5090243@cse.iitd.ernet.in" \
target="_blank"&gt;cs5090243@cse.iitd.ernet.in&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt; \
&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex"&gt;&lt;div class="elided-text"&gt; Hello,&lt;br&gt;I am trying to execute \
virsh commands on a host but it is giving errors&lt;br&gt;due to failure in acquiring \
lock.&lt;br&gt;&lt;br&gt;root@kvm01:~# virsh suspend blindone&lt;br&gt;error: Failed to suspend domain \
blindone&lt;br&gt;error: Timed out during operation: cannot acquire state change lock&lt;br&gt;



&lt;br&gt;Any suggestions how can we figure out possible reasons.&lt;br&gt;&lt;font \
color="#888888"&gt;&lt;br&gt;--&lt;br&gt;Jatin&lt;br&gt; \
&lt;/font&gt;&lt;br&gt;&lt;/div&gt;_______________________________________________&lt;br&gt; libvirt-users \
mailing list&lt;br&gt; &lt;a href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt; &lt;a \
href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;I've \
run into this a few times when a snapshot hangs.  Unfortunately I can't offer \
much advice on why it happens, but increasing log verbosity may help troubleshoot it. \
These are the relevant lines I use in /etc/libvirt/libvirtd.conf&lt;/div&gt;

&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;log_level = 2&lt;/div&gt;&lt;div&gt;log_filters="2:remote \
2:event"&lt;/div&gt;&lt;div&gt;log_outputs="2:file:/var/log/libvirt/libvirtd.log"&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Be \
careful with level 1 alerts...I generated a 100GB text log in 3 days.&lt;/div&gt;

&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;To fix that problem and unlock a VM, you need to kill libvirt, \
remove the PID files and start libvirt&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;# service libvirtd \
stop&lt;/div&gt;&lt;div&gt;# rm -rfv /var/run/libvirt&lt;/div&gt;&lt;div&gt;# service libvirtd start&lt;/div&gt;

&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;More information here, &lt;a \
href="https://bugzilla.redhat.com/show_bug.cgi?id=676205" \
target="_blank"&gt;https://bugzilla.redhat.com/show_bug.cgi?id=676205&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;font \
                color="#888888"&gt;&lt;div&gt;
- Trey&lt;/div&gt;
&lt;/font&gt;&lt;/div&gt;



</body></email><email><emailId>20111024195029</emailId><senderName>sethuraman subbiah</senderName><senderEmail>sethusubbiah@gmail.com</senderEmail><timestampReceived>2011-10-24 19:50:29-0400</timestampReceived><subject>[libvirt-users] Hard limit for the cpu usage of a VM</subject><body>

Hi ,

I was previously using xen and currently moved to KVM. I am using libvirt to manage \
these VMs. In den's credit scheduler , I had the ability to set a cap on the cpu \
usage for a VM. But I was not able to find a similar substitute in KVM. I find that \
we can use cgroups to provide shares for VM but that will be more like weight based \
and it doesn't set a hard cap for that VM. I tried using cpulimit but I find it \
inaccurate and we can give values only between 0-100. Thus, I think it cannot support \
multi core environments. Can any one suggest a method to set a hard limit on a VM's \
cpu usage? Thank you. 


-
Regards,
Sethuraman Subbiah

Graduate Student - NC state University
M.S in Computer Science


</body></email><email><emailId>20111024083407</emailId><senderName>"Guangya Liu"</senderName><senderEmail>gyliu@platform.com</senderEmail><timestampReceived>2011-10-24 08:34:07-0400</timestampReceived><subject>[libvirt-users] How to use "virsh migrat" with p2p option?</subject><body>

Hi libvirt support,
 
Can you please give me some example of how to use "virsh migrate --live" with p2p \
option including both source host and target host?  
I try to get some info from your website, but no info with migrate.
 
[root@vmoactive02 qemu]# virsh help migrate
  NAME
    migrate - migrate domain to another host
 
  SYNOPSIS
    migrate [--live] [--p2p] [--direct] [--tunnelled] [--persistent] \
[--undefinesource] [--suspend] [--copy-storage-all] [--copy-storage-inc] &lt;domain&gt; \
&lt;desturi&gt; [&lt;migrateuri&gt;] [&lt;dname&gt;]  
  DESCRIPTION
    Migrate domain to another host.  Add --live for live migration.
 
  OPTIONS
    --live           live migration
    --p2p            peer-2-peer migration
    --direct         direct migration
    --tunnelled      tunnelled migration
    --persistent     persist VM on destination
    --undefinesource  undefine VM on source
    --suspend        do not restart the domain on the destination host
    --copy-storage-all  migration with non-shared storage with full disk copy
    --copy-storage-inc  migration with non-shared storage with incremental copy (same \
base image shared between source and destination)  [--domain] &lt;string&gt;  domain name, \
id or uuid  [--desturi] &lt;string&gt;  connection URI of the destination host
    [--migrateuri] &lt;string&gt;  migration URI, usually can be omitted
    [--dname] &lt;string&gt;  rename to new name during migration (if supported)
 
Thanks,
 
Guangya


[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;
&lt;HTML xmlns:o = "urn:schemas-microsoft-com:office:office"&gt;&lt;HEAD&gt;
&lt;META content="text/html; charset=us-ascii" http-equiv=Content-Type&gt;
&lt;STYLE&gt;
BLOCKQUOTE {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; MARGIN-LEFT: 2em
}
OL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
UL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
BODY {
	LINE-HEIGHT: 1.5; FONT-FAMILY: verdana; COLOR: #000000; FONT-SIZE: 10pt
}
P {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
&lt;/STYLE&gt;

&lt;META name=GENERATOR content="MSHTML 8.00.6001.19120"&gt;&lt;/HEAD&gt;
&lt;BODY style="MARGIN: 10px"&gt;
&lt;DIV&gt;&lt;FONT style="FONT-SIZE: 11pt" size=1 face=Calibri&gt;Hi libvirt 
support,&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT style="FONT-SIZE: 11pt" size=1 face=Calibri&gt;&lt;/FONT&gt; &lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT style="FONT-SIZE: 11pt" size=1 face=Calibri&gt;Can you please give me 
some example of how to use "virsh migrate --live" with p2p option including both 
source host and target host?&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT style="FONT-SIZE: 11pt" size=1 face=Calibri&gt;&lt;/FONT&gt; &lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT style="FONT-SIZE: 11pt" size=1 face=Calibri&gt;I try to get some info 
from your website, but no info with migrate.&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=Calibri&gt;&lt;/FONT&gt; &lt;/DIV&gt;
&lt;DIV&gt;
&lt;DIV&gt;[root@vmoactive02 qemu]# virsh help migrate&lt;/DIV&gt;
&lt;DIV&gt;  NAME&lt;/DIV&gt;
&lt;DIV&gt;    migrate - migrate domain to another host&lt;/DIV&gt;
 &lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;  SYNOPSIS&lt;/DIV&gt;
&lt;DIV&gt;    migrate [--live] [--p2p] [--direct] [ \
--tunnelled] [--persistent] [--undefinesource] [--suspend] [--copy \
-storage-all] [--copy-storage-inc] &lt;domain&gt; &lt;desturi&gt; [&lt;migrateuri&gt;] [&lt;dname&gt;]&lt;/DIV&gt;
 &lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;  DESCRIPTION&lt;/DIV&gt;
&lt;DIV&gt;    Migrate domain to another host.  Add --live for live migration.&lt;/DIV&gt;
 &lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;  OPTIONS&lt;/DIV&gt;
&lt;DIV&gt;    --live           live migration&lt;/DIV&gt;
 &lt;DIV&gt;    --p2p            peer-2-peer migration&lt;/DIV&gt;
 &lt;DIV&gt;    --direct         direct migration&lt;/DIV&gt;
 &lt;DIV&gt;    --tunnelled      tunnelled migration&lt;/DIV&gt;
 &lt;DIV&gt;    --persistent     persist VM on destination&lt;/DIV&gt;
 &lt;DIV&gt;    --undefinesource  undefine VM on source&lt;/DIV&gt;
 &lt;DIV&gt;    --suspend         \
;do not restart the domain on the destination host&lt;/DIV&gt;
 &lt;DIV&gt;    --copy-storage-all  migration with non-shared storage with full disk copy&lt;/DIV&gt;
 &lt;DIV&gt;    --copy-storage-inc  migration with n \
on-shared storage with incremental copy (same base image shared between source and destination)&lt;/DIV&gt;
 &lt;DIV&gt;    [--domain] &lt;string&gt;  domain name, id or uuid&lt;/DIV&gt;
 &lt;DIV&gt;    [--desturi] &lt;string&gt;  connection URI of the destination host&lt;/DIV&gt;
 &lt;DIV&gt;    [--migrateuri] &lt;string&gt;  migration URI, usually can be omitted&lt;/DIV&gt;
 &lt;DIV&gt;    [--dname] &lt;string&gt;  rename to&amp; \
nbsp;new name during migration (if supported)&lt;/DIV&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT style="FONT-SIZE: 11pt" size=1 face=Calibri&gt;&lt;/FONT&gt; &lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
style="FONT-SIZE: 11pt" size=1 face=Calibri&gt;Thanks,&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
style="FONT-SIZE: 11pt" size=1 face=Calibri&gt;&lt;/FONT&gt; &lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
style="FONT-SIZE: 11pt" size=1  face=Calibri&gt;Guangya&lt;/FONT&gt;&lt;/DIV&gt;&lt;/BODY&gt;&lt;/HTML&gt;



</body></email><email><emailId>20111026031322</emailId><senderName></senderName><senderEmail>minling.ann@gmail.com</senderEmail><timestampReceived>2011-10-26 03:13:22-0400</timestampReceived><subject>[libvirt-users] virsh start VM failed</subject><body>

Dear,

I encountered some problems when I used the virsh to start my virtual
machines. I had tried some ways but I still couldn't solve it.
Please help me, thanks.

error messages :

virsh # start controlnode
error: Failed to start domain controlnode
error: internal error process exited while connecting to monitor:
bind(unix:/var/lib/libvirt/qemu/controlnode.monitor): Permission denied
chardev: opening backend "socket" failed

[Attachment #3 (text/html)]

Dear,&lt;br&gt; &lt;br&gt;I encountered some problems when I used the virsh to start my virtual \
machines. I had tried some ways but I still couldn't solve it.&lt;br&gt;Please help me, \
thanks.&lt;br&gt;&lt;br&gt;error messages :&lt;br&gt;&lt;br&gt;&lt;span style="color: rgb(255, 0, 0);"&gt;virsh # \
start controlnode&lt;/span&gt;&lt;br style="color: rgb(255, 0, 0);"&gt; &lt;span style="color: \
rgb(255, 0, 0);"&gt;error: Failed to start domain controlnode&lt;/span&gt;&lt;br style="color: \
rgb(255, 0, 0);"&gt;&lt;span style="color: rgb(255, 0, 0);"&gt;error: internal error process \
exited while connecting to monitor: \
bind(unix:/var/lib/libvirt/qemu/controlnode.monitor): Permission denied&lt;/span&gt;&lt;br \
style="color: rgb(255, 0, 0);"&gt; &lt;span style="color: rgb(255, 0, 0);"&gt;chardev: opening \
backend "socket" failed&lt;/span&gt;&lt;br&gt;&lt;br&gt; &lt;br&gt;&lt;br&gt;



</body></email><email><emailId>20111026133924</emailId><senderName>Dan Hirsch</senderName><senderEmail>dan.hirsch@ravellosystems.com</senderEmail><timestampReceived>2011-10-26 13:39:24-0400</timestampReceived><subject>[libvirt-users] how to setup libvirt with java bindings for use</subject><body>

Hi,
I would like to use libvirt to manipulate virtual machines of different
types (KVM, ESXi etc.)
I added dependencies to my project the libvirt and jna jars.
trying to execute your example code I am getting a run time exception saying
the library cann't be found.
it an actual libvirt c library is also required, and needs to be compiled
separately?

can you please write down all needed steps for using libvirt with java
binding?

thanks in advance.

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hi, &lt;div&gt;I would like to use libvirt to manipulate virtual machines of \
different types (KVM, ESXi etc.)&lt;/div&gt;&lt;div&gt;I added dependencies to my project the \
libvirt and jna jars.&lt;/div&gt;&lt;div&gt;trying to execute your example code I am getting a \
run time exception saying the library cann't be found.&lt;/div&gt; &lt;div&gt;it an actual \
libvirt c library is also required, and needs to be compiled \
separately?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;can you please write down all needed steps for \
using libvirt with java binding?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; thanks in \
advance.&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20111024160234</emailId><senderName>"Langenbach, Steffen"</senderName><senderEmail>steffen.langenbach@mechatronic.de</senderEmail><timestampReceived>2011-10-24 16:02:34-0400</timestampReceived><subject>[libvirt-users] Start of libvirtd fails with error "undefined symbol: __virAlloc"</subject><body>

[Attachment #2 (text/plain)]

Hello List

like described in the topic I have a problem with starting the libvirtd. I'm a \
complete newbie with libvirtd, today I heard the first time that such a daemon exists \
after I get the message that our webserver isn't running (a former colleague has \
installed this system). We have the following configuration: A Ubuntu based host on \
which our webserver runs within a qemu virtual machine. The following happens: \
Yesterday the host restarted (at the moment we don't know the reason) and since this \
restart libvirtd did not start up. How I found that out: When I try to start the \
virtual machine with "virsh start z-web" I get the error: "Connecting to uri: \
                qemu:///session
libvir: Remote error : unable to connect to '/var/run/libvirt/libvirt-sock': No such \
                file or directory
error: failed to connect to the hypervisor"
As explained, I'm a total Newbie with libvirtd. So as far as I know, the libvirt-sock \
is generated by libvirtd when it's running. I don't know the right way how to start \
libvirtd. I tried it by just typing "libvirtd", but that generates this error: \
"libvirtd: symbol lookup error: libvirtd: undefined symbol: __virAlloc".

I can't find any log-entry that gives me more information about this error.

Does anybody can help me with this problem? In which logfiles does libvirtd normaly \
writes such errormessages? Or what can the problem be? If you need more information \
about the configuration or something else, I can find that out, if you tell me where \
;)

Thanks alot for your help!

Kind regards,
Steffen
________________________________
Steffen Langenbach
IT-Administration
Tel: +49 6151 50031-66
Fax: +49 6151 50031-40
Steffen.Langenbach@mechatronic.de

[http://www.mechatronic.de/fileadmin/gfx/mechatronic_mail.jpg]
________________________________
Mechatronic AG • Wittichstraße 2, 64295 Darmstadt; DE • Tel +49 6151 50031-66 \
• Fax +49 6151 50031-40 ________________________________
Diese E-Mail enthält vertrauliche Informationen. Wenn Sie diese E-Mail irrtümlich \
erhalten haben, informieren Sie bitte sofort den Absender und vernichten Sie diese \
Mail. Die Anfertigung unerlaubter Kopien, die Weitergabe der Information sowie die \
unbefugte Weitersendung der E-Mail ist nicht gestattet.

This e-mail contains confidential information. If you wrongly received this e-mail, \
please inform the sender immediately and delete this e-mail. Unauthorised copying, \
disclosure or distribution of this e-mail is strictly forbidden.

Amtsgericht: Darmstadt, Sitz: Darmstadt, HRB 9437
Vorstand: Thomas Ullmann (Vors./CEO)
Vorsitzender des Aufsichtsrats: Dr. Alexander Geilert


[Attachment #3 (text/html)]

&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div&gt;&lt;span class="921384115-24102011"&gt;&lt;font size="2" face="Arial"&gt;Hello \
List&lt;/font&gt;&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span class="921384115-24102011"&gt;&lt;font size="2" \
face="Arial"&gt;&lt;/font&gt;&lt;/span&gt; &lt;/div&gt; &lt;div&gt;&lt;span class="921384115-24102011"&gt;&lt;font \
size="2" face="Arial"&gt;like described in the topic I have a problem with starting the \
libvirtd. I'm a complete newbie with libvirtd, today I heard the first time that \
such a daemon exists after I get the message that  our webserver isn't running (a \
former colleague has installed this system).&lt;/font&gt;&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span \
class="921384115-24102011"&gt;&lt;font size="2" face="Arial"&gt;We have the following \
configuration: A Ubuntu based host on which our webserver runs within a qemu virtual \
machine.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span class="921384115-24102011"&gt;&lt;font size="2" \
face="Arial"&gt;The following happens: Yesterday the host restarted (at the moment we \
don't know the reason) and since this restart libvirtd did not start \
up.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span class="921384115-24102011"&gt;&lt;font size="2" \
face="Arial"&gt;How I found that out: When I try to start the virtual machine with \
"virsh start z-web" I get the error:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span \
class="921384115-24102011"&gt;&lt;font size="2" face="Arial"&gt;"Connecting to uri: \
                qemu:///session&lt;br&gt;
libvir: Remote error : unable to connect to '/var/run/libvirt/libvirt-sock': No such \
                file or directory&lt;br&gt;
error: failed to connect to the hypervisor"&lt;br&gt;
&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span class="921384115-24102011"&gt;&lt;font size="2" face="Arial"&gt;As explained, I'm a \
total Newbie with libvirtd. So as far as I know, the libvirt-sock is generated by \
libvirtd when it's running. I don't know the right way how to start libvirtd. I tried \
it  by just typing "libvirtd", but that generates this error: \
"libvirtd: symbol lookup error: libvirtd: undefined symbol: \
__virAlloc".&lt;/font&gt;&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span class="921384115-24102011"&gt;&lt;font \
size="2" face="Arial"&gt;&lt;/font&gt;&lt;/span&gt; &lt;/div&gt; &lt;div&gt;&lt;span \
class="921384115-24102011"&gt;&lt;font size="2" face="Arial"&gt;I can't find any log-entry \
that gives me more information about this error.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span \
class="921384115-24102011"&gt;&lt;font size="2" face="Arial"&gt;&lt;/font&gt;&lt;/span&gt; &lt;/div&gt; \
&lt;div&gt;&lt;span class="921384115-24102011"&gt;&lt;font size="2" face="Arial"&gt;Does anybody can \
help me with this problem? In which logfiles does libvirtd normaly writes such \
errormessages? Or what can the problem be? If you need more information about the \
configuration  or something else, I can find that out, if you tell me where \
;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span class="921384115-24102011"&gt;&lt;font size="2" \
face="Arial"&gt;&lt;/font&gt;&lt;/span&gt; &lt;/div&gt; &lt;div&gt;&lt;span class="921384115-24102011"&gt;&lt;font \
size="2" face="Arial"&gt;Thanks alot for your help!&lt;/font&gt;&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span \
class="921384115-24102011"&gt;&lt;font size="2" face="Arial"&gt;&lt;/font&gt;&lt;/span&gt; &lt;/div&gt; \
&lt;div&gt;&lt;span class="921384115-24102011"&gt;&lt;font size="2" face="Arial"&gt;Kind \
regards,&lt;/font&gt;&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span class="921384115-24102011"&gt;&lt;font size="2" \
face="Arial"&gt;Steffen&lt;/font&gt;&lt;/span&gt;&lt;/div&gt; &lt;style type="text/css"&gt;
&lt;!--
.mecha
	{width:525px;
	font-family:Arial,Helvetica,Geneva,Sans-Serif;
	font-size:7pt;
	color:#122f56}
.benutzer
	{font-family:Arial,Helvetica,Geneva,Sans-Serif;
	font-size:8pt;
	color:#122f56}
.gesetzlich
	{width:525px;
	font-family:Arial,Helvetica,Geneva,Sans-Serif;
	font-size:7pt;
	color:grey}
.title
	{height:20px;
	font-family:Arial,Helvetica,Geneva,Sans-Serif;
	font-size:8pt;
	color:#d1a655}
--&gt;
&lt;/style&gt;
&lt;hr&gt;
&lt;div class="benutzer"&gt;&lt;b&gt;Steffen Langenbach&lt;/b&gt;
&lt;div class="title"&gt;IT-Administration&lt;/div&gt;
&lt;div class="benutzer"&gt;Tel: +49 6151 50031-66&lt;br&gt;
Fax: +49 6151 50031-40&lt;br&gt;
Steffen.Langenbach@mechatronic.de&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="logo"&gt;&lt;img \
src="http://www.mechatronic.de/fileadmin/gfx/mechatronic_mail.jpg"&gt;&lt;/div&gt; &lt;div \
class="mecha"&gt; &lt;hr align="left" size="1"&gt;
Mechatronic AG • Wittichstraße 2, 64295 Darmstadt; DE • Tel +49 6151 \
50031-66 • Fax +49 6151 50031-40 &lt;hr align="left" size="1"&gt;
&lt;/div&gt;
&lt;div class="gesetzlich"&gt;Diese E-Mail enthält vertrauliche Informationen. Wenn Sie \
diese E-Mail irrtümlich erhalten haben, informieren Sie bitte sofort den Absender \
und vernichten Sie diese Mail. Die Anfertigung unerlaubter Kopien, die Weitergabe der \
Information  sowie die unbefugte Weitersendung der E-Mail ist nicht gestattet.&lt;br&gt;
&lt;br&gt;
This e-mail contains confidential information. If you wrongly received this e-mail, \
please inform the sender immediately and delete this e-mail. Unauthorised copying, \
disclosure or distribution of this e-mail is strictly forbidden.&lt;br&gt; &lt;br&gt;
Amtsgericht: Darmstadt, Sitz: Darmstadt, HRB 9437&lt;br&gt;
Vorstand: Thomas Ullmann (Vors./CEO)&lt;br&gt;
Vorsitzender des Aufsichtsrats: Dr. Alexander Geilert&lt;br&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20111026142222</emailId><senderName>Luengffy XUE</senderName><senderEmail>feiliangxue@gmail.com</senderEmail><timestampReceived>2011-10-26 14:22:22-0400</timestampReceived><subject>[libvirt-users] live migration without shared storage problems.</subject><body>

Hi, all

I migrate a vm from source host to the destination host.

I am sure every part is ok for migration.


1   Create the  image in the destination and change the user and group.

2   Open TCP socket in the destination host.


and I migrate in the source host command line.

$ virsh migrate --live --copy-storage-all vmubuntu
qemu+ssh://destinationHost/system --verbose

But I get the  error

"error: operation failed : failed to retrieve chardev info inqemu with
'info chardev'"

In the destination I find in the vmubuntu.log

The error is

"Migration failed. Exit code tcp:0.0.0.0:49170(-98),exiting."


What can I do to solve it ?

I do not understand how the error comes.

Anyone can help me ?

Thanks in advance.

[Attachment #3 (text/html)]

&lt;span class="Apple-style-span" style="font-family: 'UbuntuBeta Regular', \
Ubuntu, 'Bitstream Vera Sans', 'DejaVu Sans', Tahoma, sans-serif; \
font-size: 12px; line-height: 18px; "&gt;&lt;pre style="color: rgb(51, 51, 51); \
font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace; \
margin-bottom: 0.8em; "&gt; &lt;br&gt;&lt;/pre&gt;&lt;pre style="color: rgb(51, 51, 51); font-family: \
'UbuntuBeta Mono', 'Ubuntu Mono', monospace; margin-bottom: 0.8em; \
"&gt;Hi, all&lt;/pre&gt;&lt;pre style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta \
Mono', 'Ubuntu Mono', monospace; margin-bottom: 0.8em; "&gt; I migrate a vm \
from source host to the destination host. &lt;/pre&gt;&lt;pre style="color: rgb(51, 51, 51); \
font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace; \
margin-bottom: 0.8em; "&gt;I am sure every part is ok for migration.&lt;/pre&gt; &lt;pre \
style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace; margin-bottom: 0.8em; "&gt;&lt;br&gt;&lt;/pre&gt;&lt;pre style="color: rgb(51, \
51, 51); font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace; \
margin-bottom: 0.8em; "&gt; 1   Create the  image in the destination and change the user \
and group.&lt;/pre&gt;&lt;pre style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta \
Mono', 'Ubuntu Mono', monospace; margin-bottom: 0.8em; "&gt;2   Open TCP \
socket in the destination host. &lt;/pre&gt; &lt;pre style="color: rgb(51, 51, 51); \
font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace; \
margin-bottom: 0.8em; "&gt;&lt;br&gt;&lt;/pre&gt;&lt;pre style="color: rgb(51, 51, 51); font-family: \
'UbuntuBeta Mono', 'Ubuntu Mono', monospace; margin-bottom: 0.8em; "&gt; \
and I migrate in the source host command line.   &lt;/pre&gt;&lt;pre style="color: rgb(51, 51, \
51); font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace; \
margin-bottom: 0.8em; "&gt;$ virsh migrate --live --copy-storage-all vmubuntu  \
qemu+ssh://destinationHost/system --verbose&lt;/pre&gt; &lt;pre style="color: rgb(51, 51, 51); \
font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace; \
margin-bottom: 0.8em; "&gt;But I get the  error&lt;/pre&gt;&lt;pre style="font-family: \
'UbuntuBeta Mono', 'Ubuntu Mono', monospace; margin-bottom: 0.8em; "&gt; \
&lt;span class="Apple-style-span" style="background-color: rgb(255, 255, 0); "&gt;&lt;font \
class="Apple-style-span" color="#ff0000"&gt;"error: operation failed : failed to \
retrieve chardev info inqemu with 'info chardev'" &lt;/font&gt;&lt;/span&gt;&lt;/pre&gt; \
&lt;pre style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta Mono', \
'Ubuntu Mono', monospace; margin-bottom: 0.8em; "&gt;In the destination I find \
in the vmubuntu.log  &lt;/pre&gt;&lt;pre style="color: rgb(51, 51, 51); font-family: \
'UbuntuBeta Mono', 'Ubuntu Mono', monospace; margin-bottom: 0.8em; "&gt; \
The error is &lt;/pre&gt;&lt;pre style="font-family: 'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace; margin-bottom: 0.8em; "&gt;&lt;span class="Apple-style-span" \
style="background-color: rgb(255, 255, 0); "&gt;&lt;font class="Apple-style-span" \
color="#ff0000"&gt;"Migration failed. Exit code \
tcp:0.0.0.0:49170(-98),exiting."&lt;/font&gt;&lt;/span&gt;&lt;/pre&gt; &lt;pre style="font-family: \
'UbuntuBeta Mono', 'Ubuntu Mono', monospace; margin-bottom: 0.8em; \
"&gt;&lt;font class="Apple-style-span" color="#ff0000"&gt;&lt;br&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre \
style="font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace; \
margin-bottom: 0.8em; "&gt; &lt;font class="Apple-style-span" color="#ff0000"&gt;&lt;span \
class="Apple-style-span" style="font-family: 'UbuntuBeta Regular', Ubuntu, \
'Bitstream Vera Sans', 'DejaVu Sans', Tahoma, sans-serif; color: \
rgb(0, 0, 0); white-space: normal; "&gt;&lt;pre style="color: rgb(51, 51, 51); font-family: \
'UbuntuBeta Mono', 'Ubuntu Mono', monospace; margin-bottom: 0.8em; "&gt; \
What can I do to solve it ? &lt;/pre&gt;&lt;pre style="color: rgb(51, 51, 51); font-family: \
'UbuntuBeta Mono', 'Ubuntu Mono', monospace; margin-bottom: 0.8em; \
"&gt;I do not understand how the error comes.&lt;/pre&gt;&lt;pre style="color: rgb(51, 51, 51); \
font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace; \
margin-bottom: 0.8em; "&gt; Anyone can help me ?&lt;/pre&gt;&lt;pre style="color: rgb(51, 51, \
51); font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace; \
margin-bottom: 0.8em; "&gt;Thanks in advance. &lt;/pre&gt;&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre \
style="font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace; \
margin-bottom: 0.8em; "&gt; &lt;font class="Apple-style-span" \
color="#ff0000"&gt;&lt;br&gt;&lt;/font&gt;&lt;/pre&gt;&lt;/span&gt;



</body></email><email><emailId>20111026152943</emailId><senderName>vmnode guy</senderName><senderEmail>vmnodeguy@gmail.com</senderEmail><timestampReceived>2011-10-26 15:29:43-0400</timestampReceived><subject>Re: [libvirt-users] live migration without shared storage problems.</subject><body>

Try this, i am not sure it will works..
 $ virsh -c qemu+ssh://destinationHost/system migrate --live
--copy-storage-all vmubuntu

But it works for me for below option:-
$ virsh -c qemu+ssh://destinationHost/system migrate list

Regards,
Peter

On Wed, Oct 26, 2011 at 10:22 PM, Luengffy XUE &lt;feiliangxue@gmail.com&gt;wrote:

&gt;
&gt; Hi, all
&gt;
&gt; I migrate a vm from source host to the destination host.
&gt;
&gt; I am sure every part is ok for migration.
&gt;
&gt;
&gt; 1   Create the  image in the destination and change the user and group.
&gt;
&gt; 2   Open TCP socket in the destination host.
&gt;
&gt;
&gt; and I migrate in the source host command line.
&gt;
&gt; But I get the error
&gt;
&gt; $ virsh migrate --live --copy-storage-all vmubuntu  qemu+ssh://destinationHost/system --verbose
&gt;
&gt; "error: operation failed : failed to retrieve chardev info inqemu with 'info chardev'"
&gt;
&gt; In the destination I find in the vmubuntu.log
&gt;
&gt; The error is
&gt;
&gt; "Migration failed. Exit code tcp:0.0.0.0:49170(-98),exiting."
&gt;
&gt;
&gt; What can I do to solve it ?
&gt;
&gt; I do not understand how the error comes.
&gt;
&gt; Anyone can help me ?
&gt;
&gt; Thanks in advance.
&gt;
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

[Attachment #3 (text/html)]

&lt;meta http-equiv="content-type" content="text/html; charset=utf-8"&gt;&lt;div \
class="gmail_quote"&gt;&lt;meta http-equiv="content-type" content="text/html; \
charset=utf-8"&gt;&lt;div&gt;Try this, i am not sure it will works..&lt;/div&gt;&lt;div&gt; &lt;span \
class="Apple-style-span" style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta \
Mono', 'Ubuntu Mono', monospace; font-size: 12px; line-height: 18px; \
white-space: pre; "&gt;$ virsh -c &lt;/span&gt;&lt;span class="Apple-style-span" style="color: \
rgb(51, 51, 51); font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace; font-size: 12px; line-height: 18px; white-space: pre; \
"&gt;qemu+ssh://destinationHost/system&lt;/span&gt;&lt;span class="Apple-style-span" \
style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace; font-size: 12px; line-height: 18px; white-space: pre; "&gt; \
migrate --live --copy-storage-all vmubuntu&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span \
class="Apple-style-span" style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta \
Mono', 'Ubuntu Mono', monospace; font-size: 12px; line-height: 18px; \
white-space: pre; "&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;But it works for me for below \
option:-&lt;/div&gt; &lt;div&gt;&lt;span class="Apple-style-span" style="color: rgb(51, 51, 51); \
font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace; font-size: \
12px; line-height: 18px; white-space: pre; "&gt;$ virsh -c &lt;/span&gt;&lt;span \
class="Apple-style-span" style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta \
Mono', 'Ubuntu Mono', monospace; font-size: 12px; line-height: 18px; \
white-space: pre; "&gt;qemu+ssh://destinationHost/system&lt;/span&gt;&lt;span \
class="Apple-style-span" style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta \
Mono', 'Ubuntu Mono', monospace; font-size: 12px; line-height: 18px; \
white-space: pre; "&gt; migrate list&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span class="Apple-style-span" \
style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace; font-size: 12px; line-height: 18px; white-space: pre; "&gt;&lt;span \
class="Apple-style-span" style="font-family: arial; font-size: small; color: rgb(0, \
0, 0); line-height: normal; white-space: normal; "&gt;&lt;span class="Apple-style-span" \
style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace; font-size: 12px; line-height: 18px; white-space: pre; "&gt;&lt;br&gt; \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span class="Apple-style-span" style="color: rgb(51, \
51, 51); font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace; \
font-size: 12px; line-height: 18px; white-space: pre; "&gt;&lt;span \
class="Apple-style-span" style="font-family: arial; font-size: small; color: rgb(0, \
0, 0); line-height: normal; white-space: normal; "&gt;&lt;span class="Apple-style-span" \
style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace; font-size: 12px; line-height: 18px; white-space: pre; \
"&gt;Regards,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt; &lt;/div&gt;&lt;div class="gmail_quote"&gt;Peter&lt;/div&gt;&lt;div \
class="gmail_quote"&gt;&lt;br&gt;&lt;/div&gt;&lt;div class="gmail_quote"&gt;On Wed, Oct 26, 2011 at 10:22 \
PM, Luengffy XUE &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:feiliangxue@gmail.com"&gt;feiliangxue@gmail.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt; \
&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt;&lt;span style="font-family:'UbuntuBeta Regular', \
Ubuntu, 'Bitstream Vera Sans', 'DejaVu Sans', Tahoma, \
sans-serif;font-size:12px;line-height:18px"&gt;&lt;pre style="color:rgb(51, 51, \
51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt; &lt;br&gt;&lt;/pre&gt;&lt;pre style="color:rgb(51, 51, \
51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt;Hi, all&lt;/pre&gt;&lt;pre style="color:rgb(51, 51, \
51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt; I migrate a vm from source host to the destination \
host. &lt;/pre&gt;&lt;pre style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', \
'Ubuntu Mono', monospace;margin-bottom:0.8em"&gt;I am sure every part is ok for \
migration.&lt;/pre&gt;

&lt;pre style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace;margin-bottom:0.8em"&gt;&lt;br&gt;&lt;/pre&gt;&lt;pre style="color:rgb(51, 51, \
51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt; 1   Create the  image in the destination and change \
the user and group.&lt;/pre&gt;&lt;pre style="color:rgb(51, 51, \
51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt;2   Open TCP socket in the destination host. &lt;/pre&gt;

&lt;pre style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace;margin-bottom:0.8em"&gt;&lt;br&gt;&lt;/pre&gt;&lt;pre style="color:rgb(51, 51, \
51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt; and I migrate in the source host command line.   \
&lt;/pre&gt;&lt;/span&gt;&lt;span class="Apple-style-span" style="color: rgb(51, 51, 51); \
font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace; font-size: \
12px; line-height: 18px; white-space: pre; "&gt;But I get the  error&lt;/span&gt;&lt;span \
style="font-family:'UbuntuBeta Regular', Ubuntu, 'Bitstream Vera \
Sans', 'DejaVu Sans', Tahoma, \
sans-serif;font-size:12px;line-height:18px"&gt;&lt;pre style="color:rgb(51, 51, \
51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt; $ virsh migrate --live --copy-storage-all vmubuntu  \
qemu+ssh://destinationHost/system --verbose&lt;/pre&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt; &lt;span style="font-family:'UbuntuBeta Regular', \
Ubuntu, 'Bitstream Vera Sans', 'DejaVu Sans', Tahoma, \
sans-serif;font-size:12px;line-height:18px"&gt;&lt;pre style="font-family:'UbuntuBeta \
Mono', 'Ubuntu Mono', monospace;margin-bottom:0.8em"&gt; &lt;span \
style="background-color:rgb(255, 255, 0)"&gt;&lt;font color="#ff0000"&gt;"error: \
operation failed : failed to retrieve chardev info inqemu with 'info \
chardev'" &lt;/font&gt;&lt;/span&gt;&lt;/pre&gt; &lt;pre style="color:rgb(51, 51, \
51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt;In the destination I find in the vmubuntu.log  \
&lt;/pre&gt;&lt;pre style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', \
'Ubuntu Mono', monospace;margin-bottom:0.8em"&gt; The error is &lt;/pre&gt;&lt;pre \
style="font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt;&lt;span style="background-color:rgb(255, 255, 0)"&gt;&lt;font \
color="#ff0000"&gt;"Migration failed. Exit code \
tcp:0.0.0.0:49170(-98),exiting."&lt;/font&gt;&lt;/span&gt;&lt;/pre&gt;

&lt;pre style="font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt;&lt;font color="#ff0000"&gt;&lt;br&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre \
style="font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt; &lt;font color="#ff0000"&gt;&lt;span \
style="font-family:'UbuntuBeta Regular', Ubuntu, 'Bitstream Vera \
Sans', 'DejaVu Sans', Tahoma, sans-serif;color:rgb(0, 0, \
0);white-space:normal"&gt;&lt;pre style="color:rgb(51, 51, 51);font-family:'UbuntuBeta \
Mono', 'Ubuntu Mono', monospace;margin-bottom:0.8em"&gt; What can I do to \
solve it ? &lt;/pre&gt;&lt;pre style="color:rgb(51, 51, 51);font-family:'UbuntuBeta \
Mono', 'Ubuntu Mono', monospace;margin-bottom:0.8em"&gt;I do not understand \
how the error comes.&lt;/pre&gt;&lt;pre style="color:rgb(51, 51, \
51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt; Anyone can help me ?&lt;/pre&gt;&lt;pre style="color:rgb(51, \
51, 51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt;Thanks in advance. &lt;/pre&gt;&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre \
style="font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt; &lt;font color="#ff0000"&gt;&lt;br&gt;&lt;/font&gt;&lt;/pre&gt;&lt;/span&gt;
&lt;br&gt;_______________________________________________&lt;br&gt;
libvirt-users mailing list&lt;br&gt;
&lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
&lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;




</body></email><email><emailId>20111027021106</emailId><senderName>Luengffy XUE</senderName><senderEmail>feiliangxue@gmail.com</senderEmail><timestampReceived>2011-10-27 02:11:06-0400</timestampReceived><subject>Re: [libvirt-users] live migration without shared storage problems.</subject><body>

I find this error is cause by this source C  ----------savevm.c

http://tomoyo.sourceforge.jp/cgi-bin/lxr/source/savevm.c?v=qemu-kvm-0.12.3

I do not understand it. Anyone who develop it?


2011/10/26 vmnode guy &lt;vmnodeguy@gmail.com&gt;

&gt; Try this, i am not sure it will works..
&gt;  $ virsh -c qemu+ssh://destinationHost/system migrate --live
&gt; --copy-storage-all vmubuntu
&gt;
&gt; But it works for me for below option:-
&gt; $ virsh -c qemu+ssh://destinationHost/system migrate list
&gt;
&gt; Regards,
&gt; Peter
&gt;
&gt; On Wed, Oct 26, 2011 at 10:22 PM, Luengffy XUE &lt;feiliangxue@gmail.com&gt;wrote:
&gt;
&gt;&gt;
&gt;&gt; Hi, all
&gt;&gt;
&gt;&gt; I migrate a vm from source host to the destination host.
&gt;&gt;
&gt;&gt; I am sure every part is ok for migration.
&gt;&gt;
&gt;&gt;
&gt;&gt; 1   Create the  image in the destination and change the user and group.
&gt;&gt;
&gt;&gt; 2   Open TCP socket in the destination host.
&gt;&gt;
&gt;&gt;
&gt;&gt; and I migrate in the source host command line.
&gt;&gt;
&gt;&gt; But I get the error
&gt;&gt;
&gt;&gt; $ virsh migrate --live --copy-storage-all vmubuntu  qemu+ssh://destinationHost/system --verbose
&gt;&gt;
&gt;&gt; "error: operation failed : failed to retrieve chardev info inqemu with 'info chardev'"
&gt;&gt;
&gt;&gt; In the destination I find in the vmubuntu.log
&gt;&gt;
&gt;&gt; The error is
&gt;&gt;
&gt;&gt; "Migration failed. Exit code tcp:0.0.0.0:49170(-98),exiting."
&gt;&gt;
&gt;&gt;
&gt;&gt; What can I do to solve it ?
&gt;&gt;
&gt;&gt; I do not understand how the error comes.
&gt;&gt;
&gt;&gt; Anyone can help me ?
&gt;&gt;
&gt;&gt; Thanks in advance.
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; libvirt-users mailing list
&gt;&gt; libvirt-users@redhat.com
&gt;&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;&gt;
&gt;
&gt;

[Attachment #3 (text/html)]

I find this error is cause by this source C  ----------savevm.c&lt;div&gt;&lt;br&gt;&lt;div&gt;&lt;a \
href="http://tomoyo.sourceforge.jp/cgi-bin/lxr/source/savevm.c?v=qemu-kvm-0.12.3"&gt;http://tomoyo.sourceforge.jp/cgi-bin/lxr/source/savevm.c?v=qemu-kvm-0.12.3&lt;/a&gt;&lt;br&gt;
 &lt;br&gt;&lt;/div&gt;&lt;div&gt;I do not understand it. Anyone who develop \
it?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;2011/10/26 vmnode guy &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:vmnodeguy@gmail.com"&gt;vmnodeguy@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;
 &lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt;&lt;div class="gmail_quote"&gt;&lt;div&gt;Try this, i am not sure it \
will works..&lt;/div&gt;&lt;div&gt; &lt;span style="color:rgb(51, 51, \
51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;font-size:12px;line-height:18px;white-space:pre-wrap"&gt;$ virsh -c \
&lt;/span&gt;&lt;span style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', \
'Ubuntu Mono', \
monospace;font-size:12px;line-height:18px;white-space:pre-wrap"&gt;qemu+ssh://destinationHost/system&lt;/span&gt;&lt;span \
style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace;font-size:12px;line-height:18px;white-space:pre-wrap"&gt; migrate \
--live --copy-storage-all vmubuntu&lt;/span&gt;&lt;/div&gt;

&lt;div&gt;&lt;span style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', \
'Ubuntu Mono', \
monospace;font-size:12px;line-height:18px;white-space:pre-wrap"&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;But \
it works for me for below option:-&lt;/div&gt;

&lt;div&gt;&lt;span style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', \
'Ubuntu Mono', \
monospace;font-size:12px;line-height:18px;white-space:pre-wrap"&gt;$ virsh -c \
&lt;/span&gt;&lt;span style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', \
'Ubuntu Mono', \
monospace;font-size:12px;line-height:18px;white-space:pre-wrap"&gt;qemu+ssh://destinationHost/system&lt;/span&gt;&lt;span \
style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace;font-size:12px;line-height:18px;white-space:pre-wrap"&gt; migrate \
list&lt;/span&gt;&lt;/div&gt;

&lt;div&gt;&lt;span style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', \
'Ubuntu Mono', \
monospace;font-size:12px;line-height:18px;white-space:pre-wrap"&gt;&lt;span \
style="font-family:arial;font-size:small;color:rgb(0, 0, \
0);line-height:normal;white-space:normal"&gt;&lt;span style="color:rgb(51, 51, \
51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;font-size:12px;line-height:18px;white-space:pre-wrap"&gt;&lt;br&gt;

&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style="color:rgb(51, 51, \
51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;font-size:12px;line-height:18px;white-space:pre-wrap"&gt;&lt;span \
style="font-family:arial;font-size:small;color:rgb(0, 0, \
0);line-height:normal;white-space:normal"&gt;&lt;span style="color:rgb(51, 51, \
51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;font-size:12px;line-height:18px;white-space:pre-wrap"&gt;Regards,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;


&lt;/div&gt;&lt;div class="gmail_quote"&gt;Peter&lt;/div&gt;&lt;div class="gmail_quote"&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
class="gmail_quote"&gt;On Wed, Oct 26, 2011 at 10:22 PM, Luengffy XUE &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:feiliangxue@gmail.com" \
target="_blank"&gt;feiliangxue@gmail.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt;

&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex"&gt;&lt;span style="font-family:'UbuntuBeta Regular', \
Ubuntu, 'Bitstream Vera Sans', 'DejaVu Sans', Tahoma, \
sans-serif;font-size:12px;line-height:18px"&gt;&lt;pre style="color:rgb(51, 51, \
51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt; &lt;br&gt;&lt;/pre&gt;&lt;pre style="color:rgb(51, 51, \
51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt;Hi, all&lt;/pre&gt;&lt;pre style="color:rgb(51, 51, \
51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt; I migrate a vm from source host to the destination \
host. &lt;/pre&gt;&lt;pre style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', \
'Ubuntu Mono', monospace;margin-bottom:0.8em"&gt;I am sure every part is ok for \
migration.&lt;/pre&gt;


&lt;pre style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace;margin-bottom:0.8em"&gt;&lt;br&gt;&lt;/pre&gt;&lt;pre style="color:rgb(51, 51, \
51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt; 1   Create the  image in the destination and change \
the user and group.&lt;/pre&gt;&lt;pre style="color:rgb(51, 51, \
51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt;2   Open TCP socket in the destination host. &lt;/pre&gt;


&lt;pre style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace;margin-bottom:0.8em"&gt;&lt;br&gt;&lt;/pre&gt;&lt;pre style="color:rgb(51, 51, \
51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt; and I migrate in the source host command line.   \
&lt;/pre&gt;&lt;/span&gt;&lt;span style="color:rgb(51, 51, 51);font-family:'UbuntuBeta \
Mono', 'Ubuntu Mono', \
monospace;font-size:12px;line-height:18px;white-space:pre-wrap"&gt;But I get the  \
error&lt;/span&gt;&lt;span style="font-family:'UbuntuBeta Regular', Ubuntu, \
'Bitstream Vera Sans', 'DejaVu Sans', Tahoma, \
sans-serif;font-size:12px;line-height:18px"&gt;&lt;pre style="color:rgb(51, 51, \
51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt; $ virsh migrate --live --copy-storage-all vmubuntu  \
qemu+ssh://destinationHost/system --verbose&lt;/pre&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex"&gt;

&lt;span style="font-family:'UbuntuBeta Regular', Ubuntu, 'Bitstream Vera \
Sans', 'DejaVu Sans', Tahoma, \
sans-serif;font-size:12px;line-height:18px"&gt;&lt;pre style="font-family:'UbuntuBeta \
Mono', 'Ubuntu Mono', monospace;margin-bottom:0.8em"&gt; &lt;span \
style="background-color:rgb(255, 255, 0)"&gt;&lt;font color="#ff0000"&gt;"error: \
operation failed : failed to retrieve chardev info inqemu with 'info \
chardev'" &lt;/font&gt;&lt;/span&gt;&lt;/pre&gt; &lt;pre style="color:rgb(51, 51, \
51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt;In the destination I find in the vmubuntu.log  \
&lt;/pre&gt;&lt;pre style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', \
'Ubuntu Mono', monospace;margin-bottom:0.8em"&gt; The error is &lt;/pre&gt;&lt;pre \
style="font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt;&lt;span style="background-color:rgb(255, 255, 0)"&gt;&lt;font \
color="#ff0000"&gt;"Migration failed. Exit code \
tcp:0.0.0.0:49170(-98),exiting."&lt;/font&gt;&lt;/span&gt;&lt;/pre&gt;


&lt;pre style="font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt;&lt;font color="#ff0000"&gt;&lt;br&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre \
style="font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt; &lt;font color="#ff0000"&gt;&lt;span \
style="font-family:'UbuntuBeta Regular', Ubuntu, 'Bitstream Vera \
Sans', 'DejaVu Sans', Tahoma, sans-serif;color:rgb(0, 0, \
0);white-space:normal"&gt;&lt;pre style="color:rgb(51, 51, 51);font-family:'UbuntuBeta \
Mono', 'Ubuntu Mono', monospace;margin-bottom:0.8em"&gt; What can I do to \
solve it ? &lt;/pre&gt;&lt;pre style="color:rgb(51, 51, 51);font-family:'UbuntuBeta \
Mono', 'Ubuntu Mono', monospace;margin-bottom:0.8em"&gt;I do not understand \
how the error comes.&lt;/pre&gt;&lt;pre style="color:rgb(51, 51, \
51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt; Anyone can help me ?&lt;/pre&gt;&lt;pre style="color:rgb(51, \
51, 51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt;Thanks in advance. &lt;/pre&gt;&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre \
style="font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt; &lt;font color="#ff0000"&gt;&lt;br&gt;&lt;/font&gt;&lt;/pre&gt;&lt;/span&gt;
&lt;br&gt;_______________________________________________&lt;br&gt;
libvirt-users mailing list&lt;br&gt;
&lt;a href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt; &lt;a \
href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;
 &lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20111027024337</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-10-27 02:43:37-0400</timestampReceived><subject>Re: [libvirt-users] live migration without shared storage problems.</subject><body>

? 2011?10?26? 22:22, Luengffy XUE ??:
&gt; Hi, all
&gt; I migrate a vm from source host to the destination host.
&gt; I am sure every part is ok for migration.
&gt; 1   Create the  image in the destination and change the user and group.
&gt; 2   Open TCP socket in the destination host.
&gt; and I migrate in the source host command line.
&gt; $ virsh migrate --live --copy-storage-all vmubuntu  qemu+ssh://destinationHost/system --verbose
&gt; But I get the  error
&gt; "error: operation failed : failed to retrieve chardev info inqemu with 'info chardev'"

Looks like you even failed on starting the domain. Could you confirm if you
guest is actually running well?

&gt; In the destination I find in the vmubuntu.log
&gt; The error is
&gt; "Migration failed. Exit code tcp:0.0.0.0:49170(-98),exiting."
&gt;
&gt; What can I do to solve it ?
&gt; I do not understand how the error comes.
&gt; Anyone can help me ?
&gt; Thanks in advance.
&gt;


[Attachment #3 (text/html)]

&lt;html&gt;
  &lt;head&gt;
    &lt;meta content="text/html; charset=ISO-8859-1"
      http-equiv="Content-Type"&gt;
  &lt;/head&gt;
  &lt;body text="#000000" bgcolor="#FFFFFF"&gt;
    于 2011年10月26日 22:22, Luengffy XUE 写道:
    &lt;blockquote
cite="mid:CAOp97YCN6w4o_HHT_3ENmU-nmi=-HoeR62rerjTub6DdNVy4zw@mail.gmail.com"
      type="cite"&gt;&lt;span class="Apple-style-span" style="font-family:
        'UbuntuBeta Regular',Ubuntu,'Bitstream Vera Sans','DejaVu
        Sans',Tahoma,sans-serif; font-size: 12px; line-height: 18px;"&gt;
        &lt;pre style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace; margin-bottom: 0.8em; "&gt; &lt;/pre&gt;
        &lt;pre style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace; margin-bottom: 0.8em; "&gt;Hi, all&lt;/pre&gt;  &lt;pre style="color: rgb(51, \
51, 51); font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace; margin-bottom: \
0.8em; "&gt;I migrate a vm from source host to the destination host. &lt;/pre&gt;  &lt;pre \
style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', \
                monospace; margin-bottom: 0.8em; "&gt;I am sure every part is ok for \
                migration.&lt;/pre&gt;
        &lt;pre style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace; margin-bottom: 0.8em; "&gt; &lt;/pre&gt;
        &lt;pre style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace; margin-bottom: 0.8em; "&gt;1   Create the  image in the destination \
and change the user and group.&lt;/pre&gt;  &lt;pre style="color: rgb(51, 51, 51); \
font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace; margin-bottom: 0.8em; "&gt;2   \
                Open TCP socket in the destination host. &lt;/pre&gt;
        &lt;pre style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace; margin-bottom: 0.8em; "&gt; &lt;/pre&gt;
        &lt;pre style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace; margin-bottom: 0.8em; "&gt;and I migrate in the source host command \
line.   &lt;/pre&gt;  &lt;pre style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta \
Mono', 'Ubuntu Mono', monospace; margin-bottom: 0.8em; "&gt;$ virsh migrate --live \
                --copy-storage-all vmubuntu  qemu+ssh://destinationHost/system \
                --verbose&lt;/pre&gt;
        &lt;pre style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace; margin-bottom: 0.8em; "&gt;But I get the  error&lt;/pre&gt;  &lt;pre \
style="font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace; margin-bottom: \
0.8em; "&gt;&lt;span class="Apple-style-span" style="background-color: rgb(255, 255, 0); \
"&gt;&lt;font class="Apple-style-span" color="#ff0000"&gt;"error: operation failed : failed to \
retrieve chardev info inqemu with 'info chardev'" &lt;/font&gt;&lt;/span&gt;&lt;/pre&gt;  \
&lt;/span&gt;&lt;/blockquote&gt;  &lt;br&gt;
    Looks like you even failed on starting the domain. Could you confirm
    if you&lt;br&gt;
    guest is actually running well?&lt;br&gt;
    &lt;br&gt;
    &lt;blockquote
cite="mid:CAOp97YCN6w4o_HHT_3ENmU-nmi=-HoeR62rerjTub6DdNVy4zw@mail.gmail.com"
      type="cite"&gt;&lt;span class="Apple-style-span" style="font-family:
        'UbuntuBeta Regular', Ubuntu, 'Bitstream Vera Sans', 'DejaVu
        Sans', Tahoma, sans-serif; font-size: 12px; line-height: 18px; "&gt;
        &lt;pre style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace; margin-bottom: 0.8em; "&gt;In the destination I find in the \
                vmubuntu.log  &lt;/pre&gt;
        &lt;pre style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace; margin-bottom: 0.8em; "&gt;The error is &lt;/pre&gt;  &lt;pre \
style="font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace; margin-bottom: \
0.8em; "&gt;&lt;span class="Apple-style-span" style="background-color: rgb(255, 255, 0); \
"&gt;&lt;font class="Apple-style-span" color="#ff0000"&gt;"Migration failed. Exit code \
                tcp:0.0.0.0:49170(-98),exiting."&lt;/font&gt;&lt;/span&gt;&lt;/pre&gt;
        &lt;pre style="font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace; \
margin-bottom: 0.8em; "&gt;&lt;font class="Apple-style-span" color="#ff0000"&gt; &lt;/font&gt;&lt;/pre&gt;
        &lt;pre style="font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace; \
margin-bottom: 0.8em; "&gt;&lt;font class="Apple-style-span" color="#ff0000"&gt;&lt;span \
class="Apple-style-span" style="font-family: 'UbuntuBeta Regular', Ubuntu, 'Bitstream \
Vera Sans', 'DejaVu Sans', Tahoma, sans-serif; color: rgb(0, 0, 0); white-space: \
normal; "&gt;&lt;pre style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace; margin-bottom: 0.8em; "&gt;What can I do to solve it ? &lt;/pre&gt;&lt;pre \
style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace; margin-bottom: 0.8em; "&gt;I do not understand how the error comes.&lt;/pre&gt;&lt;pre \
style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace; margin-bottom: 0.8em; "&gt;Anyone can help me ?&lt;/pre&gt;&lt;pre style="color: \
rgb(51, 51, 51); font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace; \
                margin-bottom: 0.8em; "&gt;Thanks in advance. &lt;/pre&gt;&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;
        &lt;pre style="font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace; \
margin-bottom: 0.8em; "&gt;&lt;font class="Apple-style-span" color="#ff0000"&gt; &lt;/font&gt;&lt;/pre&gt;
      &lt;/span&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
  &lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20111027031612</emailId><senderName>Luengffy XUE</senderName><senderEmail>feiliangxue@gmail.com</senderEmail><timestampReceived>2011-10-27 03:16:12-0400</timestampReceived><subject>Re: [libvirt-users] live migration without shared storage problems.</subject><body>

Oh, I think I can describe the problem more specific.

1         Creat the vm in the source host and it run well.
2     Create the image in the destination and change the user and group
3 Open TCP socket in the destination host.

In the source host I use the different command as

1  $ virsh migrate --live --copy-storage-all vmubuntu
qemu+ssh://destinationHost/system --verbose

This situation, the error is:

In the source host:
 error:operation failed:migration job:unexpectedly failed
In the destiantion host: (from the vm.log)
 qemu:Warning: error while loading State ID section 2


&lt;http://blog.chinaunix.net/space.php?uid=26284395&amp;do=blog&amp;id=2980663&gt;


2    $ virsh migrate --live --copy-storage-all vmubuntu
qemu+ssh://destinationHost/system tcp://destinationHost:49170 --verbose

This situation, the error is:


In the source host:

error: operation failed : failed to retrieve chardev info inqemu with
'info chardev'

In the destiantion host: (from the vm.log)

Migration failed. Exit code tcp:0.0.0.0:49170(-98),exiting.




Can you help me ?  I google the error on the www . But I can not find the
proper solutions  or the same questions.

Thanks very much.
Best wishes.


2011/10/27 Osier Yang &lt;jyang@redhat.com&gt;

&gt;  ÓÚ 2011Äê10Ô 26ÈÕ 22:22, Luengffy XUE Ð´µÀ:
&gt;
&gt;  Hi, all
&gt;
&gt; I migrate a vm from source host to the destination host.
&gt;
&gt; I am sure every part is ok for migration.
&gt;
&gt;  1   Create the  image in the destination and change the user and group.
&gt;
&gt; 2   Open TCP socket in the destination host.
&gt;
&gt;  and I migrate in the source host command line.
&gt;
&gt; $ virsh migrate --live --copy-storage-all vmubuntu  qemu+ssh://destinationHost/system --verbose
&gt;
&gt; But I get the  error
&gt;
&gt; "error: operation failed : failed to retrieve chardev info inqemu with 'info chardev'"
&gt;
&gt;
&gt; Looks like you even failed on starting the domain. Could you confirm if you
&gt; guest is actually running well?
&gt;
&gt;  In the destination I find in the vmubuntu.log
&gt;
&gt; The error is
&gt;
&gt; "Migration failed. Exit code tcp:0.0.0.0:49170(-98),exiting."
&gt;
&gt;  What can I do to solve it ?
&gt;
&gt; I do not understand how the error comes.
&gt;
&gt; Anyone can help me ?
&gt;
&gt; Thanks in advance.
&gt;
&gt;
&gt;

[Attachment #3 (text/html)]

&lt;div&gt;Oh, I think I can describe the problem more specific.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;1 \
        Creat the vm in the source host and it run \
well.&lt;/div&gt;&lt;div&gt;2    &lt;span class="Apple-style-span" style="color: rgb(51, \
51, 51); font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace; \
font-size: 12px; line-height: 18px; white-space: pre; "&gt;   Create the  image in the \
destination and change the user and group&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span \
class="Apple-style-span" style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta \
Mono', 'Ubuntu Mono', monospace; font-size: 12px; line-height: 18px; \
white-space: pre; "&gt;&lt;/span&gt;&lt;span class="Apple-style-span" style="color: rgb(51, 51, \
51); font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace; \
font-size: 12px; line-height: 18px; white-space: pre; "&gt;3      Open TCP socket in the \
destination host.&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span class="Apple-style-span" style="color: \
rgb(51, 51, 51); font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace; font-size: 12px; line-height: 18px; white-space: pre; \
"&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span class="Apple-style-span" style="color: rgb(51, 51, 51); \
font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace; font-size: \
12px; line-height: 18px; white-space: pre; "&gt;In the source host I use the different \
command as&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span class="Apple-style-span" style="color: rgb(51, 51, \
51); font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace; \
font-size: 12px; line-height: 18px; white-space: pre; "&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
class="Apple-style-span" style="background-color: rgb(255, 255, 0);"&gt;&lt;font \
class="Apple-style-span" size="4"&gt;&lt;span class="Apple-style-span" style="color: \
rgb(51, 51, 51); font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace; line-height: 18px; white-space: pre; "&gt;1  &lt;/span&gt;&lt;span \
class="Apple-style-span" style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta \
Mono', 'Ubuntu Mono', monospace; line-height: 18px; white-space: pre; \
"&gt; &lt;/span&gt;&lt;span class="Apple-style-span" style="color: rgb(51, 51, 51); \
font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace; \
line-height: 18px; white-space: pre; "&gt;$ virsh migrate --live --copy-storage-all \
vmubuntu  qemu+ssh://destinationHost/system --verbose&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt; \
&lt;div&gt;&lt;span class="Apple-style-span" style="background-color: rgb(255, 255, 0);"&gt;&lt;span \
class="Apple-style-span" style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta \
Mono', 'Ubuntu Mono', monospace; font-size: 12px; line-height: 18px; \
white-space: pre; "&gt;&lt;br&gt; &lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" \
color="#333333" face="'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace"&gt;&lt;span class="Apple-style-span" style="font-size: 12px; line-height: 18px; \
white-space: pre;"&gt;This situation, the error is:&lt;/span&gt;&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font \
class="Apple-style-span" color="#333333" face="'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace"&gt;&lt;span class="Apple-style-span" style="font-size: 12px; \
line-height: 18px; white-space: pre;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font \
class="Apple-style-span" face="'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace"&gt;&lt;span class="Apple-style-span" style="font-size: 12px; line-height: 18px; \
white-space: pre; "&gt;&lt;font class="Apple-style-span" color="#ff6666"&gt;In the source \
host:&lt;/font&gt;&lt;font class="Apple-style-span" color="#333333"&gt; \
&lt;/font&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font class="Apple-style-span" face="'UbuntuBeta \
Mono', 'Ubuntu Mono', monospace"&gt;&lt;span class="Apple-style-span" \
style="font-size: 12px; line-height: 18px; white-space: pre; "&gt;&lt;font \
class="Apple-style-span" color="#333333"&gt;              &lt;/font&gt;&lt;font \
class="Apple-style-span" color="#ff9966" style="background-color: rgb(255, 255, 0);"&gt; \
error:operation failed:migration job:unexpectedly failed&lt;/font&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt; \
&lt;div&gt;&lt;font class="Apple-style-span" face="'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace" color="#ff6666"&gt;&lt;span class="Apple-style-span" \
style="font-size: 12px; line-height: 18px; white-space: pre; "&gt;In the destiantion \
host: (from the vm.log)&lt;/span&gt;&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font class="Apple-style-span" \
face="'UbuntuBeta Mono', 'Ubuntu Mono', monospace"&gt;&lt;span \
class="Apple-style-span" style="font-size: 12px; line-height: 18px; white-space: pre; \
"&gt;&lt;font class="Apple-style-span" color="#333333"&gt;               &lt;/font&gt;&lt;span \
class="Apple-style-span" style="background-color: rgb(255, 255, 0); "&gt;&lt;font \
class="Apple-style-span" color="#333333"&gt; &lt;/font&gt;&lt;font class="Apple-style-span" \
color="#ff6666"&gt;qemu:Warning: error while loading State ID section \
2&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font class="Apple-style-span" \
color="#333333" face="'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace"&gt;&lt;span class="Apple-style-span" style="font-size: 12px; line-height: 18px; \
white-space: pre;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font class="Apple-style-span" \
color="#333333" face="'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace"&gt;&lt;span class="Apple-style-span" style="font-size: 12px; line-height: 18px; \
white-space: pre;"&gt;&lt;a \
href="http://blog.chinaunix.net/space.php?uid=26284395&amp;do=blog&amp;id=2980663"&gt;&lt;br&gt;
 &lt;/a&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" color="#333333" \
face="'UbuntuBeta Mono', 'Ubuntu Mono', monospace"&gt;&lt;span \
class="Apple-style-span" style="font-size: 12px; line-height: 18px; white-space: pre; \
"&gt; &lt;/span&gt;&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;span class="Apple-style-span" \
style="background-color: rgb(255, 255, 0);"&gt;&lt;font class="Apple-style-span" size="4"&gt;2 \
   &lt;span class="Apple-style-span" style="color: rgb(51, 51, 51); \
font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace; \
line-height: 18px; white-space: pre; "&gt;$ virsh migrate --live --copy-storage-all \
vmubuntu  qemu+ssh://destinationHost/system tcp://destinationHost:49170 \
--verbose&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;div&gt; &lt;font class="Apple-style-span" color="#333333" \
face="'UbuntuBeta Mono', 'Ubuntu Mono', monospace"&gt;&lt;span \
class="Apple-style-span" style="font-size: 12px; line-height: 18px; white-space: \
pre;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font class="Apple-style-span" color="#333333" \
face="'UbuntuBeta Mono', 'Ubuntu Mono', monospace"&gt;&lt;span \
class="Apple-style-span" style="font-size: 12px; line-height: 18px; white-space: \
pre;"&gt;This situation, the error is:&lt;/span&gt;&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font \
class="Apple-style-span" color="#333333" face="'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace"&gt;&lt;span class="Apple-style-span" style="font-size: 12px; \
line-height: 18px; white-space: pre;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font \
class="Apple-style-span" color="#333333" face="'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace"&gt;&lt;span class="Apple-style-span" style="font-size: 12px; \
line-height: 18px; white-space: pre;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font \
class="Apple-style-span" color="#333333" face="'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace"&gt;&lt;div style="color: rgb(0, 0, 0); font-family: arial; font-size: \
small; line-height: normal; white-space: normal; "&gt; &lt;font class="Apple-style-span" \
face="'UbuntuBeta Mono', 'Ubuntu Mono', monospace"&gt;&lt;span \
class="Apple-style-span" style="font-size: 12px; line-height: 18px; white-space: pre; \
"&gt;&lt;font class="Apple-style-span" color="#ff6666"&gt;In the source host:&lt;/font&gt;&lt;font \
class="Apple-style-span" color="#333333"&gt; &lt;/font&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;span \
class="Apple-style-span" style="font-size: 12px; line-height: 18px; white-space: \
pre;"&gt;&lt;span class="Apple-style-span" style="border-collapse: collapse; font-family: \
arial, sans-serif; font-size: 13px; color: rgb(0, 0, 0); line-height: normal; \
white-space: normal; "&gt;&lt;blockquote type="cite"&gt; &lt;span style="font-family: \
'UbuntuBeta Regular', Ubuntu, 'Bitstream Vera Sans', 'DejaVu \
Sans', Tahoma, sans-serif; font-size: 12px; line-height: 18px; "&gt;&lt;pre \
style="white-space: pre-wrap; font-family: 'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace; margin-bottom: 0.8em; "&gt; &lt;span style="background-color: \
rgb(255, 255, 0); "&gt;&lt;font color="#ff0000"&gt;error: operation failed : failed to \
retrieve chardev info inqemu with 'info \
chardev'&lt;/font&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt; &lt;div \
style="color: rgb(0, 0, 0); font-family: arial; font-size: small; line-height: \
normal; white-space: normal; "&gt;&lt;font class="Apple-style-span" face="'UbuntuBeta \
Mono', 'Ubuntu Mono', monospace" color="#ff6666"&gt;&lt;span \
class="Apple-style-span" style="font-size: 12px; line-height: 18px; white-space: pre; \
"&gt;In the destiantion host: (from the vm.log)&lt;/span&gt;&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;span \
class="Apple-style-span" style="font-size: 12px; line-height: 18px; white-space: \
pre;"&gt;&lt;span class="Apple-style-span" style="border-collapse: collapse; font-family: \
arial, sans-serif; font-size: 13px; color: rgb(0, 0, 0); line-height: normal; \
white-space: normal; "&gt;&lt;blockquote type="cite"&gt; &lt;span style="font-family: \
'UbuntuBeta Regular', Ubuntu, 'Bitstream Vera Sans', 'DejaVu \
Sans', Tahoma, sans-serif; font-size: 12px; line-height: 18px; "&gt;&lt;pre \
style="white-space: pre-wrap; font-family: 'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace; margin-bottom: 0.8em; "&gt; &lt;span style="background-color: \
rgb(255, 255, 0); "&gt;&lt;font color="#ff0000"&gt;Migration failed. Exit code \
tcp:0.0.0.0:49170(-98),exiting.&lt;/font&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
class="Apple-style-span" color="#333333" face="'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace"&gt;&lt;span class="Apple-style-span" style="font-size: 12px; \
line-height: 18px; white-space: pre;"&gt;&lt;br&gt; \
&lt;/span&gt;&lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Can you help me ?  I google the \
error on the www . But I can not find the proper solutions  or the same \
questions.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks very much.&lt;/div&gt;&lt;div&gt;Best wishes.&lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;2011/10/27 Osier Yang &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:jyang@redhat.com"&gt;jyang@redhat.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt;

  
    
  
  &lt;div text="#000000" bgcolor="#FFFFFF"&gt;
    ÓÚ 2011Äê10Ô 26ÈÕ 22:22, Luengffy XUE Ð´µÀ:
    &lt;blockquote type="cite"&gt;&lt;span style="font-family:'UbuntuBeta \
Regular',Ubuntu,'Bitstream Vera Sans','DejaVu \
                Sans',Tahoma,sans-serif;font-size:12px;line-height:18px"&gt;
        &lt;pre style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', \
                'Ubuntu Mono', monospace;margin-bottom:0.8em"&gt;&lt;/pre&gt;
        &lt;pre style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', \
'Ubuntu Mono', monospace;margin-bottom:0.8em"&gt;Hi, all&lt;/pre&gt;  &lt;pre \
style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace;margin-bottom:0.8em"&gt;I migrate a vm from source host to the \
destination host. &lt;/pre&gt;  &lt;pre style="color:rgb(51, 51, \
51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
                monospace;margin-bottom:0.8em"&gt;I am sure every part is ok for \
                migration.&lt;/pre&gt;
        &lt;pre style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', \
'Ubuntu Mono', monospace;margin-bottom:0.8em"&gt;&lt;/pre&gt;  &lt;pre \
style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace;margin-bottom:0.8em"&gt;1   Create the  image in the destination \
and change the user and group.&lt;/pre&gt;  &lt;pre style="color:rgb(51, 51, \
51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt;2   Open TCP socket in the destination \
                host. &lt;/pre&gt;
        &lt;pre style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', \
'Ubuntu Mono', monospace;margin-bottom:0.8em"&gt;&lt;/pre&gt;  &lt;pre \
style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', 'Ubuntu \
Mono', monospace;margin-bottom:0.8em"&gt;and I migrate in the source host command \
line.   &lt;/pre&gt;  &lt;pre style="color:rgb(51, 51, 51);font-family:'UbuntuBeta \
Mono', 'Ubuntu Mono', monospace;margin-bottom:0.8em"&gt;$ virsh migrate \
--live --copy-storage-all vmubuntu  qemu+ssh://destinationHost/system --verbose&lt;/pre&gt;

        &lt;pre style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', \
'Ubuntu Mono', monospace;margin-bottom:0.8em"&gt;But I get the  error&lt;/pre&gt;  \
&lt;pre style="font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt;&lt;span style="background-color:rgb(255, 255, 0)"&gt;&lt;font \
color="#ff0000"&gt;"error: operation failed : failed to retrieve chardev info \
inqemu with 'info chardev'" &lt;/font&gt;&lt;/span&gt;&lt;/pre&gt;

      &lt;/span&gt;&lt;/blockquote&gt;
    &lt;br&gt;
    Looks like you even failed on starting the domain. Could you confirm
    if you&lt;br&gt;
    guest is actually running well?&lt;br&gt;
    &lt;br&gt;
    &lt;blockquote type="cite"&gt;&lt;span style="font-family:'UbuntuBeta Regular', \
Ubuntu, 'Bitstream Vera Sans', 'DejaVu Sans', Tahoma, \
sans-serif;font-size:12px;line-height:18px"&gt;  &lt;pre style="color:rgb(51, 51, \
51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
                monospace;margin-bottom:0.8em"&gt;In the destination I find in the \
                vmubuntu.log  &lt;/pre&gt;
        &lt;pre style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', \
'Ubuntu Mono', monospace;margin-bottom:0.8em"&gt;The error is &lt;/pre&gt;  &lt;pre \
style="font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt;&lt;span style="background-color:rgb(255, 255, 0)"&gt;&lt;font \
color="#ff0000"&gt;"Migration failed. Exit code \
tcp:0.0.0.0:49170(-98),exiting."&lt;/font&gt;&lt;/span&gt;&lt;/pre&gt;

        &lt;pre style="font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt;&lt;font color="#ff0000"&gt; &lt;/font&gt;&lt;/pre&gt;
        &lt;pre style="font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt;&lt;font color="#ff0000"&gt;&lt;span \
style="font-family:'UbuntuBeta Regular', Ubuntu, 'Bitstream Vera \
Sans', 'DejaVu Sans', Tahoma, sans-serif;color:rgb(0, 0, \
0);white-space:normal"&gt;&lt;pre style="color:rgb(51, 51, 51);font-family:'UbuntuBeta \
Mono', 'Ubuntu Mono', monospace;margin-bottom:0.8em"&gt; What can I do to \
solve it ? &lt;/pre&gt;&lt;pre style="color:rgb(51, 51, 51);font-family:'UbuntuBeta \
Mono', 'Ubuntu Mono', monospace;margin-bottom:0.8em"&gt;I do not understand \
how the error comes.&lt;/pre&gt;&lt;pre style="color:rgb(51, 51, \
51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt; Anyone can help me ?&lt;/pre&gt;&lt;pre style="color:rgb(51, \
51, 51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
                monospace;margin-bottom:0.8em"&gt;Thanks in advance. \
                &lt;/pre&gt;&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;
        &lt;pre style="font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt;&lt;font color="#ff0000"&gt; &lt;/font&gt;&lt;/pre&gt;
      &lt;/span&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
  &lt;/div&gt;

&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20111026151002</emailId><senderName>Bryan Kearney</senderName><senderEmail>bkearney@redhat.com</senderEmail><timestampReceived>2011-10-26 15:10:02-0400</timestampReceived><subject>Re: [libvirt-users] how to setup libvirt with java bindings for use</subject><body>

On 10/26/2011 09:39 AM, Dan Hirsch wrote:
&gt; Hi,
&gt; I would like to use libvirt to manipulate virtual machines of different
&gt; types (KVM, ESXi etc.)
&gt; I added dependencies to my project the libvirt and jna jars.
&gt; trying to execute your example code I am getting a run time exception saying
&gt; the library cann't be found.
&gt; it an actual libvirt c library is also required, and needs to be compiled
&gt; separately?
&gt;
&gt; can you please write down all needed steps for using libvirt with java
&gt; binding?
&gt;
&gt; thanks in advance.
&gt;

Yes, you should have libvirt installed and in the library in your path.
-- bk

</body></email><email><emailId>20111026141047</emailId><senderName>vmnode guy</senderName><senderEmail>vmnodeguy@gmail.com</senderEmail><timestampReceived>2011-10-26 14:10:47-0400</timestampReceived><subject>Re: [libvirt-users] virsh start VM failed</subject><body>

May i know what linux distribution, version, and version of libvirt you are
using ?

Regards,
Peter

On Wed, Oct 26, 2011 at 11:13 AM, =E9=82=B1=E6=95=8F=E9=88=B4 &lt;minling.ann@=
gmail.com&gt; wrote:

&gt; Dear,
&gt;
&gt; I encountered some problems when I used the virsh to start my virtual
&gt; machines. I had tried some ways but I still couldn't solve it.
&gt; Please help me, thanks.
&gt;
&gt; error messages :
&gt;
&gt; virsh # start controlnode
&gt; error: Failed to start domain controlnode
&gt; error: internal error process exited while connecting to monitor:
&gt; bind(unix:/var/lib/libvirt/qemu/controlnode.monitor): Permission denied
&gt; chardev: opening backend "socket" failed
&gt;
&gt;
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

[Attachment #3 (text/html)]

May i know what linux distribution, version, and version of libvirt you are using \
?&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;Peter&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Wed, \
Oct 26, 2011 at 11:13 AM, 邱敏鈴 &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:minling.ann@gmail.com"&gt;minling.ann@gmail.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt; \
&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt;Dear,&lt;br&gt;  &lt;br&gt;I encountered some problems when I used the \
virsh to start my virtual machines. I had tried some ways but I still couldn't \
solve it.&lt;br&gt; Please help me, thanks.&lt;br&gt;&lt;br&gt;error messages :&lt;br&gt;&lt;br&gt;&lt;span \
style="color:rgb(255, 0, 0)"&gt;virsh # start controlnode&lt;/span&gt;&lt;br \
style="color:rgb(255, 0, 0)"&gt; &lt;span style="color:rgb(255, 0, 0)"&gt;error: Failed to \
start domain controlnode&lt;/span&gt;&lt;br style="color:rgb(255, 0, 0)"&gt;&lt;span \
style="color:rgb(255, 0, 0)"&gt;error: internal error process exited while connecting to \
monitor: bind(unix:/var/lib/libvirt/qemu/controlnode.monitor): Permission \
denied&lt;/span&gt;&lt;br style="color:rgb(255, 0, 0)"&gt;

&lt;span style="color:rgb(255, 0, 0)"&gt;chardev: opening backend "socket" \
failed&lt;/span&gt;&lt;br&gt;&lt;br&gt;  &lt;br&gt;&lt;br&gt; \
&lt;br&gt;_______________________________________________&lt;br&gt; libvirt-users mailing \
list&lt;br&gt; &lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
&lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;




</body></email><email><emailId>20111025120008</emailId><senderName>vmnode guy</senderName><senderEmail>vmnodeguy@gmail.com</senderEmail><timestampReceived>2011-10-25 12:00:08-0400</timestampReceived><subject>[libvirt-users] Need help to compile libvirt-php</subject><body>

Hi guys,

I try to compile the libvirt-php but no luck, below are the output i got..

webserver:~/libvirt-php-0.4.3 # ./configure
checking for a BSD-compatible install... /usr/bin/install -c
checking whether build environment is sane... yes
checking for a thread-safe mkdir -p... /bin/mkdir -p
checking for gawk... gawk
checking whether make sets $(MAKE)... yes
checking for style of include used by make... GNU
checking for gcc... gcc
checking whether the C compiler works... yes
checking for C compiler default output file name... a.out
checking for suffix of executables...
checking whether we are cross compiling... no
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc accepts -g... yes
checking for gcc option to accept ISO C89... none needed
checking dependency style of gcc... none
checking for virConnectOpen in -lvirt... yes
checking dependency style of gcc... (cached) none
checking whether to disable maintainer-specific portions of Makefiles... yes
checking for gcc... (cached) gcc
checking whether we are using the GNU C compiler... (cached) yes
checking whether gcc accepts -g... (cached) yes
checking for gcc option to accept ISO C89... (cached) none needed
checking dependency style of gcc... (cached) none
checking for a sed that does not truncate output... /usr/bin/sed
checking for gawk... (cached) gawk
checking for echo... echo
checking for rm... rm
checking for pkg-config... /usr/bin/pkg-config
checking pkg-config is at least version 0.9.0... yes
checking for LIBXML... yes
checking for xsltproc... /usr/bin/xsltproc
checking for xmllint... /usr/bin/xmllint
checking for xmlcatalog... /usr/bin/xmlcatalog
checking for php-config... no
*configure: error: php-config not found; please install the PHP SDK*
webserver:~/libvirt-php-0.4.3 # ls /etc/php5/
apache2/ cli/     conf.d/
webserver:~/libvirt-php-0.4.3 # ls /etc/php5/apache2/
php.ini
webserver:~/libvirt-php-0.4.3 #

Regards,
Peter

[Attachment #3 (text/html)]

&lt;div&gt;Hi guys,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I try to compile the libvirt-php but=
 no luck, below are the output i got..&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;webserver:~=
/libvirt-php-0.4.3 # ./configure=A0&lt;/div&gt;&lt;div&gt;checking for a BSD-compatible=
 install... /usr/bin/install -c&lt;/div&gt;
&lt;div&gt;checking whether build environment is sane... yes&lt;/div&gt;&lt;div&gt;checking f=
or a thread-safe mkdir -p... /bin/mkdir -p&lt;/div&gt;
&lt;div&gt;checking for gawk... gawk&lt;/div&gt;&lt;div&gt;checking whether make sets $(MAKE)=
... yes&lt;/div&gt;&lt;div&gt;checking for style of include used by make... GNU&lt;/div&gt;&lt;d=
iv&gt;checking for gcc... gcc&lt;/div&gt;&lt;div&gt;checking whether the C compiler works.=
.. yes&lt;/div&gt;

&lt;div&gt;checking for C compiler default output file name... a.out&lt;/div&gt;&lt;div&gt;ch=
ecking for suffix of executables...=A0&lt;/div&gt;&lt;div&gt;checking whether we are cr=
oss compiling... no&lt;/div&gt;&lt;div&gt;checking for suffix of object files... o&lt;/div=
&gt;

&lt;div&gt;checking whether we are using the GNU C compiler... yes&lt;/div&gt;&lt;div&gt;chec=
king whether gcc accepts -g... yes&lt;/div&gt;&lt;div&gt;checking for gcc option to acc=
ept ISO C89... none needed&lt;/div&gt;&lt;div&gt;checking dependency style of gcc... no=
ne&lt;/div&gt;

&lt;div&gt;checking for virConnectOpen in -lvirt... yes&lt;/div&gt;&lt;div&gt;checking depend=
ency style of gcc... (cached) none&lt;/div&gt;&lt;div&gt;checking whether to disable ma=
intainer-specific portions of Makefiles... yes&lt;/div&gt;&lt;div&gt;checking for gcc..=
. (cached) gcc&lt;/div&gt;

&lt;div&gt;checking whether we are using the GNU C compiler... (cached) yes&lt;/div&gt;=
&lt;div&gt;checking whether gcc accepts -g... (cached) yes&lt;/div&gt;&lt;div&gt;checking for=
 gcc option to accept ISO C89... (cached) none needed&lt;/div&gt;&lt;div&gt;checking de=
pendency style of gcc... (cached) none&lt;/div&gt;

&lt;div&gt;checking for a sed that does not truncate output... /usr/bin/sed&lt;/div&gt;=
&lt;div&gt;checking for gawk... (cached) gawk&lt;/div&gt;&lt;div&gt;checking for echo... echo=
&lt;/div&gt;&lt;div&gt;checking for rm... rm&lt;/div&gt;&lt;div&gt;checking for pkg-config... /usr/=
bin/pkg-config&lt;/div&gt;

&lt;div&gt;checking pkg-config is at least version 0.9.0... yes&lt;/div&gt;&lt;div&gt;checkin=
g for LIBXML... yes&lt;/div&gt;&lt;div&gt;checking for xsltproc... /usr/bin/xsltproc&lt;/d=
iv&gt;&lt;div&gt;checking for xmllint... /usr/bin/xmllint&lt;/div&gt;&lt;div&gt;checking for xml=
catalog... /usr/bin/xmlcatalog&lt;/div&gt;

&lt;div&gt;checking for php-config... no&lt;/div&gt;&lt;div&gt;&lt;b&gt;configure: error: php-confi=
g not found; please install the PHP SDK&lt;/b&gt;&lt;/div&gt;&lt;div&gt;webserver:~/libvirt-p=
hp-0.4.3 # ls /etc/php5/&lt;/div&gt;&lt;div&gt;apache2/ cli/ =A0 =A0 conf.d/ =A0&lt;/div&gt;&lt;=
div&gt;
webserver:~/libvirt-php-0.4.3 # ls /etc/php5/apache2/&lt;/div&gt;
&lt;div&gt;php.ini&lt;/div&gt;&lt;div&gt;webserver:~/libvirt-php-0.4.3 #=A0&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/d=
iv&gt;&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;Peter=A0&lt;/div&gt;


</body></email><email><emailId>20111025120404</emailId><senderName>���� ���� ������</senderName><senderEmail>hetz@benhamo.org</senderEmail><timestampReceived>2011-10-25 12:04:04-0400</timestampReceived><subject>Re: [libvirt-users] Need help to compile libvirt-php</subject><body>

Hi,

Depending on which linux distribution you use, you'll need to install the
php development packages.
In Red Hat or Fedora it's php-devel while on ubuntu I think it's called
php5-dev or something like that.

Install and re-run ./configure

Good luck,
Hetz

2011/10/25 vmnode guy &lt;vmnodeguy@gmail.com&gt;

&gt; Hi guys,
&gt;
&gt; I try to compile the libvirt-php but no luck, below are the output i got..
&gt;
&gt; webserver:~/libvirt-php-0.4.3 # ./configure
&gt; checking for a BSD-compatible install... /usr/bin/install -c
&gt; checking whether build environment is sane... yes
&gt; checking for a thread-safe mkdir -p... /bin/mkdir -p
&gt; checking for gawk... gawk
&gt; checking whether make sets $(MAKE)... yes
&gt; checking for style of include used by make... GNU
&gt; checking for gcc... gcc
&gt; checking whether the C compiler works... yes
&gt; checking for C compiler default output file name... a.out
&gt; checking for suffix of executables...
&gt; checking whether we are cross compiling... no
&gt; checking for suffix of object files... o
&gt; checking whether we are using the GNU C compiler... yes
&gt; checking whether gcc accepts -g... yes
&gt; checking for gcc option to accept ISO C89... none needed
&gt; checking dependency style of gcc... none
&gt; checking for virConnectOpen in -lvirt... yes
&gt; checking dependency style of gcc... (cached) none
&gt; checking whether to disable maintainer-specific portions of Makefiles...
&gt; yes
&gt; checking for gcc... (cached) gcc
&gt; checking whether we are using the GNU C compiler... (cached) yes
&gt; checking whether gcc accepts -g... (cached) yes
&gt; checking for gcc option to accept ISO C89... (cached) none needed
&gt; checking dependency style of gcc... (cached) none
&gt; checking for a sed that does not truncate output... /usr/bin/sed
&gt; checking for gawk... (cached) gawk
&gt; checking for echo... echo
&gt; checking for rm... rm
&gt; checking for pkg-config... /usr/bin/pkg-config
&gt; checking pkg-config is at least version 0.9.0... yes
&gt; checking for LIBXML... yes
&gt; checking for xsltproc... /usr/bin/xsltproc
&gt; checking for xmllint... /usr/bin/xmllint
&gt; checking for xmlcatalog... /usr/bin/xmlcatalog
&gt; checking for php-config... no
&gt; *configure: error: php-config not found; please install the PHP SDK*
&gt; webserver:~/libvirt-php-0.4.3 # ls /etc/php5/
&gt; apache2/ cli/     conf.d/
&gt; webserver:~/libvirt-php-0.4.3 # ls /etc/php5/apache2/
&gt; php.ini
&gt; webserver:~/libvirt-php-0.4.3 #
&gt;
&gt; Regards,
&gt; Peter
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;



-- 
*���� ���� ������
����-������ (����������� ��)
*���������� ������������ ���� ���������� ������������
���������� ���������� �������������������� ���������������� �������������� �������������� *����� ����*
�������� ��������� �� ������������ hetz.biz &lt;http://www.hetz.biz/&gt; ������������ ����� ��:
blog.hetz.biz
������������: 0783333113/4/5, ������������: sales@hetz.biz
����� ��'��: sales@hetz.biz - ����������: heunique

[Attachment #3 (text/html)]

&lt;div dir="rtl"&gt;&lt;div dir="ltr"&gt;Hi,&lt;/div&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
dir="ltr"&gt;Depending on which linux distribution you use, you'll need to install \
the php development packages.&lt;/div&gt;&lt;div dir="ltr"&gt;In Red Hat or Fedora it's \
php-devel while on ubuntu I think it's called php5-dev or something like \
that.&lt;/div&gt; &lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="ltr"&gt;Install and re-run \
./configure&lt;/div&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="ltr"&gt;Good luck,&lt;/div&gt;&lt;div \
dir="ltr"&gt;Hetz&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div class="gmail_quote" dir="ltr"&gt;&lt;div&gt;2011/10/25 vmnode \
guy &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:vmnodeguy@gmail.com"&gt;vmnodeguy@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;/div&gt; \
&lt;blockquote class="gmail_quote" style="margin-top: 0px; margin-right: 0px; \
margin-bottom: 0px; margin-left: 0.8ex; border-left-width: 1px; border-left-color: \
rgb(204, 204, 204); border-left-style: solid; padding-left: 1ex; "&gt; &lt;div&gt;&lt;div&gt;Hi \
guys,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I try to compile the libvirt-php but no luck, below \
are the output i got..&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;webserver:~/libvirt-php-0.4.3 # \
./configure  &lt;/div&gt;&lt;div&gt;checking for a BSD-compatible install... /usr/bin/install \
-c&lt;/div&gt;

&lt;div&gt;checking whether build environment is sane... yes&lt;/div&gt;&lt;div&gt;checking for a \
thread-safe mkdir -p... /bin/mkdir -p&lt;/div&gt; &lt;div&gt;checking for gawk... \
gawk&lt;/div&gt;&lt;div&gt;checking whether make sets $(MAKE)... yes&lt;/div&gt;&lt;div&gt;checking for style \
of include used by make... GNU&lt;/div&gt;&lt;div&gt;checking for gcc... gcc&lt;/div&gt;&lt;div&gt;checking \
whether the C compiler works... yes&lt;/div&gt;


&lt;div&gt;checking for C compiler default output file name... a.out&lt;/div&gt;&lt;div&gt;checking for \
suffix of executables...  &lt;/div&gt;&lt;div&gt;checking whether we are cross compiling... \
no&lt;/div&gt;&lt;div&gt;checking for suffix of object files... o&lt;/div&gt;


&lt;div&gt;checking whether we are using the GNU C compiler... yes&lt;/div&gt;&lt;div&gt;checking \
whether gcc accepts -g... yes&lt;/div&gt;&lt;div&gt;checking for gcc option to accept ISO C89... \
none needed&lt;/div&gt;&lt;div&gt;checking dependency style of gcc... none&lt;/div&gt;


&lt;div&gt;checking for virConnectOpen in -lvirt... yes&lt;/div&gt;&lt;div&gt;checking dependency style \
of gcc... (cached) none&lt;/div&gt;&lt;div&gt;checking whether to disable maintainer-specific \
portions of Makefiles... yes&lt;/div&gt;&lt;div&gt;checking for gcc... (cached) gcc&lt;/div&gt;


&lt;div&gt;checking whether we are using the GNU C compiler... (cached) \
yes&lt;/div&gt;&lt;div&gt;checking whether gcc accepts -g... (cached) yes&lt;/div&gt;&lt;div&gt;checking for \
gcc option to accept ISO C89... (cached) none needed&lt;/div&gt;&lt;div&gt;checking dependency \
style of gcc... (cached) none&lt;/div&gt;


&lt;div&gt;checking for a sed that does not truncate output... \
/usr/bin/sed&lt;/div&gt;&lt;div&gt;checking for gawk... (cached) gawk&lt;/div&gt;&lt;div&gt;checking for \
echo... echo&lt;/div&gt;&lt;div&gt;checking for rm... rm&lt;/div&gt;&lt;div&gt;checking for pkg-config... \
/usr/bin/pkg-config&lt;/div&gt;


&lt;div&gt;checking pkg-config is at least version 0.9.0... yes&lt;/div&gt;&lt;div&gt;checking for \
LIBXML... yes&lt;/div&gt;&lt;div&gt;checking for xsltproc... /usr/bin/xsltproc&lt;/div&gt;&lt;div&gt;checking \
for xmllint... /usr/bin/xmllint&lt;/div&gt;&lt;div&gt;checking for xmlcatalog... \
/usr/bin/xmlcatalog&lt;/div&gt;


&lt;div&gt;checking for php-config... no&lt;/div&gt;&lt;div&gt;&lt;b&gt;configure: error: php-config not \
found; please install the PHP SDK&lt;/b&gt;&lt;/div&gt;&lt;div&gt;webserver:~/libvirt-php-0.4.3 # ls \
/etc/php5/&lt;/div&gt;&lt;div&gt;apache2/ cli/       conf.d/   &lt;/div&gt;&lt;div&gt;

webserver:~/libvirt-php-0.4.3 # ls /etc/php5/apache2/&lt;/div&gt;
&lt;div&gt;php.ini&lt;/div&gt;&lt;div&gt;webserver:~/libvirt-php-0.4.3 #  \
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;Peter  &lt;/div&gt; \
&lt;/div&gt;&lt;br&gt;_______________________________________________&lt;br&gt; libvirt-users mailing \
list&lt;br&gt; &lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
&lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;div \
dir="ltr"&gt;&lt;br&gt;&lt;br clear="all"&gt;&lt;/div&gt;&lt;div dir="ltr"&gt;&lt;br&gt; &lt;/div&gt;&lt;div dir="ltr"&gt;-- \
&lt;br&gt;&lt;/div&gt;&lt;div dir="ltr"&gt;&lt;div&gt;&lt;span style="font-family:Verdana, Arial, Helvetica, \
sans-serif;font-size:10px"&gt;&lt;strong&gt;&lt;span style="font-size:small"&gt;&lt;span \
style="color:rgb(0, 0, 128)"&gt;&lt;span style="color:rgb(0, 0, 0);font-weight:normal"&gt;���� \
���� ������&lt;/span&gt;&lt;br&gt; ��&lt;/span&gt;&lt;span style="color:rgb(0, 0, 255)"&gt;��&lt;/span&gt;-&lt;span \
style="color:rgb(0, 0, 128)"&gt;��&lt;/span&gt;&lt;span style="color:rgb(0, 0, \
255)"&gt;��&lt;/span&gt;&lt;span style="color:rgb(51, 102, 255)"&gt;��&lt;/span&gt;  (&lt;span \
style="color:rgb(128, 0, 0)"&gt;����������� ��&lt;/span&gt;)&lt;br&gt; &lt;/span&gt;&lt;/strong&gt;&lt;span \
style="font-size:small"&gt;���������� ������������ ���� ���������� \
������������&lt;br&gt;&lt;/span&gt;&lt;span style="font-size:small"&gt;���������� ���������� \
�������������������� ���������������� �������������� ��������������  &lt;b&gt;����� \
����&lt;/b&gt;&lt;br&gt;�������� ��������� �� ������������  &lt;a href="http://www.hetz.biz/" \
style="background-color:rgb(219, 216, 222)" target="_blank"&gt;hetz.biz&lt;/a&gt;  \
������������ ����� ��:  &lt;a href="http://blog.hetz.biz/" \
style="background-color:rgb(219, 216, 222)" target="_blank"&gt;blog.hetz.biz&lt;/a&gt;  &lt;br&gt; \
&lt;/span&gt;&lt;span style="font-size:small"&gt;������������: 0783333113/4/5, ������������:  &lt;a \
href="mailto:sales@hetz.biz" target="_blank"&gt;sales@hetz.biz&lt;/a&gt;  &lt;br&gt;&lt;/span&gt;&lt;span \
style="font-size:small"&gt;����� ��'��:  &lt;a href="mailto:sales@hetz.biz" \
target="_blank"&gt;sales@hetz.biz&lt;/a&gt;  - ����������: heunique&lt;/span&gt;&lt;/span&gt;&lt;br&gt; \
&lt;/div&gt;&lt;/div&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt; &lt;/div&gt;



</body></email><email><emailId>20111026140940</emailId><senderName>vmnode guy</senderName><senderEmail>vmnodeguy@gmail.com</senderEmail><timestampReceived>2011-10-26 14:09:40-0400</timestampReceived><subject>Re: [libvirt-users] Need help to compile libvirt-php</subject><body>

Thanks HetZ, it works now!

Regards,
Peter

On Tue, Oct 25, 2011 at 8:04 PM, =D7=97=D7=A5 =D7=91=D7=9F =D7=97=D7=9E=D7=
=95 &lt;hetz@benhamo.org&gt; wrote:

&gt; Hi,
&gt;
&gt; Depending on which linux distribution you use, you'll need to install the
&gt; php development packages.
&gt; In Red Hat or Fedora it's php-devel while on ubuntu I think it's called
&gt; php5-dev or something like that.
&gt;
&gt; Install and re-run ./configure
&gt;
&gt; Good luck,
&gt; Hetz
&gt;
&gt; 2011/10/25 vmnode guy &lt;vmnodeguy@gmail.com&gt;
&gt;
&gt;&gt; Hi guys,
&gt;&gt;
&gt;&gt; I try to compile the libvirt-php but no luck, below are the output i got=
..
&gt;&gt;
&gt;&gt; webserver:~/libvirt-php-0.4.3 # ./configure
&gt;&gt; checking for a BSD-compatible install... /usr/bin/install -c
&gt;&gt; checking whether build environment is sane... yes
&gt;&gt; checking for a thread-safe mkdir -p... /bin/mkdir -p
&gt;&gt; checking for gawk... gawk
&gt;&gt; checking whether make sets $(MAKE)... yes
&gt;&gt; checking for style of include used by make... GNU
&gt;&gt; checking for gcc... gcc
&gt;&gt; checking whether the C compiler works... yes
&gt;&gt; checking for C compiler default output file name... a.out
&gt;&gt; checking for suffix of executables...
&gt;&gt; checking whether we are cross compiling... no
&gt;&gt; checking for suffix of object files... o
&gt;&gt; checking whether we are using the GNU C compiler... yes
&gt;&gt; checking whether gcc accepts -g... yes
&gt;&gt; checking for gcc option to accept ISO C89... none needed
&gt;&gt; checking dependency style of gcc... none
&gt;&gt; checking for virConnectOpen in -lvirt... yes
&gt;&gt; checking dependency style of gcc... (cached) none
&gt;&gt; checking whether to disable maintainer-specific portions of Makefiles...
&gt;&gt; yes
&gt;&gt; checking for gcc... (cached) gcc
&gt;&gt; checking whether we are using the GNU C compiler... (cached) yes
&gt;&gt; checking whether gcc accepts -g... (cached) yes
&gt;&gt; checking for gcc option to accept ISO C89... (cached) none needed
&gt;&gt; checking dependency style of gcc... (cached) none
&gt;&gt; checking for a sed that does not truncate output... /usr/bin/sed
&gt;&gt; checking for gawk... (cached) gawk
&gt;&gt; checking for echo... echo
&gt;&gt; checking for rm... rm
&gt;&gt; checking for pkg-config... /usr/bin/pkg-config
&gt;&gt; checking pkg-config is at least version 0.9.0... yes
&gt;&gt; checking for LIBXML... yes
&gt;&gt; checking for xsltproc... /usr/bin/xsltproc
&gt;&gt; checking for xmllint... /usr/bin/xmllint
&gt;&gt; checking for xmlcatalog... /usr/bin/xmlcatalog
&gt;&gt; checking for php-config... no
&gt;&gt; *configure: error: php-config not found; please install the PHP SDK*
&gt;&gt; webserver:~/libvirt-php-0.4.3 # ls /etc/php5/
&gt;&gt; apache2/ cli/     conf.d/
&gt;&gt; webserver:~/libvirt-php-0.4.3 # ls /etc/php5/apache2/
&gt;&gt; php.ini
&gt;&gt; webserver:~/libvirt-php-0.4.3 #
&gt;&gt;
&gt;&gt; Regards,
&gt;&gt; Peter
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; libvirt-users mailing list
&gt;&gt; libvirt-users@redhat.com
&gt;&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;&gt;
&gt;
&gt;
&gt;
&gt; --
&gt; *=D7=97=D7=A5 =D7=91=D7=9F =D7=97=D7=9E=D7=95
&gt; =D7=97=D7=A5-=D7=91=D7=99=D7=96 (=D7=94=D7=95=D7=A1=D7=98=D7=99=D7=A0=D7=
=92)
&gt; *=D7=94=D7=A9=D7=9B=D7=A8=D7=94 =D7=95=D7=90=D7=99=D7=A8=D7=95=D7=97 =D7=
=A9=D7=9C =D7=A9=D7=A8=D7=AA=D7=99=D7=9D =D7=A4=D7=99=D7=96=D7=99=D7=99=D7=
=9D
&gt; =D7=94=D7=A9=D7=9B=D7=A8=D7=AA =D7=A9=D7=A8=D7=AA=D7=99=D7=9D =D7=95=D7=
=99=D7=A8=D7=98=D7=95=D7=90=D7=9C=D7=99=D7=99=D7=9D =D7=9E=D7=A7=D7=A6=D7=
=95=D7=A2=D7=99=D7=99=D7=9D =D7=95=D7=92=D7=93=D7=95=D7=9C=D7=99=D7=9D =D7=
=91=D7=9E=D7=97=D7=99=D7=A8=D7=99=D7=9D *=D7=A7=D7=98=D7=A0=D7=99=D7=9D*
&gt; =D7=91=D7=A7=D7=A8=D7=95 =D7=91=D7=90=D7=AA=D7=A8=D7=A0=D7=95 =D7=91=D7=
=9B=D7=AA=D7=95=D7=91=D7=AA hetz.biz &lt;http://www.hetz.biz/&gt; =D7=95=D7=91=D7=
=91=D7=9C=D7=95=D7=92 =D7=A9=D7=9C=D7=A0=D7=95:
&gt; blog.hetz.biz
&gt; =D7=98=D7=9C=D7=A4=D7=95=D7=9F=D7=9F: 0783333113/4/5, =D7=90=D7=99=D7=9E=
=D7=99=D7=99=D7=9C: sales@hetz.biz
&gt; =D7=9E=D7=A1=D7=A0=D7=92'=D7=A8: sales@hetz.biz - =D7=A1=D7=A7=D7=99=D7=
=99=D7=A4: heunique
&gt;
&gt;

[Attachment #3 (text/html)]

Thanks HetZ, it works \
now!&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;Peter&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;On Tue, Oct 25, 2011 at 8:04 PM, ���� ���� ������ &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:hetz@benhamo.org"&gt;hetz@benhamo.org&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt; &lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt;&lt;div dir="rtl"&gt;&lt;div dir="ltr"&gt;Hi,&lt;/div&gt;&lt;div \
dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="ltr"&gt;Depending on which linux distribution you use, \
you'll need to install the php development packages.&lt;/div&gt; &lt;div dir="ltr"&gt;In Red \
Hat or Fedora it's php-devel while on ubuntu I think it's called php5-dev or \
something like that.&lt;/div&gt; &lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="ltr"&gt;Install and re-run \
./configure&lt;/div&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="ltr"&gt;Good luck,&lt;/div&gt;&lt;div \
dir="ltr"&gt;Hetz&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div class="gmail_quote" dir="ltr"&gt;&lt;div&gt;2011/10/25 vmnode \
guy &lt;span dir="ltr"&gt;&lt;&lt;a href="mailto:vmnodeguy@gmail.com" \
target="_blank"&gt;vmnodeguy@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;/div&gt;

&lt;blockquote class="gmail_quote" \
style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0.8ex;border-left-width:1px;border-left-color:rgb(204, \
204, 204);border-left-style:solid;padding-left:1ex"&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt; &lt;div class="h5"&gt;
&lt;div&gt;&lt;div&gt;Hi guys,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I try to compile the libvirt-php but no \
luck, below are the output i \
got..&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;webserver:~/libvirt-php-0.4.3 # ./configure  \
&lt;/div&gt;&lt;div&gt;checking for a BSD-compatible install... /usr/bin/install -c&lt;/div&gt;


&lt;div&gt;checking whether build environment is sane... yes&lt;/div&gt;&lt;div&gt;checking for a \
thread-safe mkdir -p... /bin/mkdir -p&lt;/div&gt; &lt;div&gt;checking for gawk... \
gawk&lt;/div&gt;&lt;div&gt;checking whether make sets $(MAKE)... yes&lt;/div&gt;&lt;div&gt;checking for style \
of include used by make... GNU&lt;/div&gt;&lt;div&gt;checking for gcc... gcc&lt;/div&gt;&lt;div&gt;checking \
whether the C compiler works... yes&lt;/div&gt;



&lt;div&gt;checking for C compiler default output file name... a.out&lt;/div&gt;&lt;div&gt;checking for \
suffix of executables...  &lt;/div&gt;&lt;div&gt;checking whether we are cross compiling... \
no&lt;/div&gt;&lt;div&gt;checking for suffix of object files... o&lt;/div&gt;



&lt;div&gt;checking whether we are using the GNU C compiler... yes&lt;/div&gt;&lt;div&gt;checking \
whether gcc accepts -g... yes&lt;/div&gt;&lt;div&gt;checking for gcc option to accept ISO C89... \
none needed&lt;/div&gt;&lt;div&gt;checking dependency style of gcc... none&lt;/div&gt;



&lt;div&gt;checking for virConnectOpen in -lvirt... yes&lt;/div&gt;&lt;div&gt;checking dependency style \
of gcc... (cached) none&lt;/div&gt;&lt;div&gt;checking whether to disable maintainer-specific \
portions of Makefiles... yes&lt;/div&gt;&lt;div&gt;checking for gcc... (cached) gcc&lt;/div&gt;



&lt;div&gt;checking whether we are using the GNU C compiler... (cached) \
yes&lt;/div&gt;&lt;div&gt;checking whether gcc accepts -g... (cached) yes&lt;/div&gt;&lt;div&gt;checking for \
gcc option to accept ISO C89... (cached) none needed&lt;/div&gt;&lt;div&gt;checking dependency \
style of gcc... (cached) none&lt;/div&gt;



&lt;div&gt;checking for a sed that does not truncate output... \
/usr/bin/sed&lt;/div&gt;&lt;div&gt;checking for gawk... (cached) gawk&lt;/div&gt;&lt;div&gt;checking for \
echo... echo&lt;/div&gt;&lt;div&gt;checking for rm... rm&lt;/div&gt;&lt;div&gt;checking for pkg-config... \
/usr/bin/pkg-config&lt;/div&gt;



&lt;div&gt;checking pkg-config is at least version 0.9.0... yes&lt;/div&gt;&lt;div&gt;checking for \
LIBXML... yes&lt;/div&gt;&lt;div&gt;checking for xsltproc... /usr/bin/xsltproc&lt;/div&gt;&lt;div&gt;checking \
for xmllint... /usr/bin/xmllint&lt;/div&gt;&lt;div&gt;checking for xmlcatalog... \
/usr/bin/xmlcatalog&lt;/div&gt;



&lt;div&gt;checking for php-config... no&lt;/div&gt;&lt;div&gt;&lt;b&gt;configure: error: php-config not \
found; please install the PHP SDK&lt;/b&gt;&lt;/div&gt;&lt;div&gt;webserver:~/libvirt-php-0.4.3 # ls \
/etc/php5/&lt;/div&gt;&lt;div&gt;apache2/ cli/       conf.d/   &lt;/div&gt;&lt;div&gt;


webserver:~/libvirt-php-0.4.3 # ls /etc/php5/apache2/&lt;/div&gt;
&lt;div&gt;php.ini&lt;/div&gt;&lt;div&gt;webserver:~/libvirt-php-0.4.3 #  \
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;Peter  &lt;/div&gt; \
&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;_______________________________________________&lt;br&gt; \
libvirt-users mailing list&lt;br&gt; &lt;a href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt; &lt;a \
href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;font \
color="#888888"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;br clear="all"&gt;&lt;/div&gt; &lt;div dir="ltr"&gt;&lt;br&gt;
&lt;/div&gt;&lt;div dir="ltr"&gt;-- &lt;br&gt;&lt;/div&gt;&lt;div dir="ltr"&gt;&lt;div&gt;&lt;span \
style="font-family:Verdana, Arial, Helvetica, \
sans-serif;font-size:10px"&gt;&lt;strong&gt;&lt;span style="font-size:small"&gt;&lt;span \
style="color:rgb(0, 0, 128)"&gt;&lt;span style="color:rgb(0, 0, 0);font-weight:normal"&gt;���� \
���� ������&lt;/span&gt;&lt;br&gt;

��&lt;/span&gt;&lt;span style="color:rgb(0, 0, 255)"&gt;��&lt;/span&gt;-&lt;span style="color:rgb(0, 0, \
128)"&gt;��&lt;/span&gt;&lt;span style="color:rgb(0, 0, 255)"&gt;��&lt;/span&gt;&lt;span style="color:rgb(51, \
102, 255)"&gt;��&lt;/span&gt;  (&lt;span style="color:rgb(128, 0, 0)"&gt;����������� ��&lt;/span&gt;)&lt;br&gt;

&lt;/span&gt;&lt;/strong&gt;&lt;span style="font-size:small"&gt;���������� ������������ ���� ���������� \
������������&lt;br&gt;&lt;/span&gt;&lt;span style="font-size:small"&gt;���������� ���������� \
�������������������� ���������������� �������������� ��������������  &lt;b&gt;����� \
����&lt;/b&gt;&lt;br&gt;�������� ��������� �� ������������  &lt;a href="http://www.hetz.biz/" \
style="background-color:rgb(219, 216, 222)" target="_blank"&gt;hetz.biz&lt;/a&gt;  \
������������ ����� ��:  &lt;a href="http://blog.hetz.biz/" \
style="background-color:rgb(219, 216, 222)" target="_blank"&gt;blog.hetz.biz&lt;/a&gt;  &lt;br&gt;

&lt;/span&gt;&lt;span style="font-size:small"&gt;������������: 0783333113/4/5, ������������:  &lt;a \
href="mailto:sales@hetz.biz" target="_blank"&gt;sales@hetz.biz&lt;/a&gt;  &lt;br&gt;&lt;/span&gt;&lt;span \
style="font-size:small"&gt;����� ��'��:  &lt;a href="mailto:sales@hetz.biz" \
target="_blank"&gt;sales@hetz.biz&lt;/a&gt;  - ����������: heunique&lt;/span&gt;&lt;/span&gt;&lt;br&gt;

&lt;/div&gt;&lt;/div&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20111026153142</emailId><senderName>vmnode guy</senderName><senderEmail>vmnodeguy@gmail.com</senderEmail><timestampReceived>2011-10-26 15:31:42-0400</timestampReceived><subject>Re: [libvirt-users] Need help to compile libvirt-php</subject><body>

Hello HetZ,

I try the put in the example and try run, but it's don't seem to be works.

Do you have the same problem, do you know how should i proceed ?

root@cn1:/var/www# cat info.php
&lt;?php

     print_r ( libvirt_version() );

        $conn = libvirt_connect('null', false);
//      $conn = libvirt_connect('qemu+ssh://root@10.0.0.122/system', false);
        echo $conn;
        $doms = libvirt_list_domains($conn);
        print_r($doms);

?&gt;
root@cn1:/var/www#

It doesn't show any output..

I also put this example into a file log.php and run it.

&lt;?php
    $logfile = 'test.log';

    unlink($logfile);
    if (!libvirt_logfile_set($logfile))
         die('Cannot set the log file');

    $conn = libvirt_connect('null', false);
    unset($conn);

    $fp = fopen($logfile, 'r');
    $str = fread($fp, filesize($logfile));
    fclose($fp);

    echo $str;
?&gt;

It does generate a file and show error..
[Wed Oct 26 23:17:07 2011] [error] [client 10.0.0.201] PHP Warning:
 libvirt_connect(): Failed to connect socket to
'@/var/www/.libvirt/libvirt-sock': Connection refused in /var/www/log.php on
line 8
[2011-10-26 23:17:07 libvirt-php/core]: libvirt_connect: Cannot establish
connection to (null)


My /var/www directory is like below:-
root@cloudnode1:/var/www# ls -laR
.:
total 36
drwxr-xr-x  4 www-data www-data 4096 2011-10-26 23:20 .
drwxr-xr-x 15 root     root     4096 2011-10-26 22:40 ..
-rw-r--r--  1 www-data www-data  177 2011-10-26 22:40 index.html
-rw-r--r--  1 www-data www-data  229 2011-10-26 23:16 info.php
drwxr-xr-x  2 root     root     4096 2011-10-26 23:15 .libvirt
-rw-r--r--  1 www-data www-data  313 2011-10-26 22:59 log.php
drwx------  2 www-data www-data 4096 2011-10-26 23:12 .ssh
-rw-r--r--  1 www-data www-data 4619 2011-10-26 23:17 test.log

./.libvirt:
total 8
drwxr-xr-x 2 root     root     4096 2011-10-26 23:15 .
drwxr-xr-x 4 www-data www-data 4096 2011-10-26 23:20 ..
lrwxrwxrwx 1 www-data www-data   29 2011-10-26 23:02 .libvirt-sock -&gt;
/var/run/libvirt/libvirt-sock

./.ssh:
total 16
drwx------ 2 www-data www-data 4096 2011-10-26 23:12 .
drwxr-xr-x 4 www-data www-data 4096 2011-10-26 23:20 ..
-rw------- 1 www-data www-data 1675 2011-10-26 23:11 id_rsa
-rw-r--r-- 1 www-data www-data  401 2011-10-26 23:11 id_rsa.pub
root@cloudnode1:/var/www#


Regards,
Peter

On Wed, Oct 26, 2011 at 10:09 PM, vmnode guy &lt;vmnodeguy@gmail.com&gt; wrote:

&gt; Thanks HetZ, it works now!
&gt;
&gt; Regards,
&gt; Peter
&gt;
&gt;
&gt; On Tue, Oct 25, 2011 at 8:04 PM, ���� ���� ������ &lt;hetz@benhamo.org&gt; wrote:
&gt;
&gt;&gt; Hi,
&gt;&gt;
&gt;&gt; Depending on which linux distribution you use, you'll need to install the
&gt;&gt; php development packages.
&gt;&gt; In Red Hat or Fedora it's php-devel while on ubuntu I think it's called
&gt;&gt; php5-dev or something like that.
&gt;&gt;
&gt;&gt; Install and re-run ./configure
&gt;&gt;
&gt;&gt; Good luck,
&gt;&gt; Hetz
&gt;&gt;
&gt;&gt; 2011/10/25 vmnode guy &lt;vmnodeguy@gmail.com&gt;
&gt;&gt;
&gt;&gt;&gt;  Hi guys,
&gt;&gt;&gt;
&gt;&gt;&gt; I try to compile the libvirt-php but no luck, below are the output i
&gt;&gt;&gt; got..
&gt;&gt;&gt;
&gt;&gt;&gt; webserver:~/libvirt-php-0.4.3 # ./configure
&gt;&gt;&gt; checking for a BSD-compatible install... /usr/bin/install -c
&gt;&gt;&gt; checking whether build environment is sane... yes
&gt;&gt;&gt; checking for a thread-safe mkdir -p... /bin/mkdir -p
&gt;&gt;&gt; checking for gawk... gawk
&gt;&gt;&gt; checking whether make sets $(MAKE)... yes
&gt;&gt;&gt; checking for style of include used by make... GNU
&gt;&gt;&gt; checking for gcc... gcc
&gt;&gt;&gt; checking whether the C compiler works... yes
&gt;&gt;&gt; checking for C compiler default output file name... a.out
&gt;&gt;&gt; checking for suffix of executables...
&gt;&gt;&gt; checking whether we are cross compiling... no
&gt;&gt;&gt; checking for suffix of object files... o
&gt;&gt;&gt; checking whether we are using the GNU C compiler... yes
&gt;&gt;&gt; checking whether gcc accepts -g... yes
&gt;&gt;&gt; checking for gcc option to accept ISO C89... none needed
&gt;&gt;&gt; checking dependency style of gcc... none
&gt;&gt;&gt; checking for virConnectOpen in -lvirt... yes
&gt;&gt;&gt; checking dependency style of gcc... (cached) none
&gt;&gt;&gt; checking whether to disable maintainer-specific portions of Makefiles...
&gt;&gt;&gt; yes
&gt;&gt;&gt; checking for gcc... (cached) gcc
&gt;&gt;&gt; checking whether we are using the GNU C compiler... (cached) yes
&gt;&gt;&gt; checking whether gcc accepts -g... (cached) yes
&gt;&gt;&gt; checking for gcc option to accept ISO C89... (cached) none needed
&gt;&gt;&gt; checking dependency style of gcc... (cached) none
&gt;&gt;&gt; checking for a sed that does not truncate output... /usr/bin/sed
&gt;&gt;&gt; checking for gawk... (cached) gawk
&gt;&gt;&gt; checking for echo... echo
&gt;&gt;&gt; checking for rm... rm
&gt;&gt;&gt; checking for pkg-config... /usr/bin/pkg-config
&gt;&gt;&gt; checking pkg-config is at least version 0.9.0... yes
&gt;&gt;&gt; checking for LIBXML... yes
&gt;&gt;&gt; checking for xsltproc... /usr/bin/xsltproc
&gt;&gt;&gt; checking for xmllint... /usr/bin/xmllint
&gt;&gt;&gt; checking for xmlcatalog... /usr/bin/xmlcatalog
&gt;&gt;&gt; checking for php-config... no
&gt;&gt;&gt; *configure: error: php-config not found; please install the PHP SDK*
&gt;&gt;&gt; webserver:~/libvirt-php-0.4.3 # ls /etc/php5/
&gt;&gt;&gt; apache2/ cli/     conf.d/
&gt;&gt;&gt; webserver:~/libvirt-php-0.4.3 # ls /etc/php5/apache2/
&gt;&gt;&gt; php.ini
&gt;&gt;&gt; webserver:~/libvirt-php-0.4.3 #
&gt;&gt;&gt;
&gt;&gt;&gt; Regards,
&gt;&gt;&gt; Peter
&gt;&gt;&gt;
&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt; libvirt-users mailing list
&gt;&gt;&gt; libvirt-users@redhat.com
&gt;&gt;&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; --
&gt;&gt; *���� ���� ������
&gt;&gt; ����-������ (����������� ��)
&gt;&gt; *���������� ������������ ���� ���������� ������������
&gt;&gt; ���������� ���������� �������������������� ���������������� �������������� �������������� *����� ����*
&gt;&gt; �������� ��������� �� ������������ hetz.biz &lt;http://www.hetz.biz/&gt; ������������ ����� ��:
&gt;&gt; blog.hetz.biz
&gt;&gt; ������������: 0783333113/4/5, ������������: sales@hetz.biz
&gt;&gt; ����� ��'��: sales@hetz.biz - ����������: heunique
&gt;&gt;
&gt;&gt;
&gt;

[Attachment #3 (text/html)]

&lt;meta http-equiv="content-type" content="text/html; charset=utf-8"&gt;&lt;span \
class="Apple-style-span" style="border-collapse: collapse; font-family: arial, \
sans-serif; font-size: 13px; "&gt;Hello HetZ,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I try the put in the \
example and try run, but it's don't seem to be works.&lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Do you have the same problem, do you know how should i proceed \
?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;root@cn1:/var/www# cat info.php  \
&lt;/div&gt;&lt;div&gt;&lt;?php&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;        print_r ( libvirt_version() \
);&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;            $conn = libvirt_connect('null', \
false);&lt;/div&gt;&lt;div&gt;//         $conn = libvirt_connect('qemu+ssh://&lt;a \
href="http://root@10.0.0.122/system" target="_blank" style="color: rgb(0, 0, 204); \
"&gt;root@10.0.0.122/system&lt;/a&gt;', false);&lt;/div&gt; &lt;div&gt;            echo \
$conn;&lt;/div&gt;&lt;div&gt;            $doms = libvirt_list_domains($conn);&lt;/div&gt;&lt;div&gt;          \
print_r($doms);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;?&gt;&lt;/div&gt;&lt;div&gt;root@cn1:/var/www#  \
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;It doesn't show any output..&lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I also put this example into a file log.php and run \
it.&lt;/div&gt;&lt;div&gt;  &lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;?php&lt;/div&gt;&lt;div&gt;      $logfile = \
'test.log';&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;      unlink($logfile);&lt;/div&gt;&lt;div&gt;      \
if (!libvirt_logfile_set($logfile))&lt;/div&gt; &lt;div&gt;              die('Cannot set the \
log file');&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;      $conn = \
libvirt_connect('null', false);&lt;/div&gt;&lt;div&gt;      \
unset($conn);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;      $fp = fopen($logfile, \
'r');&lt;/div&gt; &lt;div&gt;      $str = fread($fp, filesize($logfile));&lt;/div&gt;&lt;div&gt;      \
fclose($fp);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;      echo \
$str;&lt;/div&gt;&lt;div&gt;?&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;It does generate a file and show \
error..  &lt;/div&gt;&lt;div&gt;&lt;div&gt;[Wed Oct 26 23:17:07 2011] [error] [client 10.0.0.201] PHP \
Warning:   libvirt_connect(): Failed to connect socket to \
'@/var/www/.libvirt/libvirt-sock': Connection refused in /var/www/log.php on \
line 8&lt;/div&gt; &lt;div&gt;[2011-10-26 23:17:07 libvirt-php/core]: libvirt_connect: Cannot \
establish connection to (null)&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;My \
/var/www directory is like below:-&lt;/div&gt;&lt;div&gt;&lt;div&gt;root@cloudnode1:/var/www# ls \
-laR&lt;/div&gt; &lt;div&gt;.:&lt;/div&gt;&lt;div&gt;total 36&lt;/div&gt;&lt;div&gt;drwxr-xr-x   4 www-data www-data 4096 \
2011-10-26 23:20 .&lt;/div&gt;&lt;div&gt;drwxr-xr-x 15 root       root       4096 2011-10-26 \
22:40 ..&lt;/div&gt;&lt;div&gt;-rw-r--r--   1 www-data www-data   177 2011-10-26 22:40 \
index.html&lt;/div&gt; &lt;div&gt;-rw-r--r--   1 www-data www-data   229 2011-10-26 23:16 \
info.php&lt;/div&gt;&lt;div&gt;drwxr-xr-x   2 root       root       4096 2011-10-26 23:15 \
.libvirt&lt;/div&gt;&lt;div&gt;-rw-r--r--   1 www-data www-data   313 2011-10-26 22:59 \
log.php&lt;/div&gt;&lt;div&gt; drwx------   2 www-data www-data 4096 2011-10-26 23:12 \
.ssh&lt;/div&gt;&lt;div&gt;-rw-r--r--   1 www-data www-data 4619 2011-10-26 23:17 \
test.log&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;./.libvirt:&lt;/div&gt;&lt;div&gt;total 8&lt;/div&gt;&lt;div&gt;drwxr-xr-x \
2 root       root       4096 2011-10-26 23:15 .&lt;/div&gt; &lt;div&gt;drwxr-xr-x 4 www-data \
www-data 4096 2011-10-26 23:20 ..&lt;/div&gt;&lt;div&gt;lrwxrwxrwx 1 www-data www-data    29 \
2011-10-26 23:02 .libvirt-sock -&gt; \
/var/run/libvirt/libvirt-sock&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;./.ssh:&lt;/div&gt;&lt;div&gt;total \
16&lt;/div&gt; &lt;div&gt;drwx------ 2 www-data www-data 4096 2011-10-26 23:12 \
.&lt;/div&gt;&lt;div&gt;drwxr-xr-x 4 www-data www-data 4096 2011-10-26 23:20 \
..&lt;/div&gt;&lt;div&gt;-rw------- 1 www-data www-data 1675 2011-10-26 23:11 \
id_rsa&lt;/div&gt;&lt;div&gt;-rw-r--r-- 1 www-data www-data   401 2011-10-26 23:11 \
id_rsa.pub&lt;/div&gt; &lt;div&gt;root@cloudnode1:/var/www#  \
&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;Peter&lt;/div&gt;&lt;/div&gt;&lt;/span&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;On Wed, Oct 26, 2011 at 10:09 PM, vmnode guy &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:vmnodeguy@gmail.com"&gt;vmnodeguy@gmail.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt; &lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt;Thanks HetZ, it works \
now!&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;Peter&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div \
class="h5"&gt;&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt; On Tue, Oct 25, 2011 at 8:04 PM, \
���� ���� ������ &lt;span dir="ltr"&gt;&lt;&lt;a href="mailto:hetz@benhamo.org" \
target="_blank"&gt;hetz@benhamo.org&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt; &lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex"&gt;&lt;div dir="rtl"&gt;&lt;div dir="ltr"&gt;Hi,&lt;/div&gt;&lt;div \
dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="ltr"&gt;Depending on which linux distribution you use, \
you'll need to install the php development packages.&lt;/div&gt;

&lt;div dir="ltr"&gt;In Red Hat or Fedora it's php-devel while on ubuntu I think \
it's called php5-dev or something like that.&lt;/div&gt; &lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
dir="ltr"&gt;Install and re-run ./configure&lt;/div&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
dir="ltr"&gt;Good luck,&lt;/div&gt;&lt;div dir="ltr"&gt;Hetz&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div class="gmail_quote" \
dir="ltr"&gt;&lt;div&gt;2011/10/25 vmnode guy &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:vmnodeguy@gmail.com" \
target="_blank"&gt;vmnodeguy@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;/div&gt;


&lt;blockquote class="gmail_quote" \
style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0.8ex;border-left-width:1px;border-left-color:rgb(204, \
204, 204);border-left-style:solid;padding-left:1ex"&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;

&lt;div&gt;
&lt;div&gt;&lt;div&gt;Hi guys,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I try to compile the libvirt-php but no \
luck, below are the output i \
got..&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;webserver:~/libvirt-php-0.4.3 # ./configure  \
&lt;/div&gt;&lt;div&gt;checking for a BSD-compatible install... /usr/bin/install -c&lt;/div&gt;



&lt;div&gt;checking whether build environment is sane... yes&lt;/div&gt;&lt;div&gt;checking for a \
thread-safe mkdir -p... /bin/mkdir -p&lt;/div&gt; &lt;div&gt;checking for gawk... \
gawk&lt;/div&gt;&lt;div&gt;checking whether make sets $(MAKE)... yes&lt;/div&gt;&lt;div&gt;checking for style \
of include used by make... GNU&lt;/div&gt;&lt;div&gt;checking for gcc... gcc&lt;/div&gt;&lt;div&gt;checking \
whether the C compiler works... yes&lt;/div&gt;




&lt;div&gt;checking for C compiler default output file name... a.out&lt;/div&gt;&lt;div&gt;checking for \
suffix of executables...  &lt;/div&gt;&lt;div&gt;checking whether we are cross compiling... \
no&lt;/div&gt;&lt;div&gt;checking for suffix of object files... o&lt;/div&gt;




&lt;div&gt;checking whether we are using the GNU C compiler... yes&lt;/div&gt;&lt;div&gt;checking \
whether gcc accepts -g... yes&lt;/div&gt;&lt;div&gt;checking for gcc option to accept ISO C89... \
none needed&lt;/div&gt;&lt;div&gt;checking dependency style of gcc... none&lt;/div&gt;




&lt;div&gt;checking for virConnectOpen in -lvirt... yes&lt;/div&gt;&lt;div&gt;checking dependency style \
of gcc... (cached) none&lt;/div&gt;&lt;div&gt;checking whether to disable maintainer-specific \
portions of Makefiles... yes&lt;/div&gt;&lt;div&gt;checking for gcc... (cached) gcc&lt;/div&gt;




&lt;div&gt;checking whether we are using the GNU C compiler... (cached) \
yes&lt;/div&gt;&lt;div&gt;checking whether gcc accepts -g... (cached) yes&lt;/div&gt;&lt;div&gt;checking for \
gcc option to accept ISO C89... (cached) none needed&lt;/div&gt;&lt;div&gt;checking dependency \
style of gcc... (cached) none&lt;/div&gt;




&lt;div&gt;checking for a sed that does not truncate output... \
/usr/bin/sed&lt;/div&gt;&lt;div&gt;checking for gawk... (cached) gawk&lt;/div&gt;&lt;div&gt;checking for \
echo... echo&lt;/div&gt;&lt;div&gt;checking for rm... rm&lt;/div&gt;&lt;div&gt;checking for pkg-config... \
/usr/bin/pkg-config&lt;/div&gt;




&lt;div&gt;checking pkg-config is at least version 0.9.0... yes&lt;/div&gt;&lt;div&gt;checking for \
LIBXML... yes&lt;/div&gt;&lt;div&gt;checking for xsltproc... /usr/bin/xsltproc&lt;/div&gt;&lt;div&gt;checking \
for xmllint... /usr/bin/xmllint&lt;/div&gt;&lt;div&gt;checking for xmlcatalog... \
/usr/bin/xmlcatalog&lt;/div&gt;




&lt;div&gt;checking for php-config... no&lt;/div&gt;&lt;div&gt;&lt;b&gt;configure: error: php-config not \
found; please install the PHP SDK&lt;/b&gt;&lt;/div&gt;&lt;div&gt;webserver:~/libvirt-php-0.4.3 # ls \
/etc/php5/&lt;/div&gt;&lt;div&gt;apache2/ cli/       conf.d/   &lt;/div&gt;&lt;div&gt;



webserver:~/libvirt-php-0.4.3 # ls /etc/php5/apache2/&lt;/div&gt;
&lt;div&gt;php.ini&lt;/div&gt;&lt;div&gt;webserver:~/libvirt-php-0.4.3 #  \
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;Peter  &lt;/div&gt; \
&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;_______________________________________________&lt;br&gt; \
libvirt-users mailing list&lt;br&gt; &lt;a href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt; &lt;a \
href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;font \
color="#888888"&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;br clear="all"&gt;&lt;/div&gt;

&lt;div dir="ltr"&gt;&lt;br&gt;
&lt;/div&gt;&lt;div dir="ltr"&gt;-- &lt;br&gt;&lt;/div&gt;&lt;div dir="ltr"&gt;&lt;div&gt;&lt;span \
style="font-family:Verdana, Arial, Helvetica, \
sans-serif;font-size:10px"&gt;&lt;strong&gt;&lt;span style="font-size:small"&gt;&lt;span \
style="color:rgb(0, 0, 128)"&gt;&lt;span style="color:rgb(0, 0, 0);font-weight:normal"&gt;���� \
���� ������&lt;/span&gt;&lt;br&gt;


��&lt;/span&gt;&lt;span style="color:rgb(0, 0, 255)"&gt;��&lt;/span&gt;-&lt;span style="color:rgb(0, 0, \
128)"&gt;��&lt;/span&gt;&lt;span style="color:rgb(0, 0, 255)"&gt;��&lt;/span&gt;&lt;span style="color:rgb(51, \
102, 255)"&gt;��&lt;/span&gt;  (&lt;span style="color:rgb(128, 0, 0)"&gt;����������� ��&lt;/span&gt;)&lt;br&gt;


&lt;/span&gt;&lt;/strong&gt;&lt;span style="font-size:small"&gt;���������� ������������ ���� ���������� \
������������&lt;br&gt;&lt;/span&gt;&lt;span style="font-size:small"&gt;���������� ���������� \
�������������������� ���������������� �������������� ��������������  &lt;b&gt;����� \
����&lt;/b&gt;&lt;br&gt;�������� ��������� �� ������������  &lt;a href="http://www.hetz.biz/" \
style="background-color:rgb(219, 216, 222)" target="_blank"&gt;hetz.biz&lt;/a&gt;  \
������������ ����� ��:  &lt;a href="http://blog.hetz.biz/" \
style="background-color:rgb(219, 216, 222)" target="_blank"&gt;blog.hetz.biz&lt;/a&gt;  &lt;br&gt;


&lt;/span&gt;&lt;span style="font-size:small"&gt;������������: 0783333113/4/5, ������������:  &lt;a \
href="mailto:sales@hetz.biz" target="_blank"&gt;sales@hetz.biz&lt;/a&gt;  &lt;br&gt;&lt;/span&gt;&lt;span \
style="font-size:small"&gt;����� ��'��:  &lt;a href="mailto:sales@hetz.biz" \
target="_blank"&gt;sales@hetz.biz&lt;/a&gt;  - ����������: heunique&lt;/span&gt;&lt;/span&gt;&lt;br&gt;


&lt;/div&gt;&lt;/div&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20111026141734</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-10-26 14:17:34-0400</timestampReceived><subject>Re: [libvirt-users] virsh start VM failed</subject><body>

On 10/26/2011 08:10 AM, vmnode guy wrote:
&gt; May i know what linux distribution, version, and version of libvirt you are
&gt; using ?

Also, what does /var/log/libvirt/qemu/controlnode.log say, and what does
'virsh dumpxml controlnode' say?  Does 'virsh managedsave-remove
controlnode' help (it matters if you are using older libvirt that didn't
auto-clear a failed managed save image).

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20111026155018</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-10-26 15:50:18-0400</timestampReceived><subject>Re: [libvirt-users] virsh start VM failed</subject><body>

[re-adding the list]

On 10/26/2011 09:37 AM, 邱敏鈴 wrote:
&gt; linux distribution : linux2.6.35-30-server  version : ubuntu10.10
&gt;
&gt; virsh # version
&gt; Compiled against library: libvir 0.8.3
&gt; Using library: libvir 0.8.3
&gt; Using API: QEMU 0.8.3
&gt; Running hypervisor: QEMU 0.12.5
&gt;
&gt; /var/log/libvirt/qemu/controlnode.log
&gt; LC_ALL=C PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin
&gt; QEMU_AUDIO_DRV=none /usr/bin/kvm -S -M pc-0.12 -enable-kvm -m 1024 -smp
&gt; 2,sockets=2,cores=1,threads=1 -name controlnode -uuid
&gt; ce48e7d5-de02-8faf-c829-9e000ca49b2b -nodefaults -chardev
&gt; socket,id=monitor,path=/var/lib/libvirt/qemu/controlnode.monitor,server,nowait
&gt; -mon chardev=monitor,mode=readline -rtc base=utc -boot c -drive
&gt; file=/vm/vm1/ubuntu-kvm/tmpkzLes0.qcow2,if=none,id=drive-ide0-0-0,boot=on,format=qcow2
&gt; -device ide-drive,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0 -device
&gt; virtio-net-pci,vlan=0,id=net0,mac=52:54:00:17:a2:d0,bus=pci.0,addr=0x3 -net
&gt; tap,fd=37,vlan=0,name=hostnet0 -usb -vnc 127.0.0.1:0 -vga cirrus -device
&gt; virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x4
&gt; bind(unix:/var/lib/libvirt/qemu/controlnode.monitor): Permission denied
&gt; chardev: opening backend "socket" failed

This part of the log looks suspicious.  Could this be an installation 
issue, or perhaps AppArmor not configured correctly?

&gt;
&gt; virsh # dumpxml controlnode
&gt; &lt;domain type='kvm'&gt;
&gt;    &lt;name&gt;controlnode&lt;/name&gt;
&gt;    &lt;uuid&gt;ce48e7d5-de02-8faf-c829-9e000ca49b2b&lt;/uuid&gt;
&gt;    &lt;memory&gt;1048576&lt;/memory&gt;
&gt;    &lt;currentMemory&gt;1048576&lt;/currentMemory&gt;
&gt;    &lt;vcpu&gt;2&lt;/vcpu&gt;
&gt;    &lt;os&gt;
&gt;      &lt;type arch='x86_64' machine='pc-0.12'&gt;hvm&lt;/type&gt;
&gt;      &lt;boot dev='hd'/&gt;
&gt;    &lt;/os&gt;
&gt;    &lt;features&gt;
&gt;      &lt;acpi/&gt;
&gt;    &lt;/features&gt;
&gt;    &lt;clock offset='utc'/&gt;
&gt;    &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
&gt;    &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
&gt;    &lt;on_crash&gt;destroy&lt;/on_crash&gt;
&gt;    &lt;devices&gt;
&gt;      &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;
&gt;      &lt;disk type='file' device='disk'&gt;
&gt;        &lt;driver name='qemu' type='qcow2'/&gt;
&gt;        &lt;source file='/vm/vm1/ubuntu-kvm/tmpkzLes0.qcow2'/&gt;
&gt;        &lt;target dev='hda' bus='ide'/&gt;
&gt;        &lt;address type='drive' controller='0' bus='0' unit='0'/&gt;
&gt;      &lt;/disk&gt;
&gt;      &lt;controller type='ide' index='0'&gt;
&gt;        &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x01'
&gt; function='0x1'/&gt;
&gt;      &lt;/controller&gt;
&gt;      &lt;interface type='bridge'&gt;
&gt;        &lt;mac address='52:54:00:17:a2:d0'/&gt;
&gt;        &lt;source bridge='br0'/&gt;
&gt;        &lt;target dev='vnet0'/&gt;
&gt;        &lt;model type='virtio'/&gt;
&gt;        &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03'
&gt; function='0x0'/&gt;
&gt;      &lt;/interface&gt;
&gt;      &lt;input type='mouse' bus='ps2'/&gt;
&gt;      &lt;graphics type='vnc' port='-1' autoport='yes' listen='127.0.0.1'/&gt;
&gt;      &lt;video&gt;
&gt;        &lt;model type='cirrus' vram='9216' heads='1'/&gt;
&gt;        &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x02'
&gt; function='0x0'/&gt;
&gt;      &lt;/video&gt;
&gt;      &lt;memballoon model='virtio'&gt;
&gt;        &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x04'
&gt; function='0x0'/&gt;
&gt;      &lt;/memballoon&gt;
&gt;    &lt;/devices&gt;
&gt; &lt;/domain&gt;
&gt;
&gt; virsh # managedsave-remove controlnode couldn't help!

Nothing in that XML jumped out as suspicious to me.  And from the sound 
of your managedsave-remote not making a difference, my guess of a 
corrupt managed save image getting in the way is a red herring.  I'm not 
sure what to suggest trying next.  Maybe others can chime in...

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20111024083554</emailId><senderName>"Guangya Liu"</senderName><senderEmail>gyliu@platform.com</senderEmail><timestampReceived>2011-10-24 08:35:54-0400</timestampReceived><subject>Re: [libvirt-users] How to use "virsh migrat" with p2p option?</subject><body>

Hi libvirt support,
 
Just introduce myself, I was an ISF developer from Platform Computing.
 
Thanks,
Guangya Liu
ISF Developer
Platform Computing
Direct: +1 905 948 4526
Skype: guangyaliuf9
www.platform.com &lt;blocked::http://www.platform.com/&gt; 

 
From: Guangya Liu &lt;mailto:gyliu@platform.com&gt; 
Date: 2011-10-24 16:34
To: libvirt-users &lt;mailto:libvirt-users@redhat.com&gt; ; libvir-list \
                &lt;mailto:libvir-list@redhat.com&gt; 
Subject: How to use "virsh migrat" with p2p option?
Hi libvirt support,
 
Can you please give me some example of how to use "virsh migrate --live" with p2p \
option including both source host and target host?  
I try to get some info from your website, but no info with migrate.
 
[root@vmoactive02 qemu]# virsh help migrate
  NAME
    migrate - migrate domain to another host
 
  SYNOPSIS
    migrate [--live] [--p2p] [--direct] [--tunnelled] [--persistent] \
[--undefinesource] [--suspend] [--copy-storage-all] [--copy-storage-inc] &lt;domain&gt; \
&lt;desturi&gt; [&lt;migrateuri&gt;] [&lt;dname&gt;]  
  DESCRIPTION
    Migrate domain to another host.  Add --live for live migration.
 
  OPTIONS
    --live           live migration
    --p2p            peer-2-peer migration
    --direct         direct migration
    --tunnelled      tunnelled migration
    --persistent     persist VM on destination
    --undefinesource  undefine VM on source
    --suspend        do not restart the domain on the destination host
    --copy-storage-all  migration with non-shared storage with full disk copy
    --copy-storage-inc  migration with non-shared storage with incremental copy (same \
base image shared between source and destination)  [--domain] &lt;string&gt;  domain name, \
id or uuid  [--desturi] &lt;string&gt;  connection URI of the destination host
    [--migrateuri] &lt;string&gt;  migration URI, usually can be omitted
    [--dname] &lt;string&gt;  rename to new name during migration (if supported)
 
Thanks,
 
Guangya


[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;
&lt;HTML xmlns:o = "urn:schemas-microsoft-com:office:office"&gt;&lt;HEAD&gt;
&lt;META content="text/html; charset=gb2312" http-equiv=Content-Type&gt;
&lt;STYLE&gt;
BLOCKQUOTE {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; MARGIN-LEFT: 2em
}
OL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
UL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
P {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
DIV.FoxDiv20111024163514380885 {
	LINE-HEIGHT: 1.5; MARGIN: 10px; FONT-FAMILY: verdana; COLOR: #000000; FONT-SIZE: \
10pt }
BODY {
	LINE-HEIGHT: 1.5; FONT-FAMILY: verdana; COLOR: #000000; FONT-SIZE: 10pt
}
&lt;/STYLE&gt;

&lt;META name=GENERATOR content="MSHTML 8.00.6001.19120"&gt;
&lt;STYLE&gt;BLOCKQUOTE {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; MARGIN-LEFT: 2em
}
OL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
UL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
P {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
&lt;/STYLE&gt;

&lt;META name=GENERATOR content="MSHTML 8.00.6001.19120"&gt;&lt;/HEAD&gt;
&lt;BODY style="MARGIN: 10px"&gt;
&lt;DIV style="FONT-FAMILY: Calibri; FONT-SIZE: 11pt"&gt;Hi libvirt support,&lt;/DIV&gt;
&lt;DIV style="FONT-FAMILY: Calibri; FONT-SIZE: 11pt"&gt; &lt;/DIV&gt;
&lt;DIV style="FONT-FAMILY: Calibri; FONT-SIZE: 11pt"&gt;Just introduce myself, I was 
an ISF developer from Platform Computing.&lt;/DIV&gt;
&lt;DIV style="FONT-FAMILY: Calibri; FONT-SIZE: 11pt"&gt; &lt;/DIV&gt;
&lt;DIV style="FONT-FAMILY: Calibri; FONT-SIZE: 11pt"&gt;Thanks,&lt;/DIV&gt;
&lt;DIV style="FONT-FAMILY: Verdana"&gt;&lt;SPAN&gt;&lt;SPAN 
style="FONT-FAMILY: ËÎÌå; COLOR: #000000; FONT-SIZE: 10.5pt"&gt;
&lt;P 
style="MARGIN: 0in 0in 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto" 
class=MsoNormal&gt;&lt;A name=_MailAutoSig&gt;&lt;B&gt;&lt;SPAN 
style="FONT-FAMILY: Arial; COLOR: maroon; FONT-SIZE: 10pt; mso-no-proof: yes"&gt;&lt;SPAN 
style="FONT-FAMILY: ??"&gt;&lt;/SPAN&gt;Guangya Liu&lt;BR&gt;&lt;/SPAN&gt;&lt;/B&gt;&lt;/A&gt;&lt;SPAN 
style="mso-bookmark: _MailAutoSig"&gt;&lt;SPAN 
style="FONT-FAMILY: Arial; FONT-SIZE: 10pt; mso-no-proof: \
yes"&gt;ISF Developer&lt;BR&gt;&lt;SPAN  style="COLOR: navy"&gt;Platform Computing&lt;/SPAN&gt;&lt;SPAN 
style="COLOR: black"&gt;&lt;BR&gt;&lt;/SPAN&gt;Direct: +1 905 948 4526&lt;BR&gt;Skype: 
guangyaliuf9&lt;BR&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;A title=blocked::http://www.platform.com/ 
href="blocked::http://www.platform.com/"&gt;&lt;SPAN 
style="mso-bookmark: _MailAutoSig"&gt;&lt;SPAN 
style="FONT-FAMILY: Arial; FONT-SIZE: 10pt; mso-no-proof: \
yes"&gt;www.platform.com&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;SPAN  style="mso-bookmark: \
_MailAutoSig"&gt;&lt;/SPAN&gt;&lt;/A&gt;&lt;SPAN  style="mso-bookmark: _MailAutoSig"&gt;&lt;/SPAN&gt;&lt;o:p 
style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px"&gt;&lt;/o:p&gt;&lt;/P&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/DIV&gt;
&lt;SCRIPT type=text/javascript&gt;
&lt;!--script
function img_zoom(e, o)
{
var zoom = parseInt(o.style.zoom, 10) || 100;
zoom += e.wheelDelta / 12;
if (((zoom &gt;= 50) &amp;&amp; (e.wheelDelta &lt; 0)) || ((zoom &lt; 200) &amp;&amp; (e.wheelDelta &gt; 0))) \
o.style.zoom = zoom + '%'; return false;
}

--&gt;
&lt;/SCRIPT&gt;

&lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV 
style="BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; PADDING-BOTTOM: 0cm; \
PADDING-LEFT: 0cm; PADDING-RIGHT: 0cm; BORDER-TOP: #b5c4df 1pt solid; BORDER-RIGHT: \
medium none; PADDING-TOP: 3pt"&gt; &lt;DIV 
style="PADDING-BOTTOM: 8px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; BACKGROUND: \
#efefef; COLOR: #000000; FONT-SIZE: 12px; PADDING-TOP: 8px"&gt; \
&lt;DIV&gt;&lt;B&gt;From:&lt;/B&gt; &lt;A href="mailto:gyliu@platform.com"&gt;Guangya Liu&lt;/A&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;B&gt;Date:&lt;/B&gt; 2011-10-24 16:34&lt;/DIV&gt; &lt;DIV&gt;&lt;B&gt;To:&lt;/B&gt; &lt;A 
href="mailto:libvirt-users@redhat.com"&gt;libvirt-users&lt;/A&gt;; &lt;A 
href="mailto:libvir-list@redhat.com"&gt;libvir-list&lt;/A&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;B&gt;Subject:&lt;/B&gt; How to use "virsh migrat" with p2p 
option?&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;
&lt;DIV&gt;
&lt;DIV class=FoxDiv20111024163514380885&gt;
&lt;STYLE&gt;BLOCKQUOTE {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; MARGIN-LEFT: 2em
}
OL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
UL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
P {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
&lt;/STYLE&gt;

&lt;META name=GENERATOR content="MSHTML 8.00.6001.19120"&gt;
&lt;DIV&gt;&lt;FONT style="FONT-SIZE: 11pt" size=1 face=Calibri&gt;Hi libvirt 
support,&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT style="FONT-SIZE: 11pt" size=1 face=Calibri&gt;&lt;/FONT&gt; &lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT style="FONT-SIZE: 11pt" size=1 face=Calibri&gt;Can you please give me 
some example of how to use "virsh migrate --live" with p2p option including both 
source host and target host?&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT style="FONT-SIZE: 11pt" size=1 face=Calibri&gt;&lt;/FONT&gt; &lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT style="FONT-SIZE: 11pt" size=1 face=Calibri&gt;I try to get some info 
from your website, but no info with migrate.&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=Calibri&gt;&lt;/FONT&gt; &lt;/DIV&gt;
&lt;DIV&gt;
&lt;DIV&gt;[root@vmoactive02 qemu]# virsh help migrate&lt;/DIV&gt;
&lt;DIV&gt;  NAME&lt;/DIV&gt;
&lt;DIV&gt;    migrate - migrate domain to another host&lt;/DIV&gt;
 &lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;  SYNOPSIS&lt;/DIV&gt;
&lt;DIV&gt;    migrate [--live] [--p2p] [--direct] [ \
--tunnelled] [--persistent] [--undefinesource] [--suspend] [--copy \
-storage-all] [--copy-storage-inc] &lt;domain&gt; &lt;desturi&gt; [&lt;migrateuri&gt;] [&lt;dname&gt;]&lt;/DIV&gt;
 &lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;  DESCRIPTION&lt;/DIV&gt;
&lt;DIV&gt;    Migrate domain to another host.  Add --live for live migration.&lt;/DIV&gt;
 &lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;  OPTIONS&lt;/DIV&gt;
&lt;DIV&gt;    --live           live migration&lt;/DIV&gt;
 &lt;DIV&gt;    --p2p            peer-2-peer migration&lt;/DIV&gt;
 &lt;DIV&gt;    --direct         direct migration&lt;/DIV&gt;
 &lt;DIV&gt;    --tunnelled      tunnelled migration&lt;/DIV&gt;
 &lt;DIV&gt;    --persistent     persist VM on destination&lt;/DIV&gt;
 &lt;DIV&gt;    --undefinesource  undefine VM on source&lt;/DIV&gt;
 &lt;DIV&gt;    --suspend         \
;do not restart the domain on the destination host&lt;/DIV&gt;
 &lt;DIV&gt;    --copy-storage-all  migration with non-shared storage with full disk copy&lt;/DIV&gt;
 &lt;DIV&gt;    --copy-storage-inc  migration with n \
on-shared storage with incremental copy (same base image shared between source and destination)&lt;/DIV&gt;
 &lt;DIV&gt;    [--domain] &lt;string&gt;  domain name, id or uuid&lt;/DIV&gt;
 &lt;DIV&gt;    [--desturi] &lt;string&gt;  connection URI of the destination host&lt;/DIV&gt;
 &lt;DIV&gt;    [--migrateuri] &lt;string&gt;  migration URI, usually can be omitted&lt;/DIV&gt;
 &lt;DIV&gt;    [--dname] &lt;string&gt;  rename to&amp; \
nbsp;new name during migration (if supported)&lt;/DIV&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT style="FONT-SIZE: 11pt" size=1 face=Calibri&gt;&lt;/FONT&gt; &lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
style="FONT-SIZE: 11pt" size=1 face=Calibri&gt;Thanks,&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
style="FONT-SIZE: 11pt" size=1 face=Calibri&gt;&lt;/FONT&gt; &lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
style="FONT-SIZE: 11pt" size=1  face=Calibri&gt;Guangya&lt;/FONT&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;
&lt;SCRIPT type=text/javascript&gt;
&lt;!--script
function img_zoom(e, o)
{
var zoom = parseInt(o.style.zoom, 10) || 100;
zoom += e.wheelDelta / 12;
if (((zoom &gt;= 50) &amp;&amp; (e.wheelDelta &lt; 0)) || ((zoom &lt; 200) &amp;&amp; (e.wheelDelta &gt; 0))) \
o.style.zoom = zoom + '%'; return false;
}

--&gt;
&lt;/SCRIPT&gt;
&lt;/BODY&gt;&lt;/HTML&gt;



</body></email><email><emailId>20111024202050</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-10-24 20:20:50-0400</timestampReceived><subject>Re: [libvirt-users] Hard limit for the cpu usage of a VM</subject><body>

On 10/24/2011 01:50 PM, sethuraman subbiah wrote:
&gt; Hi ,
&gt; 
&gt; I was previously using xen and currently moved to KVM. I am using libvirt to manage \
&gt; these VMs. In den's credit scheduler , I had the ability to set a cap on the cpu \
&gt; usage for a VM. But I was not able to find a similar substitute in KVM. I find that \
&gt; we can use cgroups to provide shares for VM but that will be more like weight based \
&gt; and it doesn't set a hard cap for that VM. I tried using cpulimit but I find it \
&gt; inaccurate and we can give values only between 0-100. Thus, I think it cannot \
&gt; support multi core environments. Can any one suggest a method to set a hard limit \
&gt; on a VM's cpu usage? Thank you.

Libvirt 0.9.4 added CPU bandwidth limitation support, via &lt;cputune&gt;: 
http://libvirt.org/formatdomain.html#elementsCPUTuning.  &lt;period&gt; and 
&lt;quota&gt; map to hard-coded caps via cgroups, nicer than the weighted 
numbers via &lt;shares&gt;.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


</body></email><email><emailId>20111024202413</emailId><senderName>sethuraman subbiah</senderName><senderEmail>sethusubbiah@gmail.com</senderEmail><timestampReceived>2011-10-24 20:24:13-0400</timestampReceived><subject>Re: [libvirt-users] Hard limit for the cpu usage of a VM</subject><body>

Hi,

-
Regards,
Sethuraman Subbiah

Graduate Student - NC state University
M.S in Computer Science


On Oct 24, 2011, at 4:20 PM, Eric Blake wrote:

&gt; On 10/24/2011 01:50 PM, sethuraman subbiah wrote:
&gt; &gt; Hi ,
&gt; &gt; 
&gt; &gt; I was previously using xen and currently moved to KVM. I am using libvirt to \
&gt; &gt; manage these VMs. In den's credit scheduler , I had the ability to set a cap on \
&gt; &gt; the cpu usage for a VM. But I was not able to find a similar substitute in KVM. I \
&gt; &gt; find that we can use cgroups to provide shares for VM but that will be more like \
&gt; &gt; weight based and it doesn't set a hard cap for that VM. I tried using cpulimit \
&gt; &gt; but I find it inaccurate and we can give values only between 0-100. Thus, I think \
&gt; &gt; it cannot support multi core environments. Can any one suggest a method to set a \
&gt; &gt; hard limit on a VM's cpu usage? Thank you.
&gt; 
&gt; Libvirt 0.9.4 added CPU bandwidth limitation support, via &lt;cputune&gt;: \
&gt; http://libvirt.org/formatdomain.html#elementsCPUTuning.  &lt;period&gt; and &lt;quota&gt; map \
&gt; to hard-coded caps via cgroups, nicer than the weighted numbers via &lt;shares&gt;.

Great, I have one more question. Is it possible to set the quota during run time from \
the host os ? Using virsh ? Thank you. 
&gt; 
&gt; -- 
&gt; Eric Blake   eblake@redhat.com    +1-801-349-2682
&gt; Libvirt virtualization library http://libvirt.org


</body></email><email><emailId>20111024203056</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-10-24 20:30:56-0400</timestampReceived><subject>Re: [libvirt-users] Hard limit for the cpu usage of a VM</subject><body>

On 10/24/2011 02:24 PM, sethuraman subbiah wrote:
&gt; Great, I have one more question. Is it possible to set the quota during run time \
&gt; from the host os ? Using virsh ? Thank you.

virsh schedinfo can both query and alter these cpu tunables, and that 
includes doing it while the guest is running.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


</body></email><email><emailId>20111024203952</emailId><senderName>sethuraman subbiah</senderName><senderEmail>sethusubbiah@gmail.com</senderEmail><timestampReceived>2011-10-24 20:39:52-0400</timestampReceived><subject>Re: [libvirt-users] Hard limit for the cpu usage of a VM</subject><body>

Hi,

On Oct 24, 2011, at 4:30 PM, Eric Blake wrote:

&gt; On 10/24/2011 02:24 PM, sethuraman subbiah wrote:
&gt; &gt; Great, I have one more question. Is it possible to set the quota during run time \
&gt; &gt; from the host os ? Using virsh ? Thank you.
&gt; 
&gt; virsh schedinfo can both query and alter these cpu tunables, and that includes \
&gt; doing it while the guest is running. 
I tried the virsh schedinfo. Here is the information regarding my libvirt : 

[root@sbc11 ssubbiah]# virsh version
Compiled against library: libvir 0.9.4
Using library: libvir 0.9.4
Using API: QEMU 0.9.4
Running hypervisor: QEMU 0.12.1

When i use "[root@hgcc11 ssubbiah]# virsh schedinfo rubis_ws --cap 50" , I dont see \
the cap value being set and I am able to see only cpu shares. 

Scheduler      : posix
cpu_shares     : 1024

&gt; -- 
&gt; Eric Blake   eblake@redhat.com    +1-801-349-2682
&gt; Libvirt virtualization library http://libvirt.org


</body></email><email><emailId>20111024204628</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-10-24 20:46:28-0400</timestampReceived><subject>Re: [libvirt-users] Hard limit for the cpu usage of a VM</subject><body>

On 10/24/2011 02:39 PM, sethuraman subbiah wrote:
&gt; Hi,
&gt; 
&gt; On Oct 24, 2011, at 4:30 PM, Eric Blake wrote:
&gt; 
&gt; &gt; On 10/24/2011 02:24 PM, sethuraman subbiah wrote:
&gt; &gt; &gt; Great, I have one more question. Is it possible to set the quota during run \
&gt; &gt; &gt; time from the host os ? Using virsh ? Thank you.
&gt; &gt; 
&gt; &gt; virsh schedinfo can both query and alter these cpu tunables, and that includes \
&gt; &gt; doing it while the guest is running. 
&gt; I tried the virsh schedinfo. Here is the information regarding my libvirt :
&gt; 
&gt; [root@sbc11 ssubbiah]# virsh version
&gt; Compiled against library: libvir 0.9.4
&gt; Using library: libvir 0.9.4
&gt; Using API: QEMU 0.9.4
&gt; Running hypervisor: QEMU 0.12.1
&gt; 
&gt; When i use "[root@hgcc11 ssubbiah]# virsh schedinfo rubis_ws --cap 50" , I dont see \
&gt; the cap value being set and I am able to see only cpu shares.

schedinfo --cap is obsolete (it's xen-only).  Rather, you want:

virsh schedinfo domain

to list the current settings, and

virsh schedinfo domain --set vcpu_period $value --set vcpu_quota $value

I haven't used it myself; I'm only going off the documentation provided 
by Wen Congyang, who oversaw the addition of the features.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


</body></email><email><emailId>20111024205444</emailId><senderName>sethuraman subbiah</senderName><senderEmail>sethusubbiah@gmail.com</senderEmail><timestampReceived>2011-10-24 20:54:44-0400</timestampReceived><subject>Re: [libvirt-users] Hard limit for the cpu usage of a VM</subject><body>


On Oct 24, 2011, at 4:46 PM, Eric Blake wrote:

&gt; On 10/24/2011 02:39 PM, sethuraman subbiah wrote:
&gt; &gt; Hi,
&gt; &gt; 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; When i use "[root@hgcc11 ssubbiah]# virsh schedinfo rubis_ws --cap 50" , I dont \
&gt; &gt; see the cap value being set and I am able to see only cpu shares.
&gt; 
&gt; schedinfo --cap is obsolete (it's xen-only).  Rather, you want:
&gt; 
&gt; virsh schedinfo domain
&gt; 
&gt; to list the current settings, and
&gt; 
&gt; virsh schedinfo domain --set vcpu_period $value --set vcpu_quota $value
&gt; 
&gt; I haven't used it myself; I'm only going off the documentation provided by Wen \
&gt; Congyang, who oversaw the addition of the features.

Sorry, I noticed it late about using a xen command here. I tried virsh schedinfo \
domain. I dont think I have the capability to set quota : 

[root@sbc11 ssubbiah]# virsh schedinfo rubis_ws
Scheduler      : posix
cpu_shares     : 1024

[root@sbc11 ssubbiah]# virsh schedinfo rubis_ws --set vcpu_quota=50
Scheduler      : posix
error: invalid scheduler option: vcpu_quota=50

I get the same error for "virsh schedinfo rubies_ws --set vcpu_quota 50" . 

I find that my version is 0.9.4. 

[root@sbc11 ssubbiah]# virsh --version
0.9.4

Should I do some modifications,enable options or add some patch to get the capability \
to set cap ? Thanks for all your help.   

&gt; 
&gt; -- 
&gt; Eric Blake   eblake@redhat.com    +1-801-349-2682
&gt; Libvirt virtualization library http://libvirt.org


</body></email><email><emailId>20111024211310</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-10-24 21:13:10-0400</timestampReceived><subject>Re: [libvirt-users] Hard limit for the cpu usage of a VM</subject><body>

On 10/24/2011 02:54 PM, sethuraman subbiah wrote:

&gt; [root@sbc11 ssubbiah]# virsh schedinfo rubis_ws --set vcpu_quota=50
&gt; Scheduler      : posix
&gt; error: invalid scheduler option: vcpu_quota=50
&gt; 
&gt; I get the same error for "virsh schedinfo rubies_ws --set vcpu_quota 50" .
&gt; 
&gt; I find that my version is 0.9.4.
&gt; 
&gt; [root@sbc11 ssubbiah]# virsh --version
&gt; 0.9.4
&gt; 
&gt; Should I do some modifications,enable options or add some patch to get the \
&gt; capability to set cap ? Thanks for all your help.

I found this comment in the code:

     /* If we does not know VCPU&lt;-&gt;PID mapping or all vcpu runs in the same
      * thread, we cannot control each vcpu. So we only modify cpu bandwidth
      * when each vcpu has a separated thread.
	
I think that means that in order to use CPU caps, you have to also use 
&lt;vcpupin&gt; to call out the host CPU pinning to be used by the guest VCPUS.

The original implementation was here, although I don't see much 
documentation in that patch series. 
https://www.redhat.com/archives/libvir-list/2011-July/msg01389.html

Wen, can you help out here?

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


</body></email><email><emailId>20111023141304</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-10-23 14:13:04-0400</timestampReceived><subject>Re: [libvirt-users] VirtualBox 4.1 support</subject><body>

2011/10/23 Stefano Facchini &lt;stefano.facchini@gmail.com&gt;:
&gt; Is version 4.1 (and later) of VirtualBox supported by libvirt?

Currently libvirt supports up to VirtualBox 4.0. Here's a patch for 4.1 support

https://www.redhat.com/archives/libvir-list/2011-October/msg01080.html

-- 
Matthias Bolte
http://photron.blogspot.com

</body></email><email><emailId>20111023154500</emailId><senderName>Stefano Facchini</senderName><senderEmail>stefano.facchini@gmail.com</senderEmail><timestampReceived>2011-10-23 15:45:00-0400</timestampReceived><subject>Re: [libvirt-users] VirtualBox 4.1 support</subject><body>

Il giorno dom, 23/10/2011 alle 16.13 +0200, Matthias Bolte ha scritto:
&gt; 2011/10/23 Stefano Facchini &lt;stefano.facchini@gmail.com&gt;:
&gt; &gt; Is version 4.1 (and later) of VirtualBox supported by libvirt?
&gt; 
&gt; Currently libvirt supports up to VirtualBox 4.0. Here's a patch for 4.1 support
&gt; 
&gt; https://www.redhat.com/archives/libvir-list/2011-October/msg01080.html
&gt; 
I tried the patch with VirtualBox 4.1.4, and it seems to work. The only
difference with QEMU is that VMs are displayed in a VirtualBox window
instead of the native virt-manager window. I never tried previous
version of VirtualBox so I don't know if this is expected.

Cheers


-- 
Stefano Facchini &lt;stefano.facchini@gmail.com&gt;

</body></email><email><emailId>20111024010414</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-10-24 01:04:14-0400</timestampReceived><subject>Re: [libvirt-users] VirtualBox 4.1 support</subject><body>

于 2011年10月23日 23:45, Stefano Facchini 写道:
&gt; Il giorno dom, 23/10/2011 alle 16.13 +0200, Matthias Bolte ha scritto:
&gt;&gt; 2011/10/23 Stefano Facchini&lt;stefano.facchini@gmail.com&gt;:
&gt;&gt;&gt; Is version 4.1 (and later) of VirtualBox supported by libvirt?
&gt;&gt; Currently libvirt supports up to VirtualBox 4.0. Here's a patch for 4.1 support
&gt;&gt;
&gt;&gt; https://www.redhat.com/archives/libvir-list/2011-October/msg01080.html
&gt;&gt;
&gt; I tried the patch with VirtualBox 4.1.4, and it seems to work. The only
&gt; difference with QEMU is that VMs are displayed in a VirtualBox window
&gt; instead of the native virt-manager window.

have you created a connection of VBOX in virt-manager? it
connects to qemu driver by default.

&gt; I never tried previous
&gt; version of VirtualBox so I don't know if this is expected.
&gt;
&gt; Cheers
&gt;
&gt;

</body></email><email><emailId>20111022210758</emailId><senderName>Andreas Kurz</senderName><senderEmail>andreas@hastexo.com</senderEmail><timestampReceived>2011-10-22 21:07:58-0400</timestampReceived><subject>Re: [libvirt-users] high-privileges</subject><body>


Hello,

On 10/21/2011 10:31 PM, Face wrote:
&gt; hello all,
&gt; 
&gt; my vm (windows server 2008) keep crashing?
&gt; 
&gt; 
&gt; 2011-09-21 15:00:45.924: 1355: info : libvirt version: 0.9.6
&gt; 2011-09-21 15:00:45.924: 1355: error : virSysinfoRead:465 : internal
&gt; error Failed to find path for dmidecode binary
&gt; 2011-09-21 15:05:43.873: 1349: warning : qemuDomainObjTaint:1128 :
&gt; Domain id=1 name='IIS' uuid=a02e41a9-9f4d-d94f-43a6-995b1ca6d37d is
&gt; tainted: high-privileges

I got this error when running qemu processes as root user/group other
than the default libvirt-qemu user (on Debian Squeeze) .... I changed it
in /etc/libvirt/qemu.conf.

Regards,
Andreas

-- 
Need help with Pacemaker/Corosync/DRBD?
http://www.hastexo.com/now


&gt; 2011-09-21 16:07:10.593: 1344: error : qemuMonitorIO:541 : internal
&gt; error End of file from monitor
&gt; 
&gt; 
&gt; Any help would be much appreciated.
&gt; 





["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20111023050302</emailId><senderName>Face</senderName><senderEmail>falazemi@gmail.com</senderEmail><timestampReceived>2011-10-23 05:03:02-0400</timestampReceived><subject>Re: [libvirt-users] high-privileges</subject><body>

Anyone

On Fri, Oct 21, 2011 at 11:31 PM, Face &lt;falazemi@gmail.com&gt; wrote:
&gt; hello all,
&gt;
&gt; my vm (windows server 2008) keep crashing?
&gt;
&gt;
&gt; 2011-09-21 15:00:45.924: 1355: info : libvirt version: 0.9.6
&gt; 2011-09-21 15:00:45.924: 1355: error : virSysinfoRead:465 : internal
&gt; error Failed to find path for dmidecode binary
&gt; 2011-09-21 15:05:43.873: 1349: warning : qemuDomainObjTaint:1128 :
&gt; Domain id=1 name='IIS' uuid=a02e41a9-9f4d-d94f-43a6-995b1ca6d37d is
&gt; tainted: high-privileges
&gt; 2011-09-21 16:07:10.593: 1344: error : qemuMonitorIO:541 : internal
&gt; error End of file from monitor
&gt;
&gt;
&gt; Any help would be much appreciated.
&gt;
&gt; --
&gt; Sincerely,
&gt; falazemi
&gt;

Anyone

</body></email><email><emailId>20111023215202</emailId><senderName>Andreas Kurz</senderName><senderEmail>andreas@hastexo.com</senderEmail><timestampReceived>2011-10-23 21:52:02-0400</timestampReceived><subject>Re: [libvirt-users] high-privileges</subject><body>


Hello,

On 10/21/2011 10:31 PM, Face wrote:
&gt; hello all,
&gt; 
&gt; my vm (windows server 2008) keep crashing?
&gt; 
&gt; 
&gt; 2011-09-21 15:00:45.924: 1355: info : libvirt version: 0.9.6
&gt; 2011-09-21 15:00:45.924: 1355: error : virSysinfoRead:465 : internal
&gt; error Failed to find path for dmidecode binary
&gt; 2011-09-21 15:05:43.873: 1349: warning : qemuDomainObjTaint:1128 :
&gt; Domain id=1 name='IIS' uuid=a02e41a9-9f4d-d94f-43a6-995b1ca6d37d is
&gt; tainted: high-privileges

I got this error when running qemu processes as root user/group other
than the default libvirt-qemu user (on Debian Squeeze) .... I changed it
in /etc/libvirt/qemu.conf.

Regards,
Andreas

-- 
Need help with Pacemaker/Corosync/DRBD?
http://www.hastexo.com/now


&gt; 2011-09-21 16:07:10.593: 1344: error : qemuMonitorIO:541 : internal
&gt; error End of file from monitor
&gt; 
&gt; 
&gt; Any help would be much appreciated.
&gt; 







["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20111022175419</emailId><senderName>Mohammed Naser</senderName><senderEmail>mnaser@vexxhost.com</senderEmail><timestampReceived>2011-10-22 17:54:19-0400</timestampReceived><subject>Re: [libvirt-users] virt-install with set vnc password</subject><body>

On Sat, Oct 22, 2011 at 5:53 AM, vmnode guy &lt;vmnodeguy@gmail.com&gt; wrote:

&gt; Hi Guy,
&gt;
&gt; Anyone know how we can set up the vnc password during using virt-install
&gt; command ?
&gt;
&gt;          # virt-install \
&gt;               --connect qemu:///system \
&gt;               --name demo \
&gt;               --ram 500 \
&gt;               --disk path=/var/lib/libvirt/images/demo.img,size=5 \
&gt;               --network network=default,model=virtio \
&gt;               --vnc \
&gt;               --cdrom /dev/cdrom
&gt;
&gt;
&gt; Regards,
&gt; Peter
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;


Try this option instead of

--vnc

Use

--graphics vnc,password=foobar

That should work.

-- 
Mohammed Naser — vexxhost
-----------------------------------------------------
D. 514-316-8872
D. 800-910-1726 ext. 200
PIN. 223141AA
E. mnaser@vexxhost.com
W. http://vexxhost.com

[Attachment #3 (text/html)]

&lt;div&gt;&lt;div class="gmail_quote"&gt;On Sat, Oct 22, 2011 at 5:53 AM, vmnode guy &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:vmnodeguy@gmail.com"&gt;vmnodeguy@gmail.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt; &lt;div&gt;Hi Guy,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Anyone know how \
we can set up the vnc password during using virt-install command \
?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;              # virt-install \&lt;/div&gt;&lt;div&gt;             \
--connect qemu:///system \&lt;/div&gt;


&lt;div&gt;                     --name demo \&lt;/div&gt;&lt;div&gt;                     --ram 500 \
\&lt;/div&gt;&lt;div&gt;                     --disk path=/var/lib/libvirt/images/demo.img,size=5 \
\&lt;/div&gt;&lt;div&gt;                     --network network=default,model=virtio \&lt;/div&gt;&lt;div&gt;


                     --vnc \&lt;/div&gt;&lt;div&gt;                     --cdrom \
/dev/cdrom&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;Peter&lt;/div&gt;
 &lt;br&gt;_______________________________________________&lt;br&gt;
libvirt-users mailing list&lt;br&gt;
&lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
&lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;Try \
                this option instead of  &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;
--vnc&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Use&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;--graphics \
vnc,password=foobar&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;That should \
work.&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- &lt;br&gt;&lt;span \
style="font-family:Arial;font-size:8pt"&gt;&lt;span style="color:rgb(70, 130, \
180);font-size:10pt"&gt;Mohammed Naser&lt;/span&gt;  —  &lt;span \
style="font-weight:bold"&gt;vexxhost&lt;/span&gt;&lt;br&gt; &lt;/span&gt;&lt;div&gt;&lt;span \
style="font-family:Arial;font-size:8pt"&gt;&lt;span&gt;&lt;span style="color:rgb(220, 220, \
220)"&gt;-----------------------------------------------------&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="font-family:Arial;font-size:11px;font-weight:bold"&gt;D.  &lt;/span&gt;&lt;span \
style="font-family:Arial;font-size:11px"&gt;514-316-8872&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span \
style="font-family:Arial;font-size:11px"&gt;&lt;span style="font-weight:bold"&gt;D.&lt;/span&gt;  \
800-910-1726 ext. 200&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="font-family:Arial;font-size:11px"&gt;&lt;span style="font-weight:bold"&gt;PIN.  \
&lt;/span&gt;223141AA&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span \
style="font-family:Arial;font-size:11px"&gt;&lt;span style="font-weight:bold"&gt;E.  &lt;/span&gt;&lt;a \
href="mailto:mnaser@vexxhost.com" \
target="_blank"&gt;mnaser@vexxhost.com&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="font-family:Arial;font-size:11px"&gt;&lt;span style="font-weight:bold"&gt;W.  &lt;/span&gt;&lt;a \
href="http://vexxhost.com/" target="_blank"&gt;http://vexxhost.com&lt;/a&gt;&lt;/span&gt;&lt;/div&gt; &lt;br&gt;
&lt;/div&gt;



</body></email><email><emailId>20111022181157</emailId><senderName>vmnode guy</senderName><senderEmail>vmnodeguy@gmail.com</senderEmail><timestampReceived>2011-10-22 18:11:57-0400</timestampReceived><subject>Re: [libvirt-users] virt-install with set vnc password</subject><body>

Seem like there is no such option, or could my option place it incorrectly ?

root@cloudnode2:~/new# cat virt-install.sh
vm_uid=testvm
vcpu=2
ram=512
diskspace=10
path=/home/source/ubuntu-10.04.2-server-amd64.iso


#virt-install -n $vm_uid --vcpus=$vcpu -r $ram -f /root/new/disk0.raw -s
$diskspace -c $path --accelerate --connect=qemu:///system --vnc
--vnclisten=0.0.0.0 --noautoconsole -v

virt-install -n $vm_uid --vcpus=$vcpu -r $ram -f /root/new/disk0.raw -s
$diskspace -c $path --accelerate --connect=qemu:///system --vnc --graphics
vnc,password=testing --noautoconsole -v
root@cloudnode2:~/new#
root@cloudnode2:~/new#
root@cloudnode2:~/new# sh virt-install.sh
Usage: virt-install --name NAME --ram RAM STORAGE INSTALL [options]

virt-install: error: no such option: --graphics
root@cloudnode2:~/new#

Regards,
Peter Cheng

On Sun, Oct 23, 2011 at 1:54 AM, Mohammed Naser &lt;mnaser@vexxhost.com&gt; wrote:

&gt; On Sat, Oct 22, 2011 at 5:53 AM, vmnode guy &lt;vmnodeguy@gmail.com&gt; wrote:
&gt;
&gt;&gt; Hi Guy,
&gt;&gt;
&gt;&gt; Anyone know how we can set up the vnc password during using virt-install
&gt;&gt; command ?
&gt;&gt;
&gt;&gt;          # virt-install \
&gt;&gt;               --connect qemu:///system \
&gt;&gt;               --name demo \
&gt;&gt;               --ram 500 \
&gt;&gt;               --disk path=/var/lib/libvirt/images/demo.img,size=5 \
&gt;&gt;               --network network=default,model=virtio \
&gt;&gt;               --vnc \
&gt;&gt;               --cdrom /dev/cdrom
&gt;&gt;
&gt;&gt;
&gt;&gt; Regards,
&gt;&gt; Peter
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; libvirt-users mailing list
&gt;&gt; libvirt-users@redhat.com
&gt;&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;&gt;
&gt;
&gt;
&gt; Try this option instead of
&gt;
&gt; --vnc
&gt;
&gt; Use
&gt;
&gt; --graphics vnc,password=foobar
&gt;
&gt; That should work.
&gt;
&gt; --
&gt; Mohammed Naser — vexxhost
&gt; -----------------------------------------------------
&gt; D. 514-316-8872
&gt; D. 800-910-1726 ext. 200
&gt; PIN. 223141AA
&gt; E. mnaser@vexxhost.com
&gt; W. http://vexxhost.com
&gt;
&gt;

[Attachment #3 (text/html)]

&lt;div&gt;Seem like there is no such option, or could my option place it incorrectly \
?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;root@cloudnode2:~/new# cat virt-install.sh \
&lt;/div&gt;&lt;div&gt;vm_uid=testvm&lt;/div&gt;&lt;div&gt;vcpu=2&lt;/div&gt;&lt;div&gt;ram=512&lt;/div&gt;&lt;div&gt; \
diskspace=10&lt;/div&gt;&lt;div&gt;path=/home/source/ubuntu-10.04.2-server-amd64.iso&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#virt-install \
-n $vm_uid --vcpus=$vcpu -r $ram -f /root/new/disk0.raw -s $diskspace -c $path \
--accelerate --connect=qemu:///system --vnc --vnclisten=0.0.0.0 --noautoconsole \
-v&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;virt-install -n $vm_uid --vcpus=$vcpu -r $ram -f \
/root/new/disk0.raw -s $diskspace -c $path --accelerate --connect=qemu:///system \
--vnc --graphics vnc,password=testing --noautoconsole \
-v&lt;/div&gt;&lt;div&gt;root@cloudnode2:~/new# &lt;/div&gt; &lt;div&gt;root@cloudnode2:~/new# \
&lt;/div&gt;&lt;div&gt;root@cloudnode2:~/new# sh virt-install.sh &lt;/div&gt;&lt;div&gt;Usage: virt-install \
--name NAME --ram RAM STORAGE INSTALL \
[options]&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;virt-install: error: no such option: \
--graphics&lt;/div&gt; &lt;div&gt;root@cloudnode2:~/new# \
&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;Peter \
Cheng&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div class="gmail_quote"&gt;On Sun, Oct 23, 2011 at 1:54 \
AM, Mohammed Naser &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:mnaser@vexxhost.com"&gt;mnaser@vexxhost.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt; \
&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt;&lt;div&gt;&lt;div class="gmail_quote"&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div \
class="h5"&gt;On Sat, Oct 22, 2011 at 5:53 AM, vmnode guy &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:vmnodeguy@gmail.com" target="_blank"&gt;vmnodeguy@gmail.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt; &lt;/div&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 \
.8ex;border-left:1px #ccc solid;padding-left:1ex"&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt; \
&lt;div&gt;Hi Guy,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Anyone know how we can set up the vnc password \
during using virt-install command ?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;         # \
virt-install \&lt;/div&gt;&lt;div&gt;              --connect qemu:///system \&lt;/div&gt;



&lt;div&gt;              --name demo \&lt;/div&gt;&lt;div&gt;              --ram 500 \&lt;/div&gt;&lt;div&gt;       \
--disk path=/var/lib/libvirt/images/demo.img,size=5 \&lt;/div&gt;&lt;div&gt;              \
--network network=default,model=virtio \&lt;/div&gt;&lt;div&gt;



              --vnc \&lt;/div&gt;&lt;div&gt;              --cdrom \
/dev/cdrom&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;Peter&lt;/div&gt;
 &lt;br&gt;&lt;/div&gt;&lt;/div&gt;_______________________________________________&lt;br&gt;
libvirt-users mailing list&lt;br&gt;
&lt;a href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt; &lt;a \
href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;Try \
this option instead of &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;

--vnc&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Use&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;--graphics \
vnc,password=foobar&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;That should \
work.&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;font color="#888888"&gt;-- &lt;br&gt;&lt;span \
style="font-family:Arial;font-size:8pt"&gt;&lt;span style="color:rgb(70, 130, \
180);font-size:10pt"&gt;Mohammed Naser&lt;/span&gt; — &lt;span \
style="font-weight:bold"&gt;vexxhost&lt;/span&gt;&lt;br&gt;

&lt;/span&gt;&lt;div&gt;&lt;span style="font-family:Arial;font-size:8pt"&gt;&lt;span&gt;&lt;span \
style="color:rgb(220, 220, \
220)"&gt;-----------------------------------------------------&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="font-family:Arial;font-size:11px;font-weight:bold"&gt;D. &lt;/span&gt;&lt;span \
style="font-family:Arial;font-size:11px"&gt;&lt;a href="tel:514-316-8872" \
value="+15143168872" target="_blank"&gt;514-316-8872&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;

&lt;div&gt;&lt;span style="font-family:Arial;font-size:11px"&gt;&lt;span \
style="font-weight:bold"&gt;D.&lt;/span&gt; &lt;a href="tel:800-910-1726%20ext.%20200" \
value="+18009101726" target="_blank"&gt;800-910-1726 ext. 200&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="font-family:Arial;font-size:11px"&gt;&lt;span style="font-weight:bold"&gt;PIN. \
&lt;/span&gt;223141AA&lt;/span&gt;&lt;/div&gt;

&lt;div&gt;&lt;span style="font-family:Arial;font-size:11px"&gt;&lt;span style="font-weight:bold"&gt;E. \
&lt;/span&gt;&lt;a href="mailto:mnaser@vexxhost.com" \
target="_blank"&gt;mnaser@vexxhost.com&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="font-family:Arial;font-size:11px"&gt;&lt;span style="font-weight:bold"&gt;W. &lt;/span&gt;&lt;a \
href="http://vexxhost.com/" target="_blank"&gt;http://vexxhost.com&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;

&lt;br&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20111022182152</emailId><senderName>Mohammed Naser</senderName><senderEmail>mnaser@vexxhost.com</senderEmail><timestampReceived>2011-10-22 18:21:52-0400</timestampReceived><subject>Re: [libvirt-users] virt-install with set vnc password</subject><body>

On Sat, Oct 22, 2011 at 2:11 PM, vmnode guy &lt;vmnodeguy@gmail.com&gt; wrote:

&gt; Seem like there is no such option, or could my option place it incorrectly
&gt; ?
&gt;
&gt; root@cloudnode2:~/new# cat virt-install.sh
&gt; vm_uid=testvm
&gt; vcpu=2
&gt; ram=512
&gt; diskspace=10
&gt; path=/home/source/ubuntu-10.04.2-server-amd64.iso
&gt;
&gt;
&gt; #virt-install -n $vm_uid --vcpus=$vcpu -r $ram -f /root/new/disk0.raw -s
&gt; $diskspace -c $path --accelerate --connect=qemu:///system --vnc
&gt; --vnclisten=0.0.0.0 --noautoconsole -v
&gt;
&gt; virt-install -n $vm_uid --vcpus=$vcpu -r $ram -f /root/new/disk0.raw -s
&gt; $diskspace -c $path --accelerate --connect=qemu:///system --vnc --graphics
&gt; vnc,password=testing --noautoconsole -v
&gt; root@cloudnode2:~/new#
&gt; root@cloudnode2:~/new#
&gt; root@cloudnode2:~/new# sh virt-install.sh
&gt; Usage: virt-install --name NAME --ram RAM STORAGE INSTALL [options]
&gt;
&gt; virt-install: error: no such option: --graphics
&gt; root@cloudnode2:~/new#
&gt;
&gt; Regards,
&gt; Peter Cheng
&gt;
&gt;
Are you sure that you're running the latest virt-install -- because latest
does have that option.  If you refer to the manpages of the latest version:

http://git.fedorahosted.org/git/?p=python-virtinst.git;a=blob;f=man/en/virt-install.pod.in#l633

I recommend you update your virt-install version in order to be able to use
that option, otherwise, you might be limited in your options.  You could add
a command that sets it manually by connecting to qemu (might be more
complicated).  If it's the same password, I think you could leave it in
/etc/libvirt/qemu.conf

http://wiki.libvirt.org/page/QEMUSwitchToLibvirt#change_vnc_PASSWORD

Let me know if this helps.

-- 
Mohammed Naser — vexxhost
-----------------------------------------------------
E. mnaser@vexxhost.com
W. http://vexxhost.com

[Attachment #3 (text/html)]

&lt;div&gt;&lt;div class="gmail_quote"&gt;On Sat, Oct 22, 2011 at 2:11 PM, vmnode guy &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:vmnodeguy@gmail.com"&gt;vmnodeguy@gmail.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt; &lt;div&gt;Seem like there is no such option, or could my \
option place it incorrectly ?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;root@cloudnode2:~/new# \
cat virt-install.sh  \
&lt;/div&gt;&lt;div&gt;vm_uid=testvm&lt;/div&gt;&lt;div&gt;vcpu=2&lt;/div&gt;&lt;div&gt;ram=512&lt;/div&gt;&lt;div&gt;

diskspace=10&lt;/div&gt;&lt;div&gt;path=/home/source/ubuntu-10.04.2-server-amd64.iso&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#virt-install \
-n $vm_uid --vcpus=$vcpu -r $ram -f /root/new/disk0.raw -s $diskspace -c $path \
--accelerate --connect=qemu:///system --vnc --vnclisten=0.0.0.0 --noautoconsole \
-v&lt;/div&gt;

&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;virt-install -n $vm_uid --vcpus=$vcpu -r $ram -f \
/root/new/disk0.raw -s $diskspace -c $path --accelerate --connect=qemu:///system \
--vnc --graphics vnc,password=testing --noautoconsole \
-v&lt;/div&gt;&lt;div&gt;root@cloudnode2:~/new#  &lt;/div&gt;

&lt;div&gt;root@cloudnode2:~/new#  &lt;/div&gt;&lt;div&gt;root@cloudnode2:~/new# sh virt-install.sh  \
&lt;/div&gt;&lt;div&gt;Usage: virt-install --name NAME --ram RAM STORAGE INSTALL \
[options]&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;virt-install: error: no such option: \
--graphics&lt;/div&gt;

&lt;div&gt;root@cloudnode2:~/new#  &lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;Peter \
Cheng&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div \
class="h5"&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Are you sure \
that you're running the latest virt-install -- because latest does have that \
option.   If you refer to the manpages of the latest version:  &lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;a \
href="http://git.fedorahosted.org/git/?p=python-virtinst.git;a=blob;f=man/en/virt-inst \
all.pod.in#l633"&gt;http://git.fedorahosted.org/git/?p=python-virtinst.git;a=blob;f=man/en/virt-install.pod.in#l633&lt;/a&gt;&lt;/div&gt;
 &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I recommend you update your virt-install version in order to be \
able to use that option, otherwise, you might be limited in your options.   You could \
add a command that sets it manually by connecting to qemu (might be more \
complicated).   If it's the same password, I think you could leave it in \
/etc/libvirt/qemu.conf&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;a \
href="http://wiki.libvirt.org/page/QEMUSwitchToLibvirt#change_vnc_PASSWORD"&gt;http://wik \
i.libvirt.org/page/QEMUSwitchToLibvirt#change_vnc_PASSWORD&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Let \
me know if this helps.&lt;/div&gt; &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- &lt;br&gt;&lt;span \
style="font-family:Arial;font-size:8pt"&gt;&lt;span style="color:rgb(70, 130, \
180);font-size:10pt"&gt;Mohammed Naser&lt;/span&gt;  —  &lt;span \
style="font-weight:bold"&gt;vexxhost&lt;/span&gt;&lt;br&gt;&lt;/span&gt;&lt;div&gt;&lt;span \
style="font-family:Arial;font-size:8pt"&gt;&lt;span&gt;&lt;span style="color:rgb(220, 220, \
220)"&gt;-----------------------------------------------------&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
 &lt;div&gt;&lt;span style="font-family:Arial;font-size:11px"&gt;&lt;span \
style="font-weight:bold"&gt;E.  &lt;/span&gt;&lt;a href="mailto:mnaser@vexxhost.com" \
target="_blank"&gt;mnaser@vexxhost.com&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="font-family:Arial;font-size:11px"&gt;&lt;span style="font-weight:bold"&gt;W.  &lt;/span&gt;&lt;a \
href="http://vexxhost.com/" target="_blank"&gt;http://vexxhost.com&lt;/a&gt;&lt;/span&gt;&lt;/div&gt; &lt;br&gt;
&lt;/div&gt;



</body></email><email><emailId>20111022182448</emailId><senderName>vmnode guy</senderName><senderEmail>vmnodeguy@gmail.com</senderEmail><timestampReceived>2011-10-22 18:24:48-0400</timestampReceived><subject>Re: [libvirt-users] virt-install with set vnc password</subject><body>

On Sun, Oct 23, 2011 at 2:21 AM, Mohammed Naser &lt;mnaser@vexxhost.com&gt; wrote:

&gt; On Sat, Oct 22, 2011 at 2:11 PM, vmnode guy &lt;vmnodeguy@gmail.com&gt; wrote:
&gt;
&gt;&gt; Seem like there is no such option, or could my option place it incorrectly
&gt;&gt; ?
&gt;&gt;
&gt;&gt; root@cloudnode2:~/new# cat virt-install.sh
&gt;&gt; vm_uid=testvm
&gt;&gt; vcpu=2
&gt;&gt; ram=512
&gt;&gt; diskspace=10
&gt;&gt; path=/home/source/ubuntu-10.04.2-server-amd64.iso
&gt;&gt;
&gt;&gt;
&gt;&gt; #virt-install -n $vm_uid --vcpus=$vcpu -r $ram -f /root/new/disk0.raw -s
&gt;&gt; $diskspace -c $path --accelerate --connect=qemu:///system --vnc
&gt;&gt; --vnclisten=0.0.0.0 --noautoconsole -v
&gt;&gt;
&gt;&gt; virt-install -n $vm_uid --vcpus=$vcpu -r $ram -f /root/new/disk0.raw -s
&gt;&gt; $diskspace -c $path --accelerate --connect=qemu:///system --vnc --graphics
&gt;&gt; vnc,password=testing --noautoconsole -v
&gt;&gt; root@cloudnode2:~/new#
&gt;&gt; root@cloudnode2:~/new#
&gt;&gt; root@cloudnode2:~/new# sh virt-install.sh
&gt;&gt; Usage: virt-install --name NAME --ram RAM STORAGE INSTALL [options]
&gt;&gt;
&gt;&gt; virt-install: error: no such option: --graphics
&gt;&gt; root@cloudnode2:~/new#
&gt;&gt;
&gt;&gt; Regards,
&gt;&gt; Peter Cheng
&gt;&gt;
&gt;&gt;
&gt; Are you sure that you're running the latest virt-install -- because latest
&gt; does have that option.  If you refer to the manpages of the latest version:
&gt;
&gt;
&gt; http://git.fedorahosted.org/git/?p=python-virtinst.git;a=blob;f=man/en/virt-install.pod.in#l633
&gt;
&gt; I recommend you update your virt-install version in order to be able to use
&gt; that option, otherwise, you might be limited in your options.  You could add
&gt; a command that sets it manually by connecting to qemu (might be more
&gt; complicated).  If it's the same password, I think you could leave it in
&gt; /etc/libvirt/qemu.conf
&gt;
&gt; http://wiki.libvirt.org/page/QEMUSwitchToLibvirt#change_vnc_PASSWORD
&gt;
&gt; Let me know if this helps.
&gt;
&gt; --
&gt; Mohammed Naser — vexxhost
&gt; -----------------------------------------------------
&gt; E. mnaser@vexxhost.com
&gt; W. http://vexxhost.com
&gt;
&gt;
You are right, there is such option, may i know what version of virt-install
you are running ?
I am using

root@cloudnode2:~/new# virt-install --version
0.500.1
root@cloudnode2:~/new#

Regards,
Peter

[Attachment #3 (text/html)]

&lt;div class="gmail_quote"&gt;On Sun, Oct 23, 2011 at 2:21 AM, Mohammed Naser &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:mnaser@vexxhost.com"&gt;mnaser@vexxhost.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt; &lt;div&gt;&lt;div class="gmail_quote"&gt;&lt;div class="im"&gt;On Sat, \
Oct 22, 2011 at 2:11 PM, vmnode guy &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:vmnodeguy@gmail.com" target="_blank"&gt;vmnodeguy@gmail.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex"&gt;

&lt;div&gt;Seem like there is no such option, or could my option place it incorrectly \
?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;root@cloudnode2:~/new# cat virt-install.sh \
&lt;/div&gt;&lt;div&gt;vm_uid=testvm&lt;/div&gt;&lt;div&gt;vcpu=2&lt;/div&gt;&lt;div&gt;ram=512&lt;/div&gt; &lt;div&gt;

diskspace=10&lt;/div&gt;&lt;div&gt;path=/home/source/ubuntu-10.04.2-server-amd64.iso&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#virt-install \
-n $vm_uid --vcpus=$vcpu -r $ram -f /root/new/disk0.raw -s $diskspace -c $path \
--accelerate --connect=qemu:///system --vnc --vnclisten=0.0.0.0 --noautoconsole \
-v&lt;/div&gt;


&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;virt-install -n $vm_uid --vcpus=$vcpu -r $ram -f \
/root/new/disk0.raw -s $diskspace -c $path --accelerate --connect=qemu:///system \
--vnc --graphics vnc,password=testing --noautoconsole \
-v&lt;/div&gt;&lt;div&gt;root@cloudnode2:~/new# &lt;/div&gt;


&lt;div&gt;root@cloudnode2:~/new# &lt;/div&gt;&lt;div&gt;root@cloudnode2:~/new# sh virt-install.sh \
&lt;/div&gt;&lt;div&gt;Usage: virt-install --name NAME --ram RAM STORAGE INSTALL \
[options]&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;virt-install: error: no such option: \
--graphics&lt;/div&gt;


&lt;div&gt;root@cloudnode2:~/new# &lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;Peter \
Cheng&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Are \
you sure that you're running the latest virt-install -- because latest does have \
that option.  If you refer to the manpages of the latest version: &lt;/div&gt;

&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;a \
href="http://git.fedorahosted.org/git/?p=python-virtinst.git;a=blob;f=man/en/virt-install.pod.in#l633" \
target="_blank"&gt;http://git.fedorahosted.org/git/?p=python-virtinst.git;a=blob;f=man/en/virt-install.pod.in#l633&lt;/a&gt;&lt;/div&gt;


&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I recommend you update your virt-install version in order to be \
able to use that option, otherwise, you might be limited in your options.  You could \
add a command that sets it manually by connecting to qemu (might be more \
complicated).  If it's the same password, I think you could leave it in \
/etc/libvirt/qemu.conf&lt;/div&gt;

&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;a \
href="http://wiki.libvirt.org/page/QEMUSwitchToLibvirt#change_vnc_PASSWORD" \
target="_blank"&gt;http://wiki.libvirt.org/page/QEMUSwitchToLibvirt#change_vnc_PASSWORD&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Let \
me know if this helps.&lt;/div&gt;

&lt;/div&gt;&lt;div class="im"&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- &lt;br&gt;&lt;span \
style="font-family:Arial;font-size:8pt"&gt;&lt;span style="color:rgb(70, 130, \
180);font-size:10pt"&gt;Mohammed Naser&lt;/span&gt; — &lt;span \
style="font-weight:bold"&gt;vexxhost&lt;/span&gt;&lt;br&gt;&lt;/span&gt;&lt;div&gt; &lt;span \
style="font-family:Arial;font-size:8pt"&gt;&lt;span&gt;&lt;span style="color:rgb(220, 220, \
220)"&gt;-----------------------------------------------------&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
 &lt;/div&gt;&lt;div class="im"&gt;&lt;div&gt;&lt;span style="font-family:Arial;font-size:11px"&gt;&lt;span \
style="font-weight:bold"&gt;E. &lt;/span&gt;&lt;a href="mailto:mnaser@vexxhost.com" \
target="_blank"&gt;mnaser@vexxhost.com&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="font-family:Arial;font-size:11px"&gt;&lt;span style="font-weight:bold"&gt;W. &lt;/span&gt;&lt;a \
href="http://vexxhost.com/" target="_blank"&gt;http://vexxhost.com&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;

&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;You are right, there is such option, may i know what \
version of virt-install you are running ?&lt;/div&gt;&lt;div&gt;I am using \
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;root@cloudnode2:~/new# virt-install --version&lt;/div&gt; \
&lt;div&gt;0.500.1&lt;/div&gt;&lt;div&gt;root@cloudnode2:~/new# \
&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;Peter&lt;/div&gt;



</body></email><email><emailId>20111017141905</emailId><senderName>חץ בן חמו</senderName><senderEmail>hetz@benhamo.org</senderEmail><timestampReceived>2011-10-17 14:19:05-0400</timestampReceived><subject>[libvirt-users] libvirt ESXI driver's capabilities</subject><body>

Hello,

I've read a bit about libvirt in the web site, and I couldn't find anywhere
whats the VMWare driver is capable of.
I'm planning to build something that will let me manage multiple ESXI hosts
(without vcenter) and before I hire a developer, I would like to ask if it
supports the following items:

* creating thin provisioning disks (when creating a new vm for example)
* snapshots - create / restore / limit amounts of snapshots
* modifications of live machines (if possible)
* graphs (is it possible to build graph with libvirt??)
* shutdown / pause / restart

I really wish there was a document which would show the driver's
limitations..

Another question: is there any book / pdf which is updated and can provide
the info of what libvirt capabilities are there and how to use them?

Thanks,
Hetz

[Attachment #3 (text/html)]

&lt;div dir="rtl"&gt;&lt;div dir="ltr"&gt;Hello,&lt;/div&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
dir="ltr"&gt;I've read a bit about libvirt in the web site, and I couldn't find \
anywhere whats the VMWare driver is capable of.&lt;/div&gt;&lt;div dir="ltr"&gt; I'm planning \
to build something that will let me manage multiple ESXI hosts (without vcenter) and \
before I hire a developer, I would like to ask if it supports the following \
                items:&lt;/div&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="ltr"&gt;
* creating thin provisioning disks (when creating a new vm for example)&lt;/div&gt;&lt;div \
dir="ltr"&gt;* snapshots - create / restore / limit amounts of snapshots&lt;/div&gt;&lt;div \
dir="ltr"&gt;* modifications of live machines (if possible)&lt;/div&gt; &lt;div dir="ltr"&gt;* \
graphs (is it possible to build graph with libvirt??)&lt;/div&gt;&lt;div dir="ltr"&gt;* shutdown \
/ pause / restart&lt;/div&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="ltr"&gt;I really wish there \
was a document which would show the driver's limitations..&lt;/div&gt; &lt;div \
dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="ltr"&gt;Another question: is there any book / pdf which is \
updated and can provide the info of what libvirt capabilities are there and how to \
use them?&lt;/div&gt;&lt;div dir="ltr"&gt;&lt;br&gt;&lt;/div&gt;&lt;div dir="ltr"&gt; Thanks,&lt;/div&gt;&lt;div \
dir="ltr"&gt;Hetz&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20111017151046</emailId><senderName>PREETHI RAMESH</senderName><senderEmail>iampreethiramesh@gmail.com</senderEmail><timestampReceived>2011-10-17 15:10:46-0400</timestampReceived><subject>[libvirt-users] Help with running virt-top from Java file</subject><body>

I've been trying to run virt-top to save the usage statistics to a csv file
from my Java code using process builder. However, this gets executed in the
Java file but I don't seem to find the file created anywhere. Is executing
virt-top possible via a Java code? I'm using the example
here&lt;http://forums.devx.com/showthread.php?t=147403&gt;replacing ls -l
with virt-top --csv file2.csv.

I plan to generate the graphs from the csv files to load them on to my Java
UI. If there are other alternatives to my method, please tell me as I've
been trying to get one for almost a week now.
Thanks a lot!
Preethi

[Attachment #3 (text/html)]

I've been trying to run virt-top to save the usage statistics to a csv file from \
my Java code using process builder. However, this gets executed in the Java file but \
I don't seem to find the file created anywhere. Is executing virt-top possible \
via a Java code? I'm using the example &lt;a \
href="http://forums.devx.com/showthread.php?t=147403"&gt;here&lt;/a&gt; replacing ls -l with \
virt-top --csv file2.csv.&lt;br&gt; &lt;br&gt;I plan to generate the graphs from the csv files to \
load them on to my Java UI. If there are other alternatives to my method, please tell \
me as I've been trying to get one for almost a week now.&lt;br&gt;Thanks a lot! &lt;br&gt; \
Preethi&lt;br&gt;



</body></email><email><emailId>20111018021141</emailId><senderName>d hee</senderName><senderEmail>coolio@ymail.com</senderEmail><timestampReceived>2011-10-18 02:11:41-0400</timestampReceived><subject>Re: [libvirt-users] Virtio Balloon- Can not see the results</subject><body>

Hi Eric,

Thank you for your reply. After doing some research, it seems the host(not the guest) \
needs to request the memory. I'm not short on memory so I guess that is why I did not \
see any balloon activity.

I also read(off of IBM) where it can cause the guest to run out of cache and increase \
block I/O activity which makes no sense to me- sense the balloon only expands and \
takes of memory in the guest that is not used. 



-dman



________________________________
From: Eric Blake &lt;eblake@redhat.com&gt;
To: d hee &lt;coolio@ymail.com&gt;
Cc: "libvirt-users@redhat.com" &lt;libvirt-users@redhat.com&gt;
Sent: Monday, October 17, 2011 12:43 PM
Subject: Re: [libvirt-users] Virtio Balloon- Can not see the results

On 10/13/2011 12:00 AM, d hee wrote:
&gt; with kvm and virtio- would -m 1024 take proceedence over -balloon
&gt; virtio? when i use both together, i see memory stay around 1024 MB less on my host \
&gt; side. I know the guest is not taking but a fraction of that ram, so I would expect \
&gt; the virtio balloon to take the majority of the guests ram and hand it back to the \
&gt; host. this is using the free util/command to take snapshots of the host memory.

Some helpful reading:
https://rwmj.wordpress.com/2010/07/17/virtio-balloon/
http://publib.boulder.ibm.com/infocenter/lnxinfo/v3r0m0/index.jsp?topic=%2Fliaat%2Fliaatbpballooning.htm


Remember that libvirt defaults to using both -m (maximum memory) and a virtio balloon \
(using -device virtio-balloon-pci, rather than -balloon, but the concept is the \
same).  As far as I know, there is _no way_ with current qemu to start a guest with \
less than maximum memory; rather, you are forced to start with maximum then rely on \
balloon to reduce the usage back down.  And this, unfortunately, requires guest \
cooperation. If the guest doesn't know how to use the virtio balloon driver, then you \
are stuck - the guest uses the maximum memory.  That said, from the host side, memory \
usage is still under normal host memory management rules, even if ballooning doesn't \
work, where the host can swap out pages that have not yet been touched by the guest, \
so that not all of the memory attributed to the guest is actually tying up host \
pages.

There's certainly room for improvement here, but it has to start with qemu \
improvements.

-- Eric Blake  eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


[Attachment #3 (text/html)]

&lt;html&gt;&lt;body&gt;&lt;div style="color:#000; background-color:#fff; font-family:arial, \
helvetica, sans-serif;font-size:10pt"&gt;&lt;div&gt;&lt;span&gt;Hi \
Eric,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;Thank you for your reply. \
After doing some research, it seems the host(not the guest) needs to request the \
memory. I'm not short on memory so I guess that is why I did not see any balloon \
activity.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt; I also read(off of IBM) \
where it can cause the guest to run out of cache and increase block I/O activity \
which makes no sense to me- sense the balloon only expands and takes of memory in the \
guest that is not used. \
&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-dman&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
style="font-family: arial, helvetica, sans-serif; font-size: 10pt;"&gt;&lt;div \
style="font-family: times new roman, new york, times, serif; font-size: 12pt;"&gt;&lt;font \
face="Arial" size="2"&gt;&lt;hr size="1"&gt;&lt;b&gt;&lt;span  \
style="font-weight:bold;"&gt;From:&lt;/span&gt;&lt;/b&gt; Eric Blake \
&lt;eblake@redhat.com&gt;&lt;br&gt;&lt;b&gt;&lt;span style="font-weight: bold;"&gt;To:&lt;/span&gt;&lt;/b&gt; d hee \
&lt;coolio@ymail.com&gt;&lt;br&gt;&lt;b&gt;&lt;span style="font-weight: bold;"&gt;Cc:&lt;/span&gt;&lt;/b&gt; \
"libvirt-users@redhat.com" &lt;libvirt-users@redhat.com&gt;&lt;br&gt;&lt;b&gt;&lt;span \
style="font-weight: bold;"&gt;Sent:&lt;/span&gt;&lt;/b&gt; Monday, October 17, 2011 12:43 \
PM&lt;br&gt;&lt;b&gt;&lt;span style="font-weight: bold;"&gt;Subject:&lt;/span&gt;&lt;/b&gt; Re: [libvirt-users] \
Virtio Balloon- Can not see the results&lt;br&gt;&lt;/font&gt;&lt;br&gt; On 10/13/2011 12:00 AM, d hee \
wrote:&lt;br&gt;&gt; with kvm and virtio- would -m 1024 take proceedence over \
-balloon&lt;br&gt;&gt; virtio? when i use both together, i see memory stay around 1024 MB \
less on my host side. I know the guest is not taking but a fraction of that ram, so I \
would expect the virtio balloon to take the majority of the guests ram and hand it \
back to the host. this is using the free util/command to take snapshots of the host \
memory.&lt;br&gt;&lt;br&gt;Some helpful reading:&lt;br&gt;&lt;a \
href="https://rwmj.wordpress.com/2010/07/17/virtio-balloon/" \
target="_blank"&gt;https://rwmj.wordpress.com/2010/07/17/virtio-balloon/&lt;/a&gt;&lt;br&gt;http://pu \
blib.boulder.ibm.com/infocenter/lnxinfo/v3r0m0/index.jsp?topic=%2Fliaat%2Fliaatbpballooning.htm&lt;br&gt;&lt;br&gt;Remember \
that libvirt defaults to using both -m (maximum memory) and a virtio balloon (using \
-device virtio-balloon-pci, rather than -balloon, but the concept is the same).  \
As far as I know, there is _no way_ with current qemu to  start a guest with less \
than maximum memory; rather, you are forced to start with maximum then rely on \
balloon to reduce the usage back down.  And this, unfortunately, requires guest \
cooperation. If the guest doesn't know how to use the virtio balloon driver, then you \
are stuck - the guest uses the maximum memory.  That said, from the host side, \
memory usage is still under normal host memory management rules, even if ballooning \
doesn't work, where the host can swap out pages that have not yet been touched by the \
guest, so that not all of the memory attributed to the guest is actually tying up \
host pages.&lt;br&gt;&lt;br&gt;There's certainly room for improvement here, but it has to start \
with qemu improvements.&lt;br&gt;&lt;br&gt;-- Eric Blake   &lt;a \
ymailto="mailto:eblake@redhat.com" \
href="mailto:eblake@redhat.com"&gt;eblake@redhat.com&lt;/a&gt;    \
+1-801-349-2682&lt;br&gt;Libvirt virtualization library \
http://libvirt.org&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20111018021719</emailId><senderName></senderName><senderEmail>zlh_086@126.com</senderEmail><timestampReceived>2011-10-18 02:17:19-0400</timestampReceived><subject>Re: [libvirt-users] no connection driver available for openvz:///system</subject><body>

dears
thanks your answers,I


I would like to use virt-manager manage openvz,because I want to run KVM and openvz \
concurrently in the same physical host. But I dont kown how to rebuild my own libvirt \
to enable the extra bits.  In virt-manager I can just do "File" -&gt; "Add Conection" to \
connect a new server for 'openvz' to the same interface. can you tell me how to \
rebuild libvirt to use virt-manager manager openvz in detail ,like supporting KVM or \
xen in virt-manager. my os is centos6.0_X86_64.

I would greatly appreciate you!


[Attachment #3 (text/html)]

&lt;div style="line-height:1.7;color:#000000;font-size:14px;font-family:arial"&gt;&lt;div \
style="line-height: 1.7; color: rgb(0, 0, 0); font-size: 14px; font-family: \
arial;"&gt;dears&lt;br&gt;thanks your answers,I &lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt;&lt;div \
id="divNeteaseMailCard"&gt;&lt;/div&gt;I would like to use virt-manager manage openvz,because \
I want to run KVM and openvz concurrently in the same physical host.&lt;br&gt;But I dont \
kown how to rebuild my own libvirt to enable the extra bits.  In \
virt-manager I can just do "File" -&gt; "Add Conection" to connect a new server for \
'openvz' to the same interface.&lt;br&gt;&lt;span style="color: rgb(255, 0, 0);"&gt;can you tell \
me how to rebuild libvirt to use virt-manager manager openvz in detail ,like \
supporting KVM or xen in virt-manager.&lt;/span&gt; my os is centos6.0_X86_64.&lt;br&gt;&lt;div \
dir="ltr"&gt;I would greatly appreciate \
you!&lt;br&gt;&lt;/div&gt;&lt;pre&gt;&lt;br&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;&lt;span title="neteasefooter"&gt;&lt;span \
id="netease_mail_footer"&gt;&lt;/span&gt;&lt;/span&gt;



</body></email><email><emailId>20111019213136</emailId><senderName>Alex</senderName><senderEmail>mysqlstudent@gmail.com</senderEmail><timestampReceived>2011-10-19 21:31:36-0400</timestampReceived><subject>[libvirt-users] general protection and other errors</subject><body>

Hi,
I'm having a problem with a fedora15 x86_64 host with a fedora15
x86_64 guest on a Xeon E3-1240 with 8GB RAM on the guest. This is the
only guest. The server is configured as a mail server, using
spamassassin, postfix, amavisd, and clamav.

It was previously running without error on different hardware. I
migrated the disks to a more powerful server due to load. It's a new
server, and has been stress tested with memtest86, mprime, and
passmark's Linux test for more than 24 hours without producing a
problem.

However, when I run the kvm vm, I receive a bunch of errors similar to
these on the guest:

[169245.360511] clamscan[27448] general protection ip:7f125f2e6ffb
sp:7fff117566f0 error:0 in libclamav.so.6.1.11[7f125f229000+9ce000]

[29016.445470] clamd[1110] general protection ip:30df2c3981
sp:7fffa08f4fe0 error:0 in libclamav.so.6.1
.11[30df200000+9ce000]

There are other applications, such as pyzor, that produce similar errors.

Is this something that could be a result of some software
configuration error I've made? Is there something I can do to debug
this further? There also aren't any errors on the host indicating a
kernel problem or hardware issue.

Is it possible this is a known error?

I was previously trying to improve IO performance by using 'block'
instead of 'file' for the device, but had to abandon that idea because
it didn't work and I had to concentrate on this problem.

Could disabling the cache (cache=none) cause this?

I've included some info below, in hopes someone could guide me towards
a solution.

# rpm -qva|egrep 'kvm|libvirt|kernel|qemu'
libvirt-python-0.8.8-7.fc15.x86_64
kernel-2.6.40.6-0.fc15.x86_64
qemu-img-0.14.0-8.fc15.x86_64
gpxe-roms-qemu-1.0.1-4.fc15.noarch
kernel-2.6.40.4-5.fc15.x86_64
qemu-system-x86-0.14.0-8.fc15.x86_64
libvirt-0.8.8-7.fc15.x86_64
libvirt-client-0.8.8-7.fc15.x86_64
qemu-common-0.14.0-8.fc15.x86_64
kernel-headers-2.6.40.6-0.fc15.x86_64
qemu-kvm-0.14.0-8.fc15.x86_64

I've included my domain config below in hopes it helps.

&lt;domain type='kvm'&gt;
  &lt;name&gt;mail02&lt;/name&gt;
  &lt;uuid&gt;ec4f3cf5-2f27-fb3e-72f6-3fa3176b13b6&lt;/uuid&gt;
  &lt;memory&gt;6291456&lt;/memory&gt;
  &lt;currentMemory&gt;6291456&lt;/currentMemory&gt;
  &lt;vcpu&gt;4&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='x86_64' machine='pc-0.14'&gt;hvm&lt;/type&gt;
    &lt;boot dev='hd'/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
    &lt;apic/&gt;
    &lt;pae/&gt;
  &lt;/features&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;restart&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/bin/qemu-kvm&lt;/emulator&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;driver name='qemu' type='raw' cache='none'/&gt;
      &lt;source file='/var/lib/libvirt/images/mail02.img'/&gt;
      &lt;target dev='vda' bus='virtio'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x05'
function='0x0'/&gt;
    &lt;/disk&gt;
    &lt;disk type='block' device='cdrom'&gt;
      &lt;driver name='qemu' type='raw'/&gt;
      &lt;target dev='hdc' bus='ide'/&gt;
      &lt;readonly/&gt;
      &lt;address type='drive' controller='0' bus='1' unit='0'/&gt;
    &lt;/disk&gt;
    &lt;controller type='ide' index='0'&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x01'
function='0x1'/&gt;
    &lt;/controller&gt;
    &lt;interface type='bridge'&gt;
      &lt;mac address='52:54:00:67:2c:4c'/&gt;
      &lt;source bridge='br0'/&gt;
      &lt;model type='virtio'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03'
function='0x0'/&gt;
    &lt;/interface&gt;
    &lt;serial type='pty'&gt;
      &lt;target port='0'/&gt;
    &lt;/serial&gt;
    &lt;console type='pty'&gt;
      &lt;target type='serial' port='0'/&gt;
    &lt;/console&gt;
    &lt;input type='mouse' bus='ps2'/&gt;
    &lt;graphics type='vnc' port='-1' autoport='yes'/&gt;
    &lt;video&gt;
      &lt;model type='cirrus' vram='9216' heads='1'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x02'
function='0x0'/&gt;
    &lt;/video&gt;
    &lt;memballoon model='virtio'&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x06'
function='0x0'/&gt;
    &lt;/memballoon&gt;
  &lt;/devices&gt;
&lt;/domain&gt;

Thanks,
Alex

</body></email><email><emailId>20111020065629</emailId><senderName>Alex</senderName><senderEmail>mysqlstudent@gmail.com</senderEmail><timestampReceived>2011-10-20 06:56:29-0400</timestampReceived><subject>Re: [libvirt-users] Identifying proper CPU type</subject><body>

Hi,

&gt;&gt; I've been working on trying to figure out why my virtual machine keeps
&gt;&gt; crashing [...]  As I'm relatively new to this, I believe I may have
&gt;&gt; misconfigured the XML file to try and maximize the CPU features that
&gt;&gt; are available to the guest from the host.
&gt;
&gt; Is it crashing with default configuration or the tuned one?

It was crashing with the most basic XML config file. It included no
&lt;cpu&gt; section at all.

&gt;&gt; The guest processor still seems to indicate there is only one core,
&gt;
&gt; The CPU number seen by the guest is set in the guest configuration file.
&gt; For example, I create my guests with "virt-install" and the generated XML
&gt; file has a "vcpu" parameter that I may tune.

Yes, I have a vcpu section, where I have limited it to four of the
eight, and it still crashes.

&gt;&gt; despite there being 7 processors?
&gt;
&gt; You have 8 CPU (#0 -&gt; #7)

Oops, yes, meant 8. My point there was, however, that the "cpu cores"
field from /proc/cpuinfo indicates "1", not "4" as it does on the
host, even when I make more than 1 core available to the guest.

Thanks again,
Alex

</body></email><email><emailId>20111021033217</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-10-21 03:32:17-0400</timestampReceived><subject>Re: [libvirt-users] Libvirt Live Migrat error</subject><body>

? 2011?10?21? 10:25, Luengffy XUE ??:
&gt; Dear ,
&gt; Today, i use the libvirt-manager to migrate the live VM . Problem 
&gt; comes ad the picture.
&gt; How did it happen?
&gt; Please help me.
&gt; Thanks very much.
&gt; Leungffy XUE
&gt;

Looks like your guest storage is not shared, generally you should mount
the fs contains the guest image to both source and dest host with nfs.

&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users


[Attachment #3 (text/html)]

&lt;html&gt;
  &lt;head&gt;
    &lt;meta content="text/html; charset=ISO-8859-1"
      http-equiv="Content-Type"&gt;
  &lt;/head&gt;
  &lt;body text="#000000" bgcolor="#FFFFFF"&gt;
    于 2011年10月21日 10:25, Luengffy XUE 写道:
    &lt;blockquote
cite="mid:CAOp97YC7hT6PGO7kV6eQ4FK+kobN-B2k2TG8iECTmOjDt-8HUA@mail.gmail.com"
      type="cite"&gt;
      &lt;div class="gmail_quote"&gt;
        &lt;div&gt;Dear ,&lt;/div&gt;
        &lt;div&gt;Today， i use the libvirt-manager to migrate the live \
VM .  Problem comes ad the picture.&lt;/div&gt;
        &lt;div&gt;How did it happen?&lt;/div&gt;
        &lt;div&gt;Please help me.&lt;/div&gt;
        &lt;div&gt;Thanks very much.&lt;/div&gt;
        &lt;div&gt;Leungffy XUE&lt;/div&gt;
      &lt;/div&gt;
      &lt;br&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
    Looks like your guest storage is not shared, generally you should
    mount&lt;br&gt;
    the fs contains the guest image to both source and dest host with
    nfs.&lt;br&gt;
    &lt;br&gt;
    &lt;blockquote
cite="mid:CAOp97YC7hT6PGO7kV6eQ4FK+kobN-B2k2TG8iECTmOjDt-8HUA@mail.gmail.com"
      type="cite"&gt;
      &lt;br&gt;
      &lt;fieldset class="mimeAttachmentHeader"&gt;&lt;/fieldset&gt;
      &lt;br&gt;
      &lt;pre wrap=""&gt;_______________________________________________
libvirt-users mailing list
&lt;a class="moz-txt-link-abbreviated" \
href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt; &lt;a \
class="moz-txt-link-freetext" \
href="https://www.redhat.com/mailman/listinfo/libvirt-users"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;/pre&gt;
  &lt;/blockquote&gt;
    &lt;br&gt;
  &lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20111022183054</emailId><senderName>Mohammed Naser</senderName><senderEmail>mnaser@vexxhost.com</senderEmail><timestampReceived>2011-10-22 18:30:54-0400</timestampReceived><subject>Re: [libvirt-users] virt-install with set vnc password</subject><body>

On Sat, Oct 22, 2011 at 2:24 PM, vmnode guy &lt;vmnodeguy@gmail.com&gt; wrote:

&gt; On Sun, Oct 23, 2011 at 2:21 AM, Mohammed Naser &lt;mnaser@vexxhost.com&gt;wrote:
&gt;
&gt;&gt; On Sat, Oct 22, 2011 at 2:11 PM, vmnode guy &lt;vmnodeguy@gmail.com&gt; wrote:
&gt;&gt;
&gt;&gt;&gt; Seem like there is no such option, or could my option place it
&gt;&gt;&gt; incorrectly ?
&gt;&gt;&gt;
&gt;&gt;&gt; root@cloudnode2:~/new# cat virt-install.sh
&gt;&gt;&gt; vm_uid=testvm
&gt;&gt;&gt; vcpu=2
&gt;&gt;&gt; ram=512
&gt;&gt;&gt;  diskspace=10
&gt;&gt;&gt; path=/home/source/ubuntu-10.04.2-server-amd64.iso
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; #virt-install -n $vm_uid --vcpus=$vcpu -r $ram -f /root/new/disk0.raw -s
&gt;&gt;&gt; $diskspace -c $path --accelerate --connect=qemu:///system --vnc
&gt;&gt;&gt; --vnclisten=0.0.0.0 --noautoconsole -v
&gt;&gt;&gt;
&gt;&gt;&gt; virt-install -n $vm_uid --vcpus=$vcpu -r $ram -f /root/new/disk0.raw -s
&gt;&gt;&gt; $diskspace -c $path --accelerate --connect=qemu:///system --vnc --graphics
&gt;&gt;&gt; vnc,password=testing --noautoconsole -v
&gt;&gt;&gt; root@cloudnode2:~/new#
&gt;&gt;&gt; root@cloudnode2:~/new#
&gt;&gt;&gt; root@cloudnode2:~/new# sh virt-install.sh
&gt;&gt;&gt; Usage: virt-install --name NAME --ram RAM STORAGE INSTALL [options]
&gt;&gt;&gt;
&gt;&gt;&gt; virt-install: error: no such option: --graphics
&gt;&gt;&gt; root@cloudnode2:~/new#
&gt;&gt;&gt;
&gt;&gt;&gt; Regards,
&gt;&gt;&gt; Peter Cheng
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt; Are you sure that you're running the latest virt-install -- because latest
&gt;&gt; does have that option.  If you refer to the manpages of the latest version:
&gt;&gt;
&gt;&gt;
&gt;&gt; http://git.fedorahosted.org/git/?p=python-virtinst.git;a=blob;f=man/en/virt-install.pod.in#l633
&gt;&gt;
&gt;&gt; I recommend you update your virt-install version in order to be able to
&gt;&gt; use that option, otherwise, you might be limited in your options.  You could
&gt;&gt; add a command that sets it manually by connecting to qemu (might be more
&gt;&gt; complicated).  If it's the same password, I think you could leave it in
&gt;&gt; /etc/libvirt/qemu.conf
&gt;&gt;
&gt;&gt; http://wiki.libvirt.org/page/QEMUSwitchToLibvirt#change_vnc_PASSWORD
&gt;&gt;
&gt;&gt; Let me know if this helps.
&gt;&gt;
&gt;&gt; --
&gt;&gt; Mohammed Naser — vexxhost
&gt;&gt; -----------------------------------------------------
&gt;&gt; E. mnaser@vexxhost.com
&gt;&gt; W. http://vexxhost.com
&gt;&gt;
&gt;&gt;
&gt; You are right, there is such option, may i know what version of
&gt; virt-install you are running ?
&gt; I am using
&gt;
&gt; root@cloudnode2:~/new# virt-install --version
&gt; 0.500.1
&gt; root@cloudnode2:~/new#
&gt;
&gt; Regards,
&gt; Peter
&gt;

Hi Peter,

I am not currently running any release on a machine I have direct access to
right now.  However, according to Git, that release is 22 months old (unless
it's backported).  However, according to Git, the manual page was updated to
include it with virtinst 0.500.5

The current latest version is 0.600.0

It's up to you on what you'd like to do at this point.

Good luck!

-- 
Mohammed Naser — vexxhost
-----------------------------------------------------
D. 514-316-8872
D. 800-910-1726 ext. 200
E. mnaser@vexxhost.com
W. http://vexxhost.com

[Attachment #3 (text/html)]

&lt;div class="gmail_quote"&gt;On Sat, Oct 22, 2011 at 2:24 PM, vmnode guy &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:vmnodeguy@gmail.com"&gt;vmnodeguy@gmail.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt; &lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;&lt;div \
class="gmail_quote"&gt;On Sun, Oct 23, 2011 at 2:21 AM, Mohammed Naser &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:mnaser@vexxhost.com" \
target="_blank"&gt;mnaser@vexxhost.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt; &lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex"&gt; &lt;div&gt;&lt;div class="gmail_quote"&gt;&lt;div&gt;On Sat, Oct 22, 2011 at \
2:11 PM, vmnode guy &lt;span dir="ltr"&gt;&lt;&lt;a href="mailto:vmnodeguy@gmail.com" \
target="_blank"&gt;vmnodeguy@gmail.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex"&gt;


&lt;div&gt;Seem like there is no such option, or could my option place it incorrectly \
?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;root@cloudnode2:~/new# cat virt-install.sh  \
&lt;/div&gt;&lt;div&gt;vm_uid=testvm&lt;/div&gt;&lt;div&gt;vcpu=2&lt;/div&gt;&lt;div&gt;ram=512&lt;/div&gt;

&lt;div&gt;

diskspace=10&lt;/div&gt;&lt;div&gt;path=/home/source/ubuntu-10.04.2-server-amd64.iso&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#virt-install \
-n $vm_uid --vcpus=$vcpu -r $ram -f /root/new/disk0.raw -s $diskspace -c $path \
--accelerate --connect=qemu:///system --vnc --vnclisten=0.0.0.0 --noautoconsole \
-v&lt;/div&gt;



&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;virt-install -n $vm_uid --vcpus=$vcpu -r $ram -f \
/root/new/disk0.raw -s $diskspace -c $path --accelerate --connect=qemu:///system \
--vnc --graphics vnc,password=testing --noautoconsole \
-v&lt;/div&gt;&lt;div&gt;root@cloudnode2:~/new#  &lt;/div&gt;



&lt;div&gt;root@cloudnode2:~/new#  &lt;/div&gt;&lt;div&gt;root@cloudnode2:~/new# sh virt-install.sh  \
&lt;/div&gt;&lt;div&gt;Usage: virt-install --name NAME --ram RAM STORAGE INSTALL \
[options]&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;virt-install: error: no such option: \
--graphics&lt;/div&gt;



&lt;div&gt;root@cloudnode2:~/new#  &lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;Peter \
Cheng&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Are \
you sure that you're running the latest virt-install -- because latest does have \
that option.   If you refer to the manpages of the latest version:  &lt;/div&gt;


&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;a \
href="http://git.fedorahosted.org/git/?p=python-virtinst.git;a=blob;f=man/en/virt-install.pod.in#l633" \
target="_blank"&gt;http://git.fedorahosted.org/git/?p=python-virtinst.git;a=blob;f=man/en/virt-install.pod.in#l633&lt;/a&gt;&lt;/div&gt;



&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I recommend you update your virt-install version in order to be \
able to use that option, otherwise, you might be limited in your options.   You could \
add a command that sets it manually by connecting to qemu (might be more \
complicated).   If it's the same password, I think you could leave it in \
/etc/libvirt/qemu.conf&lt;/div&gt;


&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;a \
href="http://wiki.libvirt.org/page/QEMUSwitchToLibvirt#change_vnc_PASSWORD" \
target="_blank"&gt;http://wiki.libvirt.org/page/QEMUSwitchToLibvirt#change_vnc_PASSWORD&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Let \
me know if this helps.&lt;/div&gt;


&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- &lt;br&gt;&lt;span style="font-family:Arial;font-size:8pt"&gt;&lt;span \
style="color:rgb(70, 130, 180);font-size:10pt"&gt;Mohammed Naser&lt;/span&gt;  —  &lt;span \
style="font-weight:bold"&gt;vexxhost&lt;/span&gt;&lt;br&gt;&lt;/span&gt;&lt;div&gt; &lt;span \
style="font-family:Arial;font-size:8pt"&gt;&lt;span&gt;&lt;span style="color:rgb(220, 220, \
220)"&gt;-----------------------------------------------------&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
 &lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;span style="font-family:Arial;font-size:11px"&gt;&lt;span \
style="font-weight:bold"&gt;E.  &lt;/span&gt;&lt;a href="mailto:mnaser@vexxhost.com" \
target="_blank"&gt;mnaser@vexxhost.com&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="font-family:Arial;font-size:11px"&gt;&lt;span style="font-weight:bold"&gt;W.  &lt;/span&gt;&lt;a \
href="http://vexxhost.com/" target="_blank"&gt;http://vexxhost.com&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;


&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;You are right, there is such option, may i \
know what version of virt-install you are running ?&lt;/div&gt;&lt;div&gt;I am using  \
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;root@cloudnode2:~/new# virt-install --version&lt;/div&gt;

&lt;div&gt;0.500.1&lt;/div&gt;&lt;div&gt;root@cloudnode2:~/new#  \
&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;Peter&lt;/div&gt; \
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;Hi Peter,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I am not currently running any \
release on a machine I have direct access to right now.   However, according to Git, \
that release is 22 months old (unless it's backported).   However, according to \
Git, the manual page was updated to include it with virtinst 0.500.5&lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The current latest version is \
0.600.0&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;It's up to you on what you'd like to do at \
this point.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Good luck!&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- &lt;br&gt;&lt;span \
style="font-family:Arial;font-size:8pt"&gt;&lt;span style="color:rgb(70, 130, \
180);font-size:10pt"&gt;Mohammed Naser&lt;/span&gt;  —  &lt;span \
style="font-weight:bold"&gt;vexxhost&lt;/span&gt;&lt;br&gt; &lt;/span&gt;&lt;div&gt;&lt;span \
style="font-family:Arial;font-size:8pt"&gt;&lt;span&gt;&lt;span style="color:rgb(220, 220, \
220)"&gt;-----------------------------------------------------&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="font-family:Arial;font-size:11px;font-weight:bold"&gt;D.  &lt;/span&gt;&lt;span \
style="font-family:Arial;font-size:11px"&gt;514-316-8872&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span \
style="font-family:Arial;font-size:11px"&gt;&lt;span style="font-weight:bold"&gt;D.&lt;/span&gt;  \
800-910-1726 ext. 200&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="font-family:Arial;font-size:11px"&gt;&lt;span style="font-weight:bold"&gt;E.  &lt;/span&gt;&lt;a \
href="mailto:mnaser@vexxhost.com" \
target="_blank"&gt;mnaser@vexxhost.com&lt;/a&gt;&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span \
style="font-family:Arial;font-size:11px"&gt;&lt;span style="font-weight:bold"&gt;W.  &lt;/span&gt;&lt;a \
href="http://vexxhost.com/" target="_blank"&gt;http://vexxhost.com&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;&lt;br&gt; \
&lt;/div&gt;



</body></email><email><emailId>20111024005445</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-10-24 00:54:45-0400</timestampReceived><subject>Re: [libvirt-users] virsh modified option... alternative..</subject><body>

? 2011?10?21? 17:32, vmnode guy ??:
&gt; Hi All,
&gt; I am new to libvirt, i wander how we can achieve below objective, i read through a \
&gt; lot fromlibvirt.org  &lt;http://libvirt.org&gt;  but couldn'tfound any thing solid \
&gt; somethingequivalent to this:- 
&gt; virsh dumpxml dom&gt;  /tmp/dom.xml
&gt; $EDITOR /tmp/dom.xml&amp;&amp;  virsh define /tmp/dom.xml
&gt; 
&gt; What i try to achieve is to have one management server that install with libvirt in \
&gt; place then we can use libvirt to connect to other libvirt box to provision the \
&gt; vm-create, vm-delete&amp;  capable to vm-modified the CPU,MEM,HDD,boot sequence, vnc \
&gt; password attached&amp;  detech network card..on the targeted VM.

there are commands to do the modifications? e.g.

for vnc password changes, HDD:
     # virsh update-device

for mem:
     # virsh setmem
     # virsh setmaxmem

for detach/attach NIC:
     # virsh attach-device
     # virsh detach-device

Not sure how you want to modify the "CPU", you could
see if following commands satisfy you requirement:

     # virsh setvcpus (if you are using qemu-kvm, the cpus in guest won't
                                 be hotpluged/unhotpluged actually, as 
it lacks support)
     # virsh vcpupin

All these commands support change persistent config, But if you are trying
to modify a bunch of domains, scripts is better, though it's not supported
offically by libvirt to modify the domain configs externally.

Regards
Osier


[Attachment #3 (text/html)]

&lt;html&gt;
  &lt;head&gt;
    &lt;meta content="text/html; charset=ISO-8859-1"
      http-equiv="Content-Type"&gt;
  &lt;/head&gt;
  &lt;body text="#000000" bgcolor="#FFFFFF"&gt;
    于 2011年10月21日 17:32, vmnode guy 写道:
    &lt;blockquote
cite="mid:CABM7-r-x9DACPygGa2PrdJ8TOKmhqM1NFt73C1Sae+CUZPzPcw@mail.gmail.com"
      type="cite"&gt;
      &lt;meta http-equiv="content-type" content="text/html;
        charset=ISO-8859-1"&gt;
      &lt;pre style="font-family: 'Times New Roman'; font-size: medium; "&gt;Hi All,&lt;/pre&gt;
      &lt;pre&gt;&lt;font class="Apple-style-span" face="'Times New Roman'" size="3"&gt;I am new \
to libvirt, i wander how we can achieve below objective, i read through a lot from &lt;a \
moz-do-not-send="true" href="http://libvirt.org"&gt;libvirt.org&lt;/a&gt; but couldn't \
&lt;/font&gt;&lt;font class="Apple-style-span" face="'Times New Roman'" size="3"&gt;found any \
thing solid something &lt;/font&gt;&lt;span class="Apple-style-span" style="font-family: \
                'Times New Roman'; font-size: medium; "&gt;equivalent to \
                this:-&lt;/span&gt;&lt;/pre&gt;
      &lt;pre&gt;&lt;span class="Apple-style-span" style="font-family: 'Times New Roman'; \
font-size: medium; "&gt; &lt;/span&gt;&lt;/pre&gt;
      &lt;pre&gt;&lt;span class="Apple-style-span" style="font-family: 'Times New Roman'; \
                font-size: medium; "&gt;  virsh dumpxml dom &gt; \
                /tmp/dom.xml&lt;/span&gt;&lt;/pre&gt;
      &lt;pre style="font-family: 'Times New Roman'; font-size: medium; "&gt;  $EDITOR \
/tmp/dom.xml &amp;&amp; virsh define /tmp/dom.xml

&lt;/pre&gt;
      &lt;pre style="font-family: 'Times New Roman'; font-size: medium; "&gt;What i try to \
achieve is to have one management server that install with libvirt in place then we \
can use libvirt to connect to other libvirt box to provision the vm-create, vm-delete \
&amp; capable to vm-modified the CPU,MEM,HDD,boot sequence, vnc password attached \
&amp; detech network card..on the targeted VM.&lt;/pre&gt;  &lt;/blockquote&gt;
    &lt;br&gt;
    there are commands to do the modifications? e.g.&lt;br&gt;
    &lt;br&gt;
    for vnc password changes, HDD:&lt;br&gt;
        # virsh update-device &lt;br&gt;
    &lt;br&gt;
    for mem:&lt;br&gt;
        # virsh setmem&lt;br&gt;
        # virsh setmaxmem&lt;br&gt;
    &lt;br&gt;
    for detach/attach NIC:&lt;br&gt;
        # virsh attach-device&lt;br&gt;
        # virsh detach-device&lt;br&gt;
    &lt;br&gt;
    Not sure how you want to modify the "CPU", you could&lt;br&gt;
    see if following commands satisfy you requirement:&lt;br&gt;
    &lt;br&gt;
        # virsh setvcpus (if you are using qemu-kvm, the cpus in guest
    won't&lt;br&gt;
                 &amp;nbs \
p;                  \
be hotpluged/unhotpluged actually,  as it lacks support)&lt;br&gt;
        # virsh vcpupin&lt;br&gt;
    &lt;br&gt;
    All these commands support change persistent config, But if you are
    trying &lt;br&gt;
    to modify a bunch of domains, scripts is better, though it's not
    supported&lt;br&gt;
    offically by libvirt to modify the domain configs externally.&lt;br&gt;
    &lt;br&gt;
    Regards&lt;br&gt;
    Osier&lt;br&gt;
  &lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20111024005944</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-10-24 00:59:44-0400</timestampReceived><subject>Re: [libvirt-users] high-privileges</subject><body>

于 2011年10月23日 13:03, Face 写道:
&gt; Anyone
&gt;
&gt; On Fri, Oct 21, 2011 at 11:31 PM, Face&lt;falazemi@gmail.com&gt;  wrote:
&gt;&gt; hello all,
&gt;&gt;
&gt;&gt; my vm (windows server 2008) keep crashing?
&gt;&gt;
&gt;&gt;
&gt;&gt; 2011-09-21 15:00:45.924: 1355: info : libvirt version: 0.9.6
&gt;&gt; 2011-09-21 15:00:45.924: 1355: error : virSysinfoRead:465 : internal
&gt;&gt; error Failed to find path for dmidecode binary
&gt;&gt; 2011-09-21 15:05:43.873: 1349: warning : qemuDomainObjTaint:1128 :
&gt;&gt; Domain id=1 name='IIS' uuid=a02e41a9-9f4d-d94f-43a6-995b1ca6d37d is
&gt;&gt; tainted: high-privileges

This is just a warning for you started the VM with root priviledge,
but non-root priviledge user such as "qemu:qemu" which is used
by default in libvirt. And this is not the cause your domain crashing

&gt;&gt; 2011-09-21 16:07:10.593: 1344: error : qemuMonitorIO:541 : internal
&gt;&gt; error End of file from monitor

This is the error which tells your domain is crashed, but there are
bunchs of reasons for these error, it's not enough to tell what
happened actually. There might be error in guest logs too,
(/var/log/libvirt/qemu/$domain.log), though it might be not enough
to tell the cause either.


&gt;&gt;
&gt;&gt;
&gt;&gt; Any help would be much appreciated.
&gt;&gt;
&gt;&gt; --
&gt;&gt; Sincerely,
&gt;&gt; falazemi
&gt;&gt;
&gt; Anyone
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20111024092403</emailId><senderName>Stefano Facchini</senderName><senderEmail>stefano.facchini@gmail.com</senderEmail><timestampReceived>2011-10-24 09:24:03-0400</timestampReceived><subject>Re: [libvirt-users] VirtualBox 4.1 support</subject><body>

Il giorno lun, 24/10/2011 alle 09.04 +0800, Osier Yang ha scritto:
&gt; 于 2011年10月23日 23:45, Stefano Facchini 写道:
&gt; &gt; Il giorno dom, 23/10/2011 alle 16.13 +0200, Matthias Bolte ha scritto:
&gt; &gt;&gt; 2011/10/23 Stefano Facchini&lt;stefano.facchini@gmail.com&gt;:
&gt; &gt;&gt;&gt; Is version 4.1 (and later) of VirtualBox supported by libvirt?
&gt; &gt;&gt; Currently libvirt supports up to VirtualBox 4.0. Here's a patch for 4.1 support
&gt; &gt;&gt;
&gt; &gt;&gt; https://www.redhat.com/archives/libvir-list/2011-October/msg01080.html
&gt; &gt;&gt;
&gt; &gt; I tried the patch with VirtualBox 4.1.4, and it seems to work. The only
&gt; &gt; difference with QEMU is that VMs are displayed in a VirtualBox window
&gt; &gt; instead of the native virt-manager window.
&gt; 
&gt; have you created a connection of VBOX in virt-manager? it
&gt; connects to qemu driver by default.
Sure, I created a connection to vbox+unix:///session which lets me see
my virtualbox VMs in virt-manager. But if a open a VM, virt-manager runs
VirtualBox to show the display (differently from QEMU guests, for
example).

Then I tried to launch the machine with:

  $ VirtualHeadless --startvm "GuestMachine" -vnc -vncport 5900

and then tried to connect to it with

  $ virt-manager -c vnc+tcp://localhost:5900

but I got this:

packet 1380336156 bytes received from server too large, want 262144

Traceback (most recent call last):
  File "/usr/share/virt-manager/virtManager/connection.py", line 1146,
in _open_thread
    self.vmm = self._try_open()
  File "/usr/share/virt-manager/virtManager/connection.py", line 1130,
in _try_open
    flags)
  File "/usr/lib/python2.7/site-packages/libvirt.py", line 102, in
openAuth
    if ret is None:raise libvirtError('virConnectOpenAuth() failed')
libvirtError: packet 1380336156 bytes received from server too large,
want 262144

Why I can't connect via VNC? Other clients seems to be able to do that
(Vinagre for example).

Cheers

-- 
Stefano Facchini &lt;stefano.facchini@gmail.com&gt;

</body></email><email><emailId>20111027072112</emailId><senderName>"lingjiao.lc"</senderName><senderEmail>lingjiao.lc@taobao.com</senderEmail><timestampReceived>2011-10-27 07:21:12-0400</timestampReceived><subject>[libvirt-users] delete lvm problem: exited with non-zero status 5 and signal 0</subject><body>

hi,
 I use the libvirt-python to manage my virtual machine. When I delete a
volume use vol.delete(0), sometimes it note me that has occur the error:

                libvirtError: internal error '/sbin/lvremove
                -f /dev/vg.vmms/lvm-v097222.sqa.cm4' exited with
                non-zero status 5 and signal 0:   Can't remove open
                logical volume "lvm-v097222.sqa.cm4".

 then I go to the host and run the command:
        " sudo lvchange -a n /dev/vg.vmms/lvm-v097222.sqa.cm4"
 and then the volume could delete use vol.delete(0).

But it's not often occur, just once in nearly 8.

I know the delete function virStorageBackendLogicalDeleteVol as this:
{
    {
        const char *cmdargv[] = {
            LVREMOVE, "-f",vol-&gt;target.path, NULL
        };

    virCheckFlags(0, -1);

    virFileWaitForDevices();

    if (virRun(cmdargv, NULL) &lt; 0)
        return -1;

    return 0;
}

Could I change it like this: ?
        if (virRun(cmdargv, NULL) &lt; 0)
        const char *changeCmdarg[] = {
         LVCHANGE, "-a", "n", vol-&gt;target.path, NULL
        };
        if(virRun(changeCmdarg, NULL) &lt; 0)
            return -1;
        else
            if(virRun(cmdargv,NULL) &lt; 0)
                return -1;



________________________________

This email (including any attachments) is confidential and may be legally privileged. \
If you received this email in error, please delete it immediately and do not copy it \
or use it for any purpose or disclose its contents to any other person. Thank you.

���������(������������������)�������������������������������������������������������������������������������������������� \
���������������������������������������������������������������������������������������������������������������������



</body></email><email><emailId>20111028033738</emailId><senderName>Luengffy XUE</senderName><senderEmail>feiliangxue@gmail.com</senderEmail><timestampReceived>2011-10-28 03:37:38-0400</timestampReceived><subject>[libvirt-users] live migration error without shared storage</subject><body>

[Attachment #2 (multipart/alternative)]


command:

virsh migrate --live --copy-storage-all vm
qemu+ssh://destinationHost/system

error
: unexpected failure

PS  log file in the jpg

[Attachment #5 (text/html)]

&lt;div&gt;command:&lt;/div&gt;
&lt;div&gt;=A0&lt;/div&gt;
&lt;div&gt;virsh migrate --live --copy-storage-all vm qemu+ssh://destinationHost/=
system=A0 &lt;/div&gt;
&lt;div&gt;=A0&lt;/div&gt;
&lt;div&gt;error&lt;/div&gt;
&lt;div&gt;: unexpected failure&lt;/div&gt;
&lt;div&gt;=A0&lt;/div&gt;
&lt;div&gt;PS=A0 log file in the jpg&lt;/div&gt;

--20cf305e25275b7be304b0539c98--
["ERROR.jpg" (image/jpeg)]

</body></email><email><emailId>20111028040243</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-10-28 04:02:43-0400</timestampReceived><subject>Re: [libvirt-users] live migration error without shared storage</subject><body>

On 10/27/2011 09:37 PM, Luengffy XUE wrote:
&gt; command:
&gt;
&gt; virsh migrate --live --copy-storage-all vm
&gt; qemu+ssh://destinationHost/system
&gt;
&gt; error
&gt; : unexpected failure
&gt;
&gt; PS  log file in the jpg

Your jpg takes up a lot of bandwidth; it would be more efficient if you 
copy and paste the text from your console, rather than a screenshot of 
the console.

As to the actual error, I'm not sure if I can offer advice until I try 
to reproduce it, but I do know that --copy-storage-all hasn't received 
as much testing.  Make sure that an empty file exists on the destination 
prior to the migration attempt, in case the error is stemming from qemu 
on the destination unable to open the file with SELinux permissions in 
force.

Also, what version of libvirt are you using?  Newer libvirt tries harder 
to avoid the lame error messages from qemu being unable to start a 
migration without giving any reasons why.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20111028065404</emailId><senderName>Luengffy XUE</senderName><senderEmail>feiliangxue@gmail.com</senderEmail><timestampReceived>2011-10-28 06:54:04-0400</timestampReceived><subject>Re: [libvirt-users] live migration error without shared storage</subject><body>

2011/10/28 Eric Blake &lt;eblake@redhat.com&gt;

&gt; On 10/27/2011 09:37 PM, Luengffy XUE wrote:
&gt;
&gt;&gt; command:
&gt;&gt;
&gt;&gt; virsh migrate --live --copy-storage-all vm
&gt;&gt; qemu+ssh://destinationHost/**system
&gt;&gt;
&gt;&gt; error
&gt;&gt; : unexpected failure
&gt;&gt;
&gt;&gt; PS  log file in the jpg
&gt;&gt;
&gt;
&gt; Your jpg takes up a lot of bandwidth; it would be more efficient if you
&gt; copy and paste the text from your console, rather than a screenshot of the
&gt; console.
&gt;
&gt;
I appologize for this. I ca paste the text version.
In the destinaiton host's   /var/log/libvirt/qemu/vm.log
It is described as:

2011-10-28 11:29:31.715: starting up
LC_ALL=C PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin
QEMU_AUDIO_DRV=none /usr/bin/kvm -S -M pc-0.14 -enable-kvm -m 512 -smp
1,sockets=1,cores=1,threads=1 -name VCentOS -uuid
f4dcf69e-5c23-a4bd-0262-0fee80b2bba6 -nodefconfig -nodefaults -chardev
socket,id=charmonitor,path=/var/lib/libvirt/qemu/VCentOS.monitor,server,nowait
-mon chardev=charmonitor,id=monitor,mode=readline -rtc base=utc -boot c
-drive
file=/var/lib/libvirt/images/CentOS.qcow2,if=none,id=drive-ide0-0-0,format=raw
-device ide-drive,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0 -drive
if=none,media=cdrom,id=drive-ide0-1-0,readonly=on,format=raw -device
ide-drive,bus=ide.1,unit=0,drive=drive-ide0-1-0,id=ide0-1-0 -netdev
tap,fd=19,id=hostnet0 -device
rtl8139,netdev=hostnet0,id=net0,mac=52:54:00:f6:2b:3a,bus=pci.0,addr=0x3
-chardev pty,id=charserial0 -device
isa-serial,chardev=charserial0,id=serial0 -usb -vnc 127.0.0.1:0 -vga cirrus
-incoming tcp:0.0.0.0:49170 -device
virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x4
char device redirected to /dev/pts/1
Receiving block device images
Completed 0 %
qemu: warning: error while loading state section id 2
load of migration failed
2011-10-28 11:29:32.401: shutting down






&gt; As to the actual error, I'm not sure if I can offer advice until I try to
&gt; reproduce it, but I do know that --copy-storage-all hasn't received as much
&gt; testing.  Make sure that an empty file exists on the destination prior to
&gt; the migration attempt, in case the error is stemming from qemu on the
&gt; destination unable to open the file with SELinux permissions in force.
&gt;
&gt;
I  have created the right image file on the destination host.I have already
reardown the apparmor. I want to know how to shut down the selinux on the
ubuntu server.






&gt; Also, what version of libvirt are you using?  Newer libvirt tries harder to
&gt; avoid the lame error messages from qemu being unable to start a migration
&gt; without giving any reasons why.
&gt;
&gt;

The version of libvit I am using is:

Compiled against library  :  libvir 0.8.8
Using library:      libvir  0.8.8
Using API :  QEMU 0.8.8
Runing hypervisor: QEMU 0.14.0



&gt; --
&gt; Eric Blake   eblake@redhat.com    +1-801-349-2682
&gt; Libvirt virtualization library http://libvirt.org
&gt;


Regards
Leungffy

[Attachment #3 (text/html)]

&lt;br&gt;&lt;br&gt;
&lt;div class="gmail_quote"&gt;2011/10/28 Eric Blake &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:eblake@redhat.com"&gt;eblake@redhat.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt; &lt;blockquote \
style="BORDER-LEFT: #ccc 1px solid; MARGIN: 0px 0px 0px 0.8ex; PADDING-LEFT: 1ex" \
class="gmail_quote"&gt;On 10/27/2011 09:37 PM, Luengffy XUE wrote:&lt;br&gt; &lt;blockquote \
style="BORDER-LEFT: #ccc 1px solid; MARGIN: 0px 0px 0px 0.8ex; PADDING-LEFT: 1ex" \
class="gmail_quote"&gt;command:&lt;br&gt;&lt;br&gt;virsh migrate --live --copy-storage-all \
vm&lt;br&gt;qemu+ssh://destinationHost/&lt;u&gt;&lt;/u&gt;system&lt;br&gt; &lt;br&gt;error&lt;br&gt;: unexpected \
failure&lt;br&gt;&lt;br&gt;PS  log file in the jpg&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;Your jpg takes up a lot of \
bandwidth; it would be more efficient if you copy and paste the text from your \
console, rather than a screenshot of the console.&lt;br&gt; &lt;br&gt;&lt;/blockquote&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt;I appologize for this. I ca paste the text version.&lt;/div&gt;
&lt;div&gt;In the destinaiton host's   /var/log/libvirt/qemu/vm.log&lt;/div&gt;
&lt;div&gt;It is described as:&lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt;2011-10-28 11:29:31.715: starting up&lt;br&gt;LC_ALL=C \
PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin QEMU_AUDIO_DRV=none \
/usr/bin/kvm -S -M pc-0.14 -enable-kvm -m 512 -smp 1,sockets=1,cores=1,threads=1 \
-name VCentOS -uuid f4dcf69e-5c23-a4bd-0262-0fee80b2bba6 -nodefconfig -nodefaults \
-chardev socket,id=charmonitor,path=/var/lib/libvirt/qemu/VCentOS.monitor,server,nowait \
-mon chardev=charmonitor,id=monitor,mode=readline -rtc base=utc -boot c -drive \
file=/var/lib/libvirt/images/CentOS.qcow2,if=none,id=drive-ide0-0-0,format=raw \
-device ide-drive,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0 -drive \
if=none,media=cdrom,id=drive-ide0-1-0,readonly=on,format=raw -device \
ide-drive,bus=ide.1,unit=0,drive=drive-ide0-1-0,id=ide0-1-0 -netdev \
tap,fd=19,id=hostnet0 -device \
rtl8139,netdev=hostnet0,id=net0,mac=52:54:00:f6:2b:3a,bus=pci.0,addr=0x3 -chardev \
pty,id=charserial0 -device isa-serial,chardev=charserial0,id=serial0 -usb -vnc &lt;a \
href="http://127.0.0.1:0"&gt;127.0.0.1:0&lt;/a&gt; -vga cirrus -incoming tcp:&lt;a \
href="http://0.0.0.0:49170"&gt;0.0.0.0:49170&lt;/a&gt; -device \
virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x4&lt;br&gt; char device redirected to \
/dev/pts/1&lt;br&gt;Receiving block device images&lt;br&gt;Completed 0 %&lt;br&gt;qemu: warning: error \
while loading state section id 2&lt;br&gt;load of migration failed&lt;br&gt;2011-10-28 \
11:29:32.401: shutting down&lt;/div&gt; &lt;div&gt; &lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;blockquote style="BORDER-LEFT: #ccc 1px solid; MARGIN: 0px 0px 0px 0.8ex; \
PADDING-LEFT: 1ex" class="gmail_quote"&gt;As to the actual error, I'm not sure if I \
can offer advice until I try to reproduce it, but I do know that --copy-storage-all \
hasn't received as much testing.  Make sure that an empty file exists on the \
destination prior to the migration attempt, in case the error is stemming from qemu \
on the destination unable to open the file with SELinux permissions in force.&lt;br&gt; \
&lt;br&gt;&lt;/blockquote&gt; &lt;div&gt; &lt;/div&gt;
&lt;div&gt;I  have created the right image file on the destination host.I have already \
reardown the apparmor. I want to know how to shut down the selinux on the ubuntu \
server.&lt;/div&gt; &lt;div&gt; &lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;blockquote style="BORDER-LEFT: #ccc 1px solid; MARGIN: 0px 0px 0px 0.8ex; \
PADDING-LEFT: 1ex" class="gmail_quote"&gt;Also, what version of libvirt are you using?  \
Newer libvirt tries harder to avoid the lame error messages from qemu being unable to \
start a migration without giving any reasons why.&lt;br&gt; &lt;font \
color="#888888"&gt;&lt;br&gt;&lt;/font&gt;&lt;/blockquote&gt; &lt;div&gt; &lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt;The version of libvit I am using is:&lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt;Compiled against library  :  libvir 0.8.8&lt;/div&gt;
&lt;div&gt;Using library:      libvir  0.8.8&lt;/div&gt;
&lt;div&gt;Using API :  QEMU 0.8.8&lt;/div&gt;
&lt;div&gt;Runing hypervisor: QEMU 0.14.0&lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;blockquote style="BORDER-LEFT: #ccc 1px solid; MARGIN: 0px 0px 0px 0.8ex; \
PADDING-LEFT: 1ex" class="gmail_quote"&gt;&lt;font color="#888888"&gt;-- &lt;br&gt;Eric Blake   &lt;a \
href="mailto:eblake@redhat.com" target="_blank"&gt;eblake@redhat.com&lt;/a&gt;    \
+1-801-349-2682&lt;br&gt; Libvirt virtualization library &lt;a href="http://libvirt.org/" \
target="_blank"&gt;http://libvirt.org&lt;/a&gt;&lt;br&gt;&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt; &lt;div&gt;&lt;br&gt; &lt;/div&gt;
&lt;div&gt;Regards   &lt;/div&gt;
&lt;div&gt;Leungffy&lt;/div&gt;
&lt;div&gt; &lt;/div&gt;



</body></email><email><emailId>20111024151214</emailId><senderName>Dong-In David Kang</senderName><senderEmail>dkang@isi.edu</senderEmail><timestampReceived>2011-10-24 15:12:14-0400</timestampReceived><subject>[libvirt-users] Running LXC instance as a non-root user</subject><body>


 Hello,

 I'm new to this mailing list.
I have a question on running an LXC instance from libvirt as a non-root user.
I saw libvirt can launch a QEMU instance as a non-root user by editing \
/etc/libvirt/qemu.conf configuration file via the user=$USERNAME and group=$GROUPNAME \
parameters. But, I could not find such options for LXC.
Is there a way to run an LXC instance as a non-root user?

 If it is not possible, then could I run libivrtd itself as a non-root user?

 Thanks,

 David.

----------------------
Dr. Dong-In "David" Kang
Computer Scientist
USC/ISI


</body></email><email><emailId>20111024151441</emailId><senderName>Dave Allan</senderName><senderEmail>dallan@redhat.com</senderEmail><timestampReceived>2011-10-24 15:14:41-0400</timestampReceived><subject>Re: [libvirt-users] Unable to acquire lock</subject><body>

On Mon, Oct 24, 2011 at 10:35:13AM +0530, Jatin Kumar wrote:
&gt; Hello,
&gt; I am trying to execute virsh commands on a host but it is giving errors
&gt; due to failure in acquiring lock.
&gt; 
&gt; root@kvm01:~# virsh suspend blindone
&gt; error: Failed to suspend domain blindone
&gt; error: Timed out during operation: cannot acquire state change lock
&gt; 
&gt; Any suggestions how can we figure out possible reasons.

What version of libvirt?

Dave

</body></email><email><emailId>20111024180348</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-10-24 18:03:48-0400</timestampReceived><subject>Re: [libvirt-users] renaming a domain</subject><body>

On 10/24/2011 11:31 AM, Roberto Attias (rattias) wrote:
&gt; Hello,
&gt;
&gt; In my system a VM  with a given domain name is defined and started. At a
&gt; certain point I will define and start a new VM, with a different name. I
&gt; then want to dispose of the old VM and rename the new one to the old
&gt; one. Unfortunately I didn't find any API to do the last  step. Is it
&gt; possible to change the domain name of a running VM?

Not currently, short of migrating the VM twice and using the 
rename-on-migration feature (which ends up creating a new qemu process, 
rather than reusing the existing one).  But the request has been made in 
the past, and if someone were willing to write patches, they would 
likely be accepted.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20111024061242</emailId><senderName>vmnode guy</senderName><senderEmail>vmnodeguy@gmail.com</senderEmail><timestampReceived>2011-10-24 06:12:42-0400</timestampReceived><subject>[libvirt-users] How to collect the VM bandwidth usage utilization</subject><body>

Hi Guy,

I am trying to figure out how &amp; where can i get the bandwidth usage
utilization statistic info for all the VM, so in the end i will be able to
use it for metering purpose..

Anyone got any idea ?

Regards,
Peter

[Attachment #3 (text/html)]

Hi Guy,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I am trying to figure out how &amp; where can i =
get the bandwidth usage utilization statistic info for all the VM, so in th=
e end i will be able to use it for metering purpose..=A0&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/di=
v&gt;
&lt;div&gt;Anyone got any idea ?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;br&gt;Peter&lt;/div&gt;


</body></email><email><emailId>20111030191838</emailId><senderName>Till Mossakowski</senderName><senderEmail>till@communtu.de</senderEmail><timestampReceived>2011-10-30 19:18:38-0400</timestampReceived><subject>[libvirt-users] VM with transient disk</subject><body>

I want to use transient disks with libvirt.
According to [1], the transient disk feature has been supported since 0.9.5.
Hence, I have installed libvirt 0.9.6 for Ubuntu Lucid from [2] and used 
the following disk configuration:

      &lt;disk type='file' device='disk'&gt;
           &lt;driver name='qemu' type='raw'/&gt;
           &lt;source file='/home/till/test.img'/&gt;
           &lt;target dev='vda' bus='virtio'/&gt;
           &lt;transient/&gt;
      &lt;/disk&gt;

However, I get:
unsupported configuration: transient disks not supported yet

Best,
Till

[1] http://libvirt.org/formatdomain.html
[2] http://ppa.launchpad.net/agent-8131/xen-custom/ubuntu/

</body></email><email><emailId>20111031165609</emailId><senderName>Christian Parpart</senderName><senderEmail>trapni@gentoo.org</senderEmail><timestampReceived>2011-10-31 16:56:09-0400</timestampReceived><subject>[libvirt-users] [ruby-libvirt] who's using it</subject><body>

Hey all,

I would like to know who / what project is using this binding. So I could
learn the API a bit easier than reading through the rough rdoc-based API
documentation, which is not really helpful to me, as I do not know the C
API yet either.

my intention is, to some day, be able to create a Rails web app for
managing libvirt hosts (mainly OpenVZ/vserver/LXC and possibly QEMU).

Thanks in advance,
Christian Parpart.

[Attachment #3 (text/html)]

Hey all,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I would like to know who / what project is usin=
g this binding. So I could learn the API a bit easier than reading through =
the rough rdoc-based API documentation, which is not really helpful to me, =
as I do not know the C API yet either.&lt;/div&gt;
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;my intention is, to some day, be able to create a Rails=
 web app for managing libvirt hosts (mainly OpenVZ/vserver/LXC and possibly=
 QEMU).&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks in advance,&lt;/div&gt;&lt;div&gt;Christian Par=
part.&lt;/div&gt;


</body></email><email><emailId>20111031172100</emailId><senderName>Mohammed Naser</senderName><senderEmail>mnaser@vexxhost.com</senderEmail><timestampReceived>2011-10-31 17:21:00-0400</timestampReceived><subject>Re: [libvirt-users] [ruby-libvirt] who's using it</subject><body>

On Mon, Oct 31, 2011 at 12:56 PM, Christian Parpart &lt;trapni@gentoo.org&gt;wrote:

&gt; Hey all,
&gt;
&gt; I would like to know who / what project is using this binding. So I could
&gt; learn the API a bit easier than reading through the rough rdoc-based API
&gt; documentation, which is not really helpful to me, as I do not know the C
&gt; API yet either.
&gt;
&gt; my intention is, to some day, be able to create a Rails web app for
&gt; managing libvirt hosts (mainly OpenVZ/vserver/LXC and possibly QEMU).
&gt;
&gt; Thanks in advance,
&gt; Christian Parpart.
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

Take a look at oVirt, I believe it's mostly written using Ruby on Rails and
uses the Gem.

git://git.fedorahosted.org/git/ovirt/server.git

Good luck!

-- 
Mohammed Naser — vexxhost
-----------------------------------------------------
D. 514-316-8872
D. 800-910-1726 ext. 200
E. mnaser@vexxhost.com
W. http://vexxhost.com

[Attachment #3 (text/html)]

&lt;div class="gmail_quote"&gt;On Mon, Oct 31, 2011 at 12:56 PM, Christian Parpart &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:trapni@gentoo.org"&gt;trapni@gentoo.org&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt; Hey all,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I would like to know who / \
what project is using this binding. So I could learn the API a bit easier than \
reading through the rough rdoc-based API documentation, which is not really helpful \
to me, as I do not know the C API yet either.&lt;/div&gt;

&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;my intention is, to some day, be able to create a Rails web app \
for managing libvirt hosts (mainly OpenVZ/vserver/LXC and possibly \
QEMU).&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks in advance,&lt;/div&gt;&lt;div&gt;Christian Parpart.&lt;/div&gt;

&lt;br&gt;_______________________________________________&lt;br&gt;
libvirt-users mailing list&lt;br&gt;
&lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
&lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;span \
style="font-family: arial, sans-serif; font-size: 13px; background-color: rgb(255, \
255, 255); "&gt;Take a look at oVirt, I believe it's mostly written using Ruby on \
Rails and uses the Gem.&lt;/span&gt;&lt;br clear="all" style="font-family: arial, sans-serif; \
font-size: 13px; background-color: rgb(255, 255, 255); "&gt; &lt;div style="font-family: \
arial, sans-serif; font-size: 13px; background-color: rgb(255, 255, 255); \
"&gt;&lt;br&gt;&lt;/div&gt;&lt;div style="font-family: arial, sans-serif; font-size: 13px; \
background-color: rgb(255, 255, 255); "&gt;git://&lt;a \
href="http://git.fedorahosted.org/git/ovirt/server.git" target="_blank" style="color: \
rgb(66, 99, 171); "&gt;git.fedorahosted.org/git/ovirt/server.git&lt;/a&gt;&lt;/div&gt; &lt;div \
style="font-family: arial, sans-serif; font-size: 13px; background-color: rgb(255, \
255, 255); "&gt;&lt;br&gt;&lt;/div&gt;&lt;div style="font-family: arial, sans-serif; font-size: 13px; \
background-color: rgb(255, 255, 255); "&gt;Good luck!&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;-- &lt;br&gt;&lt;span \
style="font-family:Arial;font-size:8pt"&gt;&lt;span style="color:rgb(70, 130, \
180);font-size:10pt"&gt;Mohammed Naser&lt;/span&gt;  —  &lt;span \
style="font-weight:bold"&gt;vexxhost&lt;/span&gt;&lt;br&gt;&lt;/span&gt;&lt;div&gt;&lt;span \
style="font-family:Arial;font-size:8pt"&gt;&lt;span&gt;&lt;span style="color:rgb(220, 220, \
220)"&gt;-----------------------------------------------------&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
 &lt;div&gt;&lt;span style="font-family:Arial;font-size:11px;font-weight:bold"&gt;D.  \
&lt;/span&gt;&lt;span style="font-family:Arial;font-size:11px"&gt;514-316-8872&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="font-family:Arial;font-size:11px"&gt;&lt;span style="font-weight:bold"&gt;D.&lt;/span&gt;  \
800-910-1726 ext. 200&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span \
style="font-family:Arial;font-size:11px"&gt;&lt;span style="font-weight:bold"&gt;E.  &lt;/span&gt;&lt;a \
href="mailto:mnaser@vexxhost.com" \
target="_blank"&gt;mnaser@vexxhost.com&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="font-family:Arial;font-size:11px"&gt;&lt;span style="font-weight:bold"&gt;W.  &lt;/span&gt;&lt;a \
href="http://vexxhost.com/" target="_blank"&gt;http://vexxhost.com&lt;/a&gt;&lt;/span&gt;&lt;/div&gt; &lt;br&gt;



</body></email><email><emailId>20111031032849</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-10-31 03:28:49-0400</timestampReceived><subject>Re: [libvirt-users] VM with transient disk</subject><body>

On 10/31/2011 03:18 AM, Till Mossakowski wrote:
&gt; I want to use transient disks with libvirt.
&gt; According to [1], the transient disk feature has been supported since 
&gt; 0.9.5.
&gt; Hence, I have installed libvirt 0.9.6 for Ubuntu Lucid from [2] and 
&gt; used the following disk configuration:
&gt;
&gt; &lt;disk type='file' device='disk'&gt;
&gt; &lt;driver name='qemu' type='raw'/&gt;
&gt; &lt;source file='/home/till/test.img'/&gt;
&gt; &lt;target dev='vda' bus='virtio'/&gt;
&gt; &lt;transient/&gt;
&gt; &lt;/disk&gt;
&gt;
&gt; However, I get:
&gt; unsupported configuration: transient disks not supported yet

That's because libvirt supported it yet, but qemu still haven't
complete the support. Not sure if the newest upstream
qemu already supported it though.

Osier

</body></email><email><emailId>20111031065452</emailId><senderName>Till Mossakowski</senderName><senderEmail>till@communtu.de</senderEmail><timestampReceived>2011-10-31 06:54:52-0400</timestampReceived><subject>Re: [libvirt-users] VM with transient disk</subject><body>

Hi Osier,

are there other hypervisors supporting it?

And what about qemu's option "snapshot=on" ?

Best, Till

Am 31.10.2011 04:28, schrieb Osier Yang:
&gt; On 10/31/2011 03:18 AM, Till Mossakowski wrote:
&gt;&gt; I want to use transient disks with libvirt.
&gt;&gt; According to [1], the transient disk feature has been supported since
&gt;&gt; 0.9.5.
&gt;&gt; Hence, I have installed libvirt 0.9.6 for Ubuntu Lucid from [2] and
&gt;&gt; used the following disk configuration:
&gt;&gt;
&gt;&gt; &lt;disk type='file' device='disk'&gt;
&gt;&gt; &lt;driver name='qemu' type='raw'/&gt;
&gt;&gt; &lt;source file='/home/till/test.img'/&gt;
&gt;&gt; &lt;target dev='vda' bus='virtio'/&gt;
&gt;&gt; &lt;transient/&gt;
&gt;&gt; &lt;/disk&gt;
&gt;&gt;
&gt;&gt; However, I get:
&gt;&gt; unsupported configuration: transient disks not supported yet
&gt;
&gt; That's because libvirt supported it yet, but qemu still haven't
&gt; complete the support. Not sure if the newest upstream
&gt; qemu already supported it though.
&gt;
&gt; Osier

</body></email><email><emailId>20111026231824</emailId><senderName>Peter Phaal</senderName><senderEmail>peter.phaal@gmail.com</senderEmail><timestampReceived>2011-10-26 23:18:24-0400</timestampReceived><subject>Re: [libvirt-users] How to collect the VM bandwidth usage utilization</subject><body>

If you are trying to monitor KVM, XenServer or Xen then you might want
to take a look at the Host sFlow project:
http://host-sflow.sourceforge.net/

The Host sFlow agent is installed on the hypervisor and exports
libvirt metrics for the VMs. sFlow uses a push model, continually
streaming the metrics as UDP datagrams to a central collector. Pushing
the statistics scales much better than polling and automatically
adapts as VMs are added, moved and removed.

Take a look at Ganglia for collecting and displaying the metrics:
http://ganglia.sourceforge.net/

If you are using the latest versions of XCP or XenServer, then you can
use sFlow monitoring in the Open vSwitch to get detailed visibility
into traffic flows:
http://openvswitch.org/

Open vSwitch supports both sFlow and NetFlow for traffic monitoring,
the following article provides a comparison:
http://blog.sflow.com/2011/10/comparing-sflow-and-netflow-in-vswitch.html

Peter

On Sun, Oct 23, 2011 at 11:12 PM, vmnode guy &lt;vmnodeguy@gmail.com&gt; wrote:
&gt; Hi Guy,
&gt; I am trying to figure out how &amp; where can i get the bandwidth usage
&gt; utilization statistic info for all the VM, so in the end i will be able to
&gt; use it for metering purpose..
&gt; Anyone got any idea ?
&gt; Regards,
&gt; Peter
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

</body></email><email><emailId>20111024201742</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-10-24 20:17:42-0400</timestampReceived><subject>Re: [libvirt-users] Fwd: Re:  Unable to acquire lock</subject><body>

On 10/24/2011 01:42 PM, Trey Dockendorf wrote:
&gt; Accidentally sent to OP only.
&gt;
&gt; This has been with 0.8.7 on CentOS 6 CR that Ive had the problem.

There are some known locking bugs in 0.8.7, that have been fixed in the 
meantime.  You may want to try 0.9.4 from the RHEL 6.2 beta instead, 
which has tackled a lot of the locking bugs.  Short of that, the only 
solution is to restart libvirtd (the problem is that the older releases 
had some bugs where locks were improperly released if the domain exited 
in the middle of a command).

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20111024214957</emailId><senderName>sethuraman subbiah</senderName><senderEmail>sethusubbiah@gmail.com</senderEmail><timestampReceived>2011-10-24 21:49:57-0400</timestampReceived><subject>Re: [libvirt-users] Hard limit for the cpu usage of a VM</subject><body>

&gt; &gt; 
&gt; &gt; I find that my version is 0.9.4.
&gt; &gt; 
&gt; &gt; [root@sbc11 ssubbiah]# virsh --version
&gt; &gt; 0.9.4
&gt; &gt; 
&gt; &gt; Should I do some modifications,enable options or add some patch to get the \
&gt; &gt; capability to set cap ? Thanks for all your help.
&gt; 
&gt; I found this comment in the code:
&gt; 
&gt; /* If we does not know VCPU&lt;-&gt;PID mapping or all vcpu runs in the same
&gt; * thread, we cannot control each vcpu. So we only modify cpu bandwidth
&gt; * when each vcpu has a separated thread.
&gt; 	
&gt; I think that means that in order to use CPU caps, you have to also use &lt;vcpupin&gt; to \
&gt; call out the host CPU pinning to be used by the guest VCPUS. 
&gt; The original implementation was here, although I don't see much documentation in \
&gt; that patch series. \
&gt; https://www.redhat.com/archives/libvir-list/2011-July/msg01389.html 
&gt; Wen, can you help out here?

Thanks Eric and Hi Wen. I did use &lt;vcpupin&gt; now . This is that part of my config xml \
file :

  &lt;vcpu&gt;3&lt;/vcpu&gt;
  &lt;cputune&gt;
    &lt;vcpupin vcpu='2' cpuset='0-2'/&gt;
  &lt;/cputune&gt;

This shows the vcpu affinity : 

[root@hgcc11 cloning_script]# virsh vcpuinfo rubis_ws
VCPU:           0
CPU:            2
State:          running
CPU time:       5.6s
CPU Affinity:   yyyy

VCPU:           1
CPU:            1
State:          running
CPU time:       0.1s
CPU Affinity:   yyyy

VCPU:           2
CPU:            0
State:          running
CPU time:       0.1s
CPU Affinity:   yyy-

[root@hgcc11 cloning_script]# virsh schedinfo rubis_ws
Scheduler      : posix
cpu_shares     : 1024

Still I get it as an invalid option : 

[root@hgcc11 cloning_script]# virsh schedinfo rubis_ws --set vcpu_quota=1100
Scheduler      : posix
error: invalid scheduler option: vcpu_quota=1100

If I try to add the quota option to the xml file : 

&lt;vcpu&gt;3&lt;/vcpu&gt;
  &lt;cputune&gt;
    &lt;vcpupin vcpu='2' cpuset='0-2'/&gt;
    &lt;quota&gt;-1&lt;/quota&gt;
  &lt;/cputune&gt;
 
I get : 

[root@hgcc11 cloning_script]# virsh create images/rubis_ws.xml 
error: Failed to create domain from images/rubis_ws.xml
error: Unable to set cpu bandwidth quota: No such file or directory


Eventhough I am using libvirt 0.9.4, I think I am missing something.

&gt; 
&gt; -- 
&gt; Eric Blake   eblake@redhat.com    +1-801-349-2682
&gt; Libvirt virtualization library http://libvirt.org


-
Regards,
Sethuraman Subbiah

Graduate Student - NC state University
M.S in Computer Science


</body></email><email><emailId>20111024232708</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-10-24 23:27:08-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt] How to use "virsh migrat" with p2p option?</subject><body>

On 10/24/2011 02:34 AM, Guangya Liu wrote:
&gt; Hi libvirt support,
&gt; 
&gt; Can you please give me some example of how to use "virsh migrate --live" with p2p \
&gt; option including both source host and target host?

https://www.redhat.com/archives/libvir-list/2011-October/msg01104.html

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


</body></email><email><emailId>20111025001834</emailId><senderName>"Guangya Liu"</senderName><senderEmail>gyliu@platform.com</senderEmail><timestampReceived>2011-10-25 00:18:34-0400</timestampReceived><subject>[libvirt-users] =?gb2312?b?u9i4tDogUmU6IFtsaWJ2aXJ0XSBIb3cgdG8g?= =?gb2312?b?dXNlICJ2aXJzaCBtaWdyYXQ</subject><body>

Hi Eric,
 
Thanks for the answer, really appreciated!
 
I noticed that the doc here \
http://libvirt.org/sources/virshcmdref/html-single/#sect-migrate is still not \
updated, where can I get the latest vesrion?  
Thanks,
Guangya Liu
ISF Developer
Platform Computing
Direct: +1 905 948 4526
Skype: guangyaliuf9
www.platform.com &lt;http://www.platform.com&gt; 

 

From: Eric Blake &lt;mailto:eblake@redhat.com&gt; 
Date: 2011-10-25 07:27
To: Guangya Liu &lt;mailto:gyliu@platform.com&gt; 
CC: libvirt-users &lt;mailto:libvirt-users@redhat.com&gt; ; libvir-list \
                &lt;mailto:libvir-list@redhat.com&gt; 
Subject: Re: [libvirt] How to use "virsh migrat" with p2p option?

On 10/24/2011 02:34 AM, Guangya Liu wrote:
&gt; Hi libvirt support,
&gt; 
&gt; Can you please give me some example of how to use "virsh migrate --live" with p2p \
&gt; option including both source host and target host?

https://www.redhat.com/archives/libvir-list/2011-October/msg01104.html

--
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;
&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;Re: [libvirt] How to use "virsh migrat" with p2p option?&lt;/TITLE&gt;
&lt;META content="text/html; charset=gb2312" http-equiv=Content-Type&gt;
&lt;META name=GENERATOR content="MSHTML 8.00.6001.19120"&gt;
&lt;STYLE&gt;
BLOCKQUOTE {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; MARGIN-LEFT: 2em
}
OL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
UL {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
P {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
DIV.FoxDiv20111025081717656457 {
	LINE-HEIGHT: 1.5; FONT-FAMILY: verdana; COLOR: #000000; FONT-SIZE: 10pt
}
BODY {
	LINE-HEIGHT: 1.5; FONT-FAMILY: verdana; COLOR: #000000; FONT-SIZE: 10pt
}
&lt;/STYLE&gt;

&lt;META name=GENERATOR content="MSHTML 8.00.6001.19120"&gt;&lt;/HEAD&gt;
&lt;BODY style="MARGIN: 10px"&gt;
&lt;DIV style="FONT-FAMILY: Calibri; FONT-SIZE: 11pt"&gt;Hi Eric,&lt;/DIV&gt;
&lt;DIV style="FONT-FAMILY: Calibri; FONT-SIZE: 11pt"&gt; &lt;/DIV&gt;
&lt;DIV style="FONT-FAMILY: Calibri; FONT-SIZE: 11pt"&gt;Thanks for the answer, really 
appreciated!&lt;/DIV&gt;
&lt;DIV style="FONT-FAMILY: Calibri; FONT-SIZE: 11pt"&gt; &lt;/DIV&gt;
&lt;DIV style="FONT-FAMILY: Calibri; FONT-SIZE: 11pt"&gt;I noticed that the doc here 
&lt;A 
href="http://libvirt.org/sources/virshcmdref/html-single/#sect-migrate"&gt;http://libvirt.org/sources/virshcmdref/html-single/#sect-migrate&lt;/A&gt; \
 is still not updated, where can I get the latest vesrion?&lt;/DIV&gt;
&lt;DIV style="FONT-FAMILY: Calibri; FONT-SIZE: 11pt"&gt; &lt;/DIV&gt;
&lt;DIV style="FONT-FAMILY: Calibri; FONT-SIZE: 11pt"&gt;Thanks,&lt;/DIV&gt;
&lt;DIV&gt;
&lt;DIV style="FONT-FAMILY: Verdana"&gt;&lt;SPAN&gt;&lt;SPAN 
style="FONT-FAMILY: ËÎÌå; COLOR: #000000; FONT-SIZE: 10.5pt"&gt;
&lt;P 
style="MARGIN: 0in 0in 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto" 
class=MsoNormal&gt;&lt;A name=_MailAutoSig&gt;&lt;B&gt;&lt;SPAN 
style="FONT-FAMILY: Arial; COLOR: maroon; FONT-SIZE: 10pt; mso-no-proof: yes"&gt;&lt;SPAN 
style="FONT-FAMILY: ??"&gt;&lt;/SPAN&gt;Guangya Liu&lt;BR&gt;&lt;/SPAN&gt;&lt;/B&gt;&lt;/A&gt;&lt;SPAN 
style="mso-bookmark: _MailAutoSig"&gt;&lt;SPAN 
style="FONT-FAMILY: Arial; FONT-SIZE: 10pt; mso-no-proof: \
yes"&gt;ISF Developer&lt;BR&gt;&lt;SPAN  style="COLOR: navy"&gt;Platform Computing&lt;/SPAN&gt;&lt;SPAN 
style="COLOR: black"&gt;&lt;BR&gt;&lt;/SPAN&gt;Direct: +1 905 948 4526&lt;BR&gt;Skype: 
guangyaliuf9&lt;BR&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;A title=blocked::http://www.platform.com/ 
href="http://www.platform.com"&gt;&lt;SPAN style="mso-bookmark: _MailAutoSig"&gt;&lt;SPAN 
style="FONT-FAMILY: Arial; FONT-SIZE: 10pt; mso-no-proof: \
yes"&gt;www.platform.com&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;SPAN  style="mso-bookmark: \
_MailAutoSig"&gt;&lt;/SPAN&gt;&lt;/A&gt;&lt;/P&gt; &lt;P 
style="MARGIN: 0in 0in 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto" 
class=MsoNormal&gt;&lt;SPAN style="mso-bookmark: _MailAutoSig"&gt;&lt;/SPAN&gt;&lt;?xml:namespace 
prefix = o ns = "urn:schemas-microsoft-com:office:office" /&gt;&lt;o:p 
style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px"&gt;&lt;/o:p&gt; &lt;/P&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/DIV&gt;
&lt;SCRIPT type=text/javascript&gt;
&lt;!--script
function img_zoom(e, o)
{
var zoom = parseInt(o.style.zoom, 10) || 100;
zoom += e.wheelDelta / 12;
if (((zoom &gt;= 50) &amp;&amp; (e.wheelDelta &lt; 0)) || ((zoom &lt; 200) &amp;&amp; (e.wheelDelta &gt; 0))) \
o.style.zoom = zoom + '%'; return false;
}

--&gt;
&lt;/SCRIPT&gt;
&lt;/DIV&gt;
&lt;DIV 
style="BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; PADDING-BOTTOM: 0cm; \
PADDING-LEFT: 0cm; PADDING-RIGHT: 0cm; BORDER-TOP: #b5c4df 1pt solid; BORDER-RIGHT: \
medium none; PADDING-TOP: 3pt"&gt; &lt;DIV 
style="PADDING-BOTTOM: 8px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; BACKGROUND: \
#efefef; COLOR: #000000; FONT-SIZE: 12px; PADDING-TOP: 8px"&gt; \
&lt;DIV&gt;&lt;B&gt;From:&lt;/B&gt; &lt;A href="mailto:eblake@redhat.com"&gt;Eric Blake&lt;/A&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;B&gt;Date:&lt;/B&gt; 2011-10-25 07:27&lt;/DIV&gt; &lt;DIV&gt;&lt;B&gt;To:&lt;/B&gt; &lt;A \
href="mailto:gyliu@platform.com"&gt;Guangya Liu&lt;/A&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;B&gt;CC:&lt;/B&gt; &lt;A 
href="mailto:libvirt-users@redhat.com"&gt;libvirt-users&lt;/A&gt;; &lt;A 
href="mailto:libvir-list@redhat.com"&gt;libvir-list&lt;/A&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;B&gt;Subject:&lt;/B&gt; Re: [libvirt] How to use "virsh migrat" with p2p 
option?&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;
&lt;DIV&gt;
&lt;DIV class=FoxDiv20111025081717656457&gt;
&lt;META name=Generator content="MS Exchange Server version 6.5.7654.12"&gt;&lt;!-- Converted \
from text/plain format --&gt; &lt;P&gt;&lt;FONT size=2&gt;On 10/24/2011 02:34 AM, Guangya Liu \
wrote:&lt;BR&gt;&gt; Hi libvirt  support,&lt;BR&gt;&gt;&lt;BR&gt;&gt; Can you please give me some \
example of how to use  "virsh migrate --live" with p2p option including both source \
host and target  host?&lt;BR&gt;&lt;BR&gt;&lt;A 
href="https://www.redhat.com/archives/libvir-list/2011-October/msg01104.html"&gt;https:// \
www.redhat.com/archives/libvir-list/2011-October/msg01104.html&lt;/A&gt;&lt;BR&gt;&lt;BR&gt;--&lt;BR&gt;Eric  \
Blake   eblake@redhat.com    +1-801-349-2682&lt;BR&gt;Libvirt  \
virtualization library &lt;A  \
href="http://libvirt.org"&gt;http://libvirt.org&lt;/A&gt;&lt;BR&gt;&lt;/FONT&gt;&lt;/P&gt;&lt;/DIV&gt;&lt;/DIV&gt; &lt;SCRIPT \
type=text/javascript&gt; &lt;!--script
function img_zoom(e, o)
{
var zoom = parseInt(o.style.zoom, 10) || 100;
zoom += e.wheelDelta / 12;
if (((zoom &gt;= 50) &amp;&amp; (e.wheelDelta &lt; 0)) || ((zoom &lt; 200) &amp;&amp; (e.wheelDelta &gt; 0))) \
o.style.zoom = zoom + '%'; return false;
}

--&gt;
&lt;/SCRIPT&gt;
&lt;/BODY&gt;&lt;/HTML&gt;



</body></email><email><emailId>20111026155700</emailId><senderName>vmnode guy</senderName><senderEmail>vmnodeguy@gmail.com</senderEmail><timestampReceived>2011-10-26 15:57:00-0400</timestampReceived><subject>Re: [libvirt-users] virsh start VM failed</subject><body>

On Wed, Oct 26, 2011 at 11:50 PM, Eric Blake &lt;eblake@redhat.com&gt; wrote:

&gt; [re-adding the list]
&gt;
&gt;
&gt; On 10/26/2011 09:37 AM, 邱敏鈴 wrote:
&gt;
&gt;&gt; linux distribution : linux2.6.35-30-server  version : ubuntu10.10
&gt;&gt;
&gt;&gt; virsh # version
&gt;&gt; Compiled against library: libvir 0.8.3
&gt;&gt; Using library: libvir 0.8.3
&gt;&gt; Using API: QEMU 0.8.3
&gt;&gt; Running hypervisor: QEMU 0.12.5
&gt;&gt;
&gt;&gt; /var/log/libvirt/qemu/**controlnode.log
&gt;&gt; LC_ALL=C PATH=/usr/local/sbin:/usr/**local/bin:/usr/bin:/usr/sbin:/**
&gt;&gt; sbin:/bin
&gt;&gt; QEMU_AUDIO_DRV=none /usr/bin/kvm -S -M pc-0.12 -enable-kvm -m 1024 -smp
&gt;&gt; 2,sockets=2,cores=1,threads=1 -name controlnode -uuid
&gt;&gt; ce48e7d5-de02-8faf-c829-**9e000ca49b2b -nodefaults -chardev
&gt;&gt; socket,id=monitor,path=/var/**lib/libvirt/qemu/controlnode.**
&gt;&gt; monitor,server,nowait
&gt;&gt; -mon chardev=monitor,mode=readline -rtc base=utc -boot c -drive
&gt;&gt; file=/vm/vm1/ubuntu-kvm/**tmpkzLes0.qcow2,if=none,id=**
&gt;&gt; drive-ide0-0-0,boot=on,format=**qcow2
&gt;&gt; -device ide-drive,bus=ide.0,unit=0,**drive=drive-ide0-0-0,id=ide0-**0-0
&gt;&gt; -device
&gt;&gt; virtio-net-pci,vlan=0,id=net0,**mac=52:54:00:17:a2:d0,bus=pci.**0,addr=0x3
&gt;&gt; -net
&gt;&gt; tap,fd=37,vlan=0,name=hostnet0 -usb -vnc 127.0.0.1:0 -vga cirrus -device
&gt;&gt; virtio-balloon-pci,id=**balloon0,bus=pci.0,addr=0x4
&gt;&gt; bind(unix:/var/lib/libvirt/**qemu/controlnode.monitor): Permission denied
&gt;&gt; chardev: opening backend "socket" failed
&gt;&gt;
&gt;
&gt; This part of the log looks suspicious.  Could this be an installation
&gt; issue, or perhaps AppArmor not configured correctly?
&gt;
&gt;
&gt;
&gt;&gt; virsh # dumpxml controlnode
&gt;&gt; &lt;domain type='kvm'&gt;
&gt;&gt;   &lt;name&gt;controlnode&lt;/name&gt;
&gt;&gt;   &lt;uuid&gt;ce48e7d5-de02-8faf-c829-**9e000ca49b2b&lt;/uuid&gt;
&gt;&gt;   &lt;memory&gt;1048576&lt;/memory&gt;
&gt;&gt;   &lt;currentMemory&gt;1048576&lt;/**currentMemory&gt;
&gt;&gt;   &lt;vcpu&gt;2&lt;/vcpu&gt;
&gt;&gt;   &lt;os&gt;
&gt;&gt;     &lt;type arch='x86_64' machine='pc-0.12'&gt;hvm&lt;/type&gt;
&gt;&gt;     &lt;boot dev='hd'/&gt;
&gt;&gt;   &lt;/os&gt;
&gt;&gt;   &lt;features&gt;
&gt;&gt;     &lt;acpi/&gt;
&gt;&gt;   &lt;/features&gt;
&gt;&gt;   &lt;clock offset='utc'/&gt;
&gt;&gt;   &lt;on_poweroff&gt;destroy&lt;/on_**poweroff&gt;
&gt;&gt;   &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
&gt;&gt;   &lt;on_crash&gt;destroy&lt;/on_crash&gt;
&gt;&gt;   &lt;devices&gt;
&gt;&gt;     &lt;emulator&gt;/usr/bin/kvm&lt;/**emulator&gt;
&gt;&gt;     &lt;disk type='file' device='disk'&gt;
&gt;&gt;       &lt;driver name='qemu' type='qcow2'/&gt;
&gt;&gt;       &lt;source file='/vm/vm1/ubuntu-kvm/**tmpkzLes0.qcow2'/&gt;
&gt;&gt;       &lt;target dev='hda' bus='ide'/&gt;
&gt;&gt;       &lt;address type='drive' controller='0' bus='0' unit='0'/&gt;
&gt;&gt;     &lt;/disk&gt;
&gt;&gt;     &lt;controller type='ide' index='0'&gt;
&gt;&gt;       &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x01'
&gt;&gt; function='0x1'/&gt;
&gt;&gt;     &lt;/controller&gt;
&gt;&gt;     &lt;interface type='bridge'&gt;
&gt;&gt;       &lt;mac address='52:54:00:17:a2:d0'/&gt;
&gt;&gt;       &lt;source bridge='br0'/&gt;
&gt;&gt;       &lt;target dev='vnet0'/&gt;
&gt;&gt;       &lt;model type='virtio'/&gt;
&gt;&gt;       &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03'
&gt;&gt; function='0x0'/&gt;
&gt;&gt;     &lt;/interface&gt;
&gt;&gt;     &lt;input type='mouse' bus='ps2'/&gt;
&gt;&gt;     &lt;graphics type='vnc' port='-1' autoport='yes' listen='127.0.0.1'/&gt;
&gt;&gt;     &lt;video&gt;
&gt;&gt;       &lt;model type='cirrus' vram='9216' heads='1'/&gt;
&gt;&gt;       &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x02'
&gt;&gt; function='0x0'/&gt;
&gt;&gt;     &lt;/video&gt;
&gt;&gt;     &lt;memballoon model='virtio'&gt;
&gt;&gt;       &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x04'
&gt;&gt; function='0x0'/&gt;
&gt;&gt;     &lt;/memballoon&gt;
&gt;&gt;   &lt;/devices&gt;
&gt;&gt; &lt;/domain&gt;
&gt;&gt;
&gt;&gt; virsh # managedsave-remove controlnode couldn't help!
&gt;&gt;
&gt;
&gt; Nothing in that XML jumped out as suspicious to me.  And from the sound of
&gt; your managedsave-remote not making a difference, my guess of a corrupt
&gt; managed save image getting in the way is a red herring.  I'm not sure what
&gt; to suggest trying next.  Maybe others can chime in...
&gt;
&gt;
&gt; --
&gt; Eric Blake   eblake@redhat.com    +1-801-349-2682
&gt; Libvirt virtualization library http://libvirt.org
&gt;


Maybe can create a new VM &amp; attached the disk on it and see whether it can
start or not.. if it can mean the images is not corrupted..if not then bad
luck..

Regards,
Peter

[Attachment #3 (text/html)]

&lt;div class="gmail_quote"&gt;On Wed, Oct 26, 2011 at 11:50 PM, Eric Blake &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:eblake@redhat.com"&gt;eblake@redhat.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt; [re-adding the list]&lt;div class="im"&gt;&lt;br&gt;
&lt;br&gt;
On 10/26/2011 09:37 AM, 邱敏鈴 wrote:&lt;br&gt;
&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex"&gt; linux distribution : linux2.6.35-30-server   version : \
ubuntu10.10&lt;br&gt; &lt;br&gt;
virsh # version&lt;br&gt;
Compiled against library: libvir 0.8.3&lt;br&gt;
Using library: libvir 0.8.3&lt;br&gt;
Using API: QEMU 0.8.3&lt;br&gt;
Running hypervisor: QEMU 0.12.5&lt;br&gt;
&lt;br&gt;
/var/log/libvirt/qemu/&lt;u&gt;&lt;/u&gt;controlnode.log&lt;br&gt;
LC_ALL=C PATH=/usr/local/sbin:/usr/&lt;u&gt;&lt;/u&gt;local/bin:/usr/bin:/usr/sbin:/&lt;u&gt;&lt;/u&gt;sbin:/bin&lt;br&gt;
 QEMU_AUDIO_DRV=none /usr/bin/kvm -S -M pc-0.12 -enable-kvm -m 1024 -smp&lt;br&gt;
2,sockets=2,cores=1,threads=1 -name controlnode -uuid&lt;br&gt;
ce48e7d5-de02-8faf-c829-&lt;u&gt;&lt;/u&gt;9e000ca49b2b -nodefaults -chardev&lt;br&gt;
socket,id=monitor,path=/var/&lt;u&gt;&lt;/u&gt;lib/libvirt/qemu/controlnode.&lt;u&gt;&lt;/u&gt;monitor,server,nowait&lt;br&gt;
                
-mon chardev=monitor,mode=readline -rtc base=utc -boot c -drive&lt;br&gt;
file=/vm/vm1/ubuntu-kvm/&lt;u&gt;&lt;/u&gt;tmpkzLes0.qcow2,if=none,id=&lt;u&gt;&lt;/u&gt;drive-ide0-0-0,boot=on,format=&lt;u&gt;&lt;/u&gt;qcow2&lt;br&gt;
                
-device ide-drive,bus=ide.0,unit=0,&lt;u&gt;&lt;/u&gt;drive=drive-ide0-0-0,id=ide0-&lt;u&gt;&lt;/u&gt;0-0 \
-device&lt;br&gt; virtio-net-pci,vlan=0,id=net0,&lt;u&gt;&lt;/u&gt;mac=52:54:00:17:a2:d0,bus=pci.&lt;u&gt;&lt;/u&gt;0,addr=0x3 \
-net&lt;br&gt; tap,fd=37,vlan=0,name=hostnet0 -usb -vnc &lt;a href="http://127.0.0.1:0" \
target="_blank"&gt;127.0.0.1:0&lt;/a&gt; -vga cirrus -device&lt;br&gt; \
virtio-balloon-pci,id=&lt;u&gt;&lt;/u&gt;balloon0,bus=pci.0,addr=0x4&lt;br&gt; \
                bind(unix:/var/lib/libvirt/&lt;u&gt;&lt;/u&gt;qemu/controlnode.monitor): \
                Permission denied&lt;br&gt;
chardev: opening backend "socket" failed&lt;br&gt;
&lt;/blockquote&gt;
&lt;br&gt;&lt;/div&gt;
This part of the log looks suspicious.   Could this be an installation issue, or \
perhaps AppArmor not configured correctly?&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;&lt;br&gt; &lt;br&gt;
&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex"&gt; &lt;br&gt;
virsh # dumpxml controlnode&lt;br&gt;
&lt;domain type='kvm'&gt;&lt;br&gt;
    &lt;name&gt;controlnode&lt;/name&gt;&lt;br&gt;
    &lt;uuid&gt;ce48e7d5-de02-8faf-c829-&lt;u&gt;&lt;/u&gt;9e000ca49b2b&lt;/uuid&gt;&lt;br&gt;
    &lt;memory&gt;1048576&lt;/memory&gt;&lt;br&gt;
    &lt;currentMemory&gt;1048576&lt;/&lt;u&gt;&lt;/u&gt;currentMemory&gt;&lt;br&gt;
    &lt;vcpu&gt;2&lt;/vcpu&gt;&lt;br&gt;
    &lt;os&gt;&lt;br&gt;
       &lt;type arch='x86_64' \
machine='pc-0.12'&gt;hvm&lt;/type&gt;&lt;br&gt;  &lt;boot dev='hd'/&gt;&lt;br&gt;
    &lt;/os&gt;&lt;br&gt;
    &lt;features&gt;&lt;br&gt;
       &lt;acpi/&gt;&lt;br&gt;
    &lt;/features&gt;&lt;br&gt;
    &lt;clock offset='utc'/&gt;&lt;br&gt;
    &lt;on_poweroff&gt;destroy&lt;/on_&lt;u&gt;&lt;/u&gt;poweroff&gt;&lt;br&gt;
    &lt;on_reboot&gt;restart&lt;/on_reboot&gt;&lt;br&gt;
    &lt;on_crash&gt;destroy&lt;/on_crash&gt;&lt;br&gt;
    &lt;devices&gt;&lt;br&gt;
       &lt;emulator&gt;/usr/bin/kvm&lt;/&lt;u&gt;&lt;/u&gt;emulator&gt;&lt;br&gt;
       &lt;disk type='file' device='disk'&gt;&lt;br&gt;
          &lt;driver name='qemu' type='qcow2'/&gt;&lt;br&gt;
          &lt;source \
file='/vm/vm1/ubuntu-kvm/&lt;u&gt;&lt;/u&gt;tmpkzLes0.qcow2'/&gt;&lt;br&gt;  &lt;target \
                dev='hda' bus='ide'/&gt;&lt;br&gt;
          &lt;address type='drive' controller='0' bus='0' \
unit='0'/&gt;&lt;br&gt;  &lt;/disk&gt;&lt;br&gt;
       &lt;controller type='ide' index='0'&gt;&lt;br&gt;
          &lt;address type='pci' domain='0x0000' bus='0x00' \
slot='0x01'&lt;br&gt; function='0x1'/&gt;&lt;br&gt;
       &lt;/controller&gt;&lt;br&gt;
       &lt;interface type='bridge'&gt;&lt;br&gt;
          &lt;mac address='52:54:00:17:a2:d0'/&gt;&lt;br&gt;
          &lt;source bridge='br0'/&gt;&lt;br&gt;
          &lt;target dev='vnet0'/&gt;&lt;br&gt;
          &lt;model type='virtio'/&gt;&lt;br&gt;
          &lt;address type='pci' domain='0x0000' bus='0x00' \
slot='0x03'&lt;br&gt; function='0x0'/&gt;&lt;br&gt;
       &lt;/interface&gt;&lt;br&gt;
       &lt;input type='mouse' bus='ps2'/&gt;&lt;br&gt;
       &lt;graphics type='vnc' port='-1' autoport='yes' \
listen='127.0.0.1'/&gt;&lt;br&gt;  &lt;video&gt;&lt;br&gt;
          &lt;model type='cirrus' vram='9216' \
                heads='1'/&gt;&lt;br&gt;
          &lt;address type='pci' domain='0x0000' bus='0x00' \
slot='0x02'&lt;br&gt; function='0x0'/&gt;&lt;br&gt;
       &lt;/video&gt;&lt;br&gt;
       &lt;memballoon model='virtio'&gt;&lt;br&gt;
          &lt;address type='pci' domain='0x0000' bus='0x00' \
slot='0x04'&lt;br&gt; function='0x0'/&gt;&lt;br&gt;
       &lt;/memballoon&gt;&lt;br&gt;
    &lt;/devices&gt;&lt;br&gt;
&lt;/domain&gt;&lt;br&gt;
&lt;br&gt;
virsh # managedsave-remove controlnode couldn't help!&lt;br&gt;
&lt;/blockquote&gt;
&lt;br&gt;&lt;/div&gt;&lt;/div&gt;
Nothing in that XML jumped out as suspicious to me.   And from the sound of your \
managedsave-remote not making a difference, my guess of a corrupt managed save image \
getting in the way is a red herring.   I'm not sure what to suggest trying next.  \
Maybe others can chime in...&lt;div&gt; &lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;&lt;br&gt;
&lt;br&gt;
-- &lt;br&gt;
Eric Blake    &lt;a href="mailto:eblake@redhat.com" \
target="_blank"&gt;eblake@redhat.com&lt;/a&gt;      &lt;a href="tel:%2B1-801-349-2682" \
value="+18013492682" target="_blank"&gt;+1-801-349-2682&lt;/a&gt;&lt;br&gt; Libvirt virtualization \
library &lt;a href="http://libvirt.org" target="_blank"&gt;http://libvirt.org&lt;/a&gt;&lt;br&gt; \
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Maybe can create a new VM \
&amp; attached the disk on it and see whether it can start or not.. if it can mean \
the images is not corrupted..if not then bad luck..&lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;Peter&lt;/div&gt;



</body></email><email><emailId>20111026161835</emailId><senderName>Dan Hirsch</senderName><senderEmail>dan.hirsch@ravellosystems.com</senderEmail><timestampReceived>2011-10-26 16:18:35-0400</timestampReceived><subject>Re: [libvirt-users] how to setup libvirt with java bindings for use</subject><body>

Can you please elaborate ? How is it done? Do I have to do it for each
platform?

Sent from my iPhone

On Oct 26, 2011, at 17:08, Bryan Kearney &lt;bkearney@redhat.com&gt; wrote:

On 10/26/2011 09:39 AM, Dan Hirsch wrote:

Hi,

I would like to use libvirt to manipulate virtual machines of different

types (KVM, ESXi etc.)

I added dependencies to my project the libvirt and jna jars.

trying to execute your example code I am getting a run time exception saying

the library cann't be found.

it an actual libvirt c library is also required, and needs to be compiled

separately?


can you please write down all needed steps for using libvirt with java

binding?


thanks in advance.



Yes, you should have libvirt installed and in the library in your path.
-- bk

[Attachment #3 (text/html)]

&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body bgcolor="#FFFFFF"&gt;&lt;div&gt;&lt;div style="text-align: \
left;direction: ltr; "&gt;Can you please elaborate ? How is it done? Do I have to do it \
for each platform?&lt;/div&gt;&lt;br&gt;Sent from my iPhone&lt;/div&gt;&lt;div&gt;&lt;br&gt;On Oct 26, 2011, at \
17:08, Bryan Kearney &lt;&lt;a \
href="mailto:bkearney@redhat.com"&gt;bkearney@redhat.com&lt;/a&gt;&gt; wrote:&lt;br&gt; \
&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;blockquote type="cite"&gt;&lt;div&gt;&lt;span&gt;On 10/26/2011 09:39 AM, Dan \
Hirsch wrote:&lt;/span&gt;&lt;br&gt;&lt;blockquote \
type="cite"&gt;&lt;span&gt;Hi,&lt;/span&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote type="cite"&gt;&lt;span&gt;I would \
like to use libvirt to manipulate virtual machines of different&lt;/span&gt;&lt;br&gt; \
&lt;/blockquote&gt;&lt;blockquote type="cite"&gt;&lt;span&gt;types (KVM, ESXi \
etc.)&lt;/span&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote type="cite"&gt;&lt;span&gt;I added dependencies to my \
project the libvirt and jna jars.&lt;/span&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote type="cite"&gt; \
&lt;span&gt;trying to execute your example code I am getting a run time exception \
saying&lt;/span&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote type="cite"&gt;&lt;span&gt;the library cann't be \
found.&lt;/span&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote type="cite"&gt;&lt;span&gt;it an actual libvirt c \
library is also required, and needs to be compiled&lt;/span&gt;&lt;br&gt; \
&lt;/blockquote&gt;&lt;blockquote \
type="cite"&gt;&lt;span&gt;separately?&lt;/span&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote \
type="cite"&gt;&lt;span&gt;&lt;/span&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote type="cite"&gt;&lt;span&gt;can you \
please write down all needed steps for using libvirt with java&lt;/span&gt;&lt;br&gt; \
&lt;/blockquote&gt;&lt;blockquote \
type="cite"&gt;&lt;span&gt;binding?&lt;/span&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote \
type="cite"&gt;&lt;span&gt;&lt;/span&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote type="cite"&gt;&lt;span&gt;thanks in \
advance.&lt;/span&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote type="cite"&gt; \
&lt;span&gt;&lt;/span&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;span&gt;&lt;/span&gt;&lt;br&gt;&lt;span&gt;Yes, you should have libvirt \
installed and in the library in your path.&lt;/span&gt;&lt;br&gt;&lt;span&gt;-- \
bk&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20111026180405</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-10-26 18:04:05-0400</timestampReceived><subject>Re: [libvirt-users] Start of libvirtd fails with error "undefined symbol: __virAlloc"</subject><body>

On 10/24/2011 10:02 AM, Langenbach, Steffen wrote:
&gt; Hello List
&gt; 
&gt; like described in the topic I have a problem with starting the libvirtd. I'm a \
&gt; complete newbie with libvirtd, today I heard the first time that such a daemon \
&gt; exists after I get the message that our webserver isn't running (a former colleague \
&gt; has installed this system). We have the following configuration: A Ubuntu based \
&gt; host on which our webserver runs within a qemu virtual machine. The following \
&gt; happens: Yesterday the host restarted (at the moment we don't know the reason) and \
&gt; since this restart libvirtd did not start up. How I found that out: When I try to \
&gt; start the virtual machine with "virsh start z-web" I get the error: "Connecting to \
&gt;                 uri: qemu:///session
&gt; libvir: Remote error : unable to connect to '/var/run/libvirt/libvirt-sock': No \
&gt;                 such file or directory
&gt; error: failed to connect to the hypervisor"
&gt; As explained, I'm a total Newbie with libvirtd. So as far as I know, the \
&gt; libvirt-sock is generated by libvirtd when it's running. I don't know the right way \
&gt; how to start libvirtd. I tried it by just typing "libvirtd", but that generates \
&gt; this error: "libvirtd: symbol lookup error: libvirtd: undefined symbol: \
&gt; __virAlloc".

Generally, you would start libvirtd via your system's service management 
utilities, such as 'service libvirtd start', rather than directly 
invoking the binary.  That way, it gets started with the right 
privileges and daemonization patterns.

Your particular error makes it sound like you have a botched 
installation; generally, a symbol not found message is an indication 
that the libvirtd binary depends on libvirt.so, but that your ld.so 
can't find the proper version of libvirt.so in any of the usual places. 
  Are you using a distro build (if so, reinstall the libvirt package) or 
a self-built binary (if so, double-check your configuration and 
installation parameters).

&gt; 
&gt; I can't find any log-entry that gives me more information about this error.

For an entry point not found error, there won't be any log message - 
your libvirtd (actually, ld.so) was dying even before it gets to main().

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


</body></email><email><emailId>20111027034419</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-10-27 03:44:19-0400</timestampReceived><subject>Re: [libvirt-users] live migration without shared storage problems.</subject><body>

ÓÚ 2011Äê10Ô 27ÈÕ 11:16, Luengffy XUE Ð´µÀ:
&gt; Oh, I think I can describe the problem more specific.
&gt;
&gt; 1 Creat the vm in the source host and it run well.
&gt; 2 Create the image in the destination and change the user and group

2£©µÄÒâË¼ÊÇÄã×Ô¼ºÔÚdestÉÏ´´½¨ÁËÍ¬ÃûµÄimageÃ´£¿

&gt; 3 Open TCP socket in the destination host.

ÄãÊÇÕ¦×÷µÄ£¬Õâ¶¼ÊÇlibvirt/qemu×Ô¼ºÀ´Íê³ÉµÄ£¬destÉÏqemu»áÒÔ-incoming
Æô¶¯¡£

&gt;
&gt; In the source host I use the different command as
&gt;
&gt; 1 $ virsh migrate --live --copy-storage-all vmubuntu
&gt; qemu+ssh://destinationHost/system --verbose
&gt;
&gt; This situation, the error is:
&gt;
&gt; In the source host:
&gt; error:operation failed:migration job:unexpectedly failed
&gt; In the destiantion host: (from the vm.log)
&gt; qemu:Warning: error while loading State ID section 2
&gt;
&gt;
&gt; &lt;http://blog.chinaunix.net/space.php?uid=26284395&amp;do=blog&amp;id=2980663&gt;
&gt;
&gt; 2 $ virsh migrate --live --copy-storage-all vmubuntu
&gt; qemu+ssh://destinationHost/system tcp://destinationHost:49170 --verbose
&gt;
&gt; This situation, the error is:
&gt;
&gt;
&gt; In the source host:
&gt;&gt; error: operation failed : failed to retrieve chardev info inqemu with 'info chardev'
&gt; In the destiantion host: (from the vm.log)
&gt;&gt; Migration failed. Exit code tcp:0.0.0.0:49170(-98),exiting.
&gt;
&gt;
&gt;
&gt; Can you help me ? I google the error on the www . But I can not find
&gt; the proper solutions or the same questions.
&gt;
&gt; Thanks very much.
&gt; Best wishes.
&gt;
&gt;
&gt; 2011/10/27 Osier Yang &lt;jyang@redhat.com &lt;mailto:jyang@redhat.com&gt;&gt;
&gt;
&gt;     ÓÚ 2011Äê10Ô 26ÈÕ 22:22, Luengffy XUE Ð´µÀ:
&gt;&gt;     Hi, all
&gt;&gt;     I migrate a vm from source host to the destination host. 
&gt;&gt;     I am sure every part is ok for migration.
&gt;&gt;     1   Create the  image in the destination and change the user and group.
&gt;&gt;     2   Open TCP socket in the destination host. 
&gt;&gt;     and I migrate in the source host command line.   
&gt;&gt;     $ virsh migrate --live --copy-storage-all vmubuntu  qemu+ssh://destinationHost/system --verbose
&gt;&gt;     But I get the  error
&gt;&gt;     "error: operation failed : failed to retrieve chardev info inqemu with 'info chardev'" 
&gt;
&gt;     Looks like you even failed on starting the domain. Could you
&gt;     confirm if you
&gt;     guest is actually running well?
&gt;
&gt;&gt;     In the destination I find in the vmubuntu.log  
&gt;&gt;     The error is 
&gt;&gt;     "Migration failed. Exit code tcp:0.0.0.0:49170(-98),exiting."
&gt;&gt;
&gt;&gt;     What can I do to solve it ? 
&gt;&gt;     I do not understand how the error comes.
&gt;&gt;     Anyone can help me ?
&gt;&gt;     Thanks in advance. 
&gt;&gt;
&gt;
&gt;


[Attachment #3 (text/html)]

&lt;html&gt;
  &lt;head&gt;
    &lt;meta content="text/html; charset=GB2312" http-equiv="Content-Type"&gt;
  &lt;/head&gt;
  &lt;body text="#000000" bgcolor="#FFFFFF"&gt;
    ÓÚ 2011Äê10Ô 27ÈÕ 11:16, Luengffy XUE Ð´µÀ:
    &lt;blockquote
cite="mid:CAOp97YBkSbr6G9OrbUtZ9AmDo3V=PVK9Wf7tJSrjz=Pf8z2MEg@mail.gmail.com"
      type="cite"&gt;
      &lt;div&gt;Oh, I think I can describe the problem more specific.&lt;/div&gt;
      &lt;div&gt;&lt;br&gt;
      &lt;/div&gt;
      &lt;div&gt;1         Creat the vm in the source host and it run \
                well.&lt;/div&gt;
      &lt;div&gt;2    &lt;span class="Apple-style-span" style="color: rgb(51, 51,
          51); font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace;
          font-size: 12px; line-height: 18px; white-space: pre; "&gt;
          Create the image in the destination and change the user and
          group&lt;/span&gt;&lt;/div&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
    2£©µÄÒâË¼ÊÇÄã×Ô¼ºÔÚdestÉÏ´´½¨ÁËÍ¬ÃûµÄimageÃ´£¿&lt;br&gt;
    &lt;br&gt;
    &lt;blockquote
cite="mid:CAOp97YBkSbr6G9OrbUtZ9AmDo3V=PVK9Wf7tJSrjz=Pf8z2MEg@mail.gmail.com"
      type="cite"&gt;
      &lt;div&gt;&lt;span class="Apple-style-span" style="color: rgb(51, 51, 51);
          font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace;
          font-size: 12px; line-height: 18px; white-space: pre; "&gt;&lt;/span&gt;&lt;span
          class="Apple-style-span" style="color: rgb(51, 51, 51);
          font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace;
          font-size: 12px; line-height: 18px; white-space: pre; "&gt;3 Open
          TCP socket in the destination host.&lt;/span&gt;&lt;/div&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
    ÄãÊÇÕ¦×÷µÄ£¬Õâ¶¼ÊÇlibvirt/qemu×Ô¼ºÀ´Íê³ÉµÄ£¬destÉÏqemu»áÒÔ-incoming&lt;br&gt;
    Æô¶¯¡£&lt;br&gt;
    &lt;br&gt;
    &lt;blockquote
cite="mid:CAOp97YBkSbr6G9OrbUtZ9AmDo3V=PVK9Wf7tJSrjz=Pf8z2MEg@mail.gmail.com"
      type="cite"&gt;
      &lt;div&gt;&lt;span class="Apple-style-span" style="color: rgb(51, 51, 51);
          font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace;
          font-size: 12px; line-height: 18px; white-space: pre; "&gt;&lt;br&gt;
        &lt;/span&gt;&lt;/div&gt;
      &lt;div&gt;&lt;span class="Apple-style-span" style="color: rgb(51, 51, 51);
          font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace;
          font-size: 12px; line-height: 18px; white-space: pre; "&gt;In the
          source host I use the different command as&lt;/span&gt;&lt;/div&gt;
      &lt;div&gt;&lt;span class="Apple-style-span" style="color: rgb(51, 51, 51);
          font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace;
          font-size: 12px; line-height: 18px; white-space: pre; "&gt;&lt;br&gt;
        &lt;/span&gt;&lt;/div&gt;
      &lt;div&gt;&lt;span class="Apple-style-span" style="background-color:
          rgb(255, 255, 0);"&gt;&lt;font class="Apple-style-span" size="4"&gt;&lt;span
              class="Apple-style-span" style="color: rgb(51, 51, 51);
              font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace;
              line-height: 18px; white-space: pre; "&gt;1 &lt;/span&gt;&lt;span
              class="Apple-style-span" style="color: rgb(51, 51, 51);
              font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace;
              line-height: 18px; white-space: pre; "&gt; &lt;/span&gt;&lt;span
              class="Apple-style-span" style="color: rgb(51, 51, 51);
              font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace;
              line-height: 18px; white-space: pre; "&gt;$ virsh migrate
              --live --copy-storage-all vmubuntu
              qemu+ssh://destinationHost/system --verbose&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;
      &lt;div&gt;&lt;span class="Apple-style-span" style="background-color:
          rgb(255, 255, 0);"&gt;&lt;span class="Apple-style-span"
            style="color: rgb(51, 51, 51); font-family: 'UbuntuBeta
            Mono', 'Ubuntu Mono', monospace; font-size: 12px;
            line-height: 18px; white-space: pre; "&gt;&lt;br&gt;
          &lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
      &lt;div&gt;&lt;font class="Apple-style-span" color="#333333"
          face="'UbuntuBeta Mono', 'Ubuntu Mono', monospace"&gt;&lt;span
            class="Apple-style-span" style="font-size: 12px;
            line-height: 18px; white-space: pre;"&gt;This situation, the
            error is:&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;
      &lt;div&gt;&lt;font class="Apple-style-span" color="#333333"
          face="'UbuntuBeta Mono', 'Ubuntu Mono', monospace"&gt;&lt;span
            class="Apple-style-span" style="font-size: 12px;
            line-height: 18px; white-space: pre;"&gt;&lt;br&gt;
          &lt;/span&gt;&lt;/font&gt;&lt;/div&gt;
      &lt;div&gt;&lt;font class="Apple-style-span" face="'UbuntuBeta Mono',
          'Ubuntu Mono', monospace"&gt;&lt;span class="Apple-style-span"
            style="font-size: 12px; line-height: 18px; white-space: pre;
            "&gt;&lt;font class="Apple-style-span" color="#ff6666"&gt;In the
              source host:&lt;/font&gt;&lt;font class="Apple-style-span"
              color="#333333"&gt; &lt;/font&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;
      &lt;div&gt;&lt;font class="Apple-style-span" face="'UbuntuBeta Mono',
          'Ubuntu Mono', monospace"&gt;&lt;span class="Apple-style-span"
            style="font-size: 12px; line-height: 18px; white-space: pre;
            "&gt;&lt;font class="Apple-style-span" color="#333333"&gt; &lt;/font&gt;&lt;font
              class="Apple-style-span" style="background-color: rgb(255,
              255, 0);" color="#ff9966"&gt; error:operation
              failed:migration job:unexpectedly failed&lt;/font&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;
      &lt;div&gt;&lt;font class="Apple-style-span" color="#ff6666"
          face="'UbuntuBeta Mono', 'Ubuntu Mono', monospace"&gt;&lt;span
            class="Apple-style-span" style="font-size: 12px;
            line-height: 18px; white-space: pre; "&gt;In the destiantion
            host: (from the vm.log)&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;
      &lt;div&gt;&lt;font class="Apple-style-span" face="'UbuntuBeta Mono',
          'Ubuntu Mono', monospace"&gt;&lt;span class="Apple-style-span"
            style="font-size: 12px; line-height: 18px; white-space: pre;
            "&gt;&lt;font class="Apple-style-span" color="#333333"&gt; &lt;/font&gt;&lt;span
              class="Apple-style-span" style="background-color: rgb(255,
              255, 0); "&gt;&lt;font class="Apple-style-span" color="#333333"&gt;
              &lt;/font&gt;&lt;font class="Apple-style-span" color="#ff6666"&gt;qemu:Warning:
                error while loading State ID section \
2&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;  &lt;div&gt;&lt;font class="Apple-style-span" \
color="#333333"  face="'UbuntuBeta Mono', 'Ubuntu Mono', monospace"&gt;&lt;span
            class="Apple-style-span" style="font-size: 12px;
            line-height: 18px; white-space: pre;"&gt;&lt;br&gt;
          &lt;/span&gt;&lt;/font&gt;&lt;/div&gt;
      &lt;div&gt;&lt;font class="Apple-style-span" color="#333333"
          face="'UbuntuBeta Mono', 'Ubuntu Mono', monospace"&gt;&lt;span
            class="Apple-style-span" style="font-size: 12px;
            line-height: 18px; white-space: pre;"&gt;&lt;a
              moz-do-not-send="true"
href="http://blog.chinaunix.net/space.php?uid=26284395&amp;do=blog&amp;id=2980663"&gt;&lt;br&gt;
  &lt;/a&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;
      &lt;div&gt;&lt;font class="Apple-style-span" color="#333333"
          face="'UbuntuBeta Mono', 'Ubuntu Mono', monospace"&gt;&lt;span
            class="Apple-style-span" style="font-size: 12px;
            line-height: 18px; white-space: pre; "&gt; &lt;/span&gt;&lt;/font&gt;&lt;/div&gt;
      &lt;div&gt;&lt;br&gt;
      &lt;/div&gt;
      &lt;span class="Apple-style-span" style="background-color: rgb(255,
        255, 0);"&gt;&lt;font class="Apple-style-span" size="4"&gt;2    &lt;span
            class="Apple-style-span" style="color: rgb(51, 51, 51);
            font-family: 'UbuntuBeta Mono', 'Ubuntu Mono', monospace;
            line-height: 18px; white-space: pre; "&gt;$ virsh migrate
            --live --copy-storage-all vmubuntu
            qemu+ssh://destinationHost/system
            tcp://destinationHost:49170 --verbose&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;
      &lt;div&gt;
        &lt;font class="Apple-style-span" color="#333333" face="'UbuntuBeta
          Mono', 'Ubuntu Mono', monospace"&gt;&lt;span
            class="Apple-style-span" style="font-size: 12px;
            line-height: 18px; white-space: pre;"&gt;&lt;br&gt;
          &lt;/span&gt;&lt;/font&gt;&lt;/div&gt;
      &lt;div&gt;&lt;font class="Apple-style-span" color="#333333"
          face="'UbuntuBeta Mono', 'Ubuntu Mono', monospace"&gt;&lt;span
            class="Apple-style-span" style="font-size: 12px;
            line-height: 18px; white-space: pre;"&gt;This situation, the
            error is:&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;
      &lt;div&gt;&lt;font class="Apple-style-span" color="#333333"
          face="'UbuntuBeta Mono', 'Ubuntu Mono', monospace"&gt;&lt;span
            class="Apple-style-span" style="font-size: 12px;
            line-height: 18px; white-space: pre;"&gt;&lt;br&gt;
          &lt;/span&gt;&lt;/font&gt;&lt;/div&gt;
      &lt;div&gt;&lt;font class="Apple-style-span" color="#333333"
          face="'UbuntuBeta Mono', 'Ubuntu Mono', monospace"&gt;&lt;span
            class="Apple-style-span" style="font-size: 12px;
            line-height: 18px; white-space: pre;"&gt;&lt;br&gt;
          &lt;/span&gt;&lt;/font&gt;&lt;/div&gt;
      &lt;div&gt;&lt;font class="Apple-style-span" color="#333333"
          face="'UbuntuBeta Mono', 'Ubuntu Mono', monospace"&gt;
          &lt;div style="color: rgb(0, 0, 0); font-family: arial;
            font-size: small; line-height: normal; white-space: normal;
            "&gt;
            &lt;font class="Apple-style-span" face="'UbuntuBeta Mono',
              'Ubuntu Mono', monospace"&gt;&lt;span class="Apple-style-span"
                style="font-size: 12px; line-height: 18px; white-space:
                pre; "&gt;&lt;font class="Apple-style-span" color="#ff6666"&gt;In
                  the source host:&lt;/font&gt;&lt;font class="Apple-style-span"
                  color="#333333"&gt; &lt;/font&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;
          &lt;div&gt;&lt;span class="Apple-style-span" style="font-size: 12px;
              line-height: 18px; white-space: pre;"&gt;&lt;span
                class="Apple-style-span" style="border-collapse:
                collapse; font-family: arial, sans-serif; font-size:
                13px; color: rgb(0, 0, 0); line-height: normal;
                white-space: normal; "&gt;
                &lt;blockquote type="cite"&gt;
                  &lt;span style="font-family: 'UbuntuBeta Regular',
                    Ubuntu, 'Bitstream Vera Sans', 'DejaVu Sans',
                    Tahoma, sans-serif; font-size: 12px; line-height:
                    18px; "&gt;
                    &lt;pre style="white-space: pre-wrap; font-family: 'UbuntuBeta \
Mono', 'Ubuntu Mono', monospace; margin-bottom: 0.8em; "&gt;&lt;span \
style="background-color: rgb(255, 255, 0); "&gt;&lt;font color="#ff0000"&gt;error: operation \
failed : failed to retrieve chardev info inqemu with 'info \
chardev'&lt;/font&gt;&lt;/span&gt;&lt;/pre&gt;  &lt;/span&gt;&lt;/blockquote&gt;
              &lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
          &lt;div style="color: rgb(0, 0, 0); font-family: arial;
            font-size: small; line-height: normal; white-space: normal;
            "&gt;&lt;font class="Apple-style-span" color="#ff6666"
              face="'UbuntuBeta Mono', 'Ubuntu Mono', monospace"&gt;&lt;span
                class="Apple-style-span" style="font-size: 12px;
                line-height: 18px; white-space: pre; "&gt;In the
                destiantion host: (from the vm.log)&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;
          &lt;div&gt;&lt;span class="Apple-style-span" style="font-size: 12px;
              line-height: 18px; white-space: pre;"&gt;&lt;span
                class="Apple-style-span" style="border-collapse:
                collapse; font-family: arial, sans-serif; font-size:
                13px; color: rgb(0, 0, 0); line-height: normal;
                white-space: normal; "&gt;
                &lt;blockquote type="cite"&gt;
                  &lt;span style="font-family: 'UbuntuBeta Regular',
                    Ubuntu, 'Bitstream Vera Sans', 'DejaVu Sans',
                    Tahoma, sans-serif; font-size: 12px; line-height:
                    18px; "&gt;
                    &lt;pre style="white-space: pre-wrap; font-family: 'UbuntuBeta \
Mono', 'Ubuntu Mono', monospace; margin-bottom: 0.8em; "&gt;&lt;span \
style="background-color: rgb(255, 255, 0); "&gt;&lt;font color="#ff0000"&gt;Migration failed. \
Exit code tcp:0.0.0.0:49170(-98),exiting.&lt;/font&gt;&lt;/span&gt;&lt;/pre&gt;  &lt;/span&gt;&lt;/blockquote&gt;
              &lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
        &lt;/font&gt;&lt;/div&gt;
      &lt;div&gt;&lt;font class="Apple-style-span" color="#333333"
          face="'UbuntuBeta Mono', 'Ubuntu Mono', monospace"&gt;&lt;span
            class="Apple-style-span" style="font-size: 12px;
            line-height: 18px; white-space: pre;"&gt;&lt;br&gt;
          &lt;/span&gt;&lt;/font&gt;&lt;br&gt;
      &lt;/div&gt;
      &lt;div&gt;&lt;br&gt;
      &lt;/div&gt;
      &lt;div&gt;Can you help me ?  I google the error on the www . But I can
        not find the proper solutions  or the same questions.&lt;/div&gt;
      &lt;div&gt;&lt;br&gt;
      &lt;/div&gt;
      &lt;div&gt;Thanks very much.&lt;/div&gt;
      &lt;div&gt;Best wishes.&lt;/div&gt;
      &lt;div&gt;&lt;br&gt;
      &lt;/div&gt;
      &lt;div&gt;&lt;br&gt;
        &lt;div class="gmail_quote"&gt;2011/10/27 Osier Yang &lt;span dir="ltr"&gt;&lt;&lt;a
              moz-do-not-send="true" \
href="mailto:jyang@redhat.com"&gt;jyang@redhat.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;  &lt;blockquote \
                class="gmail_quote" style="margin:0 0 0
            .8ex;border-left:1px #ccc solid;padding-left:1ex;"&gt;
            &lt;div text="#000000" bgcolor="#FFFFFF"&gt; ÓÚ 2011Äê10Ô 26ÈÕ 22:22,
              Luengffy XUE Ð´µÀ:
              &lt;blockquote type="cite"&gt;&lt;span
                  style="font-family:'UbuntuBeta
                  Regular',Ubuntu,'Bitstream Vera Sans','DejaVu
                  Sans',Tahoma,sans-serif;font-size:12px;line-height:18px"&gt;
                  &lt;pre style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', \
'Ubuntu Mono', monospace;margin-bottom:0.8em"&gt;Hi, all&lt;/pre&gt;  &lt;pre \
style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt;I migrate a vm from source host to the destination \
host. &lt;/pre&gt;  &lt;pre style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', \
'Ubuntu Mono', monospace;margin-bottom:0.8em"&gt;I am sure every part is ok for \
migration.&lt;/pre&gt;  &lt;pre style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', \
'Ubuntu Mono', monospace;margin-bottom:0.8em"&gt;1   Create the  image in the \
destination and change the user and group.&lt;/pre&gt;  &lt;pre style="color:rgb(51, 51, \
51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', monospace;margin-bottom:0.8em"&gt;2   \
Open TCP socket in the destination host. &lt;/pre&gt;  &lt;pre style="color:rgb(51, 51, \
51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', monospace;margin-bottom:0.8em"&gt;and \
I migrate in the source host command line.   &lt;/pre&gt;  &lt;pre style="color:rgb(51, \
51, 51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt;$ virsh migrate --live --copy-storage-all vmubuntu  \
                qemu+ssh://destinationHost/system --verbose&lt;/pre&gt;
                  &lt;pre style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', \
'Ubuntu Mono', monospace;margin-bottom:0.8em"&gt;But I get the  error&lt;/pre&gt;  &lt;pre \
style="font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt;&lt;span style="background-color:rgb(255, 255, 0)"&gt;&lt;font \
color="#ff0000"&gt;"error: operation failed : failed to retrieve chardev info inqemu \
with 'info chardev'" &lt;/font&gt;&lt;/span&gt;&lt;/pre&gt;  &lt;/span&gt;&lt;/blockquote&gt;
              &lt;br&gt;
              Looks like you even failed on starting the domain. Could
              you confirm if you&lt;br&gt;
              guest is actually running well?&lt;br&gt;
              &lt;br&gt;
              &lt;blockquote type="cite"&gt;&lt;span
                  style="font-family:'UbuntuBeta Regular', Ubuntu,
                  'Bitstream Vera Sans', 'DejaVu Sans', Tahoma,
                  sans-serif;font-size:12px;line-height:18px"&gt;
                  &lt;pre style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', \
'Ubuntu Mono', monospace;margin-bottom:0.8em"&gt;In the destination I find in the \
                vmubuntu.log  &lt;/pre&gt;
                  &lt;pre style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', \
'Ubuntu Mono', monospace;margin-bottom:0.8em"&gt;The error is &lt;/pre&gt;  &lt;pre \
style="font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt;&lt;span style="background-color:rgb(255, 255, 0)"&gt;&lt;font \
color="#ff0000"&gt;"Migration failed. Exit code \
                tcp:0.0.0.0:49170(-98),exiting."&lt;/font&gt;&lt;/span&gt;&lt;/pre&gt;
                  &lt;pre style="font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt;&lt;font color="#ff0000"&gt; &lt;/font&gt;&lt;/pre&gt;
                  &lt;pre style="font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt;&lt;font color="#ff0000"&gt;&lt;span \
style="font-family:'UbuntuBeta Regular', Ubuntu, 'Bitstream Vera Sans', 'DejaVu \
Sans', Tahoma, sans-serif;color:rgb(0, 0, 0);white-space:normal"&gt;&lt;pre \
style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt;What can I do to solve it ? &lt;/pre&gt;&lt;pre \
style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt;I do not understand how the error comes.&lt;/pre&gt;&lt;pre \
style="color:rgb(51, 51, 51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt;Anyone can help me ?&lt;/pre&gt;&lt;pre style="color:rgb(51, \
51, 51);font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
                monospace;margin-bottom:0.8em"&gt;Thanks in advance. \
                &lt;/pre&gt;&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;
                  &lt;pre style="font-family:'UbuntuBeta Mono', 'Ubuntu Mono', \
monospace;margin-bottom:0.8em"&gt;&lt;font color="#ff0000"&gt; &lt;/font&gt;&lt;/pre&gt;
                &lt;/span&gt; &lt;/blockquote&gt;
              &lt;br&gt;
            &lt;/div&gt;
          &lt;/blockquote&gt;
        &lt;/div&gt;
        &lt;br&gt;
      &lt;/div&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
  &lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20111027130439</emailId><senderName>Mohammed Naser</senderName><senderEmail>mnaser@vexxhost.com</senderEmail><timestampReceived>2011-10-27 13:04:39-0400</timestampReceived><subject>Re: [libvirt-users] Need help to compile libvirt-php</subject><body>

On Wed, Oct 26, 2011 at 11:31 AM, vmnode guy &lt;vmnodeguy@gmail.com&gt; wrote:

&gt; Hello HetZ,
&gt;
&gt; I try the put in the example and try run, but it's don't seem to be works.
&gt;
&gt; Do you have the same problem, do you know how should i proceed ?
&gt;
&gt; root@cn1:/var/www# cat info.php
&gt; &lt;?php
&gt;
&gt;      print_r ( libvirt_version() );
&gt;
&gt;         $conn = libvirt_connect('null', false);
&gt; //      $conn = libvirt_connect('qemu+ssh://root@10.0.0.122/system',
&gt; false);
&gt;         echo $conn;
&gt;         $doms = libvirt_list_domains($conn);
&gt;         print_r($doms);
&gt;
&gt; ?&gt;
&gt; root@cn1:/var/www#
&gt;
&gt; It doesn't show any output..
&gt;
&gt; I also put this example into a file log.php and run it.
&gt;
&gt; &lt;?php
&gt;     $logfile = 'test.log';
&gt;
&gt;     unlink($logfile);
&gt;     if (!libvirt_logfile_set($logfile))
&gt;          die('Cannot set the log file');
&gt;
&gt;     $conn = libvirt_connect('null', false);
&gt;     unset($conn);
&gt;
&gt;     $fp = fopen($logfile, 'r');
&gt;     $str = fread($fp, filesize($logfile));
&gt;     fclose($fp);
&gt;
&gt;     echo $str;
&gt; ?&gt;
&gt;
&gt; It does generate a file and show error..
&gt; [Wed Oct 26 23:17:07 2011] [error] [client 10.0.0.201] PHP Warning:
&gt;  libvirt_connect(): Failed to connect socket to
&gt; '@/var/www/.libvirt/libvirt-sock': Connection refused in /var/www/log.php on
&gt; line 8
&gt; [2011-10-26 23:17:07 libvirt-php/core]: libvirt_connect: Cannot establish
&gt; connection to (null)
&gt;
&gt;
&gt; My /var/www directory is like below:-
&gt; root@cloudnode1:/var/www# ls -laR
&gt; .:
&gt; total 36
&gt; drwxr-xr-x  4 www-data www-data 4096 2011-10-26 23:20 .
&gt; drwxr-xr-x 15 root     root     4096 2011-10-26 22:40 ..
&gt; -rw-r--r--  1 www-data www-data  177 2011-10-26 22:40 index.html
&gt; -rw-r--r--  1 www-data www-data  229 2011-10-26 23:16 info.php
&gt; drwxr-xr-x  2 root     root     4096 2011-10-26 23:15 .libvirt
&gt; -rw-r--r--  1 www-data www-data  313 2011-10-26 22:59 log.php
&gt; drwx------  2 www-data www-data 4096 2011-10-26 23:12 .ssh
&gt; -rw-r--r--  1 www-data www-data 4619 2011-10-26 23:17 test.log
&gt;
&gt; ./.libvirt:
&gt; total 8
&gt; drwxr-xr-x 2 root     root     4096 2011-10-26 23:15 .
&gt; drwxr-xr-x 4 www-data www-data 4096 2011-10-26 23:20 ..
&gt; lrwxrwxrwx 1 www-data www-data   29 2011-10-26 23:02 .libvirt-sock -&gt;
&gt; /var/run/libvirt/libvirt-sock
&gt;
&gt; ./.ssh:
&gt; total 16
&gt; drwx------ 2 www-data www-data 4096 2011-10-26 23:12 .
&gt; drwxr-xr-x 4 www-data www-data 4096 2011-10-26 23:20 ..
&gt; -rw------- 1 www-data www-data 1675 2011-10-26 23:11 id_rsa
&gt; -rw-r--r-- 1 www-data www-data  401 2011-10-26 23:11 id_rsa.pub
&gt; root@cloudnode1:/var/www#
&gt;
&gt;
&gt; Regards,
&gt; Peter
&gt;

 Not sure what you're trying to do but I believe if you're trying to give
null for connection, you should use null without quotes

[2011-10-26 23:17:07 libvirt-php/core]: libvirt_connect: Cannot establish
connection to (null)

Could you try this possibly?

$conn = libvirt_connect(null, false);

PS, I have never used the PHP bindings but I just noticed that.

-- 
Mohammed Naser — vexxhost
-----------------------------------------------------
D. 514-316-8872
D. 800-910-1726 ext. 200
E. mnaser@vexxhost.com
W. http://vexxhost.com

[Attachment #3 (text/html)]

&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Wed, Oct 26, 2011 at 11:31 AM, vmnode guy &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:vmnodeguy@gmail.com"&gt;vmnodeguy@gmail.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt; &lt;span \
style="border-collapse:collapse;font-family:arial, sans-serif;font-size:13px"&gt;Hello \
HetZ,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I try the put in the example and try run, but it's \
don't seem to be works.&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Do you have the same problem, \
do you know how should i proceed ?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;root@cn1:/var/www# \
cat info.php  &lt;/div&gt;&lt;div&gt;&lt;?php&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;        print_r ( \
libvirt_version() );&lt;/div&gt;

&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;            $conn = libvirt_connect('null', \
false);&lt;/div&gt;&lt;div&gt;//         $conn = libvirt_connect('qemu+ssh://&lt;a \
href="http://root@10.0.0.122/system" style="color:rgb(0, 0, 204)" \
target="_blank"&gt;root@10.0.0.122/system&lt;/a&gt;', false);&lt;/div&gt;

&lt;div&gt;            echo $conn;&lt;/div&gt;&lt;div&gt;            $doms = \
libvirt_list_domains($conn);&lt;/div&gt;&lt;div&gt;            \
print_r($doms);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;?&gt;&lt;/div&gt;&lt;div&gt;root@cn1:/var/www#  \
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;It doesn't show any output..&lt;/div&gt;

&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I also put this example into a file log.php and run \
it.&lt;/div&gt;&lt;div&gt;  &lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;?php&lt;/div&gt;&lt;div&gt;      $logfile = \
'test.log';&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;      unlink($logfile);&lt;/div&gt;&lt;div&gt;      \
if (!libvirt_logfile_set($logfile))&lt;/div&gt;

&lt;div&gt;              die('Cannot set the log file');&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;  \
$conn = libvirt_connect('null', false);&lt;/div&gt;&lt;div&gt;      \
unset($conn);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;      $fp = fopen($logfile, \
'r');&lt;/div&gt;

&lt;div&gt;      $str = fread($fp, filesize($logfile));&lt;/div&gt;&lt;div&gt;      \
fclose($fp);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;      echo \
$str;&lt;/div&gt;&lt;div&gt;?&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;It does generate a file and show \
error..  &lt;/div&gt;&lt;div&gt;&lt;div&gt;[Wed Oct 26 23:17:07 2011] [error] [client 10.0.0.201] PHP \
Warning:   libvirt_connect(): Failed to connect socket to \
'@/var/www/.libvirt/libvirt-sock': Connection refused in /var/www/log.php on \
line 8&lt;/div&gt;

&lt;div&gt;[2011-10-26 23:17:07 libvirt-php/core]: libvirt_connect: Cannot establish \
connection to (null)&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;My /var/www \
directory is like below:-&lt;/div&gt;&lt;div&gt;&lt;div&gt;root@cloudnode1:/var/www# ls -laR&lt;/div&gt;

&lt;div&gt;.:&lt;/div&gt;&lt;div&gt;total 36&lt;/div&gt;&lt;div&gt;drwxr-xr-x   4 www-data www-data 4096 2011-10-26 \
23:20 .&lt;/div&gt;&lt;div&gt;drwxr-xr-x 15 root       root       4096 2011-10-26 22:40 \
..&lt;/div&gt;&lt;div&gt;-rw-r--r--   1 www-data www-data   177 2011-10-26 22:40 index.html&lt;/div&gt;

&lt;div&gt;-rw-r--r--   1 www-data www-data   229 2011-10-26 23:16 \
info.php&lt;/div&gt;&lt;div&gt;drwxr-xr-x   2 root       root       4096 2011-10-26 23:15 \
.libvirt&lt;/div&gt;&lt;div&gt;-rw-r--r--   1 www-data www-data   313 2011-10-26 22:59 \
log.php&lt;/div&gt;&lt;div&gt;

drwx------   2 www-data www-data 4096 2011-10-26 23:12 .ssh&lt;/div&gt;&lt;div&gt;-rw-r--r--   1 \
www-data www-data 4619 2011-10-26 23:17 \
test.log&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;./.libvirt:&lt;/div&gt;&lt;div&gt;total 8&lt;/div&gt;&lt;div&gt;drwxr-xr-x \
2 root       root       4096 2011-10-26 23:15 .&lt;/div&gt;

&lt;div&gt;drwxr-xr-x 4 www-data www-data 4096 2011-10-26 23:20 ..&lt;/div&gt;&lt;div&gt;lrwxrwxrwx 1 \
www-data www-data    29 2011-10-26 23:02 .libvirt-sock -&gt; \
/var/run/libvirt/libvirt-sock&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;./.ssh:&lt;/div&gt;&lt;div&gt;total \
16&lt;/div&gt;

&lt;div&gt;drwx------ 2 www-data www-data 4096 2011-10-26 23:12 .&lt;/div&gt;&lt;div&gt;drwxr-xr-x 4 \
www-data www-data 4096 2011-10-26 23:20 ..&lt;/div&gt;&lt;div&gt;-rw------- 1 www-data www-data \
1675 2011-10-26 23:11 id_rsa&lt;/div&gt;&lt;div&gt;-rw-r--r-- 1 www-data www-data   401 \
2011-10-26 23:11 id_rsa.pub&lt;/div&gt;

&lt;div&gt;root@cloudnode1:/var/www#  \
&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;Peter&lt;/div&gt;&lt;/div&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; \
Not sure what you're trying to do but I believe if you're trying to give null \
for connection, you should use null without quotes&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div \
style="font-family: arial, sans-serif; font-size: 13px; "&gt;&lt;div&gt;[2011-10-26 23:17:07 \
libvirt-php/core]: libvirt_connect: Cannot establish connection to \
(null)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Could you try this possibly?&lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;$conn = libvirt_connect(null, \
false);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;PS, I have never used the PHP bindings but I just \
noticed that.&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- &lt;br&gt;&lt;span \
style="font-family:Arial;font-size:8pt"&gt;&lt;span style="color:rgb(70, 130, \
180);font-size:10pt"&gt;Mohammed Naser&lt;/span&gt;  —  &lt;span \
style="font-weight:bold"&gt;vexxhost&lt;/span&gt;&lt;br&gt; &lt;/span&gt;&lt;div&gt;&lt;span \
style="font-family:Arial;font-size:8pt"&gt;&lt;span&gt;&lt;span style="color:rgb(220, 220, \
220)"&gt;-----------------------------------------------------&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="font-family:Arial;font-size:11px;font-weight:bold"&gt;D.  &lt;/span&gt;&lt;span \
style="font-family:Arial;font-size:11px"&gt;514-316-8872&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span \
style="font-family:Arial;font-size:11px"&gt;&lt;span style="font-weight:bold"&gt;D.&lt;/span&gt;  \
800-910-1726 ext. 200&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="font-family:Arial;font-size:11px"&gt;&lt;span style="font-weight:bold"&gt;E.  &lt;/span&gt;&lt;a \
href="mailto:mnaser@vexxhost.com" \
target="_blank"&gt;mnaser@vexxhost.com&lt;/a&gt;&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span \
style="font-family:Arial;font-size:11px"&gt;&lt;span style="font-weight:bold"&gt;W.  &lt;/span&gt;&lt;a \
href="http://vexxhost.com/" target="_blank"&gt;http://vexxhost.com&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20111027153523</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-10-27 15:35:23-0400</timestampReceived><subject>Re: [libvirt-users] delete lvm problem: exited with non-zero status 5	and signal 0</subject><body>

On 10/27/2011 01:21 AM, lingjiao.lc wrote:
&gt; hi,
&gt;   I use the libvirt-python to manage my virtual machine. When I delete a
&gt; volume use vol.delete(0), sometimes it note me that has occur the error:
&gt;
&gt;                  libvirtError: internal error '/sbin/lvremove
&gt;                  -f /dev/vg.vmms/lvm-v097222.sqa.cm4' exited with
&gt;                  non-zero status 5 and signal 0:   Can't remove open
&gt;                  logical volume "lvm-v097222.sqa.cm4".
&gt;

&gt;
&gt; Could I change it like this: ?
&gt;          if (virRun(cmdargv, NULL)&lt;  0)
&gt;          const char *changeCmdarg[] = {
&gt;           LVCHANGE, "-a", "n", vol-&gt;target.path, NULL
&gt;          };
&gt;          if(virRun(changeCmdarg, NULL)&lt;  0)
&gt;              return -1;
&gt;          else
&gt;              if(virRun(cmdargv,NULL)&lt;  0)
&gt;                  return -1;

Changing it like that won't work - virRun fails with -1 if the command 
exits with non-zero status when the second argument is NULL.  But if you 
pass a pointer to an int on the first call, to capture (and ignore) the 
exit status of the first command, then you could get to the second call.

That said, does calling the change command twice, with no sleep in 
between, actually improve the situation?  The problem is that there is 
an inherent race in LVM operations, so we have to have a reliable way to 
tell when the race window is passed.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20111028002151</emailId><senderName>Trey Dockendorf</senderName><senderEmail>treydock@gmail.com</senderEmail><timestampReceived>2011-10-28 00:21:51-0400</timestampReceived><subject>[libvirt-users] Live migration with 2 nodes and no SAN</subject><body>

I'd like to begin using live migrations with my KVM install, but I do not
have any shared storage.  I will have 2 identical nodes, with their own
local storage.  Everything I've read seems to point to DRDB, but I am not
finding many resources on how to implement DRDB + qcow2 + KVM.
 Currently I've been using virt-manager to manage my VMs which are all using
qcow2 images.  With a setup using DRDB, if I mount the replicated device to
/var/lib/libvirt/images, what ensures that each virtual disk is only being
used by a single node until migration is needed?  I have no experience with
HA systems or services.

What suggestions or experiences has anyone had with this type of setup?  Any
advice is welcome.

Thanks
- Trey

[Attachment #3 (text/html)]

I'd like to begin using live migrations with my KVM install, but I do n=
ot have any shared storage. =A0I will have 2 identical nodes, with their ow=
n local storage. =A0Everything I've read seems to point to DRDB, but I =
am not finding many resources on how to implement DRDB + qcow2 + KVM. =A0Cu=
rrently=A0I've been using virt-manager to manage my VMs which are all u=
sing qcow2 images. =A0With a setup using DRDB, if I mount the replicated de=
vice to /var/lib/libvirt/images, what ensures that each virtual disk is onl=
y being used by a single node until migration is needed? =A0I have no exper=
ience with HA systems or services.&lt;div&gt;
&lt;br&gt;&lt;/div&gt;&lt;div&gt;What suggestions or experiences has anyone had with this typ=
e of setup? =A0Any advice is welcome.&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&lt;/div&gt;&lt;d=
iv&gt;- Trey&lt;/div&gt;&lt;/div&gt;


</body></email><email><emailId>20111028112231</emailId><senderName>vmnode guy</senderName><senderEmail>vmnodeguy@gmail.com</senderEmail><timestampReceived>2011-10-28 11:22:31-0400</timestampReceived><subject>[libvirt-users] libvirt-php - API libvirt_domain_suspend() problem, doesn't work</subject><body>

Hi Guys,

I was trying to suspend a virtual machine but fail not sure why.... However
i was successfully list all the vm on the host, below are my source code,
can any one who have experience in this area give me some advised ?


*My OUTPUT from browser*
Array
(
    [libvirt.release] =&gt; 3
    [libvirt.minor] =&gt; 9
    [libvirt.major] =&gt; 0
    [connector.version] =&gt; 0.4.3
    [connector.major] =&gt; 0
    [connector.minor] =&gt; 4
    [connector.release] =&gt; 3
)
Resource id #2Array
(
    [0] =&gt; VM_6E472D93-F943-2D1E-B1EA-5896D95B9C84
    [1] =&gt; VM_B090CFCA-77FE-962B-9D06-F85047324527
    [2] =&gt; VM_7478E5EB-B843-225A-00FC-09D0E846FE61
    [3] =&gt; winxpnew
    [4] =&gt; VM_1F9BC5A1-352D-0E7D-8BAB-F46FBFE1C80D
    [5] =&gt; VM_B6DA1C45-3F0D-16EF-FDF1-512935D88C37
    [6] =&gt; VM_F32717EE-4AA4-A17C-8E4B-D1D5A79612A5
    [7] =&gt; VM_03ABB818-D226-32FB-0A6E-458849AB7C7B
    [8] =&gt; nagios
    [9] =&gt; VM_6C158DB3-71BE-A0D1-3FFB-1EEE5854E45D
    [10] =&gt; VM_8D560513-036A-14FD-7546-48C370F0A057
    [11] =&gt; VM_AA3DC5CA-A447-E6E5-0E7A-869416869B1D
    [12] =&gt; VM_C19AC7F1-AA49-92D0-336F-B8A8D7FADCD5
)


*Below are my php source : -*
&lt;?php

        echo "&lt;html&gt;&lt;body&gt;&lt;pre&gt;";
        print_r ( libvirt_version() );

        $conn = libvirt_connect('qemu+ssh://root@10.0.0.122/system', true);
        echo $conn;

        $doms = libvirt_list_domains($conn);
        print_r($doms);

        $doms =
libvirt_domain_suspend('VM_7478E5EB-B843-225A-00FC-09D0E846FE61');
        print_r($doms);

        echo "&lt;/pre&gt;&lt;/body&gt;&lt;/html&gt;";
?&gt;

Thanks!!

Regards,
Peter

[Attachment #3 (text/html)]

&lt;div&gt;Hi Guys,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I was trying to suspend a virtual machine but \
fail not sure why.... However i was successfully list all the vm on the host, below \
are my source code, can any one who have experience in this area give me some advised \
? &lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;u&gt;My OUTPUT from \
browser&lt;/u&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;Array&lt;/div&gt;&lt;div&gt;(&lt;/div&gt;&lt;div&gt;    [libvirt.release] \
=&gt; 3&lt;/div&gt;&lt;div&gt;    [libvirt.minor] =&gt; 9&lt;/div&gt;&lt;div&gt;    [libvirt.major] =&gt; \
0&lt;/div&gt; &lt;div&gt;    [connector.version] =&gt; 0.4.3&lt;/div&gt;&lt;div&gt;    [connector.major] \
=&gt; 0&lt;/div&gt;&lt;div&gt;    [connector.minor] =&gt; 4&lt;/div&gt;&lt;div&gt;    [connector.release] \
=&gt; 3&lt;/div&gt;&lt;div&gt;)&lt;/div&gt;&lt;div&gt;Resource id #2Array&lt;/div&gt;&lt;div&gt;(&lt;/div&gt; &lt;div&gt;    [0] \
=&gt; VM_6E472D93-F943-2D1E-B1EA-5896D95B9C84&lt;/div&gt;&lt;div&gt;    [1] =&gt; \
VM_B090CFCA-77FE-962B-9D06-F85047324527&lt;/div&gt;&lt;div&gt;    [2] =&gt; \
VM_7478E5EB-B843-225A-00FC-09D0E846FE61&lt;/div&gt;&lt;div&gt;    [3] =&gt; winxpnew&lt;/div&gt; &lt;div&gt;  \
[4] =&gt; VM_1F9BC5A1-352D-0E7D-8BAB-F46FBFE1C80D&lt;/div&gt;&lt;div&gt;    [5] =&gt; \
VM_B6DA1C45-3F0D-16EF-FDF1-512935D88C37&lt;/div&gt;&lt;div&gt;    [6] =&gt; \
VM_F32717EE-4AA4-A17C-8E4B-D1D5A79612A5&lt;/div&gt;&lt;div&gt;    [7] =&gt; \
VM_03ABB818-D226-32FB-0A6E-458849AB7C7B&lt;/div&gt; &lt;div&gt;    [8] =&gt; nagios&lt;/div&gt;&lt;div&gt;    \
[9] =&gt; VM_6C158DB3-71BE-A0D1-3FFB-1EEE5854E45D&lt;/div&gt;&lt;div&gt;    [10] =&gt; \
VM_8D560513-036A-14FD-7546-48C370F0A057&lt;/div&gt;&lt;div&gt;    [11] =&gt; \
VM_AA3DC5CA-A447-E6E5-0E7A-869416869B1D&lt;/div&gt; &lt;div&gt;    [12] =&gt; \
VM_C19AC7F1-AA49-92D0-336F-B8A8D7FADCD5&lt;/div&gt;&lt;div&gt;)&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;u&gt;Below \
are my php source : -&lt;/u&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;?php&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;        \
echo "&lt;html&gt;&lt;body&gt;&lt;pre&gt;";&lt;/div&gt; &lt;div&gt;        print_r ( \
libvirt_version() );&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;        $conn = \
libvirt_connect('qemu+ssh://&lt;a \
href="http://root@10.0.0.122/system"&gt;root@10.0.0.122/system&lt;/a&gt;', \
true);&lt;/div&gt;&lt;div&gt;        echo $conn;&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;        $doms = \
libvirt_list_domains($conn);&lt;/div&gt;&lt;div&gt;        \
print_r($doms);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;        $doms = \
libvirt_domain_suspend('VM_7478E5EB-B843-225A-00FC-09D0E846FE61');&lt;/div&gt;&lt;div&gt; \
print_r($doms);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;        echo \
"&lt;/pre&gt;&lt;/body&gt;&lt;/html&gt;";&lt;/div&gt;&lt;div&gt;?&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks!!&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;Peter&lt;/div&gt;




</body></email><email><emailId>20111028202615</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-10-28 20:26:15-0400</timestampReceived><subject>Re: [libvirt-users] live migration error without shared storage</subject><body>

On 10/28/2011 12:54 AM, Luengffy XUE wrote:
&gt;
&gt;
&gt;&gt; As to the actual error, I'm not sure if I can offer advice until I try to
&gt;&gt; reproduce it, but I do know that --copy-storage-all hasn't received as much
&gt;&gt; testing.  Make sure that an empty file exists on the destination prior to
&gt;&gt; the migration attempt, in case the error is stemming from qemu on the
&gt;&gt; destination unable to open the file with SELinux permissions in force.
&gt;&gt;
&gt;&gt;
&gt; I  have created the right image file on the destination host.I have already
&gt; reardown the apparmor. I want to know how to shut down the selinux on the
&gt; ubuntu server.

SELinux and AppArmor are competing security measures, and tend to not be 
installed on the same machine.  SELinux is typically Fedora-based, while 
Ubuntu favors AppArmor - but I'm not familiar enough with AppArmor to 
know if that would be the root cause of your problems.

&gt;
&gt;&gt; Also, what version of libvirt are you using?  Newer libvirt tries harder to
&gt;&gt; avoid the lame error messages from qemu being unable to start a migration
&gt;&gt; without giving any reasons why.
&gt;&gt;
&gt;&gt;
&gt;
&gt; The version of libvit I am using is:
&gt;
&gt; Compiled against library  :  libvir 0.8.8
&gt; Using library:      libvir  0.8.8
&gt; Using API :  QEMU 0.8.8
&gt; Runing hypervisor: QEMU 0.14.0

Are you comfortable building libvirt yourself?  The latest version is 
0.9.6, and has had some improvements in helping diagnose the causes of 
migration failures.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20111029174320</emailId><senderName>vmnode guy</senderName><senderEmail>vmnodeguy@gmail.com</senderEmail><timestampReceived>2011-10-29 17:43:20-0400</timestampReceived><subject>Re: [libvirt-users] How to collect the VM bandwidth usage utilization</subject><body>

Hi Peter Phaal

Thanks for your recommendation, i will take sometime to go through &amp;
see how to implementing this thing.. it is a bit complex to me..

Regards,
Peter
On Thu, Oct 27, 2011 at 7:18 AM, Peter Phaal &lt;peter.phaal@gmail.com&gt; wrote:
&gt;
&gt; If you are trying to monitor KVM, XenServer or Xen then you might want
&gt; to take a look at the Host sFlow project:
&gt; http://host-sflow.sourceforge.net/
&gt;
&gt; The Host sFlow agent is installed on the hypervisor and exports
&gt; libvirt metrics for the VMs. sFlow uses a push model, continually
&gt; streaming the metrics as UDP datagrams to a central collector. Pushing
&gt; the statistics scales much better than polling and automatically
&gt; adapts as VMs are added, moved and removed.
&gt;
&gt; Take a look at Ganglia for collecting and displaying the metrics:
&gt; http://ganglia.sourceforge.net/
&gt;
&gt; If you are using the latest versions of XCP or XenServer, then you can
&gt; use sFlow monitoring in the Open vSwitch to get detailed visibility
&gt; into traffic flows:
&gt; http://openvswitch.org/
&gt;
&gt; Open vSwitch supports both sFlow and NetFlow for traffic monitoring,
&gt; the following article provides a comparison:
&gt; http://blog.sflow.com/2011/10/comparing-sflow-and-netflow-in-vswitch.html
&gt;
&gt; Peter
&gt;
&gt; On Sun, Oct 23, 2011 at 11:12 PM, vmnode guy &lt;vmnodeguy@gmail.com&gt; wrote:
&gt; &gt; Hi Guy,
&gt; &gt; I am trying to figure out how &amp; where can i get the bandwidth usage
&gt; &gt; utilization statistic info for all the VM, so in the end i will be able to
&gt; &gt; use it for metering purpose..
&gt; &gt; Anyone got any idea ?
&gt; &gt; Regards,
&gt; &gt; Peter
&gt; &gt; _______________________________________________
&gt; &gt; libvirt-users mailing list
&gt; &gt; libvirt-users@redhat.com
&gt; &gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; &gt;

</body></email><email><emailId>20111031164839</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-10-31 16:48:39-0400</timestampReceived><subject>Re: [libvirt-users] VM with transient disk</subject><body>

On 10/31/2011 12:54 AM, Till Mossakowski wrote:
&gt; Hi Osier,
&gt;
&gt; are there other hypervisors supporting it?

Not yet.  It was added to the XML with intents to support it in at least 
ESX and qemu, but neither driver has completed this support of the XML 
yet.  And it looks like 0.9.7 won't have it either, now that we are in 
feature freeze for the next release.  I'll get to it eventually, but I 
would welcome anyone else trying to contribute patches in the meantime, 
since I have been distracted by bug fixes lately (fixing any existing 
but broken behavior tends to take priority over implementing new behavior).

&gt;
&gt; And what about qemu's option "snapshot=on" ?

Unreliable.  It won't work with SELinux (since qemu tries to create the 
snapshot on /tmp), and it makes your guest unmigratable.  I think that 
it is easier to have libvirt use qemu-img to create a qcow2 wrapper 
prior to booting the guest, at which point the solution is easier to 
control from an sVirt perspective, and is more likely to allow us to 
figure out a way to make things work with migration (at least, I'm 
hoping I can figure out how to migrate a guest with a transient disk).

But if you want to use qemu's snapshot=on in the meantime, you can use 
the &lt;qemu:commandline&gt; namespace XML to add it.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20111031214054</emailId><senderName>Till Mossakowski</senderName><senderEmail>till@communtu.de</senderEmail><timestampReceived>2011-10-31 21:40:54-0400</timestampReceived><subject>Re: [libvirt-users] [ruby-libvirt] who's using it</subject><body>

We are using ruby-libvirt for Communtu (en.communtu.org), see
https://github.com/communtu/communtu
in particular
https://github.com/communtu/communtu/blob/master/app/models/livecd.rb

Best, Till

Am 31.10.2011 18:21, schrieb Mohammed Naser:
&gt; On Mon, Oct 31, 2011 at 12:56 PM, Christian Parpart &lt;trapni@gentoo.org
&gt; &lt;mailto:trapni@gentoo.org&gt;&gt; wrote:
&gt;
&gt;     Hey all,
&gt;
&gt;     I would like to know who / what project is using this binding. So I
&gt;     could learn the API a bit easier than reading through the rough
&gt;     rdoc-based API documentation, which is not really helpful to me, as
&gt;     I do not know the C API yet either.
&gt;
&gt;     my intention is, to some day, be able to create a Rails web app for
&gt;     managing libvirt hosts (mainly OpenVZ/vserver/LXC and possibly QEMU).
&gt;
&gt;     Thanks in advance,
&gt;     Christian Parpart.
&gt;
&gt;     _______________________________________________
&gt;     libvirt-users mailing list
&gt;     libvirt-users@redhat.com &lt;mailto:libvirt-users@redhat.com&gt;
&gt;     https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;
&gt;
&gt; Take a look at oVirt, I believe it's mostly written using Ruby on Rails
&gt; and uses the Gem.
&gt;
&gt; git://git.fedorahosted.org/git/ovirt/server.git
&gt; &lt;http://git.fedorahosted.org/git/ovirt/server.git&gt;
&gt;
&gt; Good luck!
&gt;
&gt; --
&gt; Mohammed Naser — vexxhost
&gt; -----------------------------------------------------
&gt; D. 514-316-8872
&gt; D. 800-910-1726 ext. 200
&gt; E. mnaser@vexxhost.com &lt;mailto:mnaser@vexxhost.com&gt;
&gt; W. http://vexxhost.com &lt;http://vexxhost.com/&gt;
&gt;
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110905101038</emailId><senderName>Olivier BONHOMME</senderName><senderEmail>obonhomme@nerim.net</senderEmail><timestampReceived>2011-09-05 10:10:38-0400</timestampReceived><subject>Re: [libvirt-users] CPU Model detection with virsh capabilities</subject><body>

Le 02/08/2011 10:51, Olivier BONHOMME a écrit :
&gt; Hello everybody,
&gt;
&gt; I am a new user discovering libvirt with KVM software. During my first
&gt; VM creation, I saw an issue with virsh that I can't understand.
&gt;
&gt; I wanted to emulate another CPU than the classical qemu32 using virsh.
&gt; So I used the virsh capabilites command to detect how is detected my CPU
&gt; host which is an Intel Xeon E5410 and my problem is that this CPU is
&gt; detected only with the cpumodel "pentium3".
&gt;
&gt; But if use the kvm -cpu ? command, it returns me the following
&gt; capabilities :
&gt;
&gt; $ kvm -cpu ?
&gt; x86 qemu64
&gt; x86 phenom
&gt; x86 core2duo
&gt; x86 kvm64
&gt; x86 qemu32
&gt; x86 coreduo
&gt; x86 486
&gt; x86 pentium
&gt; x86 pentium2
&gt; x86 pentium3
&gt; x86 athlon
&gt; x86 n270
&gt;
&gt; Moreover, if i decide to use the pentium3 cpumodel for my KVM VM, the
&gt; CentOS freeze during its loading.
&gt;
&gt; My libvirt and kvm are the following on a Debian Squeeeze :
&gt;
&gt; $ virsh version
&gt; Compiled against library: libvir 0.8.3
&gt; Using library: libvir 0.8.3
&gt; Using API: QEMU 0.8.3
&gt; Running hypervisor: QEMU 0.12.5
&gt;
&gt; Does anybody already had the same issue or am I doing anything wrong ?
&gt;

Hello again,

I am still locked with that issued about capabilities detection. I tried 
to look on the doc but can't find anything. Does anybody has an entry 
point for that or should it be considered as a bug ?

Thanks again

Regards,
Olivier BONHOMME

</body></email><email><emailId>20110906170214</emailId><senderName>Alphonse Hansel Anthony</senderName><senderEmail>alphonse.anthony@gmail.com</senderEmail><timestampReceived>2011-09-06 17:02:14-0400</timestampReceived><subject>[libvirt-users] Reg: Difference between chroot &amp; pivot_root</subject><body>

Hi,
   What is the difference between chroot &amp; pivot_root.
   They don't seem obvious based on the man pages apart from the below
mentioned
   caveats.

   1) Inherited Open file descriptors, have to be explicitly closed.
   2) Does not change CWD of the process, which can be overcome by doing a
chdir before &amp; after chroot call.

   Any information on this would be useful.

Thanks,
Alphonse

[Attachment #3 (text/html)]

&lt;font color="#666666"&gt;&lt;font size="2"&gt;&lt;font face="verdana,sans-serif"&gt;&lt;br&gt;Hi,&lt;br&gt;   \
What is the difference between chroot &amp; pivot_root. &lt;br&gt;   They don't seem \
obvious based on the man pages apart from the below mentioned&lt;br&gt;  caveats.&lt;br&gt;&lt;br&gt;   \
1) Inherited Open file descriptors, have to be explicitly closed.&lt;br&gt;   2) Does not \
change CWD of the process, which can be overcome by doing a chdir before &amp; after \
chroot call.&lt;br&gt;   &lt;br&gt;   Any information on this would be useful.&lt;br&gt;  \
&lt;br&gt;Thanks,&lt;br&gt;Alphonse&lt;br&gt;  &lt;br&gt;&lt;/font&gt;&lt;/font&gt;&lt;/font&gt;



</body></email><email><emailId>20110913214624</emailId><senderName>Igor Serebryany</senderName><senderEmail>igor47@moomers.org</senderEmail><timestampReceived>2011-09-13 21:46:24-0400</timestampReceived><subject>[libvirt-users] cpu time totals</subject><body>


Hi!

	I'm comparing the cpu usage of a VM from virDomainGetInfo and the
	usages returned per-vcpu from virDomainGetVcpus and the totals do
	not match up. 

	I expect that the cpu usages reported per-vcpu, when summed, should
	equal the total cpu usage of the domain, but there is quite a large
	gap between them. Is there something I'm missing?

	See this example code using the python bindings:

&gt;&gt;&gt; import libvirt
&gt;&gt;&gt; c = libvirt.open('qemu:///system')
&gt;&gt;&gt; d = c.lookupByID(51)
&gt;&gt;&gt; d.info()[4]
111390000000L
&gt;&gt;&gt; d.vcpus()[0]
[(0, 1, 12720000000L, 1), (1, 1, 2980000000L, 0), (2, 1, 3150000000L, 1), (3, 1, 2600000000L, 0)]
&gt;&gt;&gt; sum([vcpu[2] for vcpu in d.vcpus()[0]])
21520000000L
&gt;&gt;&gt; d.info()[4] - sum([vcpu[2] for vcpu in d.vcpus()[0]])
91760000000L

	Why is this additional 91 seconds not reflected in time spent by the
	vcpus? What exactly is the meaning of the cpuTime parameter of the
	virVcpuInfo struct?

Thanks,
--Igor

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20110913125354</emailId><senderName>Guido Winkelmann</senderName><senderEmail>guido-libvi@unknownsite.de</senderEmail><timestampReceived>2011-09-13 12:53:54-0400</timestampReceived><subject>[libvirt-users] How to install libvirt 0.9.4 RPM on Fedora 14?</subject><body>

Hi,

I'm trying to install the newest version of libvirt and libvirt-client from 
the rpms at ftp://libvirt.org/libvirt/ on a Fedora 14 machine. The naming of 
the rpms as "libvirt-0.9.4-1.fc14.x86_64.rpm" suggests that this is exactly 
the system this was made for, however, installation still does not go 
smoothly.
When I try to install these packages with

yum install libvirt-client-0.9.4-1.fc14.x86_64.rpm \ 
libvirt-0.9.4-1.fc14.x86_64.rpm

, some of the dependencies get resolved automatically, but not all of them, 
and I get these error messages:

Error: Package: libvirt-0.9.4-1.fc14.x86_64 (/libvirt-0.9.4-1.fc14.x86_64)
           Requires: libblktapctl.so.1.0()(64bit)
Error: Package: libvirt-client-0.9.4-1.fc14.x86_64 (/libvirt-
client-0.9.4-1.fc14.x86_64)
           Requires: libnetcf.so.1(NETCF_1.4.0)(64bit)
Error: Package: libvirt-0.9.4-1.fc14.x86_64 (/libvirt-0.9.4-1.fc14.x86_64)
           Requires: libnetcf.so.1(NETCF_1.4.0)(64bit)

Apparently, I need newer versions of netcf-libs and xen-libs. Where do I get 
these from? There don't appear to be any official rpms or that for Fedora 
14...

Regards,

	Guido

</body></email><email><emailId>20110914130603</emailId><senderName>Trey Dockendorf</senderName><senderEmail>treydock@gmail.com</senderEmail><timestampReceived>2011-09-14 13:06:03-0400</timestampReceived><subject>[libvirt-users] Libvirt daemon usage question</subject><body>

I could use some help with clarification on the use of the libvirtd daemon
with regards to managing remote KVM instances.  Right now I have a CentOS 6
KVM server (libvirt-0.8.1), but would like to use some management
applications that require higher version (0.8.8).  First, is it possible to
run the libvirtd daemon from within a VM, or does it require active kvm
kernel module?  Secondly, could a daemon running in say Fedora 15 (0.8.8) be
used to communicate with my CentOS 6 daemon (0.8.1).  Does this sort of
model present a problem if the KVM host is not using the same or close to
the same version as the remote libvirtd?

My understanding of how to use libvirtd remotely is a bit weak, so any
clarification would be greatly appreciated.

Thanks
- Trey

[Attachment #3 (text/html)]

I could use some help with clarification on the use of the libvirtd daemon =
with regards to managing remote KVM instances. =A0Right now I have a CentOS=
 6 KVM server (libvirt-0.8.1), but would like to use some management applic=
ations that require higher version (0.8.8). =A0First, is it possible to run=
 the libvirtd daemon from within a VM, or does it require active kvm kernel=
 module? =A0Secondly, could a daemon running in say Fedora 15 (0.8.8) be us=
ed to communicate with my CentOS 6 daemon (0.8.1). =A0Does this sort of mod=
el present a problem if the KVM host is not using the same or close to the =
same version as the remote libvirtd?&lt;div&gt;
&lt;br&gt;&lt;/div&gt;&lt;div&gt;My understanding of how to use libvirtd remotely is a bit we=
ak, so any clarification would be greatly appreciated.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;=
&lt;div&gt;Thanks&lt;/div&gt;&lt;div&gt;- Trey&lt;/div&gt;


</body></email><email><emailId>20110915073014</emailId><senderName>huachao yao</senderName><senderEmail>yao.d.hc@gmail.com</senderEmail><timestampReceived>2011-09-15 07:30:14-0400</timestampReceived><subject>[libvirt-users] Config Errro when Creating a virtual device attachment to backend</subject><body>

Hi, buddy,
I want to create a virtual device attachment to backend.
The domain is running, and my code  phase is as below:

xmlConfiguration    = "&lt;devices&gt;&lt;sound model='es1370'/&gt;&lt;/devices&gt;";
virDomainAttachDevice(dom,xmlConfiguration);

But the exception "libvir: Domain Config error : XML error: unknown device
type " happen when running.
Is it something wrong in the XML configuration? What should i do to deal
with such Config error ?

ps: the hypervisor is KVM.

[Attachment #3 (text/html)]

Hi, buddy,&lt;br&gt;I want to create a virtual device attachment to backend.&lt;br&gt;The domain \
is running, and my code  phase is as below:&lt;br&gt;&lt;br&gt;&lt;font size="4"&gt;&lt;span style="color: \
rgb(0, 0, 0);"&gt;xmlConfiguration    = "&lt;devices&gt;&lt;sound \
model='es1370'/&gt;&lt;/devices&gt;";&lt;/span&gt;&lt;br style="color: rgb(0, 0, \
0);"&gt; &lt;span style="color: rgb(0, 0, \
0);"&gt;virDomainAttachDevice(dom,xmlConfiguration);&lt;/span&gt;&lt;/font&gt;&lt;br&gt;&lt;br&gt;But the \
exception &lt;span style="color: rgb(204, 0, 0);"&gt;"libvir: Domain Config error : \
XML error: unknown device type "&lt;/span&gt; happen when running.&lt;br&gt; Is it something \
wrong in the XML configuration? What should i do to deal with such &lt;span \
style="color: rgb(204, 0, 0);"&gt;Config error &lt;span style="color: rgb(0, 0, \
0);"&gt;?&lt;br&gt;&lt;br&gt;ps: the hypervisor is KVM.&lt;br&gt;&lt;/span&gt;&lt;/span&gt;



</body></email><email><emailId>20110913151754</emailId><senderName>Guido Winkelmann</senderName><senderEmail>guido-libvi@unknownsite.de</senderEmail><timestampReceived>2011-09-13 15:17:54-0400</timestampReceived><subject>[libvirt-users] libvirt does not recognize all devices in iscsi and mpath pools in a predictable man</subject><body>

Hi,

I'm using libvirt 0.8.3 on Fedora 14 (as I wrote earlier, I'm having some 
trouble updating to the newest version), and I'm having problems getting iscsi 
and mpath storage pools to work in a usable and consistent manner.

I have two storage pools defined on the host machine, one for raw iscsi-
devices and one for those same iscsi devices device-mapped by multipath. They 
look like this:

&lt;pool type='iscsi'&gt;
  &lt;name&gt;iscsi01&lt;/name&gt;
  &lt;source&gt;
    &lt;host name='10.3.1.15'/&gt;
    &lt;device 
path='iqn.1984-05.com.dell:powervault.md3200i.6782bcb0000859f3000000004d3eec7d'/&gt;     \
  &lt;/source&gt;                                                                           \
  &lt;target&gt;                                                                            \
  &lt;path&gt;/dev/disk/by-id&lt;/path&gt;                                                        \
  &lt;/target&gt;                                                                           \
 &lt;/pool&gt;

and:

&lt;pool type="mpath"&gt;
  &lt;name&gt;mpath01&lt;/name&gt;
  &lt;target&gt;
    &lt;path&gt;/dev/mapper&lt;/path&gt;
  &lt;/target&gt;
&lt;/pool&gt;

I chose &lt;path&gt;/dev/disk/by-id&lt;/path&gt; over /dev/disk/by-path for the iscsi pool 
because I need to be able to migrate running virtual machines to other hosts, 
so the actual device paths for the disks need to be the same on all hosts in 
the cluster.

I have two LUNs configured in the iSCSI array, and when I list the volumes in 
the iscsi pool, I get this:

virsh # vol-list iscsi01
Name                 Pfad                                    
-----------------------------------------
23.0.0.1             /dev/disk/by-id/wwn-0x6782bcb0000859f3000007004e680190
23.0.0.2             /dev/disk/by-id/scsi-36782bcb0000859f3000007294e6e73f2

Apparently, for some weird reason, libvirt chooses one naming scheme for one 
of the volumes and another for the other one. This a problem for me for two 
reasons.

1 - Once I create a new lun for a new VM, rescan the iscsi bus and refresh 
libvirt's pool (see my mail from 24th of August on this list), I need to be 
able to automatically and reliably identify the corresponding new volumes in 
libvirt's volume list, so I can initialize them by copying an OS image onto 
them and then assign them to the new virtual machine. This is made a lot 
harder if libvirt randomly switches between naming schemes - though still 
feasible if I'm aware of the problem.

2 - I need to be able to migrate running VMs to a different host machine, in 
case the current one is overloaded or in need of maintenance. This is bound to 
be problematic if the storage volumes go by different path names on the 
different hosts.

Both LUNs do appear under both naming schemes under /dev/disk/by-id:

ls /dev/disk/by-id/
[...]
scsi-36782bcb0000859f3000007004e680190
[...]
scsi-36782bcb0000859f3000007294e6e73f2
scsi-36a4badb00b0f910012e0fccb07606fe6
[...]
wwn-0x6782bcb0000859f3000007004e680190
[...]
wwn-0x6782bcb0000859f3000007294e6e73f2
wwn-0x6a4badb00b0f910012e0fccb07606fe6
[...]

(snipped some irrelevant parts)

With the mpath pool, it's even worse: One of the two volumes is completely 
missing:

virsh # vol-list mpath01
Name                 Pfad                                    
-----------------------------------------
dm-3                 /dev/mapper/36782bcb0000859f3000007004e680190

Both iscsi volumes have in fact been picked up by multipathd and do appear in 
/dev/mapper/, too, but no matter how often I say refresh-pool mpath01, it will 
always only show the one volume.

Does anybody know of these problems or how to work around them? Are these 
problems solved in newer versions? (I could not find anyhting in the 
bugtracker...)

	Guido


</body></email><email><emailId>20110921201603</emailId><senderName>Jeff</senderName><senderEmail>jwk1230@gmail.com</senderEmail><timestampReceived>2011-09-21 20:16:03-0400</timestampReceived><subject>[libvirt-users] virsh console</subject><body>

Probably a dumb question, but when I run virsh console guestname, should I expect to get a login prompt for my guest?  If I run that command while the OS is booting I can see the boot process...but then it just freezes and I never get a login prompt.

Jeff

</body></email><email><emailId>20110921143830</emailId><senderName>"Gian Uberto Lauri"</senderName><senderEmail>saint@eng.it</senderEmail><timestampReceived>2011-09-21 14:38:30-0400</timestampReceived><subject>[libvirt-users] random "monitor socket did not show up"</subject><body>

Hello gentlemen!

I just experienced this weird thing:

I have 2 machines (one is a Dell Pe1950 with 2 Xeon 5130, the other is
a Fujitsu RX200S6  with 2 Xeon E5645), both run  CentoOS 5.6, the DELL
has   the    2.6.18-238.9.1.el5   while    the   Fujitsu    runs   the
2.6.18-238.12.1.el5 kernel.

But when I try to do a virsh create with this script

&lt;domain type='kvm'&gt;
	&lt;name&gt;one-292&lt;/name&gt;
	&lt;memory&gt;1894400&lt;/memory&gt;
	&lt;os&gt;
		&lt;type arch='i686'&gt;hvm&lt;/type&gt;
		&lt;boot dev='hd'/&gt;
	&lt;/os&gt;
	&lt;devices&gt;
		&lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;
		&lt;disk type='file' device='disk'&gt;
			&lt;source file='/var/lib/one/292/images/disk.0'/&gt;
			&lt;target dev='hda'/&gt;
			&lt;driver name='qemu' type='qcow2'/&gt;
		&lt;/disk&gt;
		&lt;disk type='file' device='cdrom'&gt;
			&lt;source file='/var/lib/one/292/images/disk.1'/&gt;
			&lt;target dev='hdb'/&gt;
			&lt;readonly/&gt;
			&lt;driver name='qemu' type='raw'/&gt;
		&lt;/disk&gt;
		&lt;interface type='bridge'&gt;
			&lt;source bridge='br0:0'/&gt;
			&lt;mac address='20:00:ac:14:fe:06'/&gt;
		&lt;/interface&gt;
		&lt;graphics type='vnc' listen='0.0.0.0' port='6192'/&gt;
	&lt;/devices&gt;
&lt;/domain&gt;

it works  perfectly on the Dell.  On the Fujitsu it  failed repeatedly
and then worked.

Any explainations and some hint on getting it work always ?

--
ing. Gian Uberto Lauri
Ricercatore / Reasearcher
Laboratorio Ricerca e Sviluppo / Research &amp; Development Lab.
Area Calcolo Distribuito / Distributed Computation Area

GianUberto.Lauri@eng.it

Engineering Ingegneria Informatica spa
Corso Stati Uniti 23/C, 35127 Padova (PD) 

Tel. +39-049.8283.571         | main(){printf(&amp;unix["\021%six\012\0"], 
Fax  +39-049.8283.569		  |    (unix)["have"]+"fun"-0x60);}   
Skype: gian.uberto.lauri	  |          David Korn, AT&amp;T Bell Labs             
http://www.eng.it 			  |          ioccc best One Liner, 1987             


</body></email><email><emailId>20110922123448</emailId><senderName>smain kahlouch</senderName><senderEmail>smainklh@gmail.com</senderEmail><timestampReceived>2011-09-22 12:34:48-0400</timestampReceived><subject>[libvirt-users] Hot cloning &amp; P2V</subject><body>

Hi all,

I guess my question is stupid and has been asked a thousand times but i was
wondering if it's possible to do the following things:

- Cloning of a running virtual machine (hot copy)
- Migrate a physical server to a virtual one.

I googled a bit and am not able to find the answers.

Thanks.

Regards,
Sam

[Attachment #3 (text/html)]

Hi all,&lt;br&gt;&lt;br&gt;I guess my question is stupid and has been asked a thousand =
times but i was wondering if it's possible to do the following things:&lt;=
br&gt;&lt;br&gt;- Cloning of a running virtual machine (hot copy)&lt;br&gt;- Migrate a phy=
sical server to a virtual one.&lt;br&gt;
&lt;br&gt;I googled a bit and am not able to find the answers.&lt;br&gt;&lt;br&gt;Thanks.&lt;br&gt;=
&lt;br&gt;Regards,&lt;br&gt;Sam&lt;br&gt;


</body></email><email><emailId>20110923084140</emailId><senderName>huachao yao</senderName><senderEmail>yao.d.hc@gmail.com</senderEmail><timestampReceived>2011-09-23 08:41:40-0400</timestampReceived><subject>[libvirt-users] The Format Of URI when Migrating</subject><body>

Hi, when I try to use such API:

virDomainPtr &lt;http://www.libvirt.org/html/libvirt-libvirt.html#virDomainPtr&gt;	virDomainMigrate	(virDomainPtr
 &lt;http://www.libvirt.org/html/libvirt-libvirt.html#virDomainPtr&gt;
domain,
					 virConnectPtr
&lt;http://www.libvirt.org/html/libvirt-libvirt.html#virConnectPtr&gt;
dconn,
					 unsigned long flags,
					 const char * dname,
					 const char * uri,
					 unsigned long bandwidth)
to achieve the domain to the remote host. I set the "const char * uri"
as "qemu+ssh://root@116.56.142.199/system".
But the Error "libvir: QEMU error : invalid argument in only tcp URIs
are supported for KVM/QEMU migrations" happened.

I want to know when i want the migrate ,how can i set the URI ? offer
a example is better.   :-)


[Attachment #3 (text/html)]

&lt;font style="font-family: simsun,serif;" size="2"&gt;Hi, when I try to use such \
API:&lt;br&gt;&lt;/font&gt;&lt;pre class="programlisting"&gt;&lt;font style="font-family: simsun,serif;" \
size="2"&gt;&lt;a href="http://www.libvirt.org/html/libvirt-libvirt.html#virDomainPtr"&gt;virDomainPtr&lt;/a&gt;	virDomainMigrate	(&lt;a \
href="http://www.libvirt.org/html/libvirt-libvirt.html#virDomainPtr"&gt;virDomainPtr&lt;/a&gt; \
domain, &lt;br&gt;  &lt;a href="http://www.libvirt.org/html/libvirt-libvirt.html#virConnectPtr"&gt;virConnectPtr&lt;/a&gt; \
dconn, &lt;br&gt;					 unsigned long flags, &lt;br&gt;					 const char * dname, &lt;br&gt;					 const \
char * uri, &lt;br&gt;					 unsigned long bandwidth)&lt;br&gt; to achieve the domain to the \
remote host. I set the "&lt;span style="color: rgb(204, 0, 0);"&gt;const char * \
uri&lt;/span&gt;" as "&lt;span style="color: rgb(255, 0, 0);"&gt;qemu+ssh://&lt;a \
href="http://root@116.56.142.199/system"&gt;root@116.56.142.199/system&lt;/a&gt;&lt;/span&gt;".&lt;br&gt;
 But the Error "&lt;span style="color: rgb(255, 0, 0);"&gt;libvir: QEMU error : \
invalid argument in only tcp URIs are supported for KVM/QEMU migrations&lt;/span&gt;" \
happened.&lt;br&gt;&lt;br&gt;I want to know when i want the migrate ,how can i set the URI ? \
offer a example is better.   :-)&lt;/font&gt;&lt;br&gt; &lt;/pre&gt;&lt;br&gt;



</body></email><email><emailId>20110909140245</emailId><senderName>Kiran Javaid</senderName><senderEmail>kiran.javaid@live.com</senderEmail><timestampReceived>2011-09-09 14:02:45-0400</timestampReceived><subject>[libvirt-users] virDomainDefineXml Issue</subject><body>

Hello Everyone,

I am facing a problem in defining the xml for domain creation using libvirt. I am using Xen hypervisor.

domPtr = lib.virDomainDefineXML(conPtr, domainXML);

I get the following error:

"libvir: Xen Daemon error : XML error: failed to parse domain description"

Any suggestions are welcome.

Regards.
 		 	   		  
[Attachment #3 (text/html)]

&lt;html&gt;
&lt;head&gt;
&lt;style&gt;&lt;!--
.hmmessage P
{
margin:0px;
padding:0px
}
body.hmmessage
{
font-size: 10pt;
font-family:Tahoma
}
--&gt;&lt;/style&gt;
&lt;/head&gt;
&lt;body class='hmmessage'&gt;&lt;div dir='ltr'&gt;
Hello Everyone,&lt;br&gt;&lt;br&gt;I am facing a problem in defining the xml for domain creation \
using libvirt. I am using Xen hypervisor.&lt;br&gt;&lt;br&gt;domPtr = \
lib.virDomainDefineXML(conPtr, domainXML);&lt;br&gt;&lt;br&gt;I get the following \
error:&lt;br&gt;&lt;br&gt;"libvir: Xen Daemon error : XML error: failed to parse domain \
description"&lt;br&gt;&lt;br&gt;Any suggestions are welcome.&lt;br&gt;&lt;br&gt;Regards.&lt;br&gt; 		 	   		  \
&lt;/div&gt;&lt;/body&gt; &lt;/html&gt;



</body></email><email><emailId>20110915132715</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2011-09-15 13:27:15-0400</timestampReceived><subject>[libvirt-users] ANNOUNCE: oz 0.7.0 release</subject><body>

All,
     I'm pleased to announce release 0.7.0 of Oz.  Oz is a program for doing
automated installation of guest operating systems with limited input from
the user.
     Release 0.7.0 is a bugfix and feature release for Oz.  Some of the
highlights between Oz 0.6.0 and 0.7.0 are:

- Ability to use the "direct initrd injection" method to install Fedora/RHEL
guests.  This is an internal implementation detail, but can significantly speed
up installs for Fedora or RHEL guests.  (thanks for the tip from
Kashyap Chamarthy)
- Support for Fedora-16 (thanks to Steve Dake for help in making this work)
- Use the serial port to announce guest boot, rather than a network port.  This
makes it so we no longer have to manipulate iptables, and gets us one step
closer to having Oz run as non-root
- (for developers) Re-written unittests in python for speedier execution
- (for developers) Additional methods in the TDL class to merge in external
package lists (thanks to Ian McLeod)

A tarball of this release is available, as well as packages for Fedora-14,
Fedora-15, and RHEL-6.  Note that to install the RHEL-6 packages, you must be
running RHEL-6.1 or later.  Instructions on how to get and use Oz are available
at http://aeolusproject.org/oz.html

If you have any questions or comments about Oz, please feel free to contact
aeolus-devel@lists.fedorahosted.org or me (clalance@redhat.com) directly.

Thanks to everyone who contributed to this release through bug reports,
patches, and suggestions for improvement.

-- 
Chris Lalancette

</body></email><email><emailId>20110925204501</emailId><senderName>"Sergio A. Kessler"</senderName><senderEmail>sergiokessler@gmail.com</senderEmail><timestampReceived>2011-09-25 20:45:01-0400</timestampReceived><subject>[libvirt-users] new guest with same name as undefined one</subject><body>

hi,

- host: rhel6
- I created a guest rmdev2 (centos6)
- undefined it
- again created rmdev2 guest (centos6)

now I get:


[root@rmdev1 var]# virsh -c qemu:///system
Welcome to virsh, the virtualization interactive terminal.

Type:  'help' for help with commands
       'quit' to quit

virsh # list --all
 Id Name                 State
----------------------------------
  - rmdev2               shut off

virsh # start rmdev2
error: Failed to start domain rmdev2
error: operation failed: cannot restore domain 'rmdev2' uuid
9e9ea633-9691-f3d6-64da-ae9c8b3e5810 from a file which belongs to
domain 'rmdev2' uuid 4f425d14-335b-0adc-11af-06e503c6b54d

why ?
it seems the ghost of the old guest is causing problems...
all the files used by the first guest are deleted...


thanks.
/sergio

</body></email><email><emailId>20110926164212</emailId><senderName>"Sergio A. Kessler"</senderName><senderEmail>sergio@kessler.com.ar</senderEmail><timestampReceived>2011-09-26 16:42:12-0400</timestampReceived><subject>[libvirt-users] changue bridge name, libvirt refuses to take new name</subject><body>

hi all,

(this events ocurred before my previous mail about the uuid incident)

so, I installed a vm
host: rhel6
guest: centos6
network: bridge (br0, eth1 as slave)

but then, I changed the name of the bridge from br0 to br1
(because br1&lt;-&gt;eth1 seems pretty than br0&lt;-&gt;eth1)

so:

- mv /etc/sysconfig/network-scripts/ifcfg-br0
/etc/sysconfig/network-scripts/ifcfg-br1

- edited /etc/sysconfig/network-scripts/ifcfg-br1
  change DEVICE=br0 by DEVICE=br1

- edited /etc/sysconfig/network-scripts/ifcfg-eth1 and
changed the line BRIDGE=br0 to BRIDGE=br1

- edited /etc/libvirt/qemu/rmdev2.xml and changed the line &lt;source
bridge='br0'/&gt; to &lt;source bridge='br1'/&gt;

- service network restart
  &lt;aside note&gt;
    boom! lost connection to the server
    I had to go to server location (a few miles) by car
    because the network restart didn't stop br0 because thera was no script br0
    and when br1 started produced a collision
  &lt;/aside note&gt;

- service libvirtd restart

# brctl show
bridge name     bridge id               STP enabled     interfaces
br1             8000.e41f13ba6e1a       no              eth1
virbr0          8000.5254003a3124       yes             virbr0-nic

# virsh -c qemu:///system start rmdev2
error: Failed to start domain rmdev2
error: Failed to add tap interface to bridge 'br0': No such device

there *nothing* 'br0' in /etc in the system (I grepped it),
why is looking for br0 instead of br1 ?


I ended up undefining rmdev2, installing a new guest called rmdev2
using br1, and that was when I got the
error: operation failed: cannot restore domain 'rmdev2' uuid
9e9ea633-9691-f3d6-64da-ae9c8b3e5810 from a file which belongs to
domain 'rmdev2' uuid 4f425d14-335b-0adc-11af-06e503c6b54d

yes, I was ready to fire the house and leaving for better places...


thanks,
/sergio

</body></email><email><emailId>20110926203019</emailId><senderName>Robin Lee Powell</senderName><senderEmail>rlpowell@digitalkingdom.org</senderEmail><timestampReceived>2011-09-26 20:30:19-0400</timestampReceived><subject>[libvirt-users] virsh edit problems</subject><body>


I've got a problem where I can't access my console (well, I can',
but I can't type in a password), which I don't think is a libvirt
issue but any help or commentary is certainly welcome
http://thread.gmane.org/gmane.comp.emulators.kvm.devel/79561 , and
I'm trying to debug it by trying out different console/serial
options in my .xml file, and I can't change them.

What I have now:

    &lt;serial type='pty'&gt;
      &lt;target port='0'/&gt;
    &lt;/serial&gt;
    &lt;console type='pty'&gt;
      &lt;target type='serial' port='0'/&gt;
    &lt;/console&gt;

No matter what I change, whether I use "virsh edit" or edit the
files directly, even with libvirt off, as soon as libvirt notices
(i.e. when I turn it back on) my changes get blown away and it ends
up looking just like the above.  Even as simple a thing as changing
the port number, or removing the console, or adding a second
serial... all gone.

Oh, wait, that's not quite true; adding a second serial *does* work.
But nothing else I've tried does.

What I'm actually trying to do is copy the docs
http://libvirt.org/formatdomain.html#elementsConsole more closely
and specify my own source paths; I'm worried that the serial and the
console are somehow ending up in the same place and maybe that's
causing my problem?

What I've been trying to do is something like:

    &lt;serial type='pty'&gt;
      &lt;source path='/dev/pts/3'/&gt;
      &lt;target port='0'/&gt;
    &lt;/serial&gt;
    &lt;console type='pty'&gt;
      &lt;source path='/dev/pts/4'/&gt;
      &lt;target port='0'/&gt;
    &lt;/console&gt;

And it just won't stick.  Maybe that's not even my problem, but it's
not showing any errors, and it's annoying me and I'd like to
understand why.

-Robin

</body></email><email><emailId>20110926204023</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-09-26 20:40:23-0400</timestampReceived><subject>Re: [libvirt-users] virsh edit problems</subject><body>

On 09/26/2011 02:30 PM, Robin Lee Powell wrote:
&gt; What I have now:
&gt;
&gt;      &lt;serial type='pty'&gt;
&gt;        &lt;target port='0'/&gt;
&gt;      &lt;/serial&gt;
&gt;      &lt;console type='pty'&gt;
&gt;        &lt;target type='serial' port='0'/&gt;
&gt;      &lt;/console&gt;

That's correct for the persistent config.

&gt;
&gt; No matter what I change, whether I use "virsh edit"

Good.

&gt; or edit the
&gt; files directly,

Don't do that.  It won't work, and you risk corrupting things by going 
behind libvirt's back.

 &gt; even with libvirt off, as soon as libvirt notices
&gt; (i.e. when I turn it back on) my changes get blown away and it ends
&gt; up looking just like the above.  Even as simple a thing as changing
&gt; the port number, or removing the console, or adding a second
&gt; serial... all gone.

That's an indication that the things you are adding are not essential to 
the persistent config.  'virsh edit' prunes your input back into the xml 
essential to what libvirt needed, so if your edits didn't stick, then 
they weren't making a difference.

&gt;
&gt; Oh, wait, that's not quite true; adding a second serial *does* work.
&gt; But nothing else I've tried does.
&gt;
&gt; What I'm actually trying to do is copy the docs
&gt; http://libvirt.org/formatdomain.html#elementsConsole more closely
&gt; and specify my own source paths; I'm worried that the serial and the
&gt; console are somehow ending up in the same place and maybe that's
&gt; causing my problem?
&gt;
&gt; What I've been trying to do is something like:
&gt;
&gt;      &lt;serial type='pty'&gt;
&gt;        &lt;source path='/dev/pts/3'/&gt;
&gt;        &lt;target port='0'/&gt;
&gt;      &lt;/serial&gt;

Ah - maybe I can explain that issue.  For pty devices, &lt;source 
path=.../&gt; is computed at runtime, once libvirt has actually allocated a 
pty from the host (which pty gets allocated depends on what else has 
been going on in your host prior to starting your guest).  Since the pty 
allocated is dependent on various runtime factors, there is no way to 
pre-allocate a fixed pty value - so this &lt;source&gt; element is something 
that 'virsh dumpxml' outputs to show you which pty libvirt allocated, 
but where you have no control (and no need to control) which pty to 
attempt to allocate.  And libvirt is merely stripping the unused 
&lt;source&gt; from your persistent config because it doesn't make sense in a 
persistent context.

&gt;      &lt;console type='pty'&gt;
&gt;        &lt;source path='/dev/pts/4'/&gt;
&gt;        &lt;target port='0'/&gt;
&gt;      &lt;/console&gt;
&gt;
&gt; And it just won't stick.  Maybe that's not even my problem, but it's
&gt; not showing any errors, and it's annoying me and I'd like to
&gt; understand why.

Hopefully my explanation helps, but feel free to ask more questions as 
needed.  Perhaps this is a case of me answering your stated question 
rather than your implied question (that is, I answered why &lt;source&gt; is 
disappearing, but not how to get a console to your guest working in the 
first place).

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20110926124231</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-09-26 12:42:31-0400</timestampReceived><subject>Re: [libvirt-users] new guest with same name as undefined one</subject><body>

On 09/25/2011 02:45 PM, Sergio A. Kessler wrote:
&gt; hi,
&gt;
&gt; - host: rhel6
&gt; - I created a guest rmdev2 (centos6)
&gt; - undefined it

This step is buggy on older servers; it was fixed in upstream libvirt 
0.9.4 to refuse deletion unless you first ensure that any managed save 
metadata has been removed (also, 0.9.5 also refuses deletion unless you 
first ensure any snapshot metadata has been removed, but that does not 
appear to be your problem).

&gt; - again created rmdev2 guest (centos6)
&gt;
&gt; now I get:
&gt;
&gt; virsh # start rmdev2
&gt; error: Failed to start domain rmdev2
&gt; error: operation failed: cannot restore domain 'rmdev2' uuid
&gt; 9e9ea633-9691-f3d6-64da-ae9c8b3e5810 from a file which belongs to
&gt; domain 'rmdev2' uuid 4f425d14-335b-0adc-11af-06e503c6b54d

start is trying to reuse the stale managed save image that was left 
behind by the older domain that was not completely undefined.  You 
should be able to correct the problem by doing 'virsh managedsave-remove 
rmdev2' before 'virsh start rmdev2'.

&gt;
&gt; why ?
&gt; it seems the ghost of the old guest is causing problems...
&gt; all the files used by the first guest are deleted...

Yep, and that's why newer libvirt prevents this situation from happening.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20110926125214</emailId><senderName>David Cohen</senderName><senderEmail>cdavid@physics.technion.ac.il</senderEmail><timestampReceived>2011-09-26 12:52:14-0400</timestampReceived><subject>Re: [libvirt-users] new guest with same name as undefined one</subject><body>

Hi,
See if you have a /var/lib/libvirt/qemu/save/your_guest_name.save
That might be the ghost of the old guest preventing startup.

-- 
David Cohen

On Sunday 25 September 2011 23:45:01 Sergio A. Kessler wrote:
&gt; hi,
&gt; 
&gt; - host: rhel6
&gt; - I created a guest rmdev2 (centos6)
&gt; - undefined it
&gt; - again created rmdev2 guest (centos6)
&gt; 
&gt; now I get:
&gt; 
&gt; 
&gt; [root@rmdev1 var]# virsh -c qemu:///system
&gt; Welcome to virsh, the virtualization interactive terminal.
&gt; 
&gt; Type:  'help' for help with commands
&gt;        'quit' to quit
&gt; 
&gt; virsh # list --all
&gt;  Id Name                 State
&gt; ----------------------------------
&gt;   - rmdev2               shut off
&gt; 
&gt; virsh # start rmdev2
&gt; error: Failed to start domain rmdev2
&gt; error: operation failed: cannot restore domain 'rmdev2' uuid
&gt; 9e9ea633-9691-f3d6-64da-ae9c8b3e5810 from a file which belongs to
&gt; domain 'rmdev2' uuid 4f425d14-335b-0adc-11af-06e503c6b54d
&gt; 
&gt; why ?
&gt; it seems the ghost of the old guest is causing problems...
&gt; all the files used by the first guest are deleted...
&gt; 
&gt; 
&gt; thanks.
&gt; /sergio
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110926125748</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-09-26 12:57:48-0400</timestampReceived><subject>Re: [libvirt-users] new guest with same name as undefined one</subject><body>

On 09/26/2011 06:52 AM, David Cohen wrote:
&gt; Hi,
&gt; See if you have a /var/lib/libvirt/qemu/save/your_guest_name.save
&gt; That might be the ghost of the old guest preventing startup.

Yes, that's exactly what I suspect.  However, directly messing with 
files under /var/lib/libvirt/... is not recommended; rather, you should 
go through public libvirt interfaces; in this case, 'virsh 
managedsave-remove your_guest_name'.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20110912102641</emailId><senderName>Jiri Denemark</senderName><senderEmail>jdenemar@redhat.com</senderEmail><timestampReceived>2011-09-12 10:26:41-0400</timestampReceived><subject>Re: [libvirt-users] virDomainDefineXml Issue</subject><body>

On Fri, Sep 09, 2011 at 16:02:45 +0200, Kiran Javaid wrote:
&gt; 
&gt; Hello Everyone,
&gt; 
&gt; I am facing a problem in defining the xml for domain creation using libvirt. I am using Xen hypervisor.
&gt; 
&gt; domPtr = lib.virDomainDefineXML(conPtr, domainXML);
&gt; 
&gt; I get the following error:
&gt; 
&gt; "libvir: Xen Daemon error : XML error: failed to parse domain description"

This suggests there is an error in your xml. Would you mind sending the
content of domainXML to this list?

Jirka

</body></email><email><emailId>20110915110232</emailId><senderName>Kiran Javaid</senderName><senderEmail>kiran.javaid@live.com</senderEmail><timestampReceived>2011-09-15 11:02:32-0400</timestampReceived><subject>Re: [libvirt-users] virDomainDefineXml Issue</subject><body>

The contents of my xml:&lt;domain type='xen' &gt;  &lt;name&gt;for_kiran&lt;/name&gt;  \
&lt;uuid&gt;d636ccee-ca30-11e0-9624-001f160cb28c&lt;/uuid&gt;  &lt;!-- \
&lt;bootloader&gt;/usr/bin/pygrub&lt;/bootloader&gt;--&gt;  &lt;os&gt;    &lt;type&gt;hvm&lt;/type&gt;    \
&lt;loader&gt;/usr/lib/xen/boot/hvmloader&lt;/loader&gt;  &lt;/os&gt;  &lt;memory&gt;512000&lt;/memory&gt;  \
&lt;vcpu&gt;1&lt;/vcpu&gt;  &lt;devices&gt;    &lt;disk type='file'&gt;      &lt;source \
file='/root/for_kiran.img'/&gt;      &lt;target dev='hda'/&gt;    &lt;/disk&gt;    &lt;interface \
type='network'&gt;         &lt;source network='default'/&gt;         &lt;mac \
address='aa:00:00:00:00:11'/&gt;         &lt;script path='/etc/xen/scripts/vif-nat'/&gt;       \
&lt;/interface&gt;    &lt;!-- &lt;console tty='/dev/pty'/&gt; --&gt;    &lt;graphics type="vnc" /&gt;  \
&lt;/devices&gt;&lt;/domain&gt;

&gt; Date: Mon, 12 Sep 2011 12:26:41 +0200
&gt; From: jdenemar@redhat.com
&gt; To: kiran.javaid@live.com
&gt; CC: libvirt-users@redhat.com
&gt; Subject: Re: [libvirt-users] virDomainDefineXml Issue
&gt; 
&gt; On Fri, Sep 09, 2011 at 16:02:45 +0200, Kiran Javaid wrote:
&gt; &gt; 
&gt; &gt; Hello Everyone,
&gt; &gt; 
&gt; &gt; I am facing a problem in defining the xml for domain creation using libvirt. I am \
&gt; &gt; using Xen hypervisor. 
&gt; &gt; domPtr = lib.virDomainDefineXML(conPtr, domainXML);
&gt; &gt; 
&gt; &gt; I get the following error:
&gt; &gt; 
&gt; &gt; "libvir: Xen Daemon error : XML error: failed to parse domain description"
&gt; 
&gt; This suggests there is an error in your xml. Would you mind sending the
&gt; content of domainXML to this list?
&gt; 
&gt; Jirka
 		 	   		  


[Attachment #3 (text/html)]

&lt;html&gt;
&lt;head&gt;
&lt;style&gt;&lt;!--
.hmmessage P
{
margin:0px;
padding:0px
}
body.hmmessage
{
font-size: 10pt;
font-family:Tahoma
}
--&gt;&lt;/style&gt;
&lt;/head&gt;
&lt;body class='hmmessage'&gt;&lt;div dir='ltr'&gt;
&lt;span class="Apple-style-span" style="color: rgb(42, 42, 42); font-family: 'Segoe \
UI', Tahoma, Verdana, Arial, sans-serif; line-height: 17px; background-color: \
rgb(255, 255, 255); "&gt;The contents of my xml:&lt;br style="line-height: 17px; "&gt;&lt;br \
style="line-height: 17px; "&gt;&lt;domain type='xen' &gt;&lt;br style="line-height: 17px; \
"&gt;  &lt;name&gt;for_kiran&lt;/name&gt;&lt;br style="line-height: 17px; "&gt;  \
&lt;uuid&gt;d636ccee-ca30-11e0-9624-001f160cb28c&lt;/uuid&gt;&lt;br style="line-height: \
17px; "&gt;  &lt;!-- &lt;bootloader&gt;/usr/bin/pygrub&lt;/bootloader&gt;--&gt;&lt;br \
style="line-height: 17px; "&gt;  &lt;os&gt;&lt;br style="line-height: 17px; \
"&gt;    &lt;type&gt;hvm&lt;/type&gt;&lt;br style="line-height: 17px; \
"&gt;    &lt;loader&gt;/usr/lib/xen/boot/hvmloader&lt;/loader&gt;&lt;br \
style="line-height: 17px; "&gt;  &lt;/os&gt;&lt;br style="line-height: 17px; "&gt;  \
&lt;memory&gt;512000&lt;/memory&gt;&lt;br style="line-height: 17px; "&gt;  \
&lt;vcpu&gt;1&lt;/vcpu&gt;&lt;br style="line-height: 17px; "&gt;  &lt;devices&gt;&lt;br \
style="line-height: 17px; "&gt;    &lt;disk type='file'&gt;&lt;br \
style="line-height: 17px; "&gt;      &lt;source \
file='/root/for_kiran.img'/&gt;&lt;br style="line-height: 17px; \
"&gt;      &lt;target dev='hda'/&gt;&lt;br style="line-height: \
17px; "&gt;    &lt;/disk&gt;&lt;br style="line-height: 17px; \
"&gt;    &lt;interface type='network'&gt;&lt;br style="line-height: 17px; \
"&gt;         &lt;source \
network='default'/&gt;&lt;br style="line-height: 17px; \
"&gt;         &lt;mac \
address='aa:00:00:00:00:11'/&gt;&lt;br style="line-height: 17px; \
"&gt;         &lt;script \
path='/etc/xen/scripts/vif-nat'/&gt;&lt;br style="line-height: 17px; \
"&gt;         &lt;/interface&gt;&lt;br \
style="line-height: 17px; "&gt;    &lt;!-- &lt;console \
tty='/dev/pty'/&gt; --&gt;&lt;br style="line-height: 17px; "&gt;    \
&lt;graphics type="vnc" /&gt;&lt;br style="line-height: 17px; "&gt;  \
&lt;/devices&gt;&lt;br style="line-height: 17px; \
"&gt;&lt;/domain&gt;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;div&gt;&gt; Date: Mon, 12 Sep 2011 12:26:41 \
+0200&lt;br&gt;&gt; From: jdenemar@redhat.com&lt;br&gt;&gt; To: kiran.javaid@live.com&lt;br&gt;&gt; CC: \
libvirt-users@redhat.com&lt;br&gt;&gt; Subject: Re: [libvirt-users] virDomainDefineXml \
Issue&lt;br&gt;&gt; &lt;br&gt;&gt; On Fri, Sep 09, 2011 at 16:02:45 +0200, Kiran Javaid \
wrote:&lt;br&gt;&gt; &gt; &lt;br&gt;&gt; &gt; Hello Everyone,&lt;br&gt;&gt; &gt; &lt;br&gt;&gt; &gt; I am \
facing a problem in defining the xml for domain creation using libvirt. I am using \
Xen hypervisor.&lt;br&gt;&gt; &gt; &lt;br&gt;&gt; &gt; domPtr = lib.virDomainDefineXML(conPtr, \
domainXML);&lt;br&gt;&gt; &gt; &lt;br&gt;&gt; &gt; I get the following error:&lt;br&gt;&gt; &gt; \
&lt;br&gt;&gt; &gt; "libvir: Xen Daemon error : XML error: failed to parse domain \
description"&lt;br&gt;&gt; &lt;br&gt;&gt; This suggests there is an error in your xml. Would you \
mind sending the&lt;br&gt;&gt; content of domainXML to this list?&lt;br&gt;&gt; &lt;br&gt;&gt; \
Jirka&lt;br&gt;&lt;/div&gt; 		 	   		  &lt;/div&gt;&lt;/body&gt; &lt;/html&gt;



</body></email><email><emailId>20110922005255</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-09-22 00:52:55-0400</timestampReceived><subject>Re: [libvirt-users] random "monitor socket did not show up"</subject><body>

于 2011年09月21日 22:38, Gian Uberto Lauri 写道:
&gt; Hello gentlemen!
&gt;
&gt; I just experienced this weird thing:
&gt;
&gt; I have 2 machines (one is a Dell Pe1950 with 2 Xeon 5130, the other is
&gt; a Fujitsu RX200S6  with 2 Xeon E5645), both run  CentoOS 5.6, the DELL
&gt; has   the    2.6.18-238.9.1.el5   while    the   Fujitsu    runs   the
&gt; 2.6.18-238.12.1.el5 kernel.
&gt;
&gt; But when I try to do a virsh create with this script
&gt;
&gt; &lt;domain type='kvm'&gt;
&gt; 	&lt;name&gt;one-292&lt;/name&gt;
&gt; 	&lt;memory&gt;1894400&lt;/memory&gt;
&gt; 	&lt;os&gt;
&gt; 		&lt;type arch='i686'&gt;hvm&lt;/type&gt;
&gt; 		&lt;boot dev='hd'/&gt;
&gt; 	&lt;/os&gt;
&gt; 	&lt;devices&gt;
&gt; 		&lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;
&gt; 		&lt;disk type='file' device='disk'&gt;
&gt; 			&lt;source file='/var/lib/one/292/images/disk.0'/&gt;
&gt; 			&lt;target dev='hda'/&gt;
&gt; 			&lt;driver name='qemu' type='qcow2'/&gt;
&gt; 		&lt;/disk&gt;
&gt; 		&lt;disk type='file' device='cdrom'&gt;
&gt; 			&lt;source file='/var/lib/one/292/images/disk.1'/&gt;
&gt; 			&lt;target dev='hdb'/&gt;
&gt; 			&lt;readonly/&gt;
&gt; 			&lt;driver name='qemu' type='raw'/&gt;
&gt; 		&lt;/disk&gt;
&gt; 		&lt;interface type='bridge'&gt;
&gt; 			&lt;source bridge='br0:0'/&gt;
&gt; 			&lt;mac address='20:00:ac:14:fe:06'/&gt;
&gt; 		&lt;/interface&gt;
&gt; 		&lt;graphics type='vnc' listen='0.0.0.0' port='6192'/&gt;
&gt; 	&lt;/devices&gt;
&gt; &lt;/domain&gt;
&gt;
&gt; it works  perfectly on the Dell.  On the Fujitsu it  failed repeatedly
&gt; and then worked.
&gt;
&gt; Any explainations and some hint on getting it work always ?

Hi, Gian

What's the error on the Fujitsu box?

Osier

</body></email><email><emailId>20110913153916</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-09-13 15:39:16-0400</timestampReceived><subject>Re: [libvirt-users] libvirt does not recognize all devices in iscsi and mpath pools in a predictable</subject><body>

On Tue, Sep 13, 2011 at 05:17:54PM +0200, Guido Winkelmann wrote:
&gt; Hi,
&gt; 
&gt; I'm using libvirt 0.8.3 on Fedora 14 (as I wrote earlier, I'm having some 
&gt; trouble updating to the newest version), and I'm having problems getting iscsi 
&gt; and mpath storage pools to work in a usable and consistent manner.
&gt; 
&gt; I have two storage pools defined on the host machine, one for raw iscsi-
&gt; devices and one for those same iscsi devices device-mapped by multipath. They 
&gt; look like this:
&gt; 
&gt; &lt;pool type='iscsi'&gt;
&gt; &lt;name&gt;iscsi01&lt;/name&gt;
&gt; &lt;source&gt;
&gt; &lt;host name='10.3.1.15'/&gt;
&gt; &lt;device 
&gt; path='iqn.1984-05.com.dell:powervault.md3200i.6782bcb0000859f3000000004d3eec7d'/&gt;   \
&gt;  &lt;/source&gt;                                                                          \
&gt;  &lt;target&gt;                                                                           \
&gt;  &lt;path&gt;/dev/disk/by-id&lt;/path&gt;                                                       \
&gt;  &lt;/target&gt;                                                                          \
&gt;  &lt;/pool&gt;
&gt; 
&gt; and:
&gt; 
&gt; &lt;pool type="mpath"&gt;
&gt; &lt;name&gt;mpath01&lt;/name&gt;
&gt; &lt;target&gt;
&gt; &lt;path&gt;/dev/mapper&lt;/path&gt;
&gt; &lt;/target&gt;
&gt; &lt;/pool&gt;
&gt; 
&gt; I chose &lt;path&gt;/dev/disk/by-id&lt;/path&gt; over /dev/disk/by-path for the iscsi pool 
&gt; because I need to be able to migrate running virtual machines to other hosts, 
&gt; so the actual device paths for the disks need to be the same on all hosts in 
&gt; the cluster.

/dev/disk/by-path should be the same across all hosts too, at least for iSCSI,
but perhaps not FibreChannel - depending on the udev naming scheme.

&gt; I have two LUNs configured in the iSCSI array, and when I list the volumes in 
&gt; the iscsi pool, I get this:
&gt; 
&gt; virsh # vol-list iscsi01
&gt; Name                 Pfad                                    
&gt; -----------------------------------------
&gt; 23.0.0.1             /dev/disk/by-id/wwn-0x6782bcb0000859f3000007004e680190
&gt; 23.0.0.2             /dev/disk/by-id/scsi-36782bcb0000859f3000007294e6e73f2
&gt; 
&gt; Apparently, for some weird reason, libvirt chooses one naming scheme for one 
&gt; of the volumes and another for the other one. This a problem for me for two 
&gt; reasons.
&gt; 
&gt; 1 - Once I create a new lun for a new VM, rescan the iscsi bus and refresh 
&gt; libvirt's pool (see my mail from 24th of August on this list), I need to be 
&gt; able to automatically and reliably identify the corresponding new volumes in 
&gt; libvirt's volume list, so I can initialize them by copying an OS image onto 
&gt; them and then assign them to the new virtual machine. This is made a lot 
&gt; harder if libvirt randomly switches between naming schemes - though still 
&gt; feasible if I'm aware of the problem.
&gt; 
&gt; 2 - I need to be able to migrate running VMs to a different host machine, in 
&gt; case the current one is overloaded or in need of maintenance. This is bound to 
&gt; be problematic if the storage volumes go by different path names on the 
&gt; different hosts.

Yeah, that's clearly not acceptable &amp; we need to fix libvirt here.

&gt; 
&gt; Both LUNs do appear under both naming schemes under /dev/disk/by-id:
&gt; 
&gt; ls /dev/disk/by-id/
&gt; [...]
&gt; scsi-36782bcb0000859f3000007004e680190
&gt; [...]
&gt; scsi-36782bcb0000859f3000007294e6e73f2
&gt; scsi-36a4badb00b0f910012e0fccb07606fe6
&gt; [...]
&gt; wwn-0x6782bcb0000859f3000007004e680190
&gt; [...]
&gt; wwn-0x6782bcb0000859f3000007294e6e73f2
&gt; wwn-0x6a4badb00b0f910012e0fccb07606fe6
&gt; [...]
&gt; 
&gt; (snipped some irrelevant parts)

This is the problem. Our code is assuming that /dev/disk/by-id contains
only 1 symlink per disk. For some reason your udev rules are creating
multiple symlinks per disk, and hence breaking libvirt.

We iterate over the entries in /dev/disk/by-id, so we get them back in
whatever order the filesystem feels like today. What we need todo is
to read all the matches for that disk, sort the results, and then
pick the first result.

Or, we might want to make it possible to specify a target path of

  /dev/disk/by-id/www-*

so that you can choose which naming scheme to use.

&gt; With the mpath pool, it's even worse: One of the two volumes is completely 
&gt; missing:
&gt; 
&gt; virsh # vol-list mpath01
&gt; Name                 Pfad                                    
&gt; -----------------------------------------
&gt; dm-3                 /dev/mapper/36782bcb0000859f3000007004e680190
&gt; 
&gt; Both iscsi volumes have in fact been picked up by multipathd and do appear in 
&gt; /dev/mapper/, too, but no matter how often I say refresh-pool mpath01, it will 
&gt; always only show the one volume.

This is a little odd, I've no immediate explanation for it.


Daniel
-- 
&gt; &gt; http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
&gt; &gt; http://libvirt.org              -o-             http://virt-manager.org :|
&gt; &gt; http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
&gt; &gt; http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|


</body></email><email><emailId>20110914144406</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-09-14 14:44:06-0400</timestampReceived><subject>Re: [libvirt-users] Libvirt daemon usage question</subject><body>

On 09/14/2011 07:06 AM, Trey Dockendorf wrote:
&gt; I could use some help with clarification on the use of the libvirtd daemon
&gt; with regards to managing remote KVM instances.  Right now I have a CentOS 6
&gt; KVM server (libvirt-0.8.1), but would like to use some management
&gt; applications that require higher version (0.8.8).  First, is it possible to
&gt; run the libvirtd daemon from within a VM, or does it require active kvm
&gt; kernel module?

Running libvirtd in a VM makes senses only if you are set up for nested 
VMs (that is, libvirtd runs in the host, and controls guests of that 
host; if you run libvirtd within a level 1 VM, then you are controlling 
level 2 guests).  Level 2 nested guests are rare; I've done it before 
with a xen PV guest running inside a kvm guest, but it is certainly not 
typical.  Generally, you only need to run libvirtd in the bare-metal 
(level 0) host.

Libvirtd does not require the kvm kernel module, but without the kvm 
kernel module, any qemu guests that you run will not have hardware 
acceleration, and will appear to run very slowly.

&gt;  Secondly, could a daemon running in say Fedora 15 (0.8.8) be
&gt; used to communicate with my CentOS 6 daemon (0.8.1).

Yes, newer clients can always talk to older servers, with the caveat 
that any function call or flag bits that were added after the older 
server will gracefully fail instead of doing the functionality that the 
newer servers can give.  http://libvirt.org/hvsupport.html gives a good 
overview of which APIs will fail (but we don't yet have an automated way 
to document which releases add support for various flag bits within 
existing APIs).

&gt;  Does this sort of
&gt; model present a problem if the KVM host is not using the same or close to
&gt; the same version as the remote libvirtd?

Libvirt is designed for backwards compatibility - so you get the least 
common denominator between features that your client knows how to invoke 
as features your remote server knows how to respond to.  Mismatch in 
libvirt versions is not a problem, as long as you don't use any APIs not 
present in the oldest version of the two sides.

Given your original qeustion, if your management apps really do require 
0.8.8 APIs, then you'll need to upgrade libvirtd on your CentOS host to 
be at least 0.8.8 in order to honor your management app requests, or 
else modify your management app to gracefully implement fallbacks to 
older API approaches that were available in 0.8.1.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20110914221317</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-09-14 22:13:17-0400</timestampReceived><subject>Re: [libvirt-users] Libvirt daemon usage question</subject><body>

[let's keep the list in the loop]

On 09/14/2011 04:07 PM, Trey Dockendorf wrote:
&gt;&gt; Given your original qeustion, if your management apps really do require
&gt; 0.8.8 APIs, then you'll need to upgrade libvirtd on your CentOS host to be
&gt; at least 0.8.8 in order to honor your management app requests, or else
&gt; modify your management app to gracefully implement fallbacks to older API
&gt; approaches that were available in 0.8.1.
&gt;&gt;
&gt;
&gt; How risky is it to implement a newer version of libvirt in something like
&gt; centos?  I figure based on the huge number of dependencies that its not
&gt; something to safely do.  So far we building my libvirt rpms Ive only used
&gt; the same source for the version with centos and the libvirt specs provided
&gt; in the fedora src rpms.  Do the specs know to check for specific versions of
&gt; dependencies?

There's not that many source dependencies for building a newer libvirt 
out-of-the-box on top of CentOS.  You might also find 
https://fedoraproject.org/wiki/Virtualization_Preview_Repository as a 
useful example for the amount of effort involved in running newer virt 
tools on top of an otherwise stable repository.  Also, search the list 
archives; the topic of installing the latest libvirt on CentOS or RHEL 5 
has come up several times recently, with various tidbits of good advice.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20110913161341</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2011-09-13 16:13:41-0400</timestampReceived><subject>Re: [libvirt-users] How to install libvirt 0.9.4 RPM on Fedora 14?</subject><body>

On 09/13/2011 08:53 AM, Guido Winkelmann wrote:
&gt; Hi,
&gt;
&gt; I'm trying to install the newest version of libvirt and libvirt-client from
&gt; the rpms at ftp://libvirt.org/libvirt/ on a Fedora 14 machine. The naming of
&gt; the rpms as "libvirt-0.9.4-1.fc14.x86_64.rpm" suggests that this is exactly
&gt; the system this was made for, however, installation still does not go
&gt; smoothly.
&gt; When I try to install these packages with
&gt;
&gt; yum install libvirt-client-0.9.4-1.fc14.x86_64.rpm \
&gt; libvirt-0.9.4-1.fc14.x86_64.rpm
&gt;
&gt; , some of the dependencies get resolved automatically, but not all of them,
&gt; and I get these error messages:
&gt;
&gt; Error: Package: libvirt-0.9.4-1.fc14.x86_64 (/libvirt-0.9.4-1.fc14.x86_64)
&gt;             Requires: libblktapctl.so.1.0()(64bit)
&gt; Error: Package: libvirt-client-0.9.4-1.fc14.x86_64 (/libvirt-
&gt; client-0.9.4-1.fc14.x86_64)
&gt;             Requires: libnetcf.so.1(NETCF_1.4.0)(64bit)
&gt; Error: Package: libvirt-0.9.4-1.fc14.x86_64 (/libvirt-0.9.4-1.fc14.x86_64)
&gt;             Requires: libnetcf.so.1(NETCF_1.4.0)(64bit)
&gt;
&gt; Apparently, I need newer versions of netcf-libs and xen-libs. Where do I get
&gt; these from? There don't appear to be any official rpms or that for Fedora
&gt; 14...

libvirt-0.9.4 uses netcf APIs that were added in netcf-0.1.9. I had made 
Fedora 14 and Fedora 15 builds of netcf-0.1.9 last month, but forgot to 
push them to stable (and they weren't autopushed because nobody gave 
them karma). I just did this now, so as long as you have the updates 
repo turned on, sometime later today you should be able to "yum update" 
and get the version of netcf you need to run libvirt-0.9.4.

I'm not sure what the deal is with the version of xen-libs. My F14 box 
(which has updates, updates-testing, and virt-preview repos all enabled) 
has xen-libs-4.0.2, which seems to be new enough to build and install 
the newest libvirt, but it looks like it doesn't have that file (or else 
I'm looking in the wrong place).

</body></email><email><emailId>20110914070905</emailId><senderName>Soeren Grunewald</senderName><senderEmail>soeren.grunewald@avionic-design.de</senderEmail><timestampReceived>2011-09-14 07:09:05-0400</timestampReceived><subject>Re: [libvirt-users] How to install libvirt 0.9.4 RPM on Fedora 14?</subject><body>

Hi,

If i remember correctly you'll also need to update xen-libs and qemu in 
order to use virtio disks. Since libvirt does not correctly passes the 
argument to qemu. Instead of disk=...,if=virtio it passes 
disk=...,if=none. With older versions of qemu (&lt; 0.15.x) this will lead 
to non booting vm's when using virtio.

Regards,
Soeren


On 09/13/2011 06:13 PM, Laine Stump wrote:
&gt; On 09/13/2011 08:53 AM, Guido Winkelmann wrote:
&gt;&gt; Hi,
&gt;&gt;
&gt;&gt; I'm trying to install the newest version of libvirt and libvirt-client from
&gt;&gt; the rpms at ftp://libvirt.org/libvirt/ on a Fedora 14 machine. The naming of
&gt;&gt; the rpms as "libvirt-0.9.4-1.fc14.x86_64.rpm" suggests that this is exactly
&gt;&gt; the system this was made for, however, installation still does not go
&gt;&gt; smoothly.
&gt;&gt; When I try to install these packages with
&gt;&gt;
&gt;&gt; yum install libvirt-client-0.9.4-1.fc14.x86_64.rpm \
&gt;&gt; libvirt-0.9.4-1.fc14.x86_64.rpm
&gt;&gt;
&gt;&gt; , some of the dependencies get resolved automatically, but not all of them,
&gt;&gt; and I get these error messages:
&gt;&gt;
&gt;&gt; Error: Package: libvirt-0.9.4-1.fc14.x86_64 (/libvirt-0.9.4-1.fc14.x86_64)
&gt;&gt;              Requires: libblktapctl.so.1.0()(64bit)
&gt;&gt; Error: Package: libvirt-client-0.9.4-1.fc14.x86_64 (/libvirt-
&gt;&gt; client-0.9.4-1.fc14.x86_64)
&gt;&gt;              Requires: libnetcf.so.1(NETCF_1.4.0)(64bit)
&gt;&gt; Error: Package: libvirt-0.9.4-1.fc14.x86_64 (/libvirt-0.9.4-1.fc14.x86_64)
&gt;&gt;              Requires: libnetcf.so.1(NETCF_1.4.0)(64bit)
&gt;&gt;
&gt;&gt; Apparently, I need newer versions of netcf-libs and xen-libs. Where do I get
&gt;&gt; these from? There don't appear to be any official rpms or that for Fedora
&gt;&gt; 14...
&gt;
&gt; libvirt-0.9.4 uses netcf APIs that were added in netcf-0.1.9. I had made
&gt; Fedora 14 and Fedora 15 builds of netcf-0.1.9 last month, but forgot to
&gt; push them to stable (and they weren't autopushed because nobody gave
&gt; them karma). I just did this now, so as long as you have the updates
&gt; repo turned on, sometime later today you should be able to "yum update"
&gt; and get the version of netcf you need to run libvirt-0.9.4.
&gt;
&gt; I'm not sure what the deal is with the version of xen-libs. My F14 box
&gt; (which has updates, updates-testing, and virt-preview repos all enabled)
&gt; has xen-libs-4.0.2, which seems to be new enough to build and install
&gt; the newest libvirt, but it looks like it doesn't have that file (or else
&gt; I'm looking in the wrong place).
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110912111416</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-09-12 11:14:16-0400</timestampReceived><subject>Re: [libvirt-users] Reg: Difference between chroot &amp; pivot_root</subject><body>

On Tue, Sep 06, 2011 at 01:02:14PM -0400, Alphonse Hansel Anthony wrote:
&gt; Hi,
&gt;    What is the difference between chroot &amp; pivot_root.
&gt;    They don't seem obvious based on the man pages apart from the below
&gt; mentioned
&gt;    caveats.
&gt; 
&gt;    1) Inherited Open file descriptors, have to be explicitly closed.
&gt;    2) Does not change CWD of the process, which can be overcome by doing a
&gt; chdir before &amp; after chroot call.
&gt; 
&gt;    Any information on this would be useful.

I assume you are asking wrt the libvirt LXC driver, which uses pivot_root
instead of chroot() when setting up the guest. The primary reason for this
is that chroot() is escapable, where as pivot_root() is not.

  https://s3hh.wordpress.com/2011/05/31/escaping-chroots/

Regards,
Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110913064125</emailId><senderName>Alphonse Hansel Anthony</senderName><senderEmail>alphonse.anthony@gmail.com</senderEmail><timestampReceived>2011-09-13 06:41:25-0400</timestampReceived><subject>Re: [libvirt-users] Reg: Difference between chroot &amp; pivot_root</subject><body>

Thanks a lot.
This painted a good picture regarding the caveats involved.

-Alphonse

On Mon, Sep 12, 2011 at 7:14 AM, Daniel P. Berrange &lt;berrange@redhat.com&gt;wrote:

&gt; On Tue, Sep 06, 2011 at 01:02:14PM -0400, Alphonse Hansel Anthony wrote:
&gt; &gt; Hi,
&gt; &gt;    What is the difference between chroot &amp; pivot_root.
&gt; &gt;    They don't seem obvious based on the man pages apart from the below
&gt; &gt; mentioned
&gt; &gt;    caveats.
&gt; &gt;
&gt; &gt;    1) Inherited Open file descriptors, have to be explicitly closed.
&gt; &gt;    2) Does not change CWD of the process, which can be overcome by doing
&gt; a
&gt; &gt; chdir before &amp; after chroot call.
&gt; &gt;
&gt; &gt;    Any information on this would be useful.
&gt;
&gt; I assume you are asking wrt the libvirt LXC driver, which uses pivot_root
&gt; instead of chroot() when setting up the guest. The primary reason for this
&gt; is that chroot() is escapable, where as pivot_root() is not.
&gt;
&gt;  https://s3hh.wordpress.com/2011/05/31/escaping-chroots/
&gt;
&gt; Regards,
&gt; Daniel
&gt; --
&gt; |: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/:|
&gt; |: http://libvirt.org              -o-             http://virt-manager.org:|
&gt; |: http://autobuild.org       -o-         http://search.cpan.org/~danberr/:|
&gt; |: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc:|
&gt;

[Attachment #3 (text/html)]

&lt;font color="#666666"&gt;&lt;font size="2"&gt;&lt;font face="verdana,sans-serif"&gt;Thanks a lot. \
&lt;br&gt;This painted a good picture regarding the caveats \
involved.&lt;br&gt;&lt;br&gt;-Alphonse&lt;br&gt;&lt;/font&gt;&lt;/font&gt;&lt;/font&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On \
Mon, Sep 12, 2011 at 7:14 AM, Daniel P. Berrange &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:berrange@redhat.com"&gt;berrange@redhat.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt; \
&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;On Tue, Sep 06, 2011 at \
01:02:14PM -0400, Alphonse Hansel Anthony wrote:&lt;br&gt; &gt; Hi,&lt;br&gt;
&gt;    What is the difference between chroot &amp; pivot_root.&lt;br&gt;
&gt;    They don't seem obvious based on the man pages apart from the below&lt;br&gt;
&gt; mentioned&lt;br&gt;
&gt;    caveats.&lt;br&gt;
&gt;&lt;br&gt;
&gt;    1) Inherited Open file descriptors, have to be explicitly closed.&lt;br&gt;
&gt;    2) Does not change CWD of the process, which can be overcome by doing a&lt;br&gt;
&gt; chdir before &amp; after chroot call.&lt;br&gt;
&gt;&lt;br&gt;
&gt;    Any information on this would be useful.&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;I assume you are asking wrt the libvirt LXC driver, which uses \
pivot_root&lt;br&gt; instead of chroot() when setting up the guest. The primary reason for \
this&lt;br&gt; is that chroot() is escapable, where as pivot_root() is not.&lt;br&gt;
&lt;br&gt;
  &lt;a href="https://s3hh.wordpress.com/2011/05/31/escaping-chroots/" \
target="_blank"&gt;https://s3hh.wordpress.com/2011/05/31/escaping-chroots/&lt;/a&gt;&lt;br&gt; &lt;br&gt;
Regards,&lt;br&gt;
Daniel&lt;br&gt;
&lt;font color="#888888"&gt;--&lt;br&gt;
&gt; &gt; &lt;a href="http://berrange.com" target="_blank"&gt;http://berrange.com&lt;/a&gt;      -o-    \
&gt; &gt; &lt;a href="http://www.flickr.com/photos/dberrange/" \
&gt; &gt; target="_blank"&gt;http://www.flickr.com/photos/dberrange/&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="http://libvirt.org" target="_blank"&gt;http://libvirt.org&lt;/a&gt;              \
&gt; &gt; -o-             &lt;a href="http://virt-manager.org" \
&gt; &gt; target="_blank"&gt;http://virt-manager.org&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="http://autobuild.org" target="_blank"&gt;http://autobuild.org&lt;/a&gt;       -o- \
&gt; &gt; &lt;a href="http://search.cpan.org/%7Edanberr/" \
&gt; &gt; target="_blank"&gt;http://search.cpan.org/~danberr/&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="http://entangle-photo.org" target="_blank"&gt;http://entangle-photo.org&lt;/a&gt; \
&gt; &gt; -o-       &lt;a href="http://live.gnome.org/gtk-vnc" \
&gt; &gt; target="_blank"&gt;http://live.gnome.org/gtk-vnc&lt;/a&gt; :|&lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110913130532</emailId><senderName>Guido Winkelmann</senderName><senderEmail>guido-libvi@unknownsite.de</senderEmail><timestampReceived>2011-09-13 13:05:32-0400</timestampReceived><subject>Re: [libvirt-users] Reg: Difference between chroot &amp; pivot_root</subject><body>

Am Dienstag, 6. September 2011, 19:02:14 schrieb Alphonse Hansel Anthony:
&gt; Hi,
&gt;    What is the difference between chroot &amp; pivot_root.

As far as I know, chroot changes only the effective root for one newly started 
process and all the child processes it will start in the future, leaving all 
other processes unaffected, while pivot_root changes the root for the entire 
system, killing all other processes.

The last time I saw pivot_root in practical use, it was as part of some multi-
staged boot-over-nfs process.

	Guido

</body></email><email><emailId>20110909065223</emailId><senderName>Jiri Denemark</senderName><senderEmail>jdenemar@redhat.com</senderEmail><timestampReceived>2011-09-09 06:52:23-0400</timestampReceived><subject>Re: [libvirt-users] CPU Model detection with virsh capabilities</subject><body>

Hi,

&gt; I wanted to emulate another CPU than the classical qemu32 using virsh. 
&gt; So I used the virsh capabilites command to detect how is detected my CPU 
&gt; host which is an Intel Xeon E5410 and my problem is that this CPU is 
&gt; detected only with the cpumodel "pentium3".

Libvirt detects host CPU feature-wise. It knows several models and features
they provide (look at /usr/share/libvirt/cpu_map.xml) and selects a model that
implements most of the features of host CPU and there are no features in the
model that host CPU doesn't support. The reason why your CPU is not detected
as more advanced model is most likely that your host CPU doesn't support some
features included in such models. Can you send us full copy of the &lt;cpu&gt;
element and its children from virsh capabilities?

You can also learn more about configuring guest CPUs with libvirt at
http://berrange.com/posts/2010/02/15/guest-cpu-model-configuration-in-libvirt-with-qemukvm/

Jirka

</body></email><email><emailId>20110912145439</emailId><senderName>Jiri Denemark</senderName><senderEmail>jdenemar@redhat.com</senderEmail><timestampReceived>2011-09-12 14:54:39-0400</timestampReceived><subject>Re: [libvirt-users] CPU Model detection with virsh capabilities</subject><body>

On Mon, Sep 12, 2011 at 16:33:53 +0200, Olivier BONHOMME wrote:
&gt; Hello,
&gt; 
&gt; Thanks for your answer. My virsh capabilities is the following :
&gt; 
&gt;      &lt;cpu&gt;
&gt;        &lt;arch&gt;x86_64&lt;/arch&gt;
&gt;        &lt;model&gt;pentium3&lt;/model&gt;
&gt;        &lt;vendor&gt;Intel&lt;/vendor&gt;
&gt;        &lt;topology sockets='1' cores='4' threads='1'/&gt;
&gt;        &lt;feature name='lahf_lm'/&gt;
&gt;        &lt;feature name='lm'/&gt;
&gt;        &lt;feature name='syscall'/&gt;
&gt;        &lt;feature name='sse4.1'/&gt;
&gt;        &lt;feature name='dca'/&gt;
&gt;        &lt;feature name='xtpr'/&gt;
&gt;        &lt;feature name='cx16'/&gt;
&gt;        &lt;feature name='ssse3'/&gt;
&gt;        &lt;feature name='tm2'/&gt;
&gt;        &lt;feature name='est'/&gt;
&gt;        &lt;feature name='vmx'/&gt;
&gt;        &lt;feature name='ds_cpl'/&gt;
&gt;        &lt;feature name='monitor'/&gt;
&gt;        &lt;feature name='pni'/&gt;
&gt;        &lt;feature name='pbe'/&gt;
&gt;        &lt;feature name='tm'/&gt;
&gt;        &lt;feature name='ht'/&gt;
&gt;        &lt;feature name='ss'/&gt;
&gt;        &lt;feature name='sse2'/&gt;
&gt;        &lt;feature name='acpi'/&gt;
&gt;        &lt;feature name='ds'/&gt;
&gt;        &lt;feature name='clflush'/&gt;
&gt;        &lt;feature name='apic'/&gt;
&gt;      &lt;/cpu&gt;
&gt; 
&gt; About what you say, I totally agree. It's just I am very surprised that 
&gt; an Intel Xeon E5430 is detected just as a pentium3

That's because your CPU doesn't support nx feature, which is included in all
models better than pentium3.

Jirka

</body></email><email><emailId>20110912150606</emailId><senderName>Olivier BONHOMME</senderName><senderEmail>obonhomme@nerim.net</senderEmail><timestampReceived>2011-09-12 15:06:06-0400</timestampReceived><subject>Re: [libvirt-users] CPU Model detection with virsh capabilities</subject><body>

Le 12/09/2011 16:54, Jiri Denemark a écrit :
&gt;
&gt; That's because your CPU doesn't support nx feature, which is included in all
&gt; models better than pentium3.
&gt;
&gt; Jirka

Is NX, the NX bit feature ? In that case, I am going to check in the 
bios if it is just not enabled. Because, normally, this CPU should 
support it.

Regards,
Olivier BONHOMME

</body></email><email><emailId>20110912151238</emailId><senderName>Jiri Denemark</senderName><senderEmail>jdenemar@redhat.com</senderEmail><timestampReceived>2011-09-12 15:12:38-0400</timestampReceived><subject>Re: [libvirt-users] CPU Model detection with virsh capabilities</subject><body>

On Mon, Sep 12, 2011 at 17:06:06 +0200, Olivier BONHOMME wrote:
&gt; Le 12/09/2011 16:54, Jiri Denemark a écrit :
&gt; &gt;
&gt; &gt; That's because your CPU doesn't support nx feature, which is included in all
&gt; &gt; models better than pentium3.
&gt; &gt;
&gt; &gt; Jirka
&gt; 
&gt; Is NX, the NX bit feature ?
I think so.

&gt; In that case, I am going to check in the bios if it is just not enabled.
&gt; Because, normally, this CPU should support it.

That might be it.

Jirka

</body></email><email><emailId>20110912173333</emailId><senderName>KB</senderName><senderEmail>kberger65@gmail.com</senderEmail><timestampReceived>2011-09-12 17:33:33-0400</timestampReceived><subject>[libvirt-users] Updating librvirt on the STD Distros</subject><body>

All,

This is my first time posting, I apologize in advance if it is too
much of a "newbie" question  I am working on a project with libvirt
and want to use some of the features in the 0.9.4 release.  The first
platform I wanted to test this on is RHEL 5.7.  I have d/l libvirt and
compiled but have the following questions


1)  RHEL 5.7 ships with libvirt version, 0.8.2-22. I am guessing that
I can not simple overwrite the existing files with the files from
0.9.4.  Is there a way to upgrade to 0.9.4? Do I need to build an rpm
so that the version is properly reported in the rpm db?  I am also
guessing some of the other packages the rely on libvirt may no longer
work.  In addition, I would imagine RH does not support doing this.

To summarize, can the lbivrit on RHEL be upgraded and if so does
anyone have any info they can point me to?

2) If there is not a way to update RHEL, is there a different distro
CentOS, Ubuntu, Fedora that is a better choice to test my project on?

3)  I am also guessing if my project is using API's that are not in
0.8.2-22 but are in 0.9.4., I will not be able to connect remotely to
the RHEL server and have them pull the data correctly. For example, I
want to use virDomainGetMemoryParameters.

Thanks in advance.

Keith

</body></email><email><emailId>20110913055357</emailId><senderName>Wayne Xia</senderName><senderEmail>xiawenc@linux.vnet.ibm.com</senderEmail><timestampReceived>2011-09-13 05:53:57-0400</timestampReceived><subject>Re: [libvirt-users] Fwd: Re: [libvirt] how did libvirt manage Virtual Network?</subject><body>

Thank u very much, it helps a lot.


于 2011-9-13 10:22, Lei Li 写道:
&gt;
&gt;
&gt; -------- Original Message --------
&gt; Subject: 	Re: [libvirt] how did libvirt manage Virtual Network?
&gt; Date: 	Fri, 09 Sep 2011 12:28:38 -0400
&gt; From: 	Laine Stump &lt;laine@laine.org&gt; &lt;mailto:laine@laine.org&gt;
&gt; To: 	libvirt-users@redhat.com &lt;mailto:libvirt-users@redhat.com&gt;
&gt; CC: 	libvir-list@redhat.com &lt;mailto:libvir-list@redhat.com&gt;
&gt;
&gt;
&gt;
&gt; (This seems more appropriate for the libvirt-users mailing list)
&gt;
&gt; On 09/08/2011 10:16 PM, Wayne Xia wrote:
&gt;&gt;      Working at the network management, I am a bit confused about the
&gt;&gt;  VLAN model in libvirt.
&gt;&gt;
&gt;&gt;      in the xml definition, there is a section as following:
&gt;&gt;
&gt;&gt;  &lt;devices&gt;
&gt;&gt;  &lt;interface type='network'&gt;
&gt;&gt;  &lt;source network='default'/&gt;
&gt;&gt;  &lt;/interface&gt;
&gt;&gt;      ...
&gt;&gt;  &lt;interface type='network'&gt;
&gt;&gt;  &lt;source network='default'  portgroup='engineering'/&gt;
&gt;&gt;  &lt;target dev='vnet7'/&gt;
&gt;&gt;  &lt;mac address="00:11:22:33:44:55"/&gt;
&gt;&gt;  &lt;virtualport type='802.1Qbg'&gt;
&gt;&gt;  &lt;parameters managerid='11'  typeid='1193047'  typeidversion='2'
&gt;&gt;  instanceid='09b11c53-8b5c-4eeb-8f00-d84eaa0aaa4f'/&gt;
&gt;&gt;  &lt;/virtualport&gt;
&gt;&gt;
&gt;&gt;  &lt;/interface&gt;
&gt;&gt;  &lt;/devices&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;      What is the really meaning of its related parameters of
&gt;&gt;  "virtualport"? I want to discover informations such as VLAN id,
&gt;&gt;  the switch type( software switch or hardware switch), connecting
&gt;&gt;  relationship, but from the xml I can only found"managerid". I am not
&gt;&gt;  sure how to map these xml information to those I needed, could I
&gt;&gt;  consider managerid as VLAN id, and a portgroup as a specified VLAN group?
&gt;&gt;      By the way to use virtualport, what components should I install on
&gt;&gt;  Linux?
&gt;
&gt; &lt;virtualport&gt;  is used only when configuring guests that connect directly
&gt; to a VEPA or VNLINK (i.e. 802.1Q) capable switch. Unless you have one of
&gt; these switches, you will not use it. If you do have one of these
&gt; switches, you will also have information included with them that
&gt; explains the meaning of the virtualport parameters and how they are used
&gt; (they're opaque to libvirt - it just passes them on to the switch
&gt; without assigning any meaning to them).
&gt;
&gt; portgroup is a tag used to select certain bits of config out of
&gt; &lt;portgroup&gt;  sections in the&lt;network&gt;  definition being used for the
&gt; interface. Currently the things that can be configured in the
&gt; &lt;portgroup&gt;  sections are 1)&lt;bandwidth&gt;  info, and 2)&lt;virtualport&gt;
&gt; parameters. Again, it has nothing to do with VLAN groups.&lt;portgroup&gt;  is
&gt; very new, btw - it has only been in libvirt since 0.9.4, so if you're
&gt; using an older version don't expect it to do anything.
&gt;
&gt; Down to the real basic question of which VLAN a particular guest is
&gt; using - that can either be determined by the guest itself, or if the
&gt; guest has no VLAN id setting, it could be determined by the
&gt; switch/bridge the guest is connected to; in other words, wherever it is
&gt; done, it's outside of libvirt (well, I guess if your platform has
&gt; support for the iface-* commands, you could define a bridge that uses a
&gt; vlan interface as its connection to the physical network - then traffic
&gt; from any guest connected to that bridge would end up going onto the
&gt; physical network with the given vlan id).
&gt;
&gt; --
&gt; libvir-list mailing list
&gt; libvir-list@redhat.com  &lt;mailto:libvir-list@redhat.com&gt;
&gt; https://www.redhat.com/mailman/listinfo/libvir-list
&gt;


-- 
Best Regards

Wayne Xia
mail:xiawenc@linux.vnet.ibm.com
tel:86-010-82450803

</body></email><email><emailId>20110913063940</emailId><senderName>Alphonse Hansel Anthony</senderName><senderEmail>alphonse.anthony@gmail.com</senderEmail><timestampReceived>2011-09-13 06:39:40-0400</timestampReceived><subject>[libvirt-users] Reg: VETH Device pair creation using iproute2.</subject><body>

Hi,

   While using libvirt to start a LXC, I am facing an error related to
NETNS,
   specifically related to the VETH device pair creation. The code related
to this is
   present in libvirt/src/lxc/veth.c

   # ip link add veth0 type veth peer name veth1
   Garbage instead of arguments "peer ...". Try "ip link help".
   # ip -V
   ip utility, iproute2-ss110629
   # uname -r
   2.6.32.39
   #

   The devices "veth0" &amp; "veth1" does not exist in /sys/class/net/
   But the same command works with iproute2-ss100519 (older version).
   Is this a known issue in the latest version or am I doing something
wrong?

   Any info in this regard would be useful.

-Alphonse

[Attachment #3 (text/html)]

&lt;font color="#666666"&gt;&lt;font size="2"&gt;&lt;font face="verdana,sans-serif"&gt;&lt;span \
style="color: rgb(0, 0, 0);"&gt;Hi,&lt;/span&gt;&lt;br style="color: rgb(0, 0, 0);"&gt;&lt;br \
style="color: rgb(0, 0, 0);"&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;   While using \
libvirt to start a LXC, I am facing an error related to NETNS, &lt;/span&gt;&lt;br \
style="color: rgb(0, 0, 0);"&gt; &lt;span style="color: rgb(0, 0, 0);"&gt;   specifically \
related to the VETH device pair creation. The code related to this is &lt;br&gt;   present \
in libvirt/src/lxc/veth.c&lt;br style="color: rgb(0, 0, 0);"&gt;&lt;/span&gt;&lt;br style="color: \
rgb(0, 0, 0);"&gt; &lt;span style="font-family: courier new,monospace; color: rgb(0, 0, \
0);"&gt;   # ip link add veth0 type veth peer name veth1&lt;/span&gt;&lt;br style="font-family: \
courier new,monospace; color: rgb(0, 0, 0);"&gt;&lt;span style="font-family: courier \
new,monospace; color: rgb(0, 0, 0);"&gt;   Garbage instead of arguments "peer \
...". Try "ip link help".&lt;/span&gt;&lt;br style="font-family: courier \
new,monospace; color: rgb(0, 0, 0);"&gt; &lt;span style="font-family: courier \
new,monospace; color: rgb(0, 0, 0);"&gt;   # ip -V&lt;/span&gt;&lt;br style="font-family: courier \
new,monospace; color: rgb(0, 0, 0);"&gt;&lt;span style="font-family: courier new,monospace; \
color: rgb(0, 0, 0);"&gt;   ip utility, iproute2-ss110629&lt;/span&gt;&lt;br style="font-family: \
courier new,monospace; color: rgb(0, 0, 0);"&gt; &lt;span style="font-family: courier \
new,monospace; color: rgb(0, 0, 0);"&gt;   # uname -r&lt;br&gt;   2.6.32.39&lt;br&gt;   #&lt;br \
style="font-family: courier new,monospace; color: rgb(0, 0, 0);"&gt;&lt;/span&gt;&lt;span \
style="color: rgb(0, 0, 0);"&gt;   &lt;br&gt;  The devices "veth0" &amp; \
"veth1" does not exist in /sys/class/net/&lt;br style="color: rgb(0, 0, \
0);"&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;   But the same command works with \
iproute2-ss100519 (older version). &lt;/span&gt;&lt;br style="color: rgb(0, 0, 0);"&gt; &lt;span \
style="color: rgb(0, 0, 0);"&gt;   Is this a known issue in the latest version or am I \
doing something wrong?&lt;/span&gt;&lt;br style="color: rgb(0, 0, 0);"&gt;&lt;br style="color: \
rgb(0, 0, 0);"&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;   Any info in this regard would be \
useful.&lt;/span&gt;&lt;br style="color: rgb(0, 0, 0);"&gt; &lt;br style="color: rgb(0, 0, \
0);"&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;-Alphonse&lt;/span&gt;&lt;br&gt;&lt;/font&gt;&lt;/font&gt;&lt;/font&gt;



</body></email><email><emailId>20110913131145</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-09-13 13:11:45-0400</timestampReceived><subject>Re: [libvirt-users] Reg: Difference between chroot &amp; pivot_root</subject><body>

On Tue, Sep 13, 2011 at 03:05:32PM +0200, Guido Winkelmann wrote:
&gt; Am Dienstag, 6. September 2011, 19:02:14 schrieb Alphonse Hansel Anthony:
&gt; &gt; Hi,
&gt; &gt;    What is the difference between chroot &amp; pivot_root.
&gt; 
&gt; As far as I know, chroot changes only the effective root for one newly started 
&gt; process and all the child processes it will start in the future, leaving all 
&gt; other processes unaffected, while pivot_root changes the root for the entire 
&gt; system, killing all other processes.

In the context of LXC, the pivot_root is done after switching into a
private filesystem namespace (CLONE_NEWNS), so only the process doing
the pivot and its children are affected, not the system as a whole.

Regards,
Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110913215342</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-09-13 21:53:42-0400</timestampReceived><subject>Re: [libvirt-users] cpu time totals</subject><body>

On 09/13/2011 03:46 PM, Igor Serebryany wrote:
&gt; Hi!
&gt;
&gt; 	I'm comparing the cpu usage of a VM from virDomainGetInfo and the
&gt; 	usages returned per-vcpu from virDomainGetVcpus and the totals do
&gt; 	not match up.
&gt;
&gt; 	I expect that the cpu usages reported per-vcpu, when summed, should
&gt; 	equal the total cpu usage of the domain, but there is quite a large
&gt; 	gap between them. Is there something I'm missing?

Yes - emulation overhead.  That is, there is some work done by the 
hypervisor process itself but not directly attributable to any of the 
work done by the vcpus visible in the guest.  For example, in qemu, the 
time spent in opening qcow2 files counts against the overall domain 
time, but not towards any of the vcpu times.

&gt; 	Why is this additional 91 seconds not reflected in time spent by the
&gt; 	vcpus? What exactly is the meaning of the cpuTime parameter of the
&gt; 	virVcpuInfo struct?

How much total time has been occupied by the overall hypervisor instance 
running the domain, which is probably larger than the amount of vcpu 
time racked up from the child's point of view.  The smaller the 
overhead, the more efficient the virtualization.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20110914080342</emailId><senderName>Frank Hauptle</senderName><senderEmail>franki@biz.uwa.edu.au</senderEmail><timestampReceived>2011-09-14 08:03:42-0400</timestampReceived><subject>[libvirt-users] using virsh (or something) to convert from KVM domain XML to vmx...</subject><body>

HI folks,


For reasons I'd rather not go into (not my choice) we are moving our 
current virtual servers at the uni here, (using KVM and libvirt) to 
outsourced vmware ESX and vcenter.



I really don't want to use the Vcenter Converter to create running esx 
vm's from within the KVM VM's as I feel that doing it within the client 
VM is inefficient and slow.  Thus far however,  I've not found anything 
that gives me any other alternatives.

I thought perhaps the domxml-to-native virsh function demo'd at 
http://libvirt.org/drvesx.html#xmlexport would be the go, but that 
appears to be just a way to change from libvirt managed esx to native vmx.

Converting the KVM raw img files to vmdk has been easy, converting the 
KVM  domain XML to vmx appears to be impossible unless you do it by hand.


Have I missed some cool/feature that would do this?


Apologies if I'm going about this all wrong, What I know about vmware, I 
could write on the head of a pin with a felt tip pen..


kindest regards

Frank
UWA







</body></email><email><emailId>20110914121854</emailId><senderName>Guido Winkelmann</senderName><senderEmail>guido-libvi@unknownsite.de</senderEmail><timestampReceived>2011-09-14 12:18:54-0400</timestampReceived><subject>Re: [libvirt-users] How to install libvirt 0.9.4 RPM on Fedora 14?</subject><body>

Am Dienstag, 13. September 2011, 18:13:41 schrieb Laine Stump:
&gt; On 09/13/2011 08:53 AM, Guido Winkelmann wrote:
[...]
&gt; &gt; Apparently, I need newer versions of netcf-libs and xen-libs. Where do I
&gt; &gt; get these from? There don't appear to be any official rpms or that for
&gt; &gt; Fedora 14...
&gt; 
&gt; libvirt-0.9.4 uses netcf APIs that were added in netcf-0.1.9. I had made
&gt; Fedora 14 and Fedora 15 builds of netcf-0.1.9 last month, but forgot to
&gt; push them to stable (and they weren't autopushed because nobody gave
&gt; them karma). I just did this now, so as long as you have the updates
&gt; repo turned on, sometime later today you should be able to "yum update"
&gt; and get the version of netcf you need to run libvirt-0.9.4.

Nothing so far...

&gt; I'm not sure what the deal is with the version of xen-libs. My F14 box
&gt; (which has updates, updates-testing, and virt-preview repos all enabled)
&gt; has xen-libs-4.0.2, which seems to be new enough to build and install
&gt; the newest libvirt, but it looks like it doesn't have that file (or else
&gt; I'm looking in the wrong place).

Same here, xen-libs 4.0.2 is installed, but no libblktapctl.so.* can be found 
anywhere.

A bit of googling suggests that the only way to get that library is through 
xen-libs packages versioned 4.1.0 or up.

Maybe libvirt's configure script dynamically detects the presence of that 
library and only links to it if it's there? That would explain why it's 
possible to build libvirt from source on Fedora 14, but not install 
corresponding RPMs, if those have been built with that library present on the 
build system for some reason.

	Guido

</body></email><email><emailId>20110914225210</emailId><senderName>Trey Dockendorf</senderName><senderEmail>treydock@gmail.com</senderEmail><timestampReceived>2011-09-14 22:52:10-0400</timestampReceived><subject>Re: [libvirt-users] Libvirt daemon usage question</subject><body>

On Sep 14, 2011 5:13 PM, "Eric Blake" &lt;eblake@redhat.com&gt; wrote:
&gt;
&gt; [let's keep the list in the loop]
&gt;
&gt;
&gt; On 09/14/2011 04:07 PM, Trey Dockendorf wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; Given your original qeustion, if your management apps really do require
&gt;&gt;
&gt;&gt; 0.8.8 APIs, then you'll need to upgrade libvirtd on your CentOS host to
be
&gt;&gt; at least 0.8.8 in order to honor your management app requests, or else
&gt;&gt; modify your management app to gracefully implement fallbacks to older API
&gt;&gt; approaches that were available in 0.8.1.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt; How risky is it to implement a newer version of libvirt in something like
&gt;&gt; centos?  I figure based on the huge number of dependencies that its not
&gt;&gt; something to safely do.  So far we building my libvirt rpms Ive only used
&gt;&gt; the same source for the version with centos and the libvirt specs
provided
&gt;&gt; in the fedora src rpms.  Do the specs know to check for specific versions
of
&gt;&gt; dependencies?
&gt;
&gt;
&gt; There's not that many source dependencies for building a newer libvirt
out-of-the-box on top of CentOS.  You might also find
https://fedoraproject.org/wiki/Virtualization_Preview_Repository as a useful
example for the amount of effort involved in running newer virt tools on top
of an otherwise stable repository.  Also, search the list archives; the
topic of installing the latest libvirt on CentOS or RHEL 5 has come up
several times recently, with various tidbits of good advice.
&gt;
&gt;
&gt; --
&gt; Eric Blake   eblake@redhat.com    +1-801-349-2682
&gt; Libvirt virtualization library http://libvirt.org

Ah sorry, didnt mean to send off list.  First time replying from my phone.

Ill check that out, thanks.  Ive seen that repo and will hopefully be able
to get a test system together.  What should I look out for when attempting
an upgrade from the CentOS release( 0.8.1)?  My worry is it will look like
everything works while testing and I wont find the bugs in this idea until I
move it to my production server.

Thanks
- Trey

[Attachment #3 (text/html)]

&lt;p&gt;&lt;br&gt;
On Sep 14, 2011 5:13 PM, "Eric Blake" &lt;&lt;a \
href="mailto:eblake@redhat.com"&gt;eblake@redhat.com&lt;/a&gt;&gt; wrote:&lt;br&gt; &gt;&lt;br&gt;
&gt; [let's keep the list in the loop]&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt; On 09/14/2011 04:07 PM, Trey Dockendorf wrote:&lt;br&gt;
&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt; Given your original qeustion, if your management apps really do \
require&lt;br&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; 0.8.8 APIs, then you'll need to upgrade libvirtd on your CentOS host to \
be&lt;br&gt; &gt;&gt; at least 0.8.8 in order to honor your management app requests, or \
else&lt;br&gt; &gt;&gt; modify your management app to gracefully implement fallbacks to \
older API&lt;br&gt; &gt;&gt; approaches that were available in 0.8.1.&lt;br&gt;
&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; How risky is it to implement a newer version of libvirt in something \
like&lt;br&gt; &gt;&gt; centos?  I figure based on the huge number of dependencies that its \
not&lt;br&gt; &gt;&gt; something to safely do.  So far we building my libvirt rpms Ive only \
used&lt;br&gt; &gt;&gt; the same source for the version with centos and the libvirt specs \
provided&lt;br&gt; &gt;&gt; in the fedora src rpms.  Do the specs know to check for \
specific versions of&lt;br&gt; &gt;&gt; dependencies?&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt; There's not that many source dependencies for building a newer libvirt \
out-of-the-box on top of CentOS.  You might also find &lt;a \
href="https://fedoraproject.org/wiki/Virtualization_Preview_Repository"&gt;https://fedoraproject.org/wiki/Virtualization_Preview_Repository&lt;/a&gt; \
as a useful example for the amount of effort involved in running newer virt tools on \
top of an otherwise stable repository.  Also, search the list archives; the topic of \
installing the latest libvirt on CentOS or RHEL 5 has come up several times recently, \
with various tidbits of good advice.&lt;br&gt;

&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt; -- &lt;br&gt;
&gt; Eric Blake   &lt;a href="mailto:eblake@redhat.com"&gt;eblake@redhat.com&lt;/a&gt;    \
+1-801-349-2682&lt;br&gt; &gt; Libvirt virtualization library &lt;a \
href="http://libvirt.org"&gt;http://libvirt.org&lt;/a&gt;&lt;/p&gt; &lt;p&gt;Ah sorry, didnt mean to send \
off list.  First time replying from my phone.&lt;/p&gt; &lt;p&gt;Ill check that out, thanks.  Ive \
seen that repo and will hopefully be able to get a test system together.  What should \
I look out for when attempting an upgrade from the CentOS release( 0.8.1)?  My worry \
is it will look like everything works while testing and I wont find the bugs in this \
idea until I move it to my production server.&lt;/p&gt;

&lt;p&gt;Thanks&lt;br&gt;
- Trey&lt;/p&gt;



</body></email><email><emailId>20110915074954</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-09-15 07:49:54-0400</timestampReceived><subject>Re: [libvirt-users] Config Errro when Creating a virtual device attachment to backend</subject><body>

? 2011?09?15? 15:30, huachao yao ??:
&gt; Hi, buddy,
&gt; I want to create a virtual device attachment to backend.
&gt; The domain is running, and my code  phase is as below:
&gt;
&gt; xmlConfiguration    = "&lt;devices&gt;&lt;sound model='es1370'/&gt;&lt;/devices&gt;";
&gt; virDomainAttachDevice(dom,xmlConfiguration);

Try with &lt;devices&gt; tag removed.

&gt;
&gt; But the exception "libvir: Domain Config error : XML error: unknown 
&gt; device type " happen when running.
&gt; Is it something wrong in the XML configuration? What should i do to 
&gt; deal with such Config error ?
&gt;
&gt; ps: the hypervisor is KVM.
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users


[Attachment #3 (text/html)]

&lt;html&gt;
  &lt;head&gt;
    &lt;meta content="text/html; charset=ISO-8859-1"
      http-equiv="Content-Type"&gt;
  &lt;/head&gt;
  &lt;body text="#000000" bgcolor="#FFFFFF"&gt;
    于 2011年09月15日 15:30, huachao yao 写道:
    &lt;blockquote
cite="mid:CABK2uVuC6o5NHcGAM9_3CgCQxfOAMENcwMY+qKLvbjY6RgAKwg@mail.gmail.com"
      type="cite"&gt;Hi, buddy,&lt;br&gt;
      I want to create a virtual device attachment to backend.&lt;br&gt;
      The domain is running, and my code  phase is as below:&lt;br&gt;
      &lt;br&gt;
      &lt;font size="4"&gt;&lt;span style="color: rgb(0, 0, \
0);"&gt;xmlConfiguration     = "&lt;devices&gt;&lt;sound
          model='es1370'/&gt;&lt;/devices&gt;";&lt;/span&gt;&lt;br style="color:
          rgb(0, 0, 0);"&gt;
        &lt;span style="color: rgb(0, 0, \
0);"&gt;virDomainAttachDevice(dom,xmlConfiguration);&lt;/span&gt;&lt;/font&gt;&lt;br&gt;  &lt;/blockquote&gt;
    &lt;br&gt;
    Try with &lt;devices&gt; tag removed. &lt;br&gt;
    &lt;br&gt;
    &lt;blockquote
cite="mid:CABK2uVuC6o5NHcGAM9_3CgCQxfOAMENcwMY+qKLvbjY6RgAKwg@mail.gmail.com"
      type="cite"&gt;&lt;br&gt;
      But the exception &lt;span style="color: rgb(204, 0, 0);"&gt;"libvir:
        Domain Config error : XML error: unknown device type "&lt;/span&gt;
      happen when running.&lt;br&gt;
      Is it something wrong in the XML configuration? What should i do
      to deal with such &lt;span style="color: rgb(204, 0, 0);"&gt;Config
        error &lt;span style="color: rgb(0, 0, 0);"&gt;?&lt;br&gt;
          &lt;br&gt;
          ps: the hypervisor is KVM.&lt;br&gt;
        &lt;/span&gt;&lt;/span&gt;
      &lt;br&gt;
      &lt;fieldset class="mimeAttachmentHeader"&gt;&lt;/fieldset&gt;
      &lt;br&gt;
      &lt;pre wrap=""&gt;_______________________________________________
libvirt-users mailing list
&lt;a class="moz-txt-link-abbreviated" \
href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt; &lt;a \
class="moz-txt-link-freetext" \
href="https://www.redhat.com/mailman/listinfo/libvirt-users"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;/pre&gt;
  &lt;/blockquote&gt;
    &lt;br&gt;
  &lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20110919143506</emailId><senderName>Guido Winkelmann</senderName><senderEmail>guido-libvi@unknownsite.de</senderEmail><timestampReceived>2011-09-19 14:35:06-0400</timestampReceived><subject>Re: [libvirt-users] libvirt does not recognize all devices in iscsi and mpath pools in a predictable</subject><body>

Am Dienstag, 13. September 2011, 17:39:16 schrieben Sie:
&gt; On Tue, Sep 13, 2011 at 05:17:54PM +0200, Guido Winkelmann wrote:
[...]
&gt; &gt; I chose &lt;path&gt;/dev/disk/by-id&lt;/path&gt; over /dev/disk/by-path for the iscsi
&gt; &gt; pool because I need to be able to migrate running virtual machines to
&gt; &gt; other hosts, so the actual device paths for the disks need to be the
&gt; &gt; same on all hosts in the cluster.
&gt; 
&gt; /dev/disk/by-path should be the same across all hosts too, at least for
&gt; iSCSI, but perhaps not FibreChannel - depending on the udev naming scheme.

Not in my case. The by-path device names contain the ip address of the iSCSI 
array, and in my case, two host machines access the array via different IP 
addresses...
Granted, that's only a test setup and the planned production setup won't have 
that problem, but still, there is no guarantee that the by-path are always the 
same across all hosts.

Also, if the used iSCSI array can be accessed via multiple different IP 
addresses, each volume will be listed multiple times under by-path.
 
[...]
&gt; &gt; Both LUNs do appear under both naming schemes under /dev/disk/by-id:
&gt; &gt; 
&gt; &gt; ls /dev/disk/by-id/
&gt; &gt; [...]
&gt; &gt; scsi-36782bcb0000859f3000007004e680190
&gt; &gt; [...]
&gt; &gt; scsi-36782bcb0000859f3000007294e6e73f2
&gt; &gt; scsi-36a4badb00b0f910012e0fccb07606fe6
&gt; &gt; [...]
&gt; &gt; wwn-0x6782bcb0000859f3000007004e680190
&gt; &gt; [...]
&gt; &gt; wwn-0x6782bcb0000859f3000007294e6e73f2
&gt; &gt; wwn-0x6a4badb00b0f910012e0fccb07606fe6
&gt; &gt; [...]
&gt; &gt; 
&gt; &gt; (snipped some irrelevant parts)
&gt; 
&gt; This is the problem. Our code is assuming that /dev/disk/by-id contains
&gt; only 1 symlink per disk. For some reason your udev rules are creating
&gt; multiple symlinks per disk, and hence breaking libvirt.

Well, I did not change anything in the udev rules. They're the defaults from 
Fedora 14...
 
&gt; We iterate over the entries in /dev/disk/by-id, so we get them back in
&gt; whatever order the filesystem feels like today. What we need todo is
&gt; to read all the matches for that disk, sort the results, and then
&gt; pick the first result.
&gt; 
&gt; Or, we might want to make it possible to specify a target path of
&gt; 
&gt;   /dev/disk/by-id/www-*
&gt; 
&gt; so that you can choose which naming scheme to use.

The last one sounds like a good idea to me. I'm still trying to figure out 
where the extra "3" comes from in front of the world-wide id in the scsi- 
naming scheming or in that of the multipathd...

One thing I've noticed in the meantime is that, if I know the device node 
exists on the host, I can just give it as the pathname when defining a new 
virtual machine, even if libvirt won't show that volume in vol-list, or won't 
show it under that name, and it'll just work.
While that solves my problem, it means I'm now working entirely around 
libvirt's storage subsystem. I might as well not even bother defining any 
pools any more... :-(

Regards,

        Guido

PS: I'm sorry, this mail was supposed to go the mailing list, not to Daniel 
personally...

</body></email><email><emailId>20110919230528</emailId><senderName>Trey Dockendorf</senderName><senderEmail>treydock@gmail.com</senderEmail><timestampReceived>2011-09-19 23:05:28-0400</timestampReceived><subject>[libvirt-users] Remote connect using virsh qemu+ssh hangs / PolicyKit issue</subject><body>

I'm attempting to remote connect to my KVM instance using virsh, but all the
commands hang.

When issuing the below command, nothing on the remote system happens, and no
errors are displayed, (hostname changed)
$ virsh --debug 5 --log /var/lib/foreman/virsh.log -c
qemu+ssh://foreman@kvmhost.tld:16509/system?no_tty=1

This is the uncommented lines in /etc/libvirt/libvirtd.conf
----------

listen_tls = 0
listen_tcp = 1
listen_addr = "&lt;omitted, set to management NIC&gt;"
log_level = 1
log_filters="1:remote 1:event 1:qemu"
log_outputs="1:syslog:libvirtd 1:file:/var/log/libvirt/libvirtd.log"


This is the only debug output I get in /var/log/libvirt/libvirtd.log during
the remote connection attempt
-----------
17:56:04.579: debug : virEventRunOnce:595 : Poll got 1 event
17:56:04.580: debug : virEventDispatchTimeouts:405 : Dispatch 3
17:56:04.580: debug : virEventDispatchHandles:450 : Dispatch 10
17:56:04.580: debug : virEventDispatchHandles:464 : i=0 w=1
17:56:04.580: debug : virEventDispatchHandles:464 : i=1 w=2
17:56:04.580: debug : virEventDispatchHandles:464 : i=2 w=3
17:56:04.580: debug : virEventDispatchHandles:464 : i=3 w=4
17:56:04.580: debug : virEventDispatchHandles:464 : i=4 w=5
17:56:04.580: debug : virEventDispatchHandles:464 : i=5 w=6
17:56:04.580: debug : virEventDispatchHandles:464 : i=6 w=7
17:56:04.580: debug : virEventDispatchHandles:464 : i=7 w=8
17:56:04.580: debug : virEventDispatchHandles:477 : Dispatch n=7 f w=8
e=1 0x1629640
17:56:04.580: debug : virEventAddHandleImpl:113 : Add handle fd  events=1
cb=0x4196e0 opaque=0x1629640
17:56:04.580: debug : virEventInterruptLocked:664 : Skip interrupt, 1
-1447459072
17:56:04.580: debug : virEventDispatchHandles:464 : i=8 w=9
17:56:04.580: debug : virEventDispatchHandles:464 : i=9 w
17:56:04.580: debug : virEventCleanupTimeouts:495 : Cleanup 3
17:56:04.580: debug : virEventCleanupHandles:536 : Cleanupo 11
17:56:04.580: debug : virEventCleanupTimeouts:495 : Cleanup 3
17:56:04.580: debug : virEventCleanupHandles:536 : Cleanupo 11
17:56:04.580: debug : virEventMakePollFDs:373 : Prepare n=0 w=1, f=5 e=1
17:56:04.580: debug : virEventMakePollFDs:373 : Prepare n=1 w=2, f=7 e=1
17:56:04.580: debug : virEventMakePollFDs:373 : Prepare n=2 w=3, f e=1
17:56:04.580: debug : virEventMakePollFDs:373 : Prepare n=3 w=4, f e=1
17:56:04.580: debug : virEventMakePollFDs:373 : Prepare n=4 w=5, f e%
17:56:04.580: debug : virEventMakePollFDs:373 : Prepare n=5 w=6, f e%
17:56:04.580: debug : virEventMakePollFDs:373 : Prepare n=6 w=7, f e%
17:56:04.580: debug : virEventMakePollFDs:373 : Prepare n=7 w=8, f e%
17:56:04.580: debug : virEventMakePollFDs:373 : Prepare n=8 w=9, f e%
17:56:04.580: debug : virEventMakePollFDs:373 : Prepare n=9 w, f e%
17:56:04.580: debug : virEventMakePollFDs:373 : Prepare n w, f  e=1
17:56:04.580: debug : virEventCalculateTimeout:314 : Calculate expiry of 3
timers
17:56:04.580: debug : virEventCalculateTimeout:344 : Timeout at 0 due in -1
ms
17:56:04.580: debug : virEventRunOnce:593 : Poll on 11 handles
0x7f35a4001240 timeout -1


I've already opened up the firewall for port 16509, and allowed the user
foreman (member of libvirt_admin) to manage libvirt via PolicyKit
Relevant line in iptables,
5    ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0           tcp
dpt:16509

/etc/polkit-1/localauthority/50-local.d/50-libvirt-remote-access.pkla
-----------
[libvirt Remote Access]
Identity=unix-group:libvirt_admin
Action=org.libvirt.unix.manage
ResultAny=yes
ResultInactive=yes
ResultActive=yes


Originally I had created the
file /etc/polkit-1/localauthority/50-local.d/51-libvirt-foreman-remote-access.pkla
with contents below, and had the file 50-libvirt-remote-access.pkla only
allowing a single user.
/etc/polkit-1/localauthority/50-local.d/51-libvirt-foreman-remote-access.pkla
----------
[libvirt Foreman Remote Access]
Identity=unix-user:foreman
Action=org.libvirt.unix.manage
ResultAny=yes
ResultInactive=yes
ResultActive=yes

However I wasn't able to connect to libvirt on the host itself, and the logs
indicated it was a PolicyKit block, so my second problem/question...Is it
possible to have multiple local PolicyKit *.pkla files or can only one
exist?  From the documentation here,
http://wiki.libvirt.org/page/SSHPolicyKitSetup, it seems like so long as the
names are unique then multiple would be allowed.  Reason that's key is I'm
using Puppet and will have multiple servers/applications needing access and
being restricted to a single file to manage will be a problem.

Connecting locally with a specific pkla for "foreman"...
-----------
$ virsh -c qemu:///system
error: authentication failed
error: failed to connect to the hypervisor

/var/log/libvirt/libvirtd.log
---------
17:50:06.102: debug : virRunWithHook:914 : Command stderr: Not authorized.

17:50:06.103: error : remoteDispatchAuthPolkit:3810 : Policy kit denied
action org.libvirt.unix.manage from pid 29640, uid 503, result: 256



Thanks
- Trey

[Attachment #3 (text/html)]

I'm attempting to remote connect to my KVM instance using virsh, but all the \
commands hang.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;When issuing the below command, nothing on the \
remote system happens, and no errors are displayed, (hostname changed)&lt;/div&gt; &lt;div&gt;$ \
virsh --debug 5 --log /var/lib/foreman/virsh.log -c \
qemu+ssh://foreman@kvmhost.tld:16509/system?no_tty=1&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;This is \
the uncommented lines in /etc/libvirt/libvirtd.conf&lt;/div&gt;&lt;div&gt;----------&lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;listen_tls = 0&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;listen_tcp = \
1&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;listen_addr = "&lt;omitted, set to management \
NIC&gt;"&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;log_level = \
1&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;log_filters="1:remote 1:event 1:qemu"&lt;/div&gt; \
&lt;/div&gt;&lt;div&gt;&lt;div&gt;log_outputs="1:syslog:libvirtd \
1:file:/var/log/libvirt/libvirtd.log"&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;This \
is the only debug output I get in /var/log/libvirt/libvirtd.log during the remote \
connection attempt&lt;/div&gt; &lt;div&gt;-----------&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;17:56:04.579: \
debug : virEventRunOnce:595 : Poll got 1 event&lt;/div&gt;&lt;div&gt;17:56:04.580: debug : \
virEventDispatchTimeouts:405 : Dispatch 3&lt;/div&gt;&lt;div&gt;17:56:04.580: debug : \
virEventDispatchHandles:450 : Dispatch 10&lt;/div&gt; &lt;div&gt;17:56:04.580: debug : \
virEventDispatchHandles:464 : i=0 w=1&lt;/div&gt;&lt;div&gt;17:56:04.580: debug : \
virEventDispatchHandles:464 : i=1 w=2&lt;/div&gt;&lt;div&gt;17:56:04.580: debug : \
virEventDispatchHandles:464 : i=2 w=3&lt;/div&gt;&lt;div&gt;17:56:04.580: debug : \
virEventDispatchHandles:464 : i=3 w=4&lt;/div&gt; &lt;div&gt;17:56:04.580: debug : \
virEventDispatchHandles:464 : i=4 w=5&lt;/div&gt;&lt;div&gt;17:56:04.580: debug : \
virEventDispatchHandles:464 : i=5 w=6&lt;/div&gt;&lt;div&gt;17:56:04.580: debug : \
virEventDispatchHandles:464 : i=6 w=7&lt;/div&gt;&lt;div&gt;17:56:04.580: debug : \
virEventDispatchHandles:464 : i=7 w=8&lt;/div&gt; &lt;div&gt;17:56:04.580: debug : \
virEventDispatchHandles:477 : Dispatch n=7 f=13 w=8 e=1 \
0x1629640&lt;/div&gt;&lt;div&gt;17:56:04.580: debug : virEventAddHandleImpl:113 : Add handle \
fd=20 events=1 cb=0x4196e0 opaque=0x1629640&lt;/div&gt;&lt;div&gt;17:56:04.580: debug : \
virEventInterruptLocked:664 : Skip interrupt, 1 -1447459072&lt;/div&gt; &lt;div&gt;17:56:04.580: \
debug : virEventDispatchHandles:464 : i=8 w=9&lt;/div&gt;&lt;div&gt;17:56:04.580: debug : \
virEventDispatchHandles:464 : i=9 w=10&lt;/div&gt;&lt;div&gt;17:56:04.580: debug : \
virEventCleanupTimeouts:495 : Cleanup 3&lt;/div&gt;&lt;div&gt;17:56:04.580: debug : \
virEventCleanupHandles:536 : Cleanupo 11&lt;/div&gt; &lt;div&gt;17:56:04.580: debug : \
virEventCleanupTimeouts:495 : Cleanup 3&lt;/div&gt;&lt;div&gt;17:56:04.580: debug : \
virEventCleanupHandles:536 : Cleanupo 11&lt;/div&gt;&lt;div&gt;17:56:04.580: debug : \
virEventMakePollFDs:373 : Prepare n=0 w=1, f=5 e=1&lt;/div&gt; &lt;div&gt;17:56:04.580: debug : \
virEventMakePollFDs:373 : Prepare n=1 w=2, f=7 e=1&lt;/div&gt;&lt;div&gt;17:56:04.580: debug : \
virEventMakePollFDs:373 : Prepare n=2 w=3, f=14 e=1&lt;/div&gt;&lt;div&gt;17:56:04.580: debug : \
virEventMakePollFDs:373 : Prepare n=3 w=4, f=15 e=1&lt;/div&gt; &lt;div&gt;17:56:04.580: debug : \
virEventMakePollFDs:373 : Prepare n=4 w=5, f=17 e=25&lt;/div&gt;&lt;div&gt;17:56:04.580: debug : \
virEventMakePollFDs:373 : Prepare n=5 w=6, f=18 e=25&lt;/div&gt;&lt;div&gt;17:56:04.580: debug : \
virEventMakePollFDs:373 : Prepare n=6 w=7, f=19 e=25&lt;/div&gt; &lt;div&gt;17:56:04.580: debug : \
virEventMakePollFDs:373 : Prepare n=7 w=8, f=13 e=25&lt;/div&gt;&lt;div&gt;17:56:04.580: debug : \
virEventMakePollFDs:373 : Prepare n=8 w=9, f=12 e=25&lt;/div&gt;&lt;div&gt;17:56:04.580: debug : \
virEventMakePollFDs:373 : Prepare n=9 w=10, f=11 e=25&lt;/div&gt; &lt;div&gt;17:56:04.580: debug \
: virEventMakePollFDs:373 : Prepare n=10 w=15, f=20 e=1&lt;/div&gt;&lt;div&gt;17:56:04.580: debug \
: virEventCalculateTimeout:314 : Calculate expiry of 3 timers&lt;/div&gt;&lt;div&gt;17:56:04.580: \
debug : virEventCalculateTimeout:344 : Timeout at 0 due in -1 ms&lt;/div&gt; \
&lt;div&gt;17:56:04.580: debug : virEventRunOnce:593 : Poll on 11 handles 0x7f35a4001240 \
timeout -1&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I've already \
opened up the firewall for port 16509, and allowed the user foreman (member of \
libvirt_admin) to manage libvirt via PolicyKit&lt;/div&gt; &lt;div&gt;Relevant line in \
iptables,&lt;/div&gt;&lt;div&gt;&lt;div&gt;5    ACCEPT     tcp  --  &lt;a \
href="http://0.0.0.0/0"&gt;0.0.0.0/0&lt;/a&gt;            &lt;a \
href="http://0.0.0.0/0"&gt;0.0.0.0/0&lt;/a&gt;           tcp dpt:16509 \
                &lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;
/etc/polkit-1/localauthority/50-local.d/50-libvirt-remote-access.pkla&lt;/div&gt;&lt;div&gt;-----------&lt;/div&gt;&lt;div&gt;&lt;div&gt;[libvirt \
Remote Access]&lt;/div&gt;&lt;div&gt;Identity=unix-group:libvirt_admin \
&lt;/div&gt;&lt;div&gt;Action=org.libvirt.unix.manage&lt;/div&gt; \
&lt;div&gt;ResultAny=yes&lt;/div&gt;&lt;div&gt;ResultInactive=yes&lt;/div&gt;&lt;div&gt;ResultActive=yes&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Originally \
I had created the file \
/etc/polkit-1/localauthority/50-local.d/51-libvirt-foreman-remote-access.pkla with \
contents below, and had the file 50-libvirt-remote-access.pkla only allowing a single \
user.&lt;/div&gt; &lt;div&gt;/etc/polkit-1/localauthority/50-local.d/51-libvirt-foreman-remote-access.pkla&lt;/div&gt;&lt;div&gt;----------&lt;/div&gt;&lt;div&gt;&lt;div&gt;[libvirt \
Foreman Remote Access]&lt;/div&gt;&lt;div&gt;Identity=unix-user:foreman \
&lt;/div&gt;&lt;div&gt;Action=org.libvirt.unix.manage&lt;/div&gt; \
&lt;div&gt;ResultAny=yes&lt;/div&gt;&lt;div&gt;ResultInactive=yes&lt;/div&gt;&lt;div&gt;ResultActive=yes&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;However \
I wasn't able to connect to libvirt on the host itself, and the logs indicated it \
was a PolicyKit block, so my second problem/question...Is it possible to have \
multiple local PolicyKit *.pkla files or can only one exist?  From the documentation \
here, &lt;a href="http://wiki.libvirt.org/page/SSHPolicyKitSetup"&gt;http://wiki.libvirt.org/page/SSHPolicyKitSetup&lt;/a&gt;, \
it seems like so long as the names are unique then multiple would be allowed.  Reason \
that's key is I'm using Puppet and will have multiple servers/applications \
needing access and being restricted to a single file to manage will be a \
problem.&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Connecting locally with a specific pkla for \
"foreman"...&lt;/div&gt;&lt;div&gt;-----------&lt;/div&gt;&lt;div&gt;&lt;div&gt;$ virsh -c \
qemu:///system&lt;/div&gt;&lt;div&gt;error: authentication failed&lt;/div&gt;&lt;div&gt;error: failed to \
connect to the hypervisor&lt;/div&gt; \
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;/var/log/libvirt/libvirtd.log&lt;/div&gt;&lt;div&gt;---------&lt;/div&gt;&lt;div&gt;&lt;div&gt;17:50:06.102: \
debug : virRunWithHook:914 : Command stderr: Not \
authorized.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;17:50:06.103: error : \
remoteDispatchAuthPolkit:3810 : Policy kit denied action org.libvirt.unix.manage from \
pid 29640, uid 503, result: 256&lt;/div&gt; \
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&lt;/div&gt;&lt;div&gt;- Trey&lt;/div&gt;



</body></email><email><emailId>20110920073815</emailId><senderName>Nikita A Menkovich</senderName><senderEmail>menkovich@gmail.com</senderEmail><timestampReceived>2011-09-20 07:38:15-0400</timestampReceived><subject>[libvirt-users] Problem with allocation of big files</subject><body>

Hello,

I found a strange problem with allocationg big files on drive.

For example in guestfish I allocate large disk image
for example:

$ guestfish
&gt;&lt;fs&gt; allocate test.img 20G

When an image allocating, there is a big slowdown of guest OSes,
launched on host machine, and on different drives.

For Linux guests with virtio drivers, there is no so big performance
penalty, but for FreeBSD guests with ide it seems like the OS locked.

Manipulating with ionice and niceness do not affect at all.

Manipulating with cfq, deadline schedulers also do not have any results.

OS Debian Squeeze
libvirtd (libvirt) 0.9.2
QEMU emulator version 0.14.0 (Debian 0.14.0+dfsg-5.1), Copyright (c)
2003-2008 Fabrice Bellard
guestfish 1.10.3 with some local patches, backported from main tree

Does anyone have ideas how to fix it?

-- 
Nikita A Menkovich
http://libc6.org/
JID: menkovich@gmail.com

</body></email><email><emailId>20110920111649</emailId><senderName>"Richard W.M. Jones"</senderName><senderEmail>rjones@redhat.com</senderEmail><timestampReceived>2011-09-20 11:16:49-0400</timestampReceived><subject>Re: [libvirt-users] [Libguestfs] Problem with allocation of big files</subject><body>

On Tue, Sep 20, 2011 at 11:38:15AM +0400, Nikita A Menkovich wrote:
&gt; Hello,
&gt; 
&gt; I found a strange problem with allocationg big files on drive.
&gt; 
&gt; For example in guestfish I allocate large disk image
&gt; for example:
&gt; 
&gt; $ guestfish
&gt; &gt; &lt;fs&gt; allocate test.img 20G
&gt; 
&gt; When an image allocating, there is a big slowdown of guest OSes,
&gt; launched on host machine, and on different drives.

I'm guessing this is a problem with the host kernel (Linux?).
Specifically you may be saturating SATA, your Southbridge, or PCI if
it's using that.

Here is the code anyway:

http://git.annexia.org/?p=libguestfs.git;a=blob;f=fish/alloc.c;h=7799e4e1c5f0b34ce079934eea7d7c0a13ecdcd3;hb=refs/heads/stable-1.10#l85


Notice that the 'allocate' command takes the non-sparse code path.

What happens next depends on:

 - does your operating system have the posix_fallocate call?

 - does your filesystem support efficient fallocate? (ext3: no, ext4: yes,
   xfs: yes)

If the answer to either question is 'no' then you end up in a loop
which writes zeroes.  For a 20 GB file this is going to be slow and is
going to saturate SATA.

If the answer to *both* questions is 'yes', then ext4/xfs should be
able to allocate the required extents and lazily initialize it.  This
is typically very fast, almost instantaneous.

&gt; For Linux guests with virtio drivers, there is no so big performance
&gt; penalty, but for FreeBSD guests with ide it seems like the OS locked.
&gt; 
&gt; Manipulating with ionice and niceness do not affect at all.
&gt; 
&gt; Manipulating with cfq, deadline schedulers also do not have any results.
&gt; 
&gt; OS Debian Squeeze
&gt; libvirtd (libvirt) 0.9.2
&gt; QEMU emulator version 0.14.0 (Debian 0.14.0+dfsg-5.1), Copyright (c)
&gt; 2003-2008 Fabrice Bellard
&gt; guestfish 1.10.3 with some local patches, backported from main tree
&gt; 
&gt; Does anyone have ideas how to fix it?

Probably the best idea is to use ext4, or use 'sparse' instead of
'allocate' (but with 'sparse' you pay the same penalty, just you pay
for it later on).

Rich.

-- 
Richard Jones, Virtualization Group, Red Hat http://people.redhat.com/~rjones
virt-p2v converts physical machines to virtual machines.  Boot with a
live CD or over the network (PXE) and turn machines into Xen guests.
http://et.redhat.com/~rjones/virt-p2v


</body></email><email><emailId>20110922004632</emailId><senderName>Dave Allan</senderName><senderEmail>dallan@redhat.com</senderEmail><timestampReceived>2011-09-22 00:46:32-0400</timestampReceived><subject>Re: [libvirt-users] virsh console</subject><body>

On Wed, Sep 21, 2011 at 03:16:03PM -0500, Jeff wrote:
&gt; Probably a dumb question, but when I run virsh console guestname,
&gt; should I expect to get a login prompt for my guest?  If I run that
&gt; command while the OS is booting I can see the boot process...but
&gt; then it just freezes and I never get a login prompt.

Assuming you're running Linux in the guest, it sounds like you don't
have a getty configured on ttyS0.  How you do that is distro specific.

Dave

</body></email><email><emailId>20110922074410</emailId><senderName>"Gian Uberto Lauri"</senderName><senderEmail>saint@eng.it</senderEmail><timestampReceived>2011-09-22 07:44:10-0400</timestampReceived><subject>Re: [libvirt-users] random "monitor socket did not show up"</subject><body>

&gt; &gt; &gt; &gt; &gt; "OY" == Osier Yang &lt;jyang@redhat.com&gt; writes:

OY&gt; Hi, Gian

OY&gt; What's the error on the Fujitsu box?

That's what's in OpenNebula log:

Wed Sep 21 15:59:07 2011 [VMM][I]: error: Failed to create domain from \
/var/lib/one/290/images/deployment.0 Wed Sep 21 15:59:07 2011 [VMM][I]: error: \
monitor socket did not show up.: No such file or directory

That reflects what I get from the command line:


[root@goedel images]# virsh create deployment.0 
error: Failed to create domain from deployment.0
error: monitor socket did not show up.: No such file or directory


--
ing. Gian Uberto Lauri
Ricercatore / Reasearcher
Laboratorio Ricerca e Sviluppo / Research &amp; Development Lab.
Area Calcolo Distribuito / Distributed Computation Area

GianUberto.Lauri@eng.it

Engineering Ingegneria Informatica spa
Corso Stati Uniti 23/C, 35127 Padova (PD) 

Tel. +39-049.8283.571         | main(){printf(&amp;unix["\021%six\012\0"], 
Fax  +39-049.8283.569		  |    (unix)["have"]+"fun"-0x60);}   
Skype: gian.uberto.lauri	  |          David Korn, AT&amp;T Bell Labs             
http://www.eng.it 			  |          ioccc best One Liner, 1987             


</body></email><email><emailId>20110926192846</emailId><senderName>Mauro</senderName><senderEmail>mrsanna1@gmail.com</senderEmail><timestampReceived>2011-09-26 19:28:46-0400</timestampReceived><subject>[libvirt-users] how to convert from xen .cfg files to libvirt xml?</subject><body>

I have a .cfg configuration file for a xen virtual machine.
I need to convert it in xml format to use with libvirt.
So I run virsh domxml-from-native xen-xm backupsrv.cfg but I have an error:

error: Unknown failure.
How can I investigate about the error?

</body></email><email><emailId>20110927023126</emailId><senderName>huachao yao</senderName><senderEmail>yao.d.hc@gmail.com</senderEmail><timestampReceived>2011-09-27 02:31:26-0400</timestampReceived><subject>[libvirt-users] Snapshot Error</subject><body>

Hey
When I want to take a snapshot for a Domain by using
virDomainSnapshotCreateXML. The Error as below happen:

libvir: QEMU error : Requested operation is not valid: Disk
'/var/lib/libvirt/images/fedora-qcow.qcow2' does not support snapshotting

The snapshot Configuration is :
&lt;domainsnapshot&gt;
  &lt;description&gt;Snapshot of OS install and updates&lt;/description&gt;
  &lt;disks&gt;
    &lt;disk name='/var/lib'&gt;
      &lt;source file='/var/lib-snapshot'/&gt;
    &lt;/disk&gt;
    &lt;disk name='vdb' snapshot='no'/&gt;
  &lt;/disks&gt;
&lt;/domainsnapshot&gt;

And /var/lib/libvirt/images/fedora-qcow.qcow2 is the disk for the domain
(use qemu-img to create). And I had tried another Disk format
(*.img), but the error still happen. how can i deal with this error??

PS:qemu version is 0.14 &amp; libvirt version is 0.9.4.  Pls help.   :-(

[Attachment #3 (text/html)]

Hey&lt;br&gt;When I want to take a snapshot for a Domain by using &lt;span style="color: \
rgb(204, 0, 0);"&gt;virDomainSnapshotCreateXML&lt;/span&gt;. The Error as below \
happen:&lt;br&gt;&lt;br&gt;&lt;span style="color: rgb(255, 0, 0);"&gt;libvir: QEMU error : Requested \
operation is not valid: Disk '/var/lib/libvirt/images/fedora-qcow.qcow2' does \
not support snapshotting&lt;/span&gt;&lt;br&gt; &lt;br&gt;The snapshot Configuration is \
:&lt;br&gt;&lt;domainsnapshot&gt;&lt;br&gt;  &lt;description&gt;Snapshot of OS install and \
updates&lt;/description&gt;&lt;br&gt;  &lt;disks&gt;&lt;br&gt;    &lt;disk \
name='/var/lib'&gt;&lt;br&gt;      &lt;source \
file='/var/lib-snapshot'/&gt;&lt;br&gt;  &lt;/disk&gt;&lt;br&gt;    &lt;disk \
name='vdb' snapshot='no'/&gt;&lt;br&gt;  \
&lt;/disks&gt;&lt;br&gt;&lt;/domainsnapshot&gt;&lt;br&gt;&lt;br&gt;And &lt;span style="color: rgb(255, 0, \
0);"&gt;/var/lib/libvirt/images/fedora-qcow.qcow2 &lt;font color="#000000"&gt;is the disk for \
the domain (use qemu-img to create). And I had tried another Disk format&lt;br&gt; (*.img), \
but the error still happen. how can i deal with this error?? &lt;br&gt;&lt;br&gt;PS:qemu version \
is 0.14 &amp; libvirt version is 0.9.4.  Pls help.   :-(&lt;br&gt;&lt;/font&gt;&lt;/span&gt;



</body></email><email><emailId>20110929060842</emailId><senderName>Magicloud Magiclouds</senderName><senderEmail>magicloud.magiclouds@gmail.com</senderEmail><timestampReceived>2011-09-29 06:08:42-0400</timestampReceived><subject>[libvirt-users] virsh cannot list broken guest.</subject><body>

Hi,
  I am starting to learn using libvirt with kvm on CentOS 6.
  Just used this command to start a guest:
virt-install -ntest -r1024 --vcpus=1
-c/var/lib/libvirt/images/CentOS-6.0-x86_64-netinstall.iso
--os-type=linux --os-variant=rhel6 --disk vol=kvmguests/test --vnc -v
--virt-type=kvm --check-cpu --prompt --arch=x86_64
  Then I found out that I misconfigured vnc. And I do not know how to
gracefully stop qemu. So I killed it.
  Then with the command, I got:
ERROR    Guest name 'test' is already in use.
What is the name of your virtual machine?
  But at this time, there is nothing listed in virsh:
Welcome to virsh, the virtualization interactive terminal.

Type:  'help' for help with commands
       'quit' to quit

virsh # list
 Id Name                 State
----------------------------------

virsh # connect qemu:///system

virsh # list
 Id Name                 State
----------------------------------

virsh #

  What should I do?
-- 
竹密岂妨流水过
山高哪阻野云飞

</body></email><email><emailId>20110930023447</emailId><senderName>Magicloud Magiclouds</senderName><senderEmail>magicloud.magiclouds@gmail.com</senderEmail><timestampReceived>2011-09-30 02:34:47-0400</timestampReceived><subject>[libvirt-users] Second VM cannot get dhcp ip in NAT mode</subject><body>

Hi,
  Yesterday I started to use libvirt with kvm under centos6. The first
VM works great.
  Today I added another VM and start to initialize with virt-install.
  Well, it seems that, the second VM cannot get dhcp ip. I did not
change the default libvirt network configuration.
  What should I do?
-- 
竹密岂妨流水过
山高哪阻野云飞

</body></email><email><emailId>20111003022658</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2011-10-03 02:26:58-0400</timestampReceived><subject>Re: [libvirt-users] Second VM cannot get dhcp ip in NAT mode</subject><body>

On 09/29/2011 11:45 PM, Magicloud Magiclouds wrote:
&gt; On Fri, Sep 30, 2011 at 10:34 AM, Magicloud Magiclouds
&gt; &lt;magicloud.magiclouds@gmail.com&gt;  wrote:
&gt;&gt; Hi,
&gt;&gt;   Yesterday I started to use libvirt with kvm under centos6. The first
&gt;&gt; VM works great.
&gt;&gt;   Today I added another VM and start to initialize with virt-install.
&gt;&gt;   Well, it seems that, the second VM cannot get dhcp ip. I did not
&gt;&gt; change the default libvirt network configuration.
&gt;&gt;   What should I do?
&gt;&gt; --
&gt;&gt; 竹密岂妨流水过
&gt;&gt; 山高哪阻野云飞
&gt;&gt;
&gt; So it is not a dhcp issue.
&gt; Fixed ip did not work. Stop the first one did not help.
&gt; Seems like the second VM just cannot use the network.

Do "virsh dumpxml ${guestname} &gt;/tmp/${guestname}.xml" for each of the 
two guests, then compare the &lt;interface&gt; section of the two guests (are 
both guests running the same OS?).

</body></email><email><emailId>20110929065338</emailId><senderName>Magicloud Magiclouds</senderName><senderEmail>magicloud.magiclouds@gmail.com</senderEmail><timestampReceived>2011-09-29 06:53:38-0400</timestampReceived><subject>Re: [libvirt-users] virsh cannot list broken guest.</subject><body>

On Thu, Sep 29, 2011 at 2:08 PM, Magicloud Magiclouds
&lt;magicloud.magiclouds@gmail.com&gt; wrote:
&gt; Hi,
&gt;  I am starting to learn using libvirt with kvm on CentOS 6.
&gt;  Just used this command to start a guest:
&gt; virt-install -ntest -r1024 --vcpus=1
&gt; -c/var/lib/libvirt/images/CentOS-6.0-x86_64-netinstall.iso
&gt; --os-type=linux --os-variant=rhel6 --disk vol=kvmguests/test --vnc -v
&gt; --virt-type=kvm --check-cpu --prompt --arch=x86_64
&gt;  Then I found out that I misconfigured vnc. And I do not know how to
&gt; gracefully stop qemu. So I killed it.
&gt;  Then with the command, I got:
&gt; ERROR    Guest name 'test' is already in use.
&gt; What is the name of your virtual machine?
&gt;  But at this time, there is nothing listed in virsh:
&gt; Welcome to virsh, the virtualization interactive terminal.
&gt;
&gt; Type:  'help' for help with commands
&gt;       'quit' to quit
&gt;
&gt; virsh # list
&gt;  Id Name                 State
&gt; ----------------------------------
&gt;
&gt; virsh # connect qemu:///system
&gt;
&gt; virsh # list
&gt;  Id Name                 State
&gt; ----------------------------------
&gt;
&gt; virsh #
&gt;
&gt;  What should I do?
&gt; --
&gt; 竹密岂妨流水过
&gt; 山高哪阻野云飞
&gt;

Seems like it is not only broken guests.
I just installed another one. And successful. But still, nothing
listed in virsh.

-- 
竹密岂妨流水过
山高哪阻野云飞

</body></email><email><emailId>20110927053204</emailId><senderName>Emmanuel Noobadmin</senderName><senderEmail>centos.admin@gmail.com</senderEmail><timestampReceived>2011-09-27 05:32:04-0400</timestampReceived><subject>Re: [libvirt-users] Snapshot Error</subject><body>

On 9/27/11, huachao yao &lt;yao.d.hc@gmail.com&gt; wrote:
&gt; And /var/lib/libvirt/images/fedora-qcow.qcow2 is the disk for the domain
&gt; (use qemu-img to create). And I had tried another Disk format
&gt; (*.img), but the error still happen. how can i deal with this error??

Just in case, are you sure it really is a qcow2 format? Just asking
because I recently discovered that image files I created with qemu-img
as qcow2 appears to had been converted or created as raw instead. When
I googled about this, it seems that libvirt does not check what type
of disk file it is, and assumes raw unless specified.

So your qcow2 and img file might actually still be .raw once libvirt
gets hold of it.

</body></email><email><emailId>20110927070139</emailId><senderName>Mauro</senderName><senderEmail>mrsanna1@gmail.com</senderEmail><timestampReceived>2011-09-27 07:01:39-0400</timestampReceived><subject>Re: [libvirt-users] how to convert from xen .cfg files to libvirt xml?</subject><body>

On 26 September 2011 21:28, Mauro &lt;mrsanna1@gmail.com&gt; wrote:
&gt; I have a .cfg configuration file for a xen virtual machine.
&gt; I need to convert it in xml format to use with libvirt.
&gt; So I run virsh domxml-from-native xen-xm backupsrv.cfg but I have an error:
&gt;
&gt; error: Unknown failure.
&gt; How can I investigate about the error?

Can I have a help?

</body></email><email><emailId>20110927152939</emailId><senderName>Mauro</senderName><senderEmail>mrsanna1@gmail.com</senderEmail><timestampReceived>2011-09-27 15:29:39-0400</timestampReceived><subject>Re: [libvirt-users] how to convert from xen .cfg files to libvirt xml?</subject><body>

On 27 September 2011 09:01, Mauro &lt;mrsanna1@gmail.com&gt; wrote:
&gt; On 26 September 2011 21:28, Mauro &lt;mrsanna1@gmail.com&gt; wrote:
&gt;&gt; I have a .cfg configuration file for a xen virtual machine.
&gt;&gt; I need to convert it in xml format to use with libvirt.
&gt;&gt; So I run virsh domxml-from-native xen-xm backupsrv.cfg but I have an error:
&gt;&gt;
&gt;&gt; error: Unknown failure.
&gt;&gt; How can I investigate about the error?
&gt;
&gt; Can I have a help?

Please someone can help?

</body></email><email><emailId>20110927154942</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-09-27 15:49:42-0400</timestampReceived><subject>Re: [libvirt-users] how to convert from xen .cfg files to libvirt xml?</subject><body>

On 09/26/2011 01:28 PM, Mauro wrote:
&gt; I have a .cfg configuration file for a xen virtual machine.
&gt; I need to convert it in xml format to use with libvirt.
&gt; So I run virsh domxml-from-native xen-xm backupsrv.cfg but I have an error:
&gt;
&gt; error: Unknown failure.
&gt; How can I investigate about the error?

Have you looked in the logs to see if any further details are present 
there?  Also, you may want to dial up debug verbosity, using 
LIBVIRT_DEBUG and friends, as documented here: 
http://libvirt.org/logging.html

Beyond that, all I can suggest is stepping through things with gdb; I'm 
not familiar enough with xen myself to recognize these symptoms.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20110927160743</emailId><senderName>Mauro</senderName><senderEmail>mrsanna1@gmail.com</senderEmail><timestampReceived>2011-09-27 16:07:43-0400</timestampReceived><subject>Re: [libvirt-users] how to convert from xen .cfg files to libvirt xml?</subject><body>

Thanks for your replay.
I've augmented debug level, run virsh domxml-from-native xen-xm
backupsrv.cfg and this is the error:


virsh: malloc.c:3097: sYSMALLOc: Assertion `(old_top == (((mbinptr)
(((char *) &amp;((av)-&gt;bins[((1) - 1) * 2])) - __builtin_offsetof (struct
malloc_chunk, fd)))) &amp;&amp; old_size == 0) || ((unsigned long) (old_size)
&gt;= (unsigned long)((((__builtin_offsetof (struct malloc_chunk,
fd_nextsize))+((2 * (sizeof(size_t))) - 1)) &amp; ~((2 * (sizeof(size_t)))
- 1))) &amp;&amp; ((old_top)-&gt;size &amp; 0x1) &amp;&amp; ((unsigned long)old_end &amp;
pagemask) == 0)' failed.

</body></email><email><emailId>20110927171955</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-09-27 17:19:55-0400</timestampReceived><subject>Re: [libvirt-users] how to convert from xen .cfg files to libvirt xml?</subject><body>

On 09/27/2011 10:07 AM, Mauro wrote:
&gt; Thanks for your replay.
&gt; I've augmented debug level, run virsh domxml-from-native xen-xm
&gt; backupsrv.cfg and this is the error:
&gt;
&gt;
&gt; virsh: malloc.c:3097: sYSMALLOc: Assertion `(old_top == (((mbinptr)

That's evil :( - this is a failure from glibc, which implies we've 
corrupted the heap.  Try running things under valgrind to find the culprit.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20110927172402</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-09-27 17:24:02-0400</timestampReceived><subject>Re: [libvirt-users] how to convert from xen .cfg files to libvirt xml?</subject><body>

On 09/27/2011 11:19 AM, Eric Blake wrote:
&gt; On 09/27/2011 10:07 AM, Mauro wrote:
&gt;&gt; Thanks for your replay.
&gt;&gt; I've augmented debug level, run virsh domxml-from-native xen-xm
&gt;&gt; backupsrv.cfg and this is the error:
&gt;&gt;
&gt;&gt;
&gt;&gt; virsh: malloc.c:3097: sYSMALLOc: Assertion `(old_top == (((mbinptr)
&gt;
&gt; That's evil :( - this is a failure from glibc, which implies we've
&gt; corrupted the heap. Try running things under valgrind to find the culprit.

Also, it might help to post your backupsrv.cfg file, to see if anyone 
else can reproduce the failure.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20110922164551</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-09-22 16:45:51-0400</timestampReceived><subject>Re: [libvirt-users] Hot cloning &amp; P2V</subject><body>

On 09/22/2011 06:34 AM, smain kahlouch wrote:
&gt; Hi all,
&gt;
&gt; I guess my question is stupid and has been asked a thousand times but i was
&gt; wondering if it's possible to do the following things:
&gt;
&gt; - Cloning of a running virtual machine (hot copy)

You can use 'virsh save' (aka virDomainSave) to save the state of a VM, 
copy that file, then 'virsh save-file-edit' to tweak the associated xml 
of the copy, so that 'virsh restore' of the original file resumes the 
original and 'virsh restore' of the copy resumes a hot clone.  This 
isn't quite live (as you have downtime between the save and restore, on 
the order of seconds, and you end up with a new qemu process which means 
no seamless migration of any vnc or spice connection to the old 
process), but at least it doesn't lose VM state.  I'm hoping to enhance 
this further in future libvirt so that the savevm step can reuse the 
original qemu instead of requiring a restore step that starts a new qemu 
process.

With libvirt 0.9.6, you can also do this: 'virsh snapshot-create 
--disk-only' (aka virDomainSnapshotCreateXML) which creates qcow2 
wrappers around a read-only base image for all the disk images, with 
very minimal downtime of the guest (the guest is paused for only a 
fraction of a second, and the same qemu process stays live so you don't 
lose connection to vnc or spice).  From there, you can create new qcow2 
wrappers that target the same read-only base disk images, and start up a 
new guest via new xml, such that you have two guests that have branched 
from the same point in time of disk contents; although be aware that you 
did lose VM state (anything in RAM in the original guest will not be 
present in the cloned guest).  The new guest will have to run fsck (it 
inherited disks in only a crash-consistent state, rather than a clean 
boot state - at least until future qemu makes it possible to request via 
a guest agent that the guest quiesce its disks prior to a snapshot 
operation).  Once the new guest is running, you can then use 'virsh 
blockpull' to flatten the dependency, so that the new guest's qcow2 disk 
images no longer depend on the base image of the original guest, at 
which point you have two truly independent guests, with the second 
created as a hot-clone of the first.  And someday, when (if?) qemu adds 
the ability to merge qcow2 deltas back into the original backing image 
(that is, to undo the disk snapshot fork), we can make the process even 
nicer (no change in filenames for the original guest after the second 
guest has cleanly completed blockpull, so that the original guest is not 
forced to use qcow2 disk images).

&gt; - Migrate a physical server to a virtual one.

Check out the virt-p2v project.  It's rather complicated - it's a 
one-way conversion (once you have a virtual VM running from the state of 
the previous physical server, you can't convert back to physical), and 
requires offline conversion (that is, the process involves booting a 
liveusb instead of the server itself, so that the conversion is done on 
stable disks that are not in-use by a live server).

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20110923090439</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-09-23 09:04:39-0400</timestampReceived><subject>Re: [libvirt-users] The Format Of URI when Migrating</subject><body>

On Fri, Sep 23, 2011 at 04:41:40PM +0800, huachao yao wrote:
&gt; Hi, when I try to use such API:
&gt; 
&gt; virDomainPtr &lt;http://www.libvirt.org/html/libvirt-libvirt.html#virDomainPtr&gt;	virDomainMigrate	(virDomainPtr
&gt;  &lt;http://www.libvirt.org/html/libvirt-libvirt.html#virDomainPtr&gt;
&gt; domain,
&gt; 					 virConnectPtr
&gt; &lt;http://www.libvirt.org/html/libvirt-libvirt.html#virConnectPtr&gt;
&gt; dconn,
&gt; 					 unsigned long flags,
&gt; 					 const char * dname,
&gt; 					 const char * uri,
&gt; 					 unsigned long bandwidth)
&gt; to achieve the domain to the remote host. I set the "const char * uri"
&gt; as "qemu+ssh://root@116.56.142.199/system".
&gt; But the Error "libvir: QEMU error : invalid argument in only tcp URIs
&gt; are supported for KVM/QEMU migrations" happened.
&gt; 
&gt; I want to know when i want the migrate ,how can i set the URI ? offer
&gt; a example is better.   :-)

The answer depends on the way you invoke migration. There are essentially
two ways libvirt supports

 - "Normal" - the libvirt client co-ordinates the process, talking to
   both the source and target libvirtd daemons.
 - "Peer2Peer" - the libvirt client talks to the source libvirtd daemon.
   The source libvirtd daemon co-ordinates the process directly with
   the target libvirtd.

In the Normal case, the URI you need to give is a QEMU migration
URI such as  'tcp://hostname-of-target-host'.

In the Peer2Peer case (if you set VIR_MIGRATE_PEER2PEER in the flags
parameter), the URI you need is a normal libvirt URI such as the
'qemu+ssh://root@hostname-of-target-host/system'.


&gt; From the error message you are attempting a normal migration, so need
to give the tcp style URI i show above.

Daniel
-- 
&gt; &gt; http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
&gt; &gt; http://libvirt.org              -o-             http://virt-manager.org :|
&gt; &gt; http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
&gt; &gt; http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|


</body></email><email><emailId>20110923102617</emailId><senderName>Kiran Javaid</senderName><senderEmail>kiran.javaid@live.com</senderEmail><timestampReceived>2011-09-23 10:26:17-0400</timestampReceived><subject>[libvirt-users] FW:  virDomainDefineXml Issue</subject><body>

[Attachment #2 (multipart/alternative)]


Hello,

I am forwarding this email again. Need your help as I am very new to libvirt. 

Regards,
Kiran

From: kiran.javaid@live.com
To: libvirt-users@redhat.com
Date: Thu, 15 Sep 2011 13:02:32 +0200
Subject: Re: [libvirt-users] virDomainDefineXml Issue








The contents of my xml:&lt;domain type='xen' &gt;  &lt;name&gt;for_kiran&lt;/name&gt;  \
&lt;uuid&gt;d636ccee-ca30-11e0-9624-001f160cb28c&lt;/uuid&gt;  &lt;!-- \
&lt;bootloader&gt;/usr/bin/pygrub&lt;/bootloader&gt;--&gt;  &lt;os&gt;    &lt;type&gt;hvm&lt;/type&gt;    \
&lt;loader&gt;/usr/lib/xen/boot/hvmloader&lt;/loader&gt;  &lt;/os&gt;  &lt;memory&gt;512000&lt;/memory&gt;  \
&lt;vcpu&gt;1&lt;/vcpu&gt;  &lt;devices&gt;    &lt;disk type='file'&gt;      &lt;source \
file='/root/for_kiran.img'/&gt;      &lt;target dev='hda'/&gt;    &lt;/disk&gt;    &lt;interface \
type='network'&gt;         &lt;source network='default'/&gt;         &lt;mac \
address='aa:00:00:00:00:11'/&gt;         &lt;script path='/etc/xen/scripts/vif-nat'/&gt;       \
&lt;/interface&gt;    &lt;!-- &lt;console tty='/dev/pty'/&gt; --&gt;    &lt;graphics type="vnc" /&gt;  \
&lt;/devices&gt;&lt;/domain&gt;

&gt; Date: Mon, 12 Sep 2011 12:26:41 +0200
&gt; From: jdenemar@redhat.com
&gt; To: kiran.javaid@live.com
&gt; CC: libvirt-users@redhat.com
&gt; Subject: Re: [libvirt-users] virDomainDefineXml Issue
&gt; 
&gt; On Fri, Sep 09, 2011 at 16:02:45 +0200, Kiran Javaid wrote:
&gt; &gt; 
&gt; &gt; Hello Everyone,
&gt; &gt; 
&gt; &gt; I am facing a problem in defining the xml for domain creation using libvirt. I am \
&gt; &gt; using Xen hypervisor. 
&gt; &gt; domPtr = lib.virDomainDefineXML(conPtr, domainXML);
&gt; &gt; 
&gt; &gt; I get the following error:
&gt; &gt; 
&gt; &gt; "libvir: Xen Daemon error : XML error: failed to parse domain description"
&gt; 
&gt; This suggests there is an error in your xml. Would you mind sending the
&gt; content of domainXML to this list?
&gt; 
&gt; Jirka
 		 	   		  

_______________________________________________
libvirt-users mailing list
libvirt-users@redhat.com
https://www.redhat.com/mailman/listinfo/libvirt-users 		 	   		  


[Attachment #5 (text/html)]

&lt;html&gt;
&lt;head&gt;
&lt;style&gt;&lt;!--
.hmmessage P
{
margin:0px;
padding:0px
}
body.hmmessage
{
font-size: 10pt;
font-family:Tahoma
}
--&gt;&lt;/style&gt;
&lt;/head&gt;
&lt;body class='hmmessage'&gt;&lt;div dir='ltr'&gt;
Hello,&lt;br&gt;&lt;br&gt;I am forwarding this email again. Need your help as I am very new to \
libvirt. &lt;br&gt;&lt;br&gt;Regards,&lt;br&gt;Kiran&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;hr id="stopSpelling"&gt;From: \
kiran.javaid@live.com&lt;br&gt;To: libvirt-users@redhat.com&lt;br&gt;Date: Thu, 15 Sep 2011 \
13:02:32 +0200&lt;br&gt;Subject: Re: [libvirt-users] virDomainDefineXml Issue&lt;br&gt;&lt;br&gt;

&lt;meta http-equiv="Content-Type" content="text/html; charset=unicode"&gt;
&lt;meta name="Generator" content="Microsoft SafeHTML"&gt;
&lt;style&gt;
.ExternalClass .ecxhmmessage P
{padding:0px;}
.ExternalClass body.ecxhmmessage
{font-size:10pt;font-family:Tahoma;}

&lt;/style&gt;

&lt;div dir="ltr"&gt;
&lt;span class="ecxApple-style-span" style="color: rgb(42, 42, 42); font-family: 'Segoe \
UI',Tahoma,Verdana,Arial,sans-serif; line-height: 17px; background-color: rgb(255, \
255, 255);"&gt;The contents of my xml:&lt;br style="line-height: 17px;"&gt;&lt;br \
style="line-height: 17px;"&gt;&lt;domain type='xen' &gt;&lt;br style="line-height: \
17px;"&gt;  &lt;name&gt;for_kiran&lt;/name&gt;&lt;br style="line-height: 17px;"&gt;  \
&lt;uuid&gt;d636ccee-ca30-11e0-9624-001f160cb28c&lt;/uuid&gt;&lt;br style="line-height: \
17px;"&gt;  &lt;!-- &lt;bootloader&gt;/usr/bin/pygrub&lt;/bootloader&gt;--&gt;&lt;br \
style="line-height: 17px;"&gt;  &lt;os&gt;&lt;br style="line-height: \
17px;"&gt;    &lt;type&gt;hvm&lt;/type&gt;&lt;br style="line-height: \
17px;"&gt;    &lt;loader&gt;/usr/lib/xen/boot/hvmloader&lt;/loader&gt;&lt;br \
style="line-height: 17px;"&gt;  &lt;/os&gt;&lt;br style="line-height: 17px;"&gt;  \
&lt;memory&gt;512000&lt;/memory&gt;&lt;br style="line-height: 17px;"&gt;  \
&lt;vcpu&gt;1&lt;/vcpu&gt;&lt;br style="line-height: 17px;"&gt;  &lt;devices&gt;&lt;br \
style="line-height: 17px;"&gt;    &lt;disk type='file'&gt;&lt;br \
style="line-height: 17px;"&gt;      &lt;source \
file='/root/for_kiran.img'/&gt;&lt;br style="line-height: \
17px;"&gt;      &lt;target dev='hda'/&gt;&lt;br \
style="line-height: 17px;"&gt;    &lt;/disk&gt;&lt;br style="line-height: \
17px;"&gt;    &lt;interface type='network'&gt;&lt;br style="line-height: \
17px;"&gt;         &lt;source \
network='default'/&gt;&lt;br style="line-height: \
17px;"&gt;         &lt;mac \
address='aa:00:00:00:00:11'/&gt;&lt;br style="line-height: \
17px;"&gt;         &lt;script \
path='/etc/xen/scripts/vif-nat'/&gt;&lt;br style="line-height: \
17px;"&gt;         &lt;/interface&gt;&lt;br \
style="line-height: 17px;"&gt;    &lt;!-- &lt;console tty='/dev/pty'/&gt; \
--&gt;&lt;br style="line-height: 17px;"&gt;    &lt;graphics type="vnc" \
/&gt;&lt;br style="line-height: 17px;"&gt;  &lt;/devices&gt;&lt;br style="line-height: \
17px;"&gt;&lt;/domain&gt;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;div&gt;&gt; Date: Mon, 12 Sep 2011 12:26:41 \
+0200&lt;br&gt;&gt; From: jdenemar@redhat.com&lt;br&gt;&gt; To: kiran.javaid@live.com&lt;br&gt;&gt; CC: \
libvirt-users@redhat.com&lt;br&gt;&gt; Subject: Re: [libvirt-users] virDomainDefineXml \
Issue&lt;br&gt;&gt; &lt;br&gt;&gt; On Fri, Sep 09, 2011 at 16:02:45 +0200, Kiran Javaid \
wrote:&lt;br&gt;&gt; &gt; &lt;br&gt;&gt; &gt; Hello Everyone,&lt;br&gt;&gt; &gt; &lt;br&gt;&gt; &gt; I am \
facing a problem in defining the xml for domain creation using libvirt. I am using \
Xen hypervisor.&lt;br&gt;&gt; &gt; &lt;br&gt;&gt; &gt; domPtr = lib.virDomainDefineXML(conPtr, \
domainXML);&lt;br&gt;&gt; &gt; &lt;br&gt;&gt; &gt; I get the following error:&lt;br&gt;&gt; &gt; \
&lt;br&gt;&gt; &gt; "libvir: Xen Daemon error : XML error: failed to parse domain \
description"&lt;br&gt;&gt; &lt;br&gt;&gt; This suggests there is an error in your xml. Would you \
mind sending the&lt;br&gt;&gt; content of domainXML to this list?&lt;br&gt;&gt; &lt;br&gt;&gt; \
Jirka&lt;br&gt;&lt;/div&gt; 		 	   		  &lt;/div&gt; &lt;br&gt;_______________________________________________
libvirt-users mailing list
libvirt-users@redhat.com
https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/div&gt; 		 	   		  &lt;/div&gt;&lt;/body&gt;
&lt;/html&gt;


["ATT00001" (text/plain)]

_______________________________________________
libvirt-users mailing list
libvirt-users@redhat.com
https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110923123657</emailId><senderName>"Richard W.M. Jones"</senderName><senderEmail>rjones@redhat.com</senderEmail><timestampReceived>2011-09-23 12:36:57-0400</timestampReceived><subject>Re: [libvirt-users] [virt-tools-list] ANNOUNCE: oz 0.7.0 release</subject><body>

I built a Debian package of Oz 0.7.0 (-ish + a few patches from git).

It's is _temporarily_ here:

  http://oirase.annexia.org/tmp/oz_0.7.0-4_all.deb

Hopefully we can arrange a more permanent location later.

Note a mistake (sorta): this package depends on "python-libguestfs",
which you can download from the libguestfs binaries site[1].  However
when libguestfs was recently added to Debian, the subpackage name was
changed to "python-guestfs"[2].  So installation will fail if you use
the official Debian package.

Rich.

[1] http://libguestfs.org/download/binaries/
[2] http://packages.debian.org/wheezy/python-guestfs

-- 
Richard Jones, Virtualization Group, Red Hat http://people.redhat.com/~rjones
virt-top is 'top' for virtual machines.  Tiny program with many
powerful monitoring features, net stats, disk stats, logging, etc.
http://et.redhat.com/~rjones/virt-top

</body></email><email><emailId>20110926160423</emailId><senderName>"Sergio A. Kessler"</senderName><senderEmail>sergiokessler@gmail.com</senderEmail><timestampReceived>2011-09-26 16:04:23-0400</timestampReceived><subject>Re: [libvirt-users] new guest with same name as undefined one</subject><body>

On Mon, Sep 26, 2011 at 09:57, Eric Blake &lt;eblake@redhat.com&gt; wrote:
&gt; On 09/26/2011 06:52 AM, David Cohen wrote:
&gt;&gt;
&gt;&gt; Hi,
&gt;&gt; See if you have a /var/lib/libvirt/qemu/save/your_guest_name.save
&gt;&gt; That might be the ghost of the old guest preventing startup.
&gt;
&gt; Yes, that's exactly what I suspect.  However, directly messing with files
&gt; under /var/lib/libvirt/... is not recommended; rather, you should go through
&gt; public libvirt interfaces; in this case, 'virsh managedsave-remove
&gt; your_guest_name'.

aha, there is !

# ls /var/lib/libvirt/qemu/save
rmdev2.save
# virsh managedsave-remove rmdev2
Removed managedsave image for domain rmdev2
# virsh start rmdev2
Domain rmdev2 started

it seems an easy trap, because the answer of "how do I remove a vm" is
just "undefine vm_name", everytime, everywhere, and however google was
not helping much...

and I didn't know rhel6 is old by now
# rpm -q libvirt
libvirt-0.8.7-18.el6_1.1.x86_64

thanks eric and david !

</body></email><email><emailId>20110926183732</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-09-26 18:37:32-0400</timestampReceived><subject>Re: [libvirt-users] changue bridge name, libvirt refuses to take new name</subject><body>

On 09/26/2011 10:42 AM, Sergio A. Kessler wrote:
&gt; - edited /etc/libvirt/qemu/rmdev2.xml and changed the line&lt;source
&gt; bridge='br0'/&gt;  to&lt;source bridge='br1'/&gt;

Wrong.  You should not be directly editing anything under /etc/libvirt, 
but instead should be using 'virsh edit rmdev2' to make those changes. 
It may be because you went behind libvirt's back that your edits were 
not recognized, and that you had to end up undefining and re-creating a 
new guest before you got this to work the way you wanted.

&gt; # brctl show
&gt; bridge name     bridge id               STP enabled     interfaces
&gt; br1             8000.e41f13ba6e1a       no              eth1
&gt; virbr0          8000.5254003a3124       yes             virbr0-nic
&gt;
&gt; # virsh -c qemu:///system start rmdev2
&gt; error: Failed to start domain rmdev2
&gt; error: Failed to add tap interface to bridge 'br0': No such device
&gt;
&gt; there *nothing* 'br0' in /etc in the system (I grepped it),
&gt; why is looking for br0 instead of br1 ?

One other thing to check, although I'm not sure it matters in your case 
(since you said that creating a new domain worked): when modifying 
network information, you may also need to modify libvirt's notion of the 
network, via such commands as 'virsh net-list' and 'virsh net-edit'.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20110926205640</emailId><senderName>Robin Lee Powell</senderName><senderEmail>rlpowell@digitalkingdom.org</senderEmail><timestampReceived>2011-09-26 20:56:40-0400</timestampReceived><subject>Re: [libvirt-users] virsh edit problems</subject><body>

On Mon, Sep 26, 2011 at 02:40:23PM -0600, Eric Blake wrote:
&gt; On 09/26/2011 02:30 PM, Robin Lee Powell wrote:
&gt; &gt;
&gt; &gt;What I've been trying to do is something like:
&gt; &gt;
&gt; &gt;     &lt;serial type='pty'&gt;
&gt; &gt;       &lt;source path='/dev/pts/3'/&gt;
&gt; &gt;       &lt;target port='0'/&gt;
&gt; &gt;     &lt;/serial&gt;
&gt; 
&gt; Ah - maybe I can explain that issue.  For pty devices, &lt;source
&gt; path=.../&gt; is computed at runtime, once libvirt has actually
&gt; allocated a pty from the host (which pty gets allocated depends on
&gt; what else has been going on in your host prior to starting your
&gt; guest).  Since the pty allocated is dependent on various runtime
&gt; factors, there is no way to pre-allocate a fixed pty value - so
&gt; this &lt;source&gt; element is something that 'virsh dumpxml' outputs to
&gt; show you which pty libvirt allocated, but where you have no
&gt; control (and no need to control) which pty to attempt to allocate.
&gt; And libvirt is merely stripping the unused &lt;source&gt; from your
&gt; persistent config because it doesn't make sense in a persistent
&gt; context.
&gt; 
&gt; &gt;     &lt;console type='pty'&gt;
&gt; &gt;       &lt;source path='/dev/pts/4'/&gt;
&gt; &gt;       &lt;target port='0'/&gt;
&gt; &gt;     &lt;/console&gt;
&gt; &gt;
&gt; &gt;And it just won't stick.  Maybe that's not even my problem, but
&gt; &gt;it's not showing any errors, and it's annoying me and I'd like to
&gt; &gt;understand why.
&gt; 
&gt; Hopefully my explanation helps, but feel free to ask more
&gt; questions as needed.  Perhaps this is a case of me answering your
&gt; stated question rather than your implied question (that is, I
&gt; answered why &lt;source&gt; is disappearing, but not how to get a
&gt; console to your guest working in the first place).

Yes, well, that's completely fair, and I appreciate the explanation.
:)

If other people are having configs like mine and it's working, then
that's not the problem, I guess.  I was worried because only one pts
is being allocated, according to the log, so I'm worried that it's
not making the right allocation.

But yeah, if you want to help with the actual problem (the link to
the kvm mailing list explains it), feel free. :D

-Robin

</body></email><email><emailId>20110927183742</emailId><senderName>Mauro</senderName><senderEmail>mrsanna1@gmail.com</senderEmail><timestampReceived>2011-09-27 18:37:42-0400</timestampReceived><subject>Re: [libvirt-users] how to convert from xen .cfg files to libvirt xml?</subject><body>

On 27 September 2011 19:24, Eric Blake &lt;eblake@redhat.com&gt; wrote:
&gt; On 09/27/2011 11:19 AM, Eric Blake wrote:
&gt;&gt;
&gt;&gt; On 09/27/2011 10:07 AM, Mauro wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; Thanks for your replay.
&gt;&gt;&gt; I've augmented debug level, run virsh domxml-from-native xen-xm
&gt;&gt;&gt; backupsrv.cfg and this is the error:
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; virsh: malloc.c:3097: sYSMALLOc: Assertion `(old_top == (((mbinptr)
&gt;&gt;
&gt;&gt; That's evil :( - this is a failure from glibc, which implies we've
&gt;&gt; corrupted the heap. Try running things under valgrind to find the culprit.

If I do virsh domxml-to-native xen-xm prova.xml it works with no
problems but if I do
virsh domxml-from-native xen-xm backupsrv.cfg I have the error.
Here is my backupsrv.cfg:

#
# Configuration file for the Xen instance backupsrv, created
# by xen-tools 4.2 on Mon Sep 26 13:29:57 2011.
#

#
#  Kernel + memory size
#


bootloader = '/usr/lib/xen-default/bin/pygrub'

vcpus       = '1'
memory      = '1024'

#
#  Disk device(s).
#
root        = '/dev/xvda2 ro'
disk        = [
                  'phy:/dev/vg-xen-domUs/backupsrv-disk,xvda2,w',
                  'phy:/dev/vg-xen-domUs/backupsrv-swap,xvda1,w',
              ]

#
#  Physical volumes
#


#
#  Hostname
#
name        = 'backupsrv'

#
#  Networking
#
vif         = [ 'ip=192.168.245.10,mac=00:16:3E:65:8E:86,bridge=xenbr.119' ]

#
#  Behaviour
#
on_poweroff = 'destroy'
on_reboot   = 'restart'
on_crash    = 'restart'

</body></email><email><emailId>20110928170050</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-09-28 17:00:50-0400</timestampReceived><subject>Re: [libvirt-users] Snapshot Error</subject><body>

On 09/26/2011 08:31 PM, huachao yao wrote:
&gt; Hey
&gt; When I want to take a snapshot for a Domain by using
&gt; virDomainSnapshotCreateXML. The Error as below happen:
&gt;
&gt; libvir: QEMU error : Requested operation is not valid: Disk
&gt; '/var/lib/libvirt/images/fedora-qcow.qcow2' does not support snapshotting

Can you also post the XML of the domain, as in 'virsh dumpxml dom'?  I 
suspect that your xml is either omitting the driver type (making libvirt 
have to probe, if qemu.conf allows probing, which is a security risk), 
or calling out raw instead of qcow2 (as in the following example):

   &lt;devices&gt;
     &lt;disk ...&gt;
       &lt;driver name='qemu' type='qcow2'/&gt;

Libvirt refuses to do system checkpoints with internal disk snapshots if 
a disk is not explicitly qcow2, which explains the message you are getting.

&gt;
&gt; The snapshot Configuration is :
&gt; &lt;domainsnapshot&gt;
&gt;    &lt;description&gt;Snapshot of OS install and updates&lt;/description&gt;
&gt;    &lt;disks&gt;
&gt;      &lt;disk name='/var/lib'&gt;
&gt;        &lt;source file='/var/lib-snapshot'/&gt;
&gt;      &lt;/disk&gt;
&gt;      &lt;disk name='vdb' snapshot='no'/&gt;
&gt;    &lt;/disks&gt;
&gt; &lt;/domainsnapshot&gt;

This makes it look like you are trying to do a disk snapshot.  Are you 
passing the VIR_DOMAIN_SNAPSHOT_CREATE_DISK_ONLY flag?  If so, your 
error message doesn't make sense (that requests external snapshots, 
which don't have a restriction on a qcow2-only source).  If not, it 
means your &lt;disks&gt; designation is being ignored (without the DISK_ONLY 
flag, you are requesting a system checkpoint, which currently uses 
internal disk snapshots without regards to any &lt;disks&gt; element).

&gt;
&gt; And /var/lib/libvirt/images/fedora-qcow.qcow2 is the disk for the domain
&gt; (use qemu-img to create). And I had tried another Disk format
&gt; (*.img), but the error still happen. how can i deal with this error??
&gt;
&gt; PS:qemu version is 0.14&amp;  libvirt version is 0.9.4.  Pls help.   :-(

Oh, 0.9.4 doesn't have the DISK_ONLY flag, and doesn't know how to parse 
&lt;disks&gt; in the first place.  For that, you need 0.9.5 or newer.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20110929065812</emailId><senderName>Magicloud Magiclouds</senderName><senderEmail>magicloud.magiclouds@gmail.com</senderEmail><timestampReceived>2011-09-29 06:58:12-0400</timestampReceived><subject>Re: [libvirt-users] virsh cannot list broken guest.</subject><body>

On Thu, Sep 29, 2011 at 2:53 PM, Magicloud Magiclouds
&lt;magicloud.magiclouds@gmail.com&gt; wrote:
&gt; On Thu, Sep 29, 2011 at 2:08 PM, Magicloud Magiclouds
&gt; &lt;magicloud.magiclouds@gmail.com&gt; wrote:
&gt;&gt; Hi,
&gt;&gt;  I am starting to learn using libvirt with kvm on CentOS 6.
&gt;&gt;  Just used this command to start a guest:
&gt;&gt; virt-install -ntest -r1024 --vcpus=1
&gt;&gt; -c/var/lib/libvirt/images/CentOS-6.0-x86_64-netinstall.iso
&gt;&gt; --os-type=linux --os-variant=rhel6 --disk vol=kvmguests/test --vnc -v
&gt;&gt; --virt-type=kvm --check-cpu --prompt --arch=x86_64
&gt;&gt;  Then I found out that I misconfigured vnc. And I do not know how to
&gt;&gt; gracefully stop qemu. So I killed it.
&gt;&gt;  Then with the command, I got:
&gt;&gt; ERROR    Guest name 'test' is already in use.
&gt;&gt; What is the name of your virtual machine?
&gt;&gt;  But at this time, there is nothing listed in virsh:
&gt;&gt; Welcome to virsh, the virtualization interactive terminal.
&gt;&gt;
&gt;&gt; Type:  'help' for help with commands
&gt;&gt;       'quit' to quit
&gt;&gt;
&gt;&gt; virsh # list
&gt;&gt;  Id Name                 State
&gt;&gt; ----------------------------------
&gt;&gt;
&gt;&gt; virsh # connect qemu:///system
&gt;&gt;
&gt;&gt; virsh # list
&gt;&gt;  Id Name                 State
&gt;&gt; ----------------------------------
&gt;&gt;
&gt;&gt; virsh #
&gt;&gt;
&gt;&gt;  What should I do?
&gt;&gt; --
&gt;&gt; 竹密岂妨流水过
&gt;&gt; 山高哪阻野云飞
&gt;&gt;
&gt;
&gt; Seems like it is not only broken guests.
&gt; I just installed another one. And successful. But still, nothing
&gt; listed in virsh.
&gt;
&gt; --
&gt; 竹密岂妨流水过
&gt; 山高哪阻野云飞
&gt;

I am stupid. Please ignore this.

-- 
竹密岂妨流水过
山高哪阻野云飞

</body></email><email><emailId>20110929140831</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-09-29 14:08:31-0400</timestampReceived><subject>[libvirt-users] ANNOUNCE: Perl binding release Sys-Virt version 0.9.5</subject><body>

I am pleased to announce a new release of the Perl binding, Sys::Virt
version 0.9.5, is now available for download:

  http://search.cpan.org/CPAN/authors/id/D/DA/DANBERR/Sys-Virt-0.9.5.tar.gz

Changes in this release

 - Add all new APIs in libvirt 0.9.5
 - Add missing snapshot creation/lookup methods
 - Fix typo in method listing snapshots
 - Add missing snapshot constant
 - Add example for save/restore usage
 - Re-add abort job binding accidentally deleted

All historical releases and online documentation are available from the
CPAN page

   http://search.cpan.org/dist/Sys-Virt/

There is no planned update for libvirt 0.9.6, since that did not introduce
any new APIs that require work in the Perl layer.

Regards,
Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110930034513</emailId><senderName>Magicloud Magiclouds</senderName><senderEmail>magicloud.magiclouds@gmail.com</senderEmail><timestampReceived>2011-09-30 03:45:13-0400</timestampReceived><subject>Re: [libvirt-users] Second VM cannot get dhcp ip in NAT mode</subject><body>

On Fri, Sep 30, 2011 at 10:34 AM, Magicloud Magiclouds
&lt;magicloud.magiclouds@gmail.com&gt; wrote:
&gt; Hi,
&gt;  Yesterday I started to use libvirt with kvm under centos6. The first
&gt; VM works great.
&gt;  Today I added another VM and start to initialize with virt-install.
&gt;  Well, it seems that, the second VM cannot get dhcp ip. I did not
&gt; change the default libvirt network configuration.
&gt;  What should I do?
&gt; --
&gt; 竹密岂妨流水过
&gt; 山高哪阻野云飞
&gt;

So it is not a dhcp issue.
Fixed ip did not work. Stop the first one did not help.
Seems like the second VM just cannot use the network.

-- 
竹密岂妨流水过
山高哪阻野云飞

</body></email><email><emailId>20110930045608</emailId><senderName>Alex</senderName><senderEmail>mysqlstudent@gmail.com</senderEmail><timestampReceived>2011-09-30 04:56:08-0400</timestampReceived><subject>[libvirt-users] win7 instance just disappears</subject><body>

Hi,
I have a fedora15 box with a win7 kvm instance that has been running
for some time, but lately it seems to just crash and disappear without
any idea of what happened. It's never happened while I have been using
it, only when the instance is idle.

I usually start the instance using virt-manager, but also start it
just using "virsh start mykvm" then access it using the spicec client.

I can't find any logging information to indicate why this is happening
or how to go about fixing it.

I've tried accessing it using the normal virt-manager client as well
as the spicec client an it doesn't make any difference.

When it crashes, the whole process is gone. Is there something that
could cause it to do this when the system is idle?

I also installed the qxl video drivers
(qxl-win-0.1010-20110308-d9eb3203bd) some time ago, so it could
possibly be related to that.

I thought it might be helpful to have a copy of the qemu XML file:

&lt;domain type='kvm'&gt;
  &lt;name&gt;alex-win7&lt;/name&gt;
  &lt;uuid&gt;f7decb31-88cf-d003-8716-66258550b996&lt;/uuid&gt;
  &lt;memory&gt;3145728&lt;/memory&gt;
  &lt;currentMemory&gt;3145728&lt;/currentMemory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='x86_64' machine='pc-0.14'&gt;hvm&lt;/type&gt;
    &lt;boot dev='hd'/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
    &lt;apic/&gt;
    &lt;pae/&gt;
  &lt;/features&gt;
  &lt;cpu match='exact'&gt;
    &lt;model&gt;Opteron_G3&lt;/model&gt;
    &lt;vendor&gt;AMD&lt;/vendor&gt;
    &lt;feature policy='require' name='skinit'/&gt;
    &lt;feature policy='require' name='vme'/&gt;
    &lt;feature policy='require' name='mmxext'/&gt;
    &lt;feature policy='require' name='fxsr_opt'/&gt;
    &lt;feature policy='require' name='cr8legacy'/&gt;
    &lt;feature policy='require' name='ht'/&gt;
    &lt;feature policy='require' name='3dnowprefetch'/&gt;
    &lt;feature policy='require' name='3dnowext'/&gt;
    &lt;feature policy='require' name='wdt'/&gt;
    &lt;feature policy='require' name='extapic'/&gt;
    &lt;feature policy='require' name='pdpe1gb'/&gt;
    &lt;feature policy='require' name='osvw'/&gt;
    &lt;feature policy='require' name='cmp_legacy'/&gt;
    &lt;feature policy='require' name='3dnow'/&gt;
  &lt;/cpu&gt;
  &lt;clock offset='localtime'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;restart&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/bin/qemu-kvm&lt;/emulator&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;driver name='qemu' type='raw'/&gt;
      &lt;source file='/home/libvirt-images/alex-win7.img'/&gt;
      &lt;target dev='hda' bus='ide'/&gt;
      &lt;address type='drive' controller='0' bus='0' unit='0'/&gt;
    &lt;/disk&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;driver name='qemu' type='raw'/&gt;
      &lt;source file='/home/libvirt-images/alex-win7a-2.img'/&gt;
      &lt;target dev='vda' bus='virtio'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x06'
function='0x0'/&gt;
    &lt;/disk&gt;
    &lt;controller type='ide' index='0'&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x01'
function='0x1'/&gt;
    &lt;/controller&gt;
    &lt;controller type='virtio-serial' index='0'&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x07'
function='0x0'/&gt;
    &lt;/controller&gt;
    &lt;interface type='bridge'&gt;
      &lt;mac address='52:54:00:6c:6c:47'/&gt;
      &lt;source bridge='br0'/&gt;
      &lt;model type='virtio'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03'
function='0x0'/&gt;
    &lt;/interface&gt;
    &lt;serial type='pty'&gt;
      &lt;target port='0'/&gt;
    &lt;/serial&gt;
    &lt;console type='pty'&gt;
      &lt;target type='serial' port='0'/&gt;
    &lt;/console&gt;
    &lt;channel type='spicevmc'&gt;
      &lt;target type='virtio' name='com.redhat.spice.0'/&gt;
      &lt;address type='virtio-serial' controller='0' bus='0' port='1'/&gt;
    &lt;/channel&gt;
    &lt;input type='mouse' bus='ps2'/&gt;
    &lt;graphics type='spice' autoport='yes'/&gt;
    &lt;sound model='ich6'&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x04'
function='0x0'/&gt;
    &lt;/sound&gt;
    &lt;video&gt;
      &lt;model type='qxl' vram='9216' heads='1'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x02'
function='0x0'/&gt;
    &lt;/video&gt;
    &lt;memballoon model='virtio'&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x05'
function='0x0'/&gt;
    &lt;/memballoon&gt;
  &lt;/devices&gt;
&lt;/domain&gt;

Thanks,
Alex

</body></email><email><emailId>20110930093921</emailId><senderName>Anselmo</senderName><senderEmail>anselmo@darviniano.eu</senderEmail><timestampReceived>2011-09-30 09:39:21-0400</timestampReceived><subject>[libvirt-users] Difficutlies with lp port</subject><body>

Hello,

I'm using libvirt on debian as host and Windows XP Home as guest.
I would like to pass the /dev/parport0 to XP to attach a printer.

I use virt-manager. When I add a parallel port as a "dev" type I got 
this conf file:
....
&lt;parallel type='dev'&gt;
       &lt;source path='/dev/parport0'/&gt;
       &lt;target port='0'/&gt;
&lt;/parallel&gt;
....

And this command line:

....
-chardev tty,id=charparallel0,path=/dev/parport0
-device isa-parallel,chardev=charparallel0,id=parallel0
....

The first parameter is "tty".Should not it be "parport"?


Anyway I never see any parallel port on the guest with these options. 
Even starting kvm from the command line.

While is seems to work immediatly using the kvm option:
"-parallel /dev/parport0"

Where i've made a mistake? Or how can I just tell libvirt to use the 
"-parallel" option instead.

Thank's for your help
Anselmo Luginbühl

</body></email><email><emailId>20110815104155</emailId><senderName>"lisiyang"</senderName><senderEmail>lisiyang_best@sina.com</senderEmail><timestampReceived>2011-08-15 10:41:55-0400</timestampReceived><subject>[libvirt-users] does kvm support SATA driver?</subject><body>

Hi,

I encounter a problem. My virtual machine is windows 7 . I install it using
bus ide. There is not any problem until now. but when I want to attach a
disk to it(bus=scsi ) , the os can¡¯t find the suitable SCSI driver. I
search the problem on the internet ,it seems that the windows7 don¡¯t
support SCSI driver. So ,I want attach the disk to vm using SATA. So I want
to know that whether the kvm support SATA driver and whether the kvm support
USB 2.0?

Hope for reply. Thank in advance.

 

 

Thanks &amp; Best Regards,

----------------------------------------------------
Li, Si Yang(ÀîË¼Ñï)

Beijing University of Posts and Telecommunications , Beijing
Internet e-mail:lisiyang_best@sina.com
Address: Road 10 Xitucheng, Haidian District, Beijing 100876 
----------------------------------------------------

 


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;&lt;head&gt;&lt;meta http-equiv=Content-Type \
content="text/html; charset=gb2312"&gt;&lt;meta name=Generator content="Microsoft Word 12 \
(filtered medium)"&gt;&lt;style&gt;&lt;!-- /* Font Definitions */
@font-face
	{font-family:ËÎÌå;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"\@ËÎÌå";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;}
/* Page Definitions */
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;}
div.WordSection1
	{page:WordSection1;}
--&gt;&lt;/style&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapelayout v:ext="edit"&gt;
&lt;o:idmap v:ext="edit" data="1" /&gt;
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;&lt;/head&gt;&lt;body lang=ZH-CN link=blue vlink=purple \
style='text-justify-trim:punctuation'&gt;&lt;div class=WordSection1&gt;&lt;p \
class=MsoNormal&gt;&lt;span lang=EN-US&gt;Hi,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;I encounter a problem. My virtual machine is windows 7 . I install it \
using bus ide. There is not any problem until now. but when I want to attach a disk \
to it(bus=scsi ) , the os can¡¯t find the suitable SCSI driver. I search the problem \
on the internet ,it seems that the windows7 don¡¯t support SCSI driver. So ,I want \
attach the disk to vm using SATA. So I want to know that whether the kvm support SATA \
driver and whether the kvm support USB 2.0?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span lang=EN-US&gt;Hope for reply. Thank in \
advance.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span lang=EN-US \
style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;Thanks &amp; Best \
Regards,&lt;br&gt;&lt;br&gt;----------------------------------------------------&lt;br&gt;Li, Si \
Yang(&lt;/span&gt;&lt;span style='font-size:10.0pt;font-family:ËÎÌå'&gt;ÀîË¼Ñï&lt;/span&gt;&lt;span \
lang=EN-US style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;)&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
class=MsoNormal&gt;&lt;span lang=EN-US \
style='font-size:10.0pt;font-family:"Arial","sans-serif";color:black'&gt;Beijing \
University of Posts and Telecommunications&lt;/span&gt;&lt;span lang=EN-US \
style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt; , Beijing&lt;br&gt;Internet \
e-mail:lisiyang_best@sina.com&lt;br&gt;Address: Road 10 Xitucheng, Haidian District, \
Beijing 100876 &lt;br&gt;----------------------------------------------------&lt;/span&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20110815144051</emailId><senderName>Jeff</senderName><senderEmail>jwk1230@gmail.com</senderEmail><timestampReceived>2011-08-15 14:40:51-0400</timestampReceived><subject>[libvirt-users] Question about terminology</subject><body>

I'm having a minor disagreement with a colleague over terminology.

When you have a group of KVM Hosts which have access to the same network and storage \
(for purposes of migration) yet there is no clusterware or HA software involved...how \
does one refer to this group of hosts? I call them a "Host Group." He insists on the \
term "Cluster."  

To me, "cluster" indicates the presence of an HA solution such as RHCS or VCS and \
using the term when neither exist would generate confusion.  He insists that since \
VMWare refers to the same configuration as a "cluster" that this is how we should \
refer to it with regard to KVM.

Wouldn't be that big of a deal, except that I'm trying to develop operational \
documentation.  Anyone else out there have suggestions?

Jeff


</body></email><email><emailId>20110817122312</emailId><senderName>Julien Garet</senderName><senderEmail>julien.garet@inria.fr</senderEmail><timestampReceived>2011-08-17 12:23:12-0400</timestampReceived><subject>[libvirt-users] virt-install -&gt; guest stops at installation end</subject><body>

Hello, 

I am using virt-install to install CentOS6 guests on a CentOS6 KVM remote host. \
Everything works fine except that at the end of the installation, the guest stops \
instead of rebooting, which I thought, should be the default behaviour. 




The command I use is : 
[root@myorchestrator]# /usr/local/bin/virt-install --connect \
qemu+ssh://root@mydom0/system --name myclient --accelerate --ram 2048 --disk \
path=/mnt/client.img,size=10 --os-type=linux --network bridge:mybridge --vnc --pxe -m \
52:54:00:00:3d:a9 


virt-install version is 0.500.6 on the host where I use virt-install. libvirt is \
version 0.8.1 (CentOS 6) on dom0. 


Any advice ? 


Julien Garet 


[Attachment #3 (text/html)]

&lt;html&gt;&lt;head&gt;&lt;style type='text/css'&gt;p { margin: 0; }&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div \
style='font-family: Times New Roman; font-size: 12pt; color: #000000'&gt;&lt;span \
style="color: rgb(0, 0, 0); font-family: 'Times New Roman'; font-size: 12pt; \
"&gt;Hello,&lt;br&gt;&lt;br&gt;&lt;span name="x"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 0); \
font-family: 'Times New Roman'; font-size: 12pt; "&gt;I am using virt-install to install \
CentOS6 guests on a CentOS6 KVM remote host. Everything works fine except that at the \
end of the installation, the guest stops instead of rebooting, which I thought, \
should be the default behaviour.&lt;br&gt;&lt;/span&gt;&lt;div&gt;&lt;div style="color: rgb(0, 0, 0); \
font-family: 'Times New Roman'; font-size: 12pt; "&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div \
style="color: rgb(0, 0, 0); font-family: 'Times New Roman'; font-size: 12pt; \
"&gt;&lt;span&gt;The command I use is : &lt;/span&gt;&lt;/div&gt;&lt;div&gt;[root@myorchestrator]# \
/usr/local/bin/virt-install --connect qemu+ssh://root@mydom0/system --name myclient \
--accelerate --ram 2048 --disk path=/mnt/client.img,size=10 --os-type=linux --network \
bridge:mybridge --vnc --pxe -m \
52:54:00:00:3d:a9&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;virt-install version is 0.500.6 on the \
host where I use virt-install. libvirt is version 0.8.1 (CentOS 6) on \
dom0.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Any advice ?&lt;/div&gt;&lt;div style="color: rgb(0, 0, 0); \
font-family: 'Times New Roman'; font-size: 12pt; "&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div \
style="color: rgb(0, 0, 0); font-family: 'Times New Roman'; font-size: 12pt; \
"&gt;&lt;span&gt;Julien Garet&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20110801221116</emailId><senderName>Jonathan Stoppani</senderName><senderEmail>jonathan@stoppani.name</senderEmail><timestampReceived>2011-08-01 22:11:16-0400</timestampReceived><subject>[libvirt-users] Migration hangs on Gentoo with KVM</subject><body>

Hi there,

I'm trying to migrate a domain between two Gentoo hosts using KVM as hypervisor, but \
the migration hangs. I tried both live or offline migration modes without success.

Details below.

Anyone has an idea of what could be wrong with my setup? The migration is the only \
thing not working.



Host A (initially running the VM)
=================================

# uname -a
Linux pion 2.6.39-gentoo-r3 #12 SMP Fri Jul 29 23:57:49 MST 2011 x86_64 AMD \
Opteron(tm) Processor 6174 AuthenticAMD GNU/Linux

# kvm --version
QEMU emulator version 0.14.1 (qemu-kvm-0.14.1), Copyright (c) 2003-2008 Fabrice \
Bellard

# libvirtd --version
libvirtd (libvirt) 0.9.3

# cat /etc/libvirt/libvirtd.conf
http://dpaste.com/hold/583874/

# cat /etc/libvirt/qemu.conf
http://dpaste.com/hold/583873/

# /etc/init.d/libvirtd start

# cat /var/log/libvirt/libvirtd.log
http://pastebin.com/V615fgbK

# virsh create descriptions/domain.xml

# cat descriptions/domain.xml
http://dpaste.com/583880/

# cat /var/log/libvirt/libvirtd.log
http://pastebin.com/0PSDAZhN (startup log removed)

# cat /var/log/libvirt/qemu/nd-50f05b3-0.log
http://dpaste.com/583877/

# virsh migrate nd-50f05b3-0 qemu+ssh://host-b/system
Password:
--&gt; Never exits

# cat /var/log/libvirt/libvirtd.log
http://pastebin.com/EqHBHx8R (startup and domain creation log removed)

# virsh list
 Id Name                 State
----------------------------------
  1 nd-50f05b3-0         paused



Host B (destination host)
=========================

# uname -a
Linux lenny 2.6.39-gentoo-r3 #6 SMP Fri Jul 29 18:58:08 MST 2011 x86_64 Intel(R) \
Xeon(R) CPU 3040 @ 1.86GHz GenuineIntel GNU/Linux

# kvm --version
QEMU emulator version 0.14.1 (qemu-kvm-0.14.1), Copyright (c) 2003-2008 Fabrice \
Bellard

# libvirtd --version
libvirtd (libvirt) 0.9.3

# cat /etc/libvirt/libvirtd.conf
http://dpaste.com/hold/583874/ (same as host A)

# cat /etc/libvirt/
http://dpaste.com/hold/583873/ (same as host A)

# /etc/init.d/libvirtd start

# cat /var/log/libvirt/libvirtd.log
http://pastebin.com/WnyqubU6

--&gt; Start migration

# cat /var/log/libvirt/libvirtd.log
http://pastebin.com/E45JtvGd (startup log removed)

# virsh list
 Id Name                 State
----------------------------------
  1 nd-50f05b3-0         paused



Additional notes
================

 * The process seams to deadlock somewhere, CPU usage is near to 0%
 * The disk images are available on both hosts at the same location (I'm using a COW2 \
                image based on another COW2 image, both are available)
 * The shared FS is mounted through fuse-sshfs
 * I just noticed that my clocks are skewed. I will rerun the whole test with a \
correctly setup ntp server, but I had the same problem last week with perfectly \
synchronized clocks, so I doubt this will make a difference.


Thanks very much,
Jonathan


</body></email><email><emailId>20110817173626</emailId><senderName>Gareth S Bestor</senderName><senderEmail>bestor@us.ibm.com</senderEmail><timestampReceived>2011-08-17 17:36:26-0400</timestampReceived><subject>[libvirt-users] which vols added to storage pool during refresh?</subject><body>

This is a multipart message in MIME format.
--=_alternative 0060B576882578EF_=
Content-Type: text/plain; charset="US-ASCII"

(opps, actually meant to post this to libvirt-users instead of 
libvirt-cim...)


We're looking at a problem when we have a libvirt pool defined, below 

[root@xnl2192 ~]# virsh pool-dumpxml ScsiPool-host2 
&lt;pool type='scsi'&gt; 
  &lt;name&gt;ScsiPool-host2&lt;/name&gt; 
  &lt;uuid&gt;f2ea1882-881f-9f49-838d-39e070f68002&lt;/uuid&gt; 
  &lt;capacity&gt;136583315456&lt;/capacity&gt; 
  &lt;allocation&gt;136583315456&lt;/allocation&gt; 
  &lt;available&gt;0&lt;/available&gt; 
  &lt;source&gt; 
    &lt;adapter name='host2'/&gt; 
  &lt;/source&gt; 
  &lt;target&gt; 
    &lt;path&gt;/dev/disk/by-id&lt;/path&gt; 
    &lt;permissions&gt; 
      &lt;mode&gt;0700&lt;/mode&gt; 
      &lt;owner&gt;-1&lt;/owner&gt; 
      &lt;group&gt;-1&lt;/group&gt; 
    &lt;/permissions&gt; 
  &lt;/target&gt; 
&lt;/pool&gt; 

As you can see, this pool maps to /dev/disk/by-id. There may be a large 
number of actual volume entries in /dev/disk/by-id, however it appears 
only a distinct subset of them are actually added into the libvirt pool 
when you do a pool-refresh. What does libvirt check when determining 
which, and whether or not, to add one of these volume into the vol-list? 

In particular, we have a case when one specific volume in /dev/disk/by-id 
is *not* added into the pool, and no amount of pool-refresh makes a 
difference. We did notice that if you remove all the sym links in 
/dev/disk/by-id and do a pool-refresh, that libvirt re-scans the bus, 
recreates the links in /dev/disk/by-id, and adds (some of) the volumes 
back into the vol-list. But not this one problematic vol, so clearly there 
is something about this vol that libvirt doesnt like and why it is 
(deliberately?) not added to the pool. 

What checks, etc does libvirt make against vols when determining whether 
to add them to a pool? 

- G 

Dr. Gareth S. Bestor
IBM Senior Software Engineer
Systems &amp; Technology Group - Systems Management Standards
971-285-6375 (mobile)
bestor@us.ibm.com_______________________________________________
Libvirt-cim mailing list
Libvirt-cim@redhat.com
https://www.redhat.com/mailman/listinfo/libvirt-cim
--=_alternative 0060B576882578EF_=
Content-Type: text/html; charset="US-ASCII"


&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;(opps, actually meant to post this to
libvirt-users instead of libvirt-cim...)&lt;/font&gt;
&lt;br&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;&lt;br&gt;
We're looking at a problem when we have a libvirt pool defined, below&lt;/font&gt;&lt;font \
size=3&gt; &lt;br&gt;
&lt;/font&gt;&lt;font size=2 face="sans-serif"&gt;&lt;br&gt;
[root@xnl2192 ~]# virsh pool-dumpxml ScsiPool-host2&lt;/font&gt;&lt;font size=3&gt;
&lt;/font&gt;&lt;font size=2 face="sans-serif"&gt;&lt;br&gt;
&lt;pool type='scsi'&gt;&lt;/font&gt;&lt;font size=3&gt; &lt;/font&gt;&lt;font size=2 \
face="sans-serif"&gt;&lt;br&gt;   &lt;name&gt;ScsiPool-host2&lt;/name&gt;&lt;/font&gt;&lt;font \
size=3&gt; &lt;/font&gt;&lt;font size=2 face="sans-serif"&gt;&lt;br&gt;  \
 &lt;uuid&gt;f2ea1882-881f-9f49-838d-39e070f68002&lt;/uuid&gt;&lt;/font&gt;&lt;font \
size=3&gt; &lt;/font&gt;&lt;font size=2 face="sans-serif"&gt;&lt;br&gt;
  &lt;capacity&gt;136583315456&lt;/capacity&gt;&lt;/font&gt;&lt;font size=3&gt;
&lt;/font&gt;&lt;font size=2 face="sans-serif"&gt;&lt;br&gt;
  &lt;allocation&gt;136583315456&lt;/allocation&gt;&lt;/font&gt;&lt;font size=3&gt;
&lt;/font&gt;&lt;font size=2 face="sans-serif"&gt;&lt;br&gt;
  &lt;available&gt;0&lt;/available&gt;&lt;/font&gt;&lt;font size=3&gt; &lt;/font&gt;&lt;font size=2 \
face="sans-serif"&gt;&lt;br&gt;   &lt;source&gt;&lt;/font&gt;&lt;font size=3&gt; &lt;/font&gt;&lt;font size=2 \
face="sans-serif"&gt;&lt;br&gt;     &lt;adapter name='host2'/&gt;&lt;/font&gt;&lt;font \
size=3&gt; &lt;/font&gt;&lt;font size=2 face="sans-serif"&gt;&lt;br&gt;   &lt;/source&gt;&lt;/font&gt;&lt;font \
size=3&gt; &lt;/font&gt;&lt;font size=2 face="sans-serif"&gt;&lt;br&gt;   &lt;target&gt;&lt;/font&gt;&lt;font \
size=3&gt; &lt;/font&gt;&lt;font size=2 face="sans-serif"&gt;&lt;br&gt;    \
 &lt;path&gt;/dev/disk/by-id&lt;/path&gt;&lt;/font&gt;&lt;font size=3&gt; &lt;/font&gt;&lt;font \
size=2 face="sans-serif"&gt;&lt;br&gt;     &lt;permissions&gt;&lt;/font&gt;&lt;font size=3&gt; \
&lt;/font&gt;&lt;font size=2 face="sans-serif"&gt;&lt;br&gt;      \
 &lt;mode&gt;0700&lt;/mode&gt;&lt;/font&gt;&lt;font size=3&gt; &lt;/font&gt;&lt;font size=2 \
face="sans-serif"&gt;&lt;br&gt;       &lt;owner&gt;-1&lt;/owner&gt;&lt;/font&gt;&lt;font \
size=3&gt; &lt;/font&gt;&lt;font size=2 face="sans-serif"&gt;&lt;br&gt;
      &lt;group&gt;-1&lt;/group&gt;&lt;/font&gt;&lt;font size=3&gt;
&lt;/font&gt;&lt;font size=2 face="sans-serif"&gt;&lt;br&gt;
    &lt;/permissions&gt;&lt;/font&gt;&lt;font size=3&gt; &lt;/font&gt;&lt;font size=2 \
face="sans-serif"&gt;&lt;br&gt;   &lt;/target&gt;&lt;/font&gt;&lt;font size=3&gt; &lt;/font&gt;&lt;font size=2 \
face="sans-serif"&gt;&lt;br&gt; &lt;/pool&gt;&lt;/font&gt;&lt;font size=3&gt; &lt;br&gt;
&lt;/font&gt;&lt;font size=2 face="sans-serif"&gt;&lt;br&gt;
As you can see, this pool maps to /dev/disk/by-id. There may be a large
number of actual volume entries in /dev/disk/by-id, however it appears
only a distinct subset of them are actually added into the libvirt pool
when you do a pool-refresh. What does libvirt check when determining which,
and whether or not, to add one of these volume into the vol-list?&lt;/font&gt;&lt;font size=3&gt;
&lt;br&gt;
&lt;/font&gt;&lt;font size=2 face="sans-serif"&gt;&lt;br&gt;
In particular, we have a case when one specific volume in /dev/disk/by-id
is *not* added into the pool, and no amount of pool-refresh makes a difference.
We did notice that if you remove all the sym links in /dev/disk/by-id and
do a pool-refresh, that libvirt re-scans the bus, recreates the links in
/dev/disk/by-id, and adds (some of) the volumes back into the vol-list.
But not this one problematic vol, so clearly there is something about this
vol that libvirt doesnt like and why it is (deliberately?) not added to
the pool.&lt;/font&gt;&lt;font size=3&gt; &lt;br&gt;
&lt;/font&gt;&lt;font size=2 face="sans-serif"&gt;&lt;br&gt;
What checks, etc does libvirt make against vols when determining whether
to add them to a pool?&lt;/font&gt;&lt;font size=3&gt; &lt;br&gt;
&lt;/font&gt;&lt;font size=2 face="sans-serif"&gt;&lt;br&gt;
- G&lt;/font&gt;&lt;font size=3&gt; &lt;br&gt;
&lt;/font&gt;&lt;font size=2 face="sans-serif"&gt;&lt;br&gt;
Dr. Gareth S. Bestor&lt;br&gt;
IBM Senior Software Engineer&lt;br&gt;
Systems &amp; Technology Group - Systems Management Standards&lt;br&gt;
971-285-6375 (mobile)&lt;br&gt;
bestor@us.ibm.com&lt;/font&gt;&lt;tt&gt;&lt;font \
size=2&gt;_______________________________________________&lt;br&gt; Libvirt-cim mailing \
list&lt;br&gt; Libvirt-cim@redhat.com&lt;br&gt;
&lt;/font&gt;&lt;/tt&gt;&lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-cim"&gt;&lt;tt&gt;&lt;font \
                size=2&gt;https://www.redhat.com/mailman/listinfo/libvirt-cim&lt;/font&gt;&lt;/tt&gt;&lt;/a&gt;
                
--=_alternative 0060B576882578EF_=--


</body></email><email><emailId>20110816180401</emailId><senderName>Andy Joslin</senderName><senderEmail>libvirt@bandjos.com</senderEmail><timestampReceived>2011-08-16 18:04:01-0400</timestampReceived><subject>[libvirt-users] Detecting the last user of a connection has closed.</subject><body>

The documentation says something that concerns me:
http://libvirt.org/html/libvirt-libvirt.html#virConnectClose

      "It is possible for the last
virConnectClose&lt;http://libvirt.org/html/libvirt-libvirt.html#virConnectClose&gt;to
return a positive value if some
       other object still has a temporary reference to the connection,   but
the
       application should not try to further use a connection after the
       virConnectClose&lt;http://libvirt.org/html/libvirt-libvirt.html#virConnectClose&gt;that
matches the initial open."



The application I am working on requires that I know when the last thread
using this connection goes away, so I can properly cleanup some overhead.
 If I can't trust the return value of this call, how will I know that the
connection is indeed torn down?

Under what circumstances will the virConnectClose behave this way?

Thanks,

BTW, I am using 0.8.2

[Attachment #3 (text/html)]

&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The documentation says something that concerns me: \
&lt;/div&gt;&lt;div&gt;&lt;a href="http://libvirt.org/html/libvirt-libvirt.html#virConnectClose"&gt;http://libvirt.org/html/libvirt-libvirt.html#virConnectClose&lt;/a&gt; \
&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;      "It is possible for the last &lt;a \
href="http://libvirt.org/html/libvirt-libvirt.html#virConnectClose"&gt;virConnectClose&lt;/a&gt;
  to return a positive value if some &lt;/div&gt;&lt;div&gt;       other object still has a \
temporary  reference to the connection,   but the &lt;/div&gt;&lt;div&gt;       application \
should not try to  further use a connection after the &lt;/div&gt;&lt;div&gt;       &lt;a \
href="http://libvirt.org/html/libvirt-libvirt.html#virConnectClose"&gt;virConnectClose&lt;/a&gt; \
that matches the initial open."&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; \
&lt;br&gt;&lt;/div&gt;&lt;div&gt;The application I am working on requires that I know when the last \
thread using this connection goes away, so I can properly cleanup some overhead.  If \
I can't trust the return value of this call, how will I know that the connection \
is indeed torn down?  &lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Under what circumstances will the \
virConnectClose behave this \
way?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;BTW, I am using \
0.8.2&lt;/div&gt;



</body></email><email><emailId>20110820012724</emailId><senderName>mkey</senderName><senderEmail>mkey@inter7.jp</senderEmail><timestampReceived>2011-08-20 01:27:24-0400</timestampReceived><subject>[libvirt-users] Detaching LVM volume from Windows guest</subject><body>

Hello,

I have some difficulties regarding to above title. Windows as guest OS
is running on KVM(Ubuntu natty).
After attaching LVM volume to guest OS and did "safely remove device" in
guest windows, detaching volume was failed.

&gt; root@localhost:/opt/win# virsh detach-disk testwin vdc
&gt; error: Failed to detach disk
&gt; errpr: operation failed: detaching virtio-disk2 device failed: Device
'virtio-disk2' not found

But kvm(qemu?) seems like detaching device successfully.
&gt; root@localhost:/opt/win# virsh qemu-monitor-command testwin 'info block'
&gt; drive-virtio-disk0: type=hd removable=0
file=/opt/win/win2008server.virtio.img ro=0 drv=qcow2 encrypted=0

So, problem is, libvirt doesn't know detaching, but kvm(qemu) knows.
Again, please let me know if anybody has workaround.

P.S. at some website, I found "hotunplugging is not supported in current
libvirt", is that related on this matter?

Regards,
mkey


</body></email><email><emailId>20110823055256</emailId><senderName>David Cohen</senderName><senderEmail>cdavid@physics.technion.ac.il</senderEmail><timestampReceived>2011-08-23 05:52:56-0400</timestampReceived><subject>[libvirt-users] pool assumed to have 512B sector</subject><body>

Hi,
When creating a dedicated storage pool on a FC attached storage with sector 
size of 4096B and size of 2TB, the storage pool is created but reported as 1/8 
of it's size, the same follows for any volume created in the same storage 
pool:
            

#  virsh pool-info guest_images_disk
Name:           guest_images_disk
UUID:           30247222-c1fb-8749-b833-a73782198d26
State:          running
Persistent:     yes
Autostart:      yes
Capacity:       256.00 GB
Allocation:     122.07 MB                                                             \
                
Available:      255.88 GB


-- 
David Cohen
Grid Computing
Physics Department
Technion - Israel Institute of Technology

Phone: 972-4-8293668
Fax: 972-4-8295755
Cellular: 972-54-5385664


</body></email><email><emailId>20110823110829</emailId><senderName></senderName><senderEmail>info</senderEmail><timestampReceived>2011-08-23 11:08:29-0400</timestampReceived><subject>[libvirt-users] Problem to migrate virtual machine between two hosts with same uuid</subject><body>

hi at all,
i'm trying to migrate a vm between two host but fails, this is what
I did:

virsh # start win2008
Domain win2008 started

virsh # list
 Id Name                 State
----------------------------------
  1 win2008              running

virsh # migrate --live win2008 qemu+ssh://host2/system
error: internal error Attempt to migrate guest to the same host 
00010203-0405-0607-0809-0a0b0c0d0e0f

if I type on both hosts:

host1
virsh # sysinfo

.......
  &lt;system&gt;
    &lt;entry name='manufacturer'&gt;Supermicro&lt;/entry&gt;
    &lt;entry name='product'&gt;X9SCL/X9SCM&lt;/entry&gt;
    &lt;entry name='version'&gt;0123456789&lt;/entry&gt;
    &lt;entry name='serial'&gt;0123456789&lt;/entry&gt;
    &lt;entry name='uuid'&gt;00010203-0405-0607-0809-0A0B0C0D0E0F&lt;/entry&gt;
    &lt;entry name='sku'&gt;To be filled by O.E.M.&lt;/entry&gt;
    &lt;entry name='family'&gt;To be filled by O.E.M.&lt;/entry&gt;
  &lt;/system&gt;
........
 
 
host2
virsh # sysinfo

.......
  &lt;system&gt;
    &lt;entry name='manufacturer'&gt;Supermicro&lt;/entry&gt;
    &lt;entry name='product'&gt;X9SCL/X9SCM&lt;/entry&gt;
    &lt;entry name='version'&gt;0123456789&lt;/entry&gt;
    &lt;entry name='serial'&gt;0123456789&lt;/entry&gt;
    &lt;entry name='uuid'&gt;00010203-0405-0607-0809-0A0B0C0D0E0F&lt;/entry&gt;
    &lt;entry name='sku'&gt;To be filled by O.E.M.&lt;/entry&gt;
    &lt;entry name='family'&gt;To be filled by O.E.M.&lt;/entry&gt;
  &lt;/system&gt;

........

The problem seems to be the same uuid on both hosts, 

1) is correct?
2) if is correct, how I can resolve?

Thanks a lot in advance

Umberto




-- 
------------------------------------------

  mediaus
  around the web

  Via Romana, 2143 - 55100 Antraccoli - LUCCA
  Web: http://www.mediaus.it
  Tel.:  +39 (0) 583 493745/464501
  Mob. +39 349.5422881
  Fax.:  +39 (0) 583 471420
  Mailto:info@mediaus.it

</body></email><email><emailId>20110823185000</emailId><senderName>Yih-Herng Chuang</senderName><senderEmail>yihherng@us.ibm.com</senderEmail><timestampReceived>2011-08-23 18:50:00-0400</timestampReceived><subject>[libvirt-users] migration in parallel</subject><body>

Hi,

We ran into various errors when tried to run migration in parallel.  Does
libvirt support migration in parallel?

Regards,

--Yih

Yih-Herng Chuang
IBM Center for Microsoft Technologies
3600 Carillon Point, Kirkland WA 98033
(DID) (425) 803-7285
(TIE) 977-7285
YihHerng@us.ibm.com
[Attachment #3 (text/html)]

&lt;html&gt;&lt;body&gt;
&lt;p&gt;Hi,&lt;br&gt;
&lt;br&gt;
We ran into various errors when tried to run migration in parallel.  Does libvirt \
support migration in parallel?&lt;br&gt; &lt;br&gt;
Regards,&lt;br&gt;
&lt;br&gt;
--Yih&lt;br&gt;
&lt;br&gt;
Yih-Herng Chuang&lt;br&gt;
IBM Center for Microsoft Technologies&lt;br&gt;
3600 Carillon Point, Kirkland WA 98033&lt;br&gt;
(DID) (425) 803-7285&lt;br&gt;
(TIE) 977-7285&lt;br&gt;
YihHerng@us.ibm.com&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20110823225614</emailId><senderName>Stephen Eilert</senderName><senderEmail>spedrosa@gmail.com</senderEmail><timestampReceived>2011-08-23 22:56:14-0400</timestampReceived><subject>[libvirt-users] Strange libvirt exit status 1 (LXC containers)</subject><body>


Hello,

I've encountered the following error, trying to start a domain:

error: internal error Child process \
(PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/X11R6/bin \
LIBVIRT_DEBUG=2 LIBVIRT_LOG_OUTPUTS=2:syslog:libvirtd /usr/libexec/libvirt_lxc --name \
vm_14 --console 18 --handshake 21 --background --veth veth1) status unexpected: exit \
status 1

I see nothing relevant in syslog, google searches have returned nothing. Starting \
libvirt_lxc manually seems to work (the process never returns), but of course the VMs \
do not start.

I am at a loss on what to do next. I'm running Ubuntu 10.04, which is itself a guest \
system running under virtual box (host is OSX Lion). I've compiled libvirt from git \
(using /usr as the --prefix, after removing the OS package), LXC containers are \
installed from a PPA, as the default Ubuntu kernel doesn't enable network namespaces. \
LXC itself doesn't appear to be a problem, as I can start VMs with lxc-start. Since I \
required libvirt's API, using LXC directly is not desirable.

Does anyone have any tips on what I should be looking for? Thanks.


-- Stephen


-- Domain definition follows:

&lt;domain type='lxc'&gt;
  &lt;name&gt;vm_14&lt;/name&gt;
  &lt;uuid&gt;9243fb5b-6b26-44af-7408-69c7f2d4ff03&lt;/uuid&gt;
  &lt;memory&gt;262144&lt;/memory&gt;
  &lt;currentMemory&gt;262144&lt;/currentMemory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='x86_64'&gt;exe&lt;/type&gt;
    &lt;init&gt;/sbin/init&lt;/init&gt;
  &lt;/os&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;preserve&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/libexec/libvirt_lxc&lt;/emulator&gt;
    &lt;filesystem type='mount' accessmode='passthrough'&gt;
      &lt;source dir='/var/lib/lxc/vmpea/rootfs/'/&gt;
      &lt;target dir='/'/&gt;
      &lt;readonly/&gt;
    &lt;/filesystem&gt;
    &lt;filesystem type='mount' accessmode='passthrough'&gt;
      &lt;source dir='/home/lxcadmin/repositories/14'/&gt;
      &lt;target dir='/home/lxcmaster'/&gt;
    &lt;/filesystem&gt;
    &lt;interface type='network'&gt;
      &lt;mac address='52:54:00:10:7a:e7'/&gt;
      &lt;source network='default'/&gt;
      &lt;target dev='veth0'/&gt;
    &lt;/interface&gt;
    &lt;console type='pty'&gt;
      &lt;target type='serial' port='0'/&gt;
    &lt;/console&gt;
  &lt;/devices&gt;
&lt;/domain&gt;


</body></email><email><emailId>20110823185633</emailId><senderName>Ohad Levy</senderName><senderEmail>ohadlevy@gmail.com</senderEmail><timestampReceived>2011-08-23 18:56:33-0400</timestampReceived><subject>[libvirt-users] libvirt ruby binding with vmware</subject><body>

Hi,

I've been trying to use the ruby libvirt binding with vmware esx on F15,
however it doesnt seems to work, I get:
Libvirt::ConnectionError: Call to virConnectOpen failed: Cannot access CA
certificate '/etc/pki/CA/cacert.pem': No such file or directory

I've using the same uri with virsh and it works.
it seems like somehow the no_verify is not passed, or we are back to old
libvirt error messages :)

any idea?

thanks,
Ohad

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I've been trying to use the ruby libvirt \
binding with vmware esx on F15, however it doesnt seems to work, I \
get:&lt;/div&gt;&lt;div&gt;&lt;div&gt;Libvirt::ConnectionError: Call to virConnectOpen failed: Cannot \
access CA certificate '/etc/pki/CA/cacert.pem': No such file or \
directory&lt;/div&gt; &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I've using the same uri with virsh and \
it works.&lt;/div&gt;&lt;div&gt;it seems like somehow the no_verify is not passed, or we are back \
to old libvirt error messages :)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;any idea?&lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;thanks,&lt;/div&gt;&lt;div&gt;Ohad&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20110826065457</emailId><senderName>Alphonse Hansel Anthony</senderName><senderEmail>alphonse.anthony@gmail.com</senderEmail><timestampReceived>2011-08-26 06:54:57-0400</timestampReceived><subject>[libvirt-users] Reg: Workaround to use pivot_root while using "rootfs" for "/" ?</subject><body>

Hi All,

   I am trying to start a lxc container using libvirt and I am facing an
issue due to pivot_root.

  The return code from the system call “pivot_root” is EINVAL (Invalid
arguments).
  I isolated the issue to this specific condition check within the system
call.

This is an code snippet from fs/namespace.c::pivot_root

*    error = -EINVAL;
    if (root.mnt-&gt;mnt_root != root.dentry)
        goto out2; /* not a mountpoint */
    if (root.mnt-&gt;mnt_parent == root.mnt)  &lt;&lt; this represents a circular
mount reference
            goto out2; /* not attached */
    if (new.mnt-&gt;mnt_root != new.dentry)
        goto out2; /* not a mountpoint */
    if (new.mnt-&gt;mnt_parent == new.mnt)
        goto out2; /* not attached */
*
This issue occurs for me, since I am using fstype "rootfs" as "/" and all
binaries are mounted ISO's for execution within "/".
Based on information from the below links, I have realized, that pivot_root
is not possible for the above case.*
**https://lkml.org/lkml/2005/10/8/17
https://bugzilla.kernel.org/show_bug.cgi?id=4857
*
I would like to know , if my observations are correct and is there any
workaround to overcome this issue?

Any help in this regard would be useful.

-Alphonse

[Attachment #3 (text/html)]

&lt;font size="2"&gt;&lt;span style="font-family: tahoma,sans-serif;"&gt;&lt;br&gt;Hi All,&lt;/span&gt;&lt;br \
style="font-family: tahoma,sans-serif;"&gt;&lt;br&gt;   I am trying to start a lxc container \
using libvirt and I am facing an issue due to pivot_root.&lt;br style="font-family: \
tahoma,sans-serif;"&gt; &lt;/font&gt;&lt;font style="font-family: tahoma,sans-serif;" \
face="Tahoma, Verdana, Helvetica, Arial" size="2"&gt;&lt;span&gt; &lt;br&gt;
  The return code from the system call “pivot_root” is EINVAL (Invalid \
arguments).&lt;br&gt;  I isolated the issue to this specific condition check within the \
system call.&lt;br&gt; &lt;br&gt;
This is an code snippet from fs/namespace.c::pivot_root&lt;br&gt;
  &lt;br&gt;
&lt;i&gt;    error = -EINVAL;&lt;br&gt;
    if (root.mnt-&gt;mnt_root != root.dentry)&lt;br&gt;
        goto out2; /* not a mountpoint */&lt;br&gt;
&lt;b&gt;    if (root.mnt-&gt;mnt_parent == root.mnt)  &lt;font color="#FF0000"&gt;&lt;&lt; this \
represents a circular mount reference &lt;br&gt; &lt;/font&gt;            goto out2; /* not \
attached */  &lt;br&gt; &lt;/b&gt;    if (new.mnt-&gt;mnt_root != new.dentry)&lt;br&gt;
        goto out2; /* not a mountpoint */&lt;br&gt;
    if (new.mnt-&gt;mnt_parent == new.mnt)&lt;br&gt;
        goto out2; /* not attached */&lt;br&gt;
&lt;/i&gt;&lt;br&gt;
This issue occurs for me, since I am using fstype "rootfs" as "/" \
and all binaries are mounted ISO's for execution within "/".&lt;br&gt;Based \
on information from the below links, I have realized, that pivot_root is not possible \
for the above case.&lt;b&gt;&lt;br&gt;

&lt;/b&gt;&lt;font color="#0000FF"&gt;&lt;u&gt;&lt;a \
href="https://lkml.org/lkml/2005/10/8/17"&gt;https://lkml.org/lkml/2005/10/8/17&lt;/a&gt;&lt;br&gt; \
&lt;a href="https://bugzilla.kernel.org/show_bug.cgi?id=4857"&gt;https://bugzilla.kernel.org/show_bug.cgi?id=4857&lt;/a&gt;&lt;br&gt;
 &lt;/u&gt;&lt;/font&gt;&lt;br&gt;I would like to know , if my observations are correct and is there \
any workaround to overcome this issue?&lt;br&gt;&lt;br&gt;Any help in this regard would be \
useful.&lt;br&gt;&lt;br&gt;-Alphonse&lt;br&gt; &lt;/span&gt;&lt;/font&gt;



</body></email><email><emailId>20110826031647</emailId><senderName>huachao yao</senderName><senderEmail>yao.d.hc@gmail.com</senderEmail><timestampReceived>2011-08-26 03:16:47-0400</timestampReceived><subject>[libvirt-users] Help!</subject><body>

Buddy, I am a noob in libvirt develop.
When I want to create a domain by using virDomainDefineXML and displays a
window on the host desktop. But when I add the line
" &lt;graphics type='sdl' display=':0.0'/&gt;"  into the config xml file, the
error as below will happen.
libvir: QEMU error : internal error process exited while connecting to
monitor: Could not initialize SDL(No available video device) - exiting
when I delete " &lt;graphics type='sdl' display=':0.0'/&gt;",I can create the
domain normally. Who can help me?!

The config xml file is as below:


&lt;domain type='qemu'&gt;
  &lt;name&gt;qemu_ubuntu_01&lt;/name&gt;
  &lt;memory&gt;219200&lt;/memory&gt;
  &lt;currentMemory&gt;219200&lt;/currentMemory&gt;
  &lt;vcpu&gt;2&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='x86_64' machine='pc'&gt;hvm&lt;/type&gt;
    &lt;boot dev='hd'/&gt;
    &lt;boot dev='cdrom'/&gt;
  &lt;/os&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/bin/qemu&lt;/emulator&gt;
    &lt;disk type='file' device='cdrom'&gt;
      &lt;source file='/root/Downloads/ubuntu-11.04-desktop-amd64.iso'/&gt;
      &lt;target dev='hdc' bus='ide'/&gt;
      &lt;readonly/&gt;
    &lt;/disk&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;source file='/var/lib/libvirt/images/winXP.img'/&gt;
      &lt;driver name='qemu' type='raw'/&gt;
      &lt;target dev='hda'/&gt;
    &lt;/disk&gt;
    &lt;video&gt;
      &lt;model type='cirrus' vram='9216' heads='1'&gt;
       &lt;acceleration accel3d='yes'/&gt;
      &lt;/model&gt;
    &lt;/video&gt;
    &lt;interface type='bridge'&gt;
      &lt;mac address='52:54:00:d8:65:c9'/&gt;
      &lt;source bridge='virbr0'/&gt;
    &lt;/interface&gt;
    &lt;input type='mouse' bus='ps2'/&gt;
    &lt;graphics type='vnc' port='10' listen='127.0.0.1'/&gt;
    &lt;graphics type='sdl' display=':0.0'/&gt;
  &lt;/devices&gt;
 &lt;/domain&gt;

[Attachment #3 (text/html)]

&lt;div&gt;&lt;font class="Apple-style-span"&gt;Buddy, I am a noob in libvirt \
develop.&lt;/font&gt;&lt;/div&gt;&lt;div&gt;When I want to create a domain by using&lt;font \
class="Apple-style-span" color="#3333FF"&gt; virDomainDefineXML &lt;/font&gt;and &lt;span \
class="Apple-style-span" style="font-family: Verdana, Arial, Helvetica, sans-serif; \
font-size: 13px; "&gt;displays a window on the host desktop. But when I add the line \
&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span class="Apple-style-span" style="font-family: Verdana, Arial, \
Helvetica, sans-serif; font-size: 13px; "&gt;&lt;font class="Apple-style-span" \
color="#CC0000"&gt;" &lt;graphics type='sdl' \
display=':0.0'/&gt;"  &lt;/font&gt;into the config xml file, the error as \
below will happen. &lt;/span&gt;&lt;/div&gt; &lt;font class="Apple-style-span" \
color="#CC0000"&gt;libvir: QEMU error : internal error process exited while connecting \
to monitor: Could not initialize SDL(No available video device) - \
exiting&lt;/font&gt;&lt;div&gt;when I delete &lt;span class="Apple-style-span" style="color: \
rgb(204, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13px; \
"&gt;" &lt;graphics type='sdl' \
display=':0.0'/&gt;",&lt;/span&gt;&lt;span class="Apple-style-span" \
style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13px; "&gt;I can \
create the domain normally. Who can help me?! &lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;font \
class="Apple-style-span" face="Verdana, Arial, Helvetica, \
sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="Verdana, \
Arial, Helvetica, sans-serif"&gt;The config xml file is as below:&lt;/font&gt;&lt;/div&gt; \
&lt;div&gt;&lt;font class="Apple-style-span" face="Verdana, Arial, Helvetica, \
sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="Verdana, \
Arial, Helvetica, sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" \
face="Verdana, Arial, Helvetica, sans-serif"&gt;&lt;div style="color: rgb(51, 0, 153); "&gt; \
&lt;domain type='qemu'&gt;&lt;/div&gt;&lt;div style="color: rgb(51, 0, 153); "&gt;  \
&lt;name&gt;qemu_ubuntu_01&lt;/name&gt;&lt;/div&gt;&lt;div style="color: rgb(51, 0, 153); "&gt;  \
&lt;memory&gt;219200&lt;/memory&gt;&lt;/div&gt;&lt;div style="color: rgb(51, 0, 153); "&gt;  \
&lt;currentMemory&gt;219200&lt;/currentMemory&gt;&lt;/div&gt;&lt;div style="color: rgb(51, 0, \
153); "&gt;  &lt;vcpu&gt;2&lt;/vcpu&gt;&lt;/div&gt;&lt;div style="color: rgb(51, 0, 153); "&gt;  \
&lt;os&gt;&lt;/div&gt;&lt;div style="color: rgb(51, 0, 153); "&gt;  &lt;type \
arch='x86_64' machine='pc'&gt;hvm&lt;/type&gt;&lt;/div&gt;&lt;div \
style="color: rgb(51, 0, 153); "&gt;    &lt;boot dev='hd'/&gt;&lt;/div&gt;&lt;div \
style="color: rgb(51, 0, 153); "&gt;    &lt;boot dev='cdrom'/&gt;&lt;/div&gt; &lt;div \
style="color: rgb(51, 0, 153); "&gt;  &lt;/os&gt;&lt;/div&gt;&lt;div style="color: rgb(51, 0, \
153); "&gt;  &lt;devices&gt;&lt;/div&gt;&lt;div style="color: rgb(51, 0, 153); "&gt;    \
&lt;emulator&gt;/usr/bin/qemu&lt;/emulator&gt;&lt;/div&gt;&lt;div style="color: rgb(51, 0, \
153); "&gt;  &lt;disk type='file' device='cdrom'&gt;&lt;/div&gt;&lt;div \
style="color: rgb(51, 0, 153); "&gt;      &lt;source \
file='/root/Downloads/ubuntu-11.04-desktop-amd64.iso'/&gt;&lt;/div&gt;&lt;div \
style="color: rgb(51, 0, 153); "&gt;  &lt;target dev='hdc' \
bus='ide'/&gt;&lt;/div&gt;&lt;div style="color: rgb(51, 0, 153); "&gt;      \
&lt;readonly/&gt;&lt;/div&gt;&lt;div style="color: rgb(51, 0, 153); "&gt;    \
&lt;/disk&gt;&lt;/div&gt;&lt;div style="color: rgb(51, 0, 153); "&gt;  &lt;disk \
type='file' device='disk'&gt;&lt;/div&gt;&lt;div style="color: rgb(51, 0, \
153); "&gt;      &lt;source \
file='/var/lib/libvirt/images/winXP.img'/&gt;&lt;/div&gt;&lt;div style="color: rgb(51, \
0, 153); "&gt;      &lt;driver name='qemu' type='raw'/&gt;&lt;/div&gt; &lt;div \
style="color: rgb(51, 0, 153); "&gt;      &lt;target dev='hda'/&gt;&lt;/div&gt;&lt;div \
style="color: rgb(51, 0, 153); "&gt;    &lt;/disk&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
class="Apple-style-span" color="#CC0000"&gt;    &lt;video&gt;&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font \
class="Apple-style-span" color="#CC0000"&gt;      &lt;model type='cirrus' \
vram='9216' heads='1'&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
class="Apple-style-span" color="#CC0000"&gt;      &lt;span class="Apple-tab-span" \
style="white-space:pre"&gt;	&lt;/span&gt;&lt;acceleration \
accel3d='yes'/&gt;&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font class="Apple-style-span" \
color="#CC0000"&gt;      &lt;/model&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" \
color="#CC0000"&gt;    &lt;/video&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style="color: rgb(51, 0, 153); "&gt; \
&lt;interface type='bridge'&gt;&lt;/div&gt; &lt;div style="color: rgb(51, 0, 153); "&gt;  \
&lt;mac address='52:54:00:d8:65:c9'/&gt;&lt;/div&gt;&lt;div style="color: rgb(51, 0, \
153); "&gt;      &lt;source bridge='virbr0'/&gt;&lt;/div&gt;&lt;div style="color: rgb(51, \
0, 153); "&gt;  &lt;/interface&gt;&lt;/div&gt;&lt;div style="color: rgb(51, 0, 153); "&gt;    \
&lt;input type='mouse' bus='ps2'/&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
class="Apple-style-span" color="#CC0000"&gt;    &lt;graphics type='vnc' \
port='10' listen='127.0.0.1'/&gt;&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font \
class="Apple-style-span" color="#CC0000"&gt;    &lt;graphics type='sdl' \
display=':0.0'/&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style="color: rgb(51, 0, 153); "&gt;  \
&lt;/devices&gt;&lt;/div&gt;&lt;div style="color: rgb(51, 0, 153); "&gt;  \
&lt;/domain&gt;&lt;/div&gt;&lt;/font&gt;&lt;/div&gt;



</body></email><email><emailId>20110823191614</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-08-23 19:16:14-0400</timestampReceived><subject>Re: [libvirt-users] libvirt ruby binding with vmware</subject><body>

2011/8/23 Ohad Levy &lt;ohadlevy@gmail.com&gt;:
&gt; Hi,
&gt; I've been trying to use the ruby libvirt binding with vmware esx on F15,
&gt; however it doesnt seems to work, I get:
&gt; Libvirt::ConnectionError: Call to virConnectOpen failed: Cannot access CA
&gt; certificate '/etc/pki/CA/cacert.pem': No such file or directory
&gt; I've using the same uri with virsh and it works.
&gt; it seems like somehow the no_verify is not passed, or we are back to old
&gt; libvirt error messages :)
&gt; any idea?
&gt; thanks,
&gt; Ohad

As the ESX driver documentation says, you need to use
virConnectOpenAuth (what virsh does by default). You're error message
talks about virConnectOpen so there is your problem. You need to use
virConnectOpenAuth with the Ruby Bindings too.

Until libvirt 0.9.2 the ESX driver declines connection attempts when
virConnectOpen is used. Since 0.9.2 this is reported as the error it
actually is.

When the ESX driver declines the connection attempt libvirt will end
up trying to connect to a non-existing libvirtd on the ESX server in
order to find a driver that accepts the connection attempt. By default
it uses TLS for this and that's why it's looking for TLS certificates.
This is not related to the no_verify option.

So you're probably using libvirt &lt; 0.9.2 and are using virConnectOpen
instead of virConnectOpenAuth.

-- 
Matthias Bolte
http://photron.blogspot.com

</body></email><email><emailId>20110824010804</emailId><senderName>Stephen Eilert</senderName><senderEmail>spedrosa@gmail.com</senderEmail><timestampReceived>2011-08-24 01:08:04-0400</timestampReceived><subject>Re: [libvirt-users] Strange libvirt exit status 1 (LXC containers)</subject><body>

Answering myself. I've enabled as much logging as possible, and asked libvirt to log \
lxc. This is the result:

2011-08-23 22:19:08.778: starting up
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/X11R6/bin \
LIBVIRT_DEBUG=1 LIBVIRT_LOG_OUTPUTS=1:syslog:libvirtd /usr/libexec/libvirt_lxc --name \
vm_14 --console 18 --handshake 21 --background --veth veth1 22:19:08.791: 10215: info \
: libvirt version: 0.9.4 22:19:08.791: 10215: debug : virCommandHook:1962 : Hook is \
                done 0
libvir: error : cannot execute binary /usr/libexec/libvirt_lxc: Permission denied

Stil not sure what would prevent libvirt_lxc execution - tested with an unprivileged \
user and it was able to run the binary (but not actually start the VMs). The error \
message seem to indicate that the 'exec' call failed. Nothing shows on app armor \
(disabled it) or other logs in general.


-- Stephen


On Aug 23, 2011, at 7:56 PM, Stephen Eilert wrote:

&gt; 
&gt; Hello,
&gt; 
&gt; I've encountered the following error, trying to start a domain:
&gt; 
&gt; error: internal error Child process \
&gt; (PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/X11R6/bin \
&gt; LIBVIRT_DEBUG=2 LIBVIRT_LOG_OUTPUTS=2:syslog:libvirtd /usr/libexec/libvirt_lxc \
&gt; --name vm_14 --console 18 --handshake 21 --background --veth veth1) status \
&gt; unexpected: exit status 1 
&gt; I see nothing relevant in syslog, google searches have returned nothing. Starting \
&gt; libvirt_lxc manually seems to work (the process never returns), but of course the \
&gt; VMs do not start. 
&gt; I am at a loss on what to do next. I'm running Ubuntu 10.04, which is itself a \
&gt; guest system running under virtual box (host is OSX Lion). I've compiled libvirt \
&gt; from git (using /usr as the --prefix, after removing the OS package), LXC \
&gt; containers are installed from a PPA, as the default Ubuntu kernel doesn't enable \
&gt; network namespaces. LXC itself doesn't appear to be a problem, as I can start VMs \
&gt; with lxc-start. Since I required libvirt's API, using LXC directly is not \
&gt; desirable. 
&gt; Does anyone have any tips on what I should be looking for? Thanks.
&gt; 
&gt; 
&gt; -- Stephen
&gt; 
&gt; 
&gt; -- Domain definition follows:
&gt; 
&gt; &lt;domain type='lxc'&gt;
&gt; &lt;name&gt;vm_14&lt;/name&gt;
&gt; &lt;uuid&gt;9243fb5b-6b26-44af-7408-69c7f2d4ff03&lt;/uuid&gt;
&gt; &lt;memory&gt;262144&lt;/memory&gt;
&gt; &lt;currentMemory&gt;262144&lt;/currentMemory&gt;
&gt; &lt;vcpu&gt;1&lt;/vcpu&gt;
&gt; &lt;os&gt;
&gt; &lt;type arch='x86_64'&gt;exe&lt;/type&gt;
&gt; &lt;init&gt;/sbin/init&lt;/init&gt;
&gt; &lt;/os&gt;
&gt; &lt;clock offset='utc'/&gt;
&gt; &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
&gt; &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
&gt; &lt;on_crash&gt;preserve&lt;/on_crash&gt;
&gt; &lt;devices&gt;
&gt; &lt;emulator&gt;/usr/libexec/libvirt_lxc&lt;/emulator&gt;
&gt; &lt;filesystem type='mount' accessmode='passthrough'&gt;
&gt; &lt;source dir='/var/lib/lxc/vmpea/rootfs/'/&gt;
&gt; &lt;target dir='/'/&gt;
&gt; &lt;readonly/&gt;
&gt; &lt;/filesystem&gt;
&gt; &lt;filesystem type='mount' accessmode='passthrough'&gt;
&gt; &lt;source dir='/home/lxcadmin/repositories/14'/&gt;
&gt; &lt;target dir='/home/lxcmaster'/&gt;
&gt; &lt;/filesystem&gt;
&gt; &lt;interface type='network'&gt;
&gt; &lt;mac address='52:54:00:10:7a:e7'/&gt;
&gt; &lt;source network='default'/&gt;
&gt; &lt;target dev='veth0'/&gt;
&gt; &lt;/interface&gt;
&gt; &lt;console type='pty'&gt;
&gt; &lt;target type='serial' port='0'/&gt;
&gt; &lt;/console&gt;
&gt; &lt;/devices&gt;
&gt; &lt;/domain&gt;
&gt; 
&gt; 


</body></email><email><emailId>20110823202630</emailId><senderName>Dave Allan</senderName><senderEmail>dallan@redhat.com</senderEmail><timestampReceived>2011-08-23 20:26:30-0400</timestampReceived><subject>Re: [libvirt-users] migration in parallel</subject><body>

On Tue, Aug 23, 2011 at 11:50:00AM -0700, Yih-Herng Chuang wrote:
&gt; 
&gt; Hi,
&gt; 
&gt; We ran into various errors when tried to run migration in parallel.  Does
&gt; libvirt support migration in parallel?

What version of libvirt?  There were some problems with parallel
migration in the past, but they have all been fixed by 0.9.4 as far as
I know.

Dave


&gt; Regards,
&gt; 
&gt; --Yih
&gt; 
&gt; Yih-Herng Chuang
&gt; IBM Center for Microsoft Technologies
&gt; 3600 Carillon Point, Kirkland WA 98033
&gt; (DID) (425) 803-7285
&gt; (TIE) 977-7285
&gt; YihHerng@us.ibm.com

&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110823205058</emailId><senderName>Yih-Herng Chuang</senderName><senderEmail>yihherng@us.ibm.com</senderEmail><timestampReceived>2011-08-23 20:50:58-0400</timestampReceived><subject>Re: [libvirt-users] migration in parallel</subject><body>

[Attachment #2 (multipart/alternative)]


Hi Dave,

The version we have is libvirt-0.8.1-27.el6.x86_64.

Regards,

--Yih

Yih-Herng Chuang
IBM Center for Microsoft Technologies
3600 Carillon Point, Kirkland WA 98033
(DID) (425) 803-7285
(TIE) 977-7285
YihHerng@us.ibm.com



From:	Dave Allan &lt;dallan@redhat.com&gt;
To:	Yih-Herng Chuang/Seattle/IBM@IBMUS
Cc:	libvirt-users@redhat.com
Date:	08/23/2011 01:27 PM
Subject:	Re: [libvirt-users] migration in parallel



On Tue, Aug 23, 2011 at 11:50:00AM -0700, Yih-Herng Chuang wrote:
&gt;
&gt; Hi,
&gt;
&gt; We ran into various errors when tried to run migration in parallel.  =
Does
&gt; libvirt support migration in parallel?

What version of libvirt?  There were some problems with parallel
migration in the past, but they have all been fixed by 0.9.4 as far as
I know.

Dave


&gt; Regards,
&gt;
&gt; --Yih
&gt;
&gt; Yih-Herng Chuang
&gt; IBM Center for Microsoft Technologies
&gt; 3600 Carillon Point, Kirkland WA 98033
&gt; (DID) (425) 803-7285
&gt; (TIE) 977-7285
&gt; YihHerng@us.ibm.com

&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

=

[Attachment #5 (text/html)]

&lt;html&gt;&lt;body&gt;
&lt;p&gt;Hi Dave,&lt;br&gt;
&lt;br&gt;
The version we have is libvirt-0.8.1-27.el6.x86_64.&lt;br&gt;
&lt;br&gt;
Regards,&lt;br&gt;
&lt;br&gt;
--Yih&lt;br&gt;
&lt;br&gt;
Yih-Herng Chuang&lt;br&gt;
IBM Center for Microsoft Technologies&lt;br&gt;
3600 Carillon Point, Kirkland WA 98033&lt;br&gt;
(DID) (425) 803-7285&lt;br&gt;
(TIE) 977-7285&lt;br&gt;
YihHerng@us.ibm.com&lt;br&gt;
&lt;br&gt;
&lt;img width="16" height="16" src="cid:1__=08BBF266DFE1F8CF8f9e8a93df938@us.ibm.com" \
border="0" alt="Inactive hide details for Dave Allan ---08/23/2011 01:27:03 PM---On \
Tue, Aug 23, 2011 at 11:50:00AM -0700, Yih-Herng Chuang wro"&gt;&lt;font \
color="#424282"&gt;Dave Allan ---08/23/2011 01:27:03 PM---On Tue, Aug 23, 2011 at \
11:50:00AM -0700, Yih-Herng Chuang wrote: &gt;&lt;/font&gt;&lt;br&gt; &lt;br&gt;
&lt;font size="2" color="#5F5F5F"&gt;From:	&lt;/font&gt;&lt;font size="2"&gt;Dave Allan \
&lt;dallan@redhat.com&gt;&lt;/font&gt;&lt;br&gt; &lt;font size="2" color="#5F5F5F"&gt;To:	&lt;/font&gt;&lt;font \
size="2"&gt;Yih-Herng Chuang/Seattle/IBM@IBMUS&lt;/font&gt;&lt;br&gt; &lt;font size="2" \
color="#5F5F5F"&gt;Cc:	&lt;/font&gt;&lt;font size="2"&gt;libvirt-users@redhat.com&lt;/font&gt;&lt;br&gt; &lt;font \
size="2" color="#5F5F5F"&gt;Date:	&lt;/font&gt;&lt;font size="2"&gt;08/23/2011 01:27 PM&lt;/font&gt;&lt;br&gt; \
&lt;font size="2" color="#5F5F5F"&gt;Subject:	&lt;/font&gt;&lt;font size="2"&gt;Re: [libvirt-users] \
migration in parallel&lt;/font&gt;&lt;br&gt; &lt;hr width="100%" size="2" align="left" noshade \
style="color:#8091A5; "&gt;&lt;br&gt; &lt;br&gt;
&lt;br&gt;
&lt;tt&gt;On Tue, Aug 23, 2011 at 11:50:00AM -0700, Yih-Herng Chuang wrote:&lt;br&gt;
&gt; &lt;br&gt;
&gt; Hi,&lt;br&gt;
&gt; &lt;br&gt;
&gt; We ran into various errors when tried to run migration in parallel. \
 Does&lt;br&gt; &gt; libvirt support migration in parallel?&lt;br&gt;
&lt;br&gt;
What version of libvirt?  There were some problems with parallel&lt;br&gt;
migration in the past, but they have all been fixed by 0.9.4 as far as&lt;br&gt;
I know.&lt;br&gt;
&lt;br&gt;
Dave&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&gt; Regards,&lt;br&gt;
&gt; &lt;br&gt;
&gt; --Yih&lt;br&gt;
&gt; &lt;br&gt;
&gt; Yih-Herng Chuang&lt;br&gt;
&gt; IBM Center for Microsoft Technologies&lt;br&gt;
&gt; 3600 Carillon Point, Kirkland WA 98033&lt;br&gt;
&gt; (DID) (425) 803-7285&lt;br&gt;
&gt; (TIE) 977-7285&lt;br&gt;
&gt; YihHerng@us.ibm.com&lt;br&gt;
&lt;br&gt;
&gt; _______________________________________________&lt;br&gt;
&gt; libvirt-users mailing list&lt;br&gt;
&gt; libvirt-users@redhat.com&lt;br&gt;
&gt; &lt;/tt&gt;&lt;tt&gt;&lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;/tt&gt;&lt;tt&gt;&lt;br&gt;
 &lt;br&gt;
&lt;/tt&gt;&lt;br&gt;
&lt;/body&gt;&lt;/html&gt;


["graycol.gif" (image/gif)]

</body></email><email><emailId>20110823111833</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-08-23 11:18:33-0400</timestampReceived><subject>Re: [libvirt-users] Problem to migrate virtual machine between two hosts with same uuid</subject><body>

On Tue, Aug 23, 2011 at 01:08:29PM +0200, info@umbertocarrara.it wrote:
&gt; hi at all,
&gt; i'm trying to migrate a vm between two host but fails, this is what
&gt; I did:
&gt; 
&gt; virsh # start win2008
&gt; Domain win2008 started
&gt; 
&gt; virsh # list
&gt;  Id Name                 State
&gt; ----------------------------------
&gt;   1 win2008              running
&gt; 
&gt; virsh # migrate --live win2008 qemu+ssh://host2/system
&gt; error: internal error Attempt to migrate guest to the same host 
&gt; 00010203-0405-0607-0809-0a0b0c0d0e0f
&gt; 
&gt; if I type on both hosts:
&gt; 
&gt; host1
&gt; virsh # sysinfo
&gt; 
&gt; .......
&gt;   &lt;system&gt;
&gt;     &lt;entry name='manufacturer'&gt;Supermicro&lt;/entry&gt;
&gt;     &lt;entry name='product'&gt;X9SCL/X9SCM&lt;/entry&gt;
&gt;     &lt;entry name='version'&gt;0123456789&lt;/entry&gt;
&gt;     &lt;entry name='serial'&gt;0123456789&lt;/entry&gt;
&gt;     &lt;entry name='uuid'&gt;00010203-0405-0607-0809-0A0B0C0D0E0F&lt;/entry&gt;
&gt;     &lt;entry name='sku'&gt;To be filled by O.E.M.&lt;/entry&gt;
&gt;     &lt;entry name='family'&gt;To be filled by O.E.M.&lt;/entry&gt;
&gt;   &lt;/system&gt;
&gt; ........
&gt;  
&gt;  
&gt; host2
&gt; virsh # sysinfo
&gt; 
&gt; .......
&gt;   &lt;system&gt;
&gt;     &lt;entry name='manufacturer'&gt;Supermicro&lt;/entry&gt;
&gt;     &lt;entry name='product'&gt;X9SCL/X9SCM&lt;/entry&gt;
&gt;     &lt;entry name='version'&gt;0123456789&lt;/entry&gt;
&gt;     &lt;entry name='serial'&gt;0123456789&lt;/entry&gt;
&gt;     &lt;entry name='uuid'&gt;00010203-0405-0607-0809-0A0B0C0D0E0F&lt;/entry&gt;
&gt;     &lt;entry name='sku'&gt;To be filled by O.E.M.&lt;/entry&gt;
&gt;     &lt;entry name='family'&gt;To be filled by O.E.M.&lt;/entry&gt;
&gt;   &lt;/system&gt;
&gt; 
&gt; ........
&gt; 
&gt; The problem seems to be the same uuid on both hosts, 
&gt; 
&gt; 1) is correct?

Yes, your hardware vendor is being very very bad :-(

&gt; 2) if is correct, how I can resolve?

You could complain to the hardware vendor, but I rather doubt
that they would ever do anything about it.

So, libvirtd provides a way to override the default host UUID,
by setting 'host_uuid' in /etc/libvirt/libvirtd.conf, which
should make the migration sanity check pass.

Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110823141246</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-08-23 14:12:46-0400</timestampReceived><subject>Re: [libvirt-users] Problem to migrate virtual machine between two hosts with same uuid</subject><body>

On 08/23/2011 05:18 AM, Daniel P. Berrange wrote:
&gt;&gt;      &lt;entry name='uuid'&gt;00010203-0405-0607-0809-0A0B0C0D0E0F&lt;/entry&gt;

&gt; Yes, your hardware vendor is being very very bad :-(

&gt; So, libvirtd provides a way to override the default host UUID,
&gt; by setting 'host_uuid' in /etc/libvirt/libvirtd.conf, which
&gt; should make the migration sanity check pass.

Should we also teach libvirt to recognize this particular UUID as 
invalid, just as we already reject all 0's and all F's as bad (also 
values seen from bad hardware vendors)?

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20110826122724</emailId><senderName>bin liu</senderName><senderEmail>bin.liu87@gmail.com</senderEmail><timestampReceived>2011-08-26 12:27:24-0400</timestampReceived><subject>[libvirt-users] hello, I 've deployed libvirt, and it is OK to use kvm.But when I use virtualbox,</subject><body>

hello,I 've deployed libvirt, and it is OK to use kvm.But when I use
virtualbox,I can not attach a device to a domain.
It reports the error that can't get device from device.xml
here is my xml file for device(device.xml):
&lt;disk type='block'&gt;
        &lt;driver name='phy'/&gt;
                &lt;source dev="/home/lb/iscsitest/vdisk.img"/&gt;
        &lt;target dev='sdb' bus='usb'/&gt;
&lt;/disk&gt;
and the xml file for the vm:

&lt;domain type='vbox'&gt;
  &lt;name&gt;winxp_3D&lt;/name&gt;
  &lt;uuid&gt;d2542bf2-3d56-41fa-a048-4f9a7ed3cf4a&lt;/uuid&gt;
  &lt;memory&gt;787456&lt;/memory&gt;
  &lt;currentMemory&gt;787456&lt;/currentMemory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='x86_64'&gt;hvm&lt;/type&gt;
    &lt;boot dev='fd'/&gt;
    &lt;boot dev='cdrom'/&gt;
    &lt;boot dev='hd'/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
  &lt;/features&gt;
  &lt;clock offset='localtime'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;destroy&lt;/on_reboot&gt;
  &lt;on_crash&gt;destroy&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;source file='/root/VirtualBox VMs/winxp_3D/winxp_3D.vdi'/&gt;
      &lt;target dev='hda' bus='ide'/&gt;
    &lt;/disk&gt;
    &lt;interface type='bridge'&gt;
      &lt;mac address='08:00:27:6f:c6:4f'/&gt;
      &lt;source bridge='tap0'/&gt;
      &lt;model type='Am79C973'/&gt;
    &lt;/interface&gt;
    &lt;input type='mouse' bus='ps2'/&gt;
    &lt;graphics type='desktop' display=':0.0'/&gt;
    &lt;sound model='ac97'/&gt;
    &lt;video&gt;
      &lt;model type='vbox' vram='32768' heads='1'&gt;
        &lt;acceleration accel3d='yes' accel2d='yes'/&gt;
      &lt;/model&gt;
    &lt;/video&gt;
  &lt;/devices&gt;
&lt;/domain&gt;

[Attachment #3 (text/html)]

&lt;div&gt;hello,I 've deployed libvirt, and it is OK to use kvm.But when I use \
virtualbox,I can not attach a device to a domain.&lt;/div&gt; &lt;div&gt;It reports the error \
that can't get device from device.xml&lt;br&gt;here is my xml file for \
device(device.xml):&lt;br&gt;&lt;disk type='block'&gt;&lt;br&gt;        &lt;driver \
name='phy'/&gt;&lt;br&gt;                &lt;source \
                dev="/home/lb/iscsitest/vdisk.img"/&gt;&lt;br&gt;
        &lt;target dev='sdb' bus='usb'/&gt;&lt;br&gt;&lt;/disk&gt;&lt;/div&gt;
&lt;div&gt;and the xml file for the vm:&lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt;&lt;domain type='vbox'&gt;&lt;br&gt;  &lt;name&gt;winxp_3D&lt;/name&gt;&lt;br&gt;  \
&lt;uuid&gt;d2542bf2-3d56-41fa-a048-4f9a7ed3cf4a&lt;/uuid&gt;&lt;br&gt;  \
&lt;memory&gt;787456&lt;/memory&gt;&lt;br&gt;  \
&lt;currentMemory&gt;787456&lt;/currentMemory&gt;&lt;br&gt;  &lt;vcpu&gt;1&lt;/vcpu&gt;&lt;br&gt; \
&lt;os&gt;&lt;br&gt;    &lt;type arch='x86_64'&gt;hvm&lt;/type&gt;&lt;br&gt;    &lt;boot \
dev='fd'/&gt;&lt;br&gt;    &lt;boot dev='cdrom'/&gt;&lt;br&gt;    &lt;boot \
dev='hd'/&gt;&lt;br&gt;  &lt;/os&gt;&lt;br&gt;  &lt;features&gt;&lt;br&gt;    &lt;acpi/&gt;&lt;br&gt; \
&lt;/features&gt;&lt;br&gt;  &lt;clock offset='localtime'/&gt;&lt;br&gt;  \
&lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;&lt;br&gt;  \
&lt;on_reboot&gt;destroy&lt;/on_reboot&gt;&lt;br&gt;  \
&lt;on_crash&gt;destroy&lt;/on_crash&gt;&lt;br&gt;  &lt;devices&gt;&lt;br&gt;    &lt;disk \
type='file' device='disk'&gt;&lt;br&gt;      &lt;source \
file='/root/VirtualBox VMs/winxp_3D/winxp_3D.vdi'/&gt;&lt;br&gt;      &lt;target \
dev='hda' bus='ide'/&gt;&lt;br&gt;  &lt;/disk&gt;&lt;br&gt;    &lt;interface \
type='bridge'&gt;&lt;br&gt;      &lt;mac \
address='08:00:27:6f:c6:4f'/&gt;&lt;br&gt;      &lt;source \
bridge='tap0'/&gt;&lt;br&gt;      &lt;model type='Am79C973'/&gt;&lt;br&gt;  \
&lt;/interface&gt;&lt;br&gt;    &lt;input type='mouse' bus='ps2'/&gt;&lt;br&gt;   \
&lt;graphics type='desktop' display=':0.0'/&gt;&lt;br&gt;    &lt;sound \
model='ac97'/&gt;&lt;br&gt;    &lt;video&gt;&lt;br&gt;  &lt;model type='vbox' \
vram='32768' heads='1'&gt;&lt;br&gt;        &lt;acceleration \
accel3d='yes' accel2d='yes'/&gt;&lt;br&gt;      &lt;/model&gt;&lt;br&gt;    \
&lt;/video&gt;&lt;br&gt;  &lt;/devices&gt;&lt;br&gt; &lt;/domain&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20110823141820</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-08-23 14:18:20-0400</timestampReceived><subject>Re: [libvirt-users] Problem to migrate virtual machine between two hosts with same uuid</subject><body>

On Tue, Aug 23, 2011 at 08:12:46AM -0600, Eric Blake wrote:
&gt; On 08/23/2011 05:18 AM, Daniel P. Berrange wrote:
&gt; &gt;&gt;     &lt;entry name='uuid'&gt;00010203-0405-0607-0809-0A0B0C0D0E0F&lt;/entry&gt;
&gt; 
&gt; &gt;Yes, your hardware vendor is being very very bad :-(
&gt; 
&gt; &gt;So, libvirtd provides a way to override the default host UUID,
&gt; &gt;by setting 'host_uuid' in /etc/libvirt/libvirtd.conf, which
&gt; &gt;should make the migration sanity check pass.
&gt; 
&gt; Should we also teach libvirt to recognize this particular UUID as
&gt; invalid, just as we already reject all 0's and all F's as bad (also
&gt; values seen from bad hardware vendors)?

Once we start going down this route, it'll never end IMHO. I've seen
so many "bad" patterns used by various vendors...

The alternate is to not use the SMBIOS uuid, but rather rely on the
fact that new hosts with SystemD, have a sane UUID generated and
recorded in /etc/machine-id

Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110823093610</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-08-23 09:36:10-0400</timestampReceived><subject>Re: [libvirt-users] pool assumed to have 512B sector</subject><body>

On Tue, Aug 23, 2011 at 08:52:56AM +0300, David Cohen wrote:
&gt; Hi,
&gt; When creating a dedicated storage pool on a FC attached storage with sector 
&gt; size of 4096B and size of 2TB, the storage pool is created but reported as 1/8 
&gt; of it's size, the same follows for any volume created in the same storage 
&gt; pool:
&gt;             
&gt; 
&gt; #  virsh pool-info guest_images_disk
&gt; Name:           guest_images_disk
&gt; UUID:           30247222-c1fb-8749-b833-a73782198d26
&gt; State:          running
&gt; Persistent:     yes
&gt; Autostart:      yes
&gt; Capacity:       256.00 GB
&gt; Allocation:     122.07 MB
&gt; Available:      255.88 GB

What type of pool have you created. You mention FC, which makes me think
you have a SCSI pool type, but then I would expect 'Available' to always
be zero, so I guess it must be a different pool type. Can you show the
pool XML, and also the XML for one of the volumes within it.


Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110823094941</emailId><senderName>David Cohen</senderName><senderEmail>cdavid@physics.technion.ac.il</senderEmail><timestampReceived>2011-08-23 09:49:41-0400</timestampReceived><subject>Re: [libvirt-users] pool assumed to have 512B sector</subject><body>

Hi,


The xml file used to create the pool :

&lt;pool type='disk'&gt;
&lt;name&gt;guest_images_disk&lt;/name&gt;
&lt;source&gt;
&lt;device path='/dev/sdb'/&gt;
&lt;format type='gpt'/&gt;
&lt;/source&gt;
&lt;target&gt;
&lt;path&gt;/dev&lt;/path&gt;
&lt;/target&gt;
&lt;/pool&gt;





virsh pool-dumpxml guest_images_disk

&lt;pool type='disk'&gt;
  &lt;name&gt;guest_images_disk&lt;/name&gt;
  &lt;uuid&gt;30247222-c1fb-8749-b833-a73782198d26&lt;/uuid&gt;
  &lt;capacity&gt;274877904384&lt;/capacity&gt;
  &lt;allocation&gt;127997440&lt;/allocation&gt;
  &lt;available&gt;274749903872&lt;/available&gt;
  &lt;source&gt;
    &lt;device path='/dev/sdb'&gt;
    &lt;freeExtent start='128000512' end='274877904384'/&gt;
    &lt;/device&gt;
    &lt;format type='unknown'/&gt;
  &lt;/source&gt;
  &lt;target&gt;
    &lt;path&gt;/dev&lt;/path&gt;
    &lt;permissions&gt;
      &lt;mode&gt;0700&lt;/mode&gt;
      &lt;owner&gt;-1&lt;/owner&gt;
      &lt;group&gt;-1&lt;/group&gt;
    &lt;/permissions&gt;
  &lt;/target&gt;
&lt;/pool&gt;



virsh vol-dumpxml --pool guest_images_disk sdb1

&lt;volume&gt;
  &lt;name&gt;sdb1&lt;/name&gt;
  &lt;key&gt;/dev/sdb1&lt;/key&gt;
  &lt;source&gt;
    &lt;device path='/dev/sdb'&gt;
      &lt;extent start='3072' end='128000512'/&gt;
    &lt;/device&gt;
  &lt;/source&gt;
  &lt;capacity&gt;127997440&lt;/capacity&gt;
  &lt;allocation&gt;127997440&lt;/allocation&gt;
  &lt;target&gt;
    &lt;path&gt;/dev/sdb1&lt;/path&gt;
    &lt;format type='none'/&gt;
    &lt;permissions&gt;
      &lt;mode&gt;0660&lt;/mode&gt;
      &lt;owner&gt;0&lt;/owner&gt;
      &lt;group&gt;6&lt;/group&gt;
    &lt;/permissions&gt;
  &lt;/target&gt;
&lt;/volume&gt;


David


On Tuesday 23 August 2011 12:36:10 Daniel P. Berrange wrote:
&gt; On Tue, Aug 23, 2011 at 08:52:56AM +0300, David Cohen wrote:
&gt; &gt; Hi,
&gt; &gt; When creating a dedicated storage pool on a FC attached storage with
&gt; &gt; sector size of 4096B and size of 2TB, the storage pool is created but
&gt; &gt; reported as 1/8 of it's size, the same follows for any volume created in
&gt; &gt; the same storage pool:
&gt; &gt; 
&gt; &gt; 
&gt; &gt; #  virsh pool-info guest_images_disk
&gt; &gt; Name:           guest_images_disk
&gt; &gt; UUID:           30247222-c1fb-8749-b833-a73782198d26
&gt; &gt; State:          running
&gt; &gt; Persistent:     yes
&gt; &gt; Autostart:      yes
&gt; &gt; Capacity:       256.00 GB
&gt; &gt; Allocation:     122.07 MB
&gt; &gt; Available:      255.88 GB
&gt; 
&gt; What type of pool have you created. You mention FC, which makes me think
&gt; you have a SCSI pool type, but then I would expect 'Available' to always
&gt; be zero, so I guess it must be a different pool type. Can you show the
&gt; pool XML, and also the XML for one of the volumes within it.
&gt; 
&gt; 
&gt; Daniel

</body></email><email><emailId>20110817174435</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-08-17 17:44:35-0400</timestampReceived><subject>Re: [libvirt-users] which vols added to storage pool during refresh?</subject><body>

On Wed, Aug 17, 2011 at 10:36:26AM -0700, Gareth S Bestor wrote:
&gt; As you can see, this pool maps to /dev/disk/by-id. There may be a large 
&gt; number of actual volume entries in /dev/disk/by-id, however it appears 
&gt; only a distinct subset of them are actually added into the libvirt pool 
&gt; when you do a pool-refresh. What does libvirt check when determining 
&gt; which, and whether or not, to add one of these volume into the vol-list? 
&gt; 
&gt; In particular, we have a case when one specific volume in /dev/disk/by-id 
&gt; is *not* added into the pool, and no amount of pool-refresh makes a 
&gt; difference. We did notice that if you remove all the sym links in 
&gt; /dev/disk/by-id and do a pool-refresh, that libvirt re-scans the bus, 
&gt; recreates the links in /dev/disk/by-id, and adds (some of) the volumes 
&gt; back into the vol-list. But not this one problematic vol, so clearly there 
&gt; is something about this vol that libvirt doesnt like and why it is 
&gt; (deliberately?) not added to the pool. 
&gt; 
&gt; What checks, etc does libvirt make against vols when determining whether 
&gt; to add them to a pool? 

If we have an error processing any volume, that will be skipped. There
is one non-error related check though, that may cause a volume to be
skipped:

    /* We don't create volumes for devices other than disk and cdrom
     * devices, but finding a device that isn't one of those types
     * isn't an error, either. */
    if (!(device_type == VIR_STORAGE_DEVICE_TYPE_DISK ||
          device_type == VIR_STORAGE_DEVICE_TYPE_ROM))
    {
        retval = 0;
        goto out;
    }

What value is in 

   /sys/bus/scsi/devices/XXXXX/type

for the LUN in question ?  And is that value different for all the
other LUNs in that HBA ?


Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110817175950</emailId><senderName>Gareth S Bestor</senderName><senderEmail>bestor@us.ibm.com</senderEmail><timestampReceived>2011-08-17 17:59:50-0400</timestampReceived><subject>Re: [libvirt-users] which vols added to storage pool during refresh?</subject><body>

This is a multipart message in MIME format.
--=_related 0062BE10882578EF_=
Content-Type: multipart/alternative;
	boundary="=_alternative 0062BE10882578EF_="


--=_alternative 0062BE10882578EF_=
Content-Type: text/plain; charset="US-ASCII"

Thanks for the quick response Daniel. 

&gt; What value is in 
&gt; 
&gt; /sys/bus/scsi/devices/XXXXX/type
&gt; 
&gt; for the LUN in question ?  And is that value different for all the
&gt; other LUNs in that HBA ?

I'll check.

In the mean time, what sort of 'processing' does libvirt do that might 
result in an error ("If we have an error processing any volume, that will 
be skipped.")? eg if we see a vol that is not getting added, is there a 
command-line we can do to confirm there's something 'wrong' with this vol?

thnx again,

- G

Dr. Gareth S. Bestor
IBM Senior Software Engineer
Systems &amp; Technology Group - Systems Management Standards
971-285-6375 (mobile)
bestor@us.ibm.com





Re: [libvirt-users] which vols added to storage pool during refresh?

Daniel P. Berrange 
to:
Gareth S Bestor
08/17/11 10:44 AM


Cc:
libvirt-users
Please respond to "Daniel P. Berrange"






On Wed, Aug 17, 2011 at 10:36:26AM -0700, Gareth S Bestor wrote:
&gt; As you can see, this pool maps to /dev/disk/by-id. There may be a large 
&gt; number of actual volume entries in /dev/disk/by-id, however it appears 
&gt; only a distinct subset of them are actually added into the libvirt pool 
&gt; when you do a pool-refresh. What does libvirt check when determining 
&gt; which, and whether or not, to add one of these volume into the vol-list? 

&gt; 
&gt; In particular, we have a case when one specific volume in 
/dev/disk/by-id 
&gt; is *not* added into the pool, and no amount of pool-refresh makes a 
&gt; difference. We did notice that if you remove all the sym links in 
&gt; /dev/disk/by-id and do a pool-refresh, that libvirt re-scans the bus, 
&gt; recreates the links in /dev/disk/by-id, and adds (some of) the volumes 
&gt; back into the vol-list. But not this one problematic vol, so clearly 
there 
&gt; is something about this vol that libvirt doesnt like and why it is 
&gt; (deliberately?) not added to the pool. 
&gt; 
&gt; What checks, etc does libvirt make against vols when determining whether 

&gt; to add them to a pool? 

If we have an error processing any volume, that will be skipped. There
is one non-error related check though, that may cause a volume to be
skipped:

    /* We don't create volumes for devices other than disk and cdrom
     * devices, but finding a device that isn't one of those types
     * isn't an error, either. */
    if (!(device_type == VIR_STORAGE_DEVICE_TYPE_DISK ||
          device_type == VIR_STORAGE_DEVICE_TYPE_ROM))
    {
        retval = 0;
        goto out;
    }

What value is in 

   /sys/bus/scsi/devices/XXXXX/type

for the LUN in question ?  And is that value different for all the
other LUNs in that HBA ?


Daniel
-- 
&gt; &gt; http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ 
&gt; &gt; 
&gt; &gt; http://libvirt.org              -o-             http://virt-manager.org 
&gt; &gt; 
&gt; &gt; http://autobuild.org       -o-         http://search.cpan.org/~danberr/ 
&gt; &gt; 
&gt; &gt; http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc 
&gt; &gt; 


--=_alternative 0062BE10882578EF_=
Content-Type: text/html; charset="US-ASCII"


&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;Thanks for the quick response Daniel.
&lt;/font&gt;
&lt;br&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size=2&gt;&gt;What value is in &lt;br&gt;
&gt;&lt;br&gt;
&gt;   /sys/bus/scsi/devices/XXXXX/type&lt;br&gt;
&gt;&lt;br&gt;
&gt;for the LUN in question ?  And is that value different for all
the&lt;br&gt;
&gt;other LUNs in that HBA ?&lt;br&gt;
&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size=2&gt;I'll check.&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size=2&gt;In the mean time, what sort of 'processing' does libvirt
do that might result in an error ("If we have an error processing
any volume, that will be skipped.")? eg if we see a vol that is not
getting added, is there a command-line we can do to confirm there's something
'wrong' with this vol?&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size=2&gt;thnx again,&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size=2&gt;- G&lt;/font&gt;&lt;/tt&gt;
&lt;br&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;Dr. Gareth S. Bestor&lt;br&gt;
IBM Senior Software Engineer&lt;br&gt;
Systems &amp; Technology Group - Systems Management Standards&lt;br&gt;
971-285-6375 (mobile)&lt;br&gt;
bestor@us.ibm.com&lt;/font&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;table width=100%&gt;
&lt;tr&gt;
&lt;td&gt;&lt;img src=cid:_1_1A15AC041A15A8300062BE10882578EF&gt;
&lt;td width=100%&gt;
&lt;table width=100%&gt;
&lt;tr valign=top&gt;
&lt;td width=100%&gt;&lt;font size=2 face="sans-serif"&gt;&lt;b&gt;Re: [libvirt-users] which
vols added to storage pool during refresh?&lt;/b&gt;&lt;/font&gt;&lt;/table&gt;
&lt;br&gt;
&lt;table width=100%&gt;
&lt;tr&gt;
&lt;td&gt;&lt;font size=2 color=#e26200 face="sans-serif"&gt;&lt;b&gt;Daniel P. Berrange
&lt;/b&gt;&lt;/font&gt;
&lt;td&gt;&lt;font size=2 color=#8f8f8f face="sans-serif"&gt;to:&lt;/font&gt;
&lt;td&gt;&lt;font size=2 face="sans-serif"&gt;Gareth S Bestor&lt;/font&gt;
&lt;td&gt;
&lt;div align=right&gt;&lt;font size=1 face="sans-serif"&gt;08/17/11 10:44 \
AM&lt;/font&gt;&lt;/div&gt;&lt;/table&gt; &lt;br&gt;
&lt;table width=100%&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;table width=100%&gt;
&lt;tr&gt;
&lt;td&gt;&lt;font size=1 color=#8f8f8f face="sans-serif"&gt;Cc:&lt;/font&gt;
&lt;td width=100%&gt;&lt;font size=1 face="sans-serif"&gt;libvirt-users&lt;/font&gt;&lt;/table&gt;
&lt;br&gt;&lt;font size=1 face="sans-serif"&gt;&lt;b&gt;Please respond to "Daniel P.
Berrange"&lt;/b&gt;&lt;/font&gt;
&lt;td&gt;
&lt;div align=right&gt;&lt;/div&gt;&lt;/table&gt;
&lt;br&gt;&lt;/table&gt;
&lt;br&gt;
&lt;br&gt;
&lt;hr&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;&lt;tt&gt;&lt;font size=2&gt;On Wed, Aug 17, 2011 at 10:36:26AM -0700, Gareth S
Bestor wrote:&lt;br&gt;
&gt; As you can see, this pool maps to /dev/disk/by-id. There may be a
large &lt;br&gt;
&gt; number of actual volume entries in /dev/disk/by-id, however it appears
&lt;br&gt;
&gt; only a distinct subset of them are actually added into the libvirt
pool &lt;br&gt;
&gt; when you do a pool-refresh. What does libvirt check when determining
&lt;br&gt;
&gt; which, and whether or not, to add one of these volume into the vol-list?
&lt;br&gt;
&gt; &lt;br&gt;
&gt; In particular, we have a case when one specific volume in /dev/disk/by-id
&lt;br&gt;
&gt; is *not* added into the pool, and no amount of pool-refresh makes
a &lt;br&gt;
&gt; difference. We did notice that if you remove all the sym links in
&lt;br&gt;
&gt; /dev/disk/by-id and do a pool-refresh, that libvirt re-scans the bus,
&lt;br&gt;
&gt; recreates the links in /dev/disk/by-id, and adds (some of) the volumes
&lt;br&gt;
&gt; back into the vol-list. But not this one problematic vol, so clearly
there &lt;br&gt;
&gt; is something about this vol that libvirt doesnt like and why it is
&lt;br&gt;
&gt; (deliberately?) not added to the pool. &lt;br&gt;
&gt; &lt;br&gt;
&gt; What checks, etc does libvirt make against vols when determining whether
&lt;br&gt;
&gt; to add them to a pool? &lt;br&gt;
&lt;br&gt;
If we have an error processing any volume, that will be skipped. There&lt;br&gt;
is one non-error related check though, that may cause a volume to be&lt;br&gt;
skipped:&lt;br&gt;
&lt;br&gt;
    /* We don't create volumes for devices other than disk and
cdrom&lt;br&gt;
     * devices, but finding a device that isn't one of those
types&lt;br&gt;
     * isn't an error, either. */&lt;br&gt;
    if (!(device_type == VIR_STORAGE_DEVICE_TYPE_DISK ||&lt;br&gt;
          device_type == VIR_STORAGE_DEVICE_TYPE_ROM))&lt;br&gt;
    {&lt;br&gt;
        retval = 0;&lt;br&gt;
        goto out;&lt;br&gt;
    }&lt;br&gt;
&lt;br&gt;
What value is in &lt;br&gt;
&lt;br&gt;
   /sys/bus/scsi/devices/XXXXX/type&lt;br&gt;
&lt;br&gt;
for the LUN in question ?  And is that value different for all the&lt;br&gt;
other LUNs in that HBA ?&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Daniel&lt;br&gt;
-- &lt;br&gt;
&gt; &gt; &lt;/font&gt;&lt;/tt&gt;&lt;a href=http://berrange.com/&gt;&lt;tt&gt;&lt;font size=2&gt;http://berrange.com
     -o-    &lt;/font&gt;&lt;/tt&gt;&lt;a \
href=http://www.flickr.com/photos/dberrange/&gt;&lt;tt&gt;&lt;font \
size=2&gt;http://www.flickr.com/photos/dberrange/ :|&lt;br&gt;
&gt; &gt; &lt;/font&gt;&lt;/tt&gt;&lt;a href=http://libvirt.org/&gt;&lt;tt&gt;&lt;font size=2&gt;http://libvirt.org
             -o-      
      &lt;/font&gt;&lt;/tt&gt;&lt;a href="http://virt-manager.org/"&gt;&lt;tt&gt;&lt;font \
size=2&gt;http://virt-manager.org :|&lt;br&gt;
&gt; &gt; &lt;/font&gt;&lt;/tt&gt;&lt;a href=http://autobuild.org/&gt;&lt;tt&gt;&lt;font size=2&gt;http://autobuild.org
      -o-         &lt;/font&gt;&lt;/tt&gt;&lt;a \
href=http://search.cpan.org/~danberr/&gt;&lt;tt&gt;&lt;font \
size=2&gt;http://search.cpan.org/~danberr/ :|&lt;br&gt;
&gt; &gt; &lt;/font&gt;&lt;/tt&gt;&lt;a href="http://entangle-photo.org/"&gt;&lt;tt&gt;&lt;font \
&gt; &gt; size=2&gt;http://entangle-photo.org
      -o-       &lt;/font&gt;&lt;/tt&gt;&lt;a \
href="http://live.gnome.org/gtk-vnc"&gt;&lt;tt&gt;&lt;font size=2&gt;http://live.gnome.org/gtk-vnc \
:|&lt;br&gt; &lt;/font&gt;&lt;/tt&gt;&lt;/a&gt;&lt;/a&gt;&lt;/a&gt;&lt;/a&gt;&lt;/a&gt;&lt;/a&gt;&lt;/a&gt;&lt;/a&gt;
&lt;br&gt;
--=_alternative 0062BE10882578EF_=--
--=_related 0062BE10882578EF_=--


</body></email><email><emailId>20110825193935</emailId><senderName>Josir Cardoso Gomes</senderName><senderEmail>josir.ms@gmail.com</senderEmail><timestampReceived>2011-08-25 19:39:35-0400</timestampReceived><subject>[libvirt-users] VMs do not start randomically during host boot</subject><body>

Hi Folks,

Host: Ubuntu 10.04 64bits
3 Guests with Ubuntu 10.04 64bits

Every monday, when I turn the host on, some guests starts automatically and
others don=B4t.
Every week libvirt "elects" a different guest and don=B4t start it.

If I start it manually, it boot fine.

Looking at /var/log/libvirtd, it only show the log of the guests that boot.
Not a tip of the sleepy guests servers.

Could somebody give me a glue on how to find the problem ?

Thanks in advance,
Josir.

[Attachment #3 (text/html)]

Hi Folks, &lt;br&gt;&lt;br&gt;Host: Ubuntu 10.04 64bits&lt;br&gt;3 Guests with Ubuntu 10.04 6=
4bits&lt;br&gt;
&lt;br&gt;Every monday, when I turn the host on, some guests starts automatically=
 and others don=B4t. &lt;br&gt;Every week libvirt "elects" a different =
guest and don=B4t start it. &lt;br&gt;&lt;br&gt;If I start it manually, it boot fine.&lt;b=
r&gt;
&lt;br&gt;Looking at /var/log/libvirtd, it only show the log of the guests that b=
oot. Not a tip of the sleepy guests servers.&lt;br&gt;&lt;br&gt;Could somebody give me =
a glue on how to find the problem ?&lt;br&gt;&lt;br&gt;Thanks in advance,&lt;br&gt;Josir.&lt;br&gt;
&lt;br&gt;&lt;br&gt;&lt;br&gt;


</body></email><email><emailId>20110801222045</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-08-01 22:20:45-0400</timestampReceived><subject>Re: [libvirt-users] Migration hangs on Gentoo with KVM</subject><body>

On 08/01/2011 04:11 PM, Jonathan Stoppani wrote:
&gt; Hi there,
&gt; 
&gt; I'm trying to migrate a domain between two Gentoo hosts using KVM as hypervisor, \
&gt; but the migration hangs. I tried both live or offline migration modes without \
&gt; success.

Does your 'nc' command have a -q option?  If so, then this is probably

https://bugzilla.redhat.com/show_bug.cgi?id=726174

and there is a proposed patch for this:

https://www.redhat.com/archives/libvir-list/2011-July/msg02041.html

although that patch was deemed too late to make it into the upcoming 
0.9.4 release.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


</body></email><email><emailId>20110801222644</emailId><senderName>"Stefan G. Weichinger"</senderName><senderEmail>lists@xunil.at</senderEmail><timestampReceived>2011-08-01 22:26:44-0400</timestampReceived><subject>Re: [libvirt-users] Migration hangs on Gentoo with KVM</subject><body>

Am 2011-08-02 00:11, schrieb Jonathan Stoppani:

&gt; * The process seams to deadlock somewhere, CPU usage is near to 0% *
&gt; The disk images are available on both hosts at the same location (I'm
&gt; using a COW2 image based on another COW2 image, both are available) *
&gt; The shared FS is mounted through fuse-sshfs * I just noticed that my
&gt; clocks are skewed. I will rerun the whole test with a correctly setup
&gt; ntp server, but I had the same problem last week with perfectly
&gt; synchronized clocks, so I doubt this will make a difference.


ssh-keys exported/imported vice versa?
make sure both hosts are able to ssh to each other using pubkeys.

that was my showstopper lately.

Stefan

</body></email><email><emailId>20110801223325</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-08-01 22:33:25-0400</timestampReceived><subject>Re: [libvirt-users] Migration hangs on Gentoo with KVM</subject><body>

[re-adding the list]

On 08/01/2011 04:22 PM, Jonathan Stoppani wrote:
&gt; 
&gt; On Aug 1, 2011, at 16:20 , Eric Blake wrote:
&gt; 
&gt; &gt; On 08/01/2011 04:11 PM, Jonathan Stoppani wrote:
&gt; &gt; &gt; Hi there,
&gt; &gt; &gt; 
&gt; &gt; &gt; I'm trying to migrate a domain between two Gentoo hosts using KVM as \
&gt; &gt; &gt; hypervisor, but the migration hangs. I tried both live or offline migration \
&gt; &gt; &gt; modes without success.
&gt; &gt; 
&gt; &gt; Does your 'nc' command have a -q option?  If so, then this is probably
&gt; &gt; 
&gt; &gt; https://bugzilla.redhat.com/show_bug.cgi?id=726174
&gt; &gt; 

&gt; 
&gt; Thanks for the prompt answer Eric! Yes, nc has a q option:
&gt; 
&gt; -q, --hold-timeout=SEC1[:SEC2]   Set hold timeout(s) for local [and remote]

Glad to hear that we found root cause to your problems, then.

&gt; 
&gt; The bug specifically refers to ssh, does that mean that it should work over tcp?

The problem is that libvirt is trying to start a remote nc session over 
ssh; but looking at http://libvirt.org/remote.html, it looks like ssh is 
the only protocol using nc in that manner (so yes, you can probably 
avoid the issue by using tcp or tls).  Meanwhile, I think you can work 
around it without patching libvirt, by using this as your remote URI:

qemu+ssh://user@remotehost/system?netcat=/path/to/nc-wrapper

where nc-wrapper is an executable script installed on remotehost, 
looking like:

#!/bin/sh
exec /path/to/real/nc -q0 "$@"

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


</body></email><email><emailId>20110801225043</emailId><senderName>Jonathan Stoppani</senderName><senderEmail>jonathan@stoppani.name</senderEmail><timestampReceived>2011-08-01 22:50:43-0400</timestampReceived><subject>Re: [libvirt-users] Migration hangs on Gentoo with KVM</subject><body>


On Aug 1, 2011, at 16:33 , Eric Blake wrote:

&gt; [re-adding the list]

Sorry about that, still not used to mailman lists which don't put the list address in \
the reply-to field. ;-)

&gt; &gt; Thanks for the prompt answer Eric! Yes, nc has a q option:
&gt; &gt; 
&gt; &gt; -q, --hold-timeout=SEC1[:SEC2]   Set hold timeout(s) for local [and remote]
&gt; 
&gt; Glad to hear that we found root cause to your problems, then.
&gt; 
&gt; &gt; 
&gt; &gt; The bug specifically refers to ssh, does that mean that it should work over tcp?
&gt; 
&gt; The problem is that libvirt is trying to start a remote nc session over ssh; but \
&gt; looking at http://libvirt.org/remote.html, it looks like ssh is the only protocol \
&gt; using nc in that manner (so yes, you can probably avoid the issue by using tcp or \
&gt; tls).  Meanwhile, I think you can work around it without patching libvirt, by using \
&gt; this as your remote URI: 
&gt; qemu+ssh://user@remotehost/system?netcat=/path/to/nc-wrapper
&gt; 
&gt; where nc-wrapper is an executable script installed on remotehost, looking like:
&gt; 
&gt; #!/bin/sh
&gt; exec /path/to/real/nc -q0 "$@"

Just tried this, but still hangs; will try tcp and report the results.

~Jonathan


</body></email><email><emailId>20110802000155</emailId><senderName>Jonathan Stoppani</senderName><senderEmail>jonathan@stoppani.name</senderEmail><timestampReceived>2011-08-02 00:01:55-0400</timestampReceived><subject>Re: [libvirt-users] Migration hangs on Gentoo with KVM</subject><body>


On Aug 1, 2011, at 16:50 , Jonathan Stoppani wrote:

&gt; 
&gt; On Aug 1, 2011, at 16:33 , Eric Blake wrote:
&gt; 
&gt; &gt; [re-adding the list]
&gt; 
&gt; Sorry about that, still not used to mailman lists which don't put the list address \
&gt; in the reply-to field. ;-) 
&gt; &gt; &gt; Thanks for the prompt answer Eric! Yes, nc has a q option:
&gt; &gt; &gt; 
&gt; &gt; &gt; -q, --hold-timeout=SEC1[:SEC2]   Set hold timeout(s) for local [and remote]
&gt; &gt; 
&gt; &gt; Glad to hear that we found root cause to your problems, then.
&gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; The bug specifically refers to ssh, does that mean that it should work over \
&gt; &gt; &gt; tcp?
&gt; &gt; 
&gt; &gt; The problem is that libvirt is trying to start a remote nc session over ssh; but \
&gt; &gt; looking at http://libvirt.org/remote.html, it looks like ssh is the only protocol \
&gt; &gt; using nc in that manner (so yes, you can probably avoid the issue by using tcp or \
&gt; &gt; tls).  Meanwhile, I think you can work around it without patching libvirt, by \
&gt; &gt; using this as your remote URI: 
&gt; &gt; qemu+ssh://user@remotehost/system?netcat=/path/to/nc-wrapper
&gt; &gt; 
&gt; &gt; where nc-wrapper is an executable script installed on remotehost, looking like:
&gt; &gt; 
&gt; &gt; #!/bin/sh
&gt; &gt; exec /path/to/real/nc -q0 "$@"
&gt; 
&gt; Just tried this, but still hangs; will try tcp and report the results.
&gt; 
&gt; ~Jonathan

Tested using qemu+tcp and it hangs the same. If I interrupt the migration (^C), the \
domain is correctly destroyed on the destination but left in the paused state on the \
source. If I try to start it manually, I obtain this error:

# virsh resume 1
error: Failed to resume domain 1
error: Timed out during operation: cannot acquire state change lock

Any insights?


~Jonathan


</body></email><email><emailId>20110817203019</emailId><senderName>Jonathan Stoppani</senderName><senderEmail>jonathan@stoppani.name</senderEmail><timestampReceived>2011-08-17 20:30:19-0400</timestampReceived><subject>Re: [libvirt-users] Migration hangs on Gentoo with KVM</subject><body>


On Aug 1, 2011, at 18:01 , Jonathan Stoppani wrote:

&gt; 
&gt; On Aug 1, 2011, at 16:50 , Jonathan Stoppani wrote:
&gt; 
&gt; &gt; 
&gt; &gt; On Aug 1, 2011, at 16:33 , Eric Blake wrote:
&gt; &gt; 
&gt; &gt; &gt; [re-adding the list]
&gt; &gt; 
&gt; &gt; Sorry about that, still not used to mailman lists which don't put the list \
&gt; &gt; address in the reply-to field. ;-) 
&gt; &gt; &gt; &gt; Thanks for the prompt answer Eric! Yes, nc has a q option:
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; -q, --hold-timeout=SEC1[:SEC2]   Set hold timeout(s) for local [and remote]
&gt; &gt; &gt; 
&gt; &gt; &gt; Glad to hear that we found root cause to your problems, then.
&gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; The bug specifically refers to ssh, does that mean that it should work over \
&gt; &gt; &gt; &gt; tcp?
&gt; &gt; &gt; 
&gt; &gt; &gt; The problem is that libvirt is trying to start a remote nc session over ssh; \
&gt; &gt; &gt; but looking at http://libvirt.org/remote.html, it looks like ssh is the only \
&gt; &gt; &gt; protocol using nc in that manner (so yes, you can probably avoid the issue by \
&gt; &gt; &gt; using tcp or tls).  Meanwhile, I think you can work around it without patching \
&gt; &gt; &gt; libvirt, by using this as your remote URI: 
&gt; &gt; &gt; qemu+ssh://user@remotehost/system?netcat=/path/to/nc-wrapper
&gt; &gt; &gt; 
&gt; &gt; &gt; where nc-wrapper is an executable script installed on remotehost, looking like:
&gt; &gt; &gt; 
&gt; &gt; &gt; #!/bin/sh
&gt; &gt; &gt; exec /path/to/real/nc -q0 "$@"
&gt; &gt; 
&gt; &gt; Just tried this, but still hangs; will try tcp and report the results.
&gt; &gt; 
&gt; &gt; ~Jonathan
&gt; 
&gt; Tested using qemu+tcp and it hangs the same. If I interrupt the migration (^C), the \
&gt; domain is correctly destroyed on the destination but left in the paused state on \
&gt; the source. If I try to start it manually, I obtain this error: 
&gt; # virsh resume 1
&gt; error: Failed to resume domain 1
&gt; error: Timed out during operation: cannot acquire state change lock
&gt; 
&gt; Any insights?

Can someone shed some light on the libvirt locking possibilities? It seems to me that \
sanlock is not supported on gentoo (and libvirt is compiled using --without-sanlock); \
could this be the cause of the problem?

Is there some way to explicitly set the locking mechanism to a noop in the libvirt \
configuration?

~Jonathan


</body></email><email><emailId>20110817134515</emailId><senderName>"William A. Mahaffey III"</senderName><senderEmail>wam@hiwaay.net</senderEmail><timestampReceived>2011-08-17 13:45:15-0400</timestampReceived><subject>Re: [libvirt-users] virt-install -&gt; guest stops at installation end</subject><body>

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta content="text/html; charset=ISO-8859-1"
      http-equiv="Content-Type"&gt;
    &lt;title&gt;&lt;/title&gt;
  &lt;/head&gt;
  &lt;body bgcolor="#ffffff" text="#000000"&gt;
    On 08/17/11 07:23, Julien Garet wrote:
    &lt;blockquote
      cite="mid:1152783596.281941.1313583792828.JavaMail.root@zmbs2.inria.fr"
      type="cite"&gt;
      &lt;style type="text/css"&gt;p { margin: 0; }&lt;/style&gt;
      &lt;div style="font-family: Times New Roman; font-size: 12pt; color:
        rgb(0, 0, 0);"&gt;&lt;span style="color: rgb(0, 0, 0); font-family:
          'Times New Roman'; font-size: 12pt;"&gt;Hello,&lt;br&gt;
          &lt;br&gt;
          &lt;span name="x"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 0);
          font-family: 'Times New Roman'; font-size: 12pt;"&gt;I am using
          virt-install to install CentOS6 guests on a CentOS6 KVM remote
          host. Everything works fine except that at the end of the
          installation, the guest stops instead of rebooting, which I
          thought, should be the default behaviour.&lt;br&gt;
        &lt;/span&gt;
        &lt;div&gt;
          &lt;div style="color: rgb(0, 0, 0); font-family: 'Times New
            Roman'; font-size: 12pt;"&gt;&lt;span&gt;&lt;br&gt;
            &lt;/span&gt;&lt;/div&gt;
          &lt;div style="color: rgb(0, 0, 0); font-family: 'Times New
            Roman'; font-size: 12pt;"&gt;&lt;span&gt;The command I use is : &lt;/span&gt;&lt;/div&gt;
          &lt;div&gt;[root@myorchestrator]# /usr/local/bin/virt-install
            --connect qemu+ssh://root@mydom0/system --name myclient
            --accelerate --ram 2048 --disk path=/mnt/client.img,size=10
            --os-type=linux --network bridge:mybridge --vnc --pxe -m
            52:54:00:00:3d:a9&lt;/div&gt;
          &lt;div&gt;&lt;br&gt;
          &lt;/div&gt;
          &lt;div&gt;virt-install version is 0.500.6 on the host where I use
            virt-install. libvirt is version 0.8.1 (CentOS 6) on dom0.&lt;/div&gt;
          &lt;div&gt;&lt;br&gt;
          &lt;/div&gt;
          &lt;div&gt;Any advice ?&lt;/div&gt;
          &lt;div style="color: rgb(0, 0, 0); font-family: 'Times New
            Roman'; font-size: 12pt;"&gt;&lt;span&gt;&lt;br&gt;
            &lt;/span&gt;&lt;/div&gt;
          &lt;div style="color: rgb(0, 0, 0); font-family: 'Times New
            Roman'; font-size: 12pt;"&gt;&lt;span&gt;Julien Garet&lt;/span&gt;&lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;pre wrap=""&gt;
&lt;fieldset class="mimeAttachmentHeader"&gt;&lt;/fieldset&gt;
_______________________________________________
libvirt-users mailing list
&lt;a class="moz-txt-link-abbreviated" \
href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt; &lt;a \
class="moz-txt-link-freetext" \
href="https://www.redhat.com/mailman/listinfo/libvirt-users"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;/pre&gt;
  &lt;/blockquote&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;br&gt;
    Try adding '--autostart' ?&lt;br&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;pre class="moz-signature" cols="72"&gt;-- 

	William A. Mahaffey III

 ----------------------------------------------------------------------

	"The M1 Garand is without doubt the finest implement of war
	 ever devised by man."
                           -- Gen. George S. Patton Jr.
&lt;/pre&gt;
  &lt;/body&gt;
&lt;/html&gt;


</body></email><email><emailId>20110815214812</emailId><senderName>"William A. Mahaffey III"</senderName><senderEmail>wam@hiwaay.net</senderEmail><timestampReceived>2011-08-15 21:48:12-0400</timestampReceived><subject>[libvirt-users] The saga continues ....</subject><body>



.... I have a 64-bit CentOS 5.6 VM running on a 64-bit FC14 host. 
Actually, I *HAD* a 64-bit CentOS 5.6 VM :-) .... After a read of the 
virt-install man page, I concluded that I could lose the current VM (but 
*NOT* its HDD image) &amp; recreate it fairly easily w/ the right combo of 
arguments to virt-install. The proceedings:




[root@Q6600:/etc, Mon Aug 15, 04:30 PM] 1163 # virsh list
  Id Name                 State
----------------------------------
   1 CentOS-5.6-64bitVM   running

[root@Q6600:/etc, Mon Aug 15, 04:30 PM] 1164 # virsh destroy 
CentOS-5.6-64bitVM
Domain CentOS-5.6-64bitVM destroyed

[root@Q6600:/etc, Mon Aug 15, 04:30 PM] 1165 # virsh list
  Id Name                 State
----------------------------------

[root@Q6600:/etc, Mon Aug 15, 04:30 PM] 1166 # virsh undefine 
CentOS-5.6-64bitVM
Domain CentOS-5.6-64bitVM has been undefined

[root@Q6600:/etc, Mon Aug 15, 04:30 PM] 1167 # virsh list
  Id Name                 State
----------------------------------
[root@Q6600:/etc, Mon Aug 15, 04:31 PM] 1169 # virt-install   -n 
CentOS-5.6-64bitVM  -r 2048  --arch=x86_64  --cpu core2duo,disable=vmx  
--vcpus=2,maxvcpus=2,sockets=1,cores=2,threads=1  --os-type=linux  
--os-variant=rhel5  --import  --disk 
path=/home/VMs/CentOS.5.6-64bit-VM/disk.img,format=raw  --autostart  
--prompt
This will overwrite the existing path 
'/home/VMs/CentOS.5.6-64bit-VM/disk.img'
Do you really want to use this disk (yes or no)
no
What would you like to use as the disk (file path)?
quit
How large would you like the disk (quit) to be (in gigabytes)?
^CInstallation aborted at user request
[root@Q6600:/etc, Mon Aug 15, 04:31 PM] 1170 #


i.e. I chickened out at the ominous-sounding message about wiping out my 
hard-won disk image .... I thought (from the man-page) that the 
'--import' command would skip any attempts at installing anything, 
define the VM from the arguments supplied, &amp; boot it from the 
already-prepped disk image .... Am I right here ? If not, is there a 
recommended way to re-create my VM (mostly) from the extant disk image 
w/o having to redo whatever initialization I have done so far (setup a 
user, install compilers &amp; dev.env., install Intel compiler, etc.) ? 
Also, is there a recommended way for the host to copy that disk image 
somewhere so I can try to reuse it if my future attempts at re-creation 
don't pan out ? TIA ....




-- 

	William A. Mahaffey III

  ----------------------------------------------------------------------

	"The M1 Garand is without doubt the finest implement of war
	 ever devised by man."
                            -- Gen. George S. Patton Jr.

</body></email><email><emailId>20110816075349</emailId><senderName>Nicolas Sebrecht</senderName><senderEmail>nsebrecht@piing.fr</senderEmail><timestampReceived>2011-08-16 07:53:49-0400</timestampReceived><subject>[libvirt-users]  Re: does kvm support SATA driver?</subject><body>

[ Please, don't use HTML for emails in mailing lists. ]

The 15/08/11, lisiyang wrote:
&gt;    Hi,
&gt; 
&gt;    I encounter a  problem. My virtual  machine is  windows 7 .  I install  it
&gt;    using bus ide.  There is not  any problem until  now. but when  I want  to
&gt;    attach a disk  to it(bus=scsi )  , the  os can��t find  the suitable  SCSI
&gt;    driver. I search the problem on  the internet ,it seems that the  windows7
&gt;    don��t support SCSI driver. So ,I want  attach the disk to vm using  SATA.
&gt;    So I want to know that whether the kvm support SATA driver and whether the
&gt;    kvm support USB 2.0?

Usually, on Windows guests, you have to install the drivers before
changing the device. What I do is :
- attach another new temporary disk with SCSI,
- start Windows,
- install the drivers, 
- test the last disk is available,
- halt the guest,
- remove the temporary disk,
- start Windows.


-- 
Nicolas Sebrecht

</body></email><email><emailId>20110816075957</emailId><senderName>Nicolas Sebrecht</senderName><senderEmail>nsebrecht@piing.fr</senderEmail><timestampReceived>2011-08-16 07:59:57-0400</timestampReceived><subject>[libvirt-users]  Re: Question about terminology</subject><body>

The 15/08/11, Jeff wrote:
&gt; I'm having a minor disagreement with a colleague over terminology.
&gt; 
&gt; When you have a group of KVM Hosts which have access to the same network and \
&gt; storage (for purposes of migration) yet there is no clusterware or HA software \
&gt; involved...how does one refer to this group of hosts? I call them a "Host Group." \
&gt; He insists on the term "Cluster."   
&gt; To me, "cluster" indicates the presence of an HA solution such as RHCS or VCS and \
&gt; using the term when neither exist would generate confusion.  He insists that since \
&gt; VMWare refers to the same configuration as a "cluster" that this is how we should \
&gt; refer to it with regard to KVM. 
&gt; Wouldn't be that big of a deal, except that I'm trying to develop operational \
&gt; documentation.  Anyone else out there have suggestions?

I would tend to agree with your colleague. A cluster doesn't imply HA
and it's more about network nodes working with each other to provide any
kind of service, IMHO. I don't know VMWare. Cluster is a vague term.

That beeing said, you can use whatever you want in your documentation as
long as you clearly define the terms in it. ,-p

-- 
Nicolas Sebrecht


</body></email><email><emailId>20110817152302</emailId><senderName>Julien Garet</senderName><senderEmail>julien.garet@inria.fr</senderEmail><timestampReceived>2011-08-17 15:23:02-0400</timestampReceived><subject>Re: [libvirt-users] virt-install -&gt; guest stops at installation end</subject><body>

De: "William A. Mahaffey III" &lt;wam@hiwaay.net&gt; 
À: libvirt-users@redhat.com 
Envoyé: Mercredi 17 Août 2011 15:45:15 
Objet: Re: [libvirt-users] virt-install -&gt; guest stops at installation end 

On 08/17/11 07:23, Julien Garet wrote: 


Hello, 

I am using virt-install to install CentOS6 guests on a CentOS6 KVM remote host. \
Everything works fine except that at the end of the installation, the guest stops \
instead of rebooting, which I thought, should be the default behaviour. 




The command I use is : 
[root@myorchestrator]# /usr/local/bin/virt-install --connect \
qemu+ssh://root@mydom0/system --name myclient --accelerate --ram 2048 --disk \
path=/mnt/client.img,size=10 --os-type=linux --network bridge:mybridge --vnc --pxe -m \
52:54:00:00:3d:a9 


virt-install version is 0.500.6 on the host where I use virt-install. libvirt is \
version 0.8.1 (CentOS 6) on dom0. 


Any advice ? 


Julien Garet _______________________________________________
libvirt-users mailing list libvirt-users@redhat.com \
https://www.redhat.com/mailman/listinfo/libvirt-users 


Try adding '--autostart' ? Unfortunately, it does not help, --autostart only sets the \
automatic boot of the virtual machine on host boot not the reboot at installation \
end. 


Julien Garet 


[Attachment #3 (text/html)]

&lt;html&gt;&lt;head&gt;&lt;style type='text/css'&gt;p { margin: 0; }&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div \
style='font-family: Times New Roman; font-size: 12pt; color: #000000'&gt;&lt;blockquote \
style="border-left:2px solid rgb(16, 16, \
255);margin-left:5px;padding-left:5px;"&gt;&lt;b&gt;De: &lt;/b&gt;"William A. Mahaffey III" \
&lt;wam@hiwaay.net&gt;&lt;br&gt;&lt;b&gt;À: &lt;/b&gt;libvirt-users@redhat.com&lt;br&gt;&lt;b&gt;Envoyé: \
&lt;/b&gt;Mercredi 17 Août 2011 15:45:15&lt;br&gt;&lt;b&gt;Objet: &lt;/b&gt;Re: [libvirt-users] virt-install \
-&gt; guest stops at installation end&lt;br&gt;&lt;br&gt;

  
    
    &lt;title&gt;&lt;/title&gt;
  
  
    On 08/17/11 07:23, Julien Garet wrote:
    &lt;blockquote cite="mid:1152783596.281941.1313583792828.JavaMail.root@zmbs2.inria.fr"&gt;
  &lt;style&gt;p { margin: 0; }&lt;/style&gt;
      &lt;div style="font-family: Times New Roman; font-size: 12pt; color:
        rgb(0, 0, 0);"&gt;&lt;span style="color: rgb(0, 0, 0); font-family:
          'Times New Roman'; font-size: 12pt;"&gt;Hello,&lt;br&gt;
          &lt;br&gt;
          &lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 0);
          font-family: 'Times New Roman'; font-size: 12pt;"&gt;I am using
          virt-install to install CentOS6 guests on a CentOS6 KVM remote
          host. Everything works fine except that at the end of the
          installation, the guest stops instead of rebooting, which I
          thought, should be the default behaviour.&lt;br&gt;
        &lt;/span&gt;
        &lt;div&gt;
          &lt;div style="color: rgb(0, 0, 0); font-family: 'Times New
            Roman'; font-size: 12pt;"&gt;&lt;span&gt;&lt;br&gt;
            &lt;/span&gt;&lt;/div&gt;
          &lt;div style="color: rgb(0, 0, 0); font-family: 'Times New
            Roman'; font-size: 12pt;"&gt;&lt;span&gt;The command I use is : &lt;/span&gt;&lt;/div&gt;
          &lt;div&gt;[root@myorchestrator]# /usr/local/bin/virt-install
            --connect qemu+ssh://root@mydom0/system --name myclient
            --accelerate --ram 2048 --disk path=/mnt/client.img,size=10
            --os-type=linux --network bridge:mybridge --vnc --pxe -m
            52:54:00:00:3d:a9&lt;/div&gt;
          &lt;div&gt;&lt;br&gt;
          &lt;/div&gt;
          &lt;div&gt;virt-install version is 0.500.6 on the host where I use
            virt-install. libvirt is version 0.8.1 (CentOS 6) on dom0.&lt;/div&gt;
          &lt;div&gt;&lt;br&gt;
          &lt;/div&gt;
          &lt;div&gt;Any advice ?&lt;/div&gt;
          &lt;div style="color: rgb(0, 0, 0); font-family: 'Times New
            Roman'; font-size: 12pt;"&gt;&lt;span&gt;&lt;br&gt;
            &lt;/span&gt;&lt;/div&gt;
          &lt;div style="color: rgb(0, 0, 0); font-family: 'Times New
            Roman'; font-size: 12pt;"&gt;&lt;span&gt;Julien Garet&lt;/span&gt;&lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;pre&gt;&lt;fieldset class="mimeAttachmentHeader"&gt;&lt;/fieldset&gt;
_______________________________________________
libvirt-users mailing list
&lt;a class="moz-txt-link-abbreviated" href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt; &lt;a class="moz-txt-link-freetext" \
href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;/pre&gt;  \
&lt;/blockquote&gt;  &lt;br&gt;
    &lt;br&gt;
    &lt;br&gt;
    Try adding '--autostart' ?&lt;/blockquote&gt;Unfortunately, it does not help, \
--autostart only sets the automatic boot of the virtual machine on host boot not the \
reboot at installation end.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span name="x"&gt;&lt;/span&gt;Julien \
Garet&lt;span name="x"&gt;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20110817153409</emailId><senderName>"William A. Mahaffey III"</senderName><senderEmail>wam@hiwaay.net</senderEmail><timestampReceived>2011-08-17 15:34:09-0400</timestampReceived><subject>[libvirt-users] A few more questions ....</subject><body>



.... I have a 64-bit CentOS 5.6 VM running on a 64-bit FC14 host, 
libvirt 0.8.3-10.fc14, 64-bit. I am getting messages in my syslog file, 
2 about every 20 min. about dnsmasq:



Aug 17 04:53:52 Q6600 dnsmasq-dhcp[1969]: DHCPREQUEST(virbr0) 
192.168.122.213 52:54:00:a4:98:a3
Aug 17 04:53:52 Q6600 dnsmasq-dhcp[1969]: DHCPACK(virbr0) 
192.168.122.213 52:54:00:a4:98:a3
Aug 17 05:20:13 Q6600 dnsmasq-dhcp[1969]: DHCPREQUEST(virbr0) 
192.168.122.213 52:54:00:a4:98:a3
Aug 17 05:20:13 Q6600 dnsmasq-dhcp[1969]: DHCPACK(virbr0) 
192.168.122.213 52:54:00:a4:98:a3
Aug 17 05:40:57 Q6600 dnsmasq-dhcp[1969]: DHCPREQUEST(virbr0) 
192.168.122.213 52:54:00:a4:98:a3
Aug 17 05:40:57 Q6600 dnsmasq-dhcp[1969]: DHCPACK(virbr0) 
192.168.122.213 52:54:00:a4:98:a3
Aug 17 06:08:53 Q6600 dnsmasq-dhcp[1969]: DHCPREQUEST(virbr0) 
192.168.122.213 52:54:00:a4:98:a3
Aug 17 06:08:53 Q6600 dnsmasq-dhcp[1969]: DHCPACK(virbr0) 
192.168.122.213 52:54:00:a4:98:a3
Aug 17 06:32:44 Q6600 dnsmasq-dhcp[1969]: DHCPREQUEST(virbr0) 
192.168.122.213 52:54:00:a4:98:a3
Aug 17 06:32:44 Q6600 dnsmasq-dhcp[1969]: DHCPACK(virbr0) 
192.168.122.213 52:54:00:a4:98:a3
Aug 17 06:58:59 Q6600 dnsmasq-dhcp[1969]: DHCPREQUEST(virbr0) 
192.168.122.213 52:54:00:a4:98:a3
Aug 17 06:58:59 Q6600 dnsmasq-dhcp[1969]: DHCPACK(virbr0) 
192.168.122.213 52:54:00:a4:98:a3
Aug 17 07:19:23 Q6600 dnsmasq-dhcp[1969]: DHCPREQUEST(virbr0) 
192.168.122.213 52:54:00:a4:98:a3
Aug 17 07:19:23 Q6600 dnsmasq-dhcp[1969]: DHCPACK(virbr0) 
192.168.122.213 52:54:00:a4:98:a3
Aug 17 07:40:27 Q6600 dnsmasq-dhcp[1969]: DHCPREQUEST(virbr0) 
192.168.122.213 52:54:00:a4:98:a3
Aug 17 07:40:27 Q6600 dnsmasq-dhcp[1969]: DHCPACK(virbr0) 
192.168.122.213 52:54:00:a4:98:a3
Aug 17 08:01:33 Q6600 dnsmasq-dhcp[1969]: DHCPREQUEST(virbr0) 
192.168.122.213 52:54:00:a4:98:a3
Aug 17 08:01:33 Q6600 dnsmasq-dhcp[1969]: DHCPACK(virbr0) 
192.168.122.213 52:54:00:a4:98:a3
Aug 17 08:24:20 Q6600 rpc.mountd[1689]: authenticated mount request from 
192.168.122.213:1010 for /home (/home)
Aug 17 08:27:23 Q6600 dnsmasq-dhcp[1969]: DHCPREQUEST(virbr0) 
192.168.122.213 52:54:00:a4:98:a3
Aug 17 08:27:23 Q6600 dnsmasq-dhcp[1969]: DHCPACK(virbr0) 
192.168.122.213 52:54:00:a4:98:a3
Aug 17 08:27:49 Q6600 kernel: [253719.519366] CIFS VFS: No username 
specified
Aug 17 08:27:49 Q6600 kernel: [253719.519394] CIFS VFS: cifs_mount 
failed w/return code = -22
Aug 17 08:27:49 Q6600 kernel: [253719.527482] CIFS VFS: No username 
specified
Aug 17 08:27:49 Q6600 kernel: [253719.527507] CIFS VFS: cifs_mount 
failed w/return code = -22
Aug 17 08:31:23 Q6600 kernel: [253932.627920] CIFS VFS: No username 
specified
Aug 17 08:31:23 Q6600 kernel: [253932.627949] CIFS VFS: cifs_mount 
failed w/return code = -22
Aug 17 08:31:23 Q6600 kernel: [253932.637894] CIFS VFS: No username 
specified
Aug 17 08:31:23 Q6600 kernel: [253932.637925] CIFS VFS: cifs_mount 
failed w/return code = -22
Aug 17 08:32:51 Q6600 rpc.mountd[1689]: authenticated mount request from 
192.168.0.15:939 for /home (/home)
Aug 17 08:38:38 Q6600 rpc.mountd[1689]: authenticated unmount request 
from 192.168.0.15:619 for /home (/home)
Aug 17 08:38:43 Q6600 rpc.mountd[1689]: authenticated mount request from 
192.168.0.15:644 for /home (/home)
Aug 17 08:44:53 Q6600 rpc.mountd[1689]: authenticated unmount request 
from 192.168.0.15:699 for /home (/home)
Aug 17 08:52:08 Q6600 dnsmasq-dhcp[1969]: DHCPREQUEST(virbr0) 
192.168.122.213 52:54:00:a4:98:a3
Aug 17 08:52:08 Q6600 dnsmasq-dhcp[1969]: DHCPACK(virbr0) 
192.168.122.213 52:54:00:a4:98:a3
Aug 17 08:59:13 Q6600 rpc.mountd[1689]: authenticated unmount request 
from 192.168.122.213:671 for /home (/home)
Aug 17 09:16:46 Q6600 dnsmasq-dhcp[1969]: DHCPREQUEST(virbr0) 
192.168.122.213 52:54:00:a4:98:a3
Aug 17 09:16:46 Q6600 dnsmasq-dhcp[1969]: DHCPACK(virbr0) 
192.168.122.213 52:54:00:a4:98:a3
Aug 17 09:43:00 Q6600 dnsmasq-dhcp[1969]: DHCPREQUEST(virbr0) 
192.168.122.213 52:54:00:a4:98:a3
Aug 17 09:43:00 Q6600 dnsmasq-dhcp[1969]: DHCPACK(virbr0) 
192.168.122.213 52:54:00:a4:98:a3



They are washing other stuff out of easy view .... Is there a way to 
silence these messages ? Also, my ifconfig shows:



[root@Q6600:/etc, Wed Aug 17, 09:51 AM] 1250 # ifconfig
eth0      Link encap:Ethernet  HWaddr 00:E0:81:C4:F1:A8
           inet addr:192.168.0.9  Bcast:192.168.0.255  Mask:255.255.255.0
           inet6 addr: fe80::2e0:81ff:fec4:f1a8/64 Scope:Link
           UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
           RX packets:27188084 errors:0 dropped:0 overruns:0 frame:0
           TX packets:24641412 errors:0 dropped:0 overruns:0 carrier:0
           collisions:0 txqueuelen:1000
           RX bytes:26215788177 (24.4 GiB)  TX bytes:20506959836 (19.0 GiB)
           Interrupt:16 Memory:d0100000-d0120000

lo        Link encap:Local Loopback
           inet addr:127.0.0.1  Mask:255.0.0.0
           inet6 addr: ::1/128 Scope:Host
           UP LOOPBACK RUNNING  MTU:16436  Metric:1
           RX packets:135350 errors:0 dropped:0 overruns:0 frame:0
           TX packets:135350 errors:0 dropped:0 overruns:0 carrier:0
           collisions:0 txqueuelen:0
           RX bytes:99406539 (94.8 MiB)  TX bytes:99406539 (94.8 MiB)

virbr0    Link encap:Ethernet  HWaddr FE:54:00:A4:98:A3
           inet addr:192.168.122.1  Bcast:192.168.122.255  
Mask:255.255.255.0
           UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
           RX packets:1849 errors:0 dropped:0 overruns:0 frame:0
           TX packets:3276 errors:0 dropped:0 overruns:0 carrier:0
           collisions:0 txqueuelen:0
           RX bytes:259897 (253.8 KiB)  TX bytes:559502 (546.3 KiB)

vnet0     Link encap:Ethernet  HWaddr FE:54:00:A4:98:A3
           inet6 addr: fe80::fc54:ff:fea4:98a3/64 Scope:Link
           UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
           RX packets:2335 errors:0 dropped:0 overruns:0 frame:0
           TX packets:33985 errors:0 dropped:0 overruns:0 carrier:0
           collisions:0 txqueuelen:500
           RX bytes:308069 (300.8 KiB)  TX bytes:1933956 (1.8 MiB)

[root@Q6600:/etc, Wed Aug 17, 09:57 AM] 1251 #



Is there a way to get vnet0 to use IPV4 ? Where is that configured ? I 
presume that it (vnet0) is the server/host end of the virbr0 bridge, 
what type of interface is it ? The online docs are good &amp; voluminous, 
but I haven't (yet) found any info on this question. In fact, the pages 
I have seen where brctl commands are shown show nothing for the 
interface of virbr0 (empty space, no output), where mine shows:



[root@Q6600:/etc, Wed Aug 17, 10:19 AM] 1256 # brctl show
bridge name     bridge id               STP enabled     interfaces
virbr0          8000.fe5400a498a3       yes             vnet0
[root@Q6600:/etc, Wed Aug 17, 10:19 AM] 1257 #



hence my questions about vnet0 :-) .... TIA for any clues ....


-- 

	William A. Mahaffey III

  ----------------------------------------------------------------------

	"The M1 Garand is without doubt the finest implement of war
	 ever devised by man."
                            -- Gen. George S. Patton Jr.

</body></email><email><emailId>20110817200108</emailId><senderName>Sharad Mishra</senderName><senderEmail>snmishra@us.ibm.com</senderEmail><timestampReceived>2011-08-17 20:01:08-0400</timestampReceived><subject>[libvirt-users] segfault while unloading libvirt provider.</subject><body>

I have a CIM provider that just calls virConnectOpen("qemu:///system"); and
virConnectClose(). When cimom unloads this provider segfaults -

#0  0x000000305b420cd0 in ?? ()
(gdb) bt
#0  0x000000305b420cd0 in ?? ()
#1  0x00000031a3e05ad9 in __nptl_deallocate_tsd ()
from /lib64/libpthread.so.0
#2  0x00000031a3e0674b in start_thread () from /lib64/libpthread.so.0
#3  0x00000031a32d3d1d in clone () from /lib64/libc.so.6


If I remove virConnectOpen and virConnectClose, the provider unloads
without any problem.

I am using RHEL 5.5 with libvirt-0.6.3-33.el5 and kvm-83-164.el5.

Any ideas on this core?

Regards,
Sharad Mishra
Open Virtualization
Linux Technology Center
IBM
[Attachment #3 (text/html)]

&lt;html&gt;&lt;body&gt;
&lt;p&gt;I have a CIM provider that just calls virConnectOpen("qemu:///system"); \
and virConnectClose(). When cimom unloads this provider segfaults -&lt;br&gt; &lt;br&gt;
#0  0x000000305b420cd0 in ?? ()&lt;br&gt;
(gdb) bt&lt;br&gt;
#0  0x000000305b420cd0 in ?? ()&lt;br&gt;
#1  0x00000031a3e05ad9 in __nptl_deallocate_tsd () from /lib64/libpthread.so.0&lt;br&gt;
#2  0x00000031a3e0674b in start_thread () from /lib64/libpthread.so.0&lt;br&gt;
#3  0x00000031a32d3d1d in clone () from /lib64/libc.so.6&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
If I remove virConnectOpen and virConnectClose, the provider unloads without any \
problem.&lt;br&gt; &lt;br&gt;
I am using RHEL 5.5 with libvirt-0.6.3-33.el5 and kvm-83-164.el5.&lt;br&gt;
&lt;br&gt;
Any ideas on this core?&lt;br&gt;
&lt;br&gt;
Regards,&lt;br&gt;
Sharad Mishra&lt;br&gt;
Open Virtualization&lt;br&gt;
Linux Technology Center&lt;br&gt;
IBM&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20110817204513</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-08-17 20:45:13-0400</timestampReceived><subject>Re: [libvirt-users] Migration hangs on Gentoo with KVM</subject><body>

On 08/17/2011 02:30 PM, Jonathan Stoppani wrote:
&gt; &gt; &gt; &gt; &gt; Thanks for the prompt answer Eric! Yes, nc has a q option:
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; -q, --hold-timeout=SEC1[:SEC2]   Set hold timeout(s) for local [and remote]
&gt; &gt; &gt; &gt; 

We still haven't incorporated patches to autodetect nc usage on the 
remote side (some have been proposed by Guido, but there were some 
additional issues to address first).  Hopefully by 0.9.5...

Until that is fixed, then it very well could be that you are deadlocking 
the libvirtd handling of the remote connection due to nc holding the 
connection open too long, explaining while all further attempts to do 
something with the domain are getting stuck waiting for the nc 
connection to resolve.

&gt; &gt; Tested using qemu+tcp and it hangs the same. If I interrupt the migration (^C), \
&gt; &gt; the domain is correctly destroyed on the destination but left in the paused state \
&gt; &gt; on the source. If I try to start it manually, I obtain this error: 
&gt; &gt; # virsh resume 1
&gt; &gt; error: Failed to resume domain 1
&gt; &gt; error: Timed out during operation: cannot acquire state change lock

This is the internal mutex lock used for serializing access to libvirt 
internal structures, such as when coordinating with a remote server 
(which coordination involves the use of nc).  When you get this message, 
about the only thing you can do is restart libvirtd.  Which version of 
libvirt were you testing?  0.9.4 adds quite a few improvements on being 
able to gracefully recover from failed migrations.

&gt; &gt; 
&gt; &gt; Any insights?
&gt; 
&gt; Can someone shed some light on the libvirt locking possibilities? It seems to me \
&gt; that sanlock is not supported on gentoo (and libvirt is compiled using \
&gt; --without-sanlock); could this be the cause of the problem?

Completely unrelated.  sanlock is a program for controlling access to 
shared file storage, and has nothing to do with the internal mutex lock 
failure message you quoted above.

&gt; Is there some way to explicitly set the locking mechanism to a noop in the libvirt \
&gt; configuration?

You are confusing two terms; using the sanlock or no-op disk manager has 
nothing to do with libvirtd getting confused and deadlocking on internal 
data structures.  If you built --without-sanlock, then you are already 
using the no-op disk manager; but if sanlock is compiled in, you control 
whether to use it by modifying /etc/libvirt/qemu.conf.  But making a 
configuration change there won't affect the problem you actually saw above.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


</body></email><email><emailId>20110817212948</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-08-17 21:29:48-0400</timestampReceived><subject>Re: [libvirt-users] which vols added to storage pool during refresh?</subject><body>

On Wed, Aug 17, 2011 at 10:59:50AM -0700, Gareth S Bestor wrote:
&gt; Thanks for the quick response Daniel. 
&gt; 
&gt; &gt;What value is in 
&gt; &gt;
&gt; &gt;   /sys/bus/scsi/devices/XXXXX/type
&gt; &gt;
&gt; &gt;for the LUN in question ?  And is that value different for all the
&gt; &gt;other LUNs in that HBA ?
&gt; 
&gt; I'll check.
&gt; 
&gt; In the mean time, what sort of 'processing' does libvirt do that might 
&gt; result in an error ("If we have an error processing any volume, that will 
&gt; be skipped.")? eg if we see a vol that is not getting added, is there a 
&gt; command-line we can do to confirm there's something 'wrong' with this vol?

There's no real list of things. It is just stuff like 'open' failing or
symlink resolving failing, etc. None of this should ever happen in the
real world, but ...


Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110818115252</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-08-18 11:52:52-0400</timestampReceived><subject>Re: [libvirt-users] Detecting the last user of a connection has closed.</subject><body>

2011/8/16 Andy Joslin &lt;libvirt@bandjos.com&gt;:
&gt;
&gt;
&gt; The documentation says something that concerns me:
&gt; http://libvirt.org/html/libvirt-libvirt.html#virConnectClose
&gt;       "It is possible for the last virConnectClose to return a positive
&gt; value if some
&gt;        other object still has a temporary reference to the connection,   but
&gt; the
&gt;        application should not try to further use a connection after the
&gt;        virConnectClose that matches the initial open."
&gt;
&gt;
&gt; The application I am working on requires that I know when the last thread
&gt; using this connection goes away, so I can properly cleanup some overhead.
&gt;  If I can't trust the return value of this call, how will I know that the
&gt; connection is indeed torn down?
&gt; Under what circumstances will the virConnectClose behave this way?

Simplified example (omitting all error handling) that makes
virConnectClose return 0:

// opens a connection, ref count is 1
virConnectPtr conn = virConnectOpen("qemu:///system", 0);
// gets domain 17, conn ref count is 2, because dom depends on conn
virDomainPtr dom = virDomainLookupByID(conn, 17);
...
// free dom, conn ref count is 1 again, because dom removes ref from conn
virDomainFree(dom);
// remove a ref from conn, ref count is 0, really close the connection, ret is 0
int ret = virConnectClose(conn);

If the order of the last two calls is changed (it's totally okay to do
this) than virConnectClose returns 1:

...
// remove a ref from conn, ref count is 1, don't close the connection, ret is 1
int ret = virConnectClose(conn);
// free dom, conn ref count is 0, really close the connection dom depended on
virDomainFree(dom);

There is no way yet (like a callback or something) libvirt could tell
you when the connection is really closed in cases when virConnectClose
returned &gt; 0.

You could achieve that virConnectClose is the one that really closes
the connection when you ensure that all objects (domains, storage
pools and volume, networks etc) obtained using that connection are
freed before calling virConnectClose. Then virConnectClose will be the
one that removes the last reference from the connection and closes it.

-- 
Matthias Bolte
http://photron.blogspot.com

</body></email><email><emailId>20110819091511</emailId><senderName>Lovocas Mou</senderName><senderEmail>la.moujian@gmail.com</senderEmail><timestampReceived>2011-08-19 09:15:11-0400</timestampReceived><subject>[libvirt-users] build libvirt from source yourself and make sure to get the XenAPI driver enabled.</subject><body>

Hi,
   I want install libvirt on my ubuntu11.04, and I want to test using
libvirt to manage a xenserver,

after download the tar and extract them
when in this step : ./configure --with-esx --with-xenapi
--prefix=/opt/libvirt


....
checking for xen_vm_start in -lxenserver... no
configure: error: You must install the XenServer Library to compile XenAPI
driver with -lxenserver
.....
I get this error, but i get very few information about it from google.


&gt;&gt;libvirt can use XenAPI via libxenserver [1]. That should allow you to
&gt;&gt; use libvirt with a Citrix XenServer. You can use virsh like this
&gt;&gt; assuming you have a libxenserver enabled libvirt:
&gt;&gt;
&gt;&gt; virsh -c xenapi://my-xen-server
&gt;&gt;
&gt;&gt; But it's true, there is no documentation about this on the libvirt website
&gt;&gt; yet.
&gt;&gt;
&gt;&gt; [1] http://community.citrix.com/display/xs/Download+SDKs

I download the libxenserver source and binary file from the above url, but I
don't know how to install it and how to use -lxenserver,
can anyone help me?


thanks!

[Attachment #3 (text/html)]

&lt;br clear="all"&gt;&lt;div&gt;Hi,&lt;/div&gt;&lt;div&gt;   I want install libvirt on my ubuntu11.04, and I \
want to test using libvirt to manage a xenserver,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;after \
download the tar and extract them&lt;/div&gt;&lt;div&gt;when in this step : &lt;font \
class="Apple-style-span" color="#000099"&gt;./configure --with-esx --with-xenapi \
--prefix=/opt/libvirt&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font class="Apple-style-span" \
color="#ff0000"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" \
color="#ff0000"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" \
color="#ff0000"&gt;....&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;font class="Apple-style-span" \
color="#ff0000"&gt;checking for xen_vm_start in -lxenserver... no&lt;/font&gt;&lt;/div&gt; \
&lt;div&gt;&lt;font class="Apple-style-span" color="#ff0000"&gt;configure: error: You must \
install the XenServer Library to compile XenAPI driver with \
-lxenserver&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" \
color="#ff0000"&gt;.....&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font class="Apple-style-span" \
color="#ff0000"&gt;&lt;meta http-equiv="content-type" content="text/html; charset=utf-8"&gt;I \
get this error, but i get very few information about it from \
google.&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" color="#ff0000"&gt;&lt;br&gt; \
&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" \
color="#ff0000"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;meta http-equiv="content-type" \
content="text/html; charset=utf-8"&gt;&lt;span class="Apple-style-span" style="font-family: \
'Times New Roman'; font-size: medium; "&gt;&lt;pre&gt; &lt;font class="Apple-style-span" \
color="#3366ff"&gt;&gt;&gt;libvirt can use XenAPI via libxenserver [1]. That should \
allow you to &gt;&gt; use libvirt with a Citrix XenServer. You can use virsh like \
this &gt;&gt; assuming you have a libxenserver enabled libvirt:
&gt;&gt;
&gt;&gt; virsh -c xenapi://my-xen-server
&gt;&gt;
&gt;&gt; But it's true, there is no documentation about this on the libvirt \
website &gt;&gt; yet.
&gt;&gt;
&gt;&gt; [1] &lt;a rel="nofollow" \
href="http://community.citrix.com/display/xs/Download+SDKs"&gt;http://community.citrix.com/display/xs/Download+SDKs&lt;/a&gt;&lt;/font&gt;&lt;/pre&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;I \
download the libxenserver source and binary file from the above url, but I don't \
know how to install it and how to use -lxenserver,&lt;/div&gt; &lt;div&gt;can anyone help \
me?&lt;/div&gt;&lt;br&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;thanks!&lt;/div&gt;



</body></email><email><emailId>20110820013214</emailId><senderName>mkey</senderName><senderEmail>mkey@inter7.jp</senderEmail><timestampReceived>2011-08-20 01:32:14-0400</timestampReceived><subject>[libvirt-users] Detaching LVM volume from Windows guest</subject><body>

Hello,

I have some difficulties regarding to above title. Windows as guest OS
is running on KVM(Ubuntu natty).
After attaching LVM volume to guest OS and did "safely remove device" in
guest windows, detaching volume was failed.

&gt; root@localhost:/opt/win# virsh detach-disk testwin vdc
&gt; error: Failed to detach disk
&gt; errpr: operation failed: detaching virtio-disk2 device failed: Device
'virtio-disk2' not found

But kvm(qemu?) seems like detaching device successfully.
&gt; root@localhost:/opt/win# virsh qemu-monitor-command testwin 'info block'
&gt; drive-virtio-disk0: type=hd removable=0
file=/opt/win/win2008server.virtio.img ro=0 drv=qcow2 encrypted=0

So, problem is, libvirt doesn't know detaching, but kvm(qemu) knows.
Again, please let me know if anybody has workaround.

P.S. at some website, I found "hotunplugging is not supported in current
libvirt", is that related on this matter?

Regards,
mkey


</body></email><email><emailId>20110822082748</emailId><senderName>Marc Haber</senderName><senderEmail>mh+libvirt-users@zugschlus.de</senderEmail><timestampReceived>2011-08-22 08:27:48-0400</timestampReceived><subject>[libvirt-users] How to Connect a new CD via virt-manager</subject><body>

Hi,

I have virt-manager 0.9 connecting to a libvirtd 0.9.3 on Debian
unstable. Hypervisor being used is KVM.

In a VM, I can select the "IDE CDROM 1" and click on "disonnect" which
makes the virtual disk disappear from the virtual drive and the former
disconnect button now reads "connect". Hence, when I click there,
nothing happens.

Currently, the only way I am aware to get a new CD in the virtual
drive is to delete it and to add a new virtual CD drive.

Is this a bug, or am I doing things wrong?

Greetings
Marc

-- 
-----------------------------------------------------------------------------
Marc Haber         | "I don't trust Computers. They | Mailadresse im Header
Mannheim, Germany  |  lose things."    Winona Ryder | Fon: *49 621 72739834
Nordisch by Nature |  How to make an American Quilt | Fax: *49 3221 2323190

</body></email><email><emailId>20110822163104</emailId><senderName>Sharad Mishra</senderName><senderEmail>snmishra@us.ibm.com</senderEmail><timestampReceived>2011-08-22 16:31:04-0400</timestampReceived><subject>[libvirt-users] issue with virErrorInitialize</subject><body>

One of my team mate investigated the issue where libvirt-cim was
segfaulting when unloading providers. More info on this issue is at
https://www.redhat.com/archives/libvirt-users/2011-August/msg00069.html=


Here is the gist of his investigation -


I've looked into the libvirt source code and the reason for issues with=
 the
unload of libvirt-cim providers is there (and cimprovider -r forces an
unload,
just as cimserver shutdown does).

virConnectOpen() does call virInitialize() which then will initialize t=
he
gcrypt library after initializes the thread setup -&gt;virThreadInitialize=
(),
creates the error reporting structure -&gt;virErrorInitialize() and initia=
lize
a
random number generator -&gt;virRandomInitialize().

The issue is hidden in virErrorInitialize(). It calls virErrorInitializ=
e()
which uses the wrapper function virThreadLocalInit(&amp;virLastErr,
virLastErrFreeData);.
virThreadLocalInit() calls pthread_create() with a destructor function
(virLastErrFreeData()) which will be called on thread exits.

Trouble here is that pthread_key_delete() is never called in libvirt, b=
ut
next
time the system runs through the key list and libvirt has been unloaded=
 the
system will jump to an already unloaded function (the pointer were
virLastErrFreeData() was loaded formerly) and consequently crash the
process.

Fixing this will not be easy, but a start would be a libvirt function o=
n
its
externalize interface that allows cleanup short before library unload, =
or
alternatively libvirt does the thread key delete on library unload.

Thanks
Sharad Mishra
Open Virtualization
Linux Technology Center
IBM=

[Attachment #3 (text/html)]

&lt;html&gt;&lt;body&gt;
&lt;p&gt;&lt;tt&gt;One of my team mate investigated the issue where libvirt-cim was segfaulting \
when unloading providers. More info on this issue is at &lt;/tt&gt;&lt;tt&gt;&lt;a \
href="https://www.redhat.com/archives/libvirt-users/2011-August/msg00069.html"&gt;https://www.redhat.com/archives/libvirt-users/2011-August/msg00069.html&lt;/a&gt;&lt;/tt&gt;&lt;br&gt;
 &lt;br&gt;
&lt;tt&gt;Here is the gist of his investigation -&lt;/tt&gt;&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;tt&gt;I've looked into the libvirt source code and the reason for issues with the&lt;br&gt;
unload of libvirt-cim providers is there (and cimprovider -r forces an unload,&lt;br&gt;
just as cimserver shutdown does).&lt;br&gt;
&lt;br&gt;
virConnectOpen() does call virInitialize() which then will initialize the&lt;br&gt;
gcrypt library after initializes the thread setup -&gt;virThreadInitialize(),&lt;br&gt;
creates the error reporting structure -&gt;virErrorInitialize() and initialize a&lt;br&gt;
random number generator -&gt;virRandomInitialize().&lt;br&gt;
&lt;br&gt;
The issue is hidden in virErrorInitialize(). It calls virErrorInitialize()&lt;br&gt;
which uses the wrapper function virThreadLocalInit(&amp;virLastErr,&lt;br&gt;
virLastErrFreeData);.&lt;br&gt;
virThreadLocalInit() calls pthread_create() with a destructor function&lt;br&gt;
(virLastErrFreeData()) which will be called on thread exits.&lt;br&gt;
&lt;br&gt;
Trouble here is that pthread_key_delete() is never called in libvirt, but next&lt;br&gt;
time the system runs through the key list and libvirt has been unloaded the&lt;br&gt;
system will jump to an already unloaded function (the pointer were&lt;br&gt;
virLastErrFreeData() was loaded formerly) and consequently crash the process.&lt;br&gt;
&lt;br&gt;
Fixing this will not be easy, but a start would be a libvirt function on its&lt;br&gt;
externalize interface that allows cleanup short before library unload, or&lt;br&gt;
alternatively libvirt does the thread key delete on library unload.&lt;/tt&gt;&lt;br&gt;
&lt;br&gt;
&lt;tt&gt;Thanks&lt;/tt&gt;&lt;br&gt;
Sharad Mishra&lt;br&gt;
Open Virtualization&lt;br&gt;
Linux Technology Center&lt;br&gt;
IBM&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20110822170335</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2011-08-22 17:03:35-0400</timestampReceived><subject>[libvirt-users] ANNOUNCE: oz0.6.0 release</subject><body>

All,
     I'm pleased to announce release 0.6.0 of Oz.  Oz is a program for doing
automated installation of guest operating systems with limited input from
the user.
     Release 0.6.0 is a bugfix and feature release for Oz.  Some of the
highlights between Oz 0.5.0 and 0.6.0 are:

- The ability to specify the destination for the ICICLE output from oz-install
and oz-generate-icicle
- pydoc class documentation for all internal Oz classes
- Automatic detection of KVM or QEMU at runtime (this allows oz to be used
within virtual machines, although with a large performance hit)
- Less scary warning messages in the debug output
- Printing of the screenshot path when a build fails
- Ability to run multiple Oz installs of the same OS at the same time
- Support for OEL and ScientificLinux
- Support for RHEL-5.7
- Support for CentOS 6
- Support for OpenSUSE arbitrary file injection and command execution
- Ability to make the TDL (template) parsing enforce a root password
- Rejection of localhost URLs for repositories (since they must be reachable
from the guest operating system, localhost URLs make no sense)

Fedora-14, Fedora-15, and RHEL-6 packages are available for this release.  Note
that to install the RHEL-6 packages, you must be running RHEL-6.1 or later.
Instructions on how to get and use Oz are available at
http://aeolusproject.org/oz.html

If you have any questions or comments about Oz, please feel free to contact
aeolus-devel@lists.fedorahosted.org or me (clalance@redhat.com) directly.

Thanks to everyone who contributed to this release through bug reports,
patches, and suggestions for improvement.

-- 
Chris Lalancette

</body></email><email><emailId>20110823142508</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-08-23 14:25:08-0400</timestampReceived><subject>Re: [libvirt-users] pool assumed to have 512B sector</subject><body>

On Tue, Aug 23, 2011 at 12:49:41PM +0300, David Cohen wrote:
&gt; Hi,
&gt; 
&gt; 
&gt; The xml file used to create the pool :
&gt; 
&gt; &lt;pool type='disk'&gt;
&gt; &lt;name&gt;guest_images_disk&lt;/name&gt;
&gt; &lt;source&gt;
&gt; &lt;device path='/dev/sdb'/&gt;
&gt; &lt;format type='gpt'/&gt;
&gt; &lt;/source&gt;
&gt; &lt;target&gt;
&gt; &lt;path&gt;/dev&lt;/path&gt;
&gt; &lt;/target&gt;
&gt; &lt;/pool&gt;

Ok, it is a disk partition based pool. It appears that our parted
code is assuming 512 byte sectors as you thought. I reckon that
this change should fix it


diff --git a/src/storage/parthelper.c b/src/storage/parthelper.c
index acc9171..964aa78 100644
--- a/src/storage/parthelper.c
+++ b/src/storage/parthelper.c
@@ -157,17 +157,17 @@ int main(int argc, char **argv)
                    part-&gt;num, '\0',
                    type, '\0',
                    content, '\0',
-                   part-&gt;geom.start * 512llu, '\0',
-                   (part-&gt;geom.end + 1 ) * 512llu, '\0',
-                   part-&gt;geom.length * 512llu, '\0');
+                   part-&gt;geom.start * dev-&gt;sector_size, '\0',
+                   (part-&gt;geom.end + 1 ) * dev-&gt;sector_size, '\0',
+                   part-&gt;geom.length * dev-&gt;sector_size, '\0');
         } else {
             printf("%s%c%s%c%s%c%llu%c%llu%c%llu%c",
                    "-", '\0',
                    type, '\0',
                    content, '\0',
-                   part-&gt;geom.start * 512llu, '\0',
-                   (part-&gt;geom.end + 1 ) * 512llu, '\0',
-                   part-&gt;geom.length * 512llu, '\0');
+                   part-&gt;geom.start * dev-&gt;sector_size, '\0',
+                   (part-&gt;geom.end + 1 ) * dev-&gt;sector_size, '\0',
+                   part-&gt;geom.length * dev-&gt;sector_size, '\0');
         }
         part = ped_disk_next_partition(disk, part);
     }


but I don't have any way to test this myself

Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110823154010</emailId><senderName>Umberto Carrara</senderName><senderEmail>info@umbertocarrara.it</senderEmail><timestampReceived>2011-08-23 15:40:10-0400</timestampReceived><subject>Re: [libvirt-users] Problem to migrate virtual machine between two hosts with same uuid</subject><body>

Il martedì 23 agosto 2011 13:18:33 Daniel P. Berrange ha scritto:

&gt; &gt;
&gt; &gt; The problem seems to be the same uuid on both hosts,
&gt; &gt;
&gt; &gt; 1) is correct?
&gt;
&gt; Yes, your hardware vendor is being very very bad :-(
&gt;
&gt; &gt; 2) if is correct, how I can resolve?
&gt;
&gt; You could complain to the hardware vendor, but I rather doubt
&gt; that they would ever do anything about it.
&gt;
&gt; So, libvirtd provides a way to override the default host UUID,
&gt; by setting 'host_uuid' in /etc/libvirt/libvirtd.conf, which
&gt; should make the migration sanity check pass.

Works!! Thanks a lot.

&gt;
&gt; Daniel

Umberto



</body></email><email><emailId>20110823210533</emailId><senderName>Dave Allan</senderName><senderEmail>dallan@redhat.com</senderEmail><timestampReceived>2011-08-23 21:05:33-0400</timestampReceived><subject>Re: [libvirt-users] migration in parallel</subject><body>

On Tue, Aug 23, 2011 at 01:50:58PM -0700, Yih-Herng Chuang wrote:
&gt; 
&gt; Hi Dave,
&gt; 
&gt; The version we have is libvirt-0.8.1-27.el6.x86_64.

There were a bunch of migration fixes around commit id f9a837da which
would be in 0.9.4, so much newer than what you have, but specifically
what errors are you seeing?  Can you reproduce them with the current
git HEAD?

Dave
  
&gt; Regards,
&gt; 
&gt; --Yih
&gt; 
&gt; Yih-Herng Chuang
&gt; IBM Center for Microsoft Technologies
&gt; 3600 Carillon Point, Kirkland WA 98033
&gt; (DID) (425) 803-7285
&gt; (TIE) 977-7285
&gt; YihHerng@us.ibm.com
&gt; 
&gt; 
&gt; 
&gt; From:	Dave Allan &lt;dallan@redhat.com&gt;
&gt; To:	Yih-Herng Chuang/Seattle/IBM@IBMUS
&gt; Cc:	libvirt-users@redhat.com
&gt; Date:	08/23/2011 01:27 PM
&gt; Subject:	Re: [libvirt-users] migration in parallel
&gt; 
&gt; 
&gt; 
&gt; On Tue, Aug 23, 2011 at 11:50:00AM -0700, Yih-Herng Chuang wrote:
&gt; &gt;
&gt; &gt; Hi,
&gt; &gt;
&gt; &gt; We ran into various errors when tried to run migration in parallel.  Does
&gt; &gt; libvirt support migration in parallel?
&gt; 
&gt; What version of libvirt?  There were some problems with parallel
&gt; migration in the past, but they have all been fixed by 0.9.4 as far as
&gt; I know.
&gt; 
&gt; Dave
&gt; 
&gt; 
&gt; &gt; Regards,
&gt; &gt;
&gt; &gt; --Yih
&gt; &gt;
&gt; &gt; Yih-Herng Chuang
&gt; &gt; IBM Center for Microsoft Technologies
&gt; &gt; 3600 Carillon Point, Kirkland WA 98033
&gt; &gt; (DID) (425) 803-7285
&gt; &gt; (TIE) 977-7285
&gt; &gt; YihHerng@us.ibm.com
&gt; 
&gt; &gt; _______________________________________________
&gt; &gt; libvirt-users mailing list
&gt; &gt; libvirt-users@redhat.com
&gt; &gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; 


</body></email><email><emailId>20110824014721</emailId><senderName>Stephen Eilert</senderName><senderEmail>spedrosa@gmail.com</senderEmail><timestampReceived>2011-08-24 01:47:21-0400</timestampReceived><subject>Re: [libvirt-users] Strange libvirt exit status 1 (LXC containers)</subject><body>

Again, replying to myself.

It seems that my assessment that app armor wasn't interfering was mistaken. Found it \
in the logs:

Aug 23 22:55:44 pea kernel: [17442.226663] type=1400 audit(1314150944.573:64): a
pparmor="DENIED" operation="exec" parent=10501 profile="/usr/sbin/libvirtd" name
="/usr/libexec/libvirt_lxc" pid=10712 comm="libvirtd" requested_mask="x" denied_
mask="x" fsuid=0 ouid=0

Sorry for all the noise.


-- Stephen

On Aug 23, 2011, at 10:08 PM, Stephen Eilert wrote:

&gt; Answering myself. I've enabled as much logging as possible, and asked libvirt to \
&gt; log lxc. This is the result: 
&gt; 2011-08-23 22:19:08.778: starting up
&gt; PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/X11R6/bin \
&gt; LIBVIRT_DEBUG=1 LIBVIRT_LOG_OUTPUTS=1:syslog:libvirtd /usr/libexec/libvirt_lxc \
&gt; --name vm_14 --console 18 --handshake 21 --background --veth veth1 22:19:08.791: \
&gt; 10215: info : libvirt version: 0.9.4 22:19:08.791: 10215: debug : \
&gt;                 virCommandHook:1962 : Hook is done 0
&gt; libvir: error : cannot execute binary /usr/libexec/libvirt_lxc: Permission denied
&gt; 
&gt; Stil not sure what would prevent libvirt_lxc execution - tested with an \
&gt; unprivileged user and it was able to run the binary (but not actually start the \
&gt; VMs). The error message seem to indicate that the 'exec' call failed. Nothing shows \
&gt; on app armor (disabled it) or other logs in general. 
&gt; 
&gt; -- Stephen
&gt; 
&gt; 
&gt; On Aug 23, 2011, at 7:56 PM, Stephen Eilert wrote:
&gt; 
&gt; &gt; 
&gt; &gt; Hello,
&gt; &gt; 
&gt; &gt; I've encountered the following error, trying to start a domain:
&gt; &gt; 
&gt; &gt; error: internal error Child process \
&gt; &gt; (PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/X11R6/bin \
&gt; &gt; LIBVIRT_DEBUG=2 LIBVIRT_LOG_OUTPUTS=2:syslog:libvirtd /usr/libexec/libvirt_lxc \
&gt; &gt; --name vm_14 --console 18 --handshake 21 --background --veth veth1) status \
&gt; &gt; unexpected: exit status 1 
&gt; &gt; I see nothing relevant in syslog, google searches have returned nothing. Starting \
&gt; &gt; libvirt_lxc manually seems to work (the process never returns), but of course the \
&gt; &gt; VMs do not start. 
&gt; &gt; I am at a loss on what to do next. I'm running Ubuntu 10.04, which is itself a \
&gt; &gt; guest system running under virtual box (host is OSX Lion). I've compiled libvirt \
&gt; &gt; from git (using /usr as the --prefix, after removing the OS package), LXC \
&gt; &gt; containers are installed from a PPA, as the default Ubuntu kernel doesn't enable \
&gt; &gt; network namespaces. LXC itself doesn't appear to be a problem, as I can start VMs \
&gt; &gt; with lxc-start. Since I required libvirt's API, using LXC directly is not \
&gt; &gt; desirable. 
&gt; &gt; Does anyone have any tips on what I should be looking for? Thanks.
&gt; &gt; 
&gt; &gt; 
&gt; &gt; -- Stephen
&gt; &gt; 
&gt; &gt; 
&gt; &gt; -- Domain definition follows:
&gt; &gt; 
&gt; &gt; &lt;domain type='lxc'&gt;
&gt; &gt; &lt;name&gt;vm_14&lt;/name&gt;
&gt; &gt; &lt;uuid&gt;9243fb5b-6b26-44af-7408-69c7f2d4ff03&lt;/uuid&gt;
&gt; &gt; &lt;memory&gt;262144&lt;/memory&gt;
&gt; &gt; &lt;currentMemory&gt;262144&lt;/currentMemory&gt;
&gt; &gt; &lt;vcpu&gt;1&lt;/vcpu&gt;
&gt; &gt; &lt;os&gt;
&gt; &gt; &lt;type arch='x86_64'&gt;exe&lt;/type&gt;
&gt; &gt; &lt;init&gt;/sbin/init&lt;/init&gt;
&gt; &gt; &lt;/os&gt;
&gt; &gt; &lt;clock offset='utc'/&gt;
&gt; &gt; &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
&gt; &gt; &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
&gt; &gt; &lt;on_crash&gt;preserve&lt;/on_crash&gt;
&gt; &gt; &lt;devices&gt;
&gt; &gt; &lt;emulator&gt;/usr/libexec/libvirt_lxc&lt;/emulator&gt;
&gt; &gt; &lt;filesystem type='mount' accessmode='passthrough'&gt;
&gt; &gt; &lt;source dir='/var/lib/lxc/vmpea/rootfs/'/&gt;
&gt; &gt; &lt;target dir='/'/&gt;
&gt; &gt; &lt;readonly/&gt;
&gt; &gt; &lt;/filesystem&gt;
&gt; &gt; &lt;filesystem type='mount' accessmode='passthrough'&gt;
&gt; &gt; &lt;source dir='/home/lxcadmin/repositories/14'/&gt;
&gt; &gt; &lt;target dir='/home/lxcmaster'/&gt;
&gt; &gt; &lt;/filesystem&gt;
&gt; &gt; &lt;interface type='network'&gt;
&gt; &gt; &lt;mac address='52:54:00:10:7a:e7'/&gt;
&gt; &gt; &lt;source network='default'/&gt;
&gt; &gt; &lt;target dev='veth0'/&gt;
&gt; &gt; &lt;/interface&gt;
&gt; &gt; &lt;console type='pty'&gt;
&gt; &gt; &lt;target type='serial' port='0'/&gt;
&gt; &gt; &lt;/console&gt;
&gt; &gt; &lt;/devices&gt;
&gt; &gt; &lt;/domain&gt;
&gt; &gt; 
&gt; &gt; 
&gt; 


</body></email><email><emailId>20110824140103</emailId><senderName>Guido Winkelmann</senderName><senderEmail>guido-libvi@unknownsite.de</senderEmail><timestampReceived>2011-08-24 14:01:03-0400</timestampReceived><subject>[libvirt-users] pool-refresh on iSCSI pools does not actually rescan the bus</subject><body>

Hi,

When I add a new LUN on an iscsi target and then issue a pool-refresh command 
on the respective storage pool in libvirt, libvirt will not find the new lun 
(or notice if luns have been removed).

I'm using a Dell PowerVault MD3200i iSCSI Array to hold the volumes for 
virtual servers in libvirt. In libvirt, I have defined the storage pool as 
this:

&lt;pool type='iscsi'&gt;
  &lt;name&gt;iscsi01&lt;/name&gt;
  &lt;uuid&gt;52eb9c59-a7ac-a4e8-a26e-7ca112f0dd70&lt;/uuid&gt;
  &lt;capacity&gt;85899345920&lt;/capacity&gt;
  &lt;allocation&gt;85899345920&lt;/allocation&gt;
  &lt;available&gt;0&lt;/available&gt;
  &lt;source&gt;
    &lt;host name='10.3.1.15'/&gt;
    &lt;device 
path='iqn.1984-05.com.dell:powervault.md3200i.6782bcb0000859f3000000004d3eec7d'/&gt;
  &lt;/source&gt;
  &lt;target&gt;
    &lt;path&gt;/dev/disk/by-id&lt;/path&gt;
    &lt;permissions&gt;
      &lt;mode&gt;0700&lt;/mode&gt;
      &lt;owner&gt;-1&lt;/owner&gt;
      &lt;group&gt;-1&lt;/group&gt;
    &lt;/permissions&gt;
  &lt;/target&gt;
&lt;/pool&gt;

If I add a new LUN on the iSCSI array, and then issue the command "pool-
refresh iscsi01", followed by "vol-list iscsi01" in virsh, the list does not 
contain the new volume. The only workaround I have found so far for this is to 
manually log in to the host server as root, do "iscsiadm -m discovery -t 
sendtargets -p 10.3.1.15" and then issue the pool-refresh command in libvirt.

Libvirt is libvirt-0.8.3-4.fc14.x86_64 on Fedora 14.

Is this supposed to work like this? If not, will a newer version fix that 
problem?

Regards,

	Guido

</body></email><email><emailId>20110824171121</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2011-08-24 17:11:21-0400</timestampReceived><subject>Re: [libvirt-users] libvirt ruby binding with vmware</subject><body>

On 08/23/11 - 09:16:14PM, Matthias Bolte wrote:
&gt; 2011/8/23 Ohad Levy &lt;ohadlevy@gmail.com&gt;:
&gt; &gt; Hi,
&gt; &gt; I've been trying to use the ruby libvirt binding with vmware esx on F15,
&gt; &gt; however it doesnt seems to work, I get:
&gt; &gt; Libvirt::ConnectionError: Call to virConnectOpen failed: Cannot access CA
&gt; &gt; certificate '/etc/pki/CA/cacert.pem': No such file or directory
&gt; &gt; I've using the same uri with virsh and it works.
&gt; &gt; it seems like somehow the no_verify is not passed, or we are back to old
&gt; &gt; libvirt error messages :)
&gt; &gt; any idea?
&gt; &gt; thanks,
&gt; &gt; Ohad
&gt; 
&gt; As the ESX driver documentation says, you need to use
&gt; virConnectOpenAuth (what virsh does by default). You're error message
&gt; talks about virConnectOpen so there is your problem. You need to use
&gt; virConnectOpenAuth with the Ruby Bindings too.
&gt; 
&gt; Until libvirt 0.9.2 the ESX driver declines connection attempts when
&gt; virConnectOpen is used. Since 0.9.2 this is reported as the error it
&gt; actually is.
&gt; 
&gt; When the ESX driver declines the connection attempt libvirt will end
&gt; up trying to connect to a non-existing libvirtd on the ESX server in
&gt; order to find a driver that accepts the connection attempt. By default
&gt; it uses TLS for this and that's why it's looking for TLS certificates.
&gt; This is not related to the no_verify option.
&gt; 
&gt; So you're probably using libvirt &lt; 0.9.2 and are using virConnectOpen
&gt; instead of virConnectOpenAuth.

Ohad, please let me know your experience using the ruby Libvirt::open_auth
method.  I tried to make it "ruby-ish", and it works for me, but I will be the
first to admit that it is a bit baroque.

-- 
Chris Lalancette

</body></email><email><emailId>20110826062007</emailId><senderName>Frank =?iso-8859-15?Q?Matthie=DF?=</senderName><senderEmail>frankm@lug-owl.de</senderEmail><timestampReceived>2011-08-26 06:20:07-0400</timestampReceived><subject>[libvirt-users] libvirt sheepdog support (Was:  (no subject))</subject><body>


Hi all,

* Daniel P. Berrange &lt;berrange@redhat.com&gt; [2011-08-25 13:47]:
&gt; On Thu, Aug 25, 2011 at 07:31:31PM +0800, lingjiao.lc wrote:
&gt; &gt;   I've used the libvirt and sheepdog, they are so great!
&gt; &gt; But I have one question about libvirt and sheepdog.
&gt; &gt; As we know, I can use this command to create a sheepdog image,
&gt; &gt; 
&gt; &gt;          #qemu-img create –f raw sheepdog:fedora15.img 40G
&gt; &gt; 
&gt; &gt; but how can I create a pool and volume for sheepdog with the xml of libvirt ?
&gt; 
&gt; Libvirt doesn't have a pool/volume implementation for sheepdog yet.
&gt; You can currently only configure the guest XML with sheepdog
&gt; We'd like sheepdog pool support in the future of course...

The developer of sheepdog are planning to create a libcollie(?), which
encapsulate the full client functionality. This will help to integrate
sheepdog also in libvirt.

See: http://lists.wpkg.org/pipermail/sheepdog/2011-August/001286.html

Frank.

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20110830020956</emailId><senderName>Kevins Thoughts</senderName><senderEmail>thoughts@kevinsthoughts.com</senderEmail><timestampReceived>2011-08-30 02:09:56-0400</timestampReceived><subject>[libvirt-users] New with Libvirt and having problems.</subject><body>

Hi all.

I've been playing around with KVM for a bit now and have several virtual 
machines up and running.  Having passed what I considered "first look" 
stage, I'm ready to start using libvirt as a manager.  For reference, 
pre-libvirt, I have started this VM with:

/kvm -net nic,model=virtio -net tap,ifname=tap5,script=no  -drive 
file=test1.img,if=virtio,boot=on -curses -no-reboot -m 1g -smp 2/

I have a test environment I like to play with, and created the initial 
domain XML using virt-install:

/virt-install --name "Test" --ram 1024 --vcpus=2  --cpu host 
--description "Test VM" --import --file test1.img --os-type=linux 
--os-variant=virtio26  --network bridge=br0,model=virtio --graphics=none 
--autostart --prompt/

When I look in /var/log/libvirt/qemu/Test.log  I see the VM is started 
with the command (edited down to the relevant parts):

//usr/bin/qemu-kvm -S -m 1024 -smp 2 -name Test,process=qemu:Test 
-nographics -boot c -drive file=/kvms/test1.img,if=none,boot=on

/This has two problems:

1) The "-S" is keeping the system from booting
2)  the "if=none" needs to be "if=virtio"

I've confirmed both by changing -nographics to -curses and watching what 
happens.  For #1, its a big fat nothing (no surprise since -S turns off 
the CPUs), for #2 grub loads and the kernel boots, but my /dev/vda3 
isn't found so "init" can't start.

I'm anticipating a 3rd problem:  I don't see where to specify that I 
want the VM to use "tap5" of my bridged network.

Can some kind soul please let me know what I need to change in the 
domain XML file to fix these issues?

Thanks,

Kevin

ps.  I've post this to my blog at 
http://www.kevinsthoughts.com/2011/08/kvm-management-libvirt/ if anyone 
would prefer to answer there.


[Attachment #3 (text/html)]

&lt;html&gt;
  &lt;head&gt;

    &lt;meta http-equiv="content-type" content="text/html; charset=ISO-8859-1"&gt;
  &lt;/head&gt;
  &lt;body bgcolor="#FFFFFF" text="#000000"&gt;
    Hi all.&lt;br&gt;
    &lt;br&gt;
    I've been playing around with KVM for a bit now and have several
    virtual machines up and running.  Having passed what I considered
    "first look" stage, I'm ready to start using libvirt as a manager. 
    For reference, pre-libvirt, I have started this VM with:&lt;br&gt;
    &lt;br&gt;
    &lt;i&gt;kvm -net nic,model=virtio -net tap,ifname=tap5,script=no  -drive
      file=test1.img,if=virtio,boot=on -curses -no-reboot -m 1g -smp 2&lt;/i&gt;&lt;br&gt;
    &lt;br&gt;
    I have a test environment I like to play with, and created the
    initial domain XML using virt-install:&lt;br&gt;
    &lt;br&gt;
    &lt;i&gt;virt-install --name "Test" --ram 1024 --vcpus=2  --cpu host
      --description "Test VM" --import --file test1.img --os-type=linux
      --os-variant=virtio26  --network bridge=br0,model=virtio
      --graphics=none --autostart --prompt&lt;/i&gt;&lt;br&gt;
    &lt;br&gt;
    When I look in /var/log/libvirt/qemu/Test.log  I see the VM is
    started with the command (edited down to the relevant parts):&lt;br&gt;
    &lt;br&gt;
    &lt;i&gt;/usr/bin/qemu-kvm -S -m 1024 -smp 2 -name Test,process=qemu:Test
      -nographics -boot c -drive file=/kvms/test1.img,if=none,boot=on&lt;br&gt;
      &lt;br&gt;
    &lt;/i&gt;This has two problems:&lt;br&gt;
    &lt;br&gt;
    1) The "-S" is keeping the system from booting&lt;br&gt;
    2)  the "if=none" needs to be "if=virtio"&lt;br&gt;
    &lt;br&gt;
    I've confirmed both by changing -nographics to -curses and watching
    what happens.  For #1, its a big fat nothing (no surprise since -S
    turns off the CPUs), for #2 grub loads and the kernel boots, but my
    /dev/vda3 isn't found so "init" can't start.&lt;br&gt;
    &lt;br&gt;
    I'm anticipating a 3rd problem:  I don't see where to specify that I
    want the VM to use "tap5" of my bridged network.&lt;br&gt;
    &lt;br&gt;
    Can some kind soul please let me know what I need to change in the
    domain XML file to fix these issues?&lt;br&gt;
    &lt;br&gt;
    Thanks,&lt;br&gt;
    &lt;br&gt;
    Kevin&lt;br&gt;
    &lt;span id="sample-permalink"&gt;&lt;/span&gt;&lt;br&gt;
    ps.  I've post this to my blog at &lt;span id="sample-permalink"&gt;&lt;a \
class="moz-txt-link-freetext" \
href="http://www.kevinsthoughts.com/2011/08/"&gt;http://www.kevinsthoughts.com/2011/08/&lt;/a&gt;&lt;span
  id="editable-post-name" title="Click to edit this part of the
        permalink"&gt;kvm-management-libvirt&lt;/span&gt;/ if anyone would prefer
      to answer there.&lt;/span&gt;&lt;br&gt;
    &lt;br&gt;
  &lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20110830050119</emailId><senderName>Kevins Thoughts</senderName><senderEmail>thoughts@kevinsthoughts.com</senderEmail><timestampReceived>2011-08-30 05:01:19-0400</timestampReceived><subject>Re: [libvirt-users] New with Libvirt and having problems.</subject><body>

&gt;
&gt; Ah I never gave KVM or virtualization a try in Gentoo.  None of my 
&gt; servers have X though using X11 forwarding still works.  In CentOS the 
&gt; package is xorg-x11-xauth  , looks like it may be x11-apps/xauth in 
&gt; Gentoo.
No X anywhere in my environment &lt;smile&gt;.  Somehow I normally manage!

&gt;
&gt; Does "virsh iface-list" show tap5?
Actually that command errors out:

/virsh # iface-list
error: Failed to list active interfaces
error: this function is not supported by the connection driver: 
virConnectNumOfInterfaces/

&gt;
&gt; For the disk, this is what I have for my virtio disks...
&gt;
&gt; &lt;disk type='file' device='disk'&gt;
&gt; &lt;driver name='qemu' type='qcow2'/&gt;
&gt; &lt;source file='/vmstore/images/domain0001.qcow2'/&gt;
&gt; *&lt;target dev='vdb' bus='virtio'/&gt;*
&gt; &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x06' 
&gt; function='0x0'/&gt;
&gt; &lt;/disk&gt;

My XML had the type wrong, setting it to raw.

Alas, I still see the invoked KVM being passed:

/-drive 
file=/kvms/test1.img,if=none,id=drive-virtio-disk0,boot=on,format=qcow2 /

The "if=none" is the problem, it needs to be "if=virtio".  KVM is also 
still being passed the "-S" flag as its first parameter, so the CPUs are 
not starting.

&gt;
&gt; Also maybe add something like this to your virt-install line...
&gt;
&gt; "--disk path=test1.img,device=disk,bus=virtio"

At this point, I'm just editing the XML, its easier.  Once I get one 
working, I can tweak for the others.  Virt-install at least got me started.

Kevin

[Attachment #3 (text/html)]

&lt;html&gt;
  &lt;head&gt;
    &lt;meta content="text/html; charset=ISO-8859-1"
      http-equiv="Content-Type"&gt;
  &lt;/head&gt;
  &lt;body bgcolor="#FFFFFF" text="#000000"&gt;
    &lt;br&gt;
    &lt;blockquote
cite="mid:CAN0oX1aBwitmi2cihMwRP8D+K=Oh4H3Mvg_1O1X5ATesPuvv6Q@mail.gmail.com"
      type="cite"&gt;
      &lt;div class="gmail_quote"&gt;
        &lt;blockquote class="gmail_quote" style="margin:0 0 0
          .8ex;border-left:1px #ccc solid;padding-left:1ex;"&gt;
          &lt;div bgcolor="#FFFFFF" text="#000000"&gt; &lt;br&gt;
          &lt;/div&gt;
        &lt;/blockquote&gt;
      &lt;/div&gt;
      &lt;div&gt;Ah I never gave KVM or virtualization a try in Gentoo.  None
        of my servers have X though using X11 forwarding still works.
         In CentOS the package is &lt;span class="Apple-style-span"
          style="font-family: Monaco, 'Lucida Console', monospace;
          font-size: 10px; line-height: 14px; white-space: nowrap;
          background-color: rgb(241, 241, 241); "&gt;xorg-x11-xauth&lt;/span&gt; 
        , looks like it may be x11-apps/xauth in Gentoo.&lt;/div&gt;
    &lt;/blockquote&gt;
    No X anywhere in my environment &lt;smile&gt;.  Somehow I normally
    manage!&lt;br&gt;
    &lt;br&gt;
    &lt;blockquote
cite="mid:CAN0oX1aBwitmi2cihMwRP8D+K=Oh4H3Mvg_1O1X5ATesPuvv6Q@mail.gmail.com"
      type="cite"&gt;
      &lt;div&gt;&lt;br&gt;
      &lt;/div&gt;
      &lt;div&gt;Does "virsh iface-list" show tap5?&lt;/div&gt;
    &lt;/blockquote&gt;
    Actually that command errors out:&lt;br&gt;
    &lt;br&gt;
    &lt;i&gt;virsh # iface-list&lt;br&gt;
      error: Failed to list active interfaces&lt;br&gt;
      error: this function is not supported by the connection driver:
      virConnectNumOfInterfaces&lt;/i&gt;&lt;br&gt;
    &lt;br&gt;
    &lt;blockquote
cite="mid:CAN0oX1aBwitmi2cihMwRP8D+K=Oh4H3Mvg_1O1X5ATesPuvv6Q@mail.gmail.com"
      type="cite"&gt;
      &lt;div&gt;&lt;br&gt;
      &lt;/div&gt;
      &lt;div&gt;For the disk, this is what I have for my virtio disks...&lt;/div&gt;
      &lt;div&gt;&lt;br&gt;
      &lt;/div&gt;
      &lt;div&gt;
        &lt;div&gt;    &lt;disk type='file' device='disk'&gt;&lt;/div&gt;
        &lt;div&gt;      &lt;driver name='qemu' type='qcow2'/&gt;&lt;/div&gt;
        &lt;div&gt;      &lt;source
          file='/vmstore/images/domain0001.qcow2'/&gt;&lt;/div&gt;
        &lt;div&gt; &lt;b&gt;     &lt;target dev='vdb' bus='virtio'/&gt;&lt;/b&gt;&lt;/div&gt;
        &lt;div&gt;      &lt;address type='pci' domain='0x0000' bus='0x00'
          slot='0x06' function='0x0'/&gt;&lt;/div&gt;
        &lt;div&gt;    &lt;/disk&gt;&lt;/div&gt;
      &lt;/div&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
    My XML had the type wrong, setting it to raw.&lt;br&gt;
    &lt;br&gt;
    Alas, I still see the invoked KVM being passed:  &lt;br&gt;
    &lt;br&gt;
     &lt;i&gt;-drive
      file=/kvms/test1.img,if=none,id=drive-virtio-disk0,boot=on,format=qcow2
    &lt;/i&gt;&lt;br&gt;
    &lt;br&gt;
    The "if=none" is the problem, it needs to be "if=virtio".  KVM is
    also still being passed the "-S" flag as its first parameter, so the
    CPUs are not starting.  &lt;br&gt;
    &lt;br&gt;
    &lt;blockquote
cite="mid:CAN0oX1aBwitmi2cihMwRP8D+K=Oh4H3Mvg_1O1X5ATesPuvv6Q@mail.gmail.com"
      type="cite"&gt;
      &lt;div&gt;&lt;br&gt;
      &lt;/div&gt;
      &lt;div&gt;Also maybe add something like this to your virt-install
        line...&lt;/div&gt;
      &lt;div&gt;&lt;br&gt;
      &lt;/div&gt;
      &lt;div&gt;"--disk path=test1.img,device=disk,bus=virtio" &lt;br&gt;
      &lt;/div&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
    At this point, I'm just editing the XML, its easier.  Once I get one
    working, I can tweak for the others.  Virt-install at least got me
    started.&lt;br&gt;
    &lt;br&gt;
    Kevin&lt;br&gt;
  &lt;/body&gt;
&lt;/html&gt;


</body></email><email><emailId>20110830141433</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-08-30 14:14:33-0400</timestampReceived><subject>Re: [libvirt-users] New with Libvirt and having problems.</subject><body>

On 08/29/2011 08:09 PM, Kevins Thoughts wrote:
&gt; 
&gt; When I look in /var/log/libvirt/qemu/Test.log  I see the VM is started
&gt; with the command (edited down to the relevant parts):
&gt; 
&gt; //usr/bin/qemu-kvm -S -m 1024 -smp 2 -name Test,process=qemu:Test
&gt; -nographics -boot c -drive file=/kvms/test1.img,if=none,boot=on
&gt; 
&gt; /This has two problems:
&gt; 
&gt; 1) The "-S" is keeping the system from booting

This is intentional.  Libvirt has to make some changes via the monitor,
since qemu does not expose all functionality from the command line, so
libvirt blindly starts qemu with -S, makes subsequent monitor changes,
and then released the vcpus via monitor command (unless you used the
VIR_DOMAIN_START_PAUSED flag to keep things paused).  There is no XML to
control this, nor does there need to be, given the existence of
virDomainCreateWithFlags().

&gt; 2)  the "if=none" needs to be "if=virtio"

Have you tried 'virsh domxml-from-native qemu-argv /path/to/args' for a
shell-style command line containing the qemu command you want to run?
It's not perfect, but may give you some hints on this regard.

Meanwhile, according to the documentation, &lt;target dev=...
bus='virtio'/&gt; inside your &lt;drive&gt; xml appears to be the right way to
request a virtio drive.  Paste the actual XML you are trying to use, so
we can offer suggestions relative to your questions.

&gt; 
&gt; I've confirmed both by changing -nographics to -curses and watching what
&gt; happens.  For #1, its a big fat nothing (no surprise since -S turns off
&gt; the CPUs), for #2 grub loads and the kernel boots, but my /dev/vda3
&gt; isn't found so "init" can't start.
&gt; 
&gt; I'm anticipating a 3rd problem:  I don't see where to specify that I
&gt; want the VM to use "tap5" of my bridged network.

Does the documentation help?

http://libvirt.org/formatdomain.html#elementsNICS

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20110826142127</emailId><senderName>Alphonse Hansel Anthony</senderName><senderEmail>alphonse.anthony@gmail.com</senderEmail><timestampReceived>2011-08-26 14:21:27-0400</timestampReceived><subject>[libvirt-users] Reg: Workaround to use pivot_root while using "rootfs" for "/" ?</subject><body>

Hi All,

   I am trying to start a lxc container using libvirt and I am facing an
issue due to pivot_root.

  The return code from the system call “pivot_root” is EINVAL (Invalid
arguments).
  I isolated the issue to this specific condition check within the system
call.

This is an code snippet from fs/namespace.c::pivot_root

*    error = -EINVAL;
    if (root.mnt-&gt;mnt_root != root.dentry)
        goto out2; /* not a mountpoint */
    if (root.mnt-&gt;mnt_parent == root.mnt)  &lt;&lt; this represents a circular
mount reference
            goto out2; /* not attached */
    if (new.mnt-&gt;mnt_root != new.dentry)
        goto out2; /* not a mountpoint */
    if (new.mnt-&gt;mnt_parent == new.mnt)
        goto out2; /* not attached */
*
This issue occurs for me, since I am using fstype "rootfs" as "/" and all
binaries are mounted ISO's for execution within "/".
Based on information from the below links, I have realized, that pivot_root
is not possible for the above case.*
**https://lkml.org/lkml/2005/10/8/17
https://bugzilla.kernel.org/show_bug.cgi?id=4857
*
I would like to know , if my observations are correct and is there any
workaround to overcome this issue?

Any help in this regard would be useful.

-Alphonse

[Attachment #3 (text/html)]

&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;font size="2"&gt;&lt;span \
style="font-family:tahoma,sans-serif"&gt;Hi All,&lt;/span&gt;&lt;br \
style="font-family:tahoma,sans-serif"&gt;&lt;br&gt;   I am trying to start a lxc container \
using libvirt and I am facing an issue due to pivot_root.&lt;br \
style="font-family:tahoma,sans-serif"&gt;

&lt;/font&gt;&lt;font style="font-family:tahoma,sans-serif" face="Tahoma, Verdana, Helvetica, \
Arial" size="2"&gt;&lt;span&gt; &lt;br&gt;
  The return code from the system call “pivot_root” is EINVAL (Invalid \
arguments).&lt;br&gt;  I isolated the issue to this specific condition check within the \
system call.&lt;br&gt; &lt;br&gt;
This is an code snippet from fs/namespace.c::pivot_root&lt;br&gt;
  &lt;br&gt;
&lt;i&gt;    error = -EINVAL;&lt;br&gt;
    if (root.mnt-&gt;mnt_root != root.dentry)&lt;br&gt;
        goto out2; /* not a mountpoint */&lt;br&gt;
&lt;b&gt;    if (root.mnt-&gt;mnt_parent == root.mnt)  &lt;font color="#FF0000"&gt;&lt;&lt; this \
represents a circular mount reference &lt;br&gt; &lt;/font&gt;            goto out2; /* not \
attached */  &lt;br&gt; &lt;/b&gt;    if (new.mnt-&gt;mnt_root != new.dentry)&lt;br&gt;
        goto out2; /* not a mountpoint */&lt;br&gt;
    if (new.mnt-&gt;mnt_parent == new.mnt)&lt;br&gt;
        goto out2; /* not attached */&lt;br&gt;
&lt;/i&gt;&lt;br&gt;
This issue occurs for me, since I am using fstype "rootfs" as "/" \
and all binaries are mounted ISO's for execution within "/".&lt;br&gt;Based \
on information from the below links, I have realized, that pivot_root is not possible \
for the above case.&lt;b&gt;&lt;br&gt;


&lt;/b&gt;&lt;font color="#0000FF"&gt;&lt;u&gt;&lt;a href="https://lkml.org/lkml/2005/10/8/17" \
target="_blank"&gt;https://lkml.org/lkml/2005/10/8/17&lt;/a&gt;&lt;br&gt; &lt;a \
href="https://bugzilla.kernel.org/show_bug.cgi?id=4857" \
target="_blank"&gt;https://bugzilla.kernel.org/show_bug.cgi?id=4857&lt;/a&gt;&lt;br&gt; \
&lt;/u&gt;&lt;/font&gt;&lt;br&gt;I would like to know , if my observations are correct and is there any \
workaround to overcome this issue?&lt;br&gt;&lt;br&gt;Any help in this regard would be \
useful.&lt;br&gt;&lt;font color="#888888"&gt;&lt;br&gt;-Alphonse&lt;br&gt; &lt;/font&gt;&lt;/span&gt;&lt;/font&gt;
&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110829085829</emailId><senderName>"sharmila radha krishnan"</senderName><senderEmail>sharmilaradhakrishnan@rediffmail.com</senderEmail><timestampReceived>2011-08-29 08:58:29-0400</timestampReceived><subject>[libvirt-users] =?utf-8?q?Xenapi_-_Domain_Console_opening_=26_Sys?= =?utf-8?q?tem_info?=</subject><body>

Hi All,
  I would like to know how to open a console of a running domain using libvirt. \
Looking at the code, seems that there is no support available currently. Any \
workarounds for this? Also how do I get the System info(Like system tot memory \
use/Disk info/cpu info,network info etc through libvirt. Are there any \
palns to support this in the future release?   
Also, how to I add a new API to libvirt? 
 
Thanks,
Sharmila


[Attachment #3 (unknown)]

&lt;DIV&gt;Hi All,&lt;/DIV&gt;
&lt;DIV&gt;  I would like to know how to open a console of a running domain using \
libvirt. Looking at the code, seems that there is no support available currently. Any \
workarounds for this? Also how do I get the System info(Like system tot memory \
use/Disk info/cpu info,network info etc through libvirt. Are there any \
palns to support this in the future release? &lt;/DIV&gt; &lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;Also, how to I add a new API to libvirt? &lt;/DIV&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;Thanks,&lt;/DIV&gt;
&lt;DIV&gt;Sharmila&lt;/DIV&gt;&lt;br&gt;&lt;A \
HREF="http://sigads.rediff.com/RealMedia/ads/click_nx.ads/www.rediffmail.com/signatureline.htm@Middle?" \
target="_blank"&gt;&lt;IMG \
SRC="http://sigads.rediff.com/RealMedia/ads/adstream_nx.ads/www.rediffmail.com/signatureline.htm@Middle"&gt;&lt;/A&gt;&lt;br&gt;Treat \
yourself at a restaurant, spa, resort and much more with &lt;b&gt;&lt;a \
href="http://track.rediff.com/click?url=___http://dealhojaye.rediff.com?sc_cid=mailsignature___&amp;cmp=signature&amp;lnk=rediffmailsignature&amp;newservice=deals" \
target ="_new"&gt;Rediff Deal ho jaye!&lt;/a&gt;&lt;/b&gt;



</body></email><email><emailId>20110830033118</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-08-30 03:31:18-0400</timestampReceived><subject>Re: [libvirt-users] Help!</subject><body>

? 2011?08?26? 11:16, huachao yao ??:
&gt; Buddy, I am a noob in libvirt develop.
&gt; When I want to create a domain by using virDomainDefineXML and 
&gt; displays a window on the host desktop. But when I add the line
&gt; " &lt;graphics type='sdl' display=':0.0'/&gt;" into the config xml file, the 
&gt; error as below will happen.
&gt; libvir: QEMU error : internal error process exited while connecting to 
&gt; monitor: Could not initialize SDL(No available video device) - exiting

Your qemu doesn't support SDL graphic.

# qemu --help | grep sdl

&gt; when I delete " &lt;graphics type='sdl' display=':0.0'/&gt;",I can create 
&gt; the domain normally. Who can help me?!
&gt;
&gt; The config xml file is as below:
&gt;
&gt;
&gt; &lt;domain type='qemu'&gt;
&gt; &lt;name&gt;qemu_ubuntu_01&lt;/name&gt;
&gt; &lt;memory&gt;219200&lt;/memory&gt;
&gt; &lt;currentMemory&gt;219200&lt;/currentMemory&gt;
&gt; &lt;vcpu&gt;2&lt;/vcpu&gt;
&gt; &lt;os&gt;
&gt; &lt;type arch='x86_64' machine='pc'&gt;hvm&lt;/type&gt;
&gt; &lt;boot dev='hd'/&gt;
&gt; &lt;boot dev='cdrom'/&gt;
&gt; &lt;/os&gt;
&gt; &lt;devices&gt;
&gt; &lt;emulator&gt;/usr/bin/qemu&lt;/emulator&gt;
&gt; &lt;disk type='file' device='cdrom'&gt;
&gt; &lt;source file='/root/Downloads/ubuntu-11.04-desktop-amd64.iso'/&gt;
&gt; &lt;target dev='hdc' bus='ide'/&gt;
&gt; &lt;readonly/&gt;
&gt; &lt;/disk&gt;
&gt; &lt;disk type='file' device='disk'&gt;
&gt; &lt;source file='/var/lib/libvirt/images/winXP.img'/&gt;
&gt; &lt;driver name='qemu' type='raw'/&gt;
&gt; &lt;target dev='hda'/&gt;
&gt; &lt;/disk&gt;
&gt; &lt;video&gt;
&gt; &lt;model type='cirrus' vram='9216' heads='1'&gt;
&gt; &lt;acceleration accel3d='yes'/&gt;
&gt; &lt;/model&gt;
&gt; &lt;/video&gt;
&gt; &lt;interface type='bridge'&gt;
&gt; &lt;mac address='52:54:00:d8:65:c9'/&gt;
&gt; &lt;source bridge='virbr0'/&gt;
&gt; &lt;/interface&gt;
&gt; &lt;input type='mouse' bus='ps2'/&gt;
&gt; &lt;graphics type='vnc' port='10' listen='127.0.0.1'/&gt;
&gt; &lt;graphics type='sdl' display=':0.0'/&gt;
&gt; &lt;/devices&gt;
&gt; &lt;/domain&gt;
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users


[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta content="text/html; charset=ISO-8859-1"
      http-equiv="Content-Type"&gt;
  &lt;/head&gt;
  &lt;body bgcolor="#ffffff" text="#000000"&gt;
    于 2011年08月26日 11:16, huachao yao 写道:
    &lt;blockquote
cite="mid:CABK2uVtjyYvZipmz60cC2gjn5vzF6C_c_FvibfcQrFD_vkwNyg@mail.gmail.com"
      type="cite"&gt;
      &lt;div&gt;&lt;font class="Apple-style-span"&gt;Buddy, I am a noob in libvirt
          develop.&lt;/font&gt;&lt;/div&gt;
      &lt;div&gt;When I want to create a domain by using&lt;font
          class="Apple-style-span" color="#3333ff"&gt; virDomainDefineXML \
&lt;/font&gt;and &lt;span  class="Apple-style-span" style="font-family:
          Verdana,Arial,Helvetica,sans-serif; font-size: 13px;"&gt;displays
          a window on the host desktop. But when I add the line &lt;/span&gt;&lt;/div&gt;
      &lt;div&gt;&lt;span class="Apple-style-span" style="font-family:
          Verdana,Arial,Helvetica,sans-serif; font-size: 13px;"&gt;&lt;font
            class="Apple-style-span" color="#cc0000"&gt;" &lt;graphics
            type='sdl' display=':0.0'/&gt;"  &lt;/font&gt;into the config xml
          file, the error as below will happen. &lt;/span&gt;&lt;/div&gt;
      &lt;font class="Apple-style-span" color="#cc0000"&gt;libvir: QEMU error
        : internal error process exited while connecting to monitor:
        Could not initialize SDL(No available video device) - \
exiting&lt;/font&gt;&lt;/blockquote&gt;  &lt;br&gt;
    Your qemu doesn't support SDL graphic. &lt;br&gt;
    &lt;br&gt;
    # qemu --help | grep sdl&lt;br&gt;
    &lt;br&gt;
    &lt;blockquote
cite="mid:CABK2uVtjyYvZipmz60cC2gjn5vzF6C_c_FvibfcQrFD_vkwNyg@mail.gmail.com"
      type="cite"&gt;
      &lt;div&gt;when I delete &lt;span class="Apple-style-span" style="color:
          rgb(204, 0, 0); font-family:
          Verdana,Arial,Helvetica,sans-serif; font-size: 13px;"&gt;" &lt;graphics
          type='sdl' display=':0.0'/&gt;",&lt;/span&gt;&lt;span
          class="Apple-style-span" style="font-family:
          Verdana,Arial,Helvetica,sans-serif; font-size: 13px;"&gt;I can
          create the domain normally. Who can help me?! &lt;/span&gt;&lt;/div&gt;
      &lt;div&gt;&lt;font class="Apple-style-span" face="Verdana, Arial,
          Helvetica, sans-serif"&gt;&lt;br&gt;
        &lt;/font&gt;&lt;/div&gt;
      &lt;div&gt;&lt;font class="Apple-style-span" face="Verdana, Arial,
          Helvetica, sans-serif"&gt;The config xml file is as below:&lt;/font&gt;&lt;/div&gt;
      &lt;div&gt;&lt;font class="Apple-style-span" face="Verdana, Arial,
          Helvetica, sans-serif"&gt;&lt;br&gt;
        &lt;/font&gt;&lt;/div&gt;
      &lt;div&gt;&lt;font class="Apple-style-span" face="Verdana, Arial,
          Helvetica, sans-serif"&gt;&lt;br&gt;
        &lt;/font&gt;&lt;/div&gt;
      &lt;div&gt;&lt;font class="Apple-style-span" face="Verdana, Arial,
          Helvetica, sans-serif"&gt;
          &lt;div style="color: rgb(51, 0, 153);"&gt;
            &lt;domain type='qemu'&gt;&lt;/div&gt;
          &lt;div style="color: rgb(51, 0, \
                153);"&gt;  &lt;name&gt;qemu_ubuntu_01&lt;/name&gt;&lt;/div&gt;
          &lt;div style="color: rgb(51, 0, \
153);"&gt;  &lt;memory&gt;219200&lt;/memory&gt;&lt;/div&gt;  &lt;div style="color: \
                rgb(51, 0, 153);"&gt;
              &lt;currentMemory&gt;219200&lt;/currentMemory&gt;&lt;/div&gt;
          &lt;div style="color: rgb(51, 0, \
                153);"&gt;  &lt;vcpu&gt;2&lt;/vcpu&gt;&lt;/div&gt;
          &lt;div style="color: rgb(51, 0, 153);"&gt;  &lt;os&gt;&lt;/div&gt;
          &lt;div style="color: rgb(51, 0, 153);"&gt;
                &lt;type arch='x86_64' \
machine='pc'&gt;hvm&lt;/type&gt;&lt;/div&gt;  &lt;div style="color: rgb(51, 0, \
153);"&gt;    &lt;boot  dev='hd'/&gt;&lt;/div&gt;
          &lt;div style="color: rgb(51, 0, 153);"&gt;    &lt;boot
            dev='cdrom'/&gt;&lt;/div&gt;
          &lt;div style="color: rgb(51, 0, 153);"&gt;  &lt;/os&gt;&lt;/div&gt;
          &lt;div style="color: rgb(51, 0, 153);"&gt;  &lt;devices&gt;&lt;/div&gt;
          &lt;div style="color: rgb(51, 0, 153);"&gt;  
             &lt;emulator&gt;/usr/bin/qemu&lt;/emulator&gt;&lt;/div&gt;
          &lt;div style="color: rgb(51, 0, 153);"&gt;
                &lt;disk type='file' device='cdrom'&gt;&lt;/div&gt;
          &lt;div style="color: rgb(51, 0, 153);"&gt;      &lt;source
            file='/root/Downloads/ubuntu-11.04-desktop-amd64.iso'/&gt;&lt;/div&gt;
          &lt;div style="color: rgb(51, 0, 153);"&gt;
                  &lt;target dev='hdc' bus='ide'/&gt;&lt;/div&gt;
          &lt;div style="color: rgb(51, 0, 153);"&gt;     \
                 &lt;readonly/&gt;&lt;/div&gt;
          &lt;div style="color: rgb(51, 0, 153);"&gt;    &lt;/disk&gt;&lt;/div&gt;
          &lt;div style="color: rgb(51, 0, 153);"&gt;
                &lt;disk type='file' device='disk'&gt;&lt;/div&gt;
          &lt;div style="color: rgb(51, 0, 153);"&gt;      &lt;source
            file='/var/lib/libvirt/images/winXP.img'/&gt;&lt;/div&gt;
          &lt;div style="color: rgb(51, 0, 153);"&gt;      &lt;driver
            name='qemu' type='raw'/&gt;&lt;/div&gt;
          &lt;div style="color: rgb(51, 0, 153);"&gt;      &lt;target
            dev='hda'/&gt;&lt;/div&gt;
          &lt;div style="color: rgb(51, 0, 153);"&gt;    &lt;/disk&gt;&lt;/div&gt;
          &lt;div&gt;&lt;font class="Apple-style-span" color="#cc0000"&gt;  
               &lt;video&gt;&lt;/font&gt;&lt;/div&gt;
          &lt;div&gt;&lt;font class="Apple-style-span" color="#cc0000"&gt;    
               &lt;model type='cirrus' vram='9216' heads='1'&gt;&lt;/font&gt;&lt;/div&gt;
          &lt;div&gt;&lt;font class="Apple-style-span" color="#cc0000"&gt;     \
                 &lt;span
                class="Apple-tab-span" style="white-space: pre;"&gt; \
&lt;/span&gt;&lt;acceleration  accel3d='yes'/&gt;&lt;/font&gt;&lt;/div&gt;
          &lt;div&gt;&lt;font class="Apple-style-span" color="#cc0000"&gt;    
               &lt;/model&gt;&lt;/font&gt;&lt;/div&gt;
          &lt;div&gt;&lt;font class="Apple-style-span" color="#cc0000"&gt;  
               &lt;/video&gt;&lt;/font&gt;&lt;/div&gt;
          &lt;div style="color: rgb(51, 0, 153);"&gt;    &lt;interface
            type='bridge'&gt;&lt;/div&gt;
          &lt;div style="color: rgb(51, 0, 153);"&gt;      &lt;mac
            address='52:54:00:d8:65:c9'/&gt;&lt;/div&gt;
          &lt;div style="color: rgb(51, 0, 153);"&gt;      &lt;source
            bridge='virbr0'/&gt;&lt;/div&gt;
          &lt;div style="color: rgb(51, 0, 153);"&gt;
                &lt;/interface&gt;&lt;/div&gt;
          &lt;div style="color: rgb(51, 0, 153);"&gt;    &lt;input
            type='mouse' bus='ps2'/&gt;&lt;/div&gt;
          &lt;div&gt;&lt;font class="Apple-style-span" color="#cc0000"&gt;  
               &lt;graphics type='vnc' port='10' \
listen='127.0.0.1'/&gt;&lt;/font&gt;&lt;/div&gt;  &lt;div&gt;&lt;font class="Apple-style-span" \
                color="#cc0000"&gt;  
               &lt;graphics type='sdl' display=':0.0'/&gt;&lt;/font&gt;&lt;/div&gt;
          &lt;div style="color: rgb(51, 0, 153);"&gt;  &lt;/devices&gt;&lt;/div&gt;
          &lt;div style="color: rgb(51, 0, 153);"&gt;
             &lt;/domain&gt;&lt;/div&gt;
        &lt;/font&gt;&lt;/div&gt;
      &lt;pre wrap=""&gt;
&lt;fieldset class="mimeAttachmentHeader"&gt;&lt;/fieldset&gt;
_______________________________________________
libvirt-users mailing list
&lt;a class="moz-txt-link-abbreviated" \
href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt; &lt;a \
class="moz-txt-link-freetext" \
href="https://www.redhat.com/mailman/listinfo/libvirt-users"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;/pre&gt;
  &lt;/blockquote&gt;
    &lt;br&gt;
  &lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20110830033620</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-08-30 03:36:20-0400</timestampReceived><subject>Re: [libvirt-users] hello, I 've deployed libvirt, and it is OK to use kvm.But when I use virtualbox</subject><body>

? 2011?08?26? 20:27, bin liu ??:
&gt; hello,I 've deployed libvirt, and it is OK to use kvm.But when I use 
&gt; virtualbox,I can not attach a device to a domain.
&gt; It reports the error that can't get device from device.xml

Hi,

What's the exact error?

&gt; here is my xml file for device(device.xml):
&gt; &lt;disk type='block'&gt;
&gt; &lt;driver name='phy'/&gt;
&gt; &lt;source dev="/home/lb/iscsitest/vdisk.img"/&gt;
&gt; &lt;target dev='sdb' bus='usb'/&gt;
&gt; &lt;/disk&gt;
&gt; and the xml file for the vm:
&gt; &lt;domain type='vbox'&gt;
&gt; &lt;name&gt;winxp_3D&lt;/name&gt;
&gt; &lt;uuid&gt;d2542bf2-3d56-41fa-a048-4f9a7ed3cf4a&lt;/uuid&gt;
&gt; &lt;memory&gt;787456&lt;/memory&gt;
&gt; &lt;currentMemory&gt;787456&lt;/currentMemory&gt;
&gt; &lt;vcpu&gt;1&lt;/vcpu&gt;
&gt; &lt;os&gt;
&gt; &lt;type arch='x86_64'&gt;hvm&lt;/type&gt;
&gt; &lt;boot dev='fd'/&gt;
&gt; &lt;boot dev='cdrom'/&gt;
&gt; &lt;boot dev='hd'/&gt;
&gt; &lt;/os&gt;
&gt; &lt;features&gt;
&gt; &lt;acpi/&gt;
&gt; &lt;/features&gt;
&gt; &lt;clock offset='localtime'/&gt;
&gt; &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
&gt; &lt;on_reboot&gt;destroy&lt;/on_reboot&gt;
&gt; &lt;on_crash&gt;destroy&lt;/on_crash&gt;
&gt; &lt;devices&gt;
&gt; &lt;disk type='file' device='disk'&gt;
&gt; &lt;source file='/root/VirtualBox VMs/winxp_3D/winxp_3D.vdi'/&gt;
&gt; &lt;target dev='hda' bus='ide'/&gt;
&gt; &lt;/disk&gt;
&gt; &lt;interface type='bridge'&gt;
&gt; &lt;mac address='08:00:27:6f:c6:4f'/&gt;
&gt; &lt;source bridge='tap0'/&gt;
&gt; &lt;model type='Am79C973'/&gt;
&gt; &lt;/interface&gt;
&gt; &lt;input type='mouse' bus='ps2'/&gt;
&gt; &lt;graphics type='desktop' display=':0.0'/&gt;
&gt; &lt;sound model='ac97'/&gt;
&gt; &lt;video&gt;
&gt; &lt;model type='vbox' vram='32768' heads='1'&gt;
&gt; &lt;acceleration accel3d='yes' accel2d='yes'/&gt;
&gt; &lt;/model&gt;
&gt; &lt;/video&gt;
&gt; &lt;/devices&gt;
&gt; &lt;/domain&gt;
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users


[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta content="text/html; charset=ISO-8859-1"
      http-equiv="Content-Type"&gt;
  &lt;/head&gt;
  &lt;body bgcolor="#ffffff" text="#000000"&gt;
    于 2011年08月26日 20:27, bin liu 写道:
    &lt;blockquote
cite="mid:CAH8ki-n2ZkrqD=+qS=U7ntkBMxVfKiCYLzYxCor-WQ3SFKFe6A@mail.gmail.com"
      type="cite"&gt;
      &lt;div&gt;hello,I 've deployed libvirt, and it is OK to use kvm.But
        when I use virtualbox,I can not attach a device to a domain.&lt;/div&gt;
      &lt;div&gt;It reports the error that can't get device from device.xml&lt;br&gt;
      &lt;/div&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
    Hi,&lt;br&gt;
    &lt;br&gt;
    What's the exact error?&lt;br&gt;
    &lt;br&gt;
    &lt;blockquote
cite="mid:CAH8ki-n2ZkrqD=+qS=U7ntkBMxVfKiCYLzYxCor-WQ3SFKFe6A@mail.gmail.com"
      type="cite"&gt;
      &lt;div&gt;here is my xml file for device(device.xml):&lt;br&gt;
        &lt;disk type='block'&gt;&lt;br&gt;
                &lt;driver name='phy'/&gt;&lt;br&gt;
                        \
&lt;source  dev="/home/lb/iscsitest/vdisk.img"/&gt;&lt;br&gt;
                &lt;target dev='sdb' \
bus='usb'/&gt;&lt;br&gt;  &lt;/disk&gt;&lt;/div&gt;
      &lt;div&gt;and the xml file for the vm:&lt;/div&gt;
      &lt;div&gt; &lt;/div&gt;
      &lt;div&gt;&lt;domain type='vbox'&gt;&lt;br&gt;
          &lt;name&gt;winxp_3D&lt;/name&gt;&lt;br&gt;
          &lt;uuid&gt;d2542bf2-3d56-41fa-a048-4f9a7ed3cf4a&lt;/uuid&gt;&lt;br&gt;
          &lt;memory&gt;787456&lt;/memory&gt;&lt;br&gt;
          &lt;currentMemory&gt;787456&lt;/currentMemory&gt;&lt;br&gt;
          &lt;vcpu&gt;1&lt;/vcpu&gt;&lt;br&gt;
          &lt;os&gt;&lt;br&gt;
            &lt;type arch='x86_64'&gt;hvm&lt;/type&gt;&lt;br&gt;
            &lt;boot dev='fd'/&gt;&lt;br&gt;
            &lt;boot dev='cdrom'/&gt;&lt;br&gt;
            &lt;boot dev='hd'/&gt;&lt;br&gt;
          &lt;/os&gt;&lt;br&gt;
          &lt;features&gt;&lt;br&gt;
            &lt;acpi/&gt;&lt;br&gt;
          &lt;/features&gt;&lt;br&gt;
          &lt;clock offset='localtime'/&gt;&lt;br&gt;
          &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;&lt;br&gt;
          &lt;on_reboot&gt;destroy&lt;/on_reboot&gt;&lt;br&gt;
          &lt;on_crash&gt;destroy&lt;/on_crash&gt;&lt;br&gt;
          &lt;devices&gt;&lt;br&gt;
            &lt;disk type='file' device='disk'&gt;&lt;br&gt;
              &lt;source file='/root/VirtualBox
        VMs/winxp_3D/winxp_3D.vdi'/&gt;&lt;br&gt;
              &lt;target dev='hda' bus='ide'/&gt;&lt;br&gt;
            &lt;/disk&gt;&lt;br&gt;
            &lt;interface type='bridge'&gt;&lt;br&gt;
              &lt;mac address='08:00:27:6f:c6:4f'/&gt;&lt;br&gt;
              &lt;source bridge='tap0'/&gt;&lt;br&gt;
              &lt;model type='Am79C973'/&gt;&lt;br&gt;
            &lt;/interface&gt;&lt;br&gt;
            &lt;input type='mouse' bus='ps2'/&gt;&lt;br&gt;
            &lt;graphics type='desktop' display=':0.0'/&gt;&lt;br&gt;
            &lt;sound model='ac97'/&gt;&lt;br&gt;
            &lt;video&gt;&lt;br&gt;
              &lt;model type='vbox' vram='32768' \
                heads='1'&gt;&lt;br&gt;
                &lt;acceleration accel3d='yes' \
accel2d='yes'/&gt;&lt;br&gt;        &lt;/model&gt;&lt;br&gt;
            &lt;/video&gt;&lt;br&gt;
          &lt;/devices&gt;&lt;br&gt;
        &lt;/domain&gt;&lt;br&gt;
        &lt;br&gt;
      &lt;/div&gt;
      &lt;pre wrap=""&gt;
&lt;fieldset class="mimeAttachmentHeader"&gt;&lt;/fieldset&gt;
_______________________________________________
libvirt-users mailing list
&lt;a class="moz-txt-link-abbreviated" \
href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt; &lt;a \
class="moz-txt-link-freetext" \
href="https://www.redhat.com/mailman/listinfo/libvirt-users"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;/pre&gt;
  &lt;/blockquote&gt;
    &lt;br&gt;
  &lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20110830034300</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-08-30 03:43:00-0400</timestampReceived><subject>Re: [libvirt-users] VMs do not start randomically during host boot</subject><body>

? 2011?08?26? 03:39, Josir Cardoso Gomes ??:
&gt; Hi Folks,
&gt;
&gt; Host: Ubuntu 10.04 64bits
&gt; 3 Guests with Ubuntu 10.04 64bits
&gt;
&gt; Every monday, when I turn the host on, some guests starts 
&gt; automatically and others don´t.
&gt; Every week libvirt "elects" a different guest and don´t start it.

Interesting, :-)

Perhap you changes the property "autostart" of the domain in the week?

# virsh dominfo $dom


&gt;
&gt; If I start it manually, it boot fine.
&gt;
&gt; Looking at /var/log/libvirtd, it only show the log of the guests that 
&gt; boot. Not a tip of the sleepy guests servers.
&gt;
&gt; Could somebody give me a glue on how to find the problem ?
&gt;
&gt; Thanks in advance,
&gt; Josir.
&gt;
&gt;
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users


[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta content="text/html; charset=ISO-8859-1"
      http-equiv="Content-Type"&gt;
  &lt;/head&gt;
  &lt;body bgcolor="#ffffff" text="#000000"&gt;
    于 2011年08月26日 03:39, Josir Cardoso Gomes \
写道:  &lt;blockquote
cite="mid:CACHZvCffdEp9ZXc6RMPXtSLKVCc+Zq-J47djd6ZHH_iuNS445w@mail.gmail.com"
      type="cite"&gt;Hi Folks, &lt;br&gt;
      &lt;br&gt;
      Host: Ubuntu 10.04 64bits&lt;br&gt;
      3 Guests with Ubuntu 10.04 64bits&lt;br&gt;
      &lt;br&gt;
      Every monday, when I turn the host on, some guests starts
      automatically and others don´t. &lt;br&gt;
      Every week libvirt "elects" a different guest and don´t start it.
      &lt;br&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
    Interesting, :-)&lt;br&gt;
    &lt;br&gt;
    Perhap you changes the property "autostart" of the domain in the
    week?&lt;br&gt;
    &lt;br&gt;
    # virsh dominfo $dom&lt;br&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;blockquote
cite="mid:CACHZvCffdEp9ZXc6RMPXtSLKVCc+Zq-J47djd6ZHH_iuNS445w@mail.gmail.com"
      type="cite"&gt;&lt;br&gt;
      If I start it manually, it boot fine.&lt;br&gt;
      &lt;br&gt;
      Looking at /var/log/libvirtd, it only show the log of the guests
      that boot. Not a tip of the sleepy guests servers.&lt;br&gt;
      &lt;br&gt;
      Could somebody give me a glue on how to find the problem ?&lt;br&gt;
      &lt;br&gt;
      Thanks in advance,&lt;br&gt;
      Josir.&lt;br&gt;
      &lt;br&gt;
      &lt;br&gt;
      &lt;br&gt;
      &lt;pre wrap=""&gt;
&lt;fieldset class="mimeAttachmentHeader"&gt;&lt;/fieldset&gt;
_______________________________________________
libvirt-users mailing list
&lt;a class="moz-txt-link-abbreviated" \
href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt; &lt;a \
class="moz-txt-link-freetext" \
href="https://www.redhat.com/mailman/listinfo/libvirt-users"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;/pre&gt;
  &lt;/blockquote&gt;
    &lt;br&gt;
  &lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20110830042552</emailId><senderName>Kevins Thoughts</senderName><senderEmail>thoughts@kevinsthoughts.com</senderEmail><timestampReceived>2011-08-30 04:25:52-0400</timestampReceived><subject>[libvirt-users] Fwd: Re:  New with Libvirt and having problems.</subject><body>

On 8/29/2011 10:29 PM, Trey Dockendorf wrote:
&gt; Have you looked into using virt-manager?  When I started using KVM I 
&gt; found that new VM provisioning was much simpler with that interface.

Alas, Virtmanager doesn't seem to be a supported program under Gentoo - 
the distribution I use.  If its X-based, it wouldn't work anyhow - I'm 
strictly a command line shop.
&gt;
&gt; Once you've created your domain with "virt-install" you can make 
&gt; changes using virsh.
&gt;
&gt; virsh -c qemu:///system edit Test
&gt;
&gt; That will allow you to directly edit the domain.
&gt;
&gt; In the virt-install line you used "bridge=br0" , maybe replace that 
&gt; with "bridge=tap5".  If that doesn't do it, once your editing the XML 
&gt; you can try something like the following...

I'm familiar with virsh edit and have used it to probe around a bit.  
Actually tried the "bridge=tap5" a few days ago and get the message:

/ERROR    internal error Failed to add tap interface to bridge. tap5 is 
not a bridge device/

&gt;
&gt; &lt;interface type='bridge'&gt;
&gt; &lt;mac address='52:54:00:4d:74:c7'/&gt;
&gt; &lt;source bridge='tap5'/&gt;
&gt; &lt;model type='virtio'/&gt;
&gt; &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03' 
&gt; function='0x0'/&gt;
&gt; &lt;/interface&gt;
&gt;
&gt; That was created using virt-manager, so you probably need to use what 
&gt; virt-install created for your mac address and address.

Gave that a shot, attempting to create a new domain with "br0" replaced 
by "tap5" and got the same error message:

/error: internal error Failed to add tap interface to bridge. tap5 is 
not a bridge device/


&gt;
&gt; Is your init failing on /dev/vda3 and then kernel panic?  If so it's 
&gt; likely your guest OS doesn't have the necessary kernel modules loaded. 
&gt;  Depending on your distro it will vary, but using CentOS 6 I've found 
&gt; they are automatically loaded.  This is what's loaded in CentOS 6

Well, yes and no.  Its failing with a kernel panic because KVM is being 
started with if=none instead of if=virtio.  If I manually change it, it 
works fine.  Just need to know where to update that in the domain XML file.

For what its worth, the image runs 100% fine with started manually with:

/kvm -net nic,model=virtio -net tap,ifname=tap5,script=no  -drive 
file=test1.img,if=virtio,boot=on -curses -no-reboot -m 2g -smp 2/

So I know the image is good.

&gt;
&gt; # lsmod | grep virtio
&gt; virtio_blk              5087  5
&gt; virtio_pci              6733  0
&gt; virtio_ring             7169  2 virtio_blk,virtio_pci
&gt; virtio                  4824  2 virtio_blk,virtio_pci
&gt;
&gt; Try changing the disk to ide , and then verifying your system is able 
&gt; to load the virtio modules.
&gt;
&gt; Also , once you have your XML the way you like, if your going to stick 
&gt; with command line look at using virsh though I highly recommend 
&gt; virt-manager.
&gt;
&gt; I'm still very new to KVM myself, so hopefully that was of some use
&gt;
&gt; - Trey

Thanks!


[Attachment #3 (text/html)]

&lt;html&gt;
  &lt;head&gt;
    &lt;meta content="text/html; charset=ISO-8859-1"
      http-equiv="Content-Type"&gt;
  &lt;/head&gt;
  &lt;body bgcolor="#FFFFFF" text="#000000"&gt;
    &lt;br&gt;
    &lt;meta content="text/html; charset=ISO-8859-1"
      http-equiv="Content-Type"&gt;
    On 8/29/2011 10:29 PM, Trey Dockendorf wrote:
    &lt;blockquote
cite="mid:CAN0oX1YyPyxtjx6oEzbHPqocm=9SrDTi8R+h5oa1M6knuW1HuA@mail.gmail.com"
      type="cite"&gt;
      &lt;div class="gmail_quote"&gt;
        &lt;div&gt;Have you looked into using virt-manager?  When I started
          using KVM I found that new VM provisioning was
          much simpler with that interface. &lt;br&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
    Alas, Virtmanager doesn't seem to be a supported program under
    Gentoo - the distribution I use.  If its X-based, it wouldn't work
    anyhow - I'm strictly a command line shop.&lt;br&gt;
    &lt;blockquote
cite="mid:CAN0oX1YyPyxtjx6oEzbHPqocm=9SrDTi8R+h5oa1M6knuW1HuA@mail.gmail.com"
      type="cite"&gt;
      &lt;div class="gmail_quote"&gt;
        &lt;div&gt;&lt;br&gt;
        &lt;/div&gt;
        &lt;div&gt;Once you've created your domain with "virt-install" you can
          make changes using virsh.&lt;/div&gt;
        &lt;div&gt;&lt;br&gt;
        &lt;/div&gt;
        &lt;div&gt;virsh -c qemu:///system edit Test&lt;/div&gt;
        &lt;div&gt;&lt;br&gt;
        &lt;/div&gt;
        &lt;div&gt;That will allow you to directly edit the domain.&lt;/div&gt;
        &lt;div&gt;&lt;br&gt;
        &lt;/div&gt;
        &lt;div&gt;In the virt-install line you used "bridge=br0" , maybe
          replace that with "bridge=tap5".  If that doesn't do it, once
          your editing the XML you can try something like the
          following...&lt;/div&gt;
      &lt;/div&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
    I'm familiar with virsh edit and have used it to probe around a
    bit.  Actually tried the "bridge=tap5" a few days ago and get the
    message:&lt;br&gt;
    &lt;br&gt;
    &lt;i&gt;ERROR    internal error Failed to add tap interface to bridge.
      tap5 is not a bridge device&lt;/i&gt;&lt;br&gt;
    &lt;br&gt;
    &lt;blockquote
cite="mid:CAN0oX1YyPyxtjx6oEzbHPqocm=9SrDTi8R+h5oa1M6knuW1HuA@mail.gmail.com"
      type="cite"&gt;
      &lt;div class="gmail_quote"&gt;
        &lt;div&gt;&lt;br&gt;
        &lt;/div&gt;
        &lt;div&gt;
          &lt;div&gt;    &lt;interface type='bridge'&gt;&lt;/div&gt;
          &lt;div&gt;      &lt;mac address='52:54:00:4d:74:c7'/&gt;&lt;/div&gt;
          &lt;div&gt;      &lt;source bridge='tap5'/&gt;&lt;/div&gt;
          &lt;div&gt;      &lt;model type='virtio'/&gt;&lt;/div&gt;
          &lt;div&gt;      &lt;address type='pci' domain='0x0000' bus='0x00'
            slot='0x03' function='0x0'/&gt;&lt;/div&gt;
          &lt;div&gt;    &lt;/interface&gt;&lt;/div&gt;
        &lt;/div&gt;
        &lt;div&gt;&lt;br&gt;
        &lt;/div&gt;
        &lt;div&gt;That was created using virt-manager, so you probably need
          to use what virt-install created for your mac address and
          address.&lt;/div&gt;
      &lt;/div&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
    Gave that a shot, attempting to create a new domain with "br0"
    replaced by "tap5" and got the same error message:&lt;br&gt;
    &lt;br&gt;
    &lt;i&gt;error: internal error Failed to add tap interface to bridge. tap5
      is not a bridge device&lt;/i&gt;&lt;br&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;blockquote
cite="mid:CAN0oX1YyPyxtjx6oEzbHPqocm=9SrDTi8R+h5oa1M6knuW1HuA@mail.gmail.com"
      type="cite"&gt;
      &lt;div class="gmail_quote"&gt;
        &lt;div&gt;&lt;br&gt;
        &lt;/div&gt;
        &lt;div&gt;Is your init failing on /dev/vda3 and then kernel panic?
           If so it's likely your guest OS doesn't have the necessary
          kernel modules loaded.  Depending on your distro it will vary,
          but using CentOS 6 I've found they are automatically loaded.
           This is what's loaded in CentOS 6&lt;/div&gt;
      &lt;/div&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
    Well, yes and no.  Its failing with a kernel panic because KVM is
    being started with if=none instead of if=virtio.  If I manually
    change it, it works fine.  Just need to know where to update that in
    the domain XML file.&lt;br&gt;
    &lt;br&gt;
    For what its worth, the image runs 100% fine with started manually
    with:&lt;br&gt;
    &lt;br&gt;
    &lt;i&gt;kvm -net nic,model=virtio -net tap,ifname=tap5,script=no  -drive
      file=test1.img,if=virtio,boot=on -curses -no-reboot -m 2g -smp 2&lt;/i&gt;&lt;br&gt;
    &lt;br&gt;
    So I know the image is good.&lt;br&gt;
    &lt;br&gt;
    &lt;blockquote
cite="mid:CAN0oX1YyPyxtjx6oEzbHPqocm=9SrDTi8R+h5oa1M6knuW1HuA@mail.gmail.com"
      type="cite"&gt;
      &lt;div class="gmail_quote"&gt;
        &lt;div&gt;&lt;br&gt;
        &lt;/div&gt;
        &lt;div&gt;# lsmod | grep virtio&lt;/div&gt;
        &lt;div&gt;
          &lt;div&gt;virtio_blk              5087 \
                 5 &lt;/div&gt;
          &lt;div&gt;virtio_pci              6733 \
                 0 &lt;/div&gt;
          &lt;div&gt;virtio_ring             7169  2 \
                virtio_blk,virtio_pci&lt;/div&gt;
          &lt;div&gt;virtio                 \
 4824  2 virtio_blk,virtio_pci&lt;/div&gt;  &lt;/div&gt;
        &lt;div&gt;&lt;br&gt;
        &lt;/div&gt;
        &lt;div&gt;Try changing the disk to ide , and then verifying your
          system is able to load the virtio modules.&lt;/div&gt;
        &lt;div&gt;&lt;br&gt;
        &lt;/div&gt;
        &lt;div&gt;Also , once you have your XML the way you like, if your
          going to stick with command line look at using virsh though I
          highly recommend virt-manager.&lt;/div&gt;
        &lt;div&gt;&lt;br&gt;
        &lt;/div&gt;
        &lt;div&gt;I'm still very new to KVM myself, so hopefully that was of
          some use&lt;/div&gt;
        &lt;div&gt;&lt;br&gt;
        &lt;/div&gt;
        &lt;div&gt;- Trey&lt;/div&gt;
      &lt;/div&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
    Thanks!&lt;br&gt;
    &lt;br&gt;
  &lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20110830150415</emailId><senderName>Paras pradhan</senderName><senderEmail>pradhanparas@gmail.com</senderEmail><timestampReceived>2011-08-30 15:04:15-0400</timestampReceived><subject>[libvirt-users] conflict disk error</subject><body>

Hi,

In one of my nodes I am getting libvirt error.

--
ERROR    Unknown failure
Traceback (most recent call last):
 File "/usr/sbin/virt-install", line 895, in ?
   main()
 File "/usr/sbin/virt-install", line 677, in main
   options.sparse, options.nodisks, guest, ishvm, conn)
 File "/usr/sbin/virt-install", line 239, in get_disks
   is_file_path), disk, size)
 File "/usr/sbin/virt-install", line 239, in &lt;lambda&gt;
   is_file_path), disk, size)
 File "/usr/sbin/virt-install", line 202, in get_disk
   d = cli.disk_prompt(None, kwargs)
 File "/usr/lib/python2.4/site-packages/virtinst/cli.py", line 277,
in disk_prompt
   if dev.is_conflict_disk(conn) is True:
 File "/usr/lib/python2.4/site-packages/virtinst/VirtualDisk.py",
line 890, in is_conflict_disk
   xml = vm.XMLDesc(0)
 File "/usr/lib64/python2.4/site-packages/libvirt.py", line 247, in XMLDesc
   if ret is None: raise libvirtError ('virDomainGetXMLDesc()
failed', dom=self)
libvirtError: Unknown failure
--


command used:

virt-install --nographics --paravirt --name dora --ram 2048 --file
/dora.img --file-size 153 --location
nfs://mydom:/distributions/redhat60/x86_64/ -x
"ks=http://mydom/ks/redhat60-dora.ks ip=x.x.x.x netmask=255.255.255.0
dns=x.x.x.x gateway=x.x.x.x" -b xenbr0

Ideas?

Thanks
Paras.

</body></email><email><emailId>20110830155934</emailId><senderName>Kevins Thoughts</senderName><senderEmail>thoughts@kevinsthoughts.com</senderEmail><timestampReceived>2011-08-30 15:59:34-0400</timestampReceived><subject>Re: [libvirt-users] New with Libvirt and having problems.</subject><body>

On 8/30/2011 9:14 AM, Eric Blake wrote:
&gt; On 08/29/2011 08:09 PM, Kevins Thoughts wrote:
&gt;&gt; &lt;clip&gt;
&gt;&gt;
&gt;&gt; 1) The "-S" is keeping the system from booting
&gt; This is intentional.  Libvirt has to make some changes via the monitor,
&gt; since qemu does not expose all functionality from the command line, so
&gt; libvirt blindly starts qemu with -S, makes subsequent monitor changes,
&gt; and then released the vcpus via monitor command (unless you used the
&gt; VIR_DOMAIN_START_PAUSED flag to keep things paused).  There is no XML to
&gt; control this, nor does there need to be, given the existence of
&gt; virDomainCreateWithFlags().

Alas, for whatever reason, the vcpus do not appear to be being 
released.  XML below...

&gt;&gt; 2)  the "if=none" needs to be "if=virtio"
&gt; Have you tried 'virsh domxml-from-native qemu-argv /path/to/args' for a
&gt; shell-style command line containing the qemu command you want to run?
&gt; It's not perfect, but may give you some hints on this regard.

No I haven't, thanks for that suggestion.

&gt;
&gt; Meanwhile, according to the documentation,&lt;target dev=...
&gt; bus='virtio'/&gt;  inside your&lt;drive&gt;  xml appears to be the right way to
&gt; request a virtio drive.  Paste the actual XML you are trying to use, so
&gt; we can offer suggestions relative to your questions.

Actually, I did read the documentation and agree - at least that was my 
best guess, but its not working.  The generated  command being invoked 
has "-drive file=/kvms/test1.img,if=none,boot=on" specified.

Here is the XML file created by the command:  virt-install --name "Test" 
--ram 1024 --vcpus=2  --cpu host --description "Test VM" --import --file 
test1.img --os-type=linux --os-variant=virtio26  --network 
bridge=br0,model=virtio --graphics=none --autostart --prompt

&lt;Test.xml&gt;
&lt;domain type='kvm'&gt;
&lt;name&gt;Test&lt;/name&gt;
&lt;uuid&gt;b0784171-0662-80ce-caad-c9e3c7fe0952&lt;/uuid&gt;
&lt;description&gt;Test VM&lt;/description&gt;
&lt;memory&gt;1048576&lt;/memory&gt;
&lt;currentMemory&gt;1048576&lt;/currentMemory&gt;
&lt;vcpu&gt;2&lt;/vcpu&gt;
&lt;os&gt;
&lt;type arch='x86_64' machine='pc-0.13'&gt;hvm&lt;/type&gt;
&lt;boot dev='hd'/&gt;
&lt;/os&gt;
&lt;features&gt;
&lt;acpi/&gt;
&lt;apic/&gt;
&lt;pae/&gt;
&lt;/features&gt;
&lt;cpu match='exact'&gt;
&lt;model&gt;Opteron_G3&lt;/model&gt;
&lt;vendor&gt;AMD&lt;/vendor&gt;
&lt;feature policy='require' name='skinit'/&gt;
&lt;feature policy='require' name='vme'/&gt;
&lt;feature policy='require' name='mmxext'/&gt;
&lt;feature policy='require' name='fxsr_opt'/&gt;
&lt;feature policy='require' name='cr8legacy'/&gt;
&lt;feature policy='require' name='ht'/&gt;
&lt;feature policy='require' name='3dnowprefetch'/&gt;
&lt;feature policy='require' name='3dnowext'/&gt;
&lt;feature policy='require' name='wdt'/&gt;
&lt;feature policy='require' name='extapic'/&gt;
&lt;feature policy='require' name='pdpe1gb'/&gt;
&lt;feature policy='require' name='osvw'/&gt;
&lt;feature policy='require' name='cmp_legacy'/&gt;
&lt;feature policy='require' name='3dnow'/&gt;
&lt;/cpu&gt;
&lt;clock offset='utc'/&gt;
&lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
&lt;on_reboot&gt;restart&lt;/on_reboot&gt;
&lt;on_crash&gt;restart&lt;/on_crash&gt;
&lt;devices&gt;
&lt;emulator&gt;/usr/bin/qemu-kvm&lt;/emulator&gt;
&lt;disk type='file' device='disk'&gt;
&lt;driver name='qemu' type='raw'/&gt;
&lt;source file='/kvms/test1.img'/&gt;
&lt;target dev='vda' bus='virtio'/&gt;
&lt;address type='pci' domain='0x0000' bus='0x00' slot='0x04' function='0x0'/&gt;
&lt;/disk&gt;
&lt;interface type='bridge'&gt;
&lt;mac address='52:54:00:f3:28:7b'/&gt;
&lt;source bridge='br0'/&gt;
&lt;model type='virtio'/&gt;
&lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03' function='0x0'/&gt;
&lt;/interface&gt;
&lt;serial type='pty'&gt;
&lt;target port='0'/&gt;
&lt;/serial&gt;
&lt;console type='pty'&gt;
&lt;target type='serial' port='0'/&gt;
&lt;/console&gt;
&lt;memballoon model='virtio'&gt;
&lt;address type='pci' domain='0x0000' bus='0x00' slot='0x05' function='0x0'/&gt;
&lt;/memballoon&gt;
&lt;/devices&gt;
&lt;/domain&gt;

&gt; Does the documentation help? 
&gt; http://libvirt.org/formatdomain.html#elementsNICS 

Looks like I could perhaps add a "&lt;target dev='tap5'/&gt;" to the bridge 
interface section.  The documentation refers to using "tun" devices, and 
I use "tap" devices, but perhaps that's close enough.

</body></email><email><emailId>20110712002610</emailId><senderName>Whit Blauvelt</senderName><senderEmail>whit.virt@transpect.com</senderEmail><timestampReceived>2011-07-12 00:26:10-0400</timestampReceived><subject>[libvirt-users] virt-manager/libvirt backwards compatibility problem?</subject><body>

Hi,

Wanting to test some recent features of libvirt, I installed 0.9.3 on a
couple of systems. It works fine on those, but since upgrading neither of
them can successfully connect with virt-manager or virsh to a couple of
other systems running libvirt 0.8.3. Even after upgrading virt-manager and
virtinst to the latest versions on the 0.9.3 systems, they fail like this
in virt-manager:

  Unable to open a connection to the libvirt management daemon.

  Libvirt URI is: qemu+ssh://root@192.168.1.67/system

  Verify that:
   - The 'libvirtd' daemon has been started

  Cannot recv data: : Connection reset by peer

  Traceback (most recent call last):
    File "/usr/src/virt-manager-0.8.7/src/virtManager/connection.py", line
  1055, in _try_open
      None], flags)
    File "/usr/local/lib/python2.7/dist-packages/libvirt.py", line 102, in
  openAuth
      if ret is None:raise libvirtError('virConnectOpenAuth() failed')
  libvirtError: Cannot recv data: : Connection reset by peer

Virsh simple fails with:

  error: Cannot recv data: : Connection reset by peer
  error: failed to connect to the hypervisor

Since it's certain that the libvirtd daemon has been started on the other
systems (they have production VMs that are running), this leaves me puzzled.
This connection for virt-manager worked flawlessly for months when all the
systems had libvirt 0.8.3.

Is this a known incompatibility? Something I have to tweak somewhere?

Thanks,
Whit

</body></email><email><emailId>20110713034400</emailId><senderName>Heath Petersen</senderName><senderEmail>heathpetersen@kandre.com</senderEmail><timestampReceived>2011-07-13 03:44:00-0400</timestampReceived><subject>[libvirt-users] Unable to start libvirtd 0.9.3 on Ubuntu 10.10</subject><body>

I just built libvirt 0.9.3 on my Ubuntu 10.10 box.  It appears to have 
built correctly.

When I try "virsh -c qemu:///session list --all" I get the following:

error: Failed to connect socket to '@/home/heath/.libvirt/libvirt-sock': 
Connection refused
error: failed to connect to the hypervisor

After that, libvirtd isn't running as user heath as it did when I was 
using 0.9.2.  When I run it with LIBVIRT_DEBUG=1 I get this:

. . .
22:26:34.334: 8385: debug : remoteOpen:774 : Auto-spawn user daemon instance
22:26:34.334: 8385: debug : doRemoteOpen:487 : proceeding with name = 
qemu:///session
22:26:34.334: 8385: debug : doRemoteOpen:497 : Connecting with transport 1
22:26:34.378: 8385: debug : doRemoteOpen:544 : Proceeding with sockname 
@/home/heath/.libvirt/libvirt-sock
22:26:34.378: 8385: debug : virCommandRunAsync:1874 : About to run 
LC_ALL=C 
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games 
HOME=/home/heath USER=heath LOGNAME=heath /usr/local/sbin/libvirtd 
--timeout=30
22:26:34.378: 8385: debug : virCommandRunAsync:1890 : Command result 0, 
with PID 8386
22:26:34.379: 8385: debug : virCommandRun:1711 : Result status 0, 
stdout: '(null)' stderr: '(null)'
22:26:55.430: 8385: debug : do_open:1059 : driver 7 remote returned ERROR
22:26:55.430: 8385: debug : virUnrefConnect:145 : unref connection 
0x8451840 1
22:26:55.430: 8385: debug : virReleaseConnect:94 : release connection 
0x8451840
error: Failed to connect socket to '@/home/heath/.libvirt/libvirt-sock': 
Connection refused
error: failed to connect to the hypervisor

I then proceeded to try to start libvirtd manually with "LIBVIRT_DEBUG=1 
LC_ALL=C 
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games 
HOME=/home/heath USER=heath LOGNAME=heath /usr/local/sbin/libvirtd 
--timeout=30".  I got a return code of 1 with the following output:

22:29:33.295: 8389: info : libvirt version: 0.9.3
22:29:33.295: 8389: debug : virInitialize:412 : register drivers
22:29:33.295: 8389: debug : virRegisterDriver:767 : driver=0x3745e0 
name=Test
22:29:33.295: 8389: debug : virRegisterDriver:791 : registering Test as 
driver 0
22:29:33.295: 8389: debug : virRegisterNetworkDriver:584 : registering 
Test as network driver 0
22:29:33.295: 8389: debug : virRegisterInterfaceDriver:617 : registering 
Test as interface driver 0
22:29:33.295: 8389: debug : virRegisterStorageDriver:650 : registering 
Test as storage driver 0
22:29:33.295: 8389: debug : virRegisterDeviceMonitor:683 : registering 
Test as device driver 0
22:29:33.295: 8389: debug : virRegisterSecretDriver:716 : registering 
Test as secret driver 0
22:29:33.295: 8389: debug : virRegisterNWFilterDriver:749 : registering 
Test as network filter driver 0
22:29:33.295: 8389: debug : virRegisterDriver:767 : driver=0x374fa0 name=Xen
22:29:33.295: 8389: debug : virRegisterDriver:791 : registering Xen as 
driver 1
22:29:33.295: 8389: debug : virRegisterDriver:767 : driver=0x375720 
name=OPENVZ
22:29:33.295: 8389: debug : virRegisterDriver:791 : registering OPENVZ 
as driver 2
22:29:33.295: 8389: debug : virRegisterDriver:767 : driver=0x375920 
name=VMWARE
22:29:33.295: 8389: debug : virRegisterDriver:791 : registering VMWARE 
as driver 3
22:29:33.295: 8389: debug : virRegisterDriver:767 : driver=0x375420 
name=PHYP
22:29:33.295: 8389: debug : virRegisterDriver:791 : registering PHYP as 
driver 4
22:29:33.295: 8389: debug : virRegisterStorageDriver:650 : registering 
PHYP as storage driver 1
22:29:33.295: 8389: debug : virRegisterInterfaceDriver:617 : registering 
PHYP as interface driver 1
22:29:33.324: 8389: debug : tryLoadOne:163 : Found VBoxXPCOMC.so in 
'/usr/lib/virtualbox'
22:29:33.324: 8389: debug : vboxRegister:94 : VBoxCGlueInit found API 
version: 4.0.10 (4000010)
22:29:33.324: 8389: debug : vboxRegister:121 : VirtualBox API version: 4.0
22:29:33.324: 8389: debug : virRegisterDriver:767 : driver=0x376920 
name=VBOX
22:29:33.324: 8389: debug : virRegisterDriver:791 : registering VBOX as 
driver 5
22:29:33.324: 8389: debug : virRegisterNetworkDriver:584 : registering 
VBOX as network driver 1
22:29:33.325: 8389: debug : virRegisterStorageDriver:650 : registering 
VBOX as storage driver 2
22:29:33.325: 8389: debug : virRegisterDriver:767 : driver=0x376c20 name=ESX
22:29:33.325: 8389: debug : virRegisterDriver:791 : registering ESX as 
driver 6
22:29:33.325: 8389: debug : virRegisterInterfaceDriver:617 : registering 
ESX as interface driver 2
22:29:33.325: 8389: debug : virRegisterNetworkDriver:584 : registering 
ESX as network driver 2
22:29:33.325: 8389: debug : virRegisterStorageDriver:650 : registering 
ESX as storage driver 3
22:29:33.325: 8389: debug : virRegisterDeviceMonitor:683 : registering 
ESX as device driver 1
22:29:33.325: 8389: debug : virRegisterSecretDriver:716 : registering 
ESX as secret driver 1
22:29:33.325: 8389: debug : virRegisterNWFilterDriver:749 : registering 
ESX as network filter driver 1
22:29:33.325: 8389: debug : virRegisterDriver:767 : driver=0x374a00 
name=remote
22:29:33.325: 8389: debug : virRegisterDriver:791 : registering remote 
as driver 7
22:29:33.325: 8389: debug : virRegisterNetworkDriver:584 : registering 
remote as network driver 3
22:29:33.325: 8389: debug : virRegisterInterfaceDriver:617 : registering 
remote as interface driver 3
22:29:33.325: 8389: debug : virRegisterStorageDriver:650 : registering 
remote as storage driver 4
22:29:33.325: 8389: debug : virRegisterDeviceMonitor:683 : registering 
remote as device driver 2
22:29:33.325: 8389: debug : virRegisterSecretDriver:716 : registering 
remote as secret driver 2
22:29:33.325: 8389: debug : virRegisterNWFilterDriver:749 : registering 
remote as network filter driver 2

Any idea why libvirtd won't run?


-- 
----------
If you want to send stuff to the bit bucket, email Phineas.Ferb@Kandre.com .

</body></email><email><emailId>20110718005434</emailId><senderName>zhang xintao</senderName><senderEmail>zhang.kvm@gmail.com</senderEmail><timestampReceived>2011-07-18 00:54:34-0400</timestampReceived><subject>[libvirt-users] Migrate KVM Guest OS failed</subject><body>

Dear All
         I used Virsh  live Migrate KVM Guest OS failed
         error: unable to set user and group to '104:106' on
'/mnt/run2/N2-WINDOWS-XP-1':Invalid argument

         /mnt/run2/ is a directory of local nfs server
         another host using nfs client share this directory

</body></email><email><emailId>20110719052354</emailId><senderName>"sharmila radha krishnan"</senderName><senderEmail>sharmilaradhakrishnan@rediffmail.com</senderEmail><timestampReceived>2011-07-19 05:23:54-0400</timestampReceived><subject>Re: [libvirt-users] =?utf-8?q?Is_libvirt_supported_on_Citrix_Xenserve?= =?utf-8?q?r=3F?=</subject><body>

Hi,
 I was finally able to connect to the xenapi hypervisor.  However, \
once I connect to virsh and give a 'quit' command I get  "* glibc detected *** \
virsh: double free or corruption (fasttop):". Please find below the actual memory \
dump.  
Note: I have disabled the SSL certificate verification in xenapi_driver.c \
by setting curl_easy_setopt(curl, CURLOPT_SSL_VERIFYPEER, 0) &amp; \
curl_easy_setopt(curl, CURLOPT_SSL_VERIFYHOST, 0).  
 

[root@sharmila libvirt-0.9.2]# virsh -c "xenapi://localhost"
Enter username for localhost: root
Enter root's password for localhost: 
Welcome to virsh, the virtualization interactive terminal.
  
Type:  'help' for help with commands
       'quit' to quit
  
virsh # list --all
 Id Name                 \
                State
----------------------------------
  0 Control domain on host: sharmila running
  - Control domain on host: sharmila running
  - XenServer SDK 5.6.100-47101p import shut off
  
virsh # quit
  
*** glibc detected *** virsh: double free or corruption (fasttop): 0x09fcc370 ***
======= Backtrace: =========
/lib/libc.so.6[0xb6fc56c5]
/lib/libc.so.6(cfree+0x59)[0xb6fc5b09]
/usr/local/lib/libvirt.so.0(virFree+0x42)[0xb760d712]
/usr/local/lib/libvirt.so.0[0xb777031d]
/usr/local/lib/libvirt.so.0[0xb776ec10]
/usr/local/lib/libvirt.so.0[0xb7676017]
/usr/local/lib/libvirt.so.0(virUnrefConnect+0x128)[0xb7677888]
/usr/local/lib/libvirt.so.0(virConnectClose+0xda)[0xb769ad4a]
virsh[0x8065c73]
virsh[0x806672f]
/lib/libc.so.6(__libc_start_main+0xdc)[0xb6f71e9c]
virsh[0x804e0f1]
======= Memory map: ========
08048000-08079000 r-xp 00000000 08:01 378273     \
/usr/local/bin/virsh 08079000-0807a000 rw-p 00031000 08:01 \
378273     /usr/local/bin/virsh 09fa1000-0a060000 rw-p 00000000 \
00:00 0          [heap] \
b6b61000-b6b6c000 r-xp 00000000 08:01 182153     \
/lib/libgcc_s-4.1.2-20080825.so.1 b6b6c000-b6b6d000 rw-p 0000a000 08:01 \
182153     /lib/libgcc_s-4.1.2-20080825.so.1 b6b6d000-b6b77000 \
r-xp 00000000 08:01 181027     /lib/libnss_files-2.5.so \
b6b77000-b6b78000 r--p 00009000 08:01 181027     \
/lib/libnss_files-2.5.so b6b78000-b6b79000 rw-p 0000a000 08:01 \
181027     /lib/libnss_files-2.5.so b6b81000-b6b83000 rw-p \
00000000 00:00 0  b6b83000-b6d83000 r--p 00000000 08:01 \
447132     /usr/lib/locale/locale-archive b6d83000-b6d86000 rw-p \
00000000 00:00 0  b6d86000-b6d88000 r-xp 00000000 08:01 \
180820     /lib/libkeyutils-1.2.so b6d88000-b6d89000 rw-p \
00001000 08:01 180820     /lib/libkeyutils-1.2.so \
b6d89000-b6d91000 r-xp 00000000 08:01 377484     \
/usr/lib/libkrb5support.so.0.1 b6d91000-b6d92000 rw-p 00007000 08:01 \
377484     /usr/lib/libkrb5support.so.0.1 b6d92000-b6d99000 r-xp \
00000000 08:01 182148     /lib/librt-2.5.so b6d99000-b6d9a000 \
r--p 00007000 08:01 182148     /lib/librt-2.5.so \
b6d9a000-b6d9b000 rw-p 00008000 08:01 182148     \
/lib/librt-2.5.so b6d9b000-b6dab000 r-xp 00000000 08:01 \
180816     /lib/libresolv-2.5.so b6dab000-b6dac000 r--p 0000f000 \
08:01 180816     /lib/libresolv-2.5.so b6dac000-b6dad000 rw-p \
00010000 08:01 180816     /lib/libresolv-2.5.so b6dad000-b6daf000 \
rw-p 00000000 00:00 0  b6daf000-b6ddf000 r-xp 00000000 08:01 \
378111     /usr/lib/libidn.so.11.5.19 b6ddf000-b6de0000 rw-p \
0002f000 08:01 378111     /usr/lib/libidn.so.11.5.19 \
b6de0000-b6de1000 rw-p 00000000 00:00 0  b6de1000-b6de3000 r-xp 00000000 08:01 \
180823     /lib/libcom_err.so.2.1 b6de3000-b6de4000 rw-p 00001000 \
08:01 180823     /lib/libcom_err.so.2.1 b6de4000-b6e0a000 r-xp \
00000000 08:01 378185     /usr/lib/libk5crypto.so.3.1 \
b6e0a000-b6e0b000 rw-p 00025000 08:01 378185     \
/usr/lib/libk5crypto.so.3.1 b6e0b000-b6e9f000 r-xp 00000000 08:01 \
378198     /usr/lib/libkrb5.so.3.3 b6e9f000-b6ea2000 rw-p \
00093000 08:01 378198     /usr/lib/libkrb5.so.3.3 \
b6ea2000-b6ece000 r-xp 00000000 08:01 378160     \
/usr/lib/libgssapi_krb5.so.2.2 b6ece000-b6ecf000 rw-p 0002c000 08:01 \
378160     /usr/lib/libgssapi_krb5.so.2.2 b6ecf000-b6ed2000 r-xp \
00000000 08:01 377492     /usr/lib/libgpg-error.so.0.3.0 \
b6ed2000-b6ed3000 rw-p 00002000 08:01 377492     \
/usr/lib/libgpg-error.so.0.3.0 b6ed3000-b6ed4000 rw-p 00000000 00:00 0 
b6ed4000-b6f0f000 r-xp 00000000 08:01 182149     \
/lib/libsepol.so.1 b6f0f000-b6f10000 rw-p 0003b000 08:01 \
182149     /lib/libsepol.so.1 b6f10000-b6f1a000 rw-p 00000000 \
00:00 0  b6f1a000-b6f5a000 r-xp 00000000 08:01 378242     \
/usr/local/lib/libcurl.so.4.1.0 b6f5a000-b6f5b000 rw-p 00040000 08:01 \
378242     /usr/local/lib/libcurl.so.4.1.0 b6f5b000-b6f5c000 rw-p \
00000000 00:00 0  b6f5c000-b70af000 r-xp 00000000 08:01 \
180994     /lib/libc-2.5.so b70af000-b70b1000 r--p 00153000 08:01 \
180994     /lib/libc-2.5.so b70b1000-b70b2000 rw-p 00155000 08:01 \
180994     /lib/libc-2.5.so b70b2000-b70b5000 rw-p 00000000 00:00 \
0  b70b5000-b70b8000 r-xp 00000000 08:01 180979     \
/lib/libdl-2.5.so b70b8000-b70b9000 r--p 00002000 08:01 \
180979     /lib/libdl-2.5.so b70b9000-b70ba000 rw-p 00003000 \
08:01 180979     /lib/libdl-2.5.so b70ba000-b70e1000 r-xp \
00000000 08:01 182017     /lib/libm-2.5.so b70e1000-b70e2000 r--p \
00026000 08:01 182017     /lib/libm-2.5.so b70e2000-b70e3000 rw-p \
00027000 08:01 182017     /lib/libm-2.5.so b70e3000-b70e4000 rw-p \
00000000 00:00 0  b70e4000-b70f6000 r-xp 00000000 08:01 \
378165     /usr/lib/libz.so.1.2.3 b70f6000-b70f7000 rw-p 00011000 \
08:01 378165     /usr/lib/libz.so.1.2.3 b70f7000-b7223000 r-xp \
00000000 08:01 378174     /usr/lib/libxml2.so.2.6.26 \
b7223000-b7228000 rw-p 0012c000 08:01 378174     \
/usr/lib/libxml2.so.2.6.26 b7228000-b7229000 rw-p 00000000 00:00 0 
b7229000-b723e000 r-xp 00000000 08:01 181033     \
/lib/libpthread-2.5.so b723e000-b723f000 r--p 00015000 08:01 \
181033     /lib/libpthread-2.5.so b723f000-b7240000 rw-p 00016000 \
08:01 181033     /lib/libpthread-2.5.so b7240000-b7242000 rw-p \
00000000 00:00 0  b7242000-b7258000 r-xp 00000000 08:01 \
181005     /lib/libselinux.so.1 b7258000-b725a000 rw-p 00015000 \
08:01 181005     /lib/libselinux.so.1 b725a000-b7389000 r-xp \
00000000 08:01 182129     /lib/libcrypto.so.0.9.8e \
b7389000-b739c000 rw-p 0012e000 08:01 182129     \
/lib/libcrypto.so.0.9.8e b739c000-b73a0000 rw-p 00000000 00:00 0 
b73a0000-b73e4000 r-xp 00000000 08:01 180822     \
/lib/libssl.so.0.9.8e b73e4000-b73e8000 rw-p 00043000 08:01 \
180822     /lib/libssl.so.0.9.8e b73e8000-b7419000 r-xp 00000000 \
08:01 383239     /usr/lib/libcurl.so.3.0.0 b7419000-b741a000 rw-p \
00031000 08:01 383239     /usr/lib/libcurl.so.3.0.0 \
b741a000-b741b000 rw-p 00000000 00:00 0  b741b000-b747b000 r-xp 00000000 08:01 \
378267     /usr/lib/libxenserver.so.1.3 b747b000-b747f000 rw-p \
00060000 08:01 378267     /usr/lib/libxenserver.so.1.3 \
b747f000-b74a3000 r-xp 00000000 08:01 383129     \
/usr/lib/libssh2.so.1.0.1 b74a3000-b74a4000 rw-p 00024000 08:01 \
383129     /usr/lib/libssh2.so.1.0.1 b74a4000-b74a8000 r-xp \
00000000 08:01 376977     /usr/lib/libxenstore.so.3.0.0 \
b74a8000-b74a9000 rw-p 00003000 08:01 376977     \
/usr/lib/libxenstore.so.3.0.0 b74a9000-b74ac000 rw-p 00000000 00:00 0 
b74ac000-b752a000 r-xp 00000000 08:01 378181     \
/usr/lib/libgcrypt.so.11.5.2 b752a000-b752d000 rw-p 0007d000 08:01 \
378181     /usr/lib/libgcrypt.so.11.5.2 b752d000-b75a6000 r-xp \
00000000 08:01 380857     /usr/lib/libgnutls.so.13.0.6 \
b75a6000-b75ac000 rw-p 00078000 08:01 380857     \
/usr/lib/libgnutls.so.13.0.6 b75ac000-b75ad000 rw-p 00000000 00:00 0 
b75ad000-b75cc000 r-xp 00000000 08:01 180978     \
/lib/libdevmapper.so.1.02 b75cc000-b75ce000 rw-p 0001e000 08:01 \
180978     /lib/libdevmapper.so.1.02 b75cf000-b75d6000 r--s \
00000000 08:01 412913     /usr/lib/gconv/gconv-modules.cache \
b75d6000-b75d7000 r-xp 00000000 08:01 377141     \
/usr/local/lib/libvirt-qemu.so.0.9.2 b75d7000-b75d8000 rw-p 00000000 08:01 \
377141     /usr/local/lib/libvirt-qemu.so.0.9.2Aborted  
 Moreover, Iam not able to start any VMs uisng xencenter after i have started \
using virsh. It says,  Error: Starting VM 'XenServer SDK 5.6.100-47101p import' \
- Internal error: another frontend device is already connected to this domain \
(frontend (domid=0 | kind=vbd | devid=51712); backend (domid=0 | kind=vbd | \
devid=51712)). Even a reboot of the machine didnt help.  
Any pointers on the above 2 issues would be of great help.
 
Thanks in Advance!
 
Regards,
Sharmila
 
From: "G Naresh Kumar"naresh.gadepalli@gmail.com
Sent: Sat, 16 Jul 2011 16:55:16 +0530
To: Matthias Bolte matthias.bolte@googlemail.com
Cc: libvirt-users@redhat.com
Subject: Re: [libvirt-users] Is libvirt supported on Citrix Xenserver?
 
Hi Matthias,

&gt;


Sorry for the confusion.It was an edited one &amp; hence thetypo. Below is the 
actual output:

# virsh -c xenapi://&lt;myip&gt;
Enter username for &lt;myip&gt;: root
Enter root's password for &lt;myip&gt;: 
error: authentication failed: (null)

I was not able to get anything in the Xen logs. Somehowfigured out to print 
the Xen error using the patch given at the link http://osdir.com/ml/libvir-
list/2011-06/msg00298.html. It prints"TRANSPORT_FAULT". Any pointers to this 
error would be much appreciated. Iam also trying to debugthis issue.

As per your suggestion,
I had used make rpm. But it requires xen-devel pacakge,which I was 
not able to get for Xen 3.4.2. Is there any way where I canuse the source 
package and build &amp; install the library without using'make rpm' ? 

Thanks for all the help.

&gt;
Regards
Naresh
&gt; 
On Thu, Jul 14, 2011 at 7:07 PM, Matthias Bolte &lt;matthias.bolte@googlemail.com&gt; \
wrote:  &gt; 
2011/7/14 G Naresh Kumar &lt;naresh.gadepalli@gmail.com&gt;: 
&gt;&gt; Hi Maththias,
&gt; 
&gt; Thanks for the help. I finally was able to compile/install libvirt on 
&gt;&gt; xenserver.
&gt;&gt;
&gt;&gt; I tried compiling the libvirt 0.9.2 with xen api support. Was able to
&gt;&gt; install it successfully. When I tried giving the virsh command, I got an
&gt;&gt; ‘authentication failed' error as shown below.
&gt;&gt;
&gt;&gt; # virsh -c xenapi://&lt;my local ip&gt;
&gt;&gt; Enter username for &lt;mylocalip&gt;: root
&gt;
&gt;Here you entered root 
&gt; 

&gt;&gt; Enter intel123's password for &lt;my local ip&gt;:
&gt;
&gt;but here it asks for intel123's, that's unexpected. Did you edit this 
&gt;one before mailing it, or is there really this mismatch?
&gt;
&gt;&gt; error: authentication failed: (null)
&gt;
&gt;Outputting (null) here is actually a bug. The only way this can happen
&gt;is when the login attempt fails but the XenServer doesn't provide an
&gt;error message. Maybe have a look at the XenServer logs to see if it
&gt;says something about a failed login attempt.
&gt; 

&gt;&gt; I also tried connecting to the local machine as below,
&gt;&gt;
&gt;&gt; virsh -c "xenapi:///"
&gt;&gt; error: authentication failed: Server name not in URI
&gt;&gt; error: failed to connect to the hypervisor
&gt;
&gt;The XenAPI driver expects a server name. xenapi:/// _could_ be treated 
&gt;as xenapi://localhost, but it's not implemented that way.
&gt; 

&gt;&gt; Also I am trying to install ruby-libvirt on xenserver, which looks like
&gt;&gt; requires libvirt-devel package to be installed. How do I build it from the
&gt;&gt; libvirt 0.9.2 source package.
&gt;
&gt;Running 'make rpm' should build an libvirt-devel RPM package for you. 
&gt; 



&gt;&gt; Thanks,
&gt;&gt;
&gt;&gt; Naresh
&gt;&gt;
&gt;&gt; On Wed, Jun 15, 2011 at 8:19 PM, Matthias Bolte
&gt;&gt; &lt;matthias.bolte@googlemail.com&gt; wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; 2011/6/15 G Naresh Kumar &lt;naresh.gadepalli@gmail.com&gt;:
&gt;&gt;&gt; &gt; Hi Maththias,
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; Thanks a lot for your response!.
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; Is there a specific version of libvirt from which xenserver support \
is &gt;&gt;&gt; &gt; added? I am getting the below error
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; "error: invalid argument in libvirt was built without the 'xenapi'
&gt;&gt;&gt; &gt; driver"
&gt;&gt;&gt;
&gt;&gt;&gt; The means that your libvirt version is new enough and contains the
&gt;&gt;&gt; XenAPI driver but that it was disabled on configure time, probably
&gt;&gt;&gt; because the build server didn't have libxenserver installed and
&gt;&gt;&gt; libvirt's configure script automatically disabled the driver because
&gt;&gt;&gt; of a missing dependency.
&gt;&gt;&gt;
&gt;&gt;&gt; &gt; I have installed libvirt from citrix yum repo.
&gt;&gt;&gt;
&gt;&gt;&gt; Then Citrix build libvirt without XenAPI support. As a long term
&gt;&gt;&gt; solution you could report to whom ever is responsible for that repo
&gt;&gt;&gt; and request to enabled XenAPI support in that libvirt package. As a
&gt;&gt;&gt; short term solution you could build libvirt from source yourself and
&gt;&gt;&gt; make sure to get the XenAPI driver enabled.
&gt;&gt;&gt;
&gt;&gt;&gt; &gt; I am using Xenserver 5.5 with libvirt 0.8.2 and it does not seem to \
be &gt;&gt;&gt; &gt; working.
&gt;&gt;&gt;
&gt;&gt;&gt; According to http://libvirt.org/hvsupport.html and the error message
&gt;&gt;&gt; 0.8.2 is new enough.
&gt;&gt;&gt;
&gt;&gt;&gt; Matthias
&gt;&gt;&gt;
&gt;&gt;&gt; &gt; Thanks,
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; Naresh
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; On Jun 15, 2011 7:03 PM, "Matthias Bolte"
&gt;&gt;&gt; &gt; &lt;matthias.bolte@googlemail.com&gt;
&gt;&gt;&gt; &gt; wrote:
&gt;&gt;&gt; &gt;&gt; 2011/6/15 G Naresh Kumar &lt;naresh.gadepalli@gmail.com&gt;:
&gt;&gt;&gt; &gt;&gt;&gt; Hi,
&gt;&gt;&gt; &gt;&gt;&gt; Is libvirt supported on Citrix Xenserver. I have been \
searching for &gt;&gt;&gt; &gt;&gt;&gt; the
&gt;&gt;&gt; &gt;&gt;&gt; same
&gt;&gt;&gt; &gt;&gt;&gt; with little/no luck.
&gt;&gt;&gt; &gt;&gt;&gt; If supported, can you point to some links/documents which \
can help me &gt;&gt;&gt; &gt;&gt;&gt; try
&gt;&gt;&gt; &gt;&gt;&gt; out the same.
&gt;&gt;&gt; &gt;&gt;&gt; Thanks,
&gt;&gt;&gt; &gt;&gt;&gt; Naresh
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; libvirt can use XenAPI via libxenserver [1]. That should allow \
you to &gt;&gt;&gt; &gt;&gt; use libvirt with a Citrix XenServer. You can use virsh \
like this &gt;&gt;&gt; &gt;&gt; assuming you have a libxenserver enabled libvirt:
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; virsh -c xenapi://my-xen-server
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; But it's true, there is no documentation about this on the \
libvirt &gt;&gt;&gt; &gt;&gt; website
&gt;&gt;&gt; &gt;&gt; yet.
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; [1] http://community.citrix.com/display/xs/Download+SDKs
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; --
&gt;&gt;&gt; &gt;&gt; Matthias Bolte
&gt;&gt;&gt; &gt;&gt; http://photron.blogspot.com
&gt;&gt;&gt; &gt;
&gt;&gt; --
&gt;&gt; I was an atheist till I realized I am GOD
&gt;&gt;
&gt;
&gt;-- 
&gt; 


Matthias Bolte 
&gt;http://photron.blogspot.com
&gt;
&gt;
 
&gt;-- 
&gt;I was an atheist till I realized I am GOD
&gt;_______________________________________________ 
&gt;libvirt-users mailing list
&gt;libvirt-users@redhat.com
&gt;https://www.redhat.com/mailman/listinfo/libvirt-users 


[Attachment #3 (unknown)]

&lt;DIV&gt;Hi,&lt;/DIV&gt;
&lt;DIV&gt; I was finally able to connect to the xenapi \
hypervisor.  However, once I connect to virsh and give a 'quit' command I \
get  "* glibc detected *** virsh: double free or corruption (fasttop):". Please \
find below the actual memory dump.&lt;/DIV&gt; &lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;&lt;STRONG&gt;&lt;EM&gt;Note:&lt;/EM&gt;&lt;/STRONG&gt; I have disabled the SSL certificate verification \
in xenapi_driver.c by setting curl_easy_setopt(curl, CURLOPT_SSL_VERIFYPEER, 0) \
&amp; curl_easy_setopt(curl, CURLOPT_SSL_VERIFYHOST, 0).&lt;/DIV&gt; &lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;BLOCKQUOTE style="MARGIN-RIGHT: 0px" dir=ltr&gt;
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;[root@sharmila libvirt-0.9.2]# virsh -c \
"xenapi://localhost"&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;Enter username for \
localhost: root&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;Enter root's password for \
localhost: &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;Welcome to virsh, the \
virtualization interactive terminal.&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;  &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;Type:  'help' \
for help with commands&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;       'quit' to quit&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;  &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;virsh # \
list --all&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt; Id \
Name                 \
State&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;----------------------------------&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;  0 Control domain on host: sharmila running&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;  - Control domain on host: sharmila \
running&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;  - XenServer SDK 5.6.100-47101p \
import shut off&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;  &lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;virsh # quit&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;  &lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;*** glibc detected *** virsh: double free or corruption \
(fasttop): 0x09fcc370 ***&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;======= Backtrace: \
=========&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;/lib/libc.so.6[0xb6fc56c5]&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;/lib/libc.so.6(cfree+0x59)[0xb6fc5b09]&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;/usr/local/lib/libvirt.so.0(virFree+0x42)[0xb760d712]&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;/usr/local/lib/libvirt.so.0[0xb777031d]&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;/usr/local/lib/libvirt.so.0[0xb776ec10]&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;/usr/local/lib/libvirt.so.0[0xb7676017]&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;/usr/local/lib/libvirt.so.0(virUnrefConnect+0x128)[0xb7677888]&lt;/FONT&gt;&lt;/DIV&gt;
 &lt;DIV&gt;&lt;FONT color=#0000ff&gt;/usr/local/lib/libvirt.so.0(virConnectClose+0xda)[0xb769ad4a]&lt;/FONT&gt;&lt;/DIV&gt;
 &lt;DIV&gt;&lt;FONT color=#0000ff&gt;virsh[0x8065c73]&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;virsh[0x806672f]&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;/lib/libc.so.6(__libc_start_main+0xdc)[0xb6f71e9c]&lt;/FONT&gt;&lt;/DIV&gt;
 &lt;DIV&gt;&lt;FONT color=#0000ff&gt;virsh[0x804e0f1]&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;======= Memory map: ========&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;08048000-08079000 r-xp 00000000 08:01 \
378273     /usr/local/bin/virsh&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;08079000-0807a000 rw-p 00031000 08:01 378273     \
/usr/local/bin/virsh&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;09fa1000-0a060000 rw-p \
00000000 00:00 0          \
[heap]&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6b61000-b6b6c000 r-xp 00000000 08:01 \
182153     /lib/libgcc_s-4.1.2-20080825.so.1&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6b6c000-b6b6d000 rw-p 0000a000 08:01 \
182153     /lib/libgcc_s-4.1.2-20080825.so.1&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6b6d000-b6b77000 r-xp 00000000 08:01 \
181027     /lib/libnss_files-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6b77000-b6b78000 r--p 00009000 08:01 181027     \
/lib/libnss_files-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6b78000-b6b79000 rw-p \
0000a000 08:01 181027     /lib/libnss_files-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6b81000-b6b83000 rw-p 00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6b83000-b6d83000 r--p 00000000 08:01 \
447132     /usr/lib/locale/locale-archive&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6d83000-b6d86000 rw-p 00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6d86000-b6d88000 r-xp 00000000 08:01 180820     \
/lib/libkeyutils-1.2.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6d88000-b6d89000 rw-p \
00001000 08:01 180820     /lib/libkeyutils-1.2.so&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6d89000-b6d91000 r-xp 00000000 08:01 \
377484     /usr/lib/libkrb5support.so.0.1&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6d91000-b6d92000 rw-p 00007000 08:01 377484     \
/usr/lib/libkrb5support.so.0.1&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6d92000-b6d99000 r-xp 00000000 08:01 182148     \
/lib/librt-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6d99000-b6d9a000 r--p \
00007000 08:01 182148     /lib/librt-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6d9a000-b6d9b000 rw-p 00008000 08:01 \
182148     /lib/librt-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6d9b000-b6dab000 r-xp 00000000 08:01 180816     \
/lib/libresolv-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6dab000-b6dac000 r--p \
0000f000 08:01 180816     /lib/libresolv-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6dac000-b6dad000 rw-p 00010000 08:01 \
180816     /lib/libresolv-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6dad000-b6daf000 rw-p 00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6daf000-b6ddf000 r-xp 00000000 08:01 378111     \
/usr/lib/libidn.so.11.5.19&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6ddf000-b6de0000 \
rw-p 0002f000 08:01 378111     \
/usr/lib/libidn.so.11.5.19&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6de0000-b6de1000 \
rw-p 00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6de1000-b6de3000 r-xp \
00000000 08:01 180823     /lib/libcom_err.so.2.1&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6de3000-b6de4000 rw-p 00001000 08:01 \
180823     /lib/libcom_err.so.2.1&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6de4000-b6e0a000 r-xp 00000000 08:01 378185     \
/usr/lib/libk5crypto.so.3.1&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6e0a000-b6e0b000 \
rw-p 00025000 08:01 378185     \
/usr/lib/libk5crypto.so.3.1&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6e0b000-b6e9f000 \
r-xp 00000000 08:01 378198     \
/usr/lib/libkrb5.so.3.3&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6e9f000-b6ea2000 rw-p \
00093000 08:01 378198     /usr/lib/libkrb5.so.3.3&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6ea2000-b6ece000 r-xp 00000000 08:01 \
378160     /usr/lib/libgssapi_krb5.so.2.2&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6ece000-b6ecf000 rw-p 0002c000 08:01 378160     \
/usr/lib/libgssapi_krb5.so.2.2&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6ecf000-b6ed2000 r-xp 00000000 08:01 377492     \
/usr/lib/libgpg-error.so.0.3.0&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6ed2000-b6ed3000 rw-p 00002000 08:01 377492     \
/usr/lib/libgpg-error.so.0.3.0&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6ed3000-b6ed4000 rw-p 00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6ed4000-b6f0f000 r-xp 00000000 08:01 182149     \
/lib/libsepol.so.1&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6f0f000-b6f10000 rw-p \
0003b000 08:01 182149     /lib/libsepol.so.1&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6f10000-b6f1a000 rw-p 00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6f1a000-b6f5a000 r-xp 00000000 08:01 \
378242     /usr/local/lib/libcurl.so.4.1.0&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6f5a000-b6f5b000 rw-p 00040000 08:01 \
378242     /usr/local/lib/libcurl.so.4.1.0&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6f5b000-b6f5c000 rw-p 00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6f5c000-b70af000 r-xp 00000000 08:01 \
180994     /lib/libc-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b70af000-b70b1000 r--p 00153000 08:01 180994     \
/lib/libc-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b70b1000-b70b2000 rw-p \
00155000 08:01 180994     /lib/libc-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b70b2000-b70b5000 rw-p 00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b70b5000-b70b8000 r-xp 00000000 08:01 \
180979     /lib/libdl-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b70b8000-b70b9000 r--p 00002000 08:01 180979     \
/lib/libdl-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b70b9000-b70ba000 rw-p \
00003000 08:01 180979     /lib/libdl-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b70ba000-b70e1000 r-xp 00000000 08:01 \
182017     /lib/libm-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b70e1000-b70e2000 r--p 00026000 08:01 182017     \
/lib/libm-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b70e2000-b70e3000 rw-p \
00027000 08:01 182017     /lib/libm-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b70e3000-b70e4000 rw-p 00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b70e4000-b70f6000 r-xp 00000000 08:01 \
378165     /usr/lib/libz.so.1.2.3&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b70f6000-b70f7000 rw-p 00011000 08:01 378165     \
/usr/lib/libz.so.1.2.3&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b70f7000-b7223000 r-xp \
00000000 08:01 378174     /usr/lib/libxml2.so.2.6.26&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b7223000-b7228000 rw-p 0012c000 08:01 \
378174     /usr/lib/libxml2.so.2.6.26&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b7228000-b7229000 rw-p 00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b7229000-b723e000 r-xp 00000000 08:01 181033     \
/lib/libpthread-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b723e000-b723f000 r--p \
00015000 08:01 181033     /lib/libpthread-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b723f000-b7240000 rw-p 00016000 08:01 \
181033     /lib/libpthread-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b7240000-b7242000 rw-p 00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b7242000-b7258000 r-xp 00000000 08:01 181005     \
/lib/libselinux.so.1&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b7258000-b725a000 rw-p \
00015000 08:01 181005     /lib/libselinux.so.1&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b725a000-b7389000 r-xp 00000000 08:01 \
182129     /lib/libcrypto.so.0.9.8e&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b7389000-b739c000 rw-p 0012e000 08:01 182129     \
/lib/libcrypto.so.0.9.8e&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b739c000-b73a0000 rw-p \
00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b73a0000-b73e4000 r-xp \
00000000 08:01 180822     /lib/libssl.so.0.9.8e&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b73e4000-b73e8000 rw-p 00043000 08:01 \
180822     /lib/libssl.so.0.9.8e&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b73e8000-b7419000 r-xp 00000000 08:01 383239     \
/usr/lib/libcurl.so.3.0.0&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b7419000-b741a000 \
rw-p 00031000 08:01 383239     \
/usr/lib/libcurl.so.3.0.0&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b741a000-b741b000 \
rw-p 00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b741b000-b747b000 r-xp \
00000000 08:01 378267     \
/usr/lib/libxenserver.so.1.3&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b747b000-b747f000 \
rw-p 00060000 08:01 378267     \
/usr/lib/libxenserver.so.1.3&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b747f000-b74a3000 \
r-xp 00000000 08:01 383129     \
/usr/lib/libssh2.so.1.0.1&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b74a3000-b74a4000 \
rw-p 00024000 08:01 383129     \
/usr/lib/libssh2.so.1.0.1&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b74a4000-b74a8000 \
r-xp 00000000 08:01 376977     \
/usr/lib/libxenstore.so.3.0.0&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b74a8000-b74a9000 \
rw-p 00003000 08:01 376977     \
/usr/lib/libxenstore.so.3.0.0&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b74a9000-b74ac000 \
rw-p 00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b74ac000-b752a000 r-xp \
00000000 08:01 378181     \
/usr/lib/libgcrypt.so.11.5.2&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b752a000-b752d000 \
rw-p 0007d000 08:01 378181     \
/usr/lib/libgcrypt.so.11.5.2&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b752d000-b75a6000 \
r-xp 00000000 08:01 380857     \
/usr/lib/libgnutls.so.13.0.6&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b75a6000-b75ac000 \
rw-p 00078000 08:01 380857     \
/usr/lib/libgnutls.so.13.0.6&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b75ac000-b75ad000 \
rw-p 00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b75ad000-b75cc000 r-xp \
00000000 08:01 180978     /lib/libdevmapper.so.1.02&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b75cc000-b75ce000 rw-p 0001e000 08:01 \
180978     /lib/libdevmapper.so.1.02&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b75cf000-b75d6000 r--s 00000000 08:01 412913     \
/usr/lib/gconv/gconv-modules.cache&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b75d6000-b75d7000 r-xp 00000000 08:01 377141     \
/usr/local/lib/libvirt-qemu.so.0.9.2&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b75d7000-b75d8000 rw-p 00000000 08:01 377141     \
/usr/local/lib/libvirt-qemu.so.0.9.2Aborted&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt; &lt;/DIV&gt;&lt;/BLOCKQUOTE&gt; &lt;DIV&gt; Moreover, Iam not able to start any VMs \
uisng xencenter after i have started using virsh. It says,  &lt;STRONG&gt;Error: \
Starting VM 'XenServer SDK 5.6.100-47101p import' - Internal error: another frontend \
device is already connected to this domain (frontend (domid=0 | kind=vbd | \
devid=51712); backend (domid=0 | kind=vbd | devid=51712)).&lt;/STRONG&gt; Even a reboot of \
the machine didnt help.&lt;/DIV&gt; &lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;Any pointers on the above 2 issues would be of great help.&lt;/DIV&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;Thanks in Advance!&lt;/DIV&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;Regards,&lt;/DIV&gt;
&lt;DIV&gt;Sharmila&lt;/DIV&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;From: "G Naresh Kumar"naresh.gadepalli@gmail.com&lt;/DIV&gt;
&lt;DIV&gt;Sent: Sat, 16 Jul 2011 16:55:16 +0530&lt;/DIV&gt;
&lt;DIV&gt;To: Matthias Bolte matthias.bolte@googlemail.com&lt;/DIV&gt;
&lt;DIV&gt;Cc: libvirt-users@redhat.com&lt;/DIV&gt;
&lt;DIV&gt;Subject: Re: [libvirt-users] Is libvirt supported on Citrix Xenserver?&lt;/DIV&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;Hi Matthias,&lt;/DIV&gt;
&lt;DIV&gt;
&lt;DIV&gt;&gt;&lt;/DIV&gt;&lt;/DIV&gt;
&lt;DIV&gt;
&lt;P cl-ass="MsoNormal"&gt;&lt;/P&gt;
&lt;P cl-ass="MsoNormal"&gt;Sorry for the &lt;a href='http://confusion.It'&gt;confusion.It&lt;/a&gt; \
was an edited one &amp; hence thetypo. Below is the &lt;/P&gt; &lt;P cl-ass="MsoNormal"&gt;actual \
output:&lt;/P&gt; &lt;P cl-ass="MsoNormal"&gt;&lt;/P&gt;
&lt;P cl-ass="MsoNormal"&gt;# virsh -c xenapi://&lt;myip&gt;&lt;/P&gt;
&lt;P cl-ass="MsoNormal"&gt;Enter username for &lt;myip&gt;: root&lt;/P&gt;
&lt;P cl-ass="MsoNormal"&gt;Enter root's password for &lt;myip&gt;: &lt;/P&gt;
&lt;P cl-ass="MsoNormal"&gt;error: authentication failed: (null)&lt;/P&gt;
&lt;P cl-ass="MsoNormal"&gt;&lt;/P&gt;
&lt;P cl-ass="MsoNormal"&gt;I was not able to get anything in the Xen logs. Somehowfigured \
out to print &lt;/P&gt; &lt;P cl-ass="MsoNormal"&gt;the Xen error using the patch given at the \
link &lt;a href='http://osdir.com/ml/libvir-'&gt;http://osdir.com/ml/libvir-&lt;/a&gt;&lt;/P&gt; &lt;P \
cl-ass="MsoNormal"&gt;list/2011-06/msg00298.html. It prints"TRANSPORT_FAULT". Any \
pointers to this &lt;/P&gt; &lt;P cl-ass="MsoNormal"&gt;error would be much appreciated. Iam also \
trying to debugthis issue.&lt;/P&gt; &lt;P cl-ass="MsoNormal"&gt;&lt;/P&gt;
&lt;P cl-ass="MsoNormal"&gt;As per your suggestion,&lt;/P&gt;
&lt;P cl-ass="MsoNormal"&gt;I had used make rpm. But it requires xen-devel pacakge,which I \
was &lt;/P&gt; &lt;P cl-ass="MsoNormal"&gt;not able to get for Xen 3.4.2. Is there any way where \
I canuse the source &lt;/P&gt; &lt;P cl-ass="MsoNormal"&gt;package and build &amp; install the \
library without using'make rpm' ? &lt;/P&gt; &lt;P cl-ass="MsoNormal"&gt;&lt;/P&gt;
&lt;P cl-ass="MsoNormal"&gt;Thanks for all the help.&lt;/P&gt;
&lt;P cl-ass="MsoNormal"&gt;
&lt;DIV&gt;&gt;&lt;/DIV&gt;
&lt;P cl-ass="MsoNormal"&gt;Regards&lt;/P&gt;
&lt;P cl-ass="MsoNormal"&gt;Naresh&lt;/P&gt;
&lt;DIV&gt;&gt; &lt;/DIV&gt;
&lt;DIV cl-ass="gmail_quote"&gt;On Thu, Jul 14, 2011 at 7:07 PM, Matthias Bolte &lt;SPAN \
dir=ltr&gt;&lt;&lt;A onclick="top.ajaxMail.ext.switchTo('@Compose','mode=mail_to_individual&amp;email=matthias.bolte@googlemail.com');" \
href="javascript:void(0);"&gt;matthias.bolte@googlemail.com&lt;/A&gt;&gt;&lt;/SPAN&gt; wrote:  \
&lt;DIV&gt;&gt; &lt;/DIV&gt; &lt;BLOCKQUOTE style="BORDER-LEFT: #ccc 1px solid; MARGIN: 0px 0px 0px \
0.8ex; PADDING-LEFT: 1ex" cl-ass="gmail_quote"&gt;2011/7/14 G Naresh Kumar &lt;&lt;A \
onclick="top.ajaxMail.ext.switchTo('@Compose','mode=mail_to_individual&amp;email=naresh.gadepalli@gmail.com');" \
href="javascript:void(0);"&gt;naresh.gadepalli@gmail.com&lt;/A&gt;&gt;:  &lt;DIV&gt;&gt;&gt; Hi \
Maththias,&lt;/DIV&gt; &lt;DIV&gt;&gt; &lt;/DIV&gt;
&lt;DIV cl-ass="im"&gt;&gt; Thanks for the help. I finally was able to compile/install \
libvirt on  &lt;DIV&gt;&gt;&gt; xenserver.&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt; I tried compiling the libvirt 0.9.2 with xen api support. Was able \
to&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt; install it successfully. When I tried giving the virsh \
command, I got an&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt; ‘authentication failed' error as shown \
below.&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt; # virsh -c xenapi://&lt;my local ip&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt; Enter username for &lt;mylocalip&gt;: root&lt;/DIV&gt;
&lt;DIV&gt;&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&lt;/DIV&gt;&lt;/DIV&gt;Here you entered root 
&lt;DIV&gt;&gt; &lt;/DIV&gt;
&lt;DIV cl-ass="im"&gt;
&lt;DIV&gt;&gt;&gt; Enter intel123's password for &lt;my local ip&gt;:&lt;/DIV&gt;
&lt;DIV&gt;&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&lt;/DIV&gt;&lt;/DIV&gt;but here it asks for intel123's, that's unexpected. Did you edit \
this  &lt;DIV&gt;&gt;one before mailing it, or is there really this mismatch?&lt;/DIV&gt;
&lt;DIV&gt;&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt; error: authentication failed: (null)&lt;/DIV&gt;
&lt;DIV&gt;&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;Outputting (null) here is actually a bug. The only way this can happen&lt;/DIV&gt;
&lt;DIV&gt;&gt;is when the login attempt fails but the XenServer doesn't provide an&lt;/DIV&gt;
&lt;DIV&gt;&gt;error message. Maybe have a look at the XenServer logs to see if it&lt;/DIV&gt;
&lt;DIV&gt;&gt;says something about a failed login attempt.&lt;/DIV&gt;
&lt;DIV&gt;&gt; &lt;/DIV&gt;
&lt;DIV cl-ass="im"&gt;
&lt;DIV&gt;&gt;&gt; I also tried connecting to the local machine as below,&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt; virsh -c "xenapi:///"&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt; error: authentication failed: Server name not in URI&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt; error: failed to connect to the hypervisor&lt;/DIV&gt;
&lt;DIV&gt;&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&lt;/DIV&gt;&lt;/DIV&gt;The XenAPI driver expects a server name. xenapi:/// _could_ be \
treated  &lt;DIV&gt;&gt;as xenapi://localhost, but it's not implemented that way.&lt;/DIV&gt;
&lt;DIV&gt;&gt; &lt;/DIV&gt;
&lt;DIV cl-ass="im"&gt;
&lt;DIV&gt;&gt;&gt; Also I am trying to install ruby-libvirt on xenserver, which looks \
like&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt; requires libvirt-devel package to be installed. How do I \
build it from the&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt; libvirt 0.9.2 source package.&lt;/DIV&gt;
&lt;DIV&gt;&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&lt;/DIV&gt;&lt;/DIV&gt;Running 'make rpm' should build an libvirt-devel RPM package for \
you.  &lt;DIV&gt;&gt; &lt;/DIV&gt;
&lt;DIV&gt;
&lt;DIV&gt;&lt;/DIV&gt;
&lt;DIV cl-ass="h5"&gt;
&lt;DIV&gt;&gt;&gt; Thanks,&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt; Naresh&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt; On Wed, Jun 15, 2011 at 8:19 PM, Matthias Bolte&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt; &lt;&lt;A \
onclick="top.ajaxMail.ext.switchTo('@Compose','mode=mail_to_individual&amp;email=matthias.bolte@googlemail.com');" \
href="javascript:void(0);"&gt;matthias.bolte@googlemail.com&lt;/A&gt;&gt; wrote:&lt;/DIV&gt; \
&lt;DIV&gt;&gt;&gt;&gt;&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt;&gt; 2011/6/15 G Naresh Kumar &lt;&lt;A \
onclick="top.ajaxMail.ext.switchTo('@Compose','mode=mail_to_individual&amp;email=naresh.gadepalli@gmail.com');" \
href="javascript:void(0);"&gt;naresh.gadepalli@gmail.com&lt;/A&gt;&gt;:&lt;/DIV&gt; \
&lt;DIV&gt;&gt;&gt;&gt; &gt; Hi Maththias,&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt;&gt; &gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt; Thanks a lot for your response!.&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt; Is there a specific version of libvirt from which xenserver \
support is&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt;&gt; &gt; added? I am getting the below error&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt; "error: invalid argument in libvirt was built without the \
'xenapi'&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt;&gt; &gt; driver"&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; The means that your libvirt version is new enough and contains \
the&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt;&gt; XenAPI driver but that it was disabled on configure time, \
probably&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt;&gt; because the build server didn't have libxenserver \
installed and&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt;&gt; libvirt's configure script automatically \
disabled the driver because&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt;&gt; of a missing dependency.&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt; I have installed libvirt from citrix yum repo.&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; Then Citrix build libvirt without XenAPI support. As a long \
term&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt;&gt; solution you could report to whom ever is responsible \
for that repo&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt;&gt; and request to enabled XenAPI support in that \
libvirt package. As a&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt;&gt; short term solution you could build \
libvirt from source yourself and&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt;&gt; make sure to get the XenAPI \
driver enabled.&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt;&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt; I am using Xenserver 5.5 with libvirt 0.8.2 and it does not \
seem to be&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt;&gt; &gt; working.&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; According to &lt;a \
href='http://libvirt.org/hvsupport.html'&gt;http://libvirt.org/hvsupport.html&lt;/a&gt; and \
the error message&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt;&gt; 0.8.2 is new enough.&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; Matthias&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt; Thanks,&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt; Naresh&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt; On Jun 15, 2011 7:03 PM, "Matthias Bolte"&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt; &lt;&lt;A \
onclick="top.ajaxMail.ext.switchTo('@Compose','mode=mail_to_individual&amp;email=matthias.bolte@googlemail.com');" \
href="javascript:void(0);"&gt;matthias.bolte@googlemail.com&lt;/A&gt;&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&gt;&gt;&gt; &gt; wrote:&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt;&gt; &gt;&gt; 2011/6/15 G Naresh \
Kumar &lt;&lt;A onclick="top.ajaxMail.ext.switchTo('@Compose','mode=mail_to_individual&amp;email=naresh.gadepalli@gmail.com');" \
href="javascript:void(0);"&gt;naresh.gadepalli@gmail.com&lt;/A&gt;&gt;:&lt;/DIV&gt; \
&lt;DIV&gt;&gt;&gt;&gt; &gt;&gt;&gt; Hi,&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt;&gt; &gt;&gt;&gt; Is libvirt \
supported on Citrix Xenserver. I have been searching for&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt;&gt; \
&gt;&gt;&gt; the&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt;&gt; &gt;&gt;&gt; same&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt;&gt;&gt; with little/no luck.&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt;&gt;&gt; If supported, can you point to some links/documents \
which can help me&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt;&gt; &gt;&gt;&gt; try&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt;&gt;&gt; out the same.&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt;&gt;&gt; Thanks,&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt;&gt;&gt; Naresh&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt;&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt;&gt; libvirt can use XenAPI via libxenserver [1]. That should \
allow you to&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt;&gt; &gt;&gt; use libvirt with a Citrix XenServer. \
You can use virsh like this&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt;&gt; &gt;&gt; assuming you have a \
libxenserver enabled libvirt:&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt;&gt; &gt;&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt;&gt; virsh -c xenapi://my-xen-server&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt;&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt;&gt; But it's true, there is no documentation about this on the \
libvirt&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt;&gt; &gt;&gt; website&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt;&gt; yet.&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt;&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt;&gt; [1] &lt;a \
href='http://community.citrix.com/display/xs/Download+SDKs'&gt;http://community.citrix.com/display/xs/Download+SDKs&lt;/a&gt;&lt;/DIV&gt;
 &lt;DIV&gt;&gt;&gt;&gt; &gt;&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt;&gt; --&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt;&gt; Matthias Bolte&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&gt; &gt;&gt; &lt;a \
href='http://photron.blogspot.com'&gt;http://photron.blogspot.com&lt;/a&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&gt;&gt;&gt; &gt;&lt;/DIV&gt; &lt;DIV&gt;&gt;&gt; --&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt; I was an atheist till I realized I am GOD&lt;/DIV&gt;
&lt;DIV&gt;&gt;&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;-- 
&lt;DIV&gt;&gt; &lt;/DIV&gt;
&lt;DIV&gt;
&lt;DIV&gt;&lt;/DIV&gt;
&lt;DIV cl-ass="h5"&gt;Matthias Bolte 
&lt;DIV&gt;&gt;&lt;a href='http://photron.blogspot.com'&gt;http://photron.blogspot.com&lt;/a&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/BLOCKQUOTE&gt;&lt;/DIV&gt;
&lt;DIV&gt;&gt;&lt;/DIV&gt;
&lt;DIV clear="all"&gt; &lt;/DIV&gt;
&lt;DIV&gt;&gt;-- &lt;/DIV&gt;
&lt;DIV&gt;&gt;I was an atheist till I realized I am GOD&lt;/DIV&gt;
&lt;DIV&gt;&gt;&lt;/DIV&gt;&lt;/DIV&gt;_______________________________________________ 
&lt;DIV&gt;&gt;libvirt-users mailing list&lt;/DIV&gt;
&lt;DIV&gt;&gt;libvirt-users@redhat.com&lt;/DIV&gt;
&lt;DIV&gt;&gt;https://www.redhat.com/mailman/listinfo/libvirt-users &lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;&lt;br&gt;&lt;A HREF="http://sigads.rediff.com/RealMedia/ads/click_nx.ads/www.rediffmail.com/signatureline.htm@Middle?" \
target="_blank"&gt;&lt;IMG \
SRC="http://sigads.rediff.com/RealMedia/ads/adstream_nx.ads/www.rediffmail.com/signatureline.htm@Middle"&gt;&lt;/A&gt;&lt;br&gt;Treat \
yourself at a restaurant, spa, resort and much more with &lt;b&gt;&lt;a \
href="http://track.rediff.com/click?url=___http://dealhojaye.rediff.com?sc_cid=mailsignature___&amp;cmp=signature&amp;lnk=rediffmailsignature&amp;newservice=deals" \
target ="_new"&gt;Rediff Deal ho jaye!&lt;/a&gt;&lt;/b&gt;



</body></email><email><emailId>20110718020754</emailId><senderName>zhang xintao</senderName><senderEmail>zhang.kvm@gmail.com</senderEmail><timestampReceived>2011-07-18 02:07:54-0400</timestampReceived><subject>[libvirt-users] cannot perform tunnelled migration without using peer2peer flag</subject><body>

Dear All
         I try to migration a kvm guest os to another host failed
         server: ubuntu 11.04 server
         virsh:migrate --live --tunnelled vm1   qemu+ssh://192.168.10.3/system
         error:Requested operation is not valid:cannot perform
tunnelled migration without using peer2peer flag

</body></email><email><emailId>20110718101116</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-07-18 10:11:16-0400</timestampReceived><subject>Re: [libvirt-users] cannot perform tunnelled migration without using peer2peer flag</subject><body>

于 2011年07月18日 10:07, zhang xintao 写道:
&gt; Dear All
&gt;           I try to migration a kvm guest os to another host failed
&gt;           server: ubuntu 11.04 server
&gt;           virsh:migrate --live --tunnelled vm1   qemu+ssh://192.168.10.3/system
&gt;           error:Requested operation is not valid:cannot perform
&gt; tunnelled migration without using peer2peer flag

The error tells you all, you need to use "--p2p".

Regards
Osier
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110718164733</emailId><senderName>David Ehle</senderName><senderEmail>ehle@agni.phys.iit.edu</senderEmail><timestampReceived>2011-07-18 16:47:33-0400</timestampReceived><subject>[libvirt-users] RAID1 over IP?</subject><body>


I asksed about this in November last year but got on response.  Anyone 
have any ideas now?

Does anyone here have any experience with using KVM/libvirt with RAID1 
over IP/DRBD or other HA solution?

I'm trying to figure out the hardware configuration I would need to be 
able to survive a failure or planned shutdown of any one unit in a 
virtualization cluster.

KVM/libvirt makes moving running VM's from one host to another a no 
brainer, but I'm trying to figure out the right way to be able to take a 
the storage backend for maintenance without disrupting the VMs.

Right now I'm thinking something like KVM + libvirt + heartbeat/corosync + 
pacemaker + DBRM on Ubuntu 10.04 with 3 or 4 nodes - 2 hosts, 2 storage, 
or 1 host, 1 host + storage, 1 storage.

Any thoughts?

Thanks!


</body></email><email><emailId>20110615094358</emailId><senderName>G Naresh Kumar</senderName><senderEmail>naresh.gadepalli@gmail.com</senderEmail><timestampReceived>2011-06-15 09:43:58-0400</timestampReceived><subject>[libvirt-users] Is libvirt supported on Citrix Xenserver?</subject><body>

Hi,

Is libvirt supported on Citrix Xenserver. I have been searching for the same
with little/no luck.

If supported, can you point to some links/documents which can help me try
out the same.

Thanks,
Naresh

[Attachment #3 (text/html)]

Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is libvirt supported on Citrix Xenserver. I have been \
searching for the same with little/no luck.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If supported, \
can you point to some links/documents which can help me try out the same.&lt;/div&gt;

&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;Naresh&lt;br clear="all"&gt;&lt;br&gt;
&lt;/div&gt;



</body></email><email><emailId>20110725083830</emailId><senderName>kp chetan</senderName><senderEmail>chethankpc@gmail.com</senderEmail><timestampReceived>2011-07-25 08:38:30-0400</timestampReceived><subject>[libvirt-users] Need help for Qemu-KVM</subject><body>

[Attachment #3 (text/html)]



</body></email><email><emailId>20110725200604</emailId><senderName>Whit Blauvelt</senderName><senderEmail>whit.virt@transpect.com</senderEmail><timestampReceived>2011-07-25 20:06:04-0400</timestampReceived><subject>[libvirt-users] Wanted: method for qemu hook script to know if called for migration</subject><body>

Hi,

"Before a QEMU guest is started, the qemu hook script is called"
(http://libvirt.org/hooks.html)...

In writing a simple bash script to prevent a VM on shared storage from being
started on one host if it's already running on another, it's easy enough to
check if virsh on the other host reports the particular VM as "shut off"
there, and go ahead if that's the case. What's I'm having trouble coming up
with is a simple method to allow a migration from the second system over to
the first with that script in place.

As the doc says, /etc/libvirt/hooks/qemu is "Executed when a QEMU guest is
started, stopped, or migrated," so when it's simply being started, it makes
sense to be sure it's not already running on the second system, and prevent
the start if it's not. Works fine for me. But when a migration is requested,
the script is called in the same way as when it's being started. What I need
is a way, from within the script, to tell whether it's a migration context,
so that then the start will be allowed, despite the VM's already being
running on the second system.

Any ideas how to do that? Unfortunately what's passed to the script directly
is just "[vmname] start begin -" in both cases. And I don't see that a
separate migrate process shows up in the process tables until after getting
beyond the qemu hook script. 

As a feature suggestion, it would be nice if that fourth input variable,
currently "-", was something like "migrate" in this instance.

Thanks,
Whit

</body></email><email><emailId>20110725174228</emailId><senderName>"Stefan G. Weichinger"</senderName><senderEmail>lists@xunil.at</senderEmail><timestampReceived>2011-07-25 17:42:28-0400</timestampReceived><subject>[libvirt-users] Split a qcow2-image?</subject><body>


Hello,

I converted a W2003-Server to a vmdk-image, I didn't think too much back
then ...

Now I have 2 windows-drives C: and E: inside one vmdk-image-file, which
was converted to qcow2.

I have installed drivers and stuff into that VM already and would like
to avoid to start over again with the vmdk-file -&gt;

Is there a way to split that one qcow2 into 2 separate files, one for
each windows-harddisk?

or plan B: can I possibly enlarge the part of C: inside that qcow2?

I use qemu-kvm on gentoo linux, and libvirt-0.9.3-r1.

I would appreciate any help on this topic!

Thanks Stefan

</body></email><email><emailId>20110726114257</emailId><senderName>Adnan Pasic</senderName><senderEmail>pqado@yahoo.de</senderEmail><timestampReceived>2011-07-26 11:42:57-0400</timestampReceived><subject>[libvirt-users] Ping not working after a migration</subject><body>

Hello guys,
maybe you can help me with following issue. I have 
created a little cloud with a host and two worker nodes using opennebula. The setup \
went  successfully until now, I am able to create VM's and move them via 
normal and live migration.
Another (possibly) important information is that I configured my virtual bridge on \
both worker nodes like this:


auto br0 iface br0 inet static address 192.168.0.[2|3] netmask 255.255.255.0 network \
192.168.0.0 broadcast 192.168.0.255 #gateway 192.168.0.1 bridge_ports eth0 bridge_stp \
on bridge_maxwait 0 The command "brctl show" gives me following things back:


bridge name    bridge id            STP enabled    interfaces
br0            8000.003005c34278    yes            eth0
                                                   vnet0 (&lt;- only appears on node \
with running VM)

virbr0         8000.000000000000    yes

According to thelibvirt wiki this setting is good as is. However, the issue I'm \
having is that when I create a VM and assign a static IP to it, which looks like e.g. \
192.168.0.5,  I firstly am able to ping this VM from both worker nodes, and also when \
I perform a live migration the ping stops for a few seconds (until the nodes realize \
the new route to this VM) and then  starts pinging normally again.

However, when I perform a normal migration the ping doesn't recover anymore, but \
answers repeatedly with: Destination Host Unreachable

Do you know what could be the problem? Where is the difference between a normal and \
live migration and how can the ping after live migrating still work, but after a \
normal migration not?

Thanks a lot!
Regards, Adnan


[Attachment #3 (text/html)]

&lt;html&gt;&lt;body&gt;&lt;div style="color:#000; background-color:#fff; font-family:arial, \
helvetica, sans-serif;font-size:10pt"&gt;&lt;div&gt;Hello guys,&lt;br&gt;maybe you can help me with \
following issue. I have  created a little cloud with a host and two worker nodes \
using opennebula. The setup went  successfully until now, I am able to create VM's \
and move them via  normal and live migration.&lt;br&gt;Another (possibly) important \
information is that I configured my virtual bridge on both worker nodes like \
this:&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;pre&gt; auto br0  iface br0 inet static
         address 192.168.0.[2|3]
         netmask 255.255.255.0
         network 192.168.0.0
         broadcast 192.168.0.255
         #gateway 192.168.0.1
         bridge_ports eth0
         bridge_stp on
         bridge_maxwait 0&lt;/pre&gt;&lt;br&gt;The command "brctl show" gives me following things \
back:&lt;br&gt;&lt;br&gt;&lt;pre&gt;bridge name&lt;span class="yiv1622593519tab"&gt;    bridge \
id&lt;/span&gt;&lt;span class="yiv1622593519tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv1622593519tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv1622593519tab"&gt;    &lt;/span&gt;&lt;span class="yiv1622593519tab"&gt;STP \
enabled&lt;/span&gt;&lt;span class="yiv1622593519tab"&gt;    \
interfaces&lt;br&gt;br0&lt;/span&gt;&lt;span class="yiv1622593519tab"&gt;    \
&lt;/span&gt;&lt;span class="yiv1622593519tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv1622593519tab"&gt;    8000.003005c34278&lt;/span&gt;&lt;span \
class="yiv1622593519tab"&gt;    yes&lt;/span&gt;&lt;span \
class="yiv1622593519tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv1622593519tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv1622593519tab"&gt;    eth0&lt;br&gt;&lt;/span&gt;&lt;span \
class="yiv1622593519tab"&gt;    &lt;/span&gt;&lt;span  \
class="yiv1622593519tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv1622593519tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv1622593519tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv1622593519tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv1622593519tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv1622593519tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv1622593519tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv1622593519tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv1622593519tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv1622593519tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv1622593519tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv1622593519tab"&gt;   vnet0 (&lt;- only appears on node with running \
VM)&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class="yiv1622593519tab"&gt;virbr0&lt;/span&gt;&lt;span \
class="yiv1622593519tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv1622593519tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv1622593519tab"&gt; 8000.000000000000&lt;/span&gt;&lt;span  \
class="yiv1622593519tab"&gt;    yes&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;font \
style="font-family:arial, helvetica, sans-serif;" size="2"&gt;According to \
the&lt;/font&gt;&lt;font style="font-family:arial, helvetica, sans-serif;" size="2"&gt; libvirt \
wiki this setting is good as is.&lt;/font&gt; &lt;font size="2"&gt;However, the issue I'm having \
is that when I create a VM and assign a static IP to it, which looks like e.g. \
192.168.0.5, &lt;br&gt;I firstly am able to ping this VM from both&lt;/font&gt; &lt;font \
size="2"&gt;worker nodes, and also when I perform a live migration the ping stops for a \
few seconds (until the nodes realize the new route to this VM) and then &lt;br&gt;starts \
pinging normally again.&lt;br&gt;&lt;br&gt;However, when I perform a normal migration the ping \
doesn't recover anymore, but answers repeatedly with: Destination Host \
Unreachable&lt;br&gt;&lt;br&gt;Do you know what could be the problem? Where is the difference \
between a normal and live migration and how can the ping after live migrating still \
work, but after a  normal migration not?&lt;br&gt;&lt;br&gt;Thanks a lot!&lt;br&gt;Regards, \
Adnan&lt;/font&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20110726140732</emailId><senderName>Jeff</senderName><senderEmail>jwk1230@gmail.com</senderEmail><timestampReceived>2011-07-26 14:07:32-0400</timestampReceived><subject>[libvirt-users] insert ISO into a KVM guest</subject><body>

There's got to be a simple way to attach an ISO to a KVM guest. I just haven't yet \
discovered it.

I've tried adding the following stanza to my guest XML file, under the &lt;devices&gt; \
stanza and starting the guest:

&lt;disk type='file' device='cdrom'&gt;
   &lt;driver name='qemu' type='raw' /&gt;
   &lt;source file='/etc/libvirt/qemu/isos/kvm1.iso' /&gt;
   &lt;target dev='hda' bus='ide' /&gt;
   &lt;readonly /&gt;
&lt;/disk&gt;


But I get the following:

error: Failed to start domain rhel6guest
error: internal error process exited while connecting to monitor: char device \
                redirected to /dev/pts/3
qemu: could not open disk image /etc/libvirt/qemu/isos/kvm1.iso: Permission denied


A perms issue should be easy to address one would think, but I've tried every \
possible combination of perms changes including 777. Changed ownership from root to \
qemu:qemu (though I'm running as root). I'm not running SELinux. 

Anyone have any insights on how to mount a simple ISO into a KVM guest?  Both at \
build time AND while the guest is running?

Thanks

Jeff


</body></email><email><emailId>20110726062501</emailId><senderName>Igor Serebryany</senderName><senderEmail>igor47@moomers.org</senderEmail><timestampReceived>2011-07-26 06:25:01-0400</timestampReceived><subject>[libvirt-users] python-libvirt for 0.9.3 leaking file descriptors</subject><body>


i've reported this issue before, so i guess this is a regression. looks
like the python bindings for 0.9.3 are leaking file descriptors:

root@cloud1:~# python
Python 2.6.6 (r266:84292, Dec 26 2010, 22:31:48) 
[GCC 4.4.5] on linux2
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt; import libvirt
&gt;&gt;&gt; libvirt.getVersion()
9003
&gt;&gt;&gt; def openclose():
...     c = libvirt.open('qemu:///system')
...     c.close()
... 
&gt;&gt;&gt; import os
&gt;&gt;&gt; os.system('lsof -p %d | wc -l' % os.getpid())
37
&gt;&gt;&gt; openclose()
&gt;&gt;&gt; os.system('lsof -p %d | wc -l' % os.getpid())
40
&gt;&gt;&gt; openclose()
&gt;&gt;&gt; os.system('lsof -p %d | wc -l' % os.getpid())
43

every time I open and close a connection to libvirt, i loose 3 file
descriptors. these are a socket and two fifo pipes. i'm using the -3
build on debian sid.

can someone test this on a fedora machine? curious if this is something
inside libvirt or a problem with the build...

thanks,
--igor

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20110726201545</emailId><senderName>Whit Blauvelt</senderName><senderEmail>whit.virt@transpect.com</senderEmail><timestampReceived>2011-07-26 20:15:45-0400</timestampReceived><subject>[libvirt-users] lock managers</subject><body>

On Mon, Jul 25, 2011 at 03:32:32PM -0600, Eric Blake wrote:

&gt; Yes, both useful lock managers (sanlock and fcntl) work best with
&gt; the use of a shared lock directory, at which point they correctly
&gt; handle live migration between hosts.  

Where would I learn how to use fcntl for this? I see code for it in the
current git, but no hint on usage. Perhaps I should just be patient?

Thanks,
Whit

</body></email><email><emailId>20110726095522</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-07-26 09:55:22-0400</timestampReceived><subject>Re: [libvirt-users] python-libvirt for 0.9.3 leaking file descriptors</subject><body>

ÓÚ 2011Äê07Ô 26ÈÕ 14:25, Igor Serebryany Ð´µÀ:
&gt; i've reported this issue before, so i guess this is a regression. looks
&gt; like the python bindings for 0.9.3 are leaking file descriptors:
&gt;
&gt; root@cloud1:~# python
&gt; Python 2.6.6 (r266:84292, Dec 26 2010, 22:31:48) 
&gt; [GCC 4.4.5] on linux2
&gt; Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt;&gt; import libvirt
&gt;&gt;&gt;&gt; libvirt.getVersion()
&gt; 9003
&gt;&gt;&gt;&gt; def openclose():
&gt; ...     c = libvirt.open('qemu:///system')
&gt; ...     c.close()
&gt; ... 
&gt;&gt;&gt;&gt; import os
&gt;&gt;&gt;&gt; os.system('lsof -p %d | wc -l' % os.getpid())
&gt; 37
&gt;&gt;&gt;&gt; openclose()
&gt;&gt;&gt;&gt; os.system('lsof -p %d | wc -l' % os.getpid())
&gt; 40
&gt;&gt;&gt;&gt; openclose()
&gt;&gt;&gt;&gt; os.system('lsof -p %d | wc -l' % os.getpid())
&gt; 43
&gt;
&gt; every time I open and close a connection to libvirt, i loose 3 file
&gt; descriptors. these are a socket and two fifo pipes. i'm using the -3
&gt; build on debian sid.
&gt;
&gt; can someone test this on a fedora machine? curious if this is something
&gt; inside libvirt or a problem with the build...
&gt;
&gt; thanks,
&gt; --igor

Hello Igor,

I don't see this problem on my FC15, I'm using the git HEAD.

Osier
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users


[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta content="text/html; charset=GB2312" http-equiv="Content-Type"&gt;
  &lt;/head&gt;
  &lt;body bgcolor="#ffffff" text="#000000"&gt;
    ÓÚ 2011Äê07Ô 26ÈÕ 14:25, Igor Serebryany Ð´µÀ:
    &lt;blockquote cite="mid:20110726062501.GF7582@moomers.org" type="cite"&gt;
      &lt;pre wrap=""&gt;i've reported this issue before, so i guess this is a regression. \
looks like the python bindings for 0.9.3 are leaking file descriptors:

root@cloud1:~# python
Python 2.6.6 (r266:84292, Dec 26 2010, 22:31:48) 
[GCC 4.4.5] on linux2
Type "help", "copyright", "credits" or "license" for more information.
&lt;/pre&gt;
      &lt;blockquote type="cite"&gt;
        &lt;blockquote type="cite"&gt;
          &lt;blockquote type="cite"&gt;
            &lt;pre wrap=""&gt;import libvirt
libvirt.getVersion()
&lt;/pre&gt;
          &lt;/blockquote&gt;
        &lt;/blockquote&gt;
      &lt;/blockquote&gt;
      &lt;pre wrap=""&gt;9003
&lt;/pre&gt;
      &lt;blockquote type="cite"&gt;
        &lt;blockquote type="cite"&gt;
          &lt;blockquote type="cite"&gt;
            &lt;pre wrap=""&gt;def openclose():
&lt;/pre&gt;
          &lt;/blockquote&gt;
        &lt;/blockquote&gt;
      &lt;/blockquote&gt;
      &lt;pre wrap=""&gt;...     c = libvirt.open('qemu:///system')
...     c.close()
... 
&lt;/pre&gt;
      &lt;blockquote type="cite"&gt;
        &lt;blockquote type="cite"&gt;
          &lt;blockquote type="cite"&gt;
            &lt;pre wrap=""&gt;import os
os.system('lsof -p %d | wc -l' % os.getpid())
&lt;/pre&gt;
          &lt;/blockquote&gt;
        &lt;/blockquote&gt;
      &lt;/blockquote&gt;
      &lt;pre wrap=""&gt;37
&lt;/pre&gt;
      &lt;blockquote type="cite"&gt;
        &lt;blockquote type="cite"&gt;
          &lt;blockquote type="cite"&gt;
            &lt;pre wrap=""&gt;openclose()
os.system('lsof -p %d | wc -l' % os.getpid())
&lt;/pre&gt;
          &lt;/blockquote&gt;
        &lt;/blockquote&gt;
      &lt;/blockquote&gt;
      &lt;pre wrap=""&gt;40
&lt;/pre&gt;
      &lt;blockquote type="cite"&gt;
        &lt;blockquote type="cite"&gt;
          &lt;blockquote type="cite"&gt;
            &lt;pre wrap=""&gt;openclose()
os.system('lsof -p %d | wc -l' % os.getpid())
&lt;/pre&gt;
          &lt;/blockquote&gt;
        &lt;/blockquote&gt;
      &lt;/blockquote&gt;
      &lt;pre wrap=""&gt;43

every time I open and close a connection to libvirt, i loose 3 file
descriptors. these are a socket and two fifo pipes. i'm using the -3
build on debian sid.

can someone test this on a fedora machine? curious if this is something
inside libvirt or a problem with the build...

thanks,
--igor
&lt;/pre&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
    Hello Igor,&lt;br&gt;
    &lt;br&gt;
    I don't see this problem on my FC15, I'm using the git HEAD.&lt;br&gt;
    &lt;br&gt;
    Osier&lt;br&gt;
    &lt;blockquote cite="mid:20110726062501.GF7582@moomers.org" type="cite"&gt;
      &lt;pre wrap=""&gt;
&lt;fieldset class="mimeAttachmentHeader"&gt;&lt;/fieldset&gt;
_______________________________________________
libvirt-users mailing list
&lt;a class="moz-txt-link-abbreviated" \
href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt; &lt;a \
class="moz-txt-link-freetext" \
href="https://www.redhat.com/mailman/listinfo/libvirt-users"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;/pre&gt;
  &lt;/blockquote&gt;
    &lt;br&gt;
  &lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20110726162958</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-07-26 16:29:58-0400</timestampReceived><subject>Re: [libvirt-users] python-libvirt for 0.9.3 leaking file descriptors</subject><body>

2011/7/26 Igor Serebryany &lt;igor47@moomers.org&gt;:
&gt; i've reported this issue before, so i guess this is a regression. looks
&gt; like the python bindings for 0.9.3 are leaking file descriptors:
&gt;
&gt; root@cloud1:~# python
&gt; Python 2.6.6 (r266:84292, Dec 26 2010, 22:31:48)
&gt; [GCC 4.4.5] on linux2
&gt; Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt;&gt; import libvirt
&gt;&gt;&gt;&gt; libvirt.getVersion()
&gt; 9003
&gt;&gt;&gt;&gt; def openclose():
&gt; ...     c = libvirt.open('qemu:///system')
&gt; ...     c.close()
&gt; ...
&gt;&gt;&gt;&gt; import os
&gt;&gt;&gt;&gt; os.system('lsof -p %d | wc -l' % os.getpid())
&gt; 37
&gt;&gt;&gt;&gt; openclose()
&gt;&gt;&gt;&gt; os.system('lsof -p %d | wc -l' % os.getpid())
&gt; 40
&gt;&gt;&gt;&gt; openclose()
&gt;&gt;&gt;&gt; os.system('lsof -p %d | wc -l' % os.getpid())
&gt; 43
&gt;
&gt; every time I open and close a connection to libvirt, i loose 3 file
&gt; descriptors. these are a socket and two fifo pipes. i'm using the -3
&gt; build on debian sid.
&gt;
&gt; can someone test this on a fedora machine? curious if this is something
&gt; inside libvirt or a problem with the build...

I can reproduce this with libvirt 0.9.3, but not with current git.
Therefore, this problem seems to be fixed in git. I've you want to
backport the fix to libvirt 0.9.3 you should be able to find it using
git bisect.

That one of the FDs is a socket suggests that this is related to the
remote driver.

-- 
Matthias Bolte
http://photron.blogspot.com

</body></email><email><emailId>20110725180104</emailId><senderName>"Stefan G. Weichinger"</senderName><senderEmail>lists@xunil.at</senderEmail><timestampReceived>2011-07-25 18:01:04-0400</timestampReceived><subject>Re: [libvirt-users] Split a qcow2-image?</subject><body>

Am 25.07.2011 19:42, schrieb Stefan G. Weichinger:

&gt; Is there a way to split that one qcow2 into 2 separate files, one for
&gt; each windows-harddisk?
&gt; 
&gt; or plan B: can I possibly enlarge the part of C: inside that qcow2?

I just give it a try with gparted now ... and resize the partitions for
a start. E: gets smaller, C: larger ... that should suffice.

S

</body></email><email><emailId>20110725194941</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-07-25 19:49:41-0400</timestampReceived><subject>Re: [libvirt-users] Split a qcow2-image?</subject><body>

On 07/25/2011 12:01 PM, Stefan G. Weichinger wrote:
&gt; Am 25.07.2011 19:42, schrieb Stefan G. Weichinger:
&gt;
&gt;&gt; Is there a way to split that one qcow2 into 2 separate files, one for
&gt;&gt; each windows-harddisk?
&gt;&gt;
&gt;&gt; or plan B: can I possibly enlarge the part of C: inside that qcow2?
&gt;
&gt; I just give it a try with gparted now ... and resize the partitions for
&gt; a start. E: gets smaller, C: larger ... that should suffice.

Have you tried using virt-resize yet?  That may have all the 
functionality you need for resizing partitions; although I'm not sure if 
it can completely remove a partition.  If it can, then you'd use 
original-&gt;copy1 to remove the e: partition, and original-&gt;copy2 to 
remove the c: partition, leaving you with two files for the two 
partitions with sizes of your choice.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20110725201708</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-07-25 20:17:08-0400</timestampReceived><subject>Re: [libvirt-users] Wanted: method for qemu hook script to know if called for migration</subject><body>

On 07/25/2011 02:06 PM, Whit Blauvelt wrote:
&gt; In writing a simple bash script to prevent a VM on shared storage from being
&gt; started on one host if it's already running on another,

Not to distract from your bug report, but have you considered using the 
new sanlock (0.9.3) or fcntl (0.9.4) lock managers, that do this 
automatically, without the need for using hook scripts.

http://libvirt.org/locking.html

&gt; Any ideas how to do that? Unfortunately what's passed to the script directly
&gt; is just "[vmname] start begin -" in both cases. And I don't see that a
&gt; separate migrate process shows up in the process tables until after getting
&gt; beyond the qemu hook script.
&gt;
&gt; As a feature suggestion, it would be nice if that fourth input variable,
&gt; currently "-", was something like "migrate" in this instance.

Yes, that is probably a bug worth fixing.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20110725212522</emailId><senderName>Whit Blauvelt</senderName><senderEmail>whit.virt@transpect.com</senderEmail><timestampReceived>2011-07-25 21:25:22-0400</timestampReceived><subject>Re: [libvirt-users] Wanted: method for qemu hook script to know if called for migration</subject><body>

On Mon, Jul 25, 2011 at 02:17:08PM -0600, Eric Blake wrote:

&gt; Not to distract from your bug report, but have you considered using
&gt; the new sanlock (0.9.3) or fcntl (0.9.4) lock managers, that do this
&gt; automatically, without the need for using hook scripts.
&gt; 
&gt; http://libvirt.org/locking.html

Thanks Eric. Interesting alternative. 

What I'm trying not to allow is starting a second instance of a VM from a
raw image which is present on two hosts at the same time (using sometimes
DRBD, sometimes GlusterFS). So it's not a case of two running VMs being in
contention for some disk storage external to them, but of two hosts being in
contention to run the same VM. The VM exists on storage mirrored between the
two hosts.

In trying to understand whether sanlock will work in this instance, I see at
http://permalink.gmane.org/gmane.comp.emulators.libvirt/40261:
  
  sanlock will ... protect against 2 vms on the same host using the same
  disk (or the same VM being started twice due to error by libvirt).

By implication if I have the sanlock directory on a shared filesystem, it
will also prevent a VM from being started on the second host while running
on the first. Will it still allow the VM to do a live migration? Or will
live migration run up against the lock?

Whit

</body></email><email><emailId>20110727000425</emailId><senderName>Whit Blauvelt</senderName><senderEmail>whit.virt@transpect.com</senderEmail><timestampReceived>2011-07-27 00:04:25-0400</timestampReceived><subject>[libvirt-users] with current libvirt git virsh expects vbox, refuses kvm define</subject><body>

Okay, just installed libvirt from today's git on two Ubuntu systems. The
first one went fine (except for continuation of the problem that virsh and
virt-manager cannot connect to 0.8.3 systems that's been there in the 0.9.x
libvirts) ... but on the second, after install, "virsh list --all" presents
nothing. And:

  # virsh define tu1004.xml 
  error: Failed to define domain from tu1004.xml
  error: internal error unexpected domain type kvm, expecting vbox

These are _exactly_ the same xml files as are still working on the first
system. And in both cases the new libvirt was built with defaults. Long ago
the second system did have VirtualBox on it, so that may have been found
while it was setting up config, but that's no good reason for KVM to fail
here, right?

Must be a thing with the git. Ran the 0.9.3 release built on this system
previously without this problem.

Whit

</body></email><email><emailId>20110727024357</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-07-27 02:43:57-0400</timestampReceived><subject>Re: [libvirt-users] with current libvirt git virsh expects vbox, refuses kvm define</subject><body>

于 2011年07月27日 08:04, Whit Blauvelt 写道:
&gt; Okay, just installed libvirt from today's git on two Ubuntu systems. The
&gt; first one went fine (except for continuation of the problem that virsh and
&gt; virt-manager cannot connect to 0.8.3 systems that's been there in the 0.9.x
&gt; libvirts) ... but on the second, after install, "virsh list --all" presents
&gt; nothing. And:
&gt;
&gt;    # virsh define tu1004.xml
&gt;    error: Failed to define domain from tu1004.xml
&gt;    error: internal error unexpected domain type kvm, expecting vbox
&gt;
&gt; These are _exactly_ the same xml files as are still working on the first
&gt; system. And in both cases the new libvirt was built with defaults. Long ago
&gt; the second system did have VirtualBox on it, so that may have been found
&gt; while it was setting up config, but that's no good reason for KVM to fail
&gt; here, right?
&gt;
&gt; Must be a thing with the git. Ran the 0.9.3 release built on this system
&gt; previously without this problem.
&gt;
&gt; Whit
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

Hi, Whit

What's the output of "# virsh -V" on your second ubuntu box? I guess
your libvirt on that box might not be compiled with qemu driver.

Another possiablity is the libvirt is compiled with both qemu driver and 
vbox
driver, but when you try to creat a new connection, vbox was the first
succesfully connected one. In this case, you can try like below:

# virsh -c qemu:///sytem list --all

Or you can set the ENV variable VIRSH_DEFAULT_CONNECT_URI or
LIBVIRT_DEFAULT_URI to the URI of the hypervisor you want to connect to.

Osier

</body></email><email><emailId>20110727035217</emailId><senderName>Whit Blauvelt</senderName><senderEmail>whit.virt@transpect.com</senderEmail><timestampReceived>2011-07-27 03:52:17-0400</timestampReceived><subject>Re: [libvirt-users] with current libvirt git virsh expects vbox, refuses kvm define</subject><body>

&gt; What's the output of "# virsh -V" on your second ubuntu box? I guess
&gt; your libvirt on that box might not be compiled with qemu driver.

# virsh -V
Virsh command line tool of libvirt 0.9.3 ...

Compiled with support for:
 Hypervisors: QEmu/KVM UML OpenVZ VirtualBox LXC ESX Test
 Networking: Remote Daemon Network Bridging Nwfilter VirtualPort
 Storage: Dir Filesystem SCSI Multipath LVM
 Miscellaneous: SELinux Secrets Debug Readline

&gt; Another possiablity is the libvirt is compiled with both qemu driver and
&gt; vbox driver, but when you try to creat a new connection, vbox was the
&gt; first succesfully connected one. In this case, you can try like below:

Why? Ah, I do have a couple stray vbox processes somehow:

root     25265  0.0  0.1  86076  4304 ?        S    19:34   0:00 \
/usr/lib/virtualbox/VBoxXPCOMIPCD root     25274  0.0  0.1 209964  6672 ?        Sl   \
19:34   0:02 /usr/lib/virtualbox/VBoxSVC --pipe 4 --auto-shutdown

But that should cause it to deny it knows how to handle Qemu/KVM? 

&gt; # virsh -c qemu:///sytem list --all

Okay, that one works.

&gt; Or you can set the ENV variable VIRSH_DEFAULT_CONNECT_URI or
&gt; LIBVIRT_DEFAULT_URI to the URI of the hypervisor you want to connect to.

The first (at least) also works. Thanks. 

Whit


</body></email><email><emailId>20110727072108</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-07-27 07:21:08-0400</timestampReceived><subject>Re: [libvirt-users] with current libvirt git virsh expects vbox, refuses kvm define</subject><body>

2011/7/27 Whit Blauvelt &lt;whit.virt@transpect.com&gt;:
&gt; &gt; What's the output of "# virsh -V" on your second ubuntu box? I guess
&gt; &gt; your libvirt on that box might not be compiled with qemu driver.
&gt; 
&gt; # virsh -V
&gt; Virsh command line tool of libvirt 0.9.3 ...
&gt; 
&gt; Compiled with support for:
&gt; Hypervisors: QEmu/KVM UML OpenVZ VirtualBox LXC ESX Test
&gt; Networking: Remote Daemon Network Bridging Nwfilter VirtualPort
&gt; Storage: Dir Filesystem SCSI Multipath LVM
&gt; Miscellaneous: SELinux Secrets Debug Readline
&gt; 
&gt; &gt; Another possiablity is the libvirt is compiled with both qemu driver and
&gt; &gt; vbox driver, but when you try to creat a new connection, vbox was the
&gt; &gt; first succesfully connected one. In this case, you can try like below:
&gt; 
&gt; Why? Ah, I do have a couple stray vbox processes somehow:
&gt; 
&gt; root     25265  0.0  0.1  86076  4304 ?        S    19:34   0:00 \
&gt; /usr/lib/virtualbox/VBoxXPCOMIPCD root     25274  0.0  0.1 209964  6672 ?        Sl \
&gt; 19:34   0:02 /usr/lib/virtualbox/VBoxSVC --pipe 4 --auto-shutdown 
&gt; But that should cause it to deny it knows how to handle Qemu/KVM?

The point is that libvirt autodetects the available hypervisors at
runtime when you don't specify a connection URI. For example, just
running virsh results in autodetecting VirtualBox because you have it
installed in a way that it's still working and due to the way libvirt
works internally VirtualBox comes before QEMU in the autodetection
list.

&gt; &gt; # virsh -c qemu:///sytem list --all
&gt; 
&gt; Okay, that one works.

Here you're telling libvirt to connect to QEMU explicitly, that's why
it doesn't do autodetection here.

The initial "error: internal error unexpected domain type kvm,
expecting vbox" you saw was added recently to prevent incompatible
driver/config combinations. In you're case it highlighted that
autodetection didn't work for you as expected.

-- 
Matthias Bolte
http://photron.blogspot.com


</body></email><email><emailId>20110727124259</emailId><senderName>Whit Blauvelt</senderName><senderEmail>whit.virt@transpect.com</senderEmail><timestampReceived>2011-07-27 12:42:59-0400</timestampReceived><subject>Re: [libvirt-users] with current libvirt git virsh expects vbox, refuses kvm define</subject><body>

On Wed, Jul 27, 2011 at 09:21:08AM +0200, Matthias Bolte wrote:

&gt; The point is that libvirt autodetects the available hypervisors at
&gt; runtime when you don't specify a connection URI. For example, just
&gt; running virsh results in autodetecting VirtualBox because you have it
&gt; installed in a way that it's still working and due to the way libvirt
&gt; works internally VirtualBox comes before QEMU in the autodetection
&gt; list.

But shouldn't it autodetect _all_ available hypervisors and then, when an
xml file specifies kvm - which is available - use it rather than complain it
has a problem with it? You're describing the current behavior as if it's to
be accepted. Clearly having libvirt recognize that the kvm hypervisor is
available, and automatically using it when the xml file specifies it, does
not take some extraordinary level of clever programming. "The xml specifies
kvm. Do I have kvm? Why, yes I do!"

&gt; The initial "error: internal error unexpected domain type kvm,
&gt; expecting vbox" you saw was added recently to prevent incompatible
&gt; driver/config combinations. In you're case it highlighted that
&gt; autodetection didn't work for you as expected.

Fine, so when it recognizes it has the wrong driver for the config, it
should grab the right driver. No reason for it to complain to me about it.
It should simply do its job. Right? This is a bug that it doesn't?

Whit

</body></email><email><emailId>20110727133829</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-07-27 13:38:29-0400</timestampReceived><subject>Re: [libvirt-users] with current libvirt git virsh expects vbox, refuses kvm define</subject><body>

2011/7/27 Whit Blauvelt &lt;whit.virt@transpect.com&gt;:
&gt; On Wed, Jul 27, 2011 at 09:21:08AM +0200, Matthias Bolte wrote:
&gt;
&gt;&gt; The point is that libvirt autodetects the available hypervisors at
&gt;&gt; runtime when you don't specify a connection URI. For example, just
&gt;&gt; running virsh results in autodetecting VirtualBox because you have it
&gt;&gt; installed in a way that it's still working and due to the way libvirt
&gt;&gt; works internally VirtualBox comes before QEMU in the autodetection
&gt;&gt; list.
&gt;
&gt; But shouldn't it autodetect _all_ available hypervisors and then, when an
&gt; xml file specifies kvm - which is available - use it rather than complain it
&gt; has a problem with it? You're describing the current behavior as if it's to
&gt; be accepted. Clearly having libvirt recognize that the kvm hypervisor is
&gt; available, and automatically using it when the xml file specifies it, does
&gt; not take some extraordinary level of clever programming. "The xml specifies
&gt; kvm. Do I have kvm? Why, yes I do!"
&gt;
&gt;&gt; The initial "error: internal error unexpected domain type kvm,
&gt;&gt; expecting vbox" you saw was added recently to prevent incompatible
&gt;&gt; driver/config combinations. In you're case it highlighted that
&gt;&gt; autodetection didn't work for you as expected.
&gt;
&gt; Fine, so when it recognizes it has the wrong driver for the config, it
&gt; should grab the right driver. No reason for it to complain to me about it.
&gt; It should simply do its job. Right? This is a bug that it doesn't?
&gt;
&gt; Whit
&gt;

That's not how libvirt works. The architecture is different than you
seem to expect it.

When you open a connection libvirt picks a driver for it. If you're
using virsh you may not be aware of the connection as this is
happening mostly implicit.

If you tell libvirt which driver/hypervisor you want then it'll try to
use that one. For example when you do virsh -c qemu:///system then
libvirt will ask it's connection/hypervisor drivers until it find one
that accepts this URI. In case of qemu:///system the QEMU driver will
accept it in the end (after going through the remote driver, but
that's transparent for the user). If you just run virsh then libvirt
will again ask it's drivers one after another if they can accept an
empty connection URI. In you case the VirtualBox driver accepted it
because it found a local VirtualBox installation that it can use.

Once the connection is opened and has a driver assigned then calls to
the libvirt API are dispatched to the selected driver. So when you do
a virsh define then this will call the implementation of the
virDomainDefine function in the VirtualBox driver (because that one
was autoselected). There is no driver selection in the API after the
connection is opened.

For libvirt to work as you describe it virsh define (actually
virDomainDefine) needs to parse the XML to the the type and pick a
driver based on that. That might work to some extend in the local case
where qemu:///system could be deduced from type=kvm, but won't work in
the general or remote case. For example a domain config with type
vmware can be used with the VMware ESX and the VMware Workstation
driver, so how to pick the driver here? Even when you solve this by
using vmware-esx and vmware-workstation instead then you need to tell
libvirt in the virDomainDefine call where the ESX server is and with
what options and credentials you want open the connection. In the
current libvirt architecture you do that when you open the connection
via the connection URI instead.

Your suggestion also implies that virsh list lists all domains on all
available hypervisors. This requires name/ID/UUID uniqueness across
multiple hypervisors, that gets hairy fast. Also you have the problem
of specifying the connection details to virsh list, maybe even for
multiple remote connections.

So there is no bug in general here, as this is how libvirt is designed
to work. One could argue that libvirt should be able to pick the right
driver in virDomainDefine, but that is not as simple as it sounds.
Also it doesn't fit to the way things currently work, so I don't see
that happening anytime soon.

-- 
Matthias Bolte
http://photron.blogspot.com

</body></email><email><emailId>20110727134829</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2011-07-27 13:48:29-0400</timestampReceived><subject>Re: [libvirt-users] with current libvirt git virsh expects vbox, refuses kvm define</subject><body>

On 07/27/2011 03:21 AM, Matthias Bolte wrote:
&gt; 2011/7/27 Whit Blauvelt &lt;whit.virt@transpect.com&gt;:
&gt; &gt; &gt; What's the output of "# virsh -V" on your second ubuntu box? I guess
&gt; &gt; &gt; your libvirt on that box might not be compiled with qemu driver.
&gt; &gt; 
&gt; &gt; # virsh -V
&gt; &gt; Virsh command line tool of libvirt 0.9.3 ...
&gt; &gt; 
&gt; &gt; Compiled with support for:
&gt; &gt; Hypervisors: QEmu/KVM UML OpenVZ VirtualBox LXC ESX Test
&gt; &gt; Networking: Remote Daemon Network Bridging Nwfilter VirtualPort
&gt; &gt; Storage: Dir Filesystem SCSI Multipath LVM
&gt; &gt; Miscellaneous: SELinux Secrets Debug Readline
&gt; &gt; 
&gt; &gt; &gt; Another possiablity is the libvirt is compiled with both qemu driver and
&gt; &gt; &gt; vbox driver, but when you try to creat a new connection, vbox was the
&gt; &gt; &gt; first succesfully connected one. In this case, you can try like below:
&gt; &gt; 
&gt; &gt; Why? Ah, I do have a couple stray vbox processes somehow:
&gt; &gt; 
&gt; &gt; root       25265   0.0   0.1   86076   4304 ?            S      19:34    0:00 \
&gt; &gt; /usr/lib/virtualbox/VBoxXPCOMIPCD root       25274   0.0   0.1 209964   6672 ?    \
&gt; &gt; Sl    19:34    0:02 /usr/lib/virtualbox/VBoxSVC --pipe 4 --auto-shutdown 
&gt; &gt; But that should cause it to deny it knows how to handle Qemu/KVM?
&gt; 
&gt; The point is that libvirt autodetects the available hypervisors at
&gt; runtime when you don't specify a connection URI. For example, just
&gt; running virsh results in autodetecting VirtualBox because you have it
&gt; installed in a way that it's still working and due to the way libvirt
&gt; works internally VirtualBox comes before QEMU in the autodetection
&gt; list.
&gt; 

I think this should be changed actually. I think it's clear that there
are far more libvirt+kvm users than libvirt+vbox users, we should adjust
the driver probing to match. Unfortunately it doesn't look like a simple
change.

- Cole


</body></email><email><emailId>20110727140727</emailId><senderName>Whit Blauvelt</senderName><senderEmail>whit.virt@transpect.com</senderEmail><timestampReceived>2011-07-27 14:07:27-0400</timestampReceived><subject>Re: [libvirt-users] with current libvirt git virsh expects vbox, refuses kvm define</subject><body>

&gt; That's not how libvirt works. The architecture is different than you
&gt; seem to expect it.

Matthias,

Even with all you say - and I thank you for your patient explanation - there
remains a question: Why should 0.9.3+ git suddenly decide that the default
driver should be vbox, when 0.8.3 and 0.9.2 and 0.9.3, all on the same
system, and the second two similarly compiled with their defaults from the
tar, went to kvm instead? 

There was no other change on the system. And the vbox processes I found
appear to have been started by libvirt itself, since vbox hasn't been run on
this system in over a year, during which time it's been rebooted without
vbox being invoked at all.

If kvm is on the system as an option - which it has been all along - it
should be the libvirt default. KVM is the preferred hypervisor for all the
major distros. Having the libvirt default be a random, round robin selection
rather by ordered priority, in which kvm if available comes out on top, is
not good design.

Regards,
Whit

</body></email><email><emailId>20110727144754</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-07-27 14:47:54-0400</timestampReceived><subject>Re: [libvirt-users] with current libvirt git virsh expects vbox, refuses kvm define</subject><body>

2011/7/27 Whit Blauvelt &lt;whit.virt@transpect.com&gt;:
&gt;&gt; That's not how libvirt works. The architecture is different than you
&gt;&gt; seem to expect it.
&gt;
&gt; Matthias,
&gt;
&gt; Even with all you say - and I thank you for your patient explanation - there
&gt; remains a question: Why should 0.9.3+ git suddenly decide that the default
&gt; driver should be vbox, when 0.8.3 and 0.9.2 and 0.9.3, all on the same
&gt; system, and the second two similarly compiled with their defaults from the
&gt; tar, went to kvm instead?

First, there is no default driver and nothing should have changed in
the way drivers a selected.

The only thing that has changed in this regard is that the type
checking for the domain XML config was made stricter after 0.9.3. In
0.9.3 and before the VirtualBox driver happily accepted a domain
config with type kvm. Basically all drivers didn't check whether or
not a domain config was meant for them. Now the VirtualVtox driver
only accepts type vbox and the QEMU driver accepts type qemu, kvm,
kqemu and xen (xen for xenner).

&gt; There was no other change on the system. And the vbox processes I found
&gt; appear to have been started by libvirt itself, since vbox hasn't been run on
&gt; this system in over a year, during which time it's been rebooted without
&gt; vbox being invoked at all.

I currently have no explanation for why libvirt 0.9.3+ picks
VirtualBox for you now when it autoselected QEMU before.

Are you sure that libvirt 0.9.3 and before had VirtualBox support
compiled in? If not then VirtualBox can not supersede QEMU in the
autodetection. That might explain it, but I don't see how that can
happen apart from you explicitly disabling VirtualBox support at
configure time.

&gt; If kvm is on the system as an option - which it has been all along - it
&gt; should be the libvirt default. KVM is the preferred hypervisor for all the
&gt; major distros. Having the libvirt default be a random, round robin selection
&gt; rather by ordered priority, in which kvm if available comes out on top, is
&gt; not good design.

You're right the autodetection process is suboptimal and should be improved.

But the selection is not random, the problem is that VirtualBox comes
before QEMU in the probing order. This is due to how the remote driver
interferes with the detection process.

-- 
Matthias Bolte
http://photron.blogspot.com

</body></email><email><emailId>20110727145145</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-07-27 14:51:45-0400</timestampReceived><subject>Re: [libvirt-users] with current libvirt git virsh expects vbox, refuses kvm define</subject><body>

2011/7/27 Cole Robinson &lt;crobinso@redhat.com&gt;:
&gt; On 07/27/2011 03:21 AM, Matthias Bolte wrote:
&gt; &gt; 2011/7/27 Whit Blauvelt &lt;whit.virt@transpect.com&gt;:
&gt; &gt; &gt; &gt; What's the output of "# virsh -V" on your second ubuntu box? I guess
&gt; &gt; &gt; &gt; your libvirt on that box might not be compiled with qemu driver.
&gt; &gt; &gt; 
&gt; &gt; &gt; # virsh -V
&gt; &gt; &gt; Virsh command line tool of libvirt 0.9.3 ...
&gt; &gt; &gt; 
&gt; &gt; &gt; Compiled with support for:
&gt; &gt; &gt; Hypervisors: QEmu/KVM UML OpenVZ VirtualBox LXC ESX Test
&gt; &gt; &gt; Networking: Remote Daemon Network Bridging Nwfilter VirtualPort
&gt; &gt; &gt; Storage: Dir Filesystem SCSI Multipath LVM
&gt; &gt; &gt; Miscellaneous: SELinux Secrets Debug Readline
&gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Another possiablity is the libvirt is compiled with both qemu driver and
&gt; &gt; &gt; &gt; vbox driver, but when you try to creat a new connection, vbox was the
&gt; &gt; &gt; &gt; first succesfully connected one. In this case, you can try like below:
&gt; &gt; &gt; 
&gt; &gt; &gt; Why? Ah, I do have a couple stray vbox processes somehow:
&gt; &gt; &gt; 
&gt; &gt; &gt; root       25265   0.0   0.1   86076   4304 ?            S      19:34    0:00 \
&gt; &gt; &gt; /usr/lib/virtualbox/VBoxXPCOMIPCD root       25274   0.0   0.1 209964   6672 ?  \
&gt; &gt; &gt; Sl    19:34    0:02 /usr/lib/virtualbox/VBoxSVC --pipe 4 --auto-shutdown 
&gt; &gt; &gt; But that should cause it to deny it knows how to handle Qemu/KVM?
&gt; &gt; 
&gt; &gt; The point is that libvirt autodetects the available hypervisors at
&gt; &gt; runtime when you don't specify a connection URI. For example, just
&gt; &gt; running virsh results in autodetecting VirtualBox because you have it
&gt; &gt; installed in a way that it's still working and due to the way libvirt
&gt; &gt; works internally VirtualBox comes before QEMU in the autodetection
&gt; &gt; list.
&gt; &gt; 
&gt; 
&gt; I think this should be changed actually. I think it's clear that there
&gt; are far more libvirt+kvm users than libvirt+vbox users, we should adjust
&gt; the driver probing to match. Unfortunately it doesn't look like a simple
&gt; change.

Sure, the problem is that QEMU goes through the remote driver (because
it's a daemon/stateful driver) and that one is last in the local
probing list. I don't currently see how we can give QEMU a higher
position in the list, except by special casing it in the probing
process.

-- 
Matthias Bolte
http://photron.blogspot.com


</body></email><email><emailId>20110727145644</emailId><senderName>Whit Blauvelt</senderName><senderEmail>whit.virt@transpect.com</senderEmail><timestampReceived>2011-07-27 14:56:44-0400</timestampReceived><subject>Re: [libvirt-users] with current libvirt git virsh expects vbox, refuses kvm define</subject><body>

&gt; Are you sure that libvirt 0.9.3 and before had VirtualBox support
&gt; compiled in? If not then VirtualBox can not supersede QEMU in the
&gt; autodetection. That might explain it, but I don't see how that can
&gt; happen apart from you explicitly disabling VirtualBox support at
&gt; configure time.

libvirt 0.9.3:

configure:57866: Drivers
configure:57868: 
configure:57870:      Xen: no
configure:57872:     QEMU: yes
configure:57874:      UML: yes
configure:57876:   OpenVZ: yes
configure:57878:   VMware: yes
configure:57880:     VBox: yes
configure:57882:   XenAPI: no
configure:57884: xenlight: no
configure:57886:      LXC: yes
configure:57888:     PHYP: no
configure:57890:      ESX: no
configure:57892:     Test: yes
configure:57894:   Remote: yes
configure:57896:  Network: yes
configure:57898: Libvirtd: yes
configure:57900:    netcf: no                             
configure:57902:  macvtap: yes
configure:57904: virtport: yes

libvirt 0.9.3 + git (yesterday's)

configure:58371: Drivers
configure:58373: 
configure:58375:      Xen: no
configure:58377:     QEMU: yes
configure:58379:      UML: yes
configure:58381:   OpenVZ: yes
configure:58383:   VMware: yes
configure:58385:     VBox: yes
configure:58387:   XenAPI: no
configure:58389: xenlight: no
configure:58391:      LXC: yes
configure:58393:     PHYP: no
configure:58395:      ESX: yes
configure:58397:     Test: yes
configure:58399:   Remote: yes
configure:58401:  Network: yes
configure:58403: Libvirtd: yes
configure:58405:    netcf: no 
configure:58407:  macvtap: yes
configure:58409: virtport: yes

(Hmm. Picked up ESX meanwhile.)

Best,
Whit

</body></email><email><emailId>20110615133335</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-06-15 13:33:35-0400</timestampReceived><subject>Re: [libvirt-users] Is libvirt supported on Citrix Xenserver?</subject><body>

2011/6/15 G Naresh Kumar &lt;naresh.gadepalli@gmail.com&gt;:
&gt; Hi,
&gt; Is libvirt supported on Citrix Xenserver. I have been searching for the same
&gt; with little/no luck.
&gt; If supported, can you point to some links/documents which can help me try
&gt; out the same.
&gt; Thanks,
&gt; Naresh

libvirt can use XenAPI via libxenserver [1]. That should allow you to
use libvirt with a Citrix XenServer. You can use virsh like this
assuming you have a libxenserver enabled libvirt:

  virsh -c xenapi://my-xen-server

But it's true, there is no documentation about this on the libvirt website yet.

[1] http://community.citrix.com/display/xs/Download+SDKs

-- 
Matthias Bolte
http://photron.blogspot.com

</body></email><email><emailId>20110615142156</emailId><senderName>G Naresh Kumar</senderName><senderEmail>naresh.gadepalli@gmail.com</senderEmail><timestampReceived>2011-06-15 14:21:56-0400</timestampReceived><subject>Re: [libvirt-users] Is libvirt supported on Citrix Xenserver?</subject><body>

Hi Maththias,

Thanks a lot for your response!.

Is there a specific version of libvirt from which xenserver support is
added? I am getting the below error

"error: invalid argument in libvirt was built without the 'xenapi' driver"

I have installed libvirt from citrix yum repo.

I am using Xenserver 5.5 with libvirt 0.8.2 and it does not seem to be
working.

Thanks,

Naresh
On Jun 15, 2011 7:03 PM, "Matthias Bolte" &lt;matthias.bolte@googlemail.com&gt;
wrote:
&gt; 2011/6/15 G Naresh Kumar &lt;naresh.gadepalli@gmail.com&gt;:
&gt;&gt; Hi,
&gt;&gt; Is libvirt supported on Citrix Xenserver. I have been searching for the
same
&gt;&gt; with little/no luck.
&gt;&gt; If supported, can you point to some links/documents which can help me try
&gt;&gt; out the same.
&gt;&gt; Thanks,
&gt;&gt; Naresh
&gt;
&gt; libvirt can use XenAPI via libxenserver [1]. That should allow you to
&gt; use libvirt with a Citrix XenServer. You can use virsh like this
&gt; assuming you have a libxenserver enabled libvirt:
&gt;
&gt; virsh -c xenapi://my-xen-server
&gt;
&gt; But it's true, there is no documentation about this on the libvirt website
yet.
&gt;
&gt; [1] http://community.citrix.com/display/xs/Download+SDKs
&gt;
&gt; --
&gt; Matthias Bolte
&gt; http://photron.blogspot.com

[Attachment #3 (text/html)]

&lt;p&gt;Hi Maththias,&lt;/p&gt;&lt;p&gt;Thanks a lot for your response!.&lt;/p&gt;&lt;p&gt;Is there a specific \
version of libvirt from which xenserver support is added? I am getting the below \
error&lt;/p&gt;&lt;p&gt;"error: invalid argument in libvirt was built without the \
'xenapi' driver"&lt;/p&gt;

&lt;p&gt;I have installed libvirt from citrix yum repo.&lt;/p&gt;&lt;p&gt;I am using Xenserver 5.5 with \
libvirt 0.8.2 and it does not seem to be working.&lt;/p&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;p&gt;Naresh&lt;/p&gt; &lt;div \
class="gmail_quote"&gt;On Jun 15, 2011 7:03 PM, "Matthias Bolte" &lt;&lt;a \
href="mailto:matthias.bolte@googlemail.com" \
target="_blank"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt; wrote:&lt;br \
type="attribution"&gt;&gt; 2011/6/15 G Naresh Kumar &lt;&lt;a \
href="mailto:naresh.gadepalli@gmail.com" \
target="_blank"&gt;naresh.gadepalli@gmail.com&lt;/a&gt;&gt;:&lt;br&gt;


&gt;&gt; Hi,&lt;br&gt;&gt;&gt; Is libvirt supported on Citrix Xenserver. I have been \
searching for the same&lt;br&gt;&gt;&gt; with little/no luck.&lt;br&gt;&gt;&gt; If supported, can \
you point to some links/documents which can help me try&lt;br&gt;


&gt;&gt; out the same.&lt;br&gt;&gt;&gt; Thanks,&lt;br&gt;&gt;&gt; Naresh&lt;br&gt;&gt; &lt;br&gt;&gt; \
libvirt can use XenAPI via libxenserver [1]. That should allow you to&lt;br&gt;&gt; use \
libvirt with a Citrix XenServer. You can use virsh like this&lt;br&gt;


&gt; assuming you have a libxenserver enabled libvirt:&lt;br&gt;&gt; &lt;br&gt;&gt;   virsh -c \
xenapi://my-xen-server&lt;br&gt;&gt; &lt;br&gt;&gt; But it's true, there is no documentation \
about this on the libvirt website yet.&lt;br&gt;&gt; &lt;br&gt;&gt; [1] &lt;a \
href="http://community.citrix.com/display/xs/Download+SDKs" \
target="_blank"&gt;http://community.citrix.com/display/xs/Download+SDKs&lt;/a&gt;&lt;br&gt;


&gt; &lt;br&gt;&gt; -- &lt;br&gt;&gt; Matthias Bolte&lt;br&gt;&gt; &lt;a \
href="http://photron.blogspot.com" \
target="_blank"&gt;http://photron.blogspot.com&lt;/a&gt;&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20110714123301</emailId><senderName>G Naresh Kumar</senderName><senderEmail>naresh.gadepalli@gmail.com</senderEmail><timestampReceived>2011-07-14 12:33:01-0400</timestampReceived><subject>Re: [libvirt-users] Is libvirt supported on Citrix Xenserver?</subject><body>

Hi Maththias,

Thanks for the help. I finally was able to compile/install libvirt on
xenserver.

I tried compiling the libvirt 0.9.2 with xen api support. Was able to
install it successfully. When I tried giving the virsh command, I got an
‘authentication failed’ error as shown below.



# virsh -c xenapi://&lt;my local ip&gt;

Enter username for &lt;mylocalip&gt;: root

Enter intel123's password for &lt;my local ip&gt;:

error: authentication failed: (null)



I also tried connecting to the local machine as below,



virsh -c "xenapi:///"

error: authentication failed: Server name not in URI

error: failed to connect to the hypervisor





What am I missing here?



Also I am trying to install ruby-libvirt on xenserver, which looks like
requires libvirt-devel package to be installed. How do I build it from the
libvirt 0.9.2 source package.


Thanks,

Naresh

On Wed, Jun 15, 2011 at 8:19 PM, Matthias Bolte &lt;
matthias.bolte@googlemail.com&gt; wrote:

&gt; 2011/6/15 G Naresh Kumar &lt;naresh.gadepalli@gmail.com&gt;:
&gt; &gt; Hi Maththias,
&gt; &gt;
&gt; &gt; Thanks a lot for your response!.
&gt; &gt;
&gt; &gt; Is there a specific version of libvirt from which xenserver support is
&gt; &gt; added? I am getting the below error
&gt; &gt;
&gt; &gt; "error: invalid argument in libvirt was built without the 'xenapi'
&gt; driver"
&gt;
&gt; The means that your libvirt version is new enough and contains the
&gt; XenAPI driver but that it was disabled on configure time, probably
&gt; because the build server didn't have libxenserver installed and
&gt; libvirt's configure script automatically disabled the driver because
&gt; of a missing dependency.
&gt;
&gt; &gt; I have installed libvirt from citrix yum repo.
&gt;
&gt; Then Citrix build libvirt without XenAPI support. As a long term
&gt; solution you could report to whom ever is responsible for that repo
&gt; and request to enabled XenAPI support in that libvirt package. As a
&gt; short term solution you could build libvirt from source yourself and
&gt; make sure to get the XenAPI driver enabled.
&gt;
&gt; &gt; I am using Xenserver 5.5 with libvirt 0.8.2 and it does not seem to be
&gt; &gt; working.
&gt;
&gt; According to http://libvirt.org/hvsupport.html and the error message
&gt; 0.8.2 is new enough.
&gt;
&gt; Matthias
&gt;
&gt; &gt; Thanks,
&gt; &gt;
&gt; &gt; Naresh
&gt; &gt;
&gt; &gt; On Jun 15, 2011 7:03 PM, "Matthias Bolte" &lt;matthias.bolte@googlemail.com
&gt; &gt;
&gt; &gt; wrote:
&gt; &gt;&gt; 2011/6/15 G Naresh Kumar &lt;naresh.gadepalli@gmail.com&gt;:
&gt; &gt;&gt;&gt; Hi,
&gt; &gt;&gt;&gt; Is libvirt supported on Citrix Xenserver. I have been searching for the
&gt; &gt;&gt;&gt; same
&gt; &gt;&gt;&gt; with little/no luck.
&gt; &gt;&gt;&gt; If supported, can you point to some links/documents which can help me
&gt; try
&gt; &gt;&gt;&gt; out the same.
&gt; &gt;&gt;&gt; Thanks,
&gt; &gt;&gt;&gt; Naresh
&gt; &gt;&gt;
&gt; &gt;&gt; libvirt can use XenAPI via libxenserver [1]. That should allow you to
&gt; &gt;&gt; use libvirt with a Citrix XenServer. You can use virsh like this
&gt; &gt;&gt; assuming you have a libxenserver enabled libvirt:
&gt; &gt;&gt;
&gt; &gt;&gt; virsh -c xenapi://my-xen-server
&gt; &gt;&gt;
&gt; &gt;&gt; But it's true, there is no documentation about this on the libvirt
&gt; website
&gt; &gt;&gt; yet.
&gt; &gt;&gt;
&gt; &gt;&gt; [1] http://community.citrix.com/display/xs/Download+SDKs
&gt; &gt;&gt;
&gt; &gt;&gt; --
&gt; &gt;&gt; Matthias Bolte
&gt; &gt;&gt; http://photron.blogspot.com
&gt; &gt;
&gt;



-- 
I was an atheist till I realized I am GOD

[Attachment #3 (text/html)]

Hi Maththias,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks for the help. I finally was able to \
compile/install libvirt on xenserver.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;

&lt;p class="MsoNormal"&gt;I tried compiling the libvirt 0.9.2 with xen api support.
Was able to install it successfully. When I tried giving the virsh command, I
got an ‘authentication failed’ error as shown below. &lt;/p&gt;

&lt;p class="MsoNormal"&gt; &lt;/p&gt;

&lt;p class="MsoNormal"&gt;# virsh -c xenapi://&lt;my local ip&gt;&lt;/p&gt;

&lt;p class="MsoNormal"&gt;Enter username for &lt;mylocalip&gt;: root&lt;/p&gt;

&lt;p class="MsoNormal"&gt;Enter intel123's password for &lt;my local ip&gt;: &lt;/p&gt;

&lt;p class="MsoNormal"&gt;error: authentication failed: (null)&lt;/p&gt;

&lt;p class="MsoNormal"&gt; &lt;/p&gt;

&lt;p class="MsoNormal"&gt;I also tried connecting to the local machine as below,&lt;/p&gt;

&lt;p class="MsoNormal"&gt; &lt;/p&gt;

&lt;p class="MsoNormal"&gt;virsh -c
"xenapi:///"                         
&lt;/p&gt;

&lt;p class="MsoNormal"&gt;error: authentication failed: Server name not in URI&lt;/p&gt;

&lt;p class="MsoNormal"&gt;error: failed to connect to the hypervisor&lt;/p&gt;

&lt;p class="MsoNormal"&gt; &lt;/p&gt;

&lt;p class="MsoNormal"&gt; &lt;/p&gt;

&lt;p class="MsoNormal"&gt;What am I missing here?&lt;/p&gt;

&lt;p class="MsoNormal"&gt; &lt;/p&gt;

&lt;p class="MsoNormal"&gt;Also I am trying to install ruby-libvirt on xenserver, which \
looks like requires libvirt-devel package to be installed. How do I build it from the \
libvirt 0.9.2 source package.&lt;/p&gt;&lt;p class="MsoNormal"&gt;&lt;br&gt;&lt;/p&gt;&lt;p \
class="MsoNormal"&gt;Thanks,&lt;/p&gt;&lt;p class="MsoNormal"&gt;Naresh&lt;/p&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;On Wed, Jun 15, 2011 at 8:19 PM, Matthias Bolte &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;

&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt;&lt;div class="im"&gt;2011/6/15 G Naresh Kumar &lt;&lt;a \
href="mailto:naresh.gadepalli@gmail.com"&gt;naresh.gadepalli@gmail.com&lt;/a&gt;&gt;:&lt;br&gt;


&lt;/div&gt;&lt;div class="im"&gt;&gt; Hi Maththias,&lt;br&gt;
&gt;&lt;br&gt;
&gt; Thanks a lot for your response!.&lt;br&gt;
&gt;&lt;br&gt;
&gt; Is there a specific version of libvirt from which xenserver support is&lt;br&gt;
&gt; added? I am getting the below error&lt;br&gt;
&gt;&lt;br&gt;
&gt; "error: invalid argument in libvirt was built without the 'xenapi' \
driver"&lt;br&gt; &lt;br&gt;
&lt;/div&gt;The means that your libvirt version is new enough and contains the&lt;br&gt;
XenAPI driver but that it was disabled on configure time, probably&lt;br&gt;
because the build server didn't have libxenserver installed and&lt;br&gt;
libvirt's configure script automatically disabled the driver because&lt;br&gt;
of a missing dependency.&lt;br&gt;
&lt;div class="im"&gt;&lt;br&gt;
&gt; I have installed libvirt from citrix yum repo.&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;Then Citrix build libvirt without XenAPI support. As a long term&lt;br&gt;
solution you could report to whom ever is responsible for that repo&lt;br&gt;
and request to enabled XenAPI support in that libvirt package. As a&lt;br&gt;
short term solution you could build libvirt from source yourself and&lt;br&gt;
make sure to get the XenAPI driver enabled.&lt;br&gt;
&lt;div class="im"&gt;&lt;br&gt;
&gt; I am using Xenserver 5.5 with libvirt 0.8.2 and it does not seem to be&lt;br&gt;
&gt; working.&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;According to &lt;a href="http://libvirt.org/hvsupport.html" \
target="_blank"&gt;http://libvirt.org/hvsupport.html&lt;/a&gt; and the error message&lt;br&gt; 0.8.2 \
is new enough.&lt;br&gt; &lt;font color="#888888"&gt;&lt;br&gt;
Matthias&lt;br&gt;
&lt;/font&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;&lt;br&gt;
&gt; Thanks,&lt;br&gt;
&gt;&lt;br&gt;
&gt; Naresh&lt;br&gt;
&gt;&lt;br&gt;
&gt; On Jun 15, 2011 7:03 PM, "Matthias Bolte" &lt;&lt;a \
href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;&lt;br&gt; \
&gt; wrote:&lt;br&gt; &gt;&gt; 2011/6/15 G Naresh Kumar &lt;&lt;a \
href="mailto:naresh.gadepalli@gmail.com"&gt;naresh.gadepalli@gmail.com&lt;/a&gt;&gt;:&lt;br&gt; \
&gt;&gt;&gt; Hi,&lt;br&gt; &gt;&gt;&gt; Is libvirt supported on Citrix Xenserver. I have \
been searching for the&lt;br&gt; &gt;&gt;&gt; same&lt;br&gt;
&gt;&gt;&gt; with little/no luck.&lt;br&gt;
&gt;&gt;&gt; If supported, can you point to some links/documents which can help me \
try&lt;br&gt; &gt;&gt;&gt; out the same.&lt;br&gt;
&gt;&gt;&gt; Thanks,&lt;br&gt;
&gt;&gt;&gt; Naresh&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; libvirt can use XenAPI via libxenserver [1]. That should allow you to&lt;br&gt;
&gt;&gt; use libvirt with a Citrix XenServer. You can use virsh like this&lt;br&gt;
&gt;&gt; assuming you have a libxenserver enabled libvirt:&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; virsh -c xenapi://my-xen-server&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; But it's true, there is no documentation about this on the libvirt \
website&lt;br&gt; &gt;&gt; yet.&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; [1] &lt;a href="http://community.citrix.com/display/xs/Download+SDKs" \
target="_blank"&gt;http://community.citrix.com/display/xs/Download+SDKs&lt;/a&gt;&lt;br&gt; \
&gt;&gt;&lt;br&gt; &gt;&gt; --&lt;br&gt;
&gt;&gt; Matthias Bolte&lt;br&gt;
&gt;&gt; &lt;a href="http://photron.blogspot.com" \
target="_blank"&gt;http://photron.blogspot.com&lt;/a&gt;&lt;br&gt; &gt;&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;I was an atheist till I \
realized I am GOD&lt;br&gt; &lt;/div&gt;



</body></email><email><emailId>20110714133729</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-07-14 13:37:29-0400</timestampReceived><subject>Re: [libvirt-users] Is libvirt supported on Citrix Xenserver?</subject><body>

2011/7/14 G Naresh Kumar &lt;naresh.gadepalli@gmail.com&gt;:
&gt; Hi Maththias,
&gt; Thanks for the help. I finally was able to compile/install libvirt on
&gt; xenserver.
&gt;
&gt; I tried compiling the libvirt 0.9.2 with xen api support. Was able to
&gt; install it successfully. When I tried giving the virsh command, I got an
&gt; ‘authentication failed' error as shown below.
&gt;
&gt; # virsh -c xenapi://&lt;my local ip&gt;
&gt; Enter username for &lt;mylocalip&gt;: root

Here you entered root

&gt; Enter intel123's password for &lt;my local ip&gt;:

but here it asks for intel123's, that's unexpected. Did you edit this
one before mailing it, or is there really this mismatch?

&gt; error: authentication failed: (null)

Outputting (null) here is actually a bug. The only way this can happen
is when the login attempt fails but the XenServer doesn't provide an
error message. Maybe have a look at the XenServer logs to see if it
says something about a failed login attempt.

&gt; I also tried connecting to the local machine as below,
&gt;
&gt; virsh -c "xenapi:///"
&gt; error: authentication failed: Server name not in URI
&gt; error: failed to connect to the hypervisor

The XenAPI driver expects a server name. xenapi:/// _could_ be treated
as xenapi://localhost, but it's not implemented that way.

&gt; Also I am trying to install ruby-libvirt on xenserver, which looks like
&gt; requires libvirt-devel package to be installed. How do I build it from the
&gt; libvirt 0.9.2 source package.

Running 'make rpm' should build an libvirt-devel RPM package for you.

&gt; Thanks,
&gt;
&gt; Naresh
&gt;
&gt; On Wed, Jun 15, 2011 at 8:19 PM, Matthias Bolte
&gt; &lt;matthias.bolte@googlemail.com&gt; wrote:
&gt;&gt;
&gt;&gt; 2011/6/15 G Naresh Kumar &lt;naresh.gadepalli@gmail.com&gt;:
&gt;&gt; &gt; Hi Maththias,
&gt;&gt; &gt;
&gt;&gt; &gt; Thanks a lot for your response!.
&gt;&gt; &gt;
&gt;&gt; &gt; Is there a specific version of libvirt from which xenserver support is
&gt;&gt; &gt; added? I am getting the below error
&gt;&gt; &gt;
&gt;&gt; &gt; "error: invalid argument in libvirt was built without the 'xenapi'
&gt;&gt; &gt; driver"
&gt;&gt;
&gt;&gt; The means that your libvirt version is new enough and contains the
&gt;&gt; XenAPI driver but that it was disabled on configure time, probably
&gt;&gt; because the build server didn't have libxenserver installed and
&gt;&gt; libvirt's configure script automatically disabled the driver because
&gt;&gt; of a missing dependency.
&gt;&gt;
&gt;&gt; &gt; I have installed libvirt from citrix yum repo.
&gt;&gt;
&gt;&gt; Then Citrix build libvirt without XenAPI support. As a long term
&gt;&gt; solution you could report to whom ever is responsible for that repo
&gt;&gt; and request to enabled XenAPI support in that libvirt package. As a
&gt;&gt; short term solution you could build libvirt from source yourself and
&gt;&gt; make sure to get the XenAPI driver enabled.
&gt;&gt;
&gt;&gt; &gt; I am using Xenserver 5.5 with libvirt 0.8.2 and it does not seem to be
&gt;&gt; &gt; working.
&gt;&gt;
&gt;&gt; According to http://libvirt.org/hvsupport.html and the error message
&gt;&gt; 0.8.2 is new enough.
&gt;&gt;
&gt;&gt; Matthias
&gt;&gt;
&gt;&gt; &gt; Thanks,
&gt;&gt; &gt;
&gt;&gt; &gt; Naresh
&gt;&gt; &gt;
&gt;&gt; &gt; On Jun 15, 2011 7:03 PM, "Matthias Bolte"
&gt;&gt; &gt; &lt;matthias.bolte@googlemail.com&gt;
&gt;&gt; &gt; wrote:
&gt;&gt; &gt;&gt; 2011/6/15 G Naresh Kumar &lt;naresh.gadepalli@gmail.com&gt;:
&gt;&gt; &gt;&gt;&gt; Hi,
&gt;&gt; &gt;&gt;&gt; Is libvirt supported on Citrix Xenserver. I have been searching for
&gt;&gt; &gt;&gt;&gt; the
&gt;&gt; &gt;&gt;&gt; same
&gt;&gt; &gt;&gt;&gt; with little/no luck.
&gt;&gt; &gt;&gt;&gt; If supported, can you point to some links/documents which can help me
&gt;&gt; &gt;&gt;&gt; try
&gt;&gt; &gt;&gt;&gt; out the same.
&gt;&gt; &gt;&gt;&gt; Thanks,
&gt;&gt; &gt;&gt;&gt; Naresh
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; libvirt can use XenAPI via libxenserver [1]. That should allow you to
&gt;&gt; &gt;&gt; use libvirt with a Citrix XenServer. You can use virsh like this
&gt;&gt; &gt;&gt; assuming you have a libxenserver enabled libvirt:
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; virsh -c xenapi://my-xen-server
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; But it's true, there is no documentation about this on the libvirt
&gt;&gt; &gt;&gt; website
&gt;&gt; &gt;&gt; yet.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; [1] http://community.citrix.com/display/xs/Download+SDKs
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; --
&gt;&gt; &gt;&gt; Matthias Bolte
&gt;&gt; &gt;&gt; http://photron.blogspot.com
&gt;&gt; &gt;
&gt; --
&gt; I was an atheist till I realized I am GOD
&gt;

-- 
Matthias Bolte
http://photron.blogspot.com

</body></email><email><emailId>20110716113033</emailId><senderName>G Naresh Kumar</senderName><senderEmail>naresh.gadepalli@gmail.com</senderEmail><timestampReceived>2011-07-16 11:30:33-0400</timestampReceived><subject>Re: [libvirt-users] Is libvirt supported on Citrix Xenserver?</subject><body>

Hi Matthias,



Sorry for the confusion.It was an edited one &amp; hence the typo. Below is the

actual output:



# virsh -c xenapi://&lt;myip&gt;

Enter username for &lt;myip&gt;: root

Enter root's password for &lt;myip&gt;:

error: authentication failed: (null)



I was not able to get anything in the Xen logs. Somehow figured out to print


the Xen error using the patch given at the link http://osdir.com/ml/libvir-

list/2011-06/msg00298.html. It prints "TRANSPORT_FAULT". Any pointers to
this

error would be much appreciated. Iam also trying to debug this issue.



As per your suggestion,

I had used make rpm. But it requires xen-devel pacakge, which I was

not able to get for Xen 3.4.2. Is there any way where I can use the source

package and build &amp; install the library without using 'make rpm' ?



Thanks for all the help.


Regards

Naresh

On Thu, Jul 14, 2011 at 7:07 PM, Matthias Bolte &lt;
matthias.bolte@googlemail.com&gt; wrote:

&gt; 2011/7/14 G Naresh Kumar &lt;naresh.gadepalli@gmail.com&gt;:
&gt; &gt; Hi Maththias,
&gt; &gt; Thanks for the help. I finally was able to compile/install libvirt on
&gt; &gt; xenserver.
&gt; &gt;
&gt; &gt; I tried compiling the libvirt 0.9.2 with xen api support. Was able to
&gt; &gt; install it successfully. When I tried giving the virsh command, I got an
&gt; &gt; ‘authentication failed’ error as shown below.
&gt; &gt;
&gt; &gt; # virsh -c xenapi://&lt;my local ip&gt;
&gt; &gt; Enter username for &lt;mylocalip&gt;: root
&gt;
&gt; Here you entered root
&gt;
&gt; &gt; Enter intel123's password for &lt;my local ip&gt;:
&gt;
&gt; but here it asks for intel123's, that's unexpected. Did you edit this
&gt; one before mailing it, or is there really this mismatch?
&gt;
&gt; &gt; error: authentication failed: (null)
&gt;
&gt; Outputting (null) here is actually a bug. The only way this can happen
&gt; is when the login attempt fails but the XenServer doesn't provide an
&gt; error message. Maybe have a look at the XenServer logs to see if it
&gt; says something about a failed login attempt.
&gt;
&gt; &gt; I also tried connecting to the local machine as below,
&gt; &gt;
&gt; &gt; virsh -c "xenapi:///"
&gt; &gt; error: authentication failed: Server name not in URI
&gt; &gt; error: failed to connect to the hypervisor
&gt;
&gt; The XenAPI driver expects a server name. xenapi:/// _could_ be treated
&gt; as xenapi://localhost, but it's not implemented that way.
&gt;
&gt; &gt; Also I am trying to install ruby-libvirt on xenserver, which looks like
&gt; &gt; requires libvirt-devel package to be installed. How do I build it from
&gt; the
&gt; &gt; libvirt 0.9.2 source package.
&gt;
&gt; Running 'make rpm' should build an libvirt-devel RPM package for you.
&gt;
&gt; &gt; Thanks,
&gt; &gt;
&gt; &gt; Naresh
&gt; &gt;
&gt; &gt; On Wed, Jun 15, 2011 at 8:19 PM, Matthias Bolte
&gt; &gt; &lt;matthias.bolte@googlemail.com&gt; wrote:
&gt; &gt;&gt;
&gt; &gt;&gt; 2011/6/15 G Naresh Kumar &lt;naresh.gadepalli@gmail.com&gt;:
&gt; &gt;&gt; &gt; Hi Maththias,
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; Thanks a lot for your response!.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; Is there a specific version of libvirt from which xenserver support is
&gt; &gt;&gt; &gt; added? I am getting the below error
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; "error: invalid argument in libvirt was built without the 'xenapi'
&gt; &gt;&gt; &gt; driver"
&gt; &gt;&gt;
&gt; &gt;&gt; The means that your libvirt version is new enough and contains the
&gt; &gt;&gt; XenAPI driver but that it was disabled on configure time, probably
&gt; &gt;&gt; because the build server didn't have libxenserver installed and
&gt; &gt;&gt; libvirt's configure script automatically disabled the driver because
&gt; &gt;&gt; of a missing dependency.
&gt; &gt;&gt;
&gt; &gt;&gt; &gt; I have installed libvirt from citrix yum repo.
&gt; &gt;&gt;
&gt; &gt;&gt; Then Citrix build libvirt without XenAPI support. As a long term
&gt; &gt;&gt; solution you could report to whom ever is responsible for that repo
&gt; &gt;&gt; and request to enabled XenAPI support in that libvirt package. As a
&gt; &gt;&gt; short term solution you could build libvirt from source yourself and
&gt; &gt;&gt; make sure to get the XenAPI driver enabled.
&gt; &gt;&gt;
&gt; &gt;&gt; &gt; I am using Xenserver 5.5 with libvirt 0.8.2 and it does not seem to be
&gt; &gt;&gt; &gt; working.
&gt; &gt;&gt;
&gt; &gt;&gt; According to http://libvirt.org/hvsupport.html and the error message
&gt; &gt;&gt; 0.8.2 is new enough.
&gt; &gt;&gt;
&gt; &gt;&gt; Matthias
&gt; &gt;&gt;
&gt; &gt;&gt; &gt; Thanks,
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; Naresh
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; On Jun 15, 2011 7:03 PM, "Matthias Bolte"
&gt; &gt;&gt; &gt; &lt;matthias.bolte@googlemail.com&gt;
&gt; &gt;&gt; &gt; wrote:
&gt; &gt;&gt; &gt;&gt; 2011/6/15 G Naresh Kumar &lt;naresh.gadepalli@gmail.com&gt;:
&gt; &gt;&gt; &gt;&gt;&gt; Hi,
&gt; &gt;&gt; &gt;&gt;&gt; Is libvirt supported on Citrix Xenserver. I have been searching for
&gt; &gt;&gt; &gt;&gt;&gt; the
&gt; &gt;&gt; &gt;&gt;&gt; same
&gt; &gt;&gt; &gt;&gt;&gt; with little/no luck.
&gt; &gt;&gt; &gt;&gt;&gt; If supported, can you point to some links/documents which can help
&gt; me
&gt; &gt;&gt; &gt;&gt;&gt; try
&gt; &gt;&gt; &gt;&gt;&gt; out the same.
&gt; &gt;&gt; &gt;&gt;&gt; Thanks,
&gt; &gt;&gt; &gt;&gt;&gt; Naresh
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; libvirt can use XenAPI via libxenserver [1]. That should allow you to
&gt; &gt;&gt; &gt;&gt; use libvirt with a Citrix XenServer. You can use virsh like this
&gt; &gt;&gt; &gt;&gt; assuming you have a libxenserver enabled libvirt:
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; virsh -c xenapi://my-xen-server
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; But it's true, there is no documentation about this on the libvirt
&gt; &gt;&gt; &gt;&gt; website
&gt; &gt;&gt; &gt;&gt; yet.
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; [1] http://community.citrix.com/display/xs/Download+SDKs
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; --
&gt; &gt;&gt; &gt;&gt; Matthias Bolte
&gt; &gt;&gt; &gt;&gt; http://photron.blogspot.com
&gt; &gt;&gt; &gt;
&gt; &gt; --
&gt; &gt; I was an atheist till I realized I am GOD
&gt; &gt;
&gt;
&gt; --
&gt; Matthias Bolte
&gt; http://photron.blogspot.com
&gt;



-- 
I was an atheist till I realized I am GOD

[Attachment #3 (text/html)]

Hi Matthias,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;p class="MsoNormal"&gt; &lt;/p&gt;

&lt;p class="MsoNormal"&gt;Sorry for the confusion.It was an edited one &amp; hence the
typo. Below is the &lt;/p&gt;

&lt;p class="MsoNormal"&gt;actual output:&lt;/p&gt;

&lt;p class="MsoNormal"&gt; &lt;/p&gt;

&lt;p class="MsoNormal"&gt;# virsh -c xenapi://&lt;myip&gt;&lt;/p&gt;

&lt;p class="MsoNormal"&gt;Enter username for &lt;myip&gt;: root&lt;/p&gt;

&lt;p class="MsoNormal"&gt;Enter root's password for &lt;myip&gt;: &lt;/p&gt;

&lt;p class="MsoNormal"&gt;error: authentication failed: (null)&lt;/p&gt;

&lt;p class="MsoNormal"&gt; &lt;/p&gt;

&lt;p class="MsoNormal"&gt;I was not able to get anything in the Xen logs. Somehow
figured out to print &lt;/p&gt;

&lt;p class="MsoNormal"&gt;the Xen error using the patch given at the link &lt;a \
href="http://osdir.com/ml/libvir-"&gt;http://osdir.com/ml/libvir-&lt;/a&gt;&lt;/p&gt;

&lt;p class="MsoNormal"&gt;list/2011-06/msg00298.html. It prints
"TRANSPORT_FAULT". Any pointers to this &lt;/p&gt;

&lt;p class="MsoNormal"&gt;error would be much appreciated. Iam also trying to debug
this issue.&lt;/p&gt;

&lt;p class="MsoNormal"&gt; &lt;/p&gt;

&lt;p class="MsoNormal"&gt;As per your suggestion,&lt;/p&gt;

&lt;p class="MsoNormal"&gt;I had used make rpm. But it requires xen-devel pacakge,
which I was &lt;/p&gt;

&lt;p class="MsoNormal"&gt;not able to get for Xen 3.4.2. Is there any way where I can
use the source &lt;/p&gt;

&lt;p class="MsoNormal"&gt;package and build &amp; install the library without using
'make rpm' ? &lt;/p&gt;

&lt;p class="MsoNormal"&gt; &lt;/p&gt;

&lt;p class="MsoNormal"&gt;Thanks for all the help.&lt;/p&gt;&lt;p class="MsoNormal"&gt;&lt;br&gt;&lt;/p&gt;&lt;p \
class="MsoNormal"&gt;Regards&lt;/p&gt;&lt;p class="MsoNormal"&gt;Naresh&lt;/p&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;On Thu, Jul 14, 2011 at 7:07 PM, Matthias Bolte &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;

&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt;2011/7/14 G Naresh Kumar &lt;&lt;a \
href="mailto:naresh.gadepalli@gmail.com"&gt;naresh.gadepalli@gmail.com&lt;/a&gt;&gt;:&lt;br&gt; &gt; \
Hi Maththias,&lt;br&gt; &lt;div class="im"&gt;&gt; Thanks for the help. I finally was able to \
compile/install libvirt on&lt;br&gt; &gt; xenserver.&lt;br&gt;
&gt;&lt;br&gt;
&gt; I tried compiling the libvirt 0.9.2 with xen api support. Was able to&lt;br&gt;
&gt; install it successfully. When I tried giving the virsh command, I got an&lt;br&gt;
&gt; ‘authentication failed’ error as shown below.&lt;br&gt;
&gt;&lt;br&gt;
&gt; # virsh -c xenapi://&lt;my local ip&gt;&lt;br&gt;
&gt; Enter username for &lt;mylocalip&gt;: root&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;Here you entered root&lt;br&gt;
&lt;div class="im"&gt;&lt;br&gt;
&gt; Enter intel123's password for &lt;my local ip&gt;:&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;but here it asks for intel123's, that's unexpected. Did you edit \
this&lt;br&gt; one before mailing it, or is there really this mismatch?&lt;br&gt;
&lt;br&gt;
&gt; error: authentication failed: (null)&lt;br&gt;
&lt;br&gt;
Outputting (null) here is actually a bug. The only way this can happen&lt;br&gt;
is when the login attempt fails but the XenServer doesn't provide an&lt;br&gt;
error message. Maybe have a look at the XenServer logs to see if it&lt;br&gt;
says something about a failed login attempt.&lt;br&gt;
&lt;div class="im"&gt;&lt;br&gt;
&gt; I also tried connecting to the local machine as below,&lt;br&gt;
&gt;&lt;br&gt;
&gt; virsh -c "xenapi:///"&lt;br&gt;
&gt; error: authentication failed: Server name not in URI&lt;br&gt;
&gt; error: failed to connect to the hypervisor&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;The XenAPI driver expects a server name. xenapi:/// _could_ be treated&lt;br&gt;
as xenapi://localhost, but it's not implemented that way.&lt;br&gt;
&lt;div class="im"&gt;&lt;br&gt;
&gt; Also I am trying to install ruby-libvirt on xenserver, which looks like&lt;br&gt;
&gt; requires libvirt-devel package to be installed. How do I build it from the&lt;br&gt;
&gt; libvirt 0.9.2 source package.&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;Running 'make rpm' should build an libvirt-devel RPM package for \
you.&lt;br&gt; &lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;&lt;br&gt;
&gt; Thanks,&lt;br&gt;
&gt;&lt;br&gt;
&gt; Naresh&lt;br&gt;
&gt;&lt;br&gt;
&gt; On Wed, Jun 15, 2011 at 8:19 PM, Matthias Bolte&lt;br&gt;
&gt; &lt;&lt;a href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; 2011/6/15 G Naresh Kumar &lt;&lt;a \
href="mailto:naresh.gadepalli@gmail.com"&gt;naresh.gadepalli@gmail.com&lt;/a&gt;&gt;:&lt;br&gt; \
&gt;&gt; &gt; Hi Maththias,&lt;br&gt; &gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt; Thanks a lot for your response!.&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt; Is there a specific version of libvirt from which xenserver support \
is&lt;br&gt; &gt;&gt; &gt; added? I am getting the below error&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt; "error: invalid argument in libvirt was built without the \
'xenapi'&lt;br&gt; &gt;&gt; &gt; driver"&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; The means that your libvirt version is new enough and contains the&lt;br&gt;
&gt;&gt; XenAPI driver but that it was disabled on configure time, probably&lt;br&gt;
&gt;&gt; because the build server didn't have libxenserver installed and&lt;br&gt;
&gt;&gt; libvirt's configure script automatically disabled the driver because&lt;br&gt;
&gt;&gt; of a missing dependency.&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; &gt; I have installed libvirt from citrix yum repo.&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; Then Citrix build libvirt without XenAPI support. As a long term&lt;br&gt;
&gt;&gt; solution you could report to whom ever is responsible for that repo&lt;br&gt;
&gt;&gt; and request to enabled XenAPI support in that libvirt package. As a&lt;br&gt;
&gt;&gt; short term solution you could build libvirt from source yourself and&lt;br&gt;
&gt;&gt; make sure to get the XenAPI driver enabled.&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; &gt; I am using Xenserver 5.5 with libvirt 0.8.2 and it does not seem to \
be&lt;br&gt; &gt;&gt; &gt; working.&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; According to &lt;a href="http://libvirt.org/hvsupport.html" \
target="_blank"&gt;http://libvirt.org/hvsupport.html&lt;/a&gt; and the error message&lt;br&gt; \
&gt;&gt; 0.8.2 is new enough.&lt;br&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; Matthias&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; &gt; Thanks,&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt; Naresh&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt; On Jun 15, 2011 7:03 PM, "Matthias Bolte"&lt;br&gt;
&gt;&gt; &gt; &lt;&lt;a \
href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;&lt;br&gt; \
&gt;&gt; &gt; wrote:&lt;br&gt; &gt;&gt; &gt;&gt; 2011/6/15 G Naresh Kumar &lt;&lt;a \
href="mailto:naresh.gadepalli@gmail.com"&gt;naresh.gadepalli@gmail.com&lt;/a&gt;&gt;:&lt;br&gt; \
&gt;&gt; &gt;&gt;&gt; Hi,&lt;br&gt; &gt;&gt; &gt;&gt;&gt; Is libvirt supported on Citrix \
Xenserver. I have been searching for&lt;br&gt; &gt;&gt; &gt;&gt;&gt; the&lt;br&gt;
&gt;&gt; &gt;&gt;&gt; same&lt;br&gt;
&gt;&gt; &gt;&gt;&gt; with little/no luck.&lt;br&gt;
&gt;&gt; &gt;&gt;&gt; If supported, can you point to some links/documents which can \
help me&lt;br&gt; &gt;&gt; &gt;&gt;&gt; try&lt;br&gt;
&gt;&gt; &gt;&gt;&gt; out the same.&lt;br&gt;
&gt;&gt; &gt;&gt;&gt; Thanks,&lt;br&gt;
&gt;&gt; &gt;&gt;&gt; Naresh&lt;br&gt;
&gt;&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; &gt;&gt; libvirt can use XenAPI via libxenserver [1]. That should allow you \
to&lt;br&gt; &gt;&gt; &gt;&gt; use libvirt with a Citrix XenServer. You can use virsh like \
this&lt;br&gt; &gt;&gt; &gt;&gt; assuming you have a libxenserver enabled libvirt:&lt;br&gt;
&gt;&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; &gt;&gt; virsh -c xenapi://my-xen-server&lt;br&gt;
&gt;&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; &gt;&gt; But it's true, there is no documentation about this on the \
libvirt&lt;br&gt; &gt;&gt; &gt;&gt; website&lt;br&gt;
&gt;&gt; &gt;&gt; yet.&lt;br&gt;
&gt;&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; &gt;&gt; [1] &lt;a href="http://community.citrix.com/display/xs/Download+SDKs" \
target="_blank"&gt;http://community.citrix.com/display/xs/Download+SDKs&lt;/a&gt;&lt;br&gt; &gt;&gt; \
&gt;&gt;&lt;br&gt; &gt;&gt; &gt;&gt; --&lt;br&gt;
&gt;&gt; &gt;&gt; Matthias Bolte&lt;br&gt;
&gt;&gt; &gt;&gt; &lt;a href="http://photron.blogspot.com" \
target="_blank"&gt;http://photron.blogspot.com&lt;/a&gt;&lt;br&gt; &gt;&gt; &gt;&lt;br&gt;
&gt; --&lt;br&gt;
&gt; I was an atheist till I realized I am GOD&lt;br&gt;
&gt;&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;--&lt;br&gt;
&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;Matthias Bolte&lt;br&gt;
&lt;a href="http://photron.blogspot.com" \
target="_blank"&gt;http://photron.blogspot.com&lt;/a&gt;&lt;br&gt; \
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;I was an atheist till I \
realized I am GOD&lt;br&gt; &lt;/div&gt;



</body></email><email><emailId>20110721133404</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-07-21 13:34:04-0400</timestampReceived><subject>Re: [libvirt-users] Is libvirt supported on Citrix Xenserver?</subject><body>

2011/7/16 G Naresh Kumar &lt;naresh.gadepalli@gmail.com&gt;:
&gt; Hi Matthias,
&gt;
&gt;
&gt;
&gt; Sorry for the confusion.It was an edited one &amp; hence the typo. Below is the
&gt;
&gt; actual output:
&gt;
&gt;
&gt;
&gt; # virsh -c xenapi://&lt;myip&gt;
&gt;
&gt; Enter username for &lt;myip&gt;: root
&gt;
&gt; Enter root's password for &lt;myip&gt;:
&gt;
&gt; error: authentication failed: (null)
&gt;
&gt;
&gt;
&gt; I was not able to get anything in the Xen logs. Somehow figured out to print
&gt;
&gt; the Xen error using the patch given at the link http://osdir.com/ml/libvir-
&gt;
&gt; list/2011-06/msg00298.html. It prints "TRANSPORT_FAULT". Any pointers to
&gt; this
&gt;
&gt; error would be much appreciated. Iam also trying to debug this issue.

The mentioned patch is part of libvirt 0.9.3, but it has a problem. It
altered the call to xenapiSessionErrorHandler in xenapiOpen in a way
that breaks error reporting. libxenserver returns a list of strings
that represents the complete error message. xenapiSessionErrorHandler
with last parameter set to NULL, composes all parts of the error
message into a single string. But the mentioned patch only takes the
first part, in your case "TRANSPORT_FAULT". The second part of that
error message is an numeric error code that might help to understand
the problem.

I just posed a patch to be applied on top of current git to fix this

  https://www.redhat.com/archives/libvir-list/2011-July/msg01496.html

I attached a version of this patch that should apply to libvirt 0.9.3.
I'd be glad if you could test it, as I don't have a XenAPI setup at
hand. With that patch applied to libvirt 0.9.3 (or libvirt 0.9.2 + the
patch you mentioned before) you should get 'TRANSPORT_FAULT :
&lt;error_code&gt;' as error message and the number could help to figure out
what the actual problem is.

&gt; As per your suggestion,
&gt;
&gt; I had used make rpm. But it requires xen-devel pacakge, which I was
&gt;
&gt; not able to get for Xen 3.4.2. Is there any way where I can use the source
&gt;
&gt; package and build &amp; install the library without using 'make rpm' ?

You can just do the normal ./configure, make and make install dance as
libvirt is autotools based.

&gt; Thanks for all the help.
&gt;
&gt; Regards
&gt;
&gt; Naresh
&gt;
&gt; On Thu, Jul 14, 2011 at 7:07 PM, Matthias Bolte
&gt; &lt;matthias.bolte@googlemail.com&gt; wrote:
&gt;&gt;
&gt;&gt; 2011/7/14 G Naresh Kumar &lt;naresh.gadepalli@gmail.com&gt;:
&gt;&gt; &gt; Hi Maththias,
&gt;&gt; &gt; Thanks for the help. I finally was able to compile/install libvirt on
&gt;&gt; &gt; xenserver.
&gt;&gt; &gt;
&gt;&gt; &gt; I tried compiling the libvirt 0.9.2 with xen api support. Was able to
&gt;&gt; &gt; install it successfully. When I tried giving the virsh command, I got an
&gt;&gt; &gt; ‘authentication failed' error as shown below.
&gt;&gt; &gt;
&gt;&gt; &gt; # virsh -c xenapi://&lt;my local ip&gt;
&gt;&gt; &gt; Enter username for &lt;mylocalip&gt;: root
&gt;&gt;
&gt;&gt; Here you entered root
&gt;&gt;
&gt;&gt; &gt; Enter intel123's password for &lt;my local ip&gt;:
&gt;&gt;
&gt;&gt; but here it asks for intel123's, that's unexpected. Did you edit this
&gt;&gt; one before mailing it, or is there really this mismatch?
&gt;&gt;
&gt;&gt; &gt; error: authentication failed: (null)
&gt;&gt;
&gt;&gt; Outputting (null) here is actually a bug. The only way this can happen
&gt;&gt; is when the login attempt fails but the XenServer doesn't provide an
&gt;&gt; error message. Maybe have a look at the XenServer logs to see if it
&gt;&gt; says something about a failed login attempt.
&gt;&gt;
&gt;&gt; &gt; I also tried connecting to the local machine as below,
&gt;&gt; &gt;
&gt;&gt; &gt; virsh -c "xenapi:///"
&gt;&gt; &gt; error: authentication failed: Server name not in URI
&gt;&gt; &gt; error: failed to connect to the hypervisor
&gt;&gt;
&gt;&gt; The XenAPI driver expects a server name. xenapi:/// _could_ be treated
&gt;&gt; as xenapi://localhost, but it's not implemented that way.
&gt;&gt;
&gt;&gt; &gt; Also I am trying to install ruby-libvirt on xenserver, which looks like
&gt;&gt; &gt; requires libvirt-devel package to be installed. How do I build it from
&gt;&gt; &gt; the
&gt;&gt; &gt; libvirt 0.9.2 source package.
&gt;&gt;
&gt;&gt; Running 'make rpm' should build an libvirt-devel RPM package for you.
&gt;&gt;
&gt;&gt; &gt; Thanks,
&gt;&gt; &gt;
&gt;&gt; &gt; Naresh
&gt;&gt; &gt;
&gt;&gt; &gt; On Wed, Jun 15, 2011 at 8:19 PM, Matthias Bolte
&gt;&gt; &gt; &lt;matthias.bolte@googlemail.com&gt; wrote:
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; 2011/6/15 G Naresh Kumar &lt;naresh.gadepalli@gmail.com&gt;:
&gt;&gt; &gt;&gt; &gt; Hi Maththias,
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt; Thanks a lot for your response!.
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt; Is there a specific version of libvirt from which xenserver support
&gt;&gt; &gt;&gt; &gt; is
&gt;&gt; &gt;&gt; &gt; added? I am getting the below error
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt; "error: invalid argument in libvirt was built without the 'xenapi'
&gt;&gt; &gt;&gt; &gt; driver"
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; The means that your libvirt version is new enough and contains the
&gt;&gt; &gt;&gt; XenAPI driver but that it was disabled on configure time, probably
&gt;&gt; &gt;&gt; because the build server didn't have libxenserver installed and
&gt;&gt; &gt;&gt; libvirt's configure script automatically disabled the driver because
&gt;&gt; &gt;&gt; of a missing dependency.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; &gt; I have installed libvirt from citrix yum repo.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Then Citrix build libvirt without XenAPI support. As a long term
&gt;&gt; &gt;&gt; solution you could report to whom ever is responsible for that repo
&gt;&gt; &gt;&gt; and request to enabled XenAPI support in that libvirt package. As a
&gt;&gt; &gt;&gt; short term solution you could build libvirt from source yourself and
&gt;&gt; &gt;&gt; make sure to get the XenAPI driver enabled.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; &gt; I am using Xenserver 5.5 with libvirt 0.8.2 and it does not seem to
&gt;&gt; &gt;&gt; &gt; be
&gt;&gt; &gt;&gt; &gt; working.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; According to http://libvirt.org/hvsupport.html and the error message
&gt;&gt; &gt;&gt; 0.8.2 is new enough.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Matthias
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; &gt; Thanks,
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt; Naresh
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt; On Jun 15, 2011 7:03 PM, "Matthias Bolte"
&gt;&gt; &gt;&gt; &gt; &lt;matthias.bolte@googlemail.com&gt;
&gt;&gt; &gt;&gt; &gt; wrote:
&gt;&gt; &gt;&gt; &gt;&gt; 2011/6/15 G Naresh Kumar &lt;naresh.gadepalli@gmail.com&gt;:
&gt;&gt; &gt;&gt; &gt;&gt;&gt; Hi,
&gt;&gt; &gt;&gt; &gt;&gt;&gt; Is libvirt supported on Citrix Xenserver. I have been searching for
&gt;&gt; &gt;&gt; &gt;&gt;&gt; the
&gt;&gt; &gt;&gt; &gt;&gt;&gt; same
&gt;&gt; &gt;&gt; &gt;&gt;&gt; with little/no luck.
&gt;&gt; &gt;&gt; &gt;&gt;&gt; If supported, can you point to some links/documents which can help
&gt;&gt; &gt;&gt; &gt;&gt;&gt; me
&gt;&gt; &gt;&gt; &gt;&gt;&gt; try
&gt;&gt; &gt;&gt; &gt;&gt;&gt; out the same.
&gt;&gt; &gt;&gt; &gt;&gt;&gt; Thanks,
&gt;&gt; &gt;&gt; &gt;&gt;&gt; Naresh
&gt;&gt; &gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; &gt;&gt; libvirt can use XenAPI via libxenserver [1]. That should allow you
&gt;&gt; &gt;&gt; &gt;&gt; to
&gt;&gt; &gt;&gt; &gt;&gt; use libvirt with a Citrix XenServer. You can use virsh like this
&gt;&gt; &gt;&gt; &gt;&gt; assuming you have a libxenserver enabled libvirt:
&gt;&gt; &gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; &gt;&gt; virsh -c xenapi://my-xen-server
&gt;&gt; &gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; &gt;&gt; But it's true, there is no documentation about this on the libvirt
&gt;&gt; &gt;&gt; &gt;&gt; website
&gt;&gt; &gt;&gt; &gt;&gt; yet.
&gt;&gt; &gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; &gt;&gt; [1] http://community.citrix.com/display/xs/Download+SDKs
&gt;&gt; &gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; &gt;&gt; --
&gt;&gt; &gt;&gt; &gt;&gt; Matthias Bolte
&gt;&gt; &gt;&gt; &gt;&gt; http://photron.blogspot.com
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt; --
&gt;&gt; &gt; I was an atheist till I realized I am GOD
&gt;&gt; &gt;
&gt;&gt;
&gt;&gt; --
&gt;&gt; Matthias Bolte
&gt;&gt; http://photron.blogspot.com
&gt;
&gt;
&gt;
&gt; --
&gt; I was an atheist till I realized I am GOD
&gt;



-- 
Matthias Bolte
http://photron.blogspot.com

["0001-xenapi-Improve-error-reporting-in-xenapiOpen-once-ag_v093.patch" (text/x-diff)]

From cec38824ea406e5adfebcb0740141c709d0599ab Mon Sep 17 00:00:00 2001
From: Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;
Date: Thu, 21 Jul 2011 15:16:11 +0200
Subject: [PATCH] xenapi: Improve error reporting in xenapiOpen once again

privP-&gt;session-&gt;error_description is a list and in order to get the
complete error message all parts of the list should be concatenated.
xenapiSessionErrorHandler does this when its third parameter is NULL.
The current code discards all but the first part of the error message
resulting in a potentially incomplete error message.

This partly reverts 006be75ee214f9b4, that tried to avoid reporting
a (null) in the error message. The actual problem is more general in
returnErrorFromSession that might return NULL if there is no error.

Make sure that returnErrorFromSession return non-NULL always. Also
don't skip the last error message part.
---
 src/xenapi/xenapi_driver.c |    5 +----
 src/xenapi/xenapi_utils.c  |    4 +++-
 2 files changed, 4 insertions(+), 5 deletions(-)

diff --git a/src/xenapi/xenapi_driver.c b/src/xenapi/xenapi_driver.c
index 97da1d1..77bf82d 100644
--- a/src/xenapi/xenapi_driver.c
+++ b/src/xenapi/xenapi_driver.c
@@ -193,10 +193,7 @@ xenapiOpen (virConnectPtr conn, virConnectAuthPtr auth,
         return VIR_DRV_OPEN_SUCCESS;
     }
 
-    xenapiSessionErrorHandler(conn, VIR_ERR_AUTH_FAILED,
-                              *privP-&gt;session-&gt;error_description);
+    xenapiSessionErrorHandler(conn, VIR_ERR_AUTH_FAILED, NULL);
 
   error:
     VIR_FREE(username);
diff --git a/src/xenapi/xenapi_utils.c b/src/xenapi/xenapi_utils.c
index 342ae5b..79fd946 100644
--- a/src/xenapi/xenapi_utils.c
+++ b/src/xenapi/xenapi_utils.c
@@ -272,12 +272,14 @@ returnErrorFromSession(xen_session *session)
 {
     int i;
     virBuffer buf = VIR_BUFFER_INITIALIZER;
-    for (i = 0; i &lt; session-&gt;error_description_count - 1; i++) {
+    for (i = 0; i &lt; session-&gt;error_description_count; i++) {
         if (!i)
             virBufferEscapeString(&amp;buf, "%s", session-&gt;error_description[i]);
         else
             virBufferEscapeString(&amp;buf, " : %s", session-&gt;error_description[i]);
     }
+    if (virBufferUse(&amp;buf) &lt; 1)
+        virBufferAdd(&amp;buf, _("unknown error"), -1);
     return virBufferContentAndReset(&amp;buf);
 }
 
-- 
1.7.4.1



</body></email><email><emailId>20110718200056</emailId><senderName>Emmanuel Noobadmin</senderName><senderEmail>centos.admin@gmail.com</senderEmail><timestampReceived>2011-07-18 20:00:56-0400</timestampReceived><subject>Re: [libvirt-users] RAID1 over IP?</subject><body>

On 7/19/11, David Ehle &lt;ehle@agni.phys.iit.edu&gt; wrote:
&gt; KVM/libvirt makes moving running VM's from one host to another a no
&gt; brainer, but I'm trying to figure out the right way to be able to take a
&gt; the storage backend for maintenance without disrupting the VMs.
&gt;
&gt; Right now I'm thinking something like KVM + libvirt + heartbeat/corosync +
&gt; pacemaker + DBRM on Ubuntu 10.04 with 3 or 4 nodes - 2 hosts, 2 storage,
&gt; or 1 host, 1 host + storage, 1 storage.

Personally, I had been planning to do it with mdadm multi-path &amp; RAID
1 over iSCSI. Seems to be a more straightforward solution than using a
full HA setup if the purpose is to ensure storage remains available
when a node is down (for maintenance or otherwise).

</body></email><email><emailId>20110718210626</emailId><senderName>David Ehle</senderName><senderEmail>ehle@agni.phys.iit.edu</senderEmail><timestampReceived>2011-07-18 21:06:26-0400</timestampReceived><subject>Re: [libvirt-users] RAID1 over IP?</subject><body>



That makes a lot of sense... I don't know that I really needed the full 
suite, as I don't think I'm aiming for that level of  HA for the hosted 
systems.

I'll look into it. Can you provide me any better links than what a google 
search would provide?

Thanks!

David.

On Tue, 19 Jul 2011, Emmanuel Noobadmin wrote:

&gt; On 7/19/11, David Ehle &lt;ehle@agni.phys.iit.edu&gt; wrote:
&gt;&gt; KVM/libvirt makes moving running VM's from one host to another a no
&gt;&gt; brainer, but I'm trying to figure out the right way to be able to take a
&gt;&gt; the storage backend for maintenance without disrupting the VMs.
&gt;&gt;
&gt;&gt; Right now I'm thinking something like KVM + libvirt + heartbeat/corosync +
&gt;&gt; pacemaker + DBRM on Ubuntu 10.04 with 3 or 4 nodes - 2 hosts, 2 storage,
&gt;&gt; or 1 host, 1 host + storage, 1 storage.
&gt;
&gt; Personally, I had been planning to do it with mdadm multi-path &amp; RAID
&gt; 1 over iSCSI. Seems to be a more straightforward solution than using a
&gt; full HA setup if the purpose is to ensure storage remains available
&gt; when a node is down (for maintenance or otherwise).
&gt;

</body></email><email><emailId>20110719200807</emailId><senderName>David Ehle</senderName><senderEmail>ehle@agni.phys.iit.edu</senderEmail><timestampReceived>2011-07-19 20:08:07-0400</timestampReceived><subject>Re: [libvirt-users] RAID1 over IP?</subject><body>



On Tue, 19 Jul 2011, Emmanuel Noobadmin wrote:

&gt; On 7/19/11, David Ehle &lt;ehle@agni.phys.iit.edu&gt; wrote:
&gt;&gt; KVM/libvirt makes moving running VM's from one host to another a no
&gt;&gt; brainer, but I'm trying to figure out the right way to be able to take a
&gt;&gt; the storage backend for maintenance without disrupting the VMs.
&gt;&gt;
&gt;&gt; Right now I'm thinking something like KVM + libvirt + heartbeat/corosync +
&gt;&gt; pacemaker + DBRM on Ubuntu 10.04 with 3 or 4 nodes - 2 hosts, 2 storage,
&gt;&gt; or 1 host, 1 host + storage, 1 storage.
&gt;
&gt; Personally, I had been planning to do it with mdadm multi-path &amp; RAID
&gt; 1 over iSCSI. Seems to be a more straightforward solution than using a
&gt; full HA setup if the purpose is to ensure storage remains available
&gt; when a node is down (for maintenance or otherwise).
&gt;
&gt;

Would you be willing /able to elaborate more on this idea?  I've been 
looking into it a bit more and while your right that it sounds simpler on 
paper, it looks like doing DRBD is packaged for Ubuntu, and there is 
pretty good Cook Book documentation for how to do HA NFS on top of DRBD.

I'm a real novice on the multipath topic so I'm having trouble comparing 
apples to apples to see what the pros and cons of the two scenarios would 
be.

Thanks!

David.

</body></email><email><emailId>20110718191142</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-07-18 19:11:42-0400</timestampReceived><subject>Re: [libvirt-users] cannot perform tunnelled migration without using peer2peer flag</subject><body>

On 07/18/2011 04:11 AM, Osier Yang wrote:
&gt; 于 2011年07月18日 10:07, zhang xintao 写道:
&gt;&gt; Dear All
&gt;&gt; I try to migration a kvm guest os to another host failed
&gt;&gt; server: ubuntu 11.04 server
&gt;&gt; virsh:migrate --live --tunnelled vm1 qemu+ssh://192.168.10.3/system
&gt;&gt; error:Requested operation is not valid:cannot perform
&gt;&gt; tunnelled migration without using peer2peer flag
&gt;
&gt; The error tells you all, you need to use "--p2p".

That said, why can't virsh be smarter, and automatically request the 
right underlying flags without making the user also type --p2p?  Any 
problems with this patch?

 From db318d41c2a70189c21303c824aa4a862815874a Mon Sep 17 00:00:00 2001
From: Eric Blake &lt;eblake@redhat.com&gt;
Date: Mon, 18 Jul 2011 13:10:29 -0600
Subject: [PATCH] virsh: make migrate --tunnelled imply --p2p

We can make the virsh migrate UI friendlier by supplying the
missing bit automatically instead of erroring out when requesting
--tunnelled without --p2p.

* tools/virsh.c (doMigrate): Make --p2p optional when using
--tunnelled.
* tools/virsh.pod (migrate): Tweak wording accordingly.
---
  tools/virsh.c   |    2 +-
  tools/virsh.pod |    5 +++--
  2 files changed, 4 insertions(+), 3 deletions(-)

diff --git a/tools/virsh.c b/tools/virsh.c
index 6c8032f..05aeb6c 100644
--- a/tools/virsh.c
+++ b/tools/virsh.c
@@ -4475,7 +4475,7 @@ doMigrate (void *opaque)
      if (vshCommandOptBool (cmd, "p2p"))
          flags |= VIR_MIGRATE_PEER2PEER;
      if (vshCommandOptBool (cmd, "tunnelled"))
-        flags |= VIR_MIGRATE_TUNNELLED;
+        flags |= VIR_MIGRATE_TUNNELLED | VIR_MIGRATE_PEER2PEER;

      if (vshCommandOptBool (cmd, "persistent"))
          flags |= VIR_MIGRATE_PERSIST_DEST;
diff --git a/tools/virsh.pod b/tools/virsh.pod
index e156232..e0adc31 100644
--- a/tools/virsh.pod
+++ b/tools/virsh.pod
@@ -534,14 +534,15 @@ Provide the maximum number of virtual CPUs 
supported for a guest VM on
  this connection.  If provided, the I&lt;type&gt; parameter must be a valid
  type attribute for the &lt;domain&gt; element of XML.

-=item B&lt;migrate&gt; [I&lt;--live&gt;] [I&lt;--direct&gt;] [I&lt;--p2p&gt; [I&lt;--tunnelled&gt;]]
+=item B&lt;migrate&gt; [I&lt;--live&gt;] [I&lt;--direct&gt;] [I&lt;--p2p&gt;] [I&lt;--tunnelled&gt;]
  [I&lt;--persistent&gt;] [I&lt;--undefinesource&gt;] [I&lt;--suspend&gt;] 
[I&lt;--copy-storage-all&gt;]
  [I&lt;--copy-storage-inc&gt;] [I&lt;--verbose&gt;] I&lt;domain-id&gt; I&lt;desturi&gt; 
[I&lt;migrateuri&gt;]
  [I&lt;dname&gt;] [I&lt;--timeout&gt; B&lt;seconds&gt;]

  Migrate domain to another host.  Add I&lt;--live&gt; for live migration; 
I&lt;--p2p&gt;
  for peer-2-peer migration; I&lt;--direct&gt; for direct migration; or 
I&lt;--tunnelled&gt;
-for tunnelled migration.  I&lt;--persistent&gt; leaves the domain persistent on
+for tunnelled migration (I&lt;--tunnelled&gt; implies I&lt;--p2p&gt;).  I&lt;--persistent&gt;
+leaves the domain persistent on
  destination host, I&lt;--undefinesource&gt; undefines the domain on the 
source host,
  and I&lt;--suspend&gt; leaves the domain paused on the destination host.
  I&lt;--copy-storage-all&gt; indicates migration with non-shared storage with 
full
-- 
1.7.4.4



-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20110718211748</emailId><senderName>Jiri Denemark</senderName><senderEmail>jdenemar@redhat.com</senderEmail><timestampReceived>2011-07-18 21:17:48-0400</timestampReceived><subject>Re: [libvirt-users] cannot perform tunnelled migration without using peer2peer flag</subject><body>

On Mon, Jul 18, 2011 at 13:11:42 -0600, Eric Blake wrote:
&gt; On 07/18/2011 04:11 AM, Osier Yang wrote:
&gt; &gt; 于 2011年07月18日 10:07, zhang xintao 写道:
&gt; &gt;&gt; Dear All
&gt; &gt;&gt; I try to migration a kvm guest os to another host failed
&gt; &gt;&gt; server: ubuntu 11.04 server
&gt; &gt;&gt; virsh:migrate --live --tunnelled vm1 qemu+ssh://192.168.10.3/system
&gt; &gt;&gt; error:Requested operation is not valid:cannot perform
&gt; &gt;&gt; tunnelled migration without using peer2peer flag
&gt; &gt;
&gt; &gt; The error tells you all, you need to use "--p2p".
&gt; 
&gt; That said, why can't virsh be smarter, and automatically request the 
&gt; right underlying flags without making the user also type --p2p?  Any 
&gt; problems with this patch?

No problem at all, I think it's a very good idea.

&gt;  From db318d41c2a70189c21303c824aa4a862815874a Mon Sep 17 00:00:00 2001
&gt; From: Eric Blake &lt;eblake@redhat.com&gt;
&gt; Date: Mon, 18 Jul 2011 13:10:29 -0600
&gt; Subject: [PATCH] virsh: make migrate --tunnelled imply --p2p
&gt; 
&gt; We can make the virsh migrate UI friendlier by supplying the
&gt; missing bit automatically instead of erroring out when requesting
&gt; --tunnelled without --p2p.
&gt; 
&gt; * tools/virsh.c (doMigrate): Make --p2p optional when using
&gt; --tunnelled.
&gt; * tools/virsh.pod (migrate): Tweak wording accordingly.
&gt; ---
&gt;   tools/virsh.c   |    2 +-
&gt;   tools/virsh.pod |    5 +++--
&gt;   2 files changed, 4 insertions(+), 3 deletions(-)

So, here is my ACK

Jirka

</body></email><email><emailId>20110719092337</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-07-19 09:23:37-0400</timestampReceived><subject>Re: [libvirt-users] cannot perform tunnelled migration without using peer2peer flag</subject><body>

On Mon, Jul 18, 2011 at 01:11:42PM -0600, Eric Blake wrote:
&gt; On 07/18/2011 04:11 AM, Osier Yang wrote:
&gt; &gt;于 2011年07月18日 10:07, zhang xintao 写道:
&gt; &gt;&gt;Dear All
&gt; &gt;&gt;I try to migration a kvm guest os to another host failed
&gt; &gt;&gt;server: ubuntu 11.04 server
&gt; &gt;&gt;virsh:migrate --live --tunnelled vm1 qemu+ssh://192.168.10.3/system
&gt; &gt;&gt;error:Requested operation is not valid:cannot perform
&gt; &gt;&gt;tunnelled migration without using peer2peer flag
&gt; &gt;
&gt; &gt;The error tells you all, you need to use "--p2p".
&gt; 
&gt; That said, why can't virsh be smarter, and automatically request the
&gt; right underlying flags without making the user also type --p2p?  Any
&gt; problems with this patch?

It was done to leave open the possibility of supporting a
TUNNELLED mode, which was independant of P2P mode in the
future. It isn't entirely likely, but I didn't want to lock
ourselves out of it with this kind of patch

Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110719121913</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-07-19 12:19:13-0400</timestampReceived><subject>Re: [libvirt-users] cannot perform tunnelled migration without using peer2peer flag</subject><body>

On 07/19/2011 03:23 AM, Daniel P. Berrange wrote:
&gt; On Mon, Jul 18, 2011 at 01:11:42PM -0600, Eric Blake wrote:
&gt;&gt; On 07/18/2011 04:11 AM, Osier Yang wrote:
&gt;&gt;&gt; 于 2011年07月18日 10:07, zhang xintao 写道:
&gt;&gt;&gt;&gt; Dear All
&gt;&gt;&gt;&gt; I try to migration a kvm guest os to another host failed
&gt;&gt;&gt;&gt; server: ubuntu 11.04 server
&gt;&gt;&gt;&gt; virsh:migrate --live --tunnelled vm1 qemu+ssh://192.168.10.3/system
&gt;&gt;&gt;&gt; error:Requested operation is not valid:cannot perform
&gt;&gt;&gt;&gt; tunnelled migration without using peer2peer flag
&gt;&gt;&gt;
&gt;&gt;&gt; The error tells you all, you need to use "--p2p".
&gt;&gt;
&gt;&gt; That said, why can't virsh be smarter, and automatically request the
&gt;&gt; right underlying flags without making the user also type --p2p?  Any
&gt;&gt; problems with this patch?
&gt;
&gt; It was done to leave open the possibility of supporting a
&gt; TUNNELLED mode, which was independant of P2P mode in the
&gt; future. It isn't entirely likely, but I didn't want to lock
&gt; ourselves out of it with this kind of patch

But if we ever reach that point, could we then revert this patch at that 
time, to where the user once again has to tell virsh both --p2p and 
--tunnelled?  Or would such a change be considered a regression in 
behavior at that time for existing scripts that were foolishly relying 
on the UI shortcut, and hence virsh should never learn the UI shortcut 
in the first place?  If the latter, then we should revert the patch that 
just went in so that 0.9.4 doesn't lock us into causing a future regression.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20110719122318</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-07-19 12:23:18-0400</timestampReceived><subject>Re: [libvirt-users] cannot perform tunnelled migration without using peer2peer flag</subject><body>

On Tue, Jul 19, 2011 at 06:19:13AM -0600, Eric Blake wrote:
&gt; On 07/19/2011 03:23 AM, Daniel P. Berrange wrote:
&gt; &gt;On Mon, Jul 18, 2011 at 01:11:42PM -0600, Eric Blake wrote:
&gt; &gt;&gt;On 07/18/2011 04:11 AM, Osier Yang wrote:
&gt; &gt;&gt;&gt;于 2011年07月18日 10:07, zhang xintao 写道:
&gt; &gt;&gt;&gt;&gt;Dear All
&gt; &gt;&gt;&gt;&gt;I try to migration a kvm guest os to another host failed
&gt; &gt;&gt;&gt;&gt;server: ubuntu 11.04 server
&gt; &gt;&gt;&gt;&gt;virsh:migrate --live --tunnelled vm1 qemu+ssh://192.168.10.3/system
&gt; &gt;&gt;&gt;&gt;error:Requested operation is not valid:cannot perform
&gt; &gt;&gt;&gt;&gt;tunnelled migration without using peer2peer flag
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;The error tells you all, you need to use "--p2p".
&gt; &gt;&gt;
&gt; &gt;&gt;That said, why can't virsh be smarter, and automatically request the
&gt; &gt;&gt;right underlying flags without making the user also type --p2p?  Any
&gt; &gt;&gt;problems with this patch?
&gt; &gt;
&gt; &gt;It was done to leave open the possibility of supporting a
&gt; &gt;TUNNELLED mode, which was independant of P2P mode in the
&gt; &gt;future. It isn't entirely likely, but I didn't want to lock
&gt; &gt;ourselves out of it with this kind of patch
&gt; 
&gt; But if we ever reach that point, could we then revert this patch at
&gt; that time, to where the user once again has to tell virsh both --p2p
&gt; and --tunnelled?  Or would such a change be considered a regression
&gt; in behavior at that time for existing scripts that were foolishly
&gt; relying on the UI shortcut, and hence virsh should never learn the
&gt; UI shortcut in the first place?  If the latter, then we should
&gt; revert the patch that just went in so that 0.9.4 doesn't lock us
&gt; into causing a future regression.

It would be a regression, but also it would mean old virsh releases
would not be able to operate against new libvirtd releases.

Basically, virsh shouldn't make any assumptions based on the current
way things are implemented in libvirtd, since it cannot expect to be
running against a matching version. Old virsh should work against new
libvirtd, and vica-verca. This is the same case as the checking of
flags in src/libvirt.c vs the individual drivers.

Regards,
Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110712003400</emailId><senderName>Whit Blauvelt</senderName><senderEmail>whit.virt@transpect.com</senderEmail><timestampReceived>2011-07-12 00:34:00-0400</timestampReceived><subject>Re: [libvirt-users] virt-manager/libvirt backwards compatibility problem?</subject><body>

Interestingly, drbd-mc 0.9.4 still works fine (in a virt-manager-like way)
from the systems with the updated libvirt to the systems with the older
version. So the problem looks to be with libvirt 0.9.3 in some way, when
called by virt-manager or virst to connect to an older libvirt-based system.

Whit

</body></email><email><emailId>20110712172604</emailId><senderName>Whit Blauvelt</senderName><senderEmail>whit.virt@transpect.com</senderEmail><timestampReceived>2011-07-12 17:26:04-0400</timestampReceived><subject>Re: [libvirt-users] virt-manager/libvirt backwards compatibility problem?</subject><body>

&gt; This connection for virt-manager worked flawlessly for months when all the
&gt; systems had libvirt 0.8.3.
&gt; 
&gt; Is this a known incompatibility? Something I have to tweak somewhere?

Reverting to 0.8.8 for libvirtd - and virt-manager 0.8.6 - works connecting
to the 0.8.3 systems. 

Dropping to 0.9.2 didn't. 

Is this by design that, say, 0.9.x isn't backwards-compatible in terms of
using virt-manager on it to manage 0.8.x systems? Or is it a bug I should
file somewhere?

Thanks,
Whit

</body></email><email><emailId>20110713033205</emailId><senderName>Heath Petersen</senderName><senderEmail>mailtest@kandre.com</senderEmail><timestampReceived>2011-07-13 03:32:05-0400</timestampReceived><subject>[libvirt-users] Problem starting libvirtd 0.9.3 on Ubuntu</subject><body>

I just built libvirt 0.9.3 from scratch on my Ubuntu 10.10 system.  It 
appeared to build and install correctly.

When running a command like 'virsh -c qemu:///session list --all', I get 
the following:

error: Failed to connect socket to '@/home/heath/.libvirt/libvirt-sock': 
Connection refused
error: failed to connect to the hypervisor

When looking into it, I realized libvirtd was not running as user heath 
after the command.  Running it with LIBVIRT_DEBUG=1, I get:

...
22:26:34.334: 8385: debug : remoteOpen:774 : Auto-spawn user daemon instance
22:26:34.334: 8385: debug : doRemoteOpen:487 : proceeding with name = 
qemu:///session
22:26:34.334: 8385: debug : doRemoteOpen:497 : Connecting with transport 1
22:26:34.378: 8385: debug : doRemoteOpen:544 : Proceeding with sockname 
@/home/heath/.libvirt/libvirt-sock
22:26:34.378: 8385: debug : virCommandRunAsync:1874 : About to run 
LC_ALL=C 
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games 
HOME=/home/heath USER=heath LOGNAME=heath /usr/local/sbin/libvirtd 
--timeout=30
22:26:34.378: 8385: debug : virCommandRunAsync:1890 : Command result 0, 
with PID 8386
22:26:34.379: 8385: debug : virCommandRun:1711 : Result status 0, 
stdout: '(null)' stderr: '(null)'
22:26:55.430: 8385: debug : do_open:1059 : driver 7 remote returned ERROR
22:26:55.430: 8385: debug : virUnrefConnect:145 : unref connection 
0x8451840 1
22:26:55.430: 8385: debug : virReleaseConnect:94 : release connection 
0x8451840
error: Failed to connect socket to '@/home/heath/.libvirt/libvirt-sock': 
Connection refused
error: failed to connect to the hypervisor


I then tried to start libvirtd manually with 'LIBVIRT_DEBUG=1 LC_ALL=C 
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games 
HOME=/home/heath USER=heath LOGNAME=heath /usr/local/sbin/libvirtd 
--timeout=30', just like it appears virsh is trying to do.  I get a 
return code of 1 with the following output:

22:29:33.295: 8389: info : libvirt version: 0.9.3
22:29:33.295: 8389: debug : virInitialize:412 : register drivers
22:29:33.295: 8389: debug : virRegisterDriver:767 : driver=0x3745e0 
name=Test
22:29:33.295: 8389: debug : virRegisterDriver:791 : registering Test as 
driver 0
22:29:33.295: 8389: debug : virRegisterNetworkDriver:584 : registering 
Test as network driver 0
22:29:33.295: 8389: debug : virRegisterInterfaceDriver:617 : registering 
Test as interface driver 0
22:29:33.295: 8389: debug : virRegisterStorageDriver:650 : registering 
Test as storage driver 0
22:29:33.295: 8389: debug : virRegisterDeviceMonitor:683 : registering 
Test as device driver 0
22:29:33.295: 8389: debug : virRegisterSecretDriver:716 : registering 
Test as secret driver 0
22:29:33.295: 8389: debug : virRegisterNWFilterDriver:749 : registering 
Test as network filter driver 0
22:29:33.295: 8389: debug : virRegisterDriver:767 : driver=0x374fa0 name=Xen
22:29:33.295: 8389: debug : virRegisterDriver:791 : registering Xen as 
driver 1
22:29:33.295: 8389: debug : virRegisterDriver:767 : driver=0x375720 
name=OPENVZ
22:29:33.295: 8389: debug : virRegisterDriver:791 : registering OPENVZ 
as driver 2
22:29:33.295: 8389: debug : virRegisterDriver:767 : driver=0x375920 
name=VMWARE
22:29:33.295: 8389: debug : virRegisterDriver:791 : registering VMWARE 
as driver 3
22:29:33.295: 8389: debug : virRegisterDriver:767 : driver=0x375420 
name=PHYP
22:29:33.295: 8389: debug : virRegisterDriver:791 : registering PHYP as 
driver 4
22:29:33.295: 8389: debug : virRegisterStorageDriver:650 : registering 
PHYP as storage driver 1
22:29:33.295: 8389: debug : virRegisterInterfaceDriver:617 : registering 
PHYP as interface driver 1
22:29:33.324: 8389: debug : tryLoadOne:163 : Found VBoxXPCOMC.so in 
'/usr/lib/virtualbox'
22:29:33.324: 8389: debug : vboxRegister:94 : VBoxCGlueInit found API 
version: 4.0.10 (4000010)
22:29:33.324: 8389: debug : vboxRegister:121 : VirtualBox API version: 4.0
22:29:33.324: 8389: debug : virRegisterDriver:767 : driver=0x376920 
name=VBOX
22:29:33.324: 8389: debug : virRegisterDriver:791 : registering VBOX as 
driver 5
22:29:33.324: 8389: debug : virRegisterNetworkDriver:584 : registering 
VBOX as network driver 1
22:29:33.325: 8389: debug : virRegisterStorageDriver:650 : registering 
VBOX as storage driver 2
22:29:33.325: 8389: debug : virRegisterDriver:767 : driver=0x376c20 name=ESX
22:29:33.325: 8389: debug : virRegisterDriver:791 : registering ESX as 
driver 6
22:29:33.325: 8389: debug : virRegisterInterfaceDriver:617 : registering 
ESX as interface driver 2
22:29:33.325: 8389: debug : virRegisterNetworkDriver:584 : registering 
ESX as network driver 2
22:29:33.325: 8389: debug : virRegisterStorageDriver:650 : registering 
ESX as storage driver 3
22:29:33.325: 8389: debug : virRegisterDeviceMonitor:683 : registering 
ESX as device driver 1
22:29:33.325: 8389: debug : virRegisterSecretDriver:716 : registering 
ESX as secret driver 1
22:29:33.325: 8389: debug : virRegisterNWFilterDriver:749 : registering 
ESX as network filter driver 1
22:29:33.325: 8389: debug : virRegisterDriver:767 : driver=0x374a00 
name=remote
22:29:33.325: 8389: debug : virRegisterDriver:791 : registering remote 
as driver 7
22:29:33.325: 8389: debug : virRegisterNetworkDriver:584 : registering 
remote as network driver 3
22:29:33.325: 8389: debug : virRegisterInterfaceDriver:617 : registering 
remote as interface driver 3
22:29:33.325: 8389: debug : virRegisterStorageDriver:650 : registering 
remote as storage driver 4
22:29:33.325: 8389: debug : virRegisterDeviceMonitor:683 : registering 
remote as device driver 2
22:29:33.325: 8389: debug : virRegisterSecretDriver:716 : registering 
remote as secret driver 2
22:29:33.325: 8389: debug : virRegisterNWFilterDriver:749 : registering 
remote as network filter driver 2

Any ideas why libvirtd isn't starting?

-- 
----------
If you want to send stuff to the bit bucket, email Phineas.Ferb@Kandre.com .

</body></email><email><emailId>20110713085246</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-07-13 08:52:46-0400</timestampReceived><subject>Re: [libvirt-users] Unable to start libvirtd 0.9.3 on Ubuntu 10.10</subject><body>

2011/7/13 Heath Petersen &lt;HeathPetersen@kandre.com&gt;:
&gt; I just built libvirt 0.9.3 on my Ubuntu 10.10 box.  It appears to have built
&gt; correctly.
&gt;
&gt; When I try "virsh -c qemu:///session list --all" I get the following:
&gt;
&gt; error: Failed to connect socket to '@/home/heath/.libvirt/libvirt-sock':
&gt; Connection refused
&gt; error: failed to connect to the hypervisor
&gt;
&gt; After that, libvirtd isn't running as user heath as it did when I was using
&gt; 0.9.2.  When I run it with LIBVIRT_DEBUG=1 I get this:

Your problem is probably caused by a partly rewrite of libvirtd that
introduced a regression in the libvirtd.conf file handling. When
libvirtd is running as non-root it tries to read
$HOME/.libvirt/libvirtd.conf. Before 0.9.3 it was non-fatal if this
file wasn't there. In 0.9.3 this is fatal.

You can either touch $HOME/.libvirt/libvirtd.conf to avoid the problem
or apply this patches on top of 0.9.3 to fix it

http://libvirt.org/git/?p=libvirt.git;a=commit;h=8e2e47803c0028b42b72c45b81e91de7b0cbb7fe
http://libvirt.org/git/?p=libvirt.git;a=commit;h=a07c81c4d0befc1e92b9cf3ce25260488a6bdcdb

-- 
Matthias Bolte
http://photron.blogspot.com

</body></email><email><emailId>20110715101732</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-07-15 10:17:32-0400</timestampReceived><subject>[libvirt-users] [libvirt] ANNOUNCE: libvirt Perl bindings Sys::Virt 0.9.3 release</subject><body>

I am happy to announce a new release[1] of the libvirt Perl bindings,
Sys::Virt 0.9.3 is available for download:

  http://search.cpan.org/CPAN/authors/id/D/DA/DANBERR/Sys-Virt-0.9.3.tar.gz

Changes in this release

 - Add all new APIs in libvirt 0.9.3
 - Requires libvirt &gt;= 0.9.3

The permanent link for the Sys::Virt package, where all historic releases
can be found, is

  http://search.cpan.org/dist/Sys-Virt/

Thanks to everyone who contributed to this release through testing, bug
reporting, patch submission, etc. I am now caught up to main libvirt
releases and intended to track each new release more promptly in the
future.

Regards,
Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110718103527</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-07-18 10:35:27-0400</timestampReceived><subject>Re: [libvirt-users] Migrate KVM Guest OS failed</subject><body>

于 2011年07月18日 08:54, zhang xintao 写道:
&gt; Dear All
&gt;           I used Virsh  live Migrate KVM Guest OS failed
&gt;           error: unable to set user and group to '104:106' on
&gt; '/mnt/run2/N2-WINDOWS-XP-1':Invalid argument
&gt;
&gt;           /mnt/run2/ is a directory of local nfs server
&gt;           another host using nfs client share this directory
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

commit 62ed801c13787cc844e75db7cd2d4c8a42454fcc
Author: Laine Stump&lt;laine@laine.org&gt;
Date:   Fri Jun 3 11:59:09 2011 -0400

     security driver: ignore EINVAL when chowning an image file

     This fixes:

       https://bugzilla.redhat.com/show_bug.cgi?id=702044
       https://bugzilla.redhat.com/show_bug.cgi?id=709454

     Both of these complain of a failure to use an image file that resides
     on a read-only NFS volume. The function in the DAC security driver
     that chowns image files to the qemu user:group before using them
     already has special cases to ignore failure of chown on read-only file
     systems, and in a few other cases, but it hadn't been checking for
     EINVAL, which is what is returned if the qemu user doesn't even exist
     on the NFS server.

     Since the explanation of EINVAL in the chown man page almost exactly
     matches the log message already present for the case of EOPNOTSUPP,

     I've just added EINVAL to that same conditional.


The above commit fixed your problem, you might mount the nfs on the dest

host in readonly mode. So you have two choices to work around the problem, 1) update
libvirt with this fix, unfortunately, the fix is in realeases since 0.9.2. 2) mount
your nfs in proper permission mode on destination host.

Regards
Osier

</body></email><email><emailId>20110719081222</emailId><senderName>"sharmila radha krishnan"</senderName><senderEmail>sharmilaradhakrishnan@rediffmail.com</senderEmail><timestampReceived>2011-07-19 08:12:22-0400</timestampReceived><subject>Re: [libvirt-users] =?utf-8?q?Is_libvirt_supported_on_Citrix_Xenserve?= =?utf-8?q?r=3F?=</subject><body>

Hi,
 I was finally able to connect to the xenapi hypervisor using virsh of libvirt \
0.9.2.  However, once I connect to virsh and give a 'quit' command I \
get  "* glibc detected *** virsh: double free or corruption (fasttop):". Please \
find below the actual memory dump.  
Note: I have disabled the SSL certificate verification in xenapi_driver.c \
by setting curl_easy_setopt(curl, CURLOPT_SSL_VERIFYPEER, 0) &amp; \
curl_easy_setopt(curl, CURLOPT_SSL_VERIFYHOST, 0).  
 

[root@sharmila libvirt-0.9.2]# virsh -c "xenapi://localhost"
Enter username for localhost: root
Enter root's password for localhost: 
Welcome to virsh, the virtualization interactive terminal.
  
Type:  'help' for help with commands
       'quit' to quit
  
virsh # list --all
 Id Name                 \
                State
----------------------------------
  0 Control domain on host: sharmila running
  - Control domain on host: sharmila running
  - XenServer SDK 5.6.100-47101p import shut off
  
virsh # quit
  
*** glibc detected *** virsh: double free or corruption (fasttop): 0x09fcc370 ***
======= Backtrace: =========
/lib/libc.so.6[0xb6fc56c5]
/lib/libc.so.6(cfree+0x59)[0xb6fc5b09]
/usr/local/lib/libvirt.so.0(virFree+0x42)[0xb760d712]
/usr/local/lib/libvirt.so.0[0xb777031d]
/usr/local/lib/libvirt.so.0[0xb776ec10]
/usr/local/lib/libvirt.so.0[0xb7676017]
/usr/local/lib/libvirt.so.0(virUnrefConnect+0x128)[0xb7677888]
/usr/local/lib/libvirt.so.0(virConnectClose+0xda)[0xb769ad4a]
virsh[0x8065c73]
virsh[0x806672f]
/lib/libc.so.6(__libc_start_main+0xdc)[0xb6f71e9c]
virsh[0x804e0f1]
======= Memory map: ========
08048000-08079000 r-xp 00000000 08:01 378273     \
/usr/local/bin/virsh 08079000-0807a000 rw-p 00031000 08:01 \
378273     /usr/local/bin/virsh 09fa1000-0a060000 rw-p 00000000 \
00:00 0          [heap] \
b6b61000-b6b6c000 r-xp 00000000 08:01 182153     \
/lib/libgcc_s-4.1.2-20080825.so.1 b6b6c000-b6b6d000 rw-p 0000a000 08:01 \
182153     /lib/libgcc_s-4.1.2-20080825.so.1 b6b6d000-b6b77000 \
r-xp 00000000 08:01 181027     /lib/libnss_files-2.5.so \
b6b77000-b6b78000 r--p 00009000 08:01 181027     \
/lib/libnss_files-2.5.so b6b78000-b6b79000 rw-p 0000a000 08:01 \
181027     /lib/libnss_files-2.5.so b6b81000-b6b83000 rw-p \
00000000 00:00 0  b6b83000-b6d83000 r--p 00000000 08:01 \
447132     /usr/lib/locale/locale-archive b6d83000-b6d86000 rw-p \
00000000 00:00 0  b6d86000-b6d88000 r-xp 00000000 08:01 \
180820     /lib/libkeyutils-1.2.so b6d88000-b6d89000 rw-p \
00001000 08:01 180820     /lib/libkeyutils-1.2.so \
b6d89000-b6d91000 r-xp 00000000 08:01 377484     \
/usr/lib/libkrb5support.so.0.1 b6d91000-b6d92000 rw-p 00007000 08:01 \
377484     /usr/lib/libkrb5support.so.0.1 b6d92000-b6d99000 r-xp \
00000000 08:01 182148     /lib/librt-2.5.so b6d99000-b6d9a000 \
r--p 00007000 08:01 182148     /lib/librt-2.5.so \
b6d9a000-b6d9b000 rw-p 00008000 08:01 182148     \
/lib/librt-2.5.so b6d9b000-b6dab000 r-xp 00000000 08:01 \
180816     /lib/libresolv-2.5.so b6dab000-b6dac000 r--p 0000f000 \
08:01 180816     /lib/libresolv-2.5.so b6dac000-b6dad000 rw-p \
00010000 08:01 180816     /lib/libresolv-2.5.so b6dad000-b6daf000 \
rw-p 00000000 00:00 0  b6daf000-b6ddf000 r-xp 00000000 08:01 \
378111     /usr/lib/libidn.so.11.5.19 b6ddf000-b6de0000 rw-p \
0002f000 08:01 378111     /usr/lib/libidn.so.11.5.19 \
b6de0000-b6de1000 rw-p 00000000 00:00 0  b6de1000-b6de3000 r-xp 00000000 08:01 \
180823     /lib/libcom_err.so.2.1 b6de3000-b6de4000 rw-p 00001000 \
08:01 180823     /lib/libcom_err.so.2.1 b6de4000-b6e0a000 r-xp \
00000000 08:01 378185     /usr/lib/libk5crypto.so.3.1 \
b6e0a000-b6e0b000 rw-p 00025000 08:01 378185     \
/usr/lib/libk5crypto.so.3.1 b6e0b000-b6e9f000 r-xp 00000000 08:01 \
378198     /usr/lib/libkrb5.so.3.3 b6e9f000-b6ea2000 rw-p \
00093000 08:01 378198     /usr/lib/libkrb5.so.3.3 \
b6ea2000-b6ece000 r-xp 00000000 08:01 378160     \
/usr/lib/libgssapi_krb5.so.2.2 b6ece000-b6ecf000 rw-p 0002c000 08:01 \
378160     /usr/lib/libgssapi_krb5.so.2.2 b6ecf000-b6ed2000 r-xp \
00000000 08:01 377492     /usr/lib/libgpg-error.so.0.3.0 \
b6ed2000-b6ed3000 rw-p 00002000 08:01 377492     \
/usr/lib/libgpg-error.so.0.3.0 b6ed3000-b6ed4000 rw-p 00000000 00:00 0 
b6ed4000-b6f0f000 r-xp 00000000 08:01 182149     \
/lib/libsepol.so.1 b6f0f000-b6f10000 rw-p 0003b000 08:01 \
182149     /lib/libsepol.so.1 b6f10000-b6f1a000 rw-p 00000000 \
00:00 0  b6f1a000-b6f5a000 r-xp 00000000 08:01 378242     \
/usr/local/lib/libcurl.so.4.1.0 b6f5a000-b6f5b000 rw-p 00040000 08:01 \
378242     /usr/local/lib/libcurl.so.4.1.0 b6f5b000-b6f5c000 rw-p \
00000000 00:00 0  b6f5c000-b70af000 r-xp 00000000 08:01 \
180994     /lib/libc-2.5.so b70af000-b70b1000 r--p 00153000 08:01 \
180994     /lib/libc-2.5.so b70b1000-b70b2000 rw-p 00155000 08:01 \
180994     /lib/libc-2.5.so b70b2000-b70b5000 rw-p 00000000 00:00 \
0  b70b5000-b70b8000 r-xp 00000000 08:01 180979     \
/lib/libdl-2.5.so b70b8000-b70b9000 r--p 00002000 08:01 \
180979     /lib/libdl-2.5.so b70b9000-b70ba000 rw-p 00003000 \
08:01 180979     /lib/libdl-2.5.so b70ba000-b70e1000 r-xp \
00000000 08:01 182017     /lib/libm-2.5.so b70e1000-b70e2000 r--p \
00026000 08:01 182017     /lib/libm-2.5.so b70e2000-b70e3000 rw-p \
00027000 08:01 182017     /lib/libm-2.5.so b70e3000-b70e4000 rw-p \
00000000 00:00 0  b70e4000-b70f6000 r-xp 00000000 08:01 \
378165     /usr/lib/libz.so.1.2.3 b70f6000-b70f7000 rw-p 00011000 \
08:01 378165     /usr/lib/libz.so.1.2.3 b70f7000-b7223000 r-xp \
00000000 08:01 378174     /usr/lib/libxml2.so.2.6.26 \
b7223000-b7228000 rw-p 0012c000 08:01 378174     \
/usr/lib/libxml2.so.2.6.26 b7228000-b7229000 rw-p 00000000 00:00 0 
b7229000-b723e000 r-xp 00000000 08:01 181033     \
/lib/libpthread-2.5.so b723e000-b723f000 r--p 00015000 08:01 \
181033     /lib/libpthread-2.5.so b723f000-b7240000 rw-p 00016000 \
08:01 181033     /lib/libpthread-2.5.so b7240000-b7242000 rw-p \
00000000 00:00 0  b7242000-b7258000 r-xp 00000000 08:01 \
181005     /lib/libselinux.so.1 b7258000-b725a000 rw-p 00015000 \
08:01 181005     /lib/libselinux.so.1 b725a000-b7389000 r-xp \
00000000 08:01 182129     /lib/libcrypto.so.0.9.8e \
b7389000-b739c000 rw-p 0012e000 08:01 182129     \
/lib/libcrypto.so.0.9.8e b739c000-b73a0000 rw-p 00000000 00:00 0 
b73a0000-b73e4000 r-xp 00000000 08:01 180822     \
/lib/libssl.so.0.9.8e b73e4000-b73e8000 rw-p 00043000 08:01 \
180822     /lib/libssl.so.0.9.8e b73e8000-b7419000 r-xp 00000000 \
08:01 383239     /usr/lib/libcurl.so.3.0.0 b7419000-b741a000 rw-p \
00031000 08:01 383239     /usr/lib/libcurl.so.3.0.0 \
b741a000-b741b000 rw-p 00000000 00:00 0  b741b000-b747b000 r-xp 00000000 08:01 \
378267     /usr/lib/libxenserver.so.1.3 b747b000-b747f000 rw-p \
00060000 08:01 378267     /usr/lib/libxenserver.so.1.3 \
b747f000-b74a3000 r-xp 00000000 08:01 383129     \
/usr/lib/libssh2.so.1.0.1 b74a3000-b74a4000 rw-p 00024000 08:01 \
383129     /usr/lib/libssh2.so.1.0.1 b74a4000-b74a8000 r-xp \
00000000 08:01 376977     /usr/lib/libxenstore.so.3.0.0 \
b74a8000-b74a9000 rw-p 00003000 08:01 376977     \
/usr/lib/libxenstore.so.3.0.0 b74a9000-b74ac000 rw-p 00000000 00:00 0 
b74ac000-b752a000 r-xp 00000000 08:01 378181     \
/usr/lib/libgcrypt.so.11.5.2 b752a000-b752d000 rw-p 0007d000 08:01 \
378181     /usr/lib/libgcrypt.so.11.5.2 b752d000-b75a6000 r-xp \
00000000 08:01 380857     /usr/lib/libgnutls.so.13.0.6 \
b75a6000-b75ac000 rw-p 00078000 08:01 380857     \
/usr/lib/libgnutls.so.13.0.6 b75ac000-b75ad000 rw-p 00000000 00:00 0 
b75ad000-b75cc000 r-xp 00000000 08:01 180978     \
/lib/libdevmapper.so.1.02 b75cc000-b75ce000 rw-p 0001e000 08:01 \
180978     /lib/libdevmapper.so.1.02 b75cf000-b75d6000 r--s \
00000000 08:01 412913     /usr/lib/gconv/gconv-modules.cache \
b75d6000-b75d7000 r-xp 00000000 08:01 377141     \
/usr/local/lib/libvirt-qemu.so.0.9.2 b75d7000-b75d8000 rw-p 00000000 08:01 \
377141     /usr/local/lib/libvirt-qemu.so.0.9.2Aborted  
 Moreover, Iam not able to start any VMs uisng xencenter after i have started \
using virsh. It says,  Error: Starting VM 'XenServer SDK 5.6.100-47101p import' \
- Internal error: another frontend device is already connected to this domain \
(frontend (domid=0 | kind=vbd | devid=51712); backend (domid=0 | kind=vbd | \
devid=51712)). Even a reboot of the machine didnt help.  
Any pointers on the above 2 issues would be of great help.
 
Thanks in Advance!
 
Regards,
SharmilaFrom: "G Naresh Kumar"naresh.gadepalli@gmail.comSent: Sat, 16 Jul 2011 \
16:55:16 +0530To: Matthias Bolte matthias.bolte@googlemail.comCc: \
libvirt-users@redhat.comSubject: Re: [libvirt-users] Is libvirt supported on Citrix \
Xenserver?Hi Matthias,  &gt;


Sorry for the confusion.It was an edited one &amp; hence thetypo. Below is the 
actual output:

# virsh -c xenapi://&lt;myip&gt;
Enter username for &lt;myip&gt;: root
Enter root's password for &lt;myip&gt;: 
error: authentication failed: (null)

I was not able to get anything in the Xen logs. Somehowfigured out to print 
the Xen error using the patch given at the link http://osdir.com/ml/libvir-
list/2011-06/msg00298.html. It prints"TRANSPORT_FAULT". Any pointers to this 
error would be much appreciated. Iam also trying to debugthis issue.

As per your suggestion,
I had used make rpm. But it requires xen-devel pacakge,which I was 
not able to get for Xen 3.4.2. Is there any way where I canuse the source 
package and build &amp; install the library without using'make rpm' ? 

Thanks for all the help.
&gt;
Regards
Naresh&gt; 
On Thu, Jul 14, 2011 at 7:07 PM, Matthias Bolte &lt;matthias.bolte@googlemail.com&gt; \
wrote:&gt;  2011/7/14 G Naresh Kumar &lt;naresh.gadepalli@gmail.com&gt;:&gt;&gt; Hi \
Maththias,&gt;  &gt; Thanks for the help. I finally was able to compile/install \
libvirt on&gt;&gt; xenserver.&gt;&gt;&gt;&gt; I tried compiling the libvirt 0.9.2 \
with xen api support. Was able to&gt;&gt; install it successfully. When I tried \
giving the virsh command, I got an&gt;&gt; ‘authentication failed' error as shown \
below.&gt;&gt;&gt;&gt; # virsh -c xenapi://&lt;my local ip&gt;&gt;&gt; Enter username \
for &lt;mylocalip&gt;: root&gt;&gt;Here you entered root&gt;  &gt;&gt; Enter \
intel123's password for &lt;my local ip&gt;:&gt;&gt;but here it asks for intel123's, \
that's unexpected. Did you edit this&gt;one before mailing it, or is there really \
this mismatch?&gt;&gt;&gt; error: authentication failed: (null)&gt;&gt;Outputting \
(null) here is actually a bug. The only way this can happen&gt;is when the login \
attempt fails but the XenServer doesn't provide an&gt;error message. Maybe have a \
look at the XenServer logs to see if it&gt;says something about a failed login \
attempt.&gt;  &gt;&gt; I also tried connecting to the local machine as \
below,&gt;&gt;&gt;&gt; virsh -c "xenapi:///"&gt;&gt; error: authentication failed: \
Server name not in URI&gt;&gt; error: failed to connect to the hypervisor&gt;&gt;The \
XenAPI driver expects a server name. xenapi:/// _could_ be treated&gt;as \
xenapi://localhost, but it's not implemented that way.&gt;  &gt;&gt; Also I am trying \
to install ruby-libvirt on xenserver, which looks like&gt;&gt; requires libvirt-devel \
package to be installed. How do I build it from the&gt;&gt; libvirt 0.9.2 source \
package.&gt;&gt;Running 'make rpm' should build an libvirt-devel RPM package for \
you.&gt; 


&gt;&gt; Thanks,&gt;&gt;&gt;&gt; Naresh&gt;&gt;&gt;&gt; On Wed, Jun 15, 2011 at 8:19 \
PM, Matthias Bolte&gt;&gt; &lt;matthias.bolte@googlemail.com&gt; \
wrote:&gt;&gt;&gt;&gt;&gt;&gt; 2011/6/15 G Naresh Kumar \
&lt;naresh.gadepalli@gmail.com&gt;:&gt;&gt;&gt; &gt; Hi Maththias,&gt;&gt;&gt; \
&gt;&gt;&gt;&gt; &gt; Thanks a lot for your response!.&gt;&gt;&gt; &gt;&gt;&gt;&gt; \
&gt; Is there a specific version of libvirt from which xenserver support \
is&gt;&gt;&gt; &gt; added? I am getting the below error&gt;&gt;&gt; &gt;&gt;&gt;&gt; \
&gt; "error: invalid argument in libvirt was built without the 'xenapi'&gt;&gt;&gt; \
&gt; driver"&gt;&gt;&gt;&gt;&gt;&gt; The means that your libvirt version is new \
enough and contains the&gt;&gt;&gt; XenAPI driver but that it was disabled on \
configure time, probably&gt;&gt;&gt; because the build server didn't have \
libxenserver installed and&gt;&gt;&gt; libvirt's configure script automatically \
disabled the driver because&gt;&gt;&gt; of a missing dependency.&amp;g!  \
t;&gt;&gt;&gt;&gt;&gt; &gt; I have installed libvirt from citrix yum \
repo.&gt;&gt;&gt;&gt;&gt;&gt; Then Citrix build libvirt without XenAPI support. As a \
long term&gt;&gt;&gt; solution you could report to whom ever is responsible for that \
repo&gt;&gt;&gt; and request to enabled XenAPI support in that libvirt package. As \
a&gt;&gt;&gt; short term solution you could build libvirt from source yourself \
and&gt;&gt;&gt; make sure to get the XenAPI driver enabled.&gt;&gt;&gt;&gt;&gt;&gt; \
&gt; I am using Xenserver 5.5 with libvirt 0.8.2 and it does not seem to \
be&gt;&gt;&gt; &gt; working.&gt;&gt;&gt;&gt;&gt;&gt; According to \
http://libvirt.org/hvsupport.html and the error message&gt;&gt;&gt; 0.8.2 is new \
enough.&gt;&gt;&gt;&gt;&gt;&gt; Matthias&gt;&gt;&gt;&gt;&gt;&gt; &gt; \
Thanks,&gt;&gt;&gt; &gt;&gt;&gt;&gt; &gt; Naresh&gt;&gt;&gt; &gt;&gt;&gt;&gt; &gt; On \
Jun 15, 2011 7:03 PM, "Matthias Bolte"&gt;&gt;&gt; &gt; \
&lt;matthias.bolte@googlemail.com&gt;&gt;&gt;&gt; &gt; wrote:&gt;&gt;&amp;g!  t; &gt;&gt; \
2011/6/15 G Naresh Kumar &lt;naresh.gadepalli@gmai!  l.com&gt;:&gt;&gt;&gt; \
&gt;&gt;&gt; Hi,&gt;&gt;&gt; &gt;&gt;&gt; Is libvirt supported on Citrix Xenserver. I \
have been searching for&gt;&gt;&gt; &gt;&gt;&gt; the&gt;&gt;&gt; &gt;&gt;&gt; \
same&gt;&gt;&gt; &gt;&gt;&gt; with little/no luck.&gt;&gt;&gt; &gt;&gt;&gt; If \
supported, can you point to some links/documents which can help me&gt;&gt;&gt; \
&gt;&gt;&gt; try&gt;&gt;&gt; &gt;&gt;&gt; out the same.&gt;&gt;&gt; &gt;&gt;&gt; \
Thanks,&gt;&gt;&gt; &gt;&gt;&gt; Naresh&gt;&gt;&gt; &gt;&gt;&gt;&gt;&gt; &gt;&gt; \
libvirt can use XenAPI via libxenserver [1]. That should allow you to&gt;&gt;&gt; \
&gt;&gt; use libvirt with a Citrix XenServer. You can use virsh like this&gt;&gt;&gt; \
&gt;&gt; assuming you have a libxenserver enabled libvirt:&gt;&gt;&gt; \
&gt;&gt;&gt;&gt;&gt; &gt;&gt; virsh -c xenapi://my-xen-server&gt;&gt;&gt; \
&gt;&gt;&gt;&gt;&gt; &gt;&gt; But it's true, there is no documentation about this on \
the libvirt&gt;&gt;&gt; &gt;&gt; website&gt;&gt;&gt; &gt;&gt; yet.&gt;&gt;&gt; &gt;!  \
;&gt;&gt;&gt;&gt; &gt;&gt; [1] \
http://community.citrix.com/display/xs/Download+SDKs&gt;&gt;&gt; &gt;&gt;&gt;&gt;&gt; \
&gt;&gt; --&gt;&gt;&gt; &gt;&gt; Matthias Bolte&gt;&gt;&gt; &gt;&gt; \
http://photron.blogspot.com&gt;&gt;&gt; &gt;&gt;&gt; --&gt;&gt; I was an atheist till \
I realized I am GOD&gt;&gt;&gt;&gt;--&gt; 


Matthias Bolte&gt;http://photron.blogspot.com&gt;&gt;&gt;-- &gt;I was an atheist till \
I realized I am GOD&gt;_______________________________________________&gt;libvirt-users \
mailing list&gt;libvirt-users@redhat.com&gt;https://www.redhat.com/mailman/listinfo/libvirt-users



[Attachment #3 (unknown)]

&lt;DIV&gt;Hi,&lt;/DIV&gt;
&lt;DIV&gt; I was finally able to connect to the xenapi hypervisor using virsh of \
libvirt 0.9.2.  However, once I connect to virsh and give a 'quit' command \
I get  "* glibc detected *** virsh: double free or corruption (fasttop):". \
Please find below the actual memory dump.&lt;/DIV&gt; &lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;&lt;STRONG&gt;&lt;EM&gt;Note:&lt;/EM&gt;&lt;/STRONG&gt; I have disabled the SSL certificate verification \
in xenapi_driver.c by setting curl_easy_setopt(curl, CURLOPT_SSL_VERIFYPEER, 0) \
&amp; curl_easy_setopt(curl, CURLOPT_SSL_VERIFYHOST, 0).&lt;/DIV&gt; &lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;BLOCKQUOTE style="MARGIN-RIGHT: 0px" dir=ltr&gt;
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;[root@sharmila libvirt-0.9.2]# virsh -c \
"xenapi://localhost"&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;Enter username for \
localhost: root&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;Enter root's password for \
localhost: &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;Welcome to virsh, the \
virtualization interactive terminal.&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;  &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;Type:  'help' \
for help with commands&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;       'quit' to quit&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;  &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;virsh # \
list --all&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt; Id \
Name                 \
State&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;----------------------------------&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;  0 Control domain on host: sharmila running&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;  - Control domain on host: sharmila \
running&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;  - XenServer SDK 5.6.100-47101p \
import shut off&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;  &lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;virsh # quit&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;  &lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;*** glibc detected *** virsh: double free or corruption \
(fasttop): 0x09fcc370 ***&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;======= Backtrace: \
=========&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;/lib/&lt;a href='http://libc.so'&gt;&lt;FONT \
color=#0055cc&gt;libc.so&lt;/FONT&gt;&lt;/a&gt;.6[0xb6fc56c5]&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;/lib/&lt;a href='http://libc.so'&gt;&lt;FONT \
color=#0055cc&gt;libc.so&lt;/FONT&gt;&lt;/a&gt;.6(cfree+0x59)[0xb6fc5b09]&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;/usr/local/lib/&lt;a href='http://libvirt.so'&gt;&lt;FONT \
color=#0055cc&gt;libvirt.so&lt;/FONT&gt;&lt;/a&gt;.0(virFree+0x42)[0xb760d712]&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;/usr/local/lib/&lt;a href='http://libvirt.so'&gt;&lt;FONT \
color=#0055cc&gt;libvirt.so&lt;/FONT&gt;&lt;/a&gt;.0[0xb777031d]&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;/usr/local/lib/&lt;a href='http://libvirt.so'&gt;&lt;FONT \
color=#0055cc&gt;libvirt.so&lt;/FONT&gt;&lt;/a&gt;.0[0xb776ec10]&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;/usr/local/lib/&lt;a href='http://libvirt.so'&gt;&lt;FONT \
color=#0055cc&gt;libvirt.so&lt;/FONT&gt;&lt;/a&gt;.0[0xb7676017]&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;/usr/local/lib/&lt;a href='http://libvirt.so'&gt;&lt;FONT \
color=#0055cc&gt;libvirt.so&lt;/FONT&gt;&lt;/a&gt;.0(virUnrefConnect+0x128)[0xb7677888]&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;/usr/local/lib/&lt;a href='http://libvirt.so'&gt;&lt;FONT \
color=#0055cc&gt;libvirt.so&lt;/FONT&gt;&lt;/a&gt;.0(virConnectClose+0xda)[0xb769ad4a]&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;virsh[0x8065c73]&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;virsh[0x806672f]&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;/lib/&lt;a \
href='http://libc.so'&gt;&lt;FONT \
color=#0055cc&gt;libc.so&lt;/FONT&gt;&lt;/a&gt;.6(__libc_start_main+0xdc)[0xb6f71e9c]&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;virsh[0x804e0f1]&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;======= Memory map: ========&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;08048000-08079000 r-xp 00000000 08:01 378273     \
/usr/local/bin/virsh&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;08079000-0807a000 rw-p \
00031000 08:01 378273     /usr/local/bin/virsh&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;09fa1000-0a060000 rw-p 00000000 00:00 \
0          [heap]&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6b61000-b6b6c000 r-xp 00000000 08:01 \
182153     /lib/libgcc_s-4.1.2-2008082&lt;a href='http://5.so'&gt;&lt;FONT \
color=#0055cc&gt;5.so&lt;/FONT&gt;&lt;/a&gt;.1&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6b6c000-b6b6d000 rw-p 0000a000 08:01 182153     \
/lib/libgcc_s-4.1.2-2008082&lt;a href='http://5.so'&gt;&lt;FONT \
color=#0055cc&gt;5.so&lt;/FONT&gt;&lt;/a&gt;.1&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6b6d000-b6b77000 r-xp 00000000 08:01 181027     \
/lib/libnss_files-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6b77000-b6b78000 r--p \
00009000 08:01 181027     /lib/libnss_files-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6b78000-b6b79000 rw-p 0000a000 08:01 \
181027     /lib/libnss_files-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6b81000-b6b83000 rw-p 00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6b83000-b6d83000 r--p 00000000 08:01 447132     \
/usr/lib/locale/locale-archive&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6d83000-b6d86000 rw-p 00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6d86000-b6d88000 r-xp 00000000 08:01 180820     \
/lib/libkeyutils-1.2.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6d88000-b6d89000 rw-p \
00001000 08:01 180820     /lib/libkeyutils-1.2.so&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6d89000-b6d91000 r-xp 00000000 08:01 \
377484     /usr/lib/&lt;a href='http://libkrb5support.so'&gt;&lt;FONT \
color=#0055cc&gt;libkrb5support.so&lt;/FONT&gt;&lt;/a&gt;.0.1&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6d91000-b6d92000 rw-p 00007000 08:01 377484     \
/usr/lib/&lt;a href='http://libkrb5support.so'&gt;&lt;FONT \
color=#0055cc&gt;libkrb5support.so&lt;/FONT&gt;&lt;/a&gt;.0.1&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6d92000-b6d99000 r-xp 00000000 08:01 182148     \
/lib/librt-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6d99000-b6d9a000 r--p \
00007000 08:01 182148     /lib/librt-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6d9a000-b6d9b000 rw-p 00008000 08:01 \
182148     /lib/librt-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6d9b000-b6dab000 r-xp 00000000 08:01 180816     \
/lib/libresolv-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6dab000-b6dac000 r--p \
0000f000 08:01 180816     /lib/libresolv-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6dac000-b6dad000 rw-p 00010000 08:01 \
180816     /lib/libresolv-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6dad000-b6daf000 rw-p 00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6daf000-b6ddf000 r-xp 00000000 08:01 378111     \
/usr/lib/libidn.so.11.5.19&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6ddf000-b6de0000 \
rw-p 0002f000 08:01 378111     \
/usr/lib/libidn.so.11.5.19&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6de0000-b6de1000 \
rw-p 00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6de1000-b6de3000 r-xp \
00000000 08:01 180823     /lib/libcom_&lt;a \
href='http://err.so'&gt;&lt;FONT color=#0055cc&gt;err.so&lt;/FONT&gt;&lt;/a&gt;.2.1&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b6de3000-b6de4000 rw-p 00001000 08:01 \
180823     /lib/libcom_&lt;a href='http://err.so'&gt;&lt;FONT \
color=#0055cc&gt;err.so&lt;/FONT&gt;&lt;/a&gt;.2.1&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6de4000-b6e0a000 r-xp 00000000 08:01 378185     \
/usr/lib/&lt;a href='http://libk5crypto.so'&gt;&lt;FONT \
color=#0055cc&gt;libk5crypto.so&lt;/FONT&gt;&lt;/a&gt;.3.1&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6e0a000-b6e0b000 rw-p 00025000 08:01 378185     \
/usr/lib/&lt;a href='http://libk5crypto.so'&gt;&lt;FONT \
color=#0055cc&gt;libk5crypto.so&lt;/FONT&gt;&lt;/a&gt;.3.1&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6e0b000-b6e9f000 r-xp 00000000 08:01 378198     \
/usr/lib/libkrb&lt;a href='http://5.so'&gt;&lt;FONT \
color=#0055cc&gt;5.so&lt;/FONT&gt;&lt;/a&gt;.3.3&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6e9f000-b6ea2000 rw-p 00093000 08:01 378198     \
/usr/lib/libkrb&lt;a href='http://5.so'&gt;&lt;FONT \
color=#0055cc&gt;5.so&lt;/FONT&gt;&lt;/a&gt;.3.3&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6ea2000-b6ece000 r-xp 00000000 08:01 378160     \
/usr/lib/libgssapi_krb&lt;a href='http://5.so'&gt;&lt;FONT \
color=#0055cc&gt;5.so&lt;/FONT&gt;&lt;/a&gt;.2.2&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6ece000-b6ecf000 rw-p 0002c000 08:01 378160     \
/usr/lib/libgssapi_krb&lt;a href='http://5.so'&gt;&lt;FONT \
color=#0055cc&gt;5.so&lt;/FONT&gt;&lt;/a&gt;.2.2&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6ecf000-b6ed2000 r-xp 00000000 08:01 377492     \
/usr/lib/&lt;a href='http://libgpg-error.so'&gt;&lt;FONT \
color=#0055cc&gt;libgpg-error.so&lt;/FONT&gt;&lt;/a&gt;.0.3.0&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6ed2000-b6ed3000 rw-p 00002000 08:01 377492     \
/usr/lib/&lt;a href='http://libgpg-error.so'&gt;&lt;FONT \
color=#0055cc&gt;libgpg-error.so&lt;/FONT&gt;&lt;/a&gt;.0.3.0&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6ed3000-b6ed4000 rw-p 00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6ed4000-b6f0f000 r-xp 00000000 08:01 182149     \
/lib/&lt;a href='http://libsepol.so'&gt;&lt;FONT \
color=#0055cc&gt;libsepol.so&lt;/FONT&gt;&lt;/a&gt;.1&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6f0f000-b6f10000 rw-p 0003b000 08:01 182149     \
/lib/&lt;a href='http://libsepol.so'&gt;&lt;FONT \
color=#0055cc&gt;libsepol.so&lt;/FONT&gt;&lt;/a&gt;.1&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6f10000-b6f1a000 rw-p 00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6f1a000-b6f5a000 r-xp 00000000 08:01 378242     \
/usr/local/lib/&lt;a href='http://libcurl.so'&gt;&lt;FONT \
color=#0055cc&gt;libcurl.so&lt;/FONT&gt;&lt;/a&gt;.4.1.0&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6f5a000-b6f5b000 rw-p 00040000 08:01 378242     \
/usr/local/lib/&lt;a href='http://libcurl.so'&gt;&lt;FONT \
color=#0055cc&gt;libcurl.so&lt;/FONT&gt;&lt;/a&gt;.4.1.0&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6f5b000-b6f5c000 rw-p 00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b6f5c000-b70af000 r-xp 00000000 08:01 180994     \
/lib/libc-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b70af000-b70b1000 r--p \
00153000 08:01 180994     /lib/libc-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b70b1000-b70b2000 rw-p 00155000 08:01 \
180994     /lib/libc-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b70b2000-b70b5000 rw-p 00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b70b5000-b70b8000 r-xp 00000000 08:01 180979     \
/lib/libdl-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b70b8000-b70b9000 r--p \
00002000 08:01 180979     /lib/libdl-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b70b9000-b70ba000 rw-p 00003000 08:01 \
180979     /lib/libdl-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b70ba000-b70e1000 r-xp 00000000 08:01 182017     \
/lib/libm-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b70e1000-b70e2000 r--p \
00026000 08:01 182017     /lib/libm-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b70e2000-b70e3000 rw-p 00027000 08:01 \
182017     /lib/libm-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b70e3000-b70e4000 rw-p 00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b70e4000-b70f6000 r-xp 00000000 08:01 378165     \
/usr/lib/&lt;a href='http://libz.so'&gt;&lt;FONT \
color=#0055cc&gt;libz.so&lt;/FONT&gt;&lt;/a&gt;.1.2.3&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b70f6000-b70f7000 rw-p 00011000 08:01 378165     \
/usr/lib/&lt;a href='http://libz.so'&gt;&lt;FONT \
color=#0055cc&gt;libz.so&lt;/FONT&gt;&lt;/a&gt;.1.2.3&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b70f7000-b7223000 r-xp 00000000 08:01 378174     \
/usr/lib/libxml&lt;a href='http://2.so'&gt;&lt;FONT \
color=#0055cc&gt;2.so&lt;/FONT&gt;&lt;/a&gt;.2.6.26&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b7223000-b7228000 rw-p 0012c000 08:01 378174     \
/usr/lib/libxml&lt;a href='http://2.so'&gt;&lt;FONT \
color=#0055cc&gt;2.so&lt;/FONT&gt;&lt;/a&gt;.2.6.26&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b7228000-b7229000 rw-p 00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b7229000-b723e000 r-xp 00000000 08:01 181033     \
/lib/libpthread-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b723e000-b723f000 r--p \
00015000 08:01 181033     /lib/libpthread-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b723f000-b7240000 rw-p 00016000 08:01 \
181033     /lib/libpthread-2.5.so&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b7240000-b7242000 rw-p 00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b7242000-b7258000 r-xp 00000000 08:01 181005     \
/lib/&lt;a href='http://libselinux.so'&gt;&lt;FONT \
color=#0055cc&gt;libselinux.so&lt;/FONT&gt;&lt;/a&gt;.1&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b7258000-b725a000 rw-p 00015000 08:01 181005     \
/lib/&lt;a href='http://libselinux.so'&gt;&lt;FONT \
color=#0055cc&gt;libselinux.so&lt;/FONT&gt;&lt;/a&gt;.1&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b725a000-b7389000 r-xp 00000000 08:01 182129     \
/lib/&lt;a href='http://libcrypto.so'&gt;&lt;FONT \
color=#0055cc&gt;libcrypto.so&lt;/FONT&gt;&lt;/a&gt;.0.9.8e&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b7389000-b739c000 rw-p 0012e000 08:01 182129     \
/lib/&lt;a href='http://libcrypto.so'&gt;&lt;FONT \
color=#0055cc&gt;libcrypto.so&lt;/FONT&gt;&lt;/a&gt;.0.9.8e&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b739c000-b73a0000 rw-p 00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b73a0000-b73e4000 r-xp 00000000 08:01 180822     \
/lib/&lt;a href='http://libssl.so'&gt;&lt;FONT \
color=#0055cc&gt;libssl.so&lt;/FONT&gt;&lt;/a&gt;.0.9.8e&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b73e4000-b73e8000 rw-p 00043000 08:01 180822     \
/lib/&lt;a href='http://libssl.so'&gt;&lt;FONT \
color=#0055cc&gt;libssl.so&lt;/FONT&gt;&lt;/a&gt;.0.9.8e&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b73e8000-b7419000 r-xp 00000000 08:01 383239     \
/usr/lib/&lt;a href='http://libcurl.so'&gt;&lt;FONT \
color=#0055cc&gt;libcurl.so&lt;/FONT&gt;&lt;/a&gt;.3.0.0&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b7419000-b741a000 rw-p 00031000 08:01 383239     \
/usr/lib/&lt;a href='http://libcurl.so'&gt;&lt;FONT \
color=#0055cc&gt;libcurl.so&lt;/FONT&gt;&lt;/a&gt;.3.0.0&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b741a000-b741b000 rw-p 00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b741b000-b747b000 r-xp 00000000 08:01 378267     \
/usr/lib/&lt;a href='http://libxenserver.so'&gt;&lt;FONT \
color=#0055cc&gt;libxenserver.so&lt;/FONT&gt;&lt;/a&gt;.1.3&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b747b000-b747f000 rw-p 00060000 08:01 378267     \
/usr/lib/&lt;a href='http://libxenserver.so'&gt;&lt;FONT \
color=#0055cc&gt;libxenserver.so&lt;/FONT&gt;&lt;/a&gt;.1.3&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b747f000-b74a3000 r-xp 00000000 08:01 383129     \
/usr/lib/libssh&lt;a href='http://2.so'&gt;&lt;FONT \
color=#0055cc&gt;2.so&lt;/FONT&gt;&lt;/a&gt;.1.0.1&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b74a3000-b74a4000 rw-p 00024000 08:01 383129     \
/usr/lib/libssh&lt;a href='http://2.so'&gt;&lt;FONT \
color=#0055cc&gt;2.so&lt;/FONT&gt;&lt;/a&gt;.1.0.1&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b74a4000-b74a8000 r-xp 00000000 08:01 376977     \
/usr/lib/&lt;a href='http://libxenstore.so'&gt;&lt;FONT \
color=#0055cc&gt;libxenstore.so&lt;/FONT&gt;&lt;/a&gt;.3.0.0&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b74a8000-b74a9000 rw-p 00003000 08:01 376977     \
/usr/lib/&lt;a href='http://libxenstore.so'&gt;&lt;FONT \
color=#0055cc&gt;libxenstore.so&lt;/FONT&gt;&lt;/a&gt;.3.0.0&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b74a9000-b74ac000 rw-p 00000000 00:00 0 &lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b74ac000-b752a000 r-xp 00000000 08:01 378181     \
/usr/lib/libgcrypt.so.11.5.2&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b752a000-b752d000 \
rw-p 0007d000 08:01 378181     \
/usr/lib/libgcrypt.so.11.5.2&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b752d000-b75a6000 \
r-xp 00000000 08:01 380857     \
/usr/lib/libgnutls.so.13.0.6&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b75a6000-b75ac000 \
rw-p 00078000 08:01 380857     \
/usr/lib/libgnutls.so.13.0.6&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT color=#0000ff&gt;b75ac000-b75ad000 \
&lt;DIV&gt;&lt;FONT color=#0000ff&gt;b75cc000-b75ce000 rw-p 0001e000 08:01 \
180978     /lib/&lt;a href='http://libdevmapper.so'&gt;&lt;FONT \
color=#0055cc&gt;libdevmapper.so&lt;/FONT&gt;&lt;/a&gt;.1.02&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b75cf000-b75d6000 r--s 00000000 08:01 412913     \
/usr/lib/gconv/gconv-modules.cache&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b75d6000-b75d7000 r-xp 00000000 08:01 377141     \
/usr/local/lib/&lt;a href='http://libvirt-qemu.so'&gt;&lt;FONT \
color=#0055cc&gt;libvirt-qemu.so&lt;/FONT&gt;&lt;/a&gt;.0.9.2&lt;/FONT&gt;&lt;/DIV&gt; &lt;DIV&gt;&lt;FONT \
color=#0000ff&gt;b75d7000-b75d8000 rw-p 00000000 08:01 377141     \
/usr/local/lib/&lt;a href='http://libvirt-qemu.so'&gt;&lt;FONT \
color=#0055cc&gt;libvirt-qemu.so&lt;/FONT&gt;&lt;/a&gt;.0.9.2Aborted&lt;/FONT&gt;&lt;/DIV&gt; \
&lt;DIV&gt; &lt;/DIV&gt;&lt;/BLOCKQUOTE&gt; &lt;DIV&gt; Moreover, Iam not able to start any VMs \
uisng xencenter after i have started using virsh. It says,  &lt;STRONG&gt;Error: \
Starting VM 'XenServer SDK 5.6.100-47101p import' - Internal error: another frontend \
device is already connected to this domain (frontend (domid=0 | kind=vbd | \
devid=51712); backend (domid=0 | kind=vbd | devid=51712)).&lt;/STRONG&gt; Even a reboot of \
the machine didnt help.&lt;/DIV&gt; &lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;Any pointers on the above 2 issues would be of great help.&lt;/DIV&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;Thanks in Advance!&lt;/DIV&gt;
&lt;DIV&gt; &lt;/DIV&gt;
&lt;DIV&gt;Regards,&lt;/DIV&gt;
&lt;DIV&gt;Sharmila&lt;/DIV&gt;&lt;BR&gt;&lt;!-- Message \
id:CAL5cDxVUYhN3R_uBh_9hoZ+rgecXds7UxUNeQ2_bbgHqE+vGBQ --&gt;&lt;BR&gt;&lt;BR&gt;From: "G Naresh \
Kumar"naresh.gadepalli@gmail.com&lt;BR&gt;Sent: Sat, 16 Jul 2011 16:55:16 +0530&lt;BR&gt;To: \
Matthias Bolte matthias.bolte@googlemail.com&lt;BR&gt;Cc: \
libvirt-users@redhat.com&lt;BR&gt;Subject: Re: [libvirt-users] Is libvirt supported on \
Citrix Xenserver?&lt;BR&gt;&lt;BR&gt;Hi Matthias,  &lt;DIV&gt;&lt;BR&gt;&gt;&lt;/DIV&gt;
&lt;DIV&gt;
&lt;P cl-ass="MsoNormal"&gt;&lt;/P&gt;
&lt;P cl-ass="MsoNormal"&gt;Sorry for the &lt;a href='http://confusion.It'&gt;confusion.It&lt;/a&gt; \
was an edited one &amp; hence thetypo. Below is the &lt;/P&gt; &lt;P cl-ass="MsoNormal"&gt;actual \
output:&lt;/P&gt; &lt;P cl-ass="MsoNormal"&gt;&lt;/P&gt;
&lt;P cl-ass="MsoNormal"&gt;# virsh -c xenapi://&lt;myip&gt;&lt;/P&gt;
&lt;P cl-ass="MsoNormal"&gt;Enter username for &lt;myip&gt;: root&lt;/P&gt;
&lt;P cl-ass="MsoNormal"&gt;Enter root's password for &lt;myip&gt;: &lt;/P&gt;
&lt;P cl-ass="MsoNormal"&gt;error: authentication failed: (null)&lt;/P&gt;
&lt;P cl-ass="MsoNormal"&gt;&lt;/P&gt;
&lt;P cl-ass="MsoNormal"&gt;I was not able to get anything in the Xen logs. Somehowfigured \
out to print &lt;/P&gt; &lt;P cl-ass="MsoNormal"&gt;the Xen error using the patch given at the \
link &lt;a href='http://osdir.com/ml/libvir-'&gt;http://osdir.com/ml/libvir-&lt;/a&gt;&lt;/P&gt; &lt;P \
cl-ass="MsoNormal"&gt;list/2011-06/msg00298.html. It prints"TRANSPORT_FAULT". Any \
pointers to this &lt;/P&gt; &lt;P cl-ass="MsoNormal"&gt;error would be much appreciated. Iam also \
trying to debugthis issue.&lt;/P&gt; &lt;P cl-ass="MsoNormal"&gt;&lt;/P&gt;
&lt;P cl-ass="MsoNormal"&gt;As per your suggestion,&lt;/P&gt;
&lt;P cl-ass="MsoNormal"&gt;I had used make rpm. But it requires xen-devel pacakge,which I \
was &lt;/P&gt; &lt;P cl-ass="MsoNormal"&gt;not able to get for Xen 3.4.2. Is there any way where \
I canuse the source &lt;/P&gt; &lt;P cl-ass="MsoNormal"&gt;package and build &amp; install the \
library without using'make rpm' ? &lt;/P&gt; &lt;P cl-ass="MsoNormal"&gt;&lt;/P&gt;
&lt;P cl-ass="MsoNormal"&gt;Thanks for all the help.&lt;/P&gt;
&lt;P cl-ass="MsoNormal"&gt;&lt;BR&gt;&gt;&lt;/P&gt;
&lt;P cl-ass="MsoNormal"&gt;Regards&lt;/P&gt;
&lt;P cl-ass="MsoNormal"&gt;Naresh&lt;/P&gt;&lt;BR&gt;&gt; 
&lt;DIV cl-ass="gmail_quote"&gt;On Thu, Jul 14, 2011 at 7:07 PM, Matthias Bolte &lt;SPAN \
dir=ltr&gt;&lt;&lt;A onclick="top.ajaxMail.ext.switchTo('@Compose','mode=mail_to_individual&amp;email=matthias.bolte@googlemail.com');" \
href="javascript:void(0);"&gt;matthias.bolte@googlemail.com&lt;/A&gt;&gt;&lt;/SPAN&gt; \
wrote:&lt;BR&gt;&gt;  &lt;BLOCKQUOTE style="BORDER-LEFT: #ccc 1px solid; MARGIN: 0px 0px 0px \
0.8ex; PADDING-LEFT: 1ex" cl-ass="gmail_quote"&gt;2011/7/14 G Naresh Kumar &lt;&lt;A \
onclick="top.ajaxMail.ext.switchTo('@Compose','mode=mail_to_individual&amp;email=naresh.gadepalli@gmail.com');" \
href="javascript:void(0);"&gt;naresh.gadepalli@gmail.com&lt;/A&gt;&gt;:&lt;BR&gt;&gt;&gt; Hi \
Maththias,&lt;BR&gt;&gt;  &lt;DIV cl-ass="im"&gt;&gt; Thanks for the help. I finally was able to \
compile/install libvirt on&lt;BR&gt;&gt;&gt; xenserver.&lt;BR&gt;&gt;&gt;&lt;BR&gt;&gt;&gt; I tried \
compiling the libvirt 0.9.2 with xen api support. Was able to&lt;BR&gt;&gt;&gt; install it \
successfully. When I tried giving the virsh command, I got an&lt;BR&gt;&gt;&gt; \
‘authentication failed' error as shown below.&lt;BR&gt;&gt;&gt;&lt;BR&gt;&gt;&gt; # virsh -c \
xenapi://&lt;my local ip&gt;&lt;BR&gt;&gt;&gt; Enter username for &lt;mylocalip&gt;: \
root&lt;BR&gt;&gt;&lt;BR&gt;&gt;&lt;/DIV&gt;Here you entered root&lt;BR&gt;&gt;  &lt;DIV \
cl-ass="im"&gt;&lt;BR&gt;&gt;&gt; Enter intel123's password for &lt;my local \
ip&gt;:&lt;BR&gt;&gt;&lt;BR&gt;&gt;&lt;/DIV&gt;but here it asks for intel123's, that's unexpected. Did \
you edit this&lt;BR&gt;&gt;one before mailing it, or is there really this \
mismatch?&lt;BR&gt;&gt;&lt;BR&gt;&gt;&gt; error: authentication failed: \
(null)&lt;BR&gt;&gt;&lt;BR&gt;&gt;Outputting (null) here is actually a bug. The only way this can \
happen&lt;BR&gt;&gt;is when the login attempt fails but the XenServer doesn't provide \
an&lt;BR&gt;&gt;error message. Maybe have a look at the XenServer logs to see if \
it&lt;BR&gt;&gt;says something about a failed login attempt.&lt;BR&gt;&gt;  &lt;DIV \
cl-ass="im"&gt;&lt;BR&gt;&gt;&gt; I also tried connecting to the local machine as \
below,&lt;BR&gt;&gt;&gt;&lt;BR&gt;&gt;&gt; virsh -c "xenapi:///"&lt;BR&gt;&gt;&gt; error: \
authentication failed: Server name not in URI&lt;BR&gt;&gt;&gt; error: failed to connect to \
the hypervisor&lt;BR&gt;&gt;&lt;BR&gt;&gt;&lt;/DIV&gt;The XenAPI driver expects a server name. \
xenapi:/// _could_ be treated&lt;BR&gt;&gt;as xenapi://localhost, but it's not implemented \
that way.&lt;BR&gt;&gt;  &lt;DIV cl-ass="im"&gt;&lt;BR&gt;&gt;&gt; Also I am trying to install \
ruby-libvirt on xenserver, which looks like&lt;BR&gt;&gt;&gt; requires libvirt-devel \
package to be installed. How do I build it from the&lt;BR&gt;&gt;&gt; libvirt 0.9.2 source \
package.&lt;BR&gt;&gt;&lt;BR&gt;&gt;&lt;/DIV&gt;Running 'make rpm' should build an libvirt-devel RPM \
package for you.&lt;BR&gt;&gt;  &lt;DIV&gt;
&lt;DIV&gt;&lt;/DIV&gt;
&lt;DIV cl-ass="h5"&gt;&lt;BR&gt;&gt;&gt; Thanks,&lt;BR&gt;&gt;&gt;&lt;BR&gt;&gt;&gt; \
Naresh&lt;BR&gt;&gt;&gt;&lt;BR&gt;&gt;&gt; On Wed, Jun 15, 2011 at 8:19 PM, Matthias \
Bolte&lt;BR&gt;&gt;&gt; &lt;&lt;A \
onclick="top.ajaxMail.ext.switchTo('@Compose','mode=mail_to_individual&amp;email=matthias.bolte@googlemail.com');" \
href="javascript:void(0);"&gt;matthias.bolte@googlemail.com&lt;/A&gt;&gt; \
wrote:&lt;BR&gt;&gt;&gt;&gt;&lt;BR&gt;&gt;&gt;&gt; 2011/6/15 G Naresh Kumar &lt;&lt;A \
onclick="top.ajaxMail.ext.switchTo('@Compose','mode=mail_to_individual&amp;email=naresh.gadepalli@gmail.com');" \
href="javascript:void(0);"&gt;naresh.gadepalli@gmail.com&lt;/A&gt;&gt;:&lt;BR&gt;&gt;&gt;&gt; &gt; \
Hi Maththias,&lt;BR&gt;&gt;&gt;&gt; &gt;&lt;BR&gt;&gt;&gt;&gt; &gt; Thanks a lot for your \
response!.&lt;BR&gt;&gt;&gt;&gt; &gt;&lt;BR&gt;&gt;&gt;&gt; &gt; Is there a specific version of \
libvirt from which xenserver support is&lt;BR&gt;&gt;&gt;&gt; &gt; added? I am getting the \
below error&lt;BR&gt;&gt;&gt;&gt; &gt;&lt;BR&gt;&gt;&gt;&gt; &gt; "error: invalid argument in \
libvirt was built without the 'xenapi'&lt;BR&gt;&gt;&gt;&gt; &gt; \
driver"&lt;BR&gt;&gt;&gt;&gt;&lt;BR&gt;&gt;&gt;&gt; The means that your libvirt version is new \
enough and contains the&lt;BR&gt;&gt;&gt;&gt; XenAPI driver but that it was disabled on \
configure time, probably&lt;BR&gt;&gt;&gt;&gt; because the build server didn't have \
libxenserver installed and&lt;BR&gt;&gt;&gt;&gt; libvirt's configure script automatically \
disabled the driver because&lt;BR&gt;&gt;&gt;&gt; of a missing \
dependency.&lt;BR&gt;&gt;&gt;&gt;&lt;BR&gt;&gt;&gt;&gt; &gt; I have installed libvirt from citrix \
yum repo.&lt;BR&gt;&gt;&gt;&gt;&lt;BR&gt;&gt;&gt;&gt; Then Citrix build libvirt without XenAPI \
support. As a long term&lt;BR&gt;&gt;&gt;&gt; solution you could report to whom ever is \
responsible for that repo&lt;BR&gt;&gt;&gt;&gt; and request to enabled XenAPI support in \
that libvirt package. As a&lt;BR&gt;&gt;&gt;&gt; short term solution you could build \
libvirt from source yourself and&lt;BR&gt;&gt;&gt;&gt; make sure to get the XenAPI driver \
enabled.&lt;BR&gt;&gt;&gt;&gt;&lt;BR&gt;&gt;&gt;&gt; &gt; I am using Xenserver 5.5 with libvirt \
0.8.2 and it does not seem to be&lt;BR&gt;&gt;&gt;&gt; &gt; \
working.&lt;BR&gt;&gt;&gt;&gt;&lt;BR&gt;&gt;&gt;&gt; According to &lt;a \
href='http://libvirt.org/hvsupport.html'&gt;http://libvirt.org/hvsupport.html&lt;/a&gt; and \
the error message&lt;BR&gt;&gt;&gt;&gt; 0.8.2 is new \
enough.&lt;BR&gt;&gt;&gt;&gt;&lt;BR&gt;&gt;&gt;&gt; Matthias&lt;BR&gt;&gt;&gt;&gt;&lt;BR&gt;&gt;&gt;&gt; &gt; \
Thanks,&lt;BR&gt;&gt;&gt;&gt; &gt;&lt;BR&gt;&gt;&gt;&gt; &gt; Naresh&lt;BR&gt;&gt;&gt;&gt; \
&gt;&lt;BR&gt;&gt;&gt;&gt; &gt; On Jun 15, 2011 7:03 PM, "Matthias Bolte"&lt;BR&gt;&gt;&gt;&gt; \
&gt; &lt;&lt;A onclick="top.ajaxMail.ext.switchTo('@Compose','mode=mail_to_individual&amp;email=matthias.bolte@googlemail.com');" \
href="javascript:void(0);"&gt;matthias.bolte@googlemail.com&lt;/A&gt;&gt;&lt;BR&gt;&gt;&gt;&gt; &gt; \
wrote:&lt;BR&gt;&gt;&gt;&gt; &gt;&gt; 2011/6/15 G Naresh Kumar &lt;&lt;A \
onclick="top.ajaxMail.ext.switchTo('@Compose','mode=mail_to_individual&amp;email=naresh.gadepalli@gmail.com');" \
href="javascript:void(0);"&gt;naresh.gadepalli@gmail.com&lt;/A&gt;&gt;:&lt;BR&gt;&gt;&gt;&gt; \
&gt;&gt;&gt; Hi,&lt;BR&gt;&gt;&gt;&gt; &gt;&gt;&gt; Is libvirt supported on Citrix \
Xenserver. I have been searching for&lt;BR&gt;&gt;&gt;&gt; &gt;&gt;&gt; the&lt;BR&gt;&gt;&gt;&gt; \
&gt;&gt;&gt; same&lt;BR&gt;&gt;&gt;&gt; &gt;&gt;&gt; with little/no luck.&lt;BR&gt;&gt;&gt;&gt; \
&gt;&gt;&gt; If supported, can you point to some links/documents which can help \
me&lt;BR&gt;&gt;&gt;&gt; &gt;&gt;&gt; try&lt;BR&gt;&gt;&gt;&gt; &gt;&gt;&gt; out the \
same.&lt;BR&gt;&gt;&gt;&gt; &gt;&gt;&gt; Thanks,&lt;BR&gt;&gt;&gt;&gt; &gt;&gt;&gt; \
Naresh&lt;BR&gt;&gt;&gt;&gt; &gt;&gt;&lt;BR&gt;&gt;&gt;&gt; &gt;&gt; libvirt can use XenAPI via \
libxenserver [1]. That should allow you to&lt;BR&gt;&gt;&gt;&gt; &gt;&gt; use libvirt with \
a Citrix XenServer. You can use virsh like this&lt;BR&gt;&gt;&gt;&gt; &gt;&gt; assuming you \
have a libxenserver enabled libvirt:&lt;BR&gt;&gt;&gt;&gt; &gt;&gt;&lt;BR&gt;&gt;&gt;&gt; \
&gt;&gt; virsh -c xenapi://my-xen-server&lt;BR&gt;&gt;&gt;&gt; &gt;&gt;&lt;BR&gt;&gt;&gt;&gt; \
&gt;&gt; But it's true, there is no documentation about this on the \
libvirt&lt;BR&gt;&gt;&gt;&gt; &gt;&gt; website&lt;BR&gt;&gt;&gt;&gt; &gt;&gt; \
yet.&lt;BR&gt;&gt;&gt;&gt; &gt;&gt;&lt;BR&gt;&gt;&gt;&gt; &gt;&gt; [1] &lt;a \
href='http://community.citrix.com/display/xs/Download+SDKs'&gt;http://community.citrix.com/display/xs/Download+SDKs&lt;/a&gt;&lt;BR&gt;&gt;&gt;&gt; \
&gt;&gt;&lt;BR&gt;&gt;&gt;&gt; &gt;&gt; --&lt;BR&gt;&gt;&gt;&gt; &gt;&gt; Matthias \
Bolte&lt;BR&gt;&gt;&gt;&gt; &gt;&gt; &lt;a \
href='http://photron.blogspot.com'&gt;http://photron.blogspot.com&lt;/a&gt;&lt;BR&gt;&gt;&gt;&gt; \
&gt;&lt;BR&gt;&gt;&gt; --&lt;BR&gt;&gt;&gt; I was an atheist till I realized I am \
GOD&lt;BR&gt;&gt;&gt;&lt;BR&gt;&gt;&lt;BR&gt;&gt;&lt;/DIV&gt;&lt;/DIV&gt;--&lt;BR&gt;&gt;  &lt;DIV&gt;
&lt;DIV&gt;&lt;/DIV&gt;
&lt;DIV cl-ass="h5"&gt;Matthias Bolte&lt;BR&gt;&gt;&lt;a \
href='http://photron.blogspot.com'&gt;http://photron.blogspot.com&lt;/a&gt;&lt;BR&gt;&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/BLOCKQUOTE&gt;&lt;/DIV&gt;&lt;BR&gt;&gt;&lt;BR \
clear=all&gt;&lt;BR&gt;&gt;-- &lt;BR&gt;&gt;I was an atheist till I realized I am \
GOD&lt;BR&gt;&gt;&lt;/DIV&gt;_______________________________________________&lt;BR&gt;&gt;libvirt-users \
mailing list&lt;BR&gt;&gt;libvirt-users@redhat.com&lt;BR&gt;&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;br&gt;&lt;A \
HREF="http://sigads.rediff.com/RealMedia/ads/click_nx.ads/www.rediffmail.com/signatureline.htm@Middle?" \
target="_blank"&gt;&lt;IMG \
SRC="http://sigads.rediff.com/RealMedia/ads/adstream_nx.ads/www.rediffmail.com/signatureline.htm@Middle"&gt;&lt;/A&gt;&lt;br&gt;Treat \
yourself at a restaurant, spa, resort and much more with &lt;b&gt;&lt;a \
href="http://track.rediff.com/click?url=___http://dealhojaye.rediff.com?sc_cid=mailsignature___&amp;cmp=signature&amp;lnk=rediffmailsignature&amp;newservice=deals" \
target ="_new"&gt;Rediff Deal ho jaye!&lt;/a&gt;&lt;/b&gt;



</body></email><email><emailId>20110719132053</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-07-19 13:20:53-0400</timestampReceived><subject>Re: [libvirt-users] cannot perform tunnelled migration without using peer2peer flag</subject><body>

On 07/19/2011 06:23 AM, Daniel P. Berrange wrote:
&gt; Basically, virsh shouldn't make any assumptions based on the current
&gt; way things are implemented in libvirtd, since it cannot expect to be
&gt; running against a matching version. Old virsh should work against new
&gt; libvirtd, and vica-verca. This is the same case as the checking of
&gt; flags in src/libvirt.c vs the individual drivers.

Fair enough, commit 40143fb6 is now reverted.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20110720015444</emailId><senderName>zhang xintao</senderName><senderEmail>zhang.kvm@gmail.com</senderEmail><timestampReceived>2011-07-20 01:54:44-0400</timestampReceived><subject>[libvirt-users] Migrate failed</subject><body>

Dear All；
    I try to migrate a kvm guset os from Host A to Host B,but failed
       ================================================
       Host OS : Ubuntu 11.04 server
       Using libvirt 0.8.8
       Using API:QEMU 0.8.8
       Running hypervisor:QEMU 0.14.0
       ===============================================
       virsh migrate --live winxp quem+ssh://192.168.10.3/system
       root@192.168.10.3's password:
       error:operation failed:migration to 'tcp:Host B:49156'
failed:migration failed
       ===============================================
       read libvirt.org FAQ,add --tunnelled FLAG
       ================================
       virsh migrate --live --tunnelled winxp qume+ssh://192.168.10.3/system
       root@192.168.10.'s password:
        error: Requested operation is not vaild:cannot perform
tunnelled migration without using peer2peer flag
       ================================================
       add p2p flag
       ================================================
       virsh migrate --live --tunnelled winxp qume+ssh://192.168.10.3/system
       root@192.168.10.'s password:
       error:operation failed:Failed to connect to remote libvirt URI
quem+ssh://192.168.10.3/system

      who can help me ?

</body></email><email><emailId>20110720050651</emailId><senderName>Emmanuel Noobadmin</senderName><senderEmail>centos.admin@gmail.com</senderEmail><timestampReceived>2011-07-20 05:06:51-0400</timestampReceived><subject>Re: [libvirt-users] RAID1 over IP?</subject><body>

On 7/20/11, David Ehle &lt;ehle@phys.iit.edu&gt; wrote:

&gt; Would you be willing /able to elaborate more on this idea?  I've been
&gt; looking into it a bit more and while your right that it sounds simpler on
&gt; paper, it looks like doing DRBD is packaged for Ubuntu, and there is
&gt; pretty good Cook Book documentation for how to do HA NFS on top of DRBD.
&gt;
&gt; I'm a real novice on the multipath topic so I'm having trouble comparing
&gt; apples to apples to see what the pros and cons of the two scenarios would
&gt; be.

I'm a novice as well (if my nickname didn't make that obvious yet :D)
It's all on paper since I haven't had the time to push for it
internally nor was the original client eager to put out the budget for
the necessary hardware.

My basic idea was this

Physically
=======
[VM Host]
NIC1 -&gt; Switch 1
NIC2 -&gt; Switch 2

[Storage Node] x 2
NIC1 -&gt; Switch 1
NIC2 -&gt; Switch 2
Export HDD x 4 (RAID 10 or could do with RAID 1)


So for VM1
mp1: multipath NIC1 -&gt; Storage1:HDD1, NIC2-&gt;Storage1:HDD1
mp2: multipath NIC2 -&gt; Storage2:HDD1, NIC2-&gt;Storage2:HDD2
then
md mirror using mp1 and mp2

This way, if one switch fails, multipath should keep the array
working. if one node fails, md mirror should keep it alive.

One question I haven't figured an answer to is whether it would be
better to build the array in the host and simply show the guest a
single drive (less overheads? more flexible? since I could change the
setup on the host as long as the guest definition points to the
correct block device), or do it within the guest itself (faster I/O
since the kernel is aware of more drives?)

</body></email><email><emailId>20110720164252</emailId><senderName>Jim Glennon</senderName><senderEmail>jglennon4work@gmail.com</senderEmail><timestampReceived>2011-07-20 16:42:52-0400</timestampReceived><subject>[libvirt-users] problem w/ libvirt-0.8.2-15.el5 and CentOS</subject><body>

I am running the Eucalyptus 2.0 cloud computing platform on an up-to-date
CentOS 5 using the xen hypervisor. While attempting to attach a volume
successfully created using jclouds with eucalyptus to a running VM
instance, I encountered the following error:

          libvirt: Requested operation is not valid: Xm driver only supports
modifying persistent config (code=55)

i also tried attaching manually (i.e. euca-atttach-volume) and experienced
the same failure.

i found this discussion which mentions a possible libvirt/xen problem:

https://bugzilla.redhat.com/show_bug.cgi?format=multiple&amp;id=662908

however it does not appear that the fix is available for public consumption
(at least i couldn't find it).


from the Eucalyptus nc.log:

[Tue Jul 19 22:16:47 2011][005714][EUCAINFO ] doAttachVolume() invoked
(id=i-4DA80924 vol=vol-59CF0630 remote=/dev/etherd/e0.12 local=/dev/sda2)
[Tue Jul 19 22:16:48 2011][005714][EUCAERROR ] libvirt: Requested operation
is not valid: Xm driver only supports modifying persistent config (code=55)
[Tue Jul 19 22:16:48 2011][005714][EUCAERROR ] AttachVolume() failed
(err=-1) XML=
[Tue Jul 19 22:16:48 2011][005714][EUCAERROR ] ERROR: doAttachVolume()
failed error=1

[Attachment #3 (text/html)]

&lt;span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif; \
font-size: 12px; line-height: 20px; "&gt;&lt;p style="font-family: Arial, Verdana, \
sans-serif; font-size: 12px; font-style: normal; font-weight: normal; color: rgb(58, \
58, 58); text-align: left; line-height: 16px; padding-top: 0px; margin-top: 0px; \
margin-right: 10px; "&gt; &lt;span class="Apple-style-span" style="color: rgb(0, 0, 0); \
font-family: Arial, Helvetica, sans-serif; line-height: 20px; "&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
style="font-family: Arial, Verdana, sans-serif; font-size: 12px; font-style: normal; \
font-weight: normal; color: rgb(58, 58, 58); text-align: left; line-height: 16px; \
padding-top: 0px; margin-top: 0px; margin-right: 10px; "&gt; I am running the Eucalyptus \
2.0 cloud computing platform on an up-to-date CentOS 5 using the xen hypervisor. \
While attempting to attach a volume successfully created using jclouds with \
eucalyptus to a running VM instance, I encountered the following error:&lt;/p&gt; &lt;p \
style="font-family: Arial, Verdana, sans-serif; font-size: 12px; font-style: normal; \
font-weight: normal; color: rgb(58, 58, 58); text-align: left; line-height: 16px; \
padding-top: 0px; margin-top: 0px; margin-right: 10px; "&gt;  libvirt: Requested \
operation is not valid: Xm driver only supports modifying persistent config \
(code=55)&lt;/p&gt;&lt;p style="font-family: Arial, Verdana, sans-serif; font-size: 12px; \
font-style: normal; font-weight: normal; color: rgb(58, 58, 58); text-align: left; \
line-height: 16px; padding-top: 0px; margin-top: 0px; margin-right: 10px; "&gt; i also \
tried attaching manually (i.e. euca-atttach-volume) and experienced the same \
failure.&lt;/p&gt;&lt;p style="font-family: Arial, Verdana, sans-serif; font-size: 12px; \
font-style: normal; font-weight: normal; color: rgb(58, 58, 58); text-align: left; \
line-height: 16px; padding-top: 0px; margin-top: 0px; margin-right: 10px; "&gt; i found \
this discussion which mentions a possible libvirt/xen problem:&lt;/p&gt;&lt;p \
style="font-family: Arial, Verdana, sans-serif; font-size: 12px; font-style: normal; \
font-weight: normal; color: rgb(58, 58, 58); text-align: left; line-height: 16px; \
padding-top: 0px; margin-top: 0px; margin-right: 10px; "&gt; &lt;a \
href="https://bugzilla.redhat.com/show_bug.cgi?format=multiple&amp;id=662908" \
title="https://bugzilla.redhat.com/show_bug.cgi?format=multiple&amp;id=662908" \
style="color: rgb(66, 151, 68); text-decoration: underline; \
"&gt;https://bugzilla.redhat.com/show_bug.cgi?format=multiple&amp;id=662908&lt;/a&gt;&lt;/p&gt; &lt;p \
style="font-family: Arial, Verdana, sans-serif; font-size: 12px; font-style: normal; \
font-weight: normal; color: rgb(58, 58, 58); text-align: left; line-height: 16px; \
padding-top: 0px; margin-top: 0px; margin-right: 10px; "&gt; however it does not appear \
that the fix is available for public consumption (at least i couldn't find it). \
&lt;/p&gt;&lt;p style="font-family: Arial, Verdana, sans-serif; font-size: 12px; font-style: \
normal; font-weight: normal; color: rgb(58, 58, 58); text-align: left; line-height: \
16px; padding-top: 0px; margin-top: 0px; margin-right: 10px; "&gt; &lt;br&gt;&lt;/p&gt;&lt;p \
style="font-family: Arial, Verdana, sans-serif; font-size: 12px; font-style: normal; \
font-weight: normal; color: rgb(58, 58, 58); text-align: left; line-height: 16px; \
padding-top: 0px; margin-top: 0px; margin-right: 10px; "&gt; from the Eucalyptus \
nc.log:&lt;/p&gt;&lt;p style="font-family: Arial, Verdana, sans-serif; font-size: 12px; \
font-style: normal; font-weight: normal; color: rgb(58, 58, 58); text-align: left; \
line-height: 16px; padding-top: 0px; margin-top: 0px; margin-right: 10px; "&gt; [Tue Jul \
19 22:16:47 2011][005714][EUCAINFO ] doAttachVolume() invoked (id=i-4DA80924 \
vol=vol-59CF0630 remote=/dev/etherd/e0.12 local=/dev/sda2)&lt;br&gt;[Tue Jul 19 22:16:48 \
2011][005714][EUCAERROR ] libvirt: Requested operation is not valid: Xm driver only \
supports modifying persistent config (code=55)&lt;br&gt; [Tue Jul 19 22:16:48 \
2011][005714][EUCAERROR ] AttachVolume() failed (err=-1) XML=&lt;br&gt;[Tue Jul 19 22:16:48 \
2011][005714][EUCAERROR ] ERROR: doAttachVolume() failed error=1&lt;/p&gt;&lt;/span&gt;&lt;p&gt;&lt;/p&gt;



</body></email><email><emailId>20110721162119</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-07-21 16:21:19-0400</timestampReceived><subject>Re: [libvirt-users] Is libvirt supported on Citrix Xenserver?</subject><body>

2011/7/19 sharmila radha krishnan &lt;sharmilaradhakrishnan@rediffmail.com&gt;

&gt; Hi,
&gt;  I was finally able to connect to the xenapi hypervisor.  However, once I
&gt; connect to virsh and give a 'quit' command I get  "* glibc detected ***
&gt; virsh: double free or corruption (fasttop):". Please find below the actual
&gt; memory dump.
&gt;

I looked at the XenAPI driver and found a double-free problem, based on the
minimal stacktrace glibc provided. Here's a patch for this. I'd be glad if
you could test it, as I don't have a XenAPI setup at hand.

  https://www.redhat.com/archives/libvir-list/2011-July/msg01543.html

*Note:* I have disabled the SSL certificate verification in xenapi_driver.c
&gt; by setting curl_easy_setopt(curl, CURLOPT_SSL_VERIFYPEER, 0) &amp;
&gt; curl_easy_setopt(curl, CURLOPT_SSL_VERIFYHOST, 0).
&gt;

No need to edit the code for this. You can pass the no_verify option in the
connection URI to achieve this

  virsh -c xenapi://localhost/?no_verify=1

 Moreover, Iam not able to start any VMs uisng xencenter after i have
&gt; started using virsh. It says,  *Error: Starting VM 'XenServer SDK
&gt; 5.6.100-47101p import' - Internal error: another frontend device is already
&gt; connected to this domain (frontend (domid=0 | kind=vbd | devid=51712);
&gt; backend (domid=0 | kind=vbd | devid=51712)).* Even a reboot of the machine
&gt; didnt help.
&gt;

Sorry, I've no idea what the problem could be here.

Matthias



Any pointers on the above 2 issues would be of great help.
&gt;
&gt; Thanks in Advance!
&gt;
&gt; Regards,
&gt; Sharmila
&gt;
&gt; From: "G Naresh Kumar"naresh.gadepalli@gmail.com
&gt; Sent: Sat, 16 Jul 2011 16:55:16 +0530
&gt; To: Matthias Bolte matthias.bolte@googlemail.com
&gt; Cc: libvirt-users@redhat.com
&gt; Subject: Re: [libvirt-users] Is libvirt supported on Citrix Xenserver?
&gt;
&gt; Hi Matthias,
&gt;  &gt;
&gt;
&gt; Sorry for the confusion.It was an edited one &amp; hence thetypo. Below is the
&gt;
&gt;
&gt; actual output:
&gt;
&gt; # virsh -c xenapi://&lt;myip&gt;
&gt;
&gt; Enter username for &lt;myip&gt;: root
&gt;
&gt; Enter root's password for &lt;myip&gt;:
&gt;
&gt; error: authentication failed: (null)
&gt;
&gt; I was not able to get anything in the Xen logs. Somehowfigured out to print
&gt;
&gt;
&gt; the Xen error using the patch given at the link
&gt; http://osdir.com/ml/libvir-
&gt;
&gt; list/2011-06/msg00298.html. It prints"TRANSPORT_FAULT". Any pointers to
&gt; this
&gt;
&gt; error would be much appreciated. Iam also trying to debugthis issue.
&gt;
&gt; As per your suggestion,
&gt;
&gt; I had used make rpm. But it requires xen-devel pacakge,which I was
&gt;
&gt; not able to get for Xen 3.4.2. Is there any way where I canuse the source
&gt;
&gt; package and build &amp; install the library without using'make rpm' ?
&gt;
&gt; Thanks for all the help.
&gt;
&gt; &gt;
&gt;
&gt; Regards
&gt;
&gt; Naresh
&gt; &gt;
&gt; On Thu, Jul 14, 2011 at 7:07 PM, Matthias Bolte &lt;
&gt; matthias.bolte@googlemail.com&gt; wrote:
&gt; &gt;
&gt;
&gt; 2011/7/14 G Naresh Kumar &lt;naresh.gadepalli@gmail.com&gt;:
&gt; &gt;&gt; Hi Maththias,
&gt; &gt;
&gt; &gt; Thanks for the help. I finally was able to compile/install libvirt on
&gt; &gt;&gt; xenserver.
&gt; &gt;&gt;
&gt; &gt;&gt; I tried compiling the libvirt 0.9.2 with xen api support. Was able to
&gt; &gt;&gt; install it successfully. When I tried giving the virsh command, I got an
&gt; &gt;&gt; ‘authentication failed' error as shown below.
&gt; &gt;&gt;
&gt; &gt;&gt; # virsh -c xenapi://&lt;my local ip&gt;
&gt; &gt;&gt; Enter username for &lt;mylocalip&gt;: root
&gt; &gt;
&gt; &gt;
&gt; Here you entered root
&gt; &gt;
&gt;  &gt;&gt; Enter intel123's password for &lt;my local ip&gt;:
&gt; &gt;
&gt; &gt;
&gt; but here it asks for intel123's, that's unexpected. Did you edit this
&gt; &gt;one before mailing it, or is there really this mismatch?
&gt; &gt;
&gt; &gt;&gt; error: authentication failed: (null)
&gt; &gt;
&gt; &gt;Outputting (null) here is actually a bug. The only way this can happen
&gt; &gt;is when the login attempt fails but the XenServer doesn't provide an
&gt; &gt;error message. Maybe have a look at the XenServer logs to see if it
&gt; &gt;says something about a failed login attempt.
&gt; &gt;
&gt;  &gt;&gt; I also tried connecting to the local machine as below,
&gt; &gt;&gt;
&gt; &gt;&gt; virsh -c "xenapi:///"
&gt; &gt;&gt; error: authentication failed: Server name not in URI
&gt; &gt;&gt; error: failed to connect to the hypervisor
&gt; &gt;
&gt; &gt;
&gt; The XenAPI driver expects a server name. xenapi:/// _could_ be treated
&gt; &gt;as xenapi://localhost, but it's not implemented that way.
&gt; &gt;
&gt;  &gt;&gt; Also I am trying to install ruby-libvirt on xenserver, which looks
&gt; like
&gt; &gt;&gt; requires libvirt-devel package to be installed. How do I build it from
&gt; the
&gt; &gt;&gt; libvirt 0.9.2 source package.
&gt; &gt;
&gt; &gt;
&gt; Running 'make rpm' should build an libvirt-devel RPM package for you.
&gt; &gt;
&gt;   &gt;&gt; Thanks,
&gt; &gt;&gt;
&gt; &gt;&gt; Naresh
&gt; &gt;&gt;
&gt; &gt;&gt; On Wed, Jun 15, 2011 at 8:19 PM, Matthias Bolte
&gt; &gt;&gt; &lt;matthias.bolte@googlemail.com&gt; wrote:
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; 2011/6/15 G Naresh Kumar &lt;naresh.gadepalli@gmail.com&gt;:
&gt; &gt;&gt;&gt; &gt; Hi Maththias,
&gt; &gt;&gt;&gt; &gt;
&gt; &gt;&gt;&gt; &gt; Thanks a lot for your response!.
&gt; &gt;&gt;&gt; &gt;
&gt; &gt;&gt;&gt; &gt; Is there a specific version of libvirt from which xenserver support
&gt; is
&gt; &gt;&gt;&gt; &gt; added? I am getting the below error
&gt; &gt;&gt;&gt; &gt;
&gt; &gt;&gt;&gt; &gt; "error: invalid argument in libvirt was built without the 'xenapi'
&gt; &gt;&gt;&gt; &gt; driver"
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; The means that your libvirt version is new enough and contains the
&gt; &gt;&gt;&gt; XenAPI driver but that it was disabled on configure time, probably
&gt; &gt;&gt;&gt; because the build server didn't have libxenserver installed and
&gt; &gt;&gt;&gt; libvirt's configure script automatically disabled the driver because
&gt; &gt;&gt;&gt; of a missing dependency.
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; &gt; I have installed libvirt from citrix yum repo.
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; Then Citrix build libvirt without XenAPI support. As a long term
&gt; &gt;&gt;&gt; solution you could report to whom ever is responsible for that repo
&gt; &gt;&gt;&gt; and request to enabled XenAPI support in that libvirt package. As a
&gt; &gt;&gt;&gt; short term solution you could build libvirt from source yourself and
&gt; &gt;&gt;&gt; make sure to get the XenAPI driver enabled.
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; &gt; I am using Xenserver 5.5 with libvirt 0.8.2 and it does not seem to
&gt; be
&gt; &gt;&gt;&gt; &gt; working.
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; According to http://libvirt.org/hvsupport.html and the error message
&gt; &gt;&gt;&gt; 0.8.2 is new enough.
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; Matthias
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; &gt; Thanks,
&gt; &gt;&gt;&gt; &gt;
&gt; &gt;&gt;&gt; &gt; Naresh
&gt; &gt;&gt;&gt; &gt;
&gt; &gt;&gt;&gt; &gt; On Jun 15, 2011 7:03 PM, "Matthias Bolte"
&gt; &gt;&gt;&gt; &gt; &lt;matthias.bolte@googlemail.com&gt;
&gt; &gt;&gt;&gt; &gt; wrote:
&gt; &gt;&gt;&gt; &gt;&gt; 2011/6/15 G Naresh Kumar &lt;naresh.gadepalli@gmail.com&gt;:
&gt; &gt;&gt;&gt; &gt;&gt;&gt; Hi,
&gt; &gt;&gt;&gt; &gt;&gt;&gt; Is libvirt supported on Citrix Xenserver. I have been searching for
&gt; &gt;&gt;&gt; &gt;&gt;&gt; the
&gt; &gt;&gt;&gt; &gt;&gt;&gt; same
&gt; &gt;&gt;&gt; &gt;&gt;&gt; with little/no luck.
&gt; &gt;&gt;&gt; &gt;&gt;&gt; If supported, can you point to some links/documents which can help
&gt; me
&gt; &gt;&gt;&gt; &gt;&gt;&gt; try
&gt; &gt;&gt;&gt; &gt;&gt;&gt; out the same.
&gt; &gt;&gt;&gt; &gt;&gt;&gt; Thanks,
&gt; &gt;&gt;&gt; &gt;&gt;&gt; Naresh
&gt; &gt;&gt;&gt; &gt;&gt;
&gt; &gt;&gt;&gt; &gt;&gt; libvirt can use XenAPI via libxenserver [1]. That should allow you
&gt; to
&gt; &gt;&gt;&gt; &gt;&gt; use libvirt with a Citrix XenServer. You can use virsh like this
&gt; &gt;&gt;&gt; &gt;&gt; assuming you have a libxenserver enabled libvirt:
&gt; &gt;&gt;&gt; &gt;&gt;
&gt; &gt;&gt;&gt; &gt;&gt; virsh -c xenapi://my-xen-server
&gt; &gt;&gt;&gt; &gt;&gt;
&gt; &gt;&gt;&gt; &gt;&gt; But it's true, there is no documentation about this on the libvirt
&gt; &gt;&gt;&gt; &gt;&gt; website
&gt; &gt;&gt;&gt; &gt;&gt; yet.
&gt; &gt;&gt;&gt; &gt;&gt;
&gt; &gt;&gt;&gt; &gt;&gt; [1] http://community.citrix.com/display/xs/Download+SDKs
&gt; &gt;&gt;&gt; &gt;&gt;
&gt; &gt;&gt;&gt; &gt;&gt; --
&gt; &gt;&gt;&gt; &gt;&gt; Matthias Bolte
&gt; &gt;&gt;&gt; &gt;&gt; http://photron.blogspot.com
&gt; &gt;&gt;&gt; &gt;
&gt; &gt;&gt; --
&gt; &gt;&gt; I was an atheist till I realized I am GOD
&gt; &gt;&gt;
&gt; &gt;
&gt; &gt;
&gt; --
&gt; &gt;
&gt;  Matthias Bolte
&gt; &gt;http://photron.blogspot.com
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;--
&gt; &gt;I was an atheist till I realized I am GOD
&gt; &gt;
&gt;

[Attachment #3 (text/html)]

&lt;div class="gmail_quote"&gt;2011/7/19 sharmila radha krishnan &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:sharmilaradhakrishnan@rediffmail.com"&gt;sharmilaradhakrishnan@rediffmail.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt; &lt;div&gt;Hi,&lt;/div&gt;
&lt;div&gt;  I was finally able to connect to the xenapi hypervisor.    However, once I \
connect to virsh and give a 'quit' command I get   "* glibc detected *** \
virsh: double free or corruption (fasttop):". Please find below the actual \
memory dump.&lt;/div&gt;

&lt;div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;  &lt;br&gt;I looked at the XenAPI driver and found a \
double-free problem, based on the minimal stacktrace glibc provided. Here's a \
patch for this. I'd be glad if you could test it, as I don't have a XenAPI \
setup at hand.&lt;br&gt; &lt;br&gt;   &lt;a \
href="https://www.redhat.com/archives/libvir-list/2011-July/msg01543.html"&gt;https://www \
.redhat.com/archives/libvir-list/2011-July/msg01543.html&lt;/a&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote \
class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, \
204, 204); padding-left: 1ex;"&gt;

&lt;div&gt;&lt;b&gt;&lt;i&gt;Note:&lt;/i&gt;&lt;/b&gt; I have disabled the SSL certificate verification in \
xenapi_driver.c by  setting curl_easy_setopt(curl, CURLOPT_SSL_VERIFYPEER, 0) &amp; \
curl_easy_setopt(curl, CURLOPT_SSL_VERIFYHOST, 0).&lt;/div&gt; &lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;No \
need to edit the code for this. You can pass the no_verify option in the connection \
URI to achieve this&lt;br&gt;&lt;br&gt;   virsh -c \
xenapi://localhost/?no_verify=1&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" \
style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, 204, 204); \
padding-left: 1ex;"&gt; &lt;div&gt;  Moreover, Iam not able to start any VMs uisng xencenter \
after i have started using virsh. It says,   &lt;b&gt;Error: Starting VM 'XenServer SDK \
5.6.100-47101p import' - Internal error: another frontend device is already \
connected to this domain (frontend (domid=0 | kind=vbd | devid=51712); backend \
(domid=0 | kind=vbd | devid=51712)).&lt;/b&gt; Even a reboot of the machine didnt \
help.&lt;/div&gt; &lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Sorry, I've no idea what the problem could be \
here.&lt;br&gt;&lt;br&gt;Matthias&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" \
style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, 204, 204); \
padding-left: 1ex;"&gt;

&lt;div&gt;Any pointers on the above 2 issues would be of great help.&lt;/div&gt;
&lt;div&gt;  &lt;/div&gt;
&lt;div&gt;Thanks in Advance!&lt;/div&gt;
&lt;div&gt;  &lt;/div&gt;
&lt;div&gt;Regards,&lt;/div&gt;
&lt;div&gt;Sharmila&lt;/div&gt;
&lt;div&gt;  &lt;/div&gt;
&lt;div&gt;From: "G Naresh Kumar"&lt;a href="mailto:naresh.gadepalli@gmail.com" \
target="_blank"&gt;naresh.gadepalli@gmail.com&lt;/a&gt;&lt;/div&gt; &lt;div&gt;Sent: Sat, 16 Jul 2011 \
16:55:16 +0530&lt;/div&gt; &lt;div&gt;To: Matthias Bolte &lt;a \
href="mailto:matthias.bolte@googlemail.com" \
target="_blank"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&lt;/div&gt; &lt;div&gt;Cc: &lt;a \
href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;/div&gt; &lt;div&gt;Subject: Re: [libvirt-users] \
Is libvirt supported on Citrix Xenserver?&lt;/div&gt; &lt;div&gt;  &lt;/div&gt;
&lt;div&gt;Hi Matthias,&lt;/div&gt;
&lt;div&gt;
&lt;div&gt;&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;Sorry for the &lt;a href="http://confusion.It" target="_blank"&gt;confusion.It&lt;/a&gt; was \
an edited one &amp; hence thetypo. Below is the &lt;/p&gt;&lt;div class="im"&gt; &lt;p&gt;actual \
output:&lt;/p&gt; &lt;p&gt;&lt;/p&gt;
&lt;p&gt;# virsh -c xenapi://&lt;myip&gt;&lt;/p&gt;
&lt;p&gt;Enter username for &lt;myip&gt;: root&lt;/p&gt;
&lt;p&gt;Enter root's password for &lt;myip&gt;: &lt;/p&gt;
&lt;p&gt;error: authentication failed: (null)&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;/div&gt;&lt;p&gt;I was not able to get anything in the Xen logs. Somehowfigured out to print \
&lt;/p&gt;&lt;div class="im"&gt; &lt;p&gt;the Xen error using the patch given at the link &lt;a \
href="http://osdir.com/ml/libvir-" \
target="_blank"&gt;http://osdir.com/ml/libvir-&lt;/a&gt;&lt;/p&gt; &lt;p&gt;list/2011-06/msg00298.html. It \
prints"TRANSPORT_FAULT". Any pointers to this &lt;/p&gt; &lt;/div&gt;&lt;p&gt;error would be \
much appreciated. Iam also trying to debugthis issue.&lt;/p&gt;&lt;div class="im"&gt; &lt;p&gt;&lt;/p&gt;
&lt;p&gt;As per your suggestion,&lt;/p&gt;
&lt;p&gt;I had used make rpm. But it requires xen-devel pacakge,which I was &lt;/p&gt;
&lt;/div&gt;&lt;p&gt;not able to get for Xen 3.4.2. Is there any way where I canuse the source \
&lt;/p&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt; &lt;p&gt;package and build &amp; install the library \
without using'make rpm' ? &lt;/p&gt; &lt;p&gt;&lt;/p&gt;
&lt;p&gt;Thanks for all the help.&lt;/p&gt;
&lt;p&gt;
&lt;/p&gt;&lt;div&gt;&gt;&lt;/div&gt;
&lt;p&gt;Regards&lt;/p&gt;
&lt;p&gt;Naresh&lt;/p&gt;
&lt;div&gt;&gt; &lt;/div&gt;
&lt;div&gt;On Thu, Jul 14, 2011 at 7:07 PM, Matthias Bolte &lt;span \
dir="ltr"&gt;&lt;&lt;a&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:  &lt;div&gt;&gt; \
&lt;/div&gt; &lt;blockquote style="border-left:#ccc 1px solid;margin:0px 0px 0px \
0.8ex;padding-left:1ex"&gt;2011/7/14 G Naresh Kumar \
&lt;&lt;a&gt;naresh.gadepalli@gmail.com&lt;/a&gt;&gt;:  &lt;div&gt;&gt;&gt; Hi Maththias,&lt;/div&gt;
&lt;div&gt;&gt; &lt;/div&gt;
&lt;div&gt;&gt; Thanks for the help. I finally was able to compile/install libvirt on 
&lt;div&gt;&gt;&gt; xenserver.&lt;/div&gt;
&lt;div&gt;&gt;&gt;&lt;/div&gt;
&lt;div&gt;&gt;&gt; I tried compiling the libvirt 0.9.2 with xen api support. Was able \
to&lt;/div&gt; &lt;div&gt;&gt;&gt; install it successfully. When I tried giving the virsh \
command, I got an&lt;/div&gt; &lt;div&gt;&gt;&gt; ‘authentication failed' error as shown \
below.&lt;/div&gt; &lt;div&gt;&gt;&gt;&lt;/div&gt;
&lt;div&gt;&gt;&gt; # virsh -c xenapi://&lt;my local ip&gt;&lt;/div&gt;
&lt;div&gt;&gt;&gt; Enter username for &lt;mylocalip&gt;: root&lt;/div&gt;
&lt;div&gt;&gt;&lt;/div&gt;
&lt;div&gt;&gt;&lt;/div&gt;&lt;/div&gt;Here you entered root 
&lt;div&gt;&gt; &lt;/div&gt;
&lt;div&gt;
&lt;div&gt;&gt;&gt; Enter intel123's password for &lt;my local ip&gt;:&lt;/div&gt;
&lt;div&gt;&gt;&lt;/div&gt;
&lt;div&gt;&gt;&lt;/div&gt;&lt;/div&gt;but here it asks for intel123's, that's unexpected. Did \
you edit this  &lt;div&gt;&gt;one before mailing it, or is there really this \
mismatch?&lt;/div&gt; &lt;div&gt;&gt;&lt;/div&gt;
&lt;div&gt;&gt;&gt; error: authentication failed: (null)&lt;/div&gt;
&lt;div&gt;&gt;&lt;/div&gt;
&lt;div&gt;&gt;Outputting (null) here is actually a bug. The only way this can happen&lt;/div&gt;
&lt;div&gt;&gt;is when the login attempt fails but the XenServer doesn't provide \
an&lt;/div&gt; &lt;div&gt;&gt;error message. Maybe have a look at the XenServer logs to see if \
it&lt;/div&gt; &lt;div&gt;&gt;says something about a failed login attempt.&lt;/div&gt;
&lt;div&gt;&gt; &lt;/div&gt;
&lt;div&gt;
&lt;div&gt;&gt;&gt; I also tried connecting to the local machine as below,&lt;/div&gt;
&lt;div&gt;&gt;&gt;&lt;/div&gt;
&lt;div&gt;&gt;&gt; virsh -c "xenapi:///"&lt;/div&gt;
&lt;div&gt;&gt;&gt; error: authentication failed: Server name not in URI&lt;/div&gt;
&lt;div&gt;&gt;&gt; error: failed to connect to the hypervisor&lt;/div&gt;
&lt;div&gt;&gt;&lt;/div&gt;
&lt;div&gt;&gt;&lt;/div&gt;&lt;/div&gt;The XenAPI driver expects a server name. xenapi:/// _could_ be \
treated  &lt;div&gt;&gt;as xenapi://localhost, but it's not implemented that way.&lt;/div&gt;
&lt;div&gt;&gt; &lt;/div&gt;
&lt;div&gt;
&lt;div&gt;&gt;&gt; Also I am trying to install ruby-libvirt on xenserver, which looks \
like&lt;/div&gt; &lt;div&gt;&gt;&gt; requires libvirt-devel package to be installed. How do I \
build it from the&lt;/div&gt; &lt;div&gt;&gt;&gt; libvirt 0.9.2 source package.&lt;/div&gt;
&lt;div&gt;&gt;&lt;/div&gt;
&lt;div&gt;&gt;&lt;/div&gt;&lt;/div&gt;Running 'make rpm' should build an libvirt-devel RPM \
package for you.  &lt;div&gt;&gt; &lt;/div&gt;
&lt;div&gt;
&lt;div&gt;&lt;/div&gt;
&lt;div&gt;
&lt;div&gt;&gt;&gt; Thanks,&lt;/div&gt;
&lt;div&gt;&gt;&gt;&lt;/div&gt;
&lt;div&gt;&gt;&gt; Naresh&lt;/div&gt;
&lt;div&gt;&gt;&gt;&lt;/div&gt;
&lt;div&gt;&gt;&gt; On Wed, Jun 15, 2011 at 8:19 PM, Matthias Bolte&lt;/div&gt;
&lt;div&gt;&gt;&gt; &lt;&lt;a&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt; wrote:&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt;&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; 2011/6/15 G Naresh Kumar \
&lt;&lt;a&gt;naresh.gadepalli@gmail.com&lt;/a&gt;&gt;:&lt;/div&gt; &lt;div&gt;&gt;&gt;&gt; &gt; Hi \
Maththias,&lt;/div&gt; &lt;div&gt;&gt;&gt;&gt; &gt;&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt; Thanks a lot for your response!.&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt;&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt; Is there a specific version of libvirt from which xenserver \
support is&lt;/div&gt; &lt;div&gt;&gt;&gt;&gt; &gt; added? I am getting the below error&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt;&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt; "error: invalid argument in libvirt was built without the \
'xenapi'&lt;/div&gt; &lt;div&gt;&gt;&gt;&gt; &gt; driver"&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt;&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; The means that your libvirt version is new enough and contains \
the&lt;/div&gt; &lt;div&gt;&gt;&gt;&gt; XenAPI driver but that it was disabled on configure time, \
probably&lt;/div&gt; &lt;div&gt;&gt;&gt;&gt; because the build server didn't have \
libxenserver installed and&lt;/div&gt; &lt;div&gt;&gt;&gt;&gt; libvirt's configure script \
automatically disabled the driver because&lt;/div&gt; &lt;div&gt;&gt;&gt;&gt; of a missing \
dependency.&lt;/div&gt; &lt;div&gt;&gt;&gt;&gt;&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt; I have installed libvirt from citrix yum repo.&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt;&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; Then Citrix build libvirt without XenAPI support. As a long \
term&lt;/div&gt; &lt;div&gt;&gt;&gt;&gt; solution you could report to whom ever is responsible \
for that repo&lt;/div&gt; &lt;div&gt;&gt;&gt;&gt; and request to enabled XenAPI support in that \
libvirt package. As a&lt;/div&gt; &lt;div&gt;&gt;&gt;&gt; short term solution you could build \
libvirt from source yourself and&lt;/div&gt; &lt;div&gt;&gt;&gt;&gt; make sure to get the XenAPI \
driver enabled.&lt;/div&gt; &lt;div&gt;&gt;&gt;&gt;&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt; I am using Xenserver 5.5 with libvirt 0.8.2 and it does not \
seem to be&lt;/div&gt; &lt;div&gt;&gt;&gt;&gt; &gt; working.&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt;&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; According to &lt;a href="http://libvirt.org/hvsupport.html" \
target="_blank"&gt;http://libvirt.org/hvsupport.html&lt;/a&gt; and the error message&lt;/div&gt; \
&lt;div&gt;&gt;&gt;&gt; 0.8.2 is new enough.&lt;/div&gt; &lt;div&gt;&gt;&gt;&gt;&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; Matthias&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt;&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt; Thanks,&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt;&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt; Naresh&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt;&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt; On Jun 15, 2011 7:03 PM, "Matthias Bolte"&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt; &lt;&lt;a&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt; wrote:&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt;&gt; 2011/6/15 G Naresh Kumar \
&lt;&lt;a&gt;naresh.gadepalli@gmail.com&lt;/a&gt;&gt;:&lt;/div&gt; &lt;div&gt;&gt;&gt;&gt; &gt;&gt;&gt; \
Hi,&lt;/div&gt; &lt;div&gt;&gt;&gt;&gt; &gt;&gt;&gt; Is libvirt supported on Citrix Xenserver. I \
have been searching for&lt;/div&gt; &lt;div&gt;&gt;&gt;&gt; &gt;&gt;&gt; the&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt;&gt;&gt; same&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt;&gt;&gt; with little/no luck.&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt;&gt;&gt; If supported, can you point to some links/documents \
which can help me&lt;/div&gt; &lt;div&gt;&gt;&gt;&gt; &gt;&gt;&gt; try&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt;&gt;&gt; out the same.&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt;&gt;&gt; Thanks,&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt;&gt;&gt; Naresh&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt;&gt;&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt;&gt; libvirt can use XenAPI via libxenserver [1]. That should \
allow you to&lt;/div&gt; &lt;div&gt;&gt;&gt;&gt; &gt;&gt; use libvirt with a Citrix XenServer. \
You can use virsh like this&lt;/div&gt; &lt;div&gt;&gt;&gt;&gt; &gt;&gt; assuming you have a \
libxenserver enabled libvirt:&lt;/div&gt; &lt;div&gt;&gt;&gt;&gt; &gt;&gt;&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt;&gt; virsh -c xenapi://my-xen-server&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt;&gt;&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt;&gt; But it's true, there is no documentation about this on \
the libvirt&lt;/div&gt; &lt;div&gt;&gt;&gt;&gt; &gt;&gt; website&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt;&gt; yet.&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt;&gt;&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt;&gt; [1] &lt;a \
href="http://community.citrix.com/display/xs/Download+SDKs" \
target="_blank"&gt;http://community.citrix.com/display/xs/Download+SDKs&lt;/a&gt;&lt;/div&gt; \
&lt;div&gt;&gt;&gt;&gt; &gt;&gt;&lt;/div&gt; &lt;div&gt;&gt;&gt;&gt; &gt;&gt; --&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt;&gt; Matthias Bolte&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; &gt;&gt; &lt;a href="http://photron.blogspot.com" \
target="_blank"&gt;http://photron.blogspot.com&lt;/a&gt;&lt;/div&gt; &lt;div&gt;&gt;&gt;&gt; &gt;&lt;/div&gt;
&lt;div&gt;&gt;&gt; --&lt;/div&gt;
&lt;div&gt;&gt;&gt; I was an atheist till I realized I am GOD&lt;/div&gt;
&lt;div&gt;&gt;&gt;&lt;/div&gt;
&lt;div&gt;&gt;&lt;/div&gt;
&lt;div&gt;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;-- 
&lt;div&gt;&gt; &lt;/div&gt;
&lt;div&gt;
&lt;div&gt;&lt;/div&gt;
&lt;div&gt;Matthias Bolte 
&lt;div&gt;&gt;&lt;a href="http://photron.blogspot.com" \
target="_blank"&gt;http://photron.blogspot.com&lt;/a&gt;&lt;/div&gt; \
&lt;div&gt;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt; &lt;div&gt;&gt;&lt;/div&gt;
&lt;div clear="all"&gt;  &lt;/div&gt;
&lt;div&gt;&gt;-- &lt;/div&gt;
&lt;div&gt;&gt;I was an atheist till I realized I am GOD&lt;/div&gt;
&lt;div&gt;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/blockquote&gt;&lt;/div&gt;



</body></email><email><emailId>20110725084626</emailId><senderName>bala suru</senderName><senderEmail>balaqemu@gmail.com</senderEmail><timestampReceived>2011-07-25 08:46:26-0400</timestampReceived><subject>[libvirt-users] VM creation using libvirtd for the qemu-KVM hypervisor</subject><body>

Hi,
I have some basic doubt at the VM creation using libvirtd for the qemu-KVM
hypervisor .

I need to create a VM which can read the data uart/file and store/send to
other VM .. How to create this kind of VM and how to write the data in/out
of the VM ..


I need suggestion to do this .

regards
Bala

[Attachment #3 (text/html)]

&lt;div&gt;Hi,&lt;/div&gt;
&lt;div&gt;I have some basic doubt at the VM creation using libvirtd for the qemu=
-KVM hypervisor .&lt;/div&gt;
&lt;div&gt;=A0&lt;/div&gt;
&lt;div&gt;I need to create a VM which can read the data uart/file and store/send=
 to other VM .. How to create this kind of VM and how to write the data in/=
out=A0 of the VM ..&lt;/div&gt;
&lt;div&gt;=A0&lt;/div&gt;
&lt;div&gt;=A0&lt;/div&gt;
&lt;div&gt;I need suggestion to do this .&lt;/div&gt;
&lt;div&gt;=A0&lt;/div&gt;
&lt;div&gt;regards&lt;/div&gt;
&lt;div&gt;Bala&lt;/div&gt;


</body></email><email><emailId>20110725202033</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-07-25 20:20:33-0400</timestampReceived><subject>Re: [libvirt-users] Need help for Qemu-KVM</subject><body>

On 07/25/2011 02:26 AM, kp chetan wrote:
&gt;
&gt;

Your mail did not come through with any content other than the subject 
line.  The list software strips out html body; can you resend in just 
plain text, in case that explains the lack of information on your part?

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20110725213232</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-07-25 21:32:32-0400</timestampReceived><subject>Re: [libvirt-users] Wanted: method for qemu hook script to know if called for migration</subject><body>

On 07/25/2011 03:25 PM, Whit Blauvelt wrote:
&gt; In trying to understand whether sanlock will work in this instance, I see at
&gt; http://permalink.gmane.org/gmane.comp.emulators.libvirt/40261:
&gt;
&gt;    sanlock will ... protect against 2 vms on the same host using the same
&gt;    disk (or the same VM being started twice due to error by libvirt).
&gt;
&gt; By implication if I have the sanlock directory on a shared filesystem, it
&gt; will also prevent a VM from being started on the second host while running
&gt; on the first. Will it still allow the VM to do a live migration? Or will
&gt; live migration run up against the lock?

Yes, both useful lock managers (sanlock and fcntl) work best with the 
use of a shared lock directory, at which point they correctly handle 
live migration between hosts.  That is, the lock manager knows how to 
differentiate between read-only and read-write disk access, and the 
migration pattern is such that while the VM temporarily lives on two 
hosts at once, the migration API coordinates those two instances so that 
only one ever needs read-write access of a shared disk at a time.  The 
lock manager hooks are correctly called in the right sequence to account 
for migration, while still preventing you from starting up the same VM 
twice on multiple hosts via any means other than migration.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20110726112540</emailId><senderName>"Stefan G. Weichinger"</senderName><senderEmail>lists@xunil.at</senderEmail><timestampReceived>2011-07-26 11:25:40-0400</timestampReceived><subject>Re: [libvirt-users] Split a qcow2-image?</subject><body>

Am 25.07.2011 21:49, schrieb Eric Blake:

&gt; Have you tried using virt-resize yet?  

I don't have that binary here ... should it come with libvirt?

&gt; That may have all the
&gt; functionality you need for resizing partitions; although I'm not sure if
&gt; it can completely remove a partition.  If it can, then you'd use
&gt; original-&gt;copy1 to remove the e: partition, and original-&gt;copy2 to
&gt; remove the c: partition, leaving you with two files for the two
&gt; partitions with sizes of your choice.


Thanks ... I have for now solved it by using gparted. This should work
for some time now.

Stefan

</body></email><email><emailId>20110726114747</emailId><senderName>Adnan Pasic</senderName><senderEmail>pqado@yahoo.de</senderEmail><timestampReceived>2011-07-26 11:47:47-0400</timestampReceived><subject>[libvirt-users] Ping not working after a migration</subject><body>

Hello guys,

maybe you can help me with following issue. I have 
created a little cloud with a host and two worker nodes using opennebula. The setup \
went  successfully until now, I am able to create VM's and move them via 
normal and live migration.
Another (possibly) important information is that I configured my virtual bridge on \
both worker nodes like this:


auto br0 iface br0 inet static address 192.168.0.[2|3] netmask 255.255.255.0 network \
192.168.0.0 broadcast 192.168.0.255 #gateway 192.168.0.1 bridge_ports eth0 bridge_stp \
on bridge_maxwait 0 The command "brctl show" gives me following things back:


bridge name    bridge id            STP enabled    interfaces
br0            8000.003005c34278    yes            eth0
                                                   vnet0 (&lt;- only appears on node \
with running VM)

virbr0         8000.000000000000    yes

According to thelibvirt wiki this setting is good as is. However, the issue I'm \
having is that when I create a VM and assign a static IP to it, which looks like e.g. \
192.168.0.5,  I firstly am able to ping this VM from both worker nodes, and also when \
I perform a live migration the ping stops for a few seconds (until the nodes realize \
the new route to this VM) and then  starts pinging normally again.

However, when I perform a normal migration the ping doesn't recover anymore, but \
answers repeatedly with: Destination Host Unreachable

Do you know what could be the problem? Where is the difference between a normal and \
live migration and how can the ping after live migrating still work, but after a  \
normal migration not?

Thanks a lot!
Regards, Adnan


[Attachment #3 (text/html)]

&lt;html&gt;&lt;body&gt;&lt;div style="color:#000; background-color:#fff; font-family:arial, \
helvetica, sans-serif;font-size:10pt"&gt;&lt;br&gt;&lt;div style="font-family: arial, helvetica, \
sans-serif; font-size: 10pt;"&gt;&lt;div style="font-family: times new roman, new york, \
times, serif; font-size: 12pt;"&gt;Hello guys,&lt;br&gt;&lt;div id="yiv2063759072"&gt;&lt;div \
style="color:#000;background-color:#fff;font-family:arial, helvetica, \
sans-serif;font-size:10pt;"&gt;&lt;div&gt;maybe you can help me with following issue. I have  \
created a little cloud with a host and two worker nodes using opennebula. The setup \
went  successfully until now, I am able to create VM's and move them via 
normal and live migration.&lt;br&gt;Another (possibly) important information is that I \
configured my virtual bridge on both worker nodes like this:&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;pre&gt; auto \
br0  iface br0 inet static
         address 192.168.0.[2|3]
         netmask 255.255.255.0
         network 192.168.0.0
         broadcast 192.168.0.255
         #gateway 192.168.0.1
         bridge_ports eth0
         bridge_stp on
         bridge_maxwait 0&lt;/pre&gt;&lt;br&gt;The command "brctl show" gives me following things \
back:&lt;br&gt;&lt;br&gt;&lt;pre&gt;bridge name&lt;span class="yiv2063759072tab"&gt;    bridge \
id&lt;/span&gt;&lt;span class="yiv2063759072tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv2063759072tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv2063759072tab"&gt;    &lt;/span&gt;&lt;span class="yiv2063759072tab"&gt;STP \
enabled&lt;/span&gt;&lt;span class="yiv2063759072tab"&gt;    \
interfaces&lt;br&gt;br0&lt;/span&gt;&lt;span class="yiv2063759072tab"&gt;    \
&lt;/span&gt;&lt;span class="yiv2063759072tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv2063759072tab"&gt;    8000.003005c34278&lt;/span&gt;&lt;span \
class="yiv2063759072tab"&gt;    yes&lt;/span&gt;&lt;span \
class="yiv2063759072tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv2063759072tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv2063759072tab"&gt;    eth0&lt;br&gt;&lt;/span&gt;&lt;span \
class="yiv2063759072tab"&gt;    &lt;/span&gt;&lt;span  \
class="yiv2063759072tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv2063759072tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv2063759072tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv2063759072tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv2063759072tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv2063759072tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv2063759072tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv2063759072tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv2063759072tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv2063759072tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv2063759072tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv2063759072tab"&gt;   vnet0 (&lt;- only appears on node with running \
VM)&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class="yiv2063759072tab"&gt;virbr0&lt;/span&gt;&lt;span \
class="yiv2063759072tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv2063759072tab"&gt;    &lt;/span&gt;&lt;span \
class="yiv2063759072tab"&gt; 8000.000000000000&lt;/span&gt;&lt;span  \
class="yiv2063759072tab"&gt;    yes&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;font \
style="font-family:arial, helvetica, sans-serif;" size="2"&gt;According to \
the&lt;/font&gt;&lt;font style="font-family:arial, helvetica, sans-serif;" size="2"&gt; libvirt \
wiki this setting is good as is.&lt;/font&gt; &lt;font size="2"&gt;However, the issue I'm having \
is that when I create a VM and assign a static IP to it, which looks like e.g. \
192.168.0.5, &lt;br&gt;I firstly am able to ping this VM from both&lt;/font&gt; &lt;font \
size="2"&gt;worker nodes, and also when I perform a live migration the ping stops for a \
few seconds (until the nodes realize the new route to this VM) and then &lt;br&gt;starts \
pinging normally again.&lt;br&gt;&lt;br&gt;However, when I perform a normal migration the ping \
doesn't recover anymore, but answers repeatedly with: Destination Host \
Unreachable&lt;br&gt;&lt;br&gt;Do you know what could be the problem? Where is the difference \
between a normal and live migration and how can the ping after live migrating still \
work, but after a  normal migration not?&lt;br&gt;&lt;br&gt;Thanks a lot!&lt;br&gt;Regards, \
Adnan&lt;/font&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20110726153750</emailId><senderName>Pete Ashdown</senderName><senderEmail>pashdown@xmission.com</senderEmail><timestampReceived>2011-07-26 15:37:50-0400</timestampReceived><subject>Re: [libvirt-users] insert ISO into a KVM guest</subject><body>


On 07/26/2011 08:07 AM, Jeff wrote:
&gt; There's got to be a simple way to attach an ISO to a KVM guest. I just haven't yet \
&gt; discovered it. 
&gt; I've tried adding the following stanza to my guest XML file, under the &lt;devices&gt; \
&gt; stanza and starting the guest: 
&gt; &lt;disk type='file' device='cdrom'&gt;
&gt; &lt;driver name='qemu' type='raw' /&gt;
&gt; &lt;source file='/etc/libvirt/qemu/isos/kvm1.iso' /&gt;
&gt; &lt;target dev='hda' bus='ide' /&gt;
&gt; &lt;readonly /&gt;
&gt; &lt;/disk&gt;
&gt; 
&gt; 
&gt; But I get the following:
&gt; 
&gt; error: Failed to start domain rhel6guest
&gt; error: internal error process exited while connecting to monitor: char device \
&gt;                 redirected to /dev/pts/3
&gt; qemu: could not open disk image /etc/libvirt/qemu/isos/kvm1.iso: Permission denied
&gt; 
What about the parent directory perms?

&gt; A perms issue should be easy to address one would think, but I've tried every \
&gt; possible combination of perms changes including 777. Changed ownership from root to \
&gt; qemu:qemu (though I'm running as root). I'm not running SELinux.  
&gt; Anyone have any insights on how to mount a simple ISO into a KVM guest?  Both at \
&gt; build time AND while the guest is running? 
Use the loop device on the guest itself?  IE: mount -o loop filename.iso /mnt


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20110726164043</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-07-26 16:40:43-0400</timestampReceived><subject>Re: [libvirt-users] python-libvirt for 0.9.3 leaking file descriptors</subject><body>

On Tue, Jul 26, 2011 at 06:29:58PM +0200, Matthias Bolte wrote:
&gt; 2011/7/26 Igor Serebryany &lt;igor47@moomers.org&gt;:
&gt; &gt; i've reported this issue before, so i guess this is a regression. looks
&gt; &gt; like the python bindings for 0.9.3 are leaking file descriptors:
&gt; &gt;
&gt; &gt; root@cloud1:~# python
&gt; &gt; Python 2.6.6 (r266:84292, Dec 26 2010, 22:31:48)
&gt; &gt; [GCC 4.4.5] on linux2
&gt; &gt; Type "help", "copyright", "credits" or "license" for more information.
&gt; &gt;&gt;&gt;&gt; import libvirt
&gt; &gt;&gt;&gt;&gt; libvirt.getVersion()
&gt; &gt; 9003
&gt; &gt;&gt;&gt;&gt; def openclose():
&gt; &gt; ...     c = libvirt.open('qemu:///system')
&gt; &gt; ...     c.close()
&gt; &gt; ...
&gt; &gt;&gt;&gt;&gt; import os
&gt; &gt;&gt;&gt;&gt; os.system('lsof -p %d | wc -l' % os.getpid())
&gt; &gt; 37
&gt; &gt;&gt;&gt;&gt; openclose()
&gt; &gt;&gt;&gt;&gt; os.system('lsof -p %d | wc -l' % os.getpid())
&gt; &gt; 40
&gt; &gt;&gt;&gt;&gt; openclose()
&gt; &gt;&gt;&gt;&gt; os.system('lsof -p %d | wc -l' % os.getpid())
&gt; &gt; 43
&gt; &gt;
&gt; &gt; every time I open and close a connection to libvirt, i loose 3 file
&gt; &gt; descriptors. these are a socket and two fifo pipes. i'm using the -3
&gt; &gt; build on debian sid.
&gt; &gt;
&gt; &gt; can someone test this on a fedora machine? curious if this is something
&gt; &gt; inside libvirt or a problem with the build...
&gt; 
&gt; I can reproduce this with libvirt 0.9.3, but not with current git.
&gt; Therefore, this problem seems to be fixed in git. I've you want to
&gt; backport the fix to libvirt 0.9.3 you should be able to find it using
&gt; git bisect.
&gt; 
&gt; That one of the FDs is a socket suggests that this is related to the
&gt; remote driver.

Yes, it wasn't a python bug, its a libvirt RPC client bug


commit afe8839f011c8c54c429f33ca0e6515fceb4e0fd
Author: Daniel P. Berrange &lt;berrange@redhat.com&gt;
Date:   Fri Jul 8 12:41:06 2011 +0100

    Fix leak of remote driver if final 'CLOSE' RPC call fails
    
    When closing a remote connection we issue a (fairly pointless)
    'CLOSE' RPC call to the daemon. If this fails we skip all the
    cleanup of private data, but the virConnectPtr object still
    gets released as normal. This causes a memory leak. Since the
    CLOSE RPC call is pretty pointless, just carry on freeing the
    remote driver if it fails.
    
    * src/remote/remote_driver.c: Ignore failure to issue CLOSE
      RPC call


which was in turn exposed by a libvirtd bug


commit 3cfdc57b8553cae95b8849bbcb7a4b227085cec1
Author: Daniel P. Berrange &lt;berrange@redhat.com&gt;
Date:   Fri Jul 8 12:54:29 2011 +0100

    Fix sending of reply to final RPC message
    
    The dispatch for the CLOSE RPC call was invoking the method
    virNetServerClientClose(). This caused the client connection
    to be immediately terminated. This meant the reply to the
    final RPC message was never sent. Prior to the RPC rewrite
    we merely flagged the connection for closing, and actually
    closed it when the next RPC call dispatch had completed.

Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110728160043</emailId><senderName>Whit Blauvelt</senderName><senderEmail>whit.virt@transpect.com</senderEmail><timestampReceived>2011-07-28 16:00:43-0400</timestampReceived><subject>[libvirt-users] Seg fault in 0.9.4-rc1</subject><body>

Hi,

Using virt-manager, asking to migrate a kvm domain from the same box
virt-manager is running on to another consistently results in libvirtd
faulting on the local box. Migration in the other direction, from the second
box to the box virt-manager is on, works fine.

A libvirtd log made with debug=1 is at
http://transpect.com/debug/libvirtd_segfault.log

It was doing the same thing with a recent 0.9.3 git version too. This is
with virt-manager 0.9.0.

Whit

</body></email><email><emailId>20110728171827</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-07-28 17:18:27-0400</timestampReceived><subject>Re: [libvirt-users] Seg fault in 0.9.4-rc1</subject><body>

On 07/28/2011 10:00 AM, Whit Blauvelt wrote:
&gt; Hi,
&gt;
&gt; Using virt-manager, asking to migrate a kvm domain from the same box
&gt; virt-manager is running on to another consistently results in libvirtd
&gt; faulting on the local box. Migration in the other direction, from the second
&gt; box to the box virt-manager is on, works fine.
&gt;
&gt; A libvirtd log made with debug=1 is at
&gt; http://transpect.com/debug/libvirtd_segfault.log
&gt;
&gt; It was doing the same thing with a recent 0.9.3 git version too. This is
&gt; with virt-manager 0.9.0.

Probably the same bug as for managedsave, where we are not properly 
handling monitor commands issued in parallel with waiting for the 
completion of migration.  Can you test if this patch helps?

https://www.redhat.com/archives/libvir-list/2011-July/msg01969.html

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20110727073502</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-07-27 07:35:02-0400</timestampReceived><subject>Re: [libvirt-users] lock managers</subject><body>

On Tue, Jul 26, 2011 at 04:15:45PM -0400, Whit Blauvelt wrote:
&gt; On Mon, Jul 25, 2011 at 03:32:32PM -0600, Eric Blake wrote:
&gt; 
&gt; &gt; Yes, both useful lock managers (sanlock and fcntl) work best with
&gt; &gt; the use of a shared lock directory, at which point they correctly
&gt; &gt; handle live migration between hosts.  
&gt; 
&gt; Where would I learn how to use fcntl for this? I see code for it in the
&gt; current git, but no hint on usage. Perhaps I should just be patient?

The fcntl lock manager isn't ready yet. I was trying to get it into
the 0.9.4 release, but have missed the deadline, so it will be 0.9.5
instead.

Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110728132337</emailId><senderName>"David M. Barlieb"</senderName><senderEmail>dmb@integrichain.com</senderEmail><timestampReceived>2011-07-28 13:23:37-0400</timestampReceived><subject>[libvirt-users] management tools for kvm</subject><body>

I have been installing kvm guests on a number of hosts and have been
managing them through a single virt manager on one of the hosts. I am
looking for a tool that will allow me to manage them from a windows
workstation, possibly using a web interface. Everything I've looked at
and read about seems to require a linux workstation to install on, like
oVirt or ConVirt. I am looking for a product that can run on a windows
workstation using either firefox or ie.

 

dave

 


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;meta http-equiv=Content-Type content="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 12 (filtered medium)"&gt;
&lt;style&gt;
&lt;!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.Section1
	{page:Section1;}
--&gt;
&lt;/style&gt;
&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapelayout v:ext="edit"&gt;
  &lt;o:idmap v:ext="edit" data="1" /&gt;
 &lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
&lt;/head&gt;

&lt;body lang=EN-US link=blue vlink=purple&gt;

&lt;div class=Section1&gt;

&lt;p class=MsoNormal&gt;I have been installing kvm guests on a number of hosts and
have been managing them through a single virt manager on one of the hosts. I am
looking for a tool that will allow me to manage them from a windows
workstation, possibly using a web interface. Everything I’ve looked at
and read about seems to require a linux workstation to install on, like oVirt
or ConVirt. I am looking for a product that can run on a windows workstation
using either firefox or ie.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;dave&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;



</body></email><email><emailId>20110729090856</emailId><senderName>Vegard Vesterheim</senderName><senderEmail>vegard.vesterheim@uninett.no</senderEmail><timestampReceived>2011-07-29 09:08:56-0400</timestampReceived><subject>[libvirt-users] Using libvirt with a preexisting network infrastructure</subject><body>

I have a server running Ubuntu natty (libvirt 0.8.8) with separate
ethernet interfaces. I have created an unnumbered bridge for each
interface, these are connected to an already established network
infrastructure, with preexisting DHCP and DNS services.

I would like to handle *establishment* of these bridges outside libvirt
(via /etc/network/interfaces), but still have them defined as networks
within libvirt. So, libvirt shall not *configure* the bridges, just be
aware of their existence and connect each VM to its configured
bridge. This way I can use virt-manager/libvirt to connect my virtual
hosts to the correct network. The libvirt commands net-start,
net-destroy would become no-ops. It seems that libvirt is geared towards
handling all network configuration itself, but I do not need help from
libvirt for establishing the bridges, DHCP and DNS.

I know that I can edit the &lt;interface&gt; element in the VM XML-files
after creation, to assign a virtual host to a bridge, like
this:

  &lt;interface type='bridge'&gt;
      &lt;source bridge='br22'/&gt;
      ....
  &lt;/interface&gt;

This works, but I would like to do this with libvirt mechanisms. Is this
possible?

 - Vegard V -

</body></email><email><emailId>20110729134928</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2011-07-29 13:49:28-0400</timestampReceived><subject>Re: [libvirt-users] ruby-libvirt 0.4.0</subject><body>

On 07/29/11 - 09:34:17AM, David M. Barlieb wrote:
&gt; Hi, I'm fairly new to using libvirt. I have RHEL6 servers running KVM
&gt; virtual environment. As I understand it, libvirt provides the tools to
&gt; the KVM environment so that I can create domains or virtual guests. So,
&gt; that being said, what does this ruby-libvirt provide me or enhance given
&gt; my current setup.
&gt; 
&gt;  
&gt; 
&gt; I'll understabnd if this is a little rudimentary but I really do not
&gt; know who or where else to ask these types of question. I get quite a bit
&gt; of email from the libvirt-users groups about libvirt and really have no
&gt; idea if I can or should put any of these into my current setup, or if I
&gt; should be asking RedHat this.
&gt; 
&gt;  
&gt; 
&gt; I certainly wouldn't mind testing and contributing to these effort to
&gt; enhance the libvirt tools and KVM hypervisor but think I need a better
&gt; understanding of exactly how libvirt and KVM interact and what the
&gt; enhancements bring to the table.

In the future it is usually best to keep one of the lists on an email; that
way, if I'm away or not responding, someone else can help you.  I've added
libvirt-users to this response.

In any case, you have the right idea.  Libvirt is a control plane for various
different virtualization solutions.  Arguably the most popular virtualization
solution that libvirt can control is KVM, but it can also manage Xen, VMware
ESX, LXC (linux containers), UML, etc.

Libvirt provides both tools (like virsh and libvirtd) and APIs for interacting
with virtual machines.  The APIs are things like virDomainShutdown(),
virDomainReboot(), etc.  The ruby-libvirt package is a thin wrapper around
these APIs, so that you can use this functionality from ruby programs.  That
is, you would be able to do something like:

dom.reboot
dom.shutdown

from your ruby programs.  There are also bindings for other languages such
as python, php, and perl.

There is a lot more information at http://libvirt.org, and there is more
information specifically about the ruby bindings at http://libvirt.org/ruby

-- 
Chris Lalancette

</body></email><email><emailId>20110729091509</emailId><senderName>Tom Hughes</senderName><senderEmail>tom@compton.nu</senderEmail><timestampReceived>2011-07-29 09:15:09-0400</timestampReceived><subject>Re: [libvirt-users] Using libvirt with a preexisting network infrastructure</subject><body>

On 29/07/11 10:08, Vegard Vesterheim wrote:

&gt; I have a server running Ubuntu natty (libvirt 0.8.8) with separate
&gt; ethernet interfaces. I have created an unnumbered bridge for each
&gt; interface, these are connected to an already established network
&gt; infrastructure, with preexisting DHCP and DNS services.
&gt;
&gt; I would like to handle *establishment* of these bridges outside libvirt
&gt; (via /etc/network/interfaces), but still have them defined as networks
&gt; within libvirt. So, libvirt shall not *configure* the bridges, just be
&gt; aware of their existence and connect each VM to its configured
&gt; bridge. This way I can use virt-manager/libvirt to connect my virtual
&gt; hosts to the correct network. The libvirt commands net-start,
&gt; net-destroy would become no-ops. It seems that libvirt is geared towards
&gt; handling all network configuration itself, but I do not need help from
&gt; libvirt for establishing the bridges, DHCP and DNS.

If you want to connect your VMs to existing bridges then just ignore all 
the network stuff in libvirt and tell your VMs to connect to those 
bridges - virt-manager should offer the bridges as options when you 
create an interface and you just select the one you want.

Tom

-- 
Tom Hughes (tom@compton.nu)
http://compton.nu/

</body></email><email><emailId>20110728144644</emailId><senderName>"Stefan G. Weichinger"</senderName><senderEmail>lists@xunil.at</senderEmail><timestampReceived>2011-07-28 14:46:44-0400</timestampReceived><subject>Re: [libvirt-users] management tools for kvm</subject><body>

Am 28.07.2011 15:23, schrieb David M. Barlieb:
&gt; I have been installing kvm guests on a number of hosts and have been
&gt; managing them through a single virt manager on one of the hosts. I am
&gt; looking for a tool that will allow me to manage them from a windows
&gt; workstation, possibly using a web interface. Everything I’ve looked at
&gt; and read about seems to require a linux workstation to install on, like
&gt; oVirt or ConVirt. I am looking for a product that can run on a windows
&gt; workstation using either firefox or ie.

Same here!

S

</body></email><email><emailId>20110728150627</emailId><senderName>Whit Blauvelt</senderName><senderEmail>whit.virt@transpect.com</senderEmail><timestampReceived>2011-07-28 15:06:27-0400</timestampReceived><subject>Re: [libvirt-users] management tools for kvm</subject><body>

On Thu, Jul 28, 2011 at 04:46:44PM +0200, Stefan G. Weichinger wrote:

&gt; &gt; I am looking for a product that can run on a windows workstation using
&gt; &gt; either firefox or ie.

I'd expect sometime soon to see someone develop a basic version of that
using Libvirt-php (http://libvirt.org/php/). 

Depending how you've got things set up DRBD-MC (a Java app) is getting to
the point of usefulness (http://www.drbd.org/download/drbd-mc/). It works
best if you're using DRBD &amp; Pacemaker with your VMs, but it's possible to
use just the VM-management features. 

Whit

</body></email><email><emailId>20110728171106</emailId><senderName>"Stefan G. Weichinger"</senderName><senderEmail>lists@xunil.at</senderEmail><timestampReceived>2011-07-28 17:11:06-0400</timestampReceived><subject>Re: [libvirt-users] management tools for kvm</subject><body>

Am 28.07.2011 17:06, schrieb Whit Blauvelt:

&gt; Depending how you've got things set up DRBD-MC (a Java app) is
&gt; getting to the point of usefulness
&gt; (http://www.drbd.org/download/drbd-mc/). It works best if you're
&gt; using DRBD &amp; Pacemaker with your VMs, but it's possible to use just
&gt; the VM-management features.

That looks promising at first glance, but maybe a bit too much for
installing it on the customers WinXP-box. The customers I need this for
would be overwhelmed, even with the "operator"-mode of DRBD-MC. But I
will review this closer ...

I am looking for something like

http://virt-manager.et.redhat.com/

for XP, just to give the customer a way to interact with his virtual
boxes, to check if they are running and press "Start" if they somehow
crashed or something (I monitor the VMs via script, yes, but you know ...)

Giving them putty and "virsh list" and "virsh start" is a poor thing,
especially as noobs don't see the value and power behind the
virtualization host. A GUI-centric windows-user isn't impressed by a
plain shell command ;-)

Thanks,
Stefan

</body></email><email><emailId>20110728172347</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-07-28 17:23:47-0400</timestampReceived><subject>Re: [libvirt-users] management tools for kvm</subject><body>

On 07/28/2011 11:11 AM, Stefan G. Weichinger wrote:
&gt; Am 28.07.2011 17:06, schrieb Whit Blauvelt:
&gt;
&gt;&gt; Depending how you've got things set up DRBD-MC (a Java app) is
&gt;&gt; getting to the point of usefulness
&gt;&gt; (http://www.drbd.org/download/drbd-mc/). It works best if you're
&gt;&gt; using DRBD&amp;  Pacemaker with your VMs, but it's possible to use just
&gt;&gt; the VM-management features.
&gt;
&gt; That looks promising at first glance, but maybe a bit too much for
&gt; installing it on the customers WinXP-box. The customers I need this for
&gt; would be overwhelmed, even with the "operator"-mode of DRBD-MC. But I
&gt; will review this closer ...
&gt;
&gt; I am looking for something like
&gt;
&gt; http://virt-manager.et.redhat.com/
&gt;
&gt; for XP,

Should be doable - there are existing ports of python, ssh, libvirt, and 
other prereqs to virt-manager all built for mingw, such that it should 
be possible to use virt-manager directly on windows.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org

</body></email><email><emailId>20110728172652</emailId><senderName>"Stefan G. Weichinger"</senderName><senderEmail>lists@xunil.at</senderEmail><timestampReceived>2011-07-28 17:26:52-0400</timestampReceived><subject>Re: [libvirt-users] management tools for kvm</subject><body>

Am 28.07.2011 19:23, schrieb Eric Blake:

&gt; Should be doable - there are existing ports of python, ssh, libvirt, and
&gt; other prereqs to virt-manager all built for mingw, such that it should
&gt; be possible to use virt-manager directly on windows.

Interesting. I'd be happy to hear from someone how much effort this
needs. You know, I shouldn't have to install dozens of pkgs to the
XP-box, taking hrs of work maybe ;-)

Maybe I give it a try on a test-XP tmrw.

Thanks, S

</body></email><email><emailId>20110728173350</emailId><senderName>David Ehle</senderName><senderEmail>ehle@agni.phys.iit.edu</senderEmail><timestampReceived>2011-07-28 17:33:50-0400</timestampReceived><subject>Re: [libvirt-users] management tools for kvm</subject><body>


Maybe give them $200 netbook  Ubuntu control system... or run a linux 
control station in Virtual Box on XP?

David.

On Thu, 28 Jul 2011, Stefan G. Weichinger wrote:

&gt; Am 28.07.2011 19:23, schrieb Eric Blake:
&gt;
&gt;&gt; Should be doable - there are existing ports of python, ssh, libvirt, and
&gt;&gt; other prereqs to virt-manager all built for mingw, such that it should
&gt;&gt; be possible to use virt-manager directly on windows.
&gt;
&gt; Interesting. I'd be happy to hear from someone how much effort this
&gt; needs. You know, I shouldn't have to install dozens of pkgs to the
&gt; XP-box, taking hrs of work maybe ;-)
&gt;
&gt; Maybe I give it a try on a test-XP tmrw.
&gt;
&gt; Thanks, S
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

</body></email><email><emailId>20110728175059</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-07-28 17:50:59-0400</timestampReceived><subject>Re: [libvirt-users] management tools for kvm</subject><body>

2011/7/28 Stefan G. Weichinger &lt;lists@xunil.at&gt;:
&gt; Am 28.07.2011 19:23, schrieb Eric Blake:
&gt;
&gt;&gt; Should be doable - there are existing ports of python, ssh, libvirt, and
&gt;&gt; other prereqs to virt-manager all built for mingw, such that it should
&gt;&gt; be possible to use virt-manager directly on windows.
&gt;
&gt; Interesting. I'd be happy to hear from someone how much effort this
&gt; needs. You know, I shouldn't have to install dozens of pkgs to the
&gt; XP-box, taking hrs of work maybe ;-)
&gt;
&gt; Maybe I give it a try on a test-XP tmrw.
&gt;
&gt; Thanks, S

I have that basically working, see

https://github.com/photron/msys_setup

That's a bunch of scripts that build libvirt using mingw on Windows.
It also covers virt-manager, but there are still many things to port
and fix until virt-manager works properly on Windows, as it assume a
Linux specific things in some places.

But virsh is working and tested with TCP and TLS transport. SSH
transport wasn't tested yet, so I don't know if it work properly,
maybe.

At some point there will probably be an installer for libvirt and
virt-manager for Windows, but we're not there yet. A prebuild
installer for libvirt and virsh can be found here

http://libvirt.org/windows.html

Unfortunately it's a bit outdated.

-- 
Matthias Bolte
http://photron.blogspot.com

</body></email><email><emailId>20110728194639</emailId><senderName>"Stefan G. Weichinger"</senderName><senderEmail>lists@xunil.at</senderEmail><timestampReceived>2011-07-28 19:46:39-0400</timestampReceived><subject>Re: [libvirt-users] management tools for kvm</subject><body>

Am 28.07.2011 19:50, schrieb Matthias Bolte:

&gt; I have that basically working, see
&gt; 
&gt; https://github.com/photron/msys_setup

Wow, amazing!

&gt; That's a bunch of scripts that build libvirt using mingw on Windows.
&gt; It also covers virt-manager, but there are still many things to port
&gt; and fix until virt-manager works properly on Windows, as it assume a
&gt; Linux specific things in some places.

Oh, that's unfortunate (for me).

&gt; But virsh is working and tested with TCP and TLS transport. SSH
&gt; transport wasn't tested yet, so I don't know if it work properly,
&gt; maybe.
&gt; 
&gt; At some point there will probably be an installer for libvirt and
&gt; virt-manager for Windows, but we're not there yet. A prebuild
&gt; installer for libvirt and virsh can be found here
&gt; 
&gt; http://libvirt.org/windows.html
&gt; 
&gt; Unfortunately it's a bit outdated.

Will check that soon, maybe tmrw.

Only having virsh on windows seems a bit pointless for my needs, as a
putty-session to my linux-hosts does the same CLI-based stuff ... or am
I wrong?

If I were more of a coder I would maybe be able to hack something on top
of that, small binary showing "domain importantVM is running" and giving
the chance to start/stop it. Not more.

Just think of the boss at your customers site. They need their server
and they should be able to simply start it when the power went down or
somthing, and for some reason libvirt does not start the domain even as
it has been set to autostart (I have one of those!).

-&gt;

I have a quickanddirty-solution in form of a (crontabbed) shell-script:

grep "virsh list" for "my vm is running", if error, "virsh start" it and
mail the admin (me).

This helps ... and keeps my phone quiet in the morning ...

I know there are way more sophisticated tools out of the
cluster-toolbox, but for my small customers this is overkill most of the
time.

Greets and thanks, Stefan

</body></email><email><emailId>20110728063729</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2011-07-28 06:37:29-0400</timestampReceived><subject>Re: [libvirt-users] with current libvirt git virsh expects vbox, refuses kvm define</subject><body>

On Wed, Jul 27, 2011 at 08:42:59AM -0400, Whit Blauvelt wrote:
[..]
&gt; be accepted. Clearly having libvirt recognize that the kvm hypervisor is
&gt; available, and automatically using it when the xml file specifies it, does
&gt; not take some extraordinary level of clever programming. "The xml specifies
&gt; kvm. Do I have kvm? Why, yes I do!"

  Virsh first opens a connection to an hypervisor, and then tries to 
run the commands (can be multiple one for example in shall mode).
What you're suggestion is to do some introspection on the XML, and then
change the way virsh works just for that command, that's not that
trivial nor very clean.

&gt; &gt; The initial "error: internal error unexpected domain type kvm,
&gt; &gt; expecting vbox" you saw was added recently to prevent incompatible
&gt; &gt; driver/config combinations. In you're case it highlighted that
&gt; &gt; autodetection didn't work for you as expected.
&gt; 
&gt; Fine, so when it recognizes it has the wrong driver for the config, it
&gt; should grab the right driver. No reason for it to complain to me about it.
&gt; It should simply do its job. Right? This is a bug that it doesn't?

  On the other hand what was improved recently is that if a command like
create uses the "wrong" hypervisor type in the XML we are now reporting
the expected hypervisor type instead of just failing the operation as
you got. If you try with 0.9.4-rc1 it should have that improvement,

Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

</body></email><email><emailId>20110728082450</emailId><senderName>"Stefan G. Weichinger"</senderName><senderEmail>lists@xunil.at</senderEmail><timestampReceived>2011-07-28 08:24:50-0400</timestampReceived><subject>Re: [libvirt-users] small webGUI?</subject><body>

Am 08.06.2011 10:03, schrieb Stefan G. Weichinger:
&gt; 
&gt; Greetings,
&gt; 
&gt; at a customer we run a single VM for a specific application.
&gt; 
&gt; Unfortunately this VM does not start automatically with the host
&gt; although I checked the relevant box within virtual machine manager.
&gt; 
&gt; I assume upgrading libvirt might help (we run 0.8.7-r1 right now, gentoo
&gt; linux).
&gt; 
&gt; Aside from that it would be good to have a simple WebGUI for the users
&gt; to let them press START just in case. They run Windows on their machines
&gt; so I can't give them VMM ...

Additional thought (and need):

Could I set up some of the bigger Web-GUIs and create specific users for
separate customers, which are only allowed to access and control their
own KVM/libvirt-server?

So that I as admin have bundled access to all the hosts via the GUI, and
each customer only to its own?

Stefan

</body></email><email><emailId>20110728130938</emailId><senderName>Peter Thomassen</senderName><senderEmail>mail@peter-thomassen.de</senderEmail><timestampReceived>2011-07-28 13:09:38-0400</timestampReceived><subject>[libvirt-users] qemu:///session vs qemu:///system</subject><body>

Hi,

I am running several QEMU VMs on a host machine. There's different 
persons being responsible for different VMs.

I would like to find a way to allow everybody to manage just the VMs 
they are assigned to (i.e. insert some ISO file, stop the machine and so 
on) without allowing them to disturb the other VMs.

Also, I would like to allow these persons to set up new VMs (there's 
plenty of unallocated storage) without having to ask me (root) to do it 
for them, but without allowing them to delete other VMs.
(Just setting user rights on the filesystem is not enough, as I use LVM 
volumes which are not assigned to a user in the typical sense, are they?)

I know that most of this could probably be achieved by using 
qemu:///session instead of qemu:///system. However, I read that there's 
networking issue in this case (which issues precisely?), and I am also 
not sure if there's other disadvantages like less efficient handling in 
some situations by the kernel, or whatever. Is anybody there who could 
clarify this for me?

Thank you,
Peter

</body></email><email><emailId>20110728173827</emailId><senderName>Whit Blauvelt</senderName><senderEmail>whit.virt@transpect.com</senderEmail><timestampReceived>2011-07-28 17:38:27-0400</timestampReceived><subject>Re: [libvirt-users] Seg fault in 0.9.4-rc1</subject><body>

On Thu, Jul 28, 2011 at 11:18:27AM -0600, Eric Blake wrote:

&gt; Probably the same bug as for managedsave, where we are not properly
&gt; handling monitor commands issued in parallel with waiting for the
&gt; completion of migration.  Can you test if this patch helps?
&gt; 
&gt; https://www.redhat.com/archives/libvir-list/2011-July/msg01969.html

Helps in the sense of "doesn't crash," yes. Helps in the sense of "migration
succeeds," no. It brings the migrating domain up to "paused" on the target
system, but then hangs at 0% complete forever in virt-manager.

Whit

</body></email><email><emailId>20110729081708</emailId><senderName>Nicolas Sebrecht</senderName><senderEmail>nsebrecht@piing.fr</senderEmail><timestampReceived>2011-07-29 08:17:08-0400</timestampReceived><subject>[libvirt-users]  Re: management tools for kvm</subject><body>

The 28/07/11, Stefan G. Weichinger wrote:
&gt; Am 28.07.2011 19:50, schrieb Matthias Bolte:

&gt; Only having virsh on windows seems a bit pointless for my needs, as a
&gt; putty-session to my linux-hosts does the same CLI-based stuff ... or am
&gt; I wrong?
&gt; 
&gt; If I were more of a coder I would maybe be able to hack something on top
&gt; of that, small binary showing "domain importantVM is running" and giving
&gt; the chance to start/stop it. Not more.
&gt; 
&gt; Just think of the boss at your customers site. They need their server
&gt; and they should be able to simply start it when the power went down or
&gt; somthing, and for some reason libvirt does not start the domain even as
&gt; it has been set to autostart (I have one of those!).

We have the exact same needs. We want our customers to be able to
just start/stop VMs and check the state of the machines.

Honestly, I've been disappointed in the past by the libvirt API changing
too fast (breaking our "snapshot-to-the-NAS" tool). This is why I rely on
virsh commands rather than libvirt directly, for now.

I've already started something using the same backend logic but it's not
finished and too dirty to be published.

I wonder if libvirt-php couldn't add some very simple API (not moving so
far) for our particular use case. If so, I may start a (very simple) web
interface. I guess it would be enough for most users.

-- 
Nicolas Sebrecht

</body></email><email><emailId>20110729111958</emailId><senderName>Vegard Vesterheim</senderName><senderEmail>vegard.vesterheim@uninett.no</senderEmail><timestampReceived>2011-07-29 11:19:58-0400</timestampReceived><subject>Re: [libvirt-users] Using libvirt with a preexisting network infrastructure</subject><body>

On Fri, 29 Jul 2011 10:15:09 +0100 Tom Hughes &lt;tom@compton.nu&gt; wrote:

&gt; On 29/07/11 10:08, Vegard Vesterheim wrote:
&gt;
&gt;&gt; I have a server running Ubuntu natty (libvirt 0.8.8) with separate
&gt;&gt; ethernet interfaces. I have created an unnumbered bridge for each
&gt;&gt; interface, these are connected to an already established network
&gt;&gt; infrastructure, with preexisting DHCP and DNS services.
&gt;&gt;
&gt;&gt; I would like to handle *establishment* of these bridges outside libvirt
&gt;&gt; (via /etc/network/interfaces), but still have them defined as networks
&gt;&gt; within libvirt. So, libvirt shall not *configure* the bridges, just be
&gt;&gt; aware of their existence and connect each VM to its configured
&gt;&gt; bridge. This way I can use virt-manager/libvirt to connect my virtual
&gt;&gt; hosts to the correct network. The libvirt commands net-start,
&gt;&gt; net-destroy would become no-ops. It seems that libvirt is geared towards
&gt;&gt; handling all network configuration itself, but I do not need help from
&gt;&gt; libvirt for establishing the bridges, DHCP and DNS.
&gt;
&gt; If you want to connect your VMs to existing bridges then just ignore
&gt; all the network stuff in libvirt and tell your VMs to connect to those
&gt; bridges

Yes, this is exactly what I would like to do.

&gt; - virt-manager should offer the bridges as options when you
&gt; create an interface and you just select the one you want.

I do not see my bridges as options in virt-manager, but when configuring
a network device for a VM, I can select "Specify shared device name" and
manually enter the name of an existing bridge device.

It would be nice if virt-manager could present a menu of existing
devices, or alternatively, that one could define a network in libvirt
which simply refers to the preexisting bridge, but this is good enough
for me.  Thanks.

 - Vegard V -

</body></email><email><emailId>20110729130350</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2011-07-29 13:03:50-0400</timestampReceived><subject>[libvirt-users] ANNOUNCE: ruby-libvirt 0.4.0</subject><body>

All,
     I'm pleased to announce the release of ruby-libvirt 0.4.0.  ruby-libvirt
is a ruby wrapper around the libvirt API.  Version 0.4.0 brings new APIs, more
documentation, and bugfixes:

  * Updated Domain class, implementing dom.memory_parameters=,
    dom.memory_parameters, dom.updated?, dom.migrate2, dom.migrate_to_uri2,
    dom.migrate_set_max_speed, dom.qemu_monitor_command, dom.blkio_parameters,
    dom.blkio_parameters=, dom.state, dom.open_console, dom.screenshot, and
    dom.inject_nmi
  * Implementation of the Stream class, which covers the libvirt virStream APIs
  * Add the ability to build against non-system libvirt libraries
  * Updated Error object, which now includes the libvirt code, component and
    level of the error, as well as all of the error constants from libvirt.h
  * Updated Connect class, implementing conn.sys_info, conn.stream,
    conn.interface_change_begin, conn.interface_change_commit, and
    conn.interface_change_rollback
  * Updated StorageVol class, implementing vol.download and vol.upload
  * Various bugfixes

Version 0.4.0 is available from http://libvirt.org/ruby:

Tarball: http://libvirt.org/ruby/download/ruby-libvirt-0.4.0.tgz
Gem: http://libvirt.org/ruby/download/ruby-libvirt-0.4.0.gem

It is also available from rubygems.org; to get the latest version, run:

$ gem install ruby-libvirt

As usual, if you run into questions, problems, or bugs, please feel free to
mail me (clalance@redhat.com) and/or the libvirt mailing list.

-- 
Chris Lalancette

</body></email><email><emailId>20110729140229</emailId><senderName>Jeff</senderName><senderEmail>jwk1230@gmail.com</senderEmail><timestampReceived>2011-07-29 14:02:29-0400</timestampReceived><subject>[libvirt-users] UID/GID for qemu &amp; kvm</subject><body>

We use AD infrastructure for user/group management, and GID 107 is already in use.  Can I create an AD entry for the kvm and qemu groups with different GIDs, as well as the qemu user/UID?  From looking at the libvirt package, it appears it does a getent to see if these exist and, if not, creates them locally, so I assume adding them to AD is ok - and that the GID/UID specified in the package isn't explicitly necessary.  Just looking for verification.

- Jeff



</body></email><email><emailId>20110729163555</emailId><senderName>Mohammed Naser</senderName><senderEmail>mnaser@vexxhost.com</senderEmail><timestampReceived>2011-07-29 16:35:55-0400</timestampReceived><subject>[libvirt-users] Custom storage pools/volumes</subject><body>

Hello everyone,

We're currently working with using libvirt as an abstract API to make our dealings \
with other hypervisors far easier and faster, however, we have our own storage API \
that connects/disconnects and makes LUNs available over iSCSI with iSER.

We would have loved to use a storage pool however our system implements a one target \
per LUN/VDI, therefore, we'd have to create a pool for each server.

We really would like to utilize the virStorageVolDownload / virStorageVolUpload API \
calls, however, it seems that those would only work if the storage volume is within a \
pool.

Is there a way we could possibly define a storage volume without a pool or will we \
have to create a storage pool for each individual volume?

Thank you,
Mohammed Naser
http://vexxhost.com


</body></email><email><emailId>20110729174117</emailId><senderName>Ohad Levy</senderName><senderEmail>ohadlevy@gmail.com</senderEmail><timestampReceived>2011-07-29 17:41:17-0400</timestampReceived><subject>Re: [libvirt-users] ruby-libvirt 0.4.0</subject><body>

On Fri, Jul 29, 2011 at 4:49 PM, Chris Lalancette &lt;clalance@redhat.com&gt; wrote:
&gt; On 07/29/11 - 09:34:17AM, David M. Barlieb wrote:
&gt;&gt; Hi, I'm fairly new to using libvirt. I have RHEL6 servers running KVM
&gt;&gt; virtual environment. As I understand it, libvirt provides the tools to
&gt;&gt; the KVM environment so that I can create domains or virtual guests. So,
&gt;&gt; that being said, what does this ruby-libvirt provide me or enhance given
&gt;&gt; my current setup.
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; I'll understabnd if this is a little rudimentary but I really do not
&gt;&gt; know who or where else to ask these types of question. I get quite a bit
&gt;&gt; of email from the libvirt-users groups about libvirt and really have no
&gt;&gt; idea if I can or should put any of these into my current setup, or if I
&gt;&gt; should be asking RedHat this.
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; I certainly wouldn't mind testing and contributing to these effort to
&gt;&gt; enhance the libvirt tools and KVM hypervisor but think I need a better
&gt;&gt; understanding of exactly how libvirt and KVM interact and what the
&gt;&gt; enhancements bring to the table.
&gt;
&gt; In the future it is usually best to keep one of the lists on an email; that
&gt; way, if I'm away or not responding, someone else can help you.  I've added
&gt; libvirt-users to this response.
&gt;
&gt; In any case, you have the right idea.  Libvirt is a control plane for various
&gt; different virtualization solutions.  Arguably the most popular virtualization
&gt; solution that libvirt can control is KVM, but it can also manage Xen, VMware
&gt; ESX, LXC (linux containers), UML, etc.
&gt;
&gt; Libvirt provides both tools (like virsh and libvirtd) and APIs for interacting
&gt; with virtual machines.  The APIs are things like virDomainShutdown(),
&gt; virDomainReboot(), etc.  The ruby-libvirt package is a thin wrapper around
&gt; these APIs, so that you can use this functionality from ruby programs.  That
&gt; is, you would be able to do something like:
&gt;
&gt; dom.reboot
&gt; dom.shutdown
&gt;
&gt; from your ruby programs.  There are also bindings for other languages such
&gt; as python, php, and perl.
&gt;
&gt; There is a lot more information at http://libvirt.org, and there is more
&gt; information specifically about the ruby bindings at http://libvirt.org/ruby
&gt;

If you find the binding a bit hard to follow, I've tried to create
plain ruby objects on top of Chris awesome ruby bindings.

See more at: https://github.com/ohadlevy/virt#readme

Ohad

&gt; --
&gt; Chris Lalancette
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

</body></email><email><emailId>20110608080340</emailId><senderName>"Stefan G. Weichinger"</senderName><senderEmail>lists@xunil.at</senderEmail><timestampReceived>2011-06-08 08:03:40-0400</timestampReceived><subject>[libvirt-users] small webGUI?</subject><body>


Greetings,

at a customer we run a single VM for a specific application.

Unfortunately this VM does not start automatically with the host
although I checked the relevant box within virtual machine manager.

I assume upgrading libvirt might help (we run 0.8.7-r1 right now, gentoo
linux).

Aside from that it would be good to have a simple WebGUI for the users
to let them press START just in case. They run Windows on their machines
so I can't give them VMM ...

Could you point me at the most simple GUI to do that?

I'd prefer something very lightweight without too much requirements (for
example I'd like to avoid installing mysql for that ;-) ).

Thank you, Stefan


</body></email><email><emailId>20110608012738</emailId><senderName>Alex</senderName><senderEmail>mysqlstudent@gmail.com</senderEmail><timestampReceived>2011-06-08 01:27:38-0400</timestampReceived><subject>[libvirt-users] Resizing ext4 fedora qemu guest</subject><body>

Hi,

I have a fedora14 host with a fedora15 guest and I'm trying to resize
the /home partition from 200GB to 240GB. I'm relatively new to the
virsh/guestfish commands, as well as LVM, although I think I have a
reasonable understanding. I have followed the virt-resize directions
(http://libguestfs.org/virt-resize.1.html), but it still shows 200GB:

# fdisk -l /dev/mapper/vg_custserv-lv_home

Disk /dev/mapper/vg_custserv-lv_home: 197.2 GB, 197165842432 bytes
255 heads, 63 sectors/track, 23970 cylinders, total 385089536 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disk identifier: 0x00000000

Outside of the guest, I see this:

# virt-filesystems --long --parts --lvs -h -a newdisk.img
Name                      Type       Size  Parent
/dev/vg_custserv/lv_home  lv         184G  /dev/vg_custserv
/dev/vg_custserv/lv_root  lv         50G   /dev/vg_custserv
/dev/vg_custserv/lv_swap  lv         5.9G  /dev/vg_custserv
/dev/sda1                 partition  500M  /dev/sda
/dev/sda2                 partition  240G  /dev/sda

The partition is the correct size, but it appears the volume group(?)
is not the correct size. fdisk from within the guest also shows the
correct size for the device. I've tried resize2fs from within the
guest. Does virt-resize understand the ext4 filesystem and how to
properly resize it? Is that my problem?

I've also tried using guestfish with lvresize-free without success:

&lt;fs&gt; lvresize-free /dev/mapper/vg_custserv-lv_home 100
libguestfs: error: lvresize_free:   New size (5876 extents) matches
existing size (5876 extents)
  Run `lvresize --help' for more information.

I'm really not sure what to do next. Any ideas greatly appreciated.

Thanks,
Alex

</body></email><email><emailId>20110610001122</emailId><senderName>m m</senderName><senderEmail>bk.praca@gmail.com</senderEmail><timestampReceived>2011-06-10 00:11:22-0400</timestampReceived><subject>Re: [libvirt-users] libvirt-users Digest, Vol 18, Issue 11</subject><body>

[Attachment #2 (multipart/alternative)]


I have attached all the logs (/var/log/dmesg, /var/log/libvirtd.log,
/var/log/messages, /var/log/syslog, /var/log/boot.log and info about loaded
modules /proc/modules) regarding scenatios1,2,3 (please see the README file
for simple explanation what is there). By the way, I have installed only
dnsmasq-bin (and not dnsmasq).
Have a nice day

2011/6/8 &lt;libvirt-users-request@redhat.com&gt;

&gt; Send libvirt-users mailing list submissions to
&gt;        libvirt-users@redhat.com
&gt;
&gt; To subscribe or unsubscribe via the World Wide Web, visit
&gt;        https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; or, via email, send a message with subject or body 'help' to
&gt;        libvirt-users-request@redhat.com
&gt;
&gt; You can reach the person managing the list at
&gt;        libvirt-users-owner@redhat.com
&gt;
&gt; When replying, please edit your Subject line so it is more specific
&gt; than "Re: Contents of libvirt-users digest..."
&gt;
&gt;
&gt; Today's Topics:
&gt;
&gt;   1. Re: libvirt-users Digest, Vol 18, Issue 7(libvirt-bin MOSTLY
&gt;      fails to create default virtual network) (m m)
&gt;
&gt;
&gt; ----------------------------------------------------------------------
&gt;
&gt; Message: 1
&gt; Date: Wed, 8 Jun 2011 08:28:19 -0500
&gt; From: m m &lt;bk.praca@gmail.com&gt;
&gt; To: libvirt-users@redhat.com
&gt; Subject: Re: [libvirt-users] libvirt-users Digest, Vol 18, Issue
&gt;        7(libvirt-bin MOSTLY fails to create default virtual network)
&gt; Message-ID: &lt;BANLkTikt49i78OJfzBgufoesv3C-Pjrdjw@mail.gmail.com&gt;
&gt; Content-Type: text/plain; charset="iso-8859-1"
&gt;
&gt; I have attached all the logs (/var/log/dmesg, /var/log/libvirtd.log,
&gt; /var/log/messages, /var/log/syslog, /var/log/boot.log and info about loaded
&gt; modules /proc/modules) regarding scenatios1,2,3 (please see the README file
&gt; for simple explanation what is there). By the way, I have installed only
&gt; dnsmasq-bin (and not dnsmasq).
&gt; Have a nice day
&gt;
&gt; 2011/6/6 &lt;libvirt-users-request@redhat.com&gt;
&gt;
&gt; &gt; Send libvirt-users mailing list submissions to
&gt; &gt;        libvirt-users@redhat.com
&gt; &gt;
&gt; &gt; To subscribe or unsubscribe via the World Wide Web, visit
&gt; &gt;        https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; &gt; or, via email, send a message with subject or body 'help' to
&gt; &gt;        libvirt-users-request@redhat.com
&gt; &gt;
&gt; &gt; You can reach the person managing the list at
&gt; &gt;        libvirt-users-owner@redhat.com
&gt; &gt;
&gt; &gt; When replying, please edit your Subject line so it is more specific
&gt; &gt; than "Re: Contents of libvirt-users digest..."
&gt; &gt;
&gt; &gt;
&gt; &gt; Today's Topics:
&gt; &gt;
&gt; &gt;   1. libvirt-bin MOSTLY fails to create default virtual        network (m
&gt; &gt; m)
&gt; &gt;
&gt; &gt;
&gt; &gt; ----------------------------------------------------------------------
&gt; &gt;
&gt; &gt; Message: 1
&gt; &gt; Date: Mon, 6 Jun 2011 14:24:04 -0500
&gt; &gt; From: m m &lt;bk.praca@gmail.com&gt;
&gt; &gt; To: libvirt-users@redhat.com
&gt; &gt; Subject: [libvirt-users] libvirt-bin MOSTLY fails to create default
&gt; &gt;        virtual network
&gt; &gt; Message-ID: &lt;BANLkTinrE80HURSwJUUv28_v9HB9mRxNNw@mail.gmail.com&gt;
&gt; &gt; Content-Type: text/plain; charset="iso-8859-1"
&gt; &gt;
&gt; &gt; I have observed 3 scenarios after I reboot the host with 2 guests (which
&gt; &gt; are
&gt; &gt; supposed to autostart after boot/reboot of the host):
&gt; &gt; 1. Default network is created but I can not ping guests. Gests don't have
&gt; &gt; assigned IP address or they both have IP address 192.168.122.100.
&gt; &gt; 2. Default network is not created.
&gt; &gt; 3. Default netork is properly created and everything works fine.
&gt; &gt; In each case guests are started and they work properly. Cases 1. and 2.
&gt; &gt; happen a lot more often then case 3.
&gt; &gt;
&gt; &gt; My solutions:
&gt; &gt; - When I restart libvirt-bin then everything is fine.
&gt; &gt; - When I set 'sleep 40' in 'pre-start' section of
&gt; &gt; /etc/init/libvirt-bin.conf
&gt; &gt; and modify 'start on' section in the following way:
&gt; &gt;
&gt; &gt; start on (runlevel [2345] and net-device-up IFACE=br0)
&gt; &gt;
&gt; &gt; then everything works fine.
&gt; &gt;
&gt; &gt;
&gt; &gt; However, none of the above solutions indeed solves the problem. Please,
&gt; let
&gt; &gt; me know if there is solution to this problem or what are your suggestions
&gt; &gt; regarding this issue.
&gt; &gt;
&gt; &gt; ****
&gt; &gt; HOST$ uname -a
&gt; &gt; Linux ras 2.6.32-32-server #62-Ubuntu SMP Wed Apr 20 22:07:43 UTC 2011
&gt; &gt; x86_64 GNU/Linux
&gt; &gt;
&gt; &gt; GUEST1 and GUEST2
&gt; &gt; $ uname -a
&gt; &gt; Linux server1-desktop 2.6.32-32-generic #62-Ubuntu SMP Wed Apr 20
&gt; 21:54:21
&gt; &gt; UTC 2011 i686 GNU/Linux
&gt; &gt;
&gt; &gt; HOST$ libvirtd --version
&gt; &gt; libvirtd (libvirt) 0.7.5
&gt; &gt;
&gt; &gt; My idea was that some kernel modules sometimes are loaded before
&gt; &gt; libvirt-bin
&gt; &gt; starts, and sometimes libvirt-bin starts earlier, or in the middle of
&gt; &gt; loading of these modules, that is why 3 scenarios can be observed.
&gt; &gt; That is why I have added:
&gt; &gt;  cp /proc/modules /home/wsadmin2/modules1
&gt; &gt;  cp /proc/modules /home/wsadmin2/modules2
&gt; &gt; to 'pre-start' and 'post-start' parts respectively of
&gt; &gt; /etc/init/libvirt-bin.conf.
&gt; &gt;
&gt; &gt; Of course, beween execution of
&gt; &gt; - pre-start part
&gt; &gt; - exec /usr/sbin/libvirtd -d
&gt; &gt; - post-start part
&gt; &gt; other kernel modules can be loaded, so we can not be sure which
&gt; additional
&gt; &gt; modules in file 'modules2' were indeed loaded before libvirtd was
&gt; actually
&gt; &gt; started.
&gt; &gt;
&gt; &gt; Here are my observations:
&gt; &gt; Scenatio 1.
&gt; &gt; 33 (fixed) modules were logged - call them BASE MODULES.
&gt; &gt;
&gt; &gt; Scenatio 2.
&gt; &gt; Beside BASE MODULES + the following modules were loaded:
&gt; &gt;
&gt; &gt; &gt; iptable_filter 1841 0 - Live 0xffffffffa007c000
&gt; &gt; &gt; ip_tables 18201 1 iptable_filter, Live 0xffffffffa0172000
&gt; &gt; &gt; x_tables 22361 1 ip_tables, Live 0xffffffffa0164000
&gt; &gt;
&gt; &gt; Scenatio 3.
&gt; &gt; Beside BASE MODULES + the following modules were loaded:
&gt; &gt;
&gt; &gt; $ diff modules1 modules2
&gt; &gt; 1c1,6
&gt; &gt; &lt; iptable_filter 1841 0 - Live 0xffffffffa008b000
&gt; &gt; ---
&gt; &gt; &gt; xt_state 1490 14 - Live 0xffffffffa01ab000
&gt; &gt; &gt; xt_tcpudp 2667 12 - Live 0xffffffffa01a5000
&gt; &gt; &gt; nf_conntrack_ipv4 12742 14 - Live 0xffffffffa019b000
&gt; &gt; &gt; nf_conntrack 73326 2 xt_state,nf_conntrack_ipv4, Live
&gt; 0xffffffffa017d000
&gt; &gt; &gt; nf_defrag_ipv4 1481 1 nf_conntrack_ipv4, Live 0xffffffffa0177000
&gt; &gt; &gt; iptable_filter 1841 1 - Live 0xffffffffa008b000
&gt; &gt; 3c8
&gt; &gt; &lt; x_tables 22361 1 ip_tables, Live 0xffffffffa0162000
&gt; &gt; ---
&gt; &gt; &gt; x_tables 22361 3 xt_state,xt_tcpudp,ip_tables, Live 0xffffffffa0162000
&gt; &gt;
&gt; &gt; Other observations:
&gt; &gt; Scenatio 1.
&gt; &gt; No errors in libvirtd.log
&gt; &gt; Scenario 2.
&gt; &gt;
&gt; &gt; 10:06:06.980: error : networkAddIptablesRules:750 : failed to add
&gt; iptables
&gt; &gt; rule to allow DHCP requests from 'virbr0': Invalid argument
&gt; &gt; (...)
&gt; &gt; 10:06:08.630: error : qemudNetworkIfaceConnect:1445 : Failed to add tap
&gt; &gt; interface to bridge 'virbr0': No such device
&gt; &gt; 10:06:08.630: error : qemuAutostartDomain:584 : Failed to autostart VM
&gt; &gt; 'cluster_server1': Failed to add tap interface to bridge 'virbr0': No
&gt; such
&gt; &gt; device
&gt; &gt;
&gt; &gt; 10:06:08.921: info : qemudDispatchSignalEvent:390 : Received unexpected
&gt; &gt; signal 17
&gt; &gt; 10:06:08.927: debug : virExecWithHook:617 : LC_ALL=C /usr/bin/kvm -help
&gt; &gt; 10:06:08.938: info : qemudDispatchSignalEvent:390 : Received unexpected
&gt; &gt; signal 17
&gt; &gt; 10:06:09.000: error : qemudNetworkIfaceConnect:1445 : Failed to add tap
&gt; &gt; interface to bridge 'virbr0': No such device
&gt; &gt; 10:06:09.000: error : qemuAutostartDomain:584 : Failed to autostart VM
&gt; &gt; 'cluster_server2': Failed to add tap interface to bridge 'virbr0': No
&gt; such
&gt; &gt; device
&gt; &gt; (...)
&gt; &gt; Scenatio 3.
&gt; &gt; No errors in libvirtd.log
&gt; &gt;
&gt; &gt;
&gt; &gt; I didn't see any valuable logs in /var/log/boot.log, /var/log/messages,
&gt; &gt; /var/log/syslog. Please let me know if you want to see them anyway or
&gt; have
&gt; &gt; any suggestions right away.
&gt; &gt; -------------- next part --------------
&gt; &gt; An HTML attachment was scrubbed...
&gt; &gt; URL: &lt;
&gt; &gt;
&gt; https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment.html
&gt; &gt; &gt;
&gt; &gt; -------------- next part --------------
&gt; &gt; A non-text attachment was scrubbed...
&gt; &gt; Name: scenario1
&gt; &gt; Type: application/octet-stream
&gt; &gt; Size: 19317 bytes
&gt; &gt; Desc: not available
&gt; &gt; URL: &lt;
&gt; &gt;
&gt; https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment.obj
&gt; &gt; &gt;
&gt; &gt; -------------- next part --------------
&gt; &gt; A non-text attachment was scrubbed...
&gt; &gt; Name: scenario2
&gt; &gt; Type: application/octet-stream
&gt; &gt; Size: 8294 bytes
&gt; &gt; Desc: not available
&gt; &gt; URL: &lt;
&gt; &gt;
&gt; https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment-0001.obj
&gt; &gt; &gt;
&gt; &gt; -------------- next part --------------
&gt; &gt; A non-text attachment was scrubbed...
&gt; &gt; Name: scenario3
&gt; &gt; Type: application/octet-stream
&gt; &gt; Size: 2366 bytes
&gt; &gt; Desc: not available
&gt; &gt; URL: &lt;
&gt; &gt;
&gt; https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment-0002.obj
&gt; &gt; &gt;
&gt; &gt; -------------- next part --------------
&gt; &gt; A non-text attachment was scrubbed...
&gt; &gt; Name: libvirt-bin.conf
&gt; &gt; Type: application/octet-stream
&gt; &gt; Size: 924 bytes
&gt; &gt; Desc: not available
&gt; &gt; URL: &lt;
&gt; &gt;
&gt; https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment-0003.obj
&gt; &gt; &gt;
&gt; &gt;
&gt; &gt; ------------------------------
&gt; &gt;
&gt; &gt; _______________________________________________
&gt; &gt; libvirt-users mailing list
&gt; &gt; libvirt-users@redhat.com
&gt; &gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; &gt;
&gt; &gt; End of libvirt-users Digest, Vol 18, Issue 7
&gt; &gt; ********************************************
&gt; &gt;
&gt; -------------- next part --------------
&gt; An HTML attachment was scrubbed...
&gt; URL: &lt;
&gt; https://www.redhat.com/archives/libvirt-users/attachments/20110608/625b332f/attachment.html
&gt; &gt;
&gt; -------------- next part --------------
&gt; A non-text attachment was scrubbed...
&gt; Name: LucidClusterStack.rar
&gt; Type: application/rar
&gt; Size: 4473008 bytes
&gt; Desc: not available
&gt; URL: &lt;
&gt; https://www.redhat.com/archives/libvirt-users/attachments/20110608/625b332f/attachment.bin
&gt; &gt;
&gt;
&gt; ------------------------------
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;
&gt; End of libvirt-users Digest, Vol 18, Issue 11
&gt; *********************************************
&gt;

[Attachment #5 (text/html)]

I have attached all the logs (/var/log/dmesg, /var/log/libvirtd.log, 
/var/log/messages, /var/log/syslog, /var/log/boot.log and info about 
loaded modules /proc/modules) regarding scenatios1,2,3 (please see the 
README file for simple explanation what is there). By the way, I have 
installed only dnsmasq-bin (and not dnsmasq).&lt;br&gt;
Have a nice day&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;2011/6/8  &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:libvirt-users-request@redhat.com"&gt;libvirt-users-request@redhat.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, \
204, 204); padding-left: 1ex;"&gt; Send libvirt-users mailing list submissions to&lt;br&gt;
        &lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
&lt;br&gt;
To subscribe or unsubscribe via the World Wide Web, visit&lt;br&gt;
        &lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; or, via \
                email, send a message with subject or body 'help' to&lt;br&gt;
        &lt;a href="mailto:libvirt-users-request@redhat.com"&gt;libvirt-users-request@redhat.com&lt;/a&gt;&lt;br&gt;
 &lt;br&gt;
You can reach the person managing the list at&lt;br&gt;
        &lt;a href="mailto:libvirt-users-owner@redhat.com"&gt;libvirt-users-owner@redhat.com&lt;/a&gt;&lt;br&gt;
 &lt;br&gt;
When replying, please edit your Subject line so it is more specific&lt;br&gt;
than "Re: Contents of libvirt-users digest..."&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Today's Topics:&lt;br&gt;
&lt;br&gt;
   1. Re: libvirt-users Digest, Vol 18, Issue 7(libvirt-bin MOSTLY&lt;br&gt;
      fails to create default virtual network) (m m)&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
----------------------------------------------------------------------&lt;br&gt;
&lt;br&gt;
Message: 1&lt;br&gt;
Date: Wed, 8 Jun 2011 08:28:19 -0500&lt;br&gt;
From: m m &lt;&lt;a href="mailto:bk.praca@gmail.com"&gt;bk.praca@gmail.com&lt;/a&gt;&gt;&lt;br&gt;
To: &lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
Subject: Re: [libvirt-users] libvirt-users Digest, Vol 18, Issue&lt;br&gt;
        7(libvirt-bin MOSTLY fails to create default virtual network)&lt;br&gt;
Message-ID: &lt;&lt;a href="mailto:BANLkTikt49i78OJfzBgufoesv3C-Pjrdjw@mail.gmail.com"&gt;BANLkTikt49i78OJfzBgufoesv3C-Pjrdjw@mail.gmail.com&lt;/a&gt;&gt;&lt;br&gt;
                
Content-Type: text/plain; charset="iso-8859-1"&lt;br&gt;
&lt;br&gt;
I have attached all the logs (/var/log/dmesg, /var/log/libvirtd.log,&lt;br&gt;
/var/log/messages, /var/log/syslog, /var/log/boot.log and info about loaded&lt;br&gt;
modules /proc/modules) regarding scenatios1,2,3 (please see the README file&lt;br&gt;
for simple explanation what is there). By the way, I have installed only&lt;br&gt;
dnsmasq-bin (and not dnsmasq).&lt;br&gt;
Have a nice day&lt;br&gt;
&lt;br&gt;
2011/6/6 &lt;&lt;a href="mailto:libvirt-users-request@redhat.com"&gt;libvirt-users-request@redhat.com&lt;/a&gt;&gt;&lt;br&gt;
 &lt;br&gt;
&gt; Send libvirt-users mailing list submissions to&lt;br&gt;
&gt;        &lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
 &gt;&lt;br&gt;
&gt; To subscribe or unsubscribe via the World Wide Web, visit&lt;br&gt;
&gt;        &lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; &gt; \
or, via email, send a message with subject or body 'help' to&lt;br&gt; &gt;        \
&lt;a href="mailto:libvirt-users-request@redhat.com"&gt;libvirt-users-request@redhat.com&lt;/a&gt;&lt;br&gt;
 &gt;&lt;br&gt;
&gt; You can reach the person managing the list at&lt;br&gt;
&gt;        &lt;a href="mailto:libvirt-users-owner@redhat.com"&gt;libvirt-users-owner@redhat.com&lt;/a&gt;&lt;br&gt;
 &gt;&lt;br&gt;
&gt; When replying, please edit your Subject line so it is more specific&lt;br&gt;
&gt; than "Re: Contents of libvirt-users digest..."&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt; Today's Topics:&lt;br&gt;
&gt;&lt;br&gt;
&gt;   1. libvirt-bin MOSTLY fails to create default virtual        network (m&lt;br&gt;
&gt; m)&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt; ----------------------------------------------------------------------&lt;br&gt;
&gt;&lt;br&gt;
&gt; Message: 1&lt;br&gt;
&gt; Date: Mon, 6 Jun 2011 14:24:04 -0500&lt;br&gt;
&gt; From: m m &lt;&lt;a href="mailto:bk.praca@gmail.com"&gt;bk.praca@gmail.com&lt;/a&gt;&gt;&lt;br&gt;
&gt; To: &lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
&gt; Subject: [libvirt-users] libvirt-bin MOSTLY fails to create default&lt;br&gt;
&gt;        virtual network&lt;br&gt;
&gt; Message-ID: &lt;&lt;a \
href="mailto:BANLkTinrE80HURSwJUUv28_v9HB9mRxNNw@mail.gmail.com"&gt;BANLkTinrE80HURSwJUUv28_v9HB9mRxNNw@mail.gmail.com&lt;/a&gt;&gt;&lt;br&gt;
 &gt; Content-Type: text/plain; charset="iso-8859-1"&lt;br&gt;
&gt;&lt;br&gt;
&gt; I have observed 3 scenarios after I reboot the host with 2 guests (which&lt;br&gt;
&gt; are&lt;br&gt;
&gt; supposed to autostart after boot/reboot of the host):&lt;br&gt;
&gt; 1. Default network is created but I can not ping guests. Gests don't \
have&lt;br&gt; &gt; assigned IP address or they both have IP address 192.168.122.100.&lt;br&gt;
&gt; 2. Default network is not created.&lt;br&gt;
&gt; 3. Default netork is properly created and everything works fine.&lt;br&gt;
&gt; In each case guests are started and they work properly. Cases 1. and 2.&lt;br&gt;
&gt; happen a lot more often then case 3.&lt;br&gt;
&gt;&lt;br&gt;
&gt; My solutions:&lt;br&gt;
&gt; - When I restart libvirt-bin then everything is fine.&lt;br&gt;
&gt; - When I set 'sleep 40' in 'pre-start' section of&lt;br&gt;
&gt; /etc/init/libvirt-bin.conf&lt;br&gt;
&gt; and modify 'start on' section in the following way:&lt;br&gt;
&gt;&lt;br&gt;
&gt; start on (runlevel [2345] and net-device-up IFACE=br0)&lt;br&gt;
&gt;&lt;br&gt;
&gt; then everything works fine.&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt; However, none of the above solutions indeed solves the problem. Please, let&lt;br&gt;
&gt; me know if there is solution to this problem or what are your suggestions&lt;br&gt;
&gt; regarding this issue.&lt;br&gt;
&gt;&lt;br&gt;
&gt; ****&lt;br&gt;
&gt; HOST$ uname -a&lt;br&gt;
&gt; Linux ras 2.6.32-32-server #62-Ubuntu SMP Wed Apr 20 22:07:43 UTC 2011&lt;br&gt;
&gt; x86_64 GNU/Linux&lt;br&gt;
&gt;&lt;br&gt;
&gt; GUEST1 and GUEST2&lt;br&gt;
&gt; $ uname -a&lt;br&gt;
&gt; Linux server1-desktop 2.6.32-32-generic #62-Ubuntu SMP Wed Apr 20 21:54:21&lt;br&gt;
&gt; UTC 2011 i686 GNU/Linux&lt;br&gt;
&gt;&lt;br&gt;
&gt; HOST$ libvirtd --version&lt;br&gt;
&gt; libvirtd (libvirt) 0.7.5&lt;br&gt;
&gt;&lt;br&gt;
&gt; My idea was that some kernel modules sometimes are loaded before&lt;br&gt;
&gt; libvirt-bin&lt;br&gt;
&gt; starts, and sometimes libvirt-bin starts earlier, or in the middle of&lt;br&gt;
&gt; loading of these modules, that is why 3 scenarios can be observed.&lt;br&gt;
&gt; That is why I have added:&lt;br&gt;
&gt;  cp /proc/modules /home/wsadmin2/modules1&lt;br&gt;
&gt;  cp /proc/modules /home/wsadmin2/modules2&lt;br&gt;
&gt; to 'pre-start' and 'post-start' parts respectively of&lt;br&gt;
&gt; /etc/init/libvirt-bin.conf.&lt;br&gt;
&gt;&lt;br&gt;
&gt; Of course, beween execution of&lt;br&gt;
&gt; - pre-start part&lt;br&gt;
&gt; - exec /usr/sbin/libvirtd -d&lt;br&gt;
&gt; - post-start part&lt;br&gt;
&gt; other kernel modules can be loaded, so we can not be sure which additional&lt;br&gt;
&gt; modules in file 'modules2' were indeed loaded before libvirtd was \
actually&lt;br&gt; &gt; started.&lt;br&gt;
&gt;&lt;br&gt;
&gt; Here are my observations:&lt;br&gt;
&gt; Scenatio 1.&lt;br&gt;
&gt; 33 (fixed) modules were logged - call them BASE MODULES.&lt;br&gt;
&gt;&lt;br&gt;
&gt; Scenatio 2.&lt;br&gt;
&gt; Beside BASE MODULES + the following modules were loaded:&lt;br&gt;
&gt;&lt;br&gt;
&gt; &gt; iptable_filter 1841 0 - Live 0xffffffffa007c000&lt;br&gt;
&gt; &gt; ip_tables 18201 1 iptable_filter, Live 0xffffffffa0172000&lt;br&gt;
&gt; &gt; x_tables 22361 1 ip_tables, Live 0xffffffffa0164000&lt;br&gt;
&gt;&lt;br&gt;
&gt; Scenatio 3.&lt;br&gt;
&gt; Beside BASE MODULES + the following modules were loaded:&lt;br&gt;
&gt;&lt;br&gt;
&gt; $ diff modules1 modules2&lt;br&gt;
&gt; 1c1,6&lt;br&gt;
&gt; &lt; iptable_filter 1841 0 - Live 0xffffffffa008b000&lt;br&gt;
&gt; ---&lt;br&gt;
&gt; &gt; xt_state 1490 14 - Live 0xffffffffa01ab000&lt;br&gt;
&gt; &gt; xt_tcpudp 2667 12 - Live 0xffffffffa01a5000&lt;br&gt;
&gt; &gt; nf_conntrack_ipv4 12742 14 - Live 0xffffffffa019b000&lt;br&gt;
&gt; &gt; nf_conntrack 73326 2 xt_state,nf_conntrack_ipv4, Live \
0xffffffffa017d000&lt;br&gt; &gt; &gt; nf_defrag_ipv4 1481 1 nf_conntrack_ipv4, Live \
0xffffffffa0177000&lt;br&gt; &gt; &gt; iptable_filter 1841 1 - Live 0xffffffffa008b000&lt;br&gt;
&gt; 3c8&lt;br&gt;
&gt; &lt; x_tables 22361 1 ip_tables, Live 0xffffffffa0162000&lt;br&gt;
&gt; ---&lt;br&gt;
&gt; &gt; x_tables 22361 3 xt_state,xt_tcpudp,ip_tables, Live 0xffffffffa0162000&lt;br&gt;
&gt;&lt;br&gt;
&gt; Other observations:&lt;br&gt;
&gt; Scenatio 1.&lt;br&gt;
&gt; No errors in libvirtd.log&lt;br&gt;
&gt; Scenario 2.&lt;br&gt;
&gt;&lt;br&gt;
&gt; 10:06:06.980: error : networkAddIptablesRules:750 : failed to add iptables&lt;br&gt;
&gt; rule to allow DHCP requests from 'virbr0': Invalid argument&lt;br&gt;
&gt; (...)&lt;br&gt;
&gt; 10:06:08.630: error : qemudNetworkIfaceConnect:1445 : Failed to add tap&lt;br&gt;
&gt; interface to bridge 'virbr0': No such device&lt;br&gt;
&gt; 10:06:08.630: error : qemuAutostartDomain:584 : Failed to autostart VM&lt;br&gt;
&gt; 'cluster_server1': Failed to add tap interface to bridge \
'virbr0': No such&lt;br&gt; &gt; device&lt;br&gt;
&gt;&lt;br&gt;
&gt; 10:06:08.921: info : qemudDispatchSignalEvent:390 : Received unexpected&lt;br&gt;
&gt; signal 17&lt;br&gt;
&gt; 10:06:08.927: debug : virExecWithHook:617 : LC_ALL=C /usr/bin/kvm -help&lt;br&gt;
&gt; 10:06:08.938: info : qemudDispatchSignalEvent:390 : Received unexpected&lt;br&gt;
&gt; signal 17&lt;br&gt;
&gt; 10:06:09.000: error : qemudNetworkIfaceConnect:1445 : Failed to add tap&lt;br&gt;
&gt; interface to bridge 'virbr0': No such device&lt;br&gt;
&gt; 10:06:09.000: error : qemuAutostartDomain:584 : Failed to autostart VM&lt;br&gt;
&gt; 'cluster_server2': Failed to add tap interface to bridge \
'virbr0': No such&lt;br&gt; &gt; device&lt;br&gt;
&gt; (...)&lt;br&gt;
&gt; Scenatio 3.&lt;br&gt;
&gt; No errors in libvirtd.log&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt; I didn't see any valuable logs in /var/log/boot.log, /var/log/messages,&lt;br&gt;
&gt; /var/log/syslog. Please let me know if you want to see them anyway or have&lt;br&gt;
&gt; any suggestions right away.&lt;br&gt;
&gt; -------------- next part --------------&lt;br&gt;
&gt; An HTML attachment was scrubbed...&lt;br&gt;
&gt; URL: &lt;&lt;br&gt;
&gt; &lt;a href="https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment.html" \
target="_blank"&gt;https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment.html&lt;/a&gt;&lt;br&gt;


&gt; &gt;&lt;br&gt;
&gt; -------------- next part --------------&lt;br&gt;
&gt; A non-text attachment was scrubbed...&lt;br&gt;
&gt; Name: scenario1&lt;br&gt;
&gt; Type: application/octet-stream&lt;br&gt;
&gt; Size: 19317 bytes&lt;br&gt;
&gt; Desc: not available&lt;br&gt;
&gt; URL: &lt;&lt;br&gt;
&gt; &lt;a href="https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment.obj" \
target="_blank"&gt;https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment.obj&lt;/a&gt;&lt;br&gt;


&gt; &gt;&lt;br&gt;
&gt; -------------- next part --------------&lt;br&gt;
&gt; A non-text attachment was scrubbed...&lt;br&gt;
&gt; Name: scenario2&lt;br&gt;
&gt; Type: application/octet-stream&lt;br&gt;
&gt; Size: 8294 bytes&lt;br&gt;
&gt; Desc: not available&lt;br&gt;
&gt; URL: &lt;&lt;br&gt;
&gt; &lt;a href="https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment-0001.obj" \
target="_blank"&gt;https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment-0001.obj&lt;/a&gt;&lt;br&gt;


&gt; &gt;&lt;br&gt;
&gt; -------------- next part --------------&lt;br&gt;
&gt; A non-text attachment was scrubbed...&lt;br&gt;
&gt; Name: scenario3&lt;br&gt;
&gt; Type: application/octet-stream&lt;br&gt;
&gt; Size: 2366 bytes&lt;br&gt;
&gt; Desc: not available&lt;br&gt;
&gt; URL: &lt;&lt;br&gt;
&gt; &lt;a href="https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment-0002.obj" \
target="_blank"&gt;https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment-0002.obj&lt;/a&gt;&lt;br&gt;


&gt; &gt;&lt;br&gt;
&gt; -------------- next part --------------&lt;br&gt;
&gt; A non-text attachment was scrubbed...&lt;br&gt;
&gt; Name: libvirt-bin.conf&lt;br&gt;
&gt; Type: application/octet-stream&lt;br&gt;
&gt; Size: 924 bytes&lt;br&gt;
&gt; Desc: not available&lt;br&gt;
&gt; URL: &lt;&lt;br&gt;
&gt; &lt;a href="https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment-0003.obj" \
target="_blank"&gt;https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment-0003.obj&lt;/a&gt;&lt;br&gt;


&gt; &gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt; ------------------------------&lt;br&gt;
&gt;&lt;br&gt;
&gt; _______________________________________________&lt;br&gt;
&gt; libvirt-users mailing list&lt;br&gt;
&gt; &lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
&gt; &lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; \
&gt;&lt;br&gt; &gt; End of libvirt-users Digest, Vol 18, Issue 7&lt;br&gt;
&gt; ********************************************&lt;br&gt;
&gt;&lt;br&gt;
-------------- next part --------------&lt;br&gt;
An HTML attachment was scrubbed...&lt;br&gt;
URL: &lt;&lt;a href="https://www.redhat.com/archives/libvirt-users/attachments/20110608/625b332f/attachment.html" \
target="_blank"&gt;https://www.redhat.com/archives/libvirt-users/attachments/20110608/625b332f/attachment.html&lt;/a&gt;&gt;&lt;br&gt;


-------------- next part --------------&lt;br&gt;
A non-text attachment was scrubbed...&lt;br&gt;
Name: LucidClusterStack.rar&lt;br&gt;
Type: application/rar&lt;br&gt;
Size: 4473008 bytes&lt;br&gt;
Desc: not available&lt;br&gt;
URL: &lt;&lt;a href="https://www.redhat.com/archives/libvirt-users/attachments/20110608/625b332f/attachment.bin" \
target="_blank"&gt;https://www.redhat.com/archives/libvirt-users/attachments/20110608/625b332f/attachment.bin&lt;/a&gt;&gt;&lt;br&gt;


&lt;br&gt;
------------------------------&lt;br&gt;
&lt;br&gt;
_______________________________________________&lt;br&gt;
libvirt-users mailing list&lt;br&gt;
&lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
&lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; &lt;br&gt;
End of libvirt-users Digest, Vol 18, Issue 11&lt;br&gt;
*********************************************&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;

--90e6ba6e8eda10d3c304a55069fa--


["LucidClusterStack.rar" (application/rar)]

</body></email><email><emailId>20110606192404</emailId><senderName>m m</senderName><senderEmail>bk.praca@gmail.com</senderEmail><timestampReceived>2011-06-06 19:24:04-0400</timestampReceived><subject>[libvirt-users] libvirt-bin MOSTLY fails to create default virtual network</subject><body>

[Attachment #2 (multipart/alternative)]


I have observed 3 scenarios after I reboot the host with 2 guests (which are
supposed to autostart after boot/reboot of the host):
1. Default network is created but I can not ping guests. Gests don't have
assigned IP address or they both have IP address 192.168.122.100.
2. Default network is not created.
3. Default netork is properly created and everything works fine.
In each case guests are started and they work properly. Cases 1. and 2.
happen a lot more often then case 3.

My solutions:
- When I restart libvirt-bin then everything is fine.
- When I set 'sleep 40' in 'pre-start' section of /etc/init/libvirt-bin.conf
and modify 'start on' section in the following way:

start on (runlevel [2345] and net-device-up IFACE=br0)

then everything works fine.


However, none of the above solutions indeed solves the problem. Please, let
me know if there is solution to this problem or what are your suggestions
regarding this issue.

****
HOST$ uname -a
Linux ras 2.6.32-32-server #62-Ubuntu SMP Wed Apr 20 22:07:43 UTC 2011
x86_64 GNU/Linux

GUEST1 and GUEST2
$ uname -a
Linux server1-desktop 2.6.32-32-generic #62-Ubuntu SMP Wed Apr 20 21:54:21
UTC 2011 i686 GNU/Linux

HOST$ libvirtd --version
libvirtd (libvirt) 0.7.5

My idea was that some kernel modules sometimes are loaded before libvirt-bin
starts, and sometimes libvirt-bin starts earlier, or in the middle of
loading of these modules, that is why 3 scenarios can be observed.
That is why I have added:
 cp /proc/modules /home/wsadmin2/modules1
 cp /proc/modules /home/wsadmin2/modules2
to 'pre-start' and 'post-start' parts respectively of
/etc/init/libvirt-bin.conf.

Of course, beween execution of
- pre-start part
- exec /usr/sbin/libvirtd -d
- post-start part
other kernel modules can be loaded, so we can not be sure which additional
modules in file 'modules2' were indeed loaded before libvirtd was actually
started.

Here are my observations:
Scenatio 1.
33 (fixed) modules were logged - call them BASE MODULES.

Scenatio 2.
Beside BASE MODULES + the following modules were loaded:

&gt; iptable_filter 1841 0 - Live 0xffffffffa007c000
&gt; ip_tables 18201 1 iptable_filter, Live 0xffffffffa0172000
&gt; x_tables 22361 1 ip_tables, Live 0xffffffffa0164000

Scenatio 3.
Beside BASE MODULES + the following modules were loaded:

$ diff modules1 modules2
1c1,6
&lt; iptable_filter 1841 0 - Live 0xffffffffa008b000
---
&gt; xt_state 1490 14 - Live 0xffffffffa01ab000
&gt; xt_tcpudp 2667 12 - Live 0xffffffffa01a5000
&gt; nf_conntrack_ipv4 12742 14 - Live 0xffffffffa019b000
&gt; nf_conntrack 73326 2 xt_state,nf_conntrack_ipv4, Live 0xffffffffa017d000
&gt; nf_defrag_ipv4 1481 1 nf_conntrack_ipv4, Live 0xffffffffa0177000
&gt; iptable_filter 1841 1 - Live 0xffffffffa008b000
3c8
&lt; x_tables 22361 1 ip_tables, Live 0xffffffffa0162000
---
&gt; x_tables 22361 3 xt_state,xt_tcpudp,ip_tables, Live 0xffffffffa0162000

Other observations:
Scenatio 1.
No errors in libvirtd.log
Scenario 2.

10:06:06.980: error : networkAddIptablesRules:750 : failed to add iptables
rule to allow DHCP requests from 'virbr0': Invalid argument
(...)
10:06:08.630: error : qemudNetworkIfaceConnect:1445 : Failed to add tap
interface to bridge 'virbr0': No such device
10:06:08.630: error : qemuAutostartDomain:584 : Failed to autostart VM
'cluster_server1': Failed to add tap interface to bridge 'virbr0': No such
device

10:06:08.921: info : qemudDispatchSignalEvent:390 : Received unexpected
signal 17
10:06:08.927: debug : virExecWithHook:617 : LC_ALL=C /usr/bin/kvm -help
10:06:08.938: info : qemudDispatchSignalEvent:390 : Received unexpected
signal 17
10:06:09.000: error : qemudNetworkIfaceConnect:1445 : Failed to add tap
interface to bridge 'virbr0': No such device
10:06:09.000: error : qemuAutostartDomain:584 : Failed to autostart VM
'cluster_server2': Failed to add tap interface to bridge 'virbr0': No such
device
(...)
Scenatio 3.
No errors in libvirtd.log


I didn't see any valuable logs in /var/log/boot.log, /var/log/messages,
/var/log/syslog. Please let me know if you want to see them anyway or have
any suggestions right away.

[Attachment #5 (text/html)]

I have observed 3 scenarios after I reboot the host with 2 guests (which are supposed \
to autostart after boot/reboot of the host):&lt;br&gt;1. Default network is created but I \
can not ping guests. Gests don't have assigned IP address or they both have IP \
address 192.168.122.100.&lt;br&gt; 2. Default network is not created.&lt;br&gt;3. Default netork \
is properly created and everything works fine.&lt;br&gt;In each case guests are started and \
they work properly. Cases 1. and 2. happen a lot more often then case 3.&lt;br&gt;&lt;br&gt; My \
solutions:&lt;br&gt;- When I restart libvirt-bin then everything is fine.&lt;br&gt;- When I set \
'sleep 40' in 'pre-start' section of /etc/init/libvirt-bin.conf and \
modify 'start on' section in the following way:&lt;br&gt; &lt;br&gt;start on (runlevel \
[2345] and net-device-up IFACE=br0)&lt;br&gt;&lt;br&gt;then everything works \
fine.&lt;br&gt;&lt;br&gt;&lt;br&gt;However, none of the above solutions indeed solves the problem. \
Please, let me know if there is solution to this problem or what are your suggestions \
regarding this issue.&lt;br&gt; &lt;br&gt;****&lt;br&gt;HOST$ uname -a&lt;br&gt;Linux ras 2.6.32-32-server \
#62-Ubuntu SMP Wed Apr 20 22:07:43 UTC 2011 x86_64 GNU/Linux&lt;br&gt;&lt;br&gt;GUEST1 and \
GUEST2&lt;br&gt;$ uname -a&lt;br&gt;Linux server1-desktop 2.6.32-32-generic #62-Ubuntu SMP Wed \
Apr 20 21:54:21 UTC 2011 i686 GNU/Linux&lt;br&gt; &lt;br&gt;HOST$ libvirtd --version&lt;br&gt;libvirtd \
(libvirt) 0.7.5&lt;br&gt;&lt;br&gt;My idea was that some kernel modules sometimes are loaded \
before libvirt-bin starts, and sometimes libvirt-bin starts earlier, or in the middle \
of loading of these modules, that is why 3 scenarios can be observed. &lt;br&gt; That is \
why I have added:&lt;br&gt; cp /proc/modules /home/wsadmin2/modules1&lt;br&gt; cp /proc/modules \
/home/wsadmin2/modules2&lt;br&gt;to 'pre-start' and 'post-start' parts \
respectively of /etc/init/libvirt-bin.conf.&lt;br&gt;&lt;br&gt; Of course, beween execution of \
&lt;br&gt;- pre-start part &lt;br&gt;- exec /usr/sbin/libvirtd -d&lt;br&gt;- post-start part&lt;br&gt;other \
kernel modules can be loaded, so we can not be sure which additional modules in file \
'modules2' were indeed loaded before libvirtd was actually started.&lt;br&gt; \
&lt;br&gt;Here are my observations:&lt;br&gt;Scenatio 1.&lt;br&gt;33 (fixed) modules were logged - call \
them BASE MODULES.&lt;br&gt;&lt;br&gt;Scenatio 2.&lt;br&gt;Beside BASE MODULES + the following modules \
were loaded:&lt;br&gt;&lt;br&gt;&gt; iptable_filter 1841 0 - Live 0xffffffffa007c000&lt;br&gt; &gt; \
ip_tables 18201 1 iptable_filter, Live 0xffffffffa0172000&lt;br&gt;&gt; x_tables 22361 1 \
ip_tables, Live 0xffffffffa0164000&lt;br&gt;&lt;br&gt;Scenatio 3.&lt;br&gt;Beside BASE MODULES + the \
following modules were loaded:&lt;br&gt;&lt;br&gt;$ diff modules1 modules2&lt;br&gt; 1c1,6&lt;br&gt;&lt; \
iptable_filter 1841 0 - Live 0xffffffffa008b000&lt;br&gt;---&lt;br&gt;&gt; xt_state 1490 14 - \
Live 0xffffffffa01ab000&lt;br&gt;&gt; xt_tcpudp 2667 12 - Live 0xffffffffa01a5000&lt;br&gt;&gt; \
nf_conntrack_ipv4 12742 14 - Live 0xffffffffa019b000&lt;br&gt; &gt; nf_conntrack 73326 2 \
xt_state,nf_conntrack_ipv4, Live 0xffffffffa017d000&lt;br&gt;&gt; nf_defrag_ipv4 1481 1 \
nf_conntrack_ipv4, Live 0xffffffffa0177000&lt;br&gt;&gt; iptable_filter 1841 1 - Live \
0xffffffffa008b000&lt;br&gt;3c8&lt;br&gt;&lt; x_tables 22361 1 ip_tables, Live \
                0xffffffffa0162000&lt;br&gt;
---&lt;br&gt;&gt; x_tables 22361 3 xt_state,xt_tcpudp,ip_tables, Live \
0xffffffffa0162000&lt;br&gt;&lt;br&gt;Other observations:&lt;br&gt;Scenatio 1.&lt;br&gt;No errors in \
libvirtd.log&lt;br&gt;Scenario 2.&lt;br&gt;&lt;br&gt;10:06:06.980: error : networkAddIptablesRules:750 \
: failed to add iptables rule to allow DHCP requests from 'virbr0': Invalid \
argument&lt;br&gt; (...)&lt;br&gt;10:06:08.630: error : qemudNetworkIfaceConnect:1445 : Failed to \
add tap interface to bridge 'virbr0': No such device&lt;br&gt;10:06:08.630: error : \
qemuAutostartDomain:584 : Failed to autostart VM 'cluster_server1': Failed to \
add tap interface to bridge 'virbr0': No such device&lt;br&gt; &lt;br&gt;10:06:08.921: \
info : qemudDispatchSignalEvent:390 : Received unexpected signal 17&lt;br&gt;10:06:08.927: \
debug : virExecWithHook:617 : LC_ALL=C /usr/bin/kvm -help&lt;br&gt;10:06:08.938: info : \
qemudDispatchSignalEvent:390 : Received unexpected signal 17&lt;br&gt; 10:06:09.000: error \
: qemudNetworkIfaceConnect:1445 : Failed to add tap interface to bridge \
'virbr0': No such device&lt;br&gt;10:06:09.000: error : qemuAutostartDomain:584 : \
Failed to autostart VM 'cluster_server2': Failed to add tap interface to \
bridge 'virbr0': No such device&lt;br&gt; (...)&lt;br&gt;Scenatio 3.&lt;br&gt;No errors in \
libvirtd.log&lt;br&gt;&lt;br&gt;&lt;br&gt;I didn't see any valuable logs in /var/log/boot.log, \
/var/log/messages, /var/log/syslog. Please let me know if you want to see them anyway \
or have any suggestions right away.&lt;br&gt;

--90e6ba6e8bd6dfc65504a5100be3--


["scenario1" (application/octet-stream)]
["scenario2" (application/octet-stream)]
["scenario3" (application/octet-stream)]
["libvirt-bin.conf" (application/octet-stream)]

</body></email><email><emailId>20110613154244</emailId><senderName>Whit Blauvelt</senderName><senderEmail>whit.virt@transpect.com</senderEmail><timestampReceived>2011-06-13 15:42:44-0400</timestampReceived><subject>[libvirt-users] hook scripts - not in Ubuntu packages?</subject><body>

On Mon, Jun 13, 2011 at 05:21:02PM +0200, Michal Privoznik wrote:

&gt; Your other option is to create hook script:
&gt; http://libvirt.org/hooks.html

That looks useful.

On several Ubuntu systems, with Ubuntu libvirt 0.8.8 and 0.8.3 packages
installed, there's no libvirt/hooks/ directory at all. Is this a directory
that can simply be created and used under libvirt, or does using this
feature on Ubuntu require custom installation?

Thanks,
Whit

</body></email><email><emailId>20110613132500</emailId><senderName>Jeff</senderName><senderEmail>jwk1230@gmail.com</senderEmail><timestampReceived>2011-06-13 13:25:00-0400</timestampReceived><subject>[libvirt-users] Boot delay</subject><body>

Is there a method of tweaking the boot sequence of a KVM instance so that you can delay the process for X number of seconds? I don't have enough time between starting the KVM and connecting via VNC.

Thanks

Jeff

</body></email><email><emailId>20110611012146</emailId><senderName>Abhishek Gupta</senderName><senderEmail>cs1090174@cse.iitd.ernet.in</senderEmail><timestampReceived>2011-06-11 01:21:46-0400</timestampReceived><subject>[libvirt-users] Difference between function Migrate and Migrate2</subject><body>

I was reading the API reference for the libvirt, when I came across
the function  virDomainMigrate and virDomainMigrate2. I am unable to
find the difference between the two. Can someone please tell the
difference in the application of the two?

--
Abhishek

</body></email><email><emailId>20110605083248</emailId><senderName>Ohad Levy</senderName><senderEmail>ohadlevy@gmail.com</senderEmail><timestampReceived>2011-06-05 08:32:48-0400</timestampReceived><subject>[libvirt-users] request to add an application the app listing on libvirt site</subject><body>

Hi,

I would like to add two apps which uses libvirt the site.

Ruby Objects for libvirt
based on top of the native ruby binding, Virt ruby gem exposes real objects
such as Host, Guest, StoragePool, Interface etc.

more info at https://github.com/ohadlevy/virt

Foreman - Web UI for provisioning and managing servers

Among the many things foreman can do, It provides to relevant parts to
libvirt:

UI to list / start / stop / destroy vms
UI to create a new vm as part of the provisioning process (e.g. dhcp, dns,
tftp, pxe, vm, ks/preseed, puppet etc)

more info at http://theforeman.org


Thanks!
Ohad

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I would like to add two apps which uses libvirt \
the site.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Ruby Objects for libvirt&lt;/div&gt;&lt;div&gt;based on top of \
the native ruby binding, Virt ruby gem exposes real objects such as Host, Guest, \
StoragePool, Interface etc.&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;more info at  &lt;a \
href="https://github.com/ohadlevy/virt"&gt;https://github.com/ohadlevy/virt&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Foreman \
- Web UI for provisioning and managing servers&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Among the \
many things foreman can do, It provides to relevant parts to libvirt:&lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;UI to list / start / stop / destroy vms&lt;/div&gt;&lt;div&gt;UI to create a \
new vm as part of the provisioning process (e.g. dhcp, dns, tftp, pxe, vm, \
ks/preseed, puppet etc)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;more info at &lt;a \
href="http://theforeman.org"&gt;http://theforeman.org&lt;/a&gt;&lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks!&lt;/div&gt;&lt;div&gt;Ohad&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;




</body></email><email><emailId>20110616100825</emailId><senderName></senderName><senderEmail>arun.sasi1@wipro.com</senderEmail><timestampReceived>2011-06-16 10:08:25-0400</timestampReceived><subject>[libvirt-users] Base server as file server.</subject><body>

Hello Stefan,

 

I have a small query about virtualization.

 

Need to install file server on Base server and include some virtual
machines on that i.e. DNS/DHCP/LDAP etc.

 

Will I get complete performance on file server since it is in Base
server where KVM kernel installed...

 

Thanks,

-Arun


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:x="urn:schemas-microsoft-com:office:excel" \
xmlns:p="urn:schemas-microsoft-com:office:powerpoint" \
xmlns:a="urn:schemas-microsoft-com:office:access" \
xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882" \
xmlns:s="uuid:BDC6E3F0-6DA3-11d1-A2A3-00AA00C14882" \
xmlns:rs="urn:schemas-microsoft-com:rowset" xmlns:z="#RowsetSchema" \
xmlns:b="urn:schemas-microsoft-com:office:publisher" \
xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" \
xmlns:c="urn:schemas-microsoft-com:office:component:spreadsheet" \
xmlns:odc="urn:schemas-microsoft-com:office:odc" \
xmlns:oa="urn:schemas-microsoft-com:office:activation" \
xmlns:html="http://www.w3.org/TR/REC-html40" \
xmlns:q="http://schemas.xmlsoap.org/soap/envelope/" \
xmlns:rtc="http://microsoft.com/officenet/conferencing" xmlns:D="DAV:" \
xmlns:Repl="http://schemas.microsoft.com/repl/" \
xmlns:mt="http://schemas.microsoft.com/sharepoint/soap/meetings/" \
xmlns:x2="http://schemas.microsoft.com/office/excel/2003/xml" \
xmlns:ppda="http://www.passport.com/NameSpace.xsd" \
xmlns:ois="http://schemas.microsoft.com/sharepoint/soap/ois/" \
xmlns:dir="http://schemas.microsoft.com/sharepoint/soap/directory/" \
xmlns:ds="http://www.w3.org/2000/09/xmldsig#" \
xmlns:dsp="http://schemas.microsoft.com/sharepoint/dsp" \
xmlns:udc="http://schemas.microsoft.com/data/udc" \
xmlns:xsd="http://www.w3.org/2001/XMLSchema" \
xmlns:sub="http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/" \
xmlns:ec="http://www.w3.org/2001/04/xmlenc#" \
xmlns:sp="http://schemas.microsoft.com/sharepoint/" \
xmlns:sps="http://schemas.microsoft.com/sharepoint/soap/" \
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" \
xmlns:udcs="http://schemas.microsoft.com/data/udc/soap" \
xmlns:udcxf="http://schemas.microsoft.com/data/udc/xmlfile" \
xmlns:udcp2p="http://schemas.microsoft.com/data/udc/parttopart" \
xmlns:wf="http://schemas.microsoft.com/sharepoint/soap/workflow/" \
xmlns:dsss="http://schemas.microsoft.com/office/2006/digsig-setup" \
xmlns:dssi="http://schemas.microsoft.com/office/2006/digsig" \
xmlns:mdssi="http://schemas.openxmlformats.org/package/2006/digital-signature" \
xmlns:mver="http://schemas.openxmlformats.org/markup-compatibility/2006" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns:mrels="http://schemas.openxmlformats.org/package/2006/relationships" \
xmlns:spwp="http://microsoft.com/sharepoint/webpartpages" \
xmlns:ex12t="http://schemas.microsoft.com/exchange/services/2006/types" \
xmlns:ex12m="http://schemas.microsoft.com/exchange/services/2006/messages" \
xmlns:pptsl="http://schemas.microsoft.com/sharepoint/soap/SlideLibrary/" \
xmlns:spsl="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService" \
xmlns:Z="urn:schemas-microsoft-com:" xmlns:st="" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 12 (filtered medium)"&gt;
&lt;style&gt;
&lt;!--
 /* Font Definitions */
 @font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{mso-style-priority:99;
	mso-style-link:"Plain Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:10.5pt;
	font-family:Consolas;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{mso-style-priority:34;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
span.PlainTextChar
	{mso-style-name:"Plain Text Char";
	mso-style-priority:99;
	mso-style-link:"Plain Text";
	font-family:Consolas;}
span.EmailStyle19
	{mso-style-type:personal-reply;
	font-family:"Calibri","sans-serif";
	color:#006666;}
.MsoChpDefault
	{mso-style-type:export-only;
	font-size:10.0pt;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:1324317065;
	mso-list-type:hybrid;
	mso-list-template-ids:-1003717170 67698705 67698713 67698715 67698703 67698713 \
67698715 67698703 67698713 67698715;} @list l0:level1
	{mso-level-text:"%1\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
--&gt;
&lt;/style&gt;
&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapelayout v:ext="edit"&gt;
  &lt;o:idmap v:ext="edit" data="1" /&gt;
 &lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
&lt;/head&gt;

&lt;body lang=EN-US link=blue vlink=purple&gt;

&lt;div class=Section1&gt;

&lt;p class=MsoNormal&gt;&lt;span style='color:#006666'&gt;Hello Stefan,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='color:#006666'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='color:#006666'&gt;I have a small query about
virtualization.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='color:#006666'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='color:#006666'&gt;Need to install file server on
Base server and include some virtual machines on that i.e. DNS/DHCP/LDAP \
etc.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='color:#006666'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='color:#006666'&gt;Will I get complete performance
on file server since it is in Base server where KVM kernel \
installed…&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='color:#006666'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;div&gt;

&lt;p class=MsoNormal&gt;&lt;span style='color:#006666'&gt;Thanks,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='color:#006666'&gt;-Arun&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;



</body></email><email><emailId>20110601075045</emailId><senderName>Jérémie_Tarot</senderName><senderEmail>silopolis@gmail.com</senderEmail><timestampReceived>2011-06-01 07:50:45-0400</timestampReceived><subject>[libvirt-users] Virtual switches support (Openvswitch, VDE,...)</subject><body>

Hi,

IIR/UC there have been a couple of discussions lately about possible
evolution of libvirt's network management features to eventually support
more kinds of virtual networking technologies like Openvswitch, VDE,...

Could a kind and informed soul keep us on touch with progress in the field ?

Thank you very much in advance

PS: I wish this will be available before/for 1.0 release...

[Attachment #3 (text/html)]

Hi,&lt;br&gt;&lt;br&gt;IIR/UC there have been a couple of discussions lately about possible \
evolution of libvirt's network management features to eventually support more \
kinds of virtual networking technologies like Openvswitch, VDE,...&lt;br&gt; &lt;br&gt;Could a \
kind and informed soul keep us on touch with progress in the field ?&lt;br&gt;&lt;br&gt;Thank you \
very much in advance&lt;br&gt;&lt;br&gt;PS: I wish this will be available before/for 1.0 \
release...&lt;br&gt;&lt;br&gt;



</body></email><email><emailId>20110615174314</emailId><senderName>David Lane</senderName><senderEmail>kg4giy@gmail.com</senderEmail><timestampReceived>2011-06-15 17:43:14-0400</timestampReceived><subject>[libvirt-users] 2 virsh consoles on the same hypervisor causes conflicts</subject><body>

Anyone encountered this?  Anyone have a solution?  Seeing it in Fedora15
with KVM

If 2 consoles are opened to the same guest from the hypervisor they will
interfere with each other.  keystrokes are lost and returned information is
displayed on either virsh console instances randomly.  Both consoles are
rendered unusable.

Thanks,

DAVID

[Attachment #3 (text/html)]

Anyone encountered this?=A0 Anyone have a solution?=A0 Seeing it in Fedora1=
5 with KVM&lt;br&gt;&lt;br&gt;If 2 consoles are opened to the same guest from the hyper=
visor they will interfere with each other. =A0keystrokes are lost and retur=
ned information is displayed on either virsh console instances randomly. =
=A0Both consoles are rendered unusable.&lt;br&gt;
&lt;br&gt;Thanks,&lt;br&gt;&lt;br&gt;DAVID&lt;br&gt;


</body></email><email><emailId>20110618102344</emailId><senderName>Lorenzo Milesi</senderName><senderEmail>maxxer@ufficyo.com</senderEmail><timestampReceived>2011-06-18 10:23:44-0400</timestampReceived><subject>[libvirt-users] virsh slow on execution</subject><body>

Hi.

I've set up a Debian6+Xen4+libvirt0.9 server. VMs are going to be managed by \
PaceMaker with VirtualDomain primitive.

As found on some mailing list I've set 
export VIRSH_DEFAULT_CONNECT_URI="xen:///"
in root's .bashrc, but when I run virsh commands, it takes up to 10s to get the \
result! Is this normal?
At some point today I had issues connecting to libvirt, and in this case it was \
responding fast, less than couple of seconds.


Also, when I start a VM via OCF, while guest is booting the command 
virsh domstate mydom 
returns "no state". This makes PaceMaker believe the resource is not running and \
continuously stops and restart the machine.

How can I speed up virsh output?
Thanks


</body></email><email><emailId>20110620164850</emailId><senderName>m m</senderName><senderEmail>bk.praca@gmail.com</senderEmail><timestampReceived>2011-06-20 16:48:50-0400</timestampReceived><subject>Re: [libvirt-users] libvirt-users Digest, Vol 18, Issue 17</subject><body>

Yes, I also think that iptables module should be loaded before libvirt-bin
and I have seen a post which regarded loading conntrack modules and these
modules also seem to be necessary...
I know a little about Upstart in Ubuntu. However, I still don't know how to
properly solve this problem.
ip_tables module depend on other modules being loaded and since I don't know
the full list of modules which should be loaded (for IP tables to work) I
don't know how to handle that. Besides, even if I had this list, it could
change for some time, so it is not a good idea to rely on that.

Version which I have installed is the newest release from Ubuntu
repositories.

Thank you for help.
I will be grateful for any further suggestions.


2011/6/13 &lt;libvirt-users-request@redhat.com&gt;

&gt; Send libvirt-users mailing list submissions to
&gt;        libvirt-users@redhat.com
&gt;
&gt; To subscribe or unsubscribe via the World Wide Web, visit
&gt;        https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; or, via email, send a message with subject or body 'help' to
&gt;        libvirt-users-request@redhat.com
&gt;
&gt; You can reach the person managing the list at
&gt;        libvirt-users-owner@redhat.com
&gt;
&gt; When replying, please edit your Subject line so it is more specific
&gt; than "Re: Contents of libvirt-users digest..."
&gt;
&gt;
&gt; Today's Topics:
&gt;
&gt;   1. Re: libvirt-bin MOSTLY fails to create default virtual
&gt;      network (Laine Stump)
&gt;   2. Boot delay (Jeff)
&gt;   3. e:  How to disconnect the ISO image using virsh (Jeff)
&gt;   4. Difference between function Migrate and Migrate2 (Abhishek Gupta)
&gt;   5. Re: Boot delay (Michal Privoznik)
&gt;   6. hook scripts - not in Ubuntu packages? (Whit Blauvelt)
&gt;
&gt;
&gt; ----------------------------------------------------------------------
&gt;
&gt; Message: 1
&gt; Date: Sun, 12 Jun 2011 12:03:17 -0400
&gt; From: Laine Stump &lt;laine@laine.org&gt;
&gt; To: libvirt-users@redhat.com
&gt; Subject: Re: [libvirt-users] libvirt-bin MOSTLY fails to create
&gt;        default virtual network
&gt; Message-ID: &lt;4DF4E345.7060104@laine.org&gt;
&gt; Content-Type: text/plain; charset=ISO-8859-1; format=flowed
&gt;
&gt; On 06/06/2011 03:24 PM, m m wrote:
&gt; &gt; I have observed 3 scenarios after I reboot the host with 2 guests
&gt; &gt; (which are supposed to autostart after boot/reboot of the host):
&gt; &gt; 1. Default network is created but I can not ping guests. Gests don't
&gt; &gt; have assigned IP address or they both have IP address 192.168.122.100.
&gt; &gt; 2. Default network is not created.
&gt; &gt; 3. Default netork is properly created and everything works fine.
&gt; &gt; In each case guests are started and they work properly. Cases 1. and
&gt; &gt; 2. happen a lot more often then case 3.
&gt; &gt;
&gt; &gt; My solutions:
&gt; &gt; - When I restart libvirt-bin then everything is fine.
&gt; &gt; - When I set 'sleep 40' in 'pre-start' section of
&gt; &gt; /etc/init/libvirt-bin.conf and modify 'start on' section in the
&gt; &gt; following way:
&gt; &gt;
&gt; &gt; start on (runlevel [2345] and net-device-up IFACE=br0)
&gt; &gt;
&gt; &gt; then everything works fine.
&gt; &gt;
&gt; &gt;
&gt; &gt; However, none of the above solutions indeed solves the problem.
&gt; &gt; Please, let me know if there is solution to this problem or what are
&gt; &gt; your suggestions regarding this issue.
&gt; &gt;
&gt; &gt; ****
&gt; &gt; HOST$ uname -a
&gt; &gt; Linux ras 2.6.32-32-server #62-Ubuntu SMP Wed Apr 20 22:07:43 UTC 2011
&gt; &gt; x86_64 GNU/Linux
&gt; &gt;
&gt; &gt; GUEST1 and GUEST2
&gt; &gt; $ uname -a
&gt; &gt; Linux server1-desktop 2.6.32-32-generic #62-Ubuntu SMP Wed Apr 20
&gt; &gt; 21:54:21 UTC 2011 i686 GNU/Linux
&gt; &gt;
&gt; &gt; HOST$ libvirtd --version
&gt; &gt; libvirtd (libvirt) 0.7.5
&gt; &gt;
&gt; &gt; My idea was that some kernel modules sometimes are loaded before
&gt; &gt; libvirt-bin starts, and sometimes libvirt-bin starts earlier, or in
&gt; &gt; the middle of loading of these modules, that is why 3 scenarios can be
&gt; &gt; observed.
&gt; &gt; That is why I have added:
&gt; &gt;  cp /proc/modules /home/wsadmin2/modules1
&gt; &gt;  cp /proc/modules /home/wsadmin2/modules2
&gt; &gt; to 'pre-start' and 'post-start' parts respectively of
&gt; &gt; /etc/init/libvirt-bin.conf.
&gt; &gt;
&gt; &gt; Of course, beween execution of
&gt; &gt; - pre-start part
&gt; &gt; - exec /usr/sbin/libvirtd -d
&gt; &gt; - post-start part
&gt; &gt; other kernel modules can be loaded, so we can not be sure which
&gt; &gt; additional modules in file 'modules2' were indeed loaded before
&gt; &gt; libvirtd was actually started.
&gt; &gt;
&gt; &gt; Here are my observations:
&gt; &gt; Scenatio 1.
&gt; &gt; 33 (fixed) modules were logged - call them BASE MODULES.
&gt; &gt;
&gt; &gt; Scenatio 2.
&gt; &gt; Beside BASE MODULES + the following modules were loaded:
&gt; &gt;
&gt; &gt; &gt; iptable_filter 1841 0 - Live 0xffffffffa007c000
&gt; &gt; &gt; ip_tables 18201 1 iptable_filter, Live 0xffffffffa0172000
&gt; &gt; &gt; x_tables 22361 1 ip_tables, Live 0xffffffffa0164000
&gt;
&gt; In your "scenario 1" the modules necessary for iptables to function
&gt; haven't been loaded. Each virtual network requires a set of iptables
&gt; rules to function properly, and if there is no iptables, the rules can't
&gt; be added and network creation fails. Your libvirtd.log confirms that
&gt; problem:
&gt;
&gt;   10:06:06.980: error : networkAddIptablesRules:750 : failed to add
&gt; iptables rule to allow DHCP requests from 'virbr0': Invalid argument
&gt;
&gt;
&gt; 0.7.5 is quite old (&gt; 1 year), is there perhaps a newer pre-built
&gt; version of libvirt available for your release of Ubuntu?
&gt;
&gt; It seems that Ubuntu's method of starting up libvirtd (at least on your
&gt; machine) is missing a dependency to force iptables to be loaded before
&gt; libvirtd starts. I'm unfamiliar with Ubuntu/debian startup stuff
&gt; (upstart, I guess), but that's where you need to look for the solution.
&gt;
&gt; I found the following in the ubuntu bug database, which seems similar,
&gt; but not identical (basically the system networking isn't completely
&gt; ready by the time the autostart domains are brought up):
&gt;
&gt; https://bugs.launchpad.net/ubuntu/+source/libvirt/+bug/495394
&gt;
&gt; &gt;
&gt; &gt; Scenatio 3.
&gt; &gt; Beside BASE MODULES + the following modules were loaded:
&gt; &gt;
&gt; &gt; $ diff modules1 modules2
&gt; &gt; 1c1,6
&gt; &gt; &lt; iptable_filter 1841 0 - Live 0xffffffffa008b000
&gt; &gt; ---
&gt; &gt; &gt; xt_state 1490 14 - Live 0xffffffffa01ab000
&gt; &gt; &gt; xt_tcpudp 2667 12 - Live 0xffffffffa01a5000
&gt; &gt; &gt; nf_conntrack_ipv4 12742 14 - Live 0xffffffffa019b000
&gt; &gt; &gt; nf_conntrack 73326 2 xt_state,nf_conntrack_ipv4, Live
&gt; 0xffffffffa017d000
&gt;
&gt; conntrack is used by iptables. I haven't tried it, but wouldn't be
&gt; surprised if adding rules that required conntrack failed if it hadn't
&gt; been loaded, or something like that.
&gt;
&gt; &gt; &gt; nf_defrag_ipv4 1481 1 nf_conntrack_ipv4, Live 0xffffffffa0177000
&gt; &gt; &gt; iptable_filter 1841 1 - Live 0xffffffffa008b000
&gt; &gt; 3c8
&gt; &gt; &lt; x_tables 22361 1 ip_tables, Live 0xffffffffa0162000
&gt; &gt; ---
&gt; &gt; &gt; x_tables 22361 3 xt_state,xt_tcpudp,ip_tables, Live 0xffffffffa0162000
&gt; &gt;
&gt; &gt; Other observations:
&gt; &gt; Scenatio 1.
&gt; &gt; No errors in libvirtd.log
&gt; &gt; Scenario 2.
&gt; &gt;
&gt; &gt; 10:06:06.980: error : networkAddIptablesRules:750 : failed to add
&gt; &gt; iptables rule to allow DHCP requests from 'virbr0': Invalid argument
&gt; &gt; (...)
&gt; &gt; 10:06:08.630: error : qemudNetworkIfaceConnect:1445 : Failed to add
&gt; &gt; tap interface to bridge 'virbr0': No such device
&gt; &gt; 10:06:08.630: error : qemuAutostartDomain:584 : Failed to autostart VM
&gt; &gt; 'cluster_server1': Failed to add tap interface to bridge 'virbr0': No
&gt; &gt; such device
&gt; &gt;
&gt; &gt; 10:06:08.921: info : qemudDispatchSignalEvent:390 : Received
&gt; &gt; unexpected signal 17
&gt; &gt; 10:06:08.927: debug : virExecWithHook:617 : LC_ALL=C /usr/bin/kvm -help
&gt; &gt; 10:06:08.938: info : qemudDispatchSignalEvent:390 : Received
&gt; &gt; unexpected signal 17
&gt; &gt; 10:06:09.000: error : qemudNetworkIfaceConnect:1445 : Failed to add
&gt; &gt; tap interface to bridge 'virbr0': No such device
&gt; &gt; 10:06:09.000: error : qemuAutostartDomain:584 : Failed to autostart VM
&gt; &gt; 'cluster_server2': Failed to add tap interface to bridge 'virbr0': No
&gt; &gt; such device
&gt; &gt; (...)
&gt; &gt; Scenatio 3.
&gt; &gt; No errors in libvirtd.log
&gt; &gt;
&gt; &gt;
&gt; &gt; I didn't see any valuable logs in /var/log/boot.log,
&gt; &gt; /var/log/messages, /var/log/syslog. Please let me know if you want to
&gt; &gt; see them anyway or have any suggestions right away.
&gt; &gt;
&gt; &gt;
&gt; &gt; _______________________________________________
&gt; &gt; libvirt-users mailing list
&gt; &gt; libvirt-users@redhat.com
&gt; &gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;
&gt;
&gt;
&gt; ------------------------------
&gt;
&gt; Message: 2
&gt; Date: Mon, 13 Jun 2011 08:25:00 -0500
&gt; From: Jeff &lt;jwk1230@gmail.com&gt;
&gt; To: libvirt-users@redhat.com
&gt; Subject: [libvirt-users] Boot delay
&gt; Message-ID: &lt;4609858C-FB73-4E8A-B81B-3EDCBB83B755@gmail.com&gt;
&gt; Content-Type: text/plain; charset=us-ascii
&gt;
&gt; Is there a method of tweaking the boot sequence of a KVM instance so that
&gt; you can delay the process for X number of seconds? I don't have enough time
&gt; between starting the KVM and connecting via VNC.
&gt;
&gt; Thanks
&gt;
&gt; Jeff
&gt;
&gt;
&gt;
&gt; ------------------------------
&gt;
&gt; Message: 3
&gt; Date: Fri, 10 Jun 2011 15:12:36 -0500
&gt; From: Jeff &lt;jwk1230@gmail.com&gt;
&gt; To: Osier Yang &lt;jyang@redhat.com&gt;, libvirt-users@redhat.com
&gt; Subject: [libvirt-users] e:  How to disconnect the ISO image using
&gt;        virsh
&gt; Message-ID: &lt;F301FBCE-65F1-411A-980E-EF8B6A46241B@gmail.com&gt;
&gt; Content-Type: text/plain; charset="utf-8"
&gt;
&gt; I am trying to detach an ISO from a KVM machine and I've tried both
&gt; attach-disk using " " in the file path as well as the update-device option
&gt; but am getting this error
&gt;
&gt; error: Failed to update device from /var/run/libvirt/qemu/kvmtest1.xml
&gt; error: XML description for unknown device type is not well formed or
&gt; invalid.
&gt;
&gt; I tried doing a virsh edit on the xml file to remove the source file path
&gt; to the ISO, as I assume is the correct method, and then running the virsh
&gt; update-device but it's not working.
&gt;
&gt; Can anyone advise the correct steps to detach a device from a running
&gt; and/or offline domain?
&gt;
&gt; Additionally - anyone have any guidance on how to attach a CD device to a
&gt; domain that is currently shutdown, for example, if I wanted to boot the
&gt; domain to a rescue CD image?
&gt;
&gt; Thanks
&gt;
&gt; Jeff
&gt;
&gt;
&gt; ? 2011?03?31? 15:17, Masanari Iida ??:
&gt; Somebody sent me a tips.
&gt; Following command do what I wanted to do.
&gt; Thanks.
&gt;
&gt; attach-disk guest01 " " hdc --driver file --type cdrom
&gt; --mode readonly
&gt; Also using "update-device" with an xml which doesn't specify
&gt; the source file path will work.
&gt;
&gt; On Thu, Mar 31, 2011 at 3:29 PM, Masanari Iida&lt;standby24x7 gmail com&gt;
&gt;  wrote:
&gt; Hello,
&gt;
&gt; I can attach disc ISO image to cd-rom from virsh.
&gt; And I can replace the ISO image from disc1 to disc2 using the 2nd example.
&gt;
&gt; (example)
&gt; attach-disk guest01 /root/disc1.iso hdc --driver file --type cdrom
&gt; --mode readonly
&gt; attach-disk guest01 /root/disc2.iso hdc --driver file --type cdrom
&gt; --mode readonly
&gt;
&gt; My question is, how can I disconnect the image from the cdrom drive using
&gt; virsh.
&gt; Because, if I try to detach-disk hdc, I got following errors.
&gt;
&gt; virsh # detach-disk guest01 hdc
&gt; error: Failed to detach disk
&gt; error: this function is not supported by the connection driver:
&gt; This type of device cannot be hot unplugged
&gt;
&gt; What I can do is possible from virt-manager's "Disconnect" button,
&gt; (next to source path: line)  from Hardware's TAB, Disk hdc screen.
&gt; I want to do this from virsh.
&gt;
&gt; OS: RHEL5.6
&gt; libvirt-0.8.2-15.el5_6.1 is used.
&gt;
&gt; Regards,
&gt; Masanari Iida
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users redhat com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;
&gt; -------------- next part --------------
&gt; An HTML attachment was scrubbed...
&gt; URL: &lt;
&gt; https://www.redhat.com/archives/libvirt-users/attachments/20110610/f4acfe4c/attachment.html
&gt; &gt;
&gt;
&gt; ------------------------------
&gt;
&gt; Message: 4
&gt; Date: Sat, 11 Jun 2011 06:39:46 +0530
&gt; From: Abhishek Gupta &lt;cs1090174@cse.iitd.ernet.in&gt;
&gt; To: libvirt-users@redhat.com
&gt; Subject: [libvirt-users] Difference between function Migrate and
&gt;        Migrate2
&gt; Message-ID: &lt;BANLkTinv6XiRMz=rS88A-U-b2Hz3SVTesg@mail.gmail.com&gt;
&gt; Content-Type: text/plain; charset=ISO-8859-1
&gt;
&gt; I was reading the API reference for the libvirt, when I came across
&gt; the function? virDomainMigrate and virDomainMigrate2. I am unable to
&gt; find the difference between the two. Can someone please tell the
&gt; difference in the application of the two?
&gt;
&gt; --
&gt; Abhishek
&gt;
&gt;
&gt;
&gt; ------------------------------
&gt;
&gt; Message: 5
&gt; Date: Mon, 13 Jun 2011 17:21:02 +0200
&gt; From: Michal Privoznik &lt;mprivozn@redhat.com&gt;
&gt; To: Jeff &lt;jwk1230@gmail.com&gt;
&gt; Cc: libvirt-users@redhat.com
&gt; Subject: Re: [libvirt-users] Boot delay
&gt; Message-ID: &lt;4DF62ADE.60209@redhat.com&gt;
&gt; Content-Type: text/plain; charset=ISO-8859-1
&gt;
&gt; On 13.06.2011 15:25, Jeff wrote:
&gt; &gt; Is there a method of tweaking the boot sequence of a KVM instance so that
&gt; you can delay the process for X number of seconds? I don't have enough time
&gt; between starting the KVM and connecting via VNC.
&gt; &gt;
&gt; You might consider using virt-viewer. It simply waits for domain to
&gt; boot, if it is down.
&gt;
&gt; Your other option is to create hook script:
&gt; http://libvirt.org/hooks.html
&gt; and put conditional sleep there, because libvirt just before running a
&gt; domain tries to execute qemu with some arguments (e.g. -help) to qeury
&gt; its capabilities. And you don't want your hook script to delay that.
&gt;
&gt; So you need something like this:
&gt;
&gt; if [ $2 == "start" ]; then
&gt;        sleep 5
&gt; fi
&gt;
&gt; &gt; Thanks
&gt; &gt;
&gt; &gt; Jeff
&gt; &gt;
&gt; &gt; _______________________________________________
&gt; &gt; libvirt-users mailing list
&gt; &gt; libvirt-users@redhat.com
&gt; &gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;
&gt; Michal
&gt;
&gt;
&gt;
&gt; ------------------------------
&gt;
&gt; Message: 6
&gt; Date: Mon, 13 Jun 2011 11:42:44 -0400
&gt; From: Whit Blauvelt &lt;whit.virt@transpect.com&gt;
&gt; To: libvirt-users@redhat.com
&gt; Subject: [libvirt-users] hook scripts - not in Ubuntu packages?
&gt; Message-ID: &lt;20110613154244.GA28777@black.transpect.com&gt;
&gt; Content-Type: text/plain; charset=us-ascii
&gt;
&gt; On Mon, Jun 13, 2011 at 05:21:02PM +0200, Michal Privoznik wrote:
&gt;
&gt; &gt; Your other option is to create hook script:
&gt; &gt; http://libvirt.org/hooks.html
&gt;
&gt; That looks useful.
&gt;
&gt; On several Ubuntu systems, with Ubuntu libvirt 0.8.8 and 0.8.3 packages
&gt; installed, there's no libvirt/hooks/ directory at all. Is this a directory
&gt; that can simply be created and used under libvirt, or does using this
&gt; feature on Ubuntu require custom installation?
&gt;
&gt; Thanks,
&gt; Whit
&gt;
&gt;
&gt;
&gt; ------------------------------
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;
&gt; End of libvirt-users Digest, Vol 18, Issue 17
&gt; *********************************************
&gt;

[Attachment #3 (text/html)]

Yes, I also think that iptables module should be loaded before libvirt-bin and I have \
seen a post which regarded loading conntrack modules and these modules also seem to \
be necessary...&lt;br&gt;I know a little about Upstart in Ubuntu. However, I still \
don't know how to properly solve this problem. &lt;br&gt; ip_tables module depend on \
other modules being loaded and since I don't know the full list of modules which \
should be loaded (for IP tables to work) I don't know how to handle that. \
Besides, even if I had this list, it could change for some time, so it is not a good \
idea to rely on that. &lt;br&gt; &lt;br&gt;Version which I have installed is the newest release \
from Ubuntu repositories.&lt;br&gt;&lt;br&gt;Thank you for help. &lt;br&gt;I will be grateful for any \
further suggestions.&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;2011/6/13  &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:libvirt-users-request@redhat.com"&gt;libvirt-users-request@redhat.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;
 &lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px \
solid rgb(204, 204, 204); padding-left: 1ex;"&gt;Send libvirt-users mailing list \
                submissions to&lt;br&gt;
        &lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
&lt;br&gt;
To subscribe or unsubscribe via the World Wide Web, visit&lt;br&gt;
        &lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; or, via \
                email, send a message with subject or body 'help' to&lt;br&gt;
        &lt;a href="mailto:libvirt-users-request@redhat.com"&gt;libvirt-users-request@redhat.com&lt;/a&gt;&lt;br&gt;
 &lt;br&gt;
You can reach the person managing the list at&lt;br&gt;
        &lt;a href="mailto:libvirt-users-owner@redhat.com"&gt;libvirt-users-owner@redhat.com&lt;/a&gt;&lt;br&gt;
 &lt;br&gt;
When replying, please edit your Subject line so it is more specific&lt;br&gt;
than "Re: Contents of libvirt-users digest..."&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Today's Topics:&lt;br&gt;
&lt;br&gt;
   1. Re: libvirt-bin MOSTLY fails to create default virtual&lt;br&gt;
      network (Laine Stump)&lt;br&gt;
   2. Boot delay (Jeff)&lt;br&gt;
   3. e:  How to disconnect the ISO image using virsh (Jeff)&lt;br&gt;
   4. Difference between function Migrate and Migrate2 (Abhishek Gupta)&lt;br&gt;
   5. Re: Boot delay (Michal Privoznik)&lt;br&gt;
   6. hook scripts - not in Ubuntu packages? (Whit Blauvelt)&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
----------------------------------------------------------------------&lt;br&gt;
&lt;br&gt;
Message: 1&lt;br&gt;
Date: Sun, 12 Jun 2011 12:03:17 -0400&lt;br&gt;
From: Laine Stump &lt;&lt;a href="mailto:laine@laine.org"&gt;laine@laine.org&lt;/a&gt;&gt;&lt;br&gt;
To: &lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
Subject: Re: [libvirt-users] libvirt-bin MOSTLY fails to create&lt;br&gt;
        default virtual network&lt;br&gt;
Message-ID: &lt;&lt;a href="mailto:4DF4E345.7060104@laine.org"&gt;4DF4E345.7060104@laine.org&lt;/a&gt;&gt;&lt;br&gt;
                
Content-Type: text/plain; charset=ISO-8859-1; format=flowed&lt;br&gt;
&lt;br&gt;
On 06/06/2011 03:24 PM, m m wrote:&lt;br&gt;
&gt; I have observed 3 scenarios after I reboot the host with 2 guests&lt;br&gt;
&gt; (which are supposed to autostart after boot/reboot of the host):&lt;br&gt;
&gt; 1. Default network is created but I can not ping guests. Gests don't&lt;br&gt;
&gt; have assigned IP address or they both have IP address 192.168.122.100.&lt;br&gt;
&gt; 2. Default network is not created.&lt;br&gt;
&gt; 3. Default netork is properly created and everything works fine.&lt;br&gt;
&gt; In each case guests are started and they work properly. Cases 1. and&lt;br&gt;
&gt; 2. happen a lot more often then case 3.&lt;br&gt;
&gt;&lt;br&gt;
&gt; My solutions:&lt;br&gt;
&gt; - When I restart libvirt-bin then everything is fine.&lt;br&gt;
&gt; - When I set 'sleep 40' in 'pre-start' section of&lt;br&gt;
&gt; /etc/init/libvirt-bin.conf and modify 'start on' section in the&lt;br&gt;
&gt; following way:&lt;br&gt;
&gt;&lt;br&gt;
&gt; start on (runlevel [2345] and net-device-up IFACE=br0)&lt;br&gt;
&gt;&lt;br&gt;
&gt; then everything works fine.&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt; However, none of the above solutions indeed solves the problem.&lt;br&gt;
&gt; Please, let me know if there is solution to this problem or what are&lt;br&gt;
&gt; your suggestions regarding this issue.&lt;br&gt;
&gt;&lt;br&gt;
&gt; ****&lt;br&gt;
&gt; HOST$ uname -a&lt;br&gt;
&gt; Linux ras 2.6.32-32-server #62-Ubuntu SMP Wed Apr 20 22:07:43 UTC 2011&lt;br&gt;
&gt; x86_64 GNU/Linux&lt;br&gt;
&gt;&lt;br&gt;
&gt; GUEST1 and GUEST2&lt;br&gt;
&gt; $ uname -a&lt;br&gt;
&gt; Linux server1-desktop 2.6.32-32-generic #62-Ubuntu SMP Wed Apr 20&lt;br&gt;
&gt; 21:54:21 UTC 2011 i686 GNU/Linux&lt;br&gt;
&gt;&lt;br&gt;
&gt; HOST$ libvirtd --version&lt;br&gt;
&gt; libvirtd (libvirt) 0.7.5&lt;br&gt;
&gt;&lt;br&gt;
&gt; My idea was that some kernel modules sometimes are loaded before&lt;br&gt;
&gt; libvirt-bin starts, and sometimes libvirt-bin starts earlier, or in&lt;br&gt;
&gt; the middle of loading of these modules, that is why 3 scenarios can be&lt;br&gt;
&gt; observed.&lt;br&gt;
&gt; That is why I have added:&lt;br&gt;
&gt;  cp /proc/modules /home/wsadmin2/modules1&lt;br&gt;
&gt;  cp /proc/modules /home/wsadmin2/modules2&lt;br&gt;
&gt; to 'pre-start' and 'post-start' parts respectively of&lt;br&gt;
&gt; /etc/init/libvirt-bin.conf.&lt;br&gt;
&gt;&lt;br&gt;
&gt; Of course, beween execution of&lt;br&gt;
&gt; - pre-start part&lt;br&gt;
&gt; - exec /usr/sbin/libvirtd -d&lt;br&gt;
&gt; - post-start part&lt;br&gt;
&gt; other kernel modules can be loaded, so we can not be sure which&lt;br&gt;
&gt; additional modules in file 'modules2' were indeed loaded before&lt;br&gt;
&gt; libvirtd was actually started.&lt;br&gt;
&gt;&lt;br&gt;
&gt; Here are my observations:&lt;br&gt;
&gt; Scenatio 1.&lt;br&gt;
&gt; 33 (fixed) modules were logged - call them BASE MODULES.&lt;br&gt;
&gt;&lt;br&gt;
&gt; Scenatio 2.&lt;br&gt;
&gt; Beside BASE MODULES + the following modules were loaded:&lt;br&gt;
&gt;&lt;br&gt;
&gt; &gt; iptable_filter 1841 0 - Live 0xffffffffa007c000&lt;br&gt;
&gt; &gt; ip_tables 18201 1 iptable_filter, Live 0xffffffffa0172000&lt;br&gt;
&gt; &gt; x_tables 22361 1 ip_tables, Live 0xffffffffa0164000&lt;br&gt;
&lt;br&gt;
In your "scenario 1" the modules necessary for iptables to function&lt;br&gt;
haven't been loaded. Each virtual network requires a set of iptables&lt;br&gt;
rules to function properly, and if there is no iptables, the rules can't&lt;br&gt;
be added and network creation fails. Your libvirtd.log confirms that&lt;br&gt;
problem:&lt;br&gt;
&lt;br&gt;
   10:06:06.980: error : networkAddIptablesRules:750 : failed to add&lt;br&gt;
iptables rule to allow DHCP requests from 'virbr0': Invalid argument&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
0.7.5 is quite old (&gt; 1 year), is there perhaps a newer pre-built&lt;br&gt;
version of libvirt available for your release of Ubuntu?&lt;br&gt;
&lt;br&gt;
It seems that Ubuntu's method of starting up libvirtd (at least on your&lt;br&gt;
machine) is missing a dependency to force iptables to be loaded before&lt;br&gt;
libvirtd starts. I'm unfamiliar with Ubuntu/debian startup stuff&lt;br&gt;
(upstart, I guess), but that's where you need to look for the solution.&lt;br&gt;
&lt;br&gt;
I found the following in the ubuntu bug database, which seems similar,&lt;br&gt;
but not identical (basically the system networking isn't completely&lt;br&gt;
ready by the time the autostart domains are brought up):&lt;br&gt;
&lt;br&gt;
&lt;a href="https://bugs.launchpad.net/ubuntu/+source/libvirt/+bug/495394" \
target="_blank"&gt;https://bugs.launchpad.net/ubuntu/+source/libvirt/+bug/495394&lt;/a&gt;&lt;br&gt; \
&lt;br&gt; &gt;&lt;br&gt;
&gt; Scenatio 3.&lt;br&gt;
&gt; Beside BASE MODULES + the following modules were loaded:&lt;br&gt;
&gt;&lt;br&gt;
&gt; $ diff modules1 modules2&lt;br&gt;
&gt; 1c1,6&lt;br&gt;
&gt; &lt; iptable_filter 1841 0 - Live 0xffffffffa008b000&lt;br&gt;
&gt; ---&lt;br&gt;
&gt; &gt; xt_state 1490 14 - Live 0xffffffffa01ab000&lt;br&gt;
&gt; &gt; xt_tcpudp 2667 12 - Live 0xffffffffa01a5000&lt;br&gt;
&gt; &gt; nf_conntrack_ipv4 12742 14 - Live 0xffffffffa019b000&lt;br&gt;
&gt; &gt; nf_conntrack 73326 2 xt_state,nf_conntrack_ipv4, Live \
0xffffffffa017d000&lt;br&gt; &lt;br&gt;
conntrack is used by iptables. I haven't tried it, but wouldn't be&lt;br&gt;
surprised if adding rules that required conntrack failed if it hadn't&lt;br&gt;
been loaded, or something like that.&lt;br&gt;
&lt;br&gt;
&gt; &gt; nf_defrag_ipv4 1481 1 nf_conntrack_ipv4, Live 0xffffffffa0177000&lt;br&gt;
&gt; &gt; iptable_filter 1841 1 - Live 0xffffffffa008b000&lt;br&gt;
&gt; 3c8&lt;br&gt;
&gt; &lt; x_tables 22361 1 ip_tables, Live 0xffffffffa0162000&lt;br&gt;
&gt; ---&lt;br&gt;
&gt; &gt; x_tables 22361 3 xt_state,xt_tcpudp,ip_tables, Live 0xffffffffa0162000&lt;br&gt;
&gt;&lt;br&gt;
&gt; Other observations:&lt;br&gt;
&gt; Scenatio 1.&lt;br&gt;
&gt; No errors in libvirtd.log&lt;br&gt;
&gt; Scenario 2.&lt;br&gt;
&gt;&lt;br&gt;
&gt; 10:06:06.980: error : networkAddIptablesRules:750 : failed to add&lt;br&gt;
&gt; iptables rule to allow DHCP requests from 'virbr0': Invalid argument&lt;br&gt;
&gt; (...)&lt;br&gt;
&gt; 10:06:08.630: error : qemudNetworkIfaceConnect:1445 : Failed to add&lt;br&gt;
&gt; tap interface to bridge 'virbr0': No such device&lt;br&gt;
&gt; 10:06:08.630: error : qemuAutostartDomain:584 : Failed to autostart VM&lt;br&gt;
&gt; 'cluster_server1': Failed to add tap interface to bridge \
'virbr0': No&lt;br&gt; &gt; such device&lt;br&gt;
&gt;&lt;br&gt;
&gt; 10:06:08.921: info : qemudDispatchSignalEvent:390 : Received&lt;br&gt;
&gt; unexpected signal 17&lt;br&gt;
&gt; 10:06:08.927: debug : virExecWithHook:617 : LC_ALL=C /usr/bin/kvm -help&lt;br&gt;
&gt; 10:06:08.938: info : qemudDispatchSignalEvent:390 : Received&lt;br&gt;
&gt; unexpected signal 17&lt;br&gt;
&gt; 10:06:09.000: error : qemudNetworkIfaceConnect:1445 : Failed to add&lt;br&gt;
&gt; tap interface to bridge 'virbr0': No such device&lt;br&gt;
&gt; 10:06:09.000: error : qemuAutostartDomain:584 : Failed to autostart VM&lt;br&gt;
&gt; 'cluster_server2': Failed to add tap interface to bridge \
'virbr0': No&lt;br&gt; &gt; such device&lt;br&gt;
&gt; (...)&lt;br&gt;
&gt; Scenatio 3.&lt;br&gt;
&gt; No errors in libvirtd.log&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt; I didn't see any valuable logs in /var/log/boot.log,&lt;br&gt;
&gt; /var/log/messages, /var/log/syslog. Please let me know if you want to&lt;br&gt;
&gt; see them anyway or have any suggestions right away.&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt; _______________________________________________&lt;br&gt;
&gt; libvirt-users mailing list&lt;br&gt;
&gt; &lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
&gt; &lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
------------------------------&lt;br&gt;
&lt;br&gt;
Message: 2&lt;br&gt;
Date: Mon, 13 Jun 2011 08:25:00 -0500&lt;br&gt;
From: Jeff &lt;&lt;a href="mailto:jwk1230@gmail.com"&gt;jwk1230@gmail.com&lt;/a&gt;&gt;&lt;br&gt;
To: &lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
Subject: [libvirt-users] Boot delay&lt;br&gt;
Message-ID: &lt;&lt;a href="mailto:4609858C-FB73-4E8A-B81B-3EDCBB83B755@gmail.com"&gt;4609858C-FB73-4E8A-B81B-3EDCBB83B755@gmail.com&lt;/a&gt;&gt;&lt;br&gt;
                
Content-Type: text/plain; charset=us-ascii&lt;br&gt;
&lt;br&gt;
Is there a method of tweaking the boot sequence of a KVM instance so that you can \
delay the process for X number of seconds? I don't have enough time between \
starting the KVM and connecting via VNC.&lt;br&gt; &lt;br&gt;
Thanks&lt;br&gt;
&lt;br&gt;
Jeff&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
------------------------------&lt;br&gt;
&lt;br&gt;
Message: 3&lt;br&gt;
Date: Fri, 10 Jun 2011 15:12:36 -0500&lt;br&gt;
From: Jeff &lt;&lt;a href="mailto:jwk1230@gmail.com"&gt;jwk1230@gmail.com&lt;/a&gt;&gt;&lt;br&gt;
To: Osier Yang &lt;&lt;a href="mailto:jyang@redhat.com"&gt;jyang@redhat.com&lt;/a&gt;&gt;, &lt;a \
                href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
                
Subject: [libvirt-users] e:  How to disconnect the ISO image using&lt;br&gt;
        virsh&lt;br&gt;
Message-ID: &lt;&lt;a href="mailto:F301FBCE-65F1-411A-980E-EF8B6A46241B@gmail.com"&gt;F301FBCE-65F1-411A-980E-EF8B6A46241B@gmail.com&lt;/a&gt;&gt;&lt;br&gt;
                
Content-Type: text/plain; charset="utf-8"&lt;br&gt;
&lt;br&gt;
I am trying to detach an ISO from a KVM machine and I've tried both attach-disk \
using " " in the file path as well as the update-device option but am \
getting this error&lt;br&gt; &lt;br&gt;
error: Failed to update device from /var/run/libvirt/qemu/kvmtest1.xml&lt;br&gt;
error: XML description for unknown device type is not well formed or invalid.&lt;br&gt;
&lt;br&gt;
I tried doing a virsh edit on the xml file to remove the source file path to the ISO, \
as I assume is the correct method, and then running the virsh update-device but \
it's not working.&lt;br&gt; &lt;br&gt;
Can anyone advise the correct steps to detach a device from a running and/or offline \
domain?&lt;br&gt; &lt;br&gt;
Additionally - anyone have any guidance on how to attach a CD device to a domain that \
is currently shutdown, for example, if I wanted to boot the domain to a rescue CD \
image?&lt;br&gt; &lt;br&gt;
Thanks&lt;br&gt;
&lt;br&gt;
Jeff&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
? 2011?03?31? 15:17, Masanari Iida ??:&lt;br&gt;
Somebody sent me a tips.&lt;br&gt;
Following command do what I wanted to do.&lt;br&gt;
Thanks.&lt;br&gt;
&lt;br&gt;
attach-disk guest01 " " hdc --driver file --type cdrom&lt;br&gt;
--mode readonly&lt;br&gt;
Also using "update-device" with an xml which doesn't specify&lt;br&gt;
the source file path will work.&lt;br&gt;
&lt;br&gt;
On Thu, Mar 31, 2011 at 3:29 PM, Masanari Iida&lt;standby24x7 gmail com&gt;  \
wrote:&lt;br&gt; Hello,&lt;br&gt;
&lt;br&gt;
I can attach disc ISO image to cd-rom from virsh.&lt;br&gt;
And I can replace the ISO image from disc1 to disc2 using the 2nd example.&lt;br&gt;
&lt;br&gt;
(example)&lt;br&gt;
attach-disk guest01 /root/disc1.iso hdc --driver file --type cdrom&lt;br&gt;
--mode readonly&lt;br&gt;
attach-disk guest01 /root/disc2.iso hdc --driver file --type cdrom&lt;br&gt;
--mode readonly&lt;br&gt;
&lt;br&gt;
My question is, how can I disconnect the image from the cdrom drive using virsh.&lt;br&gt;
Because, if I try to detach-disk hdc, I got following errors.&lt;br&gt;
&lt;br&gt;
virsh # detach-disk guest01 hdc&lt;br&gt;
error: Failed to detach disk&lt;br&gt;
error: this function is not supported by the connection driver:&lt;br&gt;
This type of device cannot be hot unplugged&lt;br&gt;
&lt;br&gt;
What I can do is possible from virt-manager's "Disconnect" button,&lt;br&gt;
(next to source path: line)  from Hardware's TAB, Disk hdc screen.&lt;br&gt;
I want to do this from virsh.&lt;br&gt;
&lt;br&gt;
OS: RHEL5.6&lt;br&gt;
libvirt-0.8.2-15.el5_6.1 is used.&lt;br&gt;
&lt;br&gt;
Regards,&lt;br&gt;
Masanari Iida&lt;br&gt;
&lt;br&gt;
_______________________________________________&lt;br&gt;
libvirt-users mailing list&lt;br&gt;
libvirt-users redhat com&lt;br&gt;
&lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; &lt;br&gt;
-------------- next part --------------&lt;br&gt;
An HTML attachment was scrubbed...&lt;br&gt;
URL: &lt;&lt;a href="https://www.redhat.com/archives/libvirt-users/attachments/20110610/f4acfe4c/attachment.html" \
target="_blank"&gt;https://www.redhat.com/archives/libvirt-users/attachments/20110610/f4acfe4c/attachment.html&lt;/a&gt;&gt;&lt;br&gt;


&lt;br&gt;
------------------------------&lt;br&gt;
&lt;br&gt;
Message: 4&lt;br&gt;
Date: Sat, 11 Jun 2011 06:39:46 +0530&lt;br&gt;
From: Abhishek Gupta &lt;&lt;a \
                href="mailto:cs1090174@cse.iitd.ernet.in"&gt;cs1090174@cse.iitd.ernet.in&lt;/a&gt;&gt;&lt;br&gt;
                
To: &lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
Subject: [libvirt-users] Difference between function Migrate and&lt;br&gt;
        Migrate2&lt;br&gt;
Message-ID: &lt;BANLkTinv6XiRMz=&lt;a \
href="mailto:rS88A-U-b2Hz3SVTesg@mail.gmail.com"&gt;rS88A-U-b2Hz3SVTesg@mail.gmail.com&lt;/a&gt;&gt;&lt;br&gt;
                
Content-Type: text/plain; charset=ISO-8859-1&lt;br&gt;
&lt;br&gt;
I was reading the API reference for the libvirt, when I came across&lt;br&gt;
the function? virDomainMigrate and virDomainMigrate2. I am unable to&lt;br&gt;
find the difference between the two. Can someone please tell the&lt;br&gt;
difference in the application of the two?&lt;br&gt;
&lt;br&gt;
--&lt;br&gt;
Abhishek&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
------------------------------&lt;br&gt;
&lt;br&gt;
Message: 5&lt;br&gt;
Date: Mon, 13 Jun 2011 17:21:02 +0200&lt;br&gt;
From: Michal Privoznik &lt;&lt;a \
                href="mailto:mprivozn@redhat.com"&gt;mprivozn@redhat.com&lt;/a&gt;&gt;&lt;br&gt;
To: Jeff &lt;&lt;a href="mailto:jwk1230@gmail.com"&gt;jwk1230@gmail.com&lt;/a&gt;&gt;&lt;br&gt;
Cc: &lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
Subject: Re: [libvirt-users] Boot delay&lt;br&gt;
Message-ID: &lt;&lt;a href="mailto:4DF62ADE.60209@redhat.com"&gt;4DF62ADE.60209@redhat.com&lt;/a&gt;&gt;&lt;br&gt;
                
Content-Type: text/plain; charset=ISO-8859-1&lt;br&gt;
&lt;br&gt;
On 13.06.2011 15:25, Jeff wrote:&lt;br&gt;
&gt; Is there a method of tweaking the boot sequence of a KVM instance so that you \
can delay the process for X number of seconds? I don't have enough time between \
starting the KVM and connecting via VNC.&lt;br&gt; &gt;&lt;br&gt;
You might consider using virt-viewer. It simply waits for domain to&lt;br&gt;
boot, if it is down.&lt;br&gt;
&lt;br&gt;
Your other option is to create hook script:&lt;br&gt;
&lt;a href="http://libvirt.org/hooks.html" \
target="_blank"&gt;http://libvirt.org/hooks.html&lt;/a&gt;&lt;br&gt; and put conditional sleep \
there, because libvirt just before running a&lt;br&gt; domain tries to execute qemu with \
some arguments (e.g. -help) to qeury&lt;br&gt; its capabilities. And you don't want \
your hook script to delay that.&lt;br&gt; &lt;br&gt;
So you need something like this:&lt;br&gt;
&lt;br&gt;
if [ $2 == "start" ]; then&lt;br&gt;
        sleep 5&lt;br&gt;
fi&lt;br&gt;
&lt;br&gt;
&gt; Thanks&lt;br&gt;
&gt;&lt;br&gt;
&gt; Jeff&lt;br&gt;
&gt;&lt;br&gt;
&gt; _______________________________________________&lt;br&gt;
&gt; libvirt-users mailing list&lt;br&gt;
&gt; &lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
&gt; &lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; &lt;br&gt;
Michal&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
------------------------------&lt;br&gt;
&lt;br&gt;
Message: 6&lt;br&gt;
Date: Mon, 13 Jun 2011 11:42:44 -0400&lt;br&gt;
From: Whit Blauvelt &lt;&lt;a \
                href="mailto:whit.virt@transpect.com"&gt;whit.virt@transpect.com&lt;/a&gt;&gt;&lt;br&gt;
                
To: &lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
Subject: [libvirt-users] hook scripts - not in Ubuntu packages?&lt;br&gt;
Message-ID: &lt;&lt;a href="mailto:20110613154244.GA28777@black.transpect.com"&gt;20110613154244.GA28777@black.transpect.com&lt;/a&gt;&gt;&lt;br&gt;
                
Content-Type: text/plain; charset=us-ascii&lt;br&gt;
&lt;br&gt;
On Mon, Jun 13, 2011 at 05:21:02PM +0200, Michal Privoznik wrote:&lt;br&gt;
&lt;br&gt;
&gt; Your other option is to create hook script:&lt;br&gt;
&gt; &lt;a href="http://libvirt.org/hooks.html" \
target="_blank"&gt;http://libvirt.org/hooks.html&lt;/a&gt;&lt;br&gt; &lt;br&gt;
That looks useful.&lt;br&gt;
&lt;br&gt;
On several Ubuntu systems, with Ubuntu libvirt 0.8.8 and 0.8.3 packages&lt;br&gt;
installed, there's no libvirt/hooks/ directory at all. Is this a directory&lt;br&gt;
that can simply be created and used under libvirt, or does using this&lt;br&gt;
feature on Ubuntu require custom installation?&lt;br&gt;
&lt;br&gt;
Thanks,&lt;br&gt;
Whit&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
------------------------------&lt;br&gt;
&lt;br&gt;
_______________________________________________&lt;br&gt;
libvirt-users mailing list&lt;br&gt;
&lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
&lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; &lt;br&gt;
End of libvirt-users Digest, Vol 18, Issue 17&lt;br&gt;
*********************************************&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110616075328</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-06-16 07:53:28-0400</timestampReceived><subject>Re: [libvirt-users] 2 virsh consoles on the same hypervisor causes conflicts</subject><body>

On Wed, Jun 15, 2011 at 01:43:14PM -0400, David Lane wrote:
&gt; Anyone encountered this?  Anyone have a solution?  Seeing it in Fedora15
&gt; with KVM
&gt; 
&gt; If 2 consoles are opened to the same guest from the hypervisor they will
&gt; interfere with each other.  keystrokes are lost and returned information is
&gt; displayed on either virsh console instances randomly.  Both consoles are
&gt; rendered unusable.

Yeah, this is normal - only one client can access /dev/pts/XXX devices
at a time, otherwise it just all goes wrong.

Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110615143424</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2011-06-15 14:34:24-0400</timestampReceived><subject>Re: [libvirt-users] Virtual switches support (Openvswitch, VDE, ...)</subject><body>

On Wed, Jun 01, 2011 at 09:50:45AM +0200, Jérémie Tarot wrote:
&gt; Hi,
&gt; 
&gt; IIR/UC there have been a couple of discussions lately about possible
&gt; evolution of libvirt's network management features to eventually support
&gt; more kinds of virtual networking technologies like Openvswitch, VDE,...
&gt; 
&gt; Could a kind and informed soul keep us on touch with progress in the field ?
&gt; 
&gt; Thank you very much in advance

 Well here is the opportunity to give feedback, Laine just sent version 3
of his proposal (on the libvir-list the developper one)
  https://www.redhat.com/archives/libvir-list/2011-June/msg00471.html
please have a look and tell us if you think it would be fine

  thanks in advance,

&gt; PS: I wish this will be available before/for 1.0 release...

  hopefully yes :-)

Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

</body></email><email><emailId>20110623231450</emailId><senderName>PLD</senderName><senderEmail>sa212+libvirt@cyconix.com</senderEmail><timestampReceived>2011-06-23 23:14:50-0400</timestampReceived><subject>[libvirt-users] Starting libvirtd cuts off host access to external network</subject><body>

I've spent some hours on this without success - any help greatly 
appreciated.

I've just done a new RHEL6 setup, with a KVM guest (first time). The 
basic installation works fine until I start libvirtd; at this point, the 
host machine loses access to the external network:

step 1: ping from host to network works; external machine on network can 
ping both eth0 and br1 on the host

step 2: /sbin/service libvirtd start

step 3: ping from host to network fails; external machine on the network 
can't ping either eth0 or br1 on the host

Stopping libvirtd (/sbin/service libvirtd stop) makes no difference - 
the network remains unreachable.

Any idea why this would happen? I have installed a kvm guest, using the 
default network script at /etc/libvirtd/qemu/networks/default.xml 
(although I've changed the IP addresses to be on my subnet, and the DHCP 
server returns only one address).

I have also configured a bridge; I've attached ifcfg-eth0, ifcfg-eth1, 
and ifcfg-br1 below. I haven't changed any iptables configuration. If I 
run the guest (also RHEL6) the guest can talk to the host, but it can't 
see the outside world.

Thanks -

Paul

================================================

ifcfg-eth0:
-----------

NM_CONTROLLED="no"
DEVICE="eth0"
HWADDR=00:16:E6:8A:C7:20
ONBOOT=yes
TYPE=Ethernet
DEFROUTE=yes
IPV4_FAILURE_FATAL=yes
IPV6INIT=no
NAME="System eth0"
NETMASK=255.255.255.0
BOOTPROTO=dhcp

ifcfg-eth1:
-----------

NM_CONTROLLED="no"
DEVICE="eth1"
HWADDR=00:16:E6:8A:C7:21
ONBOOT=yes
TYPE=Ethernet
DEFROUTE=yes
IPV4_FAILURE_FATAL=yes
IPV6INIT=no
NAME="System eth1"
BRIDGE=br1
NETMASK=255.255.255.0

ifcfg-br1:
----------

NM_CONTROLLED="no"
DEVICE=br1
BOOTPROTO=dhcp
ONBOOT=yes
TYPE=Bridge
DELAY=0

</body></email><email><emailId>20110624091255</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-06-24 09:12:55-0400</timestampReceived><subject>Re: [libvirt-users] Starting libvirtd cuts off host access to external network</subject><body>

On Fri, Jun 24, 2011 at 12:14:50AM +0100, PLD wrote:
&gt; I've spent some hours on this without success - any help greatly
&gt; appreciated.
&gt; 
&gt; I've just done a new RHEL6 setup, with a KVM guest (first time). The
&gt; basic installation works fine until I start libvirtd; at this point,
&gt; the host machine loses access to the external network:
&gt; 
&gt; step 1: ping from host to network works; external machine on network
&gt; can ping both eth0 and br1 on the host
&gt; 
&gt; step 2: /sbin/service libvirtd start
&gt; 
&gt; step 3: ping from host to network fails; external machine on the
&gt; network can't ping either eth0 or br1 on the host
&gt; 
&gt; Stopping libvirtd (/sbin/service libvirtd stop) makes no difference
&gt; - the network remains unreachable.
&gt; 
&gt; Any idea why this would happen? I have installed a kvm guest, using
&gt; the default network script at
&gt; /etc/libvirtd/qemu/networks/default.xml (although I've changed the
&gt; IP addresses to be on my subnet, and the DHCP server returns only
&gt; one address).

And therein lies your mistake, I believe. The libvirt virtual
network functionality is *not* for attaching your guests to
the physical LAN. If you want guests to have addresses on
the physical LAN, you want to just setup bridging for your
physical NICs and attach the guest to the bridge.

The libvirt virtual network functionality is for providing
NAT based connections to the guest, with the guest network
having a *different* IP range to the physical LAN. By
changing the libvirt network to have an IP address which
is on your LAN subnet, the firewall rules will likely have
killed all your host connectivity.

The virtual network stuff is not deactived when stopping
libvirtd. Instead use the following to stop it

  virsh net-destroy default
  virsh net-autostart --disable default

and the firewall rules should then go away.

&gt; I have also configured a bridge; I've attached ifcfg-eth0,
&gt; ifcfg-eth1, and ifcfg-br1 below. I haven't changed any iptables
&gt; configuration. If I run the guest (also RHEL6) the guest can talk to
&gt; the host, but it can't see the outside world.

Yes, this is what you want. Revert your changes to the default
virtual network and just use this bridge setup.

Basically you want to follow setup 2 here:

  http://wiki.libvirt.org/page/Networking


What you have tried todo is to use setup1 &amp; 2 at the same
time which is not good :-)

Regards,
Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110616103642</emailId><senderName>Stefan Hajnoczi</senderName><senderEmail>stefanha@linux.vnet.ibm.com</senderEmail><timestampReceived>2011-06-16 10:36:42-0400</timestampReceived><subject>Re: [libvirt-users] Base server as file server.</subject><body>

On Thu, Jun 16, 2011 at 03:26:25PM +0530, arun.sasi1@wipro.com wrote:
&gt; Will I get complete performance on file server since it is in Base
&gt; server where KVM kernel installed...

Yes, applications running on the host will performance as normal.
Remember that virtual machines consume CPU, memory, and other resources
too though.  That means busy VMs can affect application performance on
the host.

Stefan

</body></email><email><emailId>20110607013140</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2011-06-07 01:31:40-0400</timestampReceived><subject>Re: [libvirt-users] request to add an application the app listing on libvirt site</subject><body>

On Sun, Jun 05, 2011 at 11:32:48AM +0300, Ohad Levy wrote:
&gt; Hi,
&gt; 
&gt; I would like to add two apps which uses libvirt the site.
&gt; 
&gt; Ruby Objects for libvirt
&gt; based on top of the native ruby binding, Virt ruby gem exposes real objects
&gt; such as Host, Guest, StoragePool, Interface etc.
&gt; 
&gt; more info at https://github.com/ohadlevy/virt
&gt; 
&gt; Foreman - Web UI for provisioning and managing servers
&gt; 
&gt; Among the many things foreman can do, It provides to relevant parts to
&gt; libvirt:
&gt; 
&gt; UI to list / start / stop / destroy vms
&gt; UI to create a new vm as part of the provisioning process (e.g. dhcp, dns,
&gt; tftp, pxe, vm, ks/preseed, puppet etc)
&gt; 
&gt; more info at http://theforeman.org

  Hi Ohad,

the simplest is to actually send a patch against the file docs/apps.html.in
in the source tree. I would think "Ruby Objects for libvirt" should be
added in the "libraries" section, and "Foreman" in the "provisioning"
section. The pages are maintained in the source which also allow to
package them easilly, I hope making an HTML patch isn't too complex,
if not say so I will do it myself :-)

  thanks !

Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

</body></email><email><emailId>20110614161709</emailId><senderName>Ohad Levy</senderName><senderEmail>ohadlevy@gmail.com</senderEmail><timestampReceived>2011-06-14 16:17:09-0400</timestampReceived><subject>Re: [libvirt-users] request to add an application the app listing on libvirt site</subject><body>

[Attachment #2 (multipart/alternative)]


On Tue, Jun 7, 2011 at 4:31 AM, Daniel Veillard &lt;veillard@redhat.com&gt; wrote:

&gt; On Sun, Jun 05, 2011 at 11:32:48AM +0300, Ohad Levy wrote:
&gt; &gt; Hi,
&gt; &gt;
&gt; &gt; I would like to add two apps which uses libvirt the site.
&gt; &gt;
&gt; &gt; Ruby Objects for libvirt
&gt; &gt; based on top of the native ruby binding, Virt ruby gem exposes real
&gt; objects
&gt; &gt; such as Host, Guest, StoragePool, Interface etc.
&gt; &gt;
&gt; &gt; more info at https://github.com/ohadlevy/virt
&gt; &gt;
&gt; &gt; Foreman - Web UI for provisioning and managing servers
&gt; &gt;
&gt; &gt; Among the many things foreman can do, It provides to relevant parts to
&gt; &gt; libvirt:
&gt; &gt;
&gt; &gt; UI to list / start / stop / destroy vms
&gt; &gt; UI to create a new vm as part of the provisioning process (e.g. dhcp,
&gt; dns,
&gt; &gt; tftp, pxe, vm, ks/preseed, puppet etc)
&gt; &gt;
&gt; &gt; more info at http://theforeman.org
&gt;
&gt;   Hi Ohad,
&gt;
&gt; the simplest is to actually send a patch against the file docs/
&gt; apps.html.in
&gt; in the source tree. I would think "Ruby Objects for libvirt" should be
&gt; added in the "libraries" section, and "Foreman" in the "provisioning"
&gt; section. The pages are maintained in the source which also allow to
&gt; package them easilly, I hope making an HTML patch isn't too complex,
&gt; if not say so I will do it myself :-)
&gt;
&gt;  thanks !
&gt;
&gt; thanks! see attached patch.


&gt; Daniel
&gt;
&gt; --
&gt; Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
&gt; daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
&gt; http://veillard.com/ | virtualization library  http://libvirt.org/
&gt;

[Attachment #5 (text/html)]

&lt;div dir="ltr"&gt;&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Tue, Jun 7, 2011 at 4:31 AM, \
Daniel Veillard &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:veillard@redhat.com"&gt;veillard@redhat.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt; &lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;On Sun, Jun 05, 2011 \
at 11:32:48AM +0300, Ohad Levy wrote:&lt;br&gt; &gt; Hi,&lt;br&gt;
&gt;&lt;br&gt;
&gt; I would like to add two apps which uses libvirt the site.&lt;br&gt;
&gt;&lt;br&gt;
&gt; Ruby Objects for libvirt&lt;br&gt;
&gt; based on top of the native ruby binding, Virt ruby gem exposes real objects&lt;br&gt;
&gt; such as Host, Guest, StoragePool, Interface etc.&lt;br&gt;
&gt;&lt;br&gt;
&gt; more info at &lt;a href="https://github.com/ohadlevy/virt" \
target="_blank"&gt;https://github.com/ohadlevy/virt&lt;/a&gt;&lt;br&gt; &gt;&lt;br&gt;
&gt; Foreman - Web UI for provisioning and managing servers&lt;br&gt;
&gt;&lt;br&gt;
&gt; Among the many things foreman can do, It provides to relevant parts to&lt;br&gt;
&gt; libvirt:&lt;br&gt;
&gt;&lt;br&gt;
&gt; UI to list / start / stop / destroy vms&lt;br&gt;
&gt; UI to create a new vm as part of the provisioning process (e.g. dhcp, dns,&lt;br&gt;
&gt; tftp, pxe, vm, ks/preseed, puppet etc)&lt;br&gt;
&gt;&lt;br&gt;
&gt; more info at &lt;a href="http://theforeman.org" \
target="_blank"&gt;http://theforeman.org&lt;/a&gt;&lt;br&gt; &lt;br&gt;
&lt;/div&gt;&lt;/div&gt;   Hi Ohad,&lt;br&gt;
&lt;br&gt;
the simplest is to actually send a patch against the file docs/&lt;a \
href="http://apps.html.in" target="_blank"&gt;apps.html.in&lt;/a&gt;&lt;br&gt; in the source tree. I \
would think "Ruby Objects for libvirt" should be&lt;br&gt; added in the \
"libraries" section, and "Foreman" in the \
"provisioning"&lt;br&gt; section. The pages are maintained in the source which \
also allow to&lt;br&gt; package them easilly, I hope making an HTML patch isn't too \
complex,&lt;br&gt; if not say so I will do it myself :-)&lt;br&gt;
&lt;br&gt;
   thanks !&lt;br&gt;
&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;thanks! see attached patch.&lt;/div&gt;&lt;div&gt;  &lt;/div&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt; Daniel&lt;br&gt;
&lt;font color="#888888"&gt;&lt;br&gt;
--&lt;br&gt;
Daniel Veillard         | libxml Gnome XML XSLT toolkit   &lt;a \
href="http://xmlsoft.org/" target="_blank"&gt;http://xmlsoft.org/&lt;/a&gt;&lt;br&gt; &lt;a \
href="mailto:daniel@veillard.com"&gt;daniel@veillard.com&lt;/a&gt;   | Rpmfind RPM search \
engine &lt;a href="http://rpmfind.net/" target="_blank"&gt;http://rpmfind.net/&lt;/a&gt;&lt;br&gt; &lt;a \
href="http://veillard.com/" target="_blank"&gt;http://veillard.com/&lt;/a&gt; | virtualization \
library   &lt;a href="http://libvirt.org/" target="_blank"&gt;http://libvirt.org/&lt;/a&gt;&lt;br&gt; \
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;

--20cf3005143c3111fd04a5ae5ea7--


["0001-docs-updated-list-of-applications-using-libvirt.patch" (text/x-patch)]

From 0085b83be989c22cf1d292377283479c2aa15549 Mon Sep 17 00:00:00 2001
From: Ohad Levy &lt;ohadlevy@redhat.com&gt;
Date: Tue, 7 Jun 2011 09:36:50 +0300
Subject: [PATCH] docs: updated list of applications using libvirt.

Added:
* Virt ruby bindings
* Foreman for provisioning and webui.
---
 docs/apps.html.in |   23 ++++++++++++++++++++++-
 1 files changed, 22 insertions(+), 1 deletions(-)

diff --git a/docs/apps.html.in b/docs/apps.html.in
index 8b949f3..23fe0cf 100644
--- a/docs/apps.html.in
+++ b/docs/apps.html.in
@@ -14,7 +14,8 @@
     &lt;p&gt;
       To add an application not listed on this page, send a message
       to the &lt;a href="contact.html"&gt;mailing list&lt;/a&gt;, requesting it
-      be added here. If your application uses libvirt as its API,
+      be added here, or simply send a patch against the documentation in our git \
docs sub directory. +      If your application uses libvirt as its API,
       the following graphic is available for your website to advertise
       support for libvirt:
     &lt;/p&gt;
@@ -226,6 +227,13 @@
       &lt;/dd&gt;
     &lt;/dl&gt;
 
+        &lt;dl&gt;
+            &lt;dt&gt;&lt;a href="https://github.com/ohadlevy/virt#readme"&gt;Ruby Libvirt \
Object bindings&lt;/a&gt;&lt;/dt&gt; +            &lt;dd&gt;
+                Virt Allows using simple ruby objects to manipulate hypervisors, \
guests, storage, network etc. +                It is based on top of the &lt;a \
href="http://libvirt.org/ruby"&gt;native ruby binding&lt;/a&gt;. +            &lt;/dd&gt;
+        &lt;/dl&gt;
     &lt;h2&gt;&lt;a name="livecd"&gt;LiveCD / Appliances&lt;/a&gt;&lt;/h2&gt;
 
     &lt;dl&gt;
@@ -284,6 +292,19 @@
       &lt;/dd&gt;
     &lt;/dl&gt;
 
+    &lt;dl&gt;
+      &lt;dt&gt;&lt;a href="http://theforeman.org"&gt;Foreman&lt;/a&gt;&lt;/dt&gt;
+      &lt;dd&gt;
+      Foreman is an open source web based application aimed to be a Single Address \
For All Machines Life Cycle Management, Foreman: +
+      &lt;ul&gt;
+          &lt;li&gt;Creates everything you need when adding a new machine to your \
network,It's goal being automatically managing everything you would normally manage \
manually (DNS, DHCP, TFTP, Virtual Machines,CA, CMDB...)&lt;/li&gt; +          \
&lt;li&gt;Integrates with Puppet (and acts as web front end to it).&lt;/li&gt; +          \
&lt;li&gt;Takes care of provisioning until the point puppet is running, allowing Puppet to \
do what it does best.&lt;/li&gt; +          &lt;li&gt;Shows you Systems Inventory (based on \
Facter) and provides real time information about hosts status based on Puppet \
reports.&lt;/li&gt; +      &lt;/dd&gt;
+    &lt;/dl&gt;
+
 
     &lt;h2&gt;&lt;a name="web"&gt;Web applications&lt;/a&gt;&lt;/h2&gt;
 
-- 
1.7.4.4



</body></email><email><emailId>20110613152102</emailId><senderName>Michal Privoznik</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2011-06-13 15:21:02-0400</timestampReceived><subject>Re: [libvirt-users] Boot delay</subject><body>

On 13.06.2011 15:25, Jeff wrote:
&gt; Is there a method of tweaking the boot sequence of a KVM instance so that you can \
&gt; delay the process for X number of seconds? I don't have enough time between \
&gt; starting the KVM and connecting via VNC. 
You might consider using virt-viewer. It simply waits for domain to
boot, if it is down.

Your other option is to create hook script:
http://libvirt.org/hooks.html
and put conditional sleep there, because libvirt just before running a
domain tries to execute qemu with some arguments (e.g. -help) to qeury
its capabilities. And you don't want your hook script to delay that.

So you need something like this:

if [ $2 == "start" ]; then
        sleep 5
fi

&gt; Thanks
&gt; 
&gt; Jeff
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

Michal


</body></email><email><emailId>20110601195256</emailId><senderName>Guilherme Santos</senderName><senderEmail>guisgb13@gmail.com</senderEmail><timestampReceived>2011-06-01 19:52:56-0400</timestampReceived><subject>[libvirt-users] Shared Folders</subject><body>

Good afternoon.

I am having trouble trying to set up shared folders in the guest VM using
VirtualBox hypervisor. No matter what configuration is defined in my XML, it
never works, I mean, no shared folder is added/specifyed, then, inside the
guest, when I try to mount the folder, I always get a protocol error.

If I use VirtualBoxManage, I can add/specify shared folders easily and mount
it with no problem.

I need to use libvirt in order to deal, in a generalized way, with the
process of creating shared folders in all hypervisors supported by libvirt,
otherwise my problem would be solved already. I must not use specific
commands of a certain hypervisor (such as VirtualBoxManage's).

How does libvirt allow me to set up shared folders? Does it use
VirtualBoxManage for VBox hypervisors? If so, how do I use it?
I've read the documentation and followed it in defining my XMLs.

Thanks anyway!
-- 
Guilherme Santos G. Baptista
Undergraduate in Computer Science at UFCG
LSD - Distributed Systems Laboratory

[Attachment #3 (text/html)]

Good afternoon.&lt;br&gt;&lt;br&gt;I am having trouble trying to set up shared folders in the \
guest VM using VirtualBox hypervisor. No matter what configuration is defined in my \
XML, it never works, I mean, no shared folder is added/specifyed, then, inside the \
guest, when I try to mount the folder, I always get a protocol error.&lt;br&gt;

&lt;br&gt;If I use VirtualBoxManage, I can add/specify shared folders easily and mount it \
with no problem.&lt;br clear="all"&gt;&lt;br&gt;I need to use libvirt in order to deal, in a \
generalized way, with the process of creating shared folders in all hypervisors \
supported by libvirt, otherwise my problem would be solved already. I must not use \
specific commands of a certain hypervisor (such as VirtualBoxManage's).&lt;br&gt;

&lt;br&gt;How does libvirt allow me to set up shared folders? Does it use VirtualBoxManage \
for VBox hypervisors? If so, how do I use it?&lt;br&gt;I've read the documentation and \
followed it in defining my XMLs.&lt;br&gt;&lt;br&gt;Thanks anyway!&lt;br&gt;

-- &lt;br&gt;Guilherme Santos G. Baptista&lt;br&gt;Undergraduate in Computer Science at \
UFCG&lt;br&gt;LSD - Distributed Systems Laboratory&lt;br&gt;



</body></email><email><emailId>20110606203835</emailId><senderName>Guilherme Santos</senderName><senderEmail>guisgb13@gmail.com</senderEmail><timestampReceived>2011-06-06 20:38:35-0400</timestampReceived><subject>Re: [libvirt-users] Shared Folders</subject><body>

Well, I am still with that problem, attempting to create shared folders, so
I will try to be more specific and then maybe somebody can help me.

When I say "I am trying to set up shared folders", I mean that I set this
configuration in my XML description:

    &lt;filesystem type='template' accessmode='mapped'&gt;
      &lt;source name='/home/guilhermesgb/Desktop/SharedFolder/&gt;
      &lt;target dir='/home/tarciso/Desktop/SharedFolder'/&gt;
    &lt;/filesystem&gt;

This was my last attempt. I also tried all other combinations, with
accessmodes "passthrough" and "squash", for filesystem type "mount" too.

I can't send you any error messages neither printscreens because my problem
is that anything happens, the domain is started properly but no shared
folder is specified so I can mount it, using command "sudo mount -t vboxsf
SharedFolder /home/tarciso/Desktop/SharedFolder". I always get a protocol
error.

I was expecting libvirt to automatically do this step for me, so I wouldn't
need to do it manually through vbox GUI or VBoxManage.

During my searches through the web, I found this other option, although I
can't be sure if it is implemented, as the libvirt website says nothing
about it: defining an XML file with this configuration:

    &lt;shareddir fstype="ext4" path="/home/guilhermesgb/Desktop/SharedFolder"
mount_tag="SharingName" security_model="passthrough" /&gt;

And then mounting it with proper command (the same as before, now with the
mount_tag specified: "sudo mount -t vboxsf SharingName
/home/tarciso/Desktop/SharedFolder" . Unfortunatelly the same error
persists.

Am I missing something?

Sorry if my first message was hard to understand. Thanks.

2011/6/1 Guilherme Santos &lt;guisgb13@gmail.com&gt;

&gt; Good afternoon.
&gt;
&gt; I am having trouble trying to set up shared folders in the guest VM using
&gt; VirtualBox hypervisor. No matter what configuration is defined in my XML, it
&gt; never works, I mean, no shared folder is added/specifyed, then, inside the
&gt; guest, when I try to mount the folder, I always get a protocol error.
&gt;
&gt; If I use VirtualBoxManage, I can add/specify shared folders easily and
&gt; mount it with no problem.
&gt;
&gt; I need to use libvirt in order to deal, in a generalized way, with the
&gt; process of creating shared folders in all hypervisors supported by libvirt,
&gt; otherwise my problem would be solved already. I must not use specific
&gt; commands of a certain hypervisor (such as VirtualBoxManage's).
&gt;
&gt; How does libvirt allow me to set up shared folders? Does it use
&gt; VirtualBoxManage for VBox hypervisors? If so, how do I use it?
&gt; I've read the documentation and followed it in defining my XMLs.
&gt;
&gt; Thanks anyway!
&gt;  --
&gt; Guilherme Santos G. Baptista
&gt; Undergraduate in Computer Science at UFCG
&gt; LSD - Distributed Systems Laboratory
&gt;



-- 
Guilherme Santos G. Baptista
Graduando em Ciência da Computação pela UFCG
LSD - Laboratório de Sistemas Distribuídos

[Attachment #3 (text/html)]

Well, I am still with that problem, attempting to create shared folders, so I will \
try to be more specific and then maybe somebody can help me.&lt;br&gt;&lt;br&gt;When I say \
"I am trying to set up shared folders", I mean that I set this \
configuration in my XML description:&lt;br&gt;

&lt;br&gt;    &lt;filesystem type='template' accessmode='mapped'&gt;&lt;br&gt;    \
&lt;source name='/home/guilhermesgb/Desktop/SharedFolder/&gt;&lt;br&gt;      &lt;target \
dir='/home/tarciso/Desktop/SharedFolder'/&gt;&lt;br&gt;

    &lt;/filesystem&gt;&lt;br&gt;&lt;br&gt;This was my last attempt. I also tried all other \
combinations, with accessmodes "passthrough" and "squash", for \
filesystem type "mount" too.&lt;br&gt;&lt;br&gt;I can't send you any error messages \
neither printscreens because my problem is that anything happens, the domain is \
started properly but no shared folder is specified so I can mount it, using command \
"sudo mount -t vboxsf SharedFolder /home/tarciso/Desktop/SharedFolder". I \
always get a protocol error.&lt;br&gt;

&lt;br&gt;I was expecting libvirt to automatically do this step for me, so I wouldn't \
need to do it manually through vbox GUI or VBoxManage.&lt;br&gt;&lt;br&gt;During my searches \
through the web, I found this other option, although I can't be sure if it is \
implemented, as the libvirt website says nothing about it: defining an XML file with \
this configuration:&lt;br&gt;

&lt;br&gt;    &lt;shareddir fstype="ext4" \
path="/home/guilhermesgb/Desktop/SharedFolder" \
mount_tag="SharingName" security_model="passthrough" \
/&gt;&lt;br&gt;&lt;br&gt;And then mounting it with proper command (the same as before, now with \
the mount_tag specified: "sudo mount -t vboxsf SharingName \
/home/tarciso/Desktop/SharedFolder" . Unfortunatelly the same error \
persists.&lt;br&gt;

&lt;br&gt;Am I missing something?&lt;br&gt;&lt;br&gt;Sorry if my first message was hard to understand. \
Thanks.&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;2011/6/1 Guilherme Santos &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:guisgb13@gmail.com"&gt;guisgb13@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;


&lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px \
solid rgb(204, 204, 204); padding-left: 1ex;"&gt;Good afternoon.&lt;br&gt;&lt;br&gt;I am having \
trouble trying to set up shared folders in the guest VM using VirtualBox hypervisor. \
No matter what configuration is defined in my XML, it never works, I mean, no shared \
folder is added/specifyed, then, inside the guest, when I try to mount the folder, I \
always get a protocol error.&lt;br&gt;


&lt;br&gt;If I use VirtualBoxManage, I can add/specify shared folders easily and mount it \
with no problem.&lt;br clear="all"&gt;&lt;br&gt;I need to use libvirt in order to deal, in a \
generalized way, with the process of creating shared folders in all hypervisors \
supported by libvirt, otherwise my problem would be solved already. I must not use \
specific commands of a certain hypervisor (such as VirtualBoxManage's).&lt;br&gt;


&lt;br&gt;How does libvirt allow me to set up shared folders? Does it use VirtualBoxManage \
for VBox hypervisors? If so, how do I use it?&lt;br&gt;I've read the documentation and \
followed it in defining my XMLs.&lt;br&gt;&lt;br&gt;Thanks anyway!&lt;br&gt;

&lt;font color="#888888"&gt;
-- &lt;br&gt;Guilherme Santos G. Baptista&lt;br&gt;Undergraduate in Computer Science at \
UFCG&lt;br&gt;LSD - Distributed Systems Laboratory&lt;br&gt; &lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br \
clear="all"&gt;&lt;br&gt;-- &lt;br&gt;Guilherme Santos G. Baptista&lt;br&gt;Graduando em Ciência da \
Computação pela UFCG&lt;br&gt;LSD - Laboratório de Sistemas Distribuídos&lt;br&gt;



</body></email><email><emailId>20110607072050</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-06-07 07:20:50-0400</timestampReceived><subject>Re: [libvirt-users] Shared Folders</subject><body>

2011/6/6 Guilherme Santos &lt;guisgb13@gmail.com&gt;:
&gt; Well, I am still with that problem, attempting to create shared folders, so
&gt; I will try to be more specific and then maybe somebody can help me.

Your problem is simple, libvirt currently doesn't support shared
folder for VirtualBox. I'll have a look at it and if it's simple to
implement you might see it in libvirt 0.9.3.

&gt; When I say "I am trying to set up shared folders", I mean that I set this
&gt; configuration in my XML description:
&gt;
&gt;     &lt;filesystem type='template' accessmode='mapped'&gt;
&gt;       &lt;source name='/home/guilhermesgb/Desktop/SharedFolder/&gt;
&gt;       &lt;target dir='/home/tarciso/Desktop/SharedFolder'/&gt;
&gt;     &lt;/filesystem&gt;

VirtualBox shared folders don't support setting an access mode. The
target dir will map to the name of the shared folder in the guest.
Also the template type is OpenVZ specific. A shared folder will
probably just map to this XML snippet:

&lt;filesystem type='mount'&gt;
  &lt;source dir='/home/guilhermesgb/Desktop/SharedFolder'/&gt;
  &lt;target dir='myshare1'/&gt;
&lt;/filesystem&gt;

You might also specify the &lt;readonly/&gt; option.

&gt; This was my last attempt. I also tried all other combinations, with
&gt; accessmodes "passthrough" and "squash", for filesystem type "mount" too.
&gt;
&gt; I can't send you any error messages neither printscreens because my problem
&gt; is that anything happens, the domain is started properly but no shared
&gt; folder is specified so I can mount it, using command "sudo mount -t vboxsf
&gt; SharedFolder /home/tarciso/Desktop/SharedFolder". I always get a protocol
&gt; error.
&gt;
&gt; I was expecting libvirt to automatically do this step for me, so I wouldn't
&gt; need to do it manually through vbox GUI or VBoxManage.

As I said libvirt just doesn't support this yet, but I'll look at it.

&gt; During my searches through the web, I found this other option, although I
&gt; can't be sure if it is implemented, as the libvirt website says nothing
&gt; about it: defining an XML file with this configuration:
&gt;
&gt;     &lt;shareddir fstype="ext4" path="/home/guilhermesgb/Desktop/SharedFolder"
&gt; mount_tag="SharingName" security_model="passthrough" /&gt;

Where did you find this? This is not libvirt XML.

&gt; And then mounting it with proper command (the same as before, now with the
&gt; mount_tag specified: "sudo mount -t vboxsf SharingName
&gt; /home/tarciso/Desktop/SharedFolder" . Unfortunatelly the same error
&gt; persists.
&gt;
&gt; Am I missing something?

No, it is exactly as expected, but it'll improve.

Matthias

&gt; Sorry if my first message was hard to understand. Thanks.
&gt;
&gt; 2011/6/1 Guilherme Santos &lt;guisgb13@gmail.com&gt;
&gt;&gt;
&gt;&gt; Good afternoon.
&gt;&gt;
&gt;&gt; I am having trouble trying to set up shared folders in the guest VM using
&gt;&gt; VirtualBox hypervisor. No matter what configuration is defined in my XML, it
&gt;&gt; never works, I mean, no shared folder is added/specifyed, then, inside the
&gt;&gt; guest, when I try to mount the folder, I always get a protocol error.
&gt;&gt;
&gt;&gt; If I use VirtualBoxManage, I can add/specify shared folders easily and
&gt;&gt; mount it with no problem.
&gt;&gt;
&gt;&gt; I need to use libvirt in order to deal, in a generalized way, with the
&gt;&gt; process of creating shared folders in all hypervisors supported by libvirt,
&gt;&gt; otherwise my problem would be solved already. I must not use specific
&gt;&gt; commands of a certain hypervisor (such as VirtualBoxManage's).
&gt;&gt;
&gt;&gt; How does libvirt allow me to set up shared folders? Does it use
&gt;&gt; VirtualBoxManage for VBox hypervisors? If so, how do I use it?
&gt;&gt; I've read the documentation and followed it in defining my XMLs.
&gt;&gt;
&gt;&gt; Thanks anyway!
&gt;&gt; --
&gt;&gt; Guilherme Santos G. Baptista
&gt;&gt; Undergraduate in Computer Science at UFCG
&gt;&gt; LSD - Distributed Systems Laboratory
&gt;
&gt;
&gt;
&gt; --
&gt; Guilherme Santos G. Baptista
&gt; Graduando em Ciência da Computação pela UFCG
&gt; LSD - Laboratório de Sistemas Distribuídos
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

</body></email><email><emailId>20110629141430</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-06-29 14:14:30-0400</timestampReceived><subject>[libvirt-users] ANNOUNCE: libvirt Perl bindings Sys::Virt 0.2.7 release</subject><body>

I am happy to announce a new release of the libvirt Perl bindings,
Sys::Virt 0.2.7 is available for download:

  http://search.cpan.org/CPAN/authors/id/D/DA/DANBERR/Sys-Virt-0.2.7.tar.gz

Changes in this release

 - Honour flags parameter when dumping XML
 - Use thread local error APIs exclusively
 - Fix bogus extra URI parameter in migrate_to_uri function
 - Implement all virStream APIs in Sys::Virt::Stream
 - Impement virDomainGetSysinfo binding
 - Call virInitialize when loading module
 - Add all missing error constants
 - Update example RPM spec to match Fedora
 - Requires libvirt &gt;= 0.8.8

The permanent link for the Sys::Virt package, where all historic releases
can be found, is

  http://search.cpan.org/dist/Sys-Virt/

Thanks to everyone who contributed to this release through testing, bug
reporting, patch submission, etc

Regards,
Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110711190804</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-07-11 19:08:04-0400</timestampReceived><subject>[libvirt-users] ANNOUNCE: libvirt Perl bindings Sys::Virt 0.9.2 release</subject><body>

I am happy to announce a new release[1] of the libvirt Perl bindings,
Sys::Virt 0.9.2 is available for download:

  http://search.cpan.org/CPAN/authors/id/D/DA/DANBERR/Sys-Virt-0.9.2.tar.gz

Changes in this release

 - Changed version numbering to track the corresponding
   minimum required libvirt releases
 - Add all new APIs in libvirt 0.9.2
 - Requires libvirt &gt;= 0.9.2

The permanent link for the Sys::Virt package, where all historic releases
can be found, is

  http://search.cpan.org/dist/Sys-Virt/

Thanks to everyone who contributed to this release through testing, bug
reporting, patch submission, etc

Regards,
Daniel
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110607122525</emailId><senderName>Guilherme Santos</senderName><senderEmail>guisgb13@gmail.com</senderEmail><timestampReceived>2011-06-07 12:25:25-0400</timestampReceived><subject>Re: [libvirt-users] Shared Folders</subject><body>

&gt;
&gt; A shared folder will
&gt; probably just map to this XML snippet:
&gt;
&lt;filesystem type='mount'&gt;
&gt;   &lt;source dir='/home/guilhermesgb/Desktop/SharedFolder'/&gt;

  &lt;target dir='myshare1'/&gt;

&lt;/filesystem&gt;


I see. I also tried this XML configuration you gave as an example, but it
wouldn't work. And now I know why...

&lt;shareddir fstype="ext4" path="/home/guilhermesgb/Desktop/SharedFolder"
&gt; mount_tag="SharingName" security_model="passthrough" /&gt;

Where did you find this? This is not libvirt XML.
&gt;

I found it searching through Google:
http://www.mail-archive.com/libvir-list@redhat.com/msg27808.html - altough I
just used it as a last resort, as anything else would work.

We have chosen to use libvirt in order to deal, in a generalized way, with
the
process of starting virtual machines, stopping them, executing remote
commands and creating shared folders.
As we saw that libvirt cannot handle with executing remote commands without
any manual configuration by us (setting up consoles, through ssh, etc.), we
will basically use a shared folder to store scripts that are to be executed
by the guest, and the guest would have a running daemon that monitors this
shared folder and executes everything in it.

Do you know how could I share a folder with a VBox guest through actual
Libvirt code?
We are also trying to do this through the Java binding, but it won't work
either. As you said, it's not supported yet.
We will eventually have to do this for all other hypervisors supported by
Libvirt, so I'd like to know: which hypervisors have this shared folder
funcionality supported by Libvirt?

We are very thankful for your answers and willing to see new feature in the
next version!

2011/6/7 Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;

&gt; 2011/6/6 Guilherme Santos &lt;guisgb13@gmail.com&gt;:
&gt; &gt; Well, I am still with that problem, attempting to create shared folders,
&gt; so
&gt; &gt; I will try to be more specific and then maybe somebody can help me.
&gt;
&gt;  Your problem is simple, libvirt currently doesn't support shared
&gt; folder for VirtualBox. I'll have a look at it and if it's simple to
&gt; implement you might see it in libvirt 0.9.3.
&gt;
&gt;
&gt;
 &gt; When I say "I am trying to set up shared folders", I mean that I set this
&gt; &gt; configuration in my XML description:
&gt; &gt;
&gt; &gt;     &lt;filesystem type='template' accessmode='mapped'&gt;
&gt; &gt;       &lt;source name='/home/guilhermesgb/Desktop/SharedFolder/&gt;
&gt; &gt;       &lt;target dir='/home/tarciso/Desktop/SharedFolder'/&gt;
&gt; &gt;     &lt;/filesystem&gt;
&gt;
&gt; VirtualBox shared folders don't support setting an access mode. The
&gt; target dir will map to the name of the shared folder in the guest.
&gt; Also the template type is OpenVZ specific. A shared folder will
&gt; probably just map to this XML snippet:
&gt;
&gt; &lt;filesystem type='mount'&gt;
&gt;  &lt;source dir='/home/guilhermesgb/Desktop/SharedFolder'/&gt;
&gt;  &lt;target dir='myshare1'/&gt;
&gt; &lt;/filesystem&gt;
&gt;
&gt; You might also specify the &lt;readonly/&gt; option.
&gt;
&gt; &gt; This was my last attempt. I also tried all other combinations, with
&gt; &gt; accessmodes "passthrough" and "squash", for filesystem type "mount" too.
&gt; &gt;
&gt; &gt; I can't send you any error messages neither printscreens because my
&gt; problem
&gt; &gt; is that anything happens, the domain is started properly but no shared
&gt; &gt; folder is specified so I can mount it, using command "sudo mount -t
&gt; vboxsf
&gt; &gt; SharedFolder /home/tarciso/Desktop/SharedFolder". I always get a protocol
&gt; &gt; error.
&gt; &gt;
&gt; &gt; I was expecting libvirt to automatically do this step for me, so I
&gt; wouldn't
&gt; &gt; need to do it manually through vbox GUI or VBoxManage.
&gt;
&gt; As I said libvirt just doesn't support this yet, but I'll look at it.
&gt;
&gt; &gt; During my searches through the web, I found this other option, although I
&gt; &gt; can't be sure if it is implemented, as the libvirt website says nothing
&gt; &gt; about it: defining an XML file with this configuration:
&gt; &gt;
&gt; &gt;     &lt;shareddir fstype="ext4"
&gt; path="/home/guilhermesgb/Desktop/SharedFolder"
&gt; &gt; mount_tag="SharingName" security_model="passthrough" /&gt;
&gt;
&gt; Where did you find this? This is not libvirt XML.
&gt;
&gt; &gt; And then mounting it with proper command (the same as before, now with
&gt; the
&gt; &gt; mount_tag specified: "sudo mount -t vboxsf SharingName
&gt; &gt; /home/tarciso/Desktop/SharedFolder" . Unfortunatelly the same error
&gt; &gt; persists.
&gt; &gt;
&gt; &gt; Am I missing something?
&gt;
&gt; No, it is exactly as expected, but it'll improve.
&gt;
&gt; Matthias
&gt;
&gt; &gt; Sorry if my first message was hard to understand. Thanks.
&gt; &gt;
&gt; &gt; 2011/6/1 Guilherme Santos &lt;guisgb13@gmail.com&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; Good afternoon.
&gt; &gt;&gt;
&gt; &gt;&gt; I am having trouble trying to set up shared folders in the guest VM
&gt; using
&gt; &gt;&gt; VirtualBox hypervisor. No matter what configuration is defined in my
&gt; XML, it
&gt; &gt;&gt; never works, I mean, no shared folder is added/specifyed, then, inside
&gt; the
&gt; &gt;&gt; guest, when I try to mount the folder, I always get a protocol error.
&gt; &gt;&gt;
&gt; &gt;&gt; If I use VirtualBoxManage, I can add/specify shared folders easily and
&gt; &gt;&gt; mount it with no problem.
&gt; &gt;&gt;
&gt; &gt;&gt; I need to use libvirt in order to deal, in a generalized way, with the
&gt; &gt;&gt; process of creating shared folders in all hypervisors supported by
&gt; libvirt,
&gt; &gt;&gt; otherwise my problem would be solved already. I must not use specific
&gt; &gt;&gt; commands of a certain hypervisor (such as VirtualBoxManage's).
&gt; &gt;&gt;
&gt; &gt;&gt; How does libvirt allow me to set up shared folders? Does it use
&gt; &gt;&gt; VirtualBoxManage for VBox hypervisors? If so, how do I use it?
&gt; &gt;&gt; I've read the documentation and followed it in defining my XMLs.
&gt; &gt;&gt;
&gt; &gt;&gt; Thanks anyway!
&gt; &gt;&gt; --
&gt; &gt;&gt; Guilherme Santos G. Baptista
&gt; &gt;&gt; Undergraduate in Computer Science at UFCG
&gt; &gt;&gt; LSD - Distributed Systems Laboratory
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; --
&gt; &gt; Guilherme Santos G. Baptista
&gt; &gt; Graduando em Ciência da Computação pela UFCG
&gt; &gt; LSD - Laboratório de Sistemas Distribuídos
&gt; &gt;
&gt; &gt; _______________________________________________
&gt; &gt; libvirt-users mailing list
&gt; &gt; libvirt-users@redhat.com
&gt; &gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; &gt;
&gt;



-- 
Guilherme Santos G. Baptista
Graduando em Ciência da Computação pela UFCG
LSD - Laboratório de Sistemas Distribuídos

[Attachment #3 (text/html)]

&lt;div class="gmail_quote"&gt;&lt;blockquote style="margin: 0pt 0pt 0pt 0.8ex; border-left: \
1px solid rgb(204, 204, 204); padding-left: 1ex;" class="gmail_quote"&gt;&lt;div&gt;A shared \
folder will&lt;br&gt; probably just map to this XML snippet:  \
&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px \
solid rgb(204, 204, 204); padding-left: 1ex;" class="gmail_quote"&gt;&lt;filesystem \
type='mount'&gt;&lt;br&gt;

  &lt;source dir='/home/guilhermesgb/Desktop/SharedFolder'/&gt; \
&lt;/blockquote&gt;&lt;blockquote style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid \
rgb(204, 204, 204); padding-left: 1ex;" class="gmail_quote"&gt;  &lt;target \
dir='myshare1'/&gt; &lt;/blockquote&gt;

&lt;blockquote style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, 204, \
204); padding-left: 1ex;" class="gmail_quote"&gt;&lt;/filesystem&gt;&lt;/blockquote&gt;&lt;br&gt;I \
see. I also tried this XML configuration you gave as an example, but it wouldn't \
work. And now I know why...&lt;br&gt;

&lt;br&gt;&lt;blockquote style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, \
204, 204); padding-left: 1ex;" class="gmail_quote"&gt;&lt;shareddir \
fstype="ext4"  path="/home/guilhermesgb/Desktop/SharedFolder" \
mount_tag="SharingName"  security_model="passthrough" \
/&gt;&lt;/blockquote&gt;&lt;blockquote style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px \
solid rgb(204, 204, 204); padding-left: 1ex;" class="gmail_quote"&gt;Where did you find \
this? This is not libvirt XML.&lt;br&gt;

&lt;/blockquote&gt;&lt;br&gt;I found it searching through Google: &lt;a \
href="http://www.mail-archive.com/libvir-list@redhat.com/msg27808.html"&gt;http://www.mail-archive.com/libvir-list@redhat.com/msg27808.html&lt;/a&gt; \
- altough I just used it as a last resort, as anything else would work.&lt;br&gt;

&lt;br&gt;We have chosen to use libvirt in order to deal, in a generalized way, with \
the&lt;br&gt;process of starting virtual machines, stopping them, executing remote commands \
and creating shared folders.&lt;br&gt;As we saw that libvirt cannot handle with executing \
remote commands without any manual configuration by us (setting up consoles, through \
ssh, etc.), we will basically use a shared folder to store scripts that are to be \
executed by the guest, and the guest would have a running daemon that monitors this \
shared folder and executes everything in it.&lt;br&gt;

&lt;br&gt;Do you know how could I share a folder with a VBox guest through actual Libvirt \
code?&lt;br&gt;We are also trying to do this through the Java binding, but it won't \
work either. As you said, it's not supported yet.&lt;br&gt;

We will eventually have to do this for all other hypervisors supported by Libvirt, so \
I'd like to know: which hypervisors have this shared folder funcionality \
supported by Libvirt?&lt;br&gt;&lt;br&gt;We are very thankful for your answers and willing to see \
new feature in the next version!&lt;br&gt;

&lt;br&gt;2011/6/7 Matthias Bolte &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, \
204, 204); padding-left: 1ex;"&gt;

2011/6/6 Guilherme Santos &lt;&lt;a \
href="mailto:guisgb13@gmail.com"&gt;guisgb13@gmail.com&lt;/a&gt;&gt;:&lt;br&gt; &lt;div&gt;&gt; Well, I am \
still with that problem, attempting to create shared folders, so&lt;br&gt; &gt; I will try \
to be more specific and then maybe somebody can help me.&lt;br&gt; \
&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt \
0.8ex; border-left: 1px solid rgb(204, 204, 204); padding-left: 1ex;"&gt;

&lt;div class="im"&gt;
&lt;/div&gt;Your problem is simple, libvirt currently doesn't support shared&lt;br&gt;
folder for VirtualBox. I'll have a look at it and if it's simple to&lt;br&gt;
implement you might see it in libvirt 0.9.3.&lt;br&gt;
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin: \
0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, 204, 204); padding-left: \
1ex;"&gt;&lt;div&gt; &lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote class="gmail_quote" style="margin: 0pt 0pt \
0pt 0.8ex; border-left: 1px solid rgb(204, 204, 204); padding-left: 1ex;"&gt;

&lt;div class="im"&gt;
&gt; When I say "I am trying to set up shared folders", I mean that I set \
this&lt;br&gt; &gt; configuration in my XML description:&lt;br&gt;
&gt;&lt;br&gt;
&gt;     &lt;filesystem type='template' accessmode='mapped'&gt;&lt;br&gt;
&gt;       &lt;source name='/home/guilhermesgb/Desktop/SharedFolder/&gt;&lt;br&gt;
&gt;       &lt;target dir='/home/tarciso/Desktop/SharedFolder'/&gt;&lt;br&gt;
&gt;     &lt;/filesystem&gt;&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;VirtualBox shared folders don't support setting an access mode. The&lt;br&gt;
target dir will map to the name of the shared folder in the guest.&lt;br&gt;
Also the template type is OpenVZ specific. A shared folder will&lt;br&gt;
probably just map to this XML snippet:&lt;br&gt;
&lt;br&gt;
&lt;filesystem type='mount'&gt;&lt;br&gt;
  &lt;source dir='/home/guilhermesgb/Desktop/SharedFolder'/&gt;&lt;br&gt;
  &lt;target dir='myshare1'/&gt;&lt;br&gt;
&lt;/filesystem&gt;&lt;br&gt;
&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin: 0pt 0pt \
0pt 0.8ex; border-left: 1px solid rgb(204, 204, 204); padding-left: 1ex;"&gt; You might \
also specify the &lt;readonly/&gt; option.&lt;br&gt; &lt;div class="im"&gt;&lt;br&gt;
&gt; This was my last attempt. I also tried all other combinations, with&lt;br&gt;
&gt; accessmodes "passthrough" and "squash", for filesystem type \
"mount" too.&lt;br&gt; &gt;&lt;br&gt;
&gt; I can't send you any error messages neither printscreens because my \
problem&lt;br&gt; &gt; is that anything happens, the domain is started properly but no \
shared&lt;br&gt; &gt; folder is specified so I can mount it, using command "sudo mount \
-t vboxsf&lt;br&gt; &gt; SharedFolder /home/tarciso/Desktop/SharedFolder". I always \
get a protocol&lt;br&gt; &gt; error.&lt;br&gt;
&gt;&lt;br&gt;
&gt; I was expecting libvirt to automatically do this step for me, so I \
wouldn't&lt;br&gt; &gt; need to do it manually through vbox GUI or VBoxManage.&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;As I said libvirt just doesn't support this yet, but I'll look at \
it.&lt;br&gt; &lt;div class="im"&gt;&lt;br&gt;
&gt; During my searches through the web, I found this other option, although I&lt;br&gt;
&gt; can't be sure if it is implemented, as the libvirt website says nothing&lt;br&gt;
&gt; about it: defining an XML file with this configuration:&lt;br&gt;
&gt;&lt;br&gt;
&gt;     &lt;shareddir fstype="ext4" \
path="/home/guilhermesgb/Desktop/SharedFolder"&lt;br&gt; &gt; \
mount_tag="SharingName" security_model="passthrough" /&gt;&lt;br&gt; \
&lt;br&gt; &lt;/div&gt;Where did you find this? This is not libvirt XML.&lt;br&gt;
&lt;div class="im"&gt;&lt;br&gt;
&gt; And then mounting it with proper command (the same as before, now with the&lt;br&gt;
&gt; mount_tag specified: "sudo mount -t vboxsf SharingName&lt;br&gt;
&gt; /home/tarciso/Desktop/SharedFolder" . Unfortunatelly the same error&lt;br&gt;
&gt; persists.&lt;br&gt;
&gt;&lt;br&gt;
&gt; Am I missing something?&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;No, it is exactly as expected, but it'll improve.&lt;br&gt;
&lt;font color="#888888"&gt;&lt;br&gt;
Matthias&lt;br&gt;
&lt;/font&gt;&lt;div class="im"&gt;&lt;br&gt;
&gt; Sorry if my first message was hard to understand. Thanks.&lt;br&gt;
&gt;&lt;br&gt;
&gt; 2011/6/1 Guilherme Santos &lt;&lt;a \
href="mailto:guisgb13@gmail.com"&gt;guisgb13@gmail.com&lt;/a&gt;&gt;&lt;br&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; Good afternoon.&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; I am having trouble trying to set up shared folders in the guest VM \
using&lt;br&gt; &gt;&gt; VirtualBox hypervisor. No matter what configuration is defined in \
my XML, it&lt;br&gt; &gt;&gt; never works, I mean, no shared folder is added/specifyed, \
then, inside the&lt;br&gt; &gt;&gt; guest, when I try to mount the folder, I always get a \
protocol error.&lt;br&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; If I use VirtualBoxManage, I can add/specify shared folders easily and&lt;br&gt;
&gt;&gt; mount it with no problem.&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; I need to use libvirt in order to deal, in a generalized way, with the&lt;br&gt;
&gt;&gt; process of creating shared folders in all hypervisors supported by \
libvirt,&lt;br&gt; &gt;&gt; otherwise my problem would be solved already. I must not use \
specific&lt;br&gt; &gt;&gt; commands of a certain hypervisor (such as \
VirtualBoxManage's).&lt;br&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; How does libvirt allow me to set up shared folders? Does it use&lt;br&gt;
&gt;&gt; VirtualBoxManage for VBox hypervisors? If so, how do I use it?&lt;br&gt;
&gt;&gt; I've read the documentation and followed it in defining my XMLs.&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; Thanks anyway!&lt;br&gt;
&gt;&gt; --&lt;br&gt;
&gt;&gt; Guilherme Santos G. Baptista&lt;br&gt;
&gt;&gt; Undergraduate in Computer Science at UFCG&lt;br&gt;
&gt;&gt; LSD - Distributed Systems Laboratory&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt; --&lt;br&gt;
&gt; Guilherme Santos G. Baptista&lt;br&gt;
&gt; Graduando em Ciência da Computação pela UFCG&lt;br&gt;
&gt; LSD - Laboratório de Sistemas Distribuídos&lt;br&gt;
&gt;&lt;br&gt;
&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;&gt; \
_______________________________________________&lt;br&gt; &gt; libvirt-users mailing \
list&lt;br&gt; &gt; &lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
 &gt; &lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; \
&gt;&lt;br&gt; &lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;Guilherme \
Santos G. Baptista&lt;br&gt;Graduando em Ciência da Computação pela UFCG&lt;br&gt;LSD - \
Laboratório de Sistemas Distribuídos&lt;br&gt;



</body></email><email><emailId>20110607132055</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-06-07 13:20:55-0400</timestampReceived><subject>Re: [libvirt-users] Shared Folders</subject><body>

2011/6/7 Guilherme Santos &lt;guisgb13@gmail.com&gt;:
&gt;&gt; A shared folder will
&gt;&gt; probably just map to this XML snippet:
&gt;&gt;
&gt;&gt; &lt;filesystem type='mount'&gt;
&gt;&gt;   &lt;source dir='/home/guilhermesgb/Desktop/SharedFolder'/&gt;
&gt;&gt;
&gt;&gt;   &lt;target dir='myshare1'/&gt;
&gt;&gt;
&gt;&gt; &lt;/filesystem&gt;
&gt;
&gt; I see. I also tried this XML configuration you gave as an example, but it
&gt; wouldn't work. And now I know why...
&gt;
&gt;&gt; &lt;shareddir fstype="ext4" path="/home/guilhermesgb/Desktop/SharedFolder"
&gt;&gt; mount_tag="SharingName" security_model="passthrough" /&gt;
&gt;&gt;
&gt;&gt; Where did you find this? This is not libvirt XML.
&gt;
&gt; I found it searching through Google:
&gt; http://www.mail-archive.com/libvir-list@redhat.com/msg27808.html - altough I
&gt; just used it as a last resort, as anything else would work.

Ah, that was just some idea that never got implemented.

&gt; We have chosen to use libvirt in order to deal, in a generalized way, with
&gt; the
&gt; process of starting virtual machines, stopping them, executing remote
&gt; commands and creating shared folders.
&gt; As we saw that libvirt cannot handle with executing remote commands without
&gt; any manual configuration by us (setting up consoles, through ssh, etc.), we
&gt; will basically use a shared folder to store scripts that are to be executed
&gt; by the guest, and the guest would have a running daemon that monitors this
&gt; shared folder and executes everything in it.
&gt;
&gt; Do you know how could I share a folder with a VBox guest through actual
&gt; Libvirt code?

Oh, I missed to CC you on this patch:

https://www.redhat.com/archives/libvir-list/2011-June/msg00315.html

That makes libvirt support VirtualBox shared folders.

&gt; We are also trying to do this through the Java binding, but it won't work
&gt; either. As you said, it's not supported yet.
&gt; We will eventually have to do this for all other hypervisors supported by
&gt; Libvirt, so I'd like to know: which hypervisors have this shared folder
&gt; funcionality supported by Libvirt?

The &lt;filesystem&gt; element is supported for Qemu and also for LXC and
OpenVZ judging by the codebase.

Matthias

&gt; We are very thankful for your answers and willing to see new feature in the
&gt; next version!
&gt;
&gt; 2011/6/7 Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;
&gt;&gt;
&gt;&gt; 2011/6/6 Guilherme Santos &lt;guisgb13@gmail.com&gt;:
&gt;&gt; &gt; Well, I am still with that problem, attempting to create shared folders,
&gt;&gt; &gt; so
&gt;&gt; &gt; I will try to be more specific and then maybe somebody can help me.
&gt;&gt;
&gt;&gt; Your problem is simple, libvirt currently doesn't support shared
&gt;&gt; folder for VirtualBox. I'll have a look at it and if it's simple to
&gt;&gt; implement you might see it in libvirt 0.9.3.
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; &gt; When I say "I am trying to set up shared folders", I mean that I set
&gt;&gt; &gt; this
&gt;&gt; &gt; configuration in my XML description:
&gt;&gt; &gt;
&gt;&gt; &gt;     &lt;filesystem type='template' accessmode='mapped'&gt;
&gt;&gt; &gt;       &lt;source name='/home/guilhermesgb/Desktop/SharedFolder/&gt;
&gt;&gt; &gt;       &lt;target dir='/home/tarciso/Desktop/SharedFolder'/&gt;
&gt;&gt; &gt;     &lt;/filesystem&gt;
&gt;&gt;
&gt;&gt; VirtualBox shared folders don't support setting an access mode. The
&gt;&gt; target dir will map to the name of the shared folder in the guest.
&gt;&gt; Also the template type is OpenVZ specific. A shared folder will
&gt;&gt; probably just map to this XML snippet:
&gt;&gt;
&gt;&gt; &lt;filesystem type='mount'&gt;
&gt;&gt;  &lt;source dir='/home/guilhermesgb/Desktop/SharedFolder'/&gt;
&gt;&gt;  &lt;target dir='myshare1'/&gt;
&gt;&gt; &lt;/filesystem&gt;
&gt;&gt;
&gt;&gt; You might also specify the &lt;readonly/&gt; option.
&gt;&gt;
&gt;&gt; &gt; This was my last attempt. I also tried all other combinations, with
&gt;&gt; &gt; accessmodes "passthrough" and "squash", for filesystem type "mount" too.
&gt;&gt; &gt;
&gt;&gt; &gt; I can't send you any error messages neither printscreens because my
&gt;&gt; &gt; problem
&gt;&gt; &gt; is that anything happens, the domain is started properly but no shared
&gt;&gt; &gt; folder is specified so I can mount it, using command "sudo mount -t
&gt;&gt; &gt; vboxsf
&gt;&gt; &gt; SharedFolder /home/tarciso/Desktop/SharedFolder". I always get a
&gt;&gt; &gt; protocol
&gt;&gt; &gt; error.
&gt;&gt; &gt;
&gt;&gt; &gt; I was expecting libvirt to automatically do this step for me, so I
&gt;&gt; &gt; wouldn't
&gt;&gt; &gt; need to do it manually through vbox GUI or VBoxManage.
&gt;&gt;
&gt;&gt; As I said libvirt just doesn't support this yet, but I'll look at it.
&gt;&gt;
&gt;&gt; &gt; During my searches through the web, I found this other option, although
&gt;&gt; &gt; I
&gt;&gt; &gt; can't be sure if it is implemented, as the libvirt website says nothing
&gt;&gt; &gt; about it: defining an XML file with this configuration:
&gt;&gt; &gt;
&gt;&gt; &gt;     &lt;shareddir fstype="ext4"
&gt;&gt; &gt; path="/home/guilhermesgb/Desktop/SharedFolder"
&gt;&gt; &gt; mount_tag="SharingName" security_model="passthrough" /&gt;
&gt;&gt;
&gt;&gt; Where did you find this? This is not libvirt XML.
&gt;&gt;
&gt;&gt; &gt; And then mounting it with proper command (the same as before, now with
&gt;&gt; &gt; the
&gt;&gt; &gt; mount_tag specified: "sudo mount -t vboxsf SharingName
&gt;&gt; &gt; /home/tarciso/Desktop/SharedFolder" . Unfortunatelly the same error
&gt;&gt; &gt; persists.
&gt;&gt; &gt;
&gt;&gt; &gt; Am I missing something?
&gt;&gt;
&gt;&gt; No, it is exactly as expected, but it'll improve.
&gt;&gt;
&gt;&gt; Matthias
&gt;&gt;
&gt;&gt; &gt; Sorry if my first message was hard to understand. Thanks.
&gt;&gt; &gt;
&gt;&gt; &gt; 2011/6/1 Guilherme Santos &lt;guisgb13@gmail.com&gt;
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Good afternoon.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; I am having trouble trying to set up shared folders in the guest VM
&gt;&gt; &gt;&gt; using
&gt;&gt; &gt;&gt; VirtualBox hypervisor. No matter what configuration is defined in my
&gt;&gt; &gt;&gt; XML, it
&gt;&gt; &gt;&gt; never works, I mean, no shared folder is added/specifyed, then, inside
&gt;&gt; &gt;&gt; the
&gt;&gt; &gt;&gt; guest, when I try to mount the folder, I always get a protocol error.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; If I use VirtualBoxManage, I can add/specify shared folders easily and
&gt;&gt; &gt;&gt; mount it with no problem.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; I need to use libvirt in order to deal, in a generalized way, with the
&gt;&gt; &gt;&gt; process of creating shared folders in all hypervisors supported by
&gt;&gt; &gt;&gt; libvirt,
&gt;&gt; &gt;&gt; otherwise my problem would be solved already. I must not use specific
&gt;&gt; &gt;&gt; commands of a certain hypervisor (such as VirtualBoxManage's).
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; How does libvirt allow me to set up shared folders? Does it use
&gt;&gt; &gt;&gt; VirtualBoxManage for VBox hypervisors? If so, how do I use it?
&gt;&gt; &gt;&gt; I've read the documentation and followed it in defining my XMLs.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Thanks anyway!
&gt;&gt; &gt;&gt; --
&gt;&gt; &gt;&gt; Guilherme Santos G. Baptista
&gt;&gt; &gt;&gt; Undergraduate in Computer Science at UFCG
&gt;&gt; &gt;&gt; LSD - Distributed Systems Laboratory
&gt;&gt; &gt;
&gt;&gt; &gt;
&gt;&gt; &gt;
&gt;&gt; &gt; --
&gt;&gt; &gt; Guilherme Santos G. Baptista
&gt;&gt; &gt; Graduando em Ciência da Computação pela UFCG
&gt;&gt; &gt; LSD - Laboratório de Sistemas Distribuídos
&gt;&gt; &gt;
&gt;&gt; &gt; _______________________________________________
&gt;&gt; &gt; libvirt-users mailing list
&gt;&gt; &gt; libvirt-users@redhat.com
&gt;&gt; &gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;&gt; &gt;
&gt;
&gt;
&gt;
&gt; --
&gt; Guilherme Santos G. Baptista
&gt; Graduando em Ciência da Computação pela UFCG
&gt; LSD - Laboratório de Sistemas Distribuídos
&gt;

</body></email><email><emailId>20110608132819</emailId><senderName>m m</senderName><senderEmail>bk.praca@gmail.com</senderEmail><timestampReceived>2011-06-08 13:28:19-0400</timestampReceived><subject>Re: [libvirt-users] libvirt-users Digest, Vol 18, Issue 7(libvirt-bin MOSTLY fails to create default</subject><body>

[Attachment #2 (multipart/alternative)]


I have attached all the logs (/var/log/dmesg, /var/log/libvirtd.log,
/var/log/messages, /var/log/syslog, /var/log/boot.log and info about loaded
modules /proc/modules) regarding scenatios1,2,3 (please see the README file
for simple explanation what is there). By the way, I have installed only
dnsmasq-bin (and not dnsmasq).
Have a nice day

2011/6/6 &lt;libvirt-users-request@redhat.com&gt;

&gt; Send libvirt-users mailing list submissions to
&gt;        libvirt-users@redhat.com
&gt;
&gt; To subscribe or unsubscribe via the World Wide Web, visit
&gt;        https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; or, via email, send a message with subject or body 'help' to
&gt;        libvirt-users-request@redhat.com
&gt;
&gt; You can reach the person managing the list at
&gt;        libvirt-users-owner@redhat.com
&gt;
&gt; When replying, please edit your Subject line so it is more specific
&gt; than "Re: Contents of libvirt-users digest..."
&gt;
&gt;
&gt; Today's Topics:
&gt;
&gt;   1. libvirt-bin MOSTLY fails to create default virtual        network (m
&gt; m)
&gt;
&gt;
&gt; ----------------------------------------------------------------------
&gt;
&gt; Message: 1
&gt; Date: Mon, 6 Jun 2011 14:24:04 -0500
&gt; From: m m &lt;bk.praca@gmail.com&gt;
&gt; To: libvirt-users@redhat.com
&gt; Subject: [libvirt-users] libvirt-bin MOSTLY fails to create default
&gt;        virtual network
&gt; Message-ID: &lt;BANLkTinrE80HURSwJUUv28_v9HB9mRxNNw@mail.gmail.com&gt;
&gt; Content-Type: text/plain; charset="iso-8859-1"
&gt;
&gt; I have observed 3 scenarios after I reboot the host with 2 guests (which
&gt; are
&gt; supposed to autostart after boot/reboot of the host):
&gt; 1. Default network is created but I can not ping guests. Gests don't have
&gt; assigned IP address or they both have IP address 192.168.122.100.
&gt; 2. Default network is not created.
&gt; 3. Default netork is properly created and everything works fine.
&gt; In each case guests are started and they work properly. Cases 1. and 2.
&gt; happen a lot more often then case 3.
&gt;
&gt; My solutions:
&gt; - When I restart libvirt-bin then everything is fine.
&gt; - When I set 'sleep 40' in 'pre-start' section of
&gt; /etc/init/libvirt-bin.conf
&gt; and modify 'start on' section in the following way:
&gt;
&gt; start on (runlevel [2345] and net-device-up IFACE=br0)
&gt;
&gt; then everything works fine.
&gt;
&gt;
&gt; However, none of the above solutions indeed solves the problem. Please, let
&gt; me know if there is solution to this problem or what are your suggestions
&gt; regarding this issue.
&gt;
&gt; ****
&gt; HOST$ uname -a
&gt; Linux ras 2.6.32-32-server #62-Ubuntu SMP Wed Apr 20 22:07:43 UTC 2011
&gt; x86_64 GNU/Linux
&gt;
&gt; GUEST1 and GUEST2
&gt; $ uname -a
&gt; Linux server1-desktop 2.6.32-32-generic #62-Ubuntu SMP Wed Apr 20 21:54:21
&gt; UTC 2011 i686 GNU/Linux
&gt;
&gt; HOST$ libvirtd --version
&gt; libvirtd (libvirt) 0.7.5
&gt;
&gt; My idea was that some kernel modules sometimes are loaded before
&gt; libvirt-bin
&gt; starts, and sometimes libvirt-bin starts earlier, or in the middle of
&gt; loading of these modules, that is why 3 scenarios can be observed.
&gt; That is why I have added:
&gt;  cp /proc/modules /home/wsadmin2/modules1
&gt;  cp /proc/modules /home/wsadmin2/modules2
&gt; to 'pre-start' and 'post-start' parts respectively of
&gt; /etc/init/libvirt-bin.conf.
&gt;
&gt; Of course, beween execution of
&gt; - pre-start part
&gt; - exec /usr/sbin/libvirtd -d
&gt; - post-start part
&gt; other kernel modules can be loaded, so we can not be sure which additional
&gt; modules in file 'modules2' were indeed loaded before libvirtd was actually
&gt; started.
&gt;
&gt; Here are my observations:
&gt; Scenatio 1.
&gt; 33 (fixed) modules were logged - call them BASE MODULES.
&gt;
&gt; Scenatio 2.
&gt; Beside BASE MODULES + the following modules were loaded:
&gt;
&gt; &gt; iptable_filter 1841 0 - Live 0xffffffffa007c000
&gt; &gt; ip_tables 18201 1 iptable_filter, Live 0xffffffffa0172000
&gt; &gt; x_tables 22361 1 ip_tables, Live 0xffffffffa0164000
&gt;
&gt; Scenatio 3.
&gt; Beside BASE MODULES + the following modules were loaded:
&gt;
&gt; $ diff modules1 modules2
&gt; 1c1,6
&gt; &lt; iptable_filter 1841 0 - Live 0xffffffffa008b000
&gt; ---
&gt; &gt; xt_state 1490 14 - Live 0xffffffffa01ab000
&gt; &gt; xt_tcpudp 2667 12 - Live 0xffffffffa01a5000
&gt; &gt; nf_conntrack_ipv4 12742 14 - Live 0xffffffffa019b000
&gt; &gt; nf_conntrack 73326 2 xt_state,nf_conntrack_ipv4, Live 0xffffffffa017d000
&gt; &gt; nf_defrag_ipv4 1481 1 nf_conntrack_ipv4, Live 0xffffffffa0177000
&gt; &gt; iptable_filter 1841 1 - Live 0xffffffffa008b000
&gt; 3c8
&gt; &lt; x_tables 22361 1 ip_tables, Live 0xffffffffa0162000
&gt; ---
&gt; &gt; x_tables 22361 3 xt_state,xt_tcpudp,ip_tables, Live 0xffffffffa0162000
&gt;
&gt; Other observations:
&gt; Scenatio 1.
&gt; No errors in libvirtd.log
&gt; Scenario 2.
&gt;
&gt; 10:06:06.980: error : networkAddIptablesRules:750 : failed to add iptables
&gt; rule to allow DHCP requests from 'virbr0': Invalid argument
&gt; (...)
&gt; 10:06:08.630: error : qemudNetworkIfaceConnect:1445 : Failed to add tap
&gt; interface to bridge 'virbr0': No such device
&gt; 10:06:08.630: error : qemuAutostartDomain:584 : Failed to autostart VM
&gt; 'cluster_server1': Failed to add tap interface to bridge 'virbr0': No such
&gt; device
&gt;
&gt; 10:06:08.921: info : qemudDispatchSignalEvent:390 : Received unexpected
&gt; signal 17
&gt; 10:06:08.927: debug : virExecWithHook:617 : LC_ALL=C /usr/bin/kvm -help
&gt; 10:06:08.938: info : qemudDispatchSignalEvent:390 : Received unexpected
&gt; signal 17
&gt; 10:06:09.000: error : qemudNetworkIfaceConnect:1445 : Failed to add tap
&gt; interface to bridge 'virbr0': No such device
&gt; 10:06:09.000: error : qemuAutostartDomain:584 : Failed to autostart VM
&gt; 'cluster_server2': Failed to add tap interface to bridge 'virbr0': No such
&gt; device
&gt; (...)
&gt; Scenatio 3.
&gt; No errors in libvirtd.log
&gt;
&gt;
&gt; I didn't see any valuable logs in /var/log/boot.log, /var/log/messages,
&gt; /var/log/syslog. Please let me know if you want to see them anyway or have
&gt; any suggestions right away.
&gt; -------------- next part --------------
&gt; An HTML attachment was scrubbed...
&gt; URL: &lt;
&gt; https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment.html
&gt; &gt;
&gt; -------------- next part --------------
&gt; A non-text attachment was scrubbed...
&gt; Name: scenario1
&gt; Type: application/octet-stream
&gt; Size: 19317 bytes
&gt; Desc: not available
&gt; URL: &lt;
&gt; https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment.obj
&gt; &gt;
&gt; -------------- next part --------------
&gt; A non-text attachment was scrubbed...
&gt; Name: scenario2
&gt; Type: application/octet-stream
&gt; Size: 8294 bytes
&gt; Desc: not available
&gt; URL: &lt;
&gt; https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment-0001.obj
&gt; &gt;
&gt; -------------- next part --------------
&gt; A non-text attachment was scrubbed...
&gt; Name: scenario3
&gt; Type: application/octet-stream
&gt; Size: 2366 bytes
&gt; Desc: not available
&gt; URL: &lt;
&gt; https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment-0002.obj
&gt; &gt;
&gt; -------------- next part --------------
&gt; A non-text attachment was scrubbed...
&gt; Name: libvirt-bin.conf
&gt; Type: application/octet-stream
&gt; Size: 924 bytes
&gt; Desc: not available
&gt; URL: &lt;
&gt; https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment-0003.obj
&gt; &gt;
&gt;
&gt; ------------------------------
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;
&gt; End of libvirt-users Digest, Vol 18, Issue 7
&gt; ********************************************
&gt;

[Attachment #5 (text/html)]

I have attached all the logs (/var/log/dmesg, /var/log/libvirtd.log, \
/var/log/messages, /var/log/syslog, /var/log/boot.log and info about loaded modules \
/proc/modules) regarding scenatios1,2,3 (please see the README file for simple \
explanation what is there). By the way, I have installed only dnsmasq-bin (and not \
dnsmasq).&lt;br&gt; Have a nice day&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;2011/6/6  &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:libvirt-users-request@redhat.com"&gt;libvirt-users-request@redhat.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, \
204, 204); padding-left: 1ex;"&gt; Send libvirt-users mailing list submissions to&lt;br&gt;
        &lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
&lt;br&gt;
To subscribe or unsubscribe via the World Wide Web, visit&lt;br&gt;
        &lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; or, via \
                email, send a message with subject or body 'help' to&lt;br&gt;
        &lt;a href="mailto:libvirt-users-request@redhat.com"&gt;libvirt-users-request@redhat.com&lt;/a&gt;&lt;br&gt;
 &lt;br&gt;
You can reach the person managing the list at&lt;br&gt;
        &lt;a href="mailto:libvirt-users-owner@redhat.com"&gt;libvirt-users-owner@redhat.com&lt;/a&gt;&lt;br&gt;
 &lt;br&gt;
When replying, please edit your Subject line so it is more specific&lt;br&gt;
than "Re: Contents of libvirt-users digest..."&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Today's Topics:&lt;br&gt;
&lt;br&gt;
   1. libvirt-bin MOSTLY fails to create default virtual        network (m m)&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
----------------------------------------------------------------------&lt;br&gt;
&lt;br&gt;
Message: 1&lt;br&gt;
Date: Mon, 6 Jun 2011 14:24:04 -0500&lt;br&gt;
From: m m &lt;&lt;a href="mailto:bk.praca@gmail.com"&gt;bk.praca@gmail.com&lt;/a&gt;&gt;&lt;br&gt;
To: &lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
Subject: [libvirt-users] libvirt-bin MOSTLY fails to create default&lt;br&gt;
        virtual network&lt;br&gt;
Message-ID: &lt;&lt;a href="mailto:BANLkTinrE80HURSwJUUv28_v9HB9mRxNNw@mail.gmail.com"&gt;BANLkTinrE80HURSwJUUv28_v9HB9mRxNNw@mail.gmail.com&lt;/a&gt;&gt;&lt;br&gt;
                
Content-Type: text/plain; charset="iso-8859-1"&lt;br&gt;
&lt;br&gt;
I have observed 3 scenarios after I reboot the host with 2 guests (which are&lt;br&gt;
supposed to autostart after boot/reboot of the host):&lt;br&gt;
1. Default network is created but I can not ping guests. Gests don't have&lt;br&gt;
assigned IP address or they both have IP address 192.168.122.100.&lt;br&gt;
2. Default network is not created.&lt;br&gt;
3. Default netork is properly created and everything works fine.&lt;br&gt;
In each case guests are started and they work properly. Cases 1. and 2.&lt;br&gt;
happen a lot more often then case 3.&lt;br&gt;
&lt;br&gt;
My solutions:&lt;br&gt;
- When I restart libvirt-bin then everything is fine.&lt;br&gt;
- When I set 'sleep 40' in 'pre-start' section of \
/etc/init/libvirt-bin.conf&lt;br&gt; and modify 'start on' section in the following \
way:&lt;br&gt; &lt;br&gt;
start on (runlevel [2345] and net-device-up IFACE=br0)&lt;br&gt;
&lt;br&gt;
then everything works fine.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
However, none of the above solutions indeed solves the problem. Please, let&lt;br&gt;
me know if there is solution to this problem or what are your suggestions&lt;br&gt;
regarding this issue.&lt;br&gt;
&lt;br&gt;
****&lt;br&gt;
HOST$ uname -a&lt;br&gt;
Linux ras 2.6.32-32-server #62-Ubuntu SMP Wed Apr 20 22:07:43 UTC 2011&lt;br&gt;
x86_64 GNU/Linux&lt;br&gt;
&lt;br&gt;
GUEST1 and GUEST2&lt;br&gt;
$ uname -a&lt;br&gt;
Linux server1-desktop 2.6.32-32-generic #62-Ubuntu SMP Wed Apr 20 21:54:21&lt;br&gt;
UTC 2011 i686 GNU/Linux&lt;br&gt;
&lt;br&gt;
HOST$ libvirtd --version&lt;br&gt;
libvirtd (libvirt) 0.7.5&lt;br&gt;
&lt;br&gt;
My idea was that some kernel modules sometimes are loaded before libvirt-bin&lt;br&gt;
starts, and sometimes libvirt-bin starts earlier, or in the middle of&lt;br&gt;
loading of these modules, that is why 3 scenarios can be observed.&lt;br&gt;
That is why I have added:&lt;br&gt;
 cp /proc/modules /home/wsadmin2/modules1&lt;br&gt;
 cp /proc/modules /home/wsadmin2/modules2&lt;br&gt;
to 'pre-start' and 'post-start' parts respectively of&lt;br&gt;
/etc/init/libvirt-bin.conf.&lt;br&gt;
&lt;br&gt;
Of course, beween execution of&lt;br&gt;
- pre-start part&lt;br&gt;
- exec /usr/sbin/libvirtd -d&lt;br&gt;
- post-start part&lt;br&gt;
other kernel modules can be loaded, so we can not be sure which additional&lt;br&gt;
modules in file 'modules2' were indeed loaded before libvirtd was \
actually&lt;br&gt; started.&lt;br&gt;
&lt;br&gt;
Here are my observations:&lt;br&gt;
Scenatio 1.&lt;br&gt;
33 (fixed) modules were logged - call them BASE MODULES.&lt;br&gt;
&lt;br&gt;
Scenatio 2.&lt;br&gt;
Beside BASE MODULES + the following modules were loaded:&lt;br&gt;
&lt;br&gt;
&gt; iptable_filter 1841 0 - Live 0xffffffffa007c000&lt;br&gt;
&gt; ip_tables 18201 1 iptable_filter, Live 0xffffffffa0172000&lt;br&gt;
&gt; x_tables 22361 1 ip_tables, Live 0xffffffffa0164000&lt;br&gt;
&lt;br&gt;
Scenatio 3.&lt;br&gt;
Beside BASE MODULES + the following modules were loaded:&lt;br&gt;
&lt;br&gt;
$ diff modules1 modules2&lt;br&gt;
1c1,6&lt;br&gt;
&lt; iptable_filter 1841 0 - Live 0xffffffffa008b000&lt;br&gt;
---&lt;br&gt;
&gt; xt_state 1490 14 - Live 0xffffffffa01ab000&lt;br&gt;
&gt; xt_tcpudp 2667 12 - Live 0xffffffffa01a5000&lt;br&gt;
&gt; nf_conntrack_ipv4 12742 14 - Live 0xffffffffa019b000&lt;br&gt;
&gt; nf_conntrack 73326 2 xt_state,nf_conntrack_ipv4, Live 0xffffffffa017d000&lt;br&gt;
&gt; nf_defrag_ipv4 1481 1 nf_conntrack_ipv4, Live 0xffffffffa0177000&lt;br&gt;
&gt; iptable_filter 1841 1 - Live 0xffffffffa008b000&lt;br&gt;
3c8&lt;br&gt;
&lt; x_tables 22361 1 ip_tables, Live 0xffffffffa0162000&lt;br&gt;
---&lt;br&gt;
&gt; x_tables 22361 3 xt_state,xt_tcpudp,ip_tables, Live 0xffffffffa0162000&lt;br&gt;
&lt;br&gt;
Other observations:&lt;br&gt;
Scenatio 1.&lt;br&gt;
No errors in libvirtd.log&lt;br&gt;
Scenario 2.&lt;br&gt;
&lt;br&gt;
10:06:06.980: error : networkAddIptablesRules:750 : failed to add iptables&lt;br&gt;
rule to allow DHCP requests from 'virbr0': Invalid argument&lt;br&gt;
(...)&lt;br&gt;
10:06:08.630: error : qemudNetworkIfaceConnect:1445 : Failed to add tap&lt;br&gt;
interface to bridge 'virbr0': No such device&lt;br&gt;
10:06:08.630: error : qemuAutostartDomain:584 : Failed to autostart VM&lt;br&gt;
'cluster_server1': Failed to add tap interface to bridge 'virbr0': No \
such&lt;br&gt; device&lt;br&gt;
&lt;br&gt;
10:06:08.921: info : qemudDispatchSignalEvent:390 : Received unexpected&lt;br&gt;
signal 17&lt;br&gt;
10:06:08.927: debug : virExecWithHook:617 : LC_ALL=C /usr/bin/kvm -help&lt;br&gt;
10:06:08.938: info : qemudDispatchSignalEvent:390 : Received unexpected&lt;br&gt;
signal 17&lt;br&gt;
10:06:09.000: error : qemudNetworkIfaceConnect:1445 : Failed to add tap&lt;br&gt;
interface to bridge 'virbr0': No such device&lt;br&gt;
10:06:09.000: error : qemuAutostartDomain:584 : Failed to autostart VM&lt;br&gt;
'cluster_server2': Failed to add tap interface to bridge 'virbr0': No \
such&lt;br&gt; device&lt;br&gt;
(...)&lt;br&gt;
Scenatio 3.&lt;br&gt;
No errors in libvirtd.log&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
I didn't see any valuable logs in /var/log/boot.log, /var/log/messages,&lt;br&gt;
/var/log/syslog. Please let me know if you want to see them anyway or have&lt;br&gt;
any suggestions right away.&lt;br&gt;
-------------- next part --------------&lt;br&gt;
An HTML attachment was scrubbed...&lt;br&gt;
URL: &lt;&lt;a href="https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment.html" \
target="_blank"&gt;https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment.html&lt;/a&gt;&gt;&lt;br&gt;


-------------- next part --------------&lt;br&gt;
A non-text attachment was scrubbed...&lt;br&gt;
Name: scenario1&lt;br&gt;
Type: application/octet-stream&lt;br&gt;
Size: 19317 bytes&lt;br&gt;
Desc: not available&lt;br&gt;
URL: &lt;&lt;a href="https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment.obj" \
target="_blank"&gt;https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment.obj&lt;/a&gt;&gt;&lt;br&gt;


-------------- next part --------------&lt;br&gt;
A non-text attachment was scrubbed...&lt;br&gt;
Name: scenario2&lt;br&gt;
Type: application/octet-stream&lt;br&gt;
Size: 8294 bytes&lt;br&gt;
Desc: not available&lt;br&gt;
URL: &lt;&lt;a href="https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment-0001.obj" \
target="_blank"&gt;https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment-0001.obj&lt;/a&gt;&gt;&lt;br&gt;


-------------- next part --------------&lt;br&gt;
A non-text attachment was scrubbed...&lt;br&gt;
Name: scenario3&lt;br&gt;
Type: application/octet-stream&lt;br&gt;
Size: 2366 bytes&lt;br&gt;
Desc: not available&lt;br&gt;
URL: &lt;&lt;a href="https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment-0002.obj" \
target="_blank"&gt;https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment-0002.obj&lt;/a&gt;&gt;&lt;br&gt;


-------------- next part --------------&lt;br&gt;
A non-text attachment was scrubbed...&lt;br&gt;
Name: libvirt-bin.conf&lt;br&gt;
Type: application/octet-stream&lt;br&gt;
Size: 924 bytes&lt;br&gt;
Desc: not available&lt;br&gt;
URL: &lt;&lt;a href="https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment-0003.obj" \
target="_blank"&gt;https://www.redhat.com/archives/libvirt-users/attachments/20110606/54a07ab3/attachment-0003.obj&lt;/a&gt;&gt;&lt;br&gt;


&lt;br&gt;
------------------------------&lt;br&gt;
&lt;br&gt;
_______________________________________________&lt;br&gt;
libvirt-users mailing list&lt;br&gt;
&lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
&lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; &lt;br&gt;
End of libvirt-users Digest, Vol 18, Issue 7&lt;br&gt;
********************************************&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;

--90e6ba6e8f7e728acb04a5334f16--


["LucidClusterStack.rar" (application/rar)]

</body></email><email><emailId>20110608144440</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2011-06-08 14:44:40-0400</timestampReceived><subject>[libvirt-users] ANNOUNCE: oz 0.4.0 release</subject><body>

All,
     I'm pleased to announce release 0.4.0 of Oz.  Oz is a program for doing
automated installation of guest operating systems with limited input from the
user.
     Release 0.4.0 is a bugfix and feature release for Oz.  Some of the
highlights between Oz 0.3.0 and 0.4.0 are:

- Automatic detection/use of cached JEOS images (the previous method required
the user of the oz libraries to detect whether the image was cached or not)
- Fixes to make Debian installs work for both x86_64 and i386
- Honor user-provided automatic installation files better, by not doing
modifications
- Use pyparted to generate partitions on newly created disks (if necessary)
- Add support for Fedora 15
- Add the ability to supply an initial root/Administrator password to the
diskimage
- Abort installs after 5 minutes of disk inactivity
- Use M2Crypto to generate SSH keys (if necessary)
- Some pydoc documentation (more of this to come in the future)
- Support for Ubuntu 11.04
- Support for RHEL-6.1

More documentation on Oz (including links on how to obtain it) is available
here: http://aeolusproject.org/oz.html

For this release, Fedora 14 and RHEL-6 packages are available.  Note that I
have stopped providing Fedora 13 packages, since that distribution is (or
will be) out of support.  Also note that to install the RHEL-6
packages, you must be running RHEL-6.1 or later.

If you have any questions or comments about Oz, please feel free to contact
aeolus-devel@lists.fedorahosted.org or me (clalance@redhat.com) directly.

Thanks,
-- 
Chris Lalancette

</body></email><email><emailId>20110609164617</emailId><senderName>"Stefan G. Weichinger"</senderName><senderEmail>lists@xunil.at</senderEmail><timestampReceived>2011-06-09 16:46:17-0400</timestampReceived><subject>Re: [libvirt-users] small webGUI?</subject><body>

Am 08.06.2011 10:03, schrieb Stefan G. Weichinger:

&gt; Unfortunately this VM does not start automatically with the host
&gt; although I checked the relevant box within virtual machine manager.
&gt; 
&gt; I assume upgrading libvirt might help (we run 0.8.7-r1 right now, gentoo
&gt; linux).

Upgrade to 0.9.2 seems to have solved the autostart-issue:

After the upgrade a restart of libvirtd started the VM as well.
Fine.

So now for that GUI-thing ...

Thanks, Stefan

</body></email><email><emailId>20110609184456</emailId><senderName>Tom Georgoulias</senderName><senderEmail>tomg@mcclatchyinteractive.com</senderEmail><timestampReceived>2011-06-09 18:44:56-0400</timestampReceived><subject>[libvirt-users] old, deleted LUN still showing up after a virsh pool-refresh</subject><body>

Today I upgraded one of our KVM physical host servers to Centos 5.6. 
The other server remains on Centos 5.5.  I've configured a storage pool 
in libvirt to use LUNs from an iscsi storage system as the volumes for 
each VM.

After the upgrade, I decommisioned one of the VMs and removed the LUN 
from the storage system.  Normally after this kind of operation, I 
simply need to run this command and the server will see that the LUN no 
longer exists and remove the volume.

# virsh pool-refresh --pool=dev-kvm-storage
Pool dev-kvm-storage refreshed

This works fine on the centos 5.5 host, but the centos 5.6 still lists 
the old lun in the vol-list and displays zeros for the capacity.

# virsh vol-info 7.0.0.26 --pool=dev-kvm-storage
Name:           7.0.0.26
Type:           block
Capacity:       0.00
Allocation:     0.00

Do I need to do something different now for the newer version of libvirt 
that is included with centos 5.6?

Here are the kernel and libvirt versions I'm using:

Centos 5.6:
kernel-2.6.18-238.9.1.el5
libvirt-0.8.2-15.el5_6.4

Centos 5.5:
kernel-2.6.18-194.26.1.el5
libvirt-0.6.3-33.el5_5.3

Any help is greatly appreciated.

</body></email><email><emailId>20110609193953</emailId><senderName>Guilherme Santos</senderName><senderEmail>guisgb13@gmail.com</senderEmail><timestampReceived>2011-06-09 19:39:53-0400</timestampReceived><subject>Re: [libvirt-users] Shared Folders</subject><body>

Good afternoon. I am sending this email because I had a problem while trying
to use your patch.

I was using libvirt version 0.8.5 before you send this patch. I upgraded it
to version 0.9.2, then I applied your patch.

I can see that libvirt properly communicated with VBox hypervisor and added
the shared folder but when I started it, my domain boots and initializes
until a certain point where, strangely, it restarts the VM again, and so
this process keeps repeating indefinitely. Maybe this is happening when the
domain tries to mount the shared folder.

I am using Ubuntu 10.04 and version 0.9.2 of libvirt. Before installing
version 9.04 I run command make uninstall and then downloaded 0.9.2's tar.gz
from the libvirt website. Once I wasn't sure if the problem was caused by
your patch, I tried to start a VM without libvirt (through VirtualBox OSE)
and it started using the same virtual disk with no problem. My libvirt
version went back to 0.9.0 and then, without patching, I tested it to see if
libvirt would start my domain properly, but the problem remained.

I repeated all the previous steps in another machine and this problem
happened there also, even after it went through the patching process.

With that in mind, we'd like to talk more with you about this shared folder
feature supported by Libvirt.
Me and my team are working on an open source project called Ourgrid, which
is a middleware for grid computing (http://www.ourgrid.org/).
We use virtual machines for remote sandboxed execution. Currently we support
VBox and VServer hypervisors. However, we want it to have an uniform
handling. That's when we found out that Libvirt seemed to handle many
virtualization hypervisors, and then we thought using Libvirt could be a
good idea.

We know that some hypervisors don't provide an easy way to send remote
commands to be executed by the domain, so we think that the most general way
to handle with all of them is using a shared folder and having a deamon
running in the previously configured domain that monitors this shared folder
that executes the scripts staged in the folder.

But as far as we know, the shared folder feature is not fully developed yet
for all hypervisors supported by Libvirt.

We are not very experienced in C programming, neither in Libvirt code, so
we'd like to know if this feature (for all, or most of all hypervisors
provided by libvirt) is expected in the Libvirt development agenda or is it
something out of its scope.

If this is out of your development agenda, we are very keen to try
implementing it, once this is a major issue for us.
Obviously, any help/suggestion would be appreciated.

Thanks.


2011/6/7 Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;

&gt; 2011/6/7 Guilherme Santos &lt;guisgb13@gmail.com&gt;:
&gt; &gt;&gt; A shared folder will
&gt; &gt;&gt; probably just map to this XML snippet:
&gt; &gt;&gt;
&gt; &gt;&gt; &lt;filesystem type='mount'&gt;
&gt; &gt;&gt;   &lt;source dir='/home/guilhermesgb/Desktop/SharedFolder'/&gt;
&gt; &gt;&gt;
&gt; &gt;&gt;   &lt;target dir='myshare1'/&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; &lt;/filesystem&gt;
&gt; &gt;
&gt; &gt; I see. I also tried this XML configuration you gave as an example, but it
&gt; &gt; wouldn't work. And now I know why...
&gt; &gt;
&gt; &gt;&gt; &lt;shareddir fstype="ext4" path="/home/guilhermesgb/Desktop/SharedFolder"
&gt; &gt;&gt; mount_tag="SharingName" security_model="passthrough" /&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; Where did you find this? This is not libvirt XML.
&gt; &gt;
&gt; &gt; I found it searching through Google:
&gt; &gt; http://www.mail-archive.com/libvir-list@redhat.com/msg27808.html -
&gt; altough I
&gt; &gt; just used it as a last resort, as anything else would work.
&gt;
&gt; Ah, that was just some idea that never got implemented.
&gt;
&gt; &gt; We have chosen to use libvirt in order to deal, in a generalized way,
&gt; with
&gt; &gt; the
&gt; &gt; process of starting virtual machines, stopping them, executing remote
&gt; &gt; commands and creating shared folders.
&gt; &gt; As we saw that libvirt cannot handle with executing remote commands
&gt; without
&gt; &gt; any manual configuration by us (setting up consoles, through ssh, etc.),
&gt; we
&gt; &gt; will basically use a shared folder to store scripts that are to be
&gt; executed
&gt; &gt; by the guest, and the guest would have a running daemon that monitors
&gt; this
&gt; &gt; shared folder and executes everything in it.
&gt; &gt;
&gt; &gt; Do you know how could I share a folder with a VBox guest through actual
&gt; &gt; Libvirt code?
&gt;
&gt; Oh, I missed to CC you on this patch:
&gt;
&gt; https://www.redhat.com/archives/libvir-list/2011-June/msg00315.html
&gt;
&gt; That makes libvirt support VirtualBox shared folders.
&gt;
&gt; &gt; We are also trying to do this through the Java binding, but it won't work
&gt; &gt; either. As you said, it's not supported yet.
&gt; &gt; We will eventually have to do this for all other hypervisors supported by
&gt; &gt; Libvirt, so I'd like to know: which hypervisors have this shared folder
&gt; &gt; funcionality supported by Libvirt?
&gt;
&gt; The &lt;filesystem&gt; element is supported for Qemu and also for LXC and
&gt; OpenVZ judging by the codebase.
&gt;
&gt; Matthias
&gt;
&gt; &gt; We are very thankful for your answers and willing to see new feature in
&gt; the
&gt; &gt; next version!
&gt; &gt;
&gt; &gt; 2011/6/7 Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; 2011/6/6 Guilherme Santos &lt;guisgb13@gmail.com&gt;:
&gt; &gt;&gt; &gt; Well, I am still with that problem, attempting to create shared
&gt; folders,
&gt; &gt;&gt; &gt; so
&gt; &gt;&gt; &gt; I will try to be more specific and then maybe somebody can help me.
&gt; &gt;&gt;
&gt; &gt;&gt; Your problem is simple, libvirt currently doesn't support shared
&gt; &gt;&gt; folder for VirtualBox. I'll have a look at it and if it's simple to
&gt; &gt;&gt; implement you might see it in libvirt 0.9.3.
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; &gt; When I say "I am trying to set up shared folders", I mean that I set
&gt; &gt;&gt; &gt; this
&gt; &gt;&gt; &gt; configuration in my XML description:
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;     &lt;filesystem type='template' accessmode='mapped'&gt;
&gt; &gt;&gt; &gt;       &lt;source name='/home/guilhermesgb/Desktop/SharedFolder/&gt;
&gt; &gt;&gt; &gt;       &lt;target dir='/home/tarciso/Desktop/SharedFolder'/&gt;
&gt; &gt;&gt; &gt;     &lt;/filesystem&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; VirtualBox shared folders don't support setting an access mode. The
&gt; &gt;&gt; target dir will map to the name of the shared folder in the guest.
&gt; &gt;&gt; Also the template type is OpenVZ specific. A shared folder will
&gt; &gt;&gt; probably just map to this XML snippet:
&gt; &gt;&gt;
&gt; &gt;&gt; &lt;filesystem type='mount'&gt;
&gt; &gt;&gt;  &lt;source dir='/home/guilhermesgb/Desktop/SharedFolder'/&gt;
&gt; &gt;&gt;  &lt;target dir='myshare1'/&gt;
&gt; &gt;&gt; &lt;/filesystem&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; You might also specify the &lt;readonly/&gt; option.
&gt; &gt;&gt;
&gt; &gt;&gt; &gt; This was my last attempt. I also tried all other combinations, with
&gt; &gt;&gt; &gt; accessmodes "passthrough" and "squash", for filesystem type "mount"
&gt; too.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; I can't send you any error messages neither printscreens because my
&gt; &gt;&gt; &gt; problem
&gt; &gt;&gt; &gt; is that anything happens, the domain is started properly but no shared
&gt; &gt;&gt; &gt; folder is specified so I can mount it, using command "sudo mount -t
&gt; &gt;&gt; &gt; vboxsf
&gt; &gt;&gt; &gt; SharedFolder /home/tarciso/Desktop/SharedFolder". I always get a
&gt; &gt;&gt; &gt; protocol
&gt; &gt;&gt; &gt; error.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; I was expecting libvirt to automatically do this step for me, so I
&gt; &gt;&gt; &gt; wouldn't
&gt; &gt;&gt; &gt; need to do it manually through vbox GUI or VBoxManage.
&gt; &gt;&gt;
&gt; &gt;&gt; As I said libvirt just doesn't support this yet, but I'll look at it.
&gt; &gt;&gt;
&gt; &gt;&gt; &gt; During my searches through the web, I found this other option,
&gt; although
&gt; &gt;&gt; &gt; I
&gt; &gt;&gt; &gt; can't be sure if it is implemented, as the libvirt website says
&gt; nothing
&gt; &gt;&gt; &gt; about it: defining an XML file with this configuration:
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;     &lt;shareddir fstype="ext4"
&gt; &gt;&gt; &gt; path="/home/guilhermesgb/Desktop/SharedFolder"
&gt; &gt;&gt; &gt; mount_tag="SharingName" security_model="passthrough" /&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; Where did you find this? This is not libvirt XML.
&gt; &gt;&gt;
&gt; &gt;&gt; &gt; And then mounting it with proper command (the same as before, now with
&gt; &gt;&gt; &gt; the
&gt; &gt;&gt; &gt; mount_tag specified: "sudo mount -t vboxsf SharingName
&gt; &gt;&gt; &gt; /home/tarciso/Desktop/SharedFolder" . Unfortunatelly the same error
&gt; &gt;&gt; &gt; persists.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; Am I missing something?
&gt; &gt;&gt;
&gt; &gt;&gt; No, it is exactly as expected, but it'll improve.
&gt; &gt;&gt;
&gt; &gt;&gt; Matthias
&gt; &gt;&gt;
&gt; &gt;&gt; &gt; Sorry if my first message was hard to understand. Thanks.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; 2011/6/1 Guilherme Santos &lt;guisgb13@gmail.com&gt;
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; Good afternoon.
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; I am having trouble trying to set up shared folders in the guest VM
&gt; &gt;&gt; &gt;&gt; using
&gt; &gt;&gt; &gt;&gt; VirtualBox hypervisor. No matter what configuration is defined in my
&gt; &gt;&gt; &gt;&gt; XML, it
&gt; &gt;&gt; &gt;&gt; never works, I mean, no shared folder is added/specifyed, then,
&gt; inside
&gt; &gt;&gt; &gt;&gt; the
&gt; &gt;&gt; &gt;&gt; guest, when I try to mount the folder, I always get a protocol error.
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; If I use VirtualBoxManage, I can add/specify shared folders easily
&gt; and
&gt; &gt;&gt; &gt;&gt; mount it with no problem.
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; I need to use libvirt in order to deal, in a generalized way, with
&gt; the
&gt; &gt;&gt; &gt;&gt; process of creating shared folders in all hypervisors supported by
&gt; &gt;&gt; &gt;&gt; libvirt,
&gt; &gt;&gt; &gt;&gt; otherwise my problem would be solved already. I must not use specific
&gt; &gt;&gt; &gt;&gt; commands of a certain hypervisor (such as VirtualBoxManage's).
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; How does libvirt allow me to set up shared folders? Does it use
&gt; &gt;&gt; &gt;&gt; VirtualBoxManage for VBox hypervisors? If so, how do I use it?
&gt; &gt;&gt; &gt;&gt; I've read the documentation and followed it in defining my XMLs.
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; Thanks anyway!
&gt; &gt;&gt; &gt;&gt; --
&gt; &gt;&gt; &gt;&gt; Guilherme Santos G. Baptista
&gt; &gt;&gt; &gt;&gt; Undergraduate in Computer Science at UFCG
&gt; &gt;&gt; &gt;&gt; LSD - Distributed Systems Laboratory
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; --
&gt; &gt;&gt; &gt; Guilherme Santos G. Baptista
&gt; &gt;&gt; &gt; Graduando em Ciência da Computação pela UFCG
&gt; &gt;&gt; &gt; LSD - Laboratório de Sistemas Distribuídos
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; _______________________________________________
&gt; &gt;&gt; &gt; libvirt-users mailing list
&gt; &gt;&gt; &gt; libvirt-users@redhat.com
&gt; &gt;&gt; &gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; &gt;&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; --
&gt; &gt; Guilherme Santos G. Baptista
&gt; &gt; Graduando em Ciência da Computação pela UFCG
&gt; &gt; LSD - Laboratório de Sistemas Distribuídos
&gt; &gt;
&gt;



-- 
Guilherme Santos G. Baptista
Graduando em Ciência da Computação pela UFCG
LSD - Laboratório de Sistemas Distribuídos

[Attachment #3 (text/html)]

Good afternoon. I am sending this email because I had a problem while trying to use \
your patch.&lt;br&gt;&lt;br&gt;I was using libvirt version 0.8.5 before you send this patch. I \
upgraded it to version 0.9.2, then I applied your patch.&lt;br&gt;

&lt;br&gt;I can see that libvirt properly communicated with VBox hypervisor and added the \
shared folder but when I started it, my domain boots and initializes until a certain \
point where, strangely, it restarts the VM again, and so this process keeps repeating \
indefinitely. Maybe this is happening when the domain tries to mount the shared \
folder.&lt;br&gt;

&lt;br&gt;I am using Ubuntu 10.04 and version 0.9.2 of libvirt. Before installing version \
9.04 I run command make uninstall and then downloaded 0.9.2's tar.gz from the \
libvirt website. Once I wasn't sure if the problem was caused by your patch, I \
tried to start a VM without libvirt (through VirtualBox OSE) and it started using the \
same virtual disk with no problem. My libvirt version went back to 0.9.0 and then, \
without patching, I tested it to see if libvirt would start my domain properly, but \
the problem remained.&lt;br&gt;

&lt;br&gt;I repeated all the previous steps in another machine and this problem happened \
there also, even after it went through the patching process.&lt;br&gt;&lt;br&gt;With that in \
mind, we'd like to talk more with you about this shared folder feature supported \
by Libvirt. &lt;br&gt;

Me and my team are working on an open source project called Ourgrid, which is a \
middleware for grid computing (&lt;a \
href="http://www.ourgrid.org/"&gt;http://www.ourgrid.org/&lt;/a&gt;).&lt;br&gt;We use virtual \
machines for remote sandboxed execution. Currently we support VBox and VServer \
hypervisors. However, we want it to have an uniform handling. That's when we \
found out that Libvirt seemed to handle many virtualization hypervisors, and then we \
thought using Libvirt could be a good idea.&lt;br&gt;

&lt;br&gt;We know that some hypervisors don't provide an easy way to send remote \
commands to be executed by the domain, so we think that the most general way to \
handle with all of them is using a shared folder and having a deamon running in the \
previously configured domain that monitors this shared folder that executes the \
scripts staged in the folder.&lt;br&gt;

&lt;br&gt;But as far as we know, the shared folder feature is not fully developed yet for \
all hypervisors supported by Libvirt.&lt;br&gt;&lt;br&gt;We are not very experienced in C \
programming, neither in Libvirt code, so we'd like to know if this feature (for \
all, or most of all hypervisors provided by libvirt) is expected in the Libvirt \
development agenda or is it something out of its scope.&lt;br&gt;

&lt;br&gt;If this is out of your development agenda, we are very keen to try implementing \
it, once this is a major issue for us. &lt;br&gt;Obviously, any help/suggestion would be \
appreciated.&lt;br&gt;&lt;br&gt;Thanks.&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;

2011/6/7 Matthias Bolte &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, \
204, 204); padding-left: 1ex;"&gt;

2011/6/7 Guilherme Santos &lt;&lt;a \
href="mailto:guisgb13@gmail.com"&gt;guisgb13@gmail.com&lt;/a&gt;&gt;:&lt;br&gt; &lt;div \
class="im"&gt;&gt;&gt; A shared folder will&lt;br&gt; &gt;&gt; probably just map to this XML \
snippet:&lt;br&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; &lt;filesystem type='mount'&gt;&lt;br&gt;
&gt;&gt;   &lt;source dir='/home/guilhermesgb/Desktop/SharedFolder'/&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;   &lt;target dir='myshare1'/&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; &lt;/filesystem&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt; I see. I also tried this XML configuration you gave as an example, but it&lt;br&gt;
&gt; wouldn't work. And now I know why...&lt;br&gt;
&gt;&lt;br&gt;
&gt;&gt; &lt;shareddir fstype="ext4" \
path="/home/guilhermesgb/Desktop/SharedFolder"&lt;br&gt; &gt;&gt; \
mount_tag="SharingName" security_model="passthrough" /&gt;&lt;br&gt; \
&gt;&gt;&lt;br&gt; &gt;&gt; Where did you find this? This is not libvirt XML.&lt;br&gt;
&gt;&lt;br&gt;
&gt; I found it searching through Google:&lt;br&gt;
&gt; &lt;a href="http://www.mail-archive.com/libvir-list@redhat.com/msg27808.html" \
target="_blank"&gt;http://www.mail-archive.com/libvir-list@redhat.com/msg27808.html&lt;/a&gt; \
- altough I&lt;br&gt; &gt; just used it as a last resort, as anything else would work.&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;Ah, that was just some idea that never got implemented.&lt;br&gt;
&lt;div class="im"&gt;&lt;br&gt;
&gt; We have chosen to use libvirt in order to deal, in a generalized way, with&lt;br&gt;
&gt; the&lt;br&gt;
&gt; process of starting virtual machines, stopping them, executing remote&lt;br&gt;
&gt; commands and creating shared folders.&lt;br&gt;
&gt; As we saw that libvirt cannot handle with executing remote commands without&lt;br&gt;
&gt; any manual configuration by us (setting up consoles, through ssh, etc.), we&lt;br&gt;
&gt; will basically use a shared folder to store scripts that are to be executed&lt;br&gt;
&gt; by the guest, and the guest would have a running daemon that monitors this&lt;br&gt;
&gt; shared folder and executes everything in it.&lt;br&gt;
&gt;&lt;br&gt;
&gt; Do you know how could I share a folder with a VBox guest through actual&lt;br&gt;
&gt; Libvirt code?&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;Oh, I missed to CC you on this patch:&lt;br&gt;
&lt;br&gt;
&lt;a href="https://www.redhat.com/archives/libvir-list/2011-June/msg00315.html" \
target="_blank"&gt;https://www.redhat.com/archives/libvir-list/2011-June/msg00315.html&lt;/a&gt;&lt;br&gt;
 &lt;br&gt;
That makes libvirt support VirtualBox shared folders.&lt;br&gt;
&lt;div class="im"&gt;&lt;br&gt;
&gt; We are also trying to do this through the Java binding, but it won't \
work&lt;br&gt; &gt; either. As you said, it's not supported yet.&lt;br&gt;
&gt; We will eventually have to do this for all other hypervisors supported by&lt;br&gt;
&gt; Libvirt, so I'd like to know: which hypervisors have this shared folder&lt;br&gt;
&gt; funcionality supported by Libvirt?&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;The &lt;filesystem&gt; element is supported for Qemu and also for LXC and&lt;br&gt;
OpenVZ judging by the codebase.&lt;br&gt;
&lt;font color="#888888"&gt;&lt;br&gt;
Matthias&lt;br&gt;
&lt;/font&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;&lt;br&gt;
&gt; We are very thankful for your answers and willing to see new feature in the&lt;br&gt;
&gt; next version!&lt;br&gt;
&gt;&lt;br&gt;
&gt; 2011/6/7 Matthias Bolte &lt;&lt;a \
href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;&lt;br&gt; \
&gt;&gt;&lt;br&gt; &gt;&gt; 2011/6/6 Guilherme Santos &lt;&lt;a \
href="mailto:guisgb13@gmail.com"&gt;guisgb13@gmail.com&lt;/a&gt;&gt;:&lt;br&gt; &gt;&gt; &gt; Well, \
I am still with that problem, attempting to create shared folders,&lt;br&gt; &gt;&gt; &gt; \
so&lt;br&gt; &gt;&gt; &gt; I will try to be more specific and then maybe somebody can help \
me.&lt;br&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; Your problem is simple, libvirt currently doesn't support shared&lt;br&gt;
&gt;&gt; folder for VirtualBox. I'll have a look at it and if it's simple \
to&lt;br&gt; &gt;&gt; implement you might see it in libvirt 0.9.3.&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; &gt; When I say "I am trying to set up shared folders", I mean \
that I set&lt;br&gt; &gt;&gt; &gt; this&lt;br&gt;
&gt;&gt; &gt; configuration in my XML description:&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;     &lt;filesystem type='template' \
accessmode='mapped'&gt;&lt;br&gt; &gt;&gt; &gt;       &lt;source \
name='/home/guilhermesgb/Desktop/SharedFolder/&gt;&lt;br&gt; &gt;&gt; &gt;       \
&lt;target dir='/home/tarciso/Desktop/SharedFolder'/&gt;&lt;br&gt; &gt;&gt; &gt;    \
&lt;/filesystem&gt;&lt;br&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; VirtualBox shared folders don't support setting an access mode. The&lt;br&gt;
&gt;&gt; target dir will map to the name of the shared folder in the guest.&lt;br&gt;
&gt;&gt; Also the template type is OpenVZ specific. A shared folder will&lt;br&gt;
&gt;&gt; probably just map to this XML snippet:&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; &lt;filesystem type='mount'&gt;&lt;br&gt;
&gt;&gt;  &lt;source dir='/home/guilhermesgb/Desktop/SharedFolder'/&gt;&lt;br&gt;
&gt;&gt;  &lt;target dir='myshare1'/&gt;&lt;br&gt;
&gt;&gt; &lt;/filesystem&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; You might also specify the &lt;readonly/&gt; option.&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; &gt; This was my last attempt. I also tried all other combinations, with&lt;br&gt;
&gt;&gt; &gt; accessmodes "passthrough" and "squash", for \
filesystem type "mount" too.&lt;br&gt; &gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt; I can't send you any error messages neither printscreens because \
my&lt;br&gt; &gt;&gt; &gt; problem&lt;br&gt;
&gt;&gt; &gt; is that anything happens, the domain is started properly but no \
shared&lt;br&gt; &gt;&gt; &gt; folder is specified so I can mount it, using command \
"sudo mount -t&lt;br&gt; &gt;&gt; &gt; vboxsf&lt;br&gt;
&gt;&gt; &gt; SharedFolder /home/tarciso/Desktop/SharedFolder". I always get \
a&lt;br&gt; &gt;&gt; &gt; protocol&lt;br&gt;
&gt;&gt; &gt; error.&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt; I was expecting libvirt to automatically do this step for me, so I&lt;br&gt;
&gt;&gt; &gt; wouldn't&lt;br&gt;
&gt;&gt; &gt; need to do it manually through vbox GUI or VBoxManage.&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; As I said libvirt just doesn't support this yet, but I'll look at \
it.&lt;br&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; &gt; During my searches through the web, I found this other option, \
although&lt;br&gt; &gt;&gt; &gt; I&lt;br&gt;
&gt;&gt; &gt; can't be sure if it is implemented, as the libvirt website says \
nothing&lt;br&gt; &gt;&gt; &gt; about it: defining an XML file with this configuration:&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;     &lt;shareddir fstype="ext4"&lt;br&gt;
&gt;&gt; &gt; path="/home/guilhermesgb/Desktop/SharedFolder"&lt;br&gt;
&gt;&gt; &gt; mount_tag="SharingName" \
security_model="passthrough" /&gt;&lt;br&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; Where did you find this? This is not libvirt XML.&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; &gt; And then mounting it with proper command (the same as before, now \
with&lt;br&gt; &gt;&gt; &gt; the&lt;br&gt;
&gt;&gt; &gt; mount_tag specified: "sudo mount -t vboxsf SharingName&lt;br&gt;
&gt;&gt; &gt; /home/tarciso/Desktop/SharedFolder" . Unfortunatelly the same \
error&lt;br&gt; &gt;&gt; &gt; persists.&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt; Am I missing something?&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; No, it is exactly as expected, but it'll improve.&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; Matthias&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; &gt; Sorry if my first message was hard to understand. Thanks.&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt; 2011/6/1 Guilherme Santos &lt;&lt;a \
href="mailto:guisgb13@gmail.com"&gt;guisgb13@gmail.com&lt;/a&gt;&gt;&lt;br&gt; &gt;&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; &gt;&gt; Good afternoon.&lt;br&gt;
&gt;&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; &gt;&gt; I am having trouble trying to set up shared folders in the guest \
VM&lt;br&gt; &gt;&gt; &gt;&gt; using&lt;br&gt;
&gt;&gt; &gt;&gt; VirtualBox hypervisor. No matter what configuration is defined in \
my&lt;br&gt; &gt;&gt; &gt;&gt; XML, it&lt;br&gt;
&gt;&gt; &gt;&gt; never works, I mean, no shared folder is added/specifyed, then, \
inside&lt;br&gt; &gt;&gt; &gt;&gt; the&lt;br&gt;
&gt;&gt; &gt;&gt; guest, when I try to mount the folder, I always get a protocol \
error.&lt;br&gt; &gt;&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; &gt;&gt; If I use VirtualBoxManage, I can add/specify shared folders easily \
and&lt;br&gt; &gt;&gt; &gt;&gt; mount it with no problem.&lt;br&gt;
&gt;&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; &gt;&gt; I need to use libvirt in order to deal, in a generalized way, with \
the&lt;br&gt; &gt;&gt; &gt;&gt; process of creating shared folders in all hypervisors \
supported by&lt;br&gt; &gt;&gt; &gt;&gt; libvirt,&lt;br&gt;
&gt;&gt; &gt;&gt; otherwise my problem would be solved already. I must not use \
specific&lt;br&gt; &gt;&gt; &gt;&gt; commands of a certain hypervisor (such as \
VirtualBoxManage's).&lt;br&gt; &gt;&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; &gt;&gt; How does libvirt allow me to set up shared folders? Does it use&lt;br&gt;
&gt;&gt; &gt;&gt; VirtualBoxManage for VBox hypervisors? If so, how do I use it?&lt;br&gt;
&gt;&gt; &gt;&gt; I've read the documentation and followed it in defining my \
XMLs.&lt;br&gt; &gt;&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; &gt;&gt; Thanks anyway!&lt;br&gt;
&gt;&gt; &gt;&gt; --&lt;br&gt;
&gt;&gt; &gt;&gt; Guilherme Santos G. Baptista&lt;br&gt;
&gt;&gt; &gt;&gt; Undergraduate in Computer Science at UFCG&lt;br&gt;
&gt;&gt; &gt;&gt; LSD - Distributed Systems Laboratory&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt; --&lt;br&gt;
&gt;&gt; &gt; Guilherme Santos G. Baptista&lt;br&gt;
&gt;&gt; &gt; Graduando em Ciência da Computação pela UFCG&lt;br&gt;
&gt;&gt; &gt; LSD - Laboratório de Sistemas Distribuídos&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt; _______________________________________________&lt;br&gt;
&gt;&gt; &gt; libvirt-users mailing list&lt;br&gt;
&gt;&gt; &gt; &lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
 &gt;&gt; &gt; &lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; \
&gt;&gt; &gt;&lt;br&gt; &gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt; --&lt;br&gt;
&gt; Guilherme Santos G. Baptista&lt;br&gt;
&gt; Graduando em Ciência da Computação pela UFCG&lt;br&gt;
&gt; LSD - Laboratório de Sistemas Distribuídos&lt;br&gt;
&gt;&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;Guilherme Santos G. \
Baptista&lt;br&gt;Graduando em Ciência da Computação pela UFCG&lt;br&gt;LSD - Laboratório de \
Sistemas Distribuídos&lt;br&gt;



</body></email><email><emailId>20110610114525</emailId><senderName>"Richard W.M. Jones"</senderName><senderEmail>rjones@redhat.com</senderEmail><timestampReceived>2011-06-10 11:45:25-0400</timestampReceived><subject>Re: [libvirt-users] Resizing ext4 fedora qemu guest</subject><body>


Original message:
https://www.redhat.com/archives/libvirt-users/2011-June/msg00017.html

Best to post libguestfs and virt-tools questions on one of these two
mailing lists:
http://www.redhat.com/mailman/listinfo/libguestfs
https://www.redhat.com/mailman/listinfo/virt-tools-list

The answer is: yes, virt-resize understands ext4.

I can't really say more since you don't say what virt-resize command
line you are actually using.  But if I were a gambling man, I'd say
it's because you've forgotten:

  --lv-expand /dev/vg_custserv/lv_home

(or whichever filesystem you want to resize).

If that's not the problem, please post a full description of what
you're trying to do, including the virt-resize command, the full
output of the command, and the output of 'virt-filesystems --all --long'
before and after the resize.

Rich.

-- 
Richard Jones, Virtualization Group, Red Hat http://people.redhat.com/~rjones
virt-df lists disk usage of guests without needing to install any
software inside the virtual machine.  Supports Linux and Windows.
http://et.redhat.com/~rjones/virt-df/

</body></email><email><emailId>20110610133009</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2011-06-10 13:30:09-0400</timestampReceived><subject>Re: [libvirt-users] libvirt-users Digest, Vol 18, Issue 11</subject><body>

On 06/09/11 - 07:11:22PM, m m wrote:
&gt; I have attached all the logs (/var/log/dmesg, /var/log/libvirtd.log,
&gt; /var/log/messages, /var/log/syslog, /var/log/boot.log and info about loaded
&gt; modules /proc/modules) regarding scenatios1,2,3 (please see the README file
&gt; for simple explanation what is there). By the way, I have installed only
&gt; dnsmasq-bin (and not dnsmasq).
&gt; Have a nice day

Please stop sending 6MB attachments out to the list; every person subscribed to
the list has to download them.

If you need to send someone a lot of information, upload it to a website
somewhere and just send a link in email.

Thanks,
-- 
Chris Lalancette

</body></email><email><emailId>20110610170302</emailId><senderName>Julian Cerruti</senderName><senderEmail>jcerruti@gmail.com</senderEmail><timestampReceived>2011-06-10 17:03:02-0400</timestampReceived><subject>[libvirt-users] stuck after upgrade</subject><body>

Hi all,

We're completely stuck helpless with our CentOS system which we've been
using as a VM server.
After an unanticipated system upgrade, we can't get virsh or virt-manager to
connect to libvirt anymore. It gets completely stuck during startup, trying
to connect.

One of the suspicious things we've seen is the following:

[root@ana libvirt]# netstat | grep /var/run/libvirt/libvirt-sock
unix  3      [ ]         STREAM     CONNECTING    0
 /var/run/libvirt/libvirt-sock
unix  3      [ ]         STREAM     CONNECTING    0
 /var/run/libvirt/libvirt-sock
unix  3      [ ]         STREAM     CONNECTING    0
 /var/run/libvirt/libvirt-sock
unix  3      [ ]         STREAM     CONNECTING    0
 /var/run/libvirt/libvirt-sock
unix  3      [ ]         STREAM     CONNECTING    0
 /var/run/libvirt/libvirt-sock
....

I'm not adding more information here because there is so much we've tried
that I wouldn't know where to start. I would be happy to provide any info
that would be useful to solve this issue.

Any hint or help would be greatly appreciated.

Thanks!

Julian

[Attachment #3 (text/html)]

Hi all,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;We're completely stuck helpless with our Cen=
tOS system which we've been using as a VM server.&lt;/div&gt;&lt;div&gt;After an un=
anticipated system upgrade, we can't get virsh or virt-manager to conne=
ct to libvirt anymore. It gets completely stuck during startup, trying to c=
onnect.&lt;/div&gt;
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;One of the suspicious things we've seen is the foll=
owing:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;[root@ana libvirt]# netstat | grep /va=
r/run/libvirt/libvirt-sock&lt;/div&gt;&lt;div&gt;unix =A03 =A0 =A0 =A0[ ] =A0 =A0 =A0 =
=A0 STREAM =A0 =A0 CONNECTING =A0 =A00 =A0 =A0 =A0/var/run/libvirt/libvirt-=
sock&lt;/div&gt;
&lt;div&gt;unix =A03 =A0 =A0 =A0[ ] =A0 =A0 =A0 =A0 STREAM =A0 =A0 CONNECTING =A0=
 =A00 =A0 =A0 =A0/var/run/libvirt/libvirt-sock&lt;/div&gt;&lt;div&gt;unix =A03 =A0 =A0 =
=A0[ ] =A0 =A0 =A0 =A0 STREAM =A0 =A0 CONNECTING =A0 =A00 =A0 =A0 =A0/var/r=
un/libvirt/libvirt-sock&lt;/div&gt;&lt;div&gt;unix =A03 =A0 =A0 =A0[ ] =A0 =A0 =A0 =A0 =
STREAM =A0 =A0 CONNECTING =A0 =A00 =A0 =A0 =A0/var/run/libvirt/libvirt-sock=
&lt;/div&gt;
&lt;div&gt;unix =A03 =A0 =A0 =A0[ ] =A0 =A0 =A0 =A0 STREAM =A0 =A0 CONNECTING =A0=
 =A00 =A0 =A0 =A0/var/run/libvirt/libvirt-sock&lt;/div&gt;&lt;/div&gt;&lt;div&gt;....&lt;/div&gt;&lt;d=
iv&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I'm not adding more information here because there is=
 so much we've tried that I wouldn't know where to start. I would b=
e happy to provide any info that would be useful to solve this issue.=A0&lt;/d=
iv&gt;
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Any hint or help would be greatly appreciated.&lt;/div&gt;&lt;di=
v&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks!&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Julian&lt;/div&gt;


</body></email><email><emailId>20110610201236</emailId><senderName>Jeff</senderName><senderEmail>jwk1230@gmail.com</senderEmail><timestampReceived>2011-06-10 20:12:36-0400</timestampReceived><subject>[libvirt-users] e:  How to disconnect the ISO image using virsh</subject><body>

I am trying to detach an ISO from a KVM machine and I've tried both attach-disk using \
" " in the file path as well as the update-device option but am getting this error

error: Failed to update device from /var/run/libvirt/qemu/kvmtest1.xml
error: XML description for unknown device type is not well formed or invalid.

I tried doing a virsh edit on the xml file to remove the source file path to the ISO, \
as I assume is the correct method, and then running the virsh update-device but it's \
not working. 

Can anyone advise the correct steps to detach a device from a running and/or offline \
domain?

Additionally - anyone have any guidance on how to attach a CD device to a domain that \
is currently shutdown, for example, if I wanted to boot the domain to a rescue CD \
image?

Thanks

Jeff


于 2011年03月31日 15:17, Masanari Iida 写道:
Somebody sent me a tips.
Following command do what I wanted to do.
Thanks.

attach-disk guest01 " " hdc --driver file --type cdrom
--mode readonly
Also using "update-device" with an xml which doesn't specify
the source file path will work.

On Thu, Mar 31, 2011 at 3:29 PM, Masanari Iida&lt;standby24x7 gmail com&gt;  wrote:
Hello,

I can attach disc ISO image to cd-rom from virsh.
And I can replace the ISO image from disc1 to disc2 using the 2nd example.

(example)
attach-disk guest01 /root/disc1.iso hdc --driver file --type cdrom
--mode readonly
attach-disk guest01 /root/disc2.iso hdc --driver file --type cdrom
--mode readonly

My question is, how can I disconnect the image from the cdrom drive using virsh.
Because, if I try to detach-disk hdc, I got following errors.

virsh # detach-disk guest01 hdc
error: Failed to detach disk
error: this function is not supported by the connection driver:
This type of device cannot be hot unplugged

What I can do is possible from virt-manager's "Disconnect" button,
(next to source path: line)  from Hardware's TAB, Disk hdc screen.
I want to do this from virsh.

OS: RHEL5.6
libvirt-0.8.2-15.el5_6.1 is used.

Regards,
Masanari Iida

_______________________________________________
libvirt-users mailing list
libvirt-users redhat com
https://www.redhat.com/mailman/listinfo/libvirt-users


[Attachment #3 (unknown)]

&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body style="word-wrap: break-word; -webkit-nbsp-mode: space; \
-webkit-line-break: after-white-space; "&gt;&lt;pre style="margin: 0em;"&gt;I am trying to \
detach an ISO from a KVM machine and I've tried both attach-disk using " " in the \
file path as well as the update-device option but am getting this error&lt;/pre&gt;&lt;pre \
style="margin: 0em;"&gt;&lt;br&gt;&lt;/pre&gt;&lt;pre style="margin: 0em;"&gt;error: Failed to update \
device from /var/run/libvirt/qemu/kvmtest1.xml&lt;/pre&gt;&lt;pre style="margin: 0em;"&gt;error: \
XML description for unknown device type is not well formed or invalid.&lt;/pre&gt;&lt;pre \
style="margin: 0em;"&gt;&lt;br&gt;&lt;/pre&gt;&lt;pre style="margin: 0em;"&gt;I tried doing a virsh edit \
on the xml file to remove the source file path to the ISO, as I assume is the correct \
method, and then running the virsh update-device but it's not working. &lt;/pre&gt;&lt;pre \
style="margin: 0em;"&gt;&lt;br&gt;&lt;/pre&gt;&lt;pre style="margin: 0em;"&gt;Can anyone advise the \
correct steps to detach a device from a running and/or offline domain?&lt;/pre&gt;&lt;pre \
style="margin: 0em;"&gt;&lt;br&gt;&lt;/pre&gt;&lt;pre style="margin: 0em;"&gt;Additionally - anyone have \
any guidance on how to attach a CD device to a domain that is currently shutdown, for \
example, if I wanted to boot the domain to a rescue CD image?&lt;/pre&gt;&lt;pre \
style="margin: 0em;"&gt;&lt;br&gt;&lt;/pre&gt;&lt;pre style="margin: 0em;"&gt;Thanks&lt;/pre&gt;&lt;pre \
style="margin: 0em;"&gt;&lt;br&gt;&lt;/pre&gt;&lt;pre style="margin: 0em;"&gt;Jeff&lt;/pre&gt;&lt;pre \
style="margin: 0em;"&gt;&lt;br&gt;&lt;/pre&gt;&lt;pre style="margin: 0em;"&gt;&lt;br&gt;&lt;/pre&gt;&lt;pre \
style="margin: 0em;"&gt;于 2011年03月31日 15:17, Masanari Iida 写道: \
&lt;/pre&gt;&lt;blockquote style="border-left: 0.2em solid rgb(85, 85, 238); margin: 0em; \
padding-left: 0.85em;"&gt;&lt;pre style="margin: 0em;"&gt;Somebody sent me a tips. Following \
command do what I wanted to do. Thanks.

attach-disk guest01 " " hdc --driver file --type cdrom
--mode readonly
&lt;/pre&gt;&lt;/blockquote&gt;&lt;pre style="margin: 0em;"&gt;Also using "update-device" with an xml \
which doesn't specify the source file path will work.

&lt;/pre&gt;&lt;blockquote style="border-left: 0.2em solid rgb(85, 85, 238); margin: 0em; \
padding-left: 0.85em;"&gt;&lt;pre style="margin: 0em;"&gt;On Thu, Mar 31, 2011 at 3:29 PM, \
Masanari Iida&lt;standby24x7 gmail com&gt;  wrote: &lt;/pre&gt;&lt;blockquote \
style="border-left: 0.2em solid rgb(85, 85, 238); margin: 0em; padding-left: \
0.85em;"&gt;&lt;pre style="margin: 0em;"&gt;Hello,

I can attach disc ISO image to cd-rom from virsh.
And I can replace the ISO image from disc1 to disc2 using the 2nd example.

(example)
attach-disk guest01 /root/disc1.iso hdc --driver file --type cdrom
--mode readonly
attach-disk guest01 /root/disc2.iso hdc --driver file --type cdrom
--mode readonly

My question is, how can I disconnect the image from the cdrom drive using virsh.
Because, if I try to detach-disk hdc, I got following errors.

virsh # detach-disk guest01 hdc
error: Failed to detach disk
error: this function is not supported by the connection driver:
This type of device cannot be hot unplugged

What I can do is possible from virt-manager's "Disconnect" button,
(next to source path: line)  from Hardware's TAB, Disk hdc screen.
I want to do this from virsh.

OS: RHEL5.6
libvirt-0.8.2-15.el5_6.1 is used.

Regards,
Masanari Iida

&lt;/pre&gt;&lt;/blockquote&gt;&lt;pre style="margin: \
0em;"&gt;_______________________________________________ libvirt-users mailing list
libvirt-users redhat com
&lt;a rel="nofollow" href="https://www.redhat.com/mailman/listinfo/libvirt-users"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;
 &lt;/pre&gt;&lt;/blockquote&gt;&lt;pre style="margin: 0em;"&gt;&lt;/pre&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20110612160317</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2011-06-12 16:03:17-0400</timestampReceived><subject>Re: [libvirt-users] libvirt-bin MOSTLY fails to create default virtual network</subject><body>

On 06/06/2011 03:24 PM, m m wrote:
&gt; I have observed 3 scenarios after I reboot the host with 2 guests 
&gt; (which are supposed to autostart after boot/reboot of the host):
&gt; 1. Default network is created but I can not ping guests. Gests don't 
&gt; have assigned IP address or they both have IP address 192.168.122.100.
&gt; 2. Default network is not created.
&gt; 3. Default netork is properly created and everything works fine.
&gt; In each case guests are started and they work properly. Cases 1. and 
&gt; 2. happen a lot more often then case 3.
&gt;
&gt; My solutions:
&gt; - When I restart libvirt-bin then everything is fine.
&gt; - When I set 'sleep 40' in 'pre-start' section of 
&gt; /etc/init/libvirt-bin.conf and modify 'start on' section in the 
&gt; following way:
&gt;
&gt; start on (runlevel [2345] and net-device-up IFACE=br0)
&gt;
&gt; then everything works fine.
&gt;
&gt;
&gt; However, none of the above solutions indeed solves the problem. 
&gt; Please, let me know if there is solution to this problem or what are 
&gt; your suggestions regarding this issue.
&gt;
&gt; ****
&gt; HOST$ uname -a
&gt; Linux ras 2.6.32-32-server #62-Ubuntu SMP Wed Apr 20 22:07:43 UTC 2011 
&gt; x86_64 GNU/Linux
&gt;
&gt; GUEST1 and GUEST2
&gt; $ uname -a
&gt; Linux server1-desktop 2.6.32-32-generic #62-Ubuntu SMP Wed Apr 20 
&gt; 21:54:21 UTC 2011 i686 GNU/Linux
&gt;
&gt; HOST$ libvirtd --version
&gt; libvirtd (libvirt) 0.7.5
&gt;
&gt; My idea was that some kernel modules sometimes are loaded before 
&gt; libvirt-bin starts, and sometimes libvirt-bin starts earlier, or in 
&gt; the middle of loading of these modules, that is why 3 scenarios can be 
&gt; observed.
&gt; That is why I have added:
&gt;  cp /proc/modules /home/wsadmin2/modules1
&gt;  cp /proc/modules /home/wsadmin2/modules2
&gt; to 'pre-start' and 'post-start' parts respectively of 
&gt; /etc/init/libvirt-bin.conf.
&gt;
&gt; Of course, beween execution of
&gt; - pre-start part
&gt; - exec /usr/sbin/libvirtd -d
&gt; - post-start part
&gt; other kernel modules can be loaded, so we can not be sure which 
&gt; additional modules in file 'modules2' were indeed loaded before 
&gt; libvirtd was actually started.
&gt;
&gt; Here are my observations:
&gt; Scenatio 1.
&gt; 33 (fixed) modules were logged - call them BASE MODULES.
&gt;
&gt; Scenatio 2.
&gt; Beside BASE MODULES + the following modules were loaded:
&gt;
&gt; &gt; iptable_filter 1841 0 - Live 0xffffffffa007c000
&gt; &gt; ip_tables 18201 1 iptable_filter, Live 0xffffffffa0172000
&gt; &gt; x_tables 22361 1 ip_tables, Live 0xffffffffa0164000

In your "scenario 1" the modules necessary for iptables to function 
haven't been loaded. Each virtual network requires a set of iptables 
rules to function properly, and if there is no iptables, the rules can't 
be added and network creation fails. Your libvirtd.log confirms that 
problem:

   10:06:06.980: error : networkAddIptablesRules:750 : failed to add 
iptables rule to allow DHCP requests from 'virbr0': Invalid argument


0.7.5 is quite old (&gt; 1 year), is there perhaps a newer pre-built 
version of libvirt available for your release of Ubuntu?

It seems that Ubuntu's method of starting up libvirtd (at least on your 
machine) is missing a dependency to force iptables to be loaded before 
libvirtd starts. I'm unfamiliar with Ubuntu/debian startup stuff 
(upstart, I guess), but that's where you need to look for the solution.

I found the following in the ubuntu bug database, which seems similar, 
but not identical (basically the system networking isn't completely 
ready by the time the autostart domains are brought up):

https://bugs.launchpad.net/ubuntu/+source/libvirt/+bug/495394

&gt;
&gt; Scenatio 3.
&gt; Beside BASE MODULES + the following modules were loaded:
&gt;
&gt; $ diff modules1 modules2
&gt; 1c1,6
&gt; &lt; iptable_filter 1841 0 - Live 0xffffffffa008b000
&gt; ---
&gt; &gt; xt_state 1490 14 - Live 0xffffffffa01ab000
&gt; &gt; xt_tcpudp 2667 12 - Live 0xffffffffa01a5000
&gt; &gt; nf_conntrack_ipv4 12742 14 - Live 0xffffffffa019b000
&gt; &gt; nf_conntrack 73326 2 xt_state,nf_conntrack_ipv4, Live 0xffffffffa017d000

conntrack is used by iptables. I haven't tried it, but wouldn't be 
surprised if adding rules that required conntrack failed if it hadn't 
been loaded, or something like that.

&gt; &gt; nf_defrag_ipv4 1481 1 nf_conntrack_ipv4, Live 0xffffffffa0177000
&gt; &gt; iptable_filter 1841 1 - Live 0xffffffffa008b000
&gt; 3c8
&gt; &lt; x_tables 22361 1 ip_tables, Live 0xffffffffa0162000
&gt; ---
&gt; &gt; x_tables 22361 3 xt_state,xt_tcpudp,ip_tables, Live 0xffffffffa0162000
&gt;
&gt; Other observations:
&gt; Scenatio 1.
&gt; No errors in libvirtd.log
&gt; Scenario 2.
&gt;
&gt; 10:06:06.980: error : networkAddIptablesRules:750 : failed to add 
&gt; iptables rule to allow DHCP requests from 'virbr0': Invalid argument
&gt; (...)
&gt; 10:06:08.630: error : qemudNetworkIfaceConnect:1445 : Failed to add 
&gt; tap interface to bridge 'virbr0': No such device
&gt; 10:06:08.630: error : qemuAutostartDomain:584 : Failed to autostart VM 
&gt; 'cluster_server1': Failed to add tap interface to bridge 'virbr0': No 
&gt; such device
&gt;
&gt; 10:06:08.921: info : qemudDispatchSignalEvent:390 : Received 
&gt; unexpected signal 17
&gt; 10:06:08.927: debug : virExecWithHook:617 : LC_ALL=C /usr/bin/kvm -help
&gt; 10:06:08.938: info : qemudDispatchSignalEvent:390 : Received 
&gt; unexpected signal 17
&gt; 10:06:09.000: error : qemudNetworkIfaceConnect:1445 : Failed to add 
&gt; tap interface to bridge 'virbr0': No such device
&gt; 10:06:09.000: error : qemuAutostartDomain:584 : Failed to autostart VM 
&gt; 'cluster_server2': Failed to add tap interface to bridge 'virbr0': No 
&gt; such device
&gt; (...)
&gt; Scenatio 3.
&gt; No errors in libvirtd.log
&gt;
&gt;
&gt; I didn't see any valuable logs in /var/log/boot.log, 
&gt; /var/log/messages, /var/log/syslog. Please let me know if you want to 
&gt; see them anyway or have any suggestions right away.
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110613165917</emailId><senderName>Michal Privoznik</senderName><senderEmail>mprivozn@redhat.com</senderEmail><timestampReceived>2011-06-13 16:59:17-0400</timestampReceived><subject>Re: [libvirt-users] hook scripts - not in Ubuntu packages?</subject><body>

On 13.06.2011 17:42, Whit Blauvelt wrote:
&gt; On Mon, Jun 13, 2011 at 05:21:02PM +0200, Michal Privoznik wrote:
&gt; 
&gt;&gt; Your other option is to create hook script:
&gt;&gt; http://libvirt.org/hooks.html
&gt; 
&gt; That looks useful.
&gt; 
&gt; On several Ubuntu systems, with Ubuntu libvirt 0.8.8 and 0.8.3 packages
&gt; installed, there's no libvirt/hooks/ directory at all. Is this a directory
&gt; that can simply be created and used under libvirt, or does using this
&gt; feature on Ubuntu require custom installation?
Yes. But you might need to restart libvirtd.
&gt; Thanks,
&gt; Whit
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20110613191106</emailId><senderName>Jeff</senderName><senderEmail>jwk1230@gmail.com</senderEmail><timestampReceived>2011-06-13 19:11:06-0400</timestampReceived><subject>Re: [libvirt-users] Boot delay</subject><body>

Is there a virt-viewer for Windows?

On Jun 13, 2011, at 10:21 AM, Michal Privoznik wrote:

&gt; On 13.06.2011 15:25, Jeff wrote:
&gt; &gt; Is there a method of tweaking the boot sequence of a KVM instance so that you can \
&gt; &gt; delay the process for X number of seconds? I don't have enough time between \
&gt; &gt; starting the KVM and connecting via VNC. 
&gt; You might consider using virt-viewer. It simply waits for domain to
&gt; boot, if it is down.
&gt; 
&gt; Your other option is to create hook script:
&gt; http://libvirt.org/hooks.html
&gt; and put conditional sleep there, because libvirt just before running a
&gt; domain tries to execute qemu with some arguments (e.g. -help) to qeury
&gt; its capabilities. And you don't want your hook script to delay that.
&gt; 
&gt; So you need something like this:
&gt; 
&gt; if [ $2 == "start" ]; then
&gt; sleep 5
&gt; fi
&gt; 
&gt; &gt; Thanks
&gt; &gt; 
&gt; &gt; Jeff
&gt; &gt; 
&gt; &gt; _______________________________________________
&gt; &gt; libvirt-users mailing list
&gt; &gt; libvirt-users@redhat.com
&gt; &gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; 
&gt; Michal


</body></email><email><emailId>20110613210905</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-06-13 21:09:05-0400</timestampReceived><subject>Re: [libvirt-users] Difference between function Migrate and Migrate2</subject><body>


On 06/10/2011 07:09 PM, Abhishek Gupta wrote:
&gt; I was reading the API reference for the libvirt, when I came across
&gt; the function  virDomainMigrate and virDomainMigrate2. I am unable to
&gt; find the difference between the two. Can someone please tell the
&gt; difference in the application of the two?

virDomainMigrate2 is the newer API with more features.  Per the comments
in libvirt.c:

 * virDomainMigrate:
 * @domain: a domain object
 * @dconn: destination host (a connection object)
 * @flags: flags
 * @dname: (optional) rename domain to this at destination
 * @uri: (optional) dest hostname/URI as seen from the source host
 * @bandwidth: (optional) specify migration bandwidth limit in Mbps

 * virDomainMigrate2:
 * @domain: a domain object
 * @dconn: destination host (a connection object)
 * @flags: flags
 * @dxml: (optional) XML config for launching guest on target
 * @dname: (optional) rename domain to this at destination
 * @uri: (optional) dest hostname/URI as seen from the source host
 * @bandwidth: (optional) specify migration bandwidth limit in Mbps

the biggest difference is the new @dxml parameter, which allows you to
make changes in the destination by passing in compatible xml to the host
for hypervisors that know how to compare two xml images (as of 0.9.2,
this is pretty much just the qemu hypervisor for kvm guests, but more
may be added later).  For example, only virDomainMigrate2 can let you
update which host resource is used for a particular guest network
interface, so that source and destination host no longer need have
exactly the same names for host resources.  But if you plan on passing
NULL for dxml (implying no changes needed), then the simpler API is
probably sufficient.

--=20
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20110614170343</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-06-14 17:03:43-0400</timestampReceived><subject>Re: [libvirt-users] request to add an application the app listing on libvirt site</subject><body>


[adding libvir-list for patch tracking]

On 06/14/2011 10:17 AM, Ohad Levy wrote:
&gt; &gt; the simplest is to actually send a patch against the file docs/
&gt; &gt; apps.html.in
&gt; &gt; in the source tree. I would think "Ruby Objects for libvirt" should be
&gt; &gt; added in the "libraries" section, and "Foreman" in the "provisioning"
&gt; &gt; section. The pages are maintained in the source which also allow to
&gt; &gt; package them easilly, I hope making an HTML patch isn't too complex,
&gt; &gt; if not say so I will do it myself :-)
&gt; &gt; 
&gt; &gt; thanks !
&gt; &gt; 
&gt; &gt; thanks! see attached patch.
&gt; 

Thanks for the patch.

Your mailer sent both plain text and html renderings of the email body;
that is overkill (plain text alone works just fine).

&gt; +    &lt;dl&gt;
&gt; +      &lt;dt&gt;&lt;a href="http://theforeman.org"&gt;Foreman&lt;/a&gt;&lt;/dt&gt;
&gt; +      &lt;dd&gt;
&gt; +      Foreman is an open source web based application aimed to be a Single Address \
&gt; For All Machines Life Cycle Management, Foreman: +

That's a long line.  I reformatted to break things to 80 columns where
reasonably possible, and added your name to AUTHORS.  Let me know if you
prefer an alternate spelling there (for example, the commit was
attributed to your gmail.com address, although I see that you also have
a redhat.com address).  Also, I saw some grammar nits.

ACK and pushed as modified:

diff --git i/docs/apps.html.in w/docs/apps.html.in
index 69c9aaa..6b5afdb 100644
--- i/docs/apps.html.in
+++ w/docs/apps.html.in
@@ -15,7 +15,7 @@
       To add an application not listed on this page, send a message
       to the &lt;a href="contact.html"&gt;mailing list&lt;/a&gt;, requesting it
       be added here, or simply send a patch against the documentation
-      in our git docs sub directory.
+      in the libvirt.git docs subdirectory.
       If your application uses libvirt as its API,
       the following graphic is available for your website to advertise
       support for libvirt:
@@ -232,11 +232,11 @@
             &lt;dt&gt;&lt;a href="https://github.com/ohadlevy/virt#readme"&gt;Ruby
             Libvirt Object bindings&lt;/a&gt;&lt;/dt&gt;
             &lt;dd&gt;
-                Virt Allows using simple ruby objects to manipulate
+                Allows using simple ruby objects to manipulate
                 hypervisors, guests, storage, network etc.  It is
                 based on top of
                 the &lt;a href="http://libvirt.org/ruby"&gt;native ruby
-                binding&lt;/a&gt;.
+                bindings&lt;/a&gt;.
             &lt;/dd&gt;
         &lt;/dl&gt;
     &lt;h2&gt;&lt;a name="livecd"&gt;LiveCD / Appliances&lt;/a&gt;&lt;/h2&gt;


-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20110615144958</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-06-15 14:49:58-0400</timestampReceived><subject>Re: [libvirt-users] Is libvirt supported on Citrix Xenserver?</subject><body>

2011/6/15 G Naresh Kumar &lt;naresh.gadepalli@gmail.com&gt;:
&gt; Hi Maththias,
&gt;
&gt; Thanks a lot for your response!.
&gt;
&gt; Is there a specific version of libvirt from which xenserver support is
&gt; added? I am getting the below error
&gt;
&gt; "error: invalid argument in libvirt was built without the 'xenapi' driver"

The means that your libvirt version is new enough and contains the
XenAPI driver but that it was disabled on configure time, probably
because the build server didn't have libxenserver installed and
libvirt's configure script automatically disabled the driver because
of a missing dependency.

&gt; I have installed libvirt from citrix yum repo.

Then Citrix build libvirt without XenAPI support. As a long term
solution you could report to whom ever is responsible for that repo
and request to enabled XenAPI support in that libvirt package. As a
short term solution you could build libvirt from source yourself and
make sure to get the XenAPI driver enabled.

&gt; I am using Xenserver 5.5 with libvirt 0.8.2 and it does not seem to be
&gt; working.

According to http://libvirt.org/hvsupport.html and the error message
0.8.2 is new enough.

Matthias

&gt; Thanks,
&gt;
&gt; Naresh
&gt;
&gt; On Jun 15, 2011 7:03 PM, "Matthias Bolte" &lt;matthias.bolte@googlemail.com&gt;
&gt; wrote:
&gt;&gt; 2011/6/15 G Naresh Kumar &lt;naresh.gadepalli@gmail.com&gt;:
&gt;&gt;&gt; Hi,
&gt;&gt;&gt; Is libvirt supported on Citrix Xenserver. I have been searching for the
&gt;&gt;&gt; same
&gt;&gt;&gt; with little/no luck.
&gt;&gt;&gt; If supported, can you point to some links/documents which can help me try
&gt;&gt;&gt; out the same.
&gt;&gt;&gt; Thanks,
&gt;&gt;&gt; Naresh
&gt;&gt;
&gt;&gt; libvirt can use XenAPI via libxenserver [1]. That should allow you to
&gt;&gt; use libvirt with a Citrix XenServer. You can use virsh like this
&gt;&gt; assuming you have a libxenserver enabled libvirt:
&gt;&gt;
&gt;&gt; virsh -c xenapi://my-xen-server
&gt;&gt;
&gt;&gt; But it's true, there is no documentation about this on the libvirt website
&gt;&gt; yet.
&gt;&gt;
&gt;&gt; [1] http://community.citrix.com/display/xs/Download+SDKs
&gt;&gt;
&gt;&gt; --
&gt;&gt; Matthias Bolte
&gt;&gt; http://photron.blogspot.com
&gt;

</body></email><email><emailId>20110616103533</emailId><senderName>Ali Shoker</senderName><senderEmail>shokerali@gmail.com</senderEmail><timestampReceived>2011-06-16 10:35:33-0400</timestampReceived><subject>[libvirt-users] libvir: QEMU error : cannot set ownership</subject><body>

Hello everybody,

I installed eucalyptus on ubuntu10, basic configuration . Everything is ok
untill I start the instances, the disk is being created but it terminates
soon.

Environment:
NFS , KVM, ubuntu10 x64, Euca on 2 machines (wc sc cc clc on one machine,
and nc on another).
libvirtd (libvirt) 0.7.5
QEMU PC emulator version 0.12.3 (qemu-kvm-0.12.3), Copyright (c) 2003-2008
Fabrice Bellard.

Logs:
/var/log/eucalyptus/nc.log:

[Thu Jun 16 03:54:31 2011][003755][EUCADEBUG ] doStartNetwork() invoked
[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ] StartNetwork(): SUCCESS
return from vnetStartNetwork 0
[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ] StartNetwork(): done
[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ] doRunInstance() invoked
(id=i-4C9D08C3 cores=2 disk=10 memory=512)
[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ]
image=emi-DDBD105C at
http://10.1.1.2:8773/services/Walrus/image-store-1308215076/image.manifest.xml
[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ]
krnel=eki-F41F10E3 at
http://10.1.1.2:8773/services/Walrus/image-store-1308215076/kernel.manifest.xml
[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ]
rmdsk=eri-08841148 at
http://10.1.1.2:8773/services/Walrus/image-store-1308215076/ramdisk.manifest.xml
[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ]
vlan=10 priMAC=d0:0d:4C:9D:08:C3 pubMAC=d0:0d:4C:9D:08:C3
[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ] network started for instance
i-4C9D08C3
[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ] retrieving images for
instance i-4C9D08C3 (disk limit=10240MB)...
[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ] verifying cached file in
/var/lib/eucalyptus/instances//eucalyptus/cache/eki-F41F10E3/kernel...
[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ] walrus_request(): downloading
/tmp/walrus-digest-3D4AKY
[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ]                   from
http://10.1.1.2:8773/services/Walrus/image-store-1308215076/kernel.manifest.xml
[Thu Jun 16 03:54:31 2011][003755][EUCADEBUG ] walrus_request(): writing GET
output to /tmp/walrus-digest-3D4AKY
[Thu Jun 16 03:54:31 2011][003755][EUCADEBUG ] walrus_request(): wrote 3479
bytes in 3 writes
[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ] walrus_request(): saved image
in /tmp/walrus-digest-3D4AKY
[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ] vrun(): [cp -a
/var/lib/eucalyptus/instances//eucalyptus/cache/eki-F41F10E3/kernel
/var/lib/eucalyptus/instances//admin/i-4C9D08C3/ker
nel]
[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ] verifying cached file in
/var/lib/eucalyptus/instances//eucalyptus/cache/eri-08841148/ramdisk...
[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ] walrus_request(): downloading
/tmp/walrus-digest-sVEVa4
[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ]                   from
http://10.1.1.2:8773/services/Walrus/image-store-1308215076/ramdisk.manifest.xml
[Thu Jun 16 03:54:31 2011][003755][EUCADEBUG ] walrus_request(): writing GET
output to /tmp/walrus-digest-sVEVa4
[Thu Jun 16 03:54:31 2011][003755][EUCADEBUG ] walrus_request(): wrote 3482
bytes in 3 writes
[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ] walrus_request(): saved image
in /tmp/walrus-digest-sVEVa4
[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ] vrun(): [cp -a
/var/lib/eucalyptus/instances//eucalyptus/cache/eri-08841148/ramdisk
/var/lib/eucalyptus/instances//admin/i-4C9D08C3/ramdisk]
[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ] verifying cached file in
/var/lib/eucalyptus/instances//eucalyptus/cache/emi-DDBD105C/disk...
[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ] walrus_request(): downloading
/tmp/walrus-digest-RQEzI9
[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ]                   from
http://10.1.1.2:8773/services/Walrus/image-store-1308215076/image.manifest.xml
[Thu Jun 16 03:54:31 2011][003755][EUCADEBUG ] walrus_request(): writing GET
output to /tmp/walrus-digest-RQEzI9
[Thu Jun 16 03:54:31 2011][003755][EUCADEBUG ] walrus_request(): wrote 5887
bytes in 5 writes
[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ] walrus_request(): saved image
in /tmp/walrus-digest-RQEzI9
[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ] vrun(): [cp -a
/var/lib/eucalyptus/instances//eucalyptus/cache/emi-DDBD105C/disk
/var/lib/eucalyptus/instances//admin/i-4C9D08C3/disk]
[Thu Jun 16 03:54:32 2011][003755][EUCAINFO  ] vrun():
[//usr/lib/eucalyptus/euca_rootwrap //usr/share/eucalyptus/partition2disk
/var/lib/eucalyptus/instances//admin/i-4C9D08C3/disk 512 8280]
[Thu Jun 16 03:54:37 2011][003755][EUCADEBUG ] doDescribeResource() invoked
[Thu Jun 16 03:54:37 2011][003755][EUCADEBUG ] doDescribeInstances() invoked
[Thu Jun 16 03:54:43 2011][003755][EUCAINFO  ] preparing images for instance
i-4C9D08C3...
[Thu Jun 16 03:54:43 2011][003755][EUCAINFO  ] adding key/tmp/sckey.uUHVTI
to the root file system at
/var/lib/eucalyptus/instances//admin/i-4C9D08C3/disk using
(//usr/lib/eucalyptus/euca_rootwrap
//usr/share/eucalyptus/add_key.pl//usr/lib/eucalyptus/euca_mountwrap)
[Thu Jun 16 03:54:43 2011][003755][EUCAINFO  ] vrun():
[//usr/lib/eucalyptus/euca_rootwrap
//usr/share/eucalyptus/add_key.pl//usr/lib/eucalyptus/euca_mountwrap
32256
/var/lib/eucalyptus/instances//admin/i-4C9D08C3/disk /tmp/sckey.uUHVTI]
[Thu Jun 16 03:54:43 2011][003755][EUCADEBUG ] system_output():
[//usr/lib/eucalyptus/euca_rootwrap
//usr/share/eucalyptus/gen_kvm_libvirt_xml --ramdisk --ephemeral]
[Thu Jun 16 03:54:43 2011][003755][EUCAINFO  ] currently running/booting:
i-4C9D08C3
[Thu Jun 16 03:54:43 2011][003755][EUCADEBUG ] doDescribeResource() invoked
[Thu Jun 16 03:54:43 2011][003755][EUCADEBUG ] doDescribeInstances() invoked
[Thu Jun 16 03:54:49 2011][003755][EUCADEBUG ] doDescribeResource() invoked
[Thu Jun 16 03:54:49 2011][003755][EUCADEBUG ] doDescribeInstances() invoked
[Thu Jun 16 03:54:55 2011][003755][EUCADEBUG ] doDescribeResource() invoked
[Thu Jun 16 03:54:55 2011][003755][EUCADEBUG ] doDescribeInstances() invoked
[Thu Jun 16 03:55:01 2011][003755][EUCADEBUG ] doDescribeResource() invoked
[Thu Jun 16 03:55:01 2011][003755][EUCADEBUG ] doDescribeInstances() invoked
[Thu Jun 16 03:55:07 2011][003755][EUCADEBUG ] doDescribeResource() invoked
[Thu Jun 16 03:55:07 2011][003755][EUCADEBUG ] doDescribeInstances() invoked
[Thu Jun 16 03:55:13 2011][003755][EUCAERROR ] libvirt: monitor socket did
not show up.: No such file or directory (code=38)
[Thu Jun 16 03:55:13 2011][003755][EUCAFATAL ] hypervisor failed to start
domain
[Thu Jun 16 03:55:13 2011][003755][EUCADEBUG ] doDescribeResource() invoked
[Thu Jun 16 03:55:13 2011][003755][EUCADEBUG ] doDescribeInstances() invoked
[Thu Jun 16 03:55:15 2011][003755][EUCAERROR ] libvirt: Domain not found: no
domain with matching name 'i-4C9D08C3' (code=42)
[Thu Jun 16 03:55:15 2011][003755][EUCAINFO  ] vrun(): [rm -rf
/var/lib/eucalyptus/instances//admin/i-4C9D08C3/]
[Thu Jun 16 03:55:15 2011][003755][EUCAINFO  ] stopping the network
(vlan=10)
[Thu Jun 16 03:55:19 2011][003755][EUCADEBUG ] doDescribeResource() invoked
[Thu Jun 16 03:55:19 2011][003755][EUCADEBUG ] doDescribeInstances() invoked
[Thu Jun 16 03:55:25 2011][003755][EUCADEBUG ] doDescribeResource() invoked
[Thu Jun 16 03:55:25 2011][003755][EUCADEBUG ] doDescribeInstances() invoked
[Thu Jun 16 03:55:26 2011][003755][EUCAINFO  ] doTerminateInstance() invoked
(id=i-4C9D08C3)
[Thu Jun 16 03:55:26 2011][003755][EUCAERROR ] libvirt: Domain not found: no
domain with matching name 'i-4C9D08C3' (code=42)
[Thu Jun 16 03:55:26 2011][003755][EUCAWARN  ] warning: domain i-4C9D08C3 to
be terminated not running on hypervisor
[Thu Jun 16 03:55:31 2011][003755][EUCADEBUG ] doDescribeResource() invoked
[Thu Jun 16 03:55:31 2011][003755][EUCADEBUG ] doDescribeInstances() invoked


 /var/log/libvirt/qemu/i-4C9D08C3.log:


LC_ALL=C PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin
/usr/bin/kvm -S -M pc-0.12 -enable-kvm -m 512 -smp 2 -name i-3D4B085B -uuid
68e17542-66cb-0240-81f5-d71c935e5a5e -nographic -chardev
socket,id=monitor,path=/var/lib/libvirt/qemu/i-3D4B085B.monitor,server,nowait
-monitor chardev:monitor -boot c -kernel
/var/lib/eucalyptus/instances//admin/i-3D4B085B/kernel -initrd
/var/lib/eucalyptus/instances//admin/i-3D4B085B/ramdisk -append
root=/dev/sda1 console=ttyS0 -drive
file=/var/lib/eucalyptus/instances//admin/i-3D4B085B/disk,if=scsi,index=0,boot=on,format=raw
-net nic,macaddr=d0:0d:3d:4b:08:5b,vlan=0,model=e1000,name=e1000.0 -net
tap,fd=44,vlan=0,name=tap.0 -chardev
file,id=serial0,path=/var/lib/eucalyptus/instances//admin/i-3D4B085B/console.log
-serial chardev:serial0 -parallel none -usb

libvir: QEMU error : cannot set ownership on
/var/lib/eucalyptus/instances//admin/i-3D4B085B/kernel: Permission denied


more info:

qemu user/group is eucalyptus/root


I noticed that soem process (libvirt or qemu) is changing the ownership
before termination:

Before and after:

   1.  ll /var/lib/eucalyptus/instances//admin/i-3D4B085B/
   2. total 715912K
   3. -rw-r--r-- 1 eucalyptus eucalyptus 10767826944 2011-06-16 04:01 disk
   4. -rw------- 1 eucalyptus eucalyptus      571064 2011-06-16 04:01
   instance-checkpoint
   5. -rw-r--r-- 1 eucalyptus eucalyptus     4159008 2011-06-16 03:09 kernel
   6. -rw-r--r-- 1 eucalyptus eucalyptus         933 2011-06-16 04:01
   libvirt.xml
   7. -rw-r--r-- 1 eucalyptus eucalyptus     3899035 2011-06-16 03:09
   ramdisk
   8.
   9.  ll /var/lib/eucalyptus/instances//admin/i-3D4B085B/
   10. total 715912K
   11. -rw-r--r-- 1 root       root       10767826944 2011-06-16 04:01 disk
   12. -rw------- 1 eucalyptus eucalyptus      571064 2011-06-16 04:01
   instance-checkpoint
   13. -rw-r--r-- 1 root       root           4159008 2011-06-16 03:09
   kernel
   14. -rw-r--r-- 1 eucalyptus eucalyptus         933 2011-06-16 04:01
   libvirt.xml
   15. -rw-r--r-- 1 root       root           3899035 2011-06-16 03:09
   ramdisk


additional info:

 ls -al /var/lib/eucalyptus
total 24K
drwxr-xr-x  5 eucalyptus eucalyptus 4096 2011-06-16 03:34 .
drwxr-xr-x 43 root       root       4096 2011-06-16 02:29 ..
-rw-------  1 eucalyptus eucalyptus   16 2011-06-16 03:34 .bash_history
drwx------  2 eucalyptus eucalyptus 4096 2011-06-16 02:52 .cache
lrwxrwxrwx  1 eucalyptus eucalyptus   14 2011-06-16 02:49 instances -&gt;
/mnt/instances
drwx------  2 eucalyptus eucalyptus 4096 2011-06-16 02:52 keys
drwxr-xr-x  2 eucalyptus root       4096 2011-06-16 02:43 .ssh

ls -al /mnt/instances
total 16K
drwxrwxrwx 4 eucalyptus eucalyptus 4096 2011-06-16 03:09 .
drwxr-xr-x 5 eucalyptus eucalyptus 4096 2011-06-16 02:25 ..
drwxr-xr-x 2 eucalyptus eucalyptus 4096 2011-06-16 04:02 admin
drwxr-xr-x 3 eucalyptus eucalyptus 4096 2011-06-16 03:09 eucalyptus



Is there any solution to this problem? A workaround also works. Thanks


Best,
Ali

[Attachment #3 (text/html)]

Hello everybody,&lt;br&gt;&lt;br&gt;I installed eucalyptus on ubuntu10, basic configuration . \
Everything is ok untill I start the instances, the disk is being created but it \
terminates soon.&lt;br&gt;&lt;br&gt;Environment:&lt;br&gt;NFS , KVM, ubuntu10 x64, Euca on 2 machines \
(wc sc cc clc on one machine, and nc on another).&lt;br&gt; libvirtd (libvirt) \
0.7.5&lt;br&gt;QEMU PC emulator version 0.12.3 (qemu-kvm-0.12.3), Copyright (c) 2003-2008 \
Fabrice Bellard.&lt;br&gt;&lt;br&gt;Logs:&lt;br&gt;/var/log/eucalyptus/nc.log:&lt;br&gt;&lt;br&gt;[Thu Jun 16 \
03:54:31 2011][003755][EUCADEBUG ] doStartNetwork() invoked&lt;br&gt; [Thu Jun 16 03:54:31 \
2011][003755][EUCAINFO  ] StartNetwork(): SUCCESS return from vnetStartNetwork \
0&lt;br&gt;[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ] StartNetwork(): done&lt;br&gt;[Thu Jun \
16 03:54:31 2011][003755][EUCAINFO  ] doRunInstance() invoked (id=i-4C9D08C3 cores=2 \
disk=10 memory=512)&lt;br&gt; [Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ]                \
image=emi-DDBD105C at &lt;a \
href="http://10.1.1.2:8773/services/Walrus/image-store-1308215076/image.manifest.xml"&gt; \
http://10.1.1.2:8773/services/Walrus/image-store-1308215076/image.manifest.xml&lt;/a&gt;&lt;br&gt;
 [Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ]                          \
krnel=eki-F41F10E3 at &lt;a \
href="http://10.1.1.2:8773/services/Walrus/image-store-1308215076/kernel.manifest.xml" \
&gt;http://10.1.1.2:8773/services/Walrus/image-store-1308215076/kernel.manifest.xml&lt;/a&gt;&lt;br&gt;
&gt; 
[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ]                          \
rmdsk=eri-08841148 at &lt;a \
href="http://10.1.1.2:8773/services/Walrus/image-store-1308215076/ramdisk.manifest.xml \
"&gt;http://10.1.1.2:8773/services/Walrus/image-store-1308215076/ramdisk.manifest.xml&lt;/a&gt;&lt;br&gt;
 [Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ]                          vlan=10 \
priMAC=d0:0d:4C:9D:08:C3 pubMAC=d0:0d:4C:9D:08:C3&lt;br&gt;[Thu Jun 16 03:54:31 \
2011][003755][EUCAINFO  ] network started for instance i-4C9D08C3&lt;br&gt; [Thu Jun 16 \
03:54:31 2011][003755][EUCAINFO  ] retrieving images for instance i-4C9D08C3 (disk \
limit=10240MB)...&lt;br&gt;[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ] verifying cached \
file in /var/lib/eucalyptus/instances//eucalyptus/cache/eki-F41F10E3/kernel...&lt;br&gt; \
[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ] walrus_request(): downloading \
/tmp/walrus-digest-3D4AKY&lt;br&gt;[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ]           \
from &lt;a href="http://10.1.1.2:8773/services/Walrus/image-store-1308215076/kernel.manif \
est.xml"&gt;http://10.1.1.2:8773/services/Walrus/image-store-1308215076/kernel.manifest.xml&lt;/a&gt;&lt;br&gt;
 [Thu Jun 16 03:54:31 2011][003755][EUCADEBUG ] walrus_request(): writing GET output \
to /tmp/walrus-digest-3D4AKY&lt;br&gt;[Thu Jun 16 03:54:31 2011][003755][EUCADEBUG ] \
walrus_request(): wrote 3479 bytes in 3 writes&lt;br&gt;[Thu Jun 16 03:54:31 \
2011][003755][EUCAINFO  ] walrus_request(): saved image in \
/tmp/walrus-digest-3D4AKY&lt;br&gt; [Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ] vrun(): \
[cp -a /var/lib/eucalyptus/instances//eucalyptus/cache/eki-F41F10E3/kernel \
/var/lib/eucalyptus/instances//admin/i-4C9D08C3/ker&lt;br&gt;nel]&lt;br&gt;[Thu Jun 16 03:54:31 \
2011][003755][EUCAINFO  ] verifying cached file in \
/var/lib/eucalyptus/instances//eucalyptus/cache/eri-08841148/ramdisk...&lt;br&gt; [Thu Jun \
16 03:54:31 2011][003755][EUCAINFO  ] walrus_request(): downloading \
/tmp/walrus-digest-sVEVa4&lt;br&gt;[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ]           \
from &lt;a href="http://10.1.1.2:8773/services/Walrus/image-store-1308215076/ramdisk.mani \
fest.xml"&gt;http://10.1.1.2:8773/services/Walrus/image-store-1308215076/ramdisk.manifest.xml&lt;/a&gt;&lt;br&gt;
 [Thu Jun 16 03:54:31 2011][003755][EUCADEBUG ] walrus_request(): writing GET output \
to /tmp/walrus-digest-sVEVa4&lt;br&gt;[Thu Jun 16 03:54:31 2011][003755][EUCADEBUG ] \
walrus_request(): wrote 3482 bytes in 3 writes&lt;br&gt;[Thu Jun 16 03:54:31 \
2011][003755][EUCAINFO  ] walrus_request(): saved image in \
/tmp/walrus-digest-sVEVa4&lt;br&gt; [Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ] vrun(): \
[cp -a /var/lib/eucalyptus/instances//eucalyptus/cache/eri-08841148/ramdisk \
/var/lib/eucalyptus/instances//admin/i-4C9D08C3/ramdisk]&lt;br&gt;[Thu Jun 16 03:54:31 \
2011][003755][EUCAINFO  ] verifying cached file in \
/var/lib/eucalyptus/instances//eucalyptus/cache/emi-DDBD105C/disk...&lt;br&gt; [Thu Jun 16 \
03:54:31 2011][003755][EUCAINFO  ] walrus_request(): downloading \
/tmp/walrus-digest-RQEzI9&lt;br&gt;[Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ]           \
from &lt;a href="http://10.1.1.2:8773/services/Walrus/image-store-1308215076/image.manife \
st.xml"&gt;http://10.1.1.2:8773/services/Walrus/image-store-1308215076/image.manifest.xml&lt;/a&gt;&lt;br&gt;
 [Thu Jun 16 03:54:31 2011][003755][EUCADEBUG ] walrus_request(): writing GET output \
to /tmp/walrus-digest-RQEzI9&lt;br&gt;[Thu Jun 16 03:54:31 2011][003755][EUCADEBUG ] \
walrus_request(): wrote 5887 bytes in 5 writes&lt;br&gt;[Thu Jun 16 03:54:31 \
2011][003755][EUCAINFO  ] walrus_request(): saved image in \
/tmp/walrus-digest-RQEzI9&lt;br&gt; [Thu Jun 16 03:54:31 2011][003755][EUCAINFO  ] vrun(): \
[cp -a /var/lib/eucalyptus/instances//eucalyptus/cache/emi-DDBD105C/disk \
/var/lib/eucalyptus/instances//admin/i-4C9D08C3/disk]&lt;br&gt;[Thu Jun 16 03:54:32 \
2011][003755][EUCAINFO  ] vrun(): [//usr/lib/eucalyptus/euca_rootwrap \
//usr/share/eucalyptus/partition2disk \
/var/lib/eucalyptus/instances//admin/i-4C9D08C3/disk 512 8280]&lt;br&gt; [Thu Jun 16 \
03:54:37 2011][003755][EUCADEBUG ] doDescribeResource() invoked&lt;br&gt;[Thu Jun 16 \
03:54:37 2011][003755][EUCADEBUG ] doDescribeInstances() invoked&lt;br&gt;[Thu Jun 16 \
03:54:43 2011][003755][EUCAINFO  ] preparing images for instance i-4C9D08C3...&lt;br&gt; \
[Thu Jun 16 03:54:43 2011][003755][EUCAINFO  ] adding key/tmp/sckey.uUHVTI to the \
root file system at /var/lib/eucalyptus/instances//admin/i-4C9D08C3/disk using \
(//usr/lib/eucalyptus/euca_rootwrap //usr/share/eucalyptus/&lt;a \
href="http://add_key.pl"&gt;add_key.pl&lt;/a&gt; //usr/lib/eucalyptus/euca_mountwrap)&lt;br&gt; [Thu \
Jun 16 03:54:43 2011][003755][EUCAINFO  ] vrun(): [//usr/lib/eucalyptus/euca_rootwrap \
//usr/share/eucalyptus/&lt;a href="http://add_key.pl"&gt;add_key.pl&lt;/a&gt; \
//usr/lib/eucalyptus/euca_mountwrap 32256 \
/var/lib/eucalyptus/instances//admin/i-4C9D08C3/disk /tmp/sckey.uUHVTI]&lt;br&gt; [Thu Jun \
16 03:54:43 2011][003755][EUCADEBUG ] system_output(): \
[//usr/lib/eucalyptus/euca_rootwrap //usr/share/eucalyptus/gen_kvm_libvirt_xml \
--ramdisk --ephemeral]&lt;br&gt;[Thu Jun 16 03:54:43 2011][003755][EUCAINFO  ] currently \
running/booting:  i-4C9D08C3&lt;br&gt; [Thu Jun 16 03:54:43 2011][003755][EUCADEBUG ] \
doDescribeResource() invoked&lt;br&gt;[Thu Jun 16 03:54:43 2011][003755][EUCADEBUG ] \
doDescribeInstances() invoked&lt;br&gt;[Thu Jun 16 03:54:49 2011][003755][EUCADEBUG ] \
doDescribeResource() invoked&lt;br&gt; [Thu Jun 16 03:54:49 2011][003755][EUCADEBUG ] \
doDescribeInstances() invoked&lt;br&gt;[Thu Jun 16 03:54:55 2011][003755][EUCADEBUG ] \
doDescribeResource() invoked&lt;br&gt;[Thu Jun 16 03:54:55 2011][003755][EUCADEBUG ] \
doDescribeInstances() invoked&lt;br&gt; [Thu Jun 16 03:55:01 2011][003755][EUCADEBUG ] \
doDescribeResource() invoked&lt;br&gt;[Thu Jun 16 03:55:01 2011][003755][EUCADEBUG ] \
doDescribeInstances() invoked&lt;br&gt;[Thu Jun 16 03:55:07 2011][003755][EUCADEBUG ] \
doDescribeResource() invoked&lt;br&gt; [Thu Jun 16 03:55:07 2011][003755][EUCADEBUG ] \
doDescribeInstances() invoked&lt;br&gt;[Thu Jun 16 03:55:13 2011][003755][EUCAERROR ] \
libvirt: monitor socket did not show up.: No such file or directory (code=38)&lt;br&gt;[Thu \
Jun 16 03:55:13 2011][003755][EUCAFATAL ] hypervisor failed to start domain&lt;br&gt; [Thu \
Jun 16 03:55:13 2011][003755][EUCADEBUG ] doDescribeResource() invoked&lt;br&gt;[Thu Jun 16 \
03:55:13 2011][003755][EUCADEBUG ] doDescribeInstances() invoked&lt;br&gt;[Thu Jun 16 \
03:55:15 2011][003755][EUCAERROR ] libvirt: Domain not found: no domain with matching \
name 'i-4C9D08C3' (code=42)&lt;br&gt; [Thu Jun 16 03:55:15 2011][003755][EUCAINFO  \
] vrun(): [rm -rf /var/lib/eucalyptus/instances//admin/i-4C9D08C3/]&lt;br&gt;[Thu Jun 16 \
03:55:15 2011][003755][EUCAINFO  ] stopping the network (vlan=10)&lt;br&gt;[Thu Jun 16 \
03:55:19 2011][003755][EUCADEBUG ] doDescribeResource() invoked&lt;br&gt; [Thu Jun 16 \
03:55:19 2011][003755][EUCADEBUG ] doDescribeInstances() invoked&lt;br&gt;[Thu Jun 16 \
03:55:25 2011][003755][EUCADEBUG ] doDescribeResource() invoked&lt;br&gt;[Thu Jun 16 \
03:55:25 2011][003755][EUCADEBUG ] doDescribeInstances() invoked&lt;br&gt; [Thu Jun 16 \
03:55:26 2011][003755][EUCAINFO  ] doTerminateInstance() invoked \
(id=i-4C9D08C3)&lt;br&gt;[Thu Jun 16 03:55:26 2011][003755][EUCAERROR ] libvirt: Domain not \
found: no domain with matching name 'i-4C9D08C3' (code=42)&lt;br&gt; [Thu Jun 16 \
03:55:26 2011][003755][EUCAWARN  ] warning: domain i-4C9D08C3 to be terminated not \
running on hypervisor&lt;br&gt;[Thu Jun 16 03:55:31 2011][003755][EUCADEBUG ] \
doDescribeResource() invoked&lt;br&gt;[Thu Jun 16 03:55:31 2011][003755][EUCADEBUG ] \
doDescribeInstances() invoked&lt;br&gt; &lt;br&gt;&lt;br&gt; \
/var/log/libvirt/qemu/i-4C9D08C3.log:&lt;br&gt;&lt;br&gt;&lt;br&gt;LC_ALL=C \
PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin /usr/bin/kvm -S -M \
pc-0.12 -enable-kvm -m 512 -smp 2 -name i-3D4B085B -uuid \
68e17542-66cb-0240-81f5-d71c935e5a5e -nographic -chardev \
socket,id=monitor,path=/var/lib/libvirt/qemu/i-3D4B085B.monitor,server,nowait \
-monitor chardev:monitor -boot c -kernel \
/var/lib/eucalyptus/instances//admin/i-3D4B085B/kernel -initrd \
/var/lib/eucalyptus/instances//admin/i-3D4B085B/ramdisk -append root=/dev/sda1 \
console=ttyS0 -drive \
file=/var/lib/eucalyptus/instances//admin/i-3D4B085B/disk,if=scsi,index=0,boot=on,format=raw \
-net nic,macaddr=d0:0d:3d:4b:08:5b,vlan=0,model=e1000,name=e1000.0 -net \
tap,fd=44,vlan=0,name=tap.0 -chardev \
file,id=serial0,path=/var/lib/eucalyptus/instances//admin/i-3D4B085B/console.log \
-serial chardev:serial0 -parallel none -usb&lt;br&gt; &lt;br&gt;libvir: QEMU error : cannot set \
ownership on /var/lib/eucalyptus/instances//admin/i-3D4B085B/kernel: Permission \
denied&lt;br&gt;&lt;br&gt;&lt;br&gt;more info:&lt;br&gt;&lt;br&gt;qemu user/group is eucalyptus/root&lt;br&gt;&lt;br&gt;&lt;br&gt;I \
noticed that soem process (libvirt or qemu) is changing the ownership before \
termination:&lt;br&gt; &lt;br&gt;Before and after:&lt;br&gt;&lt;ol&gt;&lt;li class="li2"&gt;&lt;div class="de2"&gt; ll \
/var/lib/eucalyptus/instances//admin/i-3D4B085B/&lt;/div&gt;&lt;/li&gt;&lt;li class="li1"&gt;&lt;div \
class="de1"&gt;total 715912K&lt;/div&gt;&lt;/li&gt;&lt;li class="li2"&gt;&lt;div class="de2"&gt;-rw-r--r-- 1 \
eucalyptus eucalyptus 10767826944 2011-06-16 04:01 disk&lt;/div&gt; &lt;/li&gt;&lt;li \
class="li1"&gt;&lt;div class="de1"&gt;-rw------- 1 eucalyptus eucalyptus      571064 \
2011-06-16 04:01 instance-checkpoint&lt;/div&gt;&lt;/li&gt;&lt;li class="li2"&gt;&lt;div \
class="de2"&gt;-rw-r--r-- 1 eucalyptus eucalyptus     4159008 2011-06-16 03:09 \
kernel&lt;/div&gt; &lt;/li&gt;&lt;li class="li1"&gt;&lt;div class="de1"&gt;-rw-r--r-- 1 eucalyptus eucalyptus \
933 2011-06-16 04:01 libvirt.xml&lt;/div&gt;&lt;/li&gt;&lt;li class="li2"&gt;&lt;div \
class="de2"&gt;-rw-r--r-- 1 eucalyptus eucalyptus     3899035 2011-06-16 03:09 \
ramdisk&lt;/div&gt; &lt;/li&gt;&lt;li class="li2"&gt;&lt;br&gt;&lt;/li&gt;&lt;li class="li1"&gt;&lt;div class="de1"&gt; ll \
/var/lib/eucalyptus/instances//admin/i-3D4B085B/&lt;/div&gt;&lt;/li&gt;&lt;li class="li2"&gt;&lt;div \
class="de2"&gt;total 715912K&lt;/div&gt;&lt;/li&gt;&lt;li class="li1"&gt;&lt;div class="de1"&gt;-rw-r--r-- 1 \
root       root       10767826944 2011-06-16 04:01 disk&lt;/div&gt; &lt;/li&gt;&lt;li \
class="li2"&gt;&lt;div class="de2"&gt;-rw------- 1 eucalyptus eucalyptus      571064 \
2011-06-16 04:01 instance-checkpoint&lt;/div&gt;&lt;/li&gt;&lt;li class="li1"&gt;&lt;div \
class="de1"&gt;-rw-r--r-- 1 root       root           4159008 2011-06-16 03:09 \
kernel&lt;/div&gt; &lt;/li&gt;&lt;li class="li2"&gt;&lt;div class="de2"&gt;-rw-r--r-- 1 eucalyptus eucalyptus \
933 2011-06-16 04:01 libvirt.xml&lt;/div&gt;&lt;/li&gt;&lt;li class="li1"&gt;&lt;div \
class="de1"&gt;-rw-r--r-- 1 root       root           3899035 2011-06-16 03:09 \
ramdisk&lt;/div&gt; &lt;/li&gt;&lt;/ol&gt;&lt;br&gt;additional info:&lt;br&gt;&lt;br&gt; ls -al \
/var/lib/eucalyptus&lt;br&gt;total 24K&lt;br&gt;drwxr-xr-x  5 eucalyptus eucalyptus 4096 \
2011-06-16 03:34 .&lt;br&gt;drwxr-xr-x 43 root       root       4096 2011-06-16 02:29 \
..&lt;br&gt;-rw-------  1 eucalyptus eucalyptus   16 2011-06-16 03:34 .bash_history&lt;br&gt; \
drwx------  2 eucalyptus eucalyptus 4096 2011-06-16 02:52 .cache&lt;br&gt;lrwxrwxrwx  1 \
eucalyptus eucalyptus   14 2011-06-16 02:49 instances -&gt; \
/mnt/instances&lt;br&gt;drwx------  2 eucalyptus eucalyptus 4096 2011-06-16 02:52 keys&lt;br&gt; \
drwxr-xr-x  2 eucalyptus root       4096 2011-06-16 02:43 .ssh&lt;br&gt;&lt;br&gt;ls -al \
/mnt/instances&lt;br&gt;total 16K&lt;br&gt;drwxrwxrwx 4 eucalyptus eucalyptus 4096 2011-06-16 \
03:09 .&lt;br&gt;drwxr-xr-x 5 eucalyptus eucalyptus 4096 2011-06-16 02:25 ..&lt;br&gt; drwxr-xr-x \
2 eucalyptus eucalyptus 4096 2011-06-16 04:02 admin&lt;br&gt;drwxr-xr-x 3 eucalyptus \
eucalyptus 4096 2011-06-16 03:09 eucalyptus&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;Is there any solution to \
this problem? A workaround also works. Thanks&lt;br&gt; &lt;br&gt;&lt;br&gt;Best,&lt;br&gt;Ali&lt;br&gt;&lt;br&gt;



</body></email><email><emailId>20110616105830</emailId><senderName></senderName><senderEmail>arun.sasi1@wipro.com</senderEmail><timestampReceived>2011-06-16 10:58:30-0400</timestampReceived><subject>Re: [libvirt-users] Base server as file server.</subject><body>

No here my scenario is 

File server is in Base server.
Ldap,DNS,DHCP is in KVM-VM

So I want to know what will be the my file server performance.

My confusion.
Installed KVM on file server. So all paging and memory will allocate to Vm`s...

Thanks,
-Arun

-----Original Message-----
From: Stefan Hajnoczi [mailto:stefanha@linux.vnet.ibm.com] 
Sent: Thursday, June 16, 2011 4:07 PM
To: Arun Sasi V (WI01 - Manage IT)
Cc: stefanha@gmail.com; qemu-devel@nongnu.org; libvirt-users@redhat.com
Subject: Re: Base server as file server.

On Thu, Jun 16, 2011 at 03:26:25PM +0530, arun.sasi1@wipro.com wrote:
&gt; Will I get complete performance on file server since it is in Base
&gt; server where KVM kernel installed...

Yes, applications running on the host will performance as normal.
Remember that virtual machines consume CPU, memory, and other resources
too though.  That means busy VMs can affect application performance on
the host.

Stefan

</body></email><email><emailId>20110616110439</emailId><senderName>Jérémie_Tarot</senderName><senderEmail>silopolis@gmail.com</senderEmail><timestampReceived>2011-06-16 11:04:39-0400</timestampReceived><subject>Re: [libvirt-users] Virtual switches support (Openvswitch, VDE, ...)</subject><body>

Hi,

2011/6/15 Daniel Veillard &lt;veillard@redhat.com&gt;

&gt; On Wed, Jun 01, 2011 at 09:50:45AM +0200, J=E9r=E9mie Tarot wrote:
&gt; &gt; Hi,
&gt; &gt;
&gt; &gt; IIR/UC there have been a couple of discussions lately about possible
&gt; &gt; evolution of libvirt's network management features to eventually suppor=
t
&gt; &gt; more kinds of virtual networking technologies like Openvswitch, VDE,...
&gt; &gt;
&gt; &gt; Could a kind and informed soul keep us on touch with progress in the
&gt; field ?
&gt; &gt;
&gt; &gt; Thank you very much in advance
&gt;
&gt;  Well here is the opportunity to give feedback, Laine just sent version 3
&gt; of his proposal (on the libvir-list the developper one)
&gt;  https://www.redhat.com/archives/libvir-list/2011-June/msg00471.html
&gt; please have a look and tell us if you think it would be fine
&gt;
&gt;
Thank you very much for the heads up. Will read it carefully and try to giv=
e
valuable feedback...
Hoping I didn't broke any good behaviour, I posted a message on Openvswitch
ML to tell the community about this. You can find the message here:

 http://openvswitch.org/pipermail/discuss/2011-June/005302.html

 thanks in advance,
&gt;

Thank _you_


&gt; &gt; PS: I wish this will be available before/for 1.0 release...
&gt;
&gt;   hopefully yes :-)
&gt;

/me shivers

Jeremie

[Attachment #3 (text/html)]

Hi,&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;2011/6/15 Daniel Veillard &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:veillard@redhat.com"&gt;veillard@redhat.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, \
204, 204); padding-left: 1ex;"&gt; &lt;div class="im"&gt;On Wed, Jun 01, 2011 at 09:50:45AM \
+0200, Jérémie Tarot wrote:&lt;br&gt; &gt; Hi,&lt;br&gt;
&gt;&lt;br&gt;
&gt; IIR/UC there have been a couple of discussions lately about possible&lt;br&gt;
&gt; evolution of libvirt's network management features to eventually support&lt;br&gt;
&gt; more kinds of virtual networking technologies like Openvswitch, VDE,...&lt;br&gt;
&gt;&lt;br&gt;
&gt; Could a kind and informed soul keep us on touch with progress in the field ?&lt;br&gt;
&gt;&lt;br&gt;
&gt; Thank you very much in advance&lt;br&gt;
&lt;br&gt;
&lt;/div&gt; Well here is the opportunity to give feedback, Laine just sent version 3&lt;br&gt;
of his proposal (on the libvir-list the developper one)&lt;br&gt;
  &lt;a href="https://www.redhat.com/archives/libvir-list/2011-June/msg00471.html" \
target="_blank"&gt;https://www.redhat.com/archives/libvir-list/2011-June/msg00471.html&lt;/a&gt;&lt;br&gt;
 please have a look and tell us if you think it would be fine&lt;br&gt;
&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Thank you very much for the heads up. Will read it \
carefully and try to give valuable feedback...&lt;br&gt;Hoping I didn't broke any good \
behaviour, I posted a message on Openvswitch ML to tell the community about this. You \
can find the message here:&lt;br&gt; &lt;br&gt; &lt;a \
href="http://openvswitch.org/pipermail/discuss/2011-June/005302.html"&gt;http://openvswitch.org/pipermail/discuss/2011-June/005302.html&lt;/a&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote \
class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, \
204, 204); padding-left: 1ex;"&gt;

  thanks in advance,&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Thank _you_ &lt;br&gt;&lt;/div&gt;&lt;div&gt; \
&lt;/div&gt;&lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: \
1px solid rgb(204, 204, 204); padding-left: 1ex;"&gt;&lt;div class="im"&gt;

&gt; PS: I wish this will be available before/for 1.0 release...&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;  hopefully yes :-)&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;/me \
shivers&lt;br&gt;&lt;br&gt;Jeremie&lt;/div&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110616113017</emailId><senderName>Nicolas Sebrecht</senderName><senderEmail>nsebrecht@piing.fr</senderEmail><timestampReceived>2011-06-16 11:30:17-0400</timestampReceived><subject>[libvirt-users] Re: 2 virsh consoles on the same hypervisor causes conflicts</subject><body>

The 16/06/11, Daniel P. Berrange wrote:
&gt; On Wed, Jun 15, 2011 at 01:43:14PM -0400, David Lane wrote:
&gt; &gt; Anyone encountered this?  Anyone have a solution?  Seeing it in Fedora15
&gt; &gt; with KVM
&gt; &gt; 
&gt; &gt; If 2 consoles are opened to the same guest from the hypervisor they will
&gt; &gt; interfere with each other.  keystrokes are lost and returned information is
&gt; &gt; displayed on either virsh console instances randomly.  Both consoles are
&gt; &gt; rendered unusable.
&gt; 
&gt; Yeah, this is normal - only one client can access /dev/pts/XXX devices
&gt; at a time, otherwise it just all goes wrong.

Then, what's not normal is that virsh allows to connect more than once.

-- 
Nicolas Sebrecht

</body></email><email><emailId>20110617005721</emailId><senderName>Abhishek Gupta</senderName><senderEmail>abhishekgupta.iitd@gmail.com</senderEmail><timestampReceived>2011-06-17 00:57:21-0400</timestampReceived><subject>[libvirt-users] Virsh Console - Changes in guest</subject><body>

Hello

Virsh Console was not working on my setup. (also it required ctrl +
shift + ] instead of ctrl+alt+] for interrupt)

But after I create a file /etc/init/ttyS0.conf

  # ttyS0 - getty
  #
  # This service maintains a getty on ttyS0 from the point the system is
  # started until it is shut down again.

  start on stopped rc RUNLEVEL=[2345]
  stop on runlevel [!2345]

  respawn
  exec /sbin/getty -L 38400 ttyS0 vt102

Reload libvirt-bin, and restart the vm the console starts working.

Is there any other way of doing this without the need of changing the
guest files and independent of guest OS?

I am using libvirt version 0.8.8.

--
Abhishek
abhishekgupta92.info

</body></email><email><emailId>20110617170009</emailId><senderName>Jerry Worley</senderName><senderEmail>jworley@wiche.edu</senderEmail><timestampReceived>2011-06-17 17:00:09-0400</timestampReceived><subject>[libvirt-users] basic network setup</subject><body>

I am setting up a network with 2 guests, each on different subnets. The phy=
sical machine has 2 NICS, one on each subnet. I want the physical and guest=
 machines to have IP addresses with no NAT, in their respective subnets, an=
d then I want a separate subnet where the 2 guests can connect directly to =
each other. Can somebody explain conceptually the best way to use physical =
adapters, bridges, virtual bridges, virtual networks to accomplish this.

[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;&lt;head&gt;&lt;meta http-equiv=Content-Type \
content="text/html; charset=us-ascii"&gt;&lt;meta name=Generator content="Microsoft Word 12 \
(filtered medium)"&gt;&lt;style&gt;&lt;!-- /* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
--&gt;&lt;/style&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapelayout v:ext="edit"&gt;
&lt;o:idmap v:ext="edit" data="1" /&gt;
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;&lt;/head&gt;&lt;body lang=EN-US link=blue vlink=purple&gt;&lt;div \
class=WordSection1&gt;&lt;p class=MsoNormal&gt;I am setting up a network with 2 guests, each \
on different subnets. The physical machine has 2 NICS, one on each subnet. I want the \
physical and guest machines to have IP addresses with no NAT, in their respective \
subnets, and then I want a separate subnet where the 2 guests can connect directly to \
each other. Can somebody explain conceptually the best way to use physical adapters, \
bridges, virtual bridges, virtual networks to accomplish \
this.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20110618092917</emailId><senderName>Lorenzo Milesi</senderName><senderEmail>maxxer@ufficyo.com</senderEmail><timestampReceived>2011-06-18 09:29:17-0400</timestampReceived><subject>[libvirt-users] Problems migrating xen domains</subject><body>

Hi.

I've set up a cluster with two Debian 6 nodes, running Xen 4 and libvirt 0.9 (from \
backports). My VMs run over a DRBD resource, to allow live migration between the \
nodes. 

I've successfully tried live migration using xm migrate, now I'd like to make it work \
using virsh, but cannot make it. Here's the error I'm getting:

# virsh migrate  efw xen+ssh://10.22.22.152/
error: POST operation failed: xend_post: error from xen daemon: (xend.err "can't \
connect: (-2, 'Name or service not known')")

As said, xm migrate worked at first, so xend should be set up correctly.
I've done several searches but with no luck.

What could be the problem?
thanks

Relevant configs:

# cat /etc/xen/xend-config.sxp |grep -v ^#|grep -v ^$
(xend-http-server yes)
(xend-unix-server yes)
(xend-relocation-server yes)
(xend-port            8000)
(xend-relocation-port 8002)
(vif-script vif-bridge)
(dom0-min-mem 196)
(enable-dom0-ballooning yes)
(total_available_memory 0) 
(dom0-cpus 0)
(vncpasswd '')


# env|grep VIRSH_DEFAULT_CONNECT_URI 
VIRSH_DEFAULT_CONNECT_URI=xen:///


root@xensrv01:~# virsh version
Compiled against library: libvir 0.9.0
Using library: libvir 0.9.0
Using API: Xen 3.0.1
Running hypervisor: Xen 4.0.0


</body></email><email><emailId>20110618111010</emailId><senderName>Lorenzo Milesi</senderName><senderEmail>maxxer@ufficyo.com</senderEmail><timestampReceived>2011-06-18 11:10:10-0400</timestampReceived><subject>Re: [libvirt-users] virsh slow on execution</subject><body>

&gt; Also, when I start a VM via OCF, while guest is booting the command
&gt; virsh domstate mydom
&gt; returns "no state". This makes PaceMaker believe the resource is not
&gt; running and continuously stops and restart the machine.

I've let a shell open with virsh domstate mydom active in loop, and it seems that it \
returns the correct state one time once very much requests! Say over 20 requests, \
only one or two says "idle" or "running", all the others return "no state". I'd like \
to know why virsh fails so many times returning correct state... thanks


</body></email><email><emailId>20110620114922</emailId><senderName>Tom Hughes</senderName><senderEmail>tom@compton.nu</senderEmail><timestampReceived>2011-06-20 11:49:22-0400</timestampReceived><subject>[libvirt-users] Display port allocation</subject><body>

The automatic port allocation algorithm for displays in libvirt seems to 
assume that it is the only thing that will be allocating ports in the 
normal VNC range starting at port 5900.

My host is running vino to export it's display, which has bound itself 
to port 5900, yet libvirt is still trying to use port 5900 for both VNC 
and Spice displays if I leave it in auto allocation mode.

I thought that this used to work in F14 but having just tried it again 
it looks like I may have been mistaken.

Certainly it doesn't seem to work properly in F15 either with the 
standard libvirt or with the virt-preview one.

Tom

-- 
Tom Hughes (tom@compton.nu)
http://compton.nu/

</body></email><email><emailId>20110620120330</emailId><senderName>Lorenzo Milesi</senderName><senderEmail>maxxer@ufficyo.com</senderEmail><timestampReceived>2011-06-20 12:03:30-0400</timestampReceived><subject>[libvirt-users] Bypass USB to Xen VM</subject><body>

Hi. I'm trying to bypass an USB device from the host to a paravirtualized Xen VM.
I found this page:
http://libvirt.org/formatdomain.html#elementsUSB
which says how to bypass usb and pci devices to guests. It says that works on KVM \
only, but is that notice about PCI or about ALL?

Anyway I tried both from virt-manager and from virsh edit domain by adding the \
following:

    &lt;hostdev mode='subsystem' type='usb'&gt;
      &lt;source&gt;
        &lt;vendor id='0x03f0'/&gt;
        &lt;product id='0x0114'/&gt;
      &lt;/source&gt;
    &lt;/hostdev&gt;

but the edit is ignored, right after I save, if I do a dumpxml the "hostdev" stanza \
is not present.

Why? Any other way to bypass? usbip?

thanks


</body></email><email><emailId>20110620170227</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-06-20 17:02:27-0400</timestampReceived><subject>Re: [libvirt-users] libvirt-users Digest, Vol 18, Issue 17</subject><body>


On 06/20/2011 10:48 AM, m m wrote:
&gt; Yes, I also think that iptables module should be loaded before libvirt-bin

If you plan on replying, then it is better netiquette to keep your
replies in the same thread, and to set your subscription to non-digest
mode (replying to digests breaks threading and leaves a lousy subject
line which makes it impossible to easily see what thread you were
replying to).  Also, top-posting and full-quoting add a lot of noise;
it's wiser to trim the quoted content and make inline comments to just
the text you are replying to.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20110624104830</emailId><senderName>PLD</senderName><senderEmail>sa212+libvirt@cyconix.com</senderEmail><timestampReceived>2011-06-24 10:48:30-0400</timestampReceived><subject>Re: [libvirt-users] Starting libvirtd cuts off host access to external network</subject><body>

Thanks Daniel - that's fixed the problem.

-Paul

</body></email><email><emailId>20110630113448</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2011-06-30 11:34:48-0400</timestampReceived><subject>[libvirt-users] ANNOUNCE: libvirt Perl bindings Sys::Virt 0.2.8 release</subject><body>

I am happy to announce a new release[1] of the libvirt Perl bindings,
Sys::Virt 0.2.8 is available for download:

  http://search.cpan.org/CPAN/authors/id/D/DA/DANBERR/Sys-Virt-0.2.8.tar.gz

Changes in this release

 - Add all new APIs in libvirt 0.9.0
 - Add examples for different ways of using stream
   APIs to download/upload storage volumes
 - Requires libvirt &gt;= 0.9.0

The permanent link for the Sys::Virt package, where all historic releases
can be found, is

  http://search.cpan.org/dist/Sys-Virt/

Thanks to everyone who contributed to this release through testing, bug
reporting, patch submission, etc

Regards,
Daniel

[1] Yes, 2 releases in 2 days. I'm playing catchup with main libvirt
    releases and instead of going straight to latest one (0.9.2), I'm
    releasing Perl bindings for the 2 intermediate releases since those
    are needed in various distros. Guess what to expect tomorrow....
-- 
|: http://berrange.com      -o-    http://www.flickr.com/photos/dberrange/ :|
|: http://libvirt.org              -o-             http://virt-manager.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: http://entangle-photo.org       -o-       http://live.gnome.org/gtk-vnc :|

</body></email><email><emailId>20110630132655</emailId><senderName>Pete Ashdown</senderName><senderEmail>pashdown@xmission.com</senderEmail><timestampReceived>2011-06-30 13:26:55-0400</timestampReceived><subject>[libvirt-users] vnc over ssh failing</subject><body>

[Attachment #2 (multipart/alternative)]


I'm using virt-manager 0.8.6 client side on Ubuntu 11.04.  I can't get vnc
over ssh to work to a kvm guest running on a Ubuntu 10.04 host.

kvmhost:~&gt; virsh vncdisplay testing
:0

kvmhost:~&gt; telnet 127.0.0.1 5900
Trying 127.0.0.1...
Connected to 127.0.0.1.
Escape character is '^]'.
RFB 003.008

Client virt-manager debug:
2011-06-24 11:28:56,055 (console:923): Starting connect process for
proto=vnc trans=tcp connhost=192.168.1.10 connuser=pashdown connport=None
gaddr=127.0.0.1 gport=5900 gsocket=None
2011-06-24 11:28:56,120 (console:810): Viewer disconnected

I can reach the console with:
xtightvncviewer -via 192.168.1.10 127.0.0.1:0

Any suggestions are appreciated.


[Attachment #5 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
  &lt;head&gt;

    &lt;meta http-equiv="content-type" content="text/html; charset=ISO-8859-1"&gt;
  &lt;/head&gt;
  &lt;body bgcolor="#ffffff" text="#000000"&gt;
    &lt;font size="-1"&gt;&lt;font face="Helvetica, Arial, sans-serif"&gt;I'm using
        virt-manager 0.8.6 client side on Ubuntu 11.04.  I can't get vnc
        over ssh to work to a kvm guest running on a Ubuntu 10.04 host.&lt;br&gt;
        &lt;br&gt;
        kvmhost:~&gt; virsh vncdisplay testing&lt;br&gt;
        :0&lt;br&gt;
        &lt;br&gt;
        kvmhost:~&gt; telnet 127.0.0.1 5900&lt;br&gt;
        Trying 127.0.0.1...&lt;br&gt;
        Connected to 127.0.0.1.&lt;br&gt;
        Escape character is '^]'.&lt;br&gt;
        RFB 003.008&lt;br&gt;
        &lt;br&gt;
        Client virt-manager debug:&lt;br&gt;
        2011-06-24 11:28:56,055 (console:923): Starting connect process
        for proto=vnc trans=tcp connhost=192.168.1.10 connuser=pashdown
        connport=None gaddr=127.0.0.1 gport=5900 gsocket=None&lt;br&gt;
        2011-06-24 11:28:56,120 (console:810): Viewer disconnected&lt;br&gt;
        &lt;br&gt;
        I can reach the console with:&lt;br&gt;
        xtightvncviewer -via 192.168.1.10 127.0.0.1:0&lt;br&gt;
        &lt;br&gt;
        Any suggestions are appreciated.&lt;br&gt;
        &lt;br&gt;
      &lt;/font&gt;&lt;/font&gt;
  &lt;/body&gt;
&lt;/html&gt;

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20110630212826</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2011-06-30 21:28:26-0400</timestampReceived><subject>[libvirt-users] ANNOUNCE: oz 0.5.0 release</subject><body>

All,
     I'm pleased to announce release 0.5.0 of Oz.  Oz is a program for doing
automated installation of guest operating systems with limited input from the
user.
     Release 0.5.0 is a bugfix and feature release for Oz.  Some of the
highlights between Oz 0.4.0 and 0.5.0 are:

- Replace icicle-nc binary with a shell script to try various methods.  Besides
being more portable, this also allows us to convert Oz to a noarch RPM (thanks
to Padraig Brady)
- Support for Ubuntu 6.06
- Support for md5sum/sha1sum/sha256sum checking of ISOs after download
- New -x flag for oz-install to write the libvirt XML file to a user-specified
location (thanks to Steve Dake)
- Support for OpenSUSE customization
- Support for F-15 customization (thanks to Steve Dake)
- Support for running commands at the end of package installation (thanks to
Steve Dake)

Fedora 14 and RHEL-6 packages are available for this release.  Note that to
install the RHEL-6 packages, you must be running RHEL-6.1 or later.
Instructions of how to get and use Oz are available at
http://aeolusproject.org/oz.html

If you have any questions or comments about Oz, please feel free to contact
aeolus-devel@lists.fedorahosted.org or me (clalance@redhat.com) directly.

-- 
Chris Lalancette

</body></email><email><emailId>20110512170650</emailId><senderName>David Ehle</senderName><senderEmail>ehle@agni.phys.iit.edu</senderEmail><timestampReceived>2011-05-12 17:06:50-0400</timestampReceived><subject>[libvirt-users]  Turn off AHCI? bad sectors?</subject><body>


I'm getting the 7b bluescreen when trying to bring up an imaged XP system 
for recovery.

Looks like possible cause is AHCI on VM if missing from original hardware, 
or visa versa.

Or moving to sata hard drive from pata... which shouldn't be applicable 
here.

Also during an earlier recovery attempt I ran gparted from an ubuntu live 
CD on the VM/disk image.  It gave me a Warning bad sector message.... the 
disk image is a qcow image. How can it have a bad sector?

Thanks all!

David.

</body></email><email><emailId>20110513042540</emailId><senderName>Emmanuel Noobadmin</senderName><senderEmail>centos.admin@gmail.com</senderEmail><timestampReceived>2011-05-13 04:25:40-0400</timestampReceived><subject>[libvirt-users] Fwd: Problems using virt-install to create KVM CentOS 5.6 guest</subject><body>

Let's try this again and see if it's gmail screwing up or am I just blacklisted.

---------- Forwarded message ----------
Date: Mon, 9 May 2011 15:13:08 +0800
Subject: Problems using virt-install to create KVM CentOS 5.6 guest
To: libvirt-users@redhat.com

I was having problems creating a KVM CentOS 5.6
Initially the host was CentOS 5.6 but I switched to Scientific Linux 6
during the process of trying to solve it. I was able to install a
working guest in the end by manually writing an XML and using virsh.

However, as it shouldn't be so complicated, Gleb over at the KVM list
asked me to share this with the libvirtd ML. I don't know it's an old
bug, since current libvirt seems to be several sub-versions ahead of
mine so decided to post to the user list first in case it's a known
bug. Hopefully somebody will be able to pinpoint what went wrong.

Host system: SL 6.0 with libvirtd (libvirt) 0.8.1
Network: 2 physical NICs, eth0 bridged to br0 for WAN connectivity,
eth1 is for internal use
Installation medium: CentOS 5.6 DVD ISO

Original problem
virt-install would simply not work, I get a blank console with nothing
happening and qemu-kvm will be 100% load on one core.

This was eventually traced to virt-install not being able to mount/use
the ISO. Mounting the ISO as loopback allowed the installation to
proceed.

However, the guest was not able to see the installation "cdrom". With
httpd running off the host, and tested accessibly via Internet, a
network install did not work either.

After much frustration, I followed the documentation at libvirt
website to write my own XML file.

The result of this was the discovery that

1. permissions on initrd.img and vmlinux was not allowing virsh access
- copying these files to disk and adjusting the xml allowed
installation to proceed. virt-install appears to do this on the fly.

2. virt-install guest could not see any disk. The anaconda installer
could not find any CDROM or hard disk.
- Part of the problem seems to be that virt-install did not save the
source for the installation medium, the generated XML did not have the
source information under the &lt;disk&gt; element. I specified this in my
manual XML and the CentOS guest was able to see the "cdrom" and
install properly. As I did not have any problem with missing hard
disks with my manually written XML so I'm not sure what went wrong
with virt-install's

3. Can't install via network
- This was traced to networking not working at all. Even in my manual
XML, networking did not work although the guest could install from the
disk. Eventually, this was solved by adding the &lt;model type='virtio'
/&gt; to the device definition.

</body></email><email><emailId>20110513075602</emailId><senderName></senderName><senderEmail>bhasker</senderEmail><timestampReceived>2011-05-13 07:56:02-0400</timestampReceived><subject>[libvirt-users] Booting from scsi</subject><body>

Hi all,

  I am starting up to use libvirt with virsh and virt-install. I used
virt-install successfully and have a running linux system with raw disk 
exported to the virtual machine as scsi. (the whole of qemu + libvirt + 
virtmanager is compiled and installed on /usr/local from source)

  After the virtual OS installation (which succeeds) I am not able to boot 
into the OS from the harddisk. Following are some excerpts from my xml 
file. Please get back to me if you need any more information


   &lt;os&gt;
     &lt;type arch='x86_64' machine='pc-0.14'&gt;hvm&lt;/type&gt;
     &lt;boot dev='hd'/&gt;
     &lt;bootmenu enable='yes'/&gt;
   &lt;/os&gt;

I also tried removing the boot parametes from &lt;os&gt; and added
&lt;boot order='1'/&gt; in the scsi disk section. Still I am not able to use the 
scsi disk to boot (my qemu-system-x86_64 however has the boot=on option)

     &lt;disk type='block' device='disk'&gt;
       &lt;driver name='qemu' type='raw'/&gt;
       &lt;source dev='/dev/venkatb1/deb'/&gt;
       &lt;target dev='sda' bus='scsi'/&gt;
       &lt;address type='drive' controller='0' bus='0' unit='0'/&gt;
     &lt;/disk&gt;

I could not find any more information or any posts where someone else had 
faced this issue. I presume I am doing something wrong here.
Can someone help please ?

thanks


Bhasker C V

</body></email><email><emailId>20110513154746</emailId><senderName></senderName><senderEmail>bhasker</senderEmail><timestampReceived>2011-05-13 15:47:46-0400</timestampReceived><subject>Re: [libvirt-users] Booting from scsi [SOLVED]</subject><body>

Fixed.
Changing the domain type from qemu to kvm fixes this

On Fri, 13 May 2011, bhasker@unixindia.com wrote:

&gt; Hi all,
&gt;
&gt; I am starting up to use libvirt with virsh and virt-install. I used
&gt; virt-install successfully and have a running linux system with raw disk 
&gt; exported to the virtual machine as scsi. (the whole of qemu + libvirt + 
&gt; virtmanager is compiled and installed on /usr/local from source)
&gt;
&gt; After the virtual OS installation (which succeeds) I am not able to boot 
&gt; into the OS from the harddisk. Following are some excerpts from my xml file. 
&gt; Please get back to me if you need any more information
&gt;
&gt;
&gt;  &lt;os&gt;
&gt;    &lt;type arch='x86_64' machine='pc-0.14'&gt;hvm&lt;/type&gt;
&gt;    &lt;boot dev='hd'/&gt;
&gt;    &lt;bootmenu enable='yes'/&gt;
&gt;  &lt;/os&gt;
&gt;
&gt; I also tried removing the boot parametes from &lt;os&gt; and added
&gt; &lt;boot order='1'/&gt; in the scsi disk section. Still I am not able to use the 
&gt; scsi disk to boot (my qemu-system-x86_64 however has the boot=on option)
&gt;
&gt;    &lt;disk type='block' device='disk'&gt;
&gt;      &lt;driver name='qemu' type='raw'/&gt;
&gt;      &lt;source dev='/dev/venkatb1/deb'/&gt;
&gt;      &lt;target dev='sda' bus='scsi'/&gt;
&gt;      &lt;address type='drive' controller='0' bus='0' unit='0'/&gt;
&gt;    &lt;/disk&gt;
&gt;
&gt; I could not find any more information or any posts where someone else had 
&gt; faced this issue. I presume I am doing something wrong here.
&gt; Can someone help please ?
&gt;
&gt; thanks
&gt;
&gt;
&gt; Bhasker C V
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

</body></email><email><emailId>20110515075416</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-05-15 07:54:16-0400</timestampReceived><subject>Re: [libvirt-users] Problem after restarting libvirt</subject><body>

于 2011年05月11日 15:23, Nikita A Menkovich 写道:
&gt; I could not find that cgroups are not persistent now. And there is no
&gt; such information in changelog.
&gt; Could you show me commit where it was changed?

AFAIK, persistent XML for cgroups is never supported, except the
current cpu.shares.

&gt;
&gt;
&gt; On 9 May 2011 15:50, Nikita A Menkovich&lt;menkovich@gmail.com&gt;  wrote:
&gt;&gt; It is really bad. Ok, I will write a script, that will set up cgroups
&gt;&gt; for every domain.
&gt;&gt;
&gt;&gt; On 9 May 2011 10:44, Osier Yang&lt;jyang@redhat.com&gt;  wrote:
&gt;&gt;&gt; 于 2011年05月05日 21:32, Nikita A Menkovich 写道:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; After restarting libvirt cgroups for VMs are not recovered.
&gt;&gt;&gt;&gt; Is there available to restore cgroup state after restart?
&gt;&gt;&gt;&gt;
&gt;&gt;&gt; except "cpu.shares" (Since 0.9.0), all other cgroup related stuffs
&gt;&gt;&gt; have no persistent XML yet, so they can't  be recovered.
&gt;&gt;&gt;
&gt;&gt;&gt; Regards
&gt;&gt;&gt; Osier
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; --
&gt;&gt; Nikita A Menkovich
&gt;&gt; http://libc6.org/
&gt;&gt; JID: menkovich@gmail.com
&gt;&gt; Tel: +7 (921) 423-96-48
&gt;&gt;
&gt;
&gt;
&gt;

</body></email><email><emailId>20110505133249</emailId><senderName>Nikita A Menkovich</senderName><senderEmail>menkovich@gmail.com</senderEmail><timestampReceived>2011-05-05 13:32:49-0400</timestampReceived><subject>[libvirt-users] Problem after restarting libvirt</subject><body>

After restarting libvirt cgroups for VMs are not recovered.
Is there available to restore cgroup state after restart?

-- 
Nikita A Menkovich
http://libc6.org/
JID: menkovich@gmail.com
Tel: +7 (921) 423-96-48

</body></email><email><emailId>20110512170047</emailId><senderName></senderName><senderEmail>acoetsier@veepee.com</senderEmail><timestampReceived>2011-05-12 17:00:47-0400</timestampReceived><subject>[libvirt-users] libvirt connection timeout</subject><body>

Hi all,
I would like to set a short connection timeout (only some seconds) when using libvirt \
in my Python program instead of the long default one.

I found the C function: virEventAddTimeoutFunc() in the C libvirt API here:
http://libvirt.org/html/libvirt-libvirt.html#virEventAddTimeoutFunc

and eventInvokeTimeoutCallback(timer, callback, opaque) in libvirt.py around the \
line#150 but I do not know how to use it. I did not find any example on the net.

 

I tried this but I get a segmentation fault: :-(

import libvirt

def timeout_cb_d():
    print 'Timeout !'

try:
    # try to set the libvirt timeout to 2 seconds:
    t = libvirt.eventInvokeTimeoutCallback(2, timeout_cb_d, "from dom0_class")
except:
    ...



Does anyone can give me a working example please?

 

 

Antoine Coetsier


[Attachment #3 (text/html)]


&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:x="urn:schemas-microsoft-com:office:excel" \
xmlns:p="urn:schemas-microsoft-com:office:powerpoint" \
xmlns:a="urn:schemas-microsoft-com:office:access" \
xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882" \
xmlns:s="uuid:BDC6E3F0-6DA3-11d1-A2A3-00AA00C14882" \
xmlns:rs="urn:schemas-microsoft-com:rowset" xmlns:z="#RowsetSchema" \
xmlns:b="urn:schemas-microsoft-com:office:publisher" \
xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" \
xmlns:c="urn:schemas-microsoft-com:office:component:spreadsheet" \
xmlns:odc="urn:schemas-microsoft-com:office:odc" \
xmlns:oa="urn:schemas-microsoft-com:office:activation" \
xmlns:html="http://www.w3.org/TR/REC-html40" \
xmlns:q="http://schemas.xmlsoap.org/soap/envelope/" \
xmlns:rtc="http://microsoft.com/officenet/conferencing" xmlns:D="DAV:" \
xmlns:Repl="http://schemas.microsoft.com/repl/" \
xmlns:mt="http://schemas.microsoft.com/sharepoint/soap/meetings/" \
xmlns:x2="http://schemas.microsoft.com/office/excel/2003/xml" \
xmlns:ppda="http://www.passport.com/NameSpace.xsd" \
xmlns:ois="http://schemas.microsoft.com/sharepoint/soap/ois/" \
xmlns:dir="http://schemas.microsoft.com/sharepoint/soap/directory/" \
xmlns:ds="http://www.w3.org/2000/09/xmldsig#" \
xmlns:dsp="http://schemas.microsoft.com/sharepoint/dsp" \
xmlns:udc="http://schemas.microsoft.com/data/udc" \
xmlns:xsd="http://www.w3.org/2001/XMLSchema" \
xmlns:sub="http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/" \
xmlns:ec="http://www.w3.org/2001/04/xmlenc#" \
xmlns:sp="http://schemas.microsoft.com/sharepoint/" \
xmlns:sps="http://schemas.microsoft.com/sharepoint/soap/" \
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" \
xmlns:udcs="http://schemas.microsoft.com/data/udc/soap" \
xmlns:udcxf="http://schemas.microsoft.com/data/udc/xmlfile" \
xmlns:udcp2p="http://schemas.microsoft.com/data/udc/parttopart" \
xmlns:wf="http://schemas.microsoft.com/sharepoint/soap/workflow/" \
xmlns:dsss="http://schemas.microsoft.com/office/2006/digsig-setup" \
xmlns:dssi="http://schemas.microsoft.com/office/2006/digsig" \
xmlns:mdssi="http://schemas.openxmlformats.org/package/2006/digital-signature" \
xmlns:mver="http://schemas.openxmlformats.org/markup-compatibility/2006" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns:mrels="http://schemas.openxmlformats.org/package/2006/relationships" \
xmlns:spwp="http://microsoft.com/sharepoint/webpartpages" \
xmlns:ex12t="http://schemas.microsoft.com/exchange/services/2006/types" \
xmlns:ex12m="http://schemas.microsoft.com/exchange/services/2006/messages" \
xmlns:pptsl="http://schemas.microsoft.com/sharepoint/soap/SlideLibrary/" \
xmlns:spsl="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService" \
xmlns:Z="urn:schemas-microsoft-com:" xmlns:st="" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;&lt;head&gt;&lt;META HTTP-EQUIV="Content-Type" \
CONTENT="text/html; charset=us-ascii"&gt;&lt;meta name=Generator content="Microsoft Word 12 \
(filtered medium)"&gt;&lt;style&gt;&lt;!-- /* Font Definitions */
@font-face
   {font-family:"Cambria Math";
   panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
   {font-family:Calibri;
   panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
   {font-family:Tahoma;
   panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
   {font-family:Consolas;
   panose-1:2 11 6 9 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
   {margin:0cm;
   margin-bottom:.0001pt;
   font-size:11.0pt;
   font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
   {mso-style-priority:99;
   color:blue;
   text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
   {mso-style-priority:99;
   color:purple;
   text-decoration:underline;}
p
   {mso-style-priority:99;
   mso-margin-top-alt:auto;
   margin-right:0cm;
   mso-margin-bottom-alt:auto;
   margin-left:0cm;
   font-size:12.0pt;
   font-family:"Times New Roman","serif";}
code
   {mso-style-priority:99;
   font-family:"Courier New";}
pre
   {mso-style-priority:99;
   mso-style-link:"Pr\00E9format\00E9 HTML Car";
   margin:0cm;
   margin-bottom:.0001pt;
   font-size:10.0pt;
   font-family:"Courier New";}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
   {mso-style-priority:99;
   mso-style-link:"Texte de bulles Car";
   margin:0cm;
   margin-bottom:.0001pt;
   font-size:8.0pt;
   font-family:"Tahoma","sans-serif";}
span.EmailStyle17
   {mso-style-type:personal-compose;
   font-family:"Calibri","sans-serif";
   color:windowtext;}
span.TextedebullesCar
   {mso-style-name:"Texte de bulles Car";
   mso-style-priority:99;
   mso-style-link:"Texte de bulles";
   font-family:"Tahoma","sans-serif";}
span.apple-converted-space
   {mso-style-name:apple-converted-space;}
span.PrformatHTMLCar
   {mso-style-name:"Pr\00E9format\00E9 HTML Car";
   mso-style-priority:99;
   mso-style-link:"Pr\00E9format\00E9 HTML";
   font-family:"Courier New";}
span.kwd
   {mso-style-name:kwd;}
span.pln
   {mso-style-name:pln;}
span.pun
   {mso-style-name:pun;}
span.str
   {mso-style-name:str;}
span.com
   {mso-style-name:com;}
span.lit
   {mso-style-name:lit;}
.MsoChpDefault
   {mso-style-type:export-only;}
@page WordSection1
   {size:612.0pt 792.0pt;
   margin:70.85pt 70.85pt 70.85pt 70.85pt;}
div.WordSection1
   {page:WordSection1;}
--&gt;&lt;/style&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapedefaults v:ext="edit" spidmax="1027" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
&lt;o:shapelayout v:ext="edit"&gt;
&lt;o:idmap v:ext="edit" data="1" /&gt;
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;&lt;/head&gt;&lt;body lang=FR link=blue vlink=purple&gt;&lt;div \
class=WordSection1&gt;&lt;p \
style='mso-margin-top-alt:0cm;margin-right:0cm;margin-bottom:12.0pt;margin-left:0cm;line-height:13.5pt;vertical-align:baseline'&gt;&lt;span \
lang=EN-US style='font-size:10.5pt;font-family:"Arial","sans-serif";color:black'&gt;Hi \
all,&lt;br&gt;I would like to set a short connection timeout (only some seconds) when using \
libvirt in my Python program instead of the long default one.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
style='margin:0cm;margin-bottom:.0001pt;line-height:13.5pt;vertical-align:baseline;bor \
der-style:initial;border-color:initial;background-image:initial;background-attachment:initial;background-origin: \
initial;background-clip: initial;word-wrap: break-word;background-position:initial \
initial;background-repeat:initial initial'&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:"Arial","sans-serif";color:black'&gt;I found the C \
function:&lt;/span&gt;&lt;span class=apple-converted-space&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:"Arial","sans-serif";color:black'&gt; &lt;/span&gt;&lt;/span&gt;&lt;code&gt;&lt;span \
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:black;border:none \
windowtext 1.0pt;padding:0cm;background:#EEEEEE'&gt;virEventAddTimeoutFunc()&lt;/span&gt;&lt;/code&gt;&lt;span \
class=apple-converted-space&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:"Arial","sans-serif";color:black'&gt; &lt;/span&gt;&lt;/span&gt;&lt;span \
lang=EN-US style='font-size:10.5pt;font-family:"Arial","sans-serif";color:black'&gt;in \
the C libvirt API here:&lt;br&gt;&lt;/span&gt;&lt;span \
style='font-size:10.5pt;font-family:"Arial","sans-serif";color:black'&gt;&lt;a \
href="http://libvirt.org/html/libvirt-libvirt.html#virEventAddTimeoutFunc"&gt;&lt;span \
lang=EN-US style='color:#0077CC;border:none windowtext \
1.0pt;padding:0cm'&gt;http://libvirt.org/html/libvirt-libvirt.html#virEventAddTimeoutFunc&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;span \
lang=EN-US style='font-size:10.5pt;font-family:"Arial","sans-serif";color:black'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
style='margin:0cm;margin-bottom:.0001pt;line-height:13.5pt;vertical-align:baseline;bor \
der-style:initial;border-color:initial;background-image:initial;background-attachment:initial;background-origin: \
initial;background-clip: initial;word-wrap: break-word;background-position:initial \
initial;background-repeat:initial initial'&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:"Arial","sans-serif";color:black'&gt;and&lt;/span&gt;&lt;span \
class=apple-converted-space&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:"Arial","sans-serif";color:black'&gt; &lt;/span&gt;&lt;/span&gt;&lt;code&gt;&lt;span \
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:black;border:none \
windowtext 1.0pt;padding:0cm;background:#EEEEEE'&gt;eventInvokeTimeoutCallback(timer, \
callback, opaque)&lt;/span&gt;&lt;/code&gt;&lt;span class=apple-converted-space&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:"Arial","sans-serif";color:black'&gt; &lt;/span&gt;&lt;/span&gt;&lt;span \
lang=EN-US style='font-size:10.5pt;font-family:"Arial","sans-serif";color:black'&gt;in&lt;/span&gt;&lt;span \
class=apple-converted-space&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:"Arial","sans-serif";color:black'&gt; &lt;/span&gt;&lt;/span&gt;&lt;code&gt;&lt;span \
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:black;border:none \
windowtext 1.0pt;padding:0cm;background:#EEEEEE'&gt;libvirt.py&lt;/span&gt;&lt;/code&gt;&lt;span \
class=apple-converted-space&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:"Arial","sans-serif";color:black'&gt; &lt;/span&gt;&lt;/span&gt;&lt;span \
lang=EN-US style='font-size:10.5pt;font-family:"Arial","sans-serif";color:black'&gt;around \
the line#150 but I do not know how to use it. I did not find any example on the \
net.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
style='margin:0cm;margin-bottom:.0001pt;line-height:13.5pt;vertical-align:baseline'&gt;&lt;span \
lang=EN-US style='font-size:10.5pt;font-family:"Arial","sans-serif";color:black'&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p \
style='margin:0cm;margin-bottom:.0001pt;line-height:13.5pt;vertical-align:baseline;bor \
der-style:initial;border-color:initial;background-image:initial;background-attachment:initial;background-origin: \
initial;background-clip: initial;word-wrap: break-word;background-position:initial \
initial;background-repeat:initial initial'&gt;&lt;strong&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:"Arial","sans-serif";color:black;border:none \
windowtext 1.0pt;padding:0cm'&gt;I tried this but I get a segmentation \
fault:&lt;/span&gt;&lt;/strong&gt;&lt;span class=apple-converted-space&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:"Arial","sans-serif";color:black'&gt; &lt;/span&gt;&lt;/span&gt;&lt;span \
lang=EN-US style='font-size:10.5pt;font-family:"Arial","sans-serif";color:black'&gt;:-(&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;pre \
style='line-height:13.5pt;background:#EEEEEE;vertical-align:baseline;border-style:init \
ial;border-color:initial;background-image:initial;background-attachment:initial;background-origin: \
initial;background-clip: initial;overflow-x: auto;overflow-y: auto;max-height: \
600px;background-position:initial initial;background-repeat:initial initial'&gt;&lt;span \
class=kwd&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:Consolas;color:darkblue;border:none windowtext \
1.0pt;padding:0cm'&gt;import&lt;/span&gt;&lt;/span&gt;&lt;span class=pln&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:Consolas;color:black;border:none windowtext \
1.0pt;padding:0cm'&gt; libvirt&lt;/span&gt;&lt;/span&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:Consolas;color:black;border:none windowtext \
1.0pt;padding:0cm'&gt;&lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;span class=kwd&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:Consolas;color:darkblue;border:none windowtext \
1.0pt;padding:0cm'&gt;def&lt;/span&gt;&lt;/span&gt;&lt;span class=pln&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:Consolas;color:black;border:none windowtext \
1.0pt;padding:0cm'&gt; timeout_cb_d&lt;/span&gt;&lt;/span&gt;&lt;span class=pun&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:Consolas;color:black;border:none windowtext \
1.0pt;padding:0cm'&gt;():&lt;/span&gt;&lt;/span&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:Consolas;color:black;border:none windowtext \
1.0pt;padding:0cm'&gt;&lt;br&gt;&lt;span class=pln&gt;    &lt;/span&gt;&lt;/span&gt;&lt;span \
class=kwd&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:Consolas;color:darkblue;border:none windowtext \
1.0pt;padding:0cm'&gt;print&lt;/span&gt;&lt;/span&gt;&lt;span class=pln&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:Consolas;color:black;border:none windowtext \
1.0pt;padding:0cm'&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=str&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:Consolas;color:maroon;border:none windowtext \
1.0pt;padding:0cm'&gt;'Timeout !'&lt;/span&gt;&lt;/span&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:Consolas;color:black;border:none windowtext \
1.0pt;padding:0cm'&gt;&lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;span class=kwd&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:Consolas;color:darkblue;border:none windowtext \
1.0pt;padding:0cm'&gt;try&lt;/span&gt;&lt;/span&gt;&lt;span class=pun&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:Consolas;color:black;border:none windowtext \
1.0pt;padding:0cm'&gt;:&lt;/span&gt;&lt;/span&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:Consolas;color:black;border:none windowtext \
1.0pt;padding:0cm'&gt;&lt;br&gt;&lt;span class=pln&gt;    &lt;/span&gt;&lt;/span&gt;&lt;span \
class=com&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:Consolas;color:gray;border:none windowtext \
1.0pt;padding:0cm'&gt;# try to set the libvirt timeout to 2 seconds:&lt;/span&gt;&lt;/span&gt;&lt;span \
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:black;border:none \
windowtext 1.0pt;padding:0cm'&gt;&lt;br&gt;&lt;span class=pln&gt;    t &lt;/span&gt;&lt;span \
class=pun&gt;=&lt;/span&gt;&lt;span class=pln&gt; libvirt&lt;/span&gt;&lt;span class=pun&gt;.&lt;/span&gt;&lt;span \
class=pln&gt;eventInvokeTimeoutCallback&lt;/span&gt;&lt;span class=pun&gt;(&lt;/span&gt;&lt;/span&gt;&lt;span \
class=lit&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:Consolas;color:maroon;border:none windowtext \
1.0pt;padding:0cm'&gt;2&lt;/span&gt;&lt;/span&gt;&lt;span class=pun&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:Consolas;color:black;border:none windowtext \
1.0pt;padding:0cm'&gt;,&lt;/span&gt;&lt;/span&gt;&lt;span class=pln&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:Consolas;color:black;border:none windowtext \
1.0pt;padding:0cm'&gt; timeout_cb_d&lt;/span&gt;&lt;/span&gt;&lt;span class=pun&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:Consolas;color:black;border:none windowtext \
1.0pt;padding:0cm'&gt;,&lt;/span&gt;&lt;/span&gt;&lt;span class=pln&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:Consolas;color:black;border:none windowtext \
1.0pt;padding:0cm'&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=str&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:Consolas;color:maroon;border:none windowtext \
1.0pt;padding:0cm'&gt;"from dom0_class"&lt;/span&gt;&lt;/span&gt;&lt;span class=pun&gt;&lt;span \
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:black;border:none \
windowtext 1.0pt;padding:0cm'&gt;)&lt;/span&gt;&lt;/span&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:Consolas;color:black;border:none windowtext \
1.0pt;padding:0cm'&gt;&lt;br&gt;&lt;/span&gt;&lt;span class=kwd&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:Consolas;color:darkblue;border:none windowtext \
1.0pt;padding:0cm'&gt;except&lt;/span&gt;&lt;/span&gt;&lt;span class=pun&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:Consolas;color:black;border:none windowtext \
1.0pt;padding:0cm'&gt;:&lt;/span&gt;&lt;/span&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:Consolas;color:black;border:none windowtext \
1.0pt;padding:0cm'&gt;&lt;br&gt;&lt;span class=pln&gt;    &lt;/span&gt;&lt;span \
class=pun&gt;...&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:Consolas;color:black'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/pre&gt;&lt;p \
style='mso-margin-top-alt:0cm;margin-right:0cm;margin-bottom:12.0pt;margin-left:0cm;li \
ne-height:13.5pt;vertical-align:baseline;border-style:initial;border-color:initial;background-image:initial;background-attachment:initial;background-origin: \
initial;background-clip: initial;word-wrap: break-word;background-position:initial \
initial;background-repeat:initial initial'&gt;&lt;span lang=EN-US \
style='font-size:10.5pt;font-family:"Arial","sans-serif";color:black'&gt;Does anyone can \
give me a working example please?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;span \
lang=EN-US&gt;&lt;o:p&gt; &lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;b&gt;&lt;span \
style='font-size:9.0pt;font-family:"Arial","sans-serif"'&gt;Antoine \
Coetsier&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20110516143900</emailId><senderName>Christian Spann</senderName><senderEmail>christian.spann@uni-ulm.de</senderEmail><timestampReceived>2011-05-16 14:39:00-0400</timestampReceived><subject>[libvirt-users] Howto set the option script=no for a tap device in the xml file</subject><body>


Hello,

I am trying to run a virtual machine with qemu-kvm and libvirt as a
user. In order to start the virtual machine I setup a tap device
manually, add it to the bridge and activate it via ifconfig. But I
cannot tell libvirt to not try to add the definded tap device to the
bridge by itself. It always fails telling me it cannot add tap0 to br0.

Thats the xml snippet for defining the network:

&lt;interface type='bridge'&gt;
	&lt;mac address='54:52:00:38:75:dd'/&gt;
	&lt;source bridge='br0'/&gt;
	&lt;target dev='tap0'/&gt;
	&lt;model type='virtio'/&gt;
&lt;/interface&gt;

Here I would like do define "script=no" to get an output like: -net
tap,vlan=0,ifname=tap0,script=no when libvirt launches the vm.

Regards,
Christian
-- 
Christian Spann - http://www-vs.informatik.uni-ulm.de/~spann



["smime.p7s" (application/pkcs7-signature)]

</body></email><email><emailId>20110523143315</emailId><senderName>Jelle de Jong</senderName><senderEmail>jelledejong@powercraft.nl</senderEmail><timestampReceived>2011-05-23 14:33:15-0400</timestampReceived><subject>[libvirt-users] getting live migration to work..</subject><body>

Hello everybody,

I am trying to get migration to work with the pacemaker VirtualDomain
RA. However I hit some problems and went back to the basic.

I also can't get virsh to do the migration so I am kind of stuck and can
use some advice.

# connection and general info and the migration tests
http://paste.debian.net/117736/

# capabilities
http://paste.debian.net/117745/

Thanks in advance,

Kind regards,

Jelle de Jong

</body></email><email><emailId>20110523180302</emailId><senderName>prakash hr</senderName><senderEmail>prakashrvcecn@gmail.com</senderEmail><timestampReceived>2011-05-23 18:03:02-0400</timestampReceived><subject>[libvirt-users] Live Migration UDP implementation</subject><body>

Hi all,
For my academic project to analyse the Performance of transport protocols in
Live Migration of Virtual Machines.I have configured the live migration
using tcp and I succeed the live migration.
Now for my further remaining project work I need to do the same thing for
the UDP implemataiton.When I changed the command in virsh, (My fianl command
in TCP is virsh migrate --live ubuntu21 qemu+ssh://172.16.17.23/systemtcp://
172.16.17.23:444) to udp it is not workng. It is given that qemu embeds user
mode network stack which includes tcp,dhcp,udp.etc within the wemu process.
Its giving the error no API found for UDP.
---Now i want to implement the patch file for migration using UDP if
possible.

---Where I should change the API in order to perform the live migration
using UDP.

---Is any patch file available so that modifying that patch file will
perform the Live Migration using UDP.

---If implementation using not possible with UDP please give me the details
why that can not be implemented and is any proofs for that reasons are
appreciated.

--Is there any other transport layer protocols can be used instead of TCP
during Live migration.?

--How about using RUDP instead of TCP.



Thanking You in advance.





Thanks and Regards
Prakash H.R
M.Tech Student at RVCE, Bangalore
+91-8904301073

[Attachment #3 (text/html)]

Hi all,&lt;div&gt;For my academic project to analyse the Performance of transport protocols \
in Live Migration of Virtual Machines.I have configured the live migration using tcp \
and I succeed the live migration. &lt;/div&gt;&lt;div&gt;Now for my further remaining project \
work I need to do the same thing for the UDP implemataiton.When I changed the command \
in virsh, (My fianl command in TCP is &lt;span class="Apple-style-span" \
style="background-color: rgb(255, 0, 0);"&gt;virsh migrate --live ubuntu21 qemu+ssh://&lt;a \
href="http://172.16.17.23/system"&gt;172.16.17.23/system&lt;/a&gt; tcp://&lt;a \
href="http://172.16.17.23:444"&gt;172.16.17.23:444&lt;/a&gt;)&lt;/span&gt; to udp it is not workng. \
It is given that qemu embeds user mode network stack which includes tcp,dhcp,udp.etc \
within the wemu process. Its giving the error no API found for UDP.&lt;/div&gt; &lt;div&gt;---Now \
i want to implement the patch file for migration using UDP if \
possible.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;---Where I should change the API in order to \
perform the live migration using UDP.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;---Is any patch file \
available so that modifying that patch file will perform the Live Migration using \
UDP.&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;---If implementation using not possible with UDP \
please give me the details why that can not be implemented and is any proofs for that \
reasons are appreciated.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;--Is there any other transport \
layer protocols can be used instead of TCP during Live migration.?&lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;--How about using RUDP instead of \
TCP.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanking You in \
advance.&lt;/div&gt;&lt;div&gt; &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;Thanks and Regards&lt;br&gt;Prakash \
H.R&lt;br&gt;M.Tech Student at RVCE, Bangalore&lt;br&gt; +91-8904301073&lt;br&gt;&lt;br&gt;
&lt;/div&gt;



</body></email><email><emailId>20110520141628</emailId><senderName>Atul Gosain</senderName><senderEmail>atul.gosain@gmail.com</senderEmail><timestampReceived>2011-05-20 14:16:28-0400</timestampReceived><subject>[libvirt-users] Java Bindings for libvirt</subject><body>

Hi

  I looked at the java bindings for libvirt at
http://libvirt.org/sources/java/ . Latest version here is 0.4.7 whereas the
latest version of libvirtd is 0.9.1 . Does the java binding use latest
libvirtd ?
  If not, can it be created easily ?

  Also, is there any plan to support HyperV support in future ?
Thanks
Atul

[Attachment #3 (text/html)]

&lt;div&gt;Hi &lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt;  I looked at the java bindings for libvirt at &lt;a \
href="http://libvirt.org/sources/java/"&gt;http://libvirt.org/sources/java/&lt;/a&gt; . Latest \
version here is 0.4.7 whereas the latest version of libvirtd is 0.9.1 . Does the java \
binding use latest libvirtd ? &lt;/div&gt;

&lt;div&gt;  If not, can it be created easily ?&lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt;  Also, is there any plan to support HyperV support in future ?&lt;/div&gt;
&lt;div&gt;Thanks&lt;/div&gt;
&lt;div&gt;Atul&lt;/div&gt;



</body></email><email><emailId>20110524054752</emailId><senderName>Atul Gosain</senderName><senderEmail>atul.gosain@gmail.com</senderEmail><timestampReceived>2011-05-24 05:47:52-0400</timestampReceived><subject>Re: [libvirt-users] Java Bindings for libvirt</subject><body>

Another try ....

On Fri, May 20, 2011 at 7:34 PM, Atul Gosain &lt;atul.gosain@gmail.com&gt; wrote:

&gt; Hi
&gt;
&gt;   I looked at the java bindings for libvirt at
&gt; http://libvirt.org/sources/java/ . Latest version here is 0.4.7 whereas
&gt; the latest version of libvirtd is 0.9.1 . Does the java binding use latest
&gt; libvirtd ?
&gt;   If not, can it be created easily ?
&gt;
&gt;   Also, is there any plan to support HyperV support in future ?
&gt; Thanks
&gt; Atul
&gt;

[Attachment #3 (text/html)]

Another try .... &lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Fri, May 20, 2011 at 7:34 PM, \
Atul Gosain &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:atul.gosain@gmail.com"&gt;atul.gosain@gmail.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt; &lt;div&gt;Hi &lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt;  I looked at the java bindings for libvirt at &lt;a \
href="http://libvirt.org/sources/java/" \
target="_blank"&gt;http://libvirt.org/sources/java/&lt;/a&gt; . Latest version here is 0.4.7 \
whereas the latest version of libvirtd is 0.9.1 . Does the java binding use latest \
libvirtd ? &lt;/div&gt;


&lt;div&gt;  If not, can it be created easily ?&lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt;  Also, is there any plan to support HyperV support in future ?&lt;/div&gt;
&lt;div&gt;Thanks&lt;/div&gt;
&lt;div&gt;Atul&lt;/div&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20110524075523</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-05-24 07:55:23-0400</timestampReceived><subject>Re: [libvirt-users] Java Bindings for libvirt</subject><body>

2011/5/20 Atul Gosain &lt;atul.gosain@gmail.com&gt;:
&gt; Hi
&gt;
&gt;   I looked at the java bindings for libvirt at
&gt; http://libvirt.org/sources/java/ . Latest version here is 0.4.7 whereas the
&gt; latest version of libvirtd is 0.9.1 . Does the java binding use latest
&gt; libvirtd ?
&gt;   If not, can it be created easily ?

The version number of the bindings and libvirt itself are not meant to
be in sync. The latest bindings should just work find with the latest
libvirt.

Matthias

</body></email><email><emailId>20110512172304</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-05-12 17:23:04-0400</timestampReceived><subject>Re: [libvirt-users] libvirt connection timeout</subject><body>

2011/5/12 Antoine COETSIER &lt;acoetsier@veepee.com&gt;:
&gt; Hi all,
&gt; I would like to set a short connection timeout (only some seconds) when
&gt; using libvirt in my Python program instead of the long default one.

What do you mean by connection timeout? The time libvirt waits before
reporting an connection attempt (as in calling libvirt.open()) as
error? I'm not sure it that value is configurable?

Can you be more specific? For example what connection URI do you use
in libvirt.open() as the timeout handling will probably be transport
specific.

&gt; I found the C function: virEventAddTimeoutFunc() in the C libvirt API here:
&gt; http://libvirt.org/html/libvirt-libvirt.html#virEventAddTimeoutFunc
&gt;
&gt; and eventInvokeTimeoutCallback(timer, callback, opaque) in libvirt.py around
&gt; the line#150 but I do not know how to use it. I did not find any example on
&gt; the net.
&gt;
&gt;
&gt;
&gt; I tried this but I get a segmentation fault: :-(
&gt;
&gt; import libvirt
&gt;
&gt; def timeout_cb_d():
&gt;     print 'Timeout !'
&gt;
&gt; try:
&gt;     # try to set the libvirt timeout to 2 seconds:
&gt;     t = libvirt.eventInvokeTimeoutCallback(2, timeout_cb_d, "from
&gt; dom0_class")
&gt; except:
&gt;     ...
&gt;
&gt; Does anyone can give me a working example please?

eventInvokeTimeoutCallback has nothing to do with a connection
timeout. This function is related  to the event handling.
eventInvokeTimeoutCallback is there since 2008 and on a quick look it
seems like dead code that should be removed as I can't find any caller
for it.

Matthias

</body></email><email><emailId>20110525122024</emailId><senderName>Rob</senderName><senderEmail>spamrefuse@yahoo.com</senderEmail><timestampReceived>2011-05-25 12:20:24-0400</timestampReceived><subject>[libvirt-users] Replace library WinXPs by virtual WinXPs as on a linux Fedora system?</subject><body>

Hi, 


The current situation:
* About 500 university library PCs run WinXP as the main OS.

I would like to achieve the following:
* Replace the WinXP by a linux system (Fedora?) with virtualizationsoftware 
(KVM?) and
have WinXP as a guest OS, in such a way that the users immediately boot into 
WinXP
without noticing the virtualization.

* Over the network I should still be able to access the host Fedora OS.

Is this a feasible idea? If yes, can you give me some clues how to start? 

Thank you!

Rob.

</body></email><email><emailId>20110525204233</emailId><senderName>Alex</senderName><senderEmail>mysqlstudent@gmail.com</senderEmail><timestampReceived>2011-05-25 20:42:33-0400</timestampReceived><subject>[libvirt-users] polkit error when starting virt-manager on fedora14</subject><body>

Hi,
I have the following error in syslog when starting virt-manager and
trying to connect:

May 25 16:39:33 sage libvirtd: 16:39:33.525: error :
remoteDispatchAuthPolkit:3846 : Policy kit denied action
org.libvirt.unix.manage from pid 27509, uid 500, result: 512

I can manually start the kvm guest using virsh, but why can't
virt-manager start them?

This is on fedora14 x86_64:

# rpm -qva|egrep 'virt|polkit|qemu'
polkit-qt-0.99.0-2.fc14.x86_64
qemu-img-0.13.0-1.fc14.x86_64
python-virtkey-0.50-8.fc14.x86_64
qemu-kvm-0.13.0-1.fc14.x86_64
polkit-0.98-5.fc14.x86_64
polkit-gnome-0.97-4.fc14.x86_64
libvirt-python-0.8.3-9.fc14.x86_64
virt-viewer-0.2.1-1.fc13.x86_64
gpxe-roms-qemu-1.0.1-3.fc14.noarch
virt-top-1.0.4-3.fc13.x86_64
libvirt-client-0.8.3-9.fc14.x86_64
virtuoso-opensource-6.1.2-1.fc14.x86_64
qemu-common-0.13.0-1.fc14.x86_64
polkit-desktop-policy-0.98-5.fc14.noarch
redland-virtuoso-1.0.12-1.fc14.x86_64
python-virtinst-0.500.6-1.fc14.noarch
libvirt-0.8.3-9.fc14.x86_64
qemu-system-x86-0.13.0-1.fc14.x86_64
virt-manager-0.8.7-2.fc14.noarch

Please let me know what other information I can provide to fix this
problem. I haven't rebooted yet, but I suspect at least that would fix
it?

Thanks,
Alex

</body></email><email><emailId>20110524115133</emailId><senderName>"--[ UxBoD ]--"</senderName><senderEmail>uxbod@splatnix.net</senderEmail><timestampReceived>2011-05-24 11:51:33-0400</timestampReceived><subject>[libvirt-users] kvm.h not found</subject><body>

Hello all,

Am attempting to compile the latest version of libvirt against a custom kernel \
2.6.32.40 under CentOS 5.6 and see this in the configure output:

checking linux/kvm.h usability... no
checking linux/kvm.h presence... no
checking for linux/kvm.h... no

I have tried to change where it is looking using:

CPPFLAGS="-I /home/compuser/linux-2.6.32.40/include" ./configure 

but end up with the same result. What am I doing wrong ?
-- 
Thanks, Phil


</body></email><email><emailId>20110509064400</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2011-05-09 06:44:00-0400</timestampReceived><subject>Re: [libvirt-users] Problem after restarting libvirt</subject><body>

于 2011年05月05日 21:32, Nikita A Menkovich 写道:
&gt; After restarting libvirt cgroups for VMs are not recovered.
&gt; Is there available to restore cgroup state after restart?
&gt;
except "cpu.shares" (Since 0.9.0), all other cgroup related stuffs
have no persistent XML yet, so they can't  be recovered.

Regards
Osier

</body></email><email><emailId>20110526051331</emailId><senderName>Christian Brandt</senderName><senderEmail>brandtc@psi5.com</senderEmail><timestampReceived>2011-05-26 05:13:31-0400</timestampReceived><subject>[libvirt-users] libvirt boots from Knoppix-CD but not Debian-CD</subject><body>

Debian Squeeze, libvirt 0.8.3, qemu-kvm 0.15.5

After configuring the cd image the bios screen shows:
(tested with virsh, virt-install and virt-manager)

Starting SeaBIOS (version 0.5.1-20110523_174945-brahms)

Booting from CD-Rom
65MB medium found (bzw. whatever size)
Boot failed: Could not read from CDROM (code 000c)
...

the cd images (debian6-cd1, debian6-netinst, debian6-buisnesscard) have
the correct md5sum an can be mounted, they simply do not boot. On the
other hand, a recent knoppix ISO works well. Tested countless times. All
access rights are 777.

Only special feature: the host is a minimal installation done with
debootstrap and contains not much else than libvirt, virt-manager and
lxterminal.

I am out of wit. Any ideas?

-- 
Christian Brandt

 life is short and in most cases it ends with death
 but my tombstone will carry the hiscore

</body></email><email><emailId>20110511072312</emailId><senderName>Nikita A Menkovich</senderName><senderEmail>menkovich@gmail.com</senderEmail><timestampReceived>2011-05-11 07:23:12-0400</timestampReceived><subject>Re: [libvirt-users] Problem after restarting libvirt</subject><body>

I could not find that cgroups are not persistent now. And there is no
such information in changelog.
Could you show me commit where it was changed?


On 9 May 2011 15:50, Nikita A Menkovich &lt;menkovich@gmail.com&gt; wrote:
&gt; It is really bad. Ok, I will write a script, that will set up cgroups
&gt; for every domain.
&gt;
&gt; On 9 May 2011 10:44, Osier Yang &lt;jyang@redhat.com&gt; wrote:
&gt;&gt; 于 2011年05月05日 21:32, Nikita A Menkovich 写道:
&gt;&gt;&gt;
&gt;&gt;&gt; After restarting libvirt cgroups for VMs are not recovered.
&gt;&gt;&gt; Is there available to restore cgroup state after restart?
&gt;&gt;&gt;
&gt;&gt; except "cpu.shares" (Since 0.9.0), all other cgroup related stuffs
&gt;&gt; have no persistent XML yet, so they can't   be recovered.
&gt;&gt;
&gt;&gt; Regards
&gt;&gt; Osier
&gt;&gt;
&gt;
&gt;
&gt;
&gt; --
&gt; Nikita A Menkovich
&gt; http://libc6.org/
&gt; JID: menkovich@gmail.com
&gt; Tel: +7 (921) 423-96-48
&gt;



-- 
Nikita A Menkovich
http://libc6.org/
JID: menkovich@gmail.com
Tel: +7 (921) 423-96-48

</body></email><email><emailId>20110516125521</emailId><senderName></senderName><senderEmail>acoetsier@veepee.com</senderEmail><timestampReceived>2011-05-16 12:55:21-0400</timestampReceived><subject>Re: [libvirt-users] libvirt connection timeout</subject><body>

Hello,

We have developped our own cloud manager for 2 years now and have been using libvirt \
to deploy and monitor xen domains with 2 daemons written in Python.

As  the number of domains increased and when one of them is down, it can ruin our \
monitoring capability, the daemon getting stuck with the defect connection.

Antoine Coetsier

-----Message d'origine-----
De : Matthias Bolte [mailto:matthias.bolte@googlemail.com] 
Envoyé : jeudi 12 mai 2011 19:23
À : Antoine COETSIER
Cc : libvirt-users@redhat.com; Julien MOREAU
Objet : Re: [libvirt-users] libvirt connection timeout

2011/5/12 Antoine COETSIER &lt;acoetsier@veepee.com&gt;:
&gt; Hi all,
&gt; I would like to set a short connection timeout (only some seconds) when
&gt; using libvirt in my Python program instead of the long default one.

What do you mean by connection timeout? The time libvirt waits before
reporting an connection attempt (as in calling libvirt.open()) as
error? I'm not sure it that value is configurable?

Can you be more specific? For example what connection URI do you use
in libvirt.open() as the timeout handling will probably be transport
specific.

&gt; I found the C function: virEventAddTimeoutFunc() in the C libvirt API here:
&gt; http://libvirt.org/html/libvirt-libvirt.html#virEventAddTimeoutFunc
&gt; 
&gt; and eventInvokeTimeoutCallback(timer, callback, opaque) in libvirt.py around
&gt; the line#150 but I do not know how to use it. I did not find any example on
&gt; the net.
&gt; 
&gt; 
&gt; 
&gt; I tried this but I get a segmentation fault: :-(
&gt; 
&gt; import libvirt
&gt; 
&gt; def timeout_cb_d():
&gt; print 'Timeout !'
&gt; 
&gt; try:
&gt; # try to set the libvirt timeout to 2 seconds:
&gt; t = libvirt.eventInvokeTimeoutCallback(2, timeout_cb_d, "from
&gt; dom0_class")
&gt; except:
&gt; ...
&gt; 
&gt; Does anyone can give me a working example please?

eventInvokeTimeoutCallback has nothing to do with a connection
timeout. This function is related  to the event handling.
eventInvokeTimeoutCallback is there since 2008 and on a quick look it
seems like dead code that should be removed as I can't find any caller
for it.

Matthias


</body></email><email><emailId>20110516150936</emailId><senderName>"Gian Uberto Lauri"</senderName><senderEmail>saint@eng.it</senderEmail><timestampReceived>2011-05-16 15:09:36-0400</timestampReceived><subject>[libvirt-users] Livemigrate problems.</subject><body>

Hello people.

	  I had 4 servers (bart,homer, lisa and abraham) where livemigrate
	  went without problems: I was able to make them play beach-volley
	  with a vm instance whose image is on an NFS file system.

	  Then I add a couple more, marge and maggie. I can do things like

	  virsh -c qemu://maggie/system list

	  or launch an interactive session without any problem, so the TLS
	  channel should be properly configured.

	  But when I try to run something like 

	  virsh  migrate --live "one-24" qemu://maggie/system

	  I get a nice "error: operation failed: failed to parse XML" error.

	  There is  the same error when  OpenNebula tries to restore  a vm
	  from a  checkpoint on the  same machine. How  can I fix  this. I
	  need all the machines up and running.

--
ing. Gian Uberto Lauri
Ricercatore / Reasearcher
Laboratorio Ricerca e Sviluppo / Research &amp; Development Lab.
Area Calcolo Distribuito / Distributed Computation Area

GianUberto.Lauri@eng.it

Engineering Ingegneria Informatica spa
Corso Stati Uniti 23/C, 35127 Padova (PD) 

Tel. +39-049.8283.571         | main(){printf(&amp;unix["\021%six\012\0"], 
Fax  +39-049.8283.569		  |    (unix)["have"]+"fun"-0x60);}   
Skype: gian.uberto.lauri	  |          David Korn, AT&amp;T Bell Labs             
http://www.eng.it 			  |          ioccc best One Liner, 1987             


	 

</body></email><email><emailId>20110516153020</emailId><senderName>Dale Amon</senderName><senderEmail>amon@vnl.com</senderEmail><timestampReceived>2011-05-16 15:30:20-0400</timestampReceived><subject>[libvirt-users] Looking for a contact</subject><body>

I'm curious if there is anyone here from linode.

</body></email><email><emailId>20110517172115</emailId><senderName>Christian Spann</senderName><senderEmail>christian.spann@uni-ulm.de</senderEmail><timestampReceived>2011-05-17 17:21:15-0400</timestampReceived><subject>Re: [libvirt-users] Howto set the option script=no for a tap device in the xml file</subject><body>


Hello again,

Digging into the source code with my colleague we found out that setting
&lt;script path='no'/&gt; does the trick. But to get this flag interpreted one
has to select the interface type "ethernet". Otherwise libvirt will
ignore the script element and try to add the tap device to the bridge by
itself.

Unfortunately libvirt does currently not support the downscript
parameter of qemu-kvm. But this only results in a error msg when
shutting down the vm. If I find some time the next days I will try to
produce a patch for this.

Regards,

Christian

Am 16.05.2011 16:39, schrieb Christian Spann:
&gt; Hello,
&gt; 
&gt; I am trying to run a virtual machine with qemu-kvm and libvirt as a
&gt; user. In order to start the virtual machine I setup a tap device
&gt; manually, add it to the bridge and activate it via ifconfig. But I
&gt; cannot tell libvirt to not try to add the definded tap device to the
&gt; bridge by itself. It always fails telling me it cannot add tap0 to br0.
&gt; 
&gt; Thats the xml snippet for defining the network:
&gt; 
&gt; &lt;interface type='bridge'&gt;
&gt; 	&lt;mac address='54:52:00:38:75:dd'/&gt;
&gt; 	&lt;source bridge='br0'/&gt;
&gt; 	&lt;target dev='tap0'/&gt;
&gt; 	&lt;model type='virtio'/&gt;
&gt; &lt;/interface&gt;
&gt; 
&gt; Here I would like do define "script=no" to get an output like: -net
&gt; tap,vlan=0,ifname=tap0,script=no when libvirt launches the vm.
&gt; 
&gt; Regards,
&gt; Christian


["smime.p7s" (application/pkcs7-signature)]

</body></email><email><emailId>20110518134306</emailId><senderName>Lars Nordin</senderName><senderEmail>lnordin@internap.com</senderEmail><timestampReceived>2011-05-18 13:43:06-0400</timestampReceived><subject>[libvirt-users] Trying to re-compile libvirt package on Ubuntu Lucid</subject><body>

I'm trying to rebuild Ubuntu's libvirt packages to turn on ESX support.

I've downloaded the Ubuntu source package for Lucid (updated Lucid package)
dget -u http://archive.ubuntu.com/ubuntu/pool/main/libv/libvirt/libvirt_0.7.5-5ubuntu27.11.dsc

I try and re-compile 
dpkg-buildpackage -rfakeroot -b
DEB_BUILD_OPTIONS="--with-esx" fakeroot debian/rules binary


and I get this error:

...
testing with corrupted config: log_level
Skipping test (due to Ubuntu buildd FTBFS): running libvirtd with a valid config file (2 seconds)
FAIL: daemon-conf
PASS: define-dev-segfault
...
====================
1 of 37 tests failed
====================
make[4]: *** [check-TESTS] Error 1
make[4]: Leaving directory `/exp/h1/staff/lnordin/libvirt-pkg/libvirt-0.7.5/tests'
make[3]: *** [check-am] Error 2
make[3]: Leaving directory `/exp/h1/staff/lnordin/libvirt-pkg/libvirt-0.7.5/tests'
make[2]: *** [check-recursive] Error 1
make[2]: Leaving directory `/exp/h1/staff/lnordin/libvirt-pkg/libvirt-0.7.5/tests'
make[1]: *** [check-recursive] Error 1
make[1]: Leaving directory `/exp/h1/staff/lnordin/libvirt-pkg/libvirt-0.7.5'
make: *** [debian/stamp-makefile-check] Error 2

Anyone gone through this exercise before and would know how to get the packages re-built?

</body></email><email><emailId>20110519103701</emailId><senderName>Francesc Guasch</senderName><senderEmail>frankie@telecos.upc.edu</senderEmail><timestampReceived>2011-05-19 10:37:01-0400</timestampReceived><subject>[libvirt-users] Blank console and no boot</subject><body>

Hi. I was cloning a domain and now I can't boot the original
nor the clone domain.

Currently when I start one of those domains I can see only a
blank screen. I am not sure what went wrong cloning. I was trying
to use kpart to mount the new image and change info in the filesystem
like hostname, ip and so. Anyway when I start the new or old domain:

   # virsh start --console thedomain
    Domain thedomain started
    Connected to domain thedomain
    Escape character is ^]

And that's all.I see nothing with libvirt graphical console, nothing in
the logs but this, that I guess it's the usual startup info:

  LC_ALL=C
  PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin
  QEMU_AUDIO_DRV=none /usr/bin/kvm -S -M pc-0.12 -enable-kvm -m 512 -smp
  1,sockets=1,cores=1,threads=1 -name ....
  ...

This is qemu-kvm 0.12.5+noroms-0ubuntu7.1 on ubuntu server 10.

Any hints so I can check what could have go wrong ? I am concerned about
not being able to see what is going on. I guess there must be a way to
start the domains and watch the boot process somehow. Is this possible ?

thank you for you time

</body></email><email><emailId>20110521070519</emailId><senderName>Abhishek Gupta</senderName><senderEmail>abhishekgupta.iitd@gmail.com</senderEmail><timestampReceived>2011-05-21 07:05:19-0400</timestampReceived><subject>[libvirt-users] Migrate doesn't support copy-storage-all</subject><body>

While using --copy-storage-all option while doing live migration I am
getting following error :

error: command 'migrate' doesn't support option --copy-storate-all

I am using kvm hypervisor. Does that mean kvm doesn't support the option or
libvirt doesn't provide support for the same with kvm as the hypervisor?

--
Abhishek
Student, IIT Delhi

[Attachment #3 (text/html)]

While using --copy-storage-all option while doing live migration I am getti=
ng following error :&lt;br&gt;&lt;br&gt;error: command 'migrate' doesn't su=
pport option --copy-storate-all&lt;br&gt;&lt;br&gt;I am using kvm hypervisor. Does that=
 mean kvm doesn't support the option or libvirt doesn't provide sup=
port for the same with kvm as the hypervisor?&lt;br&gt;
&lt;br&gt;--&lt;br&gt;Abhishek&lt;br&gt;Student, IIT Delhi&lt;br&gt;


</body></email><email><emailId>20110523135815</emailId><senderName>Alex</senderName><senderEmail>mysqlstudent@gmail.com</senderEmail><timestampReceived>2011-05-23 13:58:15-0400</timestampReceived><subject>[libvirt-users] Improving video for Windows7 kvm guest on fc14</subject><body>

Hi,
I have an existing windows7 x86_64 kvm guest running on fedora14
x86_64 with a Radeon HD5700 at 1680x1050, and would like to improve
the resolution of the Windows guest.  How can I change the Windows
driver to something more capable than "standard vga"? It currently
reports there is only 16MB of RAM at available at 1440x900. How can I
increase this? I've tried using virsh or editing the xml directly, but
it doesn't seem to be reflected in the guest.

Some of the configuration options I've read in the documentation don't
work with fedora14 and virt-manager, such as the acceleration options.
This is my current configuration:

    &lt;video&gt;
      &lt;model type='vmvga' vram='192000' heads='1'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x02'
function='0x0'/&gt;
    &lt;/video&gt;

How can I more effectively use the video card's capabilities in the
Windows guest?

Thanks,
Alex

</body></email><email><emailId>20110523160432</emailId><senderName>Jelle de Jong</senderName><senderEmail>jelledejong@powercraft.nl</senderEmail><timestampReceived>2011-05-23 16:04:32-0400</timestampReceived><subject>Re: [libvirt-users] getting live migration to work..</subject><body>

On 23-05-11 16:33, Jelle de Jong wrote:
&gt; I also can't get virsh to do the migration so I am kind of stuck and can
&gt; use some advice.
&gt; 
&gt; # connection and general info and the migration tests
&gt; http://paste.debian.net/117736/
&gt; 
&gt; # capabilities
&gt; http://paste.debian.net/117745/

# trial and error when "undefine" the domain on the other node
http://paste.debian.net/117763/

Thanks in advance,

Kind regards,

Jelle de Jong

</body></email><email><emailId>20110523174850</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-05-23 17:48:50-0400</timestampReceived><subject>Re: [libvirt-users] Compatibility with Parallels Virtouzo</subject><body>

2011/5/23 Andreas Mauf &lt;a.mauf@syseleven.de&gt;:
&gt; Hi,
&gt;
&gt; will libvirt work with the commercial parallels virtuozzo, too? Cause
&gt; the linux version of virtuozzo is based on openvz, which ist supported
&gt; by libvirt.

This depends on whether or not virtuozzo can be controlled via the
vzctl tool, because that's bow libvirt interacts with OpenVZ.

Matthias

</body></email><email><emailId>20110523184849</emailId><senderName>Eric Blake</senderName><senderEmail>eblake@redhat.com</senderEmail><timestampReceived>2011-05-23 18:48:49-0400</timestampReceived><subject>Re: [libvirt-users] Live Migration UDP implementation</subject><body>


On 05/23/2011 11:51 AM, prakash hr wrote:
&gt; Hi all,
&gt; For my academic project to analyse the Performance of transport protocols in
&gt; Live Migration of Virtual Machines.I have configured the live migration
&gt; using tcp and I succeed the live migration.
&gt; Now for my further remaining project work I need to do the same thing for
&gt; the UDP implemataiton.When I changed the command in virsh, (My fianl command
&gt; in TCP is virsh migrate --live ubuntu21 qemu+ssh://172.16.17.23/systemtcp://
&gt; 172.16.17.23:444) to udp it is not workng. It is given that qemu embeds user
&gt; mode network stack which includes tcp,dhcp,udp.etc within the wemu process.
&gt; Its giving the error no API found for UDP.
&gt; ---Now i want to implement the patch file for migration using UDP if
&gt; possible.

Why?  UDP is inherently unreliable, and live migration is something
where you want inherent reliability.  That is, you risk data loss if the
receiving end does not receive and act on every packet sent by the
sender, and the sender can't know whether the migration was successful
unless the receiver acknowledges receipt.  At which point, either you
are reinventing reliability on top of UDP, or you can use the
reliability already built into TCP.

&gt; ---Is any patch file available so that modifying that patch file will
&gt; perform the Live Migration using UDP.

No one has written a patch for this, for the above reasons.  Since this
is free software, you are welcome to do so yourself, but unless you can
prove that you can come up with significant speed improvements without
adding any risk of data loss, it's not likely to be accepted upstream.

-- 
Eric Blake   eblake@redhat.com    +1-801-349-2682
Libvirt virtualization library http://libvirt.org


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20110524152144</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2011-05-24 15:21:44-0400</timestampReceived><subject>Re: [libvirt-users] Java Bindings for libvirt</subject><body>

On Fri, May 20, 2011 at 07:34:28PM +0530, Atul Gosain wrote:
&gt;   Also, is there any plan to support HyperV support in future ?

  We don't really have a plan to implement this, and except for an
exception a few months ago I don't think anybody is trying right now.
But if someone comes with patches we will definitely look at them
and try to add support :-)

Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

</body></email><email><emailId>20110524162245</emailId><senderName>Thibault VINCENT</senderName><senderEmail>thibault.vincent@smartjog.com</senderEmail><timestampReceived>2011-05-24 16:22:45-0400</timestampReceived><subject>[libvirt-users] Xen and live migration with VIR_MIGRATE_PERSIST_DEST</subject><body>

Hi,

I'm having a hard time to figure how to perform Xen live migration using
the python API with the same rate of success than virt-manager.

# virsh version
Compiled against library: libvir 0.8.3
Using library: libvir 0.8.3
Using API: Xen 3.0.1
Running hypervisor: Xen 3.2.0

The goal is to have the migration done in only one call, including a
definition in the remote xend and undefinition from the source, which
requires the VIR_MIGRATE_PERSIST_DEST and VIR_MIGRATE_UNDEFINE_SOURCE flags.
Here's the code doing the migration:
----------
flags = (libvirt.VIR_MIGRATE_LIVE ^
         libvirt.VIR_MIGRATE_PERSIST_DEST ^
         libvirt.VIR_MIGRATE_UNDEFINE_SOURCE)
uri = 'xenmigr://remote.host.com:8002'
domain_obj.migrate(con_handle, flags, None, uri, 0)
----------

There are various problems that occur randomly, such as the VM
completely disappearing 5 seconds after a succesful migration, but the
main issue is with VIR_MIGRATE_PERSIST_DEST that doesn't seem to have
any effect. The domU is not defined in xend and will vanish when
destroyed or on hypervisor reboot.

Could that be a known problem or related to a bug ? I'm really out of ideas.

Any help appreciated, Thank you !

-- 
Thibault VINCENT  -  IT
SmartJog S.A.S. - Groupe TDF - Pôle multimédia
27 Bd Hippolyte Marques, 94200 Ivry-sur-Seine, France
Phone: +33.1.58.68.62.38 / Fax: +33.1.58.68.60.97

</body></email><email><emailId>20110525122233</emailId><senderName>Rob</senderName><senderEmail>spamrefuse@yahoo.com</senderEmail><timestampReceived>2011-05-25 12:22:33-0400</timestampReceived><subject>[libvirt-users] Replace library WinXPs by virtual WinXPs as on a linux Fedora system?</subject><body>

Hi, 


The current situation:
* About 500 university library PCs run WinXP as the main OS.

I would like to achieve the following:
* Replace the WinXP by a linux system (Fedora?) with virtualizationsoftware 
(KVM?) and
have WinXP as a guest OS, in such a way that the users immediately boot into 
WinXP
without noticing the virtualization.

* Over the network I should still be able to access the host Fedora OS.

Is this a feasible idea? If yes, can you give me some clues how to start? 

Thank you!

Rob.

</body></email><email><emailId>20110526145041</emailId><senderName>YAO</senderName><senderEmail>yffbrave@gmail.com</senderEmail><timestampReceived>2011-05-26 14:50:41-0400</timestampReceived><subject>[libvirt-users] Failed to connect to Xen 4.1 using virsh</subject><body>

Hi,
I installed xen 4.1 and libvirt 0.9.1 on ubuntu 10.04 x86
when I tried "*virsh -c xen:/// list*", the terminal give me error:
*error: unable to connect to '/var/run/libvirt/libvirt-sock', libvirtd may
need to be started: No such file or directory*
*error: failed to connect to the hypervisor*

But when I tried "*sudo virsh -c xen:/// list*", there's different error:
*error: unable to connect to 'localhost:8000': Connection refused*
*error: failed to connect to the hypervisor*

That really confused me.
Do I need to start libvirtd like "*sudo libvirtd*"? cause "*virsh -c
test:///default list*" is OK without it.
I have started xencommons and xend, so I really don't know what I missed...

Thanks,
Yao

[Attachment #3 (text/html)]

Hi,&lt;div&gt;I installed xen 4.1 and libvirt 0.9.1 on ubuntu 10.04 x86&lt;/div&gt;&lt;div=
&gt;when I tried "&lt;b&gt;virsh -c xen:/// list&lt;/b&gt;", the terminal give m=
e error:&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;i&gt;error: unable to connect to '/var/run/libvir=
t/libvirt-sock', libvirtd may need to be started: No such file or direc=
tory&lt;/i&gt;&lt;/div&gt;
&lt;div&gt;&lt;i&gt;error: failed to connect to the hypervisor&lt;/i&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;=
&lt;/div&gt;&lt;div&gt;But when I tried "&lt;b&gt;sudo virsh -c xen:/// list&lt;/b&gt;", =
there's different error:&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;i&gt;error: unable to connect to =
'localhost:8000': Connection refused&lt;/i&gt;&lt;/div&gt;
&lt;div&gt;&lt;i&gt;error: failed to connect to the hypervisor&lt;/i&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;=
&lt;/div&gt;&lt;div&gt;That really confused me.&lt;/div&gt;&lt;div&gt;Do I need to start libvirtd l=
ike "&lt;b&gt;sudo libvirtd&lt;/b&gt;"? cause "&lt;b&gt;virsh -c test:///defau=
lt list&lt;/b&gt;" is OK without it.&lt;/div&gt;
&lt;div&gt;I have started xencommons and xend, so I really don't know what I =
missed...&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;Yao&lt;/div&gt;


</body></email><email><emailId>20110526165426</emailId><senderName>Alex</senderName><senderEmail>mysqlstudent@gmail.com</senderEmail><timestampReceived>2011-05-26 16:54:26-0400</timestampReceived><subject>Re: [libvirt-users] polkit error when starting virt-manager on fedora14</subject><body>

Hi,

&gt; Hi,
&gt; I have the following error in syslog when starting virt-manager and
&gt; trying to connect:
&gt;
&gt; May 25 16:39:33 sage libvirtd: 16:39:33.525: error :
&gt; remoteDispatchAuthPolkit:3846 : Policy kit denied action
&gt; org.libvirt.unix.manage from pid 27509, uid 500, result: 512

virt-manager worked one day, and stopped the next, so I figured it was
a bug. Looks like it's just a change in functionality without any
regular indication. I followed the instructions here and it works
again:

http://wiki.libvirt.org/page/SSHPolicyKitSetup

Regards,
Alex

</body></email><email><emailId>20110527173930</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2011-05-27 17:39:30-0400</timestampReceived><subject>Re: [libvirt-users] kvm.h not found</subject><body>

2011/5/24 --[ UxBoD ]-- &lt;uxbod@splatnix.net&gt;:
&gt; Hello all,
&gt; 
&gt; Am attempting to compile the latest version of libvirt against a custom kernel \
&gt; 2.6.32.40 under CentOS 5.6 and see this in the configure output: 
&gt; checking linux/kvm.h usability... no
&gt; checking linux/kvm.h presence... no
&gt; checking for linux/kvm.h... no
&gt; 
&gt; I have tried to change where it is looking using:
&gt; 
&gt; CPPFLAGS="-I /home/compuser/linux-2.6.32.40/include" ./configure

As a random guess, did you try

CFLAGS=-I/home/compuser/linux-2.6.32.40/include ./configure

Matthias


</body></email><email><emailId>20110528044456</emailId><senderName>Christian Brandt</senderName><senderEmail>brandtc@psi5.com</senderEmail><timestampReceived>2011-05-28 04:44:56-0400</timestampReceived><subject>[libvirt-users] boot debian6 cd?</subject><body>

Based on further experiments I think you can not boot any debian cd with
seabios/kvm/libvirt solution, am I right?

-- 
Christian Brandt

 life is short and in most cases it ends with death
 but my tombstone will carry the hiscore

</body></email><email><emailId>20110529185749</emailId><senderName>Christian Brandt</senderName><senderEmail>brandtc@psi5.com</senderEmail><timestampReceived>2011-05-29 18:57:49-0400</timestampReceived><subject>Re: [libvirt-users] libvirt boots from Knoppix-CD but not Debian-CD</subject><body>

Problem solved, the solution:

Don't trust labels on disks. They often mix up architectures.

Don't trust labels on computers. They often do not only mix up
architectures but also send you into login into a virtual engine instead
of the real engine.

Don't trust jigdoed ISO-Images. Stupid people will have done stupid
things to the data before mkisofs, including but not limited to mixing
up architectures.

Final though: Even if your internet line is only 128kBit always download
official images.

-- 
Christian Brandt

 life is short and in most cases it ends with death
 but my tombstone will carry the hiscore

</body></email><email><emailId>20110530083453</emailId><senderName>RaSca</senderName><senderEmail>rasca@miamammausalinux.org</senderEmail><timestampReceived>2011-05-30 08:34:53-0400</timestampReceived><subject>[libvirt-users] Forward routed network bridge on system's vlan</subject><body>

Hi all,
I created a two node cluster that manages virtual machines with two 
servers connected via a cross cable on the network 10.0.0.0/24. I want 
that machines that runs on different servers in the network 
172.16.0.0/24 can see all the others.
To make this possible I've configured a vlan on each server:

...
...
5: eth1.111@eth1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc 
noqueue state UP
     link/ether 5c:d9:98:b1:4c:4d brd ff:ff:ff:ff:ff:ff
     inet 172.16.0.0/24 brd 172.16.0.255 scope global eth1.111
     inet6 fe80::5ed9:98ff:feb1:4c4d/64 scope link
        valid_lft forever preferred_lft forever
...
...

And created a "lan" network, via virsh:

&lt;network&gt;
   &lt;name&gt;lan&lt;/name&gt;
   &lt;uuid&gt;8ac034c8-553d-b995-5a80-c1c711cb088c&lt;/uuid&gt;
   &lt;forward dev='eth1.111' mode='route'/&gt;
   &lt;bridge name='virbr1' stp='on' delay='0' /&gt;
   &lt;ip address='172.16.0.2' netmask='255.255.255.0'&gt;
   &lt;/ip&gt;
&lt;/network&gt;

but with this setup "lan" never comes up because, for some reason, the 
network is locked:

# virsh net-start lan
error: Failed to start network lan
error: internal error Network 172.16.0.1/255.255.255.0 is already in use 
by interface eth1.111

What is not clear to me is why, if I turn down the eth1.111 device, 
start the lan network, turn eth1.111 up and then force the brctl addif 
command, everything works:

# ifdown eth1.111
Removed VLAN -:eth1.111:-

# virsh net-start lan
Network lan started

# ifup eth1.111
Set name-type for VLAN subsystem. Should be visible in /proc/net/vlan/config
Added VLAN with VID == 111 to IF -:eth1:-

# brctl addif virbr1 eth1.111

# brctl show
bridge name	bridge id		STP enabled	interfaces
br0		8000.6c626dd7518e	no		eth0
virbr0		8000.000000000000	yes		
virbr1		8000.5cd998b14c4d	yes		eth1.111

Why manually is possible to make things work? What am I ignoring?

Thanks a lot,

-- 
RaSca
Mia Mamma Usa Linux: Niente è impossibile da capire, se lo spieghi bene!
rasca@miamammausalinux.org
http://www.miamammausalinux.org


</body></email><email><emailId>20110530094345</emailId><senderName></senderName><senderEmail>arun.sasi1@wipro.com</senderEmail><timestampReceived>2011-05-30 09:43:45-0400</timestampReceived><subject>Re: [libvirt-users] [Qemu-devel] Qcow2</subject><body>

Hello Team,

Please help me to solve this...

Find the below error 

May 30 12:21:29 sd0005srv01 kernel: [19836592.317217] device vnet0
entered promiscuous mode
May 30 12:21:29 sd0005srv01 kernel: [19836592.319449] br0: port 2(vnet0)
entering learning state
May 30 12:21:29 sd0005srv01 nm-system-settings:    SCPlugin-Ifupdown:
device added (udi: /org/freedesktop/Hal/devices/net_ce_1b_36_05_70_14,
iface: vnet0): not well known
May 30 12:21:30 sd0005srv01 avahi-daemon[3449]: Registering new address
record for fe80::cc1b:36ff:fe05:7014 on vnet0.*.
May 30 12:21:33 sd0005srv01 nm-system-settings: Added default wired
connection 'Auto vnet0' for
/org/freedesktop/Hal/devices/net_ce_1b_36_05_70_14
May 30 12:21:38 sd0005srv01 kernel: [19836601.316008] br0: topology
change detected, propagating
May 30 12:21:38 sd0005srv01 kernel: [19836601.316014] br0: port 2(vnet0)
entering forwarding state
May 30 12:21:39 sd0005srv01 kernel: [19836602.949751] vnet0: no IPv6
routers present
May 30 12:21:59 sd0005srv01 libvirtd: 12:21:59.278: error : internal
error Timed out while reading console log output
May 30 12:21:59 sd0005srv01 libvirtd: 12:21:59.278: error : internal
error unable to start guest:
May 30 12:21:59 sd0005srv01 avahi-daemon[3449]: Withdrawing address
record for fe80::cc1b:36ff:fe05:7014 on vnet0.
May 30 12:21:59 sd0005srv01 kernel: [19836622.479659] br0: port 2(vnet0)
entering disabled state
May 30 12:21:59 sd0005srv01 kernel: [19836622.493771] device vnet0 left
promiscuous mode
May 30 12:21:59 sd0005srv01 kernel: [19836622.493773] br0: port 2(vnet0)
entering disabled state
May 30 12:21:59 sd0005srv01 nm-system-settings:    SCPlugin-Ifupdown:
devices removed (udi: /org/freedesktop/Hal/



Thanks,
-Arun


-----Original Message-----
From: Arun Sasi V (WI01 - Manage IT) 
Sent: Monday, May 30, 2011 2:24 PM
To: 'Stefan Hajnoczi'
Cc: 'stefanha@linux.vnet.ibm.com'; 'qemu-devel@nongnu.org';
'libvirt-users@redhat.com'
Subject: RE: [Qemu-devel] Qcow2

Hello Stefan,

I can see some error messages 

May 30 11:36:49 sd0005srv01 libvirtd: 11:36:49.044: error : internal
error Timed out while reading console log output
May 30 11:36:49 sd0005srv01 libvirtd: 11:36:49.044: error : internal
error unable to start guest:

I am using ubuntu 9.04

Thanks,
-Arun

-----Original Message-----
From: Stefan Hajnoczi [mailto:stefanha@gmail.com] 
Sent: Friday, May 20, 2011 12:35 AM
To: Arun Sasi V (WI01 - Manage IT)
Cc: stefanha@linux.vnet.ibm.com; qemu-devel@nongnu.org;
libvirt-users@redhat.com
Subject: Re: [Qemu-devel] Qcow2

On Thu, May 19, 2011 at 3:24 PM,  &lt;arun.sasi1@wipro.com&gt; wrote:
&gt; I couldn't find any error when I do consistency check on the image
file...

Good, so there are no problems with your data.

&gt; What can be the reason for not starting the VM.

Did you find any more error messages besides the sound related errors
in /var/log/libvirt/qemu/&lt;domain&gt;.log?

&gt; Here I am suspecting when the base server go for reboot lesser image
will start and it cached and larger image will take more time to create
the cache...
&gt;
&gt; Was this correct... if yes could you please help me how to increase
the caching...

No, there is no "cache creation".  There is no startup delay for qcow2
image files.

Stefan

</body></email><email><emailId>20110530213620</emailId><senderName>Konstantin Svist</senderName><senderEmail>fry.kun@gmail.com</senderEmail><timestampReceived>2011-05-30 21:36:20-0400</timestampReceived><subject>[libvirt-users] no virtio in virt-manager</subject><body>

Hi,

For some reason, I don't have virtio as an option in virt-manager on one 
of my computers.
I'm using Fedora 14 with virt-preview repo, x64 architecture.

It must be some package that I missed, does anyone know what it might be?


Thanks

</body></email><email><emailId>20110531085852</emailId><senderName>PREETHI RAMESH</senderName><senderEmail>iampreethiramesh@gmail.com</senderEmail><timestampReceived>2011-05-31 08:58:52-0400</timestampReceived><subject>[libvirt-users] unable to migrate guests</subject><body>

I'm new to libvirt and I'm facing a problem while migrating the guest
domain.
Both guest and host are of the same config(checked it with uname -a)

Migrating using virsh, I get:

virsh # migrate hda2 --desturi qemu+ssh://root@10.129.54.254/system
root@10.129.54.254's password:
error: operation failed: migration to 'tcp:kvm-lab:49168' failed: migration
failed.


The details of the problem are shown by the Virtual machine manger are:

Unable to migrate guest: operation failed: migration to 'tcp:kvm-lab:49165'
failed: migration failed

Traceback (most recent call last):
  File "/usr/share/virt-manager/virtManager/asyncjob.py", line 45, in
cb_wrapper
    callback(asyncjob, *args, **kwargs)
  File "/usr/share/virt-manager/virtManager/migrate.py", line 523, in
_async_migrate
    vm.migrate(dstconn, migrate_uri, rate, live, secure, meter=meter)
  File "/usr/share/virt-manager/virtManager/domain.py", line 1141, in
migrate
    self._backend.migrate(destconn.vmm, flags, newname, interface, rate)
  File "/usr/lib/python2.7/dist-packages/libvirt.py", line 521, in migrate
    if ret is None:raise libvirtError('virDomainMigrate() failed', dom=self)
libvirtError: operation failed: migration to 'tcp:kvm-lab:49165' failed:
migration failed

I've tried disabling apparmor and then migrating by-
pre@pre-Inspiron-N4010:~$ sudo invoke-rc.d apparmor kill
.: 35: Can't open /lib/apparmor/functions
invoke-rc.d: initscript apparmor, action "kill" failed.

and
stopping iptables-
pre@pre-Inspiron-N4010:~$ sudo /etc/init.d/iptables stop
[sudo] password for pre:
sudo: /etc/init.d/iptables: command not found
Thank you.

[Attachment #3 (text/html)]

&lt;meta http-equiv="content-type" content="text/html; charset=utf-8"&gt;&lt;span \
class="Apple-style-span" style="border-collapse: collapse; font-family: arial, \
sans-serif; font-size: 13px; "&gt;&lt;div&gt;I'm new to libvirt and I'm facing a \
problem while migrating the guest domain. &lt;/div&gt; &lt;div&gt;Both guest and host are of the \
same config(checked it with uname -a)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Migrating using virsh, \
I get:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;virsh # migrate hda2 --desturi qemu+ssh://&lt;a \
href="http://root@10.129.54.254/system"&gt;root@10.129.54.254/system&lt;/a&gt;&lt;/div&gt; &lt;div&gt;&lt;a \
href="mailto:root@10.129.54.254"&gt;root@10.129.54.254&lt;/a&gt;'s password: \
&lt;/div&gt;&lt;div&gt;error: operation failed: migration to 'tcp:kvm-lab:49168' failed: \
migration failed.&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt; &lt;div&gt;The details of the \
problem are shown by the Virtual machine manger are:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Unable \
to migrate guest: operation failed: migration to 'tcp:kvm-lab:49165' failed: \
migration failed&lt;/div&gt;&lt;div&gt; &lt;br&gt;&lt;/div&gt;&lt;div&gt;Traceback (most recent call \
last):&lt;/div&gt;&lt;div&gt;  File "/usr/share/virt-manager/virtManager/asyncjob.py", \
line 45, in cb_wrapper&lt;/div&gt;&lt;div&gt;    callback(asyncjob, *args, **kwargs)&lt;/div&gt;&lt;div&gt;  \
File "/usr/share/virt-manager/virtManager/migrate.py", line 523, in \
_async_migrate&lt;/div&gt; &lt;div&gt;    vm.migrate(dstconn, migrate_uri, rate, live, secure, \
meter=meter)&lt;/div&gt;&lt;div&gt;  File \
"/usr/share/virt-manager/virtManager/domain.py", line 1141, in \
migrate&lt;/div&gt;&lt;div&gt;    self._backend.migrate(destconn.vmm, flags, newname, interface, \
rate)&lt;/div&gt; &lt;div&gt;  File "/usr/lib/python2.7/dist-packages/libvirt.py", line \
521, in migrate&lt;/div&gt;&lt;div&gt;    if ret is None:raise \
libvirtError('virDomainMigrate() failed', dom=self)&lt;/div&gt;&lt;div&gt;libvirtError: \
operation failed: migration to 'tcp:kvm-lab:49165' failed: migration \
failed&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I've tried disabling apparmor and then migrating \
by-&lt;/div&gt;&lt;div&gt;pre@pre-Inspiron-N4010:~$ sudo invoke-rc.d apparmor kill&lt;br&gt;&lt;div&gt;.: 35: \
Can't open /lib/apparmor/functions&lt;/div&gt;&lt;div&gt;invoke-rc.d: initscript apparmor, \
action "kill" failed.&lt;/div&gt; \
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;and&lt;/div&gt;&lt;div&gt;stopping iptables-&lt;/div&gt;&lt;div&gt;&lt;meta \
http-equiv="content-type" content="text/html; \
charset=utf-8"&gt;&lt;div&gt;pre@pre-Inspiron-N4010:~$ sudo /etc/init.d/iptables \
stop&lt;/div&gt;&lt;div&gt;[sudo] password for pre: &lt;/div&gt; &lt;div&gt;sudo: /etc/init.d/iptables: \
command not found&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Thank you.&lt;/div&gt;&lt;/span&gt;



</body></email></emails>