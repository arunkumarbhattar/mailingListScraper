<?xml version="1.0" encoding="utf-8"?>
<emails><email><emailId>20100115094513</emailId><senderName>Tom Hughes</senderName><senderEmail>tom@compton.nu</senderEmail><timestampReceived>2010-01-15 09:45:13-0400</timestampReceived><subject>[libvirt-users] libvirt restarting vms on restart?</subject><body>

Recent versions of libvirt seem to have taken to starting new copies of 
my vms when they restart.

Any vm marked to start when libvirt is started is started, even if it is 
already running, which leads to multiple running vms trying to use the 
same disk image.

I think this probably started with the upgrade from 0.7.4 to 0.7.5 but I 
can't be entirely sure as I only realised yesterday that I had somehow 
managed to get multiple instances of a VM running. It definitely 
happened this morning when the updated from 0.7.5.-1 to 0.7.5-3 in the 
F12 virt-preview repo caused a restart.

Tom

-- 
Tom Hughes (tom@compton.nu)
http://www.compton.nu/

</body></email><email><emailId>20100115110356</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-01-15 11:03:56-0400</timestampReceived><subject>Re: [libvirt-users] libvirt restarting vms on restart?</subject><body>

On Fri, Jan 15, 2010 at 09:45:13AM +0000, Tom Hughes wrote:
&gt; Recent versions of libvirt seem to have taken to starting new copies of 
&gt; my vms when they restart.
&gt; 
&gt; Any vm marked to start when libvirt is started is started, even if it is 
&gt; already running, which leads to multiple running vms trying to use the 
&gt; same disk image.
&gt; 
&gt; I think this probably started with the upgrade from 0.7.4 to 0.7.5 but I 
&gt; can't be entirely sure as I only realised yesterday that I had somehow 
&gt; managed to get multiple instances of a VM running. It definitely 
&gt; happened this morning when the updated from 0.7.5.-1 to 0.7.5-3 in the 
&gt; F12 virt-preview repo caused a restart.

It sounds like you are probably hitting this bug

  https://bugzilla.redhat.com/show_bug.cgi?id=550400

the trouble is I can't reproduce it myself. When you manually start a
VM, can you check whether the /var/run/libvirt/qemu/$GUEST.xml file
contains the monitor path info.

Daniel
-- 
|: Red Hat, Engineering, London   -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org  -o-  http://virt-manager.org  -o-  http://ovirt.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-  F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100115110821</emailId><senderName>Tom Hughes</senderName><senderEmail>tom@compton.nu</senderEmail><timestampReceived>2010-01-15 11:08:21-0400</timestampReceived><subject>Re: [libvirt-users] libvirt restarting vms on restart?</subject><body>

On 15/01/10 11:03, Daniel P. Berrange wrote:

&gt; It sounds like you are probably hitting this bug
&gt;
&gt;    https://bugzilla.redhat.com/show_bug.cgi?id=550400
&gt;
&gt; the trouble is I can't reproduce it myself. When you manually start a
&gt; VM, can you check whether the /var/run/libvirt/qemu/$GUEST.xml file
&gt; contains the monitor path info.

It doesn't, no. After I noticed the problem this morning I quickly 
killed both qemus with -9 to minimise disk access then restarted the VM 
from virt-manager and the xml file currently looks like:

&lt;domstatus state='running' pid='25809'&gt;
&lt;domain type='kvm' id='2'&gt;
...
&lt;/domain&gt;
&lt;/domstatus&gt;

Tom

-- 
Tom Hughes (tom@compton.nu)
http://www.compton.nu/

</body></email><email><emailId>20100114151503</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-01-14 15:15:03-0400</timestampReceived><subject>[libvirt-users] Testing 123...</subject><body>

...456

Daniel
-- 
|: Red Hat, Engineering, London   -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org  -o-  http://virt-manager.org  -o-  http://ovirt.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-  F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100115153437</emailId><senderName>"Neil Aggarwal"</senderName><senderEmail>neil@jammconsulting.com</senderEmail><timestampReceived>2010-01-15 15:34:37-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt] Set MAC address for host virtual interface?</subject><body>

Daniel:

This discussion used to be on the libvirt list, but seems
more appropriate for the users list so I am replying here.

&gt; At some time in the past we did set the MAC address on the 
&gt; host interface
&gt; too, but it caused networking problems in some configurations 

I see.  Thanks for the background info.

&gt; I guess you have Cacti configured to pull stats directly from the TAP
&gt; devices on the host ?

I am using bridging, but you are correct.  I installed snmpd and
have Cacti pulling stats from it.

&gt; Cacti has the ability to run scripts to pull
&gt; in statistics, so my recommendation would be to add a shell script which
&gt; calls the 'domifstat' command in virsh 
&gt;    virsh domifstat DOMNAME TAPDEVNAME

The Cacti server is running in a separate machine, not on the host.
I guess I will have to find something that makes the domifstat data
available via an snmp interface.

Do you know of such a tool?

Thanks,
	Neil

--
Neil Aggarwal, (281)846-8957, http://UnmeteredVPS.net/centos
CentOS 5.4 VPS with unmetered bandwidth only $25/month!
No overage charges, 7 day free trial, PayPal, Google Checkout

</body></email><email><emailId>20100118171728</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-01-18 17:17:28-0400</timestampReceived><subject>Re: [libvirt-users] libvirt restarting vms on restart?</subject><body>

On Fri, Jan 15, 2010 at 11:08:21AM +0000, Tom Hughes wrote:
&gt; On 15/01/10 11:03, Daniel P. Berrange wrote:
&gt; 
&gt; &gt;It sounds like you are probably hitting this bug
&gt; &gt;
&gt; &gt;   https://bugzilla.redhat.com/show_bug.cgi?id=550400
&gt; &gt;
&gt; &gt;the trouble is I can't reproduce it myself. When you manually start a
&gt; &gt;VM, can you check whether the /var/run/libvirt/qemu/$GUEST.xml file
&gt; &gt;contains the monitor path info.
&gt; 
&gt; It doesn't, no. After I noticed the problem this morning I quickly 
&gt; killed both qemus with -9 to minimise disk access then restarted the VM 
&gt; from virt-manager and the xml file currently looks like:
&gt; 
&gt; &lt;domstatus state='running' pid='25809'&gt;
&gt; &lt;domain type='kvm' id='2'&gt;
&gt; ...
&gt; &lt;/domain&gt;
&gt; &lt;/domstatus&gt;
&gt; 

FYI, I've posted a fix for this issue

http://www.redhat.com/archives/libvir-list/2010-January/msg00545.html


Daniel
-- 
|: Red Hat, Engineering, London   -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org  -o-  http://virt-manager.org  -o-  http://ovirt.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-  F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100122134529</emailId><senderName>Didier Moens</senderName><senderEmail>didier.moens@dmbr.vib-ugent.be</senderEmail><timestampReceived>2010-01-22 13:45:29-0400</timestampReceived><subject>Re: [libvirt-users] KVM virtio bonding bandwidth problem</subject><body>


Thank you for your swift answer, Daniel.


On 21/01/10 14:53, Daniel P. Berrange wrote:
&gt; You don't mention whether you've configured jumboframes on the NICs ? If you
&gt;   

Enabling jumbo frames on all interfaces does not seem to make a difference.

&gt;   net.bridge.bridge-nf-call-arptables = 0
&gt;   net.bridge.bridge-nf-call-iptables = 0
&gt;   net.bridge.bridge-nf-call-ip6tables = 0
&gt;   

The sysctl's were already set to 0.

&gt; That all said, i'm not too familiar with best practice recommendations for
&gt; KVM virtio networking, so you might like you post your questions to the
&gt; kvm-devel mailing list too where more of the experts are likely to see it
&gt;   


I'll cross-post to kvm@vger, and - for the archive's sake - post
appropriate feedback back here.


Regards,
Didier

-- 
===================================================================
Didier Moens                                            IT services
Department for Molecular Biomedical Research (DMBR)
VIB - Ghent University
Fiers-Schell-Van Montagu Research Building
Technologiepark 927 , B-9052 Zwijnaarde , Belgium
tel ++32(9)3313605  fax ++32(9)3313609
mailto:Didier.Moens@dmbr.vib-UGent.be      http://www.dmbr.UGent.be
===================================================================
This message represents the official view of the voices in my head.

</body></email><email><emailId>20100126212352</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-01-26 21:23:52-0400</timestampReceived><subject>Re: [libvirt-users] domain definition storage</subject><body>

On Tue, Jan 26, 2010 at 09:51:00PM +0100, Arik Raffael Funke wrote:
&gt; Hi Daniel,
&gt; 
&gt; &gt;libvirt never directly stores its XML files when talking to Xen - it
&gt; &gt;always uses one of the two Xen formats as the master database instead.
&gt; ...snipp...
&gt; &gt;On Xen&gt;  3.0.3  libvirt uses the native Xen APIs, which result in the
&gt; &gt;files being stored in /var/lib/xend/domains instead.
&gt; 
&gt; So if I change the files in /var/lib/xend/domains manually, the changes 
&gt; should stick, right? I tried that and occasionally the files revert to 
&gt; the previous version.

No, XenD gets very unhappy if you change those files manually and will
freely overwrite your changes. 

&gt; Could it be that the respective VM (or virt-manager?) must not be 
&gt; running while changing the domain configuration files? Does libvirt or 
&gt; xen store the domain configuration in memory while the machine/gui is 
&gt; running and write it back to the configuration file when the machine/gui 
&gt; shuts down?

If you want to update the guest config, you should always do it via the
libvirt APIs, or virsh tool,  eg  'virsh define GUEST.xml' or
'virsh edit GUESTNAME'. This ensures that XenD itself is always informed
of the changes.

Daniel
-- 
|: Red Hat, Engineering, London   -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org  -o-  http://virt-manager.org  -o-  http://ovirt.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-  F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100127110543</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-01-27 11:05:43-0400</timestampReceived><subject>Re: [libvirt-users] monitor option in libvirt ?</subject><body>

On Tue, Jan 26, 2010 at 08:33:27PM +0100, Riccardo Veraldi wrote:
&gt; 
&gt; because I wold like to do this:
&gt; 
&gt; 1) start qemu-kvm and redirect the monitor to a named pipe called let's 
&gt; say my.pipe
&gt; 
&gt; 2) write into the named pipe with a script when I want to take a 
&gt; snapshot, somthing like:
&gt; 
&gt;    echo "savevm mysnapshot"&gt;my.pipe
&gt; 
&gt; bascally I need to be able to access the monitor to issue a savevm 
&gt; command because I want to take
&gt; a snapshot of my qcow2 images.

That's not currently supported, but is being worked on

  http://www.redhat.com/archives/libvir-list/2010-January/msg00506.html

Daniel
-- 
|: Red Hat, Engineering, London   -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org  -o-  http://virt-manager.org  -o-  http://ovirt.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-  F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100121102907</emailId><senderName>Didier Moens</senderName><senderEmail>didier.moens@dmbr.vib-ugent.be</senderEmail><timestampReceived>2010-01-21 10:29:07-0400</timestampReceived><subject>[libvirt-users] KVM virtio bonding bandwidth problem</subject><body>


(first post)


Dear all,


I have been wrestling with this issue for the past few days ; googling
around doesn't seem to yield anything useful, hence this cry for help.



Setup :

- I am running several RHEL5.4 KVM virtio guest instances on a Dell PE
R805 RHEL5.4 host. Host and guests are fully updated ; I am using iperf
to test available bandwidth from 3 different locations (clients) in the
network to both the host and the guests .

- To increase both bandwidth and fail-over, 3 1Gb network interfaces
(BCM5708, bnx2 driver) on the host are bonded (802.3ad) to a 3 Gb/s
bond0, which is bridged. As all guest interfaces are connected to the
bridge, I would expect total available bandwidth to all guests to be in
the range of 2-2.5 Gb/s.

- Testing with one external client connection to the bare metal host
yields approx. 940 Mb/s ;

- Testing with 3 simultaneous connections to the host yields 2.5 Gb/s,
which confirms a successful bonding setup.


Problem :

Unfortunately, available bandwidth to the guests proves to be problematic :

1. One client to one guest : 250-600 Mb/s ;
2a. One client to 3 guests : 300-350 Mb/s to each guest, total not
exceeding 980 Mb/s;
2b. Three clients to 3 guests : 300-350 Mb/s to each guest ;
2c. Three clients to host and 2 guests : 940 Mb/s (host) + 500 Mb/s to
each guest.


Conclusions :

1. I am experiencing a 40% performance hit (600 Mb/s) on each individual
virtio guest connection ;
2. Total simultaneous bandwidth to all guests seems to be capped at 1
Gb/s ; quite problematic, as this renders my server consolidation almost
useless.


I could bridge each host network interface separately and assign guest
interfaces by hand, but that would defy the whole idea of load balancing
and failover which is provided by the host bonding.


Any ideas anyone, or am I peeking in the wrong direction (clueless
setup, flawed testing methodology, ...) ?



Thanks in advance for any help,
Didier

-- 
Didier Moens , IT services
Department for Molecular Biomedical Research (DMBR)
VIB - Ghent University


</body></email><email><emailId>20100126190019</emailId><senderName>Arik Raffael Funke</senderName><senderEmail>arik@funke.eu</senderEmail><timestampReceived>2010-01-26 19:00:19-0400</timestampReceived><subject>[libvirt-users] domain definition storage</subject><body>

Hi,

I defined several xen domains with libvirt. Can anybody tell me where 
libvirt stores these definitions? E.g. what files would one need to back up?

Is it correct, that the xen domain definitions in /var/lib/xend/domains 
are overwritten regularly by libvirt?

Many thanks,
Arik

</body></email><email><emailId>20100126125213</emailId><senderName>Riccardo Veraldi</senderName><senderEmail>riccardo.veraldi@cnaf.infn.it</senderEmail><timestampReceived>2010-01-26 12:52:13-0400</timestampReceived><subject>[libvirt-users] monitor option in libvirt ?</subject><body>

Hello,

I woudl liek to start qemu-kvm with -monitor myfile.pipe options
instead of default -monitor pty

Anyway I have not found any way to tell libvirt (using virsh) that I 
want to set a specific
-monitor option to the qemu-kvm command line.

How can I do this ?
I do not want to start manually qemu-kvm because in this way I will 
loose the libvirt VM management

thanks

Rick

</body></email><email><emailId>20100126125800</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-01-26 12:58:00-0400</timestampReceived><subject>Re: [libvirt-users] monitor option in libvirt ?</subject><body>

On Tue, Jan 26, 2010 at 01:52:13PM +0100, Riccardo Veraldi wrote:
&gt; Hello,
&gt; 
&gt; I woudl liek to start qemu-kvm with -monitor myfile.pipe options
&gt; instead of default -monitor pty
&gt; 
&gt; Anyway I have not found any way to tell libvirt (using virsh) that I 
&gt; want to set a specific
&gt; -monitor option to the qemu-kvm command line.
&gt; How can I do this ?

libvirt controls the monitor interface so it can manage the guest while it
is running.  As such we don't give users access to it, since having two
different things changing the running guest state is a recipe for trouble

Why do you need to acess the monitor directly ?  Our goal is to expose
APIs for any monitor command that users would need to use in administrative
tasks

Regards,
Daniel
-- 
|: Red Hat, Engineering, London   -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org  -o-  http://virt-manager.org  -o-  http://ovirt.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-  F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100126193327</emailId><senderName>Riccardo Veraldi</senderName><senderEmail>riccardo.veraldi@cnaf.infn.it</senderEmail><timestampReceived>2010-01-26 19:33:27-0400</timestampReceived><subject>Re: [libvirt-users] monitor option in libvirt ?</subject><body>


because I wold like to do this:

1) start qemu-kvm and redirect the monitor to a named pipe called let's 
say my.pipe

2) write into the named pipe with a script when I want to take a 
snapshot, somthing like:

    echo "savevm mysnapshot"&gt;my.pipe


bascally I need to be able to access the monitor to issue a savevm 
command because I want to take
a snapshot of my qcow2 images.

How could I do it otherwise ?

thank you

Rick






Daniel P. Berrange wrote:
&gt; On Tue, Jan 26, 2010 at 01:52:13PM +0100, Riccardo Veraldi wrote:
&gt;   
&gt;&gt; Hello,
&gt;&gt;
&gt;&gt; I woudl liek to start qemu-kvm with -monitor myfile.pipe options
&gt;&gt; instead of default -monitor pty
&gt;&gt;
&gt;&gt; Anyway I have not found any way to tell libvirt (using virsh) that I 
&gt;&gt; want to set a specific
&gt;&gt; -monitor option to the qemu-kvm command line.
&gt;&gt; How can I do this ?
&gt;&gt;     
&gt;
&gt; libvirt controls the monitor interface so it can manage the guest while it
&gt; is running.  As such we don't give users access to it, since having two
&gt; different things changing the running guest state is a recipe for trouble
&gt;
&gt; Why do you need to acess the monitor directly ?  Our goal is to expose
&gt; APIs for any monitor command that users would need to use in administrative
&gt; tasks
&gt;
&gt; Regards,
&gt; Daniel
&gt;   

</body></email><email><emailId>20100126190843</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-01-26 19:08:43-0400</timestampReceived><subject>Re: [libvirt-users] domain definition storage</subject><body>

On Tue, Jan 26, 2010 at 08:00:19PM +0100, Arik Raffael Funke wrote:
&gt; Hi,
&gt; 
&gt; I defined several xen domains with libvirt. Can anybody tell me where 
&gt; libvirt stores these definitions? E.g. what files would one need to back up?
&gt; 
&gt; Is it correct, that the xen domain definitions in /var/lib/xend/domains 
&gt; are overwritten regularly by libvirt?

libvirt never directly stores its XML files when talking to Xen - it
always uses one of the two Xen formats as the master database instead.

On Xen &lt;= 3.0.3  libvirt uses the files in /etc/xen 

On Xen &gt; 3.0.3  libvirt uses the native Xen APIs, which result in the 
files being stored in /var/lib/xend/domains instead.

Regards,
Daniel
-- 
|: Red Hat, Engineering, London   -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org  -o-  http://virt-manager.org  -o-  http://ovirt.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-  F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100127123004</emailId><senderName>Matthew Farrellee</senderName><senderEmail>matt@redhat.com</senderEmail><timestampReceived>2010-01-27 12:30:04-0400</timestampReceived><subject>[libvirt-users] domain -&gt; IP</subject><body>

How can I map from a domain to the IP(s) given to its network interfaces?

I'm not specifying a &lt;mac .../&gt; to the domain, so I don't have an upfront mapping \
setup.

Is the best way to do some upfront mapping, e.g. install static MAC -&gt; IP in the DHCP \
server and add &lt;mac .../&gt; to my domains?

Best,


matt


</body></email><email><emailId>20100125134501</emailId><senderName>Matthew Farrellee</senderName><senderEmail>matt@redhat.com</senderEmail><timestampReceived>2010-01-25 13:45:01-0400</timestampReceived><subject>[libvirt-users] Stealing ownership: chown user-&gt;qemu-&gt;root</subject><body>

F12, libvirt 0.7.1-15, qemu 0.11.0-12, 32 bit

I recently discovered that libvirt is stealing ownership of my disk images. How can I \
make it stop?

I have a disk image in my home directory, owned by matt. When I create a domain that \
uses the disk it gets chowned to qemu.qemu. When the domain terminates it is owned by \
root.root. I've lost access to the file.

It has been suggested that the user-&gt;qemu happens to make sure that the qemu account \
can read/write the file. chmod'ing would be far better and avoid this problem. It \
appears that libvirt just assumes the disk image was owned by root before being \
chown'd to qemu.

Another problem with this is qcow disks. If chown'ing to qemu is to ensure that qemu \
has access to all the disks needed for the domain, it fails for qcow, because the \
base disk is not chown'd as well. This can result in a very cryptic error message \
(funny period (.)):

  monitor socket did not show up.: No such file or directory

For instance, base.img is owned by matt (u=rw,go=), a qcow disk qcow.img is linked to \
base.img. When a domain using qcow.img is created qcow.img is owned to qemu, but \
base.img is not.

Instead of chown'ing, will libvirt provide an error that could cover both these \
situations? The virt-manager GUI (or virsh TUI) could interpret that error and chmod \
the proper files transparently, or preemptively chmod the required files. Users of \
the libvirt API would have to make sure things are setup properly at first and would \
not have to worry about side-effect changes made by libvirtd.

I think the suggestion holds even if is only the qemu driver doing the chown.

Best,


matt


</body></email><email><emailId>20100120045412</emailId><senderName>"Neil Aggarwal"</senderName><senderEmail>neil@jammconsulting.com</senderEmail><timestampReceived>2010-01-20 04:54:12-0400</timestampReceived><subject>[libvirt-users] How to debug Ubuntu 8.04 LTS guest crash during install?</subject><body>

Hello:

I am using kvm on a CentOS 5.4 server.

I am trying to install the TunkeyLinux Core appliance 
found here: http://www.turnkeylinux.org/core

I downloaded the ISO file from the web site.

Then, I used this command to intall it:
virt-install -n tkl-core -r 512 --vcpus=1 --check-cpu --os-type=linux 
--os-variant=ubuntuhardy -v --accelerate 
-c /tmp/turnkey-core-2009.10-hardy-x86.iso 
-f /var/lib/libvirt/images/tkl-core.img -s 15 -b br0 --vnc noautoconsole

When I connect to the VNC console, I get the Turnkey linux 
options screen.
I select Install to hard disk from there and it seems to 
start the install but crashes during the installer startup.

This is repeatable so there has to be a way to debug it.

I tried turning on the debug option for virt-install but that
did not give me any useful info.

Any ideas how to debug this?

Thanks,
	Neil

--
Neil Aggarwal, (281)846-8957, http://UnmeteredVPS.net/cpanel
cPanel/WHM preinstalled on a virtual server for only $40/month!
No overage charges, 7 day free trial, PayPal, Google Checkout

</body></email><email><emailId>20100131041452</emailId><senderName>Philip Nelson</senderName><senderEmail>philip@whatsbeef.net</senderEmail><timestampReceived>2010-01-31 04:14:52-0400</timestampReceived><subject>[libvirt-users] poor network performance to one of two guests</subject><body>

G'day, I have a host running two kvm guests. One of them gets very poor network
performance, testing with iperf I get ~10MBit/sec to guest A, &gt;400MBit/sec to
guest B (running iperf between the host/guest). Both guests are using the same
bridge:

Guest A:
    &lt;interface type='bridge'&gt;
      &lt;mac address='54:52:00:75:24:91'/&gt;
      &lt;source bridge='br0'/&gt;
    &lt;/interface&gt;

Guest B:
    &lt;interface type='bridge'&gt;
      &lt;mac address='54:52:00:3b:13:2a'/&gt;
      &lt;source bridge='br0'/&gt;
    &lt;/interface&gt;

The host and guests are debian lenny, the host I have updated with some packages
from backports.org. The host is running 2.6.30 with qemu-kvm 0.12.2 and libvirt
0.7.5. The host has 8gig ram and a quad core xeon cpu. Each guest is given one
vcpu, guest A has 3gig memory, guest B 1gig.

I have tried starting them in a different order so that one gets vnet0 and one
gets vnet1, it doesn't make a difference, it's always guest A that is slow.

I'm a bit stuck here, I don't know what else to try. Below is some information
for the host/guests, not sure what might be helpful:

ifconfig eth1/br0/vnet0/1 output from the host:

eth1      Link encap:Ethernet  HWaddr 00:25:64:3b:65:de  
          inet6 addr: fe80::225:64ff:fe3b:65de/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:7828 errors:0 dropped:0 overruns:0 frame:0
          TX packets:6664 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:4034843 (3.8 MiB)  TX bytes:466838 (455.8 KiB)
          Interrupt:17 

br0       Link encap:Ethernet  HWaddr 00:25:64:3b:65:de  
          inet addr:192.168.108.1  Bcast:192.168.108.255  Mask:255.255.255.0
          inet6 addr: fe80::225:64ff:fe3b:65de/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:110047 errors:0 dropped:0 overruns:0 frame:0
          TX packets:111420 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:5744145 (5.4 MiB)  TX bytes:870431296 (830.1 MiB)

vnet0     Link encap:Ethernet  HWaddr 72:48:bc:10:45:d4  
          inet6 addr: fe80::7048:bcff:fe10:45d4/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:107881 errors:0 dropped:0 overruns:0 frame:0
          TX packets:581468 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:500 
          RX bytes:7129781 (6.7 MiB)  TX bytes:873414210 (832.9 MiB)

vnet1     Link encap:Ethernet  HWaddr 36:20:fc:df:52:66  
          inet6 addr: fe80::3420:fcff:fedf:5266/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:7918 errors:0 dropped:0 overruns:0 frame:0
          TX packets:21692 errors:0 dropped:0 overruns:16236 carrier:0
          collisions:0 txqueuelen:500 
          RX bytes:534843 (522.3 KiB)  TX bytes:32575099 (31.0 MiB)


# brctl show:
bridge name	bridge id		STP enabled	interfaces
br0		8000.0025643b65de	no		eth1
							vnet0
							vnet1
# lsmod | grep kvm
kvm_intel              47336  6 
kvm                   159032  1 kvm_intel

ifconfig output from guest A:
eth0      Link encap:Ethernet  HWaddr 54:52:00:75:24:91  
          inet addr:192.168.108.100  Bcast:192.168.108.0  Mask:255.255.255.0
          inet6 addr: fe80::5652:ff:fe75:2491/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:21708 errors:0 dropped:0 overruns:0 frame:0
          TX packets:8155 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:32576795 (31.0 MiB)  TX bytes:553329 (540.3 KiB)
          Interrupt:10 

ifconfig output from guest B:
eth0      Link encap:Ethernet  HWaddr 54:52:00:3b:13:2a  
          inet addr:192.168.108.101  Bcast:192.168.108.0  Mask:255.255.255.0
          inet6 addr: fe80::5652:ff:fe3b:132a/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:582733 errors:0 dropped:18 overruns:0 frame:0
          TX packets:109328 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:865856730 (825.7 MiB)  TX bytes:7230359 (6.8 MiB)
          Interrupt:10 Base address:0xe000 

Here is the guest A definition:

&lt;domain type='kvm'&gt;
  &lt;name&gt;guestA&lt;/name&gt;
  &lt;uuid&gt;a32a9d3b-e5ae-5943-c6db-52bc118f99c6&lt;/uuid&gt;
  &lt;memory&gt;3145728&lt;/memory&gt;
  &lt;currentMemory&gt;3145728&lt;/currentMemory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='x86_64' machine='pc'&gt;hvm&lt;/type&gt;
    &lt;boot dev='hd'/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
    &lt;apic/&gt;
    &lt;pae/&gt;
  &lt;/features&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;restart&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;source file='/var/lib/libvirt/images/guestA'/&gt;
      &lt;target dev='vda' bus='virtio'/&gt;
    &lt;/disk&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;source file='/var/lib/libvirt/images/guestA-data.img'/&gt;
      &lt;target dev='vdb' bus='virtio'/&gt;
    &lt;/disk&gt;
    &lt;interface type='bridge'&gt;
      &lt;mac address='54:52:00:75:24:91'/&gt;
      &lt;source bridge='br0'/&gt;
    &lt;/interface&gt;
    &lt;serial type='pty'&gt;
      &lt;target port='0'/&gt;
    &lt;/serial&gt;
    &lt;console type='pty'&gt;
      &lt;target port='0'/&gt;
    &lt;/console&gt;
    &lt;input type='mouse' bus='ps2'/&gt;
    &lt;graphics type='vnc' port='-1' autoport='yes' keymap='en-us'/&gt;
  &lt;/devices&gt;
&lt;/domain&gt;

And guest B:

&lt;domain type='kvm'&gt;
  &lt;name&gt;guestB&lt;/name&gt;
  &lt;uuid&gt;1816a68e-929c-0b36-41ac-a380a4062298&lt;/uuid&gt;
  &lt;memory&gt;1048576&lt;/memory&gt;
  &lt;currentMemory&gt;1048576&lt;/currentMemory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='x86_64' machine='pc'&gt;hvm&lt;/type&gt;
    &lt;boot dev='hd'/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
    &lt;apic/&gt;
    &lt;pae/&gt;
  &lt;/features&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;restart&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;source file='/var/lib/libvirt/images/guestB'/&gt;
      &lt;target dev='vda' bus='virtio'/&gt;
    &lt;/disk&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;source file='/var/lib/libvirt/images/guestB-data.img'/&gt;
      &lt;target dev='vdb' bus='virtio'/&gt;
    &lt;/disk&gt;
    &lt;interface type='bridge'&gt;
      &lt;mac address='54:52:00:3b:13:2a'/&gt;
      &lt;source bridge='br0'/&gt;
    &lt;/interface&gt;
    &lt;serial type='pty'&gt;
      &lt;target port='0'/&gt;
    &lt;/serial&gt;
    &lt;console type='pty'&gt;
      &lt;target port='0'/&gt;
    &lt;/console&gt;
    &lt;input type='mouse' bus='ps2'/&gt;
    &lt;graphics type='vnc' port='-1' autoport='yes' keymap='en-us'/&gt;
  &lt;/devices&gt;
&lt;/domain&gt;

Any help would be greatly appreciated.

-- Philip

</body></email><email><emailId>20100127132501</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-01-27 13:25:01-0400</timestampReceived><subject>Re: [libvirt-users] How to debug Ubuntu 8.04 LTS guest crash during install?</subject><body>

On Tue, Jan 19, 2010 at 10:54:12PM -0600, Neil Aggarwal wrote:
&gt; Hello:
&gt; 
&gt; I am using kvm on a CentOS 5.4 server.
&gt; 
&gt; I am trying to install the TunkeyLinux Core appliance 
&gt; found here: http://www.turnkeylinux.org/core
&gt; 
&gt; I downloaded the ISO file from the web site.
&gt; 
&gt; Then, I used this command to intall it:
&gt; virt-install -n tkl-core -r 512 --vcpus=1 --check-cpu --os-type=linux 
&gt; --os-variant=ubuntuhardy -v --accelerate 
&gt; -c /tmp/turnkey-core-2009.10-hardy-x86.iso 
&gt; -f /var/lib/libvirt/images/tkl-core.img -s 15 -b br0 --vnc noautoconsole
&gt; 
&gt; When I connect to the VNC console, I get the Turnkey linux 
&gt; options screen.
&gt; I select Install to hard disk from there and it seems to 
&gt; start the install but crashes during the installer startup.
&gt; 
&gt; This is repeatable so there has to be a way to debug it.
&gt; 
&gt; I tried turning on the debug option for virt-install but that
&gt; did not give me any useful info.

virt-install debug options only relate to host side debugging. From your
description it sounds like the crashes is guest side, so you'd likely
need to set guest kenrel debug options - eg make it log to the serial
console at boot time so you see guest kernel messages

Daniel
-- 
|: Red Hat, Engineering, London   -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org  -o-  http://virt-manager.org  -o-  http://ovirt.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-  F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100125173333</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-01-25 17:33:33-0400</timestampReceived><subject>Re: [libvirt-users] Stealing ownership: chown user-&gt;qemu-&gt;root</subject><body>

On Mon, Jan 25, 2010 at 08:45:01AM -0500, Matthew Farrellee wrote:
&gt; F12, libvirt 0.7.1-15, qemu 0.11.0-12, 32 bit
&gt; 
&gt; I recently discovered that libvirt is stealing ownership of my disk
&gt; images. How can I make it stop?

Edit /etc/libvirt/qemu.conf and set the 'user' and 'group' config options
back to 'root'.  NB all your guests will now run as root again, instead
of as 'qemu', and you'll need to make sure your disk images are owned by
root too since QEMU lacks CAP_DAC_OVERRIDE which is what 'root' normally
uses to access other users' files.

NB, current libvirt git has an explicit option to turn off file ownership
management, meaning it is upto end user to ensure it is writable by
the QEMU user when required.

&gt; I have a disk image in my home directory, owned by matt. When I create
&gt; a domain that uses the disk it gets chowned to qemu.qemu. When the domain
&gt; terminates it is owned by root.root. I've lost access to the file.
&gt; 
&gt; It has been suggested that the user-&gt;qemu happens to make sure that the
&gt; qemu account can read/write the file. chmod'ing would be far better and
&gt; avoid this problem. It appears that libvirt just assumes the disk image
&gt; was owned by root before being chown'd to qemu.

The only option with chmod'ing would be to give it world read/write
access, which is less desirable because it means other daemons on the
system could access it which is a security hole. We went for chmod
because it lets us ensure only QEMU can access it.

One other option we can investigate though is to use  setfacl() to add
an ACL for the 'qemu' user. This might have interoperability problems,
but it would at least avoid the problem of ownership restoration.

&gt; Another problem with this is qcow disks. If chown'ing to qemu is to
&gt; ensure that qemu has access to all the disks needed for the domain, 
&gt; it fails for qcow, because the base disk is not chown'd as well. 

That's a bug in the F12 code, which we've addressed in GIT - it should
have been processing backing files too.

&gt; Instead of chown'ing, will libvirt provide an error that could cover 
&gt; both these situations? The virt-manager GUI (or virsh TUI) could 
&gt; interpret that error and chmod the proper files transparently, or 
&gt; preemptively chmod the required files. Users of the libvirt API would
&gt; have to make sure things are setup properly at first and would not 
&gt; have to worry about side-effect changes made by libvirtd.

The idea for the future is that apps use the storage APIs to create disk
files, which lets them directly request the correct ownership. You can't
delegate the chmod() itself to virt-manager because that app will either
not be running on the same machine as the VM, or possibly not have sufficient
privileges to change the access to allow QEMU.

The second issue, is that this is all wrt the libvirt system daemon instance.
This is intended for server virt. Your use case is really desktop virt and
for that we are getting ready to switch to the libvirt session daemon 
instance where absolutely everything runs as your own user ID, so there'd
be no switching of UIDs at all.

Regards,
Daniel
-- 
|: Red Hat, Engineering, London   -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org  -o-  http://virt-manager.org  -o-  http://ovirt.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-  F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100127122441</emailId><senderName>Matthew Farrellee</senderName><senderEmail>matt@redhat.com</senderEmail><timestampReceived>2010-01-27 12:24:41-0400</timestampReceived><subject>Re: [libvirt-users] Stealing ownership: chown user-&gt;qemu-&gt;root</subject><body>

Thanks for the quick reply.

On 01/25/2010 12:33 PM, Daniel P. Berrange wrote:
&gt; On Mon, Jan 25, 2010 at 08:45:01AM -0500, Matthew Farrellee wrote:
&gt; &gt; F12, libvirt 0.7.1-15, qemu 0.11.0-12, 32 bit
&gt; &gt; 
&gt; &gt; I recently discovered that libvirt is stealing ownership of my disk
&gt; &gt; images. How can I make it stop?
&gt; 
&gt; Edit /etc/libvirt/qemu.conf and set the 'user' and 'group' config options
&gt; back to 'root'.  NB all your guests will now run as root again, instead
&gt; of as 'qemu', and you'll need to make sure your disk images are owned by
&gt; root too since QEMU lacks CAP_DAC_OVERRIDE which is what 'root' normally
&gt; uses to access other users' files.

I'm guessing I could also change this to a user other than qemu or root. Is this \
something I can change on a per guest basis?


&gt; NB, current libvirt git has an explicit option to turn off file ownership
&gt; management, meaning it is upto end user to ensure it is writable by
&gt; the QEMU user when required.

This is good to hear. When will the feature show up?

I assume such a feature will mean files don't end up owned at root after the domain \
is destroyed.


&gt; &gt; I have a disk image in my home directory, owned by matt. When I create
&gt; &gt; a domain that uses the disk it gets chowned to qemu.qemu. When the domain
&gt; &gt; terminates it is owned by root.root. I've lost access to the file.
&gt; &gt; 
&gt; &gt; It has been suggested that the user-&gt;qemu happens to make sure that the
&gt; &gt; qemu account can read/write the file. chmod'ing would be far better and
&gt; &gt; avoid this problem. It appears that libvirt just assumes the disk image
&gt; &gt; was owned by root before being chown'd to qemu.
&gt; 
&gt; The only option with chmod'ing would be to give it world read/write
&gt; access, which is less desirable because it means other daemons on the
&gt; system could access it which is a security hole. We went for chmod
&gt; because it lets us ensure only QEMU can access it.
&gt; 
&gt; One other option we can investigate though is to use  setfacl() to add
&gt; an ACL for the 'qemu' user. This might have interoperability problems,
&gt; but it would at least avoid the problem of ownership restoration.

You already lock down /var/lib/libvirt/images, but if someone could guess a VM's disk \
image I can see the problem.


&gt; &gt; Another problem with this is qcow disks. If chown'ing to qemu is to
&gt; &gt; ensure that qemu has access to all the disks needed for the domain, 
&gt; &gt; it fails for qcow, because the base disk is not chown'd as well. 
&gt; 
&gt; That's a bug in the F12 code, which we've addressed in GIT - it should
&gt; have been processing backing files too.

Great.


&gt; &gt; Instead of chown'ing, will libvirt provide an error that could cover 
&gt; &gt; both these situations? The virt-manager GUI (or virsh TUI) could 
&gt; &gt; interpret that error and chmod the proper files transparently, or 
&gt; &gt; preemptively chmod the required files. Users of the libvirt API would
&gt; &gt; have to make sure things are setup properly at first and would not 
&gt; &gt; have to worry about side-effect changes made by libvirtd.
&gt; 
&gt; The idea for the future is that apps use the storage APIs to create disk
&gt; files, which lets them directly request the correct ownership. You can't
&gt; delegate the chmod() itself to virt-manager because that app will either
&gt; not be running on the same machine as the VM, or possibly not have sufficient
&gt; privileges to change the access to allow QEMU.

Good point about remote, which isn't a common use case for me at all.

BTW, I noticed on EL5 that I got AVCs when trying to install a VM from an ISO in my \
home directory. I'm guessing in the future virt-manager will manipulate the ISO with \
these APIs and not have such a problem?


&gt; The second issue, is that this is all wrt the libvirt system daemon instance.
&gt; This is intended for server virt. Your use case is really desktop virt and
&gt; for that we are getting ready to switch to the libvirt session daemon 
&gt; instance where absolutely everything runs as your own user ID, so there'd
&gt; be no switching of UIDs at all.

Cool. When is this happening? Hopefully for EL6.


Best,


matt


</body></email><email><emailId>20100126205100</emailId><senderName>Arik Raffael Funke</senderName><senderEmail>arik@funke.eu</senderEmail><timestampReceived>2010-01-26 20:51:00-0400</timestampReceived><subject>Re: [libvirt-users] domain definition storage</subject><body>

Hi Daniel,

&gt; libvirt never directly stores its XML files when talking to Xen - it
&gt; always uses one of the two Xen formats as the master database instead.
...snipp...
&gt; On Xen&gt;  3.0.3  libvirt uses the native Xen APIs, which result in the
&gt; files being stored in /var/lib/xend/domains instead.

So if I change the files in /var/lib/xend/domains manually, the changes 
should stick, right? I tried that and occasionally the files revert to 
the previous version.

Could it be that the respective VM (or virt-manager?) must not be 
running while changing the domain configuration files? Does libvirt or 
xen store the domain configuration in memory while the machine/gui is 
running and write it back to the configuration file when the machine/gui 
shuts down?

Thank,
Arik

</body></email><email><emailId>20100121135334</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-01-21 13:53:34-0400</timestampReceived><subject>Re: [libvirt-users] KVM virtio bonding bandwidth problem</subject><body>

On Thu, Jan 21, 2010 at 11:29:07AM +0100, Didier Moens wrote:
&gt; 
&gt; (first post)
&gt; 
&gt; 
&gt; Dear all,
&gt; 
&gt; 
&gt; I have been wrestling with this issue for the past few days ; googling
&gt; around doesn't seem to yield anything useful, hence this cry for help.
&gt; 
&gt; 
&gt; 
&gt; Setup :
&gt; 
&gt; - I am running several RHEL5.4 KVM virtio guest instances on a Dell PE
&gt; R805 RHEL5.4 host. Host and guests are fully updated ; I am using iperf
&gt; to test available bandwidth from 3 different locations (clients) in the
&gt; network to both the host and the guests .
&gt; 
&gt; - To increase both bandwidth and fail-over, 3 1Gb network interfaces
&gt; (BCM5708, bnx2 driver) on the host are bonded (802.3ad) to a 3 Gb/s
&gt; bond0, which is bridged. As all guest interfaces are connected to the
&gt; bridge, I would expect total available bandwidth to all guests to be in
&gt; the range of 2-2.5 Gb/s.
&gt; 
&gt; - Testing with one external client connection to the bare metal host
&gt; yields approx. 940 Mb/s ;
&gt; 
&gt; - Testing with 3 simultaneous connections to the host yields 2.5 Gb/s,
&gt; which confirms a successful bonding setup.
&gt; 
&gt; 
&gt; Problem :
&gt; 
&gt; Unfortunately, available bandwidth to the guests proves to be problematic :
&gt; 
&gt; 1. One client to one guest : 250-600 Mb/s ;
&gt; 2a. One client to 3 guests : 300-350 Mb/s to each guest, total not
&gt; exceeding 980 Mb/s;
&gt; 2b. Three clients to 3 guests : 300-350 Mb/s to each guest ;
&gt; 2c. Three clients to host and 2 guests : 940 Mb/s (host) + 500 Mb/s to
&gt; each guest.
&gt; 
&gt; 
&gt; Conclusions :
&gt; 
&gt; 1. I am experiencing a 40% performance hit (600 Mb/s) on each individual
&gt; virtio guest connection ;
&gt; 2. Total simultaneous bandwidth to all guests seems to be capped at 1
&gt; Gb/s ; quite problematic, as this renders my server consolidation almost
&gt; useless.
&gt; 
&gt; 
&gt; I could bridge each host network interface separately and assign guest
&gt; interfaces by hand, but that would defy the whole idea of load balancing
&gt; and failover which is provided by the host bonding.
&gt; 
&gt; 
&gt; Any ideas anyone, or am I peeking in the wrong direction (clueless
&gt; setup, flawed testing methodology, ...) ?

You don't mention whether you've configured jumboframes on the NICs ? If you
have GB networking, you typically need to increase the MTU on all NICs, including
the bridge itself in order to get the most bandwidth out of your network. IIUC,
this is particularly important for guest networking since context switches for
small packets have bad effect on throughput. Also make sure that the sysctls
for  

  net.bridge.bridge-nf-call-arptables = 0
  net.bridge.bridge-nf-call-iptables = 0
  net.bridge.bridge-nf-call-ip6tables = 0

are all set to '0', since iptables adds overhead to the networking stack, again
made particularly bad with bridging since it means results in extra data copies
not allowing full use of TX-offload.

That all said, i'm not too familiar with best practice recommendations for
KVM virtio networking, so you might like you post your questions to the
kvm-devel mailing list too where more of the experts are likely to see it

Regards,
Daniel
-- 
|: Red Hat, Engineering, London   -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org  -o-  http://virt-manager.org  -o-  http://ovirt.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-  F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100127131853</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-01-27 13:18:53-0400</timestampReceived><subject>Re: [libvirt-users] domain -&gt; IP</subject><body>

On Wed, Jan 27, 2010 at 07:30:04AM -0500, Matthew Farrellee wrote:
&gt; How can I map from a domain to the IP(s) given to its network interfaces?
&gt; 
&gt; I'm not specifying a &lt;mac .../&gt; to the domain, so I don't have an upfront mapping setup.
&gt; 
&gt; Is the best way to do some upfront mapping, e.g. install static MAC -&gt; IP
&gt;  in the DHCP server and add &lt;mac .../&gt; to my domains?

Yes, you want to setup static MAC &lt;-&gt; IP mapping, then give a specific
MAC to the guest at install time - virt-install and virt-manager both
have options for setting an explicit MAC instead of auto-generating

Daniel
-- 
|: Red Hat, Engineering, London   -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org  -o-  http://virt-manager.org  -o-  http://ovirt.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-  F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100127132308</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-01-27 13:23:08-0400</timestampReceived><subject>Re: [libvirt-users] Stealing ownership: chown user-&gt;qemu-&gt;root</subject><body>

On Wed, Jan 27, 2010 at 07:24:41AM -0500, Matthew Farrellee wrote:
&gt; Thanks for the quick reply.
&gt; 
&gt; On 01/25/2010 12:33 PM, Daniel P. Berrange wrote:
&gt; &gt; On Mon, Jan 25, 2010 at 08:45:01AM -0500, Matthew Farrellee wrote:
&gt; &gt;&gt; F12, libvirt 0.7.1-15, qemu 0.11.0-12, 32 bit
&gt; &gt;&gt;
&gt; &gt;&gt; I recently discovered that libvirt is stealing ownership of my disk
&gt; &gt;&gt; images. How can I make it stop?
&gt; &gt; 
&gt; &gt; Edit /etc/libvirt/qemu.conf and set the 'user' and 'group' config options
&gt; &gt; back to 'root'.  NB all your guests will now run as root again, instead
&gt; &gt; of as 'qemu', and you'll need to make sure your disk images are owned by
&gt; &gt; root too since QEMU lacks CAP_DAC_OVERRIDE which is what 'root' normally
&gt; &gt; uses to access other users' files.
&gt; 
&gt; I'm guessing I could also change this to a user other than qemu or root.
&gt; Is this something I can change on a per guest basis?

It is changable on a per-host basis only. While you could change it to
anything, our recommendation is to stick with just qemu or root as 
needed. It is primarily for the distro to determine the default unprivileged
user account.

&gt; &gt; NB, current libvirt git has an explicit option to turn off file ownership
&gt; &gt; management, meaning it is upto end user to ensure it is writable by
&gt; &gt; the QEMU user when required.
&gt; 
&gt; This is good to hear. When will the feature show up?

In the next releae...

&gt; I assume such a feature will mean files don't end up owned at root
&gt; after the domain is destroyed.

Yes, that's correct - it stops all ownership changes.

&gt; 
&gt; &gt;&gt; Instead of chown'ing, will libvirt provide an error that could cover 
&gt; &gt;&gt; both these situations? The virt-manager GUI (or virsh TUI) could 
&gt; &gt;&gt; interpret that error and chmod the proper files transparently, or 
&gt; &gt;&gt; preemptively chmod the required files. Users of the libvirt API would
&gt; &gt;&gt; have to make sure things are setup properly at first and would not 
&gt; &gt;&gt; have to worry about side-effect changes made by libvirtd.
&gt; &gt; 
&gt; &gt; The idea for the future is that apps use the storage APIs to create disk
&gt; &gt; files, which lets them directly request the correct ownership. You can't
&gt; &gt; delegate the chmod() itself to virt-manager because that app will either
&gt; &gt; not be running on the same machine as the VM, or possibly not have sufficient
&gt; &gt; privileges to change the access to allow QEMU.
&gt; 
&gt; Good point about remote, which isn't a common use case for me at all.
&gt; 
&gt; BTW, I noticed on EL5 that I got AVCs when trying to install a VM from
&gt; an ISO in my home directory. I'm guessing in the future virt-manager
&gt; will manipulate the ISO with these APIs and not have such a problem?

RHEL5 does not have the sVirt support, so its the users responsibility to
ensure correct SELinux labelling if storing images in unusual locations.
RHEL6 / Fedora &gt;= 11 has sVirt which takes care of setting all labelling
so it should not be a problem, except in arena of NFS or other really
rubbish filesystems like FAT.

&gt; &gt; The second issue, is that this is all wrt the libvirt system daemon instance.
&gt; &gt; This is intended for server virt. Your use case is really desktop virt and
&gt; &gt; for that we are getting ready to switch to the libvirt session daemon 
&gt; &gt; instance where absolutely everything runs as your own user ID, so there'd
&gt; &gt; be no switching of UIDs at all.
&gt; 
&gt; Cool. When is this happening? Hopefully for EL6.

Not likely for RHEL-6.0, but in perhaps a later update. It is dependant
on us sorting out the final issue of setting up networking as an unprivilegd
user

Daniel
-- 
|: Red Hat, Engineering, London   -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org  -o-  http://virt-manager.org  -o-  http://ovirt.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-  F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100127152323</emailId><senderName>"Neil Aggarwal"</senderName><senderEmail>neil@jammconsulting.com</senderEmail><timestampReceived>2010-01-27 15:23:23-0400</timestampReceived><subject>Re: [libvirt-users] How to debug Ubuntu 8.04 LTS guest crash during install?</subject><body>

Daniel:

&gt; &gt; I tried turning on the debug option for virt-install but that
&gt; &gt; did not give me any useful info.
&gt; 
&gt; virt-install debug options only relate to host side 
&gt; debugging. From your
&gt; description it sounds like the crashes is guest side, so you'd likely
&gt; need to set guest kenrel debug options - eg make it log to the serial
&gt; console at boot time so you see guest kernel messages

Thank you for getting back to me.  I have been trying to figure
out how set the guest to log messages to the serial console.

I tried this command:

virt-install -n v1092 -r 512 --vcpus=1 --check-cpu --os-type=linux 
--os-variant=ubuntuhardy -v --accelerate 
-c /tmp/turnkey-lamp-2009.10-hardy-x86.iso 
-f /var/lib/libvirt/images/v1092.img -s 15 -b br0 
--nographics -x "console ttyS0"

When I do that, I get this output:

Starting install...
Creating domain... 

Connected to domain v1092
Escape character is ^]

And then it just sits there doing nothing.

My guess is the host is connected to a serial port, but the
guest does not know to set its console to that port.

Any suggestions?

Thanks,
	Neil

--
Neil Aggarwal, (281)846-8957, http://UnmeteredVPS.net/cpanel
cPanel/WHM preinstalled on a virtual server for only $40/month!
No overage charges, 7 day free trial, PayPal, Google Checkout 

</body></email><email><emailId>20100130063837</emailId><senderName>Robin Green</senderName><senderEmail>greenrd@greenrd.org</senderEmail><timestampReceived>2010-01-30 06:38:37-0400</timestampReceived><subject>Re: [libvirt-users] Storage requirement for KVM</subject><body>

In terms of physical hardware you can use any storage hardware
compatible with Linux (which is almost everything). I think that's
what you were asking. In terms of how the virtual disk appears to the
operating system inside the KVM virtual machine, it may appear as a
different kind of device, but that shouldn't be a problem. Note that
with network storage protocols such as iSCSI you should be able to
bypass the overhead of virtualising the hardware, and just connect to
the storage device(s) directly from the guest over the virtual
network(s), if the guest software supports that. However, I have no
clue about the speed of iSCSI compared to other methods - I'm not
trying to say "use iSCSI", I'm just trying to say "if you are going to
use iSCSI, this is how you can use it".
-- 
Robin

At Wed, 3 Feb 2010 16:05:24 +0530,
anuj rampal wrote:
&gt; 
&gt; [1  &lt;multipart/alternative (7bit)&gt;]
&gt; [1.1  &lt;text/plain; ISO-8859-1 (7bit)&gt;]
&gt; Hi all,
&gt; 
&gt; I have to buy a server machine and Run KVM on it.
&gt; 
&gt; I just wanted to know what type of storage devices are supported by KVM.
&gt; 
&gt; Thanks &amp; Regards
&gt; Anuj
&gt; [1.2  &lt;text/html; ISO-8859-1 (7bit)&gt;]
&gt; 
&gt; [2  &lt;text/plain; us-ascii (7bit)&gt;]
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20100130213146</emailId><senderName>Arik Raffael Funke</senderName><senderEmail>arik@funke.eu</senderEmail><timestampReceived>2010-01-30 21:31:46-0400</timestampReceived><subject>[libvirt-users] Problem creating VM: "tap: not a valid disk type"</subject><body>

Hi,

I am having problems creating VMs in virt-manager.

I have played with different xen hypervisor versions 3.0 &amp; 3.4 (with rpm 
-i --force) but have in principle gone back to the originals. - Though I 
cannot absolutely exclude that something has gone wrong.

In principle I am using rhel 5.4 with the gitco xen 3.4 hypervisor.

Can anybody put me on the right track with the attached error message? 
Note, the storage file I am attempting to use does exist.

Many thanks,
Arik

===
Unable to complete install 'libvirt.libvirtError POST operation failed: 
xend_post: error from xen daemon: (xend.err 'Error creating domain: 
Invalid Configuration: tap: not a valid disk type')
Traceback (most recent call last):
   File "/usr/share/virt-manager/virtManager/create.py", line 1485, in 
do_install
     dom = guest.start_install(False, meter = meter)
   File "/usr/lib/python2.4/site-packages/virtinst/Guest.py", line 628, 
in start_install
     return self._do_install(consolecb, meter, removeOld, wait)
   File "/usr/lib/python2.4/site-packages/virtinst/Guest.py", line 726, 
in _do_install
     self.domain = self.conn.createLinux(install_xml, 0)
   File "/usr/lib64/python2.4/site-packages/libvirt.py", line 1077, in 
createLinux
     if ret is None:raise libvirtError('virDomainCreateLinux() failed', 
conn=self)
libvirtError: POST operation failed: xend_post: error from xen daemon: 
(xend.err 'Error creating domain: Invalid Configuration: tap: not a 
valid disk type')
'

</body></email><email><emailId>20100131065323</emailId><senderName>Philip Nelson</senderName><senderEmail>philip@whatsbeef.net</senderEmail><timestampReceived>2010-01-31 06:53:23-0400</timestampReceived><subject>Re: [libvirt-users] poor network performance to one of two guests</subject><body>

On Sun, Jan 31, 2010 at 03:14:52PM +1100, Philip Nelson wrote:
&gt; G'day, I have a host running two kvm guests. One of them gets very poor network
&gt; performance

I think I've figured this out. I created a 3rd guest to test and with iperf I
was getting nearly 2Gbit/sec. I found the only difference was the interface had
&lt;model type='virtio'/&gt;, so I added that to guest A and then had much better
network performance. I'm guessing that was ommitted because I had used an older
version of libvirt/virtinst when initially creating the guest (whichever version
comes with lenny). I still don't know why one guest was much slower than the
other, but it seems like it's all good now.

Cheers

-- Philip

</body></email><email><emailId>20101001024650</emailId><senderName>Jesus Urroa</senderName><senderEmail>observer1@hotmail.es</senderEmail><timestampReceived>2010-10-01 02:46:50-0400</timestampReceived><subject>[libvirt-users] Can't plug usb device</subject><body>

Hi
I'm trying to hotplug an usb device into kvm but the device is not attached
this is the definition:

cat kingston.xml
&lt;hostdev mode='subsystem' type='usb' managed='yes'&gt;
        &lt;source&gt;
                &lt;vendor id='0x1131' /&gt;
                &lt;product id='0x1001' /&gt;
        &lt;/source&gt;
&lt;/hostdev&gt;

the attach and detach commands

virsh attach-device ShadowFax kingston.xml
El dispositivo fue asociado exitosamente

virsh detach-device ShadowFax kingston.xml
El dispositivo fue desmontado exitosamente

which means the device is succesfully attached but is never seen in the vm

The records in /var/log/messages:

Sep 30 21:34:57 Balrog libvirtd: 21:34:57.288: warning : qemudParsePCIDeviceStrs:1411 \
                : Unexpected exit status '1', qemu probably failed
Sep 30 21:35:07 Balrog libvirtd: 21:35:07.803: warning : qemudParsePCIDeviceStrs:1411 \
                : Unexpected exit status '1', qemu probably failed
Sep 30 21:35:07 Balrog libvirtd: 21:35:07.805: error : \
qemuSecurityDACRestoreSecurityFileLabel:84 : cannot resolve symlink \
                /dev/bus/usb/000/000: No such file or directory
Sep 30 21:35:07 Balrog libvirtd: 21:35:07.806: warning : \
SELinuxRestoreSecurityFileLabel:371 : cannot resolve symlink /dev/bus/usb/000/000: No \
                such file or directory
Sep 30 21:35:07 Balrog libvirtd: 21:35:07.806: warning : \
qemudDomainDetachHostDevice:8930 : Failed to restore host device labelling

from /var/log/libvirt/qemu/vm.log

husb: open device 1.7
husb: config #1 need -1
husb: 3 interfaces claimed for configuration 1
husb: grabbed usb device 1.7

this one keeps repeating even after the device is detached that is today but \
yesterday showed only once or twice at each try and when detaching this came out:

Warning: tried to detach unattached usb device USB Host Device

Im using fedora 13 with:
libvirt-0.8.2-1.fc13.x86_64
libvirt-client-0.8.2-1.fc13.x86_64
qemu-system-x86-0.12.5-1.fc13.x86_64

Can someone help me please

Thanks
 		 	   		  


[Attachment #3 (text/html)]

&lt;html&gt;
&lt;head&gt;
&lt;style&gt;&lt;!--
.hmmessage P
{
margin:0px;
padding:0px
}
body.hmmessage
{
font-size: 10pt;
font-family:Tahoma
}
--&gt;&lt;/style&gt;
&lt;/head&gt;
&lt;body class='hmmessage'&gt;
Hi&lt;br&gt;I'm trying to hotplug an usb device into kvm but the device is not \
attached&lt;br&gt;this is the definition:&lt;br&gt;&lt;br&gt;cat kingston.xml&lt;br&gt;&lt;hostdev \
mode='subsystem' type='usb' \
managed='yes'&gt;&lt;br&gt; \
&lt;source&gt;&lt;br&gt; \
&lt;vendor id='0x1131' \
/&gt;&lt;br&gt; \
&lt;product id='0x1001' /&gt;&lt;br&gt; \
&lt;/source&gt;&lt;br&gt;&lt;/hostdev&gt;&lt;br&gt;&lt;br&gt;the attach and detach \
commands&lt;br&gt;&lt;br&gt;virsh attach-device ShadowFax kingston.xml&lt;br&gt;El dispositivo fue \
asociado exitosamente&lt;br&gt;&lt;br&gt;virsh detach-device ShadowFax kingston.xml&lt;br&gt;El \
dispositivo fue desmontado exitosamente&lt;br&gt;&lt;br&gt;which means the device is succesfully \
attached but is never seen in the vm&lt;br&gt;&lt;br&gt;The records in \
/var/log/messages:&lt;br&gt;&lt;br&gt;Sep 30 21:34:57 Balrog libvirtd: 21:34:57.288: warning : \
qemudParsePCIDeviceStrs:1411 : Unexpected exit status '1', qemu probably \
failed&lt;br&gt;Sep 30 21:35:07 Balrog libvirtd: 21:35:07.803: warning : \
qemudParsePCIDeviceStrs:1411 : Unexpected exit status '1', qemu probably \
failed&lt;br&gt;Sep 30 21:35:07 Balrog libvirtd: 21:35:07.805: error : \
qemuSecurityDACRestoreSecurityFileLabel:84 : cannot resolve symlink \
/dev/bus/usb/000/000: No such file or directory&lt;br&gt;Sep 30 21:35:07 Balrog libvirtd: \
21:35:07.806: warning : SELinuxRestoreSecurityFileLabel:371 : cannot resolve symlink \
/dev/bus/usb/000/000: No such file or directory&lt;br&gt;Sep 30 21:35:07 Balrog libvirtd: \
21:35:07.806: warning : qemudDomainDetachHostDevice:8930 : Failed to restore host \
device labelling&lt;br&gt;&lt;br&gt;from /var/log/libvirt/qemu/vm.log&lt;br&gt;&lt;br&gt;husb: open device \
1.7&lt;br&gt;husb: config #1 need -1&lt;br&gt;husb: 3 interfaces claimed for configuration \
1&lt;br&gt;husb: grabbed usb device 1.7&lt;br&gt;&lt;br&gt;this one keeps repeating even after the \
device is detached that is today but yesterday showed only once or twice at each try \
and when detaching this came out:&lt;br&gt;&lt;br&gt;Warning: tried to detach unattached usb \
device USB Host Device&lt;br&gt;&lt;br&gt;Im using fedora 13 \
with:&lt;br&gt;libvirt-0.8.2-1.fc13.x86_64&lt;br&gt;libvirt-client-0.8.2-1.fc13.x86_64&lt;br&gt;qemu-system-x86-0.12.5-1.fc13.x86_64&lt;br&gt;&lt;br&gt;Can \
someone help me please&lt;br&gt;&lt;br&gt;Thanks&lt;br&gt; 		 	   		  &lt;/body&gt; &lt;/html&gt;



</body></email><email><emailId>20100701011218</emailId><senderName></senderName><senderEmail>steven765@yahoo.com</senderEmail><timestampReceived>2010-07-01 01:12:18-0400</timestampReceived><subject>[libvirt-users] C API example</subject><body>

Trying to build the hellolibvirt example.  I get the project to compile okay but when \
I try to run it I get:

Unable to connect to '/usr/local/var/run/libvirt/libivrt-sock

Given libvirt --status says it's in /var/run/libvirt/libvirt-sock  that makes sense.  \
How do I make the git version run with my local copy?

Or even better does anyone have any example projects that have the proper includes \
documented, seperate from the build tree?  I'd like to just use the API not compile \
and deal with all of libvirt at the moment.

Thanks a ton!



      


</body></email><email><emailId>20100803013003</emailId><senderName>Nirmal Guhan</senderName><senderEmail>vavatutu@gmail.com</senderEmail><timestampReceived>2010-08-03 01:30:03-0400</timestampReceived><subject>[libvirt-users] libvirt and lxc</subject><body>

Is anyone using libvirt for lxc ? I am trying to do so and running
into an issue. The system container starts fine with lxc tools and am
able to connect to it.

Here is the snippet of my xml file (rest is same as in
http://libvirt.org/drvlxc.html)

 &lt;devices&gt;
    &lt;emulator&gt;/usr/libexec/libvirt_lxc&lt;/emulator&gt;
    &lt;filesystem type='mount'&gt;
      &lt;source dir='/lxc/f12'/&gt;
      &lt;target dir='/'/&gt;
    &lt;/filesystem&gt;
    &lt;interface type='bridge'&gt;
      &lt;mac address='52:54:00:82:87:64'/&gt;
      &lt;source bridge='br0'/&gt;
      &lt;target dev='tap0'/&gt;
    &lt;/interface&gt;
    &lt;console type='pty'&gt;
      &lt;target port='0'/&gt;
    &lt;/console&gt;
  &lt;/devices&gt;

Am able to start the container but when I do console :

virsh # console f12lxc
Connected to domain f12lxc
Escape character is ^]
&lt;&lt;hangs here and I press enter, it destroys the domain&gt;&gt;
virsh #

Am running Fedora 12 with 2.6.32.10-90.fc12.i686. I changed target
dev='tap0' to 'veth' and no change in the behavior.

Please help.

Thanks,
Nirmal

</body></email><email><emailId>20101203144357</emailId><senderName>"Stefan G. Weichinger"</senderName><senderEmail>lists@xunil.at</senderEmail><timestampReceived>2010-12-03 14:43:57-0400</timestampReceived><subject>[libvirt-users] added second virtio-disk: disk order detected wrong</subject><body>


Greets, I am unsure if it's a linux- or libvirt-issue:

I added a 2nd virtio-disk to a kvm-based VM.

The xml shows a correct "target":


# first disk vda

&lt;disk type='file' device='disk'&gt;
      &lt;driver name='qemu' type='qcow2'/&gt;
      &lt;source file='/mnt/r0/vm1_vda-clone.img'/&gt;
      &lt;target dev='vda' bus='virtio'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x04'
function='0x0'/&gt;
    &lt;/disk&gt;

# second disk vdb

&lt;disk type='file' device='disk'&gt;
      &lt;driver name='qemu' type='qcow2'/&gt;
      &lt;source file='/mnt/r0/www3_var.img'/&gt;
      &lt;target dev='vdb' bus='virtio'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03'
function='0x0'/&gt;
    &lt;/disk&gt;


The VM contains Gentoo Linux, grub comes up fine, but then it flips the
devices:

The unpartitioned new disk is vda, therefore there is no root-fs etc ...

I know my way to fix this via Live-CD or so, but I would really like to
understand what happened! I'd like to keep vda as root etc.

Could someone explain?

libvirt-0.8.6 and qemu-kvm-0.13.0-r2 on a gentoo-host, btw.

Thanks, Stefan

</body></email><email><emailId>20100228233342</emailId><senderName>carlos_campderrs</senderName><senderEmail>gilipollas.desconcertante@gmail.com</senderEmail><timestampReceived>2010-02-28 23:33:42-0400</timestampReceived><subject>[libvirt-users] location of network xml files</subject><body>

Hello,

On Ubuntu 9.04 (libvirt 0.6.1-0ubuntu5.1) I have 2 different network files:

root@sauron:~# ls -l `locate default.xml`
lrwxrwxrwx 1 root root  14 2010-02-13 12:34
/etc/libvirt/qemu/networks/autostart/default.xml -&gt; ../default.xml
-rw-r--r-- 1 root root 373 2010-03-01 00:02
/etc/libvirt/qemu/networks/default.xml
-rw------- 1 root root 319 2010-03-01 00:04
/var/lib/libvirt/network/default.xml

Modifications I do on the /etc file are ignored (I'd like to modify the dhcp
range and set fixed ips to VM mac addresses). I don't understand why this
file is there, as it seems ignored by everything, and why the autostart
symlink points to it instead of the /var/lib/libvirt one.

Is it reasonable to symlink (or hardlink if possible) one file to the other?
Or to remove the /etc file and point the autostart to the /var file? Also,
does the autostart do something? because it's pointing to the ignored file.

thanks,
carlos.

-- 
Si no puedes deslumbrar con tu sabidura,
desconcierta con tus gilipolleces

[Attachment #3 (text/html)]

Hello,&lt;br&gt;&lt;br&gt;On Ubuntu 9.04 (libvirt 0.6.1-0ubuntu5.1) I have 2 different =
network files:&lt;br&gt;&lt;br&gt;root@sauron:~# ls -l `locate default.xml`&lt;br&gt;lrwxrwxr=
wx 1 root root=A0 14 2010-02-13 12:34 /etc/libvirt/qemu/networks/autostart/=
default.xml -&gt; ../default.xml&lt;br&gt;
-rw-r--r-- 1 root root 373 2010-03-01 00:02 /etc/libvirt/qemu/networks/defa=
ult.xml&lt;br&gt;-rw------- 1 root root 319 2010-03-01 00:04 /var/lib/libvirt/net=
work/default.xml&lt;br&gt;&lt;br&gt;Modifications I do on the /etc file are ignored (I&amp;=
#39;d like to modify the dhcp range and set fixed ips to VM mac addresses).=
 I don't understand why this file is there, as it seems ignored by ever=
ything, and why the autostart symlink points to it instead of the /var/lib/=
libvirt one.&lt;br&gt;
&lt;br&gt;Is it reasonable to symlink (or hardlink if possible) one file to the o=
ther? Or to remove the /etc file and point the autostart to the /var file? =
Also, does the autostart do something? because it's pointing to the ign=
ored file.&lt;br&gt;
&lt;br&gt;thanks,&lt;br&gt;carlos.&lt;br&gt;&lt;br&gt;-- &lt;br&gt;Si no puedes deslumbrar con tu sabidur=
=EDa,&lt;br&gt;desconcierta con tus gilipolleces&lt;br&gt;


</body></email><email><emailId>20100401205555</emailId><senderName>Alexander Pierce</senderName><senderEmail>apierce@redhat.com</senderEmail><timestampReceived>2010-04-01 20:55:55-0400</timestampReceived><subject>[libvirt-users] iSCSI supported initiators</subject><body>

What initiators does libvirt support for the iSCSI pool?  Will it work with qlogic's iSCSI HBAs for instance?

---
Alexander Pierce, RHCE
Solutions Architect -- Red Hat, Inc.
apierce@redhat.com  -- +1 (530) MR-LINUX (675-4689)

Learn. Network. Experience Open Source. 
The 2010 Red Hat Summit and JBoss World
Boston. June 22 - 25, 2010
http://www.theredhatsummit.com
http://www.jbossworld.com

</body></email><email><emailId>20100501130643</emailId><senderName>"Development"</senderName><senderEmail>development@simulamen.eu</senderEmail><timestampReceived>2010-05-01 13:06:43-0400</timestampReceived><subject>[libvirt-users] Windows Vista Client Fails to Connect to Ubuntu libvirtd</subject><body>

Requesting urgent assistance if I may?

 

Attempting to connect to an Ubuntu machine using an MinMG compiled virsh on
a Windows Vista machine.  Using insecure TCP simply to prove a concept to a
client.  However, cannot connect; situation as follows:

 

Edited /etc/libvirt/libvirt.conf as follows:

listen_tcp = 1

auth_tcp = "none"

 

Edited /etc/default//libvirt-bin as follows:

libvirt-opts="-d -l"

 

Running virsh on Vista client fails as follows:

$ virsh -c qemu+tcp://192.168.1.101/system

error: unable to connect to libvirtd at '192.168.1.101': errno=10061

error: failed to connect to the hypervisor

 

Running virsh on Ubuntu server fails as follows:

$ virsh -c qemu+tcp:///system

Connecting to uri: qemu+tcp:///system

error: unable to connect to libvirtd at 'localhost': Connection refused

error: failed to connect to the hypervisor

 

Indeed, with libvirt-opts="-d -l" in etc/default//libvirt-bin the 'default'
command also fails:

$ virsh -c qemu:///system

Connecting to uri: qemu:///system

error: unable to connect to 'var/run/libvirt/libvirt-sock': Connection
refused

error: failed to connect to the hypervisor

 

Suggestions very welcome...

 

Tim McLeod

 


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 12 (filtered medium)"&gt;
&lt;style&gt;
&lt;!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page Section1
	{size:612.0pt 792.0pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;}
div.Section1
	{page:Section1;}
--&gt;
&lt;/style&gt;
&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapelayout v:ext="edit"&gt;
  &lt;o:idmap v:ext="edit" data="1" /&gt;
 &lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
&lt;/head&gt;

&lt;body lang=EN-GB link=blue vlink=purple&gt;

&lt;div class=Section1&gt;

&lt;p class=MsoNormal&gt;Requesting urgent assistance if I may?&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Attempting to connect to an Ubuntu machine using an MinMG
compiled virsh on a Windows Vista machine. Using insecure TCP simply to
prove a concept to a client. However, cannot connect; situation as
follows:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Edited /etc/libvirt/libvirt.conf as follows:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;listen_tcp = 1&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;auth_tcp = "none"&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Edited /etc/default//libvirt-bin as follows:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;libvirt-opts="-d -l"&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Running virsh on Vista client fails as follows:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;$ virsh -c qemu+tcp://192.168.1.101/system&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;error: unable to connect to libvirtd at '192.168.1.101':
errno=10061&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;error: failed to connect to the hypervisor&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Running virsh on Ubuntu server fails as follows:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;$ virsh -c qemu+tcp:///system&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Connecting to uri: qemu+tcp:///system&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;error: unable to connect to libvirtd at 'localhost':
Connection refused&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;error: failed to connect to the hypervisor&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Indeed, with libvirt-opts="-d -l" in
etc/default//libvirt-bin the 'default' command also fails:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;$ virsh -c qemu:///system&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Connecting to uri: qemu:///system&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;error: unable to connect to 'var/run/libvirt/libvirt-sock':
Connection refused&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;error: failed to connect to the hypervisor&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Suggestions very welcome...&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Tim McLeod&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;



</body></email><email><emailId>20100501185613</emailId><senderName>Ralf Hornik Mailings</senderName><senderEmail>ralf@best.homeunix.org</senderEmail><timestampReceived>2010-05-01 18:56:13-0400</timestampReceived><subject>[libvirt-users] Issues after migrating from Xen to KVM</subject><body>

Dear list,

I have moved my HVMs from xen to kvm and it worked well except some 
problems using virsh.

First, one OpenSolaris HVM does boot with warnings:

WARNING: /pci@0,0/pci1af4,1100@1,2 (uhci1): No SOF interrupts have been 
received, this USB UHCI host controller is unusable*

*The corresponding process:

/usr/bin/qemu-system-x86_64 -S -M pc-0.12 -enable-kvm -m 1024 -smp 
1,sockets=1,cores=1,threads=1 \
                                              -name server01 -uuid 
e382c360-23bd-b400-0b89-9a1e69613ec4 -nographic \
                                              -nodefaults -chardev 
socket,id=monitor,path=/usr/local/libvirt/var/lib/libvirt/qemu/server01.monitor,server,nowait 
\
                                              -mon 
chardev=monitor,mode=readline -rtc base=utc -boot c -drive 
file=/dev/xen_vol/xen_opensol,if=none,id=drive-ide0-0-0,boot=on \
                                              -device 
ide-drive,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0 -drive 
file=/dev/hde,if=none,id=drive-ide0-0-1 \
                                              -device 
ide-drive,bus=ide.0,unit=1,drive=drive-ide0-0-1,id=ide0-0-1 -device 
rtl8139,vlan=0,id=net0,mac=00:16:3e:28:85:7a,bus=pci.0,addr=0x4 \
                                              -net 
tap,ifname=tap0,vlan=0,name=hostnet0 -chardev pty,id=serial0 -device 
isa-serial,chardev=serial0 -usb -device 
virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x3

This does not happen when I boot with plain qemu-bin:

/usr/local/kvm/bin/qemu-system-x86_64 -hda /dev/xen_vol/xen_opensol \
                                                              -hdb 
/dev/hde -net nic,macaddr=00:16:3e:28:85:7a \
                                                              -net 
tap,ifname=tap0 -nographic \
                                                              -m 1024 
-daemonize

Second is one Centos 5.2 HVM that does not boot at all.
However when I boot manually and omitt "-S" and "-nodefaults" then it 
comes up.

I looked for the -S option and I wonder why it is being used by default.
Can anybody help me? I cannot see any further documentation about the 
"-nodefault" option and how to disable "-S"
Best regards

Ralf

</body></email><email><emailId>20100503145705</emailId><senderName>David Ehle</senderName><senderEmail>ehle@agni.phys.iit.edu</senderEmail><timestampReceived>2010-05-03 14:57:05-0400</timestampReceived><subject>[libvirt-users] using shared storage with libvirt/KVM?</subject><body>


I apologize if this is a duplicate.  I submitted it before I was a list 
member and it looks like it went into limbo.

Dear Moderator, please discard the original if it is sitll in a moderation 
queue.

Hello,

I've spent a few days googling and reading documentation, but I'm looking for 
clarification and advise on setting up KVM/libvirt with shared storage.

I have 2 (for now) Ubuntu Karmic systems with KVM/virsh/virt-manager set up and 
running.

I have a storage server that can do NFS/iSCSI/samba/ etc.

I am trying to figure out the best way to set things up so that I can run 
several (eventually) production linux guests (mostly debian stable) on the 2 
KVM host systems and be able to migrate them when maintenance is required on 
their hosts.

Performance is of medium importance, stability/availibilty is pretty high 
priority.

A common opinion seems to be that using LVs to hold disk images gives possibly 
the best IO performance, followed by raw, then qcow2.

Would you agree or disagree with this? What evidence can you provide?


I am also rather confused about using shared storage, and what options can be 
combined with this.

I have succesfully made an iscsi device available to libvirt/virsh/virt-manager 
via an XML file + pool-define + pool-start. However the documentation states 
that while you can create pools through libvirt, volumes have to be 
pre-allocated:
http://libvirt.org/storage.html
"Volumes must be pre-allocated on the iSCSI server, and cannot be created via 
the libvirt APIs."

I'm very unclear on what this means in general, and specifically how you 
preallocate the the Volumes.

When I make a iscsi pool available via something like this:
       &lt;pool type="iscsi"&gt;
         &lt;name&gt;virtimages&lt;/name&gt;
         &lt;source&gt;
           &lt;host name="iscsi.example.com"/&gt;
           &lt;device path="demo-target"/&gt;
         &lt;/source&gt;
         &lt;target&gt;
           &lt;path&gt;/dev/disk/by-path&lt;/path&gt;
         &lt;/target&gt;
       &lt;/pool&gt;

In virt-manger I can see it as a pool, but when I try to select it for where to 
create an image, it uses the pool AS A Volume (I think).

That brings me to my next question/misunderstanding...

If you are using shared storage (via NFS or iSCSI) does that also mean you MUST 
use a file based image rather than an LVM LV?  NFS makes directories available, 
not devices.  You can make an unformated "raw" LV available via iSCSI, but its 
not seen on the far side as a LV but instead as a scsi disk which you need to 
partition. You can make a PV&gt;VG&gt;LV out of that and then make your new LV 
available to libvirt/KVM but then your stacking a heck of a lot of 
LVM/LVs/partion tables up which seems pretty dubious.  I'm also not sure that 
the stack would be visable/available to the second system using that iSCSI 
device.  (I'm pretty new to using iSCSI as well.)

Redhat provides pretty good documentation on doing shared storage/live 
migration for NFS:
http://www.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/5.4/html/Virtualization_Guide/chap-Virtualization-KVM_live_migration.html
 But unfortunately the section on Shared Storage with iSCSI is a bit lacking:
"9.1. Using iSCSI for storing guests
This section covers using iSCSI-based devices to store virtualized guests." and 
thats it.

For maybe 6-10 guests, should I simply just be using NFS? Is its performance 
that much worse than iSCSI for this task?

So since KVM/libvirt is getting used quite often in production now - but some 
simple things are not making any sense to me - I'm guessing that I have some 
really basic misunderstandings of how to do shared storage / Pools/ Volumes for 
migration.

Would one of the kind readers of this least be willing to correct me?

Please CC to my original email address as well as I am not yet a regular 
subscriber.

Thanks again!

David.


</body></email><email><emailId>20100503201818</emailId><senderName>Tom Georgoulias</senderName><senderEmail>tomg@mcclatchyinteractive.com</senderEmail><timestampReceived>2010-05-03 20:18:18-0400</timestampReceived><subject>Re: [libvirt-users] using shared storage with libvirt/KVM?</subject><body>

On 05/03/2010 10:57 AM, David Ehle wrote:

&gt; I've spent a few days googling and reading documentation, but I'm looking for
&gt; clarification and advise on setting up KVM/libvirt with shared storage.

I, too, have been looking at these kinds of setups in the last few 
weeks, and I've found myself confused about the stack more than once. 
The documentation is very scattered and incomplete in key areas (as you 
pointed out with the RHEL docs on shared storage), which makes it tough 
on a new user.  Here's what I can share, I hope this encourages others 
to join in and help us both out.

&gt; I am trying to figure out the best way to set things up so that I can run
&gt; several (eventually) production linux guests (mostly debian stable) on the 2
&gt; KVM host systems and be able to migrate them when maintenance is required on
&gt; their hosts.

 From the small testing I've done, making an iscsi based storage pool 
and using it to store the VMs between the two KVM hosts.

&gt; A common opinion seems to be that using LVs to hold disk images gives possibly
&gt; the best IO performance, followed by raw, then qcow2.
&gt; 
&gt; Would you agree or disagree with this? What evidence can you provide?

That's probably right, but I think those are more relevant when you are 
using non-shared storage, like images on your local disk or perhaps on a 
shared mount.

&gt; I have succesfully made an iscsi device available to libvirt/virsh/virt-manager
&gt; via an XML file + pool-define + pool-start. However the documentation states
&gt; that while you can create pools through libvirt, volumes have to be
&gt; pre-allocated:
&gt; http://libvirt.org/storage.html
&gt; "Volumes must be pre-allocated on the iSCSI server, and cannot be created via
&gt; the libvirt APIs."
&gt; 
&gt; I'm very unclear on what this means in general, and specifically how you
&gt; preallocate the the Volumes.

I believe this means you will need to create the LUNs on the storage and 
present them to libvirt, but libvirt cannot talk back to the storage 
system and create the targets/LUNs for you as you try to spin up new VMs.

&gt; If you are using shared storage (via NFS or iSCSI) does that also mean you MUST
&gt; use a file based image rather than an LVM LV?

No, you can use iscsi and treat the storage as a raw disk.

&gt; Redhat provides pretty good documentation on doing shared storage/live
&gt; migration for NFS:
&gt; http://www.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/5.4/html/Virtualization_Guide/chap-Virtualization-KVM_live_migration.html
&gt;  But unfortunately the section on Shared Storage with iSCSI is a bit lacking:
&gt; "9.1. Using iSCSI for storing guests
&gt; This section covers using iSCSI-based devices to store virtualized guests." and
&gt; thats it.

I know!  How frustrating!  Even the RHEL6 beta document is missing those 
sections...

Here's what I've documented for my initial test run.  I hope this helps 
you get started, please note that I changed the IPs and iqn's to prevent 
sharing private data on the list.

1. Create a LUN on your shared storage system &amp; get the iqn.

iqn.long.long.long:a6c98a7e-0275-c020-efae-a386dfd46b84

2. From the KVM host, scan for the newly created target

# iscsiadm -m discovery -t sendtargets -p &lt;shared storage FQDN&gt;

1.2.3.4:3260,2 iqn.long.long.long:a6c98a7e-0275-c020-efae-a386dfd46b84

There it is, *84.

3. Write the XML config describing the storage we will add to the 
storage pool, using the iqn from step 2.

&lt;pool type="iscsi"&gt;
   &lt;name&gt;lun1&lt;/name&gt;
   &lt;source&gt;
     &lt;host name="storage hostname"/&gt;
     &lt;device 
path="iqn.long.long.long:a6c98a7e-0275-c020-efae-a386dfd46b84"/&gt;
   &lt;/source&gt;
   &lt;target&gt;
     &lt;path&gt;/dev/disk/by-path&lt;/path&gt;
   &lt;/target&gt;
&lt;/pool&gt;

4. Import that XML to define the pool:

# virsh pool-define /tmp/lun1.xml
Pool lun1 defined from lun1.xml

5. Verify:
# virsh pool-info lun1
Name:           lun1
UUID:           701a1401-547a-08da-5f14-befea84778d9
State:          inactive

6. Start the pool so we can use it

# virsh pool-start lun1
Pool lun1 started

7. List the volume names in the new pool so we'll know what to pass 
along to virt-install to use it:

# virsh vol-list lun1
Name                 Path
-----------------------------------------
10.0.0.0 
/dev/disk/by-path/ip-1.2.3.4:3260-iscsi-iqn.long.long.long:a6c98a7e-0275-c020-efae-a386dfd46b84-lun-0


virsh # vol-info --pool lun1 10.0.0.0
Name:           10.0.0.0
Type:           block
Capacity:       20.00 GB
Allocation:     20.00 GB


8. Install the VM with virt-install and use "--disk 
vol=lun1/10.0.0.0,size=20" to access the storage

[root@rvrt010d ~]# virt-install &lt;all of your options&gt;
--disk vol=lun1/10.0.0.0,size=20

After that's up and running, your VM will use the shared storage as if 
it is a local disk.

9.  If you repeat steps 2-6 on your other KVM host, the storage will be 
shared between both hosts.  Now you are setup for migration, either 
offline or live.

# virsh migrate VM qemu+ssh://other.kvm.host/system

&gt; For maybe 6-10 guests, should I simply just be using NFS? Is its performance
&gt; that much worse than iSCSI for this task?

This totally depends on your network and hardware, but here's how a dd 
test over NFS and iSCSI compared in my setup:

iSCSI
run     throughput
01       24.5 MB/s
02       25.7 MB/s
03       52.4 MB/s
04       56.5 MB/s
05       57.7 MB/s
06       56.2 MB/s
07       51.5 MB/s
08       57.8 MB/s
09       57.3 MB/s
10       55.8 MB/s

NFS
run     throughput
01       34.5 MB/s
02       35.2 MB/s
03       36.2 MB/s
04       41.2 MB/s
05       39.2 MB/s
06       39.2 MB/s
07       36.2 MB/s
08       34.8 MB/s
09       36.7 MB/s
10       40.4 MB/s

I hope this helps, and I hope that someone corrects any errors I may 
have made.  :)

Tom


</body></email><email><emailId>20100601124909</emailId><senderName>James Hogarth</senderName><senderEmail>james.hogarth@gmail.com</senderEmail><timestampReceived>2010-06-01 12:49:09-0400</timestampReceived><subject>[libvirt-users] Java Bindings against RHEL5.5 KVM</subject><body>

Hi all,

I'm doing some dev work against the native RHEL/centos 5.5 KVM
installation for maintenance, creation and deletion of virtual guests
using the libvirt API vai the java bindings from a java based web app.

Things in general seem to be working - I can connect to and query the
kvm instance using the libvirt interface and get a list of guests,
pull information about them and stop/start/restart guests.

I'm hitting a bit of an issue with creation of a guest however....

When calling domainDefineXML with XML following the domain XML
specification (with the XML as per a dumpxml on the relevant box) I
get an error creating the guest of:

"internal error unknown lifecycle action restart "

The virsh version information for the host is:

Compiled against library: libvir 0.6.3
Using library: libvir 0.6.3
Using API: QEMU 0.6.3
Running hypervisor: QEMU 0.10.5


I have tried this against my ubuntu system as well with the same error
- that has version:

Compiled against library: libvir 0.7.5
Using library: libvir 0.7.5
Using API: QEMU 0.7.5
Running hypervisor: QEMU 0.12.3

I'm currently using jna 3.2.5 with libvirt 0.4.5 bindings.

The example XML being used is:

&lt;domain type="kvm"&gt;
  &lt;name&gt;
    newguestfomwebapp
  &lt;/name&gt;
  &lt;memory&gt;
    512
  &lt;/memory&gt;
  &lt;vcpu&gt;
    1
  &lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch="x86_64" machine="rhel5.4.0"&gt;
      hvm
    &lt;/type&gt;
    &lt;boot dev="hd"/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
    &lt;apic/&gt;
    &lt;pae/&gt;
  &lt;/features&gt;
  &lt;clock offset="utc"/&gt;
  &lt;on_poweroff&gt;
    destroy
  &lt;/on_poweroff&gt;
  &lt;on_reboot&gt;
    restart
  &lt;/on_reboot&gt;
  &lt;on_crash&gt;
    restart
  &lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;
      /usr/libexec/qemu-kvm
    &lt;/emulator&gt;
    &lt;disk type="file" device="cdrom"&gt;
      &lt;driver name="qemu" type="raw"/&gt;
      &lt;source file="/var/lib/libvirt/images/ISOs/centos5.5-ks.iso"/&gt;
      &lt;target dev="hdc" bus="ide"/&gt;
      &lt;readonly/&gt;
    &lt;/disk&gt;
    &lt;interface type="network"&gt;
      &lt;source network="default"/&gt;
      &lt;model type="virtio"/&gt;
    &lt;/interface&gt;
    &lt;input type="mouse" bus="ps2"/&gt;
    &lt;graphics type="vnc" port="-1" autoport="yes"/&gt;
  &lt;/devices&gt;
&lt;/domain&gt;

If I remove the lifecycle information from the xml I get:

"unknown OS type hvm "

The xml works from the command line with virsh define ...

Anyone seen anything similar or have any ideas?

Regards,

James

</body></email><email><emailId>20100503130021</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2010-05-03 13:00:21-0400</timestampReceived><subject>Re: [libvirt-users] Issues after migrating from Xen to KVM</subject><body>

On 05/01/2010 02:56 PM, Ralf Hornik Mailings wrote:
&gt; Dear list,
&gt; 
&gt; I have moved my HVMs from xen to kvm and it worked well except some
&gt; problems using virsh.
&gt; 
&gt; First, one OpenSolaris HVM does boot with warnings:
&gt; 
&gt; WARNING: /pci@0,0/pci1af4,1100@1,2 (uhci1): No SOF interrupts have been
&gt; received, this USB UHCI host controller is unusable*
&gt; 
&gt; *The corresponding process:
&gt; 
&gt; /usr/bin/qemu-system-x86_64 -S -M pc-0.12 -enable-kvm -m 1024 -smp
&gt; 1,sockets=1,cores=1,threads=1 \
&gt;                                              -name server01 -uuid
&gt; e382c360-23bd-b400-0b89-9a1e69613ec4 -nographic \
&gt;                                              -nodefaults -chardev
&gt; socket,id=monitor,path=/usr/local/libvirt/var/lib/libvirt/qemu/server01.monitor,server,nowait
&gt; \
&gt;                                              -mon
&gt; chardev=monitor,mode=readline -rtc base=utc -boot c -drive
&gt; file=/dev/xen_vol/xen_opensol,if=none,id=drive-ide0-0-0,boot=on \
&gt;                                              -device
&gt; ide-drive,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0 -drive
&gt; file=/dev/hde,if=none,id=drive-ide0-0-1 \
&gt;                                              -device
&gt; ide-drive,bus=ide.0,unit=1,drive=drive-ide0-0-1,id=ide0-0-1 -device
&gt; rtl8139,vlan=0,id=net0,mac=00:16:3e:28:85:7a,bus=pci.0,addr=0x4 \
&gt;                                              -net
&gt; tap,ifname=tap0,vlan=0,name=hostnet0 -chardev pty,id=serial0 -device
&gt; isa-serial,chardev=serial0 -usb -device
&gt; virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x3
&gt; 
&gt; This does not happen when I boot with plain qemu-bin:
&gt; 
&gt; /usr/local/kvm/bin/qemu-system-x86_64 -hda /dev/xen_vol/xen_opensol \
&gt;                                                              -hdb
&gt; /dev/hde -net nic,macaddr=00:16:3e:28:85:7a \
&gt;                                                              -net
&gt; tap,ifname=tap0 -nographic \
&gt;                                                              -m 1024
&gt; -daemonize
&gt; 
&gt; Second is one Centos 5.2 HVM that does not boot at all.
&gt; However when I boot manually and omitt "-S" and "-nodefaults" then it
&gt; comes up.
&gt; 
&gt; I looked for the -S option and I wonder why it is being used by default.
&gt; Can anybody help me? I cannot see any further documentation about the
&gt; "-nodefault" option and how to disable "-S"

The -S means "start suspended".  That's so that libvirt can fork off the
qemu process, do a bit of work, and then run the virtual machine.  In
general you can't remove it from the command-line libvirt generates, since
libvirt depends on it.

Also, with recent qemu, you don't really want to remove the -nodefaults either,
since it's another new feature that libvirt is coming to rely on.  The reasons
for using it are many, but basically it says not to create any devices by
default, but let the user specify all of them on the command-line.

What's the actual problem you are having with the CentOS guest?  What kind of
error messages do you see?

-- 
Chris Lalancette

</body></email><email><emailId>20100902052019</emailId><senderName>Ravi Pawar</senderName><senderEmail>ravifc@gmail.com</senderEmail><timestampReceived>2010-09-02 05:20:19-0400</timestampReceived><subject>[libvirt-users] is libvirt java binding thread safe?</subject><body>

[Attachment #2 (multipart/alternative)]


please check the java file attached they throws the exception in case of
passing.
please let me know if i am missing something.



-- 
Thanks &amp; Regards

Ravi Pawar

[Attachment #5 (text/html)]

please check the java file attached they throws the exception in case of \
passing.&lt;br&gt;please let me know if i am missing something.&lt;br&gt;&lt;br&gt; &lt;br \
clear="all"&gt;&lt;br&gt;-- &lt;br&gt;Thanks &amp; Regards&lt;br&gt;&lt;br&gt;Ravi Pawar&lt;br&gt;

--0016364ed9a07bb2a1048f3fcd19--


["TestMultiThreadingLibvirtWithError.java" (application/octet-stream)]
["Test.java" (application/octet-stream)]
["TestMultiThreadingLibvirt.java" (application/octet-stream)]

</body></email><email><emailId>20101001153957</emailId><senderName>"Roberto Attias (rattias)"</senderName><senderEmail>rattias@cisco.com</senderEmail><timestampReceived>2010-10-01 15:39:57-0400</timestampReceived><subject>[libvirt-users] undefining and redefining a Domain</subject><body>

&lt;resending as I don't think I was in the mailing list yet when I sent
first time... apologies if you receive this twice&gt;

 

Hello,

I'm facing some strange behavior, and I hope you can provide a
clarification. 

Consider the following code:

 

     virDomainPtr dom = virDomainLookupByName(virt, domain_name);

     if (dom) {

           printf("domain already defined...\n");

           if (virDomainUndefine(dom))

                printf("...unable to undefine!!!\n");

           else {

                printf("...undefined.");

                free(dom);

           }

     }

     dom = virDomainDefineXML(virt, SOME_XML);

     if (dom != NULL) {

           const char *name = virDomainGetName(dom);

           printf("NAME IS NOW: %s\n", name);

     } else

           printf("dom is NULL!\n");

 

When executed the first time, the code correctly defines the domain, and
prints:

 

defining domain test2-vm

libvir: QEMU error : Domain not found: no domain with matching name
'test2-vm'

NAME IS NOW: test2-vm

 

If executed a second time with  the same SOME_XML when the domain is
already defined, it prints:

 

defining domain test2-vm

domain already defined...

libvir: Domain error : invalid domain pointer in virDomainGetName

undefining......undefined.NAME IS NOW: (null)

 

Not only the name is null, but the domain can't be started. What is the
correct way to undefined programmatically a domain that is already
defined? Why is the second virDomainDefineXML() returining a pointer (as
opposed to null), but the pointed object seem to be invalid?

 

Thanks, 

                 Roberto

 


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;meta http-equiv=Content-Type content="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 12 (filtered medium)"&gt;
&lt;style&gt;
&lt;!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
--&gt;
&lt;/style&gt;
&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapelayout v:ext="edit"&gt;
  &lt;o:idmap v:ext="edit" data="1" /&gt;
 &lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
&lt;/head&gt;

&lt;body lang=EN-US link=blue vlink=purple&gt;

&lt;div class=WordSection1&gt;

&lt;p class=MsoNormal&gt;&lt;resending as I dont think I was in the mailing
list yet when I sent first time apologies if you receive this \
twice&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Hello,&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Im facing some strange behavior, and I hope you can
provide a clarification. &lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Consider the following code:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier New"'&gt;
virDomainPtr dom = virDomainLookupByName(virt, domain_name);&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier New"'&gt;
if (dom) {&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier \
New"'&gt; \
printf("domain already defined...\n");&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier \
New"'&gt; if \
(virDomainUndefine(dom))&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier \
New"'&gt;
 printf("...unable to undefine!!!\n");&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier \
New"'&gt; else \
{&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier \
New"'&gt;
 printf("...undefined.");&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier \
New"'&gt;
 free(dom);&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier \
New"'&gt; \
}&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier New"'&gt;
}&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier New"'&gt;
dom = virDomainDefineXML(virt, SOME_XML);&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier New"'&gt;
if (dom != NULL) {&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier \
New"'&gt; const char *name = \
virDomainGetName(dom);&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier \
New"'&gt; printf("NAME \
IS NOW: %s\n", name);&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier New"'&gt;
} else&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier \
New"'&gt; printf("dom \
is NULL!\n");&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;When executed the first time, the code correctly defines the
domain, and prints:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal style='margin-left:.5in'&gt;&lt;span style='font-family:"Courier \
New"'&gt;defining domain test2-vm&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal style='margin-left:.5in'&gt;&lt;span style='font-family:"Courier \
New"'&gt;libvir: QEMU error : Domain not found: no domain with matching name \
'test2-vm'&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal style='margin-left:.5in'&gt;&lt;span style='font-family:"Courier \
New"'&gt;NAME IS NOW: test2-vm&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;If executed a second time with the same SOME_XML when
the domain is already defined, it prints:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal style='margin-left:.5in'&gt;&lt;span style='font-family:"Courier \
New"'&gt;defining domain test2-vm&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal style='margin-left:.5in'&gt;&lt;span style='font-family:"Courier \
New"'&gt;domain already defined...&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal style='margin-left:.5in'&gt;&lt;span style='font-family:"Courier \
New"'&gt;libvir: Domain error : invalid domain pointer in \
virDomainGetName&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal style='margin-left:.5in'&gt;&lt;span style='font-family:"Courier \
New"'&gt;undefining......undefined.NAME IS NOW: (null)&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Not only the name is null, but the domain cant be
started. What is the correct way to undefined programmatically a domain that is
already defined? Why is the second virDomainDefineXML() returining a pointer
(as opposed to null), but the pointed object seem to be invalid?&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Thanks, &lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;
 Roberto&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;



</body></email><email><emailId>20101001161109</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-10-01 16:11:09-0400</timestampReceived><subject>Re: [libvirt-users] undefining and redefining a Domain</subject><body>

2010/10/1 Roberto Attias (rattias) &lt;rattias@cisco.com&gt;:
&gt; &lt;resending as I dont think I was in the mailing list yet when I sent first
&gt; time apologies if you receive this twice&gt;
&gt;
&gt;
&gt;
&gt; Hello,
&gt;
&gt; Im facing some strange behavior, and I hope you can provide a
&gt; clarification.
&gt;
&gt; Consider the following code:
&gt;
&gt;
&gt;
&gt;      virDomainPtr dom = virDomainLookupByName(virt, domain_name);
&gt;
&gt;      if (dom) {
&gt;
&gt;            printf("domain already defined...\n");
&gt;
&gt;            if (virDomainUndefine(dom))
&gt;
&gt;                 printf("...unable to undefine!!!\n");
&gt;
&gt;            else {
&gt;
&gt;                 printf("...undefined.");
&gt;
&gt;                 free(dom);
&gt;
&gt;            }
&gt;
&gt;      }

You're leaking a virDomainPtr here. Call virDomainFree(dom) before
overwriting the pointer with the result from virDomainDefineXML.

I think the leaked virDomainPtr causes the trouble you describe. So
fixing the leak will probably also fix the problem you see in the
second run.

&gt;      dom = virDomainDefineXML(virt, SOME_XML);
&gt;

Matthias

</body></email><email><emailId>20100902215907</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-09-02 21:59:07-0400</timestampReceived><subject>Re: [libvirt-users] is libvirt java binding thread safe?</subject><body>

2010/9/2 Ravi Pawar &lt;ravifc@gmail.com&gt;:
&gt; please check the java file attached they throws the exception in case of
&gt; passing.
&gt; please let me know if i am missing something.
&gt;

Can you explain in more detail what one should do to reproduce the
problem you seem to see with the attached code? Also you didn't
mention which versions of libvirt and libvirt-java you're using.

When I run you example code (with a guest name that exists in my setup
and libvirt and libvirt-java form current git head) I don't see any
exceptions. Even when I add e.printStackTrace() to the catch block of
TestMultiThreadingLibvirtWithError I don't see exceptions.

$ java -classpath ./target/libvirt-0.4.6.jar:./ravi:/usr/share/java/jna.jar Test
start class 0
start class 1
start class 2
start class 3
start class 4
start class 5
start class 6
start class 7
start class 8
start class 9

So this works for me.

Matthias

</body></email><email><emailId>20100903042850</emailId><senderName>Ravi Pawar</senderName><senderEmail>ravifc@gmail.com</senderEmail><timestampReceived>2010-09-03 04:28:50-0400</timestampReceived><subject>Re: [libvirt-users] is libvirt java binding thread safe?</subject><body>

thank you for the reply and time you spend.
your guest domain should not be running and then run my program without any
change.you will see an exception where you dont expect it to occur.
libvirt : 0.6.3 and libvirt-java: 0.4.2 i am using. Please let me know if i
miss to provide you any other details.


On Fri, Sep 3, 2010 at 3:29 AM, Matthias Bolte &lt;
matthias.bolte@googlemail.com&gt; wrote:

&gt; 2010/9/2 Ravi Pawar &lt;ravifc@gmail.com&gt;:
&gt; &gt; please check the java file attached they throws the exception in case of
&gt; &gt; passing.
&gt; &gt; please let me know if i am missing something.
&gt; &gt;
&gt;
&gt; Can you explain in more detail what one should do to reproduce the
&gt; problem you seem to see with the attached code? Also you didn't
&gt; mention which versions of libvirt and libvirt-java you're using.
&gt;
&gt; When I run you example code (with a guest name that exists in my setup
&gt; and libvirt and libvirt-java form current git head) I don't see any
&gt; exceptions. Even when I add e.printStackTrace() to the catch block of
&gt; TestMultiThreadingLibvirtWithError I don't see exceptions.
&gt;
&gt; $ java -classpath ./target/libvirt-0.4.6.jar:./ravi:/usr/share/java/jna.jar
&gt; Test
&gt; start class 0
&gt; start class 1
&gt; start class 2
&gt; start class 3
&gt; start class 4
&gt; start class 5
&gt; start class 6
&gt; start class 7
&gt; start class 8
&gt; start class 9
&gt;
&gt; So this works for me.
&gt;
&gt; Matthias
&gt;



-- 
Thanks &amp; Regards

Ravi Pawar

[Attachment #3 (text/html)]

thank you for the reply and time you spend.&lt;br&gt;your guest domain should not be \
running and then run my program without any change.you will see an exception where \
you dont expect it to occur.&lt;br&gt;libvirt : 0.6.3 and libvirt-java: 0.4.2 i am using. \
Please let me know if i miss to provide you any other details.&lt;br&gt; &lt;br&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;On Fri, Sep 3, 2010 at 3:29 AM, Matthias Bolte &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; \
border-left: 1px solid rgb(204, 204, 204); padding-left: 1ex;"&gt; 2010/9/2 Ravi Pawar \
&lt;&lt;a href="mailto:ravifc@gmail.com"&gt;ravifc@gmail.com&lt;/a&gt;&gt;:&lt;br&gt; &lt;div \
class="im"&gt;&gt; please check the java file attached they throws the exception in case \
of&lt;br&gt; &gt; passing.&lt;br&gt;
&gt; please let me know if i am missing something.&lt;br&gt;
&gt;&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;Can you explain in more detail what one should do to reproduce the&lt;br&gt;
problem you seem to see with the attached code? Also you didn't&lt;br&gt;
mention which versions of libvirt and libvirt-java you're using.&lt;br&gt;
&lt;br&gt;
When I run you example code (with a guest name that exists in my setup&lt;br&gt;
and libvirt and libvirt-java form current git head) I don't see any&lt;br&gt;
exceptions. Even when I add e.printStackTrace() to the catch block of&lt;br&gt;
TestMultiThreadingLibvirtWithError I don't see exceptions.&lt;br&gt;
&lt;br&gt;
$ java -classpath ./target/libvirt-0.4.6.jar:./ravi:/usr/share/java/jna.jar Test&lt;br&gt;
start class 0&lt;br&gt;
start class 1&lt;br&gt;
start class 2&lt;br&gt;
start class 3&lt;br&gt;
start class 4&lt;br&gt;
start class 5&lt;br&gt;
start class 6&lt;br&gt;
start class 7&lt;br&gt;
start class 8&lt;br&gt;
start class 9&lt;br&gt;
&lt;br&gt;
So this works for me.&lt;br&gt;
&lt;font color="#888888"&gt;&lt;br&gt;
Matthias&lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;Thanks &amp; \
Regards&lt;br&gt;&lt;br&gt;Ravi Pawar&lt;br&gt;



</body></email><email><emailId>20100903090755</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-09-03 09:07:55-0400</timestampReceived><subject>Re: [libvirt-users] is libvirt java binding thread safe?</subject><body>

Well, if the domain is not running then I get this exception with
libvirt 0.6.3 and libvirt-java 0.4.2:

org.libvirt.LibvirtException: invalid argument in cannot pin vcpus on
an inactive domain
	at org.libvirt.ErrorHandler.processError(Unknown Source)
	at org.libvirt.Connect.processError(Unknown Source)
	at org.libvirt.Domain.processError(Unknown Source)
	at org.libvirt.Domain.getVcpusInfo(Unknown Source)
	at TestMultiThreadingLibvirtWithError.run(TestMultiThreadingLibvirtWithError.java:20)
	at java.lang.Thread.run(Thread.java:636)

The error message is misleading and current git version gives this
exception when the domain is not running:

org.libvirt.LibvirtException: Requested operation is not valid: cannot
list vcpu pinning for an inactive domain
	at org.libvirt.ErrorHandler.processError(Unknown Source)
	at org.libvirt.Connect.processError(Unknown Source)
	at org.libvirt.Domain.processError(Unknown Source)
	at org.libvirt.Domain.getVcpusInfo(Unknown Source)
	at TestMultiThreadingLibvirtWithError.run(TestMultiThreadingLibvirtWithError.java:20)
	at java.lang.Thread.run(Thread.java:636)

And that's perfectly valid, as the complete vCPU information is only
available when the domain is running, therefore the exception is
expected when you call getVcpusInfo on a non-running domain. Also this
has nothing to do with thread-safety.

If this isn't the exception you're referring to, then please show a
stacktrace of the exception you're seeing.

Matthias

2010/9/3 Ravi Pawar &lt;ravifc@gmail.com&gt;:
&gt; thank you for the reply and time you spend.
&gt; your guest domain should not be running and then run my program without any
&gt; change.you will see an exception where you dont expect it to occur.
&gt; libvirt : 0.6.3 and libvirt-java: 0.4.2 i am using. Please let me know if i
&gt; miss to provide you any other details.
&gt;
&gt;
&gt; On Fri, Sep 3, 2010 at 3:29 AM, Matthias Bolte
&gt; &lt;matthias.bolte@googlemail.com&gt; wrote:
&gt;&gt;
&gt;&gt; 2010/9/2 Ravi Pawar &lt;ravifc@gmail.com&gt;:
&gt;&gt; &gt; please check the java file attached they throws the exception in case of
&gt;&gt; &gt; passing.
&gt;&gt; &gt; please let me know if i am missing something.
&gt;&gt; &gt;
&gt;&gt;
&gt;&gt; Can you explain in more detail what one should do to reproduce the
&gt;&gt; problem you seem to see with the attached code? Also you didn't
&gt;&gt; mention which versions of libvirt and libvirt-java you're using.
&gt;&gt;
&gt;&gt; When I run you example code (with a guest name that exists in my setup
&gt;&gt; and libvirt and libvirt-java form current git head) I don't see any
&gt;&gt; exceptions. Even when I add e.printStackTrace() to the catch block of
&gt;&gt; TestMultiThreadingLibvirtWithError I don't see exceptions.
&gt;&gt;
&gt;&gt; $ java -classpath
&gt;&gt; ./target/libvirt-0.4.6.jar:./ravi:/usr/share/java/jna.jar Test
&gt;&gt; start class 0
&gt;&gt; start class 1
&gt;&gt; start class 2
&gt;&gt; start class 3
&gt;&gt; start class 4
&gt;&gt; start class 5
&gt;&gt; start class 6
&gt;&gt; start class 7
&gt;&gt; start class 8
&gt;&gt; start class 9
&gt;&gt;
&gt;&gt; So this works for me.
&gt;&gt;
&gt;&gt; Matthias
&gt;
&gt;
&gt;
&gt; --
&gt; Thanks &amp; Regards
&gt;
&gt; Ravi Pawar
&gt;

</body></email><email><emailId>20100903103551</emailId><senderName>Ravi Pawar</senderName><senderEmail>ravifc@gmail.com</senderEmail><timestampReceived>2010-09-03 10:35:51-0400</timestampReceived><subject>Re: [libvirt-users] is libvirt java binding thread safe?</subject><body>

here is the stacktrace:


org.libvirt.LibvirtException: invalid argument in cannot pin vcpus on an
inactive domain
        at org.libvirt.ErrorHandler.processError(Unknown Source)
        at org.libvirt.Connect.processError(Unknown Source)
        at org.libvirt.Connect.storagePoolLookupByName(Unknown Source)
        at TestMultiThreadingLibvirt.run(TestMultiThreadingLibvirt.java:25)
        at java.lang.Thread.run(Thread.java:619)
libvir: QEMU error : invalid argument in cannot pin vcpus on an inactive
domain

from your stacktrace i could find out that you have printed the stacktrace
in TestMultiThreadingLibvirtWithError  class. please do check the code i
have pasted below for the second thread.


public class TestMultiThreadingLibvirtWithError implements Runnable
{
        Connect m_conn = null;
        public TestMultiThreadingLibvirtWithError(Connect conn)
        {
                m_conn = conn;

        }
        @Override
        public void run() {


                        try {
                                Domain d =
m_conn.domainLookupByName("afzaltestmachine");
                                VcpuInfo[] vcpuInfo = d.getVcpusInfo();


                        }
                      *  catch (Exception e)
                        {
                           //we are explicitly eating up the exception here
and we know Exception is going to occur here.

                        }*

        }

}


please let me know if my you have more queries to my problem.

On Fri, Sep 3, 2010 at 2:37 PM, Matthias Bolte &lt;
matthias.bolte@googlemail.com&gt; wrote:

&gt; Well, if the domain is not running then I get this exception with
&gt; libvirt 0.6.3 and libvirt-java 0.4.2:
&gt;
&gt; org.libvirt.LibvirtException: invalid argument in cannot pin vcpus on
&gt; an inactive domain
&gt;        at org.libvirt.ErrorHandler.processError(Unknown Source)
&gt;        at org.libvirt.Connect.processError(Unknown Source)
&gt;        at org.libvirt.Domain.processError(Unknown Source)
&gt;        at org.libvirt.Domain.getVcpusInfo(Unknown Source)
&gt;        *at TestMultiThreadingLibvirtWithE**rror.run(**
&gt; TestMultiThreadingLibvirtWithE**rror.java:20)*
&gt;        at java.lang.Thread.run(Thread.java:636)
&gt;
&gt; The error message is misleading and current git version gives this
&gt; exception when the domain is not running:
&gt;
&gt; org.libvirt.LibvirtException: Requested operation is not valid: cannot
&gt; list vcpu pinning for an inactive domain
&gt;        at org.libvirt.ErrorHandler.processError(Unknown Source)
&gt;        at org.libvirt.Connect.processError(Unknown Source)
&gt;        at org.libvirt.Domain.processError(Unknown Source)
&gt;        at org.libvirt.Domain.getVcpusInfo(Unknown Source)
&gt;        *at TestMultiThreadingLibvirtWithE**rror.run(**
&gt; TestMultiThreadingLibvirtWithE**rror.java:20)*
&gt;        at java.lang.Thread.run(Thread.java:636)
&gt;
&gt; And that's perfectly valid, as the complete vCPU information is only
&gt; available when the domain is running, therefore the exception is
&gt; expected when you call getVcpusInfo on a non-running domain. Also this
&gt; has nothing to do with thread-safety.
&gt;
&gt; If this isn't the exception you're referring to, then please show a
&gt; stacktrace of the exception you're seeing.
&gt;
&gt; Matthias
&gt;
&gt; 2010/9/3 Ravi Pawar &lt;ravifc@gmail.com&gt;:
&gt; &gt; thank you for the reply and time you spend.
&gt; &gt; your guest domain should not be running and then run my program without
&gt; any
&gt; &gt; change.you will see an exception where you dont expect it to occur.
&gt; &gt; libvirt : 0.6.3 and libvirt-java: 0.4.2 i am using. Please let me know if
&gt; i
&gt; &gt; miss to provide you any other details.
&gt; &gt;
&gt; &gt;
&gt; &gt; On Fri, Sep 3, 2010 at 3:29 AM, Matthias Bolte
&gt; &gt; &lt;matthias.bolte@googlemail.com&gt; wrote:
&gt; &gt;&gt;
&gt; &gt;&gt; 2010/9/2 Ravi Pawar &lt;ravifc@gmail.com&gt;:
&gt; &gt;&gt; &gt; please check the java file attached they throws the exception in case
&gt; of
&gt; &gt;&gt; &gt; passing.
&gt; &gt;&gt; &gt; please let me know if i am missing something.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt;
&gt; &gt;&gt; Can you explain in more detail what one should do to reproduce the
&gt; &gt;&gt; problem you seem to see with the attached code? Also you didn't
&gt; &gt;&gt; mention which versions of libvirt and libvirt-java you're using.
&gt; &gt;&gt;
&gt; &gt;&gt; When I run you example code (with a guest name that exists in my setup
&gt; &gt;&gt; and libvirt and libvirt-java form current git head) I don't see any
&gt; &gt;&gt; exceptions. Even when I add e.printStackTrace() to the catch block of
&gt; &gt;&gt; TestMultiThreadingLibvirtWithError I don't see exceptions.
&gt; &gt;&gt;
&gt; &gt;&gt; $ java -classpath
&gt; &gt;&gt; ./target/libvirt-0.4.6.jar:./ravi:/usr/share/java/jna.jar Test
&gt; &gt;&gt; start class 0
&gt; &gt;&gt; start class 1
&gt; &gt;&gt; start class 2
&gt; &gt;&gt; start class 3
&gt; &gt;&gt; start class 4
&gt; &gt;&gt; start class 5
&gt; &gt;&gt; start class 6
&gt; &gt;&gt; start class 7
&gt; &gt;&gt; start class 8
&gt; &gt;&gt; start class 9
&gt; &gt;&gt;
&gt; &gt;&gt; So this works for me.
&gt; &gt;&gt;
&gt; &gt;&gt; Matthias
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; --
&gt; &gt; Thanks &amp; Regards
&gt; &gt;
&gt; &gt; Ravi Pawar
&gt; &gt;
&gt;



-- 
Thanks &amp; Regards

Ravi Pawar

[Attachment #3 (text/html)]

&lt;br&gt;
here is the stacktrace:&lt;br&gt;&lt;br&gt;&lt;br&gt;org.libvirt.LibvirtException: invalid argument in \
cannot pin vcpus on an inactive domain&lt;br&gt;        at \
org.libvirt.ErrorHandler.processError(Unknown Source)&lt;br&gt;        at \
org.libvirt.Connect.processError(Unknown Source)&lt;br&gt;  at \
org.libvirt.Connect.storagePoolLookupByName(Unknown Source)&lt;br&gt;        at \
TestMultiThreadingLibvirt.run(TestMultiThreadingLibvirt.java:25)&lt;br&gt;        at \
java.lang.Thread.run(Thread.java:619)&lt;br&gt;libvir: QEMU error : invalid argument in \
cannot pin vcpus on an inactive domain&lt;br&gt; &lt;br&gt;from your stacktrace i could find out \
that you have printed the stacktrace in TestMultiThreadingLibvirtWithError  class. \
please do check the code i have pasted below for the second thread.&lt;br&gt;&lt;br&gt;&lt;br&gt;public \
class TestMultiThreadingLibvirtWithError implements Runnable&lt;br&gt; {&lt;br&gt;        Connect \
m_conn = null;&lt;br&gt;        public TestMultiThreadingLibvirtWithError(Connect conn)&lt;br&gt; \
{&lt;br&gt;                m_conn = conn;&lt;br&gt;&lt;br&gt;        }&lt;br&gt;        @Override&lt;br&gt;        \
public void run() {&lt;br&gt;  &lt;br&gt;&lt;br&gt;                        try {&lt;br&gt;                    \
Domain d = m_conn.domainLookupByName("afzaltestmachine");&lt;br&gt;               \
VcpuInfo[] vcpuInfo = d.getVcpusInfo();&lt;br&gt; &lt;br&gt;&lt;br&gt;                        }&lt;br&gt;     \
&lt;b&gt;  catch (Exception e)&lt;br&gt;                        {&lt;br&gt;                           \
//we are explicitly eating up the exception here and we know Exception is going to \
occur here. &lt;br&gt; &lt;br&gt;                        }&lt;/b&gt;&lt;br&gt;&lt;br&gt;        \
}&lt;br&gt;&lt;br&gt;}&lt;br&gt;&lt;br&gt;&lt;br&gt;please let me know if my you have more queries to my \
problem.&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Fri, Sep 3, 2010 at 2:37 PM, Matthias \
Bolte &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt; &lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; \
border-left: 1px solid rgb(204, 204, 204); padding-left: 1ex;"&gt;Well, if the domain is \
not running then I get this exception with&lt;br&gt; libvirt 0.6.3 and libvirt-java \
0.4.2:&lt;br&gt; &lt;br&gt;
org.libvirt.LibvirtException: invalid argument in cannot pin vcpus on&lt;br&gt;
an inactive domain&lt;br&gt;
        at org.libvirt.ErrorHandler.processError(Unknown Source)&lt;br&gt;
        at org.libvirt.Connect.processError(Unknown Source)&lt;br&gt;
        at org.libvirt.Domain.processError(Unknown Source)&lt;br&gt;
        at org.libvirt.Domain.getVcpusInfo(Unknown Source)&lt;br&gt;
        &lt;b&gt;at TestMultiThreadingLibvirtWithE&lt;/b&gt;&lt;b&gt;rror.run(&lt;/b&gt;&lt;b&gt;TestMultiThreadingLibvirtWithE&lt;/b&gt;&lt;b&gt;rror.java:20)&lt;/b&gt;&lt;br&gt;
  at java.lang.Thread.run(Thread.java:636)&lt;br&gt;
&lt;br&gt;
The error message is misleading and current git version gives this&lt;br&gt;
exception when the domain is not running:&lt;br&gt;
&lt;br&gt;
org.libvirt.LibvirtException: Requested operation is not valid: cannot&lt;br&gt;
list vcpu pinning for an inactive domain&lt;br&gt;
        at org.libvirt.ErrorHandler.processError(Unknown Source)&lt;br&gt;
        at org.libvirt.Connect.processError(Unknown Source)&lt;br&gt;
        at org.libvirt.Domain.processError(Unknown Source)&lt;br&gt;
        at org.libvirt.Domain.getVcpusInfo(Unknown Source)&lt;br&gt;
        &lt;b&gt;at TestMultiThreadingLibvirtWithE&lt;/b&gt;&lt;b&gt;rror.run(&lt;/b&gt;&lt;b&gt;TestMultiThreadingLibvirtWithE&lt;/b&gt;&lt;b&gt;rror.java:20)&lt;/b&gt;&lt;br&gt;
  at java.lang.Thread.run(Thread.java:636)&lt;br&gt;
&lt;br&gt;
And that's perfectly valid, as the complete vCPU information is only&lt;br&gt;
available when the domain is running, therefore the exception is&lt;br&gt;
expected when you call getVcpusInfo on a non-running domain. Also this&lt;br&gt;
has nothing to do with thread-safety.&lt;br&gt;
&lt;br&gt;
If this isn't the exception you're referring to, then please show a&lt;br&gt;
stacktrace of the exception you're seeing.&lt;br&gt;
&lt;br&gt;
Matthias&lt;br&gt;
&lt;br&gt;
2010/9/3 Ravi Pawar &lt;&lt;a \
href="mailto:ravifc@gmail.com"&gt;ravifc@gmail.com&lt;/a&gt;&gt;:&lt;br&gt; &lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div \
class="h5"&gt;&gt; thank you for the reply and time you spend.&lt;br&gt; &gt; your guest \
domain should not be running and then run my program without any&lt;br&gt; &gt; change.you \
will see an exception where you dont expect it to occur.&lt;br&gt; &gt; libvirt : 0.6.3 and \
libvirt-java: 0.4.2 i am using. Please let me know if i&lt;br&gt; &gt; miss to provide you \
any other details.&lt;br&gt; &gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt; On Fri, Sep 3, 2010 at 3:29 AM, Matthias Bolte&lt;br&gt;
&gt; &lt;&lt;a href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; 2010/9/2 Ravi Pawar &lt;&lt;a \
href="mailto:ravifc@gmail.com"&gt;ravifc@gmail.com&lt;/a&gt;&gt;:&lt;br&gt; &gt;&gt; &gt; please \
check the java file attached they throws the exception in case of&lt;br&gt; &gt;&gt; &gt; \
passing.&lt;br&gt; &gt;&gt; &gt; please let me know if i am missing something.&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; Can you explain in more detail what one should do to reproduce the&lt;br&gt;
&gt;&gt; problem you seem to see with the attached code? Also you didn't&lt;br&gt;
&gt;&gt; mention which versions of libvirt and libvirt-java you're using.&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; When I run you example code (with a guest name that exists in my setup&lt;br&gt;
&gt;&gt; and libvirt and libvirt-java form current git head) I don't see any&lt;br&gt;
&gt;&gt; exceptions. Even when I add e.printStackTrace() to the catch block of&lt;br&gt;
&gt;&gt; TestMultiThreadingLibvirtWithError I don't see exceptions.&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; $ java -classpath&lt;br&gt;
&gt;&gt; ./target/libvirt-0.4.6.jar:./ravi:/usr/share/java/jna.jar Test&lt;br&gt;
&gt;&gt; start class 0&lt;br&gt;
&gt;&gt; start class 1&lt;br&gt;
&gt;&gt; start class 2&lt;br&gt;
&gt;&gt; start class 3&lt;br&gt;
&gt;&gt; start class 4&lt;br&gt;
&gt;&gt; start class 5&lt;br&gt;
&gt;&gt; start class 6&lt;br&gt;
&gt;&gt; start class 7&lt;br&gt;
&gt;&gt; start class 8&lt;br&gt;
&gt;&gt; start class 9&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; So this works for me.&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; Matthias&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt; --&lt;br&gt;
&gt; Thanks &amp; Regards&lt;br&gt;
&gt;&lt;br&gt;
&gt; Ravi Pawar&lt;br&gt;
&gt;&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;Thanks &amp; \
Regards&lt;br&gt;&lt;br&gt;Ravi Pawar&lt;br&gt;



</body></email><email><emailId>20100903110209</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-09-03 11:02:09-0400</timestampReceived><subject>Re: [libvirt-users] is libvirt java binding thread safe?</subject><body>

Ah, okay, now I understand what you want to say.

You have two threads A and B. When A runs on its own then it's just
fine, but when you add B (that triggers an exception on purpose and
ignores it) then A picks it up and reports it. This is the point where
thread safety comes to mind.

libvirt stores errors in thread-local-storage. It uses
pthread_key_create/pthread_{get,set}specific for this (or
TlsAlloc/Tls{Get,Set}Value on Windows).

I think what's happening here is that all your threads in Java share
the same thread-local-storage. Therefore, thread A can pickup the
error triggered by thread B, that should not happen.

I'm not sure how to fix that.

Matthias


2010/9/3 Ravi Pawar &lt;ravifc@gmail.com&gt;:
&gt;
&gt; here is the stacktrace:
&gt;
&gt;
&gt; org.libvirt.LibvirtException: invalid argument in cannot pin vcpus on an
&gt; inactive domain
&gt;         at org.libvirt.ErrorHandler.processError(Unknown Source)
&gt;         at org.libvirt.Connect.processError(Unknown Source)
&gt;         at org.libvirt.Connect.storagePoolLookupByName(Unknown Source)
&gt;         at TestMultiThreadingLibvirt.run(TestMultiThreadingLibvirt.java:25)
&gt;         at java.lang.Thread.run(Thread.java:619)
&gt; libvir: QEMU error : invalid argument in cannot pin vcpus on an inactive
&gt; domain



&gt; from your stacktrace i could find out that you have printed the stacktrace
&gt; in TestMultiThreadingLibvirtWithError  class. please do check the code i
&gt; have pasted below for the second thread.
&gt;
&gt;
&gt; public class TestMultiThreadingLibvirtWithError implements Runnable
&gt; {
&gt;         Connect m_conn = null;
&gt;         public TestMultiThreadingLibvirtWithError(Connect conn)
&gt;         {
&gt;                 m_conn = conn;
&gt;
&gt;         }
&gt;         @Override
&gt;         public void run() {
&gt;
&gt;
&gt;                         try {
&gt;                                 Domain d =
&gt; m_conn.domainLookupByName("afzaltestmachine");
&gt;                                 VcpuInfo[] vcpuInfo = d.getVcpusInfo();
&gt;
&gt;
&gt;                         }
&gt;                         catch (Exception e)
&gt;                         {
&gt;                            //we are explicitly eating up the exception here
&gt; and we know Exception is going to occur here.
&gt;
&gt;                         }
&gt;
&gt;         }
&gt;
&gt; }
&gt;
&gt;
&gt; please let me know if my you have more queries to my problem.
&gt;
&gt; On Fri, Sep 3, 2010 at 2:37 PM, Matthias Bolte
&gt; &lt;matthias.bolte@googlemail.com&gt; wrote:
&gt;&gt;
&gt;&gt; Well, if the domain is not running then I get this exception with
&gt;&gt; libvirt 0.6.3 and libvirt-java 0.4.2:
&gt;&gt;
&gt;&gt; org.libvirt.LibvirtException: invalid argument in cannot pin vcpus on
&gt;&gt; an inactive domain
&gt;&gt;        at org.libvirt.ErrorHandler.processError(Unknown Source)
&gt;&gt;        at org.libvirt.Connect.processError(Unknown Source)
&gt;&gt;        at org.libvirt.Domain.processError(Unknown Source)
&gt;&gt;        at org.libvirt.Domain.getVcpusInfo(Unknown Source)
&gt;&gt;        at
&gt;&gt; TestMultiThreadingLibvirtWithError.run(TestMultiThreadingLibvirtWithError.java:20)
&gt;&gt;        at java.lang.Thread.run(Thread.java:636)
&gt;&gt;
&gt;&gt; The error message is misleading and current git version gives this
&gt;&gt; exception when the domain is not running:
&gt;&gt;
&gt;&gt; org.libvirt.LibvirtException: Requested operation is not valid: cannot
&gt;&gt; list vcpu pinning for an inactive domain
&gt;&gt;        at org.libvirt.ErrorHandler.processError(Unknown Source)
&gt;&gt;        at org.libvirt.Connect.processError(Unknown Source)
&gt;&gt;        at org.libvirt.Domain.processError(Unknown Source)
&gt;&gt;        at org.libvirt.Domain.getVcpusInfo(Unknown Source)
&gt;&gt;        at
&gt;&gt; TestMultiThreadingLibvirtWithError.run(TestMultiThreadingLibvirtWithError.java:20)
&gt;&gt;        at java.lang.Thread.run(Thread.java:636)
&gt;&gt;
&gt;&gt; And that's perfectly valid, as the complete vCPU information is only
&gt;&gt; available when the domain is running, therefore the exception is
&gt;&gt; expected when you call getVcpusInfo on a non-running domain. Also this
&gt;&gt; has nothing to do with thread-safety.
&gt;&gt;
&gt;&gt; If this isn't the exception you're referring to, then please show a
&gt;&gt; stacktrace of the exception you're seeing.
&gt;&gt;
&gt;&gt; Matthias
&gt;&gt;
&gt;&gt; 2010/9/3 Ravi Pawar &lt;ravifc@gmail.com&gt;:
&gt;&gt; &gt; thank you for the reply and time you spend.
&gt;&gt; &gt; your guest domain should not be running and then run my program without
&gt;&gt; &gt; any
&gt;&gt; &gt; change.you will see an exception where you dont expect it to occur.
&gt;&gt; &gt; libvirt : 0.6.3 and libvirt-java: 0.4.2 i am using. Please let me know
&gt;&gt; &gt; if i
&gt;&gt; &gt; miss to provide you any other details.
&gt;&gt; &gt;
&gt;&gt; &gt;
&gt;&gt; &gt; On Fri, Sep 3, 2010 at 3:29 AM, Matthias Bolte
&gt;&gt; &gt; &lt;matthias.bolte@googlemail.com&gt; wrote:
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; 2010/9/2 Ravi Pawar &lt;ravifc@gmail.com&gt;:
&gt;&gt; &gt;&gt; &gt; please check the java file attached they throws the exception in case
&gt;&gt; &gt;&gt; &gt; of
&gt;&gt; &gt;&gt; &gt; passing.
&gt;&gt; &gt;&gt; &gt; please let me know if i am missing something.
&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Can you explain in more detail what one should do to reproduce the
&gt;&gt; &gt;&gt; problem you seem to see with the attached code? Also you didn't
&gt;&gt; &gt;&gt; mention which versions of libvirt and libvirt-java you're using.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; When I run you example code (with a guest name that exists in my setup
&gt;&gt; &gt;&gt; and libvirt and libvirt-java form current git head) I don't see any
&gt;&gt; &gt;&gt; exceptions. Even when I add e.printStackTrace() to the catch block of
&gt;&gt; &gt;&gt; TestMultiThreadingLibvirtWithError I don't see exceptions.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; $ java -classpath
&gt;&gt; &gt;&gt; ./target/libvirt-0.4.6.jar:./ravi:/usr/share/java/jna.jar Test
&gt;&gt; &gt;&gt; start class 0
&gt;&gt; &gt;&gt; start class 1
&gt;&gt; &gt;&gt; start class 2
&gt;&gt; &gt;&gt; start class 3
&gt;&gt; &gt;&gt; start class 4
&gt;&gt; &gt;&gt; start class 5
&gt;&gt; &gt;&gt; start class 6
&gt;&gt; &gt;&gt; start class 7
&gt;&gt; &gt;&gt; start class 8
&gt;&gt; &gt;&gt; start class 9
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; So this works for me.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Matthias
&gt;&gt; &gt;
&gt;&gt; &gt;
&gt;&gt; &gt;
&gt;&gt; &gt; --
&gt;&gt; &gt; Thanks &amp; Regards
&gt;&gt; &gt;
&gt;&gt; &gt; Ravi Pawar
&gt;&gt; &gt;
&gt;
&gt;
&gt;
&gt; --
&gt; Thanks &amp; Regards
&gt;
&gt; Ravi Pawar
&gt;

</body></email><email><emailId>20100903111226</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-09-03 11:12:26-0400</timestampReceived><subject>Re: [libvirt-users] is libvirt java binding thread safe?</subject><body>

On Fri, Sep 03, 2010 at 01:02:09PM +0200, Matthias Bolte wrote:
&gt; Ah, okay, now I understand what you want to say.
&gt; 
&gt; You have two threads A and B. When A runs on its own then it's just
&gt; fine, but when you add B (that triggers an exception on purpose and
&gt; ignores it) then A picks it up and reports it. This is the point where
&gt; thread safety comes to mind.
&gt; 
&gt; libvirt stores errors in thread-local-storage. It uses
&gt; pthread_key_create/pthread_{get,set}specific for this (or
&gt; TlsAlloc/Tls{Get,Set}Value on Windows).
&gt; 
&gt; I think what's happening here is that all your threads in Java share
&gt; the same thread-local-storage. Therefore, thread A can pickup the
&gt; error triggered by thread B, that should not happen.

That could only happen if the JVM was using green threads instead of
native threads, but no serious JVM still uses green threads these days.

Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100903111933</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-09-03 11:19:33-0400</timestampReceived><subject>Re: [libvirt-users] is libvirt java binding thread safe?</subject><body>

On Fri, Sep 03, 2010 at 01:02:09PM +0200, Matthias Bolte wrote:
&gt; Ah, okay, now I understand what you want to say.
&gt; 
&gt; You have two threads A and B. When A runs on its own then it's just
&gt; fine, but when you add B (that triggers an exception on purpose and
&gt; ignores it) then A picks it up and reports it. This is the point where
&gt; thread safety comes to mind.
&gt; 
&gt; libvirt stores errors in thread-local-storage. It uses
&gt; pthread_key_create/pthread_{get,set}specific for this (or
&gt; TlsAlloc/Tls{Get,Set}Value on Windows).
&gt; 
&gt; I think what's happening here is that all your threads in Java share
&gt; the same thread-local-storage. Therefore, thread A can pickup the
&gt; error triggered by thread B, that should not happen.
&gt; 
&gt; I'm not sure how to fix that.

Looking at the java code, I believe the problem is that the java
bindings are *not* using the threadsafe error APIs:

In Connect.java

    /**
     * call the error handling logic. Should be called after every libvirt call
     * 
     * @throws LibvirtException
     */
    protected void processError() throws LibvirtException {
        ErrorHandler.processError(libvirt, VCP);
    }

Which calls into

    public static void processError(Libvirt libvirt, ConnectionPointer conn) throws LibvirtException {
        virError vError = new virError();
        int errorCode = libvirt.virConnCopyLastError(conn, vError);

And virConnCopyLastError is *not* threadsafe:


/**
 * virConnCopyLastError:
 * @conn: pointer to the hypervisor connection
 * @to: target to receive the copy
 *
 * Copy the content of the last error caught on that connection
 *
 * This method is not protected against access from multiple
 * threads. In a multi-threaded application, always use the
 * global virGetLastError() API which is backed by thread
 * local storage.

Regards,
Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100903112047</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-09-03 11:20:47-0400</timestampReceived><subject>Re: [libvirt-users] is libvirt java binding thread safe?</subject><body>

2010/9/3 Daniel P. Berrange &lt;berrange@redhat.com&gt;:
&gt; On Fri, Sep 03, 2010 at 01:02:09PM +0200, Matthias Bolte wrote:
&gt;&gt; Ah, okay, now I understand what you want to say.
&gt;&gt;
&gt;&gt; You have two threads A and B. When A runs on its own then it's just
&gt;&gt; fine, but when you add B (that triggers an exception on purpose and
&gt;&gt; ignores it) then A picks it up and reports it. This is the point where
&gt;&gt; thread safety comes to mind.
&gt;&gt;
&gt;&gt; libvirt stores errors in thread-local-storage. It uses
&gt;&gt; pthread_key_create/pthread_{get,set}specific for this (or
&gt;&gt; TlsAlloc/Tls{Get,Set}Value on Windows).
&gt;&gt;
&gt;&gt; I think what's happening here is that all your threads in Java share
&gt;&gt; the same thread-local-storage. Therefore, thread A can pickup the
&gt;&gt; error triggered by thread B, that should not happen.
&gt;
&gt; That could only happen if the JVM was using green threads instead of
&gt; native threads, but no serious JVM still uses green threads these days.
&gt;

Well, yes. That's what I thought too and that's why it took me a while
until I understood what he meant.

But I can reproduce it his test program and with latest libvirt and
libvirt-java and the default JVM here on Ubuntu 10.04:

$ java -version
java version "1.6.0_18"
OpenJDK Runtime Environment (IcedTea6 1.8.1) (6b18-1.8.1-0ubuntu1)
OpenJDK 64-Bit Server VM (build 16.0-b13, mixed mode)

I get stacktraces printed from TestMultiThreadingLibvirt for
exceptions that are actually triggered in
TestMultiThreadingLibvirtWithError in another thread.

Matthias

</body></email><email><emailId>20100903112157</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-09-03 11:21:57-0400</timestampReceived><subject>Re: [libvirt-users] is libvirt java binding thread safe?</subject><body>

2010/9/3 Daniel P. Berrange &lt;berrange@redhat.com&gt;:
&gt; On Fri, Sep 03, 2010 at 01:02:09PM +0200, Matthias Bolte wrote:
&gt;&gt; Ah, okay, now I understand what you want to say.
&gt;&gt;
&gt;&gt; You have two threads A and B. When A runs on its own then it's just
&gt;&gt; fine, but when you add B (that triggers an exception on purpose and
&gt;&gt; ignores it) then A picks it up and reports it. This is the point where
&gt;&gt; thread safety comes to mind.
&gt;&gt;
&gt;&gt; libvirt stores errors in thread-local-storage. It uses
&gt;&gt; pthread_key_create/pthread_{get,set}specific for this (or
&gt;&gt; TlsAlloc/Tls{Get,Set}Value on Windows).
&gt;&gt;
&gt;&gt; I think what's happening here is that all your threads in Java share
&gt;&gt; the same thread-local-storage. Therefore, thread A can pickup the
&gt;&gt; error triggered by thread B, that should not happen.
&gt;&gt;
&gt;&gt; I'm not sure how to fix that.
&gt;
&gt; Looking at the java code, I believe the problem is that the java
&gt; bindings are *not* using the threadsafe error APIs:
&gt;
&gt; In Connect.java
&gt;
&gt;    /**
&gt;     * call the error handling logic. Should be called after every libvirt call
&gt;     *
&gt;     * @throws LibvirtException
&gt;     */
&gt;    protected void processError() throws LibvirtException {
&gt;        ErrorHandler.processError(libvirt, VCP);
&gt;    }
&gt;
&gt; Which calls into
&gt;
&gt;    public static void processError(Libvirt libvirt, ConnectionPointer conn) throws LibvirtException {
&gt;        virError vError = new virError();
&gt;        int errorCode = libvirt.virConnCopyLastError(conn, vError);
&gt;
&gt; And virConnCopyLastError is *not* threadsafe:
&gt;
&gt;
&gt; /**
&gt;  * virConnCopyLastError:
&gt;  * @conn: pointer to the hypervisor connection
&gt;  * @to: target to receive the copy
&gt;  *
&gt;  * Copy the content of the last error caught on that connection
&gt;  *
&gt;  * This method is not protected against access from multiple
&gt;  * threads. In a multi-threaded application, always use the
&gt;  * global virGetLastError() API which is backed by thread
&gt;  * local storage.
&gt;
&gt; Regards,
&gt; Daniel

Hm that might explain it, I'll check if that's the cause.

Matthias

</body></email><email><emailId>20100501134133</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-05-01 13:41:33-0400</timestampReceived><subject>Re: [libvirt-users] Windows Vista Client Fails to Connect to Ubuntu libvirtd</subject><body>

2010/5/1 Development &lt;development@simulamen.eu&gt;:
&gt; Requesting urgent assistance if I may?
&gt;
&gt;
&gt;
&gt; Attempting to connect to an Ubuntu machine using an MinMG compiled virsh on
&gt; a Windows Vista machine.  Using insecure TCP simply to prove a concept to a
&gt; client.  However, cannot connect; situation as follows:
&gt;

Do you resend your mails from a different email address on purpose?

Please don't do this!

I'm going to respond to your first mail [1] soon.

[1] https://www.redhat.com/archives/libvirt-users/2010-April/msg00088.html

Matthias

</body></email><email><emailId>20100501143318</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-05-01 14:33:18-0400</timestampReceived><subject>Re: [libvirt-users] Windows Vista Client Fails to Connect to Ubuntu libvirtd</subject><body>

2010/4/30 Tim McLeod &lt;tim.mcleod@simulamen.eu&gt;:
&gt; Requesting urgent assistance if I may?
&gt;
&gt; Attempting to connect to an Ubuntu machine using an MinMG compiled virsh on
&gt; a Windows Vista machine.  Using insecure TCP simply to prove a concept to a
&gt; client.  However, cannot connect; situation as follows:
&gt;
&gt; Edited /etc/libvirt/libvirt.conf as follows:
&gt; listen_tcp = 1
&gt; auth_tcp = "none"
&gt;
&gt; Edited /etc/default//libvirt-bin as follows:
&gt; libvirt-opts="-d -l"

Did you restart libvirtd after the changes and checked that it's
started successfully?

listen_tls defaults to 1 in /etc/libvirt/libvirt.conf, in combination
with the -l flag (short for --listen) libvirtd requires properly
configured SSL certificates. If libvirtd can't find the certificates
or fails to validate them then it won't start up.

You can disable TLS in /etc/libvirt/libvirt.conf by setting listen_tls
= 0 and restart libvirtd.

&gt; Running virsh on Vista client fails as follows:
&gt; $ virsh -c qemu+tcp://192.168.1.101/system
&gt; error: unable to connect to libvirtd at '192.168.1.101': errno=10061
&gt; error: failed to connect to the hypervisor
&gt;
&gt; Running virsh on Ubuntu server fails as follows:
&gt; $ virsh -c qemu+tcp:///system
&gt; Connecting to uri: qemu+tcp:///system
&gt; error: unable to connect to libvirtd at 'localhost': Connection refused
&gt; error: failed to connect to the hypervisor

Once libvirtd is running and configured properly for TCP transport
then remote and local TCP access to libvirtd works for me.

&gt; Indeed, with libvirt-opts="-d -l" in etc/default//libvirt-bin the 'default'
&gt; command also fails:
&gt; $ virsh -c qemu:///system
&gt; Connecting to uri: qemu:///system
&gt; error: unable to connect to 'var/run/libvirt/libvirt-sock': Connection
&gt; refused
&gt; error: failed to connect to the hypervisor
&gt;

Local access to libvirtd using qemu:///system requires properly
configured polkit, or running virsh as root. This is independent from
the -d and -l flags.

Matthias

</body></email><email><emailId>20100203031208</emailId><senderName>Stephen Liu</senderName><senderEmail>satimis@yahoo.com</senderEmail><timestampReceived>2010-02-03 03:12:08-0400</timestampReceived><subject>[libvirt-users] No sound</subject><body>

Hi folks,

Host - Debian 5.0
KVM
VM - Ubuntu 9.10


No sound on playing youtube.  Volume on host and VM has been turned to max,

Virtual Machine Manager
Edit -&gt; Preferences
Install Audio Device [check] Local VM

Please help.  TIA

B.R.
Stephen L 

Send instant messages to your online friends http://uk.messenger.yahoo.com 
[Attachment #3 (text/html)]

&lt;html&gt;&lt;head&gt;&lt;style type="text/css"&gt;&lt;!-- DIV {margin:0px;} \
--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div \
style="font-family:arial,helvetica,sans-serif;font-size:12pt;color:#000000;"&gt;Hi \
folks,&lt;br&gt; &lt;br&gt;
Host - Debian 5.0&lt;br&gt;
KVM&lt;br&gt;
VM - Ubuntu 9.10&lt;br&gt;&lt;br&gt;
&lt;br&gt;
No sound on playing youtube. Volume on host and VM has been turned to max,&lt;br&gt;
&lt;br&gt;
Virtual Machine Manager&lt;br&gt;
Edit -&gt; Preferences&lt;br&gt;
Install Audio Device [check] Local VM&lt;br&gt;
&lt;br&gt;
Please help. TIA&lt;br&gt;
&lt;br&gt;
B.R.&lt;br&gt;
Stephen L
&lt;!-- cg21.c4.mail.gq1.yahoo.com compressed/chunked Tue Feb  2 19:10:05 PST 2010 --&gt;
&lt;/div&gt;&lt;br&gt;Send instant messages to your online friends http://uk.messenger.yahoo.com \
&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20100203151350</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-02-03 15:13:50-0400</timestampReceived><subject>Re: [libvirt-users] No sound</subject><body>

On 02/02/2010 10:12 PM, Stephen Liu wrote:
&gt; Hi folks,
&gt; 
&gt; Host - Debian 5.0
&gt; KVM
&gt; VM - Ubuntu 9.10
&gt; 
&gt; 
&gt; No sound on playing youtube.  Volume on host and VM has been turned to max,
&gt; 
&gt; Virtual Machine Manager
&gt; Edit -&gt; Preferences
&gt; Install Audio Device [check] Local VM
&gt; 
&gt; Please help.  TIA
&gt; 

There are known issues with sound. Some of them (for fedora at least) are
documented here:

https://bugzilla.redhat.com/show_bug.cgi?id=508317

- Cole

</body></email><email><emailId>20100301032209</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-03-01 03:22:09-0400</timestampReceived><subject>Re: [libvirt-users] location of network xml files</subject><body>

On 02/28/2010 06:50 PM, carlos campderrs wrote:
&gt; Hello again,
&gt; 
&gt; 2010/3/1 carlos campderrs &lt;gilipollas.desconcertante@gmail.com
&gt; &lt;mailto:gilipollas.desconcertante@gmail.com&gt;&gt;
&gt; 
&gt; Is it reasonable to symlink (or hardlink if possible) one file to
&gt; the other? Or to remove the /etc file and point the autostart to the
&gt; /var file? Also, does the autostart do something? because it's
&gt; pointing to the ignored file.
&gt; 
&gt; 
&gt; Now I see that the contents of both files are different, so I suppose
&gt; that linking one to another wouldn't work. So, in short, what's the
&gt; purpose of /etc/libvirt/qemu/networks/default.xml?
&gt; 

You aren't supposed to edit the XML files in /etc/libvirt/qemu directly, you
should use virsh for that:

http://wiki.libvirt.org/page/FAQ#Where_are_VM_config_files_stored.3F_How_do_I_edit_a_VM.27s_XML_config.3F


Basically, the location of files under /etc/libvirt/qemu are an implementation
detail and its really not important what their purpose is: you should always
use virsh.

Also, making changes to the XML while the network is running won't take
immediate effect, you will need to restart it. This has more info with respect
to VMs, but it applies to networks as well:

http://wiki.libvirt.org/page/FAQ#If_I_change_the_XML_of_running_machine.2C_do_the_changes_take_immediate_effect.3F


- Cole


</body></email><email><emailId>20100301084745</emailId><senderName>carlos_campderrs</senderName><senderEmail>gilipollas.desconcertante@gmail.com</senderEmail><timestampReceived>2010-03-01 08:47:45-0400</timestampReceived><subject>Re: [libvirt-users] location of network xml files</subject><body>

Hi Cole,

2010/3/1 Cole Robinson &lt;crobinso@redhat.com&gt;

&gt; You aren't supposed to edit the XML files in /etc/libvirt/qemu directly,
&gt; you
&gt; should use virsh for that:
&gt; 
&gt; 
&gt; http://wiki.libvirt.org/page/FAQ#Where_are_VM_config_files_stored.3F_How_do_I_edit_a_VM.27s_XML_config.3F
&gt; 


Thank you, didn't see that wiki FAQ, but only http://libvirt.org/FAQ.html.

carlos.

-- 
Si no puedes deslumbrar con tu sabidura,
desconcierta con tus gilipolleces


[Attachment #3 (text/html)]

Hi Cole,&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;2010/3/1 Cole Robinson &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:crobinso@redhat.com"&gt;crobinso@redhat.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt; &lt;div class="im"&gt;You aren't supposed to edit the XML \
files in /etc/libvirt/qemu directly, you&lt;/div&gt; should use virsh for that:&lt;br&gt;
&lt;br&gt;
&lt;a href="http://wiki.libvirt.org/page/FAQ#Where_are_VM_config_files_stored.3F_How_do_I_edit_a_VM.27s_XML_config.3F" \
target="_blank"&gt;http://wiki.libvirt.org/page/FAQ#Where_are_VM_config_files_stored.3F_How_do_I_edit_a_VM.27s_XML_config.3F&lt;/a&gt;&lt;/blockquote&gt;
 &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thank you, didn't see that wiki FAQ, but only &lt;a \
href="http://libvirt.org/FAQ.html"&gt;http://libvirt.org/FAQ.html&lt;/a&gt;.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;carlos.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;-- \
&lt;br&gt;Si no puedes deslumbrar con tu sabidura,&lt;br&gt; desconcierta con tus \
gilipolleces&lt;br&gt;



</body></email><email><emailId>20100803130737</emailId><senderName>Ryota Ozaki</senderName><senderEmail>ozaki.ryota@gmail.com</senderEmail><timestampReceived>2010-08-03 13:07:37-0400</timestampReceived><subject>Re: [libvirt-users] libvirt and lxc</subject><body>

Hi Nirmal,

On Tue, Aug 3, 2010 at 10:30 AM, Nirmal Guhan &lt;vavatutu@gmail.com&gt; wrote:
&gt; Is anyone using libvirt for lxc ? I am trying to do so and running
&gt; into an issue. The system container starts fine with lxc tools and am
&gt; able to connect to it.
&gt;
&gt; Here is the snippet of my xml file (rest is same as in
&gt; http://libvirt.org/drvlxc.html)
&gt;
&gt;  &lt;devices&gt;
&gt;    &lt;emulator&gt;/usr/libexec/libvirt_lxc&lt;/emulator&gt;
&gt;    &lt;filesystem type='mount'&gt;
&gt;      &lt;source dir='/lxc/f12'/&gt;
&gt;      &lt;target dir='/'/&gt;
&gt;    &lt;/filesystem&gt;
&gt;    &lt;interface type='bridge'&gt;
&gt;      &lt;mac address='52:54:00:82:87:64'/&gt;
&gt;      &lt;source bridge='br0'/&gt;
&gt;      &lt;target dev='tap0'/&gt;
&gt;    &lt;/interface&gt;
&gt;    &lt;console type='pty'&gt;
&gt;      &lt;target port='0'/&gt;
&gt;    &lt;/console&gt;
&gt;  &lt;/devices&gt;
&gt;
&gt; Am able to start the container but when I do console :
&gt;
&gt; virsh # console f12lxc
&gt; Connected to domain f12lxc
&gt; Escape character is ^]
&gt; &lt;&lt;hangs here and I press enter, it destroys the domain&gt;&gt;
&gt; virsh #

Probably you set:
  &lt;os&gt;
    &lt;type&gt;exe&lt;/type&gt;
    &lt;init&gt;/init&lt;/init&gt;
  &lt;/os&gt;
right? If so, could you try "/bin/sh" instead of "/init"?

  ozaki-r

&gt;
&gt; Am running Fedora 12 with 2.6.32.10-90.fc12.i686. I changed target
&gt; dev='tap0' to 'veth' and no change in the behavior.
&gt;
&gt; Please help.
&gt;
&gt; Thanks,
&gt; Nirmal
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

</body></email><email><emailId>20100803141708</emailId><senderName>Robin Green</senderName><senderEmail>greenrd@greenrd.org</senderEmail><timestampReceived>2010-08-03 14:17:08-0400</timestampReceived><subject>Re: [libvirt-users] libvirt and lxc</subject><body>

At Mon, 2 Aug 2010 18:30:03 -0700,
Nirmal Guhan wrote:
&gt; 
&gt; Is anyone using libvirt for lxc ?

Yes, I am on, on F12. I have run into one or two issues though, so much so
that I only boot with kernel 2.6.31.12-174.2.22.fc12.i686.PAE now.
However, these issues may not affect you, and it's been a while so I can't remember what
they were exactly.

&gt; Am able to start the container but when I do console :
&gt; 
&gt; virsh # console f12lxc
&gt; Connected to domain f12lxc
&gt; Escape character is ^]
&gt; &lt;&lt;hangs here and I press enter, it destroys the domain&gt;&gt;

Hmm, when I had this issue I was not really able to get any useful diagnostic information
from anywhere. I had to resort to starting with /bin/bash and bringing up everything
manually - which is what I still do. Obviously, I hope this situation will be improved
in the future!

-- 
Robin

</body></email><email><emailId>20100803172841</emailId><senderName>Nirmal Guhan</senderName><senderEmail>vavatutu@gmail.com</senderEmail><timestampReceived>2010-08-03 17:28:41-0400</timestampReceived><subject>Re: [libvirt-users] libvirt and lxc</subject><body>

On Tue, Aug 3, 2010 at 6:07 AM, Ryota Ozaki &lt;ozaki.ryota@gmail.com&gt; wrote:
&gt; Hi Nirmal,
&gt;
&gt; On Tue, Aug 3, 2010 at 10:30 AM, Nirmal Guhan &lt;vavatutu@gmail.com&gt; wrote:
&gt;&gt; Is anyone using libvirt for lxc ? I am trying to do so and running
&gt;&gt; into an issue. The system container starts fine with lxc tools and am
&gt;&gt; able to connect to it.
&gt;&gt;
&gt;&gt; Here is the snippet of my xml file (rest is same as in
&gt;&gt; http://libvirt.org/drvlxc.html)
&gt;&gt;
&gt;&gt;  &lt;devices&gt;
&gt;&gt;    &lt;emulator&gt;/usr/libexec/libvirt_lxc&lt;/emulator&gt;
&gt;&gt;    &lt;filesystem type='mount'&gt;
&gt;&gt;      &lt;source dir='/lxc/f12'/&gt;
&gt;&gt;      &lt;target dir='/'/&gt;
&gt;&gt;    &lt;/filesystem&gt;
&gt;&gt;    &lt;interface type='bridge'&gt;
&gt;&gt;      &lt;mac address='52:54:00:82:87:64'/&gt;
&gt;&gt;      &lt;source bridge='br0'/&gt;
&gt;&gt;      &lt;target dev='tap0'/&gt;
&gt;&gt;    &lt;/interface&gt;
&gt;&gt;    &lt;console type='pty'&gt;
&gt;&gt;      &lt;target port='0'/&gt;
&gt;&gt;    &lt;/console&gt;
&gt;&gt;  &lt;/devices&gt;
&gt;&gt;
&gt;&gt; Am able to start the container but when I do console :
&gt;&gt;
&gt;&gt; virsh # console f12lxc
&gt;&gt; Connected to domain f12lxc
&gt;&gt; Escape character is ^]
&gt;&gt; &lt;&lt;hangs here and I press enter, it destroys the domain&gt;&gt;
&gt;&gt; virsh #
&gt;
&gt; Probably you set:
&gt;  &lt;os&gt;
&gt;    &lt;type&gt;exe&lt;/type&gt;
&gt;    &lt;init&gt;/init&lt;/init&gt;
&gt;  &lt;/os&gt;
&gt; right? If so, could you try "/bin/sh" instead of "/init"?

Thanks. /bin/bash got me to console. But the init sequence for my
container is different from the one started using lxc tools with
/bin/bash. So I changed it to /sbin/init and now I can get the usual
login prompt. Fun doesn't end there. Am prompted for login but the
password is never accepted whereas I can login using the same password
(as root) in the container started using lxc tools. So eventually am
not able to login :-(


&gt;
&gt;  ozaki-r
&gt;
&gt;&gt;
&gt;&gt; Am running Fedora 12 with 2.6.32.10-90.fc12.i686. I changed target
&gt;&gt; dev='tap0' to 'veth' and no change in the behavior.
&gt;&gt;
&gt;&gt; Please help.
&gt;&gt;
&gt;&gt; Thanks,
&gt;&gt; Nirmal
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; libvirt-users mailing list
&gt;&gt; libvirt-users@redhat.com
&gt;&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;&gt;
&gt;

</body></email><email><emailId>20100803173022</emailId><senderName>Nirmal Guhan</senderName><senderEmail>vavatutu@gmail.com</senderEmail><timestampReceived>2010-08-03 17:30:22-0400</timestampReceived><subject>Re: [libvirt-users] libvirt and lxc</subject><body>

On Tue, Aug 3, 2010 at 7:17 AM, Robin Green &lt;greenrd@greenrd.org&gt; wrote:
&gt; At Mon, 2 Aug 2010 18:30:03 -0700,
&gt; Nirmal Guhan wrote:
&gt;&gt;
&gt;&gt; Is anyone using libvirt for lxc ?
&gt;
&gt; Yes, I am on, on F12. I have run into one or two issues though, so much so
&gt; that I only boot with kernel 2.6.31.12-174.2.22.fc12.i686.PAE now.
&gt; However, these issues may not affect you, and it's been a while so I can't remember what
&gt; they were exactly.
&gt;
&gt;&gt; Am able to start the container but when I do console :
&gt;&gt;
&gt;&gt; virsh # console f12lxc
&gt;&gt; Connected to domain f12lxc
&gt;&gt; Escape character is ^]
&gt;&gt; &lt;&lt;hangs here and I press enter, it destroys the domain&gt;&gt;
&gt;
&gt; Hmm, when I had this issue I was not really able to get any useful diagnostic information
&gt; from anywhere. I had to resort to starting with /bin/bash and bringing up everything
&gt; manually - which is what I still do. Obviously, I hope this situation will be improved
&gt; in the future!

Hmm.. I can still get to login prompt (please see my other reply) but
not beyond it yet. I was assuming libvirt for lxc uses lxc tools
inturn. Is it not the case? How do I specify fstab mounts as I do
using lxc tools? Please let me know.
&gt;
&gt; --
&gt; Robin
&gt;

</body></email><email><emailId>20101102015941</emailId><senderName>Mohd Izhar Firdaus Ismail</senderName><senderEmail>kagesenshi.87@gmail.com</senderEmail><timestampReceived>2010-11-02 01:59:41-0400</timestampReceived><subject>[libvirt-users] Libvirt and LXC</subject><body>

(oops accidentally sent to -owners)

Hi, i'm trying to start a LXC guest on a F14 computer .. followed the
examples in http://libvirt.org/drvlxc.html, but got stuck when
starting it ..

03:07:23.706: debug : virCgroupNew:542 : New group /
03:07:23.707: debug : lxcControllerRun:563 : Setting up private /dev/pts
03:07:23.711: debug : lxcControllerRun:589 : Mouting 'devpts' on
/var/lxc/f14/dev/pts
03:07:23.711: debug : lxcControllerRun:604 : Opening tty on private
/var/lxc/f14/dev/pts/ptmx
03:07:23.714: debug : lxcContainerAvailable:897 : clone call returned
Invalid argument, container support is not enabled
03:07:23.714: debug : lxcContainerStart:848 : Enable network namespaces
03:07:23.718: debug : lxcContainerStart:854 : clone() completed, new
container PID is -1
03:07:23.718: error : lxcContainerStart:858 : Failed to run clone
container: Invalid argument
03:07:23.718: debug : vethDelete:141 : veth: veth1
03:07:23.718: debug : virRunWithHook:820 : ip link del veth1

LXC config:

&lt;domain type='lxc'&gt;
 &lt;name&gt;f14&lt;/name&gt;
 &lt;uuid&gt;2dcd3cac-47e6-2915-554a-9713edf6ffd1&lt;/uuid&gt;
 &lt;memory&gt;256000&lt;/memory&gt;
 &lt;currentMemory&gt;256000&lt;/currentMemory&gt;
 &lt;vcpu&gt;1&lt;/vcpu&gt;
 &lt;os&gt;
   &lt;type arch='x86_64'&gt;exe&lt;/type&gt;
   &lt;init&gt;/sbin/init&lt;/init&gt;
 &lt;/os&gt;
 &lt;clock offset='utc'/&gt;
 &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
 &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
 &lt;on_crash&gt;destroy&lt;/on_crash&gt;
 &lt;devices&gt;
   &lt;emulator&gt;/usr/libexec/libvirt_lxc&lt;/emulator&gt;
   &lt;filesystem type='mount'&gt;
     &lt;source dir='/var/lxc/f14'/&gt;
     &lt;target dir='/'/&gt;
   &lt;/filesystem&gt;
   &lt;interface type='network'&gt;
     &lt;mac address='52:54:00:b0:de:18'/&gt;
     &lt;source network='default'/&gt;
   &lt;/interface&gt;
   &lt;console type='pty'&gt;
     &lt;target type='serial' port='0'/&gt;
   &lt;/console&gt;
 &lt;/devices&gt;
&lt;/domain&gt;


I dont know what the invalid arguments are...
03:07:23.718: error : lxcContainerStart:858 : Failed to run clone
container: Invalid argument


thanks
--
Mohd Izhar Firdaus Bin Ismail / KageSenshi
Inigo Consulting (FOSS/Plone Development, Training &amp; Services)
http://www.inigo-tech.com
Fedora Malaysia Contributor &amp; Ambassador
http://blog.kagesenshi.org
92C2 B295 B40B B3DC 6866  5011 5BD2 584A 8A5D 7331

</body></email><email><emailId>20100701013412</emailId><senderName>Justin Clift</senderName><senderEmail>justin@salasaga.org</senderEmail><timestampReceived>2010-07-01 01:34:12-0400</timestampReceived><subject>Re: [libvirt-users] C API example</subject><body>

On 07/01/2010 11:12 AM, steven765@yahoo.com wrote:
&gt; Trying to build the hellolibvirt example.  I get the project to
&gt; compile okay but when I try to run it I get:
&gt;
&gt; Unable to connect to '/usr/local/var/run/libvirt/libivrt-sock
&gt;
&gt; Given libvirt --status says it's in /var/run/libvirt/libvirt-sock
&gt; that makes sense.  How do I make the git version run with my local
&gt; copy?

At the moment (still learning things), this works for me:

   $ ./configure --prefix=/
   $ make

I don't (!) do "make install" afterwards though, as that would likely 
install over the top of system provided things.

It does let me connect to the libvirtd daemon using the newly compiled 
virsh (shell utility) though:

   $ sudo tools/virsh

Hope that helps. :)

Regards and best wishes,

Justin Clift

-- 
Salasaga  -  Open Source eLearning IDE
               http://www.salasaga.org

</body></email><email><emailId>20100701015437</emailId><senderName>Dave Allan</senderName><senderEmail>dallan@redhat.com</senderEmail><timestampReceived>2010-07-01 01:54:37-0400</timestampReceived><subject>Re: [libvirt-users] C API example</subject><body>

On Thu, Jul 01, 2010 at 11:34:12AM +1000, Justin Clift wrote:
&gt; On 07/01/2010 11:12 AM, steven765@yahoo.com wrote:
&gt; &gt;Trying to build the hellolibvirt example.  I get the project to
&gt; &gt;compile okay but when I try to run it I get:
&gt; &gt;
&gt; &gt;Unable to connect to '/usr/local/var/run/libvirt/libivrt-sock
&gt; &gt;
&gt; &gt;Given libvirt --status says it's in /var/run/libvirt/libvirt-sock
&gt; &gt;that makes sense.  How do I make the git version run with my local
&gt; &gt;copy?

./hellolibvirt \
qemu+unix:///system?socket=/var/run/libvirt/libvirt-sock

will let you connect to the packaged daemon.

&gt; At the moment (still learning things), this works for me:
&gt; 
&gt;   $ ./configure --prefix=/
&gt;   $ make
&gt; 
&gt; I don't (!) do "make install" afterwards though, as that would
&gt; likely install over the top of system provided things.

Indeed it will overwrite things.  If I'm building from source on a
machine that has packaged libvirt installed, I just use a prefix like

--prefix=/root/gitlibvirt/install

Then you can run a second copy of libvirtd if you decide you want to.

Dave

</body></email><email><emailId>20100701020939</emailId><senderName>Justin Clift</senderName><senderEmail>justin@salasaga.org</senderEmail><timestampReceived>2010-07-01 02:09:39-0400</timestampReceived><subject>Re: [libvirt-users] C API example</subject><body>

On 07/01/2010 11:54 AM, Dave Allan wrote:
&lt;snip&gt;
&gt; ./hellolibvirt \
&gt; qemu+unix:///system?socket=/var/run/libvirt/libvirt-sock

Thanks Dave.  The +unix:// and ?socket=xxx bits are what I'd not been 
picking up on.  Should be good now.

Steven, is it working for you?

Regards and best wishes,

Justin Clift

-- 
Salasaga  -  Open Source eLearning IDE
               http://www.salasaga.org

</body></email><email><emailId>20100701023727</emailId><senderName></senderName><senderEmail>steven765@yahoo.com</senderEmail><timestampReceived>2010-07-01 02:37:27-0400</timestampReceived><subject>Re: [libvirt-users] C API example</subject><body>

I think so, but I'm locked out at home. I'll have to try at school tomorrow.  It gave \
me a remote error, but with the correct directory so fingers crossed thanks!  

btw might you or anyone know what I have to include to start a clean project of my \
own?  So if I want to just build an application that uses the API with nothing else \
but what's necessary?

Thanks,
Steve

--- On Wed, 6/30/10, Justin Clift &lt;justin@salasaga.org&gt; wrote:

&gt; From: Justin Clift &lt;justin@salasaga.org&gt;
&gt; Subject: Re: [libvirt-users] C API example
&gt; To: "Dave Allan" &lt;dallan@redhat.com&gt;
&gt; Cc: steven765@yahoo.com, libvirt-users@redhat.com
&gt; Date: Wednesday, June 30, 2010, 10:09 PM
&gt; On 07/01/2010 11:54 AM, Dave Allan
&gt; wrote:
&gt; &lt;snip&gt;
&gt; &gt; ./hellolibvirt \
&gt; &gt; 
&gt; qemu+unix:///system?socket=/var/run/libvirt/libvirt-sock
&gt; 
&gt; Thanks Dave.  The +unix:// and ?socket=xxx bits are
&gt; what I'd not been picking up on.  Should be good now.
&gt; 
&gt; Steven, is it working for you?
&gt; 
&gt; Regards and best wishes,
&gt; 
&gt; Justin Clift
&gt; 
&gt; -- Salasaga  -  Open Source eLearning IDE
&gt; http://www.salasaga.org
&gt; 


      


</body></email><email><emailId>20101001153636</emailId><senderName>"Roberto Attias (rattias)"</senderName><senderEmail>rattias@cisco.com</senderEmail><timestampReceived>2010-10-01 15:36:36-0400</timestampReceived><subject>[libvirt-users] how to programmatically undefine and redefine a Domain?</subject><body>

Hello,

I'm facing some strange behavior, and I hope you can provide a
clarification. 

Consider the following code:

 

     virDomainPtr dom = virDomainLookupByName(virt, domain_name);

     if (dom) {

           printf("domain already defined...\n");

           if (virDomainUndefine(dom))

                printf("...unable to undefine!!!\n");

           else {

                printf("...undefined.");

                free(dom);

           }

     }

     dom = virDomainDefineXML(virt, SOME_XML);

     if (dom != NULL) {

           const char *name = virDomainGetName(dom);

           printf("NAME IS NOW: %s\n", name);

     } else

           printf("dom is NULL!\n");

 

When executed the first time, the code correctly defines the domain, and
prints:

 

defining domain test2-vm

libvir: QEMU error : Domain not found: no domain with matching name
'test2-vm'

NAME IS NOW: test2-vm

 

If executed a second time with  the same SOME_XML when the domain is
already defined, it prints:

 

defining domain test2-vm

domain already defined...

libvir: Domain error : invalid domain pointer in virDomainGetName

undefining......undefined.NAME IS NOW: (null)

 

Not only the name is null, but the domain can't be started. What is the
correct way to undefined programmatically a domain that is already
defined? Why is the second virDomainDefineXML() returining a pointer (as
opposed to null), but the pointed object seem to be invalid?

 

Thanks, 

                 Roberto


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;meta http-equiv=Content-Type content="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 12 (filtered medium)"&gt;
&lt;style&gt;
&lt;!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
--&gt;
&lt;/style&gt;
&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapelayout v:ext="edit"&gt;
  &lt;o:idmap v:ext="edit" data="1" /&gt;
 &lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
&lt;/head&gt;

&lt;body lang=EN-US link=blue vlink=purple&gt;

&lt;div class=WordSection1&gt;

&lt;p class=MsoNormal&gt;Hello,&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Im facing some strange behavior, and I hope you can
provide a clarification. &lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Consider the following code:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier New"'&gt; \
virDomainPtr dom = virDomainLookupByName(virt, domain_name);&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier New"'&gt; \
if (dom) {&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier \
New"'&gt; \
printf("domain already defined...\n");&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier \
New"'&gt; if \
(virDomainUndefine(dom))&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier \
New"'&gt; \
printf("...unable to undefine!!!\n");&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier \
New"'&gt; else \
{&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier \
New"'&gt; \
printf("...undefined.");&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier \
New"'&gt; \
free(dom);&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier \
New"'&gt; \
}&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier New"'&gt; \
}&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier New"'&gt; \
dom = virDomainDefineXML(virt, SOME_XML);&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier New"'&gt; \
if (dom != NULL) {&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier \
New"'&gt; const char *name = \
virDomainGetName(dom);&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier \
New"'&gt; printf("NAME \
IS NOW: %s\n", name);&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier New"'&gt; }
else&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-family:"Courier \
New"'&gt; printf("dom \
is NULL!\n");&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;When executed the first time, the code correctly defines the
domain, and prints:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal style='margin-left:.5in'&gt;&lt;span style='font-family:"Courier \
New"'&gt;defining domain test2-vm&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal style='margin-left:.5in'&gt;&lt;span style='font-family:"Courier \
New"'&gt;libvir: QEMU error : Domain not found: no domain with matching name \
'test2-vm'&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal style='margin-left:.5in'&gt;&lt;span style='font-family:"Courier \
New"'&gt;NAME IS NOW: test2-vm&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;If executed a second time with the same SOME_XML when
the domain is already defined, it prints:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal style='margin-left:.5in'&gt;&lt;span style='font-family:"Courier \
New"'&gt;defining domain test2-vm&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal style='margin-left:.5in'&gt;&lt;span style='font-family:"Courier \
New"'&gt;domain already defined...&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal style='margin-left:.5in'&gt;&lt;span style='font-family:"Courier \
New"'&gt;libvir: Domain error : invalid domain pointer in \
virDomainGetName&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal style='margin-left:.5in'&gt;&lt;span style='font-family:"Courier \
New"'&gt;undefining......undefined.NAME IS NOW: (null)&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Not only the name is null, but the domain cant be
started. What is the correct way to undefined programmatically a domain that is
already defined? Why is the second virDomainDefineXML() returining a pointer
(as opposed to null), but the pointed object seem to be invalid?&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Thanks, &lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;
 Roberto&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;



</body></email><email><emailId>20101001161402</emailId><senderName>"Roberto Attias (rattias)"</senderName><senderEmail>rattias@cisco.com</senderEmail><timestampReceived>2010-10-01 16:14:02-0400</timestampReceived><subject>Re: [libvirt-users] undefining and redefining a Domain</subject><body>

Yes, I was calling free() instead of virDomainFree. Thanks!

-----Original Message-----
From: Matthias Bolte [mailto:matthias.bolte@googlemail.com] 
Sent: Friday, October 01, 2010 9:11 AM
To: Roberto Attias (rattias)
Cc: libvirt-users@redhat.com
Subject: Re: [libvirt-users] undefining and redefining a Domain

2010/10/1 Roberto Attias (rattias) &lt;rattias@cisco.com&gt;:
&gt; &lt;resending as I dont think I was in the mailing list yet when I sent first
&gt; time apologies if you receive this twice&gt;
&gt;
&gt;
&gt;
&gt; Hello,
&gt;
&gt; Im facing some strange behavior, and I hope you can provide a
&gt; clarification.
&gt;
&gt; Consider the following code:
&gt;
&gt;
&gt;
&gt;      virDomainPtr dom = virDomainLookupByName(virt, domain_name);
&gt;
&gt;      if (dom) {
&gt;
&gt;            printf("domain already defined...\n");
&gt;
&gt;            if (virDomainUndefine(dom))
&gt;
&gt;                 printf("...unable to undefine!!!\n");
&gt;
&gt;            else {
&gt;
&gt;                 printf("...undefined.");
&gt;
&gt;                 free(dom);
&gt;
&gt;            }
&gt;
&gt;      }

You're leaking a virDomainPtr here. Call virDomainFree(dom) before
overwriting the pointer with the result from virDomainDefineXML.

I think the leaked virDomainPtr causes the trouble you describe. So
fixing the leak will probably also fix the problem you see in the
second run.

&gt;      dom = virDomainDefineXML(virt, SOME_XML);
&gt;

Matthias

</body></email><email><emailId>20100901122749</emailId><senderName>Lucas Arbiza</senderName><senderEmail>lucas.arbiza@gmail.com</senderEmail><timestampReceived>2010-09-01 12:27:49-0400</timestampReceived><subject>Re: [libvirt-users] C, C++ or Python programming tutorial/manual/guide for libvirt</subject><body>

Thank you, Justin.

It's helping me a lot.

Thanks.
__

Lucas Arbiza

email: lucas.arbiza@gmail.com
celular: +55 (55) 9152 7561

&lt;http://br.linkedin.com/in/lucasarbiza&gt;
&lt;http://www.google.com/profiles/lucas.arbiza&gt;

[Attachment #3 (text/html)]

&lt;font color="#000000"&gt;&lt;font face="verdana,sans-serif"&gt;Thank you, \
Justin.&lt;/font&gt;&lt;/font&gt;&lt;div&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;It's helping me a lot.&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;

&lt;div&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;Thanks.&lt;br clear="all"&gt;&lt;/font&gt;&lt;/font&gt;__&lt;br&gt;&lt;br&gt;Lucas \
Arbiza&lt;br&gt;&lt;br&gt;email: &lt;a href="mailto:lucas.arbiza@gmail.com" \
target="_blank"&gt;lucas.arbiza@gmail.com&lt;/a&gt;&lt;br&gt;

celular: +55 (55) 9152 7561&lt;br&gt;&lt;br&gt;&lt;a href="http://br.linkedin.com/in/lucasarbiza" \
target="_blank"&gt;&lt;img \
src="http://lucasarbiza.com/wp-content/themes/Lucas/images/linkedin-profile.png"&gt;&lt;/a&gt; \
&lt;a href="http://www.google.com/profiles/lucas.arbiza" target="_blank"&gt;&lt;img \
src="http://lucasarbiza.com/wp-content/themes/Lucas/images/Google-profile.png"&gt;&lt;/a&gt;&lt;br&gt;



&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20100903113437</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-09-03 11:34:37-0400</timestampReceived><subject>Re: [libvirt-users] is libvirt java binding thread safe?</subject><body>

2010/9/3 Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;:
&gt; 2010/9/3 Daniel P. Berrange &lt;berrange@redhat.com&gt;:
&gt;&gt; On Fri, Sep 03, 2010 at 01:02:09PM +0200, Matthias Bolte wrote:
&gt;&gt;&gt; Ah, okay, now I understand what you want to say.
&gt;&gt;&gt;
&gt;&gt;&gt; You have two threads A and B. When A runs on its own then it's just
&gt;&gt;&gt; fine, but when you add B (that triggers an exception on purpose and
&gt;&gt;&gt; ignores it) then A picks it up and reports it. This is the point where
&gt;&gt;&gt; thread safety comes to mind.
&gt;&gt;&gt;
&gt;&gt;&gt; libvirt stores errors in thread-local-storage. It uses
&gt;&gt;&gt; pthread_key_create/pthread_{get,set}specific for this (or
&gt;&gt;&gt; TlsAlloc/Tls{Get,Set}Value on Windows).
&gt;&gt;&gt;
&gt;&gt;&gt; I think what's happening here is that all your threads in Java share
&gt;&gt;&gt; the same thread-local-storage. Therefore, thread A can pickup the
&gt;&gt;&gt; error triggered by thread B, that should not happen.
&gt;&gt;&gt;
&gt;&gt;&gt; I'm not sure how to fix that.
&gt;&gt;
&gt;&gt; Looking at the java code, I believe the problem is that the java
&gt;&gt; bindings are *not* using the threadsafe error APIs:
&gt;&gt;
&gt;&gt; In Connect.java
&gt;&gt;
&gt;&gt;    /**
&gt;&gt;     * call the error handling logic. Should be called after every libvirt call
&gt;&gt;     *
&gt;&gt;     * @throws LibvirtException
&gt;&gt;     */
&gt;&gt;    protected void processError() throws LibvirtException {
&gt;&gt;        ErrorHandler.processError(libvirt, VCP);
&gt;&gt;    }
&gt;&gt;
&gt;&gt; Which calls into
&gt;&gt;
&gt;&gt;    public static void processError(Libvirt libvirt, ConnectionPointer conn) throws LibvirtException {
&gt;&gt;        virError vError = new virError();
&gt;&gt;        int errorCode = libvirt.virConnCopyLastError(conn, vError);
&gt;&gt;
&gt;&gt; And virConnCopyLastError is *not* threadsafe:
&gt;&gt;
&gt;&gt;
&gt;&gt; /**
&gt;&gt;  * virConnCopyLastError:
&gt;&gt;  * @conn: pointer to the hypervisor connection
&gt;&gt;  * @to: target to receive the copy
&gt;&gt;  *
&gt;&gt;  * Copy the content of the last error caught on that connection
&gt;&gt;  *
&gt;&gt;  * This method is not protected against access from multiple
&gt;&gt;  * threads. In a multi-threaded application, always use the
&gt;&gt;  * global virGetLastError() API which is backed by thread
&gt;&gt;  * local storage.
&gt;&gt;
&gt;&gt; Regards,
&gt;&gt; Daniel
&gt;
&gt; Hm that might explain it, I'll check if that's the cause.
&gt;
&gt; Matthias
&gt;

Yes, that's the cause. Thanks for the hint :)

I send a patch to the list to fix this.

Matthias

</body></email><email><emailId>20100903165512</emailId><senderName>jeremy avnet</senderName><senderEmail>brainsik+libvirt@saucelabs.com</senderEmail><timestampReceived>2010-09-03 16:55:12-0400</timestampReceived><subject>[libvirt-users] Couple of libvirtd warnings</subject><body>

Hello, I recently upgraded to libvirt 0.8.3 and qemu 0.12.5 and I'm seeing
these messages in syslog:

libvirtd: 09:52:34.591: warning : virStorageBackendQEMUImgBackingFormat:623
: Unexpected exit status '1', qemu probably failed
libvirtd: 09:52:34.746: warning : qemudParsePCIDeviceStrs:1422 : Unexpected
exit status '1', qemu probably failed

I'm not having any problems, but I'd like to know what these mean.

Thanks!
.:. jeremy

[Attachment #3 (text/html)]

&lt;font face="verdana,sans-serif"&gt;Hello, I recently upgraded to libvirt 0.8.3 and qemu \
0.12.5 and I'm seeing these messages in syslog:&lt;/font&gt;&lt;div&gt;&lt;font \
face="verdana,sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face="verdana,sans-serif"&gt;&lt;div&gt; \
&lt;font class="Apple-style-span" face="'courier new', monospace"&gt;libvirtd: \
09:52:34.591: warning : virStorageBackendQEMUImgBackingFormat:623 : Unexpected exit \
status '1', qemu probably failed&lt;/font&gt;&lt;/div&gt;&lt;div&gt; &lt;font \
class="Apple-style-span" face="'courier new', monospace"&gt;libvirtd: \
09:52:34.746: warning : qemudParsePCIDeviceStrs:1422 : Unexpected exit status \
'1', qemu probably failed&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; I'm not having \
any problems, but I'd like to know what these \
mean.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks!&lt;/div&gt;&lt;div&gt;.:. jeremy&lt;/div&gt;&lt;/font&gt;&lt;/div&gt;



</body></email><email><emailId>20100906033939</emailId><senderName>Joel Miller</senderName><senderEmail>wzhou@redhat.com</senderEmail><timestampReceived>2010-09-06 03:39:39-0400</timestampReceived><subject>[libvirt-users] libvirt 0.8.3 rpm package for RHEL</subject><body>

  Hi List,

I've checked RHEL6 beta2, it's libvirt 0.8.1, but I need 0.8.3 to 
support vSphere 4.1, I know I can compile it by myself, but our Red 
Hat's customer wanna have "half official" rpm package for their test, 
anyone would help me to make rpm for RHEL5.5?

And, do we have any roadmap about libvirt 0.8.3 to be official rpm 
package in RHEL6?

Regards,
Joel

-- 
    Joel Graber Miller
Solution Architect
Greater China
Mobile: +86 134 0808 8141
E-mail: wzhou@redhat.com

</body></email><email><emailId>20100907015015</emailId><senderName></senderName><senderEmail>steven765@yahoo.com</senderEmail><timestampReceived>2010-09-07 01:50:15-0400</timestampReceived><subject>[libvirt-users] override DNS server address?</subject><body>

Is there a spot in the xml i'm not seeing to identify the network DNS server. Currently it's defaulting to a.b.c.1  I'm running my own though on a different address and can't find where to configure it in the xml schema or could I override it in DNSMASQ?
Thanks
Steve


      

</body></email><email><emailId>20100908121349</emailId><senderName>Zvi Dubitzky</senderName><senderEmail>dubi@il.ibm.com</senderEmail><timestampReceived>2010-09-08 12:13:49-0400</timestampReceived><subject>[libvirt-users] kqemu</subject><body>

Hi
we have a  Debian 64 bit system with qemu 0.9.1-10 ( uname -a  = 
2.6.26-2-amd64)  installed . kvm is included and loaded to memory .
Still when we create a VM  we sometimes get the following error message:

libvir: QEMU error : internal error unable to start guest: You do not have 
enough space in '/dev/shm' for the 499 MB of QEMU virtual RAM.
To have more space available provided you have enough RAM and swap, do as 
root:
mount -o remount,size=515m /dev/shm
Or disable the accelerator module with -no-kqemu


after we do the mount we can create the VM . Does that mean that kvm is 
not active because it seems that kqemu
is an old way to do the duties of kvm e.g supply memory to VMs via 
/dev/shm

thanks 

Zvi Dubitzky 
Email:dubi@il.ibm.com
IBM Haifa Research Laboratory    Phone: +972-4-8296182
Haifa, 31905, ISRAEL 


</body></email><email><emailId>20100908173654</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-09-08 17:36:54-0400</timestampReceived><subject>Re: [libvirt-users] Status of libvirtd on BSD/OSX?</subject><body>

2010/9/8 Daniel P. Berrange &lt;berrange@redhat.com&gt;:
&gt; On Wed, Sep 08, 2010 at 10:25:27AM -0700, Mitchell Hashimoto wrote:
&gt;&gt; Daniel,
&gt;&gt;
&gt;&gt; Thank you very much. Ah, I was under the impression that libvirtd was
&gt;&gt; required to control any hypervisors (local or remote). I'm purely interested
&gt;&gt; in local access to hypervisors right now. I'm sorry I admit that my next
&gt;&gt; question is not well researched, but I figured it would be a quick answer
&gt;&gt; from someone knowledgeable: Do you know the "./configure" flags off the top
&gt;&gt; of your head to disable libvirtd and only enable VirtualBox drivers?
&gt;
&gt; At the very least
&gt;
&gt;   configure
&gt;    --without-xen \
&gt;    --without-qemu \
&gt;    --without-lxc \
&gt;    --without-uml \
&gt;    --without-esx \
&gt;    --without-openvz \
&gt;    --without-one \
&gt;    --without-phyp \
&gt;    --without-netcf \
&gt;    --without-libvirtd
&gt;
&gt; Daniel

You should add --with-vbox, otherwise configure will disable the
VirtualBox driver if it can't find the VirtualBox XPCOMC library.

Matthias

</body></email><email><emailId>20100909200159</emailId><senderName>Brian Pitts</senderName><senderEmail>bdp@uga.edu</senderEmail><timestampReceived>2010-09-09 20:01:59-0400</timestampReceived><subject>[libvirt-users] Restarting iptables and libvirtd</subject><body>

Hi,

If I issue the commands

# service libvirtd stop
# service iptables stop
# service iptables start
# service libvirtd start

the iptables rules that enable NAT on my virtual networks are not
created when libvirtd is started, even though the networks are set to
autostart and 'virsh net-list' shows them as active. The rules are only
created if I run net-destroy and net-start.

Is this the expected behavior? I would have thought that restarting
libvirtd would ensure the necessary iptables rules are in place for
networks marked as autostart. I would also have though that net-list
would not show networks as active if the iptables rules needed for them
to work were not in place.

-- 
Brian Pitts
Systems Administrator | EuPathDB Bioinformatics Resource Center
706-542-1447 | bdp@uga.edu | http://eupathdb.org

</body></email><email><emailId>20100908165651</emailId><senderName>Mitchell Hashimoto</senderName><senderEmail>mitchell.hashimoto@gmail.com</senderEmail><timestampReceived>2010-09-08 16:56:51-0400</timestampReceived><subject>[libvirt-users] Status of libvirtd on BSD/OSX?</subject><body>

Hello,

I've done some research prior to this and the answer is clear that libvirtd
doesn't compile on BSD or OSX, but I'd like to know more details about this,
if I can have a bit of your time:

* Are there any current efforts to get libvirtd running on BSD?
* What are the blockers to getting it running?
* My main goal is really to, at first only control VirtualBox, so
KVM/Xen/etc is not an issue.

I realize that KVM and some other hypervisors obviously can't be supported
on BSD, but if I could just start by compiling libvirtd for VirtualBox on
BSD that would be a big win in and of itself.

Thanks,
Mitchell

[Attachment #3 (text/html)]

Hello,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I've done some research prior to this and the answer is \
clear that libvirtd doesn't compile on BSD or OSX, but I'd like to know more \
details about this, if I can have a bit of your time:&lt;/div&gt;

&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;* Are there any current efforts to get libvirtd running on \
BSD?&lt;/div&gt;&lt;div&gt;* What are the blockers to getting it running?&lt;/div&gt;&lt;div&gt;* My main \
goal is really to, at first only control VirtualBox, so KVM/Xen/etc is not an \
issue.&lt;/div&gt;

&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I realize that KVM and some other hypervisors obviously can't \
be supported on BSD, but if I could just start by compiling libvirtd for VirtualBox \
on BSD that would be a big win in and of itself.&lt;/div&gt;

&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;Mitchell&lt;/div&gt;



</body></email><email><emailId>20100908172246</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-09-08 17:22:46-0400</timestampReceived><subject>Re: [libvirt-users] Status of libvirtd on BSD/OSX?</subject><body>

On Wed, Sep 08, 2010 at 09:56:51AM -0700, Mitchell Hashimoto wrote:
&gt; Hello,
&gt; 
&gt; I've done some research prior to this and the answer is clear that libvirtd
&gt; doesn't compile on BSD or OSX, but I'd like to know more details about this,
&gt; if I can have a bit of your time:
&gt; 
&gt; * Are there any current efforts to get libvirtd running on BSD?
&gt; * What are the blockers to getting it running?
&gt; * My main goal is really to, at first only control VirtualBox, so
&gt; KVM/Xen/etc is not an issue.
&gt; 
&gt; I realize that KVM and some other hypervisors obviously can't be supported
&gt; on BSD, but if I could just start by compiling libvirtd for VirtualBox on
&gt; BSD that would be a big win in and of itself.

NB, virtualbox does not require libvirtd if you only care about local
access. If you want remote access, then obviously it would be needed.

There isn't any particular reason why libvirtd shouldn't work on any
UNIX based OS. If there are any Linux-isms in there, they're purely
accidental. The only platform where porting libvirtd will be hard
is Windows. Best to just enable libvirtd and then post details of the
compilation errors you get to the libvir-list mailing list

Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100908172527</emailId><senderName>Mitchell Hashimoto</senderName><senderEmail>mitchell.hashimoto@gmail.com</senderEmail><timestampReceived>2010-09-08 17:25:27-0400</timestampReceived><subject>Re: [libvirt-users] Status of libvirtd on BSD/OSX?</subject><body>

Daniel,

Thank you very much. Ah, I was under the impression that libvirtd was
required to control any hypervisors (local or remote). I'm purely interested
in local access to hypervisors right now. I'm sorry I admit that my next
question is not well researched, but I figured it would be a quick answer
from someone knowledgeable: Do you know the "./configure" flags off the top
of your head to disable libvirtd and only enable VirtualBox drivers?

I'll start giving this a shot as soon as I can.

Mitchell

On Wed, Sep 8, 2010 at 10:22 AM, Daniel P. Berrange &lt;berrange@redhat.com&gt;wrote:

&gt; On Wed, Sep 08, 2010 at 09:56:51AM -0700, Mitchell Hashimoto wrote:
&gt; &gt; Hello,
&gt; &gt;
&gt; &gt; I've done some research prior to this and the answer is clear that
&gt; libvirtd
&gt; &gt; doesn't compile on BSD or OSX, but I'd like to know more details about
&gt; this,
&gt; &gt; if I can have a bit of your time:
&gt; &gt;
&gt; &gt; * Are there any current efforts to get libvirtd running on BSD?
&gt; &gt; * What are the blockers to getting it running?
&gt; &gt; * My main goal is really to, at first only control VirtualBox, so
&gt; &gt; KVM/Xen/etc is not an issue.
&gt; &gt;
&gt; &gt; I realize that KVM and some other hypervisors obviously can't be
&gt; supported
&gt; &gt; on BSD, but if I could just start by compiling libvirtd for VirtualBox on
&gt; &gt; BSD that would be a big win in and of itself.
&gt;
&gt; NB, virtualbox does not require libvirtd if you only care about local
&gt; access. If you want remote access, then obviously it would be needed.
&gt;
&gt; There isn't any particular reason why libvirtd shouldn't work on any
&gt; UNIX based OS. If there are any Linux-isms in there, they're purely
&gt; accidental. The only platform where porting libvirtd will be hard
&gt; is Windows. Best to just enable libvirtd and then post details of the
&gt; compilation errors you get to the libvir-list mailing list
&gt;
&gt; Daniel
&gt; --
&gt; |: Red Hat, Engineering, London    -o-
&gt; http://people.redhat.com/berrange/ :|
&gt; |: http://libvirt.org -o- http://virt-manager.org -o-
&gt; http://deltacloud.org :|
&gt; |: http://autobuild.org        -o-
&gt; http://search.cpan.org/~danberr/ :|
&gt; |: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505
&gt; :|
&gt;

[Attachment #3 (text/html)]

Daniel,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thank you very much. Ah, I was under the impression that \
libvirtd was required to control any hypervisors (local or remote). I'm purely \
interested in local access to hypervisors right now. I'm sorry I admit that my \
next question is not well researched, but I figured it would be a quick answer from \
someone knowledgeable: Do you know the "./configure" flags off the top of \
your head to disable libvirtd and only enable VirtualBox drivers?&lt;/div&gt;

&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I'll start giving this a shot as soon as I \
can.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Mitchell&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Wed, \
Sep 8, 2010 at 10:22 AM, Daniel P. Berrange &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:berrange@redhat.com"&gt;berrange@redhat.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt;

&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;On Wed, Sep 08, 2010 at \
09:56:51AM -0700, Mitchell Hashimoto wrote:&lt;br&gt; &gt; Hello,&lt;br&gt;
&gt;&lt;br&gt;
&gt; I've done some research prior to this and the answer is clear that \
libvirtd&lt;br&gt; &gt; doesn't compile on BSD or OSX, but I'd like to know more \
details about this,&lt;br&gt; &gt; if I can have a bit of your time:&lt;br&gt;
&gt;&lt;br&gt;
&gt; * Are there any current efforts to get libvirtd running on BSD?&lt;br&gt;
&gt; * What are the blockers to getting it running?&lt;br&gt;
&gt; * My main goal is really to, at first only control VirtualBox, so&lt;br&gt;
&gt; KVM/Xen/etc is not an issue.&lt;br&gt;
&gt;&lt;br&gt;
&gt; I realize that KVM and some other hypervisors obviously can't be \
supported&lt;br&gt; &gt; on BSD, but if I could just start by compiling libvirtd for \
VirtualBox on&lt;br&gt; &gt; BSD that would be a big win in and of itself.&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;NB, virtualbox does not require libvirtd if you only care about local&lt;br&gt;
access. If you want remote access, then obviously it would be needed.&lt;br&gt;
&lt;br&gt;
There isn't any particular reason why libvirtd shouldn't work on any&lt;br&gt;
UNIX based OS. If there are any Linux-isms in there, they're purely&lt;br&gt;
accidental. The only platform where porting libvirtd will be hard&lt;br&gt;
is Windows. Best to just enable libvirtd and then post details of the&lt;br&gt;
compilation errors you get to the libvir-list mailing list&lt;br&gt;
&lt;br&gt;
Daniel&lt;br&gt;
&lt;font color="#888888"&gt;--&lt;br&gt;
&gt; &gt; Red Hat, Engineering, London    -o-   &lt;a \
&gt; &gt; href="http://people.redhat.com/berrange/" \
&gt; &gt; target="_blank"&gt;http://people.redhat.com/berrange/&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="http://libvirt.org" target="_blank"&gt;http://libvirt.org&lt;/a&gt; -o- &lt;a \
&gt; &gt; href="http://virt-manager.org" target="_blank"&gt;http://virt-manager.org&lt;/a&gt; -o- &lt;a \
&gt; &gt; href="http://deltacloud.org" target="_blank"&gt;http://deltacloud.org&lt;/a&gt; :|&lt;br&gt;


&gt; &gt; &lt;a href="http://autobuild.org" target="_blank"&gt;http://autobuild.org&lt;/a&gt;        \
&gt; &gt; -o-         &lt;a href="http://search.cpan.org/~danberr/" \
&gt; &gt; target="_blank"&gt;http://search.cpan.org/~danberr/&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|&lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20100908173010</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-09-08 17:30:10-0400</timestampReceived><subject>Re: [libvirt-users] Status of libvirtd on BSD/OSX?</subject><body>

On Wed, Sep 08, 2010 at 10:25:27AM -0700, Mitchell Hashimoto wrote:
&gt; Daniel,
&gt; 
&gt; Thank you very much. Ah, I was under the impression that libvirtd was
&gt; required to control any hypervisors (local or remote). I'm purely interested
&gt; in local access to hypervisors right now. I'm sorry I admit that my next
&gt; question is not well researched, but I figured it would be a quick answer
&gt; from someone knowledgeable: Do you know the "./configure" flags off the top
&gt; of your head to disable libvirtd and only enable VirtualBox drivers?

At the very least

   configure
    --without-xen \
    --without-qemu \
    --without-lxc \
    --without-uml \
    --without-esx \
    --without-openvz \
    --without-one \
    --without-phyp \
    --without-netcf \
    --without-libvirtd

Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100601152543</emailId><senderName>James Hogarth</senderName><senderEmail>james.hogarth@gmail.com</senderEmail><timestampReceived>2010-06-01 15:25:43-0400</timestampReceived><subject>Re: [libvirt-users] Java Bindings against RHEL5.5 KVM</subject><body>

On 1 June 2010 13:49, James Hogarth &lt;james.hogarth@gmail.com&gt; wrote:
&gt; Hi all,
&gt;
&gt; I'm doing some dev work against the native RHEL/centos 5.5 KVM
&gt; installation for maintenance, creation and deletion of virtual guests
&gt; using the libvirt API vai the java bindings from a java based web app.
&gt;
&gt; Things in general seem to be working - I can connect to and query the
&gt; kvm instance using the libvirt interface and get a list of guests,
&gt; pull information about them and stop/start/restart guests.
&gt;
&gt; I'm hitting a bit of an issue with creation of a guest however....
&gt;
&gt; When calling domainDefineXML with XML following the domain XML
&gt; specification (with the XML as per a dumpxml on the relevant box) I
&gt; get an error creating the guest of:
&gt;
&gt; "internal error unknown lifecycle action restart "
&gt;
&gt; The virsh version information for the host is:
&gt;
&gt; Compiled against library: libvir 0.6.3
&gt; Using library: libvir 0.6.3
&gt; Using API: QEMU 0.6.3
&gt; Running hypervisor: QEMU 0.10.5
&gt;
&gt;
&gt; I have tried this against my ubuntu system as well with the same error
&gt; - that has version:
&gt;
&gt; Compiled against library: libvir 0.7.5
&gt; Using library: libvir 0.7.5
&gt; Using API: QEMU 0.7.5
&gt; Running hypervisor: QEMU 0.12.3
&gt;
&gt; I'm currently using jna 3.2.5 with libvirt 0.4.5 bindings.
&gt;
&gt; The example XML being used is:
&gt;
&gt; &lt;domain type="kvm"&gt;
&gt;  &lt;name&gt;
&gt;    newguestfomwebapp
&gt;  &lt;/name&gt;
&gt;  &lt;memory&gt;
&gt;    512
&gt;  &lt;/memory&gt;
&gt;  &lt;vcpu&gt;
&gt;    1
&gt;  &lt;/vcpu&gt;
&gt;  &lt;os&gt;
&gt;    &lt;type arch="x86_64" machine="rhel5.4.0"&gt;
&gt;      hvm
&gt;    &lt;/type&gt;
&gt;    &lt;boot dev="hd"/&gt;
&gt;  &lt;/os&gt;
&gt;  &lt;features&gt;
&gt;    &lt;acpi/&gt;
&gt;    &lt;apic/&gt;
&gt;    &lt;pae/&gt;
&gt;  &lt;/features&gt;
&gt;  &lt;clock offset="utc"/&gt;
&gt;  &lt;on_poweroff&gt;
&gt;    destroy
&gt;  &lt;/on_poweroff&gt;
&gt;  &lt;on_reboot&gt;
&gt;    restart
&gt;  &lt;/on_reboot&gt;
&gt;  &lt;on_crash&gt;
&gt;    restart
&gt;  &lt;/on_crash&gt;
&gt;  &lt;devices&gt;
&gt;    &lt;emulator&gt;
&gt;      /usr/libexec/qemu-kvm
&gt;    &lt;/emulator&gt;
&gt;    &lt;disk type="file" device="cdrom"&gt;
&gt;      &lt;driver name="qemu" type="raw"/&gt;
&gt;      &lt;source file="/var/lib/libvirt/images/ISOs/centos5.5-ks.iso"/&gt;
&gt;      &lt;target dev="hdc" bus="ide"/&gt;
&gt;      &lt;readonly/&gt;
&gt;    &lt;/disk&gt;
&gt;    &lt;interface type="network"&gt;
&gt;      &lt;source network="default"/&gt;
&gt;      &lt;model type="virtio"/&gt;
&gt;    &lt;/interface&gt;
&gt;    &lt;input type="mouse" bus="ps2"/&gt;
&gt;    &lt;graphics type="vnc" port="-1" autoport="yes"/&gt;
&gt;  &lt;/devices&gt;
&gt; &lt;/domain&gt;
&gt;
&gt; If I remove the lifecycle information from the xml I get:
&gt;
&gt; "unknown OS type hvm "
&gt;
&gt; The xml works from the command line with virsh define ...
&gt;
&gt; Anyone seen anything similar or have any ideas?
&gt;
&gt; Regards,
&gt;
&gt; James
&gt;

For the record.... I managed to get this to work in the end and it
appeared to be down to the whitespace.... creating a string
representation of the XML DOM that looked like:

&lt;domain type="kvm"&gt;
  &lt;name&gt;testserver2002&lt;/name&gt;
  &lt;memory&gt;512&lt;/memory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch="x86_64" machine="pc-0.11"&gt;hvm&lt;/type&gt;
    &lt;boot dev="hd"/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
    &lt;apic/&gt;
    &lt;pae/&gt;
  &lt;/features&gt;
  &lt;clock offset="utc"/&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/libexec/qemu-kvm&lt;/emulator&gt;
    &lt;disk type="file" device="cdrom"&gt;
      &lt;driver name="qemu" type="raw"/&gt;
      &lt;source file="/var/lib/libvirt/images/ISOs/centos5.5-ks.iso"/&gt;
      &lt;target dev="hdc" bus="ide"/&gt;
      &lt;readonly/&gt;
    &lt;/disk&gt;
    &lt;interface type="network"&gt;
      &lt;source network="default"/&gt;
      &lt;model type="virtio"/&gt;
    &lt;/interface&gt;
    &lt;input type="mouse" bus="ps2"/&gt;
    &lt;graphics type="vnc" port="-1" autoport="yes"/&gt;
  &lt;/devices&gt;
&lt;/domain&gt;

Allowed the domain to be created....

James

</body></email><email><emailId>20100601155225</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-06-01 15:52:25-0400</timestampReceived><subject>Re: [libvirt-users] virsh reset option</subject><body>

On 05/31/2010 04:01 AM, udo1 wrote:
&gt; Hi everybody,
&gt; 
&gt; I have one more question but virsh related:
&gt; Is there a reset equivalent option in virsh, like system_reset in QEMU 
&gt; monitor? In the help list I do not see it.
&gt; 

No, libvirt doesn't have a reset API, so you there is currently know way
to invoke system_reset via virsh.

- Cole

</body></email><email><emailId>20100601160729</emailId><senderName>Christian Hermann</senderName><senderEmail>c.hermann@bitbeans.de</senderEmail><timestampReceived>2010-06-01 16:07:29-0400</timestampReceived><subject>[libvirt-users] FailOver IP</subject><body>

hi guys!
i`am new to libvirt and i want using kvm with a ipv4 failover 
ip-address. so this addres has the netmask 255.255.255.255.
this ip is directly bind to my root server by my provider. so i can not 
use it on an other server.
can you tell me how i can use this ip address on a kvm virtual maschine, 
build with libvirt?


Kind regards,

Chris

</body></email><email><emailId>20100601161420</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-06-01 16:14:20-0400</timestampReceived><subject>Re: [libvirt-users] Monitoring KVM Machine Uptimes</subject><body>

On 05/31/2010 10:16 AM, Karsten Knese wrote:
&gt; Hey folks.
&gt; 
&gt; Currently, I am working on an accounting-solution for Private Cloud with 
&gt; Eucalyptus as my bachelor-thesis. Eucalyptus bases on libvirt providing 
&gt; the KVM machines. Part of the thesis is kind of measurement for the 
&gt; uptimes of each instance in the cloud.
&gt; 
&gt; As Eucalyptus is based on libvirt, i want to know if there is kind of 
&gt; tool already setup for monitoring a vm in terms of uptimes, cputimes and 
&gt; disk i/o.

Disk I/O and cpu time is reported by libvirt. See 'virsh domblkstat' and
'virsh dominfo' respectively. Uptime isn't explicitly listed by libvirt,
but you can get a sorta uptime by just watching virsh domid output and
making sure the domain ID doesn't change.

- Cole

</body></email><email><emailId>20100601162918</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-06-01 16:29:18-0400</timestampReceived><subject>Re: [libvirt-users] Qemu driver not supporting	VIR_DOMAIN_DEVICE_MODIFY_CONFIG yet?</subject><body>

On 05/31/2010 11:52 AM, Guido Winkelmann wrote:
&gt; Hi,
&gt; 
&gt; According to the docs on
&gt; http://libvirt.org/html/libvirt-libvirt.html#virDomainDetachDeviceFlags
&gt; I ought to be able to do
&gt; 
&gt; virDomainDetachDeviceFlags(
&gt; 	&lt;domain&gt;,
&gt; 	&lt;devicexml&gt;,
&gt; 	VIR_DOMAIN_DEVICE_MODIFY_LIVE | VIR_DOMAIN_DEVICE_MODIFY_CONFIG);
&gt; 
&gt; to detach a volume both from a currently running VM instance and permanently 
&gt; from the defined config file.
&gt; 
&gt; If I actually try that, though, I'm getting this error:
&gt; 
&gt; libvir: QEMU error : Requested operation is not valid: cannot modify the 
&gt; persistent configuration of a domain
&gt; 
&gt; The same thing happens whether or not the domain is running and also happens 
&gt; if I leave out the "VIR_DOMAIN_DEVICE_MODIFY_LIVE" part.
&gt; 
&gt; Does the qemu driver simply not support VIR_DOMAIN_DEVICE_MODIFY_CONFIG yet 
&gt; (libvirt 0.8.1), or is there some other problem here?
&gt; 

Sounds like you are doing things right, this just isn't implemented for
the qemu driver yet. To make a persistent change, you will have to edit
the domain XML, remove the device, and redefine the domain.

- Cole

</body></email><email><emailId>20100601185822</emailId><senderName>Andreas Ntaflos</senderName><senderEmail>daff@pseudoterminal.org</senderEmail><timestampReceived>2010-06-01 18:58:22-0400</timestampReceived><subject>Re: [libvirt-users] Host should not touch passed-through USB device, how?</subject><body>


On Tuesday 01 June 2010 19:42:55 Daniel P. Berrange wrote:
&gt; &gt; &gt; So I am looking for a way to make sure the host passes through
&gt; &gt; &gt; the USB device (in its entirety) without trying to touch it and
&gt; &gt; &gt; claim it as its own. Preferably without disabling the USB
&gt; &gt; &gt; storage subsystem completely on the host.
&gt; &gt; &gt; 
&gt; &gt; &gt; Any ideas? Is there a best practice for such things in the
&gt; &gt; &gt; Libvirt world? Or any other world?
&gt; &gt; 
&gt; &gt; For PCI devices, libvirt automatically performs a device reset and
&gt; &gt; some other voodoo to make sure the host doesn't try to use the
&gt; &gt; device. Maybe there is something similar that libvirt can do for
&gt; &gt; USB devices as well? I'm not very knowledgable about that stuff so
&gt; &gt; I can't say for certain.
&gt; 
&gt; Yes there is the same. We need to finish implementing identical
&gt; infrastructure to that used for PCI devices. We need to do resets
&gt; and bind/unbind host device drivers, and implement the so called
&gt; 'managed' mode.

Hi, 

thanks to both of you for your replies!

Great to know you guys are working on it, but just to be clear: at the 
moment Libvirt does not yet see to it that USB devices are unbound from 
their drivers on the host?

Do you have any idea how I could perform the necessary steps by myself 
so that my particular USB GSM modem is unbound from and not accessed by 
the host? I am not very familiar with USB device and driver management 
these days; it has just gotten too easy: plug the device in and wait for 
the desktop environment to do something :)

Thanks again, 

Andreas
-- 
Andreas Ntaflos
Vienna, Austria

GPG Fingerprint: 6234 2E8E 5C81 C6CB E5EC  7E65 397C E2A8 090C A9B4

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20100601164905</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-06-01 16:49:05-0400</timestampReceived><subject>Re: [libvirt-users] Host should not touch passed-through USB device, how?</subject><body>

On 05/28/2010 02:09 PM, Andreas Ntaflos wrote:
&gt; Hello list, 
&gt; 
&gt; this may be off topic but it is closely related to my Libvirt adventures 
&gt; so maybe you can help me.
&gt; 
&gt; I want to pass a USB device (a USB Huawei E620 modem) through to a KVM 
&gt; guest. Pass-through in general works fine and the modem is visible in 
&gt; the guest. However, the host still sees it and sometimes tries to access 
&gt; it (such modems seem to also be USB storage devices). This naturally 
&gt; leads to conflicts and I believe this crashed the guest very badly 
&gt; yesterday.
&gt; 
&gt; So I am looking for a way to make sure the host passes through the USB 
&gt; device (in its entirety) without trying to touch it and claim it as its 
&gt; own. Preferably without disabling the USB storage subsystem completely 
&gt; on the host.
&gt; 
&gt; Any ideas? Is there a best practice for such things in the Libvirt 
&gt; world? Or any other world? 
&gt; 

For PCI devices, libvirt automatically performs a device reset and some
other voodoo to make sure the host doesn't try to use the device. Maybe
there is something similar that libvirt can do for USB devices as well?
I'm not very knowledgable about that stuff so I can't say for certain.

- Cole

</body></email><email><emailId>20100601174255</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-06-01 17:42:55-0400</timestampReceived><subject>Re: [libvirt-users] Host should not touch passed-through USB device, how?</subject><body>

On Tue, Jun 01, 2010 at 12:49:05PM -0400, Cole Robinson wrote:
&gt; On 05/28/2010 02:09 PM, Andreas Ntaflos wrote:
&gt; &gt; Hello list, 
&gt; &gt; 
&gt; &gt; this may be off topic but it is closely related to my Libvirt adventures 
&gt; &gt; so maybe you can help me.
&gt; &gt; 
&gt; &gt; I want to pass a USB device (a USB Huawei E620 modem) through to a KVM 
&gt; &gt; guest. Pass-through in general works fine and the modem is visible in 
&gt; &gt; the guest. However, the host still sees it and sometimes tries to access 
&gt; &gt; it (such modems seem to also be USB storage devices). This naturally 
&gt; &gt; leads to conflicts and I believe this crashed the guest very badly 
&gt; &gt; yesterday.
&gt; &gt; 
&gt; &gt; So I am looking for a way to make sure the host passes through the USB 
&gt; &gt; device (in its entirety) without trying to touch it and claim it as its 
&gt; &gt; own. Preferably without disabling the USB storage subsystem completely 
&gt; &gt; on the host.
&gt; &gt; 
&gt; &gt; Any ideas? Is there a best practice for such things in the Libvirt 
&gt; &gt; world? Or any other world? 
&gt; &gt; 
&gt; 
&gt; For PCI devices, libvirt automatically performs a device reset and some
&gt; other voodoo to make sure the host doesn't try to use the device. Maybe
&gt; there is something similar that libvirt can do for USB devices as well?
&gt; I'm not very knowledgable about that stuff so I can't say for certain.

Yes there is the same. We need to finish implementing identical infrastructure
to that used for PCI devices. We need to do resets and bind/unbind host device
drivers, and implement the so called 'managed' mode.

Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100601163510</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-06-01 16:35:10-0400</timestampReceived><subject>Re: [libvirt-users] Mount options for fs type storage pools?</subject><body>

On 05/31/2010 09:54 AM, Justin Clift wrote:
&gt; Hi all,
&gt; 
&gt; Presently writing up "Storage Pool" docs for the Fedora Virtualisation 
&gt; Guide.  (using both virsh and virt-manager)
&gt; 
&gt; Having trouble finding out how to specify mount options for fs type 
&gt; storage pools.
&gt; 
&gt; For example:
&gt; 
&gt;    # virsh pool-define-as guest_images_fs fs - - /dev/sdc1 - "/guest_images"
&gt;    Pool guest_images_fs defined
&gt; 
&gt;    # virsh pool-build guest_images_fs
&gt;    Pool guest_images_fs built
&gt; 
&gt;    # virsh pool-start guest_images_fs
&gt;    Pool guest_images_fs started
&gt; 
&gt;    # mount | grep guest_images
&gt;    /dev/sdc1 on /guest_images type ext4 (rw)
&gt;    #
&gt; 
&gt; Notice that /guest_images is mounted with default options.  Nothing 
&gt; wrong with that, but lets say the SysAdmin has a need to pass specific 
&gt; mount options.  (ie journal_checksum, or noatime, or nodiratime, etc)
&gt; 
&gt; Checked the virStorageBackendFileSystemMount() function in present git 
&gt; master, and it doesn't look like mount options are considered for 
&gt; anything other than Gluster?
&gt; 
&gt; How to do it, or is it best to not use libvirt to manage the mounting of 
&gt; this type of storage when options are needed?
&gt; 

Can't find the email thread, but I believe this has been explicitly
rejected in the past. Allowing arbitrary option passthrough could
conflict with a future libvirt version if we alter the mount command
line, among other supportability reasons (though we have backtracked a
bit on that stance WRT the qemu emulator command line, but there is much
more at stake in that case).

If users need special mount options, their best option is to manually
configure the mount, then create a directory pool pointing at the mount dir.

- Cole

</body></email><email><emailId>20100602024711</emailId><senderName>Camilo Aguilar</senderName><senderEmail>camilo@cloudescape.com</senderEmail><timestampReceived>2010-06-02 02:47:11-0400</timestampReceived><subject>[libvirt-users] JSON support</subject><body>

Are there any efforts to support JSON in libvirt ?

[Attachment #3 (text/html)]

Are there any efforts to support JSON in libvirt ? &lt;br&gt;


</body></email><email><emailId>20100603015744</emailId><senderName></senderName><senderEmail>wenche_chang@trend.com.tw</senderEmail><timestampReceived>2010-06-03 01:57:44-0400</timestampReceived><subject>[libvirt-users] Virsh blkstat doesn't work on Xen HVM</subject><body>

Hi 

 

I tried to use virsh blkstat to get information of a block, but it returns an error \
message as shown below

This function works fine in KVM, but fail in XEN.

I tried XEN 3.4.3 ,4.0.0 and 4.0.1 with libvirt 0.7.1 from fedora yum server and \
0.8.1 from libvirt .

All of them are fail to get the block status.

The following is the config file and error message of virsh domblkstat.

Any one knows how to make this function work?

 

[root@localhost ~]# virsh dumpxml vm1

&lt;domain type='xen' id='1'&gt;

  &lt;name&gt;vm1&lt;/name&gt;

  &lt;uuid&gt;12af1ed4-2f2d-f02d-9a2a-5d4f377889d5&lt;/uuid&gt;

  &lt;memory&gt;524288&lt;/memory&gt;

  &lt;currentMemory&gt;524288&lt;/currentMemory&gt;

  &lt;vcpu&gt;1&lt;/vcpu&gt;

  &lt;os&gt;

    &lt;type&gt;hvm&lt;/type&gt;

    &lt;loader&gt;/usr/lib/xen/boot/hvmloader&lt;/loader&gt;

    &lt;boot dev='hd'/&gt;

  &lt;/os&gt;

  &lt;features&gt;

    &lt;acpi/&gt;

    &lt;apic/&gt;

    &lt;pae/&gt;

  &lt;/features&gt;

  &lt;clock offset='utc'/&gt;

  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;

  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;

  &lt;on_crash&gt;restart&lt;/on_crash&gt;

  &lt;devices&gt;

    &lt;emulator&gt;/usr/lib64/xen/bin/qemu-dm&lt;/emulator&gt;

    &lt;disk type='file' device='disk'&gt;

      &lt;driver name='file'/&gt;

      &lt;source file='/var/lib/libvirt/images/vm1.img'/&gt;

      &lt;target dev='hda' bus='ide'/&gt;

    &lt;/disk&gt;

    &lt;disk type='file' device='cdrom'&gt;

      &lt;target dev='hdc' bus='ide'/&gt;

      &lt;readonly/&gt;

    &lt;/disk&gt;

    &lt;interface type='bridge'&gt;

      &lt;mac address='00:16:36:0f:fb:7a'/&gt;

      &lt;source bridge='eth0'/&gt;

      &lt;script path='/etc/xen/scripts/vif-bridge'/&gt;

      &lt;target dev='vif1.0'/&gt;

    &lt;/interface&gt;

    &lt;serial type='pty'&gt;

      &lt;source path='/dev/pts/0'/&gt;

      &lt;target port='0'/&gt;

    &lt;/serial&gt;

    &lt;console type='pty' tty='/dev/pts/0'&gt;

      &lt;source path='/dev/pts/0'/&gt;

      &lt;target port='0'/&gt;

    &lt;/console&gt;

    &lt;input type='mouse' bus='ps2'/&gt;

    &lt;graphics type='vnc' port='5900' autoport='yes' keymap='en-us'/&gt;

    &lt;sound model='es1370'/&gt;

  &lt;/devices&gt;

&lt;/domain&gt;

 

[root@localhost ~]# virsh domblkstat vm1 hda

error: Failed to get block stats vm1 hda

error: internal error read_bd_stats: Failed to read any block statistics

 

TREND MICRO EMAIL NOTICE
The information contained in this email and any attachments is confidential and may \
be subject to copyright or other intellectual property protection. If you are not the \
intended recipient, you are not authorized to use or disclose this information, and \
we request that you notify us by reply mail or telephone and delete the original \
message from your mail system.

TREND MICRO EMAIL NOTICE
The information contained in this email and any attachments is confidential and may \
be subject to copyright or other intellectual property protection. If you are not the \
intended recipient, you are not authorized to use or disclose this information, and \
we request that you notify us by reply mail or telephone and delete the original \
message from your mail system.


[Attachment #3 (text/html)]

&lt;html xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:st1="urn:schemas-microsoft-com:office:smarttags" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 11 (filtered medium)"&gt;
&lt;o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="chsdate"/&gt;
&lt;o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="chmetcnv"/&gt;
&lt;!--[if !mso]&gt;
&lt;style&gt;
st1\:*{behavior:url(#default#ieooui) }
&lt;/style&gt;
&lt;![endif]--&gt;
&lt;style&gt;
&lt;!--@font-face
	{
	
	}
@font-face
	{font-family:"\@&amp;\#26032\;&amp;\#32048\;&amp;\#26126\;&amp;\#39636\;";}

 /* Font Definitions */
 @font-face
	{font-family:\65B0\7D30\660E\9AD4;
	panose-1:2 2 3 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@\65B0\7D30\660E\9AD4";
	panose-1:2 2 3 0 0 0 0 0 0 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal;
	font-family:Arial;
	color:windowtext;}
span.EmailStyle18
	{mso-style-type:personal-reply;
	font-family:Arial;
	color:navy;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	layout-grid:18.0pt;}
div.Section1
	{page:Section1;}
--&gt;
&lt;/style&gt;

&lt;/head&gt;

&lt;body lang=ZH-TW link=blue vlink=purple style='text-justify-trim:punctuation'&gt;

&lt;div class=Section1 style='layout-grid:18.0pt'&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;Hi &lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;I tried to use virsh blkstat to get information of a
block, but it returns an error message as shown below&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;This function works fine in KVM, but fail in \
XEN.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;I tried XEN &lt;st1:chsdate IsROCDate="False"
IsLunarDate="False" Day="30" Month="12" Year="1899" w:st="on"&gt;3.4.3&lt;/st1:chsdate&gt;
,4.0.0 and 4.0.1 with libvirt 0.7.1 from fedora yum server and 0.8.1 from
libvirt .&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;All of them are fail to get the block \
status.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;The following is the config file and error message of
virsh domblkstat.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;Any one knows how to make this function \
work?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;[root@localhost ~]# virsh dumpxml \
vm1&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;&lt;domain type='xen' \
id='1'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; \
&lt;name&gt;vm1&lt;/name&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;uuid&gt;12af1ed4&lt;st1:chmetcnv TCSC="0"
NumberType="1" Negative="True" HasSpace="False" SourceValue="2" UnitName="F"
w:st="on"&gt;-2f&lt;/st1:chmetcnv&gt;2d-f02d&lt;st1:chmetcnv TCSC="0" NumberType="1"
Negative="True" HasSpace="False" SourceValue="9" UnitName="a" \
w:st="on"&gt;-9a&lt;/st1:chmetcnv&gt;&lt;st1:chmetcnv TCSC="0" NumberType="1" Negative="False" \
HasSpace="False" SourceValue="2" UnitName="a" \
w:st="on"&gt;2a&lt;/st1:chmetcnv&gt;-5d&lt;st1:chmetcnv TCSC="0" NumberType="1" Negative="False" \
HasSpace="False" SourceValue="4" UnitName="F" \
w:st="on"&gt;4f&lt;/st1:chmetcnv&gt;377889d5&lt;/uuid&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; \
&lt;memory&gt;524288&lt;/memory&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;
&lt;currentMemory&gt;524288&lt;/currentMemory&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; \
&lt;vcpu&gt;1&lt;/vcpu&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;os&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; \
&lt;type&gt;hvm&lt;/type&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; \
&lt;loader&gt;/usr/lib/xen/boot/hvmloader&lt;/loader&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;boot \
dev='hd'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;/os&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;features&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; \
&lt;acpi/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; \
&lt;apic/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;pae/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;/features&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;clock \
offset='utc'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; \
&lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; \
&lt;on_reboot&gt;restart&lt;/on_reboot&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; \
&lt;on_crash&gt;restart&lt;/on_crash&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;devices&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;
&lt;emulator&gt;/usr/lib64/xen/bin/qemu-dm&lt;/emulator&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;disk type='file'
device='disk'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;driver
name='file'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;source
file='/var/lib/libvirt/images/vm1.img'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;target dev='hda'
bus='ide'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; \
&lt;/disk&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;disk type='file' \
device='cdrom'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;target dev='hdc'
bus='ide'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; \
&lt;readonly/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; \
&lt;/disk&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;interface \
type='bridge'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;mac
address='00:16:36:&lt;st1:chmetcnv TCSC="0" NumberType="1" Negative="False"
HasSpace="False" SourceValue="0" UnitName="F" \
w:st="on"&gt;0f&lt;/st1:chmetcnv&gt;:fb:&lt;st1:chmetcnv TCSC="0" NumberType="1" Negative="False" \
HasSpace="False" SourceValue="7" UnitName="a" \
w:st="on"&gt;7a&lt;/st1:chmetcnv&gt;'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;source
bridge='eth0'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;script
path='/etc/xen/scripts/vif-bridge'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;target
dev='vif1.0'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; \
&lt;/interface&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;serial \
type='pty'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;source
path='/dev/pts/0'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;target
port='0'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; \
&lt;/serial&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;console type='pty'
tty='/dev/pts/0'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;source
path='/dev/pts/0'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;target
port='0'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; \
&lt;/console&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;input type='mouse' \
bus='ps2'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;graphics type='vnc' port='5900'
autoport='yes' keymap='en-us'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;sound \
model='es1370'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt; &lt;/devices&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;&lt;/domain&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;[root@localhost ~]# virsh domblkstat vm1 \
hda&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;error: Failed to get block stats vm1 \
hda&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;error: internal error read_bd_stats: Failed to read
any block statistics&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;font size=1 face=Arial&gt;&lt;span lang=EN-US style='font-size:
9.0pt;font-family:Arial'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;
&lt;table&gt;&lt;tr&gt;&lt;td bgcolor=#ffffff&gt;&lt;font color=#000000&gt;&lt;pre&gt;TREND MICRO EMAIL NOTICE
The information contained in this email and any attachments is confidential and may \
be subject to copyright or other intellectual property protection. If you are not the \
intended recipient, you are not authorized to use or disclose this information, and \
we request that you notify us by reply mail or telephone and delete the original \
message from your mail system.&lt;/pre&gt;&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt; &lt;table&gt;&lt;tr&gt;&lt;td \
bgcolor=#ffffff&gt;&lt;font color=#000000&gt;&lt;pre&gt;TREND MICRO EMAIL NOTICE The information \
contained in this email and any attachments is confidential and may be subject to \
copyright or other intellectual property protection. If you are not the intended \
recipient, you are not authorized to use or disclose this information, and we request \
that you notify us by reply mail or telephone and delete the original message from \
your mail system.&lt;/pre&gt;&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;



</body></email><email><emailId>20100601150643</emailId><senderName>marwen marwen</senderName><senderEmail>marwen.ensi@gmail.com</senderEmail><timestampReceived>2010-06-01 15:06:43-0400</timestampReceived><subject>[libvirt-users] libvirt with opennebula</subject><body>

hello
I'm currently using libvirt and opennebula. I have installed the libvirt
with the driver of opennebule "ONE" and I test the installation.

/********************************************************/
oneadmin@node016 ~]$ virsh -c one:///
Welcome to virsh, the virtualization interactive terminal.

Type:  'help' for help with commands
       'quit' to quit

virsh # list
 Id Name                 State
----------------------------------

virsh #
/********************************************************/


but I can not see the list of machines that run in the cluster node (Xen and
KVM)
I want to know if this is a problem of configuration files ( libvirtd.conf and
oned.conf).
can you help me to overcome this problem

thank you

[Attachment #3 (text/html)]

&lt;span id="result_box" class="long_text"&gt;&lt;span title=""&gt;hello&lt;br&gt;&lt;/span&gt;&lt;span \
style="background-color: rgb(255, 255, 255);" title=""&gt;I'm currently using \
libvirt and opennebula. &lt;/span&gt;&lt;span style="background-color: rgb(255, 255, 255);" \
title=""&gt;I have installed the libvirt with the driver of opennebule "ONE" \
and I test the installation.&lt;br&gt; \
&lt;br&gt;&lt;/span&gt;&lt;/span&gt;/********************************************************/&lt;br&gt;oneadmin@node016 \
~]$ virsh -c one:///&lt;br&gt; Welcome to virsh, the virtualization interactive \
terminal.&lt;br&gt; &lt;br&gt;
Type:  'help' for help with commands&lt;br&gt;
       'quit' to quit&lt;br&gt;
&lt;br&gt;
virsh # list&lt;br&gt;
 Id Name                 State&lt;br&gt;
----------------------------------&lt;br&gt;
&lt;br&gt;
virsh # &lt;br&gt;
/********************************************************/&lt;br&gt;&lt;span id="result_box" \
class="long_text"&gt;&lt;span style="background-color: rgb(255, 255, 255);" \
title=""&gt;&lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;span style="background-color: rgb(255, 255, 255);" \
title=""&gt;but I can not see the list of machines that run in the cluster node (Xen and \
KVM)&lt;br&gt; &lt;/span&gt;&lt;span style="background-color: rgb(255, 255, 255);" title=""&gt;I want \
to know if this is a problem of configuration files ( libvirtd.conf \
&lt;/span&gt;&lt;/span&gt;&lt;span id="result_box" class="long_text"&gt;&lt;span style="background-color: \
rgb(255, 255, 255);" title=""&gt;and &lt;/span&gt;&lt;/span&gt;&lt;span id="result_box" \
class="long_text"&gt;&lt;span style="background-color: rgb(255, 255, 255);" \
title=""&gt;oned.conf).&lt;br&gt; &lt;/span&gt;&lt;span style="" title=""&gt;can you help me to overcome \
this problem&lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;span title=""&gt;thank you&lt;/span&gt;&lt;/span&gt;&lt;br&gt;



</body></email><email><emailId>20100601030914</emailId><senderName>Richard Walker</senderName><senderEmail>walkerrichardj@gmail.com</senderEmail><timestampReceived>2010-06-01 03:09:14-0400</timestampReceived><subject>[libvirt-users] Dual-boot and also use raw disk in virtual machine</subject><body>

I've got a new computer with two SATA disks.
I installed a minimal Fedora 13 64-bit on the first disk.
I shut down the computer, unplugged the first disk,
booted up and installed Windows 7 on the second disk.
Then I shut down, and plugged the first disk back in.
I added a grub option to boot Windows from the second disk.
All fine so far - I had a working dual boot system.

Then in F13 using virt-manager I created a virtual machine using the second
disk as a raw disk.  Well, the only option I had (using
virt-manager, at least) was to configure it as an IDE disk.
Booting this virtual machine gets as far as "Starting Windows",
and the animation appears (a dot or two), and then BSOD.
Running the Windows diagnosis didn't help.

I gave up.  Then, keeping the same virtual machine configuration,
I installed Windows 7 again into the virtual machine.
I shut down the computer and booted from the second disk.
Saw "Starting Windows", and the animation got a bit further,
but got a BSOD again.

Now running sfdisk -l /dev/sdb in the F13 host shows:

Disk /dev/sdb: 121601 cylinders, 255 heads, 63 sectors/track
Units = cylinders of 8225280 bytes, blocks of 1024 bytes, counting from 0

   Device Boot Start     End   #cyls    #blocks   Id  System
/dev/sdb1   *      0+     12-     13-    102400    7  HPFS/NTFS
                start: (c,h,s) expected (0,32,33) found (2,0,33)
                end: (c,h,s) expected (12,223,19) found (205,3,19)
/dev/sdb2         12+ 121601- 121589- 976657408    7  HPFS/NTFS
                start: (c,h,s) expected (12,223,20) found (205,3,20)
                end: (c,h,s) expected (1023,254,63) found (1023,15,63)
/dev/sdb3          0       -       0          0    0  Empty
/dev/sdb4          0       -       0          0    0  Empty

So there is some obvious disagreement about the
partition table.

Am I going to be able to get this to work?

</body></email><email><emailId>20100608045904</emailId><senderName>Arthur Pemberton</senderName><senderEmail>pemboa@gmail.com</senderEmail><timestampReceived>2010-06-08 04:59:04-0400</timestampReceived><subject>[libvirt-users] Best practices on backingup/restore VMs</subject><body>

I just moved from F11 to F13 and I'm find no information on the best
way to restore VMs. I had just copied /var/lib/libvirt (with the VMs
off) as part of my backup (I already backup all of /etc). But
virt-manager doesn't allow creations of VMs without installing.

Also, as a side note, the search feature on the website doesn't seem
to allow me to search using documentation only.

-- 
Fedora 13
(www.pembo13.com)

</body></email><email><emailId>20100608173832</emailId><senderName>"Todd, John A"</senderName><senderEmail>john.todd@ca.com</senderEmail><timestampReceived>2010-06-08 17:38:32-0400</timestampReceived><subject>[libvirt-users] upgrading from 0.7.2 to 0.8.1</subject><body>

Hi, I had 0.7.2 running as an out-of-the-box version of libvirtd

I ran xend and it could connect to xen:/// (with virsh)

 

I'm trying to build a eucalyptus cloud and its not working, saying
'cannot connect to xen:///' and I don't know why.

So I figure I'd get the source and try and figure it out....and upgrade
while I was at it.

 

I got 0.8.1 from source, built it and installed it.  

First of all, it installed everything using /usr/local as its root, is
this configurable?

I mean doing that it left my 0.7.2 still there and I had to do some
magic to replace it with the new stuff.

 

Now it connects to vbox:///system fine, but can't see xen:///

What's vbox:///system anyway?

 

Could it be my xend is talking to old binaries? (though I don't know
what they would be exactly)

Is there some configuration (beyond the certificate stuff which I did to
get libvirt actually up and running) with 0.8.1 (or in general as
configuration for 0.7.2 was done behind the scene as part of OS install)

That I need to do so it can connect to xen:/// again?

 

I'm not subscribed to the list, please email responses directly to me at
todjo06@ca.com 

 

Thanks.

 

- Q


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:x="urn:schemas-microsoft-com:office:excel" \
xmlns:p="urn:schemas-microsoft-com:office:powerpoint" \
xmlns:a="urn:schemas-microsoft-com:office:access" \
xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882" \
xmlns:s="uuid:BDC6E3F0-6DA3-11d1-A2A3-00AA00C14882" \
xmlns:rs="urn:schemas-microsoft-com:rowset" xmlns:z="#RowsetSchema" \
xmlns:b="urn:schemas-microsoft-com:office:publisher" \
xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" \
xmlns:c="urn:schemas-microsoft-com:office:component:spreadsheet" \
xmlns:odc="urn:schemas-microsoft-com:office:odc" \
xmlns:oa="urn:schemas-microsoft-com:office:activation" \
xmlns:html="http://www.w3.org/TR/REC-html40" \
xmlns:q="http://schemas.xmlsoap.org/soap/envelope/" \
xmlns:rtc="http://microsoft.com/officenet/conferencing" xmlns:D="DAV:" \
xmlns:Repl="http://schemas.microsoft.com/repl/" \
xmlns:mt="http://schemas.microsoft.com/sharepoint/soap/meetings/" \
xmlns:x2="http://schemas.microsoft.com/office/excel/2003/xml" \
xmlns:ppda="http://www.passport.com/NameSpace.xsd" \
xmlns:ois="http://schemas.microsoft.com/sharepoint/soap/ois/" \
xmlns:dir="http://schemas.microsoft.com/sharepoint/soap/directory/" \
xmlns:ds="http://www.w3.org/2000/09/xmldsig#" \
xmlns:dsp="http://schemas.microsoft.com/sharepoint/dsp" \
xmlns:udc="http://schemas.microsoft.com/data/udc" \
xmlns:xsd="http://www.w3.org/2001/XMLSchema" \
xmlns:sub="http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/" \
xmlns:ec="http://www.w3.org/2001/04/xmlenc#" \
xmlns:sp="http://schemas.microsoft.com/sharepoint/" \
xmlns:sps="http://schemas.microsoft.com/sharepoint/soap/" \
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" \
xmlns:udcs="http://schemas.microsoft.com/data/udc/soap" \
xmlns:udcxf="http://schemas.microsoft.com/data/udc/xmlfile" \
xmlns:udcp2p="http://schemas.microsoft.com/data/udc/parttopart" \
xmlns:wf="http://schemas.microsoft.com/sharepoint/soap/workflow/" \
xmlns:dsss="http://schemas.microsoft.com/office/2006/digsig-setup" \
xmlns:dssi="http://schemas.microsoft.com/office/2006/digsig" \
xmlns:mdssi="http://schemas.openxmlformats.org/package/2006/digital-signature" \
xmlns:mver="http://schemas.openxmlformats.org/markup-compatibility/2006" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns:mrels="http://schemas.openxmlformats.org/package/2006/relationships" \
xmlns:spwp="http://microsoft.com/sharepoint/webpartpages" \
xmlns:ex12t="http://schemas.microsoft.com/exchange/services/2006/types" \
xmlns:ex12m="http://schemas.microsoft.com/exchange/services/2006/messages" \
xmlns:pptsl="http://schemas.microsoft.com/sharepoint/soap/SlideLibrary/" \
xmlns:spsl="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService" \
xmlns:Z="urn:schemas-microsoft-com:" xmlns:st="" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;meta http-equiv=Content-Type content="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 12 (filtered medium)"&gt;
&lt;style&gt;
&lt;!--
 /* Font Definitions */
 @font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.Section1
	{page:Section1;}
--&gt;
&lt;/style&gt;
&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapelayout v:ext="edit"&gt;
  &lt;o:idmap v:ext="edit" data="1" /&gt;
 &lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
&lt;/head&gt;

&lt;body lang=EN-US link=blue vlink=purple&gt;

&lt;div class=Section1&gt;

&lt;p class=MsoNormal&gt;Hi, I had 0.7.2 running as an out-of-the-box version of
libvirtd&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;I ran xend and it could connect to xen:/// (with \
virsh)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Im trying to build a eucalyptus cloud and its not working,
saying cannot connect to xen:/// and I dont know \
why.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;So I figure Id get the source and try and figure it
out.and upgrade while I was at it.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;I got 0.8.1 from source, built it and installed it. \
&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;First of all, it installed everything using /usr/local as
its root, is this configurable?&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;I mean doing that it left my 0.7.2 still there and I had to
do some magic to replace it with the new stuff.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Now it connects to vbox:///system fine, but cant see
xen:///&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Whats vbox:///system anyway?&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Could it be my xend is talking to old binaries? (though I
dont know what they would be exactly)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Is there some configuration (beyond the certificate stuff
which I did to get libvirt actually up and running) with 0.8.1 (or in general
as configuration for 0.7.2 was done behind the scene as part of OS \
install)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;That I need to do so it can connect to xen:/// \
again?&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Im not subscribed to the list, please email responses
directly to me at todjo06@ca.com &lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Thanks.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;- Q&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;



</body></email><email><emailId>20100609171202</emailId><senderName>Camilo Aguilar</senderName><senderEmail>camilo@cloudescape.com</senderEmail><timestampReceived>2010-06-09 17:12:02-0400</timestampReceived><subject>[libvirt-users] about virDomainSave and virDomainRestore</subject><body>

Hi there,

There is some special reason to require a virConnectPtr param in
virDomainRestore ?

Regards,

Camilo

[Attachment #3 (text/html)]

Hi there,=C2=A0&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;There is some special reason to require =
a virConnectPtr param in virDomainRestore ?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regard=
s,=C2=A0&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Camilo&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div=
&gt;&lt;div&gt;=C2=A0&lt;/div&gt;



</body></email><email><emailId>20100609171749</emailId><senderName>Justin Clift</senderName><senderEmail>justin@salasaga.org</senderEmail><timestampReceived>2010-06-09 17:17:49-0400</timestampReceived><subject>[libvirt-users] Multipath pools - practical for use?</subject><body>

Hi all,

Writing up some Fedora documentation, and looking to figure out the best 
way of mapping multipath network(!) LUNs to pools in libvirt.

   ie Infiniband SRP LUNs, but would probably apply to Fibre Channel
      equally as well.

There are two approaches I can think of easily:

  a) Large LUNs (ie TB+) that are mapped to a host server as disk, with
     each LUN being configured as an LVM pool.  This lets the host
     slice the pool up into volumes with the libvirt volume creation
     commands.

  b) Pre-purposed LUNs mapped to a host server as disk, but passed
     through directly to their respective guests.

     ie Something like Oracle, with 3 SAN LUNs mapped to guest FOO for
        its database data

In a non-libvirt world I'd look at configuring the LUNs on the host
with persistent name using multipath, then present them appropriately to 
whatever needs them from there.

However, libvirt has a pool type called "multipath".  Looking at the 
docs online, it doesn't appear to be all that fully featured at this 
point.  Seems more of a brief mention and footnote, so I'm wondering 
whether to use it or skip it for now in the Fedora docs.

Anyone have thoughts/suggestions/etc? :)

Regards and best wishes,

Justin Clift

-- 
Salasaga  -  Open Source eLearning IDE
               http://www.salasaga.org

</body></email><email><emailId>20100609003150</emailId><senderName>jeremy avnet</senderName><senderEmail>brainsik+libvirt@saucelabs.com</senderEmail><timestampReceived>2010-06-09 00:31:50-0400</timestampReceived><subject>[libvirt-users] Missing target dev for interface</subject><body>

I have over 20 guests running on a particular host and the three
longest running ones are missing the network device information in
their XML description:

    &lt;interface type='network'&gt;
      &lt;mac address='54:52:10::f2:c5'/&gt;
      &lt;source network='local'/&gt;
    &lt;/interface&gt;

Compared to the others which have:

    &lt;interface type='network'&gt;
      &lt;mac address='54:52:d1:32:0a:a1'/&gt;
      &lt;source network='local'/&gt;
      &lt;target dev='vnet13'/&gt;
    &lt;/interface&gt;

This is problematic as I wanted to use domifstat on the domains. Using
the packet counts shown via ifconfig on the host, I was able to
determine what the vnet interface should be, but passing that to
domifstat doesn't work:

$ virsh domifstat maki221 vnet13
Connecting to uri: qemu:///system
error: Failed to get interface stats guest19 vnet13
error: invalid argument in invalid path, 'vnet13' is not a known interface

How did this happen? Is there a way I can get libvirt to know about
the interfaces?

And the guest OS's network connections work fine.

Thanks!
.:. jeremy

</body></email><email><emailId>20100609083808</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-06-09 08:38:08-0400</timestampReceived><subject>Re: [libvirt-users] Missing target dev for interface</subject><body>

On Tue, Jun 08, 2010 at 05:31:50PM -0700, jeremy avnet wrote:
&gt; I have over 20 guests running on a particular host and the three
&gt; longest running ones are missing the network device information in
&gt; their XML description:
&gt; 
&gt;     &lt;interface type='network'&gt;
&gt;       &lt;mac address='54:52:10::f2:c5'/&gt;
&gt;       &lt;source network='local'/&gt;
&gt;     &lt;/interface&gt;

I guess you restarted libvirtd - there was a bug that causes it to
forget the interface name if you restart it.

Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100608054815</emailId><senderName>Justin Clift</senderName><senderEmail>justin@salasaga.org</senderEmail><timestampReceived>2010-06-08 05:48:15-0400</timestampReceived><subject>Re: [libvirt-users] Best practices on backingup/restore VMs</subject><body>

On 06/08/2010 02:59 PM, Arthur Pemberton wrote:
&gt; I just moved from F11 to F13 and I'm find no information on the best
&gt; way to restore VMs. I had just copied /var/lib/libvirt (with the VMs
&gt; off) as part of my backup (I already backup all of /etc). But
&gt; virt-manager doesn't allow creations of VMs without installing.
&gt;
&gt; Also, as a side note, the search feature on the website doesn't seem
&gt; to allow me to search using documentation only.

Hi Arthur,

It sounds like you already have working and valid XML configuration 
files saved somewhere.

You may want to take a look at importing those XML configuration files 
(one by one) directly into your new F13 setup.

Look into the virsh "define" then "start" commands, used from the 
command line.

That should get you started.  There is plenty of info on the Net, in the 
man pages, and in the Fedora 13 Virtualization Guide, about this.

Hope that helps. :)

Regards and best wishes,

Justin Clift

-- 
Salasaga  -  Open Source eLearning IDE
               http://www.salasaga.org

</body></email><email><emailId>20100601061420</emailId><senderName>Justin Clift</senderName><senderEmail>justin@salasaga.org</senderEmail><timestampReceived>2010-06-01 06:14:20-0400</timestampReceived><subject>Re: [libvirt-users] Dual-boot and also use raw disk in virtual machine</subject><body>

On 06/01/2010 01:09 PM, Richard Walker wrote:
&lt;snip&gt;
&gt; Am I going to be able to get this to work?

Hi Richard,

Reading through the steps you took, my initial thought is that it sounds 
like a bad idea (sorry).

It sounds like you want to have Windows 7 on the 2nd hard drive, and be 
able to boot it from either inside a virtual machine, or natively as a 
dual boot.

To me, the major problem that presents is the different devices windows 
will see with each type of boot.

For example:

   Native boot
   ***********

   Real motherboard chip set (ie drivers for Intel, or AMD, or nVidia,
                              or something else)
   Real CPU (ie Intel or AMD)
   Real hard drives for storage (perhaps Intel, or nVidia drivers)
   Real network card(s) (ie drivers for Intel, or Broadcom, or Realtek,
                         etc)
   Real graphics cards (ie graphics drivers for nVidia, or ATI, or Intel,
                        etc)
   &lt;and more&gt;


   Virtualised (KVM) boot
   **********************

   Virtual motherboard chip set (software)
   Virtual CPU (partially a pass through of your real one)
   Virtual hard drive storage (KVM provided emulation layer)
   Virtual graphics cards (KVM provided emulation layer)
   &lt;and more&gt;

I'm not going to say it's 100% impossible, but it's definitely likely 
going to confuse the heck out of windows, when it tries to boot up using 
(for example) an nVidia or Intel chipset and they're not there.

Have you told windows not to automatically reboot at BSOD, so you can 
read what's causing the BSOD?  It may specifically list the cause (ie a 
specific driver?) on the BSOD screen, and you may be able to work around it.

Regards and best wishes,

Justin Clift

-- 
Salasaga  -  Open Source eLearning IDE
               http://www.salasaga.org

</body></email><email><emailId>20100602031856</emailId><senderName>Richard Walker</senderName><senderEmail>walkerrichardj@gmail.com</senderEmail><timestampReceived>2010-06-02 03:18:56-0400</timestampReceived><subject>Re: [libvirt-users] Dual-boot and also use raw disk in virtual machine</subject><body>

On 1 June 2010 16:14, Justin Clift &lt;justin@salasaga.org&gt; wrote:
&gt; On 06/01/2010 01:09 PM, Richard Walker wrote:
&gt; &lt;snip&gt;
&gt;&gt;
&gt;&gt; Am I going to be able to get this to work?
&gt;
&gt; Hi Richard,
&gt;
&gt; Reading through the steps you took, my initial thought is that it sounds
&gt; like a bad idea (sorry).
&gt;
&gt; It sounds like you want to have Windows 7 on the 2nd hard drive, and be able
&gt; to boot it from either inside a virtual machine, or natively as a dual boot.

Exactly.

&gt; To me, the major problem that presents is the different devices windows will
&gt; see with each type of boot.

It wasn't a completely random idea to try this -- I had found some evidence
of people getting this to work successfully (albeit with XP):

http://un.codiert.org/2008/09/booting-windows-xp-from-raw-disk-with-linux-kvm/

(I did wonder whether the deletion of the Hardware Profiles function from
Windows 7 would have any effect.)

&gt; Have you told windows not to automatically reboot at BSOD, so you can read
&gt; what's causing the BSOD?  It may specifically list the cause (ie a specific
&gt; driver?) on the BSOD screen, and you may be able to work around it.

I have now . . . good tip.  It seems I get one of the standard messages:
*** STOP: 0x0000007B (0xFFFFF880009A9928, ...)
which appears to indicate an inability to "find" the disk.

I will take a note of the drivers that are currently installed, then
do another fresh "native" install and try to add the extra drivers
manually.

Is there any significance to the apparently "broken" partition table
entries?  Probably yes . . . I will do some more investigation of
that too.

</body></email><email><emailId>20100603030448</emailId><senderName>Richard Walker</senderName><senderEmail>walkerrichardj@gmail.com</senderEmail><timestampReceived>2010-06-03 03:04:48-0400</timestampReceived><subject>Re: [libvirt-users] Dual-boot and also use raw disk in virtual machine</subject><body>

On 2 June 2010 13:18, Richard Walker &lt;walkerrichardj@gmail.com&gt; wrote:
&gt; I will take a note of the drivers that are currently installed, then
&gt; do another fresh "native" install and try to add the extra drivers
&gt; manually.

I went through Device Manager and made a note of all the
filenames of all the drivers.  Then I did the fresh "native"
install.  It turned out that that installed all the filenames
I'd written down (plus many others).  But rebooting into
F13 and starting Win 7 as a virtual machine gave the same
symptoms as before.  :-(

&gt; Is there any significance to the apparently "broken" partition table
&gt; entries?  Probably yes . . . I will do some more investigation of
&gt; that too.

It seems that even though sfdisk says there is strangeness,
the partition table still "works".

</body></email><email><emailId>20100603040940</emailId><senderName>Justin Clift</senderName><senderEmail>justin@salasaga.org</senderEmail><timestampReceived>2010-06-03 04:09:40-0400</timestampReceived><subject>Re: [libvirt-users] Dual-boot and also use raw disk in virtual	machine</subject><body>

On 06/03/2010 01:04 PM, Richard Walker wrote:
&lt;snip&gt;
&gt;&gt; Is there any significance to the apparently "broken" partition table
&gt;&gt; entries?  Probably yes . . . I will do some more investigation of
&gt;&gt; that too.
&gt;
&gt; It seems that even though sfdisk says there is strangeness,
&gt; the partition table still "works".

Hmmm... as a thought, is it possible to wipe the drive and set up the 
partitions the way you want them from F13, prior to install Windows 7?

Then tell Windows 7 to use those existing partitions instead of it doing 
the setup?  I have absolutely no idea if this will work, mind you. 
Might be easier to try first with FAT32 partitions as well (unsure).

I'm more in "thinking of possible options" mode, than knowing what to 
try next for sure with this. :)

Regards and best wishes,

Justin Clift

-- 
Salasaga  -  Open Source eLearning IDE
               http://www.salasaga.org

</body></email><email><emailId>20100607043928</emailId><senderName>Richard Walker</senderName><senderEmail>walkerrichardj@gmail.com</senderEmail><timestampReceived>2010-06-07 04:39:28-0400</timestampReceived><subject>Re: [libvirt-users] Dual-boot and also use raw disk in virtual machine</subject><body>

On 2 June 2010 13:18, Richard Walker &lt;walkerrichardj@gmail.com&gt; wrote:
&gt;&gt; Have you told windows not to automatically reboot at BSOD, so you can read
&gt;&gt; what's causing the BSOD?  It may specifically list the cause (ie a specific
&gt;&gt; driver?) on the BSOD screen, and you may be able to work around it.
&gt;
&gt; I have now . . . good tip.  It seems I get one of the standard messages:
&gt; *** STOP: 0x0000007B (0xFFFFF880009A9928, ...)
&gt; which appears to indicate an inability to "find" the disk.
&gt;
&gt; I will take a note of the drivers that are currently installed, then
&gt; do another fresh "native" install and try to add the extra drivers
&gt; manually.
&gt;
&gt; Is there any significance to the apparently "broken" partition table
&gt; entries?  Probably yes . . . I will do some more investigation of
&gt; that too.

Many days later, many hours spent . . .

And at last . . . success!

There are hints floating about on the web; it was
just a matter of finding the right one.

I made a fresh install into a VM so I could compare
registry keys.

In:
HKLM\SYSTEM\CurrentControlSet\services
there are some differences between the native
install and the VM install.  In the native
install, intelide's Start setting is 3, and
pciide's Start setting is 0.  In the fresh install
into a VM, those settings are reversed.

So in the native install I set intelide's
Start setting to 0 (i.e., to enable it).
I didn't touch pciide's Start setting.

Reboot natively - still boots (a relief!).
And then it also booted as a VM!

After logging in, the drivers for the virtual
devices (except audio) were installed OK.
I can now switch between booting natively
and booting as a VM.  There's now no sign of
driver installation when switching.

So far so good . . .

</body></email><email><emailId>20100607045919</emailId><senderName>Justin Clift</senderName><senderEmail>justin@salasaga.org</senderEmail><timestampReceived>2010-06-07 04:59:19-0400</timestampReceived><subject>Re: [libvirt-users] Dual-boot and also use raw disk in virtual	machine</subject><body>

On 06/07/2010 02:39 PM, Richard Walker wrote:
&lt;snip&gt;
&gt; And at last . . . success!

Interesting.  Hope you've taken a backup (image the hdd or something). :)

I wonder if it's possible to use a dedicated hdd as a snapshot backing 
store, with the copy on write difference file being else where.

   ie. /some/location/snapshot1.qcow2

That would let you use a VM with "/some/location/snapshot1.qcow2" as 
it's hard drive, and wouldn't then make any changes to your actual 
(working) dedicated windows hdd.  Lets you try things in a vm easily 
without ruining the primary image.

Disk i/o performance in the vm could be less than great though. :/

Regards and best wishes,

Justin Clift

-- 
Salasaga  -  Open Source eLearning IDE
               http://www.salasaga.org

</body></email><email><emailId>20100607062214</emailId><senderName>Richard Walker</senderName><senderEmail>walkerrichardj@gmail.com</senderEmail><timestampReceived>2010-06-07 06:22:14-0400</timestampReceived><subject>Re: [libvirt-users] Dual-boot and also use raw disk in virtual machine</subject><body>

On 7 June 2010 14:59, Justin Clift &lt;justin@salasaga.org&gt; wrote:
&gt; On 06/07/2010 02:39 PM, Richard Walker wrote:
&gt; &lt;snip&gt;
&gt;&gt;
&gt;&gt; And at last . . . success!
&gt;
&gt; Interesting.  Hope you've taken a backup (image the hdd or something). :)

Uh, yes, well, maybe I will get around to that.

The next problem to face is activation.
Having activated the native install, now I have three
days to activate in the VM, and that doesn't work.
Too many hardware "changes" I suppose . . .

</body></email><email><emailId>20100602102157</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-06-02 10:21:57-0400</timestampReceived><subject>Re: [libvirt-users] libvirt with opennebula</subject><body>

2010/6/1 marwen marwen &lt;marwen.ensi@gmail.com&gt;:
&gt; hello
&gt; I'm currently using libvirt and opennebula. I have installed the libvirt
&gt; with the driver of opennebule "ONE" and I test the installation.
&gt;
&gt; /********************************************************/
&gt; oneadmin@node016 ~]$ virsh -c one:///
&gt; Welcome to virsh, the virtualization interactive terminal.
&gt;
&gt; Type:  'help' for help with commands
&gt;        'quit' to quit
&gt;
&gt; virsh # list
&gt;  Id Name                 State
&gt; ----------------------------------
&gt;
&gt; virsh #
&gt; /********************************************************/
&gt;
&gt;
&gt; but I can not see the list of machines that run in the cluster node (Xen and
&gt; KVM)
&gt; I want to know if this is a problem of configuration files ( libvirtd.conf
&gt; and oned.conf).
&gt; can you help me to overcome this problem
&gt;
&gt; thank you
&gt;

The OpenNebula driver is currently not really maintained by someone.

I took a look at the OpenNebula driver code and I understand now why
it doesn't work as expected.

The driver keeps and internal list of known domains, but this list is
never initialized with the already existing domains, that's why it
doesn't list your already existing domains. The list is only altered
by libvirt's define and undefine functions.

I think that the driver should not cache this list, but it should
request the list of existing domains from the OpenNebula daemon each
time it needs it. This way it'll always be in sync with external
changes.

Once the internal list is replaced by a lookup function the rest of
the driver should just work.

I don't have a OpenNebula setup at hand, so patches welcome :)

Matthias

</body></email><email><emailId>20100602115805</emailId><senderName>marwen marwen</senderName><senderEmail>marwen.ensi@gmail.com</senderEmail><timestampReceived>2010-06-02 11:58:05-0400</timestampReceived><subject>Re: [libvirt-users] libvirt with opennebula</subject><body>

thank you very much for your reply

As you said libvirt see only machines that set. in fact I would like to know
what part we modify to solve this problem.
I also want to know if the driver of opennebula supports migration or not

thank you

2010/6/2 Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;

&gt; 2010/6/1 marwen marwen &lt;marwen.ensi@gmail.com&gt;:
&gt; &gt; hello
&gt; &gt; I'm currently using libvirt and opennebula. I have installed the libvirt
&gt; &gt; with the driver of opennebule "ONE" and I test the installation.
&gt; &gt;
&gt; &gt; /********************************************************/
&gt; &gt; oneadmin@node016 ~]$ virsh -c one:///
&gt; &gt; Welcome to virsh, the virtualization interactive terminal.
&gt; &gt;
&gt; &gt; Type:  'help' for help with commands
&gt; &gt;        'quit' to quit
&gt; &gt;
&gt; &gt; virsh # list
&gt; &gt;  Id Name                 State
&gt; &gt; ----------------------------------
&gt; &gt;
&gt; &gt; virsh #
&gt; &gt; /********************************************************/
&gt; &gt;
&gt; &gt;
&gt; &gt; but I can not see the list of machines that run in the cluster node (Xen
&gt; and
&gt; &gt; KVM)
&gt; &gt; I want to know if this is a problem of configuration files (
&gt; libvirtd.conf
&gt; &gt; and oned.conf).
&gt; &gt; can you help me to overcome this problem
&gt; &gt;
&gt; &gt; thank you
&gt; &gt;
&gt;
&gt; The OpenNebula driver is currently not really maintained by someone.
&gt;
&gt; I took a look at the OpenNebula driver code and I understand now why
&gt; it doesn't work as expected.
&gt;
&gt; The driver keeps and internal list of known domains, but this list is
&gt; never initialized with the already existing domains, that's why it
&gt; doesn't list your already existing domains. The list is only altered
&gt; by libvirt's define and undefine functions.
&gt;
&gt; I think that the driver should not cache this list, but it should
&gt; request the list of existing domains from the OpenNebula daemon each
&gt; time it needs it. This way it'll always be in sync with external
&gt; changes.
&gt;
&gt; Once the internal list is replaced by a lookup function the rest of
&gt; the driver should just work.
&gt;
&gt; I don't have a OpenNebula setup at hand, so patches welcome :)
&gt;
&gt; Matthias
&gt;

[Attachment #3 (text/html)]

&lt;span id="result_box" class="long_text"&gt;&lt;span style="background-color: rgb(255, 255, \
255);" title=""&gt;thank you very much for your reply&lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;span \
style="background-color: rgb(255, 255, 255);" title=""&gt;As you said libvirt see only \
machines that set. &lt;/span&gt;&lt;span style="background-color: rgb(255, 255, 255);" \
title=""&gt;in fact I would like to know what part we modify to solve this problem.&lt;br&gt; \
&lt;/span&gt;&lt;span style="" title=""&gt;I also want to know if the driver of opennebula \
&lt;/span&gt;&lt;/span&gt;&lt;span id="result_box" class="long_text"&gt;&lt;span style="" \
title=""&gt;supports &lt;/span&gt;&lt;/span&gt;&lt;span id="result_box" class="long_text"&gt;&lt;span \
style="" title=""&gt;migration or not&lt;br&gt; &lt;br&gt;&lt;/span&gt;&lt;span title=""&gt;thank \
you&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;2010/6/2 Matthias Bolte &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;
 &lt;blockquote class="gmail_quote" style="border-left: 1px solid rgb(204, 204, 204); \
margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;"&gt;2010/6/1 marwen marwen &lt;&lt;a \
href="mailto:marwen.ensi@gmail.com"&gt;marwen.ensi@gmail.com&lt;/a&gt;&gt;:&lt;br&gt;

&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;&gt; hello&lt;br&gt;
&gt; I'm currently using libvirt and opennebula. I have installed the libvirt&lt;br&gt;
&gt; with the driver of opennebule "ONE" and I test the installation.&lt;br&gt;
&gt;&lt;br&gt;
&gt; /********************************************************/&lt;br&gt;
&gt; oneadmin@node016 ~]$ virsh -c one:///&lt;br&gt;
&gt; Welcome to virsh, the virtualization interactive terminal.&lt;br&gt;
&gt;&lt;br&gt;
&gt; Type:  'help' for help with commands&lt;br&gt;
&gt;        'quit' to quit&lt;br&gt;
&gt;&lt;br&gt;
&gt; virsh # list&lt;br&gt;
&gt;  Id Name                 State&lt;br&gt;
&gt; ----------------------------------&lt;br&gt;
&gt;&lt;br&gt;
&gt; virsh #&lt;br&gt;
&gt; /********************************************************/&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt; but I can not see the list of machines that run in the cluster node (Xen and&lt;br&gt;
&gt; KVM)&lt;br&gt;
&gt; I want to know if this is a problem of configuration files ( libvirtd.conf&lt;br&gt;
&gt; and oned.conf).&lt;br&gt;
&gt; can you help me to overcome this problem&lt;br&gt;
&gt;&lt;br&gt;
&gt; thank you&lt;br&gt;
&gt;&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;The OpenNebula driver is currently not really maintained by someone.&lt;br&gt;
&lt;br&gt;
I took a look at the OpenNebula driver code and I understand now why&lt;br&gt;
it doesn't work as expected.&lt;br&gt;
&lt;br&gt;
The driver keeps and internal list of known domains, but this list is&lt;br&gt;
never initialized with the already existing domains, that's why it&lt;br&gt;
doesn't list your already existing domains. The list is only altered&lt;br&gt;
by libvirt's define and undefine functions.&lt;br&gt;
&lt;br&gt;
I think that the driver should not cache this list, but it should&lt;br&gt;
request the list of existing domains from the OpenNebula daemon each&lt;br&gt;
time it needs it. This way it'll always be in sync with external&lt;br&gt;
changes.&lt;br&gt;
&lt;br&gt;
Once the internal list is replaced by a lookup function the rest of&lt;br&gt;
the driver should just work.&lt;br&gt;
&lt;br&gt;
I don't have a OpenNebula setup at hand, so patches welcome :)&lt;br&gt;
&lt;font color="#888888"&gt;&lt;br&gt;
Matthias&lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20100602140506</emailId><senderName>Justin Clift</senderName><senderEmail>justin@salasaga.org</senderEmail><timestampReceived>2010-06-02 14:05:06-0400</timestampReceived><subject>Re: [libvirt-users] Mount options for fs type storage pools?</subject><body>

On 06/02/2010 02:35 AM, Cole Robinson wrote:
&lt;snip&gt;
&gt; Can't find the email thread, but I believe this has been explicitly
&gt; rejected in the past. Allowing arbitrary option passthrough could
&gt; conflict with a future libvirt version if we alter the mount command
&gt; line, among other supportability reasons (though we have backtracked a
&gt; bit on that stance WRT the qemu emulator command line, but there is much
&gt; more at stake in that case).
&gt;
&gt; If users need special mount options, their best option is to manually
&gt; configure the mount, then create a directory pool pointing at the mount dir.

Thanks Cole, not a worry. :)

Regards and best wishes,

Justin Clift


&gt; - Cole


-- 
Salasaga  -  Open Source eLearning IDE
               http://www.salasaga.org

</body></email><email><emailId>20100602140710</emailId><senderName>Justin Clift</senderName><senderEmail>justin@salasaga.org</senderEmail><timestampReceived>2010-06-02 14:07:10-0400</timestampReceived><subject>Re: [libvirt-users] Working example of logical storage pool and volume creation?</subject><body>

On 06/01/2010 03:26 AM, Justin Clift wrote:
&gt; Hi all,
&gt;
&gt; Does anyone have a working example of creation of a logical storage pool
&gt; and volume?
&lt;snip&gt;

If anyone's interested, the working command turned out to be:

   # virsh pool-define-as guest_images_lvm logical - - /dev/sdc 
libvirt_lvm /dev/libvirt_lvm

(that's all on one line)

Regards and best wishes,

Justin Clift

-- 
Salasaga  -  Open Source eLearning IDE
               http://www.salasaga.org

</body></email><email><emailId>20100602142051</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2010-06-02 14:20:51-0400</timestampReceived><subject>Re: [libvirt-users] JSON support</subject><body>

On 06/01/10 - 10:47:11PM, Camilo Aguilar wrote:
&gt; Are there any efforts to support JSON in libvirt ?

You'll need to be a bit more specific; what exactly do you want JSON for?
The only JSON that libvirt currently supports is using JSON for the Qemu
QMP protocol, but that code is actually disabled until Qemu 0.13 comes out
(sometime in the next couple of months).  What do you need libvirt to do
with JSON?

--
Chris Lalancette

</body></email><email><emailId>20100603020134</emailId><senderName>Jonathan Tripathy</senderName><senderEmail>jonnyt@abpni.co.uk</senderEmail><timestampReceived>2010-06-03 02:01:34-0400</timestampReceived><subject>[libvirt-users] PCI Passthrough</subject><body>

Hi Everyone,

When I try and assign a physical device to a guest using virt-manager, 
libvirt throws an error:

"Failed to create inactive domain"

I'm using libvirt 0.8.1 which I compiled myself, along with Xen 4.0 on 
Ubuntu 10.04 Dom0

I'm also using virt-manager 0.8.4 which I compiled myself.

Any help would be appreciated

Thanks

</body></email><email><emailId>20100603110934</emailId><senderName></senderName><senderEmail>juby0710@gmail.com</senderEmail><timestampReceived>2010-06-03 11:09:34-0400</timestampReceived><subject>[libvirt-users] Virsh blkstat doesn't work on Xen HVM</subject><body>

Hi

I tried to use virsh blkstat to get information of a block, but it
returns an error message as shown below
This function works fine in KVM, but fail in XEN.
I tried XEN 3.4.3 ,4.0.0 and 4.0.1 with libvirt 0.7.1 from fedora yum
server and 0.8.1 from libvirt .
All of them are fail to get the block status.
The following is the config file and error message of virsh domblkstat.
Any one knows how to make this function work?

[root@localhost ~]# virsh dumpxml vm1
&lt;domain type='xen' id='1'&gt;
  &lt;name&gt;vm1&lt;/name&gt;
  &lt;uuid&gt;12af1ed4-2f2d-f02d-9a2a-5d4f377889d5&lt;/uuid&gt;
  &lt;memory&gt;524288&lt;/memory&gt;
  &lt;currentMemory&gt;524288&lt;/currentMemory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type&gt;hvm&lt;/type&gt;
    &lt;loader&gt;/usr/lib/xen/boot/hvmloader&lt;/loader&gt;
    &lt;boot dev='hd'/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
    &lt;apic/&gt;
    &lt;pae/&gt;
  &lt;/features&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;restart&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/lib64/xen/bin/qemu-dm&lt;/emulator&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;driver name='file'/&gt;
      &lt;source file='/var/lib/libvirt/images/vm1.img'/&gt;
      &lt;target dev='hda' bus='ide'/&gt;
    &lt;/disk&gt;
    &lt;disk type='file' device='cdrom'&gt;
      &lt;target dev='hdc' bus='ide'/&gt;
      &lt;readonly/&gt;
    &lt;/disk&gt;
    &lt;interface type='bridge'&gt;
      &lt;mac address='00:16:36:0f:fb:7a'/&gt;
      &lt;source bridge='eth0'/&gt;
      &lt;script path='/etc/xen/scripts/vif-bridge'/&gt;
      &lt;target dev='vif1.0'/&gt;
    &lt;/interface&gt;
    &lt;serial type='pty'&gt;
      &lt;source path='/dev/pts/0'/&gt;
      &lt;target port='0'/&gt;
    &lt;/serial&gt;
    &lt;console type='pty' tty='/dev/pts/0'&gt;
      &lt;source path='/dev/pts/0'/&gt;
      &lt;target port='0'/&gt;
    &lt;/console&gt;
    &lt;input type='mouse' bus='ps2'/&gt;
    &lt;graphics type='vnc' port='5900' autoport='yes' keymap='en-us'/&gt;
    &lt;sound model='es1370'/&gt;
  &lt;/devices&gt;
&lt;/domain&gt;

[root@localhost ~]# virsh domblkstat vm1 hda
error: Failed to get block stats vm1 hda
error: internal error read_bd_stats: Failed to read any block statistics

</body></email><email><emailId>20100603113228</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-06-03 11:32:28-0400</timestampReceived><subject>Re: [libvirt-users] libvirt with opennebula</subject><body>

2010/6/2 marwen marwen &lt;marwen.ensi@gmail.com&gt;:
&gt; thank you very much for your reply
&gt;
&gt; As you said libvirt see only machines that set. in fact I would like to know
&gt; what part we modify to solve this problem.
&gt; I also want to know if the driver of opennebula supports migration or not
&gt;
&gt; thank you

As I said the driver keeps an internal list of domains it knows about.
See src/opennebula/one_driver.c for driver-&gt;domains, that's the
internal list. This list needs to be replaced by a function that asks
the OpenNebula daemon for the list of existing domains each time it
needs this information. Basically this parts of the driver need to be
rewritten in the way the ESX, Power Hypervisor and VirtualBox drivers
work.

Regarding migration, this is not implemented yet for the OpenNebula driver.

Matthias

&gt; 2010/6/2 Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;
&gt;&gt;
&gt;&gt; 2010/6/1 marwen marwen &lt;marwen.ensi@gmail.com&gt;:
&gt;&gt; &gt; hello
&gt;&gt; &gt; I'm currently using libvirt and opennebula. I have installed the libvirt
&gt;&gt; &gt; with the driver of opennebule "ONE" and I test the installation.
&gt;&gt; &gt;
&gt;&gt; &gt; /********************************************************/
&gt;&gt; &gt; oneadmin@node016 ~]$ virsh -c one:///
&gt;&gt; &gt; Welcome to virsh, the virtualization interactive terminal.
&gt;&gt; &gt;
&gt;&gt; &gt; Type:  'help' for help with commands
&gt;&gt; &gt;        'quit' to quit
&gt;&gt; &gt;
&gt;&gt; &gt; virsh # list
&gt;&gt; &gt;  Id Name                 State
&gt;&gt; &gt; ----------------------------------
&gt;&gt; &gt;
&gt;&gt; &gt; virsh #
&gt;&gt; &gt; /********************************************************/
&gt;&gt; &gt;
&gt;&gt; &gt;
&gt;&gt; &gt; but I can not see the list of machines that run in the cluster node (Xen
&gt;&gt; &gt; and
&gt;&gt; &gt; KVM)
&gt;&gt; &gt; I want to know if this is a problem of configuration files (
&gt;&gt; &gt; libvirtd.conf
&gt;&gt; &gt; and oned.conf).
&gt;&gt; &gt; can you help me to overcome this problem
&gt;&gt; &gt;
&gt;&gt; &gt; thank you
&gt;&gt; &gt;
&gt;&gt;
&gt;&gt; The OpenNebula driver is currently not really maintained by someone.
&gt;&gt;
&gt;&gt; I took a look at the OpenNebula driver code and I understand now why
&gt;&gt; it doesn't work as expected.
&gt;&gt;
&gt;&gt; The driver keeps and internal list of known domains, but this list is
&gt;&gt; never initialized with the already existing domains, that's why it
&gt;&gt; doesn't list your already existing domains. The list is only altered
&gt;&gt; by libvirt's define and undefine functions.
&gt;&gt;
&gt;&gt; I think that the driver should not cache this list, but it should
&gt;&gt; request the list of existing domains from the OpenNebula daemon each
&gt;&gt; time it needs it. This way it'll always be in sync with external
&gt;&gt; changes.
&gt;&gt;
&gt;&gt; Once the internal list is replaced by a lookup function the rest of
&gt;&gt; the driver should just work.
&gt;&gt;
&gt;&gt; I don't have a OpenNebula setup at hand, so patches welcome :)
&gt;&gt;
&gt;&gt; Matthias
&gt;
&gt;

</body></email><email><emailId>20100605180403</emailId><senderName>scar</senderName><senderEmail>scar@drigon.com</senderEmail><timestampReceived>2010-06-05 18:04:03-0400</timestampReceived><subject>[libvirt-users] host OS can't access internet but guest OS with bridge can</subject><body>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

i have a desktop with ubuntu 9.04 on it... it needs to be updated but i
can't access the internet since its last reboot.  it has linux
2.6.28-18-generic on it, and libvirt 0.6.1-0ubuntu5.1.

i setup libvirt for bridging, and a guest OS i have running can access
the internet fine.

when i try to ping someplace from the host, it can resolve the hostname
but i get "Destination Host Unreachable" errors.  it uses the router for
DNS, and i can access the router and other local computers fine.

$ route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use
Iface
192.168.1.0     0.0.0.0         255.255.255.0   U     0      0        0 br0
192.168.1.0     0.0.0.0         255.255.255.0   U     1      0        0 eth0
192.168.122.0   0.0.0.0         255.255.255.0   U     0      0        0
virbr0
169.254.0.0     0.0.0.0         255.255.0.0     U     1000   0        0 br0
0.0.0.0         192.168.1.1     0.0.0.0         UG    0      0        0 eth0
0.0.0.0         192.168.1.1     0.0.0.0         UG    100    0        0 br0
$

-----BEGIN PGP SIGNATURE-----

iEYEAREIAAYFAkwKkZMACgkQXhfCJNu98qCt3wCffrY0VvAL0eA+uoVjHOIgnBax
5isAoPJTwxX/KLSOxA9UZDwO6a4ALkLx
=LE+h
-----END PGP SIGNATURE-----

</body></email><email><emailId>20100607075318</emailId><senderName>Justin Clift</senderName><senderEmail>justin@salasaga.org</senderEmail><timestampReceived>2010-06-07 07:53:18-0400</timestampReceived><subject>Re: [libvirt-users] Dual-boot and also use raw disk in virtual	machine</subject><body>

On 06/07/2010 04:22 PM, Richard Walker wrote:
&gt; On 7 June 2010 14:59, Justin Clift&lt;justin@salasaga.org&gt;  wrote:
&gt;&gt; On 06/07/2010 02:39 PM, Richard Walker wrote:
&gt;&gt; &lt;snip&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; And at last . . . success!
&gt;&gt;
&gt;&gt; Interesting.  Hope you've taken a backup (image the hdd or something). :)
&gt;
&gt; Uh, yes, well, maybe I will get around to that.
&gt;
&gt; The next problem to face is activation.
&gt; Having activated the native install, now I have three
&gt; days to activate in the VM, and that doesn't work.
&gt; Too many hardware "changes" I suppose . . .

Btw, the snapshot approach mentioned works.  It's very easy.

For a 500GB physical disk, with an OS installed on it:

   # qemu-img create -f qcow2 -o 
backing_file=/dev/sdb,backing_fmt=host_device 
/home/images/sdbimagesnap2.qcow2 500G

That creates the snapshot.  Then change a guest XML file to point to the 
snapshot.  From:

   &lt;disk type='block' device='disk'&gt;
     &lt;driver name='qemu'/&gt;            &lt;-- no "type" here
     &lt;source dev='/dev/sdb'/&gt;         &lt;-- physical device here
     &lt;target dev='hda' bus='ide'/&gt;
   &lt;/disk&gt;

To:

   &lt;disk type='block' device='disk'&gt;
     &lt;driver name='qemu' type='qcow2'/&gt;               &lt;-- qcow2 type here
     &lt;source dev='/home/images/sdbimagesnap2.qcow2'/&gt; &lt;--snapshot file
     &lt;target dev='hda' bus='ide'/&gt;
   &lt;/disk&gt;

And the guest then uses the snapshot file, making writes only to that 
and leaving the physical device alone.

It probably would have been a good way to experiment with your dual boot 
solution, without invalidating the license keys when physically booting 
Windows.  Though, booting windows for real would likely silently corrupt 
the vm snapshots. :/

Good luck with your pursuit though.  Hope you figure the license 
activation thing out.  :)

Regards and best wishes,

Justin Clift

-- 
Salasaga  -  Open Source eLearning IDE
               http://www.salasaga.org

</body></email><email><emailId>20100608142616</emailId><senderName>Arthur Pemberton</senderName><senderEmail>pemboa@gmail.com</senderEmail><timestampReceived>2010-06-08 14:26:16-0400</timestampReceived><subject>Re: [libvirt-users] Best practices on backingup/restore VMs</subject><body>

On Tue, Jun 8, 2010 at 12:48 AM, Justin Clift &lt;justin@salasaga.org&gt; wrote:
&gt; On 06/08/2010 02:59 PM, Arthur Pemberton wrote:
&gt;&gt;
&gt;&gt; I just moved from F11 to F13 and I'm find no information on the best
&gt;&gt; way to restore VMs. I had just copied /var/lib/libvirt (with the VMs
&gt;&gt; off) as part of my backup (I already backup all of /etc). But
&gt;&gt; virt-manager doesn't allow creations of VMs without installing.
&gt;&gt;
&gt;&gt; Also, as a side note, the search feature on the website doesn't seem
&gt;&gt; to allow me to search using documentation only.
&gt;
&gt; Hi Arthur,
&gt;
&gt; It sounds like you already have working and valid XML configuration files
&gt; saved somewhere.
&gt;
&gt; You may want to take a look at importing those XML configuration files (one
&gt; by one) directly into your new F13 setup.
&gt;
&gt; Look into the virsh "define" then "start" commands, used from the command
&gt; line.
&gt;
&gt; That should get you started.   There is plenty of info on the Net, in the man
&gt; pages, and in the Fedora 13 Virtualization Guide, about this.
&gt;
&gt; Hope that helps. :)
&gt;
&gt; Regards and best wishes,
&gt;
&gt; Justin Clift

I found out about `virsh define` from the IRC channel, and was able to
restore from there. However, going forward, I'm curious as to how
'everyone else' handles backup/restore: simple copy/snapshot?

-- 
Fedora 13
(www.pembo13.com)

</body></email><email><emailId>20100608184714</emailId><senderName>"Todd, John A"</senderName><senderEmail>john.todd@ca.com</senderEmail><timestampReceived>2010-06-08 18:47:14-0400</timestampReceived><subject>Re: [libvirt-users] upgrading from 0.7.2 to 0.8.1</subject><body>

I'm still interested in knowing what vbox:///system is, but I figured
out that I have manually specify -with-xen when building to get

Xen support.

If after I get the Xen development package and rebuild it still doesn't
work, I'll drop a line here.

 

- JT

 

From: Todd, John A 
Sent: Tuesday, June 08, 2010 1:39 PM
To: 'libvirt-users@redhat.com'
Subject: upgrading from 0.7.2 to 0.8.1

 

Hi, I had 0.7.2 running as an out-of-the-box version of libvirtd

I ran xend and it could connect to xen:/// (with virsh)

 

I'm trying to build a eucalyptus cloud and its not working, saying
'cannot connect to xen:///' and I don't know why.

So I figure I'd get the source and try and figure it out....and upgrade
while I was at it.

 

I got 0.8.1 from source, built it and installed it.  

First of all, it installed everything using /usr/local as its root, is
this configurable?

I mean doing that it left my 0.7.2 still there and I had to do some
magic to replace it with the new stuff.

 

Now it connects to vbox:///system fine, but can't see xen:///

What's vbox:///system anyway?

 

Could it be my xend is talking to old binaries? (though I don't know
what they would be exactly)

Is there some configuration (beyond the certificate stuff which I did to
get libvirt actually up and running) with 0.8.1 (or in general as
configuration for 0.7.2 was done behind the scene as part of OS install)

That I need to do so it can connect to xen:/// again?

 

I'm not subscribed to the list, please email responses directly to me at
todjo06@ca.com 

 

Thanks.

 

- Q


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:x="urn:schemas-microsoft-com:office:excel" \
xmlns:p="urn:schemas-microsoft-com:office:powerpoint" \
xmlns:a="urn:schemas-microsoft-com:office:access" \
xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882" \
xmlns:s="uuid:BDC6E3F0-6DA3-11d1-A2A3-00AA00C14882" \
xmlns:rs="urn:schemas-microsoft-com:rowset" xmlns:z="#RowsetSchema" \
xmlns:b="urn:schemas-microsoft-com:office:publisher" \
xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" \
xmlns:c="urn:schemas-microsoft-com:office:component:spreadsheet" \
xmlns:odc="urn:schemas-microsoft-com:office:odc" \
xmlns:oa="urn:schemas-microsoft-com:office:activation" \
xmlns:html="http://www.w3.org/TR/REC-html40" \
xmlns:q="http://schemas.xmlsoap.org/soap/envelope/" \
xmlns:rtc="http://microsoft.com/officenet/conferencing" xmlns:D="DAV:" \
xmlns:Repl="http://schemas.microsoft.com/repl/" \
xmlns:mt="http://schemas.microsoft.com/sharepoint/soap/meetings/" \
xmlns:x2="http://schemas.microsoft.com/office/excel/2003/xml" \
xmlns:ppda="http://www.passport.com/NameSpace.xsd" \
xmlns:ois="http://schemas.microsoft.com/sharepoint/soap/ois/" \
xmlns:dir="http://schemas.microsoft.com/sharepoint/soap/directory/" \
xmlns:ds="http://www.w3.org/2000/09/xmldsig#" \
xmlns:dsp="http://schemas.microsoft.com/sharepoint/dsp" \
xmlns:udc="http://schemas.microsoft.com/data/udc" \
xmlns:xsd="http://www.w3.org/2001/XMLSchema" \
xmlns:sub="http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/" \
xmlns:ec="http://www.w3.org/2001/04/xmlenc#" \
xmlns:sp="http://schemas.microsoft.com/sharepoint/" \
xmlns:sps="http://schemas.microsoft.com/sharepoint/soap/" \
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" \
xmlns:udcs="http://schemas.microsoft.com/data/udc/soap" \
xmlns:udcxf="http://schemas.microsoft.com/data/udc/xmlfile" \
xmlns:udcp2p="http://schemas.microsoft.com/data/udc/parttopart" \
xmlns:wf="http://schemas.microsoft.com/sharepoint/soap/workflow/" \
xmlns:dsss="http://schemas.microsoft.com/office/2006/digsig-setup" \
xmlns:dssi="http://schemas.microsoft.com/office/2006/digsig" \
xmlns:mdssi="http://schemas.openxmlformats.org/package/2006/digital-signature" \
xmlns:mver="http://schemas.openxmlformats.org/markup-compatibility/2006" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns:mrels="http://schemas.openxmlformats.org/package/2006/relationships" \
xmlns:spwp="http://microsoft.com/sharepoint/webpartpages" \
xmlns:ex12t="http://schemas.microsoft.com/exchange/services/2006/types" \
xmlns:ex12m="http://schemas.microsoft.com/exchange/services/2006/messages" \
xmlns:pptsl="http://schemas.microsoft.com/sharepoint/soap/SlideLibrary/" \
xmlns:spsl="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService" \
xmlns:Z="urn:schemas-microsoft-com:" xmlns:st="" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;meta http-equiv=Content-Type content="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 12 (filtered medium)"&gt;
&lt;style&gt;
&lt;!--
 /* Font Definitions */
 @font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
span.EmailStyle18
	{mso-style-type:personal-reply;
	font-family:"Calibri","sans-serif";
	color:#1F497D;}
.MsoChpDefault
	{mso-style-type:export-only;
	font-size:10.0pt;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.Section1
	{page:Section1;}
--&gt;
&lt;/style&gt;
&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapelayout v:ext="edit"&gt;
  &lt;o:idmap v:ext="edit" data="1" /&gt;
 &lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
&lt;/head&gt;

&lt;body lang=EN-US link=blue vlink=purple&gt;

&lt;div class=Section1&gt;

&lt;p class=MsoNormal&gt;&lt;span style='color:#1F497D'&gt;Im still interested in
knowing what vbox:///system is, but I figured out that I have manually specify \
with-xen when building to get&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='color:#1F497D'&gt;Xen support.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='color:#1F497D'&gt;If after I get the Xen
development package and rebuild it still doesnt work, Ill drop a
line here.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='color:#1F497D'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='color:#1F497D'&gt;- JT&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='color:#1F497D'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;div&gt;

&lt;div style='border:none;border-top:solid #B5C4DF 1.0pt;padding:3.0pt 0in 0in 0in'&gt;

&lt;p class=MsoNormal&gt;&lt;b&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;From:&lt;/span&gt;&lt;/b&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt; Todd, John A &lt;br&gt; \
&lt;b&gt;Sent:&lt;/b&gt; Tuesday, June 08, 2010 1:39 PM&lt;br&gt; &lt;b&gt;To:&lt;/b&gt; \
'libvirt-users@redhat.com'&lt;br&gt; &lt;b&gt;Subject:&lt;/b&gt; upgrading from 0.7.2 to \
0.8.1&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Hi, I had 0.7.2 running as an out-of-the-box version of
libvirtd&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;I ran xend and it could connect to xen:/// (with \
virsh)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Im trying to build a eucalyptus cloud and its not
working, saying cannot connect to xen:/// and I dont know
why.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;So I figure Id get the source and try and figure it
out.and upgrade while I was at it.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;I got 0.8.1 from source, built it and installed it. \
&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;First of all, it installed everything using /usr/local as
its root, is this configurable?&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;I mean doing that it left my 0.7.2 still there and I had to
do some magic to replace it with the new stuff.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Now it connects to vbox:///system fine, but cant see
xen:///&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Whats vbox:///system anyway?&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Could it be my xend is talking to old binaries? (though I
dont know what they would be exactly)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Is there some configuration (beyond the certificate stuff
which I did to get libvirt actually up and running) with 0.8.1 (or in general
as configuration for 0.7.2 was done behind the scene as part of OS \
install)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;That I need to do so it can connect to xen:/// \
again?&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Im not subscribed to the list, please email responses
directly to me at todjo06@ca.com &lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Thanks.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;- Q&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;



</body></email><email><emailId>20100609153747</emailId><senderName>DevOs Virt</senderName><senderEmail>osvdev@gmail.com</senderEmail><timestampReceived>2010-06-09 15:37:47-0400</timestampReceived><subject>[libvirt-users] unknown procedure: 159</subject><body>

Hi,
I started using libvirt few days back...while using virDomainMemoryStats
API, got "unknown procedure: 159"  runtime error

code is
-------------------------------------------------------------------------------------------------------------------------------------
 virDomainMemoryStatPtr statPtr;
statPtr = malloc(VIR_DOMAIN_MEMORY_STAT_NR* sizeof
(virDomainMemoryStatStruct));
unsigned int flags=0;
int Ret;
Ret = virDomainMemoryStats(domPtr,statPtr, VIR_DOMAIN_MEMORY_STAT_NR,flags);
-------------------------------------------------------------------------------------------------------------------------------------


Machine details:
------------------------------------------------------------------------------------------------------------------------------------
 [root@wlng-ppcore-nd3 hellolibvirt]# uname -a
Linux wlng-ppcore-nd3 2.6.18-194.el5 #1 SMP Tue Mar 16 21:52:39 EDT 2010
x86_64 x86_64 x86_64 GNU/Linux

[root@wlng-ppcore-nd3 hellolibvirt]# cat /etc/redhat-release
Red Hat Enterprise Linux Server release 5.5 (Tikanga)
------------------------------------------------------------------------------------------------------------------------------------



virsh details:

[root@wlng-ppcore-nd3 hellolibvirt]# virsh version
Compiled against library: libvir 0.8.1
Using library: libvir 0.8.1
Using API: QEMU 0.8.1
Running hypervisor: QEMU 0.9.1
------------------------------------------------------------------------------------------------------------------------------------
 There are two libvirtd installations here..
------------------------------------------------------------------------------------------------------------------------------------
 [root@wlng-ppcore-nd3 sbin]# pwd
/usr/sbin
[root@wlng-ppcore-nd3 sbin]# ls -l libvirtd
-rwxr-xr-x 1 root root 380064 Jun 10 02:33 libvirtd
[root@wlng-ppcore-nd3 sbin]# ./libvirtd --version
./libvirtd (libvirt) 0.6.3
------------------------------------------------------------------------------------------------------------------------------------
 [root@wlng-ppcore-nd3 sbin]# pwd
/usr/local/sbin
[root@wlng-ppcore-nd3 sbin]# ls -l
total 3084
-rwxr-xr-x 1 root root 3152977 Jun 10 01:25 libvirtd
[root@wlng-ppcore-nd3 sbin]# ./libvirtd --version
./libvirtd (libvirt) 0.8.1
------------------------------------------------------------------------------------------------------------------------------------


found a link which mentions libvirtd can be old hence this error is
possible... not sure how to configure the latest libvirtd?
How to solve "unknown procedure: 159"  runtime error?

Thanks,
osvdev


[Attachment #3 (text/html)]

Hi,&lt;br&gt;I started using libvirt few days back...while using virDomainMemoryStats API, \
got "unknown procedure: 159"  runtime error&lt;br&gt;&lt;br&gt;code is \
&lt;br&gt;-------------------------------------------------------------------------------------------------------------------------------------&lt;br&gt;
 virDomainMemoryStatPtr statPtr;&lt;br&gt;statPtr = malloc(VIR_DOMAIN_MEMORY_STAT_NR* \
sizeof (virDomainMemoryStatStruct));&lt;br&gt;unsigned int flags=0;&lt;br&gt;int Ret;&lt;br&gt;Ret = \
                virDomainMemoryStats(domPtr,statPtr, \
                VIR_DOMAIN_MEMORY_STAT_NR,flags);&lt;br&gt;
-------------------------------------------------------------------------------------------------------------------------------------&lt;br&gt;&lt;br&gt;Machine \
details:&lt;br&gt;------------------------------------------------------------------------------------------------------------------------------------&lt;br&gt;
 [root@wlng-ppcore-nd3 hellolibvirt]# uname -a&lt;br&gt;Linux wlng-ppcore-nd3 \
2.6.18-194.el5 #1 SMP Tue Mar 16 21:52:39 EDT 2010 x86_64 x86_64 x86_64 \
GNU/Linux&lt;br&gt;&lt;br&gt;[root@wlng-ppcore-nd3 hellolibvirt]# cat /etc/redhat-release&lt;br&gt; Red \
Hat Enterprise Linux Server release 5.5 \
(Tikanga)&lt;br&gt;------------------------------------------------------------------------------------------------------------------------------------&lt;br&gt;&lt;br&gt;&lt;br&gt;virsh \
details:&lt;br&gt;&lt;br&gt; [root@wlng-ppcore-nd3 hellolibvirt]# virsh version&lt;br&gt;Compiled \
against library: libvir 0.8.1&lt;br&gt;Using library: libvir 0.8.1&lt;br&gt;Using API: QEMU \
0.8.1&lt;br&gt;Running hypervisor: QEMU \
0.9.1&lt;br&gt;------------------------------------------------------------------------------------------------------------------------------------&lt;br&gt;
 There are two libvirtd installations \
here..&lt;br&gt;---------------------------------------------------------------------------- \
--------------------------------------------------------&lt;br&gt;[root@wlng-ppcore-nd3 \
sbin]# pwd&lt;br&gt;/usr/sbin&lt;br&gt; [root@wlng-ppcore-nd3 sbin]# ls -l libvirtd&lt;br&gt;-rwxr-xr-x \
1 root root 380064 Jun 10 02:33 libvirtd&lt;br&gt;[root@wlng-ppcore-nd3 sbin]# ./libvirtd \
--version&lt;br&gt;./libvirtd (libvirt) \
0.6.3&lt;br&gt;------------------------------------------------------------------------------------------------------------------------------------&lt;br&gt;
 [root@wlng-ppcore-nd3 sbin]# pwd&lt;br&gt;/usr/local/sbin&lt;br&gt;[root@wlng-ppcore-nd3 sbin]# \
ls -l&lt;br&gt;total 3084&lt;br&gt;-rwxr-xr-x 1 root root 3152977 Jun 10 01:25 \
libvirtd&lt;br&gt;[root@wlng-ppcore-nd3 sbin]# ./libvirtd --version&lt;br&gt;./libvirtd (libvirt) \
                0.8.1&lt;br&gt;
------------------------------------------------------------------------------------------------------------------------------------&lt;br&gt;&lt;br&gt;found \
a link which mentions libvirtd can be old hence this error is possible... not sure \
how to configure the latest libvirtd? &lt;br&gt; How to solve "unknown procedure: \
159"  runtime error? &lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;osvdev&lt;br&gt;&lt;br&gt;



</body></email><email><emailId>20100609171422</emailId><senderName>Camilo Aguilar</senderName><senderEmail>camilo@cloudescape.com</senderEmail><timestampReceived>2010-06-09 17:14:22-0400</timestampReceived><subject>Re: [libvirt-users] about virDomainSave and virDomainRestore</subject><body>

sorry, that's a dumb question. don't answer please :$

On Wed, Jun 9, 2010 at 1:12 PM, Camilo Aguilar &lt;camilo@cloudescape.com&gt;wrote:

&gt; Hi there,
&gt;
&gt; There is some special reason to require a virConnectPtr param in
&gt; virDomainRestore ?
&gt;
&gt; Regards,
&gt;
&gt; Camilo
&gt;
&gt;
&gt;
&gt;

[Attachment #3 (text/html)]

sorry, that's a dumb question. don't answer please :$&lt;br&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;On Wed, Jun 9, 2010 at 1:12 PM, Camilo Aguilar &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:camilo@cloudescape.com"&gt;camilo@cloudescape.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;

&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt;Hi there,  &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;There is some special reason \
to require a virConnectPtr param in virDomainRestore ?&lt;/div&gt;

&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,  &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;font \
color="#888888"&gt;&lt;div&gt;Camilo&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;  &lt;/div&gt; \
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20100609202917</emailId><senderName>Dave Allan</senderName><senderEmail>dallan@redhat.com</senderEmail><timestampReceived>2010-06-09 20:29:17-0400</timestampReceived><subject>Re: [libvirt-users] Multipath pools - practical for use?</subject><body>

On Thu, Jun 10, 2010 at 03:17:49AM +1000, Justin Clift wrote:
&gt; Hi all,
&gt; 
&gt; Writing up some Fedora documentation, and looking to figure out the
&gt; best way of mapping multipath network(!) LUNs to pools in libvirt.
&gt; 
&gt;   ie Infiniband SRP LUNs, but would probably apply to Fibre Channel
&gt;      equally as well.

I'm assuming you're talking about the device mapper multipath
implementation...

I've only used multipath with Fibre Channel and iSCSI, but I presume
the Infiniband SRP LUNs produce the same entries in /dev/mapper that
other transports do.

&gt; There are two approaches I can think of easily:
&gt; 
&gt;  a) Large LUNs (ie TB+) that are mapped to a host server as disk, with
&gt;     each LUN being configured as an LVM pool.  This lets the host
&gt;     slice the pool up into volumes with the libvirt volume creation
&gt;     commands.

That's a valid way to do it.

&gt;  b) Pre-purposed LUNs mapped to a host server as disk, but passed
&gt;     through directly to their respective guests.
&gt; 
&gt;     ie Something like Oracle, with 3 SAN LUNs mapped to guest FOO for
&gt;        its database data

That's also valid.

&gt; In a non-libvirt world I'd look at configuring the LUNs on the host
&gt; with persistent name using multipath, then present them
&gt; appropriately to whatever needs them from there.

Using a persistent name is the definitely the way to do it with or
without libvirt.

&gt; However, libvirt has a pool type called "multipath".  Looking at the
&gt; docs online, it doesn't appear to be all that fully featured at this
&gt; point.  Seems more of a brief mention and footnote, so I'm wondering
&gt; whether to use it or skip it for now in the Fedora docs.
&gt; 
&gt; Anyone have thoughts/suggestions/etc? :)

The multipath pool is syntactic sugar, basically.  It's used to get a
list of multipath devices on a host easily.  The multipath devices can
then (as you suggest above) be carved up into disk or logical pools,
or assigned straight to VMs.

It's probably most useful when VMs are intended to use only the
multipath devices on a physical host.  I.e., the set of volumes in the
multipath pool is equivalent or nearly equivalent to the set of
devices that are intended to be assigned to VMs.

One design decision was to keep multipath support simple and that
libvirt should not attempt to configure multipath, so at the time that
the physical host's OS is installed, it needs to have its blacklist
set, and should have (again as you suggest above) user_friendly_names
set to no.  Those should be one-time tasks.

Dave

</body></email><email><emailId>20100610224042</emailId><senderName>jeremy avnet</senderName><senderEmail>brainsik+libvirt@saucelabs.com</senderEmail><timestampReceived>2010-06-10 22:40:42-0400</timestampReceived><subject>Re: [libvirt-users] Missing target dev for interface</subject><body>

On Wed, Jun 9, 2010 at 1:38 AM, Daniel P. Berrange &lt;berrange@redhat.com&gt; wrote:
&gt; I guess you restarted libvirtd - there was a bug that causes it to
&gt; forget the interface name if you restart it.

Is there a way of reminding it? :-/

Thanks for your response.
.:. jeremy

</body></email><email><emailId>20100503024408</emailId><senderName>"Development"</senderName><senderEmail>development@simulamen.eu</senderEmail><timestampReceived>2010-05-03 02:44:08-0400</timestampReceived><subject>Re: [libvirt-users] Windows Vista Client Fails to Connect to Ubuntu	libvirtd</subject><body>

Matthias,

Excellent!  Now up and running.  I believe the crucial element was

listen_tls = 0

Once again, thank you very much for your help...

Tim

-----Original Message-----
From: libvirt-users-bounces@redhat.com [mailto:libvirt-users-bounces@redhat.com] On \
                Behalf Of Matthias Bolte
Sent: 01 May 2010 08:33
To: tim.mcleod@simulamen.eu
Cc: libvirt-users@redhat.com
Subject: Re: [libvirt-users] Windows Vista Client Fails to Connect to Ubuntu libvirtd

2010/4/30 Tim McLeod &lt;tim.mcleod@simulamen.eu&gt;:
&gt; Requesting urgent assistance if I may?
&gt; 
&gt; Attempting to connect to an Ubuntu machine using an MinMG compiled virsh on
&gt; a Windows Vista machine.  Using insecure TCP simply to prove a concept to a
&gt; client.  However, cannot connect; situation as follows:
&gt; 
&gt; Edited /etc/libvirt/libvirt.conf as follows:
&gt; listen_tcp = 1
&gt; auth_tcp = "none"
&gt; 
&gt; Edited /etc/default//libvirt-bin as follows:
&gt; libvirt-opts="-d -l"

Did you restart libvirtd after the changes and checked that it's
started successfully?

listen_tls defaults to 1 in /etc/libvirt/libvirt.conf, in combination
with the -l flag (short for --listen) libvirtd requires properly
configured SSL certificates. If libvirtd can't find the certificates
or fails to validate them then it won't start up.

You can disable TLS in /etc/libvirt/libvirt.conf by setting listen_tls
= 0 and restart libvirtd.

&gt; Running virsh on Vista client fails as follows:
&gt; $ virsh -c qemu+tcp://192.168.1.101/system
&gt; error: unable to connect to libvirtd at '192.168.1.101': errno=10061
&gt; error: failed to connect to the hypervisor
&gt; 
&gt; Running virsh on Ubuntu server fails as follows:
&gt; $ virsh -c qemu+tcp:///system
&gt; Connecting to uri: qemu+tcp:///system
&gt; error: unable to connect to libvirtd at 'localhost': Connection refused
&gt; error: failed to connect to the hypervisor

Once libvirtd is running and configured properly for TCP transport
then remote and local TCP access to libvirtd works for me.

&gt; Indeed, with libvirt-opts="-d -l" in etc/default//libvirt-bin the 'default'
&gt; command also fails:
&gt; $ virsh -c qemu:///system
&gt; Connecting to uri: qemu:///system
&gt; error: unable to connect to 'var/run/libvirt/libvirt-sock': Connection
&gt; refused
&gt; error: failed to connect to the hypervisor
&gt; 

Local access to libvirtd using qemu:///system requires properly
configured polkit, or running virsh as root. This is independent from
the -d and -l flags.

Matthias

_______________________________________________
libvirt-users mailing list
libvirt-users@redhat.com
https://www.redhat.com/mailman/listinfo/libvirt-users


</body></email><email><emailId>20100503200545</emailId><senderName>Ralf Hornik Mailings</senderName><senderEmail>ralf@best.homeunix.org</senderEmail><timestampReceived>2010-05-03 20:05:45-0400</timestampReceived><subject>Re: [libvirt-users] Issues after migrating from Xen to KVM</subject><body>

Chris Lalancette schrieb:
&gt; What's the actual problem you are having with the CentOS guest? What 
&gt; kind of
&gt; error messages do you see?
Actually, the guest starts without errors and its state is "running".
When I enable debug in libvirtd anything seems fine (for qemu) except:

 info : qemudDispatchSignalEvent:399 : Received unexpected signal 17

But thats common with other working guests.

Stange...I enabled vnc to see more on boottime and now it boots with 
console and vnc.
When I disable vnc, the guest freezes on boot again...

Here is my config (just curious):

&lt;domain type='kvm'&gt;
  &lt;name&gt;ca&lt;/name&gt;
  &lt;uuid&gt;866202ce-2696-3708-607e-a0b8351a2dae&lt;/uuid&gt;
  &lt;memory&gt;262144&lt;/memory&gt;
  &lt;currentMemory&gt;262144&lt;/currentMemory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='x86_64'&gt;hvm&lt;/type&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
  &lt;/features&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;destroy&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/bin/qemu-system-x86_64&lt;/emulator&gt;
    &lt;disk type='block' device='disk'&gt;
      &lt;source dev='/dev/xen_vol/xen_ca'/&gt;
      &lt;target dev='hda' bus='ide'/&gt;
      &lt;address type='drive' controller='0' bus='0' unit='0'/&gt;
    &lt;/disk&gt;
    &lt;controller type='ide' index='0'/&gt;
    &lt;interface type='ethernet'&gt;
      &lt;mac address='00:16:3e:04:f5:6d'/&gt;
      &lt;target dev='tap1'/&gt;
    &lt;/interface&gt;
&lt;!--    &lt;hostdev mode='subsystem' type='pci' managed='yes'&gt;
      &lt;source&gt;
        &lt;address domain='0x0000' bus='0x00' slot='0x1d' function='0x1'/&gt;
      &lt;/source&gt;
    &lt;/hostdev&gt;
--&gt;
    &lt;console type='pty'&gt;
      &lt;target port='0'/&gt;
    &lt;/console&gt;
    &lt;graphics type='vnc' listen='0.0.0.0' port='5900'/&gt;
  &lt;/devices&gt;
&lt;/domain&gt;

Best regards

Ralf

</body></email><email><emailId>20100503201943</emailId><senderName>Tom Georgoulias</senderName><senderEmail>tomg@mcclatchyinteractive.com</senderEmail><timestampReceived>2010-05-03 20:19:43-0400</timestampReceived><subject>Re: [libvirt-users] using shared storage with libvirt/KVM?</subject><body>

On 05/03/2010 10:57 AM, David Ehle wrote:

&gt; I've spent a few days googling and reading documentation, but I'm looking for
&gt; clarification and advise on setting up KVM/libvirt with shared storage.

I, too, have been looking at these kinds of setups in the last few 
weeks, and I've found myself confused about the stack more than once. 
The documentation is very scattered and incomplete in key areas (as you 
pointed out with the RHEL docs on shared storage), which makes it tough 
on a new user.  Here's what I can share, I hope this encourages others 
to join in and help us both out.

&gt; I am trying to figure out the best way to set things up so that I can run
&gt; several (eventually) production linux guests (mostly debian stable) on the 2
&gt; KVM host systems and be able to migrate them when maintenance is required on
&gt; their hosts.

  From the small testing I've done, making an iscsi based storage pool 
and using it to store the VMs between the two KVM hosts.

&gt; A common opinion seems to be that using LVs to hold disk images gives possibly
&gt; the best IO performance, followed by raw, then qcow2.
&gt; 
&gt; Would you agree or disagree with this? What evidence can you provide?

That's probably right, but I think those are more relevant when you are 
using non-shared storage, like images on your local disk or perhaps on a 
shared mount.

&gt; I have succesfully made an iscsi device available to libvirt/virsh/virt-manager
&gt; via an XML file + pool-define + pool-start. However the documentation states
&gt; that while you can create pools through libvirt, volumes have to be
&gt; pre-allocated:
&gt; http://libvirt.org/storage.html
&gt; "Volumes must be pre-allocated on the iSCSI server, and cannot be created via
&gt; the libvirt APIs."
&gt; 
&gt; I'm very unclear on what this means in general, and specifically how you
&gt; preallocate the the Volumes.

I believe this means you will need to create the LUNs on the storage and 
present them to libvirt, but libvirt cannot talk back to the storage 
system and create the targets/LUNs for you as you try to spin up new VMs.

&gt; If you are using shared storage (via NFS or iSCSI) does that also mean you MUST
&gt; use a file based image rather than an LVM LV?

No, you can use iscsi and treat the storage as a raw disk.

&gt; Redhat provides pretty good documentation on doing shared storage/live
&gt; migration for NFS:
&gt; http://www.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/5.4/html/Virtualization_Guide/chap-Virtualization-KVM_live_migration.html
&gt;  But unfortunately the section on Shared Storage with iSCSI is a bit lacking:
&gt; "9.1. Using iSCSI for storing guests
&gt; This section covers using iSCSI-based devices to store virtualized guests." and
&gt; thats it.

I know!  How frustrating!  Even the RHEL6 beta document is missing those 
sections...

Here's what I've documented for my initial test run.  I hope this helps 
you get started, please note that I changed the IPs and iqn's to prevent 
sharing private data on the list.

1. Create a LUN on your shared storage system &amp; get the iqn.

iqn.long.long.long:a6c98a7e-0275-c020-efae-a386dfd46b84

2. From the KVM host, scan for the newly created target

# iscsiadm -m discovery -t sendtargets -p &lt;shared storage FQDN&gt;

1.2.3.4:3260,2 iqn.long.long.long:a6c98a7e-0275-c020-efae-a386dfd46b84

There it is, *84.

3. Write the XML config describing the storage we will add to the 
storage pool, using the iqn from step 2.

&lt;pool type="iscsi"&gt;
    &lt;name&gt;lun1&lt;/name&gt;
    &lt;source&gt;
      &lt;host name="storage hostname"/&gt;
      &lt;device 
path="iqn.long.long.long:a6c98a7e-0275-c020-efae-a386dfd46b84"/&gt;
    &lt;/source&gt;
    &lt;target&gt;
      &lt;path&gt;/dev/disk/by-path&lt;/path&gt;
    &lt;/target&gt;
&lt;/pool&gt;

4. Import that XML to define the pool:

# virsh pool-define /tmp/lun1.xml
Pool lun1 defined from lun1.xml

5. Verify:
# virsh pool-info lun1
Name:           lun1
UUID:           701a1401-547a-08da-5f14-befea84778d9
State:          inactive

6. Start the pool so we can use it

# virsh pool-start lun1
Pool lun1 started

7. List the volume names in the new pool so we'll know what to pass 
along to virt-install to use it:

# virsh vol-list lun1
Name                 Path
-----------------------------------------
10.0.0.0 
/dev/disk/by-path/ip-1.2.3.4:3260-iscsi-iqn.long.long.long:a6c98a7e-0275-c020-efae-a386dfd46b84-lun-0


virsh # vol-info --pool lun1 10.0.0.0
Name:           10.0.0.0
Type:           block
Capacity:       20.00 GB
Allocation:     20.00 GB


8. Install the VM with virt-install and use "--disk 
vol=lun1/10.0.0.0,size=20" to access the storage

[root@rvrt010d ~]# virt-install &lt;all of your options&gt;
--disk vol=lun1/10.0.0.0,size=20

After that's up and running, your VM will use the shared storage as if 
it is a local disk.

9.  If you repeat steps 2-6 on your other KVM host, the storage will be 
shared between both hosts.  Now you are setup for migration, either 
offline or live.

# virsh migrate VM qemu+ssh://other.kvm.host/system

&gt; For maybe 6-10 guests, should I simply just be using NFS? Is its performance
&gt; that much worse than iSCSI for this task?

This totally depends on your network and hardware, but here's how a dd 
test over NFS and iSCSI compared in my setup:

iSCSI
run     throughput
01       24.5 MB/s
02       25.7 MB/s
03       52.4 MB/s
04       56.5 MB/s
05       57.7 MB/s
06       56.2 MB/s
07       51.5 MB/s
08       57.8 MB/s
09       57.3 MB/s
10       55.8 MB/s

NFS
run     throughput
01       34.5 MB/s
02       35.2 MB/s
03       36.2 MB/s
04       41.2 MB/s
05       39.2 MB/s
06       39.2 MB/s
07       36.2 MB/s
08       34.8 MB/s
09       36.7 MB/s
10       40.4 MB/s

I hope this helps, and I hope that someone corrects any errors I may 
have made.  :)

Tom


</body></email><email><emailId>20100504163230</emailId><senderName>"Jonathan Hoover"</senderName><senderEmail>jhoover@devonshire-realty.com</senderEmail><timestampReceived>2010-05-04 16:32:30-0400</timestampReceived><subject>[libvirt-users] libvirt with qemu-kvm, not recognizing NIC model</subject><body>

Is this the right list for this question, or should I be elsewhere?

 

I am trying to specify a network card "model type" of "pcnet" (to
emulate vmware esxi's network card). No matter what I put for model type
in my xml config file, it comes up as an Intel e1000. I ran "qemu-kvm
-net nic,model=? /dev/null" and I got back a list of supported models
including pcnet,e1000,virtio, and others as expected. No matter which I
put in my xml file for /etc/libvirt/qemu/Symantec-bg.xml (a Symantec
Brightmail Gateway virtual machine), I just get back that its an Intel
card on boot (which doesn't work with Symantec BG).

 

I am running Fedora 12, kernel is 2.6.31.6-166.fc12.x86_64. The version
of libvirt is 0.7.1. I am running it on an Intel Core 2 Quad CPU Q8400 @
2.66 GHz. I have the same problem under Fedora 13 Beta.

 

Thoughts?
Jonathan Hoover


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:x="urn:schemas-microsoft-com:office:excel" \
xmlns:p="urn:schemas-microsoft-com:office:powerpoint" \
xmlns:a="urn:schemas-microsoft-com:office:access" \
xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882" \
xmlns:s="uuid:BDC6E3F0-6DA3-11d1-A2A3-00AA00C14882" \
xmlns:rs="urn:schemas-microsoft-com:rowset" xmlns:z="#RowsetSchema" \
xmlns:b="urn:schemas-microsoft-com:office:publisher" \
xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" \
xmlns:c="urn:schemas-microsoft-com:office:component:spreadsheet" \
xmlns:odc="urn:schemas-microsoft-com:office:odc" \
xmlns:oa="urn:schemas-microsoft-com:office:activation" \
xmlns:html="http://www.w3.org/TR/REC-html40" \
xmlns:q="http://schemas.xmlsoap.org/soap/envelope/" \
xmlns:rtc="http://microsoft.com/officenet/conferencing" xmlns:D="DAV:" \
xmlns:Repl="http://schemas.microsoft.com/repl/" \
xmlns:mt="http://schemas.microsoft.com/sharepoint/soap/meetings/" \
xmlns:x2="http://schemas.microsoft.com/office/excel/2003/xml" \
xmlns:ppda="http://www.passport.com/NameSpace.xsd" \
xmlns:ois="http://schemas.microsoft.com/sharepoint/soap/ois/" \
xmlns:dir="http://schemas.microsoft.com/sharepoint/soap/directory/" \
xmlns:ds="http://www.w3.org/2000/09/xmldsig#" \
xmlns:dsp="http://schemas.microsoft.com/sharepoint/dsp" \
xmlns:udc="http://schemas.microsoft.com/data/udc" \
xmlns:xsd="http://www.w3.org/2001/XMLSchema" \
xmlns:sub="http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/" \
xmlns:ec="http://www.w3.org/2001/04/xmlenc#" \
xmlns:sp="http://schemas.microsoft.com/sharepoint/" \
xmlns:sps="http://schemas.microsoft.com/sharepoint/soap/" \
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" \
xmlns:udcs="http://schemas.microsoft.com/data/udc/soap" \
xmlns:udcxf="http://schemas.microsoft.com/data/udc/xmlfile" \
xmlns:udcp2p="http://schemas.microsoft.com/data/udc/parttopart" \
xmlns:wf="http://schemas.microsoft.com/sharepoint/soap/workflow/" \
xmlns:dsss="http://schemas.microsoft.com/office/2006/digsig-setup" \
xmlns:dssi="http://schemas.microsoft.com/office/2006/digsig" \
xmlns:mdssi="http://schemas.openxmlformats.org/package/2006/digital-signature" \
xmlns:mver="http://schemas.openxmlformats.org/markup-compatibility/2006" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns:mrels="http://schemas.openxmlformats.org/package/2006/relationships" \
xmlns:spwp="http://microsoft.com/sharepoint/webpartpages" \
xmlns:ex12t="http://schemas.microsoft.com/exchange/services/2006/types" \
xmlns:ex12m="http://schemas.microsoft.com/exchange/services/2006/messages" \
xmlns:pptsl="http://schemas.microsoft.com/sharepoint/soap/SlideLibrary/" \
xmlns:spsl="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService" \
xmlns:Z="urn:schemas-microsoft-com:" xmlns:st="" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;meta http-equiv=Content-Type content="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 12 (filtered medium)"&gt;
&lt;style&gt;
&lt;!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.Section1
	{page:Section1;}
--&gt;
&lt;/style&gt;
&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapelayout v:ext="edit"&gt;
  &lt;o:idmap v:ext="edit" data="1" /&gt;
 &lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
&lt;/head&gt;

&lt;body lang=EN-US link=blue vlink=purple&gt;

&lt;div class=Section1&gt;

&lt;p class=MsoNormal&gt;Is this the right list for this question, or should I be
elsewhere?&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;I am trying to specify a network card model type
of pcnet (to emulate vmware esxis network card). No matter
what I put for model type in my xml config file, it comes up as an Intel e1000.
I ran qemu-kvm net nic,model=? /dev/null and I got back a
list of supported models including pcnet,e1000,virtio, and others as expected.
No matter which I put in my xml file for /etc/libvirt/qemu/Symantec-bg.xml (a \
Symantec Brightmail Gateway virtual machine), I just get back that its an Intel card \
on boot (which doesnt work with Symantec BG).&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;I am running Fedora 12, kernel is 2.6.31.6-166.fc12.x86_64.
The version of libvirt is 0.7.1. I am running it on an Intel Core 2 Quad CPU
Q8400 @ 2.66 GHz. I have the same problem under Fedora 13 Beta.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Thoughts?&lt;br&gt;
Jonathan Hoover&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;



</body></email><email><emailId>20100504194022</emailId><senderName>"Hugh O. Brock"</senderName><senderEmail>hbrock@redhat.com</senderEmail><timestampReceived>2010-05-04 19:40:22-0400</timestampReceived><subject>Re: [libvirt-users] Building &amp; Installing on OpenSolaris</subject><body>

On Tue, Apr 27, 2010 at 10:55:58AM +0200, Daniel Veillard wrote:
&gt; On Tue, Apr 27, 2010 at 10:29:40AM +0200, Matthias Bolte wrote:
&gt; &gt; 2010/4/27 Daniel Veillard &lt;veillard@redhat.com&gt;:
&gt; &gt; &gt; On Mon, Apr 26, 2010 at 10:24:33PM -0600, gary mazzaferro wrote:
&gt; &gt; &gt;  Yup seems both multipath and bridge support need to be desactivated to
&gt; &gt; &gt; build on Solaris,
&gt; &gt; &gt;
&gt; &gt; &gt; Daniel
&gt; &gt; &gt;
&gt; &gt; 
&gt; &gt; Totally off-topic... but is there a special reason you write
&gt; &gt; 'desactivated' instead of 'deactivated'? In the other mail I just
&gt; &gt; accepted it as a typo, but now it looks like a habit :)
&gt; 
&gt;  Frenchism - the verb is "desactiver" - and as everybody knows, all
&gt; proper english derivates from Latin/French (I have Normand blood :-)
&gt; 
&gt;   So yeah, I'm making that mistake without even noticing, thanks !
&gt; 
&gt; Daniel

/me resists the urge to quote Churchill...

--Hugh

&gt; 
&gt; -- 
&gt; Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
&gt; daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
&gt; http://veillard.com/ | virtualization library  http://libvirt.org/
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

-- 
========================================================
Hugh Brock, hbrock@redhat.com, +1-215-564-3232
Deltacloud API + Portal http://deltacloud.org
Libvirt virtualization library http://libvirt.org
========================================================

</body></email><email><emailId>20100505205143</emailId><senderName>David Ehle</senderName><senderEmail>ehle@agni.phys.iit.edu</senderEmail><timestampReceived>2010-05-05 20:51:43-0400</timestampReceived><subject>Re: [libvirt-users] FYI: Notes on setting up KVM guests using iSCSI</subject><body>


Daniel,

Thank you.  I was misunderstanding how iscsi iSCSI Enterprise Target 
Daemon /ietd.conf work. I was setting up multiple targets with only one 
LUN each, and thinking I was creating multiple LUNs on the same target.

So right way to set up multiple LUNS for one target under Ubuntu Karmic 
using iSCSI Enterprise Target via ietd.conf:

Target iqn.2010-04.gov.blah.blah.blah.keeper:vmstorage
 	&lt;SNIP&gt;
         # Logical Unit definition
         # You must define one logical unit at least.
         # Block devices, regular files, LVM, and RAID can be offered
         # to the initiators as a block device.
         Lun 0 Path=/dev/vg0/iscsi_pool,Type=fileio
         Lun 1 Path=/dev/vg0/test_pool,Type=fileio
         # Alias name for this target
         Alias VMStoragePool
 	&lt;SNIP&gt;

&lt;NOT&gt;

Target iqn.2010-04.gov.blah.blah.blah.keeper:vmstorage.lun0
 	Lun 0 Path=/dev/vg0/iscsi_pool,Type=fileio
 	ALIAS LUN0
Target iqn.2010-04.gov.blah.blah.blah.keeper:vmstorage.lun1
 	Lun 1 Path=/dev/vg0/test_pool,Type=fileio
 	ALIAS LUN1
&lt;/NOT&gt;


To add additional volumes, additional LUNs will need to be created on the 
TARGET side, and then exported via iSCSI

After correcting my Target side configuration, I was able to create an 
iSCSI pool through virt-manager, and see the two LUNs as available 
volumes.


  On Wed, 5 May 2010, Daniel P. Berrange wrote:

&gt; On Wed, May 05, 2010 at 08:50:57AM -0500, David Ehle wrote:
&gt; &gt; 
&gt; &gt; Daniel,
&gt; &gt; 
&gt; &gt; OK so I think I get it now. While for other storage backends one pool can
&gt; &gt; hold multiple volumes, when using iSCIS there is alwasy a 1 to 1
&gt; &gt; relationship for pool to volume? Each pool contains exactly one volume?
&gt; 
&gt; No, each pool can contain multiple volumes. If you have created a iSCSI
&gt; target and given it multiple LUNs, then you'll see multiple volumes in
&gt; libvirt.
&gt; 
&gt; See the virsh vol-list output in this example:
&gt; 
&gt; &gt; &gt; http://berrange.com/posts/2010/05/05/provisioning-kvm-virtual-machines-on-iscsi-the-hard-way-part-2-of-2/
&gt; &gt; &gt; 
&gt; 
&gt; for an iSCSI target with 2 LUNs
&gt; 
&gt; Daniel
&gt; -- 
&gt; &gt; &gt; Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
&gt; &gt; &gt; http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
&gt; &gt; &gt; http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
&gt; &gt; &gt; GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|
&gt; 


</body></email><email><emailId>20100506003537</emailId><senderName>Claude Noshpitz</senderName><senderEmail>cnoshpitz@attinteractive.com</senderEmail><timestampReceived>2010-05-06 00:35:37-0400</timestampReceived><subject>Re: [libvirt-users] weird "no supported architecture for os type 'hvm'"</subject><body>

Yay, problem self-solved!

&gt; 
&gt; I have two identical machines with exactly the same CentOS 5.4 kickstarted
&gt; from the same sources, and the same packages installed. Their cpuinfos are
&gt; identical, and they are running libvirt 0.6.3 with the very same
&gt; libvirtd.conf.
&gt; 

Turns out permissions on /dev/kvm have to be root:kvm, not root:root.
For some reason this automagically happened on one install but not the
other.  Any idea why?

Ah well.

--Claude



</body></email><email><emailId>20100506144353</emailId><senderName>guido</senderName><senderEmail>guido-libvi@unknownsite.de</senderEmail><timestampReceived>2010-05-06 14:43:53-0400</timestampReceived><subject>Re: [libvirt-users] libvirtd loses all of its data after restart</subject><body>

Am Mittwoch, 5. Mai 2010 schrieben Sie:
&gt; The version of libvirtd you have does not support seemless restarts of
&gt; the daemon  process while resources are active. You should shutdown all
&gt; guests / storage pools before restarting the libvirtd daemon, or better
&gt; yet, don't restart it at all.

What if it crashes?

&gt; libvirt 0.7.x was the first series supporting restarts with stuff running

Okay, I've upgraded to libvirt 0.7, (this time on Fedora 12), but there are 
still problems. Running and defined virtual machines now persist across 
restarts, but storage pools and networks still disappear.

What's worse, trying to define the networks that disappeared again (so that I 
can continue using them to create new vms) fails because the bridge by that 
and the dnsmasq process on that ip/port combination obviously already exist.

        Guido

PS: Sorry, I originally sent the reply directly to you instead of the mailing 
list without realizing it.

-- 
Too much multitasking isn't good for you.

</body></email><email><emailId>20100506185024</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-05-06 18:50:24-0400</timestampReceived><subject>Re: [libvirt-users] Full documentation for virsh?</subject><body>

On 05/05/2010 04:15 PM, David Ehle wrote:
&gt; 
&gt; Hello,
&gt; 
&gt; Does anyone know where full documentation for virsh can be found? Or if 
&gt; the there are any plans to update the man page?
&gt; 
&gt; The man page lists far fewer commands than virsh lists from its 
&gt; interactive mode when you type help.
&gt; 
&gt; I noticed this when I was trying to figure out the difference between 
&gt; pool-destroy, and pool-delete. The help entries in the virsh shell are not 
&gt; very informative:
&gt; virsh # help pool-destroy
&gt;    NAME
&gt;      pool-destroy - destroy a pool
&gt; 
&gt;    SYNOPSIS
&gt;      pool-destroy &lt;pool&gt;
&gt; 
&gt;    DESCRIPTION
&gt;      Destroy a given pool.
&gt; 
&gt;    OPTIONS
&gt;      &lt;pool&gt;           pool name or uuid
&gt; 
&gt; virsh # help pool-delete
&gt;    NAME
&gt;      pool-delete - delete a pool
&gt; 
&gt;    SYNOPSIS
&gt;      pool-delete &lt;pool&gt;
&gt; 
&gt;    DESCRIPTION
&gt;      Delete a given pool.
&gt; 
&gt;    OPTIONS
&gt;      &lt;pool&gt;           pool name or uuid
&gt; 
&gt; ... unless you already know how virsh defines delete vs destroy.

In libvirt terminology, 'destroy' means 'force shutdown'. This has
different meanings for different things. For a VM, it is like pulling
out the power plug. For a directory pool, it just marks the pool as
'inactive'. For an NFS pool, it will actually unmount the NFS share from
the host running libvirt.

pool-delete will actually delete the underlying storage, so for a
directory pool this will actually remove the directory from the disk.

If you just want to tell libvirt to 'forget' about a pool and not list
it anymore, use pool-undefine. This is a safe operation and will not
harm any of your underlying storage.

- Cole

</body></email><email><emailId>20100507134648</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2010-05-07 13:46:48-0400</timestampReceived><subject>Re: [libvirt-users] migration using libvirt api</subject><body>

On 05/04/2010 12:27 AM, rahul singh wrote:
&gt; Hello,
&gt; 
&gt;      I am working on xen hypervisor. I am facing problem in migating   
&gt; vm locally on same system using libvirt api. please help me with some c
&gt; sample codes. Please send some demo programs or some related help how to
&gt; migrate a vm locally using libvirt api.

Localhost migration is not something that libvirt supports at present.  It
does present problems in that you are re-entering the same libvirtd, so
locking can easily become screwed up, so it's unclear whether we will ever
support it.

-- 
Chris Lalancette

</body></email><email><emailId>20100401211325</emailId><senderName>Dave Allan</senderName><senderEmail>dallan@redhat.com</senderEmail><timestampReceived>2010-04-01 21:13:25-0400</timestampReceived><subject>Re: [libvirt-users] iSCSI supported initiators</subject><body>

On 04/01/2010 04:55 PM, Alexander Pierce wrote:
&gt; What initiators does libvirt support for the iSCSI pool?  Will it work with \
&gt; qlogic's iSCSI HBAs for instance?

The iscsi pool type supports only open-iscsi using iscsiadm.

However, libvirt's scsi pool type supports any scsi adapter.  If the 
qlogic card looks like any other HBA to the OS, the scsi pool type can 
be used to discover the volumes available through it.  See:

http://libvirt.org/storage.html#StorageBackendSCSI

The configuration of the card will have to be done by means outside libvirt.

Dave


</body></email><email><emailId>20100401212732</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-04-01 21:27:32-0400</timestampReceived><subject>Re: [libvirt-users] connect libvirt and virtualbox</subject><body>

I get similar messages when I use

   virsh -c vbox:///session

It just tells you that it failed to connect to libvirtd while it was
searching for an interface and node driver. This is okay. The
connection can be used without those drivers.

Matthias

2010/4/1 angelo alfano &lt;angeloalfa76@yahoo.it&gt;:
&gt; I have installed virtualbox 3.0.14 and libvirt 0.7.0, error:
&gt;
&gt; libvir: Remote error : unable to connect to '/var/run/libvirt/libvirt-sock':
&gt; Connection refused
&gt; libvir: warning : Failed to find the interface: Is the daemon running ?
&gt; libvir: Remote error : unable to connect to '/var/run/libvirt/libvirt-sock':
&gt; Connection refused
&gt; libvir: Remote error : unable to connect to '/var/run/libvirt/libvirt-sock':
&gt; Connection refused
&gt; libvir: warning : Failed to find a node driver: Is the libvirtd daemon
&gt; running ?
&gt;
&gt;
&gt; ________________________________
&gt; Da: Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;
&gt; A: angelo alfano &lt;angeloalfa76@yahoo.it&gt;
&gt; Cc: libvirt mail-list &lt;libvirt-users@redhat.com&gt;
&gt; Inviato: Mer 31 marzo 2010, 20:43:29
&gt; Oggetto: Re: [libvirt-users] connect libvirt and virtualbox
&gt;
&gt; Ah, sorry, I missed to mention that VirtualBox 3.1 support was added
&gt; in libvirt 0.7.5.
&gt;
&gt; libvirt 0.7.0 supports VirtualBox 2.2 and 3.0.
&gt;
&gt; Matthias
&gt;
&gt; 2010/3/31 angelo alfano &lt;angeloalfa76@yahoo.it&gt;:
&gt;&gt; I have installed virtualbox 3.1.6 r.59338 e libvirt 0.7.0, but i have the
&gt;&gt; same error...
&gt;&gt;
&gt;&gt; libvir: VBOX error : internal error unable to initialize VirtualBox driver
&gt;&gt; API
&gt;&gt; Traceback (most recent call last):
&gt;&gt;   File "prova.py", line 5, in &lt;module&gt;
&gt;&gt;     conn = libvirt.open("vbox:///session")
&gt;&gt;   File "/usr/lib/python2.6/dist-packages/libvirt.py", line 163, in open
&gt;&gt;     if ret is None:raise libvirtError('virConnectOpen() failed')
&gt;&gt; libvirt.libvirtError: internal error unable to initialize VirtualBox
&gt;&gt; driver
&gt;&gt; API
&gt;&gt;
&gt;&gt;
&gt;&gt; ________________________________
&gt;&gt; Da: Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;
&gt;&gt; A: angelo alfano &lt;angeloalfa76@yahoo.it&gt;
&gt;&gt; Cc: libvirt mail-list &lt;libvirt-users@redhat.com&gt;; Pritesh Kothari
&gt;&gt; &lt;pritesh.kothari@sun.com&gt;
&gt;&gt; Inviato: Mer 31 marzo 2010, 18:43:52
&gt;&gt; Oggetto: Re: [libvirt-users] connect libvirt and virtualbox
&gt;&gt;
&gt;&gt; 2010/3/31 angelo alfano &lt;angeloalfa76@yahoo.it&gt;:
&gt;&gt;&gt;
&gt;&gt;&gt;&gt;2010/3/31 angelo alfano &lt;angeloalfa76@yahoo.it&gt;:
&gt;&gt;&gt;&gt;&gt; conn = libvirt.open("vbox:///session")
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; return this error:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; libvir: VBOX error : internal error unable to initialize VirtualBox
&gt;&gt;&gt;&gt;&gt; driver
&gt;&gt;&gt;&gt;&gt; API
&gt;&gt;&gt;&gt;&gt; Traceback (most recent call last):
&gt;&gt;&gt;&gt;&gt;   File "prova.py", line 5, in &lt;module&gt;
&gt;&gt;&gt;&gt;&gt;     conn = libvirt.open("vbox:///session")
&gt;&gt;&gt;&gt;&gt;   File "/usr/lib/python2.6/dist-packages/libvirt.py", line 163, in open
&gt;&gt;&gt;&gt;&gt;     if ret is None:raise libvirtError('virConnectOpen() failed')
&gt;&gt;&gt;&gt;&gt; libvirt.libvirtError: internal error unable to initialize VirtualBox
&gt;&gt;&gt;&gt;&gt; driver
&gt;&gt;&gt;&gt;&gt; API
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; why?
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;This error basically says, that libvirt doesn't support your VirtualBox
&gt;&gt;&gt;&gt; version.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;What libvirt and VirtualBox version do you use?
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;Matthias
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; libvirt 0.7.0
&gt;&gt;&gt; virtualbox 3.2
&gt;&gt;&gt;
&gt;&gt;&gt; Angelo
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt; libvirt currently supports up to VirtualBox 3.1 and needs to be
&gt;&gt; updated to support 3.2.
&gt;&gt;
&gt;&gt; I've CCed the VirtualBox driver maintainer.
&gt;&gt;
&gt;&gt; Matthias
&gt;&gt;
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

</body></email><email><emailId>20100401223829</emailId><senderName>"Brown, Matt D."</senderName><senderEmail>brown190@llnl.gov</senderEmail><timestampReceived>2010-04-01 22:38:29-0400</timestampReceived><subject>[libvirt-users] Creating a private network</subject><body>

I am trying to create a separate private network between the host (domain 0) and the \
guests. Using virsh, I created a bridge network, virbr1. I can successfully add guest \
interfaces to the bridge network and communicate between the guests. However, I am \
unable to communicate between the host and any of the guests. I created eth0:1 on the \
host and configured virbr1 to forward to eth0:1 (mode="route" dev="eth0:1"), but \
there is still no communication.

I don't think creating eth0:1 is the right thing to do. I think I need to create a \
virtual interface on domain 0 that is part of the bridge network, virbr1. However, \
when I run virsh attach-interface with domain-0, it fails.

What am I missing??

Matt


OS: RHEL 5, Xen kernel

virbr1 Bridge Network (First attempt)
      &lt;network&gt;
        &lt;name&gt;private&lt;/name&gt;
        &lt;bridge name="virbr2" /&gt;
        &lt;ip address="169.254.1.1" netmask="255.255.0.0"&gt;
        &lt;/ip&gt;
      &lt;/network&gt;

virbr1 Bridge Network (First attempt)
      &lt;network&gt;
        &lt;name&gt;private&lt;/name&gt;
        &lt;bridge name="virbr2" /&gt;
        &lt;ip address="169.254.1.1" netmask="255.255.0.0" /&gt;
        &lt;forward mode="route" dev="eth0:1" /&gt;
      &lt;/network&gt;


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:x="urn:schemas-microsoft-com:office:excel" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;meta http-equiv=Content-Type content="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 12 (filtered medium)"&gt;
&lt;style&gt;
&lt;!--
 /* Font Definitions */
 @font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
pre
	{mso-style-priority:99;
	mso-style-link:"HTML Preformatted Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Courier New";}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
span.HTMLPreformattedChar
	{mso-style-name:"HTML Preformatted Char";
	mso-style-priority:99;
	mso-style-link:"HTML Preformatted";
	font-family:"Courier New";}
.MsoChpDefault
	{mso-style-type:export-only;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.Section1
	{page:Section1;}
--&gt;
&lt;/style&gt;
&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapelayout v:ext="edit"&gt;
  &lt;o:idmap v:ext="edit" data="1" /&gt;
 &lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
&lt;/head&gt;

&lt;body lang=EN-US link=blue vlink=purple&gt;

&lt;div class=Section1&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;I am trying to create a separate private network between the
host (domain 0) and the guests. Using virsh, I created a bridge network,
virbr1. I can successfully add guest interfaces to the bridge network and
communicate between the guests. However, I am unable to communicate between the
host and any of the guests. I created eth0:1 on the host and configured virbr1
to forward to eth0:1 (mode=route dev=eth0:1), but
there is still no communication.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;I dont think creating eth0:1 is the right thing to
do. I think I need to create a virtual interface on domain 0 that is part of
the bridge network, virbr1. However, when I run virsh attach-interface with
domain-0, it fails. &lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;What am I missing??&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Matt&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;OS: RHEL 5, Xen kernel&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;virbr1 Bridge Network (First attempt)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-size:10.0pt;font-family:"Courier \
New"'&gt; &lt;network&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-size:10.0pt;font-family:"Courier \
New"'&gt; \
&lt;name&gt;private&lt;/name&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-size:10.0pt;font-family:"Courier \
New"'&gt; &lt;bridge name="virbr2" \
/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-size:10.0pt;font-family:"Courier \
New"'&gt; &lt;ip \
address="169.254.1.1" \
netmask="255.255.0.0"&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-size:10.0pt;font-family:"Courier \
New"'&gt; &lt;/ip&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-size:10.0pt;font-family:"Courier \
New"'&gt; &lt;/network&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;virbr1 Bridge Network (First attempt)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-size:10.0pt;font-family:"Courier \
New"'&gt; &lt;network&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-size:10.0pt;font-family:"Courier \
New"'&gt; \
&lt;name&gt;private&lt;/name&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-size:10.0pt;font-family:"Courier \
New"'&gt; &lt;bridge name="virbr2" \
/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-size:10.0pt;font-family:"Courier \
New"'&gt; &lt;ip \
address="169.254.1.1" netmask="255.255.0.0" \
/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-size:10.0pt;font-family:"Courier \
New"'&gt; &lt;forward mode=route \
dev=eth0:1 /&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-size:10.0pt;font-family:"Courier \
New"'&gt; &lt;/network&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;



</body></email><email><emailId>20100403183035</emailId><senderName>mattias</senderName><senderEmail>mj@mjw.se</senderEmail><timestampReceived>2010-04-03 18:30:35-0400</timestampReceived><subject>Re: [libvirt-users] question</subject><body>

same error about a missed certificate
but the text are in my native language swedish
something like CA certificate
On Sat, 2010-04-03 at 21:11 +0300, Danel Ahman wrote:
&gt; Try to use openvz:///system or openvz://localhost/system
&gt; 
&gt; Danel
&gt; 
&gt; On 03.04.2010, at 21:05, mattias wrote:
&gt; 
&gt; &gt; i try to connect to my local libvirt to use openvz
&gt; &gt; openvz://localhost
&gt; &gt; but i get an error about a missed certificate
&gt; &gt; and when i use
&gt; &gt; openvz:///localhost
&gt; &gt; only a eror message says could not connect
&gt; &gt; libvirt error
&gt; &gt;
&gt; &gt; _______________________________________________
&gt; &gt; libvirt-users mailing list
&gt; &gt; libvirt-users@redhat.com
&gt; &gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; 

</body></email><email><emailId>20100505112323</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-05-05 11:23:23-0400</timestampReceived><subject>[libvirt-users] FYI: Notes on setting up KVM guests using iSCSI</subject><body>

DV suggested that we document some libvirt setups using shared storage. I'm
not a fan of NFS, so I wrote some blog posts on how to use iSCSI in the
context of libvirt + KVM.

There is of course more than one way todo things, so I've outlined a couple
of different options. One completely manual command line approach using
tgtadm on the iSCSI server:

  http://berrange.com/posts/2010/05/05/provisioning-kvm-virtual-machines-on-iscsi-the-hard-way-part-1-of-2/


..and virsh/virt-install on the KVM host

  http://berrange.com/posts/2010/05/05/provisioning-kvm-virtual-machines-on-iscsi-the-hard-way-part-2-of-2/


Then one completely GUI based approach, using a QNAP NAS as the iSCSI server

  http://berrange.com/posts/2010/05/04/provisioning-kvm-virtual-machines-on-iscsi-with-qnap-virt-manager-part-1-of-2/


..and a virt-manager on the KVM host:

  http://berrange.com/posts/2010/05/04/provisioning-kvm-virtual-machines-on-iscsi-with-qnap-virt-manager-part-2-of-2/


You can of course mix+match, doing the iSCSI server the manual way and the
libvirt bits the GUI way and vica-verca. Any other commercial iSCSI server
will have the same concepts so the libvirt instructions apply in all likely
scenarios.

Regards,
Daniel
-- 
&gt; &gt; Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
&gt; &gt; http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
&gt; &gt; http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
&gt; &gt; GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|


</body></email><email><emailId>20100506001513</emailId><senderName>Claude Noshpitz</senderName><senderEmail>cnoshpitz@attinteractive.com</senderEmail><timestampReceived>2010-05-06 00:15:13-0400</timestampReceived><subject>[libvirt-users] weird "no supported architecture for os type 'hvm'"</subject><body>


Hi,

I have two identical machines with exactly the same CentOS 5.4 kickstarted
from the same sources, and the same packages installed. Their cpuinfos are
identical, and they are running libvirt 0.6.3 with the very same
libvirtd.conf.

Yet...

One of them works fine, the other says "no supported architecture for os
type 'hvm'" for the same template (attached) and image.

Any thoughts on what kind of defect or misconfiguration could cause this?

Thanks much!

--Claude


["kvm.xml" (application/octet-stream)]

</body></email><email><emailId>20100505172723</emailId><senderName>guido</senderName><senderEmail>guido-libvi@unknownsite.de</senderEmail><timestampReceived>2010-05-05 17:27:23-0400</timestampReceived><subject>[libvirt-users] libvirtd loses all of its data after restart</subject><body>

Hi,

I'm having a problem with libvirtd (backend being kvm) losing its if I restart 
it with /etc/init.d/libvirtd restart.

What I did was:
 Start libvirtd
 Connect to it using virsh
 Create a new storage pool with pool-create-as
 Create some volumes with vol-create-as
 Create some virtual machines with create
 Restart libvirtd using /etc/init.d/libvirtd restart
 Reconnect with virsh

After this, all the previously defined pools, volumes and virtual machines 
would no longer be listed with pool-list or list, respectively. (list --all 
doesn't show anything either)
The virtual machines I had started earlier are still running and I can still 
connect to them using vnc, but obviously, I can no longer manage them using 
libvirt.

Why is this happening? Is libvirtd's data not supposed to be persistent? Is 
this maybe just an old bug? How can I get the still running virtual machines 
back under control?

The system I'm using for this is a recently installed CentOS 5.4 with 
libvirt-0.6.3-20.1.el5_4 installed directly from its package repository. The 
only changes I made from the vanilla install was to install and configure some 
SSL certs in /etc/libvirt/libvirtd.conf, as described on the libvirt website 
and to enable LIBVIRTD_ARGS="--listen" in /etc/sysconfig/libvirtd.

	Guido

-- 
Too much multitasking isn't good for you.

</body></email><email><emailId>20100505201520</emailId><senderName>David Ehle</senderName><senderEmail>ehle@agni.phys.iit.edu</senderEmail><timestampReceived>2010-05-05 20:15:20-0400</timestampReceived><subject>[libvirt-users] Full documentation for virsh?</subject><body>


Hello,

Does anyone know where full documentation for virsh can be found? Or if 
the there are any plans to update the man page?

The man page lists far fewer commands than virsh lists from its 
interactive mode when you type help.

I noticed this when I was trying to figure out the difference between 
pool-destroy, and pool-delete. The help entries in the virsh shell are not 
very informative:
virsh # help pool-destroy
   NAME
     pool-destroy - destroy a pool

   SYNOPSIS
     pool-destroy &lt;pool&gt;

   DESCRIPTION
     Destroy a given pool.

   OPTIONS
     &lt;pool&gt;           pool name or uuid

virsh # help pool-delete
   NAME
     pool-delete - delete a pool

   SYNOPSIS
     pool-delete &lt;pool&gt;

   DESCRIPTION
     Delete a given pool.

   OPTIONS
     &lt;pool&gt;           pool name or uuid

... unless you already know how virsh defines delete vs destroy.

(anyone care to explain it to me?)

The word pool does not occur in the virsh man page for Ubuntu Karmic 
release at least.

Thanks for the great list!

</body></email><email><emailId>20100504043904</emailId><senderName>rahul singh</senderName><senderEmail>rahulsingh.v18@gmail.com</senderEmail><timestampReceived>2010-05-04 04:39:04-0400</timestampReceived><subject>[libvirt-users] migration using libvirt api</subject><body>

Hello,

     I am working on xen hypervisor. I am facing problem in migating    vm
locally on same system using libvirt api. please help me with some c sample
codes. Please send some demo programs or some related help how to migrate a
vm locally using libvirt api.

Thanking Yuo

Rahul Singh

[Attachment #3 (text/html)]

Hello,&lt;br&gt;&lt;br&gt;=A0=A0=A0=A0  I am working on xen hypervisor. I am facing pro=
blem in migating=A0=A0=A0 vm locally on same system using libvirt api. plea=
se help me with some c sample codes. Please send some demo programs or some=
 related help how to migrate a vm locally using libvirt api.&lt;br&gt;
&lt;br&gt;Thanking Yuo&lt;br&gt;&lt;br&gt;Rahul Singh&lt;br&gt;


</body></email><email><emailId>20100506075802</emailId><senderName>Mathias Tausig</senderName><senderEmail>mathias.tausig@a-cert.at</senderEmail><timestampReceived>2010-05-06 07:58:02-0400</timestampReceived><subject>Re: [libvirt-users] Full documentation for virsh?</subject><body>

Am 05.05.2010 22:15, schrieb David Ehle:
&gt; 
&gt; Hello,
&gt; 
&gt; Does anyone know where full documentation for virsh can be found? 

The best that I have found on the web is this one:

http://qemu-buch.de/de/index.php/QEMU-KVM-Buch/_Anhang/_libvirt#virt-install

It is in german, but they have an auto-translate link. Check out if it's
any good for you.

cheers
Mathias

Or if
&gt; the there are any plans to update the man page?
&gt; 
&gt; The man page lists far fewer commands than virsh lists from its
&gt; interactive mode when you type help.
&gt; 
&gt; I noticed this when I was trying to figure out the difference between
&gt; pool-destroy, and pool-delete. The help entries in the virsh shell are
&gt; not very informative:
&gt; virsh # help pool-destroy
&gt;   NAME
&gt;     pool-destroy - destroy a pool
&gt; 
&gt;   SYNOPSIS
&gt;     pool-destroy &lt;pool&gt;
&gt; 
&gt;   DESCRIPTION
&gt;     Destroy a given pool.
&gt; 
&gt;   OPTIONS
&gt;     &lt;pool&gt;           pool name or uuid
&gt; 
&gt; virsh # help pool-delete
&gt;   NAME
&gt;     pool-delete - delete a pool
&gt; 
&gt;   SYNOPSIS
&gt;     pool-delete &lt;pool&gt;
&gt; 
&gt;   DESCRIPTION
&gt;     Delete a given pool.
&gt; 
&gt;   OPTIONS
&gt;     &lt;pool&gt;           pool name or uuid
&gt; 
&gt; ... unless you already know how virsh defines delete vs destroy.
&gt; 
&gt; (anyone care to explain it to me?)
&gt; 
&gt; The word pool does not occur in the virsh man page for Ubuntu Karmic
&gt; release at least.
&gt; 
&gt; Thanks for the great list!
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; 

</body></email><email><emailId>20100505174438</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-05-05 17:44:38-0400</timestampReceived><subject>Re: [libvirt-users] libvirtd loses all of its data after restart</subject><body>

On Wed, May 05, 2010 at 07:27:23PM +0200, guido wrote:
&gt; Hi,
&gt; 
&gt; I'm having a problem with libvirtd (backend being kvm) losing its if I restart 
&gt; it with /etc/init.d/libvirtd restart.
&gt; 
&gt; What I did was:
&gt;  Start libvirtd
&gt;  Connect to it using virsh
&gt;  Create a new storage pool with pool-create-as
&gt;  Create some volumes with vol-create-as
&gt;  Create some virtual machines with create
&gt;  Restart libvirtd using /etc/init.d/libvirtd restart
&gt;  Reconnect with virsh
&gt; 
&gt; After this, all the previously defined pools, volumes and virtual machines 
&gt; would no longer be listed with pool-list or list, respectively. (list --all 
&gt; doesn't show anything either)
&gt; The virtual machines I had started earlier are still running and I can still 
&gt; connect to them using vnc, but obviously, I can no longer manage them using 
&gt; libvirt.
&gt; 
&gt; Why is this happening? Is libvirtd's data not supposed to be persistent? Is 
&gt; this maybe just an old bug? How can I get the still running virtual machines 
&gt; back under control?
&gt; 
&gt; The system I'm using for this is a recently installed CentOS 5.4 with 
&gt; libvirt-0.6.3-20.1.el5_4 installed directly from its package repository. The 
&gt; only changes I made from the vanilla install was to install and configure some 
&gt; SSL certs in /etc/libvirt/libvirtd.conf, as described on the libvirt website 
&gt; and to enable LIBVIRTD_ARGS="--listen" in /etc/sysconfig/libvirtd.

The version of libvirtd you have does not support seemless restarts of
the daemon  process while resources are active. You should shutdown all
guests / storage pools before restarting the libvirtd daemon, or better
yet, don't restart it at all.

libvirt 0.7.x was the first series supporting restarts with stuff running


Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100505120950</emailId><senderName>Tom Georgoulias</senderName><senderEmail>tomg@mcclatchyinteractive.com</senderEmail><timestampReceived>2010-05-05 12:09:50-0400</timestampReceived><subject>Re: [libvirt-users] FYI: Notes on setting up KVM guests using iSCSI</subject><body>

On 05/05/2010 07:23 AM, Daniel P. Berrange wrote:
&gt; DV suggested that we document some libvirt setups using shared storage. I'm
&gt; not a fan of NFS, so I wrote some blog posts on how to use iSCSI in the
&gt; context of libvirt + KVM.

Thank you for creating and sharing these.

&gt; http://berrange.com/posts/2010/05/05/provisioning-kvm-virtual-machines-on-iscsi-the-hard-way-part-2-of-2/
&gt; 

I have a question about this example, specifically the shareable 
permission option and tag:  (perm=sh, &lt;shareable/&gt;)

What does that do, exactly?  Is it simply the required r/w option to 
prevent corruption of VMs when using shared storage, or is it needed 
only if the disk will be actively by more than one VM?  (That 2nd idea 
doesn't seem quite right to me, I would expect to have to use some kind 
of locking technology to prevent it two or more VMs trying to write to 
the same disk at the same time).

Thanks,
Tom


</body></email><email><emailId>20100505123444</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-05-05 12:34:44-0400</timestampReceived><subject>Re: [libvirt-users] FYI: Notes on setting up KVM guests using iSCSI</subject><body>

On Wed, May 05, 2010 at 08:09:50AM -0400, Tom Georgoulias wrote:
&gt; On 05/05/2010 07:23 AM, Daniel P. Berrange wrote:
&gt; &gt; DV suggested that we document some libvirt setups using shared storage. I'm
&gt; &gt; not a fan of NFS, so I wrote some blog posts on how to use iSCSI in the
&gt; &gt; context of libvirt + KVM.
&gt; 
&gt; Thank you for creating and sharing these.
&gt; 
&gt; &gt; http://berrange.com/posts/2010/05/05/provisioning-kvm-virtual-machines-on-iscsi-the-hard-way-part-2-of-2/
&gt; &gt; 
&gt; 
&gt; I have a question about this example, specifically the shareable 
&gt; permission option and tag:  (perm=sh, &lt;shareable/&gt;)
&gt; 
&gt; What does that do, exactly?  Is it simply the required r/w option to 
&gt; prevent corruption of VMs when using shared storage, or is it needed 
&gt; only if the disk will be actively by more than one VM?  (That 2nd idea 
&gt; doesn't seem quite right to me, I would expect to have to use some kind 
&gt; of locking technology to prevent it two or more VMs trying to write to 
&gt; the same disk at the same time).

The &lt;shareable/&gt; flag tells libvirt that the disk will be *concurrently*
accessed by multiple VMs. This means that the hypervisor will not try to
take an exclusive lock on the disk, that all I/O caching is disabled,
and any SELinux labelling allows use by all VMs.  

NB: if you are marking a disk as &lt;sharable/&gt; you need to know what you
are doing in the guest OS. You would typically use a cluster filesystem
on the disk like GFS or OCFS. Attempts to use a normal FS like ext3
from multiple VMs at once is not healthy for your data :-)

Daniel
-- 
&gt; &gt; Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
&gt; &gt; http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
&gt; &gt; http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
&gt; &gt; GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|


</body></email><email><emailId>20100505132815</emailId><senderName>David Ehle</senderName><senderEmail>ehle@agni.phys.iit.edu</senderEmail><timestampReceived>2010-05-05 13:28:15-0400</timestampReceived><subject>Re: [libvirt-users] FYI: Notes on setting up KVM guests using iSCSI</subject><body>


Daniel,


Thank you Very much for you efforts. I'll be studying these with interest.

I also plan on replying to the previous response to my request for help on 
shard storage later today.  I'm still trying to run some tests to see if I 
understand how the Pools vs Volumes work with libvirt and iSCSI.

Thanks again!
David.

On Wed, 5 May 2010, Daniel P. Berrange wrote:

&gt; DV suggested that we document some libvirt setups using shared storage. I'm
&gt; not a fan of NFS, so I wrote some blog posts on how to use iSCSI in the
&gt; context of libvirt + KVM.
&gt; 
&gt; There is of course more than one way todo things, so I've outlined a couple
&gt; of different options. One completely manual command line approach using
&gt; tgtadm on the iSCSI server:
&gt; 
&gt; http://berrange.com/posts/2010/05/05/provisioning-kvm-virtual-machines-on-iscsi-the-hard-way-part-1-of-2/
&gt;  
&gt; ..and virsh/virt-install on the KVM host
&gt; 
&gt; http://berrange.com/posts/2010/05/05/provisioning-kvm-virtual-machines-on-iscsi-the-hard-way-part-2-of-2/
&gt;  
&gt; Then one completely GUI based approach, using a QNAP NAS as the iSCSI server
&gt; 
&gt; http://berrange.com/posts/2010/05/04/provisioning-kvm-virtual-machines-on-iscsi-with-qnap-virt-manager-part-1-of-2/
&gt;  
&gt; ..and a virt-manager on the KVM host:
&gt; 
&gt; http://berrange.com/posts/2010/05/04/provisioning-kvm-virtual-machines-on-iscsi-with-qnap-virt-manager-part-2-of-2/
&gt;  
&gt; You can of course mix+match, doing the iSCSI server the manual way and the
&gt; libvirt bits the GUI way and vica-verca. Any other commercial iSCSI server
&gt; will have the same concepts so the libvirt instructions apply in all likely
&gt; scenarios.
&gt; 
&gt; Regards,
&gt; Daniel
&gt; -- 
&gt; &gt; &gt; Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
&gt; &gt; &gt; http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
&gt; &gt; &gt; http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
&gt; &gt; &gt; GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; 


</body></email><email><emailId>20100505134311</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-05-05 13:43:11-0400</timestampReceived><subject>Re: [libvirt-users] FYI: Notes on setting up KVM guests using iSCSI</subject><body>

On Wed, May 05, 2010 at 08:28:15AM -0500, David Ehle wrote:
&gt; 
&gt; Daniel,
&gt; 
&gt; 
&gt; Thank you Very much for you efforts. I'll be studying these with interest.
&gt; 
&gt; I also plan on replying to the previous response to my request for help on 
&gt; shard storage later today.  I'm still trying to run some tests to see if I 
&gt; understand how the Pools vs Volumes work with libvirt and iSCSI.

For iSCSI  

 - Pool == A single target
 - Volume == A LUN within a target

So, if your iSCSI server exports many iSCSI targets, you'd setup a separate
pool for each target you want to access from libvirt. This post covers iSCSI 
pool setup at a low level:

http://berrange.com/posts/2010/05/05/provisioning-kvm-virtual-machines-on-iscsi-the-hard-way-part-2-of-2/

Regards,
Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100505135057</emailId><senderName>David Ehle</senderName><senderEmail>ehle@agni.phys.iit.edu</senderEmail><timestampReceived>2010-05-05 13:50:57-0400</timestampReceived><subject>Re: [libvirt-users] FYI: Notes on setting up KVM guests using iSCSI</subject><body>


Daniel,

OK so I think I get it now. While for other storage backends one pool can 
hold multiple volumes, when using iSCIS there is alwasy a 1 to 1 
relationship for pool to volume? Each pool contains exactly one volume?

David.

On Wed, 5 May 2010, Daniel P. Berrange wrote:

&gt; On Wed, May 05, 2010 at 08:28:15AM -0500, David Ehle wrote:
&gt; &gt; 
&gt; &gt; Daniel,
&gt; &gt; 
&gt; &gt; 
&gt; &gt; Thank you Very much for you efforts. I'll be studying these with interest.
&gt; &gt; 
&gt; &gt; I also plan on replying to the previous response to my request for help on
&gt; &gt; shard storage later today.  I'm still trying to run some tests to see if I
&gt; &gt; understand how the Pools vs Volumes work with libvirt and iSCSI.
&gt; 
&gt; For iSCSI
&gt; 
&gt; - Pool == A single target
&gt; - Volume == A LUN within a target
&gt; 
&gt; So, if your iSCSI server exports many iSCSI targets, you'd setup a separate
&gt; pool for each target you want to access from libvirt. This post covers iSCSI
&gt; pool setup at a low level:
&gt; 
&gt; http://berrange.com/posts/2010/05/05/provisioning-kvm-virtual-machines-on-iscsi-the-hard-way-part-2-of-2/
&gt;  
&gt; Regards,
&gt; Daniel
&gt; -- 
&gt; &gt; &gt; Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
&gt; &gt; &gt; http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
&gt; &gt; &gt; http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
&gt; &gt; &gt; GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|
&gt; 


</body></email><email><emailId>20100331150022</emailId><senderName>angelo alfano</senderName><senderEmail>angeloalfa76@yahoo.it</senderEmail><timestampReceived>2010-03-31 15:00:22-0400</timestampReceived><subject>[libvirt-users] connect libvirt and virtualbox</subject><body>

conn = libvirt.open("vbox:///session")

return this error:

libvir: VBOX error : internal error unable to initialize VirtualBox driver API
Traceback (most recent call last):
  File "prova.py", line 5, in &lt;module&gt;
    conn = libvirt.open("vbox:///session")
  File "/usr/lib/python2.6/dist-packages/libvirt.py", line 163, in open
    if ret is None:raise libvirtError('virConnectOpen() failed')
libvirt.libvirtError: internal error unable to initialize VirtualBox driver API

why?



      
[Attachment #3 (text/html)]

&lt;html&gt;&lt;head&gt;&lt;style type="text/css"&gt;&lt;!-- DIV {margin:0px;} \
--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div style="font-family:times new roman,new \
york,times,serif;font-size:12pt"&gt;&lt;div&gt;conn = \
libvirt.open("vbox:///session")&lt;br&gt;&lt;br&gt;return this error:&lt;br&gt;&lt;br&gt;libvir: VBOX error : \
internal error unable to initialize VirtualBox driver API&lt;br&gt;Traceback (most recent \
call last):&lt;br&gt; File "prova.py", line 5, in \
&lt;module&gt;&lt;br&gt; conn = libvirt.open("vbox:///session")&lt;br&gt; \
File "/usr/lib/python2.6/dist-packages/libvirt.py", line 163, in \
open&lt;br&gt; if ret is None:raise libvirtError('virConnectOpen() \
failed')&lt;br&gt;libvirt.libvirtError: internal error unable to initialize VirtualBox \
driver API&lt;br&gt;&lt;br&gt;why?&lt;br&gt;&lt;/div&gt; &lt;/div&gt;&lt;br&gt;



      &lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20100331153449</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-03-31 15:34:49-0400</timestampReceived><subject>Re: [libvirt-users] connect libvirt and virtualbox</subject><body>

2010/3/31 angelo alfano &lt;angeloalfa76@yahoo.it&gt;:
&gt; conn = libvirt.open("vbox:///session")
&gt;
&gt; return this error:
&gt;
&gt; libvir: VBOX error : internal error unable to initialize VirtualBox driver
&gt; API
&gt; Traceback (most recent call last):
&gt;   File "prova.py", line 5, in &lt;module&gt;
&gt;     conn = libvirt.open("vbox:///session")
&gt;   File "/usr/lib/python2.6/dist-packages/libvirt.py", line 163, in open
&gt;     if ret is None:raise libvirtError('virConnectOpen() failed')
&gt; libvirt.libvirtError: internal error unable to initialize VirtualBox driver
&gt; API
&gt;
&gt; why?
&gt;

This error basically says, that libvirt doesn't support your VirtualBox version.

What libvirt and VirtualBox version do you use?

Matthias

</body></email><email><emailId>20100331163556</emailId><senderName>angelo alfano</senderName><senderEmail>angeloalfa76@yahoo.it</senderEmail><timestampReceived>2010-03-31 16:35:56-0400</timestampReceived><subject>Re: [libvirt-users] connect libvirt and virtualbox</subject><body>

&gt;2010/3/31 angelo alfano &lt;angeloalfa76@yahoo.it&gt;:
&gt;&gt; conn = libvirt.open("vbox:///session")
&gt;&gt;
&gt;&gt; return this error:
&gt;&gt;
&gt;&gt; libvir: VBOX error : internal error unable to initialize VirtualBox driver
&gt;&gt; API
&gt;&gt; Traceback (most recent call last):
&gt;&gt;   File "prova.py", line 5, in &lt;module&gt;
&gt;&gt;     conn = libvirt.open("vbox:///session")
&gt;&gt;   File "/usr/lib/python2.6/dist-packages/libvirt.py", line 163, in open
&gt;&gt;     if ret is None:raise libvirtError('virConnectOpen() failed')
&gt;&gt; libvirt.libvirtError: internal error unable to initialize VirtualBox driver
&gt;&gt; API
&gt;&gt;
&gt;&gt; why?
&gt;&gt;
&gt;
&gt;This error basically says, that libvirt doesn't support your VirtualBox version.
&gt;
&gt;What libvirt and VirtualBox version do you use?
&gt;
&gt;Matthias


libvirt 0.7.0
virtualbox 3.2

Angelo



      
[Attachment #3 (text/html)]

&lt;html&gt;&lt;head&gt;&lt;style type="text/css"&gt;&lt;!-- DIV {margin:0px;} \
--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div style="font-family:times new roman,new \
york,times,serif;font-size:12pt"&gt;&lt;br&gt;&lt;div style="font-family: times new roman,new \
york,times,serif; font-size: 12pt;"&gt;&lt;div style="font-family: \
arial,helvetica,sans-serif; font-size: 10pt;"&gt;&gt;2010/3/31 angelo alfano &lt;&lt;a \
ymailto="mailto:angeloalfa76@yahoo.it" \
href="mailto:angeloalfa76@yahoo.it"&gt;angeloalfa76@yahoo.it&lt;/a&gt;&gt;:&lt;br&gt;&gt;&gt; conn = \
libvirt.open("vbox:///session")&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt; return this \
error:&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt; libvir: VBOX error : internal error unable to \
initialize VirtualBox driver&lt;br&gt;&gt;&gt; API&lt;br&gt;&gt;&gt; Traceback (most recent call \
last):&lt;br&gt;&gt;&gt;  File "prova.py", line 5, in &lt;module&gt;&lt;br&gt;&gt;&gt; \
 conn = libvirt.open("vbox:///session")&lt;br&gt;&gt;&gt;  File \
"/usr/lib/python2.6/dist-packages/libvirt.py", line 163, in open&lt;br&gt;&gt;&gt; \
 if  ret is None:raise libvirtError('virConnectOpen() \
failed')&lt;br&gt;&gt;&gt; libvirt.libvirtError: internal error unable to initialize \
VirtualBox driver&lt;br&gt;&gt;&gt; API&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt; \
why?&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&lt;br&gt;&gt;This error basically says, that libvirt doesn't \
support your VirtualBox version.&lt;br&gt;&gt;&lt;br&gt;&gt;What libvirt and VirtualBox version \
do you use?&lt;br&gt;&gt;&lt;br&gt;&gt;Matthias&lt;br&gt;&lt;br&gt;&lt;br&gt;libvirt 0.7.0&lt;br&gt;virtualbox \
3.2&lt;br&gt;&lt;br&gt;Angelo&lt;br&gt;&lt;/div&gt;&lt;/div&gt; &lt;/div&gt;&lt;br&gt;



      &lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20100331164352</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-03-31 16:43:52-0400</timestampReceived><subject>Re: [libvirt-users] connect libvirt and virtualbox</subject><body>

2010/3/31 angelo alfano &lt;angeloalfa76@yahoo.it&gt;:
&gt;
&gt;&gt;2010/3/31 angelo alfano &lt;angeloalfa76@yahoo.it&gt;:
&gt;&gt;&gt; conn = libvirt.open("vbox:///session")
&gt;&gt;&gt;
&gt;&gt;&gt; return this error:
&gt;&gt;&gt;
&gt;&gt;&gt; libvir: VBOX error : internal error unable to initialize VirtualBox
&gt;&gt;&gt; driver
&gt;&gt;&gt; API
&gt;&gt;&gt; Traceback (most recent call last):
&gt;&gt;&gt;   File "prova.py", line 5, in &lt;module&gt;
&gt;&gt;&gt;     conn = libvirt.open("vbox:///session")
&gt;&gt;&gt;   File "/usr/lib/python2.6/dist-packages/libvirt.py", line 163, in open
&gt;&gt;&gt;     if ret is None:raise libvirtError('virConnectOpen() failed')
&gt;&gt;&gt; libvirt.libvirtError: internal error unable to initialize VirtualBox
&gt;&gt;&gt; driver
&gt;&gt;&gt; API
&gt;&gt;&gt;
&gt;&gt;&gt; why?
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt;This error basically says, that libvirt doesn't support your VirtualBox
&gt;&gt; version.
&gt;&gt;
&gt;&gt;What libvirt and VirtualBox version do you use?
&gt;&gt;
&gt;&gt;Matthias
&gt;
&gt;
&gt; libvirt 0.7.0
&gt; virtualbox 3.2
&gt;
&gt; Angelo
&gt;

libvirt currently supports up to VirtualBox 3.1 and needs to be
updated to support 3.2.

I've CCed the VirtualBox driver maintainer.

Matthias

</body></email><email><emailId>20100331171807</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-03-31 17:18:07-0400</timestampReceived><subject>Re: [libvirt-users] connect libvirt and virtualbox</subject><body>

2010/3/31 Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;:
&gt; 2010/3/31 angelo alfano &lt;angeloalfa76@yahoo.it&gt;:
&gt;&gt;
&gt;&gt;&gt;2010/3/31 angelo alfano &lt;angeloalfa76@yahoo.it&gt;:
&gt;&gt;&gt;&gt; conn = libvirt.open("vbox:///session")
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; return this error:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; libvir: VBOX error : internal error unable to initialize VirtualBox
&gt;&gt;&gt;&gt; driver
&gt;&gt;&gt;&gt; API
&gt;&gt;&gt;&gt; Traceback (most recent call last):
&gt;&gt;&gt;&gt;   File "prova.py", line 5, in &lt;module&gt;
&gt;&gt;&gt;&gt;     conn = libvirt.open("vbox:///session")
&gt;&gt;&gt;&gt;   File "/usr/lib/python2.6/dist-packages/libvirt.py", line 163, in open
&gt;&gt;&gt;&gt;     if ret is None:raise libvirtError('virConnectOpen() failed')
&gt;&gt;&gt;&gt; libvirt.libvirtError: internal error unable to initialize VirtualBox
&gt;&gt;&gt;&gt; driver
&gt;&gt;&gt;&gt; API
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; why?
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;This error basically says, that libvirt doesn't support your VirtualBox
&gt;&gt;&gt; version.
&gt;&gt;&gt;
&gt;&gt;&gt;What libvirt and VirtualBox version do you use?
&gt;&gt;&gt;
&gt;&gt;&gt;Matthias
&gt;&gt;
&gt;&gt;
&gt;&gt; libvirt 0.7.0
&gt;&gt; virtualbox 3.2
&gt;&gt;
&gt;&gt; Angelo
&gt;&gt;
&gt;
&gt; libvirt currently supports up to VirtualBox 3.1 and needs to be
&gt; updated to support 3.2.
&gt;
&gt; I've CCed the VirtualBox driver maintainer.
&gt;
&gt; Matthias
&gt;

Hm, the mail was bounced back to me from the Sun mail server, saying
pritesh.kothari@sun.com is an unknown user.

Matthias

</body></email><email><emailId>20100331172951</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-03-31 17:29:51-0400</timestampReceived><subject>Re: [libvirt-users] connect libvirt and virtualbox</subject><body>

On Wed, Mar 31, 2010 at 06:18:07PM +0100, Matthias Bolte wrote:
&gt; 2010/3/31 Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;:
&gt; &gt; 2010/3/31 angelo alfano &lt;angeloalfa76@yahoo.it&gt;:
&gt; &gt;&gt;
&gt; &gt;&gt;&gt;2010/3/31 angelo alfano &lt;angeloalfa76@yahoo.it&gt;:
&gt; &gt;&gt;&gt;&gt; conn = libvirt.open("vbox:///session")
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; return this error:
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; libvir: VBOX error : internal error unable to initialize VirtualBox
&gt; &gt;&gt;&gt;&gt; driver
&gt; &gt;&gt;&gt;&gt; API
&gt; &gt;&gt;&gt;&gt; Traceback (most recent call last):
&gt; &gt;&gt;&gt;&gt;   File "prova.py", line 5, in &lt;module&gt;
&gt; &gt;&gt;&gt;&gt;     conn = libvirt.open("vbox:///session")
&gt; &gt;&gt;&gt;&gt;   File "/usr/lib/python2.6/dist-packages/libvirt.py", line 163, in open
&gt; &gt;&gt;&gt;&gt;     if ret is None:raise libvirtError('virConnectOpen() failed')
&gt; &gt;&gt;&gt;&gt; libvirt.libvirtError: internal error unable to initialize VirtualBox
&gt; &gt;&gt;&gt;&gt; driver
&gt; &gt;&gt;&gt;&gt; API
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; why?
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;This error basically says, that libvirt doesn't support your VirtualBox
&gt; &gt;&gt;&gt; version.
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;What libvirt and VirtualBox version do you use?
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;Matthias
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; libvirt 0.7.0
&gt; &gt;&gt; virtualbox 3.2
&gt; &gt;&gt;
&gt; &gt;&gt; Angelo
&gt; &gt;&gt;
&gt; &gt;
&gt; &gt; libvirt currently supports up to VirtualBox 3.1 and needs to be
&gt; &gt; updated to support 3.2.
&gt; &gt;
&gt; &gt; I've CCed the VirtualBox driver maintainer.
&gt; &gt;
&gt; &gt; Matthias
&gt; &gt;
&gt; 
&gt; Hm, the mail was bounced back to me from the Sun mail server, saying
&gt; pritesh.kothari@sun.com is an unknown user.

Pritesh is still on the list under a gmail addr, so he should still
see your messages

Regards,
Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100331181841</emailId><senderName>angelo alfano</senderName><senderEmail>angeloalfa76@yahoo.it</senderEmail><timestampReceived>2010-03-31 18:18:41-0400</timestampReceived><subject>Re: [libvirt-users] connect libvirt and virtualbox</subject><body>

I have installed virtualbox 3.1.6 r.59338 e libvirt 0.7.0, but i have the same error...

libvir: VBOX error : internal error unable to initialize VirtualBox driver API
Traceback (most recent call last):
  File "prova.py", line 5, in &lt;module&gt;
    conn = libvirt.open("vbox:///session")
  File "/usr/lib/python2.6/dist-packages/libvirt.py", line 163, in open
    if ret is None:raise libvirtError('virConnectOpen() failed')
libvirt.libvirtError: internal error unable to initialize VirtualBox driver API





________________________________
Da: Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;
A: angelo alfano &lt;angeloalfa76@yahoo.it&gt;
Cc: libvirt mail-list &lt;libvirt-users@redhat.com&gt;; Pritesh Kothari &lt;pritesh.kothari@sun.com&gt;
Inviato: Mer 31 marzo 2010, 18:43:52
Oggetto: Re: [libvirt-users] connect libvirt and virtualbox

2010/3/31 angelo alfano &lt;angeloalfa76@yahoo.it&gt;:
&gt;
&gt;&gt;2010/3/31 angelo alfano &lt;angeloalfa76@yahoo.it&gt;:
&gt;&gt;&gt; conn = libvirt.open("vbox:///session")
&gt;&gt;&gt;
&gt;&gt;&gt; return this error:
&gt;&gt;&gt;
&gt;&gt;&gt; libvir: VBOX error : internal error unable to initialize VirtualBox
&gt;&gt;&gt; driver
&gt;&gt;&gt; API
&gt;&gt;&gt; Traceback (most recent call last):
&gt;&gt;&gt;   File "prova.py", line 5, in &lt;module&gt;
&gt;&gt;&gt;     conn = libvirt.open("vbox:///session")
&gt;&gt;&gt;   File "/usr/lib/python2.6/dist-packages/libvirt.py", line 163, in open
&gt;&gt;&gt;     if ret is None:raise libvirtError('virConnectOpen() failed')
&gt;&gt;&gt; libvirt.libvirtError: internal error unable to initialize VirtualBox
&gt;&gt;&gt; driver
&gt;&gt;&gt; API
&gt;&gt;&gt;
&gt;&gt;&gt; why?
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt;This error basically says, that libvirt doesn't support your VirtualBox
&gt;&gt; version.
&gt;&gt;
&gt;&gt;What libvirt and VirtualBox version do you use?
&gt;&gt;
&gt;&gt;Matthias
&gt;
&gt;
&gt; libvirt 0.7.0
&gt; virtualbox 3.2
&gt;
&gt; Angelo
&gt;

libvirt currently supports up to VirtualBox 3.1 and needs to be
updated to support 3.2.

I've CCed the VirtualBox driver maintainer.

Matthias



      
[Attachment #3 (text/html)]

&lt;html&gt;&lt;head&gt;&lt;style type="text/css"&gt;&lt;!-- DIV {margin:0px;} \
--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div style="font-family:times new roman,new \
york,times,serif;font-size:12pt"&gt;&lt;div&gt;I have installed virtualbox 3.1.6 r.59338 e \
libvirt 0.7.0, but i have the same error...&lt;br&gt;&lt;br&gt;libvir: VBOX error : internal \
error unable to initialize VirtualBox driver API&lt;br&gt;Traceback (most recent call \
last):&lt;br&gt; File "prova.py", line 5, in &lt;module&gt;&lt;br&gt; \
conn = libvirt.open("vbox:///session")&lt;br&gt; File \
"/usr/lib/python2.6/dist-packages/libvirt.py", line 163, in \
open&lt;br&gt; if ret is None:raise libvirtError('virConnectOpen() \
failed')&lt;br&gt;libvirt.libvirtError: internal error unable to initialize VirtualBox \
driver API&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div style="font-family: times new roman,new \
york,times,serif; font-size: 12pt;"&gt;&lt;br&gt;&lt;div style="font-family: \
arial,helvetica,sans-serif; font-size: 10pt;"&gt;&lt;font size="2" face="Tahoma"&gt;&lt;hr \
size="1"&gt;&lt;b&gt;&lt;span  style="font-weight: bold;"&gt;Da:&lt;/span&gt;&lt;/b&gt; Matthias Bolte \
&lt;matthias.bolte@googlemail.com&gt;&lt;br&gt;&lt;b&gt;&lt;span style="font-weight: \
bold;"&gt;A:&lt;/span&gt;&lt;/b&gt; angelo alfano &lt;angeloalfa76@yahoo.it&gt;&lt;br&gt;&lt;b&gt;&lt;span \
style="font-weight: bold;"&gt;Cc:&lt;/span&gt;&lt;/b&gt; libvirt mail-list \
&lt;libvirt-users@redhat.com&gt;; Pritesh Kothari \
&lt;pritesh.kothari@sun.com&gt;&lt;br&gt;&lt;b&gt;&lt;span style="font-weight: \
bold;"&gt;Inviato:&lt;/span&gt;&lt;/b&gt; Mer 31 marzo 2010, 18:43:52&lt;br&gt;&lt;b&gt;&lt;span \
style="font-weight: bold;"&gt;Oggetto:&lt;/span&gt;&lt;/b&gt; Re: [libvirt-users] connect libvirt \
and virtualbox&lt;br&gt;&lt;/font&gt;&lt;br&gt;2010/3/31 angelo alfano &lt;&lt;a \
ymailto="mailto:angeloalfa76@yahoo.it" \
href="mailto:angeloalfa76@yahoo.it"&gt;angeloalfa76@yahoo.it&lt;/a&gt;&gt;:&lt;br&gt;&gt;&lt;br&gt;&gt;&gt;2010/3/31 \
angelo alfano &lt;&lt;a ymailto="mailto:angeloalfa76@yahoo.it" \
href="mailto:angeloalfa76@yahoo.it"&gt;angeloalfa76@yahoo.it&lt;/a&gt;&gt;:&lt;br&gt;&gt;&gt;&gt; \
conn = libvirt.open("vbox:///session")&lt;br&gt;&gt;&gt;&gt;&lt;br&gt;&gt;&gt;&gt; return this  \
error:&lt;br&gt;&gt;&gt;&gt;&lt;br&gt;&gt;&gt;&gt; libvir: VBOX error : internal error unable to \
initialize VirtualBox&lt;br&gt;&gt;&gt;&gt; driver&lt;br&gt;&gt;&gt;&gt; API&lt;br&gt;&gt;&gt;&gt; \
Traceback (most recent call last):&lt;br&gt;&gt;&gt;&gt;  File "prova.py", line 5, in \
&lt;module&gt;&lt;br&gt;&gt;&gt;&gt;  conn = \
libvirt.open("vbox:///session")&lt;br&gt;&gt;&gt;&gt;  File \
"/usr/lib/python2.6/dist-packages/libvirt.py", line 163, in open&lt;br&gt;&gt;&gt;&gt; \
 if ret is None:raise libvirtError('virConnectOpen() \
failed')&lt;br&gt;&gt;&gt;&gt; libvirt.libvirtError: internal error unable to initialize \
VirtualBox&lt;br&gt;&gt;&gt;&gt; driver&lt;br&gt;&gt;&gt;&gt; API&lt;br&gt;&gt;&gt;&gt;&lt;br&gt;&gt;&gt;&gt; \
why?&lt;br&gt;&gt;&gt;&gt;&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt;This error basically says, that libvirt \
doesn't support your VirtualBox&lt;br&gt;&gt;&gt; version.&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt;What \
libvirt and VirtualBox version do you \
use?&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt;Matthias&lt;br&gt;&gt;&lt;br&gt;&gt;&lt;br&gt;&gt; libvirt  0.7.0&lt;br&gt;&gt; \
virtualbox 3.2&lt;br&gt;&gt;&lt;br&gt;&gt; Angelo&lt;br&gt;&gt;&lt;br&gt;&lt;br&gt;libvirt currently supports up to \
VirtualBox 3.1 and needs to be&lt;br&gt;updated to support 3.2.&lt;br&gt;&lt;br&gt;I've CCed the \
VirtualBox driver maintainer.&lt;br&gt;&lt;br&gt;Matthias&lt;br&gt;&lt;/div&gt;&lt;/div&gt; &lt;/div&gt;&lt;br&gt;



      &lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20100331184329</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-03-31 18:43:29-0400</timestampReceived><subject>Re: [libvirt-users] connect libvirt and virtualbox</subject><body>

Ah, sorry, I missed to mention that VirtualBox 3.1 support was added
in libvirt 0.7.5.

libvirt 0.7.0 supports VirtualBox 2.2 and 3.0.

Matthias

2010/3/31 angelo alfano &lt;angeloalfa76@yahoo.it&gt;:
&gt; I have installed virtualbox 3.1.6 r.59338 e libvirt 0.7.0, but i have the
&gt; same error...
&gt;
&gt; libvir: VBOX error : internal error unable to initialize VirtualBox driver
&gt; API
&gt; Traceback (most recent call last):
&gt;   File "prova.py", line 5, in &lt;module&gt;
&gt;     conn = libvirt.open("vbox:///session")
&gt;   File "/usr/lib/python2.6/dist-packages/libvirt.py", line 163, in open
&gt;     if ret is None:raise libvirtError('virConnectOpen() failed')
&gt; libvirt.libvirtError: internal error unable to initialize VirtualBox driver
&gt; API
&gt;
&gt;
&gt; ________________________________
&gt; Da: Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;
&gt; A: angelo alfano &lt;angeloalfa76@yahoo.it&gt;
&gt; Cc: libvirt mail-list &lt;libvirt-users@redhat.com&gt;; Pritesh Kothari
&gt; &lt;pritesh.kothari@sun.com&gt;
&gt; Inviato: Mer 31 marzo 2010, 18:43:52
&gt; Oggetto: Re: [libvirt-users] connect libvirt and virtualbox
&gt;
&gt; 2010/3/31 angelo alfano &lt;angeloalfa76@yahoo.it&gt;:
&gt;&gt;
&gt;&gt;&gt;2010/3/31 angelo alfano &lt;angeloalfa76@yahoo.it&gt;:
&gt;&gt;&gt;&gt; conn = libvirt.open("vbox:///session")
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; return this error:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; libvir: VBOX error : internal error unable to initialize VirtualBox
&gt;&gt;&gt;&gt; driver
&gt;&gt;&gt;&gt; API
&gt;&gt;&gt;&gt; Traceback (most recent call last):
&gt;&gt;&gt;&gt;   File "prova.py", line 5, in &lt;module&gt;
&gt;&gt;&gt;&gt;     conn = libvirt.open("vbox:///session")
&gt;&gt;&gt;&gt;   File "/usr/lib/python2.6/dist-packages/libvirt.py", line 163, in open
&gt;&gt;&gt;&gt;     if ret is None:raise libvirtError('virConnectOpen() failed')
&gt;&gt;&gt;&gt; libvirt.libvirtError: internal error unable to initialize VirtualBox
&gt;&gt;&gt;&gt; driver
&gt;&gt;&gt;&gt; API
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; why?
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;This error basically says, that libvirt doesn't support your VirtualBox
&gt;&gt;&gt; version.
&gt;&gt;&gt;
&gt;&gt;&gt;What libvirt and VirtualBox version do you use?
&gt;&gt;&gt;
&gt;&gt;&gt;Matthias
&gt;&gt;
&gt;&gt;
&gt;&gt; libvirt 0.7.0
&gt;&gt; virtualbox 3.2
&gt;&gt;
&gt;&gt; Angelo
&gt;&gt;
&gt;
&gt; libvirt currently supports up to VirtualBox 3.1 and needs to be
&gt; updated to support 3.2.
&gt;
&gt; I've CCed the VirtualBox driver maintainer.
&gt;
&gt; Matthias
&gt;

</body></email><email><emailId>20100409140226</emailId><senderName>Frank =?iso-8859-15?Q?Matthie=DF?=</senderName><senderEmail>frankm@lug-owl.de</senderEmail><timestampReceived>2010-04-09 14:02:26-0400</timestampReceived><subject>[libvirt-users] libvirt, kvm, pxe boot failed</subject><body>


Hello all,

on my debian squeeze system i have the problem as some others[1] using
this combination of libvirt, kvm and qemu.

"Cannot boot from non-existent NIC" is the qemu-kvm error message

[1] http://www.google.com/search?q=libvirt+Cannot+boot+from+non-existent+NIC&amp;ie=utf-8&amp;oe=utf-8


Linux swb20 2.6.30-2-686 #1 SMP Fri Dec 4 00:53:20 UTC 2009 i686 GNU/Linux

ii  kvm                                   1:0.12.3+dfsg-4             dummy \
transitional pacakge from kvm to qemu- ii  libvirt-bin                           \
0.7.7-1                     the programs for the libvirt library ii  libvirt-dev      \
0.7.7-1                     development files for the libvirt library ii  libvirt-doc \
0.7.7-1                     documentation for the libvirt library ii  libvirt0        \
0.7.7-1                     library for interfacing with different virtu ii  \
linux-image-2.6.30-2-686              2.6.30-8squeeze1            Linux 2.6.30 image \
on PPro/Celeron/PII/PIII/ ii  python-libvirt                        0.7.7-1           \
libvirt Python bindings ii  qemu-kvm                              0.12.3+dfsg-4       \
Full virtualization on x86 hardware

Is there any solution right now?
Is a solution in preperation?

Frank Matthie.
-- 
Frank Matthie


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20100409141044</emailId><senderName>"Gokhale, Shashibhushan"</senderName><senderEmail>shashibhushan_gokhale@bmc.com</senderEmail><timestampReceived>2010-04-09 14:10:44-0400</timestampReceived><subject>[libvirt-users] libvirt: C++ or Java</subject><body>

Hello,

I am planning to develop a management application for managing Redhat Xen a=
nd Redhat KVM hypervisors. I am evaluating the Java bindings versus the C++=
 version of libvirt. As part of evaluation, I could not find meaningful ans=
wers to the questions below. Hence, I thought that people on this mailing l=
ist would be the most appropriate to comment on them. Can you please let me=
 know your views?


1.     Are all functions that are available in C API available in Java?



2.     Are Java bindings added along with every enhancement to C API?


3.     If answer to above question is negative, typically how long does it =
takes for the addition of Java bindings for the enhancement?


4.     Most of libvirt based third party management applications use which =
of Java bindings or C API?


5.     What are your good/bad experiences while using either of C API or Ja=
va bindings?


6.     What is your concluding personal recommendation?


And finally, since libvirt is a Redhat Emerging Technology project, does Re=
dhat or any other third party service providers provide paid assistance, su=
pport?

Thanks,
Shashi


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;meta http-equiv=Content-Type content="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 12 (filtered medium)"&gt;
&lt;style&gt;
&lt;!--
 /* Font Definitions */
 @font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{mso-style-priority:34;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Arial","sans-serif";
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:1243877510;
	mso-list-type:hybrid;
	mso-list-template-ids:291270232 67698703 67698713 67698715 67698703 67698713 \
67698715 67698703 67698713 67698715;} @list l0:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
--&gt;
&lt;/style&gt;
&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapelayout v:ext="edit"&gt;
  &lt;o:idmap v:ext="edit" data="1" /&gt;
 &lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
&lt;/head&gt;

&lt;body lang=EN-US link=blue vlink=purple&gt;

&lt;div class=Section1&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;Hello,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;I
am planning to develop a management application for managing Redhat Xen and Redhat
KVM hypervisors. I am evaluating the Java bindings versus the C++ version of
libvirt. As part of evaluation, I could not find meaningful answers to the
questions below. Hence, I thought that people on this mailing list would be the
most appropriate to comment on them. Can you please let me know your \
views?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoListParagraph style='text-indent:-.25in;mso-list:l0 level1 lfo1'&gt;&lt;![if \
!supportLists]&gt;&lt;span style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;&lt;span
style='mso-list:Ignore'&gt;1.&lt;span style='font:7.0pt "Times New \
Roman"'&gt; &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;&lt;span \
style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;Are all functions that are \
available in C API available in Java? &lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoListParagraph&gt;&lt;span \
style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoListParagraph style='text-indent:-.25in;mso-list:l0 level1 lfo1'&gt;&lt;![if \
!supportLists]&gt;&lt;span style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;&lt;span
style='mso-list:Ignore'&gt;2.&lt;span style='font:7.0pt "Times New \
Roman"'&gt; &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;&lt;span \
style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;Are Java bindings added \
along with every enhancement to C API?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoListParagraph style='text-indent:-.25in;mso-list:l0 level1 lfo1'&gt;&lt;![if \
!supportLists]&gt;&lt;span style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;&lt;span
style='mso-list:Ignore'&gt;3.&lt;span style='font:7.0pt "Times New \
Roman"'&gt; &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;&lt;span \
style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;If answer to above question \
is negative, typically how long does it takes for the addition of Java bindings for \
the enhancement?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoListParagraph style='text-indent:-.25in;mso-list:l0 level1 lfo1'&gt;&lt;![if \
!supportLists]&gt;&lt;span style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;&lt;span
style='mso-list:Ignore'&gt;4.&lt;span style='font:7.0pt "Times New \
Roman"'&gt; &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;&lt;span \
style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;Most of libvirt based third \
party management applications use which of Java bindings or C \
API?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoListParagraph style='text-indent:-.25in;mso-list:l0 level1 lfo1'&gt;&lt;![if \
!supportLists]&gt;&lt;span style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;&lt;span
style='mso-list:Ignore'&gt;5.&lt;span style='font:7.0pt "Times New \
Roman"'&gt; &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;&lt;span \
style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;What are your good/bad \
experiences while using either of C API or Java bindings?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoListParagraph style='text-indent:-.25in;mso-list:l0 level1 lfo1'&gt;&lt;![if \
!supportLists]&gt;&lt;span style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;&lt;span
style='mso-list:Ignore'&gt;6.&lt;span style='font:7.0pt "Times New \
Roman"'&gt; &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;&lt;span \
style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;What is your concluding \
personal recommendation?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;And finally, since libvirt \
is a Redhat Emerging Technology project, does Redhat or any other third party service \
providers provide paid assistance, support?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;Thanks,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;Shashi&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Arial","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;



</body></email><email><emailId>20100401174152</emailId><senderName>"Nikolai K. Bochev"</senderName><senderEmail>n.bochev@grandstarco.com</senderEmail><timestampReceived>2010-04-01 17:41:52-0400</timestampReceived><subject>Re: [libvirt-users] connect libvirt and virtualbox</subject><body>

Excuse my ignorance, but , where can i get virtualbox 3.2 ? 
As far as i can see the last official release is 3.1.6 ? 

----- "angelo alfano" &lt;angeloalfa76@yahoo.it&gt; wrote: 








libvirt 0.7.0 
virtualbox 3.2 

Angelo 


_______________________________________________ 
libvirt-users mailing list 
libvirt-users@redhat.com 
https://www.redhat.com/mailman/listinfo/libvirt-users 



-- 


Nikolai K. Bochev 
System Administrator 




[Attachment #3 (text/html)]

&lt;html&gt;&lt;head&gt;&lt;style type='text/css'&gt;p { margin: 0; }&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div \
style='font-family: Arial; font-size: 10pt; color: #000000'&gt;Excuse my ignorance, but \
, where can i get virtualbox 3.2 ?&lt;br /&gt;As far as i can see the last official release \
is 3.1.6 ?&lt;br /&gt;&lt;br /&gt;----- "angelo alfano" &lt;angeloalfa76@yahoo.it&gt; wrote: &lt;br \
/&gt; &lt;blockquote style="border-left:2px solid \
#1010ff;margin-left:5px;padding-left:5px;"&gt; &lt;style&gt;&lt;!--
 DIV {margin:0px;}
--&gt;&lt;/style&gt;
&lt;div style="font-family:times new roman,new york,times,serif;font-size:12pt"&gt;&lt;/div&gt;
&lt;/blockquote&gt;
&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;
&lt;blockquote style="border-left:2px solid \
#1010ff;margin-left:5px;padding-left:5px;"&gt;libvirt 0.7.0&lt;br /&gt;virtualbox 3.2&lt;br /&gt;&lt;br \
/&gt;Angelo&lt;br /&gt; &lt;br /&gt; &lt;br /&gt;_______________________________________________&lt;br \
/&gt;libvirt-users mailing list&lt;br /&gt;libvirt-users@redhat.com&lt;br \
/&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;br /&gt;&lt;/blockquote&gt; &lt;br \
/&gt;&lt;span&gt;&lt;br /&gt;&lt;br /&gt;-- &lt;br /&gt; &lt;hr style="width: 100%; height: 2px;" /&gt;
&lt;br /&gt;&lt;span style="font-weight: bold;"&gt;Nikolai K. Bochev&lt;/span&gt;&lt;br /&gt;&lt;span \
style="font-weight: bold;"&gt;System Administrator&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br \
/&gt;&lt;/span&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20100505140139</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-05-05 14:01:39-0400</timestampReceived><subject>Re: [libvirt-users] FYI: Notes on setting up KVM guests using iSCSI</subject><body>

On Wed, May 05, 2010 at 08:50:57AM -0500, David Ehle wrote:
&gt; 
&gt; Daniel,
&gt; 
&gt; OK so I think I get it now. While for other storage backends one pool can 
&gt; hold multiple volumes, when using iSCIS there is alwasy a 1 to 1 
&gt; relationship for pool to volume? Each pool contains exactly one volume?

No, each pool can contain multiple volumes. If you have created a iSCSI
target and given it multiple LUNs, then you'll see multiple volumes in
libvirt. 

See the virsh vol-list output in this example:

&gt; &gt; http://berrange.com/posts/2010/05/05/provisioning-kvm-virtual-machines-on-iscsi-the-hard-way-part-2-of-2/
&gt; &gt; 

for an iSCSI target with 2 LUNs

Daniel
-- 
&gt; &gt; Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
&gt; &gt; http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
&gt; &gt; http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
&gt; &gt; GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|


</body></email><email><emailId>20100404201311</emailId><senderName>"Thomas Lutz"</senderName><senderEmail>t.lutz@clickforknowledge.com</senderEmail><timestampReceived>2010-04-04 20:13:11-0400</timestampReceived><subject>[libvirt-users] libvirt on Debian - can I safely upgrade?</subject><body>

Hi there,

 

I'm currently using libvirt 0.4.6 from the Debian sources with 6 VMs running
and since I'm getting random crashes of one of the VMs without any logfile
entry in either host or guest (libvirt debugging not turned on as I found
out about it just today) I want to upgrade to the latest version (0.7.7 - I
guess) from Debian backports.

 

Is this huge upgrade safely possible with just switching sources to
backports? Or can I expect problems? Rebooting the VMs is obligatory at the
end of the upgrade?

 

Thanks in advance and best regards,

Thomas Lutz


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 12 (filtered medium)"&gt;
&lt;style&gt;
&lt;!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-priority:99;
	mso-style-link:"Sprechblasentext Zchn";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";}
span.E-MailFormatvorlage17
	{mso-style-type:personal-compose;
	font-family:"Arial","sans-serif";
	color:windowtext;}
span.SprechblasentextZchn
	{mso-style-name:"Sprechblasentext Zchn";
	mso-style-priority:99;
	mso-style-link:Sprechblasentext;
	font-family:"Tahoma","sans-serif";}
.MsoChpDefault
	{mso-style-type:export-only;}
@page Section1
	{size:612.0pt 792.0pt;
	margin:70.85pt 70.85pt 2.0cm 70.85pt;}
div.Section1
	{page:Section1;}
--&gt;
&lt;/style&gt;
&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapelayout v:ext="edit"&gt;
  &lt;o:idmap v:ext="edit" data="1" /&gt;
 &lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
&lt;/head&gt;

&lt;body lang=DE link=blue vlink=purple&gt;

&lt;div class=Section1&gt;

&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;Hi there,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;Im currently using libvirt 0.4.6 from
the Debian sources with 6 VMs running and since Im getting random
crashes of one of the VMs without any logfile entry in either host or guest
(libvirt debugging not turned on as I found out about it just today) I want to
upgrade to the latest version (0.7.7 - I guess) from Debian \
backports.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;Is this huge upgrade safely possible with
just switching sources to backports? Or can I expect problems? Rebooting the
VMs is obligatory at the end of the upgrade?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;Thanks in advance and best \
regards,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span lang=EN-US&gt;Thomas Lutz&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;



</body></email><email><emailId>20100406185556</emailId><senderName>Sharad Mishra</senderName><senderEmail>snmishra@us.ibm.com</senderEmail><timestampReceived>2010-04-06 18:55:56-0400</timestampReceived><subject>[libvirt-users] VIR_DOMAIN_DEVICE_MODIFY_CONFIG flag.</subject><body>

Hi,

	If a resource in a live VM is modified with the flag  "
VIR_DOMAIN_DEVICE_MODIFY_CONFIG". Is it same as - do not modify the
resource now but change it at next boot?

Thanks
Sharad Mishra
IBM
[Attachment #3 (text/html)]

&lt;html&gt;&lt;body&gt;
&lt;p&gt;&lt;font size="4"&gt;Hi,&lt;/font&gt;&lt;br&gt;
&lt;br&gt;
&lt;font size="4"&gt;	If a resource in a live VM is modified with the flag&lt;/font&gt;  \
"&lt;font size="4"&gt;VIR_DOMAIN_DEVICE_MODIFY_CONFIG". Is it same as - do not \
modify the resource now but change it at next boot?&lt;/font&gt;&lt;br&gt; &lt;br&gt;
&lt;font size="4"&gt;Thanks&lt;/font&gt;&lt;br&gt;
&lt;font size="4"&gt;Sharad Mishra&lt;br&gt;
IBM&lt;/font&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20100409143041</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-04-09 14:30:41-0400</timestampReceived><subject>Re: [libvirt-users] libvirt, kvm, pxe boot failed</subject><body>

On 04/09/2010 10:02 AM, Frank Matthie wrote:
&gt; Hello all,
&gt; 
&gt; on my debian squeeze system i have the problem as some others[1] using
&gt; this combination of libvirt, kvm and qemu.
&gt; 
&gt; "Cannot boot from non-existent NIC" is the qemu-kvm error message
&gt; 
&gt; [1] http://www.google.com/search?q=libvirt+Cannot+boot+from+non-existent+NIC&amp;ie=utf-8&amp;oe=utf-8
&gt;  
&gt; Linux swb20 2.6.30-2-686 #1 SMP Fri Dec 4 00:53:20 UTC 2009 i686 GNU/Linux
&gt; 
&gt; ii  kvm                                   1:0.12.3+dfsg-4             dummy \
&gt; transitional pacakge from kvm to qemu- ii  libvirt-bin                           \
&gt; 0.7.7-1                     the programs for the libvirt library ii  libvirt-dev    \
&gt; 0.7.7-1                     development files for the libvirt library ii  \
&gt; libvirt-doc                           0.7.7-1                     documentation for \
&gt; the libvirt library ii  libvirt0                              0.7.7-1               \
&gt; library for interfacing with different virtu ii  linux-image-2.6.30-2-686           \
&gt; 2.6.30-8squeeze1            Linux 2.6.30 image on PPro/Celeron/PII/PIII/ ii  \
&gt; python-libvirt                        0.7.7-1                     libvirt Python \
&gt; bindings ii  qemu-kvm                              0.12.3+dfsg-4               Full \
&gt; virtualization on x86 hardware 
&gt; Is there any solution right now?
&gt; Is a solution in preperation?
&gt; 

I believe this is a qemu bugs, patches have been posted upstream:

http://lists.gnu.org/archive/html/qemu-devel/2010-04/msg00378.html

- Cole


</body></email><email><emailId>20100409152402</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-04-09 15:24:02-0400</timestampReceived><subject>Re: [libvirt-users] ESX support</subject><body>

2010/4/7 Aaron Lippold &lt;lippold@gmail.com&gt;:
&gt; Hi Matthias,
&gt;
&gt; Sorry for the late reply. I was on travel with limited network access last week.
&gt;
&gt; That sounds great, if you need any help or someone to test stuff,
&gt; please let me know since I am highly interested in helping in any way
&gt; I can.

More testing is always good to have.

&gt; First question, when I am testing can I use VMWare Workstation on my
&gt; laptop as a replacement for a full fledged for just testing API and
&gt; libVirt access? If so I can set that up on my F12 box and start
&gt; running some tests with libvirt and cobbler.

Sorry, but VMware Workstation will not work. The libvirt VMware
support is based on the VMware vSphere API. This API is supported by
VMware ESX/ESXi 3.5 and newer and VMware Server 2.0 and newer
(formally known as VMware GSX). So if you don't have ans ESX/ESXi
server at hand to test, you could use VMware Server 2.0, that can be
downloaded and used for free.

&gt; Any new updates on the storage and network efforts? What are the basic
&gt; requirements that you are going to try to initially hit. I assume
&gt; there is alway more you could do but what's your 1.0 'good to go' set?

I think a 'good to go' set for the storage and network support should
allow to create a new virtual machine using virt-manager. Currently
this is hindered by missing storage support.

Matthias

&gt; Thanks,
&gt;
&gt; Aaron
&gt;
&gt; On Sun, Mar 21, 2010 at 1:26 PM, Matthias Bolte
&gt; &lt;matthias.bolte@googlemail.com&gt; wrote:
&gt;&gt; You can manage the power state of a domain (start, stop, suspend, and
&gt;&gt; resume), you can also define a new domain, undefine existing domains,
&gt;&gt; migrate domains between hosts and configure CPU and RAM limits of a
&gt;&gt; domain.
&gt;&gt;
&gt;&gt; Two major missing features are currently storage and network
&gt;&gt; management. This means that you currently cannot use the libvirt
&gt;&gt; storage and network API to manage the storage and network of an ESX
&gt;&gt; server. I'm going to address this soon.
&gt;&gt;
&gt;&gt; A minor missing feature is editing the virtual hardware configuration
&gt;&gt; of an existing domain. I'm currently working on this.
&gt;&gt;
&gt;&gt; The problem reported by Jonathan Kelley affects ESX 4.0 only. It's not
&gt;&gt; fixed yet, but I think I can get it fixed for libvirt 0.7.8. I've
&gt;&gt; withdrawn the first patch fix this issue. A better patch is more
&gt;&gt; involved, because I need to rework the controller handling internally.
&gt;&gt;
&gt;&gt; Documentation about the ESX support can be found at:
&gt;&gt; http://www.libvirt.org/drvesx.html
&gt;&gt;
&gt;&gt; If you have any questions about the ESX support feel free to ask.
&gt;&gt;
&gt;&gt; Matthias
&gt;&gt;
&gt;&gt; 2010/3/19 Aaron Lippold &lt;lippold@gmail.com&gt;:
&gt;&gt;&gt; Hi,
&gt;&gt;&gt;
&gt;&gt;&gt; So google and the mailing list didn't clearly state if we could or
&gt;&gt;&gt; couldn't create a new vm in a domain on ESX or just turn it on, off,
&gt;&gt;&gt; restart etc.
&gt;&gt;&gt;
&gt;&gt;&gt; Has the XML generation issue been addressed in 0.7.6+? If the docs
&gt;&gt;&gt; exist, please point me to them and I will be glad to RT*M :).
&gt;&gt;&gt;
&gt;&gt;&gt; Thanks,
&gt;&gt;&gt;
&gt;&gt;&gt; A
&gt;&gt;&gt;
&gt;&gt;&gt; On Fri, Mar 12, 2010 at 4:21 PM, Matthias Bolte
&gt;&gt;&gt; &lt;matthias.bolte@googlemail.com&gt; wrote:
&gt;&gt;&gt;&gt; 2010/3/9 Jonathan Kelley &lt;jkelley@vm-labs.com&gt;:
&gt;&gt;&gt;&gt;&gt; Just curious but how long has ESX support been in libvirt?
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Since version 0.7.0 (August 2009).
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Also I noticed this error when accessing one of my windows vms:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; error: internal error Expecting VMX entry 'scsi0.virtualDev' to be
&gt;&gt;&gt;&gt;&gt; 'buslogic' or 'lsilogic' but found 'lsisas1068'
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; I've just posted a patch to add lsisas1068 to the list of known SCSI
&gt;&gt;&gt;&gt; controller types.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Thanks for reporting.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Matthias
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt;

</body></email><email><emailId>20100411051138</emailId><senderName>"Gokhale, Shashibhushan"</senderName><senderEmail>shashibhushan_gokhale@bmc.com</senderEmail><timestampReceived>2010-04-11 05:11:38-0400</timestampReceived><subject>[libvirt-users] libvirt: C++ or Java</subject><body>

Hello,

I am planning to develop a management application for managing Redhat Xen and Redhat \
KVM hypervisors. I am evaluating the Java bindings versus the C++ version of libvirt. \
As part of evaluation, I could not find meaningful answers to the questions below. \
Hence, I thought that people on this mailing list would be the most appropriate to \
comment on them. Can you please let me know your views?


1.     Are all functions that are available in C API available in Java?



2.     Are Java bindings added along with every enhancement to C API?


3.     If answer to above question is negative, typically how long does it takes for \
the addition of Java bindings for the enhancement?


4.     Most of libvirt based third party management applications use which of Java \
bindings or C API?


5.     What are your good/bad experiences while using either of C API or Java \
bindings?


6.     What is your concluding personal recommendation?


And finally, since libvirt is a Redhat Emerging Technology project, does Redhat or \
any other third party service providers provide paid assistance, support?

Thanks,
Shashi


</body></email><email><emailId>20100301131413</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-03-01 13:14:13-0400</timestampReceived><subject>Re: [libvirt-users] location of network xml files</subject><body>

On 03/01/2010 03:47 AM, carlos campderrs wrote:
&gt; Hi Cole,
&gt; 
&gt; 2010/3/1 Cole Robinson &lt;crobinso@redhat.com &lt;mailto:crobinso@redhat.com&gt;&gt;
&gt; 
&gt; You aren't supposed to edit the XML files in /etc/libvirt/qemu
&gt; directly, you
&gt; should use virsh for that:
&gt; 
&gt; http://wiki.libvirt.org/page/FAQ#Where_are_VM_config_files_stored.3F_How_do_I_edit_a_VM.27s_XML_config.3F
&gt;  
&gt; 
&gt; Thank you, didn't see that wiki FAQ, but only http://libvirt.org/FAQ.html.
&gt; 

No worries, it's only a week old. We will probably be linking to it from the
homepage soon.

- Cole


</body></email><email><emailId>20100302225716</emailId><senderName>Thomas Graves</senderName><senderEmail>tgraves@yahoo-inc.com</senderEmail><timestampReceived>2010-03-02 22:57:16-0400</timestampReceived><subject>[libvirt-users] Libvirt and openvz?</subject><body>

I just recently started using openvz and I'm trying to use libvirt/virsh
with it.  

I followed the directions on page: http://libvirt.org/drvopenvz.html

But I get an error trying to run define with the example config file:

 virsh define virt.conf
error: Failed to define domain from virt.conf
error: unknown OS type exe

I'm using libvirt 0.7.2.

Does anyone have more example configuration files or other setup
instructions?

Does Libvirt allow you to specify other resource limits and controls that
openvz has - like vzctl set --devnodes device:rw or vzctl set kmemsize?

Thanks,
Tom


</body></email><email><emailId>20100303174434</emailId><senderName>Marco Mornati</senderName><senderEmail>mmornati@byte-code.com</senderEmail><timestampReceived>2010-03-03 17:44:34-0400</timestampReceived><subject>[libvirt-users] Libvirt Auth</subject><body>

Hello guys,

I've created a plugin for Hudson (CI) to manage virtmachines using  
libvirt java (start vm for a build and stop just after).

I've just a problem in authentication, in fact I cannot send uname and  
password using code, libvirt ask me for the credentials on CLI.  
someone could explain me How I can use authentican or where I can find  
an usage guide or example?

Thanks a lot
Bye
Marco


[Attachment #3 (text/html)]

&lt;html&gt;&lt;body bgcolor="#FFFFFF"&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;span class="Apple-style-span" \
style="font-size: 15px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.296875); \
-webkit-composition-fill-color: rgba(175, 192, 227, 0.230469); \
-webkit-composition-frame-color: rgba(77, 128, 180, 0.230469); "&gt;&lt;span&gt;Hello \
guys,&lt;/span&gt;&lt;br&gt;&lt;span&gt;&lt;/span&gt;&lt;br&gt;&lt;span&gt;I've created a plugin for Hudson (CI) to \
manage virtmachines using libvirt java (start vm for a build and stop just \
after).&lt;/span&gt;&lt;br&gt;&lt;span&gt;&lt;/span&gt;&lt;br&gt;&lt;span&gt;I've just a problem in authentication, in \
fact I cannot send uname and password using code, libvirt ask me for the credentials \
on CLI. someone could explain me How I can use authentican or where I can find an \
usage guide or example?&lt;/span&gt;&lt;br&gt;&lt;span&gt;&lt;/span&gt;&lt;br&gt;&lt;span&gt;Thanks a \
lot&lt;/span&gt;&lt;br&gt;&lt;span&gt;Bye&lt;/span&gt;&lt;br&gt;&lt;span&gt;Marco&lt;/span&gt;&lt;br&gt;&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;




</body></email><email><emailId>20100304210438</emailId><senderName>Jonathan Kelley</senderName><senderEmail>jkelley@vm-labs.com</senderEmail><timestampReceived>2010-03-04 21:04:38-0400</timestampReceived><subject>Re: [libvirt-users] ESX access using libvirt</subject><body>

Brilliant! I was not building with ESX support.

Thanks.

On Thu, Mar 4, 2010 at 2:31 PM, Matthias Bolte &lt;
matthias.bolte@googlemail.com&gt; wrote:

&gt; 2010/3/4 Jonathan Kelley &lt;jkelley@vm-labs.com&gt;:
&gt; &gt; I must be missing something here so I don't need to install anything but
&gt; &gt; using esx requires what looks like TLS configured along with libvirtd
&gt; &gt; running on ESX.
&gt; &gt; When I do esx:// I get the following:
&gt; &gt; 14:07:44.736: debug : virConnectOpenAuth:1355 :
&gt; name=esx://test?no_verify=1,
&gt; &gt; auth=0x7f4512a6e5a0, flags=0
&gt; &gt; 14:07:44.736: debug : do_open:1110 : name "esx://test?no_verify=1" to URI
&gt; &gt; components:
&gt; &gt;   scheme esx
&gt; &gt;   opaque (null)
&gt; &gt;   authority (null)
&gt; &gt;   server test
&gt; &gt;   user (null)
&gt; &gt;   port 0
&gt; &gt;   path ?no_verify=1
&gt;
&gt; Your libxml2 version expects a / before the query parameters. you
&gt; should use esx://test/?no_verify=1 as URI.
&gt;
&gt; &gt; 14:07:44.736: debug : do_open:1120 : trying driver 0 (Test) ...
&gt; &gt; 14:07:44.736: debug : do_open:1126 : driver 0 Test returned DECLINED
&gt; &gt; 14:07:44.736: debug : do_open:1120 : trying driver 1 (OPENVZ) ...
&gt; &gt; 14:07:44.736: debug : do_open:1126 : driver 1 OPENVZ returned DECLINED
&gt; &gt; 14:07:44.736: debug : do_open:1120 : trying driver 2 (VBOX) ...
&gt; &gt; 14:07:44.736: debug : do_open:1126 : driver 2 VBOX returned DECLINED
&gt;
&gt; Here libvirt should probe the ESX driver, but it doesn't, and because
&gt; no driver accepted the URI until here libvirt probes the remote
&gt; driver. The remote driver then tries to connect to a libvirtd on the
&gt; ESX server but fails.
&gt;
&gt; Sorry, I should have spotted this problem in your previous mail.
&gt;
&gt; &gt; 14:07:44.736: debug : do_open:1120 : trying driver 3 (remote) ...
&gt; &gt; 14:07:44.736: debug : doRemoteOpen:564 : proceeding with name =
&gt; &gt; esx://%3Fno_verify=1
&gt; &gt; 14:07:44.737: debug : initialise_gnutls:1143 : loading CA file
&gt; &gt; /apps/etc/pki/CA/cacert.pem
&gt; &gt; 14:07:44.737: debug : initialise_gnutls:1156 : loading client cert and
&gt; key
&gt; &gt; from files /apps/etc/pki/libvirt/clientcert.pem and
&gt; &gt; /apps/etc/pki/libvirt/private/clientkey.pem
&gt; &gt; 14:07:44.739: error : doRemoteOpen:644 : unable to connect to libvirtd at
&gt; &gt; 'test': Connection refused
&gt; &gt; 14:07:44.739: debug : do_open:1126 : driver 3 remote returned ERROR
&gt; &gt; 14:07:44.739: debug : virUnrefConnect:259 : unref connection 0x1f3bd10 1
&gt; &gt; 14:07:44.739: debug : virReleaseConnect:216 : release connection
&gt; 0x1f3bd10
&gt; &gt; -Jon
&gt;
&gt; The problems here is that your libvirt doesn't have ESX support
&gt; enabled. The ESX driver requires libcurl 7.18.0 or newer. The
&gt; configure script tests if libcurl is available and disables ESX
&gt; support if it's missing. Check the summary at the end of the configure
&gt; script output and make sure it says 'ESX: yes'.
&gt;
&gt; The libvirt error reporting in the case of known but disabled drivers
&gt; is not so useful. You're not the first one that struggles with this
&gt; problem. I've a half finished patch lying around that addresses this
&gt; problem and improves the error reporting in this situation.
&gt;
&gt; Matthias
&gt;
&gt; &gt; On Thu, Mar 4, 2010 at 1:54 PM, Matthias Bolte
&gt; &gt; &lt;matthias.bolte@googlemail.com&gt; wrote:
&gt; &gt;&gt;
&gt; &gt;&gt; Ah, don't use esx+ssh://, just use esx://
&gt; &gt;&gt;
&gt; &gt;&gt; The scheme format &lt;driver&gt;+&lt;transport&gt;:// implies that you want to use
&gt; &gt;&gt; the libvirt remote mechanisms via the libvirt daemon (libvirtd) or the
&gt; &gt;&gt; server side, but the ESX driver doesn't use this. It directly connects
&gt; &gt;&gt; to the ESX server using HTTPS.
&gt; &gt;&gt;
&gt; &gt;&gt; You do not need to have or install netcat on the ESX server, as said
&gt; &gt;&gt; before an out-of-the-box ESX installation is sufficient.
&gt; &gt;&gt;
&gt; &gt;&gt; Matthias
&gt; &gt;&gt;
&gt; &gt;&gt; 2010/3/4 Jonathan Kelley &lt;jkelley@vm-labs.com&gt;:
&gt; &gt;&gt; &gt; I built it from the 0.7.6 sources but it still shows me that it is
&gt; &gt;&gt; &gt; running
&gt; &gt;&gt; &gt; the 'nc' command on the ESX server (which does not exist). Is netcat
&gt; &gt;&gt; &gt; required to be on ESX?
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; 13:24:26.765: debug : do_open:1110 : name "esx+ssh://test" to URI
&gt; &gt;&gt; &gt; components:
&gt; &gt;&gt; &gt;  scheme esx+ssh
&gt; &gt;&gt; &gt;  opaque (null)
&gt; &gt;&gt; &gt;  authority (null)
&gt; &gt;&gt; &gt;  server test
&gt; &gt;&gt; &gt;  user (null)
&gt; &gt;&gt; &gt;  port 0
&gt; &gt;&gt; &gt;  path
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; 13:24:26.765: debug : do_open:1120 : trying driver 0 (Test) ...
&gt; &gt;&gt; &gt; 13:24:26.765: debug : do_open:1126 : driver 0 Test returned DECLINED
&gt; &gt;&gt; &gt; 13:24:26.765: debug : do_open:1120 : trying driver 1 (OPENVZ) ...
&gt; &gt;&gt; &gt; 13:24:26.765: debug : do_open:1126 : driver 1 OPENVZ returned DECLINED
&gt; &gt;&gt; &gt; 13:24:26.765: debug : do_open:1120 : trying driver 2 (VBOX) ...
&gt; &gt;&gt; &gt; 13:24:26.765: debug : do_open:1126 : driver 2 VBOX returned DECLINED
&gt; &gt;&gt; &gt; 13:24:26.765: debug : do_open:1120 : trying driver 3 (remote) ...
&gt; &gt;&gt; &gt; 13:24:26.765: debug : doRemoteOpen:564 : proceeding with name = esx://
&gt; &gt;&gt; &gt; 13:24:26.765: debug : virExecWithHook:640 : ssh test nc -U
&gt; &gt;&gt; &gt; /apps/var/run/libvirt/libvirt-sock
&gt; &gt;&gt; &gt; 13:24:26.769: debug : remoteIO:8429 : Do proc=66 serial=0 length=28
&gt; &gt;&gt; &gt; wait=(nil)
&gt; &gt;&gt; &gt; 13:24:26.769: debug : remoteIO:8491 : We have the buck 66
&gt; 0x7fc565c4b010
&gt; &gt;&gt; &gt; 0x7fc565c4b010
&gt; &gt;&gt; &gt; 13:24:31.384: error : remoteIOReadBuffer:7707 : server closed
&gt; connection
&gt; &gt;&gt; &gt; 13:24:31.384: debug : remoteIOEventLoop:8376 : Giving up the buck due
&gt; to
&gt; &gt;&gt; &gt; I/O
&gt; &gt;&gt; &gt; error 66 0x7fc565c4b010 (nil)
&gt; &gt;&gt; &gt; 13:24:31.384: debug : do_open:1126 : driver 3 remote returned ERROR
&gt; &gt;&gt; &gt; 13:24:31.384: debug : virUnrefConnect:259 : unref connection 0x1146d20
&gt; 1
&gt; &gt;&gt; &gt; 13:24:31.384: debug : virReleaseConnect:216 : release connection
&gt; &gt;&gt; &gt; 0x1146d20
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; Thanks,
&gt; &gt;&gt; &gt; Jon
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; On Thu, Mar 4, 2010 at 12:26 PM, Matthias Bolte
&gt; &gt;&gt; &gt; &lt;matthias.bolte@googlemail.com&gt; wrote:
&gt; &gt;&gt; &gt;&gt; 2010/3/4 Jonathan Kelley &lt;jkelley@vm-labs.com&gt;:
&gt; &gt;&gt; &gt;&gt;&gt; Hello,
&gt; &gt;&gt; &gt;&gt;&gt;
&gt; &gt;&gt; &gt;&gt;&gt; I am trying to access an ESXi host using libvirt but it seems that
&gt; it
&gt; &gt;&gt; &gt;&gt;&gt; requires netcat to be running on the ESX server.
&gt; &gt;&gt; &gt;&gt;&gt;
&gt; &gt;&gt; &gt;&gt;&gt; My ESX 4 does not have this installed and I am wondering if this is
&gt; &gt;&gt; &gt;&gt;&gt; required or is there some other way to get this working?
&gt; &gt;&gt; &gt;&gt;&gt;
&gt; &gt;&gt; &gt;&gt;&gt; Thanks,
&gt; &gt;&gt; &gt;&gt;&gt; Jon
&gt; &gt;&gt; &gt;&gt;&gt;
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; No, you do not have to install anything on the ESX or ESXi server.
&gt; &gt;&gt; &gt;&gt; libvirt works with an out-of-the-box installation of ESX.
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; Make sure your libvirt version is new enough (0.7.0 or newer) and
&gt; that
&gt; &gt;&gt; &gt;&gt; the ESX support is enabled. For example if you've installed libvirt
&gt; &gt;&gt; &gt;&gt; from Debian packages then you'll need to build libvirt from source,
&gt; &gt;&gt; &gt;&gt; because Debian explicitly disables ESX support in their packages for
&gt; &gt;&gt; &gt;&gt; some unknown reason.
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; See http://libvirt.org/drvesx.html if you haven't yet.
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; Matthias
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt;

[Attachment #3 (text/html)]

Brilliant! I was not building with ESX \
support.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks.&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Thu, Mar 4, \
2010 at 2:31 PM, Matthias Bolte &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt; &lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt;&lt;div class="im"&gt;2010/3/4 Jonathan Kelley &lt;&lt;a \
href="mailto:jkelley@vm-labs.com"&gt;jkelley@vm-labs.com&lt;/a&gt;&gt;:&lt;br&gt; &lt;/div&gt;&lt;div \
class="im"&gt;&gt; I must be missing something here so I don't need to install \
anything but&lt;br&gt; &gt; using esx requires what looks like TLS configured along with \
libvirtd&lt;br&gt; &gt; running on ESX.&lt;br&gt;
&gt; When I do esx:// I get the following:&lt;br&gt;
&gt; 14:07:44.736: debug : virConnectOpenAuth:1355 : name=esx://test?no_verify=1,&lt;br&gt;
&gt; auth=0x7f4512a6e5a0, flags=0&lt;br&gt;
&gt; 14:07:44.736: debug : do_open:1110 : name "esx://test?no_verify=1" to \
URI&lt;br&gt; &gt; components:&lt;br&gt;
&gt;   scheme esx&lt;br&gt;
&gt;   opaque (null)&lt;br&gt;
&gt;   authority (null)&lt;br&gt;
&gt;   server test&lt;br&gt;
&gt;   user (null)&lt;br&gt;
&gt;   port 0&lt;br&gt;
&gt;   path ?no_verify=1&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;Your libxml2 version expects a / before the query parameters. you&lt;br&gt;
should use esx://test/?no_verify=1 as URI.&lt;br&gt;
&lt;div class="im"&gt;&lt;br&gt;
&gt; 14:07:44.736: debug : do_open:1120 : trying driver 0 (Test) ...&lt;br&gt;
&gt; 14:07:44.736: debug : do_open:1126 : driver 0 Test returned DECLINED&lt;br&gt;
&gt; 14:07:44.736: debug : do_open:1120 : trying driver 1 (OPENVZ) ...&lt;br&gt;
&gt; 14:07:44.736: debug : do_open:1126 : driver 1 OPENVZ returned DECLINED&lt;br&gt;
&gt; 14:07:44.736: debug : do_open:1120 : trying driver 2 (VBOX) ...&lt;br&gt;
&gt; 14:07:44.736: debug : do_open:1126 : driver 2 VBOX returned DECLINED&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;Here libvirt should probe the ESX driver, but it doesn't, and because&lt;br&gt;
no driver accepted the URI until here libvirt probes the remote&lt;br&gt;
driver. The remote driver then tries to connect to a libvirtd on the&lt;br&gt;
ESX server but fails.&lt;br&gt;
&lt;br&gt;
Sorry, I should have spotted this problem in your previous mail.&lt;br&gt;
&lt;div class="im"&gt;&lt;br&gt;
&gt; 14:07:44.736: debug : do_open:1120 : trying driver 3 (remote) ...&lt;br&gt;
&gt; 14:07:44.736: debug : doRemoteOpen:564 : proceeding with name =&lt;br&gt;
&gt; esx://%3Fno_verify=1&lt;br&gt;
&gt; 14:07:44.737: debug : initialise_gnutls:1143 : loading CA file&lt;br&gt;
&gt; /apps/etc/pki/CA/cacert.pem&lt;br&gt;
&gt; 14:07:44.737: debug : initialise_gnutls:1156 : loading client cert and key&lt;br&gt;
&gt; from files /apps/etc/pki/libvirt/clientcert.pem and&lt;br&gt;
&gt; /apps/etc/pki/libvirt/private/clientkey.pem&lt;br&gt;
&gt; 14:07:44.739: error : doRemoteOpen:644 : unable to connect to libvirtd at&lt;br&gt;
&gt; 'test': Connection refused&lt;br&gt;
&gt; 14:07:44.739: debug : do_open:1126 : driver 3 remote returned ERROR&lt;br&gt;
&gt; 14:07:44.739: debug : virUnrefConnect:259 : unref connection 0x1f3bd10 1&lt;br&gt;
&gt; 14:07:44.739: debug : virReleaseConnect:216 : release connection 0x1f3bd10&lt;br&gt;
&gt; -Jon&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;The problems here is that your libvirt doesn't have ESX support&lt;br&gt;
enabled. The ESX driver requires libcurl 7.18.0 or newer. The&lt;br&gt;
configure script tests if libcurl is available and disables ESX&lt;br&gt;
support if it's missing. Check the summary at the end of the configure&lt;br&gt;
script output and make sure it says 'ESX: yes'.&lt;br&gt;
&lt;br&gt;
The libvirt error reporting in the case of known but disabled drivers&lt;br&gt;
is not so useful. You're not the first one that struggles with this&lt;br&gt;
problem. I've a half finished patch lying around that addresses this&lt;br&gt;
problem and improves the error reporting in this situation.&lt;br&gt;
&lt;font color="#888888"&gt;&lt;br&gt;
Matthias&lt;br&gt;
&lt;/font&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;&lt;br&gt;
&gt; On Thu, Mar 4, 2010 at 1:54 PM, Matthias Bolte&lt;br&gt;
&gt; &lt;&lt;a href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; Ah, don't use esx+ssh://, just use esx://&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; The scheme format &lt;driver&gt;+&lt;transport&gt;:// implies that you want \
to use&lt;br&gt; &gt;&gt; the libvirt remote mechanisms via the libvirt daemon (libvirtd) \
or the&lt;br&gt; &gt;&gt; server side, but the ESX driver doesn't use this. It directly \
connects&lt;br&gt; &gt;&gt; to the ESX server using HTTPS.&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; You do not need to have or install netcat on the ESX server, as said&lt;br&gt;
&gt;&gt; before an out-of-the-box ESX installation is sufficient.&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; Matthias&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; 2010/3/4 Jonathan Kelley &lt;&lt;a \
href="mailto:jkelley@vm-labs.com"&gt;jkelley@vm-labs.com&lt;/a&gt;&gt;:&lt;br&gt; &gt;&gt; &gt; I \
built it from the 0.7.6 sources but it still shows me that it is&lt;br&gt; &gt;&gt; &gt; \
running&lt;br&gt; &gt;&gt; &gt; the 'nc' command on the ESX server (which does not \
exist). Is netcat&lt;br&gt; &gt;&gt; &gt; required to be on ESX?&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt; 13:24:26.765: debug : do_open:1110 : name "esx+ssh://test" to \
URI&lt;br&gt; &gt;&gt; &gt; components:&lt;br&gt;
&gt;&gt; &gt;  scheme esx+ssh&lt;br&gt;
&gt;&gt; &gt;  opaque (null)&lt;br&gt;
&gt;&gt; &gt;  authority (null)&lt;br&gt;
&gt;&gt; &gt;  server test&lt;br&gt;
&gt;&gt; &gt;  user (null)&lt;br&gt;
&gt;&gt; &gt;  port 0&lt;br&gt;
&gt;&gt; &gt;  path&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt; 13:24:26.765: debug : do_open:1120 : trying driver 0 (Test) ...&lt;br&gt;
&gt;&gt; &gt; 13:24:26.765: debug : do_open:1126 : driver 0 Test returned \
DECLINED&lt;br&gt; &gt;&gt; &gt; 13:24:26.765: debug : do_open:1120 : trying driver 1 \
(OPENVZ) ...&lt;br&gt; &gt;&gt; &gt; 13:24:26.765: debug : do_open:1126 : driver 1 OPENVZ \
returned DECLINED&lt;br&gt; &gt;&gt; &gt; 13:24:26.765: debug : do_open:1120 : trying \
driver 2 (VBOX) ...&lt;br&gt; &gt;&gt; &gt; 13:24:26.765: debug : do_open:1126 : driver 2 \
VBOX returned DECLINED&lt;br&gt; &gt;&gt; &gt; 13:24:26.765: debug : do_open:1120 : trying \
driver 3 (remote) ...&lt;br&gt; &gt;&gt; &gt; 13:24:26.765: debug : doRemoteOpen:564 : \
proceeding with name = esx://&lt;br&gt; &gt;&gt; &gt; 13:24:26.765: debug : \
virExecWithHook:640 : ssh test nc -U&lt;br&gt; &gt;&gt; &gt; \
/apps/var/run/libvirt/libvirt-sock&lt;br&gt; &gt;&gt; &gt; 13:24:26.769: debug : \
remoteIO:8429 : Do proc=66 serial=0 length=28&lt;br&gt; &gt;&gt; &gt; wait=(nil)&lt;br&gt;
&gt;&gt; &gt; 13:24:26.769: debug : remoteIO:8491 : We have the buck 66 \
0x7fc565c4b010&lt;br&gt; &gt;&gt; &gt; 0x7fc565c4b010&lt;br&gt;
&gt;&gt; &gt; 13:24:31.384: error : remoteIOReadBuffer:7707 : server closed \
connection&lt;br&gt; &gt;&gt; &gt; 13:24:31.384: debug : remoteIOEventLoop:8376 : Giving up \
the buck due to&lt;br&gt; &gt;&gt; &gt; I/O&lt;br&gt;
&gt;&gt; &gt; error 66 0x7fc565c4b010 (nil)&lt;br&gt;
&gt;&gt; &gt; 13:24:31.384: debug : do_open:1126 : driver 3 remote returned ERROR&lt;br&gt;
&gt;&gt; &gt; 13:24:31.384: debug : virUnrefConnect:259 : unref connection 0x1146d20 \
1&lt;br&gt; &gt;&gt; &gt; 13:24:31.384: debug : virReleaseConnect:216 : release \
connection&lt;br&gt; &gt;&gt; &gt; 0x1146d20&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt; Thanks,&lt;br&gt;
&gt;&gt; &gt; Jon&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt; On Thu, Mar 4, 2010 at 12:26 PM, Matthias Bolte&lt;br&gt;
&gt;&gt; &gt; &lt;&lt;a \
href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt; &gt;&gt; &gt;&gt; 2010/3/4 Jonathan Kelley &lt;&lt;a \
href="mailto:jkelley@vm-labs.com"&gt;jkelley@vm-labs.com&lt;/a&gt;&gt;:&lt;br&gt; &gt;&gt; \
&gt;&gt;&gt; Hello,&lt;br&gt; &gt;&gt; &gt;&gt;&gt;&lt;br&gt;
&gt;&gt; &gt;&gt;&gt; I am trying to access an ESXi host using libvirt but it seems \
that it&lt;br&gt; &gt;&gt; &gt;&gt;&gt; requires netcat to be running on the ESX \
server.&lt;br&gt; &gt;&gt; &gt;&gt;&gt;&lt;br&gt;
&gt;&gt; &gt;&gt;&gt; My ESX 4 does not have this installed and I am wondering if \
this is&lt;br&gt; &gt;&gt; &gt;&gt;&gt; required or is there some other way to get this \
working?&lt;br&gt; &gt;&gt; &gt;&gt;&gt;&lt;br&gt;
&gt;&gt; &gt;&gt;&gt; Thanks,&lt;br&gt;
&gt;&gt; &gt;&gt;&gt; Jon&lt;br&gt;
&gt;&gt; &gt;&gt;&gt;&lt;br&gt;
&gt;&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; &gt;&gt; No, you do not have to install anything on the ESX or ESXi \
server.&lt;br&gt; &gt;&gt; &gt;&gt; libvirt works with an out-of-the-box installation of \
ESX.&lt;br&gt; &gt;&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; &gt;&gt; Make sure your libvirt version is new enough (0.7.0 or newer) and \
that&lt;br&gt; &gt;&gt; &gt;&gt; the ESX support is enabled. For example if you've \
installed libvirt&lt;br&gt; &gt;&gt; &gt;&gt; from Debian packages then you'll need to \
build libvirt from source,&lt;br&gt; &gt;&gt; &gt;&gt; because Debian explicitly disables \
ESX support in their packages for&lt;br&gt; &gt;&gt; &gt;&gt; some unknown reason.&lt;br&gt;
&gt;&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; &gt;&gt; See &lt;a href="http://libvirt.org/drvesx.html" \
target="_blank"&gt;http://libvirt.org/drvesx.html&lt;/a&gt; if you haven't yet.&lt;br&gt; \
&gt;&gt; &gt;&gt;&lt;br&gt; &gt;&gt; &gt;&gt; Matthias&lt;br&gt;
&gt;&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&gt; &gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20100304171317</emailId><senderName>Jonathan Kelley</senderName><senderEmail>jkelley@vm-labs.com</senderEmail><timestampReceived>2010-03-04 17:13:17-0400</timestampReceived><subject>[libvirt-users] ESX access using libvirt</subject><body>

Hello,

I am trying to access an ESXi host using libvirt but it seems that it
requires netcat to be running on the ESX server.

My ESX 4 does not have this installed and I am wondering if this is
required or is there some other way to get this working?

Thanks,
Jon

</body></email><email><emailId>20100304172615</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-03-04 17:26:15-0400</timestampReceived><subject>Re: [libvirt-users] ESX access using libvirt</subject><body>

2010/3/4 Jonathan Kelley &lt;jkelley@vm-labs.com&gt;:
&gt; Hello,
&gt;
&gt; I am trying to access an ESXi host using libvirt but it seems that it
&gt; requires netcat to be running on the ESX server.
&gt;
&gt; My ESX 4 does not have this installed and I am wondering if this is
&gt; required or is there some other way to get this working?
&gt;
&gt; Thanks,
&gt; Jon
&gt;

No, you do not have to install anything on the ESX or ESXi server.
libvirt works with an out-of-the-box installation of ESX.

Make sure your libvirt version is new enough (0.7.0 or newer) and that
the ESX support is enabled. For example if you've installed libvirt
from Debian packages then you'll need to build libvirt from source,
because Debian explicitly disables ESX support in their packages for
some unknown reason.

See http://libvirt.org/drvesx.html if you haven't yet.

Matthias

</body></email><email><emailId>20100304182754</emailId><senderName>Jonathan Kelley</senderName><senderEmail>jkelley@vm-labs.com</senderEmail><timestampReceived>2010-03-04 18:27:54-0400</timestampReceived><subject>Re: [libvirt-users] ESX access using libvirt</subject><body>

I built it from the 0.7.6 sources but it still shows me that it is running
the 'nc' command on the ESX server (which does not exist). Is netcat
required to be on ESX?

13:24:26.765: debug : do_open:1110 : name "esx+ssh://test" to URI
components:
 scheme esx+ssh
 opaque (null)
 authority (null)
 server test
 user (null)
 port 0
 path

13:24:26.765: debug : do_open:1120 : trying driver 0 (Test) ...
13:24:26.765: debug : do_open:1126 : driver 0 Test returned DECLINED
13:24:26.765: debug : do_open:1120 : trying driver 1 (OPENVZ) ...
13:24:26.765: debug : do_open:1126 : driver 1 OPENVZ returned DECLINED
13:24:26.765: debug : do_open:1120 : trying driver 2 (VBOX) ...
13:24:26.765: debug : do_open:1126 : driver 2 VBOX returned DECLINED
13:24:26.765: debug : do_open:1120 : trying driver 3 (remote) ...
13:24:26.765: debug : doRemoteOpen:564 : proceeding with name = esx://
13:24:26.765: debug : virExecWithHook:640 : *ssh test nc -U
/apps/var/run/libvirt/libvirt-sock*
13:24:26.769: debug : remoteIO:8429 : Do proc=66 serial=0 length=28
wait=(nil)
13:24:26.769: debug : remoteIO:8491 : We have the buck 66 0x7fc565c4b010
0x7fc565c4b010
13:24:31.384: error : remoteIOReadBuffer:7707 : server closed connection
13:24:31.384: debug : remoteIOEventLoop:8376 : Giving up the buck due to I/O
error 66 0x7fc565c4b010 (nil)
13:24:31.384: debug : do_open:1126 : driver 3 remote returned ERROR
13:24:31.384: debug : virUnrefConnect:259 : unref connection 0x1146d20 1
13:24:31.384: debug : virReleaseConnect:216 : release connection 0x1146d20


Thanks,
Jon

On Thu, Mar 4, 2010 at 12:26 PM, Matthias Bolte &lt;
matthias.bolte@googlemail.com&gt; wrote:
&gt; 2010/3/4 Jonathan Kelley &lt;jkelley@vm-labs.com&gt;:
&gt;&gt; Hello,
&gt;&gt;
&gt;&gt; I am trying to access an ESXi host using libvirt but it seems that it
&gt;&gt; requires netcat to be running on the ESX server.
&gt;&gt;
&gt;&gt; My ESX 4 does not have this installed and I am wondering if this is
&gt;&gt; required or is there some other way to get this working?
&gt;&gt;
&gt;&gt; Thanks,
&gt;&gt; Jon
&gt;&gt;
&gt;
&gt; No, you do not have to install anything on the ESX or ESXi server.
&gt; libvirt works with an out-of-the-box installation of ESX.
&gt;
&gt; Make sure your libvirt version is new enough (0.7.0 or newer) and that
&gt; the ESX support is enabled. For example if you've installed libvirt
&gt; from Debian packages then you'll need to build libvirt from source,
&gt; because Debian explicitly disables ESX support in their packages for
&gt; some unknown reason.
&gt;
&gt; See http://libvirt.org/drvesx.html if you haven't yet.
&gt;
&gt; Matthias
&gt;

[Attachment #3 (text/html)]

I built it from the 0.7.6 sources but it still shows me that it is running the \
'nc' command on the ESX server (which does not exist). Is netcat required to \
be on ESX? &lt;br&gt;&lt;br&gt;13:24:26.765: debug : do_open:1110 : name \
"esx+ssh://test" to URI components:&lt;br&gt;  scheme esx+ssh&lt;br&gt;  opaque \
(null)&lt;br&gt;  authority (null)&lt;br&gt;  server test&lt;br&gt;  user (null)&lt;br&gt;  port 0&lt;br&gt;  \
path&lt;br&gt;&lt;br&gt;13:24:26.765: debug : do_open:1120 : trying driver 0 (Test) \
...&lt;br&gt;13:24:26.765: debug : do_open:1126 : driver 0 Test returned DECLINED&lt;br&gt; \
13:24:26.765: debug : do_open:1120 : trying driver 1 (OPENVZ) ...&lt;br&gt;13:24:26.765: \
debug : do_open:1126 : driver 1 OPENVZ returned DECLINED&lt;br&gt;13:24:26.765: debug : \
do_open:1120 : trying driver 2 (VBOX) ...&lt;br&gt;13:24:26.765: debug : do_open:1126 : \
driver 2 VBOX returned DECLINED&lt;br&gt; 13:24:26.765: debug : do_open:1120 : trying \
driver 3 (remote) ...&lt;br&gt;13:24:26.765: debug : doRemoteOpen:564 : proceeding with \
name = esx://&lt;br&gt;13:24:26.765: debug : virExecWithHook:640 : &lt;b&gt;ssh test nc -U \
/apps/var/run/libvirt/libvirt-sock&lt;/b&gt;&lt;br&gt; 13:24:26.769: debug : remoteIO:8429 : Do \
proc=66 serial=0 length=28 wait=(nil)&lt;br&gt;13:24:26.769: debug : remoteIO:8491 : We \
have the buck 66 0x7fc565c4b010 0x7fc565c4b010&lt;br&gt;13:24:31.384: error : \
remoteIOReadBuffer:7707 : server closed connection&lt;br&gt; 13:24:31.384: debug : \
remoteIOEventLoop:8376 : Giving up the buck due to I/O error 66 0x7fc565c4b010 \
(nil)&lt;br&gt;13:24:31.384: debug : do_open:1126 : driver 3 remote returned \
ERROR&lt;br&gt;13:24:31.384: debug : virUnrefConnect:259 : unref connection 0x1146d20 1&lt;br&gt; \
13:24:31.384: debug : virReleaseConnect:216 : release connection \
0x1146d20&lt;br&gt;&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;Jon&lt;br&gt;&lt;br&gt;On Thu, Mar 4, 2010 at 12:26 PM, Matthias \
Bolte &lt;&lt;a href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt; &gt; 2010/3/4 Jonathan Kelley &lt;&lt;a \
href="mailto:jkelley@vm-labs.com"&gt;jkelley@vm-labs.com&lt;/a&gt;&gt;:&lt;br&gt;&gt;&gt; \
Hello,&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt; I am trying to access an ESXi host using libvirt but \
it seems that it&lt;br&gt;&gt;&gt; requires netcat to be running on the ESX server.&lt;br&gt; \
&gt;&gt;&lt;br&gt;&gt;&gt; My ESX 4 does not have this installed and I am wondering if this \
is&lt;br&gt;&gt;&gt; required or is there some other way to get this \
working?&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt; Thanks,&lt;br&gt;&gt;&gt; Jon&lt;br&gt;&gt;&gt;&lt;br&gt; &gt;&lt;br&gt;&gt; \
No, you do not have to install anything on the ESX or ESXi server.&lt;br&gt;&gt; libvirt \
works with an out-of-the-box installation of ESX.&lt;br&gt;&gt;&lt;br&gt;&gt; Make sure your \
libvirt version is new enough (0.7.0 or newer) and that&lt;br&gt; &gt; the ESX support is \
enabled. For example if you've installed libvirt&lt;br&gt;&gt; from Debian packages \
then you'll need to build libvirt from source,&lt;br&gt;&gt; because Debian explicitly \
disables ESX support in their packages for&lt;br&gt; &gt; some unknown \
reason.&lt;br&gt;&gt;&lt;br&gt;&gt; See &lt;a \
href="http://libvirt.org/drvesx.html"&gt;http://libvirt.org/drvesx.html&lt;/a&gt; if you \
haven't yet.&lt;br&gt;&gt;&lt;br&gt;&gt; Matthias&lt;br&gt;&gt;&lt;br&gt;&lt;br&gt;



</body></email><email><emailId>20100304185434</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-03-04 18:54:34-0400</timestampReceived><subject>Re: [libvirt-users] ESX access using libvirt</subject><body>

Ah, don't use esx+ssh://, just use esx://

The scheme format &lt;driver&gt;+&lt;transport&gt;:// implies that you want to use
the libvirt remote mechanisms via the libvirt daemon (libvirtd) or the
server side, but the ESX driver doesn't use this. It directly connects
to the ESX server using HTTPS.

You do not need to have or install netcat on the ESX server, as said
before an out-of-the-box ESX installation is sufficient.

Matthias

2010/3/4 Jonathan Kelley &lt;jkelley@vm-labs.com&gt;:
&gt; I built it from the 0.7.6 sources but it still shows me that it is running
&gt; the 'nc' command on the ESX server (which does not exist). Is netcat
&gt; required to be on ESX?
&gt;
&gt; 13:24:26.765: debug : do_open:1110 : name "esx+ssh://test" to URI
&gt; components:
&gt;  scheme esx+ssh
&gt;  opaque (null)
&gt;  authority (null)
&gt;  server test
&gt;  user (null)
&gt;  port 0
&gt;  path
&gt;
&gt; 13:24:26.765: debug : do_open:1120 : trying driver 0 (Test) ...
&gt; 13:24:26.765: debug : do_open:1126 : driver 0 Test returned DECLINED
&gt; 13:24:26.765: debug : do_open:1120 : trying driver 1 (OPENVZ) ...
&gt; 13:24:26.765: debug : do_open:1126 : driver 1 OPENVZ returned DECLINED
&gt; 13:24:26.765: debug : do_open:1120 : trying driver 2 (VBOX) ...
&gt; 13:24:26.765: debug : do_open:1126 : driver 2 VBOX returned DECLINED
&gt; 13:24:26.765: debug : do_open:1120 : trying driver 3 (remote) ...
&gt; 13:24:26.765: debug : doRemoteOpen:564 : proceeding with name = esx://
&gt; 13:24:26.765: debug : virExecWithHook:640 : ssh test nc -U
&gt; /apps/var/run/libvirt/libvirt-sock
&gt; 13:24:26.769: debug : remoteIO:8429 : Do proc=66 serial=0 length=28
&gt; wait=(nil)
&gt; 13:24:26.769: debug : remoteIO:8491 : We have the buck 66 0x7fc565c4b010
&gt; 0x7fc565c4b010
&gt; 13:24:31.384: error : remoteIOReadBuffer:7707 : server closed connection
&gt; 13:24:31.384: debug : remoteIOEventLoop:8376 : Giving up the buck due to I/O
&gt; error 66 0x7fc565c4b010 (nil)
&gt; 13:24:31.384: debug : do_open:1126 : driver 3 remote returned ERROR
&gt; 13:24:31.384: debug : virUnrefConnect:259 : unref connection 0x1146d20 1
&gt; 13:24:31.384: debug : virReleaseConnect:216 : release connection 0x1146d20
&gt;
&gt;
&gt; Thanks,
&gt; Jon
&gt;
&gt; On Thu, Mar 4, 2010 at 12:26 PM, Matthias Bolte
&gt; &lt;matthias.bolte@googlemail.com&gt; wrote:
&gt;&gt; 2010/3/4 Jonathan Kelley &lt;jkelley@vm-labs.com&gt;:
&gt;&gt;&gt; Hello,
&gt;&gt;&gt;
&gt;&gt;&gt; I am trying to access an ESXi host using libvirt but it seems that it
&gt;&gt;&gt; requires netcat to be running on the ESX server.
&gt;&gt;&gt;
&gt;&gt;&gt; My ESX 4 does not have this installed and I am wondering if this is
&gt;&gt;&gt; required or is there some other way to get this working?
&gt;&gt;&gt;
&gt;&gt;&gt; Thanks,
&gt;&gt;&gt; Jon
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt; No, you do not have to install anything on the ESX or ESXi server.
&gt;&gt; libvirt works with an out-of-the-box installation of ESX.
&gt;&gt;
&gt;&gt; Make sure your libvirt version is new enough (0.7.0 or newer) and that
&gt;&gt; the ESX support is enabled. For example if you've installed libvirt
&gt;&gt; from Debian packages then you'll need to build libvirt from source,
&gt;&gt; because Debian explicitly disables ESX support in their packages for
&gt;&gt; some unknown reason.
&gt;&gt;
&gt;&gt; See http://libvirt.org/drvesx.html if you haven't yet.
&gt;&gt;
&gt;&gt; Matthias
&gt;&gt;
&gt;
&gt;

</body></email><email><emailId>20100304191017</emailId><senderName>Jonathan Kelley</senderName><senderEmail>jkelley@vm-labs.com</senderEmail><timestampReceived>2010-03-04 19:10:17-0400</timestampReceived><subject>Re: [libvirt-users] ESX access using libvirt</subject><body>

I must be missing something here so I don't need to install anything but
using esx requires what looks like TLS configured along with libvirtd
running on ESX.

When I do esx:// I get the following:

14:07:44.736: debug : virConnectOpenAuth:1355 : name=esx://test?no_verify=1,
auth=0x7f4512a6e5a0, flags=0
14:07:44.736: debug : do_open:1110 : name "esx://test?no_verify=1" to URI
components:
  scheme esx
  opaque (null)
  authority (null)
  server test
  user (null)
  port 0
  path ?no_verify=1

14:07:44.736: debug : do_open:1120 : trying driver 0 (Test) ...
14:07:44.736: debug : do_open:1126 : driver 0 Test returned DECLINED
14:07:44.736: debug : do_open:1120 : trying driver 1 (OPENVZ) ...
14:07:44.736: debug : do_open:1126 : driver 1 OPENVZ returned DECLINED
14:07:44.736: debug : do_open:1120 : trying driver 2 (VBOX) ...
14:07:44.736: debug : do_open:1126 : driver 2 VBOX returned DECLINED
14:07:44.736: debug : do_open:1120 : trying driver 3 (remote) ...
14:07:44.736: debug : doRemoteOpen:564 : proceeding with name =
esx://%3Fno_verify=1
14:07:44.737: debug : initialise_gnutls:1143 : loading CA file
/apps/etc/pki/CA/cacert.pem
14:07:44.737: debug : initialise_gnutls:1156 : loading client cert and key
from files /apps/etc/pki/libvirt/clientcert.pem and
/apps/etc/pki/libvirt/private/clientkey.pem
14:07:44.739: error : doRemoteOpen:644 : unable to connect to* libvirtd* at
'test': Connection refused
14:07:44.739: debug : do_open:1126 : driver 3 remote returned ERROR
14:07:44.739: debug : virUnrefConnect:259 : unref connection 0x1f3bd10 1
14:07:44.739: debug : virReleaseConnect:216 : release connection 0x1f3bd10

-Jon


On Thu, Mar 4, 2010 at 1:54 PM, Matthias Bolte &lt;
matthias.bolte@googlemail.com&gt; wrote:

&gt; Ah, don't use esx+ssh://, just use esx://
&gt;
&gt; The scheme format &lt;driver&gt;+&lt;transport&gt;:// implies that you want to use
&gt; the libvirt remote mechanisms via the libvirt daemon (libvirtd) or the
&gt; server side, but the ESX driver doesn't use this. It directly connects
&gt; to the ESX server using HTTPS.
&gt;
&gt; You do not need to have or install netcat on the ESX server, as said
&gt; before an out-of-the-box ESX installation is sufficient.
&gt;
&gt; Matthias
&gt;
&gt; 2010/3/4 Jonathan Kelley &lt;jkelley@vm-labs.com&gt;:
&gt; &gt; I built it from the 0.7.6 sources but it still shows me that it is
&gt; running
&gt; &gt; the 'nc' command on the ESX server (which does not exist). Is netcat
&gt; &gt; required to be on ESX?
&gt; &gt;
&gt; &gt; 13:24:26.765: debug : do_open:1110 : name "esx+ssh://test" to URI
&gt; &gt; components:
&gt; &gt;  scheme esx+ssh
&gt; &gt;  opaque (null)
&gt; &gt;  authority (null)
&gt; &gt;  server test
&gt; &gt;  user (null)
&gt; &gt;  port 0
&gt; &gt;  path
&gt; &gt;
&gt; &gt; 13:24:26.765: debug : do_open:1120 : trying driver 0 (Test) ...
&gt; &gt; 13:24:26.765: debug : do_open:1126 : driver 0 Test returned DECLINED
&gt; &gt; 13:24:26.765: debug : do_open:1120 : trying driver 1 (OPENVZ) ...
&gt; &gt; 13:24:26.765: debug : do_open:1126 : driver 1 OPENVZ returned DECLINED
&gt; &gt; 13:24:26.765: debug : do_open:1120 : trying driver 2 (VBOX) ...
&gt; &gt; 13:24:26.765: debug : do_open:1126 : driver 2 VBOX returned DECLINED
&gt; &gt; 13:24:26.765: debug : do_open:1120 : trying driver 3 (remote) ...
&gt; &gt; 13:24:26.765: debug : doRemoteOpen:564 : proceeding with name = esx://
&gt; &gt; 13:24:26.765: debug : virExecWithHook:640 : ssh test nc -U
&gt; &gt; /apps/var/run/libvirt/libvirt-sock
&gt; &gt; 13:24:26.769: debug : remoteIO:8429 : Do proc=66 serial=0 length=28
&gt; &gt; wait=(nil)
&gt; &gt; 13:24:26.769: debug : remoteIO:8491 : We have the buck 66 0x7fc565c4b010
&gt; &gt; 0x7fc565c4b010
&gt; &gt; 13:24:31.384: error : remoteIOReadBuffer:7707 : server closed connection
&gt; &gt; 13:24:31.384: debug : remoteIOEventLoop:8376 : Giving up the buck due to
&gt; I/O
&gt; &gt; error 66 0x7fc565c4b010 (nil)
&gt; &gt; 13:24:31.384: debug : do_open:1126 : driver 3 remote returned ERROR
&gt; &gt; 13:24:31.384: debug : virUnrefConnect:259 : unref connection 0x1146d20 1
&gt; &gt; 13:24:31.384: debug : virReleaseConnect:216 : release connection
&gt; 0x1146d20
&gt; &gt;
&gt; &gt;
&gt; &gt; Thanks,
&gt; &gt; Jon
&gt; &gt;
&gt; &gt; On Thu, Mar 4, 2010 at 12:26 PM, Matthias Bolte
&gt; &gt; &lt;matthias.bolte@googlemail.com&gt; wrote:
&gt; &gt;&gt; 2010/3/4 Jonathan Kelley &lt;jkelley@vm-labs.com&gt;:
&gt; &gt;&gt;&gt; Hello,
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; I am trying to access an ESXi host using libvirt but it seems that it
&gt; &gt;&gt;&gt; requires netcat to be running on the ESX server.
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; My ESX 4 does not have this installed and I am wondering if this is
&gt; &gt;&gt;&gt; required or is there some other way to get this working?
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; Thanks,
&gt; &gt;&gt;&gt; Jon
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; No, you do not have to install anything on the ESX or ESXi server.
&gt; &gt;&gt; libvirt works with an out-of-the-box installation of ESX.
&gt; &gt;&gt;
&gt; &gt;&gt; Make sure your libvirt version is new enough (0.7.0 or newer) and that
&gt; &gt;&gt; the ESX support is enabled. For example if you've installed libvirt
&gt; &gt;&gt; from Debian packages then you'll need to build libvirt from source,
&gt; &gt;&gt; because Debian explicitly disables ESX support in their packages for
&gt; &gt;&gt; some unknown reason.
&gt; &gt;&gt;
&gt; &gt;&gt; See http://libvirt.org/drvesx.html if you haven't yet.
&gt; &gt;&gt;
&gt; &gt;&gt; Matthias
&gt; &gt;&gt;
&gt; &gt;
&gt; &gt;
&gt;

[Attachment #3 (text/html)]

I must be missing something here so I don't need to install anything but using \
esx requires what looks like TLS configured along with libvirtd running on \
ESX.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;When I do esx:// I get the following:&lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;14:07:44.736: debug : virConnectOpenAuth:1355 : \
name=esx://test?no_verify=1, auth=0x7f4512a6e5a0, flags=0&lt;/div&gt;&lt;div&gt;14:07:44.736: \
debug : do_open:1110 : name "esx://test?no_verify=1" to URI \
components:&lt;/div&gt; &lt;div&gt;  scheme esx&lt;/div&gt;&lt;div&gt;  opaque (null)&lt;/div&gt;&lt;div&gt;  authority \
(null)&lt;/div&gt;&lt;div&gt;  server test&lt;/div&gt;&lt;div&gt;  user (null)&lt;/div&gt;&lt;div&gt;  port 0&lt;/div&gt;&lt;div&gt;  \
path ?no_verify=1&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;14:07:44.736: debug : do_open:1120 : \
trying driver 0 (Test) ...&lt;/div&gt; &lt;div&gt;14:07:44.736: debug : do_open:1126 : driver 0 \
Test returned DECLINED&lt;/div&gt;&lt;div&gt;14:07:44.736: debug : do_open:1120 : trying driver 1 \
(OPENVZ) ...&lt;/div&gt;&lt;div&gt;14:07:44.736: debug : do_open:1126 : driver 1 OPENVZ returned \
DECLINED&lt;/div&gt; &lt;div&gt;14:07:44.736: debug : do_open:1120 : trying driver 2 (VBOX) \
...&lt;/div&gt;&lt;div&gt;14:07:44.736: debug : do_open:1126 : driver 2 VBOX returned \
DECLINED&lt;/div&gt;&lt;div&gt;14:07:44.736: debug : do_open:1120 : trying driver 3 (remote) \
...&lt;/div&gt; &lt;div&gt;14:07:44.736: debug : doRemoteOpen:564 : proceeding with name = \
esx://%3Fno_verify=1&lt;/div&gt;&lt;div&gt;14:07:44.737: debug : initialise_gnutls:1143 : loading \
CA file /apps/etc/pki/CA/cacert.pem&lt;/div&gt;&lt;div&gt;14:07:44.737: debug : \
initialise_gnutls:1156 : loading client cert and key from files \
/apps/etc/pki/libvirt/clientcert.pem and \
/apps/etc/pki/libvirt/private/clientkey.pem&lt;/div&gt; &lt;div&gt;14:07:44.739: error : \
doRemoteOpen:644 : unable to connect to&lt;b&gt; libvirtd&lt;/b&gt; at 'test': Connection \
refused&lt;/div&gt;&lt;div&gt;14:07:44.739: debug : do_open:1126 : driver 3 remote returned \
ERROR&lt;/div&gt;&lt;div&gt;14:07:44.739: debug : virUnrefConnect:259 : unref connection \
0x1f3bd10 1&lt;/div&gt; &lt;div&gt;14:07:44.739: debug : virReleaseConnect:216 : release \
connection 0x1f3bd10&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-Jon&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;On Thu, Mar 4, 2010 at 1:54 PM, Matthias Bolte &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt; &lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt;Ah, don't use esx+ssh://, just use esx://&lt;br&gt; &lt;br&gt;
The scheme format &lt;driver&gt;+&lt;transport&gt;:// implies that you want to \
use&lt;br&gt; the libvirt remote mechanisms via the libvirt daemon (libvirtd) or the&lt;br&gt;
server side, but the ESX driver doesn't use this. It directly connects&lt;br&gt;
to the ESX server using HTTPS.&lt;br&gt;
&lt;br&gt;
You do not need to have or install netcat on the ESX server, as said&lt;br&gt;
before an out-of-the-box ESX installation is sufficient.&lt;br&gt;
&lt;font color="#888888"&gt;&lt;br&gt;
Matthias&lt;br&gt;
&lt;/font&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;&lt;br&gt;
2010/3/4 Jonathan Kelley &lt;&lt;a \
href="mailto:jkelley@vm-labs.com"&gt;jkelley@vm-labs.com&lt;/a&gt;&gt;:&lt;br&gt; &gt; I built it \
from the 0.7.6 sources but it still shows me that it is running&lt;br&gt; &gt; the \
'nc' command on the ESX server (which does not exist). Is netcat&lt;br&gt; &gt; \
required to be on ESX?&lt;br&gt; &gt;&lt;br&gt;
&gt; 13:24:26.765: debug : do_open:1110 : name "esx+ssh://test" to URI&lt;br&gt;
&gt; components:&lt;br&gt;
&gt;  scheme esx+ssh&lt;br&gt;
&gt;  opaque (null)&lt;br&gt;
&gt;  authority (null)&lt;br&gt;
&gt;  server test&lt;br&gt;
&gt;  user (null)&lt;br&gt;
&gt;  port 0&lt;br&gt;
&gt;  path&lt;br&gt;
&gt;&lt;br&gt;
&gt; 13:24:26.765: debug : do_open:1120 : trying driver 0 (Test) ...&lt;br&gt;
&gt; 13:24:26.765: debug : do_open:1126 : driver 0 Test returned DECLINED&lt;br&gt;
&gt; 13:24:26.765: debug : do_open:1120 : trying driver 1 (OPENVZ) ...&lt;br&gt;
&gt; 13:24:26.765: debug : do_open:1126 : driver 1 OPENVZ returned DECLINED&lt;br&gt;
&gt; 13:24:26.765: debug : do_open:1120 : trying driver 2 (VBOX) ...&lt;br&gt;
&gt; 13:24:26.765: debug : do_open:1126 : driver 2 VBOX returned DECLINED&lt;br&gt;
&gt; 13:24:26.765: debug : do_open:1120 : trying driver 3 (remote) ...&lt;br&gt;
&gt; 13:24:26.765: debug : doRemoteOpen:564 : proceeding with name = esx://&lt;br&gt;
&gt; 13:24:26.765: debug : virExecWithHook:640 : ssh test nc -U&lt;br&gt;
&gt; /apps/var/run/libvirt/libvirt-sock&lt;br&gt;
&gt; 13:24:26.769: debug : remoteIO:8429 : Do proc=66 serial=0 length=28&lt;br&gt;
&gt; wait=(nil)&lt;br&gt;
&gt; 13:24:26.769: debug : remoteIO:8491 : We have the buck 66 0x7fc565c4b010&lt;br&gt;
&gt; 0x7fc565c4b010&lt;br&gt;
&gt; 13:24:31.384: error : remoteIOReadBuffer:7707 : server closed connection&lt;br&gt;
&gt; 13:24:31.384: debug : remoteIOEventLoop:8376 : Giving up the buck due to I/O&lt;br&gt;
&gt; error 66 0x7fc565c4b010 (nil)&lt;br&gt;
&gt; 13:24:31.384: debug : do_open:1126 : driver 3 remote returned ERROR&lt;br&gt;
&gt; 13:24:31.384: debug : virUnrefConnect:259 : unref connection 0x1146d20 1&lt;br&gt;
&gt; 13:24:31.384: debug : virReleaseConnect:216 : release connection 0x1146d20&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt; Thanks,&lt;br&gt;
&gt; Jon&lt;br&gt;
&gt;&lt;br&gt;
&gt; On Thu, Mar 4, 2010 at 12:26 PM, Matthias Bolte&lt;br&gt;
&gt; &lt;&lt;a href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt; \
wrote:&lt;br&gt; &gt;&gt; 2010/3/4 Jonathan Kelley &lt;&lt;a \
href="mailto:jkelley@vm-labs.com"&gt;jkelley@vm-labs.com&lt;/a&gt;&gt;:&lt;br&gt; &gt;&gt;&gt; \
Hello,&lt;br&gt; &gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt; I am trying to access an ESXi host using libvirt but it seems that \
it&lt;br&gt; &gt;&gt;&gt; requires netcat to be running on the ESX server.&lt;br&gt;
&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt; My ESX 4 does not have this installed and I am wondering if this is&lt;br&gt;
&gt;&gt;&gt; required or is there some other way to get this working?&lt;br&gt;
&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt; Thanks,&lt;br&gt;
&gt;&gt;&gt; Jon&lt;br&gt;
&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; No, you do not have to install anything on the ESX or ESXi server.&lt;br&gt;
&gt;&gt; libvirt works with an out-of-the-box installation of ESX.&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; Make sure your libvirt version is new enough (0.7.0 or newer) and that&lt;br&gt;
&gt;&gt; the ESX support is enabled. For example if you've installed libvirt&lt;br&gt;
&gt;&gt; from Debian packages then you'll need to build libvirt from source,&lt;br&gt;
&gt;&gt; because Debian explicitly disables ESX support in their packages for&lt;br&gt;
&gt;&gt; some unknown reason.&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; See &lt;a href="http://libvirt.org/drvesx.html" \
target="_blank"&gt;http://libvirt.org/drvesx.html&lt;/a&gt; if you haven't yet.&lt;br&gt; \
&gt;&gt;&lt;br&gt; &gt;&gt; Matthias&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20100304193107</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-03-04 19:31:07-0400</timestampReceived><subject>Re: [libvirt-users] ESX access using libvirt</subject><body>

2010/3/4 Jonathan Kelley &lt;jkelley@vm-labs.com&gt;:
&gt; I must be missing something here so I don't need to install anything but
&gt; using esx requires what looks like TLS configured along with libvirtd
&gt; running on ESX.
&gt; When I do esx:// I get the following:
&gt; 14:07:44.736: debug : virConnectOpenAuth:1355 : name=esx://test?no_verify=1,
&gt; auth=0x7f4512a6e5a0, flags=0
&gt; 14:07:44.736: debug : do_open:1110 : name "esx://test?no_verify=1" to URI
&gt; components:
&gt;   scheme esx
&gt;   opaque (null)
&gt;   authority (null)
&gt;   server test
&gt;   user (null)
&gt;   port 0
&gt;   path ?no_verify=1

Your libxml2 version expects a / before the query parameters. you
should use esx://test/?no_verify=1 as URI.

&gt; 14:07:44.736: debug : do_open:1120 : trying driver 0 (Test) ...
&gt; 14:07:44.736: debug : do_open:1126 : driver 0 Test returned DECLINED
&gt; 14:07:44.736: debug : do_open:1120 : trying driver 1 (OPENVZ) ...
&gt; 14:07:44.736: debug : do_open:1126 : driver 1 OPENVZ returned DECLINED
&gt; 14:07:44.736: debug : do_open:1120 : trying driver 2 (VBOX) ...
&gt; 14:07:44.736: debug : do_open:1126 : driver 2 VBOX returned DECLINED

Here libvirt should probe the ESX driver, but it doesn't, and because
no driver accepted the URI until here libvirt probes the remote
driver. The remote driver then tries to connect to a libvirtd on the
ESX server but fails.

Sorry, I should have spotted this problem in your previous mail.

&gt; 14:07:44.736: debug : do_open:1120 : trying driver 3 (remote) ...
&gt; 14:07:44.736: debug : doRemoteOpen:564 : proceeding with name =
&gt; esx://%3Fno_verify=1
&gt; 14:07:44.737: debug : initialise_gnutls:1143 : loading CA file
&gt; /apps/etc/pki/CA/cacert.pem
&gt; 14:07:44.737: debug : initialise_gnutls:1156 : loading client cert and key
&gt; from files /apps/etc/pki/libvirt/clientcert.pem and
&gt; /apps/etc/pki/libvirt/private/clientkey.pem
&gt; 14:07:44.739: error : doRemoteOpen:644 : unable to connect to libvirtd at
&gt; 'test': Connection refused
&gt; 14:07:44.739: debug : do_open:1126 : driver 3 remote returned ERROR
&gt; 14:07:44.739: debug : virUnrefConnect:259 : unref connection 0x1f3bd10 1
&gt; 14:07:44.739: debug : virReleaseConnect:216 : release connection 0x1f3bd10
&gt; -Jon

The problems here is that your libvirt doesn't have ESX support
enabled. The ESX driver requires libcurl 7.18.0 or newer. The
configure script tests if libcurl is available and disables ESX
support if it's missing. Check the summary at the end of the configure
script output and make sure it says 'ESX: yes'.

The libvirt error reporting in the case of known but disabled drivers
is not so useful. You're not the first one that struggles with this
problem. I've a half finished patch lying around that addresses this
problem and improves the error reporting in this situation.

Matthias

&gt; On Thu, Mar 4, 2010 at 1:54 PM, Matthias Bolte
&gt; &lt;matthias.bolte@googlemail.com&gt; wrote:
&gt;&gt;
&gt;&gt; Ah, don't use esx+ssh://, just use esx://
&gt;&gt;
&gt;&gt; The scheme format &lt;driver&gt;+&lt;transport&gt;:// implies that you want to use
&gt;&gt; the libvirt remote mechanisms via the libvirt daemon (libvirtd) or the
&gt;&gt; server side, but the ESX driver doesn't use this. It directly connects
&gt;&gt; to the ESX server using HTTPS.
&gt;&gt;
&gt;&gt; You do not need to have or install netcat on the ESX server, as said
&gt;&gt; before an out-of-the-box ESX installation is sufficient.
&gt;&gt;
&gt;&gt; Matthias
&gt;&gt;
&gt;&gt; 2010/3/4 Jonathan Kelley &lt;jkelley@vm-labs.com&gt;:
&gt;&gt; &gt; I built it from the 0.7.6 sources but it still shows me that it is
&gt;&gt; &gt; running
&gt;&gt; &gt; the 'nc' command on the ESX server (which does not exist). Is netcat
&gt;&gt; &gt; required to be on ESX?
&gt;&gt; &gt;
&gt;&gt; &gt; 13:24:26.765: debug : do_open:1110 : name "esx+ssh://test" to URI
&gt;&gt; &gt; components:
&gt;&gt; &gt;  scheme esx+ssh
&gt;&gt; &gt;  opaque (null)
&gt;&gt; &gt;  authority (null)
&gt;&gt; &gt;  server test
&gt;&gt; &gt;  user (null)
&gt;&gt; &gt;  port 0
&gt;&gt; &gt;  path
&gt;&gt; &gt;
&gt;&gt; &gt; 13:24:26.765: debug : do_open:1120 : trying driver 0 (Test) ...
&gt;&gt; &gt; 13:24:26.765: debug : do_open:1126 : driver 0 Test returned DECLINED
&gt;&gt; &gt; 13:24:26.765: debug : do_open:1120 : trying driver 1 (OPENVZ) ...
&gt;&gt; &gt; 13:24:26.765: debug : do_open:1126 : driver 1 OPENVZ returned DECLINED
&gt;&gt; &gt; 13:24:26.765: debug : do_open:1120 : trying driver 2 (VBOX) ...
&gt;&gt; &gt; 13:24:26.765: debug : do_open:1126 : driver 2 VBOX returned DECLINED
&gt;&gt; &gt; 13:24:26.765: debug : do_open:1120 : trying driver 3 (remote) ...
&gt;&gt; &gt; 13:24:26.765: debug : doRemoteOpen:564 : proceeding with name = esx://
&gt;&gt; &gt; 13:24:26.765: debug : virExecWithHook:640 : ssh test nc -U
&gt;&gt; &gt; /apps/var/run/libvirt/libvirt-sock
&gt;&gt; &gt; 13:24:26.769: debug : remoteIO:8429 : Do proc=66 serial=0 length=28
&gt;&gt; &gt; wait=(nil)
&gt;&gt; &gt; 13:24:26.769: debug : remoteIO:8491 : We have the buck 66 0x7fc565c4b010
&gt;&gt; &gt; 0x7fc565c4b010
&gt;&gt; &gt; 13:24:31.384: error : remoteIOReadBuffer:7707 : server closed connection
&gt;&gt; &gt; 13:24:31.384: debug : remoteIOEventLoop:8376 : Giving up the buck due to
&gt;&gt; &gt; I/O
&gt;&gt; &gt; error 66 0x7fc565c4b010 (nil)
&gt;&gt; &gt; 13:24:31.384: debug : do_open:1126 : driver 3 remote returned ERROR
&gt;&gt; &gt; 13:24:31.384: debug : virUnrefConnect:259 : unref connection 0x1146d20 1
&gt;&gt; &gt; 13:24:31.384: debug : virReleaseConnect:216 : release connection
&gt;&gt; &gt; 0x1146d20
&gt;&gt; &gt;
&gt;&gt; &gt;
&gt;&gt; &gt; Thanks,
&gt;&gt; &gt; Jon
&gt;&gt; &gt;
&gt;&gt; &gt; On Thu, Mar 4, 2010 at 12:26 PM, Matthias Bolte
&gt;&gt; &gt; &lt;matthias.bolte@googlemail.com&gt; wrote:
&gt;&gt; &gt;&gt; 2010/3/4 Jonathan Kelley &lt;jkelley@vm-labs.com&gt;:
&gt;&gt; &gt;&gt;&gt; Hello,
&gt;&gt; &gt;&gt;&gt;
&gt;&gt; &gt;&gt;&gt; I am trying to access an ESXi host using libvirt but it seems that it
&gt;&gt; &gt;&gt;&gt; requires netcat to be running on the ESX server.
&gt;&gt; &gt;&gt;&gt;
&gt;&gt; &gt;&gt;&gt; My ESX 4 does not have this installed and I am wondering if this is
&gt;&gt; &gt;&gt;&gt; required or is there some other way to get this working?
&gt;&gt; &gt;&gt;&gt;
&gt;&gt; &gt;&gt;&gt; Thanks,
&gt;&gt; &gt;&gt;&gt; Jon
&gt;&gt; &gt;&gt;&gt;
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; No, you do not have to install anything on the ESX or ESXi server.
&gt;&gt; &gt;&gt; libvirt works with an out-of-the-box installation of ESX.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Make sure your libvirt version is new enough (0.7.0 or newer) and that
&gt;&gt; &gt;&gt; the ESX support is enabled. For example if you've installed libvirt
&gt;&gt; &gt;&gt; from Debian packages then you'll need to build libvirt from source,
&gt;&gt; &gt;&gt; because Debian explicitly disables ESX support in their packages for
&gt;&gt; &gt;&gt; some unknown reason.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; See http://libvirt.org/drvesx.html if you haven't yet.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Matthias
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;
&gt;&gt; &gt;
&gt;
&gt;

</body></email><email><emailId>20100403180525</emailId><senderName>mattias</senderName><senderEmail>mj@mjw.se</senderEmail><timestampReceived>2010-04-03 18:05:25-0400</timestampReceived><subject>[libvirt-users] question</subject><body>

i try to connect to my local libvirt to use openvz
openvz://localhost
but i get an error about a missed certificate
and when i use
openvz:///localhost
only a eror message says could not connect
libvirt error

</body></email><email><emailId>20101203151313</emailId><senderName>"Stefan G. Weichinger"</senderName><senderEmail>lists@xunil.at</senderEmail><timestampReceived>2010-12-03 15:13:13-0400</timestampReceived><subject>Re: [libvirt-users] added second virtio-disk: disk order detected wrong</subject><body>

Am 03.12.2010 15:43, schrieb Stefan G. Weichinger:
&gt; 
&gt; Greets, I am unsure if it's a linux- or libvirt-issue:
&gt; 
&gt; I added a 2nd virtio-disk to a kvm-based VM.
&gt; 
&gt; The xml shows a correct "target":
&gt; 
&gt; 
&gt; # first disk vda
&gt; 
&gt; &lt;disk type='file' device='disk'&gt;
&gt;       &lt;driver name='qemu' type='qcow2'/&gt;
&gt;       &lt;source file='/mnt/r0/vm1_vda-clone.img'/&gt;
&gt;       &lt;target dev='vda' bus='virtio'/&gt;
&gt;       &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x04'
&gt; function='0x0'/&gt;
&gt;     &lt;/disk&gt;
&gt; 
&gt; # second disk vdb
&gt; 
&gt; &lt;disk type='file' device='disk'&gt;
&gt;       &lt;driver name='qemu' type='qcow2'/&gt;
&gt;       &lt;source file='/mnt/r0/www3_var.img'/&gt;
&gt;       &lt;target dev='vdb' bus='virtio'/&gt;
&gt;       &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03'
&gt; function='0x0'/&gt;
&gt;     &lt;/disk&gt;

Should I edit the xml and swap the "slots" ?

S

</body></email><email><emailId>20101203152854</emailId><senderName>"Stefan G. Weichinger"</senderName><senderEmail>lists@xunil.at</senderEmail><timestampReceived>2010-12-03 15:28:54-0400</timestampReceived><subject>Re: [libvirt-users] (SOLVED) added second virtio-disk: disk order detected wrong</subject><body>

Am 03.12.2010 16:13, schrieb Stefan G. Weichinger:

&gt; Should I edit the xml and swap the "slots" ?

I did that and after a restart of libvirtd the VM booted ok again.

I'd still like to hear an explanation or a pointer to a bugreport or so ...

thanks, Stefan

</body></email><email><emailId>20101205051218</emailId><senderName></senderName><senderEmail>jxd431@gmail.com</senderEmail><timestampReceived>2010-12-05 05:12:18-0400</timestampReceived><subject>[libvirt-users] How to set image format to 'qcow2'</subject><body>


Hi, all

My xml 'dom1.xml' is as following:
&lt;domain type='kvm' id='1'&gt;
&lt;name&gt;kvm-xp&lt;/name&gt;
&lt;description&gt;xp kvm&lt;/description&gt;
&lt;memory&gt;524288&lt;/memory&gt;
&lt;currentMemory&gt;524288&lt;/currentMemory&gt;
&lt;os&gt;
&lt;type&gt;hvm&lt;/type&gt;
&lt;!--loader&gt;/usr/lib/xen/boot/hvmloader&lt;/loader--&gt;
&lt;boot dev="hd"/&gt;
&lt;/os&gt;
&lt;devices&gt;
&lt;disk type='file'&gt;
&lt;source file='/home/eucalyptus/imgs/xp.img'/&gt;
&lt;target dev='hda' bus='ide'/&gt;
&lt;/disk&gt;
&lt;driver name='qemu' type='qcow2'/&gt;
&lt;!--graphics type="sdl" display=':0.0'/--&gt;
&lt;!--graphics type="desktop" fullscreen='yes'/--&gt;
&lt;graphics type='vnc' port='5904'/&gt;
&lt;/devices&gt;
&lt;/domain&gt;

In this xml file, I don't know how to set disk file format to 'qcow2'.
When I create domain using this command:
virsh create dom1.xml

I cannot boot the image file. The log file
/var/log/libvirt/qemu/kvm-xp.log is as following:

LC_ALL=C
PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/sbin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/bin:/usr/x86_64-pc-linux-gnu/gcc-bin/4.4.3
 HOME=/root USER=root QEMU_AUDIO_DRV=none /usr/bin/kvm -S -M pc -m 512
-smp 1 -name kvm-xp -uuid a8cbae31-59a0-0bc5-4416-65ba63aa4231 -monitor
unix:/var/lib/libvirt/qemu/kvm-xp.monitor,server,nowait -no-acpi -boot c
-drive file=/home/eucalyptus/imgs/xp.img,if=ide,bus=0,unit=0,format=raw
-net none -serial none -parallel none -usb -vnc 127.0.0.1:4 -vga cirrus
-balloon virtio

I don't know how to set format argument to 'qcow2'

----------------
Xiaodong Jiang
jxd431@gmail.com


</body></email><email><emailId>20101211173351</emailId><senderName>Dan =?ISO-8859-1?Q?L=FCdtke?=</senderName><senderEmail>post@danluedtke.de</senderEmail><timestampReceived>2010-12-11 17:33:51-0400</timestampReceived><subject>[libvirt-users] LXC Live Migration possible?</subject><body>

Hallo everyone,

in March 2010 there was a discussion[1] about live migration of LXC
Containers using libvirt. I was just wondering if there are any updates
to this?

regards,

Dan Luedtke

[1]
http://www.mail-archive.com/lxc-users@lists.sourceforge.net/msg00198.html
-- 
https://www.danrl.de/
GPG Key ID: 0xF8504F3E

</body></email><email><emailId>20101213054320</emailId><senderName>Albert Hopkins</senderName><senderEmail>marduk@letterboxes.org</senderEmail><timestampReceived>2010-12-13 05:43:20-0400</timestampReceived><subject>[libvirt-users] libvirt printing to stderr</subject><body>

I'm writing an app and using the Python bindings for libvirt.

Everything is fine but, in some cases I need to call lookupByName().
There are a lot of times when the name will not exist, I trap the
exception, however I still get this message printed to stderr:

libvir: QEMU error : Domain not found: no domain with matching name
'foo'

Is there any way to turn this off?  This is a command-line program so
the extra output makes the interface confusing.

I've tried re-assigning sys.stderr before calling lookupByName(), but
that doesn't seem to have any affect.

tia,
-albert


</body></email><email><emailId>20101213214417</emailId><senderName>Scott Baker</senderName><senderEmail>bakers@canbytel.com</senderEmail><timestampReceived>2010-12-13 21:44:17-0400</timestampReceived><subject>[libvirt-users] Deploying libvirt with live migration</subject><body>

I have two physical servers: Virt1 and Virt2. I'm setting up live 
migration with CentOS 5.5 between the two. I've done this by NFS 
mounting /etc/libvirt and /var/lib/libvirt/images on both servers. This 
is working well for me except for one thing.

I see the same list of VMs on each server (as expected), but each server 
(Virt1 and Virt2) are able to start the same VM at the same time. This 
obviously causes IP conflicts and thrashes the disk image. Is there a 
way to tell my VM "cluster" that a VM is only allowed to be opened on 
one host at a time?

-- 
Scott Baker - Canby Telcom
System Administrator - RHCE - 503.266.8253

</body></email><email><emailId>20101215120627</emailId><senderName></senderName><senderEmail>tony</senderEmail><timestampReceived>2010-12-15 12:06:27-0400</timestampReceived><subject>[libvirt-users] KVM Virtualisation, Console output no longer working</subject><body>

Hi,

I used to use KVM for virtualisation and have now moved back to it, but I
have a problem.

When i used to install the guest machine with virt-install i used to use
the -x "extra args" part to set the console for the install and guest, but
it no longer works.

Here is the command i use:

virt-install -n server01 -r 512 --os-variant=virtio26 -c /isos/c5u5.iso
--nographics --noautoconsole -f /storage/vm/server01 -s 5 bus=virtio -w
bridge:br0 -x "console=ttyS0 ks=http://www.domain.com/c5u5.cfg"
As you can see im setting the console to ttyS0, but then when i go to
connect to the console with:

virsh console server01
it either wont connect or comes up with: error: Failed to get local hostname

Here is a dump of the xml, but no mention of ttyS0 either.

&lt;domain type='qemu' id='5'&gt;
  &lt;name&gt;server01&lt;/name&gt;
  &lt;uuid&gt;5991cf85-db6c-2b87-b76d-07a0caae77b9&lt;/uuid&gt;
  &lt;memory&gt;524288&lt;/memory&gt;
  &lt;currentMemory&gt;524288&lt;/currentMemory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='x86_64' machine='rhel5.4.0'&gt;hvm&lt;/type&gt;
    &lt;boot dev='cdrom'/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
    &lt;apic/&gt;
    &lt;pae/&gt;
  &lt;/features&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;destroy&lt;/on_reboot&gt;
  &lt;on_crash&gt;destroy&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/libexec/qemu-kvm&lt;/emulator&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;driver name='qemu' cache='none'/&gt;
      &lt;source file='/storage/vm/server01'/&gt;
      &lt;target dev='hda' bus='ide'/&gt;
    &lt;/disk&gt;
    &lt;disk type='file' device='cdrom'&gt;
      &lt;source file='/isos/c5u5.iso'/&gt;
      &lt;target dev='hdc' bus='ide'/&gt;
      &lt;readonly/&gt;
    &lt;/disk&gt;
    &lt;interface type='bridge'&gt;
      &lt;mac address='54:52:00:61:ea:78'/&gt;
      &lt;source bridge='br0'/&gt;
      &lt;target dev='vnet0'/&gt;
    &lt;/interface&gt;
    &lt;serial type='pty'&gt;
      &lt;source path='/dev/pts/2'/&gt;
      &lt;target port='0'/&gt;
    &lt;/serial&gt;
    &lt;console type='pty' tty='/dev/pts/2'&gt;
      &lt;source path='/dev/pts/2'/&gt;
      &lt;target port='0'/&gt;
    &lt;/console&gt;
  &lt;/devices&gt;
&lt;/domain&gt;
Can anyone shed any light on this as im totally stuck.

</body></email><email><emailId>20101203105823</emailId><senderName>Igor Serebryany</senderName><senderEmail>igor47@moomers.org</senderEmail><timestampReceived>2010-12-03 10:58:23-0400</timestampReceived><subject>[libvirt-users] busy loop in libvirtd (cpu usage 100%)</subject><body>


Hi!

	Occasionally of late, I've seen a few cases where libvirtd cpu usage
	shoots up to 100% and stays there indefinitely. This seems to happen
	when a QEMU VM is starting up, although on one occasion I *think* I
	saw it happen after a QEMU VM was p2p-migrated. 

	Doing strace -f -p &lt;libvirtd pid&gt; reveals a flood of poll() functions calls
	like these: 

[pid  1690] poll([{fd=3, events=POLLIN}, {fd=6, events=POLLIN}, {fd=12, \
events=POLLIN|POLLERR|POLLHUP}, {fd=11, events=POLLIN|POLLERR|POLLHUP}, {fd=10, \
events=POLLIN|POLLERR|POLLHUP}, {fd=9, events=POLLIN|POLLERR|POLLHUP}, {fd=24, \
events=POLLIN|POLLERR|POLLHUP}, {fd=21, events=POLLOUT}, {fd=14, events=POLLIN}, \
{fd=15, events=POLLIN}, {fd=16, events=POLLIN}, {fd=17, events=POLLIN}, {fd=21, \
events=POLLIN|POLLERR|POLLHUP}, {fd=20, events=POLLIN|POLLERR|POLLHUP}], 14, -1) = 1 \
([{fd=21, revents=POLLOUT}])

	It seems that because 1 is returned each time, libvirtd just goes
	crazy dealing with fd-3, but I have no idea what fd-3 is.

	Restarting libvirtd fixes the high load, and then everything just
	goes back to chugging along as usual.

	This is on libvirt 0.8.5 with qemu 0.12.5 on a debian Squeeze system
	(the libvirt is compiled by hand).

	I'm not sure what's causing it, whether it's a bug in my own code
	somehow or inside libvirtd. I'd appreciate some help on how to debug
	this problem further -- restarting libvirtd is kind of a pain for
	me, because my application, which monitors the health on the node,
	maintains open connections to 'qemu:///system' and would thus have
	to restart itself as well...

--Igor


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20101216193015</emailId><senderName>Rangababu Chakravarthula</senderName><senderEmail>rbabu@hexagrid.com</senderEmail><timestampReceived>2010-12-16 19:30:15-0400</timestampReceived><subject>[libvirt-users] aio flag for KVM guests</subject><body>

Hello,
We are using libvirt 0.8.3 to build KVM guests (KVM version is qemu-kvm
0.12.5). I see kvm supports aio flag with either native or threads option.
Where in libvirt XML should we define aio option?

Thanks in advance
Ranga

[Attachment #3 (text/html)]

Hello,&lt;br&gt;We are using libvirt 0.8.3 to build KVM guests (KVM version is qemu-kvm \
0.12.5). I see kvm supports aio flag with either native or threads option. Where in \
libvirt XML should we define aio option?&lt;br&gt;&lt;br&gt;Thanks in advance&lt;br&gt; \
Ranga&lt;br&gt;&lt;br&gt;&lt;br&gt;



</body></email><email><emailId>20101217105427</emailId><senderName></senderName><senderEmail>tony</senderEmail><timestampReceived>2010-12-17 10:54:27-0400</timestampReceived><subject>[libvirt-users] Problems Installing KVM Guest + Console Access</subject><body>

Hi,

Im having real issues with getting a kvm guest up and running on CentOS 5.5

I have expanded the iso to a path on my system as I have been told that
the -x (extra arguments) will not work with the -cdrom option, so I am now
using -location, but still the extra arguments are not being picked up.

So what do I need to do to get a guest up and working with console access
to view the install as its driving me crazy.

Thanks

Tony

</body></email><email><emailId>20101206111108</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-12-06 11:11:08-0400</timestampReceived><subject>Re: [libvirt-users] busy loop in libvirtd (cpu usage 100%)</subject><body>

On Fri, Dec 03, 2010 at 04:58:23AM -0600, Igor Serebryany wrote:
&gt; Hi!
&gt; 
&gt; 	Occasionally of late, I've seen a few cases where libvirtd cpu usage
&gt; 	shoots up to 100% and stays there indefinitely. This seems to happen
&gt; 	when a QEMU VM is starting up, although on one occasion I *think* I
&gt; 	saw it happen after a QEMU VM was p2p-migrated. 
&gt; 
&gt; 	Doing strace -f -p &lt;libvirtd pid&gt; reveals a flood of poll() functions calls
&gt; 	like these: 
&gt; 
&gt; [pid  1690] poll([{fd=3, events=POLLIN}, {fd=6, events=POLLIN}, {fd=12, \
&gt; events=POLLIN|POLLERR|POLLHUP}, {fd=11, events=POLLIN|POLLERR|POLLHUP}, {fd=10, \
&gt; events=POLLIN|POLLERR|POLLHUP}, {fd=9, events=POLLIN|POLLERR|POLLHUP}, {fd=24, \
&gt; events=POLLIN|POLLERR|POLLHUP}, {fd=21, events=POLLOUT}, {fd=14, events=POLLIN}, \
&gt; {fd=15, events=POLLIN}, {fd=16, events=POLLIN}, {fd=17, events=POLLIN}, {fd=21, \
&gt; events=POLLIN|POLLERR|POLLHUP}, {fd=20, events=POLLIN|POLLERR|POLLHUP}], 14, -1) = \
&gt; 1 ([{fd=21, revents=POLLOUT}]) 
&gt; 	It seems that because 1 is returned each time, libvirtd just goes
&gt; 	crazy dealing with fd-3, but I have no idea what fd-3 is.
&gt; 
&gt; 	Restarting libvirtd fixes the high load, and then everything just
&gt; 	goes back to chugging along as usual.
&gt; 
&gt; 	This is on libvirt 0.8.5 with qemu 0.12.5 on a debian Squeeze system
&gt; 	(the libvirt is compiled by hand).
&gt; 
&gt; 	I'm not sure what's causing it, whether it's a bug in my own code
&gt; 	somehow or inside libvirtd. I'd appreciate some help on how to debug
&gt; 	this problem further -- restarting libvirtd is kind of a pain for
&gt; 	me, because my application, which monitors the health on the node,
&gt; 	maintains open connections to 'qemu:///system' and would thus have
&gt; 	to restart itself as well...

This is the kind of problem you need to use GDB to diagnose. Install
the libvirt-debuginfo (or equivalent for non-Fedora), and attach to
the libvirt process. Then do

  print eventLoop.handleCount
  print eventLoop.handles[0]
  print eventLoop.handles[1]
  print eventLoop.handles[2]
  ...

Until you find the one with fd=21 in it. We're looking for the name
of the function callback associated with this fd, which GDB should
have print out each time.

Daniel


</body></email><email><emailId>20101217083402</emailId><senderName>Igor Serebryany</senderName><senderEmail>igor47@moomers.org</senderEmail><timestampReceived>2010-12-17 08:34:02-0400</timestampReceived><subject>[libvirt-users] using virDomainMigrateSetMaxDowntime</subject><body>


I would like to use the virDomainMigrateSetMaxDowntime but I'm a bit
confused about how to use it.

If I try to set the downtime before I call domain.migrate(), I get the
error "domain is not being migrated". But I cannot call it afterwards
because domain.migrate() does not return until the migration has
completed.

Am I meant to put the call to domain.migrate() into a separate thread of
control, and then call SetMaxDowntime from my main thread after the
migration has begun? How do I even know if the migration has begun?

Thanks!
--Igor


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20101219204819</emailId><senderName>Anthony Davis</senderName><senderEmail>tony@specialistdevelopment.com</senderEmail><timestampReceived>2010-12-19 20:48:19-0400</timestampReceived><subject>[libvirt-users] Error creating a new vm</subject><body>

Hi,

I wonder if anyone can help me with this, I have been trying to get a vm up and \
running for a while now and cant for the life of me work out why it isnt working. The \
errors I get arnt very helpful and im at a loss as how to debug this any further.

Here is the command and output that I get...(Also nothing shows up with virsh list \
--all after so its starting to install then dropping out)

Hope someone can help. Thanks!

[root@server ~]# /usr/bin/virt-install -n test01 -r 512 --os-variant=virtio26 -l \
http://172.16.0.100/iso/centos-5.5/ --nographics --noautoconsole --disk \
path=/dev/vg_storage/test01, bus=virtio -w bridge:br0 -x "console=ttyS0 \
ks=http://172.16.0.100/ks/ks-vm.cfg" -d -v Sun, 19 Dec 2010 20:45:05 DEBUG    \
Requesting libvirt URI default Sun, 19 Dec 2010 20:45:05 DEBUG    Received libvirt \
URI 'qemu:///system' Sun, 19 Dec 2010 20:45:05 DEBUG    Requesting virt method 'hvm'
Sun, 19 Dec 2010 20:45:05 DEBUG    Received virt method 'hvm'
Sun, 19 Dec 2010 20:45:05 DEBUG    Hypervisor name is 'qemu'
Sun, 19 Dec 2010 20:45:05 DEBUG    parse_disk: returning ('/dev/vg_storage/test01', \
None, None, 'disk', None, False, False, None, True, None) Sun, 19 Dec 2010 20:45:05 \
DEBUG    Setting size for existing storage to '10.0' Sun, 19 Dec 2010 20:45:05 DEBUG  \
Detected storage as type 'block' Sun, 19 Dec 2010 20:45:05 DEBUG    Setting size for \
existing storage to '10.0' Sun, 19 Dec 2010 20:45:05 DEBUG    Detected storage as \
type 'block' Sun, 19 Dec 2010 20:45:05 DEBUG    Setting size for existing storage to \
'10.0' Sun, 19 Dec 2010 20:45:05 DEBUG    Detected storage as type 'block'
Sun, 19 Dec 2010 20:45:05 DEBUG    Setting os type to 'linux' for variant 'virtio26'
Sun, 19 Dec 2010 20:45:05 DEBUG    DistroInstaller location is a network source.


Starting install...
Sun, 19 Dec 2010 20:45:05 DEBUG    Attempting to detect distro:
Sun, 19 Dec 2010 20:45:05 DEBUG    HTTP hasFile: didn't find \
http://172.16.0.100/iso/centos-5.5/.treeinfo Sun, 19 Dec 2010 20:45:05 DEBUG    HTTP \
hasFile: didn't find http://172.16.0.100/iso/centos-5.5/Fedora Sun, 19 Dec 2010 \
20:45:05 DEBUG    HTTP hasFile: didn't find http://172.16.0.100/iso/centos-5.5/Server \
Sun, 19 Dec 2010 20:45:05 DEBUG    HTTP hasFile: didn't find \
http://172.16.0.100/iso/centos-5.5/Client Sun, 19 Dec 2010 20:45:05 DEBUG    HTTP \
hasFile: didn't find http://172.16.0.100/iso/centos-5.5/RedHat Sun, 19 Dec 2010 \
20:45:05 DEBUG    Detected a CentOS distro Sun, 19 Dec 2010 20:45:05 DEBUG    \
Fetching URI: http://172.16.0.100/iso/centos-5.5/images/pxeboot/vmlinuz Sun, 19 Dec \
2010 20:45:05 DEBUG    Saved file to /var/lib/libvirt/boot/virtinst-vmlinuz.MKBsh1 \
Retrieving file vmlinuz...                                                            \
| 1.9 MB     00:00      Sun, 19 Dec 2010 20:45:05 DEBUG    Fetching URI: \
http://172.16.0.100/iso/centos-5.5/images/pxeboot/initrd.img Sun, 19 Dec 2010 \
20:45:05 DEBUG    Saved file to /var/lib/libvirt/boot/virtinst-initrd.img.T2dfhc \
Retrieving file initrd.img...                                                         \
| 7.7 MB     00:00      Sun, 19 Dec 2010 20:45:05 DEBUG    Creating guest from:

&lt;domain type='qemu'&gt;
  &lt;name&gt;test01&lt;/name&gt;
  &lt;currentMemory&gt;524288&lt;/currentMemory&gt;
  &lt;memory&gt;524288&lt;/memory&gt;
  &lt;uuid&gt;5cbb288b-d9f7-bae4-0d05-9157553f53fe&lt;/uuid&gt;
  &lt;os&gt;
    &lt;type arch='x86_64'&gt;hvm&lt;/type&gt;
    &lt;kernel&gt;/var/lib/libvirt/boot/virtinst-vmlinuz.oddwKg&lt;/kernel&gt;
    &lt;initrd&gt;/var/lib/libvirt/boot/virtinst-initrd.img.POxZ5X&lt;/initrd&gt;
    &lt;cmdline&gt;method=http://172.16.0.100/iso/centos-5.5/ console=ttyS0 \
ks=http://172.16.0.100/ks/ks-vm.cfg&lt;/cmdline&gt;  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;&lt;apic/&gt;&lt;pae/&gt;
  &lt;/features&gt;
  &lt;clock offset="utc"/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;destroy&lt;/on_reboot&gt;
  &lt;on_crash&gt;destroy&lt;/on_crash&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/bin/qemu-system-x86_64&lt;/emulator&gt;
    &lt;console type='pty'/&gt;
    &lt;disk type='block' device='disk'&gt;
      &lt;driver name='qemu' cache='none'/&gt;
      &lt;source dev='/dev/vg_storage/test01'/&gt;
      &lt;target dev='hda' bus='ide'/&gt;
    &lt;/disk&gt;
    &lt;interface type='bridge'&gt;
      &lt;source bridge='br0'/&gt;
      &lt;mac address='54:52:00:66:25:22'/&gt;
    &lt;/interface&gt;
    &lt;input type='mouse' bus='ps2'/&gt;
  &lt;/devices&gt;
&lt;/domain&gt;

Sun, 19 Dec 2010 20:44:48 DEBUG    Removing \
/var/lib/libvirt/boot/virtinst-vmlinuz.oddwKg Sun, 19 Dec 2010 20:44:48 DEBUG    \
Removing /var/lib/libvirt/boot/virtinst-initrd.img.POxZ5X Sun, 19 Dec 2010 20:44:48 \
ERROR    internal error Domain ims-gl-lin01g01 didn't show up

Domain installation may not have been
 successful.  If it was, you can restart your domain
 by running 'virsh start test01'; otherwise, please
 restart your installation.
Sun, 19 Dec 2010 20:44:48 ERROR    internal error Domain test01 didn't show up
Traceback (most recent call last):
  File "/usr/bin/virt-install", line 889, in ?
    main()
  File "/usr/bin/virt-install", line 751, in main
    start_time, guest.start_install)
  File "/usr/bin/virt-install", line 813, in do_install
    dom = install_func(conscb, progresscb, wait=(not wait))
  File "/usr/lib/python2.4/site-packages/virtinst/Guest.py", line 541, in \
start_install  return self._do_install(consolecb, meter, removeOld, wait)
  File "/usr/lib/python2.4/site-packages/virtinst/Guest.py", line 633, in _do_install
    self.domain = self.conn.createLinux(install_xml, 0)
  File "/usr/lib64/python2.4/site-packages/libvirt.py", line 974, in createLinux
    if ret is None:raise libvirtError('virDomainCreateLinux() failed', conn=self)
libvirtError: internal error Domain ims-gl-lin01g01 didn't show up


</body></email><email><emailId>20101221105330</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-12-21 10:53:30-0400</timestampReceived><subject>[libvirt-users] Anyone interested in forming a libvirt "docs" team?</subject><body>

Hi all,

There's a lot of documentation for libvirt that needs improving, so wondering
if anyone would be interested in forming a libvirt "docs" team to help make
that happen?

While some of the documentation needs people familiar with specific pieces
of libvirt, there's also a lot that doesn't, and just needs people with some free
time and willingness to help.

Anyone up for it? :)

Regards and best wishes,

Justin Clift



</body></email><email><emailId>20101222210258</emailId><senderName>David Lane</senderName><senderEmail>kg4giy@gmail.com</senderEmail><timestampReceived>2010-12-22 21:02:58-0400</timestampReceived><subject>[libvirt-users] ICMP into guest not "working"</subject><body>

Good afternoon.

I have a RHEL6 host, running RHEL 3.8 as a guest.  The NIC is bridged.  From
the guest, I can ping successfully to a variety of network devices.  From
the host, I can ping successfully to a variety of network devices AND the
guest OS.  But from my workstation, I can only ping the HOST, not the
guest.  And it looks like the packets are being discarded.

IPtables is NOT enabled on either the guest or the host (our application
does not support iptables filtering - go figure).

I am seeing lots of documentation for enabling outbound pings from guest,
but very little about enabling inbound pings.  And again, our software
relies on pings for parts of its operations and validations.

Any clues as to what I might have missed?

Thanks,

DAVID

-- 
David A. Lane, KG4GIY
EC/RO Prince William County ARES/RACES
+1.703.628.3868
http://www.pwcares.org/
http://www.linuxjournal.com/forums/hot-topics/ham-radio
IM/Skype/Twitter: kg4giy

[Attachment #3 (text/html)]

Good afternoon.&lt;br&gt;&lt;br&gt;I have a RHEL6 host, running RHEL 3.8 as a guest.  The NIC is \
bridged.  From the guest, I can ping successfully to a variety of network devices.  \
From the host, I can ping successfully to a variety of network devices AND the guest \
OS.  But from my workstation, I can only ping the HOST, not the guest.  And it looks \
like the packets are being discarded.&lt;br&gt; &lt;br&gt;IPtables is NOT enabled on either the \
guest or the host (our application does not support iptables filtering - go \
figure).&lt;br&gt;&lt;br&gt;I am seeing lots of documentation for enabling outbound pings from \
guest, but very little about enabling inbound pings.  And again, our software relies \
on pings for parts of its operations and validations.&lt;br&gt; &lt;br&gt;Any clues as to what I \
might have missed?&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;&lt;br&gt;DAVID&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;David A. \
Lane, KG4GIY&lt;br&gt;EC/RO Prince William County ARES/RACES&lt;br&gt;+1.703.628.3868&lt;br&gt;&lt;a \
href="http://www.pwcares.org/"&gt;http://www.pwcares.org/&lt;/a&gt;&lt;br&gt; &lt;a \
href="http://www.linuxjournal.com/forums/hot-topics/ham-radio"&gt;http://www.linuxjournal.com/forums/hot-topics/ham-radio&lt;/a&gt;&lt;br&gt;IM/Skype/Twitter: \
kg4giy&lt;br&gt;



</body></email><email><emailId>20101228104924</emailId><senderName>Patric Falinder</senderName><senderEmail>patric.falinder@omg.nu</senderEmail><timestampReceived>2010-12-28 10:49:24-0400</timestampReceived><subject>[libvirt-users] VMware ESX 4.0 won't reboot guests.</subject><body>

Hi,

I just compiled libvirt with ESX support. I can login just fine, list 
all the guests/domains but when I try to reboot or shutdown one of my 
guests/domains I get this error:

virsh # reboot dbcluster1
error: Failed to reboot domain dbcluster1
error: internal error HTTP response code 500 for call to 'RebootGuest'. 
Fault: ServerFaultCode - fault.RestrictedVersion.summary

And nothing happens.
I'm logged in as root so it shouldn't be any permission-related problems 
right!? because I can reboot it just fine with the vSpehere Client on 
one of my Windows boxes.

In vSpehere I see this in Recent Tasks after I execute the reboot command:
Find entity by UUID

I can't find anything about this on Google either.

Does anyone know what's wrong here?

Thanks,
-Patric

</body></email><email><emailId>20101217080627</emailId><senderName>Igor Serebryany</senderName><senderEmail>igor47@moomers.org</senderEmail><timestampReceived>2010-12-17 08:06:27-0400</timestampReceived><subject>[libvirt-users] libvirt unavailable while a VM is in migration?</subject><body>


Hi, 

	I am running libvirt 0.8.6 on qemu (kvm, really) 0.12.5. I have
	noticed that while a live migration is running, I cannot do anything
	else with libvirt -- even 'virsh list' blocks without output until
	the migration is almost done.

	(At that point 'virsh list' will dump a final screen showing the VM I
	just migrated as 'running'; the next run of 'virsh list' no longer
	displays the VM -- this is why I say "almost done".)

	Is there anything I can do to prevent this? Is there a fix for this
	coming?

	MORE DETAILS:

	I open a connection to a remote libvirt instance and begin a
	live-migration using:
	domain.migrate(remoteCon, flags, None, None, 0)

	My flags are:
	flags = libvirt.VIR_MIGRATE_PEER2PEER | libvirt.VIR_MIGRATE_LIVE | \
libvirt.VIR_MIGRATE_UNDEFINE_SOURCE | libvirt.VIR_MIGRATE_TUNNELLED

Thanks,
--Igor


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20101217130024</emailId><senderName>Igor Serebryany</senderName><senderEmail>igor47@moomers.org</senderEmail><timestampReceived>2010-12-17 13:00:24-0400</timestampReceived><subject>Re: [libvirt-users] libvirt unavailable while a VM is in migration?</subject><body>


Did a bit more testing. I open a connection to the hypervisor from
python using:
con = libvirt.open('qemu:///system')

No call that I tried on con returns while a migration is in progress. I
tried: listDomainsID, lookupByID, getInfo, getHostname, getType.

This sort of combines with my other outstanding email, about how to use
migrateSetMaxDowntime. If I can't even get a domain object for a
migrating domain, how could I possibly set max downtime AFTER the
migration has begun?

I must be missing something crucial. Can someone please give me some
wisdom?

--Igor

On Fri, Dec 17, 2010 at 02:06:27AM -0600, Igor Serebryany wrote:
&gt; Hi, 
&gt; 
&gt; 	I am running libvirt 0.8.6 on qemu (kvm, really) 0.12.5. I have
&gt; 	noticed that while a live migration is running, I cannot do anything
&gt; 	else with libvirt -- even 'virsh list' blocks without output until
&gt; 	the migration is almost done.
&gt; 
&gt; 	(At that point 'virsh list' will dump a final screen showing the VM I
&gt; 	just migrated as 'running'; the next run of 'virsh list' no longer
&gt; 	displays the VM -- this is why I say "almost done".)
&gt; 
&gt; 	Is there anything I can do to prevent this? Is there a fix for this
&gt; 	coming?
&gt; 
&gt; 	MORE DETAILS:
&gt; 
&gt; 	I open a connection to a remote libvirt instance and begin a
&gt; 	live-migration using:
&gt; 	domain.migrate(remoteCon, flags, None, None, 0)
&gt; 
&gt; 	My flags are:
&gt; 	flags = libvirt.VIR_MIGRATE_PEER2PEER | libvirt.VIR_MIGRATE_LIVE | \
&gt; libvirt.VIR_MIGRATE_UNDEFINE_SOURCE | libvirt.VIR_MIGRATE_TUNNELLED 
&gt; Thanks,
&gt; --Igor



&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20101217161526</emailId><senderName>Igor Serebryany</senderName><senderEmail>igor47@moomers.org</senderEmail><timestampReceived>2010-12-17 16:15:26-0400</timestampReceived><subject>Re: [libvirt-users] libvirt unavailable while a VM is in migration?</subject><body>


On Fri, Dec 17, 2010 at 07:00:24AM -0600, Igor Serebryany wrote:
&gt; This sort of combines with my other outstanding email, about how to use
&gt; migrateSetMaxDowntime. If I can't even get a domain object for a
&gt; migrating domain, how could I possibly set max downtime AFTER the
&gt; migration has begun?

I did some MORE testing. I obtain a domain object to a domain in two
separate python processes. I begin migrating the domain in one of these
processes, and then I call migrateSetMaxDowntime() on the domain in the
other process. Unsurprisingly, the call is blocked and does not return
until the migration finished. At that point it returned 0, but I have no
idea whether the call had any impact on the running migration.

Even more confused about how this is supposed to work now,
--Igor

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20101220093756</emailId><senderName>Jiri Denemark</senderName><senderEmail>jdenemar@redhat.com</senderEmail><timestampReceived>2010-12-20 09:37:56-0400</timestampReceived><subject>Re: [libvirt-users] libvirt unavailable while a VM is in migration?</subject><body>

&gt; I did some MORE testing. I obtain a domain object to a domain in two
&gt; separate python processes. I begin migrating the domain in one of these
&gt; processes, and then I call migrateSetMaxDowntime() on the domain in the
&gt; other process. Unsurprisingly, the call is blocked and does not return
&gt; until the migration finished. At that point it returned 0, but I have no
&gt; idea whether the call had any impact on the running migration.
&gt; 
&gt; Even more confused about how this is supposed to work now,

Hmm, the behavior you get is really weird. Most of libvirt APIs are
synchronous so they only return after the operation has finished. If you need
to do something else while the operation is running, you need a separate
connection to libvirt (opened in a separate process or thread) which you can
use for manipulating with other domains or, to some extent, even with the same
domain. In the migration case, you can use the second connection to monitor
migration progress (virDomainGetJobInfo), cancel the migration
(virDomainAbortJob), turn live migration into non-live migration
(virDomainSuspend), or setting maximum downtime
(virDomainMigrateSetMaxDowntime).

It's quite strange, that as you say you have two python processes and
virDomainMigrateSetMaxDowntime doesn't finish until the migration itself
finishes. I would suggest to start with a simple setup and try with virsh
migrate and virsh migrate-setmaxdowntime started from separate terminals, but
in your first email, you said you can't even run virsh list while migration is
running, right?

So could you make sure you have debug info libvirt packages installed or in
case you compile libvirt yourself that you compile with -g (should be there by
default) and don't strip binaries. Then try to get into the state, when a
migration is running and virsh list (or virsh migrate-setmaxdowntime) from
another terminal is blocked and attach gdb to libvirtd
    gdb -p $(pidof libvirtd)
and type "thread apply all bt" in the gdb and send us the result.

I'm curious why it doesn't work for you.

Jirka

</body></email><email><emailId>20101220100637</emailId><senderName>Igor Serebryany</senderName><senderEmail>igor47@moomers.org</senderEmail><timestampReceived>2010-12-20 10:06:37-0400</timestampReceived><subject>Re: [libvirt-users] libvirt unavailable while a VM is in migration?</subject><body>

[Attachment #2 (multipart/mixed)]


On Mon, Dec 20, 2010 at 10:37:56AM +0100, Jiri Denemark wrote:
&gt; in your first email, you said you can't even run virsh list while migration is
&gt; running, right?

yup -- when i start my migration using my python application, 'virsh
list' no longer works from the command-line. i will try setting up a
simple test-case i can use with 'virsh migrate' and let you know the
results.

&gt; So could you make sure you have debug info libvirt packages installed
&gt; or in case you compile libvirt yourself that you compile with -g
&gt; (should be there by default) and don't strip binaries.

I am using the rpm packages distributed from the website, which I've
installed on my debian box using alien.

I've attached two gdb traces -- one for when a migration is just
running, and another where I've also got a blocked 'virsh list' from the
command line. It appears there's no difference between them (except in
the data counts in the thread actually doing the migration).

I've also attached a trace for the 'virsh' process itself.

Thanks for answering, hopefully we can get to the bottom of this.

--Igor

["tracemigration.txt" (text/plain)]

Thread 7 (Thread 0x7f6358f33710 (LWP 24325)):
#0  __lll_lock_wait () at ../nptl/sysdeps/unix/sysv/linux/x86_64/lowlevellock.S:136
#1  0x00007f635cb560e9 in _L_lock_953 () from /lib/libpthread.so.0
#2  0x00007f635cb55f0b in __pthread_mutex_lock (mutex=0x7f6350015910) at \
pthread_mutex_lock.c:61 #3  0x000000000043d44d in qemuDriverLock \
(conn=0x7f635009b8f0) at qemu/qemu_driver.c:144 #4  qemudClose (conn=0x7f635009b8f0) \
at qemu/qemu_driver.c:4500 #5  0x00007f636054a97b in virReleaseConnect \
(conn=0x7f635009b8f0) at datatypes.c:269 #6  0x00007f636054b028 in virUnrefConnect \
(conn=0x7f635009b8f0) at datatypes.c:321 #7  0x00007f63605525c8 in virConnectClose \
(conn=0x7f635009b8f0) at libvirt.c:1548 #8  0x000000000041941f in qemudFreeClient \
(opaque=0xc636f0) at libvirtd.c:2284 #9  qemudRunLoop (opaque=0xc636f0) at \
libvirtd.c:2358 #10 0x00007f635cb538ba in start_thread (arg=&lt;value optimized out&gt;) at \
pthread_create.c:300 #11 0x00007f635c6b702d in clone () at \
../sysdeps/unix/sysv/linux/x86_64/clone.S:112 #12 0x0000000000000000 in ?? ()

Thread 6 (Thread 0x7f634effd710 (LWP 24476)):
#0  pthread_cond_wait@@GLIBC_2.3.2 () at \
../nptl/sysdeps/unix/sysv/linux/x86_64/pthread_cond_wait.S:162 #1  0x00007f6360515886 \
in virCondWait (c=&lt;value optimized out&gt;, m=&lt;value optimized out&gt;)  at \
util/threads-pthread.c:105 #2  0x000000000041aa15 in qemudWorker (data=0xc74ab0) at \
libvirtd.c:1565 #3  0x00007f635cb538ba in start_thread (arg=&lt;value optimized out&gt;) at \
pthread_create.c:300 #4  0x00007f635c6b702d in clone () at \
../sysdeps/unix/sysv/linux/x86_64/clone.S:112 #5  0x0000000000000000 in ?? ()
Current language:  auto
The current source language is "auto; currently asm".

Thread 5 (Thread 0x7f634e7fc710 (LWP 24478)):
#0  pthread_cond_wait@@GLIBC_2.3.2 () at \
../nptl/sysdeps/unix/sysv/linux/x86_64/pthread_cond_wait.S:162 #1  0x00007f6360515886 \
                in virCondWait (c=&lt;value optimized out&gt;, m=&lt;value optimized out&gt;)
---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---
    at util/threads-pthread.c:105
#2  0x000000000041aa15 in qemudWorker (data=0xc74ac8) at libvirtd.c:1565
#3  0x00007f635cb538ba in start_thread (arg=&lt;value optimized out&gt;) at \
pthread_create.c:300 #4  0x00007f635c6b702d in clone () at \
../sysdeps/unix/sysv/linux/x86_64/clone.S:112 #5  0x0000000000000000 in ?? ()

Thread 4 (Thread 0x7f634dffb710 (LWP 24489)):
#0  pthread_cond_wait@@GLIBC_2.3.2 () at \
../nptl/sysdeps/unix/sysv/linux/x86_64/pthread_cond_wait.S:162 #1  0x00007f6360515886 \
in virCondWait (c=&lt;value optimized out&gt;, m=&lt;value optimized out&gt;)  at \
util/threads-pthread.c:105 #2  0x000000000041aa15 in qemudWorker (data=0xc74ae0) at \
libvirtd.c:1565 #3  0x00007f635cb538ba in start_thread (arg=&lt;value optimized out&gt;) at \
pthread_create.c:300 #4  0x00007f635c6b702d in clone () at \
../sysdeps/unix/sysv/linux/x86_64/clone.S:112 #5  0x0000000000000000 in ?? ()

Thread 3 (Thread 0x7f634d7fa710 (LWP 24494)):
#0  0x00007f635cb5b0bd in read () at ../sysdeps/unix/syscall-template.S:82
#1  0x00007f636051683e in read (fd=54, buf=0x13bddb0, count=32768) at \
/usr/include/bits/unistd.h:45 #2  saferead (fd=54, buf=0x13bddb0, count=32768) at \
util/util.c:95 #3  0x0000000000447e03 in doTunnelSendAll (driver=0x7f6350015910, \
dconn=0x1202cf0, vm=0x7f63500197b0,   dom_xml=&lt;value optimized out&gt;, uri=0xc65980 \
"qemu+tcp://10.32.174.165/system", flags=23, dname=0x0,   resource=0, dom=&lt;value \
optimized out&gt;) at qemu/qemu_driver.c:11389 #4  doTunnelMigrate \
(driver=0x7f6350015910, dconn=0x1202cf0, vm=0x7f63500197b0, dom_xml=&lt;value optimized \
out&gt;,   uri=0xc65980 "qemu+tcp://10.32.174.165/system", flags=23, dname=0x0, \
resource=0, dom=&lt;value optimized out&gt;)  at qemu/qemu_driver.c:11604
#5  0x0000000000448631 in doPeer2PeerMigrate (dom=0xc63970, cookie=&lt;value optimized \
out&gt;,   cookielen=&lt;value optimized out&gt;, uri=0xc65980 \
"qemu+tcp://10.32.174.165/system", flags=23, dname=0x0,   resource=0) at \
qemu/qemu_driver.c:11746 #6  qemudDomainMigratePerform (dom=0xc63970, cookie=&lt;value \
                optimized out&gt;, cookielen=&lt;value optimized out&gt;, 
---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---
    uri=0xc65980 "qemu+tcp://10.32.174.165/system", flags=23, dname=0x0, resource=0)
    at qemu/qemu_driver.c:11816
#7  0x00007f6360555b16 in virDomainMigratePerform (domain=0xc63970, cookie=0x0, \
cookielen=0,   uri=0xc65980 "qemu+tcp://10.32.174.165/system", flags=23, dname=0x0, \
bandwidth=0) at libvirt.c:3931 #8  0x0000000000425782 in \
remoteDispatchDomainMigratePerform (server=&lt;value optimized out&gt;,   client=&lt;value \
optimized out&gt;, conn=0x7f63501472a0, hdr=&lt;value optimized out&gt;, rerr=0x7f634d7f9be0,  \
args=0x7f634d7f9d20, ret=0x7f634d7f9cc0) at remote.c:1852 #9  0x000000000042b417 in \
remoteDispatchClientCall (server=0xc636f0, client=0xc66fc0, msg=0xf6d650)  at \
dispatch.c:530 #10 remoteDispatchClientRequest (server=0xc636f0, client=0xc66fc0, \
msg=0xf6d650) at dispatch.c:408 #11 0x000000000041aaa8 in qemudWorker (data=0xc74af8) \
at libvirtd.c:1586 #12 0x00007f635cb538ba in start_thread (arg=&lt;value optimized out&gt;) \
at pthread_create.c:300 #13 0x00007f635c6b702d in clone () at \
../sysdeps/unix/sysv/linux/x86_64/clone.S:112 #14 0x0000000000000000 in ?? ()

Thread 2 (Thread 0x7f635672e710 (LWP 24853)):
#0  pthread_cond_wait@@GLIBC_2.3.2 () at \
../nptl/sysdeps/unix/sysv/linux/x86_64/pthread_cond_wait.S:162 #1  0x00007f6360515886 \
in virCondWait (c=&lt;value optimized out&gt;, m=&lt;value optimized out&gt;)  at \
util/threads-pthread.c:105 #2  0x000000000041aa15 in qemudWorker (data=0xc74a68) at \
libvirtd.c:1565 #3  0x00007f635cb538ba in start_thread (arg=&lt;value optimized out&gt;) at \
pthread_create.c:300 #4  0x00007f635c6b702d in clone () at \
../sysdeps/unix/sysv/linux/x86_64/clone.S:112 #5  0x0000000000000000 in ?? ()

Thread 1 (Thread 0x7f6360ce07e0 (LWP 24324)):
#0  0x00007f635cb54be5 in pthread_join (threadid=140064670824208, thread_return=0x0) \
at pthread_join.c:89 #1  0x000000000041d6dd in main (argc=&lt;value optimized out&gt;, \
argv=&lt;value optimized out&gt;) at libvirtd.c:3304 Current language:  auto
The current source language is "auto; currently c".


["tracewithblockedvirsh.txt" (text/plain)]

Thread 7 (Thread 0x7f6358f33710 (LWP 24325)):
#0  __lll_lock_wait () at ../nptl/sysdeps/unix/sysv/linux/x86_64/lowlevellock.S:136
#1  0x00007f635cb560e9 in _L_lock_953 () from /lib/libpthread.so.0
#2  0x00007f635cb55f0b in __pthread_mutex_lock (mutex=0x7f6350015910) at \
pthread_mutex_lock.c:61 #3  0x000000000043d44d in qemuDriverLock \
(conn=0x7f635009b8f0) at qemu/qemu_driver.c:144 #4  qemudClose (conn=0x7f635009b8f0) \
at qemu/qemu_driver.c:4500 #5  0x00007f636054a97b in virReleaseConnect \
(conn=0x7f635009b8f0) at datatypes.c:269 #6  0x00007f636054b028 in virUnrefConnect \
(conn=0x7f635009b8f0) at datatypes.c:321 #7  0x00007f63605525c8 in virConnectClose \
(conn=0x7f635009b8f0) at libvirt.c:1548 #8  0x000000000041941f in qemudFreeClient \
(opaque=0xc636f0) at libvirtd.c:2284 #9  qemudRunLoop (opaque=0xc636f0) at \
libvirtd.c:2358 #10 0x00007f635cb538ba in start_thread (arg=&lt;value optimized out&gt;) at \
pthread_create.c:300 #11 0x00007f635c6b702d in clone () at \
../sysdeps/unix/sysv/linux/x86_64/clone.S:112 #12 0x0000000000000000 in ?? ()

Thread 6 (Thread 0x7f634effd710 (LWP 24476)):
#0  pthread_cond_wait@@GLIBC_2.3.2 () at \
../nptl/sysdeps/unix/sysv/linux/x86_64/pthread_cond_wait.S:162 #1  0x00007f6360515886 \
in virCondWait (c=&lt;value optimized out&gt;, m=&lt;value optimized out&gt;)  at \
util/threads-pthread.c:105 #2  0x000000000041aa15 in qemudWorker (data=0xc74ab0) at \
libvirtd.c:1565 #3  0x00007f635cb538ba in start_thread (arg=&lt;value optimized out&gt;) at \
pthread_create.c:300 #4  0x00007f635c6b702d in clone () at \
../sysdeps/unix/sysv/linux/x86_64/clone.S:112 #5  0x0000000000000000 in ?? ()
Current language:  auto
The current source language is "auto; currently asm".

Thread 5 (Thread 0x7f634e7fc710 (LWP 24478)):
#0  pthread_cond_wait@@GLIBC_2.3.2 () at \
../nptl/sysdeps/unix/sysv/linux/x86_64/pthread_cond_wait.S:162 #1  0x00007f6360515886 \
                in virCondWait (c=&lt;value optimized out&gt;, m=&lt;value optimized out&gt;)
---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---
    at util/threads-pthread.c:105
#2  0x000000000041aa15 in qemudWorker (data=0xc74ac8) at libvirtd.c:1565
#3  0x00007f635cb538ba in start_thread (arg=&lt;value optimized out&gt;) at \
pthread_create.c:300 #4  0x00007f635c6b702d in clone () at \
../sysdeps/unix/sysv/linux/x86_64/clone.S:112 #5  0x0000000000000000 in ?? ()

Thread 4 (Thread 0x7f634dffb710 (LWP 24489)):
#0  pthread_cond_wait@@GLIBC_2.3.2 () at \
../nptl/sysdeps/unix/sysv/linux/x86_64/pthread_cond_wait.S:162 #1  0x00007f6360515886 \
in virCondWait (c=&lt;value optimized out&gt;, m=&lt;value optimized out&gt;)  at \
util/threads-pthread.c:105 #2  0x000000000041aa15 in qemudWorker (data=0xc74ae0) at \
libvirtd.c:1565 #3  0x00007f635cb538ba in start_thread (arg=&lt;value optimized out&gt;) at \
pthread_create.c:300 #4  0x00007f635c6b702d in clone () at \
../sysdeps/unix/sysv/linux/x86_64/clone.S:112 #5  0x0000000000000000 in ?? ()

Thread 3 (Thread 0x7f634d7fa710 (LWP 24494)):
#0  0x00007f635cb5b0bd in read () at ../sysdeps/unix/syscall-template.S:82
#1  0x00007f636051683e in read (fd=54, buf=0x13b5db0, count=65536) at \
/usr/include/bits/unistd.h:45 #2  saferead (fd=54, buf=0x13b5db0, count=65536) at \
util/util.c:95 #3  0x0000000000447e03 in doTunnelSendAll (driver=0x7f6350015910, \
dconn=0x1202cf0, vm=0x7f63500197b0,   dom_xml=&lt;value optimized out&gt;, uri=0xc65980 \
"qemu+tcp://10.32.174.165/system", flags=23, dname=0x0,   resource=0, dom=&lt;value \
optimized out&gt;) at qemu/qemu_driver.c:11389 #4  doTunnelMigrate \
(driver=0x7f6350015910, dconn=0x1202cf0, vm=0x7f63500197b0, dom_xml=&lt;value optimized \
out&gt;,   uri=0xc65980 "qemu+tcp://10.32.174.165/system", flags=23, dname=0x0, \
resource=0, dom=&lt;value optimized out&gt;)  at qemu/qemu_driver.c:11604
#5  0x0000000000448631 in doPeer2PeerMigrate (dom=0xc63970, cookie=&lt;value optimized \
out&gt;,   cookielen=&lt;value optimized out&gt;, uri=0xc65980 \
"qemu+tcp://10.32.174.165/system", flags=23, dname=0x0,   resource=0) at \
qemu/qemu_driver.c:11746 #6  qemudDomainMigratePerform (dom=0xc63970, cookie=&lt;value \
                optimized out&gt;, cookielen=&lt;value optimized out&gt;, 
---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---
    uri=0xc65980 "qemu+tcp://10.32.174.165/system", flags=23, dname=0x0, resource=0)
    at qemu/qemu_driver.c:11816
#7  0x00007f6360555b16 in virDomainMigratePerform (domain=0xc63970, cookie=0x0, \
cookielen=0,   uri=0xc65980 "qemu+tcp://10.32.174.165/system", flags=23, dname=0x0, \
bandwidth=0) at libvirt.c:3931 #8  0x0000000000425782 in \
remoteDispatchDomainMigratePerform (server=&lt;value optimized out&gt;,   client=&lt;value \
optimized out&gt;, conn=0x7f63501472a0, hdr=&lt;value optimized out&gt;, rerr=0x7f634d7f9be0,  \
args=0x7f634d7f9d20, ret=0x7f634d7f9cc0) at remote.c:1852 #9  0x000000000042b417 in \
remoteDispatchClientCall (server=0xc636f0, client=0xc66fc0, msg=0xf6d650)  at \
dispatch.c:530 #10 remoteDispatchClientRequest (server=0xc636f0, client=0xc66fc0, \
msg=0xf6d650) at dispatch.c:408 #11 0x000000000041aaa8 in qemudWorker (data=0xc74af8) \
at libvirtd.c:1586 #12 0x00007f635cb538ba in start_thread (arg=&lt;value optimized out&gt;) \
at pthread_create.c:300 #13 0x00007f635c6b702d in clone () at \
../sysdeps/unix/sysv/linux/x86_64/clone.S:112 #14 0x0000000000000000 in ?? ()

Thread 2 (Thread 0x7f635672e710 (LWP 24853)):
#0  pthread_cond_wait@@GLIBC_2.3.2 () at \
../nptl/sysdeps/unix/sysv/linux/x86_64/pthread_cond_wait.S:162 #1  0x00007f6360515886 \
in virCondWait (c=&lt;value optimized out&gt;, m=&lt;value optimized out&gt;)  at \
util/threads-pthread.c:105 #2  0x000000000041aa15 in qemudWorker (data=0xc74a68) at \
libvirtd.c:1565 #3  0x00007f635cb538ba in start_thread (arg=&lt;value optimized out&gt;) at \
pthread_create.c:300 #4  0x00007f635c6b702d in clone () at \
../sysdeps/unix/sysv/linux/x86_64/clone.S:112 #5  0x0000000000000000 in ?? ()

Thread 1 (Thread 0x7f6360ce07e0 (LWP 24324)):
#0  0x00007f635cb54be5 in pthread_join (threadid=140064670824208, thread_return=0x0) \
at pthread_join.c:89 #1  0x000000000041d6dd in main (argc=&lt;value optimized out&gt;, \
argv=&lt;value optimized out&gt;) at libvirtd.c:3304 Current language:  auto
The current source language is "auto; currently c".


["tracevirsh.txt" (text/plain)]

Thread 1 (Thread 0x7f849b1687e0 (LWP 24979)):
#0  0x00007f84975490d8 in *__GI___poll (fds=0x7fff70e53d90, nfds=2, timeout=&lt;value \
optimized out&gt;)  at ../sysdeps/unix/sysv/linux/poll.c:83
#1  0x00007f849abf68e2 in remoteIOEventLoop (conn=0x171a1f0, priv=0x7f849afb2010, \
flags=3,   thiscall=0x7f84949d2010) at remote/remote_driver.c:10129
#2  remoteIO (conn=0x171a1f0, priv=0x7f849afb2010, flags=3, thiscall=0x7f84949d2010)
    at remote/remote_driver.c:10370
#3  0x00007f849abf731c in call (conn=0x171a1f0, priv=0x7f849afb2010, flags=3, \
proc_nr=&lt;value optimized out&gt;,   args_filter=0x7f849757d240 &lt;xdr_void&gt;, args=&lt;value \
optimized out&gt;,   ret_filter=0x7f849ac0c000 &lt;xdr_remote_auth_list_ret&gt;, \
ret=0x7fff70e54400 "")  at remote/remote_driver.c:10455
#4  0x00007f849ac070ff in remoteAuthenticate (conn=&lt;value optimized out&gt;, \
priv=0x7f849afb2010,   auth=0x7f849af53340, flags=0) at remote/remote_driver.c:6853
#5  doRemoteOpen (conn=&lt;value optimized out&gt;, priv=0x7f849afb2010, \
auth=0x7f849af53340, flags=0)  at remote/remote_driver.c:861
#6  0x00007f849ac08ee0 in remoteOpen (conn=0x171a1f0, auth=0x7f849af53340, \
flags=&lt;value optimized out&gt;)  at remote/remote_driver.c:1103
#7  0x00007f849abd6c19 in do_open (name=0x0, auth=0x7f849af53340, flags=0) at \
libvirt.c:1259 #8  0x00007f849abd8518 in virConnectOpenAuth (name=0x0, \
auth=0x7f849af53340, flags=0) at libvirt.c:1514 #9  0x000000000041ee17 in vshInit \
(argc=&lt;value optimized out&gt;, argv=0x7fff70e54af8) at virsh.c:11167 #10 main \
(argc=&lt;value optimized out&gt;, argv=0x7fff70e54af8) at virsh.c:11819


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20101220131442</emailId><senderName>Jiri Denemark</senderName><senderEmail>jdenemar@redhat.com</senderEmail><timestampReceived>2010-12-20 13:14:42-0400</timestampReceived><subject>Re: [libvirt-users] libvirt unavailable while a VM is in migration?</subject><body>

&gt; &gt; So could you make sure you have debug info libvirt packages installed
&gt; &gt; or in case you compile libvirt yourself that you compile with -g
&gt; &gt; (should be there by default) and don't strip binaries.
&gt; 
&gt; I am using the rpm packages distributed from the website, which I've
&gt; installed on my debian box using alien.

Ouch, I wonder if that could be the reason... Could you just compile libvirt
yourself? Personally, I wouldn't really trust such transformed package esp.
considering the hacky steps you did and described in another email.

&gt; I've attached two gdb traces -- one for when a migration is just
&gt; running, and another where I've also got a blocked 'virsh list' from the
&gt; command line. It appears there's no difference between them (except in
&gt; the data counts in the thread actually doing the migration).
&gt; 
&gt; I've also attached a trace for the 'virsh' process itself.

Thanks, that was a good idea since according to it virsh is stuck while it
tries to authenticate to libvirtd. Could you run this second virsh list with
LIBVIRT_DEBUG environment variable set to 1 and attach the debug output? Also
please check the virsh is stuck in the same place. Hopefully the log will tell
us more.

Jirka

</body></email><email><emailId>20101220141656</emailId><senderName>Igor Serebryany</senderName><senderEmail>igor47@moomers.org</senderEmail><timestampReceived>2010-12-20 14:16:56-0400</timestampReceived><subject>Re: [libvirt-users] libvirt unavailable while a VM is in migration?</subject><body>

[Attachment #2 (multipart/mixed)]


On Mon, Dec 20, 2010 at 02:14:42PM +0100, Jiri Denemark wrote:
&gt; Ouch, I wonder if that could be the reason... Could you just compile libvirt
&gt; yourself? 

I still had a box around where I was using a hand-compiled libvirt with
the following version output:

Compiled against library: libvir 0.8.5
Using library: libvir 0.8.5
Using API: QEMU 0.8.5
Running hypervisor: QEMU 0.12.5

I experimented on there, and found the same problem. What's more, the
0.8.5 version appears to have 'virsh list' freeze at the same spot as in
the traceback I gave you for 0.8.6. I'm assuming therefore that the
package conversion is not the issue here; I'd be happy to set up a
hand-compiled 0.8.6 but that would take a little more time.

&gt; tries to authenticate to libvirtd. Could you run this second virsh list with
&gt; LIBVIRT_DEBUG environment variable set to 1 and attach the debug output? Also
&gt; please check the virsh is stuck in the same place. Hopefully the log will tell
&gt; us more.

I have attached two 'virsh list' logs -- one where I just did 'virsh
list' and one where I explicitly specified the URI (
'virsh -c "qemu:///system" list'). Both appear to be stuck at the same
spot. This spot is also the same on libvirt .8.5.0, which has generally
identical output.

Let me know what you think, and thanks again for helping me with this.
--Igor

["virshdebug.txt" (text/plain)]

cloud2:~# LIBVIRT_DEBUG=1 virsh list 
08:08:08.217: 25725: debug : virInitialize:340 : register drivers
08:08:08.217: 25725: debug : virRegisterDriver:942 : registering Test as driver 0
08:08:08.217: 25725: debug : virRegisterNetworkDriver:748 : registering Test as \
network driver 0 08:08:08.217: 25725: debug : virRegisterInterfaceDriver:779 : \
registering Test as interface driver 0 08:08:08.217: 25725: debug : \
virRegisterStorageDriver:810 : registering Test as storage driver 0 08:08:08.217: \
25725: debug : virRegisterDeviceMonitor:841 : registering Test as device driver 0 \
08:08:08.217: 25725: debug : virRegisterSecretDriver:872 : registering Test as secret \
driver 0 08:08:08.217: 25725: debug : virRegisterNWFilterDriver:903 : registering \
Test as network filter driver 0 08:08:08.217: 25725: debug : virRegisterDriver:942 : \
registering Xen as driver 1 08:08:08.217: 25725: debug : virRegisterDriver:942 : \
registering OPENVZ as driver 2 08:08:08.217: 25725: debug : virRegisterDriver:942 : \
registering PHYP as driver 3 08:08:08.217: 25725: debug : \
virRegisterStorageDriver:810 : registering PHYP as storage driver 1 08:08:08.217: \
25725: debug : virRegisterNetworkDriver:748 : registering PHYP as network driver 1 \
08:08:08.218: 25725: debug : vboxRegister:122 : VBoxCGlueInit failed, using dummy \
driver 08:08:08.218: 25725: debug : virRegisterDriver:942 : registering VBOX as \
driver 4 08:08:08.218: 25725: debug : virRegisterNetworkDriver:748 : registering VBOX \
as network driver 2 08:08:08.218: 25725: debug : virRegisterStorageDriver:810 : \
registering VBOX as storage driver 2 08:08:08.218: 25725: debug : \
virRegisterDriver:942 : registering ESX as driver 5 08:08:08.218: 25725: debug : \
virRegisterInterfaceDriver:779 : registering ESX as interface driver 1 08:08:08.218: \
25725: debug : virRegisterNetworkDriver:748 : registering ESX as network driver 3 \
08:08:08.218: 25725: debug : virRegisterStorageDriver:810 : registering ESX as \
storage driver 3 08:08:08.218: 25725: debug : virRegisterDeviceMonitor:841 : \
registering ESX as device driver 1 08:08:08.218: 25725: debug : \
virRegisterSecretDriver:872 : registering ESX as secret driver 1 08:08:08.218: 25725: \
debug : virRegisterNWFilterDriver:903 : registering ESX as network filter driver 1 \
08:08:08.218: 25725: debug : virRegisterDriver:942 : registering remote as driver 6 \
08:08:08.218: 25725: debug : virRegisterNetworkDriver:748 : registering remote as \
network driver 4 08:08:08.218: 25725: debug : virRegisterInterfaceDriver:779 : \
registering remote as interface driver 2 08:08:08.218: 25725: debug : \
virRegisterStorageDriver:810 : registering remote as storage driver 4 08:08:08.218: \
25725: debug : virRegisterDeviceMonitor:841 : registering remote as device driver 2 \
08:08:08.218: 25725: debug : virRegisterSecretDriver:872 : registering remote as \
secret driver 2 08:08:08.218: 25725: debug : virRegisterNWFilterDriver:903 : \
registering remote as network filter driver 2 08:08:08.218: 25725: debug : \
virConnectOpenAuth:1513 : name=(null), auth=0x7ff2230dd340, flags=0 08:08:08.218: \
25725: debug : do_open:1221 : no name, allowing driver auto-select 08:08:08.218: \
25725: debug : do_open:1258 : trying driver 0 (Test) ... 08:08:08.218: 25725: debug : \
do_open:1264 : driver 0 Test returned DECLINED 08:08:08.218: 25725: debug : \
do_open:1258 : trying driver 1 (Xen) ... 08:08:08.218: 25725: debug : do_open:1264 : \
driver 1 Xen returned DECLINED 08:08:08.218: 25725: debug : do_open:1258 : trying \
driver 2 (OPENVZ) ... 08:08:08.218: 25725: debug : do_open:1264 : driver 2 OPENVZ \
returned DECLINED 08:08:08.218: 25725: debug : do_open:1258 : trying driver 3 (PHYP) \
... 08:08:08.218: 25725: debug : do_open:1264 : driver 3 PHYP returned DECLINED
08:08:08.218: 25725: debug : do_open:1258 : trying driver 4 (VBOX) ...
08:08:08.218: 25725: debug : do_open:1264 : driver 4 VBOX returned DECLINED
08:08:08.218: 25725: debug : do_open:1258 : trying driver 5 (ESX) ...
08:08:08.218: 25725: debug : do_open:1264 : driver 5 ESX returned DECLINED
08:08:08.218: 25725: debug : do_open:1258 : trying driver 6 (remote) ...
08:08:08.218: 25725: debug : remoteOpen:1091 : Auto-probe remote URI
08:08:08.218: 25725: debug : doRemoteOpen:573 : proceeding with name = 
08:08:08.218: 25725: debug : remoteIO:10280 : Do proc=66 serial=0 length=28 \
wait=(nil) 08:08:08.218: 25725: debug : remoteIO:10352 : We have the buck 66 \
0x7ff21cb5c010 0x7ff21cb5c010


["virshdebugexplicit.txt" (text/plain)]

cloud2:~# LIBVIRT_DEBUG=1 virsh -c "qemu:///system" list
08:12:17.322: 25752: debug : virInitialize:340 : register drivers
08:12:17.322: 25752: debug : virRegisterDriver:942 : registering Test as driver 0
08:12:17.322: 25752: debug : virRegisterNetworkDriver:748 : registering Test as \
network driver 0 08:12:17.322: 25752: debug : virRegisterInterfaceDriver:779 : \
registering Test as interface driver 0 08:12:17.322: 25752: debug : \
virRegisterStorageDriver:810 : registering Test as storage driver 0 08:12:17.322: \
25752: debug : virRegisterDeviceMonitor:841 : registering Test as device driver 0 \
08:12:17.322: 25752: debug : virRegisterSecretDriver:872 : registering Test as secret \
driver 0 08:12:17.322: 25752: debug : virRegisterNWFilterDriver:903 : registering \
Test as network filter driver 0 08:12:17.322: 25752: debug : virRegisterDriver:942 : \
registering Xen as driver 1 08:12:17.322: 25752: debug : virRegisterDriver:942 : \
registering OPENVZ as driver 2 08:12:17.322: 25752: debug : virRegisterDriver:942 : \
registering PHYP as driver 3 08:12:17.322: 25752: debug : \
virRegisterStorageDriver:810 : registering PHYP as storage driver 1 08:12:17.322: \
25752: debug : virRegisterNetworkDriver:748 : registering PHYP as network driver 1 \
08:12:17.322: 25752: debug : vboxRegister:122 : VBoxCGlueInit failed, using dummy \
driver 08:12:17.322: 25752: debug : virRegisterDriver:942 : registering VBOX as \
driver 4 08:12:17.322: 25752: debug : virRegisterNetworkDriver:748 : registering VBOX \
as network driver 2 08:12:17.322: 25752: debug : virRegisterStorageDriver:810 : \
registering VBOX as storage driver 2 08:12:17.322: 25752: debug : \
virRegisterDriver:942 : registering ESX as driver 5 08:12:17.322: 25752: debug : \
virRegisterInterfaceDriver:779 : registering ESX as interface driver 1 08:12:17.322: \
25752: debug : virRegisterNetworkDriver:748 : registering ESX as network driver 3 \
08:12:17.322: 25752: debug : virRegisterStorageDriver:810 : registering ESX as \
storage driver 3 08:12:17.322: 25752: debug : virRegisterDeviceMonitor:841 : \
registering ESX as device driver 1 08:12:17.322: 25752: debug : \
virRegisterSecretDriver:872 : registering ESX as secret driver 1 08:12:17.322: 25752: \
debug : virRegisterNWFilterDriver:903 : registering ESX as network filter driver 1 \
08:12:17.322: 25752: debug : virRegisterDriver:942 : registering remote as driver 6 \
08:12:17.322: 25752: debug : virRegisterNetworkDriver:748 : registering remote as \
network driver 4 08:12:17.322: 25752: debug : virRegisterInterfaceDriver:779 : \
registering remote as interface driver 2 08:12:17.322: 25752: debug : \
virRegisterStorageDriver:810 : registering remote as storage driver 4 08:12:17.322: \
25752: debug : virRegisterDeviceMonitor:841 : registering remote as device driver 2 \
08:12:17.322: 25752: debug : virRegisterSecretDriver:872 : registering remote as \
secret driver 2 08:12:17.322: 25752: debug : virRegisterNWFilterDriver:903 : \
registering remote as network filter driver 2 08:12:17.322: 25752: debug : \
virConnectOpenAuth:1513 : name=qemu:///system, auth=0x7fbe43c9c340, flags=0 \
08:12:17.323: 25752: debug : do_open:1219 : name "qemu:///system" to URI components:  \
scheme qemu  opaque (null)
  authority (null)
  server (null)
  user (null)
  port 0
  path /system

08:12:17.323: 25752: debug : do_open:1258 : trying driver 0 (Test) ...
08:12:17.323: 25752: debug : do_open:1264 : driver 0 Test returned DECLINED
08:12:17.323: 25752: debug : do_open:1258 : trying driver 1 (Xen) ...
08:12:17.323: 25752: debug : do_open:1264 : driver 1 Xen returned DECLINED
08:12:17.323: 25752: debug : do_open:1258 : trying driver 2 (OPENVZ) ...
08:12:17.323: 25752: debug : do_open:1264 : driver 2 OPENVZ returned DECLINED
08:12:17.323: 25752: debug : do_open:1258 : trying driver 3 (PHYP) ...
08:12:17.323: 25752: debug : do_open:1264 : driver 3 PHYP returned DECLINED
08:12:17.323: 25752: debug : do_open:1258 : trying driver 4 (VBOX) ...
08:12:17.323: 25752: debug : do_open:1264 : driver 4 VBOX returned DECLINED
08:12:17.323: 25752: debug : do_open:1258 : trying driver 5 (ESX) ...
08:12:17.323: 25752: debug : do_open:1264 : driver 5 ESX returned DECLINED
08:12:17.323: 25752: debug : do_open:1258 : trying driver 6 (remote) ...
08:12:17.323: 25752: debug : doRemoteOpen:573 : proceeding with name = qemu:///system
08:12:17.323: 25752: debug : remoteIO:10280 : Do proc=66 serial=0 length=28 \
wait=(nil) 08:12:17.323: 25752: debug : remoteIO:10352 : We have the buck 66 \
0x7fbe3d71b010 0x7fbe3d71b010


["virshdebug0.8.5.txt" (text/plain)]

cloud-failover-01:~# LIBVIRT_DEBUG=1 virsh list
08:11:16.587: debug : virInitialize:339 : register drivers
08:11:16.587: debug : virRegisterDriver:941 : registering Test as driver 0
08:11:16.587: debug : virRegisterNetworkDriver:747 : registering Test as network driver 0
08:11:16.587: debug : virRegisterInterfaceDriver:778 : registering Test as interface driver 0
08:11:16.587: debug : virRegisterStorageDriver:809 : registering Test as storage driver 0
08:11:16.587: debug : virRegisterDeviceMonitor:840 : registering Test as device driver 0
08:11:16.587: debug : virRegisterSecretDriver:871 : registering Test as secret driver 0
08:11:16.587: debug : virRegisterNWFilterDriver:902 : registering Test as network filter driver 0
08:11:16.587: debug : virRegisterDriver:941 : registering remote as driver 1
08:11:16.587: debug : virRegisterNetworkDriver:747 : registering remote as network driver 1
08:11:16.587: debug : virRegisterInterfaceDriver:778 : registering remote as interface driver 1
08:11:16.587: debug : virRegisterStorageDriver:809 : registering remote as storage driver 1
08:11:16.587: debug : virRegisterDeviceMonitor:840 : registering remote as device driver 1
08:11:16.587: debug : virRegisterSecretDriver:871 : registering remote as secret driver 1
08:11:16.587: debug : virRegisterNWFilterDriver:902 : registering remote as network filter driver 1
08:11:16.587: debug : virConnectOpenAuth:1512 : name=(null), auth=0x7fa68aa42120, flags=0
08:11:16.587: debug : do_open:1220 : no name, allowing driver auto-select
08:11:16.587: debug : do_open:1257 : trying driver 0 (Test) ...
08:11:16.587: debug : do_open:1263 : driver 0 Test returned DECLINED
08:11:16.587: debug : do_open:1257 : trying driver 1 (remote) ...
08:11:16.587: debug : remoteOpen:1087 : Auto-probe remote URI
08:11:16.587: debug : doRemoteOpen:564 : proceeding with name = 
08:11:16.588: debug : remoteIO:10037 : Do proc=66 serial=0 length=28 wait=(nil)
08:11:16.588: debug : remoteIO:10112 : We have the buck 66 0x7fa6887dd010 0x7fa6887dd010


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20101222184440</emailId><senderName>Igor Serebryany</senderName><senderEmail>igor47@moomers.org</senderEmail><timestampReceived>2010-12-22 18:44:40-0400</timestampReceived><subject>Re: [libvirt-users] libvirt unavailable while a VM is in migration?]</subject><body>


On Mon, Dec 20, 2010 at 02:14:42PM +0100, Jiri Denemark wrote:
&gt; Ouch, I wonder if that could be the reason...

Just to make sure that my strange compiling/packages aren't causing the
problem, I've set up two servers running fedora 14 with the official
libvirt packages. i experience the same problem -- while a vm is in
migration, nothing else works. my traces reveal libvirt getting stuck at
the same exact spot as on my debian machines.

at this point, i'm pretty sure that this is a bug in libvirt. Has
libvirt ever had the ability to perform other operations while a qemu
migration is in progress? If so than this is a regression, and a pretty
serious one. For me, this makes live-migrations totally unusable, and
since I cannot run my project without live-migrations and I cannot use
any outside tools to do live-migrations when I'm using libvirt this
makes libvirt totally unusable.

i am desperate to get this bug fixed, and i don't think i have the
resources to try to patch it myself. is there anything i can do to help
you guys? more debugging info? foot massage?

--Igor

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20101222191335</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-12-22 19:13:35-0400</timestampReceived><subject>Re: [libvirt-users] libvirt unavailable while a VM is in migration?]</subject><body>

On 23/12/2010, at 5:44 AM, Igor Serebryany wrote:
&gt; On Mon, Dec 20, 2010 at 02:14:42PM +0100, Jiri Denemark wrote:
&gt;&gt; Ouch, I wonder if that could be the reason...
&gt; 
&gt; Just to make sure that my strange compiling/packages aren't causing the
&gt; problem, I've set up two servers running fedora 14 with the official
&gt; libvirt packages. i experience the same problem -- while a vm is in
&gt; migration, nothing else works. my traces reveal libvirt getting stuck at
&gt; the same exact spot as on my debian machines.

This sounded familiar, so went looking in git history.  I *think* this is
what was sounding familiar, from ~ libvirt 0.8.2:

commit 755b53f946107539ba6faf3022450b3d0bbe1d78
Author: Daniel P. Berrange &lt;berrange@redhat.com&gt;
Date:   Thu Jun 24 19:15:27 2010 +0100

    Avoid blocking all APIs during incoming migration
   
    During incoming migration the QEMU monitor is not able to be
    used. The incoming migration code did not keep hold of the
    job lock because migration is split across multiple API calls.
    This meant that further monitor commands on the guest would
    hang until migration finished with no timeout.
   
    In this change the qemuDomainMigratePrepare method sets the
    job flag just before it returns. The qemuDomainMigrateFinish
    method checks for this job flag &amp; clears it once done. This
    prevents any use of the monitor between prepare+finish steps.
   
    The qemuDomainGetJobInfo method is also updated to refresh
    the job elapsed time. This means that virsh domjobinfo can
    return time data during incoming migration
   
    * src/qemu/qemu_driver.c: Keep a job active during incoming
      migration. Refresh job elapsed time when returning job info

Anyone know if this is actually relevant?


&gt; i am desperate to get this bug fixed, and i don't think i have the
&gt; resources to try to patch it myself. is there anything i can do to help
&gt; you guys? more debugging info? foot massage?

Good idea.  Foot massages would definitely be an incentive I
could be convinced with. :)

(it would probably help if I was the right kind of coder for this,
but I'm not)

</body></email><email><emailId>20101221111500</emailId><senderName>Anthony Davis</senderName><senderEmail>tony@specialistdevelopment.com</senderEmail><timestampReceived>2010-12-21 11:15:00-0400</timestampReceived><subject>Re: [libvirt-users] Anyone interested in forming a libvirt "docs" team?</subject><body>

Hi Justin,

I can offer some free time :)

Anthony Davis.


On 21 Dec 2010, at 10:53, Justin Clift &lt;jclift@redhat.com&gt; wrote:

&gt; Hi all,
&gt; 
&gt; There's a lot of documentation for libvirt that needs improving, so wondering
&gt; if anyone would be interested in forming a libvirt "docs" team to help make
&gt; that happen?
&gt; 
&gt; While some of the documentation needs people familiar with specific pieces
&gt; of libvirt, there's also a lot that doesn't, and just needs people with some free
&gt; time and willingness to help.
&gt; 
&gt; Anyone up for it? :)
&gt; 
&gt; Regards and best wishes,
&gt; 
&gt; Justin Clift
&gt; 
&gt; 
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20101221153157</emailId><senderName>Albert Hopkins</senderName><senderEmail>marduk@letterboxes.org</senderEmail><timestampReceived>2010-12-21 15:31:57-0400</timestampReceived><subject>Re: [libvirt-users] Anyone interested in forming a libvirt "docs" team?</subject><body>

I am interested, but not sure if/how I can contribute.

</body></email><email><emailId>20101221160640</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-12-21 16:06:40-0400</timestampReceived><subject>Re: [libvirt-users] Anyone interested in forming a libvirt "docs" team?</subject><body>

On 21/12/2010, at 10:15 PM, Anthony Davis wrote:
&gt; Hi Justin,
&gt; 
&gt; I can offer some free time :)

Awesome Anthony, very welcome. :)

There's a pretty broad spectrum of things we need to get improved. :)

&gt;From stuff that doesn't take any real virtualisation knowledge:

  + The new Virsh Command Reference.  Most pages just list the command name
    and the version of libvirt it came in, without even showing the arguments the
    command can be given.  Like this:

      http://libvirt.org/sources/virshcmdref/html/sect-list.html

    It just needs someone(s) who can run the virsh "help" command for a
    command, and then write down the options the command has.

    We're using a really simple text format for this, so it's pretty easy. :)


Stuff that requires knowledge of an operating system, but not necessarily deep
Virtualisation knowledge:

  + The existing docs on the libvirt.org website have been (mostly) written by people
    using path names that apply to Fedora and RHEL.  It would be good to identify these,
    and update these to include the correct paths for other Linux distributions too, such
    as Ubuntu, OpenSUSE, Gentoo, and so on.

    Probably the first thing that needs to be done for this is just someone to scan through
    the pages on the website making a list of which ones have paths to be looked at.  We
    can then figure out from there what it'll take, who needs to do what, etc. :)

  + Screenshots.  Lots of the virt-manager pieces and processes could benefit from
    having good screenshots taken to show the process.

    Note, I haven't really thought this bit through to a deep level, so we probably need
    to discuss, make a list, and so on. :)


Stuff that could really use a person that *does* have solid knowledge about some
aspect of things, or a strong desire to learn it (then write it up).  The two areas that
jump out the most as needing attention here are:

  + Virtualisation storage concepts.  There are some initial bits around "What is a
    storage pool? What is a storage volume?  How do we use them?" in places, but
    nothing really nicely put together, targeted to general SysAdmin users.

    Some of this info does exist in the Fedora or RHEL virtualisation guides, but
    they're distro specific and this info should be available on the libvirt.org or
    virt-tools.org websites themselves.

  + Networking and virtualisation.  All kinds of stuff here, from explaining how each
    of the virtual networking types work, through to explaining what the VirtIO network
    device is, and how to install the drivers for it in Windows.  All of which is directly
    of use to heaps of people, and hasn't yet been written. Heh. ;)

So, I guess the first and best question is "which of the above sounds like you?" :)

Regards and best wishes,

Justin Clift

</body></email><email><emailId>20101221162317</emailId><senderName>Scott Baker</senderName><senderEmail>bakers@canbytel.com</senderEmail><timestampReceived>2010-12-21 16:23:17-0400</timestampReceived><subject>Re: [libvirt-users] Anyone interested in forming a libvirt "docs" team?</subject><body>

On 12/21/2010 03:15 AM, Anthony Davis wrote:
&gt; Hi Justin,
&gt;
&gt; I can offer some free time:)

I'd be willing to contribute to a wiki if we had the docs in a wiki.

-- 
Scott Baker - Canby Telcom
System Administrator - RHCE - 503.266.8253

</body></email><email><emailId>20101221170100</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-12-21 17:01:00-0400</timestampReceived><subject>Re: [libvirt-users] Anyone interested in forming a libvirt "docs" team?</subject><body>

On 22/12/2010, at 2:31 AM, Albert Hopkins wrote:
&gt; I am interested, but not sure if/how I can contribute.

All good.  Showing that you're interested is the right first step. :)

There are quite a few really important things that need to be
improved with the libvirt documentation, so it more comes down
to "do any of them appeal to you?". :)

There was an initial kind of overview/list in the reply to Anthony
earlier this hour, and I'm copying that to the wiki right now so
we can flesh it out. :)

Do you reckon you could assist in getting the options written up
for some of the virsh commands in the Virsh Command Reference?

I think that's applicable to most libvirt users, and is one of the most
under-documented things we need to get fixed. :)

Regards and best wishes,

Justin Clift




</body></email><email><emailId>20101221171635</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-12-21 17:16:35-0400</timestampReceived><subject>Re: [libvirt-users] Anyone interested in forming a libvirt "docs" team?</subject><body>

On 22/12/2010, at 4:01 AM, Justin Clift wrote:
&gt; On 22/12/2010, at 2:31 AM, Albert Hopkins wrote:
&gt;&gt; I am interested, but not sure if/how I can contribute.
&gt; 
&gt; All good.  Showing that you're interested is the right first step. :)
&gt; 
&gt; There are quite a few really important things that need to be
&gt; improved with the libvirt documentation, so it more comes down
&gt; to "do any of them appeal to you?". :)
&gt; 
&gt; There was an initial kind of overview/list in the reply to Anthony
&gt; earlier this hour, and I'm copying that to the wiki right now so
&gt; we can flesh it out. :)

Wiki page here:

  http://wiki.libvirt.org/page/DocsToDo

:)

</body></email><email><emailId>20101220020904</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2010-12-20 02:09:04-0400</timestampReceived><subject>Re: [libvirt-users] Error creating a new vm</subject><body>

 20101220 04:48, Anthony Davis :
&gt; Hi,
&gt; 
&gt; I wonder if anyone can help me with this, I have been trying to get a vm up and \
&gt; running for a while now and cant for the life of me work out why it isnt working. \
&gt; The errors I get arnt very helpful and im at a loss as how to debug this any \
&gt; further. 
&gt; Here is the command and output that I get...(Also nothing shows up with virsh list \
&gt; --all after so its starting to install then dropping out) 
&gt; Hope someone can help. Thanks!
&gt; 
&gt; [root@server ~]# /usr/bin/virt-install -n test01 -r 512 --os-variant=virtio26 -l \
&gt; http://172.16.0.100/iso/centos-5.5/ --nographics --noautoconsole --disk \
&gt; path=/dev/vg_storage/test01, bus=virtio -w bridge:br0 -x "console=ttyS0 \
&gt; ks=http://172.16.0.100/ks/ks-vm.cfg" -d -v
Hi, Anthony

Which libvirt version do you use? If I'm right, it should be
caused by a recent patch.

     /* wait for qemu process to to show up */
     if (ret == 0) {
         if (virFileReadPid(driver-&gt;stateDir, vm-&gt;def-&gt;name, &amp;vm-&gt;pid)) {
             qemuReportError(VIR_ERR_INTERNAL_ERROR,
                             _("Domain %s didn't show up\n"), 
vm-&gt;def-&gt;name);
             ret = -1;
         }
#if 0
     } else if (ret == -2) {
         /*
          * XXX this is bogus. It isn't safe to set vm-&gt;pid = child
          * because the child no longer exists.
          */

         /* The virExec process that launches the daemon failed. Pending on
          * when it failed (we can't determine for sure), there may be
          * extra info in the domain log (if the hook failed for example).
          *
          * Pretend like things succeeded, and let 'WaitForMonitor' report
          * the log contents for us.
          */
         vm-&gt;pid = child;
         ret = 0;
#endif
     }

could you check your guest log, and also libvirtd log?

/var/log/libvirt/qemu/$guest.log
/var/log/messages

Regards
Osier


</body></email><email><emailId>20101220104359</emailId><senderName>Anthony Davis</senderName><senderEmail>tony@specialistdevelopment.com</senderEmail><timestampReceived>2010-12-20 10:43:59-0400</timestampReceived><subject>Re: [libvirt-users] Error creating a new vm</subject><body>


On 20 Dec 2010, at 02:09, Osier Yang wrote:

&gt;  20101220 04:48, Anthony Davis :
&gt; &gt; Hi,
&gt; &gt; 
&gt; &gt; I wonder if anyone can help me with this, I have been trying to get a vm up and \
&gt; &gt; running for a while now and cant for the life of me work out why it isnt working. \
&gt; &gt; The errors I get arnt very helpful and im at a loss as how to debug this any \
&gt; &gt; further. 
&gt; &gt; Here is the command and output that I get...(Also nothing shows up with virsh \
&gt; &gt; list --all after so its starting to install then dropping out) 
&gt; &gt; Hope someone can help. Thanks!
&gt; &gt; 
&gt; &gt; [root@server ~]# /usr/bin/virt-install -n test01 -r 512 --os-variant=virtio26 -l \
&gt; &gt; http://172.16.0.100/iso/centos-5.5/ --nographics --noautoconsole --disk \
&gt; &gt; path=/dev/vg_storage/test01, bus=virtio -w bridge:br0 -x "console=ttyS0 \
&gt; &gt; ks=http://172.16.0.100/ks/ks-vm.cfg" -d -v
&gt; Hi, Anthony
&gt; 
&gt; Which libvirt version do you use? If I'm right, it should be
&gt; caused by a recent patch.
&gt; 
&gt; /* wait for qemu process to to show up */
&gt; if (ret == 0) {
&gt; if (virFileReadPid(driver-&gt;stateDir, vm-&gt;def-&gt;name, &amp;vm-&gt;pid)) {
&gt; qemuReportError(VIR_ERR_INTERNAL_ERROR,
&gt; _("Domain %s didn't show up\n"), vm-&gt;def-&gt;name);
&gt; ret = -1;
&gt; }
&gt; #if 0
&gt; } else if (ret == -2) {
&gt; /*
&gt; * XXX this is bogus. It isn't safe to set vm-&gt;pid = child
&gt; * because the child no longer exists.
&gt; */
&gt; 
&gt; /* The virExec process that launches the daemon failed. Pending on
&gt; * when it failed (we can't determine for sure), there may be
&gt; * extra info in the domain log (if the hook failed for example).
&gt; *
&gt; * Pretend like things succeeded, and let 'WaitForMonitor' report
&gt; * the log contents for us.
&gt; */
&gt; vm-&gt;pid = child;
&gt; ret = 0;
&gt; #endif
&gt; }
&gt; 
&gt; could you check your guest log, and also libvirtd log?
&gt; 
&gt; /var/log/libvirt/qemu/$guest.log
&gt; /var/log/messages
&gt; 
&gt; Regards
&gt; Osier
&gt; 

Hi Osier,

Here are the version numbers:

virsh # version
Compiled against library: libvir 0.6.3
Using library: libvir 0.6.3
Using API: QEMU 0.6.3
Running hypervisor: QEMU 0.9.0

Also here are the logs:

# cat /var/log/libvirt/qemu/test01.log LC_ALL=C PATH=/sbin:/usr/sbin:/bin:/usr/bin \
HOME=/ /usr/bin/qemu-system-x86_64 -S -M rhel5.4.0 -no-kqemu -m 512 -smp 1 -nographic \
-monitor pty -pidfile /var/run/libvirt/qemu//test01.pid -no-reboot -boot c -kernel \
/var/lib/libvirt/boot/virtinst-vmlinuz.wmv9KP -initrd \
/var/lib/libvirt/boot/virtinst-initrd.img.PBIGHX -append \
method=http://10.0.0.100/iso/centos-5.5/ console=ttyS0 \
ks=http://10.0.0.100/ks/ks-vm.cfg -hda /dev/vg_storage/test01 -net \
nic,macaddr=54:52:00:6f:8e:05,vlan=0 -net tap,fd=16,script=,vlan=0,ifname=vnet0 \
-serial pty -parallel none -usb  Supported machines are:
pc         Standard PC (default)
isapc      ISA-only PC


# cat /var/log/messages | grep "10:42"
Dec 20 10:42:11 ims-gl-lin01 libvirtd: 10:42:11.309: error : Domain not found: no \
                domain with matching name 'test01' 
Dec 20 10:42:11 ims-gl-lin01 libvirtd: 10:42:11.329: error : Domain not found: no \
                domain with matching uuid '??P??' 
Dec 20 10:42:11 ims-gl-lin01 libvirtd: 10:42:11.600: error : Domain not found: no \
                domain with matching name 'test01' 
Dec 20 10:42:11 ims-gl-lin01 libvirtd: 10:42:11.611: warning : Unexpected exit status \
                '1', qemu probably failed 
Dec 20 10:42:11 ims-gl-lin01 kernel: device vnet0 entered promiscuous mode
Dec 20 10:42:11 ims-gl-lin01 kernel: type=1700 audit(1292841731.617:22): dev=vnet0 \
                prom=256 old_prom=0 auid=4294967295 ses=4294967295
Dec 20 10:42:11 ims-gl-lin01 kernel: br0: port 2(vnet0) entering learning state
Dec 20 10:42:12 ims-gl-lin01 avahi-daemon[3118]: New relevant interface vnet0.IPv6 \
                for mDNS.
Dec 20 10:42:12 ims-gl-lin01 avahi-daemon[3118]: Joining mDNS multicast group on \
                interface vnet0.IPv6 with address fe80::fc52:ff:fe6f:8e05.
Dec 20 10:42:12 ims-gl-lin01 avahi-daemon[3118]: Registering new address record for \
                fe80::fc52:ff:fe6f:8e05 on vnet0.
Dec 20 10:42:21 ims-gl-lin01 libvirtd: 10:42:21.720: error : internal error Domain \
                test01 didn't show up  
Dec 20 10:42:21 ims-gl-lin01 avahi-daemon[3118]: Interface vnet0.IPv6 no longer \
                relevant for mDNS.
Dec 20 10:42:21 ims-gl-lin01 avahi-daemon[3118]: Leaving mDNS multicast group on \
                interface vnet0.IPv6 with address fe80::fc52:ff:fe6f:8e05.
Dec 20 10:42:21 ims-gl-lin01 kernel: br0: port 2(vnet0) entering disabled state
Dec 20 10:42:21 ims-gl-lin01 avahi-daemon[3118]: Withdrawing address record for \
                fe80::fc52:ff:fe6f:8e05 on vnet0.
Dec 20 10:42:21 ims-gl-lin01 kernel: device vnet0 left promiscuous mode
Dec 20 10:42:21 ims-gl-lin01 kernel: type=1700 audit(1292841741.733:23): dev=vnet0 \
                prom=0 old_prom=256 auid=4294967295 ses=4294967295
Dec 20 10:42:21 ims-gl-lin01 kernel: br0: port 2(vnet0) entering disabled state


Hope you can help.

Kind Regads

Tony


</body></email><email><emailId>20101220125735</emailId><senderName>Jiri Denemark</senderName><senderEmail>jdenemar@redhat.com</senderEmail><timestampReceived>2010-12-20 12:57:35-0400</timestampReceived><subject>Re: [libvirt-users] Error creating a new vm</subject><body>

&gt; Here are the version numbers:
&gt; 
&gt; virsh # version
&gt; Compiled against library: libvir 0.6.3
&gt; Using library: libvir 0.6.3
&gt; Using API: QEMU 0.6.3
&gt; Running hypervisor: QEMU 0.9.0
&gt; 
&gt; Also here are the logs:
&gt; 
&gt; # cat /var/log/libvirt/qemu/test01.log LC_ALL=C PATH=/sbin:/usr/sbin:/bin:/usr/bin \
&gt; HOME=/ /usr/bin/qemu-system-x86_64 -S -M rhel5.4.0 -no-kqemu -m 512 -smp 1 \
&gt; -nographic -monitor pty -pidfile /var/run/libvirt/qemu//test01.pid -no-reboot -boot \
&gt; c -kernel /var/lib/libvirt/boot/virtinst-vmlinuz.wmv9KP -initrd \
&gt; /var/lib/libvirt/boot/virtinst-initrd.img.PBIGHX -append \
&gt; method=http://10.0.0.100/iso/centos-5.5/ console=ttyS0 \
&gt; ks=http://10.0.0.100/ks/ks-vm.cfg -hda /dev/vg_storage/test01 -net \
&gt; nic,macaddr=54:52:00:6f:8e:05,vlan=0 -net tap,fd=16,script=,vlan=0,ifname=vnet0 \
&gt; -serial pty -parallel none -usb  Supported machines are:
&gt; pc         Standard PC (default)
&gt; isapc      ISA-only PC

Ah, that is the problem. Your /usr/bin/qemu-system-x86_64 binary only supports
the above machine types but domain XML wants rhel5.4.0 machine type. Did you
install qemu from an unofficial package or something like that? Since normally
it supports rhel5.4.0 and the binary is called /usr/libexec/qemu-kvm. If you
really want to use the /usr/bin/qemu-system-x86_64 binary, you need to make
virt-install use "pc" machine type since by default it doesn't use any and
libvirt 0.6.3 selects rhel5.4.0 as a default (newer libvirt versions are more
clever in this). However, virt-install doesn't seem to have an option which
could be used for overriding machine type :-/ You would need to change the
type element in domain XML from
    &lt;type arch='x86_64'&gt;hvm&lt;/type&gt;
to
    &lt;type arch='x86_64' machine='pc'&gt;hvm&lt;/type&gt;

The easiest fix is to use the /usr/libexec/qemu-kvm binary, which is provided
by kvm package.

Jirka


</body></email><email><emailId>20101220131729</emailId><senderName>Anthony Davis</senderName><senderEmail>tony@specialistdevelopment.com</senderEmail><timestampReceived>2010-12-20 13:17:29-0400</timestampReceived><subject>Re: [libvirt-users] Error creating a new vm</subject><body>


On 20 Dec 2010, at 12:57, Jiri Denemark wrote:

&gt; &gt; Here are the version numbers:
&gt; &gt; 
&gt; &gt; virsh # version
&gt; &gt; Compiled against library: libvir 0.6.3
&gt; &gt; Using library: libvir 0.6.3
&gt; &gt; Using API: QEMU 0.6.3
&gt; &gt; Running hypervisor: QEMU 0.9.0
&gt; &gt; 
&gt; &gt; Also here are the logs:
&gt; &gt; 
&gt; &gt; # cat /var/log/libvirt/qemu/test01.log LC_ALL=C \
&gt; &gt; PATH=/sbin:/usr/sbin:/bin:/usr/bin HOME=/ /usr/bin/qemu-system-x86_64 -S -M \
&gt; &gt; rhel5.4.0 -no-kqemu -m 512 -smp 1 -nographic -monitor pty -pidfile \
&gt; &gt; /var/run/libvirt/qemu//test01.pid -no-reboot -boot c -kernel \
&gt; &gt; /var/lib/libvirt/boot/virtinst-vmlinuz.wmv9KP -initrd \
&gt; &gt; /var/lib/libvirt/boot/virtinst-initrd.img.PBIGHX -append \
&gt; &gt; method=http://10.0.0.100/iso/centos-5.5/ console=ttyS0 \
&gt; &gt; ks=http://10.0.0.100/ks/ks-vm.cfg -hda /dev/vg_storage/test01 -net \
&gt; &gt; nic,macaddr=54:52:00:6f:8e:05,vlan=0 -net tap,fd=16,script=,vlan=0,ifname=vnet0 \
&gt; &gt; -serial pty -parallel none -usb  Supported machines are:
&gt; &gt; pc         Standard PC (default)
&gt; &gt; isapc      ISA-only PC
&gt; 
&gt; Ah, that is the problem. Your /usr/bin/qemu-system-x86_64 binary only supports
&gt; the above machine types but domain XML wants rhel5.4.0 machine type. Did you
&gt; install qemu from an unofficial package or something like that? Since normally
&gt; it supports rhel5.4.0 and the binary is called /usr/libexec/qemu-kvm. If you
&gt; really want to use the /usr/bin/qemu-system-x86_64 binary, you need to make
&gt; virt-install use "pc" machine type since by default it doesn't use any and
&gt; libvirt 0.6.3 selects rhel5.4.0 as a default (newer libvirt versions are more
&gt; clever in this). However, virt-install doesn't seem to have an option which
&gt; could be used for overriding machine type :-/ You would need to change the
&gt; type element in domain XML from
&gt; &lt;type arch='x86_64'&gt;hvm&lt;/type&gt;
&gt; to
&gt; &lt;type arch='x86_64' machine='pc'&gt;hvm&lt;/type&gt;
&gt; 
&gt; The easiest fix is to use the /usr/libexec/qemu-kvm binary, which is provided
&gt; by kvm package.
&gt; 
&gt; Jirka

Hi Jirka,

Thanks for your reply :)

Well iv installed the default RPMS via Centos (5.5)

How do I get around this? Isnt that kind of weird that you an install a rhel machine \
on what is essentially a rhel machine?

Kind Regards

Tony


</body></email><email><emailId>20101220150402</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-12-20 15:04:02-0400</timestampReceived><subject>Re: [libvirt-users] Error creating a new vm</subject><body>

On 12/20/2010 07:57 AM, Jiri Denemark wrote:
&gt; &gt; Here are the version numbers:
&gt; &gt; 
&gt; &gt; virsh # version
&gt; &gt; Compiled against library: libvir 0.6.3
&gt; &gt; Using library: libvir 0.6.3
&gt; &gt; Using API: QEMU 0.6.3
&gt; &gt; Running hypervisor: QEMU 0.9.0
&gt; &gt; 
&gt; &gt; Also here are the logs:
&gt; &gt; 
&gt; &gt; # cat /var/log/libvirt/qemu/test01.log LC_ALL=C \
&gt; &gt; PATH=/sbin:/usr/sbin:/bin:/usr/bin HOME=/ /usr/bin/qemu-system-x86_64 -S -M \
&gt; &gt; rhel5.4.0 -no-kqemu -m 512 -smp 1 -nographic -monitor pty -pidfile \
&gt; &gt; /var/run/libvirt/qemu//test01.pid -no-reboot -boot c -kernel \
&gt; &gt; /var/lib/libvirt/boot/virtinst-vmlinuz.wmv9KP -initrd \
&gt; &gt; /var/lib/libvirt/boot/virtinst-initrd.img.PBIGHX -append \
&gt; &gt; method=http://10.0.0.100/iso/centos-5.5/ console=ttyS0 \
&gt; &gt; ks=http://10.0.0.100/ks/ks-vm.cfg -hda /dev/vg_storage/test01 -net \
&gt; &gt; nic,macaddr=54:52:00:6f:8e:05,vlan=0 -net tap,fd=16,script=,vlan=0,ifname=vnet0 \
&gt; &gt; -serial pty -parallel none -usb  Supported machines are:
&gt; &gt; pc         Standard PC (default)
&gt; &gt; isapc      ISA-only PC
&gt; 
&gt; Ah, that is the problem. Your /usr/bin/qemu-system-x86_64 binary only supports
&gt; the above machine types but domain XML wants rhel5.4.0 machine type. Did you
&gt; install qemu from an unofficial package or something like that? Since normally
&gt; it supports rhel5.4.0 and the binary is called /usr/libexec/qemu-kvm. If you
&gt; really want to use the /usr/bin/qemu-system-x86_64 binary, you need to make
&gt; virt-install use "pc" machine type since by default it doesn't use any and
&gt; libvirt 0.6.3 selects rhel5.4.0 as a default (newer libvirt versions are more
&gt; clever in this). However, virt-install doesn't seem to have an option which
&gt; could be used for overriding machine type :-/

Just an FYI, upstream virt-install does have a --machine option

- Cole


</body></email><email><emailId>20101220014821</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2010-12-20 01:48:21-0400</timestampReceived><subject>Re: [libvirt-users] using virDomainMigrateSetMaxDowntime</subject><body>

 201012 17 16:34, Igor Serebryany :
&gt; I would like to use the virDomainMigrateSetMaxDowntime but I'm a bit
&gt; confused about how to use it.
&gt; 
&gt; If I try to set the downtime before I call domain.migrate(), I get the
&gt; error "domain is not being migrated". But I cannot call it afterwards
&gt; because domain.migrate() does not return until the migration has
&gt; completed.

the API is intended to prevent the migration from lasting forever if
the memory of source domain is dirtying so quickly that QEMU does
not have time todo the final completion switchover, but not to
guarantee the migration will be finished more quickly.

so yes, domain.migration will not return till it's finished.

- Osier

</body></email><email><emailId>20101215121612</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-12-15 12:16:12-0400</timestampReceived><subject>Re: [libvirt-users] KVM Virtualisation, Console output no longer working</subject><body>

On Wed, Dec 15, 2010 at 12:06:27PM -0000, tony@specialistdevelopment.com wrote:
&gt; Hi,
&gt; 
&gt; I used to use KVM for virtualisation and have now moved back to it, but I
&gt; have a problem.
&gt; 
&gt; When i used to install the guest machine with virt-install i used to use
&gt; the -x "extra args" part to set the console for the install and guest, but
&gt; it no longer works.
&gt; 
&gt; Here is the command i use:
&gt; 
&gt; virt-install -n server01 -r 512 --os-variant=virtio26 -c /isos/c5u5.iso
&gt; --nographics --noautoconsole -f /storage/vm/server01 -s 5 bus=virtio -w
&gt; bridge:br0 -x "console=ttyS0 ks=http://www.domain.com/c5u5.cfg"
&gt; As you can see im setting the console to ttyS0, but then when i go to
&gt; connect to the console with:

You are doing a CDROM based install. The kernel args for that are set
in the syslinux config file inside the ISO image and can't be overriden
using -x. The -x arg only works when doing a kernel+initrd install
(ie --location instead of --cdrom/-c)

Daniel

</body></email><email><emailId>20101215121806</emailId><senderName></senderName><senderEmail>tony</senderEmail><timestampReceived>2010-12-15 12:18:06-0400</timestampReceived><subject>Re: [libvirt-users] KVM Virtualisation, Console output no longer working</subject><body>

Ahhhhh, i see :)

Thanks for that :)

Kind Regards

Tony

&gt; On Wed, Dec 15, 2010 at 12:06:27PM -0000, tony@specialistdevelopment.com
&gt; wrote:
&gt;&gt; Hi,
&gt;&gt;
&gt;&gt; I used to use KVM for virtualisation and have now moved back to it, but
&gt;&gt; I
&gt;&gt; have a problem.
&gt;&gt;
&gt;&gt; When i used to install the guest machine with virt-install i used to use
&gt;&gt; the -x "extra args" part to set the console for the install and guest,
&gt;&gt; but
&gt;&gt; it no longer works.
&gt;&gt;
&gt;&gt; Here is the command i use:
&gt;&gt;
&gt;&gt; virt-install -n server01 -r 512 --os-variant=virtio26 -c /isos/c5u5.iso
&gt;&gt; --nographics --noautoconsole -f /storage/vm/server01 -s 5 bus=virtio -w
&gt;&gt; bridge:br0 -x "console=ttyS0 ks=http://www.domain.com/c5u5.cfg"
&gt;&gt; As you can see im setting the console to ttyS0, but then when i go to
&gt;&gt; connect to the console with:
&gt;
&gt; You are doing a CDROM based install. The kernel args for that are set
&gt; in the syslinux config file inside the ISO image and can't be overriden
&gt; using -x. The -x arg only works when doing a kernel+initrd install
&gt; (ie --location instead of --cdrom/-c)
&gt;
&gt; Daniel
&gt;

</body></email><email><emailId>20101213221440</emailId><senderName>David Ehle</senderName><senderEmail>ehle@agni.phys.iit.edu</senderEmail><timestampReceived>2010-12-13 22:14:40-0400</timestampReceived><subject>Re: [libvirt-users] Deploying libvirt with live migration</subject><body>



I've run into the same scenario... I've often wondered if it wouldn't make 
sense to have a lock file or some other notification in place to let both 
hosts know who currently has "ownership" of the VM.

David.

On Mon, 13 Dec 2010, Scott Baker wrote:

&gt; I have two physical servers: Virt1 and Virt2. I'm setting up live migration 
&gt; with CentOS 5.5 between the two. I've done this by NFS mounting /etc/libvirt 
&gt; and /var/lib/libvirt/images on both servers. This is working well for me 
&gt; except for one thing.
&gt;
&gt; I see the same list of VMs on each server (as expected), but each server 
&gt; (Virt1 and Virt2) are able to start the same VM at the same time. This 
&gt; obviously causes IP conflicts and thrashes the disk image. Is there a way to 
&gt; tell my VM "cluster" that a VM is only allowed to be opened on one host at a 
&gt; time?
&gt;
&gt; -- 
&gt; Scott Baker - Canby Telcom
&gt; System Administrator - RHCE - 503.266.8253
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

</body></email><email><emailId>20101213222825</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-12-13 22:28:25-0400</timestampReceived><subject>Re: [libvirt-users] Deploying libvirt with live migration</subject><body>

2010/12/13 Scott Baker &lt;bakers@canbytel.com&gt;:
&gt; I have two physical servers: Virt1 and Virt2. I'm setting up live migration
&gt; with CentOS 5.5 between the two. I've done this by NFS mounting /etc/libvirt
&gt; and /var/lib/libvirt/images on both servers. This is working well for me
&gt; except for one thing.
&gt;
&gt; I see the same list of VMs on each server (as expected), but each server
&gt; (Virt1 and Virt2) are able to start the same VM at the same time. This
&gt; obviously causes IP conflicts and thrashes the disk image. Is there a way to
&gt; tell my VM "cluster" that a VM is only allowed to be opened on one host at a
&gt; time?
&gt;

Well don't share /etc/libvirt, there is no need to.

Just have the domain config on the host that currently executes the
domain and tell libvirt to migrate the persistent domain condif along
with the domain:

virsh migrate --persistent --undefinesource vm1 qemu://virt2/system

Matthias

</body></email><email><emailId>20101213223016</emailId><senderName>Scott Baker</senderName><senderEmail>bakers@canbytel.com</senderEmail><timestampReceived>2010-12-13 22:30:16-0400</timestampReceived><subject>Re: [libvirt-users] Deploying libvirt with live migration</subject><body>

On 12/13/2010 02:28 PM, Matthias Bolte wrote:
&gt; Well don't share /etc/libvirt, there is no need to.
&gt;
&gt; Just have the domain config on the host that currently executes the
&gt; domain and tell libvirt to migrate the persistent domain condif along
&gt; with the domain:
&gt;
&gt; virsh migrate --persistent --undefinesource vm1 qemu://virt2/system

I suppose that would work... but if Virt2 dies and I need to start its 
VMs on Virt1 those XML configs won't be there and it will make it more 
complicated.

Not just a simple "virsh start Foobar"

-- 
Scott Baker - Canby Telcom
System Administrator - RHCE - 503.266.8253

</body></email><email><emailId>20101213223522</emailId><senderName>David Ehle</senderName><senderEmail>ehle@agni.phys.iit.edu</senderEmail><timestampReceived>2010-12-13 22:35:22-0400</timestampReceived><subject>Re: [libvirt-users] Deploying libvirt with live migration</subject><body>


Even if your not sharing /etc/libvirt, if you have migrated at least once, 
both systems see the VM's as available for starting/running so just not 
sharing /etc/libvirt is not a solution to the problem/concern...

Ideally if you try to start a VM that is already running on a different 
host it should balk and you should get an (overridable) warning. (IMHO)

David.

On Mon, 13 Dec 2010, Scott Baker wrote:

&gt; On 12/13/2010 02:28 PM, Matthias Bolte wrote:
&gt;&gt; Well don't share /etc/libvirt, there is no need to.
&gt;&gt; 
&gt;&gt; Just have the domain config on the host that currently executes the
&gt;&gt; domain and tell libvirt to migrate the persistent domain condif along
&gt;&gt; with the domain:
&gt;&gt; 
&gt;&gt; virsh migrate --persistent --undefinesource vm1 qemu://virt2/system
&gt;
&gt; I suppose that would work... but if Virt2 dies and I need to start its VMs on 
&gt; Virt1 those XML configs won't be there and it will make it more complicated.
&gt;
&gt; Not just a simple "virsh start Foobar"
&gt;
&gt; -- 
&gt; Scott Baker - Canby Telcom
&gt; System Administrator - RHCE - 503.266.8253
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

</body></email><email><emailId>20101213224300</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-12-13 22:43:00-0400</timestampReceived><subject>Re: [libvirt-users] Deploying libvirt with live migration</subject><body>

2010/12/13 David Ehle &lt;ehle@agni.phys.iit.edu&gt;:
&gt;
&gt; Even if your not sharing /etc/libvirt, if you have migrated at least once,
&gt; both systems see the VM's as available for starting/running so just not
&gt; sharing /etc/libvirt is not a solution to the problem/concern...

Well, that depends on the flags you pass to the migrate command. The
default libvirt migration semantic is a bit unexpected as it leaves
the domain defined but in shutdown state on the source host and on the
destination host it's running as a transient guest. That's why I gave
it the --persistent --undefinesource flags to make it take it's config
with it.

&gt; Ideally if you try to start a VM that is already running on a different host
&gt; it should balk and you should get an (overridable) warning. (IMHO)

There is ongoing work on a lock manager system for libvirt that shall
prevent two domains from using the same disk image at the same time.
That's not exactly what you're looking for but it's related.

Matthias

&gt; David.
&gt;
&gt; On Mon, 13 Dec 2010, Scott Baker wrote:
&gt;
&gt;&gt; On 12/13/2010 02:28 PM, Matthias Bolte wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; Well don't share /etc/libvirt, there is no need to.
&gt;&gt;&gt;
&gt;&gt;&gt; Just have the domain config on the host that currently executes the
&gt;&gt;&gt; domain and tell libvirt to migrate the persistent domain condif along
&gt;&gt;&gt; with the domain:
&gt;&gt;&gt;
&gt;&gt;&gt; virsh migrate --persistent --undefinesource vm1 qemu://virt2/system
&gt;&gt;
&gt;&gt; I suppose that would work... but if Virt2 dies and I need to start its VMs
&gt;&gt; on Virt1 those XML configs won't be there and it will make it more
&gt;&gt; complicated.
&gt;&gt;
&gt;&gt; Not just a simple "virsh start Foobar"
&gt;&gt;
&gt;&gt; --
&gt;&gt; Scott Baker - Canby Telcom
&gt;&gt; System Administrator - RHCE - 503.266.8253
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; libvirt-users mailing list
&gt;&gt; libvirt-users@redhat.com
&gt;&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;&gt;
&gt;

</body></email><email><emailId>20101213224955</emailId><senderName>David Ehle</senderName><senderEmail>ehle@agni.phys.iit.edu</senderEmail><timestampReceived>2010-12-13 22:49:55-0400</timestampReceived><subject>Re: [libvirt-users] Deploying libvirt with live migration</subject><body>



On Mon, 13 Dec 2010, Matthias Bolte wrote:

&gt; 2010/12/13 David Ehle &lt;ehle@agni.phys.iit.edu&gt;:
&gt;&gt;
&gt;&gt; Even if your not sharing /etc/libvirt, if you have migrated at least once,
&gt;&gt; both systems see the VM's as available for starting/running so just not
&gt;&gt; sharing /etc/libvirt is not a solution to the problem/concern...
&gt;
&gt; Well, that depends on the flags you pass to the migrate command. The
&gt; default libvirt migration semantic is a bit unexpected as it leaves
&gt; the domain defined but in shutdown state on the source host and on the
&gt; destination host it's running as a transient guest. That's why I gave
&gt; it the --persistent --undefinesource flags to make it take it's config
&gt; with it.

Thank you for explaining that - I usually use the gui admin tool so some 
of the details I'm oblivious too.
&gt;
&gt;&gt; Ideally if you try to start a VM that is already running on a different host
&gt;&gt; it should balk and you should get an (overridable) warning. (IMHO)
&gt;
&gt; There is ongoing work on a lock manager system for libvirt that shall
&gt; prevent two domains from using the same disk image at the same time.
&gt; That's not exactly what you're looking for but it's related.

I think that would be more than sufficient ;)

Is that project publicly accesible?  I might be interested in lending a 
hand :)

David.
&gt;
&gt; Matthias
&gt;
&gt;&gt; David.
&gt;&gt;
&gt;&gt; On Mon, 13 Dec 2010, Scott Baker wrote:
&gt;&gt;
&gt;&gt;&gt; On 12/13/2010 02:28 PM, Matthias Bolte wrote:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Well don't share /etc/libvirt, there is no need to.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Just have the domain config on the host that currently executes the
&gt;&gt;&gt;&gt; domain and tell libvirt to migrate the persistent domain condif along
&gt;&gt;&gt;&gt; with the domain:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; virsh migrate --persistent --undefinesource vm1 qemu://virt2/system
&gt;&gt;&gt;
&gt;&gt;&gt; I suppose that would work... but if Virt2 dies and I need to start its VMs
&gt;&gt;&gt; on Virt1 those XML configs won't be there and it will make it more
&gt;&gt;&gt; complicated.
&gt;&gt;&gt;
&gt;&gt;&gt; Not just a simple "virsh start Foobar"
&gt;&gt;&gt;
&gt;&gt;&gt; --
&gt;&gt;&gt; Scott Baker - Canby Telcom
&gt;&gt;&gt; System Administrator - RHCE - 503.266.8253
&gt;&gt;&gt;
&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt; libvirt-users mailing list
&gt;&gt;&gt; libvirt-users@redhat.com
&gt;&gt;&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;&gt;&gt;
&gt;&gt;
&gt;

</body></email><email><emailId>20101213060733</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2010-12-13 06:07:33-0400</timestampReceived><subject>Re: [libvirt-users] libvirt printing to stderr</subject><body>

 20101213 13:43, Albert Hopkins :
&gt; I'm writing an app and using the Python bindings for libvirt.
&gt;
&gt; Everything is fine but, in some cases I need to call lookupByName().
&gt; There are a lot of times when the name will not exist, I trap the
&gt; exception, however I still get this message printed to stderr:
&gt;
&gt; libvir: QEMU error : Domain not found: no domain with matching name
&gt; 'foo'
&gt;
&gt; Is there any way to turn this off?  This is a command-line program so
&gt; the extra output makes the interface confusing.
&gt;
&gt; I've tried re-assigning sys.stderr before calling lookupByName(), but
&gt; that doesn't seem to have any affect.
&gt;

actually there is a bug for this problem, it should be warning, but not
error, and will be fixed upstream soon.

- Osier


</body></email><email><emailId>20101213074704</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-12-13 07:47:04-0400</timestampReceived><subject>Re: [libvirt-users] libvirt printing to stderr</subject><body>

2010/12/13 Osier Yang &lt;jyang@redhat.com&gt;:
&gt;  20101213 13:43, Albert Hopkins :
&gt;&gt;
&gt;&gt; I'm writing an app and using the Python bindings for libvirt.
&gt;&gt;
&gt;&gt; Everything is fine but, in some cases I need to call lookupByName().
&gt;&gt; There are a lot of times when the name will not exist, I trap the
&gt;&gt; exception, however I still get this message printed to stderr:
&gt;&gt;
&gt;&gt; libvir: QEMU error : Domain not found: no domain with matching name
&gt;&gt; 'foo'
&gt;&gt;
&gt;&gt; Is there any way to turn this off?   This is a command-line program so
&gt;&gt; the extra output makes the interface confusing.
&gt;&gt;
&gt;&gt; I've tried re-assigning sys.stderr before calling lookupByName(), but
&gt;&gt; that doesn't seem to have any affect.
&gt;&gt;
&gt;
&gt; actually there is a bug for this problem, it should be warning, but not
&gt; error, and will be fixed upstream soon.
&gt;
&gt; - Osier
&gt;

Really? Why should this be a warning? When virDomainLookupByName()
fails because there is no domain with the given name then we need to
report an error. I don't see what could be changed there.

Albert, libvirt's default error handler prints to stderr, you can
override it like this:

    import libvirt

    def errorHandler(ctx, err):
        pass

    libvirt.registerErrorHandler(errorHandler, None)

Matthias

</body></email><email><emailId>20101213080121</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2010-12-13 08:01:21-0400</timestampReceived><subject>Re: [libvirt-users] libvirt printing to stderr</subject><body>

 20101213 15:47, Matthias Bolte :
&gt; 2010/12/13 Osier Yang&lt;jyang@redhat.com&gt;:
&gt;&gt;  20101213 13:43, Albert Hopkins :
&gt;&gt;&gt;
&gt;&gt;&gt; I'm writing an app and using the Python bindings for libvirt.
&gt;&gt;&gt;
&gt;&gt;&gt; Everything is fine but, in some cases I need to call lookupByName().
&gt;&gt;&gt; There are a lot of times when the name will not exist, I trap the
&gt;&gt;&gt; exception, however I still get this message printed to stderr:
&gt;&gt;&gt;
&gt;&gt;&gt; libvir: QEMU error : Domain not found: no domain with matching name
&gt;&gt;&gt; 'foo'
&gt;&gt;&gt;
&gt;&gt;&gt; Is there any way to turn this off?  This is a command-line program so
&gt;&gt;&gt; the extra output makes the interface confusing.
&gt;&gt;&gt;
&gt;&gt;&gt; I've tried re-assigning sys.stderr before calling lookupByName(), but
&gt;&gt;&gt; that doesn't seem to have any affect.
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt; actually there is a bug for this problem, it should be warning, but not
&gt;&gt; error, and will be fixed upstream soon.
&gt;&gt;
&gt;&gt; - Osier
&gt;&gt;
&gt;
&gt; Really? Why should this be a warning? When virDomainLookupByName()
&gt; fails because there is no domain with the given name then we need to
&gt; report an error. I don't see what could be changed there.
&gt;
ah, yeah, didn't read the message carefully, confused it with a
storage volume lookup API. :-)

- Osier

</body></email><email><emailId>20101213031817</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2010-12-13 03:18:17-0400</timestampReceived><subject>Re: [libvirt-users] LXC Live Migration possible?</subject><body>

 20101212 01:33, Dan Ldtke :
&gt; Hallo everyone,
&gt;
&gt; in March 2010 there was a discussion[1] about live migration of LXC
&gt; Containers using libvirt. I was just wondering if there are any updates
&gt; to this?
&gt;

As I known, not yet..

- Osier

</body></email><email><emailId>20101205060903</emailId><senderName></senderName><senderEmail>wbinglee@gmail.com</senderEmail><timestampReceived>2010-12-05 06:09:03-0400</timestampReceived><subject>Re: [libvirt-users] How to set image format to 'qcow2'</subject><body>

Try this:

&lt;disk type="file" device="disk"&gt;
    &lt;driver name="qemu" type="qcow2"/&gt;
    &lt;source file='/home/eucalyptus/imgs/xp.img'/&gt;
    &lt;target dev="hda" bus="ide" /&gt;
&lt;/disk&gt;



On Sun, Dec 5, 2010 at 1:12 PM,  &lt;jxd431@gmail.com&gt; wrote:

&gt; 
&gt; Hi, all
&gt; 
&gt; My xml 'dom1.xml' is as following:
&gt; &lt;domain type='kvm' id='1'&gt;
&gt; &lt;name&gt;kvm-xp&lt;/name&gt;
&gt; &lt;description&gt;xp kvm&lt;/description&gt;
&gt; &lt;memory&gt;524288&lt;/memory&gt;
&gt; &lt;currentMemory&gt;524288&lt;/currentMemory&gt;
&gt; &lt;os&gt;
&gt; &lt;type&gt;hvm&lt;/type&gt;
&gt; &lt;!--loader&gt;/usr/lib/xen/boot/hvmloader&lt;/loader--&gt;
&gt; &lt;boot dev="hd"/&gt;
&gt; &lt;/os&gt;
&gt; &lt;devices&gt;
&gt; &lt;disk type='file'&gt;
&gt; &lt;source file='/home/eucalyptus/imgs/xp.img'/&gt;
&gt; &lt;target dev='hda' bus='ide'/&gt;
&gt; &lt;/disk&gt;
&gt; &lt;driver name='qemu' type='qcow2'/&gt;
&gt; &lt;!--graphics type="sdl" display=':0.0'/--&gt;
&gt; &lt;!--graphics type="desktop" fullscreen='yes'/--&gt;
&gt; &lt;graphics type='vnc' port='5904'/&gt;
&gt; &lt;/devices&gt;
&gt; &lt;/domain&gt;
&gt; 
&gt; In this xml file, I don't know how to set disk file format to 'qcow2'.
&gt; When I create domain using this command:
&gt; virsh create dom1.xml
&gt; 
&gt; I cannot boot the image file. The log file
&gt; /var/log/libvirt/qemu/kvm-xp.log is as following:
&gt; 
&gt; LC_ALL=C
&gt; 
&gt; PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/sbin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/bin:/usr/x86_64-pc-linux-gnu/gcc-bin/4.4.3
&gt;  HOME=/root USER=root QEMU_AUDIO_DRV=none /usr/bin/kvm -S -M pc -m 512
&gt; -smp 1 -name kvm-xp -uuid a8cbae31-59a0-0bc5-4416-65ba63aa4231 -monitor
&gt; unix:/var/lib/libvirt/qemu/kvm-xp.monitor,server,nowait -no-acpi -boot c
&gt; -drive file=/home/eucalyptus/imgs/xp.img,if=ide,bus=0,unit=0,format=raw
&gt; -net none -serial none -parallel none -usb -vnc 127.0.0.1:4 -vga cirrus
&gt; -balloon virtio
&gt; 
&gt; I don't know how to set format argument to 'qcow2'
&gt; 
&gt; ----------------
&gt; Xiaodong Jiang
&gt; jxd431@gmail.com
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; 


[Attachment #3 (text/html)]

Try this:&lt;br&gt;&lt;br&gt;&lt;disk type="file" device="disk"&gt;&lt;br&gt;       \
&lt;driver name="qemu" type="qcow2"/&gt;&lt;br&gt;       &lt;source \
file='/home/eucalyptus/imgs/xp.img'/&gt;&lt;br&gt;       &lt;target \
dev="hda" bus="ide" /&gt;&lt;br&gt; &lt;/disk&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;On Sun, Dec 5, 2010 at 1:12 PM,  &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:jxd431@gmail.com"&gt;jxd431@gmail.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, \
204, 204); padding-left: 1ex;"&gt; &lt;br&gt;
Hi, all&lt;br&gt;
&lt;br&gt;
My xml 'dom1.xml' is as following:&lt;br&gt;
&lt;domain type='kvm' id='1'&gt;&lt;br&gt;
&lt;name&gt;kvm-xp&lt;/name&gt;&lt;br&gt;
&lt;description&gt;xp kvm&lt;/description&gt;&lt;br&gt;
&lt;memory&gt;524288&lt;/memory&gt;&lt;br&gt;
&lt;currentMemory&gt;524288&lt;/currentMemory&gt;&lt;br&gt;
&lt;os&gt;&lt;br&gt;
&lt;type&gt;hvm&lt;/type&gt;&lt;br&gt;
&lt;!--loader&gt;/usr/lib/xen/boot/hvmloader&lt;/loader--&gt;&lt;br&gt;
&lt;boot dev="hd"/&gt;&lt;br&gt;
&lt;/os&gt;&lt;br&gt;
&lt;devices&gt;&lt;br&gt;
&lt;disk type='file'&gt;&lt;br&gt;
&lt;source file='/home/eucalyptus/imgs/xp.img'/&gt;&lt;br&gt;
&lt;target dev='hda' bus='ide'/&gt;&lt;br&gt;
&lt;/disk&gt;&lt;br&gt;
&lt;driver name='qemu' type='qcow2'/&gt;&lt;br&gt;
&lt;!--graphics type="sdl" display=':0.0'/--&gt;&lt;br&gt;
&lt;!--graphics type="desktop" fullscreen='yes'/--&gt;&lt;br&gt;
&lt;graphics type='vnc' port='5904'/&gt;&lt;br&gt;
&lt;/devices&gt;&lt;br&gt;
&lt;/domain&gt;&lt;br&gt;
&lt;br&gt;
In this xml file, I don't know how to set disk file format to \
'qcow2'.&lt;br&gt; When I create domain using this command:&lt;br&gt;
virsh create dom1.xml&lt;br&gt;
&lt;br&gt;
I cannot boot the image file. The log file&lt;br&gt;
/var/log/libvirt/qemu/kvm-xp.log is as following:&lt;br&gt;
&lt;br&gt;
LC_ALL=C&lt;br&gt;
PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/sbin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/bin:/usr/x86_64-pc-linux-gnu/gcc-bin/4.4.3&lt;br&gt;
 HOME=/root USER=root QEMU_AUDIO_DRV=none /usr/bin/kvm -S -M pc -m 512&lt;br&gt;
-smp 1 -name kvm-xp -uuid a8cbae31-59a0-0bc5-4416-65ba63aa4231 -monitor&lt;br&gt;
unix:/var/lib/libvirt/qemu/kvm-xp.monitor,server,nowait -no-acpi -boot c&lt;br&gt;
-drive file=/home/eucalyptus/imgs/xp.img,if=ide,bus=0,unit=0,format=raw&lt;br&gt;
-net none -serial none -parallel none -usb -vnc &lt;a href="http://127.0.0.1:4" \
                target="_blank"&gt;127.0.0.1:4&lt;/a&gt; -vga cirrus&lt;br&gt;
-balloon virtio&lt;br&gt;
&lt;br&gt;
I don't know how to set format argument to 'qcow2'&lt;br&gt;
&lt;br&gt;
----------------&lt;br&gt;
Xiaodong Jiang&lt;br&gt;
&lt;a href="mailto:jxd431@gmail.com"&gt;jxd431@gmail.com&lt;/a&gt;&lt;br&gt;
&lt;br&gt;
_______________________________________________&lt;br&gt;
libvirt-users mailing list&lt;br&gt;
&lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
&lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; \
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20101206211158</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-12-06 21:11:58-0400</timestampReceived><subject>Re: [libvirt-users] Create VMWare ESXi domain via virsh error(error: this function is not supported </subject><body>

See, my response on the libvirt-list to your equivalent email send there:

https://www.redhat.com/archives/libvir-list/2010-December/msg00314.html

Matthias

2010/11/30 mop amg &lt;amghostman@gmail.com&gt;:
&gt; Hi, Dear Mr/Mrs.
&gt; I have two questions ask for help:
&gt; my virt-manager and libvirt version is :
&gt; linux-vaan:~ # rpm -q libvirt
&gt; libvirt-0.8.5-1.2.i586
&gt; linux-vaan:~ # uname -a
&gt; Linux linux-vaan 2.6.34-12-desktop #1 SMP PREEMPT 2010-06-29 02:39:08 +0200
&gt; i686 i386 GNU/Linux
&gt; linux-vaan:~ # rpm -q virt-manager
&gt; virt-manager-0.8.5-3.1.i586
&gt; linux-vaan:~ # cat /etc/SuSE-release
&gt; openSUSE 11.3 (i586)
&gt; VERSION = 11.3
&gt;
&gt; virsh # version
&gt; Compiled against library: libvir 0.8.5
&gt; Using library: libvir 0.8.5
&gt; Using API: ESX 0.8.5
&gt; Running hypervisor: ESX 4.1.0
&gt;
&gt;
&gt; question 1 :
&gt; When I try to create a vmware esxi domain from virsh like this :
&gt;        create --file /work/dom1.x
&gt;  there is a  error message :
&gt;        error: Failed to create domain from /work/dom1.xml
&gt;        error: this function is not supported by the connection driver:
&gt; virDomainCreateXML
&gt; it seems dosen't support create esxi domain, but the
&gt; http://libvirt.org/hvsupport.html show that is supported after  0.7.0
&gt;
&gt; or create via virt-install
&gt;
&gt;           linux-vaan:~ # virt-install
&gt; --connect=esx://root@192.168.8.162/?no_verify=1 -n rhel5 -r 512 --vcpus=1
&gt; --nodisks bridge=vmk0 --network bridge=vmk0 --pxe
&gt;
&gt;           Enter root's password for 192.168.8.162:
&gt;
&gt;
&gt;
&gt;           Starting install...
&gt;
&gt;           ERROR    this function is not supported by the connection driver:
&gt; virDomainCreateXML
&gt;
&gt; how to  fix it ?
&gt;
&gt; dom1.xml
&gt; &lt;domain type='vmware'&gt;
&gt;   &lt;name&gt;dom1&lt;/name&gt;
&gt;   &lt;memory&gt;524288&lt;/memory&gt;
&gt;   &lt;currentMemory&gt;524288&lt;/currentMemory&gt;
&gt;   &lt;vcpu&gt;1&lt;/vcpu&gt;
&gt;   &lt;os&gt;
&gt;     &lt;type arch='i686'&gt;hvm&lt;/type&gt;
&gt;   &lt;/os&gt;
&gt;   &lt;clock offset='utc'/&gt;
&gt;   &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
&gt;   &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
&gt;   &lt;on_crash&gt;destroy&lt;/on_crash&gt;
&gt;   &lt;devices&gt;
&gt;     &lt;disk type='file' device='disk'&gt;
&gt;       &lt;source file='[datastore1] rhel5/rhel5_2.vmdk'/&gt;
&gt;       &lt;target dev='sda' bus='scsi'/&gt;
&gt;       &lt;address type='drive' controller='0' bus='0' unit='0'/&gt;
&gt;     &lt;/disk&gt;
&gt;     &lt;controller type='scsi' index='0' model='lsilogic'/&gt;
&gt;     &lt;interface type='bridge'&gt;
&gt;       &lt;mac address='00:0c:29:51:f1:1c'/&gt;
&gt;       &lt;source bridge='VM Network'/&gt;
&gt;     &lt;/interface&gt;
&gt;   &lt;/devices&gt;
&gt; &lt;/domain&gt;
&gt; question 2:
&gt; vol-clone failed
&gt;
&gt; virsh # vol-clone --pool datastore1 rhel5/rhel5.vmdk rhel5/rhel5_2.vmdk
&gt;
&gt; error: Failed to clone vol from rhel5/rhel5.vmdk
&gt;
&gt; error: this function is not supported by the connection driver:
&gt; virStorageVolCreateXMLFrom
&gt;
&gt; thanks for help!
&gt;
&gt; best regards!
&gt;
&gt;
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

</body></email><email><emailId>20101212035657</emailId><senderName>Albert Hopkins</senderName><senderEmail>marduk@letterboxes.org</senderEmail><timestampReceived>2010-12-12 03:56:57-0400</timestampReceived><subject>[libvirt-users] error: Failed to disconnect from the hypervisor, 1 leaked reference(s)</subject><body>

I've been getting this error ever since upgrading to libvirt 0.8.6.  It
happens when i use "virsh console &lt;domain&gt;" and then manually shut down
from within the virtual serial console.

Is anyone else experiencing this?

-a


</body></email><email><emailId>20101213022925</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2010-12-13 02:29:25-0400</timestampReceived><subject>[libvirt-users] ANNOUNCE: ruby-libvirt bindings 0.3.0</subject><body>

All,
     I'm pleased to announce the release of 0.3.0 of the ruby-libvirt bindings.
This release has a number of updates:

 * Implementation of Libvirt::open_auth, Libvirt::event_register_impl
 * Updated Connect class, implementing conn.compare_cpu, conn.baseline_cpu,
   conn.domain_event_register_any, conn.domain_event_deregister_any,
   conn.domain_event_register, conn.domain_event_deregister, and
   conn.create_domain_xml.
 * Updated Domain class, implementing dom.get_vcpus, dom.update_device,
   dom.scheduler_type, dom.scheduler_parameters, dom.scheduler_parameters=,
   dom.num_vcpus, dom.vcpus_flags=, and dom.qemu_monitor_command.
 * Updated Interface class, implementing interface.free
 * Many potential memory leaks have been fixed.
 * Many bugfixes.
 * Documentation update of many methods, including all of the lookup methods
   that were missing before.

With the above list, almost all of the APIs up to and including libvirt 0.8.6
are covered.  There are a few that I have not yet had time to implement; you
can look at the list in the README file in the source tree to see which ones
are missing.

The tarballs and source RPMs are here: http://libvirt.org/ruby/download/
The git repository is here: http://libvirt.org/git/?p=ruby-libvirt.git;a=summary
The documentation for all of the APIs are here: http://libvirt.org/ruby/api/index.html
I've uploaded some examples on how to use the bindings:
http://libvirt.org/ruby/documentation.html
I've also pushed a new gem to rubygems.org; you should be able to use
'gem install ruby-libvirt' (if you haven't installed them before) or
'gem update ruby-libvirt' (if you have them installed already).

If you have time, and are interested in the bindings, please give these new
ones a whirl and let me know if they work for you.  Note that release 0.3.0
is intended to be fully backwards compatible with release 0.2.0 and 0.1.0.
If you find that they are not, or find any other problems with the ruby
bindings, please report it to the libvirt development mailing list
(and CC me) so that I can take a look at them.

Thanks,
-- 
Chris Lalancette

</body></email><email><emailId>20101213103122</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-12-13 10:31:22-0400</timestampReceived><subject>Re: [libvirt-users] LXC Live Migration possible?</subject><body>

On Sat, Dec 11, 2010 at 06:33:51PM +0100, Dan Ldtke wrote:
&gt; Hallo everyone,
&gt; 
&gt; in March 2010 there was a discussion[1] about live migration of LXC
&gt; Containers using libvirt. I was just wondering if there are any updates
&gt; to this?

Nope, and I wouldn't expect it to arrive anytime in the forseeable
future. The kernel work is still outstanding &amp; there is plenty of
work needed for it to be reliable for arbitrary applications. You
are better off using machine virtualization like KVM if you need
migration.

Daniel

</body></email><email><emailId>20101213132743</emailId><senderName>Albert Hopkins</senderName><senderEmail>marduk@letterboxes.org</senderEmail><timestampReceived>2010-12-13 13:27:43-0400</timestampReceived><subject>Re: [libvirt-users] libvirt printing to stderr</subject><body>

On Mon, 2010-12-13 at 08:47 +0100, Matthias Bolte wrote:
&gt; Albert, libvirt's default error handler prints to stderr, you can
&gt; override it like this:
&gt; 
&gt;     import libvirt
&gt; 
&gt;     def errorHandler(ctx, err):
&gt;         pass
&gt; 
&gt;     libvirt.registerErrorHandler(errorHandler, None)
&gt; 
&gt; Matthias
&gt; 

Oh, thanks (now I that I know where to look i see it in the docs).

Thanks again,
-albert


</body></email><email><emailId>20101213223808</emailId><senderName>Scott Baker</senderName><senderEmail>bakers@canbytel.com</senderEmail><timestampReceived>2010-12-13 22:38:08-0400</timestampReceived><subject>[libvirt-users] Best filesystem/nfs options for shared storage?</subject><body>

Is there a guide, or some suggestions for what filesystem to use for VM 
storage? I chose the standard ext3 on CentOS but I'm wondering if it 
makes more sense to look at ext4 or XFS for performance reasons? Does 
anyone tweak the ext3 journaling options for libvirt to speed things up?

What about NFS export/mount options? What do your fstab mount lines look 
like? Is there a better rsize/wsize than the default?

-- 
Scott Baker - Canby Telcom
System Administrator - RHCE - 503.266.8253

</body></email><email><emailId>20101213225804</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-12-13 22:58:04-0400</timestampReceived><subject>Re: [libvirt-users] Deploying libvirt with live migration</subject><body>

2010/12/13 David Ehle &lt;ehle@agni.phys.iit.edu&gt;:
&gt;
&gt;
&gt; On Mon, 13 Dec 2010, Matthias Bolte wrote:
&gt;
&gt;&gt; 2010/12/13 David Ehle &lt;ehle@agni.phys.iit.edu&gt;:
&gt;&gt;&gt;
&gt;&gt;&gt; Even if your not sharing /etc/libvirt, if you have migrated at least
&gt;&gt;&gt; once,
&gt;&gt;&gt; both systems see the VM's as available for starting/running so just not
&gt;&gt;&gt; sharing /etc/libvirt is not a solution to the problem/concern...
&gt;&gt;
&gt;&gt; Well, that depends on the flags you pass to the migrate command. The
&gt;&gt; default libvirt migration semantic is a bit unexpected as it leaves
&gt;&gt; the domain defined but in shutdown state on the source host and on the
&gt;&gt; destination host it's running as a transient guest. That's why I gave
&gt;&gt; it the --persistent --undefinesource flags to make it take it's config
&gt;&gt; with it.
&gt;
&gt; Thank you for explaining that - I usually use the gui admin tool so some of
&gt; the details I'm oblivious too.
&gt;&gt;
&gt;&gt;&gt; Ideally if you try to start a VM that is already running on a different
&gt;&gt;&gt; host
&gt;&gt;&gt; it should balk and you should get an (overridable) warning. (IMHO)
&gt;&gt;
&gt;&gt; There is ongoing work on a lock manager system for libvirt that shall
&gt;&gt; prevent two domains from using the same disk image at the same time.
&gt;&gt; That's not exactly what you're looking for but it's related.
&gt;
&gt; I think that would be more than sufficient ;)
&gt;
&gt; Is that project publicly accesible?   I might be interested in lending a hand
&gt; :)

Search the libvir-list (not the libvirt-users one) for "lock manager"
or "sync manager". This threads here are probably be a good starting
point to read about it:

https://www.redhat.com/archives/libvir-list/2010-August/msg00179.html
https://www.redhat.com/archives/libvir-list/2010-September/msg00167.html

Matthias

&gt; David.
&gt;&gt;
&gt;&gt; Matthias
&gt;&gt;
&gt;&gt;&gt; David.
&gt;&gt;&gt;
&gt;&gt;&gt; On Mon, 13 Dec 2010, Scott Baker wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; On 12/13/2010 02:28 PM, Matthias Bolte wrote:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Well don't share /etc/libvirt, there is no need to.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Just have the domain config on the host that currently executes the
&gt;&gt;&gt;&gt;&gt; domain and tell libvirt to migrate the persistent domain condif along
&gt;&gt;&gt;&gt;&gt; with the domain:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; virsh migrate --persistent --undefinesource vm1 qemu://virt2/system
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; I suppose that would work... but if Virt2 dies and I need to start its
&gt;&gt;&gt;&gt; VMs
&gt;&gt;&gt;&gt; on Virt1 those XML configs won't be there and it will make it more
&gt;&gt;&gt;&gt; complicated.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Not just a simple "virsh start Foobar"
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; --
&gt;&gt;&gt;&gt; Scott Baker - Canby Telcom
&gt;&gt;&gt;&gt; System Administrator - RHCE - 503.266.8253
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt;&gt; libvirt-users mailing list
&gt;&gt;&gt;&gt; libvirt-users@redhat.com
&gt;&gt;&gt;&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt;

</body></email><email><emailId>20101215124637</emailId><senderName></senderName><senderEmail>tony</senderEmail><timestampReceived>2010-12-15 12:46:37-0400</timestampReceived><subject>Re: [libvirt-users] KVM Virtualisation, Console output no longer working</subject><body>

&gt; On Wed, Dec 15, 2010 at 12:06:27PM -0000, tony@specialistdevelopment.com
&gt; wrote:
&gt;&gt; Hi,
&gt;&gt;
&gt;&gt; I used to use KVM for virtualisation and have now moved back to it, but
&gt;&gt; I
&gt;&gt; have a problem.
&gt;&gt;
&gt;&gt; When i used to install the guest machine with virt-install i used to use
&gt;&gt; the -x "extra args" part to set the console for the install and guest,
&gt;&gt; but
&gt;&gt; it no longer works.
&gt;&gt;
&gt;&gt; Here is the command i use:
&gt;&gt;
&gt;&gt; virt-install -n server01 -r 512 --os-variant=virtio26 -c /isos/c5u5.iso
&gt;&gt; --nographics --noautoconsole -f /storage/vm/server01 -s 5 bus=virtio -w
&gt;&gt; bridge:br0 -x "console=ttyS0 ks=http://www.domain.com/c5u5.cfg"
&gt;&gt; As you can see im setting the console to ttyS0, but then when i go to
&gt;&gt; connect to the console with:
&gt;
&gt; You are doing a CDROM based install. The kernel args for that are set
&gt; in the syslinux config file inside the ISO image and can't be overriden
&gt; using -x. The -x arg only works when doing a kernel+initrd install
&gt; (ie --location instead of --cdrom/-c)
&gt;
&gt; Daniel
&gt;

OK, still rather stuck, so i have created a directory with contents of the
DVD, now what do i need to do? I guess i need to get virt-install using
the initrd and vmlinuz from there? or is that wrong?

Kind Regards

Tony

</body></email><email><emailId>20101216121941</emailId><senderName>Igor Serebryany</senderName><senderEmail>igor47@moomers.org</senderEmail><timestampReceived>2010-12-16 12:19:41-0400</timestampReceived><subject>Re: [libvirt-users] busy loop in libvirtd (cpu usage 100%)</subject><body>


On Mon, Dec 06, 2010 at 11:11:08AM +0000, Daniel P. Berrange wrote:
&gt; This is the kind of problem you need to use GDB to diagnose. Install
&gt; the libvirt-debuginfo (or equivalent for non-Fedora),

This in itself was going to be a problem, because I hand-compiled
libvirt from source (even in debian squeeze I think the version of
libvirt is too old).

I attempted to convert the rpms for FC12 distributed on the libvirt site
into debian packages using alien. I'm surprised to report that this
appears to work -- the rpm binary is stable and everything is still
working.

I had to spend some time manually resolving library dependencies. Two
hacks:

1) I had to symlink libaudit.so.0 to libaudit.so.1 since .1 doesn't
exist on debian squeeze. I figured this was a difference in version
which would probably cause problems, but I'm not using audits anyway

2) I symlinked the python bindings into the python 2.6 package
directory, but it looks like 2.7 is not strictly required

I also had to install netcf-libs from rpm because no equivalent exists
on debian.

I've installed the debug symbols rpm package as well, so if I do see the
problem again I'll be able to gdb it. However it seems 0.8.6 doesn't
have whatever bug that was, because I haven't been able to reproduce it.

--Igor

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20101217032207</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2010-12-17 03:22:07-0400</timestampReceived><subject>Re: [libvirt-users] aio flag for KVM guests</subject><body>

 20101217 03:30, Rangababu Chakravarthula :
&gt; Hello,
&gt; We are using libvirt 0.8.3 to build KVM guests (KVM version is qemu-kvm
&gt; 0.12.5). I see kvm supports aio flag with either native or threads
&gt; option. Where in libvirt XML should we define aio option?
&gt;
&gt; Thanks in advance
&gt; Ranga
&gt;
&gt;
we have not supported it for qemu-kvm yet.

seems this patch was not ACKed.

- Osier
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20101217190351</emailId><senderName>Sharad Mishra</senderName><senderEmail>snmishra@us.ibm.com</senderEmail><timestampReceived>2010-12-17 19:03:51-0400</timestampReceived><subject>[libvirt-users] pool info is not updated until pool refresh is run.</subject><body>

Hi,

   Creating a volume does not update pool information until pool-refresh is
run. Here is an example  -

# virsh vol-create ShareStorage /tmp/vol.xml
Vol sm_disk.dsk created from /tmp/vol.xml

#  virsh pool-info ShareStorage
Name:           ShareStorage
UUID:           3ab7dbd5
State:          running
Capacity:       58.57 GB
Allocation:     4.91 GB
Available:      53.66 GB

# virsh vol-info /var/lib/libvirt/test/sm_disk.dsk
Name:           sm_disk.dsk
Type:           file
Capacity:       97.66 GB
Allocation:     95.47 MB

# virsh pool-refresh  ShareStorage
Pool ShareStorage refreshed

# virsh pool-info ShareStorage
Name:           ShareStorage
UUID:           3ab7dbd5
State:          running
Capacity:       58.57 GB
Allocation:     5.01 GB
Available:      53.57 GB


Why  pool-refresh is required to update pool-info?

Thanks,
Sharad Mishra
[Attachment #3 (text/html)]

&lt;html&gt;&lt;body&gt;
&lt;p&gt;Hi,&lt;br&gt;
&lt;br&gt;
   Creating a volume does not update pool information until pool-refresh is run. Here \
is an example  -&lt;br&gt; &lt;br&gt;
# virsh vol-create ShareStorage /tmp/vol.xml&lt;br&gt;
Vol sm_disk.dsk created from /tmp/vol.xml&lt;br&gt;
&lt;br&gt;
#  virsh pool-info ShareStorage&lt;br&gt;
Name:           ShareStorage&lt;br&gt;
UUID:           3ab7dbd5&lt;br&gt;
State:          running&lt;br&gt;
Capacity:       58.57 GB&lt;br&gt;
Allocation:     4.91 GB&lt;br&gt;
Available:      53.66 GB&lt;br&gt;
&lt;br&gt;
# virsh vol-info /var/lib/libvirt/test/sm_disk.dsk &lt;br&gt;
Name:           sm_disk.dsk&lt;br&gt;
Type:           file&lt;br&gt;
Capacity:       97.66 GB&lt;br&gt;
Allocation:     95.47 MB&lt;br&gt;
&lt;br&gt;
# virsh pool-refresh  ShareStorage &lt;br&gt;
Pool ShareStorage refreshed&lt;br&gt;
&lt;br&gt;
# virsh pool-info ShareStorage&lt;br&gt;
Name:           ShareStorage&lt;br&gt;
UUID:           3ab7dbd5&lt;br&gt;
State:          running&lt;br&gt;
Capacity:       58.57 GB&lt;br&gt;
Allocation:     5.01 GB&lt;br&gt;
Available:      53.57 GB&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Why  pool-refresh is required to update pool-info?&lt;br&gt;
&lt;br&gt;
Thanks,&lt;br&gt;
Sharad Mishra&lt;br&gt;
&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20101220015543</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2010-12-20 01:55:43-0400</timestampReceived><subject>Re: [libvirt-users] Problems Installing KVM Guest + Console Access</subject><body>

 20101217 18:54, tony@specialistdevelopment.com :
&gt; Hi,
&gt;
&gt; Im having real issues with getting a kvm guest up and running on CentOS 5.5
&gt;
&gt; I have expanded the iso to a path on my system as I have been told that
&gt; the -x (extra arguments) will not work with the -cdrom option, so I am now
&gt; using -location, but still the extra arguments are not being picked up.
&gt;
&gt; So what do I need to do to get a guest up and working with console access
&gt; to view the install as its driving me crazy.

At first, guess you are using virt-install.

Could you paste the DEBUG log here so that we could see if the
extra arguments were really not pciked up?

And do you have to use text console to view the installation
process, why not vnc? :-)

Regards
Osier

</body></email><email><emailId>20101220071913</emailId><senderName>Igor Serebryany</senderName><senderEmail>igor47@moomers.org</senderEmail><timestampReceived>2010-12-20 07:19:13-0400</timestampReceived><subject>Re: [libvirt-users] using virDomainMigrateSetMaxDowntime</subject><body>


On Mon, Dec 20, 2010 at 09:48:21AM +0800, Osier Yang wrote:
&gt; so yes, domain.migration will not return till it's finished.

the problem is not that domain.migration will not return till it's
finished. that makes perfect sense and is totally fine.

the problem is that i can't seem to do ANYTHING else with libvirt while
domain.migration is running, including getting a domain object i can
call domain.setmaxdowntime on or even manage other totally unrelated
vms.

i am trying to figure out if this is just me doing something wrong, or
if this is a problem/design decision inside libvirt.

--igor

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20101221094058</emailId><senderName>Jiri Denemark</senderName><senderEmail>jdenemar@redhat.com</senderEmail><timestampReceived>2010-12-21 09:40:58-0400</timestampReceived><subject>Re: [libvirt-users] Error creating a new vm</subject><body>

Hi Tony,

&gt; Well iv installed the default RPMS via Centos (5.5)

Hmm, than you should probably ask CentOS guys for help. They apparently left
RHEL's libvirt but made their own qemu package. Since libvirt 0.6.3 wasn't
very smart, it had to be modified to support machine types provided by RHEL's
qemu. Newer libvirt releases have automatic runtime detection of supported
machine types so they don't suffer this issue.

&gt; How do I get around this? Isnt that kind of weird that you an install a rhel
&gt; machine on what is essentially a rhel machine?

The OS you are trying to install inside a vm doesn't matter here. It's just an
issue of your host OS (which is not exactly RHEL).

To work around this, you basically have three options.

1. Do the install manually, that is download the images virt-install downloads
for you, take the XML generated by virt-install, add the "machine='pc'"
attribute in &lt;type&gt; element, define the XML using virsh define and start it
with virsh start.

2. Rename /usr/bin/qemu-system-x86_64 to /usr/bin/qemu-system-x86_64.orig,
create /usr/bin/qemu-system-x86_64 shell script, which executes
/usr/bin/qemu-system-x86_64.orig with -M pc instead of -M rhel5.4.0. Once you
have the machine installed, you can use virsh edit VM to change machine type
to 'pc' and then you can rename /usr/bin/qemu-system-x86_64.orig back to
/usr/bin/qemu-system-x86_64.

3. Install upstream virt-install and use its --machine as suggested by Cole.

Jirka

</body></email><email><emailId>20101221151804</emailId><senderName>Quint Van Deman</senderName><senderEmail>qvandeman@emergent360.com</senderEmail><timestampReceived>2010-12-21 15:18:04-0400</timestampReceived><subject>[libvirt-users] private DNS servers &amp; dnsmasq</subject><body>

Hello--

I'm trying to work through the last piece of the puzzle regarding dns
resolution for my guests.
To do so I'd like to be able to pass the following to the dnsmasq child
process:

-S /private.net/127.0.0.1 (as referenced in the dnsmasq man page)
-S /sub.private.net/127.0.0.1

However, I cannot find any documentation that suggests the xml schema
defining the virtual network supports this option.
Is there a way of doing this?

The ability to pass a '-q' (log queries) would be nice too for debugging
purposes.

My DNS setup is all working properly (as confirmed with dig &amp; server
overrides throughout the environment), but resolv.conf based resolution
isn't able to find servers for either of those two domains (dnsmasq is
trying to resolve them via an upstream server, which obviously fails).

Thanks for any advice.

-Quint

[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 TRANSITIONAL//EN"&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
  &lt;META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=UTF-8"&gt;
  &lt;META NAME="GENERATOR" CONTENT="GtkHTML/3.28.3"&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
Hello--&lt;BR&gt;
&lt;BR&gt;
I'm trying to work through the last piece of the puzzle regarding dns resolution for \
my guests.&lt;BR&gt; To do so I'd like to be able to pass the following to the dnsmasq \
child process:&lt;BR&gt; &lt;BR&gt;
-S /private.net/127.0.0.1 (as referenced in the dnsmasq man page)&lt;BR&gt;
-S /sub.private.net/127.0.0.1&lt;BR&gt;
&lt;BR&gt;
However, I cannot find any documentation that suggests the xml schema defining the \
virtual network supports this option.&lt;BR&gt; Is there a way of doing this?&lt;BR&gt;
&lt;BR&gt;
The ability to pass a '-q' (log queries) would be nice too for debugging \
purposes.&lt;BR&gt; &lt;BR&gt;
My DNS setup is all working properly (as confirmed with dig &amp; server overrides \
throughout the environment), but resolv.conf based resolution isn't able to find \
servers for either of those two domains (dnsmasq is trying to resolve them via an \
upstream server, which obviously fails).&lt;BR&gt; &lt;BR&gt;
Thanks for any advice.&lt;BR&gt;
&lt;BR&gt;
-Quint
&lt;/BODY&gt;
&lt;/HTML&gt;



</body></email><email><emailId>20101221172643</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-12-21 17:26:43-0400</timestampReceived><subject>Re: [libvirt-users] Anyone interested in forming a libvirt "docs" team?</subject><body>

On 22/12/2010, at 3:23 AM, Scott Baker wrote:
&gt; On 12/21/2010 03:15 AM, Anthony Davis wrote:
&gt;&gt; Hi Justin,
&gt;&gt; 
&gt;&gt; I can offer some free time:)
&gt; 
&gt; I'd be willing to contribute to a wiki if we had the docs in a wiki.

Yeah I know what you mean.  Wiki's are *so* much easier to work with and revise, compared
to having to code in html then submit diffs as patches.

At the moment, the "main" libvirt docs are written in html and included with each release tarball.

It makes sure everyone who downloads the tarball has a copy, but it doesn't make them easy
to edit. :/

Some of the things that need documenting though, are definitely able to be written up into
a wiki first to get them into shape.  We could then move the things that are "finished" in the
wiki to the main tarball (after converting to html).

I personally do similar to this anyway for lots of things, as I find getting info onto a wiki first
allows me to refine, refine, refine, until I'm happy with it.  Then it can go anywhere.

This is the first tentative Docs Team To Do list page (on the wiki even), just whipped up
using the contents of a reply to Anthony:

  http://wiki.libvirt.org/page/DocsToDo

Stuff that I reckon would be suitable for writing on the wiki generally fall into the second and
third categories there, of things that need either some OS level knowledge (for investigating
non Fedora-RHEL paths), or for writing up concepts around Storage, Networking, or similar.

You up for it? :)

Regards and best wishes,

Justin Clift

</body></email><email><emailId>20101223015736</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2010-12-23 01:57:36-0400</timestampReceived><subject>Re: [libvirt-users] ICMP into guest not "working"</subject><body>

On 12/22/2010 04:02 PM, David Lane wrote:
&gt; Good afternoon.
&gt;
&gt; I have a RHEL6 host, running RHEL 3.8 as a guest.  The NIC is 
&gt; bridged.  From the guest, I can ping successfully to a variety of 
&gt; network devices.  From the host, I can ping successfully to a variety 
&gt; of network devices AND the guest OS.  But from my workstation, I can 
&gt; only ping the HOST, not the guest.  And it looks like the packets are 
&gt; being discarded.
&gt;
&gt; IPtables is NOT enabled on either the guest or the host (our 
&gt; application does not support iptables filtering - go figure).
&gt;
&gt; I am seeing lots of documentation for enabling outbound pings from 
&gt; guest, but very little about enabling inbound pings.  And again, our 
&gt; software relies on pings for parts of its operations and validations.
&gt;
&gt; Any clues as to what I might have missed?

Just a long shot - what does "sysctl net.bridge.bridge-nf-call-iptables" 
on the host show? If it's set to 1, try setting it to 0. Alternately, 
you can make sure the following rule is in iptables:

    iptables -A FORWARD -m physdev --physdev-is-bridged -j ACCEPT

(I'm thinking this shouldn't matter, as I had thought having it wrong 
would prevent *outbound* connections as well, but it's worth looking at).

BTW, is it just icmp that isn't allowed incoming, or does ssh (for 
example) also not get in?

Have you run wireshark on the bridge interface, or on the host tap 
interface connecting the guest to the bridge? That might give you more 
clues as to where it's getting lost.

</body></email><email><emailId>20101223225137</emailId><senderName>Steven Ellis</senderName><senderEmail>mail_lists@stevencherie.net</senderEmail><timestampReceived>2010-12-23 22:51:37-0400</timestampReceived><subject>[libvirt-users] Mapping partitions rather than disks into a Libvirt managed KVM guest</subject><body>


I'm trying to migrate some XEN based environments over to KVM and I'm
having a couple of issues with how I'm currently managing the
storage  

On my Xen Server I have a bunch of LVM based partitions that are mapped
into the guests as partitions rather than disks  

For example  

 /dev/VIrtVG/server-home maps to /dev/sda2 which is mounted as /home in the
guest.  

Is there a simple way to reproduce this using KVM and libvirt rather than
needing enough spare space to turn each of these partitions into virtual
disks.  

One method I've tried is using mdadm with linear to create a partition
table stub but i'm a little worries about data integrity.  

 dd if=/dev/zero of=/root/dummy.mbr count=256  

 losetup -f /root/dummy.mbr   

 mdadm --build --verbose /dev/md0 --chunk=128 --level=linear
--raid-devices=2 /dev/loop0 /dev/VIrtVG/server-home  

Then try to setup a partition table with fdisk.  

Any other recommendations?   

Thanks

 Steve  


</body></email><email><emailId>20101228234153</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-12-28 23:41:53-0400</timestampReceived><subject>Re: [libvirt-users] VMware ESX 4.0 won't reboot guests.</subject><body>

2010/12/28 Patric Falinder &lt;patric.falinder@omg.nu&gt;:
&gt; Hi,
&gt;
&gt; I just compiled libvirt with ESX support. I can login just fine, list all
&gt; the guests/domains but when I try to reboot or shutdown one of my
&gt; guests/domains I get this error:
&gt;
&gt; virsh # reboot dbcluster1
&gt; error: Failed to reboot domain dbcluster1
&gt; error: internal error HTTP response code 500 for call to 'RebootGuest'.
&gt; Fault: ServerFaultCode - fault.RestrictedVersion.summary

RestrictedVersion is the relevant word here and the problem is on the
server side and not in libvirt itself.

&gt; And nothing happens.
&gt; I'm logged in as root so it shouldn't be any permission-related problems
&gt; right!? because I can reboot it just fine with the vSpehere Client on one of
&gt; my Windows boxes.

I guess you're actually using an ESXi 4.0 server and it's license has
expired. In that case the ESXi server is in "free" mode and it's
management API (the vSphere API) can only be used in read-only mode.

libvirt uses the vSphere API to manage the ESX(i) server. When the
vSphere API is in read-only mode libvirt can still list guest and
output information about them. It can also still define new guests and
create new storage volumes, but it cannot start or reboot guests as
the ESX(i) server rejects this with a RestrictedVersion fault.

You can reboot a guest using the vSphere Client even in free/read-only
mode because VMware designed it to be that way.

A newly installed ESX(i) server comes with a 60 days full featured
evaluation license that also enables full vSphere API access. After 60
days of usage the license expires and the ESX(i) server goes into
free/read-only mode and the vSphere Client is the only tool that can
start or reboot guest in this mode.

You can find additional details in the VMware blog post:
http://blogs.vmware.com/esxi/2009/06/esxi-vs-esx-a-comparison-of-features.html

Matthias

</body></email><email><emailId>20101229230612</emailId><senderName>Igor Serebryany</senderName><senderEmail>igor47@moomers.org</senderEmail><timestampReceived>2010-12-29 23:06:12-0400</timestampReceived><subject>Re: [libvirt-users] libvirt unavailable while a VM is in migration?]</subject><body>


I've opened a bug to track this issue:
https://bugzilla.redhat.com/show_bug.cgi?id=666266

I have tried to work around the issue by making my migrations non-live,
hoping that the shorter downtime will make this less of a big deal. But
migrating busy domains with lots of RAM still takes a surprisingly long
time even if the domain is paused during migration -- something I did
not expect.

For instance, a domain with 8 GB of ram migrating over a gigabit network
takes about 20 seconds if the domain is idle and not using much ram.
However, if I start a run of 'stress' inside the VM which uses 6 gigs of
RAM in random malloc/free calls, the same domain might take 20 minutes
to migrate. 

Has anyone else experienced this? Is there some kind of compression
going on when doing tunneled migrations which breaks down when the pages
are dirty?

--Igor

On Thu, Dec 23, 2010 at 06:13:35AM +1100, Justin Clift wrote:
&gt; On 23/12/2010, at 5:44 AM, Igor Serebryany wrote:
&gt; &gt; On Mon, Dec 20, 2010 at 02:14:42PM +0100, Jiri Denemark wrote:
&gt; &gt;&gt; Ouch, I wonder if that could be the reason...
&gt; &gt; 
&gt; &gt; Just to make sure that my strange compiling/packages aren't causing the
&gt; &gt; problem, I've set up two servers running fedora 14 with the official
&gt; &gt; libvirt packages. i experience the same problem -- while a vm is in
&gt; &gt; migration, nothing else works. my traces reveal libvirt getting stuck at
&gt; &gt; the same exact spot as on my debian machines.
&gt; 
&gt; This sounded familiar, so went looking in git history.  I *think* this is
&gt; what was sounding familiar, from ~ libvirt 0.8.2:
&gt; 
&gt; commit 755b53f946107539ba6faf3022450b3d0bbe1d78
&gt; Author: Daniel P. Berrange &lt;berrange@redhat.com&gt;
&gt; Date:   Thu Jun 24 19:15:27 2010 +0100
&gt; 
&gt;     Avoid blocking all APIs during incoming migration
&gt;    
&gt;     During incoming migration the QEMU monitor is not able to be
&gt;     used. The incoming migration code did not keep hold of the
&gt;     job lock because migration is split across multiple API calls.
&gt;     This meant that further monitor commands on the guest would
&gt;     hang until migration finished with no timeout.
&gt;    
&gt;     In this change the qemuDomainMigratePrepare method sets the
&gt;     job flag just before it returns. The qemuDomainMigrateFinish
&gt;     method checks for this job flag &amp; clears it once done. This
&gt;     prevents any use of the monitor between prepare+finish steps.
&gt;    
&gt;     The qemuDomainGetJobInfo method is also updated to refresh
&gt;     the job elapsed time. This means that virsh domjobinfo can
&gt;     return time data during incoming migration
&gt;    
&gt;     * src/qemu/qemu_driver.c: Keep a job active during incoming
&gt;       migration. Refresh job elapsed time when returning job info
&gt; 
&gt; Anyone know if this is actually relevant?
&gt; 
&gt; 
&gt; &gt; i am desperate to get this bug fixed, and i don't think i have the
&gt; &gt; resources to try to patch it myself. is there anything i can do to help
&gt; &gt; you guys? more debugging info? foot massage?
&gt; 
&gt; Good idea.  Foot massages would definitely be an incentive I
&gt; could be convinced with. :)
&gt; 
&gt; (it would probably help if I was the right kind of coder for this,
&gt; but I'm not)

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20101231152629</emailId><senderName></senderName><senderEmail>saint</senderEmail><timestampReceived>2010-12-31 15:26:29-0400</timestampReceived><subject>[libvirt-users] livemigrate problems</subject><body>

hello everybody and happy new year!

I am a newbie in libvirt use, and I use it mostrly throught OpenNebula.

Anyway, I  noticed that  one of the  nodes can be  a destination  of a
livemigrate but not the source.

This is the environment:

4  blades nicknamed(*)  red3, red9,  red10, red11,  each with  8 Intel
E5506 cores (@ 2.13GHz) running CentOS 5 and KVM as hyoervisor.

(*) these are names I put in /etc/hosts, the DNS knows them this way

Nickname  	 DNS name
--------     -----------
red3		 itpsmenc038
red9		 itpsmenc044
red10		 itpsmenc045
red11		 itpsmenc046

I can  livemigrate w/o problems between  any two from red9,  red10 and
red11, I can livemigrate from either  red9, red10 or red11 to red3 but
I can't livemigrate to any other blade from red3.

I took the dump of the log on red9 for a failing action [see after the
signature], and I think that this is the "error message":

17:07:55.891: debug : virDomainMigrateFinish2:3119 : dconn=0xe60c3a0, dname=one-66, \
cookie=(nil), cookielen=0, uri=tcp:itpsmenc044.engicloud.psmidc.com:49152, flags=1, \
retcode=-1 17:07:55.891: debug : qemudShutdownVMDaemon:1684 : Shutting down VM \
'one-66'

Since the other nodes work, where could I have misconfigured red3 ? Any hint ?

BTW, I can connect from red3 to red9:

[root@itpsmenc038 ~]# virsh -c qemu://red9/system
Welcome to virsh, the virtualization interactive terminal.

Type:  'help' for help with commands
       'quit' to quit

virsh # list --all
 Id Name                 State
----------------------------------
  2 one-65               running

(one-65 has just livemigrated to red9 from red11 for this command :) )

Thank you in advance and again, Happy New Year!

--
ing. Gian Uberto Lauri
Ricercatore / Reasearcher
Divisione Ricerca ed Innovazione / Research &amp; Innovation Division
GianUberto.Lauri@eng.it

Engineering Ingegneria Informatica spa
Corso Stati Uniti 23/C, 35127 Padova (PD) 

Tel. +39-049.8283.538         | main(){printf(&amp;unix["\021%six\012\0"], 
Fax  +39-049.8283.569		  |    (unix)["have"]+"fun"-0x60);}   
Skype: gian.uberto.lauri	  |          David Korn, AT&amp;T Bell Labs             
http://www.eng.it 			  |          ioccc best One Liner, 1987             




------------------------------8&lt;----------------------------
17:07:54.801: debug : virEventRunOnce:566 : Poll got 1 event
17:07:54.801: debug : virEventDispatchHandles:449 : Dispatch n=6 f=12 w=7 e=1 \
0xe5b25f0 17:07:54.802: debug : virEventAddHandleImpl:111 : Add handle 14 1 0x4103e0 \
0xe5b25f0 17:07:54.802: debug : virEventInterruptLocked:635 : Skip interrupt, 1 \
-793020736 17:07:54.802: debug : virEventMakePollFDs:364 : Prepare n=0 w=1, f=5 e=1
17:07:54.802: debug : virEventMakePollFDs:364 : Prepare n=1 w=2, f=8 e=0
17:07:54.802: debug : virEventMakePollFDs:364 : Prepare n=2 w=3, f=8 e=1
17:07:54.802: debug : virEventMakePollFDs:364 : Prepare n=3 w=4, f=3 e=1
17:07:54.802: debug : virEventMakePollFDs:364 : Prepare n=4 w=5, f=9 e=25
17:07:54.802: debug : virEventMakePollFDs:364 : Prepare n=5 w=6, f=10 e=25
17:07:54.802: debug : virEventMakePollFDs:364 : Prepare n=6 w=7, f=12 e=25
17:07:54.802: debug : virEventMakePollFDs:364 : Prepare n=7 w=8, f=13 e=1
17:07:54.802: debug : virEventMakePollFDs:364 : Prepare n=8 w=9, f=14 e=1
17:07:54.802: debug : virEventCalculateTimeout:312 : Calculate expiry of 2 timers
17:07:54.802: debug : virEventCalculateTimeout:342 : Timeout at 0 due in -1 ms
17:07:54.802: debug : virEventRunOnce:564 : Poll on 9 handles 0xe603de0 timeout -1
17:07:54.802: debug : virEventRunOnce:566 : Poll got 1 event
17:07:54.802: debug : virEventDispatchHandles:449 : Dispatch n=8 f=14 w=9 e=1 \
0xe5b25f0 17:07:54.825: debug : virEventUpdateHandleImpl:145 : Update handle w=9 e=3
17:07:54.825: debug : virEventInterruptLocked:635 : Skip interrupt, 1 -793020736
17:07:54.825: debug : virEventMakePollFDs:364 : Prepare n=0 w=1, f=5 e=1
17:07:54.825: debug : virEventMakePollFDs:364 : Prepare n=1 w=2, f=8 e=0
17:07:54.825: debug : virEventMakePollFDs:364 : Prepare n=2 w=3, f=8 e=1
17:07:54.825: debug : virEventMakePollFDs:364 : Prepare n=3 w=4, f=3 e=1
17:07:54.825: debug : virEventMakePollFDs:364 : Prepare n=4 w=5, f=9 e=25
17:07:54.825: debug : virEventMakePollFDs:364 : Prepare n=5 w=6, f=10 e=25
17:07:54.825: debug : virEventMakePollFDs:364 : Prepare n=6 w=7, f=12 e=25
17:07:54.825: debug : virEventMakePollFDs:364 : Prepare n=7 w=8, f=13 e=1
17:07:54.825: debug : virEventMakePollFDs:364 : Prepare n=8 w=9, f=14 e=5
17:07:54.825: debug : virEventCalculateTimeout:312 : Calculate expiry of 2 timers
17:07:54.825: debug : virEventCalculateTimeout:342 : Timeout at 0 due in -1 ms
17:07:54.825: debug : virEventRunOnce:564 : Poll on 9 handles 0xe603de0 timeout -1
17:07:54.825: debug : virEventRunOnce:566 : Poll got 1 event
17:07:54.825: debug : virEventDispatchHandles:449 : Dispatch n=8 f=14 w=9 e=4 \
0xe5b25f0 17:07:54.825: debug : virEventUpdateHandleImpl:145 : Update handle w=9 e=1
17:07:54.825: debug : virEventInterruptLocked:635 : Skip interrupt, 1 -793020736
17:07:54.825: debug : virEventMakePollFDs:364 : Prepare n=0 w=1, f=5 e=1
17:07:54.825: debug : virEventMakePollFDs:364 : Prepare n=1 w=2, f=8 e=0
17:07:54.825: debug : virEventMakePollFDs:364 : Prepare n=2 w=3, f=8 e=1
17:07:54.825: debug : virEventMakePollFDs:364 : Prepare n=3 w=4, f=3 e=1
17:07:54.825: debug : virEventMakePollFDs:364 : Prepare n=4 w=5, f=9 e=25
17:07:54.825: debug : virEventMakePollFDs:364 : Prepare n=5 w=6, f=10 e=25
17:07:54.825: debug : virEventMakePollFDs:364 : Prepare n=6 w=7, f=12 e=25
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=7 w=8, f=13 e=1
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=8 w=9, f=14 e=1
17:07:54.826: debug : virEventCalculateTimeout:312 : Calculate expiry of 2 timers
17:07:54.826: debug : virEventCalculateTimeout:342 : Timeout at 0 due in -1 ms
17:07:54.826: debug : virEventRunOnce:564 : Poll on 9 handles 0xe603de0 timeout -1
17:07:54.826: debug : virEventRunOnce:566 : Poll got 1 event
17:07:54.826: debug : virEventDispatchHandles:449 : Dispatch n=8 f=14 w=9 e=1 \
0xe5b25f0 17:07:54.826: debug : virEventUpdateHandleImpl:145 : Update handle w=9 e=1
17:07:54.826: debug : virEventInterruptLocked:635 : Skip interrupt, 1 -793020736
17:07:54.826: debug : virEventUpdateHandleImpl:145 : Update handle w=9 e=1
17:07:54.826: debug : virEventInterruptLocked:635 : Skip interrupt, 1 -793020736
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=0 w=1, f=5 e=1
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=1 w=2, f=8 e=0
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=2 w=3, f=8 e=1
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=3 w=4, f=3 e=1
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=4 w=5, f=9 e=25
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=5 w=6, f=10 e=25
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=6 w=7, f=12 e=25
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=7 w=8, f=13 e=1
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=8 w=9, f=14 e=1
17:07:54.826: debug : virEventCalculateTimeout:312 : Calculate expiry of 2 timers
17:07:54.826: debug : virEventCalculateTimeout:342 : Timeout at 0 due in -1 ms
17:07:54.826: debug : virEventRunOnce:564 : Poll on 9 handles 0xe603de0 timeout -1
17:07:54.826: debug : virEventUpdateHandleImpl:145 : Update handle w=9 e=3
17:07:54.826: debug : virEventInterruptLocked:639 : Interrupting
17:07:54.826: debug : virEventRunOnce:566 : Poll got 1 event
17:07:54.826: debug : virEventDispatchHandles:449 : Dispatch n=0 f=5 w=1 e=1 (nil)
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=0 w=1, f=5 e=1
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=1 w=2, f=8 e=0
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=2 w=3, f=8 e=1
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=3 w=4, f=3 e=1
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=4 w=5, f=9 e=25
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=5 w=6, f=10 e=25
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=6 w=7, f=12 e=25
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=7 w=8, f=13 e=1
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=8 w=9, f=14 e=5
17:07:54.826: debug : virEventCalculateTimeout:312 : Calculate expiry of 2 timers
17:07:54.826: debug : virEventCalculateTimeout:342 : Timeout at 0 due in -1 ms
17:07:54.826: debug : virEventRunOnce:564 : Poll on 9 handles 0xe603de0 timeout -1
17:07:54.826: debug : virEventRunOnce:566 : Poll got 1 event
17:07:54.826: debug : virEventDispatchHandles:449 : Dispatch n=8 f=14 w=9 e=4 \
0xe5b25f0 17:07:54.826: debug : virEventUpdateHandleImpl:145 : Update handle w=9 e=1
17:07:54.826: debug : virEventInterruptLocked:635 : Skip interrupt, 1 -793020736
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=0 w=1, f=5 e=1
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=1 w=2, f=8 e=0
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=2 w=3, f=8 e=1
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=3 w=4, f=3 e=1
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=4 w=5, f=9 e=25
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=5 w=6, f=10 e=25
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=6 w=7, f=12 e=25
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=7 w=8, f=13 e=1
17:07:54.826: debug : virEventMakePollFDs:364 : Prepare n=8 w=9, f=14 e=1
17:07:54.826: debug : virEventCalculateTimeout:312 : Calculate expiry of 2 timers
17:07:54.826: debug : virEventCalculateTimeout:342 : Timeout at 0 due in -1 ms
17:07:54.826: debug : virEventRunOnce:564 : Poll on 9 handles 0xe603de0 timeout -1
17:07:54.826: debug : virEventRunOnce:566 : Poll got 1 event
17:07:54.826: debug : virEventDispatchHandles:449 : Dispatch n=8 f=14 w=9 e=1 \
0xe5b25f0 17:07:54.826: debug : virEventUpdateHandleImpl:145 : Update handle w=9 e=1
17:07:54.826: debug : virEventInterruptLocked:635 : Skip interrupt, 1 -793020736
17:07:54.827: debug : virEventUpdateHandleImpl:145 : Update handle w=9 e=1
17:07:54.827: debug : virEventInterruptLocked:635 : Skip interrupt, 1 -793020736
17:07:54.827: debug : virEventMakePollFDs:364 : Prepare n=0 w=1, f=5 e=1
17:07:54.827: debug : virEventMakePollFDs:364 : Prepare n=1 w=2, f=8 e=0
17:07:54.827: debug : virEventMakePollFDs:364 : Prepare n=2 w=3, f=8 e=1
17:07:54.827: debug : virEventMakePollFDs:364 : Prepare n=3 w=4, f=3 e=1
17:07:54.827: debug : virConnectOpen:1103 : name=qemu:///system
17:07:54.827: debug : virEventMakePollFDs:364 : Prepare n=4 w=5, f=9 e=25
17:07:54.827: debug : virEventMakePollFDs:364 : Prepare n=5 w=6, f=10 e=25
17:07:54.827: debug : virEventMakePollFDs:364 : Prepare n=6 w=7, f=12 e=25
17:07:54.827: debug : virEventMakePollFDs:364 : Prepare n=7 w=8, f=13 e=1
17:07:54.827: debug : virEventMakePollFDs:364 : Prepare n=8 w=9, f=14 e=1
17:07:54.827: debug : virEventCalculateTimeout:312 : Calculate expiry of 2 timers
17:07:54.827: debug : virEventCalculateTimeout:342 : Timeout at 0 due in -1 ms
17:07:54.827: debug : do_open:973 : name "qemu:///system" to URI components:
  scheme qemu
  opaque (null)
  authority (null)
  server (null)
  user (null)
  port 0
  path /system

17:07:54.827: debug : virEventRunOnce:564 : Poll on 9 handles 0xe603de0 timeout -1
17:07:54.827: debug : do_open:983 : trying driver 0 (Test) ...
17:07:54.827: debug : do_open:989 : driver 0 Test returned DECLINED
17:07:54.827: debug : do_open:983 : trying driver 1 (Xen) ...
17:07:54.827: debug : do_open:989 : driver 1 Xen returned DECLINED
17:07:54.827: debug : do_open:983 : trying driver 2 (remote) ...
17:07:54.827: debug : do_open:989 : driver 2 remote returned DECLINED
17:07:54.827: debug : do_open:983 : trying driver 3 (QEMU) ...
17:07:54.827: debug : do_open:989 : driver 3 QEMU returned SUCCESS
17:07:54.827: debug : do_open:1009 : network driver 0 Test returned DECLINED
17:07:54.827: debug : do_open:1009 : network driver 1 remote returned DECLINED
17:07:54.827: debug : do_open:1009 : network driver 2 Network returned SUCCESS
17:07:54.827: debug : do_open:1031 : storage driver 0 Test returned DECLINED
17:07:54.827: debug : do_open:1031 : storage driver 1 remote returned DECLINED
17:07:54.827: debug : do_open:1031 : storage driver 2 storage returned SUCCESS
17:07:54.827: debug : do_open:1052 : node driver 0 Test returned DECLINED
17:07:54.827: debug : do_open:1052 : node driver 1 remote returned DECLINED
17:07:54.827: debug : do_open:1052 : node driver 2 halDeviceMonitor returned SUCCESS
17:07:54.827: debug : virEventUpdateHandleImpl:145 : Update handle w=9 e=3
17:07:54.827: debug : virEventInterruptLocked:639 : Interrupting
17:07:54.827: debug : virEventRunOnce:566 : Poll got 1 event
17:07:54.827: debug : virEventDispatchHandles:449 : Dispatch n=0 f=5 w=1 e=1 (nil)
17:07:54.827: debug : virEventMakePollFDs:364 : Prepare n=0 w=1, f=5 e=1
17:07:54.827: debug : virEventMakePollFDs:364 : Prepare n=1 w=2, f=8 e=0
17:07:54.827: debug : virEventMakePollFDs:364 : Prepare n=2 w=3, f=8 e=1
17:07:54.827: debug : virEventMakePollFDs:364 : Prepare n=3 w=4, f=3 e=1
17:07:54.827: debug : virEventMakePollFDs:364 : Prepare n=4 w=5, f=9 e=25
17:07:54.827: debug : virEventMakePollFDs:364 : Prepare n=5 w=6, f=10 e=25
17:07:54.827: debug : virEventMakePollFDs:364 : Prepare n=6 w=7, f=12 e=25
17:07:54.827: debug : virEventMakePollFDs:364 : Prepare n=7 w=8, f=13 e=1
17:07:54.827: debug : virEventMakePollFDs:364 : Prepare n=8 w=9, f=14 e=5
17:07:54.827: debug : virEventCalculateTimeout:312 : Calculate expiry of 2 timers
17:07:54.827: debug : virEventCalculateTimeout:342 : Timeout at 0 due in -1 ms
17:07:54.827: debug : virEventRunOnce:564 : Poll on 9 handles 0xe603de0 timeout -1
17:07:54.827: debug : virEventRunOnce:566 : Poll got 1 event
17:07:54.827: debug : virEventDispatchHandles:449 : Dispatch n=8 f=14 w=9 e=4 \
0xe5b25f0 17:07:54.827: debug : virEventUpdateHandleImpl:145 : Update handle w=9 e=1
17:07:54.827: debug : virEventInterruptLocked:635 : Skip interrupt, 1 -793020736
17:07:54.827: debug : virEventMakePollFDs:364 : Prepare n=0 w=1, f=5 e=1
17:07:54.827: debug : virEventMakePollFDs:364 : Prepare n=1 w=2, f=8 e=0
17:07:54.827: debug : virEventMakePollFDs:364 : Prepare n=2 w=3, f=8 e=1
17:07:54.827: debug : virEventMakePollFDs:364 : Prepare n=3 w=4, f=3 e=1
17:07:54.827: debug : virEventMakePollFDs:364 : Prepare n=4 w=5, f=9 e=25
17:07:54.827: debug : virEventMakePollFDs:364 : Prepare n=5 w=6, f=10 e=25
17:07:54.827: debug : virEventMakePollFDs:364 : Prepare n=6 w=7, f=12 e=25
17:07:54.827: debug : virEventMakePollFDs:364 : Prepare n=7 w=8, f=13 e=1
17:07:54.827: debug : virEventMakePollFDs:364 : Prepare n=8 w=9, f=14 e=1
17:07:54.827: debug : virEventCalculateTimeout:312 : Calculate expiry of 2 timers
17:07:54.827: debug : virEventCalculateTimeout:342 : Timeout at 0 due in -1 ms
17:07:54.827: debug : virEventRunOnce:564 : Poll on 9 handles 0xe603de0 timeout -1
17:07:54.829: debug : virEventRunOnce:566 : Poll got 1 event
17:07:54.829: debug : virEventDispatchHandles:449 : Dispatch n=8 f=14 w=9 e=1 \
0xe5b25f0 17:07:54.829: debug : virEventUpdateHandleImpl:145 : Update handle w=9 e=1
17:07:54.829: debug : virEventInterruptLocked:635 : Skip interrupt, 1 -793020736
17:07:54.829: debug : virEventUpdateHandleImpl:145 : Update handle w=9 e=1
17:07:54.829: debug : virEventInterruptLocked:635 : Skip interrupt, 1 -793020736
17:07:54.829: debug : virEventMakePollFDs:364 : Prepare n=0 w=1, f=5 e=1
17:07:54.829: debug : virEventMakePollFDs:364 : Prepare n=1 w=2, f=8 e=0
17:07:54.829: debug : virEventMakePollFDs:364 : Prepare n=2 w=3, f=8 e=1
17:07:54.829: debug : virDrvSupportsFeature:1232 : conn=0xe60c3a0, feature=3
17:07:54.829: debug : virEventMakePollFDs:364 : Prepare n=3 w=4, f=3 e=1
17:07:54.829: debug : virEventMakePollFDs:364 : Prepare n=4 w=5, f=9 e=25
17:07:54.830: debug : virEventUpdateHandleImpl:145 : Update handle w=9 e=3
17:07:54.830: debug : virEventMakePollFDs:364 : Prepare n=5 w=6, f=10 e=25
17:07:54.830: debug : virEventMakePollFDs:364 : Prepare n=6 w=7, f=12 e=25
17:07:54.830: debug : virEventMakePollFDs:364 : Prepare n=7 w=8, f=13 e=1
17:07:54.830: debug : virEventMakePollFDs:364 : Prepare n=8 w=9, f=14 e=1
17:07:54.830: debug : virEventCalculateTimeout:312 : Calculate expiry of 2 timers
17:07:54.830: debug : virEventCalculateTimeout:342 : Timeout at 0 due in -1 ms
17:07:54.830: debug : virEventRunOnce:564 : Poll on 9 handles 0xe603de0 timeout -1
17:07:54.830: debug : virEventInterruptLocked:639 : Interrupting
17:07:54.830: debug : virEventRunOnce:566 : Poll got 1 event
17:07:54.830: debug : virEventDispatchHandles:449 : Dispatch n=0 f=5 w=1 e=1 (nil)
17:07:54.830: debug : virEventMakePollFDs:364 : Prepare n=0 w=1, f=5 e=1
17:07:54.830: debug : virEventMakePollFDs:364 : Prepare n=1 w=2, f=8 e=0
17:07:54.830: debug : virEventMakePollFDs:364 : Prepare n=2 w=3, f=8 e=1
17:07:54.830: debug : virEventMakePollFDs:364 : Prepare n=3 w=4, f=3 e=1
17:07:54.830: debug : virEventMakePollFDs:364 : Prepare n=4 w=5, f=9 e=25
17:07:54.830: debug : virEventMakePollFDs:364 : Prepare n=5 w=6, f=10 e=25
17:07:54.830: debug : virEventMakePollFDs:364 : Prepare n=6 w=7, f=12 e=25
17:07:54.830: debug : virEventMakePollFDs:364 : Prepare n=7 w=8, f=13 e=1
17:07:54.830: debug : virEventMakePollFDs:364 : Prepare n=8 w=9, f=14 e=5
17:07:54.830: debug : virEventCalculateTimeout:312 : Calculate expiry of 2 timers
17:07:54.830: debug : virEventCalculateTimeout:342 : Timeout at 0 due in -1 ms
17:07:54.830: debug : virEventRunOnce:564 : Poll on 9 handles 0x2aaaac003430 timeout \
-1 17:07:54.830: debug : virEventRunOnce:566 : Poll got 1 event
17:07:54.830: debug : virEventDispatchHandles:449 : Dispatch n=8 f=14 w=9 e=4 \
0xe5b25f0 17:07:54.830: debug : virEventUpdateHandleImpl:145 : Update handle w=9 e=1
17:07:54.830: debug : virEventInterruptLocked:635 : Skip interrupt, 1 -793020736
17:07:54.830: debug : virEventMakePollFDs:364 : Prepare n=0 w=1, f=5 e=1
17:07:54.830: debug : virEventMakePollFDs:364 : Prepare n=1 w=2, f=8 e=0
17:07:54.830: debug : virEventMakePollFDs:364 : Prepare n=2 w=3, f=8 e=1
17:07:54.830: debug : virEventMakePollFDs:364 : Prepare n=3 w=4, f=3 e=1
17:07:54.830: debug : virEventMakePollFDs:364 : Prepare n=4 w=5, f=9 e=25
17:07:54.830: debug : virEventMakePollFDs:364 : Prepare n=5 w=6, f=10 e=25
17:07:54.830: debug : virEventMakePollFDs:364 : Prepare n=6 w=7, f=12 e=25
17:07:54.830: debug : virEventMakePollFDs:364 : Prepare n=7 w=8, f=13 e=1
17:07:54.830: debug : virEventMakePollFDs:364 : Prepare n=8 w=9, f=14 e=1
17:07:54.830: debug : virEventCalculateTimeout:312 : Calculate expiry of 2 timers
17:07:54.830: debug : virEventCalculateTimeout:342 : Timeout at 0 due in -1 ms
17:07:54.830: debug : virEventRunOnce:564 : Poll on 9 handles 0x2aaaac003430 timeout \
-1 17:07:54.833: debug : virEventRunOnce:566 : Poll got 1 event
17:07:54.834: debug : virEventDispatchHandles:449 : Dispatch n=8 f=14 w=9 e=1 \
0xe5b25f0 17:07:54.834: debug : virEventUpdateHandleImpl:145 : Update handle w=9 e=1
17:07:54.834: debug : virEventInterruptLocked:635 : Skip interrupt, 1 -793020736
17:07:54.834: debug : virEventUpdateHandleImpl:145 : Update handle w=9 e=1
17:07:54.834: debug : virEventInterruptLocked:635 : Skip interrupt, 1 -793020736
17:07:54.834: debug : virDomainMigratePrepare2:3071 : dconn=0xe60c3a0, \
cookie=0x423eaeb8, cookielen=0x423eaec4, uri_in=(null), uri_out=0xe5d8390,flags=1, \
dname=(null), bandwidth=0, dom_xml=&lt;domain type='kvm' id='1'&gt;  &lt;name&gt;one-66&lt;/name&gt;
  &lt;uuid&gt;0a875611-81ce-a47c-b8ba-cad50a3a1a9f&lt;/uuid&gt;
  &lt;memory&gt;262144&lt;/memory&gt;
  &lt;currentMemory&gt;262144&lt;/currentMemory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='x86_64' machine='rhel5.4.0'&gt;hvm&lt;/type&gt;
    &lt;boot dev='hd'/&gt;
  &lt;/os&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;destroy&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;source file='/srv/cloud/one/var/images/66/images/disk.0'/&gt;
      &lt;target dev='hda' bus='ide'/&gt;
    &lt;/disk&gt;
    &lt;disk type='file' device='cdrom'&gt;
      &lt;source file='/srv/cloud/one/var/images/66/images/disk.1'/&gt;
      &lt;target dev='hdb' bus='ide'/&gt;
      &lt;readonly/&gt;
    &lt;/disk&gt;
    &lt;interface type='bridge'&gt;
      &lt;mac address='02:00:a1:1b:d6:d0'/&gt;
      &lt;source bridge='bridge0.334'/&gt;
      &lt;target dev='vnet1'/&gt;
    &lt;/interface&gt;
    &lt;input type='mouse' bus='ps2'/&gt;
    &lt;graphics type='vnc' port='5966' autoport='no' listen='0.0.0.0'/&gt;
  &lt;/devices&gt;
&lt;/domain&gt;

17:07:54.834: debug : virExecWithHook:546 : /usr/bin/kvm -help
17:07:54.835: debug : virEventMakePollFDs:364 : Prepare n=0 w=1, f=5 e=1
17:07:54.835: debug : virEventMakePollFDs:364 : Prepare n=1 w=2, f=8 e=0
17:07:54.835: debug : virEventMakePollFDs:364 : Prepare n=2 w=3, f=8 e=1
17:07:54.835: debug : virEventMakePollFDs:364 : Prepare n=3 w=4, f=3 e=1
17:07:54.835: debug : virEventMakePollFDs:364 : Prepare n=4 w=5, f=9 e=25
17:07:54.835: debug : virEventMakePollFDs:364 : Prepare n=5 w=6, f=10 e=25
17:07:54.835: debug : virEventMakePollFDs:364 : Prepare n=6 w=7, f=12 e=25
17:07:54.835: debug : virEventMakePollFDs:364 : Prepare n=7 w=8, f=13 e=1
17:07:54.835: debug : virEventMakePollFDs:364 : Prepare n=8 w=9, f=14 e=1
17:07:54.835: debug : virEventCalculateTimeout:312 : Calculate expiry of 2 timers
17:07:54.835: debug : virEventCalculateTimeout:342 : Timeout at 0 due in -1 ms
17:07:54.835: debug : virEventRunOnce:564 : Poll on 9 handles 0x2aaaac003430 timeout \
-1 17:07:54.841: debug : virEventRunOnce:566 : Poll got 1 event
17:07:54.841: debug : virEventDispatchHandles:449 : Dispatch n=3 f=3 w=4 e=1 \
0xe5b25f0 17:07:54.841: info : Received unexpected signal 17
17:07:54.841: debug : virEventMakePollFDs:364 : Prepare n=0 w=1, f=5 e=1
17:07:54.841: debug : virEventMakePollFDs:364 : Prepare n=1 w=2, f=8 e=0
17:07:54.841: debug : virEventMakePollFDs:364 : Prepare n=2 w=3, f=8 e=1
17:07:54.841: debug : virEventMakePollFDs:364 : Prepare n=3 w=4, f=3 e=1
17:07:54.841: debug : virEventMakePollFDs:364 : Prepare n=4 w=5, f=9 e=25
17:07:54.841: debug : virEventMakePollFDs:364 : Prepare n=5 w=6, f=10 e=25
17:07:54.841: debug : virEventMakePollFDs:364 : Prepare n=6 w=7, f=12 e=25
17:07:54.841: debug : virEventMakePollFDs:364 : Prepare n=7 w=8, f=13 e=1
17:07:54.841: debug : virEventMakePollFDs:364 : Prepare n=8 w=9, f=14 e=1
17:07:54.841: debug : virEventCalculateTimeout:312 : Calculate expiry of 2 timers
17:07:54.841: debug : virEventCalculateTimeout:342 : Timeout at 0 due in -1 ms
17:07:54.841: debug : virEventRunOnce:564 : Poll on 9 handles 0x2aaaac003430 timeout \
-1 17:07:54.854: debug : virExecWithHook:546 : /usr/bin/kvm -S -M rhel5.4.0 -m 256 \
-smp 1 -name one-66 -uuid 0a875611-81ce-a47c-b8ba-cad50a3a1a9f \
-no-kvm-pit-reinjection -monitor pty -pidfile /var/run/libvirt/qemu//one-66.pid \
-no-acpi -boot c -drive \
file=/srv/cloud/one/var/images/66/images/disk.0,if=ide,index=0,boot=on -drive \
file=/srv/cloud/one/var/images/66/images/disk.1,if=ide,media=cdrom,index=1 -net \
nic,macaddr=02:00:a1:1b:d6:d0,vlan=0 -net tap,fd=17,script=,vlan=0,ifname=vnet0 \
-serial none -parallel none -usb -vnc 0.0.0.0:66 -incoming tcp:0.0.0.0:49152 \
17:07:54.856: debug : virEventRunOnce:566 : Poll got 1 event 17:07:54.856: debug : \
virEventDispatchHandles:449 : Dispatch n=3 f=3 w=4 e=1 0xe5b25f0 17:07:54.856: info : \
Received unexpected signal 17 17:07:54.856: debug : virEventMakePollFDs:364 : Prepare \
n=0 w=1, f=5 e=1 17:07:54.856: debug : virEventMakePollFDs:364 : Prepare n=1 w=2, f=8 \
e=0 17:07:54.856: debug : virEventMakePollFDs:364 : Prepare n=2 w=3, f=8 e=1
17:07:54.856: debug : virEventMakePollFDs:364 : Prepare n=3 w=4, f=3 e=1
17:07:54.856: debug : virEventMakePollFDs:364 : Prepare n=4 w=5, f=9 e=25
17:07:54.856: debug : virEventMakePollFDs:364 : Prepare n=5 w=6, f=10 e=25
17:07:54.856: debug : virEventMakePollFDs:364 : Prepare n=6 w=7, f=12 e=25
17:07:54.856: debug : virEventMakePollFDs:364 : Prepare n=7 w=8, f=13 e=1
17:07:54.856: debug : virEventMakePollFDs:364 : Prepare n=8 w=9, f=14 e=1
17:07:54.856: debug : virEventCalculateTimeout:312 : Calculate expiry of 2 timers
17:07:54.856: debug : virEventCalculateTimeout:342 : Timeout at 0 due in -1 ms
17:07:54.856: debug : virEventRunOnce:564 : Poll on 9 handles 0x2aaaac003430 timeout \
-1 17:07:55.884: debug : virEventAddHandleImpl:111 : Add handle 18 0 0x4229b0 \
0xe5bc700 17:07:55.884: debug : virEventInterruptLocked:639 : Interrupting
17:07:55.884: debug : virEventRunOnce:566 : Poll got 1 event
17:07:55.884: debug : virEventDispatchHandles:449 : Dispatch n=0 f=5 w=1 e=1 (nil)
17:07:55.884: debug : virEventMakePollFDs:364 : Prepare n=0 w=1, f=5 e=1
17:07:55.884: debug : virEventMakePollFDs:364 : Prepare n=1 w=2, f=8 e=0
17:07:55.884: debug : virEventMakePollFDs:364 : Prepare n=2 w=3, f=8 e=1
17:07:55.884: debug : virEventMakePollFDs:364 : Prepare n=3 w=4, f=3 e=1
17:07:55.884: debug : virEventMakePollFDs:364 : Prepare n=4 w=5, f=9 e=25
17:07:55.884: debug : virEventMakePollFDs:364 : Prepare n=5 w=6, f=10 e=25
17:07:55.884: debug : virEventMakePollFDs:364 : Prepare n=6 w=7, f=12 e=25
17:07:55.884: debug : virEventMakePollFDs:364 : Prepare n=7 w=8, f=13 e=1
17:07:55.884: debug : virEventMakePollFDs:364 : Prepare n=8 w=9, f=14 e=1
17:07:55.884: debug : virEventMakePollFDs:364 : Prepare n=9 w=10, f=18 e=0
17:07:55.884: debug : virEventCalculateTimeout:312 : Calculate expiry of 2 timers
17:07:55.884: debug : virEventCalculateTimeout:342 : Timeout at 0 due in -1 ms
17:07:55.884: debug : virEventRunOnce:564 : Poll on 10 handles 0x2aaaac003730 timeout \
-1 17:07:55.886: debug : qemudDomainSetMemoryBalloon:2719 : one-66: balloon reply: \
balloon 256

17:07:55.886: debug : virEventUpdateTimeoutImpl:246 : Updating timer 1 timeout with 0 \
ms freq 17:07:55.886: debug : virEventInterruptLocked:639 : Interrupting
17:07:55.886: debug : virEventRunOnce:566 : Poll got 1 event
17:07:55.886: debug : virEventUpdateTimeoutImpl:246 : Updating timer 1 timeout with \
-1 ms freq 17:07:55.886: debug : virEventInterruptLocked:635 : Skip interrupt, 1 \
-793020736 17:07:55.886: debug : virEventDispatchHandles:449 : Dispatch n=0 f=5 w=1 \
e=1 (nil) 17:07:55.886: debug : virEventUpdateHandleImpl:145 : Update handle w=9 e=3
17:07:55.886: debug : virEventInterruptLocked:635 : Skip interrupt, 0 -793020736
17:07:55.886: debug : virEventMakePollFDs:364 : Prepare n=0 w=1, f=5 e=1
17:07:55.886: debug : virEventMakePollFDs:364 : Prepare n=1 w=2, f=8 e=0
17:07:55.886: debug : virEventMakePollFDs:364 : Prepare n=2 w=3, f=8 e=1
17:07:55.886: debug : virEventMakePollFDs:364 : Prepare n=3 w=4, f=3 e=1
17:07:55.886: debug : virEventMakePollFDs:364 : Prepare n=4 w=5, f=9 e=25
17:07:55.886: debug : virEventMakePollFDs:364 : Prepare n=5 w=6, f=10 e=25
17:07:55.886: debug : virEventMakePollFDs:364 : Prepare n=6 w=7, f=12 e=25
17:07:55.886: debug : virEventMakePollFDs:364 : Prepare n=7 w=8, f=13 e=1
17:07:55.886: debug : virEventMakePollFDs:364 : Prepare n=8 w=9, f=14 e=5
17:07:55.886: debug : virEventMakePollFDs:364 : Prepare n=9 w=10, f=18 e=0
17:07:55.886: debug : virEventCalculateTimeout:312 : Calculate expiry of 2 timers
17:07:55.886: debug : virEventCalculateTimeout:342 : Timeout at 0 due in -1 ms
17:07:55.886: debug : virEventRunOnce:564 : Poll on 10 handles 0x2aaaac003850 timeout \
-1 17:07:55.886: debug : virEventRunOnce:566 : Poll got 1 event
17:07:55.886: debug : virEventDispatchHandles:449 : Dispatch n=8 f=14 w=9 e=4 \
0xe5b25f0 17:07:55.887: debug : virEventUpdateHandleImpl:145 : Update handle w=9 e=1
17:07:55.887: debug : virEventInterruptLocked:635 : Skip interrupt, 1 -793020736
17:07:55.887: debug : virEventMakePollFDs:364 : Prepare n=0 w=1, f=5 e=1
17:07:55.887: debug : virEventMakePollFDs:364 : Prepare n=1 w=2, f=8 e=0
17:07:55.887: debug : virEventMakePollFDs:364 : Prepare n=2 w=3, f=8 e=1
17:07:55.887: debug : virEventMakePollFDs:364 : Prepare n=3 w=4, f=3 e=1
17:07:55.887: debug : virEventMakePollFDs:364 : Prepare n=4 w=5, f=9 e=25
17:07:55.887: debug : virEventMakePollFDs:364 : Prepare n=5 w=6, f=10 e=25
17:07:55.887: debug : virEventMakePollFDs:364 : Prepare n=6 w=7, f=12 e=25
17:07:55.887: debug : virEventMakePollFDs:364 : Prepare n=7 w=8, f=13 e=1
17:07:55.887: debug : virEventMakePollFDs:364 : Prepare n=8 w=9, f=14 e=1
17:07:55.887: debug : virEventMakePollFDs:364 : Prepare n=9 w=10, f=18 e=0
17:07:55.887: debug : virEventCalculateTimeout:312 : Calculate expiry of 2 timers
17:07:55.887: debug : virEventCalculateTimeout:342 : Timeout at 0 due in -1 ms
17:07:55.887: debug : virEventRunOnce:564 : Poll on 10 handles 0x2aaaac003430 timeout \
-1 17:07:55.891: debug : virEventRunOnce:566 : Poll got 1 event
17:07:55.891: debug : virEventDispatchHandles:449 : Dispatch n=8 f=14 w=9 e=1 \
0xe5b25f0 17:07:55.891: debug : virEventUpdateHandleImpl:145 : Update handle w=9 e=1
17:07:55.891: debug : virEventInterruptLocked:635 : Skip interrupt, 1 -793020736
17:07:55.891: debug : virEventUpdateHandleImpl:145 : Update handle w=9 e=1
17:07:55.891: debug : virEventInterruptLocked:635 : Skip interrupt, 1 -793020736
17:07:55.891: debug : virEventMakePollFDs:364 : Prepare n=0 w=1, f=5 e=1
17:07:55.891: debug : virEventMakePollFDs:364 : Prepare n=1 w=2, f=8 e=0
17:07:55.891: debug : virEventMakePollFDs:364 : Prepare n=2 w=3, f=8 e=1
17:07:55.891: debug : virEventMakePollFDs:364 : Prepare n=3 w=4, f=3 e=1
17:07:55.891: debug : virEventMakePollFDs:364 : Prepare n=4 w=5, f=9 e=25
17:07:55.891: debug : virEventMakePollFDs:364 : Prepare n=5 w=6, f=10 e=25
17:07:55.891: debug : virEventMakePollFDs:364 : Prepare n=6 w=7, f=12 e=25
17:07:55.891: debug : virEventMakePollFDs:364 : Prepare n=7 w=8, f=13 e=1
17:07:55.891: debug : virEventMakePollFDs:364 : Prepare n=8 w=9, f=14 e=1
17:07:55.891: debug : virEventMakePollFDs:364 : Prepare n=9 w=10, f=18 e=0
17:07:55.891: debug : virEventCalculateTimeout:312 : Calculate expiry of 2 timers
17:07:55.891: debug : virEventCalculateTimeout:342 : Timeout at 0 due in -1 ms
17:07:55.891: debug : virEventRunOnce:564 : Poll on 10 handles 0xe604e50 timeout -1
17:07:55.891: debug : virDomainMigrateFinish2:3119 : dconn=0xe60c3a0, dname=one-66, \
cookie=(nil), cookielen=0, uri=tcp:itpsmenc044.engicloud.psmidc.com:49152, flags=1, \
retcode=-1 17:07:55.891: debug : qemudShutdownVMDaemon:1684 : Shutting down VM \
'one-66'

17:07:55.891: debug : virEventRemoveHandleImpl:172 : Remove handle 10
17:07:55.891: debug : virEventRemoveHandleImpl:185 : mark delete 9 18
17:07:55.891: debug : virEventInterruptLocked:639 : Interrupting
17:07:55.891: debug : virEventUpdateTimeoutImpl:246 : Updating timer 1 timeout with 0 \
ms freq 17:07:55.892: debug : virEventInterruptLocked:639 : Interrupting
17:07:55.892: debug : virEventUpdateHandleImpl:145 : Update handle w=9 e=3
17:07:55.892: debug : virEventInterruptLocked:639 : Interrupting
17:07:55.892: debug : virEventRunOnce:566 : Poll got 2 event
17:07:55.892: debug : virEventUpdateTimeoutImpl:246 : Updating timer 1 timeout with \
-1 ms freq 17:07:55.892: debug : virEventInterruptLocked:635 : Skip interrupt, 1 \
-793020736 17:07:55.892: debug : virEventDispatchHandles:449 : Dispatch n=0 f=5 w=1 \
e=1 (nil) 17:07:55.892: debug : virEventDispatchHandles:439 : Skip deleted n=9 w=10 \
f=18 17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=0 w=1, f=5 e=1
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=1 w=2, f=8 e=0
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=2 w=3, f=8 e=1
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=3 w=4, f=3 e=1
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=4 w=5, f=9 e=25
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=5 w=6, f=10 e=25
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=6 w=7, f=12 e=25
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=7 w=8, f=13 e=1
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=8 w=9, f=14 e=5
17:07:55.892: debug : virEventCalculateTimeout:312 : Calculate expiry of 2 timers
17:07:55.892: debug : virEventCalculateTimeout:342 : Timeout at 0 due in -1 ms
17:07:55.892: debug : virEventRunOnce:564 : Poll on 9 handles 0xe60b5a0 timeout -1
17:07:55.892: debug : virEventRunOnce:566 : Poll got 2 event
17:07:55.892: debug : virEventDispatchHandles:449 : Dispatch n=0 f=5 w=1 e=1 (nil)
17:07:55.892: debug : virEventDispatchHandles:449 : Dispatch n=8 f=14 w=9 e=4 \
0xe5b25f0 17:07:55.892: debug : virEventUpdateHandleImpl:145 : Update handle w=9 e=1
17:07:55.892: debug : virEventInterruptLocked:635 : Skip interrupt, 1 -793020736
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=0 w=1, f=5 e=1
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=1 w=2, f=8 e=0
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=2 w=3, f=8 e=1
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=3 w=4, f=3 e=1
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=4 w=5, f=9 e=25
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=5 w=6, f=10 e=25
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=6 w=7, f=12 e=25
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=7 w=8, f=13 e=1
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=8 w=9, f=14 e=1
17:07:55.892: debug : virEventCalculateTimeout:312 : Calculate expiry of 2 timers
17:07:55.892: debug : virEventCalculateTimeout:342 : Timeout at 0 due in -1 ms
17:07:55.892: debug : virEventRunOnce:564 : Poll on 9 handles 0xe60b5a0 timeout -1
17:07:55.892: debug : virEventRunOnce:566 : Poll got 1 event
17:07:55.892: debug : virEventDispatchHandles:449 : Dispatch n=0 f=5 w=1 e=1 (nil)
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=0 w=1, f=5 e=1
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=1 w=2, f=8 e=0
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=2 w=3, f=8 e=1
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=3 w=4, f=3 e=1
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=4 w=5, f=9 e=25
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=5 w=6, f=10 e=25
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=6 w=7, f=12 e=25
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=7 w=8, f=13 e=1
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=8 w=9, f=14 e=1
17:07:55.892: debug : virEventCalculateTimeout:312 : Calculate expiry of 2 timers
17:07:55.892: debug : virEventCalculateTimeout:342 : Timeout at 0 due in -1 ms
17:07:55.892: debug : virEventRunOnce:564 : Poll on 9 handles 0xe60b5a0 timeout -1
17:07:55.892: debug : virEventRunOnce:566 : Poll got 1 event
17:07:55.892: debug : virEventDispatchHandles:449 : Dispatch n=8 f=14 w=9 e=1 \
0xe5b25f0 17:07:55.892: debug : virEventUpdateHandleImpl:145 : Update handle w=9 e=1
17:07:55.892: debug : virEventInterruptLocked:635 : Skip interrupt, 1 -793020736
17:07:55.892: debug : virEventUpdateHandleImpl:145 : Update handle w=9 e=1
17:07:55.892: debug : virEventInterruptLocked:635 : Skip interrupt, 1 -793020736
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=0 w=1, f=5 e=1
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=1 w=2, f=8 e=0
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=2 w=3, f=8 e=1
17:07:55.892: debug : virEventMakePollFDs:364 : Prepare n=3 w=4, f=3 e=1
17:07:55.893: debug : virEventMakePollFDs:364 : Prepare n=4 w=5, f=9 e=25
17:07:55.893: debug : virEventUpdateHandleImpl:145 : Update handle w=9 e=3
17:07:55.893: debug : virEventMakePollFDs:364 : Prepare n=5 w=6, f=10 e=25
17:07:55.893: debug : virEventMakePollFDs:364 : Prepare n=6 w=7, f=12 e=25
17:07:55.893: debug : virEventMakePollFDs:364 : Prepare n=7 w=8, f=13 e=1
17:07:55.893: debug : virEventMakePollFDs:364 : Prepare n=8 w=9, f=14 e=1
17:07:55.893: debug : virEventCalculateTimeout:312 : Calculate expiry of 2 timers
17:07:55.893: debug : virEventCalculateTimeout:342 : Timeout at 0 due in -1 ms
17:07:55.893: debug : virEventRunOnce:564 : Poll on 9 handles 0xe60b5a0 timeout -1
17:07:55.893: debug : virEventInterruptLocked:639 : Interrupting
17:07:55.893: debug : virEventRunOnce:566 : Poll got 1 event
17:07:55.893: debug : virEventDispatchHandles:449 : Dispatch n=0 f=5 w=1 e=1 (nil)
17:07:55.893: debug : virEventMakePollFDs:364 : Prepare n=0 w=1, f=5 e=1
17:07:55.893: debug : virEventMakePollFDs:364 : Prepare n=1 w=2, f=8 e=0
17:07:55.893: debug : virEventMakePollFDs:364 : Prepare n=2 w=3, f=8 e=1
17:07:55.893: debug : virEventMakePollFDs:364 : Prepare n=3 w=4, f=3 e=1
17:07:55.893: debug : virEventMakePollFDs:364 : Prepare n=4 w=5, f=9 e=25
17:07:55.893: debug : virEventMakePollFDs:364 : Prepare n=5 w=6, f=10 e=25
17:07:55.893: debug : virEventMakePollFDs:364 : Prepare n=6 w=7, f=12 e=25
17:07:55.893: debug : virEventMakePollFDs:364 : Prepare n=7 w=8, f=13 e=1
17:07:55.893: debug : virEventMakePollFDs:364 : Prepare n=8 w=9, f=14 e=5
17:07:55.893: debug : virEventCalculateTimeout:312 : Calculate expiry of 2 timers
17:07:55.893: debug : virEventCalculateTimeout:342 : Timeout at 0 due in -1 ms
17:07:55.893: debug : virEventRunOnce:564 : Poll on 9 handles 0xe60b5a0 timeout -1
17:07:55.893: debug : virEventRunOnce:566 : Poll got 1 event
17:07:55.893: debug : virEventDispatchHandles:449 : Dispatch n=8 f=14 w=9 e=4 \
0xe5b25f0 17:07:55.893: debug : virEventRemoveHandleImpl:172 : Remove handle 9
17:07:55.893: debug : virEventRemoveHandleImpl:185 : mark delete 8 14
17:07:55.893: debug : virEventInterruptLocked:635 : Skip interrupt, 1 -793020736
17:07:55.893: debug : qemudDispatchClientFailure:1407 : Deregistering to relay remote \
events 17:07:55.893: debug : virConnectDomainEventDeregister:7760 : conn=0xe60c3a0, \
cb=0x4143d0 17:07:55.893: debug : virConnectClose:1171 : conn=0xe60c3a0
17:07:55.893: debug : virUnrefConnect:210 : unref connection 0xe60c3a0 1
17:07:55.893: debug : virReleaseConnect:171 : release connection 0xe60c3a0
17:07:55.893: debug : virEventMakePollFDs:364 : Prepare n=0 w=1, f=5 e=1
17:07:55.893: debug : virEventMakePollFDs:364 : Prepare n=1 w=2, f=8 e=0
17:07:55.893: debug : virEventMakePollFDs:364 : Prepare n=2 w=3, f=8 e=1
17:07:55.893: debug : virEventMakePollFDs:364 : Prepare n=3 w=4, f=3 e=1
17:07:55.893: debug : virEventMakePollFDs:364 : Prepare n=4 w=5, f=9 e=25
17:07:55.893: debug : virEventMakePollFDs:364 : Prepare n=5 w=6, f=10 e=25
17:07:55.893: debug : virEventMakePollFDs:364 : Prepare n=6 w=7, f=12 e=25
17:07:55.893: debug : virEventMakePollFDs:364 : Prepare n=7 w=8, f=13 e=1
17:07:55.893: debug : virEventCalculateTimeout:312 : Calculate expiry of 2 timers
17:07:55.893: debug : virEventCalculateTimeout:342 : Timeout at 0 due in -1 ms
17:07:55.893: debug : virEventRunOnce:564 : Poll on 8 handles 0xe604d90 timeout -1
------------------------------8&lt;----------------------------


</body></email><email><emailId>20101101022005</emailId><senderName>Osier</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2010-11-01 02:20:05-0400</timestampReceived><subject>Re: [libvirt-users] qemu sdl parameters via libvirt</subject><body>

 20101030 23:43, Bruce Hohl :
&gt; Hello List, I run a few VMs via libvirt using '--sdl'.  I would like
&gt; to use qemu parameters -no-quit, -no-frame and -ctrl-grab with
&gt; libvirt.  Does libvirt support a way to use these qemu parameters?
libvirt does provide way to suport qemu parameters, since 0.8.2.

see:

http://libvirt.org/git/?p=libvirt.git;a=blob;f=tests/qemuxml2argvdata/qemuxml2argv-qemu-ns.args;h=b7055d56d647809e48d8847175fc7f5024a26960;hb=HEAD


http://libvirt.org/git/?p=libvirt.git;a=blob;f=tests/qemuxml2argvdata/qemuxml2argv-qemu-ns.xml;h=c48c2488ce89ffa853394ab41f90c839cdcfa769;hb=HEAD


&gt; Does libvirt provide a way to add these options under&lt;graphics/&gt;  in
&gt; the domain.xml using 'virsh edit domain.xml'?

for &lt;graphics/&gt;, guess you can write all the graphics parameters in
&lt;qemu:commandline/&gt; instead to have a try.. not sure if will work. :-)

Regards

- Osier

&gt; 
&gt; My current&lt;graphics/&gt;  is as follows:
&gt; &lt;graphics type='sdl' display=':0' xauth='/home/admin1/.Xauthority'/&gt;
&gt; 
&gt; I know I could just create a regular kvm start-up script and include
&gt; these parameters but I would like to manages all VMs via libvirt&amp;
&gt; virt-manager.
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users


</body></email><email><emailId>20101101125650</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2010-11-01 12:56:50-0400</timestampReceived><subject>Re: [libvirt-users] libvirt problems. Create bridged network via cmdline?</subject><body>

On 10/29/10 - 12:55:49AM,   wrote:
&gt; Hello!
&gt; 
&gt; I've faced a weird problem. And I totally can't understand how libvirt
&gt; handles networks. The thing that i need to do is simple. I create a bridge
&gt; in my ubuntu host, the following config:
&gt; 
&gt; *iface eth0 inet manual*
&gt; *
&gt; *
&gt; *auto br0*
&gt; *iface br0 inet dhcp*
&gt; *  bridge_ports eth0*
&gt; *  bridge_stp on*
&gt; *  bridge_maxwait 0*
&gt; 
&gt; That's OK, and my bridge turns up automatically. But I don't understand why
&gt; libvirt can't use it, it always want to create bridge on its own. So that
&gt; when I try to create bridged network with the command:
&gt;   virsh virsh net-create net.xml
&gt; 
&gt; net.xml contents:
&gt; * &lt;network&gt;*
&gt; *  &lt;name&gt;virbreth0&lt;/name&gt;*
&gt; *  &lt;bridge name='br0' stp='on' delay='0' /&gt;*
&gt; * &lt;/network&gt;*
&gt; 
&gt; I always get error ===&gt;
&gt; error: Failed to create network from net.xml
&gt; error: cannot create bridge 'br0': File exists
&gt; 
&gt; That's pretty obvious that libvirt wants to create bridge on its own. But
&gt; what should I do in my specific situation. May be there is a workaround.
&gt; I appreciate any help and ideas...

It is not exactly clear to me, but what I think you are trying to do is to
create the bridge by hand, and then have libvirt guests use it.  If that is
the case, then you do not need to use the virsh net-create command at all;
like you see, net-create tries to "create" the bridge.  If all you want to
do is use the bridge that you have already setup, then you just need to add
a section to your *guest* XML like:

&lt;domain type='kvm'&gt;
  ...
  &lt;devices&gt;
    ...
    &lt;interface type='bridge'&gt;
      ...
      &lt;source bridge='br0'/&gt;
    &lt;/interface&gt;
  &lt;/devices&gt;
&lt;/domain&gt;

And then your guest will start up connected to the br0 bridge.

-- 
Chris Lalancette

</body></email><email><emailId>20101101125853</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2010-11-01 12:58:53-0400</timestampReceived><subject>Re: [libvirt-users] SCSI tape drive device</subject><body>

On 10/29/10 - 09:27:58AM, Tom Stave wrote:
&gt; I have a SCSI tape backup unit attached to a kvm host managed by
&gt; libvirt.  Is there a way to expose the SCSI device in libvirt so I
&gt; could pass the device to a virtual machine and have the virtual
&gt; machine control the tape backup?
&gt; 
&gt; Defining the device as a SCSI disk does not appear to work.

kvm does not support passthrough of individual SCSI devices today.  The only
way you can make this work today is to pass through the entire SCSI
HBA as a PCI device to the guest, at which point the guest should be able to
initialize the SCSI controller and use the tape unit.

-- 
Chris Lalancette

</body></email><email><emailId>20101102032219</emailId><senderName>Osier</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2010-11-02 03:22:19-0400</timestampReceived><subject>Re: [libvirt-users] Libvirt and LXC</subject><body>

guess you have similar problem with the problem once
raised up in libvir-list.

http://osdir.com/ml/libvir-list/2010-10/msg01196.html

read the reply messages to see if it can help, especially
on Daniel P.Berrange's reply.

- Osier
On 11/02/2010 09:59 AM, Mohd Izhar Firdaus Ismail wrote:
&gt; (oops accidentally sent to -owners)
&gt;
&gt; Hi, i'm trying to start a LXC guest on a F14 computer .. followed the
&gt; examples in http://libvirt.org/drvlxc.html, but got stuck when
&gt; starting it ..
&gt;
&gt; 03:07:23.706: debug : virCgroupNew:542 : New group /
&gt; 03:07:23.707: debug : lxcControllerRun:563 : Setting up private /dev/pts
&gt; 03:07:23.711: debug : lxcControllerRun:589 : Mouting 'devpts' on
&gt; /var/lxc/f14/dev/pts
&gt; 03:07:23.711: debug : lxcControllerRun:604 : Opening tty on private
&gt; /var/lxc/f14/dev/pts/ptmx
&gt; 03:07:23.714: debug : lxcContainerAvailable:897 : clone call returned
&gt; Invalid argument, container support is not enabled
&gt; 03:07:23.714: debug : lxcContainerStart:848 : Enable network namespaces
&gt; 03:07:23.718: debug : lxcContainerStart:854 : clone() completed, new
&gt; container PID is -1
&gt; 03:07:23.718: error : lxcContainerStart:858 : Failed to run clone
&gt; container: Invalid argument
&gt; 03:07:23.718: debug : vethDelete:141 : veth: veth1
&gt; 03:07:23.718: debug : virRunWithHook:820 : ip link del veth1
&gt;
&gt; LXC config:
&gt;
&gt; &lt;domain type='lxc'&gt;
&gt;   &lt;name&gt;f14&lt;/name&gt;
&gt;   &lt;uuid&gt;2dcd3cac-47e6-2915-554a-9713edf6ffd1&lt;/uuid&gt;
&gt;   &lt;memory&gt;256000&lt;/memory&gt;
&gt;   &lt;currentMemory&gt;256000&lt;/currentMemory&gt;
&gt;   &lt;vcpu&gt;1&lt;/vcpu&gt;
&gt;   &lt;os&gt;
&gt;     &lt;type arch='x86_64'&gt;exe&lt;/type&gt;
&gt;     &lt;init&gt;/sbin/init&lt;/init&gt;
&gt;   &lt;/os&gt;
&gt;   &lt;clock offset='utc'/&gt;
&gt;   &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
&gt;   &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
&gt;   &lt;on_crash&gt;destroy&lt;/on_crash&gt;
&gt;   &lt;devices&gt;
&gt;     &lt;emulator&gt;/usr/libexec/libvirt_lxc&lt;/emulator&gt;
&gt;     &lt;filesystem type='mount'&gt;
&gt;       &lt;source dir='/var/lxc/f14'/&gt;
&gt;       &lt;target dir='/'/&gt;
&gt;     &lt;/filesystem&gt;
&gt;     &lt;interface type='network'&gt;
&gt;       &lt;mac address='52:54:00:b0:de:18'/&gt;
&gt;       &lt;source network='default'/&gt;
&gt;     &lt;/interface&gt;
&gt;     &lt;console type='pty'&gt;
&gt;       &lt;target type='serial' port='0'/&gt;
&gt;     &lt;/console&gt;
&gt;   &lt;/devices&gt;
&gt; &lt;/domain&gt;
&gt;
&gt;
&gt; I dont know what the invalid arguments are...
&gt; 03:07:23.718: error : lxcContainerStart:858 : Failed to run clone
&gt; container: Invalid argument
&gt;
&gt;
&gt; thanks
&gt; --
&gt; Mohd Izhar Firdaus Bin Ismail / KageSenshi
&gt; Inigo Consulting (FOSS/Plone Development, Training&amp;  Services)
&gt; http://www.inigo-tech.com
&gt; Fedora Malaysia Contributor&amp;  Ambassador
&gt; http://blog.kagesenshi.org
&gt; 92C2 B295 B40B B3DC 6866  5011 5BD2 584A 8A5D 7331
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20101102134911</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-11-02 13:49:11-0400</timestampReceived><subject>Re: [libvirt-users] Does current libvirt ruby support ruby 1.9.2? Or when will it support it?</subject><body>

On 11/03/2010 12:29 AM, Chris Lalancette wrote:
&gt; On 11/02/10 - 04:59:55PM,  wrote:
&gt;&gt; I'm using ruby 1.8.7  and going to port to ruby 1.9. I'd like to confirm
&gt;&gt; whether the libvirt ruby support the latest ruby 1.9.
&gt; 
&gt; I've recently incorporated a couple of patches into the upstream ruby libvirt
&gt; tree that make it compile on ruby 1.9.  However, I have *not* tested there,
&gt; so I don't know if it actually works.  If you have time to compile and test
&gt; the tree at http://libvirt.org/git/?p=ruby-libvirt.git;a=summary, and let me
&gt; know if it works, that would be a big help.  Otherwise, I'll have to set some
&gt; time aside to try it out on 1.9.

When we know for sure, I'll update the ruby-libvirt page to explicitly
mention it. :)

</body></email><email><emailId>20101102085955</emailId><senderName></senderName><senderEmail>wbinglee@gmail.com</senderEmail><timestampReceived>2010-11-02 08:59:55-0400</timestampReceived><subject>[libvirt-users] Does current libvirt ruby support ruby 1.9.2? Or when will it support it?</subject><body>

I'm using ruby 1.8.7  and going to port to ruby 1.9. I'd like to confirm
whether the libvirt ruby support the latest ruby 1.9.

Thanks.

[Attachment #3 (text/html)]

I'm using ruby 1.8.7=C2=A0 and going to port to ruby 1.9. I'd like =
to confirm whether the libvirt ruby support the latest ruby 1.9.&lt;br&gt;&lt;br&gt;Tha=
nks.&lt;br&gt;


</body></email><email><emailId>20101102180702</emailId><senderName>"Ryan Haggerty"</senderName><senderEmail>rhaggerty@tresys.com</senderEmail><timestampReceived>2010-11-02 18:07:02-0400</timestampReceived><subject>[libvirt-users] controlling VM access to different tap devices</subject><body>

Sorry if this off-topic but I have a qemu related question I was going
to send to the qemu users mailing list but that list appears to have
vanished.  I thought this community might have some insight.

I am interested in controlling VM access to different tap devices so I
want to have different qemu processes bound to different tun devices.
I've created new tun devices (eg. /dev/net/tun_low) followed by the use
of tunctl to create new tap devices based off of the new device nodes
(ie tunctl -t tap0 -f /dev/net/tun_low). This also did not seem to work
as the VM's seemed to still be accessing /dev/net/tun (running strace on
qemu-spice I found it was still doing an open on /dev/net/tun) and not
my new device /dev/net/tun_low.  Any suggestions on forcing qemu to use
alternative tun devices?

</body></email><email><emailId>20101110165939</emailId><senderName>Kenneth Stailey</senderName><senderEmail>kstailey@yahoo.com</senderEmail><timestampReceived>2010-11-10 16:59:39-0400</timestampReceived><subject>[libvirt-users] Updating Multiple VM Guests?</subject><body>

Hi,

The libvirt.org FAQ says that "virsh edit" is the recommended way of updating the \
libvirt xml.

If a change has to be made to many VMs "virsh edit" is tedious, time-consuming and \
likely to be prone to careless errors.

Is there a command line approach to updating multiple VMs?

Thanks,
Ken


</body></email><email><emailId>20101110174111</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2010-11-10 17:41:11-0400</timestampReceived><subject>Re: [libvirt-users] Updating Multiple VM Guests?</subject><body>

On 11/10/2010 11:59 AM, Kenneth Stailey wrote:
&gt; Hi,
&gt; 
&gt; The libvirt.org FAQ says that "virsh edit" is the recommended way of updating the \
&gt; libvirt xml. 
&gt; If a change has to be made to many VMs "virsh edit" is tedious, time-consuming and \
&gt; likely to be prone to careless errors. 
&gt; Is there a command line approach to updating multiple VMs?

How about:

    for g in guest1 guest2 guest3 guest4; do
       virsh dumpxml --inactive $g &gt;/tmp/g.xml
       # do whatever sed/etc commands you want here
       virsh define /tmp/g.xml
   done

(or something like that, anyway :-)


</body></email><email><emailId>20101110180702</emailId><senderName>Dale Amon</senderName><senderEmail>amon@vnl.com</senderEmail><timestampReceived>2010-11-10 18:07:02-0400</timestampReceived><subject>Re: [libvirt-users] Updating Multiple VM Guests?</subject><body>

On Wed, Nov 10, 2010 at 08:59:39AM -0800, Kenneth Stailey wrote:
&gt; Hi,
&gt; 
&gt; The libvirt.org FAQ says that "virsh edit" is the recommended way of updating the \
&gt; libvirt xml. 
&gt; If a change has to be made to many VMs "virsh edit" is tedious, time-consuming and \
&gt; likely to be prone to careless errors. 
&gt; Is there a command line approach to updating multiple VMs?

I rather like emacs.


</body></email><email><emailId>20101103125854</emailId><senderName>Sherif Nagy</senderName><senderEmail>sherif.nagy@gmail.com</senderEmail><timestampReceived>2010-11-03 12:58:54-0400</timestampReceived><subject>[libvirt-users] ESX(i) implemented functions</subject><body>

Dear All,

I would like to know what functions and classes are implemented in the
ESX(i) driver ? i am trying to use virsh to retrieve some simple information
such as vcpuinfo domain, but it is not working, so I would like to know what
functions are implemented in libvirt ESX(i) driver. Also i checked the
http://libvirt.org/drvesx.html and nothing is mentioned there.

Thank You,
Regards,
Sherif

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;Dear All,&lt;br&gt;&lt;br&gt;I would like to know what functions and classes are \
implemented in the ESX(i) driver ? i am trying to use virsh to retrieve some simple \
information such as vcpuinfo domain, but it is not working, so I would like to know \
what functions are implemented in libvirt ESX(i) driver. Also i checked the &lt;a \
href="http://libvirt.org/drvesx.html"&gt;http://libvirt.org/drvesx.html&lt;/a&gt; and nothing \
is mentioned there.&lt;br&gt; &lt;br&gt;Thank You,&lt;br&gt;Regards,&lt;br&gt;Sherif&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20101114113438</emailId><senderName>Andrea Turli</senderName><senderEmail>andrea.turli@eng.it</senderEmail><timestampReceived>2010-11-14 11:34:38-0400</timestampReceived><subject>[libvirt-users] java binding and virtualbox-ose</subject><body>

I'm trying to connect to vbox hypervisor on an Ubuntu 10.04 machine
through libvirt java binding (libvirt-java-0.4.6) by simply invoking:

Connect conn = new Connect("vbox:///session", false);
but I got this exception:

libvir: warning : Failed to find the interface: Is the daemon running ?
libvir: Remote error : unable to connect to
'/var/run/libvirt/libvirt-sock': Connection refused
libvir: warning : Failed to find a node driver: Is the libvirtd daemon running ?
libvir: Remote error : unable to connect to
'/var/run/libvirt/libvirt-sock': Connection refused
libvir: warning : Failed to find a secret storage driver: Is the
daemon running ?
org.libvirt.LibvirtException: Failed to find a secret storage driver:
Is the daemon running ?
    at org.libvirt.ErrorHandler.processError(ErrorHandler.java:28)
    at org.libvirt.Connect.&lt;init&gt;(Connect.java:195)
    at VBOX.main(VBOX.java:32)
Otherwise, from virsh, I can correctly connect to the vbox hypervisor:

$ export LIBVIRT_DEBUG=1
$virsh -c vbox:///session list --all
11:37:18.318: debug : virInitialize:336 : register drivers
11:37:18.318: debug : virRegisterDriver:837 : registering Test as driver 0
11:37:18.318: debug : virRegisterNetworkDriver:675 : registering Test
as network driver 0
11:37:18.318: debug : virRegisterInterfaceDriver:706 : registering
Test as interface driver 0
11:37:18.318: debug : virRegisterStorageDriver:737 : registering Test
as storage driver 0
11:37:18.318: debug : virRegisterDeviceMonitor:768 : registering Test
as device driver 0
11:37:18.318: debug : virRegisterSecretDriver:799 : registering Test
as secret driver 0
11:37:18.318: debug : virRegisterDriver:837 : registering Xen as driver 1
11:37:18.318: debug : virRegisterDriver:837 : registering OPENVZ as driver 2
11:37:18.336: debug : vboxRegister:83 : VBoxCGlueInit found API
version: 3.1.6 (3001006)
11:37:18.336: debug : vboxRegister:100 : VirtualBox API version: 3.1
11:37:18.336: debug : virRegisterDriver:837 : registering VBOX as driver 3
11:37:18.336: debug : virRegisterNetworkDriver:675 : registering VBOX
as network driver 1
11:37:18.336: debug : virRegisterStorageDriver:737 : registering VBOX
as storage driver 1
11:37:18.336: debug : virRegisterDriver:837 : registering remote as driver 4
11:37:18.336: debug : virRegisterNetworkDriver:675 : registering
remote as network driver 2
11:37:18.336: debug : virRegisterInterfaceDriver:706 : registering
remote as interface driver 1
11:37:18.336: debug : virRegisterStorageDriver:737 : registering
remote as storage driver 2
11:37:18.336: debug : virRegisterDeviceMonitor:768 : registering
remote as device driver 1
11:37:18.336: debug : virRegisterSecretDriver:799 : registering remote
as secret driver 1
11:37:18.336: debug : virConnectOpenAuth:1337 : name=vbox:///session,
auth=0x231638, flags=0
11:37:18.336: debug : do_open:1106 : name "vbox:///session" to URI components:
  scheme vbox
  opaque (null)
  authority (null)
  server (null)
  user (null)
  port 0
  path /session

11:37:18.336: debug : do_open:1116 : trying driver 0 (Test) ...
11:37:18.336: debug : do_open:1122 : driver 0 Test returned DECLINED
11:37:18.336: debug : do_open:1116 : trying driver 1 (Xen) ...
11:37:18.336: debug : do_open:1122 : driver 1 Xen returned DECLINED
11:37:18.336: debug : do_open:1116 : trying driver 2 (OPENVZ) ...
11:37:18.336: debug : do_open:1122 : driver 2 OPENVZ returned DECLINED
11:37:18.336: debug : do_open:1116 : trying driver 3 (VBOX) ...
11:37:18.589: debug : vboxOpen:836 : in vboxOpen
11:37:18.589: debug : do_open:1122 : driver 3 VBOX returned SUCCESS
11:37:18.589: debug : do_open:1142 : network driver 0 Test returned DECLINED
11:37:18.589: debug : vboxNetworkOpen:5439 : network initialized
11:37:18.589: debug : do_open:1142 : network driver 1 VBOX returned SUCCESS
11:37:18.589: debug : do_open:1161 : interface driver 0 Test returned DECLINED
11:37:18.589: debug : doRemoteOpen:564 : proceeding with name = vbox:///session
11:37:18.590: debug : remoteIO:8455 : Do proc=66 serial=0 length=28 wait=(nil)
11:37:18.590: debug : remoteIO:8517 : We have the buck 66 0xb7516008 0xb7516008
11:37:18.595: debug : remoteIODecodeMessageLength:7939 : Got length,
now need 64 total (60 more)
11:37:18.595: debug : remoteIOEventLoop:8381 : Giving up the buck 66
0xb7516008 (nil)
11:37:18.595: debug : remoteIO:8548 : All done with our call 66 (nil) 0xb7516008
11:37:18.596: debug : remoteIO:8455 : Do proc=1 serial=1 length=56 wait=(nil)
11:37:18.596: debug : remoteIO:8517 : We have the buck 1 0x95eb908 0x95eb908
11:37:18.659: debug : remoteIOEventLoop:8402 : Giving up the buck due
to I/O error 1 0x95eb908 (nil)
11:37:18.660: debug : do_open:1161 : interface driver 1 remote returned ERROR
11:37:18.660: debug : do_open:1181 : storage driver 0 Test returned DECLINED
11:37:18.660: debug : vboxStorageOpen:6191 : vbox storage initialized
11:37:18.660: debug : do_open:1181 : storage driver 1 VBOX returned SUCCESS
11:37:18.660: debug : do_open:1201 : node driver 0 Test returned DECLINED
11:37:18.660: debug : doRemoteOpen:564 : proceeding with name = vbox:///session
11:37:18.661: debug : do_open:1201 : node driver 1 remote returned ERROR
11:37:18.661: debug : do_open:1228 : secret driver 0 Test returned DECLINED
11:37:18.661: debug : doRemoteOpen:564 : proceeding with name = vbox:///session
11:37:18.661: debug : do_open:1228 : secret driver 1 remote returned ERROR
11:37:18.661: debug : virConnectNumOfDomains:1714 : conn=0x95a1910
11:37:18.663: debug : virConnectNumOfDefinedDomains:4554 : conn=0x95a1910
11:37:18.664: debug : virConnectListDefinedDomains:4593 :
conn=0x95a1910, names=0x95e9b58, maxnames=1
 Id Name                 State
----------------------------------
11:37:18.666: debug : virDomainLookupByName:1974 : conn=0x95a1910, name=tty
11:37:18.669: debug : virGetDomain:345 : New hash entry 0x95dad48
11:37:18.669: debug : virDomainGetInfo:2825 : domain=0x95dad48, info=0xbfeca708
  - tty                  shut off
11:37:18.673: debug : virDomainFree:2062 : domain=0x95dad48
11:37:18.673: debug : virUnrefDomain:422 : unref domain 0x95dad48 tty 1
11:37:18.673: debug : virReleaseDomain:376 : release domain 0x95dad48 tty
11:37:18.673: debug : virReleaseDomain:392 : unref connection 0x95a1910 2

11:37:18.673: debug : virConnectClose:1355 : conn=0x95a1910
11:37:18.673: debug : virUnrefConnect:259 : unref connection 0x95a1910 1
11:37:18.673: debug : vboxNetworkClose:5448 : network uninitialized
11:37:18.673: debug : vboxStorageClose:6200 : vbox storage uninitialized
11:37:18.673: debug : vboxClose:843 : VBOX: in vboxClose
11:37:18.681: debug : virReleaseConnect:216 : release connection 0x95a1910
even if with some warnings/errors.

Do you have any hint? Thank you

-- 
Andrea Turli
Ricercatore
Direzione Ricerca e Innovazione
andrea.turli@eng.it

Engineering Ingegneria Informatica spa
Via Riccardo Morandi, 32 00148 Roma (RM)
Tel. +39 06 8307 4710
Fax +39 06 8307 4200
www.eng.it

</body></email><email><emailId>20101114204352</emailId><senderName>Andrea Turli</senderName><senderEmail>andrea.turli@eng.it</senderEmail><timestampReceived>2010-11-14 20:43:52-0400</timestampReceived><subject>[libvirt-users]  java binding and virtualbox-ose</subject><body>

I'm trying to connect to vbox hypervisor on an Ubuntu 10.04 machine
through libvirt java binding (libvirt-java-0.4.6) by simply invoking:

Connect conn = new Connect("vbox:///session", false);
but I got this exception:

libvir: warning : Failed to find the interface: Is the daemon running ?
libvir: Remote error : unable to connect to
'/var/run/libvirt/libvirt-sock': Connection refused
libvir: warning : Failed to find a node driver: Is the libvirtd daemon running ?
libvir: Remote error : unable to connect to
'/var/run/libvirt/libvirt-sock': Connection refused
libvir: warning : Failed to find a secret storage driver: Is the
daemon running ?
org.libvirt.LibvirtException: Failed to find a secret storage driver:
Is the daemon running ?
   at org.libvirt.ErrorHandler.processError(ErrorHandler.java:28)
   at org.libvirt.Connect.&lt;init&gt;(Connect.java:195)
   at VBOX.main(VBOX.java:32)
Otherwise, from virsh, I can correctly connect to the vbox hypervisor:

$ export LIBVIRT_DEBUG=1
$virsh -c vbox:///session list --all
11:37:18.318: debug : virInitialize:336 : register drivers
11:37:18.318: debug : virRegisterDriver:837 : registering Test as driver 0
11:37:18.318: debug : virRegisterNetworkDriver:675 : registering Test
as network driver 0
11:37:18.318: debug : virRegisterInterfaceDriver:706 : registering
Test as interface driver 0
11:37:18.318: debug : virRegisterStorageDriver:737 : registering Test
as storage driver 0
11:37:18.318: debug : virRegisterDeviceMonitor:768 : registering Test
as device driver 0
11:37:18.318: debug : virRegisterSecretDriver:799 : registering Test
as secret driver 0
11:37:18.318: debug : virRegisterDriver:837 : registering Xen as driver 1
11:37:18.318: debug : virRegisterDriver:837 : registering OPENVZ as driver 2
11:37:18.336: debug : vboxRegister:83 : VBoxCGlueInit found API
version: 3.1.6 (3001006)
11:37:18.336: debug : vboxRegister:100 : VirtualBox API version: 3.1
11:37:18.336: debug : virRegisterDriver:837 : registering VBOX as driver 3
11:37:18.336: debug : virRegisterNetworkDriver:675 : registering VBOX
as network driver 1
11:37:18.336: debug : virRegisterStorageDriver:737 : registering VBOX
as storage driver 1
11:37:18.336: debug : virRegisterDriver:837 : registering remote as driver 4
11:37:18.336: debug : virRegisterNetworkDriver:675 : registering
remote as network driver 2
11:37:18.336: debug : virRegisterInterfaceDriver:706 : registering
remote as interface driver 1
11:37:18.336: debug : virRegisterStorageDriver:737 : registering
remote as storage driver 2
11:37:18.336: debug : virRegisterDeviceMonitor:768 : registering
remote as device driver 1
11:37:18.336: debug : virRegisterSecretDriver:799 : registering remote
as secret driver 1
11:37:18.336: debug : virConnectOpenAuth:1337 : name=vbox:///session,
auth=0x231638, flags=0
11:37:18.336: debug : do_open:1106 : name "vbox:///session" to URI components:
 scheme vbox
 opaque (null)
 authority (null)
 server (null)
 user (null)
 port 0
 path /session

11:37:18.336: debug : do_open:1116 : trying driver 0 (Test) ...
11:37:18.336: debug : do_open:1122 : driver 0 Test returned DECLINED
11:37:18.336: debug : do_open:1116 : trying driver 1 (Xen) ...
11:37:18.336: debug : do_open:1122 : driver 1 Xen returned DECLINED
11:37:18.336: debug : do_open:1116 : trying driver 2 (OPENVZ) ...
11:37:18.336: debug : do_open:1122 : driver 2 OPENVZ returned DECLINED
11:37:18.336: debug : do_open:1116 : trying driver 3 (VBOX) ...
11:37:18.589: debug : vboxOpen:836 : in vboxOpen
11:37:18.589: debug : do_open:1122 : driver 3 VBOX returned SUCCESS
11:37:18.589: debug : do_open:1142 : network driver 0 Test returned DECLINED
11:37:18.589: debug : vboxNetworkOpen:5439 : network initialized
11:37:18.589: debug : do_open:1142 : network driver 1 VBOX returned SUCCESS
11:37:18.589: debug : do_open:1161 : interface driver 0 Test returned DECLINED
11:37:18.589: debug : doRemoteOpen:564 : proceeding with name = vbox:///session
11:37:18.590: debug : remoteIO:8455 : Do proc=66 serial=0 length=28 wait=(nil)
11:37:18.590: debug : remoteIO:8517 : We have the buck 66 0xb7516008 0xb7516008
11:37:18.595: debug : remoteIODecodeMessageLength:7939 : Got length,
now need 64 total (60 more)
11:37:18.595: debug : remoteIOEventLoop:8381 : Giving up the buck 66
0xb7516008 (nil)
11:37:18.595: debug : remoteIO:8548 : All done with our call 66 (nil) 0xb7516008
11:37:18.596: debug : remoteIO:8455 : Do proc=1 serial=1 length=56 wait=(nil)
11:37:18.596: debug : remoteIO:8517 : We have the buck 1 0x95eb908 0x95eb908
11:37:18.659: debug : remoteIOEventLoop:8402 : Giving up the buck due
to I/O error 1 0x95eb908 (nil)
11:37:18.660: debug : do_open:1161 : interface driver 1 remote returned ERROR
11:37:18.660: debug : do_open:1181 : storage driver 0 Test returned DECLINED
11:37:18.660: debug : vboxStorageOpen:6191 : vbox storage initialized
11:37:18.660: debug : do_open:1181 : storage driver 1 VBOX returned SUCCESS
11:37:18.660: debug : do_open:1201 : node driver 0 Test returned DECLINED
11:37:18.660: debug : doRemoteOpen:564 : proceeding with name = vbox:///session
11:37:18.661: debug : do_open:1201 : node driver 1 remote returned ERROR
11:37:18.661: debug : do_open:1228 : secret driver 0 Test returned DECLINED
11:37:18.661: debug : doRemoteOpen:564 : proceeding with name = vbox:///session
11:37:18.661: debug : do_open:1228 : secret driver 1 remote returned ERROR
11:37:18.661: debug : virConnectNumOfDomains:1714 : conn=0x95a1910
11:37:18.663: debug : virConnectNumOfDefinedDomains:4554 : conn=0x95a1910
11:37:18.664: debug : virConnectListDefinedDomains:4593 :
conn=0x95a1910, names=0x95e9b58, maxnames=1
 Id Name                 State
----------------------------------
11:37:18.666: debug : virDomainLookupByName:1974 : conn=0x95a1910, name=tty
11:37:18.669: debug : virGetDomain:345 : New hash entry 0x95dad48
11:37:18.669: debug : virDomainGetInfo:2825 : domain=0x95dad48, info=0xbfeca708
 - tty                  shut off
11:37:18.673: debug : virDomainFree:2062 : domain=0x95dad48
11:37:18.673: debug : virUnrefDomain:422 : unref domain 0x95dad48 tty 1
11:37:18.673: debug : virReleaseDomain:376 : release domain 0x95dad48 tty
11:37:18.673: debug : virReleaseDomain:392 : unref connection 0x95a1910 2

11:37:18.673: debug : virConnectClose:1355 : conn=0x95a1910
11:37:18.673: debug : virUnrefConnect:259 : unref connection 0x95a1910 1
11:37:18.673: debug : vboxNetworkClose:5448 : network uninitialized
11:37:18.673: debug : vboxStorageClose:6200 : vbox storage uninitialized
11:37:18.673: debug : vboxClose:843 : VBOX: in vboxClose
11:37:18.681: debug : virReleaseConnect:216 : release connection 0x95a1910
even if with some warnings/errors.

Do you have any hint? Thank you

-- 
Andrea Turli
Ricercatore
Direzione Ricerca e Innovazione
andrea.turli@eng.it

Engineering Ingegneria Informatica spa
Via Riccardo Morandi, 32 00148 Roma (RM)
Tel. +39 06 8307 4710
Fax +39 06 8307 4200
www.eng.it

</body></email><email><emailId>20101114224734</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-11-14 22:47:34-0400</timestampReceived><subject>Re: [libvirt-users] java binding and virtualbox-ose</subject><body>

2010/11/14 Andrea Turli &lt;andrea.turli@eng.it&gt;:
&gt; I'm trying to connect to vbox hypervisor on an Ubuntu 10.04 machine
&gt; through libvirt java binding (libvirt-java-0.4.6) by simply invoking:
&gt;
&gt; Connect conn = new Connect("vbox:///session", false);
&gt; but I got this exception:
&gt;
&gt; libvir: warning : Failed to find the interface: Is the daemon running ?
&gt; libvir: Remote error : unable to connect to
&gt; '/var/run/libvirt/libvirt-sock': Connection refused
&gt; libvir: warning : Failed to find a node driver: Is the libvirtd daemon running ?
&gt; libvir: Remote error : unable to connect to
&gt; '/var/run/libvirt/libvirt-sock': Connection refused
&gt; libvir: warning : Failed to find a secret storage driver: Is the
&gt; daemon running ?
&gt; org.libvirt.LibvirtException: Failed to find a secret storage driver:
&gt; Is the daemon running ?
&gt;    at org.libvirt.ErrorHandler.processError(ErrorHandler.java:28)
&gt;    at org.libvirt.Connect.&lt;init&gt;(Connect.java:195)
&gt;    at VBOX.main(VBOX.java:32)
&gt;

This is a bit tricky and took me a moment to understand.

libvirt's error handling can report warnings. This feature is not used
often in libvirt, basically only in the virConnectOpen* functions to
report missing subdrivers.

The Java bindings now have two problems:

1) The error processing in the bindings is done unconditional, it
always checks for an error even if the called function succeeded. Also
this results in an unnecessary call to the JNA interface for each
successful libvirt call.

2) The error processing raises an exception for all error, even for
errors with level VIR_ERR_WARNING.

This results in the exception you see. The call to virConnectOpen
succeeds but libvirt reports a warning about missing sudrivers and the
bindings turn this into an exception.

You can apply this workaround to the Java bindings code:


diff --git a/src/main/java/org/libvirt/ErrorHandler.java
b/src/main/java/org/libvirt/ErrorHandler.java
index e30291b..de66518 100644
--- a/src/main/java/org/libvirt/ErrorHandler.java
+++ b/src/main/java/org/libvirt/ErrorHandler.java
@@ -25,7 +25,11 @@ public class ErrorHandler {
         if (errorCode &gt; 0) {
             Error error = new Error(vError);
             libvirt.virResetLastError();
-            throw new LibvirtException(error);
+
+            /* FIXME: Don't throw exceptions for VIR_ERR_WARNING
level errors */
+            if (error.getLevel() == Error.ErrorLevel.VIR_ERR_ERROR) {
+                throw new LibvirtException(error);
+            }
         }
     }
 }


The actually fix is more involved as it includes making the error
processing conditional.

Matthias

</body></email><email><emailId>20101113084055</emailId><senderName>Anton Gorlov</senderName><senderEmail>stalker@altlinux.ru</senderEmail><timestampReceived>2010-11-13 08:40:55-0400</timestampReceived><subject>[libvirt-users] network filtering</subject><body>

I try to add some rules to filtering network, example
&lt;filterref filter='clean-traffic'/&gt; or
&lt;filterref filter='no-ip-spoofing'/&gt;
  and vm not starting with message

virsh start freebsd8.2
error: Failed to start domain freebsd8.2
error: internal error IP parameter must be given since libvirt was not 
compiled with IP address learning support

  what do I do wrong?

libvirtd --version
libvirtd (libvirt) 0.8.4

</body></email><email><emailId>20101116133043</emailId><senderName>Chris Phillips</senderName><senderEmail>chris@untrepid.com</senderEmail><timestampReceived>2010-11-16 13:30:43-0400</timestampReceived><subject>[libvirt-users] Changing default nic and storage types</subject><body>

Hi,

Simple question that I can't track down any notable discussion about,
let alone an answer...

Is it possible to define what the "default" nic and storage types are?
I am deploying images out of cobbler using koan and all of them are
running virtio wherever applicable, but this is not the default, and
at present there is no way within koan or cobbler to define what type
of devices they should be. I've hard coded this device type
declaration into koan, but don't like that in the slightest, and would
typically expect to be able to just set "default=virtio" in a libvirt
config file somewhere.

I fear I'm actually not missing anything and it's just hard coded for
the most compatible device with no recourse to override it.

Thanks

Chris

</body></email><email><emailId>20101118101707</emailId><senderName>Benjamin Hagemann</senderName><senderEmail>benny@benny.de</senderEmail><timestampReceived>2010-11-18 10:17:07-0400</timestampReceived><subject>[libvirt-users] driver type for .vdi images?</subject><body>


Hello libvirt experts,

I use libvirt (0.7.5-5ubuntu27.7) with KVM / qemu (0.12.3+noroms-0ubuntu9.2).
Some machines use raw images but same use Virtualbox images (.vdi).
Since last Ubuntu 10.04 LTS update I can not start the vdi-images.

The "driver name= type=" option was new.

  &lt;devices&gt;
    &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;
    &lt;disk type='file' device='disk'&gt;

      &lt;driver name='qemu' type='vdi'/&gt;

      &lt;source file='/path/image.vdi'/&gt;
      &lt;target dev='hda' bus='ide'/&gt;
    &lt;/disk&gt;


But when I try "type=vdi" I got in the Log-File:

  libvir: Security Labeling error : error calling aa_change_profile()

so I checked:

  cat vdi-machine.xml | /usr/lib/libvirt/virt-aa-helper -r --uuid
libvirt-XXXXXXXX-XXXXX-XXXX-XXXX-XXXXXXXXXXXX --dryrun -p 0
  libvir: Domain Config error : internal error unknown disk format 'vdi'
for image.vdi
  virt-aa-helper: error: invalid VM definition

Next I checked libvirt.org:
http://libvirt.org/storage.html

  Valid volume format types
  raw, bochs, cloop, cow, dmg, iso, qcow, qcow2, vmdk, vpc

=&gt; But what is the right type for .vdi-Images?

By the way, the examples at this site does not know the "driver name=
type=" option.

Thank you very much.

-- 
Kind regards,

	Benny

gpg     0xFC505AB0
jabber  benny@benny.de
sip     benny@benny.de

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20101119175133</emailId><senderName>Mark Foster</senderName><senderEmail>mark@foster.cc</senderEmail><timestampReceived>2010-11-19 17:51:33-0400</timestampReceived><subject>[libvirt-users] libvirtd &amp; dnsmasq</subject><body>

libvirtd is starting dnsmasq! This is on RHEL5.5

I don't see it mentioned in /etc/init.d/libvirtd or /etc/libvirt/* or
/etc/sysconfig/libvirtd

 4337 ?        S      0:00 /usr/sbin/dnsmasq --strict-order
--bind-interfaces --pid-file=/var/run/libvirt/network/default.pid
--conf-file=  --listen-address 192.168.122.1 --except-interface lo
--dhcp-range 192.168.122.2,192.168.122.254 --dhcp-lease-max=253

How can I properly disable this funcationality? (I'm running dnsmasq for
other purposes on the host, and the libvirtd incantation conflicts).

Thanks.
-- 
Mark D. Foster &lt;mark@foster.cc&gt;
http://mark.foster.cc/ |  http://www.freegeekseattle.org/

</body></email><email><emailId>20101120104236</emailId><senderName>Anton Gorlov</senderName><senderEmail>stalker@altlinux.ru</senderEmail><timestampReceived>2010-11-20 10:42:36-0400</timestampReceived><subject>[libvirt-users] libvirt filters</subject><body>

I used filters like clean-traffic. The filters are working, but I can 
not see the rules in  iptables -L. How can I look through the rules?

</body></email><email><emailId>20101120114943</emailId><senderName>Robin Green</senderName><senderEmail>greenrd@greenrd.org</senderEmail><timestampReceived>2010-11-20 11:49:43-0400</timestampReceived><subject>Re: [libvirt-users] libvirt filters</subject><body>

Have you tried using the -t option to iptables?

For example:
iptables -t nat -L

See man iptables for more details.
-- 
Robin

At Sat, 20 Nov 2010 13:42:36 +0300,
Anton Gorlov wrote:
&gt; 
&gt; I used filters like clean-traffic. The filters are working, but I can 
&gt; not see the rules in  iptables -L. How can I look through the rules?
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; 

</body></email><email><emailId>20101121101501</emailId><senderName>Anton Gorlov</senderName><senderEmail>stalker@altlinux.ru</senderEmail><timestampReceived>2010-11-21 10:15:01-0400</timestampReceived><subject>Re: [libvirt-users] libvirt filters</subject><body>

20.11.2010 14:49, Robin Green :
&gt; Have you tried using the -t option to iptables?
&gt;
Yes, of course.

I made a test filter
===
&lt;filter name='test' chain='ipv4'&gt;

     &lt;!-- drop if destination IP address is in the 10.35.40.6 --&gt;
     &lt;rule action='drop' direction='out'&gt;
         &lt;ip dstipaddr='10.35.40.6' dstipmask='32' /&gt;
     &lt;/rule&gt;

     &lt;!-- not doing anything with receiving side ... --&gt;
&lt;/filter&gt;
===

the rule is working, but I can not see it in any of the tables

</body></email><email><emailId>20101122024627</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2010-11-22 02:46:27-0400</timestampReceived><subject>Re: [libvirt-users] libvirt filters</subject><body>

 20101121 18:15, Anton Gorlov :
&gt; 20.11.2010 14:49, Robin Green :
&gt; &gt; Have you tried using the -t option to iptables?
&gt; &gt; 
&gt; Yes, of course.
&gt; 
&gt; I made a test filter
&gt; ===
&gt; &lt;filter name='test' chain='ipv4'&gt;
&gt; 
&gt; &lt;!-- drop if destination IP address is in the 10.35.40.6 --&gt;
&gt; &lt;rule action='drop' direction='out'&gt;
&gt; &lt;ip dstipaddr='10.35.40.6' dstipmask='32' /&gt;
&gt; &lt;/rule&gt;
&gt; 
&gt; &lt;!-- not doing anything with receiving side ... --&gt;
&gt; &lt;/filter&gt;
&gt; ===
&gt; 
&gt; the rule is working, but I can not see it in any of the tables
&gt; 

#ebtables -t nat -L

for more info, take reference here:
http://libvirt.org/git/?p=libvirt-tck.git;a=tree;f=scripts/nwfilter/nwfilterxml2fwallout;h=cdf88dc5dbe32dcacb6f069e1ce714d7afaa097d;hb=HEAD


Regards

- Osier
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users


</body></email><email><emailId>20101119181745</emailId><senderName>James M Leddy</senderName><senderEmail>james.leddy@redhat.com</senderEmail><timestampReceived>2010-11-19 18:17:45-0400</timestampReceived><subject>Re: [libvirt-users] libvirtd &amp; dnsmasq</subject><body>

On Fri, Nov 19, 2010 at 09:51:33AM -0800, Mark Foster wrote:
&gt; libvirtd is starting dnsmasq! This is on RHEL5.5
&gt; 
&gt; I don't see it mentioned in /etc/init.d/libvirtd or /etc/libvirt/* or
&gt; /etc/sysconfig/libvirtd
&gt; 
&gt;  4337 ?        S      0:00 /usr/sbin/dnsmasq --strict-order
&gt; --bind-interfaces --pid-file=/var/run/libvirt/network/default.pid
&gt; --conf-file=  --listen-address 192.168.122.1 --except-interface lo
&gt; --dhcp-range 192.168.122.2,192.168.122.254 --dhcp-lease-max=253
&gt; 
&gt; How can I properly disable this funcationality? (I'm running dnsmasq for
&gt; other purposes on the host, and the libvirtd incantation conflicts).

It's because of this:

---
postinstall scriptlet (using /bin/sh):
/sbin/ldconfig

# We want to install the default network for initial RPM installs
# or on the first upgrade from a non-network aware libvirt only.
# We check this by looking to see if the daemon is already installed
/sbin/chkconfig --list libvirtd 1&gt;/dev/null 2&gt;&amp;1
if [ $? != 0 -a ! -f /etc/libvirt/qemu/networks/default.xml ]
then
    UUID=`/usr/bin/uuidgen`
    sed -e "s,&lt;/name&gt;,&lt;/name&gt;\n  &lt;uuid&gt;$UUID&lt;/uuid&gt;," \
         &lt; /usr/share/libvirt/networks/default.xml \
         &gt; /etc/libvirt/qemu/networks/default.xml
    ln -s ../default.xml /etc/libvirt/qemu/networks/autostart/default.xml
fi

/sbin/chkconfig --add libvirtd
---

I put in a request to get it removed.


-- 
James M. Leddy
Technical Account Manager
Red Hat Inc.
work: 212-510-4119
cell: 631-891-8703

</body></email><email><emailId>20101120043630</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-11-20 04:36:30-0400</timestampReceived><subject>Re: [libvirt-users] libvirtd &amp; dnsmasq</subject><body>

On 20/11/2010, at 4:51 AM, Mark Foster wrote:
&gt; libvirtd is starting dnsmasq! This is on RHEL5.5

Yeah.  When libvirt is installed, it creates a default NAT network for guests to use.

But, it's not hard to configure a system with dnsmasq already installed, to not have \
it get confused by libvirt. :)

There's a wiki page (very short) with the two lines to change here:

  http://wiki.libvirt.org/page/Libvirtd_and_dnsmasq

Hope that helps. :)

Regards and best wishes,

Justin Clift


</body></email><email><emailId>20101117063849</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2010-11-17 06:38:49-0400</timestampReceived><subject>Re: [libvirt-users] Changing default nic and storage types</subject><body>

 20101116 21:30, Chris Phillips :
&gt; Hi,
&gt;
&gt; Simple question that I can't track down any notable discussion about,
&gt; let alone an answer...
&gt;
&gt; Is it possible to define what the "default" nic and storage types are?
&gt; I am deploying images out of cobbler using koan and all of them are
&gt; running virtio wherever applicable, but this is not the default, and
&gt; at present there is no way within koan or cobbler to define what type
&gt; of devices they should be. I've hard coded this device type
&gt; declaration into koan, but don't like that in the slightest, and would
&gt; typically expect to be able to just set "default=virtio" in a libvirt
&gt; config file somewhere.
&gt;
&gt; I fear I'm actually not missing anything and it's just hard coded for
&gt; the most compatible device with no recourse to override it.
&gt;

It seems reasonable to add a new preference in "/etc/libvirt/qemu.conf".
Now libvirt use "ide" as the bus type for disk device if it fails on
the series detections.

- Osier
&gt; Thanks
&gt;
&gt; Chris
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20101117064932</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-11-17 06:49:32-0400</timestampReceived><subject>Re: [libvirt-users] Changing default nic and storage types</subject><body>

On 17/11/2010, at 5:38 PM, Osier Yang wrote:
&gt;  20101116 21:30, Chris Phillips :
&gt;&gt; Hi,
&gt;&gt; 
&gt;&gt; Simple question that I can't track down any notable discussion about,
&gt;&gt; let alone an answer...
&gt;&gt; 
&gt;&gt; Is it possible to define what the "default" nic and storage types are?
&gt;&gt; I am deploying images out of cobbler using koan and all of them are
&gt;&gt; running virtio wherever applicable, but this is not the default, and
&gt;&gt; at present there is no way within koan or cobbler to define what type
&gt;&gt; of devices they should be. I've hard coded this device type
&gt;&gt; declaration into koan, but don't like that in the slightest, and would
&gt;&gt; typically expect to be able to just set "default=virtio" in a libvirt
&gt;&gt; config file somewhere.
&gt;&gt; 
&gt;&gt; I fear I'm actually not missing anything and it's just hard coded for
&gt;&gt; the most compatible device with no recourse to override it.
&gt;&gt; 
&gt; 
&gt; It seems reasonable to add a new preference in "/etc/libvirt/qemu.conf".
&gt; Now libvirt use "ide" as the bus type for disk device if it fails on
&gt; the series detections.

Might also be well placed as something in the "to be written" user
preferences file too, so each user can specific their own defaults.

</body></email><email><emailId>20101117115208</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-11-17 11:52:08-0400</timestampReceived><subject>Re: [libvirt-users] Changing default nic and storage types</subject><body>

On Wed, Nov 17, 2010 at 02:38:49PM +0800, Osier Yang wrote:
&gt;  20101116 21:30, Chris Phillips :
&gt; &gt;Hi,
&gt; &gt;
&gt; &gt;Simple question that I can't track down any notable discussion about,
&gt; &gt;let alone an answer...
&gt; &gt;
&gt; &gt;Is it possible to define what the "default" nic and storage types are?
&gt; &gt;I am deploying images out of cobbler using koan and all of them are
&gt; &gt;running virtio wherever applicable, but this is not the default, and
&gt; &gt;at present there is no way within koan or cobbler to define what type
&gt; &gt;of devices they should be. I've hard coded this device type
&gt; &gt;declaration into koan, but don't like that in the slightest, and would
&gt; &gt;typically expect to be able to just set "default=virtio" in a libvirt
&gt; &gt;config file somewhere.
&gt; &gt;
&gt; &gt;I fear I'm actually not missing anything and it's just hard coded for
&gt; &gt;the most compatible device with no recourse to override it.
&gt; &gt;
&gt; 
&gt; It seems reasonable to add a new preference in "/etc/libvirt/qemu.conf".
&gt; Now libvirt use "ide" as the bus type for disk device if it fails on
&gt; the series detections.

No, this doesn't belong in libvirt, because there is no default that
you can choose which is best for all OS. Any change in global defaults 
is just moving the problem around, not fixing it.  The long term
solution for this with apps using libvirt is the libosinfo library
which is intended to provide a set of metadata files describing the
defaults for every known operating system, as well as letting the
host admin customize those per OS defaults.  Apps that provision
VMs would use libosinfo when building up their XML description

Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20101114201902</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2010-11-14 20:19:02-0400</timestampReceived><subject>Re: [libvirt-users] network filtering</subject><body>

 20101113 16:40, Anton Gorlov :
&gt; I try to add some rules to filtering network, example
&gt; &lt;filterref filter='clean-traffic'/&gt; or
&gt; &lt;filterref filter='no-ip-spoofing'/&gt;
&gt; and vm not starting with message
&gt;
&gt; virsh start freebsd8.2
&gt; error: Failed to start domain freebsd8.2
&gt; error: internal error IP parameter must be given since libvirt was not
&gt; compiled with IP address learning support
&gt;
&gt; what do I do wrong?
&gt;

Just as the error says, your libvirt is not compiled with "libpcap",
filter "no-ip-spoofing" has a variable "$IP", which needs "IP learning"
of network filter driver to generate automatically.

To work around it, recompile it with "--with-libpcap" or set "$IP"
by hand.

- Osier
&gt; libvirtd --version
&gt; libvirtd (libvirt) 0.8.4
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20101115085147</emailId><senderName>Anton Gorlov</senderName><senderEmail>stalker@altlinux.ru</senderEmail><timestampReceived>2010-11-15 08:51:47-0400</timestampReceived><subject>Re: [libvirt-users] network filtering</subject><body>

14.11.2010 23:19, Osier Yang :

&gt; Just as the error says, your libvirt is not compiled with "libpcap",
&gt; filter "no-ip-spoofing" has a variable "$IP", which needs "IP learning"
&gt; of network filter driver to generate automatically.
&gt; To work around it, recompile it with "--with-libpcap" or set "$IP"
&gt; by hand.

today evening, I'll try to rebuild it with --with-libpcap.
Should I set "$IP" to guest-server ip or to host-node's ?

</body></email><email><emailId>20101117074210</emailId><senderName>Anton Gorlov</senderName><senderEmail>stalker@altlinux.ru</senderEmail><timestampReceived>2010-11-17 07:42:10-0400</timestampReceived><subject>Re: [libvirt-users] network filtering</subject><body>

14.11.2010 23:19, Osier Yang :

&gt;&gt; virsh start freebsd8.2
&gt;&gt; error: Failed to start domain freebsd8.2
&gt;&gt; error: internal error IP parameter must be given since libvirt was not
&gt;&gt; compiled with IP address learning support
&gt;&gt; what do I do wrong?
&gt; Just as the error says, your libvirt is not compiled with "libpcap",
&gt; filter "no-ip-spoofing" has a variable "$IP", which needs "IP learning"
&gt; of network filter driver to generate automatically.
&gt; To work around it, recompile it with "--with-libpcap" or set "$IP"
&gt; by hand.

This filters working in kernel space or user?

</body></email><email><emailId>20101117074634</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2010-11-17 07:46:34-0400</timestampReceived><subject>Re: [libvirt-users] network filtering</subject><body>

 20101117 15:42, Anton Gorlov :
&gt; 14.11.2010 23:19, Osier Yang :
&gt;
&gt;&gt;&gt; virsh start freebsd8.2
&gt;&gt;&gt; error: Failed to start domain freebsd8.2
&gt;&gt;&gt; error: internal error IP parameter must be given since libvirt was not
&gt;&gt;&gt; compiled with IP address learning support
&gt;&gt;&gt; what do I do wrong?
&gt;&gt; Just as the error says, your libvirt is not compiled with "libpcap",
&gt;&gt; filter "no-ip-spoofing" has a variable "$IP", which needs "IP learning"
&gt;&gt; of network filter driver to generate automatically.
&gt;&gt; To work around it, recompile it with "--with-libpcap" or set "$IP"
&gt;&gt; by hand.
&gt;
&gt; This filters working in kernel space or user?

it's based on iptables/ebtables, and also ip6tables in future.

so, it uses these tools in userspace, works with according
kernel module support, e.g. iptables_nat, ebtables, etc.

- Osier

</body></email><email><emailId>20101117080753</emailId><senderName>Anton Gorlov</senderName><senderEmail>stalker@altlinux.ru</senderEmail><timestampReceived>2010-11-17 08:07:53-0400</timestampReceived><subject>Re: [libvirt-users] network filtering</subject><body>

17.11.2010 10:46, Osier Yang :

&gt;&gt; This filters working in kernel space or user?
&gt; it's based on iptables/ebtables, and also ip6tables in future.
&gt; so, it uses these tools in userspace, works with according
&gt; kernel module support, e.g. iptables_nat, ebtables, etc.

Hmm, I rebuild with libpcap
==
ldd `which virsh` | grep pcap
libpcap.so.0.8 =&gt; /usr/lib64/libpcap.so.0.8 (0x00007fb631f4b000)
==

guest start with no warnigs (&lt;filterref filter='clean-traffic'/&gt;). 
iptables -L not show me rules with filtering. And dhcp-client on guest 
not working. if I remove  this filter dhcpclient working fine. Guest 
with static ip (&lt;host mac='52:54:00:43:67:e8' ip='192.168.122.26' /&gt; in 
default.xml)

</body></email><email><emailId>20101115095815</emailId><senderName>Andrea Turli</senderName><senderEmail>andrea.turli@eng.it</senderEmail><timestampReceived>2010-11-15 09:58:15-0400</timestampReceived><subject>Re: [libvirt-users] java binding and virtualbox-ose</subject><body>

Matthias,

On 11/14/2010 11:47 PM, Matthias Bolte wrote:
&gt; 2010/11/14 Andrea Turli&lt;andrea.turli@eng.it&gt;:
&gt;    
&gt;&gt; I'm trying to connect to vbox hypervisor on an Ubuntu 10.04 machine
&gt;&gt; through libvirt java binding (libvirt-java-0.4.6) by simply invoking:
&gt;&gt;
&gt;&gt; Connect conn = new Connect("vbox:///session", false);
&gt;&gt; but I got this exception:
&gt;&gt;
&gt;&gt; libvir: warning : Failed to find the interface: Is the daemon running ?
&gt;&gt; libvir: Remote error : unable to connect to
&gt;&gt; '/var/run/libvirt/libvirt-sock': Connection refused
&gt;&gt; libvir: warning : Failed to find a node driver: Is the libvirtd daemon running ?
&gt;&gt; libvir: Remote error : unable to connect to
&gt;&gt; '/var/run/libvirt/libvirt-sock': Connection refused
&gt;&gt; libvir: warning : Failed to find a secret storage driver: Is the
&gt;&gt; daemon running ?
&gt;&gt; org.libvirt.LibvirtException: Failed to find a secret storage driver:
&gt;&gt; Is the daemon running ?
&gt;&gt;     at org.libvirt.ErrorHandler.processError(ErrorHandler.java:28)
&gt;&gt;     at org.libvirt.Connect.&lt;init&gt;(Connect.java:195)
&gt;&gt;     at VBOX.main(VBOX.java:32)
&gt;&gt;
&gt;&gt;      
&gt; This is a bit tricky and took me a moment to understand.
&gt;    
Thank you for your time.
&gt; libvirt's error handling can report warnings. This feature is not used
&gt; often in libvirt, basically only in the virConnectOpen* functions to
&gt; report missing subdrivers.
&gt;
&gt; The Java bindings now have two problems:
&gt;
&gt; 1) The error processing in the bindings is done unconditional, it
&gt; always checks for an error even if the called function succeeded. Also
&gt; this results in an unnecessary call to the JNA interface for each
&gt; successful libvirt call.
&gt;
&gt; 2) The error processing raises an exception for all error, even for
&gt; errors with level VIR_ERR_WARNING.
&gt;
&gt; This results in the exception you see. The call to virConnectOpen
&gt; succeeds but libvirt reports a warning about missing sudrivers and the
&gt; bindings turn this into an exception.
&gt;
&gt; You can apply this workaround to the Java bindings code:
&gt;
&gt;
&gt; diff --git a/src/main/java/org/libvirt/ErrorHandler.java
&gt; b/src/main/java/org/libvirt/ErrorHandler.java
&gt; index e30291b..de66518 100644
&gt; --- a/src/main/java/org/libvirt/ErrorHandler.java
&gt; +++ b/src/main/java/org/libvirt/ErrorHandler.java
&gt; @@ -25,7 +25,11 @@ public class ErrorHandler {
&gt;           if (errorCode&gt;  0) {
&gt;               Error error = new Error(vError);
&gt;               libvirt.virResetLastError();
&gt; -            throw new LibvirtException(error);
&gt; +
&gt; +            /* FIXME: Don't throw exceptions for VIR_ERR_WARNING
&gt; level errors */
&gt; +            if (error.getLevel() == Error.ErrorLevel.VIR_ERR_ERROR) {
&gt; +                throw new LibvirtException(error);
&gt; +            }
&gt;           }
&gt;       }
&gt;   }
&gt;
&gt;    
I've applied this patch and it worked for me. So, do you think we should 
expect this fix in the next release? if yes, is it already scheduled?
&gt; The actually fix is more involved as it includes making the error
&gt; processing conditional.
&gt;
&gt; Matthias
&gt;
&gt;    
Thank you again,
Andrea


-- 
Andrea Turli
Ricercatore
Direzione Ricerca e Innovazione
andrea.turli@eng.it

Engineering Ingegneria Informatica spa
Via Riccardo Morandi, 32 00148 Roma (RM)
Tel. +39 06 8307 4710
Fax +39 06 8307 4200
www.eng.it


</body></email><email><emailId>20101103134111</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2010-11-03 13:41:11-0400</timestampReceived><subject>Re: [libvirt-users] ESX(i) implemented functions</subject><body>

 20101103 20:58, Sherif Nagy :
&gt; Dear All,
&gt; 
&gt; I would like to know what functions and classes are implemented in the
&gt; ESX(i) driver ? i am trying to use virsh to retrieve some simple
&gt; information such as vcpuinfo domain, but it is not working, so I would
&gt; like to know what functions are implemented in libvirt ESX(i) driver.
&gt; Also i checked the http://libvirt.org/drvesx.html and nothing is
&gt; mentioned there.

There is no definite document currently, however, you can get it
by:

http://libvirt.org/git/?p=libvirt.git;a=blob;f=src/esx/esx_driver.c;h=b3e1284119d78e4fd44c7ab60a9ae603c51dbe59;hb=HEAD


see "4152 static virDriver esxDriver = {"

the ones with value "NULL" means not supported.

Regards

- Osier
&gt; 
&gt; Thank You,
&gt; Regards,
&gt; Sherif
&gt; 
&gt; 
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users


</body></email><email><emailId>20101110182021</emailId><senderName>Kenneth Stailey</senderName><senderEmail>kstailey@yahoo.com</senderEmail><timestampReceived>2010-11-10 18:20:21-0400</timestampReceived><subject>Re: [libvirt-users] Updating Multiple VM Guests?</subject><body>



--- On Wed, 11/10/10, Laine Stump &lt;laine@laine.org&gt; wrote:

&gt; From: Laine Stump &lt;laine@laine.org&gt;
&gt; Subject: Re: [libvirt-users] Updating Multiple VM Guests?
&gt; To: libvirt-users@redhat.com
&gt; Date: Wednesday, November 10, 2010, 12:41 PM
&gt; On 11/10/2010 11:59 AM, Kenneth
&gt; Stailey wrote:
&gt; &gt; Hi,
&gt; &gt; 
&gt; &gt; The libvirt.org FAQ says that "virsh edit" is the
&gt; recommended way of updating the libvirt xml.
&gt; &gt; 
&gt; &gt; If a change has to be made to many VMs "virsh edit" is
&gt; tedious, time-consuming and likely to be prone to careless
&gt; errors.
&gt; &gt; 
&gt; &gt; Is there a command line approach to updating multiple
&gt; VMs?
&gt; 
&gt; How about:
&gt; 
&gt;    for g in guest1 guest2 guest3 guest4; do
&gt;       virsh dumpxml --inactive $g
&gt; &gt;/tmp/g.xml
&gt;       # do whatever sed/etc commands you
&gt; want here
&gt;       virsh define /tmp/g.xml
&gt;   done
&gt; 
&gt; (or something like that, anyway :-)

The "sed, etc." is a mistake since XML does not have guaranteed format.  

I suppose XMLStarlet could be used.

http://xmlstar.sourceforge.net/





</body></email><email><emailId>20101110182440</emailId><senderName>Dale Amon</senderName><senderEmail>amon@vnl.com</senderEmail><timestampReceived>2010-11-10 18:24:40-0400</timestampReceived><subject>Re: [libvirt-users] Updating Multiple VM Guests?</subject><body>

On Wed, Nov 10, 2010 at 01:07:02PM -0500, Dale Amon wrote:
&gt; On Wed, Nov 10, 2010 at 08:59:39AM -0800, Kenneth Stailey wrote:
&gt; &gt; Is there a command line approach to updating multiple VMs?
&gt; 
&gt; I rather like emacs.

To expand on what I just said,

	emacs *.xml

opens all the xml config files. Then you can write editing
macros in emacs and step through each file pretty quickly.
Then you make sure the machines in question are unloaded
before you reload the new config and start them.

Depending on the editing complexity, you might use
sed or rpl to do it via a shell script.

</body></email><email><emailId>20101110182701</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2010-11-10 18:27:01-0400</timestampReceived><subject>Re: [libvirt-users] Updating Multiple VM Guests?</subject><body>

On 11/10/2010 01:20 PM, Kenneth Stailey wrote:
&gt;
&gt; --- On Wed, 11/10/10, Laine Stump&lt;laine@laine.org&gt;  wrote:
&gt;
&gt;&gt; From: Laine Stump&lt;laine@laine.org&gt;
&gt;&gt; Subject: Re: [libvirt-users] Updating Multiple VM Guests?
&gt;&gt; To: libvirt-users@redhat.com
&gt;&gt; Date: Wednesday, November 10, 2010, 12:41 PM
&gt;&gt; On 11/10/2010 11:59 AM, Kenneth
&gt;&gt; Stailey wrote:
&gt;&gt;&gt; Hi,
&gt;&gt;&gt;
&gt;&gt;&gt; The libvirt.org FAQ says that "virsh edit" is the
&gt;&gt; recommended way of updating the libvirt xml.
&gt;&gt;&gt; If a change has to be made to many VMs "virsh edit" is
&gt;&gt; tedious, time-consuming and likely to be prone to careless
&gt;&gt; errors.
&gt;&gt;&gt; Is there a command line approach to updating multiple
&gt;&gt; VMs?
&gt;&gt;
&gt;&gt; How about:
&gt;&gt;
&gt;&gt;     for g in guest1 guest2 guest3 guest4; do
&gt;&gt;        virsh dumpxml --inactive $g
&gt;&gt;&gt; /tmp/g.xml
&gt;&gt;        # do whatever sed/etc commands you
&gt;&gt; want here
&gt;&gt;        virsh define /tmp/g.xml
&gt;&gt;    done
&gt;&gt;
&gt;&gt; (or something like that, anyway :-)
&gt; The "sed, etc." is a mistake since XML does not have guaranteed format.
&gt;
&gt; I suppose XMLStarlet could be used.
&gt;
&gt; http://xmlstar.sourceforge.net/

Yeah. sed is just my general purpose "replacement for editing by hand" 
token ;-)

Something that is xml-aware would obviously be a much better choice.

</body></email><email><emailId>20101110183856</emailId><senderName>Dale Amon</senderName><senderEmail>amon@vnl.com</senderEmail><timestampReceived>2010-11-10 18:38:56-0400</timestampReceived><subject>Re: [libvirt-users] Updating Multiple VM Guests?</subject><body>

On Wed, Nov 10, 2010 at 10:20:21AM -0800, Kenneth Stailey wrote:
&gt; The "sed, etc." is a mistake since XML does not have guaranteed format.  

Depends on the complexity. If you are just changing the size of
the memory, you could probably do it with rpl; if you are just
inserting fixed blocks of text, I'm sure you could manage it
with sed.

If it gets arbitrarily complex, then you can do arbitrarily
complex things in emacs. The question then becomes whether
it is worth the time. If the job were big enough (ie thousands
of VM's) perhaps yes. If only a dozen or so, then emacs *.xml
and manually fixing each is probably the most efficient, albiet
boring, thing to do.

Oh, and don't forget, emacs has an xml mode. So does vi.

</body></email><email><emailId>20101110224437</emailId><senderName>Kenneth Stailey</senderName><senderEmail>kstailey@yahoo.com</senderEmail><timestampReceived>2010-11-10 22:44:37-0400</timestampReceived><subject>Re: [libvirt-users] Updating Multiple VM Guests?</subject><body>



--- On Wed, 11/10/10, Laine Stump &lt;laine@laine.org&gt; wrote:

&gt; From: Laine Stump &lt;laine@laine.org&gt;
&gt; Subject: Re: [libvirt-users] Updating Multiple VM Guests?
&gt; To: libvirt-users@redhat.com
&gt; Date: Wednesday, November 10, 2010, 1:27 PM
&gt; On 11/10/2010 01:20 PM, Kenneth
&gt; Stailey wrote:
&gt; &gt;
&gt; &gt; --- On Wed, 11/10/10, Laine Stump&lt;laine@laine.org&gt; 
&gt; wrote:
&gt; &gt;
&gt; &gt;&gt; From: Laine Stump&lt;laine@laine.org&gt;
&gt; &gt;&gt; Subject: Re: [libvirt-users] Updating Multiple VM
&gt; Guests?
&gt; &gt;&gt; To: libvirt-users@redhat.com
&gt; &gt;&gt; Date: Wednesday, November 10, 2010, 12:41 PM
&gt; &gt;&gt; On 11/10/2010 11:59 AM, Kenneth
&gt; &gt;&gt; Stailey wrote:
&gt; &gt;&gt;&gt; Hi,
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; The libvirt.org FAQ says that "virsh edit" is
&gt; the
&gt; &gt;&gt; recommended way of updating the libvirt xml.
&gt; &gt;&gt;&gt; If a change has to be made to many VMs "virsh
&gt; edit" is
&gt; &gt;&gt; tedious, time-consuming and likely to be prone to
&gt; careless
&gt; &gt;&gt; errors.
&gt; &gt;&gt;&gt; Is there a command line approach to updating
&gt; multiple
&gt; &gt;&gt; VMs?
&gt; &gt;&gt;
&gt; &gt;&gt; How about:
&gt; &gt;&gt;
&gt; &gt;&gt;     for g in guest1 guest2
&gt; guest3 guest4; do
&gt; &gt;&gt;        virsh dumpxml
&gt; --inactive $g
&gt; &gt;&gt;&gt; /tmp/g.xml
&gt; &gt;&gt;        # do whatever sed/etc
&gt; commands you
&gt; &gt;&gt; want here
&gt; &gt;&gt;        virsh define
&gt; /tmp/g.xml
&gt; &gt;&gt;    done
&gt; &gt;&gt;
&gt; &gt;&gt; (or something like that, anyway :-)
&gt; &gt; The "sed, etc." is a mistake since XML does not have
&gt; guaranteed format.
&gt; &gt;
&gt; &gt; I suppose XMLStarlet could be used.
&gt; &gt;
&gt; &gt; http://xmlstar.sourceforge.net/
&gt; 
&gt; Yeah. sed is just my general purpose "replacement for
&gt; editing by hand" 
&gt; token ;-)
&gt; 
&gt; Something that is xml-aware would obviously be a much
&gt; better choice.

It's too painful to get right anyway.  I just used this:

#! /bin/bash

# hack to fixup qemu version numbers in libvirt xml

if [ `id -un` != root ]; then
    echo this script only works as root
    exit 1
fi

cd /dev/shm

for i in `virsh list --all | awk '/running|shut off/ {print $2}'`
do
        virsh dumpxml $i &gt; $i.xml
        sed -i.bak -e 's/pc-0.11/pc-0.12/' $i.xml
        virsh define $i.xml
done



</body></email><email><emailId>20101102132924</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2010-11-02 13:29:24-0400</timestampReceived><subject>Re: [libvirt-users] Does current libvirt ruby support ruby 1.9.2? Or when will it support it?</subject><body>

On 11/02/10 - 04:59:55PM,  wrote:
&gt; I'm using ruby 1.8.7  and going to port to ruby 1.9. I'd like to confirm
&gt; whether the libvirt ruby support the latest ruby 1.9.

I've recently incorporated a couple of patches into the upstream ruby libvirt
tree that make it compile on ruby 1.9.  However, I have *not* tested there,
so I don't know if it actually works.  If you have time to compile and test
the tree at http://libvirt.org/git/?p=ruby-libvirt.git;a=summary, and let me
know if it works, that would be a big help.  Otherwise, I'll have to set some
time aside to try it out on 1.9.

-- 
Chris Lalancette

</body></email><email><emailId>20101103161911</emailId><senderName>"Ryan Haggerty"</senderName><senderEmail>rhaggerty@tresys.com</senderEmail><timestampReceived>2010-11-03 16:19:11-0400</timestampReceived><subject>[libvirt-users] controlling VM access to different tap devices</subject><body>

Sorry if this off-topic but I have a qemu related question I was going
to send to the qemu users mailing list but that list appears to have
vanished.  I thought this community might have some insight.

I am interested in controlling VM access to different tap devices so I
want to have different qemu processes bound to different tun devices.
I've created new tun devices (eg. /dev/net/tun_low) followed by the use
of tunctl to create new tap devices based off of the new device nodes
(ie tunctl -t tap0 -f /dev/net/tun_low). This also did not seem to work
as the VM's seemed to still be accessing /dev/net/tun (running strace on
qemu-spice I found it was still doing an open on /dev/net/tun) and not
my new device /dev/net/tun_low.  Any suggestions on forcing qemu to use
alternative tun devices?

</body></email><email><emailId>20101104115309</emailId><senderName>RaSca</senderName><senderEmail>rasca@miamammausalinux.org</senderEmail><timestampReceived>2010-11-04 11:53:09-0400</timestampReceived><subject>[libvirt-users] Problem booting Microsoft Windows KVM virtual machine</subject><body>

Hi all,
I'm having problems with a vm's startup, I cloned the entire disk of a 
Windows 2000 with dd on a drbd device, that disk was configured with two 
partitions. I'm able to see all the partitions contents by using kpartx 
and mount them:

# kpartx -l /dev/drbd0
drbd0p1 : 0 202751488 /dev/drbd0 32
drbd0p2 : 0 285567360 /dev/drbd0 202751520

The problem is that when i try to startup the vm with virsh it hangs on 
boot by saying "error on operating system load".
Here are the details and the vm conf:

# cat /etc/libvirt/qemu/vm-sophos.xml
&lt;domain type='kvm'&gt;
   &lt;name&gt;vm-sophos&lt;/name&gt;
   &lt;uuid&gt;213a464c-73ad-8122-3647-7ff6b78d9e07&lt;/uuid&gt;
   &lt;memory&gt;262144&lt;/memory&gt;
   &lt;currentMemory&gt;262144&lt;/currentMemory&gt;
   &lt;vcpu&gt;1&lt;/vcpu&gt;
   &lt;os&gt;
     &lt;type arch='i686' machine='pc-0.12'&gt;hvm&lt;/type&gt;
     &lt;boot dev='cdrom'/&gt;
     &lt;boot dev='hd'/&gt;
   &lt;/os&gt;
   &lt;features&gt;
     &lt;acpi/&gt;
     &lt;apic/&gt;
     &lt;pae/&gt;
   &lt;/features&gt;
   &lt;clock offset='utc'/&gt;
   &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
   &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
   &lt;on_crash&gt;restart&lt;/on_crash&gt;
   &lt;devices&gt;
     &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;
     &lt;disk type='file' device='disk'&gt;
       &lt;driver name='qemu' type='raw'/&gt;
       &lt;source file='/dev/drbd0'/&gt;
       &lt;target dev='hda' bus='ide'/&gt;
       &lt;address type='drive' controller='0' bus='0' unit='0'/&gt;
     &lt;/disk&gt;
     &lt;disk type='file' device='cdrom'&gt;
       &lt;driver name='qemu' type='raw'/&gt;
       &lt;target dev='hdc' bus='ide'/&gt;
       &lt;readonly/&gt;
       &lt;address type='drive' controller='0' bus='1' unit='0'/&gt;
     &lt;/disk&gt;
     &lt;controller type='ide' index='0'&gt;
       &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x01' 
function='0x1'/&gt;
     &lt;/controller&gt;
     &lt;interface type='bridge'&gt;
       &lt;mac address='52:54:00:15:0d:68'/&gt;
       &lt;source bridge='br0'/&gt;
       &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03' 
function='0x0'/&gt;
     &lt;/interface&gt;
     &lt;serial type='pty'&gt;
       &lt;target port='0'/&gt;
     &lt;/serial&gt;
     &lt;console type='pty'&gt;
       &lt;target type='serial' port='0'/&gt;
     &lt;/console&gt;
     &lt;input type='mouse' bus='ps2'/&gt;
     &lt;graphics type='vnc' port='-1' autoport='yes' keymap='en-us'/&gt;
     &lt;video&gt;
       &lt;model type='cirrus' vram='9216' heads='1'/&gt;
       &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x02' 
function='0x0'/&gt;
     &lt;/video&gt;
     &lt;memballoon model='virtio'&gt;
       &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x04' 
function='0x0'/&gt;
     &lt;/memballoon&gt;
   &lt;/devices&gt;
&lt;/domain&gt;

Note that I've tried to change "source file" parameter with /dev/dm-0p1, 
/dev/drbd0p1, but virsh don't let me boot the machine saying it is 
unable to find the disk.

The kvm command launched by virsh is this one:

/usr/bin/kvm -S -M pc-0.12 -cpu qemu32 -enable-kvm -m 256 -smp 
1,sockets=1,cores=1,threads=1 -name vm-sophos -uuid 
213a464c-73ad-8122-3647-7ff6b78d9e07 -nodefaults -chardev 
socket,id=monitor,path=/var/lib/libvirt/qemu/vm-sophos.monitor,server,nowait 
-mon chardev=monitor,mode=readline -rtc base=utc -boot dc -drive 
file=/dev/drbd0,if=none,id=drive-ide0-0-0,boot=on,format=raw -device 
ide-drive,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0 -drive 
if=none,media=cdrom,id=drive-ide0-1-0,readonly=on,format=raw -device 
ide-drive,bus=ide.1,unit=0,drive=drive-ide0-1-0,id=ide0-1-0 -device 
rtl8139,vlan=0,id=net0,mac=52:54:00:15:0d:68,bus=pci.0,addr=0x3 -net 
tap,fd=44,vlan=0,name=hostnet0 -chardev pty,id=serial0 -device 
isa-serial,chardev=serial0 -usb -vnc 0.0.0.0:0 -k en-us -vga cirrus 
-device virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x4

I'd also followed the steps described here:

http://www.brandonturner.net/blog/2010/01/convert-windows-to-xen-guest/

to use fixmbr and the operation succeed, but the error on the vm is 
still the same.

What should else i check?

-- 
Raoul Scarazzini
Mia Mamma Usa Linux: Niente  impossibile da capire, se lo spieghi bene!
mobile: +393281776712
rasca@miamammausalinux.org
http://www.miamammausalinux.org

</body></email><email><emailId>20101109110915</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-11-09 11:09:15-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt] New wiki pages with libvirt SSH setup instructions</subject><body>

On 09/11/2010, at 9:14 PM, Zdenek Styblik wrote:
&gt; I know it took months to do, but:
&gt; 
&gt; http://wiki.libvirt.org/page/SSHSetup#Slackware
&gt; 
&gt; If anything else needs to be added (= get more chars there), let me know.
&gt; I mean, it's just couple lines and the most of them is just C&amp;P. Damn! :|

Thanks Zdenik, that's good work. :)

</body></email><email><emailId>20101112081117</emailId><senderName>Osier</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2010-11-12 08:11:17-0400</timestampReceived><subject>Re: [libvirt-users] Updating Multiple VM Guests?</subject><body>


----- "Kenneth Stailey" &lt;kstailey@yahoo.com&gt; wrote:

&gt; --- On Wed, 11/10/10, Laine Stump &lt;laine@laine.org&gt; wrote:
&gt; 
&gt; &gt; From: Laine Stump &lt;laine@laine.org&gt;
&gt; &gt; Subject: Re: [libvirt-users] Updating Multiple VM Guests?
&gt; &gt; To: libvirt-users@redhat.com
&gt; &gt; Date: Wednesday, November 10, 2010, 1:27 PM
&gt; &gt; On 11/10/2010 01:20 PM, Kenneth
&gt; &gt; Stailey wrote:
&gt; &gt; &gt;
&gt; &gt; &gt; --- On Wed, 11/10/10, Laine Stump&lt;laine@laine.org&gt; 
&gt; &gt; wrote:
&gt; &gt; &gt;
&gt; &gt; &gt;&gt; From: Laine Stump&lt;laine@laine.org&gt;
&gt; &gt; &gt;&gt; Subject: Re: [libvirt-users] Updating Multiple VM
&gt; &gt; Guests?
&gt; &gt; &gt;&gt; To: libvirt-users@redhat.com
&gt; &gt; &gt;&gt; Date: Wednesday, November 10, 2010, 12:41 PM
&gt; &gt; &gt;&gt; On 11/10/2010 11:59 AM, Kenneth
&gt; &gt; &gt;&gt; Stailey wrote:
&gt; &gt; &gt;&gt;&gt; Hi,
&gt; &gt; &gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt; The libvirt.org FAQ says that "virsh edit" is
&gt; &gt; the
&gt; &gt; &gt;&gt; recommended way of updating the libvirt xml.
&gt; &gt; &gt;&gt;&gt; If a change has to be made to many VMs "virsh
&gt; &gt; edit" is
&gt; &gt; &gt;&gt; tedious, time-consuming and likely to be prone to
&gt; &gt; careless
&gt; &gt; &gt;&gt; errors.
&gt; &gt; &gt;&gt;&gt; Is there a command line approach to updating
&gt; &gt; multiple
&gt; &gt; &gt;&gt; VMs?
&gt; &gt; &gt;&gt;
&gt; &gt; &gt;&gt; How about:
&gt; &gt; &gt;&gt;
&gt; &gt; &gt;&gt;     for g in guest1 guest2
&gt; &gt; guest3 guest4; do
&gt; &gt; &gt;&gt;        virsh dumpxml
&gt; &gt; --inactive $g
&gt; &gt; &gt;&gt;&gt; /tmp/g.xml
&gt; &gt; &gt;&gt;        # do whatever sed/etc
&gt; &gt; commands you
&gt; &gt; &gt;&gt; want here
&gt; &gt; &gt;&gt;        virsh define
&gt; &gt; /tmp/g.xml
&gt; &gt; &gt;&gt;    done
&gt; &gt; &gt;&gt;
&gt; &gt; &gt;&gt; (or something like that, anyway :-)
&gt; &gt; &gt; The "sed, etc." is a mistake since XML does not have
&gt; &gt; guaranteed format.
&gt; &gt; &gt;
&gt; &gt; &gt; I suppose XMLStarlet could be used.
&gt; &gt; &gt;
&gt; &gt; &gt; http://xmlstar.sourceforge.net/
&gt; &gt; 
&gt; &gt; Yeah. sed is just my general purpose "replacement for
&gt; &gt; editing by hand" 
&gt; &gt; token ;-)
&gt; &gt; 
&gt; &gt; Something that is xml-aware would obviously be a much
&gt; &gt; better choice.
&gt; 
&gt; It's too painful to get right anyway.  I just used this:
&gt; 
&gt; #! /bin/bash
&gt; 
&gt; # hack to fixup qemu version numbers in libvirt xml
&gt; 
&gt; if [ `id -un` != root ]; then
&gt;     echo this script only works as root
&gt;     exit 1
&gt; fi
&gt; 
&gt; cd /dev/shm
&gt; 
&gt; for i in `virsh list --all | awk '/running|shut off/ {print $2}'`
&gt; do
&gt;         virsh dumpxml $i &gt; $i.xml
&gt;         sed -i.bak -e 's/pc-0.11/pc-0.12/' $i.xml

yep, for case simple like this, sed is good enough to get it done. :-)

&gt;         virsh define $i.xml
&gt; done
&gt; 
&gt; 
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20101114223546</emailId><senderName>Erik Brakkee</senderName><senderEmail>erik@brakkee.org</senderEmail><timestampReceived>2010-11-14 22:35:46-0400</timestampReceived><subject>[libvirt-users] libvirtio version compatibility...</subject><body>

Hi,


I intend to run a server with about 4 VMs with KVM and would like to use 
virtio for performance. However, one thing that is holding me back is 
compatibility. In the past I have seen with Xen that the paravirtualized 
drivers of one version in the host (dom0) would not always be compatible 
with a version in the client.

If I would run into compatibility problems than I would like to continue 
to use full virtualization despite the performance impact. Therefore my 
question. In case I am running a setup with a host and a number of 
domains, is it guaranteed that I can do the following:

    * upgrade the host independent of the guests
    * upgrade a guest independent of the host

Cheers
   Erik

-- 

Nonsense and other useful things: http://brakkee.org
MountainHoppers: http://mountainhoppers.nl
Track Detective: http://trackdetective.com
Twitter: http://twitter.com/ErikBrakkee



</body></email><email><emailId>20101114230256</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-11-14 23:02:56-0400</timestampReceived><subject>Re: [libvirt-users] ESX(i) implemented functions</subject><body>

2010/11/3 Sherif Nagy &lt;sherif.nagy@gmail.com&gt;:
&gt; Dear All,
&gt;
&gt; I would like to know what functions and classes are implemented in the
&gt; ESX(i) driver ? i am trying to use virsh to retrieve some simple information
&gt; such as vcpuinfo domain, but it is not working, so I would like to know what
&gt; functions are implemented in libvirt ESX(i) driver. Also i checked the
&gt; http://libvirt.org/drvesx.html and nothing is mentioned there.
&gt;

Sorry for the late response.

This site [1] is intended to show what's supported for each
hypervisor, but unfortunately it's not very well maintained :(

vcpuinfo is currently not implemented for the ESX driver as I don't
see a way how to do it. To support it the ESX driver has to fill out
this struct.

struct _virVcpuInfo {
    unsigned int number;        /* virtual CPU number */
    int state;                  /* value from virVcpuState */
    unsigned long long cpuTime; /* CPU time used, in nanoseconds */
    int cpu;                    /* real CPU number, or -1 if offline */
};

There are several problems with it. ESX doesn't allow to specify or
lookup a virtual CPU to physical CPU mapping (you can restrict the
physical CPUs allowed for a guest). Therefore, the number and cpu
members cannot be filled. The state member would always be
VIR_VCPU_RUNNING, as there is no way to set single cores to offline
and ESX doesn't tell you if a virtual CPU is blocked. The cpuTime
member is another problem. libvirt exposes this as an absolute value
since boot of the domain. ESX exposes this information relative in 20
seconds slots with 1 hour history. There is no way to get the absolute
used CPU time from this. There might be possibilities to estimate
values for this that are good enough for virt-top's CPU usage
calculations.

[1] http://libvirt.org/hvsupport.html

Matthias

</body></email><email><emailId>20101115184340</emailId><senderName>Bryan Kearney</senderName><senderEmail>bkearney@redhat.com</senderEmail><timestampReceived>2010-11-15 18:43:40-0400</timestampReceived><subject>Re: [libvirt-users] java binding and virtualbox-ose</subject><body>

On 11/15/2010 04:58 AM, Andrea Turli wrote:
&gt; Matthias,
&gt;
&gt; On 11/14/2010 11:47 PM, Matthias Bolte wrote:
&gt;&gt; 2010/11/14 Andrea Turli&lt;andrea.turli@eng.it&gt;:
&gt;&gt;&gt; I'm trying to connect to vbox hypervisor on an Ubuntu 10.04 machine
&gt;&gt;&gt; through libvirt java binding (libvirt-java-0.4.6) by simply invoking:
&gt;&gt;&gt;
&gt;&gt;&gt; Connect conn = new Connect("vbox:///session", false);
&gt;&gt;&gt; but I got this exception:
&gt;&gt;&gt;
&gt;&gt;&gt; libvir: warning : Failed to find the interface: Is the daemon running ?
&gt;&gt;&gt; libvir: Remote error : unable to connect to
&gt;&gt;&gt; '/var/run/libvirt/libvirt-sock': Connection refused
&gt;&gt;&gt; libvir: warning : Failed to find a node driver: Is the libvirtd
&gt;&gt;&gt; daemon running ?
&gt;&gt;&gt; libvir: Remote error : unable to connect to
&gt;&gt;&gt; '/var/run/libvirt/libvirt-sock': Connection refused
&gt;&gt;&gt; libvir: warning : Failed to find a secret storage driver: Is the
&gt;&gt;&gt; daemon running ?
&gt;&gt;&gt; org.libvirt.LibvirtException: Failed to find a secret storage driver:
&gt;&gt;&gt; Is the daemon running ?
&gt;&gt;&gt; at org.libvirt.ErrorHandler.processError(ErrorHandler.java:28)
&gt;&gt;&gt; at org.libvirt.Connect.&lt;init&gt;(Connect.java:195)
&gt;&gt;&gt; at VBOX.main(VBOX.java:32)
&gt;&gt;&gt;
&gt;&gt; This is a bit tricky and took me a moment to understand.
&gt; Thank you for your time.
&gt;&gt; libvirt's error handling can report warnings. This feature is not used
&gt;&gt; often in libvirt, basically only in the virConnectOpen* functions to
&gt;&gt; report missing subdrivers.
&gt;&gt;
&gt;&gt; The Java bindings now have two problems:
&gt;&gt;
&gt;&gt; 1) The error processing in the bindings is done unconditional, it
&gt;&gt; always checks for an error even if the called function succeeded. Also
&gt;&gt; this results in an unnecessary call to the JNA interface for each
&gt;&gt; successful libvirt call.
&gt;&gt;
&gt;&gt; 2) The error processing raises an exception for all error, even for
&gt;&gt; errors with level VIR_ERR_WARNING.
&gt;&gt;
&gt;&gt; This results in the exception you see. The call to virConnectOpen
&gt;&gt; succeeds but libvirt reports a warning about missing sudrivers and the
&gt;&gt; bindings turn this into an exception.
&gt;&gt;
&gt;&gt; You can apply this workaround to the Java bindings code:
&gt;&gt;
&gt;&gt;
&gt;&gt; diff --git a/src/main/java/org/libvirt/ErrorHandler.java
&gt;&gt; b/src/main/java/org/libvirt/ErrorHandler.java
&gt;&gt; index e30291b..de66518 100644
&gt;&gt; --- a/src/main/java/org/libvirt/ErrorHandler.java
&gt;&gt; +++ b/src/main/java/org/libvirt/ErrorHandler.java
&gt;&gt; @@ -25,7 +25,11 @@ public class ErrorHandler {
&gt;&gt; if (errorCode&gt; 0) {
&gt;&gt; Error error = new Error(vError);
&gt;&gt; libvirt.virResetLastError();
&gt;&gt; - throw new LibvirtException(error);
&gt;&gt; +
&gt;&gt; + /* FIXME: Don't throw exceptions for VIR_ERR_WARNING
&gt;&gt; level errors */
&gt;&gt; + if (error.getLevel() == Error.ErrorLevel.VIR_ERR_ERROR) {
&gt;&gt; + throw new LibvirtException(error);
&gt;&gt; + }
&gt;&gt; }
&gt;&gt; }
&gt;&gt; }
&gt;&gt;
&gt; I've applied this patch and it worked for me. So, do you think we should
&gt; expect this fix in the next release? if yes, is it already scheduled?

The next release has not been scheduled, but I have applied the patch 
upstream.

-- bk

</body></email><email><emailId>20101117062008</emailId><senderName>Osier Yang</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2010-11-17 06:20:08-0400</timestampReceived><subject>Re: [libvirt-users] (no subject)</subject><body>

 20101117 00:51, David M. Barlieb :
&gt; HI, I've just begun using libvirt as part of my KVM installation and
&gt; have been having some confusion regarding networking of my virtual
&gt; guests. I'm not sure if I should even be sending this to this mailing
&gt; list and if not please let me know and if possible where I should be
&gt; sending this inquiry.
&gt;
&gt; I understand I can setup a dedicated bridged interface for my guest. But
&gt; as for the virbr interface which is the default, I'm a little confused
&gt; about. When using this, does the guest os use the same ip as the host?

no, for you use the 'default' virtual network

# ps -ef | grep dnsmasq

libvirt use  dnsmasq to allocate private IP addr for guest
automatically. and yes, Daniel and Justin already replied
you how the guest could communicate with outside networks.

Regards

- Osier
&gt; If so, then how to packets get to the guest instead of the host. I would
&gt; guess there's an alternate mac address for the guest interface and this
&gt; is how it gets there but am not certain. Sorry if this seems like a
&gt; simple question but I'm not very well versed in networking.
&gt;
&gt; *daveb*
&gt;
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20101117110927</emailId><senderName>Anton Gorlov</senderName><senderEmail>stalker@altlinux.ru</senderEmail><timestampReceived>2010-11-17 11:09:27-0400</timestampReceived><subject>Re: [libvirt-users] network filtering</subject><body>

Can anybody help me?

17.11.2010 11:07, Anton Gorlov :
&gt; 17.11.2010 10:46, Osier Yang :
&gt;
&gt;&gt;&gt; This filters working in kernel space or user?
&gt;&gt; it's based on iptables/ebtables, and also ip6tables in future.
&gt;&gt; so, it uses these tools in userspace, works with according
&gt;&gt; kernel module support, e.g. iptables_nat, ebtables, etc.
&gt;
&gt; Hmm, I rebuild with libpcap
&gt; ==
&gt; ldd `which virsh` | grep pcap
&gt; libpcap.so.0.8 =&gt; /usr/lib64/libpcap.so.0.8 (0x00007fb631f4b000)
&gt; ==
&gt;
&gt; guest start with no warnigs (&lt;filterref filter='clean-traffic'/&gt;).
&gt; iptables -L not show me rules with filtering. And dhcp-client on guest
&gt; not working. if I remove this filter dhcpclient working fine. Guest with
&gt; static ip (&lt;host mac='52:54:00:43:67:e8' ip='192.168.122.26' /&gt; in
&gt; default.xml)

</body></email><email><emailId>20101117120056</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-11-17 12:00:56-0400</timestampReceived><subject>Re: [libvirt-users] Changing default nic and storage types</subject><body>

On Wed, Nov 17, 2010 at 02:38:49PM +0800, Osier Yang wrote:
&gt;  20101116 21:30, Chris Phillips :
&gt; &gt;Hi,
&gt; &gt;
&gt; &gt;Simple question that I can't track down any notable discussion about,
&gt; &gt;let alone an answer...
&gt; &gt;
&gt; &gt;Is it possible to define what the "default" nic and storage types are?
&gt; &gt;I am deploying images out of cobbler using koan and all of them are
&gt; &gt;running virtio wherever applicable, but this is not the default, and
&gt; &gt;at present there is no way within koan or cobbler to define what type
&gt; &gt;of devices they should be. I've hard coded this device type
&gt; &gt;declaration into koan, but don't like that in the slightest, and would
&gt; &gt;typically expect to be able to just set "default=virtio" in a libvirt
&gt; &gt;config file somewhere.
&gt; &gt;
&gt; &gt;I fear I'm actually not missing anything and it's just hard coded for
&gt; &gt;the most compatible device with no recourse to override it.
&gt; &gt;
&gt; 
&gt; It seems reasonable to add a new preference in "/etc/libvirt/qemu.conf".
&gt; Now libvirt use "ide" as the bus type for disk device if it fails on
&gt; the series detections.

No, this isn't the right place to address this. The reason we don't
default to virtio is that actually very few operating systems support
virtio. Any change in global defaults never fixes the problem, it
just moves the problem around. The right answer to this is the libosinfo
library which provides a comprehensive &amp; customizable database of
per-OS default hardware settings (and much more besides). 

Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20101118145542</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-11-18 14:55:42-0400</timestampReceived><subject>Re: [libvirt-users] driver type for .vdi images?</subject><body>

On 11/18/2010 05:17 AM, Benjamin Hagemann wrote:
&gt; Hello libvirt experts,
&gt; 
&gt; I use libvirt (0.7.5-5ubuntu27.7) with KVM / qemu (0.12.3+noroms-0ubuntu9.2).
&gt; Some machines use raw images but same use Virtualbox images (.vdi).
&gt; Since last Ubuntu 10.04 LTS update I can not start the vdi-images.
&gt; 
&gt; The "driver name= type=" option was new.
&gt; 
&gt;   &lt;devices&gt;
&gt;     &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;
&gt;     &lt;disk type='file' device='disk'&gt;
&gt; 
&gt;       &lt;driver name='qemu' type='vdi'/&gt;
&gt; 
&gt;       &lt;source file='/path/image.vdi'/&gt;
&gt;       &lt;target dev='hda' bus='ide'/&gt;
&gt;     &lt;/disk&gt;
&gt; 
&gt; 
&gt; But when I try "type=vdi" I got in the Log-File:
&gt; 
&gt;   libvir: Security Labeling error : error calling aa_change_profile()
&gt; 
&gt; so I checked:
&gt; 
&gt;   cat vdi-machine.xml | /usr/lib/libvirt/virt-aa-helper -r --uuid
&gt; libvirt-XXXXXXXX-XXXXX-XXXX-XXXX-XXXXXXXXXXXX --dryrun -p 0
&gt;   libvir: Domain Config error : internal error unknown disk format 'vdi'
&gt; for image.vdi
&gt;   virt-aa-helper: error: invalid VM definition
&gt; 
&gt; Next I checked libvirt.org:
&gt; http://libvirt.org/storage.html
&gt; 
&gt;   Valid volume format types
&gt;   raw, bochs, cloop, cow, dmg, iso, qcow, qcow2, vmdk, vpc
&gt; 
&gt; =&gt; But what is the right type for .vdi-Images?
&gt; 

Libvirt doesn't know about the 'vdi' image type. This is a bug. Please
file a bz against the upstream product: http://libvirt.org/bugs.html

&gt; By the way, the examples at this site does not know the "driver name=
&gt; type=" option.
&gt; 

I'd recommend filing a bug for this too, the docs here need to be improved.

- Cole

</body></email><email><emailId>20101119153109</emailId><senderName>Mark Foster</senderName><senderEmail>mark@foster.cc</senderEmail><timestampReceived>2010-11-19 15:31:09-0400</timestampReceived><subject>[libvirt-users] migration failure</subject><body>

I'm setting up to do live migrations. Running KVM and libvirt on Ubuntu
10.04.1

Guest vhsot23 has qcow2 on NFS share, accessible to both vhost23 and 24
/net/fs11/srv/customer/nfs/kvm/mem52.img

root@vhost23:~# virsh migrate mem52 qemu+ssh://vhost24/system

At this point, it just sits there. virsh list on both vhost systems show
mem52 in a paused state.
I check /var/log/libvirt/qemu/mem52.log on the target system vhost24 it
states...
qemu: warning: error while loading state for instance 0x0 of device 'ram'

Further, if I do virsh destroy mem52 on the target it cleans up fine,
but after Ctrl-C on the source, mem52 cannot be managed.
root@vhost23:~# virsh destroy mem52
error: Failed to destroy domain mem52
error: Timed out during operation: cannot acquire state change lock

Only way to recover is manually kill the kvm process id for that guest.

Please help me get this to work.
-- 
Mark D. Foster &lt;mark@foster.cc&gt;
http://mark.foster.cc/ |  http://www.freegeekseattle.org/

</body></email><email><emailId>20101119232756</emailId><senderName>David Ehle</senderName><senderEmail>ehle@agni.phys.iit.edu</senderEmail><timestampReceived>2010-11-19 23:27:56-0400</timestampReceived><subject>[libvirt-users]  KVM and RAID1 over IP</subject><body>


Does anyone here have any experience with using KVM/libvirt with RAID1 
over IP/DRBD or other HA solution?

I'm trying to figure out the hardware configuration I would need to be 
able to survive a failure or planned shutdown of any one unit in a 
virtualization cluster.

KVM/libvirt makes moving running VM's from one host to another a no 
brainer, but I'm trying to figure out the right way to be able to take 
a the storage backend for maintenance without disrupting the VMs.

Right now I'm thinking something like KVM + libvirt + heartbeat/corosync + 
pacemaker + DBRM  on Ubuntu 10.04 with 3 or 4 nodes - 2 hosts, 2 storage, 
or 1 host, 1 host + storage, 1 storage.

Any thoughts?

Thanks!

</body></email><email><emailId>20101120044306</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-11-20 04:43:06-0400</timestampReceived><subject>Re: [libvirt-users] libvirtd &amp; dnsmasq</subject><body>

On 20/11/2010, at 5:17 AM, James M Leddy wrote:
&gt; It's because of this:
&lt;snip&gt;
&gt; I put in a request to get it removed.

Hmmm, pretty sure that removing it isn't the best strategy in this instance. :)

dnsmasq is kind of essential to the way libvirt uses virtual networks.  Having the \
"default" virtual network not be created, just creates a different set of problems.

If a SysAdmin creates some other virtual network on the host (a fairly standard thing \
to do), then dnsmasq will be started up for that instead, and we're back to the same \
problem of conflicting with a system install of dnsmasq.

The info on the wiki page is part of the right technical solution, as it allows a \
system wide installation of dnsmasq to not conflict with the libvirt spawned \
versions.

Not sure how to make it more automatic though.  We should definitely document it \
properly in the RHEL 6.x Virtualization Guide though.  Something for Laine to include \
in this content for the VG I reckon. :)

Regards and best wishes,

Justin Clift


</body></email><email><emailId>20101121091053</emailId><senderName> </senderName><senderEmail>denis.barishev@gmail.com</senderEmail><timestampReceived>2010-11-21 09:10:53-0400</timestampReceived><subject>[libvirt-users] libvirt dns-masq, enlarge max lease time?</subject><body>

Hello!

Is there any way conrol dnsmasq which is started by libvirt? For example, i
want to enlarge max lease time.

Thanks.

[Attachment #3 (text/html)]

Hello!&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is there any way conrol dnsmasq which is started by \
libvirt? For example, i want to enlarge max lease \
time.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks.&lt;/div&gt;



</body></email><email><emailId>20101122113831</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-11-22 11:38:31-0400</timestampReceived><subject>Re: [libvirt-users] libvirt filters</subject><body>

On Sat, Nov 20, 2010 at 01:42:36PM +0300, Anton Gorlov wrote:
&gt; I used filters like clean-traffic. The filters are working, but I
&gt; can not see the rules in  iptables -L. How can I look through the
&gt; rules?

It uses ebtables for 95% of its functionality. See this
doc for more info

  http://libvirt.org/firewall.html

Daniel

</body></email><email><emailId>20101125131301</emailId><senderName>Ravi Pawar</senderName><senderEmail>ravifc@gmail.com</senderEmail><timestampReceived>2010-11-25 13:13:01-0400</timestampReceived><subject>[libvirt-users] Anyone knows when is the next release for libvirt java bindings?</subject><body>

i am waiting for this since long.


-- 
Thanks &amp; Regards

Ravi Pawar

[Attachment #3 (text/html)]

i am waiting for this since long.&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;/div&gt;&lt;br \
clear="all"&gt;&lt;br&gt;-- &lt;br&gt;Thanks &amp; Regards&lt;br&gt;&lt;br&gt;Ravi Pawar&lt;br&gt;



</body></email><email><emailId>20101129092207</emailId><senderName>Zdenek Styblik</senderName><senderEmail>stybla@turnovfree.net</senderEmail><timestampReceived>2010-11-29 09:22:07-0400</timestampReceived><subject>[libvirt-users] pool and VM disk/image connection</subject><body>

Dear list,

I had a need to migrate pool resp. images in pool from /some/where/ to
/some/where/else/. To my surprise, I just found out editing pool wasn't
enough as each and every VM has full path to disk image not just "link"
or "connection" to pool.
I don't want to say this is bug or wrong doing; I don't want to say it
isn't my fault, because it is and I should have study more carefully.
What I'm asking for is an explanation of connection between images in
pool, pool and VMs (or something like that). Just 1+1=?
You see, my expectation was just to edit pool and it's all going to
work-out. It didn't :)

Thank you,
Zdenek

-- 
Zdenek Styblik
Net/Linux admin
OS TurnovFree.net
email: stybla@turnovfree.net
jabber: stybla@jabber.turnovfree.net

</body></email><email><emailId>20101130092803</emailId><senderName>mop amg</senderName><senderEmail>amghostman@gmail.com</senderEmail><timestampReceived>2010-11-30 09:28:03-0400</timestampReceived><subject>[libvirt-users] Create VMWare ESXi domain via virsh error(error: this function is not supported by t</subject><body>

Hi, Dear Mr/Mrs.
I have two questions ask for help:
my virt-manager and libvirt version is :
linux-vaan:~ # rpm -q libvirt
libvirt-0.8.5-1.2.i586
linux-vaan:~ # uname -a
Linux linux-vaan 2.6.34-12-desktop #1 SMP PREEMPT 2010-06-29 02:39:08 +0200
i686 i386 GNU/Linux
linux-vaan:~ # rpm -q virt-manager
virt-manager-0.8.5-3.1.i586
linux-vaan:~ # cat /etc/SuSE-release
openSUSE 11.3 (i586)
VERSION = 11.3

virsh # version
Compiled against library: libvir 0.8.5
Using library: libvir 0.8.5
Using API: ESX 0.8.5
Running hypervisor: ESX 4.1.0


*question 1 : *
When I try to create a vmware esxi domain from virsh like this :
       create --file /work/dom1.x
 there is a  error message :
       error: Failed to create domain from /work/dom1.xml
       error: this function is not supported by the connection driver:
virDomainCreateXML
it seems dosen't support create esxi domain, but the
http://libvirt.org/hvsupport.html show that is supported after  0.7.0

or create via virt-install

          linux-vaan:~ # virt-install --connect=esx://
root@192.168.8.162/?no_verify=1 -n rhel5 -r 512 --vcpus=1  --nodisks
bridge=vmk0 --network bridge=vmk0 --pxe

          Enter root's password for 192.168.8.162:



          Starting install...

          ERROR    this function is not supported by the connection driver:
virDomainCreateXML


how to  fix it ?

*dom1.xml*
&lt;domain type='vmware'&gt;
  &lt;name&gt;dom1&lt;/name&gt;
  &lt;memory&gt;524288&lt;/memory&gt;
  &lt;currentMemory&gt;524288&lt;/currentMemory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='i686'&gt;hvm&lt;/type&gt;
  &lt;/os&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;destroy&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;source file='[datastore1] rhel5/rhel5_2.vmdk'/&gt;
      &lt;target dev='sda' bus='scsi'/&gt;
      &lt;address type='drive' controller='0' bus='0' unit='0'/&gt;
    &lt;/disk&gt;
    &lt;controller type='scsi' index='0' model='lsilogic'/&gt;
    &lt;interface type='bridge'&gt;
      &lt;mac address='00:0c:29:51:f1:1c'/&gt;
      &lt;source bridge='VM Network'/&gt;
    &lt;/interface&gt;
  &lt;/devices&gt;
&lt;/domain&gt;
*question 2:*
vol-clone failed

virsh # vol-clone --pool datastore1 rhel5/rhel5.vmdk rhel5/rhel5_2.vmdk

error: Failed to clone vol from rhel5/rhel5.vmdk

error: this function is not supported by the connection driver:
virStorageVolCreateXMLFrom


thanks for help!


best regards!

[Attachment #3 (text/html)]

&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;&lt;meta \
name="ProgId" content="Word.Document"&gt;&lt;meta name="Generator" content="Microsoft Word \
14"&gt;&lt;meta name="Originator" content="Microsoft Word 14"&gt;&lt;link rel="File-List" \
href="file:///C:%5CUsers%5Ccheney%5CAppData%5CLocal%5CTemp%5Cmsohtmlclip1%5C01%5Cclip_filelist.xml"&gt;&lt;link \
rel="themeData" href="file:///C:%5CUsers%5Ccheney%5CAppData%5CLocal%5CTemp%5Cmsohtmlclip1%5C01%5Cclip_themedata.thmx"&gt;&lt;link \
rel="colorSchemeMapping" \
href="file:///C:%5CUsers%5Ccheney%5CAppData%5CLocal%5CTemp%5Cmsohtmlclip1%5C01%5Cclip_colorschememapping.xml"&gt;&lt;style&gt;
 &lt;!--
 /* Font Definitions */
 @font-face
	{font-family:;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimSun;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 680460288 22 0 262145 0;}
@font-face
	{font-family:;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimSun;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 680460288 22 0 262145 0;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-520092929 1073786111 9 0 415 0;}
@font-face
	{font-family:"\@";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 680460288 22 0 262145 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	font-size:10.5pt;
	mso-bidi-font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:;
	mso-fareast-theme-font:minor-fareast;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;}
.MsoChpDefault
	{mso-style-type:export-only;
	mso-default-props:yes;
	font-family:"Calibri","sans-serif";
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
 /* Page Definitions */
 @page
	{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:36.0pt;
	mso-footer-margin:36.0pt;
	mso-paper-source:0;}
div.WordSection1
	{page:WordSection1;}
--&gt;
&lt;/style&gt;&lt;span style="color: rgb(79, 129, 189);" lang="EN-US"&gt;&lt;/span&gt;

Hi, Dear Mr/Mrs.&lt;br&gt;I have two questions ask for help: &lt;br&gt;my virt-manager and \
libvirt version is :&lt;br&gt;linux-vaan:~ # rpm -q \
libvirt&lt;br&gt;libvirt-0.8.5-1.2.i586&lt;br&gt;linux-vaan:~ # uname -a&lt;br&gt;Linux linux-vaan \
2.6.34-12-desktop #1 SMP PREEMPT 2010-06-29 02:39:08 +0200 i686 i386 \
GNU/Linux&lt;br&gt; linux-vaan:~ # rpm -q \
virt-manager&lt;br&gt;virt-manager-0.8.5-3.1.i586&lt;br&gt;linux-vaan:~ # cat \
/etc/SuSE-release&lt;br&gt;openSUSE 11.3 (i586)&lt;br&gt;VERSION = 11.3&lt;br&gt;&lt;br&gt;virsh # \
version&lt;br&gt;Compiled against library: libvir 0.8.5&lt;br&gt;Using library: libvir 0.8.5&lt;br&gt; \
Using API: ESX 0.8.5&lt;br&gt;Running hypervisor: ESX 4.1.0&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;b&gt;question 1 : \
&lt;/b&gt;&lt;br&gt;When I try to create a vmware esxi domain from virsh like this : \
&lt;br&gt; create --file /work/dom1.x&lt;br&gt;there is \
a error message : &lt;br&gt;  error: Failed to \
create domain from /work/dom1.xml&lt;br&gt; error: this \
function is not supported by the connection driver: virDomainCreateXML&lt;br&gt;it seems \
dosen't support create esxi domain, but the &lt;a \
href="http://libvirt.org/hvsupport.html"&gt;http://libvirt.org/hvsupport.html&lt;/a&gt; show \
that is supported after  0.7.0&lt;br&gt; &lt;br&gt;or create via virt-install&lt;br&gt;&lt;meta \
http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;&lt;meta name="ProgId" \
content="Word.Document"&gt;&lt;meta name="Generator" content="Microsoft Word 14"&gt;&lt;meta \
name="Originator" content="Microsoft Word 14"&gt;&lt;link rel="File-List" \
href="file:///C:%5CUsers%5Ccheney%5CAppData%5CLocal%5CTemp%5Cmsohtmlclip1%5C01%5Cclip_filelist.xml"&gt;&lt;link \
rel="themeData" href="file:///C:%5CUsers%5Ccheney%5CAppData%5CLocal%5CTemp%5Cmsohtmlclip1%5C01%5Cclip_themedata.thmx"&gt;&lt;link \
rel="colorSchemeMapping" \
href="file:///C:%5CUsers%5Ccheney%5CAppData%5CLocal%5CTemp%5Cmsohtmlclip1%5C01%5Cclip_colorschememapping.xml"&gt;&lt;style&gt;
 &lt;!--
 /* Font Definitions */
 @font-face
	{font-family:;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimSun;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 680460288 22 0 262145 0;}
@font-face
	{font-family:;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimSun;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 680460288 22 0 262145 0;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-520092929 1073786111 9 0 415 0;}
@font-face
	{font-family:"\@";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 680460288 22 0 262145 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	font-size:10.5pt;
	mso-bidi-font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:;
	mso-fareast-theme-font:minor-fareast;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;}
.MsoChpDefault
	{mso-style-type:export-only;
	mso-default-props:yes;
	font-family:"Calibri","sans-serif";
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
 /* Page Definitions */
 @page
	{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:36.0pt;
	mso-footer-margin:36.0pt;
	mso-paper-source:0;}
div.WordSection1
	{page:WordSection1;}
--&gt;
&lt;/style&gt;

&lt;p class="MsoNormal" style="text-align: left;" align="left"&gt;&lt;span \
lang="EN-US"&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class="MsoNormal" style="text-align: left;" align="left"&gt;&lt;span \
lang="EN-US"&gt; linux-vaan:~ # \
virt-install --connect=esx://&lt;a \
href="http://root@192.168.8.162/?no_verify=1"&gt;root@192.168.8.162/?no_verify=1&lt;/a&gt; -n \
                rhel5 -r 512
--vcpus=1&lt;span style=""&gt; &lt;/span&gt;--nodisks bridge=vmk0
--network bridge=vmk0 --pxe&lt;/span&gt;&lt;/p&gt;

&lt;p class="MsoNormal" style="text-align: left;" align="left"&gt;&lt;span \
lang="EN-US"&gt; Enter root's \
password for &lt;a href="http://192.168.8.162"&gt;192.168.8.162&lt;/a&gt;:&lt;/span&gt;&lt;/p&gt;&lt;p \
class="MsoNormal" style="text-align: left;" align="left"&gt;&lt;span \
lang="EN-US"&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class="MsoNormal" style="text-align: left;" align="left"&gt;&lt;span \
lang="EN-US"&gt;  Starting \
install...&lt;/span&gt;&lt;/p&gt;

&lt;p class="MsoNormal" style="text-align: left;" align="left"&gt;&lt;span style="color: \
rgb(79, 129, 189);" lang="EN-US"&gt; \
ERROR&lt;span style=""&gt; &lt;/span&gt;this function is not supported by the \
connection driver: virDomainCreateXML&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p class="MsoNormal" \
style="text-align: left;" align="left"&gt;&lt;br&gt;&lt;/p&gt;&lt;p class="MsoNormal" \
style="text-align: left;" align="left"&gt;how to fix it \
?&lt;br&gt;&lt;/p&gt;&lt;br&gt;&lt;u&gt;dom1.xml&lt;/u&gt;&lt;br&gt; &lt;span style="color: rgb(153, 153, 153);"&gt;&lt;domain \
type='vmware'&gt;&lt;/span&gt;&lt;br style="color: rgb(153, 153, 153);"&gt;&lt;span \
style="color: rgb(153, 153, 153);"&gt; &lt;name&gt;dom1&lt;/name&gt;&lt;/span&gt;&lt;br \
style="color: rgb(153, 153, 153);"&gt; &lt;span style="color: rgb(153, 153, 153);"&gt; \
&lt;memory&gt;524288&lt;/memory&gt;&lt;/span&gt;&lt;br style="color: rgb(153, 153, \
153);"&gt;&lt;span style="color: rgb(153, 153, 153);"&gt; \
&lt;currentMemory&gt;524288&lt;/currentMemory&gt;&lt;/span&gt;&lt;br style="color: rgb(153, \
153, 153);"&gt; &lt;span style="color: rgb(153, 153, 153);"&gt; \
&lt;vcpu&gt;1&lt;/vcpu&gt;&lt;/span&gt;&lt;br style="color: rgb(153, 153, 153);"&gt;&lt;span \
style="color: rgb(153, 153, 153);"&gt; &lt;os&gt;&lt;/span&gt;&lt;br style="color: rgb(153, \
153, 153);"&gt;&lt;span style="color: rgb(153, 153, 153);"&gt; &lt;type \
arch='i686'&gt;hvm&lt;/type&gt;&lt;/span&gt;&lt;br style="color: rgb(153, 153, 153);"&gt; \
&lt;span style="color: rgb(153, 153, 153);"&gt; &lt;/os&gt;&lt;/span&gt;&lt;br style="color: \
rgb(153, 153, 153);"&gt;&lt;span style="color: rgb(153, 153, 153);"&gt; &lt;clock \
offset='utc'/&gt;&lt;/span&gt;&lt;br style="color: rgb(153, 153, 153);"&gt; &lt;span \
style="color: rgb(153, 153, 153);"&gt; \
&lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;&lt;/span&gt;&lt;br style="color: rgb(153, 153, \
153);"&gt;&lt;span style="color: rgb(153, 153, 153);"&gt; \
&lt;on_reboot&gt;restart&lt;/on_reboot&gt;&lt;/span&gt;&lt;br style="color: rgb(153, 153, \
153);"&gt; &lt;span style="color: rgb(153, 153, 153);"&gt; \
&lt;on_crash&gt;destroy&lt;/on_crash&gt;&lt;/span&gt;&lt;br style="color: rgb(153, 153, \
153);"&gt;&lt;span style="color: rgb(153, 153, 153);"&gt; &lt;devices&gt;&lt;/span&gt;&lt;br \
style="color: rgb(153, 153, 153);"&gt; &lt;span style="color: rgb(153, 153, \
153);"&gt; &lt;disk type='file' \
device='disk'&gt;&lt;/span&gt;&lt;br style="color: rgb(153, 153, 153);"&gt;&lt;span \
style="color: rgb(153, 153, 153);"&gt; &lt;source \
file='[datastore1] rhel5/rhel5_2.vmdk'/&gt;&lt;/span&gt;&lt;br style="color: rgb(153, \
153, 153);"&gt; &lt;span style="color: rgb(153, 153, 153);"&gt; \
&lt;target dev='sda' bus='scsi'/&gt;&lt;/span&gt;&lt;br style="color: rgb(153, \
153, 153);"&gt;&lt;span style="color: rgb(153, 153, 153);"&gt; \
&lt;address type='drive' controller='0' bus='0' \
unit='0'/&gt;&lt;/span&gt;&lt;br style="color: rgb(153, 153, 153);"&gt; &lt;span \
style="color: rgb(153, 153, 153);"&gt; &lt;/disk&gt;&lt;/span&gt;&lt;br \
style="color: rgb(153, 153, 153);"&gt;&lt;span style="color: rgb(153, 153, \
153);"&gt; &lt;controller type='scsi' index='0' \
model='lsilogic'/&gt;&lt;/span&gt;&lt;br style="color: rgb(153, 153, 153);"&gt; &lt;span \
style="color: rgb(153, 153, 153);"&gt; &lt;interface \
type='bridge'&gt;&lt;/span&gt;&lt;br style="color: rgb(153, 153, 153);"&gt;&lt;span \
style="color: rgb(153, 153, 153);"&gt; &lt;mac \
address='00:0c:29:51:f1:1c'/&gt;&lt;/span&gt;&lt;br style="color: rgb(153, 153, \
153);"&gt; &lt;span style="color: rgb(153, 153, 153);"&gt; \
&lt;source bridge='VM Network'/&gt;&lt;/span&gt;&lt;br style="color: rgb(153, 153, \
153);"&gt;&lt;span style="color: rgb(153, 153, 153);"&gt; \
&lt;/interface&gt;&lt;/span&gt;&lt;br style="color: rgb(153, 153, 153);"&gt; &lt;span style="color: \
rgb(153, 153, 153);"&gt; &lt;/devices&gt;&lt;/span&gt;&lt;br style="color: rgb(153, 153, \
153);"&gt;&lt;span style="color: rgb(153, 153, 153);"&gt;&lt;/domain&gt;&lt;/span&gt;&lt;br&gt;&lt;b&gt;question \
2:&lt;/b&gt; &lt;br&gt;vol-clone failed&lt;br&gt;&lt;meta http-equiv="Content-Type" content="text/html; \
charset=utf-8"&gt;&lt;meta name="ProgId" content="Word.Document"&gt;&lt;meta name="Generator" \
content="Microsoft Word 14"&gt;&lt;meta name="Originator" content="Microsoft Word 14"&gt;&lt;link \
rel="File-List" href="file:///C:%5CUsers%5Ccheney%5CAppData%5CLocal%5CTemp%5Cmsohtmlclip1%5C01%5Cclip_filelist.xml"&gt;&lt;link \
rel="themeData" href="file:///C:%5CUsers%5Ccheney%5CAppData%5CLocal%5CTemp%5Cmsohtmlclip1%5C01%5Cclip_themedata.thmx"&gt;&lt;link \
rel="colorSchemeMapping" \
href="file:///C:%5CUsers%5Ccheney%5CAppData%5CLocal%5CTemp%5Cmsohtmlclip1%5C01%5Cclip_colorschememapping.xml"&gt;&lt;style&gt;
 &lt;!--
 /* Font Definitions */
 @font-face
	{font-family:;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimSun;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 680460288 22 0 262145 0;}
@font-face
	{font-family:;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimSun;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 680460288 22 0 262145 0;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-520092929 1073786111 9 0 415 0;}
@font-face
	{font-family:"\@";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 680460288 22 0 262145 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	font-size:10.5pt;
	mso-bidi-font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:;
	mso-fareast-theme-font:minor-fareast;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;}
.MsoChpDefault
	{mso-style-type:export-only;
	mso-default-props:yes;
	font-family:"Calibri","sans-serif";
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
 /* Page Definitions */
 @page
	{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:36.0pt;
	mso-footer-margin:36.0pt;
	mso-paper-source:0;}
div.WordSection1
	{page:WordSection1;}
--&gt;
&lt;/style&gt;

&lt;p class="MsoNormal" style="text-align: left;" align="left"&gt;&lt;span lang="EN-US"&gt;virsh \
# vol-clone --pool datastore1 rhel5/rhel5.vmdk rhel5/rhel5_2.vmdk&lt;/span&gt;&lt;/p&gt;

&lt;p class="MsoNormal" style="text-align: left;" align="left"&gt;&lt;span style="color: \
rgb(79, 129, 189);" lang="EN-US"&gt;error: Failed to clone vol from \
rhel5/rhel5.vmdk&lt;/span&gt;&lt;/p&gt;

&lt;p class="MsoNormal" style="text-align: left;" align="left"&gt;&lt;span style="color: \
rgb(79, 129, 189);" lang="EN-US"&gt;error: this function is not supported by the \
connection driver: virStorageVolCreateXMLFrom&lt;/span&gt;&lt;/p&gt;&lt;p class="MsoNormal" \
style="text-align: left;" align="left"&gt;&lt;span style="color: rgb(79, 129, 189);" \
lang="EN-US"&gt;&lt;br&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class="MsoNormal" style="text-align: left; color: \
rgb(0, 0, 0);" align="left"&gt; thanks for help!&lt;/p&gt;&lt;p class="MsoNormal" \
style="text-align: left; color: rgb(0, 0, 0);" align="left"&gt;&lt;br&gt;&lt;/p&gt;&lt;p \
class="MsoNormal" style="text-align: left; color: rgb(0, 0, 0);" align="left"&gt;best \
regards!&lt;/p&gt;&lt;p class="MsoNormal" style="text-align: left;" align="left"&gt; &lt;span \
style="color: rgb(79, 129, 189);" lang="EN-US"&gt;&lt;br&gt;&lt;/span&gt;&lt;/p&gt;&lt;span style="color: \
rgb(79, 129, 189);" lang="EN-US"&gt;&lt;/span&gt;&lt;p class="MsoNormal" style="text-align: \
left;" align="left"&gt;

&lt;br&gt;&lt;span style="color: rgb(79, 129, 189);" lang="EN-US"&gt;&lt;/span&gt;&lt;/p&gt;

&lt;br&gt;&lt;br&gt;



</body></email><email><emailId>20101001161915</emailId><senderName>"Stanley, Jon [Tech]"</senderName><senderEmail>jon.stanley@gs.com</senderEmail><timestampReceived>2010-10-01 16:19:15-0400</timestampReceived><subject>[libvirt-users] Python XML parsing of domain descriptions?</subject><body>

Does anyone know of a way to parse the libvirt XML into usable python data structures? Ideally, it would be something like foo['domain']['devices']['bridge'][0]['target'] or something of the sort. What I'm looking to accomplish is to figure out which tap interface goes with a specific domain.

I'm not keen on parsing XML to get that mapping, is there a better way to do it without parsing XML?

</body></email><email><emailId>20101004122414</emailId><senderName>Ravi Pawar</senderName><senderEmail>ravifc@gmail.com</senderEmail><timestampReceived>2010-10-04 12:24:14-0400</timestampReceived><subject>[libvirt-users] Anyone has new libvirt java binding jar, i want the latest one. i dont have the buil</subject><body>

-- 
Thanks &amp; Regards

Ravi Pawar

[Attachment #3 (text/html)]

&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;Thanks &amp; Regards&lt;br&gt;&lt;br&gt;Ravi Pawar&lt;br&gt;


</body></email><email><emailId>20101001174731</emailId><senderName>"Stanley, Jon [Tech]"</senderName><senderEmail>jon.stanley@gs.com</senderEmail><timestampReceived>2010-10-01 17:47:31-0400</timestampReceived><subject>[libvirt-users] virt-xml-validate b0rked?</subject><body>

It seems that virt-xml-validate doesn't validate what *has* to be valid XML, that generated by virsh dumpxml against a running domain:

[root@etc752365a ~]# virsh list
 Id Name                 State
----------------------------------
  2 rhel55               running
  3 rhel53               running

[root@etc752365a ~]# virsh dumpxml rhel55 &gt; foo.xml
[root@etc752365a ~]# virt-xml-validate foo.xml 
foo.xml:8: element type: Relax-NG validity error : Invalid attribute arch for element type
foo.xml:9: element boot: Relax-NG validity error : Element os failed to validate content
foo.xml:8: element type: Relax-NG validity error : Error validating value 
foo.xml:8: element type: Relax-NG validity error : Element type failed to validate content
foo.xml:1: element domain: Relax-NG validity error : Invalid sequence in interleave
foo.xml:1: element domain: Relax-NG validity error : Element domain failed to validate content
foo.xml fails to validate

Is there something that I'm doing wrong here? This is the libvirt that comes with RHEL5.5

</body></email><email><emailId>20101004030030</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-10-04 03:00:30-0400</timestampReceived><subject>Re: [libvirt-users] Updates to cucmber-vhost - guineapigs wanted! :)</subject><body>

On 07/23/2010 06:13 AM, Matthew Macdonald-Wallace wrote:
&gt; Hi all,
&gt;
&gt; For those of you that are using cucumber for Continuous Integration or
&gt; similar I've created a set of steps that enable you to use cobbler and
&gt; cucumber to auto-provision using Libvirt.
&gt;
&gt; I've just made some changes to the code however I don't have access to
&gt; all the hardware/software required to test it fully.
&gt;
&gt; If you are able to, please check out the code from
&gt; http://tinyurl.com/virtcuke (my github repo) and test, posting bugs
&gt; against the project.
&gt;
&gt; Thanks in advance,

Just added a link to your code from the libvirt wiki:

   http://wiki.libvirt.org/page/Main_Page#Provisioning

Hope that's useful. :)

Regards and best wishes,

Justin Clift


&gt; Matt

</body></email><email><emailId>20101004215349</emailId><senderName>Papp_Tams</senderName><senderEmail>tompos@martos.bme.hu</senderEmail><timestampReceived>2010-10-04 21:53:49-0400</timestampReceived><subject>[libvirt-users] LXC</subject><body>


  hi All,

I'm new to this list and also not a professional libvirt user:)

I'm trying to use it for running a container.
This is my config:

&lt;domain type='lxc'&gt;
&lt;name&gt;test&lt;/name&gt;
&lt;uuid&gt;d3667da2-061a-7b20-a29c-3afc798a257e&lt;/uuid&gt;
&lt;memory&gt;500000&lt;/memory&gt;
&lt;currentMemory&gt;500000&lt;/currentMemory&gt;
&lt;vcpu&gt;1&lt;/vcpu&gt;
&lt;os&gt;
&lt;type arch='x86_64'&gt;exe&lt;/type&gt;
&lt;init&gt;/sbin/init&lt;/init&gt;
&lt;/os&gt;
&lt;clock offset='utc'/&gt;
&lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
&lt;on_reboot&gt;restart&lt;/on_reboot&gt;
&lt;on_crash&gt;destroy&lt;/on_crash&gt;
&lt;devices&gt;
&lt;emulator&gt;/usr/lib/libvirt/libvirt_lxc&lt;/emulator&gt;
&lt;filesystem type='mount'&gt;
&lt;source dir='/data/lxc/test/rootfs'/&gt;
&lt;target dir='/'/&gt;
&lt;/filesystem&gt;
&lt;interface type='bridge'&gt;
&lt;mac address='52:54:00:b8:a7:80'/&gt;
&lt;source bridge='br1'/&gt;
&lt;target dev='veth0'/&gt;
&lt;/interface&gt;
&lt;console type='pty'&gt;
&lt;target type='serial' port='0'/&gt;
&lt;/console&gt;
&lt;/devices&gt;
&lt;/domain&gt;


It's up and running after start:

  3141 ?        Ss     0:00 /usr/lib/libvirt/libvirt_lxc --name test 
--console 107 --background --veth veth1
  3148 pts/0    Ss+    0:00  \_ /sbin/init
  3158 ?        S&lt;s    0:00      \_ udevd --daemon
  3641 ?        S&lt;     0:00      |   \_ udevd --daemon
  3643 ?        S&lt;     0:00      |   \_ udevd --daemon
  3690 ?        Sl     0:00      \_ rsyslogd -c4
  3703 ?        Ss     0:00      \_ /usr/sbin/sshd
  3730 ?        Ss     0:00      \_ cron
  3767 ?        Ssl    0:00      \_ /usr/sbin/nscd
  3818 ?        Ss     0:00      \_ /usr/sbin/munin-node
  3989 ?        Ss     0:00      \_ /usr/lib/postfix/master
  3996 ?        S      0:00      |   \_ pickup -l -t fifo -u -c
  3997 ?        S      0:00      |   \_ qmgr -l -t fifo -u
  3998 ?        Ss     0:00      \_ /sbin/getty -8 38400 tty1

I'm trying to connect to the console:

$ virsh --connect=lxc:/// console test
Connected to domain test
Escape character is ^]


And it got off:

$ virsh --connect=lxc:/// list --all
  Id Name                 State
----------------------------------
   - test                 shut off

/var/log/libvirt/lxc/test.log:

23:17:13.463: error : lxcFdForward:231 : read of fd 7 failed: 
Input/output error


The system is Ubuntu 10.10 beta, 2.6.35-22-server and libvirt 
0.8.3-1ubuntu14.

What's wrong? I am out of idea.

Thank you,

tamas

</body></email><email><emailId>20101005134219</emailId><senderName>Carla Araujo</senderName><senderEmail>carla.asouza@gmail.com</senderEmail><timestampReceived>2010-10-05 13:42:19-0400</timestampReceived><subject>[libvirt-users] Puppet Module for Virtualization Management</subject><body>

Hi all!

Puppet [0] is an Open Source data center automation and configuration
management framework. Puppet provides system administration with a
simplified platform that allows for consistent, transparent, and flexible
system management. Puppet can be extended with new modules, which are
reusable, sharable units of Puppet code.

This year, during the Google Summer of Code [1], I developed a new Puppet's
module: Puppet-virt. Puppet-virt [2] provides a new type that allows the
administrator to deploy and manage virtual machines using r *uby-libvirt* .
At first, only Xen fullyvirtualization, Xen paravirtualization, KVM and
OpenVZ are supported.

If you have any suggestion or contribution, fell free to contact me and/or
fork the repository at github. :)


Regards,

Carla Souza

[0] http://www.puppetlabs.com/
[1] http://socghop.appspot.com/
[2] http://github.com/carlasouza/puppet-virt

[Attachment #3 (text/html)]

&lt;span style="border-collapse:collapse"&gt;&lt;div&gt;&lt;span \
style="border-collapse:collapse"&gt;&lt;font face="arial, helvetica, sans-serif"&gt;Hi \
all!&lt;/font&gt;&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;font face="arial, helvetica, \
sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;span style="border-collapse:collapse"&gt;&lt;font \
face="arial, helvetica, sans-serif"&gt;Puppet [0] is an Open Source data center \
automation and configuration management framework. Puppet provides system \
administration with a simplified platform that allows for consistent, transparent, \
and flexible system management. Puppet can be extended with new modules, which are \
reusable, sharable units of Puppet code.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;


&lt;div&gt;&lt;span style="border-collapse:collapse"&gt;&lt;font face="arial, helvetica, \
sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style="border-collapse:collapse"&gt;&lt;font \
face="arial, helvetica, sans-serif"&gt;This year, during the Google Summer of Code [1], \
I developed a new Puppet's module: Puppet-virt. P&lt;/font&gt;&lt;/span&gt;&lt;font \
class="Apple-style-span" face="arial, helvetica, sans-serif"&gt;uppet-virt [2] provides \
a new type that allows the administrator to deploy and manage virtual machines using \
r&lt;/font&gt;&lt;span class="Apple-style-span" style="border-collapse: separate; line-height: \
14px; "&gt;&lt;h3 class="r" style="padding-top: 0px; padding-right: 0px; padding-bottom: \
0px; padding-left: 0px; margin-top: 0px; margin-right: 0px; margin-bottom: 0px; \
margin-left: 0px; display: inline; "&gt;

&lt;em style="font-style: normal; "&gt;&lt;span class="Apple-style-span" style="font-weight: \
normal; "&gt;&lt;font class="Apple-style-span" face="arial, helvetica, sans-serif"&gt;&lt;span \
class="Apple-style-span" style="font-size: \
small;"&gt;uby-libvirt&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/em&gt;&lt;/h3&gt;

&lt;/span&gt;&lt;font class="Apple-style-span" face="arial, helvetica, sans-serif"&gt;. At first, \
only Xen fullyvirtualization, Xen paravirtualization, KVM and OpenVZ are \
supported.&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font face="arial, helvetica, \
sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face="arial, helvetica, sans-serif"&gt;If you \
have any suggestion or contribution, fell free to contact me and/or fork the \
repository at github. :)&lt;/font&gt;&lt;/div&gt;


&lt;div&gt;&lt;font face="arial, helvetica, sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
face="arial, helvetica, sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face="arial, \
helvetica, sans-serif"&gt;Regards,&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font face="arial, helvetica, \
sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face="arial, helvetica, sans-serif"&gt;Carla \
Souza&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face="arial, helvetica, sans-serif"&gt;&lt;br&gt; \
&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face="arial, helvetica, sans-serif"&gt;[0] &lt;/font&gt;&lt;span \
style="font-family:arial, helvetica, sans-serif"&gt;&lt;a href="http://www.puppetlabs.com/" \
target="_blank"&gt;http://www.puppetlabs.com/&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;

&lt;div&gt;&lt;meta http-equiv="content-type" content="text/html; charset=utf-8"&gt;&lt;span \
class="Apple-style-span" style="border-collapse: separate; font-family: arial, \
helvetica, sans-serif; "&gt;&lt;span style="border-collapse: collapse; "&gt;[1] &lt;/span&gt;&lt;span \
style="border-collapse: collapse; "&gt;&lt;a href="http://socghop.appspot.com/" \
target="_blank"&gt;http://socghop.appspot.com/&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;


&lt;font&gt;&lt;font color="#000000"&gt;&lt;font face="arial, helvetica, sans-serif"&gt;[2] \
&lt;/font&gt;&lt;/font&gt;&lt;/font&gt;&lt;/span&gt;&lt;a href="http://github.com/carlasouza/puppet-virt" \
target="_blank"&gt;http://github.com/carlasouza/puppet-virt&lt;/a&gt;&lt;br&gt;&lt;div&gt;


&lt;/div&gt;



</body></email><email><emailId>20101004061317</emailId><senderName>Dale Amon</senderName><senderEmail>amon@vnl.com</senderEmail><timestampReceived>2010-10-04 06:13:17-0400</timestampReceived><subject>[libvirt-users] Mounting an lvm</subject><body>


I converted a system disk from a virtualbox
VM and added to the config on a qemu VM.
All seems well until I try to mount it. The
virtual machine shows data for the disk
image using commands like:

	pvs
	lvs
	lvdisplay xena-1

but there is no /dev/xena-1/root to be=20
mounted. I also cannot seem to figure out
whether the lvm related modules are available
for the virtual machine kernel.

Has anyone else tried playing this game?



["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20101005185016</emailId><senderName>James M Leddy</senderName><senderEmail>james.leddy@redhat.com</senderEmail><timestampReceived>2010-10-05 18:50:16-0400</timestampReceived><subject>[libvirt-users] [PATCH] Re: Python XML parsing of domain descriptions?</subject><body>

rp.gs.com&gt;


Jon,

Would you try with this patch?

diff -c libvirt-0.6.3/docs/schemas/domain.rng libvirt-0.6.3.updateschema/docs/schemas/domain.rng
*** libvirt-0.6.3/docs/schemas/domain.rng	2010-07-23 12:44:45.000000000 -0400
--- libvirt-0.6.3.updateschema/docs/schemas/domain.rng	2010-10-05 14:17:16.700561725 -0400
***************
*** 150,155 ****
--- 150,156 ----
        &lt;/attribute&gt;
        &lt;attribute name="machine"&gt;
          &lt;choice&gt;
+           &lt;value&gt;rhel5.4.0&lt;/value&gt;
            &lt;value&gt;xenfv&lt;/value&gt;
            &lt;value&gt;pc&lt;/value&gt;
            &lt;value&gt;isapc&lt;/value&gt;



-- 
James M. Leddy
Technical Account Manager
Red Hat Inc.

</body></email><email><emailId>20101001164821</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2010-10-01 16:48:21-0400</timestampReceived><subject>Re: [libvirt-users] Ruby-libvirt and openAuth</subject><body>

On 09/30/10 - 09:51:10AM, Jonathan Kelley wrote:
&gt; Hello,
&gt; 
&gt; It looks like the Ruby bindings do not support virConnectOpenAuth. Is this
&gt; true? If so, is there any reason why? or plans to?

I've recently implemented them; if you check in the upstream git repository
(http://libvirt.org/git/?p=ruby-libvirt.git;a=summary),
you'll see it.  I hope to do a release pretty soon with this (and some more
APIs) implemented.

-- 
Chris Lalancette

</body></email><email><emailId>20100914155221</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-09-14 15:52:21-0400</timestampReceived><subject>[libvirt-users] New wiki pages with libvirt SSH setup instructions</subject><body>

Hi all,

Just added some new pages to the wiki, this time covering how to
configure remote access to libvirt through SSH, not using root:

   http://wiki.libvirt.org/page/SSHSetup     &lt;--- entry page
   http://wiki.libvirt.org/page/SSHPolicyKitSetup

This has details for several different Linux distributions:

   * RHEL 5 &amp; 6
   * Fedora 11-13
   * Centos 5 &amp; 6
   * Ubuntu 10.04 Server &amp; Desktop
   * openSUSE 11.2 onwards

Does anyone have info they'd like to include for other distributions?

:)

Regards and best wishes,

Justin Clift

</body></email><email><emailId>20101006111316</emailId><senderName>Papp_Tams</senderName><senderEmail>tompos@martos.bme.hu</senderEmail><timestampReceived>2010-10-06 11:13:16-0400</timestampReceived><subject>Re: [libvirt-users] Error while starting the domain "error: monitor socket did not show up.: Connect</subject><body>


  On 2010.10.06. 13:06, Ravi Pawar wrote:
&gt; All,
&gt;
&gt; here is my domain xml
&gt;
&gt; &lt;domain type='kvm'&gt;
&gt; &lt;name&gt;tests&lt;/name&gt;
&gt; &lt;uuid&gt;76bc677f-ee5b-ef0b-1d02-72d12785b1d8&lt;/uuid&gt;
&gt; &lt;memory&gt;524288&lt;/memory&gt;
&gt; &lt;currentMemory&gt;524288&lt;/currentMemory&gt;
&gt; &lt;vcpu&gt;1&lt;/vcpu&gt;
&gt; &lt;os&gt;
&gt; &lt;type arch='x86_64' machine='pc-0.12'&gt;hvm&lt;/type&gt;
&gt; &lt;boot dev='network'/&gt;
&gt; &lt;/os&gt;
&gt; &lt;clock offset='utc'/&gt;
&gt; &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
&gt; &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
&gt; &lt;on_crash&gt;destroy&lt;/on_crash&gt;
&gt; &lt;devices&gt;
&gt; &lt;emulator&gt;/usr/libexec/qemu-kvm&lt;/emulator&gt;
&gt; &lt;disk type='file' device='disk'&gt;
&gt; &lt;source file='/var/lib/libvirt/images/testKVM'/&gt;
&gt; &lt;target dev='hda' bus='ide'/&gt;
&gt; &lt;address type='drive' controller='0' bus='0' unit='0'/&gt;
&gt; &lt;/disk&gt;
&gt; &lt;controller type='ide' index='0'/&gt;
&gt; &lt;interface type='network'&gt;
&gt; &lt;mac address='52:54:00:a4:0e:ce'/&gt;
&gt; &lt;source network='default'/&gt;
&gt; &lt;target dev='vnet0'/&gt;
&gt; &lt;/interface&gt;
&gt; &lt;input type='mouse' bus='ps2'/&gt;
&gt; &lt;graphics type='vnc' port='-1' autoport='yes' listen='127.0.0.1' 
&gt; keymap='en-us'/&gt;
&gt; &lt;video&gt;
&gt; &lt;model type='cirrus' vram='9216' heads='1'/&gt;
&gt; &lt;/video&gt;
&gt; &lt;/devices&gt;
&gt; &lt;/domain&gt;
&gt;
&gt;
&gt; my host is RHEL 6 beta.
&gt; i don't have any clue where i am going wrong in the configuration of 
&gt; the host or configuration of the domain.

Check the logs:

/var/log/libvirt/...

tamas

</body></email><email><emailId>20101010141456</emailId><senderName>Dan Johansson</senderName><senderEmail>kvm@dmj.nu</senderEmail><timestampReceived>2010-10-10 14:14:56-0400</timestampReceived><subject>[libvirt-users] Problems with libvirt / qemu</subject><body>

HI,

I have a small problem with libvirt / qemu. I have created a guest and when I start \
it from the command-line the guests starts OK, but when I start the guest through \
libvirt with "virsh start" I get "Booting from Hard Disk... Boot failed: not a \
bootable disk No bootable device"

This is the command-line I use to start the guest (which works)
"cd /var/lib/kvm/Wilmer;  /usr/bin/qemu-system-x86_64 --enable-kvm \
        -net nic,vlan=1,model=rtl8139,macaddr=DE:ED:BE:EF:01:03 -net \
tap,vlan=1,ifname=qtap13,script=no,downscript=no \                                    \
                
        -net nic,vlan=3,model=rtl8139,macaddr=DE:ED:BE:EF:03:03 -net \
tap,vlan=3,ifname=qtap33,script=no,downscript=no \                                    \
                
        -m 2048 -k de-ch -vnc :3 -daemonize \                                         \
  Wilmer.qcow2"


The libvirt XML-file was created using "virsh domxml-from-native qemu-argv" and this \
is the result of that conversion: &lt;domain type='kvm'&gt;
  &lt;name&gt;wilmer&lt;/name&gt;
  &lt;uuid&gt;a421968d-0573-1356-8cb7-32caff525a03&lt;/uuid&gt;
  &lt;memory&gt;2097152&lt;/memory&gt;
  &lt;currentMemory&gt;2097152&lt;/currentMemory&gt;
  &lt;vcpu&gt;2&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='x86_64' machine='pc-0.12'&gt;hvm&lt;/type&gt;
    &lt;boot dev='hd'/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
  &lt;/features&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;destroy&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/bin/qemu-system-x86_64&lt;/emulator&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;source file='/var/lib/kvm/Wilmer/Wilmer.qcow2'/&gt;
      &lt;target dev='hda' bus='ide'/&gt;
      &lt;address type='drive' controller='0' bus='0' unit='0'/&gt;
    &lt;/disk&gt;
    &lt;controller type='ide' index='0'&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x01' function='0x1'/&gt;
    &lt;/controller&gt;
    &lt;interface type='ethernet'&gt;
      &lt;mac address='de:ed:be:ef:01:03'/&gt;
      &lt;script path='no'/&gt;
      &lt;target dev='qtap13'/&gt;
      &lt;model type='rtl8139'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x04' function='0x0'/&gt;
    &lt;/interface&gt;
    &lt;interface type='ethernet'&gt;
      &lt;mac address='de:ed:be:ef:03:03'/&gt;
      &lt;script path='no'/&gt;
      &lt;target dev='qtap33'/&gt;
      &lt;model type='rtl8139'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x05' function='0x0'/&gt;
    &lt;/interface&gt;
    &lt;input type='mouse' bus='ps2'/&gt;
    &lt;graphics type='vnc' port='5903' autoport='no' listen=''/&gt;
    &lt;video&gt;
      &lt;model type='cirrus' vram='9216' heads='1'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x02' function='0x0'/&gt;
    &lt;/video&gt;
  &lt;/devices&gt;
&lt;/domain&gt;


Anyone seeing something obvious that I have missed?

 Regards,
-- 
Dan Johansson, &lt;http://www.dmj.nu&gt;
***************************************************
This message is printed on 100% recycled electrons!
***************************************************


</body></email><email><emailId>20101008070006</emailId><senderName>Mitchell Hashimoto</senderName><senderEmail>mitchell.hashimoto@gmail.com</senderEmail><timestampReceived>2010-10-08 07:00:06-0400</timestampReceived><subject>[libvirt-users] Mac OS X: dyld: lazy symbol binding failed</subject><body>

I'm using the Ruby/FFI libvirt library and getting this consistently
on Mac OS X:

ruby-1.9.2-p0 &gt; FFI::Libvirt.virInitialize
dyld: lazy symbol binding failed: Symbol not found: _virThreadInitialize
  Referenced from: /usr/local/lib/libvirt.dylib
  Expected in: flat namespace

dyld: Symbol not found: _virThreadInitialize
  Referenced from: /usr/local/lib/libvirt.dylib
  Expected in: flat namespace

Trace/BPT trap

I exported DYLD_PRINT_LIBRARIES and it shows that libvirt.dylib is
loaded in the process space, but the above still occurs. When I
statically link into a C program it works fine, however. Anyone have
any idea what could be causing this?

If this doesn't get a response, I'll post it to the dev list, since
its perhaps relevant to them as well.

Thanks,
Mitchell

</body></email><email><emailId>20101012171423</emailId><senderName>David Grundy</senderName><senderEmail>dagrundy@gmail.com</senderEmail><timestampReceived>2010-10-12 17:14:23-0400</timestampReceived><subject>[libvirt-users] bootloader_args element</subject><body>

I am trying to set the hostname of VMs at boot time and banging my head
against the wall.  I am using

virsh create xen-config.xml

to boot a Scientific Linux 5.5 image.  I have gone through the libvirt
domain xml format at

http://libvirt.org/formatdomain.html#elementsResources

and I don't see anywhere to set the hostname in there.  I am using pygrub
for the bootloader and noticed the  "bootloader_args" element.  Can I pass
an argument to the kernel at boot to set the hostname?  Can I pass anything
to the kernel at boot time?  Nothing I have tried seems to work.  I have
tried sifting through the pygrub code (for lack of documentation) and no
luck yet.  I think my challenge is with pygrub but any help would be
appreciated.  I have also posted this at

http://lists.xensource.com/archives/html/xen-users/2010-10/msg00143.html

and

http://www.linuxquestions.org/questions/linux-virtualization-90/setting-hostname-in-xen-config-xml-file-836993/


but still waiting...

Cheers,

David


[Attachment #3 (text/html)]

&lt;br&gt;
I am trying to set the hostname of VMs at boot time and banging my head against the \
wall.  I am using&lt;br&gt; &lt;br&gt;
virsh create xen-config.xml&lt;br&gt;
&lt;br&gt;
to boot a Scientific Linux 5.5 image.  I have gone through the libvirt domain xml \
format at&lt;br&gt; &lt;br&gt;
&lt;a href="http://libvirt.org/formatdomain.html#elementsResources"&gt;http://libvirt.org/formatdomain.html#elementsResources&lt;/a&gt;&lt;br&gt;
 &lt;br&gt;
and I don't see anywhere to set the hostname in there.  I am using
pygrub for the bootloader and noticed the  "bootloader_args" element.
 Can I pass an argument to the kernel at boot to set the hostname? 
Can I pass anything to the kernel at boot time?  Nothing I have tried seems to work.  \
I have tried sifting through the pygrub code (for lack of documentation) and no luck \
yet.  I think my challenge is with pygrub but any help would be appreciated.  I have \
also posted this at &lt;br&gt; &lt;br&gt;&lt;a \
href="http://lists.xensource.com/archives/html/xen-users/2010-10/msg00143.html"&gt;http:/ \
/lists.xensource.com/archives/html/xen-users/2010-10/msg00143.html&lt;/a&gt;&lt;br&gt;&lt;br&gt;and \
&lt;br&gt;&lt;br&gt;&lt;a href="http://www.linuxquestions.org/questions/linux-virtualization-90/setti \
ng-hostname-in-xen-config-xml-file-836993/"&gt;http://www.linuxquestions.org/questions/linux-virtualization-90/setting-hostname-in-xen-config-xml-file-836993/&lt;/a&gt;&lt;br&gt;
 &lt;br&gt;but still waiting...&lt;br&gt;
&lt;br&gt;
Cheers,&lt;br&gt;
&lt;br&gt;
David 



</body></email><email><emailId>20101013005202</emailId><senderName>Mike Hall</senderName><senderEmail>mhall@astc.nt.gov.au</senderEmail><timestampReceived>2010-10-13 00:52:02-0400</timestampReceived><subject>Re: [libvirt-users] Question about use libvirt</subject><body>

Original message:
For a new system to develop, I need to know if I can use libvirt for to get=
 (listen) the information that pass trought the lan (vlan) of the each VM.

Marcela's perfect Spanish:

 quiero saber si utilizando esta libreria, puedo utilizar alguna funci=F3n =
que me permita capturar los mensajes que se envian aplicaciones paralelas d=
e paso de mensajes que se ejecutan en las m=E1quinas virtuales.

Mike's imperfect translation:

"I need to know if, using this library (libvirt), I can use a function that=
 allows me to capture information sent by applications in parallel to/in ad=
dition to information passed by virtual machines"


I'm no expert, but I don't think libvirt has access, via virtual networking=
, to data sent by applications running in virtual machines. My guess is tha=
t such data would be accessible in the same way as with physical machines o=
n a physical network (eg tcpdump?).

Mike


[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;
&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;Message&lt;/TITLE&gt;
&lt;META http-equiv=Content-Type content="text/html; charset=iso-8859-1"&gt;
&lt;META content="MSHTML 6.00.6000.17080" name=GENERATOR&gt;&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;DIV&gt;&lt;SPAN class=148582100-13102010&gt;&lt;FONT face=Arial color=#0000ff 
size=2&gt;Original message:&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;SPAN class=148582100-13102010&gt;&lt;FONT face=Arial color=#0000ff size=2&gt;&lt;FONT 
face="Times New Roman" color=#000000 size=3&gt;For a new system to develop, I need 
to know if I can use libvirt for to get (listen) the information that pass 
trought the lan (vlan) of the each VM.&lt;/FONT&gt;&lt;BR&gt;&lt;/DIV&gt;&lt;/FONT&gt;&lt;/SPAN&gt;
&lt;DIV&gt;&lt;SPAN class=148582100-13102010&gt;&lt;FONT face=Arial color=#0000ff 
size=2&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;SPAN class=148582100-13102010&gt;&lt;FONT face=Arial color=#0000ff 
size=2&gt;Marcela's perfect Spanish:&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;SPAN class=148582100-13102010&gt;&lt;/SPAN&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;SPAN class=148582100-13102010&gt;&lt;/SPAN&gt;quiero saber si utilizando esta 
libreria, puedo utilizar alguna funcin que me permita capturar los mensajes que 
se envian aplicaciones paralelas de paso de mensajes que se ejecutan en las 
mquinas virtuales.&lt;BR&gt;&lt;SPAN class=148582100-13102010&gt;&lt;FONT face=Arial 
color=#0000ff size=2&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;SPAN class=148582100-13102010&gt;&lt;FONT face=Arial color=#0000ff size=2&gt;Mike's 
imperfect translation:&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;SPAN class=148582100-13102010&gt;&lt;FONT face=Arial color=#0000ff 
size=2&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;SPAN class=148582100-13102010&gt;&lt;FONT face=Arial color=#0000ff size=2&gt;"I 
need to know if, using this library (libvirt), I can use a function that allows 
me to capture informationsent by applications in parallel to/in addition 
to information passed by virtual machines"&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;SPAN class=148582100-13102010&gt;&lt;FONT face=Arial color=#0000ff 
size=2&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;SPAN class=148582100-13102010&gt;&lt;FONT face=Arial color=#0000ff 
size=2&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;SPAN class=148582100-13102010&gt;&lt;FONT face=Arial color=#0000ff size=2&gt;I'm no 
expert, but I don't think libvirthas access, viavirtual 
networking,to datasent by applications running in virtual machines. 
My guess is thatsuch data would be accessible in the same way as with 
physical machines on a physical network (eg tcpdump?).&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;SPAN class=148582100-13102010&gt;&lt;FONT face=Arial color=#0000ff 
size=2&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;SPAN class=148582100-13102010&gt;&lt;FONT face=Arial color=#0000ff 
size=2&gt;Mike&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;
&lt;BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px"&gt;
  &lt;DIV class=gmail_quote&gt;&lt;FONT face=Arial color=#0000ff 
  size=2&gt;&lt;/FONT&gt;&lt;/DIV&gt;&lt;/BLOCKQUOTE&gt;&lt;/BODY&gt;&lt;/HTML&gt;


</body></email><email><emailId>20101008073512</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-10-08 07:35:12-0400</timestampReceived><subject>Re: [libvirt-users] Mac OS X: dyld: lazy symbol binding failed</subject><body>

On 10/08/2010 06:00 PM, Mitchell Hashimoto wrote:
&gt; I'm using the Ruby/FFI libvirt library and getting this consistently
&gt; on Mac OS X:
&gt;
&gt; ruby-1.9.2-p0&gt;  FFI::Libvirt.virInitialize
&gt; dyld: lazy symbol binding failed: Symbol not found: _virThreadInitialize
&gt;    Referenced from: /usr/local/lib/libvirt.dylib
&gt;    Expected in: flat namespace
&gt;
&gt; dyld: Symbol not found: _virThreadInitialize
&gt;    Referenced from: /usr/local/lib/libvirt.dylib
&gt;    Expected in: flat namespace
&gt;
&gt; Trace/BPT trap
&gt;
&gt; I exported DYLD_PRINT_LIBRARIES and it shows that libvirt.dylib is
&gt; loaded in the process space, but the above still occurs. When I
&gt; statically link into a C program it works fine, however. Anyone have
&gt; any idea what could be causing this?
&gt;
&gt; If this doesn't get a response, I'll post it to the dev list, since
&gt; its perhaps relevant to them as well.

Hi Mitchell,

Which build of libvirt do you have on the OSX box?

Asking because some work has been happening recently to get libvirt
into the Homebrew packaging (on OSX).

The version added yesterday (0.8.4-6) is the latest one, so I'm
thinking it might be worth trying that if you're using an older
version?

Regards and best wishes,

Justin Clift

</body></email><email><emailId>20101008083629</emailId><senderName>Mitchell Hashimoto</senderName><senderEmail>mitchell.hashimoto@gmail.com</senderEmail><timestampReceived>2010-10-08 08:36:29-0400</timestampReceived><subject>Re: [libvirt-users] Mac OS X: dyld: lazy symbol binding failed</subject><body>

Justin,

I saw your commit into homebrew and I am actually trying that. Like I
said, statically linking it to a test C program I wrote worked fine,
but working over FFI and dynamically loading it failed with the quoted
error message. I'm unsure how to proceed at this point. :)

Thanks a lot for the homebrew recipe, saved me some work there.

Best,
Mitchell

On Fri, Oct 8, 2010 at 12:35 AM, Justin Clift &lt;jclift@redhat.com&gt; wrote:
&gt; On 10/08/2010 06:00 PM, Mitchell Hashimoto wrote:
&gt;&gt;
&gt;&gt; I'm using the Ruby/FFI libvirt library and getting this consistently
&gt;&gt; on Mac OS X:
&gt;&gt;
&gt;&gt; ruby-1.9.2-p0&gt;  FFI::Libvirt.virInitialize
&gt;&gt; dyld: lazy symbol binding failed: Symbol not found: _virThreadInitialize
&gt;&gt;   Referenced from: /usr/local/lib/libvirt.dylib
&gt;&gt;   Expected in: flat namespace
&gt;&gt;
&gt;&gt; dyld: Symbol not found: _virThreadInitialize
&gt;&gt;   Referenced from: /usr/local/lib/libvirt.dylib
&gt;&gt;   Expected in: flat namespace
&gt;&gt;
&gt;&gt; Trace/BPT trap
&gt;&gt;
&gt;&gt; I exported DYLD_PRINT_LIBRARIES and it shows that libvirt.dylib is
&gt;&gt; loaded in the process space, but the above still occurs. When I
&gt;&gt; statically link into a C program it works fine, however. Anyone have
&gt;&gt; any idea what could be causing this?
&gt;&gt;
&gt;&gt; If this doesn't get a response, I'll post it to the dev list, since
&gt;&gt; its perhaps relevant to them as well.
&gt;
&gt; Hi Mitchell,
&gt;
&gt; Which build of libvirt do you have on the OSX box?
&gt;
&gt; Asking because some work has been happening recently to get libvirt
&gt; into the Homebrew packaging (on OSX).
&gt;
&gt; The version added yesterday (0.8.4-6) is the latest one, so I'm
&gt; thinking it might be worth trying that if you're using an older
&gt; version?
&gt;
&gt; Regards and best wishes,
&gt;
&gt; Justin Clift
&gt;

</body></email><email><emailId>20101008085052</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-10-08 08:50:52-0400</timestampReceived><subject>Re: [libvirt-users] Mac OS X: dyld: lazy symbol binding failed</subject><body>

On 10/08/2010 07:36 PM, Mitchell Hashimoto wrote:
&gt; Justin,
&gt;
&gt; I saw your commit into homebrew and I am actually trying that. Like I
&gt; said, statically linking it to a test C program I wrote worked fine,
&gt; but working over FFI and dynamically loading it failed with the quoted
&gt; error message. I'm unsure how to proceed at this point. :)

No worries.  Does "_virThreadInitialize" exist in the dynamic library
on your system?

   $ nm /usr/local/lib/libvirt.dylib | grep Thread
   00000000001a9c40 d _virTLSThreadImpl
   00000000000125d0 T _virThreadInitialize
   0000000000012600 T _virThreadLocalGet
   0000000000012610 T _virThreadLocalInit
   00000000000125f0 T _virThreadLocalSet
   00000000000125e0 T _virThreadOnExit
   $

Guessing it probably does, but figured it's worth checking. :)

Regards and best wishes,

Justin Clift

</body></email><email><emailId>20101008171124</emailId><senderName>Mitchell Hashimoto</senderName><senderEmail>mitchell.hashimoto@gmail.com</senderEmail><timestampReceived>2010-10-08 17:11:24-0400</timestampReceived><subject>Re: [libvirt-users] Mac OS X: dyld: lazy symbol binding failed</subject><body>

Justin,

Yep:

~  nm /usr/local/lib/libvirt.dylib | grep Thread
00000000001aec20 d _virTLSThreadImpl
0000000000011fd0 T _virThreadInitialize
0000000000012000 T _virThreadLocalGet
0000000000012010 T _virThreadLocalInit
0000000000011ff0 T _virThreadLocalSet
0000000000011fe0 T _virThreadOnExit

And here is the output when running the test ruby file with
DYLD_PRINT_LIBRARIES on, gisted since its quite long, but you can see
libvirt in it prior to running the Ruby FFI code:

https://gist.github.com/e90831db740cb0bff563

Any ideas?

Mitchell

On Fri, Oct 8, 2010 at 1:50 AM, Justin Clift &lt;jclift@redhat.com&gt; wrote:
&gt; On 10/08/2010 07:36 PM, Mitchell Hashimoto wrote:
&gt;&gt;
&gt;&gt; Justin,
&gt;&gt;
&gt;&gt; I saw your commit into homebrew and I am actually trying that. Like I
&gt;&gt; said, statically linking it to a test C program I wrote worked fine,
&gt;&gt; but working over FFI and dynamically loading it failed with the quoted
&gt;&gt; error message. I'm unsure how to proceed at this point. :)
&gt;
&gt; No worries.  Does "_virThreadInitialize" exist in the dynamic library
&gt; on your system?
&gt;
&gt;  $ nm /usr/local/lib/libvirt.dylib | grep Thread
&gt;  00000000001a9c40 d _virTLSThreadImpl
&gt;  00000000000125d0 T _virThreadInitialize
&gt;  0000000000012600 T _virThreadLocalGet
&gt;  0000000000012610 T _virThreadLocalInit
&gt;  00000000000125f0 T _virThreadLocalSet
&gt;  00000000000125e0 T _virThreadOnExit
&gt;  $
&gt;
&gt; Guessing it probably does, but figured it's worth checking. :)
&gt;
&gt; Regards and best wishes,
&gt;
&gt; Justin Clift
&gt;

</body></email><email><emailId>20101008175902</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-10-08 17:59:02-0400</timestampReceived><subject>Re: [libvirt-users] Mac OS X: dyld: lazy symbol binding failed</subject><body>

On 10/09/2010 04:11 AM, Mitchell Hashimoto wrote:
&gt; Justin,
&gt;
&gt; Yep:
&gt;
&gt; ~  nm /usr/local/lib/libvirt.dylib | grep Thread
&gt; 00000000001aec20 d _virTLSThreadImpl
&gt; 0000000000011fd0 T _virThreadInitialize
&gt; 0000000000012000 T _virThreadLocalGet
&gt; 0000000000012010 T _virThreadLocalInit
&gt; 0000000000011ff0 T _virThreadLocalSet
&gt; 0000000000011fe0 T _virThreadOnExit
&gt;
&gt; And here is the output when running the test ruby file with
&gt; DYLD_PRINT_LIBRARIES on, gisted since its quite long, but you can see
&gt; libvirt in it prior to running the Ruby FFI code:
&gt;
&gt; https://gist.github.com/e90831db740cb0bff563
&gt;
&gt; Any ideas?

Unfortunately no.  This is seriously past my depth of knowledge atm. :(

Probably best to ask on the libvirt developers mailing list, as one of
the guys there (maybe Eric Blake or Chris Lalancette) might have ideas
about what's wrong.

Hmmm, I wonder if it's a 32-bit vs 64-bit thing?  Maybe the libvirt
package should be installed as a "universal binary"?  I'm not sure
how to update it for that though.  Kind of new to OSX. :/


&gt; Mitchell

</body></email><email><emailId>20101008181949</emailId><senderName>Mitchell Hashimoto</senderName><senderEmail>mitchell.hashimoto@gmail.com</senderEmail><timestampReceived>2010-10-08 18:19:49-0400</timestampReceived><subject>Re: [libvirt-users] Mac OS X: dyld: lazy symbol binding failed</subject><body>

Justin,

No problem, I appreciate you even responding/attempting. I'll
cross-post this onto libvirt-dev then.

As for the alternate FFI API, this is was due to a bug in a very early
version of the Ruby FFI bridge. By default, all FFI libraries are now
loaded using DynamicLibrary#open, as far as I know (I've contributed
some to the project). I'll take a look again to make sure this is
still the case.

Thanks,
Mitchell

On Fri, Oct 8, 2010 at 10:59 AM, Justin Clift &lt;jclift@redhat.com&gt; wrote:
&gt; On 10/09/2010 04:11 AM, Mitchell Hashimoto wrote:
&gt;&gt;
&gt;&gt; Justin,
&gt;&gt;
&gt;&gt; Yep:
&gt;&gt;
&gt;&gt; ~  nm /usr/local/lib/libvirt.dylib | grep Thread
&gt;&gt; 00000000001aec20 d _virTLSThreadImpl
&gt;&gt; 0000000000011fd0 T _virThreadInitialize
&gt;&gt; 0000000000012000 T _virThreadLocalGet
&gt;&gt; 0000000000012010 T _virThreadLocalInit
&gt;&gt; 0000000000011ff0 T _virThreadLocalSet
&gt;&gt; 0000000000011fe0 T _virThreadOnExit
&gt;&gt;
&gt;&gt; And here is the output when running the test ruby file with
&gt;&gt; DYLD_PRINT_LIBRARIES on, gisted since its quite long, but you can see
&gt;&gt; libvirt in it prior to running the Ruby FFI code:
&gt;&gt;
&gt;&gt; https://gist.github.com/e90831db740cb0bff563
&gt;&gt;
&gt;&gt; Any ideas?
&gt;
&gt; Unfortunately no.  This is seriously past my depth of knowledge atm. :(
&gt;
&gt; Probably best to ask on the libvirt developers mailing list, as one of
&gt; the guys there (maybe Eric Blake or Chris Lalancette) might have ideas
&gt; about what's wrong.
&gt;
&gt; Hmmm, I wonder if it's a 32-bit vs 64-bit thing?  Maybe the libvirt
&gt; package should be installed as a "universal binary"?  I'm not sure
&gt; how to update it for that though.  Kind of new to OSX. :/
&gt;
&gt;
&gt;&gt; Mitchell
&gt;
&gt;

</body></email><email><emailId>20101012123611</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-10-12 12:36:11-0400</timestampReceived><subject>Re: [libvirt-users] Mac OS X: dyld: lazy symbol binding failed</subject><body>

On 10/09/2010 05:19 AM, Mitchell Hashimoto wrote:
&gt; Justin,
&gt;
&gt; No problem, I appreciate you even responding/attempting. I'll
&gt; cross-post this onto libvirt-dev then.

Heh.  They forwarded it to me internally, as I've "been doing stuff for 
OSX". :/

One of them did point out that it's probably something to do with the
linker not exporting a symbol on MacOS X for some reason.

By default (so I'm told), libvirt uses some kind of linker script to
do the linking at compile time, and the symbols it exports are in the
file &lt;libvirt_source_dir&gt;/src/libvirt_public.syms.

It looks to be a plain text file of simple structure, but there's no
mention of the word "Thread" in it anywhere.

Don't suppose you know much about linking scripts? :)

(yeah, I'm reaching :&gt;)


&gt; As for the alternate FFI API, this is was due to a bug in a very early
&gt; version of the Ruby FFI bridge. By default, all FFI libraries are now
&gt; loaded using DynamicLibrary#open, as far as I know (I've contributed
&gt; some to the project). I'll take a look again to make sure this is
&gt; still the case.
&gt;
&gt; Thanks,
&gt; Mitchell

</body></email><email><emailId>20101011173603</emailId><senderName>Dan Johansson</senderName><senderEmail>kvm@dmj.nu</senderEmail><timestampReceived>2010-10-11 17:36:03-0400</timestampReceived><subject>Re: [libvirt-users] Problems with libvirt / qemu</subject><body>

Yes, the image contains an OS (it works if I start the guest manually).

-- 
Dan

On Monday 11 October 2010 03.41:29 jbuy0710 wrote:
&gt; The image contains an OS or not?
&gt; If not, you can't choose to boot from disk like "&lt;boot dev='hd'/&gt;"
&gt; 
&gt; 2010/10/10 Dan Johansson &lt;kvm@dmj.nu&gt;:
&gt; &gt; HI,
&gt; &gt; 
&gt; &gt; I have a small problem with libvirt / qemu. I have created a guest and when I \
&gt; &gt; start it from the command-line the guests starts OK, but when I start the guest \
&gt; &gt; through libvirt with "virsh start" I get "Booting from Hard Disk... Boot failed: \
&gt; &gt; not a bootable disk No bootable device"
&gt; &gt; 
&gt; &gt; This is the command-line I use to start the guest (which works)
&gt; &gt; "cd /var/lib/kvm/Wilmer;  /usr/bin/qemu-system-x86_64 --enable-kvm \
&gt; &gt; -net nic,vlan=1,model=rtl8139,macaddr=DE:ED:BE:EF:01:03 -net \
&gt; &gt;                 tap,vlan=1,ifname=qtap13,script=no,downscript=no \
&gt; &gt; -net nic,vlan=3,model=rtl8139,macaddr=DE:ED:BE:EF:03:03 -net \
&gt; &gt;                 tap,vlan=3,ifname=qtap33,script=no,downscript=no \
&gt; &gt; -m 2048 -k de-ch -vnc :3 -daemonize \
&gt; &gt; Wilmer.qcow2"
&gt; &gt; 
&gt; &gt; 
&gt; &gt; The libvirt XML-file was created using "virsh domxml-from-native qemu-argv" and \
&gt; &gt; this is the result of that conversion: &lt;domain type='kvm'&gt;
&gt; &gt; &lt;name&gt;wilmer&lt;/name&gt;
&gt; &gt; &lt;uuid&gt;a421968d-0573-1356-8cb7-32caff525a03&lt;/uuid&gt;
&gt; &gt; &lt;memory&gt;2097152&lt;/memory&gt;
&gt; &gt; &lt;currentMemory&gt;2097152&lt;/currentMemory&gt;
&gt; &gt; &lt;vcpu&gt;2&lt;/vcpu&gt;
&gt; &gt; &lt;os&gt;
&gt; &gt; &lt;type arch='x86_64' machine='pc-0.12'&gt;hvm&lt;/type&gt;
&gt; &gt; &lt;boot dev='hd'/&gt;
&gt; &gt; &lt;/os&gt;
&gt; &gt; &lt;features&gt;
&gt; &gt; &lt;acpi/&gt;
&gt; &gt; &lt;/features&gt;
&gt; &gt; &lt;clock offset='utc'/&gt;
&gt; &gt; &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
&gt; &gt; &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
&gt; &gt; &lt;on_crash&gt;destroy&lt;/on_crash&gt;
&gt; &gt; &lt;devices&gt;
&gt; &gt; &lt;emulator&gt;/usr/bin/qemu-system-x86_64&lt;/emulator&gt;
&gt; &gt; &lt;disk type='file' device='disk'&gt;
&gt; &gt; &lt;source file='/var/lib/kvm/Wilmer/Wilmer.qcow2'/&gt;
&gt; &gt; &lt;target dev='hda' bus='ide'/&gt;
&gt; &gt; &lt;address type='drive' controller='0' bus='0' unit='0'/&gt;
&gt; &gt; &lt;/disk&gt;
&gt; &gt; &lt;controller type='ide' index='0'&gt;
&gt; &gt; &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x01' function='0x1'/&gt;
&gt; &gt; &lt;/controller&gt;
&gt; &gt; &lt;interface type='ethernet'&gt;
&gt; &gt; &lt;mac address='de:ed:be:ef:01:03'/&gt;
&gt; &gt; &lt;script path='no'/&gt;
&gt; &gt; &lt;target dev='qtap13'/&gt;
&gt; &gt; &lt;model type='rtl8139'/&gt;
&gt; &gt; &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x04' function='0x0'/&gt;
&gt; &gt; &lt;/interface&gt;
&gt; &gt; &lt;interface type='ethernet'&gt;
&gt; &gt; &lt;mac address='de:ed:be:ef:03:03'/&gt;
&gt; &gt; &lt;script path='no'/&gt;
&gt; &gt; &lt;target dev='qtap33'/&gt;
&gt; &gt; &lt;model type='rtl8139'/&gt;
&gt; &gt; &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x05' function='0x0'/&gt;
&gt; &gt; &lt;/interface&gt;
&gt; &gt; &lt;input type='mouse' bus='ps2'/&gt;
&gt; &gt; &lt;graphics type='vnc' port='5903' autoport='no' listen=''/&gt;
&gt; &gt; &lt;video&gt;
&gt; &gt; &lt;model type='cirrus' vram='9216' heads='1'/&gt;
&gt; &gt; &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x02' function='0x0'/&gt;
&gt; &gt; &lt;/video&gt;
&gt; &gt; &lt;/devices&gt;
&gt; &gt; &lt;/domain&gt;
&gt; &gt; 
&gt; &gt; 
&gt; &gt; Anyone seeing something obvious that I have missed?
&gt; &gt; 
&gt; &gt; Regards,
&gt; &gt; --
&gt; &gt; Dan Johansson, &lt;http://www.dmj.nu&gt;
&gt; &gt; ***************************************************
&gt; &gt; This message is printed on 100% recycled electrons!
&gt; &gt; ***************************************************
&gt; &gt; 
&gt; &gt; _______________________________________________
&gt; &gt; libvirt-users mailing list
&gt; &gt; libvirt-users@redhat.com
&gt; &gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; &gt; 
&gt; 

-- 
Dan Johansson, &lt;http://www.dmj.nu&gt;
***************************************************
This message is printed on 100% recycled electrons!
***************************************************


</body></email><email><emailId>20101006111836</emailId><senderName>Ravi Pawar</senderName><senderEmail>ravifc@gmail.com</senderEmail><timestampReceived>2010-10-06 11:18:36-0400</timestampReceived><subject>[libvirt-users] Error while starting the domain "error: monitor socket did not show up.: Connection </subject><body>

All,

here is my domain xml

&lt;domain type='kvm'&gt;
  &lt;name&gt;tests&lt;/name&gt;
  &lt;uuid&gt;76bc677f-ee5b-ef0b-1d02-72d12785b1d8&lt;/uuid&gt;
  &lt;memory&gt;524288&lt;/memory&gt;
  &lt;currentMemory&gt;524288&lt;/currentMemory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='x86_64' machine='pc-0.12'&gt;hvm&lt;/type&gt;
    &lt;boot dev='network'/&gt;
  &lt;/os&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;destroy&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/libexec/qemu-kvm&lt;/emulator&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;source file='/var/lib/libvirt/images/testKVM'/&gt;
      &lt;target dev='hda' bus='ide'/&gt;
      &lt;address type='drive' controller='0' bus='0' unit='0'/&gt;
    &lt;/disk&gt;
    &lt;controller type='ide' index='0'/&gt;
    &lt;interface type='network'&gt;
      &lt;mac address='52:54:00:a4:0e:ce'/&gt;
      &lt;source network='default'/&gt;
      &lt;target dev='vnet0'/&gt;
    &lt;/interface&gt;
    &lt;input type='mouse' bus='ps2'/&gt;
    &lt;graphics type='vnc' port='-1' autoport='yes' listen='127.0.0.1'
keymap='en-us'/&gt;
    &lt;video&gt;
      &lt;model type='cirrus' vram='9216' heads='1'/&gt;
    &lt;/video&gt;
  &lt;/devices&gt;
&lt;/domain&gt;


my host is RHEL 6 beta.
i don't have any clue where i am going wrong in the configuration of the
host or configuration of the domain.

-- 
Thanks &amp; Regards

Ravi Pawar

[Attachment #3 (text/html)]

All,&lt;br&gt;&lt;br&gt;here is my domain xml&lt;br&gt;&lt;br&gt;&lt;domain type='kvm'&gt;&lt;br&gt;  \
&lt;name&gt;tests&lt;/name&gt;&lt;br&gt;  \
&lt;uuid&gt;76bc677f-ee5b-ef0b-1d02-72d12785b1d8&lt;/uuid&gt;&lt;br&gt;  \
&lt;memory&gt;524288&lt;/memory&gt;&lt;br&gt;  \
&lt;currentMemory&gt;524288&lt;/currentMemory&gt;&lt;br&gt;  &lt;vcpu&gt;1&lt;/vcpu&gt;&lt;br&gt; \
&lt;os&gt;&lt;br&gt;    &lt;type arch='x86_64' \
machine='pc-0.12'&gt;hvm&lt;/type&gt;&lt;br&gt;    &lt;boot \
dev='network'/&gt;&lt;br&gt;  &lt;/os&gt;&lt;br&gt;  &lt;clock \
offset='utc'/&gt;&lt;br&gt;  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;&lt;br&gt;  \
&lt;on_reboot&gt;restart&lt;/on_reboot&gt;&lt;br&gt;  \
&lt;on_crash&gt;destroy&lt;/on_crash&gt;&lt;br&gt;  &lt;devices&gt;&lt;br&gt;  \
&lt;emulator&gt;/usr/libexec/qemu-kvm&lt;/emulator&gt;&lt;br&gt;    &lt;disk \
type='file' device='disk'&gt;&lt;br&gt;      &lt;source \
file='/var/lib/libvirt/images/testKVM'/&gt;&lt;br&gt;      &lt;target \
dev='hda' bus='ide'/&gt;&lt;br&gt;  &lt;address type='drive' \
controller='0' bus='0' unit='0'/&gt;&lt;br&gt;    &lt;/disk&gt;&lt;br&gt; \
&lt;controller type='ide' index='0'/&gt;&lt;br&gt;    &lt;interface \
type='network'&gt;&lt;br&gt;  &lt;mac address='52:54:00:a4:0e:ce'/&gt;&lt;br&gt;  \
&lt;source network='default'/&gt;&lt;br&gt;      &lt;target \
dev='vnet0'/&gt;&lt;br&gt;    &lt;/interface&gt;&lt;br&gt;    &lt;input \
type='mouse' bus='ps2'/&gt;&lt;br&gt;  &lt;graphics type='vnc' \
port='-1' autoport='yes' listen='127.0.0.1' \
keymap='en-us'/&gt;&lt;br&gt;    &lt;video&gt;&lt;br&gt;      &lt;model \
type='cirrus' vram='9216' heads='1'/&gt;&lt;br&gt;  \
&lt;/video&gt;&lt;br&gt;  &lt;/devices&gt;&lt;br&gt;&lt;/domain&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;my host is RHEL 6 \
beta.&lt;br&gt;i don't have any clue where i am going wrong in the configuration of the \
host or configuration of the domain.&lt;br clear="all"&gt; &lt;br&gt;-- &lt;br&gt;Thanks &amp; \
Regards&lt;br&gt;&lt;br&gt;Ravi Pawar&lt;br&gt;



</body></email><email><emailId>20100922093310</emailId><senderName>Zdenek Styblik</senderName><senderEmail>stybla@turnovfree.net</senderEmail><timestampReceived>2010-09-22 09:33:10-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt] New wiki pages with libvirt SSH setup instructions</subject><body>

Hello Justin,

just to give you a feedback on link about SSHSetup.

On 09/14/2010 05:52 PM, Justin Clift wrote:
&gt; Hi all,
&gt; 
&gt; Just added some new pages to the wiki, this time covering how to
&gt; configure remote access to libvirt through SSH, not using root:
&gt; 
&gt;   http://wiki.libvirt.org/page/SSHSetup     &lt;--- entry page
&gt;   http://wiki.libvirt.org/page/SSHPolicyKitSetup
&gt; 
&gt; This has details for several different Linux distributions:
&gt; 
&gt;   * RHEL 5 &amp; 6
&gt;   * Fedora 11-13
&gt;   * Centos 5 &amp; 6
&gt;   * Ubuntu 10.04 Server &amp; Desktop
&gt;   * openSUSE 11.2 onwards
&gt; 
&gt; Does anyone have info they'd like to include for other distributions?
&gt; 

I was thinking about writing info for Slackware, because you've asked.
But I came to realize the page is written in such general way, it's
simply applicable to other distributions without any big troubles which
should be worth of writing up. At least that's my opinion. Of course it
doesn't mean there can't be pitfalls in other distributions.

I'm also pleased to know it's possible to grant "regular" user
management of libvirtd.

I think; good job is in order.

One thing though and that's access to virtual storage. Isn't there a
problem with group libvirt not having ACL to manipulate images as they
are created with root:root ownership? I'm aware of
&lt;permissions&gt;...&lt;/permissions&gt;, but so far I haven't been successful to
make it work (= ownership stayed as root:root no matter what; version
0.8.4).

Thanks and have a nice day,
Zdenek

-- 
Zdenek Styblik
Net/Linux admin
OS TurnovFree.net
email: stybla@turnovfree.net
jabber: stybla@jabber.turnovfree.net


&gt; :)
&gt; 
&gt; Regards and best wishes,
&gt; 
&gt; Justin Clift
&gt; 
&gt; -- 
&gt; libvir-list mailing list
&gt; libvir-list@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvir-list

</body></email><email><emailId>20100922122529</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-09-22 12:25:29-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt] New wiki pages with libvirt SSH setup instructions</subject><body>

On 09/22/2010 07:33 PM, Zdenek Styblik wrote:
&gt; I was thinking about writing info for Slackware, because you've asked.
&gt; But I came to realize the page is written in such general way, it's
&gt; simply applicable to other distributions without any big troubles which
&gt; should be worth of writing up.

Hmmmm, how does Slackware do the access control for the libvirt
management socket?

Any idea if it's using PolicyKit, or if it's using groups?

Asking because if it's using one of those two, then it's extremely
easy to add a new "Slackware" head and point people to the right bit.


 &gt; At least that's my opinion. Of course it
&gt; doesn't mean there can't be pitfalls in other distributions.

Yeah.  I'm kind of thinking that if we know how Slackware does it,
we should probably mention it.

That'll help people using things like (ie) Google, when they do
keyword searches for "+Libvirt +Slackware +access".  Without a mention 
of Slackware on the pages, search engines won't show it in the result 
list. :(

Plus... having more distributions on there helps to show off how 
cross-distribution libvirt is. :)


&gt; I'm also pleased to know it's possible to grant "regular" user
&gt; management of libvirtd.
&gt;
&gt; I think; good job is in order.

Thanks. :)


&gt; One thing though and that's access to virtual storage. Isn't there a
&gt; problem with group libvirt not having ACL to manipulate images as they
&gt; are created with root:root ownership? I'm aware of
&gt; &lt;permissions&gt;...&lt;/permissions&gt;, but so far I haven't been successful to
&gt; make it work (= ownership stayed as root:root no matter what; version
&gt; 0.8.4).

Hmmm, interesting thought.  It's not an area I've looked at from the 
perspective of access by non-root users.

Yeah, I should investigate that to ensure there aren't any pitfalls there.

Good thinking Zdenek. :)

Regards and best wishes,

Justin Clift

</body></email><email><emailId>20101004073609</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-10-04 07:36:09-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt] New wiki pages with libvirt SSH setup instructions</subject><body>

On 09/23/2010 08:08 PM, Zdenek Styblik wrote:
&lt;snip&gt;
&gt; I've managed to create ACL by groups and it's working. However, to my
&gt; surprise, there is Slackware package for PolicyKit. Yet, I have never
&gt; used it nor tested it (I could though?).

Interesting. :)

Ubuntu also has PolicyKit compiled into the client libraries, even 
though by default the libvirt daemon (server side) doesn't use it for
access control.

Suspecting it may be in order to allow connection to servers using
PolityKit for access control.  When compiling the libvirt virsh client
on MacOS X, there is no PolicyKit available.  Which somehow translates
into qemu+ssh:// connections to PolicyKit enabled servers not working.
(even though qemu+tcp:// and qemu+tls:// does).  Same thing happened
on when I manually compiled virsh _without_ PolicyKit on Fedora 13. 
Couldn't then connect to a PolicyKit enabled libvirtd with qemu+ssh://.

At some point, we should look at that.  It just doesn't seem like
how it's supposed to be. ;&gt;


&gt;&gt; Asking because if it's using one of those two, then it's extremely
&gt;&gt; easy to add a new "Slackware" head and point people to the right bit.
&gt;&gt;
&gt;
&gt; Probably both or it depends on whether PolicyKit is installed or not.
&gt; (T.B.D.?) Group ACL works for sure.

Cool.  We should document that as "group access configuration is known
to work" (or something along those lines), for Slackware.

Heh, don't suppose you have a wiki user account, and feel like doing the
edit?

(yes, I'm trying to encourage people to make updates directly. :&gt;)


&gt; First things first. I've messed up version number - 0.8.3 (0.8.4 is
&gt; virt-manager, now at 0.8.5). So now, it's tested with libvirt-0.8.4 for
&gt; sure.
&gt;
&gt; This works. Non-root user - VM management, creating images, VNC.
&gt;
&gt; Now, here comes part which is hard to describe.
&gt;
&gt; qemu-kvm - running as libvirt - great!
&gt; libvirtd - running as root - bad?
&gt;
&gt; I wanted to achieve something like that (= root-less qemu and libvirtd)
&gt; with 0.8.3, but it didn't work because libvirt/virt-manager claimed ACL
&gt; problem. I think it's time for re-test and eventual push into
&gt; "production" of mine :)

Ahhh, yeah.  I think I understand.  It looks like you're trying to have
a running virtualisation system, without it using root for anything.

Sounds like a good idea, but not sure if it can be made to work
that way yet. :&gt;

If you do get it working, definitely let me know.... we should write
it up if so. :)

Regards and best wishes,

Justin Clift

</body></email><email><emailId>20101109101406</emailId><senderName>Zdenek Styblik</senderName><senderEmail>stybla@turnovfree.net</senderEmail><timestampReceived>2010-11-09 10:14:06-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt] New wiki pages with libvirt SSH setup instructions</subject><body>

On 10/04/2010 09:36 AM, Justin Clift wrote:
&gt; On 09/23/2010 08:08 PM, Zdenek Styblik wrote:
[...]
&gt; 
&gt; Cool.  We should document that as "group access configuration is known
&gt; to work" (or something along those lines), for Slackware.
&gt; 
&gt; Heh, don't suppose you have a wiki user account, and feel like doing the
&gt; edit?
&gt; 
&gt; (yes, I'm trying to encourage people to make updates directly. :&gt;)
&gt; 

I know it took months to do, but:

http://wiki.libvirt.org/page/SSHSetup#Slackware

If anything else needs to be added (= get more chars there), let me know.
I mean, it's just couple lines and the most of them is just C&amp;P. Damn! :|

[...]

Have a nice day,
Zdenek

-- 
Zdenek Styblik
Net/Linux admin
OS TurnovFree.net
email: stybla@turnovfree.net
jabber: stybla@jabber.turnovfree.net

</body></email><email><emailId>20101003234529</emailId><senderName>Jonathan Kelley</senderName><senderEmail>jkelley@vm-labs.com</senderEmail><timestampReceived>2010-10-03 23:45:29-0400</timestampReceived><subject>Re: [libvirt-users] Ruby-libvirt and openAuth</subject><body>

I tried to use Libvirt::VIR_CRED_AUTHNAME in my ruby script but it fails.

Is this not implemented?

-Jon


On Fri, Oct 1, 2010 at 12:48 PM, Chris Lalancette &lt;clalance@redhat.com&gt;wrote:

&gt; On 09/30/10 - 09:51:10AM, Jonathan Kelley wrote:
&gt; &gt; Hello,
&gt; &gt;
&gt; &gt; It looks like the Ruby bindings do not support virConnectOpenAuth. Is
&gt; this
&gt; &gt; true? If so, is there any reason why? or plans to?
&gt;
&gt; I've recently implemented them; if you check in the upstream git repository
&gt; (http://libvirt.org/git/?p=ruby-libvirt.git;a=summary),
&gt; you'll see it.  I hope to do a release pretty soon with this (and some more
&gt; APIs) implemented.
&gt;
&gt; --
&gt; Chris Lalancette
&gt;

[Attachment #3 (text/html)]

I tried to use Libvirt::VIR_CRED_AUTHNAME in my ruby script but it \
fails.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is this not \
implemented?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-Jon&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;On Fri, Oct 1, 2010 at 12:48 PM, Chris Lalancette &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:clalance@redhat.com"&gt;clalance@redhat.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt; &lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;On 09/30/10 - \
09:51:10AM, Jonathan Kelley wrote:&lt;br&gt; &gt; Hello,&lt;br&gt;
&gt;&lt;br&gt;
&gt; It looks like the Ruby bindings do not support virConnectOpenAuth. Is this&lt;br&gt;
&gt; true? If so, is there any reason why? or plans to?&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;I've recently implemented them; if you check in the upstream git \
repository&lt;br&gt; (&lt;a href="http://libvirt.org/git/?p=ruby-libvirt.git;a=summary" \
target="_blank"&gt;http://libvirt.org/git/?p=ruby-libvirt.git;a=summary&lt;/a&gt;),&lt;br&gt; \
you'll see it.  I hope to do a release pretty soon with this (and some more&lt;br&gt; \
APIs) implemented.&lt;br&gt; &lt;br&gt;
--&lt;br&gt;
&lt;font color="#888888"&gt;Chris Lalancette&lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20101004123710</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2010-10-04 12:37:10-0400</timestampReceived><subject>Re: [libvirt-users] Ruby-libvirt and openAuth</subject><body>

On 10/03/10 - 07:45:29PM, Jonathan Kelley wrote:
&gt; I tried to use Libvirt::VIR_CRED_AUTHNAME in my ruby script but it fails.
&gt; 
&gt; Is this not implemented?

It's just called "Libvirt::CRED_AUTHNAME"; I figured the VIR_ was redundant,
so all of the constants don't have it.

-- 
Chris Lalancette

</body></email><email><emailId>20101004191905</emailId><senderName>Jonathan Kelley</senderName><senderEmail>jkelley@vm-labs.com</senderEmail><timestampReceived>2010-10-04 19:19:05-0400</timestampReceived><subject>Re: [libvirt-users] Ruby-libvirt and openAuth</subject><body>

Where from the git repository can I browse the ruby library?

Thanks.
-Jon


On Mon, Oct 4, 2010 at 8:37 AM, Chris Lalancette &lt;clalance@redhat.com&gt;wrote:

&gt; On 10/03/10 - 07:45:29PM, Jonathan Kelley wrote:
&gt; &gt; I tried to use Libvirt::VIR_CRED_AUTHNAME in my ruby script but it fails.
&gt; &gt;
&gt; &gt; Is this not implemented?
&gt;
&gt; It's just called "Libvirt::CRED_AUTHNAME"; I figured the VIR_ was
&gt; redundant,
&gt; so all of the constants don't have it.
&gt;
&gt; --
&gt; Chris Lalancette
&gt;

[Attachment #3 (text/html)]

Where from the git repository can I browse the ruby \
library?&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks.&lt;/div&gt;&lt;div&gt;-Jon&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;On Mon, Oct 4, 2010 at 8:37 AM, Chris Lalancette &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:clalance@redhat.com"&gt;clalance@redhat.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt; &lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt;&lt;div class="im"&gt;On 10/03/10 - 07:45:29PM, Jonathan \
Kelley wrote:&lt;br&gt; &gt; I tried to use Libvirt::VIR_CRED_AUTHNAME in my ruby script \
but it fails.&lt;br&gt; &gt;&lt;br&gt;
&gt; Is this not implemented?&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;It's just called "Libvirt::CRED_AUTHNAME"; I figured the VIR_ was \
redundant,&lt;br&gt; so all of the constants don't have it.&lt;br&gt;
&lt;br&gt;
--&lt;br&gt;
&lt;font color="#888888"&gt;Chris Lalancette&lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20101005014451</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-10-05 01:44:51-0400</timestampReceived><subject>Re: [libvirt-users] Ruby-libvirt and openAuth</subject><body>

On 10/05/2010 06:19 AM, Jonathan Kelley wrote:
&gt; Where from the git repository can I browse the ruby library?

Hi Jon,

Is this what you're looking for?

   http://libvirt.org/git/?p=ruby-libvirt.git;a=summary

Regards and best wishes,

Justin Clift


&gt; Thanks.
&gt; -Jon

</body></email><email><emailId>20101005032943</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2010-10-05 03:29:43-0400</timestampReceived><subject>Re: [libvirt-users] Ruby-libvirt and openAuth</subject><body>

On 10/04/10 - 03:19:05PM, Jonathan Kelley wrote:
&gt; Where from the git repository can I browse the ruby library?

I'm not quite sure I understand the question.  Are you looking for the rdocs
for the new APIs?  If so, I have not built them yet, and unfortunately there
is a bug in rdoc that prevents them from being properly built given the setup
that ruby-libvirt uses.  I found a patch to fix the problem, but it is not
upstream.  If you want, I can generate a private copy of the docs for you and
make them available.

If you were not asking about the rdocs, what were you asking about?

-- 
Chris Lalancette

</body></email><email><emailId>20101005132825</emailId><senderName>Jonathan Kelley</senderName><senderEmail>jkelley@vm-labs.com</senderEmail><timestampReceived>2010-10-05 13:28:25-0400</timestampReceived><subject>Re: [libvirt-users] Ruby-libvirt and openAuth</subject><body>

I am newer to Ruby so maybe I am expecting to see something I shouldn't.
With the Python bindings I can browse the source of the python binding. In
other words I am looking to see the implementation of these bindings.

The Rdoc would be helpful so if you want to generate it and send me a copy
that would be great.

Thanks,
Jon


On Mon, Oct 4, 2010 at 11:29 PM, Chris Lalancette &lt;clalance@redhat.com&gt;wrote:

&gt; On 10/04/10 - 03:19:05PM, Jonathan Kelley wrote:
&gt; &gt; Where from the git repository can I browse the ruby library?
&gt;
&gt; I'm not quite sure I understand the question.  Are you looking for the
&gt; rdocs
&gt; for the new APIs?  If so, I have not built them yet, and unfortunately
&gt; there
&gt; is a bug in rdoc that prevents them from being properly built given the
&gt; setup
&gt; that ruby-libvirt uses.  I found a patch to fix the problem, but it is not
&gt; upstream.  If you want, I can generate a private copy of the docs for you
&gt; and
&gt; make them available.
&gt;
&gt; If you were not asking about the rdocs, what were you asking about?
&gt;
&gt; --
&gt; Chris Lalancette
&gt;

[Attachment #3 (text/html)]

I am newer to Ruby so maybe I am expecting to see something I shouldn't. With the \
Python bindings I can browse the source of the python binding. In other words I am \
looking to see the implementation of these bindings.&lt;br&gt; &lt;br&gt;The Rdoc would be \
helpful so if you want to generate it and send me a copy that would be \
great.&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;Jon&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Mon, Oct 4, 2010 \
at 11:29 PM, Chris Lalancette &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:clalance@redhat.com"&gt;clalance@redhat.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt; \
&lt;blockquote class="gmail_quote" style="border-left: 1px solid rgb(204, 204, 204); \
margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;"&gt;&lt;div class="im"&gt;On 10/04/10 - \
03:19:05PM, Jonathan Kelley wrote:&lt;br&gt; &gt; Where from the git repository can I \
browse the ruby library?&lt;br&gt; &lt;br&gt;
&lt;/div&gt;I'm not quite sure I understand the question.  Are you looking for the \
rdocs&lt;br&gt; for the new APIs?  If so, I have not built them yet, and unfortunately \
there&lt;br&gt; is a bug in rdoc that prevents them from being properly built given the \
setup&lt;br&gt; that ruby-libvirt uses.  I found a patch to fix the problem, but it is \
not&lt;br&gt; upstream.  If you want, I can generate a private copy of the docs for you \
and&lt;br&gt; make them available.&lt;br&gt;
&lt;br&gt;
If you were not asking about the rdocs, what were you asking about?&lt;br&gt;
&lt;br&gt;
--&lt;br&gt;
&lt;font color="#888888"&gt;Chris Lalancette&lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20101005133637</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-10-05 13:36:37-0400</timestampReceived><subject>Re: [libvirt-users] Ruby-libvirt and openAuth</subject><body>

On 10/06/2010 12:28 AM, Jonathan Kelley wrote:
&gt; I am newer to Ruby so maybe I am expecting to see something I shouldn't.
&gt; With the Python bindings I can browse the source of the python binding. In
&gt; other words I am looking to see the implementation of these bindings.

Ahhhh.  This link is for the online, browsable ruby bindings source
code for libvirt:

   http://libvirt.org/git/?p=ruby-libvirt.git;a=tree

It's a little bit different from the one I sent before, and I *think*
this is what you want.

Does this help?

Regards and best wishes,

Justin Clift


&gt; The Rdoc would be helpful so if you want to generate it and send me a copy
&gt; that would be great.
&gt;
&gt; Thanks,
&gt; Jon

</body></email><email><emailId>20101005135825</emailId><senderName>Jonathan Kelley</senderName><senderEmail>jkelley@vm-labs.com</senderEmail><timestampReceived>2010-10-05 13:58:25-0400</timestampReceived><subject>Re: [libvirt-users] Ruby-libvirt and openAuth</subject><body>

I guess I was expecting to find a ruby library making calls into the C
library like the Python libvirt.py that is generated.

I saw these files and thought I was missing something but I understand now
the difference between the Ruby and Python bindings.

Thanks,
Jon


On Tue, Oct 5, 2010 at 9:36 AM, Justin Clift &lt;jclift@redhat.com&gt; wrote:

&gt; On 10/06/2010 12:28 AM, Jonathan Kelley wrote:
&gt;
&gt;&gt; I am newer to Ruby so maybe I am expecting to see something I shouldn't.
&gt;&gt; With the Python bindings I can browse the source of the python binding. In
&gt;&gt; other words I am looking to see the implementation of these bindings.
&gt;&gt;
&gt;
&gt; Ahhhh.  This link is for the online, browsable ruby bindings source
&gt; code for libvirt:
&gt;
&gt;  http://libvirt.org/git/?p=ruby-libvirt.git;a=tree
&gt;
&gt; It's a little bit different from the one I sent before, and I *think*
&gt; this is what you want.
&gt;
&gt; Does this help?
&gt;
&gt;
&gt; Regards and best wishes,
&gt;
&gt; Justin Clift
&gt;
&gt;
&gt;  The Rdoc would be helpful so if you want to generate it and send me a copy
&gt;&gt; that would be great.
&gt;&gt;
&gt;&gt; Thanks,
&gt;&gt; Jon
&gt;&gt;
&gt;
&gt;

[Attachment #3 (text/html)]

I guess I was expecting to find a ruby library making calls into the C library like \
the Python libvirt.py that is generated.&lt;br&gt;&lt;br&gt;I saw these files and thought I was \
missing something but I understand now the difference between the Ruby and Python \
bindings.&lt;br&gt; &lt;br&gt;Thanks,&lt;br&gt;Jon&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Tue, Oct 5, \
2010 at 9:36 AM, Justin Clift &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:jclift@redhat.com"&gt;jclift@redhat.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="border-left: 1px solid rgb(204, 204, \
204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;"&gt; &lt;div class="im"&gt;On 10/06/2010 \
12:28 AM, Jonathan Kelley wrote:&lt;br&gt; &lt;blockquote class="gmail_quote" \
style="border-left: 1px solid rgb(204, 204, 204); margin: 0pt 0pt 0pt 0.8ex; \
padding-left: 1ex;"&gt; I am newer to Ruby so maybe I am expecting to see something I \
shouldn't.&lt;br&gt; With the Python bindings I can browse the source of the python \
binding. In&lt;br&gt; other words I am looking to see the implementation of these \
bindings.&lt;br&gt; &lt;/blockquote&gt;
&lt;br&gt;&lt;/div&gt;
Ahhhh.  This link is for the online, browsable ruby bindings source&lt;br&gt;
code for libvirt:&lt;br&gt;
&lt;br&gt;
  &lt;a href="http://libvirt.org/git/?p=ruby-libvirt.git;a=tree" \
target="_blank"&gt;http://libvirt.org/git/?p=ruby-libvirt.git;a=tree&lt;/a&gt;&lt;br&gt; &lt;br&gt;
It's a little bit different from the one I sent before, and I *think*&lt;br&gt;
this is what you want.&lt;br&gt;
&lt;br&gt;
Does this help?&lt;div class="im"&gt;&lt;br&gt;
&lt;br&gt;
Regards and best wishes,&lt;br&gt;
&lt;br&gt;
Justin Clift&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;&lt;blockquote class="gmail_quote" \
style="border-left: 1px solid rgb(204, 204, 204); margin: 0pt 0pt 0pt 0.8ex; \
padding-left: 1ex;"&gt; The Rdoc would be helpful so if you want to generate it and send \
me a copy&lt;br&gt; that would be great.&lt;br&gt;
&lt;br&gt;
Thanks,&lt;br&gt;
Jon&lt;br&gt;
&lt;/blockquote&gt;
&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20101005140814</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2010-10-05 14:08:14-0400</timestampReceived><subject>Re: [libvirt-users] Ruby-libvirt and openAuth</subject><body>

On 10/05/10 - 09:58:25AM, Jonathan Kelley wrote:
&gt; I guess I was expecting to find a ruby library making calls into the C
&gt; library like the Python libvirt.py that is generated.
&gt; 
&gt; I saw these files and thought I was missing something but I understand now
&gt; the difference between the Ruby and Python bindings.

Ah, no.  The way that this particular binding works is that it is all C code
that bridges between the libvirt C api and the various rb_* routines to hook
it into ruby.  There are other approaches possible, including something
called FFI, but I haven't really looked at them.

I've sent you the RDoc documentation for what is in git in a private email.
Once I do the next release I will post this updated documentation to the
website.

-- 
Chris Lalancette

</body></email><email><emailId>20101006174443</emailId><senderName>Jonathan Kelley</senderName><senderEmail>jkelley@vm-labs.com</senderEmail><timestampReceived>2010-10-06 17:44:43-0400</timestampReceived><subject>Re: [libvirt-users] Ruby-libvirt and openAuth</subject><body>

Anyone have any luck using libvirt library inside a ruby cgi script?

I am getting load errors (Internal Server Error) on failing to find
_libvirt. The same script works fine run from the cmd shell.

My webserver is lighttpd.

Thanks,
Jon

On Tue, Oct 5, 2010 at 10:08 AM, Chris Lalancette &lt;clalance@redhat.com&gt;wrote:

&gt; On 10/05/10 - 09:58:25AM, Jonathan Kelley wrote:
&gt; &gt; I guess I was expecting to find a ruby library making calls into the C
&gt; &gt; library like the Python libvirt.py that is generated.
&gt; &gt;
&gt; &gt; I saw these files and thought I was missing something but I understand
&gt; now
&gt; &gt; the difference between the Ruby and Python bindings.
&gt;
&gt; Ah, no.  The way that this particular binding works is that it is all C
&gt; code
&gt; that bridges between the libvirt C api and the various rb_* routines to
&gt; hook
&gt; it into ruby.  There are other approaches possible, including something
&gt; called FFI, but I haven't really looked at them.
&gt;
&gt; I've sent you the RDoc documentation for what is in git in a private email.
&gt; Once I do the next release I will post this updated documentation to the
&gt; website.
&gt;
&gt; --
&gt; Chris Lalancette
&gt;

[Attachment #3 (text/html)]

Anyone have any luck using libvirt library inside a ruby cgi \
script?&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I am getting load errors (Internal Server Error) on \
failing to find _libvirt. The same script works fine run from the cmd shell. &lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;My webserver is \
lighttpd.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;Jon&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;On Tue, Oct 5, 2010 at 10:08 AM, Chris Lalancette &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:clalance@redhat.com"&gt;clalance@redhat.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt; &lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt;&lt;div class="im"&gt;On 10/05/10 - 09:58:25AM, Jonathan \
Kelley wrote:&lt;br&gt; &gt; I guess I was expecting to find a ruby library making calls \
into the C&lt;br&gt; &gt; library like the Python libvirt.py that is generated.&lt;br&gt;
&gt;&lt;br&gt;
&gt; I saw these files and thought I was missing something but I understand now&lt;br&gt;
&gt; the difference between the Ruby and Python bindings.&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;Ah, no.  The way that this particular binding works is that it is all C \
code&lt;br&gt; that bridges between the libvirt C api and the various rb_* routines to \
hook&lt;br&gt; it into ruby.  There are other approaches possible, including something&lt;br&gt;
called FFI, but I haven't really looked at them.&lt;br&gt;
&lt;br&gt;
I've sent you the RDoc documentation for what is in git in a private email.&lt;br&gt;
Once I do the next release I will post this updated documentation to the&lt;br&gt;
website.&lt;br&gt;
&lt;br&gt;
--&lt;br&gt;
&lt;font color="#888888"&gt;Chris Lalancette&lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20101004062922</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-10-04 06:29:22-0400</timestampReceived><subject>Re: [libvirt-users] Mounting an lvm</subject><body>

On 10/04/2010 05:13 PM, Dale Amon wrote:
&lt;snip&gt;
&gt; I converted a system disk from a virtualbox
&gt; VM and added to the config on a qemu VM.
&gt; All seems well until I try to mount it. The
&gt; virtual machine shows data for the disk
&gt; image using commands like:
&gt;
&gt; 	pvs
&gt; 	lvs
&gt; 	lvdisplay xena-1
&gt;
&gt; but there is no /dev/xena-1/root to be
&gt; mounted. I also cannot seem to figure out
&gt; whether the lvm related modules are available
&gt; for the virtual machine kernel.
&gt;
&gt; Has anyone else tried playing this game?

Not me personally.  But... having the word "xen"
in the name of the lvm volume is kind of worrying.

Xen is an older hypervisor, which KVM is kind of a
replacement for.  So, I'm wondering what else (if
anything) may have gone a bit wonky in the conversion
process.

Do you have the commands you used for converting the
system disk from VirtualBox to QEMU?  If so, can
you cut-n-paste them here?  Thinking there might be
a gotcha or something in that can be pointed out
easily. :)

Regards and best wishes,

Justin Clift

</body></email><email><emailId>20101004065011</emailId><senderName>Dale Amon</senderName><senderEmail>amon@vnl.com</senderEmail><timestampReceived>2010-10-04 06:50:11-0400</timestampReceived><subject>Re: [libvirt-users] Mounting an lvm</subject><body>


On Mon, Oct 04, 2010 at 05:29:22PM +1100, Justin Clift wrote:
&gt; On 10/04/2010 05:13 PM, Dale Amon wrote:
&gt; &lt;snip&gt;
&gt; &gt; I converted a system disk from a virtualbox
&gt; &gt; VM and added to the config on a qemu VM.
&gt; &gt; All seems well until I try to mount it. The
&gt; &gt; virtual machine shows data for the disk
&gt; &gt; image using commands like:
&gt; &gt; 
&gt; &gt; 	pvs
&gt; &gt; 	lvs
&gt; &gt; 	lvdisplay xena-1
&gt; &gt; 
&gt; &gt; but there is no /dev/xena-1/root to be
&gt; &gt; mounted. I also cannot seem to figure out
&gt; &gt; whether the lvm related modules are available
&gt; &gt; for the virtual machine kernel.
&gt; &gt; 
&gt; &gt; Has anyone else tried playing this game?
&gt; 
&gt; Not me personally.  But... having the word "xen"
&gt; in the name of the lvm volume is kind of worrying.

No, its xena as in the name of the TV warrior woman
or whatever she was.
 
&gt; Do you have the commands you used for converting the
&gt; system disk from VirtualBox to QEMU?  If so, can
&gt; you cut-n-paste them here?  Thinking there might be
&gt; a gotcha or something in that can be pointed out
&gt; easily. :)

VBoxManage internalcommands converthd -srcformat VDI -dstformat RAW \
vbox/.VirtualBox/VDI/xena-1.vdi raw-image.img qemu-img convert -f raw raw-image.img \
-O qcow2 qemu-image.qcow

Which I set up as /dev/sdb in the xml file I loaded for the
new VM.

Here's what it looks like on the new machine:

cfdisk (util-linux-ng 2.17.2)
Disk Drive: /dev/sdb
Size: 80530636800 bytes, 80.5 GB
Heads: 255   Sectors per Track: 63   Cylinders: 9790

sdb1   Boot   Primary              Linux LVM    80270.51
sdb5          Logical              Linux ext2     254.99


lvdisplay xena-1
  --- Logical volume ---
  LV Name                /dev/xena-1/root
  VG Name                xena-1
  LV UUID                ROf54z-nb0R-60Yg-fIgg-O3OW-sCMG-0hf80q
  LV Write Access        read/write
  LV Status              NOT available
  LV Size                73.33 GiB
  Current LE             18772
  Segments               1
  Allocation             inherit
  Read ahead sectors     auto
   
  --- Logical volume ---
  LV Name                /dev/xena-1/swap_1
  VG Name                xena-1
  LV UUID                QAggp5-wIPO-vSDB-Xuk1-pu46-6hfy-nMf4JT
  LV Write Access        read/write
  LV Status              NOT available
  LV Size                1.43 GiB
  Current LE             365
  Segments               1
  Allocation             inherit
  Read ahead sectors     auto


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20101004070102</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-10-04 07:01:02-0400</timestampReceived><subject>Re: [libvirt-users] Mounting an lvm</subject><body>

On 10/04/2010 05:50 PM, Dale Amon wrote:
&lt;snip&gt;
&gt; No, its xena as in the name of the TV warrior woman
&gt; or whatever she was.

Cool. :)

&lt;snip&gt;
&gt;    LV Status              NOT available

The "NOT" bit here is interesting.

Just checked a system here, to see if that's how
it should be.  Doesn't look like it:

   $ sudo lvdisplay ArecaDataGroup/ArecaMainDataVol
     --- Logical volume ---
     LV Name                /dev/ArecaDataGroup/ArecaMainDataVol
     VG Name                ArecaDataGroup
     LV UUID                AsDlLZ-3BhF-5grN-fF6Z-ThG3-hWIt-oQ0xdI
     LV Write Access        read/write
     LV Status              available
     # open                 1
     LV Size                2.73 TiB
     Current LE             715255
     Segments               1
     Allocation             inherit
     Read ahead sectors     auto
     - currently set to     256
     Block device           253:2

What happens if you try and change that, with vgchange?  ie.:

   $ sudo vgchange -ay &lt;name of lv&gt;

?

</body></email><email><emailId>20101004071618</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-10-04 07:16:18-0400</timestampReceived><subject>Re: [libvirt-users] Mounting an lvm</subject><body>

On 10/04/2010 06:01 PM, Justin Clift wrote:
&lt;snip&gt;
&gt; What happens if you try and change that, with vgchange? ie.:
&gt;
&gt; $ sudo vgchange -ay &lt;name of lv&gt;

Heh, brain-o.

That should probably be "name of volume group", or "lvchange" instead
of "vgchange". :/

</body></email><email><emailId>20101005182902</emailId><senderName>Dale Amon</senderName><senderEmail>amon@vnl.com</senderEmail><timestampReceived>2010-10-05 18:29:02-0400</timestampReceived><subject>Re: [libvirt-users] Mounting an lvm</subject><body>

On Mon, Oct 04, 2010 at 06:16:18PM +1100, Justin Clift wrote:
&gt; On 10/04/2010 06:01 PM, Justin Clift wrote:
&gt; &lt;snip&gt;
&gt; &gt;What happens if you try and change that, with vgchange? ie.:
&gt; &gt;
&gt; &gt;$ sudo vgchange -ay &lt;name of lv&gt;
&gt; 
&gt; Heh, brain-o.
&gt; 
&gt; That should probably be "name of volume group", or "lvchange" instead
&gt; of "vgchange". :/

Thanks, this worked, the /dev entry showed up
and I was able to mount it, thus proving you
can indeed convert virtual box disks to qemu/libvirt
usable ones.

</body></email><email><emailId>20101005015920</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-10-05 01:59:20-0400</timestampReceived><subject>Re: [libvirt-users] LXC</subject><body>

On 10/05/2010 08:53 AM, Papp Tams wrote:
&lt;snip&gt;
&gt; I'm trying to connect to the console:
&gt;
&gt; $ virsh --connect=lxc:/// console test
&gt; Connected to domain test
&gt; Escape character is ^]
&gt;
&gt;
&gt; And it got off:
&gt;
&gt; $ virsh --connect=lxc:/// list --all
&gt; Id Name State
&gt; ----------------------------------
&gt; - test shut off
&gt;
&gt; /var/log/libvirt/lxc/test.log:
&gt;
&gt; 23:17:13.463: error : lxcFdForward:231 : read of fd 7 failed:
&gt; Input/output error

Ouch, that sounds like a bug, rather than being caused by you doing
something wrong.

I personally don't know anything about lxc though, so we'll need to wait
for someone with lxc experience to took at this.  Might be tomorrow? not 
sure who is into lxc. :/

In the meantime, if you want to increase the level of logging
generated by libvirt, it may reveal useful information.

To do that, change your /etc/libvirt/libvirtd.conf.

Change:

   #log_level = 3

to:

   log_level = 2

(it's more info, but not as much as level 1.  Level 1 can sometimes be
too much information)

And also change:

   # log_outputs="3:syslog:libvirtd"

to:

   log_outputs="2:file:/var/log/libvirt/libvirt.log"

In the configuration file, there is also a "log_filters" field.  It's
probably best to leave that commented out for now, so you capture
logging information from all sources.

Then restart the libvirt daemon.  It should then create the log file
/var/log/libvirt/libvirt.log.

Try creating the problem again, and see if anything useful turns
up.  (it may not)

Hopefully that helps. :)

Regards and best wishes,

Justin Clift

</body></email><email><emailId>20101004100323</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-10-04 10:03:23-0400</timestampReceived><subject>Re: [libvirt-users] virt-xml-validate b0rked?</subject><body>

2010/10/1 Stanley, Jon [Tech] &lt;Jon.Stanley@gs.com&gt;:
&gt; It seems that virt-xml-validate doesn't validate what *has* to be valid XML, that \
&gt; generated by virsh dumpxml against a running domain: 
&gt; [root@etc752365a ~]# virsh list
&gt; Id Name                 State
&gt; ----------------------------------
&gt; 2 rhel55               running
&gt; 3 rhel53               running
&gt; 
&gt; [root@etc752365a ~]# virsh dumpxml rhel55 &gt; foo.xml
&gt; [root@etc752365a ~]# virt-xml-validate foo.xml
&gt; foo.xml:8: element type: Relax-NG validity error : Invalid attribute arch for \
&gt; element type foo.xml:9: element boot: Relax-NG validity error : Element os failed \
&gt; to validate content foo.xml:8: element type: Relax-NG validity error : Error \
&gt; validating value foo.xml:8: element type: Relax-NG validity error : Element type \
&gt; failed to validate content foo.xml:1: element domain: Relax-NG validity error : \
&gt; Invalid sequence in interleave foo.xml:1: element domain: Relax-NG validity error : \
&gt; Element domain failed to validate content foo.xml fails to validate
&gt; 
&gt; Is there something that I'm doing wrong here? This is the libvirt that comes with \
&gt; RHEL5.5 

I tested with current git head and I can reproduce validations errors
for running domains. They come from the device alias element that is
only in the XML for running domains, but missing in the domain.rng.

I've fixed this device alias issue and will post the patch for it later today.

But your validation errors refer to the arch attribute of the os
element, so you're probably having a different problem.

RHEL 5.5 comes with libvirt 0.6.3, latest version is 0.8.4. Maybe the
problem has already be fixed in a newer version.

Could you attach the dumpxml output that doesn't validate for you? So
we can check in detail what the problem is. Maybe the problem is still
there but I can't reproduce it with my setup.

Matthias


</body></email><email><emailId>20101004142930</emailId><senderName>"Stanley, Jon [Tech]"</senderName><senderEmail>jon.stanley@gs.com</senderEmail><timestampReceived>2010-10-04 14:29:30-0400</timestampReceived><subject>Re: [libvirt-users] virt-xml-validate b0rked?</subject><body>

[Attachment #2 (text/plain)]



&gt; -----Original Message-----
&gt; From: Matthias Bolte [mailto:matthias.bolte@googlemail.com]
&gt; Sent: Monday, October 04, 2010 6:03 AM
&gt; To: Stanley, Jon [Tech]
&gt; Cc: libvirt-users@redhat.com
&gt; Subject: Re: [libvirt-users] virt-xml-validate b0rked?
&gt; 
&gt; But your validation errors refer to the arch attribute of the os
&gt; element, so you're probably having a different problem.
&gt; 
&gt; RHEL 5.5 comes with libvirt 0.6.3, latest version is 0.8.4. Maybe the
&gt; problem has already be fixed in a newer version.

After opening a support case, they had me replace 'rhel5.4.0' in the type element \
with 'pc' and it seemed to work well. I've attached the XML at any rate.


["foo.xml" (text/xml)]

&lt;domain type='kvm' id='2'&gt;
  &lt;name&gt;rhel55&lt;/name&gt;
  &lt;uuid&gt;db3dc00b-dac7-b050-896b-97c624791deb&lt;/uuid&gt;
  &lt;memory&gt;4194304&lt;/memory&gt;
  &lt;currentMemory&gt;4194304&lt;/currentMemory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='x86_64' machine='rhel5.4.0'&gt;hvm&lt;/type&gt;
    &lt;boot dev='hd'/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
    &lt;apic/&gt;
    &lt;pae/&gt;
  &lt;/features&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;restart&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/libexec/qemu-kvm&lt;/emulator&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;driver name='qemu' cache='none'/&gt;
      &lt;source file='/data/images/rhel55.img'/&gt;
      &lt;target dev='vda' bus='virtio'/&gt;
    &lt;/disk&gt;
    &lt;disk type='file' device='cdrom'&gt;
      &lt;target dev='hdc' bus='ide'/&gt;
      &lt;readonly/&gt;
    &lt;/disk&gt;
    &lt;interface type='bridge'&gt;
      &lt;mac address='54:52:00:03:e3:98'/&gt;
      &lt;source bridge='br0'/&gt;
      &lt;target dev='vnet0'/&gt;
      &lt;model type='virtio'/&gt;
    &lt;/interface&gt;
    &lt;serial type='pty'&gt;
      &lt;source path='/dev/pts/1'/&gt;
      &lt;target port='0'/&gt;
    &lt;/serial&gt;
    &lt;console type='pty' tty='/dev/pts/1'&gt;
      &lt;source path='/dev/pts/1'/&gt;
      &lt;target port='0'/&gt;
    &lt;/console&gt;
    &lt;input type='mouse' bus='ps2'/&gt;
    &lt;graphics type='vnc' port='5900' autoport='yes' keymap='en-us'/&gt;
  &lt;/devices&gt;
&lt;/domain&gt;



</body></email><email><emailId>20101001182048</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-10-01 18:20:48-0400</timestampReceived><subject>Re: [libvirt-users] Python XML parsing of domain descriptions?</subject><body>

On 10/01/2010 12:19 PM, Stanley, Jon [Tech] wrote:
&gt; Does anyone know of a way to parse the libvirt XML into usable python data \
&gt; structures? Ideally, it would be something like \
&gt; foo['domain']['devices']['bridge'][0]['target'] or something of the sort. What I'm \
&gt; looking to accomplish is to figure out which tap interface goes with a specific \
&gt; domain. 
&gt; I'm not keen on parsing XML to get that mapping, is there a better way to do it \
&gt; without parsing XML? 

I don't know of a solution off hand, but googling 'python xml to
dictionary' brings up a few people asking the same question, and some
possible solutions.

That said, just parsing the xml by hand isn't too bad, it only takes a
few minutes to learn how to contruct xpaths for lookup. Here's how to
get the target dev for the first interface device using libxml2 (and as
I understand it, the native python xml libraries are even simpler):


import libxml2

xmlstr = file("myxml.xml").read()
doc = libxml2.parseDoc(xmlstr)
ctx = doc.xpathNewContext()

nodelist = ctx.xpathEval("/domain/devices/interface[1]/target/@dev")
val = nodelist and nodelist[0].content or None
print val

- Cole


</body></email><email><emailId>20101001184715</emailId><senderName>Mitchell Hashimoto</senderName><senderEmail>mitchell.hashimoto@gmail.com</senderEmail><timestampReceived>2010-10-01 18:47:15-0400</timestampReceived><subject>[libvirt-users] OVF =&gt; XML?</subject><body>

Hello,

Does libvirt provide any easy way to convert an OVF to libvirt XML
specification? I noticed "virt-convert" but I'm not sure what the status of
that project is or if this is officially supported. Has anyone successfully
done this before and if so, what troubles did you run into?

Thanks,
Mitchell

[Attachment #3 (text/html)]

Hello,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Does libvirt provide any easy way to convert an O=
VF to libvirt XML specification? I noticed "virt-convert" but I&amp;#=
39;m not sure what the status of that project is or if this is officially s=
upported. Has anyone successfully done this before and if so, what troubles=
 did you run into?&lt;/div&gt;

&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;Mitchell&lt;/div&gt;


</body></email><email><emailId>20101004044708</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-10-04 04:47:08-0400</timestampReceived><subject>Re: [libvirt-users] Import/Export Support</subject><body>

On 09/29/2010 01:44 AM, Mitchell Hashimoto wrote:
&gt; Hello,
&gt;
&gt; I'm looking into using libvirt in the near future, however an important part
&gt; of our workflow is the ability to import and export virtual machines (in
&gt; VirtualBox). Does libvirt provide an easy way to do this? I couldn't find
&gt; anything obvious on the API reference.

Hi Mitchell,

We don't have an easy API-level way of doing this (yet).  My
understanding is people still manually call external utilities for
doing the on-disk image conversions, then use the converted images.

The two tools of interest to you will probably be:

   * VBoxManage
   * qemu-img

Hope that's helpful. :)

Regards and best wishes,

Justin Clift


&gt; Thanks,
&gt; Mitchell

</body></email><email><emailId>20101004123040</emailId><senderName>Bryan Kearney</senderName><senderEmail>bkearney@redhat.com</senderEmail><timestampReceived>2010-10-04 12:30:40-0400</timestampReceived><subject>Re: [libvirt-users] Anyone has new libvirt java binding jar, i want the latest one. i dont have the </subject><body>

Available from here, and also the central maven repo:

http://www.libvirt.org/maven2/

-- bk

On 10/04/2010 08:12 AM, Ravi Pawar wrote:
&gt;
&gt;
&gt; --
&gt; Thanks &amp; Regards
&gt;
&gt; Ravi Pawar
&gt;
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20101004145044</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-10-04 14:50:44-0400</timestampReceived><subject>Re: [libvirt-users] virt-xml-validate b0rked?</subject><body>

2010/10/4 Stanley, Jon [Tech] &lt;Jon.Stanley@gs.com&gt;:
&gt; 
&gt; 
&gt; &gt; -----Original Message-----
&gt; &gt; From: Matthias Bolte [mailto:matthias.bolte@googlemail.com]
&gt; &gt; Sent: Monday, October 04, 2010 6:03 AM
&gt; &gt; To: Stanley, Jon [Tech]
&gt; &gt; Cc: libvirt-users@redhat.com
&gt; &gt; Subject: Re: [libvirt-users] virt-xml-validate b0rked?
&gt; &gt; 
&gt; &gt; But your validation errors refer to the arch attribute of the os
&gt; &gt; element, so you're probably having a different problem.
&gt; &gt; 
&gt; &gt; RHEL 5.5 comes with libvirt 0.6.3, latest version is 0.8.4. Maybe the
&gt; &gt; problem has already be fixed in a newer version.
&gt; 
&gt; After opening a support case, they had me replace 'rhel5.4.0' in the type element \
&gt; with 'pc' and it seemed to work well. I've attached the XML at any rate. 
&gt; 

Yes, thats the problem. In your libvirt version "rhel5.4.0" is not
allowed as machine attribute value by the domain XML schema.

Until libvirt 0.7.6 the machine attribute was expected to have a value
out of a small predefined set ("xenfv", "pc" or "isapc" for
arch="x86_64"). Since 0.7.6 the machine attribute can contain
basically any value.

Matthias


</body></email><email><emailId>20101004145217</emailId><senderName>Matt Wallace</senderName><senderEmail>lists@truthisfreedom.org.uk</senderEmail><timestampReceived>2010-10-04 14:52:17-0400</timestampReceived><subject>Re: [libvirt-users] Updates to cucmber-vhost - guineapigs wanted! :)</subject><body>

On Monday 04 Oct 2010 04:00:30 Justin Clift wrote:
&gt; On 07/23/2010 06:13 AM, Matthew Macdonald-Wallace wrote:
&gt; &gt; Hi all,
&gt; &gt; 
&gt; &gt; For those of you that are using cucumber for Continuous Integration or
&gt; &gt; similar I've created a set of steps that enable you to use cobbler and
&gt; &gt; cucumber to auto-provision using Libvirt.
&gt; &gt; 
&gt; &gt; I've just made some changes to the code however I don't have access to
&gt; &gt; all the hardware/software required to test it fully.
&gt; &gt; 
&gt; &gt; If you are able to, please check out the code from
&gt; &gt; http://tinyurl.com/virtcuke (my github repo) and test, posting bugs
&gt; &gt; against the project.
&gt; &gt; 
&gt; &gt; Thanks in advance,
&gt; 
&gt; Just added a link to your code from the libvirt wiki:
&gt; 
&gt;    http://wiki.libvirt.org/page/Main_Page#Provisioning
&gt; 
&gt; Hope that's useful. :)
&gt; 
&gt; Regards and best wishes,
&gt; 
&gt; Justin Clift

Thanks Justin,

That's a great help - now I just need to write it properly!

For those of you who use Lettuce for your BDD, I'm hoping to create a version 
of cucumber-vhost for Lettuce as well.

Cheers,

Matt

</body></email><email><emailId>20101005063400</emailId><senderName>Robin Green</senderName><senderEmail>greenrd@greenrd.org</senderEmail><timestampReceived>2010-10-05 06:34:00-0400</timestampReceived><subject>Re: [libvirt-users] LXC</subject><body>

At Mon, 04 Oct 2010 23:53:49 +0200,
Papp Tams wrote:
&gt; &lt;os&gt;
&gt; &lt;type arch='x86_64'&gt;exe&lt;/type&gt;
&gt; &lt;init&gt;/sbin/init&lt;/init&gt;
&gt; &lt;/os&gt;

I have avoided running /sbin/init because of various problems, including:

1. udev doesn't work inside LXC
2. getty will overwrite/steal your host's virtual consoles, by default
3. init instantly dying - see http://www.redhat.com/archives/libvir-list/2010-January/msg00218.html

and probably some other problems that I can't remember. Your problem is
familiar, but I can't remember what my solution to it was.

Now it may be that Ubuntu has been patched to fix some of these problems
- I don't know.

But I would recommend you try setting your init option to /bin/bash, and
then (if you are able to get a console) start the services you want
manually.

If you are still not able to get a console, the first thing I personally
would try is different kernel versions (newer *or* older). I have
experienced a number of different issues with LXC, but I haven't had time
to write all of them up as bug reports, only some of them, so if you are
able to file reproducible bug reports that would be great.
-- 
Robin

</body></email><email><emailId>20101005141356</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-10-05 14:13:56-0400</timestampReceived><subject>Re: [libvirt-users] Puppet Module for Virtualization Management</subject><body>

On 10/06/2010 12:42 AM, Carla Araujo wrote:
&gt; Hi all!
&gt;
&gt; Puppet [0] is an Open Source data center automation and configuration
&gt; management framework. Puppet provides system administration with a
&gt; simplified platform that allows for consistent, transparent, and flexible
&gt; system management. Puppet can be extended with new modules, which are
&gt; reusable, sharable units of Puppet code.
&gt;
&gt; This year, during the Google Summer of Code [1], I developed a new Puppet's
&gt; module: Puppet-virt. Puppet-virt [2] provides a new type that allows the
&gt; administrator to deploy and manage virtual machines using r *uby-libvirt* .
&gt; At first, only Xen fullyvirtualization, Xen paravirtualization, KVM and
&gt; OpenVZ are supported.

Cool, nifty project.

Seems quite useful, so I should really get around to checking out Puppet. :)


</body></email><email><emailId>20101012171031</emailId><senderName>Ganesh Pagade</senderName><senderEmail>ganesh.pagade@gmail.com</senderEmail><timestampReceived>2010-10-12 17:10:31-0400</timestampReceived><subject>[libvirt-users] How to rename a domain?</subject><body>

Hi,

I am using libvirt Java bindings. How can I rename a domain? Is there an API
to do this?

Thanks,
-Ganesh

[Attachment #3 (text/html)]

&lt;font size="2"&gt;&lt;font face="verdana,sans-serif"&gt;Hi,&lt;br&gt;&lt;br&gt;I am using libvirt Java \
bindings. How can I rename a domain? Is there an API to do \
this?&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;-Ganesh&lt;/font&gt;&lt;/font&gt;&lt;br&gt;



</body></email><email><emailId>20101005184341</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-10-05 18:43:41-0400</timestampReceived><subject>Re: [libvirt-users] Mounting an lvm</subject><body>

On 10/06/2010 05:29 AM, Dale Amon wrote:
&gt; On Mon, Oct 04, 2010 at 06:16:18PM +1100, Justin Clift wrote:
&gt;&gt; On 10/04/2010 06:01 PM, Justin Clift wrote:
&gt;&gt; &lt;snip&gt;
&gt;&gt;&gt; What happens if you try and change that, with vgchange? ie.:
&gt;&gt;&gt;
&gt;&gt;&gt; $ sudo vgchange -ay&lt;name of lv&gt;
&gt;&gt;
&gt;&gt; Heh, brain-o.
&gt;&gt;
&gt;&gt; That should probably be "name of volume group", or "lvchange" instead
&gt;&gt; of "vgchange". :/
&gt;
&gt; Thanks, this worked, the /dev entry showed up
&gt; and I was able to mount it, thus proving you
&gt; can indeed convert virtual box disks to qemu/libvirt
&gt; usable ones.

All good. :)

</body></email><email><emailId>20101015064613</emailId><senderName>Mike Hall</senderName><senderEmail>mhall@astc.nt.gov.au</senderEmail><timestampReceived>2010-10-15 06:46:13-0400</timestampReceived><subject>[libvirt-users] NFS4 + SELinux</subject><body>

All test machines are CentOS 5.5 (RHEL subscriptions purchased).

We've had NFS3 storage working fine and decided to try NFS4.

We can mount an NFS4 share on our KVM host, but the SELinux file context on the \
mountpoint directory is magically changed from virt_image_t to nfs_t. Restorecon \
refuses to change it back.

Adding the mount option context=system_u:object_r:virt_image_t on either server or \
client doesn't help (option not recognised).

What could we be doing wrong? Does NFS4 + KVM work?

Are there any 'best practices' references around for using NFS4 for KVM storage?

Much of the documentation doesn't appear 100% relevant as we're dealing with a \
dedicated SAN network with one user (root) and 'always on' sharing, so much of the \
more complicated authentication and autofs stuff just gets in the way.

Thanks

Michael Hall
IT Communications Officer
Alice Springs Town Council
mhall@astc.nt.gov.au
(08) 8950 0561


</body></email><email><emailId>20101018021012</emailId><senderName>Serg Khaladzinski</senderName><senderEmail>gansbrest@yahoo.com</senderEmail><timestampReceived>2010-10-18 02:10:12-0400</timestampReceived><subject>[libvirt-users] libvirt fails to autostart on boot</subject><body>

Hi

I'm having a problem with libvirt. 

OS: Ubuntu 10.04 

When I installed everything initially it worked properly, I was able to use 
virtual manager to connect to QEMU and install (and run guest OS).

But after I rebooted my box - libvirt is not started even though I can see init 
script in /etc/init.d/libvirt-bin

When I start libvirtd manually it works.. But it's kind of annoying for me to do 
it manually every time..

Maybe someone may suggest any ideas of how can I debug and fix this issue with 
libvirt autostart.

Thanks a lot.



      
[Attachment #3 (text/html)]

&lt;html&gt;&lt;head&gt;&lt;style type="text/css"&gt;&lt;!-- DIV {margin:0px;} \
--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div style="font-family:times new roman,new \
york,times,serif;font-size:18pt"&gt;&lt;div&gt;Hi&lt;br&gt;&lt;br&gt;I'm having a problem with libvirt. \
&lt;br&gt;&lt;br&gt;OS: Ubuntu 10.04 &lt;br&gt;&lt;br&gt;When I installed everything initially it worked \
properly, I was able to use virtual manager to connect to QEMU and install (and run \
guest OS).&lt;br&gt;&lt;br&gt;But after I rebooted my box - libvirt is not started even though I \
can see init script in /etc/init.d/libvirt-bin&lt;br&gt;&lt;br&gt;When I start libvirtd manually \
it works.. But it's kind of annoying for me to do it manually every \
time..&lt;br&gt;&lt;br&gt;Maybe someone may suggest any ideas of how can I debug and fix this \
issue with libvirt autostart.&lt;br&gt;&lt;br&gt;Thanks a lot.&lt;br&gt;&lt;/div&gt; &lt;/div&gt;&lt;br&gt;

      &lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20101006021755</emailId><senderName>Mike Hall</senderName><senderEmail>mhall@astc.nt.gov.au</senderEmail><timestampReceived>2010-10-06 02:17:55-0400</timestampReceived><subject>[libvirt-users] KVM Live Migration</subject><body>

We have the following test environment:

2 x CentOS 5.5 KVM virtual hosts
2 x CentOS 5.5 network storage boxes with NFS shares on LVs on DRBD \
(primary/secondary, no HA, just replication).

We have installed both CentOS and Win7 guests which live migrate almost instantly \
between hosts using Virt Manager (or virsh migrate). The problem is that the guests \
does not retain their running state after migration, but instead arrive on the new \
host in "reboot after unclean shutdown" state.

The migrated machines also lose IP connectivity (static IP) upon migration to new \
host, but regain it on migration back to original host.

So, live migration in this case isn't producing the expected results (a running, \
usable guest). Same results using "migrate offline" option and pausing machines \
before migration.

Any pointers on what we're doing wrong?
Is there a need for us to implement hook scripts?

Michael Hall
IT Communications Officer
Alice Springs Town Council
mhall@astc.nt.gov.au
(08) 8950 0561


</body></email><email><emailId>20101001134723</emailId><senderName>Tomi</senderName><senderEmail>bosak.tomas@gmail.com</senderEmail><timestampReceived>2010-10-01 13:47:23-0400</timestampReceived><subject>[libvirt-users] Monitoring and statistics through libvirt</subject><body>

Hi folks,

is it possible to monitor and gather statistics in realtime (CPU,
memory, HDD, network, ... - something like dstat) of guest systems
with libvirt through console from host system (KVM based)? If yes, do
those guests need to be created through libvirt? Thanks for your help
and time.

</body></email><email><emailId>20101021073747</emailId><senderName>Mike Hall</senderName><senderEmail>mhall@astc.nt.gov.au</senderEmail><timestampReceived>2010-10-21 07:37:47-0400</timestampReceived><subject>[libvirt-users] Virt-v2v</subject><body>

Usual prologue: we're testing on CentOS 5.5, RHEL subscriptions purchased.

Now trying to use virt-v2v to transfer Win2008 Server guest from ESXi host to KVM \
host.

Have enabled SSH on ESXi host, and can connect using esx+ssh://esxhost, but procedure \
fails because nc isn't found on ESXi. Fair enough. BTW, ESXi looks like a radically \
cut down RH system (/etc/sysconfig being the give-away)?

So, using esx:// connection method which presumably uses TLS ...


Connection commands I'm trying to use:

virt-v2v -f virt-v2v.conf -ic esx://esxhost/?no_verify=1 -op vm_nfs 'HPTRIM Sandbox'
virt-v2v -f virt-v2v.conf -ic esx://esxhost/ -op vm_nfs 'HPTRIM Sandbox'

I have eliminated libvirt error messages (all #38) relating to /etc/pki/CA/cacert.pem \
and /etc/pki/libvirt/private/clientkey.pem by creating those files on KVM host \
according to info on this page:

http://libvirt.org/remote.html#Remote_libvirtd_configuration

Now I am down to a simple connection refused error message:

virt-v2v: Failed to connect to esx://esxhost/: libvirt error code: 38, message: \
unable to connect to 'esxhost': Connection refused

I have also tried suggestion on webpage above regarding these libvirtd.conf settings \
and restarted libvirtd:

tls_no_verify_certificate = 1
key_file = ""
cert_file = ""
ca_file = ""
crl_file = ""

... But no change.

The problem may well be the TLS certificates, PKI isn't one of my strong points. I \
believe the hostnames in the certificates are correct. Which certificates (if any) \
should be copied to the ESXi host (client or server)? Should I copy any certificates \
from /etc/vmware/ssl to the KVM host, if so which certificate (rui.crt or rui.key) \
and where to?

There doesn't appear to be anything resembling an iptables firewall in place on the \
ESXi host.

Anyway, any suggestions on what the problem could be greatly appreciated.

Michael Hall
IT Communications Officer
Alice Springs Town Council


</body></email><email><emailId>20101021075308</emailId><senderName>limohua</senderName><senderEmail>moli@redhat.com</senderEmail><timestampReceived>2010-10-21 07:53:08-0400</timestampReceived><subject>Re: [libvirt-users] Virt-v2v</subject><body>

virt-v2v connect to the ESX through libvirt ESX driver, here is the link,

http://www.libvirt.org/drvesx.html

why not just try the simple way to see what's going on,  you could set

virsh -c  esx://esxhost/?no_verify=1

btw, hope the below mail can help something,

2010/7/3 adrian wyssen&lt;wyssenadrian gmail com&gt;:

&gt; Hello everyone
&gt; I am really new to libvirt and I have to use it with ESXi. I was writing
&gt; code for listing the virtual machines in a ESXi server. If I connect me with
&gt; the virsh to the ESXi server, it works. But since I can not create any
&gt; certificates on the server (ESXi does not have any console...) I have to use
&gt; the no_verify option (esx://host/?no_verify=1)
&gt; I want to do the same with the API, but when I use this string in the uri
&gt; parameter of the following code
&gt; conn = virConnectOpenAuth(uri, virConnectAuthPtrDefault, 0);
&gt; the system returns "libvir: Remote error : Cannot access CA certificate
&gt; '/etc/pki/CA/cacert.pem': No such file or directory
&gt; No connection to hypervisor"
&gt; What method can I use to be able to connect to the server by ignoring the
&gt; missing certificate? Another question is: Are there any example codes for
&gt; using ESX(i), because as I said I am really new with libvirt and I did not
&gt; find any examples.
&gt; Thanks a lot for your help.
&gt; Adrian
The certificates libvirt is complaining about have nothing to do with

the certificates for ESX(i).

By default libvirt uses a TLS connection to a remote libvirtd (a

daemon). This daemon is used to allow remote management of hypervisors

that don't have remote capabilities on their own, like QEMU. For

ESX(i) this daemon is not necessary, because libvirt directly uses the

remote SOAP API provided by the ESX(i) server.

By default libvirt uses a HTTPS connection to the ESX(i) server.

Proper HTTPS requires correctly configured SSL certificates, this

certificates are different from the certificates for libvirt's TLS

connection to libvirtd. In case of a default ESX(i) installation the

ESX(i) server has auto-generated self-signed certificates. And in

general those cannot be verified by your client because your client

doesn't have the cacert.pem that corresponds to the private key that

the ESX(i) server used to sign the auto-generated self-signed

certificates.

That's the reason why libvirt allows you to disable those certificate

check by appending ?no_verify=1 to the URI.

libvirt complains here about the for the TLS connection to a remote

libvirtd. This is a bit cryptic error that appears because libvirt

don't know what to do with the URI you gave to it and as last option

it tries to connect to a libvirtd on the remote server hoping that the

libvirtd there knows what to do with the URI.

The typical reason why this happens is that your libvirt is build

without ESX support. But you said 'virsh -c esx://host/?no_verify=1'.

Therefore, I assume that's not the case here.

Could it be that you have multiple version of libvirt installed? One

that has ESX support enabled and is used by virsh and one that has ESX

support disabled and that your program links against?

Regarding example code: There is no special ESX libvirt example code,

because libvirt is designed to provide hypervisor independent API.

You can take a look at the examples directory. For example the

hellolibvirt example:

    ./examples/hellolibvirt/hellolibvirt esx://host/?no_verify=1

If that still gives you that certificate error, try:

    LIBVIRT_DEBUG=1 LIBVIRT_LOG_OUTPUTS=1:stderr

./examples/hellolibvirt/hellolibvirt esx://host/?no_verify=1

It should list lines like

13:13:23.189: debug : virRegisterDriver:927 : registering ESX as driver 5

...

13:13:23.189: debug : do_open:1242 : trying driver 5 (ESX) ...

If there is no virRegisterDriver or do_open line regarding ESX then

your libvirt is build without ESX support. But i wonder why virsh

works then.

Recent (unreleased) libvirt has better error reporting for this

situation and tells you when you try to use an URI scheme that was

disabled, instead of reporting unexpected certificate errors.

Matthias





On 10/21/2010 03:25 PM, Mike Hall wrote:
&gt; Usual prologue: we're testing on CentOS 5.5, RHEL subscriptions purchased.
&gt; 
&gt; Now trying to use virt-v2v to transfer Win2008 Server guest from ESXi host to KVM \
&gt; host. 
&gt; Have enabled SSH on ESXi host, and can connect using esx+ssh://esxhost, but \
&gt; procedure fails because nc isn't found on ESXi. Fair enough. BTW, ESXi looks like a \
&gt; radically cut down RH system (/etc/sysconfig being the give-away)? 
&gt; So, using esx:// connection method which presumably uses TLS ...
&gt; 
&gt; 
&gt; Connection commands I'm trying to use:
&gt; 
&gt; virt-v2v -f virt-v2v.conf -ic esx://esxhost/?no_verify=1 -op vm_nfs 'HPTRIM \
&gt; Sandbox' virt-v2v -f virt-v2v.conf -ic esx://esxhost/ -op vm_nfs 'HPTRIM Sandbox'
&gt; 
&gt; I have eliminated libvirt error messages (all #38) relating to \
&gt; /etc/pki/CA/cacert.pem and /etc/pki/libvirt/private/clientkey.pem by creating those \
&gt; files on KVM host according to info on this page: 
&gt; http://libvirt.org/remote.html#Remote_libvirtd_configuration
&gt; 
&gt; Now I am down to a simple connection refused error message:
&gt; 
&gt; virt-v2v: Failed to connect to esx://esxhost/: libvirt error code: 38, message: \
&gt; unable to connect to 'esxhost': Connection refused 
&gt; I have also tried suggestion on webpage above regarding these libvirtd.conf \
&gt; settings and restarted libvirtd: 
&gt; tls_no_verify_certificate = 1
&gt; key_file = ""
&gt; cert_file = ""
&gt; ca_file = ""
&gt; crl_file = ""
&gt; 
&gt; ... But no change.
&gt; 
&gt; The problem may well be the TLS certificates, PKI isn't one of my strong points. I \
&gt; believe the hostnames in the certificates are correct. Which certificates (if any) \
&gt; should be copied to the ESXi host (client or server)? Should I copy any \
&gt; certificates from /etc/vmware/ssl to the KVM host, if so which certificate (rui.crt \
&gt; or rui.key) and where to? 
&gt; There doesn't appear to be anything resembling an iptables firewall in place on the \
&gt; ESXi host. 
&gt; Anyway, any suggestions on what the problem could be greatly appreciated.
&gt; 
&gt; Michael Hall
&gt; IT Communications Officer
&gt; Alice Springs Town Council
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users


-- 
Old soldiers never die, they just fade away

Mohua Li
+86 10 6260 8263 (Direct),IRC,moli
9/F, North Tower C, Raycom Infotech Park ,NO.2 KeXueYuanNanLu, HaiDian District \
Beijing, 100190


[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta content="text/html; charset=ISO-8859-1"
      http-equiv="Content-Type"&gt;
  &lt;/head&gt;
  &lt;body bgcolor="#ffffff" text="#000000"&gt;
    &lt;pre&gt;virt-v2v connect to the ESX through libvirt ESX driver, here is the link, \
&lt;/pre&gt;  &lt;pre&gt;
&lt;a class="moz-txt-link-freetext" \
href="http://www.libvirt.org/drvesx.html"&gt;http://www.libvirt.org/drvesx.html&lt;/a&gt;&lt;/pre&gt;
  &lt;pre&gt;
why not just try the simple way to see what's going on,  you could set &lt;/pre&gt;
    &lt;pre&gt;
virsh -c esx://esxhost/?no_verify=1&lt;/pre&gt;
    &lt;pre&gt;
&lt;/pre&gt;
    &lt;pre&gt;btw, hope the below mail can help something, &lt;/pre&gt;
    &lt;pre&gt;
&lt;/pre&gt;
    &lt;pre&gt;
&lt;/pre&gt;
    &lt;pre&gt;2010/7/3 adrian wyssen&lt;wyssenadrian gmail com&gt;:
&lt;/pre&gt;
    &lt;blockquote type="cite" style="color: rgb(0, 0, 0);"&gt;
      &lt;pre&gt;Hello everyone
&lt;/pre&gt;
      &lt;pre&gt;I am really new to libvirt and I have to use it with ESXi. I was \
writing &lt;/pre&gt;
      &lt;pre&gt;code for listing the virtual machines in a ESXi server. If I connect \
me with &lt;/pre&gt;
      &lt;pre&gt;the virsh to the ESXi server, it works. But since I can not create \
any &lt;/pre&gt;
      &lt;pre&gt;certificates on the server (ESXi does not have any console...) I \
have to use &lt;/pre&gt;
      &lt;pre&gt;the no_verify option (esx://host/?no_verify=1)
&lt;/pre&gt;
      &lt;pre&gt;I want to do the same with the API, but when I use this string in \
the uri &lt;/pre&gt;
      &lt;pre&gt;parameter of the following code
&lt;/pre&gt;
      &lt;pre&gt;conn = virConnectOpenAuth(uri, virConnectAuthPtrDefault, 0);
&lt;/pre&gt;
      &lt;pre&gt;the system returns "libvir: Remote error : Cannot access CA \
certificate &lt;/pre&gt;
      &lt;pre&gt;'/etc/pki/CA/cacert.pem': No such file or directory
&lt;/pre&gt;
      &lt;pre&gt;No connection to hypervisor"
&lt;/pre&gt;
      &lt;pre&gt;What method can I use to be able to connect to the server by \
ignoring the &lt;/pre&gt;
      &lt;pre&gt;missing certificate? Another question is: Are there any example \
codes for &lt;/pre&gt;
      &lt;pre&gt;using ESX(i), because as I said I am really new with libvirt and I \
did not &lt;/pre&gt;
      &lt;pre&gt;find any examples.
&lt;/pre&gt;
      &lt;pre&gt;Thanks a lot for your help.
&lt;/pre&gt;
      &lt;pre&gt;Adrian
&lt;/pre&gt;
    &lt;/blockquote&gt;
    &lt;pre&gt;
The certificates libvirt is complaining about have nothing to do with
&lt;/pre&gt;
    &lt;pre&gt;the certificates for ESX(i).
&lt;/pre&gt;
    &lt;pre&gt;
By default libvirt uses a TLS connection to a remote libvirtd (a
&lt;/pre&gt;
    &lt;pre&gt;daemon). This daemon is used to allow remote management of hypervisors
&lt;/pre&gt;
    &lt;pre&gt;that don't have remote capabilities on their own, like QEMU. For
&lt;/pre&gt;
    &lt;pre&gt;ESX(i) this daemon is not necessary, because libvirt directly uses the
&lt;/pre&gt;
    &lt;pre&gt;remote SOAP API provided by the ESX(i) server.
&lt;/pre&gt;
    &lt;pre&gt;
By default libvirt uses a HTTPS connection to the ESX(i) server.
&lt;/pre&gt;
    &lt;pre&gt;Proper HTTPS requires correctly configured SSL certificates, this
&lt;/pre&gt;
    &lt;pre&gt;certificates are different from the certificates for libvirt's TLS
&lt;/pre&gt;
    &lt;pre&gt;connection to libvirtd. In case of a default ESX(i) installation the
&lt;/pre&gt;
    &lt;pre&gt;ESX(i) server has auto-generated self-signed certificates. And in
&lt;/pre&gt;
    &lt;pre&gt;general those cannot be verified by your client because your client
&lt;/pre&gt;
    &lt;pre&gt;doesn't have the cacert.pem that corresponds to the private key that
&lt;/pre&gt;
    &lt;pre&gt;the ESX(i) server used to sign the auto-generated self-signed
&lt;/pre&gt;
    &lt;pre&gt;certificates.
&lt;/pre&gt;
    &lt;pre&gt;
That's the reason why libvirt allows you to disable those certificate
&lt;/pre&gt;
    &lt;pre&gt;check by appending ?no_verify=1 to the URI.
&lt;/pre&gt;
    &lt;pre&gt;
libvirt complains here about the for the TLS connection to a remote
&lt;/pre&gt;
    &lt;pre&gt;libvirtd. This is a bit cryptic error that appears because libvirt
&lt;/pre&gt;
    &lt;pre&gt;don't know what to do with the URI you gave to it and as last option
&lt;/pre&gt;
    &lt;pre&gt;it tries to connect to a libvirtd on the remote server hoping that the
&lt;/pre&gt;
    &lt;pre&gt;libvirtd there knows what to do with the URI.
&lt;/pre&gt;
    &lt;pre&gt;
The typical reason why this happens is that your libvirt is build
&lt;/pre&gt;
    &lt;pre&gt;without ESX support. But you said 'virsh -c esx://host/?no_verify=1'.
&lt;/pre&gt;
    &lt;pre&gt;Therefore, I assume that's not the case here.
&lt;/pre&gt;
    &lt;pre&gt;
Could it be that you have multiple version of libvirt installed? One
&lt;/pre&gt;
    &lt;pre&gt;that has ESX support enabled and is used by virsh and one that has ESX
&lt;/pre&gt;
    &lt;pre&gt;support disabled and that your program links against?
&lt;/pre&gt;
    &lt;pre&gt;
Regarding example code: There is no special ESX libvirt example code,
&lt;/pre&gt;
    &lt;pre&gt;because libvirt is designed to provide hypervisor independent API.
&lt;/pre&gt;
    &lt;pre&gt;
You can take a look at the examples directory. For example the
&lt;/pre&gt;
    &lt;pre&gt;hellolibvirt example:
&lt;/pre&gt;
    &lt;pre&gt;
 .&lt;i class="moz-txt-slash"&gt;&lt;span \
class="moz-txt-tag"&gt;/&lt;/span&gt;examples/hellolibvirt/hellolibvirt esx://host&lt;span \
class="moz-txt-tag"&gt;/&lt;/span&gt;&lt;/i&gt;?no_verify=1 &lt;/pre&gt;
    &lt;pre&gt;
If that still gives you that certificate error, try:
&lt;/pre&gt;
    &lt;pre&gt;
 LIBVIRT_DEBUG=1 LIBVIRT_LOG_OUTPUTS=1:stderr
&lt;/pre&gt;
    &lt;pre&gt;.&lt;i class="moz-txt-slash"&gt;&lt;span \
class="moz-txt-tag"&gt;/&lt;/span&gt;examples/hellolibvirt/hellolibvirt esx://host&lt;span \
class="moz-txt-tag"&gt;/&lt;/span&gt;&lt;/i&gt;?no_verify=1 &lt;/pre&gt;
    &lt;pre&gt;
It should list lines like
&lt;/pre&gt;
    &lt;pre&gt;
13:13:23.189: debug : virRegisterDriver:927 : registering ESX as driver 5
&lt;/pre&gt;
    &lt;pre&gt;...
&lt;/pre&gt;
    &lt;pre&gt;13:13:23.189: debug : do_open:1242 : trying driver 5 (ESX) ...
&lt;/pre&gt;
    &lt;pre&gt;
If there is no virRegisterDriver or do_open line regarding ESX then
&lt;/pre&gt;
    &lt;pre&gt;your libvirt is build without ESX support. But i wonder why virsh
&lt;/pre&gt;
    &lt;pre&gt;works then.
&lt;/pre&gt;
    &lt;pre&gt;
Recent (unreleased) libvirt has better error reporting for this
&lt;/pre&gt;
    &lt;pre&gt;situation and tells you when you try to use an URI scheme that was
&lt;/pre&gt;
    &lt;pre&gt;disabled, instead of reporting unexpected certificate errors.
&lt;/pre&gt;
    &lt;pre&gt;
&lt;/pre&gt;
    &lt;pre&gt;
&lt;/pre&gt;
    &lt;pre&gt;Matthias
&lt;/pre&gt;
    &lt;pre&gt;
&lt;/pre&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;br&gt;
    On 10/21/2010 03:25 PM, Mike Hall wrote:
    &lt;blockquote
cite="mid:E597F8097C342B438782B2768D7F123DAE6BE61408@tempo.astc.nt.gov.au"
      type="cite"&gt;
      &lt;pre wrap=""&gt;Usual prologue: we're testing on CentOS 5.5, RHEL subscriptions \
purchased.

Now trying to use virt-v2v to transfer Win2008 Server guest from ESXi host to KVM \
host.

Have enabled SSH on ESXi host, and can connect using esx+ssh://esxhost, but procedure \
fails because nc isn't found on ESXi. Fair enough. BTW, ESXi looks like a radically \
cut down RH system (/etc/sysconfig being the give-away)?

So, using esx:// connection method which presumably uses TLS ...


Connection commands I'm trying to use:

virt-v2v -f virt-v2v.conf -ic esx://esxhost/?no_verify=1 -op vm_nfs 'HPTRIM Sandbox'
virt-v2v -f virt-v2v.conf -ic esx://esxhost/ -op vm_nfs 'HPTRIM Sandbox'

I have eliminated libvirt error messages (all #38) relating to /etc/pki/CA/cacert.pem \
and /etc/pki/libvirt/private/clientkey.pem by creating those files on KVM host \
according to info on this page:

&lt;a class="moz-txt-link-freetext" \
href="http://libvirt.org/remote.html#Remote_libvirtd_configuration"&gt;http://libvirt.org/remote.html#Remote_libvirtd_configuration&lt;/a&gt;


Now I am down to a simple connection refused error message:

virt-v2v: Failed to connect to esx://esxhost/: libvirt error code: 38, message: \
unable to connect to 'esxhost': Connection refused

I have also tried suggestion on webpage above regarding these libvirtd.conf settings \
and restarted libvirtd:

tls_no_verify_certificate = 1
key_file = ""
cert_file = ""
ca_file = ""
crl_file = ""

... But no change.

The problem may well be the TLS certificates, PKI isn't one of my strong points. I \
believe the hostnames in the certificates are correct. Which certificates (if any) \
should be copied to the ESXi host (client or server)? Should I copy any certificates \
from /etc/vmware/ssl to the KVM host, if so which certificate (rui.crt or rui.key) \
and where to?

There doesn't appear to be anything resembling an iptables firewall in place on the \
ESXi host.

Anyway, any suggestions on what the problem could be greatly appreciated.

Michael Hall
IT Communications Officer
Alice Springs Town Council

_______________________________________________
libvirt-users mailing list
&lt;a class="moz-txt-link-abbreviated" \
href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt; &lt;a \
class="moz-txt-link-freetext" \
href="https://www.redhat.com/mailman/listinfo/libvirt-users"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;
 &lt;/pre&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;pre class="moz-signature" cols="72"&gt;-- 
Old soldiers never die, they just fade away

Mohua Li
+86 10 6260 8263 (Direct),IRC,moli
9/F, North Tower C, Raycom Infotech Park ,NO.2 KeXueYuanNanLu, HaiDian District \
Beijing, 100190&lt;/pre&gt;  &lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20101012140548</emailId><senderName>Ravi Pawar</senderName><senderEmail>ravifc@gmail.com</senderEmail><timestampReceived>2010-10-12 14:05:48-0400</timestampReceived><subject>[libvirt-users] Fwd: undefining and redefining a Domain from libvirt java bindings</subject><body>

[Attachment #2 (multipart/alternative)]


hi,

i am trying to undefine a domain  by using dm.undefine();
and then trying to create one with same name is giving me error saying
'Domain not found: no domain with matching uuid
'aeae9d4e-17cb-b661-a612-88ac677c28c1'

i have attached my test program which reproduces the issue.

please let me know where i am going wrong?

configuration: libvirt : 0.6.3
                    Java Bindings: 0.4.2

-- 
Thanks &amp; Regards

Ravi Pawar

[Attachment #5 (text/html)]

hi,&lt;br&gt;&lt;br&gt;i am trying to undefine a domain  by using dm.undefine();&lt;br&gt;and then \
trying to create one with same name is giving me error saying&lt;br&gt;'Domain not \
found: no domain with matching uuid \
'aeae9d4e-17cb-b661-a612-88ac677c28c1'&lt;br&gt; &lt;br&gt;i have attached my test \
program which reproduces the issue.&lt;br&gt;&lt;br&gt;please let me know where i am going \
wrong?&lt;br&gt;&lt;br&gt;configuration: libvirt : 0.6.3&lt;br&gt;                    Java Bindings: \
0.4.2&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt; Thanks &amp; Regards&lt;br&gt;&lt;br&gt;Ravi Pawar&lt;br&gt;

--20cf303348e3681cc704926bce91--


["Test.java" (application/octet-stream)]

</body></email><email><emailId>20101026140523</emailId><senderName>Andrea Turli</senderName><senderEmail>andrea.turli@eng.it</senderEmail><timestampReceived>2010-10-26 14:05:23-0400</timestampReceived><subject>[libvirt-users] List volumes of a domain</subject><body>

Hi all,

I'm using libvirt java binding (libvirt-java-0.4.6)
I'd like to know if the Domain class offers an API to query volumes 
attached to a particular domain or should I parse the XML domain 
description?

Thanks for your support

-- 
Andrea Turli
Ricercatore
Direzione Ricerca e Innovazione
andrea.turli@eng.it

Engineering Ingegneria Informatica spa
Via Riccardo Morandi, 32 00148 Roma (RM)
Tel. +39 06 8307 4710
Fax +39 06 8307 4200
www.eng.it



[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
&lt;head&gt;

&lt;meta http-equiv="content-type" content="text/html; charset=ISO-8859-1"&gt;
&lt;/head&gt;
&lt;body text="#000000" bgcolor="#ffffff"&gt;
&lt;font size="-1"&gt;&lt;font face="Courier New, Courier, monospace"&gt;Hi all,&lt;br&gt;
&lt;br&gt;
I'm using libvirt java binding (libvirt-java-0.4.6)&lt;br&gt;
I'd like to know if the Domain class offers an API to query volumes
attached to a particular domain or should I parse the XML domain
description?&lt;br&gt;
&lt;br&gt;
Thanks for your support &lt;br&gt;
&lt;/font&gt;&lt;/font&gt;
&lt;pre class="moz-signature" cols="72"&gt;-- 
Andrea Turli     
Ricercatore
Direzione Ricerca e Innovazione
&lt;a class="moz-txt-link-abbreviated" href="mailto:andrea.turli@eng.it"&gt;andrea.turli@eng.it&lt;/a&gt;

Engineering Ingegneria Informatica spa
Via Riccardo Morandi, 32 00148 Roma (RM)
Tel. +39 06 8307 4710
Fax +39 06 8307 4200 
&lt;a class="moz-txt-link-abbreviated" href="http://www.eng.it"&gt;www.eng.it&lt;/a&gt;

&lt;/pre&gt;
&lt;/body&gt;
&lt;/html&gt;


</body></email><email><emailId>20101027135139</emailId><senderName></senderName><senderEmail>paul.worner@thomsonreuters.com</senderEmail><timestampReceived>2010-10-27 13:51:39-0400</timestampReceived><subject>[libvirt-users] Compiling libvirt-0.8.4 for NFSv4</subject><body>

Hi all,

 

Not sure if this will be useful to anyone.  Worse, it's probably not
complete or correct, but I thought I would throw this out there for
comment.

 

I asked earlier about configuring libvirt for NFSv4 support.  I wanted
to define NFSv4 pool from xml config, but it's not an option.  I decided
to hack a bit.  Added the following to source code:

 

 

storage_conf.h(417):

 

enum virStoragePoolFormatFileSystemNet {

    VIR_STORAGE_POOL_NETFS_AUTO = 0,

    VIR_STORAGE_POOL_NETFS_NFS,

    VIR_STORAGE_POOL_NETFS_NFS4,

    VIR_STORAGE_POOL_NETFS_GLUSTERFS,

    VIR_STORAGE_POOL_NETFS_CIFS,

    VIR_STORAGE_POOL_NETFS_LAST,

};

 

 

storage_conf.c(64):

 

VIR_ENUM_IMPL(virStoragePoolFormatFileSystemNet,

              VIR_STORAGE_POOL_NETFS_LAST,

              "auto", "nfs", "nfs4", "glusterfs", "cifs")

 

 

Compiled libvirt and then created storage pool xml:

 

&lt;pool type="netfs"&gt;

  &lt;name&gt;pool2&lt;/name&gt;

  &lt;source&gt;

    &lt;host name="test_filer"/&gt;

    &lt;dir path="/libvirt"/&gt;

    &lt;format type="nfs4"/&gt;

  &lt;/source&gt;

  &lt;target&gt;

    &lt;path&gt;"/usr/local/var/lib/libvirt/images/nfsds2"&lt;/path&gt;

  &lt;/target&gt;

&lt;/pool&gt;

 

 

'Virsh pool-create [above xml]' works, using 'mount -t nfs4'.

 

Again, this seemed too easy, so I won't be surprised if things break.
However, I was just trying to demonstrate functionality in lab, so
failures are fine short term.

 

Please comment on flaws or improvements to this approach.

 

 

Thanks,

Paul Worner


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;meta http-equiv=Content-Type content="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 12 (filtered medium)"&gt;
&lt;style&gt;
&lt;!--
 /* Font Definitions */
 @font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Tahoma","sans-serif";
	color:windowtext;
	font-weight:normal;
	font-style:normal;
	text-decoration:none none;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
--&gt;
&lt;/style&gt;
&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapelayout v:ext="edit"&gt;
  &lt;o:idmap v:ext="edit" data="1" /&gt;
 &lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
&lt;/head&gt;

&lt;body lang=EN-US link=blue vlink=purple&gt;

&lt;div class=WordSection1&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;Hi \
all,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;Not sure if this will be \
useful to anyone. Worse, its probably not complete or correct, but I \
thought I would throw this out there for comment.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;I
asked earlier about configuring libvirt for NFSv4 support. I wanted to
define NFSv4 pool from xml config, but its not an option. I
decided to hack a bit. Added the following to source \
code:&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;storage_conf.h(417):&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;enum \
virStoragePoolFormatFileSystemNet {&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt; \
VIR_STORAGE_POOL_NETFS_AUTO = 0,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt; \
VIR_STORAGE_POOL_NETFS_NFS,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-size:10.0pt;font-family:"Tahoma","sans-serif";
color:red'&gt; VIR_STORAGE_POOL_NETFS_NFS4,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt; \
VIR_STORAGE_POOL_NETFS_GLUSTERFS,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt; \
VIR_STORAGE_POOL_NETFS_CIFS,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt; \
VIR_STORAGE_POOL_NETFS_LAST,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;};&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;storage_conf.c(64):&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;VIR_ENUM_IMPL(virStoragePoolFormatFileSystemNet,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;
 VIR_STORAGE_POOL_NETFS_LAST,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;
 "auto", "nfs", &lt;span style='color:red'&gt;"nfs4",&lt;/span&gt;
"glusterfs", "cifs")&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;Compiled libvirt and then \
created storage pool xml:&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;&lt;pool \
type="netfs"&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt; \
&lt;name&gt;pool2&lt;/name&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt; \
&lt;source&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt; \
&lt;host name="test_filer"/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt; &lt;dir \
path="/libvirt"/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span style='font-size:10.0pt;font-family:"Tahoma","sans-serif";
color:red'&gt; &lt;format \
type="nfs4"/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt; \
&lt;/source&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt; \
&lt;target&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt; \
&lt;path&gt;/usr/local/var/lib/libvirt/images/nfsds2&lt;/path&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt; \
&lt;/target&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;&lt;/pool&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;Virsh pool-create \
[above xml] works, using mount t \
nfs4.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;Again, this seemed too \
easy, so I wont be surprised if things break. However, I was just trying \
to demonstrate functionality in lab, so failures are fine short \
term.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;Please comment on flaws or \
improvements to this approach.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;Thanks,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;Paul \
Worner&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;



</body></email><email><emailId>20101029132758</emailId><senderName>Tom Stave</senderName><senderEmail>tstave@pmtghome.com</senderEmail><timestampReceived>2010-10-29 13:27:58-0400</timestampReceived><subject>[libvirt-users] SCSI tape drive device</subject><body>

I have a SCSI tape backup unit attached to a kvm host managed by 
libvirt.  Is there a way to expose the SCSI device in libvirt so I could 
pass the device to a virtual machine and have the virtual machine 
control the tape backup?

Defining the device as a SCSI disk does not appear to work.

In this situation, live migration is not an issue.  The VM would always 
be tied to this host.

</body></email><email><emailId>20101012143133</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-10-12 14:31:33-0400</timestampReceived><subject>Re: [libvirt-users] Fwd: undefining and redefining a Domain from libvirt java bindings</subject><body>

2010/10/12 Ravi Pawar &lt;ravifc@gmail.com&gt;:
&gt; hi,
&gt;
&gt; i am trying to undefine a domain  by using dm.undefine();
&gt; and then trying to create one with same name is giving me error saying
&gt; 'Domain not found: no domain with matching uuid
&gt; 'aeae9d4e-17cb-b661-a612-88ac677c28c1'
&gt;
&gt; i have attached my test program which reproduces the issue.
&gt;
&gt; please let me know where i am going wrong?
&gt;
&gt; configuration: libvirt : 0.6.3
&gt;                     Java Bindings: 0.4.2

I didn't look into this problem in detail, but I think you need to
call free on the Domain object after you undefined it.

dm.undefine();
dm.free();
dm = null;

Matthias

</body></email><email><emailId>20101013041610</emailId><senderName>Osier</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2010-10-13 04:16:10-0400</timestampReceived><subject>Re: [libvirt-users] Fwd: undefining and redefining a Domain from libvirt java bindings</subject><body>


----- "Ravi Pawar" &lt;ravifc@gmail.com&gt; wrote:

&gt; hi,
&gt; 
&gt; i am trying to undefine a domain by using dm.undefine();
&gt; and then trying to create one with same name is giving me error saying
&gt; 'Domain not found: no domain with matching uuid
&gt; 'aeae9d4e-17cb-b661-a612-88ac677c28c1'

  The error is not throwed by "dm.undefine". 

  looked at and tried your test program, it throws error message like: 
  libvir: QEMU error : Domain not found: no domain with matching name 'tt2'

  Definitely, it's throwed by:
  dm =conn.domainLookupByName("tt2");

  I guess you looked up the domain by "UUID" before.. so it came the 
error message saying "no domain with matching uuid .....".

  The error doesn't influnce the program running forward. e.g.

                        Domain dm1 = conn.domainDefineXML(dumpxml);

                        dm1.create();

                        int id; 
                        id = dm1.getID();
                        System.out.println(id);

                        dm1.undefine();

  You will get the domain ID..

  I'm not familiar with Java, guess you can catch the error and turn
it into a warning message with "Expection Handler". correct me if I'm 
not right.. :-)

- Osier

&gt; 
&gt; i have attached my test program which reproduces the issue.
&gt; 
&gt; please let me know where i am going wrong?
&gt; 
&gt; configuration: libvirt : 0.6.3
&gt; Java Bindings: 0.4.2
&gt; 
&gt; --
&gt; Thanks &amp; Regards
&gt; 
&gt; Ravi Pawar
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20101013110441</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-10-13 11:04:41-0400</timestampReceived><subject>Re: [libvirt-users] Fwd: undefining and redefining a Domain from libvirt java bindings</subject><body>

2010/10/12 Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;:
&gt; 2010/10/12 Ravi Pawar &lt;ravifc@gmail.com&gt;:
&gt;&gt; hi,
&gt;&gt;
&gt;&gt; i am trying to undefine a domain  by using dm.undefine();
&gt;&gt; and then trying to create one with same name is giving me error saying
&gt;&gt; 'Domain not found: no domain with matching uuid
&gt;&gt; 'aeae9d4e-17cb-b661-a612-88ac677c28c1'
&gt;&gt;
&gt;&gt; i have attached my test program which reproduces the issue.
&gt;&gt;
&gt;&gt; please let me know where i am going wrong?
&gt;&gt;
&gt;&gt; configuration: libvirt : 0.6.3
&gt;&gt;                     Java Bindings: 0.4.2
&gt;
&gt; I didn't look into this problem in detail, but I think you need to
&gt; call free on the Domain object after you undefined it.
&gt;
&gt; dm.undefine();
&gt; dm.free();
&gt; dm = null;
&gt;
&gt; Matthias
&gt;

Okay, calling free doesn't help. I tested it with libvirt 0.6.3 and
libvirt-java 0.4.6 and can reproduce your problem.

This problem is fixed in libvirt 0.8.2. I didn't track it down to the
actual commit.

So in order to fix your problem you'll have to update libvirt to 0.8.2
or identify the commit between 0.8.1 and 0.8.2 that fixes your problem
and backport it to 0.6.3.

Matthias

</body></email><email><emailId>20101015140547</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-10-15 14:05:47-0400</timestampReceived><subject>Re: [libvirt-users] Fwd: undefining and redefining a Domain from libvirt java bindings</subject><body>

2010/10/13 Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;:
&gt; 2010/10/12 Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;:
&gt;&gt; 2010/10/12 Ravi Pawar &lt;ravifc@gmail.com&gt;:
&gt;&gt;&gt; hi,
&gt;&gt;&gt;
&gt;&gt;&gt; i am trying to undefine a domain   by using dm.undefine();
&gt;&gt;&gt; and then trying to create one with same name is giving me error saying
&gt;&gt;&gt; 'Domain not found: no domain with matching uuid
&gt;&gt;&gt; 'aeae9d4e-17cb-b661-a612-88ac677c28c1'
&gt;&gt;&gt;
&gt;&gt;&gt; i have attached my test program which reproduces the issue.
&gt;&gt;&gt;
&gt;&gt;&gt; please let me know where i am going wrong?
&gt;&gt;&gt;
&gt;&gt;&gt; configuration: libvirt : 0.6.3
&gt;&gt;&gt;                                        Java Bindings: 0.4.2
&gt;&gt;
&gt;&gt; I didn't look into this problem in detail, but I think you need to
&gt;&gt; call free on the Domain object after you undefined it.
&gt;&gt;
&gt;&gt; dm.undefine();
&gt;&gt; dm.free();
&gt;&gt; dm = null;
&gt;&gt;
&gt;&gt; Matthias
&gt;&gt;
&gt;
&gt; Okay, calling free doesn't help. I tested it with libvirt 0.6.3 and
&gt; libvirt-java 0.4.6 and can reproduce your problem.
&gt;
&gt; This problem is fixed in libvirt 0.8.2. I didn't track it down to the
&gt; actual commit.
&gt;
&gt; So in order to fix your problem you'll have to update libvirt to 0.8.2
&gt; or identify the commit between 0.8.1 and 0.8.2 that fixes your problem
&gt; and backport it to 0.6.3.
&gt;
&gt; Matthias
&gt;

I found the commit (30ec755ecb3350116d2851afa0de02e77dbe2c51) that
avoids the problem in your original test code. I say 'avoid' instead
of 'fix' because the actual fix is to call free on the domain objects
after undefining them as I initially suggested. But when I tested this
I did it wrong and jumped to false conclusions.

Just to say it once again: Adding free calls solve this problem for me
with libvirt 0.6.3.

I attached a modified version of your test code that works for me.

Matthias

["TestRedef.java" (text/x-java)]

import org.libvirt.Connect;
import org.libvirt.Domain;
import org.libvirt.LibvirtException;

public class TestRedef {

	/**
	 * @param args
	 */
	public static void main(String[] args) {
		Connect conn = null;
		int flags = 0;

		try {
			conn = new Connect("qemu:///system", false);

			String dumpxml = "&lt;domain type='kvm'&gt;"+
			  "&lt;name&gt;tt2&lt;/name&gt;"+
			  "&lt;memory&gt;524288&lt;/memory&gt;"+
			  "&lt;currentMemory&gt;524288&lt;/currentMemory&gt;"+
			  "&lt;vcpu&gt;1&lt;/vcpu&gt;"+
			  "&lt;os&gt;"+
			  "  &lt;type arch='x86_64'&gt;hvm&lt;/type&gt;"+
			  "  &lt;boot dev='hd'/&gt;"+
			  "&lt;/os&gt;"+
			  "&lt;features&gt;"+
			  "  &lt;acpi/&gt;"+
			  "  &lt;apic/&gt;"+
			   " &lt;pae/&gt;"+
			  "&lt;/features&gt;"+
			  "&lt;clock offset='utc'/&gt;"+
			  "&lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;"+
			  "&lt;on_reboot&gt;restart&lt;/on_reboot&gt;"+
			  "&lt;on_crash&gt;restart&lt;/on_crash&gt;"+
			  "&lt;devices&gt;"+
			  "  &lt;disk type='file' device='disk'&gt;"+
			  "    &lt;driver name='qemu' cache='none'/&gt;"+
			  "    &lt;source file='/var/lib/libvirt/images/tt.img'/&gt;"+
			  "    &lt;target dev='hda' bus='ide'/&gt;"+
			  "  &lt;/disk&gt;"+
			  "  &lt;interface type='network'&gt;"+
			  "    &lt;mac address='54:52:00:02:02:2c'/&gt;"+
			  "    &lt;source network='default'/&gt;"+
			  "  &lt;/interface&gt;"+
			  "  &lt;serial type='pty'&gt;"+
			  "    &lt;target port='0'/&gt;"+
			  "  &lt;/serial&gt;"+
			  "  &lt;console type='pty'&gt;"+
			  "    &lt;target port='0'/&gt;"+
			  "  &lt;/console&gt;"+
			  "  &lt;input type='mouse' bus='ps2'/&gt;"+
			  "  &lt;graphics type='vnc' port='-1' autoport='yes' keymap='en-us'/&gt;"+
			  "&lt;/devices&gt;"+
			"&lt;/domain&gt;";

			Domain dm = null;

			System.out.println("lookup of tt2...");
			try {
				dm = conn.domainLookupByName("tt2");
			} catch (LibvirtException e) {
				// TODO: handle exception
			}
			System.out.println("lookup of tt2... done");

			if (dm != null) {
				System.out.println("undefine tt2...");
				dm.undefine();
				dm.free();
				System.out.println("undefine tt2... done");
			}

			System.out.println("first define/undefine tt2...");
			Domain dm1 = conn.domainDefineXML(dumpxml);
			System.out.println("first define/undefine tt2... defined");
			dm1.undefine();
			dm1.free();
			System.out.println("first define/undefine tt2... undefined");

			System.out.println("second define/undefine tt2...");
			Domain dm2 = conn.domainDefineXML(dumpxml);
			System.out.println("second define/undefine tt2... defined");
			dm2.undefine();
			dm2.free();
			System.out.println("second define/undefine tt2... undefined");
		} catch (LibvirtException e) {
			System.out.println("exception caught:" + e);
			System.out.println(e.getError());
			return;
		}
	}
}


</body></email><email><emailId>20101018125017</emailId><senderName>Bryan Kearney</senderName><senderEmail>bkearney@redhat.com</senderEmail><timestampReceived>2010-10-18 12:50:17-0400</timestampReceived><subject>Re: [libvirt-users] Fwd: undefining and redefining a Domain from libvirt java bindings</subject><body>

On 10/15/2010 10:05 AM, Matthias Bolte wrote:
&gt; 2010/10/13 Matthias Bolte&lt;matthias.bolte@googlemail.com&gt;:
&gt;&gt; 2010/10/12 Matthias Bolte&lt;matthias.bolte@googlemail.com&gt;:
&gt;&gt;&gt; 2010/10/12 Ravi Pawar&lt;ravifc@gmail.com&gt;:
&gt;&gt;&gt;&gt; hi,
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; i am trying to undefine a domain  by using dm.undefine();
&gt;&gt;&gt;&gt; and then trying to create one with same name is giving me error saying
&gt;&gt;&gt;&gt; 'Domain not found: no domain with matching uuid
&gt;&gt;&gt;&gt; 'aeae9d4e-17cb-b661-a612-88ac677c28c1'
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; i have attached my test program which reproduces the issue.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; please let me know where i am going wrong?
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; configuration: libvirt : 0.6.3
&gt;&gt;&gt;&gt;                      Java Bindings: 0.4.2
&gt;&gt;&gt;
&gt;&gt;&gt; I didn't look into this problem in detail, but I think you need to
&gt;&gt;&gt; call free on the Domain object after you undefined it.
&gt;&gt;&gt;
&gt;&gt;&gt; dm.undefine();
&gt;&gt;&gt; dm.free();
&gt;&gt;&gt; dm = null;
&gt;&gt;&gt;
&gt;&gt;&gt; Matthias
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt; Okay, calling free doesn't help. I tested it with libvirt 0.6.3 and
&gt;&gt; libvirt-java 0.4.6 and can reproduce your problem.
&gt;&gt;
&gt;&gt; This problem is fixed in libvirt 0.8.2. I didn't track it down to the
&gt;&gt; actual commit.
&gt;&gt;
&gt;&gt; So in order to fix your problem you'll have to update libvirt to 0.8.2
&gt;&gt; or identify the commit between 0.8.1 and 0.8.2 that fixes your problem
&gt;&gt; and backport it to 0.6.3.
&gt;&gt;
&gt;&gt; Matthias
&gt;&gt;
&gt;
&gt; I found the commit (30ec755ecb3350116d2851afa0de02e77dbe2c51) that
&gt; avoids the problem in your original test code. I say 'avoid' instead
&gt; of 'fix' because the actual fix is to call free on the domain objects
&gt; after undefining them as I initially suggested. But when I tested this
&gt; I did it wrong and jumped to false conclusions.
&gt;
&gt; Just to say it once again: Adding free calls solve this problem for me
&gt; with libvirt 0.6.3.
&gt;
&gt; I attached a modified version of your test code that works for me.
&gt;

Which the latest code has.

-- bk


</body></email><email><emailId>20101021062924</emailId><senderName>Ravi Pawar</senderName><senderEmail>ravifc@gmail.com</senderEmail><timestampReceived>2010-10-21 06:29:24-0400</timestampReceived><subject>Re: [libvirt-users] Fwd: undefining and redefining a Domain from libvirt java bindings</subject><body>

[Attachment #2 (multipart/alternative)]


Thanks Matthias,

can you please have a look at the program attached? this should work as i
have used free() call. but its not working for me.

Thanks,
Ravi

On Mon, Oct 18, 2010 at 6:20 PM, Bryan Kearney &lt;bkearney@redhat.com&gt; wrote:

&gt; On 10/15/2010 10:05 AM, Matthias Bolte wrote:
&gt;
&gt;&gt; 2010/10/13 Matthias Bolte&lt;matthias.bolte@googlemail.com&gt;:
&gt;&gt;
&gt;&gt;&gt; 2010/10/12 Matthias Bolte&lt;matthias.bolte@googlemail.com&gt;:
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; 2010/10/12 Ravi Pawar&lt;ravifc@gmail.com&gt;:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; hi,
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; i am trying to undefine a domain  by using dm.undefine();
&gt;&gt;&gt;&gt;&gt; and then trying to create one with same name is giving me error saying
&gt;&gt;&gt;&gt;&gt; 'Domain not found: no domain with matching uuid
&gt;&gt;&gt;&gt;&gt; 'aeae9d4e-17cb-b661-a612-88ac677c28c1'
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; i have attached my test program which reproduces the issue.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; please let me know where i am going wrong?
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; configuration: libvirt : 0.6.3
&gt;&gt;&gt;&gt;&gt;                     Java Bindings: 0.4.2
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; I didn't look into this problem in detail, but I think you need to
&gt;&gt;&gt;&gt; call free on the Domain object after you undefined it.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; dm.undefine();
&gt;&gt;&gt;&gt; dm.free();
&gt;&gt;&gt;&gt; dm = null;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Matthias
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt; Okay, calling free doesn't help. I tested it with libvirt 0.6.3 and
&gt;&gt;&gt; libvirt-java 0.4.6 and can reproduce your problem.
&gt;&gt;&gt;
&gt;&gt;&gt; This problem is fixed in libvirt 0.8.2. I didn't track it down to the
&gt;&gt;&gt; actual commit.
&gt;&gt;&gt;
&gt;&gt;&gt; So in order to fix your problem you'll have to update libvirt to 0.8.2
&gt;&gt;&gt; or identify the commit between 0.8.1 and 0.8.2 that fixes your problem
&gt;&gt;&gt; and backport it to 0.6.3.
&gt;&gt;&gt;
&gt;&gt;&gt; Matthias
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt; I found the commit (30ec755ecb3350116d2851afa0de02e77dbe2c51) that
&gt;&gt; avoids the problem in your original test code. I say 'avoid' instead
&gt;&gt; of 'fix' because the actual fix is to call free on the domain objects
&gt;&gt; after undefining them as I initially suggested. But when I tested this
&gt;&gt; I did it wrong and jumped to false conclusions.
&gt;&gt;
&gt;&gt; Just to say it once again: Adding free calls solve this problem for me
&gt;&gt; with libvirt 0.6.3.
&gt;&gt;
&gt;&gt; I attached a modified version of your test code that works for me.
&gt;&gt;
&gt;&gt;
&gt; Which the latest code has.
&gt;
&gt; -- bk
&gt;
&gt;
&gt;


-- 
Thanks &amp; Regards

Ravi Pawar

[Attachment #5 (text/html)]

Thanks Matthias,&lt;br&gt;&lt;br&gt;can you please have a look at the program attached? this \
should work as i have used free() call. but its not working for \
me.&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;Ravi&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Mon, Oct 18, 2010 at \
6:20 PM, Bryan Kearney &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:bkearney@redhat.com"&gt;bkearney@redhat.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt; \
&lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px \
solid rgb(204, 204, 204); padding-left: 1ex;"&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;On \
10/15/2010 10:05 AM, Matthias Bolte wrote:&lt;br&gt; &lt;blockquote class="gmail_quote" \
style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, 204, 204); \
padding-left: 1ex;"&gt; 2010/10/13 Matthias Bolte&lt;&lt;a \
href="mailto:matthias.bolte@googlemail.com" \
target="_blank"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;:&lt;br&gt; &lt;blockquote \
class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, \
204, 204); padding-left: 1ex;"&gt; 2010/10/12 Matthias Bolte&lt;&lt;a \
href="mailto:matthias.bolte@googlemail.com" \
target="_blank"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;:&lt;br&gt; &lt;blockquote \
class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, \
204, 204); padding-left: 1ex;"&gt; 2010/10/12 Ravi Pawar&lt;&lt;a \
href="mailto:ravifc@gmail.com" target="_blank"&gt;ravifc@gmail.com&lt;/a&gt;&gt;:&lt;br&gt; \
&lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px \
solid rgb(204, 204, 204); padding-left: 1ex;"&gt; hi,&lt;br&gt;
&lt;br&gt;
i am trying to undefine a domain  by using dm.undefine();&lt;br&gt;
and then trying to create one with same name is giving me error saying&lt;br&gt;
'Domain not found: no domain with matching uuid&lt;br&gt;
'aeae9d4e-17cb-b661-a612-88ac677c28c1'&lt;br&gt;
&lt;br&gt;
i have attached my test program which reproduces the issue.&lt;br&gt;
&lt;br&gt;
please let me know where i am going wrong?&lt;br&gt;
&lt;br&gt;
configuration: libvirt : 0.6.3&lt;br&gt;
                     Java Bindings: 0.4.2&lt;br&gt;
&lt;/blockquote&gt;
&lt;br&gt;
I didn't look into this problem in detail, but I think you need to&lt;br&gt;
call free on the Domain object after you undefined it.&lt;br&gt;
&lt;br&gt;
dm.undefine();&lt;br&gt;
dm.free();&lt;br&gt;
dm = null;&lt;br&gt;
&lt;br&gt;
Matthias&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;
&lt;br&gt;
Okay, calling free doesn't help. I tested it with libvirt 0.6.3 and&lt;br&gt;
libvirt-java 0.4.6 and can reproduce your problem.&lt;br&gt;
&lt;br&gt;
This problem is fixed in libvirt 0.8.2. I didn't track it down to the&lt;br&gt;
actual commit.&lt;br&gt;
&lt;br&gt;
So in order to fix your problem you'll have to update libvirt to 0.8.2&lt;br&gt;
or identify the commit between 0.8.1 and 0.8.2 that fixes your problem&lt;br&gt;
and backport it to 0.6.3.&lt;br&gt;
&lt;br&gt;
Matthias&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;
&lt;br&gt;
I found the commit (30ec755ecb3350116d2851afa0de02e77dbe2c51) that&lt;br&gt;
avoids the problem in your original test code. I say 'avoid' instead&lt;br&gt;
of 'fix' because the actual fix is to call free on the domain objects&lt;br&gt;
after undefining them as I initially suggested. But when I tested this&lt;br&gt;
I did it wrong and jumped to false conclusions.&lt;br&gt;
&lt;br&gt;
Just to say it once again: Adding free calls solve this problem for me&lt;br&gt;
with libvirt 0.6.3.&lt;br&gt;
&lt;br&gt;
I attached a modified version of your test code that works for me.&lt;br&gt;
&lt;br&gt;
&lt;/blockquote&gt;
&lt;br&gt;&lt;/div&gt;&lt;/div&gt;
Which the latest code has.&lt;br&gt;&lt;font color="#888888"&gt;
&lt;br&gt;
-- bk&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;Thanks &amp; \
Regards&lt;br&gt;&lt;br&gt;Ravi Pawar&lt;br&gt;

--0016364ec9cabb177d04931a7a27--


["Test2.java" (application/octet-stream)]

</body></email><email><emailId>20101021153450</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-10-21 15:34:50-0400</timestampReceived><subject>Re: [libvirt-users] Fwd: undefining and redefining a Domain from libvirt java bindings</subject><body>

You need to free() all domain objects that represent the undefine
domain before defining a domain with the same name again:

System.out.println("first define tt2...");
Domain dm1 = conn.domainDefineXML(dumpxml);
Domain dm2 = conn.domainLookupByName("tt2");
System.out.println("Now undefine....");
if (dm2 != null) {
	System.out.println("undefine tt2...");
	dm2.undefine();
	dm2.free();
	dm1.free(); // &lt;---------- need to free dm1 here too
	System.out.println("undefine tt2... done");
}

Matthias

2010/10/21 Ravi Pawar &lt;ravifc@gmail.com&gt;:
&gt; Thanks Matthias,
&gt;
&gt; can you please have a look at the program attached? this should work as i
&gt; have used free() call. but its not working for me.
&gt;
&gt; Thanks,
&gt; Ravi
&gt;
&gt; On Mon, Oct 18, 2010 at 6:20 PM, Bryan Kearney &lt;bkearney@redhat.com&gt; wrote:
&gt;&gt;
&gt;&gt; On 10/15/2010 10:05 AM, Matthias Bolte wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; 2010/10/13 Matthias Bolte&lt;matthias.bolte@googlemail.com&gt;:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; 2010/10/12 Matthias Bolte&lt;matthias.bolte@googlemail.com&gt;:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; 2010/10/12 Ravi Pawar&lt;ravifc@gmail.com&gt;:
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; hi,
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; i am trying to undefine a domain  by using dm.undefine();
&gt;&gt;&gt;&gt;&gt;&gt; and then trying to create one with same name is giving me error saying
&gt;&gt;&gt;&gt;&gt;&gt; 'Domain not found: no domain with matching uuid
&gt;&gt;&gt;&gt;&gt;&gt; 'aeae9d4e-17cb-b661-a612-88ac677c28c1'
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; i have attached my test program which reproduces the issue.
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; please let me know where i am going wrong?
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; configuration: libvirt : 0.6.3
&gt;&gt;&gt;&gt;&gt;&gt;                     Java Bindings: 0.4.2
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; I didn't look into this problem in detail, but I think you need to
&gt;&gt;&gt;&gt;&gt; call free on the Domain object after you undefined it.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; dm.undefine();
&gt;&gt;&gt;&gt;&gt; dm.free();
&gt;&gt;&gt;&gt;&gt; dm = null;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Matthias
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Okay, calling free doesn't help. I tested it with libvirt 0.6.3 and
&gt;&gt;&gt;&gt; libvirt-java 0.4.6 and can reproduce your problem.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; This problem is fixed in libvirt 0.8.2. I didn't track it down to the
&gt;&gt;&gt;&gt; actual commit.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; So in order to fix your problem you'll have to update libvirt to 0.8.2
&gt;&gt;&gt;&gt; or identify the commit between 0.8.1 and 0.8.2 that fixes your problem
&gt;&gt;&gt;&gt; and backport it to 0.6.3.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Matthias
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; I found the commit (30ec755ecb3350116d2851afa0de02e77dbe2c51) that
&gt;&gt;&gt; avoids the problem in your original test code. I say 'avoid' instead
&gt;&gt;&gt; of 'fix' because the actual fix is to call free on the domain objects
&gt;&gt;&gt; after undefining them as I initially suggested. But when I tested this
&gt;&gt;&gt; I did it wrong and jumped to false conclusions.
&gt;&gt;&gt;
&gt;&gt;&gt; Just to say it once again: Adding free calls solve this problem for me
&gt;&gt;&gt; with libvirt 0.6.3.
&gt;&gt;&gt;
&gt;&gt;&gt; I attached a modified version of your test code that works for me.
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt; Which the latest code has.
&gt;&gt;
&gt;&gt; -- bk
&gt;&gt;
&gt;&gt;
&gt;
&gt;
&gt;
&gt; --
&gt; Thanks &amp; Regards
&gt;
&gt; Ravi Pawar
&gt;

</body></email><email><emailId>20101021092656</emailId><senderName>Osier</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2010-10-21 09:26:56-0400</timestampReceived><subject>Re: [libvirt-users] Virt-v2v</subject><body>

I guess ESX driver is not compiled for your libvirt version.

To   if it's complied, e.g.

# strings /usr/lib64/libvirt.so.0.8.1 | grep esx -i

If you can't see the symbols like "esxDomainCreate, esxDomainDestroy", it's 
not.(In case of CentOS doesn't strip the symbols of libvirt.)

and in that case you need to recompile libvirt from source code and install 
it.

# ./autogen.sh --prefix=/usr --with-esx 
# ./configure
# make
# make install

Hope it works

- Osier
 
----- "Mike Hall" &lt;MHall@astc.nt.gov.au&gt; wrote:

&gt; Usual prologue: we're testing on CentOS 5.5, RHEL subscriptions
&gt; purchased.
&gt; 
&gt; Now trying to use virt-v2v to transfer Win2008 Server guest from ESXi
&gt; host to KVM host.
&gt; 
&gt; Have enabled SSH on ESXi host, and can connect using
&gt; esx+ssh://esxhost, but procedure fails because nc isn't found on ESXi.
&gt; Fair enough. BTW, ESXi looks like a radically cut down RH system
&gt; (/etc/sysconfig being the give-away)?
&gt; 
&gt; So, using esx:// connection method which presumably uses TLS ...
&gt; 
&gt; 
&gt; Connection commands I'm trying to use:
&gt; 
&gt; virt-v2v -f virt-v2v.conf -ic esx://esxhost/?no_verify=1 -op vm_nfs
&gt; 'HPTRIM Sandbox'
&gt; virt-v2v -f virt-v2v.conf -ic esx://esxhost/ -op vm_nfs 'HPTRIM
&gt; Sandbox'
&gt; 
&gt; I have eliminated libvirt error messages (all #38) relating to
&gt; /etc/pki/CA/cacert.pem and /etc/pki/libvirt/private/clientkey.pem by
&gt; creating those files on KVM host according to info on this page:
&gt; 
&gt; http://libvirt.org/remote.html#Remote_libvirtd_configuration
&gt; 
&gt; Now I am down to a simple connection refused error message:
&gt; 
&gt; virt-v2v: Failed to connect to esx://esxhost/: libvirt error code: 38,
&gt; message: unable to connect to 'esxhost': Connection refused
&gt; 
&gt; I have also tried suggestion on webpage above regarding these
&gt; libvirtd.conf settings and restarted libvirtd:
&gt; 
&gt; tls_no_verify_certificate = 1
&gt; key_file = ""
&gt; cert_file = ""
&gt; ca_file = ""
&gt; crl_file = ""
&gt; 
&gt; ... But no change.
&gt; 
&gt; The problem may well be the TLS certificates, PKI isn't one of my
&gt; strong points. I believe the hostnames in the certificates are
&gt; correct. Which certificates (if any) should be copied to the ESXi host
&gt; (client or server)?
&gt; Should I copy any certificates from /etc/vmware/ssl to the KVM host,
&gt; if so which certificate (rui.crt or rui.key) and where to?
&gt; 
&gt; There doesn't appear to be anything resembling an iptables firewall in
&gt; place on the ESXi host.
&gt; 
&gt; Anyway, any suggestions on what the problem could be greatly
&gt; appreciated.
&gt; 
&gt; Michael Hall
&gt; IT Communications Officer
&gt; Alice Springs Town Council
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20101006104552</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2010-10-06 10:45:52-0400</timestampReceived><subject>Re: [libvirt-users] Monitoring and statistics through libvirt</subject><body>

On Fri, Oct 01, 2010 at 03:47:23PM +0200, Tomi wrote:
&gt; Hi folks,
&gt; 
&gt; is it possible to monitor and gather statistics in realtime (CPU,
&gt; memory, HDD, network, ... - something like dstat) of guest systems
&gt; with libvirt through console from host system (KVM based)? If yes, do
&gt; those guests need to be created through libvirt? Thanks for your help
&gt; and time.

  look at
  virDomainBlockStats/virDomainInterfaceStats/virDomainMemoryStats
in the library API, as well as the equivalent commands in the virsh
command line tool domblkstat/domifstat/dommemstat
And sure libvirt must know about the domain to be able to monitor it.

Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

</body></email><email><emailId>20101015231502</emailId><senderName>Peter Phaal</senderName><senderEmail>peter.phaal@inmon.com</senderEmail><timestampReceived>2010-10-15 23:15:02-0400</timestampReceived><subject>Re: [libvirt-users] Monitoring and statistics through libvirt</subject><body>

On Fri, Oct 01, 2010 at 03:47:23PM +0200, Tomi wrote:
&gt; Hi folks,
&gt; 
&gt; is it possible to monitor and gather statistics in realtime (CPU,
&gt; memory, HDD, network, ... - something like dstat) of guest systems
&gt; with libvirt through console from host system (KVM based)? If yes, do
&gt; those guests need to be created through libvirt? Thanks for your help
&gt; and time.

If you have a large number of servers to monitor, you might want to look at the Host \
sFlow agent: http://host-sflow.sourceforge.net/

The Host sFlow agent is installed on the server and locally polls physical server \
statistics and VM statistics using libvirt. The statistics are exported using the \
sFlow protocol. http://www.sflow.org/

If you want detailed network visibility then the Open vSwitch includes sFlow \
monitoring of inter-VM traffic: http://openvswitch.org/

For more information, see:
http://blog.sflow.com/2010/10/kvm.html
http://blog.sflow.com/2010/10/sflowtrend-adds-server-performance.html

Peter


</body></email><email><emailId>20101015232613</emailId><senderName></senderName><senderEmail>peter.phaal</senderEmail><timestampReceived>2010-10-15 23:26:13-0400</timestampReceived><subject>Re: [libvirt-users] Monitoring and statistics through libvirt</subject><body>

On Fri, Oct 01, 2010 at 03:47:23PM +0200, Tomi wrote:
&gt; Hi folks,

&gt; is it possible to monitor and gather statistics in realtime (CPU,
&gt; memory, HDD, network, ... - something like dstat) of guest systems
&gt; with libvirt through console from host system (KVM based)? If yes, do
&gt; those guests need to be created through libvirt? Thanks for your help
&gt; and time.

If you have a large number of servers to monitor, you might want to look at  
the Host sFlow agent:
http://host-sflow.sourceforge.net/

The Host sFlow agent is installed on the server and locally polls physical  
server statistics and VM statistics using libvirt. The statistics are  
exported using the sFlow protocol.
http://www.sflow.org/

If you want detailed network visibility then the Open vSwitch includes  
sFlow monitoring of inter-VM traffic:
http://openvswitch.org/

For more information, see:
http://blog.sflow.com/2010/10/kvm.html
http://blog.sflow.com/2010/10/sflowtrend-adds-server-performance.html

Peter

[Attachment #3 (text/html)]

On Fri, Oct 01, 2010 at 03:47:23PM +0200, Tomi wrote:&lt;br /&gt;&gt; Hi folks,&lt;b=
r /&gt;&gt;&lt;br /&gt;&gt; is it possible to monitor and gather statistics in realt=
ime (CPU,&lt;br /&gt;&gt; memory, HDD, network, ... - something like dstat) of gu=
est systems&lt;br /&gt;&gt; with libvirt through console from host system (KVM ba=
sed)? If yes, do&lt;br /&gt;&gt; those guests need to be created through libvirt?=
 Thanks for your help&lt;br /&gt;&gt; and time.&lt;br /&gt;&lt;br /&gt;If you have a large nu=
mber of servers to monitor, you might want to look at the Host sFlow agent:=
&lt;br /&gt;http://host-sflow.sourceforge.net/&lt;br /&gt;&lt;br /&gt;The Host sFlow agent is=
 installed on the server and locally polls physical server statistics and V=
M statistics using libvirt. The statistics are exported using the sFlow pro=
tocol.&lt;br /&gt;http://www.sflow.org/&lt;br /&gt;&lt;br /&gt;If you want detailed network v=
isibility then the Open vSwitch includes sFlow monitoring of inter-VM traff=
ic:&lt;br /&gt;http://openvswitch.org/&lt;br /&gt;&lt;br /&gt;For more information, see:&lt;br /=
&gt;http://blog.sflow.com/2010/10/kvm.html&lt;br /&gt;http://blog.sflow.com/2010/10/=
sflowtrend-adds-server-performance.html&lt;br /&gt;&lt;br /&gt;Peter

</body></email><email><emailId>20101020142522</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-10-20 14:25:22-0400</timestampReceived><subject>Re: [libvirt-users] Monitoring and statistics through libvirt</subject><body>

On 10/16/2010 10:26 AM, peter.phaal@gmail.com wrote:
&gt; On Fri, Oct 01, 2010 at 03:47:23PM +0200, Tomi wrote:
&gt;&gt; Hi folks,
&gt;
&gt;&gt; is it possible to monitor and gather statistics in realtime (CPU,
&gt;&gt; memory, HDD, network, ... - something like dstat) of guest systems
&gt;&gt; with libvirt through console from host system (KVM based)? If yes, do
&gt;&gt; those guests need to be created through libvirt? Thanks for your help
&gt;&gt; and time.
&gt;
&gt; If you have a large number of servers to monitor, you might want to look
&gt; at the Host sFlow agent:
&gt; http://host-sflow.sourceforge.net/

Useful looking project.  Just added a link to it from the libvirt.org
wiki:

   http://wiki.libvirt.org/page/Main_Page#Networking

Hope that helps. :)

Regards and best wishes,

Justin Clift

</body></email><email><emailId>20101006091301</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2010-10-06 09:13:01-0400</timestampReceived><subject>Re: [libvirt-users] [PATCH] Re: Python XML parsing of domain descriptions?</subject><body>

On Tue, Oct 05, 2010 at 02:50:16PM -0400, James M Leddy wrote:
&gt; rp.gs.com&gt;
&gt; 
&gt; 
&gt; Jon,
&gt; 
&gt; Would you try with this patch?
&gt; 
&gt; diff -c libvirt-0.6.3/docs/schemas/domain.rng libvirt-0.6.3.updateschema/docs/schemas/domain.rng
&gt; *** libvirt-0.6.3/docs/schemas/domain.rng	2010-07-23 12:44:45.000000000 -0400
&gt; --- libvirt-0.6.3.updateschema/docs/schemas/domain.rng	2010-10-05 14:17:16.700561725 -0400
&gt; ***************
&gt; *** 150,155 ****
&gt; --- 150,156 ----
&gt;         &lt;/attribute&gt;
&gt;         &lt;attribute name="machine"&gt;
&gt;           &lt;choice&gt;
&gt; +           &lt;value&gt;rhel5.4.0&lt;/value&gt;
&gt;             &lt;value&gt;xenfv&lt;/value&gt;
&gt;             &lt;value&gt;pc&lt;/value&gt;
&gt;             &lt;value&gt;isapc&lt;/value&gt;

Actually the upcoming RHEL-5.6 libvirt-client package will have something
which is based on current upstream i.e.:

      &lt;optional&gt;
        &lt;attribute name="machine"&gt;
          &lt;data type="string"&gt;
            &lt;param name="pattern"&gt;[a-zA-Z0-9_\.\-]+&lt;/param&gt;
          &lt;/data&gt;
        &lt;/attribute&gt;
      &lt;/optional&gt;

i.e. allowing any reasonable machine type string for the KVM hypervisor.

Daniel
-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

</body></email><email><emailId>20101006181452</emailId><senderName>Jonathan Kelley</senderName><senderEmail>jkelley@vm-labs.com</senderEmail><timestampReceived>2010-10-06 18:14:52-0400</timestampReceived><subject>Re: [libvirt-users] Ruby-libvirt and openAuth</subject><body>

Ignore my last post. I copied what the debian package does for the bindings.
All works fine now!

On Wed, Oct 6, 2010 at 1:44 PM, Jonathan Kelley &lt;jkelley@vm-labs.com&gt; wrote:

&gt; Anyone have any luck using libvirt library inside a ruby cgi script?
&gt;
&gt; I am getting load errors (Internal Server Error) on failing to find
&gt; _libvirt. The same script works fine run from the cmd shell.
&gt;
&gt; My webserver is lighttpd.
&gt;
&gt; Thanks,
&gt; Jon
&gt;
&gt; On Tue, Oct 5, 2010 at 10:08 AM, Chris Lalancette &lt;clalance@redhat.com&gt;wrote:
&gt;
&gt;&gt; On 10/05/10 - 09:58:25AM, Jonathan Kelley wrote:
&gt;&gt; &gt; I guess I was expecting to find a ruby library making calls into the C
&gt;&gt; &gt; library like the Python libvirt.py that is generated.
&gt;&gt; &gt;
&gt;&gt; &gt; I saw these files and thought I was missing something but I understand
&gt;&gt; now
&gt;&gt; &gt; the difference between the Ruby and Python bindings.
&gt;&gt;
&gt;&gt; Ah, no.  The way that this particular binding works is that it is all C
&gt;&gt; code
&gt;&gt; that bridges between the libvirt C api and the various rb_* routines to
&gt;&gt; hook
&gt;&gt; it into ruby.  There are other approaches possible, including something
&gt;&gt; called FFI, but I haven't really looked at them.
&gt;&gt;
&gt;&gt; I've sent you the RDoc documentation for what is in git in a private
&gt;&gt; email.
&gt;&gt; Once I do the next release I will post this updated documentation to the
&gt;&gt; website.
&gt;&gt;
&gt;&gt; --
&gt;&gt; Chris Lalancette
&gt;&gt;
&gt;
&gt;

[Attachment #3 (text/html)]

Ignore my last post. I copied what the debian package does for the bindings. All \
works fine now!&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Wed, Oct 6, 2010 at 1:44 PM, \
Jonathan Kelley &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:jkelley@vm-labs.com"&gt;jkelley@vm-labs.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt; \
&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt;Anyone have any luck using libvirt library inside a ruby cgi \
script?&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I am getting load errors (Internal Server Error) on \
failing to find _libvirt. The same script works fine run from the cmd shell. &lt;/div&gt;

&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;My webserver is \
lighttpd.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;Jon&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div \
class="h5"&gt;&lt;div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Tue, Oct 5, 2010 at 10:08 AM, Chris \
Lalancette &lt;span dir="ltr"&gt;&lt;&lt;a href="mailto:clalance@redhat.com" \
target="_blank"&gt;clalance@redhat.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt;

&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex"&gt;&lt;div&gt;On 10/05/10 - 09:58:25AM, Jonathan Kelley wrote:&lt;br&gt; \
&gt; I guess I was expecting to find a ruby library making calls into the C&lt;br&gt; &gt; \
library like the Python libvirt.py that is generated.&lt;br&gt; &gt;&lt;br&gt;
&gt; I saw these files and thought I was missing something but I understand now&lt;br&gt;
&gt; the difference between the Ruby and Python bindings.&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;Ah, no.  The way that this particular binding works is that it is all C \
code&lt;br&gt; that bridges between the libvirt C api and the various rb_* routines to \
hook&lt;br&gt; it into ruby.  There are other approaches possible, including something&lt;br&gt;
called FFI, but I haven't really looked at them.&lt;br&gt;
&lt;br&gt;
I've sent you the RDoc documentation for what is in git in a private email.&lt;br&gt;
Once I do the next release I will post this updated documentation to the&lt;br&gt;
website.&lt;br&gt;
&lt;br&gt;
--&lt;br&gt;
&lt;font color="#888888"&gt;Chris Lalancette&lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20101007141107</emailId><senderName>Zdenek Styblik</senderName><senderEmail>stybla@turnovfree.net</senderEmail><timestampReceived>2010-10-07 14:11:07-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt] New wiki pages with libvirt SSH setup instructions</subject><body>

On 10/04/2010 09:36 AM, Justin Clift wrote:
&gt; On 09/23/2010 08:08 PM, Zdenek Styblik wrote:
&gt; &lt;snip&gt;
&gt;&gt; I've managed to create ACL by groups and it's working. However, to my
&gt;&gt; surprise, there is Slackware package for PolicyKit. Yet, I have never
&gt;&gt; used it nor tested it (I could though?).
&gt; 
&gt; Interesting. :)
&gt; 
&gt; Ubuntu also has PolicyKit compiled into the client libraries, even
&gt; though by default the libvirt daemon (server side) doesn't use it for
&gt; access control.
&gt; 
&gt; Suspecting it may be in order to allow connection to servers using
&gt; PolityKit for access control.  When compiling the libvirt virsh client
&gt; on MacOS X, there is no PolicyKit available.  Which somehow translates
&gt; into qemu+ssh:// connections to PolicyKit enabled servers not working.
&gt; (even though qemu+tcp:// and qemu+tls:// does).  Same thing happened
&gt; on when I manually compiled virsh _without_ PolicyKit on Fedora 13.
&gt; Couldn't then connect to a PolicyKit enabled libvirtd with qemu+ssh://.
&gt; 

Well, client is on Debian (because of virt-manager package), server is
Slackware. I don't know if this makes difference/help. However, I have
compiled libvirt without PolicyKit present. That was more like a
statement about existence of such package ;) As I've said, I can try it
with PolicyKit too, however/probably inside another VM :P (and more like
"one day")

Hm, and thinking about it, they might be using libvirt without PolicyKit
too, as it works; unless it's MacOS X specific issue.

&gt;&gt;&gt; Asking because if it's using one of those two, then it's extremely
&gt;&gt;&gt; easy to add a new "Slackware" head and point people to the right bit.
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt; Probably both or it depends on whether PolicyKit is installed or not.
&gt;&gt; (T.B.D.?) Group ACL works for sure.
&gt; 
&gt; Cool.  We should document that as "group access configuration is known
&gt; to work" (or something along those lines), for Slackware.
&gt; 
&gt; Heh, don't suppose you have a wiki user account, and feel like doing the
&gt; edit?
&gt; 

Nope, I don't have an wiki account, but that shouldn't be a problem,
should it? :) However, I won't do unless Sunday.

&gt; (yes, I'm trying to encourage people to make updates directly. :&gt;)
&gt; 

Good approach, imho. And sooner means better [real life experience] ;)

[...]
&gt;&gt; I wanted to achieve something like that (= root-less qemu and libvirtd)
&gt;&gt; with 0.8.3, but it didn't work because libvirt/virt-manager claimed ACL
&gt;&gt; problem. I think it's time for re-test and eventual push into
&gt;&gt; "production" of mine :)
&gt; 
&gt; Ahhh, yeah.  I think I understand.  It looks like you're trying to have
&gt; a running virtualisation system, without it using root for anything.
&gt; 
&gt; Sounds like a good idea, but not sure if it can be made to work
&gt; that way yet. :&gt;
&gt; 
&gt; If you do get it working, definitely let me know.... we should write
&gt; it up if so. :)
&gt; 
&gt; Regards and best wishes,
&gt; 
&gt; Justin Clift

Haha, I've soon realized it's probably impossible, since libvirtd needs
access to many things eg. iptables, although ... may be some internal
hacking with duck tape and % sudo; and it could work.

I have achieved, in "production", to have qemu-kvm running as libvirt
and images owned by libvirt user/group. It's also possible to use
non-root user for VM management (hopefully, as I haven't fully tested
this one in "production"). Not exactly perfect, but I'm happy within limits.

Have a nice weekend,
Zdenek

-- 
Zdenek Styblik
Net/Linux admin
OS TurnovFree.net
email: stybla@turnovfree.net
jabber: stybla@jabber.turnovfree.net

</body></email><email><emailId>20101008055500</emailId><senderName>Ravi Pawar</senderName><senderEmail>ravifc@gmail.com</senderEmail><timestampReceived>2010-10-08 05:55:00-0400</timestampReceived><subject>Re: [libvirt-users] Error while starting the domain "error: monitor socket did not show up.: Connect</subject><body>

i could find this in the log file.

LC_ALL=C PATH=/sbin:/usr/sbin:/bin:/usr/bin QEMU_AUDIO_DRV=none
/usr/libexec/qemu-kvm -S -M pc-0.12 -enable-kvm -m 512 -smp
1,sockets=1,cores=1,threads=1 -name tests -uuid
76bc677f-ee5b-ef0b-1d02-72d12785b1d8 -nodefaults -chardev
socket,id=monitor,path=/var/lib/libvirt/qemu/tests.monitor,server,nowait
-mon chardev=monitor,mode=control -no-acpi -boot n -drive
file=/var/lib/libvirt/images/testKVM,if=none,id=drive-ide0-0-0 -device
ide-drive,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0 -device
rtl8139,vlan=0,id=net0,mac=52:54:00:a4:0e:ce,bus=pci.0,addr=0x4 -net
tap,fd=18,vlan=0,name=hostnet0 -usb -vnc 127.0.0.1:0 -k en-us -vga cirrus
-device virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x3
Warning: vlan 0 with no nics
Cannot boot from non-existent NIC

On Wed, Oct 6, 2010 at 4:43 PM, Papp Tams &lt;tompos@martos.bme.hu&gt; wrote:

&gt;
&gt;  On 2010.10.06. 13:06, Ravi Pawar wrote:
&gt;
&gt;&gt; All,
&gt;&gt;
&gt;&gt; here is my domain xml
&gt;&gt;
&gt;&gt; &lt;domain type='kvm'&gt;
&gt;&gt; &lt;name&gt;tests&lt;/name&gt;
&gt;&gt; &lt;uuid&gt;76bc677f-ee5b-ef0b-1d02-72d12785b1d8&lt;/uuid&gt;
&gt;&gt; &lt;memory&gt;524288&lt;/memory&gt;
&gt;&gt; &lt;currentMemory&gt;524288&lt;/currentMemory&gt;
&gt;&gt; &lt;vcpu&gt;1&lt;/vcpu&gt;
&gt;&gt; &lt;os&gt;
&gt;&gt; &lt;type arch='x86_64' machine='pc-0.12'&gt;hvm&lt;/type&gt;
&gt;&gt; &lt;boot dev='network'/&gt;
&gt;&gt; &lt;/os&gt;
&gt;&gt; &lt;clock offset='utc'/&gt;
&gt;&gt; &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
&gt;&gt; &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
&gt;&gt; &lt;on_crash&gt;destroy&lt;/on_crash&gt;
&gt;&gt; &lt;devices&gt;
&gt;&gt; &lt;emulator&gt;/usr/libexec/qemu-kvm&lt;/emulator&gt;
&gt;&gt; &lt;disk type='file' device='disk'&gt;
&gt;&gt; &lt;source file='/var/lib/libvirt/images/testKVM'/&gt;
&gt;&gt; &lt;target dev='hda' bus='ide'/&gt;
&gt;&gt; &lt;address type='drive' controller='0' bus='0' unit='0'/&gt;
&gt;&gt; &lt;/disk&gt;
&gt;&gt; &lt;controller type='ide' index='0'/&gt;
&gt;&gt; &lt;interface type='network'&gt;
&gt;&gt; &lt;mac address='52:54:00:a4:0e:ce'/&gt;
&gt;&gt; &lt;source network='default'/&gt;
&gt;&gt; &lt;target dev='vnet0'/&gt;
&gt;&gt; &lt;/interface&gt;
&gt;&gt; &lt;input type='mouse' bus='ps2'/&gt;
&gt;&gt; &lt;graphics type='vnc' port='-1' autoport='yes' listen='127.0.0.1'
&gt;&gt; keymap='en-us'/&gt;
&gt;&gt; &lt;video&gt;
&gt;&gt; &lt;model type='cirrus' vram='9216' heads='1'/&gt;
&gt;&gt; &lt;/video&gt;
&gt;&gt; &lt;/devices&gt;
&gt;&gt; &lt;/domain&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; my host is RHEL 6 beta.
&gt;&gt; i don't have any clue where i am going wrong in the configuration of the
&gt;&gt; host or configuration of the domain.
&gt;&gt;
&gt;
&gt; Check the logs:
&gt;
&gt; /var/log/libvirt/...
&gt;
&gt; tamas
&gt;



-- 
Thanks &amp; Regards

Ravi Pawar

[Attachment #3 (text/html)]

i could find this in the log file.&lt;br&gt;&lt;br&gt;LC_ALL=C PATH=/sbin:/usr/sbin:/bin:/usr/bin \
QEMU_AUDIO_DRV=none /usr/libexec/qemu-kvm -S -M pc-0.12 -enable-kvm -m 512 -smp \
1,sockets=1,cores=1,threads=1 -name tests -uuid 76bc677f-ee5b-ef0b-1d02-72d12785b1d8 \
-nodefaults -chardev \
socket,id=monitor,path=/var/lib/libvirt/qemu/tests.monitor,server,nowait -mon \
chardev=monitor,mode=control -no-acpi -boot n -drive \
file=/var/lib/libvirt/images/testKVM,if=none,id=drive-ide0-0-0 -device \
ide-drive,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0 -device \
rtl8139,vlan=0,id=net0,mac=52:54:00:a4:0e:ce,bus=pci.0,addr=0x4 -net \
tap,fd=18,vlan=0,name=hostnet0 -usb -vnc &lt;a href="http://127.0.0.1:0" \
target="_blank"&gt;127.0.0.1:0&lt;/a&gt; -k en-us -vga cirrus -device \
virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x3&lt;br&gt;



Warning: vlan 0 with no nics&lt;br&gt;Cannot boot from non-existent NIC&lt;br&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;On Wed, Oct 6, 2010 at 4:43 PM, Papp Tams &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:tompos@martos.bme.hu" \
target="_blank"&gt;tompos@martos.bme.hu&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt;



&lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px \
solid rgb(204, 204, 204); padding-left: 1ex;"&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;  On \
2010.10.06. 13:06, Ravi Pawar wrote:&lt;br&gt; &lt;blockquote class="gmail_quote" \
style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, 204, 204); \
padding-left: 1ex;"&gt; All,&lt;br&gt;
&lt;br&gt;
here is my domain xml&lt;br&gt;
&lt;br&gt;
&lt;domain type='kvm'&gt;&lt;br&gt;
&lt;name&gt;tests&lt;/name&gt;&lt;br&gt;
&lt;uuid&gt;76bc677f-ee5b-ef0b-1d02-72d12785b1d8&lt;/uuid&gt;&lt;br&gt;
&lt;memory&gt;524288&lt;/memory&gt;&lt;br&gt;
&lt;currentMemory&gt;524288&lt;/currentMemory&gt;&lt;br&gt;
&lt;vcpu&gt;1&lt;/vcpu&gt;&lt;br&gt;
&lt;os&gt;&lt;br&gt;
&lt;type arch='x86_64' machine='pc-0.12'&gt;hvm&lt;/type&gt;&lt;br&gt;
&lt;boot dev='network'/&gt;&lt;br&gt;
&lt;/os&gt;&lt;br&gt;
&lt;clock offset='utc'/&gt;&lt;br&gt;
&lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;&lt;br&gt;
&lt;on_reboot&gt;restart&lt;/on_reboot&gt;&lt;br&gt;
&lt;on_crash&gt;destroy&lt;/on_crash&gt;&lt;br&gt;
&lt;devices&gt;&lt;br&gt;
&lt;emulator&gt;/usr/libexec/qemu-kvm&lt;/emulator&gt;&lt;br&gt;
&lt;disk type='file' device='disk'&gt;&lt;br&gt;
&lt;source file='/var/lib/libvirt/images/testKVM'/&gt;&lt;br&gt;
&lt;target dev='hda' bus='ide'/&gt;&lt;br&gt;
&lt;address type='drive' controller='0' bus='0' \
unit='0'/&gt;&lt;br&gt; &lt;/disk&gt;&lt;br&gt;
&lt;controller type='ide' index='0'/&gt;&lt;br&gt;
&lt;interface type='network'&gt;&lt;br&gt;
&lt;mac address='52:54:00:a4:0e:ce'/&gt;&lt;br&gt;
&lt;source network='default'/&gt;&lt;br&gt;
&lt;target dev='vnet0'/&gt;&lt;br&gt;
&lt;/interface&gt;&lt;br&gt;
&lt;input type='mouse' bus='ps2'/&gt;&lt;br&gt;
&lt;graphics type='vnc' port='-1' autoport='yes' \
listen='127.0.0.1' keymap='en-us'/&gt;&lt;br&gt; &lt;video&gt;&lt;br&gt;
&lt;model type='cirrus' vram='9216' heads='1'/&gt;&lt;br&gt;
&lt;/video&gt;&lt;br&gt;
&lt;/devices&gt;&lt;br&gt;
&lt;/domain&gt;&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
my host is RHEL 6 beta.&lt;br&gt;
i don't have any clue where i am going wrong in the configuration of the host or \
configuration of the domain.&lt;br&gt; &lt;/blockquote&gt;
&lt;br&gt;&lt;/div&gt;&lt;/div&gt;
Check the logs:&lt;br&gt;
&lt;br&gt;
/var/log/libvirt/...&lt;br&gt;
&lt;br&gt;
tamas&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;Thanks &amp; Regards&lt;br&gt;&lt;br&gt;Ravi \
Pawar&lt;br&gt;



</body></email><email><emailId>20101011174639</emailId><senderName>Dan Johansson</senderName><senderEmail>kvm@dmj.nu</senderEmail><timestampReceived>2010-10-11 17:46:39-0400</timestampReceived><subject>Re: [libvirt-users] Problems with libvirt / qemu</subject><body>

I have found the problem: In the &lt;disk&gt; section the following was missing "&lt;driver \
name='qemu' type='qcow2'/&gt;". After adding this line it works again.

-- 
Dan


On Monday 11 October 2010 19.36:03 Dan Johansson wrote:
&gt; Yes, the image contains an OS (it works if I start the guest manually).
&gt; 
&gt; &gt; The image contains an OS or not?
&gt; &gt; If not, you can't choose to boot from disk like "&lt;boot dev='hd'/&gt;"
&gt; &gt; 
&gt; &gt; 2010/10/10 Dan Johansson &lt;kvm@dmj.nu&gt;:
&gt; &gt; &gt; HI,
&gt; &gt; &gt; 
&gt; &gt; &gt; I have a small problem with libvirt / qemu. I have created a guest and when I \
&gt; &gt; &gt; start it from the command-line the guests starts OK, but when I start the guest \
&gt; &gt; &gt; through libvirt with "virsh start" I get "Booting from Hard Disk... Boot \
&gt; &gt; &gt; failed: not a bootable disk No bootable device"
&gt; &gt; &gt; 
&gt; &gt; &gt; This is the command-line I use to start the guest (which works)
&gt; &gt; &gt; "cd /var/lib/kvm/Wilmer;  /usr/bin/qemu-system-x86_64 --enable-kvm \
&gt; &gt; &gt; -net nic,vlan=1,model=rtl8139,macaddr=DE:ED:BE:EF:01:03 -net \
&gt; &gt; &gt;                 tap,vlan=1,ifname=qtap13,script=no,downscript=no \
&gt; &gt; &gt; -net nic,vlan=3,model=rtl8139,macaddr=DE:ED:BE:EF:03:03 -net \
&gt; &gt; &gt;                 tap,vlan=3,ifname=qtap33,script=no,downscript=no \
&gt; &gt; &gt; -m 2048 -k de-ch -vnc :3 -daemonize \
&gt; &gt; &gt; Wilmer.qcow2"
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; The libvirt XML-file was created using "virsh domxml-from-native qemu-argv" and \
&gt; &gt; &gt; this is the result of that conversion: &lt;domain type='kvm'&gt;
&gt; &gt; &gt; &lt;name&gt;wilmer&lt;/name&gt;
&gt; &gt; &gt; &lt;uuid&gt;a421968d-0573-1356-8cb7-32caff525a03&lt;/uuid&gt;
&gt; &gt; &gt; &lt;memory&gt;2097152&lt;/memory&gt;
&gt; &gt; &gt; &lt;currentMemory&gt;2097152&lt;/currentMemory&gt;
&gt; &gt; &gt; &lt;vcpu&gt;2&lt;/vcpu&gt;
&gt; &gt; &gt; &lt;os&gt;
&gt; &gt; &gt; &lt;type arch='x86_64' machine='pc-0.12'&gt;hvm&lt;/type&gt;
&gt; &gt; &gt; &lt;boot dev='hd'/&gt;
&gt; &gt; &gt; &lt;/os&gt;
&gt; &gt; &gt; &lt;features&gt;
&gt; &gt; &gt; &lt;acpi/&gt;
&gt; &gt; &gt; &lt;/features&gt;
&gt; &gt; &gt; &lt;clock offset='utc'/&gt;
&gt; &gt; &gt; &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
&gt; &gt; &gt; &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
&gt; &gt; &gt; &lt;on_crash&gt;destroy&lt;/on_crash&gt;
&gt; &gt; &gt; &lt;devices&gt;
&gt; &gt; &gt; &lt;emulator&gt;/usr/bin/qemu-system-x86_64&lt;/emulator&gt;
&gt; &gt; &gt; &lt;disk type='file' device='disk'&gt;
&gt; &gt; &gt; &lt;source file='/var/lib/kvm/Wilmer/Wilmer.qcow2'/&gt;
&gt; &gt; &gt; &lt;target dev='hda' bus='ide'/&gt;
&gt; &gt; &gt; &lt;address type='drive' controller='0' bus='0' unit='0'/&gt;
&gt; &gt; &gt; &lt;/disk&gt;
&gt; &gt; &gt; &lt;controller type='ide' index='0'&gt;
&gt; &gt; &gt; &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x01' function='0x1'/&gt;
&gt; &gt; &gt; &lt;/controller&gt;
&gt; &gt; &gt; &lt;interface type='ethernet'&gt;
&gt; &gt; &gt; &lt;mac address='de:ed:be:ef:01:03'/&gt;
&gt; &gt; &gt; &lt;script path='no'/&gt;
&gt; &gt; &gt; &lt;target dev='qtap13'/&gt;
&gt; &gt; &gt; &lt;model type='rtl8139'/&gt;
&gt; &gt; &gt; &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x04' function='0x0'/&gt;
&gt; &gt; &gt; &lt;/interface&gt;
&gt; &gt; &gt; &lt;interface type='ethernet'&gt;
&gt; &gt; &gt; &lt;mac address='de:ed:be:ef:03:03'/&gt;
&gt; &gt; &gt; &lt;script path='no'/&gt;
&gt; &gt; &gt; &lt;target dev='qtap33'/&gt;
&gt; &gt; &gt; &lt;model type='rtl8139'/&gt;
&gt; &gt; &gt; &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x05' function='0x0'/&gt;
&gt; &gt; &gt; &lt;/interface&gt;
&gt; &gt; &gt; &lt;input type='mouse' bus='ps2'/&gt;
&gt; &gt; &gt; &lt;graphics type='vnc' port='5903' autoport='no' listen=''/&gt;
&gt; &gt; &gt; &lt;video&gt;
&gt; &gt; &gt; &lt;model type='cirrus' vram='9216' heads='1'/&gt;
&gt; &gt; &gt; &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x02' function='0x0'/&gt;
&gt; &gt; &gt; &lt;/video&gt;
&gt; &gt; &gt; &lt;/devices&gt;
&gt; &gt; &gt; &lt;/domain&gt;
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; Anyone seeing something obvious that I have missed?
&gt; &gt; &gt; 
&gt; &gt; &gt; Regards,
&gt; &gt; &gt; --
&gt; &gt; &gt; Dan Johansson, &lt;http://www.dmj.nu&gt;
&gt; &gt; &gt; ***************************************************
&gt; &gt; &gt; This message is printed on 100% recycled electrons!
&gt; &gt; &gt; ***************************************************
&gt; &gt; &gt; 
&gt; &gt; &gt; _______________________________________________
&gt; &gt; &gt; libvirt-users mailing list
&gt; &gt; &gt; libvirt-users@redhat.com
&gt; &gt; &gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; &gt; &gt; 
&gt; &gt; 
&gt; 
&gt; 

-- 
Dan Johansson, &lt;http://www.dmj.nu&gt;
***************************************************
This message is printed on 100% recycled electrons!
***************************************************


</body></email><email><emailId>20101012183840</emailId><senderName>Mitchell Hashimoto</senderName><senderEmail>mitchell.hashimoto@gmail.com</senderEmail><timestampReceived>2010-10-12 18:38:40-0400</timestampReceived><subject>Re: [libvirt-users] Mac OS X: dyld: lazy symbol binding failed</subject><body>

Justin,

I don't. But I'm extremely interested in getting this working for Mac
OS X so I'll look into this. A heavy session of Google, to the rescue!
Let me know if you come up with anything. If you have any hints or if
I find any, feel free to email me directly so we don't spam the ML.

Thanks again for responding to this.

Mitchell

On Tue, Oct 12, 2010 at 5:36 AM, Justin Clift &lt;jclift@redhat.com&gt; wrote:
&gt; On 10/09/2010 05:19 AM, Mitchell Hashimoto wrote:
&gt;&gt;
&gt;&gt; Justin,
&gt;&gt;
&gt;&gt; No problem, I appreciate you even responding/attempting. I'll
&gt;&gt; cross-post this onto libvirt-dev then.
&gt;
&gt; Heh.  They forwarded it to me internally, as I've "been doing stuff for
&gt; OSX". :/
&gt;
&gt; One of them did point out that it's probably something to do with the
&gt; linker not exporting a symbol on MacOS X for some reason.
&gt;
&gt; By default (so I'm told), libvirt uses some kind of linker script to
&gt; do the linking at compile time, and the symbols it exports are in the
&gt; file &lt;libvirt_source_dir&gt;/src/libvirt_public.syms.
&gt;
&gt; It looks to be a plain text file of simple structure, but there's no
&gt; mention of the word "Thread" in it anywhere.
&gt;
&gt; Don't suppose you know much about linking scripts? :)
&gt;
&gt; (yeah, I'm reaching :&gt;)
&gt;
&gt;
&gt;&gt; As for the alternate FFI API, this is was due to a bug in a very early
&gt;&gt; version of the Ruby FFI bridge. By default, all FFI libraries are now
&gt;&gt; loaded using DynamicLibrary#open, as far as I know (I've contributed
&gt;&gt; some to the project). I'll take a look again to make sure this is
&gt;&gt; still the case.
&gt;&gt;
&gt;&gt; Thanks,
&gt;&gt; Mitchell
&gt;
&gt;

</body></email><email><emailId>20101012193642</emailId><senderName>Igor Serebryany</senderName><senderEmail>igor47@moomers.org</senderEmail><timestampReceived>2010-10-12 19:36:42-0400</timestampReceived><subject>Re: [libvirt-users] bootloader_args element</subject><body>


On Tue, Oct 12, 2010 at 10:14:23AM -0700, David Grundy wrote:
&gt; and I don't see anywhere to set the hostname in there.  I am using pygrub
&gt; for the bootloader and noticed the  "bootloader_args" element.

I have had no success using bootloader_args for anything, under Xen PV
with pygrub. It seems to cause my domains to not boot if I put that into
the libvirt XML, even simple stuff like single-user mode. YMMV.

--Igor

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20101013053134</emailId><senderName>Laine Stump</senderName><senderEmail>laine@redhat.com</senderEmail><timestampReceived>2010-10-13 05:31:34-0400</timestampReceived><subject>Re: [libvirt-users] Question about use libvirt</subject><body>

  On 10/12/2010 08:40 PM, Mike Hall wrote:
&gt; Original message:
&gt; For a new system to develop, I need to know if I can use libvirt for 
&gt; to get (listen) the information that pass trought the lan (vlan) of 
&gt; the each VM.
&gt; Marcela's perfect Spanish:
&gt; quiero saber si utilizando esta libreria, puedo utilizar alguna 
&gt; funcin que me permita capturar los mensajes que se envian 
&gt; aplicaciones paralelas de paso de mensajes que se ejecutan en las 
&gt; mquinas virtuales.
&gt; Mike's imperfect translation:
&gt; "I need to know if, using this library (libvirt), I can use a function 
&gt; that allows me to capture information sent by applications in parallel 
&gt; to/in addition to information passed by virtual machines"
&gt; I'm no expert, but I don't think libvirt has access, via virtual 
&gt; networking, to data sent by applications running in virtual machines. 
&gt; My guess is that such data would be accessible in the same way as with 
&gt; physical machines on a physical network (eg tcpdump?).

Correct.

Libvirt just sets up the network plumbing, but never sees any of the 
traffic (that would be extremely inefficient). In the case of user-mode 
networking (everything except a virtio network device in the new 
vhost-net mode) the qemu process does have access to all the data, but I 
don't know of any mechanism it provides to monitor that data (and 
besides, when vhost-net is used, everything stays down at kernel level 
anyway).

As you suggest, the most straightforward way to monitor the network 
traffic of guests is with libpcap, or one of the applications that uses 
libpcap, such as tcpdump or wireshark. You can simply direct it towards 
the virtual bridge created by libvirt for the network the guest(s) are 
connected to (eg, virbr0)

(You could also monitor the vnetX interface created for a particular 
guest, but the name of that device is automatically re-generated every 
time the guest is started, so you would want to parse it out of the xml 
for the guest prior to starting the monitoring each time, and would need 
to restart the monitor process if the guest was restarted)

</body></email><email><emailId>20101014151218</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-10-14 15:12:18-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt] How to rename a domain?</subject><body>

On 10/12/2010 12:58 PM, Ganesh Pagade wrote:
&gt; Hi,
&gt; 
&gt; I am using libvirt Java bindings. How can I rename a domain? Is there an API
&gt; to do this?
&gt; 

There is no API for it. The only way to do it is basically:

virsh dumpxml myvm &gt; foo.xml
&lt;edit foo.xml, change the name&gt;
virsh undefine myvm
virsh define foo.xml

- Cole

</body></email><email><emailId>20101014193705</emailId><senderName></senderName><senderEmail>paul.worner@thomsonreuters.com</senderEmail><timestampReceived>2010-10-14 19:37:05-0400</timestampReceived><subject>[libvirt-users] NFSv4 Storage Pools</subject><body>

Hi,

 

Is it possible to configure libvirt to use NFSv4 for a pool?  I am doing
some iptables SNATing and rpc.statd can't handle it.

 

Thanks,

Paul

 


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:x="urn:schemas-microsoft-com:office:excel" \
xmlns:p="urn:schemas-microsoft-com:office:powerpoint" \
xmlns:a="urn:schemas-microsoft-com:office:access" \
xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882" \
xmlns:s="uuid:BDC6E3F0-6DA3-11d1-A2A3-00AA00C14882" \
xmlns:rs="urn:schemas-microsoft-com:rowset" xmlns:z="#RowsetSchema" \
xmlns:b="urn:schemas-microsoft-com:office:publisher" \
xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" \
xmlns:c="urn:schemas-microsoft-com:office:component:spreadsheet" \
xmlns:odc="urn:schemas-microsoft-com:office:odc" \
xmlns:oa="urn:schemas-microsoft-com:office:activation" \
xmlns:html="http://www.w3.org/TR/REC-html40" \
xmlns:q="http://schemas.xmlsoap.org/soap/envelope/" \
xmlns:rtc="http://microsoft.com/officenet/conferencing" xmlns:D="DAV:" \
xmlns:Repl="http://schemas.microsoft.com/repl/" \
xmlns:mt="http://schemas.microsoft.com/sharepoint/soap/meetings/" \
xmlns:x2="http://schemas.microsoft.com/office/excel/2003/xml" \
xmlns:ppda="http://www.passport.com/NameSpace.xsd" \
xmlns:ois="http://schemas.microsoft.com/sharepoint/soap/ois/" \
xmlns:dir="http://schemas.microsoft.com/sharepoint/soap/directory/" \
xmlns:ds="http://www.w3.org/2000/09/xmldsig#" \
xmlns:dsp="http://schemas.microsoft.com/sharepoint/dsp" \
xmlns:udc="http://schemas.microsoft.com/data/udc" \
xmlns:xsd="http://www.w3.org/2001/XMLSchema" \
xmlns:sub="http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/" \
xmlns:ec="http://www.w3.org/2001/04/xmlenc#" \
xmlns:sp="http://schemas.microsoft.com/sharepoint/" \
xmlns:sps="http://schemas.microsoft.com/sharepoint/soap/" \
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" \
xmlns:udcs="http://schemas.microsoft.com/data/udc/soap" \
xmlns:udcxf="http://schemas.microsoft.com/data/udc/xmlfile" \
xmlns:udcp2p="http://schemas.microsoft.com/data/udc/parttopart" \
xmlns:wf="http://schemas.microsoft.com/sharepoint/soap/workflow/" \
xmlns:dsss="http://schemas.microsoft.com/office/2006/digsig-setup" \
xmlns:dssi="http://schemas.microsoft.com/office/2006/digsig" \
xmlns:mdssi="http://schemas.openxmlformats.org/package/2006/digital-signature" \
xmlns:mver="http://schemas.openxmlformats.org/markup-compatibility/2006" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns:mrels="http://schemas.openxmlformats.org/package/2006/relationships" \
xmlns:spwp="http://microsoft.com/sharepoint/webpartpages" \
xmlns:ex12t="http://schemas.microsoft.com/exchange/services/2006/types" \
xmlns:ex12m="http://schemas.microsoft.com/exchange/services/2006/messages" \
xmlns:pptsl="http://schemas.microsoft.com/sharepoint/soap/SlideLibrary/" \
xmlns:spsl="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService" \
xmlns:Z="urn:schemas-microsoft-com:" xmlns:st="" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 12 (filtered medium)"&gt;
&lt;style&gt;
&lt;!--
 /* Font Definitions */
 @font-face
	{font-family:Mincho;
	panose-1:2 2 6 9 4 3 5 8 3 5;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Tahoma","sans-serif";
	color:windowtext;
	font-weight:normal;
	font-style:normal;
	text-decoration:none none;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
--&gt;
&lt;/style&gt;
&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapelayout v:ext="edit"&gt;
  &lt;o:idmap v:ext="edit" data="1" /&gt;
 &lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
&lt;/head&gt;

&lt;body lang=EN-US link=blue vlink=purple&gt;

&lt;div class=WordSection1&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;Hi,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;Is it possible to \
configure libvirt to use NFSv4 for a pool? I am doing some iptables SNATing and \
rpc.statd cant handle it.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;Thanks,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;Paul&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span \
style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;


&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;



</body></email><email><emailId>20101015131909</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-10-15 13:19:09-0400</timestampReceived><subject>Re: [libvirt-users] NFS4 + SELinux</subject><body>

On Fri, Oct 15, 2010 at 04:04:13PM +0930, Mike Hall wrote:
&gt; All test machines are CentOS 5.5 (RHEL subscriptions purchased).
&gt; 
&gt; We've had NFS3 storage working fine and decided to try NFS4.
&gt; 
&gt; We can mount an NFS4 share on our KVM host, but the SELinux file context on the \
&gt; mountpoint directory is magically changed from virt_image_t to nfs_t. Restorecon \
&gt; refuses to change it back.

NFS doesn't support extended attributes, so even if the filesystem
exported on the server has suitable labelling, no NFS client will
see the labels. You'll get a single label for the entire mount
point.

&gt; 
&gt; Adding the mount option context=system_u:object_r:virt_image_t on either server or \
&gt; client doesn't help (option not recognised).

The mount option work, but check the mount man page for confirmation of
exact syntax

&gt; What could we be doing wrong? Does NFS4 + KVM work?

The other option is to toggle the 'virt_use_nfs' selinux boolean
which should allow access to nfs_t files.

Daniel
-- 
&gt; &gt; Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
&gt; &gt; http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
&gt; &gt; http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
&gt; &gt; GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|


</body></email><email><emailId>20101020131559</emailId><senderName>Robin Green</senderName><senderEmail>greenrd@greenrd.org</senderEmail><timestampReceived>2010-10-20 13:15:59-0400</timestampReceived><subject>Re: [libvirt-users] libvirt fails to autostart on boot</subject><body>

The presence of the initscript in /etc/init.d does not determine whether it starts or not
at bootup. How to make it do so differs between distributions and even between different
versions of the same distribution. I don't know how it works for Ubuntu 10.04, but I
found this wiki page which may be useful:
https://help.ubuntu.com/community/UbuntuBootupHowto

Regards,
-- 
Robin Green

At Sun, 17 Oct 2010 19:10:12 -0700 (PDT),
Serg Khaladzinski wrote:
&gt; 
&gt; [1  &lt;multipart/alternative (7bit)&gt;]
&gt; [1.1  &lt;text/plain; us-ascii (7bit)&gt;]
&gt; Hi
&gt; 
&gt; I'm having a problem with libvirt. 
&gt; 
&gt; OS: Ubuntu 10.04 
&gt; 
&gt; When I installed everything initially it worked properly, I was able to use 
&gt; virtual manager to connect to QEMU and install (and run guest OS).
&gt; 
&gt; But after I rebooted my box - libvirt is not started even though I can see init 
&gt; script in /etc/init.d/libvirt-bin
&gt; 
&gt; When I start libvirtd manually it works.. But it's kind of annoying for me to do 
&gt; it manually every time..
&gt; 
&gt; Maybe someone may suggest any ideas of how can I debug and fix this issue with 
&gt; libvirt autostart.
&gt; 
&gt; Thanks a lot.
&gt; 
&gt; 
&gt; 
&gt;       
&gt; [1.2  &lt;text/html; us-ascii (7bit)&gt;]
&gt; 
&gt; [2  &lt;text/plain; us-ascii (7bit)&gt;]
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20101020194729</emailId><senderName>Peter Phaal</senderName><senderEmail>peter.phaal@gmail.com</senderEmail><timestampReceived>2010-10-20 19:47:29-0400</timestampReceived><subject>Re: [libvirt-users] Monitoring and statistics through libvirt</subject><body>

Justin,

Thank you for the listing.

For anyone interested in the format of the data exported by the Host sFlow
agent, the following document describes how the libvirt metrics are encoded:
http://www.sflow.org/sflow_host.txt

The sFlow protocol is very simple, the existing libvirt structures are
basically serialized using XDR and sent as UDP datagrams. Apart from the
increased scalability of pushing rather than pulling performance counters;
the sFlow standard links network, server (both physical and virtual) and
application performance statistics together within a single multi-vendor
standard:
http://blog.sflow.com/2010/08/sflow-host-structures.html

Peter


On Wed, Oct 20, 2010 at 7:25 AM, Justin Clift &lt;jclift@redhat.com&gt; wrote:

&gt; On 10/16/2010 10:26 AM, peter.phaal@gmail.com wrote:
&gt;
&gt;&gt; On Fri, Oct 01, 2010 at 03:47:23PM +0200, Tomi wrote:
&gt;&gt;
&gt;&gt;&gt; Hi folks,
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt;  is it possible to monitor and gather statistics in realtime (CPU,
&gt;&gt;&gt; memory, HDD, network, ... - something like dstat) of guest systems
&gt;&gt;&gt; with libvirt through console from host system (KVM based)? If yes, do
&gt;&gt;&gt; those guests need to be created through libvirt? Thanks for your help
&gt;&gt;&gt; and time.
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt; If you have a large number of servers to monitor, you might want to look
&gt;&gt; at the Host sFlow agent:
&gt;&gt; http://host-sflow.sourceforge.net/
&gt;&gt;
&gt;
&gt; Useful looking project.  Just added a link to it from the libvirt.org
&gt; wiki:
&gt;
&gt;  http://wiki.libvirt.org/page/Main_Page#Networking
&gt;
&gt; Hope that helps. :)
&gt;
&gt; Regards and best wishes,
&gt;
&gt; Justin Clift
&gt;
&gt;

[Attachment #3 (text/html)]

Justin,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thank you for the listing. &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;For \
anyone interested in the format of the data exported by the Host sFlow agent, the \
following document describes how the libvirt metrics are encoded:&lt;/div&gt; &lt;div&gt;&lt;a \
href="http://www.sflow.org/sflow_host.txt"&gt;http://www.sflow.org/sflow_host.txt&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The \
sFlow protocol is very simple, the existing libvirt structures are basically \
serialized using XDR and sent as UDP datagrams. Apart from the increased scalability \
of pushing rather than pulling performance counters; the sFlow standard links \
network, server (both physical and virtual) and application performance statistics \
together within a single multi-vendor standard:&lt;/div&gt; &lt;div&gt;&lt;a \
href="http://blog.sflow.com/2010/08/sflow-host-structures.html"&gt;http://blog.sflow.com/ \
2010/08/sflow-host-structures.html&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Peter&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;On Wed, Oct 20, 2010 at 7:25 AM, Justin Clift &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:jclift@redhat.com"&gt;jclift@redhat.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt; &lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt;&lt;div class="im"&gt;On 10/16/2010 10:26 AM, &lt;a \
href="mailto:peter.phaal@gmail.com" target="_blank"&gt;peter.phaal@gmail.com&lt;/a&gt; \
wrote:&lt;br&gt;

&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex"&gt; On Fri, Oct 01, 2010 at 03:47:23PM +0200, Tomi wrote:&lt;br&gt;
&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex"&gt; Hi folks,&lt;br&gt;
&lt;/blockquote&gt;
&lt;br&gt;
&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex"&gt; is it possible to monitor and gather statistics in realtime \
(CPU,&lt;br&gt; memory, HDD, network, ... - something like dstat) of guest systems&lt;br&gt;
with libvirt through console from host system (KVM based)? If yes, do&lt;br&gt;
those guests need to be created through libvirt? Thanks for your help&lt;br&gt;
and time.&lt;br&gt;
&lt;/blockquote&gt;
&lt;br&gt;
If you have a large number of servers to monitor, you might want to look&lt;br&gt;
at the Host sFlow agent:&lt;br&gt;
&lt;a href="http://host-sflow.sourceforge.net/" \
target="_blank"&gt;http://host-sflow.sourceforge.net/&lt;/a&gt;&lt;br&gt; &lt;/blockquote&gt;
&lt;br&gt;&lt;/div&gt;
Useful looking project.  Just added a link to it from the &lt;a \
href="http://libvirt.org" target="_blank"&gt;libvirt.org&lt;/a&gt;&lt;br&gt; wiki:&lt;br&gt;
&lt;br&gt;
  &lt;a href="http://wiki.libvirt.org/page/Main_Page#Networking" \
target="_blank"&gt;http://wiki.libvirt.org/page/Main_Page#Networking&lt;/a&gt;&lt;br&gt; &lt;br&gt;
Hope that helps. :)&lt;br&gt;
&lt;br&gt;
Regards and best wishes,&lt;br&gt;&lt;font color="#888888"&gt;
&lt;br&gt;
Justin Clift&lt;br&gt;
&lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20101021181703</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-10-21 18:17:03-0400</timestampReceived><subject>Re: [libvirt-users] Virt-v2v</subject><body>

2010/10/21 Mike Hall &lt;MHall@astc.nt.gov.au&gt;:
&gt; Usual prologue: we're testing on CentOS 5.5, RHEL subscriptions purchased.
&gt; 
&gt; Now trying to use virt-v2v to transfer Win2008 Server guest from ESXi host to KVM \
&gt; host. 
&gt; Have enabled SSH on ESXi host, and can connect using esx+ssh://esxhost, but \
&gt; procedure fails because nc isn't found on ESXi. Fair enough. BTW, ESXi looks like a \
&gt; radically cut down RH system (/etc/sysconfig being the give-away)?

libvirt doesn't use ssh or any other transports described at [1] for
ESX. libvirt connects directly to the ESX server using HTTPS without
the need for a libvirtd on the ESX server or any libvirt provided
transport.

&gt; So, using esx:// connection method which presumably uses TLS ...

Well, it uses HTTPS, but it doesn't use the TLS transport as described at [1].

&gt; 
&gt; Connection commands I'm trying to use:
&gt; 
&gt; virt-v2v -f virt-v2v.conf -ic esx://esxhost/?no_verify=1 -op vm_nfs 'HPTRIM \
&gt; Sandbox'

This one is probably the correct one, at least the libvirt connection
URI in it is correct.

&gt; virt-v2v -f virt-v2v.conf -ic esx://esxhost/ -op vm_nfs 'HPTRIM Sandbox'

This one requires that your client computer can verify the HTTPS SSL
certificates installed on the ESX server, but this is unlikely unless
you manually replaced them by certificates that are signed by a known
CA. The no_verify=1 parameter in the first command tells libvirt to
ignore verification errors with this certificates so that it works
with the certificates that come with the ESX server by default.

Note that this HTTPS SSL certificates have nothing to do with the
certificates mention in [1].

&gt; I have eliminated libvirt error messages (all #38) relating to \
&gt; /etc/pki/CA/cacert.pem and /etc/pki/libvirt/private/clientkey.pem by creating those \
&gt; files on KVM host according to info on this page: 
&gt; http://libvirt.org/remote.html#Remote_libvirtd_configuration

Configuring the KVM host with proper certificates is a good idea.

&gt; Now I am down to a simple connection refused error message:
&gt; 
&gt; virt-v2v: Failed to connect to esx://esxhost/: libvirt error code: 38, message: \
&gt; unable to connect to 'esxhost': Connection refused 
&gt; I have also tried suggestion on webpage above regarding these libvirtd.conf \
&gt; settings and restarted libvirtd: 
&gt; tls_no_verify_certificate = 1
&gt; key_file = ""
&gt; cert_file = ""
&gt; ca_file = ""
&gt; crl_file = ""
&gt; 
&gt; ... But no change.

libvirt doesn't require a libvirtd on the ESX server.

&gt; The problem may well be the TLS certificates, PKI isn't one of my strong points. I \
&gt; believe the hostnames in the certificates are correct. Which certificates (if any) \
&gt; should be copied to the ESXi host (client or server)? Should I copy any \
&gt; certificates from /etc/vmware/ssl to the KVM host, if so which certificate (rui.crt \
&gt; or rui.key) and where to? 
&gt; There doesn't appear to be anything resembling an iptables firewall in place on the \
&gt; ESXi host. 
&gt; Anyway, any suggestions on what the problem could be greatly appreciated.

The first line of your mail gives me the relevant hint. You use CentOS
5.5 and this one comes with libvirt 0.6.5 IIRC, but ESX support was
added to libvirt in 0.7.0. The error messages you get from libvirt are
misleading and have been improved in libvirt 0.8.3.

limohua and Osier already gave the right hints, so I'm basically just
summarize it here. :)

As Osier points out, even if your libvirt is recent enough in general
it might have been compiled without ESX support. In that case you'll
get the same misleading error messages about refused connections or
missing certificates (form libvirt 0.7.0 until 0.8.3).

In order to fix this problem you probably need to update your libvirt
version and make sure that it is compiled with ESX support.

As this seems to be a common problem I'm improving the documentation
about this right now.

[1] http://libvirt.org/remote.html

Matthias


</body></email><email><emailId>20101022143519</emailId><senderName>Ravi Pawar</senderName><senderEmail>ravifc@gmail.com</senderEmail><timestampReceived>2010-10-22 14:35:19-0400</timestampReceived><subject>Re: [libvirt-users] Fwd: undefining and redefining a Domain from libvirt java bindings</subject><body>

that worked :-)

Thanks,
Ravi

On Thu, Oct 21, 2010 at 9:04 PM, Matthias Bolte &lt;
matthias.bolte@googlemail.com&gt; wrote:

&gt; You need to free() all domain objects that represent the undefine
&gt; domain before defining a domain with the same name again:
&gt;
&gt; System.out.println("first define tt2...");
&gt; Domain dm1 = conn.domainDefineXML(dumpxml);
&gt; Domain dm2 = conn.domainLookupByName("tt2");
&gt; System.out.println("Now undefine....");
&gt; if (dm2 != null) {
&gt;        System.out.println("undefine tt2...");
&gt;        dm2.undefine();
&gt;        dm2.free();
&gt;        dm1.free(); // &lt;---------- need to free dm1 here too
&gt;        System.out.println("undefine tt2... done");
&gt; }
&gt;
&gt; Matthias
&gt;
&gt; 2010/10/21 Ravi Pawar &lt;ravifc@gmail.com&gt;:
&gt; &gt; Thanks Matthias,
&gt; &gt;
&gt; &gt; can you please have a look at the program attached? this should work as i
&gt; &gt; have used free() call. but its not working for me.
&gt; &gt;
&gt; &gt; Thanks,
&gt; &gt; Ravi
&gt; &gt;
&gt; &gt; On Mon, Oct 18, 2010 at 6:20 PM, Bryan Kearney &lt;bkearney@redhat.com&gt;
&gt; wrote:
&gt; &gt;&gt;
&gt; &gt;&gt; On 10/15/2010 10:05 AM, Matthias Bolte wrote:
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; 2010/10/13 Matthias Bolte&lt;matthias.bolte@googlemail.com&gt;:
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; 2010/10/12 Matthias Bolte&lt;matthias.bolte@googlemail.com&gt;:
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; 2010/10/12 Ravi Pawar&lt;ravifc@gmail.com&gt;:
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; hi,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; i am trying to undefine a domain  by using dm.undefine();
&gt; &gt;&gt;&gt;&gt;&gt;&gt; and then trying to create one with same name is giving me error
&gt; saying
&gt; &gt;&gt;&gt;&gt;&gt;&gt; 'Domain not found: no domain with matching uuid
&gt; &gt;&gt;&gt;&gt;&gt;&gt; 'aeae9d4e-17cb-b661-a612-88ac677c28c1'
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; i have attached my test program which reproduces the issue.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; please let me know where i am going wrong?
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; configuration: libvirt : 0.6.3
&gt; &gt;&gt;&gt;&gt;&gt;&gt;                     Java Bindings: 0.4.2
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; I didn't look into this problem in detail, but I think you need to
&gt; &gt;&gt;&gt;&gt;&gt; call free on the Domain object after you undefined it.
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; dm.undefine();
&gt; &gt;&gt;&gt;&gt;&gt; dm.free();
&gt; &gt;&gt;&gt;&gt;&gt; dm = null;
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; Matthias
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; Okay, calling free doesn't help. I tested it with libvirt 0.6.3 and
&gt; &gt;&gt;&gt;&gt; libvirt-java 0.4.6 and can reproduce your problem.
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; This problem is fixed in libvirt 0.8.2. I didn't track it down to the
&gt; &gt;&gt;&gt;&gt; actual commit.
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; So in order to fix your problem you'll have to update libvirt to 0.8.2
&gt; &gt;&gt;&gt;&gt; or identify the commit between 0.8.1 and 0.8.2 that fixes your problem
&gt; &gt;&gt;&gt;&gt; and backport it to 0.6.3.
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; Matthias
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; I found the commit (30ec755ecb3350116d2851afa0de02e77dbe2c51) that
&gt; &gt;&gt;&gt; avoids the problem in your original test code. I say 'avoid' instead
&gt; &gt;&gt;&gt; of 'fix' because the actual fix is to call free on the domain objects
&gt; &gt;&gt;&gt; after undefining them as I initially suggested. But when I tested this
&gt; &gt;&gt;&gt; I did it wrong and jumped to false conclusions.
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; Just to say it once again: Adding free calls solve this problem for me
&gt; &gt;&gt;&gt; with libvirt 0.6.3.
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; I attached a modified version of your test code that works for me.
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; Which the latest code has.
&gt; &gt;&gt;
&gt; &gt;&gt; -- bk
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; --
&gt; &gt; Thanks &amp; Regards
&gt; &gt;
&gt; &gt; Ravi Pawar
&gt; &gt;
&gt;



-- 
Thanks &amp; Regards

Ravi Pawar

[Attachment #3 (text/html)]

that worked :-)&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;Ravi&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Thu, Oct \
21, 2010 at 9:04 PM, Matthias Bolte &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt; &lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; \
border-left: 1px solid rgb(204, 204, 204); padding-left: 1ex;"&gt;You need to free() all \
domain objects that represent the undefine&lt;br&gt; domain before defining a domain with \
the same name again:&lt;br&gt; &lt;br&gt;
System.out.println("first define tt2...");&lt;br&gt;
&lt;div class="im"&gt;Domain dm1 = conn.domainDefineXML(dumpxml);&lt;br&gt;
&lt;/div&gt;Domain dm2 = conn.domainLookupByName("tt2");&lt;br&gt;
System.out.println("Now undefine....");&lt;br&gt;
if (dm2 != null) {&lt;br&gt;
        System.out.println("undefine tt2...");&lt;br&gt;
        dm2.undefine();&lt;br&gt;
        dm2.free();&lt;br&gt;
        dm1.free(); // &lt;---------- need to free dm1 here too&lt;br&gt;
        System.out.println("undefine tt2... done");&lt;br&gt;
}&lt;br&gt;
&lt;br&gt;
Matthias&lt;br&gt;
&lt;br&gt;
2010/10/21 Ravi Pawar &lt;&lt;a \
href="mailto:ravifc@gmail.com"&gt;ravifc@gmail.com&lt;/a&gt;&gt;:&lt;br&gt; &lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div \
class="h5"&gt;&gt; Thanks Matthias,&lt;br&gt; &gt;&lt;br&gt;
&gt; can you please have a look at the program attached? this should work as i&lt;br&gt;
&gt; have used free() call. but its not working for me.&lt;br&gt;
&gt;&lt;br&gt;
&gt; Thanks,&lt;br&gt;
&gt; Ravi&lt;br&gt;
&gt;&lt;br&gt;
&gt; On Mon, Oct 18, 2010 at 6:20 PM, Bryan Kearney &lt;&lt;a \
href="mailto:bkearney@redhat.com"&gt;bkearney@redhat.com&lt;/a&gt;&gt; wrote:&lt;br&gt; &gt;&gt;&lt;br&gt;
&gt;&gt; On 10/15/2010 10:05 AM, Matthias Bolte wrote:&lt;br&gt;
&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt; 2010/10/13 Matthias Bolte&lt;&lt;a \
href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;:&lt;br&gt;
 &gt;&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt;&gt; 2010/10/12 Matthias Bolte&lt;&lt;a \
href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;:&lt;br&gt;
 &gt;&gt;&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt;&gt;&gt; 2010/10/12 Ravi Pawar&lt;&lt;a \
href="mailto:ravifc@gmail.com"&gt;ravifc@gmail.com&lt;/a&gt;&gt;:&lt;br&gt; \
&gt;&gt;&gt;&gt;&gt;&gt;&lt;br&gt; &gt;&gt;&gt;&gt;&gt;&gt; hi,&lt;br&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt;&gt;&gt;&gt; i am trying to undefine a domain  by using \
dm.undefine();&lt;br&gt; &gt;&gt;&gt;&gt;&gt;&gt; and then trying to create one with same \
name is giving me error saying&lt;br&gt; &gt;&gt;&gt;&gt;&gt;&gt; 'Domain not found: no \
domain with matching uuid&lt;br&gt; &gt;&gt;&gt;&gt;&gt;&gt; \
'aeae9d4e-17cb-b661-a612-88ac677c28c1'&lt;br&gt; &gt;&gt;&gt;&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt;&gt;&gt;&gt; i have attached my test program which reproduces the \
issue.&lt;br&gt; &gt;&gt;&gt;&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt;&gt;&gt;&gt; please let me know where i am going wrong?&lt;br&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt;&gt;&gt;&gt; configuration: libvirt : 0.6.3&lt;br&gt;
&gt;&gt;&gt;&gt;&gt;&gt;                     Java Bindings: 0.4.2&lt;br&gt;
&gt;&gt;&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt;&gt;&gt; I didn't look into this problem in detail, but I think you \
need to&lt;br&gt; &gt;&gt;&gt;&gt;&gt; call free on the Domain object after you undefined \
it.&lt;br&gt; &gt;&gt;&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt;&gt;&gt; dm.undefine();&lt;br&gt;
&gt;&gt;&gt;&gt;&gt; dm.free();&lt;br&gt;
&gt;&gt;&gt;&gt;&gt; dm = null;&lt;br&gt;
&gt;&gt;&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt;&gt;&gt; Matthias&lt;br&gt;
&gt;&gt;&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt;&gt; Okay, calling free doesn't help. I tested it with libvirt 0.6.3 \
and&lt;br&gt; &gt;&gt;&gt;&gt; libvirt-java 0.4.6 and can reproduce your problem.&lt;br&gt;
&gt;&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt;&gt; This problem is fixed in libvirt 0.8.2. I didn't track it down \
to the&lt;br&gt; &gt;&gt;&gt;&gt; actual commit.&lt;br&gt;
&gt;&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt;&gt; So in order to fix your problem you'll have to update libvirt to \
0.8.2&lt;br&gt; &gt;&gt;&gt;&gt; or identify the commit between 0.8.1 and 0.8.2 that fixes \
your problem&lt;br&gt; &gt;&gt;&gt;&gt; and backport it to 0.6.3.&lt;br&gt;
&gt;&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt;&gt; Matthias&lt;br&gt;
&gt;&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt; I found the commit (30ec755ecb3350116d2851afa0de02e77dbe2c51) that&lt;br&gt;
&gt;&gt;&gt; avoids the problem in your original test code. I say 'avoid' \
instead&lt;br&gt; &gt;&gt;&gt; of 'fix' because the actual fix is to call free on \
the domain objects&lt;br&gt; &gt;&gt;&gt; after undefining them as I initially suggested. \
But when I tested this&lt;br&gt; &gt;&gt;&gt; I did it wrong and jumped to false \
conclusions.&lt;br&gt; &gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt; Just to say it once again: Adding free calls solve this problem for \
me&lt;br&gt; &gt;&gt;&gt; with libvirt 0.6.3.&lt;br&gt;
&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&gt; I attached a modified version of your test code that works for me.&lt;br&gt;
&gt;&gt;&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; Which the latest code has.&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt; -- bk&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt; --&lt;br&gt;
&gt; Thanks &amp; Regards&lt;br&gt;
&gt;&lt;br&gt;
&gt; Ravi Pawar&lt;br&gt;
&gt;&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;Thanks &amp; \
Regards&lt;br&gt;&lt;br&gt;Ravi Pawar&lt;br&gt;



</body></email><email><emailId>20101026155421</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2010-10-26 15:54:21-0400</timestampReceived><subject>Re: [libvirt-users] List volumes of a domain</subject><body>

On Tue, Oct 26, 2010 at 04:05:23PM +0200, Andrea Turli wrote:
&gt; Hi all,
&gt; 
&gt; I'm using libvirt java binding (libvirt-java-0.4.6)
&gt; I'd like to know if the Domain class offers an API to query volumes
&gt; attached to a particular domain or should I parse the XML domain
&gt; description?

  There is no such API at the C level, and I doubt there is any
convenience API at the Java level either. The simplest is to
use the /domain/devices/disk XPath expression result on the
domain XML to get back the list.
  http://libvirt.org/formatdomain.html#elementsDisks

Daniel


-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

</body></email><email><emailId>20101028032141</emailId><senderName>Osier</senderName><senderEmail>jyang@redhat.com</senderEmail><timestampReceived>2010-10-28 03:21:41-0400</timestampReceived><subject>Re: [libvirt-users] Compiling libvirt-0.8.4 for NFSv4</subject><body>

 20101027 21:51, paul.worner@thomsonreuters.com :
&gt; Hi all,
&gt;
&gt; Not sure if this will be useful to anyone. Worse, it's probably not
&gt; complete or correct, but I thought I would throw this out there for comment.
&gt;
&gt; I asked earlier about configuring libvirt for NFSv4 support. I wanted to
&gt; define NFSv4 pool from xml config, but it's not an option. I decided to
&gt; hack a bit. Added the following to source code:
&gt;
&gt; storage_conf.h(417):
&gt;
&gt; enum virStoragePoolFormatFileSystemNet {
&gt;
&gt; VIR_STORAGE_POOL_NETFS_AUTO = 0,
&gt;
&gt; VIR_STORAGE_POOL_NETFS_NFS,
&gt;
&gt; VIR_STORAGE_POOL_NETFS_NFS4,
&gt;
&gt; VIR_STORAGE_POOL_NETFS_GLUSTERFS,
&gt;
&gt; VIR_STORAGE_POOL_NETFS_CIFS,
&gt;
&gt; VIR_STORAGE_POOL_NETFS_LAST,
&gt;
&gt; };
&gt;
&gt; storage_conf.c(64):
&gt;
&gt; VIR_ENUM_IMPL(virStoragePoolFormatFileSystemNet,
&gt;
&gt; VIR_STORAGE_POOL_NETFS_LAST,
&gt;
&gt; "auto", "nfs", "nfs4", "glusterfs", "cifs")
&gt;
&gt; Compiled libvirt and then created storage pool xml:
&gt;
&gt; &lt;pool type="netfs"&gt;
&gt;
&gt; &lt;name&gt;pool2&lt;/name&gt;
&gt;
&gt; &lt;source&gt;
&gt;
&gt; &lt;host name="test_filer"/&gt;
&gt;
&gt; &lt;dir path="/libvirt"/&gt;
&gt;
&gt; &lt;format type="nfs4"/&gt;
&gt;
&gt; &lt;/source&gt;
&gt;
&gt; &lt;target&gt;
&gt;
&gt; &lt;path&gt;"/usr/local/var/lib/libvirt/images/nfsds2"&lt;/path&gt;
&gt;
&gt; &lt;/target&gt;
&gt;
&gt; &lt;/pool&gt;
&gt;
&gt; Virsh pool-create [above xml]' works, using mount t nfs4'.

Think it's fine to create the pool if your host support nfs4,
but not sure if it will work when you want to use the security driver.
, probly the boolean "virt_use_nfs" of selinux will not work
for nfs4.

&gt;
&gt; Again, this seemed too easy, so I won't be surprised if things break.
&gt; However, I was just trying to demonstrate functionality in lab, so
&gt; failures are fine short term.
&gt;
&gt; Please comment on flaws or improvements to this approach.
&gt;
&gt; Thanks,

have you considered to make a patch and send it to libvir-list?
all of the upstream development of libvirt are discussed there. :-)

- Osier
&gt;
&gt; Paul Worner
&gt;
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20101028205549</emailId><senderName> </senderName><senderEmail>denis.barishev@gmail.com</senderEmail><timestampReceived>2010-10-28 20:55:49-0400</timestampReceived><subject>[libvirt-users] libvirt problems. Create bridged network via cmdline?</subject><body>

Hello!

I've faced a weird problem. And I totally can't understand how libvirt
handles networks. The thing that i need to do is simple. I create a bridge
in my ubuntu host, the following config:

*iface eth0 inet manual*
*
*
*auto br0*
*iface br0 inet dhcp*
*  bridge_ports eth0*
*  bridge_stp on*
*  bridge_maxwait 0*

That's OK, and my bridge turns up automatically. But I don't understand why
libvirt can't use it, it always want to create bridge on its own. So that
when I try to create bridged network with the command:
  virsh virsh net-create net.xml

net.xml contents:
* &lt;network&gt;*
*  &lt;name&gt;virbreth0&lt;/name&gt;*
*  &lt;bridge name='br0' stp='on' delay='0' /&gt;*
* &lt;/network&gt;*

I always get error ===&gt;
error: Failed to create network from net.xml
error: cannot create bridge 'br0': File exists

That's pretty obvious that libvirt wants to create bridge on its own. But
what should I do in my specific situation. May be there is a workaround.
I appreciate any help and ideas...

Thanks for your answers.

Best regards,
  Denis Barishev.

[Attachment #3 (text/html)]

&lt;div&gt;Hello!&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I've faced a weird problem. And I totally \
can't understand how libvirt handles networks. The thing that i need to do is \
simple. I create a bridge in my ubuntu host, the following config:&lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="'times new roman', \
serif"&gt;&lt;b&gt;iface eth0 inet manual&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" \
face="'times new roman', serif"&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font \
class="Apple-style-span" face="'times new roman', serif"&gt;&lt;b&gt;auto \
br0&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="'times new \
roman', serif"&gt;&lt;b&gt;iface br0 inet dhcp&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt; &lt;font \
class="Apple-style-span" face="'times new roman', serif"&gt;&lt;b&gt;    bridge_ports \
eth0&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="'times new \
roman', serif"&gt;&lt;b&gt;    bridge_stp on&lt;/b&gt;&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font \
class="Apple-style-span" face="'times new roman', serif"&gt;&lt;b&gt;    \
bridge_maxwait 0&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;That's OK, and my bridge \
turns up automatically. But I don't understand why libvirt can't use it, it \
always want to create bridge on its own. So that when I try to create bridged network \
with the command:&lt;/div&gt; &lt;div&gt;    virsh  virsh net-create \
net.xml&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;net.xml contents:&lt;/div&gt;&lt;div&gt;&lt;font \
class="Apple-style-span" face="'times new roman', serif"&gt;&lt;b&gt;  \
&lt;network&gt;&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="'times \
new roman', serif"&gt;&lt;b&gt;    &lt;name&gt;virbreth0&lt;/name&gt;&lt;/b&gt;&lt;/font&gt;&lt;/div&gt; \
&lt;div&gt;&lt;font class="Apple-style-span" face="'times new roman', serif"&gt;&lt;b&gt;    \
&lt;bridge name='br0' stp='on' delay='0' \
/&gt;&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="'times new \
roman', serif"&gt;&lt;b&gt;  &lt;/network&gt;&lt;/b&gt;&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I \
always get error ===&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;font class="Apple-style-span" \
face="'times new roman', serif"&gt;error: Failed to create network from \
net.xml&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="'times new \
roman', serif"&gt;error: cannot create bridge 'br0': File \
exists&lt;/font&gt;&lt;/div&gt; &lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="'times new \
roman', serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="arial, \
helvetica, sans-serif"&gt;That's pretty obvious that libvirt wants to create bridge \
on its own. But what should I do in my specific situation. May be there is a \
workaround. I  appreciate  any help and  ideas...&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font \
class="Apple-style-span" face="arial, helvetica, \
sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="arial, \
helvetica, sans-serif"&gt;Thanks for your answers.&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
class="Apple-style-span" face="arial, helvetica, sans-serif"&gt;&lt;br&gt; \
&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="arial, helvetica, \
sans-serif"&gt;Best regards,&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" \
face="arial, helvetica, sans-serif"&gt;    Denis Barishev.&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt; \
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20101030154322</emailId><senderName>Bruce Hohl</senderName><senderEmail>brucehohl@gmail.com</senderEmail><timestampReceived>2010-10-30 15:43:22-0400</timestampReceived><subject>[libvirt-users] qemu sdl parameters via libvirt</subject><body>

Hello List, I run a few VMs via libvirt using '--sdl'.  I would like
to use qemu parameters -no-quit, -no-frame and -ctrl-grab with
libvirt.  Does libvirt support a way to use these qemu parameters?
Does libvirt provide a way to add these options under &lt;graphics/&gt; in
the domain.xml using 'virsh edit domain.xml'?

My current &lt;graphics/&gt; is as follows:
&lt;graphics type='sdl' display=':0' xauth='/home/admin1/.Xauthority'/&gt;

I know I could just create a regular kvm start-up script and include
these parameters but I would like to manages all VMs via libvirt &amp;
virt-manager.

</body></email><email><emailId>20101031231056</emailId><senderName>Mike Hall</senderName><senderEmail>mhall@astc.nt.gov.au</senderEmail><timestampReceived>2010-10-31 23:10:56-0400</timestampReceived><subject>Re: [libvirt-users] SCSI tape drive device</subject><body>

I thought this was in the Virtusalisation Guide, but can't find it there now.
Anyway, this is how I got a USB device (printer in this case) passed through to a VM. \
The same general procedure may work for you:


Assuming the USB device is plugged in, powered on and has been recognised by the \
system, the first step is to locate vendor and product ID information for the device \
using lsusb:

# lsusb

Bus 002 Device 001: ID 0000:0000
Bus 001 Device 001: ID 0000:0000
Bus 001 Device 002: ID 1058:1021 Western Digital Technologies, Inc.
Bus 004 Device 001: ID 0000:0000
Bus 004 Device 002: ID 046d:c018 Logitech, Inc. Optical Wheel Mouse
Bus 003 Device 002: ID 04f9:0033 Brother Industries, Ltd
Bus 003 Device 001: ID 0000:0000

The printer information is in the line containing 'Brother Industries, Ltd'. What we \
need are the hexadecimal numbers 04f9:0033.

The next step is to open the XML configuration file for the VM we wish to add this \
device to, and add the following section (from &lt;hostdev&gt; to &lt;/hostdev&gt; inclusive). \
Notice how the numbers discovered above are added using the hexadecimal 0x prefix:

&lt;domain type='kvm'&gt;
  &lt;name&gt;vm_name&lt;/name&gt;
  ...
  &lt;devices&gt;
    ...
    &lt;hostdev mode='subsystem' type='usb'&gt;
      &lt;source&gt;
        &lt;vendor id='0x04f9'/&gt;
        &lt;product id='0x0033'/&gt;
      &lt;/source&gt;
    &lt;/hostdev&gt;
    ...
  &lt;/devices&gt;
&lt;/domain&gt;

For this to work, it is necessary that the device in question is not in use on the \
host. In this case, the printer driver is not installed on the host so all is OK. \
Otherwise, it may be necessary to remove drivers from the host to be safe. For USB \
block devices, it is enough to simply not mount a device on the host.

Note also that the USB device must be attached to the host when the VM is booted, and \
remain attached. There is no Plug'n'Play type operation possible with this solution, \
although it is reportedly possible to enable such functionality.

When the VM is started using the modified XML configuration file, running lsusb on \
that machine should reveal that the USB device has now been passed through from the \
host to the guest. In this case, printer drivers can now be installed normally on the \
guest.




-----Original Message-----
From: libvirt-users-bounces@redhat.com [mailto:libvirt-users-bounces@redhat.com] On \
                Behalf Of Tom Stave
Sent: Friday, 29 October 2010 10:58 PM
To: libvirt-users@redhat.com
Subject: [libvirt-users] SCSI tape drive device


I have a SCSI tape backup unit attached to a kvm host managed by
libvirt.  Is there a way to expose the SCSI device in libvirt so I could
pass the device to a virtual machine and have the virtual machine
control the tape backup?

Defining the device as a SCSI disk does not appear to work.

In this situation, live migration is not an issue.  The VM would always
be tied to this host.

_______________________________________________
libvirt-users mailing list
libvirt-users@redhat.com https://www.redhat.com/mailman/listinfo/libvirt-users
-------------------------------Safe Stamp-----------------------------------
Your Anti-virus Service scanned this email. It is safe from known viruses. For more \
information regarding this service, please contact your service provider.


</body></email><email><emailId>20100910141614</emailId><senderName>Lucas Arbiza</senderName><senderEmail>lucas.arbiza@gmail.com</senderEmail><timestampReceived>2010-09-10 14:16:14-0400</timestampReceived><subject>[libvirt-users] KVM guest creation - no manual interference</subject><body>

Hi

I've looking for a way to create KVM virtual machines completely automated
without the need to interact with guest operating system during
installation.

With ubuntu-vm-builder is possible create the guest, list packages to be
installed and scripts to be run. Is there a way to do something like it with
libvirt?

Thanks!
__

Lucas Arbiza

email: lucas.arbiza@gmail.com
celular: +55 (55) 9152 7561

&lt;http://br.linkedin.com/in/lucasarbiza&gt;
&lt;http://www.google.com/profiles/lucas.arbiza&gt;

[Attachment #3 (text/html)]

&lt;font color="#000000"&gt;&lt;font face="verdana,sans-serif"&gt;Hi&lt;/font&gt;&lt;/font&gt;&lt;div&gt;&lt;font \
color="#000000"&gt;&lt;font face="verdana,sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
color="#000000"&gt;&lt;font face="verdana,sans-serif"&gt;I've looking for a way to create \
KVM virtual machines completely automated without the need to interact with guest \
operating system during installation.&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;

&lt;div&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;With ubuntu-vm-builder is possible create the guest, list \
packages to be installed and scripts to be run. Is there a way to do something like \
it with libvirt?&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;

&lt;div&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;Thanks!&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;__&lt;br&gt;&lt;br&gt;Lucas \
Arbiza&lt;br&gt;&lt;br&gt;email: &lt;a href="mailto:lucas.arbiza@gmail.com" \
target="_blank"&gt;lucas.arbiza@gmail.com&lt;/a&gt;&lt;br&gt;

celular: +55 (55) 9152 7561&lt;br&gt;
&lt;br&gt;&lt;a href="http://br.linkedin.com/in/lucasarbiza" target="_blank"&gt;&lt;img \
src="http://lucasarbiza.com/wp-content/themes/Lucas/images/linkedin-profile.png"&gt;&lt;/a&gt; \
&lt;a href="http://www.google.com/profiles/lucas.arbiza" target="_blank"&gt;&lt;img \
src="http://lucasarbiza.com/wp-content/themes/Lucas/images/Google-profile.png"&gt;&lt;/a&gt;&lt;br&gt;



&lt;br&gt;
&lt;/div&gt;



</body></email><email><emailId>20100915093207</emailId><senderName>Jean Michault</senderName><senderEmail>micjea@ch-perigueux.fr</senderEmail><timestampReceived>2010-09-15 09:32:07-0400</timestampReceived><subject>[libvirt-users] sco 5.0.5 not booting on hard disk</subject><body>

Hello,
I am trying to run SCO unix 5.0.5 with KVM.

I have created the Virtual Machine with virt-manager.
The installation runs correctly, but when the virtual machine reboots 
from hard disk, i obtain this message :
"FATAL: No bootable device."

If i run manually the virtual machine without the suboption "boot=on" in 
the "-drive" option, the virtual machine boots correctly.

Why is "boot=on" preventing my VM to boot ?

Is there a way to modify the .xml file for this VM to inform libvirt to 
not add "boot=on" ?

Thanks

Jean Michault.

</body></email><email><emailId>20100916164841</emailId><senderName>Sharad Mishra</senderName><senderEmail>snmishra@us.ibm.com</senderEmail><timestampReceived>2010-09-16 16:48:41-0400</timestampReceived><subject>[libvirt-users] virConnectOpen question.</subject><body>

Hi,

	I am using virConnectOpen(const char *uri) to connect to the local
hypervisor. When uri is set to "lxc:///", an error gets logged
in /var/log/messages about failed connection. But I do not see any erro=
r
for "xen:///". The machine does not have these drivers installed, and I=
 am
using libvirt 0.6.3. My questions are -

1. Why I see error in /var/log/messages for container and not for xen?

2. Is there a way to avoid this error? Can I check for installed driver=
s
before trying to connect?


Thanks
Sharad Mishra=

[Attachment #3 (text/html)]

&lt;html&gt;&lt;body&gt;
&lt;p&gt;Hi,&lt;br&gt;
&lt;br&gt;
	I am using virConnectOpen(const char *uri) to connect to the local hyp=
ervisor. When uri is set to "lxc:///", an error gets logged i=
n /var/log/messages about failed connection. But I do not see any error=
 for "xen:///". The machine does not have these drivers insta=
lled, and I am using libvirt 0.6.3. My questions are -&lt;br&gt;
&lt;br&gt;
1. Why I see error in /var/log/messages for container and not for xen?&lt;=
br&gt;
&lt;br&gt;
2. Is there a way to avoid this error? Can I check for installed driver=
s before trying to connect?&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
Sharad Mishra&lt;br&gt;
&lt;/body&gt;&lt;/html&gt;=


</body></email><email><emailId>20100921035820</emailId><senderName>Zach Tibbitts</senderName><senderEmail>zachtib@gmail.com</senderEmail><timestampReceived>2010-09-21 03:58:20-0400</timestampReceived><subject>[libvirt-users] libvirt with multiple users</subject><body>

Hi,

I'm trying to set up a virtual machine server for our newly re-founded LUG
at my school. The idea is for members to have their own virtual machine that
they can learn their way around a Linux system without worry of them hosing
the host system or their own computers.

At home I use libvirt with my server to manage multiple virtual machines,
but the issue I'm running into for this use case is user permissions. As far
as I've seen, anyone who has access to the server over ssh and has access to
the libvirt server via virt-manager has access to all of the virtual
machines. I'd like to find some way for each user to only see their own
virtual machine. Is this possible?

I've considered setting up VMs myself, and giving them direct access via ssh
or VNC, but I'd like them to have access to the console so that they can
attach things like CD images to their VMs for reinstalling or changing
distros.

Is there a way to get libvirt to do what I need here?

Thanks much,

Zach Tibbitts

[Attachment #3 (text/html)]

Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I'm trying to set up a virtual machine server fo=
r our newly re-founded LUG at my school. The idea is for members to have th=
eir own virtual machine that they can learn their way around a Linux system=
 without worry of them hosing the host system or their own computers.&lt;/div&gt;
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;At home I use libvirt with my server to manage multiple=
 virtual machines, but the issue I'm running into for this use case is =
user permissions. As far as I've seen, anyone who has access to the ser=
ver over ssh and has access to the libvirt server via virt-manager has acce=
ss to all of the virtual machines. I'd like to find some way for each u=
ser to only see their own virtual machine. Is this possible?&lt;/div&gt;
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I've considered setting up VMs myself, and giving t=
hem direct access via ssh or VNC, but I'd like them to have access to t=
he console so that they can attach things like CD images to their VMs for r=
einstalling or changing distros.&lt;/div&gt;
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is there a way to get libvirt to do what I need here?&lt;/=
div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks much,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Zach Tibbitts=
&lt;/div&gt;


</body></email><email><emailId>20100921082931</emailId><senderName>"CB, Anantha Padmanabhan"</senderName><senderEmail>cbananth@hp.com</senderEmail><timestampReceived>2010-09-21 08:29:31-0400</timestampReceived><subject>[libvirt-users] Query regarding Xen_ComputerSystem</subject><body>

Hi,

Libvirt provides classes such as Xen_ComputerSystem, Xen_Processor etc., in order to \
build applications using libvirt-api which can interact with the Xen Hypervisor.

I would like to know what are the corresponding classes for the KVM hypervisor, so \
that I can use libvirt-cim to communicate with the hypervisor. Would it be \
Kvm_ComputerSystem or Qemu_Computersystem?

Any help in this regard would be of great help.

Thanking you.


Regards
Ananth


</body></email><email><emailId>20100918205249</emailId><senderName>"Glynn D. Reynolds"</senderName><senderEmail>glynnreynolds123@gmail.com</senderEmail><timestampReceived>2010-09-18 20:52:49-0400</timestampReceived><subject>[libvirt-users] XML</subject><body>

Hi!

I am new to libvirt.  I would like to know where would you make the
change to correct this error. I am not sure to add an entry
in /etc/libvirt/network/default.xml or not.

Could you provide ne with a current link to the documentation that will
provide me information to correct this information.

Glynn


 error : virInterfaceDefParseMtu:141 : XML description for interface mtu
value is improper is not well formed or invalid

-- 
Glynn D. Reynolds &lt;glynnreynolds123@gmail.com&gt;
GDRENTERPRISE

</body></email><email><emailId>20100921142916</emailId><senderName>Premysl Vohnout</senderName><senderEmail>vohnout@ccss.cz</senderEmail><timestampReceived>2010-09-21 14:29:16-0400</timestampReceived><subject>[libvirt-users] Booting "real" windows</subject><body>

[Attachment #2 (multipart/mixed)]

[Attachment #4 (multipart/alternative)]


 Hi all,
is it possible to boot using libvirt + kvm real installation of windows
7? I have dual boot sda1 - windows, sda2-linux and I want to boot this sd=
a1

cheers,
Premysl Vohnout

[Attachment #7 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
  &lt;head&gt;

    &lt;meta http-equiv="content-type" content="text/html; charset=ISO-8859-1"&gt;
  &lt;/head&gt;
  &lt;body bgcolor="#ffffff" text="#000000"&gt;
    &lt;font size="+1"&gt;&lt;font face="DejaVu Sans"&gt;Hi all,&lt;br&gt;
        is it possible to boot using libvirt + kvm real installation of
        windows 7? I have dual boot sda1 - windows, sda2-linux and I
        want to boot this sda1&lt;br&gt;
        &lt;br&gt;
        cheers,&lt;br&gt;
        Premysl Vohnout&lt;br&gt;
      &lt;/font&gt;&lt;/font&gt;
  &lt;/body&gt;
&lt;/html&gt;

["vohnout.vcf" (text/x-vcard)]
["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20100921182151</emailId><senderName>Jonathan Kelley</senderName><senderEmail>jkelley@vm-labs.com</senderEmail><timestampReceived>2010-09-21 18:21:51-0400</timestampReceived><subject>[libvirt-users] Configuring libvirt for one driver and XMLRPC issues</subject><body>

Hello,

I am trying to run ./configure --with-one --with-esx but I get the following
error:

checking pkg-config is at least version 0.9.0... yes
checking for XMLRPC... no
configure: error: You must install XMLRPC-C &gt;= 1.14.0 to compile libvirt ONE
driver

However I have downloaded xmlrpc-c-client and built from sources version
1.16.31

root@sa251:~/libvirt-0.8.4# xmlrpc-c-config --version
1.16.31
root@sa251:~/libvirt-0.8.4# xmlrpc-c-config --features
c++ abyss-server curl-client


What am I missing here?

Thanks,
Jon

[Attachment #3 (text/html)]

Hello,&lt;br&gt;&lt;br&gt;I am trying to run ./configure --with-one --with-esx but I get the \
following error:&lt;br&gt;&lt;br&gt;checking pkg-config is at least version 0.9.0... \
yes&lt;br&gt;checking for XMLRPC... no&lt;br&gt;configure: error: You must install XMLRPC-C &gt;= \
1.14.0 to compile libvirt ONE driver&lt;br&gt; &lt;br&gt;However I have downloaded \
xmlrpc-c-client and built from sources version 1.16.31 \
&lt;br&gt;&lt;br&gt;root@sa251:~/libvirt-0.8.4# xmlrpc-c-config \
--version&lt;br&gt;1.16.31&lt;br&gt;root@sa251:~/libvirt-0.8.4# xmlrpc-c-config --features&lt;br&gt;c++ \
abyss-server curl-client&lt;br&gt; &lt;br&gt;&lt;br&gt;What am I missing \
here?&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;Jon&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;



</body></email><email><emailId>20100921190407</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-09-21 19:04:07-0400</timestampReceived><subject>Re: [libvirt-users] Configuring libvirt for one driver and XMLRPC issues</subject><body>

2010/9/21 Jonathan Kelley &lt;jkelley@vm-labs.com&gt;:
&gt; Hello,
&gt;
&gt; I am trying to run ./configure --with-one --with-esx but I get the following
&gt; error:
&gt;
&gt; checking pkg-config is at least version 0.9.0... yes
&gt; checking for XMLRPC... no
&gt; configure: error: You must install XMLRPC-C &gt;= 1.14.0 to compile libvirt ONE
&gt; driver
&gt;
&gt; However I have downloaded xmlrpc-c-client and built from sources version
&gt; 1.16.31
&gt;
&gt; root@sa251:~/libvirt-0.8.4# xmlrpc-c-config --version
&gt; 1.16.31
&gt; root@sa251:~/libvirt-0.8.4# xmlrpc-c-config --features
&gt; c++ abyss-server curl-client
&gt;
&gt;
&gt; What am I missing here?
&gt;

libvirt's configure script doesn't use xmlrpc-c-config to detect
xmlrpc-c, it uses pkg-config:

$ pkg-config --modversion xmlrpc_client
1.17.7

Maybe you need to explicitly set PKG_CONFIG_PATH to point to the the
directory that contains xmlrpc_client.pc, for example:

PKG_CONFIG_PATH=/path/to/xmlrpc-c-dir ./configure --with-one --with-esx

Matthias

</body></email><email><emailId>20100921155440</emailId><senderName>ccmail111</senderName><senderEmail>ccmail111@yahoo.com</senderEmail><timestampReceived>2010-09-21 15:54:40-0400</timestampReceived><subject>[libvirt-users] libvirt and virsh-mgr on guest VM</subject><body>

Hi,
 
Is it possible to run virsh-mgr (or such libvirt client tools) on guest VM for \
managing and monitoring other VMs on host ?  
Any pointers/caveats/docs is appreciated !
 
Thx.
 
CM.


      


[Attachment #3 (text/html)]

&lt;table cellspacing="0" cellpadding="0" border="0" &gt;&lt;tr&gt;&lt;td valign="top" style="font: \
inherit;"&gt;&lt;DIV&gt;Hi,&lt;/DIV&gt; &lt;DIV&gt;&lt;/DIV&gt;
&lt;DIV&gt;Is it possible to run virsh-mgr (or such libvirt client tools) on guest VM for \
managing and monitoring other VMs on host ?&lt;/DIV&gt; &lt;DIV&gt;&lt;/DIV&gt;
&lt;DIV&gt;Any pointers/caveats/docs is appreciated !&lt;/DIV&gt;
&lt;DIV&gt;&lt;/DIV&gt;
&lt;DIV&gt;Thx.&lt;/DIV&gt;
&lt;DIV&gt;&lt;/DIV&gt;
&lt;DIV&gt;CM.&lt;/DIV&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;br&gt;

      



</body></email><email><emailId>20100917141705</emailId><senderName>"frank dirks"</senderName><senderEmail>frankdirks@gmx.net</senderEmail><timestampReceived>2010-09-17 14:17:05-0400</timestampReceived><subject>[libvirt-users] access VMX config on esxi with virsh</subject><body>

Hi,

Is virsh able to access the VMX config of a virtual machine running on a
esxi host?


I would like to take backups of my virtual machine configs and the
doku section 
"Converting from VMware VMX config to domain XML config"
(http://libvirt.org/drvesx.html) comes close to this - but does not tell how
to get access to the vmx file. I would prefer a solution where ssh access to
the esxi host can stay disabled.

best regards, frank

-- 
Neu: GMX De-Mail - Einfach wie E-Mail, sicher wie ein Brief!  
Jetzt De-Mail-Adresse reservieren: http://portal.gmx.net/de/go/demail

</body></email><email><emailId>20100917171801</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-09-17 17:18:01-0400</timestampReceived><subject>Re: [libvirt-users] access VMX config on esxi with virsh</subject><body>

2010/9/17 frank dirks &lt;frankdirks@gmx.net&gt;:
&gt; Hi,
&gt;
&gt; Is virsh able to access the VMX config of a virtual machine running on a
&gt; esxi host?
&gt;
&gt;
&gt; I would like to take backups of my virtual machine configs and the
&gt; doku section
&gt; "Converting from VMware VMX config to domain XML config"
&gt; (http://libvirt.org/drvesx.html) comes close to this - but does not tell how
&gt; to get access to the vmx file. I would prefer a solution where ssh access to
&gt; the esxi host can stay disabled.
&gt;
&gt; best regards, frank

virsh (and libvirt) don't expose the .vmx files, so there is no way to
access them directly trough libvirt. You could get the domain XML
config and convert it to .vmx format using domxml-to-native, but that
doesn't give you the original .vmx file.

The .vmx files are stored in the datastore attached to the ESX(i)
server. You don't need SSH to access the datastore content, An
example, you can access the .vmx file of the virtual machine &lt;vm&gt; on
&lt;esxi-server&gt; stored in &lt;datastore&gt; using this URL:

  https://&lt;esxi-server&gt;/folder/&lt;vm&gt;/&lt;vm&gt;.vmx?dcPath=ha-datacenter&amp;dsName=&lt;datastore&gt;

You can also open https://&lt;esxi-server&gt;/folder/ in your web browser
and navigate through the content.

Matthias

</body></email><email><emailId>20100919170959</emailId><senderName>Narendra Prasad Madanapalli</senderName><senderEmail>narendramind@gmail.com</senderEmail><timestampReceived>2010-09-19 17:09:59-0400</timestampReceived><subject>[libvirt-users] libvirt support for sheepdog file system</subject><body>

Hi Everyone,

I am planning to extend libvirt to support sheepdog for qemu/kvm and
found that storage code is placed in src/storage. Storing files in
sheepdog is independent of file system and we just need to specify
vm-name on qemu command ine. Here are the following comands used for
creating and running a VM using qemu

qemu-img create sheepdog:MyImage001 25G
qemu-system-x86_64 sheepdog:MyImage001


I would appreciate if any one provide pointers on incorporating
sheepdog functionality to libvirt.


Thanks,
Narendra.

</body></email><email><emailId>20100921180009</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-09-21 18:00:09-0400</timestampReceived><subject>Re: [libvirt-users] libvirt support for sheepdog file system</subject><body>

On 09/20/2010 02:57 AM, Narendra Prasad Madanapalli wrote:
&gt; Hi Everyone,
&gt;
&gt; I am planning to extend libvirt to support sheepdog for qemu/kvm and
&gt; found that storage code is placed in src/storage. Storing files in
&gt; sheepdog is independent of file system and we just need to specify
&gt; vm-name on qemu command ine. Here are the following comands used for
&gt; creating and running a VM using qemu
&gt;
&gt; qemu-img create sheepdog:MyImage001 25G
&gt; qemu-system-x86_64 sheepdog:MyImage001
&gt;
&gt;
&gt; I would appreciate if any one provide pointers on incorporating
&gt; sheepdog functionality to libvirt.

Hi Narendra,

This sounds relevant, have you come across it?

   http://www.mail-archive.com/sheepdog@lists.wpkg.org/msg00615.html

I've only just seen it now, but it looks like it might do what you want.

?

Regards and best wishes,

Justin Clift

</body></email><email><emailId>20100920080045</emailId><senderName>"frank dirks"</senderName><senderEmail>frankdirks@gmx.net</senderEmail><timestampReceived>2010-09-20 08:00:45-0400</timestampReceived><subject>Re: [libvirt-users] access VMX config on esxi with virsh</subject><body>

Hi Mathias,

thank you very much - which part of the doku did i miss so i didn't know about the \
web-access to the vmx files?

&gt; virsh (and libvirt) don't expose the .vmx files, so there is no way to
&gt; access them directly trough libvirt. You could get the domain XML
&gt; config and convert it to .vmx format using domxml-to-native, but that
&gt; doesn't give you the original .vmx file.
&gt; 

which command gives me the domain xml? dumpxml gives me an error message (expecting \
an assignment) - the other xml command need the vmx file i guess ...

btw: do you think libvirt is an option for backup tasks around esxi virtual machines? \
or do you know another suitable tool?

regards, frank


-- 
GRATIS: Spider-Man 1-3 sowie 300 weitere Videos!
Jetzt freischalten! http://portal.gmx.net/de/go/maxdome


</body></email><email><emailId>20100920173744</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-09-20 17:37:44-0400</timestampReceived><subject>Re: [libvirt-users] access VMX config on esxi with virsh</subject><body>

On 09/20/2010 06:00 PM, frank dirks wrote:
&gt; Hi Mathias,
&lt;snip&gt;
&gt; which command gives me the domain xml? dumpxml gives me an error
&gt; message (expecting an assignment) - the other xml command need the
&gt; vmx file i guess ...

Hi Frank,

"In theory" the dumpxml should do that.  ie.:

   # virsh dumpxml F11test
   &lt;domain type='kvm'&gt;
     &lt;name&gt;F11test&lt;/name&gt;
     &lt;uuid&gt;cb3878e2-a1fc-c035-e57c-087e11abcbfe&lt;/uuid&gt;
     &lt;memory&gt;1048576&lt;/memory&gt;
     &lt;currentMemory&gt;1048576&lt;/currentMemory&gt;
     &lt;vcpu&gt;2&lt;/vcpu&gt;
     &lt;os&gt;
       &lt;type arch='x86_64' machine='rhel6.0.0'&gt;hvm&lt;/type&gt;
       &lt;boot dev='hd'/&gt;
     &lt;/os&gt;
(...)
       &lt;memballoon model='virtio'&gt;
         &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x05' 
function='0x0'/&gt;
       &lt;/memballoon&gt;
     &lt;/devices&gt;
   &lt;/domain&gt;

However, it sounds like that's not working for you.

That could be a bug. Would you be ok with trying it again, then pasting 
the error message here for us to see?

Regards and best wishes,

Justin Clift

</body></email><email><emailId>20100921120509</emailId><senderName>"frank dirks"</senderName><senderEmail>frankdirks@gmx.net</senderEmail><timestampReceived>2010-09-21 12:05:09-0400</timestampReceived><subject>Re: [libvirt-users] access VMX config on esxi with virsh</subject><body>

Hi,

...
&gt; 
&gt; However, it sounds like that's not working for you.
&gt; 
&gt; That could be a bug. Would you be ok with trying it again, then pasting 
&gt; the error message here for us to see?
&gt; 

- virsh -c esx://esx1.local/?no_verify=1 dominfo vmtest.local --&gt; works OK
- virsh -c esx://esx1.local/?no_verify=1 dumpxml vmtest.local 

gives the error message:
error memory conf:90: expecting an assignment (+ debug logs attached to this mail)

regards, frank
-- 
GMX DSL SOMMER-SPECIAL: Surf &amp; Phone Flat 16.000 fr nur 19,99 Euro/mtl.!*
http://portal.gmx.net/de/go/dsl

["virsh.log" (text/x-log)]

18:36:23.186: debug : virInitialize:339 : register drivers
18:36:23.187: debug : virRegisterDriver:927 : registering Test as driver 0
18:36:23.187: debug : virRegisterNetworkDriver:733 : registering Test as network \
driver 0 18:36:23.187: debug : virRegisterInterfaceDriver:764 : registering Test as \
interface driver 0 18:36:23.187: debug : virRegisterStorageDriver:795 : registering \
Test as storage driver 0 18:36:23.187: debug : virRegisterDeviceMonitor:826 : \
registering Test as device driver 0 18:36:23.187: debug : virRegisterSecretDriver:857 \
: registering Test as secret driver 0 18:36:23.187: debug : \
virRegisterNWFilterDriver:888 : registering Test as network filter driver 0 \
18:36:23.189: debug : virRegisterDriver:927 : registering Xen as driver 1 \
18:36:23.189: debug : virRegisterDriver:927 : registering OPENVZ as driver 2 \
18:36:23.189: debug : virRegisterDriver:927 : registering PHYP as driver 3 \
18:36:23.189: debug : virRegisterStorageDriver:795 : registering PHYP as storage \
driver 1 18:36:23.189: debug : virRegisterNetworkDriver:733 : registering PHYP as \
network driver 1 18:36:23.189: debug : virRegisterDriver:927 : registering ESX as \
driver 4 18:36:23.189: debug : virRegisterInterfaceDriver:764 : registering ESX as \
interface driver 1 18:36:23.189: debug : virRegisterNetworkDriver:733 : registering \
ESX as network driver 2 18:36:23.189: debug : virRegisterStorageDriver:795 : \
registering ESX as storage driver 2 18:36:23.189: debug : \
virRegisterDeviceMonitor:826 : registering ESX as device driver 1 18:36:23.189: debug \
: virRegisterSecretDriver:857 : registering ESX as secret driver 1 18:36:23.189: \
debug : virRegisterNWFilterDriver:888 : registering ESX as network filter driver 1 \
18:36:23.189: debug : virRegisterDriver:927 : registering remote as driver 5 \
18:36:23.189: debug : virRegisterNetworkDriver:733 : registering remote as network \
driver 3 18:36:23.189: debug : virRegisterInterfaceDriver:764 : registering remote as \
interface driver 2 18:36:23.189: debug : virRegisterStorageDriver:795 : registering \
remote as storage driver 3 18:36:23.189: debug : virRegisterDeviceMonitor:826 : \
registering remote as device driver 2 18:36:23.189: debug : \
virRegisterSecretDriver:857 : registering remote as secret driver 2 18:36:23.189: \
debug : virRegisterNWFilterDriver:888 : registering remote as network filter driver 2 \
18:36:23.189: debug : virConnectOpenAuth:1498 : name=esx://esx1.local/?no_verify=1, \
auth=0x7f32ea639de0, flags=0 18:36:23.190: debug : do_open:1204 : name \
"esx://esx1.local/?no_verify=1" to URI components:  scheme esx
  opaque (null)
  authority (null)
  server esx1.local
  user (null)
  port 0
  path /

18:36:23.190: debug : do_open:1243 : trying driver 0 (Test) ...
18:36:23.190: debug : do_open:1249 : driver 0 Test returned DECLINED
18:36:23.190: debug : do_open:1243 : trying driver 1 (Xen) ...
18:36:23.190: debug : do_open:1249 : driver 1 Xen returned DECLINED
18:36:23.190: debug : do_open:1243 : trying driver 2 (OPENVZ) ...
18:36:23.190: debug : do_open:1249 : driver 2 OPENVZ returned DECLINED
18:36:23.190: debug : do_open:1243 : trying driver 3 (PHYP) ...
18:36:23.190: debug : do_open:1249 : driver 3 PHYP returned DECLINED
18:36:23.190: debug : do_open:1243 : trying driver 4 (ESX) ...
18:36:30.571: debug : do_open:1249 : driver 4 ESX returned SUCCESS
18:36:30.571: debug : do_open:1269 : network driver 0 Test returned DECLINED
18:36:30.571: debug : do_open:1269 : network driver 1 PHYP returned DECLINED
18:36:30.571: debug : do_open:1269 : network driver 2 ESX returned SUCCESS
18:36:30.571: debug : do_open:1288 : interface driver 0 Test returned DECLINED
18:36:30.571: debug : do_open:1288 : interface driver 1 ESX returned SUCCESS
18:36:30.571: debug : do_open:1308 : storage driver 0 Test returned DECLINED
18:36:30.571: debug : do_open:1308 : storage driver 1 PHYP returned DECLINED
18:36:30.571: debug : do_open:1308 : storage driver 2 ESX returned SUCCESS
18:36:30.571: debug : do_open:1328 : node driver 0 Test returned DECLINED
18:36:30.571: debug : do_open:1328 : node driver 1 ESX returned SUCCESS
18:36:30.571: debug : do_open:1355 : secret driver 0 Test returned DECLINED
18:36:30.571: debug : do_open:1355 : secret driver 1 ESX returned SUCCESS
18:36:30.571: debug : do_open:1375 : nwfilter driver 0 Test returned DECLINED
18:36:30.571: debug : do_open:1375 : nwfilter driver 1 ESX returned SUCCESS
18:36:30.571: debug : virDomainLookupByName:2154 : conn=0x202dab0, name=vmtest.local
18:36:30.617: debug : virGetDomain:382 : New hash entry 0x20dd6d0
18:36:30.617: debug : virDomainGetXMLDesc:3065 : domain=0x20dd6d0, flags=0
18:36:30.754: error : virConfError:105 : memory conf:90: expecting an assignment
18:36:30.755: debug : virDomainFree:2242 : domain=0x20dd6d0
18:36:30.755: debug : virUnrefDomain:463 : unref domain 0x20dd6d0 vmtest.local 1
18:36:30.755: debug : virReleaseDomain:416 : release domain 0x20dd6d0 vmtest.local \
423e94a9-a1c7-b31d-7161-76c7586c830e 18:36:30.755: debug : virReleaseDomain:433 : \
unref connection 0x202dab0 2 18:36:30.755: debug : virConnectClose:1524 : \
conn=0x202dab0 18:36:30.755: debug : virUnrefConnect:294 : unref connection 0x202dab0 \
1 18:36:30.765: debug : virReleaseConnect:249 : release connection 0x202dab0



</body></email><email><emailId>20100921122629</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-09-21 12:26:29-0400</timestampReceived><subject>Re: [libvirt-users] access VMX config on esxi with virsh</subject><body>

2010/9/21 frank dirks &lt;frankdirks@gmx.net&gt;:
&gt; Hi,
&gt;
&gt; ...
&gt;&gt;
&gt;&gt; However, it sounds like that's not working for you.
&gt;&gt;
&gt;&gt; That could be a bug. Would you be ok with trying it again, then pasting
&gt;&gt; the error message here for us to see?
&gt;&gt;
&gt;
&gt; - virsh -c esx://esx1.local/?no_verify=1 dominfo vmtest.local --&gt; works OK
&gt; - virsh -c esx://esx1.local/?no_verify=1 dumpxml vmtest.local
&gt;
&gt; gives the error message:
&gt; error memory conf:90: expecting an assignment (+ debug logs attached to this mail)
&gt;
&gt; regards, frank

Hm, that's strange. The .vmx config seems to be malformed.

What libvirt version and what ESXi version do you use?

How did you create the vmtest.local guest and can you start it?

Could you show us the original .vmx config file? You can get if by
opening https://esx1.local/folder/ in a web browser and clicking
through the directory tree until you get to vmtest.local.vmx.

Matthias

</body></email><email><emailId>20100922123155</emailId><senderName>"frank dirks"</senderName><senderEmail>frankdirks@gmx.net</senderEmail><timestampReceived>2010-09-22 12:31:55-0400</timestampReceived><subject>Re: [libvirt-users] access VMX config on esxi with virsh</subject><body>


Hi,

you are right - the problem is specific to only that one vmx file - for other virtual \
machines dumpxml is working, as i found out.

i am using esxi 4.1.0 and virsh 0.8.4. the machine was created using vsphere client, \
and was cloned and renamed afterwards - maybe that was the problem ...

regards, frank





&gt; 
&gt; Hm, that's strange. The .vmx config seems to be malformed.
&gt; 
&gt; What libvirt version and what ESXi version do you use?
&gt; 
&gt; How did you create the vmtest.local guest and can you start it?
&gt; 
&gt; Could you show us the original .vmx config file? You can get if by
&gt; opening https://esx1.local/folder/ in a web browser and clicking
&gt; through the directory tree until you get to vmtest.local.vmx.
&gt; 
&gt; Matthias

-- 
Neu: GMX De-Mail - Einfach wie E-Mail, sicher wie ein Brief!  
Jetzt De-Mail-Adresse reservieren: http://portal.gmx.net/de/go/demail


["vmtest.vmx" (application/octet-stream)]

</body></email><email><emailId>20100921161539</emailId><senderName>Premysl Vohnout</senderName><senderEmail>vohnout@ccss.cz</senderEmail><timestampReceived>2010-09-21 16:15:39-0400</timestampReceived><subject>Re: [libvirt-users] Booting "real" windows</subject><body>

And is there any virtualization technology supported by libvirt which 
will allow it?

Dne 21.9.2010 17:40, E.T. Anderson napsal(a):
&gt; It /might/ be technically possible to boot the system, but I'd expect 
&gt; it to blue-screen on you. KVM would present slightly different 
&gt; hardware to the Windows system and Windows customizes itself for your 
&gt; hardware on install and can't change much.
&gt;
&gt; It /is/ possible to install a VM to a physical partition, but you 
&gt; would have to reinstall Windows as a virtual machine. You then would 
&gt; have your current problem in reverse and would only be able to boot 
&gt; the partition virtually.
&gt;
&gt; On Tue, Sep 21, 2010 at 7:29 AM, Premysl Vohnout &lt;vohnout@ccss.cz 
&gt; &lt;mailto:vohnout@ccss.cz&gt;&gt; wrote:
&gt;
&gt;     Hi all,
&gt;     is it possible to boot using libvirt + kvm real installation of
&gt;     windows 7? I have dual boot sda1 - windows, sda2-linux and I want
&gt;     to boot this sda1
&gt;
&gt;     cheers,
&gt;     Premysl Vohnout
&gt;
&gt;     _______________________________________________
&gt;     libvirt-users mailing list
&gt;     libvirt-users@redhat.com &lt;mailto:libvirt-users@redhat.com&gt;
&gt;     https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;
&gt;
&gt;
&gt;
&gt; -- 
&gt; *E.T. Anderson*
&gt; firebringer11@gmail.com &lt;mailto:firebringer11@gmail.com&gt;
&gt; firebringer11@hotmail.com &lt;mailto:firebringer11@hotmail.com&gt;
&gt; (253) 347 - 5903


[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta content="text/html; charset=UTF-8" http-equiv="Content-Type"&gt;
  &lt;/head&gt;
  &lt;body bgcolor="#ffffff" text="#000000"&gt;
    And is there any virtualization technology supported by libvirt
    which will allow it?&lt;br&gt;
    &lt;br&gt;
    Dne 21.9.2010 17:40, E.T. Anderson napsal(a):
    &lt;blockquote
      cite="mid:AANLkTikrPDjrGm8F8O75n9+bvWygLEGArHxS1t9QMoXE@mail.gmail.com"
      type="cite"&gt;It &lt;i&gt;might&lt;/i&gt; be technically possible to boot the
      system, but I'd expect it to blue-screen on you. KVM would present
      slightly different hardware to the Windows system and Windows
      customizes itself for your hardware on install and can't change
      much.
      &lt;div&gt;
        &lt;br&gt;
      &lt;/div&gt;
      &lt;div&gt;It &lt;i&gt;is&lt;/i&gt;  possible to install a VM to a physical
        partition, but you would have to reinstall Windows as a virtual
        machine. You then would have your current problem in reverse and
        would only be able to boot the partition virtually.&lt;br&gt;
        &lt;br&gt;
        &lt;div class="gmail_quote"&gt;On Tue, Sep 21, 2010 at 7:29 AM,
          Premysl Vohnout &lt;span dir="ltr"&gt;&lt;&lt;a moz-do-not-send="true"
              href="mailto:vohnout@ccss.cz"&gt;vohnout@ccss.cz&lt;/a&gt;&gt;&lt;/span&gt;
          wrote:&lt;br&gt;
          &lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt
            0.8ex; border-left: 1px solid rgb(204, 204, 204);
            padding-left: 1ex;"&gt;
            &lt;div bgcolor="#ffffff" text="#000000"&gt; &lt;font size="+1"&gt;&lt;font
                  face="DejaVu Sans"&gt;Hi all,&lt;br&gt;
                  is it possible to boot using libvirt + kvm real
                  installation of windows 7? I have dual boot sda1 -
                  windows, sda2-linux and I want to boot this sda1&lt;br&gt;
                  &lt;br&gt;
                  cheers,&lt;br&gt;
                  Premysl Vohnout&lt;br&gt;
                &lt;/font&gt;&lt;/font&gt; &lt;/div&gt;
            &lt;br&gt;
            _______________________________________________&lt;br&gt;
            libvirt-users mailing list&lt;br&gt;
            &lt;a moz-do-not-send="true"
              href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
            &lt;a moz-do-not-send="true"
              href="https://www.redhat.com/mailman/listinfo/libvirt-users"
              target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt;
          &lt;/blockquote&gt;
        &lt;/div&gt;
        &lt;br&gt;
        &lt;br clear="all"&gt;
        &lt;br&gt;
        -- &lt;br&gt;
        &lt;b&gt;E.T. Anderson&lt;/b&gt;&lt;br&gt;
        &lt;a moz-do-not-send="true" href="mailto:firebringer11@gmail.com"
          target="_blank"&gt;firebringer11@gmail.com&lt;/a&gt;&lt;br&gt;
        &lt;a moz-do-not-send="true"
          href="mailto:firebringer11@hotmail.com" target="_blank"&gt;firebringer11@hotmail.com&lt;/a&gt;&lt;br&gt;
        (253) 347 - 5903&lt;br&gt;
      &lt;/div&gt;
    &lt;/blockquote&gt;
    &lt;br&gt;
  &lt;/body&gt;
&lt;/html&gt;


</body></email><email><emailId>20100920185610</emailId><senderName>"Glynn D. Reynolds"</senderName><senderEmail>glynnreynolds123@gmail.com</senderEmail><timestampReceived>2010-09-20 18:56:10-0400</timestampReceived><subject>[libvirt-users] correction</subject><body>

I have corrected the error!


Error:
Sep 18 13:53:46 gdrenterprise libvirtd: 13:53:46.116: error :
virInterfaceDefParseMtu:141 : XML description for interface mtu value is
improper is not well formed or invalid

To correct this error you will have to remove or correct the entry of
virtual IP's added to /etc/sysconfig/network-scripts/ by the virtual
application.

Theory!
I suspect that if you add the network interface with application that
have non root privileges or you have configured /etc/access.conf.
In additional to running selinix,  root could be the one that may have
the authority to add the network interface configuration.
-- 
Glynn D. Reynolds &lt;glynnreynolds123@gmail.com&gt;
GDRENTERPRISE

</body></email><email><emailId>20100921150903</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2010-09-21 15:09:03-0400</timestampReceived><subject>Re: [libvirt-users] Query regarding Xen_ComputerSystem</subject><body>

On Tue, Sep 21, 2010 at 08:29:31AM +0000, CB, Anantha Padmanabhan wrote:
&gt; Hi,
&gt; 
&gt; Libvirt provides classes such as Xen_ComputerSystem, Xen_Processor etc., in order \
&gt; to build applications using libvirt-api which can interact with the Xen Hypervisor. \
&gt;  I would like to know what are the corresponding classes for the KVM hypervisor, so \
&gt; that I can use libvirt-cim to communicate with the hypervisor. Would it be \
&gt; Kvm_ComputerSystem or Qemu_Computersystem? 
&gt; Any help in this regard would be of great help.

  Hum, you're apparently trying to use libvirt CIM bindings, but there
  is a specific list for this: libvirt-cim@redhat.com

See https://www.redhat.com/mailman/listinfo/libvirt-cim/ for
subscriptions,

 thanks,

Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/


</body></email><email><emailId>20100921151950</emailId><senderName>Sharad Mishra</senderName><senderEmail>snmishra@us.ibm.com</senderEmail><timestampReceived>2010-09-21 15:19:50-0400</timestampReceived><subject>Re: [libvirt-users] Query regarding Xen_ComputerSystem</subject><body>

[Attachment #2 (multipart/alternative)]


Its KVM_ComputerSystem

Sharad Mishra
Open Virtualization
Linux Technology Center
IBM


                                                                       =
    
             "CB, Anantha                                              =
    
             Padmanabhan"                                              =
    
             &lt;cbananth@hp.com&gt;                                         =
 To 
             Sent by:                  "libvirt-users@redhat.com"      =
    
             libvirt-users-bou         &lt;libvirt-users@redhat.com&gt;      =
    
             nces@redhat.com                                           =
 cc 
                                       "cbananth@gmail.com"            =
    
                                       &lt;cbananth@gmail.com&gt;            =
    
             09/21/10 01:29 AM                                     Subj=
ect 
                                       [libvirt-users] Query regarding =
    
                                       Xen_ComputerSystem              =
    
                                                                       =
    
                                                                       =
    
                                                                       =
    
                                                                       =
    
                                                                       =
    
                                                                       =
    




Hi,

Libvirt provides classes such as Xen_ComputerSystem, Xen_Processor etc.=
, in
order to build applications using libvirt-api which can interact with t=
he
Xen Hypervisor.

I would like to know what are the corresponding classes for the KVM
hypervisor, so that I can use libvirt-cim to communicate with the
hypervisor. Would it be Kvm_ComputerSystem or Qemu_Computersystem?

Any help in this regard would be of great help.

Thanking you.


Regards
Ananth

_______________________________________________
libvirt-users mailing list
libvirt-users@redhat.com
https://www.redhat.com/mailman/listinfo/libvirt-users
=

[Attachment #5 (text/html)]

&lt;html&gt;&lt;body&gt;
&lt;p&gt;Its KVM_ComputerSystem&lt;br&gt;
&lt;br&gt;
Sharad Mishra&lt;br&gt;
Open Virtualization&lt;br&gt;
Linux Technology Center&lt;br&gt;
IBM&lt;br&gt;
&lt;br&gt;
&lt;img width="16" height="16" src="cid:1__=08BBFD36DFC79BDE8f9e8a93df938@us.ibm.com" \
border="0" alt="Inactive hide details for "CB, Anantha Padmanabhan" \
---09/21/2010 07:22:32 AM---Hi,"&gt;&lt;font color="#424282"&gt;"CB, Anantha \
Padmanabhan" ---09/21/2010 07:22:32 AM---Hi,&lt;/font&gt;&lt;br&gt; &lt;br&gt;

&lt;table width="100%" border="0" cellspacing="0" cellpadding="0"&gt;
&lt;tr valign="top"&gt;&lt;td \
style="background-image:url(cid:2__=08BBFD36DFC79BDE8f9e8a93df938@us.ibm.com); \
background-repeat: no-repeat; " width="40%"&gt; &lt;ul&gt;
&lt;ul&gt;
&lt;ul&gt;
&lt;ul&gt;&lt;b&gt;&lt;font size="2"&gt;"CB, Anantha Padmanabhan" \
&lt;cbananth@hp.com&gt;&lt;/font&gt;&lt;/b&gt;&lt;font size="2"&gt; &lt;/font&gt;&lt;br&gt; &lt;font size="2"&gt;Sent by: \
libvirt-users-bounces@redhat.com&lt;/font&gt; &lt;p&gt;&lt;font size="2"&gt;09/21/10 01:29 \
AM&lt;/font&gt;&lt;/ul&gt; &lt;/ul&gt;
&lt;/ul&gt;
&lt;/ul&gt;
&lt;/td&gt;&lt;td width="60%"&gt;
&lt;table width="100%" border="0" cellspacing="0" cellpadding="0"&gt;
&lt;tr valign="top"&gt;&lt;td width="1%"&gt;&lt;img width="58" height="1" \
src="cid:3__=08BBFD36DFC79BDE8f9e8a93df938@us.ibm.com" border="0" alt=""&gt;&lt;br&gt; &lt;div \
align="right"&gt;&lt;font size="2"&gt;To&lt;/font&gt;&lt;/div&gt;&lt;/td&gt;&lt;td width="100%"&gt;&lt;img width="1" \
height="1" src="cid:3__=08BBFD36DFC79BDE8f9e8a93df938@us.ibm.com" border="0" \
alt=""&gt;&lt;br&gt; &lt;font size="2"&gt;"libvirt-users@redhat.com" \
&lt;libvirt-users@redhat.com&gt;&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;

&lt;tr valign="top"&gt;&lt;td width="1%"&gt;&lt;img width="58" height="1" \
src="cid:3__=08BBFD36DFC79BDE8f9e8a93df938@us.ibm.com" border="0" alt=""&gt;&lt;br&gt; &lt;div \
align="right"&gt;&lt;font size="2"&gt;cc&lt;/font&gt;&lt;/div&gt;&lt;/td&gt;&lt;td width="100%"&gt;&lt;img width="1" \
height="1" src="cid:3__=08BBFD36DFC79BDE8f9e8a93df938@us.ibm.com" border="0" \
alt=""&gt;&lt;br&gt; &lt;font size="2"&gt;"cbananth@gmail.com" \
&lt;cbananth@gmail.com&gt;&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;

&lt;tr valign="top"&gt;&lt;td width="1%"&gt;&lt;img width="58" height="1" \
src="cid:3__=08BBFD36DFC79BDE8f9e8a93df938@us.ibm.com" border="0" alt=""&gt;&lt;br&gt; &lt;div \
align="right"&gt;&lt;font size="2"&gt;Subject&lt;/font&gt;&lt;/div&gt;&lt;/td&gt;&lt;td width="100%"&gt;&lt;img width="1" \
height="1" src="cid:3__=08BBFD36DFC79BDE8f9e8a93df938@us.ibm.com" border="0" \
alt=""&gt;&lt;br&gt; &lt;font size="2"&gt;[libvirt-users] Query regarding \
Xen_ComputerSystem&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt; &lt;/table&gt;

&lt;table border="0" cellspacing="0" cellpadding="0"&gt;
&lt;tr valign="top"&gt;&lt;td width="58"&gt;&lt;img width="1" height="1" \
src="cid:3__=08BBFD36DFC79BDE8f9e8a93df938@us.ibm.com" border="0" alt=""&gt;&lt;/td&gt;&lt;td \
width="336"&gt;&lt;img width="1" height="1" \
src="cid:3__=08BBFD36DFC79BDE8f9e8a93df938@us.ibm.com" border="0" alt=""&gt;&lt;/td&gt;&lt;/tr&gt; \
&lt;/table&gt; &lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
&lt;br&gt;
&lt;tt&gt;Hi,&lt;br&gt;
&lt;br&gt;
Libvirt provides classes such as Xen_ComputerSystem, Xen_Processor etc., in order to \
build applications using libvirt-api which can interact with the Xen Hypervisor.&lt;br&gt; \
&lt;br&gt; I would like to know what are the corresponding classes for the KVM hypervisor, \
so that I can use libvirt-cim to communicate with the hypervisor. Would it be \
Kvm_ComputerSystem or Qemu_Computersystem?&lt;br&gt; &lt;br&gt;
Any help in this regard would be of great help.&lt;br&gt;
&lt;br&gt;
Thanking you.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Regards&lt;br&gt;
Ananth&lt;br&gt;
&lt;br&gt;
_______________________________________________&lt;br&gt;
libvirt-users mailing list&lt;br&gt;
libvirt-users@redhat.com&lt;br&gt;
&lt;/tt&gt;&lt;tt&gt;&lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;/tt&gt;&lt;tt&gt;&lt;br&gt;
 &lt;/tt&gt;&lt;br&gt;
&lt;/body&gt;&lt;/html&gt;


["graycol.gif" (image/gif)]
["pic29945.gif" (image/gif)]
["ecblank.gif" (image/gif)]

</body></email><email><emailId>20100915170550</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-09-15 17:05:50-0400</timestampReceived><subject>Re: [libvirt-users] sco 5.0.5 not booting on hard disk</subject><body>

On 09/15/2010 07:32 PM, Jean Michault wrote:
&lt;snip&gt;
&gt; Why is "boot=on" preventing my VM to boot ?

This bit I'm not sure of, but suspect the answer may be in the mailing 
list archives.

Have you tried using the "Search" function in the top right hand corner 
of the libvirt.org website?

It searches the mailing list archives. :)


&gt; Is there a way to modify the .xml file for this VM to inform libvirt to
&gt; not add "boot=on" ?

The libvirt command line utility, virsh, has an "edit" command so you 
can change XML definitions manually.

For example:

   (to make the connection)
   $ virsh -c qemu+ssh://myuser@myserver/system
   Welcome to virsh, the virtualization interactive terminal.

   Type:  'help' for help with commands
          'quit' to quit

   virsh # list --all
    Id Name                 State
   ----------------------------------
     1 someguest            running

   virsh # edit someguest

   (vi launches, with the XML loaded for editing)

Does that help?

Regards and best wishes,

Justin Clift


&gt; Thanks
&gt;
&gt; Jean Michault.

</body></email><email><emailId>20100910142750</emailId><senderName>Matt Wallace</senderName><senderEmail>lists@truthisfreedom.org.uk</senderEmail><timestampReceived>2010-09-10 14:27:50-0400</timestampReceived><subject>Re: [libvirt-users] KVM guest creation - no manual interference</subject><body>

On Friday 10 Sep 2010 15:16:14 Lucas Arbiza wrote:
&gt; Hi
&gt; 
&gt; I've looking for a way to create KVM virtual machines completely automated
&gt; without the need to interact with guest operating system during
&gt; installation.
&gt; 
&gt; With ubuntu-vm-builder is possible create the guest, list packages to be
&gt; installed and scripts to be run. Is there a way to do something like it
&gt; with libvirt?
&gt; 
&gt; Thanks!

I wrote Cucumber-VHost for exactly this purpose.

We use Cucumber-VHost and puppet as well as cobbler and Hudson to completely 
automate the build and testing of our configuration files.

Cucumber-VHost creates a virtual machine based on it's definition in cobbler 
and a plain english script invoked by Rake.

More details are on my blog at http://www.threedrunkensysadsonthe.net/ and in 
GitHub: http://github.com/proffalken/cucumber-vhost

HTH,

M.

</body></email><email><emailId>20100910155120</emailId><senderName>Jon Dowland</senderName><senderEmail>jon+libvirt-users@alcopop.org</senderEmail><timestampReceived>2010-09-10 15:51:20-0400</timestampReceived><subject>Re: [libvirt-users] KVM guest creation - no manual interference</subject><body>

On Fri, Sep 10, 2010 at 11:16:14AM -0300, Lucas Arbiza wrote:
&gt; I've looking for a way to create KVM virtual machines completely automated
&gt; without the need to interact with guest operating system during
&gt; installation.
&gt; 
&gt; With ubuntu-vm-builder is possible create the guest, list packages to be
&gt; installed and scripts to be run. Is there a way to do something like it with
&gt; libvirt?

I've (just today) achieved this using virt-manager, built on top of libvirt,
for centos guests at least, defining a mirror URI for the kernel and initrd
images, and a kickstart URL, having written a kickstart script for anaconda
and stored it on a webserver ahead of time.

&lt;http://virt-manager.et.redhat.com/&gt;

virt-manager is packaged in Debian/Ubuntu too.

I haven't built any Debian/Ubuntu VMs yet, but I would basically do the same
thing but using debconf preseeding for automated Debian installations.


-- 
Jon Dowland

</body></email><email><emailId>20100910172426</emailId><senderName>Brian Roberg</senderName><senderEmail>robergb@dm.org</senderEmail><timestampReceived>2010-09-10 17:24:26-0400</timestampReceived><subject>Re: [libvirt-users] KVM guest creation - no manual interference</subject><body>

On Fri, Sep 10, 2010 at 11:51 AM, Jon Dowland
&lt;jon+libvirt-users@alcopop.org&gt; wrote:

&gt; On Fri, Sep 10, 2010 at 11:16:14AM -0300, Lucas Arbiza wrote:
&gt; &gt; I've looking for a way to create KVM virtual machines completely automated
&gt; &gt; without the need to interact with guest operating system during
&gt; &gt; installation.
&gt; &gt;
&gt; &gt; With ubuntu-vm-builder is possible create the guest, list packages to be
&gt; &gt; installed and scripts to be run. Is there a way to do something like it with
&gt; &gt; libvirt?

I experimented only briefly with vmbuilder, so I'm no expert. But if
what you're asking is how to create libvirt-managed VMs using
vmbuilder, I think this page gives you what you need to get started:

https://help.ubuntu.com/10.04/serverguide/C/jeos-and-vmbuilder.html

&gt; I haven't built any Debian/Ubuntu VMs yet, but I would basically do the same
&gt; thing but using debconf preseeding for automated Debian installations.

This is what I've done to automate installation of our Ubuntu VMs.
I've been using command-line tools rather than virt-manager, so I'm
using virt-install to create the VM. By telling virt-install where to
look for certain information, I can initiate a fully automatic Ubuntu
install.

The key arguments to virt-install are these:
  --location=http://us.archive.ubuntu.com/ubuntu/dists/lucid/main/installer-amd64/
  --extra-args="url=http://127.0.0.1/custom.seed"

The first one tells virt-install where to find the Ubuntu installer.
(You might want to use a local mirror rather than ubuntu.com for
anything more than testing.) Pointing directly to the installer rather
than at an Ubuntu CD image lets you skip the prompt that you get upon
booting the CD before launching the installer.

The "extra-args" argument is passed along to the installer, and tells
the installer where to look for the debconf preseed file. You'll need
to tune that preseed file to exactly what you want. Ubuntu has some
good docs to help with that:
https://help.ubuntu.com/10.04/installation-guide/amd64/appendix-preseed.html

--
Brian

P.S. For anyone interested, I've posted the wrapper script I've
written to encapsulate the many arguments I pass to virt-install every
time: http://robergb.pastebin.com/VkXH2DH3

And here's my preseed file: http://robergb.pastebin.com/9GvHbAyu

I welcome any suggestions for improvements.

</body></email><email><emailId>20100909220240</emailId><senderName>Brian Pitts</senderName><senderEmail>bdp@uga.edu</senderEmail><timestampReceived>2010-09-09 22:02:40-0400</timestampReceived><subject>[libvirt-users] Disabling iptables on bridge breaks port forwarding for NAT</subject><body>

Hi,

Following the directions for setting up bridged networking in the red
hat virtualization guide and libvirt wiki, I set the following kernel
parameters to 0 on a RHEL 5.5 server.

net.bridge.bridge-nf-call-ip6tables
net.bridge.bridge-nf-call-iptables
net.bridge.bridge-nf-call-arptables

Unfortunately, doing this broke the port forwarding I'd set up for VMs
on my NAT networks, e.g.

iptables -I FORWARD -d 192.168.122.2 -i eth0 -p tcp -m tcp --dport 80 -m
state --state NEW -j ACCEPT
iptables -t nat -I PREROUTING -i eth0 -p tcp -m tcp --dport 8080 -j DNAT
--to-destination 192.168.122.2:80

Before I run sysctl to change those values, nmap shows port 8080 as
open. Afterwards, nmap shows it as filtered. Using sysctl to set those
values to 1 did not undo the change, the port still showed as filtered.
I had to reboot to open the port again.

Creating an iptables rule to accept traffic on bridged devices, i.e.

iptables -I FORWARD -m physdev --physdev-is-bridged -j ACCEPT

did not not cause this problem. I am wondering if breaking the FORWARD
and PREROUTING rules I set up to do port forwarding is to be expected
when those net.bridge parameters are set to 1. If so, I think this
should be mentioned in the libvirt wiki and red hat documentation. It
can't be that uncommon for a single server to host guests with a mix of
with bridged and NAT networking.

-- 
Brian Pitts
Systems Administrator | EuPathDB Bioinformatics Resource Center
706-542-1447 | bdp@uga.edu | http://eupathdb.org

</body></email><email><emailId>20100910194621</emailId><senderName>Lucas Arbiza</senderName><senderEmail>lucas.arbiza@gmail.com</senderEmail><timestampReceived>2010-09-10 19:46:21-0400</timestampReceived><subject>Re: [libvirt-users] KVM guest creation - no manual interference</subject><body>

Thank you for the answers.

I'm reading about and studying your suggestions and I will experiment it.

After all I will post in this thread my conclusions.

More suggestions are welcome.

Thank you a lot!
__

Lucas Arbiza

email: lucas.arbiza@gmail.com
celular: +55 (55) 9152 7561

&lt;http://br.linkedin.com/in/lucasarbiza&gt;
&lt;http://www.google.com/profiles/lucas.arbiza&gt;

[Attachment #3 (text/html)]

&lt;font color="#000000"&gt;&lt;font face="verdana,sans-serif"&gt;Thank you for the \
answers.&lt;/font&gt;&lt;/font&gt;&lt;div&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;I'm reading about and studying your suggestions and I \
will experiment it.&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;

&lt;div&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;After all I will post in this thread my \
conclusions.&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;&lt;br&gt;

&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color="#000000"&gt;&lt;font face="verdana,sans-serif"&gt;More \
suggestions are welcome.&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;Thank you a lot!&lt;br clear="all"&gt;

&lt;/font&gt;&lt;/font&gt;__&lt;br&gt;&lt;br&gt;Lucas Arbiza&lt;br&gt;&lt;br&gt;email: &lt;a \
href="mailto:lucas.arbiza@gmail.com" \
target="_blank"&gt;lucas.arbiza@gmail.com&lt;/a&gt;&lt;br&gt;celular: +55 (55) 9152 7561&lt;br&gt;&lt;br&gt;&lt;a \
href="http://br.linkedin.com/in/lucasarbiza" target="_blank"&gt;&lt;img \
src="http://lucasarbiza.com/wp-content/themes/Lucas/images/linkedin-profile.png"&gt;&lt;/a&gt; \
&lt;a href="http://www.google.com/profiles/lucas.arbiza" target="_blank"&gt;&lt;img \
src="http://lucasarbiza.com/wp-content/themes/Lucas/images/Google-profile.png"&gt;&lt;/a&gt;&lt;br&gt;



&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20100915213507</emailId><senderName>sean darcy</senderName><senderEmail>seandarcy2@gmail.com</senderEmail><timestampReceived>2010-09-15 21:35:07-0400</timestampReceived><subject>[libvirt-users] Can I set up VMs in a "Flat" network?</subject><body>

Our small network is 10.10.11.0/24, gateway 10.10.11.252. dhcp is set up.

I'm using virt-manager to install VM's with kvm-qemu on an F14 host -
10.10.11.100.

qemu-kvm-0.13.0-0.6.rc1.fc14.x86_64
libvirt-0.8.3-2.fc14.x86_64

I'd like all the VM's to be on the same network as the physical
machines with an address range of 10.10.11.110-10.10.11.130.

I have virt-net set up. ifconfig on the host:

br0       Link encap:Ethernet  HWaddr 00:30:67:6A:2C:5E
          inet addr:10.10.11.100  Bcast:10.10.11.255  Mask:255.255.255.0
          inet6 addr: fe80::230:67ff:fe6a:2c5e/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:2792310 errors:0 dropped:0 overruns:0 frame:0
          TX packets:4310569 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:571898900 (545.4 MiB)  TX bytes:5394989297 (5.0 GiB)

eth0      Link encap:Ethernet  HWaddr 00:30:67:6A:2C:5E
          inet6 addr: fe80::230:67ff:fe6a:2c5e/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:2908711 errors:0 dropped:0 overruns:0 frame:0
          TX packets:4462246 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:629708224 (600.5 MiB)  TX bytes:5402914301 (5.0 GiB)
          Interrupt:44 Base address:0xe000

lo       .........................

virbr0    Link encap:Ethernet  HWaddr 00:00:00:00:00:00
          inet addr:192.168.122.1  Bcast:192.168.122.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:219830 errors:0 dropped:0 overruns:0 frame:0
          TX packets:640662 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:142081963 (135.4 MiB)  TX bytes:777889995 (741.8 MiB)


 On virt-manager I've tried a "Routed" network, but that doesn't work:

libvirtError: internal error Network 10.10.11.1/255.255.255.0 is
already in use by interface br0


Can this be done? How?

sean

</body></email><email><emailId>20100915233936</emailId><senderName>ccmail111</senderName><senderEmail>ccmail111@yahoo.com</senderEmail><timestampReceived>2010-09-15 23:39:36-0400</timestampReceived><subject>[libvirt-users] qemu and libvirtd question.</subject><body>

Hi,
 
I looked to developer guide and have couple of novice questions.
I hope this is the right forum and some can shed some light and pointers.
 
1) does virtd need to running on host ? can it run in a guest (privileged guest) ?
 
2) how does virtd (backend) interact with qemu drivers ?
 
Thanks,
 
CM


      
[Attachment #3 (text/html)]

&lt;table cellspacing="0" cellpadding="0" border="0" &gt;&lt;tr&gt;&lt;td valign="top" style="font: \
inherit;"&gt;&lt;DIV&gt;Hi,&lt;/DIV&gt; &lt;DIV&gt;&lt;/DIV&gt;
&lt;DIV&gt;I looked to developer guide and have couple of novice questions.&lt;/DIV&gt;
&lt;DIV&gt;I hope this is the right forum and some can shed some light and pointers.&lt;/DIV&gt;
&lt;DIV&gt;&lt;/DIV&gt;
&lt;DIV&gt;1) does virtd need to running on host ? can it run in a guest (privileged guest) \
?&lt;/DIV&gt; &lt;DIV&gt;&lt;/DIV&gt;
&lt;DIV&gt;2) how does virtd (backend)interact with qemu drivers ?&lt;/DIV&gt;
&lt;DIV&gt;&lt;/DIV&gt;
&lt;DIV&gt;Thanks,&lt;/DIV&gt;
&lt;DIV&gt;&lt;/DIV&gt;
&lt;DIV&gt;CM&lt;/DIV&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;br&gt;

      



</body></email><email><emailId>20100916001056</emailId><senderName>ccmail111</senderName><senderEmail>ccmail111@yahoo.com</senderEmail><timestampReceived>2010-09-16 00:10:56-0400</timestampReceived><subject>[libvirt-users] qemu driver boot up</subject><body>

Hi,
 
Looking to libvirt source code questions:
 
a) I see virt-mgr or such client invokes libvirt API which inturn connects to \
libvirtd on host. Is this right ?  Further libvirtd invokes qemu driver callbacks \
which were registered when it comes up using: qemuRegister() API. Is this right ?  
b) If (a) is true then does is mandate that (i) libvirtd daemon need to be running on \
host only ?  (ii) also libvirtd daemon need to be running before qemu (to register) ? \
  
c) what is the call sequence and boot up flow between libvirtd daemon and qemu ?
 
d) can libvirtd process run in a guest ?
 
Thanks !
 
CM.
 


      


[Attachment #3 (text/html)]

&lt;table cellspacing="0" cellpadding="0" border="0" &gt;&lt;tr&gt;&lt;td valign="top" style="font: \
inherit;"&gt;&lt;DIV&gt;Hi,&lt;/DIV&gt; &lt;DIV&gt;&lt;/DIV&gt;
&lt;DIV&gt;Looking to libvirt source code questions:&lt;/DIV&gt;
&lt;DIV&gt;&lt;/DIV&gt;
&lt;DIV&gt;a) I see virt-mgr or such client invokes libvirt API which inturn connects to \
libvirtd on host. Is this right ? Further libvirtd invokes qemu \
drivercallbacks whichwere registered when it comes up using: \
qemuRegister() API. Is this right ?&lt;/DIV&gt; &lt;DIV&gt;&lt;/DIV&gt;
&lt;DIV&gt;b) If (a) is true then does is mandate that (i) libvirtd daemon need to be \
running on host only ? (ii) also libvirtd daemon need to be running before qemu \
(to register) ?&lt;/DIV&gt; &lt;DIV&gt;&lt;/DIV&gt;
&lt;DIV&gt;c) what is the call sequence and boot upflowbetween libvirtd daemon \
andqemu ?&lt;/DIV&gt; &lt;DIV&gt;&lt;/DIV&gt;
&lt;DIV&gt;d) can libvirtd process run in a guest ?&lt;/DIV&gt;
&lt;DIV&gt;&lt;/DIV&gt;
&lt;DIV&gt;Thanks !&lt;/DIV&gt;
&lt;DIV&gt;&lt;/DIV&gt;
&lt;DIV&gt;CM.&lt;/DIV&gt;
&lt;DIV&gt;&lt;/DIV&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;br&gt;

      



</body></email><email><emailId>20100916150906</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2010-09-16 15:09:06-0400</timestampReceived><subject>Re: [libvirt-users] sco 5.0.5 not booting on hard disk</subject><body>

On Wed, Sep 15, 2010 at 11:32:07AM +0200, Jean Michault wrote:
&gt; Hello,
&gt; I am trying to run SCO unix 5.0.5 with KVM.
&gt; 
&gt; I have created the Virtual Machine with virt-manager.
&gt; The installation runs correctly, but when the virtual machine
&gt; reboots from hard disk, i obtain this message :
&gt; "FATAL: No bootable device."
&gt; 
&gt; If i run manually the virtual machine without the suboption
&gt; "boot=on" in the "-drive" option, the virtual machine boots
&gt; correctly.
&gt; 
&gt; Why is "boot=on" preventing my VM to boot ?
&gt; 
&gt; Is there a way to modify the .xml file for this VM to inform libvirt
&gt; to not add "boot=on" ?

  What version of libvirt are you using and what are the qemu-kvm
command line. I fixed something like this during the summer but
without information about your version and the actual args or XML
it's just impossible to answer correctly !

Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

</body></email><email><emailId>20100916172908</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-09-16 17:29:08-0400</timestampReceived><subject>Re: [libvirt-users] virConnectOpen question.</subject><body>

On 09/17/2010 02:48 AM, Sharad Mishra wrote:
&gt; Hi,
&gt;
&gt; 	I am using virConnectOpen(const char *uri) to connect to the local
&gt; hypervisor. When uri is set to "lxc:///", an error gets logged
&gt; in /var/log/messages about failed connection. But I do not see any error
&gt; for "xen:///". The machine does not have these drivers installed, and I am
&gt; using libvirt 0.6.3. My questions are -
&gt;
&gt; 1. Why I see error in /var/log/messages for container and not for xen?
&gt;
&gt; 2. Is there a way to avoid this error? Can I check for installed drivers
&gt; before trying to connect?

Hi Sharad,

I'm not all that knowledgeable about Xen, so can't give specifics here.

But, on the host server in question, in the /etc/libvirt/libvirtd.conf 
file there are a few logging options you can change.  (the path might be 
different on non RHEL/Fedora)

Just as a test, to see if it helps, you could change the options:

   #log_level = 3

and

   # log_outputs="3:syslog:libvirtd"

Perhaps change the log_level to something more verbose, like:

   log_level = 2

And direct all log output to a file somewhere:

   log_outputs="2:file:/var/log/libvirt/log-testing.log"

There's another option "log_filters", but you're probably best to not 
change that until you know what you want.

Suggesting the above, because it might at least point you in the right 
direction. :)

Hope that helps.

Regards and best wishes,

Justin Clift

</body></email><email><emailId>20100917050723</emailId><senderName>Ravi Pawar</senderName><senderEmail>ravifc@gmail.com</senderEmail><timestampReceived>2010-09-17 05:07:23-0400</timestampReceived><subject>[libvirt-users] Anyone knows when is the next release for libvirt java bindings?</subject><body>

-- 
Thanks &amp; Regards

Ravi Pawar

[Attachment #3 (text/html)]

&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;Thanks &amp; Regards&lt;br&gt;&lt;br&gt;Ravi Pawar&lt;br&gt;


</body></email><email><emailId>20100921073752</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-09-21 07:37:52-0400</timestampReceived><subject>Re: [libvirt-users] libvirt with multiple users</subject><body>

On 09/21/2010 01:58 PM, Zach Tibbitts wrote:
&lt;snip&gt;
&gt; At home I use libvirt with my server to manage multiple virtual machines,
&gt; but the issue I'm running into for this use case is user permissions. As far
&gt; as I've seen, anyone who has access to the server over ssh and has access to
&gt; the libvirt server via virt-manager has access to all of the virtual
&gt; machines. I'd like to find some way for each user to only see their own
&gt; virtual machine. Is this possible?

Hi Zach,

As a general direction thought, it kind of sounds like you should look
into using "sessions" for this.  Instead of connecting to the "system 
wide" version of things, like you're doing at home.

There's some info on it here:

   http://libvirt.org/uri.html#URI_qemu

But, other pages (and Google) might be more helpful there.  It's not an 
area I've personally looked at (yet), but it sounds like it might be 
what you're after.

Does that help? :)

Regards and best wishes,

Justin Clift

</body></email><email><emailId>20100921152128</emailId><senderName>"CB, Anantha Padmanabhan"</senderName><senderEmail>cbananth@hp.com</senderEmail><timestampReceived>2010-09-21 15:21:28-0400</timestampReceived><subject>Re: [libvirt-users] Query regarding Xen_ComputerSystem</subject><body>

[Attachment #2 (multipart/alternative)]


Hi,

Thanks for the immediate response. Where can I look for the classes on the =
host? Are they visible directly without access through SOAP?

Regards
Ananth

________________________________
From: Sharad Mishra [mailto:snmishra@us.ibm.com]
Sent: Tuesday, September 21, 2010 8:50 PM
To: CB, Anantha Padmanabhan
Cc: libvirt-users@redhat.com
Subject: Re: [libvirt-users] Query regarding Xen_ComputerSystem


Its KVM_ComputerSystem

Sharad Mishra
Open Virtualization
Linux Technology Center
IBM

[cid:928532015@21092010-32EC]"CB, Anantha Padmanabhan" ---09/21/2010 07:22:=
32 AM---Hi,


"CB, Anantha Padmanabhan" &lt;cbananth@hp.com&gt;
Sent by: libvirt-users-bounces@redhat.com

09/21/10 01:29 AM



To

"libvirt-users@redhat.com" &lt;libvirt-users@redhat.com&gt;

cc

"cbananth@gmail.com" &lt;cbananth@gmail.com&gt;

Subject

[libvirt-users] Query regarding Xen_ComputerSystem



Hi,

Libvirt provides classes such as Xen_ComputerSystem, Xen_Processor etc., in=
 order to build applications using libvirt-api which can interact with the =
Xen Hypervisor.

I would like to know what are the corresponding classes for the KVM hypervi=
sor, so that I can use libvirt-cim to communicate with the hypervisor. Woul=
d it be Kvm_ComputerSystem or Qemu_Computersystem?

Any help in this regard would be of great help.

Thanking you.


Regards
Ananth

_______________________________________________
libvirt-users mailing list
libvirt-users@redhat.com
https://www.redhat.com/mailman/listinfo/libvirt-users


[Attachment #5 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;
&lt;HTML&gt;&lt;HEAD&gt;
&lt;META content="text/html; charset=us-ascii" http-equiv=Content-Type&gt;
&lt;META name=GENERATOR content="MSHTML 8.00.6001.18928"&gt;&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;DIV dir=ltr align=left&gt;&lt;SPAN class=928532015-21092010&gt;&lt;FONT color=#0000ff 
size=2 face=Arial&gt;Hi,&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;
&lt;DIV dir=ltr align=left&gt;&lt;SPAN class=928532015-21092010&gt;&lt;FONT color=#0000ff 
size=2 face=Arial&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;
&lt;DIV dir=ltr align=left&gt;&lt;SPAN class=928532015-21092010&gt;&lt;FONT color=#0000ff 
size=2 face=Arial&gt;Thanks for the immediate response. Where can I look for the 
classes on the host? Are they visible directly without access through 
SOAP?&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;
&lt;DIV dir=ltr align=left&gt;&lt;SPAN class=928532015-21092010&gt;&lt;FONT color=#0000ff 
size=2 face=Arial&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;
&lt;DIV dir=ltr align=left&gt;&lt;SPAN class=928532015-21092010&gt;&lt;FONT color=#0000ff 
size=2 face=Arial&gt;Regards&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;
&lt;DIV dir=ltr align=left&gt;&lt;SPAN class=928532015-21092010&gt;&lt;FONT color=#0000ff 
size=2 face=Arial&gt;Ananth&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;&lt;BR&gt;
&lt;DIV dir=ltr lang=en-us class=OutlookMessageHeader align=left&gt;
&lt;HR tabIndex=-1&gt;
&lt;FONT size=2 face=Tahoma&gt;&lt;B&gt;From:&lt;/B&gt; Sharad Mishra [mailto:snmishra@us.ibm.com] 
&lt;BR&gt;&lt;B&gt;Sent:&lt;/B&gt; Tuesday, September 21, 2010 8:50 PM&lt;BR&gt;&lt;B&gt;To:&lt;/B&gt; CB, Anantha 
Padmanabhan&lt;BR&gt;&lt;B&gt;Cc:&lt;/B&gt; libvirt-users@redhat.com&lt;BR&gt;&lt;B&gt;Subject:&lt;/B&gt; Re: 
[libvirt-users] Query regarding Xen_ComputerSystem&lt;BR&gt;&lt;/FONT&gt;&lt;BR&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;/DIV&gt;
&lt;P&gt;Its KVM_ComputerSystem&lt;BR&gt;&lt;BR&gt;Sharad Mishra&lt;BR&gt;Open Virtualization&lt;BR&gt;Linux 
Technology Center&lt;BR&gt;IBM&lt;BR&gt;&lt;BR&gt;&lt;IMG border=0 
alt='Inactive hide details for "CB, Anantha Padmanabhan" ---09/21/2010 07:22:32 \
AM---Hi,'  src="cid:928532015@21092010-32EC" width=16 height=16&gt;&lt;FONT \
color=#424282&gt;"CB,  Anantha Padmanabhan" ---09/21/2010 07:22:32 \
AM---Hi,&lt;/FONT&gt;&lt;BR&gt;&lt;BR&gt; &lt;TABLE border=0 cellSpacing=0 cellPadding=0 width="100%"&gt;
  &lt;TBODY&gt;
  &lt;TR vAlign=top&gt;
    &lt;TD 
    style="BACKGROUND-IMAGE: url(cid:2__=08BBFD36DFC79BDE8f9e8a93df938@us.ibm.com); \
BACKGROUND-REPEAT: no-repeat"   width="40%"&gt;
      &lt;UL&gt;
        &lt;UL&gt;
          &lt;UL&gt;
            &lt;UL&gt;&lt;B&gt;&lt;FONT size=2&gt;"CB, Anantha Padmanabhan" 
              &lt;cbananth@hp.com&gt;&lt;/FONT&gt;&lt;/B&gt;&lt;FONT size=2&gt; &lt;/FONT&gt;&lt;BR&gt;&lt;FONT 
              size=2&gt;Sent by: libvirt-users-bounces@redhat.com&lt;/FONT&gt; 
              &lt;P&gt;&lt;FONT size=2&gt;09/21/10 01:29 AM&lt;/FONT&gt;&lt;/P&gt;&lt;/UL&gt;&lt;/UL&gt;&lt;/UL&gt;&lt;/UL&gt;&lt;/TD&gt;
    &lt;TD width="60%"&gt;
      &lt;TABLE border=0 cellSpacing=0 cellPadding=0 width="100%"&gt;
        &lt;TBODY&gt;
        &lt;TR vAlign=top&gt;
          &lt;TD width="1%"&gt;&lt;IMG border=0 alt="" 
            src="cid:928532015@21092010-32F3" width=58 height=1&gt;&lt;BR&gt;
            &lt;DIV align=right&gt;&lt;FONT size=2&gt;To&lt;/FONT&gt;&lt;/DIV&gt;&lt;/TD&gt;
          &lt;TD width="100%"&gt;&lt;IMG border=0 alt="" 
            src="cid:928532015@21092010-32F3" width=1 height=1&gt;&lt;BR&gt;&lt;FONT 
            size=2&gt;"libvirt-users@redhat.com" 
            &lt;libvirt-users@redhat.com&gt;&lt;/FONT&gt;&lt;/TD&gt;&lt;/TR&gt;
        &lt;TR vAlign=top&gt;
          &lt;TD width="1%"&gt;&lt;IMG border=0 alt="" 
            src="cid:928532015@21092010-32F3" width=58 height=1&gt;&lt;BR&gt;
            &lt;DIV align=right&gt;&lt;FONT size=2&gt;cc&lt;/FONT&gt;&lt;/DIV&gt;&lt;/TD&gt;
          &lt;TD width="100%"&gt;&lt;IMG border=0 alt="" 
            src="cid:928532015@21092010-32F3" width=1 height=1&gt;&lt;BR&gt;&lt;FONT 
            size=2&gt;"cbananth@gmail.com" &lt;cbananth@gmail.com&gt;&lt;/FONT&gt;&lt;/TD&gt;&lt;/TR&gt;
        &lt;TR vAlign=top&gt;
          &lt;TD width="1%"&gt;&lt;IMG border=0 alt="" 
            src="cid:928532015@21092010-32F3" width=58 height=1&gt;&lt;BR&gt;
            &lt;DIV align=right&gt;&lt;FONT size=2&gt;Subject&lt;/FONT&gt;&lt;/DIV&gt;&lt;/TD&gt;
          &lt;TD width="100%"&gt;&lt;IMG border=0 alt="" 
            src="cid:928532015@21092010-32F3" width=1 height=1&gt;&lt;BR&gt;&lt;FONT 
            size=2&gt;[libvirt-users] Query regarding 
        Xen_ComputerSystem&lt;/FONT&gt;&lt;/TD&gt;&lt;/TR&gt;&lt;/TBODY&gt;&lt;/TABLE&gt;
      &lt;TABLE border=0 cellSpacing=0 cellPadding=0&gt;
        &lt;TBODY&gt;
        &lt;TR vAlign=top&gt;
          &lt;TD width=58&gt;&lt;IMG border=0 alt="" src="cid:928532015@21092010-32F3" 
            width=1 height=1&gt;&lt;/TD&gt;
          &lt;TD width=336&gt;&lt;IMG border=0 alt="" src="cid:928532015@21092010-32F3" 
            width=1 
height=1&gt;&lt;/TD&gt;&lt;/TR&gt;&lt;/TBODY&gt;&lt;/TABLE&gt;&lt;/TD&gt;&lt;/TR&gt;&lt;/TBODY&gt;&lt;/TABLE&gt;&lt;BR&gt;&lt;TT&gt;Hi,&lt;BR&gt;&lt;BR&gt;Libvirt \
 provides classes such as Xen_ComputerSystem, Xen_Processor etc., in order to 
build applications using libvirt-api which can interact with the Xen 
Hypervisor.&lt;BR&gt;&lt;BR&gt;I would like to know what are the corresponding classes for 
the KVM hypervisor, so that I can use libvirt-cim to communicate with the 
hypervisor. Would it be Kvm_ComputerSystem or Qemu_Computersystem?&lt;BR&gt;&lt;BR&gt;Any 
help in this regard would be of great help.&lt;BR&gt;&lt;BR&gt;Thanking 
you.&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;Regards&lt;BR&gt;Ananth&lt;BR&gt;&lt;BR&gt;_______________________________________________&lt;BR&gt;libvirt-users \
 mailing list&lt;BR&gt;libvirt-users@redhat.com&lt;BR&gt;&lt;/TT&gt;&lt;TT&gt;&lt;A 
href="https://www.redhat.com/mailman/listinfo/libvirt-users"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/A&gt;&lt;/TT&gt;&lt;TT&gt;&lt;BR&gt;&lt;/TT&gt;&lt;BR&gt;&lt;/P&gt;&lt;/BODY&gt;&lt;/HTML&gt;



["graycol.gif" (image/gif)]
["ecblank.gif" (image/gif)]

</body></email><email><emailId>20100921152713</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2010-09-21 15:27:13-0400</timestampReceived><subject>Re: [libvirt-users] Is it possible to live migrate guest OS'es between different versions of kvm/qem</subject><body>

On 08/30/10 - 10:48:16AM, Nils Cant wrote:
&gt; Hi,
&gt; 
&gt; I currently have a couple of Debian KVM servers with all a different
&gt; version of kvm or qemu-kvm.
&gt; I can live migrate a guest OS from one server to the other just
&gt; fine, as long as the version of qemu-kvm is the same.
&gt; 
&gt; However, when I try to migrate a guest to a server running a newer
&gt; (or older) version of qemu-kvm, I run into problems. I think this is
&gt; because the xml configuration differs slightly between version.
&gt; 
&gt; For example, if I try to migrate from a server running qemu-kvm
&gt; 0.11.0 to one running qemu-kvm 0.12.4, I get the following error:
&gt; 
&gt; virt01:~# virsh migrate --live testserver qemu+ssh://192.168.1.7/system
&gt; error: internal error unable to reserve PCI address 0:0:3
&gt; 
&gt; When migrating from kvm 85 to qemu-kvm 0.11.0:
&gt; 
&gt; virt02:~# virsh migrate --live testserver qemu+ssh://192.168.1.2/system
&gt; error: Unknown failure
&gt; 
&gt; Migrating one from 0.12.4 to 0.11.0 just completely breaks libvirt,
&gt; forcing me to kill -9 libvirtd and the kvm instance, etc.
&gt; 
&gt; I believe this is caused in part because different versions of
&gt; qemu-kvm need different xml configurations. To run my testserver on
&gt; 0.12.4 for example, I need to delete the lines with the PCI id's,
&gt; just to be able to start it.
&gt; 
&gt; So, is there a way to make this work? Perhaps tell libvirt to not
&gt; send the config file when doing a live migrate, and use the xml in
&gt; /etc/libvirt/qemu instead somehow?

In general, no, this isn't going to work.  In the first place, you see that
libvirt detects the version of qemu/kvm that is in use, and customizes the
command-line flags for that particular version.  Qemu sometimes deprecates
options, so certain options may not exist between different versions.

Even if you were to overcome that at the libvirt level, migration between
different versions at the qemu level is also not going to work.  There are
limitations in the protocol that qemu uses to do this, and qemu upstream has
not classically been interested in migration between different versions.

-- 
Chris Lalancette

</body></email><email><emailId>20100921153410</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2010-09-21 15:34:10-0400</timestampReceived><subject>Re: [libvirt-users] XML</subject><body>

  On 09/18/2010 04:52 PM, Glynn D. Reynolds wrote:
&gt; Hi!
&gt;
&gt; I am new to libvirt.  I would like to know where would you make the
&gt; change to correct this error. I am not sure to add an entry
&gt; in /etc/libvirt/network/default.xml or not.
&gt;
&gt; Could you provide ne with a current link to the documentation that will
&gt; provide me information to correct this information.
&gt;
&gt; Glynn
&gt;
&gt;
&gt;   error : virInterfaceDefParseMtu:141 : XML description for interface mtu
&gt; value is improper is not well formed or invalid
&gt;

That error would not be encountered while parsing the XML in 
/etc/libvirt/network/default.xml - that file is parsed by the virtual 
network parser (virNetwork*) not the host interface parser 
(virInterface*), and changing it would have no effect here (note that, 
in any case, you should never edit that file, or any other file in 
/etc/libvirt directly - always go through the *-edit commands provided 
in virsh).

You are apparently attempting to define a host interface (with "virsh 
iface-define" or by calling virInterfaceDefineXML()), or possibly 
retrieve the XML for an existing host interface (with "virsh 
iface-dumpxml" or virInterfaceGetXMLDesc()). Please tell us what you are 
doing (and what the inputs are) when you encounter this error - either 
the XML you are providing to iface-define is incorrect, or the XML of 
and existing interface produced by the netcf library is incorrect.

</body></email><email><emailId>20100921154015</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2010-09-21 15:40:15-0400</timestampReceived><subject>Re: [libvirt-users] correction</subject><body>

  On 09/20/2010 02:56 PM, Glynn D. Reynolds wrote:
&gt; I have corrected the error!
&gt;
&gt;
&gt; Error:
&gt; Sep 18 13:53:46 gdrenterprise libvirtd: 13:53:46.116: error :
&gt; virInterfaceDefParseMtu:141 : XML description for interface mtu value is
&gt; improper is not well formed or invalid
&gt;
&gt; To correct this error you will have to remove or correct the entry of
&gt; virtual IP's added to /etc/sysconfig/network-scripts/ by the virtual
&gt; application.

Aha! Some questions:

1) what "virtual application" are you talking about?

2) can you provide an example of an ifcfg-* file that causes the error? 
(as well as the corrected file)

&gt; Theory!
&gt; I suspect that if you add the network interface with application that
&gt; have non root privileges or you have configured /etc/access.conf.
&gt; In additional to running selinix,  root could be the one that may have
&gt; the authority to add the network interface configuration.

What application without root privileges is able to modify the network 
configuration in /etc/sysconfig/network-scripts? Only root should be 
able to modify those files.

Beyond that, I don't understand this paragraph.

</body></email><email><emailId>20100921170913</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-09-21 17:09:13-0400</timestampReceived><subject>Re: [libvirt-users] Booting "real" windows</subject><body>

On 09/22/2010 02:15 AM, Premysl Vohnout wrote:
&gt; And is there any virtualization technology supported by libvirt which
&gt; will allow it?

Hi Premysl,

Going to point you to a previous email conversation, as I think it has
the info you're after:

   http://www.mail-archive.com/libvirt-users@redhat.com/msg00340.html

In short... it can be done, if you're persistent, and be careful about 
your activation keys.

If you have any real data on the existing windows installation, either
back it up first or don't attempt this. (it's seriously experimental!)

Does that help?

Regards and best wishes,

Justin Clift

</body></email><email><emailId>20100921193931</emailId><senderName>Jonathan Kelley</senderName><senderEmail>jkelley@vm-labs.com</senderEmail><timestampReceived>2010-09-21 19:39:31-0400</timestampReceived><subject>Re: [libvirt-users] Configuring libvirt for one driver and XMLRPC issues</subject><body>

Any idea why I wouldn't have this file on my system after building from
sources?

-Jon


On Tue, Sep 21, 2010 at 3:04 PM, Matthias Bolte &lt;
matthias.bolte@googlemail.com&gt; wrote:

&gt; 2010/9/21 Jonathan Kelley &lt;jkelley@vm-labs.com&gt;:
&gt; &gt; Hello,
&gt; &gt;
&gt; &gt; I am trying to run ./configure --with-one --with-esx but I get the
&gt; following
&gt; &gt; error:
&gt; &gt;
&gt; &gt; checking pkg-config is at least version 0.9.0... yes
&gt; &gt; checking for XMLRPC... no
&gt; &gt; configure: error: You must install XMLRPC-C &gt;= 1.14.0 to compile libvirt
&gt; ONE
&gt; &gt; driver
&gt; &gt;
&gt; &gt; However I have downloaded xmlrpc-c-client and built from sources version
&gt; &gt; 1.16.31
&gt; &gt;
&gt; &gt; root@sa251:~/libvirt-0.8.4# xmlrpc-c-config --version
&gt; &gt; 1.16.31
&gt; &gt; root@sa251:~/libvirt-0.8.4# xmlrpc-c-config --features
&gt; &gt; c++ abyss-server curl-client
&gt; &gt;
&gt; &gt;
&gt; &gt; What am I missing here?
&gt; &gt;
&gt;
&gt; libvirt's configure script doesn't use xmlrpc-c-config to detect
&gt; xmlrpc-c, it uses pkg-config:
&gt;
&gt; $ pkg-config --modversion xmlrpc_client
&gt; 1.17.7
&gt;
&gt; Maybe you need to explicitly set PKG_CONFIG_PATH to point to the the
&gt; directory that contains xmlrpc_client.pc, for example:
&gt;
&gt; PKG_CONFIG_PATH=/path/to/xmlrpc-c-dir ./configure --with-one --with-esx
&gt;
&gt; Matthias
&gt;

[Attachment #3 (text/html)]

Any idea why I wouldn't have this file on my system after building from \
sources?&lt;br&gt;&lt;br&gt;-Jon&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Tue, Sep 21, 2010 at 3:04 \
PM, Matthias Bolte &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt; &lt;blockquote class="gmail_quote" style="border-left: 1px solid rgb(204, \
204, 204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;"&gt;2010/9/21 Jonathan Kelley \
&lt;&lt;a href="mailto:jkelley@vm-labs.com"&gt;jkelley@vm-labs.com&lt;/a&gt;&gt;:&lt;br&gt;

&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;&gt; Hello,&lt;br&gt;
&gt;&lt;br&gt;
&gt; I am trying to run ./configure --with-one --with-esx but I get the following&lt;br&gt;
&gt; error:&lt;br&gt;
&gt;&lt;br&gt;
&gt; checking pkg-config is at least version 0.9.0... yes&lt;br&gt;
&gt; checking for XMLRPC... no&lt;br&gt;
&gt; configure: error: You must install XMLRPC-C &gt;= 1.14.0 to compile libvirt \
ONE&lt;br&gt; &gt; driver&lt;br&gt;
&gt;&lt;br&gt;
&gt; However I have downloaded xmlrpc-c-client and built from sources version&lt;br&gt;
&gt; 1.16.31&lt;br&gt;
&gt;&lt;br&gt;
&gt; root@sa251:~/libvirt-0.8.4# xmlrpc-c-config --version&lt;br&gt;
&gt; 1.16.31&lt;br&gt;
&gt; root@sa251:~/libvirt-0.8.4# xmlrpc-c-config --features&lt;br&gt;
&gt; c++ abyss-server curl-client&lt;br&gt;
&gt;&lt;br&gt;
&gt;&lt;br&gt;
&gt; What am I missing here?&lt;br&gt;
&gt;&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;libvirt's configure script doesn't use xmlrpc-c-config to \
detect&lt;br&gt; xmlrpc-c, it uses pkg-config:&lt;br&gt;
&lt;br&gt;
$ pkg-config --modversion xmlrpc_client&lt;br&gt;
1.17.7&lt;br&gt;
&lt;br&gt;
Maybe you need to explicitly set PKG_CONFIG_PATH to point to the the&lt;br&gt;
directory that contains xmlrpc_client.pc, for example:&lt;br&gt;
&lt;br&gt;
PKG_CONFIG_PATH=/path/to/xmlrpc-c-dir ./configure --with-one --with-esx&lt;br&gt;
&lt;font color="#888888"&gt;&lt;br&gt;
Matthias&lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20100922124016</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2010-09-22 12:40:16-0400</timestampReceived><subject>Re: [libvirt-users] libvirt and virsh-mgr on guest VM</subject><body>

On Tue, Sep 21, 2010 at 08:54:40AM -0700, ccmail111 wrote:
&gt; Hi,
&gt; 
&gt; Is it possible to run virsh-mgr (or such libvirt client tools) on guest VM for \
&gt; managing and monitoring other VMs on host ? 
&gt; Any pointers/caveats/docs is appreciated !

  if the host is available via TCP/IP from the guest, yes, just use
a remote URI pointing to the host:
   http://libvirt.org/remote.html#Remote_URI_reference

Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/


</body></email><email><emailId>20100922223958</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-09-22 22:39:58-0400</timestampReceived><subject>Re: [libvirt-users] access VMX config on esxi with virsh</subject><body>

Okay, the problem is in libvirt's VMX parser. This entry in the VMX file:

  guest.commands.sharedSecretLogin.hostd-quiescedsnap = "..."

contains a '-' in the name. The parser doesn't expect this and outputs
the error you see.

I posted a patch to the list (and CCed you) that fixes this bug and
adds a new test case based on your attached .vmx file.

Matthias

2010/9/22 frank dirks &lt;frankdirks@gmx.net&gt;:
&gt; Hi,
&gt; 
&gt; you are right - the problem is specific to only that one vmx file - for other \
&gt; virtual machines dumpxml is working, as i found out. 
&gt; i am using esxi 4.1.0 and virsh 0.8.4. the machine was created using vsphere \
&gt; client, and was cloned and renamed afterwards - maybe that was the problem ... 
&gt; regards, frank
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; &gt; 
&gt; &gt; Hm, that's strange. The .vmx config seems to be malformed.
&gt; &gt; 
&gt; &gt; What libvirt version and what ESXi version do you use?
&gt; &gt; 
&gt; &gt; How did you create the vmtest.local guest and can you start it?
&gt; &gt; 
&gt; &gt; Could you show us the original .vmx config file? You can get if by
&gt; &gt; opening https://esx1.local/folder/ in a web browser and clicking
&gt; &gt; through the directory tree until you get to vmtest.local.vmx.
&gt; &gt; 
&gt; &gt; Matthias
&gt; 
&gt; --
&gt; Neu: GMX De-Mail - Einfach wie E-Mail, sicher wie ein Brief!
&gt; Jetzt De-Mail-Adresse reservieren: http://portal.gmx.net/de/go/demail
&gt; 


</body></email><email><emailId>20100923100825</emailId><senderName>Zdenek Styblik</senderName><senderEmail>stybla@turnovfree.net</senderEmail><timestampReceived>2010-09-23 10:08:25-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt] New wiki pages with libvirt SSH setup instructions</subject><body>

Good noon,

On 09/22/2010 02:25 PM, Justin Clift wrote:
&gt; On 09/22/2010 07:33 PM, Zdenek Styblik wrote:
&gt;&gt; I was thinking about writing info for Slackware, because you've asked.
&gt;&gt; But I came to realize the page is written in such general way, it's
&gt;&gt; simply applicable to other distributions without any big troubles which
&gt;&gt; should be worth of writing up.
&gt; 
&gt; Hmmmm, how does Slackware do the access control for the libvirt
&gt; management socket?
&gt; 
&gt; Any idea if it's using PolicyKit, or if it's using groups?
&gt;

I've managed to create ACL by groups and it's working. However, to my
surprise, there is Slackware package for PolicyKit. Yet, I have never
used it nor tested it (I could though?).


&gt; Asking because if it's using one of those two, then it's extremely
&gt; easy to add a new "Slackware" head and point people to the right bit.
&gt; 

Probably both or it depends on whether PolicyKit is installed or not.
(T.B.D.?) Group ACL works for sure.

&gt; 
&gt;&gt; At least that's my opinion. Of course it
&gt;&gt; doesn't mean there can't be pitfalls in other distributions.
&gt; 
&gt; Yeah.  I'm kind of thinking that if we know how Slackware does it,
&gt; we should probably mention it.
&gt; 
&gt; That'll help people using things like (ie) Google, when they do
&gt; keyword searches for "+Libvirt +Slackware +access".  Without a mention
&gt; of Slackware on the pages, search engines won't show it in the result
&gt; list. :(
&gt; 
&gt; Plus... having more distributions on there helps to show off how
&gt; cross-distribution libvirt is. :)
&gt; 

Indeed :)

[...]
&gt;&gt; One thing though and that's access to virtual storage. Isn't there a
&gt;&gt; problem with group libvirt not having ACL to manipulate images as they
&gt;&gt; are created with root:root ownership? I'm aware of
&gt;&gt; &lt;permissions&gt;...&lt;/permissions&gt;, but so far I haven't been successful to
&gt;&gt; make it work (= ownership stayed as root:root no matter what; version
&gt;&gt; 0.8.4).
&gt; 
&gt; Hmmm, interesting thought.  It's not an area I've looked at from the
&gt; perspective of access by non-root users.
&gt; 
&gt; Yeah, I should investigate that to ensure there aren't any pitfalls there.
&gt; 
&gt; Good thinking Zdenek. :)
&gt; 

First things first. I've messed up version number - 0.8.3 (0.8.4 is
virt-manager, now at 0.8.5). So now, it's tested with libvirt-0.8.4 for
sure.

This works. Non-root user - VM management, creating images, VNC.

Now, here comes part which is hard to describe.

qemu-kvm - running as libvirt - great!
libvirtd - running as root - bad?

I wanted to achieve something like that (= root-less qemu and libvirtd)
with 0.8.3, but it didn't work because libvirt/virt-manager claimed ACL
problem. I think it's time for re-test and eventual push into
"production" of mine :)

I'm not sure if this part made sense. Simply - it works as expected.

&gt; Regards and best wishes,
&gt; 
&gt; Justin Clift

Have a nice day,
Zdenek

-- 
Zdenek Styblik
Net/Linux admin
OS TurnovFree.net
email: stybla@turnovfree.net
jabber: stybla@jabber.turnovfree.net

</body></email><email><emailId>20100923140602</emailId><senderName>Narendra Prasad Madanapalli</senderName><senderEmail>narendramind@gmail.com</senderEmail><timestampReceived>2010-09-23 14:06:02-0400</timestampReceived><subject>Re: [libvirt-users] libvirt support for sheepdog file system</subject><body>

Thanks Justin. Will go through it.

Thanks,
Narendra.

On Tue, Sep 21, 2010 at 11:30 PM, Justin Clift &lt;jclift@redhat.com&gt; wrote:
&gt; On 09/20/2010 02:57 AM, Narendra Prasad Madanapalli wrote:
&gt;&gt;
&gt;&gt; Hi Everyone,
&gt;&gt;
&gt;&gt; I am planning to extend libvirt to support sheepdog for qemu/kvm and
&gt;&gt; found that storage code is placed in src/storage. Storing files in
&gt;&gt; sheepdog is independent of file system and we just need to specify
&gt;&gt; vm-name on qemu command ine. Here are the following comands used for
&gt;&gt; creating and running a VM using qemu
&gt;&gt;
&gt;&gt; qemu-img create sheepdog:MyImage001 25G
&gt;&gt; qemu-system-x86_64 sheepdog:MyImage001
&gt;&gt;
&gt;&gt;
&gt;&gt; I would appreciate if any one provide pointers on incorporating
&gt;&gt; sheepdog functionality to libvirt.
&gt;
&gt; Hi Narendra,
&gt;
&gt; This sounds relevant, have you come across it?
&gt;
&gt;  http://www.mail-archive.com/sheepdog@lists.wpkg.org/msg00615.html
&gt;
&gt; I've only just seen it now, but it looks like it might do what you want.
&gt;
&gt; ?
&gt;
&gt; Regards and best wishes,
&gt;
&gt; Justin Clift
&gt;

</body></email><email><emailId>20100923194811</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-09-23 19:48:11-0400</timestampReceived><subject>Re: [libvirt-users] Question on CPU pinning in Python</subject><body>

On 09/22/2010 03:51 PM, Stanley, Jon [Tech] wrote:
&gt; Looking at the python API, once I have a domain object I can call domain.pinVcpu to \
&gt; pin a specific vcpu to a physical CPU. I found \
&gt; http://www.mail-archive.com/libvir-list@redhat.com/msg04562.html which mentioned \
&gt; some changes to the C API in the Python implementation, and was wondering if my \
&gt; understanding is correct. 
&gt; Say that I have a host system with 16 logical CPU's, 0-15. If I wanted to pin vcpu1 \
&gt; of a domain to CPUs 2 and 4, I would pass: 
&gt; domain.pinVcpu(1, (False, False, True, False, True, False....[and so on til I have \
&gt; 16 things])) 
&gt; In other words, pinVcpu accepts as arguments the vCPU that I wish to act on, and a \
&gt; 16 (or however many CPU's are present on the host) item tuple of True/False values, \
&gt; in the same order as the CPU's I wish to mask (for example, item 0 of the tuple \
&gt; represents CPU0), True meaning that the vCPU thread is allowed to run there, and \
&gt; False meaning that it is not. 
&gt; Just looking to confirm that my understanding of this call is correct.
&gt; 

Yes that's correct, we implement this in virt-manager/virtinst. Here's a
function for turning a libvirt cpuset= str into a tuple to pass to pinVcpu:

http://hg.fedorahosted.org/hg/python-virtinst/file/f82c5fcb966a/virtinst/Guest.py#l102


which uses

http://hg.fedorahosted.org/hg/python-virtinst/file/f82c5fcb966a/virtinst/util.py#l264

- Cole


</body></email><email><emailId>20100922195123</emailId><senderName>"Stanley, Jon [Tech]"</senderName><senderEmail>jon.stanley@gs.com</senderEmail><timestampReceived>2010-09-22 19:51:23-0400</timestampReceived><subject>[libvirt-users] Question on CPU pinning in Python</subject><body>

Looking at the python API, once I have a domain object I can call domain.pinVcpu to \
pin a specific vcpu to a physical CPU. I found \
http://www.mail-archive.com/libvir-list@redhat.com/msg04562.html which mentioned some \
changes to the C API in the Python implementation, and was wondering if my \
understanding is correct.

Say that I have a host system with 16 logical CPU's, 0-15. If I wanted to pin vcpu1 \
of a domain to CPUs 2 and 4, I would pass:

domain.pinVcpu(1, (False, False, True, False, True, False....[and so on til I have 16 \
things]))

In other words, pinVcpu accepts as arguments the vCPU that I wish to act on, and a 16 \
(or however many CPU's are present on the host) item tuple of True/False values, in \
the same order as the CPU's I wish to mask (for example, item 0 of the tuple \
represents CPU0), True meaning that the vCPU thread is allowed to run there, and \
False meaning that it is not.

Just looking to confirm that my understanding of this call is correct.

Thanks!
-Jon


</body></email><email><emailId>20100928210459</emailId><senderName>kevin gilbert</senderName><senderEmail>kmg952@bigpond.com</senderEmail><timestampReceived>2010-09-28 21:04:59-0400</timestampReceived><subject>[libvirt-users] Importing images</subject><body>

I have a dual boot machine and would love to import the Windows image into a 
VM. I've checked the documentation and Google and have not seen anything 
mentioned about this.

Is it possible?

Cheers,
Kev

</body></email><email><emailId>20100930040828</emailId><senderName>Ahmad Kamil Abdul Hamid</senderName><senderEmail>kamil@akg.t.u-tokyo.ac.jp</senderEmail><timestampReceived>2010-09-30 04:08:28-0400</timestampReceived><subject>[libvirt-users] Copy the UUID into the image file</subject><body>

Hi,

Is it possible to copy the UUID defined in the XML domain file into the
image file?

For example, the UUID defined in ubuntu.xml can appear, say, under /proc/
directory of the ubuntu virtual machine?

Thanks.

Kamil.

[Attachment #3 (text/html)]

Hi,&lt;br&gt;&lt;br&gt;Is it possible to copy the UUID defined in the XML domain file into the \
image file?&lt;br&gt;&lt;br&gt;For example, the UUID defined in ubuntu.xml can appear, say, under \
/proc/ directory of the ubuntu virtual machine?&lt;br&gt;&lt;br&gt; Thanks.&lt;br&gt;&lt;br&gt;Kamil.&lt;br&gt;



</body></email><email><emailId>20100909035909</emailId><senderName>Gandhiraj Natarajan</senderName><senderEmail>gandhiraj_gk@yahoo.co.in</senderEmail><timestampReceived>2010-09-09 03:59:09-0400</timestampReceived><subject>[libvirt-users] Remote access form windows - Java bindings</subject><body>

Hi

I am developing tool to collect information on XenServer which is on Opensuse 11. I \
am using libvirt-0.4.6.jar and and jna-3.2.4 jar files.

I tried to connect from Remote system(Windows) to server, but could not get the \
connection object.

Any configuration needs to be done for remote access ?


conn = new Connect("xen+tcp://192.168.10.22/");

it shows the exception

Exception in thread "main" java.lang.UnsatisfiedLinkError: Unable to load library
'virt': The specified module could not be found.

        at com.sun.jna.NativeLibrary.loadLibrary(NativeLibrary.java:164)
        at com.sun.jna.NativeLibrary.getInstance(NativeLibrary.java:237)
        at
 com.sun.jna.Library$Handler.&lt;init&gt;(Library.java:140)
        at com.sun.jna.Native.loadLibrary(Native.java:374)
        at com.sun.jna.Native.loadLibrary(Native.java:359)
        at org.libvirt.jna.Libvirt.&lt;clinit&gt;(Unknown Source)
        at org.libvirt.Connect.&lt;clinit&gt;(Unknown Source)
        at LibvirtCon.main(LibvirtCon.java:29)

Help me

Regards
Gandhiraj Natarajan


[Attachment #3 (text/html)]

&lt;table cellspacing="0" cellpadding="0" border="0" &gt;&lt;tr&gt;&lt;td valign="top" style="font: \
inherit;"&gt;&lt;br&gt;&lt;blockquote style="border-left: 2px solid rgb(16, 16, 255); \
margin-left: 5px; padding-left: 5px;"&gt;&lt;div id="yiv486654555"&gt;&lt;table border="0" \
cellpadding="0" cellspacing="0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td style="font-family: inherit; \
font-style: inherit; font-variant: inherit; font-weight: inherit; font-size: inherit; \
line-height: inherit; font-size-adjust: inherit; font-stretch: inherit; \
-x-system-font: none;" valign="top"&gt;Hi&lt;br&gt;&lt;br&gt;I am developing tool to collect \
information on XenServer which is on Opensuse 11. I am using libvirt-0.4.6.jar and \
and jna-3.2.4 jar files.&lt;br&gt;&lt;br&gt;I tried to connect from Remote system(Windows) to \
server, but could not get the connection object.&lt;br&gt;&lt;br&gt;Any configuration needs to be \
done for remote access ?&lt;br&gt;&lt;br&gt;&lt;br&gt;conn = new \
Connect("xen+tcp://192.168.10.22/");&lt;br&gt;&lt;br&gt;it shows the exception&lt;br&gt;&lt;br&gt;Exception \
in thread "main"  java.lang.UnsatisfiedLinkError: Unable to load library&lt;br&gt;'virt': \
The specified module could not be \
found.&lt;br&gt;&lt;br&gt; at \
com.sun.jna.NativeLibrary.loadLibrary(NativeLibrary.java:164)&lt;br&gt; \
at com.sun.jna.NativeLibrary.getInstance(NativeLibrary.java:237)&lt;br&gt; \
at  com.sun.jna.Library$Handler.&lt;init&gt;(Library.java:140)&lt;br&gt; \
at com.sun.jna.Native.loadLibrary(Native.java:374)&lt;br&gt; \
at com.sun.jna.Native.loadLibrary(Native.java:359)&lt;br&gt; \
at org.libvirt.jna.Libvirt.&lt;clinit&gt;(Unknown \
Source)&lt;br&gt; at \
org.libvirt.Connect.&lt;clinit&gt;(Unknown \
Source)&lt;br&gt; at \
LibvirtCon.main(LibvirtCon.java:29)&lt;br&gt;&lt;br&gt;Help me&lt;br&gt;&lt;br&gt;Regards&lt;br&gt;Gandhiraj \
Natarajan&lt;br&gt;&lt;br&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;br&gt;




</body></email><email><emailId>20100930110529</emailId><senderName>Andrew Cathrow</senderName><senderEmail>acathrow@redhat.com</senderEmail><timestampReceived>2010-09-30 11:05:29-0400</timestampReceived><subject>Re: [libvirt-users] Copy the UUID into the image file</subject><body>


----- Original Message -----
&gt; From: "Ahmad Kamil Abdul Hamid" &lt;kamil@akg.t.u-tokyo.ac.jp&gt;
&gt; To: libvirt-users@redhat.com
&gt; Sent: Thursday, September 30, 2010 12:08:28 AM
&gt; Subject: [libvirt-users] Copy the UUID into the image file
&gt; Hi,
&gt; 
&gt; Is it possible to copy the UUID defined in the XML domain file into
&gt; the image file?
&gt; 
&gt; For example, the UUID defined in ubuntu.xml can appear, say, under
&gt; /proc/ directory of the ubuntu virtual machine?
&gt; 

It should already be exposed in the BIOS's DMI data.
Try running dmidecode inside the guest.



&gt; Thanks.
&gt; 
&gt; Kamil.
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20100929023604</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-09-29 02:36:04-0400</timestampReceived><subject>Re: [libvirt-users] Importing images</subject><body>

On 09/29/2010 07:04 AM, kevin gilbert wrote:
&gt; I have a dual boot machine and would love to import the Windows image into a
&gt; VM. I've checked the documentation and Google and have not seen anything
&gt; mentioned about this.
&gt;
&gt; Is it possible?

Hi Kev,

Technically, as an "experimental" thing to do, it can be done, with
significant effort.  But, it may take several re-installations of
Windows to get it working, so it's probably not what you're after.

Also, it may do Bad Things to your windows activation licensing. :/

There's an email thread, showing the kind of issues involved with this,
from just a few months ago:

   https://www.redhat.com/archives/libvirt-users/2010-June/msg00000.html

Hope that helps. :)

Regards and best wishes,

Justin Clift


&gt; Cheers,
&gt; Kev

</body></email><email><emailId>20100929024153</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-09-29 02:41:53-0400</timestampReceived><subject>Re: [libvirt-users] Importing images</subject><body>

On 09/29/2010 07:04 AM, kevin gilbert wrote:
&gt; I have a dual boot machine and would love to import the Windows image into a
&gt; VM. I've checked the documentation and Google and have not seen anything
&gt; mentioned about this.

Oops.  Just realised you might be asking instead about a "1 time 
operation" to turn the Windows install into a VM, with no intention of
continuing to use it as a dual boot.

If you're purely looking to clone your windows installation, into a 
brand new VM (using new storage), than that's doable.  There's a common
term for it called "p2v", meaning "physical to virtual", which Googling
for should bring up a bunch of info and steps. :)

Either way, hope that helps. :)

Regards and best wishes,

Justin Clift


&gt; Is it possible?
&gt;
&gt; Cheers,
&gt; Kev

</body></email><email><emailId>20100924204846</emailId><senderName>Paul Oldfield</senderName><senderEmail>pgo@us.ibm.com</senderEmail><timestampReceived>2010-09-24 20:48:46-0400</timestampReceived><subject>[libvirt-users] Dormant state</subject><body>

This is a multipart message in MIME format.
--=_alternative 00724FDB862577A8_=
Content-Type: text/plain; charset="US-ASCII"

Is there an easy way to get a virtual server into the dormant state 
without waiting? 
QEMU command or libvirt cim call?

Paul Oldfield
3605 Hwy 52 North
Rochester MN, 55901
Tel: 507 253 1750
TieLine: 553-1750

--=_alternative 00724FDB862577A8_=
Content-Type: text/html; charset="US-ASCII"

&lt;font size=2 face="sans-serif"&gt;Is there an easy way to get a virtual server
into the dormant state without waiting? &lt;/font&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;QEMU command or libvirt cim call?&lt;/font&gt;
&lt;br&gt;
&lt;br&gt;&lt;font size=2 face="sans-serif"&gt;Paul Oldfield&lt;br&gt;
3605 Hwy 52 North&lt;br&gt;
Rochester MN, 55901&lt;br&gt;
Tel: 507 253 1750&lt;br&gt;
TieLine: 553-1750&lt;br&gt;
&lt;/font&gt;
--=_alternative 00724FDB862577A8_=--

</body></email><email><emailId>20100925140018</emailId><senderName>"mmv () eholod ! ru"</senderName><senderEmail>mmv@eholod.ru</senderEmail><timestampReceived>2010-09-25 14:00:18-0400</timestampReceived><subject>[libvirt-users] Unable to change guest vnc port in libvirt</subject><body>

Hi all!

I set in XML
    &lt;graphics type='vnc' port='5901'/&gt;

But Libvirt assign first free port from 5900 and take 5900. Anb block
access to host console vnc (tightvnc-server-module).

Console access need not frequently. I do
# service libvirt-guests stop;killall Xorg; service libvirt-guests start
But it dirty hack

Im use Fedora 13

# env LANG=en_US virsh version
Compiled against library: libvir 0.8.2
Using library: libvir 0.8.2
Using API: QEMU 0.8.2
Running hypervisor: QEMU 0.12.5

I prefer possiblity to define for libvirt different base port for
|autoport|. 5910 for example.

Somebody know solution?

[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
  &lt;head&gt;

    &lt;meta http-equiv="content-type" content="text/html; charset=UTF-8"&gt;
  &lt;/head&gt;
  &lt;body bgcolor="#ffffff" text="#000000"&gt;
    Hi all!&lt;br&gt;
    &lt;br&gt;
    I set in XML&lt;br&gt;
        &lt;graphics type='vnc' port='5901'/&gt;&lt;br&gt;
    &lt;br&gt;
    But Libvirt assign first free port from 5900 and take 5900. Anb
    block access to host console vnc (tightvnc-server-module).&lt;br&gt;
    &lt;br&gt;
    Console access need not frequently. I do &lt;br&gt;
    # service libvirt-guests stop;killall Xorg; service libvirt-guests
    start&lt;br&gt;
    But it dirty hack&lt;br&gt;
    &lt;br&gt;
    Im use Fedora 13 &lt;br&gt;
    &lt;br&gt;
    # env LANG=en_US virsh version&lt;br&gt;
    Compiled against library: libvir 0.8.2&lt;br&gt;
    Using library: libvir 0.8.2&lt;br&gt;
    Using API: QEMU 0.8.2&lt;br&gt;
    Running hypervisor: QEMU 0.12.5&lt;br&gt;
    &lt;br&gt;
    I prefer possiblity to define for libvirt different base port for &lt;code&gt;autoport&lt;/code&gt;.
    5910 for example.&lt;br&gt;
    &lt;br&gt;
    Somebody know solution?&lt;br&gt;
  &lt;/body&gt;
&lt;/html&gt;


</body></email><email><emailId>20100927203245</emailId><senderName>Steven Ellis</senderName><senderEmail>steven.ellis@bulletin.net</senderEmail><timestampReceived>2010-09-27 20:32:45-0400</timestampReceived><subject>[libvirt-users] Clock Sources under RHEL/Centos 5.x with KVM and libvirt</subject><body>

I'm wondering under what circumstances the kvm-clock source is exposed to a guest.

I've got a bunch of KVM servers running Centos 5.5 and some of the guests have are \
defaulting to jiffies or apic whilst some are picking up kvm-clock. These guests are \
a mix of 32bit and 64bit Centos 5.5.

Looking at the virtual machine definition file there doesn't appear to be a \
difference between the guests with kvm-clock and those without.

Any where else to look, or what configuration will expose kvm-clock to a guest.

Steve

-- 
Steven Ellis - Bulletin.Net Inc - http://www.bulletin.net


</body></email><email><emailId>20100928145551</emailId><senderName>Marcela_Castro_Len</senderName><senderEmail>mcastrol@gmail.com</senderEmail><timestampReceived>2010-09-28 14:55:51-0400</timestampReceived><subject>[libvirt-users] Question about use libvirt</subject><body>

Hello:
For a new system to develop, I need to know if I can use libvirt for to get
(listen) the information that pass trought the lan (vlan) of the each VM.
Thank you, very much.
Marcela.

[Attachment #3 (text/html)]

Hello:&lt;br&gt;For a new system to develop, I need to know if I can use libvirt for to get \
(listen) the information that pass trought the lan (vlan) of the each VM.&lt;br&gt;Thank \
you, very much.&lt;br&gt;Marcela.&lt;br&gt;



</body></email><email><emailId>20100928154448</emailId><senderName>Mitchell Hashimoto</senderName><senderEmail>mitchell.hashimoto@gmail.com</senderEmail><timestampReceived>2010-09-28 15:44:48-0400</timestampReceived><subject>[libvirt-users] Import/Export Support</subject><body>

Hello,

I'm looking into using libvirt in the near future, however an important part
of our workflow is the ability to import and export virtual machines (in
VirtualBox). Does libvirt provide an easy way to do this? I couldn't find
anything obvious on the API reference.

Thanks,
Mitchell

[Attachment #3 (text/html)]

Hello,&lt;div&gt;&lt;br&gt;I'm looking into using libvirt in the near future, howev=
er an important part of our workflow is the ability to import and export vi=
rtual machines (in VirtualBox). Does libvirt provide an easy way to do this=
? I couldn't find anything obvious on the API reference.&lt;/div&gt;

&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;Mitchell&lt;/div&gt;


</body></email><email><emailId>20100928212648</emailId><senderName>Martin_Jrgens</senderName><senderEmail>ma@jgs-wg.de</senderEmail><timestampReceived>2010-09-28 21:26:48-0400</timestampReceived><subject>[libvirt-users] network configuration for ipv6 setup</subject><body>

Hi, I am currently using IPv4 with the following network configuration 
which has worked fine for some months now:

&lt;network&gt;
   &lt;name&gt;net0&lt;/name&gt;
   &lt;uuid&gt;fa0c1c69-da82-1bef-fcb2-4c336bbexxxx&lt;/uuid&gt;
   &lt;forward dev='eth0' mode='route'/&gt;
   &lt;bridge name='virbr0' stp='on' forwardDelay='0' /&gt;
   &lt;ip address='78.47.xx.xx' netmask='255.255.255.xxx'&gt;
   &lt;/ip&gt;
&lt;/network&gt;

The company hosting my server is now providing /64-IPv6-subnets to its 
customers - thus I'd like to take advantage of this and supply my guests 
with IPv6-subnets.

Is it possible to do this without changing much of my setup (i.e. just 
changing some configuration files?)?

I am using libvirt 0.6.3.

Thanks,
Martin

</body></email><email><emailId>20100929030607</emailId><senderName>kevin gilbert</senderName><senderEmail>kmg952@bigpond.com</senderEmail><timestampReceived>2010-09-29 03:06:07-0400</timestampReceived><subject>Re: [libvirt-users] Importing images</subject><body>

Hi Justin,

Yes, p2v is what I'm looking for. I'll get Google fired up and do some reading. 
Thanks for the hint.

Cheers,
Kev

On Wed, 29 Sep 2010 12:41:53 Justin Clift opined:
&gt; On 09/29/2010 07:04 AM, kevin gilbert wrote:
&gt; &gt; I have a dual boot machine and would love to import the Windows image
&gt; &gt; into a VM. I've checked the documentation and Google and have not seen
&gt; &gt; anything mentioned about this.
&gt; 
&gt; Oops.  Just realised you might be asking instead about a "1 time
&gt; operation" to turn the Windows install into a VM, with no intention of
&gt; continuing to use it as a dual boot.
&gt; 
&gt; If you're purely looking to clone your windows installation, into a
&gt; brand new VM (using new storage), than that's doable.  There's a common
&gt; term for it called "p2v", meaning "physical to virtual", which Googling
&gt; for should bring up a bunch of info and steps. :)
&gt; 
&gt; Either way, hope that helps. :)
&gt; 
&gt; Regards and best wishes,
&gt; 
&gt; Justin Clift
&gt; 
&gt; &gt; Is it possible?
&gt; &gt; 
&gt; &gt; Cheers,
&gt; &gt; Kev

</body></email><email><emailId>20100930114449</emailId><senderName>Ahmad Kamil Abdul Hamid</senderName><senderEmail>kamil@akg.t.u-tokyo.ac.jp</senderEmail><timestampReceived>2010-09-30 11:44:49-0400</timestampReceived><subject>Re: [libvirt-users] Copy the UUID into the image file</subject><body>

Hi Andrew,

Appreciate the response.

Yes. I have checked and the UUID appears.

Thanks.

On 30 September 2010 20:05, Andrew Cathrow &lt;acathrow@redhat.com&gt; wrote:

&gt;
&gt; ----- Original Message -----
&gt; &gt; From: "Ahmad Kamil Abdul Hamid" &lt;kamil@akg.t.u-tokyo.ac.jp&gt;
&gt; &gt; To: libvirt-users@redhat.com
&gt; &gt; Sent: Thursday, September 30, 2010 12:08:28 AM
&gt; &gt; Subject: [libvirt-users] Copy the UUID into the image file
&gt; &gt; Hi,
&gt; &gt;
&gt; &gt; Is it possible to copy the UUID defined in the XML domain file into
&gt; &gt; the image file?
&gt; &gt;
&gt; &gt; For example, the UUID defined in ubuntu.xml can appear, say, under
&gt; &gt; /proc/ directory of the ubuntu virtual machine?
&gt; &gt;
&gt;
&gt; It should already be exposed in the BIOS's DMI data.
&gt; Try running dmidecode inside the guest.
&gt;
&gt;
&gt;
&gt; &gt; Thanks.
&gt; &gt;
&gt; &gt; Kamil.
&gt; &gt;
&gt; &gt; _______________________________________________
&gt; &gt; libvirt-users mailing list
&gt; &gt; libvirt-users@redhat.com
&gt; &gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

[Attachment #3 (text/html)]

Hi Andrew,&lt;br&gt;&lt;br&gt;Appreciate the response.&lt;br&gt;&lt;br&gt;Yes. I have checked and the UUID \
appears.&lt;br&gt;&lt;br&gt;Thanks.&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On 30 September 2010 20:05, \
Andrew Cathrow &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:acathrow@redhat.com"&gt;acathrow@redhat.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt; \
&lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px \
                solid rgb(204, 204, 204); padding-left: 1ex;"&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div \
                class="h5"&gt;&lt;br&gt;
----- Original Message -----&lt;br&gt;
&gt; From: "Ahmad Kamil Abdul Hamid" &lt;&lt;a \
href="mailto:kamil@akg.t.u-tokyo.ac.jp"&gt;kamil@akg.t.u-tokyo.ac.jp&lt;/a&gt;&gt;&lt;br&gt; &gt; \
To: &lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt; &gt; \
Sent: Thursday, September 30, 2010 12:08:28 AM&lt;br&gt; &gt; Subject: [libvirt-users] Copy \
the UUID into the image file&lt;br&gt; &gt; Hi,&lt;br&gt;
&gt;&lt;br&gt;
&gt; Is it possible to copy the UUID defined in the XML domain file into&lt;br&gt;
&gt; the image file?&lt;br&gt;
&gt;&lt;br&gt;
&gt; For example, the UUID defined in ubuntu.xml can appear, say, under&lt;br&gt;
&gt; /proc/ directory of the ubuntu virtual machine?&lt;br&gt;
&gt;&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;It should already be exposed in the BIOS's DMI data.&lt;br&gt;
Try running dmidecode inside the guest.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&gt; Thanks.&lt;br&gt;
&gt;&lt;br&gt;
&gt; Kamil.&lt;br&gt;
&gt;&lt;br&gt;
&gt; _______________________________________________&lt;br&gt;
&gt; libvirt-users mailing list&lt;br&gt;
&gt; &lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
&gt; &lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; \
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20100930135110</emailId><senderName>Jonathan Kelley</senderName><senderEmail>jkelley@vm-labs.com</senderEmail><timestampReceived>2010-09-30 13:51:10-0400</timestampReceived><subject>[libvirt-users] Ruby-libvirt and openAuth</subject><body>

Hello,

It looks like the Ruby bindings do not support virConnectOpenAuth. Is this
true? If so, is there any reason why? or plans to?

Thanks,
Jon

[Attachment #3 (text/html)]

Hello,&lt;br&gt;&lt;br&gt;It looks like the Ruby bindings do not support virConnectOpenAuth. Is \
this true? If so, is there any reason why? or plans \
to?&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;Jon&lt;br&gt;&lt;br&gt;&lt;code&gt;&lt;/code&gt;



</body></email><email><emailId>20100930154101</emailId><senderName>Bryan Kearney</senderName><senderEmail>bkearney@redhat.com</senderEmail><timestampReceived>2010-09-30 15:41:01-0400</timestampReceived><subject>Re: [libvirt-users] Remote access form windows - Java bindings</subject><body>

On 09/08/2010 11:59 PM, Gandhiraj Natarajan wrote:
&gt;
&gt;     Hi
&gt;
&gt;     I am developing tool to collect information on XenServer which is on
&gt;     Opensuse 11. I am using libvirt-0.4.6.jar and and jna-3.2.4 jar files.
&gt;
&gt;     I tried to connect from Remote system(Windows) to server, but could
&gt;     not get the connection object.
&gt;
&gt;     Any configuration needs to be done for remote access ?
&gt;
&gt;
&gt;     conn = new Connect("xen+tcp://192.168.10.22/");
&gt;
&gt;     it shows the exception
&gt;
&gt;     Exception in thread "main" java.lang.UnsatisfiedLinkError: Unable to
&gt;     load library
&gt;     'virt': The specified module could not be found.
&gt;
&gt;     at com.sun.jna.NativeLibrary.loadLibrary(NativeLibrary.java:164)
&gt;     at com.sun.jna.NativeLibrary.getInstance(NativeLibrary.java:237)
&gt;     at com.sun.jna.Library$Handler.&lt;init&gt;(Library.java:140)
&gt;     at com.sun.jna.Native.loadLibrary(Native.java:374)
&gt;     at com.sun.jna.Native.loadLibrary(Native.java:359)
&gt;     at org.libvirt.jna.Libvirt.&lt;clinit&gt;(Unknown Source)
&gt;     at org.libvirt.Connect.&lt;clinit&gt;(Unknown Source)
&gt;     at LibvirtCon.main(LibvirtCon.java:29)
&gt;
&gt;     Help me
&gt;
Were you able to get libvirt built on windows and put the libvirt 
library in your path per the earlier email? If so, did that fix things?

-- bk

</body></email><email><emailId>20100803180112</emailId><senderName>Ryota Ozaki</senderName><senderEmail>ozaki.ryota@gmail.com</senderEmail><timestampReceived>2010-08-03 18:01:12-0400</timestampReceived><subject>Re: [libvirt-users] libvirt and lxc</subject><body>

On Wed, Aug 4, 2010 at 2:28 AM, Nirmal Guhan &lt;vavatutu@gmail.com&gt; wrote:
&gt; On Tue, Aug 3, 2010 at 6:07 AM, Ryota Ozaki &lt;ozaki.ryota@gmail.com&gt; wrote:
&gt;&gt; Hi Nirmal,
&gt;&gt;
&gt;&gt; On Tue, Aug 3, 2010 at 10:30 AM, Nirmal Guhan &lt;vavatutu@gmail.com&gt; wrote:
&gt;&gt;&gt; Is anyone using libvirt for lxc ? I am trying to do so and running
&gt;&gt;&gt; into an issue. The system container starts fine with lxc tools and am
&gt;&gt;&gt; able to connect to it.
&gt;&gt;&gt;
&gt;&gt;&gt; Here is the snippet of my xml file (rest is same as in
&gt;&gt;&gt; http://libvirt.org/drvlxc.html)
&gt;&gt;&gt;
&gt;&gt;&gt;  &lt;devices&gt;
&gt;&gt;&gt;    &lt;emulator&gt;/usr/libexec/libvirt_lxc&lt;/emulator&gt;
&gt;&gt;&gt;    &lt;filesystem type='mount'&gt;
&gt;&gt;&gt;      &lt;source dir='/lxc/f12'/&gt;
&gt;&gt;&gt;      &lt;target dir='/'/&gt;
&gt;&gt;&gt;    &lt;/filesystem&gt;
&gt;&gt;&gt;    &lt;interface type='bridge'&gt;
&gt;&gt;&gt;      &lt;mac address='52:54:00:82:87:64'/&gt;
&gt;&gt;&gt;      &lt;source bridge='br0'/&gt;
&gt;&gt;&gt;      &lt;target dev='tap0'/&gt;
&gt;&gt;&gt;    &lt;/interface&gt;
&gt;&gt;&gt;    &lt;console type='pty'&gt;
&gt;&gt;&gt;      &lt;target port='0'/&gt;
&gt;&gt;&gt;    &lt;/console&gt;
&gt;&gt;&gt;  &lt;/devices&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Am able to start the container but when I do console :
&gt;&gt;&gt;
&gt;&gt;&gt; virsh # console f12lxc
&gt;&gt;&gt; Connected to domain f12lxc
&gt;&gt;&gt; Escape character is ^]
&gt;&gt;&gt; &lt;&lt;hangs here and I press enter, it destroys the domain&gt;&gt;
&gt;&gt;&gt; virsh #
&gt;&gt;
&gt;&gt; Probably you set:
&gt;&gt;  &lt;os&gt;
&gt;&gt;    &lt;type&gt;exe&lt;/type&gt;
&gt;&gt;    &lt;init&gt;/init&lt;/init&gt;
&gt;&gt;  &lt;/os&gt;
&gt;&gt; right? If so, could you try "/bin/sh" instead of "/init"?
&gt;
&gt; Thanks. /bin/bash got me to console. But the init sequence for my
&gt; container is different from the one started using lxc tools with
&gt; /bin/bash. So I changed it to /sbin/init and now I can get the usual
&gt; login prompt. Fun doesn't end there. Am prompted for login but the
&gt; password is never accepted whereas I can login using the same password
&gt; (as root) in the container started using lxc tools. So eventually am
&gt; not able to login :-(

AFAIK libvirt still doesn't support /sbin/init as the init program.

In my case, I write up and use a script of 'fake' init which sets up
inside a container, e.g., assigning IP addresses, launching sshd,
etc. The script eventually 'exec /bin/bash', then the shell is shown
via virsh console. That's enough for my purpose.

Note that libvirt lxc driver is a different implementation from lxc tools
and doesn't use lxc tools internally. You may not be able to do what
you are doing with lxc tools. Especially, the driver doesn't take aware
of files and settings inside a container at all. You have to prepare them
by yourself in advance.

  ozaki-r

&gt;
&gt;
&gt;&gt;
&gt;&gt;  ozaki-r
&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Am running Fedora 12 with 2.6.32.10-90.fc12.i686. I changed target
&gt;&gt;&gt; dev='tap0' to 'veth' and no change in the behavior.
&gt;&gt;&gt;
&gt;&gt;&gt; Please help.
&gt;&gt;&gt;
&gt;&gt;&gt; Thanks,
&gt;&gt;&gt; Nirmal
&gt;&gt;&gt;
&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt; libvirt-users mailing list
&gt;&gt;&gt; libvirt-users@redhat.com
&gt;&gt;&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;&gt;&gt;
&gt;&gt;
&gt;

</body></email><email><emailId>20100804082009</emailId><senderName>Stefan Hajnoczi</senderName><senderEmail>stefanha@gmail.com</senderEmail><timestampReceived>2010-08-04 08:20:09-0400</timestampReceived><subject>Re: [libvirt-users] performance with libvirt and kvm</subject><body>

On Tue, Aug 3, 2010 at 11:04 PM, Nirmal Guhan &lt;vavatutu@gmail.com&gt; wrote:
&gt; I am seeing a performance degradation while using libvirt to start my
&gt; vm (kvm). vm is fedora 12 and host is also fedora 12, both with
&gt; 2.6.32.10-90.fc12.i686. Here are the statistics from iperf :
&gt;
&gt; From VM: [  3]  0.0-30.0 sec   199 MBytes  55.7 Mbits/sec
[...]
&gt; qemu kvm : [  3]  0.0-30.0 sec   329 MBytes  91.9 Mbits/sec

Is this what you are comparing: 91.9 -&gt; 55.7 Mbits/s?

&gt; Command used : qemu-kvm vdisk.img -m 512 -net nic,model=virtio
&gt; macaddr=$macaddress -net tap,script=/etc/qemu-ifup

Have you tried to bisect the command-lines by dropping options from
the libvirt command-line until you arrive at the manual qemu-kvm
command-line?

Try using your own tap networking instead of libvirt's but otherwise
keeping libvirt's command-line as much as possible.

Can you use /var/lib/libvirt/f12.img with the manual qemu-kvm instead
of the vdisk.img file?  In general, try to compare same with same and
eliminate variables.

Stefan

</body></email><email><emailId>20100803220453</emailId><senderName>Nirmal Guhan</senderName><senderEmail>vavatutu@gmail.com</senderEmail><timestampReceived>2010-08-03 22:04:53-0400</timestampReceived><subject>[libvirt-users] performance with libvirt and kvm</subject><body>

Hi,

I am seeing a performance degradation while using libvirt to start my
vm (kvm). vm is fedora 12 and host is also fedora 12, both with
2.6.32.10-90.fc12.i686. Here are the statistics from iperf :

&gt;From VM: [  3]  0.0-30.0 sec   199 MBytes  55.7 Mbits/sec

&gt;From host : [  3]  0.0-30.0 sec   331 MBytes  92.6 Mbits/sec

libvirt command as seen from ps output :

/usr/bin/qemu-kvm -S -M pc-0.11 -enable-kvm -m 512 -smp 1 -name
f12kvm1 -uuid 9300bfe2-2b9c-d9f0-3b03-9c7fe9934393 -monitor
unix:/var/lib/libvirt/qemu/f12kvm1.monitor,server,nowait -boot c
-drive file=/var/lib/libvirt/f12.img,if=ide,bus=0,unit=0,boot=on,format=raw
-drive if=ide,media=cdrom,bus=1,unit=0,format=raw -net
nic,macaddr=52:54:00:51:7c:39,vlan=0,model=virtio,name=net0 -net
tap,fd=21,vlan=0,name=hostnet0 -serial pty -parallel none -usb -vnc
127.0.0.1:0 -k en-us -vga cirrus -balloon virtio


If I start a similar vm using qemu-kvm directly, the performance
matches with the host.
qemu kvm : [  3]  0.0-30.0 sec   329 MBytes  91.9 Mbits/sec
TCP window size is 64K for all the cases.

Command used : qemu-kvm vdisk.img -m 512 -net nic,model=virtio
macaddr=$macaddress -net tap,script=/etc/qemu-ifup

Any clues?

Thanks,
Nirmal

</body></email><email><emailId>20100809201358</emailId><senderName>jeremy avnet</senderName><senderEmail>brainsik+libvirt@saucelabs.com</senderEmail><timestampReceived>2010-08-09 20:13:58-0400</timestampReceived><subject>[libvirt-users] Sporadic network issues</subject><body>

I'm seeing this problem with both the virtio and e1000 driver with both
linux and windows guests. About 5 - 10% of the VMs I launch have network
problems. They seem to always get an IP from the DHCP server (dnsmasq), but
afterwards either they can not make an outside network connection or they
lose connectivity at a later time. Sometimes the connectivity comes back,
sometimes it doesn't. It's very sporadic and there doesn't seem to be any
rhyme or reason to it.

The network is configured like "Routed network config" described here:
http://libvirt.org/formatnetwork.html#examplesRoute

The host machines are on Ubuntu 10.04. We were using the default Lucid
packages (libvirt 0.7.5 / qemu 0.12.3), but I have upgraded us to libvirt
0.8.1 and qemu 0.12.4. I believe this has helped reduce the failure rate,
but it still persists.

Has anyone else had this problem or is there some suggestions for things to
look into?

Thank you.
.:. jeremy

[Attachment #3 (text/html)]

&lt;font class="Apple-style-span" face="verdana, sans-serif"&gt;I'm seeing this problem \
with both the virtio and e1000 driver with both linux and windows guests. About 5 - \
10% of the VMs I launch have network problems. They seem to always get an IP from the \
DHCP server (dnsmasq), but afterwards either they can not make an outside network \
connection or they lose connectivity at a later time. Sometimes the connectivity \
comes back, sometimes it doesn't. It's very sporadic and there doesn't \
seem to be any rhyme or reason to it.&lt;/font&gt;&lt;div&gt; &lt;font class="Apple-style-span" \
face="verdana, sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" \
face="verdana, sans-serif"&gt;The network is configured like "Routed network \
config" described here:&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;a \
href="http://libvirt.org/formatnetwork.html#examplesRoute"&gt;&lt;font \
class="Apple-style-span" face="verdana, \
sans-serif"&gt;http://libvirt.org/formatnetwork.html#examplesRoute&lt;/font&gt;&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
class="Apple-style-span" face="verdana, sans-serif"&gt;&lt;br&gt; &lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
class="Apple-style-span" face="verdana, sans-serif"&gt;The host machines are on Ubuntu \
10.04. We were using the default Lucid packages (libvirt 0.7.5 / qemu 0.12.3), but I \
have upgraded us to libvirt 0.8.1 and qemu 0.12.4. I believe this has helped reduce \
the failure rate, but it still persists.&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font \
class="Apple-style-span" face="verdana, sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
class="Apple-style-span" face="verdana, sans-serif"&gt;Has anyone else had this problem \
or is there some suggestions for things to look into?&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font \
class="Apple-style-span" face="verdana, sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
class="Apple-style-span" face="verdana, sans-serif"&gt;Thank you.&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
class="Apple-style-span" face="verdana, sans-serif"&gt;.:. jeremy&lt;/font&gt;&lt;/div&gt; \
&lt;div&gt;&lt;font class="Apple-style-span" face="verdana, sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;



</body></email><email><emailId>20100806041559</emailId><senderName>Tony Lewis</senderName><senderEmail>tony@lewistribe.com</senderEmail><timestampReceived>2010-08-06 04:15:59-0400</timestampReceived><subject>[libvirt-users] How to force the use of virtio as the guest network driver</subject><body>

I'm running KVM on a standard Debian Lenny host, and I seem to be 
hitting the problem identified here: 
http://serverfault.com/questions/123566/is-anyone-using-kvm-in-production

My symptom is that using rsync over SSH to transfer files into the guest 
gets slower and slower, and then grinds to a halt, and the machine 
becomes unreachable.

It seems that I should be using the virtio driver, but I can't seem to 
make it load.  The KVM guest has the virtio module, (a la find 
/lib/modules -name \*virtio\*) but when I try to force it by setting 
&lt;model type="virtio"/&gt; in the XML configuration, it seems to make no 
difference.

I see that as per http://libvirt.org/formatdomain.html , "qemu -net 
nic,model=? /dev/null" returns the following: "ne2k_isa i82551 i82557b 
i82559er ne2k_pci pcnet rtl8139", but I have no qemu-kvm binary.  Not 
sure if that's a telling symptom or not.

Host kernel is 2.6.26-2-openvz-amd64, KVM version is 72+dfsg-5~lenny5, 
libvirt version is 0.4.6-10, all of which look good enough to use virtio 
according to  http://wiki.libvirt.org/page/Virtio .

Thanks,

Tony Lewis

[Attachment #3 (text/html)]

&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
&lt;head&gt;
&lt;/head&gt;
&lt;body bgcolor="#ffffff" text="#000000"&gt;
&lt;font size="-1"&gt;&lt;font face="Verdana"&gt;I'm running KVM on a standard
Debian Lenny host, and I seem to be hitting the problem identified
here:
&lt;a class="moz-txt-link-freetext" \
href="http://serverfault.com/questions/123566/is-anyone-using-kvm-in-production"&gt;http://serverfault.com/questions/123566/is-anyone-using-kvm-in-production&lt;/a&gt;&lt;br&gt;
 &lt;br&gt;
My symptom is that using rsync over SSH to transfer files into the
guest gets slower and slower, and then grinds to a halt, and the
machine becomes unreachable.&lt;br&gt;
&lt;br&gt;
It seems that I should be using the virtio driver, but I can't seem to
make it load. The KVM guest has the virtio module, (a la find
/lib/modules -name \*virtio\*) but when I try to force it by setting
&lt;model type="virtio"/&gt; in the XML configuration, it seems to make
no difference.&lt;br&gt;
&lt;br&gt;
&lt;/font&gt;&lt;/font&gt;&lt;font size="-1"&gt;&lt;font face="Verdana"&gt;I see that as per
&lt;a class="moz-txt-link-freetext" \
href="http://libvirt.org/formatdomain.html"&gt;http://libvirt.org/formatdomain.html&lt;/a&gt; \
, "qemu -net nic,model=? /dev/null" returns the following: "ne2k_isa i82551 i82557b
i82559er ne2k_pci pcnet rtl8139", but I have no qemu-kvm binary. Not
sure if that's a telling symptom or not.&lt;br&gt;
&lt;/font&gt;&lt;/font&gt;&lt;br&gt;
&lt;font size="-1"&gt;&lt;font face="Verdana"&gt;Host kernel is
2.6.26-2-openvz-amd64, KVM version is 72+dfsg-5~lenny5, libvirt version
is 0.4.6-10, all of which look good enough to use virtio according to
&lt;a class="moz-txt-link-freetext" \
href="http://wiki.libvirt.org/page/Virtio"&gt;http://wiki.libvirt.org/page/Virtio&lt;/a&gt; \
.&lt;br&gt; &lt;br&gt;
Thanks,&lt;br&gt;
&lt;br&gt;
Tony Lewis&lt;br&gt;
&lt;/font&gt;&lt;/font&gt;
&lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20100811074028</emailId><senderName>Haidong Zhu</senderName><senderEmail>zhuhaidong98@gmail.com</senderEmail><timestampReceived>2010-08-11 07:40:28-0400</timestampReceived><subject>[libvirt-users] libvirt 0.8.3 cannot connect to remote libvirtd 0.6.3</subject><body>

It seems virsh 0.8.3 cannot connect to libvirtd 0.6.3.

Machine 1: iibvirtd is 0.6.3

Machine 2: virsh 0.6.1 

virsh -c xen+ssh://root@192.168.1.78 list
Connecting to uri: qemu:///session
 Id Name                 State
----------------------------------
  0 Domain-0             running
  1 shanxi               idle

Machine 3: virsh 0.8.3

virsh -c xen+ssh://root@192.168.1.78 list
error: server closed connection: 
error: failed to connect to the hypervisor



</body></email><email><emailId>20100814004221</emailId><senderName>Matthew Farrellee</senderName><senderEmail>matt@redhat.com</senderEmail><timestampReceived>2010-08-14 00:42:21-0400</timestampReceived><subject>[libvirt-users] cpuTimes and qemu-kvm on F13</subject><body>

http://libvirt.org/html/libvirt-libvirt.html#virDomainInfo
http://libvirt.org/html/libvirt-libvirt.html#virVcpuInfo

Both virDomainInfo and virVcpuInfo have a nanosecond cpuTime field. How 
do the two related to one another?

With some experiementing, it appears the virDomainInfo::cpuTime is equal 
to the host CPU time used by the qemu-kvm process for the domain. It 
also appears that the sum(virVcpuInfo::cpuTime) for a domain is not 
equal to the virDomainInfo::cpuTime. Is the virVcpuInfo::cpuTime how 
much host CPU time was spent simulating the vCPU? Making the difference 
between the sum and the virDomainInfo::cpuTime the overhead of qemu-kvm?

Does the relationship hold for other hypervisors?

Best,


matt

</body></email><email><emailId>20100815192105</emailId><senderName>Mike Hinz</senderName><senderEmail>mike.hinz@yr20.com</senderEmail><timestampReceived>2010-08-15 19:21:05-0400</timestampReceived><subject>[libvirt-users] F13-x86_64 - New version of qemu in raw virt repo breaks virsh and virt-manager?</subject><body>

Without actually thoroughly thinking about it, I updated my system
yesterday with the latest qemu-kvm.  rpm -qa shows

 qemu-kvm-0.13.0-0.5.20100809git25fdf4a.fc13.x86_64

See also:

virsh # version
Compiled against library: libvir 0.8.2
Using library: libvir 0.8.2
Using API: QEMU 0.8.2
Running hypervisor: QEMU 0.13.50

Now when I attempt to start a domain that was working perfectly well
prior to this update, I get the following:

virsh # start winxp1
error: Failed to start domain winxp1
error: internal error Process exited while reading console log output:
Supported machines are:
pc         Standard PC (alias of pc-0.13)
pc-0.13    Standard PC (default)
pc-0.12    Standard PC
pc-0.11    Standard PC, qemu 0.11
pc-0.10    Standard PC, qemu 0.10
isapc      ISA-only PC

Virt-Manager throws the same error when attempt to start an existing
domain.  

I'm assuming that there's now some sort of compatibility issue between
the current versions of libvirt/virt-manager and qemu-kvm?  

Is there a way to get around this and somehow use my existing domains
with this updated version of qemu-kvm?

Interestingly, just out of curiosity, I've started a new installation of
a WinXP vm.  This seems to be going perfectly well so far, so I assume
that the issue is only with domains previously created with the older
version of qemu??

Any assistance in being able to run my existing domains would be greatly
appreciated!  
-- 


Regards, 


Mike Hinz
President
YR20
1718 Fry Road
Suite 440
Houston, TX  77084
mike.hinz@yr20.com
832-225-1293 (o)
713-594-3095 (m)
832-550-2657 (f)



</body></email><email><emailId>20100812084417</emailId><senderName>"Gal Gafni"</senderName><senderEmail>gal@csl-int.com</senderEmail><timestampReceived>2010-08-12 08:44:17-0400</timestampReceived><subject>[libvirt-users] building libvirt-0.8.3 for windows ( with dlls )</subject><body>

Hi,
I'm trying to compile the latest libvirt (0.8.3 ) on windows and the
configure fails to find XDR lib.
I installed the xdr-4.0-mingw2   and configure complains the XDR library
doesn't exist.
Should I get another XDR lib?

The command I run:

$ ./configure --with-esx --without-sasl   --without-avahi
--without-polkit
--without-python   --without-xen   --without-qemu   --without-lxc
--without-o
penvz   --without-libvirtd

the last 10 lines of configure:
checking for mntent.h... no
checking net/ethernet.h usability... no
checking net/ethernet.h presence... no
checking for net/ethernet.h... no
checking linux/magic.h usability... no
checking linux/magic.h presence... no
checking for linux/magic.h... no
checking for xdrmem_create in -lportablexdr... no
checking for library containing xdrmem_create... no
configure: error: Cannot find a XDR library

is there a a guide somewhere in the list for compiling the windows
version on mingw? 

Thanks,


Gal Gafni Chen

CSL-WAVE Developer





</body></email><email><emailId>20100808161909</emailId><senderName>Martin Kraus</senderName><senderEmail>lists_mk@wujiman.net</senderEmail><timestampReceived>2010-08-08 16:19:09-0400</timestampReceived><subject>[libvirt-users] how to load different bios into qemu</subject><body>

Hello. I'm using debian squeeze with libvirt and kvm and I need to load a
newer version of seabios into qemu. I'd like to do it without overwriting
seabios in the debian package because that might be overwritten on the next
update. I hopend that the &lt;loader&gt; directive in the config would work but it
doesn't.

thanks for any ideas.

mk

</body></email><email><emailId>20100819145918</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-08-19 14:59:18-0400</timestampReceived><subject>Re: [libvirt-users] [virt-tools-list] Client certificate paths?</subject><body>

On 08/12/2010 10:29 AM, Lars Kellogg-Stedman wrote:
&gt; Hello all,
&gt; 
&gt; I'm trying to get virsh (and virt-manager) to talk to a remote libvirt
&gt; instance.  I cannot for the life of me figure out how to tell either
&gt; tool where to find client or CA certificates.  Do they *really* need
&gt; to access the ones in /etc/pki?  In particular, the client seems to
&gt; want to read the *server's* private key, which for obvious reasons is
&gt; only readable by root.
&gt; 
&gt; I feel like I must be missing something obvious...if someone can point
&gt; me towards a solution I would really appreciate it.  Thanks!
&gt; 
&gt; If it's relevant, I'm running everything under Fedora 13 right now, so
&gt; that means libvirt-0.8.2-1.fc13.x86_64 and
&gt; qemu-kvm-0.12.3-8.fc13.x86_64.
&gt; 

This is more a libvirt question, so CC-ing libvirt-users.

- Cole

</body></email><email><emailId>20100820132755</emailId><senderName>Saravanan S</senderName><senderEmail>dearsaravanan@gmail.com</senderEmail><timestampReceived>2010-08-20 13:27:55-0400</timestampReceived><subject>[libvirt-users] how to Create virtual machine</subject><body>

Hi,

I am working on a virtualization project that involves setting up virtual
appliances to implement the same, which tool is required to

1) create virtual appliances
2) deploy virtual appliances
3) manage virtual appliances/virtual machines

Could you please guide me with some pointers or resources to get started
with the creation of virtual machines?

I am little confused with libvirt with Xen and qemu.
how does xen or qemu related with libvirt ?


Thank you.


Saravanan Sundaramoorthy
Red Hat Certified Engineer
http://www.google.com/profiles/dearsaravanan#about
+91 99404 32545

[Attachment #3 (text/html)]

&lt;br&gt;&lt;div class="gmail_quote"&gt;Hi,&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;div class="im"&gt;&lt;br&gt;I am \
working on a virtualization project that involves setting up virtual appliances to \
implement the same, which tool is required to &lt;br&gt;&lt;br&gt; 1) create virtual \
appliances&lt;br&gt; 2) deploy virtual appliances&lt;br&gt;
3) manage virtual appliances/virtual machines&lt;br&gt;&lt;br&gt;Could you please guide me with \
some pointers or resources to get started with the creation of virtual \
machines?&lt;br&gt;&lt;br&gt;I am little confused with libvirt with Xen and qemu.&lt;br&gt; how does \
xen or qemu related with libvirt ?&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;Thank you.&lt;div class="im"&gt;&lt;br&gt;&lt;br \
clear="all"&gt;Saravanan Sundaramoorthy&lt;br&gt;Red Hat Certified Engineer&lt;br&gt;

&lt;a href="http://www.google.com/profiles/dearsaravanan#about" \
target="_blank"&gt;http://www.google.com/profiles/dearsaravanan#about&lt;/a&gt;&lt;br&gt;+91 99404 \
32545&lt;br&gt; &lt;/div&gt;&lt;/div&gt;&lt;br&gt;
&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20100820170034</emailId><senderName>Brian Roberg</senderName><senderEmail>robergb@dm.org</senderEmail><timestampReceived>2010-08-20 17:00:34-0400</timestampReceived><subject>[libvirt-users] Installing a VM to a virtio disk</subject><body>

When provisioning new VMs, is it possible to enable virtio for the guest's
storage at the time of the installation? When I try to do so, the Ubuntu
installer says, "No root file system is defined" when it gets to the
partitioning step.

Here's the disk option I'm giving to virt-install:

  --disk pool=libvirt-pool,size=4,bus=virtio

(I'm also using "--os-variant=ubuntulucid".)

I've been able to install a new VM using the IDE storage driver first and
then switch to virtio after the installation is complete, but it would
simplify the process if it could start with virtio right off the bat.

I'm using Ubuntu 10.04 LTS ("Lucid") host and guest, which provides libvirt
0.7.5 and kernel 2.6.32.

I'm about ready to concede defeat and set up a way to automate making the
change after the installation, but I thought I'd ask here first. Thanks!

-- 
Brian

[Attachment #3 (text/html)]

When provisioning new VMs, is it possible to enable virtio for the guest's \
storage at the time of the installation? When I try to do so, the Ubuntu installer \
says, "No root file system is defined" when it gets to the partitioning \
step.&lt;div&gt; &lt;br&gt;&lt;/div&gt;&lt;div&gt;Here's the disk option I'm giving to \
virt-install:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;    --disk \
pool=libvirt-pool,size=4,bus=virtio&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;(I'm also using \
"--os-variant=ubuntulucid".)&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I've been able \
to install a new VM using the IDE storage driver first and then switch to virtio \
after the installation is complete, but it would simplify the process if it could \
start with virtio right off the bat.&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I'm using Ubuntu \
10.04 LTS ("Lucid") host and guest, which provides libvirt 0.7.5 and kernel \
2.6.32.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I'm about ready to concede defeat and set up a \
way to automate making the change after the installation, but I thought I'd ask \
here first. Thanks!&lt;/div&gt; &lt;div&gt;&lt;br&gt;-- &lt;br&gt;Brian&lt;br&gt;&lt;br&gt;
&lt;/div&gt;



</body></email><email><emailId>20100827215109</emailId><senderName>Sharad Mishra</senderName><senderEmail>snmishra@us.ibm.com</senderEmail><timestampReceived>2010-08-27 21:51:09-0400</timestampReceived><subject>[libvirt-users] Unable to autostart storage pool.</subject><body>

Following xml file was used to create storage pool using 'virsh pool-create
&lt;xml&gt;'

&lt;pool type='dir'&gt;
  &lt;name&gt;my-diskpool&lt;/name&gt;
  &lt;uuid&gt;2fbc894e-7619-6cda-a33c-b27fae5fbe8b&lt;/uuid&gt;
  &lt;capacity&gt;136024670208&lt;/capacity&gt;
  &lt;allocation&gt;11416657920&lt;/allocation&gt;
  &lt;available&gt;124608012288&lt;/available&gt;
  &lt;source&gt;
    &lt;host name='localhost'/&gt;
  &lt;/source&gt;
  &lt;target&gt;
    &lt;path&gt;/var/lib/libvirt/images&lt;/path&gt;
    &lt;permissions&gt;
      &lt;mode&gt;0700&lt;/mode&gt;
      &lt;owner&gt;0&lt;/owner&gt;
      &lt;group&gt;0&lt;/group&gt;
    &lt;/permissions&gt;
  &lt;/target&gt;
&lt;/pool&gt;

The command succeeds and a pool is created -

# virsh pool-list --all
Name                 State      Autostart
-----------------------------------------
my-diskpool          active     no


When I try to set it up for autostart, I get -

# virsh pool-autostart my-diskpool
error: failed to mark pool my-diskpool as autostarted
error: invalid argument in pool has no config file

Why is it failing to autostart?

/etc/libvirt/storage has no xml file.

Thanks
Sharad Mishra
IBM
[Attachment #3 (text/html)]

&lt;html&gt;&lt;body&gt;
&lt;p&gt;Following xml file was used to create storage pool using 'virsh pool-create &lt;xml&gt;'&lt;br&gt;
&lt;br&gt;
&lt;pool type='dir'&gt;&lt;br&gt;
  &lt;name&gt;my-diskpool&lt;/name&gt;&lt;br&gt;
  &lt;uuid&gt;2fbc894e-7619-6cda-a33c-b27fae5fbe8b&lt;/uuid&gt;&lt;br&gt;
  &lt;capacity&gt;136024670208&lt;/capacity&gt;&lt;br&gt;
  &lt;allocation&gt;11416657920&lt;/allocation&gt;&lt;br&gt;
  &lt;available&gt;124608012288&lt;/available&gt;&lt;br&gt;
  &lt;source&gt;&lt;br&gt;
    &lt;host name='localhost'/&gt;&lt;br&gt;
  &lt;/source&gt;&lt;br&gt;
  &lt;target&gt;&lt;br&gt;
    &lt;path&gt;/var/lib/libvirt/images&lt;/path&gt;&lt;br&gt;
    &lt;permissions&gt;&lt;br&gt;
      &lt;mode&gt;0700&lt;/mode&gt;&lt;br&gt;
      &lt;owner&gt;0&lt;/owner&gt;&lt;br&gt;
      &lt;group&gt;0&lt;/group&gt;&lt;br&gt;
    &lt;/permissions&gt;&lt;br&gt;
  &lt;/target&gt;&lt;br&gt;
&lt;/pool&gt;&lt;br&gt;
&lt;br&gt;
The command succeeds and a pool is created -&lt;br&gt;
&lt;br&gt;
# virsh pool-list --all&lt;br&gt;
Name                 State      Autostart&lt;br&gt;
-----------------------------------------&lt;br&gt;
my-diskpool          active     no&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
When I try to set it up for autostart, I get -&lt;br&gt;
&lt;br&gt;
# virsh pool-autostart my-diskpool&lt;br&gt;
error: failed to mark pool my-diskpool as autostarted&lt;br&gt;
error: invalid argument in pool has no config file&lt;br&gt;
&lt;br&gt;
Why is it failing to autostart?&lt;br&gt;
&lt;br&gt;
/etc/libvirt/storage has no xml file.&lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
Sharad Mishra&lt;br&gt;
IBM&lt;/body&gt;&lt;/html&gt;

</body></email><email><emailId>20100831011228</emailId><senderName>Lucas Arbiza</senderName><senderEmail>lucas.arbiza@gmail.com</senderEmail><timestampReceived>2010-08-31 01:12:28-0400</timestampReceived><subject>[libvirt-users] C, C++ or Python programming tutorial/manual/guide for libvirt</subject><body>

Hi,

I want to develop an application to manage KVM virtual machines.

I've been looking for something that helps me to start programming using
libvirt in C/C++. The only one documentation I found is  in this link:
http://libvirt.org/html/libvirt-libvirt.html. Neither Google has helped me!

That does not look like a good way to start.

So, do you know some useful C, C++ or Python tutorial for libvirt?

I prefer C or C++.

Thanks in advance.
__

Lucas Arbiza

email: lucas.arbiza@gmail.com
celular: +55 (55) 9152 7561
skype: lucas.arbiza

&lt;http://br.linkedin.com/in/lucasarbiza&gt;
&lt;http://www.google.com/profiles/lucas.arbiza&gt;

[Attachment #3 (text/html)]

&lt;font color="#000000"&gt;&lt;font face="verdana,sans-serif"&gt;Hi,&lt;/font&gt;&lt;/font&gt;&lt;div&gt;&lt;font \
color="#000000"&gt;&lt;font face="verdana,sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
color="#000000"&gt;&lt;font face="verdana,sans-serif"&gt;I want to develop an application to \
manage KVM virtual machines.&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;

&lt;div&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;I've been looking for something that helps me to start \
programming using libvirt in C/C++. The only one documentation I found is  in this \
link: &lt;a href="http://libvirt.org/html/libvirt-libvirt.html"&gt;http://libvirt.org/html/libvirt-libvirt.html&lt;/a&gt;. \
Neither Google has helped me!&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;

&lt;div&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;That does not look like a good way to \
start.&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;&lt;br&gt;

&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color="#000000"&gt;&lt;font face="verdana,sans-serif"&gt;So, do \
you know some useful C, C++ or Python tutorial for \
libvirt?&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;&lt;br&gt;

&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color="#000000"&gt;&lt;font face="verdana,sans-serif"&gt;I \
prefer C or C++.&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color="#000000"&gt;&lt;font \
face="verdana,sans-serif"&gt;Thanks in advance.&lt;br clear="all"&gt;

&lt;/font&gt;&lt;/font&gt;__&lt;br&gt;&lt;br&gt;Lucas Arbiza&lt;br&gt;&lt;br&gt;email: &lt;a \
href="mailto:lucas.arbiza@gmail.com" \
target="_blank"&gt;lucas.arbiza@gmail.com&lt;/a&gt;&lt;br&gt;celular: +55 (55) 9152 7561&lt;br&gt;skype: \
lucas.arbiza&lt;br&gt;&lt;br&gt;&lt;a href="http://br.linkedin.com/in/lucasarbiza" \
target="_blank"&gt;&lt;img \
src="http://lucasarbiza.com/wp-content/themes/Lucas/images/linkedin-profile.png"&gt;&lt;/a&gt; \
&lt;a href="http://www.google.com/profiles/lucas.arbiza" target="_blank"&gt;&lt;img \
src="http://lucasarbiza.com/wp-content/themes/Lucas/images/Google-profile.png"&gt;&lt;/a&gt;&lt;br&gt;


&lt;br&gt;
&lt;/div&gt;



</body></email><email><emailId>20100830104643</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-08-30 10:46:43-0400</timestampReceived><subject>[libvirt-users] Decent How-To now on the wiki for setting up Transport Layer Security</subject><body>

Hi all,

For anyone that's interested in setting up TLS with libvirt, but hasn't 
gotten around to it yet, there's a decent guide on the wiki now:

   http://wiki.libvirt.org/page/TLSSetup

It's user focused (ie SysAdmin's), and has lots of pics explaining 
concepts, plus shows what needs to be done, and shows how to do it.

Please note, it doesn't cover SASL, it's just plain host based TLS.

Very much open to feedback on it, if people have suggestions for 
improvement.

Hope that helps. :)

Regards and best wishes,

Justin Clift

</body></email><email><emailId>20100830105845</emailId><senderName>Jaromr ervenka</senderName><senderEmail>cervajz@cervajz.com</senderEmail><timestampReceived>2010-08-30 10:58:45-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt] Decent How-To now on the wiki for setting up Transport Layer Security</subject><body>

Hi Justin,

it's very nice! Good work. I like those pictures :) Thank you, for this.

Greetings,

Jarom=C3=ADr =C4=8Cervenka
Official openSUSE community member
Web: http://www.cervajz.com/
Jabber: cervajz@cervajz.com
MSN: jara.cervenka@seznam.cz
Tel.: +420 607 592 687
Alt. e-mails:
jaromir.cervenka@opensuse.org,
jaromir.cervenka@speel.cz


2010/8/30 Justin Clift &lt;jclift@redhat.com&gt;

&gt; Hi all,
&gt;
&gt; For anyone that's interested in setting up TLS with libvirt, but hasn't
&gt; gotten around to it yet, there's a decent guide on the wiki now:
&gt;
&gt;  http://wiki.libvirt.org/page/TLSSetup
&gt;
&gt; It's user focused (ie SysAdmin's), and has lots of pics explaining
&gt; concepts, plus shows what needs to be done, and shows how to do it.
&gt;
&gt; Please note, it doesn't cover SASL, it's just plain host based TLS.
&gt;
&gt; Very much open to feedback on it, if people have suggestions for
&gt; improvement.
&gt;
&gt; Hope that helps. :)
&gt;
&gt; Regards and best wishes,
&gt;
&gt; Justin Clift
&gt;
&gt; --
&gt; libvir-list mailing list
&gt; libvir-list@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvir-list
&gt;

[Attachment #3 (text/html)]

Hi Justin,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;it's very nice! Good work. I like those pictures :) \
Thank you, for this.&lt;/div&gt;&lt;div&gt;&lt;br clear="all"&gt;Greetings,&lt;br&gt;&lt;br&gt;Jaromr \
ervenka&lt;br&gt;Official openSUSE community member&lt;br&gt;Web: &lt;a \
                href="http://www.cervajz.com/"&gt;http://www.cervajz.com/&lt;/a&gt;&lt;br&gt;
Jabber: &lt;a href="mailto:cervajz@cervajz.com"&gt;cervajz@cervajz.com&lt;/a&gt;&lt;br&gt;MSN: &lt;a \
href="mailto:jara.cervenka@seznam.cz"&gt;jara.cervenka@seznam.cz&lt;/a&gt;&lt;br&gt;Tel.: +420 607 \
592 687&lt;br&gt;Alt. e-mails: &lt;br&gt;&lt;a \
href="mailto:jaromir.cervenka@opensuse.org"&gt;jaromir.cervenka@opensuse.org&lt;/a&gt;,&lt;br&gt; &lt;a \
href="mailto:jaromir.cervenka@speel.cz"&gt;jaromir.cervenka@speel.cz&lt;/a&gt;&lt;br&gt; \
&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;2010/8/30 Justin Clift &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:jclift@redhat.com"&gt;jclift@redhat.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt; Hi all,&lt;br&gt;
&lt;br&gt;
For anyone that's interested in setting up TLS with libvirt, but hasn't \
gotten around to it yet, there's a decent guide on the wiki now:&lt;br&gt; &lt;br&gt;
   &lt;a href="http://wiki.libvirt.org/page/TLSSetup" \
target="_blank"&gt;http://wiki.libvirt.org/page/TLSSetup&lt;/a&gt;&lt;br&gt; &lt;br&gt;
It's user focused (ie SysAdmin's), and has lots of pics explaining concepts, \
plus shows what needs to be done, and shows how to do it.&lt;br&gt; &lt;br&gt;
Please note, it doesn't cover SASL, it's just plain host based TLS.&lt;br&gt;
&lt;br&gt;
Very much open to feedback on it, if people have suggestions for improvement.&lt;br&gt;
&lt;br&gt;
Hope that helps. :)&lt;br&gt;
&lt;br&gt;
Regards and best wishes,&lt;br&gt;
&lt;br&gt;
Justin Clift&lt;br&gt;&lt;font color="#888888"&gt;
&lt;br&gt;
--&lt;br&gt;
libvir-list mailing list&lt;br&gt;
&lt;a href="mailto:libvir-list@redhat.com" \
target="_blank"&gt;libvir-list@redhat.com&lt;/a&gt;&lt;br&gt; &lt;a \
href="https://www.redhat.com/mailman/listinfo/libvir-list" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvir-list&lt;/a&gt;&lt;br&gt; \
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20100830112210</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-08-30 11:22:10-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt] Decent How-To now on the wiki for setting up Transport Layer Security</subject><body>

On 08/30/2010 08:58 PM, Jaromr ervenka wrote:
&gt; Hi Justin,
&gt;
&gt; it's very nice! Good work. I like those pictures :) Thank you, for this.

Hi Jaromr,

You are completely welcome.  :)

If there are parts of it that need adjusting for openSUSE, please feel 
welcome to update it directly, or let me know so I can. :)

Something I've missed is information on configuring the firewall ports 
to allow incoming TLS connections for libvirt.  (tcp 16514 inbound)

That'll be fixed tomorrow (for Fedora/RHEL).

Would you be interested in adding the openSUSE bits for it?

Regards and best wishes,

Justin Clift


&gt; Greetings,
&gt;
&gt; Jaromr ervenka
&gt; Official openSUSE community member
&gt; Web: http://www.cervajz.com/
&gt; Jabber: cervajz@cervajz.com
&gt; MSN: jara.cervenka@seznam.cz
&gt; Tel.: +420 607 592 687
&gt; Alt. e-mails:
&gt; jaromir.cervenka@opensuse.org,
&gt; jaromir.cervenka@speel.cz

</body></email><email><emailId>20100820133659</emailId><senderName>Brian Roberg</senderName><senderEmail>robergb@dm.org</senderEmail><timestampReceived>2010-08-20 13:36:59-0400</timestampReceived><subject>Re: [libvirt-users] how to Create virtual machine</subject><body>

On Fri, Aug 20, 2010 at 9:15 AM, Saravanan S &lt;dearsaravanan@gmail.com&gt;wrote:

Could you please guide me with some pointers or resources to get started
&gt; with the creation of virtual machines?
&gt;
&gt; I am little confused with libvirt with Xen and qemu.
&gt; how does xen or qemu related with libvirt ?
&gt;

Libvirt is a toolkit that helps you make use of the virtualization
capabilities of hypervisors like xen and qemu/kvm.

The Ubuntu Server Guide begins its section on virtualization by talking
about libvirt, since it's through libvirt that you'll interact with your
virtualization system. I'd check that out for an introduction; the concepts
will be helpful even if you're using another distro:

https://help.ubuntu.com/10.04/serverguide/C/libvirt.html

-- 
Brian

[Attachment #3 (text/html)]

&lt;div class="gmail_quote"&gt;On Fri, Aug 20, 2010 at 9:15 AM, Saravanan S &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:dearsaravanan@gmail.com"&gt;dearsaravanan@gmail.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;/div&gt;&lt;div class="gmail_quote"&gt;&lt;br&gt;&lt;blockquote class="gmail_quote" \
style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex;"&gt; &lt;div \
class="gmail_quote"&gt;&lt;div class="gmail_quote"&gt;&lt;div&gt;Could you please guide me with some \
pointers or resources to get started with the creation of virtual machines?&lt;br&gt;&lt;br&gt;I \
am little confused with libvirt with Xen and qemu.&lt;br&gt;

how does xen or qemu related with libvirt \
?&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Libvirt is a toolkit that \
helps you make use of the virtualization capabilities of hypervisors like xen and \
qemu/kvm.&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The Ubuntu Server Guide begins its section on \
virtualization by talking about libvirt, since it's through libvirt that \
you'll interact with your virtualization system. I'd check that out for an \
introduction; the concepts will be helpful even if you're using another \
distro:&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;a \
href="https://help.ubuntu.com/10.04/serverguide/C/libvirt.html"&gt;https://help.ubuntu.com/10.04/serverguide/C/libvirt.html&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-- \
&lt;/div&gt;&lt;/div&gt;Brian&lt;br&gt;&lt;br&gt;



</body></email><email><emailId>20100811102057</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2010-08-11 10:20:57-0400</timestampReceived><subject>Re: [libvirt-users] how to load different bios into qemu</subject><body>

On Sun, Aug 08, 2010 at 06:19:09PM +0200, Martin Kraus wrote:
&gt; Hello. I'm using debian squeeze with libvirt and kvm and I need to load a
&gt; newer version of seabios into qemu. I'd like to do it without overwriting
&gt; seabios in the debian package because that might be overwritten on the next
&gt; update. I hopend that the &lt;loader&gt; directive in the config would work but it
&gt; doesn't.

  As far as I know, the BIOS used by QEmu is completely hidden from
libvirt (this can actually be a problem as some corner cases of virtio
boot support are dependant on the seabios version), so unfortunately
there is nothing which can be done at the libvirt level I think,

Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

</body></email><email><emailId>20100811111231</emailId><senderName>Martin Kraus</senderName><senderEmail>martin.kraus@wujiman.net</senderEmail><timestampReceived>2010-08-11 11:12:31-0400</timestampReceived><subject>Re: [libvirt-users] how to load different bios into qemu</subject><body>

On Wed, Aug 11, 2010 at 12:20:57PM +0200, Daniel Veillard wrote:
&gt; On Sun, Aug 08, 2010 at 06:19:09PM +0200, Martin Kraus wrote:
&gt; &gt; Hello. I'm using debian squeeze with libvirt and kvm and I need to load a
&gt; &gt; newer version of seabios into qemu. I'd like to do it without overwriting
&gt; &gt; seabios in the debian package because that might be overwritten on the next
&gt; &gt; update. I hopend that the &lt;loader&gt; directive in the config would work but it
&gt; &gt; doesn't.
&gt; 
&gt;   As far as I know, the BIOS used by QEmu is completely hidden from
&gt; libvirt (this can actually be a problem as some corner cases of virtio
&gt; boot support are dependant on the seabios version), so unfortunately
&gt; there is nothing which can be done at the libvirt level I think,

virtio and seabios are exactly the reason for my question:) I'll just copy
over the new bios, it will work fine.

thanks for help
mk

</body></email><email><emailId>20100811121708</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-08-11 12:17:08-0400</timestampReceived><subject>Re: [libvirt-users] how to load different bios into qemu</subject><body>

On Wed, Aug 11, 2010 at 12:20:57PM +0200, Daniel Veillard wrote:
&gt; On Sun, Aug 08, 2010 at 06:19:09PM +0200, Martin Kraus wrote:
&gt; &gt; Hello. I'm using debian squeeze with libvirt and kvm and I need to load a
&gt; &gt; newer version of seabios into qemu. I'd like to do it without overwriting
&gt; &gt; seabios in the debian package because that might be overwritten on the next
&gt; &gt; update. I hopend that the &lt;loader&gt; directive in the config would work but it
&gt; &gt; doesn't.
&gt; 
&gt;   As far as I know, the BIOS used by QEmu is completely hidden from
&gt; libvirt (this can actually be a problem as some corner cases of virtio
&gt; boot support are dependant on the seabios version), so unfortunately
&gt; there is nothing which can be done at the libvirt level I think,

I believe there is a command line parameter that could let libvirt point
QEMU at a different bios, but it certainly isn't part of libvirt yet,
and I've not tried how it works

Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100816163643</emailId><senderName>David Mansfield</senderName><senderEmail>libvirt@dm.cobite.com</senderEmail><timestampReceived>2010-08-16 16:36:43-0400</timestampReceived><subject>Re: [libvirt-users] how to load different bios into qemu</subject><body>

On Wed, 2010-08-11 at 13:17 +0100, Daniel P. Berrange wrote:
&gt; On Wed, Aug 11, 2010 at 12:20:57PM +0200, Daniel Veillard wrote:
&gt; &gt; On Sun, Aug 08, 2010 at 06:19:09PM +0200, Martin Kraus wrote:
&gt; &gt; &gt; Hello. I'm using debian squeeze with libvirt and kvm and I need to load a
&gt; &gt; &gt; newer version of seabios into qemu. I'd like to do it without overwriting
&gt; &gt; &gt; seabios in the debian package because that might be overwritten on the next
&gt; &gt; &gt; update. I hopend that the &lt;loader&gt; directive in the config would work but it
&gt; &gt; &gt; doesn't.
&gt; &gt; 
&gt; &gt;   As far as I know, the BIOS used by QEmu is completely hidden from
&gt; &gt; libvirt (this can actually be a problem as some corner cases of virtio
&gt; &gt; boot support are dependant on the seabios version), so unfortunately
&gt; &gt; there is nothing which can be done at the libvirt level I think,
&gt; 
&gt; I believe there is a command line parameter that could let libvirt point
&gt; QEMU at a different bios, but it certainly isn't part of libvirt yet,
&gt; and I've not tried how it works
&gt; 

You can fudge this by using a shell script as the "emulator", e.g.
 &lt;emulator&gt;/path/to/start.sh&lt;/emulator&gt;

For my use case I had the following requirements, which are working
successfully in the attached start.sh scirpt:

- supply smbios type 0 and 1 files
- supply an additional ACPI table
- use a customized rebuilt seabios bin file

For the first req. you must not allow the -uuid arg to be passed or it
won't allow the smbios to be applied

For the second, you must trim the apci header data from a binary acpi,
because that data is given in the command line option.

For the third, the path cannot be specified, so the file must be
in /usr/share/kvm directory and path must not be given.

Attached is my start.sh, you must correct the details as required for
your use case.


["start.sh" (application/x-shellscript)]

#!/bin/bash

printf "%s" "$*" | grep -q boot

if [ $? -ne 0 ]; then
    exec /usr/libexec/qemu-kvm "$@"
fi

ALLARGS=""

while [ -n "$1" ]; do
	if [ "$1" = "-uuid" ]; then
		shift
	else 
		ALLARGS="$ALLARGS $1"
	fi
	shift
done

exec /usr/libexec/qemu-kvm $ALLARGS \
    -smbios file=/path/to/smbios_0.bin \
    -smbios file=/path/to/smbios_1.bin \
    -acpitable sig=XXXX,oem_id="XXXX",oem_table_id="XXXX",oem_rev=0123456,asl_compiler_id=XXXX,asl_compiler_rev=XXX,data=/path/to/acpitable-without-header.bin.bin \
                \
    -bios bios_in_usr_share_kvm_dir.bin \
    #



</body></email><email><emailId>20100815202109</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-08-15 20:21:09-0400</timestampReceived><subject>Re: [libvirt-users] F13-x86_64 - New version of qemu in raw virt repo breaks virsh and virt-manager?</subject><body>

2010/8/15 Mike Hinz &lt;mike.hinz@yr20.com&gt;:
&gt; Without actually thoroughly thinking about it, I updated my system
&gt; yesterday with the latest qemu-kvm.  rpm -qa shows
&gt;
&gt;  qemu-kvm-0.13.0-0.5.20100809git25fdf4a.fc13.x86_64
&gt;
&gt; See also:
&gt;
&gt; virsh # version
&gt; Compiled against library: libvir 0.8.2
&gt; Using library: libvir 0.8.2
&gt; Using API: QEMU 0.8.2
&gt; Running hypervisor: QEMU 0.13.50
&gt;
&gt; Now when I attempt to start a domain that was working perfectly well
&gt; prior to this update, I get the following:
&gt;
&gt; virsh # start winxp1
&gt; error: Failed to start domain winxp1
&gt; error: internal error Process exited while reading console log output:
&gt; Supported machines are:
&gt; pc         Standard PC (alias of pc-0.13)
&gt; pc-0.13    Standard PC (default)
&gt; pc-0.12    Standard PC
&gt; pc-0.11    Standard PC, qemu 0.11
&gt; pc-0.10    Standard PC, qemu 0.10
&gt; isapc      ISA-only PC
&gt;
&gt; Virt-Manager throws the same error when attempt to start an existing
&gt; domain.
&gt;
&gt; I'm assuming that there's now some sort of compatibility issue between
&gt; the current versions of libvirt/virt-manager and qemu-kvm?

I think this is a machine type compatibility issue between your
previous and current QEMU version.

See 'virsh dumpxml winxp1' for a line like this:

&lt;os&gt;
  &lt;type arch='i686' machine='pc'&gt;hvm&lt;/type&gt;
&lt;/os&gt;

The machine attribute will probably have a value that your current
QEMU doesn't understand anymore. Therefore, it complains about the
machine type and list the ones it understands.

&gt; Is there a way to get around this and somehow use my existing domains
&gt; with this updated version of qemu-kvm?

You can try to 'virsh edit winxp1' and replace the value of the
machine attribute with something your current QEMU understands, e.g.
'pc-0.13'.

&gt; Interestingly, just out of curiosity, I've started a new installation of
&gt; a WinXP vm.  This seems to be going perfectly well so far, so I assume
&gt; that the issue is only with domains previously created with the older
&gt; version of qemu??

If you define a new guest then libvirt (actually virt-install called
from virt-manager) will pick a machine type that your current QEMU
understands. Therefore, a newly defined guest works.

Matthias

</body></email><email><emailId>20100806083957</emailId><senderName>Jan Paulini</senderName><senderEmail>jan@paulini.eu</senderEmail><timestampReceived>2010-08-06 08:39:57-0400</timestampReceived><subject>[libvirt-users] howto setup linux guest with 2 nics</subject><body>

hi,

i have the following situation. my host system is running debian lenny 
and kvm. i have 2 ethernet interfaces of which i like to use eth0 for 
administration of the server itself without traffic from any guest 
systems. eth1 is connected to a different switch where i have numerous 
vlans. i have successfully setup a guest running virt-install using a 
bridge interface on the host system. here the debian config for br1 
which i used:

auto eth1.700
iface eth1.700 inet manual

auto br1
iface br1 inet manual
         bridge_ports eth1.700
         bridge_fd 9
         bridge_hello 2
         bridge_maxage 12
         bridge_stp off

i was now looking into the xml file for the guest hoping to find a way 
to use 2 ethernet interfaces for the guest one on br1 and another on br2 
where br2 would be configures as br1 above on the host, just in a 
different vlan. how can i do that ? the network section of the xml fine 
lookes like this:

&lt;interface type='bridge'&gt;
&lt;mac address='54:52:00:xx:xx:xx'/&gt;
&lt;source bridge='br1'/&gt;
&lt;model type='virtio'/&gt;
&lt;/interface&gt;

is there possibly a way of installing a guest with virt-install to give 
the guest eth0 and eth1 which are in different vlans on the hosts eth1 ?

thanks for your help !
Jan

</body></email><email><emailId>20100809140648</emailId><senderName>Haidong Zhu</senderName><senderEmail>zhuhaidong98@gmail.com</senderEmail><timestampReceived>2010-08-09 14:06:48-0400</timestampReceived><subject>[libvirt-users] 0.8.3 make error</subject><body>

OS: Ubuntu 9.04

Error output:

  CC     libvirt_parthelper-parthelper.o
  CCLD   libvirt_parthelper
libvirt_parthelper-parthelper.o: In function `main':
/home/yoyoadm/libvirt-0.8.3/src/storage/parthelper.c:105: undefined reference to \
                `ped_device_get'
/home/yoyoadm/libvirt-0.8.3/src/storage/parthelper.c:119: undefined reference to \
                `ped_disk_new'
/home/yoyoadm/libvirt-0.8.3/src/storage/parthelper.c:125: undefined reference to \
                `ped_disk_next_partition'
collect2: ld returned 1 exit status
make[3]: *** [libvirt_parthelper] Error 1
make[3]: Leaving directory `/home/yoyoadm/libvirt-0.8.3/src'
make[2]: *** [all] Error 2
make[2]: Leaving directory `/home/yoyoadm/libvirt-0.8.3/src'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/home/yoyoadm/libvirt-0.8.3'
make: *** [all] Error 2


</body></email><email><emailId>20100809224907</emailId><senderName>jeremy avnet</senderName><senderEmail>brainsik@saucelabs.com</senderEmail><timestampReceived>2010-08-09 22:49:07-0400</timestampReceived><subject>Re: [libvirt-users] Sporadic network issues</subject><body>

On Mon, Aug 9, 2010 at 1:13 PM, jeremy avnet
&lt;brainsik+libvirt@saucelabs.com&lt;brainsik%2Blibvirt@saucelabs.com&gt;
&gt; wrote:

&gt; I'm seeing this problem with both the virtio and e1000 driver with both
&gt; linux and windows guests. About 5 - 10% of the VMs I launch have network
&gt; problems.


Interestingly, if I restrict the host machine to only ever allow one VM, the
network problems go away completely. I just launched 75 VMs (one after
another) and none of them had a problems. It's only if there are multiple
VMs. Specifically, the network problems seem to occur when another VM is
being launched. Maybe something is happening with the virtual bridge?

.:. jeremy

[Attachment #3 (text/html)]

&lt;font face="verdana,sans-serif"&gt;&lt;span class="Apple-style-span" style="font-family: \
arial; "&gt;On Mon, Aug 9, 2010 at 1:13 PM, jeremy avnet &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:brainsik%2Blibvirt@saucelabs.com"&gt;brainsik+libvirt@saucelabs.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;/span&gt;&lt;br&gt; &lt;/font&gt;&lt;div class="gmail_quote"&gt;&lt;blockquote class="gmail_quote" \
style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex;"&gt;&lt;font \
face="verdana, sans-serif"&gt;I'm seeing this problem with both the virtio and e1000 \
driver with both linux and windows guests. About 5 - 10% of the VMs I launch have \
network problems. &lt;/font&gt;&lt;/blockquote&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Interestingly, if I \
restrict the host machine to only ever allow one VM, the network problems go away \
completely. I just launched 75 VMs (one after another) and none of them had a \
problems. It's only if there are multiple VMs. Specifically, the network problems \
seem to occur when another VM is being launched. Maybe something is happening with \
the virtual bridge?&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;.:. jeremy&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20100810135456</emailId><senderName>Igor Serebryany</senderName><senderEmail>igor47@moomers.org</senderEmail><timestampReceived>2010-08-10 13:54:56-0400</timestampReceived><subject>[libvirt-users] renaming a domain?</subject><body>


Hi,=20

	I'm trying to figure out if libvirt supports a domain rename
	feature, like xen's "xm rename" command. I couldn't find anything in
	the docs suggesting such a function. Am I missing something?

Thanks!
--Igor

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20100810153643</emailId><senderName>Brian Fallik</senderName><senderEmail>bfallik@litl.com</senderEmail><timestampReceived>2010-08-10 15:36:43-0400</timestampReceived><subject>[libvirt-users] TCP reset (RST) networking issue (maybe was 'Sporadic network issues")</subject><body>

Hi,

I'm seeing a very similar problem to the thread "Sporadic networking
issues" [1].  In our setup, some TCP operations receive unexpected RST
packets when executed on the guest.  I can see these RST packets via
wireshark but can't explain their source.

We originally uncovered this when some 'git clone' operations failed
with "Broken Pipe" in the guests.  I've been able to reproduce the
same failures using scp and 'svn checkout'.  The failure occurs 80-90%
of the time and 'svn checkout' seems to be the quickest to fail.  The
same operations on the host are always successful.

My setup is a Lucid amd64 host with two guests (Lucid and Hardy, both
i386, using kvm).  Networking is configured as described in "Routed
network config".  One anomoly I notice is that our configuration is
missing the 'mode' and 'dev' attributes of the 'forward' node.  Not
sure if that makes a difference, especially since networking seems to
mostly work.

I've tried this with both virtio and e1000 drivers with no difference.

I tried Jeremy's suggestion to limit the host to start a single guest
but that did not seem to have an impact.  One thing I wonder is if I'm
resetting the libvirt correctly to make this change.  I did not reboot
the host, but I did shutdown the guests, shutdown the default network,
verified that no kvm was running and no tap/bridge devices existed,
undefined the Hardy domain, then restarted the default network and
started the Lucid kvm.  Does that sound correct?

Anyone have suggestions for further debugging or pointer(s) to
existing related bugs?  My search didn't turn up anything obvious.
I'm very eager to resolve this issue since it's blocking our ability
to use the VMs.

Thanks,
brian

1 - https://www.redhat.com/archives/libvirt-users/2010-August/msg00012.html

</body></email><email><emailId>20100811122224</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2010-08-11 12:22:24-0400</timestampReceived><subject>Re: [libvirt-users] libvirt 0.8.3 cannot connect to remote libvirtd 0.6.3</subject><body>

On 08/11/10 - 03:40:28PM, Haidong Zhu wrote:
&gt; It seems virsh 0.8.3 cannot connect to libvirtd 0.6.3.
&gt; 
&gt; Machine 1: iibvirtd is 0.6.3
&gt; 
&gt; Machine 2: virsh 0.6.1 
&gt; 
&gt; virsh -c xen+ssh://root@192.168.1.78 list
&gt; Connecting to uri: qemu:///session
&gt;  Id Name                 State
&gt; ----------------------------------
&gt;   0 Domain-0             running
&gt;   1 shanxi               idle
&gt; 
&gt; Machine 3: virsh 0.8.3
&gt; 
&gt; virsh -c xen+ssh://root@192.168.1.78 list
&gt; error: server closed connection: 
&gt; error: failed to connect to the hypervisor

I don't really remember exactly with the xen driver, but I think your URI
is wrong.  I think you need:

# virsh -c xen+ssh://root@192.168.1.78/system list

If you try that, does it work?

-- 
Chris Lalancette

</body></email><email><emailId>20100811174739</emailId><senderName>David Knierim</senderName><senderEmail>dknierim@gmail.com</senderEmail><timestampReceived>2010-08-11 17:47:39-0400</timestampReceived><subject>[libvirt-users] RHEL 6 does not support bonded and vlan tagged interfaces for KVM guests?</subject><body>

I just wrote a bugzilla report against RHEL 6 beta2
(https://bugzilla.redhat.com/show_bug.cgi?id=623199).

In it I documented that I cannot get my guests to be able to use our
standard network configuration, which is active-standby bonded
interface with tagged vlans.

The response I got was this:
 RHEL Product and Program Management 2010-08-11 11:39:02 EDT
This issue has been proposed when we are only considering blocker
issues in the current Red Hat Enterprise Linux release.

** If you would still like this issue considered for the current
release, ask your support representative to file as a blocker on
your behalf. Otherwise ask that it be considered for the next
Red Hat Enterprise Linux release. **

While I am working with Red Hat to get this included in the official
release of RHEL 6, I was hoping that I could get this working somehow.
  It appears to me that the problem is in the libvert-controlled
network connection to the guest.  Can someone give me a clue on how to
get this working?

Thanks,
   David

</body></email><email><emailId>20100811222410</emailId><senderName>Martin Kraus</senderName><senderEmail>lists_mk@wujiman.net</senderEmail><timestampReceived>2010-08-11 22:24:10-0400</timestampReceived><subject>[libvirt-users] how to make consisten backups of guests without stopping them?</subject><body>

Hello. I'd like to backup kvm guests running from lvm partitions on the host
without as little downtime as possible, preferably without stopping them. Could
libvirt help me with this? Could anybody point me to some documentation? The
question is what happens to the filesystem if I snapshot it from the host. LVM
is supposed to tell the filesystem to make itself consistent but I don't know
how that works if the filesystem is mounted inside the guest. 

thanks
mk

</body></email><email><emailId>20100813134818</emailId><senderName>Mike Ponomarenko</senderName><senderEmail>mponomarenko@gmail.com</senderEmail><timestampReceived>2010-08-13 13:48:18-0400</timestampReceived><subject>[libvirt-users] virtio and encryption</subject><body>

Greetings,

I am trying to use virtio and encryption.

My setup is:
host and guest: ubuntu 10.04 server (libvirt 0.7.5-5ubuntu27, qemu-kvm
0.12.3+noroms-0ubuntu9.2)
I have secret defined and disk in domain xml referencing that secret.

When I start using "&lt;target dev='hda' bus='ide'/&gt;" in HDD config, it works.
When I start using "&lt;target dev='vda' bus='virtio'/&gt;" I get following in syslog:

qemuMonitorCommandWithHandler:240 : cannot send monitor command
'cont': Unknown error  8446744073709551594

running with  "&lt;target dev='vda' bus='virtio'/&gt;" works fine if format
is raw and there is no encryption.

Is storing raw images on encrypted loop device the only way to have
both virtio and ecryption?

</body></email><email><emailId>20100814195456</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-08-14 19:54:56-0400</timestampReceived><subject>Re: [libvirt-users] cpuTimes and qemu-kvm on F13</subject><body>

On Fri, Aug 13, 2010 at 08:42:21PM -0400, Matthew Farrellee wrote:
&gt; http://libvirt.org/html/libvirt-libvirt.html#virDomainInfo
&gt; http://libvirt.org/html/libvirt-libvirt.html#virVcpuInfo
&gt; 
&gt; Both virDomainInfo and virVcpuInfo have a nanosecond cpuTime field. How 
&gt; do the two related to one another?
&gt; 
&gt; With some experiementing, it appears the virDomainInfo::cpuTime is equal 
&gt; to the host CPU time used by the qemu-kvm process for the domain. It 
&gt; also appears that the sum(virVcpuInfo::cpuTime) for a domain is not 
&gt; equal to the virDomainInfo::cpuTime. Is the virVcpuInfo::cpuTime how 
&gt; much host CPU time was spent simulating the vCPU? Making the difference 
&gt; between the sum and the virDomainInfo::cpuTime the overhead of qemu-kvm?

Yes, virVcpuInfo::cpuTime is the execution time for a single vCPU,
while virDomainInfo::cpuTime is execution time for the whole VM.
QEMU has other non-VCPU threads, eg I/O threads, which is where
the discrepancy you see comes in.

&gt; Does the relationship hold for other hypervisors?

Yes &amp; no. The 'whole VM' execution time is somewhat hard to actually
define &amp; report. eg QEMU with vhost enabled has a kernel thread
doing some work that we are unable to report/account under the
'whole VM' time. With Xen meanwhile the 'whole VM' time is only
really counting the time associated with the guest domain context,
not stuff running in Dom0 context on behalf of the VM - eg qemu-dm
time. IIUC, with stub domains that is resolved

Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100815205951</emailId><senderName>Mike Hinz</senderName><senderEmail>mike.hinz@yr20.com</senderEmail><timestampReceived>2010-08-15 20:59:51-0400</timestampReceived><subject>Re: [libvirt-users] F13-x86_64 - New version of qemu in raw virt repo breaks virsh and virt-manager?</subject><body>


On Sun, 2010-08-15 at 22:21 +0200, Matthias Bolte wrote:
&gt; 2010/8/15 Mike Hinz &lt;mike.hinz@yr20.com&gt;:
&gt; &gt; Without actually thoroughly thinking about it, I updated my system
&gt; &gt; yesterday with the latest qemu-kvm.  rpm -qa shows
&gt; &gt;
&gt; &gt;  qemu-kvm-0.13.0-0.5.20100809git25fdf4a.fc13.x86_64

&gt; &gt; Now when I attempt to start a domain that was working perfectly well
&gt; &gt; prior to this update, I get the following:
&gt; &gt;
&gt; &gt; virsh # start winxp1
&gt; &gt; error: Failed to start domain winxp1
&gt; &gt; error: internal error Process exited while reading console log output:
&gt; &gt; Supported machines are:
&gt; &gt; pc         Standard PC (alias of pc-0.13)
&gt; &gt; pc-0.13    Standard PC (default)
&gt; &gt; pc-0.12    Standard PC
&gt; &gt; pc-0.11    Standard PC, qemu 0.11
&gt; &gt; pc-0.10    Standard PC, qemu 0.10
&gt; &gt; isapc      ISA-only PC

&gt; 
&gt; I think this is a machine type compatibility issue between your
&gt; previous and current QEMU version.
&gt; 
&gt; See 'virsh dumpxml winxp1' for a line like this:
&gt; 
&gt; &lt;os&gt;
&gt;   &lt;type arch='i686' machine='pc'&gt;hvm&lt;/type&gt;
&gt; &lt;/os&gt;
&gt; 
&gt; The machine attribute will probably have a value that your current
&gt; QEMU doesn't understand anymore. Therefore, it complains about the
&gt; machine type and list the ones it understands.
&gt; 
&gt; &gt; Is there a way to get around this and somehow use my existing domains
&gt; &gt; with this updated version of qemu-kvm?
&gt; 
&gt; You can try to 'virsh edit winxp1' and replace the value of the
&gt; machine attribute with something your current QEMU understands, e.g.
&gt; 'pc-0.13'.
&gt; 
&gt; &gt; Interestingly, just out of curiosity, I've started a new installation of
&gt; &gt; a WinXP vm.  This seems to be going perfectly well so far, so I assume
&gt; &gt; that the issue is only with domains previously created with the older
&gt; &gt; version of qemu??
&gt; 
&gt; If you define a new guest then libvirt (actually virt-install called
&gt; from virt-manager) will pick a machine type that your current QEMU
&gt; understands. Therefore, a newly defined guest works.
&gt; 
&gt; Matthias

Matthias, thanks very much for the above.  You were exactly correct.  I
edited as you indicated:

  &lt;os&gt;
    &lt;type arch='x86_64' machine='pc-0.13'&gt;hvm&lt;/type&gt;

The original value was:  machine='fedora-13' which was apparently
causing the failure with the new qemu.  

However, this reveals another problem.  I can now startup any of my
Linux based domains with no problem at all after doing the above simple
edit.  However an existing WinXP domain is still problematic.  The
reason goes back to the irritating issue of installing a WinXP guest
somehow messing up the boot sector (at least i think that's what
happens) and as a result, you have to leave the CDROM attached and
pointing to an .iso of a WinXP installation disk.  

Now the existing WinXP domain cannot start as it gets hung during the
boot process.  I've tried configuring the guess to boot from either the
CD (.iso image) or the hard drive and both options now hang while
attempting to boot.  The WinXP guest that I just freshly created boots
fine from the hard drive, so apparently that issue is fixed with the new
qemu.  However, my question is:  Is there a way to fix the old WinXP
guest image so that it can boot?

Thanks in advance for any help on this point!

Mike. 

</body></email><email><emailId>20100816004521</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-08-16 00:45:21-0400</timestampReceived><subject>Re: [libvirt-users] building libvirt-0.8.3 for windows ( with dlls )</subject><body>

2010/8/12 Gal Gafni &lt;gal@csl-int.com&gt;:
&gt; Hi,
&gt; I'm trying to compile the latest libvirt (0.8.3 ) on windows and the
&gt; configure fails to find XDR lib.

Even without your XDR problem libvirt 0.8.3 won't compile successfully
on Windows, you'll at least need this additional patch:

  http://libvirt.org/git/?p=libvirt.git;a=commit;h=177e17e4626e18c1ce80f852e5a573ec2530db7c

So you either apply this patch manually on top of the libvirt 0.8.3
tarball (this will require autotools available, because the patch
touches configure.ac), or you build from the hourly git snapshot:

  http://libvirt.org/sources/libvirt-git-snapshot.tar.gz

&gt; I installed the xdr-4.0-mingw2   and configure complains the XDR library
&gt; doesn't exist.
&gt; Should I get another XDR lib?

I'm not sure where you got xdr-4.0-mingw2 from. I use the portablexdr lib

  http://people.redhat.com/~rjones/portablexdr/files/portablexdr-4.9.1.tar.gz

&gt; The command I run:
&gt;
&gt; $ ./configure --with-esx --without-sasl   --without-avahi
&gt; --without-polkit
&gt; --without-python   --without-xen   --without-qemu   --without-lxc
&gt; --without-o
&gt; penvz   --without-libvirtd

You also might need to run configure with additional envvars set in
order to have it pick up the libs correctly

  CFLAGS=-I/include LDFLAGS=-L/lib ./configure

Because MSYS (I assume you use MSYS) uses /include and /lib instead of
/usr/include and /usr/lib.

&gt; the last 10 lines of configure:
&gt; checking for mntent.h... no
&gt; checking net/ethernet.h usability... no
&gt; checking net/ethernet.h presence... no
&gt; checking for net/ethernet.h... no
&gt; checking linux/magic.h usability... no
&gt; checking linux/magic.h presence... no
&gt; checking for linux/magic.h... no
&gt; checking for xdrmem_create in -lportablexdr... no
&gt; checking for library containing xdrmem_create... no
&gt; configure: error: Cannot find a XDR library
&gt;
&gt; is there a a guide somewhere in the list for compiling the windows
&gt; version on mingw?
&gt;

Non I'm aware of.

A while ago I created a bunch of scripts that setup an MSYS/MinGW
environment on Windows, download and/or compile all dependencies and
finally compile libvirt.

You can find this scripts on github:

  http://github.com/photron/msys_setup

Currently the scripts build libvirt 0.8.1, they are a bit outdated by
now. I'll probably update them soon.

Matthias

</body></email><email><emailId>20100816213101</emailId><senderName>"Martin Kraus"</senderName><senderEmail>martin.kraus@wujiman.net</senderEmail><timestampReceived>2010-08-16 21:31:01-0400</timestampReceived><subject>Re: [libvirt-users] how to load different bios into qemu</subject><body>

&gt; You can fudge this by using a shell script as the "emulator", e.g.
&gt;  &lt;emulator&gt;/path/to/start.sh&lt;/emulator&gt;
&gt;
&gt; For my use case I had the following requirements, which are working
&gt; successfully in the attached start.sh scirpt:
&gt;
&gt; - supply smbios type 0 and 1 files
&gt; - supply an additional ACPI table
&gt; - use a customized rebuilt seabios bin file
&gt;
&gt; For the first req. you must not allow the -uuid arg to be passed or it
&gt; won't allow the smbios to be applied
&gt;
&gt; For the second, you must trim the apci header data from a binary acpi,
&gt; because that data is given in the command line option.
&gt;
&gt; For the third, the path cannot be specified, so the file must be
&gt; in /usr/share/kvm directory and path must not be given.

That's actually a great idea. I haven't thought about overloading the emulator directive.
thanks
mk


</body></email><email><emailId>20100819182940</emailId><senderName>Justin Clift</senderName><senderEmail>justin@salasaga.org</senderEmail><timestampReceived>2010-08-19 18:29:40-0400</timestampReceived><subject>Re: [libvirt-users] [virt-tools-list] Client certificate paths?</subject><body>

On 08/20/2010 12:59 AM, Cole Robinson wrote:
&gt; On 08/12/2010 10:29 AM, Lars Kellogg-Stedman wrote:
&gt;&gt; Hello all,
&gt;&gt;
&gt;&gt; I'm trying to get virsh (and virt-manager) to talk to a remote libvirt
&gt;&gt; instance.  I cannot for the life of me figure out how to tell either
&gt;&gt; tool where to find client or CA certificates.  Do they *really* need
&gt;&gt; to access the ones in /etc/pki?  In particular, the client seems to
&gt;&gt; want to read the *server's* private key, which for obvious reasons is
&gt;&gt; only readable by root.
&gt;&gt;
&gt;&gt; I feel like I must be missing something obvious...if someone can point
&gt;&gt; me towards a solution I would really appreciate it.  Thanks!

Hi Lars,

There wasn't a mention a which type of certificates you're trying to
use, so I'll assume TLS, as that's what /etc/pki is for.

virsh
*****

With virsh, it is hard coded to use a server wide path for its client
certificate.  (found this out yesterday)  It's been mentioned
there's an RFE for having that configurable, but it's not something I've
looked into.

   $ ls -la /etc/pki/libvirt/clientcert.pem 
/etc/pki/libvirt/private/clientkey.pem
   -rw-r--r-- 1 root root 1220 Aug 19 02:34 /etc/pki/libvirt/clientcert.pem
   -rw-r--r-- 1 root root 1675 Aug 19 02:32 
/etc/pki/libvirt/private/clientkey.pem
   $

It also needs the CA Certificate (not the key) here:

   /etc/pki/CA/cacert.pem

   $ sudo ls -la /etc/pki/CA/cacert.pem
   -rw-r--r-- 1 root root 1070 Aug 19 01:06 /etc/pki/CA/cacert.pem
   $

Real life example of it working
*******************************

   $ virsh -c qemu://host1/system
   Welcome to virsh, the virtualization interactive terminal.

   Type:  'help' for help with commands
          'quit' to quit

   virsh #

(the qemu:// bit works there without saying qemu+tls://, because TLS
is the default)


virt-manager
************

virt-manager though, uses the client certificate in a different spot.
It has them per user, and they're stored in:

   ~/.pki/libvirt-vnc/clientcert.pem
   ~/.pki/libvirt-vnc/private/clientkey.pem

It needs the CA Certificate in:

   ~/.pki/CA/ca-cert.pem

   $ ls -la ~/.pki/libvirt-vnc/clientcert.pem 
~/.pki/libvirt-vnc/private/clientkey.pem ~/.pki/CA/ca-cert.pem

   $ ls -la ~/.pki/libvirt-vnc/clientcert.pem 
~/.pki/libvirt-vnc/private/clientkey.pem ~/.pki/CA/ca-cert.pem
   -rw-r--r-- 1 jc jc 1070 Aug 19 20:48 
/export/backend/home/jc/.pki/CA/ca-cert.pem
   -rw-r--r-- 1 jc jc 1220 Aug 19 20:48 
/export/backend/home/jc/.pki/libvirt-vnc/clientcert.pem
   lrwxrwxrwx 1 jc jc   16 Aug 19 21:14 
/export/backend/home/jc/.pki/libvirt-vnc/private/clientkey.pem -&gt; 
../clientkey.pem
   $

You'll be able to see that pointing to the keys in my home dir. 
Something you'll notice is that in this instance, my clientkey.pem is 
itself NOT in the "private" sub-dir.  It's in a folder below that, with 
a link in the private sub-dir, which is good enough.

I have it this way only because I created it in a different spot 
initially when trying to get it to work, and it turns out that 
virt-viewer (another VNC viewing thing) needs it there instead.  i.e. in 
the directory below "private".

Anyway, the above works. :)

If you have troubles with the TLS key generation, the docs on the 
libvirt.org site work:

   http://libvirt.org/remote.html

And the paths for virt-manager are given on the last part of this page:

 
http://virt-manager.org/page/RemoteTLS#virt-manager.2Fvirsh.2Fvirt-viewer_client_setup


&gt;&gt; If it's relevant, I'm running everything under Fedora 13 right now, so
&gt;&gt; that means libvirt-0.8.2-1.fc13.x86_64 and
&gt;&gt; qemu-kvm-0.12.3-8.fc13.x86_64.

Similar.  All of the above is on an F13 workstation as well.

All good now? :)

Regards and best wishes,

Justin Clift

-- 
Salasaga  -  Open Source eLearning IDE
               http://www.salasaga.org

</body></email><email><emailId>20100820054125</emailId><senderName>Face</senderName><senderEmail>falazemi@gmail.com</senderEmail><timestampReceived>2010-08-20 05:41:25-0400</timestampReceived><subject>[libvirt-users] libvirt and Bridging</subject><body>

Hello all,

Basically my problem is how can i access a virtual machine from local
network. I am able to do so from the host PC put not from other  PC's
on the same network.
here is my what i did so far
(http://wiki.libvirt.org/page/Networking#NAT_forwarding_.28aka_.22virtual_networks.22.29)


cat '/etc/libvirt/qemu/networks/default.xml'
&lt;network&gt;
  &lt;name&gt;default&lt;/name&gt;
  &lt;uuid&gt;1bad08f7-0bc3-bfde-f87d-f323ab1c95eb&lt;/uuid&gt;
  &lt;forward mode='nat'/&gt;
  &lt;bridge name='virbr0' stp='on' delay='0' /&gt;
  &lt;ip address='10.0.2.1' netmask='255.255.255.240'&gt;
    &lt;dhcp&gt;
      &lt;range start='10.0.2.2' end='10.0.2.14' /&gt;
    &lt;/dhcp&gt;
  &lt;/ip&gt;
&lt;/network&gt;


cat '/etc/sysctl.conf'
# Disable packet forwarding
#net.ipv4.ip_forward=0
net.ipv4.ip_forward=1
# disable netfilter on the bridge:
net.bridge.bridge-nf-call-ip6tables = 0
net.bridge.bridge-nf-call-iptables = 0
net.bridge.bridge-nf-call-arptables = 0


ifconfig -a

br0       Link encap:Ethernet  HWaddr 00:1C:C0:38:AF:BA
          inet addr:10.0.1.5  Bcast:10.0.1.15  Mask:255.255.255.240
          inet6 addr: fe80::21c:c0ff:fe38:afba/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:580 errors:0 dropped:0 overruns:0 frame:0
          TX packets:6 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:29435 (28.7 Kb)  TX bytes:468 (468.0 b)

eth0      Link encap:Ethernet  HWaddr 00:C0:DF:13:AF:87
          inet addr:10.0.1.4  Bcast:10.0.1.15  Mask:255.255.255.240
          inet6 addr: fe80::2c0:dfff:fe13:af87/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:476362 errors:0 dropped:0 overruns:0 frame:0
          TX packets:684752 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:57147388 (54.4 Mb)  TX bytes:707797829 (675.0 Mb)
          Interrupt:22 Base address:0x800

eth1      Link encap:Ethernet  HWaddr 00:1C:C0:38:AF:BA
          inet6 addr: fe80::21c:c0ff:fe38:afba/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:1142 errors:0 dropped:0 overruns:0 frame:0
          TX packets:43 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:90530 (88.4 Kb)  TX bytes:2632 (2.5 Kb)
          Memory:e3200000-e3220000

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:118356 errors:0 dropped:0 overruns:0 frame:0
          TX packets:118356 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:14239239 (13.5 Mb)  TX bytes:14239239 (13.5 Mb)

virbr0    Link encap:Ethernet  HWaddr FE:54:00:45:A7:31
          inet addr:10.0.2.1  Bcast:10.0.2.15  Mask:255.255.255.240
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:180 errors:0 dropped:0 overruns:0 frame:0
          TX packets:128 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:16657 (16.2 Kb)  TX bytes:50599 (49.4 Kb)

vnet0     Link encap:Ethernet  HWaddr FE:54:00:45:A7:31
          inet6 addr: fe80::fc54:ff:fe45:a731/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:14 errors:0 dropped:0 overruns:0 frame:0
          TX packets:357 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:500
          RX bytes:1404 (1.3 Kb)  TX bytes:19248 (18.7 Kb)


brctl show
bridge name	bridge id		STP enabled	interfaces
br0		8000.001cc038afba	no		eth1
virbr0		8000.fe540045a731	yes		vnet0


route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
10.0.1.0        0.0.0.0         255.255.255.240 U     0      0        0 eth0
10.0.1.0        0.0.0.0         255.255.255.240 U     0      0        0 br0
10.0.2.0        0.0.0.0         255.255.255.240 U     0      0        0 virbr0
0.0.0.0         10.0.1.1        0.0.0.0         UG    0      0        0 eth0


iptables -L
Chain INPUT (policy ACCEPT)
target     prot opt source               destination
ACCEPT     udp  --  anywhere             anywhere            udp dpt:domain
ACCEPT     tcp  --  anywhere             anywhere            tcp dpt:domain
ACCEPT     udp  --  anywhere             anywhere            udp dpt:bootps
ACCEPT     tcp  --  anywhere             anywhere            tcp dpt:bootps

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination
ACCEPT     all  --  anywhere             10.0.2.0/28         state
RELATED,ESTABLISHED
ACCEPT     all  --  10.0.2.0/28          anywhere
ACCEPT     all  --  anywhere             anywhere
REJECT     all  --  anywhere             anywhere
reject-with icmp-port-unreachable
REJECT     all  --  anywhere             anywhere
reject-with icmp-port-unreachable
ACCEPT     all  --  anywhere             anywhere            PHYSDEV
match --physdev-is-bridged
ACCEPT     all  --  anywhere             anywhere            state
RELATED,ESTABLISHED
ACCEPT     all  --  anywhere             anywhere
ACCEPT     tcp  --  anywhere             10.0.2.5            tcp dpt:smakynet
ACCEPT     all  --  anywhere             anywhere            state
RELATED,ESTABLISHED
ACCEPT     all  --  anywhere             anywhere
ACCEPT     tcp  --  anywhere             10.0.2.5            tcp dpt:smakynet
ACCEPT     all  --  anywhere             anywhere            state
RELATED,ESTABLISHED
ACCEPT     all  --  anywhere             anywhere
ACCEPT     tcp  --  anywhere             10.0.2.5            tcp dpt:smakynet

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination




the IP Address for the virtual machine i am trying to access is
10.0.2.5 (vnet0). I am able only to access it from the host PC only,
therefore, how i can i access it from other PC's on the network ?


Any help would be much appreciated.



-- 
Sincerely,

</body></email><email><emailId>20100820072826</emailId><senderName>Songwen Liao</senderName><senderEmail>songwen.liao@gmail.com</senderEmail><timestampReceived>2010-08-20 07:28:26-0400</timestampReceived><subject>[libvirt-users] libvirt support spice protocol</subject><body>

Hi,everyone,
there is a problem with libvirt support spice protocol.
i use the following patch file,but it seems not success.anyone have an idea
about that?

thanks.

patch file:
This adds an element

&lt;graphics type='spice' port='5903' tlsPort='5904' listen='127.0.0.1'/&gt;

This is the bare minimum that should be exposed in the guest
config for SPICE. Other parameters are better handled as per
host level configuration tunables

* docs/schemas/domain.rng: Define the SPICE &lt;graphics&gt; schema
* src/domain_conf.h, src/domain_conf.c: Add parsing and formatting
  for SPICE graphics config
* src/qemu_conf.c: Complain about unsupported graphics types
---
docs/schemas/domain.rng |   30 +++++++++++++++++++++
src/conf/domain_conf.c  |   65
++++++++++++++++++++++++++++++++++++++++++++++-
src/conf/domain_conf.h  |    8 ++++++
src/qemu/qemu_conf.c    |    9 ++++++
4 files changed, 111 insertions(+), 1 deletions(-)

diff --git a/docs/schemas/domain.rng b/docs/schemas/domain.rng
index f9d6d7e..8aa2079 100644
--- a/docs/schemas/domain.rng
+++ b/docs/schemas/domain.rng
@@ -746,6 +746,36 @@
         &lt;/group&gt;
         &lt;group&gt;
           &lt;attribute name="type"&gt;
+            &lt;value&gt;spice&lt;/value&gt;
+          &lt;/attribute&gt;
+          &lt;optional&gt;
+            &lt;attribute name="port"&gt;
+              &lt;ref name="PortNumber"/&gt;
+            &lt;/attribute&gt;
+          &lt;/optional&gt;
+          &lt;optional&gt;
+            &lt;attribute name="tlsPort"&gt;
+              &lt;ref name="PortNumber"/&gt;
+            &lt;/attribute&gt;
+          &lt;/optional&gt;
+          &lt;optional&gt;
+            &lt;attribute name="listen"&gt;
+              &lt;ref name="addrIP"/&gt;
+            &lt;/attribute&gt;
+          &lt;/optional&gt;
+          &lt;optional&gt;
+            &lt;attribute name="passwd"&gt;
+              &lt;text/&gt;
+            &lt;/attribute&gt;
+          &lt;/optional&gt;
+          &lt;optional&gt;
+            &lt;attribute name="keymap"&gt;
+              &lt;text/&gt;
+            &lt;/attribute&gt;
+          &lt;/optional&gt;
+        &lt;/group&gt;
+        &lt;group&gt;
+          &lt;attribute name="type"&gt;
             &lt;value&gt;rdp&lt;/value&gt;
           &lt;/attribute&gt;
           &lt;optional&gt;
diff --git a/src/conf/domain_conf.c b/src/conf/domain_conf.c
index 4930c38..ca5dfc3 100644
--- a/src/conf/domain_conf.c
+++ b/src/conf/domain_conf.c
@@ -165,7 +165,8 @@ VIR_ENUM_IMPL(virDomainGraphics,
VIR_DOMAIN_GRAPHICS_TYPE_LAST,
               "sdl",
               "vnc",
               "rdp",
-              "desktop")
+              "desktop",
+              "spice")

VIR_ENUM_IMPL(virDomainHostdevMode, VIR_DOMAIN_HOSTDEV_MODE_LAST,
               "subsystem",
@@ -267,6 +268,12 @@ void virDomainGraphicsDefFree(virDomainGraphicsDefPtr
def)
     case VIR_DOMAIN_GRAPHICS_TYPE_DESKTOP:
         VIR_FREE(def-&gt;data.desktop.display);
         break;
+
+    case VIR_DOMAIN_GRAPHICS_TYPE_SPICE:
+        VIR_FREE(def-&gt;data.spice.listenAddr);
+        VIR_FREE(def-&gt;data.spice.keymap);
+        VIR_FREE(def-&gt;data.spice.passwd);
+        break;
     }

     VIR_FREE(def);
@@ -1692,6 +1699,38 @@ virDomainGraphicsDefParseXML(virConnectPtr conn,
             def-&gt;data.desktop.fullscreen = 0;

         def-&gt;data.desktop.display = virXMLPropString(node, "display");
+    } else if (def-&gt;type == VIR_DOMAIN_GRAPHICS_TYPE_SPICE) {
+        char *port = virXMLPropString(node, "port");
+        char *tlsPort;
+
+        if (port) {
+            if (virStrToLong_i(port, NULL, 10, &amp;def-&gt;data.spice.port) &lt; 0)
{
+                virDomainReportError(conn, VIR_ERR_INTERNAL_ERROR,
+                                     _("cannot parse spice port %s"),
port);
+                VIR_FREE(port);
+                goto error;
+            }
+            VIR_FREE(port);
+        } else {
+            def-&gt;data.spice.port = 5900;
+        }
+
+        tlsPort = virXMLPropString(node, "tlsPort");
+        if (tlsPort) {
+            if (virStrToLong_i(tlsPort, NULL, 10, &amp;def-&gt;data.spice.tlsPort)
&lt; 0) {
+                virDomainReportError(conn, VIR_ERR_INTERNAL_ERROR,
+                                     _("cannot parse spice tlsPort %s"),
tlsPort);
+                VIR_FREE(tlsPort);
+                goto error;
+            }
+            VIR_FREE(tlsPort);
+        } else {
+            def-&gt;data.spice.tlsPort = 0;
+        }
+
+        def-&gt;data.spice.listenAddr = virXMLPropString(node, "listen");
+        def-&gt;data.spice.passwd = virXMLPropString(node, "passwd");
+        def-&gt;data.spice.keymap = virXMLPropString(node, "keymap");
     }

cleanup:
@@ -4100,6 +4139,30 @@ virDomainGraphicsDefFormat(virConnectPtr conn,

         break;

+    case VIR_DOMAIN_GRAPHICS_TYPE_SPICE:
+        if (def-&gt;data.spice.port)
+            virBufferVSprintf(buf, " port='%d'",
+                              def-&gt;data.spice.port);
+
+        if (def-&gt;data.spice.tlsPort)
+            virBufferVSprintf(buf, " tlsPort='%d'",
+                              def-&gt;data.spice.tlsPort);
+
+        if (def-&gt;data.spice.listenAddr)
+            virBufferVSprintf(buf, " listen='%s'",
+                              def-&gt;data.spice.listenAddr);
+
+        if (def-&gt;data.spice.keymap)
+            virBufferEscapeString(buf, " keymap='%s'",
+                                  def-&gt;data.spice.keymap);
+
+        if (def-&gt;data.spice.passwd &amp;&amp;
+            (flags &amp; VIR_DOMAIN_XML_SECURE))
+            virBufferEscapeString(buf, " passwd='%s'",
+                                  def-&gt;data.spice.passwd);
+
+        break;
+
     }

     virBufferAddLit(buf, "/&gt;\n");
diff --git a/src/conf/domain_conf.h b/src/conf/domain_conf.h
index 7ea1152..4cb10d3 100644
--- a/src/conf/domain_conf.h
+++ b/src/conf/domain_conf.h
@@ -334,6 +334,7 @@ enum virDomainGraphicsType {
     VIR_DOMAIN_GRAPHICS_TYPE_VNC,
     VIR_DOMAIN_GRAPHICS_TYPE_RDP,
     VIR_DOMAIN_GRAPHICS_TYPE_DESKTOP,
+    VIR_DOMAIN_GRAPHICS_TYPE_SPICE,

     VIR_DOMAIN_GRAPHICS_TYPE_LAST,
};
@@ -366,6 +367,13 @@ struct _virDomainGraphicsDef {
             char *display;
             int fullscreen : 1;
         } desktop;
+        struct {
+            int port;
+            int tlsPort;
+            char *listenAddr;
+            char *keymap;
+            char *passwd;
+        } spice;
     } data;
};

diff --git a/src/qemu/qemu_conf.c b/src/qemu/qemu_conf.c
index 7ba0ac2..ae171bc 100644
--- a/src/qemu/qemu_conf.c
+++ b/src/qemu/qemu_conf.c
@@ -2067,6 +2067,12 @@ int qemudBuildCommandLine(virConnectPtr conn,
         }
     }

+    if (def-&gt;ngraphics &gt; 1) {
+        qemudReportError(conn, NULL, NULL, VIR_ERR_INTERNAL_ERROR,
+                         "%s", _("only one graphics output is currently
supported"));
+        goto error;
+    }
+
     if ((def-&gt;ngraphics == 1) &amp;&amp;
         def-&gt;graphics[0]-&gt;type == VIR_DOMAIN_GRAPHICS_TYPE_VNC) {
         virBuffer opt = VIR_BUFFER_INITIALIZER;
@@ -2155,6 +2161,9 @@ int qemudBuildCommandLine(virConnectPtr conn,
          */
         ADD_ENV_COPY("QEMU_AUDIO_DRV");
         ADD_ENV_COPY("SDL_AUDIODRIVER");
+    } else if (def-&gt;ngraphics) {
+        qemudReportError(conn, NULL, NULL, VIR_ERR_INTERNAL_ERROR,
+                         "%s", _("unsupported graphics output requested"));
     }

     if (def-&gt;nvideos) {
-- 


-- 
Name:   Ben
------------------------------------------
Msn:    liaosongwen@live.cn

[Attachment #3 (text/html)]

&lt;div&gt;Hi,everyone,&lt;/div&gt;
&lt;div&gt;there is a problem with libvirt support spice protocol.&lt;/div&gt;
&lt;div&gt;i use the following patch file,but it seems not success.anyone have an idea \
about that?&lt;/div&gt; &lt;div&gt; &lt;/div&gt;
&lt;div&gt;thanks.&lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt;patch file:&lt;/div&gt;
&lt;div&gt;This adds an element&lt;br&gt;&lt;br&gt;&lt;graphics type='spice' \
port='5903' tlsPort='5904' \
listen='127.0.0.1'/&gt;&lt;br&gt;&lt;br&gt;This is the bare minimum that should be \
exposed in the guest&lt;br&gt;config for SPICE. Other parameters are better handled as \
per&lt;br&gt; host level configuration tunables&lt;br&gt;&lt;br&gt;* docs/schemas/domain.rng: Define \
the SPICE &lt;graphics&gt; schema&lt;br&gt;* src/domain_conf.h, src/domain_conf.c: Add \
parsing and formatting&lt;br&gt;  for SPICE graphics config&lt;br&gt;* src/qemu_conf.c: Complain \
                about unsupported graphics types&lt;br&gt;
---&lt;br&gt;docs/schemas/domain.rng |   30 +++++++++++++++++++++&lt;br&gt;src/conf/domain_conf.c \
|   65 ++++++++++++++++++++++++++++++++++++++++++++++-&lt;br&gt;src/conf/domain_conf.h  |   \
8 ++++++&lt;br&gt;src/qemu/qemu_conf.c    |    9 ++++++&lt;br&gt; 4 files changed, 111 \
insertions(+), 1 deletions(-)&lt;br&gt;&lt;br&gt;diff --git a/docs/schemas/domain.rng \
b/docs/schemas/domain.rng&lt;br&gt;index f9d6d7e..8aa2079 100644&lt;br&gt;--- \
a/docs/schemas/domain.rng&lt;br&gt;+++ b/docs/schemas/domain.rng&lt;br&gt; @@ -746,6 +746,36 \
@@&lt;br&gt;         &lt;/group&gt;&lt;br&gt;         &lt;group&gt;&lt;br&gt;           &lt;attribute \
name="type"&gt;&lt;br&gt;+            &lt;value&gt;spice&lt;/value&gt;&lt;br&gt;+       \
&lt;/attribute&gt;&lt;br&gt;+          &lt;optional&gt;&lt;br&gt; +            &lt;attribute \
name="port"&gt;&lt;br&gt;+              &lt;ref \
name="PortNumber"/&gt;&lt;br&gt;+            &lt;/attribute&gt;&lt;br&gt;+          \
&lt;/optional&gt;&lt;br&gt;+          &lt;optional&gt;&lt;br&gt;+            &lt;attribute \
name="tlsPort"&gt;&lt;br&gt; +              &lt;ref \
name="PortNumber"/&gt;&lt;br&gt;+            &lt;/attribute&gt;&lt;br&gt;+          \
&lt;/optional&gt;&lt;br&gt;+          &lt;optional&gt;&lt;br&gt;+            &lt;attribute \
name="listen"&gt;&lt;br&gt;+              &lt;ref \
name="addrIP"/&gt;&lt;br&gt; +            &lt;/attribute&gt;&lt;br&gt;+          \
&lt;/optional&gt;&lt;br&gt;+          &lt;optional&gt;&lt;br&gt;+            &lt;attribute \
name="passwd"&gt;&lt;br&gt;+              &lt;text/&gt;&lt;br&gt;+            \
&lt;/attribute&gt;&lt;br&gt; +          &lt;/optional&gt;&lt;br&gt;+          \
&lt;optional&gt;&lt;br&gt;+            &lt;attribute name="keymap"&gt;&lt;br&gt;+       \
&lt;text/&gt;&lt;br&gt;+            &lt;/attribute&gt;&lt;br&gt;+          &lt;/optional&gt;&lt;br&gt;+ \
&lt;/group&gt;&lt;br&gt; +        &lt;group&gt;&lt;br&gt;+          &lt;attribute \
name="type"&gt;&lt;br&gt;             &lt;value&gt;rdp&lt;/value&gt;&lt;br&gt;          \
&lt;/attribute&gt;&lt;br&gt;           &lt;optional&gt;&lt;br&gt;diff --git \
a/src/conf/domain_conf.c b/src/conf/domain_conf.c&lt;br&gt; index 4930c38..ca5dfc3 \
100644&lt;br&gt;--- a/src/conf/domain_conf.c&lt;br&gt;+++ b/src/conf/domain_conf.c&lt;br&gt;@@ -165,7 \
+165,8 @@ VIR_ENUM_IMPL(virDomainGraphics, VIR_DOMAIN_GRAPHICS_TYPE_LAST,&lt;br&gt;         \
"sdl",&lt;br&gt;               "vnc",&lt;br&gt;  "rdp",&lt;br&gt;-        \
"desktop")&lt;br&gt;+              "desktop",&lt;br&gt;+              \
"spice")&lt;br&gt;&lt;br&gt;VIR_ENUM_IMPL(virDomainHostdevMode, \
VIR_DOMAIN_HOSTDEV_MODE_LAST,&lt;br&gt;  "subsystem",&lt;br&gt;@@ -267,6 +268,12 @@ \
void virDomainGraphicsDefFree(virDomainGraphicsDefPtr def)&lt;br&gt;     case \
VIR_DOMAIN_GRAPHICS_TYPE_DESKTOP:&lt;br&gt;         \
VIR_FREE(def-&gt;data.desktop.display);&lt;br&gt;  break;&lt;br&gt;+&lt;br&gt;+    case \
VIR_DOMAIN_GRAPHICS_TYPE_SPICE:&lt;br&gt;+        \
VIR_FREE(def-&gt;data.spice.listenAddr);&lt;br&gt;+        \
VIR_FREE(def-&gt;data.spice.keymap);&lt;br&gt;+        \
VIR_FREE(def-&gt;data.spice.passwd);&lt;br&gt;+        break;&lt;br&gt;  }&lt;br&gt;&lt;br&gt;     \
VIR_FREE(def);&lt;br&gt;@@ -1692,6 +1699,38 @@ virDomainGraphicsDefParseXML(virConnectPtr \
conn,&lt;br&gt;             def-&gt;data.desktop.fullscreen = 0;&lt;br&gt;&lt;br&gt;         \
def-&gt;data.desktop.display = virXMLPropString(node, "display");&lt;br&gt; +    \
} else if (def-&gt;type == VIR_DOMAIN_GRAPHICS_TYPE_SPICE) {&lt;br&gt;+        char *port = \
virXMLPropString(node, "port");&lt;br&gt;+        char *tlsPort;&lt;br&gt;+&lt;br&gt;+        \
if (port) {&lt;br&gt;+            if (virStrToLong_i(port, NULL, 10, \
&amp;def-&gt;data.spice.port) &lt; 0) {&lt;br&gt; +                \
virDomainReportError(conn, VIR_ERR_INTERNAL_ERROR,&lt;br&gt;+                               \
_("cannot parse spice port %s"), port);&lt;br&gt;+                \
VIR_FREE(port);&lt;br&gt;+                goto error;&lt;br&gt; +            }&lt;br&gt;+            \
VIR_FREE(port);&lt;br&gt;+        } else {&lt;br&gt;+            def-&gt;data.spice.port = \
5900;&lt;br&gt;+        }&lt;br&gt;+&lt;br&gt;+        tlsPort = virXMLPropString(node, \
"tlsPort");&lt;br&gt;+        if (tlsPort) {&lt;br&gt; +            if \
(virStrToLong_i(tlsPort, NULL, 10, &amp;def-&gt;data.spice.tlsPort) &lt; 0) {&lt;br&gt;+    \
virDomainReportError(conn, VIR_ERR_INTERNAL_ERROR,&lt;br&gt;+                               \
_("cannot parse spice tlsPort %s"), tlsPort);&lt;br&gt; +                \
VIR_FREE(tlsPort);&lt;br&gt;+                goto error;&lt;br&gt;+            }&lt;br&gt;+            \
VIR_FREE(tlsPort);&lt;br&gt;+        } else {&lt;br&gt;+            def-&gt;data.spice.tlsPort = \
0;&lt;br&gt;+        }&lt;br&gt;+&lt;br&gt;+        def-&gt;data.spice.listenAddr = \
virXMLPropString(node, "listen");&lt;br&gt; +        def-&gt;data.spice.passwd = \
virXMLPropString(node, "passwd");&lt;br&gt;+        def-&gt;data.spice.keymap = \
virXMLPropString(node, "keymap");&lt;br&gt;     }&lt;br&gt;&lt;br&gt;cleanup:&lt;br&gt;@@ -4100,6 \
+4139,30 @@ virDomainGraphicsDefFormat(virConnectPtr conn,&lt;br&gt; &lt;br&gt;         \
break;&lt;br&gt;&lt;br&gt;+    case VIR_DOMAIN_GRAPHICS_TYPE_SPICE:&lt;br&gt;+        if \
(def-&gt;data.spice.port)&lt;br&gt;+            virBufferVSprintf(buf, " \
port='%d'",&lt;br&gt;+                              \
def-&gt;data.spice.port);&lt;br&gt; +&lt;br&gt;+        if (def-&gt;data.spice.tlsPort)&lt;br&gt;+      \
virBufferVSprintf(buf, " tlsPort='%d'",&lt;br&gt;+                        \
def-&gt;data.spice.tlsPort);&lt;br&gt;+&lt;br&gt;+        if (def-&gt;data.spice.listenAddr)&lt;br&gt; \
+            virBufferVSprintf(buf, " listen='%s'",&lt;br&gt;+            \
def-&gt;data.spice.listenAddr);&lt;br&gt;+&lt;br&gt;+        if (def-&gt;data.spice.keymap)&lt;br&gt;+  \
virBufferEscapeString(buf, " keymap='%s'",&lt;br&gt; +                    \
def-&gt;data.spice.keymap);&lt;br&gt;+&lt;br&gt;+        if (def-&gt;data.spice.passwd \
&amp;&amp;&lt;br&gt;+            (flags &amp; VIR_DOMAIN_XML_SECURE))&lt;br&gt;+            \
virBufferEscapeString(buf, " passwd='%s'",&lt;br&gt; +                    \
def-&gt;data.spice.passwd);&lt;br&gt;+&lt;br&gt;+        break;&lt;br&gt;+&lt;br&gt;     }&lt;br&gt;&lt;br&gt;     \
virBufferAddLit(buf, "/&gt;\n");&lt;br&gt;diff --git a/src/conf/domain_conf.h \
b/src/conf/domain_conf.h&lt;br&gt; index 7ea1152..4cb10d3 100644&lt;br&gt;--- \
a/src/conf/domain_conf.h&lt;br&gt;+++ b/src/conf/domain_conf.h&lt;br&gt;@@ -334,6 +334,7 @@ enum \
virDomainGraphicsType {&lt;br&gt;     VIR_DOMAIN_GRAPHICS_TYPE_VNC,&lt;br&gt;     \
VIR_DOMAIN_GRAPHICS_TYPE_RDP,&lt;br&gt;  VIR_DOMAIN_GRAPHICS_TYPE_DESKTOP,&lt;br&gt;+    \
VIR_DOMAIN_GRAPHICS_TYPE_SPICE,&lt;br&gt;&lt;br&gt;     \
VIR_DOMAIN_GRAPHICS_TYPE_LAST,&lt;br&gt;};&lt;br&gt;@@ -366,6 +367,13 @@ struct \
_virDomainGraphicsDef {&lt;br&gt;             char *display;&lt;br&gt;             int fullscreen \
: 1;&lt;br&gt;  } desktop;&lt;br&gt;+        struct {&lt;br&gt;+            int port;&lt;br&gt;+            \
int tlsPort;&lt;br&gt;+            char *listenAddr;&lt;br&gt;+            char *keymap;&lt;br&gt;+     \
char *passwd;&lt;br&gt;+        } spice;&lt;br&gt;     } data;&lt;br&gt; };&lt;br&gt;&lt;br&gt;diff --git \
a/src/qemu/qemu_conf.c b/src/qemu/qemu_conf.c&lt;br&gt;index 7ba0ac2..ae171bc 100644&lt;br&gt;--- \
a/src/qemu/qemu_conf.c&lt;br&gt;+++ b/src/qemu/qemu_conf.c&lt;br&gt;@@ -2067,6 +2067,12 @@ int \
qemudBuildCommandLine(virConnectPtr conn,&lt;br&gt;  }&lt;br&gt;     }&lt;br&gt;&lt;br&gt;+    if \
(def-&gt;ngraphics &gt; 1) {&lt;br&gt;+        qemudReportError(conn, NULL, NULL, \
VIR_ERR_INTERNAL_ERROR,&lt;br&gt;+                         "%s", _("only one \
graphics output is currently supported"));&lt;br&gt; +        goto error;&lt;br&gt;+    \
}&lt;br&gt;+&lt;br&gt;     if ((def-&gt;ngraphics == 1) &amp;&amp;&lt;br&gt;         \
def-&gt;graphics[0]-&gt;type == VIR_DOMAIN_GRAPHICS_TYPE_VNC) {&lt;br&gt;         virBuffer \
opt = VIR_BUFFER_INITIALIZER;&lt;br&gt;@@ -2155,6 +2161,9 @@ int \
                qemudBuildCommandLine(virConnectPtr conn,&lt;br&gt;
          */&lt;br&gt;         ADD_ENV_COPY("QEMU_AUDIO_DRV");&lt;br&gt;         \
ADD_ENV_COPY("SDL_AUDIODRIVER");&lt;br&gt;+    } else if (def-&gt;ngraphics) \
{&lt;br&gt;+        qemudReportError(conn, NULL, NULL, VIR_ERR_INTERNAL_ERROR,&lt;br&gt; +        \
"%s", _("unsupported graphics output requested"));&lt;br&gt;     \
}&lt;br&gt;&lt;br&gt;     if (def-&gt;nvideos) {&lt;br&gt;-- &lt;br&gt;&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;&lt;/div&gt; \
&lt;div&gt;Name:   Ben&lt;br&gt;------------------------------------------&lt;br&gt;Msn:    &lt;a \
href="mailto:liaosongwen@live.cn" target="_blank"&gt;liaosongwen@live.cn&lt;/a&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20100820134334</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-08-20 13:43:34-0400</timestampReceived><subject>Re: [libvirt-users] how to Create virtual machine</subject><body>

On 08/20/2010 11:15 PM, Saravanan S wrote:
&gt; Hi,
&gt;
&gt; I am working on a virtualization project that involves setting up virtual
&gt; appliances to implement the same, which tool is required to
&gt;
&gt; 1) create virtual appliances
&gt; 2) deploy virtual appliances
&gt; 3) manage virtual appliances/virtual machines
&gt;
&gt; Could you please guide me with some pointers or resources to get started
&gt; with the creation of virtual machines?

Welcome aboard. :)

There are a _tonne_ of useful things on the Net about creating virtual 
machines.  As a first point of reference, I'll point you to the Fedora 
"Virtualization Guide", as it has good info and is being actively developed:

 
http://docs.fedoraproject.org/en-US/Fedora/13/html/Virtualization_Guide/index.html

(When RHEL 6 comes out, it will have a RHEL 6 specific version of that too)

HowtoForge is also very useful:

   http://how2forge.net/howtos/virtualization

Depending upon the distribution you're developing on, it probably has
something that will get you up and running. :)

ie:

   Fedora 13
   http://how2forge.net/virtualization-with-kvm-on-a-fedora-13-server

   Mandriva
   http://how2forge.net/virtualization-with-kvm-on-a-mandriva-2010.0-server

If you're using Ubuntu, a good starting point is here:

   https://help.ubuntu.com/community/KVM


 &gt; I am little confused with libvirt with Xen and qemu.
 &gt; how does xen or qemu related with libvirt ?

This is probably covered in more depth by the above links.  The short 
version is that Xen and Qemu are the actual pieces of software that do 
the virtualisation. i.e Your virtual machine runs in either Xen or Qemu

libvirt provides a vendor agnostic management library, that management 
tools (ie virt-manager and others) use to control the virtual machines.

   ie start up a vm, shut it down, migrate it to another server, etc.

In regards to Qemu vs Xen, it depends upon your needs.  Xen never got 
accepted into the Linux kernel, and the parent company (that's a 
generalisation) was bought by Citrix who has continued developing it.

Qemu (though qemu-kvm) is part of the Linux kernel, and is getting a 
*huge* amount of development from many companies.  (including Red Hat)

Does that help?

Regards and best wishes,

Justin Clift

</body></email><email><emailId>20100820163526</emailId><senderName>Brian Pitts</senderName><senderEmail>bdp@uga.edu</senderEmail><timestampReceived>2010-08-20 16:35:26-0400</timestampReceived><subject>[libvirt-users] Libvirt and iptables rule order</subject><body>

Hi,

On RHEL 5.5, I set up iptables rules for forwarding ports to some of my
virtual machines. For example.

iptables -t nat -A PREROUTING -i eth0 -p tcp -m tcp --dport 3380 -j DNAT
--to-destination 192.168.123.2:3389
iptables -I FORWARD -d 192.168.123.2 -i eth0 -p tcp -m tcp --dport 3389
-m state --state NEW -j ACCEPT

These worked fine, and I saved them with 'service iptables save'.

However, upon rebooting the server the forwarding no longer works. When
I inspect the configuration with 'iptables -L', I see that the rules
libvirt creates were inserted before the rules from
/etc/sysconfig/iptables. Since the rules from libvirt include one that
rejects any new connections, the data I want forwarded is dropped. For
example,

target  prot  opt  in  out  source  destination
ACCEPT  all  --  any  virbr1  anywhere 192.168.123.0/24  state
RELATED,ESTABLISHED
ACCEPT  all  --  virbr1 any  192.168.123.0/24  anywhere
ACCEPT  all  --  virbr1  virbr1  anywhere  anywhere
REJECT  all  --  any  virbr1  anywhere  anywhere reject-with
icmp-port-unreachable
REJECT  all  --  virbr1 any  anywhere  anywhere reject-with
icmp-port-unreachable
ACCEPT  tcp  --  eth0  any  anywhere  192.168.123.2  tcp
dpt:ms-wbt-server state NEW

How should I configure iptables so that my rules and libvirt's play
nicely? Basically I need my ACCEPTs to end up before libvirt's REJECTs.
I looked through the list archives and libvirt documentation but did not
see an answer to this question.

-- 
Brian Pitts
Systems Administrator | EuPathDB Bioinformatics Resource Center
706-542-1447 | bdp@uga.edu | http://eupathdb.org

</body></email><email><emailId>20100822013948</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-08-22 01:39:48-0400</timestampReceived><subject>[libvirt-users] VNC Client certificate paths</subject><body>

Hi all,

(Following up on this further)

There's not that much clear documentation around for the paths required 
for using TLS with various VNC clients.

Therefore, after a liberal use of strace to find out what clients really 
do look for, there is a first set of info on the libvirt.org wiki:

   http://wiki.libvirt.org/page/VNCTLSSetup

It's more in depth than the previous mailing list reply, covering:

  * Vinagre
  * Virt Manager
  * Virt Viewer
  * Gtk-VNC

Lars, it should help you get up and running with the VNC client side of 
things if you're still having troubles. (?)

Cole (and others too), if you have time, all 
feedback/pointers/thoughts/etc are welcome.  :)

Regards and best wishes,

Justin Clift

</body></email><email><emailId>20100826151153</emailId><senderName>Brian Roberg</senderName><senderEmail>robergb@dm.org</senderEmail><timestampReceived>2010-08-26 15:11:53-0400</timestampReceived><subject>Re: [libvirt-users] Installing a VM to a virtio disk</subject><body>

On Fri, Aug 20, 2010 at 1:00 PM, Brian Roberg &lt;robergb@dm.org&gt; wrote:

&gt; When provisioning new VMs, is it possible to enable virtio for the guest's
&gt; storage at the time of the installation? When I try to do so, the Ubuntu
&gt; installer says, "No root file system is defined" when it gets to the
&gt; partitioning step.


This turned out to be a silly mistake on my part. (Note: The problem and
solution I'll describe here are not libvirt-specific, but since I asked the
question here I thought it best to provide the answer too.)

In the preseed file I was using for the installer, I had placed a line I'd
copied from Ubuntu's example configuration:

  d-i partman-auto/disk string /dev/sda

The virtio_blk driver was ready to be used, but I was still telling the
installer to use the non-virtio device. Installation to the virtio block
device succeeded after I replaced that line with this one:

  d-i partman/early_command string debconf-set partman-auto/disk
"$(list-devices disk | head -n1)"

-- 
Brian

[Attachment #3 (text/html)]

&lt;div class="gmail_quote"&gt;On Fri, Aug 20, 2010 at 1:00 PM, Brian Roberg &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:robergb@dm.org"&gt;robergb@dm.org&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt; When provisioning new VMs, is it possible to enable \
virtio for the guest's storage at the time of the installation? When I try to do \
so, the Ubuntu installer says, "No root file system is defined" when it \
gets to the partitioning step.&lt;/blockquote&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;This turned out to be \
a silly mistake on my part. (Note: The problem and solution I'll describe here \
are not libvirt-specific, but since I asked the question here I thought it best to \
provide the answer too.)&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;In the preseed file I was using \
for the installer, I had placed a line I'd copied from Ubuntu's example \
configuration:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;    d-i partman-auto/disk string /dev/sda  \
&lt;/div&gt;&lt;div&gt; &lt;br&gt;&lt;/div&gt;&lt;div&gt;The virtio_blk driver was ready to be used, but I was \
still telling the installer to use the non-virtio device. Installation to the virtio \
block device succeeded after I replaced that line with this one:&lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;    d-i partman/early_command string debconf-set \
partman-auto/disk "$(list-devices  disk | head \
-n1)"&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;-- &lt;br&gt;Brian&lt;br&gt;&lt;br&gt;



</body></email><email><emailId>20100827221643</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-08-27 22:16:43-0400</timestampReceived><subject>Re: [libvirt-users] Unable to autostart storage pool.</subject><body>

2010/8/27 Sharad Mishra &lt;snmishra@us.ibm.com&gt;:
&gt; Following xml file was used to create storage pool using 'virsh pool-create
&gt; &lt;xml&gt;'
&gt;
&gt; &lt;pool type='dir'&gt;
&gt; &lt;name&gt;my-diskpool&lt;/name&gt;
&gt; &lt;uuid&gt;2fbc894e-7619-6cda-a33c-b27fae5fbe8b&lt;/uuid&gt;
&gt; &lt;capacity&gt;136024670208&lt;/capacity&gt;
&gt; &lt;allocation&gt;11416657920&lt;/allocation&gt;
&gt; &lt;available&gt;124608012288&lt;/available&gt;
&gt; &lt;source&gt;
&gt; &lt;host name='localhost'/&gt;
&gt; &lt;/source&gt;
&gt; &lt;target&gt;
&gt; &lt;path&gt;/var/lib/libvirt/images&lt;/path&gt;
&gt; &lt;permissions&gt;
&gt; &lt;mode&gt;0700&lt;/mode&gt;
&gt; &lt;owner&gt;0&lt;/owner&gt;
&gt; &lt;group&gt;0&lt;/group&gt;
&gt; &lt;/permissions&gt;
&gt; &lt;/target&gt;
&gt; &lt;/pool&gt;
&gt;
&gt; The command succeeds and a pool is created -
&gt;
&gt; # virsh pool-list --all
&gt; Name State Autostart
&gt; -----------------------------------------
&gt; my-diskpool active no
&gt;
&gt;
&gt; When I try to set it up for autostart, I get -
&gt;
&gt; # virsh pool-autostart my-diskpool
&gt; error: failed to mark pool my-diskpool as autostarted
&gt; error: invalid argument in pool has no config file
&gt;
&gt; Why is it failing to autostart?
&gt;
&gt; /etc/libvirt/storage has no xml file.
&gt;

'virsh pool-create &lt;xml&gt;' creates a transient pool, that has no
persistent config on disk. Such a pool cannot be autostarted, because
it's gone when you call pool-destroy on it.

In order to have an autostartable pool you need to 'virsh pool-define
&lt;xml&gt;' the pool, this creates a pool with a persistent config in
/etc/libvirt/storage.

Matthias

</body></email><email><emailId>20100830084948</emailId><senderName>Nils Cant</senderName><senderEmail>nils.cant@kangaroot.net</senderEmail><timestampReceived>2010-08-30 08:49:48-0400</timestampReceived><subject>[libvirt-users] Is it possible to live migrate guest OS'es between different versions of kvm/qemu-kv</subject><body>

Hi,

I currently have a couple of Debian KVM servers with all a different 
version of kvm or qemu-kvm.
I can live migrate a guest OS from one server to the other just fine, as 
long as the version of qemu-kvm is the same.

However, when I try to migrate a guest to a server running a newer (or 
older) version of qemu-kvm, I run into problems. I think this is because 
the xml configuration differs slightly between version.

For example, if I try to migrate from a server running qemu-kvm 0.11.0 
to one running qemu-kvm 0.12.4, I get the following error:

virt01:~# virsh migrate --live testserver qemu+ssh://192.168.1.7/system
error: internal error unable to reserve PCI address 0:0:3

When migrating from kvm 85 to qemu-kvm 0.11.0:

virt02:~# virsh migrate --live testserver qemu+ssh://192.168.1.2/system
error: Unknown failure

Migrating one from 0.12.4 to 0.11.0 just completely breaks libvirt, 
forcing me to kill -9 libvirtd and the kvm instance, etc.

I believe this is caused in part because different versions of qemu-kvm 
need different xml configurations. To run my testserver on 0.12.4 for 
example, I need to delete the lines with the PCI id's, just to be able 
to start it.

So, is there a way to make this work? Perhaps tell libvirt to not send 
the config file when doing a live migrate, and use the xml in 
/etc/libvirt/qemu instead somehow?

Thanks in advance,

Nils

</body></email><email><emailId>20100831015231</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-08-31 01:52:31-0400</timestampReceived><subject>Re: [libvirt-users] C, C++ or Python programming tutorial/manual/guide for libvirt</subject><body>

On 08/31/2010 11:12 AM, Lucas Arbiza wrote:
&gt; Hi,
&gt;
&gt; I want to develop an application to manage KVM virtual machines.
&gt;
&gt; I've been looking for something that helps me to start programming using
&gt; libvirt in C/C++. The only one documentation I found is  in this link:
&gt; http://libvirt.org/html/libvirt-libvirt.html. Neither Google has helped me!
&gt;
&gt; That does not look like a good way to start.
&gt;
&gt; So, do you know some useful C, C++ or Python tutorial for libvirt?

Hi Lucas,

This is probably what you're looking for:

   http://libvirt.org/guide/html/

It's the initial parts of the "libvirt Application Developers Guide".

Although the version number in it says "0.7.5", it is being actively 
worked on around other things, but is going to take a while (months) 
until it's fully ready.

Does this help?

Regards and best wishes,

Justin Clift


&gt; I prefer C or C++.
&gt;
&gt; Thanks in advance.
&gt; __
&gt;
&gt; Lucas Arbiza
&gt;
&gt; email: lucas.arbiza@gmail.com
&gt; celular: +55 (55) 9152 7561
&gt; skype: lucas.arbiza

</body></email><email><emailId>20100831134016</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2010-08-31 13:40:16-0400</timestampReceived><subject>Re: [libvirt-users] Decent How-To now on the wiki for setting up Transport Layer Security</subject><body>

On Mon, Aug 30, 2010 at 08:46:43PM +1000, Justin Clift wrote:
&gt; Hi all,
&gt; 
&gt; For anyone that's interested in setting up TLS with libvirt, but
&gt; hasn't gotten around to it yet, there's a decent guide on the wiki
&gt; now:
&gt; 
&gt;   http://wiki.libvirt.org/page/TLSSetup
&gt; 
&gt; It's user focused (ie SysAdmin's), and has lots of pics explaining
&gt; concepts, plus shows what needs to be done, and shows how to do it.
&gt; 
&gt; Please note, it doesn't cover SASL, it's just plain host based TLS.
&gt; 
&gt; Very much open to feedback on it, if people have suggestions for
&gt; improvement.
&gt; 
&gt; Hope that helps. :)

  Very nice :-) Thanks !

Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

</body></email><email><emailId>20100701025715</emailId><senderName>Shenglan Wang</senderName><senderEmail>lanlan.wsl@gmail.com</senderEmail><timestampReceived>2010-07-01 02:57:15-0400</timestampReceived><subject>[libvirt-users] non-root user "virConnectOpen() faile" in libvirt-0.3</subject><body>

*Hello,*
*
*
*My environment is "Xen3.1 in Fedora8" with "libvirt0.3 &amp; python2.5". When I
ran the following *
*commands as a non-root user "nimbus":*

$python
&gt;&gt;&gt; import libvirt
&gt;&gt;&gt; libvirt.open("xen:///")

--------- Console ---------
[nimbus@localhost-120 ~]$ python
Python 2.5.1 (r251:54863, Oct 30 2007, 13:54:11)
[GCC 4.1.2 20070925 (Red Hat 4.1.2-33)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt; import libvirt
&gt;&gt;&gt; libvirt.open("xen:///")
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
  File "/usr/lib/python2.5/site-packages/libvirt.py", line 123, in open
    if ret is None:raise libvirtError('virConnectOpen() failed')
libvirt.libvirtError: virConnectOpen() failed
&gt;&gt;&gt;

*I encountered the error "virConnectOpen() failed". if I changed the user
into root, it worked well. *
*But I hava to use the non-root account "nimbus". I looked into the problem
on the net, in order *
*that non-root user could use libvirt as root user, someone suggested that I
should modify the libvirt *
*configuration file "/etc/libvirt/libvirtd.conf", but they didn't point out
what field should be changed.*
*
*
*I am puzzled about that problem. I have already changed the sudo file and
the xen configuration *
*file "/etc/xen/xend-config.sxp", which doesn't work at all. Could someome
give me any tips? *

--------- "/etc/xen/xend-config.sxp" ---------
(xend-http-server yes)
(xend-unix-server yes)
(network-script network-bridge)
*
*
*Thanks in advance!*
*
*
*Cheers,*
*
*
*Shenglan Wang*

[Attachment #3 (text/html)]

&lt;div&gt;&lt;b&gt;Hello,&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;My environment is &amp;qu=
ot;Xen3.1 in Fedora8" with "libvirt0.3 &amp; python2.5". Whe=
n I ran the following=A0&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;commands as a non-root user "=
;nimbus":&lt;/b&gt;&lt;/div&gt;
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;$python&lt;/div&gt;&lt;div&gt;&gt;&gt;&gt; import libvirt&lt;/div&gt;&lt;div=
&gt;&gt;&gt;&gt; libvirt.open("xen:///")&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;--=
------- Console ---------&lt;/div&gt;&lt;div&gt;[nimbus@localhost-120 ~]$ python&lt;/div&gt;
&lt;div&gt;Python 2.5.1 (r251:54863, Oct 30 2007, 13:54:11)=A0&lt;/div&gt;&lt;div&gt;[GCC 4.1=
.2 20070925 (Red Hat 4.1.2-33)] on linux2&lt;/div&gt;&lt;div&gt;Type "help", =
"copyright", "credits" or "license" for more =
information.&lt;/div&gt;
&lt;div&gt;&gt;&gt;&gt; import libvirt&lt;/div&gt;&lt;div&gt;&gt;&gt;&gt; libvirt.open("=
xen:///")&lt;/div&gt;&lt;div&gt;Traceback (most recent call last):&lt;/div&gt;&lt;div&gt;=A0=
=A0File "&lt;stdin&gt;", line 1, in &lt;module&gt;&lt;/div&gt;&lt;div&gt;=A0=
=A0File "/usr/lib/python2.5/site-packages/libvirt.py", line 123, =
in open&lt;/div&gt;
&lt;div&gt;=A0=A0 =A0if ret is None:raise libvirtError('virConnectOpen() fail=
ed')&lt;/div&gt;&lt;div&gt;libvirt.libvirtError: virConnectOpen() failed&lt;/div&gt;&lt;div&gt;=
&gt;&gt;&gt;=A0&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;I encountered the error "v=
irConnectOpen() failed". if I changed the user into root, it worked we=
ll.=A0&lt;/b&gt;&lt;/div&gt;
&lt;div&gt;&lt;b&gt;But I hava to use the non-root account "nimbus". I looked=
 into the problem on the net, in order=A0&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;that non-root us=
er could use libvirt as root user, someone suggested that I should modify t=
he libvirt=A0&lt;/b&gt;&lt;/div&gt;
&lt;div&gt;&lt;b&gt;configuration file "/etc/libvirt/libvirtd.conf", but they=
 didn't point out what field should be changed.&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/=
b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;I am puzzled about that problem. I have already changed the=
 sudo file and the xen configuration=A0&lt;/b&gt;&lt;/div&gt;
&lt;div&gt;&lt;b&gt;file "/etc/xen/xend-config.sxp", which doesn't work a=
t all. Could someome give me any tips?=A0&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;----=
----- "/etc/xen/xend-config.sxp" ---------&lt;/div&gt;&lt;div&gt;(xend-http-s=
erver yes)&lt;/div&gt;
&lt;div&gt;(xend-unix-server yes)&lt;/div&gt;&lt;div&gt;(network-script network-bridge)&lt;/div&gt;=
&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;Thanks in advance!&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;=
/div&gt;&lt;div&gt;&lt;b&gt;Cheers,&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;Shenglan Wang&lt;/=
b&gt;&lt;/div&gt;



</body></email><email><emailId>20100701070116</emailId><senderName>Adam Gray</senderName><senderEmail>adam@meebo-inc.com</senderEmail><timestampReceived>2010-07-01 07:01:16-0400</timestampReceived><subject>Re: [libvirt-users] SASL GSSAPI error "Key table entry not found"</subject><body>

I'll try again from latest source tomorrow (or sometime soon). If that
doesn't change anything, I'll repost. Thanks for your help!

-adam



On Wed, Jun 30, 2010 at 16:10, Adam Gray &lt;adam@meebo-inc.com&gt; wrote:
&gt; On Wed, Jun 30, 2010 at 10:13, Daniel P. Berrange &lt;berrange@redhat.com&gt; wrote:
&gt;&gt;
&gt;&gt; If changing the location in /etc/sasl2/libvirt.conf doesn't
&gt;&gt; work then you likely have a broken kerberos/sasl library.
&gt;&gt; This works in latest versions, but for broken systems you
&gt;&gt; can workaround it by setting KRB5_KTNAME=/etc/libvirt/krb5.tab
&gt;&gt; as an env variable when starting libvirtd.
&gt;
&gt; Looks like upstart doesn't work quite like I thought. Running this
&gt; from the command line shows it changed the file path:
&gt; KRB5_KTNAME=/etc/libvirt/krb5.keytab strace -f -ff -eopen libvirtd
&gt; --listen 2&gt;&amp;1 |grep keytab
&gt; [pid   2412] open("/etc/libvirt/krb5.keytab", O_RDONLY) = 39
&gt;
&gt;&gt;
&gt;&gt; Do you have your server hostname configured to exactly match
&gt;&gt; my.fully.qualified.domain (as per hostname -f command), and
&gt;&gt; is that hostname present in the DNS records, both forward and
&gt;&gt; reverse lookups. Using /etc/hosts is not sufficient for kerberos
&gt;&gt; to work IIRC.
&gt;
&gt; Yeah, I ran into that one way too many times to forget :(
&gt; hostname -f gives fqdn, dig on that fqdn gives the right IP, dig -x on
&gt; that IP gives a PTR to the same fqdn.
&gt;
&gt;&gt;
&gt;&gt; That just says the client doesn't have a ticket so not
&gt;&gt; really of interest since you just kdestroy'd the ticket :-)
&gt;

</body></email><email><emailId>20100701081325</emailId><senderName>Tom Hughes</senderName><senderEmail>tom@compton.nu</senderEmail><timestampReceived>2010-07-01 08:13:25-0400</timestampReceived><subject>Re: [libvirt-users] Some missunderstanding in the wiki page</subject><body>

On 01/07/10 09:11, Leopold Palomo-Avellaneda wrote:
&gt; A Dimecres 30 Juny 2010, Tom Hughes va escriure:
&gt;
&gt;&gt; The common configuration that the wiki is documenting is presumably the
&gt;&gt; case where the host has a single ethernet interface that is shared by
&gt;&gt; the host and the guests. In that configuration the bridge does have an
&gt;&gt; address, which is the address of the host machine.
&gt;
&gt; and then you can assign _another_ IP to the guest or must assign the same?

A different IP or the two will fight during ARP resolution with both the 
host and the guest trying to claim the IP address.

&gt;&gt; Basically a bridge is like a virtual ethernet switch inside your
&gt;&gt; machine, where one port is connected to each device that is enslaved to
&gt;&gt; it and another port is connected to the kernel's IP stack - that port
&gt;&gt; appears as the brN interface and can have an IP address (for the host)
&gt;&gt; assigned to it.
&gt;
&gt; but, my main doubts is about to have a sever with several nics and several
&gt; guest. I think that a good approach (if it's possbile) is to have a an
&gt; specific nic for each guest. No?

Sure if you've got spare nic's in the host or you need maximum 
performance then that may well be a good idea.

The single nic case that I described is more for the average person 
running a few vms on their workstation.

Tom

-- 
Tom Hughes (tom@compton.nu)
http://compton.nu/

</body></email><email><emailId>20100701113743</emailId><senderName>David W King</senderName><senderEmail>davidwk@goshen.edu</senderEmail><timestampReceived>2010-07-01 11:37:43-0400</timestampReceived><subject>[libvirt-users] qemu+ssh auth with different identity files</subject><body>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

I'm trying to get qemu+ssh auth working but I need to be able to specify
an identity file to use for the ssh connection.  Based on what I read at
http://libvirt.org/remote.html I tried

virsh -c
"qemu+ssh://root@xhost1/system?command=/usr/bin/ssh%20-i%20/path/to/my/identity/file/id_rsa"
list

which returns

error: cannot recv data: Connection reset by peer
error: failed to connect to the hypervisor

I've also tried

virsh -c
"qemu+ext://root@xhost1/system?command=/usr/bin/ssh%20-i%20/path/to/my/identity/file/id_rsa"
list

but that just seg faults right away.  Is there something I'm missing or
is there a better way to do this?

~david

- -- 
David King
Goshen College ITS
davidwk@goshen.edu
574-535-7726

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAkwsfgcACgkQH+/Vg7DylXZwNACgokhTalESNjigypXA2kAlP8gp
etkAn3aEwJN1kJSPCkkIr09wBjwGD14r
=lC67
-----END PGP SIGNATURE-----

</body></email><email><emailId>20100701180614</emailId><senderName>Dave Allan</senderName><senderEmail>dallan@redhat.com</senderEmail><timestampReceived>2010-07-01 18:06:14-0400</timestampReceived><subject>Re: [libvirt-users] C API example</subject><body>

On Wed, Jun 30, 2010 at 07:37:27PM -0700, steven765@yahoo.com wrote:
&gt; I think so, but I'm locked out at home. I'll have to try at school tomorrow.  It \
&gt; gave me a remote error, but with the correct directory so fingers crossed thanks!   \
&gt;  btw might you or anyone know what I have to include to start a clean project of my \
&gt; own?  So if I want to just build an application that uses the API with nothing else \
&gt; but what's necessary?

If you're talking about a C application, you're pretty much describing
hellolibvirt.  I tried to put enough in there to demonstrate a couple
of different calls, but hopefully not so much that it's overwhelming.
If it seems like there's a lot there, cut some of it out.  You don't
need the showDomains function, for example.  Remove it, compile and
see what happens.

Dave


&gt; Thanks,
&gt; Steve
&gt; 
&gt; --- On Wed, 6/30/10, Justin Clift &lt;justin@salasaga.org&gt; wrote:
&gt; 
&gt; &gt; From: Justin Clift &lt;justin@salasaga.org&gt;
&gt; &gt; Subject: Re: [libvirt-users] C API example
&gt; &gt; To: "Dave Allan" &lt;dallan@redhat.com&gt;
&gt; &gt; Cc: steven765@yahoo.com, libvirt-users@redhat.com
&gt; &gt; Date: Wednesday, June 30, 2010, 10:09 PM
&gt; &gt; On 07/01/2010 11:54 AM, Dave Allan
&gt; &gt; wrote:
&gt; &gt; &lt;snip&gt;
&gt; &gt; &gt; ./hellolibvirt \
&gt; &gt; &gt; 
&gt; &gt; qemu+unix:///system?socket=/var/run/libvirt/libvirt-sock
&gt; &gt; 
&gt; &gt; Thanks Dave.  The +unix:// and ?socket=xxx bits are
&gt; &gt; what I'd not been picking up on.  Should be good now.
&gt; &gt; 
&gt; &gt; Steven, is it working for you?
&gt; &gt; 
&gt; &gt; Regards and best wishes,
&gt; &gt; 
&gt; &gt; Justin Clift
&gt; &gt; 
&gt; &gt; -- Salasaga  -  Open Source eLearning IDE
&gt; &gt; http://www.salasaga.org
&gt; &gt; 
&gt; 
&gt; 
&gt; 


</body></email><email><emailId>20100701180925</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2010-07-01 18:09:25-0400</timestampReceived><subject>[libvirt-users] ANNOUNCE: ruby-libvirt bindings 0.2.0</subject><body>

Hello all,
     I'm pleased to announce the release of 0.2.0 of the ruby-libvirt bindings.
This release has a number of new features:

- Updated Storage class, implementing pool.active?, pool.persistent?,
  pool.vol_create_xml_from
- Updated Connect class, implementing conn.node_free_memory,
  conn.node_cells_free_memory, conn.node_get_security_model, conn.encrypted?,
  conn.libversion, and conn.secure?
- Updated Network class, implementing network.active? and network.persistent?
- Update Domain class, implementing conn.domain_xml_from_native,
  conn.domain_xml_to_native, dom.migrate_to_uri, dom.migrate_set_max_downtime,
  dom.managed_save, dom.has_managed_save?, dom.managed_save_remove,
  dom.security_label, dom.block_stats, dom.memory_stats, dom.blockinfo,
  dom.block_peek, dom.memory_peek, dom.active?, dom.persistent?,
  dom.snapshot_create_xml, dom.num_of_snapshots, dom.list_snapshots,
  dom.lookup_snapshot_by_name, dom.has_current_snapshot?,
  dom.revert_to_snapshot, dom.current_snapshot, snapshot.xml_desc,
  snapshot.delete, dom.job_info, and dom.abort_job
- Implementation of the NodeDevice class
- Implementation of the Secret class
- Implementation of the NWFilter class
- Implementation of the Interface class
- Conversion of the development tree to git
- New maintainer (me).  David Lutterkort has agreed to transfer maintainership
  of the bindings over to me, since he is not actively involved in their
  development anymore.

With the above list, almost all of the APIs up to and including libvirt 0.8.1
are covered.  There are a few that I have not yet had time to implement; you
can look at the list of FIXMEs in the source code to find them.

I've uploaded new tarballs and source RPMs to: http://libvirt.org/ruby/download/
The new git repo is here: http://libvirt.org/git/?p=ruby-libvirt.git;a=summary
The documentation for the new API's are here: http://libvirt.org/ruby/api/index.html

If you have time, and are interested in the bindings, please give these new
ones a whirl and let me know if they work for you.  As usual, if you have
any questions, problems, patches, or bug reports, feel free to email the
libvirt development list (and CC me) so that I can take a look at them.

--
Chris Lalancette

</body></email><email><emailId>20100703110928</emailId><senderName>Guido Winkelmann</senderName><senderEmail>guido-libvi@unknownsite.de</senderEmail><timestampReceived>2010-07-03 11:09:28-0400</timestampReceived><subject>Re: [libvirt-users] ESXi support</subject><body>

On Saturday 03 July 2010 02:39:56 adrian wyssen wrote:
&gt; Hello everyone,
&gt; 
&gt; I want to use libvirt to manage an Vmware ESXi 4.0 server from within a
&gt; virtual machine running on that server. I did not find any C examples using
&gt; ESX(i). Can anyone give me some example code, because I am really new in
&gt; this domain and I can't get started... I don't find any information about
&gt; using libvirt with ESX(i), even if it is supposed to work with it.

See this page:

http://libvirt.org/drvesx.html

Basically, you just use "esx" as the protocol in the uri to connect to.

The rest /should/ work as with any any other backend driver, though last time 
I tried that, it didn't yet have any support for creating volumes, which made 
the whole thing useless in practice for me.

	Guido

</body></email><email><emailId>20100704173855</emailId><senderName>angelo alfano</senderName><senderEmail>angeloalfa76@yahoo.it</senderEmail><timestampReceived>2010-07-04 17:38:55-0400</timestampReceived><subject>[libvirt-users] (no subject)</subject><body>

Dear friend,
  Good day.I have a Japanese friend,His company is holding a promoting action, I hope \
you may join it,the company sell some electronic products such as motorbike,GPS \
notebook laptop,TV,cellphone,camera,psp. they are made in Korea,Japan and so on.the \
price is very low .if you want to buy it ,please visit    www.oanls3.com/   and \
choose the products you like,and their company may handsel   some small products as \
gift. if you are satisfied with the product after you receive it,please introduce it \
to your friends. thank you , have a nice day.


      


[Attachment #3 (text/html)]

&lt;table cellspacing="0" cellpadding="0" border="0" &gt;&lt;tr&gt;&lt;td valign="top" style="font: \
inherit;"&gt;Dear friend,&lt;BR&gt;Good day.I have a Japanese friend,His company is \
holding a promoting action, I hope you may join it,the company sell some electronic \
products such as motorbike,GPS notebook laptop,TV,cellphone,camera,psp. they are made \
in Korea,Japan and so on.the price is very low .if you want to buy it ,please visit \
 &lt;A href="http://www.oanls3.com/"&gt;www.oanls3.com/&lt;/A&gt; and choose the \
products you like,and their company may handsel some small products as gift. if \
you are satisfied with the product after you receive it,please introduce it to your \
friends.&lt;BR&gt;thank you , have a nice day.&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;br&gt;



      



</body></email><email><emailId>20100703003956</emailId><senderName>adrian wyssen</senderName><senderEmail>wyssenadrian@gmail.com</senderEmail><timestampReceived>2010-07-03 00:39:56-0400</timestampReceived><subject>[libvirt-users] ESXi support</subject><body>

Hello everyone,

I want to use libvirt to manage an Vmware ESXi 4.0 server from within a
virtual machine running on that server. I did not find any C examples using
ESX(i). Can anyone give me some example code, because I am really new in
this domain and I can't get started... I don't find any information about
using libvirt with ESX(i), even if it is supposed to work with it.
I thank you for any information.
Adrian

[Attachment #3 (text/html)]

Hello everyone,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I want to use libvirt to manage an Vmwar=
e ESXi 4.0 server from within a virtual machine running on that server. I d=
id not find any C examples using ESX(i). Can anyone give me some example co=
de, because I am really new in this domain and I can't get started... I=
 don't find any information about using libvirt with ESX(i), even if it=
 is supposed to work with it.&lt;/div&gt;
&lt;div&gt;I thank you for any information.&lt;/div&gt;&lt;div&gt;Adrian&lt;/div&gt;


</body></email><email><emailId>20100708004737</emailId><senderName></senderName><senderEmail>steven765@yahoo.com</senderEmail><timestampReceived>2010-07-08 00:47:37-0400</timestampReceived><subject>[libvirt-users] Blockpeek.. A little help please</subject><body>

Hi, 
   I'm trying to use blockpeek to open the contents of a file.  Inside the vm i ran \
debugfs: imap /test/findme   and got: inode 32642 is part of block group 4 located at \
block 131074, offset 0x0100

I try using 0x100 or 256 as the offset to blockpeek into that VM and get nonsense as \
a result.

Am I calculating the offset incorrectly, is there a better way to find a file's \
location on disk? And then open it? 

I'm just printing the return as a string from the buffer looping over size.  Is that \
incorrect?  Thanks again,
Steve 


      


</body></email><email><emailId>20100705161104</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2010-07-05 16:11:04-0400</timestampReceived><subject>[libvirt-users] Release of libvirt-0.8.2</subject><body>

  Following Dan advice, I decided to not wait for more patches and push
the current git head as the release. Let's plan to have another release
by this month end with the QEmu debugging and hacking APIs.
  The release is available as usual at ftp://libvirt.org/libvirt

  Quite a lot of bug fixes during the two months since 0.8.1, and
a few new feature. It also tagged more commits as being documentation
or portability fixes, it's good :-)

Features:
- phyp: adding support for IVM (Eduardo Otubo)
- libvirt: introduce domainCreateWithFlags API (Eric Blake)
- add 802.1Qbh and 802.1Qbg switches handling (Stefan Berger)
- Support for VirtualBox version 3.2 (Jean-Baptiste Rouault)
- Init script for handling guests on shutdown/boot (Jiri Denemark)
- qemu: live migration with non-shared storage for kvm (Kenneth Nagin)

Documentation:
- html docs: add link to PHP bindings by Radek Hladik (Justin Clift)
- virsh: document attach-disk better (Eric Blake)
- bridge_driver.c: fix file description (Alan Pevec)
- nwfilter: extensions of docs with (Stefan Berger)
- Fix description of virStorageVolGetInfo() (Philipp Hahn)
- virsh: improve help text for vol query commands (Justin Clift)
- virsh: fixed trivial comment and debug message in vshCommandOptVolBy function (Justin Clift)
- virsh: remove xen reference in header comment (Justin Clift)
- virsh: add the volume commands to the virsh man page (Justin Clift)
- virsh: fix minor virsh man page typos and formatting problems (Justin Clift)
- Trivial virsh.pod additions --all for "list" command and similar (Justin Clift)
- Add docs on drive &lt;serial&gt; element ( )
- daemon: sysconf: Update comment about VNC audio (Cole Robinson)
- nwfilter: documentation (Stefan Berger)
- docs: distribute more coding convention documentation (Eric Blake)
- note a typo: VIR_MIGRATE_TUNNELLED should be VIR_MIGRATE_TUNNELED, (Jim Meyering)
- datatypes: fix comment typo (Eric Blake)
- Fix a typo in docs (Ersek Laszlo)
- docs: hacking: explain why using curly braces well is important (Jim Meyering)

Portability:
- cgroup: Fix compilation broken on MinGW due to dirent-&gt;d_type (Ryota Ozaki)
- parthelper: fix compilation without optimization (Eric Blake)
- build: fix some mingw issues (Eric Blake)
- build: avoid pthreads-win32 on mingw (Eric Blake)
- build: fix cygwin build, correctly this time (Eric Blake)
- build: fix up some compiler flags (Eric Blake)
- build: avoid compile failure on linux kernels older than 2.6.19 (Jim Meyering)
- libvirt_proxy: link with -lpthread if needed (Eric Blake)
- build: allow older gettext (Eric Blake)
- mingw32-libvirt.spec: bring up to date (Eric Blake)
- avoid link error in tests using libvirt_util; due to pthread_sigmask (Jim Meyering)
- configure.ac: Avoid uname, which breaks cross-compilation (Matthias Bolte)
- mingw: Fix two undefined symbols (Matthias Bolte)
- build: avoid compiler warning (Eric Blake)
- build: prefer WIN32 over __MINGW32__ checks (Eric Blake)
- dnsmasqReload: avoid mingw link failure (Eric Blake)
- mingw: Fix symbol export (Matthias Bolte)

Bug Fixes:
- Avoid invoking the qemu monitor destroy callback if the constructor fails (Daniel P. Berrange)
- cgroup: Add missing errno == ENOENT check in virCgroupRemoveRecursively (Ryota Ozaki)
- Fix crash when detaching devices from qemu domains. (Chris Lalancette)
- virFileResolveLink: guarantee an absolute path (Eric Blake)
- phyp: don't steal storage management from other drivers (Eric Blake)
- Avoid calling virStorageFileIsSharedFS with NULL (Laine Stump)
- lxc: Fix virsh console doesn't work after restarting libvirtd (Ryota Ozaki)
- lxc: Fix error handlings in lxcContainerRenameAndEnableInterfaces (Ryota Ozaki)
- Set proper selinux label on image file during qemu domain restore (Laine Stump)
- build: fix regression with libvirt-api.xml generation (Eric Blake)
- Fix a reference leak for node devices. (Chris Lalancette)
- Don't squash file permissions when migration fails (Daniel P. Berrange)
- Fix migration in text mode and shared storage migration in json mode (Daniel P. Berrange)
- Add missing parameter in python Disk IO error callback (Daniel P. Berrange)
- Check for presence of qemu -nodefconfig option before using it (Laine Stump)
- cgroup: Change virCgroupRemove to remove all descendant groups at first (Ryota Ozaki)
- Fix reference handling leak on qemuMonitor (Daniel P. Berrange)
- Don't leak open fd to virsh in libvirt-guests init script (Jiri Denemark)
- nwfilter: fix loadable module support (Stefan Berger)
- Do not free static buffer with UUID (Jiri Denemark)
- qemu: Fix crash on failed VM startup (Cole Robinson)
- Add several missing vir*Free calls in libvirtd's remote code (Matthias Bolte)
- Fix enumeration of partitions in disks with a trailing digit in path (Daniel P. Berrange)
- vbox: check getenv("DISPLAY") for NULL in vboxDomainDumpXML (Matthias Bolte)
- Check getenv("PATH") for NULL in virFindFileInPath (Matthias Bolte)
- Fix cgroup setup code to cope with root squashing NFS (Daniel P. Berrange)
- Fix leaks in udev device add/remove v3 (David Allan)
- Ensure that PCI device is reattached to host if hotadd fails (Daniel P. Berrange)
- Don't raise errors in the selinux restore code (Daniel P. Berrange)
- Fix check for errors in device_add command in QEMU text monitor (Daniel P. Berrange)
- Network duplicate UUID/name checking (Daniel P. Berrange)
- Storage pool duplicate UUID/name checking (Daniel P. Berrange)
- Fix auto-adding of virtio serial controllers (Daniel P. Berrange)
- Ensure UNIX domain sockets are removed on daemon shutdown (Daniel P. Berrange)
- Fix AppArmor save/restore.Add stdin_path to qemudStartVMDaemon() args. (Jamie Strandboge)
- Adjust block size used by dd to speed QEMU domain save operations. (Laine Stump)
- Fix dereference of potentially freed pointer in qemudDomainSaveFlags (Laine Stump)
- Update nodedev scsi_host data before use (David Allan)
- Fix device destroy return value (David Allan)
- storage: Check for invalid storage mode before opening (Cole Robinson)
- Improve nodedev parent/child relationships (David Allan)
- network: bridge: Don't start network if it collides with host routing (Cole Robinson)
- Fix integer overflow in hotplug methods (Daniel P. Berrange)
- Fix failing virGetHostname. (Chris Lalancette)
- storage: Sanitize pool target paths (Cole Robinson)
- Fix handling of disk backing stores with cgroups (Daniel P. Berrange)
- Fix up basic migration. (Chris Lalancette)
- qemu: Release bus address on PCI host device remove (Alex Williamson)
- qemu: avoid corrupting guest info struct on host device PCI hot add (Alex Williamson)
- Query block allocation extent from QEMU monitor (Daniel P. Berrange)
- Don't overwrite virDomainAssignDef errors. (Chris Lalancette)
- Fix race in finding available vnc port (Jim Fehlig)
- qemu driver: fix version check typos (Chris Wright)
- daemon: A few initscript corrections (Cole Robinson)
- qemu: Properly cleanup in security startup error path (Cole Robinson)
- qemudDomainMigrateFinish2: handle a case of virDomainSaveStatus failure (Jim Meyering)
- Fix potential NULL dereference in remoteDomainMigratePrepare2 (Jiri Denemark)
- qemudDomainRestore: handle a case of virDomainSaveStatus failure (Jim Meyering)
- python: don't ignore virInitialize failure in module initialization (Jim Meyering)
- tests: do not ignore virInitialize failure (Jim Meyering)
- qemuMonitorTextMigrate: avoid leak on OOM-error path (Jim Meyering)
- virNWFilterDefParseXML: avoid leak on error paths (Jim Meyering)
- virDomainNetDefParseXML: avoid leak upon multiple "filterref" (Jim Meyering)
- ebiptablesWriteToTempFile: don't close a negative file descriptor (Jim Meyering)
- Protect against NULL pointer flaws in monitor usage (Daniel P. Berrange)
- Fix multiple potential NULL pointer references in monitor usage (Daniel P. Berrange)
- umlAutostartDomain: avoid NULL-deref upon virGetLastError failure (Jim Meyering)
- x86ModelHasFeature: avoid NULL-dereference for unmatched CPU "feature" (Jim Meyering)
- qemudDomainSetVcpus: avoid NULL-deref (Jim Meyering)
- nwfilter: Add missing driver lock in qemu driver (Stefan Berger)
- Fix a misuse of virAsprintf in qemudDomainMemoryPeek (Ryota Ozaki)
- Don't reset user/group/security label on shared filesystems during migrate (Daniel P. Berrange)
- Fix handling of disk backing stores with cgroups (Daniel P. Berrange)
- Fix possible crash in handling IO Error event (Daniel P. Berrange)
- Fix monitor ref counting when adding event handle (Jiri Denemark)
- Remove watches before calling REMOTE_PROC_CLOSE (Jiri Denemark)
- node_device: udev: Fix PCI product/vendor swappage (Cole Robinson)
- virsh: schedinfo --set invalid=value would simply ignore the option (Jim Meyering)
- Remove unused nwfilter field from struct remote_error (Matthew Booth)
- util: fix va_start usage bug (Eric Blake)
- Don't wipe generated iface target in active domains (Jiri Denemark)
- Various fixes for the spec file (Daniel Veillard)
- lxc: Check domain is active/inactive as required by operation (Jiri Denemark)
- lxc: Make SetMemory work for active domains only (Jiri Denemark)
- cgroup: Fix possible memory leak in virCgroupMakeGroup (Ryota Ozaki)
- Fix memory leaks in cmdInterfaceEdit and cmdNWFilterEdit. (Laine Stump)
- lxc: Fix failure on starting a domain with multiple interfaces (Ryota Ozaki)

Improvements:
- vbox: Let configure detect/set the XPCOMC directory (Matthias Bolte)
- udev: Parse PCI devices even if libpciaccess fails (Cole Robinson)
- qemu: Improve some qemu.conf error reporting (Cole Robinson)
- util: virExec: Dispatch all errors raised after fork (Cole Robinson)
- virsh: tweak help output for VSH_OT_DATA (Eric Blake)
- Check for active PCI devices when doing nodedevice operations. (Chris Lalancette)
- virsh: add new --details option to pool-list (Justin Clift)
- Selectively ignore domainSetSecurityAllLabel failure in domain restore (Laine Stump)
- use virStorageFileIsSharedFS utility function in qemudDomainSaveFlag (Laine Stump)
- Enhance virStorageFileIsSharedFS (Laine Stump)
- phyp: optimize use of sed (Eric Blake)
- phyp: add storage management driver (Eduardo Otubo)
- phyp: add rudimentary storage driver (Eduardo Otubo)
- maint: add gnulib gettimeofday module (Eric Blake)
- Avoid blocking all APIs during incoming migration (Daniel P. Berrange)
- Set labelling for character devices in security drivers (Daniel P. Berrange)
- Add API for iterating over all character devices (Daniel P. Berrange)
- Adding Storage Management driver (style and indentation) (Eduardo Otubo)
- esx: Add support for the controller element (Matthias Bolte)
- Add optional model attribute to the controller element (Matthias Bolte)
- Add wide SCSI bus disk address generation support (Matthias Bolte)
- cgroup: Enable memory.use_hierarchy of cgroup for domain (Ryota Ozaki)
- network: allow tftp port if tftp is defined (Alan Pevec)
- Add '-nodefconfig' command line arg to QEMU (Daniel P. Berrange)
- Make checks for inactive QEMU guest more robust (Daniel P. Berrange)
- Improve some error messages about unsupported APIs/URIs (Daniel P. Berrange)
- Index hashes by UUID instead of name (Jiri Denemark)
- Allow one-or-more &lt;boot dev="..."/&gt; entries (Philipp Hahn)
- virsh: add --uuid option to vol-pool (Justin Clift)
- nwfilter: add XML attribute to control iptables state match (Stefan Berger)
- virsh: ensure persistence and autostart are shown for dominfo and pool-info (Justin Clift)
- nwfilter: use match target on incoming traffic (Stefan Berger)
- macvtap: work-around for 2.6.32 and older kernels (Stefan Berger)
- virsh: add pool support to vol-key command (Justin Clift)
- esx: Update case insensitive .vmx tests (Matthias Bolte)
- esx: Accept 'disk' as harddisk device type in .vmx files (Matthias Bolte)
- virsh: mark autostart answers for translation (Justin Clift)
- virsh: add start --paused support (Eric Blake)
- qemu: support starting persistent domain paused (Eric Blake)
- drivers: add virDomainCreateWithFlags if virDomainCreate exists (Eric Blake)
- remote: protocol implementation for virDomainCreateWithFlags (Eric Blake)
- uml: sanity check external data before using it (Eric Blake)
- Improve error message for disabled client-side drivers (Matthias Bolte)
- virsh: add snapshot backing store support to vol-create-as (Justin Clift)
- esx: Add proxy query parameter (Matthias Bolte)
- esx: Refactor esxUtil_ParseQuery's parameter handling (Matthias Bolte)
- virsh: add new vol-pool command (Justin Clift)
- virsh: add --paused option to create (Eric Blake)
- qemu: allow creation of a paused domain (Eric Blake)
- virDomainCreateXML: support new flag (Eric Blake)
- Add multiIQN tests (David Allan)
- Add multiiqn XML dump (David Allan)
- Fix test breakage from virtio serial changes (Daniel P. Berrange)
- Enable probing of VPC disk format type (Daniel P. Berrange)
- Prefer UDEV to HAL drivers if both a compiled (Daniel P. Berrange)
- Add support for setting socket MLS level in SELinux driver (Daniel J Walsh)
- Fix error codes for missing storage pools (Daniel P. Berrange)
- Include port number with virtio serial devices (Daniel P. Berrange)
- Disable use of 'reason' field in block IO event in QEMU (Daniel P. Berrange)
- Add stdin_path to qemudStartVMDaemon() args. (Jamie Strandboge)
- Allocate buffer to hold xend response (Jim Fehlig)
- phyp: Strict check when listing domains (Eduardo Otubo)
- hostusb: Properly handle 'usbX' sysfs files (Cole Robinson)
- Add --source-format argument to virsh pool-define-as and pool-create-as (Justin Clift)
- Add --source-format argument to virsh pool-define-as and pool-create-as (Justin Clift)
- build: fix VPATH 'make syntax-check' (Eric Blake)
- qemu: Add a qemu.conf option for clearing capabilities (Cole Robinson)
- macvtap: cannot support target device name (Stefan Berger)
- Fix libvirt-guests init script (Jiri Denemark)
- maint: new syntax-check rule to ensure that AUTHORS stays in sync (Jim Meyering)
- maint: update AUTHORS with recent contributors (Eric Blake)
- xen: Fix chardev listen sexpr formatting (Cole Robinson)
- v2 of Cole's wlan support (David Allan)
- Install, distribute and package domainsnapshot.rng (Matthias Bolte)
- build: support 'make check' in pristine tree (Eric Blake)
- esx: Expose host UUID in the capabilities XML (Matthias Bolte)
- Pass pre-opened PCI device sysfs config file to QEMU (Alex Williamson)
- xen-proxy build broken (Matthias Bolte)
- esx: Add read-only storage pool access (Matthias Bolte)
- libvirtd: diagnose invalid host UUID (Jim Meyering)
- vepa: parsing for 802.1Qb{g|h} XML (Stefan Berger)
- vepa+vsi: Introduce dependency on libnl (Stefan Berger)
- Expose a host UUID in the capabilities XML (Daniel P. Berrange)
- qemu: Allow using regular audio backends with VNC (Cole Robinson)
- lxcSetSchedulerParameters: reverse order of tests; diagnose a failure (Jim Meyering)
- libvirtd: start each diagnostic with "argv0: " (Jim Meyering)
- libvirtd: mark strings for translation, including --help output (Jim Meyering)
- build: force init scripts to rebuild on changed --prefix (Eric Blake)
- build: Distribute the whole tests/qemuhelpdata directory (Matthias Bolte)
- Add defines for QEMU_VNC_PORT_{MIN,MAX} and use them (Jim Fehlig)
- Add simple bitmap operations to utils (Jim Fehlig)
- daemon: Export SDL audio environment variables (Cole Robinson)
- Autostart domains using virDomainObjStart (Jiri Denemark)
- maint: update po/POTFILES.in (Jim Meyering)
- maint: enforce policy wrt VIR_DEBUG and VIR_DEBUG0 (Jim Meyering)
- maint: enforce policy wrt VIR_ERROR and VIR_ERROR0 (Jim Meyering)
- maint: change "" in err ? err-&gt;message : "" to _("unknown error"), ... (Jim Meyering)
- qemu: Use ShutdownVMDaemon for all startup cleanup paths (Cole Robinson)
- Domain snapshot RNG and tests. (Chris Lalancette)
- Fix up the python bindings for snapshotting. (Chris Lalancette)
- qemu_conf.c: also recognize new first line of qemu -help output (Jim Meyering)
- lxc_controller.c: don't ignore failed "accept" (Jim Meyering)
- qemu: Don't deny ShutdownVMDaemon for non-running VMs (Cole Robinson)
- libvirtd: don't ignore virInitialize failure (Jim Meyering)
- maint: prohibit newline at end of diagnostic (Jim Meyering)
- maint: remove unwanted newline at end of diagnostic (Jim Meyering)
- build: distribute missing file (Eric Blake)
- esx: Make esxVI_*_CastFromAnyType dynamically dispatched (Matthias Bolte)
- esx: Allow esxVI_X_DynamicCast to be called successfully on X objects (Matthias Bolte)
- tests: the remote_protocol check also accommodates older pdwtags (Jim Meyering)
- maint: enforce no-markup policy wrt VIR_WARN-like macros (Jim Meyering)
- Add support for SSE4.1 and SSE4.2 CPU features (Jiri Denemark)
- maint: add more free-like functions to the list and deal with fallout (Jim Meyering)
- maint: add virCgroupFree to the list of free-like functions (Jim Meyering)
- qemudDomainSetVcpus: avoid NULL-deref on failed uuid look-up (Jim Meyering)
- Add CIFS to the list of network file systems (Matthias Bolte)
- Add VIR_STORAGE_POOL_INACCESSIBLE to denote inaccessible storage pools (Matthias Bolte)
- qemu_conf: fix flag value (Eric Blake)
- qemu: Clarify a couple error messages (Cole Robinson)
- virFileResolveLink: fix return value (Eric Blake)
- tests: Skip daemon-conf test if dir exceeds UNIX_PATH_MAX (Cole Robinson)
- pci: Give an explicit error if device not found (Cole Robinson)
- qemu: Report cmdline output if VM dies early (Cole Robinson)
- qemu_driver: avoid NULL dereference (Jim Meyering)
- Make domain save work when dynamic_ownership=0 (Daniel P. Berrange)
- Add support for NIC hotplug using netdev_add in QEMU (Daniel P. Berrange)
- build: update gnulib (Eric Blake)
- tests: correct PATH in new test, for when running manually (Jim Meyering)
- Add env variable for debugging gnutls usage (Daniel P. Berrange)
- maint: allow VPATH use of remote_protocol-structs (Eric Blake)
- help avoid accidental remote_protocol.x changes (Jim Meyering)
- build: use LIBADD, not LDFLAGS, for adding libraries (Eric Blake)
- Implement SCSI disk unplugging (Wolfgang Mauerer)
- qemu: use better types (Eric Blake)
- Refactor disk unplugging (Wolfgang Mauerer)
- build: simplify checks for sched.h (Eric Blake)
- build: use gnulib's sys/wait.h (Eric Blake)
- build: use gnulib's uname (Eric Blake)
- build: rely on gnulib's pthread module (Eric Blake)
- rpmbuild: add ebtables &amp; ip(6)tables dependency for rpm (Stefan Berger)
- lxc: Use virDomainFindByUUID for domain lookup (Jiri Denemark)
- nwfilter: skip some interfaces on filter update (Stefan Berger)
- pass info where request stems from to have rules applied (Stefan Berger)
- dnsmasq.c: Fix OOM error reporting (Matthias Bolte)
- autobuild.sh: provide default prefix (Eric Blake)

Cleanups:
- lxc: Change VIR_ERROR to VIR_DEBUG for just a debugging message (Ryota Ozaki)
- phyp: reduce scope of driver functions (Eric Blake)
- Fix test case failure due to missing -nodefconfig (Daniel P. Berrange)
- esx: Use bool instead of int where appropriated (Matthias Bolte)
- Cleanup some LIBADD and CFLAGS (Matthias Bolte)
- virsh: remove a doubled up include for errno.h (Justin Clift)
- Misc cleanups (Jiri Denemark)
- Remove unnecessary check for non-NULL uuid (Jiri Denemark)
- qemu: reduce file padding requirements (Eric Blake)
- virsh: change printf() calls to vshPrint() (Justin Clift)
- phyp: sed cleanups (Eric Blake)
- maint: simplify some ignore files (Eric Blake)
- avoid syntax-check failure (Jim Meyering)
- autobuild.sh: avoid bashism (Eric Blake)
- bitmap: reject zero-size bitmap (Eric Blake)
- build: depend on correct file (Eric Blake)
- build: make cpp indentation conform (Jim Meyering)
- hooks: fix typo (Paolo Smiraglia)
- build: silence cppi warning, clarify vbox headers (Eric Blake)
- xen: Remove unused function (Cole Robinson)
- esx: Simplify goto usage (Matthias Bolte)
- Use printf instead of echo -e in libvirt.spec.in (Matthias Bolte)
- build: fix HTML errors in nwfilter docs (Eric Blake)
- build: fix compilation without macvtap (Eric Blake)
- tests: avoid new failure of the daemon-conf test (Jim Meyering)
- storage: mpath: Fix incorrect VIR_ERROR use (Cole Robinson)
- Allow nwfilter functions to be compiled with C++ (Chris Lalancette)
- storage: Combine some duplicate code (Cole Robinson)
- storage: mpath: Clean up some error handling (Cole Robinson)
- Remove dead code after refactoring qemudDomainStart (Jiri Denemark)
- build: fix cppi warnings (Eric Blake)
- Remove isValidIfname. (Chris Lalancette)
- Refactor qemudDomainStart (Jiri Denemark)
- Factor out def assignment to existing domain from virDomainAssignDef (Jiri Denemark)
- Refactor qemudDomainRestore (Jiri Denemark)
- maint: don't mark VIR_DEBUG or VIR_DEBUG0 diagnostics for translation (Jim Meyering)
- maint: more of same, but manual: convert VIR_ERROR("%s" to VIR_ERROR0( (Jim Meyering)
- maint: VIR_ERROR/VIR_ERROR0: mark up the remaining ones manually (Jim Meyering)
- maint: mark translatable string args of VIR_ERROR (Jim Meyering)
- maint: mark translatable string args of VIR_ERROR0 (Jim Meyering)
- maint: use VIR_ERROR0 rather than VIR_ERROR with a bare "%s" (Jim Meyering)
- qemu: Remove explicit VNC XML cleanup (Cole Robinson)
- Rename qemuBuildCommandLine tapfds -&gt; vmfds. (Alex Williamson)
- initialize "meta" in virStorageFileGetMetadata, not in each caller (Jim Meyering)
- (qemu*DiskCgroup): avoid dead code (Jim Meyering)
- maint: more VIR_WARN corrections: now manually (Jim Meyering)
- maint: use VIR_WARN0("...") rather than VIR_WARN("%s", "...") (Jim Meyering)
- maint: remove _(...) from VIR_WARN arg manually (Jim Meyering)
- maint: don't mark VIR_WARN or VIR_WARN0 diagnostics for translation (Jim Meyering)
- do not ignore qemuMonitorAddDrive failure; make uses identical (Jim Meyering)
- ebtablesAddRemoveRule, iptablesAddRemoveRule: don't skip va_end (Jim Meyering)
- linuxNodeInfoCPUPopulate: avoid used-uninitialized via a test (Jim Meyering)
- lxcFreezeContainer: avoid test-after-deref of never-NULL pointer (Jim Meyering)
- Remove debugging fprintf() calls (Daniel P. Berrange)
- tests: use GPLv2+, not GPLv3 (Jim Meyering)
- tests: adjust copyrights on scripts: s/FSF/Red Hat/ (Jim Meyering)
- virsh: fix a typo in a diagnostic (Jim Meyering)
- delMacvtap: typo fix (Eric Blake)
- docs/Makefile.am: remove unnecessary subshells (Eric Blake)
- maint: avoid spurious output if program not present (Eric Blake)
- storage_encryption: silence clang warning (Eric Blake)
- maint: whitespace cleanups (Eric Blake)
- qemu: Fix warning about a non-literal format string (Matthias Bolte)
- build: drop more redundant configure checks (Eric Blake)
- build: silence a clang false positive (Eric Blake)


  Thanks to everybody who helped for this release by contributing
changes or reporting issues !

Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

</body></email><email><emailId>20100708170605</emailId><senderName>Camilo Aguilar</senderName><senderEmail>camilo@cloudescape.com</senderEmail><timestampReceived>2010-07-08 17:06:05-0400</timestampReceived><subject>[libvirt-users] virStream functions</subject><body>

May anybody tell me which is the porpose of virStream functions ?

Thanks in advance.

Camilo Aguilar

[Attachment #3 (text/html)]

May anybody tell me which is the porpose of virStream functions ?=C2=A0&lt;div=
&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks in advance.=C2=A0&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Camilo Ag=
uilar&lt;/div&gt;


</body></email><email><emailId>20100714154940</emailId><senderName>John Lumby</senderName><senderEmail>johnlumby@hotmail.com</senderEmail><timestampReceived>2010-07-14 15:49:40-0400</timestampReceived><subject>[libvirt-users] how to deactivate an active network with virsh? (and what is that anyway)</subject><body>

virsh provides 
         net-start &lt;netname-or-id&gt;
to activate an inactive network.


Does virsh provide any way to do the exact converse?   deactivate an active network \
without destroying, undefining, removing, ...


Also  -  I am curious   -  what does activate actually do?    What change in state of \
anything occurs?  ( I read the document at http://libvirt.org/formatnetwork.html  \
which the man page referred me to but it had nothing to say on this.   I did not try \
to read the code).    


John
 		 	   		  
_________________________________________________________________
MSN Dating: Find someone special. Start now.
http://go.microsoft.com/?linkid=9734384


[Attachment #3 (text/html)]

&lt;html&gt;
&lt;head&gt;
&lt;style&gt;&lt;!--
.hmmessage P
{
margin:0px;
padding:0px
}
body.hmmessage
{
font-size: 10pt;
font-family:Verdana
}
--&gt;&lt;/style&gt;
&lt;/head&gt;
&lt;body class='hmmessage'&gt;
virsh provides &lt;BR&gt;         net-start &lt;netname-or-id&gt;&lt;BR&gt;to activate an \
inactive network.&lt;BR&gt;&lt;br&gt;&lt;BR&gt;Does virsh provide any way to do the exact converse?   \
deactivate an active network without destroying, undefining, removing, \
...&lt;BR&gt;&lt;br&gt;&lt;BR&gt;Also  -  I am curious   -  what does activate actually do?    What \
change in state of anything occurs?&lt;BR&gt; ( I read the document at \
http://libvirt.org/formatnetwork.html  which the man page referred me to but it had \
nothing to say on this.   I did not try to read the code).    &lt;BR&gt;&lt;br&gt;&lt;BR&gt;John&lt;BR&gt; 		 \
&lt;br /&gt;&lt;hr /&gt;Enter for a chance to get your town photo on Bing.ca! &lt;a \
href='http://go.microsoft.com/?linkid=9734379' target='_new'&gt;Submit a Photo Now! \
&lt;/a&gt;&lt;/body&gt; &lt;/html&gt;



</body></email><email><emailId>20100716003728</emailId><senderName>George Goh</senderName><senderEmail>georgegoh@spodon.com</senderEmail><timestampReceived>2010-07-16 00:37:28-0400</timestampReceived><subject>[libvirt-users] ESX - How to create a new domain</subject><body>

Hi,

I've been trying to figure out how to create a new domain(create a new
virtual machine) using the ESX driver.

The documentation at http://libvirt.org/drvesx.html says:

To define a new domain the driver converts the domain XML into a VMware VMX
file and uploads it to a datastore known to the ESX server. Because multiple
datastores may be known to an ESX server the driver needs to decide to which
datastores the VMX file should be uploaded. The driver deduces this
information from the path of the source of the first file-based harddisk
listed in the domain XML.

But I can't find a way to do this in virsh. Any ideas?

-George

[Attachment #3 (text/html)]

Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I've been trying to figure out how to create a new \
domain(create a new virtual machine) using the ESX \
driver.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The documentation at &lt;a \
href="http://libvirt.org/drvesx.html" \
target="_blank"&gt;http://libvirt.org/drvesx.html&lt;/a&gt; says:&lt;/div&gt;

&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style="font-family:Verdana, Arial, Helvetica, \
sans-serif;font-size:13px"&gt;To define a new domain the driver converts the domain XML \
into a VMware VMX file and uploads it to a datastore known to the ESX server. Because \
multiple datastores may be known to an ESX server the driver needs to decide to which \
datastores the VMX file should be uploaded. The driver deduces this information from \
the path of the source of the first file-based harddisk listed in the domain \
XML.&lt;/span&gt;&lt;/div&gt;

&lt;div&gt;&lt;span style="font-family:Verdana, Arial, Helvetica, \
sans-serif;font-size:13px"&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style="font-size:13px"&gt;&lt;font \
face="arial, helvetica, sans-serif"&gt;But I can't find a way to do this in virsh. \
Any ideas? &lt;/font&gt;&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span style="font-size:13px"&gt;&lt;font face="arial, \
helvetica, sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span \
style="font-size:13px"&gt;&lt;font face="arial, helvetica, \
sans-serif"&gt;-George&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;



</body></email><email><emailId>20100715104247</emailId><senderName>Rajiv Rajaian</senderName><senderEmail>rajiv.care@gmail.com</senderEmail><timestampReceived>2010-07-15 10:42:47-0400</timestampReceived><subject>[libvirt-users] How to create a guest os from existing disk image file</subject><body>

Hi
I have configured KVM with Fedora Core 13 by enabling the KVM virtualization
option while installing OS.
I have successfully created the guest OS by using the virt-install API

/usr/sbin/virt-install --name centos5 --ram 512 --disk
path=/var/lib/libvirt/images/
centos.img,size=5 --network network:default --accelerate --vnc -c
/tmp/CentOS-5.3-i386-bin-DVD.iso

I am able to login to the guest OS using the virt-viewer command using vnc
Now i want to the guest os from the existing configured disk
/var/lib/libvirt/images/centos.img.. What modifications should be done with
my configuration file ??
Pleas help me to solve this.

[root@kvmcluster ~]# virsh dumpxml centos5
&lt;domain type='qemu' id='2'&gt;
  &lt;name&gt;centos5&lt;/name&gt;
  &lt;uuid&gt;cabfad09-ff8b-e1ca-051a-6729e301f6a1&lt;/uuid&gt;
  &lt;memory&gt;524288&lt;/memory&gt;
  &lt;currentMemory&gt;524288&lt;/currentMemory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='i686' machine='fedora-13'&gt;hvm&lt;/type&gt;
    &lt;boot dev='cdrom'/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
    &lt;apic/&gt;
    &lt;pae/&gt;
  &lt;/features&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;destroy&lt;/on_reboot&gt;
  &lt;on_crash&gt;destroy&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/bin/qemu&lt;/emulator&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;driver name='qemu' type='raw'/&gt;
      &lt;source file='/var/lib/libvirt/images/centos.img'/&gt;
      &lt;target dev='hda' bus='ide'/&gt;
      &lt;alias name='ide0-0-0'/&gt;
      &lt;address type='drive' controller='0' bus='0' unit='0'/&gt;
    &lt;/disk&gt;
    &lt;disk type='file' device='cdrom'&gt;
      &lt;driver name='qemu'/&gt;
      &lt;source file='/tmp/CentOS-5.3-i386-bin-DVD.iso'/&gt;
      &lt;target dev='hdc' bus='ide'/&gt;
      &lt;readonly/&gt;
      &lt;alias name='ide0-1-0'/&gt;
      &lt;address type='drive' controller='0' bus='1' unit='0'/&gt;
    &lt;/disk&gt;
    &lt;controller type='ide' index='0'&gt;
      &lt;alias name='ide0'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x01'
function='0x1'/&gt;
    &lt;/controller&gt;
    &lt;interface type='network'&gt;
      &lt;mac address='52:54:00:bf:32:c2'/&gt;
      &lt;source network='default'/&gt;
      &lt;target dev='vnet0'/&gt;
      &lt;alias name='net0'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x04'
function='0x0'/&gt;
    &lt;/interface&gt;
    &lt;serial type='pty'&gt;
      &lt;source path='/dev/pts/2'/&gt;
      &lt;target port='0'/&gt;
      &lt;alias name='serial0'/&gt;
    &lt;/serial&gt;
    &lt;console type='pty' tty='/dev/pts/2'&gt;
      &lt;source path='/dev/pts/2'/&gt;
      &lt;target port='0'/&gt;
      &lt;alias name='serial0'/&gt;
    &lt;/console&gt;
    &lt;input type='mouse' bus='ps2'/&gt;
    &lt;graphics type='vnc' port='5900' autoport='yes' keymap='en-us'/&gt;
    &lt;video&gt;
      &lt;model type='cirrus' vram='9216' heads='1'/&gt;
      &lt;alias name='video0'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x02'
function='0x0'/&gt;
    &lt;/video&gt;
  &lt;/devices&gt;
  &lt;seclabel type='dynamic' model='selinux'&gt;
    &lt;label&gt;system_u:system_r:svirt_t:s0:c370,c413&lt;/label&gt;
    &lt;imagelabel&gt;system_u:object_r:svirt_image_t:s0:c370,c413&lt;/imagelabel&gt;
  &lt;/seclabel&gt;
&lt;/domain&gt;




Thanks/Regards.
Rajiv.R
Project Associate.
CARE. MIT
Anna University Chennai

[Attachment #3 (text/html)]

Hi &lt;br&gt;I have configured KVM with Fedora Core 13 by enabling the KVM virtualization \
option while installing OS.&lt;br&gt;I have successfully created the guest OS by using the \
virt-install API&lt;br&gt;&lt;br&gt;/usr/sbin/virt-install --name centos5 --ram 512 --disk \
path=/var/lib/libvirt/images/&lt;div id=":yw" class="ii gt"&gt; centos.img,size=5 --network \
network:default --accelerate --vnc -c /tmp/CentOS-5.3-i386-bin-DVD.iso&lt;br&gt; &lt;br&gt;I am \
able to login to the guest OS using the virt-viewer command using vnc&lt;br&gt;Now i want \
to the guest os from the existing configured disk \
/var/lib/libvirt/images/centos.img.. What modifications should be done with my \
configuration file ??&lt;br&gt;

Pleas help me to solve this.&lt;br&gt;&lt;br&gt;[root@kvmcluster ~]# virsh dumpxml \
centos5&lt;br&gt;&lt;domain type='qemu' id='2'&gt;&lt;br&gt;  \
&lt;name&gt;centos5&lt;/name&gt;&lt;br&gt;  \
&lt;uuid&gt;cabfad09-ff8b-e1ca-051a-6729e301f6a1&lt;/uuid&gt;&lt;br&gt;

  &lt;memory&gt;524288&lt;/memory&gt;&lt;br&gt;  \
&lt;currentMemory&gt;524288&lt;/currentMemory&gt;&lt;br&gt;  &lt;vcpu&gt;1&lt;/vcpu&gt;&lt;br&gt; \
&lt;os&gt;&lt;br&gt;    &lt;type arch='i686' \
machine='fedora-13'&gt;hvm&lt;/type&gt;&lt;br&gt;

    &lt;boot dev='cdrom'/&gt;&lt;br&gt;  &lt;/os&gt;&lt;br&gt;  &lt;features&gt;&lt;br&gt;    \
&lt;acpi/&gt;&lt;br&gt;    &lt;apic/&gt;&lt;br&gt;    &lt;pae/&gt;&lt;br&gt;  &lt;/features&gt;&lt;br&gt;  \
&lt;clock offset='utc'/&gt;&lt;br&gt;  \
&lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;&lt;br&gt;

  &lt;on_reboot&gt;destroy&lt;/on_reboot&gt;&lt;br&gt;  \
&lt;on_crash&gt;destroy&lt;/on_crash&gt;&lt;br&gt;  &lt;devices&gt;&lt;br&gt;    \
&lt;emulator&gt;/usr/bin/qemu&lt;/emulator&gt;&lt;br&gt;    &lt;disk type='file' \
device='disk'&gt;&lt;br&gt;

      &lt;driver name='qemu' type='raw'/&gt;&lt;br&gt;      &lt;source \
file='/var/lib/libvirt/images/centos.img'/&gt;&lt;br&gt;      &lt;target \
dev='hda' bus='ide'/&gt;&lt;br&gt;      &lt;alias \
name='ide0-0-0'/&gt;&lt;br&gt;

      &lt;address type='drive' controller='0' bus='0' \
unit='0'/&gt;&lt;br&gt;    &lt;/disk&gt;&lt;br&gt;    &lt;disk type='file' \
device='cdrom'&gt;&lt;br&gt;      &lt;driver name='qemu'/&gt;&lt;br&gt;

      &lt;source file='/tmp/CentOS-5.3-i386-bin-DVD.iso'/&gt;&lt;br&gt;      \
&lt;target dev='hdc' bus='ide'/&gt;&lt;br&gt;      &lt;readonly/&gt;&lt;br&gt;    \
&lt;alias name='ide0-1-0'/&gt;&lt;br&gt;      &lt;address type='drive' \
controller='0' bus='1' unit='0'/&gt;&lt;br&gt;

    &lt;/disk&gt;&lt;br&gt;    &lt;controller type='ide' index='0'&gt;&lt;br&gt;  \
&lt;alias name='ide0'/&gt;&lt;br&gt;      &lt;address type='pci' \
domain='0x0000' bus='0x00' slot='0x01' \
function='0x1'/&gt;&lt;br&gt;

    &lt;/controller&gt;&lt;br&gt;    &lt;interface type='network'&gt;&lt;br&gt;      \
&lt;mac address='52:54:00:bf:32:c2'/&gt;&lt;br&gt;      &lt;source \
network='default'/&gt;&lt;br&gt;      &lt;target dev='vnet0'/&gt;&lt;br&gt;

      &lt;alias name='net0'/&gt;&lt;br&gt;      &lt;address type='pci' \
domain='0x0000' bus='0x00' slot='0x04' \
function='0x0'/&gt;&lt;br&gt;    &lt;/interface&gt;&lt;br&gt;    &lt;serial \
type='pty'&gt;&lt;br&gt;

      &lt;source path='/dev/pts/2'/&gt;&lt;br&gt;      &lt;target \
port='0'/&gt;&lt;br&gt;      &lt;alias name='serial0'/&gt;&lt;br&gt;    \
&lt;/serial&gt;&lt;br&gt;    &lt;console type='pty' \
tty='/dev/pts/2'&gt;&lt;br&gt;

      &lt;source path='/dev/pts/2'/&gt;&lt;br&gt;      &lt;target \
port='0'/&gt;&lt;br&gt;      &lt;alias name='serial0'/&gt;&lt;br&gt;    \
&lt;/console&gt;&lt;br&gt;    &lt;input type='mouse' bus='ps2'/&gt;&lt;br&gt;

    &lt;graphics type='vnc' port='5900' autoport='yes' \
keymap='en-us'/&gt;&lt;br&gt;    &lt;video&gt;&lt;br&gt;      &lt;model \
type='cirrus' vram='9216' heads='1'/&gt;&lt;br&gt;      &lt;alias \
name='video0'/&gt;&lt;br&gt;

      &lt;address type='pci' domain='0x0000' bus='0x00' \
slot='0x02' function='0x0'/&gt;&lt;br&gt;    &lt;/video&gt;&lt;br&gt;  \
&lt;/devices&gt;&lt;br&gt;  &lt;seclabel type='dynamic' \
model='selinux'&gt;&lt;br&gt;

    &lt;label&gt;system_u:system_r:svirt_t:s0:c370,c413&lt;/label&gt;&lt;br&gt;    \
&lt;imagelabel&gt;system_u:object_r:svirt_image_t:s0:c370,c413&lt;/imagelabel&gt;&lt;br&gt; \
&lt;/seclabel&gt;&lt;br&gt;&lt;/domain&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt; Thanks/Regards.&lt;br&gt;
Rajiv.R&lt;br&gt;Project Associate.&lt;br&gt;CARE. MIT &lt;br&gt;Anna University Chennai&lt;/div&gt;



</body></email><email><emailId>20100719055738</emailId><senderName>Rajiv Rajaian</senderName><senderEmail>rajiv.care@gmail.com</senderEmail><timestampReceived>2010-07-19 05:57:38-0400</timestampReceived><subject>[libvirt-users] How to create a guest os from existing disk image file with virt-install</subject><body>

Hi
I have configured KVM with Fedora Core 13 by enabling the KVM virtualization
option while installing OS.
I have successfully created the guest OS by using the virt-install API

/usr/sbin/virt-install --name centos5 --ram 512 --disk
path=/var/lib/libvirt/images/
centos.img,size=5 --network network:default --accelerate --vnc -c
/tmp/CentOS-5.3-i386-bin-DVD.iso

Os installed successfully and after rebooting am able to login to the guest
OS using the virt-viewer command using vnc viewer ..It shows

Booting from Hard Disk...
GRUB Loading stage2.....

But the guest os is not booted

I want to the create the guest os from existing configured disk
/var/lib/libvirt/images/centos.img.. What modifications should be done with
my configuration file ??
Pleas help me to solve this.

[root@kvmcluster ~]# virsh dumpxml centos5
&lt;domain type='qemu' id='2'&gt;
  &lt;name&gt;centos5&lt;/name&gt;
  &lt;uuid&gt;cabfad09-ff8b-e1ca-051a-6729e301f6a1&lt;/uuid&gt;
  &lt;memory&gt;524288&lt;/memory&gt;
  &lt;currentMemory&gt;524288&lt;/currentMemory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='i686' machine='fedora-13'&gt;hvm&lt;/type&gt;
    &lt;boot dev='cdrom'/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
    &lt;apic/&gt;
    &lt;pae/&gt;
  &lt;/features&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;destroy&lt;/on_reboot&gt;
  &lt;on_crash&gt;destroy&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/bin/qemu&lt;/emulator&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;driver name='qemu' type='raw'/&gt;
      &lt;source file='/var/lib/libvirt/images/centos.img'/&gt;
      &lt;target dev='hda' bus='ide'/&gt;
      &lt;alias name='ide0-0-0'/&gt;
      &lt;address type='drive' controller='0' bus='0' unit='0'/&gt;
    &lt;/disk&gt;
    &lt;disk type='file' device='cdrom'&gt;
      &lt;driver name='qemu'/&gt;
      &lt;source file='/tmp/CentOS-5.3-i386-bin-DVD.iso'/&gt;
      &lt;target dev='hdc' bus='ide'/&gt;
      &lt;readonly/&gt;
      &lt;alias name='ide0-1-0'/&gt;
      &lt;address type='drive' controller='0' bus='1' unit='0'/&gt;
    &lt;/disk&gt;
    &lt;controller type='ide' index='0'&gt;
      &lt;alias name='ide0'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x01'
function='0x1'/&gt;
    &lt;/controller&gt;
    &lt;interface type='network'&gt;
      &lt;mac address='52:54:00:bf:32:c2'/&gt;
      &lt;source network='default'/&gt;
      &lt;target dev='vnet0'/&gt;
      &lt;alias name='net0'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x04'
function='0x0'/&gt;
    &lt;/interface&gt;
    &lt;serial type='pty'&gt;
      &lt;source path='/dev/pts/2'/&gt;
      &lt;target port='0'/&gt;
      &lt;alias name='serial0'/&gt;
    &lt;/serial&gt;
    &lt;console type='pty' tty='/dev/pts/2'&gt;
      &lt;source path='/dev/pts/2'/&gt;
      &lt;target port='0'/&gt;
      &lt;alias name='serial0'/&gt;
    &lt;/console&gt;
    &lt;input type='mouse' bus='ps2'/&gt;
    &lt;graphics type='vnc' port='5900' autoport='yes' keymap='en-us'/&gt;
    &lt;video&gt;
      &lt;model type='cirrus' vram='9216' heads='1'/&gt;
      &lt;alias name='video0'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x02'
function='0x0'/&gt;
    &lt;/video&gt;
  &lt;/devices&gt;
  &lt;seclabel type='dynamic' model='selinux'&gt;
    &lt;label&gt;system_u:system_r:svirt_t:s0:c370,c413&lt;/label&gt;
    &lt;imagelabel&gt;system_u:object_r:svirt_image_t:s0:c370,c413&lt;/imagelabel&gt;
  &lt;/seclabel&gt;
&lt;/domain&gt;

[Attachment #3 (text/html)]

Hi &lt;br&gt;I have configured KVM with Fedora Core 13 by enabling the KVM virtualization \
option while installing OS.&lt;br&gt;I have successfully created the guest OS by using the \
virt-install API&lt;br&gt;&lt;br&gt;/usr/sbin/virt-install --name centos5 --ram 512 --disk \
path=/var/lib/libvirt/images/&lt;div id=":vk" class="ii gt"&gt; centos.img,size=5 --network \
network:default --accelerate --vnc -c /tmp/CentOS-5.3-i386-bin-DVD.iso&lt;br&gt; &lt;br&gt;Os \
installed successfully and after rebooting am able to login to the guest OS using the \
virt-viewer command using vnc viewer ..It shows&lt;br&gt;&lt;br&gt;Booting from Hard \
Disk...&lt;br&gt;GRUB Loading stage2.....&lt;br&gt;&lt;br&gt;But the guest os is not booted&lt;br&gt; &lt;br&gt;I \
want to the create the guest os from existing configured disk \
/var/lib/libvirt/images/centos.img.. What modifications should be done with my \
configuration file ??&lt;br&gt; Pleas help me to solve this.&lt;br&gt;&lt;br&gt;[root@kvmcluster ~]# \
virsh dumpxml centos5&lt;br&gt;&lt;domain type='qemu' id='2'&gt;&lt;br&gt;  \
&lt;name&gt;centos5&lt;/name&gt;&lt;br&gt;  \
&lt;uuid&gt;cabfad09-ff8b-e1ca-051a-6729e301f6a1&lt;/uuid&gt;&lt;br&gt;

  &lt;memory&gt;524288&lt;/memory&gt;&lt;br&gt;  \
&lt;currentMemory&gt;524288&lt;/currentMemory&gt;&lt;br&gt;  &lt;vcpu&gt;1&lt;/vcpu&gt;&lt;br&gt; \
&lt;os&gt;&lt;br&gt;    &lt;type arch='i686' \
machine='fedora-13'&gt;hvm&lt;/type&gt;&lt;br&gt;

    &lt;boot dev='cdrom'/&gt;&lt;br&gt;  &lt;/os&gt;&lt;br&gt;  &lt;features&gt;&lt;br&gt;    \
&lt;acpi/&gt;&lt;br&gt;    &lt;apic/&gt;&lt;br&gt;    &lt;pae/&gt;&lt;br&gt;  &lt;/features&gt;&lt;br&gt;  \
&lt;clock offset='utc'/&gt;&lt;br&gt;  \
&lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;&lt;br&gt;

  &lt;on_reboot&gt;destroy&lt;/on_reboot&gt;&lt;br&gt;  \
&lt;on_crash&gt;destroy&lt;/on_crash&gt;&lt;br&gt;  &lt;devices&gt;&lt;br&gt;    \
&lt;emulator&gt;/usr/bin/qemu&lt;/emulator&gt;&lt;br&gt;    &lt;disk type='file' \
device='disk'&gt;&lt;br&gt;

      &lt;driver name='qemu' type='raw'/&gt;&lt;br&gt;      &lt;source \
file='/var/lib/libvirt/images/centos.img'/&gt;&lt;br&gt;      &lt;target \
dev='hda' bus='ide'/&gt;&lt;br&gt;      &lt;alias \
name='ide0-0-0'/&gt;&lt;br&gt;

      &lt;address type='drive' controller='0' bus='0' \
unit='0'/&gt;&lt;br&gt;    &lt;/disk&gt;&lt;br&gt;    &lt;disk type='file' \
device='cdrom'&gt;&lt;br&gt;      &lt;driver name='qemu'/&gt;&lt;br&gt;

      &lt;source file='/tmp/CentOS-5.3-i386-bin-DVD.iso'/&gt;&lt;br&gt;      \
&lt;target dev='hdc' bus='ide'/&gt;&lt;br&gt;      &lt;readonly/&gt;&lt;br&gt;    \
&lt;alias name='ide0-1-0'/&gt;&lt;br&gt;      &lt;address type='drive' \
controller='0' bus='1' unit='0'/&gt;&lt;br&gt;

    &lt;/disk&gt;&lt;br&gt;    &lt;controller type='ide' index='0'&gt;&lt;br&gt;  \
&lt;alias name='ide0'/&gt;&lt;br&gt;      &lt;address type='pci' \
domain='0x0000' bus='0x00' slot='0x01' \
function='0x1'/&gt;&lt;br&gt;

    &lt;/controller&gt;&lt;br&gt;    &lt;interface type='network'&gt;&lt;br&gt;      \
&lt;mac address='52:54:00:bf:32:c2'/&gt;&lt;br&gt;      &lt;source \
network='default'/&gt;&lt;br&gt;      &lt;target dev='vnet0'/&gt;&lt;br&gt;

      &lt;alias name='net0'/&gt;&lt;br&gt;      &lt;address type='pci' \
domain='0x0000' bus='0x00' slot='0x04' \
function='0x0'/&gt;&lt;br&gt;    &lt;/interface&gt;&lt;br&gt;    &lt;serial \
type='pty'&gt;&lt;br&gt;

      &lt;source path='/dev/pts/2'/&gt;&lt;br&gt;      &lt;target \
port='0'/&gt;&lt;br&gt;      &lt;alias name='serial0'/&gt;&lt;br&gt;    \
&lt;/serial&gt;&lt;br&gt;    &lt;console type='pty' \
tty='/dev/pts/2'&gt;&lt;br&gt;

      &lt;source path='/dev/pts/2'/&gt;&lt;br&gt;      &lt;target \
port='0'/&gt;&lt;br&gt;      &lt;alias name='serial0'/&gt;&lt;br&gt;    \
&lt;/console&gt;&lt;br&gt;    &lt;input type='mouse' bus='ps2'/&gt;&lt;br&gt;

    &lt;graphics type='vnc' port='5900' autoport='yes' \
keymap='en-us'/&gt;&lt;br&gt;    &lt;video&gt;&lt;br&gt;      &lt;model \
type='cirrus' vram='9216' heads='1'/&gt;&lt;br&gt;      &lt;alias \
name='video0'/&gt;&lt;br&gt;

      &lt;address type='pci' domain='0x0000' bus='0x00' \
slot='0x02' function='0x0'/&gt;&lt;br&gt;    &lt;/video&gt;&lt;br&gt;  \
&lt;/devices&gt;&lt;br&gt;  &lt;seclabel type='dynamic' \
model='selinux'&gt;&lt;br&gt;

    &lt;label&gt;system_u:system_r:svirt_t:s0:c370,c413&lt;/label&gt;&lt;br&gt;    \
&lt;imagelabel&gt;system_u:object_r:svirt_image_t:s0:c370,c413&lt;/imagelabel&gt;&lt;br&gt; \
&lt;/seclabel&gt;&lt;br&gt;&lt;/domain&gt;&lt;/div&gt;



</body></email><email><emailId>20100716095835</emailId><senderName>Bruno Costa</senderName><senderEmail>brunogain@gmail.com</senderEmail><timestampReceived>2010-07-16 09:58:35-0400</timestampReceived><subject>[libvirt-users] Using Java bindings to event callback</subject><body>

I'm having some trouble using java bindings for domain events. Can
anyone provide me an example on how to use this, namely
conn.domainEventRegisterAny?

Any suggestions?

Thanks,
Bruno Costa 

</body></email><email><emailId>20100725222002</emailId><senderName>Dale Amon</senderName><senderEmail>amon@vnl.com</senderEmail><timestampReceived>2010-07-25 22:20:02-0400</timestampReceived><subject>[libvirt-users] Hello world help needed</subject><body>

I am trying to work my way up the learning curve through
a forest of conflicting and mostly non-working examples
and help pages spread about the internet.

I have had no trouble getting a basic vm to build
and to then start it up. But I have utterly failed
to gain access to the machine.

The only host I have available that can run it is a
remote server. I have not got the networking side
working yet, but I can live with that for the moment
because I have thus far not been able to get access
to a simple console on the vm.

Here is the machine:

&lt;domain type='kvm' id='2'&gt;
  &lt;name&gt;ubuntu&lt;/name&gt;
  &lt;uuid&gt;8904d893-87dc-dc1f-0219-486745a370f6&lt;/uuid&gt;
  &lt;memory&gt;262144&lt;/memory&gt;
  &lt;currentMemory&gt;262144&lt;/currentMemory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='x86_64' machine='pc-0.12'&gt;hvm&lt;/type&gt;
    &lt;boot dev='hd'/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
  &lt;/features&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;destroy&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;source file='/home/myhome/ubuntu-kvm/tmpl3Xutj.qcow2'/&gt;
      &lt;target dev='hda' bus='ide'/&gt;
    &lt;/disk&gt;
    &lt;interface type='network'&gt;
      &lt;mac address='52:54:00:be:d5:c2'/&gt;
      &lt;source network='default'/&gt;
      &lt;target dev='vnet0'/&gt;
      &lt;model type='virtio'/&gt;
    &lt;/interface&gt;
    &lt;input type='mouse' bus='ps2'/&gt;
    &lt;graphics type='vnc' port='5900' autoport='yes' listen='127.0.0.1'/&gt;
    &lt;video&gt;
      &lt;model type='cirrus' vram='9216' heads='1'/&gt;
    &lt;/video&gt;
    &lt;serial type='pty'&gt;
     &lt;source path='/dev/pts/2'/&gt;
     &lt;target port='0'/&gt;
    &lt;/serial&gt;
    &lt;console type='pty' tty='/dev/pts/2'&gt;
     &lt;source path='/dev/pts/2'/&gt;
     &lt;target port='0'/&gt;
    &lt;/console&gt;
  &lt;/devices&gt;
  &lt;seclabel type='dynamic' model='apparmor'&gt;
    &lt;label&gt;libvirt-8904d893-87dc-dc1f-0219-486745a370f6&lt;/label&gt;
    &lt;imagelabel&gt;libvirt-8904d893-87dc-dc1f-0219-486745a370f6&lt;/imagelabel&gt;
  &lt;/seclabel&gt;
&lt;/domain&gt;

I dumped the original and added the pty stuff from an example, but
when I create it and connect to the console:

	# virsh -c qemu:///system create ubuntu2.xml --console
	Domain ubuntu created from ubuntu2.xml
	Connected to domain ubuntu
	Escape character is ^]

nothing appears and nothing I type echoes. 
At least I can escape though...

I seem to have no trouble creating them, but it sure would
be nice to be able to access them. 

Oh, and btw. Every time I create a VM with the ubuntu 

  ubuntu-vm-builder kvm  hardy --mem 256 --iso /path/to/ubuntu-8.10-server-i386.iso

  ubuntu-vm-builder kvm  lucid --mem 256 --iso ubuntu-10.04-server-amd64.iso

It leaves a loopback disk behind that never goes away. I've
had to reboot the server once already and upped loop_max to 32
so I would be able to work longer before doing so again.

</body></email><email><emailId>20100729013520</emailId><senderName>jeremy avnet</senderName><senderEmail>brainsik+libvirt@saucelabs.com</senderEmail><timestampReceived>2010-07-29 01:35:20-0400</timestampReceived><subject>[libvirt-users] Too many active clients?</subject><body>

Hello,

I'm receiving a lot of these since a couple of days ago:

libvirtd: 16:30:10.960: error : qemudDispatchServer:1282 : Too many active
clients (20), dropping connection

I'm trying to figure out where all these active clients are coming from. I
have a daemon running the interacts with libvirtd, but it only creates two
long-lived connections (I'm very sure). What constitutes an active
connection?

The only other libvirtd access that goes on are some quick lived munin
process which connect in various ways and using virsh on the command line.

Libvirt version 0.7.5-5ubuntu27 on Ubuntu 10.04.

Thanks!
.:. jeremy

[Attachment #3 (text/html)]

&lt;font face="verdana,sans-serif"&gt;&lt;span class="Apple-style-span" style="font-family: \
arial, sans-serif; font-size: 13px; border-collapse: collapse; "&gt;&lt;div&gt;&lt;span \
class="Apple-style-span" style="border-collapse: collapse; "&gt;&lt;font \
class="Apple-style-span" face="verdana, sans-serif"&gt;&lt;span class="Apple-style-span" \
style="font-size: small;"&gt;Hello,&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span \
class="Apple-style-span" style="border-collapse: collapse; "&gt;&lt;font \
class="Apple-style-span" face="verdana, sans-serif"&gt;&lt;span class="Apple-style-span" \
style="font-size: small;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt; &lt;span \
class="Apple-style-span" style="border-collapse: collapse; "&gt;&lt;font \
class="Apple-style-span" face="verdana, sans-serif"&gt;&lt;span class="Apple-style-span" \
style="font-size: small;"&gt;I'm receiving a lot of these since a couple of days \
ago:&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span class="Apple-style-span" \
style="border-collapse: collapse; "&gt;&lt;font class="Apple-style-span" face="verdana, \
sans-serif"&gt;&lt;span class="Apple-style-span" style="font-size: \
small;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt; &lt;span class="Apple-style-span" \
style="border-collapse: collapse; "&gt;&lt;span class="Apple-style-span" style="font-size: \
small;"&gt;&lt;font class="Apple-style-span" face="'courier new', \
monospace"&gt;libvirtd: 16:30:10.960: error : qemudDispatchServer:1282 : Too many active \
clients (20), dropping connection&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span \
class="Apple-style-span" style="border-collapse: collapse; "&gt;&lt;font \
class="Apple-style-span" face="verdana, sans-serif"&gt;&lt;span class="Apple-style-span" \
style="font-size: small;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt; &lt;span \
class="Apple-style-span" style="border-collapse: collapse; "&gt;&lt;font \
class="Apple-style-span" face="verdana, sans-serif"&gt;&lt;span class="Apple-style-span" \
style="font-size: small;"&gt;I'm trying to figure out where all these active clients \
are coming from. I have a daemon running the interacts with libvirtd, but it only \
creates two long-lived connections (I'm very sure). What constitutes an active \
connection?&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span class="Apple-style-span" \
style="border-collapse: collapse; "&gt;&lt;font class="Apple-style-span" face="verdana, \
sans-serif"&gt;&lt;span class="Apple-style-span" style="font-size: \
small;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt; &lt;font class="Apple-style-span" \
face="verdana, sans-serif"&gt;&lt;span class="Apple-style-span" style="font-size: \
small;"&gt;The only other libvirtd access that goes on are some quick lived munin \
process which connect in various ways and using virsh on the command \
line.&lt;/span&gt;&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font class="Apple-style-span" face="verdana, \
sans-serif"&gt;&lt;span class="Apple-style-span" style="font-size: \
small;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="verdana, \
sans-serif"&gt;&lt;span class="Apple-style-span" style="font-size: small;"&gt;Libvirt version \
&lt;/span&gt;&lt;/font&gt;&lt;span class="Apple-style-span" style="border-collapse: separate; \
"&gt;&lt;font class="Apple-style-span" face="verdana, sans-serif"&gt;&lt;span \
class="Apple-style-span" style="font-size: small;"&gt;0.7.5-5ubuntu27 on Ubuntu \
10.04.&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt; &lt;div&gt;&lt;span class="Apple-style-span" \
style="border-collapse: separate; "&gt;&lt;font class="Apple-style-span" face="verdana, \
sans-serif"&gt;&lt;span class="Apple-style-span" style="font-size: \
small;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt; &lt;span class="Apple-style-span" \
style="border-collapse: separate; "&gt;&lt;font class="Apple-style-span" face="verdana, \
sans-serif"&gt;&lt;span class="Apple-style-span" style="font-size: \
small;"&gt;Thanks!&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt; &lt;span class="Apple-style-span" \
style="border-collapse: separate; "&gt;&lt;font class="Apple-style-span" face="verdana, \
sans-serif"&gt;&lt;span class="Apple-style-span" style="font-size: small;"&gt;.:. \
jeremy&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/font&gt;&lt;div&gt; &lt;font \
face="verdana,sans-serif"&gt;&lt;span class="Apple-style-span" style="font-family: arial, \
sans-serif; font-size: 13px; border-collapse: collapse; "&gt;&lt;span \
class="Apple-style-span" style="border-collapse: separate; font-family: arial; \
font-size: small; "&gt;&lt;br&gt; &lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;



</body></email><email><emailId>20100716113441</emailId><senderName>Bryan Kearney</senderName><senderEmail>bkearney@redhat.com</senderEmail><timestampReceived>2010-07-16 11:34:41-0400</timestampReceived><subject>Re: [libvirt-users] Using Java bindings to event callback</subject><body>

On 07/16/2010 05:58 AM, Bruno Costa wrote:
&gt; I'm having some trouble using java bindings for domain events. Can
&gt; anyone provide me an example on how to use this, namely
&gt; conn.domainEventRegisterAny?

This is pretty new code, so there may not be many examples. What issues 
are you seeing, maybe we can figure them out.

-- bk

</body></email><email><emailId>20100716124932</emailId><senderName>Bruno Costa</senderName><senderEmail>brunogain@gmail.com</senderEmail><timestampReceived>2010-07-16 12:49:32-0400</timestampReceived><subject>Re: [libvirt-users] Using Java bindings to event callback</subject><body>

I'm trying to build a trivial example code. Something like this in the
main():


conn = new Connect("qemu:///session", false);

VirConnectDomainEventGenericCallback cb = new 
VirConnectDomainEventGenericCallback() {
public void eventCallback(ConnectionPointer arg0, DomainPointer(arg1,
Pointer arg2) { 
System.out.println("event happened!");
}
};

int pointer = conn.domainEventRegisterAny(null, 0, cb);

Is this example, I'm trying to catch events of type 0
( VIR_DOMAIN_EVENT_ID_LIFECYCLE) to a callback(cb). But I think this way
is not correct, because the execution should stop and I should see the
events in the output.

The idea is to write my own callbacks to catch the events, without
having to poll the state of the resources. I have seen the code in
python, namely event-test.py, and realized that there are helper classes
(such virEventLoop*) and I might need something similar in Java... But I
can't find any examples.

Thanks,
Bruno Costa


On Fri, 2010-07-16 at 07:34 -0400, Bryan Kearney wrote: 
&gt; On 07/16/2010 05:58 AM, Bruno Costa wrote:
&gt; &gt; I'm having some trouble using java bindings for domain events. Can
&gt; &gt; anyone provide me an example on how to use this, namely
&gt; &gt; conn.domainEventRegisterAny?
&gt; 
&gt; This is pretty new code, so there may not be many examples. What issues 
&gt; are you seeing, maybe we can figure them out.
&gt; 
&gt; -- bk
&gt; 


</body></email><email><emailId>20100719174529</emailId><senderName>Carla Araujo</senderName><senderEmail>carla.asouza@gmail.com</senderEmail><timestampReceived>2010-07-19 17:45:29-0400</timestampReceived><subject>Re: [libvirt-users] How to create a guest os from existing disk image file with virt-install</subject><body>

Hi Rajiv

On Mon, Jul 19, 2010 at 02:45, Rajiv Rajaian &lt;rajiv.care@gmail.com&gt; wrote:

&gt; Hi
&gt; I want to the create the guest os from existing configured disk
&gt; /var/lib/libvirt/images/centos.img.. What modifications should be done with
&gt; my configuration file ??
&gt;

You can import the *.img* executing virt-install with this parameters (this
is just an example):
virt-install --name NewVM --ram 512 --vcpus 1 --disk path=/var/lib/libvirt
/images/centos.img *--import* --noautoconsole --force

-- Carla

[Attachment #3 (text/html)]

Hi Rajiv&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Mon, Jul 19, 2010 at 02:45, Rajiv Rajaian \
&lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:rajiv.care@gmail.com"&gt;rajiv.care@gmail.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt;

Hi &lt;div&gt;I want to the create the guest os from existing configured disk \
/var/lib/libvirt/images/centos.img.. What modifications should be done with my \
configuration file ??&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;You can import the \
&lt;i&gt;.img&lt;/i&gt; executing &lt;font class="Apple-style-span" face="'courier new', \
monospace"&gt;virt-install&lt;/font&gt; with this parameters (this is just an example): &lt;/div&gt;

&lt;div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="'courier new', \
monospace"&gt;virt&lt;/font&gt;&lt;font class="Apple-style-span" face="'courier new', \
monospace"&gt;-install --name &lt;/font&gt;&lt;font class="Apple-style-span" face="'courier \
new', monospace"&gt;NewVM&lt;/font&gt;&lt;font class="Apple-style-span" face="'courier \
new', monospace"&gt; --ram 512 --&lt;/font&gt;&lt;font class="Apple-style-span" \
face="'courier new', monospace"&gt;vcpus&lt;/font&gt;&lt;font class="Apple-style-span" \
face="'courier new', monospace"&gt; 1 --disk path=/var/lib/&lt;/font&gt;&lt;font \
class="Apple-style-span" face="'courier new', monospace"&gt;libvirt&lt;/font&gt;&lt;font \
class="Apple-style-span" face="'courier new', monospace"&gt;/images/&lt;/font&gt;&lt;font \
class="Apple-style-span" face="'courier new', monospace"&gt;centos&lt;/font&gt;&lt;font \
class="Apple-style-span" face="'courier new', monospace"&gt;.&lt;/font&gt;&lt;font \
class="Apple-style-span" face="'courier new', monospace"&gt;img&lt;/font&gt;&lt;font \
class="Apple-style-span" face="'courier new', monospace"&gt; &lt;/font&gt;&lt;b&gt;&lt;font \
class="Apple-style-span" face="'courier new', \
monospace"&gt;--import&lt;/font&gt;&lt;/b&gt;&lt;font class="Apple-style-span" face="'courier \
new', monospace"&gt; --&lt;/font&gt;&lt;font class="Apple-style-span" face="'courier \
new', monospace"&gt;noautoconsole&lt;/font&gt;&lt;font class="Apple-style-span" \
face="'courier new', monospace"&gt; --force&lt;/font&gt;&lt;/div&gt;

&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-- Carla&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20100706175737</emailId><senderName>Bryan Kearney</senderName><senderEmail>bkearney@redhat.com</senderEmail><timestampReceived>2010-07-06 17:57:37-0400</timestampReceived><subject>[libvirt-users] Release 0.4.6 of the libvirt java bindings</subject><body>

I have just released 0.4.6 of the java libvirt bindings. This release 
adds support for the 0.8.2 libvirt API as well as some code cleanup 
patches from Luis Costa (Thank you!).

You can access the latest version via the following means:

Source Code: http://www.libvirt.org/git/?p=libvirt-java.git;a=summary
Bundled Source (tarball and SRPM): http://libvirt.org/sources/java/
Maven: http://libvirt.org/maven2/. They should hit the central repo in a 
day or two.
RPMS are making their way though the Fedora Rawhide build path

Thank you!

-- bk

</body></email><email><emailId>20100708011303</emailId><senderName>Dave Allan</senderName><senderEmail>dallan@redhat.com</senderEmail><timestampReceived>2010-07-08 01:13:03-0400</timestampReceived><subject>Re: [libvirt-users] Blockpeek.. A little help please</subject><body>

On Wed, Jul 07, 2010 at 05:47:37PM -0700, steven765@yahoo.com wrote:
&gt; Hi, 
&gt; I'm trying to use blockpeek to open the contents of a file.  Inside the vm i ran \
&gt; debugfs: imap /test/findme   and got: inode 32642 is part of block group 4 located \
&gt; at block 131074, offset 0x0100 
&gt; I try using 0x100 or 256 as the offset to blockpeek into that VM and get nonsense \
&gt; as a result. 
&gt; Am I calculating the offset incorrectly, is there a better way to find a file's \
&gt; location on disk? And then open it?  
&gt; I'm just printing the return as a string from the buffer looping over size.  Is \
&gt; that incorrect?  Thanks again,
&gt; Steve 

Oh, hey, sorry--I totally forgot to respond to your earlier email.
Would libguestfs possibly be a fit for what you're trying to do?  

http://libguestfs.org/

Dave


</body></email><email><emailId>20100708151212</emailId><senderName>adrian wyssen</senderName><senderEmail>wyssenadrian@gmail.com</senderEmail><timestampReceived>2010-07-08 15:12:12-0400</timestampReceived><subject>[libvirt-users] Get ip address of a running domain</subject><body>

Hi,

I wanted to know if it is possible to get the IP address of a running
domain. The domain get's this IP dynamicly via DHCP, but I need to know it
once it gets it.
I tired virDomainGetXMLDesc, but this only returns the MAC address...

Thanks for any help.
Adrian

[Attachment #3 (text/html)]

Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I wanted to know if it is possible to get the IP add=
ress of a running domain. The domain get's this IP dynamicly via DHCP, =
but I need to know it once it gets it.&lt;/div&gt;&lt;div&gt;I tired=A0virDomainGetXMLD=
esc, but this only returns the MAC address...&lt;/div&gt;
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks for any help.&lt;/div&gt;&lt;div&gt;Adrian&lt;/div&gt;


</body></email><email><emailId>20100708173001</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2010-07-08 17:30:01-0400</timestampReceived><subject>Re: [libvirt-users] virStream functions</subject><body>

On 07/08/10 - 01:06:05PM, Camilo Aguilar wrote:
&gt; May anybody tell me which is the porpose of virStream functions ?
&gt; 
&gt; Thanks in advance.

They are a generic data transport, using the libvirt authentication and RPC
mechanism.  At present it is only used internally to do tunnelled migration,
though there are also plans to use it for "virsh console" so you can see the
console on remote hosts.

There may be other uses for it, but it's not directly used for managing
guests at this time.

--
Chris Lalancette

</body></email><email><emailId>20100714155759</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-07-14 15:57:59-0400</timestampReceived><subject>Re: [libvirt-users] how to deactivate an active network with virsh? (and what is that anyway)</subject><body>

On Wed, Jul 14, 2010 at 11:49:40AM -0400, John Lumby wrote:
&gt; 
&gt; virsh provides 
&gt;          net-start &lt;netname-or-id&gt;
&gt; to activate an inactive network.
&gt; 
&gt; 
&gt; Does virsh provide any way to do the exact converse?  

virsh net-destroy is the converse


Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100714193526</emailId><senderName>"Development"</senderName><senderEmail>development@simulamen.eu</senderEmail><timestampReceived>2010-07-14 19:35:26-0400</timestampReceived><subject>[libvirt-users] C# Client Fails to Locate libvirt-0.dll</subject><body>

Attempting to develop C sharp client that uses libvirt DLL.  Despite placing
the libvirt DLL in a number of different locations, call to virConnectOpen()
fails consistently with a DLL not found exception.  Declaration as follows:

 

        [DllImport("libvirt-0.dll")]

        private static extern IntPtr virConnectOpen(String name);

 

Called as follows:

 

        IntPtr conn = virConnectOpen(null);

 

Suggestions?

 

Tim McLeod

 


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;meta http-equiv=Content-Type content="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 12 (filtered medium)"&gt;
&lt;style&gt;
&lt;!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;}
div.WordSection1
	{page:WordSection1;}
--&gt;
&lt;/style&gt;
&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapelayout v:ext="edit"&gt;
  &lt;o:idmap v:ext="edit" data="1" /&gt;
 &lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
&lt;/head&gt;

&lt;body lang=EN-GB link=blue vlink=purple&gt;

&lt;div class=WordSection1&gt;

&lt;p class=MsoNormal&gt;Attempting to develop C sharp client that uses libvirt
DLL. Despite placing the libvirt DLL in a number of different locations,
call to virConnectOpen() fails consistently with a DLL not found exception.
Declaration as follows:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt; \
[DllImport(libvirt-0.dll)]&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt; private static
extern IntPtr virConnectOpen(String name);&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Called as follows:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt; IntPtr conn =
virConnectOpen(null);&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Suggestions?&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Tim McLeod&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;



</body></email><email><emailId>20100718225928</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-07-18 22:59:28-0400</timestampReceived><subject>Re: [libvirt-users] ESX - How to create a new domain</subject><body>

2010/7/16 George Goh &lt;georgegoh@spodon.com&gt;:
&gt; Hi,
&gt; I've been trying to figure out how to create a new domain(create a new
&gt; virtual machine) using the ESX driver.
&gt; The documentation at  http://libvirt.org/drvesx.html says:
&gt; To define a new domain the driver converts the domain XML into a VMware VMX
&gt; file and uploads it to a datastore known to the ESX server. Because multiple
&gt; datastores may be known to an ESX server the driver needs to decide to which
&gt; datastores the VMX file should be uploaded. The driver deduces this
&gt; information from the path of the source of the first file-based harddisk
&gt; listed in the domain XML.
&gt; But I can't find a way to do this in virsh. Any ideas?
&gt; -George

You quoted a paragraph that describes what the driver does internally
while defining a new domain. This paragraph is there because the way
it works internally has implications on how you have to specify disk
devices in the domain XML. It has nothing to do with the way you
define a new domain in general.

Defining a new domain using virsh works as with any other backend
supported by libvirt.

1) Create a domain XML config file test1.xml containing this example
config (assuming the default local datastore named 'Storage1' and the
default virtual port group named 'VM Network'):

&lt;domain type='vmware'&gt;
  &lt;name&gt;test1&lt;/name&gt;
  &lt;memory&gt;524288&lt;/memory&gt;
  &lt;currentMemory&gt;524288&lt;/currentMemory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='i686'&gt;hvm&lt;/type&gt;
  &lt;/os&gt;
  &lt;devices&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;source file='[Storage1] test1/test1.vmdk'/&gt;
      &lt;target dev='sda' bus='scsi'/&gt;
      &lt;address type='drive' controller='0' bus='0' unit='0'/&gt;
    &lt;/disk&gt;
    &lt;disk type='file' device='cdrom'&gt;
      &lt;source file='[Storage1] iso/Fedora-13-i686-Live.iso'/&gt;
      &lt;target dev='hda' bus='ide'/&gt;
      &lt;address type='drive' controller='0' bus='0' unit='0'/&gt;
    &lt;/disk&gt;
    &lt;controller type='scsi' index='0'/&gt;
    &lt;controller type='ide' index='0'/&gt;
    &lt;interface type='bridge'&gt;
      &lt;source bridge='VM Network'/&gt;
    &lt;/interface&gt;
  &lt;/devices&gt;
&lt;/domain&gt;

2) Start virsh:

  virsh -c esx://example-esx-server.com/?no_verify=1

3) At the virsh prompt execute a define command:

  define /path/to/test1.xml

Currently this requires that you manually created the .vmdk file
'[Storage1] test1/test1.vmdk' before.

I'm currently working on the libvirt storage management for ESX. I
expect that libvirt 0.8.3 will be able to create new .vmdk files in an
ESX datastore.

Matthias

</body></email><email><emailId>20100719083728</emailId><senderName>mahsa najafzadeh</senderName><senderEmail>mahsa.najafzadeh@gmail.com</senderEmail><timestampReceived>2010-07-19 08:37:28-0400</timestampReceived><subject>[libvirt-users] kvm migration problem</subject><body>

Hi,

I am running ubuntu 9.10, with kvm and libvirt-bin, etc. Using virsh, I
can't live-migrate a VM from host1 to host2. It reports a unknown failure.
The VM image is accessible on both source and destination hosts located on a
shared storage using nfs. Image directory is on the same path on both hosts.
The src and destination hosts are on the same subnet. I can connect to
remote host with qemu+ssh but I can't migrate.

my configuration is:

$ uname -a

Linux mahsa1-desktop 2.6.31-21-generic-pae #59-Ubuntu SMP Wed Mar 24
08:47:55 UTC 2010 i686 GNU/Linux

$virsh # version

Compiled against library: libvir 0.7.0

Using library: libvir 0.7.0

Using API: QEMU 0.7.0

Running hypervisor: QEMU 0.11.0

Connect to the local machine's hypervisor as follows and see the
localmachines:$virsh # connect qemu:///system

$virsh # list

Id Name State

--------------------------------

2 VmLinux11 running

3 VMLinux12 running

4 VmLinux13 running

 Verify connectivity to the hypervisor of the remote target system
asfollows:$virsh connect qemu+ssh://host2name/system
 Attempt the migration as follows:$virsh migrate --live VmLinux13
qemu+ssh://host2name/system
Connecting to uri: qemu:///system
root@host2name's password:
error: Unknown failure
the log file on the source physical host gives this:14:57:13.514:
error : remoteIO:7184 : operation failed: migrate failed: migrate
"tcp:host2name:49161"
migration failed

14:57:13.709: error : remoteIO:7184 : Unknown failure

 I disable the firewall on both hosts but it doesn't still work. please help me.

[Attachment #3 (text/html)]

&lt;br&gt;&lt;div class="gmail_quote"&gt;&lt;br&gt;&lt;br&gt;&lt;p style="margin-bottom: 0in;"&gt;
&lt;/p&gt;
&lt;p style="margin-bottom: 0in;"&gt;&lt;font size="2"&gt;Hi,&lt;/font&gt;&lt;/p&gt;
&lt;p style="margin-bottom: 0in;"&gt;&lt;font size="2"&gt;I am running ubuntu 9.10,
with kvm and libvirt-bin, etc. Using virsh, I can't live-migrate a VM
from host1 to host2. It reports a unknown failure. The VM image is
accessible on both source and destination hosts located on a shared
storage using nfs.  Image directory is on the same path on both
hosts. The src and destination hosts are on the same subnet. I can
connect to remote host with qemu+ssh but I can't migrate.   &lt;/font&gt;
&lt;/p&gt;
&lt;p style="margin-bottom: 0in;"&gt;&lt;font size="2"&gt;my configuration is:  &lt;/font&gt;
&lt;/p&gt;
&lt;p style="margin-bottom: 0in;"&gt;&lt;font size="2"&gt;$ uname -a
&lt;/font&gt;&lt;/p&gt;
&lt;p style="margin-bottom: 0in;"&gt;&lt;font size="2"&gt;Linux mahsa1-desktop
2.6.31-21-generic-pae #59-Ubuntu SMP Wed Mar 24 08:47:55 UTC 2010
i686 GNU/Linux
&lt;/font&gt;&lt;/p&gt;
&lt;p style="margin-bottom: 0in;"&gt;&lt;font size="2"&gt;$virsh # version
&lt;/font&gt;&lt;/p&gt;
&lt;p style="margin-bottom: 0in;"&gt;&lt;font size="2"&gt;Compiled against library:
libvir 0.7.0
&lt;/font&gt;&lt;/p&gt;
&lt;p style="margin-bottom: 0in;"&gt;&lt;font size="2"&gt;Using library: libvir
0.7.0
&lt;/font&gt;&lt;/p&gt;
&lt;p style="margin-bottom: 0in;"&gt;&lt;font size="2"&gt;Using API: QEMU 0.7.0
&lt;/font&gt;&lt;/p&gt;
&lt;p style="margin-bottom: 0in;"&gt;&lt;font size="2"&gt;Running hypervisor: QEMU
0.11.0&lt;/font&gt;&lt;/p&gt;

&lt;pre&gt;&lt;font face="Nimbus Roman No9 L, serif" size="2"&gt;Connect to the local \
machine's hypervisor as follows and see the local&lt;/font&gt; &lt;font face="Nimbus Roman \
No9 L, serif" size="2"&gt;machines:&lt;/font&gt; &lt;font size="2"&gt;$virsh # connect \
qemu:///system&lt;/font&gt;&lt;/pre&gt;&lt;p style="margin-bottom: 0in;"&gt; &lt;font size="2"&gt;$virsh # \
list &lt;/font&gt;&lt;/p&gt;
&lt;p style="margin-bottom: 0in;"&gt; &lt;font size="2"&gt;Id Name                
State
&lt;/font&gt;&lt;/p&gt;
&lt;p style="margin-bottom: 0in;"&gt;&lt;font size="2"&gt;--------------------------------
&lt;/font&gt;&lt;/p&gt;
&lt;p style="margin-bottom: 0in;"&gt;  &lt;font size="2"&gt;2 VmLinux11           
running
&lt;/font&gt;&lt;/p&gt;
&lt;p style="margin-bottom: 0in;"&gt;  &lt;font size="2"&gt;3 VMLinux12           
running
&lt;/font&gt;&lt;/p&gt;
&lt;p style="margin-bottom: 0in;"&gt;  &lt;font size="2"&gt;4 VmLinux13           
running
&lt;/font&gt;&lt;/p&gt;

&lt;pre&gt;&lt;font size="2"&gt; &lt;/font&gt;&lt;font face="Nimbus Roman No9 L, serif" size="2"&gt;Verify \
connectivity to the hypervisor of the remote target system as&lt;/font&gt; &lt;font \
face="Nimbus Roman No9 L, serif" size="2"&gt;follows:&lt;/font&gt; &lt;font face="Nimbus Roman \
No9 L, serif" size="2"&gt;$virsh connect qemu+ssh://host2name/system&lt;/font&gt; &lt;br&gt; &lt;font \
face="Nimbus Roman No9 L, serif" size="2"&gt;Attempt the migration as follows:&lt;/font&gt; \
&lt;font face="Nimbus Roman No9 L, serif" size="2"&gt;$virsh migrate --live VmLinux13 \
qemu+ssh://host2name/system&lt;br&gt;&lt;/font&gt;&lt;font face="Nimbus Roman No9 L, serif" \
size="2"&gt;Connecting to uri: qemu:///system&lt;br&gt;&lt;/font&gt;&lt;font face="Nimbus Roman No9 L, \
serif" size="2"&gt;root@host2name's password: &lt;br&gt;

&lt;/font&gt;&lt;font face="Nimbus Roman No9 L, serif" size="2"&gt;error: Unknown \
failure&lt;br&gt;&lt;/font&gt; &lt;font face="Nimbus Roman No9 L, serif" size="2"&gt;the log file on \
the source physical host gives this:&lt;/font&gt; &lt;font face="Nimbus Roman No9 L, serif" \
size="2"&gt;14:57:13.514: error : remoteIO:7184 : operation failed: migrate failed: \
migrate "tcp:host2name:49161"&lt;br&gt;&lt;/font&gt;&lt;font face="Nimbus Roman No9 L, \
serif" size="2"&gt;migration failed&lt;/font&gt;&lt;font face="Nimbus Roman No9 L, serif" \
size="2"&gt;&lt;br&gt;

14:57:13.709: error : remoteIO:7184 : Unknown failure&lt;br&gt;&lt;br&gt;&lt;/font&gt; &lt;font \
face="Nimbus Roman No9 L, serif" size="2"&gt;I disable the firewall on both hosts but it \
doesn't still work. please help me.&lt;/font&gt;&lt;/pre&gt; &lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20100719143855</emailId><senderName>"Neil Aggarwal"</senderName><senderEmail>neil@jammconsulting.com</senderEmail><timestampReceived>2010-07-19 14:38:55-0400</timestampReceived><subject>[libvirt-users] Allow customer to stop and start their own VPS, but not others</subject><body>

Hello:

One of my customers asked for access to stop and start
their VPS.  

Right now, I can do that using virsh, but I do not want
to give this customer the ability to stop and start
all VPSs running on the host.

Is there a way to give stop and start control of one
VPS to someone?

I am using KVM on a CentOS 5.5 host.

Thanks,
	Neil

--
Neil Aggarwal, (281)846-8957
FREE trial: Virtualmin VPS with unmetered bandwidth
http://UnmeteredVPS.net/virtualmin

</body></email><email><emailId>20100720142802</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-07-20 14:28:02-0400</timestampReceived><subject>Re: [libvirt-users] [virt-tools-list] Possible to rename a volume</subject><body>

On 07/20/2010 02:54 AM, Bla Blubb wrote:
&gt; Hi,
&gt; 
&gt; is there a way to rename a volume via virsh?
&gt; 
&gt; Regards Jessica
&gt; 

No, though you could use vol-clone and then vol-delete on the original.
Would be slow/inefficient understandably.

- Cole

</body></email><email><emailId>20100720221205</emailId><senderName></senderName><senderEmail>steven765@yahoo.com</senderEmail><timestampReceived>2010-07-20 22:12:05-0400</timestampReceived><subject>[libvirt-users] Force network to append iptables rules to end or specified number?</subject><body>

Subject line says it all. Every time I restart a network libvirt inserts its standard rules at the head of the ip forward chain.  The deny lines in there clobber access to my servers.  Is there any way to make it append those rules at a specific number or at the end by default?
Many Thanks,
Steve 


      

</body></email><email><emailId>20100722044729</emailId><senderName>Rajiv Rajaian</senderName><senderEmail>rajiv.care@gmail.com</senderEmail><timestampReceived>2010-07-22 04:47:29-0400</timestampReceived><subject>Re: [libvirt-users] How to create a guest os from existing disk image file with virt-install</subject><body>

Hi Carla Araujo

I have tried the option with --import still the guest os is not
booting.. If any body tried this option please help me


On 7/19/10, Carla Araujo &lt;carla.asouza@gmail.com&gt; wrote:
&gt; Hi Rajiv
&gt;
&gt; On Mon, Jul 19, 2010 at 02:45, Rajiv Rajaian &lt;rajiv.care@gmail.com&gt; wrote:
&gt;
&gt;&gt; Hi
&gt;&gt; I want to the create the guest os from existing configured disk
&gt;&gt; /var/lib/libvirt/images/centos.img.. What modifications should be done
&gt;&gt; with
&gt;&gt; my configuration file ??
&gt;&gt;
&gt;
&gt; You can import the *.img* executing virt-install with this parameters (this
&gt; is just an example):
&gt; virt-install --name NewVM --ram 512 --vcpus 1 --disk path=/var/lib/libvirt
&gt; /images/centos.img *--import* --noautoconsole --force
&gt;
&gt; -- Carla
&gt;

</body></email><email><emailId>20100722201320</emailId><senderName>Matthew Macdonald-Wallace</senderName><senderEmail>matthew@truthisfreedom.org.uk</senderEmail><timestampReceived>2010-07-22 20:13:20-0400</timestampReceived><subject>[libvirt-users] Updates to cucmber-vhost - guineapigs wanted! :)</subject><body>

Hi all,

For those of you that are using cucumber for Continuous Integration or
similar I've created a set of steps that enable you to use cobbler and
cucumber to auto-provision using Libvirt.

I've just made some changes to the code however I don't have access to
all the hardware/software required to test it fully.

If you are able to, please check out the code from
http://tinyurl.com/virtcuke (my github repo) and test, posting bugs
against the project.

Thanks in advance,

Matt

</body></email><email><emailId>20100723000747</emailId><senderName>Priya</senderName><senderEmail>pbhat@acis.ufl.edu</senderEmail><timestampReceived>2010-07-23 00:07:47-0400</timestampReceived><subject>[libvirt-users] libvir: Domain error &lt;domName&gt;: invalid argument in virDomainGetXMLDesc</subject><body>


All,

I just downloaded and installed libvirt-bin and this is my first email
to the group, so I apologize in advance if my questions are too naive!

So, I am trying to access VMs running on xen3.2 hypervisor (host with
kernel 2.6.24-24-xen) using virt-manager installed on a machine
running Ubuntu 9.04 (client machine). I got to the point where I can
connect to my virtual machine and my domain-0 through the virt-manager
client (meaning that I already have libvirt, ssh-askpass downloaded
and the libvirtd and xend running on my host machine), and on the
client machine I can view the window showing the statistics of CPU
utilization of my domain-0 and user domain. The attachment shows a
shapshot of the virt-manager on my client machine.

Now when I try to access the GUI of either of domain-0 or the user
domain (by selecting the specific domain and clicking open) I get the
following error message in a pop-up on my client and in the libvirtd
console on the host:

"libvir: Domain error xen_2: invalid argument in virDomainGetXMLDesc"

I tried to Google this error, but I don't find any clear answers. It
seems to be a bug in the libvirt implementation that has been detected
and resolved already. And I am confused as to why is it that such a
recent version is still buggy? Should I have downloded another version
instead?=A0 I desperately wish to resolve this problem and would
appreciate any guidance.


Many thanks!
--
Priya Bhat

["ScreenShot_virtManager.jpg" (image/jpeg)]

</body></email><email><emailId>20100727091940</emailId><senderName>Songwen Liao</senderName><senderEmail>songwen.liao@gmail.com</senderEmail><timestampReceived>2010-07-27 09:19:40-0400</timestampReceived><subject>[libvirt-users] libvirt use spice</subject><body>

Hifriends

i am the new guy for here...i met a problem with libvirt.

i create a new virtual machine with kvm,i want to use the spice protocol to
connect the machine's destop.
but it's appears that libvirt cannot support spice.

So,any idears,what should i do,a patch file ?

thanks a lot.
-- 
Name:   Ben
-----------------------------------------------------------------------------------------------
Mobile:  15800910495
Msn:    liaosongwen@live.cn
QQ:     43455134

[Attachment #3 (text/html)]

&lt;div&gt;Hifriends&lt;/div&gt;
&lt;div&gt;&lt;/div&gt;
&lt;div&gt;i am the new guy for here...i met a problem with libvirt.&lt;/div&gt;
&lt;div&gt;&lt;/div&gt;
&lt;div&gt;i create a new virtual machine with kvm,i want to use the spice protocol to \
connect the machine's destop.&lt;/div&gt; &lt;div&gt;but it's appears that libvirt cannot \
support spice.&lt;/div&gt; &lt;div&gt;&lt;/div&gt;
&lt;div&gt;So,any idears,what should i do,a patch file ?&lt;/div&gt;
&lt;div&gt;&lt;/div&gt;
&lt;div&gt;thanks a lot.&lt;br&gt;-- &lt;br&gt;&lt;/div&gt;
&lt;div&gt;Name: \
Ben&lt;br&gt;-----------------------------------------------------------------------------------------------&lt;/div&gt;
 &lt;div&gt;Mobile: 15800910495&lt;br&gt;Msn:  &lt;a \
href="mailto:liaosongwen@live.cn" target="_blank"&gt;liaosongwen@live.cn&lt;/a&gt;&lt;/div&gt; \
&lt;div&gt;QQ: 43455134&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20100727124244</emailId><senderName>Bruno Costa</senderName><senderEmail>brunogain@gmail.com</senderEmail><timestampReceived>2010-07-27 12:42:44-0400</timestampReceived><subject>Re: [libvirt-users] Using Java bindings to event callback</subject><body>

Any help on this subject?

Thanks,
Bruno Costa

On Fri, 2010-07-16 at 13:49 +0100, Bruno Costa wrote: 
&gt; I'm trying to build a trivial example code. Something like this in the
&gt; main():
&gt; 
&gt; 
&gt; conn = new Connect("qemu:///session", false);
&gt; 
&gt; VirConnectDomainEventGenericCallback cb = new 
&gt; VirConnectDomainEventGenericCallback() {
&gt; public void eventCallback(ConnectionPointer arg0, DomainPointer(arg1,
&gt; Pointer arg2) { 
&gt; System.out.println("event happened!");
&gt; }
&gt; };
&gt; 
&gt; int pointer = conn.domainEventRegisterAny(null, 0, cb);
&gt; 
&gt; Is this example, I'm trying to catch events of type 0
&gt; ( VIR_DOMAIN_EVENT_ID_LIFECYCLE) to a callback(cb). But I think this way
&gt; is not correct, because the execution should stop and I should see the
&gt; events in the output.
&gt; 
&gt; The idea is to write my own callbacks to catch the events, without
&gt; having to poll the state of the resources. I have seen the code in
&gt; python, namely event-test.py, and realized that there are helper classes
&gt; (such virEventLoop*) and I might need something similar in Java... But I
&gt; can't find any examples.
&gt; 
&gt; Thanks,
&gt; Bruno Costa
&gt; 
&gt; 
&gt; On Fri, 2010-07-16 at 07:34 -0400, Bryan Kearney wrote: 
&gt; &gt; On 07/16/2010 05:58 AM, Bruno Costa wrote:
&gt; &gt; &gt; I'm having some trouble using java bindings for domain events. Can
&gt; &gt; &gt; anyone provide me an example on how to use this, namely
&gt; &gt; &gt; conn.domainEventRegisterAny?
&gt; &gt; 
&gt; &gt; This is pretty new code, so there may not be many examples. What issues 
&gt; &gt; are you seeing, maybe we can figure them out.
&gt; &gt; 
&gt; &gt; -- bk
&gt; &gt; 
&gt; 


</body></email><email><emailId>20100728214724</emailId><senderName>Dale Amon</senderName><senderEmail>amon@vnl.com</senderEmail><timestampReceived>2010-07-28 21:47:24-0400</timestampReceived><subject>Re: [libvirt-users] Hello world help needed</subject><body>

I have still not managed to get the monitor to work,
but at least I've got vnc and ssh so that's some
progress.

I've had to bump the loop_max value *way* up to let
me get any work done... it's not just failed builds
that seem to hang a loopback forever, it appears that
any vm build leaves a loopback behind that can only
be removed by reboot, and servers are not things you
reboot very often. Under normal conditions the server
I was working on might get rebooted once a year. Or 
less.

But I have made some progress. Next item: qemu indicates
that it can map a host drive to the VM, and I need to
do this. I've got a 1.5TB drive that the new VM has to
mount. I cannot seem to see how to express this mapping
of host /dev/sdc to an internal VM mount.

Any one know how to do it?

</body></email><email><emailId>20100729094355</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-07-29 09:43:55-0400</timestampReceived><subject>Re: [libvirt-users] Too many active clients?</subject><body>

On Wed, Jul 28, 2010 at 06:35:20PM -0700, jeremy avnet wrote:
&gt; Hello,
&gt; 
&gt; I'm receiving a lot of these since a couple of days ago:
&gt; 
&gt; libvirtd: 16:30:10.960: error : qemudDispatchServer:1282 : Too many active
&gt; clients (20), dropping connection
&gt; 
&gt; I'm trying to figure out where all these active clients are coming from. I
&gt; have a daemon running the interacts with libvirtd, but it only creates two
&gt; long-lived connections (I'm very sure). What constitutes an active
&gt; connection?

Any app connecting to libvirt counts as a client (virsh, virt-manager,
etc). You can try using 'lsof' to find what apps have connections open

/etc/libvirt/libvirtd.conf can be used to increase the number of
connections

&gt; The only other libvirtd access that goes on are some quick lived munin
&gt; process which connect in various ways and using virsh on the command line.
&gt; 
&gt; Libvirt version 0.7.5-5ubuntu27 on Ubuntu 10.04.


Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100729141327</emailId><senderName>Zhang Qian</senderName><senderEmail>zhq527725@gmail.com</senderEmail><timestampReceived>2010-07-29 14:13:27-0400</timestampReceived><subject>[libvirt-users] virDomainSetSchedulerParameters() does not support KVM?</subject><body>

Hi,

I have one RHEL 5.5 Xen box and one RHEL 5.5 KVM box. In the Xen box, the
following command works well:
$ virsh schedinfo RHELu3T
Scheduler      : credit
weight         : 256
cap            : 0

But in KVM box, it can not work:
$ virsh schedinfo RHEL5u3
Scheduler      : Unknown
error: this function is not supported by the hypervisor:
virDomainGetSchedulerType

Is it because that the libvirt APIs virDomainGetSchedulerParameters() and
virDomainSetSchedulerParameters() does not support KVM?
Is there any plan for libvirt to support that? Or any equivalent in libvirt
can be used to do the same thing for KVM=A3=BF


Thanks!
Qian

[Attachment #3 (text/html)]

Hi,&lt;br&gt;&lt;br&gt;I have one RHEL 5.5 Xen box and one RHEL 5.5 KVM box. In the Xen=
 box, the following command works well:&lt;br&gt;$ virsh schedinfo RHELu3T&lt;br&gt;Sch=
eduler : credit&lt;br&gt;weight&amp;n=
bsp; : 256&lt;br&gt;cap&amp;nbs=
p; : 0&lt;br&gt;&lt;br&gt;
But in KVM box, it can not work:&lt;br&gt;$ virsh schedinfo RHEL5u3&lt;br&gt;Scheduler&amp;=
nbsp; : Unknown&lt;br&gt;error: this function is not supp=
orted by the hypervisor: virDomainGetSchedulerType&lt;br&gt;&lt;br&gt;Is it because tha=
t the libvirt APIs virDomainGetSchedulerParameters() and virDomainSetSchedu=
lerParameters() does not support KVM?&lt;br&gt;
Is there any plan for libvirt to support that? Or any equivalent in libvirt=
 can be used to do the same thing for KVM=A3=BF&lt;br&gt;&lt;br&gt;&lt;br&gt;Thanks!&lt;br&gt;Qian&lt;=
br&gt;&lt;br&gt;


</body></email><email><emailId>20100612073707</emailId><senderName>Arseny Klimovsky</senderName><senderEmail>arseny.klimovsky@gmail.com</senderEmail><timestampReceived>2010-06-12 07:37:07-0400</timestampReceived><subject>[libvirt-users] Functionality of virsh net-edit</subject><body>

Hi,

I am using version libvirt on debian lenny from backports repository,
version 0.7.6-1~bpo50+1, amd64.

Th functionality of "virsh net-edit" command is not very clearly
documented, and I think it should change a configuration of a running
network. But I see it doesn't.
So, I want to add new host, for example:

#I have old configuration
root@xxx:/etc/libvirt/qemu/networks# virsh net-edit default
Network default XML configuration edited.
#Here I added new line: new host definition

root@xxx:/etc/libvirt/qemu/networks# cat default.xml
#Here I see that new line

root@xxx:/etc/libvirt/qemu/networks# virsh net-dumpxml default
root@xxx:/etc/libvirt/qemu/networks# virsh net-edit default
#Here I see exactly the old network definition

Is this behaviour expected?

If yes, how to just add new host on a running network?

--
Arseny Klimovsky

</body></email><email><emailId>20100615201028</emailId><senderName></senderName><senderEmail>steven765@yahoo.com</senderEmail><timestampReceived>2010-06-15 20:10:28-0400</timestampReceived><subject>[libvirt-users] SCM_RIGHTS file error when attaching device?</subject><body>

So I just upgraded to 0.8.1-1 and virt-manager 8.4 when i try to attach my network card that's been perfectly fine in the past i now get...

virsh # attach-device gnome /etc/libvirt/qemu/nic.xml
error: Failed to attach device from /etc/libvirt/qemu/nic.xml
error: internal error unable to send TAP file handle: No file descriptor supplied via SCM_RIGHTS

Any thoughts? 


      

</body></email><email><emailId>20100616123441</emailId><senderName>Julian Robbins</senderName><senderEmail>julian.robbins@q-par.com</senderEmail><timestampReceived>2010-06-16 12:34:41-0400</timestampReceived><subject>[libvirt-users] howto search this mailing list archive?</subject><body>

Another quickie

I've long and hard (honest !), but can't find a way to search this ml's 
archives. How do you do this ?

-- 
Kind regards

Julian Robbins

</body></email><email><emailId>20100616150201</emailId><senderName>Zhang Qian</senderName><senderEmail>zhq527725@gmail.com</senderEmail><timestampReceived>2010-06-16 15:02:01-0400</timestampReceived><subject>[libvirt-users] libvirt API hangs</subject><body>

Hi,

I have someVMs in my KVM hosts(RHEL 5.5), I found when run "virsh save
&lt;domain&gt; &lt;file&gt;" to save a VM, the command "virsh dominfo &lt;domain&gt;" will
hang until the save command finishes.
Is this libvirt's behavior? Or KVM/QEMU's? This may impact the performance.


Thanks,
Qian

[Attachment #3 (text/html)]

Hi,&lt;br&gt;&lt;br&gt;I have someVMs in my KVM hosts(RHEL 5.5), I found when run "virsh \
save &lt;domain&gt; &lt;file&gt;" to save a VM, the command "virsh dominfo \
&lt;domain&gt;" will hang until the save command finishes.&lt;br&gt; Is this \
libvirt's behavior? Or KVM/QEMU's? This may impact the \
performance.&lt;br&gt;&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;Qian&lt;br&gt;



</body></email><email><emailId>20100617093433</emailId><senderName>Julian Robbins</senderName><senderEmail>julian.robbins@q-par.com</senderEmail><timestampReceived>2010-06-17 09:34:33-0400</timestampReceived><subject>[libvirt-users] cannot acquire state change lock</subject><body>

Hi

I keep getting libvirtError: Timed out during operation: cannot acquire 
state change lock
errors - what does this mean exactly ?

Using Ubuntu 64 bit 10.04 host and guest

-- 
Kind regards

Julian Robbins

</body></email><email><emailId>20100615121153</emailId><senderName>Julian Robbins</senderName><senderEmail>julian.robbins@q-par.com</senderEmail><timestampReceived>2010-06-15 12:11:53-0400</timestampReceived><subject>[libvirt-users] Snapshots - can't take a snapshot with running VM</subject><body>

Hi

I'm quite new to KVM/libvirt0 so hope you can help

I'm using Ubuntu Lucid 10.04 and libvirt0 0.8.1

When I try a :-

snapshot create vm_name

I get an error, ie 'error -5 while writing'

Googling doesnt bring anything up. Taking snapshots of a vm when it isnt 
running works fine.

Can I really only create snapshots of a vm when it isnt running ?

-- 
Kind regards

Julian

</body></email><email><emailId>20100615130339</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2010-06-15 13:03:39-0400</timestampReceived><subject>Re: [libvirt-users] Snapshots - can't take a snapshot with running VM</subject><body>

On 06/15/10 - 01:11:53PM, Julian Robbins wrote:
&gt; Hi
&gt; 
&gt; I'm quite new to KVM/libvirt0 so hope you can help
&gt; 
&gt; I'm using Ubuntu Lucid 10.04 and libvirt0 0.8.1
&gt; 
&gt; When I try a :-
&gt; 
&gt; snapshot create vm_name
&gt; 
&gt; I get an error, ie 'error -5 while writing'
&gt; 
&gt; Googling doesnt bring anything up. Taking snapshots of a vm when it
&gt; isnt running works fine.
&gt; 
&gt; Can I really only create snapshots of a vm when it isnt running ?

No, you should be able to take a snapshot both while it is running and
while it is off.  However, they use different mechanisms so there could be
a bug in the online version.  What version of qemu/kvm are you running?
Also, do you have apparmor enabled/running?  If so, and if the apparmor policy
hasn't been updated, that might be the source of your problems.

--
Chris Lalancette

</body></email><email><emailId>20100617171436</emailId><senderName>Rafael Braga</senderName><senderEmail>rafaeltelematica@gmail.com</senderEmail><timestampReceived>2010-06-17 17:14:36-0400</timestampReceived><subject>[libvirt-users] java.lang.UnsatisfiedLinkError: jnidispatch (/com/sun/jna/linux-i386/libjnidispatch.</subject><body>

[Attachment #2 (multipart/alternative)]


Hi everybody,

    I'm trying to run the sample of the site, but is not working. In fact,
already includes jna.jar in my class path, see.
What can it be?

-- 
Rafael Braga

[Attachment #5 (text/html)]

&lt;span id="result_box" class="medium_text"&gt;&lt;span style="background-color: rgb(255, \
255, 255);" title="Oi todos," \
onmouseover="this.style.backgroundColor='#ebeff9'" \
onmouseout="this.style.backgroundColor='#fff'"&gt;Hi everybody,&lt;br&gt;


&lt;br&gt;    &lt;/span&gt;&lt;span style="background-color: rgb(255, 255, 255);" title="Estou \
tentando executar o exemplo do site, mas no est funcionando." \
onmouseover="this.style.backgroundColor='#ebeff9'" \
onmouseout="this.style.backgroundColor='#fff'"&gt;I'm trying to run the \
sample of the site, but is not working. &lt;/span&gt;&lt;span style="background-color: \
rgb(255, 255, 255);" title="A rigor, j inclui o jna.jar no meu class path, vejam." \
onmouseover="this.style.backgroundColor='#ebeff9'" \
onmouseout="this.style.backgroundColor='#fff'"&gt;In fact, already includes \
jna.jar in my class path, see. &lt;br&gt;

What can it be?&lt;/span&gt;&lt;/span&gt;&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;Rafael Braga&lt;br&gt;

--0016e64e575e59aa4c04893cfaf3--


["Captura_de_tela-1.png" (image/png)]

</body></email><email><emailId>20100619111544</emailId><senderName>Ryota Ozaki</senderName><senderEmail>ozaki.ryota@gmail.com</senderEmail><timestampReceived>2010-06-19 11:15:44-0400</timestampReceived><subject>[libvirt-users] How to get supported feature list in driver</subject><body>

Hello

Is there an easy way to get supported feature (API) list in each driver?
The function would be to return a list which describes which APIs are
supported and which APIs are not.

Thanks in advance
  ozaki-r

</body></email><email><emailId>20100620075308</emailId><senderName>"Development"</senderName><senderEmail>development@simulamen.eu</senderEmail><timestampReceived>2010-06-20 07:53:08-0400</timestampReceived><subject>[libvirt-users] Obtaining UTC Time from Remote VM Host</subject><body>

Quick question on whether it is possible to use the libvirt API exposed by
the libvirt DLL compiled on a Vista machine to obtain the system time in UTC
of the remote machine hosting several VMs?  Many thanks...

 

 


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;meta http-equiv=Content-Type content="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 12 (filtered medium)"&gt;
&lt;style&gt;
&lt;!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;}
div.WordSection1
	{page:WordSection1;}
--&gt;
&lt;/style&gt;
&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapelayout v:ext="edit"&gt;
  &lt;o:idmap v:ext="edit" data="1" /&gt;
 &lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
&lt;/head&gt;

&lt;body lang=EN-GB link=blue vlink=purple&gt;

&lt;div class=WordSection1&gt;

&lt;p class=MsoNormal&gt;Quick question on whether it is possible to use the libvirt
API exposed by the libvirt DLL compiled on a Vista machine to obtain the system
time in UTC of the remote machine hosting several VMs? Many \
thanks...&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;



</body></email><email><emailId>20100617150120</emailId><senderName>Aleksander Trofimowicz</senderName><senderEmail>aatrof@gmail.com</senderEmail><timestampReceived>2010-06-17 15:01:20-0400</timestampReceived><subject>[libvirt-users] network interface management in bridge firewall configuration</subject><body>

Hello,

I'm just wondering why I can't manage my network interfaces  through
libvirt when the following kernel parameters are turned on:

net.bridge.bridge-nf-call-ip6tables
net.bridge.bridge-nf-call-iptables
net.bridge.bridge-nf-call-arptables

Is it a bug or by design? If the latter, could someone explain me
premises of such decision? I'm aware of security implications of
mixing conntrack and bridge bits, so we can skip that point.

This behaviour is noticeable when using:
libvirt-0.8.1-1.fc13.x86_64
netcf-libs-0.1.6-1.fc13.x86_64

-- 
thanks,
aleksander trofimowicz

</body></email><email><emailId>20100623122056</emailId><senderName>Joel Uckelman</senderName><senderEmail>uckelman@nomic.net</senderEmail><timestampReceived>2010-06-23 12:20:56-0400</timestampReceived><subject>[libvirt-users] can't access VM after Fedora 13 KVM install</subject><body>

Hi,

I'm installing a Fedora 13 virtual host on a Fedora 13 system, like this:

virt-install --ram 2048 --vcpus 4 --name test --os-type linux \
  --os-variant fedora13 --disk /var/lib/libvirt/images/test.img,size=10 \
  --cdrom /var/lib/libvirt/Fedora-13-x86_64-DVD.iso --vnc --noautoconsole

I connect to the installer using virt-manager, and the install appears to
complete successfully. Then, I reboot the virtual machine and reconnect
with virt-manager. What I see is this:

  Starting SeaBios (version 0.5.1)

  gPXE (http://etherboot.org) - 00:04.0 C900 PCI2.10 PnP BBS PMM7FE0@10 C900

  Booting from Hard Disk...

If I connect to the VM's console using 'virsh console', there's no output
at all. I don't see anything in /var/log/messages or /var/log/libvirt that
looks like an error.

So, I'm not sure what's going on here, as this is the first time I've done
anything with virtualization. Has my VM hung, or is this what's supposed to
happen? I was expecting that somewhere along the line that my VM would get
an IP address via DHCP so I could SSH to it, but don't see anything indicating
that has happend, or what the IP address is if it has. Is something broken
here, or have I missed a crucial step?

-- 
J.

</body></email><email><emailId>20100624161540</emailId><senderName>Christian Patsch</senderName><senderEmail>christian.patsch@gonicus.de</senderEmail><timestampReceived>2010-06-24 16:15:40-0400</timestampReceived><subject>[libvirt-users] VirtualBox headless</subject><body>

Hello,

I'm trying to use the VirtualBox/vbox driver together with libvirt 0.8.1
on a Ubuntu Lucid Machine, VirtualBox Release 3.1.

The goal is to run the virtual machines headless and to connect using RDP.

When starting a virtual domain using 'virsh start &lt;domainname&gt;' the GUI
of VirtualBox will pop up and I see no option to prevent this. If X is
not running, the virsh command will terminate with 'unknown failure'.

I've found some hints on inclusion of the headless statement in the
'graphics' part of the XML definition file, but when I tree to adopt
this, the editing of the file will crash.

Has anyone achieved to manage VBox machines with libvirt on a headless
server ?

Thanks in advance for some hints or experiences with this issue,
Christian

</body></email><email><emailId>20100628151432</emailId><senderName>Christian Patsch</senderName><senderEmail>christian.patsch@gonicus.de</senderEmail><timestampReceived>2010-06-28 15:14:32-0400</timestampReceived><subject>[libvirt-users] VirtualBox driver : creating storage for a new machine</subject><body>

Hi,

Another thing I'm strugglin with:

When creating a new domain from scratch using the proposed XML format in
the documentation, everything works fine - basically. A problem that I'd
like to solve now is that I would expect to be able to create new
volumes within libvirt.

I started with a basic XML file in order to define a pool, but virsh
told me that creating pools is not supported by the VirtualBox hypervisor.

&gt;From the code and different hints I learned that there is only one pool
with a dummy UUID, named "default-pool".

Next I tried to create a new volume from a XML file, but the only thing
I'm getting are segmentation faults.

Has anybody used this approach successfully ?

Otherwise I assume that I have to create the VDI files manually using
VirtualBox GUI/VBoxManage or vboxshell.py.

Thanks in advance,

Regards,
Christian

</body></email><email><emailId>20100624162720</emailId><senderName>"Jean-Baptiste Rouault"</senderName><senderEmail>jean-baptiste.rouault@diateam.net</senderEmail><timestampReceived>2010-06-24 16:27:20-0400</timestampReceived><subject>Re: [libvirt-users] VirtualBox headless</subject><body>

Hi,

Something like this should work, as can be seen in the
documentation here : http://libvirt.org/formatdomain.html#elementsGraphics

&lt;drivers&gt;
  &lt;graphics type='rdp' autoport='yes' /&gt;
&lt;/drivers&gt;

Regards,

Jean-Baptiste

&gt; Hello,
&gt; 
&gt; I'm trying to use the VirtualBox/vbox driver together with libvirt 0.8.1
&gt; on a Ubuntu Lucid Machine, VirtualBox Release 3.1.
&gt; 
&gt; The goal is to run the virtual machines headless and to connect using RDP.
&gt; 
&gt; When starting a virtual domain using 'virsh start &lt;domainname&gt;' the GUI
&gt; of VirtualBox will pop up and I see no option to prevent this. If X is
&gt; not running, the virsh command will terminate with 'unknown failure'.
&gt; 
&gt; I've found some hints on inclusion of the headless statement in the
&gt; 'graphics' part of the XML definition file, but when I tree to adopt
&gt; this, the editing of the file will crash.
&gt; 
&gt; Has anyone achieved to manage VBox machines with libvirt on a headless
&gt; server ?
&gt; 
&gt; Thanks in advance for some hints or experiences with this issue,
&gt; Christian
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt; 

</body></email><email><emailId>20100622184556</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-06-22 18:45:56-0400</timestampReceived><subject>Re: [libvirt-users] Obtaining UTC Time from Remote VM Host</subject><body>

2010/6/20 Development &lt;development@simulamen.eu&gt;:
&gt; Quick question on whether it is possible to use the libvirt API exposed by
&gt; the libvirt DLL compiled on a Vista machine to obtain the system time in UTC
&gt; of the remote machine hosting several VMs?   Many thanks...
&gt;

There is no such feature in libvirt yet. But there is no reason why a
function like

   time_t virConnectGetCurrentTime(virConnectPtr conn);

could not be added to libvirt.

Matthias

</body></email><email><emailId>20100621072929</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2010-06-21 07:29:29-0400</timestampReceived><subject>Re: [libvirt-users] How to get supported feature list in driver</subject><body>

On Sat, Jun 19, 2010 at 08:15:44PM +0900, Ryota Ozaki wrote:
&gt; Hello
&gt; 
&gt; Is there an easy way to get supported feature (API) list in each driver?
&gt; The function would be to return a list which describes which APIs are
&gt; supported and which APIs are not.

  No, and it's somehow painful. If unsupported you will get a specific
error code back though, so maybe that can be automated in some ways.
There is the manually maintained page for driver support at
  http://libvirt.org/hvsupport.html
but being manual means it's often outdated :-\
Also there is some subtleties, for example on Xen the main driver is
actually implemenbted as a set of 3 sub-drivers for hv/xend/xenstore
so just checking for NULL values in the driver entry point is not
completely sufficient to assert support of a feature.

Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

</body></email><email><emailId>20100630093506</emailId><senderName>Leopold Palomo-Avellaneda</senderName><senderEmail>leo@alaxarxa.net</senderEmail><timestampReceived>2010-06-30 09:35:06-0400</timestampReceived><subject>[libvirt-users] Some missunderstanding in the wiki page</subject><body>

Hi,

I'm not in the list and I just would like to comment it to the comunity. So, 
if someone want to contact me, make CC to me in the reply.

The wiki page [1] talk about networking, and show two typical configurations:
"virtual network" and "shared physical device". 

The shared physical device has an error or something that could make confused, 
I think. What I want to say? In my case, I have a box with several nics, and 
I want to speciffy that ethX should be used exclusively but virtual domain X.

The documentation is clear in this: The NAT based connectivity is useful for 
quick &amp; easy deployments, or on machines with dynamic/sporadic networking 
connectivity. More advanced users will want to use full bridging, where the 
guest is connected directly to the LAN. 

The configuration (I have follow only the debian/ubuntu steps) shows that br0 
has assigned an IP. I did the mistake to try to assign the same IP in the 
guest network configuration, I understand that, and obviously it doesn't work 
(duplicate IPs). So, to me, it would me more clear if the br0 interface has 
no IP. In my case, I have two nics: eth0 the interface for the host and eth1 
for the guest. The eth1 part in my network/interfaces is:

...
auto eth1
iface eth1 inet manual

auto br0
iface br0 inet manual
        bridge_ports  eth1
        bridge_stp    on
        bridge_maxwait  0
        bridge_fd       0
...

and then in the guest you configure the IP as you want. In the host, eth1 (or 
whatever interface you bridge) has no IP, so it's not used, and the guest 
uses completely.

What do you think?

Regards,

Leo


[1] http://wiki.libvirt.org/page/Networking

</body></email><email><emailId>20100701081102</emailId><senderName>Leopold Palomo-Avellaneda</senderName><senderEmail>leo@alaxarxa.net</senderEmail><timestampReceived>2010-07-01 08:11:02-0400</timestampReceived><subject>Re: [libvirt-users] Some missunderstanding in the wiki page</subject><body>

A Dimecres 30 Juny 2010, Tom Hughes va escriure:
&gt; On 30/06/10 10:35, Leopold Palomo-Avellaneda wrote:
&gt; &gt; The configuration (I have follow only the debian/ubuntu steps) shows that
&gt; &gt; br0 has assigned an IP. I did the mistake to try to assign the same IP in
&gt; &gt; the guest network configuration, I understand that, and obviously it
&gt; &gt; doesn't work (duplicate IPs). So, to me, it would me more clear if the
&gt; &gt; br0 interface has no IP. In my case, I have two nics: eth0 the interface
&gt; &gt; for the host and eth1 for the guest. The eth1 part in my
&gt; &gt; network/interfaces is:
&gt; &gt;
&gt; &gt; ...
&gt; &gt; auto eth1
&gt; &gt; iface eth1 inet manual
&gt; &gt;
&gt; &gt; auto br0
&gt; &gt; iface br0 inet manual
&gt; &gt;          bridge_ports  eth1
&gt; &gt;          bridge_stp    on
&gt; &gt;          bridge_maxwait  0
&gt; &gt;          bridge_fd       0
&gt; &gt; ...
&gt; &gt;
&gt; &gt; and then in the guest you configure the IP as you want. In the host, eth1
&gt; &gt; (or whatever interface you bridge) has no IP, so it's not used, and the
&gt; &gt; guest uses completely.
&gt;
&gt; The common configuration that the wiki is documenting is presumably the
&gt; case where the host has a single ethernet interface that is shared by
&gt; the host and the guests. In that configuration the bridge does have an
&gt; address, which is the address of the host machine.

and then you can assign _another_ IP to the guest or must assign the same?

&gt; Basically a bridge is like a virtual ethernet switch inside your
&gt; machine, where one port is connected to each device that is enslaved to
&gt; it and another port is connected to the kernel's IP stack - that port
&gt; appears as the brN interface and can have an IP address (for the host)
&gt; assigned to it.

but, my main doubts is about to have a sever with several nics and several 
guest. I think that a good approach (if it's possbile) is to have a an 
specific nic for each guest. No?

Regards,

Leo


</body></email><email><emailId>20100615165331</emailId><senderName>Julian Robbins</senderName><senderEmail>julian.robbins@q-par.com</senderEmail><timestampReceived>2010-06-15 16:53:31-0400</timestampReceived><subject>Re: [libvirt-users] Snapshots - can't take a snapshot with running VM</subject><body>


&gt; &gt;  Can I really only create snapshots of a vm when it isnt running ?
&gt;
&gt; No, you should be able to take a snapshot both while it is running and
&gt; while it is off.  However, they use different mechanisms so there could be
&gt; a bug in the online version.  What version of qemu/kvm are you running?
&gt; Also, do you have apparmor enabled/running?  If so, and if the apparmor policy
&gt; hasn't been updated, that might be the source of your problems.
&gt;    

Thanks for your reply. Oddly, I didnt receive an email to me, but only 
in the archives !

I've disabled AppArmor for now and it works fine, so there is some 
unwanted issue there. Strangely, looking again apparmor is still enabled 
when guest is running after reboot. Possibly rebooting the guest and 
using dynamic appamor instead of static has helped ?

I'm using vers 1.84 of QEMU/Kvm from dnjl's PPA for Lucid.

-- 
Kind regards

Julian

</body></email><email><emailId>20100617104056</emailId><senderName>Julian Robbins</senderName><senderEmail>julian.robbins@q-par.com</senderEmail><timestampReceived>2010-06-17 10:40:56-0400</timestampReceived><subject>Re: [libvirt-users] Snapshots - can't take a snapshot with running VM</subject><body>

On 15/06/10 17:53, Julian Robbins wrote:
&gt; &gt; &gt; Can I really only create snapshots of a vm when it isnt running ?
&gt; &gt; No, you should be able to take a snapshot both while it is running and
&gt; &gt; while it is off.  However, they use different mechanisms so there 
&gt; &gt; could be
&gt; &gt; a bug in the online version.  What version of qemu/kvm are you running?
&gt; &gt; Also, do you have apparmor enabled/running?  If so, and if the 
&gt; &gt; apparmor policy
&gt; &gt; hasn't been updated, that might be the source of your problems.
&gt; 
&gt; I've disabled AppArmor for now and it works fine, so there is some 
&gt; unwanted issue there. Strangely, looking again apparmor is still 
&gt; enabled when guest is running after reboot. Possibly rebooting the 
&gt; guest and using dynamic appamor instead of static has helped ?
&gt; 
&gt; I'm using vers 1.84 of QEMU/Kvm from dnjl's PPA for Lucid.

After trying again, I can no longer get snapshots to work whilst vm 
guest in running.

I have disabled apparmor so that it is only in 'complain' mode on the 
host, but still get :-

Error -5 while writing VM

whilst trying a

virsh # snapshot-create openerp

Whether running virsh as normal user or root. I'm also getting

'libvirtError: Timed out during operation: cannot acquirestate change lock' errors \
too, after I've tried to take a snapshot.


So it appears that perhaps there is a bug where snapshots cannot always 
be made online. I have taken some successful snapshots online, but none 
recently.

Interestingly, I can never get the 'Security' setting in the guest to 
stick to be 'none' for the apparmor Model either static or dynamic. Even 
after a reboot of the guest, the setting stays always to dynamic.

Hoping someone can help - don't want to leave using KVM/libvirt .....

-- 
Kind regards

Julian


</body></email><email><emailId>20100614131405</emailId><senderName>Guido Winkelmann</senderName><senderEmail>guido-libvi@unknownsite.de</senderEmail><timestampReceived>2010-06-14 13:14:05-0400</timestampReceived><subject>[libvirt-users] Documentation Bug: struct virSchedParameter missing value field</subject><body>

Hi,

The libvirt documentation under

http://libvirt.org/html/libvirt-libvirt.html#virSchedParameter

fails to list the "value" member, even though that is kind of essential for 
using the struct.

This is what the documentation says:

struct virSchedParameter{
  charfield[VIR_DOMAIN_SCHED_FIELD_LENGTH]  field   : parameter name
  int  type   : parameter type
  }

This is how it looks in the actual header file:

typedef struct _virSchedParameter virSchedParameter;

struct _virSchedParameter {
    char field[VIR_DOMAIN_SCHED_FIELD_LENGTH];  /* parameter name */
    int type;   /* parameter type */
    union {
        int i;                          /* data for integer case */
        unsigned int ui;        /* data for unsigned integer case */
        long long int l;        /* data for long long integer case */
        unsigned long long int ul;      /* data for unsigned long long integer 
case */
        double d;       /* data for double case */
        char b;         /* data for char case */
    } value; /* parameter value */
};

This one had me scratching my head for a while, because the way it is 
documented, it's absolutely not clear how the struct is supposed to be used. 
Only after studying the virsh source code for a while did I notice that this 
struct apparently has more members than the documentation lets on...

	Guido

</body></email><email><emailId>20100614143757</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-06-14 14:37:57-0400</timestampReceived><subject>Re: [libvirt-users] Functionality of virsh net-edit</subject><body>

On 06/12/2010 03:37 AM, Arseny Klimovsky wrote:
&gt; Hi,
&gt; 
&gt; I am using version libvirt on debian lenny from backports repository,
&gt; version 0.7.6-1~bpo50+1, amd64.
&gt; 
&gt; Th functionality of "virsh net-edit" command is not very clearly
&gt; documented, and I think it should change a configuration of a running
&gt; network. But I see it doesn't.
&gt; So, I want to add new host, for example:
&gt; 
&gt; #I have old configuration
&gt; root@xxx:/etc/libvirt/qemu/networks# virsh net-edit default
&gt; Network default XML configuration edited.
&gt; #Here I added new line: new host definition
&gt; 
&gt; root@xxx:/etc/libvirt/qemu/networks# cat default.xml
&gt; #Here I see that new line
&gt; 
&gt; root@xxx:/etc/libvirt/qemu/networks# virsh net-dumpxml default
&gt; root@xxx:/etc/libvirt/qemu/networks# virsh net-edit default
&gt; #Here I see exactly the old network definition
&gt; 
&gt; Is this behaviour expected?
&gt; 
&gt; If yes, how to just add new host on a running network?
&gt; 

net-dumpxml (also used by net-edit) by default shows the current config
of the network. Changes made with net-edit on a running network won't
take effect until the network is restarted, so net-dumpxml won't show
the changed config right away for a running network.

Libvirt doesn't support changing the configuration of a running network,
so any changes will require a network restart with net-destroy;
net-start. This should be documented better.

- Cole

</body></email><email><emailId>20100615095150</emailId><senderName>Gunnar Thielebein</senderName><senderEmail>gunnar_thielebein@gmx.net</senderEmail><timestampReceived>2010-06-15 09:51:50-0400</timestampReceived><subject>Re: [libvirt-users] Problems moving qemu machine to libvirt</subject><body>

Hi Erik,

thanks for the solution provided.
I tried that but unfortunately it spits out this error message:

&gt; Traceback (most recent call last):
&gt;   File "/usr/share/virt-manager/virtManager/engine.py", line 588, in run_domain
&gt;     vm.startup()
&gt;   File "/usr/share/virt-manager/virtManager/domain.py", line 150, in startup
&gt;     self._backend.create()
&gt;   File "/usr/lib/python2.6/dist-packages/libvirt.py", line 300, in create
&gt;     if ret == -1: raise libvirtError ('virDomainCreate() failed', dom=self)
&gt; libvirtError: internal error cannot parse QEMU version number in ''

Looks to me that libvirt does some version checks with the emulator-node and
don't get reliable output.

The wrapper script:

/etc/libvirt/kvmvde:
&gt; #!/bin/bash
&gt; exec /usr/bin/kvm "$@" \
&gt;         -net nic,vlan=0,model=virtio,macaddr=52:54:61:44:21:23 \
&gt;         -net vde,vlan=0,group=libvirtd,mode=0770,sock=/var/run/vde.ctl

The xml section:

...
&gt;   &lt;devices&gt;
&gt;     &lt;emulator&gt;/etc/libvirt/kvmvde&lt;/emulator&gt;
&gt;     &lt;disk type='file' device='disk'&gt;
&gt;       &lt;source file='/var/lib/libvirt/images/vlxp01-gt/tmp7Jiyzz.qcow2'/&gt;
&gt;       &lt;target dev='hda' bus='ide'/&gt;
&gt;     &lt;/disk&gt;
...

Btw. is the bridge entry really necessary in the xml file?
I wonder if this wouldn't also work, but I am not at this step, currently:
=&gt; http://libvirt.org/formatdomain.html#elementsNICSSlirp
"Generic ethernet connection"

&gt;   ...
&gt;   &lt;devices&gt;
&gt;     &lt;interface type='ethernet'/&gt;
&gt;     ...
&gt;     &lt;interface type='ethernet'&gt;
&gt;       &lt;target dev='vnet7'/&gt;
&gt;       &lt;script path='/etc/qemu-ifup-mynet'/&gt;
&gt;     &lt;/interface&gt;
&gt;   &lt;/devices&gt;
&gt;   ...

Perhaps this is a place to also start the vde hub?

On 10.06.2010 13:34, Erik de Castro Lopo wrote:
&gt;     #!/bin/bash
&gt;     exec /usr/bin/kvm $@ \
&gt;         -net nic,vlan=0,model=rtl8139,macaddr=52:54:61:44:21:23 \
&gt;         -net vde,vlan=0,group=vde2-net,mode=0770,sock=/var/run/kvm-vde-ctl

Any reason no to use the virtio driver?

Best,
Gunnar

</body></email><email><emailId>20100615123353</emailId><senderName>Avdhoot Joshi</senderName><senderEmail>osvdev@gmail.com</senderEmail><timestampReceived>2010-06-15 12:33:53-0400</timestampReceived><subject>[libvirt-users] How to configure kvm development environment</subject><body>

Hi,

Installed RHEL 5.5 on  AMD Opteron.

[root@wlng-ppcore-nd3 ~]# uname -a
Linux wlng-ppcore-nd3 2.6.18-194.el5 #1 SMP Tue Mar 16 21:52:39 EDT 2010
x86_64 x86_64 x86_64 GNU/Linux

[root@wlng-ppcore-nd3 ~]# virsh version
Compiled against library: libvir 0.6.3
Using library: libvir 0.6.3
Using API: QEMU 0.6.3
Running hypervisor: QEMU 0.9.1

This is the default version of virsh using libvirt 0.6.3.

Downloaded libvirt 0.8.1, configured it as follows:

$ configure
$ make
$ make install

What should be done so that virsh uses the latest 0.8.1 libvirtd binary, how
to completely stop 0.6.3?
I want to execute a program using virDomainMemoryStats which is available
only in latest libvirtd.

Thanks,
Avdhoot

[Attachment #3 (text/html)]

Hi,&lt;br&gt;&lt;br&gt;Installed RHEL 5.5 on=A0 AMD Opteron. &lt;br&gt;&lt;br&gt;[root@wlng-ppcore-=
nd3 ~]# uname -a&lt;br&gt;
Linux wlng-ppcore-nd3 2.6.18-194.el5 #1 SMP Tue Mar 16 21:52:39 EDT 2010 x8=
6_64 x86_64 x86_64 GNU/Linux&lt;br&gt;
&lt;br&gt;[root@wlng-ppcore-nd3 ~]# virsh version&lt;br&gt;Compiled against library: li=
bvir 0.6.3&lt;br&gt;Using library: libvir 0.6.3&lt;br&gt;Using API: QEMU 0.6.3&lt;br&gt;Runni=
ng hypervisor: QEMU 0.9.1&lt;br&gt;&lt;br&gt;This is the default version of virsh using=
 libvirt 0.6.3.&lt;br&gt;
&lt;br&gt;Downloaded libvirt 0.8.1, configured it as follows:&lt;br&gt;&lt;br&gt;$ configure =
&lt;br&gt;$ make&lt;br&gt;$ make install&lt;br&gt;&lt;br&gt;What should be done so that virsh uses =
the latest 0.8.1 libvirtd binary, how to completely stop 0.6.3? &lt;br&gt;I want =
to execute a program using virDomainMemoryStats which is available only in =
latest libvirtd.&lt;br&gt;
&lt;br&gt;Thanks,&lt;br&gt;Avdhoot&lt;br&gt;&lt;br&gt;


</body></email><email><emailId>20100616082446</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-06-16 08:24:46-0400</timestampReceived><subject>Re: [libvirt-users] SCM_RIGHTS file error when attaching device?</subject><body>

On Tue, Jun 15, 2010 at 01:10:28PM -0700, steven765@yahoo.com wrote:
&gt; So I just upgraded to 0.8.1-1 and virt-manager 8.4 when i try to attach my network \
&gt; card that's been perfectly fine in the past i now get... 
&gt; virsh # attach-device gnome /etc/libvirt/qemu/nic.xml
&gt; error: Failed to attach device from /etc/libvirt/qemu/nic.xml
&gt; error: internal error unable to send TAP file handle: No file descriptor supplied \
&gt; via SCM_RIGHTS

This is a flaw in QEMU fixed upstream

commit e53f27b9d9df73461308618151fa6e6392aebd85
Author: Paolo Bonzini &lt;pbonzini@redhat.com&gt;
Date:   Fri Apr 16 17:25:23 2010 +0200

    stash away SCM_RIGHTS fd until a getfd command arrives
    
    If there is already a fd in s-&gt;msgfd before recvmsg it is
    closed by parts that this patch does not touch.  So, only
    one descriptor can be "leaked" by attaching it to a command
    other than getfd.
    
    Signed-off-by: Paolo Bonzini &lt;pbonzini@redhat.com&gt;
    Signed-off-by: Luiz Capitulino &lt;lcapitulino@redhat.com&gt;


Regards,
Daniel
-- 
&gt; &gt; Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
&gt; &gt; http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
&gt; &gt; http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
&gt; &gt; GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|


</body></email><email><emailId>20100616122750</emailId><senderName>Julian Robbins</senderName><senderEmail>julian.robbins@q-par.com</senderEmail><timestampReceived>2010-06-16 12:27:50-0400</timestampReceived><subject>[libvirt-users] apparmor and kvm/libvirt</subject><body>

Hi

After kindly answering my question on snapshots not working whilst vm is 
on, i find that apparmor is still disturbing the process where snapshots 
can get written

But although i should just be able to disable apparmor for my vm in 
virt-manager, whilst vm is off; that when i start the vm the apparmor 
settings go back to being enabled and set to dynamic

This is stopping me from taking snapshots again whilst vm is on. :-(

I have also tried disabling the apparmor profile for libvirt on the host 
but this appears to have had no effect. I know very little about appamor 
and it is not particularly important to be used in this case.

I am using Ubuntu 10.04 LTS on both host and guest 64 bit.

-- 
Kind regards

Julian Robbins

</body></email><email><emailId>20100616124204</emailId><senderName>Justin Clift</senderName><senderEmail>justin@salasaga.org</senderEmail><timestampReceived>2010-06-16 12:42:04-0400</timestampReceived><subject>Re: [libvirt-users] howto search this mailing list archive?</subject><body>

On 06/16/2010 10:34 PM, Julian Robbins wrote:
&gt; Another quickie
&gt;
&gt; I've long and hard (honest !), but can't find a way to search this ml's
&gt; archives. How do you do this ?

This will probably sound silly... but using the "site:" option with a 
search engine is reasonably functional:

ie. for Google, do a search on:

   +"stuff" site:http://www.redhat.com/archives/libvir-list/

For ask.com, this works:

   stuff site:http://www.redhat.com/archives/libvir-list/

"stuff" will return results, so is a decent example. :)

Regards and best wishes,

Justin Clift

-- 
Salasaga  -  Open Source eLearning IDE
               http://www.salasaga.org

</body></email><email><emailId>20100616130151</emailId><senderName>Eduardo</senderName><senderEmail>eduardo@freedominterface.org</senderEmail><timestampReceived>2010-06-16 13:01:51-0400</timestampReceived><subject>[libvirt-users] Bridge with macvtap problem</subject><body>

Hi friends!

I'm using libvirt 0.8.1 with qemu-kvm 0.12.4 on Linux 2.6.34. At the 
moment there are 2 virtual machines running inside that host without 
problem. They are using the macvtap feature for networking share. But I 
can't do ping from the host to the guest, but I need this. And whatever 
communication between them. Ping with other host is normal. Below 
follows the xml domain definition of one guest:

&lt;domain type='kvm' id='2'&gt;
&lt;name&gt;vox2&lt;/name&gt;
&lt;uuid&gt;2e143f6e-5506-8073-c5fc-3ea92fc2b579&lt;/uuid&gt;
&lt;memory&gt;524288&lt;/memory&gt;
&lt;currentMemory&gt;524288&lt;/currentMemory&gt;
&lt;vcpu&gt;2&lt;/vcpu&gt;
&lt;os&gt;
&lt;type arch='x86_64' machine='pc-0.12'&gt;hvm&lt;/type&gt;
&lt;boot dev='hd'/&gt;
&lt;/os&gt;
&lt;features&gt;
&lt;acpi/&gt;
&lt;/features&gt;
&lt;clock offset='utc'/&gt;
&lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
&lt;on_reboot&gt;restart&lt;/on_reboot&gt;
&lt;on_crash&gt;destroy&lt;/on_crash&gt;
&lt;devices&gt;
&lt;emulator&gt;/usr/bin/qemu-system-x86_64&lt;/emulator&gt;
&lt;disk type='file' device='disk'&gt;
&lt;source file='/virtual/vox2.qcow2'/&gt;
&lt;target dev='sda' bus='scsi'/&gt;
&lt;alias name='scsi0-0-0'/&gt;
&lt;address type='drive' controller='0' bus='0' unit='0'/&gt;
&lt;/disk&gt;
&lt;controller type='scsi' index='0'&gt;
&lt;alias name='scsi0'/&gt;
&lt;address type='pci' domain='0x0000' bus='0x00' slot='0x04' function='0x0'/&gt;
&lt;/controller&gt;
&lt;interface type='direct'&gt;
&lt;mac address='52:54:00:2f:fe:3d'/&gt;
&lt;source dev='eth0' mode='bridge'/&gt;
&lt;target dev='macvtap1'/&gt;
&lt;model type='virtio'/&gt;
&lt;alias name='net0'/&gt;
&lt;address type='pci' domain='0x0000' bus='0x00' slot='0x05' function='0x0'/&gt;
&lt;/interface&gt;
&lt;input type='mouse' bus='ps2'/&gt;
&lt;graphics type='vnc' port='5901' autoport='no' keymap='pt-br'/&gt;
&lt;video&gt;
&lt;model type='vmvga' vram='9216' heads='1'/&gt;
&lt;alias name='video0'/&gt;
&lt;address type='pci' domain='0x0000' bus='0x00' slot='0x02' function='0x0'/&gt;
&lt;/video&gt;
&lt;/devices&gt;
&lt;/domain&gt;

P.S.: The default network of libvirt is disabled.

-- 
*Eduardo Ramos*
Asterisk Manager
Linux User
www.freedominterface.org
+55 12 81129581
exten=&gt;eduardo,1,hangup()

</body></email><email><emailId>20100616181032</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2010-06-16 18:10:32-0400</timestampReceived><subject>Re: [libvirt-users] libvirt API hangs</subject><body>

On 06/16/10 - 11:02:01PM, Zhang Qian wrote:
&gt; Hi,
&gt; 
&gt; I have someVMs in my KVM hosts(RHEL 5.5), I found when run "virsh save
&gt; &lt;domain&gt; &lt;file&gt;" to save a VM, the command "virsh dominfo &lt;domain&gt;" will
&gt; hang until the save command finishes.
&gt; Is this libvirt's behavior? Or KVM/QEMU's? This may impact the performance.

This is a bug in libvirtd itself, in that the threading wasn't properly
unlocking all of the time.  So the save command would take a lock for the
duration of the command, and all other commands would queue up behind it.
Recent work in libvirt should have mostly eliminated this phenomenon; you'll
want to try out libvirt 0.8.1 or later.

--
Chris Lalancette

</body></email><email><emailId>20100617103444</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-06-17 10:34:44-0400</timestampReceived><subject>Re: [libvirt-users] cannot acquire state change lock</subject><body>

On Thu, Jun 17, 2010 at 10:34:33AM +0100, Julian Robbins wrote:
&gt; Hi
&gt; 
&gt; I keep getting libvirtError: Timed out during operation: cannot acquire 
&gt; state change lock
&gt; errors - what does this mean exactly ?

When ever any API call attempts to change the state of a guest, it
first acquires a lock. This error message means that it failed to
acquire the lock, because some other previous API call was still
holding it. 

THis may or may not be a bug, depending on what the other API call is
doing. Some API calls like migration are expected to take a very long
time, others should be always fast.

Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100617120106</emailId><senderName>Julian Robbins</senderName><senderEmail>julian.robbins@q-par.com</senderEmail><timestampReceived>2010-06-17 12:01:06-0400</timestampReceived><subject>Re: [libvirt-users] Snapshots - can't take a snapshot with running VM</subject><body>

On 17/06/10 11:40, Julian Robbins wrote:
&gt; On 15/06/10 17:53, Julian Robbins wrote:
&gt;&gt; I'm using vers 1.84 of QEMU/Kvm from dnjl's PPA for Lucid.
&gt;
&gt; After trying again, I can no longer get snapshots to work whilst vm 
&gt; guest in running.
&gt;
&gt; I have disabled apparmor so that it is only in 'complain' mode on the 
&gt; host, but still get :-
&gt;
&gt; Error -5 while writing VM
&gt;
&gt; whilst trying a
&gt;
&gt; virsh # snapshot-create openerp
&gt;
&gt; Whether running virsh as normal user or root. I'm also getting
&gt;
&gt; 'libvirtError: Timed out during operation: cannot acquirestate change 
&gt; lock' errors too, after I've tried to take a snapshot.

Apologies after replying to my own post. After applying the latest 
update of kvm, libvirt etc from Daniel Baumann (dnjl)'s PPA (the one I 
had been previously using), I noticed a change was related to giving 
more permission to libvirt relating to access to disk storage when 
apparmor is running.

With this update 0.8.1-2ubuntu1.1~dnjl1~lucid0, snapshots are fine again 
now. I can create/delete whilst guest is running or shutdown

-- 
Kind regards

Julian


[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;meta content="text/html; charset=ISO-8859-1"
 http-equiv="Content-Type"&gt;
&lt;/head&gt;
&lt;body bgcolor="#ffffff" text="#000000"&gt;
On 17/06/10 11:40, Julian Robbins wrote:
&lt;blockquote cite="mid:4C19FBB8.9050703@q-par.com" type="cite"&gt;On
15/06/10 17:53, Julian Robbins wrote:
  &lt;br&gt;
  &lt;blockquote type="cite"&gt;I'm using vers 1.84 of QEMU/Kvm from dnjl's
PPA for Lucid.
    &lt;br&gt;
  &lt;/blockquote&gt;
  &lt;br&gt;
After trying again, I can no longer get snapshots to work whilst vm
guest in running.
  &lt;br&gt;
  &lt;br&gt;
I have disabled apparmor so that it is only in 'complain' mode on the
host, but still get :-
  &lt;br&gt;
  &lt;br&gt;
Error -5 while writing VM
  &lt;br&gt;
  &lt;br&gt;
whilst trying a
  &lt;br&gt;
  &lt;br&gt;
virsh # snapshot-create openerp
  &lt;br&gt;
  &lt;br&gt;
Whether running virsh as normal user or root. I'm also getting
  &lt;br&gt;
  &lt;br&gt;
'libvirtError: Timed out during operation: cannot acquirestate change
lock' errors too, after I've tried to take a snapshot.
  &lt;br&gt;
&lt;/blockquote&gt;
&lt;br&gt;
Apologies after replying to my own post. After applying the latest
update of kvm, libvirt etc from Daniel Baumann (dnjl)'s PPA (the one I
had been previously using), I noticed a change was related to giving
more permission to libvirt relating to access to disk storage when
apparmor is running.&lt;big&gt;&lt;br&gt;
&lt;br&gt;
&lt;/big&gt;With this update 0.8.1-2ubuntu1.1~dnjl1~lucid0, snapshots are
fine again now. I can create/delete whilst guest is running or shutdown
&lt;pre class="moz-signature" cols="72"&gt;-- 
Kind regards

Julian&lt;/pre&gt;
&lt;/body&gt;
&lt;/html&gt;


</body></email><email><emailId>20100617173451</emailId><senderName>Rafael Braga</senderName><senderEmail>rafaeltelematica@gmail.com</senderEmail><timestampReceived>2010-06-17 17:34:51-0400</timestampReceived><subject>Re: [libvirt-users] java.lang.UnsatisfiedLinkError: jnidispatch (/com/sun/jna/linux-i386/libjnidispa</subject><body>

I changed the library and the error now is this:

Exception in thread "main" java.lang.UnsatisfiedLinkError: Can't obtain
static method fromNative from class com.sun.jna.Native
    at com.sun.jna.Native.initIDs(Native Method)
    at com.sun.jna.Native.&lt;clinit&gt;(Native.java:111)
    at org.libvirt.jna.Libvirt.&lt;clinit&gt;(Unknown Source)
    at org.libvirt.Connect.&lt;clinit&gt;(Unknown Source)
    at br.edu.ufc.deti.connection.Connection.main(Connection.java:7)

any idea??

thanks!

On Thu, Jun 17, 2010 at 2:14 PM, Rafael Braga &lt;rafaeltelematica@gmail.com&gt;wrote:

&gt; Hi everybody,
&gt;
&gt;     I'm trying to run the sample of the site, but is not working. In fact,
&gt; already includes jna.jar in my class path, see.
&gt; What can it be?
&gt;
&gt; --
&gt; Rafael Braga
&gt;



-- 
Rafael Braga

[Attachment #3 (text/html)]

I changed the library and the error now is this:&lt;br&gt;&lt;br&gt;Exception in thread \
"main" java.lang.UnsatisfiedLinkError: Can't obtain static method \
fromNative from class com.sun.jna.Native&lt;br&gt;    at com.sun.jna.Native.initIDs(Native \
Method)&lt;br&gt;

    at com.sun.jna.Native.&lt;clinit&gt;(Native.java:111)&lt;br&gt;    at \
org.libvirt.jna.Libvirt.&lt;clinit&gt;(Unknown Source)&lt;br&gt;    at \
org.libvirt.Connect.&lt;clinit&gt;(Unknown Source)&lt;br&gt;    at \
br.edu.ufc.deti.connection.Connection.main(Connection.java:7)&lt;br&gt;

&lt;br&gt;any idea??&lt;br&gt;&lt;br&gt;thanks!&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Thu, Jun 17, 2010 at \
2:14 PM, Rafael Braga &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:rafaeltelematica@gmail.com"&gt;rafaeltelematica@gmail.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;

&lt;blockquote class="gmail_quote" style="border-left: 1px solid rgb(204, 204, 204); \
margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;"&gt;&lt;span&gt;&lt;span style="background-color: \
rgb(255, 255, 255);" title="Oi todos,"&gt;Hi everybody,&lt;br&gt;



&lt;br&gt;    &lt;/span&gt;&lt;span style="background-color: rgb(255, 255, 255);" title="Estou \
tentando executar o exemplo do site, mas no est funcionando."&gt;I'm trying to run \
the sample of the site, but is not working. &lt;/span&gt;&lt;span style="background-color: \
rgb(255, 255, 255);" title="A rigor, j inclui o jna.jar no meu class path, \
vejam."&gt;In fact, already includes jna.jar in my class path, see. &lt;br&gt;


What can it be?&lt;/span&gt;&lt;/span&gt;&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;&lt;font color="#888888"&gt;Rafael \
Braga&lt;br&gt; &lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;Rafael Braga&lt;br&gt;



</body></email><email><emailId>20100618224437</emailId><senderName>jeremy avnet</senderName><senderEmail>brainsik+libvirt@saucelabs.com</senderEmail><timestampReceived>2010-06-18 22:44:37-0400</timestampReceived><subject>[libvirt-users] libvirtError: poll on socket failed: Interrupted system call</subject><body>

Hello. I just upgraded from libvirt 0.7.0 to 0.7.5 in Ubuntu Lucid and now
my application will get into a hung state. I have to kill it at which point
I get the following error from the Python bindings:

Traceback (most recent call last):
  File "/usr/local/app/vm.py", line 246, in launch
    vm.create()
  File "/usr/lib/python2.6/dist-packages/libvirt.py", line 300, in create
    if ret == -1: raise libvirtError ('virDomainCreate() failed', dom=self)
libvirtError: poll on socket failed: Interrupted system call

Some searches turned up a patch involving signals sent by ncurses apps
resizing, but this is not an ncurses app. It's a daemonized Python Twisted
application. Unfortunately, this problem is making it so the application
hangs indefinitely until we kill it and start it again.

Any suggestions as to what might be causing this?

Thanks!
.:. jeremy

[Attachment #3 (text/html)]

&lt;font class="Apple-style-span" face="verdana, sans-serif"&gt;Hello. I just upgraded from \
libvirt 0.7.0 to 0.7.5 in Ubuntu Lucid and now my application will get into a hung \
state. I have to kill it at which point I get the following error from the Python \
bindings:&lt;/font&gt;&lt;div&gt; &lt;font class="Apple-style-span" face="verdana, \
sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="verdana, \
sans-serif"&gt;&lt;div&gt;Traceback (most recent call last):&lt;/div&gt;&lt;div&gt;    File \
"/usr/local/app/vm.py", line 246, in launch&lt;/div&gt; &lt;div&gt;       \
vm.create()&lt;/div&gt;&lt;div&gt;    File \
"/usr/lib/python2.6/dist-packages/libvirt.py", line 300, in \
create&lt;/div&gt;&lt;div&gt;       if ret == -1: raise libvirtError ('virDomainCreate() \
failed', dom=self)&lt;/div&gt;&lt;div&gt;libvirtError: poll on socket failed: Interrupted \
system call&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Some searches turned up a patch involving \
signals sent by ncurses apps resizing, but this is not an ncurses app. It's a \
daemonized Python Twisted application. Unfortunately, this problem is making it so \
the application hangs indefinitely until we kill it and start it again.&lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Any suggestions as to what might be causing \
this?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks!&lt;/div&gt;&lt;div&gt;.:. \
jeremy&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/font&gt;&lt;/div&gt;



</body></email><email><emailId>20100621095252</emailId><senderName>Ryota Ozaki</senderName><senderEmail>ozaki.ryota@gmail.com</senderEmail><timestampReceived>2010-06-21 09:52:52-0400</timestampReceived><subject>Re: [libvirt-users] How to get supported feature list in driver</subject><body>

On Mon, Jun 21, 2010 at 4:29 PM, Daniel Veillard &lt;veillard@redhat.com&gt; wrote:
&gt; On Sat, Jun 19, 2010 at 08:15:44PM +0900, Ryota Ozaki wrote:
&gt;&gt; Hello
&gt;&gt;
&gt;&gt; Is there an easy way to get supported feature (API) list in each driver?
&gt;&gt; The function would be to return a list which describes which APIs are
&gt;&gt; supported and which APIs are not.
&gt;
&gt;  No, and it's somehow painful. If unsupported you will get a specific
&gt; error code back though, so maybe that can be automated in some ways.

Indeed. I agree it is an easy way (not smart though).

&gt; There is the manually maintained page for driver support at
&gt;  http://libvirt.org/hvsupport.html
&gt; but being manual means it's often outdated :-\

There is not even entry for lxc!

&gt; Also there is some subtleties, for example on Xen the main driver is
&gt; actually implemenbted as a set of 3 sub-drivers for hv/xend/xenstore
&gt; so just checking for NULL values in the driver entry point is not
&gt; completely sufficient to assert support of a feature.

Oh, I didn't know that. I though I could use the entry point.

OK, trial and error seems a easy and solid way.
Thanks for your explanation.

  ozaki-r

&gt;
&gt; Daniel
&gt;
&gt; --
&gt; Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
&gt; daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
&gt; http://veillard.com/ | virtualization library  http://libvirt.org/
&gt;

</body></email><email><emailId>20100622113534</emailId><senderName>Bryan Kearney</senderName><senderEmail>bkearney@redhat.com</senderEmail><timestampReceived>2010-06-22 11:35:34-0400</timestampReceived><subject>Re: [libvirt-users] Question about the remote Authentication in the libvirt Java bindings</subject><body>

Dustin:

I am adding this response to the libvirt list as well so that others may
see it.

The authorization is done via a callback. The ConnectAuthDefault() that
you are using is one such implementation. You could create your own
subclass of ConnectAuth, and override the method:


public abstract int callback(Credential[] cred);


And then provide the username/password in that fashion. Look at the
ConnectAuthDefault in the case statement how it chooses to ask for
username and password.

-- bk




On 06/21/2010 10:35 PM, Dustin Xiong wrote:
&gt; Dear Bryan Kearney
&gt; 
&gt; I hava a question about the remote authentication of the libvirt java 
&gt; bindings. I run the test.java of the libvirt-java-0.4.3.tar.gz. I can 
&gt; connect the remote host use the
&gt; 
&gt; ConnectAuth defaultAuth = new ConnectAuthDefault();
&gt; try{ conn = new Connect("xen+ssh://192.168.0.146/", defaultAuth, 0);
&gt; 
&gt; Then I input the remote host's ssh password, I can connect the host.
&gt; If I don't want to input the ssh password, I want write the password 
&gt; into the libvirt or libvirt-java' src code.
&gt; How can modify the libvirt or libvirt-java src code, the libvirt will 
&gt; auto connect to the remote host without user input the ssh code.
&gt; 
&gt; Thanks for help.
&gt; 
&gt; -Dustin

</body></email><email><emailId>20100623162202</emailId><senderName>Guido Winkelmann</senderName><senderEmail>guido-libvi@unknownsite.de</senderEmail><timestampReceived>2010-06-23 16:22:02-0400</timestampReceived><subject>[libvirt-users] Qemu backend: Cannot start new domains after some time</subject><body>

Hi,

After using libvirt+qemu for a while, I'm finding that I can no longer 
reliably start new domains. Most of the time when I try, I'm getting this, or 
something like it:

virsh # start dhcpv6server
error: Failed to start domain dhcpv6server
error: monitor socket did not show up.: No such file or directory

The same thing happens when trying to start the domain using the C-API.

This happens particularly often when there are any domains running that are 
using a lot of CPU, even when most of the physical cores of the host machine 
are still sitting idle.

(I've created a number of Linux VMs, with one CPU core each, that do nothing 
but calculate primes in an endless loop for load-testing purposes.)

If I destroy all of the high-load domains, I can usually start up new domains 
again.

The time between requesting the domain startup and the error message being 
printed varies greatly, from less than a second to more than a minute.

The host machine is running Fedora 12 with libvirt 0.8.1 and qemu-kvm 0.12.4.

Any ideas what might be causing this, and what can be done about it? It would 
be a big problem for us if we cannot start any new domains just because some 
of the existing ones are using a lot of CPU...

Regards,

	Guido

</body></email><email><emailId>20100623185815</emailId><senderName>"Development"</senderName><senderEmail>development@simulamen.eu</senderEmail><timestampReceived>2010-06-23 18:58:15-0400</timestampReceived><subject>Re: [libvirt-users] Obtaining UTC Time from Remote VM Host</subject><body>

Matthias,

Great to hear from you.  Hope all is well with you and yours?

Have discussed your suggestion with my client.  They do not wish to use a libvirt \
that has been modified for their ends.  Timestamp will therefore come from the \
Windows client!

Thanks for the response...

Tim

-----Original Message-----
From: Matthias Bolte [mailto:matthias.bolte@googlemail.com] 
Sent: 22 June 2010 19:46
To: development@simulamen.eu
Cc: libvirt-users@redhat.com
Subject: Re: [libvirt-users] Obtaining UTC Time from Remote VM Host

2010/6/20 Development &lt;development@simulamen.eu&gt;:
&gt; Quick question on whether it is possible to use the libvirt API exposed by
&gt; the libvirt DLL compiled on a Vista machine to obtain the system time in UTC
&gt; of the remote machine hosting several VMs?  Many thanks...
&gt; 

There is no such feature in libvirt yet. But there is no reason why a
function like

   time_t virConnectGetCurrentTime(virConnectPtr conn);

could not be added to libvirt.

Matthias


</body></email><email><emailId>20100616172002</emailId><senderName>Tom Georgoulias</senderName><senderEmail>tomg@mcclatchyinteractive.com</senderEmail><timestampReceived>2010-06-16 17:20:02-0400</timestampReceived><subject>[libvirt-users] how to match the ID of a LUN in a storage pool with the GUID on the target server</subject><body>

I've configured a libvirt storage pool using an iscsi target from a Sun 
7310 storage appliance and am using the LUNs in this target as volumes 
for my KVM guests.  The setup is very similar to what Daniel covered in 
a recent blog posting:

http://berrange.com/posts/2010/05/05/provisioning-kvm-virtual-machines-on-iscsi-the-hard-way-part-2-of-2/

It works great, but I can't figure out how to match the volume names &amp; 
path IQNs within the storage pool to the GUIDs on the target.

For example, here's what I see when I use the vol-info command:

# virsh vol-list kvm-target
Name                 Path
-----------------------------------------
6.0.0.0 
/dev/disk/by-path/ip-X.X.X.X:3260-iscsi-iqn.1986-03.com.sun:02:&lt;snipped&gt;-lun-0
6.0.0.1 
/dev/disk/by-path/ip-X.X.X.X:3260-iscsi-iqn.1986-03.com.sun:02:&lt;snipped&gt;-lun-1

The IQN matches the targets IQN, but when I browse the LUNs from the 
storage system I do not see a way to determine which of them is *-lun-0 
and which is *-lun-1, I only see a GUID and an alias name that I created.

Is there any way to get that info (or something else that will do the 
job) from a virsh command?

Thanks in advance for any help.

Tom

</body></email><email><emailId>20100628164049</emailId><senderName>Adam Gray</senderName><senderEmail>adam@meebo-inc.com</senderEmail><timestampReceived>2010-06-28 16:40:49-0400</timestampReceived><subject>[libvirt-users] SASL GSSAPI error "Key table entry not found"</subject><body>

My server and client are running Ubuntu Lucid, libvirt-bin
0.7.5-5ubuntu27, qemu-kvm-0.12.3+noroms-0ubuntu9 and I'm using
virt-viewer-0.0.3-6ubuntu7.xul19 or virt-manager-0.8.2-2ubuntu8 to
connect. I configured SASL2 to use GSSAPI for libvirt following the
instructions in the libvirt docs, created a keytab with
libvirt/my.fully.qualified.domain@MY-REALM.COM (has a dash fwiw) and
pointed SASL2 and libvirt at /etc/krb5.keytab (changing the location
of that doesn't seem to work for my version, but that's no biggie).

So I sit on my client and run this:
virsh -c qemu+tcp://my.fully.qualified.domain/system
And I get this message on the client:
error: authentication failed
error: failed to connect to the hypervisor
And this on the server logs:
16:37:35.278: error : remoteDispatchAuthSaslStart:3135 : sasl start
failed -1 (SASL(-1): generic failure: GSSAPI Error: Unspecified GSS
failure.  Minor code may provide more information (Key table entry not
found))

For fun, I ran kdestroy and tried again and got this:
error: Failed to start SASL negotiation: -1 (SASL(-1): generic
failure: GSSAPI Error: Unspecified GSS failure.  Minor code may
provide more information (Credentials cache file '/tmp/krb5cc_1000'
not found))
error: failed to connect to the hypervisor

So at least the client seems to be presenting my ticket properly, but
the server is either looking for the wrong keytab entry or I can't
read very well.

-adam

</body></email><email><emailId>20100630143715</emailId><senderName>Ralf Hornik Mailings</senderName><senderEmail>ralf@best.homeunix.org</senderEmail><timestampReceived>2010-06-30 14:37:15-0400</timestampReceived><subject>Re: [libvirt-users] SASL GSSAPI error "Key table entry not found"</subject><body>

Adam Gray &lt;adam@meebo-inc.com&gt; schreibte:

&gt; libvirt/my.fully.qualified.domain@MY-REALM.COM (has a dash fwiw) and
&gt; pointed SASL2 and libvirt at /etc/krb5.keytab

What tells your KDC?

Have a look at

klist -t /etc/krb5.keytab

and look whether the principals match (e.g LIBVIRT/domain is not equal  
libvirt/domain

Ralf


</body></email><email><emailId>20100630162319</emailId><senderName>Adam Gray</senderName><senderEmail>adam@meebo-inc.com</senderEmail><timestampReceived>2010-06-30 16:23:19-0400</timestampReceived><subject>Re: [libvirt-users] SASL GSSAPI error "Key table entry not found"</subject><body>

Thanks Ralf, sadly things look OK to me. Did I typo something?? haha
forward and reverse DNS are correct for this host (petey), too. As far
as I can tell Kerberos stuff is set up as usual.

root@petey:~# klist -k /etc/krb5.keytab
Keytab name: WRFILE:/etc/krb5.keytab
KVNO Principal
---- --------------------------------------------------------------------------
   2 libvirt/petey.mydomain.com@MYDOMAIN-INC.COM
   2 libvirt/petey.mydomain.com@MYDOMAIN-INC.COM
   2 libvirt/petey.mydomain.com@MYDOMAIN-INC.COM
   2 libvirt/petey.mydomain.com@MYDOMAIN-INC.COM

-adam



On Wed, Jun 30, 2010 at 07:37, Ralf Hornik Mailings
&lt;ralf@best.homeunix.org&gt; wrote:
&gt; Adam Gray &lt;adam@meebo-inc.com&gt; schreibte:
&gt;
&gt;&gt; libvirt/my.fully.qualified.domain@MY-REALM.COM (has a dash fwiw) and
&gt;&gt; pointed SASL2 and libvirt at /etc/krb5.keytab
&gt;
&gt; What tells your KDC?
&gt;
&gt; Have a look at
&gt;
&gt; klist -t /etc/krb5.keytab
&gt;
&gt; and look whether the principals match (e.g LIBVIRT/domain is not equal
&gt; libvirt/domain
&gt;
&gt; Ralf
&gt;
&gt;
&gt;

</body></email><email><emailId>20100630170158</emailId><senderName>Maximilian Wilhelm</senderName><senderEmail>max@rfc2324.org</senderEmail><timestampReceived>2010-06-30 17:01:58-0400</timestampReceived><subject>Re: [libvirt-users] SASL GSSAPI error "Key table entry not found"</subject><body>

Anno domini 2010 Adam Gray scripsit:

Hi!

&gt; Thanks Ralf, sadly things look OK to me. Did I typo something?? haha
&gt; forward and reverse DNS are correct for this host (petey), too. As far
&gt; as I can tell Kerberos stuff is set up as usual.

&gt; root@petey:~# klist -k /etc/krb5.keytab
&gt; Keytab name: WRFILE:/etc/krb5.keytab
&gt; KVNO Principal
&gt; ---- --------------------------------------------------------------------------
&gt;    2 libvirt/petey.mydomain.com@MYDOMAIN-INC.COM
&gt;    2 libvirt/petey.mydomain.com@MYDOMAIN-INC.COM
&gt;    2 libvirt/petey.mydomain.com@MYDOMAIN-INC.COM
&gt;    2 libvirt/petey.mydomain.com@MYDOMAIN-INC.COM

Do you have a host/ principal, too?
How baout the access right? Can libvrtd read this file?
Does it? (strace -f -ff -eopen libvirtd --listen)

Ciao
Max
-- 
They that give up essential liberty to obtain temporary safety,
deserve neither liberty nor safety.  (Ben Franklin)

</body></email><email><emailId>20100630171315</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-06-30 17:13:15-0400</timestampReceived><subject>Re: [libvirt-users] SASL GSSAPI error "Key table entry not found"</subject><body>

On Mon, Jun 28, 2010 at 09:40:49AM -0700, Adam Gray wrote:
&gt; My server and client are running Ubuntu Lucid, libvirt-bin
&gt; 0.7.5-5ubuntu27, qemu-kvm-0.12.3+noroms-0ubuntu9 and I'm using
&gt; virt-viewer-0.0.3-6ubuntu7.xul19 or virt-manager-0.8.2-2ubuntu8 to
&gt; connect. I configured SASL2 to use GSSAPI for libvirt following the
&gt; instructions in the libvirt docs, created a keytab with
&gt; libvirt/my.fully.qualified.domain@MY-REALM.COM (has a dash fwiw) and
&gt; pointed SASL2 and libvirt at /etc/krb5.keytab (changing the location
&gt; of that doesn't seem to work for my version, but that's no biggie).

If changing the location in /etc/sasl2/libvirt.conf doesn't
work then you likely have a broken kerberos/sasl library.
This works in latest versions, but for broken systems you
can workaround it by setting KRB5_KTNAME=/etc/libvirt/krb5.tab
as an env variable when starting libvirtd.

&gt; 
&gt; So I sit on my client and run this:
&gt; virsh -c qemu+tcp://my.fully.qualified.domain/system
&gt; And I get this message on the client:
&gt; error: authentication failed
&gt; error: failed to connect to the hypervisor
&gt; And this on the server logs:
&gt; 16:37:35.278: error : remoteDispatchAuthSaslStart:3135 : sasl start
&gt; failed -1 (SASL(-1): generic failure: GSSAPI Error: Unspecified GSS
&gt; failure.  Minor code may provide more information (Key table entry not
&gt; found))

Do you have your server hostname configured to exactly match 
my.fully.qualified.domain (as per hostname -f command), and
is that hostname present in the DNS records, both forward and
reverse lookups. Using /etc/hosts is not sufficient for kerberos
to work IIRC.

&gt; 
&gt; For fun, I ran kdestroy and tried again and got this:
&gt; error: Failed to start SASL negotiation: -1 (SASL(-1): generic
&gt; failure: GSSAPI Error: Unspecified GSS failure.  Minor code may
&gt; provide more information (Credentials cache file '/tmp/krb5cc_1000'
&gt; not found))
&gt; error: failed to connect to the hypervisor

That just says the client doesn't have a ticket so not
really of interest since you just kdestroy'd the ticket :-)

Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100630225916</emailId><senderName>Adam Gray</senderName><senderEmail>adam@meebo-inc.com</senderEmail><timestampReceived>2010-06-30 22:59:16-0400</timestampReceived><subject>Re: [libvirt-users] SASL GSSAPI error "Key table entry not found"</subject><body>

On Wed, Jun 30, 2010 at 10:01, Maximilian Wilhelm &lt;max@rfc2324.org&gt; wrote:
&gt;
&gt; Do you have a host/ principal, too?
&gt; How baout the access right? Can libvrtd read this file?
&gt; Does it? (strace -f -ff -eopen libvirtd --listen)

I added the host/ principal and still no dice :(

[pid  2184] open("/etc/libvirt/krb5.keytab", O_RDONLY) = 39
[pid  2184] fcntl(39, F_SETFD, FD_CLOEXEC) = 0
[pid  2184] fcntl(39, F_SETLKW, {type=F_RDLCK, whence=SEEK_SET,
start=0, len=0}) = 0
[pid  2184] read(39, "\5\2\0\0\0T\0\2\0\r(this was totally my realm, I
dunno why everybody obscures it but Ima continue that
trend)\0\7libvirt\0\23petey.mydomain.com"..., 8192) = 626

-adam

</body></email><email><emailId>20100616174130</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-06-16 17:41:30-0400</timestampReceived><subject>Re: [libvirt-users] how to match the ID of a LUN in a storage pool with the GUID on the target serve</subject><body>

On Wed, Jun 16, 2010 at 01:20:02PM -0400, Tom Georgoulias wrote:
&gt; I've configured a libvirt storage pool using an iscsi target from a Sun 
&gt; 7310 storage appliance and am using the LUNs in this target as volumes 
&gt; for my KVM guests.  The setup is very similar to what Daniel covered in 
&gt; a recent blog posting:
&gt; 
&gt; http://berrange.com/posts/2010/05/05/provisioning-kvm-virtual-machines-on-iscsi-the-hard-way-part-2-of-2/
&gt;  
&gt; It works great, but I can't figure out how to match the volume names &amp; 
&gt; path IQNs within the storage pool to the GUIDs on the target.
&gt; 
&gt; For example, here's what I see when I use the vol-info command:
&gt; 
&gt; # virsh vol-list kvm-target
&gt; Name                 Path
&gt; -----------------------------------------
&gt; 6.0.0.0 
&gt; /dev/disk/by-path/ip-X.X.X.X:3260-iscsi-iqn.1986-03.com.sun:02:&lt;snipped&gt;-lun-0
&gt; 6.0.0.1 
&gt; /dev/disk/by-path/ip-X.X.X.X:3260-iscsi-iqn.1986-03.com.sun:02:&lt;snipped&gt;-lun-1
&gt; 
&gt; The IQN matches the targets IQN, but when I browse the LUNs from the 
&gt; storage system I do not see a way to determine which of them is *-lun-0 
&gt; and which is *-lun-1, I only see a GUID and an alias name that I created.
&gt; 
&gt; Is there any way to get that info (or something else that will do the 
&gt; job) from a virsh command?

Nothing at this time. If you weren't using libvirt, how would you discover
the GUIDs on the Linux client ? If there is a way to get these from sysfs
or elsewhere, we can wire it up in libvirt to the &lt;key&gt; element in the XML
for the volume. I just don't know how yet...

Regards,
Daniel
-- 
&gt; &gt; Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
&gt; &gt; http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
&gt; &gt; http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
&gt; &gt; GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|


</body></email><email><emailId>20100616191545</emailId><senderName>Tom Georgoulias</senderName><senderEmail>tomg@mcclatchyinteractive.com</senderEmail><timestampReceived>2010-06-16 19:15:45-0400</timestampReceived><subject>Re: [libvirt-users] how to match the ID of a LUN in a storage pool with the GUID on the target serve</subject><body>

On 06/16/2010 01:41 PM, Daniel P. Berrange wrote:
&gt; On Wed, Jun 16, 2010 at 01:20:02PM -0400, Tom Georgoulias wrote:
&gt; &gt; I've configured a libvirt storage pool using an iscsi target from a Sun
&gt; &gt; 7310 storage appliance and am using the LUNs in this target as volumes
&gt; &gt; for my KVM guests.  The setup is very similar to what Daniel covered in
&gt; &gt; a recent blog posting:
&gt; &gt; 
&gt; &gt; http://berrange.com/posts/2010/05/05/provisioning-kvm-virtual-machines-on-iscsi-the-hard-way-part-2-of-2/
&gt; &gt;  
&gt; &gt; It works great, but I can't figure out how to match the volume names&amp;
&gt; &gt; path IQNs within the storage pool to the GUIDs on the target.
&gt; &gt; 
&gt; &gt; For example, here's what I see when I use the vol-info command:
&gt; &gt; 
&gt; &gt; # virsh vol-list kvm-target
&gt; &gt; Name                 Path
&gt; &gt; -----------------------------------------
&gt; &gt; 6.0.0.0
&gt; &gt; /dev/disk/by-path/ip-X.X.X.X:3260-iscsi-iqn.1986-03.com.sun:02:&lt;snipped&gt;-lun-0
&gt; &gt; 6.0.0.1
&gt; &gt; /dev/disk/by-path/ip-X.X.X.X:3260-iscsi-iqn.1986-03.com.sun:02:&lt;snipped&gt;-lun-1
&gt; &gt; 
&gt; &gt; The IQN matches the targets IQN, but when I browse the LUNs from the
&gt; &gt; storage system I do not see a way to determine which of them is *-lun-0
&gt; &gt; and which is *-lun-1, I only see a GUID and an alias name that I created.
&gt; &gt; 
&gt; &gt; Is there any way to get that info (or something else that will do the
&gt; &gt; job) from a virsh command?
&gt; 
&gt; Nothing at this time. If you weren't using libvirt, how would you discover
&gt; the GUIDs on the Linux client ? If there is a way to get these from sysfs
&gt; or elsewhere, we can wire it up in libvirt to the&lt;key&gt;  element in the XML
&gt; for the volume. I just don't know how yet...

That's a good question, I tried to figure out a way to do so with 
iscsiadm but didn't find anything.  But I'm glad you mentioned the sysfs 
angle, it prodded me in the right direction and I think I found 
something to work with.

# udevinfo -a -p $(udevinfo -q path -n /dev/sdg)


   looking at device '/block/sdg':
     KERNEL=="sdg"
     SUBSYSTEM=="block"
     SYSFS{stat}=="   20458      183   451623    17494    27820    11891 
  4508156   552205        0    70083   569695"
     SYSFS{size}=="41943040"
     SYSFS{removable}=="0"
     SYSFS{range}=="16"
     SYSFS{dev}=="8:96"

   looking at parent device 
'/devices/platform/host6/session2/target6:0:0/6:0:0:0':
     ID=="6:0:0:0"
     BUS=="scsi"
     DRIVER=="sd"
     SYSFS{ioerr_cnt}=="0x3"
     SYSFS{iodone_cnt}=="0xbcb4"
     SYSFS{iorequest_cnt}=="0xbcb4"
     SYSFS{iocounterbits}=="32"
     SYSFS{timeout}=="60"
     SYSFS{state}=="running"
     SYSFS{rev}=="1.0 "
     SYSFS{model}=="Sun Storage 7310"
     SYSFS{vendor}=="SUN     "
     SYSFS{scsi_level}=="6"
     SYSFS{type}=="0"
     SYSFS{queue_type}=="none"
     SYSFS{queue_depth}=="32"
     SYSFS{device_blocked}=="0"

   looking at parent device '/devices/platform/host6/session2/target6:0:0':
     ID=="target6:0:0"
     BUS==""
     DRIVER==""

   looking at parent device '/devices/platform/host6/session2':
     ID=="session2"
     BUS==""
     DRIVER==""

   looking at parent device '/devices/platform/host6':
     ID=="host6"
     BUS==""
     DRIVER==""

   looking at parent device '/devices/platform':
     ID=="platform"
     BUS==""
     DRIVER==""

# scsi_id -g -x -s /block/sdg
ID_VENDOR=SUN
ID_MODEL=Sun_Storage_7310
ID_REVISION=1.0
ID_SERIAL=3600144f0a523738a00004c18ec990004
ID_TYPE=disk
ID_BUS=scsi


The GUID for this LUN is "600144F0A523738A00004C18EC990004".  That's the 
same number that is used in the ID_SERIAL, except that it has a 3 
prepended on it.  So now I can tell which LUN is really volume 6.0.0.0.

Tom


</body></email><email><emailId>20100616194159</emailId><senderName>Tom Georgoulias</senderName><senderEmail>tomg@mcclatchyinteractive.com</senderEmail><timestampReceived>2010-06-16 19:41:59-0400</timestampReceived><subject>Re: [libvirt-users] how to match the ID of a LUN in a storage pool with the GUID on the target serve</subject><body>

On 06/16/2010 03:15 PM, Tom Georgoulias wrote:
&gt; On 06/16/2010 01:41 PM, Daniel P. Berrange wrote:
&gt; &gt; On Wed, Jun 16, 2010 at 01:20:02PM -0400, Tom Georgoulias wrote:
&gt; &gt; &gt; I've configured a libvirt storage pool using an iscsi target from a Sun
&gt; &gt; &gt; 7310 storage appliance and am using the LUNs in this target as volumes
&gt; &gt; &gt; for my KVM guests.  The setup is very similar to what Daniel covered in
&gt; &gt; &gt; a recent blog posting:
&gt; &gt; &gt; 
&gt; &gt; &gt; http://berrange.com/posts/2010/05/05/provisioning-kvm-virtual-machines-on-iscsi-the-hard-way-part-2-of-2/
&gt; &gt; &gt;  
&gt; &gt; &gt; It works great, but I can't figure out how to match the volume names&amp;
&gt; &gt; &gt; path IQNs within the storage pool to the GUIDs on the target.
&gt; &gt; &gt; 
&gt; &gt; &gt; For example, here's what I see when I use the vol-info command:
&gt; &gt; &gt; 
&gt; &gt; &gt; # virsh vol-list kvm-target
&gt; &gt; &gt; Name                 Path
&gt; &gt; &gt; -----------------------------------------
&gt; &gt; &gt; 6.0.0.0
&gt; &gt; &gt; /dev/disk/by-path/ip-X.X.X.X:3260-iscsi-iqn.1986-03.com.sun:02:&lt;snipped&gt;-lun-0
&gt; &gt; &gt; 6.0.0.1
&gt; &gt; &gt; /dev/disk/by-path/ip-X.X.X.X:3260-iscsi-iqn.1986-03.com.sun:02:&lt;snipped&gt;-lun-1
&gt; &gt; &gt; 
&gt; &gt; &gt; The IQN matches the targets IQN, but when I browse the LUNs from the
&gt; &gt; &gt; storage system I do not see a way to determine which of them is *-lun-0
&gt; &gt; &gt; and which is *-lun-1, I only see a GUID and an alias name that I created.
&gt; &gt; &gt; 
&gt; &gt; &gt; Is there any way to get that info (or something else that will do the
&gt; &gt; &gt; job) from a virsh command?
&gt; &gt; 
&gt; &gt; Nothing at this time. If you weren't using libvirt, how would you discover
&gt; &gt; the GUIDs on the Linux client ? If there is a way to get these from sysfs
&gt; &gt; or elsewhere, we can wire it up in libvirt to the&lt;key&gt;   element in the XML
&gt; &gt; for the volume. I just don't know how yet...
&gt; 
&gt; That's a good question, I tried to figure out a way to do so with
&gt; iscsiadm but didn't find anything.  But I'm glad you mentioned the sysfs
&gt; angle, it prodded me in the right direction and I think I found
&gt; something to work with.
&gt; 
&gt; # udevinfo -a -p $(udevinfo -q path -n /dev/sdg)
&gt; 
&gt; 
&gt; looking at device '/block/sdg':
&gt; KERNEL=="sdg"
&gt; SUBSYSTEM=="block"
&gt; SYSFS{stat}=="   20458      183   451623    17494    27820    11891
&gt; 4508156   552205        0    70083   569695"
&gt; SYSFS{size}=="41943040"
&gt; SYSFS{removable}=="0"
&gt; SYSFS{range}=="16"
&gt; SYSFS{dev}=="8:96"
&gt; 
&gt; looking at parent device
&gt; '/devices/platform/host6/session2/target6:0:0/6:0:0:0':
&gt; ID=="6:0:0:0"
&gt; BUS=="scsi"
&gt; DRIVER=="sd"
&gt; SYSFS{ioerr_cnt}=="0x3"
&gt; SYSFS{iodone_cnt}=="0xbcb4"
&gt; SYSFS{iorequest_cnt}=="0xbcb4"
&gt; SYSFS{iocounterbits}=="32"
&gt; SYSFS{timeout}=="60"
&gt; SYSFS{state}=="running"
&gt; SYSFS{rev}=="1.0 "
&gt; SYSFS{model}=="Sun Storage 7310"
&gt; SYSFS{vendor}=="SUN     "
&gt; SYSFS{scsi_level}=="6"
&gt; SYSFS{type}=="0"
&gt; SYSFS{queue_type}=="none"
&gt; SYSFS{queue_depth}=="32"
&gt; SYSFS{device_blocked}=="0"
&gt; 
&gt; looking at parent device '/devices/platform/host6/session2/target6:0:0':
&gt; ID=="target6:0:0"
&gt; BUS==""
&gt; DRIVER==""
&gt; 
&gt; looking at parent device '/devices/platform/host6/session2':
&gt; ID=="session2"
&gt; BUS==""
&gt; DRIVER==""
&gt; 
&gt; looking at parent device '/devices/platform/host6':
&gt; ID=="host6"
&gt; BUS==""
&gt; DRIVER==""
&gt; 
&gt; looking at parent device '/devices/platform':
&gt; ID=="platform"
&gt; BUS==""
&gt; DRIVER==""
&gt; 
&gt; # scsi_id -g -x -s /block/sdg
&gt; ID_VENDOR=SUN
&gt; ID_MODEL=Sun_Storage_7310
&gt; ID_REVISION=1.0
&gt; ID_SERIAL=3600144f0a523738a00004c18ec990004
&gt; ID_TYPE=disk
&gt; ID_BUS=scsi
&gt; 
&gt; 
&gt; The GUID for this LUN is "600144F0A523738A00004C18EC990004".  That's the
&gt; same number that is used in the ID_SERIAL, except that it has a 3
&gt; prepended on it.  So now I can tell which LUN is really volume 6.0.0.0.

Let me refine that.  This command does it all (if you don't mind 
checking the path for the name.  Note, I stripped the IP from my IQN).

# udevinfo -q env -p $(udevinfo -q path -n /dev/sdg)
ID_VENDOR=SUN
ID_MODEL=Sun_Storage_7310
ID_REVISION=1.0
ID_SERIAL=3600144f0a523738a00004c18ec990004
ID_TYPE=disk
ID_BUS=scsi
ID_PATH=ip-X.X.X.X:3260-iscsi-iqn.1986-03.com.sun:02:2d90ab5a-ac15-623d-a5aa-aa1baa0cfa58-lun-0



</body></email><email><emailId>20100630184742</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-06-30 18:47:42-0400</timestampReceived><subject>Re: [libvirt-users] how to match the ID of a LUN in a storage pool with the GUID on the target serve</subject><body>

On Wed, Jun 16, 2010 at 06:41:30PM +0100, Daniel P. Berrange wrote:
&gt; On Wed, Jun 16, 2010 at 01:20:02PM -0400, Tom Georgoulias wrote:
&gt; &gt; I've configured a libvirt storage pool using an iscsi target from a Sun 
&gt; &gt; 7310 storage appliance and am using the LUNs in this target as volumes 
&gt; &gt; for my KVM guests.  The setup is very similar to what Daniel covered in 
&gt; &gt; a recent blog posting:
&gt; &gt; 
&gt; &gt; http://berrange.com/posts/2010/05/05/provisioning-kvm-virtual-machines-on-iscsi-the-hard-way-part-2-of-2/
&gt; &gt;  
&gt; &gt; It works great, but I can't figure out how to match the volume names &amp; 
&gt; &gt; path IQNs within the storage pool to the GUIDs on the target.
&gt; &gt; 
&gt; &gt; For example, here's what I see when I use the vol-info command:
&gt; &gt; 
&gt; &gt; # virsh vol-list kvm-target
&gt; &gt; Name                 Path
&gt; &gt; -----------------------------------------
&gt; &gt; 6.0.0.0 
&gt; &gt; /dev/disk/by-path/ip-X.X.X.X:3260-iscsi-iqn.1986-03.com.sun:02:&lt;snipped&gt;-lun-0
&gt; &gt; 6.0.0.1 
&gt; &gt; /dev/disk/by-path/ip-X.X.X.X:3260-iscsi-iqn.1986-03.com.sun:02:&lt;snipped&gt;-lun-1
&gt; &gt; 
&gt; &gt; The IQN matches the targets IQN, but when I browse the LUNs from the 
&gt; &gt; storage system I do not see a way to determine which of them is *-lun-0 
&gt; &gt; and which is *-lun-1, I only see a GUID and an alias name that I created.
&gt; &gt; 
&gt; &gt; Is there any way to get that info (or something else that will do the 
&gt; &gt; job) from a virsh command?
&gt; 
&gt; Nothing at this time. If you weren't using libvirt, how would you discover
&gt; the GUIDs on the Linux client ? If there is a way to get these from sysfs
&gt; or elsewhere, we can wire it up in libvirt to the &lt;key&gt; element in the XML
&gt; for the volume. I just don't know how yet...

I discovered you can get the info from UDEV, eg if libvirt reports a
volume '/dev/sde' you can query against the block device path

# scsi_id --export --whitelisted /dev/sde
ID_VENDOR=QNAP
ID_VENDOR_ENC=QNAP
ID_MODEL=iSCSI_Storage
ID_MODEL_ENC=iSCSI\x20Storage
ID_REVISION=3.1
ID_TYPE=disk
ID_SERIAL=36001405e61fd1a5d6f1dd4d66d9630d2
ID_SERIAL_SHORT=6001405e61fd1a5d6f1dd4d66d9630d2


The ID_SERIAL field should be what you what IIUC

We'll see about making libvirt report this value directly as the 'key' for
the volume

Daniel
-- 
&gt; &gt; Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
&gt; &gt; http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
&gt; &gt; http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
&gt; &gt; GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|


</body></email><email><emailId>20100624084136</emailId><senderName>Matt Wallace</senderName><senderEmail>lists@truthisfreedom.org.uk</senderEmail><timestampReceived>2010-06-24 08:41:36-0400</timestampReceived><subject>[libvirt-users] Domain did not show up error</subject><body>

Hi all,

I've run into an issue with using libvirt via the ruby bindings.

When trying to create a new domain via xml, I get the following error:

libvir: QEMU error : internal error Domain webserver.staging.myco.com
didn't show up

When I check using virsh, the domain has been defined and shows as
"running" when I execute "list --all" but does not show up when I
execute "list" nor will it let me connect via "console
webserver.staging.myco.com".

Can anyone shed any light on why this might be?

O/S: Centos 5.4
Ruby: ruby 1.8.5 (2006-08-25) [x86_64-linux]
Libvirt: 0.6.3

If you need any more information, please let me know.

If you want to see the code that is being used, it's cucumber-vhost
(http://github.com/proffalken/cucumber-vhost)

Thanks,

Matt


</body></email><email><emailId>20100624112709</emailId><senderName>Jounewe Lambang Paul Roland</senderName><senderEmail>j_lambang@yahoo.fr</senderEmail><timestampReceived>2010-06-24 11:27:09-0400</timestampReceived><subject>[libvirt-users] i need help</subject><body>

I am french student who works on a libvirt projet, it consists to get information \
from an hypervisor by using libvirt API in perl in cgi script but i have a great \
problem. I wrote my script and its works in EPIC but when i am trying to run it from \
apache web server as a CGI script, it goes wrong and i have this message: libvirt  \
code 38 message: can no recv data: ssh connect to host myZenhost.mydomaine.fr port 22 \
in my browser. i made libvirtd installation and tried command line virsh -c \
xen+ssh://root@myZenhost.mydomain.fr wich works correctly i dont know what wrong.I \
run the script to remote xen hypervisor as root with a good config of ssh (transport \
mode), I realize that the environment variables of root account (client) is not the \
same with apache webserver, and i am set the same path in apache env variable but \
there are no change.  please i need your help to fix this problem.

Cdt.                                                          
Paul Roland JOUNEWE LAMBANGIngnieur Rseaux TlcomMob:+336 03 74 60 565, Av Albert \
1er 95600 Eaubonne-France  le mensonge est comme une bulle d'air qu'on tente \
dsesprment de retenir au fond d'une rcipient plein d'eau, tt ou tard il finit \
par remonter en surface.


      


[Attachment #3 (text/html)]

&lt;table cellspacing="0" cellpadding="0" border="0" &gt;&lt;tr&gt;&lt;td valign="top" style="font: \
inherit;"&gt;&lt;span class="Apple-style-span" style="font-family: monospace; font-size: \
14px; line-height: 16px; "&gt;&lt;br style="line-height: 1.2em; outline-style: none; \
outline-width: initial; outline-color: initial; "&gt;I am french studentwho \
workson a libvirt projet, it consists to getinformation from an \
hypervisor by using libvirt API in perl in cgi scriptbut i have a great \
problem. Iwrote my script and its works in EPIC but when i am trying to run \
itfrom apache web server as a CGI script, it goes wrong and i have this \
message: libvirt&lt;br style="line-height: 1.2em; outline-style: none; \
outline-width: initial; outline-color: initial; "&gt;code 38 message: can no recv data: \
ssh connect to host myZenhost.mydomaine.frport 22 in my browser. i made \
libvirtd installation and triedcommand linevirsh -c  \
xen+ssh://root@myZenhost.mydomain.fr wich works correctly i dont know \
whatwrong.I run the script to remote xen hypervisor as root with a good config \
of ssh (transport mode), I realize that the environment variables of root account \
(client) is not the same with apache webserver, and i am set the same path in apache \
env variable but there are no change.please i need your help to fix this \
problem.&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;strong&gt;&lt;font \
size="3"&gt;Cdt.&lt;/font&gt;&lt;/strong&gt;&lt;/div&gt;&lt;div&gt;&lt;strong&gt;&lt;font \
size="3"&gt;&lt;u&gt;&amp;n \
bsp;&amp;nbs \
p; \
&lt;br&gt;&lt;/u&gt;&lt;/font&gt;&lt;/strong&gt;&lt;font \
color="#407f00"&gt;Paul Roland JOUNEWE LAMBANG&lt;/font&gt;&lt;/div&gt;&lt;div  \
style="FONT-FAMILY:tahoma, new york, times, serif;COLOR:rgb(0,0,127);"&gt;Ingnieur \
Rseaux Tlcom&lt;/div&gt;&lt;div style="FONT-FAMILY:tahoma, new york, times, \
serif;COLOR:rgb(0,0,127);"&gt;&lt;font size="1"&gt;Mob:+336 03 74 60 56&lt;/font&gt;&lt;/div&gt;&lt;div \
style="FONT-FAMILY:tahoma, new york, times, serif;COLOR:rgb(0,0,0);"&gt;&lt;font \
size="1"&gt;5, Av Albert 1er 95600&lt;br&gt;&lt;font \
size="2"&gt;Eaubonne&lt;/font&gt;-France&lt;/font&gt;&lt;/div&gt;&lt;div style="FONT-FAMILY:tahoma, new york, \
times, serif;COLOR:rgb(0,0,0);"&gt;&lt;font size="1"&gt;&lt;/font&gt;&lt;/div&gt;&lt;div \
style="FONT-FAMILY:tahoma, new york, times, serif;COLOR:rgb(0,0,0);"&gt;&lt;font \
size="1"&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style="FONT-FAMILY:tahoma, new york, times, \
serif;COLOR:rgb(0,0,0);" align="center"&gt;&lt;font color="#007f7f" size="2"&gt;&lt;strong&gt;le \
mensonge est comme une bulle d'air qu'on tente dsesprment de retenir au fond d'une \
rcipient plein d'eau, tt ou tard il finit par remonter en \
surface.&lt;/strong&gt;&lt;/font&gt;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;br&gt;




      



</body></email><email><emailId>20100624144729</emailId><senderName>Stephen Liu</senderName><senderEmail>satimis@yahoo.com</senderEmail><timestampReceived>2010-06-24 14:47:29-0400</timestampReceived><subject>[libvirt-users] sound problem</subject><body>

Hi folks,

KVM -  1:0.12.4+dfsg-1~bpo50+1 0
host - Debian 5.0

I have been suffering on sound problem for sometimes.  Please advise whether the same \
has been solved.  If YES please advice how to solve it.  TIA

B.R.
Stephen L


</body></email><email><emailId>20100627152801</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2010-06-27 15:28:01-0400</timestampReceived><subject>Re: [libvirt-users] network interface management in bridge firewall configuration</subject><body>

  On 06/17/2010 11:01 AM, Aleksander Trofimowicz wrote:
&gt; Hello,
&gt;
&gt; I'm just wondering why I can't manage my network interfaces  through
&gt; libvirt when the following kernel parameters are turned on:
&gt;
&gt; net.bridge.bridge-nf-call-ip6tables
&gt; net.bridge.bridge-nf-call-iptables
&gt; net.bridge.bridge-nf-call-arptables
&gt;
&gt; Is it a bug or by design?

There should be no problems with this. The only place any of these are 
used in netcf is that net.bridge.bridge-nf-call-iptables is checked at 
one point, and if it's set to 1, an attempt is made to assure traffic 
can pass through all the bridges by parsing /etc/sysconfig/iptables and 
adding appropriate rules (see the function bridge_physdevs() in netcf if 
you're into looking at source code).

One thing that has shown up recently is that when 
bridge-nf-call-iptables is 1, if /etc/sysconfig/iptables is empty or 
malformed, netcf will fail to initialize. There have been a couple of 
bugs filed against RHEL for this, but they haven't yet been cloned 
upstream. Just to verify this is actually the problem, can you check 
your /etc/sysconfig/iptables to see if it is 0 length (and if so, put 
some basic rules in and try again)?


</body></email><email><emailId>20100628113000</emailId><senderName>Joel Uckelman</senderName><senderEmail>uckelman@nomic.net</senderEmail><timestampReceived>2010-06-28 11:30:00-0400</timestampReceived><subject>Re: [libvirt-users] can't access VM after Fedora 13 KVM install</subject><body>

Thus spake Joel Uckelman:
&gt; Hi,
&gt; 
&gt; I'm installing a Fedora 13 virtual host on a Fedora 13 system, like this:
&gt; 
&gt; virt-install --ram 2048 --vcpus 4 --name test --os-type linux \
&gt;   --os-variant fedora13 --disk /var/lib/libvirt/images/test.img,size=10 \
&gt;   --cdrom /var/lib/libvirt/Fedora-13-x86_64-DVD.iso --vnc --noautoconsole
&gt; 
&gt; I connect to the installer using virt-manager, and the install appears to
&gt; complete successfully. Then, I reboot the virtual machine and reconnect
&gt; with virt-manager. What I see is this:
&gt; 
&gt;   Starting SeaBios (version 0.5.1)
&gt; 
&gt;   gPXE (http://etherboot.org) - 00:04.0 C900 PCI2.10 PnP BBS PMM7FE0@10 C900
&gt; 
&gt;   Booting from Hard Disk...
&gt; 
&gt; If I connect to the VM's console using 'virsh console', there's no output
&gt; at all. I don't see anything in /var/log/messages or /var/log/libvirt that
&gt; looks like an error.
&gt; 
&gt; So, I'm not sure what's going on here, as this is the first time I've done
&gt; anything with virtualization. Has my VM hung, or is this what's supposed to
&gt; happen? I was expecting that somewhere along the line that my VM would get
&gt; an IP address via DHCP so I could SSH to it, but don't see anything indicatin
&gt; g
&gt; that has happend, or what the IP address is if it has. Is something broken
&gt; here, or have I missed a crucial step?
&gt;

Follow-up: The problem was having hardware virtualization support turned
off in the host's BIOS. (Doh!) Once I turned that on, not only was 
installing a guest about 10x faster, but it also booted properly afterward.

-- 
J.

</body></email><email><emailId>20100628150808</emailId><senderName>Christian Patsch</senderName><senderEmail>christian.patsch@gonicus.de</senderEmail><timestampReceived>2010-06-28 15:08:08-0400</timestampReceived><subject>Re: [libvirt-users] VirtualBox headless</subject><body>

Hi,

thanks for your hint.

I read the lines in the documentation, but unfortunately editing the xml
within virsh lead to the errors.

The Solution to a headless domain was to edit the XML file from bash and
then

#virsh: define &lt;domainname.xml&gt;

to reload the new values for the graphics type of the machine.

Obvioulsy something went wrong when editing "live"....

Regards,
Christian

Am 24.06.2010 18:27, schrieb Jean-Baptiste Rouault:
&gt; Hi,
&gt;
&gt; Something like this should work, as can be seen in the
&gt; documentation here : http://libvirt.org/formatdomain.html#elementsGraphics
&gt;
&gt; &lt;drivers&gt;
&gt;   &lt;graphics type='rdp' autoport='yes' /&gt;
&gt; &lt;/drivers&gt;
&gt;
&gt; Regards,
&gt;
&gt; Jean-Baptiste
&gt;
&gt;   
&gt;&gt; Hello,
&gt;&gt;
&gt;&gt; I'm trying to use the VirtualBox/vbox driver together with libvirt 0.8.1
&gt;&gt; on a Ubuntu Lucid Machine, VirtualBox Release 3.1.
&gt;&gt;
&gt;&gt; The goal is to run the virtual machines headless and to connect using RDP.
&gt;&gt;
&gt;&gt; When starting a virtual domain using 'virsh start &lt;domainname&gt;' the GUI
&gt;&gt; of VirtualBox will pop up and I see no option to prevent this. If X is
&gt;&gt; not running, the virsh command will terminate with 'unknown failure'.
&gt;&gt;
&gt;&gt; I've found some hints on inclusion of the headless statement in the
&gt;&gt; 'graphics' part of the XML definition file, but when I tree to adopt
&gt;&gt; this, the editing of the file will crash.
&gt;&gt;
&gt;&gt; Has anyone achieved to manage VBox machines with libvirt on a headless
&gt;&gt; server ?
&gt;&gt;
&gt;&gt; Thanks in advance for some hints or experiences with this issue,
&gt;&gt; Christian
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; libvirt-users mailing list
&gt;&gt; libvirt-users@redhat.com
&gt;&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;&gt;
&gt;&gt;     


-- 
*Christian Patsch &lt;Christian.Patsch@GONICUS.de&gt; (Senior Consultant)
*GONICUS GmbH * Zentrale * Moehnestr. 11-17 * 59755 Arnsberg
*Tel.: +49 (0) 2932 / 916 - 0 * Fax: +49 (0) 29 32 / 916 - 273
*http://www.GONICUS.de

*Sitz der Gesellschaft: Moehnestrasse 11-17 * D-59755 Arnsberg
*Geschaeftsfuehrer: Rainer Luelsdorf, Alfred Schroeder
*Vorsitzender des Beirats: Juergen Michels
*Amtsgericht Arnsberg * HRB 1968

</body></email><email><emailId>20100628152708</emailId><senderName>Justin Clift</senderName><senderEmail>justin@salasaga.org</senderEmail><timestampReceived>2010-06-28 15:27:08-0400</timestampReceived><subject>Re: [libvirt-users] VirtualBox driver : creating storage for a new machine</subject><body>

On 06/29/2010 01:14 AM, Christian Patsch wrote:
&lt;snip&gt;
&gt; Next I tried to create a new volume from a XML file, but the only thing
&gt; I'm getting are segmentation faults.

Hi Christian,

Are you using the latest git head?  Asking the question because it's 
broken at the moment.  Some commits on friday killed it. :/

If that's the problem you're having, you can roll back to this commit 
and the segfaults shouldn't happen:

   8914453 phyp: reduce scope of driver functions

If you're not using the latest git head, then just ignore this email. :)

Regards and best wishes,

Justin Clift

-- 
Salasaga  -  Open Source eLearning IDE
               http://www.salasaga.org

</body></email><email><emailId>20100630142104</emailId><senderName>Tom Hughes</senderName><senderEmail>tom@compton.nu</senderEmail><timestampReceived>2010-06-30 14:21:04-0400</timestampReceived><subject>Re: [libvirt-users] Some missunderstanding in the wiki page</subject><body>

On 30/06/10 10:35, Leopold Palomo-Avellaneda wrote:

&gt; The configuration (I have follow only the debian/ubuntu steps) shows that br0
&gt; has assigned an IP. I did the mistake to try to assign the same IP in the
&gt; guest network configuration, I understand that, and obviously it doesn't work
&gt; (duplicate IPs). So, to me, it would me more clear if the br0 interface has
&gt; no IP. In my case, I have two nics: eth0 the interface for the host and eth1
&gt; for the guest. The eth1 part in my network/interfaces is:
&gt;
&gt; ...
&gt; auto eth1
&gt; iface eth1 inet manual
&gt;
&gt; auto br0
&gt; iface br0 inet manual
&gt;          bridge_ports  eth1
&gt;          bridge_stp    on
&gt;          bridge_maxwait  0
&gt;          bridge_fd       0
&gt; ...
&gt;
&gt; and then in the guest you configure the IP as you want. In the host, eth1 (or
&gt; whatever interface you bridge) has no IP, so it's not used, and the guest
&gt; uses completely.

The common configuration that the wiki is documenting is presumably the 
case where the host has a single ethernet interface that is shared by 
the host and the guests. In that configuration the bridge does have an 
address, which is the address of the host machine.

Basically a bridge is like a virtual ethernet switch inside your 
machine, where one port is connected to each device that is enslaved to 
it and another port is connected to the kernel's IP stack - that port 
appears as the brN interface and can have an IP address (for the host) 
assigned to it.

Tom

-- 
Tom Hughes (tom@compton.nu)
http://compton.nu/

</body></email><email><emailId>20100630152106</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-06-30 15:21:06-0400</timestampReceived><subject>[libvirt-users] FYI: a short guide to libvirt &amp; network filtering iptables/ebtables use</subject><body>


I just wrote this to assist some Red Hat folks understanding
what libvirt does with iptables, and thought it is useful info
for the whole libvirt community. When I have time I'll adjust 
this content so that it can fit into the website in relevant
pages/places.

        Firewall / network filtering in libvirt
        =======================================

There are three pieces of libvirt functionality which do network
filtering of some type. At a high level they are:

 - The virtual network driver.

   This provides a isolated bridge device (ie no physical NICs
   enslaved). Guest TAP devices are attached to this bridge.
   Guests can talk to each other &amp; the host, and optionally the
   wider world.

 - The QEMU driver MAC filtering

   This provides a generic filtering of MAC addresses to prevent
   the guest spoofing its MAC address. This is mostly obsoleted by
   the next item, so won't be discussed further.

 - The network filter driver

   This provides fully configurable, arbitrary network filtering
   of traffic on guest NICs. Generic rulesets are defined at the
   host level to control traffic in some manner. Rules sets are
   then associated with individual NICs of a guest. While not as
   expressive as directly using iptables/ebtables, this can still
   do nearly everything you would want to on a guest NIC filter.


The virtual network driver
==========================

The typical configuration for guests is to use bridging of the
physical NIC on the host to connect the guest directly to the LAN.
In RHEL6 there is also the possibility of using macvtap/sr-iov
and VEPA connectivity. None of this stuff plays nicely with wireless
NICs, since they will typically silently drop any traffic with a
MAC address that doesn't match that of the physical NIC.

Thus the virtual network driver in libvirt was invented. This takes
the form of an isolated bridge device (ie one with no physical NICs
enslaved). The TAP devices associated with the guest NICs are attached
to the bridge device. This immediately allows guests on a single host
to talk to each other and to the host OS (modulo host IPtables rules).

libvirt then uses iptables to control what further connectivity is
available. There are three configurations possible for a virtual
network at time of writing

  - isolated: all off-node traffic is completely blocked
  - nat: outbound traffic to the LAN is allowed, but MASQUERADED
  - forward: outbound traffic to the LAN is allowed

The latter 'forward' case requires the virtual network be on a
separate sub-net from the main LAN, and that the LAN admin has
configured routing for this subnet.  In the future we intend to
add support for IP subnetting and/or proxy-arp. This allows for
the virtual network to use the same subnet as the main LAN &amp;
should avoid need for the LAN admin to configure special routing.

Libvirt will optionally also provide DHCP services to the virtual
network using DNSMASQ. In all cases, we need to allow DNS/DHCP
queries to the host OS. Since we can't predict whether the host
firewall setup is already allowing this, we insert 4 rules into
the head of the INPUT chain

  target     prot opt in     out     source               destination
  ACCEPT     udp  --  virbr0 *       0.0.0.0/0            0.0.0.0/0           udp \
dpt:53  ACCEPT     tcp  --  virbr0 *       0.0.0.0/0            0.0.0.0/0           \
tcp dpt:53  ACCEPT     udp  --  virbr0 *       0.0.0.0/0            0.0.0.0/0         \
udp dpt:67  ACCEPT     tcp  --  virbr0 *       0.0.0.0/0            0.0.0.0/0         \
tcp dpt:67

Note we have restricted our rules to just the bridge associated
with the virutal network, to avoid opening undesirable holes in
the host firewall wrt the LAN/WAN.

The next rules depend on the type of connectivity allowed, and go
in the main FORWARD chain:

type=isolated
-------------

Allow traffic between guests. Deny inbound. Deny outbound.

  target     prot opt in     out     source               destination
  ACCEPT     all  --  virbr1 virbr1  0.0.0.0/0            0.0.0.0/0
  REJECT     all  --  *      virbr1  0.0.0.0/0            0.0.0.0/0           \
reject-with icmp-port-unreachable  REJECT     all  --  virbr1 *       0.0.0.0/0       \
0.0.0.0/0           reject-with icmp-port-unreachable

type=nat
--------

Allow inbound related to an established connection. Allow
outbound, but only from our expected subnet. Allow traffic
between guests. Deny all other inbound. Deny all other outbound.

  target     prot opt in     out     source               destination
  ACCEPT     all  --  *      virbr0  0.0.0.0/0            192.168.122.0/24    state \
RELATED,ESTABLISHED  ACCEPT     all  --  virbr0 *       192.168.122.0/24     \
0.0.0.0/0  ACCEPT     all  --  virbr0 virbr0  0.0.0.0/0            0.0.0.0/0
  REJECT     all  --  *      virbr0  0.0.0.0/0            0.0.0.0/0           \
reject-with icmp-port-unreachable  REJECT     all  --  virbr0 *       0.0.0.0/0       \
0.0.0.0/0           reject-with icmp-port-unreachable

type=routed
-----------

Allow inbound, but only to our expected subnet. Allow
outbound, but only from our expected subnet. Allow traffic
between guests. Deny all other inbound. Deny all other outbound.

  target     prot opt in     out     source               destination
  ACCEPT     all  --  *      virbr2  0.0.0.0/0            192.168.124.0/24
  ACCEPT     all  --  virbr2 *       192.168.124.0/24     0.0.0.0/0
  ACCEPT     all  --  virbr2 virbr2  0.0.0.0/0            0.0.0.0/0
  REJECT     all  --  *      virbr2  0.0.0.0/0            0.0.0.0/0           \
reject-with icmp-port-unreachable  REJECT     all  --  virbr2 *       0.0.0.0/0       \
0.0.0.0/0           reject-with icmp-port-unreachable


Finally, with type=nat, there is also an entry in the POSTROUTING
chain to apply masquerading

  target     prot opt in     out     source               destination
  MASQUERADE all  --  *      *       192.168.122.0/24    !192.168.122.0/24


The network filter driver
=========================

This driver provides a fully configurable network filtering capability
that leverages ebtables, iptables and ip6tables. This was written by
the libvirt guys at IBM and although its XML schema is defined by libvirt,
the conceptual model is closely aligned with the DMTF CIM schema for 
network filtering

  http://www.dmtf.org/standards/cim/cim_schema_v2230/CIM_Network.pdf

The filters are managed in libvirt as a top level, standalone object.
This allows the filters to then be referenced by any libvirt object
that requires their functionality, instead tieing them only to use
by guest NICs. In the current implementation, filters can be associated
with individual guest NICs via the libvirt domain XML format. In the
future we might allow filters to be associated with the virtual network
objects. Further we're expecting to define a new 'virtual switch' object
to remove the complexity of configuring bridge/sriov/vepa networking
modes. This make also end up making use of network filters.

There are a new set of virsh commands for managing network filters

   virsh nwfilter-define     define or update a network filter from an XML file
   virsh nwfilter-undefine   undefine a network filter
   virsh nwfilter-dumpxml    network filter information in XML
   virsh nwfilter-list       list network filters
   virsh nwfilter-edit       edit XML configuration for a network filter

There are equivalently named C APIs for each of these commands.

As with all objects libvirt manages, network filters are configured
using an XML format. At a high level the format looks like this:

  &lt;filter name='no-spamming' chain='XXXX'&gt;
    &lt;uuid&gt;d217f2d7-5a04-0e01-8b98-ec2743436b74&lt;/uuid&gt;

    &lt;rule ...&gt;
      ....
    &lt;/rule&gt;

    &lt;filterref filter='XXXX'/&gt;
  &lt;/filter&gt;

Every filter has a name and UUID which serve as unique identifiers.
A filter can have zero-or-more &lt;rule&gt; elements which are used to
actually define network controls. Filters can be arranged into a
DAG, so zero-or-more &lt;filterref/&gt; elements are also allowed. Cycles
in the graph are not allowed.

The &lt;rule&gt; element is where all the interesting stuff happens. It
has three attributes, an action, a traffic direction and an optional
priority. eg

  &lt;rule action='drop' direction='out' priority='500'&gt;

Within the rule there are a wide variety of elements allowed, which
do protocol specific matching. Supported protocols currently include
'mac', 'arp', 'rarp', 'ip', 'ipv6', 'tcp/ip', 'icmp/ip', 'igmp/ip',
'udp/ip', 'udplite/ip' 'esp/ip', 'ah/ip', 'sctp/ip', 'tcp/ipv6',
'icmp/ipv6', 'igmp/ipv6', 'udp/ipv6', 'udplite/ipv6', 'esp/ipv6',
'ah/ipv6', 'sctp/ipv6'. Each protocol defines what is valid inside
the &lt;rule&gt; element, the general pattern though is

   &lt;protocol match='yes|no' attribute1='value1' attribute2='value2'/&gt;

so, eg a TCP protocol, matching ports 0-1023 would be expressed
as:

   &lt;tcp match='yes' srcportstart='0' srcportend='1023'/&gt;


Attributes can included references to variables defined by the
object using the rule. So the guest XML format allows each NIC
to have a MAC address and IP address defined. These are made
available to filters via the variables $IP and $MAC.

So to define a filter the prevents IP address spoofing we can
simply match on source IP address != $IP

  &lt;filter name='no-ip-spoofing' chain='ipv4'&gt;
    &lt;rule action='drop' direction='out'&gt;
        &lt;ip match='no' srcipaddr='$IP' /&gt;
    &lt;/rule&gt;
  &lt;/filter&gt;


I'm not going to go into details on all the other protocol
matches you can do, because it'll take far too much space.
You can read about the options here

  http://libvirt.org/formatnwfilter.html#nwfelemsRulesProto

Out of the box in RHEL6/Fedora rawhide, libvirt ships with a
set of default useful rules

  # virsh nwfilter-list
  UUID                                  Name                 
  ----------------------------------------------------------------
  15b1ab2b-b1ac-1be2-ed49-2042caba4abb  allow-arp           
  6c51a466-8d14-6d11-46b0-68b1a883d00f  allow-dhcp          
  7517ad6c-bd90-37c8-26c9-4eabcb69848d  allow-dhcp-server   
  3d38b406-7cf0-8335-f5ff-4b9add35f288  allow-incoming-ipv4 
  5ff06320-9228-2899-3db0-e32554933415  allow-ipv4          
  db0b1767-d62b-269b-ea96-0cc8b451144e  clean-traffic       
  f88f1932-debf-4aa1-9fbe-f10d3aa4bc95  no-arp-spoofing     
  772f112d-52e4-700c-0250-e178a3d91a7a  no-ip-multicast     
  7ee20370-8106-765d-f7ff-8a60d5aaf30b  no-ip-spoofing      
  d5d3c490-c2eb-68b1-24fc-3ee362fc8af3  no-mac-broadcast    
  fb57c546-76dc-a372-513f-e8179011b48a  no-mac-spoofing     
  dba10ea7-446d-76de-346f-335bd99c1d05  no-other-l2-traffic 
  f5c78134-9da4-0c60-a9f0-fb37bc21ac1f  no-other-rarp-traffic
  7637e405-4ccf-42ac-5b41-14f8d03d8cf3  qemu-announce-self  
  9aed52e7-f0f3-343e-fe5c-7dcb27b594e5  qemu-announce-self-rarp


Most of these are just building blocks. The interesting one here
is 'clean-traffic'. This pulls together all the building blocks
into one filter that you can then associate with a guest NIC.
This stops the most common bad things a guest might try, IP
spoofing, arp spoofing and MAC spoofing. To look at the rules for
any of these just do

   virsh nwfilter-dumpxml FILTERNAME|UUID

They are all stored in /etc/libvirt/nwfilter, but don't edit
files there directly. Use 'virsh nwfilter-define' to update
them. This ensures the guests have their iptables/ebtables
rules recreated.

To associate the clean-trafffic filter with a guest, edit the
guest XML config and change the &lt;interface&gt; element to include
a &lt;filterref&gt; and also specify the whitelisted &lt;ip addres/&gt; the
guest is allowed to use

    &lt;interface type='bridge'&gt;
      &lt;mac address='52:54:00:56:44:32'/&gt;
      &lt;source bridge='br1'/&gt;
      &lt;ip address='10.33.8.131'/&gt;
      &lt;target dev='vnet0'/&gt;
      &lt;model type='virtio'/&gt;
      &lt;filterref filter='clean-traffic'/&gt;
    &lt;/interface&gt;

If no &lt;ip address&gt; is included, the network filter driver will
activate its 'learning mode'. This uses libpcap to snoop on
network traffic the guest sends and attempts to identify the
first IP address it uses. It then locks traffic to this address.
Obviously this isn't entirely secure, but it does offer some
protection against the guest being trojaned once up &amp; running.
In the future we intend to enhance the learning mode so that it
looks for DHCPOFFERS from a trusted DHCP server and only allows
the offered IP address to be used.

Now, how is all this implemented... The network filter driver
uses a combination of ebtables, iptables and ip6tables, depending
on which protocols are referenced in a filter. The out of the box
'clean-traffic' filter rules only require use of ebtables. If you
want to do matching at tcp/udp/etc protocols (eg to add a new
filter 'no-email-spamming' to block port 25), then iptables will
also be used.

The driver attempts to keep its rules separate from those that
the host admin might already have configured. So the first thing
it does with ebtables, is to add two hooks in POSTROUTING &amp;
PREROUTING chains, to redirect traffic to custom chains. These
hooks match on the TAP device name of the guest NIC, so they
should not interact badly with any administrator defined rules

  Bridge chain: PREROUTING, entries: 1, policy: ACCEPT
  -i vnet0 -j libvirt-I-vnet0

  Bridge chain: POSTROUTING, entries: 1, policy: ACCEPT
  -o vnet0 -j libvirt-O-vnet0


To keep things managable &amp; easy to follow, the driver will then
create further sub-chains for each protocol then it needs to match
against:

  Bridge chain: libvirt-I-vnet0, entries: 5, policy: ACCEPT
  -p IPv4 -j I-vnet0-ipv4
  -p ARP -j I-vnet0-arp
  -p 0x8035 -j I-vnet0-rarp
  -p 0x835 -j ACCEPT
  -j DROP

  Bridge chain: libvirt-O-vnet0, entries: 4, policy: ACCEPT
  -p IPv4 -j O-vnet0-ipv4
  -p ARP -j O-vnet0-arp
  -p 0x8035 -j O-vnet0-rarp
  -j DROP



Finally, come the actual implementation of the filters. These
example is showing the 'clean-traffic' filter implementation.
I'm not going to explain what this is doing now :-)

  Bridge chain: I-vnet0-ipv4, entries: 2, policy: ACCEPT
  -s ! 52:54:0:56:44:32 -j DROP 
  -p IPv4 --ip-src ! 10.33.8.131 -j DROP 

  Bridge chain: O-vnet0-ipv4, entries: 1, policy: ACCEPT
  -j ACCEPT 

  Bridge chain: I-vnet0-arp, entries: 6, policy: ACCEPT
  -s ! 52:54:0:56:44:32 -j DROP 
  -p ARP --arp-mac-src ! 52:54:0:56:44:32 -j DROP 
  -p ARP --arp-ip-src ! 10.33.8.131 -j DROP 
  -p ARP --arp-op Request -j ACCEPT 
  -p ARP --arp-op Reply -j ACCEPT 
  -j DROP 

  Bridge chain: O-vnet0-arp, entries: 5, policy: ACCEPT
  -p ARP --arp-op Reply --arp-mac-dst ! 52:54:0:56:44:32 -j DROP 
  -p ARP --arp-ip-dst ! 10.33.8.131 -j DROP 
  -p ARP --arp-op Request -j ACCEPT 
  -p ARP --arp-op Reply -j ACCEPT 
  -j DROP 

  Bridge chain: I-vnet0-rarp, entries: 2, policy: ACCEPT
  -p 0x8035 -s 52:54:0:56:44:32 -d Broadcast --arp-op Request_Reverse --arp-ip-src \
0.0.0.0 --arp-ip-dst 0.0.0.0 --arp-mac-src 52:54:0:56:44:32 --arp-mac-dst \
                52:54:0:56:44:32 -j ACCEPT 
  -j DROP 

  Bridge chain: O-vnet0-rarp, entries: 2, policy: ACCEPT
  -p 0x8035 -d Broadcast --arp-op Request_Reverse --arp-ip-src 0.0.0.0 --arp-ip-dst \
                0.0.0.0 --arp-mac-src 52:54:0:56:44:32 --arp-mac-dst 52:54:0:56:44:32 \
                -j ACCEPT 
  -j DROP 


NB, we would have liked to include the prefix 'libvirt-' in all
of our chain names, but unfortunately the kernel limits names
to a very short maximum length. So only the first two custom
chains can include that prefix. The others just include the
TAP device name + protocol name.

If I define a new filter 'no-spamming' and then add this to the
'clean-traffic' filter, I can illustrate how iptables usage works.

  # cat &gt; /root/spamming.xml &lt;&lt;EOF
  &lt;filter name='no-spamming' chain='root'&gt;
    &lt;uuid&gt;d217f2d7-5a04-0e01-8b98-ec2743436b74&lt;/uuid&gt;
    &lt;rule action='drop' direction='out' priority='500'&gt;
      &lt;tcp dstportstart='25' dstportend='25'/&gt;
    &lt;/rule&gt;
  &lt;/filter&gt;
  EOF
  # virsh nwfilter-define /root/spamming.xml
  # virsh nwfilter-edit clean-traffic

   ...add  &lt;filterref filter='no-spamming'/&gt;

All active guests immediately have their iptables/ebtables rules
rebuilt.

The network filter driver deals with iptables in a very similar
way. First it separates out its rules from those the admin may
have defined, by adding a couple of hooks into the INPUT/FORWARD
chains

  Chain INPUT (policy ACCEPT 13M packets, 21G bytes)
  target           prot opt in     out     source               destination
  libvirt-host-in  all  --  *      *       0.0.0.0/0            0.0.0.0/0

  Chain FORWARD (policy ACCEPT 5532K packets, 3010M bytes)
  target           prot opt in     out     source               destination
  libvirt-in       all  --  *      *       0.0.0.0/0            0.0.0.0/0
  libvirt-out      all  --  *      *       0.0.0.0/0            0.0.0.0/0
  libvirt-in-post  all  --  *      *       0.0.0.0/0            0.0.0.0/0


These custom chains, then do matching based on the TAP device
name, so they won't open holes in the admin defined matches for
the LAN/WAN (if any).

Chain libvirt-host-in (1 references)
  target     prot opt in     out     source               destination
  HI-vnet0   all  --  *      *       0.0.0.0/0            0.0.0.0/0           [goto] \
PHYSDEV match --physdev-in vnet0

Chain libvirt-in (1 references)
  target     prot opt in     out     source               destination
  FI-vnet0   all  --  *      *       0.0.0.0/0            0.0.0.0/0           [goto] \
PHYSDEV match --physdev-in vnet0

Chain libvirt-in-post (1 references)
  target     prot opt in     out     source               destination
  ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0           PHYSDEV \
match --physdev-in vnet0

Chain libvirt-out (1 references)
  target     prot opt in     out     source               destination
  FO-vnet0   all  --  *      *       0.0.0.0/0            0.0.0.0/0           [goto] \
PHYSDEV match --physdev-out vnet0



Finally, we can see the interesting bit which is the actual
implementation of my filter to block port 25 access:

Chain FI-vnet0 (1 references)
  target     prot opt in     out     source               destination
  DROP       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0           tcp \
dpt:25

Chain FO-vnet0 (1 references)
  target     prot opt in     out     source               destination
  DROP       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0           tcp \
spt:25

Chain HI-vnet0 (1 references)
  target     prot opt in     out     source               destination
  DROP       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0           tcp \
dpt:25



One thing in looking at this that you may notice is that if there
are many guests all using the same filters, we will be duplicating
the iptables rules over &amp; over for each guest. This is merely a
limitation of the current rules engine implementation. At the libvirt
object modelling level you can clearly see we've designed the model
so that filter rules are define in one place, and indirectly referenced
by guests. Thus it should be possible to change the impl in the future
so that we can share the actual iptables/ebtables rules for each
guest to create a more scalable system. The stuff in current libvirt
is more or less the very first working impl we've had of this stuff, 
so there's not been much optimization work yet.

Also notice that at the XML level we don't expose the fact that we
are using iptables or ebtables at all. The rule definition is done in
terms of network protocols. Thus if we ever find a need, we could
plug in an alternative implementation that calls out to a different
firewall implementation instead of ebtables/iptables (providing that
impl was suitably expressive of course)

Finally, in terms of problems we have in deployment. The biggest
problem is that if the admin does 'service iptables restart' all
our work gets blown away. We've experimented with using lokkit
to record our custom rules in a persistent config file, but that
caused different problem. Admins who were not using lokkit for
their config found that all their own rules got blown away. So
we threw away our lokkit code. Instead we document that if you
run 'service iptables restart', you need to send SIGHUP to libvirt
to make it recreate its rules.

Finally a reminder, that the main documentation we have on this
is online at http://libvirt.org/formatnwfilter.html

Regards,
Daniel
-- 
&gt; &gt; Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
&gt; &gt; http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
&gt; &gt; http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
&gt; &gt; GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|


</body></email><email><emailId>20100630174217</emailId><senderName>Guido Winkelmann</senderName><senderEmail>guido-libvi@unknownsite.de</senderEmail><timestampReceived>2010-06-30 17:42:17-0400</timestampReceived><subject>Re: [libvirt-users] Better error codes when stopping a VM that is already stopped</subject><body>

Am Freitag, 21. Mai 2010 schrieb Cole Robinson:
&gt; On 05/21/2010 08:11 AM, Guido Winkelmann wrote:
&gt; &gt; Hi,
&gt; &gt; 
&gt; &gt; Sometimes when stopping a virtual domain using virDomainDestroy(), I come
&gt; &gt; across a domain that is already stopped. (For example when someone
&gt; &gt; already stopped the domain manually using virsh or because the guest OS
&gt; &gt; issued a shutdown.) This is a special case that I absolutely need to
&gt; &gt; catch and handle.
&gt; 
&gt; In virt-manager, we basically do:
&gt; 
&gt; def destroy(vm):
&gt;     if vm.is_running():
&gt;         vm.destroy()
&gt;     return
&gt; 
&gt; I'd recommend doing something similar in your app: no reason to run a
&gt; command if you can check ahead of time if it will fail. You can use
&gt; virDomainIsActive to check the domain status.

That's not a real solution. It might reduce the frequency with which the 
problem occurs, but it's still subject to a race condition.

&gt; &gt; Unfortunately, when this happens, and I call virGetLastError()
&gt; &gt; afterwards, I always just get the error code VIR_ERR_OPERATION_INVALID,
&gt; &gt; which doesn't look very precise to me...
&gt; &gt; 
&gt; &gt; Two questions about this:
&gt; &gt; 
&gt; &gt; Is the domain not running at that moment the only possible condition that
&gt; &gt; can trigger this particular error code when calling virDomainDestroy()?
&gt; 
&gt; Yes, there are other errors but none that use OPERATION_INVALID.

After switching from libvirt 0.8.1 to libvirt from git, I'm getting 
VIR_ERR_RPC when trying to stop a domain that is not running. :(

Could this be caused by a mismatch of the libvirt versions between the machine 
my code is running on (0.8.1) and the version of libvirt on the qemu host 
(git)?

	Guido

</body></email><email><emailId>20100630192819</emailId><senderName></senderName><senderEmail>steven765@yahoo.com</senderEmail><timestampReceived>2010-06-30 19:28:19-0400</timestampReceived><subject>[libvirt-users] Are memoryPeek and blockPeek still not supported?</subject><body>

Hi, 
   I just tried x=dom.blockPeek('disk',5,0,buf,0) and it returns AtrributeError: \
'module' object has no attribute 'virDomainBlockPeek'

I found this bug submission from early 09: \
https://bugzilla.redhat.com/show_bug.cgi?format=multiple&amp;id=492683

Is that still correct are they not implemented. Or did i screw up the command? 
Thanks,
Steve


      


</body></email><email><emailId>20100630201820</emailId><senderName>Tom Georgoulias</senderName><senderEmail>tomg@mcclatchyinteractive.com</senderEmail><timestampReceived>2010-06-30 20:18:20-0400</timestampReceived><subject>Re: [libvirt-users] how to match the ID of a LUN in a storage pool with the GUID on the target serve</subject><body>

On 06/30/2010 02:47 PM, Daniel P. Berrange wrote:

&gt; I discovered you can get the info from UDEV, eg if libvirt reports a
&gt; volume '/dev/sde' you can query against the block device path
&gt;
&gt; # scsi_id --export --whitelisted /dev/sde
&gt; ID_VENDOR=QNAP
&gt; ID_VENDOR_ENC=QNAP
&gt; ID_MODEL=iSCSI_Storage
&gt; ID_MODEL_ENC=iSCSI\x20Storage
&gt; ID_REVISION=3.1
&gt; ID_TYPE=disk
&gt; ID_SERIAL=36001405e61fd1a5d6f1dd4d66d9630d2
&gt; ID_SERIAL_SHORT=6001405e61fd1a5d6f1dd4d66d9630d2
&gt;
&gt;
&gt; The ID_SERIAL field should be what you what IIUC
&gt;
&gt; We'll see about making libvirt report this value directly as the 'key' for
&gt; the volume

Thanks, that will be very helpful.  Did you get the previous 2 repliles 
I sent to the list?  I did the same thing and shared the results, but 
didn't hear back.

Tom

</body></email><email><emailId>20100630231052</emailId><senderName>Adam Gray</senderName><senderEmail>adam@meebo-inc.com</senderEmail><timestampReceived>2010-06-30 23:10:52-0400</timestampReceived><subject>Re: [libvirt-users] SASL GSSAPI error "Key table entry not found"</subject><body>

On Wed, Jun 30, 2010 at 10:13, Daniel P. Berrange &lt;berrange@redhat.com&gt; wrote:
&gt;
&gt; If changing the location in /etc/sasl2/libvirt.conf doesn't
&gt; work then you likely have a broken kerberos/sasl library.
&gt; This works in latest versions, but for broken systems you
&gt; can workaround it by setting KRB5_KTNAME=/etc/libvirt/krb5.tab
&gt; as an env variable when starting libvirtd.

Looks like upstart doesn't work quite like I thought. Running this
from the command line shows it changed the file path:
KRB5_KTNAME=/etc/libvirt/krb5.keytab strace -f -ff -eopen libvirtd
--listen 2&gt;&amp;1 |grep keytab
[pid  2412] open("/etc/libvirt/krb5.keytab", O_RDONLY) = 39

&gt;
&gt; Do you have your server hostname configured to exactly match
&gt; my.fully.qualified.domain (as per hostname -f command), and
&gt; is that hostname present in the DNS records, both forward and
&gt; reverse lookups. Using /etc/hosts is not sufficient for kerberos
&gt; to work IIRC.

Yeah, I ran into that one way too many times to forget :(
hostname -f gives fqdn, dig on that fqdn gives the right IP, dig -x on
that IP gives a PTR to the same fqdn.

&gt;
&gt; That just says the client doesn't have a ticket so not
&gt; really of interest since you just kdestroy'd the ticket :-)

</body></email><email><emailId>20100507140234</emailId><senderName>guido</senderName><senderEmail>guido-libvi@unknownsite.de</senderEmail><timestampReceived>2010-05-07 14:02:34-0400</timestampReceived><subject>[libvirt-users] How to prevent IP-spoofing/traffic sniffing by the guest machines? (KVM)</subject><body>

Hi,

In a libvirt/KVM setup, what is the best way to prevent untrusted guest 
machines from (a) sending packets with a sender address different from their 
own and (b) reading packets not intended for them?

Note that guests may have any number of IP addresses they are allowed to use 
legitimately.

        Guido

</body></email><email><emailId>20100510081629</emailId><senderName>Anthony Davis</senderName><senderEmail>tony@specialistdevelopment.com</senderEmail><timestampReceived>2010-05-10 08:16:29-0400</timestampReceived><subject>Re: [libvirt-users] Error connecting to console</subject><body>

Hi Chris,

Thanks for the response, will try and sort it out today...

Kind Regards

Tony

Quoting Chris Lalancette &lt;clalance@redhat.com&gt;:

&gt; On 04/30/2010 09:11 AM, Anthony Davis wrote:
&gt;&gt; Hi,
&gt;&gt;
&gt;&gt; i have KVM running at the moment and im trying to do a text based
&gt;&gt; install of centos, so i need to connect to the console via virsh
&gt;&gt;
&gt;&gt; virsh console servername
&gt;&gt;
&gt;&gt; but i get this error:
&gt;&gt;
&gt;&gt; error: Failed to get local hostname
&gt;
&gt; Yeah, this is an unfortunate bug in the virsh console code at
&gt; the moment.  It tries to fetch the hostname so that it can check
&gt; whether the connection is local or remote (since we don't currently
&gt; support the console on remote machines).
&gt;
&gt; The problem usually comes down to the fact that whatever "hostname"
&gt; returns maps to localhost.  In /etc/hosts, make sure that the 127.0.0.1
&gt; line only has "localhost" and "localhost.localdomain", and *not* the
&gt; hostname of your server.  Then make sure /etc/hosts has an entry for
&gt; the IP address of your machine.  If you can't get it to work, send
&gt; a copy of your /etc/hosts, the output from "hostname" and the output
&gt; from "ifconfig", and I can suggest modifications.
&gt;
&gt; Note that this is considered a bug, and we want to fix it, we just
&gt; haven't gotten around to it yet.
&gt;
&gt; --
&gt; Chris Lalancette
&gt;
&gt;


</body></email><email><emailId>20100507125001</emailId><senderName>guido</senderName><senderEmail>guido-libvirt@unknownsite.de</senderEmail><timestampReceived>2010-05-07 12:50:01-0400</timestampReceived><subject>[libvirt-users] How to prevent IP-spoofing/traffic sniffing by the guest machines?</subject><body>

Hi,

In a libvirt/KVM setup, what is the best way to prevent untrusted guest 
machines from (a) sending packets with a sender address different from their 
own and (b) reading packets not intended for them?

Note that guests may have any number of IP addresses they are allowed to use 
legitimately.

	Guido

-- 
Too much multitasking isn't good for you.

</body></email><email><emailId>20100507134501</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2010-05-07 13:45:01-0400</timestampReceived><subject>Re: [libvirt-users] Error connecting to console</subject><body>

On 04/30/2010 09:11 AM, Anthony Davis wrote:
&gt; Hi,
&gt; 
&gt; i have KVM running at the moment and im trying to do a text based
&gt; install of centos, so i need to connect to the console via virsh
&gt; 
&gt; virsh console servername
&gt; 
&gt; but i get this error:
&gt; 
&gt; error: Failed to get local hostname

Yeah, this is an unfortunate bug in the virsh console code at
the moment.  It tries to fetch the hostname so that it can check
whether the connection is local or remote (since we don't currently
support the console on remote machines).

The problem usually comes down to the fact that whatever "hostname"
returns maps to localhost.  In /etc/hosts, make sure that the 127.0.0.1
line only has "localhost" and "localhost.localdomain", and *not* the
hostname of your server.  Then make sure /etc/hosts has an entry for
the IP address of your machine.  If you can't get it to work, send
a copy of your /etc/hosts, the output from "hostname" and the output
from "ifconfig", and I can suggest modifications.

Note that this is considered a bug, and we want to fix it, we just
haven't gotten around to it yet.

-- 
Chris Lalancette

</body></email><email><emailId>20100515073452</emailId><senderName>Alexander Topolanek</senderName><senderEmail>atopo@ocv.org</senderEmail><timestampReceived>2010-05-15 07:34:52-0400</timestampReceived><subject>[libvirt-users] XML-Created domain vanishes after shutdown</subject><body>


Hi,

im migrating existing kvm-images into libvirt domains, by creating a 
domain in virsh from a xml file. The domain starts, is working fine, but 
after shutdown it is lost, and I have to recreate it.

BTW, can I reset the domain count somewhere?

Any ideas?

thx and kind regards
Alexander

virsh # version
Compiled against library: libvir 0.4.6
Using library: libvir 0.4.6
Using API: QEMU 0.4.6
Running hypervisor: QEMU 0.9.1


This is my xml file:

&lt;domain type='qemu' id='2'&gt;
&lt;name&gt;munin&lt;/name&gt;
&lt;uuid&gt;6bb2995a-5443-2ddb-67fe-d69a9814ece4&lt;/uuid&gt;
&lt;memory&gt;262144&lt;/memory&gt;
&lt;currentMemory&gt;524288&lt;/currentMemory&gt;
&lt;vcpu&gt;2&lt;/vcpu&gt;
&lt;os&gt;
&lt;type arch='x86_64' machine='pc'&gt;hvm&lt;/type&gt;
&lt;boot dev='hd'/&gt;
&lt;/os&gt;
&lt;features&gt;
&lt;acpi/&gt;
&lt;apic/&gt;
&lt;pae/&gt;
&lt;/features&gt;
&lt;clock offset='utc'/&gt;
&lt;on_poweroff&gt;preserve&lt;/on_poweroff&gt;
&lt;on_reboot&gt;restart&lt;/on_reboot&gt;
&lt;on_crash&gt;restart&lt;/on_crash&gt;
&lt;devices&gt;
&lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;
&lt;disk type='file' device='disk'&gt;
&lt;source file='/var/kvm/virsh/munin.img'/&gt;
&lt;target dev='hda' bus='ide'/&gt;
&lt;/disk&gt;
&lt;interface type='bridge'&gt;
&lt;mac address='00:30:1c:45:40:02'/&gt;
&lt;source bridge='br0'/&gt;
&lt;target dev='vnet0'/&gt;
&lt;model type='virtio'/&gt;
&lt;/interface&gt;
&lt;input type='mouse' bus='ps2'/&gt;
&lt;graphics type='vnc' port='5900' autoport='yes' listen='127.0.0.1' 
keymap='de'/&gt;
&lt;/devices&gt;
&lt;/domain&gt;




["smime.p7s" (application/pkcs7-signature)]

</body></email><email><emailId>20100511084038</emailId><senderName>Zhang Qian</senderName><senderEmail>zhq527725@gmail.com</senderEmail><timestampReceived>2010-05-11 08:40:38-0400</timestampReceived><subject>[libvirt-users] Can not restore domain from a shared state file</subject><body>

Hi,

I have two KVM host: h1 and h2, both of them mount an NFS directory as a
shared storage.
I can save (virsh save &lt;domain&gt; &lt;file&gt;) a domain in h1 to a state file in
the shared storage successfully, but failed to restore it from h2 with the
following error message:
# virsh restore testRes.dat
error: Failed to restore domain from testRes.dat
error: operation failed: failed to start VM

I can always restore it from h1, but sometimes works for h2 (wait for a
while, then "virsh restore" command may succeed in h2). I guess the state
file generated by "virsh save" command is not intact from h2 point view, may
be cause by the cache of NFS server?

Any suggestions will be really appreciated, thanks in advance!


Regards,
Qian

[Attachment #3 (text/html)]

Hi,&lt;br&gt;&lt;br&gt;I have two KVM host: h1 and h2, both of them mount an NFS direct=
ory as a shared storage.&lt;br&gt;I can save (virsh save &lt;domain&gt; &lt;file&amp;=
gt;) a domain in h1 to a state file in the shared storage successfully, but=
 failed to restore it from h2 with the following error message:&lt;br&gt;
# virsh restore testRes.dat &lt;br&gt;error: Failed to restore domain from testRe=
s.dat&lt;br&gt;error: operation failed: failed to start VM&lt;br&gt;&lt;br&gt;I can always re=
store it from h1, but sometimes works for h2 (wait for a while, then "=
virsh restore" command may succeed in h2). I guess the state file gene=
rated by "virsh save" command is not intact from h2 point view, m=
ay be cause by the cache of NFS server?&lt;br&gt;
&lt;br&gt;Any suggestions will be really appreciated, thanks in advance!&lt;br&gt;&lt;br&gt;&lt;=
br&gt;Regards,&lt;br&gt;Qian&lt;br&gt;&lt;br&gt;


</body></email><email><emailId>20100511105244</emailId><senderName>Zhang Qian</senderName><senderEmail>zhq527725@gmail.com</senderEmail><timestampReceived>2010-05-11 10:52:44-0400</timestampReceived><subject>Re: [libvirt-users] Can not restore domain from a shared state file</subject><body>

I found that waiting for a while does not work, but if I tried to restore it
from h2 more times, it will work.
For example, if I save a domain which has 512MB memory, and restore if from
h2 repeatedly, at the third time, the restore can succeed, but  for a 256MB
domain, it will succeed at the second time.


2010/5/11 Zhang Qian &lt;zhq527725@gmail.com&gt;

&gt; Hi,
&gt;
&gt; I have two KVM host: h1 and h2, both of them mount an NFS directory as a
&gt; shared storage.
&gt; I can save (virsh save &lt;domain&gt; &lt;file&gt;) a domain in h1 to a state file in
&gt; the shared storage successfully, but failed to restore it from h2 with the
&gt; following error message:
&gt; # virsh restore testRes.dat
&gt; error: Failed to restore domain from testRes.dat
&gt; error: operation failed: failed to start VM
&gt;
&gt; I can always restore it from h1, but sometimes works for h2 (wait for a
&gt; while, then "virsh restore" command may succeed in h2). I guess the state
&gt; file generated by "virsh save" command is not intact from h2 point view, may
&gt; be cause by the cache of NFS server?
&gt;
&gt; Any suggestions will be really appreciated, thanks in advance!
&gt;
&gt;
&gt; Regards,
&gt; Qian
&gt;
&gt;

[Attachment #3 (text/html)]

I found that waiting for a while does not work, but if I tried to restore it from h2 \
more times, it will work.&lt;br&gt;For example, if I save a domain which has 512MB memory, \
and restore if from h2 repeatedly, at the third time, the restore can succeed, but  \
for a 256MB domain, it will succeed at the second time.&lt;br&gt; &lt;br&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;2010/5/11 Zhang Qian &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:zhq527725@gmail.com"&gt;zhq527725@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="border-left: 1px solid rgb(204, 204, 204); margin: 0pt 0pt \
0pt 0.8ex; padding-left: 1ex;"&gt; Hi,&lt;br&gt;&lt;br&gt;I have two KVM host: h1 and h2, both of \
them mount an NFS directory as a shared storage.&lt;br&gt;I can save (virsh save \
&lt;domain&gt; &lt;file&gt;) a domain in h1 to a state file in the shared storage \
successfully, but failed to restore it from h2 with the following error message:&lt;br&gt;

# virsh restore testRes.dat &lt;br&gt;error: Failed to restore domain from \
testRes.dat&lt;br&gt;error: operation failed: failed to start VM&lt;br&gt;&lt;br&gt;I can always \
restore it from h1, but sometimes works for h2 (wait for a while, then "virsh \
restore" command may succeed in h2). I guess the state file generated by \
"virsh save" command is not intact from h2 point view, may be cause by the \
cache of NFS server?&lt;br&gt;

&lt;br&gt;Any suggestions will be really appreciated, thanks in \
advance!&lt;br&gt;&lt;br&gt;&lt;br&gt;Regards,&lt;br&gt;&lt;font color="#888888"&gt;Qian&lt;br&gt;&lt;br&gt; \
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20100518093706</emailId><senderName>Michael =?ISO-8859-1?Q?L=F6blich?=</senderName><senderEmail>ml@hejoe.de</senderEmail><timestampReceived>2010-05-18 09:37:06-0400</timestampReceived><subject>[libvirt-users] learn XML &lt;network/&gt;</subject><body>

Can please anybody write a XML-description for the diagram shown on 
http://libvirt.org/archnetwork.html

Michael

</body></email><email><emailId>20100518145106</emailId><senderName>Ralf Hornik Mailings</senderName><senderEmail>ralf@best.homeunix.org</senderEmail><timestampReceived>2010-05-18 14:51:06-0400</timestampReceived><subject>[libvirt-users] ctrl+alt+2 disabled?</subject><body>

Dear list,

I need to attach pci devices using qemu command interface but when I  
use the vnc connection started using virsh, the key combination (or  
qemu interface) seems to be disabled.

How can I (re)enable it?

Thanks and best regards

Ralf


</body></email><email><emailId>20100519071546</emailId><senderName></senderName><senderEmail>socketpair@gmail.com</senderEmail><timestampReceived>2010-05-19 07:15:46-0400</timestampReceived><subject>[libvirt-users] Update of libvirt website required. not all information about XML tags</subject><body>

The problem desribed here: https://bugzilla.redhat.com/show_bug.cgi?id=593266

Please update http://www.libvirt.org/formatdomain.html and describe
NEW xml tags, like &lt;serial&gt;xxxx&lt;/serial&gt; for hard drive and all cpu
tags, other if any.


-- 
Segmentation fault

</body></email><email><emailId>20100519094900</emailId><senderName>Jiri Denemark</senderName><senderEmail>jdenemar@redhat.com</senderEmail><timestampReceived>2010-05-19 09:49:00-0400</timestampReceived><subject>Re: [libvirt-users] Update of libvirt website required. not all information about XML tags</subject><body>

&gt; The problem desribed here: https://bugzilla.redhat.com/show_bug.cgi?id=593266
&gt; 
&gt; Please update http://www.libvirt.org/formatdomain.html and describe
&gt; NEW xml tags, like &lt;serial&gt;xxxx&lt;/serial&gt; for hard drive and all cpu
&gt; tags, other if any.

What cpu tag are you missing from the documentation? The description at
http://www.libvirt.org/formatdomain.html#elementsCPU is complete and
up-to-date.

Jirka

</body></email><email><emailId>20100521121147</emailId><senderName>Guido Winkelmann</senderName><senderEmail>guido-libvi@unknownsite.de</senderEmail><timestampReceived>2010-05-21 12:11:47-0400</timestampReceived><subject>[libvirt-users] Better error codes when stopping a VM that is already stopped</subject><body>

Hi,

Sometimes when stopping a virtual domain using virDomainDestroy(), I come 
across a domain that is already stopped. (For example when someone already 
stopped the domain manually using virsh or because the guest OS issued a 
shutdown.) This is a special case that I absolutely need to catch and handle.

Unfortunately, when this happens, and I call virGetLastError() afterwards, I 
always just get the error code VIR_ERR_OPERATION_INVALID, which doesn't look 
very precise to me...

Two questions about this:

Is the domain not running at that moment the only possible condition that can 
trigger this particular error code when calling virDomainDestroy()?

Can't we have a more obvious/precise error code in that case, like 
VIR_ERR_DOMAIN_NOT_RUNNING or something like that?

	Guido Winkelmann

</body></email><email><emailId>20100525070750</emailId><senderName></senderName><senderEmail>socketpair@gmail.com</senderEmail><timestampReceived>2010-05-25 07:07:50-0400</timestampReceived><subject>[libvirt-users] How to obtain rights to extend libvirt documentation pages</subject><body>

For example, http://libvirt.org/formatdomain.html#elementsDisks
does not contain &lt;serial&gt;xxxx&lt;/serial&gt; tag.
(https://bugzilla.redhat.com/show_bug.cgi?id=593266)

I wrote to community (users and developers). No one has added this
information to the site...

-- 
Segmentation fault

</body></email><email><emailId>20100526223310</emailId><senderName></senderName><senderEmail>steven765@yahoo.com</senderEmail><timestampReceived>2010-05-26 22:33:10-0400</timestampReceived><subject>[libvirt-users] Hot-add interface crashes libvirt</subject><body>

Hi Everyone,
   After upgrading FC12 and now FC13 whenever I try to attach a network device using \
attach-device it promptly crashes libvirtd.  Is there an option that changed in the \
network interface xml spec I missed?  I really need this feature or at least the \
ability to connect and disconnect interfaces if that's possible?

I've tried defining my network card in several ways:

First the one that worked previously:

&lt;interface type="network"&gt;
   &lt;mac address="52:54:00:5c:fe:a8"/&gt;
   &lt;source network="fedora"/&gt;
&lt;/interface&gt; 

Second copying what appeared in the xml after using the add hardware through the VMM:


&lt;interface type='network'&gt;
   &lt;mac address='52:54:00:5c:fe:a8'/&gt;
   &lt;source network='fedora'/&gt;
   &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x06' function='0x0'/&gt;
&lt;/interface&gt; 

Both ways fail now. Please help.
Thanks,
Steve





      


</body></email><email><emailId>20100513112133</emailId><senderName>udo1</senderName><senderEmail>udo1@udo.hu</senderEmail><timestampReceived>2010-05-13 11:21:33-0400</timestampReceived><subject>[libvirt-users] ballooning option xml</subject><body>

Hi everybody,

I need the ballooning option with kvm using libvirt xml file and virsh 
(virsh create domain.xml)
kvm line must be appended with the -balloon virtio switch to enable 
ballooning. (can be disabled if there no option or with -balloon none )

I currently using Ubuntu Lucid

How can I define this in the domain xml file, or what need I to do to 
get this option?
is there any option like
enabling with
&lt;balloon&gt;virtio&lt;/balloon&gt;
or
disabling with
&lt;balloon&gt;none&lt;/balloon&gt;


Thanks in Advance
Udo Attila Fischer

</body></email><email><emailId>20100528151030</emailId><senderName>Guido Winkelmann</senderName><senderEmail>guido-libvi@unknownsite.de</senderEmail><timestampReceived>2010-05-28 15:10:30-0400</timestampReceived><subject>[libvirt-users] Cannot create qcow2 images with libvirt 0.8.1</subject><body>

Hi,

After upgrading to libvirt 0.8.1, I can no longer create empty volumes with no 
backing store and an explicit format of qcow2.

This XML volume definition:

&lt;volume&gt;
  &lt;name&gt;testserverb-data2.img&lt;/name&gt;
  &lt;allocation&gt;0&lt;/allocation&gt;
  &lt;capacity units='G'&gt;20&lt;/capacity&gt;
  &lt;target&gt;
    &lt;format type='qcow2'/&gt;
    &lt;permissions&gt;
      &lt;owner&gt;107&lt;/owner&gt;
      &lt;group&gt;107&lt;/group&gt;
      &lt;mode&gt;0744&lt;/mode&gt;
    &lt;/permissions&gt;
  &lt;/target&gt;
&lt;/volume&gt;

yields the error "Cannot run /usr/bin/qemu-img to create /data/testserverb-
data.img: Invalid argument"

In /var/log/messages on the qemu host I can find the following snippet after 
that:

error : virRunWithHook:933 : internal error '/usr/bin/qemu-img create -f qcow2 
/data/testserverb-data.img 0K' exited with non-zero status 1 and signal 0: 
qemu-img: Image creation needs a size parameter#012
error : virStorageBackendCreateExecCommand:537 : Cannot run /usr/bin/qemu-img 
to create /data/testserverb-data.img: Invalid argument
error : qemudClientReadBuf:1653 : gnutls_record_recv: A TLS packet with 
unexpected length was received.

If I leave out the &lt;format&gt; element and/or specify a &lt;backingStore&gt; element 
for the volume, it works again. (I suppose the backing store makes it work 
because in that case qemu-img does not need a size parameter...)

The host system is a vanilla Fedora Core 12 system (aside from the upgraded 
libvirt).

Regards,

	Guido Winkelmann

</body></email><email><emailId>20100528180726</emailId><senderName>Rafael Braga</senderName><senderEmail>rafaeltelematica@gmail.com</senderEmail><timestampReceived>2010-05-28 18:07:26-0400</timestampReceived><subject>[libvirt-users] Update Libvirt</subject><body>

Hi,

I installed the opensuse 11.0 and libvirt version installed is 0.4.
But, Nimbus need the version 0.6.3. How do I upgrade? I can't by YAST...

thanks!

-- 
Rafael Braga

[Attachment #3 (text/html)]

&lt;span id="result_box" class="medium_text"&gt;&lt;span style="background-color: rgb(255, \
255, 255);" title="hi," onmouseover="this.style.backgroundColor='#ebeff9'" \
onmouseout="this.style.backgroundColor='#fff'"&gt;Hi, &lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;span \
style="background-color: rgb(255, 255, 255);" title="no  opensuse que instalei a \
verso do libvirt  a 0.4." \
onmouseover="this.style.backgroundColor='#ebeff9'" \
onmouseout="this.style.backgroundColor='#fff'"&gt;I installed the opensuse 11.0  \
and libvirt version installed is 0.4.&lt;br&gt;But, &lt;/span&gt;&lt;span style="background-color: \
rgb(255, 255, 255);" title="Para instalar o nimbus preciso da verso  0.6.3." \
onmouseover="this.style.backgroundColor='#ebeff9'" \
onmouseout="this.style.backgroundColor='#fff'"&gt;Nimbus need the version 0.6.3. \
&lt;/span&gt;&lt;span style="background-color: rgb(255, 255, 255);" title="Como fao para \
atualizar?" onmouseover="this.style.backgroundColor='#ebeff9'" \
onmouseout="this.style.backgroundColor='#fff'"&gt;How do I upgrade? &lt;/span&gt;&lt;span \
title="Pelo YAST no" onmouseover="this.style.backgroundColor='#ebeff9'" \
onmouseout="this.style.backgroundColor='#fff'"&gt;I can't by YAST...&lt;br&gt;

&lt;/span&gt;&lt;span style="background-color: rgb(255, 255, 255);" title="consigo..." \
onmouseover="this.style.backgroundColor='#ebeff9'" \
onmouseout="this.style.backgroundColor='#fff'"&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;thanks!&lt;br&gt;

&lt;br&gt;-- &lt;br&gt;Rafael Braga&lt;br&gt;



</body></email><email><emailId>20100531153521</emailId><senderName>Guido Winkelmann</senderName><senderEmail>guido-libvi@unknownsite.de</senderEmail><timestampReceived>2010-05-31 15:35:21-0400</timestampReceived><subject>Re: [libvirt-users] Update Libvirt</subject><body>

Am Freitag, 28. Mai 2010 schrieb Rafael Braga:
&gt; Hi,
&gt; 
&gt; I installed the opensuse 11.0 and libvirt version installed is 0.4.
&gt; But, Nimbus need the version 0.6.3. How do I upgrade? I can't by YAST...

A quick Google search revealed that the newest OpenSUSE (11.2) ships with 
libvirt 0.7.2. Try upgrading to OpenSUSE 11.2.

If that is not an option, try to find alternative repositories for 11.0 that 
carry a newer libvirt or uninstall libvirt in yast and install the most recent 
version from source.

	Guido

</body></email><email><emailId>20100528183844</emailId><senderName>Guido Winkelmann</senderName><senderEmail>guido-libvi@unknownsite.de</senderEmail><timestampReceived>2010-05-28 18:38:44-0400</timestampReceived><subject>Re: [libvirt-users] Cannot create qcow2 images with libvirt 0.8.1</subject><body>

Am Freitag, 28. Mai 2010 schrieb Guido Winkelmann:

&gt; If I leave out the &lt;format&gt; element and/or specify a &lt;backingStore&gt; element
&gt; for the volume, it works again.

I have to correct myself:
If I leave out the format element, there will be an image created and there 
will be no error message, but the resulting image has a capacity of 0 bytes.

Regards

	Guido Winkelmann

</body></email><email><emailId>20100528185639</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-05-28 18:56:39-0400</timestampReceived><subject>Re: [libvirt-users] Cannot create qcow2 images with libvirt 0.8.1</subject><body>

On 05/28/2010 11:10 AM, Guido Winkelmann wrote:
&gt; Hi,
&gt; 
&gt; After upgrading to libvirt 0.8.1, I can no longer create empty volumes with no 
&gt; backing store and an explicit format of qcow2.
&gt; 
&gt; This XML volume definition:
&gt; 
&gt; &lt;volume&gt;
&gt;   &lt;name&gt;testserverb-data2.img&lt;/name&gt;
&gt;   &lt;allocation&gt;0&lt;/allocation&gt;
&gt;   &lt;capacity units='G'&gt;20&lt;/capacity&gt;

This should be 'unit', not 'units'. Libvirt is probably seeing that as
20 bytes, rounding down to 0K, and qemu-img isn't happy.

- Cole

&gt;   &lt;target&gt;
&gt;     &lt;format type='qcow2'/&gt;
&gt;     &lt;permissions&gt;
&gt;       &lt;owner&gt;107&lt;/owner&gt;
&gt;       &lt;group&gt;107&lt;/group&gt;
&gt;       &lt;mode&gt;0744&lt;/mode&gt;
&gt;     &lt;/permissions&gt;
&gt;   &lt;/target&gt;
&gt; &lt;/volume&gt;
&gt; 
&gt; yields the error "Cannot run /usr/bin/qemu-img to create /data/testserverb-
&gt; data.img: Invalid argument"
&gt; 
&gt; In /var/log/messages on the qemu host I can find the following snippet after 
&gt; that:
&gt; 
&gt; error : virRunWithHook:933 : internal error '/usr/bin/qemu-img create -f qcow2 
&gt; /data/testserverb-data.img 0K' exited with non-zero status 1 and signal 0: 
&gt; qemu-img: Image creation needs a size parameter#012
&gt; error : virStorageBackendCreateExecCommand:537 : Cannot run /usr/bin/qemu-img 
&gt; to create /data/testserverb-data.img: Invalid argument
&gt; error : qemudClientReadBuf:1653 : gnutls_record_recv: A TLS packet with 
&gt; unexpected length was received.
&gt; 
&gt; If I leave out the &lt;format&gt; element and/or specify a &lt;backingStore&gt; element 
&gt; for the volume, it works again. (I suppose the backing store makes it work 
&gt; because in that case qemu-img does not need a size parameter...)
&gt; 
&gt; The host system is a vanilla Fedora Core 12 system (aside from the upgraded 
&gt; libvirt).
&gt; 
&gt; Regards,
&gt; 
&gt; 	Guido Winkelmann
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

</body></email><email><emailId>20100526122106</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-05-26 12:21:06-0400</timestampReceived><subject>Re: [libvirt-users] ballooning option xml</subject><body>

2010/5/13 udo1 &lt;udo1@udo.hu&gt;:
&gt; Hi everybody,
&gt;
&gt; I need the ballooning option with kvm using libvirt xml file and virsh
&gt; (virsh create domain.xml)
&gt; kvm line must be appended with the -balloon virtio switch to enable
&gt; ballooning. (can be disabled if there no option or with -balloon none )
&gt;
&gt; I currently using Ubuntu Lucid
&gt;
&gt; How can I define this in the domain xml file, or what need I to do to get
&gt; this option?
&gt; is there any option like
&gt; enabling with
&gt; &lt;balloon&gt;virtio&lt;/balloon&gt;
&gt; or
&gt; disabling with
&gt; &lt;balloon&gt;none&lt;/balloon&gt;
&gt;
&gt;
&gt; Thanks in Advance
&gt; Udo Attila Fischer
&gt;

Ballooning is enabled by default and cannot be disabled via the domain XML.

Do you have any specific problem that makes you think there is a
problem with ballooning?

Matthias

</body></email><email><emailId>20100530093601</emailId><senderName>udo1</senderName><senderEmail>udo1@udo.hu</senderEmail><timestampReceived>2010-05-30 09:36:01-0400</timestampReceived><subject>Re: [libvirt-users] ballooning option xml</subject><body>

Hi Matthias,

In Ubuntu lucid using kvm, the balloning is disabled by default, so I 
would need to enable it.
(I currently have written a wrapper named as kvm adding this kvm option 
but this should not be the right way)

br
Udo Attila Fischer


on 2010.05.26. 14:21, Matthias Bolte wrote:
&gt; 2010/5/13 udo1&lt;udo1@udo.hu&gt;:
&gt;    
&gt;&gt; Hi everybody,
&gt;&gt;
&gt;&gt; I need the ballooning option with kvm using libvirt xml file and virsh
&gt;&gt; (virsh create domain.xml)
&gt;&gt; kvm line must be appended with the -balloon virtio switch to enable
&gt;&gt; ballooning. (can be disabled if there no option or with -balloon none )
&gt;&gt;
&gt;&gt; I currently using Ubuntu Lucid
&gt;&gt;
&gt;&gt; How can I define this in the domain xml file, or what need I to do to get
&gt;&gt; this option?
&gt;&gt; is there any option like
&gt;&gt; enabling with
&gt;&gt; &lt;balloon&gt;virtio&lt;/balloon&gt;
&gt;&gt; or
&gt;&gt; disabling with
&gt;&gt; &lt;balloon&gt;none&lt;/balloon&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; Thanks in Advance
&gt;&gt; Udo Attila Fischer
&gt;&gt;
&gt;&gt;      
&gt; Ballooning is enabled by default and cannot be disabled via the domain XML.
&gt;
&gt; Do you have any specific problem that makes you think there is a
&gt; problem with ballooning?
&gt;
&gt; Matthias
&gt;
&gt;    

</body></email><email><emailId>20100530112740</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-05-30 11:27:40-0400</timestampReceived><subject>Re: [libvirt-users] ballooning option xml</subject><body>

2010/5/30 udo1 &lt;udo1@udo.hu&gt;:
&gt; Hi Matthias,
&gt;
&gt; In Ubuntu lucid using kvm, the balloning is disabled by default, so I would
&gt; need to enable it.

How do you detect that it's disabled by default, because I cannot
reproduce that here with Ubuntu 10.04.

libvirt enables ballooning by default. Okay, it only does this when it
detects that your QEMU/KVM version supports it, but Ubuntu 10.04 has
QEMU 0.12.3 and that version has balloon support.

If libvirt detects that your QEMU supports the -device flag then it adds

  -device virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x3

to the command line in order to enable ballooning. This what's added
to the command line for me here.

If your QEMU doesn't supports the -device flag, but supports the
-balloon flag then

  -balloon virtio

is added to the command line in order to enable ballooning.

If your QEMU doesn't support non of these flags that you don't get ballooning.

You can check the used command line in
/var/log/libvirt/qemu/&lt;guest&gt;.log for qemu:///system connections or in
~/.libvirt/log/qemu/&lt;guest&gt;.log for qemu:///session connections.

....

At this point I realize that Ubuntu 10.04 comes with libvirt 0.7.5 and
now I understand your problem.

A comment in the current QEMU driver code says (since libvirt 0.7.6,
git commit 7a90f216):

    /* QEMU changed its default behavior to not include the virtio balloon
     * device.  Explicitly request it to ensure it will be present. */

So, libvirt 0.7.5 still assumes that QEMU automatically adds the
virtio balloon device. The comment and commit message don't say in
which QEMU version this was changed, but I assume that QEMU 0.12.3 (as
in Ubuntu 10.04) doesn't enable ballooing by default anymore.

So you're suffering from a version mismatch between your libvirt and
QEMU version: your libvirt is too old for your QEMU, or QEMU is too
new for libvirt.

I couldn't reproduce your problem at first because I don't have the
Ubuntu libvirt packages installed, but compile bleeding-edge libvirt
from source.

&gt; (I currently have written a wrapper named as kvm adding this kvm option but
&gt; this should not be the right way)

So you can fix this version mismatch with that script, or upgrade
libvirt to a version &gt;= 0.7.6. There is a PPA on Launchpad that offers
more up-to-date libvirt packages for Ubuntu.

  https://launchpad.net/~dnjl/+archive/virtualization

Matthias

&gt; br
&gt; Udo Attila Fischer
&gt;
&gt;
&gt; on 2010.05.26. 14:21, Matthias Bolte wrote:
&gt;&gt;
&gt;&gt; 2010/5/13 udo1&lt;udo1@udo.hu&gt;:
&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Hi everybody,
&gt;&gt;&gt;
&gt;&gt;&gt; I need the ballooning option with kvm using libvirt xml file and virsh
&gt;&gt;&gt; (virsh create domain.xml)
&gt;&gt;&gt; kvm line must be appended with the -balloon virtio switch to enable
&gt;&gt;&gt; ballooning. (can be disabled if there no option or with -balloon none )
&gt;&gt;&gt;
&gt;&gt;&gt; I currently using Ubuntu Lucid
&gt;&gt;&gt;
&gt;&gt;&gt; How can I define this in the domain xml file, or what need I to do to get
&gt;&gt;&gt; this option?
&gt;&gt;&gt; is there any option like
&gt;&gt;&gt; enabling with
&gt;&gt;&gt; &lt;balloon&gt;virtio&lt;/balloon&gt;
&gt;&gt;&gt; or
&gt;&gt;&gt; disabling with
&gt;&gt;&gt; &lt;balloon&gt;none&lt;/balloon&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Thanks in Advance
&gt;&gt;&gt; Udo Attila Fischer
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt; Ballooning is enabled by default and cannot be disabled via the domain
&gt;&gt; XML.
&gt;&gt;
&gt;&gt; Do you have any specific problem that makes you think there is a
&gt;&gt; problem with ballooning?
&gt;&gt;
&gt;&gt; Matthias
&gt;&gt;
&gt;&gt;
&gt;
&gt;

</body></email><email><emailId>20100525110136</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-05-25 11:01:36-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt] How to obtain rights to extend libvirt documentation pages</subject><body>

On Tue, May 25, 2010 at 01:07:50PM +0600, ???? ????????? wrote:
&gt; For example, http://libvirt.org/formatdomain.html#elementsDisks
&gt; does not contain &lt;serial&gt;xxxx&lt;/serial&gt; tag.
&gt; (https://bugzilla.redhat.com/show_bug.cgi?id=593266)
&gt; 
&gt; I wrote to community (users and developers). No one has added this
&gt; information to the site...

The website is all stored in the main GIT repository

http://libvirt.org/git/?p=libvirt.git;a=summary

under the 'docs/' subdirectory. If you want to contribute, just send a patch
for the .html.in file in docs/


Regards,
Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100521155010</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-05-21 15:50:10-0400</timestampReceived><subject>Re: [libvirt-users] Better error codes when stopping a VM that is already stopped</subject><body>

On 05/21/2010 08:11 AM, Guido Winkelmann wrote:
&gt; Hi,
&gt; 
&gt; Sometimes when stopping a virtual domain using virDomainDestroy(), I come 
&gt; across a domain that is already stopped. (For example when someone already 
&gt; stopped the domain manually using virsh or because the guest OS issued a 
&gt; shutdown.) This is a special case that I absolutely need to catch and handle.
&gt; 

In virt-manager, we basically do:

def destroy(vm):
    if vm.is_running():
        vm.destroy()
    return

I'd recommend doing something similar in your app: no reason to run a
command if you can check ahead of time if it will fail. You can use
virDomainIsActive to check the domain status.

&gt; Unfortunately, when this happens, and I call virGetLastError() afterwards, I 
&gt; always just get the error code VIR_ERR_OPERATION_INVALID, which doesn't look 
&gt; very precise to me...
&gt; 
&gt; Two questions about this:
&gt; 
&gt; Is the domain not running at that moment the only possible condition that can 
&gt; trigger this particular error code when calling virDomainDestroy()?
&gt; 

Yes, there are other errors but none that use OPERATION_INVALID.

&gt; Can't we have a more obvious/precise error code in that case, like 
&gt; VIR_ERR_DOMAIN_NOT_RUNNING or something like that?
&gt; 

Sounds like a reasonable idea, won't help you though if your app needs
to support older versions.

- Cole

</body></email><email><emailId>20100524102439</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-05-24 10:24:39-0400</timestampReceived><subject>Re: [libvirt-users] Better error codes when stopping a VM that is already stopped</subject><body>

On Fri, May 21, 2010 at 02:11:47PM +0200, Guido Winkelmann wrote:
&gt; Hi,
&gt; 
&gt; Sometimes when stopping a virtual domain using virDomainDestroy(), I come 
&gt; across a domain that is already stopped. (For example when someone already 
&gt; stopped the domain manually using virsh or because the guest OS issued a 
&gt; shutdown.) This is a special case that I absolutely need to catch and handle.
&gt; 
&gt; Unfortunately, when this happens, and I call virGetLastError() afterwards, I 
&gt; always just get the error code VIR_ERR_OPERATION_INVALID, which doesn't look 
&gt; very precise to me...
&gt; 
&gt; Two questions about this:
&gt; 
&gt; Is the domain not running at that moment the only possible condition that can 
&gt; trigger this particular error code when calling virDomainDestroy()?

The VIR_ERR_OPERATION_INVALID is a precise code that says the request
operation is not valid wrt the current state of the guest. So for the
virDomainDestroy() method, the only cause of this message is requesting
destroy of a guest that is not running.

Similarly you'll get it if you try to start a guest that is already
running.

&gt; Can't we have a more obvious/precise error code in that case, like 
&gt; VIR_ERR_DOMAIN_NOT_RUNNING or something like that?

The VIR_ERR_OPERATION_INVALID is already very precisely defined
as you need.


Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100524102616</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-05-24 10:26:16-0400</timestampReceived><subject>Re: [libvirt-users] Better error codes when stopping a VM that is already stopped</subject><body>

On Fri, May 21, 2010 at 11:50:10AM -0400, Cole Robinson wrote:
&gt; On 05/21/2010 08:11 AM, Guido Winkelmann wrote:
&gt; &gt; Hi,
&gt; &gt; 
&gt; &gt; Sometimes when stopping a virtual domain using virDomainDestroy(), I come 
&gt; &gt; across a domain that is already stopped. (For example when someone already 
&gt; &gt; stopped the domain manually using virsh or because the guest OS issued a 
&gt; &gt; shutdown.) This is a special case that I absolutely need to catch and handle.
&gt; &gt; 
&gt; 
&gt; In virt-manager, we basically do:
&gt; 
&gt; def destroy(vm):
&gt;     if vm.is_running():
&gt;         vm.destroy()
&gt;     return
&gt; 
&gt; I'd recommend doing something similar in your app: no reason to run a
&gt; command if you can check ahead of time if it will fail. You can use
&gt; virDomainIsActive to check the domain status.
&gt; 
&gt; &gt; Unfortunately, when this happens, and I call virGetLastError() afterwards, I 
&gt; &gt; always just get the error code VIR_ERR_OPERATION_INVALID, which doesn't look 
&gt; &gt; very precise to me...
&gt; &gt; 
&gt; &gt; Two questions about this:
&gt; &gt; 
&gt; &gt; Is the domain not running at that moment the only possible condition that can 
&gt; &gt; trigger this particular error code when calling virDomainDestroy()?
&gt; &gt; 
&gt; 
&gt; Yes, there are other errors but none that use OPERATION_INVALID.
&gt; 
&gt; &gt; Can't we have a more obvious/precise error code in that case, like 
&gt; &gt; VIR_ERR_DOMAIN_NOT_RUNNING or something like that?
&gt; &gt; 
&gt; 
&gt; Sounds like a reasonable idea, won't help you though if your app needs
&gt; to support older versions.

VIR_ERR_INVALID_OPERATION is already precisely defined to mean that
the operation request is not valid for the current state of the VM. 
VIR_ERR_DOMAIN_NOT_RUNNING would just be replicating those semantics,
but needlessly restricting itself to the case of not running, so you'd
end up having to add ALREADY_RUNNING, ALREADY_PAUSED, etc which is
just pointless

Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100524130724</emailId><senderName>"Brian K. White"</senderName><senderEmail>brian@aljex.com</senderEmail><timestampReceived>2010-05-24 13:07:24-0400</timestampReceived><subject>Re: [libvirt-users] Better error codes when stopping a VM that is already stopped</subject><body>

On 5/24/2010 6:24 AM, Daniel P. Berrange wrote:
&gt; On Fri, May 21, 2010 at 02:11:47PM +0200, Guido Winkelmann wrote:
&gt;    
&gt;&gt; Hi,
&gt;&gt;
&gt;&gt; Sometimes when stopping a virtual domain using virDomainDestroy(), I come
&gt;&gt; across a domain that is already stopped. (For example when someone already
&gt;&gt; stopped the domain manually using virsh or because the guest OS issued a
&gt;&gt; shutdown.) This is a special case that I absolutely need to catch and handle.
&gt;&gt;
&gt;&gt; Unfortunately, when this happens, and I call virGetLastError() afterwards, I
&gt;&gt; always just get the error code VIR_ERR_OPERATION_INVALID, which doesn't look
&gt;&gt; very precise to me...
&gt;&gt;
&gt;&gt; Two questions about this:
&gt;&gt;
&gt;&gt; Is the domain not running at that moment the only possible condition that can
&gt;&gt; trigger this particular error code when calling virDomainDestroy()?
&gt;&gt;      
&gt; The VIR_ERR_OPERATION_INVALID is a precise code that says the request
&gt; operation is not valid wrt the current state of the guest. So for the
&gt; virDomainDestroy() method, the only cause of this message is requesting
&gt; destroy of a guest that is not running.
&gt;    

You are saying there is, and can only ever be, one possible way that the 
operation could ever be considered invalid?
Even within the limited scope of virDomainDestroy() and the particular 
values it was called with, I find that hard to believe on general principle.

I can see that, say, it may not make any sense to try to tell the 
difference between "never was created" and "created but now destroyed".

Such distinctions probably belong in front end distro init scripts and 
other admin utils. IE: your script or util tracks whether or not it has 
tried to start a domain and whether or not the fact that it's not 
currently running is expected or an error.

-- 
bkw

</body></email><email><emailId>20100519114904</emailId><senderName></senderName><senderEmail>socketpair@gmail.com</senderEmail><timestampReceived>2010-05-19 11:49:04-0400</timestampReceived><subject>Re: [libvirt-users] Update of libvirt website required. not all information about XML tags</subject><body>

2010/5/19 Jiri Denemark &lt;jdenemar@redhat.com&gt;:
&gt;&gt; The problem desribed here: https://bugzilla.redhat.com/show_bug.cgi?id=593266
&gt;&gt;
&gt;&gt; Please update http://www.libvirt.org/formatdomain.html and describe
&gt;&gt; NEW xml tags, like &lt;serial&gt;xxxx&lt;/serial&gt; for hard drive and all cpu
&gt;&gt; tags, other if any.
&gt;
&gt; What cpu tag are you missing from the documentation? The description at
&gt; http://www.libvirt.org/formatdomain.html#elementsCPU is complete and
&gt; up-to-date.
http://berrange.com/posts/2010/02/15/guest-cpu-model-configuration-in-libvirt-with-qemukvm/
&gt;
&gt; Jirka
&gt;



-- 
Segmentation fault

</body></email><email><emailId>20100519120022</emailId><senderName>"Brian K. White"</senderName><senderEmail>brian@aljex.com</senderEmail><timestampReceived>2010-05-19 12:00:22-0400</timestampReceived><subject>Re: [libvirt-users] Update of libvirt website required. not all information about XML tags</subject><body>

On 5/19/2010 5:49 AM, Jiri Denemark wrote:
&gt;&gt; The problem desribed here: https://bugzilla.redhat.com/show_bug.cgi?id=593266
&gt;&gt;
&gt;&gt; Please update http://www.libvirt.org/formatdomain.html and describe
&gt;&gt; NEW xml tags, like&lt;serial&gt;xxxx&lt;/serial&gt;  for hard drive and all cpu
&gt;&gt; tags, other if any.
&gt;&gt;      
&gt; What cpu tag are you missing from the documentation? The description at
&gt; http://www.libvirt.org/formatdomain.html#elementsCPU is complete and
&gt; up-to-date.
&gt;
&gt;    

Where does he ask anything about elementsCPU?

He asked about disk mount options.

I have struggled myself to find where some things are documented which I 
see in various example configs but do not see documented anywhere.
Even the initial post to the list that introduces the new features 
merely supplied a sample config that used options that were not documented.
For instance:
https://lists.linux-foundation.org/pipermail/containers/2008-September/013237.html
And:
http://libvirt.org/drvlxc.html

Both provide sample configs full of options that I do not know where 
they are documented, what other options are valid in concert with the 
LXC driver.

For instance:
All sample configs above include, &lt;disk type='mount'&gt;
But the seemingly most logical place to look: 
http://libvirt.org/formatstorage.html
doesn't describe anything like that whole section of xml.
Getting past that I manage to find this:
http://libvirt.org/formatdomain.html#elementsDisks
But that states that: The type attribute is either "file" or "block"

So where is &lt;disk type='mount'&gt; documented?

This:
&lt;os&gt;
&lt;type&gt;exe&lt;/type&gt;
&lt;init&gt;/sbin/init&lt;/init&gt;
&lt;/os&gt;

Appears to be documented here:
http://libvirt.org/formatdomain.html#elementsOS
But that does not mention exe being valid for the type tag, and does not 
mention the init tag as even existing at all.

This is not a complete list of missing documentation. It's hard to say 
what's missing since, how can I know that something is missing unless I 
happen to see it mentioned in a sample config somewhere? Most of the 
sample configs are deliberately minimalistic so that they can provide a 
known working reference starting point thats as simple as possible, but 
that means that by definition they do not mention many things.

One thing I did see documented somewhere was that if the init tag is 
omitted then it defaults to /sbin/init. This appears to be untrue at 
least for 0.8.1 on openSUSE 11.2 x86_64

I also in general failed to find enough documentation to actually run a 
full OS in an LXC container using virsh and libvirt on openSUSE.

I have been running many containers successfully using lxc-tools. In 
fact I wrote
http://en.opensuse.org/LXC
and the init scripts in
http://download.opensuse.org/repositories/home:/aljex/openSUSE_11.2/src/lxc-0.6.5-50.1.src.rpm
so I think I do have at least a basic handle on using containers and 
have overcome many of the special problems that come with simply using 
virtualization at all, and containers in particular, and on openSUSE 
specifically.

However, trying to use libvirt in the same environment I got as far as 
being able to run /bin/sh but I couldn't get /proc, /sys, /dev working 
right.
Some problems may have been distribution-specific. For instance, when 
running /bin/bash (instead of /sbin/init), and from there trying to use 
yast (opensuse-specific admin tool), yast would crash, claiming that 
/dev was not mounted. Well I don't know why it would say that, and being 
an opensuse-specific tool it sure doesn't sound like a libvirt problem, 
or at least libvirt doesn't seem to be the first place to look for help. 
I mean, other apps worked. bash itself worked. From that bash shell, 
midnight commander worked. Just yast didn't. Which is why I didn't ask 
anything about that here. However on the other hand, I have no problem 
doing the same thing using lxc-start or lxc-exec running just /bin/bash 
instead of init, or init. So if yast works fine in lxc-start, then what 
can I fix or diagnose in yast? I couldn't run a full system because I 
couldn't get the console tty to work from init (even though bash worked 
fine), nor could I get the network device working, so I had no way to 
actually access the container although virsh and ps showed that at least 
init was running.

I'm not yet done trying everything within my power, which is why I 
hadn't said anything here yet.
My point is not to complain about not getting libvirt to work, I'm still 
putting in the learning time that I fully expected to have to put in 
before I expected to do anything useful. I do not like to have my time 
wasted by people who are not willing to spend any of their own, so I try 
not to ask that of others either.

My point is just that, as long as someone else happened to say the same 
thing I was thinking anyways, to very strongly second the OP's request 
for more and better documentation. I don't need very much hand holding, 
I just need at least some sort of reference for everything. What options 
are available or valid, and what do they do? Ramifications and 
implications that are not completely specific to libvirt I am happy to 
work out myself, and maybe help write the more hand-holdy docs in the 
wiki at some point later.

-- 
bkw

</body></email><email><emailId>20100519123039</emailId><senderName>Tom Hughes</senderName><senderEmail>tom@compton.nu</senderEmail><timestampReceived>2010-05-19 12:30:39-0400</timestampReceived><subject>Re: [libvirt-users] Update of libvirt website required. not all information about XML tags</subject><body>

On 19/05/10 13:00, Brian K. White wrote:
&gt; On 5/19/2010 5:49 AM, Jiri Denemark wrote:
&gt;&gt;&gt; The problem desribed here:
&gt;&gt;&gt; https://bugzilla.redhat.com/show_bug.cgi?id=593266
&gt;&gt;&gt;
&gt;&gt;&gt; Please update http://www.libvirt.org/formatdomain.html and describe
&gt;&gt;&gt; NEW xml tags, like&lt;serial&gt;xxxx&lt;/serial&gt; for hard drive and all cpu
&gt;&gt;&gt; tags, other if any.
&gt;&gt; What cpu tag are you missing from the documentation? The description at
&gt;&gt; http://www.libvirt.org/formatdomain.html#elementsCPU is complete and
&gt;&gt; up-to-date.
&gt;&gt;
&gt;
&gt; Where does he ask anything about elementsCPU?

When he said "and all cpu tags"?

Tom

-- 
Tom Hughes (tom@compton.nu)
http://compton.nu/

</body></email><email><emailId>20100519124041</emailId><senderName>"Brian K. White"</senderName><senderEmail>brian@aljex.com</senderEmail><timestampReceived>2010-05-19 12:40:41-0400</timestampReceived><subject>Re: [libvirt-users] Update of libvirt website required. not all information about XML tags</subject><body>

On 5/19/2010 8:30 AM, Tom Hughes wrote:
&gt; On 19/05/10 13:00, Brian K. White wrote:
&gt;&gt; On 5/19/2010 5:49 AM, Jiri Denemark wrote:
&gt;&gt;&gt;&gt; The problem desribed here:
&gt;&gt;&gt;&gt; https://bugzilla.redhat.com/show_bug.cgi?id=593266
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Please update http://www.libvirt.org/formatdomain.html and describe
&gt;&gt;&gt;&gt; NEW xml tags, like&lt;serial&gt;xxxx&lt;/serial&gt; for hard drive and all cpu
&gt;&gt;&gt;&gt; tags, other if any.
&gt;&gt;&gt; What cpu tag are you missing from the documentation? The description at
&gt;&gt;&gt; http://www.libvirt.org/formatdomain.html#elementsCPU is complete and
&gt;&gt;&gt; up-to-date.
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt; Where does he ask anything about elementsCPU?
&gt;
&gt; When he said "and all cpu tags"?

*headsmack*  thanks, sorry. :)

-- 
bkw

</body></email><email><emailId>20100521060332</emailId><senderName></senderName><senderEmail>socketpair@gmail.com</senderEmail><timestampReceived>2010-05-21 06:03:32-0400</timestampReceived><subject>Re: [libvirt-users] Update of libvirt website required. not all information about XML tags</subject><body>

2010/5/19    &lt;socketpair@gmail.com&gt;:
&gt; 2010/5/19 Jiri Denemark &lt;jdenemar@redhat.com&gt;:
&gt;&gt;&gt; The problem desribed here: https://bugzilla.redhat.com/show_bug.cgi?id=593266
&gt;&gt;&gt;
&gt;&gt;&gt; Please update http://www.libvirt.org/formatdomain.html and describe
&gt;&gt;&gt; NEW xml tags, like &lt;serial&gt;xxxx&lt;/serial&gt; for hard drive and all cpu
&gt;&gt;&gt; tags, other if any.
&gt;&gt;
&gt;&gt; What cpu tag are you missing from the documentation? The description at
&gt;&gt; http://www.libvirt.org/formatdomain.html#elementsCPU is complete and
&gt;&gt; up-to-date.
&gt; http://berrange.com/posts/2010/02/15/guest-cpu-model-configuration-in-libvirt-with-qemukvm/
&gt;&gt;
anybody home ?

</body></email><email><emailId>20100521081448</emailId><senderName>Jiri Denemark</senderName><senderEmail>jdenemar@redhat.com</senderEmail><timestampReceived>2010-05-21 08:14:48-0400</timestampReceived><subject>Re: [libvirt-users] Update of libvirt website required. not all information about XML tags</subject><body>

&gt; &gt;&gt;&gt; The problem desribed here: https://bugzilla.redhat.com/show_bug.cgi?id=593266
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; Please update http://www.libvirt.org/formatdomain.html and describe
&gt; &gt;&gt;&gt; NEW xml tags, like &lt;serial&gt;xxxx&lt;/serial&gt; for hard drive and all cpu
&gt; &gt;&gt;&gt; tags, other if any.
&gt; &gt;&gt;
&gt; &gt;&gt; What cpu tag are you missing from the documentation? The description at
&gt; &gt;&gt; http://www.libvirt.org/formatdomain.html#elementsCPU is complete and
&gt; &gt;&gt; up-to-date.
&gt; &gt; http://berrange.com/posts/2010/02/15/guest-cpu-model-configuration-in-libvirt-with-qemukvm/
&gt; &gt;&gt;
&gt; anybody home ?

Hmm, what would you like to hear? You haven't answered my question about what
part of cpu tag is not described in libvirt documentation. Please, be more
specific in what you miss in XML format description for the cpu tag.

To the best of my knowledge, semantics of all subelements/attributes and their
combinations is explained there. The URL you pasted as a reply is a
step-by-step guide for using the cpu selection feature, which is not something
that should be included in a description of domain XML format.

I'm not talking about hard drive configuration since I'm not familiar with all
the aspects of it. Someone else would need to complete the documentation there
if it's incomplete.

Jirka

</body></email><email><emailId>20100519124414</emailId><senderName>Ralf Hornik Mailings</senderName><senderEmail>ralf@best.homeunix.org</senderEmail><timestampReceived>2010-05-19 12:44:14-0400</timestampReceived><subject>Re: [libvirt-users] ctrl+alt+2 disabled?</subject><body>

Ralf Hornik Mailings &lt;ralf@best.homeunix.org&gt; wrote:

&gt; I need to attach pci devices using qemu command interface but when I  
&gt; use the vnc connection started using virsh, the key combination (or  
&gt; qemu interface) seems to be disabled.
&gt;
&gt; How can I (re)enable it?

No Ideas? Are there other ways to connect to qemu interface? I can't  
find any...

//Ralf

</body></email><email><emailId>20100519125222</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-05-19 12:52:22-0400</timestampReceived><subject>Re: [libvirt-users] ctrl+alt+2 disabled?</subject><body>

On Wed, May 19, 2010 at 02:44:14PM +0200, Ralf Hornik Mailings wrote:
&gt; Ralf Hornik Mailings &lt;ralf@best.homeunix.org&gt; wrote:
&gt; 
&gt; &gt;I need to attach pci devices using qemu command interface but when
&gt; &gt;I use the vnc connection started using virsh, the key combination
&gt; &gt;(or qemu interface) seems to be disabled.
&gt; &gt;
&gt; &gt;How can I (re)enable it?
&gt; 
&gt; No Ideas? Are there other ways to connect to qemu interface? I can't
&gt; find any...

libvirt provides APIs for invoking monitor commands,
including support for PCI devices. virt-manager has
UI for doing this, but if you want todo it the hard
way with virsh that's possible too. Either add the
device config in the initial XML, or attach it to a
live guest using 'virsh attach-device'. The XML
format is illustrated here:

http://fedoraproject.org/wiki/QA:Testcase_Virtualization_KVM_PCI_Device_Assignment_assign_using_libvirt

Daniel

</body></email><email><emailId>20100518135529</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-05-18 13:55:29-0400</timestampReceived><subject>Re: [libvirt-users] learn XML &lt;network/&gt;</subject><body>

On 05/18/2010 05:37 AM, Michael Lblich wrote:
&gt; Can please anybody write a XML-description for the diagram shown on 
&gt; http://libvirt.org/archnetwork.html
&gt; 

The network XML format is documented at:

http://libvirt.org/formatnetwork.html

- Cole

</body></email><email><emailId>20100518141721</emailId><senderName>David Ehle</senderName><senderEmail>ehle@agni.phys.iit.edu</senderEmail><timestampReceived>2010-05-18 14:17:21-0400</timestampReceived><subject>Re: [libvirt-users] learn XML &lt;network/&gt;</subject><body>


Thanks for posting this... Its embarassing, but I had gone to the "XML 
format" link before and went away grumbling because it was blank... 
somehow not seeing all the sub catagories with the detailed information!

Very useful!

On Tue, 18 May 2010, Cole Robinson wrote:

&gt; On 05/18/2010 05:37 AM, Michael Lblich wrote:
&gt;&gt; Can please anybody write a XML-description for the diagram shown on
&gt;&gt; http://libvirt.org/archnetwork.html
&gt;&gt;
&gt;
&gt; The network XML format is documented at:
&gt;
&gt; http://libvirt.org/formatnetwork.html
&gt;
&gt; - Cole
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

</body></email><email><emailId>20100512045541</emailId><senderName>Laine Stump</senderName><senderEmail>laine@laine.org</senderEmail><timestampReceived>2010-05-12 04:55:41-0400</timestampReceived><subject>Re: [libvirt-users] Can not restore domain from a shared state file</subject><body>

On 05/11/2010 04:40 AM, Zhang Qian wrote:
&gt; Hi,
&gt;
&gt; I have two KVM host: h1 and h2, both of them mount an NFS directory as 
&gt; a shared storage.
&gt; I can save (virsh save &lt;domain&gt; &lt;file&gt;) a domain in h1 to a state file 
&gt; in the shared storage successfully, but failed to restore it from h2 
&gt; with the following error message:
&gt; # virsh restore testRes.dat
&gt; error: Failed to restore domain from testRes.dat
&gt; error: operation failed: failed to start VM
&gt;
&gt; I can always restore it from h1, but sometimes works for h2 (wait for 
&gt; a while, then "virsh restore" command may succeed in h2). I guess the 
&gt; state file generated by "virsh save" command is not intact from h2 
&gt; point view, may be cause by the cache of NFS server?

There is a race condition in qemu when restarting a domain - it is 
possible for qemu to start the CPU before the domain image has been read 
from the file (this is regardless of where the file is stored). This may 
or may not be your problem (the error condition I saw due to this race 
was different from what you are seeing). It is easy to test for though - 
before saving your domain, first suspend it with "virsh suspend 
&lt;domain&gt;", then save it; after you've restored the domain with "virsh 
restore &lt;image-file&gt;", resume the domain with "virsh resume &lt;domain&gt;". 
If the domain successfully resumes, your problem was the race I 
describe. If not, you have found a different problem.

I'm interested to know if this solves your problem.

</body></email><email><emailId>20100510110420</emailId><senderName>Mathias Tausig</senderName><senderEmail>mathias.tausig@a-cert.at</senderEmail><timestampReceived>2010-05-10 11:04:20-0400</timestampReceived><subject>[libvirt-users] Volume not found when migrating a VM</subject><body>

Hello!

I want to migrate a machine from one host to another.
But upon running

migrate drbd01 qemu+tls://192.168.20.2/system

in virsh, I get the error message

Fehler: cannot open file '/dev/masterGroup/drbd01_system': No such file
or directory

"/dev/masterGroup/drbd01_system" is the LVM based system volume of the
VM to be migrated which is of course available (the machine can be
started without any problem). I tried to execute the migrate comman both
locally and remote.

I am using libvirt 0.8.1 under SLES11.

regards
Mathias

</body></email><email><emailId>20100511083724</emailId><senderName>angelo alfano</senderName><senderEmail>angeloalfa76@yahoo.it</senderEmail><timestampReceived>2010-05-11 08:37:24-0400</timestampReceived><subject>[libvirt-users] error libvirt</subject><body>

I have a problem con libvirt, if running this python code:



import libvirt
conn = libvirt.open("vbox:///session")

return this error:


libvir: QEMU error : server closed connection
libvir: warning : Failed to find the interface: Is the daemon running ?
libvir: Remote error : unable to connect to '/var/run/libvirt/libvirt-sock': Connection refused
libvir: warning : Failed to find a node driver: Is the libvirtd daemon running ?
libvir: Remote error : unable to connect to '/var/run/libvirt/libvirt-sock': Connection refused
libvir: warning : Failed to find a secret storage driver: Is the daemon running ?

If I running the python code in sudo mode, I don't have error.

I have before add the my user at the group "libvirtd" with:


sudo adduser user libvirtd

Angelo



      
[Attachment #3 (text/html)]

&lt;html&gt;&lt;head&gt;&lt;style type="text/css"&gt;&lt;!-- DIV {margin:0px;} \
--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div style="font-family:times new roman,new \
york,times,serif;font-size:12pt"&gt;&lt;div&gt;&lt;a \
href="https://www.redhat.com/archives/libvirt-users/"&gt;&lt;/a&gt;I have a problem con \
libvirt, if running this python code:&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div style="margin-left: \
40px;"&gt;import libvirt&lt;br&gt;conn = libvirt.open("vbox:///session")&lt;br&gt;&lt;/div&gt;&lt;br&gt;return \
this error:&lt;br&gt;&lt;br&gt;&lt;div style="margin-left: 40px;"&gt;libvir: QEMU error : server closed \
connection&lt;br&gt;libvir: warning : Failed to find the interface: Is the daemon running \
?&lt;br&gt;libvir: Remote error : unable to connect to '/var/run/libvirt/libvirt-sock': \
Connection refused&lt;br&gt;libvir: warning : Failed to find a node driver: Is the libvirtd \
daemon running ?&lt;br&gt;libvir: Remote error : unable to connect to \
'/var/run/libvirt/libvirt-sock': Connection refused&lt;br&gt;libvir: warning : Failed to \
find a secret storage driver: Is the daemon running ?&lt;br&gt;&lt;/div&gt;&lt;br&gt;If I running  the \
python code in sudo mode, I don't have error.&lt;br&gt;&lt;br&gt;I have before add the my user at \
the group "libvirtd" with:&lt;br&gt;&lt;br&gt;&lt;div style="margin-left: 40px;"&gt;sudo adduser user \
libvirtd&lt;br&gt;&lt;br&gt;&lt;/div&gt;Angelo&lt;br&gt;&lt;/div&gt; &lt;/div&gt;&lt;br&gt;



      &lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20100511112257</emailId><senderName>angelo alfano</senderName><senderEmail>angeloalfa76@yahoo.it</senderEmail><timestampReceived>2010-05-11 11:22:57-0400</timestampReceived><subject>[libvirt-users] remote libvirt vbox</subject><body>

I tried:

import libvirt
conn = libvirt.open("vbox+ssh://user@192.168.0.10/session")


Prompted for a password for ssh connection, but returns this 
error:

libvir: QEMU error : server closed connection
Traceback (most recent call last):
  File "/home/angelo/workspace/test.py", line 11, in &lt;module&gt;
    conn = libvirt.open("vbox+ssh://user@192.168.0.10/session")
  File "/usr/lib/python2.6/dist-packages/libvirt.py", line 169, in open
    if ret is None:raise libvirtError('virConnectOpen() failed')
libvirt.libvirtError: server closed connection


      
[Attachment #3 (text/html)]

&lt;html&gt;&lt;head&gt;&lt;style type="text/css"&gt;&lt;!-- DIV {margin:0px;} \
--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div style="font-family:times new roman,new \
york,times,serif;font-size:12pt"&gt;&lt;span id="result_box" class="short_text"&gt;&lt;span \
style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);" title=""&gt;I \
tried:&lt;br&gt;&lt;br&gt;import libvirt&lt;br&gt;conn = \
libvirt.open("vbox+ssh://user@192.168.0.10/session")&lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;div \
dir="ltr" style=""&gt;&lt;div id="tts_button" title="Ascolta la  traduzione" \
style="display: block;" class=" "&gt;&lt;object type="application/x-shockwave-flash" \
data="http://www.gstatic.com/translate/sound_player.swf" id="tts_flash" width="18" \
height="18"&gt;&lt;param value="http://www.gstatic.com/translate/sound_player.swf" \
name="movie"&gt;&lt;param value="sound_name=&amp;sound_name_cb=_TTSSoundFile" \
name="flashvars"&gt;&lt;param value="transparent" name="wmode"&gt;&lt;param value="always" \
name="allowScriptAccess"&gt;&lt;/object&gt;&lt;/div&gt;&lt;span id="result_box" \
class="short_text"&gt;&lt;span style="background-color: rgb(255, 255, 255);" \
title=""&gt;Prompted for a password for ssh connection, but returns this  \
error:&lt;br&gt;&lt;br&gt;libvir: QEMU error : server closed connection&lt;br&gt;Traceback (most recent \
call last):&lt;br&gt; File "/home/angelo/workspace/test.py", line 11, in \
&lt;module&gt;&lt;br&gt; conn = \
libvirt.open("vbox+ssh://user@192.168.0.10/session")&lt;br&gt; File \
"/usr/lib/python2.6/dist-packages/libvirt.py", line 169, in \
open&lt;br&gt; if ret is None:raise libvirtError('virConnectOpen() \
failed')&lt;br&gt;libvirt.libvirtError: server closed \
connection&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt; &lt;/div&gt;&lt;br&gt;



      &lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20100513141615</emailId><senderName>Zhang Qian</senderName><senderEmail>zhq527725@gmail.com</senderEmail><timestampReceived>2010-05-13 14:16:15-0400</timestampReceived><subject>[libvirt-users] How to eject cdrom by libvirt API</subject><body>

Hi,

I want to eject cdrom by calling libvirt C API, I found there is a similar
feature in virt-manager: disconnect cdrom from the related iso file, I am
wondering how to achieve this by libvirt API.
Thanks!


Regards,
Qian

[Attachment #3 (text/html)]

Hi,&lt;br&gt;&lt;br&gt;I want to eject cdrom by calling libvirt C API, I found there is a similar \
feature in virt-manager: disconnect cdrom from the related iso file, I am wondering \
how to achieve this by libvirt API.&lt;br&gt;Thanks!&lt;br&gt;&lt;br&gt; &lt;br&gt;Regards,&lt;br&gt;Qian&lt;br&gt;



</body></email><email><emailId>20100516062939</emailId><senderName>Arthur Pemberton</senderName><senderEmail>pemboa@gmail.com</senderEmail><timestampReceived>2010-05-16 06:29:39-0400</timestampReceived><subject>[libvirt-users] =?windows-1252?q?Red_Hat_Bugzilla_=96_Bug_592671_?= =?windows-1252?q?=3A_can=27t_use</subject><body>

url : https://bugzilla.redhat.com/show_bug.cgi?id=592671

basically I'm not getting any sound devices when invoking from
virt-manager at least.

-- 
Fedora 11
(www.pembo13.com)

</body></email><email><emailId>20100516092633</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-05-16 09:26:33-0400</timestampReceived><subject>Re: [libvirt-users] XML-Created domain vanishes after shutdown</subject><body>

On Sat, May 15, 2010 at 09:34:52AM +0200, Alexander Topolanek wrote:
&gt; Hi,
&gt; 
&gt; im migrating existing kvm-images into libvirt domains, by creating a 
&gt; domain in virsh from a xml file. The domain starts, is working fine, but 
&gt; after shutdown it is lost, and I have to recreate it.

   virsh create XML

boots up a transient guest that disappears after shutdown. If you
want it to stay around, the nuse

  virsh define XML
  virsh start GUESTNAME

&gt; BTW, can I reset the domain count somewhere?

That's implicitly reset when libvirtd is restarted, to the lowest
ID of any running guest, plus one.


Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100516134315</emailId><senderName>Zhang Qian</senderName><senderEmail>zhq527725@gmail.com</senderEmail><timestampReceived>2010-05-16 13:43:15-0400</timestampReceived><subject>Re: [libvirt-users] Can not restore domain from a shared state file</subject><body>

Hi Laine,

Thanks for your reply.
I think I have found a different problem. I tried what you said "before
saving your domain, first suspend it with "virsh suspend &lt;domain&gt;", then
save it; after you've restored the domain with "virsh restore &lt;image-file&gt;",
resume the domain with "virsh resume &lt;domain&gt;"", when I  restore the domain
on another host, it failed with the error I mentioned before:

error: Failed to restore domain from testRes.dat
error: operation failed: failed to start VM

But now I can resolve my problem in an "ugly" way: before restoring the
domain on another host, read the whole suspend image completely on that
host, here is my code to do that read, it is very simple:
    if ((fd = open(suspendImage, O_RDONLY)) &lt; 0) {
        goto error;
    }

    while ((size = read(fd, buf, MAXLINELEN))) {
        if (size == -1) {
            goto error;
        }
    }

    close(fd);

After these codes is executed, then restoring the domain on that host will
succeed! This solution(before restoring a domain on another host, read the
suspend image on that host completely) works every time in my environment up
to now.

I am not sure why it works, maybe this read operation triggers the NFS cache
refresh, so that the complete suspend image can be accessed in the target
host, I don't know...


Regards,
Qian

2010/5/12 Laine Stump &lt;laine@laine.org&gt;

&gt; On 05/11/2010 04:40 AM, Zhang Qian wrote:
&gt;
&gt;&gt; Hi,
&gt;&gt;
&gt;&gt; I have two KVM host: h1 and h2, both of them mount an NFS directory as a
&gt;&gt; shared storage.
&gt;&gt; I can save (virsh save &lt;domain&gt; &lt;file&gt;) a domain in h1 to a state file in
&gt;&gt; the shared storage successfully, but failed to restore it from h2 with the
&gt;&gt; following error message:
&gt;&gt; # virsh restore testRes.dat
&gt;&gt; error: Failed to restore domain from testRes.dat
&gt;&gt; error: operation failed: failed to start VM
&gt;&gt;
&gt;&gt; I can always restore it from h1, but sometimes works for h2 (wait for a
&gt;&gt; while, then "virsh restore" command may succeed in h2). I guess the state
&gt;&gt; file generated by "virsh save" command is not intact from h2 point view, may
&gt;&gt; be cause by the cache of NFS server?
&gt;&gt;
&gt;
&gt; There is a race condition in qemu when restarting a domain - it is possible
&gt; for qemu to start the CPU before the domain image has been read from the
&gt; file (this is regardless of where the file is stored). This may or may not
&gt; be your problem (the error condition I saw due to this race was different
&gt; from what you are seeing). It is easy to test for though - before saving
&gt; your domain, first suspend it with "virsh suspend &lt;domain&gt;", then save it;
&gt; after you've restored the domain with "virsh restore &lt;image-file&gt;", resume
&gt; the domain with "virsh resume &lt;domain&gt;". If the domain successfully resumes,
&gt; your problem was the race I describe. If not, you have found a different
&gt; problem.
&gt;
&gt; I'm interested to know if this solves your problem.
&gt;

[Attachment #3 (text/html)]

Hi Laine,&lt;br&gt;&lt;br&gt;Thanks for your reply.&lt;br&gt;I think I have found a different problem. \
I tried what you said "before saving your domain, first suspend it with \
"virsh suspend &lt;domain&gt;", then save it; after you've restored the \
domain with "virsh restore &lt;image-file&gt;", resume the domain with \
"virsh resume &lt;domain&gt;"", when I  restore the domain on another \
host, it failed with the error I mentioned before:&lt;div class="im"&gt;&lt;br&gt;error: Failed \
                to restore domain from testRes.dat&lt;br&gt;
error: operation failed: failed to start VM&lt;br&gt;&lt;br&gt;&lt;/div&gt;But
now I can resolve my problem in an "ugly" way: before restoring the
domain on another host, read the whole suspend image completely on that
host, here is my code to do that read, it is very simple:&lt;br&gt;
    if ((fd = open(suspendImage, O_RDONLY)) &lt; 0) {&lt;br&gt;        goto error;&lt;br&gt;    \
}&lt;br&gt;    &lt;br&gt;    while ((size = read(fd, buf, MAXLINELEN))) {&lt;br&gt;        if (size == \
-1) {&lt;br&gt;            goto error;&lt;br&gt;        }&lt;br&gt;    }&lt;br&gt;

&lt;br&gt;    close(fd);&lt;br&gt;&lt;br&gt;After these codes is executed, then restoring
the domain on that host will succeed! This solution(before restoring a
domain on another host, read the suspend image on that host completely)
works every time in my environment up to now.&lt;br&gt;
&lt;br&gt;I am not sure why it works, maybe this read operation triggers the
NFS cache refresh, so that the complete suspend image can be accessed
in the target host, I don't know...&lt;br&gt;&lt;br&gt;&lt;br&gt;Regards,&lt;br&gt;Qian&lt;br&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;2010/5/12 Laine Stump &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:laine@laine.org"&gt;laine@laine.org&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="border-left: 1px solid rgb(204, 204, 204); margin: 0pt 0pt \
0pt 0.8ex; padding-left: 1ex;"&gt; &lt;div class="im"&gt;On 05/11/2010 04:40 AM, Zhang Qian \
wrote:&lt;br&gt; &lt;blockquote class="gmail_quote" style="border-left: 1px solid rgb(204, \
204, 204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;"&gt; Hi,&lt;br&gt;
&lt;br&gt;
I have two KVM host: h1 and h2, both of them mount an NFS directory as a shared \
storage.&lt;br&gt; I can save (virsh save &lt;domain&gt; &lt;file&gt;) a domain in h1 to a \
state file in the shared storage successfully, but failed to restore it from h2 with \
the following error message:&lt;br&gt; # virsh restore testRes.dat&lt;br&gt;
error: Failed to restore domain from testRes.dat&lt;br&gt;
error: operation failed: failed to start VM&lt;br&gt;
&lt;br&gt;
I can always restore it from h1, but sometimes works for h2 (wait for a while, then \
"virsh restore" command may succeed in h2). I guess the state file \
generated by "virsh save" command is not intact from h2 point view, may be \
cause by the cache of NFS server?&lt;br&gt;

&lt;/blockquote&gt;
&lt;br&gt;&lt;/div&gt;
There is a race condition in qemu when restarting a domain - it is possible for qemu \
to start the CPU before the domain image has been read from the file (this is \
regardless of where the file is stored). This may or may not be your problem (the \
error condition I saw due to this race was different from what you are seeing). It is \
easy to test for though - before saving your domain, first suspend it with \
"virsh suspend &lt;domain&gt;", then save it; after you've restored the \
domain with "virsh restore &lt;image-file&gt;", resume the domain with \
"virsh resume &lt;domain&gt;". If the domain successfully resumes, your \
problem was the race I describe. If not, you have found a different problem.&lt;br&gt;

&lt;br&gt;
I'm interested to know if this solves your problem.&lt;br&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20100517060838</emailId><senderName>shy Perets</senderName><senderEmail>shyperets@gmail.com</senderEmail><timestampReceived>2010-05-17 06:08:38-0400</timestampReceived><subject>[libvirt-users] Sharing same storage on two diffrent KVM hosts</subject><body>

Hello ,

I whould like your suggestion regarding the following problem :

I got 2 host which are running under RHEL5.4 hypervizor . both of the hosts
disks is a logical volume .( Each for each ) under the same VG .

I want to add storage ( another logical volume )  which will be availble for
both of the host as local disk . ( Share storage )



Thanks .

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;&lt;div&gt;Hello , &lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt;I whould like your suggestion regarding the following problem :&lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt;I got 2 host which are running under RHEL5.4 hypervizor . both of the hosts \
disks is a logical volume .( Each for each ) under the same VG .&lt;/div&gt; &lt;div&gt; &lt;/div&gt;
&lt;div&gt;I want to add storage ( another logical volume )  which will be availble for \
both of the host as local disk . ( Share storage ) &lt;/div&gt; &lt;div&gt; &lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt; &lt;/div&gt;
&lt;div&gt;Thanks .&lt;/div&gt;
&lt;div&gt; &lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20100517140100</emailId><senderName>Ralf Hornik Mailings</senderName><senderEmail>ralf@best.homeunix.org</senderEmail><timestampReceived>2010-05-17 14:01:00-0400</timestampReceived><subject>[libvirt-users] virsh domxml-from-native not working</subject><body>

Dear list,

when I try to convert the (working) command

/usr/bin/qemu-system-x86_64 \
      -drive file=/dev/xen_vol/xen_ca,cache=none,if=virtio,boot=on \
      -net nic,model=virtio,macaddr=00:16:3E:04:F5:6D \
      -net tap,ifname=tap1 -m 256 -name ca \
      -vnc 10.0.0.100:4 -daemonize -k de

into an xml file:

&lt;domain type='qemu'&gt;
   &lt;name&gt;ca&lt;/name&gt;
   &lt;uuid&gt;dfef3884-d7a9-f6cf-5204-1615963cc0e8&lt;/uuid&gt;
   &lt;memory&gt;262144&lt;/memory&gt;
   &lt;currentMemory&gt;262144&lt;/currentMemory&gt;
   &lt;vcpu&gt;1&lt;/vcpu&gt;
   &lt;os&gt;
     &lt;type arch='x86_64'&gt;hvm&lt;/type&gt;
   &lt;/os&gt;
   &lt;features&gt;
     &lt;acpi/&gt;
   &lt;/features&gt;
   &lt;clock offset='utc'/&gt;
   &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
   &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
   &lt;on_crash&gt;destroy&lt;/on_crash&gt;
   &lt;devices&gt;
     &lt;emulator&gt;/usr/bin/qemu-system-x86_64&lt;/emulator&gt;
     &lt;disk type='block' device='disk'&gt;
       &lt;driver cache='none'/&gt;
       &lt;source dev='/dev/xen_vol/xen_ca'/&gt;
       &lt;target dev='vda' bus='virtio'/&gt;
     &lt;/disk&gt;
     &lt;interface type='ethernet'&gt;
       &lt;mac address='00:16:3e:04:f5:6d'/&gt;
       &lt;target dev='tap1'/&gt;
       &lt;model type='virtio'/&gt;
     &lt;/interface&gt;
     &lt;input type='mouse' bus='ps2'/&gt;
     &lt;graphics type='vnc' port='5904' autoport='no' listen='10.0.0.100'/&gt;
     &lt;video&gt;
       &lt;model type='cirrus' vram='9216' heads='1'/&gt;
     &lt;/video&gt;
   &lt;/devices&gt;
&lt;/domain&gt;

Then it stops to boot while haning on "Loading Grub Stage 2".
Additionally, the keyboard encoding "de" is missing.

The corresponding process is:

/usr/bin/qemu-system-x86_64 -S -M pc-0.12 -no-kvm -m 256 \
   -smp 1,sockets=1,cores=1,threads=1 \
   -name ca -uuid dfef3884-d7a9-f6cf-5204-1615963cc0e8 \
   -nodefaults \
   -chardev  
socket,id=monitor,path=/usr/local/libvirt/var/lib/libvirt/qemu/ca.monitor,server,nowait  
\
   -mon chardev=monitor,mode=readline -rtc base=utc -boot c \
   -drive  
file=/dev/xen_vol/xen_ca,if=none,id=drive-virtio-disk0,boot=on,cache=none  
\
   -device  
virtio-blk-pci,bus=pci.0,addr=0x4,drive=drive-virtio-disk0,id=virtio-disk0  
\
   -device  
virtio-net-pci,vlan=0,id=net0,mac=00:16:3e:04:f5:6d,bus=pci.0,addr=0x5 \
   -net tap,ifname=tap1,vlan=0,name=hostnet0 -usb -vnc 10.0.0.100:4 \
   -vga cirrus -device virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x3

Any Ideas, hats going wrong?
Thank yout and best regards

Ralf Hornik

</body></email><email><emailId>20100518144318</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-05-18 14:43:18-0400</timestampReceived><subject>Re: [libvirt-users] learn XML &lt;network/&gt;</subject><body>

On 05/18/2010 10:17 AM, David Ehle wrote:
&gt; 
&gt; Thanks for posting this... Its embarassing, but I had gone to the "XML 
&gt; format" link before and went away grumbling because it was blank... 
&gt; somehow not seeing all the sub catagories with the detailed information!
&gt; 

Not your fault, the web UI is confusing in that respect. Been meaning to
write a patch to fix that.

- Cole

&gt; Very useful!
&gt; 
&gt; On Tue, 18 May 2010, Cole Robinson wrote:
&gt; 
&gt;&gt; On 05/18/2010 05:37 AM, Michael Lblich wrote:
&gt;&gt;&gt; Can please anybody write a XML-description for the diagram shown on
&gt;&gt;&gt; http://libvirt.org/archnetwork.html
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt; The network XML format is documented at:
&gt;&gt;
&gt;&gt; http://libvirt.org/formatnetwork.html
&gt;&gt;
&gt;&gt; - Cole
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; libvirt-users mailing list
&gt;&gt; libvirt-users@redhat.com
&gt;&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;&gt;

</body></email><email><emailId>20100518153227</emailId><senderName>Arthur Pemberton</senderName><senderEmail>pemboa@gmail.com</senderEmail><timestampReceived>2010-05-18 15:32:27-0400</timestampReceived><subject>[libvirt-users] Can't get audio device through virt-manager</subject><body>

virt-manager is not asking qemu to produce any sound device based on
the kvm-qemu I see with 'ps aux'

https://bugzilla.redhat.com/show_bug.cgi?id=592671

-- 
Fedora 11
(www.pembo13.com)

</body></email><email><emailId>20100519125715</emailId><senderName>Ralf Hornik Mailings</senderName><senderEmail>ralf@best.homeunix.org</senderEmail><timestampReceived>2010-05-19 12:57:15-0400</timestampReceived><subject>Re: [libvirt-users] ctrl+alt+2 disabled?</subject><body>

"Daniel P. Berrange" &lt;berrange@redhat.com&gt; wrote:

&gt; libvirt provides APIs for invoking monitor commands,
&gt; including support for PCI devices. virt-manager has
&gt; UI for doing this, but if you want todo it the hard
&gt; way with virsh that's possible too. Either add the
&gt; device config in the initial XML, or attach it to a
&gt; live guest using 'virsh attach-device'. The XML
&gt; format is illustrated here:

Unfortunately, that doesn't work for me, since libvirt trys to reset  
the pci bus first which is not supported by my mainboard. So assigning  
PCI devices using virsh will never work...



</body></email><email><emailId>20100521111820</emailId><senderName></senderName><senderEmail>socketpair@gmail.com</senderEmail><timestampReceived>2010-05-21 11:18:20-0400</timestampReceived><subject>Re: [libvirt-users] Update of libvirt website required. not all information about XML tags</subject><body>

2010/5/21 Jiri Denemark &lt;jdenemar@redhat.com&gt;:
&gt;&gt; &gt;&gt;&gt; The problem desribed here: https://bugzilla.redhat.com/show_bug.cgi?id=593266
&gt;&gt; &gt;&gt;&gt;
&gt;&gt; &gt;&gt;&gt; Please update http://www.libvirt.org/formatdomain.html and describe
&gt;&gt; &gt;&gt;&gt; NEW xml tags, like &lt;serial&gt;xxxx&lt;/serial&gt; for hard drive and all cpu
&gt;&gt; &gt;&gt;&gt; tags, other if any.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; What cpu tag are you missing from the documentation? The description at
&gt;&gt; &gt;&gt; http://www.libvirt.org/formatdomain.html#elementsCPU is complete and
&gt;&gt; &gt;&gt; up-to-date.
&gt;&gt; &gt; http://berrange.com/posts/2010/02/15/guest-cpu-model-configuration-in-libvirt-with-qemukvm/
&gt;&gt; &gt;&gt;
&gt;&gt; anybody home ?
&gt;
&gt; Hmm, what would you like to hear? You haven't answered my question about what
&gt; part of cpu tag is not described in libvirt documentation. Please, be more
&gt; specific in what you miss in XML format description for the cpu tag.
&gt;
&gt; To the best of my knowledge, semantics of all subelements/attributes and their
&gt; combinations is explained there. The URL you pasted as a reply is a
&gt; step-by-step guide for using the cpu selection feature, which is not something
&gt; that should be included in a description of domain XML format.
Why not?
I think, that all possible XML tags should be specified in documentation...
I mean this: It should be full documentation of XML structure of
config file where I may look for reference.
Now documentation on libvirt site is not complete.
I don't know where to read complete manual about XML tags, used in libvirt.

&gt;
&gt; I'm not talking about hard drive configuration since I'm not familiar with all
&gt; the aspects of it. Someone else would need to complete the documentation there
&gt; if it's incomplete.
Ok. I understand. Will wait for somebody who able to change HDD XML
documentation.

</body></email><email><emailId>20100522020216</emailId><senderName>Kenni Lund</senderName><senderEmail>kenni@kelu.dk</senderEmail><timestampReceived>2010-05-22 02:02:16-0400</timestampReceived><subject>[libvirt-users] NAT-based network 2x-4x faster than routed network?</subject><body>

Hi

Is it expected behaviour that a libvirt NAT-based network is faster
than a libvirt routed network?

I would guess that the routed network would be the fastest one in all
cases, but I'm seeing the opposite in my setup. On a 100mbit internet
connection, the routed network tops at 4mbyte/sec, while the nat-based
network goes all the way to 10mbyte/sec. I've spend the last 6 hours
on trying to figure out the cause of this, changing settings,
reinstalling the system, but the problem persists and I can't find the
cause of it.

It is a clean and fairly simple setup:
- Clean installation of CentOS 5.5
- Installation of kvm+libvirt+virt-manager+xorg
- iptables service disabled
- 1 public IP for the host (xxx.yyy.zzz.215) on a /32 subnet with
xxx.yyy.zzz.193 as gateway
- 3 public IP for the routed network (xxx.yyy.zzz.251-253) on a /26
subnet with the same gateway as the host
- 1 virtual machine with either the NAT or the routed libvirt network assigned

I have no networking connection errors or similar, it works perfectly
with both the NAT and the routed network, but the routed network is
just 2-4 times slower than the NAT one.

Do you have any suggestions of what the problem might be? When I look
at the iptables rules generated by libvirt, and the routing table,
everything looks fine AFAICT. Traceroute from guest doesn't reveal
anything either. Ping times from the two networks are similar, so the
main issue seems to be throughput.

Any help or pointers to what I should look at, is highly appreciated... :)

I've copy pasted some of my relevant system configuration into pastebin:
http://pastebin.com/jtTrHLqA

Thank you,
Kenni

</body></email><email><emailId>20100524132512</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-05-24 13:25:12-0400</timestampReceived><subject>Re: [libvirt-users] Better error codes when stopping a VM that is already stopped</subject><body>

On Mon, May 24, 2010 at 09:07:24AM -0400, Brian K. White wrote:
&gt; On 5/24/2010 6:24 AM, Daniel P. Berrange wrote:
&gt; &gt;On Fri, May 21, 2010 at 02:11:47PM +0200, Guido Winkelmann wrote:
&gt; &gt;   
&gt; &gt;&gt;Hi,
&gt; &gt;&gt;
&gt; &gt;&gt;Sometimes when stopping a virtual domain using virDomainDestroy(), I come
&gt; &gt;&gt;across a domain that is already stopped. (For example when someone already
&gt; &gt;&gt;stopped the domain manually using virsh or because the guest OS issued a
&gt; &gt;&gt;shutdown.) This is a special case that I absolutely need to catch and 
&gt; &gt;&gt;handle.
&gt; &gt;&gt;
&gt; &gt;&gt;Unfortunately, when this happens, and I call virGetLastError() 
&gt; &gt;&gt;afterwards, I
&gt; &gt;&gt;always just get the error code VIR_ERR_OPERATION_INVALID, which doesn't 
&gt; &gt;&gt;look
&gt; &gt;&gt;very precise to me...
&gt; &gt;&gt;
&gt; &gt;&gt;Two questions about this:
&gt; &gt;&gt;
&gt; &gt;&gt;Is the domain not running at that moment the only possible condition that 
&gt; &gt;&gt;can
&gt; &gt;&gt;trigger this particular error code when calling virDomainDestroy()?
&gt; &gt;&gt;     
&gt; &gt;The VIR_ERR_OPERATION_INVALID is a precise code that says the request
&gt; &gt;operation is not valid wrt the current state of the guest. So for the
&gt; &gt;virDomainDestroy() method, the only cause of this message is requesting
&gt; &gt;destroy of a guest that is not running.
&gt; &gt;   
&gt; 
&gt; You are saying there is, and can only ever be, one possible way that the 
&gt; operation could ever be considered invalid?

You are debating the semantics of the word 'invalid'. The error code 
VIR_ERR_OPERATION_INVALID is associated with just one specific sceanario,
regardless of how many different semantics you can attach to the word.

&gt; Even within the limited scope of virDomainDestroy() and the particular 
&gt; values it was called with, I find that hard to believe on general principle.

A guest VM has a set of lifecycle states (shutoff, running, paused).
An operation on a VM can optional have a pre-requisite lifecycle 
state that the VM must be in.

If that pre-requisite lifecycle state is not satisfied, the error
code VIR_ERR_OPERATION_INVALID is raised.  

This error code is not used for any other reason.

Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100525140048</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-05-25 14:00:48-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt] How to obtain rights to extend libvirt documentation pages</subject><body>

On 05/25/2010 03:07 AM,   wrote:
&gt; For example, http://libvirt.org/formatdomain.html#elementsDisks
&gt; does not contain &lt;serial&gt;xxxx&lt;/serial&gt; tag.
&gt; (https://bugzilla.redhat.com/show_bug.cgi?id=593266)
&gt; 
&gt; I wrote to community (users and developers). No one has added this
&gt; information to the site...
&gt; 

You can provide a patch against the website docs, which are stored with
the source code. The relevant file is docs/formatdomain.html.in. See:

http://wiki.libvirt.org/page/FAQ#Where_can_I_get_the_source_code.3F_How_do_I_compile_and_install.3F

</body></email><email><emailId>20100527143150</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-05-27 14:31:50-0400</timestampReceived><subject>Re: [libvirt-users] Hot-add interface crashes libvirt</subject><body>

On 05/26/2010 06:33 PM, steven765@yahoo.com wrote:
&gt; Hi Everyone,
&gt; After upgrading FC12 and now FC13 whenever I try to attach a network device using \
&gt; attach-device it promptly crashes libvirtd.  Is there an option that changed in the \
&gt; network interface xml spec I missed? I really need this feature or at least the \
&gt; ability to connect and disconnect interfaces if that's possible? 
&gt; I've tried defining my network card in several ways:
&gt; 
&gt; First the one that worked previously:
&gt; 
&gt; &lt;interface type="network"&gt;
&gt; &lt;mac address="52:54:00:5c:fe:a8"/&gt;
&gt; &lt;source network="fedora"/&gt;
&gt; &lt;/interface&gt; 
&gt; 

This should work with virsh attach-device $VMNAME $XMLFILE. I can't seem
to reproduce this issue on F12 though. Can you capture the libvirtd crash?

- debuginfo-install libvirt
- service libvirtd stop
- gdb libvirtd, at the prompt type 'run'
- In another terminal, reproduce the crash
- In gdb, type 'thread apply all bt'

Post that output here, along with all your libvirt and qemu versions,
and what steps you took to reproduce.


&gt; Second copying what appeared in the xml after using the add hardware through the \
&gt; VMM: 
&gt; 
&gt; &lt;interface type='network'&gt;
&gt; &lt;mac address='52:54:00:5c:fe:a8'/&gt;
&gt; &lt;source network='fedora'/&gt;
&gt; &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x06' function='0x0'/&gt;
&gt; &lt;/interface&gt; 
&gt; 

Manually specifying the &lt;address&gt; piece shouldn't be required, libvirt
will autogenerate it for you.

- Cole


</body></email><email><emailId>20100528180900</emailId><senderName>Andreas Ntaflos</senderName><senderEmail>daff@pseudoterminal.org</senderEmail><timestampReceived>2010-05-28 18:09:00-0400</timestampReceived><subject>[libvirt-users] Host should not touch passed-through USB device, how?</subject><body>


Hello list, 

this may be off topic but it is closely related to my Libvirt adventures 
so maybe you can help me.

I want to pass a USB device (a USB Huawei E620 modem) through to a KVM 
guest. Pass-through in general works fine and the modem is visible in 
the guest. However, the host still sees it and sometimes tries to access 
it (such modems seem to also be USB storage devices). This naturally 
leads to conflicts and I believe this crashed the guest very badly 
yesterday.

So I am looking for a way to make sure the host passes through the USB 
device (in its entirety) without trying to touch it and claim it as its 
own. Preferably without disabling the USB storage subsystem completely 
on the host.

Any ideas? Is there a best practice for such things in the Libvirt 
world? Or any other world? 

Thanks!

Andreas
-- 
Andreas Ntaflos 

GPG Fingerprint: 6234 2E8E 5C81 C6CB E5EC  7E65 397C E2A8 090C A9B4

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20100531075258</emailId><senderName>udo1</senderName><senderEmail>udo1@udo.hu</senderEmail><timestampReceived>2010-05-31 07:52:58-0400</timestampReceived><subject>Re: [libvirt-users] ballooning option xml</subject><body>

Hi Mattias,

Thanks, I will check if there any new package is available for Ubuntu 
Lucid, and if not I will open a problem ticket on Ubuntus Launchpad for it.
In a mean time I will use the wrapper, or I have written a control 
script to control kvm hosts.

Best Regards
Udo Attila Fischer





on 2010.05.30. 13:27, Matthias Bolte wrote:
&gt; 2010/5/30 udo1&lt;udo1@udo.hu&gt;:
&gt;    
&gt;&gt; Hi Matthias,
&gt;&gt;
&gt;&gt; In Ubuntu lucid using kvm, the balloning is disabled by default, so I would
&gt;&gt; need to enable it.
&gt;&gt;      
&gt; How do you detect that it's disabled by default, because I cannot
&gt; reproduce that here with Ubuntu 10.04.
&gt;
&gt; libvirt enables ballooning by default. Okay, it only does this when it
&gt; detects that your QEMU/KVM version supports it, but Ubuntu 10.04 has
&gt; QEMU 0.12.3 and that version has balloon support.
&gt;
&gt; If libvirt detects that your QEMU supports the -device flag then it adds
&gt;
&gt;    -device virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x3
&gt;
&gt; to the command line in order to enable ballooning. This what's added
&gt; to the command line for me here.
&gt;
&gt; If your QEMU doesn't supports the -device flag, but supports the
&gt; -balloon flag then
&gt;
&gt;    -balloon virtio
&gt;
&gt; is added to the command line in order to enable ballooning.
&gt;
&gt; If your QEMU doesn't support non of these flags that you don't get ballooning.
&gt;
&gt; You can check the used command line in
&gt; /var/log/libvirt/qemu/&lt;guest&gt;.log for qemu:///system connections or in
&gt; ~/.libvirt/log/qemu/&lt;guest&gt;.log for qemu:///session connections.
&gt;
&gt; ....
&gt;
&gt; At this point I realize that Ubuntu 10.04 comes with libvirt 0.7.5 and
&gt; now I understand your problem.
&gt;
&gt; A comment in the current QEMU driver code says (since libvirt 0.7.6,
&gt; git commit 7a90f216):
&gt;
&gt;      /* QEMU changed its default behavior to not include the virtio balloon
&gt;       * device.  Explicitly request it to ensure it will be present. */
&gt;
&gt; So, libvirt 0.7.5 still assumes that QEMU automatically adds the
&gt; virtio balloon device. The comment and commit message don't say in
&gt; which QEMU version this was changed, but I assume that QEMU 0.12.3 (as
&gt; in Ubuntu 10.04) doesn't enable ballooing by default anymore.
&gt;
&gt; So you're suffering from a version mismatch between your libvirt and
&gt; QEMU version: your libvirt is too old for your QEMU, or QEMU is too
&gt; new for libvirt.
&gt;
&gt; I couldn't reproduce your problem at first because I don't have the
&gt; Ubuntu libvirt packages installed, but compile bleeding-edge libvirt
&gt; from source.
&gt;
&gt;    
&gt;&gt; (I currently have written a wrapper named as kvm adding this kvm option but
&gt;&gt; this should not be the right way)
&gt;&gt;      
&gt; So you can fix this version mismatch with that script, or upgrade
&gt; libvirt to a version&gt;= 0.7.6. There is a PPA on Launchpad that offers
&gt; more up-to-date libvirt packages for Ubuntu.
&gt;
&gt;    https://launchpad.net/~dnjl/+archive/virtualization
&gt;
&gt; Matthias
&gt;
&gt;    
&gt;&gt; br
&gt;&gt; Udo Attila Fischer
&gt;&gt;
&gt;&gt;
&gt;&gt; on 2010.05.26. 14:21, Matthias Bolte wrote:
&gt;&gt;      
&gt;&gt;&gt; 2010/5/13 udo1&lt;udo1@udo.hu&gt;:
&gt;&gt;&gt;
&gt;&gt;&gt;        
&gt;&gt;&gt;&gt; Hi everybody,
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; I need the ballooning option with kvm using libvirt xml file and virsh
&gt;&gt;&gt;&gt; (virsh create domain.xml)
&gt;&gt;&gt;&gt; kvm line must be appended with the -balloon virtio switch to enable
&gt;&gt;&gt;&gt; ballooning. (can be disabled if there no option or with -balloon none )
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; I currently using Ubuntu Lucid
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; How can I define this in the domain xml file, or what need I to do to get
&gt;&gt;&gt;&gt; this option?
&gt;&gt;&gt;&gt; is there any option like
&gt;&gt;&gt;&gt; enabling with
&gt;&gt;&gt;&gt; &lt;balloon&gt;virtio&lt;/balloon&gt;
&gt;&gt;&gt;&gt; or
&gt;&gt;&gt;&gt; disabling with
&gt;&gt;&gt;&gt; &lt;balloon&gt;none&lt;/balloon&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Thanks in Advance
&gt;&gt;&gt;&gt; Udo Attila Fischer
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;          
&gt;&gt;&gt; Ballooning is enabled by default and cannot be disabled via the domain
&gt;&gt;&gt; XML.
&gt;&gt;&gt;
&gt;&gt;&gt; Do you have any specific problem that makes you think there is a
&gt;&gt;&gt; problem with ballooning?
&gt;&gt;&gt;
&gt;&gt;&gt; Matthias
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;        
&gt;&gt;
&gt;&gt;      
&gt;    

</body></email><email><emailId>20100531080115</emailId><senderName>udo1</senderName><senderEmail>udo1@udo.hu</senderEmail><timestampReceived>2010-05-31 08:01:15-0400</timestampReceived><subject>[libvirt-users] virsh reset option</subject><body>

Hi everybody,

I have one more question but virsh related:
Is there a reset equivalent option in virsh, like system_reset in QEMU 
monitor? In the help list I do not see it.

Best Regards,
Udo Attila Fischer

</body></email><email><emailId>20100531131657</emailId><senderName>Guido Winkelmann</senderName><senderEmail>guido-libvi@unknownsite.de</senderEmail><timestampReceived>2010-05-31 13:16:57-0400</timestampReceived><subject>Re: [libvirt-users] Cannot create qcow2 images with libvirt 0.8.1</subject><body>

Am Freitag, 28. Mai 2010 schrieb Cole Robinson:
&gt; On 05/28/2010 11:10 AM, Guido Winkelmann wrote:
&gt; &gt; Hi,
&gt; &gt;
&gt; &gt; After upgrading to libvirt 0.8.1, I can no longer create empty volumes
&gt; &gt; with no backing store and an explicit format of qcow2.
&gt; &gt;
&gt; &gt; This XML volume definition:
&gt; &gt;
&gt; &gt; &lt;volume&gt;
&gt; &gt;   &lt;name&gt;testserverb-data2.img&lt;/name&gt;
&gt; &gt;   &lt;allocation&gt;0&lt;/allocation&gt;
&gt; &gt;   &lt;capacity units='G'&gt;20&lt;/capacity&gt;
&gt; 
&gt; This should be 'unit', not 'units'. Libvirt is probably seeing that as
&gt; 20 bytes, rounding down to 0K, and qemu-img isn't happy.

That solved it, thanks!

	Guido

</body></email><email><emailId>20100531135451</emailId><senderName>Justin Clift</senderName><senderEmail>justin@salasaga.org</senderEmail><timestampReceived>2010-05-31 13:54:51-0400</timestampReceived><subject>[libvirt-users] Mount options for fs type storage pools?</subject><body>

Hi all,

Presently writing up "Storage Pool" docs for the Fedora Virtualisation 
Guide.  (using both virsh and virt-manager)

Having trouble finding out how to specify mount options for fs type 
storage pools.

For example:

   # virsh pool-define-as guest_images_fs fs - - /dev/sdc1 - "/guest_images"
   Pool guest_images_fs defined

   # virsh pool-build guest_images_fs
   Pool guest_images_fs built

   # virsh pool-start guest_images_fs
   Pool guest_images_fs started

   # mount | grep guest_images
   /dev/sdc1 on /guest_images type ext4 (rw)
   #

Notice that /guest_images is mounted with default options.  Nothing 
wrong with that, but lets say the SysAdmin has a need to pass specific 
mount options.  (ie journal_checksum, or noatime, or nodiratime, etc)

Checked the virStorageBackendFileSystemMount() function in present git 
master, and it doesn't look like mount options are considered for 
anything other than Gluster?

How to do it, or is it best to not use libvirt to manage the mounting of 
this type of storage when options are needed?

Regards and best wishes,

Justin Clift

-- 
Salasaga  -  Open Source eLearning IDE
               http://www.salasaga.org

</body></email><email><emailId>20100531140019</emailId><senderName>Guido Winkelmann</senderName><senderEmail>guido-libvi@unknownsite.de</senderEmail><timestampReceived>2010-05-31 14:00:19-0400</timestampReceived><subject>[libvirt-users] VM parameters best practice?</subject><body>

Hi,

When creating many virtual machines from a template (disk image), you often 
need to set some different parameters for each vm. Those usually include root 
passwords and/or ssh public keys for login, ssh Host keys (so that a) not all 
the VMs have the same host key and b) the user can know the real host key for 
his vm before connecting for the first time) plus any number of user-defined 
parameters.

IP addresses and hostnames can be set via DHCP.

Obviously, some of those parameters need to be treated as confidential, so you 
cannot just grab them from some FTP server somewhere. In fact, as long as you 
haven't set any authentication credentials (like an SSL Client Certificate for 
example) that the vm can use to uniquely and securely identify itself to some 
server, you cannot securely get any of these parameters over the network.

How do people usually solve that sort of problem? What is considered best 
practice here?

Currently, my own plans are to write these parameters to a floppy image, use 
Unix file permissions to make sure nobody else can read the image, and then 
hook up that image to a virtual floppy drive in the respective vm. A shell 
script in the vm template can then read and apply all those parameter at some 
early stage during the very first boot.

Unfortunately, this means mounting the image in the host system, writing the 
parameters and then unmounting it again - which seems sort of error prone to 
me in a fully automated environment. (What if two vms are being created 
simultaneously? What if the script crashes or hangs somewhere between mounting 
and unmounting the image?)

Regards

	Guido Winkelmann

</body></email><email><emailId>20100531141649</emailId><senderName>Karsten Knese</senderName><senderEmail>karsten.knese@googlemail.com</senderEmail><timestampReceived>2010-05-31 14:16:49-0400</timestampReceived><subject>[libvirt-users] Monitoring KVM Machine Uptimes</subject><body>

Hey folks.

Currently, I am working on an accounting-solution for Private Cloud with 
Eucalyptus as my bachelor-thesis. Eucalyptus bases on libvirt providing 
the KVM machines. Part of the thesis is kind of measurement for the 
uptimes of each instance in the cloud.

As Eucalyptus is based on libvirt, i want to know if there is kind of 
tool already setup for monitoring a vm in terms of uptimes, cputimes and 
disk i/o.
If not, can anyone give me a hint, how i could grep these facts?

I found a tool called "virt-top" which monitors the vm, but for me there 
is to much overhead.

Thanks for you support.
cheers,
Karsten


</body></email><email><emailId>20100531142259</emailId><senderName>Karsten Knese</senderName><senderEmail>karsten.knese@kit.edu</senderEmail><timestampReceived>2010-05-31 14:22:59-0400</timestampReceived><subject>[libvirt-users] monitoring kvm machines with libvirt</subject><body>

Hey folks.

Currently, i am working on my bachelorthesis. Subject of this thesis is 
to setup an accounting-solution for the Private Cloud with Eucalyptus. 
Eucalyptus works with libvirt providing kvm instances.

my question is, if i can grep facts like general uptimes, cpu-peaks and 
disk i/o of each vm with libvirt-tools?!
I just found one called virt-top, which monitors each vm, but 
unfortunately it produces to much overhead.
If you should be no tool, can anybody give me a hint, where i best look 
at to grep these facts?

First try is to grep the uptime of each vm by writing a little deamon, 
checking one time per minute via virsh, if the vm is in state running. 
But i don't know, if this is best.

thanks for your support!
cheers,
Karsten

</body></email><email><emailId>20100531155204</emailId><senderName>Guido Winkelmann</senderName><senderEmail>guido-libvi@unknownsite.de</senderEmail><timestampReceived>2010-05-31 15:52:04-0400</timestampReceived><subject>[libvirt-users] Qemu driver not supporting VIR_DOMAIN_DEVICE_MODIFY_CONFIG yet?</subject><body>

Hi,

According to the docs on
http://libvirt.org/html/libvirt-libvirt.html#virDomainDetachDeviceFlags
I ought to be able to do

virDomainDetachDeviceFlags(
	&lt;domain&gt;,
	&lt;devicexml&gt;,
	VIR_DOMAIN_DEVICE_MODIFY_LIVE | VIR_DOMAIN_DEVICE_MODIFY_CONFIG);

to detach a volume both from a currently running VM instance and permanently 
from the defined config file.

If I actually try that, though, I'm getting this error:

libvir: QEMU error : Requested operation is not valid: cannot modify the 
persistent configuration of a domain

The same thing happens whether or not the domain is running and also happens 
if I leave out the "VIR_DOMAIN_DEVICE_MODIFY_LIVE" part.

Does the qemu driver simply not support VIR_DOMAIN_DEVICE_MODIFY_CONFIG yet 
(libvirt 0.8.1), or is there some other problem here?

	Guido

</body></email><email><emailId>20100531165051</emailId><senderName>Rafael Braga</senderName><senderEmail>rafaeltelematica@gmail.com</senderEmail><timestampReceived>2010-05-31 16:50:51-0400</timestampReceived><subject>Re: [libvirt-users] Update Libvirt</subject><body>

ok Guido, thanks!

On Mon, May 31, 2010 at 12:35 PM, Guido Winkelmann &lt;
guido-libvi@unknownsite.de&gt; wrote:

&gt; Am Freitag, 28. Mai 2010 schrieb Rafael Braga:
&gt; &gt; Hi,
&gt; &gt;
&gt; &gt; I installed the opensuse 11.0 and libvirt version installed is 0.4.
&gt; &gt; But, Nimbus need the version 0.6.3. How do I upgrade? I can't by YAST...
&gt;
&gt; A quick Google search revealed that the newest OpenSUSE (11.2) ships with
&gt; libvirt 0.7.2. Try upgrading to OpenSUSE 11.2.
&gt;
&gt; If that is not an option, try to find alternative repositories for 11.0
&gt; that
&gt; carry a newer libvirt or uninstall libvirt in yast and install the most
&gt; recent
&gt; version from source.
&gt;
&gt;        Guido
&gt;



-- 
Rafael Braga

[Attachment #3 (text/html)]

ok Guido, thanks!&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Mon, May 31, 2010 at 12:35 PM, \
Guido Winkelmann &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:guido-libvi@unknownsite.de"&gt;guido-libvi@unknownsite.de&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="border-left: 1px solid rgb(204, 204, \
204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;"&gt;

Am Freitag, 28. Mai 2010 schrieb Rafael Braga:&lt;br&gt;
&lt;div class="im"&gt;&gt; Hi,&lt;br&gt;
&gt;&lt;br&gt;
&gt; I installed the opensuse 11.0 and libvirt version installed is 0.4.&lt;br&gt;
&gt; But, Nimbus need the version 0.6.3. How do I upgrade? I can't by YAST...&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;A quick Google search revealed that the newest OpenSUSE (11.2) ships with&lt;br&gt;
libvirt 0.7.2. Try upgrading to OpenSUSE 11.2.&lt;br&gt;
&lt;br&gt;
If that is not an option, try to find alternative repositories for 11.0 that&lt;br&gt;
carry a newer libvirt or uninstall libvirt in yast and install the most recent&lt;br&gt;
version from source.&lt;br&gt;
&lt;font color="#888888"&gt;&lt;br&gt;
        Guido&lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br clear="all"&gt;&lt;br&gt;-- &lt;br&gt;Rafael Braga&lt;br&gt;



</body></email><email><emailId>20100531172623</emailId><senderName>Justin Clift</senderName><senderEmail>justin@salasaga.org</senderEmail><timestampReceived>2010-05-31 17:26:23-0400</timestampReceived><subject>[libvirt-users] Working example of logical storage pool and volume creation?</subject><body>

Hi all,

Does anyone have a working example of creation of a logical storage pool 
and volume?

I'm hitting a wall getting logical volumes to work on RHEL 6 beta.

There's a single drive I'm trying to setup (sdc) as a libvirt managed 
logical storage pool, but all volume creation on it fails.

Here's what I'm finding so far:

   Prior to any storage pool work, only the host boot drive (sda) is in lvm.

   # vgs
     VG       #PV #LV #SN Attr   VSize   VFree
     vg_host2   1   3   0 wz--n- 465.27g    0
   # pvs
     PV         VG       Fmt  Attr PSize   PFree
     /dev/sda2  vg_host2 lvm2 a-   465.27g    0
   # ls -la /dev/mapper
   total 0
   drwxr-xr-x.  2 root root    120 Jun  1 03:12 .
   drwxrwxrwt. 21 root root   3920 Jun  1 03:12 ..
   crw-rw----.  1 root root 10, 58 May 31 14:08 control
   lrwxrwxrwx.  1 root root      7 May 31 14:10 vg_host2-lv_home -&gt; ../dm-7
   lrwxrwxrwx.  1 root root      7 May 31 14:08 vg_host2-lv_root -&gt; ../dm-0
   lrwxrwxrwx.  1 root root      7 May 31 14:10 vg_host2-lv_swap -&gt; ../dm-8
   #


   Creation of a logical storage pool, using sdc:

   # virsh pool-define-as guest_images_lvm logical - - /dev/sdc 
libvirt_lvm /dev/mapper
   Pool guest_images_lvm defined

   # virsh pool-info guest_images_lvm
   Name:           guest_images_lvm
   UUID:           17398035-8000-7252-ab25-58db95aed130
   State:          inactive

   # virsh pool-build guest_images_lvm
   Pool guest_images_lvm built

   #


   The physical device and volume group are seen in lvm:

   # pvs
     PV         VG          Fmt  Attr PSize   PFree
     /dev/sda2  vg_host2    lvm2 a-   465.27g      0
     /dev/sdc   libvirt_lvm lvm2 a-   465.76g 465.76g
   # vgs
     VG          #PV #LV #SN Attr   VSize   VFree
     libvirt_lvm   1   0   0 wz--n- 465.76g 465.76g
     vg_host2      1   3   0 wz--n- 465.27g      0
   #


   Starting the logical pool works:

   # virsh pool-start guest_images_lvm
   Pool guest_images_lvm started

   #


   Creation of volumes fail:

   # virsh vol-create-as guest_images_lvm volume1 8G
   error: Failed to create vol volume1
   error: internal error '/sbin/lvcreate --name volume1 -L 8388608K 
/dev/mapper' exited with non-zero status 3 and signal 0:   Volume group 
name expected (no slash)
   Run `lvcreate --help' for more information.

   #

So, it looked like "/dev/mapper" in the pool-define-as command should 
have instead been the LVM volume group again.  That doesn't work either 
though:

   # virsh pool-define-as guest_images_lvm logical - - /dev/sdc 
libvirt_lvm libvirt_lvm
   Pool guest_images_lvm defined

   # virsh pool-build guest_images_lvm
   Pool guest_images_lvm built

   # virsh pool-start guest_images_lvm
   Pool guest_images_lvm started

   # virsh vol-create-as guest_images_lvm volume1 8G
   error: Failed to create vol volume1
   error: cannot read path 'libvirt_lvm/volume1': No such file or directory

Looking in the libvirtd logs for this last attempt, the volume was 
actually successfully created.  But libvirtd then checks for it's 
presence (wrongly!), doesn't find it, and then lvremove's it:

   03:01:24.000: debug : virRunWithHook:832 : /sbin/lvcreate --name 
volume1 -L 8388608K libvirt_lvm
   ...
   03:01:24.223: debug : virRunWithHook:848 : Command stdout:   Logical 
volume "volume1" created
   ...
   03:01:24.223: error : virStorageBackendLogicalCreateVol:616 : cannot 
read path 'libvirt_lvm/volume1': No such file or directory
   ...
   03:01:24.223: debug : virRunWithHook:832 : /sbin/lvremove -f 
libvirt_lvm/volume1


Guessing I'm either doing something wrong, or hitting bugs, or ?

Anyone have ideas/suggestions/etc?

Regards and best wishes,

Justin Clift

-- 
Salasaga  -  Open Source eLearning IDE
               http://www.salasaga.org

</body></email><email><emailId>20100411110114</emailId><senderName>Ganesh Pagade</senderName><senderEmail>ganesh.pagade@gmail.com</senderEmail><timestampReceived>2010-04-11 11:01:14-0400</timestampReceived><subject>[libvirt-users] libvirt: C++ or Java?</subject><body>

Hello,

I am planning to develop a management application for managing Redhat Xen
and Redhat KVM hypervisors. I am evaluating the Java bindings versus the C++
version of libvirt. As part of evaluation, I could not find meaningful
answers to the questions below. Hence, I thought that people on this mailing
list would be the most appropriate to comment on them. Can you please let me
know your views?

1. Are all functions that are available in C API available in Java?
2. Are Java bindings added along with every enhancement to C API?
3. If answer to above question is negative, typically how long does it takes
for the addition of Java bindings for the enhancement?
4. Most of libvirt based third party management applications use which of
Java bindings or C API?
5. What are your good/bad experiences while using either of C API or Java
bindings?
6. What is your concluding personal recommendation?

And finally, since libvirt is a Redhat Emerging Technology project, does
Redhat or any other third party service providers provide paid assistance,
support?

Appreciate your time. Thanks.

Regards,
Ganesh

[Attachment #3 (text/html)]

&lt;font size="2"&gt;&lt;font face="verdana,sans-serif"&gt;Hello,&lt;br&gt;&lt;br&gt;I am planning to develop \
a management application for managing Redhat Xen and Redhat KVM hypervisors. I am \
evaluating the Java bindings versus the C++ version of libvirt. As part of \
evaluation, I could not find meaningful answers to the questions below. Hence, I \
thought that people on this mailing list would be the most appropriate to comment on \
them. Can you please let me know your views?&lt;br&gt;

&lt;br&gt;1. Are all functions that are available in C API available in Java?&lt;br&gt;2. Are \
Java bindings added along with every enhancement to C API?&lt;br&gt;3. If answer to above \
question is negative, typically how long does it takes for the addition of Java \
bindings for the enhancement?&lt;br&gt;

4. Most of libvirt based third party management applications use which of Java \
bindings or C API?&lt;br&gt;5. What are your good/bad experiences while using either of C \
API or Java bindings?&lt;br&gt;6. What is your concluding personal recommendation?&lt;br&gt;

&lt;br&gt;And finally, since libvirt is a Redhat Emerging Technology project, does Redhat \
or any other third party service providers provide paid assistance, \
support?&lt;br&gt;&lt;br&gt;Appreciate your time. Thanks.&lt;br&gt;&lt;br \
clear="all"&gt;&lt;/font&gt;&lt;/font&gt;Regards,&lt;br&gt;

Ganesh&lt;br&gt;



</body></email><email><emailId>20100410062938</emailId><senderName>Valerio Felici</senderName><senderEmail>valerio@bgweb.it</senderEmail><timestampReceived>2010-04-10 06:29:38-0400</timestampReceived><subject>[libvirt-users] from vmdk to kvm</subject><body>

Hi, I will try to explain my case, I hope this is rigth place to do it.

My goal is migrate an Ubuntu 9.10 64bit VMWare VM from a Win2k8 64bit 
server to an Ubuntu 9.10 64bit server.

Following some tutorials I've got a .qcow2 file from .vmdk and a .xml 
file from .vmx file

Running virsh define/start all was fine, but VM is unaccessible: no 
ping, no ssh, also from hosting server.


This is content of .xml file

&lt;domain type='kvm'&gt;
   &lt;name&gt;Ubuntu9.04-Zimbra&lt;/name&gt;
   &lt;uuid&gt;7f86897d-5eac-47d6-970d-c2639d58c340&lt;/uuid&gt;
   &lt;memory&gt;2621440&lt;/memory&gt;
   &lt;currentMemory&gt;2621440&lt;/currentMemory&gt;
   &lt;vcpu&gt;1&lt;/vcpu&gt;
   &lt;os&gt;
     &lt;type arch='x86_64' machine='pc-0.11'&gt;hvm&lt;/type&gt;
     &lt;boot dev='hd'/&gt;
   &lt;/os&gt;
   &lt;features&gt;
     &lt;acpi/&gt;
   &lt;/features&gt;
   &lt;clock offset='utc'/&gt;
   &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
   &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
   &lt;on_crash&gt;destroy&lt;/on_crash&gt;
   &lt;devices&gt;
     &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;
     &lt;disk type='file' device='disk'&gt;
       &lt;source file='/opt/Plone/Ubuntu9.04-Zimbra.qcow2'/&gt;
       &lt;target dev='hda' bus='ide'/&gt;
     &lt;/disk&gt;
     &lt;interface type='bridge'&gt;
       &lt;mac address='00:0c:29:82:5c:36'/&gt;
       &lt;source bridge='br0'/&gt;
       &lt;model type='virtio'/&gt;
     &lt;/interface&gt;
     &lt;interface type='bridge'&gt;
       &lt;mac address='00:0c:29:82:5c:40'/&gt;
       &lt;source bridge='br0'/&gt;
       &lt;model type='virtio'/&gt;
     &lt;/interface&gt;
     &lt;input type='mouse' bus='ps2'/&gt;
     &lt;graphics type='vnc' port='-1' autoport='yes' listen='127.0.0.1'/&gt;
     &lt;video&gt;
       &lt;model type='cirrus' vram='9216' heads='1'/&gt;
     &lt;/video&gt;
   &lt;/devices&gt;
&lt;/domain&gt;


Starting VM, corrisponding on two interfaces declared, vnet1 e vnet2 are 
showed in ifconfig (vnet0 is for another VM) but "brctl showmacs br0" 
don't show their MACs

What I wrong?
Thanks for your attention, sorry if I missing to post some useful data, 
please tell me, what you need.

-- 
A  presto
-Valerio-

</body></email><email><emailId>20100412125242</emailId><senderName>marwen marwen</senderName><senderEmail>marwen.ensi@gmail.com</senderEmail><timestampReceived>2010-04-12 12:52:42-0400</timestampReceived><subject>[libvirt-users] Libvirtd</subject><body>

hello,
I'm using libvirt for my project but i have some problem when we
install it (libvirt)
can you give me a manual for installation of libvirt and configuration
of libvirtd
think you so much

</body></email><email><emailId>20100417022025</emailId><senderName>Andreas Ntaflos</senderName><senderEmail>daff@pseudoterminal.org</senderEmail><timestampReceived>2010-04-17 02:20:25-0400</timestampReceived><subject>[libvirt-users] Default network needed?</subject><body>


Hi list, 

long(ish) time libvirt users, first time poster.

Question: Is the default network (192.168.122.0/24, NAT) created by 
libvirt needed at all when guests are connected to the host's bridge 
device (and not the default network)

I.e. when I have

&lt;interface type='bridge'&gt;
  &lt;source bridge='br0'/&gt;
  &lt;model type='virtio'/&gt;
&lt;/interface&gt;

in my guest definition is the default network ever even used? Or can I 
safely remove it?

This may be a naive or stupid question but I have not found a definitive 
answer studying the documentation. Can anybody enlighten me?

Thanks, 

Andreas
-- 
Andreas Ntaflos 

GPG Fingerprint: 6234 2E8E 5C81 C6CB E5EC  7E65 397C E2A8 090C A9B4

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20100415192346</emailId><senderName>Francesco Pretto</senderName><senderEmail>ceztkoml@gmail.com</senderEmail><timestampReceived>2010-04-15 19:23:46-0400</timestampReceived><subject>[libvirt-users] STP default behavior for bridged (off) and NAT (on) networking in libvirt</subject><body>

Hello,

when talking about networking in hypervisors, it's easy to distinguish
the two classic configurations, NAT and bridged, and the official
libvirt wiki does exactly in this way here [1]. NAT networking is
already configured by libvirt creating a bridge called libvirt0, while
bridged networking have to be configured manually by the user.

The libvirt0 bridge for NAT networking is default configured in this way:
STP=on
MAXWAIT=0

While suggested br0 bridge for bridged networking is configured in this way:
STP=off
MAXWAIT=5

Please, can you explain me why STP is on for NAT and should be off for
bridged networking? It seems much easier to me to create loops when
using bridged networking than NAT. Moreover, reading this old debian
bug about complaints of MAXWAIT != 0 when STP off, I'm wondering if
the suggested configurations aren't actually switched.

Thanks,
Francesco

[1] http://wiki.libvirt.org/page/Networking
[2] http://www.mail-archive.com/debian-bugs-dist@lists.debian.org/msg700924.html

</body></email><email><emailId>20100418013820</emailId><senderName>Andreas Ntaflos</senderName><senderEmail>daff@pseudoterminal.org</senderEmail><timestampReceived>2010-04-18 01:38:20-0400</timestampReceived><subject>[libvirt-users] Restarting network on host completely cuts off guests. Why? How to prevent?</subject><body>


Hi list, 

this probably isn't a completely libvirt-specific question but I'll try 
anyway. Please ignore if it is too much off-topic.

On an Ubuntu (9.10) virtualisation host, running KVM and libvirt and 
several guests (Debian, Ubuntu, Windows Server 2003) in a bridged 
network fashion [1,2] I noticed that performing

/etc/init.d/networking restart

on the host completely cuts off all guests from the network. I have to 
manually shutdown and restart (virsh shutdown GUEST &amp;&amp; virsh start 
GUEST, a mere reboot doesn't suffice) them to get them onto the network 
again. Obviously that's not ideal.

Is this the expected behaviour? Can I somehow re-establish guest network 
connectivity without shutting down the guest first? Is my setup somehow 
wrong or do I expect too much?

Any insight, explanation or pointers would be much appreciated!

Thanks, 

Andreas

[1] http://wiki.libvirt.org/page/Networking#Debian.2FUbuntu_Bridging
[2] http://wiki.libvirt.org/page/Networking#Guest_configuration_2
-- 
Andreas Ntaflos 

GPG Fingerprint: 6234 2E8E 5C81 C6CB E5EC  7E65 397C E2A8 090C A9B4

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20100418095245</emailId><senderName>Francesco Pretto</senderName><senderEmail>ceztkoml@gmail.com</senderEmail><timestampReceived>2010-04-18 09:52:45-0400</timestampReceived><subject>Re: [libvirt-users] Restarting network on host completely cuts off guests. Why? How to prevent?</subject><body>

2010/4/18 Andreas Ntaflos &lt;daff@pseudoterminal.org&gt;:
&gt; On an Ubuntu (9.10) virtualisation host, running KVM and libvirt and
&gt; several guests (Debian, Ubuntu, Windows Server 2003) in a bridged
&gt; network fashion [1,2] I noticed that performing
&gt;
&gt; /etc/init.d/networking restart
&gt;
&gt; on the host completely cuts off all guests from the network. I have to
&gt; manually shutdown and restart (virsh shutdown GUEST &amp;&amp; virsh start
&gt; GUEST, a mere reboot doesn't suffice) them to get them onto the network
&gt; again. Obviously that's not ideal.
&gt;
&gt;

Confirmed, I have the same problem. Even with bridged configuration,
do you have dnsmasq running elsewhere (maybe with --bind-inferfaces
flag)? If i got it right, an application can bind to an "handle" of an
ethernet device and not its name, so when you restart networking, the
handle will change and apps binded to the previous handle will stop
working. Maybe it's the hypervisor itself (the ubuntu default is kvm)
to bind to the interface, so it maybe not be related at all with
libvirt.

Another thing I have observerd in a NAT configuration is that there
are problems in setting port forwarding from the host to guests when
libvirt is not yet started (= default network "libvirt0" bridge not
created and proper route to the NATed subnetwork not added). It seems
it just doesn't work, and it seems strange to me because I thought
iptables rules should have held even devices or hosts/networks didn't
exist. I "sorted" editing libvirt-bin init script adding a line that
adds port forwarding after libvirt have been started. This is the kind
of "ugly workarounds" I hate, but at the time it was the quicker
working (and safe) solution and din't have time to do a proper
reporting.

Maybe it does worth report this to ubuntu and/or kvm.

Greetings,
Francesco

</body></email><email><emailId>20100420003151</emailId><senderName>"Wang David"</senderName><senderEmail>david_wang@prn.com</senderEmail><timestampReceived>2010-04-20 00:31:51-0400</timestampReceived><subject>[libvirt-users] Need help using libvirt with qcow2 delta and base images</subject><body>

Hi,

 

I am having trouble configuring a virtual machine domain and its
corresponding xml definition to use a qcow2 delta disk.  The delta disk
is backed by a qcow2 base disk.  I am able to successfully start the
guest OS with the delta disk at the command line using qemu.  However, I
am not able to start the guest OS using the libvirt tools including
virsh and virt-manager.  I am hoping that someone knows how to configure
a virtual machine domain that works with a qcow2 delta disk, and have it
managed by the virt-family tools.

 

First, I create a delta and base disk from a raw image file with the
following commands:

  qemu-img convert ubuntu910server64.img -O qcow2
ubuntu910server64_base.qcow2

  qemu-img create -b ubuntu910server64_base.qcow2 -f qcow2
ubuntu910server64_delta.qcow2

 

Then, I can successfully start the guest OS on the command line with

  qemu-system-x86_64 -m 256 -hda ubuntu910server64_delta.qcow2

 

My attempt to modify the virtual machine domain configuration fails.
Here are my steps:

-- Edit the configuration

   # virsh edit ubuntu910server64

-- Replace some lines

    &lt;disk type='file' device='disk'&gt;

-     &lt;source file='/var/lib/libvirt/images/ubuntu910server64.img'/&gt;

-      &lt;target dev='vda' bus='virtio'/&gt;

+     &lt;source
file='/var/lib/libvirt/images/ubuntu910server64_delta.qcow2'/&gt;

+      &lt;target dev='hda' bus='ide'/&gt;

    &lt;/disk&gt;

-- Attempt to start the machine

   # virsh start ubuntu910server64

   Connecting to uri: qemu:///system

   error: Failed to start domain ubuntu910server64

   error: internal error unable to start guest: qemu: could not open
disk image /var/lib/libvirt/images/ubuntu910server64_delta.qcow2

 

If I have posted this to the wrong forum, please direct me to the right
location.

 

Thanks!

-dave


[Attachment #3 (text/html)]

&lt;html xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;meta http-equiv=Content-Type content="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 11 (filtered medium)"&gt;
&lt;style&gt;
&lt;!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Courier New";}
span.EmailStyle17
	{mso-style-type:personal;
	font-family:Arial;
	color:windowtext;}
p.section1, li.section1, div.section1
	{mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Times New Roman";}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 77.95pt 1.0in 77.95pt;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:174923203;
	mso-list-type:hybrid;
	mso-list-template-ids:837440660 -1985152528 67698691 67698693 67698689 67698691 \
67698693 67698689 67698691 67698693;} @list l0:level1
	{mso-level-start-at:0;
	mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Courier New";}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
--&gt;
&lt;/style&gt;

&lt;/head&gt;

&lt;body lang=EN-US link=blue vlink=purple&gt;

&lt;div class=Section1&gt;

&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt;Hi,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt;I am having trouble configuring a virtual machine domain and its
corresponding xml definition to use a qcow2 delta disk. The delta disk is
backed by a qcow2 base disk. I am able to successfully start the guest OS
with the delta disk at the command line using qemu. However, I am not
able to start the guest OS using the libvirt tools including virsh and
virt-manager. I am hoping that someone knows how to configure a virtual
machine domain that works with a qcow2 delta disk, and have it managed by the \
virt-family tools.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt;First, I create a delta and base disk from a raw image file with the
following commands:&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt; qemu-img convert ubuntu910server64.img -O qcow2 \
ubuntu910server64_base.qcow2&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt; qemu-img create -b ubuntu910server64_base.qcow2 -f qcow2
ubuntu910server64_delta.qcow2&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt;Then, I can successfully start the guest OS on the command line \
with&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt; qemu-system-x86_64 -m 256 -hda \
ubuntu910server64_delta.qcow2&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt;My attempt to modify the virtual machine domain configuration fails.
Here are my steps:&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt;-- Edit the configuration&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt; # virsh edit ubuntu910server64&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt;-- Replace some lines&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt; &lt;disk type='file' \
device='disk'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt;- &lt;source
file='/var/lib/libvirt/images/ubuntu910server64.img'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt;- &lt;target dev='vda' \
bus='virtio'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt;+ &lt;source
file='/var/lib/libvirt/images/ubuntu910server64_delta.qcow2'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt;+ &lt;target dev='hda' \
bus='ide'/&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt; &lt;/disk&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt;-- Attempt to start the machine&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt; # virsh start ubuntu910server64&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt; Connecting to uri: qemu:///system&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt; error: Failed to start domain \
ubuntu910server64&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt; error: internal error unable to start guest: qemu: could
not open disk image /var/lib/libvirt/images/ubuntu910server64_delta.qcow2&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt;If I have posted this to the wrong forum, please direct me to the right
location.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt;Thanks!&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=MsoPlainText&gt;&lt;font size=2 face="Courier New"&gt;&lt;span style='font-size:
10.0pt'&gt;-dave&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;



</body></email><email><emailId>20100421114654</emailId><senderName>"Tej Parkash, ERS, HCLTech"</senderName><senderEmail>tej.parkash@hcl.in</senderEmail><timestampReceived>2010-04-21 11:46:54-0400</timestampReceived><subject>Re: [libvirt-users] New VM Snapshot API Not working</subject><body>

All, 

Ok, I got it working.....

Problem was that I didnt include xen option for configure step.
But looks like Xen Hypervisor does not have support of Snapshot.  :(

I guess I have to fall back to save and restore method...

Sorry for the noise.



Thanks
Tej


________________________________________
From: Tej Parkash, ERS, HCLTech
Sent: Wednesday, April 21, 2010 2:31 PM
To: libvir-list@redhat.com
Subject: New VM Snapshot API Not working

All,

I have compiled new libvirt library 0.8.0. Compilation and installation went really \
fine except "make check" which has show some test got failed.  Here is what make \
check said.

Failed Test:

---------------snip-----------
PASS: statstest
TEST: qparamtest
      ................................         32  OK
PASS: qparamtest
TEST: capabilityschematest
      !!!!!!!!!!!!                             12  FAILED
FAIL: capabilityschematest
TEST: interfaceschematest
      !!!!!!!!!!!!!!!!!!                       18  FAILED
FAIL: interfaceschematest
TEST: networkschematest
      !!!!!!!!!!!                              11  FAILED
FAIL: networkschematest
TEST: storagepoolschematest
      !!!!!!!!!!!!!!!!!!!!                     20  FAILED
FAIL: storagepoolschematest
TEST: storagevolschematest
      !!!!!!!!!!!!                             12  FAILED
FAIL: storagevolschematest
TEST: domainschematest
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! 40
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! 80
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! 120
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! 160
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! 200
      !!                                       202 FAILED
FAIL: domainschematest
TEST: nodedevschematest
      !!!!!!!!!!!!!!                           14  FAILED
FAIL: nodedevschematest
TEST: nwfilterschematest
      !!!!!!!!!!!!!!!!!!!!!!!!!!!              27  FAILED
FAIL: nwfilterschematest
TEST: test_conf.sh
      ..                                       2   OK
---------------- snip ---------------------------

====================
9 of 40 tests failed
====================
make[3]: *** [check-TESTS] Error 1
make[3]: Leaving directory `/tmp/libvirt-0.8.0/tests'
make[2]: *** [check-am] Error 2
make[2]: Leaving directory `/tmp/libvirt-0.8.0/tests'
make[1]: *** [check-recursive] Error 1
make[1]: Leaving directory `/tmp/libvirt-0.8.0/tests'
make: *** [check-recursive] Error 1
-------------------------------------------------------------------------

However installation went fine.

After I started create some snapshot, I am getting some remote error:

root@hcl:~# xm li
Name                                        ID   Mem VCPUs      State   Time(s)
Domain-0                                     0   622     2     r-----   1755.3
Test                                         3   256     1     -b----      4.4
root@hcl:~# virsh snapshot-create 3
error: unmarshalling remote_error

root@hcl:~# virsh snapshot-create 3 test.xml
error: unmarshalling remote_error

I have even written a C code with API's but same problem.

Here is livirt version n all
root@hcl:/tmp/libvirt-0.8.0# libvirtd --version
libvirtd (libvirt) 0.8.0
root@hcl:/tmp/libvirt-0.8.0# virsh -v
0.8.0
root@hcl:/tmp/libvirt-0.8.0#


Any Idea????????????????
Any suggestion???????/



Thanks
Tej

DISCLAIMER:
-----------------------------------------------------------------------------------------------------------------------


The contents of this e-mail and any attachment(s) are confidential and intended for \
the named recipient(s) only.  It shall not attach any liability on the originator or \
HCL or its affiliates. Any views or opinions presented in  this email are solely \
those of the author and may not necessarily reflect the opinions of HCL or its \
affiliates.  Any form of reproduction, dissemination, copying, disclosure, \
modification, distribution and / or publication of  this message without the prior \
written consent of the author of this e-mail is strictly prohibited. If you have  \
received this email in error please delete it and notify the sender immediately. \
Before opening any mail and  attachments please check them for viruses and defect.

-----------------------------------------------------------------------------------------------------------------------



</body></email><email><emailId>20100422102111</emailId><senderName>Jorge_Alejandro_Rodrguez</senderName><senderEmail>jrodriguez@dit.upm.es</senderEmail><timestampReceived>2010-04-22 10:21:11-0400</timestampReceived><subject>[libvirt-users] Failed to insert a cd in a virtual machine running</subject><body>

I can't attach a cd when a vm is running with qemu 0.12.3 (ubuntu 10.04),
the problem is not with qemu because when I start the vm with kvm command
(without libvirt) I can change the cd with qemu-monitor without any problem
and eject it too (libvirt say me that it isn't supported by hypervisor).

the versions of libvirt that I have tried are 0.7.7 and 0.8.0.

Any ideas?

Thanks.
Jorge

[Attachment #3 (text/html)]

&lt;div&gt;I can't attach a cd when a vm is running with qemu 0.12.3 (ubuntu =
10.04), the problem is not with qemu because when I start the vm with kvm c=
ommand (without libvirt)=C2=A0I can change the cd with qemu-monitor without=
 any problem and eject it too (libvirt say me that it isn't supported b=
y hypervisor).&lt;/div&gt;


&lt;div&gt;=C2=A0&lt;/div&gt;
&lt;div&gt;the versions of libvirt that I have tried are 0.7.7 and 0.8.0.&lt;/div&gt;
&lt;div&gt;=C2=A0&lt;/div&gt;
&lt;div&gt;Any ideas?&lt;/div&gt;
&lt;div&gt;=C2=A0&lt;/div&gt;
&lt;div&gt;Thanks.&lt;/div&gt;
&lt;div&gt;Jorge&lt;/div&gt;


</body></email><email><emailId>20100420145745</emailId><senderName>jeremy avnet</senderName><senderEmail>brainsik@saucelabs.com</senderEmail><timestampReceived>2010-04-20 14:57:45-0400</timestampReceived><subject>Re: [libvirt-users] Need help using libvirt with qcow2 delta and base images</subject><body>

On Mon, Apr 19, 2010 at 5:31 PM, Wang David &lt;David_Wang@prn.com&gt; wrote:

&gt;  -      &lt;target dev='vda' bus='virtio'/&gt;
&gt;
&gt; +      &lt;target dev='hda' bus='ide'/&gt;
&gt;

Why are you changing this? Unless you've gone through extra steps to
configure your guest OS to use this different driver and location of the
boot disk, it's going to fail to boot. Perhaps try leaving this line
unchanged and see how that goes. From the VM's perspective, the
copy-on-write image (delta) is no different than the backing store.

.:. jeremy

[Attachment #3 (text/html)]

&lt;font face="verdana,sans-serif"&gt;&lt;span class="Apple-style-span" style="font-family: \
arial; "&gt;On Mon, Apr 19, 2010 at 5:31 PM, Wang David &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:David_Wang@prn.com"&gt;David_Wang@prn.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;/span&gt;&lt;br&gt; \
&lt;/font&gt;&lt;div class="gmail_quote"&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 \
.8ex;border-left:1px #ccc solid;padding-left:1ex;"&gt;








&lt;div lang="EN-US" link="blue" vlink="purple"&gt;

&lt;div&gt;

&lt;p&gt;&lt;span class="Apple-style-span" style="font-family: 'Courier New'; \
font-size: 13px; "&gt;-           &lt;target dev='vda' \
bus='virtio'/&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span class="Apple-style-span" style="font-family: 'Courier New'; \
font-size: 13px; "&gt;+           &lt;target dev='hda' \
bus='ide'/&gt;&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Why are \
you changing this? Unless you've gone through extra steps to configure your guest \
OS to use this different driver and location of the boot disk, it's going to fail \
to boot. Perhaps try leaving this line unchanged and see how that goes. From the \
VM's perspective, the copy-on-write image (delta) is no different than the \
backing store.&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;.:. jeremy&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20100425152440</emailId><senderName>Jorge_Alejandro_Rodrguez</senderName><senderEmail>jrodriguez@dit.upm.es</senderEmail><timestampReceived>2010-04-25 15:24:40-0400</timestampReceived><subject>[libvirt-users] QEmu 0.12.3 Libvirt-0.8.0 and serials ports</subject><body>

I have a problem with libvirt and serial ports. When I run a xml with serial
tag over libvirt0.8.0 and qemu 0.11 this is the line that libvirt execute

LC_ALL=C PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin
QEMU_AUDIO_DRV=none /usr/bin/kvm -S -M pc-0.11 -cpu qemu32 -enable-kvm -m 0
-smp 1 -name uml2 -uuid 431cb9f4-fdba-c4e8-a35f-23b52f91120a -monitor
unix:/var/lib/libvirt/qemu/uml2.monitor,server,nowait -boot cd -drive
file=/root/.vnuml/simulations/tutorial-r1_xp/vms/uml2/fs/root_cow_fs,if=ide,bus=0,unit=0,boot=on
                
-drive
file=/root/.vnuml/simulations/tutorial-r1_xp/vms/uml2/fs/opt_fs.iso,if=ide,media=cdrom,bus=0,unit=1
                
-net nic,macaddr=fe:fd:00:00:02:01,vlan=0,name=net0 -net
tap,fd=19,vlan=0,name=hostnet0* -serial
unix:/root/.vnuml/simulations/tutorial-r1_xp/vms/uml2/uml2_socket,server,nowait
* -parallel none -usb -vnc :1001 -vga cirrus -balloon virtio

and the virtual machine created have a serial port but when I run the same
xml in a machine with qemu 0.12.3 this is the line that libvirt execute

LC_ALL=C PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin
QEMU_AUDIO_DRV=none /usr/bin/kvm -S -M pc-0.12 -cpu qemu32 -enable-kvm -m 0
-smp 1,sockets=1,cores=1,threads=1 -name uml2 -uuid
3e3a4836-94b4-869c-4180-724c970c1909 -nodefaults -chardev
socket,id=monitor,path=/var/lib/libvirt/qemu/uml2.monitor,server,nowait -mon
chardev=monitor,mode=readline -rtc base=utc -boot cd -drive
file=/root/.vnuml/simulations/tutorial-r1_xp/vms/uml2/fs/root_cow_fs,if=none,id=drive-ide0-0-0,boot=on
                
-device ide-drive,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0 -drive
file=/root/.vnuml/simulations/tutorial-r1_xp/vms/uml2/fs/opt_fs.iso,if=none,media=cdrom,id=drive-ide0-0-1,readonly=on
                
-device ide-drive,bus=ide.0,unit=1,drive=drive-ide0-0-1,id=ide0-0-1 -device
rtl8139,vlan=0,id=net0,mac=fe:fd:00:00:02:01,bus=pci.0,addr=0x4 -net
tap,fd=18,vlan=0,name=hostnet0 -chardev
socket,id=serial0,path=/root/.vnuml/simulations/tutorial-r1_xp/vms/uml2/uml2_socket,server,nowait
                
-device isa-serial,chardev=serial0 -usb -vnc :1001 -vga cirrus -device
virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x3

the virtual machine don't have any serial port. If you execute the
line: /usr/bin/kvm -M pc-0.11 -cpu qemu32 -enable-kvm -m 0 -smp 1 -name uml2
-uuid 431cb9f4-fdba-c4e8-a35f-23b52f91120a -monitor
unix:/var/lib/libvirt/qemu/uml2.monitor,server,nowait -boot cd -drive
file=/root/.vnuml/simulations/tutorial-r1_xp/vms/uml2/fs/root_cow_fs,if=ide,bus=0,unit=0,boot=on
                
-drive
file=/root/.vnuml/simulations/tutorial-r1_xp/vms/uml2/fs/opt_fs.iso,if=ide,media=cdrom,bus=0,unit=1
                
-net nic,macaddr=fe:fd:00:00:02:01,vlan=0,name=net0 -net
tap,fd=19,vlan=0,name=hostnet0* -serial
unix:/root/.vnuml/simulations/tutorial-r1_xp/vms/uml2/uml2_socket,server,nowait
* -parallel none -usb -vnc :1001 -vga cirrus -balloon virtio (the same line
before) over qemu 0.12.3 the viertual machine have serial port.


Any ideas?


[Attachment #3 (text/html)]

I have a problem with libvirt and serial ports. When I run a xml with serial tag over \
libvirt0.8.0 and qemu 0.11 this is the line that libvirt execute  \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span class="Apple-style-span" style="font-family: arial, \
sans-serif; font-size: 13px; border-collapse: collapse; color: rgb(32, 64, 99); \
"&gt;LC_ALL=C PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin \
QEMU_AUDIO_DRV=none /usr/bin/kvm -S -M pc-0.11 -cpu qemu32 -enable-kvm -m 0 -smp 1 \
-name uml2 -uuid 431cb9f4-fdba-c4e8-a35f-23b52f91120a -monitor \
unix:/var/lib/libvirt/qemu/uml2.monitor,server,nowait -boot cd -drive \
file=/root/.vnuml/simulations/tutorial-r1_xp/vms/uml2/fs/root_cow_fs,if=ide,bus=0,unit=0,boot=on \
-drive file=/root/.vnuml/simulations/tutorial-r1_xp/vms/uml2/fs/opt_fs.iso,if=ide,media=cdrom,bus=0,unit=1 \
-net nic,macaddr=fe:fd:00:00:02:01,vlan=0,name=net0 -net \
tap,fd=19,vlan=0,name=hostnet0&lt;b&gt;  -serial \
unix:/root/.vnuml/simulations/tutorial-r1_xp/vms/uml2/uml2_socket,server,nowait&lt;/b&gt;  \
-parallel none -usb -vnc :1001 -vga cirrus -balloon virtio&lt;/span&gt;&lt;/div&gt;

&lt;div&gt;&lt;span class="Apple-style-span" style="font-family: arial, sans-serif; font-size: \
13px; border-collapse: collapse; color: rgb(32, 64, 99); \
"&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span class="Apple-style-span" style="font-family: arial, \
sans-serif; font-size: 13px; border-collapse: collapse; color: rgb(32, 64, 99); "&gt;and \
the virtual machine created have a serial port but when I run the same xml in a \
machine with qemu 0.12.3 this is the line that libvirt execute&lt;/span&gt;&lt;/div&gt;

&lt;div&gt;&lt;span class="Apple-style-span" style="font-family: arial, sans-serif; font-size: \
13px; border-collapse: collapse; color: rgb(32, 64, 99); \
"&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span class="Apple-style-span" style="font-family: arial, \
sans-serif; font-size: 13px; border-collapse: collapse; color: rgb(32, 64, 99); \
"&gt;LC_ALL=C PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin \
QEMU_AUDIO_DRV=none /usr/bin/kvm -S -M pc-0.12 -cpu qemu32 -enable-kvm -m 0 -smp \
1,sockets=1,cores=1,threads=1 -name uml2 -uuid 3e3a4836-94b4-869c-4180-724c970c1909 \
-nodefaults -chardev \
socket,id=monitor,path=/var/lib/libvirt/qemu/uml2.monitor,server,nowait -mon \
chardev=monitor,mode=readline -rtc base=utc -boot cd -drive \
file=/root/.vnuml/simulations/tutorial-r1_xp/vms/uml2/fs/root_cow_fs,if=none,id=drive-ide0-0-0,boot=on \
-device ide-drive,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0 -drive \
file=/root/.vnuml/simulations/tutorial-r1_xp/vms/uml2/fs/opt_fs.iso,if=none,media=cdrom,id=drive-ide0-0-1,readonly=on \
-device ide-drive,bus=ide.0,unit=1,drive=drive-ide0-0-1,id=ide0-0-1 -device \
rtl8139,vlan=0,id=net0,mac=fe:fd:00:00:02:01,bus=pci.0,addr=0x4 -net \
tap,fd=18,vlan=0,name=hostnet0 -chardev \
socket,id=serial0,path=/root/.vnuml/simulations/tutorial-r1_xp/vms/uml2/uml2_socket,server,nowait \
-device isa-serial,chardev=serial0 -usb -vnc :1001 -vga cirrus -device \
virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x3&lt;/span&gt;&lt;/div&gt;

&lt;div&gt;&lt;span class="Apple-style-span" style="font-family: arial, sans-serif; font-size: \
13px; border-collapse: collapse; color: rgb(32, 64, 99); \
"&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span class="Apple-style-span" style="font-family: arial, \
sans-serif; font-size: 13px; border-collapse: collapse; color: rgb(32, 64, 99); "&gt;the \
virtual machine don't have any serial port. If you execute the line:  \
/usr/bin/kvm -M pc-0.11 -cpu qemu32 -enable-kvm -m 0 -smp 1 -name uml2 -uuid \
431cb9f4-fdba-c4e8-a35f-23b52f91120a -monitor \
unix:/var/lib/libvirt/qemu/uml2.monitor,server,nowait -boot cd -drive \
file=/root/.vnuml/simulations/tutorial-r1_xp/vms/uml2/fs/root_cow_fs,if=ide,bus=0,unit=0,boot=on \
-drive file=/root/.vnuml/simulations/tutorial-r1_xp/vms/uml2/fs/opt_fs.iso,if=ide,media=cdrom,bus=0,unit=1 \
-net nic,macaddr=fe:fd:00:00:02:01,vlan=0,name=net0 -net \
tap,fd=19,vlan=0,name=hostnet0&lt;b&gt;  -serial \
unix:/root/.vnuml/simulations/tutorial-r1_xp/vms/uml2/uml2_socket,server,nowait&lt;/b&gt;  \
-parallel none -usb -vnc :1001 -vga cirrus -balloon virtio (the same line before) \
over qemu 0.12.3 the viertual machine have serial port.&lt;/span&gt;&lt;/div&gt;

&lt;div&gt;&lt;span class="Apple-style-span" style="font-family: arial, sans-serif; font-size: \
13px; border-collapse: collapse; color: rgb(32, 64, 99); \
"&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span class="Apple-style-span" style="font-family: arial, \
sans-serif; font-size: 13px; border-collapse: collapse; color: rgb(32, 64, 99); \
"&gt;&lt;br&gt;

&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span class="Apple-style-span" style="font-family: arial, \
sans-serif; font-size: 13px; border-collapse: collapse; color: rgb(32, 64, 99); "&gt;Any \
ideas?&lt;/span&gt;&lt;/div&gt;



</body></email><email><emailId>20100424150342</emailId><senderName>Erik de Castro Lopo</senderName><senderEmail>mle+tools@mega-nerd.com</senderEmail><timestampReceived>2010-04-24 15:03:42-0400</timestampReceived><subject>[libvirt-users] Problems moving qemu machine to libvirt</subject><body>

Hi all,

I have a qemu-system-arm machine that I am currently starting using:

    qemu-system-arm -M versatilepb -nographic \
      -hda img.qcow2 \
      -net vde,vlan=0,sock=/var/run/qemu-vde.ctl \
      -net nic,vlan=0,macaddr=52:54:00:12:34:22  \
      -kernel vmlinuz-2.6.18-6-versatile \
      -initrd initrd.img-2.6.18-6-versatile \
      -append "root=/dev/sda1 console=ttyAMA0,115200n8"

I converted the above to a virsh XML file using:

    virsh domxml-from-native qemu-argv run.argc &gt; arm32.xml

which resulted in this (minor modifications to provide full paths):

    &lt;domain type='qemu'&gt;
      &lt;name&gt;arm32&lt;/name&gt;
      &lt;uuid&gt;e433002b-107f-5b16-415b-7afb3e3a4d84&lt;/uuid&gt;
      &lt;memory&gt;262144&lt;/memory&gt;
      &lt;currentMemory&gt;262144&lt;/currentMemory&gt;
      &lt;vcpu&gt;1&lt;/vcpu&gt;
      &lt;os&gt;
        &lt;type arch='arm' machine='versatilepb'&gt;hvm&lt;/type&gt;
        &lt;kernel&gt;/kvm/arm32/vmlinuz-2.6.18-6-versatile&lt;/kernel&gt;
        &lt;initrd&gt;/kvm/arm32/initrd.img-2.6.18-6-versatile&lt;/initrd&gt;
      &lt;/os&gt;
      &lt;features&gt;
        &lt;acpi/&gt;
      &lt;/features&gt;
      &lt;clock offset='utc'/&gt;
      &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
      &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
      &lt;on_crash&gt;destroy&lt;/on_crash&gt;
      &lt;devices&gt;
        &lt;emulator&gt;/kvm/arm32/arm32.sh&lt;/emulator&gt;
        &lt;disk type='file' device='disk'&gt;
          &lt;source file='/kvm/arm32/img.qcow2'/&gt;
          &lt;target dev='hda' bus='ide'/&gt;
          &lt;address type='drive' controller='0' bus='0' unit='0'/&gt;
        &lt;/disk&gt;
        &lt;controller type='ide' index='0'/&gt;
        &lt;serial type='pty'&gt;
          &lt;target port='0'/&gt;
        &lt;/serial&gt;
        &lt;console type='pty'&gt;
          &lt;target port='0'/&gt;
        &lt;/console&gt;
      &lt;/devices&gt;
    &lt;/domain&gt;

Since libvirt doesn't support VDE networking I use a wrapper around
qemu-system-arm (/kvm/arm32/arm32.sh) containing:

    #!/bin/bash
    exec /usr/bin/qemu-system-arm $@ \
	-net nic,vlan=0,macaddr=52:54:00:12:34:22 \
	-net vde,vlan=0,group=vde2-net,mode=0770,sock=/var/run/qemu-vde.ctl \
	-append "root=/dev/sda1 console=ttyAMA0,115200n8"

However, doing this I get the following error when I attempt to start
the VM:

    error: Failed to start domain arm32
    error: internal error Process exited while reading console log output:
           char device redirected to /dev/pts/10
    qemu: could not open disk image console=ttyAMA0,115200n8\"":
           No such file or directory

The first problem (console log output) is probably due to the second,
where it seems that this:

    &lt;cmdline&gt;root=/dev/sda1 console=ttyAMA0,115200n8&lt;/cmdline&gt;

is not being passed to qemu correctly. I have tried quoting the command
line but that doesn't help.

Anyone have any clues?

Cheers,
Erik
-- 
----------------------------------------------------------------------
Erik de Castro Lopo
http://www.mega-nerd.com/

</body></email><email><emailId>20100423230343</emailId><senderName>scar</senderName><senderEmail>scar@drigon.com</senderEmail><timestampReceived>2010-04-23 23:03:43-0400</timestampReceived><subject>[libvirt-users] Using the host's LVM to manage virtual disks</subject><body>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

i am envisioning a scenario that a fellow sysadmin is employing using
xen, where the host is configured with LVM.  basically, one volume group
spans the physical disk.  then, various logical volumes are created for
the host and (Linux) guest OSes.  this makes it easy to resize logical
volumes should it be needed.

is a setup like this possible with libvirt?  the best i can think up, so
far, is to create a new logical disk, vm1, and pass that as an argument
to the -f option of virt-install.  then, during the installation i can
setup LVM within the guest.  not sure if this would even work if i need
to expand the volume size.  first i would expand the size of vm1.  then,
within the vm1 OS i would expand the size of the root partition.

i would like to not have to use this second layer of LVM.  for example,
on the host OS, i would create two logical volumes: vm1-root and
vm1-swap, and these are what vm1 would use for root and swap.  then, if
needed, i can just increase the size of vm1-root, etc.

thanks

-----BEGIN PGP SIGNATURE-----

iEYEAREIAAYFAkvSJ08ACgkQXhfCJNu98qDAoQCfbdN84rlxmFJCwHnsaHXdv0l4
juUAmwfE2Te+l07VfkuJYUI2/us83F5e
=AmQ+
-----END PGP SIGNATURE-----

</body></email><email><emailId>20100426132132</emailId><senderName>Don Morrison</senderName><senderEmail>dam@us.ibm.com</senderEmail><timestampReceived>2010-04-26 13:21:32-0400</timestampReceived><subject>Re: [libvirt-users] Using the host's LVM to manage virtual disks</subject><body>

I've been able to do this both ways with libvirt/kvm. You have to define
your logical volume as a block device. I the example below (I use virsh to
create the VM), I created logical volume "my_lv" in volume group "host" and
was able to both install an OS into it and copy (via dd) a raw image into
it.  Resizing the logical volume is easy, but you still have to resize the
guest file systems to allow the guest to make use of the additional space
(or give up the space if reducing the size)

   &lt;disk type='block' device='disk'&gt;
      &lt;source dev='/dev/host/my_lv'/&gt;
      &lt;target dev='sda' bus='scsi'/&gt;
    &lt;/disk&gt;


Don Morrison



                                                                           
             scar                                                          
             &lt;scar@drigon.com&gt;                                             
             Sent by:                                                   To 
             libvirt-users-bou         libvirt-users@redhat.com            
             nces@redhat.com                                            cc 
                                                                           
                                                                   Subject 
             04/23/2010 06:03          [libvirt-users] Using the host's    
             PM                        LVM to manage virtual disks         
                                                                           
                                                                           
                                                                           
                                                                           
                                                                           
                                                                           




-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

i am envisioning a scenario that a fellow sysadmin is employing using
xen, where the host is configured with LVM.  basically, one volume group
spans the physical disk.  then, various logical volumes are created for
the host and (Linux) guest OSes.  this makes it easy to resize logical
volumes should it be needed.

is a setup like this possible with libvirt?  the best i can think up, so
far, is to create a new logical disk, vm1, and pass that as an argument
to the -f option of virt-install.  then, during the installation i can
setup LVM within the guest.  not sure if this would even work if i need
to expand the volume size.  first i would expand the size of vm1.  then,
within the vm1 OS i would expand the size of the root partition.

i would like to not have to use this second layer of LVM.  for example,
on the host OS, i would create two logical volumes: vm1-root and
vm1-swap, and these are what vm1 would use for root and swap.  then, if
needed, i can just increase the size of vm1-root, etc.

thanks

-----BEGIN PGP SIGNATURE-----

iEYEAREIAAYFAkvSJ08ACgkQXhfCJNu98qDAoQCfbdN84rlxmFJCwHnsaHXdv0l4
juUAmwfE2Te+l07VfkuJYUI2/us83F5e
=AmQ+
-----END PGP SIGNATURE-----

_______________________________________________
libvirt-users mailing list
libvirt-users@redhat.com
https://www.redhat.com/mailman/listinfo/libvirt-users


</body></email><email><emailId>20100425170048</emailId><senderName>scar</senderName><senderEmail>scar@drigon.com</senderEmail><timestampReceived>2010-04-25 17:00:48-0400</timestampReceived><subject>Re: [libvirt-users] QEmu 0.12.3 Libvirt-0.8.0 and serials ports</subject><body>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Jorge Alejandro Rodrguez @ 04/25/2010 08:24 AM:
&gt; I have a problem with libvirt and serial ports. When I run a xml with serial
&gt; tag over libvirt0.8.0 and qemu 0.11 this is the line that libvirt execute
&gt; [snip]
&gt; 
&gt; and the virtual machine created have a serial port but when I run the same
&gt; xml in a machine with qemu 0.12.3 this is the line that libvirt execute
&gt; [snip]
&gt;
&gt; the virtual machine don't have any serial port. If you execute the
&gt; line: [snip] (the same line
&gt; before) over qemu 0.12.3 the viertual machine have serial port.
&gt; 
&gt; Any ideas?

in the command that is working, there is:

- -serial
unix:/root/.vnuml/simulations/tutorial-r1_xp/vms/uml2/uml2_socket,server,nowait
*

which is not showing up in the command that that qemu 0.12.3 is executing.

-----BEGIN PGP SIGNATURE-----

iEYEAREIAAYFAkvUdUAACgkQXhfCJNu98qC4gwCgy0PoQraK9Tfxv16t39EIt0+j
eYsAmwfivqAhHRcaNKi2tqfa/qtfU3qX
=Ils9
-----END PGP SIGNATURE-----

</body></email><email><emailId>20100420180159</emailId><senderName>"Wang David"</senderName><senderEmail>david_wang@prn.com</senderEmail><timestampReceived>2010-04-20 18:01:59-0400</timestampReceived><subject>Re: [libvirt-users] Need help using libvirt with qcow2 delta and base images</subject><body>

Hi Jeremy,

Thanks for responding, and for the suggestion.

I have tried several permutations of device type and bus (including vda/virtio), each \
of which seem to work on non-delta images.  The reason that I have given the example \
below using (target dev='hda' bus='ide') is because it most closely matches the \
working qemu command line:  qemu-system-x86_64 -m 256 -hda \
ubuntu910server64_delta.qcow2

This problem may be related to the way that virt-manager calls qemu.  When I use \
virsh to start a working non-delta image, the command line found from "ps" is the \
following:

  /usr/bin/kvm &lt;options removed&gt; -drive \
file=/var/lib/libvirt/images/ubuntu910server64.img,if=virtio,index=0,boot=on &lt;options \
removed&gt;

This seems to match the "qemu" man page documentation at line 139, where it suggests \
that the -hda switch is an alias to the -drive option:

           Instead of -hda, -hdb, -hdc, -hdd, you can use:

                   qemu -drive file=file,index=0,media=disk

Assuming that qemu/kvm is called with the same options for the delta disk, the \
options should be correct.

I've attached a segment from the syslog, which shows an error at \
                qemudReadLogOutput:816
--------------------------------------------------------------------
Apr 19 17:27:36 virtualserver3 kernel: [14202.390685] type=1505 \
audit(1271723256.496:74): operation="profile_load" pid=3144 \
                name=libvirt-20030353-cdee-109a-1abb-dc4971d036c2
Apr 19 17:27:36 virtualserver3 kernel: [14202.400448] device vnet0 entered \
                promiscuous mode
Apr 19 17:27:36 virtualserver3 kernel: [14202.402668] br0: port 2(vnet0) entering \
                learning state
Apr 19 17:27:36 virtualserver3 kernel: [14202.411373] type=1503 \
audit(1271723256.513:75): operation="open" pid=3147 parent=1 \
profile="libvirt-20030353-cdee-109a-1abb-dc4971d036c2" requested_mask="r::" \
denied_mask="r::" fsuid=0 ouid=0 \
                name="/data/virtual/var/lib/libvirt/images/ubuntu910server64.qcow2"
Apr 19 17:27:36 virtualserver3 kernel: [14202.516577] br0: port 2(vnet0) entering \
                disabled state
Apr 19 17:27:36 virtualserver3 kernel: [14202.544518] device vnet0 left promiscuous \
                mode
Apr 19 17:27:36 virtualserver3 kernel: [14202.544522] br0: port 2(vnet0) entering \
                disabled state
Apr 19 17:27:36 virtualserver3 libvirtd: 17:27:36.718: error : qemudReadLogOutput:816 \
                : internal error Process exited while reading console log output
Apr 19 17:27:36 virtualserver3 libvirtd: 17:27:36.718: error : \
qemudWaitForMonitor:1103 : internal error unable to start guest: qemu: could not open \
                disk image /var/lib/libvirt/images/ubuntu910server64_delta.qcow2#012
Apr 19 17:27:36 virtualserver3 kernel: [14202.728382] type=1505 \
audit(1271723256.834:76): operation="profile_remove" pid=3149 \
                name=libvirt-20030353-cdee-109a-1abb-dc4971d036c2 namespace=default
--------------------------------------------------------------------

Both the virtual host and guest machines are running Ubuntu 9.10 Server amd-64.

Has anyone have any success stories using delta images with virt-family tools?

Thanks!
-dave

________________________________________
From: jeremy avnet [mailto:brainsik@saucelabs.com] 
Sent: Tuesday, April 20, 2010 7:58 AM
To: Wang David
Cc: libvirt-users@redhat.com
Subject: Re: [libvirt-users] Need help using libvirt with qcow2 delta and base images

On Mon, Apr 19, 2010 at 5:31 PM, Wang David &lt;David_Wang@prn.com&gt; wrote:
-      &lt;target dev='vda' bus='virtio'/&gt;
+      &lt;target dev='hda' bus='ide'/&gt;

Why are you changing this? Unless you've gone through extra steps to configure your \
guest OS to use this different driver and location of the boot disk, it's going to \
fail to boot. Perhaps try leaving this line unchanged and see how that goes. From the \
VM's perspective, the copy-on-write image (delta) is no different than the backing \
store.

.:. jeremy


</body></email><email><emailId>20100420184611</emailId><senderName>jeremy avnet</senderName><senderEmail>brainsik@saucelabs.com</senderEmail><timestampReceived>2010-04-20 18:46:11-0400</timestampReceived><subject>Re: [libvirt-users] Need help using libvirt with qcow2 delta and base images</subject><body>

On Tue, Apr 20, 2010 at 11:01 AM, Wang David &lt;David_Wang@prn.com&gt; wrote:

&gt; Apr 19 17:27:36 virtualserver3 kernel: [14202.411373] type=1503
&gt; audit(1271723256.513:75): operation="open" pid=3147 parent=1
&gt; profile="libvirt-20030353-cdee-109a-1abb-dc4971d036c2" requested_mask="r::"
&gt; denied_mask="r::" fsuid=0 ouid=0
&gt; name="/data/virtual/var/lib/libvirt/images/ubuntu910server64.qcow2"
&gt; Apr 19 17:27:36 virtualserver3 libvirtd: 17:27:36.718: error :
&gt; qemudWaitForMonitor:1103 : internal error unable to start guest: qemu: could
&gt; not open disk image
&gt; /var/lib/libvirt/images/ubuntu910server64_delta.qcow2#012
&gt;

These indicate that AppArmor is denying access to the backing store, thus,
your delta image will not work.

You're going to need add a rule
into /etc/apparmor.d/abstractions/libvirt-qemu so that the backing store can
be read. Something like:

  /data/virtual/var/lib/libvirt/images/ubuntu910server64.qcow2 r,

or

  /data/virtual/var/lib/libvirt/images/* r,

.:. jeremy

[Attachment #3 (text/html)]

&lt;font face="verdana,sans-serif"&gt;&lt;span class="Apple-style-span" style="font-family: \
arial; "&gt;On Tue, Apr 20, 2010 at 11:01 AM, Wang David &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:David_Wang@prn.com"&gt;David_Wang@prn.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;/span&gt;&lt;br&gt; \
&lt;/font&gt;&lt;div class="gmail_quote"&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 \
.8ex;border-left:1px #ccc solid;padding-left:1ex;"&gt;Apr 19 17:27:36 virtualserver3 \
kernel: [14202.411373] type=1503 audit(1271723256.513:75): operation="open" \
pid=3147 parent=1 profile="libvirt-20030353-cdee-109a-1abb-dc4971d036c2" \
requested_mask="r::" denied_mask="r::" fsuid=0 ouid=0 \
                name="/data/virtual/var/lib/libvirt/images/ubuntu910server64.qcow2"&lt;br&gt;
                
Apr 19 17:27:36 virtualserver3 libvirtd: 17:27:36.718: error : \
qemudWaitForMonitor:1103 : internal error unable to start guest: qemu: could not open \
disk image /var/lib/libvirt/images/ubuntu910server64_delta.qcow2#012&lt;br&gt;

&lt;/blockquote&gt;&lt;div&gt;  &lt;/div&gt;&lt;div&gt;These indicate that AppArmor is denying access to the \
backing store, thus, your delta image will not \
work.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;You're going to need add a rule into  \
/etc/apparmor.d/abstractions/libvirt-qemu so that the backing store can be read. \
Something like:&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;    &lt;font class="Apple-style-span" \
face="'courier new', monospace"&gt;/data/virtual/var/lib/&lt;/font&gt;&lt;font \
class="Apple-style-span" face="'courier new', \
monospace"&gt;libvirt/images/&lt;/font&gt;&lt;font class="Apple-style-span" face="'courier \
new', monospace"&gt;ubuntu910server64.qcow2 r,&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;or  \
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;    &lt;font class="Apple-style-span" face="'courier \
new', monospace"&gt;/data/virtual/var/lib/&lt;/font&gt;&lt;font class="Apple-style-span" \
face="'courier new', monospace"&gt;libvirt/images/* r,&lt;/font&gt;&lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;.:. jeremy&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20100419130259</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2010-04-19 13:02:59-0400</timestampReceived><subject>Re: [libvirt-users] Restarting network on host completely cuts off guests. Why? How to prevent?</subject><body>

On 04/17/2010 09:38 PM, Andreas Ntaflos wrote:
&gt; Hi list, 
&gt; 
&gt; this probably isn't a completely libvirt-specific question but I'll try 
&gt; anyway. Please ignore if it is too much off-topic.
&gt; 
&gt; On an Ubuntu (9.10) virtualisation host, running KVM and libvirt and 
&gt; several guests (Debian, Ubuntu, Windows Server 2003) in a bridged 
&gt; network fashion [1,2] I noticed that performing
&gt; 
&gt; /etc/init.d/networking restart
&gt; 
&gt; on the host completely cuts off all guests from the network. I have to 
&gt; manually shutdown and restart (virsh shutdown GUEST &amp;&amp; virsh start 
&gt; GUEST, a mere reboot doesn't suffice) them to get them onto the network 
&gt; again. Obviously that's not ideal.
&gt; 
&gt; Is this the expected behaviour? Can I somehow re-establish guest network 
&gt; connectivity without shutting down the guest first? Is my setup somehow 
&gt; wrong or do I expect too much?

Unfortunately, that is the expected behavior.  If you do:

# brctl show
# /etc/init.d/networking restart
# brctl show

You'll see that the list of interfaces attached to the bridge is different
before and after.  The problem is that as libvirt starts a guest, it plugs
the virtual interface into the bridge device.  When you do a networking
restart, all of those interfaces are lost from the bridge, and there is no
way currently to re-attach them.  It's probably fix-able, but non-trivial;
libvirt would have to be notified by the system (via D-bus?) that the bridge
was restarted, and then it would have to re-plug the interfaces on the "new"
bridge.

-- 
Chris Lalancette

</body></email><email><emailId>20100419165110</emailId><senderName>jeremy avnet</senderName><senderEmail>brainsik+libvirt@saucelabs.com</senderEmail><timestampReceived>2010-04-19 16:51:10-0400</timestampReceived><subject>Re: [libvirt-users] Restarting network on host completely cuts off guests. Why? How to prevent?</subject><body>

On Mon, Apr 19, 2010 at 6:02 AM, Chris Lalancette &lt;clalance@redhat.com&gt;wrote:

&gt; Unfortunately, that is the expected behavior.  If you do:
&gt;
&gt; # brctl show
&gt; # /etc/init.d/networking restart
&gt; # brctl show


I also have this problem when I net-destroy/net-start the libvirt network in
order to load a new network definition (typically, new DHCP hosts). I made a
script which captures the br interfaces, restarts the network, then
reattaches, but it seems like there should be a way for libvirt to do this
for me since I'm restarting it's network and it's the one that plugged the
interfaces in. Is there something I'm missing?

Ubuntu 9.10 / libvirt 0.7.0.

.:. jeremy

[Attachment #3 (text/html)]

&lt;font face="verdana,sans-serif"&gt;&lt;span class="Apple-style-span" style="font-family: \
arial; "&gt;On Mon, Apr 19, 2010 at 6:02 AM, Chris Lalancette &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:clalance@redhat.com"&gt;clalance@redhat.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;/span&gt;&lt;br&gt; &lt;/font&gt;&lt;div class="gmail_quote"&gt;&lt;blockquote class="gmail_quote" \
style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex;"&gt;&lt;div \
class="im"&gt;Unfortunately, that is the expected behavior.   If you do:&lt;/div&gt; &lt;br&gt;
# brctl show&lt;br&gt;
# /etc/init.d/networking restart&lt;br&gt;
# brctl show&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I also have this problem when I \
net-destroy/net-start the libvirt network in order to load a new network definition \
(typically, new DHCP hosts). I made a script which captures the br interfaces, \
restarts the network, then reattaches, but it seems like there should be a way for \
libvirt to do this for me since I'm restarting it's network and it's the \
one that plugged the interfaces in. Is there something I'm missing?&lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Ubuntu 9.10 / libvirt 0.7.0.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;.:. \
jeremy&lt;/div&gt;&lt;/div&gt;



</body></email><email><emailId>20100416094748</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-04-16 09:47:48-0400</timestampReceived><subject>Re: [libvirt-users] STP default behavior for bridged (off) and NAT (on) networking in libvirt</subject><body>

On Thu, Apr 15, 2010 at 09:23:46PM +0200, Francesco Pretto wrote:
&gt; Hello,
&gt; 
&gt; when talking about networking in hypervisors, it's easy to distinguish
&gt; the two classic configurations, NAT and bridged, and the official
&gt; libvirt wiki does exactly in this way here [1]. NAT networking is
&gt; already configured by libvirt creating a bridge called libvirt0, while
&gt; bridged networking have to be configured manually by the user.
&gt; 
&gt; The libvirt0 bridge for NAT networking is default configured in this way:
&gt; STP=on
&gt; MAXWAIT=0
&gt; 
&gt; While suggested br0 bridge for bridged networking is configured in this way:
&gt; STP=off
&gt; MAXWAIT=5

I don't believe we're recommending STP=off for bridging. Our recommended
config is

# cat &gt; ifcfg-br0 &lt;&lt;EOF
DEVICE=br0
TYPE=Bridge
BOOTPROTO=dhcp
ONBOOT=yes
DELAY=0
NM_CONTROLLED=no
EOF

And IIUC, STP defaults to on if not specified.

I agree STP should always be on for bridging to avoid netloops. The main
important param DELAY=0 is there to ensure that you get instant network
connectivity when doing live migration - without it you'll get a 30 second
network blackout

Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100416104713</emailId><senderName>Francesco Pretto</senderName><senderEmail>ceztkoml@gmail.com</senderEmail><timestampReceived>2010-04-16 10:47:13-0400</timestampReceived><subject>Re: [libvirt-users] STP default behavior for bridged (off) and NAT (on) networking in libvirt</subject><body>

2010/4/16 Daniel P. Berrange &lt;berrange@redhat.com&gt;:
&gt;
&gt; I don't believe we're recommending STP=off for bridging.
&gt;

Actually STP=off is "recommended" in the wiki [1] in the ubuntu part,
and there are quotes even in the fedora RHEL parts like this:

# brctl show
 bridge name     bridge id               STP enabled     interfaces
 virbr0          8000.000000000000       yes
 br0             8000.000e0cb30550       no              eth0

I don't know who actually wrote that document but is well written and
helpful, and "!google libvirt networking" points there, so it's just a
matter of fix imprecisions. If you agree, I'll fix the wiki later (if
is editable by anyone), recommending to set STP=on and DELAY=0 in all
cases, whatever NAT or bridging configurations are chosen.

Greetins,
Francesco

</body></email><email><emailId>20100416105436</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-04-16 10:54:36-0400</timestampReceived><subject>Re: [libvirt-users] STP default behavior for bridged (off) and NAT (on) networking in libvirt</subject><body>

On Fri, Apr 16, 2010 at 12:47:13PM +0200, Francesco Pretto wrote:
&gt; 2010/4/16 Daniel P. Berrange &lt;berrange@redhat.com&gt;:
&gt; &gt;
&gt; &gt; I don't believe we're recommending STP=off for bridging.
&gt; &gt;
&gt; 
&gt; Actually STP=off is "recommended" in the wiki [1] in the ubuntu part,
&gt; and there are quotes even in the fedora RHEL parts like this:
&gt; 
&gt; # brctl show
&gt;  bridge name     bridge id               STP enabled     interfaces
&gt;  virbr0          8000.000000000000       yes
&gt;  br0             8000.000e0cb30550       no              eth0
&gt; 
&gt; I don't know who actually wrote that document but is well written and
&gt; helpful, and "!google libvirt networking" points there, so it's just a
&gt; matter of fix imprecisions. If you agree, I'll fix the wiki later (if
&gt; is editable by anyone), recommending to set STP=on and DELAY=0 in all
&gt; cases, whatever NAT or bridging configurations are chosen.

Yes, that sounds good to me.

Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100417151935</emailId><senderName>"Hugh O. Brock"</senderName><senderEmail>hbrock@redhat.com</senderEmail><timestampReceived>2010-04-17 15:19:35-0400</timestampReceived><subject>Re: [libvirt-users] Default network needed?</subject><body>

On Sat, Apr 17, 2010 at 04:20:25AM +0200, Andreas Ntaflos wrote:
&gt; Hi list, 
&gt; 
&gt; long(ish) time libvirt users, first time poster.
&gt; 
&gt; Question: Is the default network (192.168.122.0/24, NAT) created by 
&gt; libvirt needed at all when guests are connected to the host's bridge 
&gt; device (and not the default network)
&gt; 
&gt; I.e. when I have
&gt; 
&gt; &lt;interface type='bridge'&gt;
&gt;   &lt;source bridge='br0'/&gt;
&gt;   &lt;model type='virtio'/&gt;
&gt; &lt;/interface&gt;
&gt; 
&gt; in my guest definition is the default network ever even used? Or can I 
&gt; safely remove it?
&gt; 
&gt; This may be a naive or stupid question but I have not found a definitive 
&gt; answer studying the documentation. Can anybody enlighten me?
&gt; 
&gt; Thanks, 
&gt; 
&gt; Andreas

Hello Andreas. It's not a naive question at all, but it has a simple
answer: Yes, you can safely remove it if you haven't attached any VMs
to it. We set it up strictly as a convenience, mostly for developers
who are trying to use virt on a laptop with a wifi connection that is
up and down a lot.

Take care,
--Hugh

-- 
========================================================
Hugh Brock, hbrock@redhat.com, +1-215-564-3232
Deltacloud API + Portal http://deltacloud.org
Libvirt virtualization library http://libvirt.org
========================================================

</body></email><email><emailId>20100426074011</emailId><senderName>gary mazzaferro</senderName><senderEmail>garym@oedata.com</senderEmail><timestampReceived>2010-04-26 07:40:11-0400</timestampReceived><subject>[libvirt-users] Building &amp; Installing on OpenSolaris</subject><body>

Hi,

I'm revisiting my libVirt install for opensolaris. I downloaded libvirt
0.8.0..

This is a bit embarassing, but I forgot how to build libVirt on opensolaris.
(It's been a while)  I'm currently stuck with the configure script failing
to find linux kernel headers.
Error:
"configure: error: You must install kernel-headers in order to compile
libvirt"

Can anyone post the instructions to build under opensolaris?

cheers,
gary

[Attachment #3 (text/html)]

Hi,&lt;br&gt;&lt;br&gt;I'm revisiting my libVirt install for opensolaris. I downloa=
ded libvirt 0.8.0.. &lt;br&gt;&lt;br&gt;This is a bit embarassing, but I forgot how to =
build libVirt on opensolaris. (It's been a while)=A0 I'm currently =
stuck with the configure script failing to find linux kernel headers.&lt;br&gt;
Error:&lt;br&gt;"configure: error: You must install kernel-headers in order =
to compile libvirt"&lt;br&gt;&lt;br&gt;Can anyone post the instructions to build u=
nder opensolaris?&lt;br&gt;&lt;br&gt;cheers,&lt;br&gt;gary&lt;br&gt;


</body></email><email><emailId>20100426100919</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2010-04-26 10:09:19-0400</timestampReceived><subject>Re: [libvirt-users] Building &amp; Installing on OpenSolaris</subject><body>

On Mon, Apr 26, 2010 at 01:40:11AM -0600, gary mazzaferro wrote:
&gt; Hi,
&gt; 
&gt; I'm revisiting my libVirt install for opensolaris. I downloaded libvirt
&gt; 0.8.0..
&gt; 
&gt; This is a bit embarassing, but I forgot how to build libVirt on opensolaris.
&gt; (It's been a while)  I'm currently stuck with the configure script failing
&gt; to find linux kernel headers.
&gt; Error:
&gt; "configure: error: You must install kernel-headers in order to compile
&gt; libvirt"
&gt; 
&gt; Can anyone post the instructions to build under opensolaris?

  Well you need to desactivate qemu and lxc builds to avoid this error:

./configure --without-lxc --without-qemu ...

that should be done automatically on non-linux systems, it's a bug,

Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

</body></email><email><emailId>20100427020740</emailId><senderName>gary mazzaferro</senderName><senderEmail>garym@oedata.com</senderEmail><timestampReceived>2010-04-27 02:07:40-0400</timestampReceived><subject>Re: [libvirt-users] Building &amp; Installing on OpenSolaris</subject><body>

Hi Daniel,

Thanks for the tip.  It got me a bit further.

Now I'm stuck on configure looking for device mapper. I don't remember this
before..

checking for DEVMAPPER... checking libdevmapper.h usability... no
checking libdevmapper.h presence... no
checking for libdevmapper.h... no
checking for dm_task_run in -ldevmapper... no
configure: error: You must install device-mapper-devel/
libdevmapper &gt;= 1.0.0 to compile libvirt


Any suggestion besides moving to linux ?

cheers,
gary


On Mon, Apr 26, 2010 at 4:09 AM, Daniel Veillard &lt;veillard@redhat.com&gt;wrote:

&gt; On Mon, Apr 26, 2010 at 01:40:11AM -0600, gary mazzaferro wrote:
&gt; &gt; Hi,
&gt; &gt;
&gt; &gt; I'm revisiting my libVirt install for opensolaris. I downloaded libvirt
&gt; &gt; 0.8.0..
&gt; &gt;
&gt; &gt; This is a bit embarassing, but I forgot how to build libVirt on
&gt; opensolaris.
&gt; &gt; (It's been a while)  I'm currently stuck with the configure script
&gt; failing
&gt; &gt; to find linux kernel headers.
&gt; &gt; Error:
&gt; &gt; "configure: error: You must install kernel-headers in order to compile
&gt; &gt; libvirt"
&gt; &gt;
&gt; &gt; Can anyone post the instructions to build under opensolaris?
&gt;
&gt;   Well you need to desactivate qemu and lxc builds to avoid this error:
&gt;
&gt; ./configure --without-lxc --without-qemu ...
&gt;
&gt; that should be done automatically on non-linux systems, it's a bug,
&gt;
&gt; Daniel
&gt;
&gt; --
&gt; Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
&gt; daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
&gt; http://veillard.com/ | virtualization library  http://libvirt.org/
&gt;

[Attachment #3 (text/html)]

Hi Daniel,&lt;br&gt;&lt;br&gt;Thanks for the tip.  It got me a bit further.&lt;br&gt;&lt;br&gt;Now
 I'm stuck on configure looking for device mapper. I don't remember this
 before..&lt;br&gt;&lt;br&gt;checking for DEVMAPPER... checking libdevmapper.h 
usability... no&lt;br&gt;
checking libdevmapper.h presence... no&lt;br&gt;checking for libdevmapper.h...
 no&lt;br&gt;checking for dm_task_run in -ldevmapper... no&lt;br&gt;configure: 
error: You must install device-mapper-devel/&lt;div id=":104" class="ii gt"&gt;libdevmapper \
&gt;=  1.0.0 to compile libvirt&lt;br&gt;
&lt;br&gt;&lt;br&gt;Any suggestion besides moving to linux ?&lt;br&gt;&lt;br&gt;cheers,&lt;br&gt;&lt;font \
color="#888888"&gt;gary&lt;/font&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Mon, Apr 26, \
2010 at 4:09 AM, Daniel Veillard &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:veillard@redhat.com"&gt;veillard@redhat.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt; \
&lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px \
solid rgb(204, 204, 204); padding-left: 1ex;"&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;On Mon, \
Apr 26, 2010 at 01:40:11AM -0600, gary mazzaferro wrote:&lt;br&gt;

&gt; Hi,&lt;br&gt;
&gt;&lt;br&gt;
&gt; I'm revisiting my libVirt install for opensolaris. I downloaded libvirt&lt;br&gt;
&gt; 0.8.0..&lt;br&gt;
&gt;&lt;br&gt;
&gt; This is a bit embarassing, but I forgot how to build libVirt on opensolaris.&lt;br&gt;
&gt; (It's been a while)  I'm currently stuck with the configure script \
failing&lt;br&gt; &gt; to find linux kernel headers.&lt;br&gt;
&gt; Error:&lt;br&gt;
&gt; "configure: error: You must install kernel-headers in order to compile&lt;br&gt;
&gt; libvirt"&lt;br&gt;
&gt;&lt;br&gt;
&gt; Can anyone post the instructions to build under opensolaris?&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;  Well you need to desactivate qemu and lxc builds to avoid this \
error:&lt;br&gt; &lt;br&gt;
./configure --without-lxc --without-qemu ...&lt;br&gt;
&lt;br&gt;
that should be done automatically on non-linux systems, it's a bug,&lt;br&gt;
&lt;br&gt;
Daniel&lt;br&gt;
&lt;font color="#888888"&gt;&lt;br&gt;
--&lt;br&gt;
Daniel Veillard      | libxml Gnome XML XSLT toolkit  &lt;a href="http://xmlsoft.org/" \
target="_blank"&gt;http://xmlsoft.org/&lt;/a&gt;&lt;br&gt; &lt;a \
href="mailto:daniel@veillard.com"&gt;daniel@veillard.com&lt;/a&gt;  | Rpmfind RPM search \
engine &lt;a href="http://rpmfind.net/" target="_blank"&gt;http://rpmfind.net/&lt;/a&gt;&lt;br&gt; &lt;a \
href="http://veillard.com/" target="_blank"&gt;http://veillard.com/&lt;/a&gt; | virtualization \
library  &lt;a href="http://libvirt.org/" target="_blank"&gt;http://libvirt.org/&lt;/a&gt;&lt;br&gt; \
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20100427042433</emailId><senderName>gary mazzaferro</senderName><senderEmail>garym@oedata.com</senderEmail><timestampReceived>2010-04-27 04:24:33-0400</timestampReceived><subject>Re: [libvirt-users] Building &amp; Installing on OpenSolaris</subject><body>

Hi all,

Found my own problem... mpath needs to be disabled.

This is the current options for configure...

./configure ----without-lxc --without-qemu

Now the make is broken, I don't think there is a linux/params.h  in
opensolaris. I was able to build under opensolaris...

Any suggestions ?

make[3]: Entering directory `/export/home/garym/libvirt-0.8.0/src'
  CC     libvirt_util_la-authhelper.lo
  CC     libvirt_util_la-bridge.lo
util/bridge.c:38:20: paths.h: No such file or directory
util/bridge.c:41:55: linux/param.h: No such file or directory
util/bridge.c:42:55: linux/sockios.h: No such file or directory
util/bridge.c:43:55: linux/if_bridge.h: No such file or directory
util/bridge.c:44:55: linux/if_tun.h: No such file or directory
util/bridge.c: In function `ifGetMtu':
util/bridge.c:313: error: `SIOCGIFMTU' undeclared (first use in this
function)
util/bridge.c:313: error: (Each undeclared identifier is reported only once
util/bridge.c:313: error: for each function it appears in.)
util/bridge.c:316: error: structure has no member named `ifr_mtu'
util/bridge.c: In function `ifSetMtu':
util/bridge.c:342: error: structure has no member named `ifr_mtu'
util/bridge.c:344: error: `SIOCSIFMTU' undeclared (first use in this
function)
util/bridge.c: In function `brAddTap':
util/bridge.c:464: error: `IFF_TAP' undeclared (first use in this function)
util/bridge.c:464: error: `IFF_NO_PI' undeclared (first use in this
function)
util/bridge.c:478: error: `TUNSETIFF' undeclared (first use in this
function)
util/bridge.c:492: error: `TUNSETPERSIST' undeclared (first use in this
function)
util/bridge.c: In function `brDeleteTap':
util/bridge.c:520: error: `IFF_TAP' undeclared (first use in this function)
util/bridge.c:520: error: `IFF_NO_PI' undeclared (first use in this
function)
util/bridge.c:527: error: `TUNSETIFF' undeclared (first use in this
function)
util/bridge.c:528: error: `TUNSETPERSIST' undeclared (first use in this
function)
util/bridge.c: In function `brSetInterfaceUp':
util/bridge.c:565: error: `SIOCGIFFLAGS' undeclared (first use in this
function)
util/bridge.c:573: error: `SIOCSIFFLAGS' undeclared (first use in this
function)
util/bridge.c: In function `brGetInterfaceUp':
util/bridge.c:605: error: `SIOCGIFFLAGS' undeclared (first use in this
function)
util/bridge.c: In function `brSetInetAddress':
util/bridge.c:701: error: `SIOCSIFADDR' undeclared (first use in this
function)
util/bridge.c: In function `brGetInetAddress':
util/bridge.c:724: error: `SIOCGIFADDR' undeclared (first use in this
function)
util/bridge.c: In function `brSetInetNetmask':
util/bridge.c:745: error: `SIOCSIFNETMASK' undeclared (first use in this
function)
util/bridge.c: In function `brGetInetNetmask':
util/bridge.c:768: error: `SIOCGIFNETMASK' undeclared (first use in this
function)
make[3]: *** [libvirt_util_la-bridge.lo] Error 1
make[3]: Leaving directory `/export/home/garym/libvirt-0.8.0/src'
make[2]: *** [all] Error 2
make[2]: Leaving directory `/export/home/garym/libvirt-0.8.0/src'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/export/home/garym/libvirt-0.8.0'
make: *** [all] Error 2


On Mon, Apr 26, 2010 at 8:07 PM, gary mazzaferro &lt;garym@oedata.com&gt; wrote:

&gt; Hi Daniel,
&gt;
&gt; Thanks for the tip.  It got me a bit further.
&gt;
&gt; Now I'm stuck on configure looking for device mapper. I don't remember this
&gt; before..
&gt;
&gt; checking for DEVMAPPER... checking libdevmapper.h usability... no
&gt; checking libdevmapper.h presence... no
&gt; checking for libdevmapper.h... no
&gt; checking for dm_task_run in -ldevmapper... no
&gt; configure: error: You must install device-mapper-devel/
&gt; libdevmapper &gt;= 1.0.0 to compile libvirt
&gt;
&gt;
&gt; Any suggestion besides moving to linux ?
&gt;
&gt; cheers,
&gt; gary
&gt;
&gt;
&gt; On Mon, Apr 26, 2010 at 4:09 AM, Daniel Veillard &lt;veillard@redhat.com&gt;wrote:
&gt;
&gt;&gt; On Mon, Apr 26, 2010 at 01:40:11AM -0600, gary mazzaferro wrote:
&gt;&gt; &gt; Hi,
&gt;&gt; &gt;
&gt;&gt; &gt; I'm revisiting my libVirt install for opensolaris. I downloaded libvirt
&gt;&gt; &gt; 0.8.0..
&gt;&gt; &gt;
&gt;&gt; &gt; This is a bit embarassing, but I forgot how to build libVirt on
&gt;&gt; opensolaris.
&gt;&gt; &gt; (It's been a while)  I'm currently stuck with the configure script
&gt;&gt; failing
&gt;&gt; &gt; to find linux kernel headers.
&gt;&gt; &gt; Error:
&gt;&gt; &gt; "configure: error: You must install kernel-headers in order to compile
&gt;&gt; &gt; libvirt"
&gt;&gt; &gt;
&gt;&gt; &gt; Can anyone post the instructions to build under opensolaris?
&gt;&gt;
&gt;&gt;   Well you need to desactivate qemu and lxc builds to avoid this error:
&gt;&gt;
&gt;&gt; ./configure --without-lxc --without-qemu ...
&gt;&gt;
&gt;&gt; that should be done automatically on non-linux systems, it's a bug,
&gt;&gt;
&gt;&gt; Daniel
&gt;&gt;
&gt;&gt; --
&gt;&gt; Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
&gt;&gt; daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
&gt;&gt; http://veillard.com/ | virtualization library  http://libvirt.org/
&gt;&gt;
&gt;
&gt;

[Attachment #3 (text/html)]

Hi all,&lt;br&gt;&lt;br&gt;Found my own problem... mpath needs to be disabled.  &lt;br&gt;&lt;br&gt;This is \
the current options for configure... &lt;br&gt;&lt;br&gt;./configure ----without-lxc \
--without-qemu&lt;br&gt;&lt;br&gt;Now the make is broken, I don't think there is a \
linux/params.h  in opensolaris. I was able to build under opensolaris... &lt;br&gt; &lt;br&gt;Any \
suggestions ?&lt;br&gt;&lt;br&gt;make[3]: Entering directory \
`/export/home/garym/libvirt-0.8.0/src'&lt;br&gt;  CC     \
libvirt_util_la-authhelper.lo&lt;br&gt;  CC     \
libvirt_util_la-bridge.lo&lt;br&gt;util/bridge.c:38:20: paths.h: No such file or \
directory&lt;br&gt; util/bridge.c:41:55: linux/param.h: No such file or \
directory&lt;br&gt;util/bridge.c:42:55: linux/sockios.h: No such file or \
directory&lt;br&gt;util/bridge.c:43:55: linux/if_bridge.h: No such file or \
                directory&lt;br&gt;util/bridge.c:44:55: linux/if_tun.h: No such file or \
                directory&lt;br&gt;
util/bridge.c: In function `ifGetMtu':&lt;br&gt;util/bridge.c:313: error: \
`SIOCGIFMTU' undeclared (first use in this function)&lt;br&gt;util/bridge.c:313: error: \
(Each undeclared identifier is reported only once&lt;br&gt;util/bridge.c:313: error: for \
each function it appears in.)&lt;br&gt; util/bridge.c:316: error: structure has no member \
named `ifr_mtu'&lt;br&gt;util/bridge.c: In function \
`ifSetMtu':&lt;br&gt;util/bridge.c:342: error: structure has no member named \
`ifr_mtu'&lt;br&gt;util/bridge.c:344: error: `SIOCSIFMTU' undeclared (first use in \
                this function)&lt;br&gt;
util/bridge.c: In function `brAddTap':&lt;br&gt;util/bridge.c:464: error: `IFF_TAP' \
undeclared (first use in this function)&lt;br&gt;util/bridge.c:464: error: `IFF_NO_PI' \
undeclared (first use in this function)&lt;br&gt;util/bridge.c:478: error: `TUNSETIFF' \
undeclared (first use in this function)&lt;br&gt; util/bridge.c:492: error: \
`TUNSETPERSIST' undeclared (first use in this function)&lt;br&gt;util/bridge.c: In \
function `brDeleteTap':&lt;br&gt;util/bridge.c:520: error: `IFF_TAP' undeclared \
(first use in this function)&lt;br&gt; util/bridge.c:520: error: `IFF_NO_PI' undeclared \
(first use in this function)&lt;br&gt;util/bridge.c:527: error: `TUNSETIFF' undeclared \
(first use in this function)&lt;br&gt;util/bridge.c:528: error: `TUNSETPERSIST' \
                undeclared (first use in this function)&lt;br&gt;
util/bridge.c: In function `brSetInterfaceUp':&lt;br&gt;util/bridge.c:565: error: \
`SIOCGIFFLAGS' undeclared (first use in this function)&lt;br&gt;util/bridge.c:573: \
                error: `SIOCSIFFLAGS' undeclared (first use in this function)&lt;br&gt;
util/bridge.c: In function `brGetInterfaceUp':&lt;br&gt;util/bridge.c:605: error: \
`SIOCGIFFLAGS' undeclared (first use in this function)&lt;br&gt;util/bridge.c: In \
function `brSetInetAddress':&lt;br&gt;util/bridge.c:701: error: `SIOCSIFADDR' \
                undeclared (first use in this function)&lt;br&gt;
util/bridge.c: In function `brGetInetAddress':&lt;br&gt;util/bridge.c:724: error: \
`SIOCGIFADDR' undeclared (first use in this function)&lt;br&gt;util/bridge.c: In \
function `brSetInetNetmask':&lt;br&gt;util/bridge.c:745: error: `SIOCSIFNETMASK' \
                undeclared (first use in this function)&lt;br&gt;
util/bridge.c: In function `brGetInetNetmask':&lt;br&gt;util/bridge.c:768: error: \
`SIOCGIFNETMASK' undeclared (first use in this function)&lt;br&gt;make[3]: *** \
[libvirt_util_la-bridge.lo] Error 1&lt;br&gt;make[3]: Leaving directory \
`/export/home/garym/libvirt-0.8.0/src'&lt;br&gt; make[2]: *** [all] Error 2&lt;br&gt;make[2]: \
Leaving directory `/export/home/garym/libvirt-0.8.0/src'&lt;br&gt;make[1]: *** \
[all-recursive] Error 1&lt;br&gt;make[1]: Leaving directory \
`/export/home/garym/libvirt-0.8.0'&lt;br&gt;make: *** [all] Error 2&lt;br&gt; &lt;br&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;On Mon, Apr 26, 2010 at 8:07 PM, gary mazzaferro &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:garym@oedata.com"&gt;garym@oedata.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; \
border-left: 1px solid rgb(204, 204, 204); padding-left: 1ex;"&gt; &lt;div class="im"&gt;Hi \
Daniel,&lt;br&gt;&lt;br&gt;Thanks for the tip.  It got me a bit further.&lt;br&gt;&lt;br&gt;Now  I'm \
stuck on configure looking for device mapper. I don't remember this  \
before..&lt;br&gt;&lt;br&gt;checking for DEVMAPPER... checking libdevmapper.h  usability... \
no&lt;br&gt; checking libdevmapper.h presence... no&lt;br&gt;checking for libdevmapper.h...
 no&lt;br&gt;checking for dm_task_run in -ldevmapper... no&lt;br&gt;configure: 
error: You must install device-mapper-devel/&lt;div&gt;libdevmapper &gt;= 
1.0.0 to compile libvirt&lt;br&gt;
&lt;br&gt;&lt;br&gt;Any suggestion besides moving to linux ?&lt;br&gt;&lt;br&gt;cheers,&lt;br&gt;&lt;font \
color="#888888"&gt;gary&lt;/font&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div class="gmail_quote"&gt;&lt;div \
class="im"&gt;On Mon, Apr 26, 2010 at 4:09 AM, Daniel Veillard &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:veillard@redhat.com" target="_blank"&gt;veillard@redhat.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;

&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div class="h5"&gt;&lt;blockquote class="gmail_quote" style="margin: \
0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, 204, 204); padding-left: \
1ex;"&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;On Mon, Apr 26, 2010 at 01:40:11AM -0600, gary mazzaferro \
wrote:&lt;br&gt;


&gt; Hi,&lt;br&gt;
&gt;&lt;br&gt;
&gt; I'm revisiting my libVirt install for opensolaris. I downloaded libvirt&lt;br&gt;
&gt; 0.8.0..&lt;br&gt;
&gt;&lt;br&gt;
&gt; This is a bit embarassing, but I forgot how to build libVirt on opensolaris.&lt;br&gt;
&gt; (It's been a while)  I'm currently stuck with the configure script \
failing&lt;br&gt; &gt; to find linux kernel headers.&lt;br&gt;
&gt; Error:&lt;br&gt;
&gt; "configure: error: You must install kernel-headers in order to compile&lt;br&gt;
&gt; libvirt"&lt;br&gt;
&gt;&lt;br&gt;
&gt; Can anyone post the instructions to build under opensolaris?&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;  Well you need to desactivate qemu and lxc builds to avoid this \
error:&lt;br&gt; &lt;br&gt;
./configure --without-lxc --without-qemu ...&lt;br&gt;
&lt;br&gt;
that should be done automatically on non-linux systems, it's a bug,&lt;br&gt;
&lt;br&gt;
Daniel&lt;br&gt;
&lt;font color="#888888"&gt;&lt;br&gt;
--&lt;br&gt;
Daniel Veillard      | libxml Gnome XML XSLT toolkit  &lt;a href="http://xmlsoft.org/" \
target="_blank"&gt;http://xmlsoft.org/&lt;/a&gt;&lt;br&gt; &lt;a href="mailto:daniel@veillard.com" \
target="_blank"&gt;daniel@veillard.com&lt;/a&gt;  | Rpmfind RPM search engine &lt;a \
href="http://rpmfind.net/" target="_blank"&gt;http://rpmfind.net/&lt;/a&gt;&lt;br&gt; &lt;a \
href="http://veillard.com/" target="_blank"&gt;http://veillard.com/&lt;/a&gt; | virtualization \
library  &lt;a href="http://libvirt.org/" target="_blank"&gt;http://libvirt.org/&lt;/a&gt;&lt;br&gt; \
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt; &lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20100427081603</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2010-04-27 08:16:03-0400</timestampReceived><subject>Re: [libvirt-users] Building &amp; Installing on OpenSolaris</subject><body>

On Mon, Apr 26, 2010 at 10:24:33PM -0600, gary mazzaferro wrote:
&gt; Hi all,
&gt; 
&gt; Found my own problem... mpath needs to be disabled.
&gt; 
&gt; This is the current options for configure...
&gt; 
&gt; ./configure ----without-lxc --without-qemu
&gt; 
&gt; Now the make is broken, I don't think there is a linux/params.h  in
&gt; opensolaris. I was able to build under opensolaris...
&gt; 
&gt; Any suggestions ?

  Yup seems both multipath and bridge support need to be desactivated to
build on Solaris,

Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

</body></email><email><emailId>20100427082940</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-04-27 08:29:40-0400</timestampReceived><subject>Re: [libvirt-users] Building &amp; Installing on OpenSolaris</subject><body>

2010/4/27 Daniel Veillard &lt;veillard@redhat.com&gt;:
&gt; On Mon, Apr 26, 2010 at 10:24:33PM -0600, gary mazzaferro wrote:
&gt;&gt; Hi all,
&gt;&gt;
&gt;&gt; Found my own problem... mpath needs to be disabled.
&gt;&gt;
&gt;&gt; This is the current options for configure...
&gt;&gt;
&gt;&gt; ./configure ----without-lxc --without-qemu
&gt;&gt;
&gt;&gt; Now the make is broken, I don't think there is a linux/params.h  in
&gt;&gt; opensolaris. I was able to build under opensolaris...
&gt;&gt;
&gt;&gt; Any suggestions ?
&gt;
&gt;  Yup seems both multipath and bridge support need to be desactivated to
&gt; build on Solaris,
&gt;
&gt; Daniel
&gt;

Totally off-topic... but is there a special reason you write
'desactivated' instead of 'deactivated'? In the other mail I just
accepted it as a typo, but now it looks like a habit :)

Matthias

</body></email><email><emailId>20100410063243</emailId><senderName>Valerio Felici</senderName><senderEmail>valerio@bgweb.it</senderEmail><timestampReceived>2010-04-10 06:32:43-0400</timestampReceived><subject>Re: [libvirt-users] from vmdk to kvm</subject><body>

Il 10/04/2010 08:29, Valerio Felici ha scritto:
&gt; Hi, I will try to explain my case, I hope this is rigth place to do it.
....
&gt; Starting VM, corrisponding on two interfaces declared, vnet1 e vnet2 are
&gt; showed in ifconfig (vnet0 is for another VM) but "brctl showmacs br0"
&gt; don't show their MACs
&gt;
Sorry that was a bit cryptic.
"brctl showmacs br0" shows vnetX MACs, but don't show interfaces MAC.


-- 
A  presto
-Valerio-

</body></email><email><emailId>20100412123245</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2010-04-12 12:32:45-0400</timestampReceived><subject>Re: [libvirt-users] libvirt: C++ or Java?</subject><body>

On Sun, Apr 11, 2010 at 04:19:14PM +0530, Ganesh Pagade wrote:
&gt; Hello,
&gt; 
&gt; I am planning to develop a management application for managing Redhat Xen
&gt; and Redhat KVM hypervisors. I am evaluating the Java bindings versus the C++
&gt; version of libvirt. As part of evaluation, I could not find meaningful
&gt; answers to the questions below. Hence, I thought that people on this mailing
&gt; list would be the most appropriate to comment on them. Can you please let me
&gt; know your views?

  Hum, could you avoid posting the same questions 4 times on the list,
thanks !

&gt; 1. Are all functions that are available in C API available in Java?

  there can be a bit of lag

&gt; 2. Are Java bindings added along with every enhancement to C API?

  those are separate code bases, so no guarantee. Using the C api
is the only way to make sure you have access to the latest features,
Python is usually up to date too as it's included in the main tree
and releases.

&gt; 3. If answer to above question is negative, typically how long does it takes
&gt; for the addition of Java bindings for the enhancement?

  Time for Bryan Kearney to realize the gap and implement it. It goes
faster if he's notified or receive patches of course.

&gt; 4. Most of libvirt based third party management applications use which of
&gt; Java bindings or C API?

 We use python a lot ourselves.

Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

</body></email><email><emailId>20100411131015</emailId><senderName>Avi Weit</senderName><senderEmail>weit@il.ibm.com</senderEmail><timestampReceived>2010-04-11 13:10:15-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt] [LXC] Tyring to locate livbvirt operations for LXC relocation</subject><body>

Hi Daniel,

I wanted to ask on whether virDomainSave/Restore functions of libvirt are
implemented now for the LXC containers? If yes, what libivrt version should
I install please?

Thanks,
- Avi

"Daniel P. Berrange" &lt;berrange@redhat.com&gt; wrote on 04/02/2010 03:44:49 PM:

&gt; From:
&gt;
&gt; "Daniel P. Berrange" &lt;berrange@redhat.com&gt;
&gt;
&gt; To:
&gt;
&gt; Avi Weit/Haifa/IBM@IBMIL
&gt;
&gt; Cc:
&gt;
&gt; libvirt-users@redhat.com
&gt;
&gt; Date:
&gt;
&gt; 04/02/2010 03:45 PM
&gt;
&gt; Subject:
&gt;
&gt; Re: [libvirt-users] [libvirt] [LXC] Tyring to locate livbvirt
&gt; operations for LXC relocation
&gt;
&gt; On Wed, Feb 03, 2010 at 04:03:10PM +0200, Avi Weit wrote:
&gt; &gt;
&gt; &gt; Hello,
&gt; &gt;
&gt; &gt; I am searching for the libvirt operations for relocating LXC (system or
&gt; &gt; application) containers. LXC relocation mechanism is done by
checkpoint /
&gt; &gt; restart. I went over libvirt API documentation and found the following
&gt; &gt; methods:
&gt; &gt;
&gt; &gt; virDomainSave that receives a domain and path to state file. The method
&gt; &gt; saves domain's memory contents into a disk file.
&gt; &gt; virDomainRestore that receives a domain and path to state file. The
method
&gt; &gt; restores the domain from the state file created by save operation.
&gt; &gt;
&gt; &gt; Are these the proper methods to use for LXC relocation? I assume I can
also
&gt; &gt; use the corresponding operations via virsh (save / restore)..
&gt; &gt;
&gt; &gt; &gt;From looking into lxcDriver object (defined
under /src/lxc/xlc_driver.c in
&gt; &gt; libvirt server source) I can see that NULLs are set in save and restore
&gt; &gt; methods. Does that mean that there is no support for saving and
restoring
&gt; &gt; Linux containers? Is there a libvirt patch beyond the kernel patch that
&gt; &gt; needs to be applied?
&gt;
&gt; That is correct - the virDomainSave/Restore functions are intended to
save
&gt; the running guest/container state to a file or load it from a file,
&gt; respectively. These operations have not yet been implemented for
libvirt's
&gt; LXC driver. I'm not sure how mature the kernel support for container
&gt; save/restore is yet, but if it has stabilized sufficiently, then we will
&gt; obviously accept patches from anyone wanting to try implementing...
&gt;
&gt; Daniel
&gt; --
&gt; |: Red Hat, Engineering, London   -o-
http://people.redhat.com/berrange/ :|
&gt; |: http://libvirt.org  -o-  http://virt-manager.org  -o-
http://ovirt.org :|
&gt; |: http://autobuild.org       -o-
http://search.cpan.org/~danberr/ :|
&gt; |: GnuPG: 7D3B9505  -o-  F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B
9505 :|

</body></email><email><emailId>20100411152522</emailId><senderName>"Neil Aggarwal"</senderName><senderEmail>neil@jammconsulting.com</senderEmail><timestampReceived>2010-04-11 15:25:22-0400</timestampReceived><subject>[libvirt-users] virt-top not showing disk and network usage</subject><body>

Hello:

I installed virt-top from epel onto my CentOS 5.4
host running KVM.

When I run virt-top, it shows me the CPU and memory
usage of the VMs, but the disk and network colums
are empty.

I found this page:
http://people.redhat.com/~rjones/virt-top/faq.html

That states it depends on what is supported by
libvirt and the hypervisor.

Is this implemented in KVM?  If not, anyone have
any info on when it will be?

Thanks,
	Neil

--
Neil Aggarwal, (281)846-8957
FREE trial: cPanel VPS with unmetered bandwidth
http://UnmeteredVPS.net/cpanel

</body></email><email><emailId>20100412144946</emailId><senderName>Bryan Kearney</senderName><senderEmail>bkearney@redhat.com</senderEmail><timestampReceived>2010-04-12 14:49:46-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt]  libvirt: C++ or Java?</subject><body>

On 04/12/2010 08:32 AM, Daniel Veillard wrote:
&gt; On Sun, Apr 11, 2010 at 04:19:14PM +0530, Ganesh Pagade wrote:
&gt;&gt; Hello,
&gt;&gt;
&gt;&gt; I am planning to develop a management application for managing Redhat Xen
&gt;&gt; and Redhat KVM hypervisors. I am evaluating the Java bindings versus the C++
&gt;&gt; version of libvirt. As part of evaluation, I could not find meaningful
&gt;&gt; answers to the questions below. Hence, I thought that people on this mailing
&gt;&gt; list would be the most appropriate to comment on them. Can you please let me
&gt;&gt; know your views?
&gt;
&gt;    Hum, could you avoid posting the same questions 4 times on the list,
&gt; thanks !
&gt;
&gt;&gt; 1. Are all functions that are available in C API available in Java?
&gt;
&gt;    there can be a bit of lag
&gt;
&gt;&gt; 2. Are Java bindings added along with every enhancement to C API?
&gt;
&gt;    those are separate code bases, so no guarantee. Using the C api
&gt; is the only way to make sure you have access to the latest features,
&gt; Python is usually up to date too as it's included in the main tree
&gt; and releases.
&gt;
&gt;&gt; 3. If answer to above question is negative, typically how long does it takes
&gt;&gt; for the addition of Java bindings for the enhancement?
&gt;
&gt;    Time for Bryan Kearney to realize the gap and implement it. It goes
&gt; faster if he's notified or receive patches of course.

If you are missing something.. I am happy to push it in. Java is current 
sitting at 0.7.0, so I know I need to update it.

&gt;
&gt;&gt; 4. Most of libvirt based third party management applications use which of
&gt;&gt; Java bindings or C API?
&gt;

RHQ uses the java bindings.

-- bk

</body></email><email><emailId>20100413175716</emailId><senderName>jeremy avnet</senderName><senderEmail>brainsik@saucelabs.com</senderEmail><timestampReceived>2010-04-13 17:57:16-0400</timestampReceived><subject>Re: [libvirt-users] from vmdk to kvm</subject><body>

You should try connecting to the VM via VNC and see what's happening on that
side. The XML you pasted was for a VM not running, when it's running, you'll
see a port defined in &lt;graphics type='vnc' port='-1' autoport='yes'
listen='127.0.0.1'/&gt;.

Did you enter those MAC addresses or did you let libvirt generate them for
you?

.:. jeremy

[Attachment #3 (text/html)]

&lt;font class="Apple-style-span" face="verdana, sans-serif"&gt;You should try connecting \
to the VM via VNC and see what's happening on that side. The XML you pasted was \
for a VM not running, when it's running, you'll see a port defined in  &lt;span \
class="Apple-style-span" style="font-family: arial, sans-serif; font-size: 13px; \
border-collapse: collapse; "&gt;&lt;graphics type='vnc' port='-1' \
autoport='yes' listen='127.0.0.1'/&gt;.&lt;/span&gt;&lt;/font&gt;&lt;div&gt; &lt;font \
class="Apple-style-span" face="arial, sans-serif"&gt;&lt;span class="Apple-style-span" \
style="border-collapse: collapse;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
class="Apple-style-span" face="verdana, sans-serif"&gt;&lt;span class="Apple-style-span" \
style="border-collapse: collapse;"&gt;Did you enter those MAC addresses or did you let \
libvirt generate them for you?&lt;/span&gt;&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font \
class="Apple-style-span" face="verdana, sans-serif"&gt;&lt;span class="Apple-style-span" \
style="border-collapse: collapse;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
class="Apple-style-span" face="verdana, sans-serif"&gt;&lt;span class="Apple-style-span" \
style="border-collapse: collapse;"&gt;.:. jeremy&lt;/span&gt;&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font \
class="Apple-style-span" face="verdana, sans-serif"&gt;&lt;span class="Apple-style-span" \
style="border-collapse: collapse;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;



</body></email><email><emailId>20100416090243</emailId><senderName>Francesco Pretto</senderName><senderEmail>ceztkoml@gmail.com</senderEmail><timestampReceived>2010-04-16 09:02:43-0400</timestampReceived><subject>Re: [libvirt-users] Libvirtd</subject><body>

marwen marwen &lt;marwen.ensi@...&gt; writes:

&gt; 
&gt; hello,
&gt; I'm using libvirt for my project but i have some problem when we
&gt; install it (libvirt)
&gt; can you give me a manual for installation of libvirt and configuration
&gt; of libvirtd
&gt; think you so much
&gt; 


Hi, libvirt is packaged in every modern distribution and you shouldn't find any 
difficulty in installing it by using your package management system. If you 
found troubles in the default installation of libvirt you should probably report 
this to the BTS of your distribution.
The default installation doesn't obviously create any virtual machine (guest, in 
the terms of libvirt). I found very easy to use libvirt in conjunction with 
virt-manager utils, and this ubuntu guide [1] explain how to use it exactly in 
that way. There may be a similar guide for RHEL or fedora. Get the proper 
networking configuration for guests is often a tricker part and I found this 
page very useful [2]. Specific documents in libvirt home site and wiki may help 
you in other topics.

Please moreover consider that libvirt is cool and extremely powerful (and often 
easier to use from the sysadmin perspective) but there may be other 
virtualizations solutions more suitable for you.

Greetings,
Francesco

[1] https://help.ubuntu.com/9.10/serverguide/C/libvirt.html
[2] http://wiki.libvirt.org/page/Networking

</body></email><email><emailId>20100418012348</emailId><senderName>Andreas Ntaflos</senderName><senderEmail>daff@pseudoterminal.org</senderEmail><timestampReceived>2010-04-18 01:23:48-0400</timestampReceived><subject>Re: [libvirt-users] Default network needed?</subject><body>


On Saturday 17 April 2010 17:19:35 Hugh O. Brock wrote:

&gt; Hello Andreas. It's not a naive question at all, but it has a simple
&gt; answer: Yes, you can safely remove it if you haven't attached any VMs
&gt; to it. We set it up strictly as a convenience, mostly for developers
&gt; who are trying to use virt on a laptop with a wifi connection that is
&gt; up and down a lot.

Hugh, 

thank you for the quick and helpful response! Much appreciated.

Andreas
-- 
Andreas Ntaflos 

GPG Fingerprint: 6234 2E8E 5C81 C6CB E5EC  7E65 397C E2A8 090C A9B4

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20100418120127</emailId><senderName>Francesco Pretto</senderName><senderEmail>ceztkoml@gmail.com</senderEmail><timestampReceived>2010-04-18 12:01:27-0400</timestampReceived><subject>Re: [libvirt-users] STP default behavior for bridged (off) and NAT (on) networking in libvirt</subject><body>

2010/4/16 Daniel P. Berrange &lt;berrange@redhat.com&gt;:
&gt;
&gt; Yes, that sounds good to me.
&gt;
&gt; Daniel
&gt;

Done.

</body></email><email><emailId>20100419091628</emailId><senderName>"Frank Peng"</senderName><senderEmail>fpeng@galactic.com.hk</senderEmail><timestampReceived>2010-04-19 09:16:28-0400</timestampReceived><subject>[libvirt-users] That the Linux bridge configuration does not work afer I upgraded the kernel to 2.6.</subject><body>

Hello,
    When I use a standard Redhat kernel, it's ok. Everything's working right. 
    That the Linux bridge configuration does not work afer I upgraded the kernel to
2.6.33.2.
    Why?

[root@node78 ~]# cat /etc/issue
Red Hat Enterprise Linux Server release 5.5 (Tikanga)
Kernel \r on an \m

[root@node78 ~]# uname -a
Linux node78 2.6.33.2 #1 SMP Wed Apr 14 10:10:29 CST 2010 x86_64 x86_64 x86_64 GNU/Linux

[root@node78 ~]# cat /etc/sysconfig/selinux
# This file controls the state of SELinux on the system.
# SELINUX= can take one of these three values:
# enforcing - SELinux security policy is enforced.
# permissive - SELinux prints warnings instead of enforcing.
# disabled - SELinux is fully disabled.
SELINUX=disabled
# SELINUXTYPE= type of policy in use. Possible values are:
# targeted - Only targeted network daemons are protected.
# strict - Full SELinux protection.
SELINUXTYPE=targeted

[root@node78 ~]# iptables -L
Chain INPUT (policy ACCEPT)
target prot opt source destination

Chain FORWARD (policy ACCEPT)
target prot opt source destination

Chain OUTPUT (policy ACCEPT)
target prot opt source destination

[root@node78 ~]# cat /etc/sysconfig/network-scripts/ifcfg-eth0
# Intel Corporation 80003ES2LAN Gigabit Ethernet Controller (Copper)
DEVICE=eth0
HWADDR=00:15:17:11:16:18
BRIDGE=br0
NM_CONTROLLED=no
ONBOOT=yes

[root@node78 ~]# cat /etc/sysconfig/network-scripts/ifcfg-br0
DEVICE=br0
TYPE=Bridge
BOOTPROTO=static
BROADCAST=192.168.0.255
IPADDR=192.168.0.78
NETMASK=255.255.255.0
NETWORK=192.168.0.0
DELAY=0
NM_CONTROLLED=no
ONBOOT=yes

[root@node78 ~]#cd /usr/src/
[root@node78 ~]#tar jxf linux-2.6.33.2.tar.bz2
[root@node78 ~]#ln -s linux-2.6.33.2 linux
[root@node78 ~]#cd linux
[root@node78 ~]#cp /boot/config-2.6.18-164.el5 /usr/src/linux-2.6.33.2/.config
[root@node78 ~]#make menuconfig
(add the option "enable deprecated sysfs feathures to support old userspace tools")
[root@node78 ~]#make &amp;&amp; make modules &amp;&amp; make modules_install &amp;&amp; make install


[root@node78 ~]# ifconfig
br0 Link encap:Ethernet HWaddr 00:15:17:11:16:18
inet addr:192.168.0.78 Bcast:192.168.0.255 Mask:255.255.255.0
inet6 addr: fe80::215:17ff:fe11:1618/64 Scope:Link
UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1
RX packets:7217 errors:0 dropped:0 overruns:0 frame:0
TX packets:273 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:0
RX bytes:738606 (721.2 KiB) TX bytes:36168 (35.3 KiB)

eth0 Link encap:Ethernet HWaddr 00:15:17:11:16:18
inet6 addr: fe80::215:17ff:fe11:1618/64 Scope:Link
UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1
RX packets:7490 errors:0 dropped:0 overruns:0 frame:0
TX packets:304 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:100
RX bytes:866112 (845.8 KiB) TX bytes:42312 (41.3 KiB)
Memory:b8820000-b8840000

eth1 Link encap:Ethernet HWaddr 00:15:17:11:16:19
inet addr:10.0.7.78 Bcast:10.255.255.255 Mask:255.0.0.0
inet6 addr: fe80::215:17ff:fe11:1619/64 Scope:Link
UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1
RX packets:4 errors:0 dropped:0 overruns:0 frame:0
TX packets:59 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:1000
RX bytes:1056 (1.0 KiB) TX bytes:10982 (10.7 KiB)
Memory:b8800000-b8820000

lo Link encap:Local Loopback
inet addr:127.0.0.1 Mask:255.0.0.0
inet6 addr: ::1/128 Scope:Host
UP LOOPBACK RUNNING MTU:16436 Metric:1
RX packets:1831 errors:0 dropped:0 overruns:0 frame:0
TX packets:1831 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:0
RX bytes:3576260 (3.4 MiB) TX bytes:3576260 (3.4 MiB)

[root@node78 ~]# ifconfig vmbr0
vmbr0: error fetching interface information: Device not found

Best Regards,
Frank

</body></email><email><emailId>20100419210534</emailId><senderName>Andreas Ntaflos</senderName><senderEmail>daff@pseudoterminal.org</senderEmail><timestampReceived>2010-04-19 21:05:34-0400</timestampReceived><subject>Re: [libvirt-users] Restarting network on host completely cuts off guests. Why? How to prevent?</subject><body>


On Monday 19 April 2010 15:02:59 Chris Lalancette wrote:
&gt; On 04/17/2010 09:38 PM, Andreas Ntaflos wrote:
&gt; &gt; Hi list,
&gt; &gt; 
&gt; &gt; this probably isn't a completely libvirt-specific question but I'll
&gt; &gt; try anyway. Please ignore if it is too much off-topic.
&gt; &gt; 
&gt; &gt; On an Ubuntu (9.10) virtualisation host, running KVM and libvirt
&gt; &gt; and several guests (Debian, Ubuntu, Windows Server 2003) in a
&gt; &gt; bridged network fashion [1,2] I noticed that performing
&gt; &gt; 
&gt; &gt; /etc/init.d/networking restart
&gt; &gt; 
&gt; &gt; on the host completely cuts off all guests from the network. I have
&gt; &gt; to manually shutdown and restart (virsh shutdown GUEST &amp;&amp; virsh
&gt; &gt; start GUEST, a mere reboot doesn't suffice) them to get them onto
&gt; &gt; the network again. Obviously that's not ideal.
&gt; &gt; 
&gt; &gt; Is this the expected behaviour? Can I somehow re-establish guest
&gt; &gt; network connectivity without shutting down the guest first? Is my
&gt; &gt; setup somehow wrong or do I expect too much?
&gt; 
&gt; Unfortunately, that is the expected behavior.  If you do:

Hi, 

thank you for the clarification and confirmation. I'll be keeping it in 
mind. Hopefully libvirt will someday support restarting the network; 
unfortunately there isn't much I can do to help except testing.

Thanks, 

Andreas
-- 
Andreas Ntaflos 

GPG Fingerprint: 6234 2E8E 5C81 C6CB E5EC  7E65 397C E2A8 090C A9B4

["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20100420200806</emailId><senderName>"Wang David"</senderName><senderEmail>david_wang@prn.com</senderEmail><timestampReceived>2010-04-20 20:08:06-0400</timestampReceived><subject>Re: [libvirt-users] Need help using libvirt with qcow2 delta and base images</subject><body>

Jeremy,

Thank you so much for resolving my problem ;)  The AppArmor configuration fix worked. \
I am sure that you have saved me many more days of research.  It looks like I have to \
research this AppArmor business.

Thanks!
-dave
________________________________________
From: jeremy avnet [mailto:brainsik@saucelabs.com] 
Sent: Tuesday, April 20, 2010 11:46 AM
To: Wang David
Cc: libvirt-users@redhat.com
Subject: Re: [libvirt-users] Need help using libvirt with qcow2 delta and base images

On Tue, Apr 20, 2010 at 11:01 AM, Wang David &lt;David_Wang@prn.com&gt; wrote:
Apr 19 17:27:36 virtualserver3 kernel: [14202.411373] type=1503 \
audit(1271723256.513:75): operation="open" pid=3147 parent=1 \
profile="libvirt-20030353-cdee-109a-1abb-dc4971d036c2" requested_mask="r::" \
denied_mask="r::" fsuid=0 ouid=0 \
                name="/data/virtual/var/lib/libvirt/images/ubuntu910server64.qcow2"
Apr 19 17:27:36 virtualserver3 libvirtd: 17:27:36.718: error : \
qemudWaitForMonitor:1103 : internal error unable to start guest: qemu: could not open \
disk image /var/lib/libvirt/images/ubuntu910server64_delta.qcow2#012  
These indicate that AppArmor is denying access to the backing store, thus, your delta \
image will not work.

You're going to need add a rule into /etc/apparmor.d/abstractions/libvirt-qemu so \
that the backing store can be read. Something like:

  /data/virtual/var/lib/libvirt/images/ubuntu910server64.qcow2 r,

or 

  /data/virtual/var/lib/libvirt/images/* r,

.:. jeremy


</body></email><email><emailId>20100421091117</emailId><senderName>"Tej Parkash, ERS, HCLTech"</senderName><senderEmail>tej.parkash@hcl.in</senderEmail><timestampReceived>2010-04-21 09:11:17-0400</timestampReceived><subject>[libvirt-users]  New Snapshot API Not working</subject><body>

All, 

I have compiled new libvirt library 0.8.0. Compilation and installation went really \
fine except "make check" which has show some test got failed.  Here is what make \
check said.

Failed Test:

---------------snip-----------
PASS: statstest
TEST: qparamtest
      ................................         32  OK
PASS: qparamtest
TEST: capabilityschematest
      !!!!!!!!!!!!                             12  FAILED
FAIL: capabilityschematest
TEST: interfaceschematest
      !!!!!!!!!!!!!!!!!!                       18  FAILED
FAIL: interfaceschematest
TEST: networkschematest
      !!!!!!!!!!!                              11  FAILED
FAIL: networkschematest
TEST: storagepoolschematest
      !!!!!!!!!!!!!!!!!!!!                     20  FAILED
FAIL: storagepoolschematest
TEST: storagevolschematest
      !!!!!!!!!!!!                             12  FAILED
FAIL: storagevolschematest
TEST: domainschematest
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! 40 
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! 80 
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! 120
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! 160
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! 200
      !!                                       202 FAILED
FAIL: domainschematest
TEST: nodedevschematest
      !!!!!!!!!!!!!!                           14  FAILED
FAIL: nodedevschematest
TEST: nwfilterschematest
      !!!!!!!!!!!!!!!!!!!!!!!!!!!              27  FAILED
FAIL: nwfilterschematest
TEST: test_conf.sh
      ..                                       2   OK
---------------- snip ---------------------------

====================
9 of 40 tests failed
====================
make[3]: *** [check-TESTS] Error 1
make[3]: Leaving directory `/tmp/libvirt-0.8.0/tests'
make[2]: *** [check-am] Error 2
make[2]: Leaving directory `/tmp/libvirt-0.8.0/tests'
make[1]: *** [check-recursive] Error 1
make[1]: Leaving directory `/tmp/libvirt-0.8.0/tests'
make: *** [check-recursive] Error 1
-------------------------------------------------------------------------

However installation went fine. 

After I started create some snapshot, I am getting some remote error:

root@hcl:~# xm li
Name                                        ID   Mem VCPUs      State   Time(s)
Domain-0                                     0   622     2     r-----   1755.3
Test                                         3   256     1     -b----      4.4
root@hcl:~# virsh snapshot-create 3
error: unmarshalling remote_error

root@hcl:~# virsh snapshot-create 3 test.xml 
error: unmarshalling remote_error

I have even written a C code with API's but same problem. 

Here is livirt version n all 
root@hcl:/tmp/libvirt-0.8.0# libvirtd --version
libvirtd (libvirt) 0.8.0
root@hcl:/tmp/libvirt-0.8.0# virsh -v
0.8.0
root@hcl:/tmp/libvirt-0.8.0# 


Any Idea????????????????
Any suggestion???????/




Thanks
Tej


DISCLAIMER:
-----------------------------------------------------------------------------------------------------------------------


The contents of this e-mail and any attachment(s) are confidential and intended for \
the named recipient(s) only.  It shall not attach any liability on the originator or \
HCL or its affiliates. Any views or opinions presented in  this email are solely \
those of the author and may not necessarily reflect the opinions of HCL or its \
affiliates.  Any form of reproduction, dissemination, copying, disclosure, \
modification, distribution and / or publication of  this message without the prior \
written consent of the author of this e-mail is strictly prohibited. If you have  \
received this email in error please delete it and notify the sender immediately. \
Before opening any mail and  attachments please check them for viruses and defect.

-----------------------------------------------------------------------------------------------------------------------



</body></email><email><emailId>20100421131651</emailId><senderName>Povilas</senderName><senderEmail>povilo-lists@daukintis.lt</senderEmail><timestampReceived>2010-04-21 13:16:51-0400</timestampReceived><subject>[libvirt-users] Question about libvirt general storage driver/framework</subject><body>

Hello,

I have setup consisting of few nodes dedicated to virtualisation and
shared storage application. For running virtual machines we are using
KVM, and libvirt to manage them. Also, I am trying to setup some tools
for managing storage volumes.

I know about libvirt storage pools and existing storage volumes
support, but what I would like to see in libvirt is generic storage
driver (ideally it could depend on external application or script), or
some framework for managing storage.

Now we are testing NBD setup, and for some reasons I don't want to use
kvm-nbd. We would like to use custom nbd client and manage block
device creation/deletion for ourselves. Maybe in future we will use
iSCSI instead of NBD, so platform/transport agnostic framework or
driver would be very helpful.

I've searched and read both mailing lists (libvir-list and
libvirt-users), and have found that some libvirt users were asking for
similar or same feature. E.g :
https://www.redhat.com/archives/libvir-list/2009-August/msg00348.html

So, the main question is: maybe there is some progress already done or
someone is thinking about working on it ?


--
Regards,
Povilas

</body></email><email><emailId>20100421140552</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2010-04-21 14:05:52-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt] New VM Snapshot API Not working</subject><body>

On 04/21/2010 07:34 AM, Tej Parkash, ERS, HCLTech wrote:
&gt; All, 
&gt; 
&gt; Ok, I got it working.....
&gt; 
&gt; Problem was that I didnt include xen option for configure step.
&gt; But looks like Xen Hypervisor does not have support of Snapshot.  :(
&gt; 
&gt; I guess I have to fall back to save and restore method...

Ah, I see that you figured out the problem.  OK.  There is still a
bug in that you should not have seen the "remote marshalling" error;
we'll have to track that down.  And as you found out, we don't have
support for snapshots in the Xen hypervisor driver.  If Xen itself
supports snapshots (does it?), then patches to implement this are
welcome.

-- 
Chris Lalancette

</body></email><email><emailId>20100419165545</emailId><senderName>"Tim McLeod"</senderName><senderEmail>tim.mcleod@simulamen.eu</senderEmail><timestampReceived>2010-04-19 16:55:45-0400</timestampReceived><subject>[libvirt-users] Libvirt Compilation on MS Vista</subject><body>

Does a comprehensive set of instructions on how to compile Libvirt on a
Microsoft Vista platform exist?  Has this ever been accomplished?  I would
very much appreciate input from persons who can give me confidence that a
Windows client application can be developed on top of Libviet that connects
to a QEMU system on an Ubuntu server.  The Libvirt Windows Support page
(http://libvirt.org/windows.html) implies the exercise is trivial.  Over the
last three weeks of failure I have come to find this assertion extremely
amusing.

 

Tim McLeod

Simulamen Limited

Registered in England No: 7133731

 


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;meta http-equiv=Content-Type content="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 12 (filtered medium)"&gt;
&lt;style&gt;
&lt;!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page Section1
	{size:612.0pt 792.0pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;}
div.Section1
	{page:Section1;}
--&gt;
&lt;/style&gt;
&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapelayout v:ext="edit"&gt;
  &lt;o:idmap v:ext="edit" data="1" /&gt;
 &lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
&lt;/head&gt;

&lt;body lang=EN-GB link=blue vlink=purple&gt;

&lt;div class=Section1&gt;

&lt;p class=MsoNormal&gt;Does a comprehensive set of instructions on how to compile
Libvirt on a Microsoft Vista platform exist? Has this ever been \
accomplished? I would very much appreciate input from persons who can give me \
confidence that a Windows client application can be developed on top of Libviet that \
connects to a QEMU system on an Ubuntu server. The Libvirt Windows Support page \
(http://libvirt.org/windows.html) implies the exercise is trivial. Over the \
last three weeks of failure I have come to find this assertion extremely \
amusing.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span lang=EN-CA&gt;Tim McLeod&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span lang=EN-CA&gt;Simulamen Limited&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span lang=EN-CA&gt;Registered in England No: \
7133731&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;



</body></email><email><emailId>20100427073645</emailId><senderName>Mick Pollard</senderName><senderEmail>lists@lunix.com.au</senderEmail><timestampReceived>2010-04-27 07:36:45-0400</timestampReceived><subject>[libvirt-users] ruby-libvirt equiv of virsh list --all</subject><body>

Hi all,

I have a working KVM system managed with virsh and virt-install.  
I am currently playing with ruby-libvirt-0.1.0.  
I am wanting to build a simple sinatra/ruby app to show the VE's on a node and their \
state.   I have ruby 1.8.5 on CentOS 5.4.  

I have the basics of it worked out but am a little stuck.  
Is there a way of retrieving a list of all VM's on a host using ruby-libvirt. ie: \
virsh list --all ?  

    @conn.list_defined_domains only shows VE's not started (lists VE names)
    @conn.list_domains only shows VE's running (lists VE id's)

What I ultimately would like is to retrieve a full list of the uuid's of all defined \
VE's(running or not).  




-- 
Regards
Mick Pollard ( lunix )
------------------------------------------------
BOFH Excuse of the day:
Extraneous Configuration Invalidation


</body></email><email><emailId>20100429112917</emailId><senderName>Tom Hughes</senderName><senderEmail>tom@compton.nu</senderEmail><timestampReceived>2010-04-29 11:29:17-0400</timestampReceived><subject>[libvirt-users] Cloning very slow?</subject><body>

Yesterday I cloned one of my VMs and, somewhat implausibly, it took 
virt-clone something like 8-9 hours to clone the 8Gb disk image... 
Copying it from the command line took a mere 6.5 minutes.

I assume this is a bug, and it's not expected to take this long ;-)

This was using virt-clone from python-virtinst-0.500.2-1.fc12.noarch in 
the virt-preview repository.

Tom

-- 
Tom Hughes (tom@compton.nu)
http://compton.nu/

</body></email><email><emailId>20100428193821</emailId><senderName>"Tim McLeod"</senderName><senderEmail>tim.mcleod@simulamen.eu</senderEmail><timestampReceived>2010-04-28 19:38:21-0400</timestampReceived><subject>[libvirt-users] Windows Client</subject><body>

Having newly compiled a Libvirt on a Windows Vista machine (many thanks to
Matthias Bolte) I have attempted to connect to a remote Ubuntu machine using
virsh.exe.  However, the connection fails as follows:

 

$ virsh -c qemu+tcp:///system

error: unable to connect to libvirtd at 'localhost': errno=10061

error: failed to connect to the hypervisor

 

1.  I have modified /etc/libvirt/libvirt.conf to set listen_tcp=1.

2.  I cannot find /etc/sysconfig/libvirtd so I am unable to set
LIBVIRTD_ARGS="--listen".

 

As stated on a previous post, my background is Windows rather than Linux, so
I am at a loss as to know where to look next.  I would very much appreciate
some guidance.  Many thanks in anticipation...

 

Tim McLeod

 


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;meta http-equiv=Content-Type content="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 12 (filtered medium)"&gt;
&lt;style&gt;
&lt;!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page Section1
	{size:612.0pt 792.0pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;}
div.Section1
	{page:Section1;}
--&gt;
&lt;/style&gt;
&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapelayout v:ext="edit"&gt;
  &lt;o:idmap v:ext="edit" data="1" /&gt;
 &lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
&lt;/head&gt;

&lt;body lang=EN-GB link=blue vlink=purple&gt;

&lt;div class=Section1&gt;

&lt;p class=MsoNormal&gt;Having newly compiled a Libvirt on a Windows Vista machine (many
thanks to Matthias Bolte) I have attempted to connect to a remote Ubuntu
machine using virsh.exe. However, the connection fails as \
follows:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;$ virsh -c qemu+tcp:///system&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;error: unable to connect to libvirtd at 'localhost':
errno=10061&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;error: failed to connect to the hypervisor&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;1. I have modified /etc/libvirt/libvirt.conf to set \
listen_tcp=1.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;2. I cannot find /etc/sysconfig/libvirtd so I am
unable to set LIBVIRTD_ARGS="--listen".&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;As stated on a previous post, my background is Windows rather
than Linux, so I am at a loss as to know where to look next. I would very
much appreciate some guidance. Many thanks in anticipation...&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Tim McLeod&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;



</body></email><email><emailId>20100428210711</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2010-04-28 21:07:11-0400</timestampReceived><subject>Re: [libvirt-users] Windows Client</subject><body>

On 04/28/2010 03:38 PM, Tim McLeod wrote:
&gt; Having newly compiled a Libvirt on a Windows Vista machine (many thanks
&gt; to Matthias Bolte) I have attempted to connect to a remote Ubuntu
&gt; machine using virsh.exe.  However, the connection fails as follows:
&gt; 
&gt;  
&gt; 
&gt; $ virsh -c qemu+tcp:///system

Well, you have two problems.  The first is that this URI is trying
to connect to the localhost; you need to specify which host you want
to connect to:

$ virsh -c qemu+tcp://ubuntu-host.example.com/system

The second problem...

&gt; 1.  I have modified /etc/libvirt/libvirt.conf to set listen_tcp=1.
&gt; 
&gt; 2.  I cannot find /etc/sysconfig/libvirtd so I am unable to set
&gt; LIBVIRTD_ARGS="--listen".

...is that this setup is not enough.  When using TCP, by default, we
require authentication/encryption to be done via SASL (kerberos).  Your
best bet for production use is going to be to setup TLS (meaning you have
to setup certificates on the destination machine) or setup SASL (meaning
you have to setup sasl on the destination machine).  Instructions for
generating certificates are here:

http://libvirt.org/remote.html#Remote_certificates

(unfortunately setting up SASL is a bit baroque, and I don't remember all
of the ins and outs of it at the moment)

If you just want to *test* using plain TCP, then you'll have to change
auth_tcp = "sasl" to auth_tcp = "none" (and uncomment it) in /etc/libvirt/libvirtd.conf
on the destination machine (though we don't recommend this setup).

-- 
Chris Lalancette

</body></email><email><emailId>20100428213609</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-04-28 21:36:09-0400</timestampReceived><subject>Re: [libvirt-users] Windows Client</subject><body>

2010/4/28 Tim McLeod &lt;tim.mcleod@simulamen.eu&gt;:
&gt; Having newly compiled a Libvirt on a Windows Vista machine (many thanks to
&gt; Matthias Bolte)

Nine :)

&gt; I have attempted to connect to a remote Ubuntu machine using
&gt; virsh.exe.  However, the connection fails as follows:
&gt;
&gt;
&gt;
&gt; $ virsh -c qemu+tcp:///system

You need to specify the server in this URI using a hostname or IP
address: qemu+tcp://ubuntu-server.com/system

&gt; error: unable to connect to libvirtd at 'localhost': errno=10061
&gt;
&gt; error: failed to connect to the hypervisor
&gt;
&gt;
&gt;
&gt; 1.  I have modified /etc/libvirt/libvirt.conf to set listen_tcp=1.

You also need to change this

   #auth_tcp = "sasl"

to

   auth_tcp = "none"

to disable SASL authentication/encryption for TCP connections, because
your libvirt on Windows is compiled without SASL support. If you need
the libvirt connections to be encrypted you can switch from TCP to TLS
connections using: qemu+tls://ubuntu-server.com/system

&gt; 2.  I cannot find /etc/sysconfig/libvirtd so I am unable to set
&gt; LIBVIRTD_ARGS="--listen".
&gt;

For Ubuntu packaged libvirt see /etc/default/libvirt-bin and change

   libvirtd_opts="-d"

to

   libvirtd_opts="-d -l"

as the comment suggest and restart libvirtd using

   /etc/init.d/libvirt-bin restart

Now you should be able to connect to the libvirtd on your Ubuntu server.

Matthias

</body></email><email><emailId>20100428213815</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-04-28 21:38:15-0400</timestampReceived><subject>Re: [libvirt-users] Windows Client</subject><body>

2010/4/28 Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;:
&gt; 2010/4/28 Tim McLeod &lt;tim.mcleod@simulamen.eu&gt;:
&gt;&gt; Having newly compiled a Libvirt on a Windows Vista machine (many thanks to
&gt;&gt; Matthias Bolte)
&gt;
&gt; Nine :)
&gt;

I meant to write "Nice :)".

Matthias

</body></email><email><emailId>20100429113015</emailId><senderName>Tom Hughes</senderName><senderEmail>tom@compton.nu</senderEmail><timestampReceived>2010-04-29 11:30:15-0400</timestampReceived><subject>Re: [libvirt-users] Cloning very slow?</subject><body>

On 29/04/10 12:29, Tom Hughes wrote:

&gt; Yesterday I cloned one of my VMs and, somewhat implausibly, it took
&gt; virt-clone something like 8-9 hours to clone the 8Gb disk image...
&gt; Copying it from the command line took a mere 6.5 minutes.

Apologies, I meant to send this to fedora-virt...

Tom

-- 
Tom Hughes (tom@compton.nu)
http://compton.nu/

</body></email><email><emailId>20100427140215</emailId><senderName>Chris Lalancette</senderName><senderEmail>clalance@redhat.com</senderEmail><timestampReceived>2010-04-27 14:02:15-0400</timestampReceived><subject>Re: [libvirt-users] ruby-libvirt equiv of virsh list --all</subject><body>

On 04/27/2010 03:36 AM, Mick Pollard wrote:
&gt; Hi all,
&gt; 
&gt; I have a working KVM system managed with virsh and virt-install.  
&gt; I am currently playing with ruby-libvirt-0.1.0.  
&gt; I am wanting to build a simple sinatra/ruby app to show the VE's on a node and \
&gt; their state.   I have ruby 1.8.5 on CentOS 5.4.  
&gt; 
&gt; I have the basics of it worked out but am a little stuck.  
&gt; Is there a way of retrieving a list of all VM's on a host using ruby-libvirt. ie: \
&gt; virsh list --all ?   
&gt; @conn.list_defined_domains only shows VE's not started (lists VE names)
&gt; @conn.list_domains only shows VE's running (lists VE id's)
&gt; 
&gt; What I ultimately would like is to retrieve a full list of the uuid's of all \
&gt; defined VE's(running or not).  

The ruby-libvirt library is just a thin wrapper around the libvirt API's.
In point of fact, if you look at the libvirt API's (and virsh), you'll see
that all virsh does is to take the two lists it gets back from list_defined_domains
and list_domains, and concatenate them.  So in ruby, you would do something similar
to get the whole list, and then you'd have to iterate through each of them, dump
the XML, and get the UUID out of it.

-- 
Chris Lalancette


</body></email><email><emailId>20100419171803</emailId><senderName>"Development"</senderName><senderEmail>development@simulamen.eu</senderEmail><timestampReceived>2010-04-19 17:18:03-0400</timestampReceived><subject>[libvirt-users] Libvirt Compilation on MS Vista</subject><body>

Does a comprehensive set of instructions on how to compile Libvirt on a
Microsoft Vista platform exist?  Has this ever been accomplished?  I would
very much appreciate input from persons who can give me confidence that a
Windows client application can be developed on top of Libvirt that connects
to a QEMU system on an Ubuntu server.  The Libvirt Windows Support page
(http://libvirt.org/windows.html) implies the exercise is trivial.  Over the
last three weeks of failure I have come to find this assertion extremely
amusing.

 

Tim McLeod

Simulamen Limited

Registered in England No: 7133731


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 12 (filtered medium)"&gt;
&lt;style&gt;
&lt;!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page Section1
	{size:612.0pt 792.0pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;}
div.Section1
	{page:Section1;}
--&gt;
&lt;/style&gt;
&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapelayout v:ext="edit"&gt;
  &lt;o:idmap v:ext="edit" data="1" /&gt;
 &lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
&lt;/head&gt;

&lt;body lang=EN-GB link=blue vlink=purple&gt;

&lt;div class=Section1&gt;

&lt;p class=MsoNormal&gt;Does a comprehensive set of instructions on how to compile
Libvirt on a Microsoft Vista platform exist? Has this ever been
accomplished? I would very much appreciate input from persons who can
give me confidence that a Windows client application can be developed on top of
Libvirt that connects to a QEMU system on an Ubuntu server. The Libvirt
Windows Support page (&lt;a \
href="http://libvirt.org/windows.html"&gt;http://libvirt.org/windows.html&lt;/a&gt;) implies \
the exercise is trivial. Over the last three weeks of failure I have come to \
find this assertion extremely amusing.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span lang=EN-CA&gt;Tim McLeod&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span lang=EN-CA&gt;Simulamen Limited&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;span lang=EN-CA&gt;Registered in England No: \
7133731&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;



</body></email><email><emailId>20100419215149</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-04-19 21:51:49-0400</timestampReceived><subject>Re: [libvirt-users] Libvirt Compilation on MS Vista</subject><body>

2010/4/19 Tim McLeod &lt;tim.mcleod@simulamen.eu&gt;:
&gt; Does a comprehensive set of instructions on how to compile Libvirt on a
&gt; Microsoft Vista platform exist?  Has this ever been accomplished?  I would
&gt; very much appreciate input from persons who can give me confidence that a
&gt; Windows client application can be developed on top of Libviet that connects
&gt; to a QEMU system on an Ubuntu server.  The Libvirt Windows Support page
&gt; (http://libvirt.org/windows.html) implies the exercise is trivial.  Over the
&gt; last three weeks of failure I have come to find this assertion extremely
&gt; amusing.
&gt;

Compiling libvirt for Windows in not very well documented. You can use
the mingw32 cross-compile toolchain provided by Fedora. I think
several people build libvirt for Windows this way.

Another option is to use MinGW and MSYS on Windows to compile libvirt
for Windows. I did that successfully.

So before I start to describe the setup/compilation process and so
on... could you describe what your current setup looks like and what
problems you're facing?

Matthias

</body></email><email><emailId>20100421133827</emailId><senderName>"Development"</senderName><senderEmail>development@simulamen.eu</senderEmail><timestampReceived>2010-04-21 13:38:27-0400</timestampReceived><subject>Re: [libvirt-users] Libvirt Compilation on MS Vista</subject><body>


Matthias,

Thank you for the swift response.  Now, the current state is the result of following \
the instructions found a la Web in the attached 'print to PDF' file.  Situation as \
follows:

1.  MinGW.  MinGW-5.1.4.exe installed without error; no issues.
2.  MSYS.  Failed to locate the executable MSYS-1.0.11-2004.04.30-1.exe, but \
MSYS-1.0.11.exe did install without error. 3.  msysDTK.  msysDTK-1.0.1.exe installed \
without error; no issues. 4.  GTK.  gtk-dev-2.12.9-win32-2.exe installed without \
error; no issues. 5.  M4.  Failed to locate compressed file m4-1.4.7-MSYS.tar.bz2, \
used m4-1.4.13-1-msys-1.0.11-bin.tar.lzma instead.  Did not understand instruction to \
extract to the 'root' folder but instead replaced the original M4.exe found in \
C:\MSYS\1.0\bin with the M4.exe found in the lzma file. 6.  Autoconf.  Failed to \
'make' source found in autoconf-2.62.tar.gz due to a '[m4sugar.m4f] Error 1' error, \
but following a reference found on the Web to this error not occurring in \
autoconf-2.52.tar.gz, successfully 'made' and installed this version.  When moving on \
to step 7, Automake, compilation failed since autoconf 2.6 or newer was required.  \
However, autoconf-2.60.tar.gz failed with the 'm4sugar.m4f' error in the same way as \
v2.62.

Brick wall; sore head!  As I'm sure you have guessed my background is MS Windows \
rather than Linux so I am finding these issues, probably minor to you, extremely \
daunting and frustrating to me.  I am encouraged that you have successfully compiled \
a Windows Libvirt client, hope you can point me in the right direction.  Many \
thanks...

Tim

-----Original Message-----
From: Matthias Bolte [mailto:matthias.bolte@googlemail.com] 
Sent: 19 April 2010 15:52
To: tim.mcleod@simulamen.eu
Cc: libvirt-users@redhat.com
Subject: Re: [libvirt-users] Libvirt Compilation on MS Vista

2010/4/19 Tim McLeod &lt;tim.mcleod@simulamen.eu&gt;:
&gt; Does a comprehensive set of instructions on how to compile Libvirt on a
&gt; Microsoft Vista platform exist?  Has this ever been accomplished?  I would
&gt; very much appreciate input from persons who can give me confidence that a
&gt; Windows client application can be developed on top of Libviet that connects
&gt; to a QEMU system on an Ubuntu server.  The Libvirt Windows Support page
&gt; (http://libvirt.org/windows.html) implies the exercise is trivial.  Over the
&gt; last three weeks of failure I have come to find this assertion extremely
&gt; amusing.
&gt; 

Compiling libvirt for Windows in not very well documented. You can use
the mingw32 cross-compile toolchain provided by Fedora. I think
several people build libvirt for Windows this way.

Another option is to use MinGW and MSYS on Windows to compile libvirt
for Windows. I did that successfully.

So before I start to describe the setup/compilation process and so
on... could you describe what your current setup looks like and what
problems you're facing?

Matthias


["Libvirt Compilation 2010-04-19.pdf" (application/pdf)]

</body></email><email><emailId>20100421141353</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-04-21 14:13:53-0400</timestampReceived><subject>Re: [libvirt-users] Libvirt Compilation on MS Vista</subject><body>

[Let's keep the list involved]

2010/4/20 Tim McLeod &lt;tim.mcleod@simulamen.eu&gt;:
&gt; Matthias,
&gt; 
&gt; Thank you for the swift response.  Now, the current state is the result of \
&gt; following the instructions found a la Web in the attached 'print to PDF' file.  \
&gt; Situation as follows: 
&gt; 1.  MinGW.  MinGW-5.1.4.exe installed without error; no issues.
&gt; 2.  MSYS.  Failed to locate the executable MSYS-1.0.11-2004.04.30-1.exe, but \
&gt; MSYS-1.0.11.exe did install without error. 3.  msysDTK.  msysDTK-1.0.1.exe \
&gt; installed without error; no issues. 4.  GTK.  gtk-dev-2.12.9-win32-2.exe installed \
&gt; without error; no issues. 5.  M4.  Failed to locate compressed file \
&gt; m4-1.4.7-MSYS.tar.bz2, used m4-1.4.13-1-msys-1.0.11-bin.tar.lzma instead.  Did not \
&gt; understand instruction to extract to the 'root' folder but instead replaced the \
&gt; original M4.exe found in C:\MSYS\1.0\bin with the M4.exe found in the lzma file. 6. \
&gt; Autoconf.  Failed to 'make' source found in autoconf-2.62.tar.gz due to a \
&gt; '[m4sugar.m4f] Error 1' error, but following a reference found on the Web to this \
&gt; error not occurring in autoconf-2.52.tar.gz, successfully 'made' and installed this \
&gt; version.  When moving on to step 7, Automake, compilation failed since autoconf 2.6 \
&gt; or newer was required.  However, autoconf-2.60.tar.gz failed with the 'm4sugar.m4f' \
&gt; error in the same way as v2.62. 
&gt; Brick wall; sore head!  As I'm sure you have guessed my background is MS Windows \
&gt; rather than Linux so I am finding these. Probably minor issues to you, extremely \
&gt; daunting and frustrating to me.  I am encouraged that you have successfully \
&gt; compiled a Windows Libvirt client, hope you can point me in the right direction.  \
&gt; Many thanks... 
&gt; Tim
&gt; 

Okay, so the problem is setting up a working MinGW/MSYS environment.
You used the instructions posted here:
https://www.redhat.com/archives/libvir-list/2008-June/msg00145.html

I didn't try that, but I wrote a set of scripts to automate the
MinGW/MSYS setup and libvirt compliation on Windows. I'll clean them
up a bit and post them, so you can try to use them.

Probably we should also improve http://libvirt.org/windows.html with
more details.

Matthias


</body></email><email><emailId>20100426144104</emailId><senderName>"Tim McLeod"</senderName><senderEmail>tim.mcleod@simulamen.eu</senderEmail><timestampReceived>2010-04-26 14:41:04-0400</timestampReceived><subject>Re: [libvirt-users] Libvirt Compilation on MS Vista</subject><body>

Matthias,

Polite enquiry on the progress of tidying up scripts to automate the MinGW/MSYS setup \
and libvirt compilation on Windows, if I may?  Not meaning to appear impatient, but I \
would like to give my client some indication of when I can meet my deliverables.  \
Many thanks...

Tim

-----Original Message-----
From: Matthias Bolte [mailto:matthias.bolte@googlemail.com] 
Sent: 21 April 2010 08:14
To: tim.mcleod@simulamen.eu
Cc: libvirt-users@redhat.com
Subject: Re: [libvirt-users] Libvirt Compilation on MS Vista

[Let's keep the list involved]

2010/4/20 Tim McLeod &lt;tim.mcleod@simulamen.eu&gt;:
&gt; Matthias,
&gt; 
&gt; Thank you for the swift response.  Now, the current state is the result of \
&gt; following the instructions found a la Web in the attached 'print to PDF' file.  \
&gt; Situation as follows: 
&gt; 1.  MinGW.  MinGW-5.1.4.exe installed without error; no issues.
&gt; 2.  MSYS.  Failed to locate the executable MSYS-1.0.11-2004.04.30-1.exe, but \
&gt; MSYS-1.0.11.exe did install without error. 3.  msysDTK.  msysDTK-1.0.1.exe \
&gt; installed without error; no issues. 4.  GTK.  gtk-dev-2.12.9-win32-2.exe installed \
&gt; without error; no issues. 5.  M4.  Failed to locate compressed file \
&gt; m4-1.4.7-MSYS.tar.bz2, used m4-1.4.13-1-msys-1.0.11-bin.tar.lzma instead.  Did not \
&gt; understand instruction to extract to the 'root' folder but instead replaced the \
&gt; original M4.exe found in C:\MSYS\1.0\bin with the M4.exe found in the lzma file. 6. \
&gt; Autoconf.  Failed to 'make' source found in autoconf-2.62.tar.gz due to a \
&gt; '[m4sugar.m4f] Error 1' error, but following a reference found on the Web to this \
&gt; error not occurring in autoconf-2.52.tar.gz, successfully 'made' and installed this \
&gt; version.  When moving on to step 7, Automake, compilation failed since autoconf 2.6 \
&gt; or newer was required.  However, autoconf-2.60.tar.gz failed with the 'm4sugar.m4f' \
&gt; error in the same way as v2.62. 
&gt; Brick wall; sore head!  As I'm sure you have guessed my background is MS Windows \
&gt; rather than Linux so I am finding these. Probably minor issues to you, extremely \
&gt; daunting and frustrating to me.  I am encouraged that you have successfully \
&gt; compiled a Windows Libvirt client, hope you can point me in the right direction.  \
&gt; Many thanks... 
&gt; Tim
&gt; 

Okay, so the problem is setting up a working MinGW/MSYS environment.
You used the instructions posted here:
https://www.redhat.com/archives/libvir-list/2008-June/msg00145.html

I didn't try that, but I wrote a set of scripts to automate the
MinGW/MSYS setup and libvirt compliation on Windows. I'll clean them
up a bit and post them, so you can try to use them.

Probably we should also improve http://libvirt.org/windows.html with
more details.

Matthias


</body></email><email><emailId>20100427082534</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-04-27 08:25:34-0400</timestampReceived><subject>Re: [libvirt-users] Libvirt Compilation on MS Vista</subject><body>


Ah, sorry. I've the scripts at hand. I just forgot to post them.

I attached the scripts and added a readme file. I tested this on
Windows XP, but it should work without problem on Windows Vista too.

The scripts could still be improved, for example gathering all
relevant files for a libvirt Windows SDK into a separate directory
would be nice.

If you have any problems or questions with/about this scripts please
report/ask them.

PS: You'll need to rename setup_msys.bat_ to  setup_msys.bat.

Matthias

2010/4/26 Tim McLeod &lt;tim.mcleod@simulamen.eu&gt;:
&gt; Matthias,
&gt;
&gt; Polite enquiry on the progress of tidying up scripts to automate the MinG=
W/MSYS setup and libvirt compilation on Windows, if I may? =C2=A0Not meanin=
g to appear impatient, but I would like to give my client some indication o=
f when I can meet my deliverables. =C2=A0Many thanks...
&gt;
&gt; Tim
&gt;
&gt; -----Original Message-----
&gt; From: Matthias Bolte [mailto:matthias.bolte@googlemail.com]
&gt; Sent: 21 April 2010 08:14
&gt; To: tim.mcleod@simulamen.eu
&gt; Cc: libvirt-users@redhat.com
&gt; Subject: Re: [libvirt-users] Libvirt Compilation on MS Vista
&gt;
&gt; [Let's keep the list involved]
&gt;
&gt; 2010/4/20 Tim McLeod &lt;tim.mcleod@simulamen.eu&gt;:
&gt;&gt; Matthias,
&gt;&gt;
&gt;&gt; Thank you for the swift response. =C2=A0Now, the current state is the re=
sult of following the instructions found a la Web in the attached 'print to=
 PDF' file. =C2=A0Situation as follows:
&gt;&gt;
&gt;&gt; 1. =C2=A0MinGW. =C2=A0MinGW-5.1.4.exe installed without error; no issues=
.
&gt;&gt; 2. =C2=A0MSYS. =C2=A0Failed to locate the executable MSYS-1.0.11-2004.04=
.30-1.exe, but MSYS-1.0.11.exe did install without error.
&gt;&gt; 3. =C2=A0msysDTK. =C2=A0msysDTK-1.0.1.exe installed without error; no is=
sues.
&gt;&gt; 4. =C2=A0GTK. =C2=A0gtk-dev-2.12.9-win32-2.exe installed without error; =
no issues.
&gt;&gt; 5. =C2=A0M4. =C2=A0Failed to locate compressed file m4-1.4.7-MSYS.tar.bz=
2, used m4-1.4.13-1-msys-1.0.11-bin.tar.lzma instead. =C2=A0Did not underst=
and instruction to extract to the 'root' folder but instead replaced the or=
iginal M4.exe found in C:\MSYS\1.0\bin with the M4.exe found in the lzma fi=
le.
&gt;&gt; 6. =C2=A0Autoconf. =C2=A0Failed to 'make' source found in autoconf-2.62.=
tar.gz due to a '[m4sugar.m4f] Error 1' error, but following a reference fo=
und on the Web to this error not occurring in autoconf-2.52.tar.gz, success=
fully 'made' and installed this version. =C2=A0When moving on to step 7, Au=
tomake, compilation failed since autoconf 2.6 or newer was required. =C2=A0=
However, autoconf-2.60.tar.gz failed with the 'm4sugar.m4f' error in the sa=
me way as v2.62.
&gt;&gt;
&gt;&gt; Brick wall; sore head! =C2=A0As I'm sure you have guessed my background =
is MS Windows rather than Linux so I am finding these. Probably minor issue=
s to you, extremely daunting and frustrating to me. =C2=A0I am encouraged t=
hat you have successfully compiled a Windows Libvirt client, hope you can p=
oint me in the right direction. =C2=A0Many thanks...
&gt;&gt;
&gt;&gt; Tim
&gt;&gt;
&gt;
&gt; Okay, so the problem is setting up a working MinGW/MSYS environment.
&gt; You used the instructions posted here:
&gt; https://www.redhat.com/archives/libvir-list/2008-June/msg00145.html
&gt;
&gt; I didn't try that, but I wrote a set of scripts to automate the
&gt; MinGW/MSYS setup and libvirt compliation on Windows. I'll clean them
&gt; up a bit and post them, so you can try to use them.
&gt;
&gt; Probably we should also improve http://libvirt.org/windows.html with
&gt; more details.
&gt;
&gt; Matthias
&gt;
&gt;

["libvirt_mingw_scripts.zip" (application/zip)]

</body></email><email><emailId>20100422091948</emailId><senderName>Mathias Tausig</senderName><senderEmail>mathias.tausig@a-cert.at</senderEmail><timestampReceived>2010-04-22 09:19:48-0400</timestampReceived><subject>[libvirt-users] Allowing incoming traffic to a virtual network</subject><body>

Hello!

I have some virtual networks defined on a virtualization host (using
libvirt 0.7.7 and kvm 0.12.3) with some virtual bridges (virbr1, virbr2)
which are all plugged into a phisical bridge br0. Now I would like to
allow external hosts to connect to guest machines, but the automatically
created iptables rules forbid it.
I have found this rather old post on the mailing list
http://www.redhat.com/archives/libvir-list/2007-January/msg00048.html
which suggests a "forwarding" element for the network configuration, but
this seem to be unimplemented.

cheers
Mathias

</body></email><email><emailId>20100422150807</emailId><senderName>Jorge_Alejandro_Rodrguez</senderName><senderEmail>jrodriguez@dit.upm.es</senderEmail><timestampReceived>2010-04-22 15:08:07-0400</timestampReceived><subject>Re: [libvirt-users] Failed to insert a cd in a virtual machine running</subject><body>

the problem is because of new version of qemu, the name of devices isn't
ide0-0-, is drive-ide0-0-1.

2010/4/22 Jorge Alejandro Rodr=C3=ADguez &lt;jrodriguez@dit.upm.es&gt;

&gt; I can't attach a cd when a vm is running with qemu 0.12.3 (ubuntu 10.04),
&gt; the problem is not with qemu because when I start the vm with kvm command
&gt; (without libvirt) I can change the cd with qemu-monitor without any probl=
em
&gt; and eject it too (libvirt say me that it isn't supported by hypervisor).
&gt;
&gt; the versions of libvirt that I have tried are 0.7.7 and 0.8.0.
&gt;
&gt; Any ideas?
&gt;
&gt; Thanks.
&gt; Jorge
&gt;

[Attachment #3 (text/html)]

the problem is because of new version of qemu, the name of devices isn't ide0-0-, \
is drive-ide0-0-1.&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;2010/4/22 Jorge Alejandro \
Rodrguez &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:jrodriguez@dit.upm.es"&gt;jrodriguez@dit.upm.es&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;

&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt;&lt;div&gt;I can't attach a cd when a vm is running with qemu \
0.12.3 (ubuntu 10.04), the problem is not with qemu because when I start the vm with \
kvm command (without libvirt)  I can change the cd with qemu-monitor without any \
problem and eject it too (libvirt say me that it isn't supported by \
hypervisor).&lt;/div&gt;



&lt;div&gt;  &lt;/div&gt;
&lt;div&gt;the versions of libvirt that I have tried are 0.7.7 and 0.8.0.&lt;/div&gt;
&lt;div&gt;  &lt;/div&gt;
&lt;div&gt;Any ideas?&lt;/div&gt;
&lt;div&gt;  &lt;/div&gt;
&lt;div&gt;Thanks.&lt;/div&gt;
&lt;div&gt;Jorge&lt;/div&gt;
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20100425203420</emailId><senderName>Jorge_Alejandro_Rodrguez</senderName><senderEmail>jrodriguez@dit.upm.es</senderEmail><timestampReceived>2010-04-25 20:34:20-0400</timestampReceived><subject>Re: [libvirt-users] QEmu 0.12.3 Libvirt-0.8.0 and serials ports</subject><body>

yes, but in the commando of qemu 0.12.3 has this:  -chardev
socket,id=serial0,path=/root/.vnuml/simulations/tutorial-r1_xp/vms/uml2/uml2_socket,server,nowait

That don't work and i don't know why libvirt change --serial to -chardev
when work qemu 0.11 or qemu 0.12.3

On Sun, Apr 25, 2010 at 7:00 PM, scar &lt;scar@drigon.com&gt; wrote:

&gt; -----BEGIN PGP SIGNED MESSAGE-----
&gt; Hash: SHA256
&gt;
&gt; Jorge Alejandro Rodrguez @ 04/25/2010 08:24 AM:
&gt; &gt; I have a problem with libvirt and serial ports. When I run a xml with
&gt; serial
&gt; &gt; tag over libvirt0.8.0 and qemu 0.11 this is the line that libvirt execute
&gt; &gt; [snip]
&gt; &gt;
&gt; &gt; and the virtual machine created have a serial port but when I run the
&gt; same
&gt; &gt; xml in a machine with qemu 0.12.3 this is the line that libvirt execute
&gt; &gt; [snip]
&gt; &gt;
&gt; &gt; the virtual machine don't have any serial port. If you execute the
&gt; &gt; line: [snip] (the same line
&gt; &gt; before) over qemu 0.12.3 the viertual machine have serial port.
&gt; &gt;
&gt; &gt; Any ideas?
&gt;
&gt; in the command that is working, there is:
&gt;
&gt; - -serial
&gt;
&gt; unix:/root/.vnuml/simulations/tutorial-r1_xp/vms/uml2/uml2_socket,server,nowait
&gt; *
&gt;
&gt; which is not showing up in the command that that qemu 0.12.3 is executing.
&gt;
&gt; -----BEGIN PGP SIGNATURE-----
&gt;
&gt; iEYEAREIAAYFAkvUdUAACgkQXhfCJNu98qC4gwCgy0PoQraK9Tfxv16t39EIt0+j
&gt; eYsAmwfivqAhHRcaNKi2tqfa/qtfU3qX
&gt; =Ils9
&gt; -----END PGP SIGNATURE-----
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

[Attachment #3 (text/html)]

yes, but in the commando of qemu 0.12.3 has this:  &lt;span class="Apple-style-span" \
style="font-family: arial, sans-serif; font-size: 13px; border-collapse: collapse; \
color: rgb(32, 64, 99); "&gt;  -chardev \
socket,id=serial0,path=/root/.vnuml/simulations/tutorial-r1_xp/vms/uml2/uml2_socket,server,nowait \
&lt;/span&gt;&lt;div&gt;

&lt;font class="Apple-style-span" color="#204063" face="arial, sans-serif"&gt;&lt;span \
class="Apple-style-span" style="border-collapse: \
collapse;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" \
color="#204063" face="arial, sans-serif"&gt;&lt;span class="Apple-style-span" \
style="border-collapse: collapse;"&gt;That don't work and i don't know why \
libvirt change --serial to -chardev when work qemu 0.11 or qemu 0.12.3&lt;br&gt;

&lt;/span&gt;&lt;/font&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Sun, Apr 25, 2010 at 7:00 PM, scar \
&lt;span dir="ltr"&gt;&lt;&lt;a href="mailto:scar@drigon.com"&gt;scar@drigon.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px \
#ccc solid;padding-left:1ex;"&gt;

-----BEGIN PGP SIGNED MESSAGE-----&lt;br&gt;
Hash: SHA256&lt;br&gt;
&lt;br&gt;
Jorge Alejandro Rodrguez @ 04/25/2010 08:24 AM:&lt;br&gt;
&lt;div class="im"&gt;&gt; I have a problem with libvirt and serial ports. When I run a xml \
with serial&lt;br&gt; &gt; tag over libvirt0.8.0 and qemu 0.11 this is the line that \
libvirt execute&lt;br&gt; &lt;/div&gt;&gt; [snip]&lt;br&gt;
&lt;div class="im"&gt;&gt;&lt;br&gt;
&gt; and the virtual machine created have a serial port but when I run the same&lt;br&gt;
&gt; xml in a machine with qemu 0.12.3 this is the line that libvirt execute&lt;br&gt;
&lt;/div&gt;&gt; [snip]&lt;br&gt;
&lt;div class="im"&gt;&gt;&lt;br&gt;
&gt; the virtual machine don't have any serial port. If you execute the&lt;br&gt;
&lt;/div&gt;&gt; line: [snip] (the same line&lt;br&gt;
&lt;div class="im"&gt;&gt; before) over qemu 0.12.3 the viertual machine have serial \
port.&lt;br&gt; &gt;&lt;br&gt;
&gt; Any ideas?&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;in the command that is working, there is:&lt;br&gt;
&lt;br&gt;
- -serial&lt;br&gt;
&lt;div class="im"&gt;unix:/root/.vnuml/simulations/tutorial-r1_xp/vms/uml2/uml2_socket,server,nowait&lt;br&gt;
 &lt;/div&gt;*&lt;br&gt;
&lt;br&gt;
which is not showing up in the command that that qemu 0.12.3 is executing.&lt;br&gt;
&lt;br&gt;
-----BEGIN PGP SIGNATURE-----&lt;br&gt;
&lt;br&gt;
iEYEAREIAAYFAkvUdUAACgkQXhfCJNu98qC4gwCgy0PoQraK9Tfxv16t39EIt0+j&lt;br&gt;
eYsAmwfivqAhHRcaNKi2tqfa/qtfU3qX&lt;br&gt;
=Ils9&lt;br&gt;
-----END PGP SIGNATURE-----&lt;br&gt;
&lt;br&gt;
_______________________________________________&lt;br&gt;
libvirt-users mailing list&lt;br&gt;
&lt;a href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt;
&lt;a href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;




</body></email><email><emailId>20100426101643</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-04-26 10:16:43-0400</timestampReceived><subject>Re: [libvirt-users] Problems moving qemu machine to libvirt</subject><body>

On Sun, Apr 25, 2010 at 01:03:42AM +1000, Erik de Castro Lopo wrote:
&gt; Hi all,
&gt; 
&gt; I have a qemu-system-arm machine that I am currently starting using:
&gt; 
&gt;     qemu-system-arm -M versatilepb -nographic \
&gt;       -hda img.qcow2 \
&gt;       -net vde,vlan=0,sock=/var/run/qemu-vde.ctl \
&gt;       -net nic,vlan=0,macaddr=52:54:00:12:34:22  \
&gt;       -kernel vmlinuz-2.6.18-6-versatile \
&gt;       -initrd initrd.img-2.6.18-6-versatile \
&gt;       -append "root=/dev/sda1 console=ttyAMA0,115200n8"
&gt; 
&gt; I converted the above to a virsh XML file using:
&gt; 
&gt;     virsh domxml-from-native qemu-argv run.argc &gt; arm32.xml
&gt; 
&gt; which resulted in this (minor modifications to provide full paths):
&gt; 
&gt;     &lt;domain type='qemu'&gt;
&gt;       &lt;name&gt;arm32&lt;/name&gt;
&gt;       &lt;uuid&gt;e433002b-107f-5b16-415b-7afb3e3a4d84&lt;/uuid&gt;
&gt;       &lt;memory&gt;262144&lt;/memory&gt;
&gt;       &lt;currentMemory&gt;262144&lt;/currentMemory&gt;
&gt;       &lt;vcpu&gt;1&lt;/vcpu&gt;
&gt;       &lt;os&gt;
&gt;         &lt;type arch='arm' machine='versatilepb'&gt;hvm&lt;/type&gt;
&gt;         &lt;kernel&gt;/kvm/arm32/vmlinuz-2.6.18-6-versatile&lt;/kernel&gt;
&gt;         &lt;initrd&gt;/kvm/arm32/initrd.img-2.6.18-6-versatile&lt;/initrd&gt;
&gt;       &lt;/os&gt;
&gt;       &lt;features&gt;
&gt;         &lt;acpi/&gt;
&gt;       &lt;/features&gt;
&gt;       &lt;clock offset='utc'/&gt;
&gt;       &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
&gt;       &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
&gt;       &lt;on_crash&gt;destroy&lt;/on_crash&gt;
&gt;       &lt;devices&gt;
&gt;         &lt;emulator&gt;/kvm/arm32/arm32.sh&lt;/emulator&gt;
&gt;         &lt;disk type='file' device='disk'&gt;
&gt;           &lt;source file='/kvm/arm32/img.qcow2'/&gt;
&gt;           &lt;target dev='hda' bus='ide'/&gt;
&gt;           &lt;address type='drive' controller='0' bus='0' unit='0'/&gt;
&gt;         &lt;/disk&gt;
&gt;         &lt;controller type='ide' index='0'/&gt;
&gt;         &lt;serial type='pty'&gt;
&gt;           &lt;target port='0'/&gt;
&gt;         &lt;/serial&gt;
&gt;         &lt;console type='pty'&gt;
&gt;           &lt;target port='0'/&gt;
&gt;         &lt;/console&gt;
&gt;       &lt;/devices&gt;
&gt;     &lt;/domain&gt;
&gt; 
&gt; Since libvirt doesn't support VDE networking I use a wrapper around
&gt; qemu-system-arm (/kvm/arm32/arm32.sh) containing:
&gt; 
&gt;     #!/bin/bash
&gt;     exec /usr/bin/qemu-system-arm $@ \
&gt; 	-net nic,vlan=0,macaddr=52:54:00:12:34:22 \
&gt; 	-net vde,vlan=0,group=vde2-net,mode=0770,sock=/var/run/qemu-vde.ctl \
&gt; 	-append "root=/dev/sda1 console=ttyAMA0,115200n8"
&gt; 
&gt; However, doing this I get the following error when I attempt to start
&gt; the VM:
&gt; 
&gt;     error: Failed to start domain arm32
&gt;     error: internal error Process exited while reading console log output:
&gt;            char device redirected to /dev/pts/10
&gt;     qemu: could not open disk image console=ttyAMA0,115200n8\"":
&gt;            No such file or directory
&gt; 
&gt; The first problem (console log output) is probably due to the second,
&gt; where it seems that this:
&gt; 
&gt;     &lt;cmdline&gt;root=/dev/sda1 console=ttyAMA0,115200n8&lt;/cmdline&gt;
&gt; 
&gt; is not being passed to qemu correctly. I have tried quoting the command
&gt; line but that doesn't help.

In your wrapper I think you need  "$@" instead of $@


Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100426154733</emailId><senderName>Don Morrison</senderName><senderEmail>dam@us.ibm.com</senderEmail><timestampReceived>2010-04-26 15:47:33-0400</timestampReceived><subject>[libvirt-users] Unable to switch ISO with virsh/kvm</subject><body>


I'd created a VM with "virsh create" that has a CD-ROM attached

 &lt;disk type='file' device='cdrom'&gt;
      &lt;source file='/images/myiso_1.2.iso'/&gt;
      &lt;target dev='sdb' bus='scsi'/&gt;
      &lt;readonly/&gt;
      &lt;alias name='scsi0-0-1'/&gt;
      &lt;address type='drive' controller='0' bus='0' unit='1'/&gt;
    &lt;/disk&gt;


Now I'd like to swap that iso out and mount a new one without taking down
the guest.  But it fails as follows:

virsh detach-disk sles-11 sdb
error: Failed to detach disk
error: this function is not supported by the hypervisor: This type of
device cannot be hot unplugged


Attaching a new iso also fails.

virsh attach-disk sles-11 /images/myiso_1.3,iso sdc  --type cdrom --mode
readonly
error: Failed to attach disk
error: internal error No device with bus 'scsi' and target 'sdc'

I've tried all of the variations I can think of (including attach-device
detach-device, ide vs scsi, block vs file, mounting an empty CDROM device,
etc) and I can't get this to work. It does work when the VM is powered
down, but I need to do the iso switch when the VM is up, which seems like
pretty basic functionality if trying to install an OS that covers multiple
ISOs.  Is this expected to work? If so, any tips on what I'm doing wrong?
Thanks.


I'm running SLES 11 SP1 (beta)

damkvm:/tmp # virsh --version
0.7.6
damkvm:/tmp # libvirtd --version
libvirtd (libvirt) 0.7.6
damkvm:/tmp # virsh version
Compiled against library: libvir 0.7.6
Using library: libvir 0.7.6
Using API: QEMU 0.7.6
Running hypervisor: QEMU 0.12.3


Don Morrison

</body></email><email><emailId>20100427022714</emailId><senderName>scar</senderName><senderEmail>scar@drigon.com</senderEmail><timestampReceived>2010-04-27 02:27:14-0400</timestampReceived><subject>Re: [libvirt-users] Using the host's LVM to manage virtual disks</subject><body>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Don Morrison @ 04/26/2010 06:21 AM:
&gt; I've been able to do this both ways with libvirt/kvm. You have to define
&gt; your logical volume as a block device. 

the logical volume shows up as a hard drive during the installation of
the VM.  the issue i am having, though, is that, on the virtual hard
drive, i still need to partition (at least) a root and swap partition.
once i've done this, i am unable to see the VM's root and swap
partitions in the hypervisor's LVM--it is still showing up as one,
unallocated partition.

i want it to actually show up as a root and swap partitions so i can
work with them directly.

i found this[1] page in the libvirt documentation that may be what i
need.  as the documentation states, all i should need to do is provide
the name of my volume group.  but, i cannot get it to work: after i
define the XML file with virsh, the &lt;pool&gt; block disappears from the XML
file.  apparently i'm not defining it right, where is it supposed to go?
 i have tried putting it under the &lt;domain&gt; block as well as under the
&lt;devices&gt; block.


1. http://libvirt.org/storage.html#StorageBackendLogical

-----BEGIN PGP SIGNATURE-----

iEYEAREIAAYFAkvWS4IACgkQXhfCJNu98qDusACeJWzz4TwxUVpRjLAm9H3WGeTb
4WwAn3ZdOrnQQg3V8QBmY13MRqTw+snH
=1b3M
-----END PGP SIGNATURE-----

</body></email><email><emailId>20100427085558</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2010-04-27 08:55:58-0400</timestampReceived><subject>Re: [libvirt-users] Building &amp; Installing on OpenSolaris</subject><body>

On Tue, Apr 27, 2010 at 10:29:40AM +0200, Matthias Bolte wrote:
&gt; 2010/4/27 Daniel Veillard &lt;veillard@redhat.com&gt;:
&gt; &gt; On Mon, Apr 26, 2010 at 10:24:33PM -0600, gary mazzaferro wrote:
&gt; &gt;  Yup seems both multipath and bridge support need to be desactivated to
&gt; &gt; build on Solaris,
&gt; &gt;
&gt; &gt; Daniel
&gt; &gt;
&gt; 
&gt; Totally off-topic... but is there a special reason you write
&gt; 'desactivated' instead of 'deactivated'? In the other mail I just
&gt; accepted it as a typo, but now it looks like a habit :)

 Frenchism - the verb is "desactiver" - and as everybody knows, all
proper english derivates from Latin/French (I have Normand blood :-)

  So yeah, I'm making that mistake without even noticing, thanks !

Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

</body></email><email><emailId>20100428151907</emailId><senderName>"Tim McLeod"</senderName><senderEmail>tim.mcleod@simulamen.eu</senderEmail><timestampReceived>2010-04-28 15:19:07-0400</timestampReceived><subject>Re: [libvirt-users] Libvirt Compilation on MS Vista</subject><body>

Matthias,

Good day to you!

Used your instructions and successfully compiled libvirt on a Vista machine without a \
single error or glitch.  Many thanks for your assistance.  My challenge now is to \
connect to a remote box running Ubuntu hosting two VMs; Ubuntu and Vista.  Thanks \
again...

Tim

-----Original Message-----
From: Matthias Bolte [mailto:matthias.bolte@googlemail.com] 
Sent: 27 April 2010 02:26
To: tim.mcleod@simulamen.eu
Cc: libvirt-users@redhat.com
Subject: Re: [libvirt-users] Libvirt Compilation on MS Vista

Ah, sorry. I've the scripts at hand. I just forgot to post them.

I attached the scripts and added a readme file. I tested this on Windows XP, but it \
should work without problem on Windows Vista too.

The scripts could still be improved, for example gathering all relevant files for a \
libvirt Windows SDK into a separate directory would be nice.

If you have any problems or questions with/about this scripts please report/ask them.

PS: You'll need to rename setup_msys.bat_ to  setup_msys.bat.

Matthias

2010/4/26 Tim McLeod &lt;tim.mcleod@simulamen.eu&gt;:
&gt; Matthias,
&gt; 
&gt; Polite enquiry on the progress of tidying up scripts to automate the MinGW/MSYS \
&gt; setup and libvirt compilation on Windows, if I may?  Not meaning to appear \
&gt; impatient, but I would like to give my client some indication of when I can meet my \
&gt; deliverables.  Many thanks... 
&gt; Tim
&gt; 
&gt; -----Original Message-----
&gt; From: Matthias Bolte [mailto:matthias.bolte@googlemail.com]
&gt; Sent: 21 April 2010 08:14
&gt; To: tim.mcleod@simulamen.eu
&gt; Cc: libvirt-users@redhat.com
&gt; Subject: Re: [libvirt-users] Libvirt Compilation on MS Vista
&gt; 
&gt; [Let's keep the list involved]
&gt; 
&gt; 2010/4/20 Tim McLeod &lt;tim.mcleod@simulamen.eu&gt;:
&gt; &gt; Matthias,
&gt; &gt; 
&gt; &gt; Thank you for the swift response.  Now, the current state is the result of \
&gt; &gt; following the instructions found a la Web in the attached 'print to PDF' file.  \
&gt; &gt; Situation as follows: 
&gt; &gt; 1.  MinGW.  MinGW-5.1.4.exe installed without error; no issues.
&gt; &gt; 2.  MSYS.  Failed to locate the executable MSYS-1.0.11-2004.04.30-1.exe, but \
&gt; &gt; MSYS-1.0.11.exe did install without error. 3.  msysDTK.  msysDTK-1.0.1.exe \
&gt; &gt; installed without error; no issues. 4.  GTK.  gtk-dev-2.12.9-win32-2.exe \
&gt; &gt; installed without error; no issues. 5.  M4.  Failed to locate compressed file \
&gt; &gt; m4-1.4.7-MSYS.tar.bz2, used m4-1.4.13-1-msys-1.0.11-bin.tar.lzma instead.  Did \
&gt; &gt; not understand instruction to extract to the 'root' folder but instead replaced \
&gt; &gt; the original M4.exe found in C:\MSYS\1.0\bin with the M4.exe found in the lzma \
&gt; &gt; file. 6.  Autoconf.  Failed to 'make' source found in autoconf-2.62.tar.gz due to \
&gt; &gt; a '[m4sugar.m4f] Error 1' error, but following a reference found on the Web to \
&gt; &gt; this error not occurring in autoconf-2.52.tar.gz, successfully 'made' and \
&gt; &gt; installed this version.  When moving on to step 7, Automake, compilation failed \
&gt; &gt; since autoconf 2.6 or newer was required.  However, autoconf-2.60.tar.gz failed \
&gt; &gt; with the 'm4sugar.m4f' error in the same way as v2.62. 
&gt; &gt; Brick wall; sore head!  As I'm sure you have guessed my background is MS Windows \
&gt; &gt; rather than Linux so I am finding these. Probably minor issues to you, extremely \
&gt; &gt; daunting and frustrating to me.  I am encouraged that you have successfully \
&gt; &gt; compiled a Windows Libvirt client, hope you can point me in the right direction.  \
&gt; &gt; Many thanks... 
&gt; &gt; Tim
&gt; &gt; 
&gt; 
&gt; Okay, so the problem is setting up a working MinGW/MSYS environment.
&gt; You used the instructions posted here:
&gt; https://www.redhat.com/archives/libvir-list/2008-June/msg00145.html
&gt; 
&gt; I didn't try that, but I wrote a set of scripts to automate the 
&gt; MinGW/MSYS setup and libvirt compliation on Windows. I'll clean them 
&gt; up a bit and post them, so you can try to use them.
&gt; 
&gt; Probably we should also improve http://libvirt.org/windows.html with 
&gt; more details.
&gt; 
&gt; Matthias
&gt; 
&gt; 


</body></email><email><emailId>20100428220856</emailId><senderName>Mick Pollard</senderName><senderEmail>lists@lunix.com.au</senderEmail><timestampReceived>2010-04-28 22:08:56-0400</timestampReceived><subject>Re: [libvirt-users] ruby-libvirt equiv of virsh list --all</subject><body>

On Tue, 27 Apr 2010 10:02:15 -0400
Hi,

Chris Lalancette &lt;clalance@redhat.com&gt; wrote:

&gt; The ruby-libvirt library is just a thin wrapper around the libvirt API's.
&gt; In point of fact, if you look at the libvirt API's (and virsh), you'll see
&gt; that all virsh does is to take the two lists it gets back from list_defined_domains
&gt; and list_domains, and concatenate them.  So in ruby, you would do something similar
&gt; to get the whole list, and then you'd have to iterate through each of them, dump
&gt; the XML, and get the UUID out of it.
&gt; 
&gt; -- 
&gt; Chris Lalancette

That's what I thought. Was just hoping for something a little more ellegant. 
Having to grab a list of stopped "names" and then running "id's" and convert to \
"uuid" just to grab a list of all the domains seems a little painful to me.

Was hoping to for something like this: 

    @conn.list_domains_uuid

and have it grab all uuid's for domains running or not. 

Thanks


-- 
Regards
Mick Pollard ( lunix )
------------------------------------------------
BOFH Excuse of the day:
Static Hardware Condition Warning


</body></email><email><emailId>20100429172003</emailId><senderName>Jorge_Alejandro_Rodrguez</senderName><senderEmail>jrodriguez@dit.upm.es</senderEmail><timestampReceived>2010-04-29 17:20:03-0400</timestampReceived><subject>Re: [libvirt-users] Cloning very slow?</subject><body>

What filesystem do you have?

On Thu, Apr 29, 2010 at 1:29 PM, Tom Hughes &lt;tom@compton.nu&gt; wrote:

&gt; Yesterday I cloned one of my VMs and, somewhat implausibly, it took
&gt; virt-clone something like 8-9 hours to clone the 8Gb disk image... Copying
&gt; it from the command line took a mere 6.5 minutes.
&gt;
&gt; I assume this is a bug, and it's not expected to take this long ;-)
&gt;
&gt; This was using virt-clone from python-virtinst-0.500.2-1.fc12.noarch in the
&gt; virt-preview repository.
&gt;
&gt; Tom
&gt;
&gt; --
&gt; Tom Hughes (tom@compton.nu)
&gt; http://compton.nu/
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
&gt;

[Attachment #3 (text/html)]

What filesystem do you have?&lt;div&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Thu, Apr 29, 2010 at \
1:29 PM, Tom Hughes &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:tom@compton.nu"&gt;tom@compton.nu&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt;

Yesterday I cloned one of my VMs and, somewhat implausibly, it took virt-clone \
something like 8-9 hours to clone the 8Gb disk image... Copying it from the command \
line took a mere 6.5 minutes.&lt;br&gt; &lt;br&gt;
I assume this is a bug, and it's not expected to take this long ;-)&lt;br&gt;
&lt;br&gt;
This was using virt-clone from python-virtinst-0.500.2-1.fc12.noarch in the \
virt-preview repository.&lt;br&gt; &lt;br&gt;
Tom&lt;br&gt;&lt;font color="#888888"&gt;
&lt;br&gt;
-- &lt;br&gt;
Tom Hughes (&lt;a href="mailto:tom@compton.nu" target="_blank"&gt;tom@compton.nu&lt;/a&gt;)&lt;br&gt;
&lt;a href="http://compton.nu/" target="_blank"&gt;http://compton.nu/&lt;/a&gt;&lt;br&gt;
&lt;br&gt;
_______________________________________________&lt;br&gt;
libvirt-users mailing list&lt;br&gt;
&lt;a href="mailto:libvirt-users@redhat.com" \
target="_blank"&gt;libvirt-users@redhat.com&lt;/a&gt;&lt;br&gt; &lt;a \
href="https://www.redhat.com/mailman/listinfo/libvirt-users" \
target="_blank"&gt;https://www.redhat.com/mailman/listinfo/libvirt-users&lt;/a&gt;&lt;br&gt; \
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20100429181758</emailId><senderName>"Tim McLeod"</senderName><senderEmail>tim.mcleod@simulamen.eu</senderEmail><timestampReceived>2010-04-29 18:17:58-0400</timestampReceived><subject>Re: [libvirt-users] Windows Client</subject><body>

Thank you for your swift response.  However, still not able to connect to the ubuntu \
libvirtd.  Have you ever seen a grown man cry?

Edited /etc/libvirt/libvirt.conf as follows:
listen_tcp = 1
auth_tcp = "none"

Edited /etc/default//libvirt-bin as follows:
libvirt-opts="-d -l"

Running virsh on Vista client fails as follows:
$ virsh -c qemu+tcp://192.168.1.101/system
error: unable to connect to libvirtd at '192.168.1.101': errno=10061
error: failed to connect to the hypervisor

Running virsh on Ubuntu server fails as follows:
$ virsh -c qemu+tcp:///system
Connecting to uri: qemu+tcp:///system
error: unable to connect to libvirtd at 'localhost': Connection refused
error: failed to connect to the hypervisor

Indeed, with libvirt-opts="-d -l" in etc/default//libvirt-bin the 'default' command \
also fails: $ virsh -c qemu:///system
Connecting to uri: qemu:///system
error: unable to connect to 'var/run/libvirt/libvirt-sock': Connection refused
error: failed to connect to the hypervisor

The rationale for using insecure TCP was to quickly prove a concept with the minimum \
of fuss.  Perhaps this is not the way forward.  Suggestions very welcome...

Tim McLeod


-----Original Message-----
From: Matthias Bolte [mailto:matthias.bolte@googlemail.com] 
Sent: 28 April 2010 15:36
To: tim.mcleod@simulamen.eu
Cc: libvirt-users@redhat.com
Subject: Re: Windows Client

2010/4/28 Tim McLeod &lt;tim.mcleod@simulamen.eu&gt;:
&gt; Having newly compiled a Libvirt on a Windows Vista machine (many thanks to
&gt; Matthias Bolte)

Nine :)

&gt; I have attempted to connect to a remote Ubuntu machine using
&gt; virsh.exe.  However, the connection fails as follows:
&gt; 
&gt; 
&gt; 
&gt; $ virsh -c qemu+tcp:///system

You need to specify the server in this URI using a hostname or IP
address: qemu+tcp://ubuntu-server.com/system

&gt; error: unable to connect to libvirtd at 'localhost': errno=10061
&gt; 
&gt; error: failed to connect to the hypervisor
&gt; 
&gt; 
&gt; 
&gt; 1.  I have modified /etc/libvirt/libvirt.conf to set listen_tcp=1.

You also need to change this

   #auth_tcp = "sasl"

to

   auth_tcp = "none"

to disable SASL authentication/encryption for TCP connections, because
your libvirt on Windows is compiled without SASL support. If you need
the libvirt connections to be encrypted you can switch from TCP to TLS
connections using: qemu+tls://ubuntu-server.com/system

&gt; 2.  I cannot find /etc/sysconfig/libvirtd so I am unable to set
&gt; LIBVIRTD_ARGS="--listen".
&gt; 

For Ubuntu packaged libvirt see /etc/default/libvirt-bin and change

   libvirtd_opts="-d"

to

   libvirtd_opts="-d -l"

as the comment suggest and restart libvirtd using

   /etc/init.d/libvirt-bin restart

Now you should be able to connect to the libvirtd on your Ubuntu server.

Matthias


</body></email><email><emailId>20100430012054</emailId><senderName>Vadym Chepkov</senderName><senderEmail>vchepkov@gmail.com</senderEmail><timestampReceived>2010-04-30 01:20:54-0400</timestampReceived><subject>[libvirt-users] libvirt client certificate location</subject><body>


Hi,

I was really surprised to find that location of client certificate, key and CA is \
hardcoded into libvirt. What if I need to manage servers with certificates issued by \
different CA? Or why do everybody has to use the same private key? Doesn't make it \
much of a private.  It seems so strange I wonder if I am mistaken and it is possible \
to provide alternative location for the CA, key and certificate?

Thank you,
Vadym Chepkov


</body></email><email><emailId>20100430024233</emailId><senderName>jeremy avnet</senderName><senderEmail>brainsik+libvirt@saucelabs.com</senderEmail><timestampReceived>2010-04-30 02:42:33-0400</timestampReceived><subject>[libvirt-users] Ignoring invalid update watch -1</subject><body>

Hello,

I've started to get these in my logs every now and then:

libvirtd: 18:50:29.792: warning : virEventUpdateHandleImpl:149 : Ignoring
invalid update watch -1

What does it mean?

Thanks!
.:. jeremy

[Attachment #3 (text/html)]

&lt;font face="verdana,sans-serif"&gt;&lt;span class="Apple-style-span" style="font-family: \
arial, sans-serif; font-size: 13px; border-collapse: collapse; \
"&gt;&lt;div&gt;Hello,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I've started to get these in my logs every \
now and then:&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;font class="Apple-style-span" face="'courier \
new', monospace"&gt;libvirtd: 18:50:29.792: warning : virEventUpdateHandleImpl:149 : \
Ignoring invalid update watch -1&lt;/font&gt;&lt;/span&gt;&lt;/font&gt;&lt;div&gt;&lt;font \
class="Apple-style-span" face="arial, sans-serif"&gt;&lt;span class="Apple-style-span" \
style="border-collapse: collapse;"&gt;&lt;br&gt; &lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
class="Apple-style-span" face="arial, sans-serif"&gt;&lt;span class="Apple-style-span" \
style="border-collapse: collapse;"&gt;What does it mean?&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
class="Apple-style-span" face="arial, sans-serif"&gt;&lt;span class="Apple-style-span" \
style="border-collapse: collapse;"&gt;&lt;br&gt; &lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
class="Apple-style-span" face="arial, sans-serif"&gt;&lt;span class="Apple-style-span" \
style="border-collapse: collapse;"&gt;Thanks!&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
class="Apple-style-span" face="arial, sans-serif"&gt;&lt;span class="Apple-style-span" \
style="border-collapse: collapse;"&gt;.:. jeremy&lt;/span&gt;&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font \
class="Apple-style-span" face="arial, sans-serif"&gt;&lt;span class="Apple-style-span" \
style="border-collapse: collapse;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;



</body></email><email><emailId>20100430062011</emailId><senderName></senderName><senderEmail>steven765@yahoo.com</senderEmail><timestampReceived>2010-04-30 06:20:11-0400</timestampReceived><subject>[libvirt-users] attach-device broken?</subject><body>

Hi, 
   Just installed a new FC12 box with all new updates. Figured out to delete the \
CDROM so the images actually boot now.  However, after the upgrade, I can no longer \
attach my network interfaces to running images?  Was this capability removed?  Is \
there some new setting that has to be configured?

It's a very simple configuration that hasn't changed and still works on the \
pre-update box.

&lt;interface type='network'&gt;
   &lt;mac address='52:54:00:58:9c:00'/&gt;
   &lt;source network='mynetwork'/&gt;       yes it's defined and active
&lt;/interface&gt;

Thanks in advance,
Steve




      


</body></email><email><emailId>20100430131116</emailId><senderName>Anthony Davis</senderName><senderEmail>tony@specialistdevelopment.com</senderEmail><timestampReceived>2010-04-30 13:11:16-0400</timestampReceived><subject>[libvirt-users] Error connecting to console</subject><body>

Hi,

i have KVM running at the moment and im trying to do a text based  
install of centos, so i need to connect to the console via virsh

virsh console servername

but i get this error:

error: Failed to get local hostname

How do i resolve this issue to get a consol connection to the server?

I have tried to put it into the /etc/hosts file, but to no avail.

Hope someone can help or suggest another method of doing a headless  
and X less install of a guest?

Kind Regards

Tony

</body></email><email><emailId>20100430154531</emailId><senderName>David Ehle</senderName><senderEmail>ehle@agni.phys.iit.edu</senderEmail><timestampReceived>2010-04-30 15:45:31-0400</timestampReceived><subject>[libvirt-users] using shared storage with libvirt/KVM?</subject><body>


Hello,

I've spent a few days googling and reading documentation, but I'm looking 
for clarification and advise on setting up KVM/libvirt with shared 
storage.

I have 2 (for now) Ubuntu Karmic systems with KVM/virsh/virt-manager set 
up and running.

I have a storage server that can do NFS/iSCSI/samba/ etc.

I am trying to figure out the best way to set things up so that I can run 
several (eventually) production linux guests (mostly debian stable) on the 
2 KVM host systems and be able to migrate them when maintenance is 
required on their hosts.

Performance is of medium importance, stability/availibilty is pretty high 
priority.

A common opinion seems to be that using LVs to hold disk images gives 
possibly the best IO performance, followed by raw, then qcow2.

Would you agree or disagree with this? What evidence can you provide?


I am also rather confused about using shared storage, and what options can 
be combined with this.

I have succesfully made an iscsi device available to 
libvirt/virsh/virt-manager via an XML file + pool-define + pool-start. 
However the documentation states that while you can create pools through 
libvirt, volumes have to be pre-allocated:
http://libvirt.org/storage.html
"Volumes must be pre-allocated on the iSCSI server, and cannot be created 
via the libvirt APIs."

I'm very unclear on what this means in general, and specifically how you 
preallocate the the Volumes.

When I make a iscsi pool available via something like this:
       &lt;pool type="iscsi"&gt;
         &lt;name&gt;virtimages&lt;/name&gt;
         &lt;source&gt;
           &lt;host name="iscsi.example.com"/&gt;
           &lt;device path="demo-target"/&gt;
         &lt;/source&gt;
         &lt;target&gt;
           &lt;path&gt;/dev/disk/by-path&lt;/path&gt;
         &lt;/target&gt;
       &lt;/pool&gt;

In virt-manger I can see it as a pool, but when I try to select it for 
where to create an image, it uses the pool AS A Volume (I think).

That brings me to my next question/misunderstanding...

If you are using shared storage (via NFS or iSCSI) does that also mean you 
MUST use a file based image rather than an LVM LV?  NFS makes directories 
available, not devices.  You can make an unformated "raw" LV available via 
iSCSI, but its not seen on the far side as a LV but instead as a scsi disk 
which you need to partition. You can make a PV&gt;VG&gt;LV out of that and then 
make your new LV available to libvirt/KVM but then your stacking a heck of 
a lot of LVM/LVs/partion tables up which seems pretty dubious.  I'm also 
not sure that the stack would be visable/available to the second system 
using that iSCSI device.  (I'm pretty new to using iSCSI as well.)

Redhat provides pretty good documentation on doing shared storage/live 
migration for NFS:
http://www.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/5.4/html/Virtualization_Guide/chap-Virtualization-KVM_live_migration.html
 But unfortunately the section on Shared Storage with iSCSI is a bit 
lacking:
"9.1. Using iSCSI for storing guests
This section covers using iSCSI-based devices to store virtualized 
guests." and thats it.

For maybe 6-10 guests, should I simply just be using NFS? Is its 
performance that much worse than iSCSI for this task?

So since KVM/libvirt is getting used quite often in production now - but 
some simple things are not making any sense to me - I'm guessing that I 
have some really basic misunderstandings of how to do shared storage / 
Pools/ Volumes for migration.

Would one of the kind readers of this least be willing to correct me?

Please CC to my original email address as well as I am not yet a regular 
subscriber.

Thanks again!

David.


</body></email><email><emailId>20100430164412</emailId><senderName>"Tim McLeod"</senderName><senderEmail>tim.mcleod@simulamen.eu</senderEmail><timestampReceived>2010-04-30 16:44:12-0400</timestampReceived><subject>[libvirt-users] Windows Vista Client Fails to Connect to Ubuntu libvirtd</subject><body>

Requesting urgent assistance if I may?

 

Attempting to connect to an Ubuntu machine using an MinMG compiled virsh on
a Windows Vista machine.  Using insecure TCP simply to prove a concept to a
client.  However, cannot connect; situation as follows:

 

Edited /etc/libvirt/libvirt.conf as follows:

listen_tcp = 1

auth_tcp = "none"

 

Edited /etc/default//libvirt-bin as follows:

libvirt-opts="-d -l"

 

Running virsh on Vista client fails as follows:

$ virsh -c qemu+tcp://192.168.1.101/system

error: unable to connect to libvirtd at '192.168.1.101': errno=10061

error: failed to connect to the hypervisor

 

Running virsh on Ubuntu server fails as follows:

$ virsh -c qemu+tcp:///system

Connecting to uri: qemu+tcp:///system

error: unable to connect to libvirtd at 'localhost': Connection refused

error: failed to connect to the hypervisor

 

Indeed, with libvirt-opts="-d -l" in etc/default//libvirt-bin the 'default'
command also fails:

$ virsh -c qemu:///system

Connecting to uri: qemu:///system

error: unable to connect to 'var/run/libvirt/libvirt-sock': Connection
refused

error: failed to connect to the hypervisor

 

Suggestions very welcome...

 

Tim McLeod

 


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 12 (filtered medium)"&gt;
&lt;style&gt;
&lt;!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page Section1
	{size:612.0pt 792.0pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;}
div.Section1
	{page:Section1;}
--&gt;
&lt;/style&gt;
&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapelayout v:ext="edit"&gt;
  &lt;o:idmap v:ext="edit" data="1" /&gt;
 &lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
&lt;/head&gt;

&lt;body lang=EN-GB link=blue vlink=purple&gt;

&lt;div class=Section1&gt;

&lt;p class=MsoNormal&gt;Requesting urgent assistance if I may?&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Attempting to connect to an Ubuntu machine using an MinMG
compiled virsh on a Windows Vista machine. Using insecure TCP simply to prove
a concept to a client. However, cannot connect; situation as \
follows:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Edited /etc/libvirt/libvirt.conf as follows:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;listen_tcp = 1&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;auth_tcp = "none"&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Edited /etc/default//libvirt-bin as follows:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;libvirt-opts="-d -l"&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Running virsh on Vista client fails as follows:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;$ virsh -c qemu+tcp://192.168.1.101/system&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;error: unable to connect to libvirtd at '192.168.1.101':
errno=10061&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;error: failed to connect to the hypervisor&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Running virsh on Ubuntu server fails as follows:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;$ virsh -c qemu+tcp:///system&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Connecting to uri: qemu+tcp:///system&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;error: unable to connect to libvirtd at 'localhost':
Connection refused&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;error: failed to connect to the hypervisor&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Indeed, with libvirt-opts="-d -l" in
etc/default//libvirt-bin the 'default' command also fails:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;$ virsh -c qemu:///system&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Connecting to uri: qemu:///system&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;error: unable to connect to 'var/run/libvirt/libvirt-sock':
Connection refused&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;error: failed to connect to the hypervisor&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Suggestions very welcome...&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;Tim McLeod&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;



</body></email><email><emailId>20100309015241</emailId><senderName>Robin Green</senderName><senderEmail>greenrd@greenrd.org</senderEmail><timestampReceived>2010-03-09 01:52:41-0400</timestampReceived><subject>Re: [libvirt-users] LXC: unable to configure networking for LXC</subject><body>

At Thu, 11 Mar 2010 14:08:48 +0200,
Avi Weit wrote:
&gt; I would like to set up sshd under an LXC application container and to be
&gt; able to connect into it from the host. I was able to achieve that with LXC
&gt; tools CLI after setting up a bridge via brctl and creating a proper
&gt; lxc.conf file for lxc-execute to use. However, I am unable to do so via
&gt; libvirt.

As far as I know, libvirt always assumes that the guest is responsible
for obtaining an IP address e.g. using DHCP (which makes perfect sense in
the context of virtualisation technologies which emulate a PC). So at
this time, I think you need to have a script which runs dhclient before
running sshd.

Another alternative is just to run a full Linux distribution inside LXC,
and then the LXC guest's init will be responsible for bringing up the
network. However, I haven't managed to do this (init just dies
immediately when I've tried it, on Fedora 12).

Regards,
-- 
Robin Green

</body></email><email><emailId>20100312134814</emailId><senderName>Tom Georgoulias</senderName><senderEmail>tomg@mcclatchyinteractive.com</senderEmail><timestampReceived>2010-03-12 13:48:14-0400</timestampReceived><subject>[libvirt-users] unable to get domain list of KVM guests from libvirt as non-root user</subject><body>

I have a python script that monitors the guest VMs on a servers running 
Xen, but the script doesn't work properly on a server I just built with 
KVM.  The script runs as a non-root user (same on all servers) and 
simply gathers some details on the status and names of the domains 
running on the host.

The Xen and KVM servers are running CentOS 5.4 x86_64 and are using the 
same version of libvirt:

libvirt-0.6.3-20.1.el5_4
libvirt-python-0.6.3-20.1.el5_4

Both Xen and KVM servers have the default libvirt.conf config file and 
the following /var/run/libvirt permissions:

KVM:

[root@kvm ~]# ls -l /var/run/libvirt
total 16
srwx------ 1 root root    0 Mar 12 08:37 libvirt-sock
srwxrwxrwx 1 root root    0 Mar 12 08:37 libvirt-sock-ro
drwxr-xr-x 2 root root 4096 Mar  8 13:05 network
drwxr-xr-x 2 root root 4096 Mar 11 16:17 qemu

Xen:

[root@xen ~]# ls -l /var/run/libvirt
total 16
srwx------ 1 root root    0 Feb  5 08:53 libvirt-sock
srwxrwxrwx 1 root root    0 Feb  5 08:53 libvirt-sock-ro
drwxr-xr-x 2 root root 4096 Jan 21 14:38 network
drwxr-xr-x 2 root root 4096 Oct 20 18:50 qemu

Kernel/hypervisor versions of Xen and KVM servers:

kernel-xen-2.6.18-164.9.1.el5
xen-3.0.3-94.el5_4.2

kvm-83-105.el5_4.27
kvm-qemu-img-83-105.el5_4.27
kernel-2.6.18-164.11.1.el5

To troubleshoot, I've been running python interactively as the non-root 
user.  Here's how my Xen servers behave:

[testu@xen ~]$ python
Python 2.4.3 (#1, Sep  3 2009, 15:37:37)
[GCC 4.1.2 20080704 (Red Hat 4.1.2-46)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
   &gt;&gt;&gt; import libvirt
   &gt;&gt;&gt; conn = libvirt.openReadOnly(None)
   &gt;&gt;&gt; domains = conn.listDomainsID()
   &gt;&gt;&gt; print domains
[0, 3, 15, 16, 21, 24, 26, 30, 32, 36, 38, 41, 43, 45, 47, 49, 51, 55,
63, 67]
   &gt;&gt;&gt;

When I try the same thing on the KVM server:

[testu@kvm ~]$ python
Python 2.4.3 (#1, Sep  3 2009, 15:37:37)
[GCC 4.1.2 20080704 (Red Hat 4.1.2-46)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
   &gt;&gt;&gt; import libvirt
   &gt;&gt;&gt; conn = libvirt.openReadOnly(None)
14:33:07.303: error : No vport operation path found for host0
14:33:07.320: error : No vport operation path found for host4
14:33:07.325: error : No vport operation path found for host3
14:33:07.367: error : No vport operation path found for host1
14:33:07.368: error : No vport operation path found for host2
   &gt;&gt;&gt; domains = conn.listDomainsID()
   &gt;&gt;&gt; print domains
[]
   &gt;&gt;&gt;

However, when logged in as root on the KVM server, it works just like my 
Xen servers:

[root@kvm ~]# python
Python 2.4.3 (#1, Sep  3 2009, 15:37:37)
[GCC 4.1.2 20080704 (Red Hat 4.1.2-46)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
   &gt;&gt;&gt; import libvirt
   &gt;&gt;&gt; conn = libvirt.openReadOnly(None)
   &gt;&gt;&gt; domains = conn.listDomainsID()
   &gt;&gt;&gt; print domains
[1]

As an experiment suggested by a someone on the centos-virt list, I 
modified the ownership and permissions of the socket files in 
/etc/libvirt/libvirtd.conf to use the same user running the python 
script.  That didn't make a difference.

[testu@kvm ~]$ ls -l /var/run/libvirt
total 16
srwxrwx--- 1 root testu     0 Mar 12 07:45 libvirt-sock
srwxrwxrwx 1 root testu     0 Mar 12 07:45 libvirt-sock-ro
drwxr-xr-x 2 root root   4096 Mar  8 13:05 network
drwxr-xr-x 2 root root   4096 Mar 11 16:17 qemu

[testu@kvm ~]$ python
Python 2.4.3 (#1, Sep  3 2009, 15:37:37)
[GCC 4.1.2 20080704 (Red Hat 4.1.2-46)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
  &gt;&gt;&gt; import libvirt
  &gt;&gt;&gt; conn = libvirt.openReadOnly(None)
07:45:56.893: error : No vport operation path found for host0
07:45:56.912: error : No vport operation path found for host4
07:45:56.919: error : No vport operation path found for host3
07:45:56.967: error : No vport operation path found for host1
07:45:56.968: error : No vport operation path found for host2
  &gt;&gt;&gt; domains = conn.listDomainsID()
  &gt;&gt;&gt; print domains
[]
  &gt;&gt;&gt;

Can someone give me some pointers on what to check next?  I'm running 
out of ideas.

Thanks,
Tom

</body></email><email><emailId>20100309211745</emailId><senderName>Jonathan Kelley</senderName><senderEmail>jkelley@vm-labs.com</senderEmail><timestampReceived>2010-03-09 21:17:45-0400</timestampReceived><subject>[libvirt-users] ESX support</subject><body>

Just curious but how long has ESX support been in libvirt?

Also I noticed this error when accessing one of my windows vms:

error: internal error Expecting VMX entry 'scsi0.virtualDev' to be
'buslogic' or 'lsilogic' but found 'lsisas1068'

Not sure whether this is an enhancement, defect, or not supported at this time.

Thanks.
-Jon

</body></email><email><emailId>20100312134938</emailId><senderName>Daniel Bidwell</senderName><senderEmail>bidwell@andrews.edu</senderEmail><timestampReceived>2010-03-12 13:49:38-0400</timestampReceived><subject>[libvirt-users] Problem with libvirt migration</subject><body>

I have two hosts, vm1 and vm2, which are both running libvirt 0.7.0.
They share a common ocfs2 file system that resides on a san, and have
identical network configurations.  I am running qemu-kvm 0.11.0 on
ubuntu 9.10 servers.

I start base32 on vm1 and it comes up (it also runs fine if started on
vm2).  Then from vm2 I do:
	vm2#: virsh -c qemu://vm1/system
	migrate --live base32 qemu://vm2/system

The migration starts and the vm2 virsh returns to the prompt.  vm2 shows
base32 as running and vm1 shows base32 as stopped.  The console for
base32 on vm2 is frozen and unresponsive.

I have the debug level set to 1 on both machines.

This is an excerpt from the virsh.log file from vm1:

8:19:40.772: debug : qemudDomainMigratePerform:6513 : base32: migrate reply: migrate \
"tcp:vm2.cc.andrews.edu:49152"

08:19:40.772: debug : qemudShutdownVMDaemon:2076 : Shutting down VM 'base32'

08:19:40.773: debug : virEventRemoveHandleImpl:173 : Remove handle 11
08:19:40.773: debug : virEventRemoveHandleImpl:186 : mark delete 9 19
08:19:40.773: debug : virEventInterruptLocked:640 : Interrupting
08:19:40.773: debug : virRun:796 : /usr/bin/virt-aa-helper -R -u \
libvirt-2469118c-9b90-44e3-a6ce-01a08bfe28f5 08:19:40.773: debug : \
virEventRunOnce:567 : Poll got 1 event 08:19:40.773: debug : \
virEventDispatchHandles:450 : Dispatch n=0 f=5 w=1 e=1 (nil) 08:19:40.773: debug : \
virEventDispatchHandles:440 : Skip deleted n=9 w=11 f=19 08:19:40.773: debug : \
virEventMakePollFDs:365 : Prepare n=0 w=1, f=5 e=1 08:19:40.773: debug : \
virEventMakePollFDs:365 : Prepare n=1 w=2, f=8 e=0 08:19:40.773: debug : \
virEventMakePollFDs:365 : Prepare n=2 w=3, f=8 e=1 08:19:40.773: debug : \
virEventMakePollFDs:365 : Prepare n=3 w=4, f=9 e=1 08:19:40.773: debug : \
virEventMakePollFDs:365 : Prepare n=4 w=5, f=3 e=1 08:19:40.774: debug : \
virEventMakePollFDs:365 : Prepare n=5 w=6, f=11 e=25 08:19:40.774: debug : \
virEventMakePollFDs:365 : Prepare n=6 w=7, f=12 e=25 08:19:40.774: debug : \
virEventMakePollFDs:365 : Prepare n=7 w=8, f=14 e=25 08:19:40.774: debug : \
virEventMakePollFDs:365 : Prepare n=8 w=9, f=15 e=1 08:19:40.774: debug : \
virEventMakePollFDs:365 : Prepare n=9 w=12, f=16 e=1 08:19:40.774: debug : \
virEventCalculateTimeout:313 : Calculate expiry of 3 timers 08:19:40.774: debug : \
virEventCalculateTimeout:343 : Timeout at 0 due in -1 ms 08:19:40.774: debug : \
virEventRunOnce:565 : Poll on 10 handles 0x2628850 timeout -1 08:19:40.960: debug : \
virEventUpdateTimeoutImpl:247 : Updating timer 1 timeout with 0 ms freq 08:19:40.960: \
debug : virEventInterruptLocked:640 : Interrupting 08:19:40.960: debug : \
virDomainFree:1922 : domain=0x2605c60 08:19:40.960: debug : virUnrefDomain:373 : \
unref domain 0x2605c60 base32 1 08:19:40.960: debug : virReleaseDomain:327 : release \
domain 0x2605c60 base32 08:19:40.960: debug : virReleaseDomain:343 : unref connection \
0x2679bd0 2 08:19:40.960: debug : virEventUpdateHandleImpl:146 : Update handle w=12 \
e=3

The logs on vm2 (destination host) are:

08:19:29.566: debug : virDomainMigratePrepare2:3233 : dconn=0x2096d50, \
cookie=0x7ff72bf59dc0, cookielen=0x7ff72bf59dcc, uri_in=(null), \
uri_out=0x20839f0,flags=1, dname=(null), bandwidth=0, dom_xml=&lt;domain type='kvm' \
id='1'&gt;  &lt;name&gt;base32&lt;/name&gt;
  &lt;uuid&gt;2469118c-9b90-44e3-a6ce-01a08bfe28f5&lt;/uuid&gt;
  &lt;memory&gt;262144&lt;/memory&gt;
  &lt;currentMemory&gt;262144&lt;/currentMemory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='i686' machine='pc-0.11'&gt;hvm&lt;/type&gt;
    &lt;boot dev='hd'/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
  &lt;/features&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;destroy&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;source file='/home/vms/base32/base32.vmdk'/&gt;
      &lt;target dev='hda' bus='ide'/&gt;
    &lt;/disk&gt;
    &lt;interface type='bridge'&gt;
      &lt;mac address='00:0c:29:db:97:14'/&gt;
      &lt;source bridge='br0'/&gt;
      &lt;target dev='vnet0'/&gt;
      &lt;model type='e1000'/&gt;
    &lt;/interface&gt;
    &lt;input type='mouse' bus='ps2'/&gt;
    &lt;graphics type='vnc' port='5900' autoport='yes' listen='127.0.0.1'/&gt;
    &lt;video&gt;
      &lt;model type='cirrus' vram='9216' heads='1'/&gt;
    &lt;/video&gt;
  &lt;/devices&gt;
  &lt;seclabel type='dynamic' model='apparmor'&gt;
    &lt;label&gt;libvirt-2469118c-9b90-44e3-a6ce-01a08bfe28f5&lt;/label&gt;
    &lt;imagelabel&gt;libvirt-2469118c-9b90-44e3-a6ce-01a08bfe28f5&lt;/imagelabel&gt;
  &lt;/seclabel&gt;
&lt;/domain&gt;

08:19:29.569: debug : virGetDomain:296 : New hash entry 0x20941a0
08:19:29.569: debug : virDomainGetUUIDString:2441 : domain=0x20941a0, \
buf=0x7ff72bf584f8 08:19:29.569: debug : virDomainGetUUID:2407 : domain=0x20941a0, \
uuid=0x7ff72bf58450 08:19:29.569: debug : virExecWithHook:607 : \
/usr/bin/virt-aa-helper -c -u libvirt-2469118c-9b90-44e3-a6ce-01a08bfe28f5 \
08:19:29.857: debug : virExecWithHook:607 : /usr/bin/kvm -help 08:19:29.865: debug : \
virEventRunOnce:567 : Poll got 1 event 08:19:29.871: debug : \
virEventDispatchHandles:450 : Dispatch n=4 f=3 w=5 e=1 0x2058040 08:19:29.871: info : \
qemudDispatchSignalEvent:370 : Received unexpected signal 17 08:19:29.871: debug : \
virEventMakePollFDs:365 : Prepare n=0 w=1, f=5 e=1 08:19:29.871: debug : \
virEventMakePollFDs:365 : Prepare n=1 w=2, f=8 e=0 08:19:29.871: debug : \
virEventMakePollFDs:365 : Prepare n=2 w=3, f=8 e=1 08:19:29.871: debug : \
virEventMakePollFDs:365 : Prepare n=3 w=4, f=9 e=1 08:19:29.871: debug : \
virEventMakePollFDs:365 : Prepare n=4 w=5, f=3 e=1 08:19:29.871: debug : \
virEventMakePollFDs:365 : Prepare n=5 w=6, f=11 e=25 08:19:29.871: debug : \
virEventMakePollFDs:365 : Prepare n=6 w=7, f=12 e=25 08:19:29.871: debug : \
virEventMakePollFDs:365 : Prepare n=7 w=8, f=14 e=25 08:19:29.871: debug : \
virEventMakePollFDs:365 : Prepare n=8 w=9, f=15 e=1 08:19:29.871: debug : \
virEventMakePollFDs:365 : Prepare n=9 w=11, f=16 e=1 08:19:29.871: debug : \
virEventCalculateTimeout:313 : Calculate expiry of 3 timers 08:19:29.871: debug : \
virEventCalculateTimeout:343 : Timeout at 0 due in -1 ms 08:19:29.871: debug : \
virEventRunOnce:565 : Poll on 10 handles 0x2091480 timeout -1 08:19:29.872: debug : \
virEventRunOnce:567 : Poll got 2 event 08:19:29.872: debug : \
virEventDispatchHandles:450 : Dispatch n=2 f=8 w=3 e=1 0x2074e90 08:19:29.872: debug \
: device_added:513 : net_4a_cf_74_02_5d_6c 08:19:29.872: debug : virExecWithHook:607 \
: /usr/bin/kvm -S -M pc-0.11 -cpu qemu32 -m 256 -smp 1 -name base32 -uuid \
2469118c-9b90-44e3-a6ce-01a08bfe28f5 -monitor \
unix:/var/run/libvirt/qemu/base32.monitor,server,nowait -boot c -drive \
file=/home/vms/base32/base32.vmdk,if=ide,index=0,boot=on -net \
nic,macaddr=00:0c:29:db:97:14,vlan=0,model=e1000,name=e1000.0 -net \
tap,fd=19,vlan=0,name=tap.0 -serial none -parallel none -usb -vnc 127.0.0.1:0 -vga \
cirrus -incoming tcp:0.0.0.0:49152 08:19:29.885: debug : virEventDispatchHandles:450 \
: Dispatch n=4 f=3 w=5 e=1 0x2058040 08:19:29.885: info : \
qemudDispatchSignalEvent:370 : Received unexpected signal 17 08:19:29.885: debug : \
virEventMakePollFDs:365 : Prepare n=0 w=1, f=5 e=1 08:19:29.885: debug : \
virEventMakePollFDs:365 : Prepare n=1 w=2, f=8 e=0 08:19:29.885: debug : \
virEventMakePollFDs:365 : Prepare n=2 w=3, f=8 e=1 08:19:29.885: debug : \
virEventMakePollFDs:365 : Prepare n=3 w=4, f=9 e=1 08:19:29.885: debug : \
virEventMakePollFDs:365 : Prepare n=4 w=5, f=3 e=1 08:19:29.885: debug : \
virEventMakePollFDs:365 : Prepare n=5 w=6, f=11 e=25 08:19:29.885: debug : \
virEventMakePollFDs:365 : Prepare n=6 w=7, f=12 e=25 08:19:29.885: debug : \
virEventMakePollFDs:365 : Prepare n=7 w=8, f=14 e=25 08:19:29.885: debug : \
virEventMakePollFDs:365 : Prepare n=8 w=9, f=15 e=1 08:19:29.885: debug : \
virEventMakePollFDs:365 : Prepare n=9 w=11, f=16 e=1 08:19:29.885: debug : \
virEventCalculateTimeout:313 : Calculate expiry of 3 timers 08:19:29.885: debug : \
virEventCalculateTimeout:343 : Timeout at 0 due in -1 ms 08:19:29.885: debug : \
virEventRunOnce:565 : Poll on 10 handles 0x2091480 timeout -1 08:19:29.885: debug : \
virEventRunOnce:567 : Poll got 1 event 08:19:29.885: debug : \
virEventDispatchHandles:450 : Dispatch n=4 f=3 w=5 e=1 0x2058040 08:19:29.885: info : \
qemudDispatchSignalEvent:370 : Received unexpected signal 17 08:19:29.885: debug : \
virEventMakePollFDs:365 : Prepare n=0 w=1, f=5 e=1 08:19:29.885: debug : \
virEventMakePollFDs:365 : Prepare n=1 w=2, f=8 e=0 08:19:29.885: debug : \
virEventMakePollFDs:365 : Prepare n=2 w=3, f=8 e=1 08:19:29.885: debug : \
virEventMakePollFDs:365 : Prepare n=3 w=4, f=9 e=1 08:19:29.885: debug : \
virEventMakePollFDs:365 : Prepare n=4 w=5, f=3 e=1 08:19:29.885: debug : \
virEventMakePollFDs:365 : Prepare n=5 w=6, f=11 e=25 08:19:29.885: debug : \
virEventMakePollFDs:365 : Prepare n=6 w=7, f=12 e=25 08:19:29.885: debug : \
virEventMakePollFDs:365 : Prepare n=7 w=8, f=14 e=25 08:19:29.885: debug : \
virEventMakePollFDs:365 : Prepare n=8 w=9, f=15 e=1 08:19:29.885: debug : \
virEventMakePollFDs:365 : Prepare n=9 w=11, f=16 e=1 08:19:29.885: debug : \
virEventCalculateTimeout:313 : Calculate expiry of 3 timers 08:19:29.885: debug : \
virEventCalculateTimeout:343 : Timeout at 0 due in -1 ms 08:19:29.885: debug : \
virEventRunOnce:565 : Poll on 10 handles 0x2091480 timeout -1 08:19:30.075: debug : \
virEventAddHandleImpl:112 : Add handle 19 0 0x425d40 0x2073710 08:19:30.075: debug : \
virEventAddHandleImpl:116 : Used 10 handle slots, adding 10 more 08:19:30.075: debug \
: virEventInterruptLocked:640 : Interrupting 08:19:30.075: debug : \
virEventRunOnce:567 : Poll got 1 event 08:19:30.075: debug : \
virEventDispatchHandles:450 : Dispatch n=0 f=5 w=1 e=1 (nil) 08:19:30.075: debug : \
virEventMakePollFDs:365 : Prepare n=0 w=1, f=5 e=1 08:19:30.075: debug : \
virEventMakePollFDs:365 : Prepare n=1 w=2, f=8 e=0 08:19:30.075: debug : \
virEventMakePollFDs:365 : Prepare n=2 w=3, f=8 e=1 08:19:30.075: debug : \
virEventMakePollFDs:365 : Prepare n=3 w=4, f=9 e=1 08:19:30.075: debug : \
virEventMakePollFDs:365 : Prepare n=4 w=5, f=3 e=1 08:19:30.075: debug : \
virEventMakePollFDs:365 : Prepare n=5 w=6, f=11 e=25 08:19:30.075: debug : \
virEventMakePollFDs:365 : Prepare n=6 w=7, f=12 e=25 08:19:30.075: debug : \
virEventMakePollFDs:365 : Prepare n=7 w=8, f=14 e=25 08:19:30.075: debug : \
virEventMakePollFDs:365 : Prepare n=8 w=9, f=15 e=1 08:19:30.075: debug : \
virEventMakePollFDs:365 : Prepare n=9 w=11, f=16 e=1 8:19:30.075: debug : \
virEventMakePollFDs:365 : Prepare n=10 w=12, f=19 e=0 08:19:30.075: debug : \
virEventCalculateTimeout:313 : Calculate expiry of 3 timers 08:19:30.075: debug : \
virEventCalculateTimeout:343 : Timeout at 0 due in -1 ms 08:19:30.075: debug : \
virEventRunOnce:565 : Poll on 11 handles 0x2091480 timeout -1 08:19:30.076: debug : \
qemudDomainSetMemoryBalloon:3175 : base32: balloon reply: balloon 256

08:19:30.077: debug : virEventUpdateTimeoutImpl:247 : Updating timer 1 timeout with 0 \
ms freq 08:19:30.077: debug : virEventInterruptLocked:640 : Interrupting
08:19:30.077: debug : virEventRunOnce:567 : Poll got 1 event
08:19:30.077: debug : virEventUpdateHandleImpl:146 : Update handle w=11 e=3
08:19:30.077: debug : virEventUpdateTimeoutImpl:247 : Updating timer 1 timeout with \
-1 ms freq 08:19:30.077: debug : virEventInterruptLocked:640 : Interrupting
08:19:30.077: debug : virEventInterruptLocked:636 : Skip interrupt, 1 846931856
08:19:30.077: debug : virEventDispatchHandles:450 : Dispatch n=0 f=5 w=1 e=1 (nil)
08:19:30.077: debug : virEventMakePollFDs:365 : Prepare n=0 w=1, f=5 e=1
08:19:30.077: debug : virEventMakePollFDs:365 : Prepare n=1 w=2, f=8 e=0
08:19:30.077: debug : virEventMakePollFDs:365 : Prepare n=2 w=3, f=8 e=1
08:19:30.077: debug : virEventMakePollFDs:365 : Prepare n=3 w=4, f=9 e=1
08:19:30.077: debug : virEventMakePollFDs:365 : Prepare n=4 w=5, f=3 e=1
08:19:30.077: debug : virEventMakePollFDs:365 : Prepare n=5 w=6, f=11 e=25
08:19:30.077: debug : virEventMakePollFDs:365 : Prepare n=6 w=7, f=12 e=25
08:19:30.077: debug : virEventMakePollFDs:365 : Prepare n=7 w=8, f=14 e=25
08:19:30.077: debug : virEventMakePollFDs:365 : Prepare n=8 w=9, f=15 e=1
08:19:30.077: debug : virEventMakePollFDs:365 : Prepare n=9 w=11, f=16 e=5
08:19:30.077: debug : virEventMakePollFDs:365 : Prepare n=10 w=12, f=19 e=0
08:19:30.077: debug : virEventCalculateTimeout:313 : Calculate expiry of 3 timers
08:19:30.077: debug : virEventCalculateTimeout:343 : Timeout at 0 due in -1 ms
08:19:30.077: debug : virEventRunOnce:565 : Poll on 11 handles 0x2091480 timeout -1
08:19:30.077: debug : virEventRunOnce:567 : Poll got 2 event
08:19:30.077: debug : virEventDispatchHandles:450 : Dispatch n=0 f=5 w=1 e=1 (nil)
08:19:30.077: debug : virEventDispatchHandles:450 : Dispatch n=9 f=16 w=11 e=4 \
0x2058040 08:19:30.078: debug : virEventUpdateHandleImpl:146 : Update handle w=11 e=1
08:19:30.078: debug : virEventInterruptLocked:636 : Skip interrupt, 1 846931856
08:19:30.078: debug : virEventMakePollFDs:365 : Prepare n=0 w=1, f=5 e=1
08:19:30.078: debug : virEventMakePollFDs:365 : Prepare n=1 w=2, f=8 e=0
08:19:30.078: debug : virEventMakePollFDs:365 : Prepare n=2 w=3, f=8 e=1
08:19:30.078: debug : virEventMakePollFDs:365 : Prepare n=3 w=4, f=9 e=1
08:19:30.078: debug : virEventMakePollFDs:365 : Prepare n=4 w=5, f=3 e=1
08:19:30.078: debug : virEventMakePollFDs:365 : Prepare n=5 w=6, f=11 e=25
08:19:30.078: debug : virEventMakePollFDs:365 : Prepare n=6 w=7, f=12 e=25
08:19:30.078: debug : virEventMakePollFDs:365 : Prepare n=7 w=8, f=14 e=25
08:19:30.078: debug : virEventMakePollFDs:365 : Prepare n=8 w=9, f=15 e=1
08:19:30.078: debug : virEventMakePollFDs:365 : Prepare n=9 w=11, f=16 e=1
08:19:30.078: debug : virEventMakePollFDs:365 : Prepare n=10 w=12, f=19 e=0
08:19:30.078: debug : virEventCalculateTimeout:313 : Calculate expiry of 3 timers
08:19:30.078: debug : virEventCalculateTimeout:343 : Timeout at 0 due in -1 ms
08:19:30.078: debug : virEventRunOnce:565 : Poll on 11 handles 0x2091480 timeout -1
08:19:40.936: debug : virEventRunOnce:567 : Poll got 1 event
08:19:40.936: debug : virEventDispatchHandles:450 : Dispatch n=9 f=16 w=11 e=1 \
0x2058040 08:19:40.937: debug : virEventUpdateHandleImpl:146 : Update handle w=11 e=1
08:19:40.937: debug : virEventInterruptLocked:636 : Skip interrupt, 1 846931856
08:19:40.937: debug : virEventUpdateHandleImpl:146 : Update handle w=11 e=1
08:19:40.937: debug : virEventInterruptLocked:636 : Skip interrupt, 1 846931856
08:19:40.937: debug : virEventMakePollFDs:365 : Prepare n=0 w=1, f=5 e=1
08:19:40.937: debug : virEventMakePollFDs:365 : Prepare n=1 w=2, f=8 e=0
08:19:40.937: debug : virEventMakePollFDs:365 : Prepare n=2 w=3, f=8 e=1
08:19:40.937: debug : virEventMakePollFDs:365 : Prepare n=3 w=4, f=9 e=1
08:19:40.937: debug : virEventMakePollFDs:365 : Prepare n=4 w=5, f=3 e=1
08:19:40.937: debug : virEventMakePollFDs:365 : Prepare n=5 w=6, f=11 e=25
08:19:40.937: debug : virEventMakePollFDs:365 : Prepare n=6 w=7, f=12 e=25
08:19:40.937: debug : virEventMakePollFDs:365 : Prepare n=7 w=8, f=14 e=25
08:19:40.937: debug : virEventMakePollFDs:365 : Prepare n=8 w=9, f=15 e=1
08:19:40.937: debug : virEventMakePollFDs:365 : Prepare n=9 w=11, f=16 e=1
08:19:40.937: debug : virEventMakePollFDs:365 : Prepare n=10 w=12, f=19 e=0
08:19:40.937: debug : virEventCalculateTimeout:313 : Calculate expiry of 3 timers
08:19:40.937: debug : virEventCalculateTimeout:343 : Timeout at 0 due in -1 ms
08:19:40.937: debug : virEventRunOnce:565 : Poll on 11 handles 0x2091480 timeout -1
08:19:40.937: debug : virDomainMigrateFinish2:3281 : dconn=0x2096d50, dname=base32, \
cookie=(nil), cookielen=0, uri=tcp:vm2.cc.andrews.edu:49152, flags=1, retcode=0 \
08:19:40.938: debug : virGetDomain:298 : Existing hash entry 0x20941a0: refs now 2 \
08:19:40.938: debug : virEventUpdateTimeoutImpl:247 : Updating timer 1 timeout with 0 \
ms freq 08:19:40.938: debug : virEventInterruptLocked:640 : Interrupting
08:19:40.938: debug : virEventUpdateHandleImpl:146 : Update handle w=11 e=3
08:19:40.938: debug : virEventInterruptLocked:640 : Interrupting

The migration appears to have completed successfully, but the console
doesn't respond to anything and neither does the ethernet.  Any ideas on
how to get past this last step?



-- 
Daniel R. Bidwell       |       bidwell@andrews.edu
Andrews University      |       Information Technology Services
If two always agree, one of them is unnecessary
"Friends don't let friends do DOS"
"In theory, theory and practice are the same.
In practice, however, they are not."


</body></email><email><emailId>20100304064906</emailId><senderName>anuj rampal</senderName><senderEmail>rampal.anuj@gmail.com</senderEmail><timestampReceived>2010-03-04 06:49:06-0400</timestampReceived><subject>[libvirt-users] Regarding SPICE</subject><body>

Hi,

I have set up KVM on FC12.
I was wondering if its possible to Display the VM using spice + libvirt?

As in, if I can define my domain with graphics like:

&lt;graphics type='spice' port='-1' autoport='yes' listen='0.0.0.0'/&gt;

                                           or

&lt;graphics type='spice' port='5903' ' listen='0.0.0.0'/&gt;

Thanks &amp; Regards
Anuj

[Attachment #3 (text/html)]

Hi,&lt;br&gt;&lt;br&gt;I have set up KVM on FC12.&lt;br&gt;I was wondering if its possible to Display \
the VM using spice + libvirt?&lt;br&gt;&lt;br&gt;As in, if I can define my domain with graphics \
like:&lt;br&gt;&lt;br&gt;&lt;graphics type='spice' port='-1' \
autoport='yes' listen='0.0.0.0'/&gt;&lt;br&gt; &lt;br&gt;                         \
or&lt;br&gt;&lt;br&gt;&lt;graphics type='spice' port='5903' ' \
listen='0.0.0.0'/&gt;&lt;br&gt;&lt;br&gt;Thanks &amp; Regards&lt;br&gt;Anuj&lt;br&gt;



</body></email><email><emailId>20100315182547</emailId><senderName>Don Morrison</senderName><senderEmail>dam@us.ibm.com</senderEmail><timestampReceived>2010-03-15 18:25:47-0400</timestampReceived><subject>[libvirt-users] Duplicate USB vendor,product specification</subject><body>


I studying how to attach USB devices to a KVM guest virtual machine using
libvirt. Using the "vendor" and "product" to specify the source device
seems like a good option since the "bus" and "device" values can change as
a device is removed and re-inserted. The question I have is what should I
expect to happen if I plug in two identical USB devices - so they have the
same vendor/product information? There is nothing in the documentation on
libvirt.org to address this case. Thanks.

Don Morrison

</body></email><email><emailId>20100304100130</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-03-04 10:01:30-0400</timestampReceived><subject>Re: [libvirt-users] Regarding SPICE</subject><body>

On Thu, Mar 04, 2010 at 12:07:06PM +0530, anuj rampal wrote:
&gt; Hi,
&gt; 
&gt; I have set up KVM on FC12.
&gt; I was wondering if its possible to Display the VM using spice + libvirt?

KVM in Fedora 12 does not support SPICE, since it is not merged in the
upstream repository.

Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100313170805</emailId><senderName>Jorge Somavilla</senderName><senderEmail>somavilla@dit.upm.es</senderEmail><timestampReceived>2010-03-13 17:08:05-0400</timestampReceived><subject>[libvirt-users] behaviour of "virsh shutdown domainName"</subject><body>

Hi all,

I am experiencing some problems with different versions of libvirt
(0.7.5 and 0.7.7), with a kvm (WinXP), host running Ubuntu 9.10, and i
would like to ask you two questions:

- In virsh, after running the command "shutdown domainName", what
should be the final state of the domain, if the shutdown finishes
correctly: "shutoff", "no-state", "inactive", or the domain shouldn't
show in "list --all" (full clean-up)?

- After the command "shutdown domainName", should i be able to run the
command "start domainName", without first defining the domain? (i.e.:
does shutdown "undefine" the domain?).

In my experience 0.7.5 used to leave the shut down domains as defined,
so i could run "start" right after. Testing in other hosts this
doesn't work always like that, and even if the domain apparently shuts
down correctly, the domain sometimes shows in "list --all", and
sometimes it doesn't. With libvirt 0.7.7 the domain never shows in
"list --all" after a successful shutdown, which makes me think it was
a bug and it has been corrected. Am i missing anything?

Any help would be much appreciated, thanks in advance.

Jorge Somavilla.

</body></email><email><emailId>20100317103803</emailId><senderName>Nicolas Greneche</senderName><senderEmail>nicolas.greneche@univ-orleans.fr</senderEmail><timestampReceived>2010-03-17 10:38:03-0400</timestampReceived><subject>[libvirt-users] Pool, iSCSI and guest start</subject><body>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hi,

Former user of Xen and newbie in kvm/qemu/libvirt stuff, I give it a try
on my network ;-)

I need to run a VM with iSCSI target attached.

I did it this way :

1) Creation of iscsi pool (equa.xml) :

&lt;pool type="iscsi"&gt;
&lt;name&gt;equalog&lt;/name&gt;
&lt;source&gt;
&lt;host name="10.10.0.1"/&gt;
&lt;device
path="iqn.2001-05.com.equallogic:0-8a0906-4992c7f05-39c000000114b8fc-vglog"/&gt;
&lt;/source&gt;
&lt;target&gt;
&lt;path&gt;/dev/disk/by-path&lt;/path&gt;
&lt;/target&gt;
&lt;/pool&gt;

This pool start smoothly (when open-iscsi started), no problems. An
entry is created in /dev/disk/by-path/ related to iscsi target.

2) I flagged it autostart :

root@sandi:~# virsh pool-autostart equalog
Pool equalog marked as autostarted

root@sandi:~# virsh pool-list
Name                 State      Autostart
- -----------------------------------------
equalog              active     yes

3) In my guest VM, I have following section :

    &lt;disk type='block' device='disk'&gt;
      &lt;driver name='qemu'/&gt;
      &lt;source
dev='/dev/disk/by-path/ip-10.10.0.1:3260-iscsi-iqn.2001-05.com.equallogic:0-8a0906-4992c7f05-39c000000114b8fc-vglog-lun-0'/&gt;
  &lt;target dev='vdc' bus='virtio'/&gt;
      &lt;alias name='virtio2'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x06'
function='0x0'/&gt;
    &lt;/disk&gt;

When I start VM, iscsi target is availaible.

The snag is that when I reboot the host, the pool is not automatically
started (making it impossible to autostart VM relying on this iscsi volume).

I verified that open-iscsi is started first. Startup script is localised
in /etc/rcS.d which is prior to /etc/rc2.d (my default runlevel).
Libvirtd is started in rc2.d and not mentionned in rcS.d.

My questions are :
- - Is this the correct way to attach iscsi volume to a guest ?
- - Did I missed something to have iscsi pool autostart working at boot
time ?

My environement :
Debian Squeeze 64 bits

root@sandi:~# virsh -v
0.7.6

root@sandi:~# /usr/sbin/libvirtd --version
/usr/sbin/libvirtd (libvirt) 0.7.6

Thanks for your attention,

- --
Nicolas Greneche -  RSSI et Sysadmin
Centre de Ressources Informatiques (CRI)
Doctorant au sein du projet SDS - www.sds-project.fr
Mail : nicolas.greneche_(at)_univ-orleans.fr
GPG  : http://pgp.mit.edu:11371/pks/lookup?op=get&amp;search=0x5FEBD0EF

Universite d'Orleans            Web  : http://blog.garnett.fr
Batiment 3IA - 2e etage         Tel  : 02 38 49 25 26
6 rue Leonard de Vinci
BP 6102 45061 ORLEANS Cedex 2
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iEYEARECAAYFAkugsQsACgkQTx/Y+1/r0O90NACeMvgK2mA4EUaB+JzA7v6+xQxO
jNsAmwSIh428gtZRa2jVkekyYBTpVVJK
=ltP0
-----END PGP SIGNATURE-----


</body></email><email><emailId>20100317151305</emailId><senderName>Dave Allan</senderName><senderEmail>dallan@redhat.com</senderEmail><timestampReceived>2010-03-17 15:13:05-0400</timestampReceived><subject>Re: [libvirt-users] Pool, iSCSI and guest start</subject><body>

On 03/17/2010 06:38 AM, Nicolas Greneche wrote:
&gt; -----BEGIN PGP SIGNED MESSAGE-----
&gt; Hash: SHA1
&gt; 
&gt; Hi,
&gt; 
&gt; Former user of Xen and newbie in kvm/qemu/libvirt stuff, I give it a try
&gt; on my network ;-)
&gt; 
&gt; I need to run a VM with iSCSI target attached.
&gt; 
&gt; I did it this way :
&gt; 
&gt; 1) Creation of iscsi pool (equa.xml) :
&gt; 
&gt; &lt;pool type="iscsi"&gt;
&gt; &lt;name&gt;equalog&lt;/name&gt;
&gt; &lt;source&gt;
&gt; &lt;host name="10.10.0.1"/&gt;
&gt; &lt;device
&gt; path="iqn.2001-05.com.equallogic:0-8a0906-4992c7f05-39c000000114b8fc-vglog"/&gt;
&gt; &lt;/source&gt;
&gt; &lt;target&gt;
&gt; &lt;path&gt;/dev/disk/by-path&lt;/path&gt;
&gt; &lt;/target&gt;
&gt; &lt;/pool&gt;
&gt; 
&gt; This pool start smoothly (when open-iscsi started), no problems. An
&gt; entry is created in /dev/disk/by-path/ related to iscsi target.
&gt; 
&gt; 2) I flagged it autostart :
&gt; 
&gt; root@sandi:~# virsh pool-autostart equalog
&gt; Pool equalog marked as autostarted
&gt; 
&gt; root@sandi:~# virsh pool-list
&gt; Name                 State      Autostart
&gt; - -----------------------------------------
&gt; equalog              active     yes
&gt; 
&gt; 3) In my guest VM, I have following section :
&gt; 
&gt; &lt;disk type='block' device='disk'&gt;
&gt; &lt;driver name='qemu'/&gt;
&gt; &lt;source
&gt; dev='/dev/disk/by-path/ip-10.10.0.1:3260-iscsi-iqn.2001-05.com.equallogic:0-8a0906-4992c7f05-39c000000114b8fc-vglog-lun-0'/&gt;
&gt;  &lt;target dev='vdc' bus='virtio'/&gt;
&gt; &lt;alias name='virtio2'/&gt;
&gt; &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x06'
&gt; function='0x0'/&gt;
&gt; &lt;/disk&gt;
&gt; 
&gt; When I start VM, iscsi target is availaible.
&gt; 
&gt; The snag is that when I reboot the host, the pool is not automatically
&gt; started (making it impossible to autostart VM relying on this iscsi volume).
&gt; 
&gt; I verified that open-iscsi is started first. Startup script is localised
&gt; in /etc/rcS.d which is prior to /etc/rc2.d (my default runlevel).
&gt; Libvirtd is started in rc2.d and not mentionned in rcS.d.
&gt; 
&gt; My questions are :
&gt; - - Is this the correct way to attach iscsi volume to a guest ?
&gt; - - Did I missed something to have iscsi pool autostart working at boot
&gt; time ?

You're doing everything right, so it's odd that the pool isn't 
autostarting.  Does the pool autostart properly if you restart libvirtd 
when the system is fully booted?

Dave


</body></email><email><emailId>20100319231554</emailId><senderName>Mike Viau</senderName><senderEmail>viaum@sheridanc.on.ca</senderEmail><timestampReceived>2010-03-19 23:15:54-0400</timestampReceived><subject>[libvirt-users] virsh domxml-to-native xen-xm request</subject><body>

[Attachment #2 (multipart/alternative)]


Hello,

I was looking at http://libvirt.org/drvxen.html

  

And realized that "virsh
domxml-to-native" may be used to convert the  libvirt xml formatted domU
configuration to native. 

The configuration is for stubdom-dm Xen guests.

Syntax appears to be virsh domxml-to-native xen-xm new_vm1.xml &gt; /etc/xen/new_vm1 but I get an error.

error: invalid argument in unsupported config type xen-xm


Can someone please post their output of the command: virsh domxml-to-native xen-xm new_vm1.xml 


The working libvirt XML formatted Xen DomU config (new_vm1.xml)
  




&lt;domain type='xen'&gt;

  &lt;name&gt;test&lt;/name&gt;

  &lt;os&gt;

    &lt;type&gt;hvm&lt;/type&gt;

    &lt;loader&gt;/usr/lib/xen/boot/hvmloader&lt;/loader&gt;

    &lt;boot dev='hd'/&gt;

  &lt;/os&gt;



  &lt;memory&gt;7340032&lt;/memory&gt;

  &lt;vcpu&gt;7&lt;/vcpu&gt;

  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;

  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;

  &lt;on_crash&gt;restart&lt;/on_crash&gt;

  &lt;features&gt;

     &lt;pae/&gt;

     &lt;acpi/&gt;

     &lt;apic/&gt;

  &lt;/features&gt;

  &lt;clock offset='utc'/&gt;



  &lt;devices&gt;

    &lt;emulator&gt;/usr/lib/xen/bin/stubdom-dm&lt;/emulator&gt;



    &lt;interface type='bridge'&gt;

      &lt;source bridge='eth0'/&gt;

      &lt;mac address='00:50:56:0f:dd:02'/&gt;

    &lt;/interface&gt;



    &lt;disk type='block' device='disk'&gt;

      &lt;source dev='/dev/sys/lv0'/&gt;

      &lt;target dev='hda'/&gt;

    &lt;/disk&gt;

    &lt;disk type='block' device='disk'&gt;

      &lt;source dev='/dev/sys/lv1'/&gt;

      &lt;target dev='hdb'/&gt;

    &lt;/disk&gt;

    &lt;disk type='block' device='disk'&gt;

      &lt;source dev='/dev/sys/lv2'/&gt;

      &lt;target dev='hdc'/&gt;

    &lt;/disk&gt;



&lt;!-- stub domains don't have access to dom0's ptys, so this is not
possible

    &lt;serial type='pty'&gt;

    &lt;/serial&gt;

--&gt;



    &lt;graphics type='vnc' autoport='yes'/&gt;



  &lt;/devices&gt;

&lt;/domain&gt;



-M
 		 	   		  
_________________________________________________________________
IM on the go with Messenger on your phone
http://go.microsoft.com/?linkid=9712960
[Attachment #5 (text/html)]

&lt;html&gt;
&lt;head&gt;
&lt;style&gt;&lt;!--
.hmmessage P
{
margin:0px;
padding:0px
}
body.hmmessage
{
font-size: 10pt;
font-family:Verdana
}
--&gt;&lt;/style&gt;
&lt;/head&gt;
&lt;body class='hmmessage'&gt;
Hello,&lt;br&gt;&lt;br&gt;I was looking at &lt;a \
href="http://libvirt.org/drvxen.html"&gt;http://libvirt.org/drvxen.html&lt;/a&gt;&lt;br&gt;  &lt;br&gt;
And realized that "&lt;code&gt;&lt;span style="font-size: 10pt; line-height: 115%;"&gt;virsh
domxml-to-native" &lt;/span&gt;&lt;/code&gt;may be used to convert the  libvirt xml formatted \
domU configuration to native. &lt;br&gt;&lt;br&gt;The configuration is for stubdom-dm Xen \
guests.&lt;br&gt;&lt;br&gt;Syntax appears to be virsh domxml-to-native xen-xm new_vm1.xml &gt; \
/etc/xen/new_vm1 but I get an error.&lt;br&gt;&lt;br&gt;error: invalid argument in unsupported \
config type xen-xm&lt;br&gt;&lt;br&gt;&lt;br&gt;Can someone please post their output of the command: \
virsh domxml-to-native xen-xm new_vm1.xml &lt;br&gt;&lt;br&gt;&lt;br&gt;The working libvirt XML \
formatted Xen DomU config (new_vm1.xml)  &lt;blockquote \
cite="mid:BAY107-W2306579368CDF6F44CAE3EEF2D0@phx.gbl"&gt; &lt;/blockquote&gt;
&lt;br&gt;&lt;br&gt;
&lt;domain type='xen'&gt;&lt;br&gt;
 &lt;name&gt;test&lt;/name&gt;&lt;br&gt;
 &lt;os&gt;&lt;br&gt;
 &lt;type&gt;hvm&lt;/type&gt;&lt;br&gt;
 &lt;loader&gt;/usr/lib/xen/boot/hvmloader&lt;/loader&gt;&lt;br&gt;
 &lt;boot dev='hd'/&gt;&lt;br&gt;
 &lt;/os&gt;&lt;br&gt;
&lt;br&gt;
 &lt;memory&gt;7340032&lt;/memory&gt;&lt;br&gt;
 &lt;vcpu&gt;7&lt;/vcpu&gt;&lt;br&gt;
 &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;&lt;br&gt;
 &lt;on_reboot&gt;restart&lt;/on_reboot&gt;&lt;br&gt;
 &lt;on_crash&gt;restart&lt;/on_crash&gt;&lt;br&gt;
 &lt;features&gt;&lt;br&gt;
 &lt;pae/&gt;&lt;br&gt;
 &lt;acpi/&gt;&lt;br&gt;
 &lt;apic/&gt;&lt;br&gt;
 &lt;/features&gt;&lt;br&gt;
 &lt;clock offset='utc'/&gt;&lt;br&gt;
&lt;br&gt;
 &lt;devices&gt;&lt;br&gt;
 &lt;emulator&gt;/usr/lib/xen/bin/stubdom-dm&lt;/emulator&gt;&lt;br&gt;
&lt;br&gt;
 &lt;interface type='bridge'&gt;&lt;br&gt;
 &lt;source bridge='eth0'/&gt;&lt;br&gt;
 &lt;mac address='00:50:56:0f:dd:02'/&gt;&lt;br&gt;
 &lt;/interface&gt;&lt;br&gt;
&lt;br&gt;
 &lt;disk type='block' device='disk'&gt;&lt;br&gt;
 &lt;source dev='/dev/sys/lv0'/&gt;&lt;br&gt;
 &lt;target dev='hda'/&gt;&lt;br&gt;
 &lt;/disk&gt;&lt;br&gt;
 &lt;disk type='block' device='disk'&gt;&lt;br&gt;
 &lt;source dev='/dev/sys/lv1'/&gt;&lt;br&gt;
 &lt;target dev='hdb'/&gt;&lt;br&gt;
 &lt;/disk&gt;&lt;br&gt;
 &lt;disk type='block' device='disk'&gt;&lt;br&gt;
 &lt;source dev='/dev/sys/lv2'/&gt;&lt;br&gt;
 &lt;target dev='hdc'/&gt;&lt;br&gt;
 &lt;/disk&gt;&lt;br&gt;
&lt;br&gt;
&lt;!-- stub domains don't have access to dom0's ptys, so this is not
possible&lt;br&gt;
 &lt;serial type='pty'&gt;&lt;br&gt;
 &lt;/serial&gt;&lt;br&gt;
--&gt;&lt;br&gt;
&lt;br&gt;
 &lt;graphics type='vnc' autoport='yes'/&gt;&lt;br&gt;
&lt;br&gt;
 &lt;/devices&gt;&lt;br&gt;
&lt;/domain&gt;&lt;br&gt;
&lt;br&gt;&lt;br&gt;-M&lt;br&gt; 		 	   		  &lt;br /&gt;&lt;hr /&gt;Don't miss a beat &lt;a \
href='http://go.microsoft.com/?linkid=9712961' target='_new'&gt;Get Messenger on your \
phone&lt;/a&gt;&lt;/body&gt; &lt;/html&gt;


["ATT00001" (text/plain)]

_______________________________________________
Xen-users mailing list
Xen-users@lists.xensource.com
http://lists.xensource.com/xen-users


</body></email><email><emailId>20100320101905</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-03-20 10:19:05-0400</timestampReceived><subject>Re: [libvirt-users] virsh domxml-to-native xen-xm request</subject><body>

2010/3/20 Mike Viau &lt;viaum@sheridanc.on.ca&gt;:
&gt; Hello,
&gt;
&gt; I was looking at http://libvirt.org/drvxen.html
&gt;
&gt; And realized that "virsh domxml-to-native" may be used to convert the
&gt; libvirt xml formatted domU configuration to native.
&gt;
&gt; The configuration is for stubdom-dm Xen guests.
&gt;
&gt; Syntax appears to be virsh domxml-to-native xen-xm new_vm1.xml &gt;
&gt; /etc/xen/new_vm1 but I get an error.
&gt;
&gt; error: invalid argument in unsupported config type xen-xm
&gt;
&gt;
&gt; Can someone please post their output of the command: virsh domxml-to-native
&gt; xen-xm new_vm1.xml
&gt;

Do you just run this command?

   virsh domxml-to-native xen-xm new_vm1.xml &gt; /etc/xen/new_vm1

If you don't specify an explicit connection URI, or have
VIRSH_DEFAULT_CONNECT_URI set to to some Xen connection URI, then
libvirt will try to autodetect your hypervisor and might find QEMU. In
that case I can reproduce the reported error.

To make it work you need to specify a proper connection URI, for example

   virsh -c xen:/// domxml-to-native xen-xm new_vm1.xml &gt; /etc/xen/new_vm1

or whatever URI you need for your setup.

Matthias

</body></email><email><emailId>20100320163158</emailId><senderName>Mike Viau</senderName><senderEmail>viaum@sheridanc.on.ca</senderEmail><timestampReceived>2010-03-20 16:31:58-0400</timestampReceived><subject>Re: [libvirt-users] virsh domxml-to-native xen-xm request</subject><body>

Sat, 20 Mar 2010 11:19:05 +0100 &lt;matthias.bolte@googlemail.com&gt;
&gt; 
&gt; 2010/3/20 Mike Viau &lt;viaum@sheridanc.on.ca&gt;:
&gt; &gt; Hello,
&gt; &gt; 
&gt; &gt; I was looking at http://libvirt.org/drvxen.html
&gt; &gt; 
&gt; &gt; And realized that "virsh domxml-to-native" may be used to convert the
&gt; &gt; libvirt xml formatted domU configuration to native.
&gt; &gt; 
&gt; &gt; The configuration is for stubdom-dm Xen guests.
&gt; &gt; 
&gt; &gt; Syntax appears to be virsh domxml-to-native xen-xm new_vm1.xml &gt;
&gt; &gt; /etc/xen/new_vm1 but I get an error.
&gt; &gt; 
&gt; &gt; error: invalid argument in unsupported config type xen-xm
&gt; &gt; 
&gt; &gt; 
&gt; &gt; Can someone please post their output of the command: virsh domxml-to-native
&gt; &gt; xen-xm new_vm1.xml
&gt; &gt; 
&gt; 
&gt; Do you just run this command?
&gt; 
&gt; virsh domxml-to-native xen-xm new_vm1.xml &gt; /etc/xen/new_vm1
&gt; 
&gt; If you don't specify an explicit connection URI, or have
&gt; VIRSH_DEFAULT_CONNECT_URI set to to some Xen connection URI, then
&gt; libvirt will try to autodetect your hypervisor and might find QEMU. In
&gt; that case I can reproduce the reported error.
&gt; 
&gt; To make it work you need to specify a proper connection URI, for example
&gt; 
&gt; virsh -c xen:/// domxml-to-native xen-xm new_vm1.xml &gt; /etc/xen/new_vm1
&gt; 
&gt; or whatever URI you need for your setup.
&gt; 
&gt; Matthias


I am still unable to get a native output file. Could someone please post the output \
of "virsh -c xen:/// domxml-to-native xen-xm new_vm1.xml &gt; /etc/xen/new_vm1"

On the libvirt XML formatted config below.

&lt;domain type='xen'&gt;

  &lt;name&gt;test&lt;/name&gt;

  &lt;os&gt;

    &lt;type&gt;hvm&lt;/type&gt;

    &lt;loader&gt;/usr/lib/xen/boot/hvmloader&lt;/loader&gt;

    &lt;boot dev='hd'/&gt;

  &lt;/os&gt;



  &lt;memory&gt;7340032&lt;/memory&gt;

  &lt;vcpu&gt;7&lt;/vcpu&gt;

  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;

  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;

  &lt;on_crash&gt;restart&lt;/on_crash&gt;

  &lt;features&gt;

     &lt;pae/&gt;

     &lt;acpi/&gt;

     &lt;apic/&gt;

  &lt;/features&gt;

  &lt;clock offset='utc'/&gt;



  &lt;devices&gt;

    &lt;emulator&gt;/usr/lib/xen/bin/stubdom-dm&lt;/emulator&gt;



    &lt;interface type='bridge'&gt;

      &lt;source bridge='eth0'/&gt;

      &lt;mac address='00:50:56:0f:dd:02'/&gt;

    &lt;/interface&gt;



    &lt;disk type='block' device='disk'&gt;

      &lt;source dev='/dev/sys/lv0'/&gt;

      &lt;target dev='hda'/&gt;

    &lt;/disk&gt;

    &lt;disk type='block' device='disk'&gt;

      &lt;source dev='/dev/sys/lv1'/&gt;

      &lt;target dev='hdb'/&gt;

    &lt;/disk&gt;

    &lt;disk type='block' device='disk'&gt;

      &lt;source dev='/dev/sys/lv2'/&gt;

      &lt;target dev='hdc'/&gt;

    &lt;/disk&gt;



&lt;!-- stub domains don't have access to dom0's ptys, so this is not
possible

    &lt;serial type='pty'&gt;

    &lt;/serial&gt;

--&gt;



    &lt;graphics type='vnc' autoport='yes'/&gt;



  &lt;/devices&gt;

&lt;/domain&gt;



-M


 		 	   		  
_________________________________________________________________
Stay in touch.
http://go.microsoft.com/?linkid=9712959


[Attachment #3 (text/html)]

&lt;html&gt;
&lt;head&gt;
&lt;style&gt;&lt;!--
.hmmessage P
{
margin:0px;
padding:0px
}
body.hmmessage
{
font-size: 10pt;
font-family:Verdana
}
--&gt;&lt;/style&gt;
&lt;/head&gt;
&lt;body class='hmmessage'&gt;
Sat, 20 Mar 2010 11:19:05 +0100 &lt;matthias.bolte@googlemail.com&gt;&lt;br&gt;&gt;&lt;br&gt;&gt; \
2010/3/20 Mike Viau &lt;viaum@sheridanc.on.ca&gt;:&lt;br&gt;&gt; &gt; Hello,&lt;br&gt;&gt; \
&gt;&lt;br&gt;&gt; &gt; I was looking at http://libvirt.org/drvxen.html&lt;br&gt;&gt; \
&gt;&lt;br&gt;&gt; &gt; And realized that "virsh domxml-to-native" may be used to convert \
the&lt;br&gt;&gt; &gt; libvirt xml formatted domU configuration to native.&lt;br&gt;&gt; \
&gt;&lt;br&gt;&gt; &gt; The configuration is for stubdom-dm Xen guests.&lt;br&gt;&gt; \
&gt;&lt;br&gt;&gt; &gt; Syntax appears to be virsh domxml-to-native xen-xm new_vm1.xml \
&gt;&lt;br&gt;&gt; &gt; /etc/xen/new_vm1 but I get an error.&lt;br&gt;&gt; &gt;&lt;br&gt;&gt; &gt; \
error: invalid argument in unsupported config type xen-xm&lt;br&gt;&gt; &gt;&lt;br&gt;&gt; \
&gt;&lt;br&gt;&gt; &gt; Can someone please post their output of the command: virsh \
domxml-to-native&lt;br&gt;&gt; &gt; xen-xm new_vm1.xml&lt;br&gt;&gt; &gt;&lt;br&gt;&gt; &lt;br&gt;&gt; Do you \
just run this command?&lt;br&gt;&gt; &lt;br&gt;&gt;    virsh domxml-to-native xen-xm new_vm1.xml \
&gt; /etc/xen/new_vm1&lt;br&gt;&gt; &lt;br&gt;&gt; If you don't specify an explicit connection \
URI, or have&lt;br&gt;&gt; VIRSH_DEFAULT_CONNECT_URI set to to some Xen connection URI, \
then&lt;br&gt;&gt; libvirt will try to autodetect your hypervisor and might find QEMU. \
In&lt;br&gt;&gt; that case I can reproduce the reported error.&lt;br&gt;&gt; &lt;br&gt;&gt; To make it \
work you need to specify a proper connection URI, for example&lt;br&gt;&gt; &lt;br&gt;&gt;    \
virsh -c xen:/// domxml-to-native xen-xm new_vm1.xml &gt; /etc/xen/new_vm1&lt;br&gt;&gt; \
&lt;br&gt;&gt; or whatever URI you need for your setup.&lt;br&gt;&gt; &lt;br&gt;&gt; \
Matthias&lt;br&gt;&lt;br&gt;&lt;br&gt;I am still unable to get a native output file. Could someone \
please post the output of "virsh -c xen:/// domxml-to-native xen-xm new_vm1.xml &gt; \
/etc/xen/new_vm1"&lt;br&gt;&lt;br&gt;On the libvirt XML formatted config below.&lt;br&gt;&lt;br&gt;&lt;domain \
type='xen'&gt;&lt;br&gt;  &lt;name&gt;test&lt;/name&gt;&lt;br&gt;
 &lt;os&gt;&lt;br&gt;
 &lt;type&gt;hvm&lt;/type&gt;&lt;br&gt;
 &lt;loader&gt;/usr/lib/xen/boot/hvmloader&lt;/loader&gt;&lt;br&gt;
 &lt;boot dev='hd'/&gt;&lt;br&gt;
 &lt;/os&gt;&lt;br&gt;
&lt;br&gt;
 &lt;memory&gt;7340032&lt;/memory&gt;&lt;br&gt;
 &lt;vcpu&gt;7&lt;/vcpu&gt;&lt;br&gt;
 &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;&lt;br&gt;
 &lt;on_reboot&gt;restart&lt;/on_reboot&gt;&lt;br&gt;
 &lt;on_crash&gt;restart&lt;/on_crash&gt;&lt;br&gt;
 &lt;features&gt;&lt;br&gt;
 &lt;pae/&gt;&lt;br&gt;
 &lt;acpi/&gt;&lt;br&gt;
 &lt;apic/&gt;&lt;br&gt;
 &lt;/features&gt;&lt;br&gt;
 &lt;clock offset='utc'/&gt;&lt;br&gt;
&lt;br&gt;
 &lt;devices&gt;&lt;br&gt;
 &lt;emulator&gt;/usr/lib/xen/bin/stubdom-dm&lt;/emulator&gt;&lt;br&gt;
&lt;br&gt;
 &lt;interface type='bridge'&gt;&lt;br&gt;
 &lt;source bridge='eth0'/&gt;&lt;br&gt;
 &lt;mac address='00:50:56:0f:dd:02'/&gt;&lt;br&gt;
 &lt;/interface&gt;&lt;br&gt;
&lt;br&gt;
 &lt;disk type='block' device='disk'&gt;&lt;br&gt;
 &lt;source dev='/dev/sys/lv0'/&gt;&lt;br&gt;
 &lt;target dev='hda'/&gt;&lt;br&gt;
 &lt;/disk&gt;&lt;br&gt;
 &lt;disk type='block' device='disk'&gt;&lt;br&gt;
 &lt;source dev='/dev/sys/lv1'/&gt;&lt;br&gt;
 &lt;target dev='hdb'/&gt;&lt;br&gt;
 &lt;/disk&gt;&lt;br&gt;
 &lt;disk type='block' device='disk'&gt;&lt;br&gt;
 &lt;source dev='/dev/sys/lv2'/&gt;&lt;br&gt;
 &lt;target dev='hdc'/&gt;&lt;br&gt;
 &lt;/disk&gt;&lt;br&gt;
&lt;br&gt;
&lt;!-- stub domains don't have access to dom0's ptys, so this is not
possible&lt;br&gt;
 &lt;serial type='pty'&gt;&lt;br&gt;
 &lt;/serial&gt;&lt;br&gt;
--&gt;&lt;br&gt;
&lt;br&gt;
 &lt;graphics type='vnc' autoport='yes'/&gt;&lt;br&gt;
&lt;br&gt;
 &lt;/devices&gt;&lt;br&gt;
&lt;/domain&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;-M&lt;br&gt;
&lt;br&gt; 		 	   		  &lt;br /&gt;&lt;hr /&gt;IM on the go with Messenger on your phone.  &lt;a \
href='http://go.microsoft.com/?linkid=9712960' target='_new'&gt;Try now.&lt;/a&gt;&lt;/body&gt; \
&lt;/html&gt;



</body></email><email><emailId>20100321151007</emailId><senderName>Sagar Dixit</senderName><senderEmail>sagar.dixit@gmail.com</senderEmail><timestampReceived>2010-03-21 15:10:07-0400</timestampReceived><subject>[libvirt-users] Migrating domains across nodes</subject><body>

Hi,

I am exploring the migration APIs and was curious to know if I can use them
with LXC containers for live migration from one node to another.
If not LXC, then can I use them with OpenVZ containers ?  If yes, what would
be the general steps involved.

Thanks,
Sagar

[Attachment #3 (text/html)]

Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I am exploring the migration APIs and was curious to=
 know if I can use them with LXC containers for live migration from one nod=
e to another.&lt;/div&gt;&lt;div&gt;If not LXC, then can I use them with OpenVZ contain=
ers ? =A0If yes, what would be the general steps involved.&lt;/div&gt;
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;Sagar&lt;/div&gt;


</body></email><email><emailId>20100322113247</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-03-22 11:32:47-0400</timestampReceived><subject>Re: [libvirt-users] Migrating domains across nodes</subject><body>

On Sun, Mar 21, 2010 at 11:10:07AM -0400, Sagar Dixit wrote:
&gt; Hi,
&gt; 
&gt; I am exploring the migration APIs and was curious to know if I can use them
&gt; with LXC containers for live migration from one node to another.
&gt; If not LXC, then can I use them with OpenVZ containers ?  If yes, what would
&gt; be the general steps involved.

No, there's no migration supported for either of these

Regards,
Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100317154611</emailId><senderName>Nicolas Greneche</senderName><senderEmail>nicolas.greneche@univ-orleans.fr</senderEmail><timestampReceived>2010-03-17 15:46:11-0400</timestampReceived><subject>Re: [libvirt-users] Pool, iSCSI and guest start</subject><body>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Dave Allan wrote:
&gt; On 03/17/2010 06:38 AM, Nicolas Greneche wrote:
&gt; &gt; -----BEGIN PGP SIGNED MESSAGE-----
&gt; &gt; Hash: SHA1
&gt; &gt; 
&gt; &gt; Hi,
&gt; &gt; 
&gt; &gt; Former user of Xen and newbie in kvm/qemu/libvirt stuff, I give it a try
&gt; &gt; on my network ;-)
&gt; &gt; 
&gt; &gt; I need to run a VM with iSCSI target attached.
&gt; &gt; 
&gt; &gt; I did it this way :
&gt; &gt; 
&gt; &gt; 1) Creation of iscsi pool (equa.xml) :
&gt; &gt; 
&gt; &gt; &lt;pool type="iscsi"&gt;
&gt; &gt; &lt;name&gt;equalog&lt;/name&gt;
&gt; &gt; &lt;source&gt;
&gt; &gt; &lt;host name="10.10.0.1"/&gt;
&gt; &gt; &lt;device
&gt; &gt; path="iqn.2001-05.com.equallogic:0-8a0906-4992c7f05-39c000000114b8fc-vglog"/&gt;
&gt; &gt; 
&gt; &gt; &lt;/source&gt;
&gt; &gt; &lt;target&gt;
&gt; &gt; &lt;path&gt;/dev/disk/by-path&lt;/path&gt;
&gt; &gt; &lt;/target&gt;
&gt; &gt; &lt;/pool&gt;
&gt; &gt; 
&gt; &gt; This pool start smoothly (when open-iscsi started), no problems. An
&gt; &gt; entry is created in /dev/disk/by-path/ related to iscsi target.
&gt; &gt; 
&gt; &gt; 2) I flagged it autostart :
&gt; &gt; 
&gt; &gt; root@sandi:~# virsh pool-autostart equalog
&gt; &gt; Pool equalog marked as autostarted
&gt; &gt; 
&gt; &gt; root@sandi:~# virsh pool-list
&gt; &gt; Name                 State      Autostart
&gt; &gt; - -----------------------------------------
&gt; &gt; equalog              active     yes
&gt; &gt; 
&gt; &gt; 3) In my guest VM, I have following section :
&gt; &gt; 
&gt; &gt; &lt;disk type='block' device='disk'&gt;
&gt; &gt; &lt;driver name='qemu'/&gt;
&gt; &gt; &lt;source
&gt; &gt; dev='/dev/disk/by-path/ip-10.10.0.1:3260-iscsi-iqn.2001-05.com.equallogic:0-8a0906-4992c7f05-39c000000114b8fc-vglog-lun-0'/&gt;
&gt; &gt;  
&gt; &gt; &lt;target dev='vdc' bus='virtio'/&gt;
&gt; &gt; &lt;alias name='virtio2'/&gt;
&gt; &gt; &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x06'
&gt; &gt; function='0x0'/&gt;
&gt; &gt; &lt;/disk&gt;
&gt; &gt; 
&gt; &gt; When I start VM, iscsi target is availaible.
&gt; &gt; 
&gt; &gt; The snag is that when I reboot the host, the pool is not automatically
&gt; &gt; started (making it impossible to autostart VM relying on this iscsi
&gt; &gt; volume).
&gt; &gt; 
&gt; &gt; I verified that open-iscsi is started first. Startup script is localised
&gt; &gt; in /etc/rcS.d which is prior to /etc/rc2.d (my default runlevel).
&gt; &gt; Libvirtd is started in rc2.d and not mentionned in rcS.d.
&gt; &gt; 
&gt; &gt; My questions are :
&gt; &gt; - - Is this the correct way to attach iscsi volume to a guest ?
&gt; &gt; - - Did I missed something to have iscsi pool autostart working at boot
&gt; &gt; time ?
&gt; 
&gt; You're doing everything right, so it's odd that the pool isn't
&gt; autostarting.  Does the pool autostart properly if you restart libvirtd
&gt; when the system is fully booted?
&gt; 
&gt; Dave
&gt; 
&gt; 

Yes it works with a libvirtd reboot on a fully booted system. I
submitted a bug to the maintainer of the libvirt-bin Debian package.

It's very odd because libvirtd starts very late in booting process.

root@sandi:~# ls /etc/rc2.d --format=single-column
README
S01qemu-kvm
S14portmap
S15nfs-common
S17rsyslog
S17sudo
S18acpid
S18atd
S18cron
S18dbus
S18exim4
S18postfix
S18ssh
S20bootlogs
S20libvirt-bin
S21rc.local
S21rmnologin
S21stop-bootlogd

Nicolas
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iEYEARECAAYFAkug+UMACgkQTx/Y+1/r0O/OvACgiojSVOovS773cWAM3sKPh4xF
AScAn0eBYiAY1KZKsoD2gFt4CpskpMie
=QoDT
-----END PGP SIGNATURE-----


</body></email><email><emailId>20100319084400</emailId><senderName>Nicolas Greneche</senderName><senderEmail>nicolas.greneche@univ-orleans.fr</senderEmail><timestampReceived>2010-03-19 08:44:00-0400</timestampReceived><subject>Re: [libvirt-users] Pool, iSCSI and guest start</subject><body>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Dave Allan wrote:
&gt; On 03/17/2010 06:38 AM, Nicolas Greneche wrote:
&gt; &gt; -----BEGIN PGP SIGNED MESSAGE-----
&gt; &gt; Hash: SHA1
&gt; &gt; 
&gt; &gt; Hi,
&gt; &gt; 
&gt; &gt; Former user of Xen and newbie in kvm/qemu/libvirt stuff, I give it a try
&gt; &gt; on my network ;-)
&gt; &gt; 
&gt; &gt; I need to run a VM with iSCSI target attached.
&gt; &gt; 
&gt; &gt; I did it this way :
&gt; &gt; 
&gt; &gt; 1) Creation of iscsi pool (equa.xml) :
&gt; &gt; 
&gt; &gt; &lt;pool type="iscsi"&gt;
&gt; &gt; &lt;name&gt;equalog&lt;/name&gt;
&gt; &gt; &lt;source&gt;
&gt; &gt; &lt;host name="10.10.0.1"/&gt;
&gt; &gt; &lt;device
&gt; &gt; path="iqn.2001-05.com.equallogic:0-8a0906-4992c7f05-39c000000114b8fc-vglog"/&gt;
&gt; &gt; 
&gt; &gt; &lt;/source&gt;
&gt; &gt; &lt;target&gt;
&gt; &gt; &lt;path&gt;/dev/disk/by-path&lt;/path&gt;
&gt; &gt; &lt;/target&gt;
&gt; &gt; &lt;/pool&gt;
&gt; &gt; 
&gt; &gt; This pool start smoothly (when open-iscsi started), no problems. An
&gt; &gt; entry is created in /dev/disk/by-path/ related to iscsi target.
&gt; &gt; 
&gt; &gt; 2) I flagged it autostart :
&gt; &gt; 
&gt; &gt; root@sandi:~# virsh pool-autostart equalog
&gt; &gt; Pool equalog marked as autostarted
&gt; &gt; 
&gt; &gt; root@sandi:~# virsh pool-list
&gt; &gt; Name                 State      Autostart
&gt; &gt; - -----------------------------------------
&gt; &gt; equalog              active     yes
&gt; &gt; 
&gt; &gt; 3) In my guest VM, I have following section :
&gt; &gt; 
&gt; &gt; &lt;disk type='block' device='disk'&gt;
&gt; &gt; &lt;driver name='qemu'/&gt;
&gt; &gt; &lt;source
&gt; &gt; dev='/dev/disk/by-path/ip-10.10.0.1:3260-iscsi-iqn.2001-05.com.equallogic:0-8a0906-4992c7f05-39c000000114b8fc-vglog-lun-0'/&gt;
&gt; &gt;  
&gt; &gt; &lt;target dev='vdc' bus='virtio'/&gt;
&gt; &gt; &lt;alias name='virtio2'/&gt;
&gt; &gt; &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x06'
&gt; &gt; function='0x0'/&gt;
&gt; &gt; &lt;/disk&gt;
&gt; &gt; 
&gt; &gt; When I start VM, iscsi target is availaible.
&gt; &gt; 
&gt; &gt; The snag is that when I reboot the host, the pool is not automatically
&gt; &gt; started (making it impossible to autostart VM relying on this iscsi
&gt; &gt; volume).
&gt; &gt; 
&gt; &gt; I verified that open-iscsi is started first. Startup script is localised
&gt; &gt; in /etc/rcS.d which is prior to /etc/rc2.d (my default runlevel).
&gt; &gt; Libvirtd is started in rc2.d and not mentionned in rcS.d.
&gt; &gt; 
&gt; &gt; My questions are :
&gt; &gt; - - Is this the correct way to attach iscsi volume to a guest ?
&gt; &gt; - - Did I missed something to have iscsi pool autostart working at boot
&gt; &gt; time ?
&gt; 
&gt; You're doing everything right, so it's odd that the pool isn't
&gt; autostarting.  Does the pool autostart properly if you restart libvirtd
&gt; when the system is fully booted?
&gt; 
&gt; Dave
&gt; 
&gt; 

Hi Dave,

It's a very odd problem. Making network debugging with tcpdump makes me
see that my network stack doesn't receive "arp reply" related to my target.

If I add an ARP entry by hand in cache or a sleep just before libvirtd
start function in startup script it works like a charm.

Very odd, I asked debian package maintainers for help :

http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=574358

Regards,

- --
Nicolas Greneche -  RSSI et Sysadmin
Centre de Ressources Informatiques (CRI)
Doctorant au sein du projet SDS - www.sds-project.fr
Mail : nicolas.greneche_(at)_univ-orleans.fr
GPG  : http://pgp.mit.edu:11371/pks/lookup?op=get&amp;search=0x5FEBD0EF

Universite d'Orleans            Web  : http://blog.garnett.fr
Batiment 3IA - 2e etage         Tel  : 02 38 49 25 26
6 rue Leonard de Vinci
BP 6102 45061 ORLEANS Cedex 2
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iEYEARECAAYFAkujOVAACgkQTx/Y+1/r0O8k7gCcCKYqVEzuhBnEzR3ykvCUcBEs
uesAoJa+3hi3mEiANIQyBbM08ghrTUIs
=RF1o
-----END PGP SIGNATURE-----


</body></email><email><emailId>20100319142125</emailId><senderName>Dave Allan</senderName><senderEmail>dallan@redhat.com</senderEmail><timestampReceived>2010-03-19 14:21:25-0400</timestampReceived><subject>Re: [libvirt-users] Pool, iSCSI and guest start</subject><body>

On 03/19/2010 04:44 AM, Nicolas Greneche wrote:
&gt; -----BEGIN PGP SIGNED MESSAGE-----
&gt; Hash: SHA1
&gt; 
&gt; Dave Allan wrote:
&gt; &gt; On 03/17/2010 06:38 AM, Nicolas Greneche wrote:
&gt; &gt; &gt; -----BEGIN PGP SIGNED MESSAGE-----
&gt; &gt; &gt; Hash: SHA1
&gt; &gt; &gt; 
&gt; &gt; &gt; Hi,
&gt; &gt; &gt; 
&gt; &gt; &gt; Former user of Xen and newbie in kvm/qemu/libvirt stuff, I give it a try
&gt; &gt; &gt; on my network ;-)
&gt; &gt; &gt; 
&gt; &gt; &gt; I need to run a VM with iSCSI target attached.
&gt; &gt; &gt; 
&gt; &gt; &gt; I did it this way :
&gt; &gt; &gt; 
&gt; &gt; &gt; 1) Creation of iscsi pool (equa.xml) :
&gt; &gt; &gt; 
&gt; &gt; &gt; &lt;pool type="iscsi"&gt;
&gt; &gt; &gt; &lt;name&gt;equalog&lt;/name&gt;
&gt; &gt; &gt; &lt;source&gt;
&gt; &gt; &gt; &lt;host name="10.10.0.1"/&gt;
&gt; &gt; &gt; &lt;device
&gt; &gt; &gt; path="iqn.2001-05.com.equallogic:0-8a0906-4992c7f05-39c000000114b8fc-vglog"/&gt;
&gt; &gt; &gt; 
&gt; &gt; &gt; &lt;/source&gt;
&gt; &gt; &gt; &lt;target&gt;
&gt; &gt; &gt; &lt;path&gt;/dev/disk/by-path&lt;/path&gt;
&gt; &gt; &gt; &lt;/target&gt;
&gt; &gt; &gt; &lt;/pool&gt;
&gt; &gt; &gt; 
&gt; &gt; &gt; This pool start smoothly (when open-iscsi started), no problems. An
&gt; &gt; &gt; entry is created in /dev/disk/by-path/ related to iscsi target.
&gt; &gt; &gt; 
&gt; &gt; &gt; 2) I flagged it autostart :
&gt; &gt; &gt; 
&gt; &gt; &gt; root@sandi:~# virsh pool-autostart equalog
&gt; &gt; &gt; Pool equalog marked as autostarted
&gt; &gt; &gt; 
&gt; &gt; &gt; root@sandi:~# virsh pool-list
&gt; &gt; &gt; Name                 State      Autostart
&gt; &gt; &gt; - -----------------------------------------
&gt; &gt; &gt; equalog              active     yes
&gt; &gt; &gt; 
&gt; &gt; &gt; 3) In my guest VM, I have following section :
&gt; &gt; &gt; 
&gt; &gt; &gt; &lt;disk type='block' device='disk'&gt;
&gt; &gt; &gt; &lt;driver name='qemu'/&gt;
&gt; &gt; &gt; &lt;source
&gt; &gt; &gt; dev='/dev/disk/by-path/ip-10.10.0.1:3260-iscsi-iqn.2001-05.com.equallogic:0-8a0906-4992c7f05-39c000000114b8fc-vglog-lun-0'/&gt;
&gt; &gt; &gt;  
&gt; &gt; &gt; &lt;target dev='vdc' bus='virtio'/&gt;
&gt; &gt; &gt; &lt;alias name='virtio2'/&gt;
&gt; &gt; &gt; &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x06'
&gt; &gt; &gt; function='0x0'/&gt;
&gt; &gt; &gt; &lt;/disk&gt;
&gt; &gt; &gt; 
&gt; &gt; &gt; When I start VM, iscsi target is availaible.
&gt; &gt; &gt; 
&gt; &gt; &gt; The snag is that when I reboot the host, the pool is not automatically
&gt; &gt; &gt; started (making it impossible to autostart VM relying on this iscsi
&gt; &gt; &gt; volume).
&gt; &gt; &gt; 
&gt; &gt; &gt; I verified that open-iscsi is started first. Startup script is localised
&gt; &gt; &gt; in /etc/rcS.d which is prior to /etc/rc2.d (my default runlevel).
&gt; &gt; &gt; Libvirtd is started in rc2.d and not mentionned in rcS.d.
&gt; &gt; &gt; 
&gt; &gt; &gt; My questions are :
&gt; &gt; &gt; - - Is this the correct way to attach iscsi volume to a guest ?
&gt; &gt; &gt; - - Did I missed something to have iscsi pool autostart working at boot
&gt; &gt; &gt; time ?
&gt; &gt; 
&gt; &gt; You're doing everything right, so it's odd that the pool isn't
&gt; &gt; autostarting.  Does the pool autostart properly if you restart libvirtd
&gt; &gt; when the system is fully booted?
&gt; &gt; 
&gt; &gt; Dave
&gt; &gt; 
&gt; &gt; 
&gt; 
&gt; Hi Dave,
&gt; 
&gt; It's a very odd problem. Making network debugging with tcpdump makes me
&gt; see that my network stack doesn't receive "arp reply" related to my target.
&gt; 
&gt; If I add an ARP entry by hand in cache or a sleep just before libvirtd
&gt; start function in startup script it works like a charm.
&gt; 
&gt; Very odd, I asked debian package maintainers for help :
&gt; 
&gt; http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=574358

Are the appropriate network interfaces started/configured?


</body></email><email><emailId>20100315164817</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-03-15 16:48:17-0400</timestampReceived><subject>Re: [libvirt-users] behaviour of "virsh shutdown domainName"</subject><body>

On Sat, Mar 13, 2010 at 06:08:05PM +0100, Jorge Somavilla wrote:
&gt; Hi all,
&gt; 
&gt; I am experiencing some problems with different versions of libvirt
&gt; (0.7.5 and 0.7.7), with a kvm (WinXP), host running Ubuntu 9.10, and i
&gt; would like to ask you two questions:
&gt; 
&gt; - In virsh, after running the command "shutdown domainName", what
&gt; should be the final state of the domain, if the shutdown finishes
&gt; correctly: "shutoff", "no-state", "inactive", or the domain shouldn't
&gt; show in "list --all" (full clean-up)?

There are two types of guest in libvirt

 - persistent - they have a config file stored on disk
 - transient - no config file &amp; only exist while running


If you run 'shutdown' on a  persistent guest, the final state should
be 'shutoff'. For a transient guest, it will go away completely not
ever visible again.

NB, 'shutdown' is merely a *request* to shutdown. There is no
guarentee that the guest OS will honour this request. If it does
not, then you will have to kill the guest forcefully (virsh destroy)
which removes the virtual power plug.


&gt; - After the command "shutdown domainName", should i be able to run the
&gt; command "start domainName", without first defining the domain? (i.e.:
&gt; does shutdown "undefine" the domain?).

No, shutdown is merely a request to shutdown. It won't touch the
configs on disk. You will also have to watch to see if it actually
shuts down before you can run start again.

&gt; In my experience 0.7.5 used to leave the shut down domains as defined,
&gt; so i could run "start" right after. Testing in other hosts this
&gt; doesn't work always like that, and even if the domain apparently shuts
&gt; down correctly, the domain sometimes shows in "list --all", and
&gt; sometimes it doesn't. With libvirt 0.7.7 the domain never shows in
&gt; "list --all" after a successful shutdown, which makes me think it was
&gt; a bug and it has been corrected. Am i missing anything?

To best of my knowledge, there is no change in semantics between these
two versions.

Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100304110339</emailId><senderName>anuj rampal</senderName><senderEmail>rampal.anuj@gmail.com</senderEmail><timestampReceived>2010-03-04 11:03:39-0400</timestampReceived><subject>Re: [libvirt-users] Regarding SPICE</subject><body>

Hi,

Thanks a lot for the reply.

Is it going to be there in the future?

And i wanted to confirm one more thing...
KVM on RHEL 5.4 supports SPICE through libvirt?
Because there were some patches regarding " Implement RHEL-5.4 support for
SPICE graphics"

Regards
Anuj


On Thu, Mar 4, 2010 at 3:31 PM, Daniel P. Berrange &lt;berrange@redhat.com&gt;wrote:

&gt; On Thu, Mar 04, 2010 at 12:07:06PM +0530, anuj rampal wrote:
&gt; &gt; Hi,
&gt; &gt;
&gt; &gt; I have set up KVM on FC12.
&gt; &gt; I was wondering if its possible to Display the VM using spice + libvirt?
&gt;
&gt; KVM in Fedora 12 does not support SPICE, since it is not merged in the
&gt; upstream repository.
&gt;
&gt; Daniel
&gt; --
&gt; |: Red Hat, Engineering, London    -o-
&gt; http://people.redhat.com/berrange/ :|
&gt; |: http://libvirt.org -o- http://virt-manager.org -o-
&gt; http://deltacloud.org :|
&gt; |: http://autobuild.org        -o-
&gt; http://search.cpan.org/~danberr/ &lt;http://search.cpan.org/%7Edanberr/&gt; :|
&gt; |: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505
&gt; :|
&gt;

[Attachment #3 (text/html)]

Hi,&lt;br&gt;&lt;br&gt;Thanks a lot for the reply.&lt;br&gt;&lt;br&gt;Is it  going to be there in the \
future?&lt;br&gt;&lt;br&gt;And i wanted to confirm one more thing...&lt;br&gt;KVM on RHEL 5.4 supports \
SPICE through libvirt?&lt;br&gt;Because there were some patches regarding " Implement \
RHEL-5.4 support for SPICE graphics"&lt;br&gt; &lt;br clear="all"&gt;Regards&lt;br&gt;Anuj&lt;br&gt;
&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;On Thu, Mar 4, 2010 at 3:31 PM, Daniel P. Berrange \
&lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:berrange@redhat.com"&gt;berrange@redhat.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;&lt;blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; \
border-left: 1px solid rgb(204, 204, 204); padding-left: 1ex;"&gt; &lt;div class="im"&gt;On \
Thu, Mar 04, 2010 at 12:07:06PM +0530, anuj rampal wrote:&lt;br&gt; &gt; Hi,&lt;br&gt;
&gt;&lt;br&gt;
&gt; I have set up KVM on FC12.&lt;br&gt;
&gt; I was wondering if its possible to Display the VM using spice + libvirt?&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;KVM in Fedora 12 does not support SPICE, since it is not merged in the&lt;br&gt;
upstream repository.&lt;br&gt;
&lt;br&gt;
Daniel&lt;br&gt;
&lt;font color="#888888"&gt;--&lt;br&gt;
&gt; &gt; Red Hat, Engineering, London    -o-   &lt;a \
&gt; &gt; href="http://people.redhat.com/berrange/" \
&gt; &gt; target="_blank"&gt;http://people.redhat.com/berrange/&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; &lt;a href="http://libvirt.org" target="_blank"&gt;http://libvirt.org&lt;/a&gt; -o- &lt;a \
&gt; &gt; href="http://virt-manager.org" target="_blank"&gt;http://virt-manager.org&lt;/a&gt; -o- &lt;a \
&gt; &gt; href="http://deltacloud.org" target="_blank"&gt;http://deltacloud.org&lt;/a&gt; :|&lt;br&gt;

&gt; &gt; &lt;a href="http://autobuild.org" target="_blank"&gt;http://autobuild.org&lt;/a&gt;        \
&gt; &gt; -o-         &lt;a href="http://search.cpan.org/%7Edanberr/" \
&gt; &gt; target="_blank"&gt;http://search.cpan.org/~danberr/&lt;/a&gt; :|&lt;br&gt;
&gt; &gt; GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|&lt;br&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;



</body></email><email><emailId>20100407033106</emailId><senderName>Aaron Lippold</senderName><senderEmail>lippold@gmail.com</senderEmail><timestampReceived>2010-04-07 03:31:06-0400</timestampReceived><subject>Re: [libvirt-users] ESX support</subject><body>

Hi Matthias,

Sorry for the late reply. I was on travel with limited network access last week.

That sounds great, if you need any help or someone to test stuff,
please let me know since I am highly interested in helping in any way
I can.

First question, when I am testing can I use VMWare Workstation on my
laptop as a replacement for a full fledged for just testing API and
libVirt access? If so I can set that up on my F12 box and start
running some tests with libvirt and cobbler.

Any new updates on the storage and network efforts? What are the basic
requirements that you are going to try to initially hit. I assume
there is alway more you could do but what's your 1.0 'good to go' set?

Thanks,

Aaron

On Sun, Mar 21, 2010 at 1:26 PM, Matthias Bolte
&lt;matthias.bolte@googlemail.com&gt; wrote:
&gt; You can manage the power state of a domain (start, stop, suspend, and
&gt; resume), you can also define a new domain, undefine existing domains,
&gt; migrate domains between hosts and configure CPU and RAM limits of a
&gt; domain.
&gt;
&gt; Two major missing features are currently storage and network
&gt; management. This means that you currently cannot use the libvirt
&gt; storage and network API to manage the storage and network of an ESX
&gt; server. I'm going to address this soon.
&gt;
&gt; A minor missing feature is editing the virtual hardware configuration
&gt; of an existing domain. I'm currently working on this.
&gt;
&gt; The problem reported by Jonathan Kelley affects ESX 4.0 only. It's not
&gt; fixed yet, but I think I can get it fixed for libvirt 0.7.8. I've
&gt; withdrawn the first patch fix this issue. A better patch is more
&gt; involved, because I need to rework the controller handling internally.
&gt;
&gt; Documentation about the ESX support can be found at:
&gt; http://www.libvirt.org/drvesx.html
&gt;
&gt; If you have any questions about the ESX support feel free to ask.
&gt;
&gt; Matthias
&gt;
&gt; 2010/3/19 Aaron Lippold &lt;lippold@gmail.com&gt;:
&gt;&gt; Hi,
&gt;&gt;
&gt;&gt; So google and the mailing list didn't clearly state if we could or
&gt;&gt; couldn't create a new vm in a domain on ESX or just turn it on, off,
&gt;&gt; restart etc.
&gt;&gt;
&gt;&gt; Has the XML generation issue been addressed in 0.7.6+? If the docs
&gt;&gt; exist, please point me to them and I will be glad to RT*M :).
&gt;&gt;
&gt;&gt; Thanks,
&gt;&gt;
&gt;&gt; A
&gt;&gt;
&gt;&gt; On Fri, Mar 12, 2010 at 4:21 PM, Matthias Bolte
&gt;&gt; &lt;matthias.bolte@googlemail.com&gt; wrote:
&gt;&gt;&gt; 2010/3/9 Jonathan Kelley &lt;jkelley@vm-labs.com&gt;:
&gt;&gt;&gt;&gt; Just curious but how long has ESX support been in libvirt?
&gt;&gt;&gt;
&gt;&gt;&gt; Since version 0.7.0 (August 2009).
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Also I noticed this error when accessing one of my windows vms:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; error: internal error Expecting VMX entry 'scsi0.virtualDev' to be
&gt;&gt;&gt;&gt; 'buslogic' or 'lsilogic' but found 'lsisas1068'
&gt;&gt;&gt;
&gt;&gt;&gt; I've just posted a patch to add lsisas1068 to the list of known SCSI
&gt;&gt;&gt; controller types.
&gt;&gt;&gt;
&gt;&gt;&gt; Thanks for reporting.
&gt;&gt;&gt;
&gt;&gt;&gt; Matthias
&gt;&gt;&gt;
&gt;&gt;
&gt;

</body></email><email><emailId>20100312141823</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2010-03-12 14:18:23-0400</timestampReceived><subject>Re: [libvirt-users] unable to get domain list of KVM guests from libvirt as non-root user</subject><body>

On Fri, Mar 12, 2010 at 08:48:14AM -0500, Tom Georgoulias wrote:
&gt; I have a python script that monitors the guest VMs on a servers
&gt; running Xen, but the script doesn't work properly on a server I just
&gt; built with KVM.  The script runs as a non-root user (same on all
&gt; servers) and simply gathers some details on the status and names of
&gt; the domains running on the host.
&gt; 
&gt; The Xen and KVM servers are running CentOS 5.4 x86_64 and are using
&gt; the same version of libvirt:
&gt; 
&gt; libvirt-0.6.3-20.1.el5_4
&gt; libvirt-python-0.6.3-20.1.el5_4
&gt; 
&gt; Both Xen and KVM servers have the default libvirt.conf config file
&gt; and the following /var/run/libvirt permissions:
&gt; 
[...]
&gt; When I try the same thing on the KVM server:
&gt; 
&gt; [testu@kvm ~]$ python
&gt; Python 2.4.3 (#1, Sep  3 2009, 15:37:37)
&gt; [GCC 4.1.2 20080704 (Red Hat 4.1.2-46)] on linux2
&gt; Type "help", "copyright", "credits" or "license" for more information.
&gt;   &gt;&gt;&gt; import libvirt
&gt;   &gt;&gt;&gt; conn = libvirt.openReadOnly(None)
&gt; 14:33:07.303: error : No vport operation path found for host0
&gt; 14:33:07.320: error : No vport operation path found for host4
&gt; 14:33:07.325: error : No vport operation path found for host3
&gt; 14:33:07.367: error : No vport operation path found for host1
&gt; 14:33:07.368: error : No vport operation path found for host2

  http://libvirt.org/uri.html

try libvirt.openReadOnly("qemu:///system")

Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

</body></email><email><emailId>20100311120848</emailId><senderName>Avi Weit</senderName><senderEmail>weit@il.ibm.com</senderEmail><timestampReceived>2010-03-11 12:08:48-0400</timestampReceived><subject>[libvirt-users]  LXC: unable to configure networking for LXC</subject><body>


Hello,

I would like to set up sshd under an LXC application container and to be
able to connect into it from the host. I was able to achieve that with LXC
tools CLI after setting up a bridge via brctl and creating a proper
lxc.conf file for lxc-execute to use. However, I am unable to do so via
libvirt. I am using libvirt version 0.7.1 installed on fedora 12.

I first verified that the default network is up

[root@enc12 avi]# virsh net-list --all
Name                 State      Autostart
-----------------------------------------
default              active     yes

and that the bridge exists

[root@enc12 avi]# brctl show
bridge name     bridge id               STP enabled     interfaces
virbr0          8000.000000000000       yes

I then went over the explanations under
http://www.libvirt.org/formatdomain.html#elementsNICS and
http://wiki.libvirt.org/page/Networking

and made sure net.ipv4.ip_forward = 1 under file /etc/sysctl.conf on the
host

after that, I created a container with the following xml specification:

&lt;domain type='lxc'&gt;
  &lt;name&gt;ssh9&lt;/name&gt;
  &lt;memory&gt;500000&lt;/memory&gt;
  &lt;os&gt;
    &lt;type&gt;exe&lt;/type&gt;
    &lt;init&gt;/usr/sbin/sshd&lt;/init&gt;
  &lt;/os&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;destroy&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/libexec/libvirt_lxc&lt;/emulator&gt;
    &lt;interface type='network'&gt;
      &lt;source network='default'/&gt;
   &lt;/interface&gt;
    &lt;console type='pty' /&gt;
  &lt;/devices&gt;
&lt;/domain&gt;

Below is the command that verifies LXC is running followed by dumpxml:

[root@enc12 avi]# virsh -c lxc:/// list --all
 Id Name                 State
----------------------------------
1551 ssh9                 running

&lt;domain type='lxc' id='1551'&gt;
  &lt;name&gt;ssh9&lt;/name&gt;
  &lt;uuid&gt;ead3dc4f-9b3f-eec0-e83a-1d87e0ffb1eb&lt;/uuid&gt;
  &lt;memory&gt;500000&lt;/memory&gt;
  &lt;currentMemory&gt;500000&lt;/currentMemory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='i686'&gt;exe&lt;/type&gt;
    &lt;init&gt;/usr/sbin/sshd&lt;/init&gt;
  &lt;/os&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;destroy&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/libexec/libvirt_lxc&lt;/emulator&gt;
    &lt;interface type='network'&gt;
      &lt;mac address='52:54:00:e8:e3:dd'/&gt;
      &lt;source network='default'/&gt;
      &lt;target dev='veth0'/&gt;
    &lt;/interface&gt;
    &lt;console type='pty' tty='/dev/pts/1'&gt;
      &lt;source path='/dev/pts/1'/&gt;
      &lt;target port='0'/&gt;
    &lt;/console&gt;
  &lt;/devices&gt;
&lt;/domain&gt;

However, I can not see the IP address of the container so was not able to
connect it. I can also see that the routing table configured on the host -
routes any address destined to network 192.168.122 - into the bridge and I
understood that the container should have constructed with one of the IPs
in the range of 192.168.122.2 to 192.168.122.254 (as defined in dhcp tag
under default network) but it did not happen.

Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use
Iface
9.148.28.32     *               255.255.255.240 U     1      0        0
eth0
192.168.122.0   *               255.255.255.0   U     0      0        0
virbr0
default         9.148.28.33     0.0.0.0         UG    0      0        0
eth0

I wonder what am  I missing here.

Thanks,
- Avi

</body></email><email><emailId>20100309054140</emailId><senderName>Zhang Qian</senderName><senderEmail>zhq527725@gmail.com</senderEmail><timestampReceived>2010-03-09 05:41:40-0400</timestampReceived><subject>[libvirt-users] No qemu-dm process for running domain</subject><body>

Hi,

My C application is using libvirt to operate domains, but I found when I
started a domain with my application, there was no qemu-dm for this running
VM, and I can not access this domain with the graphic console provided by
virt-manager. But if I started the same domain with virsh which linked with
the libvirt shipped in OS, everything was OK, there will be a qemu-dm
process for the running domain, and the graphic console provided by
virt-manager worked well.

The libvirt used by my application is libvirt-0.6.4, I just downloaded
libvirt-0.6.4.tar.gz from
http://libvirt.org/sources/old/libvirt-0.6.4.tar.gz, and I built it by
running "./configure --prefix=/usr &amp;&amp; make". Here are the details of my
machine:

# cat /etc/redhat-release
Scientific Linux SL release 5.4 (Boron)

# uname -an
Linux ib06b07 2.6.18-164.11.1.el5xen #1 SMP Wed Jan 20 08:53:10 EST 2010
i686 i686 i386 GNU/Linux


Was there anything wrong when I built libvirt-0.6.4? Should I enable some
compilation options for launching qemu-dm process for running domains?
Any suggestions will be really appreciated, thanks in advance!



Regards,
Qian

[Attachment #3 (text/html)]

Hi,&lt;br&gt;&lt;br&gt;My C application is using libvirt to operate domains, but I found when I \
started a domain with my application, there was no qemu-dm for this running VM, and I \
can not access this domain with the graphic console provided by virt-manager. But if \
I started the same domain with virsh which linked with the libvirt shipped in OS, \
everything was OK, there will be a qemu-dm process for the running domain, and the \
graphic console provided by virt-manager worked well.&lt;br&gt; &lt;br&gt;The libvirt used by my \
application is libvirt-0.6.4, I just downloaded libvirt-0.6.4.tar.gz from &lt;a \
href="http://libvirt.org/sources/old/libvirt-0.6.4.tar.gz"&gt;http://libvirt.org/sources/old/libvirt-0.6.4.tar.gz&lt;/a&gt;, \
and I built it by running "&lt;meta http-equiv="Content-Type" content="text/html; \
charset=utf-8"&gt;&lt;meta name="ProgId" content="Word.Document"&gt;&lt;meta name="Generator" \
content="Microsoft Word 11"&gt;&lt;meta name="Originator" content="Microsoft Word 11"&gt;&lt;link \
rel="File-List" href="file:///C:%5CDOCUME%7E1%5Cqzhang%5CLOCALS%7E1%5CTemp%5Cmsohtml1%5C01%5Cclip_filelist.xml"&gt;&lt;style&gt;
 &lt;!--
 /* Font Definitions */
 @font-face
	{font-family:;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimSun;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:"\@";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	font-size:10.5pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:;
	mso-font-kerning:1.0pt;}
 /* Page Definitions */
 @page
	{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;}
@page Section1
	{size:612.0pt 792.0pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:36.0pt;
	mso-footer-margin:36.0pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
--&gt;
&lt;/style&gt;&lt;span style="font-size: 10.5pt; font-family: "Times New Roman";" \
lang="EN-US"&gt;./configure --prefix=/usr &amp;&amp; make&lt;/span&gt;". Here are the \
details of my machine:&lt;br&gt;&lt;br&gt;# cat /etc/redhat-release &lt;br&gt; Scientific Linux SL \
release 5.4 (Boron)&lt;br&gt;&lt;br&gt;# uname -an &lt;br&gt;Linux ib06b07 2.6.18-164.11.1.el5xen #1 \
SMP Wed Jan 20 08:53:10 EST 2010 i686 i686 i386 GNU/Linux&lt;br&gt;&lt;br&gt;&lt;br&gt;Was there \
anything wrong when I built libvirt-0.6.4? Should I enable some compilation options \
for launching qemu-dm process for running domains?&lt;br&gt; Any suggestions will be really \
appreciated, thanks in advance!&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;Regards,&lt;br&gt;Qian &lt;br&gt;



</body></email><email><emailId>20100310162826</emailId><senderName>Paolo Smiraglia</senderName><senderEmail>paolo.smiraglia@gmail.com</senderEmail><timestampReceived>2010-03-10 16:28:26-0400</timestampReceived><subject>[libvirt-users] info about "migration check"</subject><body>

Hi guys! I'm Paolo, and I'm working on my graduation thesis.

One of my thesis' subject is to define a migration check which will be
used to perform "secure migration" using IMA measurement.

Someone can suggest me a documentation (code examples, technical
paper, etc) about migration cheks?

Now I'm analyzing libvirt source code to uderstand migration-cheks
mechanism, but the analysis has a ways to go......

Thanks!

</body></email><email><emailId>20100311143656</emailId><senderName>Avi Weit</senderName><senderEmail>weit@il.ibm.com</senderEmail><timestampReceived>2010-03-11 14:36:56-0400</timestampReceived><subject>Re: [libvirt-users] LXC: unable to configure networking for LXC</subject><body>

Hi Robin,

Thanks for this info,

I tried the first example provided under
http://www.libvirt.org/formatdomain.html#elementsNICS - Virtual Network
which I can see an example that defines the following:

&lt;interface type='network'&gt;
      &lt;source network='default'/&gt;
&lt;/interface&gt;

and that is what I tried to create and start the container with. My
understanding, but I may be wrong is that IP, MAC and tun device will
automatically be created and assigned with values by libvirt. I understand,
that this type of configuration uses the Libvirt's default network which is
configured below and has a range of dhcp IPs.

[root@enc12 avi]# virsh net-dumpxml default
&lt;network&gt;
  &lt;name&gt;default&lt;/name&gt;
  &lt;uuid&gt;9c949214-562a-4c31-a098-235dd368caca&lt;/uuid&gt;
  &lt;forward mode='nat'/&gt;
  &lt;bridge name='virbr0' stp='on' delay='0' /&gt;
  &lt;ip address='192.168.122.1' netmask='255.255.255.0'&gt;
    &lt;dhcp&gt;
      &lt;range start='192.168.122.2' end='192.168.122.254' /&gt;
    &lt;/dhcp&gt;
  &lt;/ip&gt;
&lt;/network&gt;

explicitly defining the container with  IP of 192.168.122.2 - did not work.

Here is the interface portion of the XML I defined the container with

   &lt;interface type='network'&gt;
      &lt;source network='default'/&gt;
      &lt;ip address ='192.168.122.2'/&gt;
   &lt;/interface&gt;


In LXC tools I did not have to configure anything from inside container.
All settings - tun, internal network interface of the container, MAC and IP
were created automatically. I would like to verify if I indeed must to
configure the networking from *inside* the container?

Thanks again,
- Avi

Robin Green &lt;greenrd@greenrd.org&gt; wrote on 09/03/2010 03:52:41 AM:

&gt; From:
&gt;
&gt; Robin Green &lt;greenrd@greenrd.org&gt;
&gt;
&gt; To:
&gt;
&gt; Avi Weit/Haifa/IBM@IBMIL
&gt;
&gt; Cc:
&gt;
&gt; libvirt-users@redhat.com
&gt;
&gt; Date:
&gt;
&gt; 11/03/2010 03:24 PM
&gt;
&gt; Subject:
&gt;
&gt; Re: [libvirt-users]  LXC: unable to configure networking for LXC
&gt;
&gt; At Thu, 11 Mar 2010 14:08:48 +0200,
&gt; Avi Weit wrote:
&gt; &gt; I would like to set up sshd under an LXC application container and to
be
&gt; &gt; able to connect into it from the host. I was able to achieve that with
LXC
&gt; &gt; tools CLI after setting up a bridge via brctl and creating a proper
&gt; &gt; lxc.conf file for lxc-execute to use. However, I am unable to do so via
&gt; &gt; libvirt.
&gt;
&gt; As far as I know, libvirt always assumes that the guest is responsible
&gt; for obtaining an IP address e.g. using DHCP (which makes perfect sense in
&gt; the context of virtualisation technologies which emulate a PC). So at
&gt; this time, I think you need to have a script which runs dhclient before
&gt; running sshd.
&gt;
&gt; Another alternative is just to run a full Linux distribution inside LXC,
&gt; and then the LXC guest's init will be responsible for bringing up the
&gt; network. However, I haven't managed to do this (init just dies
&gt; immediately when I've tried it, on Fedora 12).
&gt;
&gt; Regards,
&gt; --
&gt; Robin Green

</body></email><email><emailId>20100311203531</emailId><senderName>Rubn_Vejabalbn</senderName><senderEmail>jenaro.percal@gmail.com</senderEmail><timestampReceived>2010-03-11 20:35:31-0400</timestampReceived><subject>[libvirt-users] Problems with a logical pool creation</subject><body>

Hi all,
I am new in virtualization so forgive me any evidence.

After pool definition, when I try to create a logical pool I obtain the
following error:

# virsh pool-define vms.pool.xml
&gt; Pool vms.pool defined from vms.pool.xml
&gt;
&gt; # virsh pool-start vms.pool
&gt; error: Failed to start pool vms.pool
&gt; error: internal error '/sbin/vgchange -ay vms.pool' exited with non-zero
&gt; status 5 and signal 0:   Volume group "vms.pool" not found
&gt;

Is anything wrong with my xml file?

&lt;pool type="logical"&gt;
&gt;   &lt;name&gt;vms.pool&lt;/name&gt;
&gt;
  &lt;source&gt;
&gt;     &lt;device path="/dev/sda2"/&gt;
&gt;   &lt;/source&gt;
&gt;   &lt;target&gt;
&gt;     &lt;path&gt;/var/lib/virt/images&lt;/path&gt;
&gt;   &lt;/target&gt;
&gt; &lt;/pool&gt;
&gt;

Are pools created in this way permanent?

Thank you!

Jenaro Percal

[Attachment #3 (text/html)]

Hi all,&lt;br&gt;I am new in virtualization so forgive me any evidence.&lt;br&gt;&lt;br&gt;After pool \
definition, when I try to create a logical pool I obtain the following error: \
&lt;br&gt;&lt;br&gt;&lt;blockquote style="border-left: 1px solid rgb(204, 204, 204); margin: 0pt 0pt \
0pt 0.8ex; padding-left: 1ex;" class="gmail_quote"&gt; &lt;div style="margin-left: 40px;"&gt;# \
virsh pool-define vms.pool.xml&lt;br&gt;Pool vms.pool defined from vms.pool.xml&lt;br&gt;&lt;br&gt;# \
virsh pool-start vms.pool&lt;br&gt;error: Failed to start pool vms.pool&lt;br&gt;error: internal \
error '/sbin/vgchange -ay vms.pool' exited with non-zero status 5 and signal \
0:   Volume group "vms.pool" not found&lt;br&gt; &lt;/div&gt;&lt;/blockquote&gt;&lt;br&gt;Is \
anything wrong with my xml file?&lt;br&gt;&lt;br&gt;&lt;blockquote style="border-left: 1px solid \
rgb(204, 204, 204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;" \
class="gmail_quote"&gt;&lt;div style="margin-left: 40px;"&gt; &lt;pool \
type="logical"&gt;&lt;br&gt;  \
&lt;name&gt;vms.pool&lt;/name&gt;&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote \
style="border-left: 1px solid rgb(204, 204, 204); margin: 0pt 0pt 0pt 0.8ex; \
padding-left: 1ex;" class="gmail_quote"&gt; &lt;div style="margin-left: 40px;"&gt;  \
&lt;source&gt;&lt;br&gt;    &lt;device path="/dev/sda2"/&gt;&lt;br&gt;  \
&lt;/source&gt;&lt;br&gt;  &lt;target&gt;&lt;br&gt;    \
&lt;path&gt;/var/lib/virt/images&lt;/path&gt;&lt;br&gt;  \
&lt;/target&gt;&lt;br&gt;&lt;/pool&gt;&lt;br&gt; &lt;/div&gt;&lt;/blockquote&gt;&lt;br&gt;Are pools created in this \
way permanent?&lt;br&gt;&lt;br&gt;Thank you!&lt;br&gt;&lt;br&gt;Jenaro Percal&lt;br&gt;&lt;br&gt;



</body></email><email><emailId>20100312144328</emailId><senderName>Tom Georgoulias</senderName><senderEmail>tomg@mcclatchyinteractive.com</senderEmail><timestampReceived>2010-03-12 14:43:28-0400</timestampReceived><subject>Re: [libvirt-users] unable to get domain list of KVM guests from libvirt as non-root user</subject><body>

On 03/12/2010 09:18 AM, Daniel Veillard wrote:

&gt;&gt; When I try the same thing on the KVM server:
&gt;&gt;
&gt;&gt; [testu@kvm ~]$ python
&gt;&gt; Python 2.4.3 (#1, Sep  3 2009, 15:37:37)
&gt;&gt; [GCC 4.1.2 20080704 (Red Hat 4.1.2-46)] on linux2
&gt;&gt; Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;    &gt;&gt;&gt;  import libvirt
&gt;&gt;    &gt;&gt;&gt;  conn = libvirt.openReadOnly(None)
&gt;&gt; 14:33:07.303: error : No vport operation path found for host0
&gt;&gt; 14:33:07.320: error : No vport operation path found for host4
&gt;&gt; 14:33:07.325: error : No vport operation path found for host3
&gt;&gt; 14:33:07.367: error : No vport operation path found for host1
&gt;&gt; 14:33:07.368: error : No vport operation path found for host2
&gt;
&gt;    http://libvirt.org/uri.html
&gt;
&gt; try libvirt.openReadOnly("qemu:///system")

That fixed it, thanks!

sh-3.2$ python
Python 2.4.3 (#1, Sep  3 2009, 15:37:37)
[GCC 4.1.2 20080704 (Red Hat 4.1.2-46)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
 &gt;&gt;&gt; import libvirt
 &gt;&gt;&gt; conn = libvirt.openReadOnly("qemu:///system")
 &gt;&gt;&gt; domains = conn.listDomainsID()
 &gt;&gt;&gt; print domains
[14, 8, 13]
 &gt;&gt;&gt;


Looks like I used an example from the wrong page:

http://www.libvirt.org/python.html

Tom

</body></email><email><emailId>20100312202139</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-03-12 20:21:39-0400</timestampReceived><subject>Re: [libvirt-users] ESX support</subject><body>

2010/3/9 Jonathan Kelley &lt;jkelley@vm-labs.com&gt;:
&gt; Just curious but how long has ESX support been in libvirt?

Since version 0.7.0 (August 2009).

&gt; Also I noticed this error when accessing one of my windows vms:
&gt;
&gt; error: internal error Expecting VMX entry 'scsi0.virtualDev' to be
&gt; 'buslogic' or 'lsilogic' but found 'lsisas1068'

I've just posted a patch to add lsisas1068 to the list of known SCSI
controller types.

Thanks for reporting.

Matthias

</body></email><email><emailId>20100313180530</emailId><senderName>Paolo Smiraglia</senderName><senderEmail>paolo.smiraglia@gmail.com</senderEmail><timestampReceived>2010-03-13 18:05:30-0400</timestampReceived><subject>Re: [libvirt-users] Problem with libvirt migration</subject><body>


I had a similar problem using

   Debian Lenny
   libvirt-0.7.6
   qemu-kvm-0.12.3 (build from GIT sources)

and I solved it by replacing

   qemu-kvm-0.12.3

with

   qemu-0.12.3 (build from sources...)

I hope to be helpful....

Daniel Bidwell ha scritto:
&gt; I have two hosts, vm1 and vm2, which are both running libvirt 0.7.0.
&gt; They share a common ocfs2 file system that resides on a san, and have
&gt; identical network configurations.  I am running qemu-kvm 0.11.0 on
&gt; ubuntu 9.10 servers.
&gt; 
&gt; I start base32 on vm1 and it comes up (it also runs fine if started on
&gt; vm2).  Then from vm2 I do:
&gt; 	vm2#: virsh -c qemu://vm1/system
&gt; 	migrate --live base32 qemu://vm2/system
&gt; 
&gt; The migration starts and the vm2 virsh returns to the prompt.  vm2 shows
&gt; base32 as running and vm1 shows base32 as stopped.  The console for
&gt; base32 on vm2 is frozen and unresponsive.
&gt; 
&gt; I have the debug level set to 1 on both machines.
&gt; 
&gt; This is an excerpt from the virsh.log file from vm1:
&gt; 
&gt; 8:19:40.772: debug : qemudDomainMigratePerform:6513 : base32: migrate reply: \
&gt; migrate "tcp:vm2.cc.andrews.edu:49152" 
&gt; 08:19:40.772: debug : qemudShutdownVMDaemon:2076 : Shutting down VM 'base32'
&gt; 
&gt; 08:19:40.773: debug : virEventRemoveHandleImpl:173 : Remove handle 11
&gt; 08:19:40.773: debug : virEventRemoveHandleImpl:186 : mark delete 9 19
&gt; 08:19:40.773: debug : virEventInterruptLocked:640 : Interrupting
&gt; 08:19:40.773: debug : virRun:796 : /usr/bin/virt-aa-helper -R -u \
&gt; libvirt-2469118c-9b90-44e3-a6ce-01a08bfe28f5 08:19:40.773: debug : \
&gt; virEventRunOnce:567 : Poll got 1 event 08:19:40.773: debug : \
&gt; virEventDispatchHandles:450 : Dispatch n=0 f=5 w=1 e=1 (nil) 08:19:40.773: debug : \
&gt; virEventDispatchHandles:440 : Skip deleted n=9 w=11 f=19 08:19:40.773: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=0 w=1, f=5 e=1 08:19:40.773: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=1 w=2, f=8 e=0 08:19:40.773: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=2 w=3, f=8 e=1 08:19:40.773: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=3 w=4, f=9 e=1 08:19:40.773: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=4 w=5, f=3 e=1 08:19:40.774: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=5 w=6, f=11 e=25 08:19:40.774: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=6 w=7, f=12 e=25 08:19:40.774: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=7 w=8, f=14 e=25 08:19:40.774: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=8 w=9, f=15 e=1 08:19:40.774: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=9 w=12, f=16 e=1 08:19:40.774: debug : \
&gt; virEventCalculateTimeout:313 : Calculate expiry of 3 timers 08:19:40.774: debug : \
&gt; virEventCalculateTimeout:343 : Timeout at 0 due in -1 ms 08:19:40.774: debug : \
&gt; virEventRunOnce:565 : Poll on 10 handles 0x2628850 timeout -1 08:19:40.960: debug : \
&gt; virEventUpdateTimeoutImpl:247 : Updating timer 1 timeout with 0 ms freq \
&gt; 08:19:40.960: debug : virEventInterruptLocked:640 : Interrupting 08:19:40.960: \
&gt; debug : virDomainFree:1922 : domain=0x2605c60 08:19:40.960: debug : \
&gt; virUnrefDomain:373 : unref domain 0x2605c60 base32 1 08:19:40.960: debug : \
&gt; virReleaseDomain:327 : release domain 0x2605c60 base32 08:19:40.960: debug : \
&gt; virReleaseDomain:343 : unref connection 0x2679bd0 2 08:19:40.960: debug : \
&gt; virEventUpdateHandleImpl:146 : Update handle w=12 e=3 
&gt; The logs on vm2 (destination host) are:
&gt; 
&gt; 08:19:29.566: debug : virDomainMigratePrepare2:3233 : dconn=0x2096d50, \
&gt; cookie=0x7ff72bf59dc0, cookielen=0x7ff72bf59dcc, uri_in=(null), \
&gt; uri_out=0x20839f0,flags=1, dname=(null), bandwidth=0, dom_xml=&lt;domain type='kvm' \
&gt; id='1'&gt; &lt;name&gt;base32&lt;/name&gt;
&gt; &lt;uuid&gt;2469118c-9b90-44e3-a6ce-01a08bfe28f5&lt;/uuid&gt;
&gt; &lt;memory&gt;262144&lt;/memory&gt;
&gt; &lt;currentMemory&gt;262144&lt;/currentMemory&gt;
&gt; &lt;vcpu&gt;1&lt;/vcpu&gt;
&gt; &lt;os&gt;
&gt; &lt;type arch='i686' machine='pc-0.11'&gt;hvm&lt;/type&gt;
&gt; &lt;boot dev='hd'/&gt;
&gt; &lt;/os&gt;
&gt; &lt;features&gt;
&gt; &lt;acpi/&gt;
&gt; &lt;/features&gt;
&gt; &lt;clock offset='utc'/&gt;
&gt; &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
&gt; &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
&gt; &lt;on_crash&gt;destroy&lt;/on_crash&gt;
&gt; &lt;devices&gt;
&gt; &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;
&gt; &lt;disk type='file' device='disk'&gt;
&gt; &lt;source file='/home/vms/base32/base32.vmdk'/&gt;
&gt; &lt;target dev='hda' bus='ide'/&gt;
&gt; &lt;/disk&gt;
&gt; &lt;interface type='bridge'&gt;
&gt; &lt;mac address='00:0c:29:db:97:14'/&gt;
&gt; &lt;source bridge='br0'/&gt;
&gt; &lt;target dev='vnet0'/&gt;
&gt; &lt;model type='e1000'/&gt;
&gt; &lt;/interface&gt;
&gt; &lt;input type='mouse' bus='ps2'/&gt;
&gt; &lt;graphics type='vnc' port='5900' autoport='yes' listen='127.0.0.1'/&gt;
&gt; &lt;video&gt;
&gt; &lt;model type='cirrus' vram='9216' heads='1'/&gt;
&gt; &lt;/video&gt;
&gt; &lt;/devices&gt;
&gt; &lt;seclabel type='dynamic' model='apparmor'&gt;
&gt; &lt;label&gt;libvirt-2469118c-9b90-44e3-a6ce-01a08bfe28f5&lt;/label&gt;
&gt; &lt;imagelabel&gt;libvirt-2469118c-9b90-44e3-a6ce-01a08bfe28f5&lt;/imagelabel&gt;
&gt; &lt;/seclabel&gt;
&gt; &lt;/domain&gt;
&gt; 
&gt; 08:19:29.569: debug : virGetDomain:296 : New hash entry 0x20941a0
&gt; 08:19:29.569: debug : virDomainGetUUIDString:2441 : domain=0x20941a0, \
&gt; buf=0x7ff72bf584f8 08:19:29.569: debug : virDomainGetUUID:2407 : domain=0x20941a0, \
&gt; uuid=0x7ff72bf58450 08:19:29.569: debug : virExecWithHook:607 : \
&gt; /usr/bin/virt-aa-helper -c -u libvirt-2469118c-9b90-44e3-a6ce-01a08bfe28f5 \
&gt; 08:19:29.857: debug : virExecWithHook:607 : /usr/bin/kvm -help 08:19:29.865: debug \
&gt; : virEventRunOnce:567 : Poll got 1 event 08:19:29.871: debug : \
&gt; virEventDispatchHandles:450 : Dispatch n=4 f=3 w=5 e=1 0x2058040 08:19:29.871: info \
&gt; : qemudDispatchSignalEvent:370 : Received unexpected signal 17 08:19:29.871: debug \
&gt; : virEventMakePollFDs:365 : Prepare n=0 w=1, f=5 e=1 08:19:29.871: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=1 w=2, f=8 e=0 08:19:29.871: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=2 w=3, f=8 e=1 08:19:29.871: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=3 w=4, f=9 e=1 08:19:29.871: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=4 w=5, f=3 e=1 08:19:29.871: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=5 w=6, f=11 e=25 08:19:29.871: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=6 w=7, f=12 e=25 08:19:29.871: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=7 w=8, f=14 e=25 08:19:29.871: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=8 w=9, f=15 e=1 08:19:29.871: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=9 w=11, f=16 e=1 08:19:29.871: debug : \
&gt; virEventCalculateTimeout:313 : Calculate expiry of 3 timers 08:19:29.871: debug : \
&gt; virEventCalculateTimeout:343 : Timeout at 0 due in -1 ms 08:19:29.871: debug : \
&gt; virEventRunOnce:565 : Poll on 10 handles 0x2091480 timeout -1 08:19:29.872: debug : \
&gt; virEventRunOnce:567 : Poll got 2 event 08:19:29.872: debug : \
&gt; virEventDispatchHandles:450 : Dispatch n=2 f=8 w=3 e=1 0x2074e90 08:19:29.872: \
&gt; debug : device_added:513 : net_4a_cf_74_02_5d_6c 08:19:29.872: debug : \
&gt; virExecWithHook:607 : /usr/bin/kvm -S -M pc-0.11 -cpu qemu32 -m 256 -smp 1 -name \
&gt; base32 -uuid 2469118c-9b90-44e3-a6ce-01a08bfe28f5 -monitor \
&gt; unix:/var/run/libvirt/qemu/base32.monitor,server,nowait -boot c -drive \
&gt; file=/home/vms/base32/base32.vmdk,if=ide,index=0,boot=on -net \
&gt; nic,macaddr=00:0c:29:db:97:14,vlan=0,model=e1000,name=e1000.0 -net \
&gt; tap,fd=19,vlan=0,name=tap.0 -serial none -parallel none -usb -vnc 127.0.0.1:0 -vga \
&gt; cirrus -incoming tcp:0.0.0.0:49152 08:19:29.885: debug : \
&gt; virEventDispatchHandles:450 : Dispatch n=4 f=3 w=5 e=1 0x2058040 08:19:29.885: info \
&gt; : qemudDispatchSignalEvent:370 : Received unexpected signal 17 08:19:29.885: debug \
&gt; : virEventMakePollFDs:365 : Prepare n=0 w=1, f=5 e=1 08:19:29.885: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=1 w=2, f=8 e=0 08:19:29.885: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=2 w=3, f=8 e=1 08:19:29.885: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=3 w=4, f=9 e=1 08:19:29.885: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=4 w=5, f=3 e=1 08:19:29.885: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=5 w=6, f=11 e=25 08:19:29.885: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=6 w=7, f=12 e=25 08:19:29.885: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=7 w=8, f=14 e=25 08:19:29.885: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=8 w=9, f=15 e=1 08:19:29.885: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=9 w=11, f=16 e=1 08:19:29.885: debug : \
&gt; virEventCalculateTimeout:313 : Calculate expiry of 3 timers 08:19:29.885: debug : \
&gt; virEventCalculateTimeout:343 : Timeout at 0 due in -1 ms 08:19:29.885: debug : \
&gt; virEventRunOnce:565 : Poll on 10 handles 0x2091480 timeout -1 08:19:29.885: debug : \
&gt; virEventRunOnce:567 : Poll got 1 event 08:19:29.885: debug : \
&gt; virEventDispatchHandles:450 : Dispatch n=4 f=3 w=5 e=1 0x2058040 08:19:29.885: info \
&gt; : qemudDispatchSignalEvent:370 : Received unexpected signal 17 08:19:29.885: debug \
&gt; : virEventMakePollFDs:365 : Prepare n=0 w=1, f=5 e=1 08:19:29.885: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=1 w=2, f=8 e=0 08:19:29.885: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=2 w=3, f=8 e=1 08:19:29.885: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=3 w=4, f=9 e=1 08:19:29.885: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=4 w=5, f=3 e=1 08:19:29.885: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=5 w=6, f=11 e=25 08:19:29.885: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=6 w=7, f=12 e=25 08:19:29.885: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=7 w=8, f=14 e=25 08:19:29.885: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=8 w=9, f=15 e=1 08:19:29.885: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=9 w=11, f=16 e=1 08:19:29.885: debug : \
&gt; virEventCalculateTimeout:313 : Calculate expiry of 3 timers 08:19:29.885: debug : \
&gt; virEventCalculateTimeout:343 : Timeout at 0 due in -1 ms 08:19:29.885: debug : \
&gt; virEventRunOnce:565 : Poll on 10 handles 0x2091480 timeout -1 08:19:30.075: debug : \
&gt; virEventAddHandleImpl:112 : Add handle 19 0 0x425d40 0x2073710 08:19:30.075: debug \
&gt; : virEventAddHandleImpl:116 : Used 10 handle slots, adding 10 more 08:19:30.075: \
&gt; debug : virEventInterruptLocked:640 : Interrupting 08:19:30.075: debug : \
&gt; virEventRunOnce:567 : Poll got 1 event 08:19:30.075: debug : \
&gt; virEventDispatchHandles:450 : Dispatch n=0 f=5 w=1 e=1 (nil) 08:19:30.075: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=0 w=1, f=5 e=1 08:19:30.075: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=1 w=2, f=8 e=0 08:19:30.075: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=2 w=3, f=8 e=1 08:19:30.075: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=3 w=4, f=9 e=1 08:19:30.075: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=4 w=5, f=3 e=1 08:19:30.075: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=5 w=6, f=11 e=25 08:19:30.075: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=6 w=7, f=12 e=25 08:19:30.075: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=7 w=8, f=14 e=25 08:19:30.075: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=8 w=9, f=15 e=1 08:19:30.075: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=9 w=11, f=16 e=1 8:19:30.075: debug : \
&gt; virEventMakePollFDs:365 : Prepare n=10 w=12, f=19 e=0 08:19:30.075: debug : \
&gt; virEventCalculateTimeout:313 : Calculate expiry of 3 timers 08:19:30.075: debug : \
&gt; virEventCalculateTimeout:343 : Timeout at 0 due in -1 ms 08:19:30.075: debug : \
&gt; virEventRunOnce:565 : Poll on 11 handles 0x2091480 timeout -1 08:19:30.076: debug : \
&gt; qemudDomainSetMemoryBalloon:3175 : base32: balloon reply: balloon 256 
&gt; 08:19:30.077: debug : virEventUpdateTimeoutImpl:247 : Updating timer 1 timeout with \
&gt; 0 ms freq 08:19:30.077: debug : virEventInterruptLocked:640 : Interrupting
&gt; 08:19:30.077: debug : virEventRunOnce:567 : Poll got 1 event
&gt; 08:19:30.077: debug : virEventUpdateHandleImpl:146 : Update handle w=11 e=3
&gt; 08:19:30.077: debug : virEventUpdateTimeoutImpl:247 : Updating timer 1 timeout with \
&gt; -1 ms freq 08:19:30.077: debug : virEventInterruptLocked:640 : Interrupting
&gt; 08:19:30.077: debug : virEventInterruptLocked:636 : Skip interrupt, 1 846931856
&gt; 08:19:30.077: debug : virEventDispatchHandles:450 : Dispatch n=0 f=5 w=1 e=1 (nil)
&gt; 08:19:30.077: debug : virEventMakePollFDs:365 : Prepare n=0 w=1, f=5 e=1
&gt; 08:19:30.077: debug : virEventMakePollFDs:365 : Prepare n=1 w=2, f=8 e=0
&gt; 08:19:30.077: debug : virEventMakePollFDs:365 : Prepare n=2 w=3, f=8 e=1
&gt; 08:19:30.077: debug : virEventMakePollFDs:365 : Prepare n=3 w=4, f=9 e=1
&gt; 08:19:30.077: debug : virEventMakePollFDs:365 : Prepare n=4 w=5, f=3 e=1
&gt; 08:19:30.077: debug : virEventMakePollFDs:365 : Prepare n=5 w=6, f=11 e=25
&gt; 08:19:30.077: debug : virEventMakePollFDs:365 : Prepare n=6 w=7, f=12 e=25
&gt; 08:19:30.077: debug : virEventMakePollFDs:365 : Prepare n=7 w=8, f=14 e=25
&gt; 08:19:30.077: debug : virEventMakePollFDs:365 : Prepare n=8 w=9, f=15 e=1
&gt; 08:19:30.077: debug : virEventMakePollFDs:365 : Prepare n=9 w=11, f=16 e=5
&gt; 08:19:30.077: debug : virEventMakePollFDs:365 : Prepare n=10 w=12, f=19 e=0
&gt; 08:19:30.077: debug : virEventCalculateTimeout:313 : Calculate expiry of 3 timers
&gt; 08:19:30.077: debug : virEventCalculateTimeout:343 : Timeout at 0 due in -1 ms
&gt; 08:19:30.077: debug : virEventRunOnce:565 : Poll on 11 handles 0x2091480 timeout -1
&gt; 08:19:30.077: debug : virEventRunOnce:567 : Poll got 2 event
&gt; 08:19:30.077: debug : virEventDispatchHandles:450 : Dispatch n=0 f=5 w=1 e=1 (nil)
&gt; 08:19:30.077: debug : virEventDispatchHandles:450 : Dispatch n=9 f=16 w=11 e=4 \
&gt; 0x2058040 08:19:30.078: debug : virEventUpdateHandleImpl:146 : Update handle w=11 \
&gt; e=1 08:19:30.078: debug : virEventInterruptLocked:636 : Skip interrupt, 1 846931856
&gt; 08:19:30.078: debug : virEventMakePollFDs:365 : Prepare n=0 w=1, f=5 e=1
&gt; 08:19:30.078: debug : virEventMakePollFDs:365 : Prepare n=1 w=2, f=8 e=0
&gt; 08:19:30.078: debug : virEventMakePollFDs:365 : Prepare n=2 w=3, f=8 e=1
&gt; 08:19:30.078: debug : virEventMakePollFDs:365 : Prepare n=3 w=4, f=9 e=1
&gt; 08:19:30.078: debug : virEventMakePollFDs:365 : Prepare n=4 w=5, f=3 e=1
&gt; 08:19:30.078: debug : virEventMakePollFDs:365 : Prepare n=5 w=6, f=11 e=25
&gt; 08:19:30.078: debug : virEventMakePollFDs:365 : Prepare n=6 w=7, f=12 e=25
&gt; 08:19:30.078: debug : virEventMakePollFDs:365 : Prepare n=7 w=8, f=14 e=25
&gt; 08:19:30.078: debug : virEventMakePollFDs:365 : Prepare n=8 w=9, f=15 e=1
&gt; 08:19:30.078: debug : virEventMakePollFDs:365 : Prepare n=9 w=11, f=16 e=1
&gt; 08:19:30.078: debug : virEventMakePollFDs:365 : Prepare n=10 w=12, f=19 e=0
&gt; 08:19:30.078: debug : virEventCalculateTimeout:313 : Calculate expiry of 3 timers
&gt; 08:19:30.078: debug : virEventCalculateTimeout:343 : Timeout at 0 due in -1 ms
&gt; 08:19:30.078: debug : virEventRunOnce:565 : Poll on 11 handles 0x2091480 timeout -1
&gt; 08:19:40.936: debug : virEventRunOnce:567 : Poll got 1 event
&gt; 08:19:40.936: debug : virEventDispatchHandles:450 : Dispatch n=9 f=16 w=11 e=1 \
&gt; 0x2058040 08:19:40.937: debug : virEventUpdateHandleImpl:146 : Update handle w=11 \
&gt; e=1 08:19:40.937: debug : virEventInterruptLocked:636 : Skip interrupt, 1 846931856
&gt; 08:19:40.937: debug : virEventUpdateHandleImpl:146 : Update handle w=11 e=1
&gt; 08:19:40.937: debug : virEventInterruptLocked:636 : Skip interrupt, 1 846931856
&gt; 08:19:40.937: debug : virEventMakePollFDs:365 : Prepare n=0 w=1, f=5 e=1
&gt; 08:19:40.937: debug : virEventMakePollFDs:365 : Prepare n=1 w=2, f=8 e=0
&gt; 08:19:40.937: debug : virEventMakePollFDs:365 : Prepare n=2 w=3, f=8 e=1
&gt; 08:19:40.937: debug : virEventMakePollFDs:365 : Prepare n=3 w=4, f=9 e=1
&gt; 08:19:40.937: debug : virEventMakePollFDs:365 : Prepare n=4 w=5, f=3 e=1
&gt; 08:19:40.937: debug : virEventMakePollFDs:365 : Prepare n=5 w=6, f=11 e=25
&gt; 08:19:40.937: debug : virEventMakePollFDs:365 : Prepare n=6 w=7, f=12 e=25
&gt; 08:19:40.937: debug : virEventMakePollFDs:365 : Prepare n=7 w=8, f=14 e=25
&gt; 08:19:40.937: debug : virEventMakePollFDs:365 : Prepare n=8 w=9, f=15 e=1
&gt; 08:19:40.937: debug : virEventMakePollFDs:365 : Prepare n=9 w=11, f=16 e=1
&gt; 08:19:40.937: debug : virEventMakePollFDs:365 : Prepare n=10 w=12, f=19 e=0
&gt; 08:19:40.937: debug : virEventCalculateTimeout:313 : Calculate expiry of 3 timers
&gt; 08:19:40.937: debug : virEventCalculateTimeout:343 : Timeout at 0 due in -1 ms
&gt; 08:19:40.937: debug : virEventRunOnce:565 : Poll on 11 handles 0x2091480 timeout -1
&gt; 08:19:40.937: debug : virDomainMigrateFinish2:3281 : dconn=0x2096d50, dname=base32, \
&gt; cookie=(nil), cookielen=0, uri=tcp:vm2.cc.andrews.edu:49152, flags=1, retcode=0 \
&gt; 08:19:40.938: debug : virGetDomain:298 : Existing hash entry 0x20941a0: refs now 2 \
&gt; 08:19:40.938: debug : virEventUpdateTimeoutImpl:247 : Updating timer 1 timeout with \
&gt; 0 ms freq 08:19:40.938: debug : virEventInterruptLocked:640 : Interrupting
&gt; 08:19:40.938: debug : virEventUpdateHandleImpl:146 : Update handle w=11 e=3
&gt; 08:19:40.938: debug : virEventInterruptLocked:640 : Interrupting
&gt; 
&gt; The migration appears to have completed successfully, but the console
&gt; doesn't respond to anything and neither does the ethernet.  Any ideas on
&gt; how to get past this last step?
&gt; 
&gt; 
&gt; 

-- 
PAOLO SMIRAGLIA

Mobile:
   +39 333 52 73 593

E-Mail:
   paolo.smiraglia@gmail.com
   paolo.smiraglia@poste.it
   paolo.smiraglia@yahoo.it
   paolo.smiraglia@inventati.org

PGP Public Key
   ID:        5C51FEDB
   KEYSERVER: keyserver.linux.it

Instant Messaging
   MSN:    mastronano@hotmail.com
   Jabber: mastronano@jabber.linux.it
   Skype:  paolo.smiraglia


["signature.asc" (application/pgp-signature)]

</body></email><email><emailId>20100313193629</emailId><senderName>"mattias"</senderName><senderEmail>mj@mjw.se</senderEmail><timestampReceived>2010-03-13 19:36:29-0400</timestampReceived><subject>[libvirt-users] drivers</subject><body>

I no i can use libvirt with qemu and xen
But openvz?	
I run debian lenny with libvirt but no no oepnvz

[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN"&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=us-ascii"&gt;
&lt;META NAME="Generator" CONTENT="MS Exchange Server version 6.0.4630.0"&gt;
&lt;TITLE&gt;drivers&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;!-- Converted from text/rtf format --&gt;

&lt;P&gt;&lt;FONT SIZE=2 FACE="Courier New"&gt;I no i can use libvirt with qemu and xen&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=2 FACE="Courier New"&gt;But openvz? &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=2 FACE="Courier New"&gt;I run debian lenny with libvirt but no no oepnvz&lt;B&gt;&lt;/B&gt;&lt;/FONT&gt;&lt;B&gt;&lt;/B&gt;
&lt;/P&gt;

&lt;/BODY&gt;
&lt;/HTML&gt;

</body></email><email><emailId>20100314113849</emailId><senderName>Dan Kenigsberg</senderName><senderEmail>danken@redhat.com</senderEmail><timestampReceived>2010-03-14 11:38:49-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt]  Regarding SPICE</subject><body>

On Thu, Mar 04, 2010 at 04:21:39PM +0530, anuj rampal wrote:
&gt; Hi,
&gt; 
&gt; Thanks a lot for the reply.
&gt; 
&gt; Is it going to be there in the future?
&gt; 

When spice is ready upstream, I have no doubt that libvirt will support
it.

&gt; And i wanted to confirm one more thing...
&gt; KVM on RHEL 5.4 supports SPICE through libvirt?
&gt; Because there were some patches regarding " Implement RHEL-5.4 support for
&gt; SPICE graphics"

Unfortunately these patches never made it to RHEL-5. Maybe some time in
the future.

</body></email><email><emailId>20100324213752</emailId><senderName></senderName><senderEmail>steven765@yahoo.com</senderEmail><timestampReceived>2010-03-24 21:37:52-0400</timestampReceived><subject>[libvirt-users] Problem attaching device</subject><body>

I keep getting an error when I try to attach a device in the libvirt api through python  

The python code is:

     conn=libvirt.open('qemu:///system')
     dom = conn.lookupByName("fedoratest")
     if dom.info()[0]==1:
         dom.attachDevice('net.xml')

And I keep getting: "libvirtError: XML description not well formed or invalid

   The xml is a simple network card that works fine in virsh. It is just:
#cat net.xml
&lt;interface type='network'&gt;
           &lt;mac address='52:54:00:00:fe:5c'/&gt;
           &lt;source network-'default'/&gt;
            target dev='vnet1'/&gt;
&lt;/interface&gt;

I've tired giving it the full path still no luck.
Thanks in advance,



      

</body></email><email><emailId>20100324221810</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-03-24 22:18:10-0400</timestampReceived><subject>Re: [libvirt-users] Problem attaching device</subject><body>

2010/3/24  &lt;steven765@yahoo.com&gt;:
&gt; I keep getting an error when I try to attach a device in the libvirt api through python
&gt;
&gt; The python code is:
&gt;
&gt;     conn=libvirt.open('qemu:///system')
&gt;     dom = conn.lookupByName("fedoratest")
&gt;     if dom.info()[0]==1:
&gt;         dom.attachDevice('net.xml')
&gt;
&gt; And I keep getting: "libvirtError: XML description not well formed or invalid
&gt;
&gt;   The xml is a simple network card that works fine in virsh. It is just:
&gt; #cat net.xml
&gt; &lt;interface type='network'&gt;
&gt;           &lt;mac address='52:54:00:00:fe:5c'/&gt;
&gt;           &lt;source network-'default'/&gt;

Your XML is really not well formed. This

   &lt;source network-'default'/&gt;

should be

   &lt;source network='default'/&gt;

&gt;            target dev='vnet1'/&gt;

And you miss a &lt; before the word target:

   target dev='vnet1'/&gt;

should be

   &lt;target dev='vnet1'/&gt;

&gt; &lt;/interface&gt;
&gt;
&gt; I've tired giving it the full path still no luck.
&gt; Thanks in advance,
&gt;

Matthias

</body></email><email><emailId>20100325131814</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2010-03-25 13:18:14-0400</timestampReceived><subject>Re: [libvirt-users] Problem attaching device</subject><body>

On Wed, Mar 24, 2010 at 11:18:10PM +0100, Matthias Bolte wrote:
&gt; 2010/3/24  &lt;steven765@yahoo.com&gt;:
&gt; Your XML is really not well formed. This
&gt; 
&gt;    &lt;source network-'default'/&gt;
&gt; 
&gt; should be
&gt; 
&gt;    &lt;source network='default'/&gt;
&gt; 
&gt; &gt;            target dev='vnet1'/&gt;
&gt; 
&gt; And you miss a &lt; before the word target:
&gt; 
&gt;    target dev='vnet1'/&gt;
&gt; 
&gt; should be
&gt; 
&gt;    &lt;target dev='vnet1'/&gt;
&gt; 
&gt; &gt; &lt;/interface&gt;
&gt; &gt;
&gt; &gt; I've tired giving it the full path still no luck.
&gt; &gt; Thanks in advance,

  use xmllint to check XML instances if you're not sure

xmllint net.xml

Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

</body></email><email><emailId>20100325194121</emailId><senderName></senderName><senderEmail>steven765@yahoo.com</senderEmail><timestampReceived>2010-03-25 19:41:21-0400</timestampReceived><subject>Re: [libvirt-users] Problem attaching device</subject><body>

Thanks, but problem still persists. I actually fat fingered entering it the first \
time   

The xmlfile really is: 

&lt;?xml version="1.0"?&gt;
&lt;interface type="network"&gt;
  &lt;mac address="52:54:00:5c:fe:a8"/&gt;
  &lt;source network="default"/&gt;
  &lt;target dev="vnet1"/&gt;
&lt;/interface&gt;

 I ran xmllint and it just says no DTD specified, however this works perfectly if i \
use the attach-device command in virsh. I tired it both with and without the first \
line version=1.0

I try running it through python and boom, is there something else I'm missing?  I \
can't find any documentation about the overall libvirt xml schema.  Thanks again,
Steve


--- On Thu, 3/25/10, Daniel Veillard &lt;veillard@redhat.com&gt; wrote:

&gt; From: Daniel Veillard &lt;veillard@redhat.com&gt;
&gt; Subject: Re: [libvirt-users] Problem attaching device
&gt; To: steven765@yahoo.com
&gt; Cc: "Matthias Bolte" &lt;matthias.bolte@googlemail.com&gt;, libvirt-users@redhat.com
&gt; Date: Thursday, March 25, 2010, 9:18 AM
&gt; On Wed, Mar 24, 2010 at 11:18:10PM
&gt; +0100, Matthias Bolte wrote:
&gt; &gt; 2010/3/24  &lt;steven765@yahoo.com&gt;:
&gt; &gt; Your XML is really not well formed. This
&gt; &gt; 
&gt; &gt; &lt;source network-'default'/&gt;
&gt; &gt; 
&gt; &gt; should be
&gt; &gt; 
&gt; &gt; &lt;source network='default'/&gt;
&gt; &gt; 
&gt; &gt; &gt; target dev='vnet1'/&gt;
&gt; &gt; 
&gt; &gt; And you miss a &lt; before the word target:
&gt; &gt; 
&gt; &gt; target dev='vnet1'/&gt;
&gt; &gt; 
&gt; &gt; should be
&gt; &gt; 
&gt; &gt; &lt;target dev='vnet1'/&gt;
&gt; &gt; 
&gt; &gt; &gt; &lt;/interface&gt;
&gt; &gt; &gt; 
&gt; &gt; &gt; I've tired giving it the full path still no
&gt; luck.
&gt; &gt; &gt; Thanks in advance,
&gt; 
&gt; use xmllint to check XML instances if you're not
&gt; sure
&gt; 
&gt; xmllint net.xml
&gt; 
&gt; Daniel
&gt; 
&gt; -- 
&gt; Daniel Veillard      | libxml Gnome XML XSLT
&gt; toolkit  http://xmlsoft.org/
&gt; daniel@veillard.com 
&gt; &gt; Rpmfind RPM search engine http://rpmfind.net/
&gt; http://veillard.com/ | virtualization library  http://libvirt.org/
&gt; 



      


</body></email><email><emailId>20100314114136</emailId><senderName>angelo alfano</senderName><senderEmail>angeloalfa76@yahoo.it</senderEmail><timestampReceived>2010-03-14 11:41:36-0400</timestampReceived><subject>[libvirt-users] Memory domain</subject><body>

1. Can  I set the memory of a domain when it is running?
2. If the host has a total memory of 2GB and launch two VM which respectively 2GB of \
memory setting, because I don't  have a mistake o warning?

Grazie Angelo


      


[Attachment #3 (text/html)]

&lt;html&gt;&lt;head&gt;&lt;style type="text/css"&gt;&lt;!-- DIV {margin:0px;} \
--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div style="font-family:times new roman,new \
york,times,serif;font-size:24pt"&gt;&lt;font size="3"&gt;1. &lt;/font&gt;&lt;font size="3"&gt;&lt;span \
id="result_box" class="short_text"&gt;&lt;span style="background-color: rgb(255, 255, \
255);" title="io posso settare la memoria di un dominio quando questo  in \
esecuzione?"&gt;Can I set the memory of a domain when it is running?&lt;br&gt;2. \
&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;font size="3"&gt;&lt;span id="result_box" class="medium_text"&gt;&lt;span \
style="background-color: rgb(235, 239, 249);" title="Se nell'host ha una memoria \
totale di 2Gb e avvio due VM che hanno rispettivamente 2GB di memoria settata, perch \
non ho un errore?"&gt;If the host has a total memory of 2GB and launch two VM \
&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;font size="3"&gt;&lt;span id="result_box" class="medium_text"&gt;&lt;span \
style="background-color: rgb(235, 239, 249);" title="Se nell'host ha una memoria \
totale di 2Gb e avvio due VM che  hanno rispettivamente 2GB di memoria settata, \
perch non ho un errore?"&gt;which respectively &lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;font \
size="3"&gt;&lt;span id="result_box" class="medium_text"&gt;&lt;span style="background-color: \
rgb(235, 239, 249);" title="Se nell'host ha una memoria totale di 2Gb e avvio due VM \
che hanno rispettivamente 2GB di memoria settata, perch non ho un errore?"&gt;2GB of \
memory setting, because I don't have a mistake o warning?&lt;br&gt;&lt;br&gt;Grazie \
Angelo&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;/font&gt; &lt;/div&gt;&lt;br&gt;



      &lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20100315191645</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-03-15 19:16:45-0400</timestampReceived><subject>Re: [libvirt-users] Duplicate USB vendor,product specification</subject><body>

On Mon, Mar 15, 2010 at 01:25:47PM -0500, Don Morrison wrote:
&gt; 
&gt; I studying how to attach USB devices to a KVM guest virtual machine using
&gt; libvirt. Using the "vendor" and "product" to specify the source device
&gt; seems like a good option since the "bus" and "device" values can change as
&gt; a device is removed and re-inserted. The question I have is what should I
&gt; expect to happen if I plug in two identical USB devices - so they have the
&gt; same vendor/product information? There is nothing in the documentation on
&gt; libvirt.org to address this case. Thanks.

I can tell you that the behaviour will not be what you want :-)

The current logic just iterates over devices in sysfs until it finds one
with a matching vendor+product ID.

So it is pot-luck which device you'll hit. And if you try to configure
two guests with same vendor+product ID, they'll likely both get the same 
device even if you plug in two different ones with same vendor+product.

We need todo somewhat better in this regard. For PCI devices we track
what devices are assigned to guests so we can guarentee uniqueness of
assignment. We need todo the same with USB devices. At which point it
becomes easy to ensure that if you have 2 identical devices both will
be given to separate guests.

Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100316114510</emailId><senderName>Jorge Somavilla</senderName><senderEmail>somavilla@dit.upm.es</senderEmail><timestampReceived>2010-03-16 11:45:10-0400</timestampReceived><subject>Re: [libvirt-users] behaviour of "virsh shutdown domainName"</subject><body>

Thank you for your prompt reply, it was very helpful.

Jorge



On Mon, Mar 15, 2010 at 17:48, Daniel P. Berrange &lt;berrange@redhat.com&gt; wrote:
&gt; On Sat, Mar 13, 2010 at 06:08:05PM +0100, Jorge Somavilla wrote:
&gt;&gt; Hi all,
&gt;&gt;
&gt;&gt; I am experiencing some problems with different versions of libvirt
&gt;&gt; (0.7.5 and 0.7.7), with a kvm (WinXP), host running Ubuntu 9.10, and i
&gt;&gt; would like to ask you two questions:
&gt;&gt;
&gt;&gt; - In virsh, after running the command "shutdown domainName", what
&gt;&gt; should be the final state of the domain, if the shutdown finishes
&gt;&gt; correctly: "shutoff", "no-state", "inactive", or the domain shouldn't
&gt;&gt; show in "list --all" (full clean-up)?
&gt;
&gt; There are two types of guest in libvirt
&gt;
&gt;  - persistent - they have a config file stored on disk
&gt;  - transient - no config file &amp; only exist while running
&gt;
&gt;
&gt; If you run 'shutdown' on a  persistent guest, the final state should
&gt; be 'shutoff'. For a transient guest, it will go away completely not
&gt; ever visible again.
&gt;
&gt; NB, 'shutdown' is merely a *request* to shutdown. There is no
&gt; guarentee that the guest OS will honour this request. If it does
&gt; not, then you will have to kill the guest forcefully (virsh destroy)
&gt; which removes the virtual power plug.
&gt;
&gt;
&gt;&gt; - After the command "shutdown domainName", should i be able to run the
&gt;&gt; command "start domainName", without first defining the domain? (i.e.:
&gt;&gt; does shutdown "undefine" the domain?).
&gt;
&gt; No, shutdown is merely a request to shutdown. It won't touch the
&gt; configs on disk. You will also have to watch to see if it actually
&gt; shuts down before you can run start again.
&gt;
&gt;&gt; In my experience 0.7.5 used to leave the shut down domains as defined,
&gt;&gt; so i could run "start" right after. Testing in other hosts this
&gt;&gt; doesn't work always like that, and even if the domain apparently shuts
&gt;&gt; down correctly, the domain sometimes shows in "list --all", and
&gt;&gt; sometimes it doesn't. With libvirt 0.7.7 the domain never shows in
&gt;&gt; "list --all" after a successful shutdown, which makes me think it was
&gt;&gt; a bug and it has been corrected. Am i missing anything?
&gt;
&gt; To best of my knowledge, there is no change in semantics between these
&gt; two versions.
&gt;
&gt; Daniel
&gt; --
&gt; |: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
&gt; |: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
&gt; |: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
&gt; |: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|
&gt;

</body></email><email><emailId>20100316184533</emailId><senderName>jeremy avnet</senderName><senderEmail>brainsik+libvirt@saucelabs.com</senderEmail><timestampReceived>2010-03-16 18:45:33-0400</timestampReceived><subject>[libvirt-users] internal error cannot parse QEMU version number</subject><body>

I've seen this error a couple of times over the past month, but it's
starting to happen more regularly now (perhaps since VM usage is
increasing). The last few times I've seen it when trying to start a VM
(virsh start domain):

$ virsh start goat
Connecting to uri: qemu:///system
error: Failed to start domain goat
error: internal error cannot parse QEMU version number in ' PC emulator
version 0.11.0 (qemu-kvm-0.11.0), Copyright (c) 2003-2008 Fabrice Bellard'

Running libvirt version 0.7.0-1ubuntu13.1 under Ubuntu 9.10 amd64.

$ kvm --version
QEMU PC emulator version 0.11.0 (qemu-kvm-0.11.0), Copyright (c) 2003-2008
Fabrice Bellard

I saw this message, but it's for an older version:
http://osdir.com/ml/libvir-list/2009-05/msg00192.html

Any ideas on how to prevent this error?

Thank you.
.:. jeremy

[Attachment #3 (text/html)]

&lt;font face="verdana,sans-serif"&gt;&lt;div&gt;I've seen this error a couple of times over \
the past month, but it's starting to happen more regularly now (perhaps since VM \
usage is increasing). The last few times I've seen it when trying to start a VM \
(virsh start domain):&lt;/div&gt; &lt;/font&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="verdana, \
sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="verdana, \
sans-serif"&gt;&lt;div&gt;$ virsh start goat&lt;/div&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
class="Apple-style-span" face="verdana, sans-serif"&gt;&lt;div&gt; Connecting to uri: \
qemu:///system&lt;/div&gt;&lt;div&gt;error: Failed to start domain goat&lt;/div&gt;&lt;div&gt;error: internal \
error cannot parse QEMU version number in ' PC emulator version 0.11.0 \
(qemu-kvm-0.11.0), Copyright (c) 2003-2008 Fabrice Bellard'&lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Running libvirt version 0.7.0-1ubuntu13.1 under Ubuntu 9.10 \
amd64.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;$ kvm --version&lt;/div&gt;&lt;div&gt;QEMU PC emulator \
version 0.11.0 (qemu-kvm-0.11.0), Copyright (c) 2003-2008 Fabrice Bellard&lt;/div&gt; \
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I saw this message, but it's for an older \
version:&lt;/div&gt;&lt;div&gt;&lt;a \
href="http://osdir.com/ml/libvir-list/2009-05/msg00192.html"&gt;http://osdir.com/ml/libvir-list/2009-05/msg00192.html&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;
 &lt;/div&gt;&lt;div&gt;Any ideas on how to prevent this \
error?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Thank you.&lt;/div&gt;&lt;div&gt;.:. \
jeremy&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/font&gt;&lt;/div&gt;



</body></email><email><emailId>20100316203946</emailId><senderName>Daniel Bidwell</senderName><senderEmail>bidwell@andrews.edu</senderEmail><timestampReceived>2010-03-16 20:39:46-0400</timestampReceived><subject>[libvirt-users] migrate with libirt 0.7.0</subject><body>

Using ubuntu 9.10 and libvir 0.7.0, when I do a migrate a domain from
machine A to B, the migration "completes" but remains in a frozen state
until I do a "suspend/resume" on it on B.  Then it runs fully normally.
What do I do to skip the suspend/resume steps?

-- 
Daniel R. Bidwell       |       bidwell@andrews.edu
Andrews University      |       Information Technology Services
If two always agree, one of them is unnecessary
"Friends don't let friends do DOS"
"In theory, theory and practice are the same.
In practice, however, they are not."


</body></email><email><emailId>20100317201554</emailId><senderName>Don Morrison</senderName><senderEmail>dam@us.ibm.com</senderEmail><timestampReceived>2010-03-17 20:15:54-0400</timestampReceived><subject>[libvirt-users] virsh shutdown does not stop XP-Pro guest</subject><body>


I've been trying to get "virsh shutdown" to work against an XP-Pro guest
with no luck so far. It seems to have no effect - I have to run "virsh
destroy" instead which is less than desirable. I have enabled &lt;acpi&gt; in the
domain xml so I think the problem is on the guest side. A couple of
questions:

1) How can I confirm whether the XP guest has ACPI enabled. I actually
think it doesn't because when I  look at the "ACPI Multiprocessor PC"
device driver name, it lists "hal.dll". This is NOT ACPI enabled according
to this site: http://technet.microsoft.com/en-us/library/bb457123.aspx.  Am
I reading this correctly?
2) I tried to enable ACPI at install time by bringing up virt-viewer and
pressing F5 on the blue install screen as instructed here:
http://www.computing.net/answers/windows-xp/enable-acpi-in-xp-without-reinstall-/36056.html
  But F5 didn't have any effect. Has anybody else been able to get this to
work?

I'm running KVM 0.12.2-0.4.1 and  Libvirt 0.7.6-1.2.3

Thanks.

Don Morrison

</body></email><email><emailId>20100329055648</emailId><senderName>Chaitra Gorantla</senderName><senderEmail>chaitra.gorantla@lntinfotech.com</senderEmail><timestampReceived>2010-03-29 05:56:48-0400</timestampReceived><subject>[libvirt-users] Vserver patch for Libvirt</subject><body>

Hi all,
I am using libvirt for managing KVM. I would also like to manage Vserver a=
lso using libvirt.
Is there any patch available for vserver ? When will libvirt relase offici=
al patch for vserver?

Thanks,
Chaitra

________________________________
This Email may contain confidential or privileged information for the inte=
nded recipient (s) If you are not the intended recipient, please do not us=
e or disseminate the information, notify the sender and delete it from you=
r system.

______________________________________________________________________
[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:wf="http://schemas.microsoft.com/sharepoint/soap/workflow/" \
xmlns:dsss="http://schemas.microsoft.com/office/2006/digsig-setup" \
xmlns:dssi="http://schemas.microsoft.com/office/2006/digsig" \
xmlns:mdssi="http://schemas.openxmlformats.org/package/2006/digital-signature" \
xmlns:mver="http://schemas.openxmlformats.org/markup-compatibility/2006" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns:mrels="http://schemas.openxmlformats.org/package/2006/relationships" \
xmlns:spwp="http://microsoft.com/sharepoint/webpartpages" \
xmlns:ex12t="http://schemas.microsoft.com/exchange/services/2006/types" \
xmlns:ex12m="http://schemas.microsoft.com/exchange/services/2006/messages" \
xmlns:pptsl="http://schemas.microsoft.com/sharepoint/soap/SlideLibrary/" \
xmlns:spsl="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService" \
xmlns:Z="urn:schemas-microsoft-com:" xmlns="http://www.w3.org/TR/REC-html40"&gt; &lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=us-ascii"&gt;
&lt;meta name="Generator" content="Microsoft Word 12 (filtered medium)"&gt;
&lt;style&gt;
&lt;!--
 /* Font Definitions */
 @font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.Section1
	{page:Section1;}
--&gt;
&lt;/style&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapelayout v:ext="edit"&gt;
  &lt;o:idmap v:ext="edit" data="1" /&gt;
 &lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
&lt;/head&gt;
&lt;body lang="EN-US" link="blue" vlink="purple"&gt;
&lt;div class="Section1"&gt;
&lt;p class="MsoNormal"&gt;&lt;span style="font-size:10.0pt"&gt;Hi all,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal"&gt;&lt;span style="font-size:10.0pt"&gt;I am using libvirt for managing \
KVM. I would also like to manage Vserver also using libvirt.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p \
class="MsoNormal"&gt;&lt;span style="font-size:10.0pt"&gt;Is there any patch available for \
vserver ? When will libvirt relase official patch for vserver?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; \
&lt;p class="MsoNormal"&gt;&lt;span style="font-size:10.0pt"&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p \
class="MsoNormal"&gt;&lt;span style="font-size:10.0pt"&gt;Thanks,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;p \
class="MsoNormal"&gt;&lt;span style="font-size:10.0pt"&gt;Chaitra&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt; &lt;/div&gt;
&lt;br&gt;
&lt;hr&gt;
&lt;font face="Arial" color="Black" size="3"&gt;This Email may contain confidential or \
privileged information for the intended recipient (s) If you are not the intended \
recipient, please do not use or disseminate the information, notify the sender and \
delete it from  your system.&lt;br&gt;
&lt;/font&gt;
&lt;BR&gt;
______________________________________________________________________&lt;BR&gt;
&lt;/body&gt;
&lt;/html&gt;



</body></email><email><emailId>20100331075145</emailId><senderName></senderName><senderEmail>brandlk</senderEmail><timestampReceived>2010-03-31 07:51:45-0400</timestampReceived><subject>[libvirt-users] libvirt connections</subject><body>

Hello,

I'm working with libvirt version 0.7.7 and encountered some problems with
ssh connections to the xen hypervisor:

- if the hypervisor is not running libvirt.open("xen+ssh://host") doesn't
time out put keeps trying to connect to host on port 8000.
I've tried with the following test program:

try:
   conn = libvirt.open("xen+ssh://host")
except:
   print "failed"
   sys.exit(1)

However: after aborting the program with Ctrl-C I get the exception.

- I want to close all libvirt connections at the end, but closing the
connections does not close the ssh - nc connections libvirt opens in the
background to talk to the hypervisor. I have to manually delete all domain
objects as well to get the pending ssh - nc connections closed. I can keep
on using the domain object, even if I closed the connection before.
Is this behaviour intended?

Any help would be great.

K. Haselhorst

</body></email><email><emailId>20100331173058</emailId><senderName>jeremy avnet</senderName><senderEmail>brainsik@saucelabs.com</senderEmail><timestampReceived>2010-03-31 17:30:58-0400</timestampReceived><subject>[libvirt-users] connection creating</subject><body>

Are there any recommendations as to how often a new connection should be
made versus reused? Right now we create a new connection *every time* we hit
libvirt for something. We can easily change this so that a single connection
is made for a series of libvirt calls, or even so that a single connection
is used for the lifetime of the running application.

What are the issues to consider when making these choices?

We are connecting to qemu:///system.

Thank you.
.:. brainsik

[Attachment #3 (text/html)]

&lt;font class="Apple-style-span" face="verdana, sans-serif"&gt;Are there any \
recommendations as to how often a new connection should be made versus reused? Right \
now we create a new connection &lt;i&gt;every time&lt;/i&gt; we hit libvirt for something. We can \
easily change this so that a single connection is made for a series of libvirt calls, \
or even so that a single connection is used for the lifetime of the running \
application.&lt;/font&gt;&lt;div&gt; &lt;font class="Apple-style-span" face="verdana, \
sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="verdana, \
sans-serif"&gt;What are the issues to consider when making these \
choices?&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="verdana, \
sans-serif"&gt;&lt;br&gt; &lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="verdana, \
sans-serif"&gt;We are connecting to qemu:///system.&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
class="Apple-style-span" face="verdana, sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
class="Apple-style-span" face="verdana, sans-serif"&gt;Thank you.&lt;/font&gt;&lt;/div&gt; \
&lt;div&gt;&lt;font class="Apple-style-span" face="verdana, sans-serif"&gt;.:. \
brainsik&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="verdana, \
sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="verdana, \
sans-serif"&gt;&lt;br&gt; &lt;/font&gt;&lt;/div&gt;



</body></email><email><emailId>20100331173213</emailId><senderName>jeremy avnet</senderName><senderEmail>brainsik+libvirt@saucelabs.com</senderEmail><timestampReceived>2010-03-31 17:32:13-0400</timestampReceived><subject>[libvirt-users] advice on creating and reusing connections</subject><body>

Are there any recommendations as to how often a new connection should be
made versus reused? Right now we create a new connection *every time* we hit
libvirt for something. We can easily change this so that a single connection
is made for a series of libvirt calls, or even so that a single connection
is used for the lifetime of the running application.

What are the issues to consider when making these choices?

We are connecting to qemu:///system.

Thank you.
.:. brainsik

[Attachment #3 (text/html)]

&lt;font face="verdana,sans-serif"&gt;&lt;span class="Apple-style-span" style="font-family: \
arial, sans-serif; font-size: 13px; border-collapse: collapse; "&gt;&lt;font face="verdana, \
sans-serif"&gt;Are there any recommendations as to how often a new connection should be \
made versus reused? Right now we create a new connection &lt;i&gt;every time&lt;/i&gt; we hit \
libvirt for something. We can easily change this so that a single connection is made \
for a series of libvirt calls, or even so that a single connection is used for the \
lifetime of the running application.&lt;/font&gt;&lt;div&gt; &lt;font face="verdana, \
sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face="verdana, sans-serif"&gt;What are the \
issues to consider when making these choices?&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face="verdana, \
sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face="verdana, sans-serif"&gt;We are connecting \
to qemu:///system.&lt;/font&gt;&lt;/div&gt; &lt;div&gt;&lt;font face="verdana, \
sans-serif"&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face="verdana, sans-serif"&gt;Thank \
you.&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face="verdana, sans-serif"&gt;.:. \
brainsik&lt;/font&gt;&lt;/div&gt;&lt;/span&gt;&lt;/font&gt;



</body></email><email><emailId>20100331090022</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-03-31 09:00:22-0400</timestampReceived><subject>Re: [libvirt-users] libvirt connections</subject><body>

2010/3/31  &lt;brandlk@mathematik.uni-marburg.de&gt;:
&gt; Hello,
&gt;
&gt; I'm working with libvirt version 0.7.7 and encountered some problems with
&gt; ssh connections to the xen hypervisor:
&gt;
&gt; - if the hypervisor is not running libvirt.open("xen+ssh://host") doesn't
&gt; time out put keeps trying to connect to host on port 8000.
&gt; I've tried with the following test program:
&gt;
&gt; try:
&gt;   conn = libvirt.open("xen+ssh://host")
&gt; except:
&gt;   print "failed"
&gt;   sys.exit(1)
&gt;
&gt; However: after aborting the program with Ctrl-C I get the exception.
&gt;
&gt; - I want to close all libvirt connections at the end, but closing the
&gt; connections does not close the ssh - nc connections libvirt opens in the
&gt; background to talk to the hypervisor. I have to manually delete all domain
&gt; objects as well to get the pending ssh - nc connections closed. I can keep
&gt; on using the domain object, even if I closed the connection before.
&gt; Is this behaviour intended?

This behavior is intended. Connection and domain objects are
refcounted. If you open a connection conn it starts with a refcount of
1. When you request a domain object using conn, then the refcount of
that connection is increased by 1. Upon destruction of the domain
object the refcount of conn is decreased again by 1.

Now if you call close on conn or get rid of the python reference by
assigning None to conn, then the connection is not closed immediately,
only the refcount is decreased by 1. The connection gets closed when
its refcount reaches zero. This happens if you close the connection
_and_ free all domain, network, interface objects etc. that you
requested using that connection.

Matthias

</body></email><email><emailId>20100329125021</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2010-03-29 12:50:21-0400</timestampReceived><subject>Re: [libvirt-users] Vserver patch for Libvirt</subject><body>

On Mon, Mar 29, 2010 at 11:14:48AM +0530, Chaitra Gorantla wrote:
&gt; Hi all,
&gt; I am using libvirt for managing KVM. I would also like to manage Vserver also using libvirt.
&gt; Is there any patch available for vserver ?

  no

&gt; When will libvirt relase official patch for vserver?

  When someone will provide such a patch if this ever happen.

Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

</body></email><email><emailId>20100319143027</emailId><senderName>Nicolas Greneche</senderName><senderEmail>nicolas.greneche@univ-orleans.fr</senderEmail><timestampReceived>2010-03-19 14:30:27-0400</timestampReceived><subject>Re: [libvirt-users] Pool, iSCSI and guest start</subject><body>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Dave Allan wrote:
&gt; On 03/19/2010 04:44 AM, Nicolas Greneche wrote:
&gt; &gt; -----BEGIN PGP SIGNED MESSAGE-----
&gt; &gt; Hash: SHA1
&gt; &gt; 
&gt; &gt; Dave Allan wrote:
&gt; &gt; &gt; On 03/17/2010 06:38 AM, Nicolas Greneche wrote:
&gt; &gt; &gt; &gt; -----BEGIN PGP SIGNED MESSAGE-----
&gt; &gt; &gt; &gt; Hash: SHA1
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Hi,
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Former user of Xen and newbie in kvm/qemu/libvirt stuff, I give it a
&gt; &gt; &gt; &gt; try
&gt; &gt; &gt; &gt; on my network ;-)
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; I need to run a VM with iSCSI target attached.
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; I did it this way :
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 1) Creation of iscsi pool (equa.xml) :
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &lt;pool type="iscsi"&gt;
&gt; &gt; &gt; &gt; &lt;name&gt;equalog&lt;/name&gt;
&gt; &gt; &gt; &gt; &lt;source&gt;
&gt; &gt; &gt; &gt; &lt;host name="10.10.0.1"/&gt;
&gt; &gt; &gt; &gt; &lt;device
&gt; &gt; &gt; &gt; path="iqn.2001-05.com.equallogic:0-8a0906-4992c7f05-39c000000114b8fc-vglog"/&gt;
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &lt;/source&gt;
&gt; &gt; &gt; &gt; &lt;target&gt;
&gt; &gt; &gt; &gt; &lt;path&gt;/dev/disk/by-path&lt;/path&gt;
&gt; &gt; &gt; &gt; &lt;/target&gt;
&gt; &gt; &gt; &gt; &lt;/pool&gt;
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; This pool start smoothly (when open-iscsi started), no problems. An
&gt; &gt; &gt; &gt; entry is created in /dev/disk/by-path/ related to iscsi target.
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 2) I flagged it autostart :
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; root@sandi:~# virsh pool-autostart equalog
&gt; &gt; &gt; &gt; Pool equalog marked as autostarted
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; root@sandi:~# virsh pool-list
&gt; &gt; &gt; &gt; Name                 State      Autostart
&gt; &gt; &gt; &gt; - -----------------------------------------
&gt; &gt; &gt; &gt; equalog              active     yes
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 3) In my guest VM, I have following section :
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &lt;disk type='block' device='disk'&gt;
&gt; &gt; &gt; &gt; &lt;driver name='qemu'/&gt;
&gt; &gt; &gt; &gt; &lt;source
&gt; &gt; &gt; &gt; dev='/dev/disk/by-path/ip-10.10.0.1:3260-iscsi-iqn.2001-05.com.equallogic:0-8a0906-4992c7f05-39c000000114b8fc-vglog-lun-0'/&gt;
&gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &lt;target dev='vdc' bus='virtio'/&gt;
&gt; &gt; &gt; &gt; &lt;alias name='virtio2'/&gt;
&gt; &gt; &gt; &gt; &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x06'
&gt; &gt; &gt; &gt; function='0x0'/&gt;
&gt; &gt; &gt; &gt; &lt;/disk&gt;
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; When I start VM, iscsi target is availaible.
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; The snag is that when I reboot the host, the pool is not automatically
&gt; &gt; &gt; &gt; started (making it impossible to autostart VM relying on this iscsi
&gt; &gt; &gt; &gt; volume).
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; I verified that open-iscsi is started first. Startup script is
&gt; &gt; &gt; &gt; localised
&gt; &gt; &gt; &gt; in /etc/rcS.d which is prior to /etc/rc2.d (my default runlevel).
&gt; &gt; &gt; &gt; Libvirtd is started in rc2.d and not mentionned in rcS.d.
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; My questions are :
&gt; &gt; &gt; &gt; - - Is this the correct way to attach iscsi volume to a guest ?
&gt; &gt; &gt; &gt; - - Did I missed something to have iscsi pool autostart working at boot
&gt; &gt; &gt; &gt; time ?
&gt; &gt; &gt; 
&gt; &gt; &gt; You're doing everything right, so it's odd that the pool isn't
&gt; &gt; &gt; autostarting.  Does the pool autostart properly if you restart libvirtd
&gt; &gt; &gt; when the system is fully booted?
&gt; &gt; &gt; 
&gt; &gt; &gt; Dave
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; Hi Dave,
&gt; &gt; 
&gt; &gt; It's a very odd problem. Making network debugging with tcpdump makes me
&gt; &gt; see that my network stack doesn't receive "arp reply" related to my
&gt; &gt; target.
&gt; &gt; 
&gt; &gt; If I add an ARP entry by hand in cache or a sleep just before libvirtd
&gt; &gt; start function in startup script it works like a charm.
&gt; &gt; 
&gt; &gt; Very odd, I asked debian package maintainers for help :
&gt; &gt; 
&gt; &gt; http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=574358
&gt; 
&gt; Are the appropriate network interfaces started/configured?
&gt; 
&gt; 

Yes, I ran an ifconfig, route, iptables to see if network interfaces are
well started and if there are no iptable rules loaded. All seems to be
OK. I launched all those commands before start-stop-daemon of libvirtd.

- --
Nicolas Greneche -  RSSI et Sysadmin
Centre de Ressources Informatiques (CRI)
Doctorant au sein du projet SDS - www.sds-project.fr
Mail : nicolas.greneche_(at)_univ-orleans.fr
GPG  : http://pgp.mit.edu:11371/pks/lookup?op=get&amp;search=0x5FEBD0EF

Universite d'Orleans            Web  : http://blog.garnett.fr
Batiment 3IA - 2e etage         Tel  : 02 38 49 25 26
6 rue Leonard de Vinci
BP 6102 45061 ORLEANS Cedex 2
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iEYEARECAAYFAkujioMACgkQTx/Y+1/r0O9c4wCfZoHhroHtjMlQSSL1PwNkAggl
O1QAnicqnVlhKQ9yabNaRfEltuphzX7T
=wxbF
-----END PGP SIGNATURE-----


</body></email><email><emailId>20100321113128</emailId><senderName>mawei</senderName><senderEmail>wei_ma22@hotmail.com</senderEmail><timestampReceived>2010-03-21 11:31:28-0400</timestampReceived><subject>[libvirt-users] issues with Migrating a domain</subject><body>

Hi everyone
i've been trying to migrate a domain from hostA to hostB.But everytime i did it with 
"virsh --live migrate &lt;Domain&gt; xen+ssh://root@Destination",
it failed and told me something like 
"Error Domain not found:xenUnifiedDomainLookupByName".
The same thing happened when i tried to do the same thing with libvirt API like \
virDomainMigrate &amp; virDomainMigrateToURI. i am confused about this.
So can anybody can tell me why?Thanks a lot.
BTW ,my OS is CentOS 5.4 and my hypervisor is xen3.1.2 which is installed with the \
OS.And the libvirt version is 0.7.7. THANKS A LOT AGAIN.
 		 	   		  
_________________________________________________________________
 msn
http://ditu.live.com/?form=TL&amp;swm=1


[Attachment #3 (text/html)]

&lt;html&gt;
&lt;head&gt;
&lt;style&gt;&lt;!--
.hmmessage P
{
margin:0px;
padding:0px
}
body.hmmessage
{
font-size: 10pt;
font-family:Verdana
}
--&gt;&lt;/style&gt;
&lt;/head&gt;
&lt;body class='hmmessage'&gt;
Hi everyone&lt;br&gt;i've been trying to migrate a domain from hostA to hostB.But everytime \
i did it with &lt;br&gt;"virsh --live migrate &lt;Domain&gt; \
xen+ssh://root@Destination",&lt;br&gt;it failed and told me something like &lt;br&gt;"Error \
Domain not found:xenUnifiedDomainLookupByName".&lt;br&gt;The same thing happened when i \
tried to do the same thing with libvirt API like virDomainMigrate &amp; \
virDomainMigrateToURI.&lt;br&gt;i am confused about this.&lt;br&gt;So can anybody can tell me \
why?Thanks a lot.&lt;br&gt;BTW ,my OS is CentOS 5.4 and my hypervisor is xen3.1.2 which is \
installed with the OS.And the libvirt version is 0.7.7.&lt;br&gt;THANKS A LOT AGAIN.&lt;br&gt; 		 \
&lt;br /&gt;&lt;hr /&gt; MSN &lt;a href='http://cn.msn.com/' \
target='_new'&gt;&lt;/a&gt;&lt;/body&gt; &lt;/html&gt;



</body></email><email><emailId>20100322025702</emailId><senderName>Mike Viau</senderName><senderEmail>viaum@sheridanc.on.ca</senderEmail><timestampReceived>2010-03-22 02:57:02-0400</timestampReceived><subject>Re: [libvirt-users] virsh domxml-to-native xen-xm request</subject><body>

name = "test"
uuid = "287fe83e-8d9a-c935-6026-c9ea85b60e87"
maxmem = 7168
memory = 7168
vcpus = 7
builder = "hvm"
kernel = "/usr/lib/xen/boot/hvmloader"
boot = "c"
pae = 1
acpi = 1
apic = 1
localtime = 0
on_poweroff = "destroy"
on_reboot = "restart"
on_crash = "restart"
device_model = "/usr/lib/xen/bin/stubdom-dm"
vfb = [ "type=vnc,vncunused=1" ]
disk = [ "phy:/dev/sys/lv0,hda,w", "phy:/dev/sys/lv1,hdb,w", "phy:/dev/sys/lv2,h
dc,w" ]
vif = [ "mac=00:50:56:0f:dd:02,bridge=eth0,script=vif-bridge" ]
parallel = "none"
serial = "none"




Thanks it worked.
 

-M




&gt; Date: Sat, 20 Mar 2010 11:19:05 +0100
&gt; Subject: Re: [libvirt-users] virsh domxml-to-native xen-xm request
&gt; From: matthias.bolte@googlemail.com

&gt; 2010/3/20 Mike Viau &lt;viaum@sheridanc.on.ca&gt;:
&gt; &gt; Hello,
&gt; &gt;
&gt; &gt; I was looking at http://libvirt.org/drvxen.html
&gt; &gt;
&gt; &gt; And realized that "virsh domxml-to-native" may be used to convert the
&gt; &gt; libvirt xml formatted domU configuration to native.
&gt; &gt;
&gt; &gt; The configuration is for stubdom-dm Xen guests.
&gt; &gt;
&gt; &gt; Syntax appears to be virsh domxml-to-native xen-xm new_vm1.xml &gt;
&gt; &gt; /etc/xen/new_vm1 but I get an error.
&gt; &gt;
&gt; &gt; error: invalid argument in unsupported config type xen-xm
&gt; &gt;
&gt; &gt;
&gt; &gt; Can someone please post their output of the command: virsh domxml-to-native
&gt; &gt; xen-xm new_vm1.xml
&gt; &gt;
&gt; 
&gt; Do you just run this command?
&gt; 
&gt;    virsh domxml-to-native xen-xm new_vm1.xml &gt; /etc/xen/new_vm1
&gt; 
&gt; If you don't specify an explicit connection URI, or have
&gt; VIRSH_DEFAULT_CONNECT_URI set to to some Xen connection URI, then
&gt; libvirt will try to autodetect your hypervisor and might find QEMU. In
&gt; that case I can reproduce the reported error.
&gt; 
&gt; To make it work you need to specify a proper connection URI, for example
&gt; 
&gt;    virsh -c xen:/// domxml-to-native xen-xm new_vm1.xml &gt; /etc/xen/new_vm1
&gt; 
&gt; or whatever URI you need for your setup.
&gt; 
&gt; Matthias
 		 	   		  
_________________________________________________________________
Live connected with Messenger on your phone
http://go.microsoft.com/?linkid=9712958
[Attachment #3 (text/html)]

&lt;html&gt;
&lt;head&gt;
&lt;style&gt;&lt;!--
.hmmessage P
{
margin:0px;
padding:0px
}
body.hmmessage
{
font-size: 10pt;
font-family:Verdana
}
--&gt;&lt;/style&gt;
&lt;/head&gt;
&lt;body class='hmmessage'&gt;
name = "test"&lt;br&gt;uuid = "287fe83e-8d9a-c935-6026-c9ea85b60e87"&lt;br&gt;maxmem = \
7168&lt;br&gt;memory = 7168&lt;br&gt;vcpus = 7&lt;br&gt;builder = "hvm"&lt;br&gt;kernel = \
"/usr/lib/xen/boot/hvmloader"&lt;br&gt;boot = "c"&lt;br&gt;pae = 1&lt;br&gt;acpi = 1&lt;br&gt;apic = \
1&lt;br&gt;localtime = 0&lt;br&gt;on_poweroff = "destroy"&lt;br&gt;on_reboot = "restart"&lt;br&gt;on_crash = \
"restart"&lt;br&gt;device_model = "/usr/lib/xen/bin/stubdom-dm"&lt;br&gt;vfb = [ \
"type=vnc,vncunused=1" ]&lt;br&gt;disk = [ "phy:/dev/sys/lv0,hda,w", \
"phy:/dev/sys/lv1,hdb,w", "phy:/dev/sys/lv2,h&lt;br&gt;dc,w" ]&lt;br&gt;vif = [ \
"mac=00:50:56:0f:dd:02,bridge=eth0,script=vif-bridge" ]&lt;br&gt;parallel = \
                "none"&lt;br&gt;serial = "none"&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;Thanks it \
                worked.&lt;br&gt;&lt;br&gt;
-M&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&gt; Date: Sat, 20 Mar 2010 11:19:05 +0100&lt;br&gt;&gt; Subject: Re: \
[libvirt-users] virsh domxml-to-native xen-xm request&lt;br&gt;&gt; From: \
matthias.bolte@googlemail.com&lt;br&gt;&lt;br&gt;&gt; 2010/3/20 Mike Viau \
&lt;viaum@sheridanc.on.ca&gt;:&lt;br&gt;&gt; &gt; Hello,&lt;br&gt;&gt; &gt;&lt;br&gt;&gt; &gt; I was \
looking at http://libvirt.org/drvxen.html&lt;br&gt;&gt; &gt;&lt;br&gt;&gt; &gt; And realized that \
"virsh domxml-to-native" may be used to convert the&lt;br&gt;&gt; &gt; libvirt xml \
formatted domU configuration to native.&lt;br&gt;&gt; &gt;&lt;br&gt;&gt; &gt; The configuration \
is for stubdom-dm Xen guests.&lt;br&gt;&gt; &gt;&lt;br&gt;&gt; &gt; Syntax appears to be virsh \
domxml-to-native xen-xm new_vm1.xml &gt;&lt;br&gt;&gt; &gt; /etc/xen/new_vm1 but I get an \
error.&lt;br&gt;&gt; &gt;&lt;br&gt;&gt; &gt; error: invalid argument in unsupported config type \
xen-xm&lt;br&gt;&gt; &gt;&lt;br&gt;&gt; &gt;&lt;br&gt;&gt; &gt; Can someone please post their output of \
the command: virsh domxml-to-native&lt;br&gt;&gt; &gt; xen-xm new_vm1.xml&lt;br&gt;&gt; \
&gt;&lt;br&gt;&gt; &lt;br&gt;&gt; Do you just run this command?&lt;br&gt;&gt; &lt;br&gt;&gt;    virsh \
domxml-to-native xen-xm new_vm1.xml &gt; /etc/xen/new_vm1&lt;br&gt;&gt; &lt;br&gt;&gt; If you \
don't specify an explicit connection URI, or have&lt;br&gt;&gt; VIRSH_DEFAULT_CONNECT_URI \
set to to some Xen connection URI, then&lt;br&gt;&gt; libvirt will try to autodetect your \
hypervisor and might find QEMU. In&lt;br&gt;&gt; that case I can reproduce the reported \
error.&lt;br&gt;&gt; &lt;br&gt;&gt; To make it work you need to specify a proper connection URI, \
for example&lt;br&gt;&gt; &lt;br&gt;&gt;    virsh -c xen:/// domxml-to-native xen-xm new_vm1.xml \
&gt; /etc/xen/new_vm1&lt;br&gt;&gt; &lt;br&gt;&gt; or whatever URI you need for your \
setup.&lt;br&gt;&gt; &lt;br&gt;&gt; Matthias&lt;br&gt; 		 	   		  &lt;br /&gt;&lt;hr /&gt;Take your contacts \
everywhere.  &lt;a href='http://go.microsoft.com/?linkid=9712958' target='_new'&gt;Try \
Messenger for mobile&lt;/a&gt;&lt;/body&gt; &lt;/html&gt;



</body></email><email><emailId>20100322110251</emailId><senderName>Madhusudhan sunkara</senderName><senderEmail>madhusudhan.sunkara@gmail.com</senderEmail><timestampReceived>2010-03-22 11:02:51-0400</timestampReceived><subject>[libvirt-users] need help on working with libvirt+virtualbox</subject><body>

Hi all,


i am trying to create virtual box using libvirt ,
following is xml i tried to use following xml  (followed example in libvirt
site . http://libvirt.org/drvvbox.html)

&lt;domain type='vbox'&gt;
  &lt;name&gt;vboxtest&lt;/name&gt;
  &lt;os&gt;      &lt;type&gt;hvm&lt;/type&gt;          &lt;boot dev='hd'/&gt;        &lt;boot
dev='cdrom'/&gt;     &lt;/os&gt;
  &lt;memory&gt;393216&lt;/memory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;features&gt;   &lt;acpi/&gt;    &lt;/features&gt;
  &lt;devices&gt;
    &lt;disk type='file' device='cdrom'&gt;       &lt;source file=''/&gt;      &lt;target
dev='hdc'/&gt;      &lt;readonly/&gt;     &lt;/disk&gt;
    &lt;disk type='file' device='disk'&gt;         &lt;source
file='/d1/vir_box/ub.vdi'/&gt;         &lt;target dev='hdd'/&gt;     &lt;/disk&gt;
    &lt;interface type='bridge'&gt;       &lt;source bridge='eth0'/&gt;         &lt;mac
address='00:15:C5:ED:63:E6'/&gt;     &lt;/interface&gt;
       &lt;interface type='user'&gt;         &lt;mac address='00:15:C5:ED:63:E6'/&gt;
       &lt;model type='Am79C973'/&gt;       &lt;/interface&gt;
     &lt;parallel type='dev'&gt;         &lt;source path='/dev/pts/1'/&gt;
&lt;target port='0'/&gt;       &lt;/parallel&gt;
     &lt;parallel type='dev'&gt;         &lt;source path='/dev/pts/2'/&gt;
&lt;target port='1'/&gt;      &lt;/parallel&gt;
    &lt;serial type="dev"&gt;        &lt;source path="/dev/ttyS0"/&gt;        &lt;target
port="0"/&gt;        &lt;/serial&gt;
 &lt;/devices&gt;
&lt;/domain&gt;

now i have few questions/doubts on the xml

(i have working vdi file which is created using GUI and has ubuntu installed
, i just want to start that using another machine )
as soon as i try following code i am getting segfault , i am suspecting some
problem with xml input

import libvirt
conn=libvirt.open('vbox:///session')
xmldesc = &lt;above string&gt;
dom=conn.createLinux(xmldesc,0)
Segmentation fault


in my home directory/Machines  xml  file is created

&lt;?xml version="1.0"?&gt;
&lt;VirtualBox xmlns="http://www.innotek.de/VirtualBox-settings"
version="1.9-linux"&gt;
  &lt;Machine uuid="{9e37e287-67e3-ca78-5af0-9c38f14de49e}" name="vboxtest"
OSType="Other" lastStateChange="2010-03-22T10:29:18Z" aborted="true"&gt;
    &lt;Hardware version="2"&gt;
      &lt;CPU count="1"&gt;
        &lt;HardwareVirtEx enabled="true" exclusive="true"/&gt;
        &lt;HardwareVirtExNestedPaging enabled="true"/&gt;
        &lt;HardwareVirtExVPID enabled="true"/&gt;
        &lt;PAE enabled="false"/&gt;
      &lt;/CPU&gt;
      &lt;Memory RAMSize="384"/&gt;
      &lt;Boot&gt; &lt;Order position="1" device="Floppy"/&gt;  &lt;Order position="2"
device="DVD"/&gt; &lt;Order position="3" device="HardDisk"/&gt; &lt;Order position="4"
device="None"/&gt;     &lt;/Boot&gt;
      &lt;Display VRAMSize="8" monitorCount="1" accelerate3D="false"
accelerate2DVideo="false"/&gt;
      &lt;RemoteDisplay enabled="false" port="3389" authType="Null"/&gt;
      &lt;BIOS&gt;  &lt;ACPI enabled="true"/&gt; &lt;IOAPIC enabled="false"/&gt; &lt;Logo
fadeIn="true" fadeOut="true" displayTime="0"/&gt; &lt;BootMenu
mode="MessageAndMenu"/&gt;       &lt;TimeOffset value="0"/&gt;
        &lt;PXEDebug enabled="false"/&gt;
      &lt;/BIOS&gt;
      &lt;USBController enabled="false" enabledEhci="false"/&gt;
      &lt;Network&gt;
        &lt;Adapter slot="0" enabled="false" MACAddress="080027F53A84"
cable="true" speed="0" type="Am79C973"/&gt;
        &lt;Adapter slot="1" enabled="false" MACAddress="080027EE31BD"
cable="true" speed="0" type="Am79C973"/&gt;
        &lt;Adapter slot="2" enabled="false" MACAddress="080027CE9DA5"
cable="true" speed="0" type="Am79C973"/&gt;
        &lt;Adapter slot="3" enabled="false" MACAddress="080027D86B0D"
cable="true" speed="0" type="Am79C973"/&gt;
        &lt;Adapter slot="4" enabled="false" MACAddress="080027DAA33F"
cable="true" speed="0" type="Am79C973"/&gt;
        &lt;Adapter slot="5" enabled="false" MACAddress="08002734F6E6"
cable="true" speed="0" type="Am79C973"/&gt;
        &lt;Adapter slot="6" enabled="false" MACAddress="08002747D785"
cable="true" speed="0" type="Am79C973"/&gt;
        &lt;Adapter slot="7" enabled="false" MACAddress="080027C22A98"
cable="true" speed="0" type="Am79C973"/&gt;
      &lt;/Network&gt;
      &lt;UART&gt;
        &lt;Port slot="0" enabled="false" IOBase="0x3f8" IRQ="4"
hostMode="Disconnected"/&gt;
        &lt;Port slot="1" enabled="false" IOBase="0x3f8" IRQ="4"
hostMode="Disconnected"/&gt;
      &lt;/UART&gt;
      &lt;LPT&gt;
        &lt;Port slot="0" enabled="false" IOBase="0x378" IRQ="4"/&gt;
        &lt;Port slot="1" enabled="false" IOBase="0x378" IRQ="4"/&gt;
      &lt;/LPT&gt;
      &lt;AudioAdapter controller="AC97" driver="ALSA" enabled="false"/&gt;
      &lt;SharedFolders/&gt;
      &lt;Clipboard mode="Bidirectional"/&gt;
      &lt;Guest memoryBalloonSize="0" statisticsUpdateInterval="0"/&gt;
      &lt;GuestProperties/&gt;
    &lt;/Hardware&gt;
    &lt;StorageControllers/&gt;
  &lt;/Machine&gt;
&lt;/VirtualBox&gt;


please help me if i am doing anything wrong ,  how can i specify storage
controller in xml file and any input on why it is aborting with segfault

sorry for the long post and xml
-- 
Madhu

[Attachment #3 (text/html)]

Hi all,&lt;br&gt;&lt;br&gt;&lt;br&gt;i am trying to create virtual box using libvirt ,&lt;br&gt;following is \
xml i tried to use following xml  (followed example in libvirt site . &lt;a \
href="http://libvirt.org/drvvbox.html"&gt;http://libvirt.org/drvvbox.html&lt;/a&gt;)&lt;br&gt; \
&lt;br&gt;&lt;domain type='vbox'&gt;&lt;br&gt;  &lt;name&gt;vboxtest&lt;/name&gt;&lt;br&gt;  \
&lt;os&gt;      &lt;type&gt;hvm&lt;/type&gt;          &lt;boot dev='hd'/&gt;  \
&lt;boot dev='cdrom'/&gt;     &lt;/os&gt;&lt;br&gt;  \
&lt;memory&gt;393216&lt;/memory&gt;&lt;br&gt;  &lt;vcpu&gt;1&lt;/vcpu&gt;&lt;br&gt;  \
&lt;features&gt;   &lt;acpi/&gt;    &lt;/features&gt;&lt;br&gt;  &lt;devices&gt; &lt;br&gt;    \
&lt;disk type='file' device='cdrom'&gt;       &lt;source \
file=''/&gt;      &lt;target dev='hdc'/&gt;      &lt;readonly/&gt;    \
&lt;/disk&gt;&lt;br&gt;  &lt;disk type='file' device='disk'&gt;         \
&lt;source file='/d1/vir_box/ub.vdi'/&gt;         &lt;target \
dev='hdd'/&gt;     &lt;/disk&gt;&lt;br&gt;    &lt;interface \
type='bridge'&gt;       &lt;source bridge='eth0'/&gt;         &lt;mac \
address='00:15:C5:ED:63:E6'/&gt;     &lt;/interface&gt;&lt;br&gt;  &lt;interface \
type='user'&gt;         &lt;mac address='00:15:C5:ED:63:E6'/&gt;      \
&lt;model type='Am79C973'/&gt;       &lt;/interface&gt;&lt;br&gt;     &lt;parallel \
type='dev'&gt;         &lt;source path='/dev/pts/1'/&gt;         \
&lt;target port='0'/&gt;       &lt;/parallel&gt;&lt;br&gt;  &lt;parallel \
type='dev'&gt;         &lt;source path='/dev/pts/2'/&gt;        \
&lt;target port='1'/&gt;      &lt;/parallel&gt;&lt;br&gt;    &lt;serial \
type="dev"&gt;        &lt;source path="/dev/ttyS0"/&gt;        \
&lt;target port="0"/&gt;        &lt;/serial&gt;&lt;br&gt;  \
&lt;/devices&gt;&lt;br&gt;&lt;/domain&gt;&lt;br&gt;&lt;br&gt;now i have few questions/doubts on the xml \
&lt;br&gt;&lt;br&gt;(i have working vdi file which is created using GUI and has ubuntu installed \
, i just want to start that using another machine )&lt;br&gt; as soon as i try following \
code i am getting segfault , i am suspecting some problem with xml input &lt;br \
clear="all"&gt;&lt;br&gt;import \
libvirt&lt;br&gt;conn=libvirt.open('vbox:///session')&lt;br&gt;xmldesc = &lt;above \
string&gt;&lt;br&gt;dom=conn.createLinux(xmldesc,0)&lt;br&gt; Segmentation fault&lt;br&gt;&lt;br&gt;&lt;br&gt;in my \
home directory/Machines  xml  file is created &lt;br&gt;&lt;br&gt;&lt;?xml \
version="1.0"?&gt;&lt;br&gt;&lt;VirtualBox xmlns="&lt;a \
href="http://www.innotek.de/VirtualBox-settings"&gt;http://www.innotek.de/VirtualBox-settings&lt;/a&gt;" \
version="1.9-linux"&gt;&lt;br&gt;  &lt;Machine \
uuid="{9e37e287-67e3-ca78-5af0-9c38f14de49e}" name="vboxtest" \
OSType="Other" lastStateChange="2010-03-22T10:29:18Z" \
aborted="true"&gt;&lt;br&gt;    &lt;Hardware version="2"&gt;&lt;br&gt;  \
&lt;CPU count="1"&gt;&lt;br&gt;        &lt;HardwareVirtEx \
enabled="true" exclusive="true"/&gt;&lt;br&gt;        \
&lt;HardwareVirtExNestedPaging enabled="true"/&gt;&lt;br&gt;        \
&lt;HardwareVirtExVPID enabled="true"/&gt;&lt;br&gt;  &lt;PAE \
enabled="false"/&gt;&lt;br&gt;      &lt;/CPU&gt;&lt;br&gt;      &lt;Memory \
RAMSize="384"/&gt;&lt;br&gt;      &lt;Boot&gt;  &lt;Order position="1" \
device="Floppy"/&gt;  &lt;Order position="2" \
device="DVD"/&gt;  &lt;Order position="3" \
device="HardDisk"/&gt;  &lt;Order position="4" \
device="None"/&gt;     &lt;/Boot&gt;&lt;br&gt;  &lt;Display \
VRAMSize="8" monitorCount="1" accelerate3D="false" \
accelerate2DVideo="false"/&gt;&lt;br&gt;      &lt;RemoteDisplay \
enabled="false" port="3389" authType="Null"/&gt;&lt;br&gt;  \
&lt;BIOS&gt;   &lt;ACPI enabled="true"/&gt;  &lt;IOAPIC \
enabled="false"/&gt;  &lt;Logo fadeIn="true" \
fadeOut="true" displayTime="0"/&gt;  &lt;BootMenu \
mode="MessageAndMenu"/&gt;       &lt;TimeOffset \
value="0"/&gt;&lt;br&gt;  &lt;PXEDebug enabled="false"/&gt;&lt;br&gt;      \
&lt;/BIOS&gt;&lt;br&gt;      &lt;USBController enabled="false" \
enabledEhci="false"/&gt;&lt;br&gt;      &lt;Network&gt;&lt;br&gt;        &lt;Adapter \
slot="0" enabled="false" MACAddress="080027F53A84" \
cable="true" speed="0" type="Am79C973"/&gt;&lt;br&gt;  \
&lt;Adapter slot="1" enabled="false" \
MACAddress="080027EE31BD" cable="true" speed="0" \
type="Am79C973"/&gt;&lt;br&gt;        &lt;Adapter slot="2" \
enabled="false" MACAddress="080027CE9DA5" cable="true" \
speed="0" type="Am79C973"/&gt;&lt;br&gt;  &lt;Adapter \
slot="3" enabled="false" MACAddress="080027D86B0D" \
cable="true" speed="0" type="Am79C973"/&gt;&lt;br&gt;        \
&lt;Adapter slot="4" enabled="false" \
MACAddress="080027DAA33F" cable="true" speed="0" \
type="Am79C973"/&gt;&lt;br&gt;  &lt;Adapter slot="5" \
enabled="false" MACAddress="08002734F6E6" cable="true" \
speed="0" type="Am79C973"/&gt;&lt;br&gt;        &lt;Adapter \
slot="6" enabled="false" MACAddress="08002747D785" \
cable="true" speed="0" type="Am79C973"/&gt;&lt;br&gt;  \
&lt;Adapter slot="7" enabled="false" \
MACAddress="080027C22A98" cable="true" speed="0" \
type="Am79C973"/&gt;&lt;br&gt;      &lt;/Network&gt;&lt;br&gt;      &lt;UART&gt;&lt;br&gt;  \
&lt;Port slot="0" enabled="false" IOBase="0x3f8" \
IRQ="4" hostMode="Disconnected"/&gt;&lt;br&gt;        &lt;Port \
slot="1" enabled="false" IOBase="0x3f8" \
IRQ="4" hostMode="Disconnected"/&gt;&lt;br&gt;  &lt;/UART&gt;&lt;br&gt;      \
&lt;LPT&gt;&lt;br&gt;        &lt;Port slot="0" enabled="false" \
IOBase="0x378" IRQ="4"/&gt;&lt;br&gt;        &lt;Port \
slot="1" enabled="false" IOBase="0x378" \
IRQ="4"/&gt;&lt;br&gt;  &lt;/LPT&gt;&lt;br&gt;      &lt;AudioAdapter \
controller="AC97" driver="ALSA" \
enabled="false"/&gt;&lt;br&gt;      &lt;SharedFolders/&gt;&lt;br&gt;      &lt;Clipboard \
mode="Bidirectional"/&gt;&lt;br&gt;  &lt;Guest memoryBalloonSize="0" \
statisticsUpdateInterval="0"/&gt;&lt;br&gt;      &lt;GuestProperties/&gt;&lt;br&gt;    \
&lt;/Hardware&gt;&lt;br&gt;    &lt;StorageControllers/&gt;&lt;br&gt;  \
&lt;/Machine&gt;&lt;br&gt;&lt;/VirtualBox&gt;&lt;br&gt; &lt;br&gt;&lt;br&gt;please help me if i am doing \
anything wrong ,  how can i specify storage controller in xml file and any input on \
why it is aborting with segfault &lt;br&gt;&lt;br&gt;sorry for the long post and xml &lt;br&gt;-- \
&lt;br&gt;Madhu &lt;br&gt;



</body></email><email><emailId>20100322160131</emailId><senderName>"Nikolai K. Bochev"</senderName><senderEmail>n.bochev@grandstarco.com</senderEmail><timestampReceived>2010-03-22 16:01:31-0400</timestampReceived><subject>Re: [libvirt-users] Migrating domains across nodes</subject><body>

As far as i know proxmox supports openvz live migration :)


----- "Daniel P. Berrange" &lt;berrange@redhat.com&gt; wrote:

&gt; On Sun, Mar 21, 2010 at 11:10:07AM -0400, Sagar Dixit wrote:
&gt; &gt; Hi,
&gt; &gt; 
&gt; &gt; I am exploring the migration APIs and was curious to know if I can
&gt; use them
&gt; &gt; with LXC containers for live migration from one node to another.
&gt; &gt; If not LXC, then can I use them with OpenVZ containers ?  If yes,
&gt; what would
&gt; &gt; be the general steps involved.
&gt; 
&gt; No, there's no migration supported for either of these
&gt; 
&gt; Regards,
&gt; Daniel
&gt; -- 
&gt; |: Red Hat, Engineering, London    -o-  
&gt; http://people.redhat.com/berrange/ :|
&gt; |: http://libvirt.org -o- http://virt-manager.org -o-
&gt; http://deltacloud.org :|
&gt; |: http://autobuild.org        -o-        
&gt; http://search.cpan.org/~danberr/ :|
&gt; |: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B
&gt; 9505 :|
&gt; 
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users

-- 


Nikolai K. Bochev 
System Administrator 

Website : GrandstarCO | http://www.grandstarco.com 



</body></email><email><emailId>20100322182311</emailId><senderName>Marco Mornati</senderName><senderEmail>mmornati@byte-code.com</senderEmail><timestampReceived>2010-03-22 18:23:11-0400</timestampReceived><subject>[libvirt-users] Libvirt using ssh</subject><body>

Hello,

I'm looking that using libvirt Java library with ssh, when connection  
is closed the ssh process used as connection to hyperisor is not  
closed. Is there a different way than close invoking to kill that  
process? If not maybe there is something to fix in java porting.

Let me know
Bye
Marco


</body></email><email><emailId>20100325203244</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2010-03-25 20:32:44-0400</timestampReceived><subject>Re: [libvirt-users] Problem attaching device</subject><body>

On Thu, Mar 25, 2010 at 12:41:21PM -0700, steven765@yahoo.com wrote:
&gt; Thanks, but problem still persists. I actually fat fingered entering it the first time   
&gt; 
&gt; The xmlfile really is: 
&gt; 
&gt; &lt;?xml version="1.0"?&gt;
&gt; &lt;interface type="network"&gt;
&gt;   &lt;mac address="52:54:00:5c:fe:a8"/&gt;
&gt;   &lt;source network="default"/&gt;
&gt;   &lt;target dev="vnet1"/&gt;
&gt; &lt;/interface&gt;
&gt; 
&gt;  I ran xmllint and it just says no DTD specified,

  not normal, 

&gt; &gt; xmllint net.xml

as I suggested should never ask for a DTD !

&gt; however this works perfectly if i use the attach-device command in virsh.

  then this proves it's well formed and libvirt finds the informations
it looks after.

&gt; I tired it both with and without the first line version=1.0

  yup that's XML metadata, does not need to be present

&gt; I try running it through python and boom, is there something else
&gt; I'm missing? 

  You probably failed to load it into python one way or another.

&gt; I can't find any documentation about the overall libvirt xml schema. 

Using Relax-NG syntax, usually stored in:

  /usr/share/libvirt/schemas/

xmllint --noout --relaxng foo.rng foo.xml

outputs the result of the validation of foo.xml against foo.rng
schemas,

Daniel

-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

</body></email><email><emailId>20100330125939</emailId><senderName>Jonathan M Barney</senderName><senderEmail>jmbarney@us.ibm.com</senderEmail><timestampReceived>2010-03-30 12:59:39-0400</timestampReceived><subject>[libvirt-users]  how-to doc for svirt/SELinux enabling</subject><body>

Anyone have a pointer or some documentation or a how to enable svirt
support in RHEL 5.4 using libvirt 6.3 and KVM/QEMU?


Thanks
Jonathan
[Attachment #3 (text/html)]

&lt;html&gt;&lt;body&gt;
&lt;p&gt;Anyone have a pointer or some documentation or a how to enable svirt support in \
RHEL 5.4 using libvirt 6.3 and KVM/QEMU?&lt;br&gt; &lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;b&gt;&lt;font size="2" face="Arial"&gt;Jonathan&lt;/font&gt;&lt;/b&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20100330180153</emailId><senderName>Michael Alexander</senderName><senderEmail>malexand@scaledinfra.com</senderEmail><timestampReceived>2010-03-30 18:01:53-0400</timestampReceived><subject>[libvirt-users] CfP with Extended Deadline 5th Workshop on Virtualization in High-Performance Cloud </subject><body>

Apologies if you received multiple copies of this message.


=================================================================

CALL FOR PAPERS

5th Workshop on

Virtualization in High-Performance Cloud Computing

VHPC'10

as part of Euro-Par 2010, Island of Ischia-Naples, Italy

=================================================================

Date: August 31, 2010

Euro-Par 2009: http://www.europar2010.org/

Workshop URL: http://vhpc.org

SUBMISSION DEADLINE:

Abstracts: April 4, 2010 (extended)
Full Paper: June 19, 2010 (extended) 


Scope:

Virtualization has become a common abstraction layer in modern data
centers, enabling resource owners to manage complex infrastructure
independently of their applications. Conjointly virtualization is
becoming a driving technology for a manifold of industry grade IT
services. Piloted by the Amazon Elastic Computing Cloud services, the
cloud concept includes the notion of a separation between resource
owners and users, adding services such as hosted application
frameworks and queuing. Utilizing the same infrastructure, clouds
carry significant potential for use in high-performance scientific
computing. The ability of clouds to provide for requests and releases
of vast computing resource dynamically and close to the marginal cost
of providing the services is unprecedented in the history of
scientific and commercial computing.

Distributed computing concepts that leverage federated resource access
are popular within the grid community, but have not seen previously
desired deployed levels so far. Also, many of the scientific
datacenters have not adopted virtualization or cloud concepts yet.

This workshop aims to bring together industrial providers with the
scientific community in order to foster discussion, collaboration and
mutual exchange of knowledge and experience.

The workshop will be one day in length, composed of 20 min paper
presentations, each followed by 10 min discussion sections.
Presentations may be accompanied by interactive demonstrations. It
concludes with a 30 min panel discussion by presenters.

TOPICS

Topics include, but are not limited to, the following subjects:

- Virtualization in cloud, cluster and grid HPC environments
- VM cloud, cluster load distribution algorithms
- Cloud, cluster and grid filesystems
- QoS and and service level guarantees
- Cloud programming models, APIs and databases
- Software as a service (SaaS)
- Cloud provisioning
- Virtualized I/O
- VMMs and storage virtualization
- MPI, PVM on virtual machines
- High-performance network virtualization
- High-speed interconnects
- Hypervisor extensions
- Tools for cluster and grid computing
- Xen/other VMM cloud/cluster/grid tools
- Raw device access from VMs
- Cloud reliability, fault-tolerance, and security
- Cloud load balancing
- VMs - power efficiency
- Network architectures for VM-based environments
- VMMs/Hypervisors
- Hardware support for virtualization
- Fault tolerant VM environments
- Workload characterizations for VM-based environments
- Bottleneck management
- Metering
- VM-based cloud performance modeling
- Cloud security, access control and data integrity
- Performance management and tuning hosts and guest VMs
- VMM performance tuning on various load types
- Research and education use cases
- Cloud use cases
- Management of VM environments and clouds
- Deployment of VM-based environments



PAPER SUBMISSION

Papers submitted to the workshop will be reviewed by at least two
members of the program committee and external reviewers. Submissions
should include abstract, key words, the e-mail address of the
corresponding author, and must not exceed 10 pages, including tables
and figures at a main font size no smaller than 11 point. Submission
of a paper should be regarded as a commitment that, should the paper
be accepted, at least one of the authors will register and attend the
conference to present the work.

Accepted papers will be published in the Springer LNCS series - the
format must be according to the Springer LNCS Style. Initial
submissions are in PDF, accepted papers will be requested to provided
source files.

Format Guidelines: http://www.springer.de/comp/lncs/authors.html

Submission Link: http://edas.info/newPaper.php?c=8553


IMPORTANT DATES

April 4 - Abstract submission due (extended)
May 19 - Full paper submission (extended)
July 14 - Acceptance notification
August 3 - Camera-ready version due
August 31 - September 3 - conference


CHAIR

Michael Alexander (chair), scaledinfra technologies GmbH, Austria
Gianluigi Zanetti (co-chair), CRS4, Italy


PROGRAM COMMITTEE

Padmashree Apparao, Intel Corp., USA
Volker Buege, University of Karlsruhe, Germany
Roberto Canonico, University of Napoli Federico II, Italy
Tommaso Cucinotta, Scuola Superiore Sant'Anna, Italy
Werner Fischer, Thomas Krenn AG, Germany
William Gardner, University of Guelph, Canada
Wolfgang Gentzsch, DEISA. Max Planck Gesellschaft, Germany
Derek Groen, UVA, The Netherlands
Marcus Hardt, Forschungszentrum Karlsruhe, Germany
Sverre Jarp, CERN, Switzerland
Shantenu Jha, Louisiana State University, USA
Xuxian Jiang, NC State, USA
Kenji Kaneda, Google, Japan
Yves Kemp, DESY Hamburg, Germany
Ignacio Llorente, Universidad Complutense de Madrid, Spain
Naoya Maruyama, Tokyo Institute of Technology, Japan
Jean-Marc Menaud, Ecole des Mines de Nantes, France
Anastassios Nano, National Technical University of Athens, Greece
Oliver Oberst, Karlsruhe Institute of Technology, Germany
Jose Renato Santos, HP Labs, USA
Borja Sotomayor, University of Chicago, USA
Yoshio Turner, HP Labs, USA
Kurt Tuschku, University of Vienna, Austria
Lizhe Wang, Indiana University, USA
Chao-Tung Yang, Tunghai University, Taiwan


DURATION: Workshop Duration is one day.

GENERAL INFORMATION

The workshop will be held as part of Euro-Par 2010,
Island of Ischia-Naples, Italy.
Euro-Par 2010: http://www.europar2010.org/


</body></email><email><emailId>20100330204249</emailId><senderName></senderName><senderEmail>steven765@yahoo.com</senderEmail><timestampReceived>2010-03-30 20:42:49-0400</timestampReceived><subject>[libvirt-users] Attach-interface vs attach-device</subject><body>

Working with the two commands there's a noticeable difference in the time redhat \
takes to detect interfaces using attach-interface vs attach-device?  About 5-8 \
seconds using attach interface, and near instant with attach-device.

That little bit aside, I'm trying to find a way to 'unplug' a VM without actually \
removing the interface.  

The easy fix is to attach it without adding the tap interface to mybridge, but attach \
device and interface do not allow this.

Looking in the source for libvirt I found the InterfacesStartmodeDefFormat however it \
seems that virsh doesn't export this option.  Maybe this just needs to be \
implemented?  

Might anyone have insights as to the best method to pursue?
I'm willing to do the leg work but I'm just starting to look into how the sources are \
laid out and that's going to take a bit. Pointers are appreciated.    

Thanks in advance,
Steve



      


</body></email><email><emailId>20100331091212</emailId><senderName>Chaitra Gorantla</senderName><senderEmail>chaitra.gorantla@lntinfotech.com</senderEmail><timestampReceived>2010-03-31 09:12:12-0400</timestampReceived><subject>Re: [libvirt-users] Vserver patch for Libvirt</subject><body>

HI,
Is there any plans by Libvirt to relase patch for Vserver??

Regards,
Chaitra GN

-----Original Message-----
From: Daniel Veillard [mailto:veillard@redhat.com]
Sent: Monday, March 29, 2010 6:20 PM
To: Chaitra Gorantla
Cc: libvirt-users@redhat.com; libvirt-list@redhat.com
Subject: Re: [libvirt-users] Vserver patch for Libvirt

On Mon, Mar 29, 2010 at 11:14:48AM +0530, Chaitra Gorantla wrote:
&gt; Hi all,
&gt; I am using libvirt for managing KVM. I would also like to manage Vserver also using \
&gt; libvirt. Is there any patch available for vserver ?

  no

&gt; When will libvirt relase official patch for vserver?

  When someone will provide such a patch if this ever happen.

Daniel

--
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

______________________________________________________________________

This Email may contain confidential or privileged information for the intended \
recipient (s) If you are not the intended recipient, please do not use or disseminate \
the information, notify the sender and delete it from your system.

______________________________________________________________________


</body></email><email><emailId>20100331094748</emailId><senderName></senderName><senderEmail>brandlk</senderEmail><timestampReceived>2010-03-31 09:47:48-0400</timestampReceived><subject>Re: [libvirt-users] libvirt connections</subject><body>

&gt;&gt; - I want to close all libvirt connections at the end, but closing the
&gt;&gt; connections does not close the ssh - nc connections libvirt opens in the
&gt;&gt; background to talk to the hypervisor. I have to manually delete all
&gt;&gt; domain
&gt;&gt; objects as well to get the pending ssh - nc connections closed. I can
&gt;&gt; keep
&gt;&gt; on using the domain object, even if I closed the connection before.
&gt;&gt; Is this behaviour intended?
&gt;
&gt; This behavior is intended. Connection and domain objects are
&gt; refcounted. If you open a connection conn it starts with a refcount of
&gt; 1. When you request a domain object using conn, then the refcount of
&gt; that connection is increased by 1. Upon destruction of the domain
&gt; object the refcount of conn is decreased again by 1.
&gt;
&gt; Now if you call close on conn or get rid of the python reference by
&gt; assigning None to conn, then the connection is not closed immediately,
&gt; only the refcount is decreased by 1. The connection gets closed when
&gt; its refcount reaches zero. This happens if you close the connection
&gt; _and_ free all domain, network, interface objects etc. that you
&gt; requested using that connection.

Thx. If you know how it works, it's ok :)
What about the other issue?

&gt;&gt; - if the hypervisor is not running, libvirt.open("xen+ssh://host")
&gt;&gt; doesn't
&gt;&gt; time out put keeps trying to connect to host on port 8000.
&gt;&gt; I've tried with the following test program:
&gt;&gt;
&gt;&gt; try:
&gt;&gt;   conn = libvirt.open("xen+ssh://host")
&gt;&gt; except:
&gt;&gt;   print "failed"
&gt;&gt;   sys.exit(1)
&gt;&gt;
&gt;&gt; However: after aborting the program with Ctrl-C I get the exception.
&gt;&gt;

K. Haselhorst

</body></email><email><emailId>20100331174508</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-03-31 17:45:08-0400</timestampReceived><subject>Re: [libvirt-users] connection creating</subject><body>

On Wed, Mar 31, 2010 at 10:30:58AM -0700, jeremy avnet wrote:
&gt; Are there any recommendations as to how often a new connection should be
&gt; made versus reused? Right now we create a new connection *every time* we hit
&gt; libvirt for something. We can easily change this so that a single connection
&gt; is made for a series of libvirt calls, or even so that a single connection
&gt; is used for the lifetime of the running application.
&gt; 
&gt; What are the issues to consider when making these choices?

As of libvirt 0.7.0 or later, libvirt is fully threadsafe allowing many
threads to use the same virConnectPtr concurrently. It will do all
neccessary locking internally to ensure safety. When no API calls are being
issued, there is no harm in keeping the libvirt connection open.

Using a single connection, open at all times you avoid the potentially
high overhead of authentication &amp; encryption setup  at time of connect.

I'd always recommend using a single, permanently open connection these days.

Oh, and if you keep the connection open you can register for async events
to be notified when interesting things happen in QEMU

Regards,
Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100331202139</emailId><senderName>Daniel Veillard</senderName><senderEmail>veillard@redhat.com</senderEmail><timestampReceived>2010-03-31 20:21:39-0400</timestampReceived><subject>Re: [libvirt-users] advice on creating and reusing connections</subject><body>

On Wed, Mar 31, 2010 at 10:32:13AM -0700, jeremy avnet wrote:
&gt; Are there any recommendations as to how often a new connection should be
&gt; made versus reused? Right now we create a new connection *every time* we hit
&gt; libvirt for something. We can easily change this so that a single connection
&gt; is made for a series of libvirt calls, or even so that a single connection
&gt; is used for the lifetime of the running application.
&gt; 
&gt; What are the issues to consider when making these choices?

  libvirt API used to be not thread safe, so for concurrent or GUI
related it was often a good idea to at least have one connection per
thread. Those days it's not really needed. Note that most operations
in libvirt are synchronous, and a few are rather long running so
it's tempting to have concurrent operations in different threads.

Daniel


-- 
Daniel Veillard      | libxml Gnome XML XSLT toolkit  http://xmlsoft.org/
daniel@veillard.com  | Rpmfind RPM search engine http://rpmfind.net/
http://veillard.com/ | virtualization library  http://libvirt.org/

</body></email><email><emailId>20100331222115</emailId><senderName>angelo alfano</senderName><senderEmail>angeloalfa76@yahoo.it</senderEmail><timestampReceived>2010-03-31 22:21:15-0400</timestampReceived><subject>Re: [libvirt-users] connect libvirt and virtualbox</subject><body>

I have installed virtualbox 3.0.14 and libvirt 0.7.0, error:

libvir: Remote error : unable to connect to '/var/run/libvirt/libvirt-sock': Connection refused
libvir: warning : Failed to find the interface: Is the daemon running ?
libvir: Remote error : unable to connect to '/var/run/libvirt/libvirt-sock': Connection refused
libvir: Remote error : unable to connect to '/var/run/libvirt/libvirt-sock': Connection refused
libvir: warning : Failed to find a node driver: Is the libvirtd daemon running ?





________________________________
Da: Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;
A: angelo alfano &lt;angeloalfa76@yahoo.it&gt;
Cc: libvirt mail-list &lt;libvirt-users@redhat.com&gt;
Inviato: Mer 31 marzo 2010, 20:43:29
Oggetto: Re: [libvirt-users] connect libvirt and virtualbox

Ah, sorry, I missed to mention that VirtualBox 3.1 support was added
in libvirt 0.7.5.

libvirt 0.7.0 supports VirtualBox 2.2 and 3.0.

Matthias

2010/3/31 angelo alfano &lt;angeloalfa76@yahoo.it&gt;:
&gt; I have installed virtualbox 3.1.6 r.59338 e libvirt 0.7.0, but i have the
&gt; same error...
&gt;
&gt; libvir: VBOX error : internal error unable to initialize VirtualBox driver
&gt; API
&gt; Traceback (most recent call last):
&gt;   File "prova.py", line 5, in &lt;module&gt;
&gt;     conn = libvirt.open("vbox:///session")
&gt;   File "/usr/lib/python2.6/dist-packages/libvirt.py", line 163, in open
&gt;     if ret is None:raise libvirtError('virConnectOpen() failed')
&gt; libvirt.libvirtError: internal error unable to initialize VirtualBox driver
&gt; API
&gt;
&gt;
&gt; ________________________________
&gt; Da: Matthias Bolte &lt;matthias.bolte@googlemail.com&gt;
&gt; A: angelo alfano &lt;angeloalfa76@yahoo.it&gt;
&gt; Cc: libvirt mail-list &lt;libvirt-users@redhat.com&gt;; Pritesh Kothari
&gt; &lt;pritesh.kothari@sun.com&gt;
&gt; Inviato: Mer 31 marzo 2010, 18:43:52
&gt; Oggetto: Re: [libvirt-users] connect libvirt and virtualbox
&gt;
&gt; 2010/3/31 angelo alfano &lt;angeloalfa76@yahoo.it&gt;:
&gt;&gt;
&gt;&gt;&gt;2010/3/31 angelo alfano &lt;angeloalfa76@yahoo.it&gt;:
&gt;&gt;&gt;&gt; conn = libvirt.open("vbox:///session")
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; return this error:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; libvir: VBOX error : internal error unable to initialize VirtualBox
&gt;&gt;&gt;&gt; driver
&gt;&gt;&gt;&gt; API
&gt;&gt;&gt;&gt; Traceback (most recent call last):
&gt;&gt;&gt;&gt;   File "prova.py", line 5, in &lt;module&gt;
&gt;&gt;&gt;&gt;     conn = libvirt.open("vbox:///session")
&gt;&gt;&gt;&gt;   File "/usr/lib/python2.6/dist-packages/libvirt.py", line 163, in open
&gt;&gt;&gt;&gt;     if ret is None:raise libvirtError('virConnectOpen() failed')
&gt;&gt;&gt;&gt; libvirt.libvirtError: internal error unable to initialize VirtualBox
&gt;&gt;&gt;&gt; driver
&gt;&gt;&gt;&gt; API
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; why?
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;This error basically says, that libvirt doesn't support your VirtualBox
&gt;&gt;&gt; version.
&gt;&gt;&gt;
&gt;&gt;&gt;What libvirt and VirtualBox version do you use?
&gt;&gt;&gt;
&gt;&gt;&gt;Matthias
&gt;&gt;
&gt;&gt;
&gt;&gt; libvirt 0.7.0
&gt;&gt; virtualbox 3.2
&gt;&gt;
&gt;&gt; Angelo
&gt;&gt;
&gt;
&gt; libvirt currently supports up to VirtualBox 3.1 and needs to be
&gt; updated to support 3.2.
&gt;
&gt; I've CCed the VirtualBox driver maintainer.
&gt;
&gt; Matthias
&gt;



      
[Attachment #3 (text/html)]

&lt;html&gt;&lt;head&gt;&lt;style type="text/css"&gt;&lt;!-- DIV {margin:0px;} \
--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div style="font-family:times new roman,new \
york,times,serif;font-size:12pt"&gt;&lt;div&gt;I have installed virtualbox 3.0.14 and libvirt \
0.7.0, error:&lt;br&gt;&lt;br&gt;libvir: Remote error : unable to connect to \
'/var/run/libvirt/libvirt-sock': Connection refused&lt;br&gt;libvir: warning : Failed to \
find the interface: Is the daemon running ?&lt;br&gt;libvir: Remote error : unable to \
connect to '/var/run/libvirt/libvirt-sock': Connection refused&lt;br&gt;libvir: Remote \
error : unable to connect to '/var/run/libvirt/libvirt-sock': Connection \
refused&lt;br&gt;libvir: warning : Failed to find a node driver: Is the libvirtd daemon \
running ?&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div style="font-family: times new roman,new york,times,serif; \
font-size: 12pt;"&gt;&lt;br&gt;&lt;div style="font-family: arial,helvetica,sans-serif; font-size: \
10pt;"&gt;&lt;font size="2" face="Tahoma"&gt;&lt;hr size="1"&gt;&lt;b&gt;&lt;span style="font-weight: \
bold;"&gt;Da:&lt;/span&gt;&lt;/b&gt; Matthias Bolte  \
&lt;matthias.bolte@googlemail.com&gt;&lt;br&gt;&lt;b&gt;&lt;span style="font-weight: \
bold;"&gt;A:&lt;/span&gt;&lt;/b&gt; angelo alfano &lt;angeloalfa76@yahoo.it&gt;&lt;br&gt;&lt;b&gt;&lt;span \
style="font-weight: bold;"&gt;Cc:&lt;/span&gt;&lt;/b&gt; libvirt mail-list \
&lt;libvirt-users@redhat.com&gt;&lt;br&gt;&lt;b&gt;&lt;span style="font-weight: \
bold;"&gt;Inviato:&lt;/span&gt;&lt;/b&gt; Mer 31 marzo 2010, 20:43:29&lt;br&gt;&lt;b&gt;&lt;span \
style="font-weight: bold;"&gt;Oggetto:&lt;/span&gt;&lt;/b&gt; Re: [libvirt-users] connect libvirt \
and virtualbox&lt;br&gt;&lt;/font&gt;&lt;br&gt;Ah, sorry, I missed to mention that VirtualBox 3.1 \
support was added&lt;br&gt;in libvirt 0.7.5.&lt;br&gt;&lt;br&gt;libvirt 0.7.0 supports VirtualBox 2.2 \
and 3.0.&lt;br&gt;&lt;br&gt;Matthias&lt;br&gt;&lt;br&gt;2010/3/31 angelo alfano &lt;&lt;a \
ymailto="mailto:angeloalfa76@yahoo.it" \
href="mailto:angeloalfa76@yahoo.it"&gt;angeloalfa76@yahoo.it&lt;/a&gt;&gt;:&lt;br&gt;&gt; I have \
installed virtualbox 3.1.6 r.59338 e libvirt 0.7.0, but i have the&lt;br&gt;&gt; same \
error...&lt;br&gt;&gt;&lt;br&gt;&gt; libvir: VBOX error : internal error unable to initialize \
VirtualBox driver&lt;br&gt;&gt;  API&lt;br&gt;&gt; Traceback (most recent call last):&lt;br&gt;&gt; \
 File "prova.py", line 5, in &lt;module&gt;&lt;br&gt;&gt;  conn = \
libvirt.open("vbox:///session")&lt;br&gt;&gt;  File \
"/usr/lib/python2.6/dist-packages/libvirt.py", line 163, in open&lt;br&gt;&gt; \
 if ret is None:raise libvirtError('virConnectOpen() \
failed')&lt;br&gt;&gt; libvirt.libvirtError: internal error unable to initialize VirtualBox \
driver&lt;br&gt;&gt; API&lt;br&gt;&gt;&lt;br&gt;&gt;&lt;br&gt;&gt; ________________________________&lt;br&gt;&gt; \
Da: Matthias Bolte &lt;&lt;a ymailto="mailto:matthias.bolte@googlemail.com" \
href="mailto:matthias.bolte@googlemail.com"&gt;matthias.bolte@googlemail.com&lt;/a&gt;&gt;&lt;br&gt;&gt; \
A: angelo alfano &lt;&lt;a ymailto="mailto:angeloalfa76@yahoo.it" \
href="mailto:angeloalfa76@yahoo.it"&gt;angeloalfa76@yahoo.it&lt;/a&gt;&gt;&lt;br&gt;&gt; Cc: libvirt \
mail-list &lt;&lt;a ymailto="mailto:libvirt-users@redhat.com" \
href="mailto:libvirt-users@redhat.com"&gt;libvirt-users@redhat.com&lt;/a&gt;&gt;; Pritesh  \
Kothari&lt;br&gt;&gt; &lt;&lt;a ymailto="mailto:pritesh.kothari@sun.com" \
href="mailto:pritesh.kothari@sun.com"&gt;pritesh.kothari@sun.com&lt;/a&gt;&gt;&lt;br&gt;&gt; \
Inviato: Mer 31 marzo 2010, 18:43:52&lt;br&gt;&gt; Oggetto: Re: [libvirt-users] connect \
libvirt and virtualbox&lt;br&gt;&gt;&lt;br&gt;&gt; 2010/3/31 angelo alfano &lt;&lt;a \
ymailto="mailto:angeloalfa76@yahoo.it" \
href="mailto:angeloalfa76@yahoo.it"&gt;angeloalfa76@yahoo.it&lt;/a&gt;&gt;:&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt;&gt;2010/3/31 \
angelo alfano &lt;&lt;a ymailto="mailto:angeloalfa76@yahoo.it" \
href="mailto:angeloalfa76@yahoo.it"&gt;angeloalfa76@yahoo.it&lt;/a&gt;&gt;:&lt;br&gt;&gt;&gt;&gt;&gt; \
conn = libvirt.open("vbox:///session")&lt;br&gt;&gt;&gt;&gt;&gt;&lt;br&gt;&gt;&gt;&gt;&gt; return \
this error:&lt;br&gt;&gt;&gt;&gt;&gt;&lt;br&gt;&gt;&gt;&gt;&gt; libvir: VBOX error : internal \
error unable to initialize VirtualBox&lt;br&gt;&gt;&gt;&gt;&gt; driver&lt;br&gt;&gt;&gt;&gt;&gt; \
API&lt;br&gt;&gt;&gt;&gt;&gt; Traceback (most recent call last):&lt;br&gt;&gt;&gt;&gt;&gt;  \
File "prova.py", line 5, in  &lt;module&gt;&lt;br&gt;&gt;&gt;&gt;&gt;  \
conn = libvirt.open("vbox:///session")&lt;br&gt;&gt;&gt;&gt;&gt;  File \
"/usr/lib/python2.6/dist-packages/libvirt.py", line 163, in open&lt;br&gt;&gt;&gt;&gt;&gt; \
 if ret is None:raise libvirtError('virConnectOpen() \
failed')&lt;br&gt;&gt;&gt;&gt;&gt; libvirt.libvirtError: internal error unable to \
initialize VirtualBox&lt;br&gt;&gt;&gt;&gt;&gt; driver&lt;br&gt;&gt;&gt;&gt;&gt; \
API&lt;br&gt;&gt;&gt;&gt;&gt;&lt;br&gt;&gt;&gt;&gt;&gt; \
why?&lt;br&gt;&gt;&gt;&gt;&gt;&lt;br&gt;&gt;&gt;&gt;&lt;br&gt;&gt;&gt;&gt;This error basically says, \
that libvirt doesn't support your VirtualBox&lt;br&gt;&gt;&gt;&gt; \
version.&lt;br&gt;&gt;&gt;&gt;&lt;br&gt;&gt;&gt;&gt;What libvirt and VirtualBox version do you \
use?&lt;br&gt;&gt;&gt;&gt;&lt;br&gt;&gt;&gt;&gt;Matthias&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt; \
libvirt 0.7.0&lt;br&gt;&gt;&gt; virtualbox 3.2&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt; \
Angelo&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&lt;br&gt;&gt; libvirt currently supports up to VirtualBox 3.1 \
and needs to be&lt;br&gt;&gt; updated to  support 3.2.&lt;br&gt;&gt;&lt;br&gt;&gt; I've CCed the \
VirtualBox driver maintainer.&lt;br&gt;&gt;&lt;br&gt;&gt; Matthias&lt;br&gt;&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt; \
&lt;/div&gt;&lt;br&gt;



      &lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20100202192303</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-02-02 19:23:03-0400</timestampReceived><subject>Re: [libvirt-users] Problem creating VM: "tap: not a valid disk type"</subject><body>

On Sat, Jan 30, 2010 at 10:31:46PM +0100, Arik Raffael Funke wrote:
&gt; Hi,
&gt; 
&gt; I am having problems creating VMs in virt-manager.
&gt; 
&gt; I have played with different xen hypervisor versions 3.0 &amp; 3.4 (with rpm 
&gt; -i --force) but have in principle gone back to the originals. - Though I 
&gt; cannot absolutely exclude that something has gone wrong.
&gt; 
&gt; In principle I am using rhel 5.4 with the gitco xen 3.4 hypervisor.
&gt; 
&gt; Can anybody put me on the right track with the attached error message? 
&gt; Note, the storage file I am attempting to use does exist.
&gt; 
&gt; Many thanks,
&gt; Arik
&gt; 
&gt; ===
&gt; Unable to complete install 'libvirt.libvirtError POST operation failed: 
&gt; xend_post: error from xen daemon: (xend.err 'Error creating domain: 
&gt; Invalid Configuration: tap: not a valid disk type')

For some reason this shows that Xen is rejecting the 'tap:aio' disk
access type, which is rather unexpected - probably need upstream
Xen to answer that one

Daniel
-- 
|: Red Hat, Engineering, London   -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org  -o-  http://virt-manager.org  -o-  http://ovirt.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-  F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100203104724</emailId><senderName>anuj rampal</senderName><senderEmail>rampal.anuj@gmail.com</senderEmail><timestampReceived>2010-02-03 10:47:24-0400</timestampReceived><subject>[libvirt-users] Storage requirement for KVM</subject><body>

Hi all,

I have to buy a server machine and Run KVM on it.

I just wanted to know what type of storage devices are supported by KVM.

Thanks &amp; Regards
Anuj

[Attachment #3 (text/html)]

Hi all,&lt;br&gt;&lt;br&gt;I have to buy a server machine and Run KVM on it.&lt;br&gt;&lt;br&gt;I just wanted \
to know what type of storage devices are supported by KVM.&lt;br&gt;&lt;br&gt;Thanks &amp; \
Regards&lt;br&gt;Anuj&lt;br&gt;



</body></email><email><emailId>20100203162255</emailId><senderName>Stephen Liu</senderName><senderEmail>satimis@yahoo.com</senderEmail><timestampReceived>2010-02-03 16:22:55-0400</timestampReceived><subject>Re: [libvirt-users] No sound</subject><body>

From: Cole Robinson &lt;crobinso@redhat.com&gt;

To: Stephen Liu &lt;satimis@yahoo.com&gt;
Cc: libvirt-users@redhat.com
Sent: Wed, February 3, 2010 11:13:50 PM
Subject: Re: [libvirt-users] No sound


&gt; There are known issues with sound. Some of them (for fedora at least) are
&gt; documented here:

https://bugzilla.redhat.com/show_bug.cgi?id=508317


Hi Cole,

Thanks for your advice.

I have 2 virtual machines here

Virtual Machine-1
Host - Fedora 12
KVM
libvirt

Vitural Machine-2
Host - Debian 5.0
KVM
libvirt


Both without sound on VM.

Just made following test on Machine-1
Edit /etc/libvirt/qemu.conf
set:
security_driver = "none"

Rebooted PC.  Started VM

Still there is no sound

B.R.
Stephen L

Send instant messages to your online friends http://uk.messenger.yahoo.com 
[Attachment #3 (text/html)]

&lt;html&gt;&lt;head&gt;&lt;style type="text/css"&gt;&lt;!-- DIV {margin:0px;} \
--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div \
style="font-family:arial,helvetica,sans-serif;font-size:12pt"&gt;&lt;div \
style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"&gt;&lt;b&gt;&lt;span \
style="font-weight: bold;"&gt;From:&lt;/span&gt;&lt;/b&gt; Cole Robinson \
&lt;crobinso@redhat.com&gt;&lt;br&gt;&lt;div style="font-family: arial,helvetica,sans-serif; \
font-size: 13px;"&gt;&lt;font face="Tahoma" size="2"&gt;&lt;b&gt;&lt;span style="font-weight: \
bold;"&gt;To:&lt;/span&gt;&lt;/b&gt; Stephen Liu &lt;satimis@yahoo.com&gt;&lt;br&gt;&lt;b&gt;&lt;span \
style="font-weight: bold;"&gt;Cc:&lt;/span&gt;&lt;/b&gt; libvirt-users@redhat.com&lt;br&gt;&lt;b&gt;&lt;span \
style="font-weight: bold;"&gt;Sent:&lt;/span&gt;&lt;/b&gt; Wed, February 3, 2010 11:13:50 \
PM&lt;br&gt;&lt;b&gt;&lt;span style="font-weight: bold;"&gt;Subject:&lt;/span&gt;&lt;/b&gt; Re: [libvirt-users] No \
sound&lt;br&gt;&lt;/font&gt;&lt;br&gt;&lt;br&gt;&gt; There are known issues with sound. Some of them (for \
fedora at least) are&lt;br&gt;&gt; documented here:&lt;br&gt;&lt;br&gt;&lt;a \
href="https://bugzilla.redhat.com/show_bug.cgi?id=508317"  \
target="_blank"&gt;https://bugzilla.redhat.com/show_bug.cgi?id=508317&lt;/a&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;Hi \
Cole,&lt;br&gt;&lt;br&gt;Thanks for your advice.&lt;br&gt;&lt;br&gt;I have 2 virtual machines \
here&lt;br&gt;&lt;br&gt;Virtual Machine-1&lt;br&gt;Host - Fedora 12&lt;br&gt;KVM&lt;br&gt;libvirt&lt;br&gt;&lt;br&gt;Vitural \
Machine-2&lt;br&gt;Host - Debian 5.0&lt;br&gt;KVM&lt;br&gt;libvirt&lt;br&gt;&lt;br&gt;&lt;br&gt;Both without sound on \
VM.&lt;br&gt;&lt;br&gt;Just made following test on Machine-1&lt;br&gt;Edit \
/etc/libvirt/qemu.conf&lt;br&gt;set:&lt;br&gt;security_driver = "none"&lt;br&gt;&lt;br&gt;Rebooted PC. \
Started VM&lt;br&gt;&lt;br&gt;Still there is no sound&lt;br&gt;&lt;br&gt;B.R.&lt;br&gt;Stephen \
L&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt; &lt;!-- cg26.c4.mail.gq1.yahoo.com compressed/chunked Wed \
Feb  3 08:12:54 PST 2010 --&gt; &lt;/div&gt;&lt;br&gt;Send instant messages to your online friends \
http://uk.messenger.yahoo.com &lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20100204134449</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-02-04 13:44:49-0400</timestampReceived><subject>Re: [libvirt-users] [libvirt] [LXC] Tyring to locate livbvirt operations for LXC relocation</subject><body>

On Wed, Feb 03, 2010 at 04:03:10PM +0200, Avi Weit wrote:
&gt; 
&gt; Hello,
&gt; 
&gt; I am searching for the libvirt operations for relocating LXC (system or
&gt; application) containers. LXC relocation mechanism is done by checkpoint /
&gt; restart. I went over libvirt API documentation and found the following
&gt; methods:
&gt; 
&gt; virDomainSave that receives a domain and path to state file. The method
&gt; saves domain's memory contents into a disk file.
&gt; virDomainRestore that receives a domain and path to state file. The method
&gt; restores the domain from the state file created by save operation.
&gt; 
&gt; Are these the proper methods to use for LXC relocation? I assume I can also
&gt; use the corresponding operations via virsh (save / restore)..
&gt; 
&gt; &gt;From looking into lxcDriver object (defined under /src/lxc/xlc_driver.c in
&gt; libvirt server source) I can see that NULLs are set in save and restore
&gt; methods. Does that mean that there is no support for saving and restoring
&gt; Linux containers? Is there a libvirt patch beyond the kernel patch that
&gt; needs to be applied?

That is correct - the virDomainSave/Restore functions are intended to save
the running guest/container state to a file or load it from a file, 
respectively. These operations have not yet been implemented for libvirt's
LXC driver. I'm not sure how mature the kernel support for container
save/restore is yet, but if it has stabilized sufficiently, then we will
obviously accept patches from anyone wanting to try implementing...

Daniel
-- 
|: Red Hat, Engineering, London   -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org  -o-  http://virt-manager.org  -o-  http://ovirt.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-  F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100203140310</emailId><senderName>Avi Weit</senderName><senderEmail>weit@il.ibm.com</senderEmail><timestampReceived>2010-02-03 14:03:10-0400</timestampReceived><subject>[libvirt-users] [libvirt] [LXC] Tyring to locate livbvirt operations for LXC relocation</subject><body>


Hello,

I am searching for the libvirt operations for relocating LXC (system or
application) containers. LXC relocation mechanism is done by checkpoint /
restart. I went over libvirt API documentation and found the following
methods:

virDomainSave that receives a domain and path to state file. The method
saves domain's memory contents into a disk file.
virDomainRestore that receives a domain and path to state file. The method
restores the domain from the state file created by save operation.

Are these the proper methods to use for LXC relocation? I assume I can also
use the corresponding operations via virsh (save / restore)..

&gt;From looking into lxcDriver object (defined under /src/lxc/xlc_driver.c in
libvirt server source) I can see that NULLs are set in save and restore
methods. Does that mean that there is no support for saving and restoring
Linux containers? Is there a libvirt patch beyond the kernel patch that
needs to be applied?

I am using libvirt 0.7.5 and kernel 2.6.31

/* Function Tables */
static virDriver lxcDriver = {
    VIR_DRV_LXC, /* the number virDrvNo */
    "LXC", /* the name of the driver */
    lxcOpen, /* open */
    lxcClose, /* close */
    NULL, /* supports_feature */
    NULL, /* type */
    lxcVersion, /* version */
    NULL, /* libvirtVersion (impl. in libvirt.c) */
    virGetHostname, /* getHostname */
    NULL, /* getMaxVcpus */
    nodeGetInfo, /* nodeGetInfo */
    lxcGetCapabilities, /* getCapabilities */
    lxcListDomains, /* listDomains */
    lxcNumDomains, /* numOfDomains */
    lxcDomainCreateAndStart, /* domainCreateXML */
    lxcDomainLookupByID, /* domainLookupByID */
    lxcDomainLookupByUUID, /* domainLookupByUUID */
    lxcDomainLookupByName, /* domainLookupByName */
    lxcDomainSuspend, /* domainSuspend */
    lxcDomainResume, /* domainResume */
    lxcDomainShutdown, /* domainShutdown */
    NULL, /* domainSave */
   NULL, /* domainRestore */
   NULL, /* domainMigratePrepare */
   NULL, /* domainMigratePerform */
   NULL, /* domainMigrateFinish */
...
...

Thanks,
- Avi

</body></email><email><emailId>20100203031344</emailId><senderName>Stephen Liu</senderName><senderEmail>satimis@yahoo.com</senderEmail><timestampReceived>2010-02-03 03:13:44-0400</timestampReceived><subject>[libvirt-users] virt-manager can't start</subject><body>

Hi folks,

KVM
Virt-manager
host - Debian 5.0

Starting;

Gnome
Applications -&gt; System Tools - Virtual Machine Manager


popup following error;
Traceback (most recent call last):
  File "/usr/share/virt-manager/virt-manager.py", line 346, in &lt;module&gt;
    main()
  File "/usr/share/virt-manager/virt-manager.py", line 248, in main
    setup_logging()
  File "/usr/share/virt-manager/virt-manager.py", line 124, in setup_logging
    os.mkdir(vm_dir)
OSError: [Errno 17] File exists: '/home/satimis/.virt-manager'
- end -


$ ls -al /home/satimis/ | grep virt-manager
drwxr-xr-x  2 root    root           4096 2009-05-31 06:11 .virt-manager


$ mv /home/satimis/.virt-manager /home/satimis/.virt-manager.old01

Restart
Applications -&gt; System Tools - Virtual Machine Manager

starting GUI virt-manager but without asking for login as root

$ ls -al /home/satimis/ | grep virt-manager
drwxr-xr-x  2 satimis  satimis        4096 2010-01-31 10:00 .virt-manager


If changing the owner by running
$ sudo chown root:root /home/satimis/.virt-manager

GUI virt-manage can't start with abovementioned warning pop.


Please advise how to fix this problem.  I expect with root-password to start GUI 
virt-manager

TIA


B.R.
Stephen L 

Send instant messages to your online friends http://uk.messenger.yahoo.com 
[Attachment #3 (text/html)]

&lt;html&gt;&lt;head&gt;&lt;style type="text/css"&gt;&lt;!-- DIV {margin:0px;} \
--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div \
style="font-family:arial,helvetica,sans-serif;font-size:12pt;color:#000000;"&gt;Hi \
folks,&lt;br&gt; &lt;br&gt;
KVM&lt;br&gt;
Virt-manager&lt;br&gt;
host - Debian 5.0&lt;br&gt;
&lt;br&gt;
Starting;&lt;br&gt;
&lt;br&gt;
Gnome&lt;br&gt;
Applications -&gt; System Tools - Virtual Machine Manager&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
popup following error;&lt;br&gt;
Traceback (most recent call last):&lt;br&gt;
 File "/usr/share/virt-manager/virt-manager.py", line 346, in \
&lt;module&gt;&lt;br&gt;   main()&lt;br&gt;
 File "/usr/share/virt-manager/virt-manager.py", line 248, in main&lt;br&gt;
  setup_logging()&lt;br&gt;
 File "/usr/share/virt-manager/virt-manager.py", line 124, in setup_logging&lt;br&gt;
  os.mkdir(vm_dir)&lt;br&gt;
OSError: [Errno 17] File exists: '/home/satimis/.virt-manager'&lt;br&gt;
- end -&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
$ ls -al /home/satimis/ | grep virt-manager&lt;br&gt;
drwxr-xr-x 2 root  root     \
4096 2009-05-31 06:11 .virt-manager&lt;br&gt; &lt;br&gt;
&lt;br&gt;
$ mv /home/satimis/.virt-manager /home/satimis/.virt-manager.old01&lt;br&gt;
&lt;br&gt;
Restart&lt;br&gt;
Applications -&gt; System Tools - Virtual Machine Manager&lt;br&gt;
&lt;br&gt;
starting GUI virt-manager but without asking for login as root&lt;br&gt;
&lt;br&gt;
$ ls -al /home/satimis/ | grep virt-manager&lt;br&gt;
drwxr-xr-x 2 satimis satimis    4096 2010-01-31 \
10:00 .virt-manager&lt;br&gt; &lt;br&gt;
&lt;br&gt;
If changing the owner by running&lt;br&gt;
$ sudo chown root:root /home/satimis/.virt-manager&lt;br&gt;
&lt;br&gt;
GUI virt-manage can't start with abovementioned warning pop.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Please advise how to fix this problem. I expect with root-password to start GUI \
&lt;br&gt; virt-manager&lt;br&gt;
&lt;br&gt;
TIA&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
B.R.&lt;br&gt;
Stephen L
&lt;!-- cg19.c4.mail.gq1.yahoo.com compressed/chunked Tue Feb  2 19:13:02 PST 2010 --&gt;
&lt;/div&gt;&lt;br&gt;Send instant messages to your online friends http://uk.messenger.yahoo.com \
&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20100211143030</emailId><senderName>Tom Hughes</senderName><senderEmail>tom@compton.nu</senderEmail><timestampReceived>2010-02-11 14:30:30-0400</timestampReceived><subject>[libvirt-users] libvirt attaching wrong usb device?</subject><body>

I'm trying to attach a USB device which is attached to my host to a 
guest instance. The device definition in the XML looks like:

     &lt;hostdev mode='subsystem' type='usb' managed='yes'&gt;
       &lt;source&gt;
         &lt;vendor id='0x046d'/&gt;
         &lt;product id='0xc111'/&gt;
       &lt;/source&gt;
     &lt;/hostdev&gt;

and the device appears in lsusb as USB device 002:018:

   Bus 002 Device 018: ID 046d:c111 Logitech, Inc.

but when I try and start the guest libvirt appears to try and use a 
different device which doesn't exist:

   error: unable to set security context '107:107' on 
'/dev/bus/usb/002/022': No such file or directory

This is using the current libvirt-0.7.6-1.fc12.x86_64 package from the 
F12 virt-preview repository.

Tom

-- 
Tom Hughes (tom@compton.nu)
http://www.compton.nu/

</body></email><email><emailId>20100209221322</emailId><senderName>"antonela_other () yahoo ! com"</senderName><senderEmail>antonela@comcast.net</senderEmail><timestampReceived>2010-02-09 22:13:22-0400</timestampReceived><subject>[libvirt-users] error: unable to connect to libvirtd at 'a.b.c.d': Connection refused</subject><body>

Greetings: 





I have an issue with connecting to the esx hypervisor from my guest Vm. The purpose \
of the connection is to obtain host related information (like network, devices etc). 



I am not sure what is it that rejects the connect at the server side, and what i am \
missing. 

I am running lib0.7.5, i have libvirtd running on guest-vm. 

The host ESX has the ip address a.b.c.d. 



   

Any thoughts? 





   



Below the error with some debug output from libvirt. 







root &gt; virsh -c esx://a.b.c.d/system 





  ...................... 

17:06:16.065: debug : virConnectOpenAuth:1337 : name=esx://10.59.56.109/system, \
auth=0xb80ac638, flags=0 



17:06:16.065: debug : do_open:1106 : name "esx://10.59.56.109/system" to URI \
components: 



   scheme esx 



   opaque (null) 



   authority (null) 



   server 10.59.56.109 



   user (null) 



   port 0 



   path /system 





   

17:06:16.065: debug : do_open:1116 : trying driver 0 (Test) ... 



17:06:16.066: debug : do_open:1122 : driver 0 Test returned DECLINED 



17:06:16.066: debug : do_open:1116 : trying driver 1 (Xen) ... 



17:06:16.066: debug : do_open:1122 : driver 1 Xen returned DECLINED 



17:06:16.066: debug : do_open:1116 : trying driver 2 (OPENVZ) ... 



17:06:16.066: debug : do_open:1122 : driver 2 OPENVZ returned DECLINED 



17:06:16.066: debug : do_open:1116 : trying driver 3 (VBOX) ... 



17:06:16.066: debug : do_open:1122 : driver 3 VBOX returned DECLINED 



17:06:16.066: debug : do_open:1116 : trying driver 4 (remote) ... 



17:06:16.067: debug : doRemoteOpen:564 : proceeding with name = esx:///system 



17:06:16.069: debug : initialise_gnutls:1145 : loading CA file /etc/pki/CA/cacert.pem \




17:06:16.070: debug : initialise_gnutls:1158 : loading client cert and key from files \
/etc/pki/libvirt/clientcert.pem and /etc/pki/libvirt/private/clientkey.pem 



17:06:16.074: debug : do_open:1122 : driver 4 remote returned ERROR 



17:06:16.074: debug : virUnrefConnect:259 : unref connection 0x903e078 1 



17:06:16.074: debug : virReleaseConnect:216 : release connection 0x903e078 



error: unable to connect to libvirtd at a.b.c.d': Connection refused 



error: failed to connect to the hypervisor 







I tried to use uri like: esx://a.b.c.d/, esx://a.b.c.d, esxi://a.b.c.d/system etc. \
They all give same issue. 



Thanks. 



   

Antonela 





  


[Attachment #3 (text/html)]

&lt;html&gt;&lt;head&gt;&lt;style type='text/css'&gt;p { margin: 0; }&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div \
style='font-family: Arial; font-size: 12pt; color: #000000'&gt;&lt;P style="MARGIN: 0in 0in \
0pt" class=MsoNormal&gt;&lt;FONT face=Calibri&gt;Greetings:&lt;/FONT&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in \
0in 0pt" class=MsoNormal&gt;&lt;FONT face=Calibri&gt;&lt;?xml:namespace prefix = o ns = \
"urn:schemas-microsoft-com:office:office" /&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P \
style="MARGIN: 0in 0in 0pt" class=MsoNormal&gt;&lt;FONT face=Calibri&gt;I have an issue with \
connecting to the esx hypervisor from my guest Vm. The purpose of the connection is \
to obtain host related information (like network, devices etc).&lt;/FONT&gt;&lt;/P&gt; &lt;P \
style="MARGIN: 0in 0in 0pt" class=MsoNormal&gt;&lt;FONT face=Calibri&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P \
style="MARGIN: 0in 0in 0pt" class=MsoNormal&gt;&lt;FONT face=Calibri&gt;I am not sure what is \
it that rejects the connect at the server side, and what i am missing. &lt;/FONT&gt;&lt;/P&gt; &lt;P \
style="MARGIN: 0in 0in 0pt" class=MsoNormal&gt;&lt;FONT face=Calibri&gt;I am running lib0.7.5, \
i have libvirtd running on guest-vm.&lt;/FONT&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in 0pt" \
class=MsoNormal&gt;&lt;FONT face=Calibri&gt;The host ESX has the ip address \
a.b.c.d.&lt;/FONT&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in 0pt" class=MsoNormal&gt;&lt;o:p&gt;&lt;FONT \
face=Calibri&gt;&lt;/FONT&gt;&lt;/o:p&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in 0pt" \
class=MsoNormal&gt;&lt;FONT face=Calibri&gt;Any thoughts?&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P \
style="MARGIN: 0in 0in 0pt" class=MsoNormal&gt;&lt;o:p&gt;&lt;FONT \
face=Calibri&gt;&lt;/FONT&gt;&lt;/o:p&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in 0pt" \
class=MsoNormal&gt;&lt;o:p&gt;&lt;FONT face=Calibri&gt;Below the error with some debug output from \
libvirt.&lt;/FONT&gt;&lt;/o:p&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in 0pt" class=MsoNormal&gt;&lt;o:p&gt;&lt;FONT \
face=Calibri&gt;&lt;/FONT&gt;&lt;/o:p&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in 0pt" class=MsoNormal&gt;&lt;FONT \
face=Calibri&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in 0pt" class=MsoNormal&gt;&lt;FONT \
face=Calibri&gt;root &gt; virsh -c esx://a.b.c.d/system&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P \
style="MARGIN: 0in 0in 0pt" class=MsoNormal&gt;&lt;o:p&gt;&lt;FONT \
face=Calibri&gt;......................&lt;/FONT&gt;&lt;/o:p&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in \
0pt" class=MsoNormal&gt;&lt;FONT face=Calibri&gt;17:06:16.065: debug : virConnectOpenAuth:1337 \
: name=esx://10.59.56.109/system, auth=0xb80ac638, flags=0&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P \
style="MARGIN: 0in 0in 0pt" class=MsoNormal&gt;&lt;FONT face=Calibri&gt;17:06:16.065: debug : \
do_open:1106 : name "esx://10.59.56.109/system" to URI \
components:&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in 0pt" \
class=MsoNormal&gt;&lt;FONT face=Calibri&gt;&lt;SPAN style="mso-spacerun: yes"&gt; \
&lt;/SPAN&gt;scheme esx&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in 0pt" \
class=MsoNormal&gt;&lt;FONT face=Calibri&gt;&lt;SPAN style="mso-spacerun: yes"&gt; \
&lt;/SPAN&gt;opaque (null)&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in 0pt" \
class=MsoNormal&gt;&lt;FONT face=Calibri&gt;&lt;SPAN style="mso-spacerun: yes"&gt; \
&lt;/SPAN&gt;authority (null)&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in 0pt" \
class=MsoNormal&gt;&lt;FONT face=Calibri&gt;&lt;SPAN style="mso-spacerun: yes"&gt; \
&lt;/SPAN&gt;server 10.59.56.109&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in 0pt" \
class=MsoNormal&gt;&lt;FONT face=Calibri&gt;&lt;SPAN style="mso-spacerun: yes"&gt; &lt;/SPAN&gt;user \
(null)&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in 0pt" class=MsoNormal&gt;&lt;FONT \
face=Calibri&gt;&lt;SPAN style="mso-spacerun: yes"&gt; &lt;/SPAN&gt;port \
0&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in 0pt" class=MsoNormal&gt;&lt;FONT \
face=Calibri&gt;&lt;SPAN style="mso-spacerun: yes"&gt; &lt;/SPAN&gt;path \
/system&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in 0pt" \
class=MsoNormal&gt;&lt;o:p&gt;&lt;FONT face=Calibri&gt;&lt;/FONT&gt;&lt;/o:p&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in \
0in 0pt" class=MsoNormal&gt;&lt;FONT face=Calibri&gt;17:06:16.065: debug : do_open:1116 : \
trying driver 0 (Test) ...&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in 0pt" \
class=MsoNormal&gt;&lt;FONT face=Calibri&gt;17:06:16.066: debug : do_open:1122 : driver 0 Test \
returned DECLINED&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in 0pt" \
class=MsoNormal&gt;&lt;FONT face=Calibri&gt;17:06:16.066: debug : do_open:1116 : trying driver \
1 (Xen) ...&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in 0pt" \
class=MsoNormal&gt;&lt;FONT face=Calibri&gt;17:06:16.066: debug : do_open:1122 : driver 1 Xen \
returned DECLINED&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in 0pt" \
class=MsoNormal&gt;&lt;FONT face=Calibri&gt;17:06:16.066: debug : do_open:1116 : trying driver \
2 (OPENVZ) ...&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in 0pt" \
class=MsoNormal&gt;&lt;FONT face=Calibri&gt;17:06:16.066: debug : do_open:1122 : driver 2 \
OPENVZ returned DECLINED&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in 0pt" \
class=MsoNormal&gt;&lt;FONT face=Calibri&gt;17:06:16.066: debug : do_open:1116 : trying driver \
3 (VBOX) ...&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in 0pt" \
class=MsoNormal&gt;&lt;FONT face=Calibri&gt;17:06:16.066: debug : do_open:1122 : driver 3 VBOX \
returned DECLINED&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in 0pt" \
class=MsoNormal&gt;&lt;FONT face=Calibri&gt;17:06:16.066: debug : do_open:1116 : trying driver \
4 (remote) ...&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in 0pt" \
class=MsoNormal&gt;&lt;FONT face=Calibri&gt;17:06:16.067: debug : doRemoteOpen:564 : \
proceeding with name = esx:///system&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in \
0pt" class=MsoNormal&gt;&lt;FONT face=Calibri&gt;17:06:16.069: debug : initialise_gnutls:1145 \
: loading CA file /etc/pki/CA/cacert.pem&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in \
0in 0pt" class=MsoNormal&gt;&lt;FONT face=Calibri&gt;17:06:16.070: debug : \
initialise_gnutls:1158 : loading client cert and key from files \
/etc/pki/libvirt/clientcert.pem and \
/etc/pki/libvirt/private/clientkey.pem&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in \
0in 0pt" class=MsoNormal&gt;&lt;FONT face=Calibri&gt;17:06:16.074: debug : do_open:1122 : \
driver 4 remote returned ERROR&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in 0pt" \
class=MsoNormal&gt;&lt;FONT face=Calibri&gt;17:06:16.074: debug : virUnrefConnect:259 : unref \
connection 0x903e078 1&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in 0pt" \
class=MsoNormal&gt;&lt;FONT face=Calibri&gt;17:06:16.074: debug : virReleaseConnect:216 : \
release connection 0x903e078&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in 0pt" \
class=MsoNormal&gt;&lt;SPAN style="COLOR: red"&gt;&lt;FONT face=Calibri&gt;error: unable to connect \
to libvirtd at a.b.c.d': Connection refused&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt; &lt;P \
style="MARGIN: 0in 0in 0pt" class=MsoNormal&gt;&lt;FONT face=Calibri&gt;error: failed to \
connect to the hypervisor&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;I tried to use uri like: &lt;FONT face=Calibri&gt;esx://a.b.c.d/, esx://a.b.c.d, \
esxi://a.b.c.d/system etc. They all give same issue.&lt;/FONT&gt;&lt;/P&gt; &lt;P&gt;&lt;/P&gt;
&lt;P style="MARGIN: 0in 0in 0pt" class=MsoNormal&gt;&lt;FONT face=Calibri&gt;Thanks.&lt;/FONT&gt;&lt;/P&gt;
&lt;P style="MARGIN: 0in 0in 0pt" class=MsoNormal&gt;&lt;o:p&gt;&lt;FONT \
face=Calibri&gt;&lt;/FONT&gt;&lt;/o:p&gt;&lt;/P&gt; &lt;P style="MARGIN: 0in 0in 0pt" \
class=MsoNormal&gt;&lt;FONT face=Calibri&gt;Antonela&lt;o:p&gt;&lt;/o:p&gt;&lt;/FONT&gt;&lt;/P&gt; &lt;P style="MARGIN: \
0in 0in 0pt" class=MsoNormal&gt;&lt;o:p&gt;&lt;FONT \
face=Calibri&gt;&lt;/FONT&gt;&lt;/o:p&gt;&lt;/P&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20100210172602</emailId><senderName>Soeren Grunewald</senderName><senderEmail>soeren.grunewald@avionic-design.de</senderEmail><timestampReceived>2010-02-10 17:26:02-0400</timestampReceived><subject>[libvirt-users] pre/post vm start commands</subject><body>

Hi there,

for development i use a windows vm. which is installed into a disk 
image. because the compiler generates a lot of temporary files into the 
user tempdir (C:\\Documents And Users\\User\\Local Settings\\Temp) the 
vm becomes quite slow after a couple of weeks and i register a lot 
activity on the disk.
so i moved the temp directory to a ram disk and no more problems.

but because the ram disk is not formated on startup i need to do this by 
hand. so i disabled autostart for the vm and do the following:

$ sudo mkfs.ntfs -q -L TEMP -I /dev/ram0
$ sudo virsh start windows

so the question is, does libvirt provide some kind of pre startup script 
which is will be executed before the libvirtd does the autostart for the vm.
-- 
Best Regards
Soeren

</body></email><email><emailId>20100212125130</emailId><senderName>Angel Bosch Mora</senderName><senderEmail>angbosch@conselldemallorca.net</senderEmail><timestampReceived>2010-02-12 12:51:30-0400</timestampReceived><subject>[libvirt-users] virt-manager and openvz</subject><body>

hi,

on main page of libvirt i can see that there's support for OpenVZ.

how can i connect with virt-manager to an OpenVZ machine?

im using virt-manager 0.8.2

Thanks,

angbosch

</body></email><email><emailId>20100214164139</emailId><senderName>monitz</senderName><senderEmail>mmonitz@gmail.com</senderEmail><timestampReceived>2010-02-14 16:41:39-0400</timestampReceived><subject>[libvirt-users] problem with dependencies</subject><body>

hello
i have been having trouble installing libvirt
i installed kvm-kmod on rhel 5.4 kernel 2.6.18 without issues using an rpm
from the redhat website
after installation i tested it by creating an img file with qemu image and
went ahead to install libvirt and libvirt-python for virtmanager
however during installation of libvirt i get the following error:
failed dependencies /usr/bin/qemu-img
since qemu-img is in /usr/local/kvm/bin on my system i tried adding it to
$PATH, symlinking the file and even copying the binery to /usr/bin but to no
use
compilation from source seemed to go fine but after that libvirt-python
could still not find libvirt

is there any solution to this issue? , i would imagine it is a known one

thanks in advance
matan

[Attachment #3 (text/html)]

&lt;div dir="ltr"&gt;hello&lt;br&gt;i have been having trouble installing libvirt &lt;br&gt;i installed \
kvm-kmod on rhel 5.4 kernel 2.6.18 without issues using an rpm from the redhat \
website&lt;br&gt;after installation i tested it by creating an img file with qemu image and \
went ahead to install libvirt and libvirt-python for virtmanager&lt;br&gt;

however during installation of libvirt i get the following error:&lt;br&gt;failed \
dependencies /usr/bin/qemu-img&lt;br&gt;since qemu-img is in /usr/local/kvm/bin on my \
system i tried adding it to $PATH, symlinking the file and even copying the binery to \
/usr/bin but to no use&lt;br&gt;

compilation from source seemed to go fine but after that libvirt-python could still \
not find libvirt&lt;br&gt;&lt;br&gt;is there any solution to this issue? , i would imagine it is \
a known one &lt;br&gt;&lt;br&gt;thanks in advance&lt;br&gt;matan&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20100212143537</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-02-12 14:35:37-0400</timestampReceived><subject>Re: [libvirt-users] virt-manager and openvz</subject><body>

On 02/12/2010 07:51 AM, Angel Bosch Mora wrote:
&gt; hi,
&gt; 
&gt; on main page of libvirt i can see that there's support for OpenVZ.
&gt; 
&gt; how can i connect with virt-manager to an OpenVZ machine?
&gt; 

You'll have to specify the libvirt URI via the virt-manager command line:

virt-manager --connect URI --debug

But I doubt many people have tried using virt-manager with openvz, so
you may hit bugs. I'd be interested in any problems you encounter though.

Thanks,
Cole

</body></email><email><emailId>20100216012707</emailId><senderName>Camilo Aguilar</senderName><senderEmail>camilo@cloudescape.com</senderEmail><timestampReceived>2010-02-16 01:27:07-0400</timestampReceived><subject>[libvirt-users] build libvirt on Mac OSX 10.6</subject><body>

Hi,

Anybody know how to build libvirt on Mac OSX 10.6 ?

[Attachment #3 (text/html)]

Hi,=C2=A0&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Anybody know how to build libvirt on Mac OSX 1=
0.6 ?&lt;/div&gt;


</body></email><email><emailId>20100224011412</emailId><senderName>Jon Masters</senderName><senderEmail>jcm@redhat.com</senderEmail><timestampReceived>2010-02-24 01:14:12-0400</timestampReceived><subject>[libvirt-users] /dev/pts linking option?</subject><body>

Folks,

Does anyone know whether libvirt provides a means for me to guarantee a
persistent link for my guest's virtual serial console? I need to have a
consistent mapping (for example, a symlink that always points to the
correct /dev/pts entry) so I can automate kgdb hookup on boot.

Jon.


</body></email><email><emailId>20100226112614</emailId><senderName>zorgman</senderName><senderEmail>zorg@probesys.com</senderEmail><timestampReceived>2010-02-26 11:26:14-0400</timestampReceived><subject>[libvirt-users] Migration error</subject><body>

Hi,

I'm trying to migrate a VM from one libvirt 0.7.6-1 (qemu-kvm 
0.11.1+dfsg-1) to another libvirt 0.7.6-2 (qemu-kvm 0.11.1+dfsg-1) 
connected with SSH , i have followed pre requite (same shared, same 
path, same network conf ...) . But when i migrate , i have following 
error : operation failed:

/migration to 'tcp:x.x.x.x:49157' failed: migration failed
DETAIL :

Unable to migrate guest:
 Traceback (most recent call last):
  File "/usr/share/virt-manager/virtManager/migrate.py", line 457, in 
_async_migrate
    vm.migrate(dstconn, migrate_uri, rate, live, secure)
  File "/usr/share/virt-manager/virtManager/domain.py", line 1272, in 
migrate
    self._backend.migrate(destconn.vmm, flags, newname, interface, rate)
  File "/usr/lib/python2.5/site-packages/libvirt.py", line 429, in migrate
    if ret is None:raise libvirtError('virDomainMigrate() failed', dom=self)
libvirtError: operation failed: migration to 
'tcp:portable.artis.int:49157' failed: migration failed


/on the destination libvirt i can see in syslog :

/Feb 26 11:16:25 portable libvirtd: 11:16:25.281: error : 
qemudDomainGetInfo:3744 : Domain not found: no domain with matching uuid 
'71c22b3b-4c93-80bd-8387-2b502887c2aa'
Feb 26 11:16:25 portable libvirtd: 11:16:25.283: error : 
qemudDomainGetInfo:3744 : Domain not found: no domain with matching uuid 
'71c22b3b-4c93-80bd-8387-2b502887c2aa'



Feb 26 11:16:25 portable kernel: [ 3022.213730] virbr0: port 1(vnet0) 
entering disabled state
Feb 26 11:16:25 portable kernel: [ 3022.228917] device vnet0 left 
promiscuous mode
Feb 26 11:16:25 portable kernel: [ 3022.228925] virbr0: port 1(vnet0) 
entering disabled state
Feb 26 11:16:25 portable NetworkManager:    SCPlugin-Ifupdown: devices 
removed (path: /sys/devices/virtual/net/vnet0, iface: vnet0)
Feb 26 11:17:01 portable /USR/SBIN/CRON[2606]: (root) CMD (   cd / &amp;&amp; 
run-parts --report /etc/cron.hourly)
Feb 26 11:24:47 portable NetworkManager: &lt;WARN&gt;  nm_signal_handler(): 
Caught signal 15, shutting down normally.
Feb 26 11:24:47 portable NetworkManager: &lt;info&gt;  (wlan0): taking down 
device.
Feb 26 11:24:47 portable NetworkManager: &lt;info&gt;  exiting (success)

/in the destination libvirt vm log i can see the cmd running by migration:

/LC_ALL=C 
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin HOME=/ 
QEMU_AUDIO_DRV=none /usr/bin/kvm -S -M pc-0.11 -enable-kvm -m 256 -smp 1 
-name testmigration -uuid 71c22b3b-4c93-80bd-8387-2b502887c2aa -monitor 
unix:/var/lib/libvirt/qemu/testmigration.monitor,server,nowait -boot c 
-drive file=/mnt/testmigration.img,if=virtio,boot=on,format=qcow2 -drive 
if=ide,media=cdrom,bus=1,unit=0,format=raw -net 
nic,macaddr=52:54:00:7a:a4:98,vlan=0,model=virtio,name=net0 -net 
tap,fd=50,vlan=0,name=hostnet0 -serial pty -parallel none -usb -vnc 
127.0.0.1:0 -k fr -vga cirrus -incoming tcp:0.0.0.0:49156 -balloon virtio/
 


I'm using Debian.

The problem occure online as offline mod.


 


</body></email><email><emailId>20100224074156</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-02-24 07:41:56-0400</timestampReceived><subject>Re: [libvirt-users] /dev/pts linking option?</subject><body>

On Tue, Feb 23, 2010 at 08:14:12PM -0500, Jon Masters wrote:
&gt; Folks,
&gt; 
&gt; Does anyone know whether libvirt provides a means for me to guarantee a
&gt; persistent link for my guest's virtual serial console? I need to have a
&gt; consistent mapping (for example, a symlink that always points to the
&gt; correct /dev/pts entry) so I can automate kgdb hookup on boot.

The /dev/pts path for a guest is always recorded in the XML, so just query
the XML file for it once it is running to discover the allocated path, or 
use the convenient 'virsh ttyconsole' command which prints just the path
immediately.

Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100216113519</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-02-16 11:35:19-0400</timestampReceived><subject>Re: [libvirt-users] build libvirt on Mac OSX 10.6</subject><body>

On Mon, Feb 15, 2010 at 08:27:07PM -0500, Camilo Aguilar wrote:
&gt; Hi,
&gt; 
&gt; Anybody know how to build libvirt on Mac OSX 10.6 ?

Mac OS-X is not a officially supported platform for libvirt, because we
don't have anyone who is able to regularly test it. If someone wants to
volunteer to fix any current problems &amp; do ongoing OS-X testing for new
releases that'd be welcomed....


Regards,
Daniel
-- 
|: Red Hat, Engineering, London   -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org  -o-  http://virt-manager.org  -o-  http://ovirt.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-  F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100216180043</emailId><senderName>jeremy avnet</senderName><senderEmail>brainsik+libvirt@saucelabs.com</senderEmail><timestampReceived>2010-02-16 18:00:43-0400</timestampReceived><subject>Re: [libvirt-users] build libvirt on Mac OSX 10.6</subject><body>

[Attachment #2 (multipart/alternative)]


On Mon, Feb 15, 2010 at 5:27 PM, Camilo Aguilar &lt;camilo@cloudescape.com&gt;wrote:

&gt; Anybody know how to build libvirt on Mac OSX 10.6 ?
&gt;

I've attached a patch and README for building a *client only* version of
libvirt 0.7.6. The patch was made after reading this blog post:

http://www.mattvsworld.com/blog/2010/01/compiling-libvirt-and-ruby-libvirt-on-mac-os-x/

For reference, I'm on Snow Leopard and use MacPorts. I've successfully used
virsh on OS X to connect to a remote libvirtd server.

.:. jeremy avnet / brainsik

[Attachment #5 (text/html)]

&lt;font face="verdana,sans-serif"&gt;&lt;span style="font-family:arial"&gt;On Mon, Feb 15, 2010 \
at 5:27 PM, Camilo Aguilar &lt;span dir="ltr"&gt;&lt;&lt;a \
href="mailto:camilo@cloudescape.com" \
target="_blank"&gt;camilo@cloudescape.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;/span&gt;&lt;br&gt;

&lt;/font&gt;&lt;div class="gmail_quote"&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 \
.8ex;border-left:1px #ccc solid;padding-left:1ex"&gt;&lt;div&gt;Anybody know how to build \
libvirt on Mac OSX 10.6 ?&lt;/div&gt; &lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;I've attached a patch \
and README for building a &lt;i&gt;client only&lt;/i&gt; version of libvirt 0.7.6. The patch was \
made after reading this blog post:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;a \
href="http://www.mattvsworld.com/blog/2010/01/compiling-libvirt-and-ruby-libvirt-on-ma \
c-os-x/"&gt;http://www.mattvsworld.com/blog/2010/01/compiling-libvirt-and-ruby-libvirt-on-mac-os-x/&lt;/a&gt;&lt;/div&gt;
 &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;For reference, I'm on Snow Leopard and use MacPorts. \
I've successfully used virsh on OS X to connect to a remote libvirtd \
server.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;.:. jeremy avnet / brainsik&lt;/div&gt;&lt;div&gt; &lt;br&gt;&lt;/div&gt;

--000325560f9e343dc7047fbb83db--


["libvirt-0.7.6_OSX.patch" (application/octet-stream)]

# HG changeset patch
# User jeremy avnet &lt;brainsik+libvirt@saucelabs.com&gt;
# Date 1265310721 28800
# Node ID 52da2b117343a8f5c8334ba89a815f48cb28de6d
# Parent  06a7ec660037bacdaebb81742f3ff4f93ab67799
Changes to compile the client on OS X.
See http://www.mattvsworld.com/blog/2010/01/compiling-libvirt-and-ruby-libvirt-on-mac-os-x/

diff --git a/src/remote/remote_protocol.c b/src/remote/remote_protocol.c
--- a/src/remote/remote_protocol.c
+++ b/src/remote/remote_protocol.c
@@ -8,6 +8,9 @@
 #include "internal.h"
 #include &lt;arpa/inet.h&gt;
 
+#define xdr_uint32_t xdr_u_int32_t
+#define xdr_uint64_t xdr_u_int64_t
+
 bool_t
 xdr_remote_nonnull_string (XDR *xdrs, remote_nonnull_string *objp)
 {
diff --git a/src/remote/rpcgen_fix.pl b/src/remote/rpcgen_fix.pl
--- a/src/remote/rpcgen_fix.pl
+++ b/src/remote/rpcgen_fix.pl
@@ -29,7 +29,7 @@
     # Portability for Solaris RPC
     s/u_quad_t/uint64_t/g;
     s/quad_t/int64_t/g;
-    s/xdr_u_quad_t/xdr_uint64_t/g;
+    s/xdr_u_quad_t/xdr_u_int64_t/g;
     s/xdr_quad_t/xdr_int64_t/g;
     s/IXDR_GET_LONG/IXDR_GET_INT32/g;
     s,#include "\./remote_protocol\.h",#include "remote_protocol.h",;
diff --git a/src/util/network.c b/src/util/network.c
--- a/src/util/network.c
+++ b/src/util/network.c
@@ -47,7 +47,7 @@
         return(-1);
 
     for (i = 0;i &lt; 8;i++) {
-        (*tab)[i] = ntohs(addr-&gt;inet6.sin6_addr.s6_addr16[i]);
+        (*tab)[i] = ntohs(addr-&gt;inet6.sin6_addr.s6_addr[i]);
     }
 
     return(0);
diff --git a/tools/virsh.c b/tools/virsh.c
--- a/tools/virsh.c
+++ b/tools/virsh.c
@@ -7051,7 +7051,7 @@
         VIR_FREE(command);
         return -1;
     }
-    if (command_ret != WEXITSTATUS (0)) {
+    if (command_ret != 0) {
         vshError(ctl,
                  _("%s: command exited with non-zero status"), command);
         VIR_FREE(command);

["libvirt-0.7.6_OSX.README" (application/octet-stream)]

</body></email><email><emailId>20100211115445</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-02-11 11:54:45-0400</timestampReceived><subject>Re: [libvirt-users] pre/post vm start commands</subject><body>

On Wed, Feb 10, 2010 at 06:26:02PM +0100, Soeren Grunewald wrote:
&gt; Hi there,
&gt; 
&gt; for development i use a windows vm. which is installed into a disk 
&gt; image. because the compiler generates a lot of temporary files into the 
&gt; user tempdir (C:\\Documents And Users\\User\\Local Settings\\Temp) the 
&gt; vm becomes quite slow after a couple of weeks and i register a lot 
&gt; activity on the disk.
&gt; so i moved the temp directory to a ram disk and no more problems.
&gt; 
&gt; but because the ram disk is not formated on startup i need to do this by 
&gt; hand. so i disabled autostart for the vm and do the following:
&gt; 
&gt; $ sudo mkfs.ntfs -q -L TEMP -I /dev/ram0
&gt; $ sudo virsh start windows
&gt; 
&gt; so the question is, does libvirt provide some kind of pre startup script 
&gt; which is will be executed before the libvirtd does the autostart for the vm.

No, there's no explicit hook for that. Given your description of the
setup you have, I'm wondering why you don't just format the NTFS 
partition inside your windows guest as the first step of your build
process, or upon Windows startup. Using Windows' native NTFS formatting
tool rather than the linux mkfs.ntfs reverse engineered one sounds safer
to me anyway

Daniel
-- 
|: Red Hat, Engineering, London   -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org  -o-  http://virt-manager.org  -o-  http://ovirt.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-  F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100211115735</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-02-11 11:57:35-0400</timestampReceived><subject>Re: [libvirt-users] pre/post vm start commands</subject><body>

On Thu, Feb 11, 2010 at 11:54:45AM +0000, Daniel P. Berrange wrote:
&gt; On Wed, Feb 10, 2010 at 06:26:02PM +0100, Soeren Grunewald wrote:
&gt; &gt; Hi there,
&gt; &gt; 
&gt; &gt; for development i use a windows vm. which is installed into a disk 
&gt; &gt; image. because the compiler generates a lot of temporary files into the 
&gt; &gt; user tempdir (C:\\Documents And Users\\User\\Local Settings\\Temp) the 
&gt; &gt; vm becomes quite slow after a couple of weeks and i register a lot 
&gt; &gt; activity on the disk.
&gt; &gt; so i moved the temp directory to a ram disk and no more problems.
&gt; &gt; 
&gt; &gt; but because the ram disk is not formated on startup i need to do this by 
&gt; &gt; hand. so i disabled autostart for the vm and do the following:
&gt; &gt; 
&gt; &gt; $ sudo mkfs.ntfs -q -L TEMP -I /dev/ram0
&gt; &gt; $ sudo virsh start windows
&gt; &gt; 
&gt; &gt; so the question is, does libvirt provide some kind of pre startup script 
&gt; &gt; which is will be executed before the libvirtd does the autostart for the vm.
&gt; 
&gt; No, there's no explicit hook for that. Given your description of the
&gt; setup you have, I'm wondering why you don't just format the NTFS 
&gt; partition inside your windows guest as the first step of your build
&gt; process, or upon Windows startup. Using Windows' native NTFS formatting
&gt; tool rather than the linux mkfs.ntfs reverse engineered one sounds safer
&gt; to me anyway

Oh, or the other option is to just create yourself an initscript in
the host which dos the formatting, and configure it to start before
the libvirtd initscript

Daniel
-- 
|: Red Hat, Engineering, London   -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org  -o-  http://virt-manager.org  -o-  http://ovirt.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-  F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100210095918</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-02-10 09:59:18-0400</timestampReceived><subject>Re: [libvirt-users] error: unable to connect to libvirtd at 'a.b.c.d': Connection refused</subject><body>

2010/2/9 antonela_other@yahoo.com &lt;antonela@comcast.net&gt;:
&gt; Greetings:
&gt;

Hello.

&gt;
&gt; I have an issue with connecting to the esx hypervisor from my guest Vm. The
&gt; purpose of the connection is to obtain host related information (like
&gt; network, devices etc).
&gt;

Unfortunately network and device enumeration is not implemented yet
for the ESX driver.

&gt;
&gt; I am not sure what is it that rejects the connect at the server side, and
&gt; what i am missing.
&gt;
&gt; I am running lib0.7.5, i have libvirtd running on guest-vm.

ESX support was added in 0.7.0, so your libvirt version is new enough.
For ESX you don't need an libvirtd, neither on the client side nor on
the server side, see http://libvirt.org/drvesx.html#prereq

&gt; The host ESX has the ip address a.b.c.d.
&gt;
&gt;
&gt;
&gt; Any thoughts?
&gt;

Are you sure that your libvirt was build with ESX support enabled? If
you're using the Debian/Ubuntu packages that could be your problem,
because they are build without ESX support. So you'll either need to
file a bugreport with Debian/Ubuntu about the excluded ESX support, or
build libvirt from source. If you're already building from source make
sure to install the libcurl development package version 7.18.0 or
newer, otherwise configure will disable ESX support.

&gt;
&gt; Below the error with some debug output from libvirt.
&gt;
&gt;
&gt;
&gt; root &gt; virsh -c esx://a.b.c.d/system
&gt;
&gt;  ......................
&gt;
&gt; 17:06:16.065: debug : virConnectOpenAuth:1337 :
&gt; name=esx://10.59.56.109/system, auth=0xb80ac638, flags=0
&gt;
&gt; 17:06:16.065: debug : do_open:1106 : name "esx://10.59.56.109/system" to URI
&gt; components:
&gt;
&gt;   scheme esx
&gt;
&gt;   opaque (null)
&gt;
&gt;   authority (null)
&gt;
&gt;   server 10.59.56.109
&gt;
&gt;   user (null)
&gt;
&gt;   port 0
&gt;
&gt;   path /system
&gt;
&gt;
&gt;
&gt; 17:06:16.065: debug : do_open:1116 : trying driver 0 (Test) ...
&gt;
&gt; 17:06:16.066: debug : do_open:1122 : driver 0 Test returned DECLINED
&gt;
&gt; 17:06:16.066: debug : do_open:1116 : trying driver 1 (Xen) ...
&gt;
&gt; 17:06:16.066: debug : do_open:1122 : driver 1 Xen returned DECLINED
&gt;
&gt; 17:06:16.066: debug : do_open:1116 : trying driver 2 (OPENVZ) ...
&gt;
&gt; 17:06:16.066: debug : do_open:1122 : driver 2 OPENVZ returned DECLINED
&gt;
&gt; 17:06:16.066: debug : do_open:1116 : trying driver 3 (VBOX) ...
&gt;
&gt; 17:06:16.066: debug : do_open:1122 : driver 3 VBOX returned DECLINED

Yep, your libvirt is build without ESX support. If it is enabled it
would be probed before the remote driver.

&gt; 17:06:16.066: debug : do_open:1116 : trying driver 4 (remote) ...
&gt;
&gt; 17:06:16.067: debug : doRemoteOpen:564 : proceeding with name =
&gt; esx:///system
&gt;
&gt; 17:06:16.069: debug : initialise_gnutls:1145 : loading CA file
&gt; /etc/pki/CA/cacert.pem
&gt;
&gt; 17:06:16.070: debug : initialise_gnutls:1158 : loading client cert and key
&gt; from files /etc/pki/libvirt/clientcert.pem and
&gt; /etc/pki/libvirt/private/clientkey.pem
&gt;
&gt; 17:06:16.074: debug : do_open:1122 : driver 4 remote returned ERROR
&gt;
&gt; 17:06:16.074: debug : virUnrefConnect:259 : unref connection 0x903e078 1
&gt;
&gt; 17:06:16.074: debug : virReleaseConnect:216 : release connection 0x903e078
&gt;
&gt; error: unable to connect to libvirtd at a.b.c.d': Connection refused

The error message could be more explicit about the missing ESX
support, I'll try to improve this.

&gt; error: failed to connect to the hypervisor
&gt;
&gt;
&gt;
&gt;
&gt;
&gt; I tried to use uri like: esx://a.b.c.d/, esx://a.b.c.d,
&gt; esxi://a.b.c.d/system etc. They all give same issue.
&gt;

See http://libvirt.org/drvesx.html#uri for the URI format understood
by the ESX driver, there is no distinction between /system and
/session as with some other drivers.

Matthias

</body></email><email><emailId>20100211193732</emailId><senderName>"antonela_other () yahoo ! com"</senderName><senderEmail>antonela@comcast.net</senderEmail><timestampReceived>2010-02-11 19:37:32-0400</timestampReceived><subject>Re: [libvirt-users] error: unable to connect to libvirtd at 'a.b.c.d': Connection refused</subject><body>

Thank you Matthias. 



I addressed the issues that you mentioned below. 

Now i have my libvirt built for esx. 

I followed the instructions http://libvirt.org/remote.html#Remote_TLS_CA   to \
generate the CA key/cert and client key/cert. 



However, the connect still fails, with "error: internal error curl_easy_perform() \
returned an error: Peer certificate cannot be authenticated with known CA \
certificates (60)". 



Trace is below: 





root # virsh -c esx://a.b.c.d 

14:21:29.771: debug : virInitialize:336 : register drivers 
14:21:29.772: debug : virRegisterDriver:837 : registering Test as driver 0 
14:21:29.772: debug : virRegisterNetworkDriver:675 : registering Test as network \
driver 0  14:21:29.772: debug : virRegisterInterfaceDriver:706 : registering Test as \
interface driver 0  14:21:29.772: debug : virRegisterStorageDriver:737 : registering \
Test as storage driver 0  14:21:29.772: debug : virRegisterDeviceMonitor:768 : \
registering Test as device driver 0  14:21:29.772: debug : \
virRegisterSecretDriver:799 : registering Test as secret driver 0  14:21:29.773: \
debug : virRegisterDriver:837 : registering Xen as driver 1  14:21:29.773: debug : \
virRegisterDriver:837 : registering OPENVZ as driver 2  14:21:29.774: debug : \
vboxRegister:109 : VBoxCGlueInit failed, using dummy driver  14:21:29.774: debug : \
virRegisterDriver:837 : registering VBOX as driver 3  14:21:29.774: debug : \
virRegisterNetworkDriver:675 : registering VBOX as network driver 1  14:21:29.774: \
debug : virRegisterStorageDriver:737 : registering VBOX as storage driver 1  \
14:21:29.774: debug : virRegisterDriver:837 : registering ESX as driver 4  \
14:21:29.775: debug : virRegisterDriver:837 : registering remote as driver 5  \
14:21:29.775: debug : virRegisterNetworkDriver:675 : registering remote as network \
driver 2  14:21:29.775: debug : virRegisterInterfaceDriver:706 : registering remote \
as interface driver 1  14:21:29.775: debug : virRegisterStorageDriver:737 : \
registering remote as storage driver 2  14:21:29.775: debug : \
virRegisterDeviceMonitor:768 : registering remote as device driver 1  14:21:29.775: \
debug : virRegisterSecretDriver:799 : registering remote as secret driver 1  \
14:21:29.775: debug : virConnectOpenAuth:1337 : name=esx://a.b.c.d, auth=0xb7f41678, \
flags=0  14:21:29.776: debug : do_open:1106 : name "esx://a.b.c.d" to URI components: \
  scheme esx 
   opaque (null) 
   authority (null) 
   server  a.b.c.d 
   user (null) 
   port 0 
   path (null) 

14:21:29.776: debug : do_open:1116 : trying driver 0 (Test) ... 
14:21:29.776: debug : do_open:1122 : driver 0 Test returned DECLINED 
14:21:29.776: debug : do_open:1116 : trying driver 1 (Xen) ... 
14:21:29.776: debug : do_open:1122 : driver 1 Xen returned DECLINED 
14:21:29.776: debug : do_open:1116 : trying driver 2 (OPENVZ) ... 
14:21:29.776: debug : do_open:1122 : driver 2 OPENVZ returned DECLINED 
14:21:29.777: debug : do_open:1116 : trying driver 3 (VBOX) ... 
14:21:29.777: debug : do_open:1122 : driver 3 VBOX returned DECLINED 
14:21:29.777: debug : do_open:1116 : trying driver 4 (ESX) ... 
Enter username for a.b.c.d [root]: 
Enter root password for a.b.c.d: 
14:21:33.416: debug : do_open:1122 : driver 4 ESX returned ERROR 
14:21:33.416: debug : virUnrefConnect:259 : unref connection 0x931f698 1 
14:21:33.417: debug : virReleaseConnect:216 : release connection 0x931f698 
error: internal error curl_easy_perform() returned an error: Peer certificate cannot \
                be authenticated with known CA certificates (60) 
error: failed to connect to the hypervisor 




BTW, I observed that any modification to the /etc/libvirt/libvirt.conf does not take \
effect when. Isn't this the default conf file for libvirt/virsh? The changes i am \
talking about are: 

-  for default path for the CA key/cert and clinet key/cert 

- uncommented #tls_no_verify_certificate = 1 


# ls /etc/pki/CA/ 
cacert.pem   cakey.pem 
# ls /etc/pki/libvirt/ 
clientcert.pem   private 
# ls /etc/pki/libvirt/private/ 
clientkey.pem 


Thank you in advance for any comments/suggestions. 



Antonela 


----- Original Message ----- 
From: "Matthias Bolte" &lt;matthias.bolte@googlemail.com&gt; 
To: "antonela_other@yahoo.com" &lt;antonela@comcast.net&gt; 
Cc: libvirt-users@redhat.com 
Sent: Wednesday, February 10, 2010 4:59:18 AM GMT -05:00 US/Canada Eastern 
Subject: Re: [libvirt-users] error: unable to connect to libvirtd at   'a.b.c.d': \
Connection refused 

2010/2/9 antonela_other@yahoo.com &lt;antonela@comcast.net&gt;: 
&gt; Greetings: 
&gt; 

Hello. 

&gt; 
&gt; I have an issue with connecting to the esx hypervisor from my guest Vm. The 
&gt; purpose of the connection is to obtain host related information (like 
&gt; network, devices etc). 
&gt; 

Unfortunately network and device enumeration is not implemented yet 
for the ESX driver. 

&gt; 
&gt; I am not sure what is it that rejects the connect at the server side, and 
&gt; what i am missing. 
&gt; 
&gt; I am running lib0.7.5, i have libvirtd running on guest-vm. 

ESX support was added in 0.7.0, so your libvirt version is new enough. 
For ESX you don't need an libvirtd, neither on the client side nor on 
the server side, see http://libvirt.org/drvesx.html#prereq 

&gt; The host ESX has the ip address a.b.c.d. 
&gt; 
&gt; 
&gt; 
&gt; Any thoughts? 
&gt; 

Are you sure that your libvirt was build with ESX support enabled? If 
you're using the Debian/Ubuntu packages that could be your problem, 
because they are build without ESX support. So you'll either need to 
file a bugreport with Debian/Ubuntu about the excluded ESX support, or 
build libvirt from source. If you're already building from source make 
sure to install the libcurl development package version 7.18.0 or 
newer, otherwise configure will disable ESX support. 

&gt; 
&gt; Below the error with some debug output from libvirt. 
&gt; 
&gt; 
&gt; 
&gt; root &gt; virsh -c esx://a.b.c.d/system 
&gt; 
&gt; ...................... 
&gt; 
&gt; 17:06:16.065: debug : virConnectOpenAuth:1337 : 
&gt; name=esx://10.59.56.109/system, auth=0xb80ac638, flags=0 
&gt; 
&gt; 17:06:16.065: debug : do_open:1106 : name "esx://10.59.56.109/system" to URI 
&gt; components: 
&gt; 
&gt; scheme esx 
&gt; 
&gt; opaque (null) 
&gt; 
&gt; authority (null) 
&gt; 
&gt; server 10.59.56.109 
&gt; 
&gt; user (null) 
&gt; 
&gt; port 0 
&gt; 
&gt; path /system 
&gt; 
&gt; 
&gt; 
&gt; 17:06:16.065: debug : do_open:1116 : trying driver 0 (Test) ... 
&gt; 
&gt; 17:06:16.066: debug : do_open:1122 : driver 0 Test returned DECLINED 
&gt; 
&gt; 17:06:16.066: debug : do_open:1116 : trying driver 1 (Xen) ... 
&gt; 
&gt; 17:06:16.066: debug : do_open:1122 : driver 1 Xen returned DECLINED 
&gt; 
&gt; 17:06:16.066: debug : do_open:1116 : trying driver 2 (OPENVZ) ... 
&gt; 
&gt; 17:06:16.066: debug : do_open:1122 : driver 2 OPENVZ returned DECLINED 
&gt; 
&gt; 17:06:16.066: debug : do_open:1116 : trying driver 3 (VBOX) ... 
&gt; 
&gt; 17:06:16.066: debug : do_open:1122 : driver 3 VBOX returned DECLINED 

Yep, your libvirt is build without ESX support. If it is enabled it 
would be probed before the remote driver. 

&gt; 17:06:16.066: debug : do_open:1116 : trying driver 4 (remote) ... 
&gt; 
&gt; 17:06:16.067: debug : doRemoteOpen:564 : proceeding with name = 
&gt; esx:///system 
&gt; 
&gt; 17:06:16.069: debug : initialise_gnutls:1145 : loading CA file 
&gt; /etc/pki/CA/cacert.pem 
&gt; 
&gt; 17:06:16.070: debug : initialise_gnutls:1158 : loading client cert and key 
&gt; from files /etc/pki/libvirt/clientcert.pem and 
&gt; /etc/pki/libvirt/private/clientkey.pem 
&gt; 
&gt; 17:06:16.074: debug : do_open:1122 : driver 4 remote returned ERROR 
&gt; 
&gt; 17:06:16.074: debug : virUnrefConnect:259 : unref connection 0x903e078 1 
&gt; 
&gt; 17:06:16.074: debug : virReleaseConnect:216 : release connection 0x903e078 
&gt; 
&gt; error: unable to connect to libvirtd at a.b.c.d': Connection refused 

The error message could be more explicit about the missing ESX 
support, I'll try to improve this. 

&gt; error: failed to connect to the hypervisor 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; I tried to use uri like: esx://a.b.c.d/, esx://a.b.c.d, 
&gt; esxi://a.b.c.d/system etc. They all give same issue. 
&gt; 

See http://libvirt.org/drvesx.html#uri for the URI format understood 
by the ESX driver, there is no distinction between /system and 
/session as with some other drivers. 

Matthias 


[Attachment #3 (text/html)]

&lt;html&gt;&lt;head&gt;&lt;style type='text/css'&gt;p { margin: 0; }&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div \
style='font-family: Arial; font-size: 12pt; color: #000000'&gt;&lt;P&gt;Thank you \
Matthias.&lt;/P&gt; &lt;P&gt;&lt;/P&gt;
&lt;P&gt;I addressed the issues that you mentioned below. &lt;/P&gt;
&lt;P&gt;Now i have my libvirt built for esx.&lt;/P&gt;
&lt;P&gt;I followed the instructions &lt;A \
href="http://libvirt.org/remote.html#Remote_TLS_CA"&gt;http://libvirt.org/remote.html#Remote_TLS_CA&lt;/A&gt;to \
generate the CA key/cert and client key/cert.&lt;/P&gt; &lt;P&gt;&lt;/P&gt;
&lt;P&gt;However, the connect still fails, with "error: internal error curl_easy_perform() \
returned an error: Peer certificate cannot be authenticated with known CA \
certificates (60)".&lt;/P&gt; &lt;P&gt;&lt;/P&gt;
&lt;P&gt;Trace is below:&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;A href="mailto:root@u904-110:~/testLibVirt/example"&gt;root&lt;/A&gt;# &lt;STRONG&gt;virsh -c \
esx://a.b.c.d&lt;/STRONG&gt;&lt;/P&gt; &lt;P&gt;14:21:29.771: debug : virInitialize:336 : register \
drivers&lt;BR&gt;14:21:29.772: debug : virRegisterDriver:837 : registering Test as driver \
0&lt;BR&gt;14:21:29.772: debug : virRegisterNetworkDriver:675 : registering Test as network \
driver 0&lt;BR&gt;14:21:29.772: debug : virRegisterInterfaceDriver:706 : registering Test \
as interface driver 0&lt;BR&gt;14:21:29.772: debug : virRegisterStorageDriver:737 : \
registering Test as storage driver 0&lt;BR&gt;14:21:29.772: debug : \
virRegisterDeviceMonitor:768 : registering Test as device driver 0&lt;BR&gt;14:21:29.772: \
debug : virRegisterSecretDriver:799 : registering Test as secret driver \
0&lt;BR&gt;14:21:29.773: debug : virRegisterDriver:837 : registering Xen as driver \
1&lt;BR&gt;14:21:29.773: debug : virRegisterDriver:837 : registering OPENVZ as driver \
2&lt;BR&gt;14:21:29.774: debug : vboxRegister:109 : VBoxCGlueInit failed, using dummy \
driver&lt;BR&gt;14:21:29.774: debug : virRegisterDriver:837 : registering VBOX as driver \
3&lt;BR&gt;14:21:29.774: debug : virRegisterNetworkDriver:675 : registering VBOX as network \
driver 1&lt;BR&gt;14:21:29.774: debug : virRegisterStorageDriver:737 : registering VBOX as \
storage driver 1&lt;BR&gt;14:21:29.774: debug : virRegisterDriver:837 : registering ESX as \
driver 4&lt;BR&gt;14:21:29.775: debug : virRegisterDriver:837 : registering remote as \
driver 5&lt;BR&gt;14:21:29.775: debug : virRegisterNetworkDriver:675 : registering remote \
as network driver 2&lt;BR&gt;14:21:29.775: debug : virRegisterInterfaceDriver:706 : \
registering remote as interface driver 1&lt;BR&gt;14:21:29.775: debug : \
virRegisterStorageDriver:737 : registering remote as storage driver \
2&lt;BR&gt;14:21:29.775: debug : virRegisterDeviceMonitor:768 : registering remote as \
device driver 1&lt;BR&gt;14:21:29.775: debug : virRegisterSecretDriver:799 : registering \
remote as secret driver 1&lt;BR&gt;14:21:29.775: debug : virConnectOpenAuth:1337 : \
name=esx://a.b.c.d, auth=0xb7f41678, flags=0&lt;BR&gt;14:21:29.776: debug : do_open:1106 : \
name "esx://a.b.c.d" to URI components:&lt;BR&gt; scheme esx&lt;BR&gt; opaque \
(null)&lt;BR&gt; authority (null)&lt;BR&gt; servera.b.c.d&lt;BR&gt; user \
(null)&lt;BR&gt; port 0&lt;BR&gt; path (null)&lt;/P&gt; &lt;P&gt;14:21:29.776: debug : \
do_open:1116 : trying driver 0 (Test) ...&lt;BR&gt;14:21:29.776: debug : do_open:1122 : \
driver 0 Test returned DECLINED&lt;BR&gt;14:21:29.776: debug : do_open:1116 : trying driver \
1 (Xen) ...&lt;BR&gt;14:21:29.776: debug : do_open:1122 : driver 1 Xen returned \
DECLINED&lt;BR&gt;14:21:29.776: debug : do_open:1116 : trying driver 2 (OPENVZ) \
...&lt;BR&gt;14:21:29.776: debug : do_open:1122 : driver 2 OPENVZ returned \
DECLINED&lt;BR&gt;14:21:29.777: debug : do_open:1116 : trying driver 3 (VBOX) \
...&lt;BR&gt;14:21:29.777: debug : do_open:1122 : driver 3 VBOX returned \
DECLINED&lt;BR&gt;14:21:29.777: debug : do_open:1116 : trying driver 4 (ESX) ...&lt;BR&gt;Enter \
username for a.b.c.d [root]:&lt;BR&gt;Enter root password for a.b.c.d:&lt;BR&gt;14:21:33.416: \
debug : do_open:1122 : driver 4 ESX returned ERROR&lt;BR&gt;14:21:33.416: debug : \
virUnrefConnect:259 : unref connection 0x931f698 1&lt;BR&gt;14:21:33.417: debug : \
virReleaseConnect:216 : release connection 0x931f698&lt;BR&gt;error: internal error \
curl_easy_perform() returned an error: Peer certificate cannot be authenticated with \
known CA certificates (60)&lt;BR&gt;error: failed to connect to the hypervisor&lt;BR&gt;&lt;/P&gt; \
&lt;P&gt;&lt;/P&gt; &lt;P&gt;BTW, I observed that any modification to the \
/etc/libvirt/libvirt.conf does not take effect when. Isn't this the default conf file \
for libvirt/virsh? The changes i am talking about are:&lt;/P&gt; &lt;P&gt;-for default path \
for the CA key/cert and clinet key/cert &lt;/P&gt; &lt;P&gt;- uncommented \
#tls_no_verify_certificate = 1&lt;BR&gt;&lt;/P&gt; &lt;P&gt;# ls /etc/pki/CA/&lt;BR&gt;cacert.pem \
cakey.pem&lt;BR&gt;# ls /etc/pki/libvirt/&lt;BR&gt;clientcert.pem private&lt;BR&gt;# ls \
/etc/pki/libvirt/private/&lt;BR&gt;clientkey.pem&lt;BR&gt;&lt;/P&gt; &lt;P&gt;Thank you in advance for any \
comments/suggestions.&lt;/P&gt; &lt;P&gt;&lt;/P&gt;
&lt;P&gt;Antonela&lt;/P&gt;
&lt;P&gt;&lt;BR&gt;----- Original Message -----&lt;BR&gt;From: "Matthias Bolte" \
&lt;matthias.bolte@googlemail.com&gt;&lt;BR&gt;To: "antonela_other@yahoo.com" \
&lt;antonela@comcast.net&gt;&lt;BR&gt;Cc: libvirt-users@redhat.com&lt;BR&gt;Sent: Wednesday, \
February 10, 2010 4:59:18 AM GMT -05:00 US/Canada Eastern&lt;BR&gt;Subject: Re: \
[libvirt-users] error: unable to connect to libvirtd at 'a.b.c.d': Connection \
refused&lt;BR&gt;&lt;BR&gt;2010/2/9 antonela_other@yahoo.com \
&lt;antonela@comcast.net&gt;:&lt;BR&gt;&gt; \
Greetings:&lt;BR&gt;&gt;&lt;BR&gt;&lt;BR&gt;Hello.&lt;BR&gt;&lt;BR&gt;&gt;&lt;BR&gt;&gt; I have an issue with connecting \
to the esx hypervisor from my guest Vm. The&lt;BR&gt;&gt; purpose of the connection is to \
obtain host related information (like&lt;BR&gt;&gt; network, devices \
etc).&lt;BR&gt;&gt;&lt;BR&gt;&lt;BR&gt;Unfortunately network and device enumeration is not implemented \
yet&lt;BR&gt;for the ESX driver.&lt;BR&gt;&lt;BR&gt;&gt;&lt;BR&gt;&gt; I am not sure what is it that rejects \
the connect at the server side, and&lt;BR&gt;&gt; what i am missing.&lt;BR&gt;&gt;&lt;BR&gt;&gt; I am \
running lib0.7.5, i have libvirtd running on guest-vm.&lt;BR&gt;&lt;BR&gt;ESX support was added \
in 0.7.0, so your libvirt version is new enough.&lt;BR&gt;For ESX you don't need an \
libvirtd, neither on the client side nor on&lt;BR&gt;the server side, see \
http://libvirt.org/drvesx.html#prereq&lt;BR&gt;&lt;BR&gt;&gt; The host ESX has the ip address \
a.b.c.d.&lt;BR&gt;&gt;&lt;BR&gt;&gt;&lt;BR&gt;&gt;&lt;BR&gt;&gt; Any thoughts?&lt;BR&gt;&gt;&lt;BR&gt;&lt;BR&gt;Are you sure \
that your libvirt was build with ESX support enabled? If&lt;BR&gt;you're using the \
Debian/Ubuntu packages that could be your problem,&lt;BR&gt;because they are build without \
ESX support. So you'll either need to&lt;BR&gt;file a bugreport with Debian/Ubuntu about \
the excluded ESX support, or&lt;BR&gt;build libvirt from source. If you're already building \
from source make&lt;BR&gt;sure to install the libcurl development package version 7.18.0 \
or&lt;BR&gt;newer, otherwise configure will disable ESX support.&lt;BR&gt;&lt;BR&gt;&gt;&lt;BR&gt;&gt; Below \
the error with some debug output from libvirt.&lt;BR&gt;&gt;&lt;BR&gt;&gt;&lt;BR&gt;&gt;&lt;BR&gt;&gt; root \
&gt; virsh -c esx://a.b.c.d/system&lt;BR&gt;&gt;&lt;BR&gt;&gt; \
......................&lt;BR&gt;&gt;&lt;BR&gt;&gt; 17:06:16.065: debug : \
virConnectOpenAuth:1337 :&lt;BR&gt;&gt; name=esx://10.59.56.109/system, auth=0xb80ac638, \
flags=0&lt;BR&gt;&gt;&lt;BR&gt;&gt; 17:06:16.065: debug : do_open:1106 : name \
"esx://10.59.56.109/system" to URI&lt;BR&gt;&gt; components:&lt;BR&gt;&gt;&lt;BR&gt;&gt;  scheme \
esx&lt;BR&gt;&gt;&lt;BR&gt;&gt;  opaque (null)&lt;BR&gt;&gt;&lt;BR&gt;&gt;  authority \
(null)&lt;BR&gt;&gt;&lt;BR&gt;&gt;  server 10.59.56.109&lt;BR&gt;&gt;&lt;BR&gt;&gt;  user \
(null)&lt;BR&gt;&gt;&lt;BR&gt;&gt;  port 0&lt;BR&gt;&gt;&lt;BR&gt;&gt;  path \
/system&lt;BR&gt;&gt;&lt;BR&gt;&gt;&lt;BR&gt;&gt;&lt;BR&gt;&gt; 17:06:16.065: debug : do_open:1116 : trying \
driver 0 (Test) ...&lt;BR&gt;&gt;&lt;BR&gt;&gt; 17:06:16.066: debug : do_open:1122 : driver 0 \
Test returned DECLINED&lt;BR&gt;&gt;&lt;BR&gt;&gt; 17:06:16.066: debug : do_open:1116 : trying \
driver 1 (Xen) ...&lt;BR&gt;&gt;&lt;BR&gt;&gt; 17:06:16.066: debug : do_open:1122 : driver 1 Xen \
returned DECLINED&lt;BR&gt;&gt;&lt;BR&gt;&gt; 17:06:16.066: debug : do_open:1116 : trying driver \
2 (OPENVZ) ...&lt;BR&gt;&gt;&lt;BR&gt;&gt; 17:06:16.066: debug : do_open:1122 : driver 2 OPENVZ \
returned DECLINED&lt;BR&gt;&gt;&lt;BR&gt;&gt; 17:06:16.066: debug : do_open:1116 : trying driver \
3 (VBOX) ...&lt;BR&gt;&gt;&lt;BR&gt;&gt; 17:06:16.066: debug : do_open:1122 : driver 3 VBOX \
returned DECLINED&lt;BR&gt;&lt;BR&gt;Yep, your libvirt is build without ESX support. If it is \
enabled it&lt;BR&gt;would be probed before the remote driver.&lt;BR&gt;&lt;BR&gt;&gt; 17:06:16.066: \
debug : do_open:1116 : trying driver 4 (remote) ...&lt;BR&gt;&gt;&lt;BR&gt;&gt; 17:06:16.067: \
debug : doRemoteOpen:564 : proceeding with name =&lt;BR&gt;&gt; \
esx:///system&lt;BR&gt;&gt;&lt;BR&gt;&gt; 17:06:16.069: debug : initialise_gnutls:1145 : loading \
CA file&lt;BR&gt;&gt; /etc/pki/CA/cacert.pem&lt;BR&gt;&gt;&lt;BR&gt;&gt; 17:06:16.070: debug : \
initialise_gnutls:1158 : loading client cert and key&lt;BR&gt;&gt; from files \
/etc/pki/libvirt/clientcert.pem and&lt;BR&gt;&gt; \
/etc/pki/libvirt/private/clientkey.pem&lt;BR&gt;&gt;&lt;BR&gt;&gt; 17:06:16.074: debug : \
do_open:1122 : driver 4 remote returned ERROR&lt;BR&gt;&gt;&lt;BR&gt;&gt; 17:06:16.074: debug : \
virUnrefConnect:259 : unref connection 0x903e078 1&lt;BR&gt;&gt;&lt;BR&gt;&gt; 17:06:16.074: \
debug : virReleaseConnect:216 : release connection 0x903e078&lt;BR&gt;&gt;&lt;BR&gt;&gt; error: \
unable to connect to libvirtd at a.b.c.d': Connection refused&lt;BR&gt;&lt;BR&gt;The error \
message could be more explicit about the missing ESX&lt;BR&gt;support, I'll try to improve \
this.&lt;BR&gt;&lt;BR&gt;&gt; error: failed to connect to the \
hypervisor&lt;BR&gt;&gt;&lt;BR&gt;&gt;&lt;BR&gt;&gt;&lt;BR&gt;&gt;&lt;BR&gt;&gt;&lt;BR&gt;&gt; I tried to use uri like: \
esx://a.b.c.d/, esx://a.b.c.d,&lt;BR&gt;&gt; esxi://a.b.c.d/system etc. They all give same \
issue.&lt;BR&gt;&gt;&lt;BR&gt;&lt;BR&gt;See http://libvirt.org/drvesx.html#uri for the URI format \
understood&lt;BR&gt;by the ESX driver, there is no distinction between /system \
and&lt;BR&gt;/session as with some other \
drivers.&lt;BR&gt;&lt;BR&gt;Matthias&lt;BR&gt;&lt;/P&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20100203151146</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-02-03 15:11:46-0400</timestampReceived><subject>Re: [libvirt-users] virt-manager can't start</subject><body>

On 02/02/2010 10:13 PM, Stephen Liu wrote:
&gt; Hi folks,
&gt; 
&gt; KVM
&gt; Virt-manager
&gt; host - Debian 5.0
&gt; 
&gt; Starting;
&gt; 
&gt; Gnome
&gt; Applications -&gt; System Tools - Virtual Machine Manager
&gt; 
&gt; 
&gt; popup following error;
&gt; Traceback (most recent call last):
&gt;   File "/usr/share/virt-manager/virt-manager.py", line 346, in &lt;module&gt;
&gt;     main()
&gt;   File "/usr/share/virt-manager/virt-manager.py", line 248, in main
&gt;     setup_logging()
&gt;   File "/usr/share/virt-manager/virt-manager.py", line 124, in setup_logging
&gt;     os.mkdir(vm_dir)
&gt; OSError: [Errno 17] File exists: '/home/satimis/.virt-manager'
&gt; - end -
&gt; 
&gt; 
&gt; $ ls -al /home/satimis/ | grep virt-manager
&gt; drwxr-xr-x  2 root    root           4096 2009-05-31 06:11 .virt-manager
&gt; 
&gt; 
&gt; $ mv /home/satimis/.virt-manager /home/satimis/.virt-manager.old01
&gt; 
&gt; Restart
&gt; Applications -&gt; System Tools - Virtual Machine Manager
&gt; 
&gt; starting GUI virt-manager but without asking for login as root
&gt; 
&gt; $ ls -al /home/satimis/ | grep virt-manager
&gt; drwxr-xr-x  2 satimis  satimis        4096 2010-01-31 10:00 .virt-manager
&gt; 
&gt; 
&gt; If changing the owner by running
&gt; $ sudo chown root:root /home/satimis/.virt-manager
&gt; 
&gt; GUI virt-manage can't start with abovementioned warning pop.
&gt; 
&gt; 
&gt; Please advise how to fix this problem.  I expect with root-password to
&gt; start GUI
&gt; virt-manager

You shouldn't be changing the ownership of the .virt-manager directory. If
running virt-manager and connecting to qemu:///system, a policykit dialog will
appear asking for root (on fedora at least), however the app will still be
running as a regular user.

If you want to run the app as root, use sudo or su. Other then that I'm not
sure what you are asking or why you are trying to change the directory
permissions.

FYI, I've improved error reporting in this area upstream now, so it will give
an explicit permission error rather than just blindly try to recreate the
directory:

http://hg.fedorahosted.org/hg/virt-manager/rev/96cd3bb0cdc0

</body></email><email><emailId>20100204022325</emailId><senderName>Stephen Liu</senderName><senderEmail>satimis@yahoo.com</senderEmail><timestampReceived>2010-02-04 02:23:25-0400</timestampReceived><subject>Re: [libvirt-users] virt-manager can't start</subject><body>

From: Cole Robinson &lt;crobinso@redhat.com&gt;
To: Stephen Liu &lt;satimis@yahoo.com&gt;
Cc: libvirt-users@redhat.com
Sent: Wed, February 3, 2010 11:11:46 PM
Subject: Re: [libvirt-users] virt-manager can't start


- snip -

&gt; You shouldn't be changing the ownership of the .virt-manager directory. If
&gt; running virt-manager and connecting to qemu:///system, a policykit dialog will
&gt; appear asking for root (on fedora at least), however the app will still be
&gt; running as a regular user.


Hi Cole,

Host - Debian 5.0
KVM
Libvert


This Virtual Machine has been running sometimes.


Before, on Gnome desktop

Applications - Sytem Tools -&gt; Virtual Machine Manager
starts;
Autheticate
System Policy prevents management of local virtualized systems
.....

After entering root password -&gt; Authenticate
starts "Virtual Machine Manager"


For unknown cause/incident ;
On Gnome desktop;

Applications - Sytem Tools -&gt; Virtual Machine Manager

popup following error
&gt; popup following error;
&gt; Traceback (most recent call last):
&gt; File "/usr/share/virt-manager/virt-manager.py", line 346, in &lt;module&gt;
&gt; main()
&gt; File "/usr/share/virt-manager/virt-manager.py", line 248, in main
&gt; setup_logging()
&gt; File "/usr/share/virt-manager/virt-manager.py", line 124, in setup_logging
&gt; os.mkdir(vm_dir)
&gt; OSError: [Errno 17] File exists: '/home/satimis/.virt-manager'
&gt; - end -


Then I ran "apt-get remove libvert" to remove it.  And reinstalled it later.

However

Applications - System Tools -&gt; Virtual Machine Manager
starts "Virtual Machine Manager" without asking for root password to authenticate

$ ls -al /home/satimis/ | grep virt-manager
drwxr-xr-x  2 satimis  satimis      4096 2009-05-31 06:11 .virt-manager

If I change its owner to "root  root" it popup above warning.  I can't start "Virtual \
Machine Manager".


How can I restore its original state requesting root password for authentication \
before starting "Virtual Machine Manager"?  TIA


B.R.
Stephen

Send instant messages to your online friends http://uk.messenger.yahoo.com 


[Attachment #3 (text/html)]

&lt;html&gt;&lt;head&gt;&lt;style type="text/css"&gt;&lt;!-- DIV {margin:0px;} \
--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div \
style="font-family:arial,helvetica,sans-serif;font-size:12pt"&gt;&lt;div \
style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"&gt;&lt;b&gt;&lt;span \
style="font-weight: bold;"&gt;From:&lt;/span&gt;&lt;/b&gt; Cole Robinson \
&lt;crobinso@redhat.com&gt;&lt;b&gt;&lt;span style="font-weight: bold;"&gt;&lt;br&gt;To:&lt;/span&gt;&lt;/b&gt; \
Stephen Liu &lt;satimis@yahoo.com&gt;&lt;b&gt;&lt;span style="font-weight: \
bold;"&gt;&lt;br&gt;Cc:&lt;/span&gt;&lt;/b&gt; libvirt-users@redhat.com&lt;b&gt;&lt;span style="font-weight: \
bold;"&gt;&lt;br&gt;Sent:&lt;/span&gt;&lt;/b&gt; Wed, February 3, 2010 11:11:46 PM&lt;b&gt;&lt;span \
style="font-weight: bold;"&gt;&lt;br&gt;Subject:&lt;/span&gt;&lt;/b&gt; Re: [libvirt-users] virt-manager \
can't start&lt;br&gt;&lt;div style="font-family: arial,helvetica,sans-serif; font-size: \
13px;"&gt;&lt;br&gt;- snip -&lt;br&gt;&lt;br&gt;&gt; You shouldn't be changing the ownership of the \
.virt-manager directory. If&lt;br&gt;&gt; running virt-manager and connecting to \
qemu:///system, a policykit dialog will&lt;br&gt;&gt; appear asking for  root (on fedora at \
least), however the app will still be&lt;br&gt;&gt; running as a regular \
user.&lt;br&gt;&lt;br&gt;&lt;br&gt;Hi Cole,&lt;br&gt;&lt;br&gt;Host - Debian 5.0&lt;br&gt;KVM&lt;br&gt;Libvert&lt;br&gt;&lt;br&gt;&lt;br&gt;This \
Virtual Machine has been running sometimes.&lt;br&gt;&lt;br&gt;&lt;br&gt;Before, on Gnome \
desktop&lt;br&gt;&lt;br&gt;Applications - Sytem Tools -&gt; Virtual Machine \
Manager&lt;br&gt;starts;&lt;br&gt;Autheticate&lt;br&gt;System Policy prevents management of local \
virtualized systems&lt;br&gt;.....&lt;br&gt;&lt;br&gt;After entering root password -&gt; \
Authenticate&lt;br&gt;starts "Virtual Machine Manager"&lt;br&gt;&lt;br&gt;&lt;br&gt;For unknown \
cause/incident ;&lt;br&gt;On Gnome desktop;&lt;br&gt;&lt;br&gt;Applications - Sytem Tools -&gt; Virtual \
Machine Manager&lt;br&gt;&lt;br&gt;popup following error&lt;br&gt;&gt; popup following error;&lt;br&gt;&gt; \
Traceback (most recent call last):&lt;br&gt;&gt; File \
"/usr/share/virt-manager/virt-manager.py", line 346, in \
&lt;module&gt;&lt;br&gt;&gt; main()&lt;br&gt;&gt; File \
"/usr/share/virt-manager/virt-manager.py", line 248, in \
main&lt;br&gt;&gt;  setup_logging()&lt;br&gt;&gt; File \
"/usr/share/virt-manager/virt-manager.py", line 124, in \
setup_logging&lt;br&gt;&gt; os.mkdir(vm_dir)&lt;br&gt;&gt; OSError: [Errno 17] \
File exists: '/home/satimis/.virt-manager'&lt;br&gt;&gt; - end -&lt;br&gt;&lt;br&gt;&lt;br&gt;Then I ran \
"apt-get remove libvert" to remove it. And reinstalled it \
later.&lt;br&gt;&lt;br&gt;However&lt;br&gt;&lt;br&gt;Applications - System Tools -&gt; Virtual Machine \
Manager&lt;br&gt;starts "Virtual Machine Manager" without asking for root password to \
authenticate&lt;br&gt;&lt;br&gt;$ ls -al /home/satimis/ | grep virt-manager&lt;br&gt;drwxr-xr-x 2 \
satimis satimis 4096 2009-05-31 06:11 \
.virt-manager&lt;br&gt;&lt;br&gt;If I change its owner to "root root" it popup above \
warning. I can't start "Virtual Machine Manager".&lt;br&gt;&lt;br&gt;&lt;br&gt;How can I restore \
its original state requesting root password for authentication before starting \
"Virtual Machine Manager"?  \
TIA&lt;br&gt;&lt;br&gt;&lt;br&gt;B.R.&lt;br&gt;Stephen&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt; &lt;!-- \
cg26.c4.mail.gq1.yahoo.com compressed/chunked Wed Feb  3 08:12:54 PST 2010 --&gt; \
&lt;/div&gt;&lt;br&gt;Send instant messages to your online friends http://uk.messenger.yahoo.com \
&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20100204134517</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-02-04 13:45:17-0400</timestampReceived><subject>Re: [libvirt-users] virt-manager can't start</subject><body>

On 02/03/2010 09:23 PM, Stephen Liu wrote:
&gt; *From:* Cole Robinson &lt;crobinso@redhat.com&gt;*
&gt; To:* Stephen Liu &lt;satimis@yahoo.com&gt;*
&gt; Cc:* libvirt-users@redhat.com*
&gt; Sent:* Wed, February 3, 2010 11:11:46 PM*
&gt; Subject:* Re: [libvirt-users] virt-manager can't start
&gt; 
&gt; - snip -
&gt; 
&gt;&gt; You shouldn't be changing the ownership of the .virt-manager directory. If
&gt;&gt; running virt-manager and connecting to qemu:///system, a policykit
&gt; dialog will
&gt;&gt; appear asking for root (on fedora at least), however the app will still be
&gt;&gt; running as a regular user.
&gt; 
&gt; 
&gt; Hi Cole,
&gt; 
&gt; Host - Debian 5.0
&gt; KVM
&gt; Libvert
&gt; 
&gt; 
&gt; This Virtual Machine has been running sometimes.
&gt; 
&gt; 
&gt; Before, on Gnome desktop
&gt; 
&gt; Applications - Sytem Tools -&gt; Virtual Machine Manager
&gt; starts;
&gt; Autheticate
&gt; System Policy prevents management of local virtualized systems
&gt; .....
&gt; 
&gt; After entering root password -&gt; Authenticate
&gt; starts "Virtual Machine Manager"
&gt; 
&gt; 
&gt; For unknown cause/incident ;
&gt; On Gnome desktop;
&gt; 
&gt; Applications - Sytem Tools -&gt; Virtual Machine Manager
&gt; 
&gt; popup following error
&gt;&gt; popup following error;
&gt;&gt; Traceback (most recent call last):
&gt;&gt;  File "/usr/share/virt-manager/virt-manager.py", line 346, in &lt;module&gt;
&gt;&gt;    main()
&gt;&gt;  File "/usr/share/virt-manager/virt-manager.py", line 248, in main
&gt;&gt;    setup_logging()
&gt;&gt;  File "/usr/share/virt-manager/virt-manager.py", line 124, in
&gt; setup_logging
&gt;&gt;    os.mkdir(vm_dir)
&gt;&gt; OSError: [Errno 17] File exists: '/home/satimis/.virt-manager'
&gt;&gt; - end -
&gt; 
&gt; 
&gt; Then I ran "apt-get remove libvert" to remove it.  And reinstalled it later.
&gt; 
&gt; However
&gt; 
&gt; Applications - System Tools -&gt; Virtual Machine Manager
&gt; starts "Virtual Machine Manager" without asking for root password to
&gt; authenticate
&gt; 
&gt; $ ls -al /home/satimis/ | grep virt-manager
&gt; drwxr-xr-x  2 satimis  satimis      4096 2009-05-31 06:11 .virt-manager
&gt; 
&gt; If I change its owner to "root  root" it popup above warning.  I can't
&gt; start "Virtual Machine Manager".
&gt; 
&gt; 
&gt; How can I restore its original state requesting root password for
&gt; authentication before starting "Virtual Machine Manager"?  TIA
&gt; 

Firstly, delete ~/.virt-manager, and let the app create it with correct
permissions. Second, make sure libvirtd is installed and running. Finally,
when virt-manager is running, make sure it is connecting to the qemu:///system
connection: there should be a row name 'qemu' in the main window, right click
-&gt; connect. This should ask for the root password.

If the qemu row isn't there for some reason, you can use File-&gt;Open Connection
to connect.

- Cole

</body></email><email><emailId>20100204165437</emailId><senderName>Stephen Liu</senderName><senderEmail>satimis@yahoo.com</senderEmail><timestampReceived>2010-02-04 16:54:37-0400</timestampReceived><subject>Re: [libvirt-users] virt-manager can't start</subject><body>

________________________________
From: Cole Robinson &lt;crobinso@redhat.com&gt;
To: Stephen Liu &lt;satimis@yahoo.com&gt;
Cc: libvirt-users@redhat.com
Sent: Thu, February 4, 2010 5:45:17 AM
Subject: Re: [libvirt-users] virt-manager can't start


Host - Debian 5.0

 - snip -

&gt;  Firstly, delete ~/.virt-manager, and let the app create it with correct
&gt;  permissions. Second, make sure libvirtd is installed and running. Finally,
&gt;  when virt-manager is running, make sure it is connecting to the qemu:///system
&gt;  connection: there should be a row name 'qemu' in the main window, right click
&gt;  -&gt; connect. This should ask for the root password.

&gt; If the qemu row isn't there for some reason, you can use File-&gt;Open Connection
&gt; to connect.

$ rm -rf .virt-manager

Gnome
Applications -&gt; System Tools -&gt; Virtual Machine Manager

qemu is not there instead "localhost" displayed.  Clicking it drops down all VMs

Virtual Machine Manager
File -&gt; No "Open Connect".  Only "Add Connection"


$ apt-cache policy libvirt
W: Unable to locate package libvirt

$ apt-cache policy libvirtd
W: Unable to locate package libvirtd


$ apt-cache search libvirtd
No printout

$ apt-cache search libvirt
collectd - statistics collection and monitoring daemon
libvirt-bin - the programs for the libvirt library
libvirt-dev - development files for the libvirt library
libvirt-doc - documentation for the libvirt library
libvirt0-dbg - library for interfacing with different virtualization systems
libvirt0 - library for interfacing with different virtualization systems
python-libvirt - libvirt Python bindings
libvirt-ocaml-dev - OCaml bindings for libvirt
libvirt-ocaml - OCaml bindings for libvirt
munin-libvirt-plugins - Munin plugins using libvirt
virtinst - Programs to create and clone virtual machines

$ apt-cache policy libvirt0
libvirt0:
  Installed: 0.4.6-10
  Candidate: 0.4.6-10
  Version table:
     0.6.5-3~bpo50+1 0
          1 http://www.backports.org lenny-backports/main Packages
 *** 0.4.6-10 0
        500 http://ftp.hk.debian.org lenny/main Packages
        100 /var/lib/dpkg/status

libvirtd NOT found


B.R.
satimis

Send instant messages to your online friends http://uk.messenger.yahoo.com 
[Attachment #3 (text/html)]

&lt;html&gt;&lt;head&gt;&lt;style type="text/css"&gt;&lt;!-- DIV {margin:0px;} \
--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div \
style="font-family:arial,helvetica,sans-serif;font-size:12pt"&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"&gt;&lt;br&gt;&lt;div \
style="font-family: arial,helvetica,sans-serif; font-size: 13px;"&gt;&lt;font size="2" \
face="Tahoma"&gt;&lt;hr size="1"&gt;&lt;b&gt;&lt;span style="font-weight: bold;"&gt;From:&lt;/span&gt;&lt;/b&gt; Cole \
Robinson &lt;crobinso@redhat.com&gt;&lt;br&gt;&lt;b&gt;&lt;span style="font-weight: \
bold;"&gt;To:&lt;/span&gt;&lt;/b&gt; Stephen Liu &lt;satimis@yahoo.com&gt;&lt;br&gt;&lt;b&gt;&lt;span \
style="font-weight: bold;"&gt;Cc:&lt;/span&gt;&lt;/b&gt; libvirt-users@redhat.com&lt;br&gt;&lt;b&gt;&lt;span \
style="font-weight: bold;"&gt;Sent:&lt;/span&gt;&lt;/b&gt; Thu, February 4, 2010 5:45:17 \
AM&lt;br&gt;&lt;b&gt;&lt;span style="font-weight: bold;"&gt;Subject:&lt;/span&gt;&lt;/b&gt; Re: [libvirt-users] \
virt-manager can't start&lt;br&gt;&lt;/font&gt;&lt;br&gt;&lt;br&gt;Host - Debian 5.0&lt;br&gt;&lt;br&gt;- snip \
-&lt;br&gt;&lt;br&gt;&gt; Firstly, delete ~/.virt-manager, and let the app create it with  \
correct&lt;br&gt;&gt; permissions. Second, make sure libvirtd is installed and \
running. Finally,&lt;br&gt;&gt; when virt-manager is running, make sure it is \
connecting to the qemu:///system&lt;br&gt;&gt; connection: there should be a row name \
'qemu' in the main window, right click&lt;br&gt;&gt; -&gt; connect. This should ask \
for the root password.&lt;br&gt;&lt;br&gt;&gt; If the qemu row isn't there for some reason, you \
can use File-&gt;Open Connection&lt;br&gt;&gt; to connect.&lt;br&gt;&lt;br&gt;$ rm -rf \
.virt-manager&lt;br&gt;&lt;br&gt;Gnome&lt;br&gt;Applications -&gt; System Tools -&gt; Virtual Machine \
Manager&lt;br&gt;&lt;br&gt;qemu is not there instead "localhost" displayed. Clicking it \
drops down all VMs&lt;br&gt;&lt;br&gt;Virtual Machine Manager&lt;br&gt;File -&gt; No "Open \
Connect". Only "Add Connection"&lt;br&gt;&lt;br&gt;&lt;br&gt;$ apt-cache policy libvirt&lt;br&gt;W: \
Unable to locate package libvirt&lt;br&gt;&lt;br&gt;$ apt-cache policy libvirtd&lt;br&gt;W: Unable to \
locate package libvirtd&lt;br&gt;&lt;br&gt;&lt;br&gt;$ apt-cache search libvirtd&lt;br&gt;No  \
printout&lt;br&gt;&lt;br&gt;$ apt-cache search libvirt&lt;br&gt;collectd - statistics collection and \
monitoring daemon&lt;br&gt;libvirt-bin - the programs for the libvirt \
library&lt;br&gt;libvirt-dev - development files for the libvirt library&lt;br&gt;libvirt-doc - \
documentation for the libvirt library&lt;br&gt;libvirt0-dbg - library for interfacing with \
different virtualization systems&lt;br&gt;libvirt0 - library for interfacing with different \
virtualization systems&lt;br&gt;python-libvirt - libvirt Python \
bindings&lt;br&gt;libvirt-ocaml-dev - OCaml bindings for libvirt&lt;br&gt;libvirt-ocaml - OCaml \
bindings for libvirt&lt;br&gt;munin-libvirt-plugins - Munin plugins using \
libvirt&lt;br&gt;virtinst - Programs to create and clone virtual machines&lt;br&gt;&lt;br&gt;$ \
apt-cache policy libvirt0&lt;br&gt;libvirt0:&lt;br&gt; Installed: 0.4.6-10&lt;br&gt; \
Candidate: 0.4.6-10&lt;br&gt; Version table:&lt;br&gt; \
0.6.5-3~bpo50+1 0&lt;br&gt;&lt;span&gt; 1 \
&lt;a target="_blank"  href="http://www.backports.org"&gt;http://www.backports.org&lt;/a&gt; \
lenny-backports/main Packages&lt;/span&gt;&lt;br&gt;*** 0.4.6-10 \
0&lt;br&gt;&lt;span&gt; 500 &lt;a target="_blank" \
href="http://ftp.hk.debian.org"&gt;http://ftp.hk.debian.org&lt;/a&gt; lenny/main \
Packages&lt;/span&gt;&lt;br&gt; 100 \
/var/lib/dpkg/status&lt;br&gt;&lt;br&gt;libvirtd NOT \
found&lt;br&gt;&lt;br&gt;&lt;br&gt;B.R.&lt;br&gt;satimis&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt; \
&lt;!-- cg16.c4.mail.gq1.yahoo.com compressed/chunked Thu Feb  4 08:34:19 PST 2010 --&gt; \
&lt;/div&gt;&lt;br&gt;Send instant messages to your online friends http://uk.messenger.yahoo.com \
&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20100204182528</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-02-04 18:25:28-0400</timestampReceived><subject>Re: [libvirt-users] virt-manager can't start</subject><body>

On 02/04/2010 11:54 AM, Stephen Liu wrote:
&gt; 
&gt; 
&gt; ------------------------------------------------------------------------
&gt; *From:* Cole Robinson &lt;crobinso@redhat.com&gt;
&gt; *To:* Stephen Liu &lt;satimis@yahoo.com&gt;
&gt; *Cc:* libvirt-users@redhat.com
&gt; *Sent:* Thu, February 4, 2010 5:45:17 AM
&gt; *Subject:* Re: [libvirt-users] virt-manager can't start
&gt; 
&gt; 
&gt; Host - Debian 5.0
&gt; 
&gt;  - snip -
&gt; 
&gt;&gt;  Firstly, delete ~/.virt-manager, and let the app create it with correct
&gt;&gt;  permissions. Second, make sure libvirtd is installed and running.
&gt; Finally,
&gt;&gt;  when virt-manager is running, make sure it is connecting to the
&gt; qemu:///system
&gt;&gt;  connection: there should be a row name 'qemu' in the main window,
&gt; right click
&gt;&gt;  -&gt; connect. This should ask for the root password.
&gt; 
&gt;&gt; If the qemu row isn't there for some reason, you can use File-&gt;Open
&gt; Connection
&gt;&gt; to connect.
&gt; 
&gt; $ rm -rf .virt-manager
&gt; 
&gt; Gnome
&gt; Applications -&gt; System Tools -&gt; Virtual Machine Manager
&gt; 
&gt; qemu is not there instead "localhost" displayed.  Clicking it drops down
&gt; all VMs
&gt; 

Yeah, that's the row I mean. If it opens and shows VMs, sounds like that is
what you want. It might not be asking for root passwd twice because it is
caching the auth credentials: depends on what policykit version is installed.

virt-manager only asks for the root passwd to connect to the libvirt qemu
driver: sounds like it is doing that, so not sure if there is something else
you want.

&gt; Virtual Machine Manager
&gt; File -&gt; No "Open Connect".  Only "Add Connection"
&gt; 

Add connection is what I mean, sorry.

&gt; 
&gt; $ apt-cache policy libvirt
&gt; W: Unable to locate package libvirt
&gt; 
&gt; $ apt-cache policy libvirtd
&gt; W: Unable to locate package libvirtd
&gt; 
&gt; 
&gt; $ apt-cache search libvirtd
&gt; No printout
&gt; 
&gt; $ apt-cache search libvirt
&gt; collectd - statistics collection and monitoring daemon
&gt; libvirt-bin - the programs for the libvirt library
&gt; libvirt-dev - development files for the libvirt library
&gt; libvirt-doc - documentation for the libvirt library
&gt; libvirt0-dbg - library for interfacing with different virtualization systems
&gt; libvirt0 - library for interfacing with different virtualization systems
&gt; python-libvirt - libvirt Python bindings
&gt; libvirt-ocaml-dev - OCaml bindings for libvirt
&gt; libvirt-ocaml - OCaml bindings for libvirt
&gt; munin-libvirt-plugins - Munin plugins using libvirt
&gt; virtinst - Programs to create and clone virtual machines
&gt; 
&gt; $ apt-cache policy libvirt0
&gt; libvirt0:
&gt;   Installed: 0.4.6-10
&gt;   Candidate: 0.4.6-10
&gt;   Version table:
&gt;      0.6.5-3~bpo50+1 0
&gt;           1 http://www.backports.org lenny-backports/main Packages
&gt;  *** 0.4.6-10 0
&gt;         500 http://ftp.hk.debian.org lenny/main Packages
&gt;         100 /var/lib/dpkg/status
&gt; 
&gt; libvirtd NOT found
&gt;

Sorry, I don't know what package libvirtd is in on debian based systems.

- Cole

</body></email><email><emailId>20100205041926</emailId><senderName>Stephen Liu</senderName><senderEmail>satimis@yahoo.com</senderEmail><timestampReceived>2010-02-05 04:19:26-0400</timestampReceived><subject>Re: [libvirt-users] virt-manager can't start</subject><body>

From: Cole Robinson &lt;crobinso@redhat.com&gt;

To: Stephen Liu &lt;satimis@yahoo.com&gt;
Cc: libvirt-users@redhat.com
Sent: Thu, February 4, 2010 10:25:28 AM
Subject: Re: [libvirt-users] virt-manager can't start

- snip -

&gt; Yeah, that's the row I mean. If it opens and shows VMs, sounds like that is
&gt; what you want. It might not be asking for root passwd twice because it is
&gt; caching the auth credentials: depends on what policykit version is installed.

&gt; virt-manager only asks for the root passwd to connect to the libvirt qemu
&gt; driver: sounds like it is doing that, so not sure if there is something else
&gt; you want.

Hi Cole,


I have 2 Virtual Machines here, both running KVM as virtualizer.


Virtual Machine-1
Host - Fedora 12
KVM
libvirt


Vitural Machine-2
Host - Debian 5.0
KVM
libvirt


Previously on Genom desktop of both machines 
Applications -&gt; System Tools -&gt; Virtual Machine Manager

starts 2 windows:-

Virtual Machine Manager
Name
localhost (QEMU) - connecting

and
Authenticate
Password for root

After entering root password -&gt; Authenticate

changes;

Virtual Machine Manager
Name
localhost (QEMU)
vm01
vm02
vm03
....


For unknown accident/cause Virtual Machine-2 (Debian 5.0) changes;

Applications -&gt; System Tools -&gt; Virtual Machine Manager

starts only 1 window, without Authenticate window asking for root password.

Virtual Machine Manager
Name
localhost
vm01
vm02
vm03
....


I don't know why?  How can I change it back to its original state?

TIA


B.R.
Stephen

Send instant messages to your online friends http://uk.messenger.yahoo.com 
[Attachment #3 (text/html)]

&lt;html&gt;&lt;head&gt;&lt;style type="text/css"&gt;&lt;!-- DIV {margin:0px;} \
--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div \
style="font-family:arial,helvetica,sans-serif;font-size:12pt"&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div \
style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"&gt;&lt;b&gt;&lt;span \
style="font-weight: bold;"&gt;From:&lt;/span&gt;&lt;/b&gt; Cole Robinson \
&lt;crobinso@redhat.com&gt;&lt;br&gt;&lt;div style="font-family: arial,helvetica,sans-serif; \
font-size: 13px;"&gt;&lt;font size="2" face="Tahoma"&gt;&lt;b&gt;&lt;span style="font-weight: \
bold;"&gt;To:&lt;/span&gt;&lt;/b&gt; Stephen Liu &lt;satimis@yahoo.com&gt;&lt;br&gt;&lt;b&gt;&lt;span \
style="font-weight: bold;"&gt;Cc:&lt;/span&gt;&lt;/b&gt; libvirt-users@redhat.com&lt;br&gt;&lt;b&gt;&lt;span \
style="font-weight: bold;"&gt;Sent:&lt;/span&gt;&lt;/b&gt; Thu, February 4, 2010 10:25:28 \
AM&lt;br&gt;&lt;b&gt;&lt;span style="font-weight: bold;"&gt;Subject:&lt;/span&gt;&lt;/b&gt; Re: [libvirt-users] \
virt-manager can't start&lt;br&gt;&lt;/font&gt;&lt;br&gt;- snip -&lt;br&gt;&lt;br&gt;&gt; Yeah, that's the row I \
mean. If it opens and shows VMs, sounds like that is&lt;br&gt;&gt; what you want. It might \
not be asking for root passwd  twice because it is&lt;br&gt;&gt; caching the auth \
credentials: depends on what policykit version is installed.&lt;br&gt;&lt;br&gt;&gt; virt-manager \
only asks for the root passwd to connect to the libvirt qemu&lt;br&gt;&gt; driver: sounds \
like it is doing that, so not sure if there is something else&lt;br&gt;&gt; you \
want.&lt;br&gt;&lt;br&gt;Hi Cole,&lt;br&gt;&lt;br&gt;&lt;br&gt;I have 2 Virtual Machines here, both running KVM as \
virtualizer.&lt;br&gt;&lt;br&gt;&lt;br&gt;Virtual Machine-1&lt;br&gt;Host - Fedora \
12&lt;br&gt;KVM&lt;br&gt;libvirt&lt;br&gt;&lt;br&gt;&lt;br&gt;Vitural Machine-2&lt;br&gt;Host - Debian \
5.0&lt;br&gt;KVM&lt;br&gt;libvirt&lt;br&gt;&lt;br&gt;&lt;br&gt;Previously on Genom desktop of both machines \
&lt;br&gt;Applications -&gt; System Tools -&gt; Virtual Machine Manager&lt;br&gt;&lt;br&gt;starts 2 \
windows:-&lt;br&gt;&lt;br&gt;Virtual Machine Manager&lt;br&gt;Name&lt;br&gt;localhost (QEMU) - \
connecting&lt;br&gt;&lt;br&gt;and&lt;br&gt;Authenticate&lt;br&gt;Password for root&lt;br&gt;&lt;br&gt;After entering root \
password -&gt; Authenticate&lt;br&gt;&lt;br&gt;changes;&lt;br&gt;&lt;br&gt;Virtual Machine \
Manager&lt;br&gt;Name&lt;br&gt;localhost (QEMU)&lt;br&gt;vm01&lt;br&gt;vm02&lt;br&gt;vm03&lt;br&gt;....&lt;br&gt;&lt;br&gt;&lt;br&gt;For  \
unknown accident/cause Virtual Machine-2 (Debian 5.0) changes;&lt;br&gt;&lt;br&gt;Applications \
-&gt; System Tools -&gt; Virtual Machine Manager&lt;br&gt;&lt;br&gt;starts only 1 window, without \
Authenticate window asking for root password.&lt;br&gt;&lt;br&gt;Virtual Machine \
Manager&lt;br&gt;Name&lt;br&gt;localhost&lt;br&gt;vm01&lt;br&gt;vm02&lt;br&gt;vm03&lt;br&gt;....&lt;br&gt;&lt;br&gt;&lt;br&gt;I don't know \
why? How can I change it back to its original \
state?&lt;br&gt;&lt;br&gt;TIA&lt;br&gt;&lt;br&gt;&lt;br&gt;B.R.&lt;br&gt;Stephen&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt; &lt;!-- \
cg5.c4.mail.gq1.yahoo.com compressed/chunked Thu Feb  4 19:04:02 PST 2010 --&gt; \
&lt;/div&gt;&lt;br&gt;Send instant messages to your online friends http://uk.messenger.yahoo.com \
&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20100205135401</emailId><senderName>Cole Robinson</senderName><senderEmail>crobinso@redhat.com</senderEmail><timestampReceived>2010-02-05 13:54:01-0400</timestampReceived><subject>Re: [libvirt-users] virt-manager can't start</subject><body>

On 02/04/2010 11:19 PM, Stephen Liu wrote:
&gt; 
&gt; *From:* Cole Robinson &lt;crobinso@redhat.com&gt;
&gt; *To:* Stephen Liu &lt;satimis@yahoo.com&gt;
&gt; *Cc:* libvirt-users@redhat.com
&gt; *Sent:* Thu, February 4, 2010 10:25:28 AM
&gt; *Subject:* Re: [libvirt-users] virt-manager can't start
&gt; 
&gt; - snip -
&gt; 
&gt;&gt; Yeah, that's the row I mean. If it opens and shows VMs, sounds like
&gt; that is
&gt;&gt; what you want. It might not be asking for root passwd twice because it is
&gt;&gt; caching the auth credentials: depends on what policykit version is
&gt; installed.
&gt; 
&gt;&gt; virt-manager only asks for the root passwd to connect to the libvirt qemu
&gt;&gt; driver: sounds like it is doing that, so not sure if there is
&gt; something else
&gt;&gt; you want.
&gt; 
&gt; Hi Cole,
&gt; 
&gt; 
&gt; I have 2 Virtual Machines here, both running KVM as virtualizer.
&gt; 
&gt; 
&gt; Virtual Machine-1
&gt; Host - Fedora 12
&gt; KVM
&gt; libvirt
&gt; 
&gt; 
&gt; Vitural Machine-2
&gt; Host - Debian 5.0
&gt; KVM
&gt; libvirt
&gt; 
&gt; 
&gt; Previously on Genom desktop of both machines
&gt; Applications -&gt; System Tools -&gt; Virtual Machine Manager
&gt; 
&gt; starts 2 windows:-
&gt; 
&gt; Virtual Machine Manager
&gt; Name
&gt; localhost (QEMU) - connecting
&gt; 
&gt; and
&gt; Authenticate
&gt; Password for root
&gt; 
&gt; After entering root password -&gt; Authenticate
&gt; 
&gt; changes;
&gt; 
&gt; Virtual Machine Manager
&gt; Name
&gt; localhost (QEMU)
&gt; vm01
&gt; vm02
&gt; vm03
&gt; ....
&gt; 
&gt; 
&gt; For unknown accident/cause Virtual Machine-2 (Debian 5.0) changes;
&gt; 
&gt; Applications -&gt; System Tools -&gt; Virtual Machine Manager
&gt; 
&gt; starts only 1 window, without Authenticate window asking for root password.
&gt; 
&gt; Virtual Machine Manager
&gt; Name
&gt; localhost
&gt; vm01
&gt; vm02
&gt; vm03
&gt; ....
&gt; 
&gt; 
&gt; I don't know why?  How can I change it back to its original state?
&gt; 

I don't know why either, sorry. Maybe your root password credentials have been
cached, so it isn't asking anymore. If you log out or reboot the box, does
virt-manager ask for the password the next time you run it?

If that doesn't work, I would recommend filing a bug with debian.

- Cole

</body></email><email><emailId>20100211144106</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-02-11 14:41:06-0400</timestampReceived><subject>Re: [libvirt-users] libvirt attaching wrong usb device?</subject><body>

On Thu, Feb 11, 2010 at 02:30:30PM +0000, Tom Hughes wrote:
&gt; I'm trying to attach a USB device which is attached to my host to a 
&gt; guest instance. The device definition in the XML looks like:
&gt; 
&gt;     &lt;hostdev mode='subsystem' type='usb' managed='yes'&gt;
&gt;       &lt;source&gt;
&gt;         &lt;vendor id='0x046d'/&gt;
&gt;         &lt;product id='0xc111'/&gt;
&gt;       &lt;/source&gt;
&gt;     &lt;/hostdev&gt;
&gt; 
&gt; and the device appears in lsusb as USB device 002:018:
&gt; 
&gt;   Bus 002 Device 018: ID 046d:c111 Logitech, Inc.
&gt; 
&gt; but when I try and start the guest libvirt appears to try and use a 
&gt; different device which doesn't exist:
&gt; 
&gt;   error: unable to set security context '107:107' on 
&gt; '/dev/bus/usb/002/022': No such file or directory
&gt; 
&gt; This is using the current libvirt-0.7.6-1.fc12.x86_64 package from the 
&gt; F12 virt-preview repository.

This is a mixup of decimal/octal - I've just posted a patch for it

http://www.redhat.com/archives/libvir-list/2010-February/msg00377.html


Daniel
-- 
|: Red Hat, Engineering, London   -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org  -o-  http://virt-manager.org  -o-  http://ovirt.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-  F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100212001709</emailId><senderName>Matthias Bolte</senderName><senderEmail>matthias.bolte@googlemail.com</senderEmail><timestampReceived>2010-02-12 00:17:09-0400</timestampReceived><subject>Re: [libvirt-users] error: unable to connect to libvirtd at 'a.b.c.d': Connection refused</subject><body>

2010/2/11 antonela_other@yahoo.com &lt;antonela@comcast.net&gt;:
&gt; Thank you Matthias.
&gt;
&gt;
&gt;
&gt; I addressed the issues that you mentioned below.
&gt;
&gt; Now i have my libvirt built for esx.
&gt;
&gt; I followed the instructions http://libvirt.org/remote.html#Remote_TLS_CA  to
&gt; generate the CA key/cert and client key/cert.
&gt;
&gt;
&gt;
&gt; However, the connect still fails, with "error: internal error
&gt; curl_easy_perform() returned an error: Peer certificate cannot be
&gt; authenticated with known CA certificates (60)".
&gt;

This has nothing to to with the  libvirtd certificates. The ESX
support doesn't involve libvirtd.

This error should tell you that libcurl can't verify the ESX server
side SSL certificate used for HTTPS. The simple solution is to disable
the server certificate verification

virsh -c esx://a.b.c.d/?no_verify=1

See http://www.redhat.com/archives/libvir-list/2009-December/msg00757.html
for some details. I'll add a FAQ section to
http://www.libvirt.org/drvesx.html about this basic connection issues,
because several people seem to hit this problems when trying to use
libvirt with ESX.

Matthias

</body></email><email><emailId>20100212191921</emailId><senderName>Soeren Grunewald</senderName><senderEmail>soeren.grunewald@avionic-design.de</senderEmail><timestampReceived>2010-02-12 19:19:21-0400</timestampReceived><subject>Re: [libvirt-users] pre/post vm start commands</subject><body>

ok, thx
i'm afraid thats truly the best way to do it...for me
--
Thx again
Soeren

On 11.02.2010 12:57, Daniel P. Berrange wrote:
&gt; On Thu, Feb 11, 2010 at 11:54:45AM +0000, Daniel P. Berrange wrote:
&gt;&gt; On Wed, Feb 10, 2010 at 06:26:02PM +0100, Soeren Grunewald wrote:
&gt;&gt;&gt; Hi there,
&gt;&gt;&gt;
&gt;&gt;&gt; for development i use a windows vm. which is installed into a disk
&gt;&gt;&gt; image. because the compiler generates a lot of temporary files into the
&gt;&gt;&gt; user tempdir (C:\\Documents And Users\\User\\Local Settings\\Temp) the
&gt;&gt;&gt; vm becomes quite slow after a couple of weeks and i register a lot
&gt;&gt;&gt; activity on the disk.
&gt;&gt;&gt; so i moved the temp directory to a ram disk and no more problems.
&gt;&gt;&gt;
&gt;&gt;&gt; but because the ram disk is not formated on startup i need to do this by
&gt;&gt;&gt; hand. so i disabled autostart for the vm and do the following:
&gt;&gt;&gt;
&gt;&gt;&gt; $ sudo mkfs.ntfs -q -L TEMP -I /dev/ram0
&gt;&gt;&gt; $ sudo virsh start windows
&gt;&gt;&gt;
&gt;&gt;&gt; so the question is, does libvirt provide some kind of pre startup script
&gt;&gt;&gt; which is will be executed before the libvirtd does the autostart for the vm.
&gt;&gt;
&gt;&gt; No, there's no explicit hook for that. Given your description of the
&gt;&gt; setup you have, I'm wondering why you don't just format the NTFS
&gt;&gt; partition inside your windows guest as the first step of your build
&gt;&gt; process, or upon Windows startup. Using Windows' native NTFS formatting
&gt;&gt; tool rather than the linux mkfs.ntfs reverse engineered one sounds safer
&gt;&gt; to me anyway
&gt;
&gt; Oh, or the other option is to just create yourself an initscript in
&gt; the host which dos the formatting, and configure it to start before
&gt; the libvirtd initscript
&gt;
&gt; Daniel

</body></email><email><emailId>20100215075439</emailId><senderName>Angel Bosch Mora</senderName><senderEmail>angbosch@conselldemallorca.net</senderEmail><timestampReceived>2010-02-15 07:54:39-0400</timestampReceived><subject>Re: [libvirt-users] virt-manager and openvz</subject><body>

----- "Cole Robinson" &lt;crobinso@redhat.com&gt; ha escrit:

&gt; On 02/12/2010 07:51 AM, Angel Bosch Mora wrote:
&gt; &gt; hi,
&gt; &gt; 
&gt; &gt; on main page of libvirt i can see that there's support for OpenVZ.
&gt; &gt; 
&gt; &gt; how can i connect with virt-manager to an OpenVZ machine?
&gt; &gt; 
&gt; 
&gt; You'll have to specify the libvirt URI via the virt-manager command
&gt; line:
&gt; 
&gt; virt-manager --connect URI --debug
&gt; 

how must be URI formed? can you provide an example?

can i connect to physical server or just to VEs?

i've tried 

virt-manager --debug --connect openvz:///almallutx

virt-manager --debug --connect openvz://almallutx

virt-manager --debug --connect openvz+ssh://almallutx

without any success


&gt; But I doubt many people have tried using virt-manager with openvz, so
&gt; you may hit bugs. I'd be interested in any problems you encounter
&gt; though.
&gt; 

i'll do that.


abosch

</body></email><email><emailId>20100215111252</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-02-15 11:12:52-0400</timestampReceived><subject>Re: [libvirt-users] problem with dependencies</subject><body>

On Sun, Feb 14, 2010 at 06:41:39PM +0200, monitz wrote:
&gt; hello
&gt; i have been having trouble installing libvirt
&gt; i installed kvm-kmod on rhel 5.4 kernel 2.6.18 without issues using an rpm
&gt; from the redhat website
&gt; after installation i tested it by creating an img file with qemu image and
&gt; went ahead to install libvirt and libvirt-python for virtmanager
&gt; however during installation of libvirt i get the following error:
&gt; failed dependencies /usr/bin/qemu-img
&gt; since qemu-img is in /usr/local/kvm/bin on my system i tried adding it to
&gt; $PATH, symlinking the file and even copying the binery to /usr/bin but to no
&gt; use
&gt; compilation from source seemed to go fine but after that libvirt-python
&gt; could still not find libvirt
&gt; 
&gt; is there any solution to this issue? , i would imagine it is a known one

libvirt on RHEL5 expoects KVM to be in /usr/bin or /usr/libexec

Regards,
Daniel
-- 
|: Red Hat, Engineering, London   -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org  -o-  http://virt-manager.org  -o-  http://ovirt.org :|
|: http://autobuild.org       -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-  F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20100216185603</emailId><senderName>Camilo Aguilar</senderName><senderEmail>camilo@cloudescape.com</senderEmail><timestampReceived>2010-02-16 18:56:03-0400</timestampReceived><subject>Re: [libvirt-users] build libvirt on Mac OSX 10.6</subject><body>

great !, just that I need, only the client.

Thanks

On Tue, Feb 16, 2010 at 1:00 PM, jeremy avnet &lt;
brainsik+libvirt@saucelabs.com &lt;brainsik%2Blibvirt@saucelabs.com&gt;&gt; wrote:

&gt; On Mon, Feb 15, 2010 at 5:27 PM, Camilo Aguilar &lt;camilo@cloudescape.com&gt;wrote:
&gt;
&gt;&gt; Anybody know how to build libvirt on Mac OSX 10.6 ?
&gt;&gt;
&gt;
&gt; I've attached a patch and README for building a *client only* version of
&gt; libvirt 0.7.6. The patch was made after reading this blog post:
&gt;
&gt;
&gt; http://www.mattvsworld.com/blog/2010/01/compiling-libvirt-and-ruby-libvirt-on-mac-os-x/
&gt;
&gt; For reference, I'm on Snow Leopard and use MacPorts. I've successfully used
&gt; virsh on OS X to connect to a remote libvirtd server.
&gt;
&gt; .:. jeremy avnet / brainsik
&gt;
&gt;

[Attachment #3 (text/html)]

great !, just that I need, only the client.&lt;br&gt;&lt;br&gt;&lt;div&gt;Thanks&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;div \
class="gmail_quote"&gt;On Tue, Feb 16, 2010 at 1:00 PM, jeremy avnet &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:brainsik%2Blibvirt@saucelabs.com"&gt;brainsik+libvirt@saucelabs.com&lt;/a&gt;&gt;&lt;/span&gt; \
wrote:&lt;br&gt;

&lt;blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc \
solid;padding-left:1ex;"&gt;&lt;div class="im"&gt;&lt;font face="verdana,sans-serif"&gt;&lt;span \
style="font-family:arial"&gt;On Mon, Feb 15, 2010 at 5:27 PM, Camilo Aguilar &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:camilo@cloudescape.com" \
target="_blank"&gt;camilo@cloudescape.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;/span&gt;&lt;br&gt;



&lt;/font&gt;&lt;div class="gmail_quote"&gt;&lt;blockquote class="gmail_quote" style="margin:0 0 0 \
.8ex;border-left:1px #ccc solid;padding-left:1ex"&gt;&lt;div&gt;Anybody know how to build \
libvirt on Mac OSX 10.6 ?&lt;/div&gt; &lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I've attached a \
patch and README for building a &lt;i&gt;client only&lt;/i&gt;  version of libvirt 0.7.6. The \
patch was made after reading this blog post:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;a \
href="http://www.mattvsworld.com/blog/2010/01/compiling-libvirt-and-ruby-libvirt-on-mac-os-x/" \
target="_blank"&gt;http://www.mattvsworld.com/blog/2010/01/compiling-libvirt-and-ruby-libvirt-on-mac-os-x/&lt;/a&gt;&lt;/div&gt;



&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;For reference, I'm on Snow Leopard and use MacPorts. I've \
successfully used virsh on OS X to connect to a remote libvirtd \
server.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;font color="#888888"&gt;&lt;div&gt;.:. jeremy avnet / \
brainsik&lt;/div&gt;

&lt;div&gt;
&lt;br&gt;&lt;/div&gt;
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;



</body></email><email><emailId>20100218100917</emailId><senderName>Anuj Rampal</senderName><senderEmail>invite+zj4oayy0ttc6@facebookmail.com</senderEmail><timestampReceived>2010-02-18 10:09:17-0400</timestampReceived><subject>[libvirt-users] Check out my photos on Facebook</subject><body>

Hi Libvirt-users,

I set up a Facebook profile where I can post my pictures, videos and events and I \
want to add you as a friend so you can see it. First, you need to join Facebook! Once \
you join, you can also create your own profile.

Thanks,
Anuj

To sign up for Facebook, follow the link below:
http://www.facebook.com/p.php?i=100000789786934&amp;k=Z6E3Y5PS3YVAVA1JPB63QTVZSTBD662NUWFWGKR1TP&amp;r




Already have an account? Add this email address to your account \
http://www.facebook.com/n/?merge_accounts.php&amp;e=libvirt-users@redhat.com&amp;c=3327f34b9ec375306e70c68170bd2015.libvirt-users@redhat.com \
was invited to join Facebook by Anuj Rampal. If you do not wish to receive this type \
of email from Facebook in the future, please click on the link below to unsubscribe. \
http://www.facebook.com/o.php?k=cf19ea&amp;u=100000790117024&amp;mid=1e70efbG5af33f927aa0G0G8 \
Facebook's offices are located at 1601 S. California Ave., Palo Alto, CA 94304.


[Attachment #3 (text/html)]

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
    &lt;head&gt;
      &lt;title&gt;Facebook&lt;/title&gt;
      &lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;
    &lt;/head&gt;
    &lt;body style="margin: 0px; padding:0px;" dir="ltr"&gt;
      &lt;!-- container table is 98% b/c yahoo mail needs 1% to display right --&gt;
      &lt;table width="98%" border="0" cellspacing="0" cellpadding="40"&gt;&lt;tr&gt;
          &lt;td bgcolor="#F7F7F7" width="100%" style="font-family: 'lucida grande', \
tahoma, verdana, arial, sans-serif;"&gt;  &lt;table cellpadding="0" cellspacing="0" \
border="0" width="620"&gt;  &lt;tr&gt;
                &lt;td align="left" bgcolor="#3b5998" valign="middle" style="padding: \
4px 8px; font-size: 16px; font-family: 'lucida grande', tahoma, verdana, arial, \
sans-serif; color: #fff;"&gt;&lt;span style="font-weight: bold; letter-spacing: \
-0.03em;"&gt;facebook&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;  &lt;/table&gt; &lt;table cellpadding="0" cellspacing="0" \
border="0" width="620" style="border-bottom: 1px solid #3b5998; border-left: 1px \
solid #ccc; border-right: 1px solid #ccc;" bgcolor="#ffffff"&gt;  &lt;tr&gt;&lt;td \
bgcolor="white" width="*" style="font-size: 11px; padding: 18px 18px 18px 18px; \
font-family: 'lucida grande', tahoma, verdana, arial, sans-serif;" valign="top" \
align="left"&gt;&lt;h1 style="font-size: 13px; margin: 0; padding: 0;"&gt;Check out my photos \
on Facebook&lt;/h1&gt;&lt;br /&gt;Hi Libvirt-users,&lt;br /&gt;&lt;br /&gt;I set up a Facebook profile where \
I can post my pictures, videos and events and I want to add you as a friend so you \
can see it. First, you need to join Facebook! Once you join, you can also create your \
own profile.&lt;br/&gt;&lt;br/&gt;Thanks,&lt;br /&gt; Anuj&lt;br/&gt;&lt;br/&gt;&lt;table width="100%" cellspacing="0" \
cellpadding="0"&gt;&lt;tr&gt;&lt;td style="background-color: #FFF8CC; border: 1px solid #FFE222; \
padding: 10px; font-size: 11px;"&gt;&lt;div style="font-weight: bold; margin-bottom: \
3px;"&gt;To sign up for Facebook, follow the link below:&lt;/div&gt;&lt;a style="color: #3b5998; \
text-decoration: none;" \
href="http://www.facebook.com/p.php?i=100000789786934&amp;k=Z6E3Y5PS3YVAVA1JPB63QTVZSTBD66 \
2NUWFWGKR1TP&amp;r"&gt;http://www.facebook.com/p.php?i=100000789786934&amp;k=Z6E3Y5PS3YVAVA1JPB63QTVZSTBD662NUWFWGKR1TP&amp;r&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;br \
/&gt; Already have an account? Add this email address to your account &lt;a \
href="http://www.facebook.com/n/?merge_accounts.php&amp;e=libvirt-users@redhat.com&amp;c=3327f34b9ec375306e70c68170bd2015"&gt;here&lt;/a&gt;.&lt;/td&gt; \
&lt;/tr&gt;  &lt;/table&gt;
          &lt;table cellpadding="0" cellspacing="0" border="0" width="620"&gt;
           &lt;tr&gt;
            &lt;td style="color: #999999; padding: 10px; font-size: 11px; font-family: \
'lucida grande', tahoma, verdana, arial, sans-serif;"&gt;libvirt-users@redhat.com was \
invited to join Facebook by Anuj Rampal. If you do not wish to receive this type of \
email from Facebook in the future, please click &lt;a \
href="http://www.facebook.com/o.php?k=cf19ea&amp;u=100000790117024&amp;mid=1e70efbG5af33f927aa0G0G8" \
style="color: #3b5998"&gt;here&lt;/a&gt; to unsubscribe.&lt;br/&gt;Facebook's offices are located at \
1601 S. California Ave., Palo Alto, CA 94304.&lt;/td&gt;  &lt;/tr&gt;
           &lt;/table&gt;
          &lt;/td&gt;
        &lt;/tr&gt;&lt;/table&gt;&lt;/body&gt;&lt;/html&gt;&lt;img \
src="http://www.facebook.com/email_open_log_pic.php?k=Z6E3Y5PS3YVAVA1JPB63QTVZSTBD662NUWFWGKR1TP&amp;h=100000789786934&amp;t=1" \
/&gt;



</body></email><email><emailId>20100218145713</emailId><senderName>Danel Ahman</senderName><senderEmail>danel111@gmail.com</senderEmail><timestampReceived>2010-02-18 14:57:13-0400</timestampReceived><subject>[libvirt-users] OpenVZ and Libvirt XML configuration</subject><body>

Hello


Could someone give any hints or explain - how to set OpenVZ container  
hostname and diskspace limits in Libvirt XML configuration file to  
create the new container through Libvirt.


Danel

</body></email><email><emailId>20100218200829</emailId><senderName></senderName><senderEmail>raincatsdogs</senderEmail><timestampReceived>2010-02-18 20:08:29-0400</timestampReceived><subject>[libvirt-users] Digium TDM410 passthrought to KVM VM trixbox</subject><body>

Hello, my name is Paul.
I need to map a PCI device for a virtual machine.
The Linux distribution is Ubuntu server 9.10, infrastructure  
virtualization is "KVM". The virtual machine will install trixbox. To  
map the PCI card is a "Digium TDM410p.
There currently, KVM hosts a virtual machine that runs smoothly  
without any problems. In fact, this virtual machine is running  
Openfiler and has direct access to 2 physical disks installed on the  
server.
Creating a new virtual machine can not connect the Digium card,  
directly to the virtual machine.I tried in 2 ways.

1. Directly editing the XML file for the virtual machine with the  
parameters indicated in the documentation:
  ...
   &lt;devices&gt;
     &lt;hostdev mode='subsystem' type='pci'&gt;
       &lt;source&gt;
         &lt;address bus='0x01' slot='0x00' function='0x0'/&gt;    &lt;----- 
this is my personal configuration
       &lt;/ source&gt;
     &lt;/ hostdev&gt;
   &lt;/ devices&gt;
   ...

2. Adding the PCI card via virt-manager

In both cases, the virtual machine will not start. Virt-manager  
returns this error:
"Error starting domain/ monitor socket did not show up./ Connection  
refused"
"Traceback (most recent call last):
   File "/usr/share/virt-manager/virtManager/engine.py", line 493, in  
run_domain
     vm.startup()
   File "/usr/share/virt-manager/virtManager/domain.py", line 558, in  
startup
     self.vm.create()
   File "/usr/lib/python2.6/dist-packages/libvirt.py", line 293, in  
create
     if ret == -1: raise libvirtError ('virDomainCreate() failed',  
dom=self)
libvirtError: monitor socket did not show up.: Connection refused"

Can someone kindly help me?
Thanks

[Attachment #3 (text/html)]

&lt;html&gt;&lt;body style="word-wrap: break-word; -webkit-nbsp-mode: space; \
-webkit-line-break: after-white-space; "&gt;&lt;span class="Apple-style-span" \
style="font-family: Arial, sans-serif; font-size: 13px; line-height: 22px; "&gt;&lt;span \
title="Buongiorno, mi chiamo Paolo." style="background-color: rgb(235, 239, 249); \
"&gt;Hello, my name is Paul.&lt;/span&gt;&lt;/span&gt;&lt;div&gt;&lt;span class="Apple-style-span" \
style="font-family: Arial, sans-serif; font-size: 13px; line-height: 22px; "&gt;&lt;span \
title="Buongiorno, mi chiamo Paolo." style="background-color: rgb(235, 239, 249); \
"&gt;&lt;/span&gt;&lt;span title="Ho la necessit di mappare una periferica pci per una macchina \
virtuale."&gt;I need to map a PCI device for a virtual machine.&lt;br&gt;&lt;/span&gt;&lt;span \
title="La distribuzione linux  Ubuntu server 9.10, l'infrastruttura di \
virtualizzazione  "KVM"." style="background-color: rgb(255, 255, 255); \
"&gt;The Linux distribution is Ubuntu server 9.10, infrastructure virtualization is \
"KVM".&lt;/span&gt;&lt;span title="La macchina virtuale installer trixbox."&gt;The virtual \
machine will install trixbox.&lt;/span&gt;&lt;span title="La scheda pci da mappare  una \
"Digium TDM410p"."&gt;To map the PCI card is a "Digium \
TDM410p.&lt;br&gt;&lt;/span&gt;&lt;span title="Attulmente, KVM ospita una macchina virtuale che \
funziona regolarmente senza nessun problema."&gt;There currently, KVM hosts a virtual \
machine that runs smoothly without any problems.&lt;/span&gt;&lt;span title="Infatti \
questa macchina virtuale esegue Openfiler ed ha un accesso diretto a 2 dischi fisici \
installati sul server."&gt;In fact, this virtual machine is running Openfiler and has \
direct access to 2 physical disks installed on the server.&lt;br&gt;&lt;/span&gt;&lt;span \
title="Creando una nuova macchina virtuale non riesco a collegare la scheda Digium, \
direttamente alla macchina virtuale."&gt;Creating a new virtual machine can not connect \
the Digium card, directly to the virtual machine.&lt;/span&gt;&lt;span title="Ho provato in 2 \
modi."&gt;I tried in 2 ways.&lt;br&gt;&lt;/span&gt;&lt;span title="1."&gt;&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;div&gt;&lt;span \
class="Apple-style-span" style="font-family: Arial, sans-serif; font-size: 13px; \
line-height: 22px; "&gt;&lt;span title="1."&gt;1.&lt;/span&gt;&lt;span title="Editando \
direttamente il file xml della macchina virtuale con i parametri indicati nella \
documentazione:"&gt;Directly editing the XML file for the virtual machine with the \
parameters indicated in the documentation:&lt;br&gt;&lt;/span&gt;&lt;span \
title="..."&gt;...&lt;br&gt;&lt;/span&gt;&lt;span title="&lt;devices&gt;" \
style="background-color: rgb(255, 255, 255); \
"&gt;&lt;devices&gt;&lt;br&gt;&lt;/span&gt;&lt;span title="&lt;hostdev \
mode='subsystem' type='pci'&gt;" style="background-color: rgb(255, 255, 255); \
"&gt;&lt;hostdev mode='subsystem' \
type='pci'&gt;&lt;br&gt;&lt;/span&gt;&lt;span \
title="&lt;source&gt;"&gt;&lt;source&gt;&lt;br&gt;&lt;/span&gt;&lt;span \
title="&lt;address bus='0x06' slot='0x02' function='0x0'/&gt;" \
style="background-color: rgb(255, 255, 255); "&gt;&lt;address bus='0x01' slot='0x00' \
function='0x0'/&gt;  &lt;-----this is my personal \
configuration&lt;br&gt;&lt;/span&gt;&lt;span \
title="&lt;/source&gt;"&gt;&lt;/ source&gt;&lt;br&gt;&lt;/span&gt;&lt;span \
title="&lt;/hostdev&gt;"&gt;&lt;/ hostdev&gt;&lt;br&gt;&lt;/span&gt;&lt;span \
title="&lt;/devices&gt;"&gt;&lt;/ devices&gt;&lt;br&gt;&lt;/span&gt;&lt;span \
title="..."&gt;...&lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;span title="2."&gt;2.&lt;/span&gt;&lt;span \
title="Aggiungendo la scheda pci tramite virt-manager"&gt;Adding the PCI card via \
virt-manager&lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;span title="In entrambi i casi la macchina virtuale non \
parte."&gt;In both cases, the virtual machine will not start.&lt;/span&gt;&lt;span \
title="Virt-manager restituisce questo errore:" style="background-color: rgb(255, \
255, 255); "&gt;Virt-manager returns this error:&lt;/span&gt;&lt;/span&gt;&lt;div&gt;&lt;font \
class="Apple-style-span" face="Arial, sans-serif" size="3"&gt;&lt;span \
class="Apple-style-span" style="font-size: 13px; line-height: 22px;"&gt;"&lt;span \
class="Apple-style-span" style="font-family: 'Lucida Grande'; font-size: 12px; \
line-height: normal; "&gt;Error starting domain/ monitor socket did not show up./ \
Connection refused"&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" \
face="Arial, sans-serif" size="3"&gt;&lt;span class="Apple-style-span" style="font-size: \
13px; line-height: 22px; "&gt;"Traceback (most recent call \
last):&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="Arial, \
sans-serif" size="3"&gt;&lt;span class="Apple-style-span" style="font-size: 13px; \
line-height: 22px;"&gt;File "/usr/share/virt-manager/virtManager/engine.py", \
line 493, in run_domain&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" \
face="Arial, sans-serif" size="3"&gt;&lt;span class="Apple-style-span" style="font-size: \
13px; line-height: 22px;"&gt; \
vm.startup()&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" \
face="Arial, sans-serif" size="3"&gt;&lt;span class="Apple-style-span" style="font-size: \
13px; line-height: 22px;"&gt;File \
"/usr/share/virt-manager/virtManager/domain.py", line 558, in \
startup&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="Arial, \
sans-serif" size="3"&gt;&lt;span class="Apple-style-span" style="font-size: 13px; \
line-height: 22px;"&gt; self.vm.create()&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
class="Apple-style-span" face="Arial, sans-serif" size="3"&gt;&lt;span \
class="Apple-style-span" style="font-size: 13px; line-height: 22px;"&gt;File \
"/usr/lib/python2.6/dist-packages/libvirt.py", line 293, in \
create&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="Arial, \
sans-serif" size="3"&gt;&lt;span class="Apple-style-span" style="font-size: 13px; \
line-height: 22px;"&gt; if ret == -1: raise libvirtError \
('virDomainCreate() failed', dom=self)&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
class="Apple-style-span" face="Arial, sans-serif" size="3"&gt;&lt;span \
class="Apple-style-span" style="font-size: 13px; line-height: 22px;"&gt;libvirtError: \
monitor socket did not show up.: Connection refused"&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font \
class="Apple-style-span" face="Arial, sans-serif" size="3"&gt;&lt;span \
class="Apple-style-span" style="font-size: 13px; line-height: \
22px;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font class="Apple-style-span" face="Arial, \
sans-serif" size="3"&gt;&lt;span class="Apple-style-span" style="font-size: 13px; \
line-height: 22px;"&gt;&lt;div&gt;Can someone kindly help \
me?&lt;/div&gt;&lt;div&gt;Thanks&lt;/div&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;



</body></email><email><emailId>20100224034447</emailId><senderName>Daniel Bidwell</senderName><senderEmail>bidwell@andrews.edu</senderEmail><timestampReceived>2010-02-24 03:44:47-0400</timestampReceived><subject>[libvirt-users] live migration not working correctly</subject><body>

I have two servers running Ubuntu 9.10, with shared disk from ISCSI SAN
and OCFS2, identical network configurations, shared ssh keys, and pki
keys.  My vm will boot from either machine and run correctly.  When I
attempt to do a live migration with "migrate --live base32 qemu
+[ssh/tcp]://vm1/system" it initiates the vm on the other server, but
leaves the vm on the current server in the "running" state and the vm on
the other server in the "paused" state.  It never finishes the
migration.  I get the same results for doing a migration via ssh as I do
with tcp/pki.  I have turned up the logging to debug, but don't see
anything in the log to indicate an error or any reason for it to not
complete.  At least not anything obvious.  The Ubuntu server software is
using kvm/qemu version 84.

I have been through the ubuntu and qemu forums/wiki/documentation.
Anyone have any suggestions of other things to look for?

-- 
Daniel R. Bidwell       |       bidwell@andrews.edu
Andrews University      |       Information Technology Services
If two always agree, one of them is unnecessary
"Friends don't let friends do DOS"
"In theory, theory and practice are the same.
In practice, however, they are not."


</body></email><email><emailId>20100224081721</emailId><senderName>Jon Masters</senderName><senderEmail>jcm@redhat.com</senderEmail><timestampReceived>2010-02-24 08:17:21-0400</timestampReceived><subject>Re: [libvirt-users] /dev/pts linking option?</subject><body>

On Wed, 2010-02-24 at 07:41 +0000, Daniel P. Berrange wrote:
&gt; On Tue, Feb 23, 2010 at 08:14:12PM -0500, Jon Masters wrote:
&gt; &gt; Folks,
&gt; &gt; 
&gt; &gt; Does anyone know whether libvirt provides a means for me to guarantee a
&gt; &gt; persistent link for my guest's virtual serial console? I need to have a
&gt; &gt; consistent mapping (for example, a symlink that always points to the
&gt; &gt; correct /dev/pts entry) so I can automate kgdb hookup on boot.
&gt; 
&gt; The /dev/pts path for a guest is always recorded in the XML, so just query
&gt; the XML file for it once it is running to discover the allocated path, or 
&gt; use the convenient 'virsh ttyconsole' command which prints just the path
&gt; immediately.

Ooh, now that's useful. It would also be nice to have a symlink, but I
think this will do for the moment - thanks!

Jon.

P.S. Thanks for awesome blog post on NUMA.


</body></email><email><emailId>20100225145135</emailId><senderName>"Neil Aggarwal"</senderName><senderEmail>neil@jammconsulting.com</senderEmail><timestampReceived>2010-02-25 14:51:35-0400</timestampReceived><subject>[libvirt-users] How to find IP address that is in use?</subject><body>

Hello:

When I try to start a VPS, it tells me the IP address is
already in use by another system.

How do I find out what guest is using an IP address?
Is there a virsh command to list the IP addresses
that are in use?

Thanks,
	Neil

--
Neil Aggarwal, (281)846-8957
FREE trial: cPanel VPS with unmetered bandwidth
http://UnmeteredVPS.net/cpanel

</body></email><email><emailId>20100226133437</emailId><senderName>zorgman</senderName><senderEmail>zorg@probesys.com</senderEmail><timestampReceived>2010-02-26 13:34:37-0400</timestampReceived><subject>Re: [libvirt-users] Migration error</subject><body>

zorgman a crit :
&gt; Hi,
&gt;
&gt; I'm trying to migrate a VM from one libvirt 0.7.6-1 (qemu-kvm 
&gt; 0.11.1+dfsg-1) to another libvirt 0.7.6-2 (qemu-kvm 0.11.1+dfsg-1) 
&gt; connected with SSH , i have followed pre requite (same shared, same 
&gt; path, same network conf ...) . But when i migrate , i have following 
&gt; error : operation failed:
&gt;
&gt; /migration to 'tcp:x.x.x.x:49157' failed: migration failed
&gt; DETAIL :
&gt;
&gt; Unable to migrate guest:
&gt; Traceback (most recent call last):
&gt;  File "/usr/share/virt-manager/virtManager/migrate.py", line 457, in 
&gt; _async_migrate
&gt;    vm.migrate(dstconn, migrate_uri, rate, live, secure)
&gt;  File "/usr/share/virt-manager/virtManager/domain.py", line 1272, in 
&gt; migrate
&gt;    self._backend.migrate(destconn.vmm, flags, newname, interface, rate)
&gt;  File "/usr/lib/python2.5/site-packages/libvirt.py", line 429, in migrate
&gt;    if ret is None:raise libvirtError('virDomainMigrate() failed', 
&gt; dom=self)
&gt; libvirtError: operation failed: migration to 
&gt; 'tcp:portable.artis.int:49157' failed: migration failed
&gt;
&gt;
&gt; /on the destination libvirt i can see in syslog :
&gt;
&gt; /Feb 26 11:16:25 portable libvirtd: 11:16:25.281: error : 
&gt; qemudDomainGetInfo:3744 : Domain not found: no domain with matching 
&gt; uuid '71c22b3b-4c93-80bd-8387-2b502887c2aa'
&gt; Feb 26 11:16:25 portable libvirtd: 11:16:25.283: error : 
&gt; qemudDomainGetInfo:3744 : Domain not found: no domain with matching 
&gt; uuid '71c22b3b-4c93-80bd-8387-2b502887c2aa'
&gt;
&gt;
&gt;
&gt; Feb 26 11:16:25 portable kernel: [ 3022.213730] virbr0: port 1(vnet0) 
&gt; entering disabled state
&gt; Feb 26 11:16:25 portable kernel: [ 3022.228917] device vnet0 left 
&gt; promiscuous mode
&gt; Feb 26 11:16:25 portable kernel: [ 3022.228925] virbr0: port 1(vnet0) 
&gt; entering disabled state
&gt; Feb 26 11:16:25 portable NetworkManager:    SCPlugin-Ifupdown: devices 
&gt; removed (path: /sys/devices/virtual/net/vnet0, iface: vnet0)
&gt; Feb 26 11:17:01 portable /USR/SBIN/CRON[2606]: (root) CMD (   cd / &amp;&amp; 
&gt; run-parts --report /etc/cron.hourly)
&gt; Feb 26 11:24:47 portable NetworkManager: &lt;WARN&gt;  nm_signal_handler(): 
&gt; Caught signal 15, shutting down normally.
&gt; Feb 26 11:24:47 portable NetworkManager: &lt;info&gt;  (wlan0): taking down 
&gt; device.
&gt; Feb 26 11:24:47 portable NetworkManager: &lt;info&gt;  exiting (success)
&gt;
&gt; /in the destination libvirt vm log i can see the cmd running by 
&gt; migration:
&gt;
&gt; /LC_ALL=C 
&gt; PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin 
&gt; HOME=/ QEMU_AUDIO_DRV=none /usr/bin/kvm -S -M pc-0.11 -enable-kvm -m 
&gt; 256 -smp 1 -name testmigration -uuid 
&gt; 71c22b3b-4c93-80bd-8387-2b502887c2aa -monitor 
&gt; unix:/var/lib/libvirt/qemu/testmigration.monitor,server,nowait -boot c 
&gt; -drive file=/mnt/testmigration.img,if=virtio,boot=on,format=qcow2 
&gt; -drive if=ide,media=cdrom,bus=1,unit=0,format=raw -net 
&gt; nic,macaddr=52:54:00:7a:a4:98,vlan=0,model=virtio,name=net0 -net 
&gt; tap,fd=50,vlan=0,name=hostnet0 -serial pty -parallel none -usb -vnc 
&gt; 127.0.0.1:0 -k fr -vga cirrus -incoming tcp:0.0.0.0:49156 -balloon 
&gt; virtio/
&gt;
&gt;
&gt;
&gt; I'm using Debian.
&gt;
&gt; The problem occure online as offline mod.
&gt;
&gt;
&gt;
&gt;
&gt;
&gt; _______________________________________________
&gt; libvirt-users mailing list
&gt; libvirt-users@redhat.com
&gt; https://www.redhat.com/mailman/listinfo/libvirt-users
i have forgotten, after migrate has failed, my guest has some IO error 
and remount my system in read only.

</body></email><email><emailId>20100228235012</emailId><senderName>carlos_campderrs</senderName><senderEmail>gilipollas.desconcertante@gmail.com</senderEmail><timestampReceived>2010-02-28 23:50:12-0400</timestampReceived><subject>Re: [libvirt-users] location of network xml files</subject><body>

Hello again,

2010/3/1 carlos campderrs &lt;gilipollas.desconcertante@gmail.com&gt;

&gt; Is it reasonable to symlink (or hardlink if possible) one file to the
&gt; other? Or to remove the /etc file and point the autostart to the /var file?
&gt; Also, does the autostart do something? because it's pointing to the ignored
&gt; file.
&gt;

Now I see that the contents of both files are different, so I suppose that
linking one to another wouldn't work. So, in short, what's the purpose of
/etc/libvirt/qemu/networks/default.xml?

thanks again,
carlos.

-- 
Si no puedes deslumbrar con tu sabidura,
desconcierta con tus gilipolleces

[Attachment #3 (text/html)]

Hello again,&lt;br&gt;&lt;br&gt;&lt;div class="gmail_quote"&gt;2010/3/1 carlos campderrs &lt;span \
dir="ltr"&gt;&lt;&lt;a href="mailto:gilipollas.desconcertante@gmail.com"&gt;gilipollas.desconcertante@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote \
class="gmail_quote" style="border-left: 1px solid rgb(204, 204, 204); margin: 0pt 0pt \
0pt 0.8ex; padding-left: 1ex;"&gt; Is it reasonable to symlink (or hardlink if possible) \
one file to the other? Or to remove the /etc file and point the autostart to the /var \
file? Also, does the autostart do something? because it's pointing to the ignored \
file.&lt;br clear="all"&gt; &lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;Now I see that the contents of both \
files are different, so I suppose that linking one to another wouldn't work. So, \
in short, what's the purpose of /etc/libvirt/qemu/networks/default.xml?&lt;br&gt; \
&lt;br&gt;thanks again,&lt;br&gt;carlos.&lt;br&gt;&lt;br&gt;-- &lt;br&gt;Si no puedes deslumbrar con tu \
sabidura,&lt;br&gt;desconcierta con tus gilipolleces&lt;br&gt;



</body></email><email><emailId>20101116165125</emailId><senderName>"David M. Barlieb"</senderName><senderEmail>dmb@integrichain.com</senderEmail><timestampReceived>2010-11-16 16:51:25-0400</timestampReceived><subject>[libvirt-users] (no subject)</subject><body>

HI, I've just begun using libvirt as part of my KVM installation and
have been having some confusion regarding networking of my virtual
guests. I'm not sure if I should even be sending this to this mailing
list and if not please let me know and if possible where I should be
sending this inquiry.

 

I understand I can setup a dedicated bridged interface for my guest. But
as for the virbr interface which is the default, I'm a little confused
about. When using this, does the guest os use the same ip as the host?
If so, then how to packets get to the guest instead of the host. I would
guess there's an alternate mac address for the guest interface and this
is how it gets there but am not certain. Sorry if this seems like a
simple question but I'm not very well versed in networking.

 

daveb

 


[Attachment #3 (text/html)]

&lt;html xmlns:v="urn:schemas-microsoft-com:vml" \
xmlns:o="urn:schemas-microsoft-com:office:office" \
xmlns:w="urn:schemas-microsoft-com:office:word" \
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" \
xmlns="http://www.w3.org/TR/REC-html40"&gt;

&lt;head&gt;
&lt;meta http-equiv=Content-Type content="text/html; charset=us-ascii"&gt;
&lt;meta name=Generator content="Microsoft Word 12 (filtered medium)"&gt;
&lt;style&gt;
&lt;!--
 /* Font Definitions */
 @font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.Section1
	{page:Section1;}
--&gt;
&lt;/style&gt;
&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapedefaults v:ext="edit" spidmax="1026" /&gt;
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;
 &lt;o:shapelayout v:ext="edit"&gt;
  &lt;o:idmap v:ext="edit" data="1" /&gt;
 &lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;
&lt;/head&gt;

&lt;body lang=EN-US link=blue vlink=purple&gt;

&lt;div class=Section1&gt;

&lt;p class=MsoNormal&gt;HI, Ive just begun using libvirt as part of my KVM
installation and have been having some confusion regarding networking of my
virtual guests. Im not sure if I should even be sending this to this
mailing list and if not please let me know and if possible where I should be
sending this inquiry.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;I understand I can setup a dedicated bridged interface for
my guest. But as for the virbr interface which is the default, Im a
little confused about. When using this, does the guest os use the same ip as
the host? If so, then how to packets get to the guest instead of the host. I
would guess theres an alternate mac address for the guest interface and
this is how it gets there but am not certain. Sorry if this seems like a simple
question but Im not very well versed in networking.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;b&gt;&lt;span \
style='font-size:12.0pt;color:#1F497D'&gt;daveb&lt;/span&gt;&lt;/b&gt;&lt;span \
style='color:#1F497D'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p class=MsoNormal&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;



</body></email><email><emailId>20101116170003</emailId><senderName>"Daniel P. Berrange"</senderName><senderEmail>berrange@redhat.com</senderEmail><timestampReceived>2010-11-16 17:00:03-0400</timestampReceived><subject>Re: [libvirt-users] (no subject)</subject><body>

On Tue, Nov 16, 2010 at 11:51:25AM -0500, David M. Barlieb wrote:
&gt; HI, I've just begun using libvirt as part of my KVM installation and
&gt; have been having some confusion regarding networking of my virtual
&gt; guests. I'm not sure if I should even be sending this to this mailing
&gt; list and if not please let me know and if possible where I should be
&gt; sending this inquiry.
&gt; 
&gt; I understand I can setup a dedicated bridged interface for my guest. But
&gt; as for the virbr interface which is the default, I'm a little confused
&gt; about. When using this, does the guest os use the same ip as the host?
&gt; If so, then how to packets get to the guest instead of the host. I would
&gt; guess there's an alternate mac address for the guest interface and this
&gt; is how it gets there but am not certain. Sorry if this seems like a
&gt; simple question but I'm not very well versed in networking.

This page describes the two commonly used networking setups

  http://wiki.libvirt.org/page/Networking

The virbr0 you get by default is providing NAT forwarding. If you want
full bridging to the LAN, then you should probably follow the second 
set of instructions there, and ignore the virbr0 device

Regards,
Daniel
-- 
|: Red Hat, Engineering, London    -o-   http://people.redhat.com/berrange/ :|
|: http://libvirt.org -o- http://virt-manager.org -o- http://deltacloud.org :|
|: http://autobuild.org        -o-         http://search.cpan.org/~danberr/ :|
|: GnuPG: 7D3B9505  -o-   F3C9 553F A1DA 4AC2 5648 23C1 B3DF F742 7D3B 9505 :|

</body></email><email><emailId>20101116175719</emailId><senderName>Justin Clift</senderName><senderEmail>jclift@redhat.com</senderEmail><timestampReceived>2010-11-16 17:57:19-0400</timestampReceived><subject>Re: [libvirt-users] (no subject)</subject><body>

On 17/11/2010, at 3:51 AM, David M. Barlieb wrote:
&gt; HI, Ive just begun using libvirt as part of my KVM installation and have been \
&gt; having some confusion regarding networking of my virtual guests. Im not sure if I \
&gt; should even be sending this to this mailing list and if not please let me know and \
&gt; if possible where I should be sending this inquiry. 
&gt; I understand I can setup a dedicated bridged interface for my guest. But as for the \
&gt; virbr interface which is the default, Im a little confused about. When using this, \
&gt; does the guest os use the same ip as the host? If so, then how to packets get to \
&gt; the guest instead of the host. I would guess theres an alternate mac address for \
&gt; the guest interface and this is how it gets there but am not certain. Sorry if this \
&gt; seems like a simple question but Im not very well versed in networking.

Hi Dave,

The "default" virtual network that libvirt comes with, has NAT done to it.  So, the \
guests connected through it can get to the outside world, and they get reply \
packets... but their IP addresses aren't directly visible.

Exact same principle as (often) used in home networks these days, where the computers \
in a person's home have NAT applied to them by their ADSL router.

Does that help?

By the way, there's documentation around this subject being worked upon here:

  http://wiki.libvirt.org/page/VirtualNetworking

It's very much "work in progress", and that won't be it's final URL.  But... it might \
help anyway. :)

(feel free to ask further questions and stuff in regards to that doc.  Feedback on \
the way through is useful. :&gt; )

Regards and best wishes,

Justin Clift


</body></email></emails>